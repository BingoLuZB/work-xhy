(function(dc,ec,f){var y=f.static,g=f.class,e=f.getset,W=f.__newvec,Xa=laya.ui.AutoBitmap,Ya=laya.display.BitmapFont,fa=laya.ui.Box,v=laya.utils.Browser,K=laya.ui.Button,ga=laya.utils.Byte,ha=laya.ui.CheckBox,Za=laya.debug.tools.ClassTool,t=laya.utils.ClassUtils,$a=laya.ui.Clip,ia=laya.ui.ComboBox,ab=f.Config,ja=laya.ui.Dialog,r=laya.utils.Ease,bb=laya.events.EventDispatcher,ka=laya.ui.FontClip,xa=laya.html.dom.HTMLDivElement,ya=laya.resource.HTMLImage,x=laya.utils.Handler,cb=laya.utils.HitArea,X=laya.ui.Image,db=laya.display.Input,Y=laya.ui.Label,eb=laya.ui.List,Z=laya.net.Loader,fb=laya.display.Node,O=laya.ui.Panel,l=laya.maths.Point,aa=laya.utils.Pool,la=laya.ui.ProgressBar,ma=laya.ui.Radio,na=laya.ui.RadioGroup,P=laya.maths.Rectangle,gb=laya.renders.Render,hb=laya.resource.Resource,ib=boots.ResourceVersionEx,z=laya.display.Scene,za=laya.ui.ScrollBar,Aa=laya.ui.Slider,jb=laya.media.SoundManager,B=laya.display.Sprite,kb=laya.ui.Tab,lb=laya.ani.bone.Templet,G=laya.display.Text,mb=laya.ui.TextInput,oa=laya.resource.Texture,Ba=laya.utils.TimeLine,nb=laya.ui.Tree,L=laya.utils.Tween,Q=laya.ui.UIComponent,Ca=f.UIConfig,ob=laya.ui.UIUtils,pb=laya.net.URL,pa=laya.ui.View,ba=laya.webgl.WebGLContext;f.interface("engine.res.IAnimationRes");f.interface("engine.base.pool.IPoolObject");f.interface("engine.ui.interfaces.IGridData");f.interface("engine.ui.interfaces.ICoolDown");f.interface("engine.ui.interfaces.ITipsPanel");f.interface("engine.scene.obj.ISceneObjectBase");f.interface("engine.battle.move.IBattleMoveObj");f.interface("engine.scene.move.IMoveRuleObject");f.interface("engine.base.tile.IMTitleContainer");f.interface("engine.base.pool.spool.ISimplePool");f.interface("engine.pui.scroll.IScrollTrickCell");f.interface("engine.base.interfaceclass.IDestroyObject");f.interface("engine.animation.interfaces.IAnimation","engine.base.interfaceclass.IDestroyObject");f.interface("engine.animation.interfaces.IAnimationGroup","engine.base.interfaceclass.IDestroyObject");(function(){function c(){}g(c,"engine.base.data.Bean");var b=c.prototype;b.read=function(a){};b.write=function(a){};b.readBoolean=function(a){return 0!=this.readByte(a)};b.readByte=function(a){return a.readByte()};b.readShort=function(a){return a.readShort()};b.readNumber=function(a){return a.readFloat64()};b.readInt=function(a){return ca.readInt(a)};b.readLong=function(a){return ca.readLong(a)};b.readString=function(a){a=this.readBytes(a);return null==a?null:a.readUTFBytes()};b.readBytes=function(a){var d=this.readInt(a);return 1>d?null:a.GetByteArray(0,d)};b.readBean=function(a,d){return this.readBoolean(a)?(d=new d,d.read(a),d):null};b.readBeanInList=function(a,d){d=new d;d.read(a);return d};b.writeBoolean=function(a,d){this.writeByte(a,d?1:0)};b.writeByte=function(a,d){a.writeByte(d)};b.writeShort=function(a,d){a.writeShort(d)};b.writeInt=function(a,d){ca.writeInt(a,d)};b.writeLong=function(a,d){ca.writeLong(a,d)};b.writeString=function(a,d){if(null==d)this.writeBytes(a,null);else{var b=new A;b.writeUTFBytes(d);b.pos=0;this.writeBytes(a,b)}};b.writeBytes=function(a,d){null==d?this.writeInt(a,0):(this.writeInt(a,d.bytesAvailable),a.writeBytes(d))};b.writeBean=function(a,d){null==d?this.writeBoolean(a,!1):(this.writeBoolean(a,!0),d.write(a))};return c})();var qb=function(){function c(){this._imageIdx=0;this._poih=this._poiw=this._dh=this._dw=this._dy=this._dx=NaN}g(c,"engine.base.sheet.MSheetDivideFrame");var b=c.prototype;e(0,b,"poiw",function(){return this._poiw});e(0,b,"dw",function(){return this._dw});e(0,b,"dx",function(){return this._dx});e(0,b,"poih",function(){return this._poih});e(0,b,"dh",function(){return this._dh});e(0,b,"dy",function(){return this._dy});e(0,b,"imageIdx",function(){return this._imageIdx});c.CreateOne=function(a,d){var b=new c;b._imageIdx=d;b._dx=a.getInt16();b._dy=a.getInt16();b._dw=a.getInt16();b._dh=a.getInt16();b._poiw=a.getInt16();b._poih=a.getInt16();return b};return c}(),Ea=function(){function c(a,d,b){this._pooltype=a;this._cls=d;this._allObjectRefList=b;this._hashList=new Da}g(c,"engine.scene.obj.MSceneTypeList");var b=c.prototype;b.RemoveSceneObject=function(a){var d=this._hashList.Remove(a);null!=d&&(this._allObjectRefList.Remove(a)!=d&&n.LogError("MSceneTypeList remove but (or !\x3d o)"),d.destroy())};b.RemoveAllSceneObject=function(){for(var a,d=this._hashList.Clear(),b=d.length,c=0;c<b;++c)a=d[c],null!=this._allObjectRefList&&this._allObjectRefList.Remove(a.gid)!=a&&n.LogError("MSceneTypeList removeAll but (rso !\x3d o)"),a.destroy()};b.GetCreateSceneObject=function(a){var d=this._hashList.Get(a);null==d&&(d=new this._cls,d.pooltype=this._pooltype,this._hashList.Add(a,d),this._allObjectRefList.Add(a,d));return d};e(0,b,"hashList",function(){return this._hashList});e(0,b,"pooltype",function(){return this._pooltype});return c}();(function(){function c(){}g(c,"engine.animation.define.EnumActionName");c.ALL="all";c.NONE="none";c.STAND="a_stand";c.RUN="a_run";c.DEAD="a_dead";c.HURT="a_hurt";c.ATTACK1="a_attack";c.RIDESTAND="a_ridestand";c.RIDERUN="a_riderun";c.RIDEATTACK="a_rideattack";c.RIDEHURT="a_ridehurt";c.UI_STAND="a_mianbanzhanli";c.UI_XIUXIAN="a_mianbanxiuxian";return c})();(function(){function c(){this._splitPath=[]}g(c,"engine.scene.astar.AStarPathCollection");var b=c.prototype;b.ToArrayPath=function(){for(var a=[],d=0;d<this._splitPath.length;++d)null!=this._splitPath[d]&&(a=a.concat(this._splitPath[d]));return a};b.SetPath=function(a,d){var b,c=[],h=null;for(b=0;b<a.length;++b){var p=0;null!=h&&(p=Math.max(Math.abs(h.x-a[b].x),Math.abs(h.y-a[b].y))|0);1<p?(0<c.length&&this._splitPath.push(c),this._splitPath.push(null),this._splitPath.push([a[b]]),c=[]):15<=c.length?(this._splitPath.push(c),c=[a[b]]):c.push(a[b]);h=a[b]}0<c.length&&this._splitPath.push(c);for(b=0;b<this._splitPath.length;++b)if(null!=this._splitPath[b]){a=Fa.floyd(this._splitPath[b],d);for(c=[];a.length;){h=a.shift();if(null==h)break;c.push(new l(h.x,h.y))}this._splitPath[b]=c}};b.DoPixel=function(){this._splitPath[0].shift();0==this._splitPath[0].length&&this._splitPath.shift();var a;for(a=0;a<this._splitPath.length;++a)null!=this._splitPath[a]&&(this._splitPath[a]=w.ArrayGridPt2PixPt(this._splitPath[a]))};b.GetEndPt=function(){if(null!=this._splitPath&&0<this._splitPath.length){var a=this._splitPath[this._splitPath.length-1];if(0<a.length)return a[a.length-1]}return null};e(0,b,"splitPath",function(){return this._splitPath});return c})();var D=function(){function c(){}g(c,"engine.utils.CallbackUtil");c.Reload=function(){c.ReloadCallBack&&c.ReloadCallBack.apply(null,2)};c.doCloseViewManul=function(b){null!=c.closeViewManual&&c.closeViewManual.call(null,b)};c.doCloseViewCallBack=function(b){null!=c.closeViewCallBack&&c.closeViewCallBack.call(null,b)};c.doOpenViewCallBack=function(b){null!=c.openViewCallBack&&c.openViewCallBack.call(null,b)};c.doCloseTabCallBack=function(b){null!=c.closeTabCallBack&&c.closeTabCallBack.call(null,b)};c.isLowMachine=!1;c.ReloadCallBack=null;c.closeViewManual=null;c.closeViewCallBack=null;c.openViewCallBack=null;c.closeTabCallBack=null;c.callbackUseCompressTexture=null;c.callbackOutGC=null;return c}(),rb=function(){function c(){}g(c,"engine.base.data.LongIdMap");e(1,c,"NEXTGID",function(){++c.CUR_GID;++c.WARING_COUNT;2E4<=c.WARING_COUNT&&(c.WARING_COUNT=0);return c.CUR_GID});c.Init=function(){return{"0000000000000000":0}};c.ToGID=function(b){b=b.hexValue;var a=c.map[b];null==a&&(a=c.CUR_GID++,c.map[b]=a);return a};c.ChangeGID=function(b,a){if(b.EqualTo(a))return c.map[b.hexValue];b=b.hexValue;var d=c.map[b];if(null==d)return 0;c.map[a.hexValue]=d;c.map[b]=null;return d};c.ERR_GID=2147483632;c.WARNING_NUM=2E4;c.WARING_COUNT=0;c.CUR_GID=10001;y(c,["map",function(){return this.map=c.Init()}]);return c}(),Ga=function(){function c(){this._shakeRangeYEnd=this._shakeRangeYBegin=this._shakeRangeXEnd=this._shakeRangeXBegin=0;this._shakeItv=50;this._shakeRangeMode=this._shakeMode=this._shakeDirFlag=this._shakeNextTime=this._shakeEndTime=this._shakeTime=0;this._shakeFlag=!1;this._shakeValue=new l}g(c,"engine.scene.layer.SceneShakeControl");var b=c.prototype;b.GetShakeFlag=function(){return this._shakeFlag?(this._shakeFlag=!1,!0):!1};b.ShakeScene=function(a,d,b,c,h,p,e,da){this._shakeMode=a;this._shakeRangeMode=d;this._shakeTime=b;this._shakeItv=da;this._shakeEndTime=f.timer.currTimer+b;this._shakeNextTime=f.timer.currTimer;this._shakeRangeXBegin=c;this._shakeRangeXEnd=h;this._shakeRangeYBegin=p;this._shakeRangeYEnd=e;this._shakeDirFlag=.5<Math.random()?1:-1};b.Clear=function(){this._shakeEndTime=0;this.SetShakeValue(0,0)};b.OnFrame=function(a){if(0!=this._shakeEndTime){var d=this._shakeEndTime-a;if(0>=d)this._shakeEndTime=0,this.SetShakeValue(0,0);else if(a>this._shakeNextTime){var b=(this._shakeTime-d)/this._shakeTime;0>b&&(b=0);1<b&&(b=1);var c=d=0;0==this._shakeRangeMode?(d=n.LerpValue(this._shakeRangeXBegin,this._shakeRangeXEnd,b),c=n.LerpValue(this._shakeRangeYBegin,this._shakeRangeYEnd,b)):1==this._shakeRangeMode&&(d=this._shakeRangeXEnd-this._shakeRangeXBegin,c=this._shakeRangeYEnd-this._shakeRangeYBegin);var h=b=0;0==this._shakeMode?(b=-d+2*Math.random()*d,h=-c+2*Math.random()*c):1==this._shakeMode?(b=-d+2*Math.random()*d,h=-c+2*Math.random()*c,0>b*h&&(.5<Math.random()?b=-b:h=-h)):2==this._shakeMode?(b=Math.random()*d*this._shakeDirFlag,h=Math.random()*c*this._shakeDirFlag):3==this._shakeMode&&(b=d*this._shakeDirFlag,h=c*this._shakeDirFlag);this.SetShakeValue(b,h);this._shakeDirFlag*=-1;this._shakeNextTime=a+this._shakeItv}}};b.SetShakeValue=function(a,d){this._shakeValue.x=a;this._shakeValue.y=d;this._shakeFlag=!0};e(0,b,"shakeValue",function(){return this._shakeValue});return c}();(function(){function c(){}g(c,"engine.greensock.TimelineTool");c.repeat=function(b,a,d,c,m,h,p,e){void 0===p&&(p=0);null==e&&(e=new Ba);if(b){b={};for(var k in c)b[k]=d[k];if(-1==a)e.to(d,c,m,h,0).to(d,b,m,h,p),e.play(0,!0);else{for(k=0;k<a;++k)0==k?e.to(d,c,m,h,0).to(d,b,m,h,p):e.to(d,c,m,h,p).to(d,b,m,h,p);e.play(0)}}else-1==a&&(e.to(d,c,m,h,p),e.play(0,!0));return e};return c})();var Ha=function(){function c(b,a){this.node=null;this.cost=0;this.node=b;this.cost=a}g(c,"engine.scene.astar.Link");c.prototype.dispose=function(){this.node=null};return c}(),qa=function(){function c(){this._mapLayer=this._mapGrid=this._mapChunk=null;this._loadStep=1;this._loadStepAll=2;this._callbackLoadProg=this._callbackLoadEnd=null;this._loadGridY=this._loadGridX=0;this._mapName=this._thumbnailsTex=this._urlThumbnails=this._urlData=null;this._mapResId=0;this._chunks=this._progHandler=this._chunkLoadedHandler=this._mapResLoadedHandler=null;this._meta=new sb;c._ins=this;this._mapResLoadedHandler=new x(this,this.OnMapResLoadComplete);this._chunkLoadedHandler=new x(this,this.OnChunksComp);this._progHandler=new x(this,this.OnLoadProg)}g(c,"engine.scene.MSceneMap");var b=c.prototype;b.Init=function(){this._mapLayer=new Ia;this._mapGrid=new tb;this._mapChunk=new ub;this._mapLayer.Init(this);this._mapLayer.layerMap.addChild(this._mapChunk);this._mapChunk.Init(this);this._mapGrid.Init()};b.SetLookMapMiddle=function(a){this._mapLayer.SetLookTarget(a)};b.OnFrame=function(a){this._mapLayer.OnFrame(a);this._mapChunk.OnFrame(a)};b.BeginChangeMap=function(a,d,b,c){n.Log("\x3d\x3d\x3d\x3d\x3dBeginChangeMap");if(null!=this._callbackLoadEnd)n.Log("\x3d\x3d\x3d\x3d\x3dBeginChangeMap repeat return!");else{null!=this._urlData&&f.loader.clearRes(this._urlData);null!=this._thumbnailsTex&&(this._thumbnailsTex.disposeBitmap(),this._thumbnailsTex.destroy(),this._thumbnailsTex=null);this._mapGrid.Clear();this._mapChunk.Clear();this._mapLayer.Clear();n.Log("\x3d\x3d\x3d\x3d\x3dBeginChangeMap\x3d\x3d\x3d\x3d\x3d2");var k=n.GetResURL("map/"+this._mapResId);this._urlData=k+"/data.res";this._urlThumbnails=k+"/thumbnail.jpg";this._callbackLoadEnd=a;this._callbackLoadProg=d;this._loadGridX=b;this._loadGridY=c;this._loadStep=1;this.PrepareMapRes()}};b.PrepareMapRes=function(){this.LoadMapResThumbnails()};b.LoadMapResThumbnails=function(){var a=[];a.push({url:this._urlData,type:"arraybuffer"});a.push({url:this._urlThumbnails,type:"image"});f.loader.load(a,this._mapResLoadedHandler,this._progHandler,null,0);n.Log("\x3d\x3d\x3d\x3d\x3dLoadMapResThumbnails:")};b.OnLoadProg=function(a,d){this._callbackLoadProg&&this._callbackLoadProg(this._loadStep,this._loadStepAll,a,d)};b.OnMapResLoadComplete=function(a){n.Log("\x3d\x3d\x3d\x3d\x3dOnMapResLoadComplete\uff1a"+a);if(a){this._thumbnailsTex=Z.getRes(this._urlThumbnails);a=Z.getRes(this._urlData);var d=new A;d.writeArrayBuffer(a);d.pos=0;this._meta.ParseMapMeta(this._mapResId,d);this.LoadMapData()}else D.Reload()};b.LoadMapData=function(){this._mapGrid.LoadMap(this._meta);this._mapChunk.ChangeMap(this._meta,this._thumbnailsTex);this._mapLayer.ChangeMap(this._meta);this.LoadChunks()};b.LoadChunks=function(){this._loadStep=2;if(0!=this._loadGridX&&0!=this._loadGridY){n.Log("\x3d\x3d\x3d\x3d\x3dLoadChunks:");var a=this._mapLayer.CalcSceneRect(this._loadGridX,this._loadGridY),a=this._mapChunk.GetChunkUrls(a);this._chunks=a[1];f.loader.load(a[0],this._chunkLoadedHandler,this._progHandler,null,0)}else this._chunks=null,this.OnChunksComp(!0)};b.OnChunksComp=function(a){if(a){a=this._chunks;this._chunks=null;if(null!=a)for(var d=0;d<a.length;++d)this._mapChunk.LoadChunk(a[d][0],a[d][1]);this._callbackLoadEnd();this._callbackLoadProg=this._callbackLoadEnd=null}else D.Reload()};b.CalcSceneZOrder=function(a,d){return w.CalcSceneZOrder(a,d)};e(0,b,"mapLayer",function(){return this._mapLayer});e(0,b,"mapName",function(){return this._mapName});e(0,b,"sceneWidth",function(){return this._mapChunk.width});e(0,b,"mapGrid",function(){return this._mapGrid});e(0,b,"gridHeight",function(){return this._mapGrid.gridHMax});e(0,b,"mapChunk",function(){return this._mapChunk});e(0,b,"curMapResId",function(){return this._mapResId});e(0,b,"gridWidth",function(){return this._mapGrid.gridWMax});e(0,b,"sceneHeight",function(){return this._mapChunk.height});e(0,b,"meta",function(){return this._meta});e(0,b,"mapResId",function(){return this._mapResId});e(1,c,"Ins",function(){return c._ins});c._ins=null;return c}(),H=function(){function c(){this._values=[];this._keys=[]}g(c,"engine.base.container.Dictionary");var b=c.prototype;b.set=function(a,d){var b=this.indexOf(a);0<=b?this._values[b]=d:(this._keys.push(a),this._values.push(d))};b.indexOf=function(a){var d=this._keys.indexOf(a);if(0<=d)return d;a="string"==typeof a?Number(a):"number"==typeof a?a.toString():a;return this._keys.indexOf(a)};b.get=function(a){a=this.indexOf(a);return 0>a?null:this._values[a]};b.remove=function(a){a=this.indexOf(a);if(0<=a){var d=this._values[a];this._keys.splice(a,1);this._values.splice(a,1);return d}return null};b.clear=function(){this._values.length=0;this._keys.length=0};e(0,b,"values",function(){return this._values});e(0,b,"keys",function(){return this._keys});return c}(),vb=function(){function c(a){this.justMinFun=function(a,b){return a<b};this.a=[];this.a.push(-1);null!=a&&(this.justMinFun=a)}g(c,"engine.scene.astar.BinaryHeap");var b=c.prototype;b.ins=function(a){var d=this.a.length;this.a[d]=a;for(a=d>>1;1<d&&this.justMinFun(this.a[d],this.a[a]);){var b=this.a[d];this.a[d]=this.a[a];this.a[a]=b;d=a;a=d>>1}};b.pop=function(){var a=this.a[1];this.a[1]=this.a[this.a.length-1];this.a.pop();for(var d=1,b=this.a.length,c=d<<1,h=c+1;c<b;)if(c=h<b?this.justMinFun(this.a[h],this.a[c])?h:c:c,this.justMinFun(this.a[c],this.a[d]))h=this.a[d],this.a[d]=this.a[c],this.a[c]=h,d=c,c=d<<1,h=c+1;else break;return a};return c}(),ra=function(){function c(){this._values=[];this._keys=[]}g(c,"engine.supports.utils.HashMap");var b=c.prototype;b.empty=function(){return 0==this._values.length};b.eachKey=function(a){for(var d=this._keys,b=d.length,c=0;c<b;++c)a(d[c])};b.eachValue=function(a){for(var d=this._values,b=d.length,c=0;c<b;++c)a(d[c])};b.containsValue=function(a){return 0<=this._values.indexOf(a)};b.containsKey=function(a){return 0<=this._keys.indexOf(a)};b.getValue=function(a){return this.get(a)};b.put=function(a,d){this.set(a,d)};b.set=function(a,d){var b=this.indexOf(a);0<=b?this._values[b]=d:(this._keys.push(a),this._values.push(d))};b.indexOf=function(a){var d=this._keys.indexOf(a);if(0<=d)return d;a="string"==typeof a?Number(a):"number"==typeof a?a.toString():a;return this._keys.indexOf(a)};b.get=function(a){a=this.indexOf(a);return 0>a?null:this._values[a]};b.remove=function(a){a=this.indexOf(a);if(0<=a){var d=this._values[a];this._keys.splice(a,1);this._values.splice(a,1);return d}return null};b.clear=function(){this._values.length=0;this._keys.length=0};e(0,b,"keys",function(){return this._keys});e(0,b,"length",function(){return this._values.length});e(0,b,"values",function(){return this._values});return c}();(function(){function c(){}g(c,"engine.layaex.EnumLoadPriroty");c.HIGHEST=0;c.HIGH=1;return c})();var Ja=function(){function c(a,d){this._nodes=this._endNode=this._startNode=null;this.type=this._numRows=this._numCols=0;this._straightCost=1;this._firstFind=!0;this._diagCost=Math.SQRT2;this._numCols=a;this._numRows=d;this._nodes=[];for(a=0;a<this._numCols;a++)for(this._nodes[a]=[],d=0;d<this._numRows;d++)this._nodes[a][d]=new sa(a,d)}g(c,"engine.scene.astar.Grid");var b=c.prototype;b.dispose=function(){this._endNode=this._startNode=null;for(var a=0;a<this._numCols;a++)for(var d=0;d<this._numRows;d++)this._nodes[a][d].dispose();this._nodes=null;this._firstFind=!0};b.calculateLinks=function(a,d){void 0===d&&(d=0);this.type=d;for(var b=0;b<this._numCols;b++)for(var c=0;c<this._numRows;c++)this.initNodeLink(this._nodes[b][c],d,a.get(1E4*b+c))};b.getType=function(){return this.type};b.initNodeLink=function(a,d,b){var c=Math.max(0,a.x-1),k=Math.min(this.numCols-1,a.x+1),p=Math.max(0,a.y-1),e=Math.min(this.numRows-1,a.y+1);for(a.links=[];c<=k;c++)for(var f=p;f<=e;f++){var g=this.getNode(c,f);if(g!=a&&g.walkable){if(2!=d&&c!=a.x&&f!=a.y){var q=this.getNode(a.x,f);if(!q.walkable)continue;q=this.getNode(c,a.y);if(!q.walkable)continue}q=this._straightCost;if(a.x!=g.x&&a.y!=g.y){if(1==d)continue;if(2==d&&1==(a.x-g.x)*(a.y-g.y))continue;q=2==d?this._straightCost:this._diagCost}a.links.push(new Ha(g,q))}}if(null!=b)for(d=0;d<b.length;++d)k=b[d],k=this.getNode(k.point.x,k.point.y),k!=a&&k.walkable&&a.links.push(new Ha(k,2*this._diagCost))};b.getNode=function(a,d){return this._nodes[a][d]};b.setEndNode=function(a,d){this._endNode=this._nodes[a][d]};b.setStartNode=function(a,d){this._startNode=this._nodes[a][d];this._firstFind&&(this.findReachableNode(a,d),this._firstFind=!1)};b.setWalkable=function(a,d,b){this._nodes[a][d].walkable=b};b.setDyWalkable=function(a,d,b){this._nodes[a][d].dyWalkable=b};b.setWalkbleFunc=function(a,d,b){this._nodes[a][d].walkbaleFunc=b};b.setCheckMonster=function(a,d,b){this._nodes[a][d].isCheckMonster=b};b.setCheckPlayer=function(a,d,b){this._nodes[a][d].isCheckPlayer=b};b.findReplacer=function(a,d,b){var c=null;if(d.walkable&&d.nodeType==a.nodeType)c=d;else{-1==d.buriedDepth&&b&&(d.buriedDepth=this.getNodeBuriedDepth(d,Math.max(this._numCols,this._numRows)));for(var k=b?d.buriedDepth:10,p=0>d.x-k?0:d.x-k,e=d.x+k>this.numCols-1?this.numCols-1:d.x+k,f=0>d.y-k?0:d.y-k,k=d.y+k>this.numRows-1?this.numRows-1:d.y+k,g,q=p;q<=e;q++)for(var l=f;l<=k;l++)q>p&&q<e&&l>f&&l<k&&b||(g=this.getNode(q,l),g.walkable&&g.nodeType==a.nodeType&&(g.distance=g.getDistanceTo(d),null==c&&(c=g),g.distance<c.distance&&(c=g)))}return c};b.getNodeBuriedDepth=function(a,d){void 0===d&&(d=10);for(var b=a.walkable?0:1,c=1;c<=d;){for(var h=a.x+c>this.numCols-1?this.numCols-1:a.x+c,p=0>a.y-c?0:a.y-c,e=a.y+c>this.numRows-1?this.numRows-1:a.y+c,f,g=0>a.x-c?0:a.x-c;g<=h;g++)for(var l=p;l<=e;l++)if(f=this.getNode(g,l),f!=a&&f.walkable)return b;b++;c++}return b};b.findReachableNode=function(a,d){if(!(0>a||a>this.numCols||0>d||d>this.numRows)&&(d=this.getNode(a,d),d.walkable))for(a=[],a.push(d),d.nodeType=1;0<a.length;){d=a.shift();for(var b=Math.min(this.numCols-1,d.x+1),c=Math.max(0,d.y-1),h=Math.min(this.numRows-1,d.y+1),p=Math.max(0,d.x-1);p<=b;p++)for(var e=c;e<=h;e++)if(d.x==p||d.y==e){var f=this.getNode(p,e);f.walkable&&2==f.nodeType&&(f.nodeType=1,a.push(f))}}};e(0,b,"numRows",function(){return this._numRows});e(0,b,"endNode",function(){return this._endNode});e(0,b,"numCols",function(){return this._numCols});e(0,b,"startNode",function(){return this._startNode});return c}(),wb=function(){function c(a){this._lValue=this._hValue=0;this._hexValue="0000000000000000";void 0===a&&(a=0);"string"==typeof a?this.hexValue=a:0!=a&&(this.intValue=a)}g(c,"engine.base.data.Int64");var b=c.prototype;b.SetRawData=function(a,d){this._hValue=d>>>0;this._lValue=a>>>0;this._hexValue=("0000000000000000"+this._hValue.toString(16)).substr(-8,8)+("0000000000000000"+this._lValue.toString(16)).substr(-8,8)};b.SetMax=function(){this._hValue=this._lValue=4294967295;this._hexValue="ffffffffffffffff"};b.CloneInt64=function(){var a=new c;a._hValue=this._hValue;a._lValue=this._lValue;a._hexValue=this._hexValue;return a};b.CompareTo=function(a){return null==a||this._hValue>a._hValue?1:this._hValue<a._hValue?-1:this._lValue>a._lValue?1:this._lValue<a._lValue?-1:0};b.EqualTo=function(a){return 0==this.CompareTo(a)};b.equals=function(a){return 0==this._hValue&&this._lValue==a};b.IsZero=function(){return 0==this._lValue&&0==this._hValue};b.IsMax=function(){return 4294967295==this._lValue&&4294967295==this._hValue};b.Clear=function(){this.intValue=0};b.ToString=function(){return this._hexValue};b.ToGID=function(){return rb.ToGID(this)};b.ShowValue=function(){var a=this._hValue,d=this._lValue,d=0>d?c.Addition(String(d),"4294967296"):String(d);return c.Addition(c.Multiplication(String(a),"4294967296"),d)};b.BitMaskTest=function(a,d){void 0===d&&(d=!1);return d?0!=(this._hValue&a):0!=(this._lValue&a)};e(0,b,"intValue",null,function(a){0>a?(this._hValue=4294967295,this._lValue=a>>>0,this._hexValue=("ffffffffffffffffffffffffffffffff"+this._lValue.toString(16)).substr(-16,16)):(this._hValue=0,this._lValue=a,this._hexValue=("00000000000000000000000000000000"+this._lValue.toString(16)).substr(-16,16))});e(0,b,"hValue",function(){return this._hValue},function(a){this._hValue=a>>>0});e(0,b,"bytes",function(){var a=new A;a.writeUint32(this._hValue);a.writeUint32(this._lValue);return a},function(a){a.pos=0;this._hValue=a.readUnsignedInt();this._lValue=a.readUnsignedInt();this._hexValue=("0000000000000000"+this._hValue.toString(16)).substr(-8,8)+("0000000000000000"+this._lValue.toString(16)).substr(-8,8)});e(0,b,"hexValue",function(){return this._hexValue},function(a){var d=new A;d.writeUint32(0);d.writeUint32(0);this._hexValue=("00000000000000000000000000000000"+a).substr(-16,16);for(a=d.pos=0;8>a;++a){var b=this._hexValue.substr(2*a,2),b=parseInt(b,16);d.writeByte(b)}d.pos=0;this._hValue=d.readUnsignedInt();this._lValue=d.readUnsignedInt()});e(0,b,"fValue",function(){return 4294967296*this._hValue+this._lValue},function(a){this.SetRawData(Math.floor(a%4294967296),Math.floor(a/4294967296))});e(0,b,"lValue",function(){return this._lValue},function(a){this._lValue=a>>>0});c.Multiplication=function(a,d){var b=!0,m=[],h=[];"-"==a.charAt(0)&&(a=a.substring(1),b=!b);for(;a.length>c.MULTIPLY.length;)m.push(a.substring(a.length-c.MULTIPLY.length)),a=a.substring(0,a.length-c.MULTIPLY.length);m.push(a);"-"==d.charAt(0)&&(d=d.substring(1),b=!b);for(;d.length>c.MULTIPLY.length;)h.push(d.substring(d.length-c.MULTIPLY.length)),d=d.substring(0,d.length-c.MULTIPLY.length);h.push(d);a="0";var p,e;for(d=0;d<m.length;d++)for(var f=0;f<h.length;f++){p=Math.floor(m[d]);e=Math.floor(h[f]);p=String(p*e);for(e=0;e<d+f;e++)p+=c.MULTIPLY;a=c.Addition(p,a)}b||(a="-"+a);return a};c.Addition=function(a,d){var b=!0,m=!1,h=[],p=[];"-"==a.charAt(0)&&(a=a.substring(1),b=!b,m=!0);for(;a.length>c.ADDITION.length;)h.unshift(a.substring(a.length-c.ADDITION.length)),a=a.substring(0,a.length-c.ADDITION.length);h.unshift(a);"-"==d.charAt(0)&&(d=d.substring(1),b=!b);for(;d.length>c.ADDITION.length;)p.unshift(d.substring(d.length-c.ADDITION.length)),d=d.substring(0,d.length-c.ADDITION.length);p.unshift(d);a="";d=0;var e,f=parseInt("1"+c.ADDITION);if(b){for(b=0;0<h.length||0<p.length;)e=d=0,0<h.length&&(d=Math.floor(h.pop())),0<p.length&&(e=Math.floor(p.pop())),e=d+e+b,e>=f?(b=1,e%=f):b=0,a=c.Format(e)+a;1==b&&(a="1"+a)}else{for(var g=[];0<h.length||0<p.length;)e=d=0,0<h.length&&(d=Math.floor(h.pop())),0<p.length&&(e=Math.floor(p.pop())),e=d-e,g.push(e);if(0<g.length)for(d=g.pop();0==d&&0<g.length;)d=g.pop();if(0==d)return"0";g.push(d);b=0;if(0<d)for(;0<g.length;)e=g.shift(),e-=b,0>e?(b=1,e=f+e):b=0,a=c.Format(e)+a;else for(m=!m;0<g.length;)e=g.shift(),e+=b,0<e?(b=1,e=f-e):(b=0,e=-e),a=c.Format(e)+a}for(;1<a.length;)if("0"==a.charAt(0))a=a.substring(1);else break;m&&(a="-"+a);return a};c.Format=function(a){a=String(a);var d=c.ADDITION.length-a.length;if(0>d)return a.substring(-d);for(var b=0;b<d;b++)a="0"+a;return a};c.UINT_MAX_VALUE=4294967295;c.TWO_POW_32=4294967296;c.ZERO="0000000000000000";c.MAX="ffffffffffffffff";c.hexTable="0123456789abcdef";c.BYTESIZE=8;c.HEX_STR_LEN=16;c.ADDITION="00000000";c.MULTIPLY="0000";return c}(),ta=function(){function c(){this._isNotch=!1;this._notchHeight=this._notchWidth=0}g(c,"engine.notch.NotchFixBase");var b=c.prototype;b.Init=function(a){v.window.conchConfig&&(v.onAndroid?(a=v.window.conchConfig.getTotalMem()/1024/1024,M.MEMORY_THRESHOLD=6<a?500:4<a?450:400,4>=a&&(D.isLowMachine=!0)):v.onIOS&&(M.MEMORY_THRESHOLD=400,D.isLowMachine=!0))};e(0,b,"isNotch",function(){return this._isNotch});e(0,b,"notchWidth",function(){return this._notchWidth});e(0,b,"notchHeight",function(){return this._notchHeight});c.InitNotchFix=function(a){console.log("InitNotchFix\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d1");null==c.Ins&&(c.Ins=new c,gb.isConchApp&&(v.onAndroid?c.Ins=new xb:v.onIOS&&(c.Ins=new yb),null!=a&&c.Ins.Init(a)))};c.Ins=null;return c}();(function(){function c(){this._allObjectHashList=null;this._typeListMap=new H}g(c,"engine.battle.MBattleObject");var b=c.prototype;b.AddTypeObjList=function(a,d){if(null!=this._typeListMap.get(a))throw Error("AddTypeObjList key Already Exsit!");this._typeListMap.set(a,new Ea(a,d,this._allObjectHashList))};b.GetTypeObjectList=function(a){return this._typeListMap.get(a).hashList.list};b.EachTypeObjectList=function(a,d){this._typeListMap.get(a).hashList.Each(d)};b.DeleteObject=function(a){var d=this._allObjectHashList.Get(a);if(null!=d){var b=this._typeListMap.get(d.objectType);if(null==b)throw n.Log("DeleteObject TypeObjectList typeList \x3d\x3d null Error"),Error("DeleteObject TypeObjectList typeList \x3d\x3d null Error");b.RemoveSceneObject(a)}return d};b.AddObject=function(a,d,b,c){var k=this._typeListMap.get(d);null==k&&n.LogError("AddObject Unknow pooltype !!! pooltype :"+d);a=k.GetCreateSceneObject(a);a.SetData(b,c);return a};b.RemoveAll=function(){var a,d;for(d in this._typeListMap.values)a=this._typeListMap.values[d],a.RemoveAllSceneObject();0<this._allObjectHashList.GetCount()&&n.LogError("removeAllRoundObject but not Clear!!!!!!! "+this._allObjectHashList.GetCount());0==this._allObjectHashList.CheckSize()&&n.LogError("removeAllRoundObject objHash.CheckSize false!!!!!!")};b.FindObject=function(a){return 0==a?null:this._allObjectHashList.Get(a)};return c})();(function(){function c(){this.destroyed=!1;this._radioGroup=this._panList=this._panContent=null;this._loadingTag={};this._preitem=this._prepanel=null}g(c,"engine.pui.tab.TabControl");var b=c.prototype;b.destory=function(){this.destroyed=!0;var a,d;for(d in this._panList)(a=this._panList[d])&&!a.destroyed&&a.destroy();this._loadingTag=this._radioGroup=this._preitem=this._prepanel=this._panList=this._panContent=null};b.selectTag=function(a,d,b){a=this._radioGroup.getItemByTag(a);null!=a&&(b=this._radioGroup.items.indexOf(a),null!=d&&(a.tabOpenParam=d),this._radioGroup.selectedIndex=b)};b.setTabData=function(a,d,b,c){if(null==d)throw Error("\u9009\u9879\u5361\u5bb9\u5668\u4e0d\u80fd\u4e3a\u7a7a");this._panContent=d;this._radioGroup=a;this._radioGroup.groupCheckFunc=c;this._radioGroup.groupCheckCaller=b;this._panList={};this._radioGroup.on("change",this,this.onSelect);if(-1!=this._radioGroup.selectedIndex)this.onSelect()};b.onSelect=function(){null!=this._prepanel&&(this._radioGroup.isLastClick&&(D.doCloseTabCallBack(this._preitem.tabTag),this._radioGroup.isLastClick=!1),this._prepanel.close(),this._prepanel.destroyed&&(this._panList[this._preitem.tabTag]=null),this._preitem=this._prepanel=null);var a=this._radioGroup.items[this._radioGroup.selectedIndex],d=this._panList[a.tabTag];null==d?"string"==typeof a.tabBindPanel?(this._loadingTag[a.tabBindPanel]=a.tabTag,J.Ins.load(a.tabBindPanel,x.create(this,this.openTab,[a.tabBindPanel]))):a.tabBindPanel instanceof laya.display.Scene&&this.openTab(a.tabTag,a.tabBindPanel):this.openTab(a.tabTag,d)};b.openTab=function(a,d){if(this.destroyed)d&&d.close();else{var b;"string"==typeof a?(b=this._loadingTag[a],delete this._loadingTag[a]):b=a;null==d||this._radioGroup.selectedIndex!=this._radioGroup.getTagIndex(b)?(this._panList[b]=null,d&&(d.close(),d.destroyed||(this._panList[b]=d))):(a=this._radioGroup.getItemByTag(b),this._prepanel=this._panList[b]=d,this._preitem=a,this._panContent.addChild(d),d.onOpened(a.tabOpenParam))}};return c})();var zb=function(){function c(){}g(c,"engine.base.define.MTweenFunc");c.GetEaseFuncByID=function(b){b=c.ID_TO_TYPE[parseInt(b/1E3+"")]+c.ID_TO_IDT[b%1E3];return c.TWEEN_EASE[b]};c.GetEaseFunc=function(b,a){return c.TWEEN_EASE[b+a]};c.LINEAR="Linear";c.SINE="Sine";c.CUBIC="Cubic";c.CIRC="Circ";c.EXPO="Expo";c.BOUNCE="Bounce";c.BACK="Back";c.ELASTIC="Elastic";c.QUAD="Quad";c.QUART="Quart";c.QUINT="Quint";c.STRONG="Strong";c.EASEIN="easeIn";c.EASEOUT="easeOut";c.EASEINOUT="easeInOut";c.EASENONE="easeNone";y(c,["TWEEN_EASE",function(){return this.TWEEN_EASE={}},"ID_TO_TYPE",function(){return this.ID_TO_TYPE={}},"ID_TO_IDT",function(){return this.ID_TO_IDT={}}]);c.__init$=function(){c.ID_TO_TYPE[1]="Linear";c.ID_TO_TYPE[2]="Sine";c.ID_TO_TYPE[3]="Cubic";c.ID_TO_TYPE[4]="Quint";c.ID_TO_TYPE[5]="Circ";c.ID_TO_TYPE[6]="Elastic";c.ID_TO_TYPE[7]="Quad";c.ID_TO_TYPE[8]="Quart";c.ID_TO_TYPE[9]="Expo";c.ID_TO_TYPE[10]="Back";c.ID_TO_TYPE[11]="Bounce";c.ID_TO_TYPE[12]="Strong";c.ID_TO_IDT[0]="easeNone";c.ID_TO_IDT[1]="easeIn";c.ID_TO_IDT[2]="easeOut";c.ID_TO_IDT[3]="easeInOut";c.TWEEN_EASE.LineareaseNone=r.linearNone;c.TWEEN_EASE.LineareaseIn=r.linearIn;c.TWEEN_EASE.LineareaseOut=r.linearOut;c.TWEEN_EASE.LineareaseInOut=r.linearInOut;c.TWEEN_EASE.SineeaseIn=r.sineIn;c.TWEEN_EASE.SineeaseOut=r.sineOut;c.TWEEN_EASE.SineeaseInOut=r.sineInOut;c.TWEEN_EASE.CubiceaseIn=r.cubicIn;c.TWEEN_EASE.CubiceaseOut=r.cubicOut;c.TWEEN_EASE.CubiceaseInOut=r.cubicInOut;c.TWEEN_EASE.CirceaseIn=r.circIn;c.TWEEN_EASE.CirceaseOut=r.circOut;c.TWEEN_EASE.CirceaseInOut=r.circInOut;c.TWEEN_EASE.ExpoeaseIn=r.expoIn;c.TWEEN_EASE.ExpoeaseOut=r.expoOut;c.TWEEN_EASE.ExpoeaseInOut=r.expoInOut;c.TWEEN_EASE.BounceeaseIn=r.bounceIn;c.TWEEN_EASE.BounceeaseOut=r.bounceOut;c.TWEEN_EASE.BounceeaseInOut=r.bounceInOut;c.TWEEN_EASE.BackeaseIn=r.backIn;c.TWEEN_EASE.BackeaseOut=r.backOut;c.TWEEN_EASE.BackeaseInOut=r.backInOut;c.TWEEN_EASE.ElasticeaseIn=r.elasticIn;c.TWEEN_EASE.ElasticeaseOut=r.elasticOut;c.TWEEN_EASE.ElasticeaseInOut=r.elasticInOut;c.TWEEN_EASE.QuadeaseIn=r.quadIn;c.TWEEN_EASE.QuadeaseOut=r.quadOut;c.TWEEN_EASE.QuadeaseInOut=r.quadInOut;c.TWEEN_EASE.QuarteaseIn=r.quartIn;c.TWEEN_EASE.QuarteaseOut=r.quartOut;c.TWEEN_EASE.QuarteaseInOut=r.quartInOut;c.TWEEN_EASE.QuinteaseIn=r.quintIn;c.TWEEN_EASE.QuinteaseOut=r.quintOut;c.TWEEN_EASE.QuinteaseInOut=r.quintInOut;c.TWEEN_EASE.StrongeaseIn=r.strongIn;c.TWEEN_EASE.StrongeaseOut=r.strongOut;c.TWEEN_EASE.StrongeaseInOut=r.strongInOut};return c}();(function(){function c(a,d){this._maxCount=a;this._nodeClass=d;this._list=[];N.rcd(this)}g(c,"engine.base.pool.ObjectPool");var b=c.prototype;b.Push=function(a){null==a?n.LogError("[ObjectPool push] node is null"):f.__typeof(a,this._nodeClass)?a.inPool?n.LogError("[ObjectPool push] node in pool"):this._list.length<this._maxCount?(a.Clean(),this._list[this._list.length]=a,a.inPool=!0):a.destroy():n.LogError("[ObjectPool push] node isn't thie specify Class")};b.Pop=function(){if(0<this._list.length){var a=this._list.pop();a.inPool=!1;return a}return new this._nodeClass};b.Clean=function(){var a,d;for(d in this._list)a=this._list[d],a.destroy();this._list.length=0};e(0,b,"maxCount",null,function(a){this._maxCount=a});e(0,b,"count",function(){return this._list.length});return c})();var Ab=function(){function c(a,d){this._tipsData=null;this._compUI=a;this._tipsPanel=d;this._compUI.on("click",this,this.OnShowTips)}g(c,"engine.ui.tips.TipsHandler");var b=c.prototype;b.SetTipsData=function(a){this._tipsData=a};b.OnShowTips=function(a){null!=this._tipsPanel&&(J.Ins.close(this._tipsPanel),J.Ins.open(this._tipsPanel,this._tipsData))};b.destroy=function(){null!=this._compUI&&(this._compUI.off("click",this,this.OnShowTips),this._compUI=null,null!=this._tipsPanel&&(this._tipsPanel=null),this._tipsData=null)};return c}();(function(){function c(){}g(c,"engine.battle.move.EnumBattleMoveType");c.NONE=0;c.RUN=1;c.JUMP=2;c.JUMP_DIE=3;return c})();var S=function(){function c(){}g(c,"engine.utils.MCUtil");c.AddChildOnly=function(b,a){c.DisposeAllChild(b);null!=a&&b.addChild(a)};c.RemoveSelf=function(b){if(null!=b){var a=b.parent;null!=a&&a.removeChild(b)}};c.RemoveAllChild=function(b){null!=b&&b.removeChildren()};c.DisposeAllChild=function(b){if(null!=b)for(var a=0;a<b.numChildren;++a)c.DisposeDisplay(b.getChildAt(a))};c.DisposeArray=function(b){if(null!=b){for(var a=0;a<b.length;++a)c.DisposeDisplay(b[a]);b.length=0}};c.DisposeDisplay=function(b){null!=b&&(b.hasOwnProperty("Dispose")?b.Dispose():b.hasOwnProperty("destroy")?b.destroy():b.hasOwnProperty("dispose")?b.dispose():b instanceof laya.display.Node&&b.removeSelf())};c.ToTop=function(b){if(null!=b){var a=b.parent;if(null!=a){var d=a.numChildren-1;a.getChildIndex(b)!=d&&a.setChildIndex(b,d)}}};c.ToBottom=function(b){if(null!=b){var a=b.parent;null!=a&&0!=a.getChildIndex(b)&&a.setChildIndex(b,0)}};c.GetRelativePos=function(b,a){for(var d=new l;null!=b&&b!=a;)d.x+=b.x,d.y+=b.y,b=b.parent;return d};c.ToCenter=function(b,a,d){void 0===a&&(a=!0);void 0===d&&(d=!0);b.parent instanceof laya.display.Sprite&&(a&&(b.x=b.parent.width/2-b.width/2),d&&(b.y=b.parent.height/2-b.height/2))};return c}();(function(){function c(){}g(c,"engine.base.define.MGameDefine");c.GRID_WIDTH=72;c.GRID_HEIGHT=48;c.SCENEDIS_FAR=-1E7;c.SCENE_OBJECT_GID_BEGIN=10001;return c})();var Ka=function(){function c(a,d){this._point=a;this._type=d}g(c,"engine.scene.astar.AStarLinkLine");var b=c.prototype;e(0,b,"point",function(){return this._point});e(0,b,"type",function(){return this._type});return c}();(function(){function c(){}g(c,"engine.ui.enum.EnumLayer");c.SCENE=1;c.SCENE_BATTLE=3;c.BOTTOM=10;c.MIDDLE=11;c.FIX_1=12;c.FIX=13;c.FIX1=14;c.FIX2=15;c.POP=17;c.TOP_1=18;c.TOP=19;c.TOP1=21;c.TOP2=22;c.TOP3=23;c.TIP=24;c.PROMPT=25;c.LOADING=27;c.LOGIN=29;c.CREATE=30;c.TOTAST=31;return c})();(function(){function c(){}g(c,"engine.supports.utils.LanUtil");c.GetLanStr=function(b){if(null!=c.lanDic){var a=c.lanDic[b];if(a)return a}return b};c.lanDic=null;return c})();(function(){function c(){this.popupEffect=function(a){a.scale(1,1);a._effectTween=L.from(a,{x:f.stage.width/2,y:f.stage.height/2,scaleX:0,scaleY:0},300,r.backOut)};this.closeEffect=function(a){a._effectTween=L.to(a,{x:f.stage.width/2,y:f.stage.height/2,scaleX:0,scaleY:0},300,r.strongOut,x.create(this,this.doClose,[a]),0,!1,!1)};this.popupEffectHandler=new x(this,this.popupEffect);this.closeEffectHandler=new x(this,this.closeEffect)}g(c,"engine.pui.PDialogManager");var b=c.prototype;b._centerDialog=function(a){a.x=Math.round((f.stage.width-a.width>>1)+a.pivotX);a.y=Math.round((f.stage.height-a.height>>1)+a.pivotY)};b.open=function(a,d,b){void 0===d&&(d=!1);void 0===b&&(b=!1);d&&z.closeAll();this._clearDialogEffect(a);a.isPopupCenter&&this._centerDialog(a);z.root.addChild(a);this.doOpen(a);b&&null!=a.popupEffect&&a.popupEffect.runWith(a)};b._clearDialogEffect=function(a){a._effectTween&&(L.clear(a._effectTween),a._effectTween=null)};b.doOpen=function(a){a.onOpened(a._param)};b.close=function(a){this._clearDialogEffect(a);a.isShowEffect&&null!=a.closeEffect?a.closeEffect.runWith([a]):this.doClose(a)};b.doClose=function(a){a.closeHandler&&a.closeHandler.runWith(a.closeType);a.autoDestroyAtClosed?a.destroy():(a.onClosed(a.closeType),a.removeSelf())};b.lock=function(a){};b._checkMask=function(){};y(c,["instance",function(){return this.instance=new c}]);return c})();var Bb=function(){function c(b,a){this.texs=[];this.offxs=[];this.offys=[];for(var d=0;d<b.length;++d){var c=b[d],m=oa.create(a,c.dx,c.dy,c.dw,c.dh);m.alphaMask=a.alphaMask;this.texs.push(m);this.offxs.push(-c.poiw);this.offys.push(-(c.dh-c.poih))}}g(c,"engine.base.sheet.MSheetFrame");c.prototype.destroy=function(){for(var b=0;b<this.texs.length;++b)this.texs[b].destroy();this.offys=this.offxs=this.texs=null};return c}();(function(){function c(){}g(c,"engine.scene.move.EnumMoveType");c.MOVE_NONE=0;c.MOVE_RUN=1E3;return c})();(function(){function c(){}g(c,"engine.animation.define.MAnimationDefine");c.RESPACK_TYPE_2D=1;c.RESPACK_TYPE_3D=2;return c})();var Cb=function(){function c(){this.owner=null;this.dir=0;this.fades=this.intervals=null;this.useMemory=this.framenum=this.scale=0;this._frameModes=this._sheets=this._orgtex=null;this._loadFailTimes=0;this._isLoading=!1;this._waitAni=[]}g(c,"engine.base.sheet.MSheetDirection");var b=c.prototype;b.ParseMod=function(a){for(var d=new H,b=a.getInt16(),c=0;c<b;++c){var h=a.getInt32(),p=a.getInt16();d.set(h,qb.CreateOne(a,p))}b=a.getInt16();b!=this.framenum&&n.LogError("\u4e0d\u662f\u5355\u65b9\u5411\u7684\u6570\u636e\uff1f\uff1f");for(var h=[],c=0;c<b;++c){p=a.getInt16();if(0>p||1024<p){n.LogError("MSheetResPack (modnum \x3c 0 || modnum \x3e 1024) "+a.length);return}for(var e=W(p),f=0;f<p;++f){var g=a.getInt32();e[f]=d.get(g)}h[c]=e}this._frameModes=h};b.GetFrames=function(a){return null==this._sheets?(3<=this._loadFailTimes?a&&a.OnTextureFailed(this):(a&&-1==this._waitAni.indexOf(a)&&this._waitAni.push(a),this.LoadTexture()),null):this._sheets};b.LoadTexture=function(a){this._isLoading||(ea.Ins.LoadTexture(this.owner.compressTex,this.owner.path,this.dir,x.create(this,this.OnLoadDirectionComp,[a])),this._isLoading=!0)};b.OnLoadDirectionComp=function(a,d){this.__reeee(a,d)};b.__reeee=function(a,d){this._isLoading=!1;this.SetTexture(d);var b=this._waitAni;if(d)for(d=0;d<b.length;++d)b[d].isDestroyed||b[d].OnTextureLoaded(this);else for(this._loadFailTimes++,d=0;d<b.length;++d)b[d].OnTextureFailed(this);this._waitAni.length=0;a&&a.runWith(this)};b.SetTexture=function(a){if(a){this.releaseMem();this.useMemory=a.bitmap.gpuMemory;a.alphaMask&&(this.useMemory+=a.alphaMask.bitmap.gpuMemory);this._orgtex=a;this._sheets=[];for(var d=this._frameModes,b=d.length,c=this._sheets=[],h=0;h<b;++h){var p=new Bb(d[h],a);c.push(p)}}};b.releaseMem=function(){if(this._sheets){for(var a=this._sheets,d=0;d<a.length;++d)a[d].destroy();this._sheets=null}this._orgtex&&this._orgtex.destroy(!0);this._orgtex=null;this.useMemory=0};e(0,b,"isLoading",function(){return this._isLoading});e(0,b,"isReady",function(){return null!=this._sheets});return c}(),Da=function(){function c(){this._hash={};this._list=[];N.rcd(this)}g(c,"engine.base.container.HashList");var b=c.prototype;b.Get=function(a){return this._hash[a]};b.Each=function(a){for(var d=this._list,b=d.length,c=0;c<b;++c)a(d[c])};b.GetCount=function(){return this._list.length};b.Add=function(a,d){null==this._hash[a]&&(this._hash[a]=d,this._list.push(d))};b.Remove=function(a){var d=null;null!=this._hash[a]&&(d=this._hash[a],delete this._hash[a],this._list.splice(this._list.indexOf(d),1));return d};b.Clear=function(){var a=this._list;this._hash={};this._list=[];return a};b.CheckSize=function(){var a=0,d;for(d in this._hash)a++;return a==this._list.length};e(0,b,"list",function(){return this._list});return c}();(function(){function c(){this._typeListMap=new H;this._allObjectHashList=new Da;f.timer.loop(1,this,this.OnFrame)}g(c,"engine.scene.MSceneObject");var b=c.prototype;b.AddTypeObjList=function(a,d){if(null!=this._typeListMap.get(a))throw Error("AddTypeObjList key Already Exsit!");this._typeListMap.set(a,new Ea(a,d,this._allObjectHashList))};b.GetTypeObjectList=function(a){return this._typeListMap.get(a).hashList.list};b.EachTypeObjectList=function(a,d){this._typeListMap.get(a).hashList.Each(d)};b.OnFrame=function(){var a=f.timer.currTimer,d,b;for(b in this._typeListMap.values){d=this._typeListMap.values[b];d=d.hashList.list;var c,h;for(h in d)c=d[h],c.destroyed||c.OnFrame(a)}};b.DeleteObject=function(a){var d=this._allObjectHashList.Get(a);if(null!=d){var b=this._typeListMap.get(d.objectType);if(null==b)throw n.Log("DeleteObject TypeObjectList typeList \x3d\x3d null Error"),Error("DeleteObject TypeObjectList typeList \x3d\x3d null Error");b.RemoveSceneObject(a)}return d};b.AddObject=function(a,d,b,c){var k=this._typeListMap.get(d);null==k&&n.LogError("AddObject Unknow pooltype !!! pooltype :"+d);a=k.GetCreateSceneObject(a);a.map=qa.Ins;0==c?a.map.mapLayer.AddMiddle(a):c==Ia.LAYER_TYPE_BOTTOM?a.map.mapLayer.AddBottom(a):1==c?a.map.mapLayer.AddTop(a):n.LogError("AddObject Unknow layertype !!! layertype :"+c);a.SetRawData(b);return a};b.RemoveAllRoundObject=function(){var a,d;for(d in this._typeListMap.values)a=this._typeListMap.values[d],0!=a.pooltype&&a.RemoveAllSceneObject();1<this._allObjectHashList.GetCount()&&n.LogError("removeAllRoundObject but not Clear!!!!!!! "+this._allObjectHashList.GetCount());0==this._allObjectHashList.CheckSize()&&n.LogError("removeAllRoundObject objHash.CheckSize false!!!!!!")};b.FindObject=function(a){return 0==a?null:this._allObjectHashList.Get(a)};b.FindMouseObj=function(a,d){for(var b=this._allObjectHashList.list,c=b.length,h=null,p,e=0;e<c;++e)p=b[e],0==p.isNonMouseHit&&p.CheckLocalBounding(a,d)&&(null==h||p.gridY>=h.gridY)&&(h=p);return h};return c})();(function(){function c(){this._gridCon=this._backFaZhen=this._backAlpha=this._bottom=this._middle=this._top=this._container=null;this._shake=new Ga;c.Ins=this;this._container=new B;this._container.size(f.stage.designWidth,f.stage.designHeight);this._top=new B;this._middle=new B;this._bottom=new B;this._container.addChild(this._bottom);this._container.addChild(this._middle);this._container.addChild(this._top);this._container.zOrder=3}g(c,"engine.battle.MBattleScene");var b=c.prototype;b.Init=function(){f.timer.loop(1,this,this._OnFrame)};b.ResizeHandler=function(){this._container.pos((f.stage.width-this._container.width)/2,(f.stage.height-this._container.height)/2);this._backAlpha.graphics.clear();this._backAlpha.size(f.stage.width+50,f.stage.height+50);this._backAlpha.graphics.drawRect(0,0,this._backAlpha.width,this._backAlpha.height,"#0000005a");this._backAlpha.pos((this._container.width-this._backAlpha.width)/2,(this._container.height-this._backAlpha.height)/2)};b.OpenBattle=function(a){null==this._backAlpha&&(this._backAlpha=new B);null==this._backFaZhen&&(this._backFaZhen=new B,this._backFaZhen.size(628,396),this._backFaZhen.loadImage(a));this._backFaZhen.pos((this._container.width-this._backFaZhen.width)/2,(this._container.height-this._backFaZhen.height)/2);this.AddBottom(this._backAlpha);this.AddBottom(this._backFaZhen);this.ResizeHandler();z.root.addChild(this._container);f.stage.on("resize",this,this.ResizeHandler);this._gridCon&&f.stage.addChild(this._gridCon)};b.CloseBattle=function(){this._top.destroyChildren();this._bottom.destroyChildren();this._middle.destroyChildren();this._backFaZhen=this._backAlpha=null;this._container.removeSelf();this._gridCon&&this._gridCon.removeSelf();f.stage.off("resize",this,this.ResizeHandler)};b._OnFrame=function(){this.OnFrame(f.timer.currTimer)};b.OnFrame=function(a){this._shake.OnFrame(a);if(this._shake.GetShakeFlag()){a=this._shake.shakeValue.x;var d=this._shake.shakeValue.y;this._top.pos(a,d);this._middle.pos(a,d);this._bottom.pos(a,d)}};b.AddTop=function(a){this._top.addChild(a)};b.AddMiddle=function(a){this._middle.addChild(a)};b.AddBottom=function(a){this._bottom.addChild(a)};e(0,b,"middle",function(){return this._middle});e(0,b,"container",function(){return this._container});c.Ins=null;return c})();(function(){function c(){this._labelc=0;this._compParam=this._compFunc=this._timeline=null}g(c,"engine.greensock.TimelineExt");var b=c.prototype;b.to=function(a,d,b,c,h){void 0===h&&(h=0);this._timeline.to(a,d,b,c,h);return this};b.play=function(a,d){void 0===a&&(a=0);void 0===d&&(d=!1);this._timeline.play(a,d)};b.OnComplete=function(){null!=this._compFunc&&this._compFunc.apply(null,this._compParam);this.destroy()};b.destroy=function(){null!=this._timeline&&(this._timeline.destroy(),this._compParam=this._compFunc=this._timeline=null,aa.recover("TimelineExt",this))};c.create=function(a,d){var b=aa.getItemByClass("TimelineExt",c);b._compFunc=a;b._compParam=d;null!=b._compParam&&b._compParam.push(b);b._timeline=new Ba;b._timeline.on("complete",b,b.OnComplete);return b};return c})();var Db=function(){function c(){this.path=this.url=null;this.compressTex=!1;this.alltime=this.maxdir=this.blend=0;this.dirs=[]}g(c,"engine.base.sheet.MSheetResPack");var b=c.prototype;b.Parse=function(a){a=new ga(a);a.getInt32();a.getInt32();this.blend=a.getByte();this.maxdir=a.getByte();for(var d=0,b=0;b<this.maxdir;++b){var c=a.getByte();if(0!=c){var h=new Cb;this.dirs[b]=h;h.owner=this;h.dir=b;h.framenum=c;h.scale=100/a.getByte();isNaN(h.scale)&&(h.scale=1);h.intervals=[];for(var p=0;p<c;++p)h.intervals[p]=a.getInt16(),!this.alltime&&(d+=h.intervals[p]);!this.alltime&&(this.alltime=d);if(1==a.getInt16())for(h.fades=[],p=0;p<c;++p)h.intervals.push(a.getInt16());a.getInt16();h.ParseMod(a)}}a.clear()};b.LoadAllTexture=function(a){var d=this,b=!1;this.dirs.forEach(function(c){c&&(c.LoadTexture(x.create(this,d.OnOneTextureLoaded,[a])),b=!0)},this);b||a&&a.runWith(this)};b.OnOneTextureLoaded=function(a,d){var b=!0;this.dirs.forEach(function(a){a&&a.isLoading&&(b=!1)},this);b&&a&&a.runWith(this)};b.releaseMem=function(a){var d=this,b="";this.dirs.forEach(function(c){c&&c.isReady&&(null==a||-1==a.indexOf(c.dir))&&(b+=d.path+" dir"+c.dir+"\r\n",c.releaseMem())},this);return b};e(0,b,"useMemory",function(){var a=0;this.dirs.forEach(function(d){a+=d.useMemory});return a});e(0,b,"validDir",function(){var a="";this.dirs.forEach(function(d){d&&d.isReady&&(a+=d.dir+" ")});return a});return c}(),F=function(){function c(){}g(c,"engine.res.MAnimationUtil");c.RegType=function(b,a){c.RES_TYPE_MAP[b]=a};c.RegActType=function(b,a){c.ACTION_TYPE_MAP[b]=a};c.RegActLoop=function(b){c.ACTION_LOOP_MAP[b]=!0};c.IsLoop=function(b){return 1==c.ACTION_LOOP_MAP[b]};c.RegUnLoad=function(b,a,d){void 0===d&&(d=-1);c.UNLOAD_URLS.push([b,a,d])};c.IsUnload=function(b,a,d){for(var k=c.UNLOAD_URLS,m=0;m<k.length;++m)if(k[m][0]==b){var h=k[m][1],p=k[m][2];if(-1==h||h==a)return-1==p||p==d}return!1};c.ToKeyName=function(b,a,d,k){"string"!=typeof b&&"string"!=typeof a&&"string"!=typeof d||n.LogError("ToKeyName\u53c2\u6570\u7c7b\u578b\u9519\u8bef:  npctype\x3d"+b+" id\x3d"+a+" act\x3d"+d);var m=c.RES_TYPE_MAP[b],h=c.ACTION_TYPE_MAP[d];null==m&&n.LogError("\u6ca1\u6709\u6ce8\u518c\u7684\u52a8\u753b\u7c7b\u578b:"+b);null==h&&n.LogError("\u6ca1\u6709\u6ce8\u518c\u7684\u52a8\u4f5c\u7c7b\u578b:"+d);return null==k?m+"/"+a+"/"+h:m+"/"+a+"/"+k+"/"+h};c.ToShortKey=function(b,a,d){"string"!=typeof b&&"string"!=typeof a||n.LogError("ToKeyName\u53c2\u6570\u7c7b\u578b\u9519\u8bef:  type\x3d"+b+" id\x3d"+a);var k=c.RES_TYPE_MAP[b];null==k&&n.LogError("\u6ca1\u6709\u6ce8\u518c\u7684\u52a8\u753b\u7c7b\u578b:"+b);return null==d?k+"/"+a:k+"/"+a+"/"+d};c.GetActionName=function(b){return c.ACTION_TYPE_MAP[b]};c.ROOT_URL="res/animation/";c.UNLOAD_URLS=[];y(c,["RES_TYPE_MAP",function(){return this.RES_TYPE_MAP={}},"ACTION_TYPE_MAP",function(){return this.ACTION_TYPE_MAP={}},"ACTION_LOOP_MAP",function(){return this.ACTION_LOOP_MAP={}},"ACTION_MAP_MAP",function(){return this.ACTION_MAP_MAP={}}]);return c}();(function(){function c(){}g(c,"engine.supports.utils.JSONUtil");c.encode=function(b){return JSON.stringify(b)};c.decode2=function(b){if(null==b)return null;b=b.split("|").join(",");return c.decode(b)};c.decode=function(b){var a=null;try{if(null==b||""==b)return null;a=JSON.parse(b)}catch(d){c.DEBUG_MODE&&console.log("decode json error:"+d.message),a=null}return a};c.isJson=function(b){try{c.decode(b)}catch(a){return!1}return!0};c.DEBUG_MODE=!1;return c})();var Eb=function(){function c(a){this._disvalue=this._dirvalue=this._y=this._x=0;this._x=a.readShort();this._y=a.readShort();this._dirvalue=a.readByte();this._disvalue=a.readByte();N.rcd(this)}g(c,"engine.scene.data.MapDownHillData");var b=c.prototype;e(0,b,"x",function(){return this._x});e(0,b,"disvalue",function(){return this._disvalue});e(0,b,"y",function(){return this._y});e(0,b,"dirvalue",function(){return this._dirvalue});return c}();(function(){function c(){}g(c,"engine.utils.UITool");c.MakeUrl=function(b){return 0==b.indexOf("res/ui/")?b:"res/ui/"+b};c.GetSprite=function(b,a,d,k,m,h){void 0===a&&(a=!0);void 0===d&&(d=0);void 0===k&&(k=0);void 0===h&&(h="none");a&&(b=c.MakeUrl(b));a=new B;a.width=d;a.height=k;a.loadImage(b,m);a.cacheAs=h;return a};c.SetUIImage=function(b,a,d){void 0===d&&(d=!0);null!=b&&(d&&(a=c.MakeUrl(a)),b instanceof laya.ui.UIComponent?b.skin=a:b instanceof laya.display.Sprite?b.loadImage(a,0,0,b.width,b.height):b.graphics.loadImage(a,0,0,b.width,b.height))};c.AddFilter=function(b,a){if(null!=a){var d=b.filters;null!=d&&-1!=d.indexOf(a)||ob.addFilter(b,a)}};c.RemoveFilter=function(b,a){if(null!=a){var d=b.filters;null!=d&&-1!=d.indexOf(a)&&(d.splice(d.indexOf(a),1),b.filters=d)}};return c})();(function(){function c(){this._panList=this._panContent=this._pageParams=this._pages=null;this._curIndex=-1}g(c,"engine.pui.tab.SimpleTabControl");var b=c.prototype;b.destory=function(){var a,d;for(d in this._panList)(a=this._panList[d])&&!a.destroyed&&a.destroy();this._pageParams=this._pages=this._panList=this._panContent=null};b.setTabData=function(a,d,b){if(null==a)throw Error("\u9009\u9879\u5361\u5bb9\u5668\u4e0d\u80fd\u4e3a\u7a7a");this._panContent=a;this._pages=d;this._pageParams=b;this._panList={}};b.selectIndex=function(a){a!=this._curIndex&&this.showIndex(a)};b.showIndex=function(a){null!=this._panList[this._curIndex]&&(this._panList[this._curIndex].close(),this._panList[this._curIndex].destroyed&&(this._panList[this._curIndex]=null));this._curIndex=a;var d=this._panList[a];null==d?J.Ins.load(this._pages[a],x.create(this,this.openTab,[a])):this.openTab(a,d)};b.openTab=function(a,d){if(null==d||this._curIndex!=a)this._panList[a]=null,d&&(d.close(),d.destroyed||(this._panList[a]=d));else if(this._panList[a]=d,this._panContent.addChild(d),null!=this._pageParams)d.onOpened(this._pageParams[a]);else d.onOpened(null)};return c})();var ca=function(){function c(){}g(c,"engine.base.data.ByteBufferUtil");c.writeInt=function(b,a){for(;;)if(0==(a&-128)){b.writeByte(a);break}else b.writeByte(a&127|128),a>>>=7};c.readInt=function(b){var a=b.readByte();if(0<=a)return a;var d=a&127;if(0<=(a=b.readByte()))d|=a<<7;else if(d|=(a&127)<<7,0<=(a=b.readByte()))d|=a<<14;else if(d|=(a&127)<<14,0<=(a=b.readByte()))d|=a<<21;else if(d=d|(a&127)<<21|(a=b.readByte())<<28,0>a){for(a=0;5>a;a++)if(0<=b.readByte())return d;throw Error("Malformed VarInt");}return d};c.writeLong=function(b,a){if(null==a)b.writeByte(0);else{var d=c._temp_long,k=c._temp_long2;for(d.setValue(a.lValue,a.hValue);;)if(k.setValue(-128,4294967295),k.and(d).equals(0)){a=d.andInt(127);b.writeByte(a);break}else a=d.andInt(127)|128,b.writeByte(a),d=d.rightShiftFill0(7)}};c.readLong=function(b){for(var a=0,d=c._temp_long,k=new ua;64>a;){var m=b.readByte();d.setValue(m&127,0);d.leftShift(a);k.or(d);if(0==(m&128))return k.makeHex(),k;a+=7}throw Error("Malformed VarInt");};c.readString=function(b){var a=c.readInt(b);return 0==a?null:b.readUTFBytes(a)};y(c,["_temp_long",function(){return this._temp_long=new ua},"_temp_long2",function(){return this._temp_long2=new ua}]);return c}();(function(){function c(){}g(c,"engine.ui.events.CoolDownEvent");c.COOLDOWN_FINISHED="grid_cooldown_finished";c.COOLDOWN_WARNING="cooldown_warning";return c})();var u=function(){function c(){}g(c,"engine.base.define.MDirection");c.IsValid=function(b){return 0<=b&&7>=b};c.ValidDir=function(b,a){void 0===a&&(a=0);return 0<=b&&7>=b?b:a};c.GetObDir=function(b){return(b+4)%8};c.RandomDir=function(){return 8*Math.random()};c.GetDirOff=function(b,a){b=a-b;4<b&&(b-=8);-4>b&&(b+=8);return b};c.GetOffDir=function(b,a){return 0==c.IsValid(b)?c.NONE:(b+a%8+8)%8};c.ToAngle=function(b){if(0!=b){if(1==b)return 45;if(2==b)return 90;if(3==b)return 135;if(4==b)return 180;if(5==b)return 225;if(6==b)return 270;if(7==b)return 315}return 0};c.GetDir=function(b,a,d,k){b-=d;a-=k;return 0==b&&0==a?c.NONE:0==b?0<a?0:4:0>b?0<a?1:0>a?3:2:0<b?0<a?7:0>a?5:6:c.NONE};c.DirToNormalVector=function(b){switch(b){case 0:return new l(0,1);case 1:return new l(1,1);case 2:return new l(1,0);case 3:return new l(1,-1);case 4:return new l(0,-1);case 5:return new l(-1,-1);case 6:return new l(-1,0);case 7:return new l(-1,1);default:return new l(0,0)}};c.NUM=8;c.NONE=-1;c.UP=0;c.RIGHT_UP=1;c.RIGHT=2;c.RIGHT_DOWN=3;c.DOWN=4;c.LEFT_DOWN=5;c.LEFT=6;c.LEFT_UP=7;y(c,["VIRDIR_5",function(){return this.VIRDIR_5=[0,1,2,3,4,3,2,1]},"VIRDIR_2",function(){return this.VIRDIR_2=[0,0,0,0,0,1,1,1]},"VIRDIR_1",function(){return this.VIRDIR_1=[0,0,0,0,0,0,0,0]}]);return c}(),M=function(){function c(){this.resetGameTime=18E5;this._checkRestTime=0;this._refAniMap=new H;this._refKeyTimeMap={};this._gcProxy=new Fb}g(c,"engine.res.MSheetAnimationGC");var b=c.prototype;b.StartCheckGC=function(){f.timer.loop(c.GC_CHECK_TIME,this,this.OnFrame);this._checkRestTime=n.GetTimer()};b.DelForeverRes=function(a){this._gcProxy.DelForever(a)};b.RegisterForeverRes=function(a){this._gcProxy.RegisterForever(a)};b.RegisterTypeId=function(a,d,b,c,h,p){this._gcProxy.RegisterTypeId(a,d,b,c,h,p)};b.RefAni=function(a){this._refAniMap.set(a,n.GetTimer())};b.FreeAni=function(a){this._refAniMap.remove(a)};b.RefKey=function(a){this._refKeyTimeMap[a]=n.GetTimer()};b.OnFrame=function(){Math.floor(hb.gpuMemory/1048576*100)/100>c.MEMORY_THRESHOLD&&(this.DoGC(),T.Ins.DoGC(this._gcProxy),D.callbackOutGC&&D.callbackOutGC())};b.checkResetTime=function(){if(null!=v.window.conchConfig){var a=v.window.conchConfig.getTotalMem();1048576>a?console.log("\x3d\x3d\x3dcgc level 0."):1048576<a&&2097152>=a?(this.resetGameTime=21E5,console.log("\x3d\x3d\x3dcgc level 1.")):2097152<a&&3145728>=a?(this.resetGameTime=27E5,console.log("\x3d\x3d\x3dcgc level 2.")):(this.resetGameTime=36E5,console.log("\x3d\x3d\x3dcgc level 3."))}};b.isResetGame=function(){return n.GetTimer()-this._checkRestTime>this.resetGameTime&&v.onAndroid?!0:!1};b.DoGC=function(){for(var a={},d,b=this._refAniMap.keys,c=0;c<b.length;++c){var h=b[c];d=h.loadingkey;if(null!=d){var p=a[d];null==p?a[d]=[h.renderDir]:-1==p.indexOf(h.renderDir)&&p.push(h.renderDir)}}b=va.Ins.sheetPackMap;c=this._gcProxy;h="MSheetAnimationGC  do gc:\r\n";for(d in b)c.IsCanRelease(d,!0)&&(p=a[d],h+=b[d].releaseMem(p));console.log(h)};b.GetMAnimationCount=function(){for(var a=this._refAniMap.keys,d=0,b=0,c=0;c<a.length;++c)1==a[c].resPackType?d++:b++;return d+"_"+b};c.GC_CHECK_TIME=3E5;c.MEMORY_THRESHOLD=350;y(c,["Ins",function(){return this.Ins=new c}]);return c}(),w=function(){function c(){}g(c,"engine.tool.ToolMap");c.PixPt2GridPt=function(b,a,d){null==d&&(d=new l);return d.setTo(b/c.GRID_WIDTH|0,a/c.GRID_HEIGHT|0)};c.PixPtToGridPt=function(b){return new l(b.x/c.GRID_WIDTH|0,b.y/c.GRID_HEIGHT|0)};c.PixPt2PixMiddlePt=function(b,a){return new l((b/c.GRID_WIDTH|0)*c.GRID_WIDTH+c.GRID_WIDTH/2,(a/c.GRID_HEIGHT|0)*c.GRID_HEIGHT+c.GRID_HEIGHT/2)};c.PixPtToPixMiddlePt=function(b){return new l((b.x/c.GRID_WIDTH|0)*c.GRID_WIDTH+c.GRID_WIDTH/2,(b.y/c.GRID_HEIGHT|0)*c.GRID_HEIGHT+c.GRID_HEIGHT/2)};c.GridPt2PixPt=function(b,a,d){void 0===d&&(d=!0);return 1==d?new l(b*c.GRID_WIDTH+c.GRID_WIDTH_HALF,a*c.GRID_HEIGHT+c.GRID_HEIGHT_HALF):new l(b*c.GRID_WIDTH,a*c.GRID_HEIGHT)};c.GridPtToPixPt=function(b,a){void 0===a&&(a=!0);return 1==a?new l(b.x*c.GRID_WIDTH+c.GRID_WIDTH_HALF,b.y*c.GRID_HEIGHT+c.GRID_HEIGHT_HALF):new l(b.x*c.GRID_WIDTH,b.y*c.GRID_HEIGHT)};c.GridXToPixX=function(b){return b*c.GRID_WIDTH+c.GRID_WIDTH_HALF};c.GridYToPixY=function(b){return b*c.GRID_HEIGHT+c.GRID_HEIGHT_HALF};c.PixXToGridX=function(b){return b/c.GRID_WIDTH|0};c.PixXToPixXCenter=function(b){return(b/c.GRID_WIDTH|0)*c.GRID_WIDTH+c.GRID_WIDTH/2};c.PixYToGridY=function(b){return b/c.GRID_HEIGHT|0};c.PixYToPixYCenter=function(b){return(b/c.GRID_HEIGHT|0)*c.GRID_HEIGHT+c.GRID_HEIGHT/2};c.ArrayGridPt2PixPt=function(b){for(var a=[],d=0;d<b.length;d++)a.push(new l(b[d].x*c.GRID_WIDTH+c.GRID_WIDTH_HALF,b[d].y*c.GRID_HEIGHT+c.GRID_HEIGHT_HALF));return a};c.CalcEndPtByDir=function(b,a,d,k){void 0===k&&(k=!0);if(k){k=new l(b.x,b.y);b=new l(b.x,b.y);for(var m=0;m<d;++m){k.x+=c.DirectionOffsetX8[a];k.y+=c.DirectionOffsetY8[a];if(k.x>=qa.Ins.gridWidth||0>k.x)break;if(k.y>=qa.Ins.gridHeight||0>k.y)break;b.x=k.x;b.y=k.y}return b}return new l(b.x+c.DirectionOffsetX8[a]*d,b.y+c.DirectionOffsetY8[a]*d)};c.CalcSceneZOrder=function(b,a){return 1E5*a+b};c.CalcBeginPtByDir=function(b,a,d){a=u.GetObDir(a);return new l(b.x+c.DirectionOffsetX8[a]*d,b.y+c.DirectionOffsetY8[a]*d)};c.CalcDirectionSlant=function(b,a,d){void 0===d&&(d=u.NONE);return c.CalcDirSlant(b.x,b.y,a.x,a.y,d)};c.CalcDirSlant=function(b,a,d,k,m){return c.CalcDir4ByAngle(b,a,d,k)};c.GetAngle=function(b,a,d,c){return 180*Math.atan2(c-a,d-b)/Math.PI};c.AngleBetween=function(b,a,d){return b>a&&b<=d};c.CalcDir=function(b,a,d,c){return u.GetDir(b,a,d,c)};c.CalcDirection=function(b,a){return u.GetDir(b.x,b.y,a.x,a.y)};c.CalcBeginPtByPath=function(b,a){a=new l(a.x,a.y);for(var d=b.length-1;0<=d;d--){var k=b[d]&255,m=u.GetObDir(k>>5),k=k&31;a.x+=c.DirectionOffsetX8[m]*k;a.y+=c.DirectionOffsetY8[m]*k}return a};c.CalcNearPt=function(b,a,d){0==u.IsValid(a)&&(a=0);b=new l(b.x,b.y);for(var k=0;8>k&&(b.x+=c.DirectionOffsetX8[(k+a)%8],b.y+=c.DirectionOffsetY8[(k+a)%8],0!=d);k++);return b};c.PathToWay=function(b,a){var d=[],k=a.x|0;for(a=a.y|0;0<b.length;){var m=b.shift();if(0>m)return null;var h=m>>5,m=m&31,k=k+c.DirectionOffsetX8[h]*m;a+=c.DirectionOffsetY8[h]*m;d.push(new l(k,a))}return 0==d.length?null:d};c.CalcDis=function(b,a,d,c){return Math.sqrt((b-d)*(b-d)+(a-c)*(a-c))|0};c.CalcDisS=function(b,a,d,c){return Math.max(Math.abs(b-d),Math.abs(a-c))|0};c.CalcDistance=function(b,a){return Math.sqrt((b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y))|0};c.CalcDistanceS=function(b,a){return Math.max(Math.abs(b.x-a.x),Math.abs(b.y-a.y))|0};c.CalcStepPath=function(b,a){if(null==b)return null;if(1<b.length){a=c.CalcDir(a.x,a.y,b[0].x,b[0].y);var d=c.CalcDir(b[0].x,b[0].y,b[1].x,b[1].y);a==d?b.splice(2,b.length-2):b.splice(1,b.length-1)}return b};c.PathDirDisToPoint=function(b,a){if(null==a||0==a.length)return null;var d=[],k=b.x;for(b=b.y;a.length;){var m=a.shift()&255;if(0>m)return null;var h=m>>5,m=m&31,k=k+c.DirectionOffsetX8[h]*m;b+=c.DirectionOffsetY8[h]*m;d.push(c.GridPt2PixPt(k,b))}return 0==d.length?null:d};c.PathPointToDirDis=function(b,a){if(2<a.length){var d=[],k=a.length;d.push(a[k-1]);for(--k;0<k;k--)0<=k-2&&c.CalcSlope(a[k],a[k-1])==c.CalcSlope(a[k-1],a[k-2])||d.push(a[k-1]);d.reverse();a=d}for(var d=[],m=b.x,h=b.y,k=0;k<a.length;k++){b=a[k];m=c.CalcPathNode(m,h,b.x,b.y);if(0==m.length)return null;for(;m.length;)d.push(m.shift());m=b.x;h=b.y}return d};c.CalcPathNode=function(b,a,d,k){var m=Math.max(Math.abs(b-d),Math.abs(a-k));if(0==m)return[];b=c.CalcDir(b,a,d,k);a=m/30;m%=30;d=[];for(k=0;k<a;k++)d.push(b<<5|30);0!=m&&d.push(b<<5|m);return d};c.CalcSlope=function(b,a){var d=b.x-a.x;b=b.y-a.y;return 0!=d?b/d:2147483647};c.SearchPointByCondition=function(b,a,d,k,m,h){void 0===m&&(m=!1);void 0===h&&(h=10);a==u.NONE&&(a=0);if(d.call(k,b))return new l(b.x,b.y);var p,e,f=new l,g,q=new l;for(p=0;p<h;p++){var n=u.GetObDir(a),r=u.GetOffDir(a,-2),t=u.GetOffDir(a,-2);f.x=b.x+c.DirectionOffsetX8[a]*(p+1);f.y=b.y+c.DirectionOffsetY8[a]*(p+1);if(d.call(k,f))return f;for(e=0;e<p+1;e++){g=u.GetOffDir(a,-3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q;g=u.GetOffDir(a,3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q}if(!m){f.x=b.x+c.DirectionOffsetX8[r]*(p+1);f.y=b.y+c.DirectionOffsetY8[r]*(p+1);if(d.call(k,f))return f;for(e=0;e<p;e++){g=u.GetOffDir(r,-3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q;g=u.GetOffDir(r,3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q}f.x=b.x+c.DirectionOffsetX8[t]*(p+1);f.y=b.y+c.DirectionOffsetY8[t]*(p+1);if(d.call(k,f))return f;for(e=0;e<p;e++){g=u.GetOffDir(t,-3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q;g=u.GetOffDir(t,3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q}f.x=b.x+c.DirectionOffsetX8[n]*(p+1);f.y=b.y+c.DirectionOffsetY8[n]*(p+1);if(d.call(k,f))return f;for(e=0;e<p+1;e++){g=u.GetOffDir(n,-3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q;g=u.GetOffDir(n,3);q.x=f.x+c.DirectionOffsetX8[g]*(e+1);q.y=f.y+c.DirectionOffsetY8[g]*(e+1);if(d.call(k,q))return q}}}return new l(b.x,b.y)};c.SnakeTrans=function(b,a,d){void 0===d&&(d=2E3);var k=b.x,m=b.y,h=0,e=1,f=1,g=0;if(!a(k,m)){for(var l=0;l<d&&(l++,k+=c.DirectionOffsetX4[g],m+=c.DirectionOffsetY4[g],f--,0==f&&(g=(g+1)%4,h++,2==h&&(h=0,e++),f=e),!a(k,m)););l>=d&&n.LogError("SnakeTrans limit over:"+b.toString())}};c.GetBloodDirsByDir=function(b){for(var a=[b],d=1;8>d;++d){var c=b,m=(d+1)/2|0,c=0==d%2?c+m:c-m;0>c?c+=8:8<=c&&(c-=8);a.push(c)}return a};c.GetNearCheckPoint=function(b,a,d){var c=Math.abs(a.x-b.x),m=Math.abs(a.y-b.y),h=c<<1,e=m<<1,f=a.x<b.x?-1:1,g=a.y<b.y?-1:1,n=0,q=b.x,r=b.y;if(!d(b.x,b.y))return b;b=new l(q,r);if(m>c)for(;r!=a.y;)if(n-h<-m&&(q+=f,n+=e),r+=g,n-=h,d(q,r))b.x=q,b.y=r;else return b;else if(m<c)for(;q!=a.x;)if(n-e<-c&&(r+=g,n+=h),q+=f,n-=e,d(q,r))b.x=q,b.y=r;else return b;else for(;q!=a.x;)if(r+=g,q+=f,d(q,r))b.x=q,b.y=r;else return b;return a};c.CanMoveByLine=function(b,a,d){var c=Math.abs(a.x-b.x),m=Math.abs(a.y-b.y),h=c<<1,e=m<<1,f=a.x<b.x?-1:1,g=a.y<b.y?-1:1,l=0,q=b.x;b=b.y;if(!d(q,b))return!1;if(m>c)for(;b!=a.y;){if(l-h<-m&&(q+=f,l+=e),b+=g,l-=h,!d(q,b))return!1}else if(m<c)for(;q!=a.x;){if(l-e<-c&&(b+=g,l+=h),q+=f,l-=e,!d(q,b))return!1}else for(;q!=a.x;)if(b+=g,q+=f,!d(q,b))return!1;return!0};c.CalcDir8ByAngle=function(b,a,d,c){if(a==c)return b<d?2:b>d?6:u.NONE;if(b==d)return a<c?4:0;var k=Math.atan((c-a)/-(d-b)),h=Math.PI/8,e=Math.PI/2-h;return k>-h&&k<=h?b<d?2:6:k>h&&k<=e?b<d?1:5:k>-e&&k<=-h?b<d?3:7:a<c?4:0};c.CalcDir4ByAngle=function(b,a,d,c){if(a==c)return b<d?3:b>d?5:u.NONE;if(b==d)return a<c?5:1;a=Math.atan((c-a)/(d-b));if(0>a)return b<d?1:5;if(0<a)return b<d?3:7;console.log("What!!");return u.NONE};c.GetDirection=function(b,a){return c.GetDirection2(b.x,b.y,a.x,a.y)};c.GetDirection2=function(b,a,d,c){b-=d;a-=c;return 0==b&&0==a?u.NONE:0==b?0<a?0:4:0>b?0<a?1:0>a?3:2:0<b?0<a?7:0>a?5:6:u.NONE};c.sign=function(b){return 0==b?0:0<b?1:-1};c.speedUp=function(b){if(null==b)return null;for(var a=[],d=u.NONE,c=1;c<b.length;++c){var m=b[c-1],h=b[c],e=u.GetDir(m.x,m.y,h.x,h.y);d!=e&&(d=e,a.push(m));c==b.length-1&&a.push(h)}return 1>a.length?null:a};c.ToClientGrid=function(b,a){null==a&&(a=new l);a.x=b>>16;a.y=b&65535;return a};c.ToClientGridList=function(b){for(var a=[],d=0;d<b.length;++d){var c=new l;c.x=b[d]>>16;c.y=b[d]&65535;a.push(c)}return a};c.ToPosition=function(b,a){return a|b<<16};c.ToClientX=function(b){return b>>16&65535};c.ToClientY=function(b){return b&65535};c.DIRECTION_MODE=1;c.GRID_WIDTH=72;c.GRID_HEIGHT=48;y(c,["DirectionOffsetX8",function(){return this.DirectionOffsetX8=[0,1,1,1,0,-1,-1,-1]},"DirectionOffsetY8",function(){return this.DirectionOffsetY8=[-1,-1,0,1,1,1,0,-1]},"DirectionOffsetX4",function(){return this.DirectionOffsetX4=[0,1,0,-1]},"DirectionOffsetY4",function(){return this.DirectionOffsetY4=[-1,0,1,0]},"GRID_WIDTH_HALF",function(){return this.GRID_WIDTH_HALF=36},"GRID_HEIGHT_HALF",function(){return this.GRID_HEIGHT_HALF=24}]);return c}(),Fa=function(){function c(){this.findPathCallBack=this._node=this._modifyNodes=this._floydPath=this._path=this._startNode=this._endNode=this._grid=this._open=null;this.testCount=0;this.heuristic=null;this.nowversion=this._straightCost=1;this.haveGuDao=!1;this._diagCost=Math.SQRT2;this.heuristic=this.manhattan}g(c,"engine.scene.astar.AStarEx");var b=c.prototype;b.setGrid=function(a){this._grid=a};b.createGrid=function(a,d){this._grid=new Ja(a,d)};b.justMin=function(a,d){return a.f<d.f};b.findPath=function(a){void 0===a&&(a=0);this._endNode=this._grid.endNode;if(null==this._endNode)return!1;this.nowversion++;this._startNode=this._grid.startNode;var d=null;if(this.haveGuDao&&(!this._endNode.walkable||this._endNode.nodeType!=this._startNode.nodeType)&&(d=this._grid.findReplacer(this._grid.startNode,this._endNode,!1),null==d))return!1;null!=d&&(this._endNode=d);this._open=new vb(this.justMin);this._startNode.g=0;this._modifyNodes=[];return this.search(a)};b.GetPathFloyd=function(){if(null==this._path||0==this._path.length)return null;for(var a=c.floyd(this._path,this._grid),d=[];a.length;){var b=a.shift();if(null==b)break;d.push(new l(b.x,b.y))}return d};b.searchTask=function(){for(var a=0,d=null;this._node!=this._endNode;){for(var b=this._node.links.length,c=0;c<b;c++){var h=this._node.links[c].node,e=this._node.g+this._node.links[c].cost,f=this.heuristic(h),g=e+f;h.version==this.nowversion?h.f>g&&(h.f=g,h.g=e,h.h=f,h.parent=this._node):(h.f=g,h.g=e,h.h=f,h.parent=this._node,this._open.ins(h),h.version=this.nowversion,this._modifyNodes.push(h))}if(1==this._open.a.length){d=this.findNearPath(this._endNode);break}this._node=this._open.pop();a++}d&&(this._endNode=d);0!=a&&this.buildPath();return 0!=a};b.search=function(a){this.testCount=0;this._node=this._startNode;this._node.version=this.nowversion;return this.searchTask()};b.findNearPath=function(a){if(0==this._modifyNodes.length)return null;for(var d=this._modifyNodes[0],b,c=this._modifyNodes.length,h=Math.abs(a.x-d.x)+Math.abs(a.y-d.y),e,f=1;f<c;f++)b=this._modifyNodes[f],e=Math.abs(a.x-b.x)+Math.abs(a.y-b.y),e>h||e==h&&b.g>=d.g||(d=b,h=e);return d};b.buildPath=function(){this._path=[];var a=this._endNode;this._path.push(a);for(var d=0;null!=a&&a!=this._startNode&&!(a=a.parent,this._path.unshift(a),d++,1E4<d););1E4<d&&(this._path.length=0,console.log("\u9519\u8bef\u7684\u5bfb\u8def\uff0c\u6ea2\u51fa\u4e86\uff01\uff01\uff01"));null!=this.findPathCallBack&&this.findPathCallBack.call()};b.manhattan=function(a){return Math.abs(a.x-this._endNode.x)+Math.abs(a.y-this._endNode.y)};e(0,b,"grid",function(){return this._grid},function(a){this._modifyNodes=this._floydPath=this._path=this._startNode=this._endNode=null;this._grid=a});c.floyd=function(a,d){a=a.concat();var b=a.length;if(2<b){var m=new sa(0,0),h=new sa(0,0);c.floydVector(m,a[b-1],a[b-2]);for(b=a.length-3;0<=b;b--)c.floydVector(h,a[b+1],a[b]),m.x==h.x&&m.y==h.y?a.splice(b+1,1):(m.x=h.x,m.y=h.y)}b=a.length;for(--b;0<=b;b--)for(m=0;m<=b-2;m++)if(c.floydCrossAble(a[b],a[m],d)){for(h=b-1;h>m;h--)a.splice(h,1);b=m;break}return a};c.floydCrossAble=function(a,d,b){a=c.bresenhamNodes(new l(a.x,a.y),new l(d.x,d.y));for(d=a.length-2;0<d;d--)if(0<=a[d].x&&0<=a[d].y&&a[d].x<b.numCols&&a[d].y<b.numRows&&(!b.getNode(a[d].x,a[d].y).walkable||!b.getNode(a[d].x,a[d].y).dyWalkable))return!1;return!0};c.bresenhamNodes=function(a,d){var b=Math.abs(d.y-a.y)>Math.abs(d.x-a.x);if(b){var c=a.x;a.x=a.y;a.y=c;c=d.x;d.x=d.y;d.y=c}var c=d.x>a.x?1:d.x<a.x?-1:0,h=(d.y-a.y)/Math.abs(d.x-a.x),e=[],f=a.x+c,g=a.y+h;b?e.push(new l(a.y,a.x)):e.push(new l(a.x,a.y));for(Math.abs(a.x-d.x)==Math.abs(a.y-d.y)&&(a.x<d.x&&a.y<d.y?e.push(new l(a.x,a.y+1),new l(d.x,d.y-1)):a.x>d.x&&a.y>d.y?e.push(new l(a.x,a.y-1),new l(d.x,d.y+1)):a.x<d.x&&a.y>d.y?e.push(new l(a.x,a.y-1),new l(d.x,d.y+1)):a.x>d.x&&a.y<d.y&&e.push(new l(a.x,a.y+1),new l(d.x,d.y-1)));f!=d.x;){a=Math.floor(g);var n=Math.ceil(g);b?e.push(new l(a,f)):e.push(new l(f,a));a!=n?b?e.push(new l(n,f)):e.push(new l(f,n)):0!=h&&(b?(e.push(new l(n+1,f)),e.push(new l(n-1,f))):(e.push(new l(f,n+1)),e.push(new l(f,n-1))));f+=c;g+=h}b?e.push(new l(d.y,d.x)):e.push(new l(d.x,d.y));return e};c.floydVector=function(a,d,b){a.x=d.x-b.x;a.y=d.y-b.y};y(c,["Ins",function(){return this.Ins=new c}]);return c}(),tb=function(){function c(){this._gridHMax=this._gridWMax=this._curMapResId=this._height=this._width=0;this._gridSoundData=this._debugPath=this._astarGrid=this._gridsExtra=null;this._pathFinderf=new Fa;this._endpt=new l(-1,-1);this._grids=[];this._gridsDynamic=[]}g(c,"engine.scene.grid.MapGridData");var b=c.prototype;b.Init=function(){};b.LoadMap=function(a){this._curMapResId=a.mapresid;this._width=a.sceneWidth;this._height=a.sceneHeight;var d;this._gridHMax=Math.floor(this._height/48)+(0!=this._height%48?1:0);this._gridWMax=Math.floor(this._width/72)+(0!=this._width%72?1:0);var b=this._gridWMax*this._gridHMax;d=this._grids.length;if(b>d)for(this._grids.length=b,this._gridsDynamic.length=b;d<b;++d)this._grids[d]=3,this._gridsDynamic[d]=3;null!=this._astarGrid&&this._astarGrid.dispose();this._astarGrid=new Ja(this._gridWMax,this._gridHMax);this._gridsExtra=this._gridsExtra||[];var m,h,e,f,g,l,q,r;this._gridSoundData=Array(this._gridWMax);n.GetTimer();for(d=0;d<b;++d)m=d%this._gridWMax,h=Math.floor(d/this._gridWMax),0==h&&(this._gridSoundData[m]=Array(this._gridHMax)),e=Math.floor(d/8),f=d%8,a.blockDatas.pos=e,a.alphaDatas.pos=e,a.jumpDatas.pos=e,a.safeDatas.pos=e,a.effDatas.pos=d,a.gridsExtra.pos=4*d,g=a.blockDatas.readUnsignedByte(),l=a.alphaDatas.readUnsignedByte(),a.jumpDatas.readUnsignedByte(),q=a.safeDatas.readUnsignedByte(),e=a.effDatas.readUnsignedByte(),r=a.gridsExtra.readInt(),this._gridsExtra[d]=r,g=g>>7-f&1,c.NO_BLOCK&&(g=1),l=l>>7-f&1,f=q>>7-f&1,q=e&1,r=e>>1&1,e>>=2,0<e&&(this._gridSoundData[m][h]=e),e=(r<<6|q<<5|f<<3|l<<2|2|g&1)&255,this._grids[d]=e,g&1||this._astarGrid.setWalkable(m,h,!1);this._astarGrid.calculateLinks(a.linkLines);return!0};b.Clear=function(){this._debugPath=null;this._curMapResId=0;var a,d=this._gridHMax*this._gridWMax;for(a=0;a<d;++a)this._grids[a]=3,this._gridsDynamic[a]=3;this._gridSoundData=this._gridsExtra=null;this._gridWMax=this._gridHMax=this._height=this._width=0};b.TryFloodFill=function(a,d,b,c){void 0===c&&(c=1E4);if(d.x==a.x&&d.y==a.y)return c;this.GridIsWork(a.x,a.y,!0)&&b++;if(b>=c)return c;for(var k,m=0;8>m;m++){k=new l(a.x+w.DirectionOffsetX8[m],a.y+w.DirectionOffsetY8[m]);if(d.x==k.x&&d.y==k.y){b=c;break}if(!(0>k.x||0>k.y||k.x>=this._gridWMax||k.y>=this._gridHMax)&&this.GridIsWork(k.x,k.y,!0)&&(b=this.TryFloodFill(k,d,b,c),b>=c))break}return b};b.TestTargetBound=function(a,d){return 8>this.TryFloodFill(a,d,0,8)?!0:!1};b.AstarFindPath=function(a,d,b,c){this._pathFinderf.setGrid(this._astarGrid);this._pathFinderf.findPathCallBack=function(){};this._astarGrid.setStartNode(a,d);this._astarGrid.setEndNode(b,c);a=null;this._pathFinderf.findPath(1E4)&&(a=this._pathFinderf.GetPathFloyd());null!=a&&0==Array.length&&(a=null);return a};b.SearchFixFunc=function(a){return this.GridIsWorkWithBoard(a.x,a.y,!0)};b.FindPaths=function(a,d,b){d=w.SearchPointByCondition(d,u.GetDir(d.x,d.y,a.x,a.y),this.SearchFixFunc,this);this._debugPath=null;this._endpt.x=d.x;this._endpt.y=d.y;var c=null;try{c=this.AstarFindPath(a.x,a.y,d.x,d.y)}catch(h){f.errorCallBack?f.errorCallBack("name:"+b.name+" start:"+a.toString()+" end:"+d.toString()+"\n"+h.stack):null,c=null}return c};b.IsClear=function(){return 0==this._curMapResId};b.Type=function(a,d){return 0>a||0>d||a>=this._gridWMax||d>=this._gridHMax?0:this._grids[d*this._gridWMax+a]};b.TypeDy=function(a,d){return 0>a||0>d||a>=this._gridWMax||d>=this._gridHMax?0:this._gridsDynamic[d*this._gridWMax+a]};b.TypeEx=function(a,d){return null==this._gridsExtra||0>a||0>d||a>=this._gridWMax||d>=this._gridHMax?0:this._gridsExtra[d*this._gridWMax+a]};b.GetExtraType=function(a,d){return this.TypeEx(a,d)};b.GridTypeIsWork=function(a){return 0!=(a&1)};b.GridTypeIsWorkDy=function(a){return 0!=(a&1)};b.GridTypeIsCov=function(a){return 0!=(a&4)};b.GridTypeIsStop=function(a){return 0==(a&16)};b.GridIsWorkWithBoard=function(a,d,b){if(0>a||0>d||a>=this._gridWMax||d>=this._gridHMax)return!1;(b=this.GridTypeIsWork(this.Type(a,d)))&&(b=this.GridTypeIsWorkDy(this.TypeDy(a,d)));return b};b.GridIsWork=function(a,d,b){void 0===b&&(b=!0);var c=this.GridTypeIsWork(this.Type(a,d));c&&(c=this.GridTypeIsWorkDy(this.TypeDy(a,d)));return b?c&&this.CanMarkIsWalk(a,d):c};b.IsGridCanMove=function(a,d,b){void 0===b&&(b=!0);return this.GridIsWorkWithBoard(a,d,b)};b.GridIsCov=function(a,d){var b=this.GridTypeIsCov(this.Type(a,d));0==b&&(b=this.GridTypeIsCov(this.TypeDy(a,d)));return b};b.CanMarkIsWalk=function(a,d){return!0};e(0,b,"gridWMax",function(){return this._gridWMax});e(0,b,"gridHMax",function(){return this._gridHMax});e(0,b,"gridSoundData",function(){return this._gridSoundData});c.NO_BLOCK=!1;return c}(),Gb=function(){function c(){this.numh=this.numw=this.sizeh=this.sizew=this.pixh=this.pixw=this.layerType=0;this.tileFlags=null;N.rcd(this)}g(c,"engine.scene.data.ChunkLayerData");c.prototype.ReadData=function(b){var a,d;this.layerType=b.readByte();this.pixw=b.readInt();this.pixh=b.readInt();this.sizew=b.readShort();this.sizeh=b.readShort();this.numw=b.readShort();this.numh=b.readShort();this.tileFlags=Array(this.numw*this.numh);for(a=0;a<this.numh;++a)for(d=0;d<this.numw;++d)this.tileFlags[a*this.numw+d]=b.readInt()};return c}(),va=function(){function c(){this._callbackPrepareEnd=null;this._defaultResCount=this._defautlResId=this._defautlResType=0;this._sheetPackMap={};this._loaderQueue={}}g(c,"engine.res.MSheetAnimationMgr");var b=c.prototype;b.GetResPack=function(a,d){M.Ins.RefKey(d);var b=this._sheetPackMap[d];if(null==b){var c=this._loaderQueue[d];null==c?(c=[],this._loaderQueue[d]=c,c.push(a),ea.Ins.LoadBin(d,x.create(this,this.OnBinLoaded,[d]))):c.push(a)}return b};b.OnBinLoaded=function(a,d){this.addResPack(a,d);var b=this._loaderQueue[a],c,h;for(h in b)c=b[h],c.isDestroyed||(null!=d?c.OnBinLoaded(a,d):c.OnBinFailed(a));delete this._loaderQueue[a]};b.addResPack=function(a,d){null!=d&&(this._sheetPackMap[a]=d)};b.PrepareDefaultAnimationRes=function(a,d,b,c){this._callbackPrepareEnd=a;this._defautlResType=d;this._defautlResId=b;for(a=this._defaultResCount=0;a<c.length;++a){var k=F.ToKeyName(d,b,c[a]);ea.Ins.LoadBin(k,x.create(this,this.DefaultAnimationLoaded,[k]),!0);M.Ins.RegisterForeverRes(k);this._defaultResCount++}};b.DefaultAnimationLoaded=function(a,d){this.addResPack(a,d);this._defaultResCount--;0==this._defaultResCount&&(this._callbackPrepareEnd.run(),this._callbackPrepareEnd=null)};b.GetDefaultAnimation=function(a){return this._sheetPackMap[F.ToKeyName(this._defautlResType,this._defautlResId,a)]};b.PreloadAnimation=function(a,d,b){a=F.ToKeyName(a,d,b);ea.Ins.LoadBin(a,x.create(this,this.OnPreloadOne,[a]),!0)};b.OnPreloadOne=function(a,d){this.addResPack(a,d)};b.GetResPakNum=function(){var a=0,d;for(d in this._sheetPackMap)a++;return a};b.validRes=function(){var a="",d=0,b,c;for(c in this._sheetPackMap){b=this._sheetPackMap[c];for(var h=0;h<b.dirs.length;++h)b.dirs[h].isReady&&(a+=b.path+" "+b.dirs[h].dir+"\r\n",d+=b.dirs[h].useMemory)}console.log(a+("\u603b\u5185\u5b58\uff1a"+d))};e(0,b,"sheetPackMap",function(){return this._sheetPackMap});y(c,["Ins",function(){return this.Ins=new c}]);return c}();(function(){function c(){this._object=null;this._isDestroyed=!1;this._pathList=null;this._runSpeed=this._lastFrameTime=0;this._bCache=!1;this._prevMoveType=this._curMoveType=0;this._moveEndPos=null;this._moveStartDir=-1;this._curMoveDirection=this._movePercent=this._moveDistance=0;this._directPt=null;this._moveStartPos=new l;N.rcd(this)}g(c,"engine.scene.move.MoveRule");var b=c.prototype;f.imps(b,{"engine.scene.move.IMoveRule":!0});b.SetData=function(a){this._object=a};b.CheckMoveAbort=function(){0!=this.curMoveType&&this._object.OnMoveAbort(this._moveStartDir,this._curMoveType)};b.RunDirect=function(a,d){this._bCache||(this.CheckMoveAbort(),!this._directPt&&(this._directPt=new l),this._directPt.setTo(a,d),this.SetCurMoveType(1E3),this._InitPath([this._directPt]),this._lastFrameTime=f.timer.currTimer,this._object.OnMoveBegin(this._moveStartDir,this._curMoveType))};b.Run=function(a){this._bCache||(this.CheckMoveAbort(),this.SetCurMoveType(1E3),this._InitPath(a),this._lastFrameTime=f.timer.currTimer,this._object.OnMoveBegin(this._moveStartDir,this._curMoveType))};b._InitPath=function(a){var d=this._object;(d.decimalPixX|0)==(a[0].x|0)&&(d.decimalPixY|0)==(a[0].y|0)&&a.shift();0!=a.length&&(this._moveEndPos=a[a.length-1],this._moveStartPos.setTo(d.decimalPixX,d.decimalPixY),this._movePercent=0,this._curMoveDirection=this._moveStartDir=w.CalcDirectionSlant(this._moveStartPos,a[0]),this._moveDistance=w.CalcDistance(this._moveStartPos,this._moveEndPos),this._pathList=a)};b.OnFrame=function(a){var d=a-this._lastFrameTime;this._lastFrameTime=a;if(null!=this._pathList&&0<this._pathList.length){a=l.TEMP.setTo(this._object.decimalPixX,this._object.decimalPixY);var b=this._pathList[0],c=Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)),h=d/1E3*this._runSpeed;0==this._moveDistance&&(h=0);var d=!1,e;if(h<=c&&1>this._movePercent)e=Math.atan2(b.y-a.y,b.x-a.x),c=a.x+h*Math.cos(e),h=a.y+h*Math.sin(e);else{var f=this._pathList.shift();0==this._pathList.length?(c=f.x,h=f.y,d=!0):(h=c,b=this._pathList[0],e=Math.atan2(b.y-f.y,b.x-f.x),c=f.x+h*Math.cos(e),h=f.y+h*Math.sin(e),this._curMoveDirection=w.CalcDirSlant(c,h,b.x,b.y),this._object.OnMoveBegin(this._curMoveDirection,this._curMoveType))}this.SetNewObjectPos(c,h);a=w.CalcDistance(a,this._moveEndPos);0!=this._moveDistance&&(this._movePercent=Math.abs(this._moveDistance-a)/this._moveDistance);1<this._movePercent&&(this._movePercent=1);d&&this.MoveEnd()}};b.SetNewObjectPos=function(a,d){a=Math.round(a);d=Math.round(d);var b=this._object,c=b.gridX,h=b.gridY;b.SetPixPt(a,d);a=b.gridY;c==b.gridX&&h==a||b.OnMoveEnterGrid(c,h)};b.IsMoving=function(){return null!=this._pathList};b.Clear=function(){this._moveDistance=this._curMoveDirection=this._moveStartDir=0;this.SetCurMoveType(0);this._pathList=null;this._lastFrameTime=0;this._moveEndPos=null;this._movePercent=0};b.OnRecycle=function(){this.Clear();this._bCache=!0};b.OnRevert=function(){this._bCache=!1};b.StopMove=function(){this.MoveEnd()};b.MoveEnd=function(){var a=this._curMoveType;0!=a&&(this.Clear(),null!=this._object&&this._object.OnMoveEnd(-1,a))};b.SetMoveSpeed=function(a){this._runSpeed=a};b.SetCurMoveType=function(a){this._prevMoveType=this._curMoveType;this._curMoveType=a};b.destroy=function(a){this.Clear();this._isDestroyed=!0};e(0,b,"isDestroyed",function(){return this._isDestroyed});e(0,b,"curMoveType",function(){return this._curMoveType});e(0,b,"curMoveDirection",function(){return this._curMoveDirection});return c})();(function(){function c(){}g(c,"engine.base.pool.spool.SimplePool");c.recover=function(b){aa.recover(b.__className,b);b.clear()};c.getItem=function(b){return aa.getItemByClass(b.__className,b)};c.inPool=function(b){return 1==b.__InPool};return c})();var ea=function(){function c(){c.Ins=this}g(c,"engine.loaders.MAnimationLoader");var b=c.prototype;b.GetDataName=function(a){var d="data.bin";a&&(d=v.onAndroid?"etc.bin":"pvr.bin");return d};b.GetDirName=function(a,d){a?(a=v.onAndroid?"etcdir"+d:"pvrdir"+d,a+=".bin"):a="dir"+d+".png";return a};b.LoadBin=function(a,d,b){void 0===b&&(b=!1);var c=null==D.callbackUseCompressTexture||D.callbackUseCompressTexture(a),c=c&&!v.onWeiXin&&(null!=ba._compressedTextureEtc1||null!=ba._compressedTexturePvrtc),k=this.GetDataName(c),k=F.ROOT_URL+a+"/"+k;f.loader.load(k,x.create(this,this.OnBinLoaded,[c,k,a,d,b]),null,"arraybuffer",1,!1)};b.OnBinLoaded=function(a,d,b,c,h,e){var k=new Db;null==e?c&&c.runWith(null):(k.compressTex=a,k.url=d,k.path=b,k.Parse(e),h?k.LoadAllTexture(c):c&&c.runWith(k))};b.LoadTexture=function(a,d,b,c){var k=this.GetDirName(a,b),k=F.ROOT_URL+d+"/"+k;f.loader.load(k,x.create(this,this.OnTextureLoaded,[a,k,d,b,c]),null,a?"arraybuffer":null,1,!a)};b.OnTextureLoaded=function(a,d,b,c,e,f){f?a?(a=this.ParseCompressTex(d,f),e&&e.runWith(a)):e&&e.runWith(f):e&&e.runWith(null)};b.ParseCompressTex=function(a,d){v.now();d=new ga(d);var b=d.getInt32(),c=d.getUint8Array(d.pos,b),b=d.getInt32(),b=d.getUint8Array(d.pos,b),e=v.onAndroid?5:11,f=ya.create(0,0,e);f.setCompressData(c.buffer);f._setCreateURL(a);c=new oa(f);f=ya.create(0,0,e);f.setCompressData(b.buffer);f._setCreateURL(a);a=new oa(f);c.alphaMask=a;d.clear();v.now();return c};y(c,["Ins",function(){return this.Ins=new c}]);return c}(),sb=function(){function c(){this.sceneHeight=this.sceneWidth=this.mapresid=0;this.weatherData=this.downhillDataList=this.layerDataFar=this.layerDataGround=this.mapDownhillData=this.mapChunkData=this.soundData=this.effectData=this.gridsExtra=this.mapTopCoverData=this.disData=this.effDatas=this.safeDatas=this.jumpDatas=this.alphaDatas=this.blockDatas=null;this.weatherCreateItv=200;this.farLayerMoveSpeedRatio=0;this.topCoverCalcZOffset=new ra;this.linkLines=new ra}g(c,"engine.scene.data.MMapMetaData");var b=c.prototype;b.ParseMapMeta=function(a,d){this.disData=this.effDatas=this.safeDatas=this.jumpDatas=this.alphaDatas=this.blockDatas=this.mapDownhillData=this.mapChunkData=this.soundData=this.effectData=this.gridsExtra=this.mapTopCoverData=null;this.mapresid=a;this.sceneHeight=this.sceneWidth=0;d.uncompress();d.pos=0;var b=d.readInt();a=d.readInt();var c=d.readInt();this.blockDatas=new A;d.readBytes(this.blockDatas,0,c);c=d.readInt();this.alphaDatas=new A;d.readBytes(this.alphaDatas,0,c);c=d.readInt();this.safeDatas=new A;d.readBytes(this.safeDatas,0,c);c=d.readInt();this.jumpDatas=new A;d.readBytes(this.jumpDatas,0,c);c=d.readInt();this.effDatas=new A;d.readBytes(this.effDatas,0,c);this.mapTopCoverData=this.disData=null;if(20141228==b)for(;d.bytesAvailable;)b=d.readInt(),c=b>>24,b&=16777215,1==c?(this.gridsExtra=new A,d.readBytes(this.gridsExtra,0,b)):2==c?(this.effectData=new A,d.readBytes(this.effectData,0,b)):3==c?(n.Log("\u6b64\u5730\u56fe\u6709\u97f3\u6548\uff1a"+a),this.soundData=new A,d.readBytes(this.soundData,0,b)):4==c?(this.disData=new A,d.readBytes(this.disData,0,b)):5==c?(this.mapTopCoverData=new A,d.readBytes(this.mapTopCoverData,0,b)):6==c?(this.mapChunkData=new A,d.readBytes(this.mapChunkData,0,b)):7==c&&(this.mapDownhillData=new A,d.readBytes(this.mapDownhillData,0,b));else d.bytesAvailable&&(b=d.readInt(),b!=Number.MAX_VALUE&&(this.gridsExtra=new A,d.readBytes(this.gridsExtra,0,4*b)),d.bytesAvailable&&(d.readInt(),this.effectData=new A,d.readBytes(this.effectData,0,d.length-d.pos)));this.ParseChunkLayerData();this.ParseDownHillData();n.Log("LoadMap ok id:"+a)};b.ParseChunkLayerData=function(){var a=this.mapChunkData;a.endian="littleEndian";a.pos=0;this.weatherData=this.layerDataFar=this.layerDataGround=null;var d=a.readByte();this.sceneWidth=a.readInt();this.sceneHeight=a.readInt();for(var b=0;b<d;++b){var c=new Gb;c.ReadData(a);var e=new Hb;e.ReadData(a);0==c.layerType?(this.layerDataGround=c,this.weatherData=e):1==c.layerType&&(this.layerDataFar=c)}};b.ParseDownHillData=function(){if(null!=this.mapDownhillData){var a=this.mapDownhillData;a.endian="littleEndian";a.pos=0;this.downhillDataList=[];for(var d=a.readInt(),b=0;b<d;++b)this.downhillDataList.push(new Eb(a))}else this.downhillDataList=null};b.SetTopCoverCalcZOffset=function(a){this.topCoverCalcZOffset.clear();if(null!=a&&""!=a){a=a.split("|");for(var d=0;d<a.length;++d){var b=a[d].split(":");if(2==b.length){var c=b[1].split(",");this.topCoverCalcZOffset.put(b[0],new l(parseInt(c[0]),parseInt(c[1])))}}}};b.SetLinkLines=function(a){this.linkLines.clear();if(null!=a&&""!=a){a=a.split("|");for(var d=0;d<a.length;++d){var b=a[d].split(":");if(2==b.length){var c=b[0].split(","),e=new l(parseInt(c[0]),parseInt(c[1])),c=b[1].split(","),b=new l(parseInt(c[0]),parseInt(c[1])),c=1E4*e.x+e.y,f=1E4*b.x+b.y,g=this.linkLines.get(c);null==g&&(g=[],this.linkLines.put(c,g));g.push(new Ka(b,1));g=this.linkLines.get(f);null==g&&(g=[],this.linkLines.put(f,g));g.push(new Ka(e,1))}}}};c.CHUNK_TYPE_GROUND=0;c.CHUNK_TYPE_FAR=1;c.CHUNK_FLAG_ALL_ALPHA=1;c.CHUNK_FLAG_ALL_NO_ALPHA=2;c.CHUNK_FLAG_ALL_BLACK=4;c.FLAG_SPECIAL=1;c.FLAG_SCENEEFFECT=2;c.FLAG_SCENESOUND=3;c.FLAG_SCENEVIEW=4;c.FLAG_TOPCOVER=5;c.FLAG_CHUNK=6;c.FLAG_DOWNHILL=7;return c}(),n=function(){function c(){}g(c,"engine.tool.ToolBase");e(1,c,"serverMTime",function(){return null!=c.SERVER_MTIME?c.SERVER_MTIME.call():c.GetTimer()});c.INT=function(b){return b|0};c.GetTimer=function(){return(new Date).getTime()};c.RLog=function(b,a){try{c.Log(b)}catch(d){}};c.Log=function(b){b="["+c.GetTimer()+"][INFO] "+b;console.log(b)};c.LogError=function(b){if(null!=b)try{b="["+c.GetTimer()+"][ERROR] "+b,console.log(b)}catch(a){}};c.LogErrorAndDebug=function(b){if(null!=b)try{c.isDebug&&c.MessageBox(b),b="["+c.GetTimer()+"][ERROR] "+b,console.log(b)}catch(a){}};c.LogAndDeubgThrow=function(b){c.isDebug?c.LogThrow(b):c.LogError(b)};c.LogThrow=function(b){var a=c.GetStackTrace(b);c.LogError(a);throw Error(b);};c.GetStackTrace=function(b){var a;a="// \x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\n"+(b+"\n")+(console.trace()+"\n");var d=arguments.callee.caller,c=0;for(a+="***----------------------------------------  ** "+(c+1)+"\n";d&&10>c;)a+=d.toString()+"\n",d=d.caller,c++,a+="***---------------------------------------- ** "+(c+1)+"\n";return a+"// \x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\n"};c.MessageBox=function(b){null!=b&&Ib.Show(b)};c.Assert=function(b,a){if(0==b)throw Error(a);};c.GetTimerS=function(){return c.GetTimer()/1E3};c.GetFrameTimerS=function(){return c.GetTimerS()};c.GetWinWidth=function(){return f.stage.width};c.GetWinHeight=function(){return f.stage.height};c.RandomInt=function(b,a){return b+(Math.random()*(a-b)|0)};c.RandomArray=function(b){var a=c.RandomInt(0,b.length);return b[a]};c.RandomFloat=function(b,a){return b+Math.random()*(a-b)};c.RandomFloat2=function(b,a){return b+Math.random()*(a+1-b)};c.RandomBoolean=function(){return.5<Math.random()};c.GetPowOf2Value=function(b){for(var a=1;a<b;)a*=2;return a};c.ClampFloat=function(b,a,d){b=Math.min(Math.max(b,a),d);isNaN(b)&&(b=a);return b};c.ClampInt=function(b,a,d){return Math.min(Math.max(b,a),d)};c.LerpPoint=function(b,a,d){return new l(b.x+(a.x-b.x)*d,b.y+(a.y-b.y)*d)};c.LerpValue=function(b,a,d){return b+(a-b)*d};c.DivFloorInt=function(b,a){var d=b/a;0!=b%a&&d++;return d};c.CheckBitMask=function(b,a){return 0!=(b&a)};c.ClearBitMask=function(b,a){return b&~a};c.AddBitMask=function(b,a){return b|a};c.SetResRoot=function(b,a,d,k){c.ResRootAnimation=b;c.ResRootUI=a;c.ResRootSound=d;c.ResRootEffect=k;c.ResPathAnimation=c.GetResURL(b);c.ResPathUI=c.GetResURL(a);c.ResPathSound=c.GetResURL(d);c.ResPathEffect=c.GetResURL(k)};c.GetResAnimationURL=function(b){return"/"==b.charAt(0)?c.ResPathAnimation+b:c.ResPathAnimation+"/"+b};c.GetResUIURL=function(b){return null==b||""==b?c.ResPathUI:"/"==b.charAt(0)?c.ResPathUI+b:c.ResPathUI+"/"+b};c.GetResSoundURL=function(b){return"/"==b.charAt(0)?c.ResPathSound+b:c.ResPathSound+"/"+b};c.GetResEffectURL=function(b){return"/"==b.charAt(0)?c.ResPathEffect+b:c.ResPathEffect+"/"+b};c.GetResURL=function(b){return"/"==b.charAt(0)?c.GetResURLRoot()+b:c.GetResURLRoot()+"/"+b};c.GetResURLRoot=function(){null==c.ResPathRoot&&(c.ResPathRoot="res");return c.ResPathRoot};c.IsEqualPoint=function(b,a){return b.x==a.x&&b.y==a.y};c.IsEqualPoint2=function(b,a,d,c){return b==d&&a==c};c.IsContainsPoint=function(b,a){return b.contains(a.x,a.y)};c.isPowerOfTwo=function(b){return b?(b&-b)==b:!1};c.interpolate=function(b,a,d){return new l(a.x+d*(b.x-a.x),a.y+d*(b.y-a.y))};c.polar=function(b,a){return new l(b*Math.cos(a),b*Math.sin(a))};c.CreatePowOf2Bitmapdata=function(b){var a=b.width,d=b.height;0==c.isPowerOfTwo(a)&&(a=c.GetPowOf2Value(a));0==c.isPowerOfTwo(d)&&(d=c.GetPowOf2Value(d));if(b.width!=a||b.height!=d)throw Error("\u8fd9\u91cc\u8fd8\u6ca1\u6709\u5b9e\u73b0\uff01\uff01\uff01\u3002");return b};c.ParseFlagHead=function(b){var a="",a=String.fromCharCode(b>>24&255)+a,a=String.fromCharCode(b>>16&255)+a,a=String.fromCharCode(b>>8&255)+a;return a=String.fromCharCode(b>>0&255)+a};c.SortBubble=function(b){for(var a,d=0;d<b.length-1;d++)for(var c=b.length-1;c>d;c--)b[c].sortValue<b[c-1].sortValue&&(a=b[c-1],b[c-1]=b[c],b[c]=a)};c.SortQuick=function(b,a,d,k,m){void 0===d&&(d=1);void 0===k&&(k=0);void 0===m&&(m=2147483647);null==a&&(a="sortValue");2147483647==m&&(m=b.length-1);if(!(0>k||m>b.length)&&k<m){for(var e=k,f=m,g=b[k];e<f;){if(1==d)for(;e<f&&b[f][a]>=g[a];)f--;else for(;e<f&&b[f][a]<=g[a];)f--;e<f&&(b[e]=b[f],e++);if(1==d)for(;e<f&&b[e][a]<=g[a];)e++;else for(;e<f&&b[e][a]>=g[a];)e++;e<f&&(b[f]=b[e],f--)}b[e]=g;c.SortQuick(b,a,d,k,e-1);c.SortQuick(b,a,d,e+1,m)}};c.RemoveAllChildren=function(b,a){for(void 0===a&&(a=!0);0<b.numChildren;)a?b.getChildAt(0).destroyChildren():b.removeChildAt(0)};c.Create3DRect=function(b,a,d,c){c=new B;c.graphics.drawRect(0,0,b,a,d);return c};c.Create2DRect=function(b,a,d,c){return null};c.Create2DRectSprite=function(b,a,d,c){return null};c.CloneDictionary=function(b,a){null==a&&(a=new H);if(null!=b)for(var d in b)a[d]=b[d];return a};c.DegreeGetAngleByPoint=function(b,a,d,c){if(d==b&&c==a)return 0;d>b?c>a?(b=Math.atan((c-a)/(d-b)),a=90):(b=Math.atan((d-b)/(a-c)),a=0):c>a?(b=Math.atan((b-d)/(c-a)),a=180):(b=Math.atan((a-c)/(b-d)),a=270);return 180*b/Math.PI+a};c.DegreeAngleToRadian=function(b){return Math.PI/180*b};c.DegreeRadianToAngle=function(b){return 180/Math.PI*b};c.DegreeDirToRadian=function(b){return c.DegreeAngleToRadian(c.DegreeDirToAngle(b))};c.DegreeDirToAngle=function(b){return-90+45*b};c.getAngle=function(b,a){return 180/Math.PI*Math.atan2(b.y-a.y,b.x-a.x)};c.getRadian=function(b,a){return Math.PI/180*c.getAngle(b,a)};c.PointEquals=function(b,a){return b.x==a.x&&b.y==a.y};c.INT_MAX=2147483647;c.INT_MIN=-2147483648;c.stg=null;c.isDebug=!0;c.ERROR_THROW=!0;c.SERVER_MTIME=null;c.ResPathRoot=null;c.ResRootAnimation=null;c.ResRootUI=null;c.ResRootSound=null;c.ResRootEffect=null;c.ResPathAnimation=null;c.ResPathUI=null;c.ResPathSound=null;c.ResPathEffect=null;c.ResPathMap=null;y(c,["startTime",function(){return this.startTime=f.timer.currTimer},"ColorMaterialCache",function(){return this.ColorMaterialCache=new ra}]);return c}(),T=function(){function c(){this._resTypeName={};this._cacheTemplet=new H;this._refAniMap=new H}g(c,"engine.templet.MTempletManager");var b=c.prototype;b.RegisterType=function(a,d){this._resTypeName[a]=d};b.ToKeyName=function(a,d){return"res/"+this._resTypeName[a]+"/"+d+".sk"};b.GetTemplet=function(a,d){a=this.ToKeyName(a,d);d=this._cacheTemplet.get(a);null==d&&(d=new Jb,this._cacheTemplet.set(a,d));d.isParserComplete||d.loadAni(a);return d};b.RefAni=function(a){this._refAniMap.set(a,n.GetTimer())};b.FreeAni=function(a){this._refAniMap.remove(a)};b.DoGC=function(a){for(var d=this._refAniMap.keys,b=[],c=0;c<d.length;++c){var e=d[c];null!=e.loadingkey&&b.push(e.loadingkey)}e=this._cacheTemplet.keys;d=[];for(c=0;c<e.length;++c)-1==b.indexOf(e[c])&&a.IsCanRelease(e[c],!1)&&d.push(e[c]);a="MTempletManager gc:\n";for(c=0;c<d.length;++c)a+=d[c]+"\n",e=this._cacheTemplet.get(d[c]),e.destroy(),this._cacheTemplet.remove(d[c]);console.log(a)};y(c,["Ins",function(){return this.Ins=new c}]);return c}();(function(){function c(){}g(c,"engine.scene.grid.EnumSceneGridType");c.BARRIER=0;c.W_UF=1;c.UW_F=2;c.EMPTY=3;c.COVERING=4;c.SAFE=8;c.USTOP=16;c.WATER=32;c.WATERLESS=64;c.TRANS=128;c.MaxType=65535;c.WORK=1;c.FLY=2;c.COV=4;return c})();var Fb=function(){function c(){this._foreverMap=[];this._resTypeId=[]}g(c,"engine.res.MAnimationGCProxy");var b=c.prototype;b.RegisterForever=function(a){-1==this._foreverMap.indexOf(a)&&this._foreverMap.push(a)};b.DelForever=function(a){a=this._foreverMap.indexOf(a);0<=a&&this._foreverMap.splice(a,1)};b.RegisterTypeId=function(a,d,b,c,e,f){0<d&&(a=F.ToShortKey(a,d,b),a=this._resTypeId.indexOf(a),-1!=a&&this._resTypeId.splice(a,1));0<e&&(c=F.ToShortKey(c,e,f),-1==this._resTypeId.indexOf(c)&&this._resTypeId.push(c))};b.IsCanRelease=function(a,d){if(-1!=this._foreverMap.indexOf(a))return!1;if(!d){d=this._resTypeId;for(var b=d.length,c=0;c<b;++c)if(0==a.indexOf(d[c]))return!1}return!0};return c}(),Kb=function(){function c(){this._chunksShowTime=this._chunksURL=this._chunks=this._container=null;this._isDynamic=!1;this._url=null;this._tileNumH=this._tileNumW=this._tileSizeH=this._tileSizeW=this._totalHeight=this._totalWidth=0;this.failIDXs=null;this._viewRc=new P}g(c,"engine.scene.chunk.PTileImageControl");var b=c.prototype;b.Init=function(a){this._container=a};b.Dispose=function(){this.Clear()};b.SetData=function(a,d,b,c,e,f,g){this._url=a;this._totalWidth=d;this._totalHeight=b;this._tileSizeW=c;this._tileSizeH=e;this._tileNumW=Math.ceil(this._totalWidth/this._tileSizeW);this._tileNumH=Math.ceil(this._totalHeight/this._tileSizeH);a=this._tileNumW*this._tileNumH;this._chunks=W(a);this._chunksURL=W(a);this._chunksShowTime=W(a);this.failIDXs=[]};b.Clear=function(){this._url=null;this._totalHeight=this._totalWidth=0;if(null!=this._chunks){for(var a=this._chunks,d=this._chunksURL,b=a.length,c=0;c<b;c++)null!=a[c]&&null!=a[c].texture&&(a[c].texture.disposeBitmap(),a[c].texture.destroy()),null!=a[c]&&a[c].destroy(!0),null!=d[c]&&f.loader.cancelLoadByUrl(d[c]);this._chunksURL=this._chunks=null}this.failIDXs=null};b.clearFailIDXs=function(){if(null!=this.failIDXs&&0<this.failIDXs.length&&null!=this._chunksShowTime)for(var a;0<this.failIDXs.length;)a=this.failIDXs.shift(),this._chunksShowTime.length>a&&(this._chunksShowTime[a]=0)};b.IsClear=function(){return 0==this._totalWidth};b.GetChunkUrls=function(a){var d=this._viewRc,b=this._tileSizeW,c=this._tileSizeH;d.x=Math.floor(a.x/b)-1;d.y=Math.floor(a.y/c)-1;d.width=Math.ceil(a.width/b)+2;d.height=Math.ceil(a.height/c)+2;a=[];for(var b=[],c=Math.max(d.x,0),e=Math.min(d.y+d.height,this._tileNumH),f=Math.min(d.x+d.width,this._tileNumW),d=Math.max(d.y,0);d<e;d++)for(var g=c;g<f;g++){var l=this._url.replace("{0}",g),l=l.replace("{1}",d);a.push(l);b.push([g,d])}return[a,b]};b.UpdateChunk=function(a){if(!this.IsClear()){var d=this._viewRc,b=this._tileSizeW,e=this._tileSizeH;d.x=Math.floor(a.x/b)-1;d.y=Math.floor(a.y/e)-1;d.width=Math.ceil(a.width/b)+2;d.height=Math.ceil(a.height/e)+2;for(var h=n.GetTimer(),f=!1,g=!1,l=this._chunksShowTime,r=this._chunks,q=this._tileNumH,t=this._tileNumW,u=0;u<q;u++)for(var v=0;v<t;v++){if(1==g&&1==f)return;var w=u*b+v,e=d.contains(v,u);a=r[w];null!=a&&(a.visible=e);1==e?null!=a||f||(this.LoadChunk(v,u),f=!0,l[w]=h):null!=a&&h-l[w]>c.RELEASE_TIME&&!g&&(null!=a.texture&&(a.texture.disposeBitmap(),a.texture.destroy(),a.texture=null),a.destroy(!0),r[w]=null,g=!0)}}};b.LoadChunk=function(a,d){var b=d*this._tileSizeW+a,c=this._chunks;null==c[b]&&(c[b]=new B,c[b].pos(a*this._tileSizeW,d*this._tileSizeH));null==c[b].texture&&(c=this._url.replace("{0}",a),c=c.replace("{1}",d),this._chunksURL[b]=c,f.loader.load(c,x.create(this,this.LoadChunkOK,[a,d,c])))};b.LoadChunkOK=function(a,d,b,c){a=d*this._tileSizeW+a;null!=c&&null!=c.getIsReady&&c.getIsReady()&&null!=c.url?(b=this._chunks,null==b||null==b[a]?(n.Log("chunk load suc but container destroyed  url:"+c.url),c.destroy()):(d=c.url.replace(pb.basePath,""),this._chunksURL[a]!=d?(n.Log("chunk load over but url isnot equal to container url [container url\x3d"+this._chunksURL[a]+" loadurl:"+c.url),c.destroy()):(b=b[a],b.texture=c,this._container.addChild(b)))):(console.log("chunk load fail url:"+b),null==c&&this.failIDXs.push(a))};c.RELEASE_TIME=3E4;return c}();(function(){function c(){this._obj=null;this._moveTime=this._moveStartTime=this._moveDistance=this._movePercent=this._curJumpHeight=this._moveType=0;this._sPt=new l;this._ePt=new l;this._jumpDebugDisList=[]}g(c,"engine.battle.move.MBattleMoveRule");var b=c.prototype;b.SetData=function(a){this._obj=a};b.destroy=function(){this.ClearDebug();this._obj=null};b.ClearDebug=function(){for(var a=0;a<this._jumpDebugDisList.length;++a)this._jumpDebugDisList[a].destroy();this._jumpDebugDisList.length=0};b.Move=function(a,d,b,c){this.ClearDebug();this._moveType=a;this._obj.GetPixPt(this._sPt);this._ePt.setTo(La.GridXToPixX(d),La.GridYToPixY(b));this._moveDistance=this._ePt.distance(this._sPt.x,this._sPt.y);this._movePercent=0;this._moveStartTime=f.timer.currTimer;this._moveTime=c;a=this._obj.GetGridPt();d=w.CalcDirSlant(a.x,a.y,d,b);this._obj.OnMoveStart(this._moveType,d)};b.OnFrame=function(a){if(this._moveType){this._movePercent=Math.min(1,(f.timer.currTimer-this._moveStartTime)/this._moveTime);var d=this._obj.GetGridPt(l.TEMP);a=d.x;var b=d.y,d=this._sPt.x+(this._ePt.x-this._sPt.x)*this._movePercent|0,c=this._sPt.y+(this._ePt.y-this._sPt.y)*this._movePercent|0;if(1<=this._movePercent)this._curJumpHeight=0;else if(2==this._moveType||3==this._moveType)this.CalcJumpHeight(),this._obj.SetJumpHeight(this._curJumpHeight);this._obj.SetPixPt(l.TEMP.setTo(d,c));d=this._obj.GetGridPt(l.TEMP);a==d.x&&b==d.y||this._obj.OnMoveEnterGrid(a,b);1<=this._movePercent&&this.Stop()}};b.Stop=function(){this._curJumpHeight=0;if(0!=this._moveType){var a=this._moveType;this._moveType=0;this._obj.OnMoveEnd(a)}};b.CalcJumpHeight=function(){var a=1-this._movePercent,d=this._moveDistance;0==d&&(d=450);d*=1.2;this._curJumpHeight=-d*a*a+d*a;this._curJumpHeight+=0;this._curJumpHeight|=0};b.isJumpType=function(a){return 2==a||3==a};e(0,b,"isMoving",function(){return 0!=this._moveType});e(0,b,"isJump",function(){return this.isJumpType(this._moveType)});e(0,b,"curJumpHeight",function(){return this._curJumpHeight});c.JUMP_HEIGHT_CALC_TYPE=1;return c})();var La=function(){function c(){}g(c,"engine.battle.MBattleUtil");c.GetFrontPt=function(b,a,d,c){null==c&&(c=l.TEMP.setTo(0,0));c.x=b+w.DirectionOffsetX8[d];c.y=a+w.DirectionOffsetY8[d];return c};c.GetBackPt=function(b,a,d,c){null==c&&(c=l.TEMP.setTo(0,0));c.x=b-w.DirectionOffsetX8[d];c.y=a-w.DirectionOffsetY8[d];return c};c.GetBackPix=function(b,a,d,k){null==k&&(k=l.TEMP.setTo(0,0));k.x=c.GridXToPixX(b);k.y=c.GridYToPixY(a);k.x-=48*w.DirectionOffsetX8[d];k.y-=36*w.DirectionOffsetY8[d];return k};c.GridXToPixX=function(b){return 48*b+24};c.GridYToPixY=function(b){return 36*b+18};c.PixXToGridX=function(b){return b/48|0};c.PixYToGridY=function(b){return b/36|0};c.GRIDW=48;c.GRIDH=36;return c}(),Ia=function(){function c(){this._curSceneW=this._curSceneH=0;this._map=this._screenSceneRect=this._lookTarget=this._layerTop=this._layerMiddle=this._layerBottom=this._layerMap=this._sceneRoot=null;this._isSceneMoving=!1;this._curShowScale=this._realSceneScale=1;this._tweenTime=this._tweenStartValue=this._tweenStartTime=0;this._cameraRealPos=new l;this._camraPosAreaRect=new P;this.pixOffPt=new l;this._shakeControl=new Ga}g(c,"engine.scene.layer.MapSceneLayer");var b=c.prototype;b.Init=function(a){this._map=a;this._screenSceneRect=new P(0,0,f.stage.width,f.stage.height);this._sceneRoot=new C;this._sceneRoot.name="sceneRoot";this._sceneRoot.scrollRect=this._screenSceneRect;this._layerMap=new C;this._layerMap.name="layerMap";this._layerBottom=new C;this._layerBottom.name="layerBottom";this._layerMiddle=new C;this._layerMiddle.name="layerMiddle";this._layerTop=new C;this._layerTop.name="layerTop";this._sceneRoot.addChild(this._layerMap);this._sceneRoot.addChild(this._layerBottom);this._sceneRoot.addChild(this._layerMiddle);this._sceneRoot.addChild(this._layerTop);f.stage.on("resize",this,this.ResizeHandler)};b.ChangeMap=function(a){this._shakeControl.Clear();this._curSceneW=a.sceneWidth;this._curSceneH=a.sceneHeight;a=a.layerDataGround;this.layerMap.size(a.pixw,a.pixh);this.ResizeHandler()};b.ResizeHandler=function(){var a=f.stage.width,d=f.stage.height;if(0<this._curSceneW){var b=0,c=0;a>this._curSceneW&&(b=(a-this._curSceneW)/2);d>this._curSceneH&&(c=(d-this._curSceneH)/2);this._layerMap.pos(b,c);this._layerBottom.pos(b,c);this._layerMiddle.pos(b,c);this._layerTop.pos(b,c)}};b.Clear=function(){this._shakeControl.Clear();this._curSceneH=this._curSceneW=0};b.IsClear=function(){return 0==this._curSceneH};b.SetLookTarget=function(a){this._lookTarget=a};b.CheckLookTarget=function(a){this._lookTarget==a&&this.LookTarget()};b.CalcSceneRect=function(a,d){var b=new P;b.width=n.GetWinWidth()/this._curShowScale;b.height=n.GetWinHeight()/this._curShowScale;a=w.GridXToPixX(a);var c=w.GridYToPixY(d);d=a-b.width/2+this.pixOffPt.x;a=c+b.height/2+this.pixOffPt.y;c=this._camraPosAreaRect;c.x=0;c.y=b.height;c.width=this._curSceneW-b.width;c.height=this._curSceneH-b.height;d>c.right&&(d=c.right);d<c.x&&(d=c.x);a>c.bottom&&(a=c.bottom);a<c.y&&(a=c.y);b.x=Math.floor(d);b.y=Math.floor(a-b.height);c=this._cameraRealPos;if(c.x!=d||c.y!=-a)c.x=d,c.y=-a;return b};b.LookTarget=function(){if(null!=this._lookTarget&&0==c.StopMove){var a=this._screenSceneRect;a.width=n.GetWinWidth()/this._curShowScale;a.height=n.GetWinHeight()/this._curShowScale;var d=this._lookTarget.x-a.width/2+this.pixOffPt.x,b=this._lookTarget.y+a.height/2+this.pixOffPt.y,e=this._camraPosAreaRect;e.x=0;e.y=a.height;e.width=this._curSceneW-a.width;e.height=this._curSceneH-a.height;d>e.right&&(d=e.right);d<e.x&&(d=e.x);b>e.bottom&&(b=e.bottom);b<e.y&&(b=e.y);a.x=Math.floor(d);a.y=Math.floor(b-a.height);e=this._cameraRealPos;e.x!=d||e.y!=-b||this._shakeControl.GetShakeFlag()?(e.x=d,e.y=-b,a.x+=this._shakeControl.shakeValue.x,a.y+=this._shakeControl.shakeValue.y,this._isSceneMoving=!0):this._isSceneMoving=!1;this.sceneRoot.scrollRect=a}};b.OnWinResize=function(a,d){};b.OnFrame=function(a){this.IsClear()||(this._shakeControl.OnFrame(a),0!=this._tweenStartTime&&(a=(a-this._tweenStartTime)/this._tweenTime,0>a||1<a?(this._curShowScale=this._realSceneScale,this._tweenStartTime=0):this._curShowScale=r.sineInOut(a,this._tweenStartValue,this._realSceneScale-this._tweenStartValue,1),this.ApplyScale()),this.LookTarget())};b.ApplyScale=function(){this._sceneRoot.scaleX=this._curShowScale;this._sceneRoot.scaleY=this._curShowScale};b.GetScreenSceneRect=function(){return this._screenSceneRect};b.AddLayerMap=function(a){this._layerMap.addChild(a)};b.AddMiddle=function(a){this._layerMiddle.addChild(a)};b.AddTop=function(a){this._layerTop.addChild(a)};b.AddBottom=function(a){this._layerBottom.addChild(a)};b.RemoveMiddle=function(a){this._layerMiddle.removeChild(a)};b.RemoveTop=function(a){this._layerTop.removeChild(a)};b.RemoveBottom=function(a){this._layerBottom.removeChild(a)};b.RemoveLayerMap=function(a){this._layerMap.removeChild(a)};b.GetMiddle=function(){return this._layerMiddle};b.SetSceneScale=function(a,d){a!=this._realSceneScale?(this._tweenTime=d,0<d?(this._tweenStartTime=n.GetTimer(),this._tweenStartValue=this._curShowScale,this._realSceneScale=a):(this._tweenStartTime=0,this._realSceneScale=this._curShowScale=a,this.ApplyScale())):this._tweenStartTime=0};e(0,b,"layerMap",function(){return this._layerMap});e(0,b,"layerBottom",function(){return this._layerBottom});e(0,b,"layerMiddle",function(){return this._layerMiddle});e(0,b,"layerTop",function(){return this._layerTop});e(0,b,"sceneRoot",function(){return this._sceneRoot});e(0,b,"curShowScale",function(){return this._curShowScale});e(0,b,"shakeControl",function(){return this._shakeControl});c.StopMove=!1;c.LAYER_TYPE_BOTTOM=-1;c.LAYER_TYPE_MIDDLE=0;c.LAYER_TYPE_TOP=1;return c}(),J=function(){function c(){this.maskHit=this.Hide_Toast=this.Show_Taost=null;this.BG_MASK_URL="res/ui/sg_ui/city/bg2.jpg";this.tex=null;this.isSimpleMask=this.isImgMask=!1;this.tempAlpha=1;this._loading=[];this._sceenMask=new Q;this._sceenMask2=new Q;this._sceenMask.on("click",this,this.clickMask);this._sceenMask.name="sceenMask";this._sceenMask2.on("click",this,this.clickMask2);this._sceenMask2.name="sceenMask2";this.maskHit=new cb;this._sceenMask.hitArea=this.maskHit}g(c,"engine.pui.PUIMgr");var b=c.prototype;b.Init=function(a,d){this.Show_Taost=a;this.Hide_Toast=d;t.regClass("Button",Lb);t.regClass("CheckBox",Mb);t.regClass("Clip",Nb);t.regClass("ComboBox",Ob);t.regClass("FontClip",Pb);t.regClass("HScrollBar",Ma);t.regClass("HSlider",Qb);t.regClass("Image",E);t.regClass("Label",Na);t.regClass("List",Rb);t.regClass("Panel",Sb);t.regClass("ProgressBar",Tb);t.regClass("Radio",Oa);t.regClass("RadioGroup",Ub);t.regClass("ScrollBar",Pa);t.regClass("Slider",Qa);t.regClass("Tab",Vb);t.regClass("TextInput",Wb);t.regClass("Tree",Xb);t.regClass("VScrollBar",Ra);t.regClass("VSlider",Yb);t.regClass("Box",Zb);t.regClass("View",Sa);t.regClass("Dialog",Ta);t.regClass("PGrid",Ua);t.regClass("PGridGroup",$b);t.regClass("laya.display.Text",I);t.regClass("Text",I);t.regClass("laya.html.dom.HTMLDivElement",ac);t.regShortClassName([Sa,Ta]);f.stage.on("resize",this,this._onResize)};b.open=function(a,d,b,c,e,g){void 0===b&&(b=!1);void 0===g&&(g=!0);a=this.formatUrl(a);if(-1==this._loading.indexOf(a)){var k=this.getShow(a,e);if(null!=k)try{k.onOpened(d),null!=c&&c.runWith(k)}catch(da){console.error(da.stack),f.errorCallBack&&f.errorCallBack(da.stack)}else this.Show_Taost&&g&&this.Show_Taost.apply(),this._loading.push(a),z.open(a,b,d,x.create(this,this.onSceneLoaded,[a,c,e]))}};b.opencls=function(a,d,b,c,e,g){void 0===b&&(b=!1);a=new a;if(null!=a){try{a.open(b,d)}catch(R){console.error(R.stack),f.errorCallBack?f.errorCallBack(R.stack):null}null!=e&&(a.name=e);null!=c&&c.runWith(a);this.checkMask()}};b.load=function(a,d,b,c){void 0===c&&(c=!0);a=this.formatUrl(a);-1==this._loading.indexOf(a)&&(this.Show_Taost&&c&&this.Show_Taost.apply(),this._loading.push(a),z.load(a,x.create(this,this.onSceneLoaded,[a,d,b])))};b.onSceneLoaded=function(a,d,b,c){a=this._loading.indexOf(a);-1!=a&&this._loading.splice(a,1);0==this._loading.length&&this.Hide_Toast&&this.Hide_Toast.apply();if(null!=c){null!=b&&(c.name=b);try{null!=d&&d.runWith(c)}catch(h){console.error(h.stack),f.errorCallBack&&f.errorCallBack(h.stack)}this.checkMask()}};b.close=function(a,d){void 0===d&&(d="");a=this.formatUrl(a);z.close(a,d)};b.closecls=function(a){for(var d=z.unDestroyedScenes,b=[],c=0,e=d.length;c<e;c++){var g=d[c];g&&g.parent&&f.__typeof(g,a)&&b.push(g)}for(c=0;c<b.length;++c)b[c].close()};b.closeLayer=function(a,d,b){void 0===d&&(d=!1);for(var c=z.root.numChildren,k=[],e=0;e<c;++e){var f=z.root.getChildAt(e);if(!d||f.isCloseWhenChangeMap)b&&-1!=b.indexOf(f.url)||f instanceof laya.display.Scene&&f.layer==a&&k.push(f)}for(e=0;e<k.length;++e)null==k[e].url&&console.log("closeLayer url\x3dnull:"+k[e].name),k[e].close()};b.getShow=function(a,d){void 0===d&&(d="");return"string"==typeof a?this.getShowByUrl(a,d):f.__isClass(a)?this.getShowByClass(a,d):null};b.getShowByUrl=function(a,d){void 0===d&&(d="");a=this.formatUrl(a);for(var b=z.root,c=z.root.numChildren,e=0;e<c;++e)if(b._children[e]instanceof laya.display.Scene&&b._children[e].url==a&&b._children[e].name==d)return b._children[e];return null};b.getShowByClass=function(a,d){void 0===d&&(d="");for(var b=z.root,c=z.root.numChildren,e=0;e<c;++e)if(b._children[e]instanceof laya.display.Scene&&f.__typeof(b._children[e],a)&&b._children[e].name==d)return b._children[e];return null};b.formatUrl=function(a){0!=a.indexOf("res/pages/")&&(a="res/pages/"+a);-1==a.lastIndexOf(".json")&&(a+=".json");return a};b._onResize=function(){this._sceenMask.displayedInStage&&this.drawMask();this._sceenMask2.displayedInStage&&this.drawMask2()};b.checkMask=function(){f.timer.callLater(this,this._realCheckMask)};b._realCheckMask=function(){this.isSimpleMask=this.isImgMask=!1;for(var a=z.root.numChildren-1;-1<a;a--){var d=z.root.getChildAt(a);!d||this.isSimpleMask||1!=d.isModal&&1!=d.isSimpleModal||(this.isSimpleMask=!0,d.parent==this._sceenMask2.parent?d.parent.getChildIndex(this._sceenMask2)<a?d.parent.setChildIndex(this._sceenMask2,a-1):d.parent.setChildIndex(this._sceenMask2,a):d.parent.addChildAt(this._sceenMask2,a),this._sceenMask2.tag=d,this._sceenMask2.zOrder=d.zOrder,this.drawMask2())}this.isImgMask||(this._sceenMask.tag=null,this._sceenMask.graphics.clear(),this._sceenMask.removeSelf(),this.maskHit.hit.clear());this.isSimpleMask||(this._sceenMask2.tag=null,this._sceenMask2.graphics.clear(),this._sceenMask2.removeSelf())};b.drawMask=function(){null==this.tex?f.loader.load(this.BG_MASK_URL,x.create(this,this.texComplete),null,"image"):(this._sceenMask.graphics.clear(!0),this._sceenMask.graphics.drawTexture(this.tex,(f.stage.width-this.tex.width)/2,(f.stage.height-this.tex.height)/2,this.tex.width,this.tex.height),this.maskHit.hit.clear(),this.maskHit.hit.drawRect(0,0,f.stage.width,f.stage.height,"#cccccc"))};b.drawMask2=function(){var a=this._sceenMask2.width=f.stage.width,d=this._sceenMask2.height=f.stage.height;this._sceenMask2.graphics.clear(!0);this._sceenMask2.graphics.drawRect(0,0,a,d,Ca.popupBgColor);this._sceenMask2.alpha=Math.min(Ca.popupBgAlpha,this.tempAlpha)};b.texComplete=function(){null==this.tex&&(this.tex=f.loader.getRes(this.BG_MASK_URL),this.checkMask())};b.clickMask=function(){var a=this._sceenMask.tag,d=a.modelMethod;null!=d?d.call(a.modelCaller):1!=a.modalUnclose&&a.close()};b.clickMask2=function(){var a=this._sceenMask2.tag,d=a.modelMethod;null!=d?d.call(a.modelCaller):1!=a.modalUnclose&&a.close()};e(0,b,"isWideScreen",function(){return!1});y(c,["Ins",function(){return this.Ins=new c}]);return c}(),sa=function(){function c(a,d){this.h=this.g=this.f=this.y=this.x=0;this._dyWalkable=this._walkable=!0;this.parent=this._walkbaleFunc=null;this.version=1;this.links=null;this.nodeType=2;this.buriedDepth=-1;this.distance=0;this.x=a;this.y=d}g(c,"engine.scene.astar.Node",null,"Node$1");var b=c.prototype;b.dispose=function(){if(this.links){var a,d;for(d in this.links)a=this.links[d],a.dispose()}this._walkbaleFunc=this.links=this.parent=null};b.toString=function(){return"x:"+this.x+" y:"+this.y};b.getDistanceTo=function(a){var d=a.x-this.x;a=a.y-this.y;return Math.sqrt(d*d+a*a)};e(0,b,"walkable",function(){return this._walkable},function(a){this._walkable=a;a||(this.nodeType=0)});e(0,b,"dyWalkable",function(){return null==this._walkbaleFunc||this._walkbaleFunc.call(null,this.x,this.y)?this._dyWalkable:!1},function(a){this._dyWalkable=a});e(0,b,"walkbaleFunc",null,function(a){this._walkbaleFunc=a});return c}(),Hb=function(){function c(){this._numh=this._numw=this._sizeh=this._sizew=0;this._hollowflag=[];N.rcd(this)}g(c,"engine.scene.data.MWeatherAreaData");var b=c.prototype;b.ReadData=function(a){this._sizew=a.readShort();this._sizeh=a.readShort();this._numw=a.readShort();this._numh=a.readShort();this._hollowflag=Array(this._numw*this._numh);for(var d=0;d<this._numh;++d)for(var b=0;b<this._numw;++b)this._hollowflag[d*this._numw+b]=0==(a.readByte()&2)};e(0,b,"numh",function(){return this._numh});e(0,b,"sizew",function(){return this._sizew});e(0,b,"numw",function(){return this._numw});e(0,b,"sizeh",function(){return this._sizeh});e(0,b,"hollowflag",function(){return this._hollowflag});return c}(),N=function(){function c(){}g(c,"engine.classbase.ObjectRecord");c.rcd=function(b){};c.getCustomDicList=function(){return c._customDic};c.getStateCopyStr=function(b,a,d,c){if(null==b||""==b){a=engine.classbase.ObjectRecord.getCustomDicList();for(var k in a){b=a[k];d=0;for(var e in b)d++}}else if(0>a&&(a=0),100>d&&(d=100),a>=d&&(a=0,d=100),b=engine.classbase.ObjectRecord.getCustomDicList()[b],null!=b){k=0;for(var f in b){if(k>=a&&k<=d){try{f.hasOwnProperty("name")}catch(R){}try{f.hasOwnProperty("id")}catch(R){}if(null!=c&&0<c.length)for(b=0;b<c.length;++b)try{f.hasOwnProperty(c[b])}catch(R){}}else if(k>d)break;k++}}};c.IS_OPEN=!1;c.gidgetter=1;y(c,["_customDic",function(){return this._customDic=new H}]);return c}();(function(){function c(){}g(c,"engine.ui.utils.LayoutUtil");c.GetLayoutPos=function(b,a,d,c){var k=f.stage,e=k.width,g=k.height+k._canvasTransform.ty,n=b.width;b=b.height;9==a?(d+=.5*(e-n),c+=.5*(g-b)):1==a?(d+=.5*(e-n),c+=k.height-g):2==a?(d+=e-n,c+=k.height-g):3==a?(d+=e-n,c+=.5*(g-b)):4==a?(d+=e-n,c+=g-b):5==a?(d+=.5*(e-n),c+=g-b):6==a?(d+=0,c+=g-b):7==a?(d+=0,c+=.5*(g-b)):8==a&&(d+=0,c+=k.height-g);return new l(d,c)};c.LayoutTipPanel=function(b,a){if(null!=b){var d=f.stage.width,c=f.stage.height,e,h;if(null!=a){var g=b.width,n=b.height;e=a.width;h=a.height;a=a.localToGlobal(l.TEMP.setTo(0,0));0==b.tiplayout?(e=a.x+e,h=a.y,e>d-g&&(e=d-g-20),0>e&&(e=0),h>c-n&&(h=c-n-20),0>h&&(h=0)):2==b.tiplayout?(e=a.x+e+g+20<=d?a.x+e:0<=a.x-g-20?a.x-g:(d-g)/2,h=a.y+h+20<=c?a.y:0<=a.y-h-20?a.y-h:(c-n)/2):(e=(d-b.width)/2,h=(c-b.height)/2)}else e=(d-b.width)/2,h=(c-b.height)/2;b.pos(e,h)}};c.LAYOUT_NON=0;c.LAYOUT_U=1;c.LAYOUT_RU=2;c.LAYOUT_R=3;c.LAYOUT_RB=4;c.LAYOUT_B=5;c.LAYOUT_LB=6;c.LAYOUT_L=7;c.LAYOUT_LU=8;c.LAYOUT_C=9;return c})();var U=function(){function c(){}g(c,"engine.animation.define.EnumActionType");c.ALL=-2;c.NONE=-1;c.STAND=0;c.RUN=1;c.DEAD=4;c.HURT=5;c.ATTACK1=10;c.RIDESTAND=20;c.RIDERUN=21;c.RIDEATTACK=22;c.RIDEHURT=23;c.UI_STAND=100;c.UI_XIUXIAN=101;return c}(),ua=function(c){function b(a){void 0===a&&(a=0);b.__super.call(this,a)}g(b,"engine.base.data.long",c);c=b.prototype;c.Clone=function(){var a=new b;a._lValue=this._lValue;a._hValue=this._hValue;a._hexValue=this._hexValue;return a};c.setValue=function(a,d){this._hValue=d>>>0;this._lValue=a>>>0};c.rightShiftFill0=function(a){if(64<a)throw Error("what the fuck:"+a);if(64==a)return this.setValue(0,0),this;if(31<a){this.setValue(this._hValue,0);if(32==a)return this;this._lValue>>>=a-32;return this}if(0==a)return this;var d=this._hValue<<32-a;this._hValue>>>=a;this._lValue>>>=a;this._lValue|=d;return this};c.leftShift=function(a){if(64<a)throw Error("what the fuck:"+a);if(64==a)this.setValue(0,0);else if(31<a)this.setValue(0,this._lValue),32!=a&&(this._hValue=this._hValue<<a-32&4294967295);else if(0!=a){var d=this._lValue>>>32-a;this._hValue=this._hValue<<a&4294967295;this._lValue=this._lValue<<a&4294967295;this._hValue|=d}};c.andInt=function(a){return this._lValue&a};c.and=function(a){this._hValue&=a._hValue;this._lValue&=a._lValue;this._hValue>>>=0;this._lValue>>>=0;return this};c.or=function(a){this._hValue|=a._hValue;this._lValue|=a._lValue;this._hValue>>>=0;this._lValue>>>=0};c.makeHex=function(){this._hexValue=("0000000000000000"+this._hValue.toString(16)).substr(-8,8)+("0000000000000000"+this._lValue.toString(16)).substr(-8,8)};b.create=function(a){return b.create0(0,a)};b.create0=function(a,d){var c=new b;c._hValue=a>>>0;c._lValue=d>>>0;c._hexValue=("0000000000000000"+a.toString(16)).substr(-8,8)+("0000000000000000"+d.toString(16)).substr(-8,8);return c};b.create1=function(a){return b.create0(a.hValue,a.lValue)};b.valueOf=function(a){return b.create0(Math.floor(a/4294967296),Math.floor(a%4294967296))};return b}(wb),xb=function(c){function b(){b.__super.call(this);console.log("NotchAndriodFix\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3dcreate")}g(b,"engine.notch.NotchAndriodFix",c);b.prototype.Init=function(a){c.prototype.Init.call(this,a);(this._isNotch=a.notch)&&a.notchh&&0<parseInt(a.notchh)&&(this._notchHeight=parseInt(a.notchh));if(this._isNotch&&0<this._notchHeight&&(a=a.screensize)){var d=a.split("-"),d=parseInt(d[1]);v.clientHeight+this._notchHeight<=d?this._notchHeight=0:(console.log("NotchAndriodFix oldh:"+this._notchHeight),this._notchHeight=this._notchHeight/d*f.stage.height|0);console.log("NotchAndriodFix screensize:"+a+" clientsize:"+v.clientWidth+"-"+v.clientHeight)}console.log("NotchAndriodFix notch: "+this._isNotch+" w:"+this._notchWidth+" h:"+this._notchHeight)};return b}(ta),V=function(c){function b(){this._loading={};this._loaded={};b.__super.call(this)}g(b,"engine.pui.PUIBitmapFont",c);c=b.prototype;c.isBitmapFont=function(a){return null!=b.BITMAP_FONT[a]};c.getFont=function(a){if(this.isBitmapFont(a)){var d=b.BITMAP_FONT[a];if(null==this._loading[d])if(null!=this._loaded[d])this.event("complete",a);else{this._loading[d]=a;var c=new Ya;c.loadFont(d,x.create(this,this.loadcomplete,[c,d,a]))}}};c.loadcomplete=function(a,d,b){delete this._loading[d];null!=a._texture&&(this._loaded[d]=b,G.registerBitmapFont(b,a),this.event("complete",b))};b.Register=function(a,d){b.BITMAP_FONT[d]=a};b.BITMAP_FONT={};y(b,["Ins",function(){return this.Ins=new b}]);return b}(bb),A=function(c){function b(a){b.__super.call(this,a);this.endian="bigEndian"}g(b,"engine.base.data.ByteArray",c);var a=b.prototype;a.uncompress=function(a){this._u8d_=(new Zlib.Inflate(this._u8d_)).decompress();this._d_=new DataView(this._u8d_.buffer);this._length=this._u8d_.byteLength};a.compress=function(a){this._byteView_=(new Zlib.Deflate(this._byteView_)).compress();this._data_=new DataView(this._byteView_.buffer)};a.GetByteArray=function(a,c){var d=new b(c);d.writeArrayBuffer(this.getUint8Array(this.pos+a,c));d.pos=0;return d};a.readUTF=function(a){a=this._pos_+a;for(var d,b,c,e=this._u8d_,f=0,g=[],l=0;this._pos_<a;)d=e[this._pos_++],128>d?0!=d&&(g[l++]=d):224>d?g[l++]=(d&63)<<6|e[this._pos_++]&127:240>d?(b=e[this._pos_++],g[l++]=(d&31)<<12|(b&127)<<6|e[this._pos_++]&127):(b=e[this._pos_++],c=e[this._pos_++],g[l++]=(d&15)<<18|(b&127)<<12|c<<6&127|e[this._pos_++]&127),f++;return String.fromCharCode.apply(String,g)};a.readUTFBytes=function(a){void 0===a&&(a=-1);if(0==a)return"";var d=this.bytesAvailable;if(a>d)throw"readUTFBytes error - Out of bounds";return this.readUTF(0<a?a:d)};a.readUTFBytesOld=function(a){void 0===a&&(a=-1);return c.prototype.readUTFBytes.call(this,a)};a.readDouble=function(){return this.getFloat64()};a.readFloat=function(){return this.getFloat32()};a.readBytes=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);if(0>b||0>c)throw"Read error - Out of bounds";0==c&&(c=this.length-this.pos);a.writeArrayBuffer(this.getUint8Array(this.pos+b,c))};a.readInt=function(){return this.getInt32()};a.readShort=function(){return this.getInt16()};a.readUnsignedByte=function(){return this.getUint8()};a.readUnsignedInt=function(){return this.getUint32()};a.readUnsignedShort=function(){return this.getUint16()};a.writeFloat=function(a){this.writeFloat32(a)};a.writeInt=function(a){this.writeInt32(a)};a.writeShort=function(a){this.writeInt16(a)};a.writeBytes=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);a.pos=0;this.writeArrayBuffer(a.getUint8Array(a.pos,a.length),b,c)};a.writeMultiByte=function(a,b){if("UNICODE"==b||"unicode"==b)throw"not support unicode";this.writeUTFBytes(a+"")};e(0,a,"buffer",function(){return this._d_.buffer});return b}(ga),yb=function(c){function b(){b.__super.call(this)}g(b,"engine.notch.NotchIPhoneFix",c);b.prototype.Init=function(a){c.prototype.Init.call(this,a);null!=v.window.conch&&(a=JSON.parse(v.window.conch.config.getDeviceInfo()),null!=a&&-1!="iPhone10,3 iPhone10,6 iPhone11,2 iPhone11,4 iPhone11,6 iPhone11,8 iPhone12,1 iPhone12,3 iPhone12,5".split(" ").indexOf(a.devicename)&&(this._isNotch=!0,this._notchWidth=50,this._notchHeight=60))};return b}(ta),bc=function(c){function b(){this.loop=!1;this._count=this._index=this.wrapMode=0;this._isPlaying=!1;this._labels=null;this._frameRateChanged=this._isReverse=!1;this._actionName=this._controlNode=null;b.__super.call(this);this._interval=ab.animationInterval}g(b,"engine.animation.MAnimationControlBase",c);var a=b.prototype;a.play=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=!0);void 0===c&&(c="");this._isPlaying=!0;this.index="string"==typeof a?this._getFrameByLabel(a):a;this.loop=b;this._actionName=c;this._isReverse=1==this.wrapMode;0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)};a._getFrameByLabel=function(a){var d;for(d=0;d<this._count;d++)if(this._labels[d]&&0<=this._labels[d].indexOf(a))return d;return 0};a._frameLoop=function(){if(this._isReverse){if(this._index--,0>this._index)if(this.loop)2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete");else{this._index=0;this.stop();this.event("complete");return}}else if(this._index++,this._index>=this._count)if(this.loop)2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete");else{this._index--;this.stop();this.event("complete");return}this.index=this._index};a._setControlNode=function(a){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying));(this._controlNode=a)&&a!=this&&(a.on("display",this,this._checkResumePlaying),a.on("undisplay",this,this._checkResumePlaying))};a._setDisplay=function(a){c.prototype._setDisplay.call(this,a);this._checkResumePlaying()};a._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))};a.stop=function(){this._isPlaying=!1;this.clearTimer(this,this._frameLoop)};a.addLabel=function(a,b){this._labels||(this._labels={});this._labels[b]||(this._labels[b]=[]);this._labels[b].push(a)};a.removeLabel=function(a){if(!a)this._labels=null;else if(this._labels)for(var d in this._labels)this._removeLabelFromLabelList(this._labels[d],a)};a._removeLabelFromLabelList=function(a,b){if(a)for(var d=a.length-1;0<=d;d--)a[d]==b&&a.splice(d,1)};a.gotoAndStop=function(a){this.index="string"==typeof a?this._getFrameByLabel(a):a;this.stop()};a._displayToIndex=function(a){};a.clear=function(){this.stop();this._labels=null};e(0,a,"interval",function(){return this._interval},function(a){this._interval!=a&&(this._frameRateChanged=!0,this._interval=a,this._isPlaying&&0<a&&this.timerLoop(a,this,this._frameLoop,null,!0,!0))});e(0,a,"isPlaying",function(){return this._isPlaying});e(0,a,"index",function(){return this._index},function(a){this._index=a;this._displayToIndex(a);if(this._labels&&this._labels[a]){a=this._labels[a];for(var d=0,b=a.length;d<b;d++)this.event("label",a[d])}});e(0,a,"count",function(){return this._count});b.WRAP_POSITIVE=0;b.WRAP_REVERSE=1;b.WRAP_PINGPONG=2;return b}(fb),Va=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PAutoBitmap",c);return b}(Xa),C=function(c){function b(){this._decimalPixY=this._decimalPixX=0;b.__super.call(this)}g(b,"engine.layaex.container.MSprite",c);var a=b.prototype;f.imps(a,{"engine.base.interfaceclass.IDestroyObject":!0});a.Dispose=function(){this.graphics.clear();this.destroy()};a.SetPixPt=function(a,b){this.pixX=a;this.pixY=b};a.GetPixPt=function(){return new l(this.pixX,this.pixY)};e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(B,this,"y",Math.round(a))});e(0,a,"isDestroyed",function(){return this.destroyed});e(0,a,"decimalPixY",function(){return this._decimalPixY});e(0,a,"pixX",function(){return this.x},function(a){this._decimalPixX=a;this.x=Math.floor(a)});e(0,a,"pixY",function(){return this.y},function(a){this._decimalPixY=a;this.y=Math.floor(a)});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(B,this,"x",Math.round(a))});e(0,a,"decimalPixX",function(){return this._decimalPixX});e(0,a,"gridX",function(){return this.x/w.GRID_WIDTH|0});e(0,a,"gridY",function(){return this.y/w.GRID_HEIGHT|0});return b}(B);(function(c){function b(a,d,c,e,f){this._text=this.bindTarget=null;this._uiH=this._uiW=0;this._clickFunc=this._caller=null;b.__super.call(this);this._caller=e;this._clickFunc=f;this._text=new G;this._text.width=a;this._text.height=18;this._text.bold=!0;this._text.align="center";this._text.color="#000000";this.addChild(this._text);this.UpdateShow(a,d,"#BEBEBE");this.on("mouseover",this,this.MouseOverHandler);this.on("mouseout",this,this.MouseOutHandler);this.on("mousedown",this,this.MouseDownHandler);this.on("mouseup",this,this.MouseUpHandler);this.on("click",this,this.ClickHandle);null!=c&&(this.text=c)}g(b,"engine.ui.debug.tinyui.TinyButton",c);c=b.prototype;c.ClickHandle=function(a){null!=this._clickFunc&&this._clickFunc.call(this._caller,this)};c.UpdateShow=function(a,d,b){this._uiW=a;this._uiH=d;this.width=a;this.height=d;this.graphics.clear();this.graphics.drawRect(0,0,a,d,b);this._text.x=.5*(a-this._text.width);this._text.y=.5*(d-this._text.height)};c.MouseOverHandler=function(a){this.UpdateShow(this._uiW,this._uiH,"#D3D3D3")};c.MouseOutHandler=function(a){this.UpdateShow(this._uiW,this._uiH,"#BEBEBE")};c.MouseDownHandler=function(a){this.UpdateShow(this._uiW,this._uiH,"#708090");a.stopPropagation()};c.MouseUpHandler=function(a){this.UpdateShow(this._uiW,this._uiH,"#D3D3D3")};e(0,c,"text",null,function(a){this._text.text=a});e(0,c,"caller",function(){return this._caller},function(a){this.caller=a});e(0,c,"clickFunc",function(){return this._clickFunc},function(a){this._clickFunc=a});return b})(B);var wa=function(c){function b(a,d){this._bakcH=this._bakcW=0;this.needShowMainPanelOnHide=!1;b.__super.call(this);this.UpdateBack(a,d)}g(b,"engine.ui.debug.tinyui.TinyPanel",c);c=b.prototype;c.UpdateBack=function(a,d){this._bakcW=a;this._bakcH=d;this.width=a;this.height=d;this.graphics.clear();this.graphics.drawRect(0,0,a,d,"#696969")};c.Show=function(){null==this.parent&&f.stage.addChild(this);this.x=.5*(this.stage.width-this.width);this.y=.5*(this.stage.height-this.height);this.on("mousedown",this,this.MouseDownHandler);this.on("mouseup",this,this.MouseUpHandler)};c.Hide=function(){this.parent&&this.parent.removeChild(this);this.stopDrag();this.off("mousedown",this,this.MouseDownHandler);this.off("mouseup",this,this.MouseUpHandler)};c.MouseDownHandler=function(a){this.startDrag();this.parent&&this.parent.addChild(this);a.stopPropagation()};c.MouseUpHandler=function(a){this.stopDrag()};e(0,c,"bakcW",function(){return this._bakcW});e(0,c,"bakcH",function(){return this._bakcH});b.ShowHideType=function(a,d){void 0===d&&(d=0);var c=b._panels[a];if(null==c){c=new a;if(null==c)return null;b._panels[a]=c}0==d&&null==c.parent||1==d?null==c.parent&&c.Show():(0==d&&null!=c.parent||2==d)&&null!=c.parent&&c.Hide();return c};y(b,["_panels",function(){return this._panels={}}]);return b}(B);(function(c){function b(){this._templet=null;this._restype=0;this._skeleton=this._loadingkey=this._filename=null;b.__super.call(this);T.Ins.RefAni(this)}g(b,"engine.templet.MSkeletonAnimation",c);var a=b.prototype;a.destroy=function(a){T.Ins.FreeAni(this);this.clear();c.prototype.destroy.call(this)};a.clear=function(){this._templet&&(this._templet.off("complete",this,this.OnComplete),this._templet.off("error",this,this.OnError),this._templet=null);null!=this._skeleton&&(this._skeleton.destroy(),this._skeleton=null);this._loadingkey=null};a.SetData=function(a,b){if(this._restype!=a||this._filename!=b)this.clear(),this._loadingkey=T.Ins.ToKeyName(a,b),this._restype=a,this._filename=b,this._templet=T.Ins.GetTemplet(a,b),this._templet.isParserComplete?this.OnComplete():(this._templet.on("complete",this,this.OnComplete),this._templet.on("error",this,this.OnError))};a.OnError=function(){this.destroyed||this.event("error")};a.OnComplete=function(){this.destroyed||(null!=this._skeleton&&(this._skeleton.destroy(),this._skeleton=null),this._skeleton=this._templet.buildArmature(),this._skeleton.on("label",this,this.OnLabelEvent),this._skeleton.on("stopped",this,this.OnStopped),this.addChild(this._skeleton),this.event("complete"))};a.OnStopped=function(){this.destroyed||this.event("stopped")};a.OnLabelEvent=function(a){this.destroyed||this.event("label",a)};e(0,a,"loadingkey",function(){return this._loadingkey});e(0,a,"skeleton",function(){return this._skeleton});e(0,a,"currAniIndex",function(){return null!=this._skeleton?this._skeleton._currAniIndex:-1});e(0,a,"isParseComplete",function(){return null!=this._templet&&this._templet.isParserComplete});return b})(B);(function(c){function b(){this._editText=this._desText=null;b.__super.call(this);this._desText=new G;this._desText.x=-150;this._desText.y=2;this._desText.width=150;this._desText.height=18;this._desText.color="#f8f8ff";this._desText.bold=!0;this._desText.align="right";this._desText.mouseEnabled=!1;this._desText.stroke=1;this.addChild(this._desText);this._editText=new db;this._editText.x=0;this._editText.y=0;this._editText.width=100;this._editText.height=18;this._editText.bold=!0;this._editText.align="center";this._editText.borderColor="#708090";this._editText.bgColor="#f8f8ff";this._editText.restrict="0-9";this._editText.stroke=1;this._editText.on("mousedown",this,this.mouseDownHandler);this.addChild(this._editText)}g(b,"engine.ui.debug.tinyui.TinyLabel",c);c=b.prototype;c.mouseDownHandler=function(a){a.stopPropagation()};e(0,c,"des",null,function(a){this._desText.text=a});e(0,c,"text",function(){return this._editText.text},function(a){this._editText.text=a});e(0,c,"editText",function(){return this._editText});return b})(B);var cc=function(c){function b(a,c,e,f,g){this._owner=null;this._direction=this._rnDdir=0;this._resType=-1;this._resExtra=null;this._resId=-1;this._resChanged=!1;this._sheet=this._resPack=this._defaultSheet=this._defaultResPack=null;this._playSpeed=1;this._isActiveMode=this._isActiveAction=this._isPart=this._isReverseAutoOver=!1;this._virdir=this._actionChangeMap=this._actionChangeHandler=this._frame_medthod=this._frame_caller=this._end_method=this._end_caller=this._partSortList=null;b.__super.call(this);this._actType=U.NONE;this._owner=a;this._direction=0;this._end_caller=c;this._end_method=e;this._frame_caller=f;this._frame_medthod=g;this._virdir=u.VIRDIR_5}g(b,"engine.animation.MAnimationControl",c);var a=b.prototype;f.imps(a,{"engine.base.interfaceclass.IDestroyObject":!0});a.destroy=function(a){void 0===a&&(a=!0);this.destroyed||(this.clear(),this._virdir=null,this._resType=this._resId=-1,this._frame_caller=this._frame_medthod=this._end_caller=this._end_method=this._partSortList=null,this._actionChangeHandler&&this._actionChangeHandler.recover(),this._actionChangeMap=this._actionChangeHandler=null,laya.display.Node.prototype.destroy.call(this,a))};a.SetData=function(a,b,c,e,f,g){this._resType=a;this._resId=b;this._resExtra=c;this._actionChangeMap=f;this._actionChangeHandler&&this._actionChangeHandler.recover();this._actionChangeHandler=g;this._partSortList=e;this._resChanged=!0;this.on("complete",this,this.OnPlayEnd)};a.DoAction=function(a,b){-1!=this._resId&&(null!=this._actionChangeMap?null!=this._actionChangeMap[a]?a=this._actionChangeMap[a]:null!=this._actionChangeMap[U.ALL]&&(a=this._actionChangeMap[U.ALL]):null!=this._actionChangeHandler&&(a=this._actionChangeHandler.run(),this._actionChangeHandler.once&&(this._actionChangeHandler=null,n.LogThrow("ActionChangeHandler\u9519\u8bef\uff1a\u56de\u8c03handler\u662fonce  restype:"+this._resType+" resid:"+this._resId))),a==U.NONE?(this._actType=a,this._owner.ClearAnimationPlay(),n.LogError("MAnimation2D actionType \x3d\x3d null restype:"+this._resType+" resid:"+this._resId)):(this._owner.SetDirection(b),this._actType!=a||this._resChanged?(this._resChanged=!1,this._actType=a,this._owner.LoadBin()):this._actType==a&&this.OnResLoadToPlay()))};a.SetDefaultResPack=function(a){!this.destroyed&&(this._defaultResPack=a)&&(this.UpdateVirDir(a),this._count=(this._defaultSheet=a.dirs[this._rnDdir])?this._defaultSheet.framenum:0)};a.SetResPack=function(a){!this.destroyed&&(this._resPack=a)&&(this.UpdateVirDir(a),this._sheet=a.dirs[this._rnDdir])&&(this._count=this._sheet.framenum)};a.UpdateVirDir=function(a){a&&(this._virdir=1==a.maxdir?u.VIRDIR_1:u.VIRDIR_5,this._rnDdir=this._virdir[this._direction],this._rnDdir>a.maxdir-1&&(this._rnDdir=0))};a.OnSheetReady=function(){this.UpdateInterval(0);this.OnResLoadToPlay()};a.GetRenderFrames=function(){var a=this._sheet,b=this._defaultSheet,c;a&&(c=a.GetFrames(this._owner));!c&&b&&(c=b.GetFrames(this._owner));return c};a.OnResLoadToPlay=function(){this.rendersheet&&(!this._isPart||this._isActiveMode?1==this.wrapMode?this.play(this._count-1,this._owner.isloop):this.play(0,this._owner.isloop):this.index=this._index)};a.SetDirection=function(a){u.IsValid(a)||(a=0);this._direction=a;var d=this._resPack,b=this._defaultResPack,c=d||b;c&&(this._rnDdir=this._virdir[a],this._rnDdir>c.maxdir-1&&(this._rnDdir=0),d?this._sheet=c.dirs[this._rnDdir]:b&&(this._defaultSheet=b.dirs[this._rnDdir]))};a.SetPlaySpeed=function(a){if(.01>a||isNaN(a))a=.01;this._playSpeed=a;this.UpdateInterval(0)};a.play=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=!0);void 0===c&&(c="");if(!this._isPart||this._isActiveMode)this._isPlaying=!0,this.index="string"==typeof a?this._getFrameByLabel(a):a,this.loop=b,this._actionName=c,this._isReverse=1==this.wrapMode,this.rendersheet&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0)};a.OnPlayEnd=function(){this._isReverseAutoOver&&(1==this.wrapMode&&(this.wrapMode=0),this._isReverseAutoOver=!1);null==this._end_method||this.loop||this._end_method.call(this._end_caller)};a.OnFrameChange=function(a){null!=this._frame_medthod&&this._frame_medthod.call(this._frame_caller,a)};a._frameLoop=function(){this._owner.isNeedDraw&&c.prototype._frameLoop.call(this)};a._displayToIndex=function(a){this.rendersheet&&(this._owner.RenderFrame(a),this.UpdateInterval(a),this.OnFrameChange(a))};a.UpdateInterval=function(a){var d=this.rendersheet;d&&(d=d.intervals,null!=d&&0<d.length&&(this.interval=1==this._playSpeed?d[a]:d[a]/this._playSpeed))};a.clear=function(){this._defaultSheet=this._sheet=this._defaultResPack=this._resPack=null;this._resChanged=!1;this._playSpeed=1;this._isActiveMode=this._isActiveAction=this._isPart=this._isReverseAutoOver=!1;this._partSortList=null;this._resId=this._resType=-1;this._actType=U.NONE;c.prototype.clear.call(this)};a.GetActType=function(){return this._actType};a.GetId=function(){return this._resId};a.GetType=function(){return this._resType};a.GetExtra=function(){return this._resExtra};a.SetFrameCaller=function(a,b){this._frame_caller=a;this._frame_medthod=b};a.SetEndCaller=function(a,b){this._end_caller=a;this._end_method=b};e(0,a,"direction",function(){return this._direction});e(0,a,"isPart",function(){return this._isPart},function(a){this._isPart=a});e(0,a,"resPack",function(){return this._resPack});e(0,a,"isDestroyed",function(){return this.destroyed});e(0,a,"isActiveAction",function(){return this._isActiveAction},function(a){this._isActiveAction=a});e(0,a,"curSortValue",function(){return null==this._partSortList||this._direction==u.NONE?0:this._partSortList[this._direction]});e(0,a,"defaultResPack",function(){return this._defaultResPack});e(0,a,"sheet",function(){return this._sheet});e(0,a,"rendersheet",function(){var a=this._sheet,b=this._defaultSheet;return a&&a.isReady?a:b&&b.isReady?b:null});e(0,a,"resscale",function(){var a=this.rendersheet;return a?a.scale:1});e(0,a,"rnDdir",function(){return this._rnDdir});e(0,a,"allTime",function(){return this._resPack?this._resPack.alltime:0});e(0,a,"isReverseAutoOver",function(){return this._isReverseAutoOver},function(a){this._isReverseAutoOver=a});e(0,a,"partSortList",function(){return this._partSortList});e(0,a,"isActiveMode",function(){return this._isActiveMode},function(a){this._isActiveMode=a});return b}(bc);(function(c){function b(){this._isViewCreated=!1;this._callOpenParam=null;this._callOpen=!1;this._funsDic=null;b.__super.call(this);this.autoDestroyAtClosed=!0}g(b,"engine.pui.components.PScene",c);var a=b.prototype;a.createChildren=function(){this.on("onViewCreated",this,this.onViewCreated);c.prototype.createChildren.call(this)};a.destroy=function(a){void 0===a&&(a=!0);this._callOpenParam=!1;this.onClose();c.prototype.destroy.call(this,a)};a.onViewCreated=function(){this._isViewCreated=!0;this.displayedInStage&&this._callOpen&&(this.onOpened(this._callOpenParam),this._callOpenParam=null,this._callOpen=!1)};a.onOpened=function(a){this._isViewCreated?(this.zOrder=this.layer,this.onOpen(a),c.prototype.onOpened.call(this,a)):(this._callOpenParam=a,this._callOpen=!0)};a.onClosed=function(a){this.onClose();c.prototype.onClosed.call(this,a)};a.onOpen=function(a){this.AddEvent()};a.AddEvent=function(){};a.onClose=function(){this.RemoveEvent()};a.RemoveEvent=function(){};e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(z,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(z,this,"y",Math.round(a))});e(0,a,"layer",function(){return 17});return b})(z);var I=function(c){function b(){this._initText=null;b.__super.call(this)}g(b,"engine.pui.components.PText",c);var a=b.prototype;a.destroy=function(a){void 0===a&&(a=!0);V.Ins.off("complete",this,this.OnBitmapLoaded);c.prototype.destroy.call(this,a)};a.OnBitmapLoaded=function(a){this.destroyed||this._font!=a||(V.Ins.off("complete",this,this.OnBitmapLoaded),f.superSet(G,this,"font",a))};e(0,a,"text",c.prototype._$get_text,function(a){null==this._initText&&(this._initText=a);f.superSet(G,this,"text",a)});e(0,a,"font",c.prototype._$get_font,function(a){V.Ins.isBitmapFont(a)&&(V.Ins.on("complete",this,this.OnBitmapLoaded),V.Ins.getFont(a));f.superSet(G,this,"font",a)});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(G,this,"x",Math.round(a))});e(0,a,"initText",function(){return this._initText},function(a){this._initText=a});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(G,this,"y",Math.round(a))});return b}(G),Ib=function(c){function b(){this._txt=this._btnClose=null;b.__super.call(this,500,200);this._txt=new Y;this._txt.fontSize=16;this._txt.color="#ffffff";this._txt.width=this.width-20;this._txt.x=10;this._txt.mouseEnabled=!1;this._txt.wordWrap=!0;this.addChild(this._txt);this._btnClose=new K;this._btnClose.label="\u5173\u95ed";this._btnClose.width=this._btnClose.height=40;this._btnClose.graphics.save();this._btnClose.graphics.alpha(.5);this._btnClose.graphics.drawRect(0,0,40,40,"#000000","#ffffff");this._btnClose.graphics.restore();this._btnClose.x=this.width-this._btnClose.width;this._btnClose.y=0;this._btnClose.on("click",this,this.CloseHandler);this.addChild(this._btnClose)}g(b,"engine.ui.debug.TinyMessageBox",c);c=b.prototype;c.SetData=function(a){this._txt.text+=a;this._txt.text+="\n"};c.CloseHandler=function(a){this._txt.text="";wa.ShowHideType(b,2)};b.Show=function(a){wa.ShowHideType(b,1).SetData(a)};return b}(wa);(function(c){function b(a,c,e,f,g){this._frame_medthod=this._frame_caller=this._end_method=this._end_caller=this._owner=this._partAnimList=this._ani=null;b.__super.call(this);this._end_caller=c;this._end_method=e;this._frame_caller=f;this._frame_medthod=g;this._owner=a;this._ani=new Wa(a,this,this.OnPlayEnd,this,this.OnFrameChange);this.addChild(this._ani)}g(b,"engine.animation.MAnimation2DGroup",c);var a=b.prototype;f.imps(a,{"engine.animation.interfaces.IAnimationGroup":!0});a.SetData=function(a,b,c,e,f){this._ani.SetData(a,b,c,e,f,null)};a.DoAction=function(a,b,c){void 0===c&&(c=!1);this._ani.DoAction(a,b,c);if(null!=this._partAnimList){var d,e;for(e in this._partAnimList)d=this._partAnimList[e],d.isActiveAction?d.SetDirection(b):d.DoAction(a,b,c);this.CheckPartSort()}};a.BindPart=function(a,b,c,e,f,g){null==this._partAnimList&&(this._partAnimList=[]);var d=new Wa(this._owner);d.SetData(a,b,c,e,f,g);d.isPart=!0;d.Stop();this._partAnimList.push(d);this.addChild(d);d.DoAction(this._ani.GetActType(),this.direction,this._ani.isloop);d.GotoFrameIdx(this._ani.curDirFrameIdx);this.CheckPartSort();return d};a.RemovePart=function(a,b,c){if(null!=this._partAnimList)for(var d=this._partAnimList.length-1;0<=d;--d){var e=this._partAnimList[d];if(e.GetType()==a&&e.GetId()==b&&e.GetExtra()==c){this._partAnimList.splice(d,1);this.removeChild(e);e.destroy();break}}};a.RemoveAllPart=function(){if(null!=this._partAnimList){for(var a=0;a<this._partAnimList.length;++a)this._partAnimList[a].destroy();this._partAnimList=null}};a.CheckPartSort=function(){var a=this._partAnimList;if(null!=a){a.sort(this.SortPartFunc);for(var b=0,c=!1,e=a.length,f=0;f<e;++f)a[f].parent==this&&(0<=a[f].curSortValue&&!c&&(this.setChildIndex(this._ani,b++),c=!0),this.setChildIndex(a[f],b++))}};a.SortPartFunc=function(a,b){a=a.curSortValue;b=b.curSortValue;return a<b?-1:a>b?1:0};a.SetPlaySpeed=function(a){this._ani.SetPlaySpeed(a)};a.SetDirection=function(a){this._ani.SetDirection(a);var b=this._partAnimList;if(null!=b){for(var d=0;d<b.length;++d)b[d].SetDirection(a);this.CheckPartSort()}};a.SetAlpha=function(a){f.superSet(C,this,"alpha",a)};a.Play=function(a,b){void 0===a&&(a=0);void 0===b&&(b=!0);this._ani.Play(a,b)};a.Stop=function(){this._ani.Stop()};a.Pause=function(a){a?this._ani.isPlaying&&this._ani.Stop():this._ani.isPlaying||this._ani.Play(this._ani.stopAtIdx,this._ani.isloop)};a.GotoAndStop=function(a){this._ani.GotoAndStop(a)};a.GotoFrameIdx=function(a){this._ani.GotoFrameIdx(a)};a.GetFrameIdx=function(){return this._ani.GetFrameIdx()};a.OnPlayEnd=function(){null==this._end_method||this._ani.loop||this._end_method.call(this._end_caller)};a.OnFrameChange=function(a){var b=this._partAnimList;if(null!=b){var d,c;for(c in b)d=b[c],d.isActiveAction||d.GotoFrameIdx(a)}null!=this._frame_medthod&&this._frame_medthod.call(this._frame_caller,a)};a.clear=function(){this._ani&&this._ani.clear();var a=this._partAnimList;if(null!=a){var b,c;for(c in a)b=a[c],b.clear()}};a.destroy=function(a){void 0===a&&(a=!0);null!=this._ani&&(this._ani.destroy(a),this._ani=null);this._frame_caller=this._frame_medthod=this._end_caller=this._end_method=null;var b=this._partAnimList;if(null!=b){var d,c;for(c in b)d=b[c],d.clear();this._partAnimList=null}this._owner=null;laya.display.Sprite.prototype.destroy.call(this,a)};e(0,a,"direction",function(){return this._ani.direction});e(0,a,"alpha",c.prototype._$get_alpha,function(a){this.SetAlpha(a)});e(0,a,"partAnimList",function(){return this._partAnimList});e(0,a,"ani",function(){return this._ani});e(0,a,"isPlaying",function(){return this._ani.isPlaying});e(0,a,"curAction",function(){return this._ani.GetActType()});return b})(C);(function(c){function b(){this.map=null;this._lastTime=this._diffTime=this._pooltype=this._gid=0;b.__super.call(this)}g(b,"engine.scene.obj.SceneObjectBase",c);c=b.prototype;f.imps(c,{"engine.scene.obj.ISceneObjectBase":!0});c.SetRawData=function(a){};c.destroy=function(a){void 0===a&&(a=!0);laya.display.Sprite.prototype.destroy.call(this,a);this._gid=0};c.CheckLocalBounding=function(a,b){return!1};c.CalcZOrder=function(){this.SetLocalZOrder(this.map.CalcSceneZOrder(this.pixX,this.pixY))};c.SetLocalZOrder=function(a){this.zOrder=a};c.OnFrame=function(a){0==this._lastTime&&(this._lastTime=a);this._diffTime=a-this._lastTime;this._lastTime=a};c.GetGridPt=function(){return w.PixPt2GridPt(this.pixX,this.pixY)};c.SetGridPt=function(a,b){a=w.GridPt2PixPt(a,b,!0);this.SetPixPt(a.x,a.y);this.CalcZOrder()};e(0,c,"isNonMouseHit",function(){return!0});e(0,c,"pooltype",function(){return this._pooltype},function(a){this._pooltype=a});e(0,c,"gid",function(){return this._gid});e(0,c,"objectType",function(){return 0});return b})(C);var ub=function(c){function b(){this._meta=this._map=null;this._resId=this._sceneHeight=this._sceneWidth=0;this._loadChunkLock=!0;this._thumbnail=this._chunkControl=null;b.__super.call(this);this._chunkControl=new Kb;this.cacheAs="normal"}g(b,"engine.scene.chunk.MapChunkShow",c);c=b.prototype;f.imps(c,{"engine.base.tile.IMTitleContainer":!0});c.Init=function(a){this._map=a;this._chunkControl.Init(this)};c.Clear=function(){this._resId=0;this.graphics.clear();null!=this._thumbnail&&(this._thumbnail=null);this._chunkControl.Clear();this._loadChunkLock=!0};c.reConnect=function(){this._chunkControl.clearFailIDXs()};c.GetChunkUrls=function(a){return this._chunkControl.GetChunkUrls(a)};c.LoadChunk=function(a,b){this._chunkControl.LoadChunk(a,b)};c.OnFrame=function(a){a=this._map.mapLayer.GetScreenSceneRect();this._loadChunkLock||this._chunkControl.UpdateChunk(a)};c.ChangeMap=function(a,b){this._meta=a;this._sceneWidth=a.sceneWidth;this._sceneHeight=a.sceneHeight;this._resId=a.mapresid;var d=".jpg";if(ba._compressedTextureEtc1||ba._compressedTexturePvrtc)v.onWeiXin||(d=v.onAndroid?".ktx":".pvr");var d="res/map/"+this._resId+"/chunks/ml_{0}_{1}"+d,c=ib.getChunkVersion("res/map/"+this._resId+"/thumbnail.jpg");c&&(d=c+"/"+d);a=a.layerDataGround;this._chunkControl.SetData(d,a.pixw,a.pixh,a.sizew,a.sizeh,a.pixw/this._sceneWidth,a.pixh/this._sceneHeight);this.width=a.pixw;this.height=a.pixh;this._thumbnail=b;null!=this._thumbnail&&this.graphics.drawTexture(this._thumbnail,0,0,this.width,this.height)};c.SetLoadChunkLock=function(a){this._loadChunkLock=a};e(0,c,"thumbnail",function(){return this._thumbnail});return b}(C),ac=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PHTMLDivElement",c);var a=b.prototype;a._afterInited=function(){this._element.width=this.width;this._element.height=this.height};e(0,a,"innerHTML",c.prototype._$get_innerHTML,function(a){null==this.initHtmlText&&(this.initHtmlText=a);f.superSet(xa,this,"innerHTML",a)});return b}(xa),$b=function(c){function b(){this._layoutModel=0;this._lineMaxNum=-1;this._marginv=this._marginh=2;this._skin=null;this._gridH=this._gridW=0;b.__super.call(this);this._grids=[]}g(b,"engine.pui.componentext.PGridGroup",c);var a=b.prototype;a.destroy=function(a){void 0===a&&(a=!0);this.Clean();c.prototype.destroy.call(this,a)};a.AddItem=function(a,b){if(null==a)return null;var d=new Ua;0!=this._gridW&&(d.width=this._gridW);0!=this._gridH&&(d.height=this._gridH);d.skin=this._skin;d.on("resize",this,this.LayoutGroup);a.SetForGrid(d,b);this.addChild(d);this._grids.push(d);this.LayoutGroup();return d};a.LayoutGroup=function(){this.callLater(this._LayoutGroup)};a._LayoutGroup=function(){if(!this.destroyed){var a,b;if(0==this._layoutModel)for(a=0;a<this._grids.length;a++)0<this._lineMaxNum?(this._grids[a].x=Math.floor(a%this._lineMaxNum)*(this._grids[a].width+this._marginh),this._grids[a].y=Math.floor(a/this._lineMaxNum)*(this._grids[a].height+this._marginv)):(this._grids[a].x=a*(this._grids[a].width+this._marginh),this._grids[a].y=0);else if(1==this._layoutModel)for(b=Math.min(this._grids.length,this._lineMaxNum),a=0;a<this._grids.length;a++)0<this._lineMaxNum?(this._grids[a].x=-(b*(this.width+this._marginh)/2)+Math.floor(a%this._lineMaxNum)*(this._grids[a].width+this._marginh)+this.width/2+this._marginh/2,this._grids[a].y=Math.floor(a/this._lineMaxNum)*(this._grids[a].height+this._marginv)):(this._grids[a].x=-(this._grids.length*(this.width+this._marginh)/2)+a*(this._grids[a].width+this._marginh)+this.width/2,this._grids[a].y=0);else if(2==this._layoutModel)for(a=0;a<this._grids.length;a++)0<this._lineMaxNum?(this._grids[a].x=-Math.floor(a%this._lineMaxNum)*(this._grids[a].width+this._marginh),this._grids[a].y=Math.floor(a/this._lineMaxNum)*(this._grids[a].height+this._marginv)):(this._grids[a].x=-a*(this._grids[a].width+this._marginh),this._grids[a].y=0);else if(3==this._layoutModel)for(a=0;a<this._grids.length;a++)0<this._lineMaxNum?(this._grids[a].x=Math.floor(a/this._lineMaxNum)*(this._grids[a].width+this._marginh),this._grids[a].y=Math.floor(a%this._lineMaxNum)*(this._grids[a].height+this._marginv)):(this._grids[a].y=a*(this._grids[a].height+this._marginv),this._grids[a].x=0);else if(4==this._layoutModel)for(b=Math.min(this._grids.length,this._lineMaxNum),a=0;a<this._grids.length;a++)0<this._lineMaxNum?(this._grids[a].x=Math.floor(a/this._lineMaxNum)*(this._grids[a].width+this._marginh),this._grids[a].y=-(b*(this.height+this._marginv)/2)+Math.floor(a%this._lineMaxNum)*(this._grids[a].height+this._marginv)+this.height/2+this._marginv/2):(this._grids[a].x=0,this._grids[a].y=-(this._grids.length*(this.height+this._marginv)/2)+a*(this._grids[a].height+this._marginv)+this.height/2);else if(5==this._layoutModel)for(a=0;a<this._grids.length;a++)0<this._lineMaxNum?(this._grids[a].x=Math.floor(a/this._lineMaxNum)*(this._grids[a].width+this._marginh),this._grids[a].y=-Math.floor(a%this._lineMaxNum)*(this._grids[a].height+this._marginv)):(this._grids[a].x=0,this._grids[a].y=-a*(this._grids[a].height+this._marginv))}};a.Clean=function(){var a,b;for(b in this._grids)a=this._grids[b],a.destroy();this._grids.length=0};a.Clone=function(){var a=new b;a.size(this.width,this.height);a.layoutModel=this.layoutModel;a.marginh=this.marginh;a.marginv=this.marginv;a.skin=this.skin;return a};e(0,a,"layoutModel",function(){return this._layoutModel},function(a){0>a||5<a||(this._layoutModel=a,this.LayoutGroup())});e(0,a,"lineMaxNum",function(){return this._lineMaxNum},function(a){0>=a&&(a=-1);this._lineMaxNum=a;this.LayoutGroup()});e(0,a,"marginh",function(){return this._marginh},function(a){this._marginh=a;this.LayoutGroup()});e(0,a,"width",function(){return 0==this._layoutModel&&0<this._grids.length?0<this._lineMaxNum&&this._grids.length>this._lineMaxNum?this._grids[this._lineMaxNum-1].x+this._grids[this._lineMaxNum-1].width:this._grids[this._grids.length-1].x+this._grids[this._grids.length-1].width:this._gridW},c.prototype._$set_width);e(0,a,"marginv",function(){return this._marginv},function(a){this._marginv=a;this.LayoutGroup()});e(0,a,"skin",function(){return this._skin},function(a){this._skin=a});e(0,a,"height",function(){return 0==this._layoutModel&&0<this._grids.length?0<this._lineMaxNum&&this._grids.length>this._lineMaxNum?(Math.floor(this._grids.length/this._lineMaxNum)+(0!=this._grids.length%this._lineMaxNum?1:0))*(this._grids[0].height+this._marginv):this._grids[0].height:this._gridH},c.prototype._$set_height);e(0,a,"gridW",null,function(a){this._gridW=a});e(0,a,"gridH",null,function(a){this._gridH=a});e(0,a,"grids",function(){return this._grids});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(Q,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(Q,this,"y",Math.round(a))});return b}(Q),Wa=function(c){function b(a,c,e,f,g,l){this._controler=null;this._useDefault=!0;this._repeatH=this._repeatW=0;this._loadingkey=null;this._stopAtIdx=-1;this._isloop=!1;this._group=this._owner=null;this.isSingleDir=this._isClear=!1;this._isShow=!0;this._blend=null;this._resscale=1;this._renderFrames=null;b.__super.call(this);this._controler=new cc(this,c,e,f,g);this._owner=a;this._group=l;M.Ins.RefAni(this)}g(b,"engine.animation.MAnimation2D",c);var a=b.prototype;f.imps(a,{"engine.res.IAnimationRes":!0,"engine.animation.interfaces.IAnimation":!0});a.clear=function(){this._resscale=1;this._renderFrames=null;this._isClear=!0;this._loadingkey=null;this._isloop=!1;this._useDefault=!0;this._repeatH=this._repeatW=0;this._stopAtIdx=-1;this._controler.clear();this.graphics.clear()};a.destroy=function(a){void 0===a&&(a=!0);this.destroyed||(M.Ins.FreeAni(this),this.clear(),this._controler.destroy(a),this._owner=this._controler=null,laya.display.Sprite.prototype.destroy.call(this,a))};a.scale=function(a,b,c){throw Error("\u5916\u90e8\u7981\u6b62\u8bbe\u7f6e\u7f29\u653e");};a.SetData=function(a,b,c,e,f,g){this._isClear=!1;this._controler.SetData(a,b,c,e,f,g)};a.DoAction=function(a,b,c){void 0===c&&(c=!1);this._isloop=c;this._controler.DoAction(a,b);this._stopAtIdx=-1};a.LoadBin=function(){var a=this.GetType(),b=this.GetId(),c=this.GetActType();this._loadingkey=F.ToKeyName(a,b,c);a=F.IsUnload(a,b,c)?null:va.Ins.GetResPack(this,this._loadingkey);this.OnBinLoaded(this._loadingkey,a);this.event("loaded")};a.OnBinLoaded=function(a,b){this.destroyed||this._loadingkey!=a||(a=b,null==a?this.useDefault&&!this.isPart&&(a=va.Ins.GetDefaultAnimation(this._controler.GetActType()),this._controler.SetDefaultResPack(a)):this._controler.SetResPack(a),a?(this._blend=1==a.blend?"add":null,this.UpdateRenderFrames()):this.ClearAnimationPlay())};a.OnBinFailed=function(a){};a.OnTextureLoaded=function(a){this._controler.sheet==a&&this.UpdateRenderFrames()};a.OnTextureFailed=function(a){};a.SetDirection=function(a){this._controler.SetDirection(a);this.UpdateRenderFrames();this.checkShowState()};a.ClearAnimationPlay=function(){this._renderFrames=null;this.graphics.clear();this._controler.stop()};a.UpdateRenderFrames=function(){(this._renderFrames=this._controler.GetRenderFrames())?(this._resscale=this._controler.resscale,this._controler.OnSheetReady(),0<=this._stopAtIdx&&this.GotoAndStop(this._stopAtIdx),this.UpdateScale()):this.ClearAnimationPlay()};a.checkShowState=function(){this.isSingleDir&&-1!=[0,1,2,6,7].indexOf(this.direction)?this.visible=!1:this.visible=this.isShow};a.UpdateScale=function(){var a=this._resscale;5<=this.direction&&(a=-this._resscale);f.superSet(C,this,"scaleX",a);f.superSet(C,this,"scaleY",this._resscale)};a.SetPlaySpeed=function(a){this._controler.SetPlaySpeed(a)};a.RenderFrame=function(a){var b=this.graphics;b.clear();if(a=this.GetFrame(a))if(null==a.texs)b="MAnimation2D RenderFrame\u88ab\u91ca\u653e\u8fd8\u5728\u6e32\u67d3\uff1a key\x3d"+F.ToKeyName(this.GetType(),this.GetId(),this.GetActType(),this.GetExtra())+" renderkey:"+this._controler.resPack.url+" destroyed:"+this.destroyed+" clear:"+this._isClear+" parent:"+Za.getClassName(this.parent.parent),console.log(b);else if(this.isRepeat&&1==a.texs.length){var d=a.texs[0];b.fillTexture(d,a.offxs[0],a.offys[0],0!=this._repeatW?this._repeatW:d.width,0!=this._repeatH?this._repeatH:d.height)}else for(var d=a.texs,c=d.length,e=0;e<c;++e)b.drawTexture(d[e],a.offxs[e],a.offys[e],0,0,null,1,null,this._blend)};a.GetFrame=function(a){var b=this._renderFrames;return b?(this._controler.isPart&&(a%=b.length),b[a]):null};a.SetRepeatSize=function(a,b){this._repeatW=a;this._repeatH=b};a.Play=function(a,b){void 0===a&&(a=0);void 0===b&&(b=!0);0>a&&(a=0);this._controler.play(a,b);this._stopAtIdx=-1};a.Stop=function(){this._controler.stop();this._stopAtIdx=this._controler.index};a.GotoAndStop=function(a){this._controler.gotoAndStop(a);this._stopAtIdx=a};a.GotoFrameIdx=function(a){this._controler.index=a;this._stopAtIdx=-1};a.GetFrameIdx=function(){return this._controler.index};a.CloneCurFrame=function(a){null==a&&(a=new C);a.scaleX=this.scaleX;a.scaleY=this.scaleY;var b=this.GetFrame(this._controler.index);if(null!=b)for(var c=0;c<b.texs.length;++c)a.graphics.drawTexture(b.texs[c],b.offxs[c],b.offys[c]);return a};a.SetFrameCaller=function(a,b){this._controler.SetFrameCaller(a,b)};a.SetEndCaller=function(a,b){this._controler.SetEndCaller(a,b)};a.GetActType=function(){return this._controler.GetActType()};a.GetId=function(){return this._controler.GetId()};a.GetType=function(){return this._controler.GetType()};a.GetExtra=function(){return this._controler.GetExtra()};e(0,a,"scaleX",c.prototype._$get_scaleX,function(a){throw Error("\u5916\u90e8\u7981\u6b62\u8bbe\u7f6e\u7f29\u653e");});e(0,a,"isNeedDraw",function(){return null!=this._style&&.01<this._style.alpha});e(0,a,"loop",function(){return this._controler.loop});e(0,a,"isActiveMode",function(){return this._controler.isActiveMode},function(a){this._controler.isActiveMode=a});e(0,a,"scaleY",c.prototype._$get_scaleY,function(a){throw Error("\u5916\u90e8\u7981\u6b62\u8bbe\u7f6e\u7f29\u653e");});e(0,a,"isActiveAction",function(){return this._controler.isActiveAction},function(a){this._controler.isActiveAction=a});e(0,a,"isPlaying",function(){return this._controler.isPlaying});e(0,a,"direction",function(){return this._controler.direction});e(0,a,"isPart",function(){return this._controler.isPart},function(a){this._controler.isPart=a});e(0,a,"isReverseAutoOver",function(){return this._controler.isReverseAutoOver},function(a){this._controler.isReverseAutoOver=a});e(0,a,"renderDir",function(){return this._controler.rnDdir});e(0,a,"curSortValue",function(){return this._controler.curSortValue});e(0,a,"isRepeat",function(){return 0!=this._repeatH||0!=this._repeatW});e(0,a,"curDirFrameIdx",function(){return this._controler.index});e(0,a,"resPackType",function(){return 1});e(0,a,"useDefault",function(){return this._useDefault},function(a){this._useDefault=a});e(0,a,"stopAtIdx",function(){return this._stopAtIdx});e(0,a,"isPlayReverse",function(){return 1==this._controler.wrapMode},function(a){a?this._controler.wrapMode=1:1==this._controler.wrapMode&&(this._controler.wrapMode=0)});e(0,a,"allTime",function(){return this._controler.allTime});e(0,a,"isloop",function(){return this._isloop});e(0,a,"loadingkey",function(){return this._loadingkey});e(0,a,"isShow",function(){return this._isShow},function(a){this._isShow!=a&&(this._isShow=a,this.checkShowState())});e(0,a,"controler",function(){return this._controler});return b}(C),Jb=function(c){function b(){b.__super.call(this)}g(b,"engine.templet.MTemplet",c);var a=b.prototype;a.destroy=function(){var a,b;for(b in this.subTextureDic)(a=this.subTextureDic[b])&&a.destroy(!0);for(b in this._textureDic)(a=this._textureDic[b])&&a.destroy(!0);c.prototype.destroy.call(this)};a.loadAni=function(a){null==this._skBufferUrl&&c.prototype.loadAni.call(this,a)};a.onComplete=function(a){null==Z.getRes(this._skBufferUrl)&&(this._skBufferUrl=null);c.prototype.onComplete.call(this,a)};a._textureComplete=function(){if(this.destroyed)for(var a,b=0,e=this._loadList.length;b<e;b++)a=this._loadList[b],a=this._textureDic[a]=Z.getRes(a),a.destroy(!0);else c.prototype._textureComplete.call(this)};e(0,a,"skBufferUrl",function(){return this._skBufferUrl});return b}(lb),Sa=function(c){function b(){this.isSimpleModal=this.modalUnclose=this.isModal=this.hasDi=!1;this.modelMethod=this.modelCaller=null;this._isViewCreated=!1;this._callOpenParam=null;this._callOpen=!1;this._di=null;b.__super.call(this);this.autoDestroyAtClosed=!0;this.centerY=this.centerX=0;this.on("click",this,this._onClick);if(J.Ins.isWideScreen&&(this.width>f.stage.width||this.height-200>f.stage.height)){var a=1/Math.max(this.width/f.stage.width,(this.height-200+200)/f.stage.height);this.scale(a,a)}}g(b,"engine.pui.components.PView",c);var a=b.prototype;a.createChildren=function(){this.on("onViewCreated",this,this.onViewCreated);laya.display.Scene.prototype.createChildren.call(this)};a.destroy=function(a){void 0===a&&(a=!0);this._callOpenParam=!1;this.onClose();c.prototype.destroy.call(this,a)};a.onViewCreated=function(){this._isViewCreated=!0;this.displayedInStage&&this._callOpen&&(this.onOpened(this._callOpenParam),this._callOpenParam=null,this._callOpen=!1)};a.onOpened=function(a){this._isViewCreated?(this.hasDi&&(null==this._di&&(this._di=new B,this._di.loadImage("res/ui/atlas_ui/zhucheng/ui_zc_jz_ditu.jpg"),this._di.size(960,1440)),this.addChildAt(this._di,0),this._di.pos((this.width-this._di.width)/2,(this.height-this._di.height)/2)),this.zOrder=this.layer,this.onOpen(a),laya.display.Scene.prototype.onOpened.call(this,a)):(this._callOpenParam=a,this._callOpen=!0)};a.onClosed=function(a){this.onClose();this.modelMethod=this.modelCaller=null;this._di&&(this._di.destroy(),this._di=null);(this.isModal||this.isSimpleModal)&&J.Ins.checkMask();laya.display.Scene.prototype.onClosed.call(this,a)};a.onOpen=function(a){};a.onClose=function(){};a.open=function(a,b){void 0===a&&(a=!0);laya.display.Scene.prototype.open.call(this,a,b);D.doOpenViewCallBack(this.url)};a.close=function(a){laya.display.Scene.prototype.close.call(this,a);D.doCloseViewCallBack(this.url)};a._onClick=function(a){if(a=a.target)switch(a.name){case "close":case "cancel":case "sure":case "no":case "ok":case "yes":this.close(a.name),D.doCloseViewManul(this.url)}};e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(pa,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){var b=0;isNaN(this.top)||(b=ta.Ins.notchHeight);f.superSet(pa,this,"y",Math.round(a+b))});e(0,a,"layer",function(){return 17});return b}(pa),Tb=function(c){function b(a){b.__super.call(this,a)}g(b,"engine.pui.components.PProgressBar",c);var a=b.prototype;a._skinLoaded=function(){this.destroyed||c.prototype._skinLoaded.call(this)};e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(la,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(la,this,"y",Math.round(a))});return b}(la),E=function(c){function b(a){this._tipsHandler=this._initSkin=null;b.__super.call(this,a)}g(b,"engine.pui.components.PImage",c);var a=b.prototype;a.SetTips=function(a,b){null==this._tipsHandler&&(this._tipsHandler=new Ab(this,b));this._tipsHandler.SetTipsData(a)};a.DisposeTips=function(){null!=this._tipsHandler&&(this._tipsHandler.destroy(),this._tipsHandler=null)};a.Clone=function(){var a=new b;null!=this.sizeGrid&&(a.sizeGrid=this.sizeGrid);a.skin=this._initSkin;a.size(this.width,this.height);return a};e(0,a,"skin",c.prototype._$get_skin,function(a){null==this._initSkin&&(this._initSkin=a);f.superSet(X,this,"skin",a)});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(X,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(X,this,"y",Math.round(a))});return b}(X),Ob=function(c){function b(a,c){b.__super.call(this,a,c)}g(b,"engine.pui.components.PComboBox",c);var a=b.prototype;e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(ia,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(ia,this,"y",Math.round(a))});return b}(ia),Qa=function(c){function b(a){b.__super.call(this,a)}g(b,"engine.pui.components.PSlider",c);return b}(Aa),Zb=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PBox",c);var a=b.prototype;e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(fa,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(fa,this,"y",Math.round(a))});return b}(fa),Nb=function(c){function b(a,c,e){void 0===c&&(c=1);void 0===e&&(e=1);b.__super.call(this,a,c,e)}g(b,"engine.pui.components.PClip",c);return b}($a),Qb=function(c){function b(a){b.__super.call(this,a);this.isVertical=!1}g(b,"engine.pui.components.PHSlider",c);return b}(Aa),Pa=function(c){function b(a){b.__super.call(this,a);this.elasticDistance=100;this.elasticBackTime=200}g(b,"engine.pui.components.PScrollBar",c);return b}(za),Na=function(c){function b(a){void 0===a&&(a="");b.__super.call(this,a)}g(b,"engine.pui.components.PLabel",c);var a=b.prototype;a.createChildren=function(){this.addChild(this._tf=new I)};a.Clone=function(){var a=new b;a.size(this.width,this.height);a.font=this.font;a.fontSize=this.fontSize;a.left=this.left;a.leading=this.leading;a.align=this.align;a.color=this.color;a.wordWrap=this.wordWrap;a.stroke=this.stroke;a.strokeColor=this.strokeColor;a.text=this.initText;return a};e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(Y,this,"y",Math.round(a))});e(0,a,"initText",function(){return this._tf.initText},function(a){this._tf.initText=a});e(0,a,"textW",function(){return this._tf.textWidth});e(0,a,"textH",function(){return this._tf.textHeight});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(Y,this,"x",Math.round(a))});return b}(Y),Lb=function(c){function b(a,c){this.feedScale=!0;this._isFeed=!1;this._isEnabled=!0;this.initSY=this.initSX=1;this.FEED_BACK_SCALE=.95;this._downY=this._downX=0;void 0===c&&(c="");b.__super.call(this,a,c)}g(b,"engine.pui.components.PButton",c);var a=b.prototype;a.createChildren=function(){this.graphics=this._bitmap=new Va};a.createText=function(){this._text||(this._text=new I,this._text.overflow="hidden",this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)};a.BeginFeedBack=function(){this.feedScale&&!this._isFeed&&(this.initSX=this.scaleX,this.initSY=this.scaleY,this._downX=this.x,this._downY=this.y,this.scale(this.initSX*this.FEED_BACK_SCALE,this.initSY*this.FEED_BACK_SCALE),0==this.width||0==this.height?this.pos(this.x+2,this.y+2):this.pos(this.x+this.width*this.initSX*(1-this.FEED_BACK_SCALE)/2,this.y+this.height*this.initSY*(1-this.FEED_BACK_SCALE)/2),this._isFeed=!0)};a.EndFeedBack=function(){this.feedScale&&this._isFeed&&(this.scale(this.initSX,this.initSY),this.pos(this._downX,this._downY),this._isFeed=!1,jb.playSound("res/sound/ui/101.wav"))};a.Clone=function(){var a=new b;a.size(this.width,this.height);a.skin=this._skin;a.sizeGrid=this.sizeGrid;a.label=this.label;a.labelFont=this.labelFont;a.labelSize=this.labelSize;a.stateNum=this.stateNum;a.labelColors=this.labelColors;return a};e(0,a,"stateNum",c.prototype._$get_stateNum,function(a){1==a?(this.on("mousedown",this,this.BeginFeedBack),this.on("mouseup",this,this.EndFeedBack),this.on("mouseout",this,this.EndFeedBack)):(this.off("mousedown",this,this.BeginFeedBack),this.off("mouseup",this,this.EndFeedBack),this.off("mouseout",this,this.EndFeedBack));f.superSet(K,this,"stateNum",a)});e(0,a,"isEnabled",function(){return this._isEnabled},function(a){this.mouseEnabled=this._isEnabled=a;this.gray=!a});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(K,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(K,this,"y",Math.round(a))});return b}(K),Ma=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PHScrollBar",c);b.prototype.initialize=function(){c.prototype.initialize.call(this);this.slider.isVertical=!1};return b}(za),Ua=function(c){function b(a){this._iconHeight=this._iconWidth=this._gridId=this._gridType=0;this._text=this._topText=this._iconEff=this._labRank=this._imgRank=this._imgType=this._imgIcon=this._coolDown=null;this.skillindex=this._textOffy=this._textOffx=0;this._textLayout=4;this._backChilds=[];this._fixedChilds=[];this._topChild=[];this._flagChilds=[];b.__super.call(this)}g(b,"engine.pui.componentext.PGrid",c);var a=b.prototype;a.initGrid=function(a,b){this._gridId=a;this._gridType=b};a.destroy=function(a){void 0===a&&(a=!0);this.Clean();this.DisposeFixDisplay();laya.ui.Image.prototype.destroy.call(this,a)};a.Clean=function(){this._tag=null;this.skin=this._initSkin;this.DisposeIcon();this.DisposeIconEff();this.DisposeText();this.DisposeTopText();this.DisposeDisplay();this.DisposeTips();this.DisposeCoolDown();this.DisposeRank();f.timer.clearAll(this)};a.DisposeCoolDown=function(){if(null!=this._coolDown){var a=this._coolDown;a.off("grid_cooldown_finished",this,this.CooldownFinishHandler);this._coolDown.Stop();this.gridContent.contains(a)&&this.gridContent.removeChild(a);this._coolDown=null}};a.CooldownFinishHandler=function(a){this.DisposeCoolDown()};a.SetIcon=function(a,b,c){if(null!=this._imgIcon){if(this._imgIcon.skin==a)return;this._imgIcon.skin=a}else this._imgIcon=new E,this._imgIcon.skin=a,this.gridContent.addChild(this._imgIcon),this.SortSubCom();this._imgIcon.width=b;this._imgIcon.height=c;this._imgIcon.x=.5*(this.width-b);this._imgIcon.y=.5*(this.height-c)};a.SetIconType=function(a,b,c){void 0===b&&(b=38);void 0===c&&(c=38);if(null==a||""==a)null!=this._imgType&&(this._imgType.visible=!1,this._imgType.skin=null);else{if(null!=this._imgType){if(this._imgType.skin==a)return;this._imgType.skin=a}else this._imgType=new E,this._imgType.skin=a,this.gridContent.addChild(this._imgType),this.SortSubCom();this._imgType.width=b;this._imgType.height=c;this._imgType.x=4;this._imgType.y=this.height-c-4;this._imgType.visible=!0}};a.SetRank=function(a){if(null!=this._imgRank){if("res/ui/sg_ui/build/jieshudi.png"==this._imgRank.skin)return;this._imgRank.skin="res/ui/sg_ui/build/jieshudi.png"}else this._imgRank=new E,this._imgRank.skin="res/ui/sg_ui/build/jieshudi.png",this.gridContent.addChild(this._imgRank),this.SortSubCom();this._imgRank.width=26;this._imgRank.height=50;this._imgRank.x=this.width-this._imgRank.width-4;this._imgRank.y=4;a+="\u9636";if(null!=this._labRank){if(this._labRank.text==a)return;this._labRank.text=a}else this._labRank=new Na,this._labRank.text=a,this.gridContent.addChild(this._labRank),this.SortSubCom();this._labRank.align="center";this._labRank.valign="top";this._labRank.width=26;this._labRank.height=50;this._labRank.font="font_ui_jieshu";this._labRank.x=this.width-this._imgRank.width-3;this._labRank.y=8;this._labRank.wordWrap=!0};a.SetIconGray=function(a){this._imgIcon&&(this._imgIcon.gray=a);this._imgType&&(this._imgType.gray=a)};a.CloneGridIcon=function(){return this._imgIcon.Clone()};a.DisposeIcon=function(){null!=this._imgIcon&&(this._imgIcon.destroy(),this._imgIcon=null);null!=this._imgType&&(this._imgType.destroy(),this._imgType=null)};a.DisposeRank=function(){null!=this._imgRank&&(this._imgRank.destroy(),this._imgRank=null);null!=this._labRank&&(this._labRank.destroy(),this._labRank=null)};a.DisposeIconEff=function(){null!=this._iconEff&&(null!=this._iconEff.parent&&this._iconEff.parent.removeChild(this._iconEff),this._iconEff.destroy(),this._iconEff=null)};a.setTopText=function(a,b,c,e){void 0===b&&(b="#79421C");void 0===c&&(c=1);void 0===e&&(e="#080808");null==this._topText&&(this._topText=new I,this._topText.align="left",this.gridContent.addChild(this._topText),this._topText.x=10,this._topText.y=8,this.SortSubCom());this._topText.color=b?b:"#FFFFFF";this._topText.stroke=c;this._topText.strokeColor=e;this._topText.text=a;this._topText.width=this._topText.textWidth+5;this._topText.height=this._topText.textHeight+4};a.DisposeTopText=function(){null!=this._topText&&(this._topText.destroy(),this._topText=null)};a.SetText=function(a,b){null==this._text&&(this._text=new I,this._text.align="right",this._text.color=b?b:"#FFFFFF",this.gridContent.addChild(this._text),this.SortSubCom());this._text.color=b?b:"#FFFFFF";this._text.text=a;this._text.width=this._text.textWidth+5;this._text.height=this._text.textHeight+4;this.UpdateTextLayout()};a.SetTextLayout=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);this._textOffx=b;this._textOffy=c;this._textLayout!=a&&(this._textLayout=a,this.UpdateTextLayout())};a.UpdateTextLayout=function(){if(null!=this._text)switch(this._text.width=this._text.textWidth+5,this._text.height=this._text.textHeight+4,this._textLayout){case 1:this._text.x=.5*(this.width-this._text.width)+this._textOffx;this._text.y=this._textOffy;break;case 2:this._text.x=this.width-this._text.width+this._textOffx-5;this._text.y=this._textOffy;break;case 3:this._text.x=this.width-this._text.width+this._textOffx-5;this._text.y=.5*(this.height-this._text.height)+this._textOffy;break;case 4:this._text.x=this.width-this._text.width+this._textOffx-5;this._text.y=this.height-this._text.height+this._textOffy;break;case 5:this._text.x=.5*(this.width-this._text.width)+this._textOffx;this._text.y=this.height-this._text.height+this._textOffy;break;case 6:this._text.x=this._textOffx;this._text.y=this.height-this._text.height+this._textOffy;break;case 7:this._text.x=this._textOffx;this._text.y=.5*(this.height-this._text.height)+this._textOffy;break;case 8:this._text.x=this._textOffx;this._text.y=this._textOffy;break;case 9:this._text.x=.5*(this.width-this._text.width)+this._textOffx,this._text.y=.5*(this.height-this._text.height)+this._textOffy}};a.DisposeText=function(){null!=this._text&&(this._text.destroy(),this._text=null)};a.AddBackDisplay=function(a){null!=a&&-1==this._backChilds.indexOf(a)&&(this._backChilds.push(a),this.gridContent.addChild(a),this.SortSubCom())};a.AddFixedDisplay=function(a){null!=a&&-1==this._fixedChilds.indexOf(a)&&(this._fixedChilds.push(a),this.gridContent.addChild(a),this.SortSubCom())};a.AddTopDisplay=function(a){null!=a&&-1==this._topChild.indexOf(a)&&(this._topChild.push(a),this.gridContent.addChild(a),this.SortSubCom())};a.AddFlagDisplay=function(a){null!=a&&-1==this._flagChilds.indexOf(a)&&(this._flagChilds.push(a),this.gridContent.addChild(a),this.SortSubCom())};a.DisposeFlagDisplay=function(){for(var a=0;a<this._flagChilds.length;++a)S.DisposeDisplay(this._flagChilds[a]);this._flagChilds.length=0};a.RemoveDisplay=function(a){if(null!=a){var b=this._flagChilds.indexOf(a);-1!=b&&(this._flagChilds.splice(b,1),this.gridContent.removeChild(a));b=this._topChild.indexOf(a);-1!=b&&(this._topChild.splice(b,1),this.gridContent.removeChild(a));b=this._backChilds.indexOf(a);-1!=b&&(this._backChilds.splice(b,1),this.gridContent.removeChild(a));b=this._fixedChilds.indexOf(a);-1!=b&&(this._fixedChilds.splice(b,1),this.gridContent.removeChild(a))}};a.DisposeDisplay=function(){var a,b;for(b in this._backChilds)a=this._backChilds[b],S.DisposeDisplay(a);for(b in this._topChild)a=this._topChild[b],S.DisposeDisplay(a);for(b in this._flagChilds)a=this._flagChilds[b],S.DisposeDisplay(a);this._backChilds.length=0;this._topChild.length=0;this._flagChilds.length=0};a.DisposeFixDisplay=function(){var a,b;for(b in this._fixedChilds)a=this._fixedChilds[b],S.DisposeDisplay(a);this._fixedChilds.length=0};a.SortSubCom=function(){f.timer.once(1,this,this.ReleaySort)};a.ReleaySort=function(){var a=0,b;b=this._backChilds.length;if(0<b)for(var c in this._backChilds)b=this._backChilds[c],this.gridContent.setChildIndex(b,a),a+=1;null!=this._imgIcon&&(this.gridContent.setChildIndex(this._imgIcon,a),a+=1);null!=this._imgType&&(this.gridContent.setChildIndex(this._imgType,a),a+=1);b=this._fixedChilds.length;if(0<b)for(c in this._fixedChilds)b=this._fixedChilds[c],this.gridContent.setChildIndex(b,a),a+=1;b=this._topChild.length;if(0<b)for(c in this._topChild)b=this._topChild[c],this.gridContent.setChildIndex(b,a),a+=1;b=this._flagChilds.length;if(0<b)for(c in this._flagChilds)b=this._flagChilds[c],this.gridContent.setChildIndex(b,a),a+=1;null!=this._coolDown&&this.gridContent.setChildIndex(this._coolDown,a++);null!=this._iconEff&&this.gridContent.setChildIndex(this._iconEff,a++);null!=this._text&&(this.gridContent.setChildIndex(this._text,a),a+=1);null!=this._topText&&this.gridContent.setChildIndex(this._topText,a)};a.Clone=function(){var a=new b;null!=this.sizeGrid&&(a.sizeGrid=this.sizeGrid);a.skin=this._initSkin;a.size(this.width,this.height);return a};a.skill=function(a){this.skillindex=a};e(0,a,"isCoolDown",function(){return null!=this._coolDown});e(0,a,"coolDown",null,function(a){if(null==a||!(a instanceof laya.display.Sprite))throw Error("cooldown is not a displayobject!");null!=this._coolDown&&this.DisposeCoolDown();this._coolDown=a;null!=this._coolDown&&(this.gridContent.addChild(a),a.x=(this.width-a.width)/2,a.y=(this.height-a.height)/2,this.SortSubCom(),this._coolDown.Start(),a.on("grid_cooldown_finished",this,this.CooldownFinishHandler))});e(0,a,"text",function(){return this._text});e(0,a,"gridContent",function(){return this});e(0,a,"coolRemainTime",function(){return this._coolDown?this._coolDown.remainTime:-1});e(0,a,"iconEff",function(){return this._iconEff},function(a){this.DisposeIconEff();this._iconEff=a;null!=a&&(a.mouseEnabled=!1,a.x=.5*this.width,a.y=.5*this.height,this.gridContent.addChild(this._iconEff),this.SortSubCom())});e(0,a,"iconImg",function(){return this._imgIcon});e(0,a,"typeImg",function(){return this._imgType});e(0,a,"topText",function(){return this._topText});e(0,a,"gridType",function(){return this._gridType});e(0,a,"gridId",function(){return this._gridId});e(0,a,"iconWidth",function(){return 0>=this._iconWidth?this.width:this._iconWidth},function(a){this._iconWidth=a});e(0,a,"iconHeight",function(){return 0>=this._iconHeight?this.height:this._iconHeight},function(a){this._iconHeight=a});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(E,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(E,this,"y",Math.round(a))});return b}(E),Xb=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PTree",c);return b}(nb),Rb=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PList",c);return b}(eb),Pb=function(c){function b(a,c){b.__super.call(this,a,c)}g(b,"engine.pui.components.PFontClip",c);var a=b.prototype;e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(ka,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(ka,this,"y",Math.round(a))});return b}(ka),Yb=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PVSlider",c);return b}(Qa),Wb=function(c){function b(a){void 0===a&&(a="");b.__super.call(this,a)}g(b,"engine.pui.components.PTextInput",c);return b}(mb),Sb=function(c){function b(){this._fixContentHeight=this._fixContentWidth=-1;this._isShowArrow=this._trickModel=!1;this._arrowLeft=null;this._loffy=this._loffx=0;this._arrowRight=null;this._roffy=this._roffx=0;this._arrowUp=null;this._uoffy=this._uoffx=0;this._arrowDown=null;this._doffy=this._doffx=0;this._btnDown=this._btnUp=this._btnRight=this._btnLeft=null;this._stopPage=!1;this._scrollTween=null;b.__super.call(this)}g(b,"engine.pui.components.PPanel",c);var a=b.prototype;a.destroy=function(a){void 0===a&&(a=!0);this.RemoveAllObject(!0);this.DealScrollBtnEvent(!1);this.ClearScrollTween();c.prototype.destroy.call(this,a)};a.SetShowArrow=function(a,b,c,e,f,g,l,n,q){void 0===b&&(b=0);void 0===c&&(c=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);void 0===l&&(l=0);void 0===n&&(n=0);void 0===q&&(q=0);this._isShowArrow=a;this._loffx=b;this._loffy=c;this._roffx=e;this._roffy=f;this._uoffx=g;this._uoffy=l;this._doffx=n;this._doffy=q};a.SetStopPage=function(a){this._stopPage=a};a.SetScrollButton=function(a,b,c,e){this.DealScrollBtnEvent(!1);this._btnLeft=a;this._btnRight=b;this._btnUp=c;this._btnDown=e;this.DealScrollBtnEvent(!0);this.callLater(this.checkArrow)};a.DealScrollBtnEvent=function(a){if(this._btnLeft)if(a)this._btnLeft.on("click",this,this.ClickHScroll);else this._btnLeft.off("click",this,this.ClickHScroll),this._btnLeft=null;if(this._btnRight)if(a)this._btnRight.on("click",this,this.ClickHScroll);else this._btnRight.off("click",this,this.ClickHScroll),this._btnRight=null;if(this._btnUp)if(a)this._btnUp.on("click",this,this.ClickVScroll);else this._btnUp.off("click",this,this.ClickVScroll),this._btnUp=null;if(this._btnDown)if(a)this._btnDown.on("click",this,this.ClickVScroll);else this._btnDown.off("click",this,this.ClickVScroll),this._btnDown=null};a.ClickHScroll=function(a){this._TweenScroll(!1,a.currentTarget==this._btnLeft)};a.ClickVScroll=function(a){this._TweenScroll(!0,a.currentTarget==this._btnUp)};a._TweenScroll=function(a,b){this.ClearScrollTween();var c=a?this.contentHeight:this.contentWidth,d=a?this._height:this._width;if((a=a?this._vScrollBar:this._hScrollBar)&&c>d){var e=b?a.value-d:a.value+d;if(this._stopPage)var f=e/d|0,g=Math.round(e/d-f)*d,e=f*d,e=b?e-g:e+g;e=b?Math.max(e,0):Math.min(e,c-d);this._scrollTween=L.to(a,{value:e},300,r.linearNone)}};a.ClearScrollTween=function(){this._scrollTween&&(L.clear(this._scrollTween),this._scrollTween=null)};a.OnVScrollEnd=function(){this._stopPage&&this._ScrollEndFix(!0)};a.OnHScrollEnd=function(){this._stopPage&&this._ScrollEndFix(!1)};a._ScrollEndFix=function(a){this.ClearScrollTween();var b=a?this._height:this._width,c=a?this.contentHeight:this.contentWidth;(a=a?this._vScrollBar:this._hScrollBar)&&c>b&&(c=a.value/b|0,this._scrollTween=L.to(a,{value:1==Math.round(a.value/b-c)?(c+1)*b:c*b},100,r.linearNone))};a.RemoveAllObject=function(a){for(void 0===a&&(a=!1);0<this.content.numChildren;){var b=this.content.removeChildAt(0);a&&b.destroy()}};a.GetAllObject=function(){for(var a=[],b=0;b<this.content.numChildren;++b)a.push(this.content.getChildAt(b));return a};a.SetListCellData=function(a,b,c,e,f,g,l,n){void 0===b&&(b=1);void 0===c&&(c=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);void 0===l&&(l=-1);void 0===n&&(n=-1);this.RemoveAllObject(!0);for(var d=a.length,k=0;k<d;++k)this.addChild(a[k]);this.LayoutCellData(null,b,c,e,f,g,l,n)};a.LayoutCellData=function(a,b,c,e,f,g,l,n){void 0===b&&(b=1);void 0===c&&(c=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);void 0===l&&(l=-1);void 0===n&&(n=-1);var d=this._content.numChildren,k=this._content._children.concat();null!=a&&k.sort(a);var h=0,m=0,p=0;for(a=0;a<d;++a){var r=k[a],t=l;-1==t&&(t=r.width);var u=n;-1==u&&(u=r.height);r.x=f+a%b*(t+c);r.y=g+(p+e);a%b==b-1&&(p+=u+e);r.y+u>h&&(h=r.y+u);r.x+t>m&&(m=r.x+t)}this.fixContentWidth=-1!=l?m:-1;this.fixContentHeight=-1!=n?h:-1;this._setScrollChanged();for(a=0;a<d;++a)this.checkTrick(k[a])};a.checkAllTrick=function(){if(!this.destroyed&&this._trickModel)for(var a=0;a<this._content.numChildren;++a)this.checkTrick(this._content.getChildAt(a))};a.checkTrick=function(a){this._trickModel&&null!=a&&f.__typeof(a,"engine.pui.scroll.IScrollTrickCell")&&(b.__trackRect.x=a.x,b.__trackRect.y=a.y,b.__trackRect.width=a.width,b.__trackRect.height=a.height,null!=this._content&&null!=this._content.scrollRect&&this._content.scrollRect.intersects(b.__trackRect)?0==a.IsInView()&&(a.visible=!0,a.SetInView(!0)):1==a.IsInView()&&(a.visible=!1,a.SetInView(!1)))};a.checkArrow=function(){if(!this.destroyed){var a=this.contentWidth||1,c=this.contentHeight||1,e=this._vScrollBar,f=this._hScrollBar,c=e&&c>this._height;(a=f&&a>this._width)&&this._isShowArrow?(f.value>f.min?(null==this.arrowLeft.parent&&this.rawAddChild(this.arrowLeft),this.arrowLeft.visible=!0,this.arrowLeft.skin=b.ARROW_PREFIX+b.ARROW_LEFT,this.arrowLeft.size(b.ARROW_H_W,b.ARROW_H_H),this.arrowLeft.pos(0+this._loffx,(this._height-this.arrowLeft.height)/2+this._loffy)):this._arrowLeft&&(this._arrowLeft.visible=!1),f.value<f.max?(null==this.arrowRight.parent&&this.rawAddChild(this.arrowRight),this.arrowRight.visible=!0,this.arrowRight.skin=b.ARROW_PREFIX+b.ARROW_RIGHT,this.arrowRight.size(b.ARROW_H_W,b.ARROW_H_H),this.arrowRight.pos(this._width-this.arrowRight.width+this._roffx,(this._height-this.arrowRight.height)/2+this._roffy)):this._arrowRight&&(this._arrowRight.visible=!1)):(this._arrowLeft&&(this._arrowLeft.visible=!1),this._arrowRight&&(this._arrowRight.visible=!1));if(c&&this._isShowArrow){var g=this._width>=b.ARROW_V_BIG_W;if(e.value>e.min){null==this.arrowUp.parent&&this.rawAddChild(this.arrowUp);this.arrowUp.visible=!0;this.arrowUp.skin=b.ARROW_PREFIX+(g?b.ARROW_UP_BIG:b.ARROW_UP_SMALL);var l=g?b.ARROW_V_BIG_W:b.ARROW_V_SMALL_W,n=g?b.ARROW_V_BIG_H:b.ARROW_V_SMALL_H,l=Math.min(this._width,l),n=Math.min(this._height,n);this.arrowUp.size(l,n);this.arrowUp.pos((this._width-this.arrowUp.width)/2+this._uoffx,this._uoffy)}else this._arrowUp&&(this._arrowUp.visible=!1);e.value<e.max?(null==this.arrowDown.parent&&this.rawAddChild(this.arrowDown),this.arrowDown.visible=!0,this.arrowDown.skin=b.ARROW_PREFIX+(g?b.ARROW_DOWN_BIG:b.ARROW_DOWN_SMALL),l=g?b.ARROW_V_BIG_W:b.ARROW_V_SMALL_W,n=g?b.ARROW_V_BIG_H:b.ARROW_V_SMALL_H,l=Math.min(this._width,l),n=Math.min(this._height,n),this.arrowDown.size(l,n),this.arrowDown.pos((this._width-this.arrowDown.width)/2+this._doffx,this._height-this.arrowDown.height+this._doffy)):this._arrowDown&&(this._arrowDown.visible=!1)}else this._arrowUp&&(this._arrowUp.visible=!1),this._arrowDown&&(this._arrowDown.visible=!1);this._btnLeft&&(this._btnLeft.visible=a?f.value>f.min:!1);this._btnRight&&(this._btnRight.visible=a?f.value<f.max:!1);this._btnUp&&(this._btnUp.visible=c?e.value>e.min:!1);this._btnDown&&(this._btnDown.visible=c?e.value<e.max:!1)}};a.addChild=function(a){a=c.prototype.addChild.call(this,a);this.checkTrick(a);this.callLater(this.checkArrow);return a};a.addChildAt=function(a,b){a=c.prototype.addChildAt.call(this,a,b);this.checkTrick(a);this.callLater(this.checkArrow);return a};a.refresh=function(){this._trickModel&&this.callLater(this.checkAllTrick);this.callLater(this.checkArrow);c.prototype.refresh.call(this)};a.onScrollBarChange=function(a){c.prototype.onScrollBarChange.call(this,a);this.callLater(this.checkAllTrick);this.callLater(this.checkArrow)};a._sizeChanged=function(){c.prototype._sizeChanged.call(this);this.callLater(this.checkAllTrick);this.callLater(this.checkArrow)};e(0,a,"arrowDown",function(){null==this._arrowDown&&(this._arrowDown=new E);return this._arrowDown});e(0,a,"contentWidth",function(){return-1!=this._fixContentWidth?this._fixContentWidth:f.superGet(O,this,"contentWidth")});e(0,a,"contentHeight",function(){return-1!=this._fixContentHeight?this._fixContentHeight:f.superGet(O,this,"contentHeight")});e(0,a,"trickModel",function(){return this._trickModel},function(a){this._trickModel=a});e(0,a,"arrowUp",function(){null==this._arrowUp&&(this._arrowUp=new E);return this._arrowUp});e(0,a,"arrowLeft",function(){null==this._arrowLeft&&(this._arrowLeft=new E);return this._arrowLeft});e(0,a,"arrowRight",function(){null==this._arrowRight&&(this._arrowRight=new E);return this._arrowRight});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(O,this,"x",Math.round(a))});e(0,a,"fixContentWidth",function(){return this._fixContentWidth},function(a){this._fixContentWidth=a});e(0,a,"fixContentHeight",function(){return this._fixContentHeight},function(a){this._fixContentHeight=a});e(0,a,"vScrollBarSkin",c.prototype._$get_vScrollBarSkin,function(a){null==this._vScrollBar&&(this._vScrollBar=new Ra,this.rawAddChild(this._vScrollBar),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.on("end",this,this.OnVScrollEnd),this._vScrollBar.target=this._content,this._setScrollChanged());null!=a&&""!=a&&(this._vScrollBar.skin=a)});e(0,a,"hScrollBarSkin",c.prototype._$get_hScrollBarSkin,function(a){null==this._hScrollBar&&(this._hScrollBar=new Ma,this.rawAddChild(this._hScrollBar),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.on("end",this,this.OnHScrollEnd),this._hScrollBar.target=this._content,this._setScrollChanged());null!=a&&""!=a&&(this._hScrollBar.skin=a)});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(O,this,"y",Math.round(a))});b.ARROW_PREFIX=null;b.ARROW_UP_BIG=null;b.ARROW_UP_SMALL=null;b.ARROW_DOWN_BIG=null;b.ARROW_DOWN_SMALL=null;b.ARROW_V_BIG_W=0;b.ARROW_V_BIG_H=0;b.ARROW_V_SMALL_W=0;b.ARROW_V_SMALL_H=0;b.ARROW_LEFT=null;b.ARROW_RIGHT=null;b.ARROW_H_W=0;b.ARROW_H_H=0;y(b,["__trackRect",function(){return this.__trackRect=new P}]);return b}(O),Ra=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PVScrollBar",c);return b}(Pa),Ta=function(c){function b(){this._isViewCreated=!1;this._callOpenParam=null;this.modalUnclose=this._callOpen=!1;this.modelMethod=this.modelCaller=null;b.__super.call(this);this.isModal=this.autoDestroyAtClosed=!0;this.zOrder=this.layer;this.centerY=this.centerX=0}g(b,"engine.pui.components.PDialog",c);var a=b.prototype;a.createChildren=function(){this.on("onViewCreated",this,this.onViewCreated);laya.display.Scene.prototype.createChildren.call(this)};a.destroy=function(a){void 0===a&&(a=!0);this._callOpenParam=!1;this.onClose();c.prototype.destroy.call(this,a)};a.onViewCreated=function(){this._isViewCreated=!0;this.displayedInStage&&this._callOpen&&(this.onOpened(this._callOpenParam),this._callOpenParam=null,this._callOpen=!1)};a.onOpened=function(a){this._isViewCreated?(this.zOrder=this.layer,this.onOpen(a),laya.display.Scene.prototype.onOpened.call(this,a)):(this._callOpenParam=a,this._callOpen=!0)};a.onClosed=function(a){this.onClose();this.modelMethod=this.modelCaller=null;this.isModal&&J.Ins.checkMask();laya.display.Scene.prototype.onClosed.call(this,a)};a.onOpen=function(a){};a.onClose=function(){};a.SetModelMaskUnClose=function(a){if(this.isModal=a)this.modalUnclose=!0};e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(ja,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(ja,this,"y",Math.round(a))});e(0,a,"layer",function(){return 17});return b}(ja),Oa=function(c){function b(a,c){this.tabOpenParam=this.tabBindPanel=null;this.tabTag=0;void 0===c&&(c="");b.__super.call(this,a,c)}g(b,"engine.pui.components.PRadio",c);var a=b.prototype;a.destroy=function(a){void 0===a&&(a=!0);this.tabOpenParam=this.tabBindPanel=null;c.prototype.destroy.call(this,a)};a.initialize=function(){c.prototype.initialize.call(this);this._text.align="center";this._text.valign="middle";this._text.width=this._width;this._text.height=this._height};a.onClick=function(a){};a.createText=function(){this._text||(this._text=new I,this._text.overflow="hidden",this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)};a.Clone=function(){var a=new b;a.size(this.width,this.height);a.skin=this._skin;a.sizeGrid=this.sizeGrid;a.label=this.label;a.labelFont=this.labelFont;a.labelSize=this.labelSize;a.stateNum=this.stateNum;a.labelColors=this.labelColors;a._autoSize=this._autoSize;return a};e(0,a,"btnAutoSize",null,function(a){this._autoSize=a});e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(ma,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(ma,this,"y",Math.round(a))});return b}(ma),Mb=function(c){function b(a,c){this.preCheckCaller=this.preCheck=null;void 0===c&&(c="");b.__super.call(this,a,c)}g(b,"engine.pui.components.PCheckBox",c);var a=b.prototype;a.destroy=function(a){void 0===a&&(a=!0);this.preCheck=this.preCheckCaller=null;laya.ui.Button.prototype.destroy.call(this,a)};a.createChildren=function(){this.graphics=this._bitmap=new Va};a.createText=function(){this._text||(this._text=new I,this._text.overflow="hidden",this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)};a.onMouse=function(a){if(!1!==this.toggle||!this._selected)if("click"===a.type){if(this.toggle)if(this._selected)this.selected=!1;else if(null==this.preCheck||this.preCheck.call(this.preCheckCaller))this.selected=!0;this._clickHandler&&this._clickHandler.run()}else!this._selected&&(this.state=K.stateMap[a.type])};e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(ha,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(ha,this,"y",Math.round(a))});return b}(ha),Ub=function(c){function b(){this.groupCheckFunc=this.groupCheckCaller=null;this.isLastClick=this.btnAutoSize=!1;b.__super.call(this)}g(b,"engine.pui.components.PRadioGroup",c);var a=b.prototype;a.createItem=function(a,b){a=new Oa(a,b);a.btnAutoSize=this.btnAutoSize;return a};a.destroy=function(a){void 0===a&&(a=!0);this.groupCheckFunc=this.groupCheckCaller=null;laya.ui.UIGroup.prototype.destroy.call(this,a)};a.itemClick=function(a){if(null==this.groupCheckFunc||0!=this.groupCheckFunc.apply(this.groupCheckCaller,[a]))this.isLastClick=!0,this.selectedIndex=a};a.getSelectTag=function(){return this.items[this.selectedIndex].tabTag};a.getItemByTag=function(a){a=this.getTagIndex(a);return-1!=a?this.items[a]:null};a.getTagIndex=function(a){for(var b=0;b<this.items.length;++b)if(this.items[b].tabTag==a)return b;return-1};e(0,a,"x",c.prototype._$get_x,function(a){f.superSet(na,this,"x",Math.round(a))});e(0,a,"y",c.prototype._$get_y,function(a){f.superSet(na,this,"y",Math.round(a))});return b}(na),Vb=function(c){function b(){b.__super.call(this)}g(b,"engine.pui.components.PTab",c);return b}(kb);f.__init([zb])})(window,document,Laya);