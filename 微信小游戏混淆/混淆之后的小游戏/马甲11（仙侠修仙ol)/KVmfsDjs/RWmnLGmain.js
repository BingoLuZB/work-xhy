var a6_0x3abe=['tap','reset','requestAnimationFrame','loop','bind','pieces','forEach','movePieces','emptyPosition','stage','down','floor','position','move','length','index','gameOver','finalTime','getCurrentTime','clearRect','width','height','render','update','ani','checkGameOver','../weapp-adapter','getContext','gameInfo','eventUtil'];(function(_0x2a25f8,_0x5a3833){var _0x334fc6=function(_0x408c0d){while(--_0x408c0d){_0x2a25f8['push'](_0x2a25f8['shift']());}};_0x334fc6(++_0x5a3833);}(a6_0x3abe,0x1dc));var a6_0x7fcd=function(_0x1c3c5f,_0x36d809){_0x1c3c5f=_0x1c3c5f-0x0;var _0xac3f27=a6_0x3abe[_0x1c3c5f];return _0xac3f27;};require(a6_0x7fcd('0x0'));import a6_0x471288 from'./FoyKh5base/xvMi5geventUtil';import a6_0x30efef from'./V9pYFTruntime/juTUE5background';import a6_0x9fd523 from'./V9pYFTruntime/YJ9d0kgameInfo';import a6_0x3bf7ae from'./p3vKahdatabus';let ctx=canvas[a6_0x7fcd('0x1')]('2d');let databus=new a6_0x3bf7ae();export default class Main{constructor(){this['bg']=new a6_0x30efef(ctx);this[a6_0x7fcd('0x2')]=new a6_0x9fd523();this[a6_0x7fcd('0x3')]=new a6_0x471288(e=>{this[a6_0x7fcd('0x2')][a6_0x7fcd('0x4')](e);},e=>{this['movePieces'](e['direction']);});databus[a6_0x7fcd('0x5')]();window[a6_0x7fcd('0x6')](this[a6_0x7fcd('0x7')][a6_0x7fcd('0x8')](this),databus[a6_0x7fcd('0x9')][a6_0x7fcd('0xa')]((item,position)=>{item['render'](ctx);}));}[a6_0x7fcd('0xb')](direction){let targetPiece;switch(direction){case'up':targetPiece=databus[a6_0x7fcd('0xc')]+databus[a6_0x7fcd('0xd')];break;case a6_0x7fcd('0xe'):targetPiece=databus[a6_0x7fcd('0xc')]-databus[a6_0x7fcd('0xd')];break;case'left':targetPiece=databus[a6_0x7fcd('0xc')]+0x1;if(Math[a6_0x7fcd('0xf')](targetPiece/databus[a6_0x7fcd('0xd')])!==Math[a6_0x7fcd('0xf')](databus[a6_0x7fcd('0xc')]/databus['stage'])){return;}break;case'right':targetPiece=databus[a6_0x7fcd('0xc')]-0x1;if(Math[a6_0x7fcd('0xf')](targetPiece/databus[a6_0x7fcd('0xd')])!==Math[a6_0x7fcd('0xf')](databus[a6_0x7fcd('0xc')]/databus[a6_0x7fcd('0xd')])){return;}break;default:break;}databus[a6_0x7fcd('0x9')]['forEach'](item=>{if(item[a6_0x7fcd('0x10')]===targetPiece){item[a6_0x7fcd('0x11')](databus['emptyPosition']);databus[a6_0x7fcd('0xc')]=targetPiece;}});}['checkGameOver'](){if(databus['gameOver']||databus[a6_0x7fcd('0x9')][a6_0x7fcd('0x12')]===0x0){return;}for(let i=0x0;i<databus[a6_0x7fcd('0x9')][a6_0x7fcd('0x12')];i++){let piece=databus[a6_0x7fcd('0x9')][i];if(piece[a6_0x7fcd('0x13')]!==piece[a6_0x7fcd('0x10')]){return![];}}databus[a6_0x7fcd('0x14')]=!![];databus[a6_0x7fcd('0x15')]=databus[a6_0x7fcd('0x16')]();}['render'](){ctx[a6_0x7fcd('0x17')](0x0,0x0,canvas[a6_0x7fcd('0x18')],canvas[a6_0x7fcd('0x19')]);this['bg'][a6_0x7fcd('0x1a')](ctx);databus[a6_0x7fcd('0x9')]['forEach'](item=>{item[a6_0x7fcd('0x1a')](ctx);});this[a6_0x7fcd('0x2')][a6_0x7fcd('0x1a')](ctx);}[a6_0x7fcd('0x1b')](){let isAniPlaying=![];databus['pieces'][a6_0x7fcd('0xa')](item=>{item[a6_0x7fcd('0x1b')]();if(item[a6_0x7fcd('0x1c')]!==0x1){isAniPlaying=!![];}});if(!isAniPlaying){this[a6_0x7fcd('0x1d')]();}}[a6_0x7fcd('0x7')](){this['update']();this[a6_0x7fcd('0x1a')]();window['requestAnimationFrame'](this[a6_0x7fcd('0x7')][a6_0x7fcd('0x8')](this),canvas);}}