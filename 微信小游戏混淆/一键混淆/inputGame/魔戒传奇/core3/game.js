var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),define=window.definejs,require=window.requirejs;define("src/g/answerActivity/view/GameAnswerView",["require","exports","../../net/messages/AnswerMsg","../../../manager/LayerManager","../../../config/GameConfig","../../../manager/GameSocketManager","../../../utils/system/ServerTime","../../../init/TextConst"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function e(){var e=t.call(this)||this;return e._cdtimeCount=0,e.item0.index_txt.text="A",e.item1.index_txt.text="B",e.item2.index_txt.text="C",e.item3.index_txt.text="D",e.btn_close.on(Laya.Event.CLICK,e,e.closeView),a.GSM.ins.on(i.GetAnswerGS2C.KEY,e,e.resultHandler),e}return __extends(e,t),e.prototype.clickHandler=function(e){if(!this._cutItem){this._cutItem=this["item"+e];var t=new i.GetAnswerC2GS;t.cfgId=this._vo.cfgId,t.idx=e,this._currentSelect=e,a.GSM.sendServer(t)}},e.prototype.resultHandler=function(e){this.img_noanswer.visible=!1,this._cutItem&&(this._currentSelect==e.result?this._cutItem.ok_result.visible=!0:this._cutItem.err_result.visible=!0),this.item0.off(Laya.Event.CLICK,this,this.clickHandler),this.item1.off(Laya.Event.CLICK,this,this.clickHandler),this.item2.off(Laya.Event.CLICK,this,this.clickHandler),this.item3.off(Laya.Event.CLICK,this,this.clickHandler)},e.prototype.showView=function(e){this.cfidvo=e||s.GameConfig.answerconfig[1],n.LayerManager.closeAllPOPWindow(),n.LayerManager.addAnswerLayer(this)},e.prototype.loopHandler=function(){this._cdtimeCount<=0||(this._cdtimeCount--,this.num_time.text=this._cdtimeCount+"")},e.prototype.setData=function(e){if(this.con2.visible=!1,e){this.cfidvo||(this.cfidvo=s.GameConfig.answerconfig[1]),this.con2.visible=!0,this.img_noanswer.visible=!0,this._cutItem=null,this._vo=e;var t=s.GameConfig.answerconfig[1];this._cdtimeCount=t.time+e.time-o.ServerTime.serverTime,15<this._cdtimeCount&&(this._cdtimeCount=15),this.num_time.text=this._cdtimeCount+"",Laya.timer.loop(1e3,this,this.loopHandler),this.lab_decribe.text=e.subject,this.num_answers.text=r.TextConst.get(64,e.curNum,this.cfidvo.number),this.resetItem(),e.option&&(this.item0.visible=!0,this.item0.desc.text=e.option),e.optionB&&(this.item1.visible=!0,this.item1.desc.text=e.optionB),e.optionC&&(this.item2.visible=!0,this.item2.desc.text=e.optionC),e.optionD&&(this.item3.visible=!0,this.item3.desc.text=e.optionD)}else this.lab_decribe.text=r.TextConst.get(234),this.num_answers.text=""},e.prototype.resetItem=function(){for(var e=0;e<=3;e++)this["item"+e].alpha=1,Laya.Tween.clearAll(this["item"+e]),Laya.Tween.from(this["item"+e],{alpha:0},500*e),this["item"+e].visible=!1,this["item"+e].ok_result.visible=!1,this["item"+e].err_result.visible=!1;this.item0.on(Laya.Event.CLICK,this,this.clickHandler,[0]),this.item1.on(Laya.Event.CLICK,this,this.clickHandler,[1]),this.item2.on(Laya.Event.CLICK,this,this.clickHandler,[2]),this.item3.on(Laya.Event.CLICK,this,this.clickHandler,[3])},e.prototype.closeView=function(){this.removeSelf(),n.LayerManager.removeAnswerLayer()},e}(ui.answer.GameAnswerViewUI);t.GameAnswerView=l}),define("src/g/answerActivity/view/AnswerRankItemView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setData=function(e,t){this.rank_icon.skin=t<3?"res/index1/yezhan_paimingjiangli_"+(t+1)+".png":"",this.lab_rank.text=t+1+"",this.lab_rank.color=0==t?(this.lab_name.color="#dcc026",this.lab_number.color="#dcc026",this.lab_time.color="#dcc026"):1==t?(this.lab_name.color="#ff6633",this.lab_number.color="#ff6633",this.lab_time.color="#ff6633"):2==t?(this.lab_name.color="#66ccff",this.lab_number.color="#66ccff",this.lab_time.color="#66ccff"):(this.lab_name.color="#a89e8f",this.lab_number.color="#a89e8f",this.lab_time.color="#a89e8f"),this.lab_name.changeText(e.nickname),this.lab_number.changeText(e.value1.toString()),this.lab_time.changeText(e.value2.toString())},t}(ui.answer.AnswerRankItemViewUI);t.AnswerRankItemView=i}),define("src/g/answerActivity/view/AnswerRankPanel",["require","exports","src/g/answerActivity/view/AnswerRankItemView","../../../manager/LayerManager","../../../manager/RoleCenter","../../../init/TextConst"],function(e,t,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.rank_list.vScrollBarSkin="",e.rank_list.scrollBar.elasticDistance=100,e.rank_list.itemRender=i.AnswerRankItemView,e.rank_list.renderHandler=new Laya.Handler(e,e.onRenderListHandler),e.mouseThrough=!0,e.rank_list.array=[],e.btn_close.on(Laya.Event.CLICK,e,e.onBtnClose),e}return __extends(e,t),e.prototype.onRenderListHandler=function(e,t){e.setData(this.rank_list.array[t],t)},e.prototype.onBtnClose=function(){this.removeSelf()},e.prototype.showView=function(e){s.LayerManager.addInPOPWindowLayer(this),this.rank_list.array=e.rankArr,this.lab_name.text=a.RoleCenter.instans.vo.nickname;for(var t=e.rankArr.length,i=0;i<t;i++){var n=e.rankArr[i];n.username==a.RoleCenter.instans.vo.username&&(this.num_ok.text=n.value1+"",this.num_rank.text=n.value2+"",this.num_rank.text=this.lab_cueRank.text=i+1+"",this.lab_cueRank.text=o.TextConst.get(83,i+1))}},e}(ui.answer.AnswerRankPanelUI);t.AnswerRankPanel=n}),define("src/g/answerActivity/vo/AnwerInfo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){}return e.isopen=!1,e}();t.AnwerInfo=i}),define("src/g/answerActivity/view/AnswerStarDlg",["require","exports","../../../core/E","../../../enum/EventName","../../accessctrl/AccessCenter"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function e(){var e=t.call(this)||this;return e.btn_start.on(Laya.Event.CLICK,e,e.answerView),e.btn_close.on(Laya.Event.CLICK,e,e.closeView),e}return __extends(e,t),e.prototype.answerView=function(){s.AccessCenter.ins.checkOpen(s.enumAccessId.answer,!0)&&(this.closeView(),i.E.ins.event(n.EventName.OPENANSWER))},e.prototype.closeView=function(){t.prototype.close.call(this,"")},e.prototype.showView=function(){this.popup()},e.prototype.close=function(){},e}(ui.answer.AnswerStarDlgUI);t.AnswerStarDlg=a}),define("src/g/answerActivity/ctrl/AnswerStart",["require","exports","../../../manager/GameSocketManager","../../net/messages/AnswerMsg","src/g/answerActivity/view/GameAnswerView","../../../core/E","../../../enum/EventName","../../../config/GameConfig","src/g/answerActivity/view/AnswerRankPanel","src/g/answerActivity/vo/AnwerInfo","../../../init/Switches","../../accessctrl/AccessCenter","src/g/answerActivity/view/AnswerStarDlg","../../fightactivity/ctrl/FightActivityCtrl"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(){var e=i.GSM.ins;e.on(n.OpenAnswerGS2C.KEY,this,this.openAnswerGS2C),e.on(n.ChgAnswerGS2C.KEY,this,this.changeHandler),e.on(n.EndAnswerGS2C.KEY,this,this.endResult),a.E.ins.on(o.EventName.OPENANSWER,this,this.openHandler)}return e.prototype.openHandlerGuide=function(e){var t=r.GameConfig.answerconfig[1].coordinate;t=t||17,e==r.GameConfig.NPCJSON[t].moduleID&&(this.ask||(this.ask=new d.AnswerStarDlg),this.ask.showView())},e.prototype.endResult=function(e){g.FightActivityCtrl.endActivtiy(c.enumAccessId.answer),h.AnwerInfo.isopen=!1,this._curInfo=null,this._cfg=null,this._view&&this._view.parent&&(this._view.closeView(),this._rankview||(this._rankview=new l.AnswerRankPanel),this._rankview.showView(e))},e.prototype.changeHandler=function(e){h.AnwerInfo.isopen=!0,this._curInfo=e,this._view&&this._view.setData(e)},e.prototype.openAnswerGS2C=function(e){console.log("hu"),g.FightActivityCtrl.startActivity(c.enumAccessId.answer),h.AnwerInfo.isopen=!0,this._cfg=r.GameConfig.answerconfig[e.cfgId]},e.prototype.openHandler=function(){u.Switches.ins.event(c.enumAccessId.chat),this._view||(this._view=new s.GameAnswerView),this._view.showView(this._cfg),this._view.setData(this._curInfo)},e}();t.AnswerStart=p}),define("src/g/bossmeet/view/MeetBossView",["require","exports","../../../component/GAnimation","../../../manager/RoleCenter","../../../manager/AM","../../../core/E","../../../enum/EventName","../../fight/osprite/play/SceneNPCFight","../../../config/GameConfig","../../../utils/ItemUtils","../../../manager/StateManger","../../fight/info/PlayTypeVo","../../clearRes/ClearResM","../../fight/osprite/play/PlayManager","../../net/messages/ChangeSceneMsg","../../../init/Switches","../../accessctrl/AccessCenter","../../peronboss/view/ItemIconView","../../../utils/system/ErrCodeView","../../net/messages/ErrConst","../../fight/base/RES"],function(e,t,a,o,i,n,s,r,l,h,u,c,d,g,p,m,f,y,v,_,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(t){function e(){var e=t.call(this)||this;return e.monurl="",d.ClearResM.addBgUrl(e.bgimg.skin),e.view.btn_back.visible=!1,e.view.btn_close.on(Laya.Event.CLICK,e,e.btn_Handler),e.btn_think.on(Laya.Event.CLICK,e,e.btn_Handler),e.btn_fight.on(Laya.Event.CLICK,e,e.fightHandler),e.view.imgInnerBg.visible=!1,e}return __extends(e,t),e.prototype.btn_Handler=function(){this.close(),this.mos_ani.stop(),this.mos_ani.clear()},e.prototype.showView=function(e){this.popup(),this.mos_ani&&(this.mos_ani.stop(),this.mos_ani.clear(),this.mos_ani.removeSelf()),this.mos_ani=new a.GAnimation,this.mos_ani.x=254,this.mos_ani.y=315,this.addChild(this.mos_ani);o.RoleCenter.instans.self.portstatus.portindex;var t=l.GameConfig.bossmeetingJSON[e];if(t){this.creatItem(t.dropshow2);var i=h.ItemUtils.getPortVoById(e),n=h.ItemUtils.getMonsterVOById(i.boss);if(this.lvl.text=n.name+"lv."+n.lv,-1==n.moResVo.dir.indexOf(5)){var s=C.RES.MONSTER_PATH+n.moResVo.res+"/3_r.json";this.mos_ani.scale(-n.zoom,n.zoom)}else{s=C.RES.MONSTER_PATH+n.moResVo.res+"/5_r.json";this.mos_ani.scale(n.zoom,n.zoom)}this.monurl=s,this.mos_ani.load(s),d.ClearResM.setCachUrl(s),this.mos_ani.interval=250,this.mos_ani.play(),this.lab_hint.zOrder=100,this.lvl.zOrder=101}this.bgimg.restskin()},e.prototype.creatItem=function(e){for(var t=e.length,i=0;i<t;i++){var n=this["item"+i],s=h.ItemUtils.getItemOrEq(e[i]);n.jobicon,y.ItemIconView.setItemData(s,n,0)}},e.prototype.fightHandler=function(){o.RoleCenter.instans.bagRoomEnough()?(this.close(),console.log("开始遭遇boss"),u.StateManger.isSpecialPlay()||g.PlayManager.type!=p.EPlayType.PLAYTYPE_MAINCITY&&(d.ClearResM.clearCachUrl(this.monurl),n.E.ins.event(s.EventName.PLAY_TYPE_CHANGE,c.PlayTypeVo.create(p.EPlayType.PLAYTYPE_MEETBOSS,r.SceneBossData.MEETBOSS_INDEX,!1,!1)))):i.AM.show(v.ErrCodeView.getErrStr(_.enumErrConst.code_2206),Laya.Handler.create(this,function(){m.Switches.ins.event(f.enumAccessId.huishou)}))},e.prototype.close=function(){t.prototype.close.call(this),this.destroy(!0),d.ClearResM.clearResFolder("meetboss")},e}(ui.meetboss.BossMeetUI);t.MeetBossView=w}),define("src/g/bossmeet/ctrl/MeetBossCtrl",["require","exports","../../../manager/RoleCenter","src/g/bossmeet/view/MeetBossView","../../../manager/StateManger","../../../init/Switches","../../accessctrl/AccessCenter"],function(e,t,i,n,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.init=function(){a.Switches.ins.on(o.enumAccessId.zaoyuboss,this,this.openView)},e.prototype.openView=function(){s.StateManger.isSpecialPlay()||this.completeHandler()},e.prototype.completeHandler=function(){var e=new n.MeetBossView,t=i.RoleCenter.instans.self.meetPkData.meetBoss;t&&e.showView(t)},e}();t.MeetBossCtrl=r}),define("src/g/bossmeet/ctrl/BossMeetViewCtrl",["require","exports","../../../manager/RoleCenter","../../../enum/EventName","../../../core/E","../../../manager/StateManger","../../index/ctrl/GameIndexCtrl","src/g/bossmeet/ctrl/MeetBossCtrl","../../../init/Switches","../../accessctrl/AccessCenter","../../clearRes/ClearResM","../../../manager/GuideCenter","../../../enum/GuideTargetName","../../../manager/LayerManager","../../../utils/UIUtils","../../fight/osprite/play/PlayManager","../../net/messages/ChangeSceneMsg"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(){}return e.prototype.init=function(){s.E.ins.once(n.EventName.INIT_INDEX,this,this.checkBoss),s.E.ins.on(n.EventName.HANGUP,this,this.hangupHandler),s.E.ins.on(n.EventName.HITBOSS,this,this.hitbossHandler),s.E.ins.on(n.EventName.MEETPKDATA_CHANGE,this,this.checkBoss),s.E.ins.on(n.EventName.PLAY_TYPE_CHANGED,this,this.hangupHandler),s.E.ins.on(n.EventName.ENTER_PLAYTYPE_MAINCITY,this,this.hiddeTanHao),(new r.MeetBossCtrl).init()},e.prototype.hiddeTanHao=function(){this._bossTanhao&&(this._bossTanhao.visible=!1)},e.prototype.hangupHandler=function(){this._bossTanhao&&(this._bossTanhao.visible=m.PlayManager.type==f.EPlayType.PLAYTYPE_PORT,this.checkBoss())},e.prototype.hitbossHandler=function(){this._bossTanhao&&(this._bossTanhao.visible=!1)},e.prototype.checkBoss=function(){i.RoleCenter.instans.vo&&(i.RoleCenter.instans.vo.lvl<20||(i.RoleCenter.instans.self.meetPkData.meetBoss?(this._bossTanhao||(this._bossTanhao=new ui.meetboss.BossTanHaoUI,this._bossTanhao.ani_ani.source="res/atlas/res/meeteff.json",this._bossTanhao.on(Laya.Event.CLICK,this,this.openbossmeet),this._bossTanhao.x=Laya.stage.width-200,this._bossTanhao.y=440),o.GameIndexCtrl.idxView&&(o.GameIndexCtrl.idxView.addChild(this._bossTanhao),Laya.timer.frameOnce(2,this,this.registUIToGuide))):this._bossTanhao&&(this._bossTanhao.destroy(!0),this._bossTanhao=null,u.ClearResM.clearUrl("res/atlas/res/meeteff.json"))))},e.prototype.registUIToGuide=function(){var e=p.UIUtils.getGlobalBound(this._bossTanhao);e&&(c.GuideCenter.ins.registerInteractionArea(d.GuideTargetName.BOSS_ZAOYU_BTN,e),c.GuideCenter.ins.registerGuideObject(d.GuideTargetName.BOSS_ZAOYU_BTN,g.LayerManager.getMainGuideLayer()))},e.prototype.openbossmeet=function(){a.StateManger.isSpecialPlay()||l.Switches.ins.event(h.enumAccessId.zaoyuboss)},e}();t.BossMeetViewCtrl=y}),define("src/g/familyredpacket/ctrl/FSendRedPacketCtrl",["require","exports","../../base/BaseCtrl","../../../core/E","../../../enum/EventName","../../net/messages/UseItemC2GS","../../../manager/GameSocketManager","../../../utils/SoundUtils","../../../utils/system/FloatEffect","../../../manager/RoleCenter","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){function e(){var e=t.call(this)||this;return e.isOpend=!1,e.url="res/atlas/res/fsendredpacket.json",n.E.ins.on(s.EventName.SEND_FAMILY_RED_PACKET,e,e.openViewHander),e}return __extends(e,t),e.prototype.openViewHander=function(e){this.isOpend=!0,this.redPacketVo=e,this.open()},e.prototype.onAtlasLoaded=function(){0!=this.isOpend?(null==this.view&&(this.view=new ui.fmilyredpacket.FSendRedPacketUI,this.view.closeHandler=Laya.Handler.create(this,this.distoryView),this.view.sendButton.on(Laya.Event.CLICK,this,this.sendRedPacket),this.initContent()),this.view.popup()):this.clearCtrlRes()},e.prototype.initContent=function(){if(this.redPacketVo&&this.redPacketVo.effect&&0<this.redPacketVo.effect.length){var e=this.redPacketVo.effect[0][0];this.view.imgGold.value=e,this.view.imgGold.width=25*e.length,this.view.imgNum.value=this.redPacketVo.effect[0][1],2116==this.redPacketVo.id?this.view.imgTitle.skin="res/fsendredpacket/gonghuihongbao_neirong1_1.png":2117==this.redPacketVo.id?this.view.imgTitle.skin="res/fsendredpacket/gonghuihongbao_neirong1_2.png":2118==this.redPacketVo.id&&(this.view.imgTitle.skin="res/fsendredpacket/gonghuihongbao_neirong1_3.png")}},e.prototype.hlayout=function(e,t){for(var i=0,n=[],s=0;s<t.numChildren;s++)n.push(t.getChildAt(s));var a=n.length;for(s=0;s<a;s++)i+=n[s].width,s!=a-1&&(i+=e);var o=t.width-i>>1;for(s=0;s<a;s++)0==s?n[0].x=o:n[s].x=n[s-1].x+n[s-1].width+e},e.prototype.sendRedPacket=function(){var e=h.RoleCenter.instans.ufVo;if(!e||!e.inFamily)return this.view.close(),void l.FE.upItems(u.TextConst.get(114));if(this.redPacketVo){var t=new a.UseItemC2GS;t.cfgId=this.redPacketVo.id,t.count=1,o.GSM.sendServer(t),l.FE.upItems(u.TextConst.get(113))}else console.error("数据错误");this.view.close()},e.prototype.distoryView=function(){console.log("发红包窗口被关闭了"),this.isOpend=!1,null!=this.view&&(r.SoundUtils.getInstance().playBtnsounds(),this.view.sendButton.off(Laya.Event.CLICK,this,this.sendRedPacket),this.view.closeHandler=null,this.view.destroy(!0),this.view=null,this.clearCtrlRes(),Laya.loader.clearRes("res/bg/gonghuihongbao_diban.png"))},e}(i.BaseCtrl);t.FSendRedPacketCtrl=c}),define("src/g/familyredpacket/vo/FRedPacketVo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){this.redId=0,this.arr=[]};t.FRedPacketVo=i}),define("src/g/familyredpacket/ctrl/FRedPacketResultCtrl",["require","exports","../../base/BaseCtrl","../../../core/E","../../../enum/EventName","../../../utils/ItemUtils","../../../manager/RoleCenter","../../../utils/SoundUtils","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){function e(){var e=t.call(this)||this;return e.url="res/atlas/res/fredpacketresult.json",n.E.ins.on(s.EventName.FAMILY_RED_PACKET_RESULT,e,e.openViewHander),e}return __extends(e,t),e.prototype.openViewHander=function(e,t){this.redPacket=e,this.log=t,this.open()},e.prototype.onAtlasLoaded=function(){if(null==this.view){this.view=new ui.fmilyredpacket.FRedPacketResultUI,this.view.closeHandler=Laya.Handler.create(this,this.distoryView),this.view.lbName.text=this.redPacket.arr[0],this.view.imgHead.skin=a.ItemUtils.getHeadurlYuan(Number(this.redPacket.arr[2]),Number(this.redPacket.arr[1]));var e=a.ItemUtils.getItemVoById(this.redPacket.arr[3]);if(e){var t=e.effect[0][0];if(this.view.imgTotalMoney.value=t,17==e.type)switch(this.view.imgVip.visible=!1,e.id){case 2116:this.view.imgTitle.skin="res/fredpacketresult/gonghuihongbao_neirong2_1.png";break;case 2117:this.view.imgTitle.skin="res/fredpacketresult/gonghuihongbao_neirong2_2.png";break;case 2116:this.view.imgTitle.skin="res/fredpacketresult/gonghuihongbao_neirong2_1.png";break;case 2554:case 2555:case 2556:case 2557:case 2558:case 2559:case 2642:case 2643:case 2644:case 2645:this.view.imgTitle.skin="res/fredpacketresult/red.png";break;default:this.view.imgTitle.skin="res/fredpacketresult/gonghuihongbao_neirong2.png"}else this.view.imgVip.value=e.uselimit[1][1],this.view.imgTitle.skin="res/fredpacketresult/gonghuihongbao_neirong2.png"}this.initList(this.view.recordList,this.listItemRender,ui.fmilyredpacket.FRedPacketRecordUI),this.view.recordList.array=this.log}this.view.imgVip.restskin(),this.view.popup()},e.prototype.initList=function(e,t,i){e.itemRender=i,e.selectEnable=!0,e.vScrollBarSkin="",e.scrollBar.elasticDistance=50,e.renderHandler=new Laya.Handler(this,t),e.array=[]},e.prototype.listItemRender=function(e,t){var i,n;n=e.dataSource.name==o.RoleCenter.instans.vo.nickname?i="#ffff00":(i="#b98e42","#ff6600"),e.lbName.color=i,e.lbYuanBao.color=n,e.lbName.text=e.dataSource.name,e.lbYuanBao.text=l.TextConst.get(6,e.dataSource.gold)},e.prototype.distoryView=function(){null!=this.view&&(r.SoundUtils.getInstance().playBtnsounds(),this.view.closeHandler=null,this.view.destroy(!0),this.view=null,this.clearCtrlRes(),Laya.loader.clearRes("res/bg/gonghuihongbao_diban.png"))},e}(i.BaseCtrl);t.FRedPacketResultCtrl=h}),define("src/g/familyredpacket/ctrl/FRedpacketUsingCtrl",["require","exports","../../../core/E","../../../enum/EventName","../../../utils/ItemUtils","../../account/view/AccItem","../../guide/vo/RewardVo","../../../enum/enumItem","../../../utils/SoundUtils","../../base/BaseCtrl","../../../meta/QualiyVo","../../../enum/BagItemType"],function(e,t,i,n,s,a,o,r,l,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){function e(){var e=t.call(this)||this;return e.isOpend=!1,i.E.ins.on(n.EventName.USE_FAMILY__RED_PACKET,e,e.usingRedPacketHander),e}return __extends(e,t),e.prototype.usingRedPacketHander=function(e){e instanceof Array?this.crtPacketVo=this.checkRedPacket(e):this.crtPacketVo=e,this.isOpend=!0,null!=this.crtPacketVo&&this.open()},e.prototype.checkRedPacket=function(e){for(var t,i=0;i<e.length;i+=2)if((t=s.ItemUtils.getItemVoById(e[i])).type==c.BagItemType.gonghuiHongbao)return this.crtPacketCount=e[i+1],t;return null},e.prototype.onAtlasLoaded=function(){0!=this.isOpend?null==this.view&&(this.view=new ui.fmilyredpacket.FRedPacketUsingUI,this.updReward(),this.view.useButton.on(Laya.Event.CLICK,this,this.useRedPacket),this.view.closeHandler=new Laya.Handler(this,this.destoryView),this.showUI()):Laya.loader.clearRes(this.url)},e.prototype.updReward=function(){this.redPacket=new a.AccItem,this.redPacket.centerX=0,this.redPacket.y=94,this.view.addChild(this.redPacket);var e=new o.RewardVo;e.res=s.ItemUtils.getIconByIconId(this.crtPacketVo.icon),e.lv=this.crtPacketVo.uselimit,e.qualityNum=this.crtPacketVo.quality,e.quality=u.QualityStruct.Ins.getQColorById(this.crtPacketVo.quality),e.name=this.crtPacketVo.name,e.id=this.crtPacketVo.id,e.type=r.ItemType.ITEM,e.count=this.crtPacketCount,e.streamer=this.crtPacketVo.streamer,this.redPacket.eqData=e,this.redPacket.lv_txt.text="",this.view.lbPacketName.color=e.quality,this.view.lbPacketName.text=e.name,this.redPacket.countNum.text=""},e.prototype.showUI=function(){this.view.show()},e.prototype.useRedPacket=function(){this.view.close(),this.crtPacketVo?i.E.ins.event(n.EventName.SEND_FAMILY_RED_PACKET,this.crtPacketVo):console.error("红包错误不能发送")},e.prototype.destoryView=function(){if(this.isOpend=!1,null!=this.view){if(l.SoundUtils.getInstance().playBtnsounds(),this.view.closeHandler=null,this.view.useButton.off(Laya.Event.CLICK,this,this.useRedPacket),0<this.redPacket.ani_sp.numChildren&&this.redPacket.ani_sp.visible){var e=this.redPacket.ani_sp.getChildAt(0);e&&e.stop()}this.view.removeSelf(),this.view.destroy(),this.view=null,this.redPacket=null,Laya.loader.clearRes(this.url)}},e}(h.BaseCtrl);t.FRedpacketUsingCtrl=d}),define("src/g/familyredpacket/ctrl/FamilyRedPacketCtrl",["require","exports","src/g/familyredpacket/ctrl/FSendRedPacketCtrl","src/g/familyredpacket/ctrl/FRedPacketResultCtrl","src/g/familyredpacket/ctrl/FRedpacketUsingCtrl","../../../manager/GameSocketManager","../../index/ctrl/GameIndexCtrl","../../../core/E","../../../enum/EventName","../../fight/osprite/play/PlayManager","../../net/messages/ChangeSceneMsg","../../../manager/RoleCenter","../../net/messages/redbag/GetRedBag","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../../utils/SoundUtils","src/g/familyredpacket/vo/FRedPacketVo","../../net/messages/redbag/RedBagGS2C","../../net/messages/chat/ChatGS2C","../../net/messages/chat/ChatC2GS","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(){function t(){new i.FSendRedPacketCtrl,new n.FRedPacketResultCtrl,new s.FRedpacketUsingCtrl,(t.sInstance=this).packetList=[],null==o.GameIndexCtrl.idxView?r.E.ins.on(l.EventName.INDEX_VIEW_INIT_COMPLET,this,this.onIndexInit):this.initView(),r.E.ins.on(l.EventName.PLAY_TYPE_CHANGED,this,this.onPlayTypeChanged);var e=a.GSM.ins;e.on(y.RedBagGS2C.KEY,this,this.newRedPacketHander),e.on(d.GetRedBagGS2C.KEY,this,this.qiangRedPacketResult),r.E.ins.on("qiangHongBaoByLink",this,this.qiangHongBaoByLink)}return t.instance=function(){return t.sInstance},t.prototype.onIndexInit=function(){r.E.ins.off(l.EventName.INDEX_VIEW_INIT_COMPLET,this,this.onIndexInit),this.initView()},t.prototype.initView=function(){0<this.packetList.length&&(this.view=new ui.fmilyredpacket.FamilyRedPacketUI,this.view.on(Laya.Event.CLICK,this,this.qiangRedPacketHander),this.updViewDisplay(),this.updPacketNum())},t.prototype.updViewDisplay=function(){this.canDisplay()?o.GameIndexCtrl.idxView.bag_con.addChild(this.view):this.view.removeSelf()},t.prototype.canDisplay=function(){return null!=h.PlayManager.ins&&(h.PlayManager.type!=u.EPlayType.PLAYTYPE_MAINCITY||!c.RoleCenter.instans.vo.newbee)},t.prototype.updPacketNum=function(){if(this.view){var e=this.packetList.length;this.view.imgNum.value=e.toString(),0==e&&this.destoryView()}},t.prototype.onPlayTypeChanged=function(){null!=o.GameIndexCtrl.idxView&&0!=this.packetList.length&&this.updViewDisplay()},t.prototype.qiangRedPacketHander=function(){var e=this.packetList[0];e&&(m.SoundUtils.getInstance().playBtnsounds(),this.qiangHongBao(e.redId))},t.prototype.qiangHongBao=function(e){var t=new d.GetRedBagC2GS;t.redId=e,a.GSM.sendServer(t)},t.prototype.newRedPacketHander=function(e){this.packetList.push(this.convertVo(e)),this.view?this.updPacketNum():null!=o.GameIndexCtrl.idxView&&this.initView(),e.arr[0]==c.RoleCenter.instans.vo.nickname&&this.showInChat(e.redId,"@5@")},t.prototype.showInChat=function(e,t){var i=new v.ChatGS2C;i.type=_.enumChatType.family;var n=t+"#"+e;i.msg=n,r.E.ins.event(l.EventName.SEND_CHAT,[n,_.enumChatType.family])},t.prototype.convertVo=function(e){var t=new f.FRedPacketVo;return t.redId=e.redId,t.arr=e.arr.concat(),t},t.prototype.qiangRedPacketResult=function(e){var t=this.deletePacketById(e.redId);switch(null!=t&&this.updPacketNum(),e.code){case d.enumCodeType.ok:if(c.RoleCenter.instans.vo.GOLD+=e.count,null!=t){t.arr[0]!=c.RoleCenter.instans.vo.nickname&&this.showInChat(e.redId,"@6@");var i=this.createLog(e);r.E.ins.event(l.EventName.FAMILY_RED_PACKET_RESULT,[t,i])}break;case d.enumCodeType.end:g.FE.upItems(C.TextConst.get(375),p.BubbleEnum.center);break;case d.enumCodeType.over:g.FE.upItems(C.TextConst.get(376),p.BubbleEnum.center);break;case d.enumCodeType.readyGet:g.FE.upItems(C.TextConst.get(377),p.BubbleEnum.center);break;case d.enumCodeType.notFindRedid:g.FE.upItems(C.TextConst.get(378),p.BubbleEnum.center)}},t.prototype.deletePacketById=function(e){for(var t=0;t<this.packetList.length;t++)if(this.packetList[t].redId==e)return this.packetList.splice(t,1)[0];return null},t.prototype.destoryView=function(){this.view.off(Laya.Event.CLICK,this,this.qiangRedPacketHander),this.view.removeSelf(),this.view=null},t.prototype.createLog=function(e){for(var t,i=[],n=0;n<e.arr.length-1;n+=2)(t={}).name=e.arr[n],t.gold=e.arr[n+1],i.push(t);for(n=0;n<i.length;n++)if((t=i[n]).name==c.RoleCenter.instans.vo.nickname){var s=i.splice(n,1);i.unshift(s[0])}return i},t.prototype.qiangHongBaoByLink=function(e){var t=Number(e);this.qiangHongBao(t)},t}();t.FamilyRedPacketCtrl=w}),define("src/g/godcastnew/view/SuitTipDlg",["require","exports","../../../config/GameConfig"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.lv=0,e.view_bg.btn_back.visible=!1,e.list_.renderHandler=new Laya.Handler(e,e.renderHandler),e.view_bg.btn_close.on(Laya.Event.CLICK,e,e.close),e.view_bg.imgInnerBg.bottom=14,e}return __extends(e,t),e.prototype.initData=function(e){this.lv=e;var t=[];for(var i in n.GameConfig.blessSuit)0!=n.GameConfig.blessSuit[i].id&&t.push(n.GameConfig.blessSuit[i]);this.list_.dataSource=t},e.prototype.renderHandler=function(e,t){var i=e.dataSource;e.lab_name.text=i.blesssuit,e.lab_add.text="+"+(i.ATT_MULTI/100).toFixed(1)+"%",e.disabled=i.id>this.lv},e}(ui.role.GodCastN.suitTipDlgUI);t.SuitTipDlg=i}),define("src/g/godcastnew/view/NGodCastView",["require","exports","../../../manager/RoleCenter","../../../meta/BlessVo","../../../utils/ItemUtils","../../../meta/ShuXingVo","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../net/messages/EquipProChgC2GS","../../net/messages/OpResultType","../../../manager/GameSocketManager","../../itemGets/View/ItemGetDlg","../../../config/GameConfig","src/g/godcastnew/view/SuitTipDlg","../../net/messages/sbkFormula","../../clearRes/ClearResM","../../../init/TextConst"],function(e,t,i,u,l,c,r,n,s,a,o,h,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(t){function e(){var e=t.call(this)||this;return e.hero=null,e.user=null,e.nowSelectHero=0,e.equNameArr=["weapon","hat","clothes","torque","bracelet1","bracelet2","ring1","ring2"],e.nowItem=0,e.isMax=!1,e.baguaArr=[["0","0","1"],["1","0","0"],["0","1","0"],["1","1","0"],["1","0","1"],["1","0","1"],["0","0","0"],["1","1","1"]],e.needOk=!1,e.isUpState=!1,e.heroPos=0,e.min=0,e.aniShowNow=!1,m.ClearResM.addBgUrl(e.bgimg.skin),e.initView(),e.btn_cast.on(Laya.Event.CLICK,e,e.onClicked),e.item_cost.setJump(f.TextConst.get(238),new Laya.Handler(e,e.onGetItem)),e}return __extends(e,t),e.prototype.onGetItem=function(){var e=l.ItemUtils.getItemVoById(this.nowItem);(new h.ItemGetDlg).initByVo(e,null).popup()},e.prototype.onLoadUIEF=function(){this.ani_put=r.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.btn_cast,n.UIEffectsEnum.btn_001)},e.prototype.playUpLvAni=function(){this.btn_cast.mouseEnabled=!1;r.UIEffectsFactory.Ins.playAniOnce(69,this.upAni);Laya.timer.once(1e3,this,this.stopAni)},e.prototype.playUpStateAni=function(){this.btn_cast.mouseEnabled=!1;r.UIEffectsFactory.Ins.playAniOnce(n.UIEffectsEnum.shenzhuUpState,this.upAni);Laya.timer.once(1e3,this,this.stopAni)},e.prototype.stopAni=function(){this.btn_cast.mouseEnabled=!0,this.findMin()},e.prototype.onClicked=function(){var e;this.ani_put.visible?(this.btn_cast.label==f.TextConst.get(512)?((e=new s.EquipProChgC2GS).heroidx=this.heroPos,e.equpos=this.min+1,e.curLv=this.hero.blessSuitLv,e.msgidx=a.enumOpResultType.EquipProChg_shenzhu):((e=new s.EquipProChgC2GS).heroidx=this.heroPos,e.equpos=this.min+1,e.curLv=this.hero.blessSuitLv,e.msgidx=a.enumOpResultType.EquipProChg_shenzhuSuit),o.GSM.sendServer(e)):this.onGetItem()},e.prototype.initView=function(){for(var e=0;e<this.equNameArr.length;e++){var t=this["bagua_"+this.equNameArr[e]];t.init(this.baguaArr[e][0],this.baguaArr[e][1],this.baguaArr[e][2]),t.isShow(!1),this["bar_"+this.equNameArr[e]].isShow(!1);var i=this["qiu_"+this.equNameArr[e]];i.init(this.equNameArr[e]),i.setSelect(!1)}this.onLoadUIEF(),this.btn_suit.on(Laya.Event.CLICK,this,this.onOpenSuit)},e.prototype.tweenBall=function(e){var t=this,i=0,n=0,s=300,a=343;switch(e){case 0:i=300,n=333;break;case 1:i=310,n=333;break;case 2:i=310,n=343;break;case 3:i=310,n=353;break;case 4:i=300,n=353;break;case 5:i=290,n=353;break;case 6:i=290,n=343;break;case 7:i=290,n=333}Laya.Tween.to(this.ani_qiu,{x:i,y:n},500,Laya.Ease.backInOut,Laya.Handler.create(this,function(){Laya.Tween.to(t.ani_qiu,{x:s,y:a},300)}),0,!0)},e.prototype.onOpenSuit=function(){var e=new g.SuitTipDlg;e.initData(this.hero.blessSuitLv),e.popup()},e.prototype.renderView=function(){var e;this.btn_cast.mouseEnabled=!0;for(var t=0;t<this.equNameArr.length;t++){e=this.hero.getPos(t);var i=this["bagua_"+this.equNameArr[t]],n=this["bar_"+this.equNameArr[t]],s=this["qiu_"+this.equNameArr[t]],a=0<e.shenzhulv;i.isShow(a),n.isShow(a),s.setSelect(t==this.min),s.setOpen(a),this.setAniShow(t,a)}this.lab_suitLv.text=f.TextConst.get(513,this.hero.blessSuitLv),this.setNeed(this.min),this.setAttr(this.min),this.setFightNum()},e.prototype.setAniShow=function(e,t){var i=this["qiu_"+this.equNameArr[e]];t?null==i.ani.getChildByName("ani")&&r.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(i.ani,n.UIEffectsEnum.godcast):i.ani.removeChildren()},e.prototype.setBtnState=function(){var e;e=this.hero.getPos(1),0==this.min&&0!=e.shenzhulv?(this.isMax=!d.GameConfig.blessSuit[this.hero.blessSuitLv+1],this.btn_cast.label=f.TextConst.get(514)):(this.isMax=!1,this.btn_cast.label=f.TextConst.get(512))},e.prototype.setNeed=function(e){var t;t=this.hero.getPos(e),this.setBtnState(),this.btn_cast.label==f.TextConst.get(514)?(this.isUpState=!0,this.lab_upDesc.text=f.TextConst.get(515)):(this.isUpState=!1,this.lab_upDesc.text=f.TextConst.get(516)),this.isMax?(this.lab_upDesc.visible=!1,this.lab_man.visible=!0,this.box_img.visible=!1,this.box_attr0.visible=!1,this.box_attr1.visible=!1):(this.lab_upDesc.visible=!0,this.lab_man.visible=!1,this.box_img.visible=!0,this.box_attr0.visible=!0,this.box_attr1.visible=!0);var i=0,n=0;if(this.isUpState)if(this.isMax)this.btn_cast.disabled=!0,this.item_cost.visible=!1,this.ani_put.visible=!1,this.btn_cast.label=f.TextConst.get(208);else{var s=d.GameConfig.blessSuit[this.hero.blessSuitLv];i=parseInt(s.stageItem[0][0]),n=s.stageItem[0][1];var a=l.ItemUtils.getItemVoById(i);this.item_cost.setNeedName(a.name,l.ItemUtils.getSmallIcon(a.icon)),this.item_cost.setQualColor(l.ItemUtils.getColorByQuality(a.quality)),this.item_cost.visible=!0,this.nowItem=i,this.btn_cast.disabled=!1}else{var o=u.BlessStruct.Ins.getVo(t.equpos,this.hero.blessSuitLv);i=parseInt(o.cost[0][0]);a=l.ItemUtils.getItemVoById(i);this.item_cost.setNeedName(a.name,l.ItemUtils.getSmallIcon(a.icon)),this.item_cost.setQualColor(l.ItemUtils.getColorByQuality(a.quality)),this.item_cost.visible=!0,n=o.cost[0][1],this.nowItem=i,this.btn_cast.disabled=!1}var r=this.user.bagdata.getItemCount(i);n<=r&&!this.btn_cast.disabled||n<=r&&this.isUpState?this.ani_put.visible=!this.isMax:this.ani_put.visible=!1,this.needOk=n<=r,this.item_cost.setNeed(r,n)},e.prototype.setAttr=function(e){this.box_attr0.removeChildren(),this.box_attr1.removeChildren(),this.box_img.removeChildren();var t=u.BlessStruct.Ins.getVo(e+1,this.hero.blessSuitLv),i=u.BlessStruct.Ins.getVo(e+1,this.hero.blessSuitLv-1);if(this.btn_cast.label==f.TextConst.get(514)){var n=d.GameConfig.blessSuit[this.hero.blessSuitLv],s=d.GameConfig.blessSuit[this.hero.blessSuitLv+1],a=new Laya.Box,o=c.ShuXingVo.createSXBox(f.TextConst.get(893,(n.ATT_MULTI/100).toFixed(1)),-1),r=c.ShuXingVo.createSXBox(f.TextConst.get(893,(s.ATT_MULTI/100).toFixed(1)),-1);return(h=new Laya.Image("res/custom/duanzao_shuxingjiantou.png")).width=31,h.height=20,a.addChild(h),a.height=o.height,this.box_attr0.addChild(o),this.box_img.addChild(a),void this.box_attr1.addChild(r)}for(var l=0;l<t.prop.length;l++){var h;o=void 0,r=void 0,a=new Laya.Box;r=i?this.isMax?(o=c.ShuXingVo.createSXBox(t.prop[l][0],t.prop[l][1]),c.ShuXingVo.createSXBox(f.TextConst.get(208),-1)):(o=c.ShuXingVo.createSXBox(i.prop[l][0],i.prop[l][1]),c.ShuXingVo.createSXBox(t.prop[l][0],t.prop[l][1])):(o=c.ShuXingVo.createSXBox(t.prop[l][0],0),c.ShuXingVo.createSXBox(t.prop[l][0],t.prop[l][1])),(h=new Laya.Image("res/custom/duanzao_shuxingjiantou.png")).width=31,h.height=20,a.addChild(h),a.height=o.height,this.box_attr0.addChild(o),this.box_img.addChild(a),this.box_attr1.addChild(r)}},e.prototype.setFightNum=function(){for(var e=this.hero.power_shenzhu,t=0;t<this.hero.equpos.length;t++){var i=this.hero.equpos[t];e+=p.sbkFormula.calPropFightMainCombat(i.shenzhuPro)}this.fight_num.setFightNum(e)},e.prototype.refreshData=function(e){this.heroPos=e,this.user=i.RoleCenter.instans.vo,this.hero=this.user.getOpenHeroByIdx(e),this.aniShowNow||this.findMin(),this.bgimg.restskin()},e.prototype.findMin=function(){for(var e=this.min=0;e<this.equNameArr.length;e++)if(0==this.hero.getPos(e).shenzhulv){this.min=e;break}this.aniShowNow=!1,this.renderView()},e.prototype.showAni=function(e){var t=this;this.tweenBall(e),this.btn_cast.mouseEnabled=!1,this.aniShowNow=!0,this.hero.getPos(e);var i=this["bagua_"+this.equNameArr[e]],n=this["bar_"+this.equNameArr[e]],s=this["qiu_"+this.equNameArr[e]],a=Laya.Handler.create(this,function(){s.setSelect(!0),t.findMin()});Laya.timer.once(500,this,function(e){r.UIEffectsFactory.Ins.playAniOnce(69,e)},[s]);var o=Laya.Handler.create(this,function(){n.showTween(a)});i.showTween(Laya.Handler.create(this,function(){o.run()}))},e}(ui.role.GodCastN.NGodCastViewUI);t.NGodCastView=y}),define("src/g/godcastnew/view/NGodCastDlg",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.addPage=function(e){return this.bg_view.box_page.addChild(e),e},t}(ui.role.GodCastN.NGodCastDlgUI);t.NGodCastDlg=i}),define("src/g/godcastnew/ctrl/NGodCastCtrl",["require","exports","../../base/BaseCtrl","../../../core/E","../../../enum/EventName","../../../manager/LayerManager","src/g/godcastnew/view/NGodCastView","../../../vo/RedDot/EventRedDot","../../../vo/RedDot/role/RedDot_GodCast","../../../manager/RoleCenter","../../net/messages/OpResultType","../../../meta/BlessVo","../../../plugin/sbkPropTool","../../../config/GameConfig","../../accessctrl/AccessCenter","../../../init/Switches","src/g/godcastnew/view/NGodCastDlg"],function(e,t,i,o,r,n,s,a,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(t){function e(){var e=t.call(this)||this;return e._nowSelectHero=0,e._hidx=0,e.urls=["res/atlas/res/role/godcastn.json"],m.Switches.ins.on(p.enumAccessId.shenzhu,e,e.onOpenHandler),o.E.ins.on(r.EventName.CHANGEITEM_COUNT,e,e.onChangeItem),o.E.ins.on(a.EventRedDot.REFRESH_GODCAST,e,e.refreshHeadShow),e}return __extends(e,t),e.prototype.onOpenHandler=function(e,t,i,n){void 0===n&&(n=0),e&&this.openGodCast(!0,!1,n)},e.prototype.onChangeItem=function(e){107!=e&&504!=e||this.refreshData()},e.prototype.init=function(){this._viewdlg=new f.NGodCastDlg,this._view=new s.NGodCastView,this._viewdlg.addPage(this._view),this._viewdlg.bg_view.btn_back.on(Laya.Event.CLICK,this,this.pnCloseView),this._viewdlg.bg_view.btn_close.on(Laya.Event.CLICK,this,this.pnCloseView),this._view.tab_head.setCallbackHandler(new Laya.Handler(this,this.onHeadSelectHandler)),this.refreshHeadShow(),h.RoleCenter.instans.vo.heronum<3&&(o.E.ins.on(r.EventName.ADDED_LEVEL,this,this.refreshHeadShow),o.E.ins.on(r.EventName.ADDED_ZHUANSHENG,this,this.refreshHeadShow),o.E.ins.on(r.EventName.VIP_EXP_CHANGED,this,this.refreshHeadShow),o.E.ins.on(r.EventName.OPENNEW_HERO,this,this.refreshData)),h.RoleCenter.instans.on(u.enumOpResultType.EquipProChg_shenzhu+"",this,this.onShenZhu),h.RoleCenter.instans.on(u.enumOpResultType.EquipProChg_shenzhuSuit+"",this,this.onUpState)},e.prototype.refreshHeadShow=function(){this._view&&(this._view.tab_head.initData(h.RoleCenter.instans.self.openhero,this._nowSelectHero,h.RoleCenter.instans.vo),this._view.tab_head.refreshHeadRedHint(l.RedDot_GodCast.Ins.getGodCast(!0)))},e.prototype.refreshData=function(){this._view&&(this.refreshHeadShow(),this._view.tab_head.refreshHeadRedHint(l.RedDot_GodCast.Ins.getGodCast(!0)),this._view.refreshData(this._nowSelectHero))},e.prototype.onUpState=function(e){for(var t=h.RoleCenter.instans.vo,i=t.getOpenHeroByIdx(e.reservedata[0]),n=g.GameConfig.blessSuit[i.blessSuitLv],s=0;s<8;s++){i.getPos(s).shenzhulv=0}i.blessSuitLv=e.reservedata[1],this._view.playUpStateAni(),t.chgItemCount(n.stageItem[0][0],0-n.stageItem[0][1]);var a=t.combat;d.sbkPropTool.reSetAllEquip(i),t.reCheckComBat(),a<t.combat&&h.RoleCenter.instans.event(r.EventName.FIGHT_UP,t.combat-a),this._view.tab_head.refreshHeadRedHint(l.RedDot_GodCast.Ins.getGodCast(!0)),o.E.ins.event(r.EventName.GODCAST_UPSUITLV)},e.prototype.onShenZhu=function(e){var t=h.RoleCenter.instans.vo,i=t.getOpenHeroByIdx(e.reservedata[0]),n=i.getPos(e.reservedata[1]-1);n.shenzhulv=1;var s=c.BlessStruct.Ins.getVo(n.equpos,i.blessSuitLv),a=parseInt(s.cost[0][0]);this._view.showAni(n.equpos-1),this._view.playUpLvAni(),t.chgItemCount(a,0-s.cost[0][1]);var o=t.combat;d.sbkPropTool.reSetAllEquip(i),t.reCheckComBat(),h.RoleCenter.instans.event(r.EventName.FIGHT_UP,t.combat-o),this._view.tab_head.refreshHeadRedHint(l.RedDot_GodCast.Ins.getGodCast(!0))},e.prototype.onHeadSelectHandler=function(e,t){h.RoleCenter.instans.vo.getOpenHeroByIdx(e)?(this._nowSelectHero=e,this._view.tab_head.setSelectIndex(e),this._view.refreshData(this._nowSelectHero)):m.Switches.ins.event(p.enumAccessId.partner)},e.prototype.openGodCast=function(e,t,i){void 0===e&&(e=!1),void 0===t&&(t=!0),void 0===i&&(i=0),this._hidx=i,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenRoleView()},e.prototype.realOpenRoleView=function(){var e=this._hidx;this._view||this.init(),this._nowSelectHero=e,this._view.tab_head.setSelectIndex(e),this.showView(),this._view.tab_head.refreshHeadRedHint(l.RedDot_GodCast.Ins.getGodCast(!0))},e.prototype.showView=function(){this._view.refreshData(this._nowSelectHero),n.LayerManager.addInPOPWindowLayer(this._viewdlg,!1)},e.prototype.pnCloseView=function(){this._viewdlg.removeSelf(),o.E.ins.event(r.EventName.CLOSEVIEW_GODCAST)},e}(i.BaseCtrl);t.NGodCastCtrl=y}),define("src/g/guild/view/storage/GuildStorageMainView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(ui.guild.storage.GuildStorageUI);t.GuildStorageMainView=i}),define("src/g/guild/ctrl/storage/GuildStorageData",["require","exports","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg","../../../../component/NumberEventDispatcher","../../../../utils/system/FloatEffect","../../../../core/E","../../../../enum/EventName","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){function s(){var e=t.call(this)||this;return e.autoDelLevel=0,e.autoDelSetRequested=!1,i.GSM.ins.on(n.FamilyXWHouseDataGS2C.KEY,e,e.onGetStorageData),i.GSM.ins.on(n.FamilyXWHouseLogGS2C.KEY,e,e.onGetStorageLogData),i.GSM.ins.on(n.FamilyXWHouseDelEquipGS2C.KEY,e,e.onDelEquip),i.GSM.ins.on(n.FamilyXWHouseAddEquipGS2C.KEY,e,e.onAddEquip),i.GSM.ins.on(n.FamilyXWHouseAutoDelMSG.KEY,e,e.onAutoDelSetting),o.E.ins.on(r.EventName.SOCIETY_LEAVE,e,e.onGuildLeaveHandler),e}return __extends(s,t),s.prototype.onGuildLeaveHandler=function(){this.storageData=null,this.event(s.STORAGE_DATA_CHANGED)},Object.defineProperty(s,"ins",{get:function(){return s._ins||(s._ins=new s),s._ins},enumerable:!0,configurable:!0}),s.prototype.onGetStorageData=function(e){this.storageData||(this.storageData=new n.FamilyXWHouseDataGS2C),this.storageData.copydata(e),this.event(s.STORAGE_DATA_CHANGED)},s.prototype.onGetStorageLogData=function(e){this.logData=e,this.event(s.STORAGE_DATA_LOG_CHANGED)},s.prototype.onDelEquip=function(e){if(this.storageData&&0<this.storageData.equipArr.length){for(var t=e.equipIdArr.length,i=0,n=0;i<t;)this.storageData.delEquip(e.equipIdArr[i])&&n++,i++;0<n&&this.event(s.STORAGE_DATA_CHANGED)}},s.prototype.onAddEquip=function(e){if(this.storageData){for(var t=e.equipArr.length,i=0;i<t;)this.storageData.addEquip(e.equipArr[i]),i++;0<t&&this.event(s.STORAGE_DATA_CHANGED)}},s.prototype.checkInitAutoDelSetting=function(){if(!this.autoDelSetRequested){var e=new n.FamilyXWHouseAutoDelMSG;e.type=1,i.GSM.sendServer(e)}},s.prototype.onAutoDelSetting=function(e){this.autoDelSetRequested=!0,this.autoDelLevel=e.autoDelLv,2==e.type&&a.FE.upItems(l.TextConst.get(1061)),this.event(s.STORAGE_AUTO_DEL_SETTING_CHANGED)},s.STORAGE_DATA_CHANGED=1,s.STORAGE_DATA_LOG_CHANGED=2,s.STORAGE_AUTO_DEL_SETTING_CHANGED=3,s}(s.NumberEventDispatcher);t.GuildStorageData=h}),define("src/g/guild/view/storage/GuildStorageAutoDelSetDlg",["require","exports","src/g/guild/ctrl/storage/GuildStorageData","../../../net/messages/ManageFamilyMsg","../../../../manager/GameSocketManager","../../../../utils/system/FloatEffect","../../../../config/GameConfig","../../../../init/TextConst"],function(e,t,n,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;e.bg.btn_close.on(Laya.Event.CLICK,e,e.close),e.btn_cancal.on(Laya.Event.CLICK,e,e.close),e.btn_enter.on(Laya.Event.CLICK,e,e.requestHandler);var t=r.GameConfig.xwZ7z8.xwSuit.value.split(",");return e.combobox_classfiy.labels=t.slice(4).join(","),e}return __extends(e,i),e.prototype.onOpened=function(){var e=n.GuildStorageData.ins.autoDelLevel;0<e?(this.checkbox_autoselect.selected=!0,this.combobox_classfiy.selectedIndex=e-5):this.checkbox_autoselect.selected=!1},e.prototype.requestHandler=function(){var e=0;if(this.checkbox_autoselect.selected&&(e=this.combobox_classfiy.selectedIndex+5),e!=n.GuildStorageData.ins.autoDelLevel){var t=new s.FamilyXWHouseAutoDelMSG;t.type=2,t.autoDelLv=e,a.GSM.sendServer(t)}else o.FE.upItems(l.TextConst.get(1061));this.close()},e}(ui.guild.storage.GuildStorageAutoDelSetDlgUI);t.GuildStorageAutoDelSetDlg=i}),define("src/g/guild/view/storage/GuildStorageDestroyDlg",["require","exports","src/g/guild/ctrl/storage/GuildStorageData","../../../../config/GameConfig","../../../../utils/ItemUtils","../../../../utils/ItemCellUtils","../../../net/messages/ManageFamilyMsg","../../../../manager/GameSocketManager","src/g/guild/view/storage/GuildStorageAutoDelSetDlg"],function(e,t,s,a,o,n,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;e.selectIds={},e.level=0;var t=a.GameConfig.xwZ7z8.xwSuit.value.split(",");return e.combobox_classfiy.labels=t.slice(4).join(","),e.combobox_classfiy.selectHandler=new Laya.Handler(e,e.onFilterSelected),e.checkbox_autoselect.on(Laya.Event.CLICK,e,e.onSwitchAutoSelect),e.list_item.renderHandler=new Laya.Handler(e,e.onRenderHandler),e.list_item.mouseHandler=new Laya.Handler(e,e.onMouseHandler),e.btn_destroy.on(Laya.Event.CLICK,e,e.doDestroyHandler),e.btn_setting.on(Laya.Event.CLICK,e,e.openSettingPanel),e.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,i),e.prototype.onRenderHandler=function(e,t){var i=e.dataSource;n.ItemCellUtils.fillCellForItemNameView(e.item,i.equtemplet,1),e.img_selected.visible=0<this.selectIds[i.equid]},e.prototype.onMouseHandler=function(e,t){if(e.type==Laya.Event.MOUSE_UP){var i=this.list_item.array[t],n=-1;this.selectedEquipIdArr&&(n=this.selectedEquipIdArr.indexOf(i.equid)),-1==n?(this.selectedEquipIdArr||(this.selectedEquipIdArr=[]),this.selectedEquipIdArr.push(i.equid),this.selectIds[i.equid]=1):(this.selectedEquipIdArr.splice(n,1),delete this.selectIds[i.equid]),this.list_item.refresh()}},e.prototype.onSwitchAutoSelect=function(){if(this.checkbox_autoselect.selected){var e,t,i=this.list_item.array?this.list_item.array.length:0,n=0;for(this.selectedEquipIdArr=[],this.selectIds={};n<i;)e=this.list_item.array[n],(t=o.ItemUtils.getXwEquipVoById(e.equtemplet))&&t.level<=this.level&&(this.selectedEquipIdArr.push(e.equid),this.selectIds[e.equid]=1),n++}else this.selectedEquipIdArr=null,this.selectIds={};this.list_item.refresh()},e.prototype.onFilterSelected=function(e){this.level=e+5,this.checkbox_autoselect.selected&&this.onSwitchAutoSelect()},e.prototype.showPage=function(){this.checkbox_autoselect.selected=!1,this.combobox_classfiy.selectedIndex=0,this.updateShow(),s.GuildStorageData.ins.on(s.GuildStorageData.STORAGE_DATA_CHANGED,this,this.updateShow),s.GuildStorageData.ins.checkInitAutoDelSetting()},e.prototype.onClosed=function(){s.GuildStorageData.ins.off(s.GuildStorageData.STORAGE_DATA_CHANGED,this,this.updateShow)},e.prototype.updateShow=function(){this.selectedEquipIdArr=null,this.selectIds={};var e=0;if(s.GuildStorageData.ins.storageData){var t=s.GuildStorageData.ins.storageData.equipArr;e=t.length}var i=0,n=a.GameConfig.commonJson.warehouseCeil;n&&(i=Number(n.value)),this.lab_capacuty.changeText(e+"/"+i),this.list_item.array=t},e.prototype.doDestroyHandler=function(){if(this.selectedEquipIdArr&&0<this.selectedEquipIdArr.length){var e=new r.UserFamilyXWHouseEquipC2GS;e.type=3,e.equipIdArr=this.selectedEquipIdArr,l.GSM.sendServer(e)}},e.prototype.openSettingPanel=function(){this._autoDelSetDlg||(this._autoDelSetDlg=new h.GuildStorageAutoDelSetDlg),this._autoDelSetDlg.isPopup||this._autoDelSetDlg.popup()},e}(ui.guild.storage.GuildStorageEquipDestroyUI);t.GuildStorageDestroyDlg=i}),define("src/g/guild/view/storage/GuildStorageDonateDlg",["require","exports","../../../../core/E","../../../../enum/EventName","src/g/guild/ctrl/storage/GuildStorageData","../../../../manager/RoleCenter","../../../../config/GameConfig","../../../../utils/ItemUtils","../../../../utils/ItemCellUtils","../../../net/messages/ManageFamilyMsg","../../../../manager/GameSocketManager","../../../xingwang/view/XwTips_Eq","../../../../utils/system/FloatEffect","../../../../init/TextConst"],function(e,t,i,n,s,o,a,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e._currScore=-1,e.list_item.renderHandler=new Laya.Handler(e,e.onRenderHandler),e.list_item.mouseHandler=new Laya.Handler(e,e.onMouseHandler),e.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,t),e.prototype.onRenderHandler=function(e,t){var i=e.dataSource;l.ItemCellUtils.fillCellForItemNameView(e.item,i.equtemplet,1)},e.prototype.onMouseHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i=this.list_item.array[t];if(this.checkbox_donate.selected)this.donate(i);else if(r.ItemUtils.getXwEquipVoById(i.equtemplet)){var n=new c.XwTips_Eq;n.box_tz.removeSelf(),n.initData(!1,null,i,"捐献",new Laya.Handler(this,this.donate)),n.popup()}}},e.prototype.donate=function(e){var t=new h.UserFamilyXWHouseEquipC2GS;t.type=1,t.equipIdArr=[e.equid],u.GSM.sendServer(t)},e.prototype.showPage=function(){this.checkbox_donate.selected=!1,this._currScore=-1,this.updateScore(),this.updateShow(),this.updateBagEquipShow(),s.GuildStorageData.ins.on(s.GuildStorageData.STORAGE_DATA_CHANGED,this,this.updateShow),i.E.ins.on(n.EventName.USER_DATA_ATTR_CHANGED+"FAMILYCOIN",this,this.updateScore),i.E.ins.on(n.EventName.UPDATE_BAG,this,this.updateBagEquipShow)},e.prototype.onClosed=function(){s.GuildStorageData.ins.off(s.GuildStorageData.STORAGE_DATA_CHANGED,this,this.updateShow),i.E.ins.off(n.EventName.USER_DATA_ATTR_CHANGED+"FAMILYCOIN",this,this.updateScore),i.E.ins.off(n.EventName.UPDATE_BAG,this,this.updateBagEquipShow)},e.prototype.updateShow=function(){var e=0;s.GuildStorageData.ins.storageData&&(e=s.GuildStorageData.ins.storageData.equipArr.length);var t=0,i=a.GameConfig.commonJson.warehouseCeil;i&&(t=Number(i.value)),this.lab_capacuty.changeText(e+"/"+t)},e.prototype.updateScore=function(){var e=Number(o.RoleCenter.instans.vo.getAttr("FAMILYCOIN"));if(-1<this._currScore){var t=e-this._currScore;0<t&&d.FE.upItems(g.TextConst.get(1063,t))}this._currScore=e,this.lab_myScore.changeText(e.toString())},e.prototype.updateBagEquipShow=function(){for(var e,t=o.RoleCenter.instans.vo.bagdata.equBagData,i=t?t.length:0,n=0,s=[];n<i;){if(6e4<(e=t[n]).equtemplet&&e.equtemplet<7e4){var a=r.ItemUtils.getXwEquipVoById(e.equtemplet);a&&4<a.level&&s.push(e)}n++}this.list_item.array=s},e}(ui.guild.storage.GuildStorageDonateUI);t.GuildStorageDonateDlg=p}),define("src/g/guild/view/storage/GuildStoragePage",["require","exports","../../../../config/GameConfig","src/g/guild/ctrl/storage/GuildStorageData","../../../../core/E","../../../../enum/EventName","../../../../manager/RoleCenter","../../../../utils/ItemUtils","../../../../utils/ItemCellUtils","../../../net/messages/ManageFamilyMsg","../../../../manager/GameSocketManager","src/g/guild/view/storage/GuildStorageDestroyDlg","src/g/guild/view/storage/GuildStorageDonateDlg","../../../../utils/RoleUtil","../../../xingwang/view/XwTips_Eq","../../../../utils/system/FloatEffect","../../../../init/TextConst"],function(e,t,r,l,n,s,u,c,a,o,h,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;e._currFilterIndex=0;var t=r.GameConfig.xwZ7z8.xwPosName;return e.comobox_classify.labels="全部,"+t.value,e.comobox_classify.visibleNum=10,e.comobox_classify.selectHandler=new Laya.Handler(e,e.onFilterSelected),e.comobox_classify.selectedIndex=0,e.list_item.renderHandler=new Laya.Handler(e,e.onRenderHandler),e.list_item.mouseHandler=new Laya.Handler(e,e.onMouseHandler),e.btn_destroy.on(Laya.Event.CLICK,e,e.openDestroyPanel),e.btn_donate.on(Laya.Event.CLICK,e,e.openDonatePanel),e}return __extends(e,i),e.prototype.initXwEquipCombat=function(){this.xwPos2Combat={};for(var e=u.RoleCenter.instans.vo,t=0;t<e.heronum;t++)for(var i=e.getOpenHeroByIdx(t).rxData.equipArr,n=0;n<i.length;n++)for(var s=i[n].xwData.equipArr,a=0;a<s.length;a++){var o=s[a],r=o.equins[0];if(r){var l=c.ItemUtils.getXwEquipVoById(r.equtemplet),h=p.RoleUtil.calFightByProp(l.prop)+r.getSpecialPropCombat();0<this.xwPos2Combat[o.equpos]?h<this.xwPos2Combat[o.equpos]&&(this.xwPos2Combat[o.equpos]=h):this.xwPos2Combat[o.equpos]=h}}},e.prototype.onRenderHandler=function(e,t){var i=e.dataSource;a.ItemCellUtils.fillCellForItemNameView(e.item,i.equtemplet,1);var n=c.ItemUtils.getXwEquipVoById(i.equtemplet),s=p.RoleUtil.calFightByProp(n.prop)+i.getSpecialPropCombat();e.img_up.visible=s>this.xwPos2Combat[n.pos]},e.prototype.onMouseHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i=this.list_item.array[t];if(i)if(this.checkbox_exchange.selected)this.exchange(i);else if(c.ItemUtils.getXwEquipVoById(i.equtemplet)){var n=new m.XwTips_Eq;n.box_tz.removeSelf(),n.initData(!1,null,i,"兑换",new Laya.Handler(this,this.exchange)),n.popup()}}},e.prototype.exchange=function(e){var t=c.ItemUtils.getXwEquipVoById(e.equtemplet),i=0;if(t&&0<t.split2.length&&(i=t.split2[0][1]),i<=Number(u.RoleCenter.instans.vo.getAttr("FAMILYCOIN"))){var n=new o.UserFamilyXWHouseEquipC2GS;n.type=2,n.equipIdArr=[e.equid],h.GSM.sendServer(n)}else f.FE.upItems(y.TextConst.get(1064))},e.prototype.onFilterSelected=function(e){this._currFilterIndex=e,this.updateShow()},e.prototype.showPage=function(){this.checkbox_exchange.selected=!1;var e=u.RoleCenter.instans.ufVo._ufdata;e&&e.familyPosition==o.EFPosition.CHAIRMAN?this.btn_destroy.visible=!0:this.btn_destroy.visible=!1,this.initXwEquipCombat(),this.updateScore(),this.updateShow(),l.GuildStorageData.ins.on(l.GuildStorageData.STORAGE_DATA_CHANGED,this,this.updateShow),n.E.ins.on(s.EventName.USER_DATA_ATTR_CHANGED+"FAMILYCOIN",this,this.updateScore)},e.prototype.hidePage=function(){l.GuildStorageData.ins.off(l.GuildStorageData.STORAGE_DATA_CHANGED,this,this.updateShow),n.E.ins.off(s.EventName.USER_DATA_ATTR_CHANGED+"FAMILYCOIN",this,this.updateScore)},e.prototype.updateShow=function(){var e=0;if(l.GuildStorageData.ins.storageData){var t=l.GuildStorageData.ins.storageData.equipArr;e=t.length}var i=0,n=r.GameConfig.commonJson.warehouseCeil;if(n&&(i=Number(n.value)),this.lab_capacuty.changeText(e+"/"+i),0<this._currFilterIndex){for(var s=[],a=0;a<e;){var o=c.ItemUtils.getXwEquipVoById(t[a].equtemplet);o&&o.pos==this._currFilterIndex&&s.push(t[a]),a++}this.list_item.array=s}else this.list_item.array=t},e.prototype.updateScore=function(){this.lab_myScore.changeText(u.RoleCenter.instans.vo.getAttr("FAMILYCOIN")+"")},e.prototype.openDestroyPanel=function(){this._destroyDlg||(this._destroyDlg=new d.GuildStorageDestroyDlg),this._destroyDlg.showPage(),this._destroyDlg.isPopup||this._destroyDlg.popup()},e.prototype.openDonatePanel=function(){this._donateDlg||(this._donateDlg=new g.GuildStorageDonateDlg),this._donateDlg.showPage(),this._donateDlg.isPopup||this._donateDlg.popup()},e}(ui.guild.storage.GuildStoragePageUI);t.GuildStoragePage=i}),define("src/g/guild/ctrl/storage/GuildStoragePageCtrl",["require","exports","../../../clearRes/ClearResM","src/g/guild/view/storage/GuildStoragePage","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg","src/g/guild/ctrl/storage/GuildStorageData"],function(e,t,i,n,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.init=function(){},e.prototype.showPage=function(e,t){e&&(e.removeChildren(),o.GuildStorageData.ins.storageData||s.GSM.sendServer(new a.FamilyXWHouseDataC2GS),this._view||(this._view=new n.GuildStoragePage),this._view.showPage(),e.addChild(this._view),i.ClearResM.resetViewImg(this._view))},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(e,t){},e.prototype.refreshData=function(){},e.prototype.getTitle=function(){return"res/title/hhck_biaoti_001.png"},e.prototype.hidePage=function(){this._view&&this._view.hidePage()},e.prototype.destroyPage=function(){},e}();t.GuildStoragePageCtrl=r}),define("src/g/guild/view/storage/GuildStorageLogPage",["require","exports","src/g/guild/ctrl/storage/GuildStorageData","../../../../utils/system/DateUitl","../../../../utils/ItemUtils","../../../../init/TextConst"],function(e,t,i,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.list_log.renderHandler=new Laya.Handler(e,e.onlistRenderHandler),e}return __extends(e,t),e.prototype.onlistRenderHandler=function(e,t){var i=e.dataSource;e.lab_time.changeText(h.DateUtil.getYTD_hms(1e3*i.time,"y-t-d h:m:s"));var n="",s=u.ItemUtils.getFamilyOrderById(i.familyPosition);s&&(n=s.name);var a,o="#ff0000",r="",l=0;e.htxt_contect.style.font="SimHei",e.htxt_contect.style.fontSize=20,e.htxt_contect.style.color="#ceb394",1==i.type?((a=u.ItemUtils.getXwEquipVoById(i.cfgId))&&(o=u.ItemUtils.getColorByQuality(a.quality),r=a.name,0<a.split2.length&&(l=a.split2[0][1])),e.htxt_contect.innerHTML=c.TextConst.get(1058,n,i.nickname,o,r,l)):2==i.type?((a=u.ItemUtils.getXwEquipVoById(i.cfgId))&&(o=u.ItemUtils.getColorByQuality(a.quality),r=a.name,0<a.split2.length&&(l=a.split2[0][1])),e.htxt_contect.innerHTML=c.TextConst.get(1059,n,i.nickname,l,o,r)):3==i.type&&(e.htxt_contect.innerHTML=c.TextConst.get(1060,n,i.nickname))},e.prototype.showPage=function(){this.updateShow(),i.GuildStorageData.ins.on(i.GuildStorageData.STORAGE_DATA_LOG_CHANGED,this,this.updateShow)},e.prototype.hidePage=function(){i.GuildStorageData.ins.off(i.GuildStorageData.STORAGE_DATA_LOG_CHANGED,this,this.updateShow)},e.prototype.updateShow=function(){i.GuildStorageData.ins.logData?this.list_log.array=i.GuildStorageData.ins.logData.logArr:this.list_log.array=null},e}(ui.guild.storage.GuildStorageLogPageUI);t.GuildStorageLogPage=n}),define("src/g/guild/ctrl/storage/GuildStorageLogPageCtrl",["require","exports","../../../clearRes/ClearResM","src/g/guild/view/storage/GuildStorageLogPage","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.init=function(){throw new Error("Method not implemented.")},e.prototype.showPage=function(e,t){e&&(e.removeChildren(),s.GSM.sendServer(new a.FamilyXWHouseLogC2GS),this._view||(this._view=new n.GuildStorageLogPage),this._view.showPage(),e.addChild(this._view),i.ClearResM.resetViewImg(this._view))},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(e,t){},e.prototype.refreshData=function(){},e.prototype.getTitle=function(){return"res/title/hhck_biaoti_003.png"},e.prototype.hidePage=function(){this._view&&this._view.hidePage()},e.prototype.destroyPage=function(){},e}();t.GuildStorageLogPageCtrl=o}),define("src/g/guild/ctrl/GuildStorageMainViewCtrl",["require","exports","../../accessctrl/AccessCenter","src/g/guild/view/storage/GuildStorageMainView","../../../manager/LayerManager","../../clearRes/ClearResM","../../../utils/SoundUtils","src/g/guild/ctrl/storage/GuildStoragePageCtrl","src/g/guild/ctrl/storage/GuildStorageLogPageCtrl","../../../init/Switches"],function(e,t,i,n,s,a,o,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){h.Switches.ins.on(i.enumAccessId.guildStorage,this,this.onOpenHandler,[i.enumAccessId.guildStorage])}return e.prototype.onOpenHandler=function(e,t){t&&(this._view||(this._view=new n.GuildStorageMainView,this._view.bg.btn_close.on(Laya.Event.CLICK,this,this.closeHander,[!0]),this._view.bg.btn_back.on(Laya.Event.CLICK,this,this.closeHander,[!0]),this._view.btnbar.selectHandler=new Laya.Handler(this,this.onSelectTabHandler)),s.LayerManager.addInPOPWindowLayer(this._view),a.ClearResM.resetViewImg(this._view),0==this._view.btnbar.selectedIndex?this.onSelectTabHandler(0):this._view.btnbar.selectedIndex=0)},e.prototype.onSelectTabHandler=function(e){switch(this._view.bg.box_page.removeChildren(),this._selectPage&&this._selectPage.hidePage(),e){case 0:this._storage||(this._storage=new r.GuildStoragePageCtrl),this._selectPage=this._storage;break;case 1:this._storageLog||(this._storageLog=new l.GuildStorageLogPageCtrl),this._selectPage=this._storageLog}this._selectPage&&(this._selectPage.showPage(this._view.bg.box_page),this._view.bg.img_title.skin=this._selectPage.getTitle())},e.prototype.closeHander=function(e){e&&o.SoundUtils.getInstance().playBtnsounds(),this._view&&this._view.removeSelf()},e}();t.GuildStorageMainViewCtrl=u}),define("src/g/guild/view/attackCity/pages/GuildRankRewardPage",["require","exports","../../../../../config/GameConfig","../../../../../utils/ItemCellUtils","../../../../bag/tips/view/ItemTips","../../../../clearRes/ClearResM","../../../../../init/TextConst"],function(e,t,o,a,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.list_reward.renderHandler=new Laya.Handler(this,this.onItemRenderHandler),this.list_reward.mouseHandler=new Laya.Handler(this,this.onListMouseHandler),this.list_reward.dataSource=this.getKingReward(),this.list_rank_reward.scrollBar.elasticDistance=200,this.list_rank_reward.renderHandler=new Laya.Handler(this,this.onRankRewardRenderHandler);var e=[];for(var t in o.GameConfig.sandyCityRankJson)1==o.GameConfig.sandyCityRankJson[t].type&&e.push(o.GameConfig.sandyCityRankJson[t]);this.list_rank_reward.dataSource=e},e.prototype.getKingReward=function(){for(var e,t,i=o.GameConfig.sandyCitySettingJson.showitem,n=String(i.value).split(","),s=[],a=0;a<n.length;a++)t={id:(e=n[a].split(":"))[0],num:e[1]},s.push(t);return s},e.prototype.onListMouseHandler=function(e,t){e.type==laya.events.Event.CLICK&&n.ItemTips.ins.showTip(this.list_reward.dataSource[t].id,Number(this.list_reward.dataSource[t].num))},e.prototype.onItemRenderHandler=function(e,t){var i,n=e.dataSource.id;i="630"==n||"6016"==n||"GOLD"==n?"res/society/attackCity/hanghui_jiaobiao1.png":"res/society/attackCity/hanghui_jiaobiao2.png";var s=this["rewardSign"+t];s&&(s.skin=i),a.ItemCellUtils.fillCellForItemNameView(e,e.dataSource.id,Number(e.dataSource.num))},e.prototype.onRankRewardRenderHandler=function(e,t){var i=e.dataSource;e.lab_rank.text=s.TextConst.get(58,i.rankName),e.list_reward.dataSource=i.itemShow,e.list_reward.renderHandler=new Laya.Handler(this,this.onRewardRenderHandler),e.list_reward.mouseHandler=new Laya.Handler(this,this.onRewardMouseHandler)},e.prototype.onRewardRenderHandler=function(e,t){a.ItemCellUtils.fillCellForItemNameView(e,e.dataSource[0],Number(e.dataSource[1]))},e.prototype.onRewardMouseHandler=function(e,t){if(e.type==laya.events.Event.CLICK){var i=e.target;i&&n.ItemTips.ins.showTip(i.dataSource[0],Number(i.dataSource[1]))}},e.prototype.showPage=function(){i.ClearResM.addBgUrl(this.bgimg.skin),this.bgimg.restskin()},e}(ui.guild.attackCity.pages.GuildRankRewardPageUI);t.GuildRankRewardPage=r}),define("src/g/guild/view/attackCity/pages/PersonRankRewardPage",["require","exports","../../../../../config/GameConfig","../../../../../utils/ItemCellUtils","../../../../bag/tips/view/ItemTips","../../../../../init/TextConst"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.list_rank_reward.scrollBar.elasticDistance=200,this.list_rank_reward.renderHandler=new Laya.Handler(this,this.onRankRewardRenderHandler);var e=[];for(var t in i.GameConfig.sandyCityRankJson)2==i.GameConfig.sandyCityRankJson[t].type&&e.push(i.GameConfig.sandyCityRankJson[t]);this.list_rank_reward.dataSource=e},e.prototype.onRankRewardRenderHandler=function(e,t){var i=e.dataSource;e.lab_rank.text=a.TextConst.get(28,i.rankName),e.list_reward.dataSource=i.itemShow,e.list_reward.renderHandler=new Laya.Handler(this,this.onRewardRenderHandler),e.list_reward.mouseHandler=new Laya.Handler(this,this.onRewardMouseHandler)},e.prototype.onRewardRenderHandler=function(e,t){n.ItemCellUtils.fillCellForItemNameView(e,e.dataSource[0],Number(e.dataSource[1]))},e.prototype.onRewardMouseHandler=function(e,t){if(e.type==laya.events.Event.CLICK){var i=e.target;i&&s.ItemTips.ins.showTip(i.dataSource[0],Number(i.dataSource[1]))}},e.prototype.showPage=function(){},e}(ui.guild.attackCity.pages.PersonRankRewardPageUI);t.PersonRankRewardPage=o}),define("src/g/guild/view/attackCity/AttackSandyCityRewardView",["require","exports","../../../../manager/LayerManager","src/g/guild/view/attackCity/pages/GuildRankRewardPage","src/g/guild/view/attackCity/pages/PersonRankRewardPage"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.bg.img_title.skin="res/society/attackCity/gongshajiangli_wenzi.png",this.bg.btn_help.visible=!1,this.bg.btn_close.on(Laya.Event.CLICK,this,this.closePanel),this.bg.btn_back.on(Laya.Event.CLICK,this,this.closePanel),this.btnbar.selectHandler=new Laya.Handler(this,this.onSwitchPage)},t.prototype.showView=function(e){void 0===e&&(e=0),i.LayerManager.addInPOPWindowLayer(this,!1,!1,!1),this.btnbar.selectedIndex!=e?this.btnbar.selectedIndex=e:this.onSwitchPage(e)},t.prototype.closePanel=function(){this.removeSelf()},t.prototype.onSwitchPage=function(e){switch(this.bg.box_page.removeChildren(),e){case 0:this._guildReward||(this._guildReward=new n.GuildRankRewardPage),this.bg.box_page.addChild(this._guildReward),this._guildReward.showPage();break;case 1:this._personReward||(this._personReward=new s.PersonRankRewardPage),this.bg.box_page.addChild(this._personReward),this._personReward.showPage()}},t}(ui.guild.attackCity.AttackSandyCityRewardViewUI);t.AttackSandyCityRewardView=a}),define("src/g/guild/ctrl/attackCity/AttackSandyCityRewardViewCtrl",["require","exports","../../../base/GameBaseCtrl","src/g/guild/view/attackCity/AttackSandyCityRewardView","../../../../core/E","../../../../enum/EventName"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.url="res/atlas/res/society/attackCity.json",e}return __extends(e,t),e.prototype.init=function(){s.E.ins.on(a.EventName.OPEN_ATTACK_CITY_REWARD_PANEL,this,this.openPanel)},e.prototype.openPanel=function(){this.completeHandler()},e.prototype.completeHandler=function(){this._view||(this._view=new n.AttackSandyCityRewardView),this._view.showView()},e}(i.GameBaseCtrl);t.AttackSandyCityRewardViewCtrl=o}),define("src/g/guild/view/attackCity/pages/PreviousGuildRankPage",["require","exports","../../../../fight/osprite/play/family/SandCityFManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.list_rank.scrollBar.elasticDistance=200,this.list_rank.renderHandler=new Laya.Handler(this,this.onItemRenderHandler)},t.prototype.showPage=function(e){this.list_rank.dataSource=e,i.SandCityFManager.getInstance().sandyCityWarInfo&&i.SandCityFManager.getInstance().sandyCityWarInfo.lastSandyRank&&(this.lab_guild_name.text=i.SandCityFManager.getInstance().sandyCityWarInfo.lastSandyRank.santoFamilyNick)},t.prototype.onItemRenderHandler=function(e,t){var i=this.list_rank.dataSource[t];e.lab_rank.text=i.rank.toString(),e.lab_name1.text=i.name.toString(),e.lab_name2.text=i.name2.toString(),e.lab_score.text=i.scort.toString()},t}(ui.guild.attackCity.pages.PreviousGuildRankPageUI);t.PreviousGuildRankPage=n}),define("src/g/guild/view/attackCity/pages/PreviousPersonRankPage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.list_rank.scrollBar.elasticDistance=200,this.list_rank.renderHandler=new Laya.Handler(this,this.onItemRenderHandler)},t.prototype.showPage=function(e){this.list_rank.dataSource=e},t.prototype.onItemRenderHandler=function(e,t){var i=this.list_rank.dataSource[t];e.lab_rank.text=i.rank.toString(),e.lab_name1.text=i.name,e.lab_name2.text=i.name2,e.lab_score.text=i.scort.toString()},t}(ui.guild.attackCity.pages.PreviousPersonRankPageUI);t.PreviousPersonRankPage=i}),define("src/g/guild/view/attackCity/PreviousFightingView",["require","exports","../../../../manager/LayerManager","src/g/guild/view/attackCity/pages/PreviousGuildRankPage","src/g/guild/view/attackCity/pages/PreviousPersonRankPage","../../../fight/osprite/play/family/SandCityFManager"],function(e,t,i,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.bg.btn_help.visible=!1,this.bg.btn_close.on(Laya.Event.CLICK,this,this.closePanel),this.bg.btn_back.on(Laya.Event.CLICK,this,this.closePanel),this.btnbar.selectHandler=new Laya.Handler(this,this.onSwitchPage)},t.prototype.showView=function(e){void 0===e&&(e=0),i.LayerManager.addInPOPWindowLayer(this,!1,!1,!1),this.btnbar.selectedIndex!=e?this.btnbar.selectedIndex=e:this.onSwitchPage(e)},t.prototype.closePanel=function(){this.bg.box_page.removeChildren(),this.removeSelf()},t.prototype.onSwitchPage=function(e){switch(this.bg.box_page.removeChildren(),e){case 0:this._guildRank||(this._guildRank=new n.PreviousGuildRankPage),this.bg.box_page.addChild(this._guildRank),this._guildRank.showPage(this.getFamilyRankData());break;case 1:this._personRank||(this._personRank=new s.PreviousPersonRankPage),this.bg.box_page.addChild(this._personRank),this._personRank.showPage(this.getPersonRankData())}},t.prototype.getFamilyRankData=function(){var e=[],t=null,i=o.SandCityFManager.getInstance().sandyCityWarInfo;if(i)for(var n=i.lastSandyRank,s=null,a=0;a<n.familyRankList.length;a++)s=n.familyRankList[a],(t=new r).rank=a+1,t.name=s.familyNick,t.name2=s.chairmanNick,t.scort=s.sandyExp,e.push(t);return e},t.prototype.getPersonRankData=function(){var e=[],t=null,i=o.SandCityFManager.getInstance().sandyCityWarInfo;if(i)for(var n=i.lastSandyRank,s=null,a=0;a<n.personRankList.length;a++)s=n.personRankList[a],(t=new r).rank=a+1,t.name=s.usernick,t.name2=s.familyNick,t.scort=s.sandyExp,e.push(t);return e},t}(ui.guild.attackCity.PreviousFightingViewUI);t.PreviousFightingView=a;var r=function(){this.rank=0,this.scort=0,this.svrid=0};t.SCFRankData=r}),define("src/g/guild/ctrl/attackCity/PreviousFightingViewCtrl",["require","exports","../../../base/GameBaseCtrl","../../../../core/E","../../../../enum/EventName","src/g/guild/view/attackCity/PreviousFightingView","../../../fight/osprite/play/family/SandCityFManager"],function(e,t,i,n,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e.url="res/atlas/res/society/attackCity.json",e}return __extends(e,t),e.prototype.init=function(){n.E.ins.on(s.EventName.OPEN_SOCIETY_PREVIOUS_FIGHTING,this,this.openPanel)},e.prototype.openPanel=function(){this.openView()},e.prototype.completeHandler=function(){this._view||(this._view=new a.PreviousFightingView),this._view.showView(),this.updateUI()},e.prototype.updateUI=function(){o.SandCityFManager.getInstance().sandyCityWarInfo},e}(i.GameBaseCtrl);t.PreviousFightingViewCtrl=r}),define("src/g/guild/ctrl/shacheng/SCEntryBtnCtrl",["require","exports","../../../../core/E","../../../../enum/EventName","../../../fight/osprite/play/family/SandCityFManager","../../../../manager/RoleCenter","../../../index/ctrl/GameIndexCtrl","../../../accessctrl/AccessCenter","../../../net/messages/ChangeSceneMsg","../../../fight/osprite/play/PlayManager","../../../../utils/CountDown","../../../../config/GameConfig","../../../../utils/system/ServerTime","../../../../utils/system/DateUitl"],function(e,t,n,s,i,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(){this.hasWar=!1,this._warStart=!1,this.cd=new u.CountDown,n.E.ins.on(s.EventName.SC_WAR_TODAY_OPEN,this,this.todayHasWarHander),n.E.ins.on(s.EventName.SC_WAR_START,this,this.warStartHander),n.E.ins.on(s.EventName.SC_ENTRANCE_STATUS_CHANGED,this,this.entranceChanged),n.E.ins.on(s.EventName.SC_WAR_END,this,this.onCloseHander),r.AccessCenter.ins.inited||n.E.ins.on(s.EventName.ACCESS_CENTER_INITED,this,this.onAccessInit)}return e.instance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.onAccessInit=function(){n.E.ins.off(s.EventName.ACCESS_CENTER_INITED,this,this.onAccessInit),this.hasWar&&this.showActivityEntry()},e.prototype.todayHasWarHander=function(){this.hasWar=!0,console.warn("yxq....................沙城战今日开启"),this.showActivityEntry()},e.prototype.warStartHander=function(){this.hasWar=!0,this._warStart=!0,this.funIsOpen()&&(console.warn("yxq..............沙城战开始了"),this.entrance&&null!=this.entrance.parent||this.showActivityEntry())},e.prototype.entranceChanged=function(){0!=this.funIsOpen()&&null!=this.entrance&&(this.canDisplay()?(null==this.entrance.parent&&null!=o.GameIndexCtrl.idxView&&o.GameIndexCtrl.idxView.addChild(this.entrance),this.updXLocation()):this.entrance.removeSelf())},e.prototype.onCloseHander=function(){this.cd.stop(),console.warn("yxq........沙城战活动结束了"),this.hasWar=!1,this._warStart=!1,null!=this.entrance&&(this.entrance.ani_ani.stop(),this.entrance.removeSelf(),this.entrance.offAll(),this.entrance.destroy(!0),this.entrance=null)},e.prototype.canDisplay=function(){return null!=h.PlayManager.ins&&(h.PlayManager.type==l.EPlayType.PLAYTYPE_PORT||h.PlayManager.type!=l.EPlayType.PLAYTYPE_NEWVILLAGE&&(h.PlayManager.type==l.EPlayType.PLAYTYPE_MAINCITY&&!a.RoleCenter.instans.vo.newbee))},e.prototype.updXLocation=function(){this.entrance.right=90},e.prototype.funIsOpen=function(){return r.AccessCenter.ins.checkOpen(r.enumAccessId.family,!1)},e.prototype.showActivityEntry=function(){if(this.funIsOpen()){if(null==this.entrance){this.entrance=new ui.guild.shacheng.SCWarEntranceUI,this.entrance.on(Laya.Event.CLICK,this,this.openShachengHander),this.entrance.bottom=580;var e=c.GameConfig.sandyCitySettingJson.firstCron,t=String(e.value).split(","),i=new Date(d.ServerTime.adjustAreaMS(1e3*d.ServerTime.serverTime));i.setHours(Number(t[0]),Number(t[1]),0,0),this.cd.start(i.getTime()/1e3,this.updCdDisplay,this)}null!=o.GameIndexCtrl.idxView?0!=this.canDisplay()&&(this.updXLocation(),o.GameIndexCtrl.idxView.addChild(this.entrance)):n.E.ins.on(s.EventName.INDEX_VIEW_INIT_COMPLET,this,this.onIndexInit)}},e.prototype.updCdDisplay=function(e){0<e?this.entrance.lbCD.text=g.DateUtil.getHMS_countdown(e):(this.entrance.lbCD.text="",this.entrance.cdGround.visible=!1)},e.prototype.onIndexInit=function(){n.E.ins.off(s.EventName.INDEX_VIEW_INIT_COMPLET,this,this.onIndexInit),this.showActivityEntry()},e.prototype.openShachengHander=function(){i.SandCityFManager.getInstance().reqSandCityData()},e.prototype.todayHasWar=function(){return this.hasWar},e.prototype.sandyWarStart=function(){return this._warStart},e}();t.SCEntryBtnCtrl=p}),define("src/g/guild/view/attackCity/AttackSandyCityView",["require","exports","../../../../manager/LayerManager","../../../../utils/ItemUtils","../../../../core/E","../../../../enum/EventName","../../../../manager/RuledescManager","../../../fight/osprite/play/family/SandCityFManager","../../../net/messages/SandyCityMsg","../../../../core/GNet","../../../../manager/RoleCenter","../../../../enum/enumItem","../../../clearRes/ClearResM","../../../../config/GameConfig","../../../bag/tips/view/ItemTips","../../../../utils/ItemCellUtils","src/g/guild/ctrl/shacheng/SCEntryBtnCtrl","../../../../utils/system/ServerTime","../../../../utils/CountDown","../../../../utils/system/DateUitl","../../../../utils/RoleUtil","../../../../init/TextConst"],function(e,t,l,p,i,n,s,h,u,c,a,m,o,d,r,g,f,y,v,_,C,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=function(t){function e(){var e=t.call(this)||this;return e.cd=new v.CountDown,o.ClearResM.addBgUrl(e.bgming.skin),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.bg.img_title.skin="res/society/attackCity/shachengzhengba_wenzi.png",this.bg.btn_help.visible=!0,this.bg.btn_help.on(Laya.Event.CLICK,this,this.showHelpHander,[12]),this.lab_previous_fighting.on(Laya.Event.CLICK,this,this.openPreviousFighting),this.lab_battle_reward.on(Laya.Event.CLICK,this,this.openBattleReward),this.bazhuRewardList.renderHandler=new Laya.Handler(this,this.onItemRenderHandler),this.bazhuRewardList.mouseHandler=new Laya.Handler(this,this.onListMouseHandler),this.bazhuRewardList.dataSource=this.getKingReward()},e.prototype.getKingReward=function(){for(var e,t,i=d.GameConfig.sandyCitySettingJson.showitem,n=String(i.value).split(","),s=[],a=0;a<n.length;a++)t={id:(e=n[a].split(":"))[0],num:e[1]},s.push(t);return s},e.prototype.onListMouseHandler=function(e,t){e.type==laya.events.Event.CLICK&&r.ItemTips.ins.showTip(this.bazhuRewardList.dataSource[t].id,Number(this.bazhuRewardList.dataSource[t].num))},e.prototype.onItemRenderHandler=function(e,t){var i,n=e.dataSource.id;i="630"==n||"6016"==n||"GOLD"==n||"2116"==n?"res/society/attackCity/hanghui_jiaobiao1.png":"res/society/attackCity/hanghui_jiaobiao2.png",this["rewardSign"+t].skin=i,g.ItemCellUtils.fillCellForItemNameView(e,e.dataSource.id,Number(e.dataSource.num))},e.prototype.showHelpHander=function(e){s.RuledescManager.showRuledesc(e)},e.prototype.openPreviousFighting=function(){i.E.ins.event(n.EventName.OPEN_SOCIETY_PREVIOUS_FIGHTING)},e.prototype.openBattleReward=function(){i.E.ins.event(n.EventName.OPEN_ATTACK_CITY_REWARD_PANEL)},e.prototype.showView=function(e){void 0===e&&(e=!0),l.LayerManager.addInPOPWindowLayer(this,e,!0),this.bgming.restskin();var t=h.SandCityFManager.getInstance().sandyCityWarInfo;if(f.SCEntryBtnCtrl.instance().todayHasWar())if(this.activityStartCD.visible=!0,this.lab_start_time.visible=!1,f.SCEntryBtnCtrl.instance().sandyWarStart())this.activityStartCD&&(this.activityStartCD.text=w.TextConst.get(892));else{var i=d.GameConfig.sandyCitySettingJson.firstCron,n=String(i.value).split(","),s=new Date(y.ServerTime.adjustAreaMS(1e3*y.ServerTime.serverTime));s.setHours(Number(n[0]),Number(n[1]),0,0),this.cd.start(s.getTime()/1e3,this.updCdDisplay,this)}else{this.activityStartCD.visible=!1,this.lab_start_time.visible=!0;var a=new Date;if(!t)return;t.sandyCityState==u.ESandyCityState.OPEN?a.setTime(y.ServerTime.adjustAreaMS(1e3*t.openTime)):t.sandyCityState==u.ESandyCityState.CLOSE&&a.setTime(y.ServerTime.adjustAreaMS(1e3*t.nextOpenTime)),this.displayStartByDate(a)}var o=t?t.lastSandyRank.familyRankList:null,r=this.getTopThreeName();null!=o&&0!=o.length&&r&&r[0]?(c.GNet.getOtherData(r),this.imgEmpty.visible=!1,this.roleAnimation.visible=!0,this.msgpanel.visible=!0):(this.imgEmpty.visible=!0,this.roleAnimation.visible=!1,this.msgpanel.visible=!1)},e.prototype.updCdDisplay=function(e){var t=this.activityStartCD;t&&!t.destroyed&&t.changeText(w.TextConst.get(891,_.DateUtil.getHMS_countdown(e)))},e.prototype.updPlayerData=function(){if(h.SandCityFManager.getInstance().sandyCityWarInfo.lastSandyRank){var e,t=h.SandCityFManager.getInstance().sandyCityWarInfo.lastSandyRank.familyRankList,i=this.getTopThreeName()[0];null!=i?(e=a.RoleCenter.instans.getOtherData(i),this.updateUserData(e,0,!0),this.lbName.text=t[0].chairmanNick,this.lbFamilyName.text=w.TextConst.get(540,t[0].familyNick)):(this.imgEmpty.visible=!0,this.roleAnimation.visible=!1,this.msgpanel.visible=!1,console.error("yxq----沙城霸主信息错误"))}},e.prototype.getTopThreeName=function(){for(var e,t=h.SandCityFManager.getInstance().sandyCityWarInfo.lastSandyRank.familyRankList,i=[],n=Math.min(3,t.length),s=0;s<n;s++)e=t[s],i.push(e.chairmanUsername);return i},e.prototype.updateUserData=function(e,t,i){void 0===i&&(i=!1);var n=this.ani_wing,s=this.ani_weapon,a=this.ani_role,o=this.ani_chenghao;if(e){var r=e.openhero[0];if(r.openWing){var l=p.ItemUtils.getWingLevelVoById(r.heroWing.level).res;C.RoleUtil.setAniSource(r,120,n,l,0)}var h=r.equpos[m.enumItem.equipPos_weapon-1].equins.equtemplet;if(0<h){var u=p.ItemUtils.getEquipVoById(h).weaponRes;C.RoleUtil.setAniSource(r,120,s,u,1)}var c=void 0;if(i)c=p.ItemUtils.getFashionVo(630).res;else{var d=r.equpos[m.enumItem.equipPos_clothes-1].equins.equtemplet;c=0<d?p.ItemUtils.getEquipVoById(d).roleRes:0}C.RoleUtil.setAniSource(r,120,a,c,2);var g=0;g=0==t?6016:1==t?6201:6203,C.RoleUtil.setAniSource(r,120,o,g,4)}},e.prototype.displayStartByDate=function(e){var t=this.lab_start_time;t&&!t.destroyed&&(t.text=w.TextConst.get(26,e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes()))},e}(ui.guild.attackCity.AttackSandyCityViewUI);t.AttackSandyCityView=I}),define("src/g/guild/view/attackCity/WorshipRewardDlg",["require","exports","../../../../config/GameConfig","../../../../utils/ItemCellUtils","../../../bag/tips/view/ItemTips","../../../fight/osprite/play/family/SandCityFManager","../../../clearRes/ClearResM","../../../../runtime/resload/GameResLoad"],function(e,t,n,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;return e.resUrl="res/atlas/res/society/character.json",e.init(),e}return __extends(e,i),e.prototype.init=function(){this.btn_back.on(Laya.Event.CLICK,this,this.close),this.btn_close.on(Laya.Event.CLICK,this,this.close),this.btn_get.on(Laya.Event.CLICK,this,this.onGetRewardHandler),this.list1.renderHandler=new Laya.Handler(this,this.onItemRenderHandler),this.list2.renderHandler=new Laya.Handler(this,this.onItemRenderHandler),this.list1.mouseHandler=new Laya.Handler(this,this.onList1MouseHandler),this.list2.mouseHandler=new Laya.Handler(this,this.onList2MouseHandler);for(var e in n.GameConfig.sandyCityRankJson)3==n.GameConfig.sandyCityRankJson[e].type?this.list1.dataSource=n.GameConfig.sandyCityRankJson[e].bonus:4==n.GameConfig.sandyCityRankJson[e].type&&(this.list2.dataSource=n.GameConfig.sandyCityRankJson[e].bonus)},e.prototype.popPanel=function(){this.popup(),l.GameResLoad.load(this.resUrl),o.SandCityFManager.getInstance().worshipRewardDlg=this},e.prototype.close=function(e,t){i.prototype.close.call(this,e,t),r.ClearResM.clearUrl(this.resUrl)},e.prototype.onItemRenderHandler=function(e,t){s.ItemCellUtils.fillCellForItemNameView(e,e.dataSource[0],Number(e.dataSource[1]))},e.prototype.onList1MouseHandler=function(e,t){e.type==laya.events.Event.CLICK&&a.ItemTips.ins.showTip(this.list1.dataSource[t][0],Number(this.list1.dataSource[t][1]))},e.prototype.onList2MouseHandler=function(e,t){e.type==laya.events.Event.CLICK&&a.ItemTips.ins.showTip(this.list2.dataSource[t][0],Number(this.list2.dataSource[t][1]))},e.prototype.onGetRewardHandler=function(){o.SandCityFManager.getInstance().reqWorshipReward()},e}(ui.guild.attackCity.WorshipRewardDlgUI);t.WorshipRewardDlg=i}),define("src/g/guild/ctrl/attackCity/AttackSandyCityViewCtrl",["require","exports","src/g/guild/view/attackCity/AttackSandyCityView","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../accessctrl/AccessCenter","../../../base/BaseCtrl","../../../../core/E","../../../../enum/EventName","../../../fight/osprite/play/family/SandCityFManager","../../../../manager/LayerManager","src/g/guild/view/attackCity/WorshipRewardDlg","../../../../init/Switches","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e.clsoeOhter=!0,e.url="res/atlas/res/society/attackCity.json",e}return __extends(e,t),e.prototype.init=function(){d.Switches.ins.on(a.enumAccessId.attackCity,this,this.onOpenHandler),r.E.ins.on(l.EventName.OTHERDATA_UPDATE,this,this.receivedPlayerData)},e.prototype.onOpenHandler=function(){a.AccessCenter.ins.checkOpen(a.enumAccessId.family,!1)?this.open():n.FE.upItems(g.TextConst.get(528),s.BubbleEnum.center)},e.prototype.onAtlasLoaded=function(){var e=this._view;e||(this._view=e=new i.AttackSandyCityView,e.bg.btn_back.on(Laya.Event.CLICK,this,this.closePanel),e.bg.btn_close.on(Laya.Event.CLICK,this,this.closePanel),e.btn_battle.on(Laya.Event.CLICK,this,this.doBattle),e.btn_mobai.on(Laya.Event.CLICK,this,this.openMoBaiHandler),e.on(Laya.Event.REMOVED,this,this.onRemovedHander)),e.showView(this.clsoeOhter)},e.prototype.receivedPlayerData=function(){var e=this._view;e&&e.displayedInStage&&e.updPlayerData()},e.prototype.doBattle=function(){h.SandCityFManager.getInstance().startFamilyBattle()&&(this.closePanel(),u.LayerManager.closeAllPOPWindow(),r.E.ins.event(l.EventName.SC_INTO))},e.prototype.openMoBaiHandler=function(){0!=h.SandCityFManager.getInstance().isHaveLastWinnerKey()?(this._mobaiPanel||(this._mobaiPanel=new c.WorshipRewardDlg),this._mobaiPanel.popPanel()):n.FE.upItems(g.TextConst.get(529),s.BubbleEnum.center)},e.prototype.onRemovedHander=function(){this.closePanel()},e.prototype.closePanel=function(){var e=this._view;e&&(e.cd.stop(),e.off(Laya.Event.REMOVED,this,this.onRemovedHander),e.bg.btn_back.off(Laya.Event.CLICK,this,this.closePanel),e.bg.btn_close.off(Laya.Event.CLICK,this,this.closePanel),e.btn_battle.off(Laya.Event.CLICK,this,this.doBattle),e.btn_mobai.off(Laya.Event.CLICK,this,this.openMoBaiHandler),e.removeSelf(),e.destroy(!0),this._view=null,this._mobaiPanel&&(this._mobaiPanel.destroy(!0),this._mobaiPanel=null))},e}(o.BaseCtrl);t.AttackSandyCityViewCtrl=p}),define("src/g/guild/view/warehouse/GuildWarehouseView",["require","exports","../../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),i.LayerManager.addInPOPWindowLayer(this,e,!0,!0,!1,t)},t.prototype.hideView=function(){this.bg.box_page.removeChildren(),this.removeSelf()},t.prototype.destroyView=function(){this.hideView()},t}(ui.guild.warehouse.GuildWarehouseUI);t.GuildWarehouseView=n}),define("src/g/guild/view/warehouse/pages/ChestPage",["require","exports","../../../../../manager/RoleCenter","../../../../../utils/ItemUtils","../../../../itemGets/View/ItemGetDlg","../../../../account/view/AccItem","../../../../guide/vo/RewardVo","../../../../../enum/enumItem","../../../../../utils/system/FloatEffect","../../../../../plugin/view/ToolTip","../../../../net/messages/UserFamilyDataGS2C","../../../../../manager/GameSocketManager","../../../../../config/GameConfig","../../../../../init/TextConst"],function(e,t,n,h,s,u,c,d,i,a,o,r,l,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e.nowShowLv=0,e.nowGuildLv=0,e.btn_open.on(Laya.Event.CLICK,e,e.onGetReward),e.img_left.on(Laya.Event.CLICK,e,e.onTurn,[-1]),e.img_right.on(Laya.Event.CLICK,e,e.onTurn,[1]),e.list_star.renderHandler=new Laya.Handler(e,e.starRender),e}return __extends(e,t),e.prototype.setStarNum=function(){var e=l.GameConfig.commonJson.familybox.value||0,t=this.nowShowLv%e;0==t&&(t=e);for(var i=[],n=0;n<e;n++)i.push(n<t);this.list_star.dataSource=i},e.prototype.starRender=function(e,t){e.skin="res/custom/juese_jingmai_"+(e.dataSource?"xing":"kongxing")+".png"},e.prototype.onGetReward=function(){var e=h.ItemUtils.getFamilylevelById(this.nowGuildLv);e.times-this.ufvo._ufdata.buyBoxNum<=0?i.FE.upItems(g.TextConst.get(825),a.BubbleEnum.center):n.RoleCenter.instans.vo.GHGX<e.cost[0][1]?i.FE.upItems(g.TextConst.get(826),a.BubbleEnum.center):r.GSM.sendServer(new o.BuyFamilyBoxC2GS)},e.prototype.onTurn=function(e){this.nowShowLv+=e,this.renderView()},e.prototype.renderView=function(){var e=this.nowShowLv;this.lvo=h.ItemUtils.getFamilylevelById(e),this.renderTurn(),this.btn_open.disabled=e!=this.nowGuildLv,this.clip_lv.value=e+"",this.img_box.skin="res/guild/chest/"+l.GameConfig.FamilyLevel[e].image+".png",this.renderNeed(),this.renderReward(),this.setStarNum()},e.prototype.initShow=function(){var e=n.RoleCenter.instans.ufVo,t=e.selfFamily;this.nowGuildLv=t?t.flvl:0,this.nowShowLv=this.nowGuildLv,this.ufvo=e},e.prototype.showView=function(){this.initShow(),this.renderView()},e.prototype.renderReward=function(){this.panelList.removeChildren();for(var e=new Laya.Sprite,t=this.lvo.bonus1,i=0;i<t.length;i++){var n=t[i],s=h.ItemUtils.getItemVoById(n[0]),a=h.ItemUtils.getCurrencyVoByDefine(n[0]),o=new c.RewardVo,r=void 0;o.count=n[1],s?(r=s,o.type=d.ItemType.ITEM,o.id=s.id):a&&(r=a,o.type=d.ItemType.CURRENCY,o.define=a.define),o.name=r.name,o.quality=h.ItemUtils.getColorByQuality(r.quality),o.res=h.ItemUtils.getIconByIconId(r.icon),o.qualityNum=r.quality,o.streamer=r.streamer;var l=new u.AccItem;l.eqData=o,e.addChild(l),l.x=e.width,e.width+=l.width}e.height=l.height,this.panelList.addChild(e),e.width>this.panelList.width?e.x=0:e.x=this.panelList.width/2-e.width/2},e.prototype.renderNeed=function(){var e=h.ItemUtils.getFamilylevelById(this.nowGuildLv),t=e.times-this.ufvo._ufdata.buyBoxNum;this.lab_count.text=g.TextConst.get(889,t<0?0:t),this.item_cost.setNeed(n.RoleCenter.instans.vo.GHGX,e.cost[0][1]);var i=h.ItemUtils.getCurrencyVoByDefine(e.cost[0][0]);this.item_cost.setNeedName(g.TextConst.get(827),h.ItemUtils.getSmallIcon(i.icon)),this.item_cost.setQualColor(h.ItemUtils.getColorByQuality(i.quality)),this.item_cost.setJump(g.TextConst.get(481),new Laya.Handler(this,function(){s.ItemGetDlg.create(-1,"GHGX")}))},e.prototype.renderTurn=function(){return 1==this.nowShowLv?(this.img_left.visible=!1,void(this.img_right.visible=!0)):h.ItemUtils.getFamilylevelById(this.nowShowLv+1)?void(this.nowShowLv==this.nowGuildLv+1?(this.img_left.visible=!0,this.img_right.visible=!1):this.nowShowLv==this.nowGuildLv&&(this.img_right.visible=!0,this.img_left.visible=!1)):(this.img_right.visible=!1,void(this.img_left.visible=this.nowGuildLv==this.nowShowLv-1))},e}(ui.guild.warehouse.pages.ChestPageUI);t.ChestPage=p}),define("src/g/guild/ctrl/warehouse/page/ChestPageCtrl",["require","exports","src/g/guild/view/warehouse/pages/ChestPage","../../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this.sourceUrls=[]}return e.prototype.init=function(){this._view=new i.ChestPage,this.addEvent()},e.prototype.addEvent=function(){},e.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),e.addChild(this._view),this._view.showView(),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view&&this._view.renderView()},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){this.hidePage()},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(e,t){},e}();t.ChestPageCtrl=s}),define("src/g/guild/ctrl/warehouse/GuildWarehouseViewCtrl",["require","exports","src/g/guild/view/warehouse/GuildWarehouseView","../../../base/BaseCtrl","../../../accessctrl/AccessCenter","../../../proxy/MultiLevelUIProxy","src/g/guild/ctrl/warehouse/page/ChestPageCtrl","../../../../manager/GameSocketManager","../../../net/messages/UserFamilyDataGS2C","../../../../manager/RoleCenter","../../../../vo/RedDot/RedDot_Guild","../../../../init/Switches","../../../../init/ResManager"],function(e,t,i,n,s,a,o,r,l,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e._openArg=[],e.urls=["res/atlas/res/guild/chest.json"],e.initCtrl(),e.addEvent(),e}return __extends(e,t),e.prototype.addEvent=function(){c.Switches.ins.on(s.enumAccessId.guild_chest,this,this.onOpenHandler,[s.enumAccessId.guild_chest]),r.GSM.ins.on(l.BuyFamilyBoxGS2C.KEY,this,this.onBuyFamilyBoxGS2C)},e.prototype.onBuyFamilyBoxGS2C=function(e){h.RoleCenter.instans.ufVo.inFamily||console.error("开启宝箱的时候角色不在行会中"),h.RoleCenter.instans.ufVo._ufdata.buyBoxNum=e.buyBoxNum,h.RoleCenter.instans.vo.GHGX=e.GHGX,h.RoleCenter.instans.addInventoryToC(e.inv),h.RoleCenter.effectExpAndMoney(e.inv),u.RedDot_Guild.Ins.reCheckAll(),this._chest&&this._chest.refreshData()},e.prototype.initCtrl=function(){this._chest=new o.ChestPageCtrl},e.prototype.initView=function(){this._view=new i.GuildWarehouseView,this._view.bg.btn_back.on(Laya.Event.CLICK,this,this.hidePage),this._view.bg.btn_close.on(Laya.Event.CLICK,this,this.hidePage),this._tabProxy=new a.MultiLevelUIProxy,this._tabProxy.registerTab(this._view.btnbar,0),this._tabProxy.registerTagIndex(s.enumAccessId.guild_chest,0),this._tabProxy.selectHandler=new Laya.Handler(this,this.tab_selectHandler)},e.prototype.tab_selectHandler=function(e){this._page&&this._page.hidePage(),0==e&&(this._page=this._chest),this._page&&this._page.showPage(this._view.bg.box_page)},e.prototype.openShenBingView=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!1),void 0===i&&(i=!1),this._openArg.length=0,this._openArg.push(e),this._openArg.push(t),this._openArg.push(i),this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenChestView(this._openArg[0],this._openArg[1],this._openArg[2])},e.prototype.realOpenChestView=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!1),void 0===i&&(i=!1),this._view||this.initView(),this._tabProxy.open(e),this._view.showView(t,i)},e.prototype.onOpenHandler=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t&&(e==s.enumAccessId.guild_chest?s.AccessCenter.ins.checkOpen(s.enumAccessId.guild_chest)&&this.openShenBingView(s.enumAccessId.guild_chest,i,n):this.openShenBingView(e,i,n))},e.prototype.init=function(){return null},e.prototype.showPage=function(e,t){d.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.changePerson=function(e,t){},e.prototype.refreshData=function(){this._page&&this._page.refreshData()},e.prototype.getTitle=function(){return null},e.prototype.hidePage=function(){this._view&&this._view.hideView(),this._chest&&this._chest.hidePage()},e.prototype.destroyPage=function(){this._view&&this._view.destroyView(),this._chest&&this._chest.destroyPage(),d.ResManager.getInstance().destroyPageCtrl(this),this.clearCtrlRes()},e}(n.BaseCtrl);t.GuildWarehouseViewCtrl=g}),define("src/g/guild/view/task/page/GuildTaskPage",["require","exports","../../../../net/messages/ErrConst","../../../../../utils/system/ErrCodeView","../../../../../manager/GameSocketManager","../../../../net/messages/OpNoParaC2GS","../../../../../manager/RoleCenter","../../../../net/messages/UserFamilyDataGS2C","../../../../../meta/MainButtonVo","../../../../../utils/ItemUtils","../../../../../utils/system/FloatEffect","../../../../../plugin/view/ToolTip","../../../../accessctrl/AccessCenter","../../../../../core/E","../../../../../vo/RedDot/EventRedDot","../../../../../init/TextConst","../../../../../init/Switches","../../../../../meta/CommonVo"],function(e,t,i,n,a,o,l,r,s,h,u,c,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){function e(){var e=t.call(this)||this;return e.isAutoRunning=!1,e.initView(),g.E.ins.on(p.EventRedDot.REFRESH_GUILD_JUANXIAN_HANGHUIBI,e,e.refreshData),e}return __extends(e,t),e.prototype.initView=function(){this.ufvo=l.RoleCenter.instans.ufVo,this.list_.renderHandler=new Laya.Handler(this,this.renderHandler);for(var e=[],t=0;t<this.ufvo._ufdata.ftaskCount.length;t++){var i=h.ItemUtils.getFamilyTaskById(t);i&&e.push(i)}this.list_.dataSource=e},e.prototype.refreshData=function(){this.list_.dataSource=this.list_.dataSource},e.prototype.renderHandler=function(e,t){var i=this.ufvo._ufdata.ftaskCount[t],n=e.dataSource;if(e.setTitle(n.name),e.setItemIcon("dynamic/taskicon/"+n.icon+".png"),"Hanghuibi"==n.type){var s=l.RoleCenter.instans.vo.bagdata.getItemCount(n.cost[0][0]);e.setTitle2(m.TextConst.get(102,s)),e.lab_title2.color=0==s?"#ff0f15":"#09d51f",e.setRed(i<n.count&&s>=n.cost[0][1])}else e.setRed(!1),e.setTitle2();if(this.on(Laya.Event.MOUSE_UP,this,this.onUpLvMouUp),1==n.id){e.btn_go.clickHandler=new Laya.Handler(this,this.donateGold),e.setBtnTitle(m.TextConst.get(579));var a=i>n.bonus1.length-1?n.bonus1.length-1:i,o=h.ItemUtils.getCurrencyVoByDefine(n.bonus1[a][0]),r=h.ItemUtils.getCurrencyVoByDefine(n.bonus2[a][0]);e.setTitle(n.name.replace("{1}",n.cost[a][1])),e.setBonus(o.name+"x"+n.bonus1[a][1],r.name+"x"+n.bonus2[a][1])}else{2==n.id?(e.btn_go.clickHandler=new Laya.Handler(this,this.donateMoney),e.setBtnTitle(m.TextConst.get(579))):3==n.id?(e.btn_go.clickHandler=new Laya.Handler(this,this.donateItem),e.btn_go.on(Laya.Event.MOUSE_DOWN,this,this.onUpLvMouDown),e.btn_go.on(Laya.Event.MOUSE_OUT,this,this.onUpLvMouMove),this.on(Laya.Event.REMOVED,this,this.stopAuto),e.setBtnTitle(m.TextConst.get(579))):(e.btn_go.clickHandler=new Laya.Handler(this,this.goModule,[n.id]),e.setBtnTitle(m.TextConst.get(200)));o=h.ItemUtils.getCurrencyVoByDefine(n.bonus1[0][0]),r=h.ItemUtils.getCurrencyVoByDefine(n.bonus2[0][0]);e.setBonus(o.name+"x"+n.bonus1[0][1],r.name+"x"+n.bonus2[0][1])}e.setCount(i,n.count),e.setBtnShow(i<n.count)},e.prototype.onUpLvMouDown=function(){Laya.timer.once(y.CommonVo.getVoByKey("anzhuTimeInterval").val2num,this,this.beginAuto)},e.prototype.onUpLvMouUp=function(){this.stopAuto()},e.prototype.onUpLvMouMove=function(){this.isAutoRunning&&this.stopAuto()},e.prototype.beginAuto=function(){this.isAutoRunning||(Laya.timer.loop(y.CommonVo.getVoByKey("anzhuTime").val2num,this,this.donateItem),this.isAutoRunning=!0)},e.prototype.stopAuto=function(){Laya.timer.clear(this,this.beginAuto),Laya.timer.clear(this,this.donateItem),this.isAutoRunning=!1},e.prototype.donateGold=function(e){var t=this.ufvo._ufdata.ftaskCount[0],i=h.ItemUtils.getFamilyTaskById(r.EFTaskType.EFTGOLD),n=t>i.bonus1.length-1?i.bonus1.length-1:t;if(l.RoleCenter.instans.vo.VIP<i.limit[0][1])u.FE.upItems(m.TextConst.get(972,i.limit[0][1]),c.BubbleEnum.center);else if(l.RoleCenter.instans.vo.GOLD>=i.cost[n][1]){var s=new o.OpNoParaC2GS;s.optype=o.EOpNopara.finishGoldFTask,a.GSM.sendServer(s)}else f.Switches.ins.event(d.enumAccessId.goldInsufficient)},e.prototype.donateMoney=function(){var e=h.ItemUtils.getFamilyTaskById(r.EFTaskType.EFTMONEY);if(l.RoleCenter.instans.vo.MONEY>=e.cost[0][1]){var t=new o.OpNoParaC2GS;t.optype=o.EOpNopara.finishMoneyTask,a.GSM.sendServer(t)}else n.ErrCodeView.show(i.enumErrConst.code_2109)},e.prototype.donateItem=function(){var e=h.ItemUtils.getFamilyTaskById(r.EFTaskType.EFTITEM),t=l.RoleCenter.instans.vo,i=h.ItemUtils.getItemVoById(parseInt(e.cost[0][0]));if(t.bagdata.getItemCount(i.id)>=parseInt(e.cost[0][1])){var n=new o.OpNoParaC2GS;n.optype=o.EOpNopara.finishItemTask,a.GSM.sendServer(n)}else u.FE.upItems(m.TextConst.get(890,i.name),c.BubbleEnum.center)},e.prototype.goModule=function(e){var t=h.ItemUtils.getFamilyTaskById(e);s.MainButtonStruct.Ins.OpenModule(t.moduleid[0][1],t.moduleid[1][1])},e}(ui.guild.task.taskPageUI);t.GuildTaskPage=v}),define("src/g/guild/ctrl/task/page/TaskPageCtrl",["require","exports","src/g/guild/view/task/page/GuildTaskPage","../../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){this._view=new i.GuildTaskPage},e.prototype.showPage=function(e,t){void 0===t&&(t=null),e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.changePerson=function(e){},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.TaskPageCtrl=s}),define("src/g/guild/view/task/GuildTaskView",["require","exports","../../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.viewbg.img_bg.skin="res/custom/beibao_ditubeijing2.png",e}return __extends(e,t),e.prototype.showView=function(){i.LayerManager.addInPOPWindowLayer(this)},e.prototype.hideView=function(){this.viewbg.box_page.removeChildren(),this.removeSelf()},e}(ui.guild.task.guildTaskBgUI);t.GuildTaskView=n}),define("src/g/guild/view/task/item/RuQinItem",["require","exports","../../../../../utils/system/FloatEffect","../../../../net/messages/ManageFamilyMsg","../../../../../manager/GameSocketManager","../../../../../manager/LayerManager","../../../../../utils/ItemUtils","../../../../../manager/StateManger","../../../../../manager/RoleCenter","../../../../../config/GameConfig","../../../../../plugin/view/ToolTip","../../../../../utils/system/DateUitl","../../../../../manager/AM","../../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e.btn_go.on(Laya.Event.CLICK,e,e.clickHandler),e}return __extends(e,t),e.prototype.clickHandler=function(){if(l.RoleCenter.instans.bagRoomEnough()){if(!r.StateManger.isSpecialPlay(!0))if(l.RoleCenter.instans.ufVo._ufdata.familyInvadeCnt>=h.GameConfig.FamilySettingVo.intursioncount)i.FE.upItems(g.TextConst.get(539),u.BubbleEnum.center);else{var e=new n.ChallegeInvadeStartC2GS;e.portid=this._vo.portid,s.GSM.sendServer(e),a.LayerManager.closeAllPOPWindow(),this._vo.portState=n.EInvadeState.IN_DEATH}}else d.AM.showBagNotEnough()},e.prototype.setData=function(e){if(this._vo!=e&&(this._vo=e,this._vo)){var t=o.ItemUtils.getPortVoById(e.portid);if(t){var i=o.ItemUtils.getMonsterVOById(t.boss[0]);this.m_name.text=i.name,this.m_icon.skin=o.ItemUtils.getBossIccon(i.id)}this.m_time.style.fontSize=20;var n=g.TextConst.get(819,c.DateUtil.getHM(1e3*e.invadeTime));this.m_time.style.font="SimHei",this.m_time.innerHTML=n}},e}(ui.guild.task.item.RuQinItemUI);t.RuQinItem=p}),define("src/g/guild/view/task/page/activityPage",["require","exports","../../../../../manager/RoleCenter","../../../../../config/GameConfig","../../../../net/messages/ManageFamilyMsg","src/g/guild/view/task/item/RuQinItem","../../../../../utils/system/ServerTime","../../../../../init/TextConst"],function(e,t,i,a,o,n,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.uvo=i.RoleCenter.instans.vo,e.ufvo=e.uvo.ufVo,e.list.vScrollBarSkin="",e.list.renderHandler=new Laya.Handler(e,e.itemHandler),e.list.scrollBar.elasticDistance=100,e.list.itemRender=n.RuQinItem,e.initView(),e}return __extends(e,t),e.prototype.itemHandler=function(e,t){e.setData(this.list.array[t])},e.prototype.initView=function(){this.refreshData()},e.prototype.refreshData=function(){var e=[],t=[];this.ufvo.familyInvadeInfo&&this.ufvo.familyInvadeInfo.mInvadeArr&&(t=this.ufvo.familyInvadeInfo.mInvadeArr);for(var i=0;i<t.length;i++)t[i].portState==o.EInvadeState.CAN_CHALLENGE&&e.push(t[i]);this.list.array=e;var n=a.GameConfig.FamilySettingVo.intursioncount-this.ufvo._ufdata.familyInvadeCnt;this.c_count.color=0==n?"#ff0000":"#09d51f",this.c_count.text=n+"/"+t.length;var s=new Date(1e3*r.ServerTime.serverTime).getMinutes();s=30<s?60*(60-s):60*(30-s),this.timeer_txt.text=l.TextConst.get(12,s/60>>0)},e}(ui.guild.task.activityPageUI);t.activityPage=s}),define("src/g/guild/ctrl/task/page/ActivityPageCtrl",["require","exports","src/g/guild/view/task/page/activityPage","../../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){this._view=new i.activityPage},e.prototype.showPage=function(e,t){void 0===t&&(t=null),e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.changePerson=function(e){},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.ActivityPageCtrl=s}),define("src/g/guild/view/task/page/copyPage",["require","exports","../../../../../component/GAnimation","../../../../../manager/RoleCenter","../../../../net/messages/FamilyMijingMsg","../../../../../utils/ItemUtils","../../../../../enum/EventName","../../../../fight/info/PlayTypeVo","../../../../../core/E","../../../../../utils/system/FloatEffect","../../../../../manager/GameSocketManager","../../../../../manager/AM","../../../../../manager/LayerManager","../../../../net/messages/ChangeSceneMsg","../../../../../plugin/view/ToolTip","../../../../fight/base/RES","../../../../../init/TextConst"],function(e,t,m,s,i,f,a,o,r,n,l,h,u,c,d,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e.ufvo=s.RoleCenter.instans.ufVo,e.mijingInfo=e.ufvo.mijingInfo,e.lab_openRank.visible=!1,e.btn_fight.on(Laya.Event.CLICK,e,e.onClicked),e.btn_sweep.on(Laya.Event.CLICK,e,e.onSweep),r.E.ins.on(a.EventName.SOCIETY_REFRESH_MIJINGBOSS,e,e.refreshData),e}return __extends(e,t),e.prototype.refreshData=function(){null!=this.ufvo.mijingInfo&&null!=this.ufvo.mijingRankInfo&&this.showMiJingInfo()},e.prototype.showMiJingInfo=function(){null!=this.ani&&this.ani.destroy(),this.ani=new m.GAnimation,this.ani.x=266,this.ani.y=315,this.ani.name="monAni",this.addChild(this.ani),0==this.mijingInfo.todayMaxPort?this.lab_maxCount.text="":this.lab_maxCount.text=v.TextConst.get(2,this.mijingInfo.todayMaxPort),this.lab_maxName.text=this.mijingInfo.maxportNickname,this.lab_history.text=v.TextConst.get(577,this.ufvo._ufdata.challengeMJPort),this.lab_sweep.text=v.TextConst.get(576,this.ufvo._ufdata.sweepNum,1);var e=this.ufvo._ufdata.challengeMJPort+1;this.lab_portNum.text=e+"";var t=f.ItemUtils.getFamilyMiJingById(e);null==t&&(t=f.ItemUtils.getFamilyMiJingById(e-1));var i=this.mijingInfo.portPassMember[e-1],n=t.propertyShow.length>i?t.propertyShow[t.propertyShow.length-1]:t.propertyShow[i];this.lab_passPortNum.text=v.TextConst.get(98,i),this.lab_portAttr.text=v.TextConst.get(823,0==i?100:n[1]);var s=t.portConfig[i]||t.portConfig[t.portConfig.length-1],a=f.ItemUtils.getPortVoById(s[1]),o=f.ItemUtils.getMonsterVOById(a.boss[0]);if(-1==o.moResVo.dir.indexOf(5)){var r=y.RES.MONSTER_PATH+o.moResVo.res+"/3_r.json";this.ani.scale(-o.zoom,o.zoom)}else{r=y.RES.MONSTER_PATH+o.moResVo.res+"/5_r.json";this.ani.scale(o.zoom,o.zoom)}this.ani.load(r);for(var l=0;l<3;l++){var h=this["item_"+l],u=f.ItemUtils.getCurrencyVoByDefine(t.reward[l][0]),c=f.ItemUtils.getItemVoById(t.reward[l][0]);h.item.lab_num.text=t.reward[l][1]+"",h.item.img_occupation.visible=!1,null!=u&&(h.item.item.img_item.skin=f.ItemUtils.getIconByIconId(u.icon),h.item_name.text=u.name,h.item_name.color=f.ItemUtils.getColorByQuality(u.quality),h.item.item.img_quality.skin=f.ItemUtils.getQualitybjByQualityId(u.quality)),null!=c&&(h.item.item.img_item.skin=f.ItemUtils.getIconByIconId(c.icon),h.item.item.img_quality.skin=f.ItemUtils.getQualitybjByQualityId(c.quality),h.item_name.color=f.ItemUtils.getColorByQuality(c.quality),h.item_name.text=c.name)}var d=this.item_first,g=f.ItemUtils.getWingEquipVoById(t.firstReward[0][0]),p=f.ItemUtils.getItemVoById(t.firstReward[0][0]);d.lab_num.text=t.firstReward[0][1]+"",null!=g&&(d.img_item.skin=f.ItemUtils.getIconByIconId(g.icon),d.img_quality.skin=f.ItemUtils.getQualitybjByQualityId(g.quality)),null!=p&&(d.img_item.skin=f.ItemUtils.getIconByIconId(p.icon),d.img_quality.skin=f.ItemUtils.getQualitybjByQualityId(p.quality)),this.btn_sweep.disabled=0!=this.ufvo._ufdata.sweepNum,0==this.ufvo._ufdata.challengeMJPort&&(this.btn_sweep.disabled=!0),this.btn_sweep.label=0==this.ufvo._ufdata.sweepNum?v.TextConst.get(338):v.TextConst.get(824)},e.prototype.onClicked=function(){if(s.RoleCenter.instans.bagRoomEnough()){var e=this.ufvo._ufdata.challengeMJPort+1,t=f.ItemUtils.getFamilyMiJingById(e);null==t&&(e-=1,t=f.ItemUtils.getFamilyMiJingById(e));var i=this.mijingInfo.portPassMember[e-1],n=t.portConfig[i]||t.portConfig[t.portConfig.length-1];r.E.ins.event(a.EventName.PLAY_TYPE_CHANGE,o.PlayTypeVo.create(c.EPlayType.PLAYTYPE_GUILD_SECRET,{portid:n[1],mijingid:e})),r.E.ins.event(a.EventName.SOCIETY_CLOSE_TASK),u.LayerManager.closeAllPOPWindow()}else h.AM.showBagNotEnough()},e.prototype.onSweep=function(){if(0<this.ufvo._ufdata.sweepNum)n.FE.upItems(v.TextConst.get(578),d.BubbleEnum.center);else{var e=new i.SweepMijingC2GS;e.sweepMJId=this.ufvo._ufdata.challengeMJPort,l.GSM.sendServer(e)}},e}(ui.guild.task.copyPageUI);t.copyPage=g}),define("src/g/guild/ctrl/task/page/copyPageCtrl",["require","exports","src/g/guild/view/task/page/copyPage","../../../../net/messages/FamilyMijingMsg","../../../../../manager/GameSocketManager","../../../../../manager/RoleCenter","../../../../../init/ResManager"],function(e,t,i,n,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.init=function(){this._view=new i.copyPage,s.GSM.ins.on(n.SweepMijingGS2C.KEY,this,this.onSweepMijingGS2C)},e.prototype.onSweepMijingGS2C=function(e){e.opresult&&(a.RoleCenter.instans.ufVo._ufdata.sweepNum++,a.RoleCenter.instans.addInventoryToC(e.invent),this.refreshData())},e.prototype.showPage=function(e,t){void 0===t&&(t=null),e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),o.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.changePerson=function(e){},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){o.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){o.ResManager.getInstance().destroyPageCtrl(this)},e}();t.copyPageCtrl=r}),define("src/g/guild/view/task/item/SummonBossItem",["require","exports","../../../../../manager/RoleCenter","../../../../net/messages/SummonFBossMsg","../../../../../config/GameConfig","../../../../../utils/ItemCellUtils","../../../../../utils/ItemUtils","../../../../../enum/EventName","../../../../../core/E","../../../../fight/info/PlayTypeVo","../../../../bag/tips/view/ItemTips","../../../../fight/osprite/play/PlayManager","../../../../../utils/system/FloatEffect","../../../../../manager/LayerManager","../../../../../manager/AM","../../../../net/messages/ChangeSceneMsg","../../../../../plugin/view/ToolTip","../../../../../manager/StateManger","../../../../../init/TextConst"],function(e,t,s,a,o,i,r,l,h,u,n,c,d,g,p,m,f,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.list_item.renderHandler=new Laya.Handler(this,this.onRenderItemListHandler),this.list_item.mouseHandler=new Laya.Handler(this,this.onListeMouseHandler),this.btn_fight.on(Laya.Event.CLICK,this,this.doFightBoss)},t.prototype.setData=function(e){if(this._info=e,this.ower_name.text=e.username,this.btn_fight.disabled=!1,this.btn_fight.label=v.TextConst.get(341),h.E.ins.off(l.EventName.SUMMON_BOSS_INFO_CHANGED,this,this.onUpdateHpHandler),e){e.bossState==a.EFSBossState.HAVE_CHALLENGED&&(this.btn_fight.disabled=!0,this.btn_fight.label=v.TextConst.get(573));var t=o.GameConfig.portCallJson[e.portid];this.list_item.dataSource=t?t.show:[];var i=r.ItemUtils.getPortVoById(t.port),n=r.ItemUtils.getMonsterVOById(i.boss[0]);this.m_icon.skin=r.ItemUtils.getBossIccon(n.id),this.lab_bossName.text=n.name,this.onUpdateHpHandler(e.bossuid),h.E.ins.on(l.EventName.SUMMON_BOSS_INFO_CHANGED,this,this.onUpdateHpHandler)}},t.prototype.onUpdateHpHandler=function(e){this._info&&this._info.bossuid==e&&(this.img_progress.scaleX=this._info.HP/100,this.txt_progress.text=this._info.HP+"/100")},t.prototype.onRenderItemListHandler=function(e,t){i.ItemCellUtils.fillCellForItemNameView(e,e.dataSource,1)},t.prototype.onListeMouseHandler=function(e,t){e.type==laya.events.Event.CLICK&&n.ItemTips.ins.showTip(this.list_item.dataSource[t],1)},t.prototype.doFightBoss=function(){if(c.PlayManager.type!=m.EPlayType.PLAYTYPE_SUMMONBOSS){if(!y.StateManger.isSpecialPlay())if(s.RoleCenter.instans.bagRoomEnough()){var e=s.RoleCenter.instans.vo,t=this._info;if(t){var i=e.summonBossListIndexof(t.bossuid),n=e.getSummonBossList();if(-1==i||n[i].bossState==a.EFSBossState.DEATH)return h.E.ins.event(l.EventName.SUMMON_BOSS_LIST_CHANGED),void d.FE.upItems(v.TextConst.get(307),f.BubbleEnum.center);h.E.ins.event(l.EventName.PLAY_TYPE_CHANGE,u.PlayTypeVo.create(m.EPlayType.PLAYTYPE_SUMMONBOSS,t)),n[i].bossState=a.EFSBossState.HAVE_CHALLENGED,g.LayerManager.closeAllPOPWindow()}}else p.AM.showBagNotEnough()}else d.FE.upItems(v.TextConst.get(574),f.BubbleEnum.center)},t}(ui.guild.task.item.BossItemUI);t.SummonBossItem=_}),define("src/g/guild/view/task/page/GuildBossPage",["require","exports","../../../../../manager/RoleCenter","src/g/guild/view/task/item/SummonBossItem","../../../../../core/E","../../../../../enum/EventName"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.list_.itemRender=n.SummonBossItem,this.list_.renderHandler=new Laya.Handler(this,this.onRenderListHandler),this.list_.scrollBar.elasticDistance=200,s.E.ins.on(a.EventName.SUMMON_BOSS_LIST_CHANGED,this,this.refreshData)},t.prototype.refreshData=function(){this.displayedInStage&&(this.list_.array=i.RoleCenter.instans.vo.getSummonBossList())},t.prototype.onRenderListHandler=function(e,t){e.setData(this.list_.array[t])},t}(ui.guild.task.bossPageUI);t.GuildBossPage=o}),define("src/g/guild/ctrl/task/page/GuildBossPageCtrl",["require","exports","src/g/guild/view/task/page/GuildBossPage","../../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){},e.prototype.showPage=function(e,t){void 0===t&&(t=null),e.removeChildren(),this._view||(this._view=new i.GuildBossPage),e.addChild(this._view),this.refreshData(),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.changePerson=function(e){},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.GuildBossPageCtrl=s}),define("src/g/guild/ctrl/task/GuildTaskCtrl",["require","exports","src/g/guild/ctrl/task/page/TaskPageCtrl","src/g/guild/view/task/GuildTaskView","../../../../enum/EventName","../../../../core/E","../../../../manager/RuledescManager","src/g/guild/ctrl/task/page/ActivityPageCtrl","src/g/guild/ctrl/task/page/copyPageCtrl","../../../../config/GameConfig","../../../../manager/RoleCenter","../../../../utils/system/FloatEffect","src/g/guild/ctrl/task/page/GuildBossPageCtrl","../../../../manager/GameSocketManager","../../../net/messages/SummonFBossMsg","../../../../utils/ItemUtils","../../../base/BaseCtrl","../../../../plugin/view/ToolTip","../../../../init/TextConst","../../../../init/Switches","../../../accessctrl/AccessCenter"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(t){function e(){var e=t.call(this)||this;return e._nowSelectPage=0,e._selectIndex=0,e.urls=["res/atlas/res/society.json","res/atlas/res/society/character.json"],a.E.ins.on(s.EventName.OPEN_SOCIETYTASK,e,e.showView),a.E.ins.on(s.EventName.REFRESH_FTASK,e,e.refreshData),a.E.ins.on(s.EventName.SOCIETY_CLOSE_TASK,e,e.hideView),g.GSM.ins.on(p.FSummonBossGS2C.KEY,e,e.onBossCallBack),_.Switches.ins.on(C.enumAccessId.familyTask,e,e.showView,[0]),e}return __extends(e,t),e.prototype.onBossCallBack=function(e){var t=!1;-1==u.RoleCenter.instans.vo.updateSummonBoss(e)&&0==e.passtime&&(t=!0),e.bossState==p.EFSBossState.DEATH&&(t=!0),t&&this.sendChatAndBullet(e),0<u.RoleCenter.instans.vo.lastUseBossCellItemId&&-1!=u.RoleCenter.instans.vo.nickname.indexOf(e.username)&&e.bossState!=p.EFSBossState.DEATH&&(u.RoleCenter.instans.vo.ufVo.summonBossCnt++,a.E.ins.event(s.EventName.OPEN_SOCIETYTASK,2),u.RoleCenter.instans.vo.lastUseBossCellItemId=0)},e.prototype.sendChatAndBullet=function(e){e.bossState==p.EFSBossState.DEATH?this.getDeathChatContent(e):this.getCallBossChatContent(e)},e.prototype.getBossName=function(e){var t=h.GameConfig.getPortByID(e.portid);if(t){var i=t.boss[0],n=m.ItemUtils.getMonsterVOById(i);if(n)return n.name}return null},e.prototype.getDeathChatContent=function(e){var t=this.getBossName(e);return t?"@3@"+t:null},e.prototype.getCallBossChatContent=function(e){var t=m.ItemUtils.getItemVoById(e.itemid);t&&t.name,this.getBossName(e);return"@2@"},e.prototype.initView=function(){this._view=new n.GuildTaskView,this._task=new i.TaskPageCtrl,this._activity=new r.ActivityPageCtrl,this._copyPage=new l.copyPageCtrl,this._bossPage=new d.GuildBossPageCtrl,this._view.viewbg.btn_back.on(Laya.Event.CLICK,this,this.hideView),this._view.viewbg.btn_close.on(Laya.Event.CLICK,this,this.hideView),this._view.tab_page.selectHandler=new Laya.Handler(this,this.changePage),this._view.tab_page.selectedIndex=this._nowSelectPage,this._view.viewbg.btn_help.on(Laya.Event.CLICK,this,this.onClick,[15])},e.prototype.onClick=function(e){o.RuledescManager.showRuledesc(e)},e.prototype.refreshData=function(){this._page&&this._page.refreshData()},e.prototype.changePage=function(e){void 0===e&&(e=0);var t=this._nowSelectPage;switch(this._nowSelectPage=e){case 0:this._view.viewbg.btn_help.visible=!1,this._page=this._task;break;case 1:this._view.viewbg.btn_help.visible=!1,this._page=this._activity;break;case 2:this._view.viewbg.btn_help.visible=!1,this._page=this._bossPage;break;case 3:if(u.RoleCenter.instans.ufVo.selfFamily.flvl<h.GameConfig.FamilySettingVo.mijing_openLevel){this._nowSelectPage=t,c.FE.upItems(v.TextConst.get(532,3),y.BubbleEnum.center),this._view.tab_page.selectedIndex=t;break}this._view.viewbg.btn_help.visible=!0,this._page=this._copyPage}this._page.showPage(this._view.viewbg.box_page)},e.prototype.showView=function(e){void 0===e&&(e=0),this._selectIndex=e,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenRoleView()},e.prototype.realOpenRoleView=function(){this._view||this.initView(),this._view.showView(),this._view.tab_page.selectedIndex==this._selectIndex?this.changePage(this._selectIndex):this._view.tab_page.selectedIndex=this._selectIndex},e.prototype.hideView=function(){this._view.hideView()},e}(f.BaseCtrl);t.GuildTaskCtrl=w}),define("src/g/guild/View/skill/GuildSkillView",["require","exports","../../../../manager/RoleCenter","../../../../utils/ItemUtils","../../../../manager/LayerManager","../../../clearRes/ClearResM","../../../itemGets/View/ItemGetDlg","../../../net/messages/sbkFormula","../../../../init/TextConst","../../../../vo/RedDot/RedDot_Guild"],function(e,t,y,v,i,n,s,_,C,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.nowSelectHero=0,e.nowSelectSkill=0,e.ufvo=y.RoleCenter.instans.ufVo,e.needId=0,e.item_cost.setJump(C.TextConst.get(481),new Laya.Handler(e,e.onShowGet)),e}return __extends(e,t),e.prototype.onShowGet=function(){var e=v.ItemUtils.getItemVoById(this.needId);(new s.ItemGetDlg).initByVo(e,null).popup()},e.prototype.refreshData=function(){var e=this.nowSelectHero;this.hf=this.ufvo._ufdata.heroFSkill[e],this.showSkillBase(),this.showSkillNowAttr(),this.tab_head.refreshHeadRedHint(a.RedDot_Guild.Ins.getSkillRed(!0));for(var t=a.RedDot_Guild.Ins.getSkillRedByHero(e,!0),i=0;i<3;i++)this["skill_"+i].img_red.visible=t[i]},e.prototype.showSkillBase=function(){var e=this.hf.skillLvl[this.nowSelectSkill],t=v.ItemUtils.getFamilySkills(this.nowSelectSkill+1,1);this.skill_show.img_skill.skin=v.ItemUtils.getSkillIconByIconId(t.icon),this.lab_desc.text=t.des,this.img_skillName.skin="res/society/skill/"+t.name+".png",this.clip_lv.value=e+""},e.prototype.showSkillNowAttr=function(){var e=this.nowSelectSkill,t=this.hf.skillLvl[e],i=v.ItemUtils.getFamilySkills(e+1,t),n=v.ItemUtils.getFamilySkills(e+1,t+1);if(0==t)for(var s=n.effect,a=0;a<3;a++){var o=this["attr_"+a];if(s[a]){o.visible=!0,o.lab_left.text=C.TextConst.get(485);var r="%"==(h=v.ItemUtils.getShuXingByName(s[a][0])).unit?s[a][1]/100:s[a][1];o.lab_right.text=h.desc+": "+r+h.unit}else o.visible=!1}else{var l=i.effect;for(a=0;a<3;a++){o=this["attr_"+a];if(l[a]){o.visible=!0;var h;r="%"==(h=v.ItemUtils.getShuXingByName(l[a][0])).unit?l[a][1]/100:l[a][1];if(o.lab_left.text=h.desc+": "+r+h.unit,n){var u=n.effect,c="%"==h.unit?u[a][1]/100:u[a][1];o.lab_right.text=h.desc+": "+c+h.unit}else o.lab_right.text=C.TextConst.get(208)}else o.visible=!1}}var d=n?n.cost:i.cost,g=v.ItemUtils.getItemVoById(d[0][0]),p=y.RoleCenter.instans.vo.bagdata.getItemCount(g.id),m=d[0][1];this.item_cost.setNeedName(g.name,v.ItemUtils.getSmallIcon(g.icon)),this.item_cost.setQualColor(v.ItemUtils.getColorByQuality(g.quality)),this.item_cost.setNeed(p,m),this.needId=g.id,this.btn_lean.disabled=t+1==301||p<m;var f=y.RoleCenter.instans.vo.getOpenHeroByIdx(this.nowSelectHero);this.box_fight.setFightNum(_.sbkFormula.calCombat(0,f.prop_familySkill.HP,f.prop_familySkill.ATT,f.prop_familySkill.PDEF,f.prop_familySkill.SDEF,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0))},e.prototype.changePerson=function(e){void 0===e&&(e=0),this.nowSelectHero=e,this.refreshData()},e.prototype.changeSkill=function(e){void 0===e&&(e=0),this.nowSelectSkill=e,this.refreshData()},e.prototype.showView=function(){this.refreshData(),i.LayerManager.addInPOPWindowLayer(this,!0,!0,!0),n.ClearResM.resetViewImg(this)},e.prototype.hideView=function(){this.removeSelf()},e}(ui.guild.skill.guildSkillUI);t.GuildSkillView=o}),define("src/g/guild/ctrl/skill/GuildSkillCtrl",["require","exports","../../../../manager/GameSocketManager","../../../net/messages/UserFamilyDataGS2C","../../../../utils/system/FloatEffect","../../../../utils/ItemUtils","../../../../manager/RoleCenter","../../../../enum/EventName","../../../../core/E","src/g/guild/View/skill/GuildSkillView","../../../../plugin/view/ToolTip","../../../accessctrl/AccessCenter","../../../../vo/RedDot/RedDot_Guild","../../../../init/TextConst","../../../../vo/RedDot/EventRedDot","../../../../init/Switches"],function(e,t,s,a,o,r,l,n,h,u,c,i,d,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(){this._nowSelectHero=0,this._nowSelectSkill=0,h.E.ins.on(n.EventName.OPEN_SOCIETYSKILLS,this,this.openView),h.E.ins.on(n.EventName.SOCIETY_CHANGESKILL,this,this.refreshData),h.E.ins.on(n.EventName.SOCIETY_CHANGEGHGX,this,this.refreshData),h.E.ins.on(p.EventRedDot.REFRESH_GUILDSKILL,this,this.refreshRedHead),h.E.ins.on(n.EventName.CHANGEITEM_COUNT,this,this.onChangeItemCount)}return e.prototype.onChangeItemCount=function(e){166!=e&&167!=e&&168!=e||this.refreshData()},e.prototype.refreshRedHead=function(){this._view&&this.refreshData(!1)},e.prototype.initView=function(){this._view=new u.GuildSkillView,this._view.viewbg.btn_help.visible=!1,this._view.tab_head.initData(l.RoleCenter.instans.self.openhero,0,l.RoleCenter.instans.vo),this._view.viewbg.btn_back.on(Laya.Event.CLICK,this,this.hideView),this._view.viewbg.btn_close.on(Laya.Event.CLICK,this,this.hideView),this._view.btn_lean.on(Laya.Event.CLICK,this,this.leanGuildSkill),this._view.tab_head.setCallbackHandler(new Laya.Handler(this,this.heroSelect)),h.E.ins.on(n.EventName.OPENNEW_HERO,this,this.refreshHeroHeadShow);for(var e=0;e<3;e++){var t=this._view["skill_"+e];t.on(Laya.Event.CLICK,this,this.changeList,[e]);var i=r.ItemUtils.getFamilySkills(e+1,1);t.img_select.visible=!1,t.img_skill.skin=r.ItemUtils.getSkillIconByIconId(i.icon)}},e.prototype.leanGuildSkill=function(){var e=l.RoleCenter.instans.vo,t=l.RoleCenter.instans.vo.ufVo._ufdata.heroFSkill[this._nowSelectHero].skillLvl[this._nowSelectSkill],i=r.ItemUtils.getFamilySkills(this._nowSelectSkill+1,t+1);if(i)if(e[i.cost[0][0]]<i.cost[0][1])o.FE.upItems(g.TextConst.get(520),c.BubbleEnum.center);else{var n=new a.UpgradeHeroFSkillC2GS;n.heroidx=this._nowSelectHero,n.skillID=this._nowSelectSkill+1,s.GSM.sendServer(n)}else o.FE.upItems(g.TextConst.get(208),c.BubbleEnum.center)},e.prototype.refreshData=function(e){void 0===e&&(e=!0),e&&d.RedDot_Guild.Ins.reCheckAll(),this._view&&this._view.refreshData()},e.prototype.refreshHeroHeadShow=function(){this._view.tab_head.initData(l.RoleCenter.instans.self.openhero,this._nowSelectHero,l.RoleCenter.instans.vo)},e.prototype.changeList=function(e){this._nowSelectSkill=e;for(var t=0;t<3;t++){this._view["skill_"+t].img_select.visible=t==e}this._view.changeSkill(e)},e.prototype.heroSelect=function(e,t){l.RoleCenter.instans.self.openhero[e]?(this._nowSelectHero=e,this._view.tab_head.setSelectIndex(e),this._view.changePerson(e)):m.Switches.ins.event(i.enumAccessId.partner)},e.prototype.openView=function(){this._view||this.initView(),this._view.showView(),this.changeList(this._nowSelectSkill),this.refreshData()},e.prototype.hideView=function(){this._view.hideView()},e}();t.GuildSkillCtrl=f;var y=function(){this.icon=0,this.select=!1};t.gsvo=y}),define("src/g/guild/view/manage/GuildManageView",["require","exports","../../../../manager/LayerManager","../../../../core/E","../../../../enum/EventName"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function e(){var e=t.call(this)||this;return n.E.ins.on(s.EventName.SOCIETY_CLOSE_MANAGE,e,e.hideView),e.viewbg.img_bg.skin="res/custom/beibao_ditubeijing2.png",e}return __extends(e,t),e.prototype.showView=function(){i.LayerManager.addInPOPWindowLayer(this,!0,!0,!0)},e.prototype.hideView=function(){this.viewbg.box_page.removeChildren(),this.removeSelf()},e}(ui.guild.manage.guildManageBgUI);t.GuildManageView=a}),define("src/g/guild/view/manage/ChangeNoticeDlg",["require","exports","../../../../utils/system/FloatEffect","../../../../config/GameConfig","../../../../manager/RoleCenter","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg","../../../../plugin/view/ToolTip","../../../../init/TextConst"],function(e,t,n,s,i,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){function e(){var e=t.call(this)||this;return e.ufvo=i.RoleCenter.instans.ufVo,e.lab_notice.text=e.ufvo.notice,e.addEvent(),e}return __extends(e,t),e.prototype.addEvent=function(){this.btn_changeNotice.on(Laya.Event.CLICK,this,this.changenotice),this.bg.btn_close.on(Laya.Event.CLICK,this,this.close)},e.prototype.changenotice=function(){var e=this.lab_notice.text,t=s.GameConfig.FamilySettingVo;if(e!=this.ufvo.notice)if(e.length>t.noticeMax)n.FE.upItems(l.TextConst.get(545),r.BubbleEnum.center);else{var i=new o.FChangeNotice;i.newNotice=this.lab_notice.text,a.GSM.sendServer(i),this.close()}else this.close()},e}(ui.guild.manage.ChangeNoticeDlgUI);t.ChangeNoticeDlg=h}),define("src/g/guild/view/manage/ApplyListDlg",["require","exports","../../../../core/E","../../../../enum/EventName","../../../../manager/RoleCenter","../../../net/messages/OpNoParaC2GS","../../../net/messages/ManageFamilyMsg","../../../../manager/GameSocketManager","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){function e(){var e=t.call(this)||this;return e.ufvo=s.RoleCenter.instans.ufVo,e.addEvent(),e.refreshData(),e}return __extends(e,t),e.prototype.addEvent=function(){i.E.ins.on(n.EventName.SOCIETY_APPLYLISTCHANGE,this,this.refreshData),this.list_.renderHandler=new Laya.Handler(this,this.renderHandler),this.btn_back.on(Laya.Event.CLICK,this,this.close),this.btn_close.on(Laya.Event.CLICK,this,this.close),this.box_auto.on(Laya.Event.CLICK,this,this.onAutoCheck)},e.prototype.refreshData=function(){this.img_gou.visible=this.ufvo.autoJoin,null!=this.ufvo.selfFamily&&(this.lab_input.text=this.ufvo.selfFamily.combatLimit+""),this.list_.dataSource=s.RoleCenter.instans.ufVo.ApplyList},e.prototype.onAutoCheck=function(){this.img_gou.visible=!this.img_gou.visible},e.prototype.renderHandler=function(e,t){var i=e.dataSource,n=i.combat;e.lab_fightNum.text=1e5<n?l.TextConst.get(1,(n/1e4).toFixed(1)):n+"",e.setName(i.nickname),e.btn_fail.clickHandler=new Laya.Handler(this,this.fAgreeFunc,[!1,i.username,i.nickname]),e.btn_ok.clickHandler=new Laya.Handler(this,this.fAgreeFunc,[!0,i.username,i.nickname])},e.prototype.fAgreeFunc=function(e,t,i){var n=new o.FAgreeJoinInC2GS;n.username=t,n.nickname=i,n.agree=e,r.GSM.sendServer(n)},e.prototype.checkChange=function(){this.img_gou.visible!=this.ufvo.autoJoin&&((e=new a.OpNoParaC2GS).optype=this.img_gou.visible?a.EOpNopara.openAutoJoin:a.EOpNopara.closeAutoJoin,r.GSM.sendServer(e));var e,t=parseInt(this.lab_input.text);t!=this.ufvo.selfFamily.combatLimit&&((e=new o.FChangeMinCombatC2GS).combat=t,r.GSM.sendServer(e))},e.prototype.close=function(){this.checkChange(),t.prototype.close.call(this)},e}(ui.guild.manage.ApplyListDlgUI);t.ApplyListDlg=h}),define("src/g/guild/view/manage/BasePage",["require","exports","src/g/guild/view/manage/ChangeNoticeDlg","src/g/guild/view/manage/ApplyListDlg","../../../../utils/ItemUtils","../../../net/messages/ManageFamilyMsg","../../../../manager/RoleCenter","../../../Effects/UIEffectsFactory","../../../Effects/UIEffectsEnum","../../../../vo/RedDot/RedDot_Guild","../../../../utils/system/DateUitl","../../../../utils/system/FloatEffect","../../../../config/GameConfig","../../../../init/TextConst"],function(e,t,i,n,a,s,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e.addEvent(),e}return __extends(e,t),e.prototype.onLoadUIEF=function(){this.ani_put=r.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.btn_applyList,l.UIEffectsEnum.getTip_Big,1,.7),this.ani_put.visible=!1},e.prototype.showAni=function(e){this.ani_put.visible=e},e.prototype.addEvent=function(){this.list_.renderHandler=new Laya.Handler(this,this.renderHandler),this.btn_applyList.on(Laya.Event.CLICK,this,this.openAppList),this.btn_changeNotice.on(Laya.Event.CLICK,this,this.openChangeNotice),this.onLoadUIEF()},e.prototype.openAppList=function(){(new n.ApplyListDlg).popup()},e.prototype.openChangeNotice=function(){this.checkLimit()&&(new i.ChangeNoticeDlg).popup()},e.prototype.checkLimit=function(){var e=d.GameConfig.commonJson.familyDescribe;if(e){var t=0,i=0,n=e.value.split(",");if(0<n.length&&(i=Number(n[0])),1<n.length&&(t=Number(n[1])),u.DateUtil.getKFDay()<i)return c.FE.upItems(g.TextConst.get(543,i)),!1;if(o.RoleCenter.instans.vo.VIP<t)return c.FE.upItems(g.TextConst.get(544,t)),!1}return!0},e.prototype.refreshData=function(){this.ufvo=o.RoleCenter.instans.ufVo,this.showBase(),this.btn_changeNotice.visible=!1,window.enabledpay&&this.checkBtnShow(),this.showMemberList(),this.showAni(h.RedDot_Guild.Ins.checkApplyList())},e.prototype.showBase=function(){var e=this.ufvo,t=a.ItemUtils.getFamilylevelById(e.selfFamily.flvl);this.lab_guildName.text=e.selfFamily.fname,this.lab_manageName.text=e.selfFamily.chairmanNicname,this.lab_guildLv.text=e.selfFamily.flvl+"";var i=e.familyMemberList;this.lab_peopleNum.text=(i?i.length:0)+"/"+t.membercount,this.lab_canUse.text=o.RoleCenter.instans.vo.GHGX+"",this.lab_notice.text=e.notice,this.setBar()},e.prototype.setBar=function(){var e=a.ItemUtils.getFamilylevelById(this.ufvo.selfFamily.flvl),t=null==e.upgrade,i=this.ufvo.selfFamily.ffund;this.lab_money.text=i+"/"+(e.upgrade||0);var n=338/(e.upgrade||1),s=t?338:(n||1)*i;338<s&&(s=338),this.pan_bar.width=s},e.prototype.checkBtnShow=function(){var e=this.ufvo._ufdata.familyPosition;this.btn_applyList.visible=e==s.EFPosition.CHAIRMAN||e==s.EFPosition.VICECHAIRMAN,this.btn_changeNotice.visible=e==s.EFPosition.CHAIRMAN},e.prototype.showMemberList=function(){this.list_.dataSource=this.ufvo.familyMemberList},e.prototype.renderHandler=function(e,t){var i=e.dataSource;e.lab_idx.text=t+1+"",e.setName(i.nickname),e.setJob(a.ItemUtils.getFamilyOrderById(i.familyPosition).name),e.setHistory(i.contributionTotal)},e}(ui.guild.manage.basePageUI);t.BasePage=p}),define("src/g/guild/ctrl/manage/BasePageCtrl",["require","exports","../../../../manager/RoleCenter","src/g/guild/view/manage/BasePage","../../../../core/E","../../../../enum/EventName","../../../../init/ResManager","../../../clearRes/ClearResM"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype.init=function(){this._view=new n.BasePage,this.addEvent()},e.prototype.addEvent=function(){s.E.ins.on(a.EventName.SOCIETY_APPLYLISTCHANGE,this,this.refreshData)},e.prototype.showPage=function(e,t){e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),r.ClearResM.resetViewImg(this._view)},e.prototype.refreshData=function(){null!=this._view&&null!=i.RoleCenter.instans.ufVo.selfFamily&&this._view.refreshData()},e.prototype.getTitle=function(){return""},e.prototype.changePerson=function(e){},e.prototype.hidePage=function(){o.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){o.ResManager.getInstance().destroyPageCtrl(this)},e}();t.BasePageCtrl=l}),define("src/g/guild/view/manage/ListPage",["require","exports","../../../../utils/ItemUtils","../../../../manager/RoleCenter"],function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.adddEvent(),e}return __extends(e,t),e.prototype.adddEvent=function(){this.list_.renderHandler=new Laya.Handler(this,this.renderHandler)},e.prototype.refresData=function(){this.list_.dataSource=i.RoleCenter.instans.ufVo.familyList},e.prototype.renderHandler=function(e,t){var i=e.dataSource;e.setIdx(t+1),e.setManageName(i.chairmanNicname),e.setSocietyName(i.fname,i.flvl);var n=s.ItemUtils.getFamilylevelById(i.flvl);e.setPepleNum(i.members,n.membercount),e.btn_apply.visible=!1,e.lab_fightNum.visible=!1},e}(ui.guild.manage.listPageUI);t.ListPage=n}),define("src/g/guild/ctrl/manage/ListPageCtrl",["require","exports","src/g/guild/view/manage/ListPage","../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){this._view=new i.ListPage,this.addEvent()},e.prototype.addEvent=function(){},e.prototype.showPage=function(e,t){e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view.refresData()},e.prototype.getTitle=function(){return""},e.prototype.changePerson=function(e){},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.ListPageCtrl=s}),define("src/g/guild/view/manage/MakeOverDlg",["require","exports","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg","../../../../init/TextConst"],function(e,t,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e){var t=i.call(this)||this;return t.nowselect=-1,t.targetList=[],t.targetList=e,t.lab_tip.style.fontSize=22,t.addEvent(),t.init(),t}return __extends(e,i),e.prototype.init=function(){var e=a.TextConst.get(546);this.lab_tip.innerHTML=e;for(var t=0;t<this.targetList.length;t++){var i=this["item_"+t],n=i.getChildByName("lab_"),s=i.getChildByName("img_gou");n.text=this.targetList[t].nickname,s.visible=!1,i.visible=!0}},e.prototype.addEvent=function(){for(var e=0;e<this.targetList.length;e++){this["item_"+e].on(Laya.Event.CLICK,this,this.changeSelect,[e])}this.btn_ok.on(Laya.Event.CLICK,this,this.onOkCall),this.bg.btn_back.on(Laya.Event.CLICK,this,this.close),this.bg.btn_close.on(Laya.Event.CLICK,this,this.close)},e.prototype.changeSelect=function(e){void 0===e&&(e=0),this.nowselect=e;for(var t=0;t<4;t++){var i=this["item_"+t].getChildByName("img_gou");e==t&&1==i.visible?(i.visible=!1,this.nowselect=-1):(i.visible=e==t,e==t&&(this.nowselect=t))}},e.prototype.onOkCall=function(){if(-1!=this.nowselect){var e=new s.FChangeOrderC2GS;e.username=this.targetList[this.nowselect].username,e.nickname=this.targetList[this.nowselect].nickname,e.newOrder=s.EFPosition.CHAIRMAN,n.GSM.sendServer(e),this.close()}else this.close()},e}(ui.guild.manage.AppointDlgUI);t.MaketOverDlg=i}),define("src/g/guild/view/manage/ApointDlg",["require","exports","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg","../../../../utils/ItemUtils","../../../../manager/RoleCenter","../../../../init/TextConst"],function(e,t,s,a,l,o,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function e(e,t){var i=n.call(this)||this;return i.uname="",i.nname="",i.nowselect=-1,i.lab_tip.style.fontSize=22,i.uname=e,i.nname=t,i.ufvo=o.RoleCenter.instans.ufVo,i.addEvent(),i.init(),i}return __extends(e,n),e.prototype.init=function(){this.lab_tip.style.font="SimHei",this.lab_tip.style.fontSize=20,this.lab_tip.innerHTML=h.TextConst.get(542,this.nname);for(var e={},t=0;t<this.ufvo.familyMemberList.length;t++){var i=this.ufvo.familyMemberList[t];e[i.familyPosition]?e[i.familyPosition]++:e[i.familyPosition]=1}var n,s=6-parseInt(this.ufvo._ufdata.familyPosition+"");for(t=parseInt(this.ufvo._ufdata.familyPosition+"")+1;t<=s;t++){n=l.ItemUtils.getFamilyOrderById(t);var a=this["item_"+(t-this.ufvo._ufdata.familyPosition-1)],o=a.getChildByName("img_gou"),r=a.getChildByName("lab_");a.visible=!0,o.visible=!1,null==n.count||0==n.count?(a.name="-1",r.text=n.name):(a.name=n.count-(e[n.id]||0)+"",r.text=n.name+"("+(n.count-parseInt(a.name))+"/"+n.count+")"),o.familyPosition=n.id+""}},e.prototype.addEvent=function(){for(var e=0;e<4;e++){this["item_"+e].on(Laya.Event.CLICK,this,this.changeSelect,[e])}this.btn_ok.on(Laya.Event.CLICK,this,this.onOkCall),this.bg.btn_back.on(Laya.Event.CLICK,this,this.close),this.bg.btn_close.on(Laya.Event.CLICK,this,this.close)},e.prototype.changeSelect=function(e){void 0===e&&(e=0);for(var t=0;t<4;t++){this["item_"+t].getChildByName("img_gou").visible=!1}var i=this["item_"+e],n=i.getChildByName("img_gou");e==this.nowselect?(n.visible=!1,this.nowselect=-1):0==parseInt(i.name)?(n.visible=!1,this.nowselect=-1):(this.nowselect=e,n.visible=!0)},e.prototype.onOkCall=function(){if(-1!=this.nowselect){var e=this["item_"+this.nowselect].getChildByName("img_gou"),t=parseInt(e.familyPosition),i=new a.FChangeOrderC2GS;i.username=this.uname,i.nickname=this.nname,i.newOrder=t,s.GSM.sendServer(i),this.close()}else this.close()},e}(ui.guild.manage.AppointDlgUI);t.ApointDlg=i}),define("src/g/guild/view/manage/peoplePage",["require","exports","../../../../config/GameConfig","../../../../utils/system/FloatEffect","src/g/guild/view/manage/MakeOverDlg","src/g/guild/view/manage/ApointDlg","../../../../manager/AM","../../../../manager/GameSocketManager","../../../net/messages/OpNoParaC2GS","../../../net/messages/ManageFamilyMsg","../../../../utils/ItemUtils","../../../../manager/RoleCenter","../../../../enum/EventName","../../../../core/E","../../../net/messages/friend/FriendData","../../../friend/ctrl/FriendsDataManager","../../../../plugin/view/ToolTip","../../../fight/osprite/play/family/SandCityFManager","../../../accessctrl/AccessCenter","../../../fight/osprite/play/worldboss/WorldBossManager","../../../../utils/system/ServerTime","../../../clearRes/ClearResM","../../../../manager/StateManger","../../../../init/TextConst","../../../../init/Switches"],function(e,t,m,f,o,r,y,s,a,v,_,C,i,n,l,h,w,I,u,c,b,d,g,S,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(t){function e(){var e=t.call(this)||this;return e.addEvent(),e}return __extends(e,t),e.prototype.addEvent=function(){this.list_.renderHandler=new Laya.Handler(this,this.renderHandler),this.btn_level.on(Laya.Event.CLICK,this,this.onExitFamily)},e.prototype.onExitFamily=function(){g.StateManger.isSpecialPlay()||(I.SandCityFManager.getInstance().checkIsOpenSCF()?f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center):y.AM.show(S.TextConst.get(548),new Laya.Handler(this,this.exitFamily)))},e.prototype.exitFamily=function(){if(I.SandCityFManager.getInstance().checkIsOpenSCF())f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center);else if(-1!=c.WorldBossManager.getInstance().openId&&f.FE.upItems(S.TextConst.get(549),w.BubbleEnum.center),this.ufvo._ufdata.familyPosition==v.EFPosition.CHAIRMAN&&1!=this.ufvo.familyMemberList.length)f.FE.upItems(S.TextConst.get(550),w.BubbleEnum.center);else{var e=new a.OpNoParaC2GS;e.optype=a.EOpNopara.exitFamily,s.GSM.sendServer(e)}},e.prototype.refreshData=function(){this.ufvo=C.RoleCenter.instans.ufVo,this.showBase();for(var e=[],t=[],i=[],n=this.ufvo.familyMemberList,s=0;s<n.length;s++){switch(n[s].familyPosition){case v.EFPosition.CHAIRMAN:case v.EFPosition.VICECHAIRMAN:e.push(n[s]);continue}1==n[s].online?t.push(n[s]):i.push(n[s])}i=i.sort(this.sortTime),t=t.sort(this.combat),e=e.concat(t).concat(i),this.list_.dataSource=e,d.ClearResM.resetViewImg(this)},e.prototype.combat=function(e,t){return t.combat-e.combat},e.prototype.sortTime=function(e,t){return t.offlinetime-e.offlinetime},e.prototype.showBase=function(){var e=_.ItemUtils.getFamilyOrderById(this.ufvo._ufdata.familyPosition);e&&(this.lab_position.text=e.name);var t=this.ufvo.getMemberByUname(C.RoleCenter.instans.vo.username);t&&t.contributionTotal?this.lab_history.text=t.contributionTotal+"":this.lab_history.text="0"},e.prototype.onHeadClickHandler=function(e){if(e.username!=C.RoleCenter.instans.vo.username){var t=h.FriendsDataManager.ins.getFriendDataByUsername(e.username);t||((t=new l.FriendData).username=e.username,t.nickname=e.nickname,t.sex=e.sex,t.jobid=e.job,t.level=0,t.familyname=C.RoleCenter.instans.ufVo.selfFamily.fname),n.E.ins.event(i.EventName.OPEN_FRIENDS_MENU_DIALOG,t)}},e.prototype.setTime=function(e,t,i,n){if(void 0===i&&(i=!1),-1!=t){if(!i){e.lab_time.color="#ff0f15";var s=n-t;return s<60?void(e.lab_time.text=S.TextConst.get(12,1)):s<3600?void(e.lab_time.text=S.TextConst.get(12,Math.floor(s/60))):s<172800?void(e.lab_time.text=S.TextConst.get(9,Math.floor(s/60/60))):void(e.lab_time.text=S.TextConst.get(9,48))}e.lab_time.text=S.TextConst.get(501),e.lab_time.color="#09d51f"}else e.lab_time.text=""},e.prototype.renderHandler=function(e,t){var i=this,n=e.dataSource,s=n.nickname,a=n.username,o=n.familyPosition,r=this.ufvo._ufdata.familyPosition,l=r==v.EFPosition.CHAIRMAN||r==v.EFPosition.VICECHAIRMAN;e.item_.img_job.visible=!1,e.item_.img_head.skin=_.ItemUtils.getHeadurlYuan(n.sex,n.job),e.item_.offAll(),e.item_.on(Laya.Event.CLICK,this,this.onHeadClickHandler,[n]);var h=_.ItemUtils.getFamilyOrderById(o);e.setName(h.name,s),e.setContribution(n.contribution),a==C.RoleCenter.instans.vo.username&&(n.online=!0),this.setTime(e,n.offlinetime,n.online,b.ServerTime.serverTime);var u=n.combat,c=!1;if(s==C.RoleCenter.instans.vo.nickname)u=C.RoleCenter.instans.vo.combat,e.btn_makeover.visible=!1,e.btn_appoint.visible=!1,e.btn_expel.visible=!1,o==v.EFPosition.CHAIRMAN&&(c=!1,e.btn_makeover.visible=!0,e.btn_makeover.clickHandler=e.btn_appoint.clickHandler=new Laya.Handler(this,this.appointPeople,[a,s,!0]));else{if(e.btn_makeover.visible=!1,e.btn_appoint.visible=!1,e.btn_expel.visible=!1,o==v.EFPosition.CHAIRMAN){172800<b.ServerTime.serverTime-n.offlinetime&&0==n.online?(c=!0,e.btn_makeover.visible=!0,e.btn_makeover.clickHandler=new Laya.Handler(this,function(){I.SandCityFManager.getInstance().checkIsOpenSCF()?f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center):y.AM.show(S.TextConst.get(551,m.GameConfig.FamilySettingVo.impeachment),new Laya.Handler(i,i.tanHePeople,[a,s]))})):(c=!0,e.btn_makeover.visible=!0,e.btn_makeover.clickHandler=new Laya.Handler(this,function(){I.SandCityFManager.getInstance().checkIsOpenSCF()?f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center):f.FE.upItems(S.TextConst.get(552),w.BubbleEnum.center)}))}var d=_.ItemUtils.getFamilyOrderById(this.ufvo._ufdata.familyPosition),g=_.ItemUtils.getFamilyOrderById(o);if(g&&d&&g.id&&d.id<g.id){if(null==d.order||d.order.length<=0)return;0<=d.order.indexOf(v.EFAuthority.TiShengGuanZhi)&&(e.btn_appoint.visible=!0,e.btn_appoint.clickHandler=new Laya.Handler(this,this.appointPeople,[a,s,!1])),0<=d.order.indexOf(v.EFAuthority.QingLiGongHui)&&(e.btn_expel.visible=!0,e.btn_expel.clickHandler=new Laya.Handler(this,function(){I.SandCityFManager.getInstance().checkIsOpenSCF()?f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center):y.AM.show(S.TextConst.get(553,s),new Laya.Handler(i,i.expelPeople,[a,s]))}))}}e.lab_fightNum.text=""+(1e5<u?S.TextConst.get(1,(u/1e4).toFixed(1)):u+""),e.btn_makeover.label=c?S.TextConst.get(801):S.TextConst.get(802);var p=!1;l&&(p=!0),e.lab_time.visible=p},e.prototype.appointPeople=function(e,t,i){if(void 0===i&&(i=!1),i){for(var n=[],s=0;s<this.ufvo.familyMemberList.length;s++){var a=this.ufvo.familyMemberList[s];a.familyPosition==v.EFPosition.VICECHAIRMAN&&n.push(a)}if(I.SandCityFManager.getInstance().checkIsOpenSCF())return void f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center);if(0<n.length)new o.MaketOverDlg(n).popup();else f.FE.upItems(S.TextConst.get(554),w.BubbleEnum.center)}else{if(I.SandCityFManager.getInstance().checkIsOpenSCF())return void f.FE.upItems(S.TextConst.get(547),w.BubbleEnum.center);new r.ApointDlg(e,t).popup()}},e.prototype.tanHePeople=function(e,t){var i=m.GameConfig.FamilySettingVo;if(C.RoleCenter.instans.vo.GOLD>=i.impeachment){var n=new a.OpNoParaC2GS;n.optype=a.EOpNopara.impeachChairMan,s.GSM.sendServer(n)}else Laya.timer.once(100,this,function(){p.Switches.ins.event(u.enumAccessId.goldInsufficient)})},e.prototype.expelPeople=function(e,t){var i=new v.FKickOutC2GS;i.username=e,i.nickname=t,s.GSM.sendServer(i)},e}(ui.guild.manage.peoplePageUI);t.PeoplePage=E}),define("src/g/guild/ctrl/manage/PeoplePageCtrl",["require","exports","src/g/guild/view/manage/peoplePage","../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){this._view=new i.PeoplePage,this.addEvent()},e.prototype.addEvent=function(){},e.prototype.showPage=function(e,t){e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view.refreshData()},e.prototype.getTitle=function(){return""},e.prototype.changePerson=function(e){},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.PeoplePageCtrl=s}),define("src/g/guild/view/manage/HelpPage",["require","exports","../../../../manager/RoleCenter","../../../field/vo/RevengeVo","../../../../core/GNet","../../../../core/E","../../../../enum/EventName","../../../fight/info/PlayTypeVo","../../../net/messages/ChangeSceneMsg","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../clearRes/ClearResM","../../../../manager/AM","../../../../manager/StateManger","../../../../init/TextConst"],function(e,t,a,o,i,n,s,r,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function e(){var e=t.call(this)||this;return e._revegeid=0,e.addEvent(),c.ClearResM.addBgUrl(e.bgimg.skin),e}return __extends(e,t),e.prototype.addEvent=function(){this.list_help.renderHandler=new Laya.Handler(this,this.HelplistRenderHandler),this.list_log.renderHandler=new Laya.Handler(this,this.LogListRenderHandler),n.E.ins.on(s.EventName.GongHuiFuChouWanCheng,this,this.onGongHuiFuChouWanCheng),n.E.ins.on(s.EventName.REFRESH_FAMILYHELPDATA,this,this.refreshData)},e.prototype.onGongHuiFuChouWanCheng=function(e){if(e.resuult){for(var t=0;t<this.data.helpData.revengeList.length;t++)if(this.data.helpData.revengeList[t].id==e.id&&this.data.helpData.revengeList[t].otherUsername==e.otherUsername){this.data.helpData.revengeList.slice(t,1);break}this.renderHelpList()}},e.prototype.refreshData=function(){this.data=a.RoleCenter.instans.ufVo,this.renderLogList(),this.renderHelpList(),this.renderCanHelpNum(),this.bgimg.restskin()},e.prototype.renderCanHelpNum=function(){this.lab_count.text=p.TextConst.get(20,a.RoleCenter.instans.vo.meetPkData.helpCount)},e.prototype.renderHelpList=function(){if(this.data.helpData&&this.data.helpData.revengeList){for(var e=[],t=0;t<this.data.helpData.revengeList.length;t++){a.RoleCenter.instans.ufVo.getMemberByUname(this.data.helpData.revengeList[t].username)&&e.push(this.data.helpData.revengeList[t])}this.list_help.dataSource=e}else this.list_help.dataSource=[]},e.prototype.renderLogList=function(){this.data.helpData&&this.data.helpData.revengeLogList&&0<this.data.helpData.revengeLogList.length?this.list_log.dataSource=this.data.helpData.revengeLogList:this.list_log.dataSource=[]},e.prototype.LogListRenderHandler=function(e,t){var i=e.dataSource,n=e.getChildByName("html");n.style.font="SimHei",n.style.fontSize=17,n.innerHTML=p.TextConst.get(817,i.helpNickname,i.nickname,i.value)},e.prototype.HelplistRenderHandler=function(e,t){var i=e.dataSource,n=a.RoleCenter.instans.ufVo.getMemberByUname(i.username);if(n){e.setHead(n.job,n.sex),e.setDesc(p.TextConst.get(816,i.nickname,i.otherNickname,o.RevengeVo.getFightTitle(i.type))),e.lab_talk.text=i.msg;var s=a.RoleCenter.instans.vo.username;e.btn_fight.visible=i.username!=s&&i.otherUsername!=s,e.setClickHandler(new Laya.Handler(this,this.helpCallBack,[i.otherUsername,i.id]))}else console.error("取用户数据出错:此人不在公会中")},e.prototype.helpCallBack=function(e,t){a.RoleCenter.instans.bagRoomEnough()?g.StateManger.isSpecialPlay()||(this._revegeid=t,a.RoleCenter.instans.vo.meetPkData.helpCount<=0?h.FE.upItems(p.TextConst.get(820),u.BubbleEnum.center):(this.otherUsername=e,n.E.ins.on(s.EventName.OTHERDATA_UPDATE,this,this.receiveHandler),i.GNet.getOtherData([e]))):d.AM.showBagNotEnough()},e.prototype.receiveHandler=function(){a.RoleCenter.instans.getOtherData(this.otherUsername)&&(n.E.ins.off(s.EventName.OTHERDATA_UPDATE,this,this.receiveHandler),n.E.ins.event(s.EventName.PLAY_TYPE_CHANGE,r.PlayTypeVo.create(l.EPlayType.PLAYTYPE_FIMILYHELPREVENGE,{otherUsername:this.otherUsername,revegeid:this._revegeid})),n.E.ins.event(s.EventName.GuildHelpRevengeBegin))},e}(ui.guild.manage.helpPageUI);t.HelpPage=m}),define("src/g/guild/ctrl/manage/HelpPageCtrl",["require","exports","src/g/guild/view/manage/HelpPage","../../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){this._view=new i.HelpPage},e.prototype.showPage=function(e,t){e.removeChildren(),this._view||this.init(),this.refreshData(),e.addChild(this._view),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.changePerson=function(e,t){},e.prototype.refreshData=function(){this._view.refreshData()},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.HelpPageCtrl=s}),define("src/g/guild/ctrl/manage/GuildManageCtrl",["require","exports","src/g/guild/view/manage/GuildManageView","../../../../core/E","../../../../enum/EventName","src/g/guild/ctrl/manage/BasePageCtrl","src/g/guild/ctrl/manage/ListPageCtrl","src/g/guild/ctrl/manage/PeoplePageCtrl","../../../../manager/GameSocketManager","../../../net/messages/ManageFamilyMsg","../../../net/messages/OpNoParaC2GS","../../../../manager/RoleCenter","src/g/guild/ctrl/manage/HelpPageCtrl","../../../../manager/RuledescManager","../../../accessctrl/AccessCenter","../../../../init/Switches"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(){this._pageIdx=0,n.E.ins.on(s.EventName.OPEN_SOCIETYMANAGE,this,this.showView),n.E.ins.on(s.EventName.GuildHelpRevengeBegin,this,this.hideView)}return e.prototype.initView=function(){this._view=new i.GuildManageView,this._view.viewbg.btn_help.visible=!0,this._view.viewbg.btn_back.on(Laya.Event.CLICK,this,this.hideView),this._view.viewbg.btn_close.on(Laya.Event.CLICK,this,this.hideView),this._view.viewbg.btn_help.on(Laya.Event.CLICK,this,this.helpView),this._view.tab_page.selectHandler=new Laya.Handler(this,this.changePage),this._basePage=new a.BasePageCtrl,this._listPage=new o.ListPageCtrl,this._peoplePageCtrl=new r.PeoplePageCtrl,this._helpPageCtrl=new d.HelpPageCtrl,n.E.ins.on(s.EventName.SOCIETY_FAMILYINFOCHANGE,this,this.refreshData),m.Switches.ins.on(p.enumAccessId.familyHelp,this,this.changePage,[3])},e.prototype.changePage=function(e){switch(void 0===e&&(e=0),e){case 0:this.page=this._basePage,this.helpID=304;break;case 1:this.page=this._peoplePageCtrl,this.helpID=304;break;case 2:this.page=this._listPage,this.helpID=304;break;case 3:this.page=this._helpPageCtrl,this.helpID=18}this.page.showPage(this._view.viewbg.box_page)},e.prototype.helpView=function(){g.RuledescManager.showRuledesc(this.helpID)},e.prototype.refreshData=function(){this.page&&c.RoleCenter.instans.ufVo&&c.RoleCenter.instans.ufVo.inFamily&&c.RoleCenter.instans.vo.ufVo.familyInfo&&this.page.refreshData()},e.prototype.showView=function(e){if(void 0===e&&(e=0),this._pageIdx=e,l.GSM.ins.on(h.FamilyMemberListGS2C.KEY,this,this.onFamilyMemberListGS2C),this._view||this.initView(),null==c.RoleCenter.instans.ufVo.familyInfo){var t=new u.OpNoParaC2GS;t.optype=u.EOpNopara.getFamilyMemberList,l.GSM.sendServer(t)}else this._view.tab_page.selectedIndex!=this._pageIdx?this._view.tab_page.selectedIndex=this._pageIdx:this.changePage(this._pageIdx),this._view.showView()},e.prototype.onFamilyMemberListGS2C=function(e){c.RoleCenter.instans.ufVo.familyInfo=e,n.E.ins.event(s.EventName.SOCIETY_CHANGEPEOPLE),this._view.tab_page.selectedIndex==this._pageIdx?this.changePage(this._pageIdx):this._view.tab_page.selectedIndex=this._pageIdx,this._view.showView()},e.prototype.hideView=function(){this._view&&(l.GSM.ins.off(h.FamilyMemberListGS2C.KEY,this,this.onFamilyMemberListGS2C),this._view.hideView())},e}();t.GuildManageCtrl=f}),define("src/g/guild/ctrl/task/MiJingBossViewCtrl",["require","exports","../../../accessctrl/AccessCenter","../../../../manager/RoleCenter","../../../../manager/AM","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../../config/GameConfig","../../../net/messages/UseItemC2GS","../../../../manager/GameSocketManager","../../../peronboss/view/ItemIconView","../../../../utils/ItemUtils","../../../clearRes/ClearResM","../../../net/messages/ErrConst","../../../../utils/system/ErrCodeView","../../../../init/Switches","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(t){function e(){var e=t.call(this)||this;return e.btn_close.on(Laya.Event.CLICK,e,e.closeDlg),e.btn_close1.on(Laya.Event.CLICK,e,e.closeDlg),e}return __extends(e,t),e.prototype.close=function(e){void 0===e&&(e="side")},e.prototype.closeDlg=function(){t.prototype.close.call(this),d.ClearResM.clearResFolder("boosscall/")},e}(ui.guild.task.BossCallDlgUI);t.BossCallDlgUI=y;var v=function(){function e(){}return e.prototype.init=function(){m.Switches.ins.on(i.enumAccessId.guildCallBoss,this,this.openPanel)},e.prototype.openPanel=function(e,t,i,n){this._itemId=n,this._view||(this._view=new y,this._view.btn_call.on(Laya.Event.CLICK,this,this.callHandler)),this._view.popup();var s=r.GameConfig.bossCallJson[this._itemId];if(s){this._view.boo_name.text=s.title;for(var a=0;a<s.bonus.length;a++){var o=c.ItemUtils.getItemOrEq(s.bonus[a][0]);u.ItemIconView.setItemData(o,this._view["item"+a])}}},e.prototype.callHandler=function(){if(!n.RoleCenter.instans.bagRoomEnough())return s.AM.show(p.ErrCodeView.getErrStr(g.enumErrConst.code_2206),Laya.Handler.create(this,function(){m.Switches.ins.event(i.enumAccessId.huishou)})),!1;n.RoleCenter.instans.vo.ufVo.inFamily||a.FE.upItems(f.TextConst.get(533),o.BubbleEnum.center);var e=r.GameConfig.vipJSON[n.RoleCenter.instans.vo.VIP];e&&e.getRewardSummonCut(),n.RoleCenter.instans.vo.ufVo.summonBossCnt;var t=new l.UseItemC2GS;t.cfgId=this._itemId,t.count=1,h.GSM.sendServer(t),n.RoleCenter.instans.vo.lastUseBossCellItemId=this._itemId,this._view.closeDlg(),this._view=null},e}();t.BossCallCtrl=v}),define("src/g/guild/view/shacheng/SCFoeHead",["require","exports","../../../../utils/ItemUtils","../../../Effects/UIEffectsEnum","../../../Effects/UIEffectsFactory","../../../../manager/RoleCenter","../../../../init/TextConst"],function(e,t,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function i(){var e=t.call(this)||this;return e.mouseEnabled=!0,e.updStatus(i.NORMAL),e}return __extends(i,t),i.prototype.update=function(e,t){if(void 0===t&&(t="left"),this._data=e,this._data){if(""==this._data.groupID)this.imgHead.skin="res/guild/shacheng/sc_img_statue.png",this.imgHead.x=109,this.imgHead.y=-13,this.imgHead.width=67,this.imgHead.height=79,this.lbFamily.text="",this.lbName.y=30,this.lbName.text=r.TextConst.get(561);else{var i=void 0;0<this._data.getFightCount()&&(i=this._data.getUnitByIndex(0)),i?(this.imgHead.skin=n.ItemUtils.getHeadurlYuan(i.sex,i.job),this.imgHead.x=130,this.imgHead.y=11,this.imgHead.width=this.imgHead.height=54,this.lbName.y=21,this.lbFamily.y=36,this.lbName.text=i.actorName,this.lbFamily.color=this.familyNameColor(this._data.getFamilyUid()),this.lbFamily.text=r.TextConst.get(540,this._data.getFamilyName())):this.reset()}this.imgSword.x="left"==t?(this.headContainer.scaleX=-1,this.headContainer.x=190,this.openSign.x=203,this.openSign.scaleX=-1,this.lbName.x=this.lbFamily.x=68,this.lbFamily.align=this.lbName.align="left",149):(this.headContainer.scaleX=1,this.headContainer.x=0,this.openSign.x=-16,this.openSign.scaleX=1,this.lbName.x=this.lbFamily.x=2,this.lbFamily.align=this.lbName.align="right",2)}else this.reset()},i.prototype.familyNameColor=function(e){return""==o.RoleCenter.instans.self.ufData.familyUId||e!=o.RoleCenter.instans.self.ufData.familyUId?"#ff0f15":"#016ff9"},i.prototype.updStatus=function(e){e==i.BE_ATTACK?(this.statusGround.skin="res/unpack/sc_readcircle.png",this.imgSword.skin="res/unpack/sc_sword.png"):this.statusGround.skin=this.imgSword.skin=""},i.prototype.clearOpenSign=function(){this.openSign.skin=""},i.prototype.showOpenSign=function(){this.openSign.skin="res/guild/shacheng/gonghuizhan_yuxitubiao.png"},i.prototype.reset=function(){this.clearOpenSign(),this.updStatus(i.NORMAL),this.attackerEf&&(this.attackerEf.stop(),this.attackerEf.removeSelf(),this.attackerEf=null)},i.prototype.data=function(){return this._data},i.prototype.showAttackerEf=function(){null==this.attackerEf&&(this.attackerEf=a.UIEffectsFactory.Ins.createSAniById(s.UIEffectsEnum.attackerheadeff),this.attackerEf.autoPlay=!0,this.attackerEf.y=39,this.attackerEf.x=157,this.attackerEf.mouseEnabled=!1,this.headContainer.addChildAt(this.attackerEf,this.headContainer.getChildIndex(this.imgHead)))},i.NORMAL=0,i.ATTACK=1,i.BE_ATTACK=2,i}(ui.guild.shacheng.SCPlayerHeadUI);t.SCFoeHead=i}),define("src/g/guild/view/shacheng/SCRankItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.update=function(e){var t=this.dataSource;switch(e){case 0:this.imgRank.skin="res/custom/tongtianta_1jin.png",this.lbName.color=this.lbScore.color="#e1a32a";break;case 1:this.imgRank.skin="res/custom/tongtianta_2yin.png",this.lbName.color=this.lbScore.color="#aaa8b6";break;case 2:this.imgRank.skin="res/custom/tongtianta_3tong.png",this.lbName.color=this.lbScore.color="#c98858"}this.imgBGround.skin=e%2==0?"res/guild/shacheng/sc_rank_itembg0.png":"res/guild/shacheng/sc_rank_itembg1.png",this.lbName.text=t.familyNick,this.lbScore.text=t.sandyExp.toString()},t}(ui.guild.shacheng.SCRankItemUI);t.SCRankItem=i}),define("src/g/guild/view/shacheng/DecreeOpenStatus",["require","exports","../../../../manager/RoleCenter","../../../../utils/ItemUtils","../../../../config/GameConfig","../../../../init/TextConst"],function(e,t,n,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this,t=a.GameConfig.sandyCitySettingJson.hudunMax;return e.hudunMax=t.value,e.initHtmlStyle(e.opener,"#ceb394",18),e}return __extends(e,i),e.prototype.initHtmlStyle=function(e,t,i){e.style.color=t,e.style.font="SimHei",e.style.fontSize=i,e.style.stroke=1,e.style.strokeColor="#000000"},e.prototype.updOpenProgress=function(e){this.openBar.width=this.caculateProgressDisplay(e,1,361),this.openProgress.changeText((e/1*100>>0)+"%")},e.prototype.updHuDunProgress=function(e){this.hudunBar.width=this.caculateProgressDisplay(e,this.hudunMax,188)},e.prototype.setOpener=function(e){if(e){var t=void 0;t=""==n.RoleCenter.instans.self.ufData.familyUId||e.familyuid!=n.RoleCenter.instans.self.ufData.familyUId?"#ff0f15":"#54c5ff",this.opener.innerHTML=o.TextConst.get(821,t,e.familyname),this.openerHead.skin=s.ItemUtils.getHeadurlYuan(e.sex,e.job),this.updHuDunProgress(this.hudunMax)}},e.prototype.caculateProgressDisplay=function(e,t,i){return e*i/t>>0},e}(ui.guild.shacheng.DecreeOpenStatusUI);t.DecreeOpenStatus=i}),define("src/g/guild/view/shacheng/ShaChengMain",["require","exports","../../../../manager/LayerManager","src/g/guild/view/shacheng/SCFoeHead","src/g/guild/view/shacheng/SCRankItem","../../../../core/E","../../../../enum/EventName","../../../fight/osprite/play/family/SandCityFManager","../../../../utils/system/DateUitl","../../../Effects/UIEffectsFactory","../../../net/messages/SandyCityMsg","../../../../utils/system/ServerTime","../../../../config/GameConfig","../../../../manager/RoleCenter","../../../../utils/ItemUtils","src/g/guild/view/shacheng/DecreeOpenStatus","../../../../init/TextConst"],function(e,t,i,r,n,s,a,o,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(t){function e(){var e=t.call(this)||this;return e.changjing=null,e.height=Laya.stage.height,e.init(),e.initEvent(),e.decreeStatusPanel=new m.DecreeOpenStatus,e.decreeStatusPanel.top=140,e.decreeStatusPanel.centerX=0,e.addChild(e.decreeStatusPanel),e}return __extends(e,t),e.prototype.init=function(){this.imgSelected=new Laya.Image,this.imgSelected.skin="res/guild/shacheng/sc_btn_sc_img_guardstatue.png",this.rightFoeList=new v(this.myFoeList,this.foeContainer),this.leftFoeList=new v(this.leftFoeListComp,this.leftFoeContainerComp,"left",this.beAttackedSign),this.initRank()},e.prototype.initRank=function(){this.rankList.vScrollBarSkin="",this.rankList.itemRender=n.SCRankItem,this.rankList.renderHandler=Laya.Handler.create(this,this.updRankItemHander,null,!1)},e.prototype.updRankItemHander=function(e,t){e.update(t)},e.prototype.initEvent=function(){this.guard_clearButton.on(Laya.Event.CLICK,this,this.clearFoeHander),this.guard_guardButton.on(Laya.Event.CLICK,this,this.guard_guardStatueHander),this.guard_attackStatueButton.on(Laya.Event.CLICK,this,this.attackStatueHander),this.emperor_intoButton.on(Laya.Event.CLICK,this,this.intoPalaceHander),this.emperor_clearButton.on(Laya.Event.CLICK,this,this.clearFoeHander),this.openDecreeButton.on(Laya.Event.CLICK,this,this.openDecreeHander),this.palaceClearButton.on(Laya.Event.CLICK,this,this.clearFoeHander),this.toInnerButton.on(Laya.Event.CLICK,this,this.toInnerHander),this.qiangduoBtn.on(Laya.Event.CLICK,this,this.qiangduodecree)},e.prototype.clearFoeHander=function(e){this.isSelected(e.currentTarget)||(o.SandCityFManager.getInstance().attackAllTarget(),this.updSelectedButton(e.currentTarget))},e.prototype.guard_guardStatueHander=function(e){this.isSelected(e.currentTarget)||(o.SandCityFManager.getInstance().guardStatueHander(),this.updSelectedButton(e.currentTarget))},e.prototype.attackStatueHander=function(e){this.isSelected(e.currentTarget)||o.SandCityFManager.getInstance().attackStatueHander()&&this.updSelectedButton(e.currentTarget)},e.prototype.showView=function(){i.LayerManager.addInUILayer(this)},e.prototype.updProgress=function(e,t,i,n){this.clearSelectedButton(),this.progress=e,this.changjing=t,this.isGuard=n,this.updReadyCDStatus(i),this.updSceneElement(i)},e.prototype.updReadyCDStatus=function(e){e?(this.readyCountDownPanel.visible=!0,this.lbReadyCDValue.value="0",this.progress==u.ESandyWarPhase.SNATCH_SEAL?(this.lbReadyTitle.skin="res/guild/shacheng/gonghuizhan_zhengduoyuxi.png",this.toInnerButton.disabled=!0):this.progress==u.ESandyWarPhase.ATTACK_STATUE&&(this.isGuard?(this.lbReadyTitle.skin="res/guild/shacheng/gonghuizhan_zhunbeiyingdi.png",this.toInnerButton.disabled=!1):(this.lbReadyTitle.skin="res/expCopy/jingyanfuben_zhunbeikaishi.png",this.toInnerButton.disabled=!0))):this.onReadyCDComplete()},e.prototype.updReadyCoundDown=function(e){if(this.lbReadyCDValue.value=e.toString(),0==e){var t=void 0;this.progress==u.ESandyWarPhase.ATTACK_STATUE?this.isGuard?(t="res/guild/shacheng/sc_guardsign.png",this.isGuardInnerCity()&&(this.bossBloodPanel.visible=!0)):t="res/guild/shacheng/sc_attacksign.png":this.progress==u.ESandyWarPhase.SNATCH_SEAL&&(t="res/guild/shacheng/sc_zhengduosign.png"),null!=t&&s.E.ins.event(a.EventName.BOSSWARNINGSHOW,t)}},e.prototype.onReadyCDComplete=function(){this.readyCountDownPanel.visible=!1,this.toInnerButton.disabled=!1},e.prototype.updSceneElement=function(e){this.guard.visible=this.emperor_innerpanel.visible=this.emperor_palacepanel.visible=this.bossBloodPanel.visible=this.decreeStatusPanel.visible=!1,this.imgFoeLogo.visible=!1,this.isOutCity()?(this.leftFoeList.visible=this.rightFoeList.visible=!1,this.stopGameCountDown(),this.toInnerSprite.visible=this.toInnerButton.visible=!0,this.progress==u.ESandyWarPhase.SNATCH_SEAL&&this.rightFoeList.onDecreeStatusChanged(null),this.leftFoeList.clearAttackSign(!0),this.rightFoeList.clearAttackSign(!0)):(this.toInnerSprite.visible=this.toInnerButton.visible=!1,this.leftFoeList.visible=this.rightFoeList.visible=!0,this.startGameCountDown(),this.isGuardInnerCity()?(this.guard.visible=!0,this.guard_guardButton.visible=this.isGuard,this.guard_attackStatueButton.visible=!this.guard_guardButton.visible,this.lbGameName.text=f.TextConst.get(564),this.isGuard?this.imgFoeLogo.skin="res/guild/shacheng/sc_img_attacker.png":0==o.SandCityFManager.getInstance().isHaveLastWinnerKey()?this.imgFoeLogo.skin="res/guild/shacheng/sc_img_foe.png":this.imgFoeLogo.skin="res/guild/shacheng/sc_img_guards.png",e&&this.isGuard||(this.bossBloodPanel.visible=!0),this.initBossMaxBlood()):this.progress==u.ESandyWarPhase.SNATCH_SEAL&&(this.imgFoeLogo.skin="res/guild/shacheng/sc_img_foe.png",this.lbGameName.text=f.TextConst.get(565),this.isEmperorInner()?(this.emperor_innerpanel.visible=!0,this.initDeWarScore()):this.isPalace()&&(this.emperor_palacepanel.visible=!0,this.rightFoeList.onDecreeStatusChanged(this.decreeOpener)),null!=o.SandCityFManager.getInstance().pluckSealStartGS2C?this.decreeStatusChanged(!0):this.decreeStatusChanged(!1)))},e.prototype.startGameCountDown=function(){this.gameCountDownPanel.visible=!0,this.updGameCountDown(),Laya.timer.loop(1e3,this,this.updGameCountDown)},e.prototype.stopGameCountDown=function(){this.gameCountDownPanel.visible=!1,Laya.timer.clear(this,this.updGameCountDown)},e.prototype.updGameCountDown=function(){var e=o.SandCityFManager.getInstance().getCurrStateEndTime()-c.ServerTime.serverTime;e<=0&&(e=0,this.stopGameCountDown()),this.lbGameCDValue.text=l.DateUtil.timeCountDown1(e)},e.prototype.isOutCity=function(){return(this.progress==u.ESandyWarPhase.ATTACK_STATUE||this.progress==u.ESandyWarPhase.SNATCH_SEAL)&&this.changjing==o.sandyCityState.SC_OUT_CITY},e.prototype.isGuardInnerCity=function(){return this.progress==u.ESandyWarPhase.ATTACK_STATUE&&this.changjing==o.sandyCityState.SC_INNEAR_CITY},e.prototype.isEmperorInner=function(){return this.progress==u.ESandyWarPhase.SNATCH_SEAL&&this.changjing==o.sandyCityState.SC_INNEAR_CITY},e.prototype.isPalace=function(){return this.progress==u.ESandyWarPhase.SNATCH_SEAL&&this.changjing==o.sandyCityState.SC_PALACE},e.prototype.updFoeList=function(e){console.warn("仇敌列表变动了"),this.rightFoeList.datasource(e),null!=e&&(0==this.isOutCity()&&(this.imgFoeLogo.visible=0!=this.rightFoeList.length),this.isPalace()&&this.rightFoeList.onDecreeStatusChanged(this.decreeOpener))},e.prototype.updMyScore=function(e){var t=this.lbMyScore;if(!t.destroyed){t.text=f.TextConst.get(566,e),t.text=e.toString();var i=this.rankPanel.width-(this.lbScoreTitle.width+t.width)>>1;this.lbScoreTitle.x=i,t.x=i+this.lbScoreTitle.width}},e.prototype.updRankList=function(e){console.log("排行数据长度::"+e.length);var t=22*(this.rankList.dataSource=e).length;0<e.length&&(t+=(e.length-1)*this.rankList.spaceY),this.rankList.height=t,this.rankPanel.height=this.rankList.top+t+40},e.prototype.updSelectedButton=function(e){this.clearSelectedButton(),this.selectedButton=e;var t=this.selectedButton.getChildAt(0);this.changeBtnImgColor(t,1),h.UIEffectsFactory.Ins.centered4Parent(this.imgSelected,this.selectedButton),this.selectedButton.addChildAt(this.imgSelected,this.selectedButton.numChildren-1)},e.prototype.clearSelectedButton=function(){if(null!=this.selectedButton){this.imgSelected.removeSelf();var e=this.selectedButton.getChildAt(0);this.changeBtnImgColor(e,0),this.selectedButton=null}},e.prototype.changeBtnImgColor=function(e,t){var i,n=e.skin;if(null!=n){var s=n.split(".");2==s.length&&(i=s[0].substr(0,s[0].length-1),i+=t+"."+s[1],e.skin=i)}},e.prototype.intoPalaceHander=function(e){this.isSelected(e.currentTarget)||o.SandCityFManager.getInstance().moveToPalace()&&this.updSelectedButton(e.currentTarget)},e.prototype.openDecreeHander=function(e){this.isSelected(e.currentTarget)||o.SandCityFManager.getInstance().pluckSealHandler()&&this.updSelectedButton(e.currentTarget)},e.prototype.qiangduodecree=function(e){this.isSelected(e.currentTarget)||o.SandCityFManager.getInstance().qiangduoDecree()&&this.updSelectedButton(e.currentTarget)},e.prototype.decreeStatusChanged=function(e){var t=o.SandCityFManager.getInstance().pluckSealStartGS2C;this.progress==u.ESandyWarPhase.SNATCH_SEAL&&((this.decreeStatusPanel.visible=e)&&this.decreeStatusPanel.setOpener(t),t&&t.username&&t.familyuid!=g.RoleCenter.instans.self.ufData.familyUId?(this.qiangduoBtn.visible=!0,this.openDecreeButton.visible=!1):(this.qiangduoBtn.visible=!1,this.openDecreeButton.visible=!0),t&&t.username&&t.username!=g.RoleCenter.instans.self.username?this.openDecreeButton.disabled=!0:this.openDecreeButton.disabled=!1)},e.prototype.startOpenDecree=function(){this.updDecreeOpener(o.SandCityFManager.getInstance().pluckSealStartGS2C.username),this.progress==u.ESandyWarPhase.SNATCH_SEAL&&(this.decreeStatusChanged(!0),o.SandCityFManager.getInstance().pluckSealStartGS2C.username==g.RoleCenter.instans.self.username&&this.updSelectedButton(this.openDecreeButton))},e.prototype.updDecreeOpener=function(e){null==e||e==g.RoleCenter.instans.self.username?this.decreeOpener=null:this.decreeOpener=e,this.isPalace()&&this.rightFoeList.onDecreeStatusChanged(this.decreeOpener)},e.prototype.updateProgress=function(e){this.progress==u.ESandyWarPhase.SNATCH_SEAL&&this.decreeStatusPanel.updOpenProgress(e)},e.prototype.stopOpen=function(){this.decreeStatusChanged(!1),this.updDecreeOpener(null),this.selectedButton==this.openDecreeButton&&this.clearSelectedButton()},e.prototype.initDeWarScore=function(){console.log("yxq...............初始化积分"),this.updDWarScore(0)},e.prototype.updDWarScore=function(e){console.log("yxq...............更新积分");var t=d.GameConfig.sandyCitySettingJson.enterneedscore.value;this.emperor_intoButton.disabled=e<t,this.lbDecreeWarScore.text=e+"/"+t;var i=e/t*150;150<i&&(i=150),this.decreeScoreProgress.width=i},e.prototype.toInnerHander=function(){o.SandCityFManager.getInstance().moveToInnerCity()},e.prototype.isSelected=function(e){return e==this.selectedButton},e.prototype.initBossMaxBlood=function(){var e=o.SandCityFManager.getInstance().getPortIdByLevel(1),t=d.GameConfig.getPortByID(e),i=p.ItemUtils.getMonsterVOById(t.boss);this.bossMaxHp=i.HP},e.prototype.updBossBlood=function(e){if(this.isGuardInnerCity()){this.bloodProgress.width=380*e/this.bossMaxHp;var t=Math.ceil(e/this.bossMaxHp*100);console.warn("boss血量笔"+t),this.lbBloodProgress.changeText(t+"%"),0==e&&(this.bossBloodPanel.visible=!1)}},e.prototype.updateBuff=function(e,t){this.lbAttackBF.changeText(e+"%"),this.lbDefenseBF.changeText(t+"%")},e.prototype.clearEvent=function(){this.guard_clearButton.off(Laya.Event.CLICK,this,this.clearFoeHander),this.guard_guardButton.off(Laya.Event.CLICK,this,this.guard_guardStatueHander),this.guard_attackStatueButton.off(Laya.Event.CLICK,this,this.attackStatueHander),this.emperor_intoButton.off(Laya.Event.CLICK,this,this.intoPalaceHander),this.emperor_clearButton.off(Laya.Event.CLICK,this,this.clearFoeHander),this.openDecreeButton.off(Laya.Event.CLICK,this,this.openDecreeHander),this.palaceClearButton.off(Laya.Event.CLICK,this,this.clearFoeHander),this.toInnerButton.off(Laya.Event.CLICK,this,this.toInnerHander),this.qiangduoBtn.off(Laya.Event.CLICK,this,this.qiangduodecree)},e.prototype.hideView=function(){this.clearEvent(),this.rankList.renderHandler.clear(),this.rankList.renderHandler.recover(),this.rankList.renderHandler=null,this.rightFoeList.destory(),this.leftFoeList.destory(!0),this.stopGameCountDown(),this.removeSelf()},e.prototype.destroyView=function(){this.hideView(),this.destroy(!0)},e}(ui.guild.shacheng.SCMainUI);t.ShaChengMain=y;var v=function(){function e(e,t,i,n){void 0===i&&(i="right"),void 0===n&&(n=null),this.attackTarget=null,this.indexDict=new Laya.Dictionary,this.list=e,this.list.vScrollBarSkin="",this.ItemContainer=t,this.align=i,this.sign=n,null!=this.sign&&(this.sign.visible=!1),s.E.ins.on(a.EventName.CHANGE_PK_TARGET,this,this.attackHander),"left"==this.align&&s.E.ins.on(a.EventName.UPDATE_REVENGE_VIEW_TARGET,this,this.someOnAttackMe)}return e.prototype.attackHander=function(e){this.attackTarget=e,this.attackTargetChanged(this.attackTarget)},Object.defineProperty(e.prototype,"visible",{set:function(e){this.list.visible=e},enumerable:!0,configurable:!0}),e.prototype.someOnAttackMe=function(e){console.warn("有人在打我"),this.datasource(e),this.sign.visible=0!=this.ItemContainer.numChildren},e.prototype.datasource=function(e){if(null!=this.indexDict&&this.indexDict.clear(),this.clearFoeList(),null!=e){for(var t=[],i=void 0,n=0;n<e.length;n++)null!=e[n]&&(i=e[n],this.indexDict.set(i,n),t.push(i));var s=void 0,a=t.length;for(n=0;n<a;n++)(s=Laya.Pool.getItemByClass("SCFoeHead",r.SCFoeHead)).update(t[n],this.align),"left"==this.align&&s.showAttackerEf(),s.y=74*n,s.on(Laya.Event.CLICK,this,this.onFoeSelected),this.ItemContainer.addChild(s);var o=70*a+4*(a-1);this.ItemContainer.height=o,this.list.height=Math.min(350,o),this._length=t.length,console.warn("敌对列表长度"+this._length),this.attackTargetChanged(this.attackTarget)}},e.prototype.clearFoeList=function(){for(var e,t=this.ItemContainer.numChildren;0<t;)(e=this.ItemContainer.removeChildAt(0)).off(Laya.Event.CLICK,this,this.onFoeSelected),e.reset(),Laya.Pool.recover("SCFoeHead",e),t--},e.prototype.onFoeSelected=function(e){var t=e.currentTarget.data(),i=this.indexDict.get(t);null!=i&&("right"==this.align?s.E.ins.event(a.EventName.SELECT_TARGET_INDEX,i):s.E.ins.event(a.EventName.SELECT_REVENGE_TARGET_INDEX,i))},e.prototype.attackTargetChanged=function(e){if(null==e)this.clearAttackSign();else for(var t=void 0,i=0;i<this.ItemContainer.numChildren;i++)(t=this.ItemContainer.getChildAt(i)).data().groupID==e?t.updStatus(r.SCFoeHead.BE_ATTACK):t.updStatus(r.SCFoeHead.NORMAL)},e.prototype.clearAttackSign=function(e){void 0===e&&(e=!1);for(var t=0;t<this.ItemContainer.numChildren;)this.ItemContainer.getChildAt(t).updStatus(r.SCFoeHead.NORMAL),t++;e&&(this.attackTarget=null)},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.onDecreeStatusChanged=function(e){if(null==e)this.clearOpenDecreeSign();else for(var t=this.ItemContainer.numChildren,i=void 0,n=0;n<t;n++)if((i=this.ItemContainer.getChildAt(n)).data().groupID==e){i.showOpenSign();break}},e.prototype.clearOpenDecreeSign=function(){for(var e=0;e<this.ItemContainer.numChildren;e++)this.ItemContainer.getChildAt(e).clearOpenSign()},e.prototype.destory=function(e){void 0===e&&(e=!1),this.clearFoeList(),this.indexDict.clear(),this.indexDict=null,s.E.ins.off(a.EventName.CHANGE_PK_TARGET,this,this.attackHander),s.E.ins.off(a.EventName.UPDATE_REVENGE_VIEW_TARGET,this,this.someOnAttackMe),e&&Laya.Pool.clearBySign("SCFoeHead")},e}()}),define("src/g/guild/view/shacheng/SCWarSettlement",["require","exports","../../../../utils/ItemCellUtils","../../../bag/tips/view/ItemTips","../../../fight/osprite/play/family/SandCityFManager","../../../clearRes/ClearResM","../../../../init/TextConst"],function(e,t,n,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.rankList.vScrollBarSkin="",this.rankList.mouseEnabled=!1,this.rankList.renderHandler=new Laya.Handler(this,this.onRankRenderHandler),this.familyRewardList.hScrollBarSkin="",this.familyRewardList.scrollBar.elasticDistance=100,this.familyRewardList.selectEnable=!0,this.familyRewardList.mouseHandler=new Laya.Handler(this,this.onRewardMouseHandler),this.familyRewardList.renderHandler=new Laya.Handler(this,this.onFamilyItemRenderHandler),this.myRewardList.hScrollBarSkin="",this.myRewardList.scrollBar.elasticDistance=100,this.myRewardList.selectEnable=!0,this.myRewardList.itemRender=ui.custom.ItemNameViewUI,this.myRewardList.mouseHandler=new Laya.Handler(this,this.onRewardMouseHandler),this.myRewardList.renderHandler=new Laya.Handler(this,this.onPersonItemRenderHandler);var e=Laya.stage.height-1024>>1;this.bg.y=-e,this.bg.height+=e},e.prototype.setListData=function(e){var t=null!=(this.rankList.array=e)?e.length:0;this.rankList.height=80*t+(t-1)*this.rankList.spaceY},e.prototype.onRankRenderHandler=function(e,t){var i=this.rankList.array,n=t+1;e.imgChengHao.skin="res/guild/shachengresult/sc_chenggao"+n+".png",e.imgRank.skin="res/rank/new/paihang_huizhang"+n+".png";var s=null;i&&-1<t&&t<i.length&&(s=i[t])&&(e.lbPlayerName.text=o.TextConst.get(563,s.name),e.lbFamilyName.text=o.TextConst.get(540,s.name2))},e.prototype.setFamilyItemData=function(e){this.familyRewardList.array=e,this.familyRewardList.mouseEnabled=null!=e&&0<e.length,this.familyRewardList.width=112*this.familyRewardList.length,this.familyRewardList.centerX=0},e.prototype.onFamilyItemRenderHandler=function(e,t){if(-1<t&&t<this.familyRewardList.array.length){var i=this.familyRewardList.array[t];n.ItemCellUtils.fillCellForItemNameView(e,i[0],Number(i[1]))}},e.prototype.setPersonItemData=function(e){this.myRewardList.array=e,this.myRewardList.mouseEnabled=null!=e&&0<e.length,null!=e&&e.length,null!=e&&(5<e.length?(this.myRewardList.x=0,this.myRewardList.width=600):this.myRewardList.width=112*this.myRewardList.length,this.myRewardList.centerX=0)},e.prototype.onPersonItemRenderHandler=function(e,t){if(-1<t&&t<this.myRewardList.length){var i=this.myRewardList.array[t];e.scaleX=e.scaleY=.9,n.ItemCellUtils.fillCellForItemNameView(e,i[0],Number(i[1]))}},e.prototype.onRewardMouseHandler=function(e,t){if(e.type==laya.events.Event.CLICK){var i=e.target;i&&s.ItemTips.ins.showTip(i.dataSource[0],Number(i.dataSource[1]))}},e.prototype.showView=function(){this.popup()},e.prototype.hideView=function(){i.SandCityFManager.getInstance().sendExitMuScene(),this.clearAllHander(this.rankList),this.clearAllHander(this.familyRewardList),this.clearAllHander(this.myRewardList),this.clearAnimation(this.familyRewardList),this.clearAnimation(this.myRewardList)},e.prototype.clearAllHander=function(e){e.renderHandler.clear(),(e.renderHandler=null)!=e.mouseHandler&&(e.mouseHandler.clear(),e.mouseHandler=null)},e.prototype.clearAnimation=function(e){for(var t,i,n=e.cells.length,s=0;s<n;s++)0<(t=e.cells[s]).item.effect_con.numChildren&&(i=t.item.effect_con.getChildAt(0))&&i.stop();e.array=null},e.prototype.destroyView=function(){this.hideView(),this.close(),this.destroy(!0),a.ClearResM.clearUrl(this.bgimg.skin),a.ClearResM.clearUrl(this.bg.skin),a.ClearResM.clearResFolder("guild/shachengresult/")},e}(ui.guild.shacheng.SCWarSettlementUI);t.SCWarSettlement=r}),define("src/g/guild/view/shacheng/SCWarDeath",["require","exports","../../../fight/osprite/play/family/SandCityFManager","../../../../utils/system/ServerTime","../../../../manager/LayerManager","../../../../config/GameConfig","../../../../init/TextConst"],function(e,t,n,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e._endTime=0,e.width=Laya.stage.width,e.height=Laya.stage.height,e.mouseEnabled=!0,e.fuhuoButton.on(Laya.Event.CLICK,e,e.buyFuHuoHander),e.lbHurt.style.font=e.deathDes.style.font="SimHei",e.lbHurt.style.align=e.deathDes.style.align="center",e.lbHurt.style.color=e.deathDes.style.color="#e3cca9",e.lbHurt.style.stroke=e.deathDes.style.stroke=1,e.lbHurt.style.strokeColor=e.deathDes.style.strokeColor="#0d0500",e.lbHurt.style.fontSize=e.deathDes.style.fontSize=24,e}return __extends(e,t),e.instance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.show=function(e,t){void 0===t&&(t=0),this._endTime=n.SandCityFManager.getInstance().getLimitCountDownTime(),Laya.timer.loop(1e3,this,this.updateCountDown),this.updateCountDown(),this.deathDes.innerHTML=o.TextConst.get(290,e),this.lbHurt.innerHTML=o.TextConst.get(562,t),this.mainContainer.x=this.width-this.mainContainer.width>>1;var i=a.GameConfig.sandyCitySettingJson.clearCdCost;this.lbCost.text=i.value,s.LayerManager.addInHighUILayer(this)},e.prototype.updateCountDown=function(){var e=this._endTime-i.ServerTime.serverTime;e<=0&&(e=0,this.close()),this.lbCountDown.text=o.TextConst.get(36,e)},e.prototype.stopGameCountDown=function(){Laya.timer.clear(this,this.updateCountDown)},e.prototype.buyFuHuoHander=function(){n.SandCityFManager.getInstance().relifeByMoney()},e.prototype.close=function(){e._instance&&(console.warn("死亡窗口被干掉了"),this.removeSelf(),this.fuhuoButton.off(Laya.Event.CLICK,this,this.buyFuHuoHander),this.stopGameCountDown(),e._instance=null,console.log())},e}(ui.guild.shacheng.SCWarDeathUI);t.SCWarDeath=r}),define("src/g/guild/ctrl/shacheng/ShaChengResultCtrl",["require","exports","../../../base/BaseCtrl","src/g/guild/view/shacheng/SCWarSettlement","../../../../core/E","../../../../enum/EventName","../../../fight/osprite/play/family/SandCityFManager","src/g/guild/view/attackCity/PreviousFightingView","../../../../manager/RoleCenter","src/g/guild/view/shacheng/SCWarDeath"],function(e,t,i,n,s,a,d,g,p,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e._showRankMaxNum=3,s.E.ins.on(a.EventName.OPEN_SCWAR_SETTLEMENT,e,e.onWarEnd),s.E.ins.on(a.EventName.closeWarDeath,e,e.closeWarDeath),s.E.ins.on(a.EventName.showWarDeath,e,e.showWarDeath),e.url="res/atlas/res/guild/shachengresult.json",e}return __extends(e,t),e.prototype.showWarDeath=function(e,t){o.SCWarDeath.instance().show(e,t)},e.prototype.closeWarDeath=function(){o.SCWarDeath.instance().close()},e.prototype.onWarEnd=function(){this.open()},e.prototype.onAtlasLoaded=function(){this.settlement||(this.settlement=new n.SCWarSettlement,this.settlement.on(Laya.Event.REMOVED,this,this.closeSettlement),this.settlement.bg.on(Laya.Event.CLICK,this,this.closeSettlement),this.settlement.showView()),this.updateResultUI()},e.prototype.updateResultUI=function(){var e=d.SandCityFManager.getInstance().endSandyCityWar;if(this.settlement){this.settlement.setFamilyItemData([]),this.settlement.setPersonItemData([]);for(var t=e.familyRankList.length,i=[],n=null,s=null,a=0;a<t&&a<this._showRankMaxNum;a++)s=e.familyRankList[a],(n=new g.SCFRankData).name=s.chairmanNick,n.name2=s.familyNick,i.push(n);this.settlement.setListData(i);var o=null,r=-1;for(a=0;a<t;a++)if((s=e.familyRankList[a]).familyUid==p.RoleCenter.instans.self.ufData.familyUId){o=s,r=a;break}if(o){this.settlement.lbFamilyScore.text=o.sandyExp.toString();var l=d.SandCityFManager.getInstance().getReardItemListByType(1);-1<r&&r<l.length&&this.settlement.setFamilyItemData(l[r].itemShow)}var h=null,u=null;t=e.personRankList.length;for(a=0;a<e.personRankList.length;a++)if((u=e.personRankList[a]).usernick==p.RoleCenter.instans.self.nickname){h=u;break}if(h&&(this.settlement.lbMyScore.text=h.sandyExp.toString(),h.sandyExp)){var c=null;for(l=d.SandCityFManager.getInstance().getReardItemListByType(2),a=0;a<l.length;a++)if(c=l[a],h.sandyExp>=c.rankName){this.settlement.setPersonItemData(c.bonus);break}}}},e.prototype.closeSettlement=function(){this.settlement&&(this.settlement.off(Laya.Event.REMOVED,this,this.closeSettlement),this.settlement.bg.off(Laya.Event.CLICK,this,this.closeSettlement),this.settlement.destroyView(),this.settlement=null,this.clearCtrlRes())},e}(i.BaseCtrl);t.ShaChengResultCtrl=r}),define("src/g/guild/ctrl/shacheng/SCJiFenRewardCtrl",["require","exports","../../../../config/GameConfig","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../../manager/GameSocketManager","../../../net/messages/SandyNightMsg","../../../../manager/FlyManager","../../../../utils/ItemUtils","../../../../init/TextConst"],function(e,t,s,i,n,a,o,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){this.targetJifen=0,this.nowJifen=0,this.idxOffset=50}return e.prototype.init=function(e,t){if(this.view=e,this.expBonusIdx=t,null==this.jifenRewardList)for(var i in this.jifenRewardList=[],s.GameConfig.sandyCityRankJson){var n=s.GameConfig.sandyCityRankJson[i];6==n.type&&this.jifenRewardList.push(n)}this.initHtmlStyle(this.view.jifenInfo,"#ff7c07",18),this.updTargetJifenByIndex(),this.view.rewardBox.on(Laya.Event.CLICK,this,this.requestJifenReward)},e.prototype.updTargetJifenByIndex=function(){if(this.expBonusIdx>=this.jifenRewardList.length)this.view.visible=!1;else{var e=this.jifenRewardList[this.expBonusIdx];e&&(this.targetJifen=e.rankName,this.updJifenDisplay())}},e.prototype.initHtmlStyle=function(e,t,i){e.style.color=t,e.style.font="SimHei",e.style.fontSize=i,e.style.align="center"},e.prototype.updMyJiFen=function(e){this.nowJifen=e,this.updJifenDisplay()},e.prototype.updJifenDisplay=function(){var e=this.nowJifen>=this.targetJifen?"#09d51f":"#ff0000",t=this.view;t&&(this.nowJifen>=this.targetJifen?t.imgRed.visible=!0:t.imgRed.visible=!1,t.jifenInfo.innerHTML=h.TextConst.get(869,e,this.nowJifen,this.targetJifen))},e.prototype.requestJifenReward=function(){if(this.nowJifen>this.targetJifen){var e=new o.GetScoreBonusC2GS;e.scoreIdx=this.expBonusIdx+this.idxOffset,a.GSM.sendServer(e)}else i.FE.upItems(h.TextConst.get(468),n.BubbleEnum.center)},e.prototype.onGetRewardSuc=function(){var e=this.jifenRewardList[this.expBonusIdx].bonus[0][0],t=new Laya.Point(this.view.x,this.view.y);r.FlyManager.ins.flyIconToBag(l.ItemUtils.getIconById(e),t),this.expBonusIdx++,this.updTargetJifenByIndex()},e}();t.SCJiFenRewardCtrl=u}),define("src/g/guild/ctrl/shacheng/ShaChengCtrl",["require","exports","../../../base/BaseCtrl","../../../../core/E","../../../../enum/EventName","src/g/guild/view/shacheng/ShaChengMain","../../../fight/osprite/play/family/SandCityFManager","../../../../utils/system/ServerTime","../../../net/messages/SandyCityMsg","../../../clearRes/ClearResM","src/g/guild/ctrl/shacheng/ShaChengResultCtrl","src/g/guild/ctrl/shacheng/SCEntryBtnCtrl","src/g/guild/ctrl/shacheng/SCJiFenRewardCtrl","../../../fight/osprite/play/PlayManager","../../../net/messages/ChangeSceneMsg"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function e(){var e=t.call(this)||this;return e.progress=null,e.changjing=null,e.inWaitting=!1,e.isGuard=!1,e.openWindow=!1,e.url="res/atlas/res/guild/shacheng.json",n.E.ins.on(s.EventName.OPEN_SHA_CHENG,e,e.openView),n.E.ins.on(s.EventName.UPDATE_VIEW_TARGET,e,e.updFoeListHander),new u.ShaChengResultCtrl,c.SCEntryBtnCtrl.instance(),e.jifenRewardCtrl=new d.SCJiFenRewardCtrl,e}return __extends(e,t),e.prototype.openView=function(){(o.SandCityFManager.getInstance().shaChengCtrl=this).openWindow=!0,this.open()},e.prototype.onAtlasLoaded=function(){if(0!=this.openWindow){this._view=new a.ShaChengMain,this._view.showView(),null!=this.progress&&this._view.updProgress(this.progress,this.changjing,this.inWaitting,this.isGuard),null!=this.cacheFoeList&&(this._view.updFoeList(this.cacheFoeList),this.cacheFoeList=null),null!=this.cacheRank&&this._view.updRankList(this.parseRankData(this.cacheRank));var e=o.SandCityFManager.getInstance().realTimeFamilyExp;e&&(this.jifenRewardCtrl.init(this._view.jifenReward,e.expBonusIdx),this.updMyScore(e.mySandyExp))}},e.prototype.updFoeListHander=function(e){g.PlayManager.ins.play&&g.PlayManager.ins.play.type==p.EPlayType.PLAYTYPE_FIGHTSC&&(null==this._view?this.cacheFoeList=e:this._view.updFoeList(e))},e.prototype.closeView=function(){this.openWindow=!1,this._view&&(this._view.destroyView(),this._view=null),this.clearCtrlRes(),h.ClearResM.clearResFolder("guild/shacheng/")},e.prototype.startCountTime=function(){o.SandCityFManager.getInstance().getLimitCountDownTime()<r.ServerTime.serverTime?this.completeCDTime():(this.inWaitting=!0,Laya.timer.loop(1,this,this.updateCountTime,null,!0))},e.prototype.updateCountTime=function(){var e=o.SandCityFManager.getInstance().getLimitCountDownTime()-r.ServerTime.serverTime;e<0&&(e=0),this.updateTime(e),0==e&&(Laya.timer.clear(this,this.updateCountTime),this.completeCDTime())},e.prototype.updateTime=function(e){this._view&&this._view.updReadyCoundDown(Math.ceil(e))},e.prototype.completeCDTime=function(){this.inWaitting=!1,this._view&&this._view.onReadyCDComplete()},e.prototype.showView=function(e,t,i,n,s){switch(this.isGuard=i,e){case l.ESandyWarPhase.ATTACK_STATUE:switch(t){case o.sandyCityState.SC_OUT_CITY:console.warn("........................yxq"+i),s?this.inWaitting=!1:this.startCountTime(),this.updProgress(l.ESandyWarPhase.ATTACK_STATUE,o.sandyCityState.SC_OUT_CITY);break;case o.sandyCityState.SC_INNEAR_CITY:this.updProgress(l.ESandyWarPhase.ATTACK_STATUE,o.sandyCityState.SC_INNEAR_CITY);break;case o.sandyCityState.SC_PALACE:}break;case l.ESandyWarPhase.CAPTURE_ARENA:break;case l.ESandyWarPhase.SNATCH_SEAL:switch(t){case o.sandyCityState.SC_OUT_CITY:s?this.inWaitting=!1:this.startCountTime(),this.updProgress(l.ESandyWarPhase.SNATCH_SEAL,o.sandyCityState.SC_OUT_CITY);break;case o.sandyCityState.SC_INNEAR_CITY:this.updProgress(l.ESandyWarPhase.SNATCH_SEAL,o.sandyCityState.SC_INNEAR_CITY);break;case o.sandyCityState.SC_PALACE:this.updProgress(l.ESandyWarPhase.SNATCH_SEAL,o.sandyCityState.SC_PALACE)}}},e.prototype.updProgress=function(e,t){this.progress=e,this.changjing=t,null!=this._view&&this._view.updProgress(this.progress,this.changjing,this.inWaitting,this.isGuard)},e.prototype.onSandyExpChangeGS2C=function(e){this.updMyScore(e.newexp),null!=this._view&&this._view.updDWarScore(e.innerCityExp)},e.prototype.onRealTimeSandyWarExp=function(e){null==this._view?this.cacheRank=e:this._view.updRankList(this.parseRankData(e))},e.prototype.parseRankData=function(e){for(var t=[],i=null,n=0;n<e.familyRankList.length;n++)i=e.familyRankList[n],t.push(i);return 3<t.length&&(t.length=3),t},e.prototype.onRealTimeFamilyExp=function(e){console.log("输出积分exp:"+e.mySandyExp+":level:"+e.expBonusIdx),this.updMyScore(e.mySandyExp)},e.prototype.updMyScore=function(e){null!=this._view&&(this._view.updMyScore(e),this.jifenRewardCtrl.updMyJiFen(e))},e.prototype.clearSelectedButton=function(){this._view&&this._view.clearSelectedButton()},e.prototype.startOpenDecree=function(){null!=this._view&&this._view.startOpenDecree()},e.prototype.updateProgress=function(e){null!=this._view&&this._view.updateProgress(e)},e.prototype.stopOpen=function(){null!=this._view&&this._view.stopOpen()},e.prototype.updateBuff=function(e,t){this._view&&this._view.updateBuff(e,t)},e.prototype.updBossBlood=function(e){null!=this._view&&this._view.updBossBlood(e)},e.prototype.onHDValueChanged=function(e){this._view&&this.progress==l.ESandyWarPhase.SNATCH_SEAL&&this._view.decreeStatusPanel.updHuDunProgress(e)},e.prototype.onGetRewardSuc=function(){this.jifenRewardCtrl.onGetRewardSuc()},e}(i.BaseCtrl);t.ShaChengCtrl=m}),define("src/g/guild/view/ApplyGuildView",["require","exports","../../../manager/RoleCenter","../../../manager/GameSocketManager","../../net/messages/JoinFamilyMsg","../../../manager/LayerManager","../../../utils/ItemUtils","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../../utils/system/DateUitl","../../../init/TextConst"],function(e,t,o,r,l,i,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.viewbg.btn_help.visible=!1,e.list_.renderHandler=new Laya.Handler(e,e.renderHandler),e}return __extends(e,t),e.prototype.init=function(e){this.list_.dataSource=e},e.prototype.renderHandler=function(e,t){e.setTuiJian(0==t&&d.DateUtil.getKFDay()<=2);var i=e.dataSource,n=h.ItemUtils.getFamilylevelById(i.flvl),s=-1<o.RoleCenter.instans.ufVo._ufdata.applyFamilyList.indexOf(i.uid),a=i.combatLimit;e.btn_apply.label=s?g.TextConst.get(535):g.TextConst.get(536),e.btn_apply.mouseEnabled=!s,e.setIdx(t+1),i.reviewByChairman&&0==a?e.lab_fightNum.text=g.TextConst.get(800):e.lab_fightNum.text=g.TextConst.get(81,1e5<=a?g.TextConst.get(1,(a/1e4).toFixed(1)):a),e.setManageName(i.chairmanNicname),e.setSocietyName(i.fname,i.flvl),e.setPepleNum(i.members,n.membercount),e.setApplyCall(new Laya.Handler(this,this.onApplyClick,[i.uid,i.fname,a,i.members,n.membercount]))},e.prototype.onApplyClick=function(e,t,i,n,s){if(o.RoleCenter.instans.vo.combat<i)u.FE.upItems(g.TextConst.get(538),c.BubbleEnum.center);else if(n!=s){var a=new l.JoinFamilyC2GS;a.uid=e,a.fname=t,r.GSM.sendServer(a)}else u.FE.upItems(g.TextConst.get(537),c.BubbleEnum.center)},e.prototype.showView=function(){i.LayerManager.addInPOPWindowLayer(this)},e.prototype.hideView=function(){this.removeSelf()},e.prototype.destroyView=function(){this.hideView()},e}(ui.guild.createApply.applyGuildUI);t.ApplyGuildView=n}),define("src/g/guild/view/CreateGuildDlg",["require","exports","../../../config/GameConfig","../../../init/TextConst"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.initView(),e.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,t),e.prototype.initView=function(){var e=i.GameConfig.FamilySettingVo,t=i.GameConfig.FamilyLevel;this.xz_lv.text=window.enabledpay?"VIP"+e.createvip:"",this.guild_number.text=n.TextConst.get(27,t[1].membercount),this.guild_xh.text=e.createcost[0][1]},e}(ui.guild.createApply.createGuildUI);t.CreateGuildDlg=s}),define("src/g/guild/ctrl/CreateGuildCtrl",["require","exports","src/g/guild/view/CreateGuildDlg","../../../core/E","../../../enum/EventName","../../../config/GameConfig","../../../utils/system/FloatEffect","../../../manager/RoleCenter","../../net/messages/CreateFamilyMsg","../../../manager/GameSocketManager","../../../utils/system/ErrCodeView","../../net/messages/ErrConst","../../../plugin/view/ToolTip","../../accessctrl/AccessCenter","../../../init/TextConst","../../../utils/StringUtils","../../../init/Switches"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(){n.E.ins.on(s.EventName.OPEN_CREATESOCIETYDLG,this,this.openCreateGuildDlg)}return e.prototype.openCreateGuildDlg=function(){this._view||this.initView(),this._view.popup()},e.prototype.initView=function(){this._view=new i.CreateGuildDlg,this._view.btn_create.on(Laya.Event.CLICK,this,this.onCreateClieck)},e.prototype.onCreateClieck=function(){this.sSet=a.GameConfig.FamilySettingVo,this.user=r.RoleCenter.instans.vo;var e=this._view.lab_input.text,t=e.length;if(0!=t){if(6<t)u.ErrCodeView.show(c.enumErrConst.code_3312);else if(this.user.lvl<this.sSet.openLimit)o.FE.upItems(p.TextConst.get(530),d.BubbleEnum.center);else if(this.user.VIP<this.sSet.createvip)u.ErrCodeView.show(c.enumErrConst.code_3303);else if(this.user[this.sSet.createcost[0][0]]<this.sSet.createcost[0][1])f.Switches.ins.event(g.enumAccessId.goldInsufficient);else if(!m.StringUtils.checkString(e)){var i=new l.CreateFamilyC2GS;i.familyName=e,h.GSM.sendServer(i),this._view.close()}}else u.ErrCodeView.show(c.enumErrConst.code_3311)},e}();t.CreateGuildCtrl=y}),define("src/g/guild/ctrl/ApplyGuildCtrl",["require","exports","../../../utils/system/FloatEffect","../../../manager/GameSocketManager","../../net/messages/OpNoParaC2GS","../../net/messages/CreateFamilyMsg","../../../core/E","../../../enum/EventName","src/g/guild/view/ApplyGuildView","../../base/BaseCtrl","src/g/guild/ctrl/CreateGuildCtrl","../../net/messages/JoinFamilyMsg","../../../manager/RoleCenter","../../../vo/sbkFamilyVo","../../../plugin/sbkPropTool","../../../plugin/view/ToolTip","../../accessctrl/AccessCenter","../../../vo/RedDot/RedDot_Guild","../../../init/Switches"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(t){function e(){var e=t.call(this)||this;return e.urls=["res/atlas/res/society.json","res/atlas/res/society/character.json"],v.Switches.ins.on(f.enumAccessId.familyList,e,e.openApplyGuild),o.E.ins.on(r.EventName.SOCIETY_SELFUFDATACHANGE,e,e.refreshData),n.GSM.ins.on(a.CreateFamilyGS2C.KEY,e,e.onCreateFamilyGS2C),n.GSM.ins.on(c.JoinFamilyGS2C.KEY,e,e.onJoinFamilyGS2C),new u.CreateGuildCtrl,e}return __extends(e,t),e.prototype.openApplyGuild=function(){f.AccessCenter.ins.checkOpen(f.enumAccessId.family,!0)&&(n.GSM.ins.on(a.FamilyListGS2C.KEY,this,this.onFamilyListGS2C),this.opens())},e.prototype.onAtlasLoaded=function(){this.realOpenRoleView()},e.prototype.realOpenRoleView=function(){this._view||this.initView();var e=new s.OpNoParaC2GS;e.optype=s.EOpNopara.getFamilyList,n.GSM.sendServer(e)},e.prototype.onJoinFamilyGS2C=function(e){var t=this._view;if(e.opresult==c.EJOIN_STATE.SUCCESSED){d.RoleCenter.instans.vo.ufVo=new g.sbkFamilyVo(e.ufamilydata[0]),d.RoleCenter.instans.vo.ufVo._ufdata.applyFamilyList=[],p.sbkPropTool.init4familySkill();var i=d.RoleCenter.instans.vo.combat;d.RoleCenter.instans.vo.reCheckComBat(),d.RoleCenter.instans.event(r.EventName.FIGHT_UP,d.RoleCenter.instans.vo.combat-i),t&&t.hideView(),o.E.ins.event(r.EventName.SOCIETY_JOIN),v.Switches.ins.event(f.enumAccessId.family),y.RedDot_Guild.Ins.reCheckAll(),o.E.ins.event(r.EventName.SOCIETY_SELFUFDATACHANGE)}else e.opresult==c.EJOIN_STATE.FAILED?console.error(e.error):(d.RoleCenter.instans.ufVo._ufdata.applyFamilyList.push(e.targetFUid),t&&t.init(d.RoleCenter.instans.ufVo.familyList))},e.prototype.onCreateFamilyGS2C=function(e){if(e.opresult){d.RoleCenter.instans.vo.ufVo._ufdata=e.ufdata[0];var t=d.RoleCenter.instans.vo.combat;p.sbkPropTool.init4familySkill(),d.RoleCenter.instans.vo.reCheckComBat(),d.RoleCenter.instans.event(r.EventName.FIGHT_UP,d.RoleCenter.instans.vo.combat-t),d.RoleCenter.instans.vo.GOLD-=e.GOLD,this._view.hideView(),o.E.ins.event(r.EventName.SOCIETY_JOIN),y.RedDot_Guild.Ins.reCheckAll(),v.Switches.ins.event(f.enumAccessId.family)}else console.error(e.error),i.FE.upItems("  "+e.error+"  ",m.BubbleEnum.center)},e.prototype.onFamilyListGS2C=function(e){if(e.opresult){var t=d.RoleCenter.instans.ufVo;t.familyList=e.flist,t.inFamily||this._view&&(this._view.init(t.familyList),this._view.showView())}else console.error(e.error)},e.prototype.refreshData=function(){if(null!=this._view&&this._view.displayedInStage){var e=d.RoleCenter.instans.ufVo;this._view.init(e.familyList)}},e.prototype.initView=function(){this._view=new l.ApplyGuildView,this.addEvent()},e.prototype.addEvent=function(){this._view.btn_create.on(Laya.Event.CLICK,this,this.openCreate),this._view.viewbg.btn_back.on(Laya.Event.CLICK,this,this.hideView),this._view.viewbg.btn_close.on(Laya.Event.CLICK,this,this.hideView)},e.prototype.openCreate=function(){o.E.ins.event(r.EventName.OPEN_CREATESOCIETYDLG)},e.prototype.hideView=function(){n.GSM.ins.off(a.FamilyListGS2C.KEY,this,this.onFamilyListGS2C),this._view.hideView()},e}(h.BaseCtrl);t.ApplyGuildCtrl=_}),define("src/g/guild/view/atkDust/MonsterItemView",["require","exports","../../../net/messages/ManageFamilyMsg","../../../../manager/GameSocketManager","../../../../manager/RoleCenter","../../../../config/GameConfig","../../../../utils/system/FloatEffect","../../../../component/GAnimation","../../../../utils/ItemUtils","../../../../manager/StateManger","../../../../plugin/view/ToolTip","../../../fight/base/RES","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e._protId=0,e._can=!1,e.ani=new r.GAnimation,e.on(Laya.Event.CLICK,e,e.clickHandler),e}return __extends(e,t),e.prototype.init=function(e){this.ani.x=64,this.ani.y=132,this.addChild(this.ani);var t=l.ItemUtils.getMonsterVOById(e);if(-1==t.moResVo.dir.indexOf(5)){var i=c.RES.MONSTER_PATH+t.moResVo.res+"/3_r.json";this.ani.scale(-.8,.8)}else{i=c.RES.MONSTER_PATH+t.moResVo.res+"/5_r.json";this.ani.scale(.8,.8)}this.ani.load(i)},e.prototype.changeType=function(e){switch(this._can=!1,e){case i.EInvadeState.CAN_CHALLENGE:this.visible=!0,this.btn_tip.skin="res/society/tiaozhan.png",this._can=!0;break;case i.EInvadeState.IN_CHALLENGE:this.btn_tip.skin="res/society/tiaozhaning.png",this.visible=!0;break;case i.EInvadeState.IN_DEATH:this.visible=!1;break;case i.EInvadeState.NULL:console.error("EInvadeState is NULL")}},e.prototype.setPortId=function(e){this._protId=e},e.prototype.clickHandler=function(){if(!h.StateManger.isSpecialPlay(!0))if(s.RoleCenter.instans.ufVo._ufdata.familyInvadeCnt>=a.GameConfig.FamilySettingVo.intursioncount)o.FE.upItems(d.TextConst.get(539),u.BubbleEnum.center);else if(this._can&&0!=this._protId){var e=new i.ChallegeInvadeStartC2GS;e.portid=this._protId,n.GSM.sendServer(e)}},e}(ui.guild.task.item.monsterItemUI);t.MonsterItemView=g}),define("src/g/guild/view/shop/GuildProItem",["require","exports","../../../../utils/ItemUtils","../../../../manager/RoleCenter","../../../net/messages/UserFamilyDataGS2C","../../../../manager/GameSocketManager","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../peronboss/view/ItemIconView","../../../../meta/QualiyVo","../../../../init/TextConst"],function(e,t,o,r,i,n,s,a,l,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){function e(){var e=t.call(this)||this;return e.btn_buy.on(Laya.Event.CLICK,e,e.buyHandler),e}return __extends(e,t),e.prototype.buyHandler=function(){if(r.RoleCenter.instans.vo.GHGX<this._vo.cost[0][1])return s.FE.upItems(u.TextConst.get(567),a.BubbleEnum.center);r.RoleCenter.instans.ufVo;var e=new i.FShopBuyC2GS;e.shoptype=0,e.shopitemid=this._vo.id,n.GSM.sendServer(e)},e.prototype.setData=function(e){var t=r.RoleCenter.instans.ufVo,i=e.itemid[0][0],n=e.itemid[0][1],s=o.ItemUtils.getItemOrEq(i);l.ItemIconView.setItemData(s,this.item,n),this._vo=e,this.item_name.text=s.name,this.item_name.color=h.QualityStruct.Ins.getQColorById(s.quality),this.item_value_txt.text=u.TextConst.get(568,e.cost[0][1]),0<e.permit?(this.limit_txt.text=u.TextConst.get(822,e.permit-t._ufdata.shopItemCnt[e.id],e.permit),this.btn_buy.disabled=t._ufdata.shopItemCnt[e.id]>=e.permit):(this.limit_txt.text="",this.btn_buy.disabled=!1);var a=r.RoleCenter.instans.ufVo.selfFamily.flvl;e.limit&&e.limit.length?e.limit[0][1]>a?(this.btn_buy.visible=!1,this.level_limit.visible=!0,this.level_limit.text=u.TextConst.get(570,e.limit[0][1])):(this.btn_buy.visible=!0,this.level_limit.visible=!1):(this.level_limit.visible=!1,this.btn_buy.visible=!0),this.item.lvl.text=""},e}(ui.guild.shop.GuildProItemUI);t.GuildProItem=c}),define("src/g/guild/view/shop/GuildProPage",["require","exports","../../../../config/GameConfig","src/g/guild/view/shop/GuildProItem","../../../../manager/RoleCenter","../../../../enum/EventName","../../../../core/E"],function(e,t,n,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=100,o.E.ins.on(a.EventName.SOCIETY_SHOPBUYOVER,e,e.refreshPage),e.list.itemRender=i.GuildProItem,e.list.renderHandler=new Laya.Handler(e,e.renderHandler),e.btn_get.on(Laya.Event.CLICK,e,e.gotoHandler),o.E.ins.on(a.EventName.SOCIETY_FAMILYINFOCHANGE,e,e.refreshGHGX),e}return __extends(e,t),e.prototype.refreshGHGX=function(){this.value_txt.text=s.RoleCenter.instans.vo.GHGX+""},e.prototype.gotoHandler=function(){o.E.ins.event(a.EventName.OPEN_SOCIETYTASK)},e.prototype.renderHandler=function(e,t){e.setData(this.list.array[t])},e.prototype.showView=function(){this.visible=!0;var e=[],t=n.GameConfig.Shop3JSON;for(var i in t){t[i].type||e.push(t[i])}this.list.array=e,this.value_txt.text=s.RoleCenter.instans.vo.GHGX+""},e.prototype.refreshPage=function(){this.list.refresh()},e.prototype.updatePage=function(){this.list.refresh(),this.value_txt.text=s.RoleCenter.instans.vo.GHGX+""},e}(ui.guild.shop.GuildProPageUI);t.GuildProPage=r}),define("src/g/guild/view/shop/GuildMysteryItem",["require","exports","../../../../config/GameConfig","../../../../utils/ItemUtils","../../../../manager/GameSocketManager","../../../../manager/RoleCenter","../../../net/messages/UserFamilyDataGS2C","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../peronboss/view/ItemIconView","../../../../meta/QualiyVo","../../../../init/TextConst"],function(e,t,o,r,i,l,n,s,a,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){function e(){var e=t.call(this)||this;return e.btn_buy.on(Laya.Event.CLICK,e,e.buyHandler),e.btn_buy.disabled=!1,e}return __extends(e,t),e.prototype.buyHandler=function(){if(l.RoleCenter.instans.vo.GHGX<this._vo.cost[0][1])return s.FE.upItems(c.TextConst.get(567),a.BubbleEnum.center);var e=new n.FShopBuyC2GS;e.shoptype=1,e.shopitemid=this._vo.id,i.GSM.sendServer(e)},e.prototype.setData=function(e){var t=l.RoleCenter.instans.ufVo,i=o.GameConfig.Shop3JSON[e];this.tip_txt.text=c.TextConst.get(822,i.permit-t._ufdata.mysShopItemCnt[i.id%1e3],i.permit),t._ufdata.mysShopItemCnt[i.id%1e3]>=i.permit&&(this.btn_buy.disabled=!0);var n=i.itemid[0][0],s=i.itemid[0][1],a=r.ItemUtils.getItemOrEq(n);h.ItemIconView.setItemData(a,this.item,s),this._vo=i,this.item_name.text=a.name,this.item_value_txt.text=c.TextConst.get(568,i.cost[0][1]),this.item_name.color=u.QualityStruct.Ins.getQColorById(a.quality),10<=i.discount?this.discount.visible=!1:(8<=i.discount?this.zhe_icon.skin="res/custom/dazhe_003.png":this.zhe_icon.skin="res/custom/dazhe_002.png",this.discount.visible=!0),this.cost_txt.text=i.discount,this.item.lvl.text=""},e}(ui.guild.shop.GuildMysteryItemUI);t.GuildMysteryItem=d}),define("src/g/guild/view/shop/GuildMysteryPage",["require","exports","../../../../manager/RoleCenter","../../../net/messages/OpNoParaC2GS","../../../../manager/GameSocketManager","../../../net/messages/CreateFamilyMsg","../../../../utils/system/DateUitl","src/g/guild/view/shop/GuildMysteryItem","../../../../core/E","../../../../enum/EventName","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){function e(){var e=t.call(this)||this;return e.idArr=[],e.countdownTime=0,s.GSM.ins.on(a.FMysShopInfoGS2C.KEY,e,e.mysteryInfoHandler),l.E.ins.on(h.EventName.SOCIETY_SHOPBUYOVER,e,e.refreshPage),e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=100,e.list.itemRender=r.GuildMysteryItem,e.list.renderHandler=new Laya.Handler(e,e.renderHandler),e.btn_get.on(Laya.Event.CLICK,e,e.gotoHandler),l.E.ins.on(h.EventName.SOCIETY_FAMILYINFOCHANGE,e,e.refreshGHGX),e}return __extends(e,t),e.prototype.refreshGHGX=function(){this.value_txt.text=i.RoleCenter.instans.vo.GHGX+""},e.prototype.gotoHandler=function(){l.E.ins.event(h.EventName.OPEN_SOCIETYTASK)},e.prototype.renderHandler=function(e,t){e.setData(this.list.array[t])},e.prototype.mysteryInfoHandler=function(e){this.list.array=e.itemid,this.idArr=e.itemid,this.countdownTime=(864e5-(Date.now()-1e3*e.lastRefreshTime))/1e3>>0,Laya.timer.loop(1e3,this,this.updateTimeHandler)},e.prototype.updateTimeHandler=function(){if(this.time_txt.text=u.TextConst.get(569,o.DateUtil.getHourStr(this.countdownTime)),this.countdownTime-=1,this.countdownTime<=0){this.time_txt.visible=!1,Laya.timer.clearAll(this);var e=new n.OpNoParaC2GS;e.optype=n.EOpNopara.getFamilyMysShopItemList,s.GSM.sendServer(e)}},e.prototype.refreshPage=function(){this.list.refresh()},e.prototype.showView=function(){if(this.visible=!0,this.value_txt.text=i.RoleCenter.instans.vo.GHGX+"",this.countdownTime<=0){var e=new n.OpNoParaC2GS;e.optype=n.EOpNopara.getFamilyMysShopItemList,s.GSM.sendServer(e)}},e.prototype.updatePage=function(){this.value_txt.text=i.RoleCenter.instans.vo.GHGX+""},e}(ui.guild.shop.GuildMysteryPageUI);t.GuildMysteryPage=c}),define("src/g/guild/view/shop/GuildShopView",["require","exports","../../../../manager/LayerManager","src/g/guild/view/shop/GuildProPage","src/g/guild/view/shop/GuildMysteryPage","../../../../manager/GameSocketManager","../../../net/messages/UserFamilyDataGS2C","../../../../manager/RoleCenter","../../../../utils/system/FloatEffect","../../../../utils/ItemUtils","../../../../core/E","../../../../enum/EventName","../../../../plugin/view/ToolTip","../../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e.tab.selectHandler=new Laya.Handler(e,e.selectHandler),e.view.btn_back.on(Laya.Event.CLICK,e,e.closeHandler),e.view.btn_close.on(Laya.Event.CLICK,e,e.closeHandler),a.GSM.ins.on(o.FShopBuyGS2C.KEY,e,e.shopBuyHandler),e}return __extends(e,t),e.prototype.shopBuyHandler=function(e){if(e.opresult){var t=r.RoleCenter.instans.ufVo;0==e.shoptype?t._ufdata.shopItemCnt[e.shopitemid]++:t._ufdata.mysShopItemCnt[e.shopitemid%1e3]++,r.RoleCenter.instans.addInventoryToC(e.invent);for(var i=e.invent.itemList,n=0;n<i.length;n+=2){var s=i[n],a=i[n+1],o=h.ItemUtils.getItemOrEq(s);l.FE.getUpFloat(o.name+"x"+a,s)}0==this.tab.selectedIndex?this._propView&&this._propView.updatePage():this._mysterview&&this._mysterview.updatePage(),u.E.ins.event(c.EventName.SOCIETY_SHOPBUYOVER)}else console.error("购买失败")},e.prototype.closeHandler=function(){this.removeSelf()},e.prototype.showView=function(){i.LayerManager.addInPOPWindowLayer(this,!0,!0,!0),this.tab.selectedIndex=0},e.prototype.selectHandler=function(e){if(0==e)this._propView||(this._propView=new n.GuildProPage,this.addChild(this._propView)),this._mysterview&&(this._mysterview.visible=!1),this._propView.showView();else{if(r.RoleCenter.instans.ufVo.selfFamily.flvl<3)return this.tab.selectedIndex=0,l.FE.upItems(g.TextConst.get(571,3),d.BubbleEnum.center);this._mysterview||(this._mysterview=new s.GuildMysteryPage,this.addChild(this._mysterview)),this._propView&&(this._propView.visible=!1),this._mysterview.showView()}},e}(ui.guild.shop.GuildShopViewUI);t.GuildShopView=p}),define("src/g/guild/ctrl/shop/GuildShopViewCtrl",["require","exports","../../../../core/E","../../../../enum/EventName","src/g/guild/view/shop/GuildShopView"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.init=function(){i.E.ins.on(n.EventName.OPENGUILDSHOP,this,this.openView)},e.prototype.openView=function(){this._view||(this._view=new s.GuildShopView),this._view.view.btn_help.visible=!1,this._view.showView()},e}();t.GuildShopViewCtrl=a}),define("src/g/guild/view/PopTopFam",["require","exports","../../net/messages/OpNoParaC2GS","../../../manager/GameSocketManager","../../net/messages/OpResultGS2C","../../net/messages/OpResultType","../../../config/GameConfig","../../../manager/RoleCenter","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../../enum/EventName","../../../core/E","../../net/messages/ManageFamilyMsg","../../clearRes/ClearResM","../../../init/TextConst"],function(e,t,i,n,s,a,l,h,o,u,c,d,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){function e(){var e=r.call(this)||this;return e.flag=!1,e.btn_major.on(Laya.Event.CLICK,e,e.sendMajor),d.E.ins.on(c.EventName.SOCIETY_CHANGEPEOPLE,e,e.closeView),e}return __extends(e,r),e.prototype.closeView=function(){h.RoleCenter.instans.ufVo&&h.RoleCenter.instans.ufVo._ufdata.familyPosition==g.EFPosition.CHAIRMAN&&(this.close(),d.E.ins.off(c.EventName.SOCIETY_CHANGEPEOPLE,this,this.closeView))},e.prototype.OpResultGS2CHandler=function(e){e.opresult&&e.msgId==a.enumOpResultType.ImpeathChairman&&(n.GSM.ins.off(s.OpResultGS2C.KEY,this,this.OpResultGS2CHandler),this.close())},e.prototype.sendMajor=function(){if(this.selectBtn.selected)if(this.flag){var e=new i.OpNoParaC2GS;e.optype=i.EOpNopara.impeachChairMan,n.GSM.sendServer(e)}else o.FE.upItems(m.TextConst.get(560),u.BubbleEnum.center);else o.FE.upItems(m.TextConst.get(559),u.BubbleEnum.center)},e.prototype.popup=function(){var e=this.g_bar.width,t=l.GameConfig.commonJson.familyPresident.value.split(","),i=h.RoleCenter.instans.ufVo._ufdata.contributionTotal,n=h.RoleCenter.instans.vo,s=Number(t[0]),a=1e4*Number(t[1]),o=Number(t[2]);this.viptxt.text=n.VIP+"/"+t[0],this.fighttxt.text=m.TextConst.get(1,n.combat/1e4>>0)+"/"+m.TextConst.get(1,t[1]),this.g_txt.text=i+"/"+t[2],this.flag=n.VIP>=s&&n.combat>=a&&o<=i,this.g_bar.width=1<i/o?e:i/o*e,this.v_bar.width=1<n.VIP/s?e:n.VIP/s*e,this.fight_bar.width=1<n.combat/a?e:n.combat/a*e,r.prototype.popup.call(this)},e.prototype.close=function(){r.prototype.close.call(this),p.ClearResM.clearUrl(this.bg.skin)},e}(ui.dangguan.PopTopUI);t.PopTopFam=r}),define("src/g/guild/view/OffLineItem",["require","exports","../../net/messages/ManageFamilyMsg","../../../manager/GameSocketManager","../../../utils/ItemUtils","../../../init/TextConst"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.btn_ti.on(Laya.Event.CLICK,e,e.tiHandler),e}return __extends(e,t),e.prototype.tiHandler=function(){var e=new i.FKickOutC2GS;e.username=this._data.username,e.nickname=this._data.nickname,n.GSM.sendServer(e)},e.prototype.setData=function(e){switch(this._data=e,this.m_txt.text=e.nickname,this.g_txt.text=e.contributionTotal+"",this.f_txt.text=e.combat+"",this.icon.skin=s.ItemUtils.getHeadUrl(e.sex,e.job),e.familyPosition){case i.EFPosition.VICECHAIRMAN:this.m_pos.text=a.TextConst.get(555);break;case i.EFPosition.SENIRO:this.m_pos.text=a.TextConst.get(556);break;case i.EFPosition.PROTECTOR:this.m_pos.text=a.TextConst.get(557);break;default:this.m_pos.text=a.TextConst.get(558)}},e}(ui.dangguan.OffLineItemUI);t.OffLineItem=o}),define("src/g/guild/view/ClearList",["require","exports","src/g/guild/view/OffLineItem","../../../manager/RoleCenter","../../../core/E","../../../enum/EventName","../../net/messages/ManageFamilyMsg","../../../manager/GameSocketManager","../../../utils/system/ServerTime"],function(e,t,i,s,n,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){function e(){var e=t.call(this)||this;return e.list.itemRender=i.OffLineItem,e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=100,e.list.renderHandler=new Laya.Handler(e,e.renderHandler),n.E.ins.on(a.EventName.SOCIETY_CHANGEPEOPLE,e,e.update),e.bg.btn_close.once(Laya.Event.CLICK,e,e.close),e.btn_clear.on(Laya.Event.CLICK,e,e.clearHandler),e}return __extends(e,t),e.prototype.clearHandler=function(){for(var e=0;e<this.list.array.length;e++){var t=new o.FKickOutC2GS,i=this.list.array[e];t.username=i.username,t.nickname=i.nickname,r.GSM.sendServer(t)}},e.prototype.close=function(){t.prototype.close.call(this),n.E.ins.off(a.EventName.SOCIETY_CHANGEPEOPLE,this,this.update)},e.prototype.renderHandler=function(e,t){e.setData(this.list.array[t])},e.prototype.showView=function(){this.popup(),this.update()},e.prototype.update=function(){var e=s.RoleCenter.instans.ufVo.familyMemberList;if(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];172800<=l.ServerTime.serverTime-n.offlinetime&&t.push(n)}this.list.array=t}},e}(ui.dangguan.ClearListUI);t.ClearList=h}),define("src/g/guild/view/guildMainView",["require","exports","../../clearRes/ClearResM","src/g/guild/ctrl/shop/GuildShopViewCtrl","../../../core/E","../../../manager/LayerManager","../../../enum/EventName","../../../manager/RoleCenter","../../net/messages/ManageFamilyMsg","../../field/vo/RevengeVo","../../fight/osprite/play/family/SandCityFManager","../../../init/Switches","../../accessctrl/AccessCenter","src/g/guild/view/PopTopFam","src/g/guild/view/ClearList","../../../utils/system/ServerTime","../../../init/TextConst","../../index/ctrl/BottmListViewCtrl"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){function e(){var e=t.call(this)||this;return e.init(),(new n.GuildShopViewCtrl).init(),e.btn_major.on(Laya.Event.CLICK,e,e.popHandler),e.btn_gan.on(Laya.Event.CLICK,e,e.ganHandler),e.btn_clear.on(Laya.Event.CLICK,e,e.clearHandler),e}return __extends(e,t),e.prototype.clearHandler=function(){(new p.ClearList).showView()},e.prototype.popHandler=function(){(new g.PopTopFam).popup()},e.prototype.init=function(){this.btn_task.on(Laya.Event.CLICK,this,this.openTask),this.btn_skill.on(Laya.Event.CLICK,this,this.openSkill),this.btn_manage.on(Laya.Event.CLICK,this,this.openManage),this.btn_atkDust.on(Laya.Event.CLICK,this,this.openAtkDust),this.btn_warehouse.on(Laya.Event.CLICK,this,this.openWareHouse),this.btn_shop.on(Laya.Event.CLICK,this,this.openShop),this.help_dlg.list_.renderHandler=new Laya.Handler(this,this.helpRender),this.btn_guildMonster.on(Laya.Event.CLICK,this,this.openGuildMonster),this.btn_guildBoss.on(Laya.Event.CLICK,this,this.openGuildBoss),this.btn_atkDust.cdGround.visible=!1,this.btn_storage.on(Laya.Event.CLICK,this,this.toStorage)},e.prototype.openGuildMonster=function(){s.E.ins.event(o.EventName.OPEN_SOCIETYTASK,1)},e.prototype.openGuildBoss=function(){s.E.ins.event(o.EventName.OPEN_SOCIETYTASK,2)},e.prototype.helpRender=function(e,t){var i=e.dataSource,n=e.getChildByName("html_info");r.RoleCenter.instans.ufVo.getMemberByUname(i.username)?(n.style.font="SimHei",n.style.fontSize=20,n.innerHTML=f.TextConst.get(816,i.nickname,i.otherNickname,h.RevengeVo.getFightTitle(i.type))+f.TextConst.get(818),e.offAll(),e.on(Laya.Event.CLICK,this,function(){s.E.ins.event(o.EventName.OPEN_SOCIETYMANAGE,3)})):console.error("没有拿到指定的公会成员数据")},e.prototype.refreshHelp=function(){var e=r.RoleCenter.instans.ufVo;if(e.helpData){for(var t=[],i=0;i<e.helpData.revengeList.length;i++){r.RoleCenter.instans.ufVo.getMemberByUname(e.helpData.revengeList[i].username)&&t.push(e.helpData.revengeList[i])}this.help_dlg.list_.dataSource=t}},e.prototype.refreshData=function(){},e.prototype.openAtkDust=function(){u.SandCityFManager.getInstance().reqSandCityData()},e.prototype.openSkill=function(){s.E.ins.event(o.EventName.OPEN_SOCIETYSKILLS)},e.prototype.openShop=function(){s.E.ins.event(o.EventName.OPENGUILDSHOP)},e.prototype.openTask=function(){s.E.ins.event(o.EventName.OPEN_SOCIETYTASK)},e.prototype.openManage=function(){s.E.ins.event(o.EventName.OPEN_SOCIETYMANAGE)},e.prototype.openWareHouse=function(){c.Switches.ins.event(d.enumAccessId.guild_chest)},e.prototype.toStorage=function(){c.Switches.ins.event(d.enumAccessId.guildStorage)},e.prototype.showView=function(){if(this.bgimg.height=Laya.stage.height,this.parent){if(r.RoleCenter.instans.ufVo.inFamily&&0<a.LayerManager.getWindowLayerNumChildren())return void a.LayerManager.closeAllPOPWindow();this.hideView()}else this.bgimg.restskin(),a.LayerManager.addGuidLayer(this),this.width=Laya.stage.width,null==this.monserAni.source&&(this.monserAni.source="res/atlas/res/meeteff.json"),this.monserAni.play();a.LayerManager.closeAllPOPWindow(),this.updateBtn(),i.ClearResM.resetViewImg(this)},e.prototype.updateBtn=function(){if(this.btn_clear.visible=!1,r.RoleCenter.instans.ufVo){if(!r.RoleCenter.instans.ufVo.selfFamily)return;var e=r.RoleCenter.instans.ufVo.selfFamily.chairmanNicname;this.btn_major.visible=!e,this.showOnline()}},e.prototype.showOnline=function(){var e=r.RoleCenter.instans.ufVo.familyInfo;if(this.btn_gan.visible=!1,this.btn_clear.visible=!1,e){var t=r.RoleCenter.instans.ufVo._ufdata;if(!t)return;for(var i=0;i<e.memberlist.length;i++){var n=e.memberlist[i];172800<=m.ServerTime.serverTime-n.offlinetime&&(n.familyPosition==l.EFPosition.CHAIRMAN&&(this.btn_gan.visible=!0),t.familyPosition!=l.EFPosition.CHAIRMAN&&t.familyPosition!=l.EFPosition.VICECHAIRMAN||(this.btn_clear.visible=!0))}}},e.prototype.ganHandler=function(){s.E.ins.event(o.EventName.OPEN_SOCIETYMANAGE,[1])},e.prototype.hideView=function(){y.BottmListViewCtrl.showSelect(),a.LayerManager.closeGuidWin(),this.monserAni.stop(),this.bossAni.stop(),i.ClearResM.clearUrl(this.bgimg.skin)},e.prototype.destroyView=function(){this.hideView()},e}(ui.guild.guildMainUI);t.GuildMainView=v}),define("src/g/guild/ctrl/GuildMainCtrl",["require","exports","../../../config/GameConfig","../../../utils/system/FloatEffect","../../net/messages/OpResultType","../../net/messages/ManageFamilyMsg","../../../manager/LayerManager","../../base/BaseCtrl","../../../core/E","../../../enum/EventName","src/g/guild/view/guildMainView","../../../manager/GameSocketManager","../../net/messages/CreateFamilyMsg","../../net/messages/OpNoParaC2GS","../../../manager/RoleCenter","../../fight/info/PlayTypeVo","../../net/messages/FamilyMijingMsg","../../../vo/RedDot/RedDot_Guild","../../net/messages/ChangeSceneMsg","../../../plugin/view/ToolTip","../../accessctrl/AccessCenter","../../../init/Switches","../../net/messages/OpResultGS2C","../../../utils/ItemUtils","../../../init/TextConst"],function(e,t,o,n,s,r,a,i,l,h,u,c,d,g,p,m,f,y,v,_,C,w,I,b,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(i){function e(){var e=i.call(this)||this;e.openOverHandler=null,e.urls=["res/atlas/res/society.json","res/atlas/res/society/skill.json","res/atlas/res/society/character.json"],w.Switches.ins.on(C.enumAccessId.family,e,e.onOpenFamilyMain),l.E.ins.on(h.EventName.OPEN_GUILD_MONSTER_PAGE,e,e.onOPEN_GUILD_MONSTER_PAGE),l.E.ins.on(h.EventName.SOCIETY_LEAVE,e,e.leaveFamily),l.E.ins.on(h.EventName.SOCIETY_APPLYLISTCHANGE,e,e.onApplyListChange);var t=c.GSM.ins;return t.on(d.FamilyInfoGS2C.KEY,e,e.onFamilyInfoGS2C),t.on(r.ApplyListChangeGS2C.KEY,e,e.onApplyListChangeGS2C),t.on(r.FamilyMemberChangeGS2C.KEY,e,e.onFamilyMemberChangeGS2C),p.RoleCenter.instans.on(s.enumOpResultType.ImpeathChairman+"",e,e.onTanHeFail),t.on(r.FamilyMemberListGS2C.KEY,e,e.onFamilyMemberListGS2C),t.on(r.FamilyInvadeInfoGS2C.KEY,e,e.ongetFamilyInvadeInfo),t.on(r.ChallegeInvadeStartGS2C.KEY,e,e.onChallegeInvadeStartGS2C),t.on(f.FamilyMijingInfo.KEY,e,e.onFamilyMijingInfo),t.on(f.FamilyMijingRankInfo.KEY,e,e.onFamilyMijingRankInfo),t.on(r.FHelpRevengeDataGS2C.KEY,e,e.onFHelpRevengeDataGS2C),t.on(r.FHelpRevengeLogGS2C.KEY,e,e.onFHelpRevengeLogGS2C),t.on(r.FHelpRevengeGS2C.KEY,e,e.onFHelpRevengeGS2C),t.on(r.FHelpRevengeDelGS2C.KEY,e,e.onFHelpRevengeDelGS2C),t.on(I.OpResultGS2C.KEY,e,e.onOpresult),l.E.ins.on(h.EventName.FAIMLY_RUQIN_END,e,e.onChallegeInvadeEndGS2C),l.E.ins.on(h.EventName.SOCIETY_CLOSE_TASK,e,e.hideView),l.E.ins.on(h.EventName.GuildHelpRevengeBegin,e,e.hideView),l.E.ins.on(h.EventName.SC_INTO,e,e.hideView),l.E.ins.on(h.EventName.REFRESH_FAMILYHELPDATA,e,e.refreshHelp),C.AccessCenter.ins.on(C.enumAccessId.family,e,e.checkGuild),e}return __extends(e,i),e.prototype.onOpresult=function(e){if(e.opresult&&e.msgidx==s.enumOpResultType.zhuansheng_reset){var t=p.RoleCenter.instans.ufVo._ufdata;if(t){for(var i=t.ftaskCount.length-1;0<=i;i--)t.ftaskCount[i]=0;for(i=t.shopItemCnt.length-1;0<=i;i--)t.shopItemCnt[i]=0;for(i=t.mysShopItemCnt.length-1;0<=i;i--)t.mysShopItemCnt[i]=0;if(t.contributionToday=0,t.familyInvadeCnt=0,t.summonBossCnt=0,t.sweepNum=0,t.todayPort=0,t.worshipSanto=0,p.RoleCenter.instans.ufVo.inFamily&&p.RoleCenter.instans.ufVo.selfFamily){var n=p.RoleCenter.instans.ufVo.selfFamily.flvl;p.RoleCenter.instans.ufVo._ufdata.buyBoxNum=b.ItemUtils.getFamilylevelById(n).times}y.RedDot_Guild.Ins.reCheckAll()}}},e.prototype.onOpenFamilyMain=function(){p.RoleCenter.instans.vo.ufVo.inFamily?this.openSocietyMain():w.Switches.ins.event(C.enumAccessId.familyList)},e.prototype.onOPEN_GUILD_MONSTER_PAGE=function(){this.openOverHandler=Laya.Handler.create(this,function(){l.E.ins.event(h.EventName.OPEN_SOCIETYTASK,[1])}),this.onOpenFamilyMain()},e.prototype.checkGuild=function(){var e=this;Laya.timer.once(2e3,this,function(){e.getFamilyMsg()})},e.prototype.refreshHelp=function(){this._view&&this._view.refreshHelp()},e.prototype.onFHelpRevengeDataGS2C=function(e){p.RoleCenter.instans.ufVo.setHelpData(e)},e.prototype.onFHelpRevengeLogGS2C=function(e){p.RoleCenter.instans.ufVo.addHelpLog(e)},e.prototype.onFHelpRevengeGS2C=function(e){p.RoleCenter.instans.ufVo.addHelpRevenge(e)},e.prototype.onFHelpRevengeDelGS2C=function(e){p.RoleCenter.instans.ufVo.delHelpRevenge(e)},e.prototype.onApplyListChange=function(){this._view&&y.RedDot_Guild.Ins.reCheckAll()},e.prototype.onFamilyMijingInfo=function(e){y.RedDot_Guild.Ins.reCheckAll(),p.RoleCenter.instans.ufVo.mijingInfo=e,l.E.ins.event(h.EventName.SOCIETY_REFRESH_MIJINGBOSS)},e.prototype.onFamilyMijingRankInfo=function(e){p.RoleCenter.instans.ufVo.mijingRankInfo=e},e.prototype.onFamilyMemberListGS2C=function(e){p.RoleCenter.instans.ufVo.familyInfo=e,l.E.ins.event(h.EventName.SOCIETY_FAMILYINFOCHANGE),this._view&&this._view.showOnline()},e.prototype.onTanHeFail=function(e){n.FE.upItems(S.TextConst.get(531),_.BubbleEnum.center)},e.prototype.onApplyListChangeGS2C=function(e){var t=p.RoleCenter.instans.ufVo;e.addApply?t.ApplyListAdd(e.applyInfo):t.ApplyListDel(e.applyInfo)},e.prototype.openSocietyMain=function(){c.GSM.ins.on(d.FamilyListGS2C.KEY,this,this.onFamilyListGS2C),this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenRoleView()},e.prototype.realOpenRoleView=function(){this._view||this.initView(),this.getFamilyMsg(),this.openOverHandler&&(this.openOverHandler.run(),this.openOverHandler=null)},e.prototype.getFamilyMsg=function(){var e=o.GameConfig.FamilySettingVo,t=new g.OpNoParaC2GS;if(t.optype=g.EOpNopara.getFamilyList,c.GSM.sendServer(t),null==p.RoleCenter.instans.ufVo.familyInfo){var i=new g.OpNoParaC2GS;i.optype=g.EOpNopara.getFamilyMemberList,c.GSM.sendServer(i)}var n=new g.OpNoParaC2GS;if(n.optype=g.EOpNopara.getFamilyInvadeInfo,c.GSM.sendServer(n),null!=p.RoleCenter.instans.vo.ufVo.selfFamily){if(p.RoleCenter.instans.ufVo.selfFamily.flvl>=e.mijing_openLevel){var s=new g.OpNoParaC2GS;s.optype=g.EOpNopara.getFamilyMJInfo,c.GSM.sendServer(s);var a=new g.OpNoParaC2GS;a.optype=g.EOpNopara.getFamilyMJRank,c.GSM.sendServer(a),this.onApplyListChange()}y.RedDot_Guild.Ins.reCheckAll()}},e.prototype.onFamilyListGS2C=function(e){e.opresult?(p.RoleCenter.instans.ufVo.familyList=e.flist,this._view&&(this._view.showView(),this.refreshHelp())):console.error(e.error)},e.prototype.ongetFamilyInvadeInfo=function(e){p.RoleCenter.instans.vo.ufVo.familyInvadeInfo=e,y.RedDot_Guild.Ins.reCheckAll(),null!=this._view&&this._view.refreshData()},e.prototype.onChallegeInvadeStartGS2C=function(e){e.opresult?(l.E.ins.event(h.EventName.PLAY_TYPE_CHANGE,m.PlayTypeVo.create(v.EPlayType.PLAYTYPE_GUILD_INVADE,e)),this.hideView()):console.error(e.error)},e.prototype.onChallegeInvadeEndGS2C=function(e){e.opresult?(e.win&&(p.RoleCenter.instans.ufVo._ufdata.familyInvadeCnt++,p.RoleCenter.instans.addInventoryToC(e.invent)),y.RedDot_Guild.Ins.reCheckAll()):console.error(e.error)},e.prototype.onFamilyInfoGS2C=function(e){p.RoleCenter.instans.ufVo.selfFamily=e,y.RedDot_Guild.Ins.reCheckAll(),l.E.ins.event(h.EventName.SOCIETY_FAMILYINFOCHANGE)},e.prototype.onFamilyMemberChangeGS2C=function(e){var t=p.RoleCenter.instans.ufVo,i=t.familyMemberList;switch(e.chgType){case r.EFMChangeType.NULL:break;case r.EFMChangeType.ADD:if(i){for(var n=!1,s=0;s<i.length;s++)if(i[s].username==e.chgMember.username){n=!0;break}n||i.push(e.chgMember),t.selfFamily&&(t.selfFamily.members+=1)}break;case r.EFMChangeType.REMOVE:if(null==i)return;for(s=0;s<i.length;s++)if(i[s].username==e.chgMember.username){i.splice(s,1),t.selfFamily&&(t.selfFamily.members-=1);break}break;case r.EFMChangeType.UPDATE:if(!i)break;e.chgMember.username==p.RoleCenter.instans.vo.username&&(t._ufdata.familyPosition=e.chgMember.familyPosition);var a=t.getMemberByUname(e.chgMember.username);a?a.copydata(e.chgMember):(t.familyInfo&&t.familyInfo.memberlist.push(e.chgMember),t.sortFamilyMemberList())}t.sortFamilyMemberList(),y.RedDot_Guild.Ins.reCheckAll(),l.E.ins.event(h.EventName.SOCIETY_CHANGEPEOPLE),l.E.ins.event(h.EventName.SOCIETY_FAMILYINFOCHANGE),this._view&&this._view.updateBtn()},e.prototype.initView=function(){this._view=new u.GuildMainView,this._view.btn_back.on(Laya.Event.CLICK,this,this.hideView)},e.prototype.leaveFamily=function(){y.RedDot_Guild.Ins.reCheckAll(),this._view&&this._view.displayedInStage&&(this.hideView(),a.LayerManager.closeAllPOPWindow())},e.prototype.hideView=function(){c.GSM.ins.off(d.FamilyListGS2C.KEY,this,this.onFamilyListGS2C),this._view&&this._view.hideView()},e}(i.BaseCtrl);t.GuildMainCtrl=E}),define("src/g/leitower/view/LeiTowerView",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.tabbar.selectHandler=new Laya.Handler(e,e.selectHandler),e.bjview.btn_back.on(Laya.Event.CLICK,e,e.closeView),e.bjview.btn_close.on(Laya.Event.CLICK,e,e.closeView),e}return __extends(e,t),e.prototype.closeView=function(){this.removeSelf()},e.prototype.showView=function(e){i.LayerManager.addInPOPWindowLayer(this),this.tabbar.selectedIndex=e},e.prototype.selectHandler=function(e){},e}(ui.leitower.LeiTowerViewUI);t.LeiTowerView=n}),define("src/g/leitower/ctrl/LeiTowerCtrl",["require","exports","../../../init/Switches","../../accessctrl/AccessCenter","src/g/leitower/view/LeiTowerView"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){i.Switches.ins.on(n.enumAccessId.rexue_templeOfGod,this,this.openHandler)}return e.prototype.openHandler=function(){this.view||(this.view=new s.LeiTowerView)},e}();t.LeiTowerCtrl=a}),define("src/g/playtype_new/view/NPlayTypeView",["require","exports","../../proxy/MultiLevelUIProxy","../../accessctrl/AccessCenter","../../../core/E","../../../enum/EventName","../../../enum/GuideTargetName","../../hotbloodtemple/ctrl/HBloodTempleEntryCtrl","../../hotblood/ctrl/HotBloodWarEntryCtrl","../../../utils/SoundUtils","../../crossserboss/ctrl/KFShenQiJinDiPageCtrl","../../../manager/RuledescManager"],function(e,t,i,n,s,a,o,r,l,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){function e(){var e=t.call(this)||this;return e._shenQiJinDiCtrl=new u.KFShenQiJinDiPageCtrl,e._pro=new i.MultiLevelUIProxy,e.view.btn_help.on(Laya.Event.CLICK,e,e.helpClick),e.view.btn_close.on(Laya.Event.CLICK,e,e.closeCopyHandler),e.view.btn_back.on(Laya.Event.CLICK,e,e.closeCopyHandler),e._pro.registerTab(e.tabBar,0),e._pro.registerTagIndex(n.enumAccessId.kfsqjd,2),e._pro.registerTagIndex(n.enumAccessId.rexue_battlefield,1),e._pro.registerTagIndex(n.enumAccessId.rexue_templeOfGod,0),e._pro.selectHandler=new Laya.Handler(e,e.onSelectedHander),e}return __extends(e,t),e.prototype.helpClick=function(){c.RuledescManager.showRuledesc(268)},e.prototype.onRemovedHander=function(){this.closeWindow()},e.prototype.closeCopyHandler=function(){h.SoundUtils.getInstance().playBtnsounds(),this.closeWindow()},e.prototype.closeWindow=function(){this.off(Laya.Event.REMOVED,this,this.onRemovedHander),this.removeSelf(),s.E.ins.event(a.EventName.COMPTYPE_CLOSEVIEW,o.GuideTargetName.N_PLAYTYPE_VIEW),this._hotBloodWarCtrl&&this._hotBloodWarCtrl.destroyPage(),this._templeEntryCtrl&&this._templeEntryCtrl.destroyPage()},e.prototype.showView=function(e){void 0===e&&(e=0),this._pro.open(e),this.on(Laya.Event.REMOVED,this,this.onRemovedHander)},e.prototype.onSelectedHander=function(e){switch(this._hotBloodWarCtrl&&this._hotBloodWarCtrl.hidePage(),this._templeEntryCtrl&&this._templeEntryCtrl.hidePage(),this.openedIndex=e){case 0:if(!n.AccessCenter.ins.checkOpen(n.enumAccessId.rexue_templeOfGod,!0))return;this._templeEntryCtrl||(this._templeEntryCtrl=new r.HBloodTempleEntryCtrl),this.changeTitle(e),this._templeEntryCtrl.showPage(this.view.box_page);break;case 1:if(!n.AccessCenter.ins.checkOpen(n.enumAccessId.rexue_battlefield,!0))return;this._hotBloodWarCtrl||(this._hotBloodWarCtrl=new l.HotBloodWarEntryCtrl),this.changeTitle(e),this._hotBloodWarCtrl.showPage(this.view.box_page);break;case 2:if(!n.AccessCenter.ins.checkOpen(n.enumAccessId.kfsqjd,!0))return;this.changeTitle(e),this._shenQiJinDiCtrl.showPage(this.view.box_page),this.view.btn_help.visible=!0}},e.prototype.changeTitle=function(e){switch(e){case 1:this.view.img_title.skin="res/hotblood/rxzc_biaotiwenzi1.png";break;case 0:this.view.img_title.skin="res/title/rxsd_biaotiwenzi.png";break;case 2:this.view.img_title.skin=this._shenQiJinDiCtrl.getTitle()}this.view.img_title.restskin()},e}(ui.playtype_new.NPlayTypeViewUI);t.NPlayTypeView=d}),define("src/g/playtype_new/ctrl/NPlayTypeCtrl",["require","exports","src/g/playtype_new/view/NPlayTypeView","../../../init/Switches","../../accessctrl/AccessCenter","../../../enum/EventName","../../../enum/GuideTargetName","../../../core/E","../../../manager/LayerManager"],function(e,t,n,i,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(){i.Switches.ins.on(s.enumAccessId.playing,this,this.onOpenPage,[s.enumAccessId.playing]),i.Switches.ins.on(s.enumAccessId.rexue_battlefield,this,this.onOpenPage,[s.enumAccessId.rexue_battlefield]),i.Switches.ins.on(s.enumAccessId.rexue_templeOfGod,this,this.onOpenPage,[s.enumAccessId.rexue_templeOfGod]),i.Switches.ins.on(s.enumAccessId.kfsqjd,this,this.onOpenPage,[s.enumAccessId.kfsqjd])}return e.prototype.onOpenPage=function(e,t,i,n){if(void 0===i&&(i=!0),void 0===n&&(n=!1),t)switch(e){case s.enumAccessId.playing:s.AccessCenter.ins.checkOpen(s.enumAccessId.rexue_templeOfGod,!0)&&this.showView(s.enumAccessId.rexue_templeOfGod,i,n);break;case s.enumAccessId.rexue_battlefield:s.AccessCenter.ins.checkOpen(s.enumAccessId.rexue_battlefield,!0)&&this.showView(s.enumAccessId.rexue_battlefield,i,n);break;case s.enumAccessId.rexue_templeOfGod:s.AccessCenter.ins.checkOpen(s.enumAccessId.rexue_templeOfGod,!0)&&this.showView(s.enumAccessId.rexue_templeOfGod,i,n);break;case s.enumAccessId.kfsqjd:s.AccessCenter.ins.checkOpen(s.enumAccessId.kfsqjd)&&this.showView(s.enumAccessId.kfsqjd,i,n);break;default:this.showView(e,i,n)}},e.prototype.showView=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this._view||(this._view=new n.NPlayTypeView),r.E.ins.event(a.EventName.COMPTYPE_OPENVIEW,o.GuideTargetName.N_PLAYTYPE_VIEW),this._view.showView(e),l.LayerManager.addInPOPWindowLayer(this._view,t,!0,!0,!1)},e}();t.NPlayTypeCtrl=h}),define("src/g/achieve/view/GActiveView",["require","exports","../../../manager/LayerManager","../../clearRes/ClearResM","../../../enum/EventName","../../../core/E"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.bjview.btn_help.visible=!1,e.bjview.img_bg.skin=e.img_bg.skin,e.img_bg.destroy(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.showView=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),i.LayerManager.addInPOPWindowLayer(this,e,!0,!0,!1,t),n.ClearResM.resetViewImg(this),a.E.ins.on(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.closeClearRes=function(){a.E.ins.off(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),n.ClearResM.clearFolderByUrl("dynamic/taskicon/"),n.ClearResM.clearUrl(this.bjview.img_bg.skin)},e.prototype.hideView=function(){this.removeSelf()},e.prototype.destroyView=function(){},e}(ui.achievement.AchievementViewUI);t.GActiveView=o}),define("src/g/achieve/view/AchievementTaskPage",["require","exports","../../../config/GameConfig","../../../manager/RoleCenter","../../../meta/MainButtonVo","../../net/messages/AchieveC2GS","../../net/messages/OpResultType","../../../manager/GameSocketManager","../../../manager/AM","../../Effects/UIEffectsFactory","../../../enum/EventName","../../../core/E","../../peronboss/view/ItemIconView","../../../utils/pro/GotoUtil","../../clearRes/ClearResM","../../../utils/effects/ListEffect","../../Effects/UIEffectsEnum","../../../init/TextConst"],function(e,t,u,c,s,a,o,r,l,h,d,g,p,i,n,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){function e(){var e=t.call(this)||this;return e.list_task.scrollBar.elasticDistance=200,e.list_task.renderHandler=new Laya.Handler(e,e.onListRenderHandler),e.lab_jump.style.font="SimHei",e.lab_jump.style.fontSize=20,e.lab_jump.style.color="#149b14",e.lab_jump.innerHTML=y.TextConst.get(249),e.lab_jump.on(Laya.Event.LINK,e,e.onLinkHandler),e}return __extends(e,t),e.prototype.onLinkHandler=function(e){i.gotoModuleID(92)},e.prototype.showPage=function(){this.refreshData(),this.list_task.scrollBar.value=0,n.ClearResM.resetViewImg(this),this._isPlay||(m.ListEffect.flyIn(this.list_task,5,1,-1,500,100),this._isPlay=!0)},e.prototype.refreshData=function(){this.updateList()},e.prototype.updateList=function(){var e,t=0,i=0,n=c.RoleCenter.instans.vo.getAchieveData(),s=0,a=[],o=0,r=!0,l=0;for(var h in u.GameConfig.achieve)o=(e=u.GameConfig.achieve[h]).getTypeId(),i=e.id,o!=t&&(r=!1,0<l&&a.push(l),t=o),r||(l=i),-1!=n.achieveIdArr.indexOf(i)?s++:r=!0;0<l&&a.push(l),a.sort(this.compareFn),this.list_task.array=a,this.txt_star_total.changeText("×"+s)},e.prototype.compareFn=function(e,t){var i=u.GameConfig.achieve[e],n=c.RoleCenter.instans.vo.getAchieveData(),s=Number(n[i.type]),a=i.need;i.isSpecialType()&&(s=a<=s?1:0,a=1);var o=i.id;-1!=n.achieveIdArr.indexOf(i.id)?o+=2e4:s<a&&(o+=1e4),i=u.GameConfig.achieve[t],s=Number(n[i.type]),a=i.need;var r=i.id;return-1!=n.achieveIdArr.indexOf(i.id)?r+=2e4:s<a&&(r+=1e4),o-r},e.prototype.onListRenderHandler=function(e,t){var i=u.GameConfig.achieve[this.list_task.array[t]];if(i){var n=c.RoleCenter.instans.vo.getAchieveData(),s=Number(n[i.type]),a=i.need;for(i.isSpecialType()&&(s=a<=s?1:0,a=1),e.img_icon.skin="dynamic/taskicon/"+i.icon+".png",e.txt_name.changeText(i.name),e.txt_desc.style.font="SimHei",e.txt_desc.style.fontSize=18,e.txt_desc.style.color="#ccb694",e.txt_desc.innerHTML=i.desc,e.txt_progress.changeText(s+"/"+a),e.progress_bar.scaleX=Math.min(1,s/a),e.btn_get.label=s<a?y.TextConst.get(200):y.TextConst.get(204),e.progress.visible=-1!=n.achieveIdArr.indexOf(i.id),e.btn_get.visible=!e.progress.visible,s<a&&e.btn_get.visible&&(i.moduleID&&0<i.moduleID.length?e.btn_get.visible=!0:e.btn_get.visible=!1);e.effect.numChildren;){var o=e.effect.removeChildAt(e.effect.numChildren-1);o&&o.destroy()}e.btn_get.offAll(),e.btn_get.visible&&(a<=s&&(e.effect.visible=!0,h.UIEffectsFactory.Ins.createSAniAndCenter(e.effect,f.UIEffectsEnum.getTip_Big,1.05,1.05)),e.btn_get.on(Laya.Event.CLICK,this,this.onTaskOperation,[i.id])),this.setStar(e,e.progress.visible?i.getSubId():i.getSubId()-1);for(var r=i.bonus.length,l=0;l<2;)l<r?(e["item"+l].visible=!0,p.ItemIconView.setItem(e["item"+l],i.bonus[l])):e["item"+l]&&(e["item"+l].visible=!1),l++}},e.prototype.setStar=function(e,t){for(var i=0;i<5;){var n=e.star_group.getChildAt(i);n.skin=5<t?i<t-5?"res/custom/fuben_xingxing1.png":"res/custom/fuben_xingxing3.png":i<t?"res/custom/fuben_xingxing3.png":"res/custom/fuben_xingxing2.png",i++}},e.prototype.onTaskOperation=function(e){var t=u.GameConfig.achieve[e];if(t){var i=c.RoleCenter.instans.vo.getAchieveData();if(-1==i.achieveIdArr.indexOf(t.id)&&Number(i[t.type])>=t.need){if(!c.RoleCenter.instans.bagRoomEnough())return void l.AM.showBagNotEnough();var n=new a.AchieveC2GS;n.msgidx=o.enumOpResultType.achieve_getOne,n.cfgId=e,r.GSM.sendServer(n),g.E.ins.event(d.EventName.TASK_COMPLETE_EFFECT_POP)}else t.moduleID&&0<t.moduleID.length&&s.MainButtonStruct.Ins.OpenModule(t.moduleID[0][1],t.moduleID[1][1])}},e}(ui.achievement.page.AchievementTaskPageUI);t.AchievementTaskPage=v}),define("src/g/achieve/ctrl/AchievementTaskPageCtrl",["require","exports","src/g/achieve/view/AchievementTaskPage","../../../manager/RoleCenter","../../net/messages/OpResultType","../../../utils/system/FloatEffect","../../../config/GameConfig","../../../meta/CurrencyVo","../../../utils/ItemUtils","../../../core/E","../../net/messages/AchieveC2GS","../../../enum/EventName","../../accessctrl/AccessCenter","../../../manager/RedDotM"],function(e,t,i,h,u,c,d,g,p,m,f,y,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.init=function(){h.RoleCenter.instans.on(u.enumOpResultType.achieve_getOne.toString(),this,this.receiveHandler),h.RoleCenter.instans.on(u.enumOpResultType.achieve_setOne.toString(),this,this.receiveHandler),m.E.ins.once(y.EventName.ACHIEVEMENT_DATA_INITED,this,this.checkAchievementTaskRed),n.AccessCenter.ins.on(n.enumAccessId.achievement,this,this.checkAchievementTaskRed)},e.prototype.showPage=function(e){this._view||(this._view=new i.AchievementTaskPage),e&&(e.removeChildren(),this._view.showPage(),e.addChild(this._view))},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.receiveHandler=function(e){if(e.opresult){var t=h.RoleCenter.instans.vo,i=t.getAchieveData();if(e.msgidx==u.enumOpResultType.achieve_getOne){var n=e.reservedata[0];-1==i.achieveIdArr.indexOf(n)&&(i.achieveIdArr.push(n),t.ACHIEVEPOINT++,m.E.ins.event(y.EventName.ACHIEVEMENT_STAR_CHANGED));for(var s=d.GameConfig.achieve[e.reservedata[0]],a=0;a<s.bonus.length;a++){var o=p.ItemUtils.getItemOrEq(s.bonus[a][0]);o instanceof g.CurrencyVo?t[o.define]+=s.bonus[a][1]:t.chgItemCount(s.bonus[a][0],s.bonus[a][1]),c.FE.getFloat(o.name+"x"+s.bonus[a][1],p.ItemUtils.getColorByQuality(o.quality))}}else if(e.msgidx==u.enumOpResultType.achieve_setOne){var r=e.reservedata[0],l=e.reservedata[1];switch(r){case f.enumAchieveNumType.MEET:i.MEET=l;break;case f.enumAchieveNumType.KILLBOSS:i.KILLBOSS=l;break;case f.enumAchieveNumType.TIANTI:i.TIANTI=l;break;case f.enumAchieveNumType.ZSBOSS:i.ZSBOSS=l;break;case f.enumAchieveNumType.LOGINDAY:i.LOGINDAY=l;break;case f.enumAchieveNumType.LEVLE:i.LEVLE=l;break;case f.enumAchieveNumType.MAINPORT:i.MAINPORT=l;break;case f.enumAchieveNumType.CHALLANGEPORT:i.CHALLANGEPORT=l;break;case f.enumAchieveNumType.LONGSOUL:i.LONGSOUL=l;break;case f.enumAchieveNumType.SHIELD:i.SHIELD=l;break;case f.enumAchieveNumType.WING:i.WING=l;break;case f.enumAchieveNumType.MERIDIAN:i.MERIDIAN=l;break;case f.enumAchieveNumType.ENHANCE:i.ENHANCE=l;break;case f.enumAchieveNumType.SOUL:i.SOUL=l;break;case f.enumAchieveNumType.GEM:i.GEM=l;break;case f.enumAchieveNumType.MATERIALS:i.MATERIALS=l;break;case f.enumAchieveNumType.FAMILYFAM:i.FAMILYFAM=l;break;case f.enumAchieveNumType.VIPLEVEL:i.VIPLEVEL=l;break;case f.enumAchieveNumType.SELFBOSS:i.SELFBOSS=l;break;case f.enumAchieveNumType.CHOPLEVEL:i.CHOPLEVEL=l;break;case f.enumAchieveNumType.BLESSSUIT:i.BLESSSUIT=l;break;case f.enumAchieveNumType.HESKILL:i.HESKILL=l;break;case f.enumAchieveNumType.HUNYIN:i.HUNYIN=l}}this._view&&this._view.displayedInStage&&this._view.refreshData(),this.checkAchievementTaskRed()}},e.prototype.checkAchievementTaskRed=function(){s.RedDotM.check(n.enumAccessId.achievement)},e}();t.AchievementTaskPageCtrl=a}),define("src/g/achieve/view/DailyRewardDlg",["require","exports","../../../config/GameConfig","../../../utils/ItemCellUtils","../../net/messages/ActiveBoxC2GS","../../../manager/GameSocketManager","../../../manager/AM","../../../manager/RoleCenter","../../bag/tips/view/ItemTips","../../../manager/FlyManager","../../../utils/UIUtils","../../../init/Switches","../../accessctrl/AccessCenter"],function(e,t,i,n,s,a,o,r,l,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e.btn_close.on(Laya.Event.CLICK,e,e.onCloseHandler),e.list_reward.itemRender=ui.custom.ItemNameViewUI,e.list_reward.renderHandler=new Laya.Handler(e,e.onListRender),e.list_reward.clickHandler=new Laya.Handler(e,e.onMouseListRender),e.btn_get1.on(Laya.Event.CLICK,e,e.getOneHandler),e.btn_get2.on(Laya.Event.CLICK,e,e.getTwoHandler),e}return __extends(e,t),e.prototype.showBox=function(e){this._activeId=e;var t=i.GameConfig.activeTaskJSON[this._activeId];t&&(this.list_reward.array=t.reward,this.box_cost.setData(t.cost),this.btn_get1.disabled=this.btn_get2.disabled=!this.canGet(),this.popup())},e.prototype.onMouseListRender=function(e){l.ItemTips.ins.showTip(this.list_reward.array[e][0],Number(this.list_reward.array[e][1]))},e.prototype.onListRender=function(e,t){n.ItemCellUtils.fillCellForItemNameView(e,this.list_reward.array[t][0],Number(this.list_reward.array[t][1]))},e.prototype.onGetSendBefor=function(){for(var e=0;e<this.list_reward.array.length;e++)h.FlyManager.ins.flyItemToBagBessel(this.list_reward.array[e][0],u.UIUtils.localToGlobal(this.list_reward.getChildAt(0),new Laya.Point));this.close()},e.prototype.canGet=function(){var e=i.GameConfig.activeTaskJSON[this._activeId],t=r.RoleCenter.instans.vo.ActiveData;if(-1<t.activeIdArr.indexOf(e.id));else if(t.ACTIVEBOX>=e.max)return!0;return!1},e.prototype.getOneHandler=function(){if(this.canGet()){if(!r.RoleCenter.instans.bagRoomEnough())return o.AM.showBagNotEnough(),void this.close();var e=new s.ActiveBoxC2GS;e.cfgId=this._activeId,a.GSM.sendServer(e),this.onGetSendBefor()}},e.prototype.getTwoHandler=function(){if(this.canGet()){if(!r.RoleCenter.instans.bagRoomEnough())return o.AM.showBagNotEnough(),void this.close();var e=i.GameConfig.activeTaskJSON[this._activeId];if(r.RoleCenter.instans.self.GOLD<e.cost[0][1])c.Switches.ins.event(d.enumAccessId.goldInsufficient);else{var t=new s.ActiveBoxC2GS;t.cfgId=this._activeId,t.isDouble=!0,a.GSM.sendServer(t),this.onGetSendBefor()}}},e.prototype.onCloseHandler=function(){this.close()},e}(ui.achievement.DailyRewardDlgUI);t.DailyRewardDlg=g}),define("src/g/achieve/view/DailyTaskPage",["require","exports","../../../config/GameConfig","../../../manager/RoleCenter","../../net/messages/ActiveBoxC2GS","../../../manager/AM","../../../meta/MainButtonVo","../../../manager/GameSocketManager","src/g/achieve/view/DailyRewardDlg","../../Effects/UIEffectsFactory","../../../core/E","../../../enum/EventName","../../peronboss/view/ItemIconView","../../../utils/pro/GotoUtil","../../clearRes/ClearResM","../../../utils/effects/ListEffect","../../Effects/UIEffectsEnum","../../../utils/ItemUtils","../../../utils/MathUtils","../../../utils/system/DateUitl","../../../init/TextConst"],function(e,t,g,p,o,r,l,h,i,u,c,d,m,n,s,a,f,y,v,_,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(t){function e(){var e=t.call(this)||this;return e._maxHyd=0,e._progressArr=[0],e.list_task.scrollBar.elasticDistance=200,e.list_task.renderHandler=new Laya.Handler(e,e.onListRenderHandler),e.on(Laya.Event.REMOVED,e,e.onRemovedHandler),e.lab_jump.style.font="SimHei",e.lab_jump.style.fontSize=20,e.lab_jump.style.color="#149b14",e.lab_jump.innerHTML=C.TextConst.get(250),e.lab_jump.on(Laya.Event.LINK,e,e.onLinkHandler),c.E.ins.on(d.EventName.ADDED_LEVEL,e,e.onLvChanged),e}return __extends(e,t),e.prototype.onLvChanged=function(){this.displayedInStage&&this.updateList()},e.prototype.onLinkHandler=function(e){n.gotoModuleID(92)},e.prototype.onRemovedHandler=function(){},e.prototype.showPage=function(){this.refreshData(),this.list_task.scrollBar.value=0,s.ClearResM.resetViewImg(this),this._isPlay||(a.ListEffect.flyIn(this.list_task,5,1,-1,500,100),this._isPlay=!0)},e.prototype.refreshData=function(){this.updateList();var e=p.RoleCenter.instans.vo.ActiveData;this.progress_bar.scaleX=v.MathUtils.sectionProgress(this._progressArr,e.ACTIVEBOX),this.txt_hyd_total.changeText(e.ACTIVEBOX.toString()),this.lab_storyexp.changeText(p.RoleCenter.instans.vo.STORYEXP.toString())},e.prototype.updateList=function(){var e,t=_.DateUtil.getKFDay(),i=p.RoleCenter.instans.vo.getCurLv(),n=[];for(var s in g.GameConfig.activeTaskJSON)"ACRIVITYBOX"==(e=g.GameConfig.activeTaskJSON[s]).type?this.onUpdateBox(e):n.push(e);n.sort(function(e,t){return e.group-t.group});for(var a=0,o=0,r=0,l=!1,h=p.RoleCenter.instans.vo.ActiveData,u=[],c=0,d=n.length;c<d;)r=(e=n[c]).getTypeId(),o=e.id,r!=a&&(l=!1,a=r),0==l&&-1==h.activeIdArr.indexOf(o)&&this.checkLimit(e,t,i)&&(l=!0,u.push(o)),c++;u.sort(this.compareFn),this.list_task.array=u},e.prototype.checkLimit=function(e,t,i){if(e.limit){var n=e.limit.length;if(0<n&&i<e.limit[0])return!1;if(1<n&&i>e.limit[1])return!1;if(2<n&&t<e.limit[2])return!1;if(3<n&&t>e.limit[3])return!1}return!0},e.prototype.compareFn=function(e,t){var i=p.RoleCenter.instans.vo.ActiveData,n=g.GameConfig.activeTaskJSON[e],s=i.activeNumArr[n.getTypeIndex()]||0,a=n.max,o=n.id;s<a&&(o+=1e3),n=g.GameConfig.activeTaskJSON[t],s=i.activeNumArr[n.getTypeIndex()]||0,a=n.max;var r=n.id;return s<a&&(r+=1e3),o-r},e.prototype.onUpdateBox=function(e){e.max>this._maxHyd&&(this._maxHyd=e.max);var t,i,n,s,a,o=p.RoleCenter.instans.vo.ActiveData;101==e.id?(t=this.img_box0,i=this.txt_progress0,this._progressArr[1]=e.max,n=this.effect0,s=this.img_complt0,a=this.txt_boxnum0):102==e.id?(t=this.img_box1,i=this.txt_progress1,this._progressArr[2]=e.max,n=this.effect1,s=this.img_complt1,a=this.txt_boxnum1):103==e.id?(t=this.img_box2,i=this.txt_progress2,this._progressArr[3]=e.max,n=this.effect2,s=this.img_complt2,a=this.txt_boxnum2):104==e.id?(t=this.img_box3,i=this.txt_progress3,this._progressArr[4]=e.max,n=this.effect3,s=this.img_complt3,a=this.txt_boxnum3):105==e.id&&(t=this.img_box4,i=this.txt_progress4,this._progressArr[5]=e.max,n=this.effect4,s=this.img_complt4,a=this.txt_boxnum4),n&&(n.visible=!1),s&&(s.visible=!1),i.changeText(e.max.toString()),t.offAll(),t.on(Laya.Event.CLICK,this,this.onGetBoxHandler,[e.id]),a.changeText("x"+e.reward[0][1]);var r=y.ItemUtils.getItemOrEq(e.reward[0][0]);r&&(t.skin=y.ItemUtils.getIconByIconId(r.icon)),-1<o.activeIdArr.indexOf(e.id)?s&&(s.visible=!0):o.ACTIVEBOX>=e.max&&(n.visible=!0,t.offAll(),t.on(Laya.Event.CLICK,this,this.getOneHandler,[e.id]))},e.prototype.onGetBoxHandler=function(e){this._getBoxDlg||(this._getBoxDlg=new i.DailyRewardDlg),this._getBoxDlg.showBox(e)},e.prototype.getOneHandler=function(e){if(p.RoleCenter.instans.bagRoomEnough()){var t=new o.ActiveBoxC2GS;t.cfgId=e,h.GSM.sendServer(t)}else r.AM.showBagNotEnough()},e.prototype.onListRenderHandler=function(e,t){var i=this.list_task.array[t],n=g.GameConfig.activeTaskJSON[i];e.img_icon.skin="dynamic/taskicon/"+n.icon+".png",e.txt_name.changeText(n.name);var s=p.RoleCenter.instans.vo.ActiveData,a=s.activeNumArr[n.getTypeIndex()]||0,o=n.max;for(e.txt_desc.style.font="SimHei",e.txt_desc.style.fontSize=18,e.txt_desc.style.color="#ccb694",e.txt_desc.innerHTML=o<=a?n.desc+'<font color="#03bb00">('+a+"/"+o+")</font>":n.desc+'<font color="#ff0f15">('+a+"/"+o+")</font>",e.btn_get.label=a<o?C.TextConst.get(200):C.TextConst.get(204),e.btn_get.skin="res/custom/newBtn/"+(a<o?"qianwang_anniu":"gongyong_anniu_002")+".png",e.btn_get.visible=-1==s.activeIdArr.indexOf(n.id),a<o&&(n.moduleID&&0<n.moduleID.length?e.btn_get.visible=!0:e.btn_get.visible=!1);e.effect.numChildren;){var r=e.effect.removeChildAt(e.effect.numChildren-1);r&&r.destroy()}e.btn_get.offAll(),e.btn_get.visible&&(o<=a&&(e.effect.visible=!0,u.UIEffectsFactory.Ins.createSAniAndCenter(e.effect,f.UIEffectsEnum.getTip_Big,1.05,1.05)),e.btn_get.on(Laya.Event.CLICK,this,this.onTaskOperation,[n.id]));for(var l=n.reward.length,h=0;h<3;)h<l?(e["item"+h].visible=!0,m.ItemIconView.setItem(e["item"+h],n.reward[h])):e["item"+h].visible=!1,h++},e.prototype.onTaskOperation=function(e){var t=g.GameConfig.activeTaskJSON[e];if(t){var i=p.RoleCenter.instans.vo.ActiveData,n=i.activeNumArr[t.getTypeIndex()]||0,s=t.max;if(-1==i.activeIdArr.indexOf(t.id)&&s<=n){if(!p.RoleCenter.instans.bagRoomEnough())return void r.AM.showBagNotEnough();var a=new o.ActiveBoxC2GS;a.cfgId=e,h.GSM.sendServer(a),c.E.ins.event(d.EventName.TASK_COMPLETE_EFFECT_POP)}else t.moduleID&&0<t.moduleID.length&&l.MainButtonStruct.Ins.OpenModule(t.moduleID[0][1],t.moduleID[1][1])}},e}(ui.achievement.page.DailyTasksPageUI);t.DailyTaskPage=w}),define("src/g/achieve/ctrl/DailyTaskPageCtrl",["require","exports","src/g/achieve/view/DailyTaskPage","../../../manager/RoleCenter","../../net/messages/OpResultType","../../net/messages/sbkActiveData","../../../utils/system/FloatEffect","../../../core/E","../../../meta/CurrencyVo","../../../utils/ItemUtils","../../../config/GameConfig","../../../enum/EventName","../../../manager/NewRedHintsCenter","../../../manager/GameSocketManager","../../accessctrl/AccessCenter","../../../utils/system/DateUitl"],function(e,t,i,l,n,s,h,u,c,d,g,p,o,a,r,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(){}return e.prototype.init=function(){l.RoleCenter.instans.on(n.enumOpResultType.active_setOne+"",this,this.active_SetOne),l.RoleCenter.instans.on(n.enumOpResultType.active_clear+"",this,this.active_Clear),l.RoleCenter.instans.on(n.enumOpResultType.active_getBox+"",this,this.active_getBox),a.GSM.ins.on(s.sbkActiveData.KEY,this,this.onInitDataCome),r.AccessCenter.ins.on(r.enumAccessId.dailyTask,this,this.checkDailyTaskRed),u.E.ins.on(p.EventName.ADDED_LEVEL,this,this.checkDailyTaskRed)},e.prototype.onInitDataCome=function(){Laya.timer.frameOnce(2,this,this.checkDailyTaskRed)},e.prototype.showPage=function(e){this._view||(this._view=new i.DailyTaskPage),e&&(e.removeChildren(),this._view.showPage(),e.addChild(this._view))},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.active_SetOne=function(e){var t=l.RoleCenter.instans.vo.ActiveData,i=e.reservedata[0],n=e.reservedata[1];t.activeNumArr[i]=n,this._view&&this._view.refreshData(),this.checkDailyTaskRed()},e.prototype.active_Clear=function(e){l.RoleCenter.instans.vo.ActiveData.resetdata(),this._view&&this._view.refreshData(),this.checkDailyTaskRed()},e.prototype.active_getBox=function(e){var t=l.RoleCenter.instans.vo,i=t.ActiveData,n=e.reservedata[0],s=e.reservedata[1];-1==i.activeIdArr.indexOf(n)&&i.activeIdArr.push(n);for(var a=g.GameConfig.activeTaskJSON[e.reservedata[0]],o=0;o<a.reward.length;o++){var r=d.ItemUtils.getItemOrEq(a.reward[o][0]);r instanceof c.CurrencyVo?t[r.define]+=a.reward[o][1]*s:t.chgItemCount(a.reward[o][0],a.reward[o][1]*s),h.FE.getFloat(r.name+"x"+a.reward[o][1]*s,d.ItemUtils.getColorByQuality(r.quality))}1<s&&a.cost&&0<a.cost.length&&(t.GOLD-=a.cost[0][1]),i.ACTIVEBOX+=a.hyd,u.E.ins.event(p.EventName.DAILY_TASK_HYD_CHANGED),this._view&&this._view.refreshData(),this.checkDailyTaskRed()},e.prototype.checkDailyTaskRed=function(){if(r.AccessCenter.ins.checkOpen(r.enumAccessId.dailyTask)){var e,t,i=m.DateUtil.getKFDay(),n=l.RoleCenter.instans.vo.getCurLv(),s=l.RoleCenter.instans.vo.ActiveData;for(var a in g.GameConfig.activeTaskJSON)if(e=g.GameConfig.activeTaskJSON[a],-1==s.activeIdArr.indexOf(e.id)&&(t="ACRIVITYBOX"==e.type?s.ACTIVEBOX:this.checkLimit(e,i,n)&&s.activeNumArr[e.getTypeIndex()]||0,e.max<=t))return void o.NewRedHintsCenter.ins.setRedHintOpenOrClose(o.enumRedHints.daily_task,!0)}o.NewRedHintsCenter.ins.setRedHintOpenOrClose(o.enumRedHints.daily_task,!1)},e.prototype.checkLimit=function(e,t,i){if(e.limit){var n=e.limit.length;if(0<n&&i<e.limit[0])return!1;if(1<n&&i>e.limit[1])return!1;if(2<n&&t<e.limit[2])return!1;if(3<n&&t>e.limit[3])return!1}return!0},e}();t.DailyTaskPageCtrl=f}),define("src/g/achieve/view/NewMedalPage",["require","exports","../../net/messages/ChopLongZhuMedalC2GS","../../net/messages/OpResultType","../../../manager/GameSocketManager","../../../manager/RoleCenter","../../../config/GameConfig","../../net/messages/sbkFormula","../../Effects/UIEffectsFactory","../../../utils/ItemUtils","../../../init/Switches","../../accessctrl/AccessCenter","../../Effects/UIEffectsEnum","../../clearRes/ClearResM","../../../init/TextConst"],function(e,t,n,s,a,o,r,i,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function e(){var e=t.call(this)||this;return e._attrAdd=0,e.initEvents(),e.onLoadUIEF(),g.ClearResM.addBgUrl(e.bgimg.skin),e.htxt_skill_desc.style.color="#b98e42",e.htxt_skill_desc.style.font="SimHei",e.htxt_skill_desc.style.fontSize=20,e}return __extends(e,t),e.prototype.showPage=function(){this.refreshData(),this.bgimg.restskin(),g.ClearResM.resetViewImg(this)},e.prototype.refreshData=function(){this._currLv=o.RoleCenter.instans.vo.getMedalLv(),this._currStar=o.RoleCenter.instans.vo.medal_star;var e=r.GameConfig.medalStarJson[this._currStar];if(e){var t=e.prop[0][1];this._attrAdd=t/i.sbkFormula.BASEDIV_VAL,this.htxt_skill_desc.innerHTML=p.TextConst.get(251,(100*this._attrAdd).toFixed(0))}this.setStarShow(this._currStar),this.setStarInfo(),this.updateLvAttr(this._currLv),this.updateNextLvAttr(this._currLv+1),this.updateCost(this._currLv+1)},e.prototype.initEvents=function(){this.btn_lv_up.on(Laya.Event.CLICK,this,this.onLevelUpClikHandler),this.btn_star_up.on(Laya.Event.CLICK,this,this.onStarUpClikHandler),this.item_cost.setJump(p.TextConst.get(804),new Laya.Handler(this,this.onHydGetClikHandler))},e.prototype.onLoadUIEF=function(){l.UIEffectsFactory.Ins.createSAniAndCenter(this.effect_lv_up,d.UIEffectsEnum.btn_001)},e.prototype.onLevelUpClikHandler=function(){var e=r.GameConfig.medal[this._currLv+1];if(e)if(o.RoleCenter.instans.vo[e.cost[0][0]]>=e.cost[0][1]){var t=new n.ChopLongZhuMedalC2GS;t.curLv=this._currLv,t.msgidx=s.enumOpResultType.medal_lv,a.GSM.sendServer(t)}else this.onHydGetClikHandler()},e.prototype.onHydGetClikHandler=function(){u.Switches.ins.event(c.enumAccessId.dailyTask,[!0,!0])},e.prototype.onStarUpClikHandler=function(){var e=o.RoleCenter.instans.vo,t=r.GameConfig.medalStarJson[e.medal_star+1];if(t)if(e.ACHIEVEPOINT>=t.condition){var i=new n.ChopLongZhuMedalC2GS;i.msgidx=s.enumOpResultType.medal2_lv,i.curLv=this._currStar,a.GSM.sendServer(i)}else this.onStarGetClikHandler()},e.prototype.onStarGetClikHandler=function(){u.Switches.ins.event(c.enumAccessId.achievement,[!0,!0])},e.prototype.setStarShow=function(e){for(var t=0;t<10;)this.star_group.getChildAt(t).skin=t<e?"res/custom/fuben_xingxing1.png":"res/custom/fuben_xingxing2.png",t++},e.prototype.changeStr=function(){var e=o.RoleCenter.instans.vo,t=r.GameConfig.medalStarJson[e.medal_star+1];t&&(e.ACHIEVEPOINT>=t.condition?this.btn_star_up.label=p.TextConst.get(206):this.btn_star_up.label=p.TextConst.get(207))},e.prototype.setStarInfo=function(){this.btn_star_up.disabled=!1;var e=o.RoleCenter.instans.vo,t=r.GameConfig.medalStarJson[e.medal_star],i=r.GameConfig.medalStarJson[e.medal_star+1];i||(i=t,this.btn_star_up.disabled=!0),t&&(this.img_progress_bar.scaleX=Math.min(1,e.ACHIEVEPOINT/i.condition),this.lab_progress.changeText(e.ACHIEVEPOINT+"/"+i.condition),this._iconAni&&(this._iconAni.removeSelf(),this._iconAni.clear(),this._iconAni=null),this._iconAni=l.UIEffectsFactory.Ins.createSAniAndCenter(this.sp_icon,t.icon),this.img_skill_icon.skin=h.ItemUtils.getSkillIconByIconId(t.skillicon),this.lab_star_name.changeText(t.skillname)),this.changeStr()},e.prototype.updateLvAttr=function(e){var t=r.GameConfig.medal[e];if(t){this.lab_curr_title.changeText(t.name);for(var i=t.prop.length,n=0;n<i;)"HP"==t.prop[n][0]&&this.lab_HP.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),"ATT"==t.prop[n][0]&&this.lab_ATT.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),"PDEF"==t.prop[n][0]&&this.lab_PDEF.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),"SDEF"==t.prop[n][0]&&this.lab_SDEF.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),n++}},e.prototype.updateNextLvAttr=function(e){var t=r.GameConfig.medal[e];if(t){this.lab_next_title.changeText(t.name);for(var i=t.prop.length,n=0;n<i;)"HP"==t.prop[n][0]&&this.lab_HP_next.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),"ATT"==t.prop[n][0]&&this.lab_ATT_next.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),"PDEF"==t.prop[n][0]&&this.lab_PDEF_next.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),"SDEF"==t.prop[n][0]&&this.lab_SDEF_next.changeText((Number(t.prop[n][1])*(1+this._attrAdd)>>0).toString()),n++}else this.lab_next_title.changeText(p.TextConst.get(208)),this.lab_HP_next.visible=!1,this.lab_ATT_next.visible=!1,this.lab_PDEF_next.visible=!1,this.lab_SDEF_next.visible=!1},e.prototype.updateCost=function(e){var t=r.GameConfig.medal[e];if(t){var i=h.ItemUtils.getCurrencyVoByDefine(t.cost[0][0]);this.item_cost.setNeedName(i.name,h.ItemUtils.getSmallIcon(i.icon)),this.item_cost.setQualColor(h.ItemUtils.getColorByQuality(i.quality));var n=o.RoleCenter.instans.vo[t.cost[0][0]];this.item_cost.setNeed(n,t.cost[0][1]),this.item_cost.visible=!0,this.btn_lv_up.disabled=!1}else this.item_cost.visible=!1,this.btn_lv_up.disabled=!0},e}(ui.achievement.page.MedalPageUI);t.NewMedalPage=m}),define("src/g/achieve/ctrl/NewMedalPageCtrl",["require","exports","src/g/achieve/view/NewMedalPage","../../../manager/RoleCenter","../../net/messages/OpResultType","../../../config/GameConfig","../../../plugin/sbkPropTool","../../../enum/EventName","../../../manager/NewRedHintsCenter","../../../core/E","../../accessctrl/AccessCenter","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum"],function(e,t,i,a,n,o,r,l,s,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(){}return e.prototype.init=function(){a.RoleCenter.instans.on(n.enumOpResultType.medal_lv.toString(),this,this.onMedalLvUpHandler),a.RoleCenter.instans.on(n.enumOpResultType.medal2_lv.toString(),this,this.onMedalStarUpHandler),h.E.ins.once(l.EventName.INIT_SELFSETOVER,this,this.onSelfInfoCome),u.AccessCenter.ins.on(u.enumAccessId.xunzhang,this,this.checkXunZhangRed)},e.prototype.checkXunZhangRed=function(){this.checkMedalLvRed(),this.checkMedalStarRed()},e.prototype.onSelfInfoCome=function(){this.checkMedalLvRed(),this.checkMedalStarRed(),h.E.ins.on(l.EventName.ACHIEVEMENT_STAR_CHANGED,this,this.checkMedalStarRed),h.E.ins.on(l.EventName.DAILY_TASK_HYD_CHANGED,this,this.checkMedalLvRed)},e.prototype.showPage=function(e){e.removeChildren(),this._page||(this._page=new i.NewMedalPage),e.addChild(this._page),this._page.showPage()},e.prototype.refreshData=function(){},e.prototype.onMedalLvUpHandler=function(e){if(e.opresult){var t=a.RoleCenter.instans.vo;t.setMedalLv(e.reservedata[0]);var i=o.GameConfig.medal[e.reservedata[0]];t.prop_xunZhang.reset();var n=o.GameConfig.medal[t.getMedalLv()];if(null!=n&&0!=n.prop.length&&r.sbkPropTool.reSetProp(t.prop_xunZhang,n.prop),t.reCheckComBat(),a.RoleCenter.instans.event(l.EventName.FIGHT_UP,e.reservedata[1]),a.RoleCenter.instans.vo[i.cost[0][0]]-=i.cost[0][1],h.E.ins.event(l.EventName.DAILY_TASK_HYD_CHANGED),this._page.refreshData(),this.checkMedalLvRed(),h.E.ins.event(l.EventName.UPDATEMEDAL),this._page){var s=c.UIEffectsFactory.Ins.playAniOnce(d.UIEffectsEnum.levelupOk,this._page.aniSp,1.3,1.3);this._page.once(Laya.Event.REMOVED,this,function(){s&&s.destroy()})}}},e.prototype.onMedalStarUpHandler=function(e){if(e.opresult){var t=a.RoleCenter.instans.vo;t.medal_star=e.reservedata[0];o.GameConfig.medalStarJson[e.reservedata[0]];t.prop_xunZhang2.reset();var i=o.GameConfig.medalStarJson[t.medal_star];if(null!=i&&0!=i.prop.length&&r.sbkPropTool.reSetProp(t.prop_xunZhang2,i.prop),t.reCheckComBat(),a.RoleCenter.instans.event(l.EventName.FIGHT_UP,e.reservedata[1]),this._page.refreshData(),this.checkMedalStarRed(),h.E.ins.event(l.EventName.UPDATE_MEDAL_STAR),this._page){var n=c.UIEffectsFactory.Ins.playAniOnce(d.UIEffectsEnum.portBar,this._page.aniSp,1.3,1.3);this._page.once(Laya.Event.REMOVED,this,function(){n&&n.destroy()})}}},e.prototype.checkMedalStarRed=function(){if(u.AccessCenter.ins.checkOpen(u.enumAccessId.xunzhang)){var e=a.RoleCenter.instans.vo,t=o.GameConfig.medalStarJson[e.medal_star+1];if(t&&e.ACHIEVEPOINT>=t.condition)return void s.NewRedHintsCenter.ins.setRedHintOpenOrClose(s.enumRedHints.medal_star,!0)}s.NewRedHintsCenter.ins.setRedHintOpenOrClose(s.enumRedHints.medal_star,!1)},e.prototype.checkMedalLvRed=function(){if(u.AccessCenter.ins.checkOpen(u.enumAccessId.xunzhang)){var e=o.GameConfig.medal[a.RoleCenter.instans.vo.getMedalLv()+1];if(e&&a.RoleCenter.instans.vo[e.cost[0][0]]>=e.cost[0][1])return void s.NewRedHintsCenter.ins.setRedHintOpenOrClose(s.enumRedHints.medal_lv,!0)}s.NewRedHintsCenter.ins.setRedHintOpenOrClose(s.enumRedHints.medal_lv,!1)},e}();t.NewMedalPageCtrl=g}),define("src/g/achieve/view/JJPreview",["require","exports","../../../config/GameConfig","../../../component/GAnimation"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(a){function e(){var e=a.call(this)||this;e.list_eff.renderHandler=new Laya.Handler(e,e.renderHandler);var t=o.GameConfig.fengshenJson,i=[];for(var n in t){var s=t[n];0<s.title&&i.push(s)}return e.list_eff.array=i,e.bg.btn_back.on(Laya.Event.CLICK,e,e.close),e.bg.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,a),e.prototype.renderHandler=function(e,t){var i=e.dataSource,n=e.getChildByName("sp_ani"),s=e.getChildByName("lab_count"),a=n.getChildByName("ani");s.text=""+(t+1),a||((a=new r.GAnimation).x=n.width/2,a.y=n.height/2,a.name="ani",n.addChild(a),a.play()),a.load("dynamic2/chenghao/"+i.title+".json")},e}(ui.achievement.page.JJPreviewUI);t.JJPreview=i}),define("src/g/achieve/view/FengShenPage",["require","exports","../../net/messages/sbkFengshenMsg","../../../config/GameConfig","../../../manager/RoleCenter","../../../utils/ItemUtils","../../../manager/GameSocketManager","src/g/hunyin/ctrl/FengShenPageCtrl","../../../meta/ShuXingVo","../../../init/Switches","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../../component/GAnimation","../../clearRes/ClearResM","../../accessctrl/AccessCenter","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../../init/TextConst","../../../utils/RoleUtil","src/g/achieve/view/JJPreview"],function(e,t,o,r,l,a,h,u,n,i,s,c,d,g,p,m,f,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(t){function e(){var e=t.call(this)||this;return e._isFull=!1,e._needArr=[],e.nameArr=[y.TextConst.get(935),y.TextConst.get(936),y.TextConst.get(937),y.TextConst.get(938),y.TextConst.get(939),y.TextConst.get(940),y.TextConst.get(941),y.TextConst.get(942),y.TextConst.get(943)],e.preview.on(Laya.Event.CLICK,e,e.onPreview),e.btn_up.on(Laya.Event.CLICK,e,e.onLevelUpHandler),e.list_task.renderHandler=new Laya.Handler(e,e.onRenderHandler),e.onLoadUIEF(),e.initSkill(),e.item_cost.setJump(y.TextConst.get(481),new Laya.Handler(e,e.onHydGetClikHandler)),e}return __extends(e,t),e.prototype.onPreview=function(){(new _.JJPreview).popup()},e.prototype.onHydGetClikHandler=function(){i.Switches.ins.event(p.enumAccessId.auctions,[!0,!0])},e.prototype.onLoadUIEF=function(){s.UIEffectsFactory.Ins.createSAniAndCenter(this.effect_up,c.UIEffectsEnum.btn_001)},e.prototype.showPage=function(){Laya.timer.frameOnce(1,this,this.refreshData),g.ClearResM.resetViewImg(this),this.refreshAni()},e.prototype.refreshData=function(){if(this.displayedInStage){this._needArr.length=0;var e=r.GameConfig.fengshenJson[l.RoleCenter.instans.vo.fengshenId];if(e){for(var t,i,n=e.condition.length,s=0;s<n;)this._needArr[e.condition[s][0]]=e.condition[s][1],s++;i=0<e.title?(t=e.title,!0):(t=r.GameConfig.fengshenJson[l.RoleCenter.instans.vo.fengshenId+1].title,!1);var a=r.GameConfig.titleJSON[t];if(a){this.showAni?this.showAni.stop():(this.showAni=new d.GAnimation,this.showAni.isLoadedShow=!0,this.showAni.x=this.effect_con.width/2,this.showAni.y=this.effect_con.height/2,this.showAni.scaleX=1.3,this.showAni.scaleY=1.3,this.effect_con.addChild(this.showAni));var o="dynamic2/chenghao/"+a.icon+".json";this.showAni.forceShowFirstFrame=!0,this.showAni.load(o,i),this.effect_con.gray=!i}this.list_task.array=e.condition}this.updateAttr(),this.updateAttrNext(),this.list_task.refresh(),this.updateCost(),this.updateProgress()}},e.prototype.updateProgress=function(){if(this.img_progress_lab.visible=this.box_progress.visible=!this._isFull,!this._isFull){var e=l.RoleCenter.instans.vo.fengshenId,t=r.GameConfig.fengshenJson[e];if(t){for(var i=t.condition.length,n=0,s=0;n<i;)u.FengShenPageCtrl.getCurrAttr(t.condition[n][0])>=t.condition[n][1]&&s++,n++;this.lab_progress.changeText(s+"/"+i),this.progress.scaleX=Math.min(1,s/i);var a=r.GameConfig.fengshenJson[l.RoleCenter.instans.vo.fengshenId+1];if(this.effect_up.visible=!1,i<=s&&a)l.RoleCenter.instans.vo.bagdata.getItemCount(t.cost[0][0])>=t.cost[0][1]&&(this.effect_up.visible=!0)}}},e.prototype.initSkill=function(){this.lab_skill_desc.style.color="#a89e8f",this.lab_skill_desc.style.font="SimHei",this.lab_skill_desc.style.fontSize=14,this.lab_skill_desc.style.leading=5,this.lab_skill_desc.style.wordWrap=!0;for(var e=a.ItemUtils.getWingPassiveVoById(4),t=e.desc,i=0;i<e.effect.length;i++)t=t.replace("{"+e.effect[i][0]+"}","<font  color='#349320'>"+e.effect[i][1]/100+"%</font>");this.img_skill_icon.skin=a.ItemUtils.getSkillIconByIconId(e.skill_id),this.lab_skill_name.changeText(e.name),this.lab_skill_desc.innerHTML=t},e.prototype.updateAttr=function(){var e=r.GameConfig.fengshenJson[l.RoleCenter.instans.vo.fengshenId];if(e){this.lab_STRONGHURT.visible=this.lab_STRONG.visible=!0;for(var t=e.prop.length,i=0;i<t;)"HP"==e.prop[i][0]?(n.ShuXingVo.getString4Vo(Number(e.prop[i][1]),a.ItemUtils.getShuXingByName(e.prop[i][0])),this.lab_STRONG.changeText(n.ShuXingVo.getString4Vo(Number(e.prop[i][1]),a.ItemUtils.getShuXingByName(e.prop[i][0])))):"ATT"==e.prop[i][0]&&this.lab_STRONGHURT.changeText(n.ShuXingVo.getString4Vo(Number(e.prop[i][1]),a.ItemUtils.getShuXingByName(e.prop[i][0]))),i++}else this.lab_STRONGHURT.visible=this.lab_STRONG.visible=!1},e.prototype.updateAttrNext=function(){var e=r.GameConfig.fengshenJson[l.RoleCenter.instans.vo.fengshenId+1];this.btn_up.disabled=e?this._isFull=!1:this._isFull=!0},e.prototype.onLevelUpHandler=function(){var e=l.RoleCenter.instans.vo.fengshenId,t=r.GameConfig.fengshenJson[e];if(t&&r.GameConfig.fengshenJson[e+1]){for(var i=t.condition.length,n=0,s=!0;n<i;){if(u.FengShenPageCtrl.getCurrAttr(t.condition[n][0])<t.condition[n][1]){s=!1;break}n++}if(s){if(l.RoleCenter.instans.vo.bagdata.getItemCount(t.cost[0][0])>=t.cost[0][1]){var a=new o.FengshenUpgradeC2GS;a.curId=l.RoleCenter.instans.vo.fengshenId,h.GSM.sendServer(a)}}else m.FE.upItems(y.TextConst.get(934),f.BubbleEnum.center)}},e.prototype.onRenderHandler=function(e,t){var i=this.list_task.array[t][0];e.lab_name.changeText(this.nameArr[i-1]),e.icon.skin="dynamic/taskicon/"+i+".png",e.btn_get.offAll();var n=u.FengShenPageCtrl.getCurrAttr(i),s=this._needArr[i]||0;s<=n||this._isFull?(e.lab_complet.visible=!0,e.lab_progress.visible=!1,e.btn_get.visible=!1):(e.lab_complet.visible=!1,e.lab_progress.visible=!0,e.btn_get.visible=!0,1==i?e.lab_progress.changeText(a.ItemUtils.getLVString(n)+"/"+a.ItemUtils.getLVString(s)):9==i?e.lab_progress.changeText(this.miniNum(n)+"/"+this.miniNum(s)):e.lab_progress.changeText(n+"/"+s),e.lab_progress.color=s<=n?"#03bb00":"#ff0f15",e.btn_get.on(Laya.Event.CLICK,this,this.gotoHandler,[i]))},e.prototype.miniNum=function(e){return 1e4<e?y.TextConst.get(1,Math.floor(e/1e4)):e.toString()},e.prototype.gotoHandler=function(e){1==e?i.Switches.ins.event(4,!1):2==e?i.Switches.ins.event(36,!1):3==e?i.Switches.ins.event(38,!1):4==e?i.Switches.ins.event(39,!1):5==e?i.Switches.ins.event(40,!1):6==e?i.Switches.ins.event(40,!1):7==e?i.Switches.ins.event(42,!1):8==e?i.Switches.ins.event(32):9==e&&i.Switches.ins.event(40)},e.prototype.updateCost=function(){var e=l.RoleCenter.instans.vo.fengshenId,t=r.GameConfig.fengshenJson[e];if(t&&0<t.cost.length){var i=a.ItemUtils.getItemVoById(t.cost[0][0]);this.item_cost.setNeedName(i.name,a.ItemUtils.getIconByIconId(i.icon)),this.item_cost.setQualColor(a.ItemUtils.getColorByQuality(i.quality));var n=l.RoleCenter.instans.vo.bagdata.getItemCount(t.cost[0][0]);this.item_cost.setNeed(n,t.cost[0][1]),this.item_cost.visible=!0}else this.item_cost.visible=!1},e.prototype.refreshAni=function(){var e=l.RoleCenter.instans.vo.getOpenHeroByIdx(0);v.RoleUtil.refreshZww(e,100,this.role_show.wing,this.role_show.weapon,this.role_show.role,this.role_show.ani_fumo)},e}(ui.achievement.page.FengShenPageUI);t.FengShenPage=C}),define("src/g/hunyin/ctrl/FengShenPageCtrl",["require","exports","src/g/achieve/view/FengShenPage","../../net/messages/OpResultType","../../../manager/RoleCenter","../../../core/E","../../../enum/EventName","../../net/messages/PropFightMain","../../../plugin/sbkPropTool","../../../config/GameConfig","../../accessctrl/AccessCenter","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../../manager/RedDotM"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(){this.costItemId=-1}return e.prototype.changePerson=function(e,t){},e.prototype.getTitle=function(){return"res/fengshen/jingjie_biaoti.png"},e.prototype.hidePage=function(){},e.prototype.destroyPage=function(){},e.prototype.init=function(){g.RedDotM.fengshenCtrl=e,s.RoleCenter.instans.on(n.enumOpResultType.fengshen_upgrade.toString(),this,this.onUpgradeBackHandler),a.E.ins.once(o.EventName.INIT_SELFSETOVER,this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.skillUpgrade_one.toString(),this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.skillUpgrade_all.toString(),this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.longLin.toString(),this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.longWen.toString(),this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.EquipProChg_soul.toString(),this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.EquipProChg_gem.toString(),this,this.checkFengShenRed),s.RoleCenter.instans.on(n.enumOpResultType.EquipProChg_strong.toString(),this,this.checkFengShenRed),a.E.ins.on(o.EventName.ADDED_ZHUANSHENG,this,this.checkFengShenRed),a.E.ins.on(o.EventName.WINGSTAGEUP,this,this.checkFengShenRed),a.E.ins.on(o.EventName.ADDED_LEVEL,this,this.checkFengShenRed),a.E.ins.on(o.EventName.UPDATE_COMBAT,this,this.checkFengShenRed),a.E.ins.on(o.EventName.CHANGEITEM_COUNT,this,this.onItemChanged),u.AccessCenter.ins.on(u.enumAccessId.fengshen,this,this.checkFengShenRed)},e.prototype.onItemChanged=function(e){if(-1==this.costItemId){this.costItemId=0;var t=s.RoleCenter.instans.vo.fengshenId,i=h.GameConfig.fengshenJson[t];i&&0<i.cost.length&&(this.costItemId=i.cost[0][0])}this.costItemId==e&&(this.checkFengShenRed(),this._page&&this._page.refreshData())},e.prototype.showPage=function(e){this._page||(this._page=new i.FengShenPage),e&&(e.removeChildren(),e.addChild(this._page),this._page.showPage())},e.prototype.refreshData=function(){},e.prototype.onUpgradeBackHandler=function(e){if(e.opresult){var t=h.GameConfig.fengshenJson[s.RoleCenter.instans.vo.fengshenId];s.RoleCenter.instans.vo.fengshenId=e.reservedata[0];var i=h.GameConfig.fengshenJson[e.reservedata[0]];s.RoleCenter.instans.vo.prop_fengShen=new r.PropFengShen,l.sbkPropTool.reSetProp(s.RoleCenter.instans.vo.prop_fengShen,i.prop),this.costItemId=0,i&&0<i.cost.length&&(this.costItemId=i.cost[0][0]),s.RoleCenter.instans.vo.reCheckComBat(),0<e.reservedata[1]&&s.RoleCenter.instans.event(o.EventName.FIGHT_UP,e.reservedata[1]),this._page&&this._page.refreshData(),t&&s.RoleCenter.instans.vo.chgItemCount(t.cost[0][0],-1*t.cost[0][1]),this.checkFengShenRed(),this._page&&c.UIEffectsFactory.Ins.playAniOnce(d.UIEffectsEnum.levelupOk,this._page.aniSp,1.3,1.3)}},e.prototype.checkFengShenRed=function(){g.RedDotM.check(u.enumAccessId.fengshen)},e.getCurrAttr=function(e){var t=0;return 1==e?t=s.RoleCenter.instans.vo.getCurLv():2==e?t=s.RoleCenter.instans.vo.getAllStrongLv():3==e?t=s.RoleCenter.instans.vo.getAllGemLv():4==e?t=s.RoleCenter.instans.vo.getAllSoulLv():5==e?t=s.RoleCenter.instans.vo.getAllLongSoulLv():6==e?t=s.RoleCenter.instans.vo.getAllLongWenLv():7==e?t=s.RoleCenter.instans.vo.getMaxWingLv():8==e?t=s.RoleCenter.instans.vo.getMaxSkillLv():9==e&&(t=s.RoleCenter.instans.vo.combat),t},e}();t.FengShenPageCtrl=p}),define("src/g/chop/view/ChopRoleShowView",["require","exports","../../../utils/RoleUtil"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setHeroData=function(e){this.p_heroData=e,this.refreshAni()},t.prototype.refreshAni=function(){i.RoleUtil.refreshZww(this.p_heroData,100,this.ani_wing,this.ani_weapon,this.ani_role,this.ani_fumo)},t}(ui.chop.ChopRoleShowUI);t.ChopRoleShowView=n}),define("src/g/chop/view/ChopTitleNameShow",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e){var t=i.call(this)||this;return t.updateRanking(),t}return __extends(e,i),e.prototype.updateRanking=function(){this.lab_name.text="",this.lab_rank.text=""},e.prototype.setHeroName=function(e){this.lab_name.text=e},e.prototype.setChopName=function(e){this.lab_rank.text=e},e}(ui.chop.ChopTitleNameShowUI);t.ChopTitleNameShow=i}),define("src/g/chop/view/ChopPreview",["require","exports","../../../config/GameConfig"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.bg.btn_back.on(Laya.Event.CLICK,e,e.close),e.bg.btn_close.on(Laya.Event.CLICK,e,e.close),e.list_chop.renderHandler=new Laya.Handler(e,e.onListRenderHandler),e.list_chop.scrollBar.elasticDistance=100,e.bg.imgInnerBg.bottom=14,e}return __extends(e,t),e.prototype.popPanel=function(){if(!this._inited){var e=[];for(var t in n.GameConfig.chopJSON)e.push(t);this.list_chop.array=e,this._inited=!0}this.popup()},e.prototype.onListRenderHandler=function(e,t){var i=n.GameConfig.chopJSON[e.dataSource];e.img_name.skin="dynamic/chopicon/"+i.nameIcon+".png",e.txt_need.text=i.need.toString()},e}(ui.chop.ChopPreviewUI);t.ChopPreview=i}),define("src/g/chop/view/ChopTaskPage",["require","exports","../../../config/GameConfig","../../../manager/RoleCenter","../../../meta/MainButtonVo","../../net/messages/ChopLongZhuMedalC2GS","../../../manager/GameSocketManager","../../../core/E","../../../enum/EventName","../../peronboss/view/ItemIconView","../../../utils/pro/GotoUtil","../../accessctrl/AccessCenter","../../clearRes/ClearResM","../../../utils/effects/ListEffect","../../../init/TextConst"],function(e,t,u,c,s,a,o,r,l,d,i,n,h,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function e(){var e=t.call(this)||this;return e.list_item.scrollBar.elasticDistance=100,e.list_item.renderHandler=new Laya.Handler(e,e.onRenderListHandler),r.E.ins.on(l.EventName.CHOP_REFRESH_VIEW,e,e.refreshData),e.btn_goto.on(Laya.Event.CLICK,e,e.gotoMonthCard),e}return __extends(e,t),e.prototype.gotoMonthCard=function(){i.gotoModuleID(n.enumAccessId.super_monthCard)},e.prototype.showPage=function(e){e.removeChildren(),e.addChild(this),this.refreshData(),h.ClearResM.addBgUrl(this.bgimg.skin),this.bgimg.restskin(),h.ClearResM.resetViewImg(this),this._isPlay||(g.ListEffect.flyIn(this.list_item,4,1,-1,500,100),this._isPlay=!0)},e.prototype.refreshData=function(){if(this.displayedInStage){this.updateList();var e=c.RoleCenter.instans.vo.getChopData(),t=e.MEETBATTLE+e.KUANGGONG+e.YAJIE+e.TIANTI+e.XUEREN+e.ZHUQUAN+e.chopTask;this.lab_ww.changeText(t.toString())}},e.prototype.onRenderListHandler=function(e,t){var i=e.dataSource,n=u.GameConfig.chopTaskCfg[i];e.img_icon.skin="dynamic/taskicon/"+n.icon+".png",e.txt_name.changeText(n.name);var s=c.RoleCenter.instans.vo.getChopData(),a=Number(s[n.type]),o=n.need;e.htxt_content.style.color="#ccb694",e.htxt_content.style.font="SimHei",e.htxt_content.style.fontSize=18,e.htxt_content.innerHTML=a<o?p.TextConst.get(325,n.dec,"#ff0000",a,o):p.TextConst.get(325,n.dec,"#00ff00",a,o);for(var r,l=n.reward?n.reward.length:0,h=0;h<l;)r=n.reward[h],d.ItemIconView.setItem(e["item"+h],r),h++;e.img_get.visible=!1,e.btn_get.visible=!1,e.effect.visible=!1,e.btn_get.offAll(),-1==s.gotChopTaskIdArr.indexOf(n.id)?o<=a?(e.btn_get.label=p.TextConst.get(204),e.btn_get.visible=!0,e.effect.visible=!0):n.moduleID&&0<n.moduleID.length&&(e.btn_get.label=p.TextConst.get(200),e.btn_get.visible=!0):e.img_get.visible=!0,e.btn_get.visible&&e.btn_get.on(Laya.Event.CLICK,this,this.onTaskGetHandler,[i])},e.prototype.onTaskGetHandler=function(e){var t=u.GameConfig.chopTaskCfg[e];if(t){var i=c.RoleCenter.instans.vo.getChopData();if(-1==i.gotChopTaskIdArr.indexOf(t.id)&&Number(i[t.type])>=t.need){var n=new a.GetChopTaskMsg;n.taskId=e,o.GSM.sendServer(n),r.E.ins.event(l.EventName.TASK_COMPLETE_EFFECT_POP)}else t.moduleID&&0<t.moduleID.length&&s.MainButtonStruct.Ins.OpenModule(t.moduleID[0][1],t.moduleID[1][1])}},e.prototype.updateList=function(){var e,t=-1,i=0,n=c.RoleCenter.instans.vo.getChopData(),s=[],a=0,o=!0,r=0;for(var l in u.GameConfig.chopTaskCfg)"KUANGGONG"!=(e=u.GameConfig.chopTaskCfg[l]).type&&(a=e.id/10>>0,i=e.id,a!=t&&(o=!1,0<r&&s.push(r),t=a),o||(r=i),-1==n.gotChopTaskIdArr.indexOf(i)&&(o=!0));0<r&&s.push(r),s.sort(this.compareFn),this.list_item.array=s},e.prototype.compareFn=function(e,t){var i=u.GameConfig.chopTaskCfg[e],n=c.RoleCenter.instans.vo.getChopData(),s=Number(n[i.type]),a=i.need,o=i.id;-1!=n.gotChopTaskIdArr.indexOf(i.id)?o+=2e4:s<a&&(o+=1e4),i=u.GameConfig.chopTaskCfg[t],s=Number(n[i.type]),a=i.need;var r=i.id;return-1!=n.gotChopTaskIdArr.indexOf(i.id)?r+=2e4:s<a&&(r+=1e4),o-r},e}(ui.chop.ChopTaskPageUI);t.ChopTaskPage=m}),define("src/g/chop/view/ChopGetPreview",["require","exports","../../../config/GameConfig","../../../init/TextConst","../../peronboss/view/ItemIconView","../../../manager/RoleCenter","../../net/messages/ChopLongZhuMedalC2GS","../../../manager/GameSocketManager","../../../enum/EventName","../../../core/E","../../../meta/MainButtonVo"],function(e,t,u,c,d,g,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.bg.btn_back.on(Laya.Event.CLICK,e,e.close),e.bg.btn_close.on(Laya.Event.CLICK,e,e.close),e.list_getchop.renderHandler=new Laya.Handler(e,e.onListRenderHandler),e.list_getchop.scrollBar.elasticDistance=100,e.bg.imgInnerBg.bottom=14,e.bg.btn_back.visible=!1,e}return __extends(e,t),e.prototype.popPanel=function(){this.updateList(),this.popup()},e.prototype.onListRenderHandler=function(e,t){var i=e.dataSource,n=u.GameConfig.chopTaskCfg[i];e.img_icon.skin="dynamic/taskicon/"+n.icon+".png",e.txt_name.changeText(n.name);var s=g.RoleCenter.instans.vo.getChopData(),a=Number(s[n.type]),o=n.need;e.htxt_content.style.color="#ccb694",e.htxt_content.style.font="SimHei",e.htxt_content.style.fontSize=18,e.htxt_content.innerHTML=a<o?c.TextConst.get(325,n.dec,"#ff0000",a,o):c.TextConst.get(325,n.dec,"#00ff00",a,o);for(var r,l=n.reward?n.reward.length:0,h=0;h<l;)r=n.reward[h],d.ItemIconView.setItem(e["item"+h],r),h++;e.img_get.visible=!1,e.btn_get.visible=!1,e.effect.visible=!1,e.btn_get.offAll(),-1==s.gotChopTaskIdArr.indexOf(n.id)?o<=a?(e.btn_get.label=c.TextConst.get(204),e.btn_get.visible=!0,e.effect.visible=!0):n.moduleID&&0<n.moduleID.length&&(e.btn_get.label=c.TextConst.get(200),e.btn_get.visible=!0):e.img_get.visible=!0,e.btn_get.visible&&e.btn_get.on(Laya.Event.CLICK,this,this.onTaskGetHandler,[i])},e.prototype.onTaskGetHandler=function(e){var t=u.GameConfig.chopTaskCfg[e];if(t){var i=g.RoleCenter.instans.vo.getChopData();if(-1==i.gotChopTaskIdArr.indexOf(t.id)&&Number(i[t.type])>=t.need){var n=new s.GetChopTaskMsg;n.taskId=e,a.GSM.sendServer(n),r.E.ins.event(o.EventName.TASK_COMPLETE_EFFECT_POP)}else t.moduleID&&0<t.moduleID.length&&(l.MainButtonStruct.Ins.OpenModule(t.moduleID[0][1],t.moduleID[1][1]),this.close())}},e.prototype.updateList=function(){var e,t=-1,i=0,n=g.RoleCenter.instans.vo.getChopData(),s=[],a=0,o=!0,r=0;for(var l in u.GameConfig.chopTaskCfg)"KUANGGONG"!=(e=u.GameConfig.chopTaskCfg[l]).type&&(a=e.id/10>>0,i=e.id,a!=t&&(o=!1,0<r&&s.push(r),t=a),o||(r=i),-1==n.gotChopTaskIdArr.indexOf(i)&&(o=!0));0<r&&s.push(r),s.sort(this.compareFn),this.list_getchop.array=s},e.prototype.compareFn=function(e,t){var i=u.GameConfig.chopTaskCfg[e],n=g.RoleCenter.instans.vo.getChopData(),s=Number(n[i.type]),a=i.need,o=i.id;-1!=n.gotChopTaskIdArr.indexOf(i.id)?o+=2e4:s<a&&(o+=1e4),i=u.GameConfig.chopTaskCfg[t],s=Number(n[i.type]),a=i.need;var r=i.id;return-1!=n.gotChopTaskIdArr.indexOf(i.id)?r+=2e4:s<a&&(r+=1e4),o-r},e}(ui.chop.ChopGetPreviewUI);t.ChopGetPreview=i}),define("src/g/chop/view/ChopView",["require","exports","../../../utils/ItemUtils","../../../manager/RoleCenter","../../../config/GameConfig","src/g/chop/view/ChopRoleShowView","../../net/messages/rank/sbkRankDataBase","../../../manager/GameSocketManager","../../../core/GNet","../../net/messages/rank/RankDataGS2C","../../../core/E","../../../enum/EventName","src/g/chop/view/ChopTitleNameShow","../../net/messages/ChopLongZhuMedalC2GS","../../net/messages/OpResultType","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","src/g/chop/view/ChopPreview","../../../init/Switches","../../accessctrl/AccessCenter","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../clearRes/ClearResM","../../../init/TextConst","src/g/chop/view/ChopGetPreview","../../../manager/NewRedHintsCenter"],function(e,t,i,l,u,n,a,s,o,r,h,c,d,g,p,m,f,y,v,_,C,w,I,b,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R=function(t){function e(){var e=t.call(this)||this;return e.rankDataArr=[],e.applyOtherUsername=[],e._firstList=[],e.showSkillId=3,e.htxt_income.style.color="#e1a32a",e.htxt_income.style.font="SimHei",e.htxt_income.style.fontSize=20,e.htxt_income.style.align="center",e.initRank(),e.initSkill(),e.updateProperty(),e.lab_paihang.on(Laya.Event.CLICK,e,e.openRanking),e.btn_preview.on(Laya.Event.CLICK,e,e.openChopPanel),e.lab_weiwang.on(Laya.Event.CLICK,e,e.openGetWeiwangPanel),e.on(Laya.Event.REMOVED,e,e.removedHandler),e.btn_up.on(Laya.Event.CLICK,e,e.onChopLvUpHandler),l.RoleCenter.instans.on(p.enumOpResultType.chop_lv.toString(),e,e.onUpgradeBack),e.onLoadUIEF(),s.GSM.ins.on(g.GetChopTaskMsg.KEY,e,e.onChangEffVis),s.GSM.ins.on(g.UpDataChopTaskGS2C.KEY,e,e.onChangEffVis),e}return __extends(e,t),e.prototype.onUpgradeBack=function(e){this.displayedInStage&&e.opresult&&m.UIEffectsFactory.Ins.playAniOnce(f.UIEffectsEnum.chop,this.effect_lv_up,2,2)},e.prototype.openRanking=function(){v.Switches.ins.event(_.enumAccessId.rank,[!0,!0,6])},e.prototype.onLoadUIEF=function(){this.ani_put=m.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.lab_weiwang,f.UIEffectsEnum.getTip_Big,1,.9),this.ani_put.visible=E.NewRedHintsCenter.ins.checkRedIsOpen(E.enumRedHints.chop_task)},e.prototype.onChangEffVis=function(){var e=this;Laya.timer.frameOnce(2,this,function(){e.ani_put.visible=E.NewRedHintsCenter.ins.checkRedIsOpen(E.enumRedHints.chop_task)})},e.prototype.openChopPanel=function(){this._chopPreview||(this._chopPreview=new y.ChopPreview),this._chopPreview.popPanel()},e.prototype.closeClearRes=function(){h.E.ins.off(c.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),I.ClearResM.clearResFolder("chop/")},e.prototype.openGetWeiwangPanel=function(){this._chopGetP||(this._chopGetP=new S.ChopGetPreview),this._chopGetP.popPanel()},e.prototype.initRank=function(){this.showList=new Array,this.showNameList=new Array;for(var e=1;e<=3;e++){var t=new n.ChopRoleShowView;this.showList.push(t),this["role"+e].addChild(t);var i=new d.ChopTitleNameShow(e);this.showNameList.push(i),this["name"+e].addChild(i)}},e.prototype.resultHandler=function(e){if(e.opresult&&e.rankIdArr[0]==a.enumRankID.rankid_6){this.rankDataArr=e.rankDataArr;for(var t=Math.min(this.rankDataArr.length,3),i=[],n=this.applyOtherUsername.length=0;n<t;n++){var s=this.rankDataArr[n];i.push(s.username),this.applyOtherUsername.push(s.username)}o.GNet.getOtherData(i)}},e.prototype.otherDataHandler=function(){this._firstList.length=0;for(var e=this.applyOtherUsername.length,t=0;t<e;t++){var i=this.applyOtherUsername[t],n=l.RoleCenter.instans.getOtherData(i);n&&this._firstList.push(n)}this.updateRankShow()},e.prototype.updateRankShow=function(){for(var e=Math.min(this.rankDataArr.length,3),t=0;t<e;t++){var i=this.rankDataArr[t],n=this.showList[t],s=this.showNameList[t];s.setHeroName(i.nickname);var a=u.GameConfig.chopJSON[10<i.value1?11:i.value1+1],o="";a&&(o=a.name),s.setChopName(o);for(var r=this._firstList.length,l=0;l<r;){var h=this._firstList[l];if(h&&i&&h.username==i.username){n.setHeroData(h.openhero[0]);break}l++}}},e.prototype.initSkill=function(){var e=i.ItemUtils.getWingPassiveVoById(this.showSkillId);if(e){this.skill_item.lab_num.visible=!1,this.skill_item.img_item.skin=i.ItemUtils.getSkillIconByIconId(e.icon),this.skill_name.text=e.name;var t=e.desc;t=t.replace("{INCHURT}","<font color='#349320'>"+e.effect[0][1]/100+"%</font>"),this.skill_des.style.font="SimHei",this.skill_des.style.fontSize=18,this.skill_des.style.color="#c0b4a3",this.skill_des.innerHTML=t}},e.prototype.updateProperty=function(){var e=l.RoleCenter.instans.self.chopData.chopLv,t=u.GameConfig.chopJSON[e+1];if(t){for(var i=t.prop.length,n=0;n<i;){"HP"==(o=t.prop[n])[0]?this.curr_hp.text=o[1]:"ATT"==o[0]&&(this.curr_att.text=o[1]),n++}this.img_name.skin="dynamic/chopicon/"+t.nameIcon+".png",this.htxt_income.innerHTML=b.TextConst.get(324,t.income)}var s=0,a=u.GameConfig.chopJSON[e+2];if(a){for(i=a.prop.length,n=0;n<i;){var o;"HP"==(o=a.prop[n])[0]?this.next_hp.text=o[1]:"ATT"==o[0]&&(this.next_att.text=o[1]),n++}s=a.need}else this.next_hp.text="",this.next_att.text="",this.layer_next.visible=!1,this.lab_maxlv.visible=!0;this.txt_progress.text=l.RoleCenter.instans.self.JUNGONG+"/"+s;var r=Math.min(l.RoleCenter.instans.self.JUNGONG/s,1);this.exp_bar.scrollRect?this.exp_bar.scrollRect.width=this.exp_bar.width*r:this.exp_bar.scrollRect=new Laya.Rectangle(0,0,this.exp_bar.width*r,this.exp_bar.height)},e.prototype.showPage=function(e){e.removeChildren(),e.addChild(this),this.refreshData(),h.E.ins.on(c.EventName.CHOP_REFRESH_VIEW,this,this.refreshData),I.ClearResM.addBgUrl(this.bgimg.skin),this.bgimg.restskin(),I.ClearResM.resetViewImg(this),h.E.ins.on(c.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),h.E.ins.on(c.EventName.UPDATE_CHOPTASK_STATE,this,this.checkChopRed)},e.prototype.refreshData=function(){this.displayedInStage&&(this.requestRankData(),this.updateProperty(),this.ani_put.visible=E.NewRedHintsCenter.ins.checkRedIsOpen(E.enumRedHints.chop_task))},e.prototype.checkChopRed=function(e){this.ani_put.visible=e,this._chopGetP&&this._chopGetP.isPopup&&this._chopGetP.updateList()},e.prototype.removedHandler=function(){s.GSM.ins.off(r.RankDataGS2C.KEY,this,this.resultHandler),h.E.ins.off(c.EventName.OTHERDATA_UPDATE,this,this.otherDataHandler),h.E.ins.off(c.EventName.CHOP_REFRESH_VIEW,this,this.refreshData),h.E.ins.off(c.EventName.UPDATE_CHOPTASK_STATE,this,this.checkChopRed)},e.prototype.requestRankData=function(){s.GSM.ins.on(r.RankDataGS2C.KEY,this,this.resultHandler),h.E.ins.on(c.EventName.OTHERDATA_UPDATE,this,this.otherDataHandler),o.GNet.getRankList(a.enumRankID.rankid_6,1,3)},e.prototype.onChopLvUpHandler=function(){var e=l.RoleCenter.instans.self.chopData.chopLv,t=u.GameConfig.chopJSON[e+2];if(t){if(l.RoleCenter.instans.self.JUNGONG>=t.need){var i=new g.ChopLongZhuMedalC2GS;i.msgidx=p.enumOpResultType.chop_lv,i.curLv=e,s.GSM.sendServer(i)}}else C.FE.upItems(b.TextConst.get(208),w.BubbleEnum.center)},e.prototype.destroy=function(){this.removedHandler(),this.showList&&(this.showList.length=0),this.showNameList&&(this.showNameList.length=0),this.lab_paihang.offAll(),this.btn_preview.offAll(),this.lab_weiwang.offAll(),this.offAll(),t.prototype.destroy.call(this)},e}(ui.chop.ChopViewUI);t.ChopView=R}),define("src/g/achieve/ctrl/GActiveCtrl",["require","exports","src/g/achieve/view/GActiveView","../../../core/E","../../../enum/EventName","../../../manager/RoleCenter","../../../utils/UIUtils","src/g/achieve/ctrl/AchievementTaskPageCtrl","src/g/achieve/ctrl/DailyTaskPageCtrl","src/g/achieve/ctrl/NewMedalPageCtrl","../../../init/Switches","../../accessctrl/AccessCenter","../../proxy/MultiLevelUIProxy","src/g/chop/view/ChopView","src/g/chop/view/ChopTaskPage","../../relic/ctrl/RelicPageCtrl","../../../manager/GuideCenter","../../../enum/GuideTargetName","../../clearRes/ClearResM","../../../runtime/resload/GameResLoad","../../zzsq/ctrl/ZzsqCtrl","../../net/messages/OpResultType","../../../meta/ShenQiLevelVo","../../../meta/ShenQiVo","../../../meta/ShenQiStarLevelVo"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C,w,I,b,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(){function e(){this.closeOther=!0;var e=u.Switches.ins;e.on(c.enumAccessId.daily,this,this.onOpenPage,[c.enumAccessId.daily]),e.on(c.enumAccessId.relic,this,this.onOpenPage,[c.enumAccessId.relic]),e.on(c.enumAccessId.chop,this,this.onOpenPage,[c.enumAccessId.chop]),e.on(c.enumAccessId.dailyTask,this,this.onOpenPage,[c.enumAccessId.dailyTask]),e.on(c.enumAccessId.shenqi_view,this,this.onOpenPage,[c.enumAccessId.shenqi_view]),this._DailyQuest=new l.DailyTaskPageCtrl,this._DailyQuest.init(),this._achieveCtrl=new r.AchievementTaskPageCtrl,this._achieveCtrl.init(),this._medalCtrl=new h.NewMedalPageCtrl,this._medalCtrl.init(),this._zzsq=new C.ZzsqCtrl}return e.prototype.onOpenPage=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t?(c.enumAccessId.daily==e&&(e=c.AccessCenter.ins.checkOpen(c.enumAccessId.dailyTask)?c.enumAccessId.dailyTask:c.enumAccessId.relic),this.openActive(e,i,n)):this._tabProxy&&this._tabProxy.revertTab()},e.prototype.addEvent=function(){this._view.bjview.btn_back.on(Laya.Event.CLICK,this,this.closeActiveView),this._view.bjview.btn_close.on(Laya.Event.CLICK,this,this.closeActiveView)},e.prototype.init=function(){this._view=new i.GActiveView,_.GameResLoad.load("res/atlas/res/daybtn.json"),this._dailyTaskIndex=d.MultiLevelUIProxy.mergeIndex([0,0]),this._chopTaskIndex=d.MultiLevelUIProxy.mergeIndex([0,4]),this._achievementIndex=d.MultiLevelUIProxy.mergeIndex([0,1]),this._xunzhangIndex=d.MultiLevelUIProxy.mergeIndex([0,3]),this._zhanbuIndex=d.MultiLevelUIProxy.mergeIndex([0,2]),this._isRegist||Laya.timer.frameOnce(2,this,this.registUIToGuide),f.GuideCenter.ins.registerGuideObject(y.GuideTargetName.PRACTICE_BTN_BACK,this._view),this._tabProxy=new d.MultiLevelUIProxy,this._tabProxy.registerTab(this._view.tab_page,0),this._tabProxy.registerTagIndex(c.enumAccessId.end,this._zhanbuIndex),this._tabProxy.registerTagIndex(c.enumAccessId.dailyTask,0),this._tabProxy.registerTagIndex(c.enumAccessId.relic,1),this._tabProxy.registerTagIndex(c.enumAccessId.chop,2),this._tabProxy.registerTagIndex(c.enumAccessId.shenqi_view,3),this._tabProxy.selectHandler=new Laya.Handler(this,this.changePage),a.RoleCenter.instans.on(w.enumOpResultType.zzshenqi_up+"",this,this.upHandler),a.RoleCenter.instans.on(w.enumOpResultType.zzshenqi_xing+"",this,this.upHandler),a.RoleCenter.instans.on(w.enumOpResultType.zzshenqi_jihuo+"",this,this.upHandler),n.E.ins.on(s.EventName.CHANGEITEM_COUNT,this,this.onChangeItem),this.addEvent()},e.prototype.onChangeItem=function(e){-1==b.ShenQiVo.costIdArr.indexOf(e)&&-1==I.ShenQiLevelVo.costIdArr.indexOf(e)&&-1==S.ShenQiStarLevelVo.costIdArr.indexOf(e)||(n.E.ins.event(s.EventName.UPDATE_ZZSQRED),this._page&&this._page.refreshData())},e.prototype.upHandler=function(e){var t=e.reservedata[0],i=a.RoleCenter.instans.vo.zzshenqiData;switch(e.msgidx){case w.enumOpResultType.zzshenqi_up:i.setLV(t);break;case w.enumOpResultType.zzshenqi_xing:i.setXingLV(t);break;case w.enumOpResultType.zzshenqi_jihuo:-1==i.getLV(t)&&i.enable(t)}n.E.ins.event(s.EventName.UPDATE_ZZSQRED),this._page&&this._page.refreshData()},e.prototype.registUIToGuide=function(){var e=o.UIUtils.getGlobalBound(this._view.bjview.btn_back);e&&f.GuideCenter.ins.registerInteractionArea(y.GuideTargetName.PRACTICE_BTN_BACK,e),this._isRegist=!0},e.prototype.changePage=function(e){switch(e){case 0:this._page=this._DailyQuest,this._view.bjview.img_title.skin="res/achievement/meirirenwu_biaoti_wenzi1.png",this.showTaskBar(!1);break;case 2:this._chopPage||(this._chopPage=new g.ChopView),this._page=this._chopPage,this._view.bjview.img_title.skin="res/chop/guanzhi_biaoti_wenzi1.png",this.showTaskBar(!1);break;case 3:this._page=this._zzsq,this._view.bjview.img_title.skin=this._zzsq.getTitle();break;case 1:this.relicPage||(this.relicPage=new m.RelicPageCtrl),this._page=this.relicPage,this._view.bjview.img_title.skin="res/relic/sqtitle.png",this.showTaskBar(!1);break;case this._dailyTaskIndex:this._page=this._DailyQuest,this._view.bjview.img_title.skin="res/achievement/meirirenwu_biaoti_wenzi1.png",this.showTaskBar(!0);break;case this._xunzhangIndex:this._page=this._medalCtrl,this._view.bjview.img_title.skin="res/achievement/xunzhang_biaoti_wenzi1.png",this.showTaskBar(!0);break;case this._achievementIndex:this._page=this._achieveCtrl,this._view.bjview.img_title.skin="res/achievement/chengjiu_biaoti_wenzi1.png",this.showTaskBar(!0);break;case this._chopTaskIndex:this._chopTaskPage||(this._chopTaskPage=new p.ChopTaskPage),this._page=this._chopTaskPage,this._view.bjview.img_title.skin="res/chop/guanzhi_biaoti_wenzi2.png",this.showTaskBar(!0)}this._page&&this._page.showPage(this._view.bjview.box_page),n.E.ins.on(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),this._view.select_img&&(this._view.select_img.x=this._view.tab_page2.items[this._view.tab_page2.selectedIndex].x,this._view.select_img.y=this._view.tab_page2.items[this._view.tab_page2.selectedIndex].y)},e.prototype.openGetWeiwangPanel=function(){this._chopTaskPage||(this._chopTaskPage=new p.ChopTaskPage),this._page=this._chopTaskPage,this._view.bjview.img_title.skin="res/chop/guanzhi_biaoti_wenzi2.png",this.showTaskBar(!1),this._page&&this._page.showPage(this._view.bjview.box_page),n.E.ins.on(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.closeClearRes=function(){n.E.ins.off(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),v.ClearResM.clearFolderByUrl("dynamic2/activity/"),v.ClearResM.clearUrl(this._view.bjview.img_bg.skin),v.ClearResM.clearResFolder("chop/"),v.ClearResM.clearResFolder("fengshen/")},e.prototype.showTaskBar=function(e){this._view.tab_page2.visible=e,this._view.page_bg.visible=e},e.prototype.openActive=function(e,t,i){void 0===e&&(e=0),this.pageIdx=e,this.forceOpen=i,this.closeOther=t,_.GameResLoad.load("res/atlas/res/achievement.json"),this.realOpenActive(this.pageIdx)},e.prototype.realOpenActive=function(e){void 0===e&&(e=0),this._view||this.init(),this._tabProxy.open(e),n.E.ins.event(s.EventName.COMPTYPE_OPENVIEW,y.GuideTargetName.PRACTICE_VIEW),this._view.showView(this.closeOther,this.forceOpen)},e.prototype.closeActiveView=function(){this._view.hideView(),n.E.ins.event(s.EventName.COMPTYPE_CLOSEVIEW,y.GuideTargetName.PRACTICE_VIEW)},e}();t.GActiveCtrl=E}),define("src/g/chop/view/ChopMainView",["require","exports","../../../manager/RuledescManager","../../../manager/LayerManager","src/g/chop/view/ChopView","src/g/chop/view/ChopTaskPage","../../proxy/MultiLevelUIProxy","../../accessctrl/AccessCenter"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function e(){var e=t.call(this)||this;return e._tabProxy=new o.MultiLevelUIProxy,e._tabProxy.registerTab(e.tab_btns,0),e._tabProxy.registerTagIndex(r.enumAccessId.chop,0),e._tabProxy.registerTagIndex(r.enumAccessId.chopTask,1),e._tabProxy.selectHandler=new Laya.Handler(e,e.changePage),e.bg.btn_help.visible=!0,e.bg.btn_help.on(Laya.Event.CLICK,e,e.onClick,[8]),e}return __extends(e,t),e.prototype.onClick=function(e){i.RuledescManager.showRuledesc(e)},e.prototype.showView=function(e){void 0===e&&(e=0),this._tabProxy.open(e),n.LayerManager.addInPOPWindowLayer(this)},e.prototype.revertTab=function(){this._tabProxy.revertTab()},e.prototype.changePage=function(e){0==e?(this._chopPage||(this._chopPage=new s.ChopView),this._page=this._chopPage,this.bg.img_title.skin="res/chop/guanzhi_biaoti_wenzi1.png"):1==e&&(this._chopTaskPage||(this._chopTaskPage=new a.ChopTaskPage),this._page=this._chopTaskPage,this.bg.img_title.skin="res/chop/guanzhi_biaoti_wenzi2.png"),this._page.showPage(this.bg.box_page)},e.prototype.refreshData=function(){this._page&&this._page.refreshData()},e.prototype.destroy=function(){this._tabProxy&&(this._tabProxy.destroy(),this._tabProxy=null),this._chopPage&&(this._chopPage.destroy(),this._chopPage=null),this._chopTaskPage&&(this._chopTaskPage.destroy(),this._chopTaskPage=null),t.prototype.destroy.call(this),this.bg.box_page.removeChildren(),this.bg.btn_close.offAll(),this.bg.btn_back.offAll(),this.bg.btn_help.offAll()},e}(ui.chop.ChopMainViewUI);t.ChopMainView=l}),define("src/g/chop/ctrl/ChopViewCtrl",["require","exports","../../clearRes/ClearResM","../../../core/E","../../../enum/EventName","../../../manager/RoleCenter","../../../utils/system/FloatEffect","../../../manager/GameSocketManager","../../net/messages/OpResultType","../../../config/GameConfig","../../../plugin/sbkPropTool","src/g/chop/view/ChopMainView","../../net/messages/ChopLongZhuMedalC2GS","../../../utils/ItemUtils","../../../meta/CurrencyVo","../../../manager/NewRedHintsCenter","../../accessctrl/AccessCenter"],function(e,t,i,r,l,h,o,n,s,u,c,a,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(){}return e.prototype.init=function(){h.RoleCenter.instans.on(s.enumOpResultType.chop_lv.toString(),this,this.onUpgradeBack),n.GSM.ins.on(d.GetChopTaskMsg.KEY,this,this.onSumitTaskHandler),n.GSM.ins.on(d.UpDataChopTaskGS2C.KEY,this,this.onUpdateTaskAttrHandler),h.RoleCenter.instans.on(s.enumOpResultType.chopTask_clear.toString(),this,this.onTaskClearHandler),r.E.ins.once(l.EventName.INIT_SELFSETOVER,this,this.initDataHandler),f.AccessCenter.ins.on(f.enumAccessId.chop,this,this.checkChopRed),f.AccessCenter.ins.on(f.enumAccessId.chopTask,this,this.checkChopTaskRed)},e.prototype.onTaskClearHandler=function(){var e=h.RoleCenter.instans.vo.getChopData();e.gotChopTaskIdArr.length=0,e.MEETBATTLE=0,e.KUANGGONG=0,e.YAJIE=0,e.TIANTI=0,e.XUEREN=0,e.ZHUQUAN=0,e.chopTask=0,r.E.ins.event(l.EventName.CHOP_REFRESH_VIEW),this.checkChopTaskRed()},e.prototype.initDataHandler=function(){this.checkChopTaskRed(),this.checkChopRed(),r.E.ins.on(l.EventName.ROLE_ATTR_CHANGED_JUNGONG,this,this.checkChopRed)},e.prototype.checkChopTaskRed=function(){if(f.AccessCenter.ins.checkOpen(f.enumAccessId.chop)){var e,t=h.RoleCenter.instans.vo.getChopData();for(var i in u.GameConfig.chopTaskCfg)if((e=u.GameConfig.chopTaskCfg[i])&&-1==t.gotChopTaskIdArr.indexOf(e.id)&&Number(t[e.type])>=e.need)return m.NewRedHintsCenter.ins.setRedHintOpenOrClose(m.enumRedHints.chop_task,!0),void r.E.ins.event(l.EventName.UPDATE_CHOPTASK_STATE,!0);m.NewRedHintsCenter.ins.setRedHintOpenOrClose(m.enumRedHints.chop_task,!1)}else m.NewRedHintsCenter.ins.setRedHintOpenOrClose(m.enumRedHints.chop_task,!1);r.E.ins.event(l.EventName.UPDATE_CHOPTASK_STATE,!1)},e.prototype.checkChopRed=function(){if(f.AccessCenter.ins.checkOpen(f.enumAccessId.chop)){var e=h.RoleCenter.instans.self.chopData.chopLv,t=u.GameConfig.chopJSON[e+2];if(t&&h.RoleCenter.instans.self.JUNGONG>=t.need)return void m.NewRedHintsCenter.ins.setRedHintOpenOrClose(m.enumRedHints.chop_up,!0)}m.NewRedHintsCenter.ins.setRedHintOpenOrClose(m.enumRedHints.chop_up,!1)},e.prototype.onSumitTaskHandler=function(e){var t=h.RoleCenter.instans.vo,i=h.RoleCenter.instans.vo.getChopData();-1==i.gotChopTaskIdArr.indexOf(e.taskId)&&i.gotChopTaskIdArr.push(e.taskId);for(var n=u.GameConfig.chopTaskCfg[e.taskId],s=0;s<n.reward.length;s++){var a=g.ItemUtils.getItemOrEq(n.reward[s][0]);a instanceof p.CurrencyVo?t[a.define]+=n.reward[s][1]:t.chgItemCount(n.reward[s][0],n.reward[s][1]),o.FE.getFloat(a.name+"x"+n.reward[s][1],g.ItemUtils.getColorByQuality(a.quality))}this.checkChopTaskRed(),r.E.ins.event(l.EventName.CHOP_REFRESH_VIEW)},e.prototype.onUpdateTaskAttrHandler=function(e){h.RoleCenter.instans.vo.getChopData()[e.key]=e.value,this.checkChopTaskRed(),r.E.ins.event(l.EventName.CHOP_REFRESH_VIEW)},e.prototype.onUpgradeBack=function(e){if(e.opresult){var t=h.RoleCenter.instans.vo,i=e.reservedata[0],n=e.reservedata[1],s=e.reservedata[2];if(t.JUNGONG=n,t.chopLv!=i){t.chopLv=i,c.sbkPropTool.resetGz();for(var a=0;a<t.heronum;a++){var o=t.getOpenHeroByIdx(a);o.combat=o.reCheckComBat()}t.combat=t.reCheckComBat(),h.RoleCenter.instans.event(l.EventName.FIGHT_UP,s)}r.E.ins.event(l.EventName.CHOP_REFRESH_VIEW),this.checkChopRed()}},e.prototype.openPanel=function(e){void 0===e&&(e=0),this._view||(this._view=new a.ChopMainView,this._view.bg.btn_close.on(Laya.Event.CLICK,this,this.closePanel),this._view.bg.btn_back.on(Laya.Event.CLICK,this,this.closePanel)),this._view.showView(e),i.ClearResM.resetViewImg(this._view),r.E.ins.on(l.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.closeClearRes=function(){r.E.ins.off(l.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),i.ClearResM.clearResFolder("chop/")},e.prototype.closePanel=function(){this._view&&(this._view.removeSelf(),this._view.destroy(),this._view=null)},e}();t.ChopViewCtrl=y}),define("src/g/hunyin/view/HunYinBg",["require","exports","../../../manager/LayerManager","../../../core/E","../../../enum/EventName","../../../enum/GuideTargetName","../../../manager/GuideCenter","../../../utils/UIUtils"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e){void 0===e&&(e=!0),n.E.ins.event(s.EventName.COMPTYPE_OPENVIEW,a.GuideTargetName.JOINT_ATTACK_VIEW),i.LayerManager.addInPOPWindowLayer(this,e),this._isRegist||Laya.timer.frameOnce(2,this,this.registUIToGuide)},t.prototype.registUIToGuide=function(){var e=r.UIUtils.getGlobalBound(this.tab_page.getChildByName("item0"));e&&(o.GuideCenter.ins.registerInteractionArea(a.GuideTargetName.hunyin_tab_item0,e),o.GuideCenter.ins.registerGuideObject(a.GuideTargetName.hunyin_tab_item0,this)),(e=r.UIUtils.getGlobalBound(this.tab_page.getChildByName("item1")))&&(o.GuideCenter.ins.registerInteractionArea(a.GuideTargetName.hunyin_tab_item1,e),o.GuideCenter.ins.registerGuideObject(a.GuideTargetName.hunyin_tab_item1,this)),(e=r.UIUtils.getGlobalBound(this.tab_page.getChildByName("item2")))&&(o.GuideCenter.ins.registerInteractionArea(a.GuideTargetName.hunyin_tab_item2,e),o.GuideCenter.ins.registerGuideObject(a.GuideTargetName.hunyin_tab_item2,this)),this._isRegist=!0},t.prototype.hideView=function(){this.removeSelf(),this.view_bg.box_page.removeChildren(),n.E.ins.event(s.EventName.COMPTYPE_CLOSEVIEW,a.GuideTargetName.JOINT_ATTACK_VIEW)},t.prototype.destroyView=function(){this.hideView()},t}(ui.hunyin.GHunYinBgUI);t.HunYinBg=l}),define("src/g/hunyin/view/page/HunPowerPage",["require","exports","../../../net/messages/ComboCultivateMsg","../../../../manager/GameSocketManager","../../../../manager/RoleCenter","../../../../meta/HunYinVo","../../../../utils/ItemUtils","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../itemGets/View/ItemGetDlg","../../../accessctrl/AccessCenter","../../../Effects/UIEffectsFactory","../../../Effects/UIEffectsEnum","../../../../core/E","../../../../enum/EventName","../../../../enum/GuideTargetName","../../../clearRes/ClearResM","../../../../init/TextConst"],function(e,t,i,n,s,a,l,o,r,h,u,c,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){function e(){var e=t.call(this)||this;return e.nowSelectJob=0,e.nowSkillId=0,e.nowLv=0,e.needItem=0,e.canUp=!1,e.lvMax=!1,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.addEvent(),this.lab_des.style.font="SimHei",this.lab_des.style.fontSize=18,this.lab_des.style.color="#a89e8f",this.lab_des.style.align="left",this.lab_des.style.wordWrap=!0,this.lab_des.style.leading=5,this.item_cost.setJump(y.TextConst.get(238),new Laya.Handler(this,this.getItem)),this.ani_put=c.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.btn_up,d.UIEffectsEnum.btn_001),this.on(Laya.Event.REMOVED,this,this.onRemove)},e.prototype.onRemove=function(){},e.prototype.getItem=function(){var e=l.ItemUtils.getItemVoById(this.needItem);(new h.ItemGetDlg).initByVo(e,null).popup()},e.prototype.addEvent=function(){this.btn_up.on(Laya.Event.CLICK,this,this.onUpLv),this.on(Laya.Event.REMOVED,this,this.onRemoved),g.E.ins.on(p.EventName.CHANGEITEM_COUNT,this,this.onChangeItem)},e.prototype.onChangeItem=function(e){4999==e&&this.refreshData()},e.prototype.onRemoved=function(){this.ani.removeChildren()},e.prototype.onUpLv=function(){if(this.lvMax)o.FE.upItems(y.TextConst.get(584),r.BubbleEnum.center);else if(this.canUp){g.E.ins.event(p.EventName.COMPTYPE_CLICK,m.GuideTargetName.SOUL_POWER_BTN_UP);var e=new i.ComboUpgradeMsg;e.comboIdx=this.nowSelectJob-1,e.curLv=this.data.comboLvArr[this.nowSelectJob-1],n.GSM.sendServer(e)}else this.getItem()},e.prototype.changeSelect=function(e){this.nowSelectJob=e,this.renderView()},e.prototype.renderView=function(){var e=0;for(this.nowSelectJob;e<3;e++)switch(e){case 0:this["skill_"+e].skin="res/index1/zhujiemian_heji_jienng3.png";break;case 1:this["skill_"+e].skin="res/index1/zhujiemian_heji_jienng2.png";break;case 2:this["skill_"+e].skin="res/index1/zhujiemian_heji_jienng1.png"}this.img_bg.skin="";var t="res/bg/bg_"+(this.nowSelectJob-1)+".jpg";this.img_bg.skin=t,f.ClearResM.addBgUrl(t),this.setNeed(),this.renderProp(),this.setFightNum()},e.prototype.renderProp=function(){var e=l.ItemUtils.getSkillVoById(this.nowSkillId);this.lab_name.text=e.name;var t=e.des;if(this.lab_lv.text=" Lv."+this.nowLv,this.lab_des.innerHTML=t,null!=e.buffArr&&0<e.buffArr.length&&(null==e.ext||0==e.ext.length)){for(var i=e.des,n=0;n<e.buffArr.length;n++){var s=l.ItemUtils.getBuffVoById(e.buffArr[n]),a=s.rate,o=s.ext,r=a[this.nowLv]||a[a.length-1];i=i.replace("{0}",r+""),o&&0<o.length&&(i=i.replace("{1}",(o[this.nowLv]||o[o.length-1])+""))}this.lab_des.innerHTML=i}else{i=null==(r=e.ext[this.nowLv])?e.des:e.des.replace("{0}",r+"");e.buff&&(i=i.replace("{1}",e.buff+"")),e.rate&&(i=i.replace("{1}",e.rate[0]+"")),this.lab_des.innerHTML=i}},e.prototype.setFightNum=function(){for(var e=0,t=0;t<this.data.comboLvArr.length;t++){var i=a.HeJiStruct.Ins.getHeSkillVo(t,this.data.comboLvArr[t]);i&&(e+=i.power)}this.box_fight.num_Fight.value=e+""},e.prototype.setNeed=function(){var e=a.HeJiStruct.Ins.getHeSkillVo(this.nowSelectJob-1,this.nowLv),t=a.HeJiStruct.Ins.getHeSkillVo(this.nowSelectJob-1,this.nowLv+1),i=null,n=0;n=t?(this.lvMax=!1,i=l.ItemUtils.getItemVoById(t.cost[0][0]),t.cost[0][1]):(this.lvMax=!0,i=l.ItemUtils.getItemVoById(e.cost[0][0]),e.cost[0][1]),this.item_cost.setNeedName(i.name,l.ItemUtils.getSmallIcon(i.icon)),this.item_cost.setQualColor(l.ItemUtils.getColorByQuality(i.quality)),this.needItem=i.id;var s=this.user.bagdata.getItemCount(this.needItem);this.item_cost.setNeed(s,n,this.lvMax,!0),this.canUp=n<=s,this.ani_put.visible=this.canUp&&!this.lvMax},e.prototype.refreshData=function(){this.findMin()},e.prototype.showView=function(){this.user=s.RoleCenter.instans.vo,this.data=this.user.comboData,this.findMin()},e.prototype.showAni=function(){c.UIEffectsFactory.Ins.playAniOnce(d.UIEffectsEnum.levelupOk,this.ani,1.3,1.3)},e.prototype.findMin=function(){for(var e=0,t=this.data.comboLvArr[0],i=1;i<this.data.comboLvArr.length;i++)1==i?this.data.comboLvArr[i]<t&&u.AccessCenter.ins.checkOpen(u.enumAccessId.heji2)&&(t=this.data.comboLvArr[i],e=i):2==i&&this.data.comboLvArr[i]<t&&u.AccessCenter.ins.checkOpen(u.enumAccessId.heji3)&&(t=this.data.comboLvArr[i],e=i);this.nowSkillId=this.data.comboSkill[e],this.nowLv=t,this.changeSelect(e+1)},e}(ui.hunyin.page.HunPowerUI);t.HunPowerPage=v}),define("src/g/hunyin/ctrl/page/HunPowerCtrl",["require","exports","src/g/hunyin/view/page/HunPowerPage","../../../../utils/UIUtils","../../../../enum/GuideTargetName","../../../../manager/GuideCenter","../../../clearRes/ClearResM","../../../../init/ResManager"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype.init=function(){var t=this;this._view=new i.HunPowerPage,Laya.timer.frameOnce(2,this,function(){var e=n.UIUtils.getGlobalBound(t._view.btn_up);e&&a.GuideCenter.ins.registerInteractionArea(s.GuideTargetName.SOUL_POWER_BTN_UP,e)})},e.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),o.ClearResM.resetViewImg(this._view),this._view.showView(),e.addChild(this._view),r.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.showAni=function(){this._view&&this._view.showAni()},e.prototype.getTitle=function(){return"res/hunyin/title_hunpower.png"},e.prototype.changePerson=function(e,t){},e.prototype.hidePage=function(){r.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){r.ResManager.getInstance().destroyPageCtrl(this)},e}();t.HunPowerCtrl=l}),define("src/g/hunyin/view/item/HunListItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setIcon=function(e){s.setIcon(e,this)},t.prototype.setName=function(e,t){s.setName(e,t,this)},t.prototype.setSelect=function(e){s.setSelect(e,this)},t.prototype.setOpen=function(e){s.setOpen(e,this)},t}(ui.hunyin.item.HunListItem0UI);t.HunListItem0=i;var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setIcon=function(e){s.setIcon(e,this)},t.prototype.setName=function(e,t){s.setName(e,t,this)},t.prototype.setSelect=function(e){s.setSelect(e,this)},t.prototype.setOpen=function(e){s.setOpen(e,this)},t}(ui.hunyin.item.HunListItem1UI);t.HunListItem1=n;var s=function(){function e(){}return e.setSelect=function(e,t){void 0===e&&(e=!1),t.di_select.visible=e,t.img_di.skin="res/hunyin/XFQ_list"+(e?2:1)+".png"},e.setIcon=function(e,t){t.icon_hunyin.skin=e},e.setName=function(e,t,i){i.img_name.skin=e,i.img_desc.skin=window.oldversion?"res/hunyin/XFQ_listguanggao"+t+"_old.png":"res/hunyin/XFQ_listguanggao"+t+".png";var n=Number(t)%5;0==n&&(n=5),i.img_num.skin="res/hunyin/XFQ_shuzi"+n+".png"},e.setOpen=function(e,t){t.disabled=!e},e}()}),define("src/g/hunyin/view/page/NHunYinListPage",["require","exports","../../../../config/GameConfig","../../../../meta/HunYinVo","src/g/hunyin/view/item/HunListItem","../../../../manager/RoleCenter","../../../Effects/UIEffectsFactory","../../../Effects/UIEffectsEnum","../../../../core/E","../../../../enum/EventName"],function(e,t,a,o,r,l,h,u,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.currChapter=-1,e.openChapterMax=0,e.toY=0,e.initChapter(),i.E.ins.on(n.EventName.HUNYIN_OPEN_JIE,e,e.onOpenjie),e}return __extends(e,t),e.prototype.onOpenjie=function(e){this.displayedInStage&&Number(this.chapterEndIds[this.openChapterMax])==e&&this.showChapter(this.findDefaultShowChapter())},e.prototype.refreshView=function(){this.showChapter(this.findDefaultShowChapter())},e.prototype.setSelect=function(e){for(var t,i=this.pan_box.numChildren,n=0;n<i;)(t=this.pan_box.getChildAt(n)).setSelect(e==Number(t.name)),n++},e.prototype.onClickItem=function(e){this.setSelect(e),i.E.ins.event(n.EventName.HUNYIN_TASK_PAGE,e)},e.prototype.initChapter=function(){var t=this;this.chapterEndIds=[],a.GameConfig.commonJson.hunyinzhangjie.value.split(",").forEach(function(e){t.chapterEndIds.push(Number(e))}),this.btn_turn_left.on(Laya.Event.CLICK,this,this.onTurnLeft),this.btn_turn_right.on(Laya.Event.CLICK,this,this.onTurnRight)},e.prototype.onTurnLeft=function(){this.showChapter(this.currChapter-1)},e.prototype.onTurnRight=function(){this.showChapter(this.currChapter+1)},e.prototype.findDefaultShowChapter=function(){for(var e,t,i=l.RoleCenter.instans.vo.comboData,n=a.GameConfig.hunyin.length,s=0;s<n;)(e=a.GameConfig.hunyin[s+1])&&-1<i.curHunYinTask.idArr.indexOf(e.taskId)&&(t=e.id),s++;for(n=this.chapterEndIds.length,this.openChapterMax=s=0;s<n;)t>Number(this.chapterEndIds[s])&&(this.openChapterMax=s+1),s++;return this.openChapterMax},e.prototype.showChapter=function(e){if(0<=e&&e<=this.openChapterMax){this.currChapter=e,this.img_chapter.skin="res/hunyin/XSQ_guanggao"+(this.currChapter+1)+".jpg",this.btn_turn_left.visible=0<this.currChapter,this.btn_turn_right.visible=this.currChapter<this.openChapterMax;var t=this.currChapter<1?1:Number(this.chapterEndIds[this.currChapter-1])+1,i=Number(this.chapterEndIds[this.currChapter]),n=void 0;for(this.pan_box.removeChildren();t<=i;){if((n=a.GameConfig.hunyin[i])&&(5!=i||-1!=l.RoleCenter.instans.vo.comboData.curHunYinJieArr.indexOf(4))){var s=void 0;i%2==0?(s=new r.HunListItem0).x=263:((s=new r.HunListItem1).x=9,s.y=0),s.name=i.toString(),s.setName(o.HeJiStruct.getHunNameByHeight(n.icon),n.id),s.setIcon(o.HeJiStruct.getHunIconByIconId(n.icon)),s.on(Laya.Event.CLICK,this,this.onClickItem,[i]),s.y=200*(i-t),this.pan_box.addChild(s)}i--}}this.resetItemsState()},e.prototype.resetItemsState=function(){this._uEf?this._uEf.removeSelf():this._uEf=h.UIEffectsFactory.Ins.createSAniById(u.UIEffectsEnum.guide);for(var e,t,i=l.RoleCenter.instans.vo.comboData,n=this.pan_box.numChildren,s=0;s<n;)e=this.pan_box.getChildAt(s),t=a.GameConfig.hunyin[e.name],-1<i.curHunYinJieArr.indexOf(parseInt(e.name))?e.setOpen(!0):-1<i.curHunYinTask.idArr.indexOf(t.taskId)?(e.setOpen(!0),this._uEf&&e.effect&&h.UIEffectsFactory.Ins.centerSAni4Parent(this._uEf,e.effect),this.toY=e.y+e.height/2-this.pan_box.height/2,this.setSelect(t.id)):e.setOpen(!1),s++;Laya.timer.frameOnce(2,this,this.moveToY)},e.prototype.moveToY=function(){var e=this;this.toY=Math.max(this.pan_box.vScrollBar.min,Math.min(this.toY,this.pan_box.vScrollBar.max)),this.toY!=this.pan_box.vScrollBar.value&&(this.pan_box.mouseEnabled=!1,Laya.Tween.to(this.pan_box.vScrollBar,{value:this.toY},500,null,new Laya.Handler(this,function(){e.pan_box.mouseEnabled=!0})))},e}(ui.hunyin.page.HunListViewUI);t.NHunYinListPage=s}),define("src/g/hunyin/ctrl/page/HunYinTrueCtrl",["require","exports","src/g/hunyin/view/page/NHunYinListPage","../../../clearRes/ClearResM","../../../../enum/EventName","../../../../core/E"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.init=function(){this._view=new i.NHunYinListPage},e.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),e.addChild(this._view),n.ClearResM.resetViewImg(this._view),this._view.refreshView(),a.E.ins.on(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.closeClearRes=function(){n.ClearResM.clearFolderByUrl("dynamic/hunyin/"),n.ClearResM.clearResFolder("hunyin/"),a.E.ins.off(s.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.showOpenAni=function(e){},e.prototype.refreshData=function(){this._view&&this._view.refreshView()},e.prototype.onAchivateDebris=function(e){},e.prototype.getTitle=function(){return"res/hunyin/biaoti_faqizhihun.png"},e.prototype.changePerson=function(e,t){},e.prototype.hidePage=function(){},e.prototype.destroyPage=function(){},e}();t.HunYinTrueCtrl=o}),define("src/g/hunyin/RedDot_hunTrue",["require","exports","../../manager/RoleCenter","../../meta/HunYinVo","../../manager/NewRedHintsCenter","../../config/GameConfig","../net/messages/enumStatus","src/g/hunyin/ctrl/HunYinBgCtrl","../../utils/system/DateUitl","../accessctrl/AccessCenter"],function(e,t,y,u,v,_,c,r,C,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(){for(var e in this._redArr=[],this._voArr=[],this.uvo=y.RoleCenter.instans.vo,this.data=this.uvo.comboData,_.GameConfig.hunyin){var t=u.HeJiStruct.Ins.getHunYinVo(parseInt(e));t&&(this._voArr.push(t),this._redArr.push(!1))}i._ins=this}return Object.defineProperty(i,"Ins",{get:function(){return i._ins||new i},enumerable:!0,configurable:!0}),i.prototype.checkTask=function(e){var t=y.RoleCenter.instans.vo.comboData.curHunYinTask,i=t.idArr.indexOf(e.id);if(i<0)return!1;for(var n=t.dataArr[i],s=e.child,a=0;a<s.length;a++){var o=_.GameConfig.hunSubTask[s[a]];if(n.curStatusArr[a]!=c.enumStatus.yilingqu&&r.HunYinBgCtrl.chkNeed(o,n.statusArr[a]))return!0}return!1},i.prototype.checkTaskNeedActivate=function(e){var t=u.HeJiStruct.Ins.getHunYinVo(e),i=y.RoleCenter.instans.vo.getHunTLTDataById(t.taskId);if(-1!=y.RoleCenter.instans.vo.comboData.curHunYinJieArr.indexOf(e))return!1;if(!i)return!1;var n=i.curStatusArr.length;5==e&&4<n&&(n=4);for(var s=0;s<n;s++)if(i.curStatusArr[s]!=c.enumStatus.yilingqu)return!1;var a=_.GameConfig.hunTask[t.taskId];if(a&&a.activation&&0<a.activation.length){var o=a.activation[0][1],r=o%1e3,l=o/1e3>>0,h=C.DateUtil.getKFDay();if(y.RoleCenter.instans.vo.VIP<r&&h<l)return!1}return!0},i.prototype.reCheckHunTrue=function(){for(var e=0;e<this._voArr.length;e++){var t=_.GameConfig.hunTask[this._voArr[e].taskId];t?this._redArr[e]=this.checkTaskNeedActivate(this._voArr[e].id)||this.checkTask(t):this._redArr[e]=!1}v.NewRedHintsCenter.ins.setRedHintOpenOrClose(v.enumRedHints.hejiTrue,this.red()),n.AccessCenter.ins.checkOpen(n.enumAccessId.ring_ling)&&this.reCheckRinglingRed()},i.prototype.red=function(e){return void 0===e&&(e=!1),e?this._redArr:-1<this._redArr.indexOf(!0)},i.prototype.reCheckRinglingRed=function(){var e=!1,t=_.GameConfig.ringLingShow,i=[],n=C.DateUtil.getKFDay(),s=y.RoleCenter.instans.vo.ringLing;for(var a in t){var o=t[a],r=o.display,l=o.id;if(o.day<=n)if(0<r){var h=s.idArr,u=y.RoleCenter.instans.vo.bagdata.getItemCount(r);(-1!=h.indexOf(l)||0<u)&&i.push(o)}else i.push(o)}for(var c=0;c<i.length;c++){var d=i[c];h=(s=y.RoleCenter.instans.vo.ringLing).idArr;if(d){var g=void 0,p=void 0,m=h.indexOf(d.id),f=(g=(p=0<=m?s.lvArr[m]+1e3*d.id:1e3*d.id+1,_.GameConfig.ringLingvo[p])).upcost[0][0];if(e=g.upcost[0][1]<=(u=y.RoleCenter.instans.vo.bagdata.getItemCount(f)))break}}v.NewRedHintsCenter.ins.setRedHintOpenOrClose(v.enumRedHints.ringlinghuan,e),v.NewRedHintsCenter.ins.setRedHintOpenOrClose(v.enumRedHints.hejiTrue,this.red()||e)},i._ins=null,i}();t.RedDot_hunTrue=i}),define("src/g/hunyin/RedDot_hunYin",["require","exports","src/g/hunyin/RedDot_hunTrue"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){e._ins=this}return Object.defineProperty(e,"Ins",{get:function(){return e._ins||new e},enumerable:!0,configurable:!0}),e.prototype.checkAll=function(){i.RedDot_hunTrue.Ins.reCheckHunTrue()},Object.defineProperty(e.prototype,"red_true",{get:function(){return i.RedDot_hunTrue.Ins.red()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"red_all",{get:function(){return this.red_true},enumerable:!0,configurable:!0}),e._ins=null,e}();t.RedDot_hunYin=n}),define("src/g/aegis/view/AegisPage",["require","exports","../../../config/GameConfig","../../../manager/RoleCenter","../../net/messages/enumStatus","../../net/messages/sbkAegisData","../../../manager/GameSocketManager","../../../core/E","../../../enum/EventName","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../../meta/MainButtonVo","../../clearRes/ClearResM","../../../meta/HunYinVo","../../../utils/ItemUtils","../../../component/GAnimation","../../../init/TextConst","../../../init/Switches","../../accessctrl/AccessCenter"],function(e,t,r,a,l,o,h,i,n,u,c,d,g,p,m,f,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(s){function e(){var e=s.call(this)||this;e.labs=[y.TextConst.get(229),y.TextConst.get(230)],e._angle=-198,e._star=0,e.list_task.renderHandler=new Laya.Handler(e,e.onAegisTaskListRenderHandler),e.btn_up.on(Laya.Event.CLICK,e,e.onStarUpHandler),e.btn_jieling.on(Laya.Event.CLICK,e,e.openJie),e.lab_skill_desc.style.color="#a89e8f",e.lab_skill_desc.style.font="SimHei",e.lab_skill_desc.style.fontSize=14,e.lab_skill_desc.style.leading=5,e.lab_skill_desc.style.wordWrap=!0;for(var t=m.ItemUtils.getWingPassiveVoById(5),i=t.desc,n=0;n<t.effect.length;n++)i=i.replace("{"+t.effect[n][0]+"}","<font  color='#349320'>"+t.effect[n][1]/100+"%</font>");return e.img_skill_icon.skin=m.ItemUtils.getSkillIconByIconId(t.skill_id),e.lab_skill_name.changeText(t.name),e.lab_skill_desc.innerHTML=i,e.htxt_desc.style.color="#ffc039",e.htxt_desc.style.font="SimHei",e.htxt_desc.style.fontSize=20,e.htxt_desc.style.align="center",e.htxt_desc.innerHTML=y.TextConst.get(962),e}return __extends(e,s),e.prototype.openJie=function(){v.Switches.ins.event(_.enumAccessId.ring_ling)},e.prototype.loadEffect=function(){this.ani_put=u.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.btn_up,c.UIEffectsEnum.btn_001)},e.prototype.onAegisTaskListRenderHandler=function(e,t){var i=r.GameConfig.aegisTaskJson[e.dataSource];if(i){e.lab_name.changeText(i.res),e.icon.skin="dynamic/taskicon/"+i.icon+".png";var n=0,s=this.getTLTDataById(this._taskId),a=!1;if(s)-1!=(t=r.GameConfig.aegisTaskGroupJson[this._taskId].child.indexOf(e.dataSource))&&(n=s.statusArr[t],a=s.curStatusArr[t]==l.enumStatus.yilingqu);var o=i.need;(o=i.transfer(o))<(n=i.transfer(n))&&(n=o),e.lab_progress.changeText("("+n+"/"+o+")"),e.offAll(),e.btn_get.visible=!1,e.effect.visible=!1,a?e.lab_complet.visible=!0:(e.lab_complet.visible=!1,o<=n?(e.btn_get.label=y.TextConst.get(231),0==e.effect.numChildren&&u.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(e.effect,c.UIEffectsEnum.getTip_Big,.75,.75),e.effect.visible=!0,e.btn_get.visible=!0,e.on(Laya.Event.CLICK,this,this.onTaskOpHandler,[e.dataSource])):(e.effect.visible=!1,i.moduleID&&0<i.moduleID.length&&(e.btn_get.label=y.TextConst.get(228),e.btn_get.visible=!0,e.on(Laya.Event.CLICK,this,this.gotoOp,[i]))))}},e.prototype.onTaskOpHandler=function(e){var t=this.getTLTDataById(this._taskId);if(t){var i=r.GameConfig.aegisTaskGroupJson[this._taskId].child.indexOf(e);if(t.curStatusArr[i]==l.enumStatus.kelingqu){var n=new o.AegisTaskGetMsg;n.taskId=this._taskId,n.taskChildId=e,h.GSM.sendServer(n)}}},e.prototype.gotoOp=function(e){e.moduleID&&0<e.moduleID.length&&d.MainButtonStruct.Ins.OpenModule(e.moduleID[0][1],e.moduleID[1][1])},e.prototype.getTLTDataById=function(e){var t=a.RoleCenter.instans.vo.aegisData.curTask,i=t.idArr.indexOf(e);return-1!=i?t.dataArr[i]:null},e.prototype.onStarUpHandler=function(){if(!this._running){var e=0;if(10<=this.getStar())e=2;else{var t=a.RoleCenter.instans.vo.aegisData.star,i=r.GameConfig.aegisStarJson[t];if(i){var n=a.RoleCenter.instans.vo.SHENWEI;i.exp<=n&&(e=1)}}if(0<e){var s=new o.AegisUpgradeMsg;s.type=e,s.curValue=1==s.type?a.RoleCenter.instans.vo.aegisData.star:a.RoleCenter.instans.vo.aegisData.level,h.GSM.sendServer(s)}}},e.prototype.showPage=function(e){e.removeChildren(),e.addChild(this),g.ClearResM.resetViewImg(this),this._taskId=this.findTaskId(),this.updateList(),this.updateProgress();var t=this.getStar();this.setStar(t),this.updateBtnStat(),this.angle=this.getStarAngle(t),this.loadAni(5,this.ani_main,1),i.E.ins.on(n.EventName.AEGIS_TASK_DATA_CHANGED,this,this.onTaskChangedHandler),i.E.ins.on(n.EventName.AEGIS_UPGRADE_SUCCESS,this,this.onUpgradeHandler),i.E.ins.on(n.EventName.SHENWEI_CHANGED,this,this.onShenWeiChangedHandler),this.clip_level.value=a.RoleCenter.instans.vo.aegisData.level.toString()},e.prototype.getStar=function(){return a.RoleCenter.instans.vo.aegisData.star-10*a.RoleCenter.instans.vo.aegisData.level},e.prototype.onUpgradeHandler=function(){this.clip_level.value=a.RoleCenter.instans.vo.aegisData.level.toString();var e=this.getStar();this.toStar(e)},e.prototype.onTaskChangedHandler=function(e){var t=this.findTaskId();t!=this._taskId?(this._taskId=t,this.updateList()):this.list_task.refresh()},e.prototype.onShenWeiChangedHandler=function(){this.updateProgress(),this.updateBtnStat()},e.prototype.updateBtnStat=function(){var e=!1,t=this.getStar();if(this.btn_up.label=this.labs[0],10<=t)this.btn_up.label=this.labs[1],e=!(this.box_progress.visible=!1);else{this.box_progress.visible=!0;var i=a.RoleCenter.instans.vo.aegisData.star,n=r.GameConfig.aegisStarJson[i];if(n){var s=a.RoleCenter.instans.vo.SHENWEI;n.exp<=s&&(e=!0)}}this.btn_up.disabled=!e,e?(this.ani_put||this.loadEffect(),this.ani_put.play(0),this.ani_put.visible=!0):this.ani_put&&(this.ani_put.stop(),this.ani_put.visible=!1)},e.prototype.updateList=function(){var e=r.GameConfig.aegisTaskGroupJson[this._taskId];e&&(this.list_task.array=e.child)},e.prototype.updateProgress=function(){var e=a.RoleCenter.instans.vo.aegisData.star,t=r.GameConfig.aegisStarJson[e];if(t){var i=a.RoleCenter.instans.vo.SHENWEI,n=t.exp;this.lab_progress.changeText(i+"/"+n),this.progress.scaleX=Math.min(1,i/n)}},e.prototype.findTaskId=function(){var e=a.RoleCenter.instans.vo.aegisData.curTask,t=e?e.dataArr.length:0;if(0==t)return 0;for(var i,n=0;n<t;)(i=e.dataArr[n]).curStatusArr.forEach(function(e){if(e!=l.enumStatus.yilingqu)return i.id}),n++;return e.dataArr[t-1].id},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(e){this._angle=e,this.mask_pie&&(this.mask_pie.graphics.clear(),this.mask_pie.graphics.drawPie(195,195,195,-198,this._angle,"#ff0000"))},enumerable:!0,configurable:!0}),e.prototype.toStar=function(e){var t=this;if(!this._running&&(e<0&&(e=0),10<e&&(e=10),this._star!=e)){var i=this.getStarAngle(e);i!=this._angle?(this._running=!0,Laya.Tween.to(this,{angle:i},300,Laya.Ease.circIn,new Laya.Handler(this,function(){t.setStar(e),t._running=!1}))):this.setStar(e)}},e.prototype.getStarAngle=function(e){var t=-198;return 1<e&&(t+=22*(e-1)),t},e.prototype.setStar=function(e){if(this._star!=e){this._star=e;for(var t=1;t<=10;){var i=this["img_star"+t];this.removeStarAni(i),t>this._star?i.skin="res/aegis/shendun_nengliangqiudi.png":(i.skin="res/aegis/shendun_nengliangqiuman.png",this.addStarAni(i)),t++}this.updateBtnStat()}},e.prototype.removeStarAni=function(e){for(var t,i=e.numChildren-1;0<=i;)(t=e.removeChildAt(i))&&t.clear(),i--},e.prototype.addStarAni=function(e){var t=this.createAni();t&&(t.x=22.5,t.y=23.5,e.addChild(t))},e.prototype.createAni=function(){var e,t=m.ItemUtils.getUIEffectsVoById(106);if(t){(e=new f.GAnimation).interval=150;var i=(t.urlPath?t.urlPath:"dynamic2/uieffect")+"/"+t.name+".json";e.load(i,!0)}return e},e.prototype.loadAni=function(e,n,s){void 0===s&&(s=1);var a="dynamic2/hunyin/"+p.HeJiStruct.Ins.getHunYinVo(e).id+"a.json";Laya.loader.load(a,Laya.Handler.create(this,function(){n.source=a;var e=Laya.loader.getRes(a).frames;for(var t in e)if(e[t]&&e[t].sourceSize){n.width=e[t].sourceSize.w,n.height=e[t].sourceSize.h;break}n.scale(s,s);var i=n.parent;n.x=(i.width-n.width*s)/2,n.y=(i.height-n.height*s)/2,n.interval=200,n.play(0)}))},e.prototype.hidePage=function(){Laya.Tween.clearAll(this),this._running=!1,i.E.ins.off(n.EventName.AEGIS_TASK_DATA_CHANGED,this,this.onTaskChangedHandler),i.E.ins.off(n.EventName.AEGIS_UPGRADE_SUCCESS,this,this.onUpgradeHandler),i.E.ins.off(n.EventName.SHENWEI_CHANGED,this,this.onShenWeiChangedHandler),this.ani_put&&this.ani_put.stop()},e}(ui.aegis.AegisPageUI);t.AegisPage=s}),define("src/g/hunyin/ctrl/page/HunYinAegisCtrl",["require","exports","src/g/aegis/view/AegisPage","../../../clearRes/ClearResM","../../../../init/ResManager"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.init=function(){this._view=new i.AegisPage},e.prototype.showPage=function(e,t){this._view||this.init(),n.ClearResM.resetViewImg(this._view),this._view.showPage(e),s.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.refreshData=function(){},e.prototype.getTitle=function(){return"res/aegis/shendun_biaotui.png"},e.prototype.changePerson=function(e,t){},e.prototype.hidePage=function(){s.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){s.ResManager.getInstance().destroyPageCtrl(this)},e}();t.HunYinAegisCtrl=a}),define("src/g/hunyin/view/Huanwu",["require","exports","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../../utils/ItemUtils","../../itemGets/View/ItemGetDlg","../../../core/E","../../../enum/EventName","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../../enum/GuideTargetName","../../net/messages/ComboCultivateMsg","../../../manager/GameSocketManager","../../../meta/HunYinVo","../../../manager/RoleCenter","../../accessctrl/AccessCenter","../../../init/TextConst"],function(e,t,s,a,m,i,n,o,r,l,h,u,c,f,y,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var i=t.call(this)||this;i.nowSelectJob=0,i.nowSkillId=0,i.nowLv=0,i.canUp=!1,i.lvMax=!1,i.point=[[i.jn2.x,i.jn2.y],[i.jn1.x,i.jn1.y],[i.jn0.x,i.jn0.y]],i.jn0.icon.skin="res/index1/zhujiemian_heji_jienng1.png",i.jn1.icon.skin="res/index1/zhujiemian_heji_jienng2.png",i.jn2.icon.skin="res/index1/zhujiemian_heji_jienng3.png",i.btn_up.handler=new Laya.Handler(i,i.onUpLv);var e=i.lab_desc;e.style.font="SimHei",e.style.fontSize=18,e.style.color="#c0b4a3",e.style.align="left",e.style.wordWrap=!0,e.style.leading=8,i.ani2.on(Laya.Event.COMPLETE,i,i.jnAniComp),i.ani_put=s.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(i.btn_up,a.UIEffectsEnum.btn_001);var n="dynamic2/uieffect/EUI1_69.json";return Laya.loader.load(n,Laya.Handler.create(i,function(){i.ani2.source=n;var e=Laya.loader.getRes(n).frames;for(var t in e)if(e[t]&&e[t].sourceSize){i.ani2.width=e[t].sourceSize.w,i.ani2.height=e[t].sourceSize.h;break}s.UIEffectsFactory.Ins.centered4Parent(i.ani2,i.box_2),i.ani2.play(0,!1)}),null,Laya.Loader.ATLAS),i}return __extends(e,t),e.prototype.jnAniComp=function(e){this.ani2.visible=!1},e.prototype.getItem=function(){(new i.ItemGetDlg).initByVo(null,m.ItemUtils.getCurrencyVoByDefine(this.needDefine)).popup()},e.prototype.onUpLv=function(){if(this.lvMax)return r.FE.upItems(g.TextConst.get(584),l.BubbleEnum.center),!1;if(!this.canUp)return this.getItem(),!1;n.E.ins.event(o.EventName.COMPTYPE_CLICK,h.GuideTargetName.SOUL_POWER_BTN_UP);var e=new u.ComboUpgradeMsg;return e.comboIdx=this.nowSelectJob-1,e.curLv=this.data.comboLvArr[this.nowSelectJob-1],e.curExp=this.data.comboExpArr[this.nowSelectJob-1],c.GSM.sendServer(e),!0},e.prototype.changeSelect=function(e){this.nowSelectJob=e,this.setNeed(),this.renderProp(),this.setFightNum()},e.prototype.renderProp=function(){var e=m.ItemUtils.getSkillVoById(this.nowSkillId);this.tab_nameLv.text=e.name+"     Lv."+this.nowLv;var t=e.des;if(this.lab_desc.innerHTML=t,null!=e.buffArr&&0<e.buffArr.length&&(null==e.ext||0==e.ext.length)){for(var i=0;i<e.buffArr.length;i++){var n=m.ItemUtils.getBuffVoById(e.buffArr[i]),s=n.rate,a=n.ext,o=s[this.nowLv]||s[s.length-1];t=t.replace("{0}",o+""),a&&0<a.length&&(t=t.replace("{1}",(a[this.nowLv]||a[a.length-1])+""))}this.lab_desc.innerHTML=t}else{var r=null==(o=e.ext[this.nowLv])?e.des:e.des.replace("{0}",o+"");e.buff&&(r=r.replace("{1}",e.buff+"")),e.rate&&(r=r.replace("{1}",e.rate[0]+"")),this.lab_desc.innerHTML=r}},e.prototype.setFightNum=function(){for(var e=0,t=0;t<this.data.comboLvArr.length;t++){var i=f.HeJiStruct.Ins.getHeSkillVo(t,this.data.comboLvArr[t]);i&&(e+=i.power)}this.box_fight.num_Fight.value=e+""},e.prototype.setNeed=function(){var e=f.HeJiStruct.Ins.getHeSkillVo(this.nowSelectJob-1,this.nowLv),t=f.HeJiStruct.Ins.getHeSkillVo(this.nowSelectJob-1,this.nowLv+1),i=null,n=0,s=t.exp,a=this.data.comboExpArr[this.nowSelectJob-1]||0;n=t?(this.lvMax=!1,i=m.ItemUtils.getCurrencyVoByDefine(t.cost[0][0]),t.cost[0][1]):(this.lvMax=!0,i=m.ItemUtils.getCurrencyVoByDefine(e.cost[0][0]),e.cost[0][1]),this.needDefine=i.define;var o=y.RoleCenter.instans.getValueByType(this.needDefine);this.lab_Need.text=n+"",this.lab_Need.color=n<=o?"#c0b4a3":"#ff0f15",this.canUp=n<=o,this.ani_put.visible=this.canUp&&!this.lvMax,this.lab_exp.changeText(a+"/"+s),0==s&&(s=1);var r=this.bar_img.width/s*a;if(r=0==r?1:r,Laya.Tween.to(this.bar_panel,{width:r},80),1==r&&(this.ani2.visible=!0,this.ani2.play(0)),1==r||!this.isInit)for(var l=this.nowSelectJob-1,h=[this.jn2,this.jn1,this.jn0],u=void 0,c=[],d=0,g=[[517,383],[282,-6],[108,348]];c.length!=h.length;){if(-1==c.indexOf(l)){u=h[l];var p=this.point[d];u.p0.x=u.x,u.p0.y=u.y,u.p1.x=g[d][0],u.p1.y=g[d][1],u.p2.x=p[0],u.p2.y=p[1],u.x==p[0]&&u.y==p[1]||(Laya.Tween.clearAll(u),Laya.Tween.to(u,{factor:1},200)),c.push(l),d++}h.length<=++l&&(l=0)}},e.prototype.refreshData=function(){this.findMin()},e.prototype.showView=function(){this.data=y.RoleCenter.instans.vo.comboData,this.findMin(),this.showAni(),this.isInit=!0},e.prototype.showAni=function(){var i=this,n="dynamic2/hunyin/2a.json";this.url=n,Laya.loader.load(n,Laya.Handler.create(this,function(){i.ani.source=n;var e=Laya.loader.getRes(n).frames;for(var t in e)if(e[t]&&e[t].sourceSize){i.ani.width=e[t].sourceSize.w,i.ani.height=e[t].sourceSize.h;break}s.UIEffectsFactory.Ins.centered4Parent(i.ani,i.box_),i.ani.play(0)}),null,Laya.Loader.ATLAS)},e.prototype.findMin=function(){for(var e=0,t=this.data.comboLvArr,i=t[0],n=1;n<t.length;n++)1==n?t[n]<i&&d.AccessCenter.ins.checkOpen(d.enumAccessId.heji2)&&(i=t[n],e=n):2==n&&t[n]<i&&d.AccessCenter.ins.checkOpen(d.enumAccessId.heji3)&&(i=t[n],e=n);this.nowSkillId=this.data.comboSkill[e],this.nowLv=i,this.changeSelect(e+1)},e}(ui.hunyin.page.HuanwuUI);t.Huanwu=p}),define("src/g/hunyin/ctrl/page/HuanwuCtrl",["require","exports","../../../base/BaseCtrl","src/g/hunyin/view/Huanwu","../../../clearRes/ClearResM","../../../../init/ResManager"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.init=function(){this._view=new n.Huanwu},t.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),e.addChild(this._view),this._view.showView(),s.ClearResM.resetViewImg(this._view),a.ResManager.getInstance().showRolePageCtrl(this)},t.prototype.changePerson=function(e,t){},t.prototype.refreshData=function(){this._view&&this._view.refreshData()},t.prototype.getTitle=function(){return"res/hunyin/huanwu_biaoti.png"},t.prototype.hidePage=function(){a.ResManager.getInstance().hidePageCtrl(this)},t.prototype.destroyPage=function(){a.ResManager.getInstance().destroyPageCtrl(this)},t}(i.BaseCtrl);t.HuanwuCtrl=o}),define("src/g/hunyin/view/HldyDlg",["require","exports","../../accessctrl/AccessCenter","../../net/messages/sbkPhantomData","../../../manager/GameSocketManager","../../../manager/RoleCenter","../../../config/GameConfig","../../../utils/system/FloatEffect","../../../utils/ItemUtils","../../net/messages/PropFightMain","../../../utils/RoleUtil","../../../utils/ItemCellUtils","../../../meta/QualiyVo","../../../init/TextConst","../../../init/Switches","../../../utils/HlUtils"],function(e,t,n,s,a,k,T,o,A,H,P,D,G,N,r,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this,t=e.lab_desc.style;return t.align="center",t.fontSize=18,t.color="#a89e8f",e.btn_use.on(Laya.Event.CLICK,e,e.use),e.btn_goto.on(Laya.Event.CLICK,e,e.goto),e}return __extends(e,i),e.prototype.use=function(){if(0!=this.max)if(0!=this.has){var e=this.iVo.id,t=new s.PhantomDanMSG;t.itemId=e,t.count=this.has,a.GSM.sendServer(t),this.close()}else o.FE.upItems(N.TextConst.get(370))},e.prototype.goto=function(){r.Switches.ins.event(n.enumAccessId.huanling),this.close()},e.prototype.initData=function(e,t,i){void 0===i&&(i=!1),this.iVo=e;var n=k.RoleCenter.instans.vo,s=T.GameConfig.HuanlingSetting,a=n.phData,o=n.bagdata,r=a.phLv,l=e.id,h=s.danyaoid.value.split(",").indexOf(l+""),u=o.getItemCount(l),c=M.HlUtils.getUseMax(h,r),d=c[0],g=c[1],p=s[["shengwu","huanshen","luotian"][h]].value.split(","),m=s[["swnumber","hsnumber","ltnumber"][h]].value.split(",");this.has=u,this.max=d,this.box_no.visible=!i;var f=1;if(this.box_yes.visible=i){D.ItemCellUtils.fillCellForItem(this.item_,e.id,0);for(var y=this.box_currShow,v=0;v<y.numChildren;v++){var _=p[v],C=y.getChildByName("lab_"+v);if(_){var w=_.split(":"),I=A.ItemUtils.getShuXingByName(w[0]);C.text=I.desc+":"+w[1]}else C.removeSelf()}var b=e.quality;this.lab_num.changeText(0==t?"":t+""),this.lab_lv.changeText(G.QualityStruct.Ins.getQDesById(b)),this.lab_lv.color=A.ItemUtils.getColorByQuality(b),this.height=500}else{this.img_item.skin=A.ItemUtils.getIconByIconId(e.icon),f=a.danNumArr[h]||0;y=this.box_curr;var S=this.box_total,E=y.getChildByName("box_prop"),R=S.getChildByName("box_prop");for(v=0;v<p.length;v++){w=p[v].split(":");if(C=E.getChildByName("lab_"+v)){I=A.ItemUtils.getShuXingByName(w[0]);C.text=I.desc+":"+w[1]}}if(0<f)for(v=0;v<p.length;v++){w=p[v].split(":");if(C=R.getChildByName("lab_"+v)){I=A.ItemUtils.getShuXingByName(w[0]);C.text=I.desc+":"+w[1]*f}}else S.removeSelf(),y.y=190;this.lab_desc.innerHTML=g+1>=m.length?"":N.TextConst.get(1123,'<font color="#ff0000">'+N.TextConst.get(7,Math.floor(+m[g+1].split(":")[0]/10)+1)+"</font>");var x=this.lab_useDesc;x.text=N.TextConst.replace(x.text,e.name),this.lab_has.text=""+u,this.lab_use.text=f+"/"+d}this.img_title.skin="dynamic/skilltips/"+l+".png",this.btn_goto.visible=i,this.btn_use.visible=!i;var L=new H.PhantomProp;for(v=0;v<p.length;v++){L[(w=p[v].split(":"))[0]]+=+w[1]*f}this.box_fight.setFightNum(P.RoleUtil.calHlCombat(L)*n.heronum)},e}(ui.hunyin.page.HldyDlgUI);t.HldyDlg=i}),define("src/g/hunyin/view/Huanling",["require","exports","../../../config/GameConfig","../../../utils/ItemUtils","../../../manager/RoleCenter","../../jineng/vo/SkillOpenVo","../../net/messages/sbkYCSkillData","../../net/messages/sbkPhantomData","../../../manager/GameSocketManager","src/g/hunyin/view/HldyDlg","../../../plugin/sbkPropTool","../../net/messages/PropFightMain","../../lottery/view/ShenyuSkillDlg","../../accessctrl/AccessCenter","../../Effects/UIEffectsFactory","../../../manager/RedDotM","../../Effects/UIEffectsEnum","../../bag/tips/view/ItemTips","../../itemGets/View/ItemGetDlg","../../../init/TextConst","../../../init/Switches"],function(e,t,k,T,A,H,P,r,l,n,D,G,u,i,a,N,o,s,c,M,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(h){function e(){var e=h.call(this)||this,t=k.GameConfig.HuanlingSetting.danyaoid.value.split(",");e.danyaoid=t;for(var i=0;i<t.length;i++){var n=t[i],s=e["item"+i];s&&(s.skin=T.ItemUtils.getIconById(+n),s.on(Laya.Event.CLICK,e,e.itemClick,[i]))}var a=k.GameConfig.HuanlingSetting.huanupcost.value.split(",");e.huanupcost=a;for(i=0;i<a.length;i++){n=a[i];var o=e["frag"+i];if(o){var r=o.getChildByName("box"),l=o.getChildByName("img");l.skin=T.ItemUtils.getSmallIcon(T.ItemUtils.getItemVoById(n).icon),l.on(Laya.Event.CLICK,e,e.imgClick,[i]),r.on(Laya.Event.CLICK,e,e.fragClick,[i])}}for(i=0;i<5;i++){e["jn"+i].on(Laya.Event.CLICK,e,e.skillIconClick,[i])}return e.img_hh.on(Laya.Event.CLICK,e,e.hhClick),e.btn_oneUp.on(Laya.Event.CLICK,e,e.upClick,[!1]),e.btn_onceUp.on(Laya.Event.CLICK,e,e.upClick,[!0]),e}return __extends(e,h),e.prototype.imgClick=function(e){s.ItemTips.ins.showTip(+this.huanupcost[e],0)},e.prototype.skillIconClick=function(e){var t=A.RoleCenter.instans.self.phData.phLv,i=H.SkillOpenVo.getSkillList(P.enumYCSkillType.phantomLv)[e],n=new u.ShenyuSkillDlg;n.lab_open.fontSize=20;var s=T.ItemUtils.getSkillDefItem(i.skillId),a=s.desc,o=i.level,r=0<o?Math.floor(o/10)+1:0;n.lab_open.text=o<=t?M.TextConst.get(524):M.TextConst.get(1124,r),n.lab_desc.innerHTML=a,n.setIcon(s),n.popup()},e.prototype.upClick=function(e){void 0===e&&(e=!1);var t=this.lastFIdx,i=A.RoleCenter.instans.vo.bagdata;if(!isNaN(t)){var n=+this.huanupcost[t],s=i.getItemCount(n);if(0<s){var a=A.RoleCenter.instans.self.phData,o=new r.PhantomLvMSG;o.itemId=n,o.count=e?s:1,o.phLv=a.phLv,o.phExp=a.phExp,l.GSM.sendServer(o)}else c.ItemGetDlg.create(n)}},e.prototype.hhClick=function(){d.Switches.ins.event(i.enumAccessId.huanlingHh)},e.prototype.updateAni=function(e){var t=this.btn_oneUp,i=this.btn_onceUp,n=N.RedDotM._hl;if(n&&n.upcostRed&&n.upcostRed[e])a.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(t,o.UIEffectsEnum.getTip_Big,1.6,1.1),a.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(i,o.UIEffectsEnum.getTip_Big,1.6,1.1);else{var s=t.getChildByName("ani");s&&s.removeSelf(),(s=i.getChildByName("ani"))&&s.removeSelf()}},e.prototype.fragClick=function(e){var t=this.lastFIdx,i=this["frag"+e].getChildByName("box");isNaN(t)||(this["frag"+t].getChildByName("box").selected=!1);this.lastFIdx=e,i.selected=!0,this.updateAni(e)},e.prototype.itemClick=function(e){var t=+this.danyaoid[e],i=new n.HldyDlg;i.initData(T.ItemUtils.getItemVoById(t),A.RoleCenter.instans.vo.bagdata.getItemCount(t)),i.popup()},e.prototype.refresh=function(){isNaN(this.lastFIdx)?this.fragClick(0):this.updateAni(this.lastFIdx);for(var e=A.RoleCenter.instans.vo,t=e.phData,i=e.bagdata,n=this.huanupcost,s=0;s<n.length;s++){var a=n[s],o=this["frag"+s].getChildByName("lab"),r=i.getItemCount(+a);o.color=0==r?"#ff0f15":"#03bb00",o.text=r+""}var l=t.phLv,h=0<l?Math.floor(l/10)+1:1,u=l%10;this.font_js.value=h+"",this.font_dj.value=u+"";var c=this.box_curr,d=this.box_next,g=k.GameConfig.HuanlingUp[l],p=k.GameConfig.HuanlingUp[l+1];if(g){var m=g.prop,f=p?p.prop:null;for(s=0;s<m.length;s++){var y=m[s],v=c.getChildByName("lab_"+s),_=d.getChildByName("lab_"+s),C=T.ItemUtils.getShuXingByName(y[0]);if(v.text=C.desc+":"+y[1],f){var w=f[s];_.text=C.desc+":"+w[1]}else _.text=M.TextConst.get(208)}}else for(f=p.prop,s=0;s<f.length;s++){var I=f[s];if(I){v=c.getChildByName("lab_"+s),_=d.getChildByName("lab_"+s),C=T.ItemUtils.getShuXingByName(I[0]);v.text=C.desc+":0",_.text=C.desc+":"+I[1]}}this.box_curr.x=this.box_next.x-this.box_curr.width-20,p?this.setBar():(this.bar_panel.width=448,this.lab_exp.text=M.TextConst.get(208));var b=H.SkillOpenVo.getSkillList(P.enumYCSkillType.phantomLv);for(s=0;s<b.length;s++){var S=this["jn"+s],E=(C=b[s],T.ItemUtils.getSkillDefItem(C.skillId));S.skin=T.ItemUtils.getSkillIconByIconId(E.icon);var R=!0;l>=C.level&&(R=!1),S.gray=R}var x=N.RedDotM._hl,L=this.danyaoid;for(s=0;s<L.length;s++){a=+L[s],r=i.getItemCount(a);this["red"+s].visible=x&&x.danyaoRed[s],this["lab_count"+s].text=r+""}this.red3.visible=x&&-1!=x.hhRed.indexOf(!0),this.box_fight.setFightNum(D.sbkPropTool.resetHlUp(t,new G.PhantomProp,!0)*e.heronum)},e.prototype.setBar=function(){var e=A.RoleCenter.instans.self.phData,t=e.phLv,i=e.phExp||0,n=0<t?k.GameConfig.HuanlingUp[t].exp:k.GameConfig.HuanlingUp[t+1].exp;this.lab_exp.changeText(i+"/"+n),0==n&&(n=1);var s=448/n*i;s=0==s?1:s,Laya.Tween.to(this.bar_panel,{width:s},80)},e}(ui.hunyin.page.HuanlingUI);t.Huanling=h}),define("src/g/hunyin/ctrl/page/HuanlingCtrl",["require","exports","../../../base/BaseCtrl","../../../clearRes/ClearResM","src/g/hunyin/view/Huanling","../../../../manager/GameSocketManager","../../../net/messages/sbkPhantomData","../../../../manager/RoleCenter","../../../../plugin/sbkPropTool","../../../../enum/EventName","../../../../config/GameConfig","../../../../core/NumE","../../../../init/ResManager"],function(e,t,i,n,s,a,o,c,d,g,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(){var e=t.call(this)||this;return e.url="res/atlas/res/huanling.json",a.GSM.ins.on(o.PhantomLvMSG.KEY,e,e.hlUp),a.GSM.ins.on(o.PhantomDanMSG.KEY,e,e.useDan),e}return __extends(e,t),e.prototype.init=function(){this._view=new s.Huanling;var e=r.GameConfig.HuanlingSetting.danyaoid.value.split(","),t=r.GameConfig.HuanlingSetting.huanupcost.value.split(",");this.danyaoid=e,this.huanupcost=t;for(var i=0;i<t.length;i++)l.NumE.ins.on(+t[i]+l.NumE.CHANGED,this,this.refreshData)},e.prototype.useDan=function(e){var t=this.danyaoid;if(t){var i=c.RoleCenter.instans.vo,n=i.phData,s=e.count,a=e.itemId,o=n.danNumArr,r=t.indexOf(a+""),l=o[r]||0;l+=s,o[r]=l,i.chgItemCount(a,-s);var h=i.combat;d.sbkPropTool.resetHuanling();var u=i.reCheckComBat();c.RoleCenter.instans.event(g.EventName.FIGHT_UP,u-h),this.refreshData()}},e.prototype.hlUp=function(e){var t=c.RoleCenter.instans.vo,i=e.phLv,n=e.phExp,s=e.itemId,a=t.phData;a.phLv=i,a.phExp=n;var o=t.combat;0<s&&t.chgItemCount(s,-e.count),d.sbkPropTool.resetHuanling(),d.sbkPropTool.resetSkill();var r=t.reCheckComBat();c.RoleCenter.instans.event(g.EventName.FIGHT_UP,r-o),this.checkMax(i,n),this.refreshData()},e.prototype.checkMax=function(e,t){var i=r.GameConfig.HuanlingUp,n=i[e];if(n&&t>=n.exp&&i[e+1]){var s=new o.PhantomLvMSG;s.itemId=+this.huanupcost[0],a.GSM.sendServer(s)}},e.prototype.showPage=function(e,t){this._view||this.init();var i=c.RoleCenter.instans.vo.phData;this.checkMax(i.phLv,i.phExp),e.removeChildren(),e.addChild(this._view),this._view.refresh(),this.open(),h.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.onAtlasLoaded=function(){n.ClearResM.resetViewImg(this._view)},e.prototype.changePerson=function(e,t){},e.prototype.refreshData=function(){var e=this._view;e&&e.refresh()},e.prototype.getTitle=function(){return"res/title/huanling.png"},e.prototype.hidePage=function(){h.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){h.ResManager.getInstance().destroyPageCtrl(this)},e}(i.BaseCtrl);t.HuanlingCtrl=u}),define("src/g/hunyin/ctrl/HunYinBgCtrl",["require","exports","../../clearRes/ClearResM","src/g/hunyin/view/HunYinBg","../../../enum/EventName","../../../core/E","src/g/hunyin/ctrl/page/HunYinTrueCtrl","../../../manager/GameSocketManager","../../net/messages/ComboCultivateMsg","../../../manager/RoleCenter","../../../meta/HunYinVo","../../../config/GameConfig","../../../utils/ItemUtils","../../../utils/system/FloatEffect","../../../vo/RedDot/hunyin/RedDot_hunCome","src/g/hunyin/RedDot_hunTrue","../../../init/Switches","../../accessctrl/AccessCenter","../../../plugin/sbkPropTool","../../../enum/GuideTargetName","../../base/BaseCtrl","../../net/messages/sbkTimeLimitTaskData","../../net/messages/enumStatus","src/g/hunyin/RedDot_hunYin","src/g/hunyin/ctrl/page/HunYinAegisCtrl","../../proxy/MultiLevelUIProxy","../../../manager/TipManager","src/g/hunyin/ctrl/FengShenPageCtrl","src/g/hunyin/ctrl/page/HuanwuCtrl","../../../utils/system/ServerTime","../../../init/TextConst","src/g/hunyin/ctrl/page/HuanlingCtrl"],function(e,t,n,s,l,h,a,o,u,c,d,g,p,m,f,y,v,_,C,w,i,I,b,S,E,R,x,L,k,T,A,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){function r(){var e=i.call(this)||this;e.closeOther=!1,e.urls=["res/atlas/res/hunyin.json"];var t=v.Switches.ins;return t.on(_.enumAccessId.zhenheji,e,e.onOpenIdHandler,[_.enumAccessId.hunyin]),t.on(_.enumAccessId.hunyin,e,e.onOpenIdHandler,[_.enumAccessId.hunyin]),t.on(_.enumAccessId.aegis,e,e.onOpenIdHandler,[_.enumAccessId.aegis]),t.on(_.enumAccessId.fengshen,e,e.onOpenIdHandler,[_.enumAccessId.fengshen]),t.on(_.enumAccessId.hunli,e,e.onOpenIdHandler,[_.enumAccessId.hunli]),t.on(_.enumAccessId.huanling,e,e.onOpenIdHandler,[_.enumAccessId.huanling]),e.addMsgEvent(),e._fengshenCtrl=new L.FengShenPageCtrl,e._fengshenCtrl.init(),e}return __extends(r,i),r.prototype.onOpenIdHandler=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t&&(_.enumAccessId.hunyin,this.onOpenHandler(e,i,n))},r.prototype.onOpenHandler=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this.openId=e,this.opens(),this.realOpenRoleView(this.openId)},r.prototype.realOpenRoleView=function(e){this._view||(this.initView(),_.AccessCenter.ins.checkOpen(_.enumAccessId.aegis)?this._view.tab_page.getChildByName("item0").label=A.TextConst.get(583):_.AccessCenter.ins.on(_.enumAccessId.aegis,this,this.onAegisOpen)),this.addUIEvent(),this._tabProxy.open(e),this._view.showView(),n.ClearResM.resetViewImg(this._view),h.E.ins.on(l.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},r.prototype.onAegisOpen=function(){_.AccessCenter.ins.checkOpen(_.enumAccessId.aegis)&&(_.AccessCenter.ins.off(_.enumAccessId.aegis,this,this.onAegisOpen),this._view.tab_page.getChildByName("item0").label=A.TextConst.get(583),this._view.displayedInStage&&0==this._view.tab_page.selectedIndex&&this.onChangePage(4))},r.prototype.addMsgEvent=function(){var e=o.GSM.ins;e.on(u.ComboHunYinBuyMsg.KEY,this,this.onComboHunYinBuyMsg),e.on(u.ComboHunYinActivateMsg.KEY,this,this.onComboHunYinActivateMsg),e.on(u.ComboHunYinUpgradeMsg.KEY,this,this.onComboHunYinUpgradeMsg),e.on(u.ComboUpgradeMsg.KEY,this,this.onComboUpgradeMsg),e.on(u.ComboHunYinFenJieMsg.KEY,this,this.onComboHunYinFenJieMsg),e.on(u.oneHYTask.KEY,this,this.ononeHYTask),e.on(u.HunYinTaskUpdataGS2C.KEY,this,this.onHunYinTaskUpdataGS2C),e.on(u.HunYinTaskGetMsg.KEY,this,this.onHunYinTaskGetMsg),e.on(I.TLTData.KEY,this,this.updateOneTaskHandler),h.E.ins.on(l.EventName.HUNYIN_OPEN_JIE,this,this.onOpenHunYinJie),h.E.ins.on(l.EventName.OPENNEW_HERO,this,this.onOpenFriend),h.E.ins.on(l.EventName.INIT_SELFSETOVER,this,this.doInit),h.E.ins.on(l.EventName.VIP_EXP_CHANGED,this,this.onVipChanged),h.E.ins.on(l.EventName.CHANGEITEM_COUNT,this,this.onVipChanged)},r.prototype.doInit=function(){T.ServerTime.isInited?S.RedDot_hunYin.Ins.checkAll():h.E.ins.once(l.EventName.SERVER_TIME_UPDATE,this,this.doInit)},r.prototype.onOpenHunYinJie=function(e){x.TipManager.showHunOpen(e)},r.prototype.ononeHYTask=function(e){var t,i,n,s=e,a=c.RoleCenter.instans.vo.comboData.curHunYinTask;s&&-1!=(i=a.idArr.indexOf(s.taskId))&&(t=a.dataArr[i])&&(n=g.GameConfig.hunTask[s.taskId])&&-1!=(i=n.child.indexOf(s.childId))&&(t.statusArr[i]=s.value,h.E.ins.event(l.EventName.HUN_YIN_TASK_DATA_CHANGED,s.taskId)),S.RedDot_hunYin.Ins.checkAll()},r.prototype.onHunYinTaskUpdataGS2C=function(e){for(var t=e.updataArr.length,i=0;i<t;)this.ononeHYTask(e.updataArr[i]),i++;h.E.ins.event(l.EventName.REFRESH_HUNYIN_TASK)},r.prototype.onHunYinTaskGetMsg=function(e){var t,i,n=c.RoleCenter.instans.vo.comboData.curHunYinTask;if(-1!=(i=n.idArr.indexOf(e.taskId))){if(t=n.dataArr[i]){var s=g.GameConfig.hunTask[e.taskId].child.indexOf(e.taskChildId);t.curStatusArr[s]=b.enumStatus.yilingqu,h.E.ins.event(l.EventName.HUN_YIN_TASK_DATA_CHANGED,e.taskId),h.E.ins.event(l.EventName.HUN_YIN_TASK_COMPLET,e.taskId)}S.RedDot_hunYin.Ins.checkAll()}h.E.ins.event(l.EventName.REFRESH_HUNYIN_TASK)},r.prototype.onOpenFriend=function(){f.RedDot_hunCome.Ins.recheckCome()},r.prototype.onVipChanged=function(){y.RedDot_hunTrue.Ins.reCheckHunTrue()},r.prototype.onComboHunYinFenJieMsg=function(e){if(e.itemArr&&0!=e.itemArr.length)for(var t=0;t<e.itemArr.length;t+=2){var i=d.HeJiStruct.Ins.getHunYinCoseVo(e.itemArr[t]);if(i){c.RoleCenter.instans.vo.chgItemCount(i.fenjie[0][0],i.fenjie[0][1]*e.itemArr[t+1]),c.RoleCenter.instans.vo.chgItemCount(e.itemArr[t],-e.itemArr[t+1]);var n=p.ItemUtils.getItemVoById(i.fenjie[0][0]);n&&m.FE.getFloat(n.name+"x"+i.fenjie[0][1]*e.itemArr[t+1],p.ItemUtils.getColorByQuality(n.quality))}}},r.prototype.onComboUpgradeMsg=function(e){this.user.comboData.comboLvArr[e.comboIdx]=e.curLv,this.user.comboData.comboExpArr[e.comboIdx]=e.curExp;var t=d.HeJiStruct.Ins.getHeSkillVo(e.comboIdx,e.curLv);if(t){var i=t.cost[0][0];c.RoleCenter.instans.setValueByType(i,c.RoleCenter.instans.getValueByType(i)-t.cost[0][1])}h.E.ins.event(l.EventName.SOUL_UPGRADE_SUCCESS),this._huanwu&&this._huanwu.refreshData();var n=c.RoleCenter.instans.vo.combat;C.sbkPropTool.reSetHunPower();var s=c.RoleCenter.instans.vo.reCheckComBat();c.RoleCenter.instans.event(l.EventName.FIGHT_UP,s-n)},r.prototype.onComboHunYinUpgradeMsg=function(e){this.user.comboData.curHunYinJieArr.push(e.curJie),y.RedDot_hunTrue.Ins.reCheckHunTrue(),this._hunyintrue&&(this._hunyintrue.refreshData(),this._hunyintrue.showOpenAni(e.curJie));d.HeJiStruct.Ins.getHunYinVo(e.curJie);var t=c.RoleCenter.instans.vo.combat;C.sbkPropTool.reSetHunYin();var i=c.RoleCenter.instans.vo.reCheckComBat();c.RoleCenter.instans.event(l.EventName.FIGHT_UP,i-t),h.E.ins.event(l.EventName.HUNYIN_OPEN_JIE,[e.curJie])},r.prototype.updateOneTaskHandler=function(e){if(!(e.id<3e4||31e3<e.id)&&e){var t,i,n=c.RoleCenter.instans.vo.comboData.curHunYinTask;-1!=(i=n.idArr.indexOf(e.id))?(t=n.dataArr[i])&&(t.copydata(e),h.E.ins.event(l.EventName.HUN_YIN_TASK_DATA_CHANGED,e.id)):(n.idArr.push(e.id),n.dataArr.push(e),this.updateGetState(e.id)),this._hunyintrue&&this._hunyintrue.refreshData(),S.RedDot_hunYin.Ins.checkAll()}},r.chkNeed=function(e,t){if(27!=e.type)return t>=e.need;var i=t%1e3,n=t/1e3>>0,s=e.need%1e3,a=e.need/1e3>>0;return s<=i||a<=n},r.prototype.updateGetState=function(e){if(!(e<3e4)){var t=c.RoleCenter.instans.vo.getHunTLTDataById(e);if(t)for(var i,n,s=g.GameConfig.hunTask[e],a=s.child.length,o=0;o<a;)(n=g.GameConfig.hunSubTask[s.child[o]])&&(i=t.statusArr[o],n.need,r.chkNeed(n,i)?(t.curStatusArr[o]!=b.enumStatus.yilingqu&&(t.curStatusArr[o]=b.enumStatus.kelingqu),0):t.curStatusArr[o]=b.enumStatus.weiwancheng),o++}},r.prototype.onComboHunYinActivateMsg=function(e){if(this.user||(this.user=c.RoleCenter.instans.vo),this.user.chgItemCount(e.itemId,-1),this.user.comboData.curHunYinIdArr.push(e.itemId),y.RedDot_hunTrue.Ins.reCheckHunTrue(),this._hunyintrue)for(var t in this._hunyintrue.refreshData(),g.GameConfig.hunyin){var i=g.GameConfig.hunyin[t];if(!i)return;for(var n=-1,s=0;s<i.hunyin.length;s++)if(i.hunyin[s][0]==e.itemId+""){n=s;break}if(-1<n){this._hunyintrue.onAchivateDebris(n),h.E.ins.event(l.EventName.ACHIVATE_HUNYINDEBRIS),h.E.ins.event(l.EventName.HUNYIN_OPEN_DEBRIS,[n]);break}}var a=c.RoleCenter.instans.vo.combat;C.sbkPropTool.reSetHunYin();var o=c.RoleCenter.instans.vo.reCheckComBat();c.RoleCenter.instans.event(l.EventName.FIGHT_UP,o-a),h.E.ins.event(l.EventName.REFRESH_HUNYIN_TASK)},r.prototype.onComboHunYinBuyMsg=function(e){var t=g.GameConfig.hunyincost[e.itemId],i=p.ItemUtils.getItemVoById(t.cost[0][0]);this.user.chgItemCount(i.id,-t.cost[0][1]),this.user.chgItemCount(t.id,e.count),h.E.ins.event(l.EventName.HUNYIN_BUYOVER),y.RedDot_hunTrue.Ins.reCheckHunTrue(),this._page&&this._page.refreshData()},r.prototype.addUIEvent=function(){this._view.view_bg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this._tabProxy||(this._tabProxy=new R.MultiLevelUIProxy,this._tabProxy.registerTab(this._view.tab_page,0),this._tabProxy.registerTagIndex(_.enumAccessId.hunyin,0),this._tabProxy.registerTagIndex(_.enumAccessId.hunli,1),this._tabProxy.registerTagIndex(_.enumAccessId.fengshen,2),this._tabProxy.registerTagIndex(_.enumAccessId.huanling,3),this._tabProxy.registerTagIndex(_.enumAccessId.aegis,4),this._tabProxy.selectHandler=new Laya.Handler(this,this.onChangePage)),this._view.on(Laya.Event.REMOVED,this,this.onClose)},r.prototype.initView=function(){this._view=new s.HunYinBg,this._hunyintrue=new a.HunYinTrueCtrl,this._aegis=new E.HunYinAegisCtrl,this._huanwu=new k.HuanwuCtrl,this._huanling=new H.HuanlingCtrl,this.user=c.RoleCenter.instans.vo},r.prototype.onOpenHunYin=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!0),this.selectIndex=e,this.closeOther=t,this.opens()},r.prototype.onAtlasLoaded=function(){},r.prototype.closeClearRes=function(){h.E.ins.off(l.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),this.clearCtrlRes(),n.ClearResM.clearResFolder("aegis/"),n.ClearResM.clearResFolder("dynamic2/huanling/")},r.prototype.onChangePage=function(e){switch(void 0===e&&(e=0),0==e&&_.AccessCenter.ins.checkOpen(_.enumAccessId.aegis)&&(e=4),e){case 0:this._page=this._hunyintrue,h.E.ins.event(l.EventName.COMPTYPE_CLICK,w.GuideTargetName.hunyin_tab_item0);break;case 2:this._page=this._fengshenCtrl,h.E.ins.event(l.EventName.COMPTYPE_CLICK,w.GuideTargetName.hunyin_tab_item2);break;case 1:this._page=this._huanwu,h.E.ins.event(l.EventName.COMPTYPE_CLICK,w.GuideTargetName.hunyin_tab_item3);break;case 3:this._page=this._huanling;break;case 4:this._page=this._aegis,h.E.ins.event(l.EventName.COMPTYPE_CLICK,w.GuideTargetName.hunyin_tab_item1)}this._page.showPage(this._view.view_bg.box_page),this._view.view_bg.img_title.skin=this._page.getTitle()},r.prototype.onClose=function(){this._view.view_bg.btn_back.off(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_close.off(Laya.Event.CLICK,this,this.onClose),this._view.destroyView(),h.E.ins.event(l.EventName.CLOSEVIEW_HUNYIN)},r}(i.BaseCtrl);t.HunYinBgCtrl=r}),define("src/g/hunyin/view/item/HunYinTaskItem",["require","exports","../../../../config/GameConfig","../../../../manager/RoleCenter","../../../Effects/UIEffectsFactory","../../../net/messages/enumStatus","../../../../meta/MainButtonVo","../../../net/messages/ComboCultivateMsg","../../../../manager/GameSocketManager","../../../Effects/UIEffectsEnum","src/g/hunyin/ctrl/HunYinBgCtrl","../../../../init/TextConst"],function(e,t,o,i,r,l,n,s,a,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showSubTask=function(e,t){this.parentId=e,this.data=o.GameConfig.hunSubTask[t],this._tltd=i.RoleCenter.instans.vo.getHunTLTDataById(e),this.renderView()},t.prototype.renderView=function(){this.lab_taskTitle.text=this.data.res,this.icon_task.skin="dynamic/taskicon/"+this.data.icon+".png";var e=o.GameConfig.hunTask[this.parentId],t=o.GameConfig.hunSubTask[this.data.id],i=e.child.indexOf(this.data.id),n=0;n=this._tltd?this._tltd.statusArr[i]:t.need;var s=t.need;27==t.type?(s=1,n=u.HunYinBgCtrl.chkNeed(t,n)?1:0):s=t.isNoCountType()?(n=n<s?0:1,1):(n=t.transfer(n),t.transfer(s)),s<n&&(n=s),this.lab_count.text="("+n+"/"+s+")",this.offAll(),this.btn_go.visible=!1,this.lab_complet.visible=!1;var a=r.UIEffectsFactory.Ins.createSAniById(h.UIEffectsEnum.getTip_Big,.8,.8);0==this.effect.numChildren&&(this.effect.addChild(a),r.UIEffectsFactory.Ins.centerSAni4Parent(a,this.effect)),this.effect.visible=!1,s<=n?this._tltd&&this._tltd.curStatusArr[i]!=l.enumStatus.yilingqu?(this._tltd.curStatusArr[i]=l.enumStatus.kelingqu,this.btn_go.label=c.TextConst.get(204),this.btn_go.visible=!0,this.effect.visible=!0,this.img_red.visible=!0,this.on(Laya.Event.CLICK,this,this.toGetReward,[this.data.id])):this.lab_complet.visible=!0:t.moduleID&&0<t.moduleID.length&&(this.btn_go.label=c.TextConst.get(228),this.img_red.visible=!1,this.on(Laya.Event.CLICK,this,this.gotoOp,[t]),this.btn_go.visible=!0)},t.prototype.gotoOp=function(e){e.moduleID&&0<e.moduleID.length&&n.MainButtonStruct.Ins.OpenModule(e.moduleID[0][1],e.moduleID[1][1])},t.prototype.toGetReward=function(e){if(this._tltd){var t=o.GameConfig.hunTask[this.parentId].child.indexOf(e);if(this._tltd.curStatusArr[t]==l.enumStatus.kelingqu){var i=new s.HunYinTaskGetMsg;i.taskId=this.parentId,i.taskChildId=e,a.GSM.sendServer(i)}}},t}(ui.hunyin.item.HunYinTaskItemUI);t.HunYinTaskItem=d}),define("src/g/hunyin/view/page/HunYinComposePage",["require","exports","src/g/hunyin/view/item/HunYinTaskItem","../../../../meta/HunYinVo","../../../../manager/RoleCenter","../../../../config/GameConfig","../../../net/messages/enumStatus","../../../../core/E","../../../../enum/EventName","../../../Effects/UIEffectsFactory","../../../Effects/UIEffectsEnum","../../../clearRes/ClearResM","../../../../utils/effects/ListEffect","../../../net/messages/ComboCultivateMsg","../../../../manager/GameSocketManager","../../../../utils/system/DateUitl","../../../../utils/system/FloatEffect","../../../../utils/system/ServerTime","../../../../init/TextConst"],function(e,t,i,c,d,h,g,n,s,a,o,r,l,u,p,m,f,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(t){function e(){var e=t.call(this)||this;return e._running=!1,e._effectList=[],e.list_task.itemRender=i.HunYinTaskItem,e.list_task.renderHandler=new Laya.Handler(e,e.taskRender),e.html_des.style.color="#f25a1b",e.html_des.style.font="SimHei",e.html_des.style.fontSize=18,e.html_des.style.align="center",e.html_des.innerHTML=v.TextConst.get(588),e.btn_activate.on(Laya.Event.CLICK,e,e.onActivateHandler),a.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(e.btn_activate,o.UIEffectsEnum.getTip_Big,2.5,1.7),e.htxt_desc.style.font="SimHei",e.htxt_desc.style.color="#e6e2db",e.htxt_desc.style.fontSize=18,e}return __extends(e,t),e.prototype.refreshView=function(){this.renderItem(),this.list_task.refresh(),this.renderAni(),this.checkShowState()},e.prototype.showPage=function(e){this._hunyinId=e;var t=c.HeJiStruct.Ins.getHunYinVo(e);this._taskId=t.taskId,r.ClearResM.resetViewImg(this),this.renderItem();var i=h.GameConfig.hunTask[t.taskId];this.list_task.dataSource=i.child,this.renderAni(),n.E.ins.on(s.EventName.REFRESH_HUNYIN_TASK,this,this.refreshView),l.ListEffect.oppositeFly(this.list_task,4,2,500,100),this.checkShowState()},e.prototype.checkShowState=function(){var e=!1,t=c.HeJiStruct.Ins.getHunYinVo(this._hunyinId),i=d.RoleCenter.instans.vo.getHunTLTDataById(this._taskId),n=h.GameConfig.hunTask[t.taskId];if(n&&n.activation&&0<n.activation.length&&-1==d.RoleCenter.instans.vo.comboData.curHunYinJieArr.indexOf(this._hunyinId)){var s=0;if(i)for(var a=0;a<i.curStatusArr.length;a++)i.curStatusArr[a]==g.enumStatus.yilingqu&&s++;else s=4;if(4<=s){var o=n.activation[0][1],r=o%1e3,l=o/1e3>>0;this.htxt_desc.innerHTML=v.TextConst.get(589,l,r),e=!0}}this.box_task.visible=!e,this.box_activate.visible=e},e.prototype.cooldownHandler=function(){var e=this.endTime-y.ServerTime.serverTime;0<e?(this.htxt_desc.innerHTML=v.TextConst.get(589,m.DateUtil.getHMS_countdown(e)),Laya.timer.once(1e3,this,this.cooldownHandler)):this.htxt_desc.innerHTML=""},e.prototype.onActivateHandler=function(){var e=c.HeJiStruct.Ins.getHunYinVo(this._hunyinId),t=h.GameConfig.hunTask[e.taskId];if(t&&t.activation&&0<t.activation.length){var i=t.activation[0][1],n=i%1e3,s=i/1e3>>0,a=m.DateUtil.getKFDay();if(d.RoleCenter.instans.vo.VIP<n&&a<s)return void f.FE.upItems(v.TextConst.get(587))}var o=new u.ComboHunYinUpgradeMsg;o.curJie=this._hunyinId,p.GSM.sendServer(o)},e.prototype.taskRender=function(e,t){e.showSubTask(this._taskId,e.dataSource)},e.prototype.calcStartIndex=function(){var e=h.GameConfig.commonJson.hunyinzhangjie.value.split(","),t=e.indexOf(this._hunyinId),i=1;return 0<t&&(i=e[t-1]+1),i},e.prototype.renderItem=function(){var i=this;if(!this._running){var e=this.calcStartIndex(),t=Math.min(4,this._hunyinId-e);this.item2.visible=this.item3.visible=2<t?(this.item0.y=this.item1.y=123,!0):(this.item0.y=this.item1.y=216,!1);for(var n,s,a=0,o=-1<d.RoleCenter.instans.vo.comboData.curHunYinJieArr.indexOf(this._hunyinId),r=d.RoleCenter.instans.vo.getHunTLTDataById(this._taskId);a<t;){if(n=this["item"+a],s=c.HeJiStruct.Ins.getHunYinVo(e+a),o)this.setItemOpen(n,s.id,!0);else{var l=!1;this._curStatusArr&&this._curStatusArr[a]==g.enumStatus.yilingqu&&(l=!0);var h=r.curStatusArr[a]==g.enumStatus.yilingqu;if(this._curStatusArr&&h!=l){var u=this.renderEffect(n,a,t);u.once(Laya.Event.COMPLETE,this,function(e,t){i._running=!1,i.renderItem()},[u]),this._running=!0}else h&&this.renderEffect(n,a,t),this.setItemOpen(n,s.id,h)}a++}r&&(this._curStatusArr=r.curStatusArr.concat())}},e.prototype.renderEffect=function(e,t,i){var n=this._effectList[t];return n&&(n.removeSelf(),n.destroy()),(n=a.UIEffectsFactory.Ins.createSAniById(o.UIEffectsEnum.hunyincompose)).pivotX=256,n.pivotY=55,n.x=e.x,n.y=e.y,0==t?n.rotation=2<i?-150:-180:1==t?n.rotation=2<i?-30:0:2==t?n.rotation=-220:3==t&&(n.rotation=40),n.play(0),this.effect_layer.addChild(n),this._effectList[t]=n},e.prototype.setItemOpen=function(e,t,i){if(i)e.ani.visible=!0,this.loadAni(t,e.ani,.6);else{var n=c.HeJiStruct.Ins.getHunYinVo(t);e.ani.stop(),e.ani.visible=!1,e.icon.skin="dynamic/hunyin/hunyin_"+n.id+".png",e.icon.disabled=!0}e.icon.visible=!i},e.prototype.renderAni=function(){var e=d.RoleCenter.instans.vo.comboData,t=c.HeJiStruct.Ins.getHunYinVo(this._hunyinId),i=-1<e.curHunYinJieArr.indexOf(t.id);i?(this.ani.visible=!0,this.loadAni(this._hunyinId,this.ani)):(this.ani.stop(),this.ani.visible=!1,this.img_big.skin="dynamic/hunyin/hunyin_"+t.id+".png",this.img_big.disabled=!0),this.img_big.visible=!i,this.img_name.skin=c.HeJiStruct.getHunNameByHeight(t.icon)},e.prototype.loadAni=function(e,n,s){void 0===s&&(s=1);var a="dynamic2/hunyin/"+c.HeJiStruct.Ins.getHunYinVo(e).id+"a.json";Laya.loader.load(a,Laya.Handler.create(this,function(){n.loadAtlas(a);var e=Laya.loader.getRes(a).frames;for(var t in e)if(e[t]&&e[t].sourceSize){n.width=e[t].sourceSize.w,n.height=e[t].sourceSize.h;break}n.scale(s,s);var i=n.parent;n.x=(i.width-n.width*s)/2,n.y=(i.height-n.height*s)/2,n.interval=200,n.play(0)}),null,Laya.Loader.ATLAS)},e.prototype.hidePage=function(){n.E.ins.off(s.EventName.REFRESH_HUNYIN_TASK,this,this.refreshView)},e}(ui.hunyin.page.HunYinComposePageUI);t.HunYinComposePage=_}),define("src/g/hunyin/view/HunYinComposeView",["require","exports","../../../manager/LayerManager","../../../manager/RuledescManager","src/g/hunyin/view/page/HunYinComposePage","../../../core/E","../../../enum/EventName","../../../meta/HunYinVo"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function e(){var e=t.call(this)||this;return e.helpIndex=0,e.bg.btn_back.on(Laya.Event.CLICK,e,e.onCloseHandler),e.bg.btn_close.on(Laya.Event.CLICK,e,e.onCloseHandler),0<e.helpIndex?(e.bg.btn_help.visible=!0,e.bg.btn_help.on(Laya.Event.CLICK,e,e.onClickHelpHandler)):e.bg.btn_help.visible=!1,e._currPage=new s.HunYinComposePage,e.bg.box_page.addChild(e._currPage),e.bg.img_title.skin="res/hunyin/biaoti_faqizhihun.png",e}return __extends(e,t),e.prototype.showView=function(e){this._hunyinId=e,this.displayedInStage||i.LayerManager.addInPOPWindowLayer(this,!1),this._currPage&&this._currPage.showPage(e),a.E.ins.on(o.EventName.HUNYIN_OPEN_JIE,this,this.onOpenjie)},e.prototype.onOpenjie=function(e){if(this._hunyinId==e){this._currPage&&this._currPage.refreshView(),this.onCloseHandler();var t=r.HeJiStruct.Ins.getHunYinVo(this._hunyinId+1);t&&a.E.ins.event(o.EventName.HUNYIN_TASK_PAGE,t.id)}},e.prototype.onCloseHandler=function(){a.E.ins.off(o.EventName.HUNYIN_OPEN_JIE,this,this.onOpenjie),this.removeSelf(),this._currPage&&this._currPage.hidePage()},e.prototype.onClickHelpHandler=function(){this.helpIndex&&n.RuledescManager.showRuledesc(this.helpIndex)},e}(ui.hunyin.HunYinComposeViewUI);t.HunYinComposeView=l}),define("src/g/hunyin/view/HunYinTips",["require","exports","../../../utils/ItemUtils","../../../config/GameConfig","../../../meta/ShuXingVo"],function(e,t,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initData=function(e){var t=o.ItemUtils.getItemVoById(e),i=r.GameConfig.hunyinProp[e];this.lab_name.text=t.name,this.lab_name.color=o.ItemUtils.getColorByQuality(t.quality),this.item_.img_item.skin=o.ItemUtils.getIconByIconId(t.icon),this.item_.img_quality.skin=o.ItemUtils.getQualitybjByQualityId(t.quality);for(var n=i.prop,s=0;s<n.length;s++){var a=l.ShuXingVo.createSXBox(n[s][0],n[s][1]);this.box_attr.addChild(a),this.box_attr.height+=a.height}this.item_.lab_num.text="",this.img_bg.height=this.box_attr.x+this.box_attr.height+20,this.lab_tip.y=this.img_bg.height,this.height=this.img_bg.height},t}(ui.forge_new.ZhanWenTipsUI);t.hunYinTips=i}),define("src/g/hunyin/view/HunYinInfoView",["require","exports","src/g/hunyin/view/item/HunYinTaskItem","../../Effects/UIEffectsEnum","../../Effects/UIEffectsFactory","../../../meta/HunYinVo","../../../manager/LayerManager","src/g/hunyin/view/HunYinTips","../../net/messages/PropFightMain","../../../plugin/sbkPropTool","../../../config/GameConfig","../../net/messages/sbkFormula","../../../manager/RoleCenter","../../clearRes/ClearResM","../../../utils/ItemUtils","../../../core/E","../../../enum/EventName","../../net/messages/enumStatus","../../../utils/effects/ListEffect","src/g/hunyin/ctrl/page/HunYinTaskPageCtrl","../../net/messages/ComboCultivateMsg","../../../manager/GameSocketManager","../../../utils/system/DateUitl","../../../utils/system/FloatEffect","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C,w,I,b,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(t){function e(){var e=t.call(this)||this;return e.breathe=!1,e.bg1=!0,e.bg2=!1,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.data=d.RoleCenter.instans.vo.comboData,this.viewbg.btn_help.visible=!1,this.list_task.itemRender=i.HunYinTaskItem,g.ClearResM.resetViewImg(this),this.addEvent(),this.htxt_desc.style.font="SimHei",this.htxt_desc.style.color="#e6e2db",this.htxt_desc.style.fontSize=18,this.htxt_desc.style.align="center",this.htxt_desc.innerHTML=S.TextConst.get(586),s.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.btn_activate,n.UIEffectsEnum.getTip_Big,2.5,1.7)},e.prototype.addEvent=function(){this.list_task.renderHandler=new Laya.Handler(this,this.taskRender),this.viewbg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this.viewbg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this.item_0.on(Laya.Event.CLICK,this,this.onItemClick,[0]),this.item_1.on(Laya.Event.CLICK,this,this.onItemClick,[1]),this.item_2.on(Laya.Event.CLICK,this,this.onItemClick,[2]),this.item_3.on(Laya.Event.CLICK,this,this.onItemClick,[3]),this.item_4.on(Laya.Event.CLICK,this,this.onItemClick,[4]),this.item_5.on(Laya.Event.CLICK,this,this.onItemClick,[5]),m.E.ins.on(f.EventName.REFRESH_HUNYIN_TASK,this,this.refreshView),m.E.ins.on(f.EventName.HUNYIN_OPEN_DEBRIS,this,this.onAchivateDebris),s.UIEffectsFactory.Ins.createAndCenter(this.btn_achivate,n.UIEffectsEnum.btn_001,!0),this.on(Laya.Event.REMOVED,this,this.onRemoved),this.btn_activate.on(Laya.Event.CLICK,this,this.onActivateHandler)},e.prototype.onRemoved=function(){this.stopBreath()},e.prototype.ShowView=function(e){this._hunyinId=e,this.vo=a.HeJiStruct.Ins.getHunYinVo(e),this._TLTD=d.RoleCenter.instans.vo.getHunTLTDataById(this.vo.taskId),this.renderView(),this.breathe||this.startBreath(),this.displayedInStage||o.LayerManager.addInPOPWindowLayer(this,!1),v.ListEffect.oppositeFly(this.list_task,6,2,500,100),g.ClearResM.resetViewImg(this),m.E.ins.on(f.EventName.HUNYIN_OPEN_JIE,this,this.onOpenjie),this.checkShowState()},e.prototype.checkShowState=function(){var e=!1,t=u.GameConfig.hunTask[this.vo.taskId];if(t&&t.activation&&0<t.activation.length&&-1==d.RoleCenter.instans.vo.comboData.curHunYinJieArr.indexOf(this._hunyinId)){var i=0;if(this._TLTD)for(var n=0;n<this._TLTD.curStatusArr.length;n++)this._TLTD.curStatusArr[n]==y.enumStatus.yilingqu&&i++;else i=6;6<=i&&(e=!0)}this.box_task.visible=!e,this.box_activate.visible=e},e.prototype.onActivateHandler=function(){var e=u.GameConfig.hunTask[this.vo.taskId];if(e&&e.activation&&0<e.activation.length){var t=e.activation[0][1],i=t%1e3,n=t/1e3>>0,s=I.DateUtil.getKFDay();if(d.RoleCenter.instans.vo.VIP<i&&s<n)return void b.FE.upItems(S.TextConst.get(587))}var a=new C.ComboHunYinUpgradeMsg;a.curJie=this._hunyinId,w.GSM.sendServer(a)},e.prototype.onOpenjie=function(e){if(this._hunyinId==e){var t=a.HeJiStruct.Ins.getHunYinVo(this._hunyinId+1);t&&(-1!=_.HunYinTaskPageCtrl.chapterEndIds.indexOf(t.id)&&this.onClose(),m.E.ins.event(f.EventName.HUNYIN_TASK_PAGE,t.id))}},e.prototype.refreshView=function(){this.displayedInStage&&(this.renderFightNumber(),this.renderItem(),this.list_task.refresh(),this.setBar(),this.renderAni(),this.checkShowState())},e.prototype.onItemClick=function(e){var t=parseInt(this.vo.hunyin[e][0]),i=new r.hunYinTips;i.initData(t),i.popup()},e.prototype.onClose=function(){this.removeSelf()},e.prototype.renderView=function(){this.renderFightNumber(),this.renderItem();var e=u.GameConfig.hunTask[this.vo.taskId];this.list_task.dataSource=e.child,this.img_des.skin="dynamic/hunyin/hunyin_desc/"+this.vo.pirture+".png",this.setBar(),this.renderAni()},e.prototype.taskRender=function(e,t){e.showSubTask(this.vo.taskId,e.dataSource)},e.prototype.renderAni=function(){var e=-1<this.data.curHunYinJieArr.indexOf(this.vo.id);this.ani.visible=!0,this.loadAni(),this.img_big.visible=!e,this.img_name.skin=a.HeJiStruct.getHunNameByHeight(this.vo.icon)},e.prototype.renderItem=function(){for(var e=0;e<6;e++){var t=this["item_"+e];g.ClearResM.resetViewImg(t);var i=parseInt(this.vo.hunyin[e][0]+""),n=p.ItemUtils.getItemVoById(i);t.icon.skin=p.ItemUtils.getIconById(i);var s=-1<this.data.curHunYinIdArr.indexOf(i);t.icon.gray=!s,t.bg.skin="res/hunyin/zhanhun_wupindiban1.png",t.lab_name.text=n.name,t.bg.restskin(),t.icon.restskin(),g.ClearResM.resetViewImg(t)}},e.prototype.setBar=function(){var e=0;if(this._TLTD)for(var t=0;t<this._TLTD.curStatusArr.length;t++)this._TLTD.curStatusArr[t]==y.enumStatus.yilingqu&&e++;else e=6;this.lab_barCount.changeText(e+"/6");var i=this.bar_img.width/6*e;i=0==i?1:i,this.bar_panl.width=i},e.prototype.renderFightNumber=function(){for(var e=new l.PropFightMain,t=0;t<this.vo.hunyin.length;t++){var i=parseInt(this.vo.hunyin[t][0]+""),n=this.data.curHunYinIdArr.indexOf(i);if(-1<n){var s=u.GameConfig.hunyinProp[this.data.curHunYinIdArr[n]];h.sbkPropTool.reSetProp(e,s.prop,!1)}}var a=0;-1<this.data.curHunYinJieArr.indexOf(this.vo.id)&&(a=this.vo.power),this.fightBox.num_Fight.value=c.sbkFormula.calPropFightMainCombat(e)+a+""},e.prototype.onAchivateDebris=function(e){this.displayedInStage&&(s.UIEffectsFactory.Ins.playAniOnce(n.UIEffectsEnum.governUpLv,this["item_"+e].sp),this.renderItem())},e.prototype.startBreath=function(){},e.prototype.breath=function(){},e.prototype.stopBreath=function(){this.breathe=!1,Laya.timer.clear(this,this.breath)},e.prototype.loadAni=function(){var i=this,n="dynamic2/hunyin/"+this.vo.id+"a.json";Laya.loader.load(n,Laya.Handler.create(this,function(){i.ani.source=n;var e=Laya.loader.getRes(n).frames;for(var t in e)if(e[t]&&e[t].sourceSize){i.ani.width=e[t].sourceSize.w,i.ani.height=e[t].sourceSize.h;break}s.UIEffectsFactory.Ins.centered4Parent(i.ani,i.box_),i.ani.interval=200,i.ani.play(0)}),null,Laya.Loader.ATLAS)},e}(ui.hunyin.HunYinInfoViewUI);t.HunYinInfoView=E}),define("src/g/hunyin/ctrl/page/HunYinTaskPageCtrl",["require","exports","../../../../config/GameConfig","../../../base/BaseCtrl","../../../../core/E","../../../../enum/EventName","src/g/hunyin/view/HunYinComposeView","src/g/hunyin/view/HunYinInfoView"],function(e,t,n,i,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function i(){var e=t.call(this)||this;return e.urls=["res/atlas/res/hunyin.json"],n.GameConfig.commonJson?e.init():s.E.ins.once(a.EventName.RES_LOAD_OVER,e,e.init),e}return __extends(i,t),i.prototype.init=function(){i.chapterEndIds=[],n.GameConfig.commonJson.hunyinzhangjie.value.split(",").forEach(function(e){i.chapterEndIds.push(Number(e))}),s.E.ins.on(a.EventName.HUNYIN_TASK_PAGE,this,this.onOpenPanel)},i.prototype.onOpenPanel=function(e){this.openId=e,this.openId&&this.opens()},i.prototype.onAtlasLoaded=function(){this.doOpenPanel(this.openId)},i.prototype.doOpenPanel=function(e){-1!=i.chapterEndIds.indexOf(e)?(this._composeView||(this._composeView=new o.HunYinComposeView),this._composeView.showView(e)):(this._infoView||(this._infoView=new r.HunYinInfoView),this._infoView.ShowView(e))},i}(i.BaseCtrl);t.HunYinTaskPageCtrl=l}),define("src/g/aegis/view/AegisView",["require","exports","src/g/aegis/view/AegisPage","../../../component/PopViewBase"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e._currPage=new i.AegisPage,e.img_title.skin="res/aegis/shendun_biaotui.png",e}return __extends(e,t),e}(n.PopViewBase);t.AegisView=s}),define("src/g/aegis/ctrl/AegisCtrl",["require","exports","../../accessctrl/AccessCenter","src/g/aegis/view/AegisView","../../../manager/GameSocketManager","../../net/messages/sbkAegisData","../../../manager/RoleCenter","../../../core/E","../../../enum/EventName","../../net/messages/sbkTimeLimitTaskData","../../../config/GameConfig","../../net/messages/enumStatus","../../../manager/NewRedHintsCenter"],function(e,t,s,i,n,a,l,h,u,o,c,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(){n.GSM.ins.on(a.sbkAegisData.KEY,this,this.onDataInitHandler),n.GSM.ins.on(a.AegisTaskUpdataGS2C.KEY,this,this.updateTaskHandler),n.GSM.ins.on(a.AegisTaskGetMsg.KEY,this,this.getTaskRewardHandler),n.GSM.ins.on(a.oneAegisTask.KEY,this,this.updateOneTaskHandler),n.GSM.ins.on(a.AegisUpgradeMsg.KEY,this,this.onUpgradeHandler),n.GSM.ins.on(o.TLTData.KEY,this,this.onTLTDataUpdateHandler),h.E.ins.on(u.EventName.SHENWEI_CHANGED,this,this.checkLvRed)}return e.prototype.onDataInitHandler=function(e){l.RoleCenter.instans.vo.aegisData?l.RoleCenter.instans.vo.aegisData.copydata(e):l.RoleCenter.instans.vo.aegisData=e,h.E.ins.event(u.EventName.AEGIS_TASK_DATA_CHANGED);for(var t,i=e.curTask.dataArr.length,n=0;n<i;)t=e.curTask.dataArr[n],this.updateGetState(t.id),n++;h.E.ins.event(u.EventName.AEGIS_TASK_INITED),s.AccessCenter.ins.inited?this.onInitRed():h.E.ins.on(u.EventName.ACCESS_CENTER_INITED,this,this.onInitRed),this._inited=!0},e.prototype.onInitRed=function(){s.AccessCenter.ins.checkOpen(s.enumAccessId.aegis)?(this.checkTaskRed(),this.checkLvRed()):s.AccessCenter.ins.on(s.enumAccessId.aegis,this,this.checkAccess)},e.prototype.checkAccess=function(){s.AccessCenter.ins.checkOpen(s.enumAccessId.aegis)&&(s.AccessCenter.ins.off(s.enumAccessId.aegis,this,this.checkAccess),this.checkTaskRed(),this.checkLvRed())},e.prototype.updateOneTaskHandler=function(e){var t=this.getTLTDataById(e.taskId);if(t&&t){var i=c.GameConfig.aegisTaskGroupJson[e.taskId];if(i){var n=i.child.indexOf(e.childId);-1!=n&&(t.statusArr[n]=e.value,this.updateGetState(e.taskId),h.E.ins.event(u.EventName.AEGIS_TASK_DATA_CHANGED,e.taskId),this.checkTaskRed())}}},e.prototype.onTLTDataUpdateHandler=function(e){if(!(e.id<31e3||32e3<e.id)&&e){var t,i,n=l.RoleCenter.instans.vo.aegisData.curTask;-1!=(i=n.idArr.indexOf(e.id))?(t=n.dataArr[i])&&(t.copydata(e),this.updateGetState(e.id),h.E.ins.event(u.EventName.AEGIS_TASK_DATA_CHANGED,e.id)):(n.idArr.push(e.id),n.dataArr.push(e),this.updateGetState(e.id),h.E.ins.event(u.EventName.AEGIS_TASK_DATA_CHANGED,e.id)),this.checkTaskRed()}},e.prototype.updateTaskHandler=function(e){for(var t,i,n,s,a=e.updataArr.length,o=0,r=l.RoleCenter.instans.vo.aegisData.curTask;o<a;)(t=e.updataArr[o])&&-1!=(n=r.idArr.indexOf(t.taskId))&&(i=r.dataArr[n])&&(s=c.GameConfig.aegisTaskGroupJson[t.taskId])&&-1!=(n=s.child.indexOf(t.childId))&&(i.statusArr[n]=t.value,this.updateGetState(t.taskId),h.E.ins.event(u.EventName.AEGIS_TASK_DATA_CHANGED,t.taskId)),o++;this.checkTaskRed()},e.prototype.getTaskRewardHandler=function(e){var t,i,n=l.RoleCenter.instans.vo.aegisData.curTask;if(-1!=(i=n.idArr.indexOf(e.taskId))){if(t=n.dataArr[i]){var s=c.GameConfig.aegisTaskGroupJson[e.taskId].child.indexOf(e.taskChildId);t.curStatusArr[s]=r.enumStatus.yilingqu;var a=c.GameConfig.aegisTaskJson[e.taskChildId];if(a){var o=a.reward.length;for(s=0;s<o;)l.RoleCenter.instans.vo[a.reward[s][0]]+=Number(a.reward[s][1]),s++}h.E.ins.event(u.EventName.AEGIS_TASK_DATA_CHANGED,e.taskId),h.E.ins.event(u.EventName.AEGIS_TASK_COMPLET,e.taskId)}this.checkTaskRed()}},e.prototype.onUpgradeHandler=function(e){if(1==e.type){var t=l.RoleCenter.instans.vo.aegisData.star;l.RoleCenter.instans.vo.aegisData.star=e.curValue;var i=c.GameConfig.aegisStarJson[t];i&&(l.RoleCenter.instans.vo.SHENWEI-=i.exp),h.E.ins.event(u.EventName.EFFECT_POP_ONCE,[29,1,-100])}else 2==e.type&&(l.RoleCenter.instans.vo.aegisData.level=e.curValue,this.checkLvRed(),h.E.ins.event(u.EventName.EFFECT_POP_ONCE,[29,1,-100]));h.E.ins.event(u.EventName.AEGIS_UPGRADE_SUCCESS)},e.prototype.getTLTDataById=function(e){var t=l.RoleCenter.instans.vo.aegisData.curTask,i=t.idArr.indexOf(e);return-1!=i?t.dataArr[i]:null},e.prototype.updateGetState=function(e){var t=this.getTLTDataById(e);if(t)for(var i,n,s=c.GameConfig.aegisTaskGroupJson[e],a=s.child.length,o=0;o<a;)(n=c.GameConfig.aegisTaskJson[s.child[o]])&&(i=t.statusArr[o],n.need<=i?(t.curStatusArr[o]!=r.enumStatus.yilingqu&&(t.curStatusArr[o]=r.enumStatus.kelingqu),0):t.curStatusArr[o]=r.enumStatus.weiwancheng),o++},e.prototype.checkTaskRed=function(){if(s.AccessCenter.ins.checkOpen(s.enumAccessId.aegis))for(var e=l.RoleCenter.instans.vo.aegisData.curTask,t=e.dataArr.length,i=0;i<t;){if(-1!=e.dataArr[i].curStatusArr.indexOf(r.enumStatus.kelingqu))return void d.NewRedHintsCenter.ins.setRedHintOpenOrClose(d.enumRedHints.aegis_task,!0);i++}d.NewRedHintsCenter.ins.setRedHintOpenOrClose(d.enumRedHints.aegis_task,!1)},e.prototype.checkLvRed=function(){if(s.AccessCenter.ins.checkOpen(s.enumAccessId.aegis)){var e=!1;if(10<=l.RoleCenter.instans.vo.aegisData.star-10*l.RoleCenter.instans.vo.aegisData.level)e=!0;else{var t=l.RoleCenter.instans.vo.aegisData.star,i=c.GameConfig.aegisStarJson[t];if(i){var n=l.RoleCenter.instans.vo.SHENWEI;i.exp<=n&&(e=!0)}}}d.NewRedHintsCenter.ins.setRedHintOpenOrClose(d.enumRedHints.aegis_lv,e)},e.prototype.onOpenIdHandler=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),e&&this.onOpenHandler(t,i)},e.prototype.onOpenHandler=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),this._view||(this._view=new i.AegisView),this._view.showView(e,t)},e}();t.AegisCtrl=g}),define("src/g/bosswaring/ctrl/BossWarningCtrl",["require","exports","../../../core/E","../../../enum/EventName","../../fight/osprite/play/PlayManager","../../net/messages/ChangeSceneMsg","../../clearRes/ClearResM","../../../manager/RoleCenter"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this.countdanger=1,this._count=0,i.E.ins.on(n.EventName.BOSSWARNINGSHOW,this,this.showviewHandler),i.E.ins.on(n.EventName.PLAY_TYPE_CHANGED,this,this.removeHandler),i.E.ins.on(n.EventName.DANGERSHOW,this,this.showDanger)}return e.prototype.showDanger=function(){this._danger||(this._danger=new Laya.Image,this._danger.skin="res/unpack/zhandou_hongtishi.png"),this._danger.width=Laya.stage.width,this._danger.height=Laya.stage.height,Laya.stage.addChild(this._danger),Laya.timer.loop(200,this,this.showDangerVisble)},e.prototype.showDangerVisble=function(){this.countdanger++,7<this.countdanger&&(Laya.timer.clearAll(this),this._danger.removeSelf(),o.ClearResM.clearUrl(this._danger.skin),this._danger.skin=""),this._danger&&(this._danger.visible=!this._danger.visible)},e.prototype.showviewHandler=function(e){if(this.view||(this.view=new ui.index.BossWarningViewUI,this.view.danger_red.width=Laya.stage.width,this.view.danger_red.height=Laya.stage.height),e){this.view.portbox.visible=!1,this.view.boss_warning.visible=!0,this.view.boss_warning.skin=e,this.view.boss_warning.pivotX=this.view.boss_warning.width,this.view.boss_bg.x=this.view.boss_warning.x=0,this.view.boss_bg.width=Laya.stage.width,this.view.boss_bg.alpha=this.view.boss_warning.alpha=0,Laya.stage.addChild(this.view),Laya.timer.clear(this,this.alphaHandler),this._count=0,this.view.danger_red.visible=!1,this.view.danger_red.alpha=.3,this.view.addChild(this.view.danger_red),Laya.timer.clearAll(this),Laya.Tween.to(this.view.boss_bg,{x:604,alpha:1},300,null);var t=Laya.stage.width-this.view.boss_warning.width>>1;t+=this.view.boss_warning.pivotX,Laya.Tween.to(this.view.boss_warning,{x:t,alpha:1},300,null,new Laya.Handler(this,this.moveBossWarning),200)}else{this.view.portbox.visible=!0,this.view.boss_warning.visible=!1,this.view.boss_bg.x=0,this.view.boss_bg.width=Laya.stage.width,this.view.boss_bg.alpha=0;var i=60*(this.view.portnum.value=r.RoleCenter.instans.vo.portstatus.portindex-100+"").toString().length;this.view.portbox.width=this.view.di.width+i+this.view.guan.width,this.view.portbox.x=-(this.view.di.width+i+this.view.guan.width),this.view.di.x=0,this.view.portnum.x=this.view.di.width,this.view.guan.x=this.view.di.width+i,this.view.portbox.alpha=0;t=(Laya.stage.width-this.view.portbox.width)/2;Laya.stage.addChild(this.view),Laya.timer.clear(this,this.alphaHandler),this._count=0,this.view.danger_red.visible=!1,this.view.danger_red.alpha=.3,Laya.timer.clearAll(this),Laya.Tween.to(this.view.boss_bg,{x:604,alpha:1},300,null),Laya.Tween.to(this.view.portbox,{x:t,alpha:1},300,null,new Laya.Handler(this,this.moveBossWarning),200)}},e.prototype.alphaHandler=function(){this._count++,4<=this._count&&(this.view.danger_red.removeSelf(),Laya.timer.once(500,this,function(){Laya.Tween.to(this.view.boss_bg,{x:1e3,alpha:0},300,null,new Laya.Handler(this,this.removeView),300),Laya.Tween.to(this.view.portbox,{x:1e3,alpha:0},300,null),Laya.Tween.to(this.view.boss_warning,{x:1e3,alpha:0},300,null)})),this.view.danger_red.visible=!this.view.danger_red.visible},e.prototype.moveBossWarning=function(){Laya.timer.loop(200,this,this.alphaHandler)},e.prototype.removeHandler=function(){switch(s.PlayManager.type){case a.EPlayType.PLAYTYPE_PRIBOSS:case a.EPlayType.PLAYTYPE_PORT:case a.EPlayType.PLAYTYPE_QUANMINBOSS:this.removeView()}},e.prototype.removeView=function(){this.view&&(this.view.removeSelf(),Laya.timer.clearAll(this),Laya.Tween.clearAll(this.view.boss_bg),this.view.danger_red.visible=!1),Laya.timer.clear(this,this.alphaHandler),this._danger&&(this._danger.destroy(),this._danger=null,Laya.timer.clearAll(this))},e}();t.BossWarningCtrl=l}),define("src/g/GodWing/View/GGodWingView",["require","exports","../../../manager/LayerManager","../../clearRes/ClearResM"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.showView=function(e){void 0===e&&(e=!0),this.tab_page.selectedIndex=0,i.LayerManager.addInPOPWindowLayer(this,e,!1),n.ClearResM.resetViewImg(this)},e.prototype.hideView=function(){this.bgView.box_page.removeChildren(),this.removeSelf()},e.prototype.destroyView=function(){this.hideView()},e}(ui.role.GodWing.GGodWingDlgUI);t.GGodWingView=s}),define("src/g/GodWing/View/GodWingSkillDlg",["require","exports","../../../config/GameConfig","../../../utils/ItemUtils","../../../init/TextConst"],function(e,t,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this,t=e.lab_desc.style;return t.font="SimHei",t.color="#a89e8f",t.stroke=1,t.fontSize=20,t.wordWrap=!0,t.strokeColor="#060606",e}return __extends(e,i),e.prototype.initData=function(e){var t=r.GameConfig.WingConfigJson[1].skillopen,i=t.indexOf(e),n=-1<i;this.lab_open.text=n?h.TextConst.get(524):h.TextConst.get(485),i=n?i+1:0,this.lab_lv.text=i+1+"";for(var s=l.ItemUtils.getWingPassiveVoById(i+1),a=s.desc,o=0;o<s.effect.length;o++)a=a.replace("{"+s.effect[o][0]+"}",s.effect[o][1]/1e4+"");a=a.replace("{rate}",s.rate/100+""),this.lab_desc.innerHTML=a,this.lab_need.text=isNaN(t[i])?h.TextConst.get(208):h.TextConst.get(525,t[i])},e}(ui.role.GodWing.WingSkillDlgUI);t.GodWingSkillDlg=i}),define("src/g/GodWing/View/Item/WingMasterItem",["require","exports","../../../../enum/enumItem","../../../../init/TextConst"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showTitle=function(e){this.lab_title.changeText(e)},t.prototype.showParam0=function(e,t){this.lab_param_0.text=n.TextConst.get(526,e,t,4)},t.prototype.showParam1=function(e){this.lab_param_1.text=n.TextConst.get(527,e)},t.prototype.showType=function(e){this.lab_type.text=e?n.TextConst.get(524):n.TextConst.get(485);var t=e?i.enumItem.greenColor:i.enumItem.grayColor;this.lab_param_0.color=t,this.lab_param_1.color=t,this.lab_type.color=t},t}(ui.role.GodWing.Item.WingMasterItemUI);t.WingMasterItem=s}),define("src/g/GodWing/View/GodWingMasterDlg",["require","exports","../../../utils/ItemUtils","src/g/GodWing/View/Item/WingMasterItem"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.nowLv=0,e.state=0,e}return __extends(e,t),e.prototype.initData=function(e,t){void 0===t&&(t=0),this.nowLv=e,this.state=t,this.renderPage(),this.changeDlgSize()},e.prototype.renderPage=function(){var e;(e=i.ItemUtils.getWingSuilVoById(this.nowLv))&&(this.dlg_vbox.addChild(this.getItem(this.nowLv,e)),this.dlg_vbox.height+=156),null!=(e=i.ItemUtils.getWingSuilVoById(this.nowLv+1))&&(this.dlg_vbox.addChild(this.getItem(this.nowLv+1,e)),this.dlg_vbox.height+=156)},e.prototype.getItem=function(e,t){var i=this.nowLv+1==e,n=new s.WingMasterItem;return n.showTitle(t.wingsuit),n.showParam0(t.needLevel,i?this.state:4),n.showParam1(t.ALL_MULTI/100),n.showType(!i),n},e.prototype.changeDlgSize=function(){this.dlg_vbox.height-=156,this.img_bg.height=this.dlg_vbox.height,this.height=this.dlg_vbox.height},e}(ui.role.GodWing.GodWingMasterDlgUI);t.GodWingMasterDlg=n}),define("src/g/GodWing/View/GodEquipPage",["require","exports","src/g/GodWing/View/GodWingSkillDlg","../../../manager/GameSocketManager","../../net/messages/ErrConst","../../../utils/ItemUtils","../../../manager/RoleCenter","../../../vo/GodWingVo","../../net/messages/sbkFormula","../../net/messages/PropFightMain","../../../utils/system/ErrCodeView","../../net/messages/WingEquipC2GS","../../net/messages/OpResultType","../../../utils/system/FloatEffect","src/g/GodWing/View/GodWingMasterDlg","../../Effects/UIEffectsEnum","../../Effects/UIEffectsFactory","../../../vo/RedDot/role/RedDot_GodWing","../../../plugin/view/ToolTip","../../../core/E","../../../vo/RedDot/EventRedDot","../../../init/TextConst"],function(e,t,i,u,o,c,n,d,h,g,r,p,m,f,s,a,l,y,v,_,C,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=function(t){function e(){var e=t.call(this)||this;return e.boxXPos=[97,210],e.p_ItemIdx=0,e.p_hIdx=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.user=n.RoleCenter.instans.vo,this.btn_comp.on(Laya.Event.CLICK,this,this.onComp),this.btn_puton.on(Laya.Event.CLICK,this,this.onEquip),this.btn_master.on(Laya.Event.CLICK,this,this.openMaster),this.box_skill.on(Laya.Event.CLICK,this,this.openSkill),_.E.ins.on(C.EventRedDot.REFRESH_GODWING,this,this.refreshRedDot),this.onLoadUIEF()},e.prototype.openSkill=function(){this.user=n.RoleCenter.instans.vo,this.hero=this.user.getOpenHeroByIdx(this.p_hIdx);var e=new i.GodWingSkillDlg;e.initData(this.hero.heroWing.wingSuitLv),e.popup()},e.prototype.openMaster=function(){for(var e=0,t=7;t<=10;t++){this.hero.heroWing.getWingEquipByPos(t).lv>this.hero.heroWing.wingSuitLv&&e++}var i=new s.GodWingMasterDlg;i.initData(this.hero.heroWing.wingSuitLv,e),i.popup()},e.prototype.onComp=function(){this.t_item=this.getItemByIdx(this.p_ItemIdx);var e,t=this.hero.heroWing.getWingEquipByPos(this.t_item.name),i=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t.lv),n=this.hero.heroWing.level;if(null==i){if((e=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,1)).limit>n)return void f.FE.upItems(w.TextConst.get(519,e.limit),v.BubbleEnum.center);var s=c.ItemUtils.getItemVoById(parseInt(e.worth[0][0]));if((r=e.worth[0][1])<=(h=this.user.bagdata.getItemCount(s.id)))(o=new p.WingEquipC2GS).pos=parseInt(this.t_item.name),o.heroidx=this.p_hIdx,o.msgidx=m.enumOpResultType.WingEquip_rapidSynthesis,u.GSM.sendServer(o);else f.FE.upItems(w.TextConst.get(520),v.BubbleEnum.center)}else{var a=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t.lv+1);if(a){var o,r=a.worth[0][1],l=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t.lv),h=this.user.bagdata.getWingEquipCount(l.id)+1;if(a.limit>n)return void f.FE.upItems(w.TextConst.get(521,a.limit),v.BubbleEnum.center);if(r<=h)(o=new p.WingEquipC2GS).pos=parseInt(this.t_item.name),o.heroidx=this.p_hIdx,o.msgidx=m.enumOpResultType.WingEquip_rapidUpLv,u.GSM.sendServer(o);else f.FE.upItems(w.TextConst.get(520),v.BubbleEnum.center)}}},e.prototype.onEquip=function(){this.t_item=this.getItemByIdx(this.p_ItemIdx);for(var e,t=this.hero.heroWing.getWingEquipByPos(this.t_item.name).lv+1,i=this.hero.heroWing.level,n=!1,s=5;t<=s&&(e=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,s),!(n=0<this.user.bagdata.getWingEquipCount(e.id)&&e.limit<=i));s--);if(n){var a=new p.WingEquipC2GS;a.pos=parseInt(this.t_item.name),a.heroidx=this.p_hIdx,a.msgidx=m.enumOpResultType.WingEquip_equip,u.GSM.sendServer(a),this.ani_puton.visible=!0}else this.ani_puton.visible=!1,r.ErrCodeView.show(o.enumErrConst.code_2212)},e.prototype.refreshData=function(e){this.p_hIdx=e,this.renderPage()},e.prototype.renderPage=function(){this.hero=this.user.getOpenHeroByIdx(this.p_hIdx),this.showIcon(),this.showAttr(),this.showNeed(),this.checkSkill(),this.refreshRedDot(),this.img_skillIcon.gray=!(4<=this.hero.heroWing.wingSuitLv)},e.prototype.refreshRedDot=function(){for(var e=0;e<4;e++)this.getItemByIdx(e).img_red.visible=y.RedDot_GodWing.Ins.getEuqipByHeroIdx(this.p_hIdx,!0)[e]||y.RedDot_GodWing.Ins.getQuickCompByHeroIdx(this.p_hIdx,!0)[e]},e.prototype.showAttr=function(){this.ani_puton.visible=!1,this.t_item=this.getItemByIdx(this.p_ItemIdx);for(var e,t=this.hero.heroWing.getWingEquipByPos(this.t_item.name),i=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t.lv),n=t.lv+1,s=this.hero.heroWing.level,a=!1,o=5;n<=o&&(e=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,o),!(a=0<this.user.bagdata.getWingEquipCount(e.id)&&e.limit<=s));o--);if(this.ani_puton.visible=!!a,null==i)this.box_next.visible=!1,this.box_now.x=this.boxXPos[1],this.lab_now_title.text=w.TextConst.get(517),this.renderBoxAttr("now",1);else{this.box_next.visible=!0,this.box_now.x=this.boxXPos[0],this.lab_now_title.text=w.TextConst.get(518),this.renderBoxAttr("now",i.lv);var r=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,i.lv+1);null==r?(this.box_now.x=this.boxXPos[1],this.box_next.visible=!1,this.lab_now_title.text=w.TextConst.get(208)):this.renderBoxAttr("next",r.lv)}},e.prototype.renderBoxAttr=function(e,t){this.t_item=this.getItemByIdx(this.p_ItemIdx);for(var i=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t),n=new g.PropWingEquip,s=0;s<4;s++){var a=i.prop[s],o=this["lab_"+e+"_"+s];if(null!=a){n[a[0]]=a[1];var r=c.ItemUtils.getShuXingByName(a[0]),l="%"==r.unit?a[1]/100:a[1];o.text=r.desc+": "+l+r.unit,o.color=r.color}else o.text=""}this["lab_"+e+"_fightNum"].text=w.TextConst.get(80,h.sbkFormula.calWingEquipCombat(n))},e.prototype.checkSkill=function(){},e.prototype.onLoadUIEF=function(){this.ani_put=l.UIEffectsFactory.Ins.createSAniAndCenter(this.btn_comp,a.UIEffectsEnum.btn_001,.73,.95),this.ani_puton=l.UIEffectsFactory.Ins.createSAniAndCenter(this.btn_puton,a.UIEffectsEnum.btn_001,.73,.95),this.ani_puton.visible=!1},e.prototype.showNeed=function(){var e,t,i;this.html_need.visible=!0,this.btn_comp.disabled=!1,this.t_item=this.getItemByIdx(this.p_ItemIdx);var n=this.hero.heroWing.getWingEquipByPos(this.t_item.name),s=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,0==n.lv?1:n.lv);if(0==n.lv)s=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,1),i=c.ItemUtils.getItemVoById(parseInt(s.worth[0][0])),e=s.worth[0][1],t=this.user.bagdata.getItemCount(i.id),this.btn_comp.label=w.TextConst.get(947),this.ani_put.visible=!0,this.setNeed(i.name,i.quality,t,e);else{if(this.btn_comp.label=w.TextConst.get(946),this.ani_put.visible=!1,null==(s=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,n.lv+1)))return this.html_need.visible=!1,void(this.btn_comp.disabled=!0);e=s.worth[0][1],t=this.user.bagdata.getWingEquipCount(parseInt(s.worth[0][0]+""));var a=c.ItemUtils.getGodWingVoById(parseInt(s.worth[0][0]));if(null!=a&&n.lv==a.lv&&(t+=1),i=c.ItemUtils.getItemVoById(parseInt(s.worth[0][0])),e<=t&&(this.ani_put.visible=!0),null==i){var o=c.ItemUtils.getGodWingVoById(parseInt(s.worth[0][0]));this.setNeed(o.name,o.quality,t,e)}else this.setNeed(i.name,i.quality,t,e)}var r=this.hero.heroWing.level;e<=t&&r>=s.limit?this.ani_put.visible=!0:this.ani_put.visible=!1},e.prototype.setNeed=function(e,t,i,n){this.html_need.style.fontSize=20,this.html_need.style.align="center";var s=w.TextConst.get(522);s+="<span color='"+c.ItemUtils.getColorByQuality(t)+"'>"+e+" </span>",s+="<span color='#"+(i<n?"d24000":"c0b4a3")+"'>"+i+"</span>",s+="<span color='#c0b4a3'> / "+n+"</span>",this.html_need.innerHTML=s},e.prototype.showIcon=function(){for(var e=0,t=0;t<4;t++){this.t_item=this.getItemByIdx(t);var i=this.hero.heroWing.getWingEquipByPos(this.t_item.name),n=d.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,i.lv);0==i.lv?(this.t_item.setIcon("res/role/wing/"+ktgame.RoleDefineMod.arr_wingEPosConst[this.t_item.name]+".png"),this.t_item.setBg(c.ItemUtils.getQualitybjByQualityId(1)),this["lab_name_"+t].text=""):(this.t_item.setIcon(c.ItemUtils.getIconByIconId(n.icon)),this.t_item.setBg(c.ItemUtils.getQualitybjByQualityId(n.quality)),this["lab_name_"+t].text=n.name,this["lab_name_"+t].color=c.ItemUtils.getColorByQuality(n.quality)),e+=h.sbkFormula.calWingEquipCombat(i.propW)}this.FightNum.num_Fight.value=e+""},e.prototype.setSelect=function(e){null!=e&&(this.p_ItemIdx=e);for(var t=0;t<4;t++)this.t_item=this.getItemByIdx(t),this.t_item.setSelect(t==this.p_ItemIdx);this.renderPage()},e.prototype.getItemByIdx=function(e){return this["item_"+e]},e}(ui.role.GodWing.Page.GWEquipPageUI);t.GodEquipPage=I}),define("src/g/GodWing/Ctrl/GodWingEquipCtrl",["require","exports","src/g/GodWing/View/GodEquipPage","../../Effects/UIEffectsFactory","../../../init/ResManager","../../Effects/UIEffectsEnum"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this._hidx=0,this.p_hIdx=0}return e.prototype.init=function(){this._view=new i.GodEquipPage,this.addEvent()},e.prototype.playCompAni=function(){this._view&&n.UIEffectsFactory.Ins.playAniOnce(a.UIEffectsEnum.wingcomp,this._view.aniSp,1.3,1.3)},e.prototype.playUpAni=function(){this._view&&n.UIEffectsFactory.Ins.playAniOnce(11,this._view.aniSp)},e.prototype.playEquipByPos=function(e){var t=this._view["item_"+e];t&&n.UIEffectsFactory.Ins.playAniOnce(3,t.upSp)},e.prototype.addEvent=function(){for(var e=0;e<4;e++){this._view["item_"+e].on(Laya.Event.CLICK,this._view,function(e,t){t.setSelect(e)},[e,this._view])}},e.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),this.refreshData(),this._view.setSelect(this.p_hIdx),e.addChild(this._view),s.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.changePerson=function(e){this.p_hIdx=e,this.refreshData(),this._view.setSelect(e)},e.prototype.refreshData=function(){this._view&&(this._view.refreshData(this.p_hIdx),this._view.setSelect())},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){s.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){s.ResManager.getInstance().destroyPageCtrl(this)},e}();t.GodWingEquipCtrl=o}),define("src/g/GodWing/View/GodCompPage",["require","exports","../../custom/detailDlgs/Details_Item","../../custom/detailDlgs/Details_Equip","../../../config/GameConfig","../../../manager/RoleCenter","../../net/messages/PropFightMain","../../../vo/GodWingVo","../../../utils/ItemUtils","../../net/messages/sbkFormula","../../net/messages/WingEquipC2GS","../../../manager/GameSocketManager","../../../manager/AM","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../../vo/RedDot/role/RedDot_GodWing","../../../core/E","../../../vo/RedDot/EventRedDot","../../clearRes/ClearResM","../../../init/TextConst"],function(e,t,a,o,n,r,l,h,u,c,d,g,p,i,s,m,f,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(t){function e(){var e=t.call(this)||this;return e.p_EPosArr=[0,0,0,0],e.p_ItemIdx=0,e.p_tabIdx=0,e.p_pos=0,e._resurl="res/atlas/res/role/wing.json?version="+Math.random(),e.user=r.RoleCenter.instans.vo,e.btn_comp.on(Laya.Event.CLICK,e,e.onComp),f.E.ins.on(y.EventRedDot.REFRESH_GODWING,e,e.refreshRedDot),e.ani_put=i.UIEffectsFactory.Ins.createSAniAndCenter(e.btn_comp,s.UIEffectsEnum.btn_001),e}return __extends(e,t),e.prototype.initListName=function(){for(var e=[_.TextConst.get(133),_.TextConst.get(134),_.TextConst.get(135),_.TextConst.get(136)],t=0;t<5;t++){var i=this.tab_select.getChildByName("item"+t);i.skin="res/role/wing/SY_anniu_00"+(t+1)+".png",i.getChildByName("wing_name").text=_.TextConst.get(35,e[this.p_ItemIdx],t+1)}},e.prototype.onComp=function(){var e,t=h.GodWingStruct.Ins.getGodWingEquipVo(this.p_pos,this.p_tabIdx+1);if(1==t.lv){var i=u.ItemUtils.getItemVoById(parseInt(t.worth[0][0]));e=this.user.bagdata.getItemCount(i.id)}else{var n=h.GodWingStruct.Ins.getGodWingEquipVo(this.p_pos,t.lv-1);e=this.user.bagdata.getWingEquipCount(n.id)}if(t.worth[0][1]<=e){if(!r.RoleCenter.instans.bagRoomEnough(1))return void p.AM.showBagNotEnough();var s=new d.WingEquipCompoundC2GS;s.wingEquipID=t.id,g.GSM.sendServer(s)}},e.prototype.renderPage=function(){this.bgimg.restskin(),this.initListName(),this.refreshBagHave(),this.setIcon(),this.showAttr(),this.refreshRedDot(),v.ClearResM.resetViewImg(this)},e.prototype.showAttr=function(){var e,t,i=h.GodWingStruct.Ins.getGodWingEquipVo(this.p_pos,this.p_tabIdx+1);if(this.item_now.offAll(),this.item_next.offAll(),1==i.lv){var n=u.ItemUtils.getItemVoById(parseInt(i.worth[0][0]));e=this.user.bagdata.getItemCount(n.id),this.item_now.setBg(u.ItemUtils.getQualityBjById(n.id)),this.item_now.setIcon(u.ItemUtils.getIconById(n.id)),this.name_now.text=n.name,this.name_now.color=u.ItemUtils.getColorByQuality(n.quality),this.renderBoxAttr("now",i.lv),this.lab_now_name.skin="res/role/wing/SY_wenzi_007.png",this.box_next.visible=!1,this.item_now.on(Laya.Event.CLICK,this,function(){var e=new a.Details_Item;e.initData(n,1),e.popup()},[n])}else{var s=h.GodWingStruct.Ins.getGodWingEquipVo(this.p_pos,i.lv-1);this.item_now.setBg(u.ItemUtils.getQualitybjByQualityId(s.quality)),this.item_now.setIcon(u.ItemUtils.getIconByIconId(s.icon)),this.name_now.text=s.name,this.name_now.color=u.ItemUtils.getColorByQuality(s.quality),e=this.user.bagdata.getWingEquipCount(s.id),this.renderBoxAttr("now",s.lv),this.renderBoxAttr("next",i.lv),this.box_next.visible=!0,this.lab_now_name.skin="res/role/wing/SY_wenzi_001.png",this.item_now.on(Laya.Event.CLICK,this,function(){var e=new o.Details_Equip;e.initWing(s),e.popup()},[s])}this.item_next.setIcon(u.ItemUtils.getIconByIconId(i.icon)),this.item_next.setBg(u.ItemUtils.getQualitybjByQualityId(i.quality)),this.name_next.text=i.name,this.name_next.color=u.ItemUtils.getColorByQuality(i.quality),t=i.worth[0][1],this.item_next.on(Laya.Event.CLICK,this,function(){var e=new o.Details_Equip;e.initWing(i),e.popup()},[i]),this.ani_put.visible=t<=e,this.setNeed(e,t)},e.prototype.setIcon=function(){for(var e=0;e<this.p_EPosArr.length;e++){this.t_item=this.getItemByIdx(e);var t=h.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,this.p_EPosArr[e]);null==t?(this.t_item.img_border.visible=!0,this.t_item.setIcon("res/role/wing/"+ktgame.RoleDefineMod.arr_wingEPosConst[this.t_item.name]+".png"),this.t_item.setBg(u.ItemUtils.getQualitybjByQualityId(1)),this.t_item.setTitle("res/role/wing/"+ktgame.RoleDefineMod.arr_wingEPosConst[this.t_item.name]+"_name.png")):(this.t_item.setIcon(u.ItemUtils.getIconByIconId(t.icon)),this.t_item.setBg(u.ItemUtils.getQualitybjByQualityId(t.quality-1)))}},e.prototype.refreshBagHave=function(){for(var e=0;e<this.p_EPosArr.length;e++){this.p_EPosArr[e]=0,this.t_item=this.getItemByIdx(e);for(var t=0;t<n.GameConfig.WingSuit.length;t++){var i=h.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t);0<this.user.bagdata.getWingEquipCount(i.id)&&(this.p_EPosArr[e]=i.id)}}},e.prototype.changeTab=function(e){void 0===e&&(e=0),this.p_tabIdx=e,this.renderPage()},e.prototype.refreshRedDot=function(){for(var e=0;e<4;e++)this.getItemByIdx(e).img_red.visible=-1<m.RedDot_GodWing.Ins.getComp(!0)[e].indexOf(!0);var t=m.RedDot_GodWing.Ins.getComp(!0)[this.p_pos-7];for(e=0;e<5;e++){this.tab_select.getChildByName("item"+e).getChildByName("img_red").visible=t[e]}},e.prototype.refreshData=function(){this.renderPage()},e.prototype.renderBoxAttr=function(e,t){this.t_item=this.getItemByIdx(this.p_ItemIdx);for(var i=h.GodWingStruct.Ins.getGodWingEquipVo(this.t_item.name,t),n=new l.PropWingEquip,s=0;s<4;s++)if(null!=i.prop[s]){n[i.prop[s][0]]=i.prop[s][1];var a=u.ItemUtils.getShuXingByName(i.prop[s][0]),o="%"==a.unit?i.prop[s][1]/100:i.prop[s][1];this["lab_"+e+"_"+s].text=a.desc+": "+o+a.unit,this["lab_"+e+"_"+s].color=a.color}else this["lab_"+e+"_"+s].text="";this["lab_"+e+"_fightNum"].text=_.TextConst.get(80,c.sbkFormula.calWingEquipCombat(n))},e.prototype.setNeed=function(e,t){this.html_need.style.align="center",this.html_need.style.fontSize=20;var i="";i+="<span color='#"+(e<t?"d24000":"c0b4a3")+"'>"+e+"</span>",i+="<span color='#c0b4a3'> / "+t+"</span>",this.html_need.innerHTML=i},e.prototype.setSelect=function(e){this.p_ItemIdx=e;for(var t=0;t<4;t++)this.t_item=this.getItemByIdx(t),this.t_item.setSelect(t==e);this.t_item=this.getItemByIdx(e),this.p_pos=parseInt(this.t_item.name),this.renderPage()},e.prototype.getItemByIdx=function(e){return this["item_"+e]},e}(ui.role.GodWing.Page.GWCompPageUI);t.GodCompPage=C}),define("src/g/GodWing/Ctrl/GodWingCompCtrl",["require","exports","src/g/GodWing/View/GodCompPage","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../../enum/EventName","../../../core/E","../../../init/ResManager"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype.init=function(){this._view=new i.GodCompPage,this.addEvent()},e.prototype.playCompAni=function(){this._view&&n.UIEffectsFactory.Ins.playAniOnce(s.UIEffectsEnum.wingcomp,this._view.aniSp)},e.prototype.addEvent=function(){for(var t=this,e=0;e<4;e++)this._view["item_"+e].on(Laya.Event.CLICK,this,function(e){t._view.setSelect(e)},[e]);this._view.tab_select.selectHandler=new Laya.Handler(this,this.changeTab),this._view.tab_select.selectedIndex=0,o.E.ins.on(a.EventName.CHANGEITEM_COUNT,this,this.onChangeItem),o.E.ins.on(a.EventName.CHANGEWINGEQUIP_COUNT,this,this.onChangeWingEquip)},e.prototype.onChangeItem=function(e){346==e&&this.refreshData()},e.prototype.onChangeWingEquip=function(){this.refreshData()},e.prototype.changeTab=function(e){this._view.changeTab(e)},e.prototype.showPage=function(e,t){this._view||this.init(),this._view.setSelect(0),e.removeChildren(),this._view.refreshData(),e.addChild(this._view),r.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.changePerson=function(e){},e.prototype.refreshData=function(){this._view&&this._view.displayedInStage&&this._view.refreshData()},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){r.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){r.ResManager.getInstance().destroyPageCtrl(this)},e}();t.GodWingCompCtrl=l}),define("src/g/GodWing/View/GodSwitchPage",["require","exports","../../../manager/GameSocketManager","../../../utils/ItemUtils","../../../config/GameConfig","../../../manager/RoleCenter","../../../vo/GodWingVo","../../net/messages/WingEquipC2GS","../../../utils/system/FloatEffect","../../../plugin/view/ToolTip","../../accessctrl/AccessCenter","../../../init/TextConst","../../../init/Switches"],function(e,t,i,n,a,o,r,s,l,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e.posArr=[7,8,9,10],e.wVoArr=[],e.p_lIdx=-1,e.p_targePos=0,e.addEvent(),e}return __extends(e,t),e.prototype.addEvent=function(){var t=this;this.list_.renderHandler=new Laya.Handler(this,this.renderHandler),this.list_.selectHandler=new Laya.Handler(this,this.selectHandler),this.btn_switch.on(Laya.Event.CLICK,this,this.onSwitch);for(var e=0;e<3;e++)this.t_item=this.getItemByIdx(e),this.t_item.on(Laya.Event.CLICK,this,function(e){t.setSelect(e)},[e])},e.prototype.onSwitch=function(){if(7<=this.p_targePos){var e=this.wVoArr[this.p_lIdx];if(o.RoleCenter.instans.vo.GOLD<e.replacegold[0][1])return void d.Switches.ins.event(u.enumAccessId.goldInsufficient);var t=new s.WingEquipTransformC2GS;t.wingEquipID_A=e.id,t.wingEquipID_B=r.GodWingStruct.Ins.getGodWingEquipVo(this.p_targePos,e.lv).id,i.GSM.sendServer(t)}else l.FE.upItems(c.TextConst.get(523),h.BubbleEnum.center)},e.prototype.renderPage=function(){this.lab_need.text="0",this.p_targePos=-1,this.initBag()},e.prototype.refreshData=function(){this.list_.selectedIndex=-1,this.cleanSelect(),this.renderPage()},e.prototype.selectHandler=function(e){if(this.cleanSelect(),!(e<0)){this.p_lIdx=e;var t=this.wVoArr[e];this.showIcon(this.item_select,t),this.lab_need.text=t.replacegold[0][1];for(var i=0,n=0;n<this.posArr.length;n++)if(t.pos!=this.posArr[n]){var s=r.GodWingStruct.Ins.getGodWingEquipVo(this.posArr[n],t.lv);this.t_item=this.getItemByIdx(i),this.t_item.name=this.posArr[n]+"",this.showIcon(this.t_item,s),i++}}},e.prototype.renderHandler=function(e,t){if(null!=e.dataSource){var i=e.dataSource;e.setBg(n.ItemUtils.getQualitybjByQualityId(i.quality)),e.setIcon(n.ItemUtils.getIconByIconId(i.icon)),e.setName(i.name,n.ItemUtils.getColorByQuality(i.quality)),e.setSelect(t==this.list_.selectedIndex)}},e.prototype.initBag=function(){var e=o.RoleCenter.instans.vo;for(var t in this.wVoArr=[],a.GameConfig.wingEquipJSON)if(a.GameConfig.wingEquipJSON.hasOwnProperty(t))for(var i=a.GameConfig.wingEquipJSON[t],n=e.bagdata.getWingEquipCount(i.id),s=0;s<n;s++)this.wVoArr.push(i);0<this.wVoArr.length?(this.list_.dataSource=this.wVoArr,this.lab_notHave.visible=!1):(this.list_.dataSource=[],this.lab_notHave.visible=!0)},e.prototype.setSelect=function(e){if(!(this.p_lIdx<0)){this.t_item=this.getItemByIdx(e),this.p_targePos=parseInt(this.t_item.name);for(var t=0;t<3;t++)this.t_item=this.getItemByIdx(t),this.t_item.setSelect(t==e),e==t&&(this.p_targePos=parseInt(this.t_item.name))}},e.prototype.cleanSelect=function(){this.p_lIdx=-1,this.item_select.setBg(n.ItemUtils.getQualitybjByQualityId(1)),this.item_select.setName(""),this.item_select.setIcon(""),this.item_select.setSelect(!1);for(var e=0;e<3;e++)this.t_item=this.getItemByIdx(e),this.t_item.setBg(n.ItemUtils.getQualitybjByQualityId(1)),this.t_item.setName(""),this.t_item.setIcon(""),this.t_item.setSelect(!1)},e.prototype.showIcon=function(e,t){e.setBg(n.ItemUtils.getQualitybjByQualityId(t.quality)),e.setName(t.name,n.ItemUtils.getColorByQuality(t.quality)),e.setIcon(n.ItemUtils.getIconByIconId(t.icon)),e.setSelect(!1)},e.prototype.getItemByIdx=function(e){return this["item_"+e]},e}(ui.role.GodWing.Page.GWSwitchPageUI);t.GodSwitchPage=g}),define("src/g/GodWing/Ctrl/GodWingSwitchCtrl",["require","exports","src/g/GodWing/View/GodSwitchPage","../../../init/ResManager"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.init=function(){this._view=new i.GodSwitchPage},e.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),this.refreshData(),e.addChild(this._view),n.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.changePerson=function(e){},e.prototype.refreshData=function(){this._view&&this._view.refreshData()},e.prototype.getTitle=function(){return""},e.prototype.hidePage=function(){n.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){n.ResManager.getInstance().destroyPageCtrl(this)},e}();t.GodWingSwitchCtrl=s}),define("src/g/GodWing/Ctrl/GGodWingCtrl",["require","exports","../../../utils/system/FloatEffect","../../../utils/ItemUtils","src/g/GodWing/View/GGodWingView","../../../enum/EventName","../../../core/E","src/g/GodWing/Ctrl/GodWingEquipCtrl","src/g/GodWing/Ctrl/GodWingCompCtrl","../../../manager/RoleCenter","../../net/messages/OpResultType","../../../vo/GodWingVo","../../net/messages/sbkEquipIns","../../../plugin/sbkPropTool","../../../vo/RedDot/role/RedDot_GodWing","../../../vo/RedDot/EventRedDot","../../../init/Switches","../../accessctrl/AccessCenter","../../proxy/MultiLevelUIProxy","src/g/GodWing/View/GodWingSkillDlg","../../../init/TextConst"],function(e,t,u,c,n,d,g,i,s,p,a,l,m,f,o,r,h,y,v,_,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(){function e(){this._pIdx=0,this._hIdx=0,h.Switches.ins.on(y.enumAccessId.shenyu_equipment,this,this.onOpenHandler,[y.enumAccessId.shenyu_equipment]),h.Switches.ins.on(y.enumAccessId.shenyu_compose,this,this.onOpenHandler,[y.enumAccessId.shenyu_compose]),h.Switches.ins.on(y.enumAccessId.shenyu_transform,this,this.onOpenHandler,[y.enumAccessId.shenyu_transform]),g.E.ins.on("popWindSkill",this,this.popWindSkill),g.E.ins.on(r.EventRedDot.REFRESH_GODWING,this,this.refreshRedDot)}return e.prototype.popWindSkill=function(e,t,i,n){var s=c.ItemUtils.getSkillDefItem(e),a=new _.GodWingSkillDlg;a.img_skillIcon.skin=c.ItemUtils.getSkillIconByIconId(s.icon);var o=s.name;a.lab_skillName.text=o,a.lab_lv.text="1",a.lab_desc.innerHTML=s.desc,a.lab_open.text=+n<=i?C.TextConst.get(524):C.TextConst.get(485),a.lab_need.text=C.TextConst.get(48,1==t?C.TextConst.get(137):C.TextConst.get(138),n),a.popup()},e.prototype.onOpenHandler=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=0),t&&this.onOpenGodWing(e,i,n)},e.prototype.init=function(){this._view=new n.GGodWingView,this._equip=new i.GodWingEquipCtrl,this._comp=new s.GodWingCompCtrl,this.refreshHeroHeadShow(this._pIdx),this.addEvent()},e.prototype.addEvent=function(){this._tabProxy=new v.MultiLevelUIProxy,this._tabProxy.registerTab(this._view.tab_page,0),this._tabProxy.registerTagIndex(y.enumAccessId.shenyu_equipment,0),this._tabProxy.registerTagIndex(y.enumAccessId.shenyu_compose,1),this._tabProxy.registerTagIndex(y.enumAccessId.shenyu_transform,2),this._tabProxy.selectHandler=new Laya.Handler(this,this.changePage),this._view.tab_head.setCallbackHandler(new Laya.Handler(this,this.changeHero)),this._view.bgView.btn_close.on(Laya.Event.CLICK,this,this.hideView),this._view.bgView.btn_back.on(Laya.Event.CLICK,this,this.hideView),g.E.ins.on(d.EventName.OPENNEW_HERO,this,this.refreshHeroHeadShow,[this._hIdx]),p.RoleCenter.instans.vo.heronum<3&&(g.E.ins.on(d.EventName.ADDED_LEVEL,this,this.refreshHeroHeadShow,[this._hIdx]),g.E.ins.on(d.EventName.ADDED_ZHUANSHENG,this,this.refreshHeroHeadShow,[this._hIdx]),g.E.ins.on(d.EventName.VIP_EXP_CHANGED,this,this.refreshHeroHeadShow,[this._hIdx])),p.RoleCenter.instans.on(a.enumOpResultType.WingEquip_rapidSynthesis+"",this,this.onRapidSynthesis),p.RoleCenter.instans.on(a.enumOpResultType.WingEquip_rapidUpLv+"",this,this.onRapidUpLv),p.RoleCenter.instans.on(a.enumOpResultType.WingEquip_equip+"",this,this.onEquip),p.RoleCenter.instans.on(a.enumOpResultType.WingEquipCompound+"",this,this.onCompound),p.RoleCenter.instans.on(a.enumOpResultType.WingEquipTransform+"",this,this.onTransform)},e.prototype.onRapidUpLv=function(e){var t=e.reservedata,i=p.RoleCenter.instans.vo,n=i.getOpenHeroByIdx(t[0]),s=n.heroWing,a=s.getWingEquipByPos(t[1]);a.lv=t[2];var o=l.GodWingStruct.Ins.getGodWingEquipVo(a.pos,a.lv).worth[0];i.delWingEquipIns(o[0],o[1]-1);var r=i.combat;f.sbkPropTool.resetAllWing(n),n.combat=n.reCheckComBat(),i.combat=i.reCheckComBat(),p.RoleCenter.instans.event(d.EventName.FIGHT_UP,i.combat-r),this.refreshData(),this._equip.playUpAni(),g.E.ins.event(d.EventName.CHANGEWINGEQUIP_COUNT),t[3]!=s.wingSuitLv&&(s.wingSuitLvUp(t[3],t[0]),g.E.ins.event(d.EventName.WING_UPSUITLV))},e.prototype.onRapidSynthesis=function(e){var t=e.reservedata,i=p.RoleCenter.instans.vo,n=i.getOpenHeroByIdx(t[0]),s=n.heroWing,a=s.getWingEquipByPos(t[1]),o=l.GodWingStruct.Ins.getGodWingEquipVo(a.pos,t[2]).worth[0];null!=c.ItemUtils.getItemVoById(o[0])?i.chgItemCount(o[0],-o[1]):i.delWingEquipIns(o[0],o[1]),a.lv=t[2];var r=i.combat;f.sbkPropTool.resetAllWing(n),i.combat=i.reCheckComBat(),p.RoleCenter.instans.event(d.EventName.FIGHT_UP,i.combat-r),this._equip.playCompAni(),this.refreshData(),t[3]!=s.wingSuitLv&&(s.wingSuitLvUp(t[3],t[0]),g.E.ins.event(d.EventName.WING_UPSUITLV))},e.prototype.onEquip=function(e){var t=e.reservedata,i=p.RoleCenter.instans.vo,n=i.getOpenHeroByIdx(t[0]),s=n.heroWing,a=s.getWingEquipByPos(t[1]);if(0!=t[2]){var o=c.ItemUtils.getGodWingVoById(t[2]),r=new m.sbkEquipIns;r.equid=t[3],r.equtemplet=t[2],u.FE.getFloat(o.name,c.ItemUtils.getColorByQuality(o.quality)),i.addWingEquipIns(r)}this._equip.playEquipByPos(t[1]);var l=c.ItemUtils.getGodWingVoById(t[4]);a.lv=l.lv,null!=l&&i.delWingEquipIns(l.id,1);var h=i.combat;f.sbkPropTool.resetAllWing(n),n.combat=n.reCheckComBat(),i.combat=i.reCheckComBat(),p.RoleCenter.instans.event(d.EventName.FIGHT_UP,i.combat-h),this.refreshData(),t[5]!=s.wingSuitLv&&(s.wingSuitLvUp(t[3],t[0]),g.E.ins.event(d.EventName.WING_UPSUITLV))},e.prototype.onCompound=function(e){var t=e.reservedata,i=p.RoleCenter.instans.vo,n=c.ItemUtils.getGodWingVoById(t[0]);1==n.lv?i.chgItemCount(n.worth[0][0],0-n.worth[0][1]):i.delWingEquipIns(parseInt(n.worth[0][0]),n.worth[0][1]);var s=new m.sbkEquipIns;s.equid=t[1],s.equtemplet=t[0];for(var a=0;a<n.prop.length;a++)s[n.prop[a][0]]=n.prop[a][1];u.FE.getFloat(n.name,c.ItemUtils.getColorByQuality(n.quality)),i.addWingEquipIns(s),this._comp.playCompAni(),this.refreshData()},e.prototype.onTransform=function(e){var t=e.reservedata,i=p.RoleCenter.instans.vo,n=c.ItemUtils.getGodWingVoById(t[0]),s=c.ItemUtils.getGodWingVoById(t[1]);i.GOLD-=n.replacegold[0][1],i.delWingEquipIns(t[0],1);var a=new m.sbkEquipIns;a.equid=t[2],a.equtemplet=t[1];for(var o=0;o<n.prop.length;o++)a[n.prop[o][0]]=n.prop[o][1];u.FE.getFloat(s.name,c.ItemUtils.getColorByQuality(s.quality)),i.addWingEquipIns(a),this.refreshData()},e.prototype.refreshHeroHeadShow=function(e){void 0===e&&(e=0),this._view.tab_head.initData(p.RoleCenter.instans.self.openhero,e,p.RoleCenter.instans.vo)},e.prototype.onOpenGodWing=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=0),this._view||(this._view=new n.GGodWingView,this.init()),this._view.bgView.btn_help.visible=!1,this._tabProxy.open(e),this.changeHero(i),this.refreshData(),this._view.showView(t)},e.prototype.refreshData=function(){null!=this._view&&(this._equip.refreshData(),this._comp.refreshData(),this.refreshRedDot(),this._view.red_equip.visible=o.RedDot_GodWing.Ins.getEquipAndComp(),this._view.red_comp.visible=o.RedDot_GodWing.Ins.getComp(),this.refreshHeroHeadShow(this._hIdx))},e.prototype.refreshRedDot=function(){this._view&&this._view.tab_head.refreshHeadRedHint(o.RedDot_GodWing.Ins.getEquipAndComp(!0))},e.prototype.changeHero=function(e){p.RoleCenter.instans.vo.heronum>e?(this._hIdx=e,this._comp.changePerson(e),this._equip.changePerson(e),this._view.tab_head.setSelectIndex(e)):h.Switches.ins.event(y.enumAccessId.partner)},e.prototype.changePage=function(e){switch(this._view.tab_head.visible=!1,e){case 0:this._page=this._equip,this._view.tab_head.visible=!0;break;case 1:this._page=this._comp}this._page.showPage(this._view.bgView.box_page),this._page.refreshData()},e.prototype.hideView=function(){this._view.hideView()},e}();t.GGodWingCtrl=w}),define("src/g/sandycitynight/view/SandyCityNightView",["require","exports","../../../manager/LayerManager","../../crossserboss/PointWarPlayer","../../../core/E","../../../enum/EventName","../../boss/view/SCFoeHead","../../../utils/ItemUtils","../../fight/osprite/SceneObjCtroller","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(){var e=t.call(this)||this;return e.width=Laya.stage.width,e.height=Laya.stage.height,e.mouseThrough=!0,e.foeIndexDict=new Laya.Dictionary,e.playerIndexDict=new Laya.Dictionary,e.attackTargetBox.visible=!1,e.initList(e.list_scoreRank,e.onRenderHandler,ui.sandycitynight.NightWarRankItemUI),e.initList(e.foeList,e.renderFoeItem,n.PointWarPlayer),e.initList(e.playerList,e.renderPlayer,n.PointWarPlayer),e.readyCD.visible=!1,e.initHtmlStyle(e.lbScoreInfo,"#ff7c07",18),e.initHtmlStyle(e.checkRank,"#09d51f",18),e.checkRank.innerHTML=h.TextConst.get(861),e}return __extends(e,t),e.prototype.initHtmlStyle=function(e,t,i){e.style.color=t,e.style.font="SimHei",e.style.fontSize=i,e.style.align="center"},e.prototype.initList=function(e,t,i){e.selectEnable=!0,e.vScrollBarSkin="",e.itemRender=i,e.scrollBar.elasticDistance=100,e.renderHandler=new Laya.Handler(this,t),e.array=[]},e.prototype.onRenderHandler=function(e,t){var i=e.dataSource;if(i){switch(t){case 0:e.imgRank.skin="res/custom/tongtianta_1jin.png",e.lbName.color=e.lbScore.color="#e1a32a";break;case 1:e.imgRank.skin="res/custom/tongtianta_2yin.png",e.lbName.color=e.lbScore.color="#aaa8b6";break;case 2:e.imgRank.skin="res/custom/tongtianta_3tong.png",e.lbName.color=e.lbScore.color="#c98858"}e.imgBGround.skin=t%2==0?"res/nightwar/sc_rank_itembg0.png":"res/nightwar/sc_rank_itembg1.png",e.lbName.text=i.nickName,e.lbScore.text=i.score.toString()}},e.prototype.renderFoeItem=function(e,t){e.on(Laya.Event.CLICK,this,this.attFoeHander),e.update2("left"),e.showAttackerEf()},e.prototype.attFoeHander=function(e){var t=e.currentTarget,i=this.foeIndexDict.get(t.dataSource);s.E.ins.event(a.EventName.SELECT_REVENGE_TARGET_INDEX,i)},e.prototype.renderPlayer=function(e,t){e.on(Laya.Event.CLICK,this,this.attplayerHander),e.update2("right")},e.prototype.attplayerHander=function(e){var t=e.currentTarget,i=this.playerIndexDict.get(t.dataSource);s.E.ins.event(a.EventName.SELECT_TARGET_INDEX,i)},e.prototype.updFoeListDisplay=function(e){var t=this.deleteEmptyData(e,this.foeIndexDict,!1);this.foeList.array=t,this.caculateListH(this.foeList,4),this.imgAttack.visible=t&&0!=t.length},e.prototype.caculateListH=function(e,t){if(null==e.array||0==e.array.length)e.height=0;else{var i=Math.min(t,e.array.length),n=90*i+(i-1)*e.spaceY;e.height=n}},e.prototype.updPlayerListDisplay=function(e){var t=this.deleteEmptyData(e,this.playerIndexDict,!0);this.playerList.array=t,this.caculateListH(this.playerList,4),this.imgPlayer.visible=t&&0!=t.length},e.prototype.deleteEmptyData=function(e,t,i){t.clear();var n=l.SceneObjCtroller.ins.getSelfGroup().campId,s=[];if(e)for(var a=e.length,o=void 0,r=0;r<a;r++)null!=(o=e[r])&&(i&&(0!=o.isInSafeArea||o.isDeath())||o.campId!=n&&(s.push(o),t.set(o,r)));return s},e.prototype.clearAttackSign=function(){this.clearListAttackSign(this.foeList),this.clearListAttackSign(this.playerList)},e.prototype.clearListAttackSign=function(e){for(var t=0;t<e.cells.length;t++)e.cells[t].reset()},e.prototype.showAttackSignInList=function(e,t){for(var i,n=0;n<e.cells.length;n++)(i=e.cells[n]).getName()==t&&i.updStatus(o.SCFoeHead.BE_ATTACK)},e.prototype.changeAttackTarget=function(e){this.clearAttackSign(),null==e||""==e?(this.attackTargetBox.visible=!1,this.attackTarget=null,this.stopUpdAttackTargetHp()):(this.showAttackSignInList(this.foeList,e),this.showAttackSignInList(this.playerList,e),this.attackTarget=this.checkAttackTarget(e),this.onFightWithFoe())},e.prototype.onFightWithFoe=function(){if(this.attackTarget){this.attackTargetBox.visible=!0;var e=this.attackTarget.getUnitByIndex(0);this.targetFoeName.text=e.actorName,this.imgTargetFoeHead.skin=r.ItemUtils.getHeadurlYuan(e.sex,e.job),Laya.timer.loop(50,this,this.updAttackTargetHp)}},e.prototype.checkAttackTarget=function(e){for(var t,i=this.playerList.array.length,n=0;n<i;n++)if((t=this.playerList.array[n]).groupID==e)return t;return null},e.prototype.stopUpdAttackTargetHp=function(){Laya.timer.clear(this,this.updAttackTargetHp)},e.prototype.updAttackTargetHp=function(){if(this.attackTarget){var e=this.attackTarget.getHp(),t=this.attackTarget.getTotalHp(),i=Math.min(380*e/t>>0,380);this.progressBar.width=i,this.progress_txt.text=(e/t*100).toFixed(2)+"%"}},e.prototype.setRankData=function(e){this.list_scoreRank.array=e},e.prototype.updateBuffInfo=function(e,t){this.label_att.text=e.toString()+"%",this.label_def.text=t.toString()+"%"},e.prototype.showView=function(){i.LayerManager.addInUILayer(this)},e.prototype.updRewardScore=function(e,t){if(0!=t){var i=t<=e?"#09d51f":"#ff0000";this.imgRed.visible=t<=e,this.lbScoreInfo.innerHTML=h.TextConst.get(869,i,e,t)}this.label_personScore.text=h.TextConst.get(566,e)},e}(ui.sandycitynight.SandyCityMainViewUI);t.SandyCityNightView=u;var c=function(){this.familyname="",this.rankIdx=0};t.SCNRankItemData=c}),define("src/g/sandycitynight/view/NightWarResult",["require","exports","../../account/view/AccItem"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.initList(e.rewardList,e.rewardRender,i.AccItem),e.initList(e.rankList,e.rankItemRender,ui.sandycitynight.NWarResultRankItemUI),e}return __extends(e,t),e.prototype.initList=function(e,t,i){e.itemRender=i,e.selectEnable=!0,e.vScrollBarSkin="",e.scrollBar.elasticDistance=100,e.renderHandler=new Laya.Handler(this,t),e.array=[]},e.prototype.rewardRender=function(e,t){e.eqData=this.rewardList.array[t],e.lv_txt.text=""},e.prototype.rankItemRender=function(e,t){var i=e.dataSource;e.lbRank.text=i.rankIdx.toString(),e.lbName.text=i.nickname.toString(),e.lbFamilyName.text=i.familyname.toString(),e.lbScore.text=i.scorenum.toString()},e.prototype.showView=function(){this.popup(),this.img_bg.rotation=0,Laya.timer.loop(120,this,this.updEffectDisplay)},e.prototype.updEffectDisplay=function(){this.img_bg.rotation+=10,console.log("计算还在转圈")},e.prototype.destroyView=function(){this.destroy(!0)},e}(ui.sandycitynight.NightWarResultUI);t.NightWarResult=n}),define("src/g/sandycitynight/ctrl/NightWarResultCtrl",["require","exports","src/g/sandycitynight/view/NightWarResult","../../../utils/CountDown","../../../utils/SoundUtils","../../../utils/system/ServerTime","../../../utils/ItemDropUtil","../../../meta/CommonVo","../../../init/TextConst"],function(e,t,n,i,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(){this.countDown=new i.CountDown}return e.prototype.showResult=function(e){if(null==this.view){this.view=new n.NightWarResult,this.view.closeHandler=Laya.Handler.create(this,this.destoryView);var t=r.CommonVo.getVoByKey("jiesuandaojishi"),i=null!=t?Number(t.value):5;0<i&&this.countDown.start(a.ServerTime.serverTime+i,this.updCountDownHander,this),this.view.showView(),this.view.myScore.text=e.myScore.scorenum.toString(),this.view.myRank.text=e.myScore.rankIdx.toString(),this.view.rewardList.array=o.ItemDropUtil.createRewardList(e.reward),this.view.rankList.array=e.topFive.sort(this.sortByRank)}},e.prototype.sortByRank=function(e,t){return e.rankIdx-t.rankIdx},e.prototype.updCountDownHander=function(e){this.view.getChildByName("close").label=l.TextConst.get(243,e),0==e&&this.view.close()},e.prototype.destoryView=function(){s.SoundUtils.getInstance().playBtnsounds(),this.countDown.stop(),Laya.loader.clearRes("res/jiesuan/YZ_jiesuanbiaoti.png"),this.view&&(this.view.closeHandler=null,this.view.destroyView(),this.view=null)},e}();t.NightWarResultCtrl=h}),define("src/g/sandycitynight/view/NightWarRank",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.bg.btn_help.visible=!1,e}return __extends(e,t),e.prototype.showView=function(){this.centerX=this.centerY=0,i.LayerManager.addInPOPWindow(this)},e.prototype.hideView=function(){},e.prototype.destroyView=function(){this.removeSelf(),this.destroy()},e}(ui.sandycitynight.NightWarRankUI);t.NightWarRank=n}),define("src/g/sandycitynight/view/NightWarRankPanel",["require","exports","../../../init/TextConst"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.initList(e.rankList,ui.sandycitynight.NightWarRankItem2UI,new Laya.Handler(e,e.renderHander)),e}return __extends(e,t),e.prototype.initList=function(e,t,i){e.itemRender=t,e.vScrollBarSkin="",e.scrollBar.elasticDistance=100,e.renderHandler=i,e.array=[]},e.prototype.renderHander=function(e,t){var i=e.dataSource;if(i.rankIdx<4){switch(e.imgRank.visible=!0,e.lbRank.visible=!1,i.rankIdx){case 1:e.imgRank.skin="res/nightwarreward/YZ_paihangtubiao_001.png",e.imgGround1.skin=e.imgGround2.skin="res/nightwarreward/YZ_paihang_001.png";break;case 2:e.imgRank.skin="res/nightwarreward/YZ_paihangtubiao_002.png",e.imgGround1.skin=e.imgGround2.skin="res/nightwarreward/YZ_paihang_002.png";break;case 3:e.imgRank.skin="res/nightwarreward/YZ_paihangtubiao_003.png",e.imgGround1.skin=e.imgGround2.skin="res/nightwarreward/YZ_paihang_003.png"}e.lbName.color=e.lbFamily.color="#dad2b9"}else e.imgRank.visible=!1,e.lbRank.visible=!0,e.lbName.color=e.lbFamily.color="#a89e8f",e.imgGround1.skin=e.imgGround2.skin="res/nightwarreward/YZ_paihang_004.png",e.lbRank.text=i.rankIdx.toString();e.lbName.text=i.nickName,e.lbFamily.text=""==i.familyname?n.TextConst.get(358):i.familyname,e.lbScore.text=i.score.toString()},e}(ui.sandycitynight.NightWarRankPanelUI);t.NightWarRankPanel=i}),define("src/g/sandycitynight/view/NightRankRewardItem",["require","exports","../../account/view/AccItem","../../../utils/ItemDropUtil"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.initList(e.rewardList,i.AccItem,new Laya.Handler(e,e.rewardItemRender)),e}return __extends(e,t),e.prototype.initList=function(e,t,i){e.itemRender=t,e.vScrollBarSkin="",e.scrollBar.elasticDistance=0,e.renderHandler=i,e.array=[]},e.prototype.rewardItemRender=function(e,t){e.eqData=e.dataSource,e.lv_txt.text=""},e.prototype.update=function(){var e=this.dataSource;if(e.ID<4)switch(this.imgRank.visible=!0,this.lbRank.visible=!1,e.ID){case 1:this.imgRank.skin="res/nightwarreward/YZ_paihangtubiao_001.png",this.imgGround1.skin=this.imgGround2.skin="res/nightwarreward/YZ_paihang_001.png";break;case 2:this.imgRank.skin="res/nightwarreward/YZ_paihangtubiao_002.png",this.imgGround1.skin=this.imgGround2.skin="res/nightwarreward/YZ_paihang_002.png";break;case 3:this.imgRank.skin="res/nightwarreward/YZ_paihangtubiao_003.png",this.imgGround1.skin=this.imgGround2.skin="res/nightwarreward/YZ_paihang_003.png"}else this.imgRank.visible=!1,this.lbRank.visible=!0,this.imgGround1.skin=this.imgGround2.skin="res/nightwarreward/YZ_paihang_004.png",this.lbRank.text=e.ID.toString();this.rewardList.array=n.ItemDropUtil.createPortRewardData(e.item,!0)},e}(ui.sandycitynight.NightRankRewardItemUI);t.NightRankRewardItem=s}),define("src/g/sandycitynight/view/NightScoreRewardItem",["require","exports","../../account/view/AccItem","../../../utils/ItemDropUtil","../../../init/TextConst"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function e(){var e=t.call(this)||this;return e.reward=new i.AccItem,e.reward.scaleY=e.reward.scaleX=.9,e.addChildAt(e.reward,0),e}return __extends(e,t),e.prototype.update=function(){var e=this.dataSource;this.lbScore.text=s.TextConst.get(28,e.value);var t=n.ItemDropUtil.createPortRewardData(e.item,!0)[0];this.reward.eqData=t,this.reward.lv_txt.text=""},e}(ui.sandycitynight.NightScoreRewardItemUI);t.NightScoreRewardItem=a}),define("src/g/sandycitynight/view/NightWarReward",["require","exports","src/g/sandycitynight/view/NightRankRewardItem","src/g/sandycitynight/view/NightScoreRewardItem","../../fight/osprite/play/sandynight/SandyNightManager","../../../config/GameConfig"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.initList(e.rewardList,i.NightRankRewardItem,new Laya.Handler(e,e.rankRewardRender)),e.initList(e.scoreRewardList,n.NightScoreRewardItem,new Laya.Handler(e,e.scoreRewardRender)),e.rewardList.array=e.createRankReward(),e.scoreRewardList.scrollBar.elasticDistance=0,e.scoreRewardList.array=s.SandyNightManager.getInstance().getScoreRewardVo(),e}return __extends(e,t),e.prototype.initList=function(e,t,i){e.itemRender=t,e.vScrollBarSkin="",e.scrollBar.elasticDistance=100,e.renderHandler=i,e.array=[]},e.prototype.createRankReward=function(){var e=[],t=null;for(var i in a.GameConfig.nightCityRankVo)1==(t=a.GameConfig.nightCityRankVo[i]).type&&e.push(t);return e},e.prototype.rankRewardRender=function(e,t){e.update()},e.prototype.scoreRewardRender=function(e,t){e.update()},e}(ui.sandycitynight.NightWarRewardUI);t.NightWarReward=o}),define("src/g/sandycitynight/ctrl/NightWarRankCtrl",["require","exports","../../base/BaseCtrl","src/g/sandycitynight/view/NightWarRank","src/g/sandycitynight/view/NightWarRankPanel","src/g/sandycitynight/view/NightWarReward","../../net/messages/SandyNightMsg","../../../manager/GameSocketManager"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function e(){var e=t.call(this)||this;return e.isOpened=!1,e.url="res/atlas/res/nightwarreward.json",e}return __extends(e,t),e.prototype.openView=function(){this.isOpened=!0,this.open()},e.prototype.onAtlasLoaded=function(){0!=this.isOpened?null==this.view&&(this.view=new n.NightWarRank,this.view.showView(),this.view.bg.btn_back.on(Laya.Event.CLICK,this,this.closeWindow),this.view.bg.btn_close.on(Laya.Event.CLICK,this,this.closeWindow),this.view.tab.selectHandler=new Laya.Handler(this,this.selectHander),this.view.tab.selectedIndex=0):this.clearCtrlRes()},e.prototype.selectHander=function(e){switch(e){case 0:this.rewardView&&this.rewardView.removeSelf(),this.showRank();break;case 1:this.rankView&&this.rankView.removeSelf(),this.showReward()}},e.prototype.showRank=function(){if(null==this.rankView){this.rankView=new s.NightWarRankPanel,this.rankView.y=134,this.rankView.centerX=0;var e=new o.GetScoreRankC2GS;r.GSM.sendServer(e)}this.view.bg.img_title.skin="res/nightwarreward/YZ_biaotizi_002.png",this.view.addChild(this.rankView)},e.prototype.showReward=function(){null==this.rewardView&&(this.rewardView=new a.NightWarReward,this.rewardView.y=134,this.rewardView.centerX=0),this.view.bg.img_title.skin="res/nightwarreward/YZ_biaotizi_001.png",this.view.addChild(this.rewardView)},e.prototype.closeWindow=function(){this.isOpened=!1,this.view&&(this.rankView&&(this.rankView.removeSelf(),this.rankView.destroy(),this.rankView=null),this.rewardView&&(this.rewardView.removeSelf(),this.rewardView.destroy(!0),this.rewardView=null),this.view.bg.btn_back.off(Laya.Event.CLICK,this,this.closeWindow),this.view.bg.btn_close.off(Laya.Event.CLICK,this,this.closeWindow),this.view.tab.selectHandler=null,this.view.destroyView(),this.view=null,this.clearCtrlRes())},e.prototype.onReceivedTotalRank=function(e){this.rankView&&(this.rankView.rankList.array=e)},e}(i.BaseCtrl);t.NightWarRankCtrl=l}),define("src/g/sandycitynight/ctrl/SandyCityNightCtrl",["require","exports","../../../core/E","../../../enum/EventName","src/g/sandycitynight/view/SandyCityNightView","../../fight/osprite/play/sandynight/SandyNightManager","../../base/BaseCtrl","../../../utils/CountDown","../../../utils/system/DateUitl","../../../utils/system/ServerTime","../../../config/GameConfig","src/g/sandycitynight/ctrl/NightWarResultCtrl","../../worldboss/ctrl/Death","src/g/sandycitynight/ctrl/NightWarRankCtrl","../../../manager/FlyManager","../../../utils/ItemUtils"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){function e(){var e=t.call(this)||this;return e._score=0,e._view=null,e.isOpened=!1,e._foeList=null,e._playerList=null,e._attackTarget=null,e.readyCD=new r.CountDown,e.url="res/atlas/res/nightwar.json",e.resultCtrl=new c.NightWarResultCtrl,e.rankCtrl=new g.NightWarRankCtrl,e}return __extends(e,t),e.prototype.init=function(){i.E.ins.on(n.EventName.SANDYCITYNIGHT_SCENE_PANEL,this,this.showView)},e.prototype.showView=function(e){this.isOpened=!0,this._score=0,(a.SandyNightManager.getInstance().viewCtrl=this).open(),i.E.ins.on(n.EventName.UPDATE_REVENGE_VIEW_TARGET,this,this.updateFoeListHandler),i.E.ins.on(n.EventName.UPDATE_VIEW_TARGET,this,this.updPlayerListHander),i.E.ins.on(n.EventName.CHANGE_PK_TARGET,this,this.attackTargetChangedHander)},e.prototype.onAtlasLoaded=function(){if(0!=this.isOpened){if(null==this._view&&(this._view=new s.SandyCityNightView,this._view.showView()),this.updatePersonScore(this._score),this.updateFoeListHandler(this._foeList),this.updPlayerListHander(this._playerList),this.attackTargetChangedHander(this._attackTarget),this._view.scoreRewardBox.on(Laya.Event.CLICK,this,this.getRewardHander),this._view.checkRank.on(Laya.Event.CLICK,this,this.checkRankHander),0==a.SandyNightManager.getInstance().getLevel()){var e=a.SandyNightManager.getInstance().getLevelLeftTime();this.startReadyCd(e),this._view.campBox.visible=this._view.gameCDBox.visible=!1}else{this.warAlreadyStart();e=a.SandyNightManager.getInstance().getLevelLeftTime();this.updChangeCampNoticeStatus(e)}this.updScoreRewardStatus()}else this.clearCtrlRes()},e.prototype.onCampChanged=function(){this._view&&(0==this._view.gameCDBox.visible&&(this._view.gameCDBox.visible=!0),this.stopReadyCD(),this.updCampBoxVisible())},e.prototype.warAlreadyStart=function(){this._view.gameCDBox.visible=!0,this.updCampBoxVisible()},e.prototype.updCampBoxVisible=function(){var e=u.GameConfig.nightCitySettingVo.changeTime,t=u.GameConfig.nightCitySettingVo.lastTime;a.SandyNightManager.getInstance().getLevel()>=t.value/e.value?this._view.campBox.visible=!1:this._view.campBox.visible=!0},e.prototype.exit=function(){this.isOpened=!1,this._view&&(this.stopReadyCD(),this._view.scoreRewardBox.off(Laya.Event.CLICK,this,this.getRewardHander),this._view.checkRank.off(Laya.Event.CLICK,this,this.checkRankHander),this._view.removeSelf(),this._view.destroy(!0),this._view=null),this.closeDeath(),this.death=null,this.clearCtrlRes(),a.SandyNightManager.getInstance().viewCtrl=null,i.E.ins.off(n.EventName.UPDATE_REVENGE_VIEW_TARGET,this,this.updateFoeListHandler),i.E.ins.off(n.EventName.UPDATE_VIEW_TARGET,this,this.updPlayerListHander),i.E.ins.off(n.EventName.CHANGE_PK_TARGET,this,this.attackTargetChangedHander)},e.prototype.updateActionTime=function(e){this._view&&(this._view.label_actionTime.text=l.DateUtil.timeCountDown1(e))},e.prototype.updateLevelTime=function(e){this._view&&(this._view.label_levelTime.text=l.DateUtil.timeCountDown1(e),this.updChangeCampNoticeStatus(e))},e.prototype.updChangeCampNoticeStatus=function(e){if(e<=u.GameConfig.nightCitySettingVo.changeNotice.value&&0==this._view.readyCD.visible){var t=u.GameConfig.nightCitySettingVo.changeTime;a.SandyNightManager.getInstance().getActionLeftTime()>t.value&&this.startReadyCd(e)}},e.prototype.updatePersonScore=function(e){this._score=e,this._view&&(a.SandyNightManager.getInstance().isGetAllScoreReward()?this._view.updRewardScore(this._score,0):this._view.updRewardScore(this._score,a.SandyNightManager.getInstance().nextLevelRewardNeedScore()))},e.prototype.updateRankData=function(e){if(this._view){var t=e.concat();3<t.length&&t.splice(3),this._view.setRankData(t)}},e.prototype.updateBuffInfo=function(e,t){this._view&&this._view.updateBuffInfo(e,t)},e.prototype.updateFoeListHandler=function(e){this._foeList=e,this._view&&this._view.updFoeListDisplay(e)},e.prototype.updPlayerListHander=function(e){this._playerList=e,this._view&&this._view.updPlayerListDisplay(e)},e.prototype.attackTargetChangedHander=function(e){this._attackTarget=e,this._view&&this._view.changeAttackTarget(e)},e.prototype.startReadyCd=function(e){this._view.readyCD.visible=!0,this.readyCD.start(e+h.ServerTime.serverTime,this.updCdHander,this)},e.prototype.updCdHander=function(e){0<=e&&(this._view.imgReadyCD.value=e.toString())},e.prototype.stopReadyCD=function(){this._view.readyCD.visible=!1,this.readyCD.stop()},e.prototype.getRewardHander=function(){a.SandyNightManager.getInstance().reqScoreBouns()},e.prototype.onGetRewardSuc=function(e){var t=a.SandyNightManager.getInstance().getScoreRewardSeting(e).item[0][0],i=new Laya.Point(this._view.scoreRewardBox.x,this._view.scoreRewardBox.y);p.FlyManager.ins.flyIconToBag(m.ItemUtils.getIconById(t),i),this.updatePersonScore(this._score),this.updScoreRewardStatus()},e.prototype.onWarEnd=function(e){this.resultCtrl.showResult(e)},e.prototype.onDeath=function(e,t){null==this.death&&(this.death=new d.Death),this._view&&this._view.addChild(this.death),this.death.centerX=0,this.death.bottom=360;var i=e.getUnitByIndex(0).actorName,n=u.GameConfig.nightCitySettingVo.buyRebornCdCost,s=n.value,a=(n=u.GameConfig.nightCitySettingVo.rebornCd).value;this.death.start(i,t,a,s)},e.prototype.onFuHuo=function(){this.closeDeath()},e.prototype.closeDeath=function(){this.death&&this.death.close()},e.prototype.checkRankHander=function(){this.rankCtrl.openView()},e.prototype.updScoreRewardStatus=function(){if(this._view){var e=a.SandyNightManager.getInstance().isGetAllScoreReward();this._view.scoreRewardBox.visible=!e}},e.prototype.onReceivedTotalRank=function(e){this.rankCtrl.onReceivedTotalRank(e)},e}(o.BaseCtrl);t.SandyCityNightCtrl=f}),define("src/g/pointwar/view/PointWar",["require","exports","../../crossserboss/PointWarPlayer","../../boss/view/SCFoeHead","../../../manager/LayerManager","../../../core/E","../../../enum/EventName","../../fight/osprite/play/HangUpExpManager","../../../utils/ItemUtils","../../../config/GameConfig","../../../init/TextConst"],function(e,t,i,s,n,a,o,r,l,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){function e(){var e=t.call(this)||this;return e.width=Laya.stage.width,e.height=Laya.stage.height,e.mouseThrough=!0,e.attackTargetBox.visible=!1,e.foeIndexDict=new Laya.Dictionary,e.playerIndexDict=new Laya.Dictionary,e.initList(e.foeList,e.renderFoeItem,null,i.PointWarPlayer),e.initList(e.playerList,e.renderPlayer,null,i.PointWarPlayer),e.initList(e.areaList,e.renderAreaItem,null,ui.pointwar.PointWarAreaItemUI,e.selectAreaHander),e.areaInBox.visible=!1,e.areaButton.on(Laya.Event.CLICK,e,e.showAreainfo),e}return __extends(e,t),e.prototype.initList=function(e,t,i,n,s){e.itemRender=n,e.mouseEnabled=!0,e.selectEnable=!0,e.vScrollBarSkin="",e.scrollBar.elasticDistance=0,e.renderHandler=new Laya.Handler(this,t),null!=i&&(e.mouseHandler=new Laya.Handler(this,i)),null!=s&&(e.selectHandler=new Laya.Handler(this,s)),e.array=[]},e.prototype.renderFoeItem=function(e,t){e.on(Laya.Event.CLICK,this,this.attFoeHander),e.update2("left"),e.showAttackerEf()},e.prototype.renderPlayer=function(e,t){e.on(Laya.Event.CLICK,this,this.attplayerHander),e.update2("right")},e.prototype.updFoeListDisplay=function(e){var t=this.deleteEmptyData(e,this.foeIndexDict,!1);this.foeList.array=t,this.caculateListH(this.foeList,4),this.imgAttack.visible=t&&0!=t.length},e.prototype.updPlayerListDisplay=function(e){var t=this.deleteEmptyData(e,this.playerIndexDict,!0);this.playerList.array=t,this.caculateListH(this.playerList,4),this.imgPlayer.visible=t&&0!=t.length},e.prototype.caculateListH=function(e,t){if(null==e.array||0==e.array.length)e.height=0;else{var i=Math.min(t,e.array.length),n=90*i+(i-1)*e.spaceY;e.height=n}},e.prototype.deleteEmptyData=function(e,t,i){t.clear();var n=[];if(e)for(var s=e.length,a=void 0,o=0;o<s;o++)null!=(a=e[o])&&(i&&(0!=a.isInSafeArea||a.isDeath())||(n.push(a),t.set(a,o)));return n},e.prototype.attplayerHander=function(e){var t=e.currentTarget,i=this.playerIndexDict.get(t.dataSource);a.E.ins.event(o.EventName.SELECT_TARGET_INDEX,i)},e.prototype.attFoeHander=function(e){var t=e.currentTarget,i=this.foeIndexDict.get(t.dataSource);a.E.ins.event(o.EventName.SELECT_REVENGE_TARGET_INDEX,i)},e.prototype.showView=function(){this.imgAttack.visible=this.imgPlayer.visible=!1,n.LayerManager.addInUILayer(this),Laya.stage.on(Laya.Event.CLICK,this,this.closeAreaInfo)},e.prototype.clearAttackSign=function(){this.clearListAttackSign(this.foeList),this.clearListAttackSign(this.playerList)},e.prototype.clearListAttackSign=function(e){for(var t=0;t<e.cells.length;t++)e.cells[t].reset()},e.prototype.showAttackSignInList=function(e,t){for(var i,n=0;n<e.cells.length;n++)(i=e.cells[n]).getName()==t&&i.updStatus(s.SCFoeHead.BE_ATTACK)},e.prototype.renderAreaItem=function(e,t){var i=e.dataSource;e.imgGround.skin="res/pointwar/paodian_"+i.areIndex+"beiqu"+(this.areaList.selectedIndex==t?2:1)+".png",null==i.owner||""==i.owner?(e.lbFamily.visible=e.lbName.visible=!1,e.lbNoOwner.visible=!0):(e.lbFamily.visible=e.lbName.visible=!0,e.lbNoOwner.visible=!1,e.lbFamily.text=i.ownerFamily,e.lbName.text=i.owner)},e.prototype.selectAreaHander=function(e){if(-1!=e){var t=this.areaList.getItem(e);r.HangUpExpManager.getInstance().capturePointArea(t.areIndex,t.index)}},e.prototype.updAreaList=function(e){this.areaList.array=e},e.prototype.changeAttackTarget=function(e){this.clearAttackSign(),null==e||""==e?(this.attackTargetBox.visible=!1,this.attackTarget=null,this.stopUpdAttackTargetHp()):(this.showAttackSignInList(this.foeList,e),this.showAttackSignInList(this.playerList,e),this.attackTarget=this.checkAttackTarget(e),this.onFightWithFoe())},e.prototype.onFightWithFoe=function(){if(this.attackTarget){this.attackTargetBox.visible=!0;var e=this.attackTarget.getUnitByIndex(0);this.targetFoeName.text=e.actorName,this.imgTargetFoeHead.skin=l.ItemUtils.getHeadurlYuan(e.sex,e.job),Laya.timer.loop(50,this,this.updAttackTargetHp)}},e.prototype.checkAttackTarget=function(e){for(var t,i=this.playerList.array.length,n=0;n<i;n++)if((t=this.playerList.array[n]).groupID==e)return t;return null},e.prototype.stopUpdAttackTargetHp=function(){Laya.timer.clear(this,this.updAttackTargetHp)},e.prototype.updAttackTargetHp=function(){if(this.attackTarget){var e=this.attackTarget.getHp(),t=this.attackTarget.getTotalHp(),i=Math.min(380*e/t>>0,380);this.progressBar.width=i,this.progress_txt.text=(e/t*100).toFixed(2)+"%"}},e.prototype.showAreainfo=function(e){this.areaInBox.visible=!0;var t=r.HangUpExpManager.getInstance().selfAreaLevel,i=r.HangUpExpManager.getInstance().getAwardSetting(t);this.lbCrtArea.color=this.lbAreaTotalXiaolv.color=this.lbAreaXiaolv.color="#"+i.color,this.lbCrtArea.text=u.TextConst.get(39,i.times);var n=h.GameConfig.pointSettingVo[1],s=10*i.reward[0][1],a=10*i.reward[1][1];this.lbAreaXiaolv.text=u.TextConst.get(881,s,n.sendAwardSec,a,n.sendAwardSec),this.updateAreaInfo(),e.stopPropagation()},e.prototype.updateAreaInfo=function(){var e=r.HangUpExpManager.getInstance().totalExp,t=r.HangUpExpManager.getInstance().totalJungong;this.lbAreaTotalXiaolv.text=u.TextConst.get(880,e,t)},e.prototype.closeAreaInfo=function(){this.areaInBox.visible=!1},e.prototype.clearSelectedArea=function(){this.areaList.selectedIndex=-1},e.prototype.hideView=function(){Laya.stage.off(Laya.Event.CLICK,this,this.closeAreaInfo),this.stopUpdAttackTargetHp(),this.removeSelf(),this.destroy(!0)},e}(ui.pointwar.PointWarUI);t.PointWar=c}),define("src/g/pointwar/ctrl/PointWarCtrl",["require","exports","../../../core/E","../../../enum/EventName","src/g/pointwar/view/PointWar","../../fight/osprite/play/HangUpExpManager","../../../utils/system/DateUitl","../../base/BaseCtrl","../../../config/GameConfig","../../../manager/RoleCenter","../../../init/Switches","../../accessctrl/AccessCenter","../../worldboss/ctrl/Death","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){function e(){var e=t.call(this)||this;return e._areaItmeList=[],e._foeList=null,e._playerList=null,e._attackTarget=null,e._leftTime=0,e._areaLevel=1,e.opened=!1,e.url="res/atlas/res/pointwar.json",i.E.ins.on(n.EventName.OPEN_POINT_WAR_UI,e,e.openView),e}return __extends(e,t),e.prototype.openView=function(){this.opened=!0,i.E.ins.on(n.EventName.UPDATE_REVENGE_VIEW_TARGET,this,this.updateFoeListHandler),i.E.ins.on(n.EventName.UPDATE_VIEW_TARGET,this,this.updPlayerListHander),i.E.ins.on(n.EventName.CHANGE_PK_TARGET,this,this.attackTargetChangedHander),(a.HangUpExpManager.getInstance().viewCtrl=this).initUIData(),this.open()},e.prototype.onAtlasLoaded=function(){0!=this.opened?(null==this.view&&(this.view=new s.PointWar),this.view.showView(),this.initUI()):this.clearCtrlRes()},e.prototype.initUIData=function(){for(var e=0;e<5;e++){var t={};t.ownerFamily=t.owner="",t.index=2==e?(t.areIndex=5,0):(t.areIndex=3,e<2?e:e-1),this._areaItmeList[e]=t}},e.prototype.initUI=function(){this.view.updAreaList(this._areaItmeList),this.updateFoeListHandler(this._foeList),this.updPlayerListHander(this._playerList),this.attackTargetChangedHander(this._attackTarget),this.updateTime(this._leftTime),this.updateAreaLevel(this._areaLevel)},e.prototype.updateAreaData=function(e,t,i,n){var s=-1;switch(e){case 3:2<=(s=t)&&(s+=1);break;case 5:s=2;break;default:return}if(s<this._areaItmeList.length){var a=this._areaItmeList[s];a.owner=i,a.ownerFamily=n}this.view&&this.view.updAreaList(this._areaItmeList)},e.prototype.updateFoeListHandler=function(e){this._foeList=e,this.view&&this.view.updFoeListDisplay(e)},e.prototype.updPlayerListHander=function(e){this._playerList=e,this.view&&this.view.updPlayerListDisplay(e)},e.prototype.attackTargetChangedHander=function(e){this._attackTarget=e,this.view&&this.view.changeAttackTarget(e)},e.prototype.updateTime=function(e){this._leftTime=e,this.view&&(this.view.lbCountDown.text=o.DateUtil.getMinStr1(e))},e.prototype.updateAreaLevel=function(e){this._areaLevel=1,this.view&&(this.view.imgAreaFont.skin="res/pointwar/paodian_"+e.toString()+"qu.png",this.view.closeAreaInfo())},e.prototype.updateAreaInfo=function(){this.view&&this.view.updateAreaInfo()},e.prototype.clearSelectedArea=function(){this.view&&this.view.clearSelectedArea()},e.prototype.onDeath=function(e,t){if(this.view){this.fuhuoHander=t,null==this.death&&(this.death=new d.Death(g.TextConst.get(882))),this.view.addChild(this.death),this.death.centerX=0,this.death.bottom=370;var i=l.GameConfig.pointSettingVo[1];this.death.start(e.getUnitByIndex(0).actorName,Laya.Handler.create(this,this.useYuanBaoFuHuo),a.HangUpExpManager.getInstance().getSetting().rebornCd,i.buyRebornCdCost)}},e.prototype.useYuanBaoFuHuo=function(){if(this.fuhuoHander){var e=l.GameConfig.pointSettingVo[1].buyRebornCdCost;if(h.RoleCenter.instans.self.GOLD<e)return void u.Switches.ins.event(c.enumAccessId.goldInsufficient);this.fuhuoHander.run(),this.fuhuoHander=null}},e.prototype.onFuhuoSuc=function(){this.closeDeath()},e.prototype.closeDeath=function(){this.death&&this.death.close()},e.prototype.close=function(){this.opened=!1,i.E.ins.off(n.EventName.UPDATE_REVENGE_VIEW_TARGET,this,this.updateFoeListHandler),i.E.ins.off(n.EventName.UPDATE_VIEW_TARGET,this,this.updPlayerListHander),i.E.ins.off(n.EventName.CHANGE_PK_TARGET,this,this.attackTargetChangedHander),this.closeDeath(),this.death=null,this.view&&(this.view.hideView(),this.view=null,this.clearCtrlRes())},e}(r.BaseCtrl);t.PointWarCtrl=p}),define("src/g/pointwar/view/PointWarResult",["require","exports","../../../utils/StringUtils","../../../init/TextConst"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.initList(e.rankList,e.rankItemRenderFun,ui.pointwar.PointWarRItemUI),e}return __extends(e,t),e.prototype.initList=function(e,t,i){e.itemRender=i,e.selectEnable=!0,e.vScrollBarSkin="",e.scrollBar.elasticDistance=100,e.renderHandler=new Laya.Handler(this,t),e.array=[]},e.prototype.rankItemRenderFun=function(e,t){var i=e.dataSource;e.lbRank.text=(t+1).toString(),e.lbName.text=i.nickname,""==i.familyname||null==i.familyname?e.lbFamilyName.text=s.TextConst.get(655):e.lbFamilyName.text=i.familyname,e.lbExp.text=n.StringUtils.NumString(i.totalExp),e.lbJunGong.text=n.StringUtils.NumString(i.totalJungong)},e.prototype.showView=function(e){this.popup(),this.lbExpReward.text=n.StringUtils.NumString(e.myData.totalExp),this.lbJunGongReward.text=n.StringUtils.NumString(e.myData.totalJungong),this.rankList.array=e.topFiveData,this.img_bg.rotation=0,Laya.timer.loop(120,this,this.updEffectDisplay)},e.prototype.updEffectDisplay=function(){this.img_bg.rotation+=10},e.prototype.onClosed=function(e){Laya.timer.clear(this,this.updEffectDisplay),t.prototype.onClosed.call(this,e)},e}(ui.pointwar.PointWarResultUI);t.PointWarResult=i}),define("src/g/pointwar/ctrl/PointWarResultCtrl",["require","exports","../../base/BaseCtrl","../../../core/E","../../../enum/EventName","src/g/pointwar/view/PointWarResult"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.url="res/atlas/res/pointwarresult.json",n.E.ins.on(s.EventName.OPEN_POINT_RESULT,e,e.openView),e}return __extends(e,t),e.prototype.openView=function(e,t){this.callBackHander=e,this.resultData=t,this.open()},e.prototype.onAtlasLoaded=function(){null==this.view&&(this.view=new a.PointWarResult,this.view.closeHandler=Laya.Handler.create(this,this.distoryView)),this.view.showView(this.resultData)},e.prototype.distoryView=function(){this.view&&(this.resultData=null,this.view.closeHandler=null,this.view.destroy(!0),this.view=null,this.callBackHander.run(),this.callBackHander=null,this.clearCtrlRes())},e}(i.BaseCtrl);t.PointWarResultCtrl=o}),define("src/g/pointwar/ctrl/NPCEntryCtrl",["require","exports","../../../utils/SoundUtils"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.openHandler=function(){null==this.view&&(this.view=new ui.pointwar.NPCEntryUI,this.view.enterButton.on(Laya.Event.CLICK,this,this.enterHander),this.view.closeHandler=Laya.Handler.create(this,this.distoryView),this.initContent()),this.view.popup()},e.prototype.initContent=function(){this.initDIVE(this.view.lbDes),this.initDIVE(this.view.lbRule),this.updContent(),this.view.ruleTitleBox.y=this.view.lbDes.contextHeight+this.view.lbDes.y+10,this.view.lbRule.y=this.view.ruleTitleBox.y+this.view.ruleTitleBox.height+15,this.view.enterButton.y=this.view.lbRule.y+this.view.lbRule.contextHeight+15,this.view.imgGround.height=this.view.enterButton.y+this.view.enterButton.height+20,this.view.height=this.view.imgGround.height},e.prototype.initDIVE=function(e){e.style.color="#927f6d",e.style.font="SimHei",e.style.fontSize=18,e.style.align="left",e.style.leading=15},e.prototype.updContent=function(){},e.prototype.enterHander=function(){i.SoundUtils.getInstance().playBtnsounds()},e.prototype.distoryView=function(){this.view&&(Laya.loader.clearRes(this.view.imgTitle.skin),this.view.closeHandler=null,this.view.enterButton.off(Laya.Event.CLICK,this,this.enterHander),this.view.destroy(!0),this.view=null)},e}();t.NPCEntryCtrl=n}),define("src/g/pointwar/ctrl/PointNPCEntryCtrl",["require","exports","../../accessctrl/AccessCenter","../../../config/GameConfig","../../fight/osprite/play/HangUpExpManager","../../../init/Switches","../../../manager/RoleCenter","../../../utils/system/FloatEffect","src/g/pointwar/ctrl/NPCEntryCtrl","../../../manager/AM","../../fight/osprite/play/PlayManager","../../../plugin/view/ToolTip","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e._timingActivityVO=null,a.Switches.ins.on(i.enumAccessId.hot_spring,e,e.openHandler),e}return __extends(e,t),e.prototype.updContent=function(){this.view.imgTitle.skin="res/unpack/paodian_miaoshubiaoti1.png",this._timingActivityVO=n.GameConfig.timingActivity[4],this._timingActivityVO&&(this.view.lbDes.innerHTML=this._timingActivityVO.penDes);var e=n.GameConfig.Ruledesc[19];this.view.lbRule.innerHTML=e.tmptext},e.prototype.enterHander=function(){t.prototype.enterHander.call(this),null!=this._timingActivityVO?o.RoleCenter.instans.self.lvl<this._timingActivityVO.level?r.FE.outErrorInfo(6342):o.RoleCenter.instans.bagRoomEnough()?u.PlayManager.isSpecialPlay()?r.FE.upItems(d.TextConst.get(406),c.BubbleEnum.center):(this.view.close(),s.HangUpExpManager.getInstance().enterHangUpExp()):h.AM.showBagNotEnough():console.error("_timingActivityVO = null")},e}(l.NPCEntryCtrl);t.PointNPCEntryCtrl=g}),define("src/g/pointwar/ctrl/NightWarNPCEntry",["require","exports","src/g/pointwar/ctrl/NPCEntryCtrl","../../../init/Switches","../../accessctrl/AccessCenter","../../../config/GameConfig","../../fight/osprite/play/sandynight/SandyNightManager","../../../manager/RoleCenter","../../../utils/system/FloatEffect","../../../manager/AM","../../fight/osprite/play/PlayManager","../../../plugin/view/ToolTip","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(t){function e(){var e=t.call(this)||this;return e._timingActivityVO=null,n.Switches.ins.on(s.enumAccessId.night_fighting,e,e.openHandler),e}return __extends(e,t),e.prototype.updContent=function(){this.view.imgTitle.skin="res/unpack/paodian_miaoshubiaoti2.png",this._timingActivityVO=a.GameConfig.timingActivity[5],this._timingActivityVO&&(this.view.lbDes.innerHTML=this._timingActivityVO.penDes);var e=a.GameConfig.Ruledesc[24];this.view.lbRule.innerHTML=e.tmptext},e.prototype.enterHander=function(){this._timingActivityVO=a.GameConfig.timingActivity[5],t.prototype.enterHander.call(this),null!=this._timingActivityVO?r.RoleCenter.instans.vo.getCurLv()<this._timingActivityVO.level?l.FE.outErrorInfo(6342):r.RoleCenter.instans.bagRoomEnough()?u.PlayManager.isSpecialPlay()?l.FE.upItems(d.TextConst.get(406),c.BubbleEnum.center):(this.view.close(),o.SandyNightManager.getInstance().enterSandyNight()):h.AM.showBagNotEnough():console.error("_timingActivityVO = null")},e}(i.NPCEntryCtrl);t.NightWarNPCEntry=g}),define("src/g/rough/view/RoughView",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),i.LayerManager.addInPOPWindowLayer(this,e,!0,!0,!1,t)},t.prototype.hideView=function(){this.bg_view.box_page.removeChildren(),this.removeSelf()},t.prototype.destroyView=function(){this.hideView()},t}(ui.rough.RoughViewUI);t.RoughView=n}),define("src/g/rough/view/RoughPage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(ui.rough.RoughPageUI);t.RoughPage=i}),define("src/g/rough/view/RoughSuitComp",["require","exports","../../../manager/RoleCenter","../../../config/GameConfig","../../../init/TextConst"],function(e,t,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setSuitId=function(e){if(0<e){e<=o.RoleCenter.instans.vo.roughData.getSuitLv()?(this.lab_attr.color=this.lab_condition.color=this.lab_active.color="#09d51f",this.lab_active.changeText(l.TextConst.get(524))):(this.lab_attr.color=this.lab_condition.color=this.lab_active.color="#c0b4a3",this.lab_active.changeText(l.TextConst.get(485)));var t=r.GameConfig.roughSuitCfg[e];this.lab_name.changeText(t.wingsuit);for(var i=o.RoleCenter.instans.vo.roughData.lvArr,n=i.length,s=0,a=0;s<n;)i[s]>=t.needlevel&&a++,s++;this.lab_condition.changeText("激活条件:镶嵌所有类型的"+t.needlevel+"级原石("+a+"/"+t.suitNum+")"),this.lab_attr.changeText("激活属性：原石全属性+"+t.ALL_MULTI/100+"%")}},t}(ui.rough.RoughSuitCompUI);t.RoughSuitComp=i}),define("src/g/rough/view/RoughSuitTip",["require","exports","src/g/rough/view/RoughSuitComp","../../../manager/RoleCenter","../../../config/GameConfig"],function(e,t,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showSuit=function(){this.box_content.removeChildren();var e=r.RoleCenter.instans.vo.roughData.getSuitLv();if(0<e&&(this.currSuit||(this.currSuit=new o.RoughSuitComp),this.currSuit.setSuitId(e),this.box_content.addChild(this.currSuit)),l.GameConfig.roughSuitCfg[e+1]){if(0<e){var t=new Laya.Image("res/custom/xian1.png");t.x=28,this.box_content.addChild(t)}this.nextSuit||(this.nextSuit=new o.RoughSuitComp),this.nextSuit.setSuitId(e+1),this.box_content.addChild(this.nextSuit)}for(var i=this.box_content.numChildren,n=0,s=0;n<i;){var a=this.box_content.getChildAt(n);a.y=s,s+=a.height+5,n++}this.height=s+15,this.img_bg.height=this.height,this.lab_prompt.y=this.height-3,this.isPopup||this.popup()},t}(ui.rough.RoughSuitTipUI);t.RoughSuitTip=i}),define("src/g/rough/view/RoughSkillComp",["require","exports","../../../utils/UIUtils","../../../manager/RoleCenter","../../../config/GameConfig","../../../init/TextConst"],function(e,t,i,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return i.UIUtils.initHtmlDiv(e.htxt_desc,"#c0b4a3",18),e.htxt_desc.style.leading=5,e}return __extends(e,t),e.prototype.setSuitId=function(e){e<=r.RoleCenter.instans.vo.roughData.getSuitLv()?(this.lab_condition.color=this.lab_active.color="#09d51f",this.lab_active.changeText(h.TextConst.get(524))):(this.lab_condition.color=this.lab_active.color="#c0b4a3",this.lab_active.changeText(h.TextConst.get(485)));for(var t=l.GameConfig.roughSuitCfg[e],i=r.RoleCenter.instans.vo.roughData.lvArr,n=i.length,s=0,a=0;s<n;)i[s]>=t.needlevel&&a++,s++;this.lab_condition.changeText("激活条件:镶嵌所有类型的"+t.needlevel+"级原石("+a+"/"+t.suitNum+")");var o=l.GameConfig.roughSkillCfg[t.skill];this.lab_name.changeText(o.name),this.htxt_desc.innerHTML=o.desc,this.height=this.htxt_desc.y+this.htxt_desc.contextHeight+5},e}(ui.rough.RoughSkillCompUI);t.RoughSkillComp=n}),define("src/g/rough/view/RoughSkillTip",["require","exports","../../../manager/RoleCenter","../../../config/GameConfig","src/g/rough/view/RoughSkillComp"],function(e,t,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showSuitSkill=function(){this.box_content.removeChildren();var e=o.RoleCenter.instans.vo.roughData.getSuitLv();if(0<e&&(this.currSkill||(this.currSkill=new l.RoughSkillComp),this.currSkill.setSuitId(e),this.box_content.addChild(this.currSkill)),r.GameConfig.roughSuitCfg[e+1]){if(0<e){var t=new Laya.Image("res/custom/xian1.png");t.x=28,this.box_content.addChild(t)}this.nextSkill||(this.nextSkill=new l.RoughSkillComp),this.nextSkill.setSuitId(e+1),this.box_content.addChild(this.nextSkill)}for(var i=this.box_content.numChildren,n=0,s=0;n<i;){var a=this.box_content.getChildAt(n);a.y=s,s+=a.height+5,n++}this.height=s+15,this.img_bg.height=this.height,this.lab_prompt.y=this.height-3,this.isPopup||this.popup()},t}(ui.rough.RoughSkillTipUI);t.RoughSkillTip=i}),define("src/g/rough/view/RoughTip",["require","exports","../../../manager/RoleCenter","../../../config/GameConfig","../../../utils/ItemCellUtils","../../../utils/UIUtils","../../../utils/ItemUtils","../../net/messages/sbkRoughData","../../../manager/GameSocketManager","../../../core/E","../../../enum/EventName","../../../utils/RoleUtil","../../itemGets/View/ItemGetDlg","../../../init/TextConst"],function(e,t,u,c,d,i,g,a,o,n,s,p,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){function e(){var e=t.call(this)||this;return e._needItemId=0,e.list_curr_attr.renderHandler=new Laya.Handler(e,e.onListCurrAttrRender),e.list_next_attr.renderHandler=new Laya.Handler(e,e.onListNextAttrRender),i.UIUtils.initHtmlDiv(e.htxt_curr_skill,"#c47dfc",16),i.UIUtils.initHtmlDiv(e.htxt_next_skill,"#c0b4a3",16),e.htxt_curr_skill.style.leading=2,e.htxt_next_skill.style.leading=2,e.btn_lv_up.on(Laya.Event.CLICK,e,e.onHandLvUp),e.costbar.setJump(l.TextConst.get(238),new Laya.Handler(e,e.ongetClieck)),e}return __extends(e,t),e.prototype.ongetClieck=function(){if(this._needItemId){var e=g.ItemUtils.getItemVoById(this._needItemId);(new r.ItemGetDlg).initByVo(e).popup()}},e.prototype.onListCurrAttrRender=function(e,t){var i=this.list_curr_attr.array[t],n=i[0],s=i[1],a=c.GameConfig.ShuXing_Json[n];a?e.lab_name.changeText(a.desc+":"):e.lab_name.changeText("???:"),e.lab_value.changeText(s.toString())},e.prototype.onListNextAttrRender=function(e,t){e.lab_name.color=e.lab_value.color="#09d51f";var i=this.list_next_attr.array[t],n=i[0],s=i[1],a=c.GameConfig.ShuXing_Json[n];a?e.lab_name.changeText(a.desc+":"):e.lab_name.changeText("???:"),e.lab_value.changeText(s.toString())},e.prototype.showTip=function(e){this._index=e,this.updateShow(),this.isPopup||this.popup(),n.E.ins.on(s.EventName.ROUGH_LEVEL_UP,this,this.updateShow)},e.prototype.onClosed=function(){n.E.ins.off(s.EventName.ROUGH_LEVEL_UP,this,this.updateShow)},e.prototype.delayUpdateShow=function(){Laya.timer.frameOnce(2,this,this.updateShow)},e.prototype.updateShow=function(){var e=u.RoleCenter.instans.vo.roughData.lvArr[this._index],t=1e3*(this._index+1)+e,i=c.GameConfig.roughGlovesCfg[t],n=i.upcost[0][0];d.ItemCellUtils.fillCellForItem0View(this.item,n,1),this.lab_name.changeText(i.sv_name),this.lab_lv.changeText("Lv."+e),this.list_curr_attr.array=i.prop;var s=c.GameConfig.roughSkillCfg[i.skill];this.htxt_curr_skill.innerHTML=s.desc;var a=p.RoleUtil.calFightByProp(i.prop)*u.RoleCenter.instans.vo.heronum+s.power;if(this.font_fight.value=a.toString(),i=c.GameConfig.roughGlovesCfg[t+1]){this.box_next.visible=!0,this.list_next_attr.array=i.prop;s=c.GameConfig.roughSkillCfg[i.skill];this.htxt_next_skill.innerHTML=s.desc;var o=i.upcost[0][0],r=i.upcost[0][1],l=u.RoleCenter.instans.vo.bagdata.getItemCount(o),h=g.ItemUtils.getItemVoById(o);this.costbar.setNeedName(h.name,g.ItemUtils.getSmallIcon(h.icon)),this.costbar.setQualColor(g.ItemUtils.getColorByQuality(h.quality)),this.costbar.setNeed(l,r),this._needItemId=o}else this._needItemId=0,this.list_next_attr.array=null,this.box_next.visible=!1},e.prototype.onHandLvUp=function(){var e=u.RoleCenter.instans.vo.roughData.lvArr[this._index],t=1e3*(this._index+1)+e+1,i=c.GameConfig.roughGlovesCfg[t];if(i){var n=i.upcost[0][0];if(i.upcost[0][1]<=u.RoleCenter.instans.vo.bagdata.getItemCount(n)){var s=new a.RoughMsg;s.type=1,s.stroneType=this._index+1,s.curLv=e,o.GSM.sendServer(s)}}},e}(ui.rough.RoughTipUI);t.RoughTip=h}),define("src/g/rough/view/RoughSelectDlg",["require","exports","../../../config/GameConfig","../../../manager/RoleCenter","../../../utils/ItemCellUtils","../../net/messages/sbkRoughData","../../../manager/GameSocketManager","../../bag/tips/view/ItemTips"],function(e,t,r,l,i,a,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e._index=0,e.list_item.renderHandler=new Laya.Handler(e,e.onListRenderHander),e.bg.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,t),e.prototype.showRough=function(e){var t=1e3*((this._index=e)+1)+1,i=r.GameConfig.roughGlovesCfg[t];if(i){for(var n=i.upcost[0][0],s=l.RoleCenter.instans.vo.bagdata.getItemCount(n),a=[],o=0;o<s;)a.push(n),o++;this.list_item.array=a}this.isPopup||this.popup()},e.prototype.onListRenderHander=function(e,t){i.ItemCellUtils.fillCellForItem0View(e.item,this.list_item.array[t],1,e.lab_name),n.ItemTips.cellShowTip(e.item,this.list_item.array[t],1),e.btn_up.offAll(),e.btn_up.on(Laya.Event.CLICK,this,this.onHandLvUp)},e.prototype.onHandLvUp=function(){var e=l.RoleCenter.instans.vo.roughData.lvArr[this._index],t=1e3*(this._index+1)+e+1,i=r.GameConfig.roughGlovesCfg[t];if(i){var n=i.upcost[0][0];if(i.upcost[0][1]<=l.RoleCenter.instans.vo.bagdata.getItemCount(n)){var s=new a.RoughMsg;s.type=1,s.stroneType=this._index+1,s.curLv=e,o.GSM.sendServer(s)}}this.close()},e}(ui.rough.RoughSelectDlgUI);t.RoughSelectDlg=s}),define("src/g/rough/ctrl/RoughPageCtrl",["require","exports","src/g/rough/view/RoughPage","src/g/rough/view/RoughSuitTip","src/g/rough/view/RoughSkillTip","../../../manager/RoleCenter","../../../config/GameConfig","../../../utils/UIUtils","../../../utils/ItemUtils","../../itemGets/View/ItemGetDlg","../../net/messages/sbkRoughData","../../../manager/GameSocketManager","../../../core/E","../../../enum/EventName","src/g/rough/view/RoughTip","src/g/rough/view/RoughSelectDlg","../../net/messages/sbkFormula","../../net/messages/PropFightMain","../../../utils/effects/BesselEffect","../../Effects/UIEffectsFactory","../../../init/TextConst","../../../init/ResManager"],function(e,t,i,n,s,f,y,a,h,o,r,l,u,c,d,g,p,m,v,_,C,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=function(){function e(){this._initY=0,this._float=-35,this._state=1,this.roughEffectIds=[461,462,463,464,465,466],this.stoneEffectIds=[471,472,473,474,475,476],this._needItemId=0}return e.prototype.init=function(){this._view.img_suit.on(Laya.Event.CLICK,this,this.showSuit),this._view.img_skill.on(Laya.Event.CLICK,this,this.showSuitSkill),this._view.btn_rough.on(Laya.Event.CLICK,this,this.switchTab,[0]),this._view.btn_hand.on(Laya.Event.CLICK,this,this.switchTab,[1]),a.UIUtils.initHtmlDiv(this._view.htxt_skill_desc,"#c0b4a3",18),this._view.htxt_skill_desc.style.leading=5,this._view.lisr_curr_attr.renderHandler=new Laya.Handler(this,this.onListCurrAttrRender),this._view.lisr_next_attr.renderHandler=new Laya.Handler(this,this.onListNextAttrRender),this._view.list_attr.renderHandler=new Laya.Handler(this,this.onListAttrRender),this._view.costbar.setJump(C.TextConst.get(238),new Laya.Handler(this,this.ongetClieck)),this._view.btn_lv_up.on(Laya.Event.CLICK,this,this.onHandLvUp),u.E.ins.on(c.EventName.ROUGH_LEVEL_UP,this,this.onRoughLvUpHandler),u.E.ins.on(c.EventName.ROUGH_STRONG_UP,this,this.onStrongUpHandler),u.E.ins.on(c.EventName.ROUGH_FIGHT_CHANGED,this,this.updateFightNum),this._view.panel_rough.vScrollBar.elasticDistance=100},e.prototype.onRoughLvUpHandler=function(e,t){var i=this;if(1==t){this._currTween&&this._currTween.pause();var n=e-1,s="res/rough/wxst_bs_00"+(n+1)+".png";this._view["img_rough_"+n].skin=s;var a=new Laya.Sprite;a.loadImage(s,0,0,80,80),a.pivotX=40,a.pivotY=40,a.x=this._view["img_rough_"+n].x,a.y=this._view["img_rough_"+n].y,a.scaleX=1,a.scaleY=1,this._view.addChild(a);var o=new Laya.Point(this._view.img_hand.x+this._view["img_stone_"+n].x,this._view.img_hand.y+this._view["img_stone_"+n].y);v.BesselEffect.fly(a,o,100,-100,800,Laya.Handler.create(this,function(){a.removeSelf(),a.destroy(),i.updateRough(),i._currTween&&i._currTween.resume()})),Laya.Tween.to(a,{scaleX:.2,scaleY:.2},800,Laya.Ease.backIn)}else this.updateRough();this.updateBoxRough(),this.updateSuitLv()},e.prototype.updateSuitLv=function(){var e=f.RoleCenter.instans.vo.roughData.getSuitLv();this._view.img_suit.gray=this._view.img_skill.gray=e<1},e.prototype.handFloat=function(){0==this._initY&&(this._initY=this._view.img_hand.y),this._state=0,this.switchFloat()},e.prototype.stopFloat=function(){0!=this._initY&&(this._view.img_hand.y=this._initY),this._state=0,this._currTween&&this._currTween.clear()},e.prototype.switchFloat=function(){0==this._state?this._state=1:this._state=0,this.doFloat()},e.prototype.doFloat=function(){var e=0==this._state?this._initY:this._initY+this._float;this._currTween=Laya.Tween.to(this._view.img_hand,{y:e},2e3,null,Laya.Handler.create(this,this.switchFloat))},e.prototype.onStrongUpHandler=function(){this.updateHand(),this.updateBoxHand()},e.prototype.showPage=function(e,t){this._view||(this._view=new i.RoughPage,this.init()),e.removeChildren(),e.addChild(this._view),this.setRoughEffect(),this.setStoneEffect(),this.switchTab(0),this.refreshData(),this.handFloat(),this.updateSuitLv()},e.prototype.loadUrls=function(){throw new Error("Method not implemented.")},e.prototype.changePerson=function(e,t){throw new Error("Method not implemented.")},e.prototype.refreshData=function(){this.updateFightNum(),this.updateRough(),this.updateHand(),this.updateBoxRough(),this.updateBoxHand()},e.prototype.getTitle=function(){return"res/rough/wxst_biaoti.png"},e.prototype.hidePage=function(){this.clearRoughEffect(),this.clearStoneEffect(),this.stopFloat(),w.ResManager.getInstance().hidePageCtrl(this),this._view&&this._view.removeSelf()},e.prototype.destroyPage=function(){this.hidePage()},e.prototype.setRoughEffect=function(){for(var e=this.roughEffectIds.length,t=0;t<e;)this._view["ani_rough_"+t].source=_.UIEffectsFactory.Ins.getSourceUrlById(this.roughEffectIds[t]),this._view["ani_rough_"+t].play(),t++},e.prototype.clearRoughEffect=function(){for(var e=this.roughEffectIds.length,t=0;t<e;)this._view["ani_rough_"+t].clear(),_.UIEffectsFactory.Ins.clearAniRes(this.roughEffectIds[t]),t++},e.prototype.setStoneEffect=function(){for(var e=this.stoneEffectIds.length,t=0;t<e;)this._view["img_stone_"+t].source=_.UIEffectsFactory.Ins.getSourceUrlById(this.stoneEffectIds[t]),this._view["img_stone_"+t].play(),t++},e.prototype.clearStoneEffect=function(){for(var e=this.stoneEffectIds.length,t=0;t<e;)this._view["img_stone_"+t].clear(),_.UIEffectsFactory.Ins.clearAniRes(this.stoneEffectIds[t]),t++},e.prototype.showSuit=function(){this._suitTip||(this._suitTip=new n.RoughSuitTip),this._suitTip.showSuit()},e.prototype.showSuitSkill=function(){this._suitSkillTip||(this._suitSkillTip=new s.RoughSkillTip),this._suitSkillTip.showSuitSkill()},e.prototype.updateFightNum=function(){var e=f.RoleCenter.instans.vo.roughData,t=m.PropFightMain.getins();t.reset();var i=f.RoleCenter.instans.vo.heronum;t.HP=e.getProp("HP")*i,t.ATT=e.getProp("ATT")*i,t.SDEF=e.getProp("SDEF")*i,t.PDEF=e.getProp("PDEF")*i;var n=e.skillPower+p.sbkFormula.calPropFightMainCombat(t);t.release(),this._view.box_fight.setFightNum(n)},e.prototype.updateRough=function(){for(var e=f.RoleCenter.instans.vo.roughData.lvArr,t=e.length,i=0,n=0;i<t;){var s=1e3*(i+1)+(0<(n=e[i])?n:1),a=y.GameConfig.roughGlovesCfg[s];this._view["hit"+i].offAll(),this._view["hit"+i].on(Laya.Event.CLICK,this,this.onRoughClickHandler,[i,n]),this._view["ani_rough_"+i].visible=0<n?(this._view["img_rough_"+i].visible=!1,this._view["lab_name_"+i].changeText(a.sv_name+" Lv."+n),this._view["img_stone_"+i].visible=!0):(this._view["img_rough_"+i].visible=!0,this._view["lab_name_"+i].changeText(a.sv_name),this._view["img_stone_"+i].visible=!1),i++}},e.prototype.onRoughClickHandler=function(e,t){0<t?(this._roughTip||(this._roughTip=new d.RoughTip),this._roughTip.showTip(e)):(this._roughSelectDlg||(this._roughSelectDlg=new g.RoughSelectDlg),this._roughSelectDlg.showRough(e))},e.prototype.updateHand=function(){this._view.font_lv.value=f.RoleCenter.instans.vo.roughData.strongLv.toString()},e.prototype.updateBoxHand=function(){var e,t=f.RoleCenter.instans.vo.roughData.strongLv;if(this._view.lab_curr_lv.changeText("Lv."+t),0<t)e=y.GameConfig.roughStrongCfg[t],this._view.lisr_curr_attr.array=e.prop;else{for(var i=[],n=(e=y.GameConfig.roughStrongCfg[1]).prop.length,s=0;s<n;)i.push([e.prop[s][0],0]),s++;this._view.lisr_curr_attr.array=i}if(e=y.GameConfig.roughStrongCfg[t+1]){this._view.lab_next_lv.changeText("Lv."+(t+1)),this._view.lisr_next_attr.array=e.prop;var a=e.upcost[0][0],o=e.upcost[0][1],r=f.RoleCenter.instans.vo.bagdata.getItemCount(a),l=h.ItemUtils.getItemVoById(a);this._view.costbar.setNeedName(l.name,h.ItemUtils.getSmallIcon(l.icon)),this._view.costbar.setQualColor(h.ItemUtils.getColorByQuality(l.quality)),this._view.costbar.setNeed(r,o),this._needItemId=a,this._view.costbar.visible=!0,this._view.btn_lv_up.disabled=!1,this._view.lab_end.visible=!1}else this._view.lab_next_lv.changeText(""),this._view.lisr_next_attr.array=null,this._needItemId=0,this._view.costbar.visible=!1,this._view.btn_lv_up.disabled=!0,this._view.lab_end.visible=!0},e.prototype.onHandLvUp=function(){var e=f.RoleCenter.instans.vo.roughData.strongLv,t=y.GameConfig.roughStrongCfg[e+1];if(t){var i=t.upcost[0][0];if(t.upcost[0][1]<=f.RoleCenter.instans.vo.bagdata.getItemCount(i)){var n=new r.RoughMsg;n.type=2,n.curLv=e,l.GSM.sendServer(n)}}},e.prototype.ongetClieck=function(){if(this._needItemId){var e=h.ItemUtils.getItemVoById(this._needItemId);(new o.ItemGetDlg).initByVo(e).popup()}},e.prototype.updateBoxRough=function(){for(var e=["#c47dfc","#70c4ff","#16b72d","#ff4b4b","#ffeb0a","#ff830a"],t=f.RoleCenter.instans.vo.roughData.lvArr,i=t.length,n=0,s=0,a={},o="";n<i;){if(0<(s=t[n])){for(var r=1e3*(n+1)+s,l=(g=y.GameConfig.roughGlovesCfg[r]).prop.length,h=0;h<l;h++){var u=g.prop[h][0],c=Number(g.prop[h][1]);a[u]?a[u]+=c:a[u]=c}var d=y.GameConfig.roughSkillCfg[g.skill];o+="<font color='"+e[n]+"'>【"+g.sv_name+"】</font>:"+d.desc+"<br><br><br>"}else{var g;for(r=1e3*(n+1)+1,l=(g=y.GameConfig.roughGlovesCfg[r]).prop.length,h=0;h<l;h++){u=g.prop[h][0],c=Number(g.prop[h][1]);a[u]?a[u]+=0:a[u]=0}d=y.GameConfig.roughSkillCfg[g.skill];o+="<font color='#c0b4a3'>【"+g.sv_name+"】</font>:"+d.desc.replace(new RegExp("#03bb00","g"),"#c0b4a3")+"<br><br><br>"}n++}var p=[];for(var m in a)p.push([m,a[m]]);this._view.list_attr.array=p,this._view.htxt_skill_desc.innerHTML=o,this._view.box_panel_con.height=this._view.htxt_skill_desc.y+this._view.htxt_skill_desc.contextHeight},e.prototype.onListAttrRender=function(e,t){e.lab_name.color=e.lab_value.color="#09d51f";var i=this._view.list_attr.array[t],n=i[0],s=i[1],a=y.GameConfig.ShuXing_Json[n];a?e.lab_name.changeText(a.desc+":"):e.lab_name.changeText("???:"),e.lab_value.changeText(s.toString())},e.prototype.onListCurrAttrRender=function(e,t){var i=this._view.lisr_curr_attr.array[t],n=i[0],s=i[1],a=y.GameConfig.ShuXing_Json[n];a?e.lab_name.changeText(a.desc+":"):e.lab_name.changeText("???:"),e.lab_value.changeText(s.toString())},e.prototype.onListNextAttrRender=function(e,t){e.lab_name.color=e.lab_value.color="#09d51f";var i=this._view.lisr_next_attr.array[t],n=i[0],s=i[1],a=y.GameConfig.ShuXing_Json[n];a?e.lab_name.changeText(a.desc+":"):e.lab_name.changeText("???:"),e.lab_value.changeText(s.toString())},e.prototype.switchTab=function(e){this._view.btn_hand.selected=this._view.box_hand.visible=1==e,this._view.btn_rough.selected=this._view.panel_rough.visible=0==e,this._view.img_selected.x=0==e?this._view.btn_rough.x:this._view.btn_hand.x},e}();t.RoughPageCtrl=I}),define("src/g/rough/view/RoughCopyPage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(ui.rough.RoughCopyPageUI);t.RoughCopyPage=i}),define("src/g/rough/ctrl/RoughCopyPageCtrl",["require","exports","src/g/rough/view/RoughCopyPage","../../../core/E","../../../enum/EventName","../../fight/info/PlayTypeVo","../../net/messages/ChangeSceneMsg","../../../manager/RoleCenter","../../../config/GameConfig","../../../init/ResManager"],function(e,t,i,n,s,a,o,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){}return e.prototype.init=function(){this._view.btn_fight.on(Laya.Event.CLICK,this,this.onFightHandler)},e.prototype.showPage=function(e,t){this._view||(this._view=new i.RoughCopyPage,this.init()),e.removeChildren(),e.addChild(this._view),this.refreshData()},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(e,t){},e.prototype.refreshData=function(){var e=r.RoleCenter.instans.vo.COPYROUGHCOUNT,t=this._view;t.lab_num.color=0==e?"#ff0f15":"#03bb00",t.btn_fight.disabled=0==e,t.lab_num.text=e+"/"+l.GameConfig.roughcopy[20020].chance},e.prototype.getTitle=function(){return"res/rough/ysfb_biaoti.png"},e.prototype.hidePage=function(){h.ResManager.getInstance().hidePageCtrl(this),this._view&&this._view.removeSelf()},e.prototype.destroyPage=function(){this.hidePage()},e.prototype.onFightHandler=function(){n.E.ins.event(s.EventName.PLAY_TYPE_CHANGE,a.PlayTypeVo.create(o.EPlayType.PLAYTYPE_ROUGHCOPY))},e}();t.RoughCopyPageCtrl=u}),define("src/g/rough/ctrl/RoughCtrl",["require","exports","../../../manager/GameSocketManager","../../net/messages/sbkRoughData","../../../manager/RoleCenter","../../../core/E","../../../enum/EventName","../../../plugin/sbkPropTool","../../base/BaseCtrl","../../accessctrl/AccessCenter","src/g/rough/view/RoughView","../../clearRes/ClearResM","src/g/rough/ctrl/RoughPageCtrl","../../proxy/MultiLevelUIProxy","src/g/rough/ctrl/RoughCopyPageCtrl","../../../config/GameConfig","../../../manager/NewRedHintsCenter","../../../init/Switches"],function(e,t,i,n,l,s,a,o,r,h,u,c,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){function e(){var e=t.call(this)||this;return e._openArg=[],e.urls=["res/atlas/res/rough.json"],y.Switches.ins.on(h.enumAccessId.rough,e,e.onOpenHandler,[h.enumAccessId.rough]),y.Switches.ins.on(h.enumAccessId.rough_copy,e,e.onOpenHandler,[h.enumAccessId.rough_copy]),i.GSM.ins.on(n.sbkRoughData.KEY,e,e.initRoughData),i.GSM.ins.on(n.RoughMsg.KEY,e,e.onRoughUp),e}return __extends(e,t),e.prototype.onOpenHandler=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t&&this.openView(e,i,n)},e.prototype.openView=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this._openArg.length=0,this._openArg.push(e),this._openArg.push(t),this._openArg.push(i),this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenReXueView(this._openArg[0],this._openArg[1],this._openArg[2])},e.prototype.realOpenReXueView=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this._view||(this._view=new u.RoughView,this._tabProxy=new g.MultiLevelUIProxy,this._tabProxy.registerTab(this._view.tab,0),this._tabProxy.registerTagIndex(h.enumAccessId.rough,0),this._tabProxy.registerTagIndex(h.enumAccessId.rough_copy,1),this._tabProxy.selectHandler=new Laya.Handler(this,this.tab_selectHandler),this._view.bg_view.btn_back.on(Laya.Event.CLICK,this,this.onCloseView),this._view.bg_view.btn_close.on(Laya.Event.CLICK,this,this.onCloseView)),this._tabProxy.open(e),this._view.showView(t,i)},e.prototype.onCloseView=function(){this._page&&(this._page.hidePage(),this._page=null),this._view.hideView()},e.prototype.tab_selectHandler=function(e){this._page&&this._page.hidePage(),0==e?(this.roughCtrl||(this.roughCtrl=new d.RoughPageCtrl),this._page=this.roughCtrl):1==e&&(this.roughCopyCtrl||(this.roughCopyCtrl=new p.RoughCopyPageCtrl),this._page=this.roughCopyCtrl),this._page&&this._page.showPage(this._view.bg_view.box_page),this._view.bg_view.img_title.skin=this._page.getTitle(),c.ClearResM.resetViewImg(this._view.bg_view)},e.prototype.initRoughData=function(e){l.RoleCenter.instans.vo.roughData.copydata(e),s.E.ins.event(a.EventName.ROUGH_DATA_CHANGED),this.onRoughDataChanged(),this.onCheckRed(),this.checkRoughCopyRed(),s.E.ins.on(a.EventName.CHANGEITEM_COUNT,this,this.onCheckRed),s.E.ins.on(a.EventName.ROUGH_COPY_COUNT_CHANGED,this,this.checkRoughCopyRed)},e.prototype.onCheckRed=function(){this.checkRoughHandRed(),this.checkRoughRed()},e.prototype.onRoughUp=function(e){1==e.type?(l.RoleCenter.instans.vo.roughData.lvArr[e.stroneType-1]=e.curLv,s.E.ins.event(a.EventName.ROUGH_LEVEL_UP,[e.stroneType,e.curLv]),this.checkRoughRed()):2==e.type&&(l.RoleCenter.instans.vo.roughData.strongLv=e.curLv,s.E.ins.event(a.EventName.ROUGH_STRONG_UP),this.checkRoughHandRed()),this.onRoughDataChanged()},e.prototype.onRoughDataChanged=function(){var e=l.RoleCenter.instans.vo.combat;o.sbkPropTool.reSetRough(),l.RoleCenter.instans.event(a.EventName.FIGHT_UP,l.RoleCenter.instans.vo.reCheckComBat()-e),s.E.ins.event(a.EventName.ROUGH_FIGHT_CHANGED)},e.prototype.checkRoughRed=function(){for(var e=l.RoleCenter.instans.vo.roughData.lvArr,t=e.length,i=0;i<t;){var n=1e3*(i+1)+(e[i]+1),s=m.GameConfig.roughGlovesCfg[n];if(s){var a=s.upcost[0][0],o=s.upcost[0][1],r=l.RoleCenter.instans.vo.bagdata.getItemCount(a);f.NewRedHintsCenter.ins.setRedHintOpenOrClose(f.enumRedHints.rough_gloves_gem1+i,o<=r)}else f.NewRedHintsCenter.ins.setRedHintOpenOrClose(f.enumRedHints.rough_gloves_gem1+i,!1);i++}},e.prototype.checkRoughHandRed=function(){var e=!1,t=l.RoleCenter.instans.vo.roughData.strongLv,i=m.GameConfig.roughStrongCfg[t+1];if(i){var n=i.upcost[0][0];i.upcost[0][1]<=l.RoleCenter.instans.vo.bagdata.getItemCount(n)&&(e=!0)}f.NewRedHintsCenter.ins.setRedHintOpenOrClose(f.enumRedHints.rough_gloves_gloves,e)},e.prototype.checkRoughCopyRed=function(){var e=l.RoleCenter.instans.vo.COPYROUGHCOUNT;f.NewRedHintsCenter.ins.setRedHintOpenOrClose(f.enumRedHints.rough_copy,0<e)},e}(r.BaseCtrl);t.RoughCtrl=v}),define("src/g/holydress/view/HolyDressMainView",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e){void 0===e&&(e=!1),i.LayerManager.addInPOPWindowLayer(this,e)},t.prototype.hideView=function(){this.removeSelf(),this.view_bg.box_page.removeChildren()},t.prototype.destroyView=function(){this.hideView()},t}(ui.holydress.HolyDressMainViewUI);t.HolyDressMainView=n}),define("src/g/holydress/view/HolyDressSelectItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.btn_change.on(Laya.Event.CLICK,e,e.onBtnChage),e}return __extends(e,t),e.prototype.onBtnChage=function(){},e}(ui.holydress.HolyDressSelectItemUI);t.HolyDressSelectItem=i}),define("src/g/holydress/view/HolyDressSelectView",["require","exports","../../../manager/RoleCenter","../../../utils/ItemUtils","../../../config/GameConfig","../../net/messages/sbkFormula","../../net/messages/feishengzhuang/sbkFeiShengZhuangMsg","../../../manager/GameSocketManager","../../../utils/system/FloatEffect"],function(e,t,s,r,l,h,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e._heroIdx=0,e._equipId=0,e._equipPos=0,e.view_bg.btn_back.visible=!1,e.view_bg.btn_back.on(Laya.Event.CLICK,e,e.close),e.view_bg.btn_close.on(Laya.Event.CLICK,e,e.close),e.list_.renderHandler=new Laya.Handler(e,e.listRenderHandler),e.img_title.skin="res/title/wenzi_xuanzezhuangbei.png",e}return __extends(e,t),e.prototype.setEquipsData=function(e){0<e.length&&e.sort(function(e,t){return t.quality-e.quality}),this.list_.array=e},e.prototype.setCurHeroEquip=function(e,t,i,n){void 0===n&&(n=0),this._heroIdx=e,this._equipId=t,this._equipPos=i,this.p_heroData=s.RoleCenter.instans.vo.getOpenHeroByIdx(this._heroIdx),this.jobId=this.p_heroData.jobid},e.prototype.listRenderHandler=function(e,t){var i=e.dataSource,n=r.ItemUtils.getFsEquipVoById(i.equtemplet);e.lab_name.text=n.name,e.item_.img_item.skin=r.ItemUtils.getIconByIconId(n.icon),e.item_.img_quality.skin=r.ItemUtils.getQualitybjByQualityId(n.quality),e.lab_name.color=r.ItemUtils.getColorByQuality(n.quality),e.item_.img_fs_job.visible=!0,e.item_.img_fs_job.skin=r.ItemUtils.getfsJobIcon(this.jobId);var s=l.GameConfig.fsequipjson[n.id],a=s.prop,o=Math.floor(h.sbkFormula.calEquipCombat(a[0][1],a[1][1],a[2][1],a[3][1]))+s.power;e.fightTxt.text="战斗力:"+o,e.btn_change.on(Laya.Event.CLICK,this,this.onBtnChage,[i])},e.prototype.onBtnChage=function(e){var t=r.ItemUtils.getFsEquipVoById(e.equtemplet);if(s.RoleCenter.instans.vo.fsData.fsLv<t.limit)o.FE.upItems("您当前飞升等级太低！");else{var i=new n.PutonFSEquipC2GS;i.heroIdx=this._heroIdx,i.equipId=this._equipId,i.equipPos=this._equipPos,i.newEquipId=e.equid,a.GSM.sendServer(i),this.close()}},e}(ui.holydress.HolyDressSelectViewUI);t.HolyDressSelectView=i}),define("src/g/holydress/view/HolyDressStrongView",["require","exports","../../../manager/RoleCenter","../../../utils/ItemUtils","../../../config/GameConfig","../../../meta/ShuXingVo","../../../meta/ItemVo","../../../manager/GameSocketManager","../../../plugin/sbkPropTool","../../net/messages/sbkFormula","../../../utils/system/FloatEffect","../../net/messages/feishengzhuang/sbkFeiShengZhuangMsg","../../../vo/RedDot/EventRedDot","../../../core/E","../../../enum/EventName","../../net/messages/sbkEquipIns","../../../init/TextConst"],function(e,t,b,S,E,R,y,n,s,r,a,o,i,l,h,v,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(){var e=t.call(this)||this;return e.eqpuipsOrItems={equipIdArr:[],equipBagIdArr:[],itemCount:0,itemIdxArr:[]},e.bgview.btn_back.visible=!1,e.bgview.btn_close.on(Laya.Event.CLICK,e,e.close),e.btn_strong.on(Laya.Event.CLICK,e,e.onStrong),e.btn_allStrong.on(Laya.Event.CLICK,e,e.onAllStrong),e.list_item.renderHandler=new Laya.Handler(e,e.onRenderHandler),e.list_item.mouseHandler=new Laya.Handler(e,e.onMouseHandler),n.GSM.ins.on(o.FSEquipStrongChgMsg.KEY,e,e.onStrongSuccess),n.GSM.ins.on(o.FSEquipBreachChgMsg.KEY,e,e.onTuPoSuccess),e}return __extends(e,t),e.prototype.onTuPo=function(e,t){if(t<=e){var i=new o.FSEquipBreachChgMsg;i.heroIdx=this.heroIdx,i.equpos=this.eqPos,i.curLv=this.curData.breachLv,n.GSM.sendServer(i)}else a.FE.upItems("材料不足！")},e.prototype.onTuPoSuccess=function(e){console.log(e),this.curData.breachLv=e.curLv,this.initPanelData(this.curData),this.eqpuipsOrItems.equipIdArr=[],this.eqpuipsOrItems.equipBagIdArr=[],this.eqpuipsOrItems.itemIdxArr=[],this.eqpuipsOrItems.itemCount=0,this.list_item.refresh(),l.E.ins.event(i.EventRedDot.REFRESH_HOLYDRESS),this.floatCombat()},e.prototype.onStrongSuccess=function(e){console.log(e),this.curData.strongLv=e.curLv,this.curData.strongExp=e.curExp,this.initPanelData(this.curData),this.eqpuipsOrItems.equipIdArr=[],this.eqpuipsOrItems.equipBagIdArr=[],this.eqpuipsOrItems.itemIdxArr=[],this.eqpuipsOrItems.itemCount=0,this.list_item.refresh(),l.E.ins.event(i.EventRedDot.REFRESH_HOLYDRESS),this.floatCombat()},e.prototype.initEquipsList=function(){for(var e=[],t=b.RoleCenter.instans.self.bagdata,i=t.equBagData,n=0;n<i.length;n++){var s=i[n],a=S.ItemUtils.getFsEquipVoById(s.equtemplet);if(s.type==v.enumEquipType.fsEquip&&1!=a.pos&&2!=a.pos&&a.job==this.jobId){var o=this.p_heroData.fsequpos[a.pos-1].ins[0];if(o){var r=0<o.equid,l=o.equtemplet;r&&a.id<l&&e.push(s)}}}for(n=0;n<t.itemId.length;n++){var h=S.ItemUtils.getItemVoById(t.itemId[n]);if(h&&h.id&&8525==h.id){for(var u=t.itemNum[n],c=Math.floor(u/10),d=u%10,g=0;g<c;g++){var p=new y.ItemVo;for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m]);p.num=10,p.idx=e.length,e.push(p)}if(d){var f=new y.ItemVo;for(var m in h)h.hasOwnProperty(m)&&(f[m]=h[m]);f.num=d,f.idx=e.length,e.push(f)}}}this.list_item.array=e},e.prototype.setIndex=function(e,t){this.eqPos=e,this.heroIdx=t,this.p_heroData=b.RoleCenter.instans.vo.getOpenHeroByIdx(this.heroIdx),this.jobId=this.p_heroData.jobid},e.prototype.initPanelData=function(e){if(e){var t=S.ItemUtils.getFsEquipVoById(e.ins[0].equtemplet);this.curData=e,this.setPower();var i=e.strongLv,n=e.breachLv,s=this.box_nowAttr,a=this.box_nextAttr;this.lab_curLv.text=i.toString(),this.lab_breachLv.text="（突破"+n+"层）",this.lab_nextLv.text=(i+1).toString(),this.item.img_item.skin=S.ItemUtils.getIconByIconId(t.icon),this.item.img_quality.skin=S.ItemUtils.getQualityBjById(t.id),this.item.img_fs_job.visible=!0,this.item.img_fs_job.skin=S.ItemUtils.getfsJobIcon(this.jobId);var o=E.GameConfig.fsequipstrongjson[i],r=E.GameConfig.fsequipstrongjson[i+1];if(!r){this.lab_manji.visible=!0,this.box_bar.visible=!1,this.btn_strong.disabled=!0,this.lab_nextLv.visible=!1,a.visible=!1,s.x=220,this.box_lvl.x=135,this.img_jiantou1.visible=this.img_jiantou2.visible=!1;for(var l=o.prop,h=0;h<5;h++){var u=s.getChildByName("lab_"+h),c=S.ItemUtils.getShuXingByName(l[h][0]);if(l){var d=R.ShuXingVo.getString4Vo(l[h][1],c);c=S.ItemUtils.getShuXingByName(l[h][0]),u.text=c.desc+":"+Number(d)}}return this.lab_des.text="您已达突破等级上限！",this.box_strong.visible=!1,this.box_tupo.visible=!0,this.btn_tupo.visible=!1,void(this.item_cost.visible=!1)}var g=r.cost;this.setBar(e.strongExp,g);var p=o?o.prop:0,m=r.prop;for(h=0;h<5;h++){u=s.getChildByName("lab_"+h);var f=a.getChildByName("lab_"+h);c=S.ItemUtils.getShuXingByName(m[h][0])||S.ItemUtils.getShuXingByName(p[h][0]);if(p){d=R.ShuXingVo.getString4Vo(p[h][1],c);c=S.ItemUtils.getShuXingByName(p[h][0]),u.text=c.desc+":"+Number(d)}else u.text=c.desc+":0";if(m){var y=R.ShuXingVo.getString4Vo(m[h][1],c);c=S.ItemUtils.getShuXingByName(m[h][0]),f.text=c.desc+":"+Number(y)}else f.text=c.desc+":"+x.TextConst.get(208)}var v=o?o.need:0,_=E.GameConfig.fsequipbreachjson[v];if(i==_.limit&&n==_.level){if(!(_=E.GameConfig.fsequipbreachjson[Number(v)+1]))return void(this.lab_des.text="您已达当前突破等级上限！");this.box_strong.visible=!1,this.box_tupo.visible=!0,console.log("需要突破才可以继续升级");var C=b.RoleCenter.instans.self.bagdata.getItemCount(_.cost[0][0]),w=_.cost[0][1];this.btn_tupo.on(Laya.Event.CLICK,this,this.onTuPo,[C,w]),this.item_cost.setNeed(C,w);var I=S.ItemUtils.getItemVoById(_.cost[0][0]);this.item_cost.setNeedName(I.name,S.ItemUtils.getSmallIcon(I.icon)),this.item_cost.setQualColor(S.ItemUtils.getColorByQuality(I.quality))}else this.box_tupo.visible=!1,this.box_strong.visible=!0;this.initEquipsList()}},e.prototype.setPower=function(){var e=this.curData.strongLv,t=E.GameConfig.fsequipstrongjson[e];if(!t)return this.box_power.num_Fight.value="0";var i=t?t.need:0,n=E.GameConfig.fsequipbreachjson[i],s=0,a=t?t.prop:[],o=n.prop;a.length&&(s+=r.sbkFormula.calEquipCombat(a[0][1],a[1][1],0,0)+t.power),n.prop.length&&(s+=r.sbkFormula.calEquipCombat(o[0][1],o[1][1],0,0)+n.power),this.box_power.num_Fight.value=""+s},e.prototype.onStrong=function(){var e=new o.FSEquipStrongChgMsg;e.heroIdx=this.heroIdx,e.equpos=this.eqPos,e.curLv=this.curData.strongLv,e.curExp=this.curData.strongExp,e.equipIdArr=this.eqpuipsOrItems.equipIdArr,e.itemCount=this.eqpuipsOrItems.itemCount,(0<e.equipIdArr.length||0<e.itemCount)&&n.GSM.sendServer(e)},e.prototype.onAllStrong=function(){var e=this.list_item.array;if(this.eqpuipsOrItems.equipIdArr.length+this.eqpuipsOrItems.itemIdxArr.length==e.length)this.eqpuipsOrItems.equipIdArr=[],this.eqpuipsOrItems.equipBagIdArr=[],this.eqpuipsOrItems.itemIdxArr=[],this.eqpuipsOrItems.itemCount=0;else{this.eqpuipsOrItems.equipIdArr=[],this.eqpuipsOrItems.equipBagIdArr=[],this.eqpuipsOrItems.itemIdxArr=[];for(var t=this.eqpuipsOrItems.itemCount=0;t<e.length;t++){var i=e[t];i.equtemplet?(this.eqpuipsOrItems.equipIdArr.push(i.equid),this.eqpuipsOrItems.equipBagIdArr.push(i.equtemplet)):(this.eqpuipsOrItems.itemIdxArr.push(i.idx),this.eqpuipsOrItems.itemCount+=i.num)}}this.list_item.refresh(),console.log(this.eqpuipsOrItems),this.recheckExpAndLv()},e.prototype.setBar=function(e,t){var i=e;this.lab_cur_exp.text=""+i,this.lab_next_exp.text="/"+t,this.hbox_exp.refresh(),0==t&&(t=1);var n=this.bar_img.width/t*i;n=0==n?1:n,this.bar_panel.width=n},e.prototype.onRenderHandler=function(e,t){var i=e.item.item.lab_num,n=e.item.item.item.img_quality,s=e.item.item.item.img_item,a=e.item.item.item.img_fs_job,o=e.item.item.img_occupation,r=e.item.item_name;o.visible=!1;var l=e.dataSource;if(l.equtemplet){var h=S.ItemUtils.getFsEquipVoById(l.equtemplet);n.skin=S.ItemUtils.getQualitybjByQualityId(h.quality),s.skin=S.ItemUtils.getIconByIconId(h.icon),i.visible=!1,a.visible=!0,r.text=""+h.name,a.skin=S.ItemUtils.getfsJobIcon(this.jobId),e.img_selected.visible=-1!=this.eqpuipsOrItems.equipIdArr.indexOf(l.equid)}else{var u=l;n.skin=S.ItemUtils.getQualitybjByQualityId(u.quality),s.skin=S.ItemUtils.getIconByIconId(u.icon),i.text=""+u.num,i.visible=!0,a.visible=!1,r.text=""+u.name,e.img_selected.visible=-1!=this.eqpuipsOrItems.itemIdxArr.indexOf(l.idx)}},e.prototype.onMouseHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i,n=e.target,s=this.list_item.array[t],a=void 0;if(n.img_selected.visible=!n.img_selected.visible,s.equtemplet)if(S.ItemUtils.getFsEquipVoById(s.equtemplet),n.img_selected.visible)this.eqpuipsOrItems.equipIdArr.push(s.equid),this.eqpuipsOrItems.equipBagIdArr.push(s.equtemplet);else-1!=(i=this.eqpuipsOrItems.equipIdArr.indexOf(s.equid))&&this.eqpuipsOrItems.equipIdArr.splice(i,1);else if(a=s,n.img_selected.visible)this.eqpuipsOrItems.itemIdxArr.push(s.idx),this.eqpuipsOrItems.itemCount+=a.num;else-1!=(i=this.eqpuipsOrItems.itemIdxArr.indexOf(s.idx))&&(this.eqpuipsOrItems.itemIdxArr.splice(i,1),this.eqpuipsOrItems.itemCount-=a.num);console.log(this.eqpuipsOrItems),this.recheckExpAndLv()}},e.prototype.recheckExpAndLv=function(){for(var e=0,t=this.eqpuipsOrItems.equipIdArr,i=this.eqpuipsOrItems.equipBagIdArr,n=t.length-1;0<=n;n--){var s=i[n];S.ItemUtils.getFsEquipVoById(s);if(-1!=i.indexOf(s)){var a=E.GameConfig.fsequipjson[s].split[0][0];e+=E.GameConfig.fsequipjson[s].split[0][1]*S.ItemUtils.getItemVoById(a).effect[0][1]}}var o=S.ItemUtils.getItemVoById(8525).effect[0][1],r=this.eqpuipsOrItems.itemCount*o;e+=r;var l=this.curData.strongLv,h=E.GameConfig.fsequipstrongjson[l];h=h||{cost:0};for(var u=E.GameConfig.fsequipstrongjson[l+1],c=0,d=0;u;){if(h.cost+u.cost>=this.curData.strongExp+e){c=u.level,console.log("EXP预览 : "+e+",可以升到"+c);break}d++,h.cost+=u.cost,u=E.GameConfig.fsequipstrongjson[l+d+1]}E.GameConfig.fsequipstrongjson[l+d+1]?this.isCanUp=!0:(this.isCanUp=!1,console.log("超过最大等级了"),c=l+d),console.log("装备选中的经验是："+e+" 宝石经验是："+r),this.setNextLvProp(c,e)},e.prototype.setNextLvProp=function(e,t){this.lab_cur_exp.text=""+(t+this.curData.strongExp),this.hbox_exp.refresh(),this.lab_nextLv.text=""+(e-(this.curData.strongLv+1)),this.lab_breachLv.text="（突破"+Math.floor((e-1)/10)+"层）"},e.prototype.onClosed=function(){this.list_item.renderHandler=null,this.bgview.btn_close.off(Laya.Event.CLICK,this,this.close),this.btn_strong.off(Laya.Event.CLICK,this,this.onStrong),this.btn_allStrong.off(Laya.Event.CLICK,this,this.onAllStrong),this.list_item.mouseHandler=null,n.GSM.ins.off(o.FSEquipStrongChgMsg.KEY,this,this.onStrongSuccess),n.GSM.ins.off(o.FSEquipBreachChgMsg.KEY,this,this.onTuPoSuccess)},e.prototype.floatCombat=function(){var e=b.RoleCenter.instans.vo,t=b.RoleCenter.instans.vo.getOpenHeroByIdx(this.heroIdx);s.sbkPropTool.reSetHolyDress(t);var i=e.combat;t.combat=t.reCheckComBat(),e.combat=e.reCheckComBat();var n=e.combat-i;b.RoleCenter.instans.event(h.EventName.FIGHT_UP,n)},e}(ui.holydress.HolyDressStrongViewUI);t.HolyDressStrongView=u}),define("src/g/holydress/view/HolyDressTipsView",["require","exports","../../net/messages/feishengzhuang/sbkFeiShengZhuangMsg","../../../manager/GameSocketManager","src/g/holydress/view/HolyDressSelectView","../../../manager/RoleCenter","../../../utils/ItemUtils","src/g/holydress/view/HolyDressStrongView","../../../enum/enumItem","../../../meta/ShuXingVo","../../../config/GameConfig","../../net/messages/sbkFormula","../../accessctrl/AccessCenter","../../../utils/system/ErrCodeView","../../net/messages/ErrConst","../../../manager/AM","../../../init/Switches"],function(e,t,i,n,o,r,l,s,a,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(t){function e(){var e=t.call(this)||this;return e.btn_change.on(Laya.Event.CLICK,e,e.onChage),e.btn_strong.on(Laya.Event.CLICK,e,e.onStrong),e.btn_off.on(Laya.Event.CLICK,e,e.onOff),e.btn_get.on(Laya.Event.CLICK,e,e.onGet),e}return __extends(e,t),e.prototype.setEquipData=function(e,t,i,n){if(this.heroIdx=e,this.p_heroData=r.RoleCenter.instans.vo.getOpenHeroByIdx(this.heroIdx),this.jobId=this.p_heroData.jobid,this.eqData=i,this.box_put.visible=i?!(this.btn_get.visible=!1):!(this.btn_get.visible=!0),i)this._evo=l.ItemUtils.getFsEquipVoById(i.ins[0].equtemplet),this.combatNum=n,this.initEquip(t,i.strongLv);else{var s=Number("101"+(t-1)+"01");this._evo=l.ItemUtils.getFsEquipVoById(s);var a=this._evo.prop;this.combatNum=c.sbkFormula.calEquipCombat(a[0][1],a[1][1],a[2][1],a[3][1])+this._evo.power,this.initEquip(t)}},e.prototype.initEquip=function(e,t){this.lab_name.changeText(this._evo.name),this.lab_lv.changeText(l.ItemUtils.getEquipLv(this._evo.limit)),this.lab_pos.changeText(a.enumItem.arr_fsEquipPosNameNs[e-1]),this.lab_job.changeText(a.enumItem.arr_Job[this.jobId]),this.item_.img_item.skin=l.ItemUtils.getIconByIconId(this._evo.icon),this.item_.img_quality.skin=l.ItemUtils.getQualityBjById(this._evo.id),this.item_.img_fs_job.visible=!0,this.item_.img_fs_job.skin=l.ItemUtils.getfsJobIcon(this.jobId),this.item_.lab_num.changeText(""),this.clip_caombat.value=this.combatNum+"",this.initBaseInfo(),this.initStrongInfo(t)},e.prototype.initBaseInfo=function(){for(var e=this._evo.prop,t=0;t<e.length;t++){var i=this.vbox_base.getChildByName("box_"+t).getChildByName("base");if(i){var n=l.ItemUtils.getShuXingByName(e[t][0]);i.text=n.desc+":"+h.ShuXingVo.getString4Vo(e[t][1],n),i.color=n.color}}},e.prototype.initStrongInfo=function(e){if(!e)return this.vbox_intensify.removeSelf(),this.vbox_show.refresh(),void(this.height=this.img_bg.height=540);for(var t=u.GameConfig.fsequipstrongjson[e].prop,i=0;i<t.length;i++){var n=this.vbox_intensify.getChildByName("lab_"+i);if(n){var s=l.ItemUtils.getShuXingByName(t[i][0]);n.text=s.desc+":"+h.ShuXingVo.getString4Vo(t[i][1],s),n.color=s.color}}},e.prototype.onChage=function(){if(r.RoleCenter.instans.bagRoomEnough(10)){for(var e=r.RoleCenter.instans.self.bagdata.equBagData,t=[],i=0;i<e.length;i++){var n=e[i],s=l.ItemUtils.getFsEquipVoById(n.equtemplet);s&&(s.pos==this.eqData.pos&&s.job==this.jobId&&t.push(n))}var a=new o.HolyDressSelectView;a.setEquipsData(t),a.setCurHeroEquip(this.heroIdx,this.eqData.ins[0].equid||0,this.eqData.pos),a.popup(),this.close()}else m.AM.show(g.ErrCodeView.getErrStr(p.enumErrConst.code_2206),Laya.Handler.create(this,function(){f.Switches.ins.event(d.enumAccessId.huishou)}))},e.prototype.onStrong=function(){this.close();var e=new s.HolyDressStrongView;e.setIndex(this.eqData.pos,this.heroIdx),e.initPanelData(this.eqData),e.popup()},e.prototype.onOff=function(){if(r.RoleCenter.instans.bagRoomEnough(10)){var e=new i.PutonFSEquipC2GS;e.heroIdx=this.heroIdx,e.equipId=this.eqData.ins[0].equid,e.equipPos=this.eqData.pos,e.newEquipId=0,n.GSM.sendServer(e),this.close()}else m.AM.show(g.ErrCodeView.getErrStr(p.enumErrConst.code_2206),Laya.Handler.create(this,function(){f.Switches.ins.event(d.enumAccessId.huishou)}))},e.prototype.onGet=function(){f.Switches.ins.event(d.enumAccessId.kfzy),this.close()},e}(ui.holydress.HolyDressTipsViewUI);t.HolyDressTipsView=y}),define("src/g/holydress/view/HolyDressRecoverItem",["require","exports","../../../utils/ItemUtils","../../../utils/system/FloatEffect","../../net/messages/EquipSplitC2GS","../../../manager/GameSocketManager","../../../manager/RoleCenter","../../../core/E","../../../enum/EventName"],function(e,t,o,r,l,h,u,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e._num=1,e.btn_recover.on(Laya.Event.CLICK,e,e.onBtnRecover),e.btn_add.on(Laya.Event.CLICK,e,e.onBtnAdd),e.btn_jian.on(Laya.Event.CLICK,e,e.onBtnJian),e.check_.on(Laya.Event.CLICK,e,e.onCheckBox),e}return __extends(e,t),e.prototype.onCheckBox=function(){this.check_.selected?i.E.ins.event(n.EventName.HOLYDRESS_SELECTED,[this._datasource.id,this._num,!0]):i.E.ins.event(n.EventName.HOLYDRESS_SELECTED,[this._datasource.id,this._num,!1])},e.prototype.onBtnRecover=function(){for(var e=u.RoleCenter.instans.self.bagdata.equBagData,t=[],i=0;i<e.length;i++){var n=e[i],s=o.ItemUtils.getFsEquipVoById(n.equtemplet);s&&(s.id==this._datasource.id&&t.push(n.equid))}if(t.length=this._num,16<t.length)r.FE.upItems("最多一次分解16件装备!");else{var a=new l.EquipSplitC2GS;a.splittype=l.ESplitType.fsEquip,a.equipidarr=t,0<a.equipidarr.length&&h.GSM.sendServer(a)}},e.prototype.onBtnAdd=function(){this._num>=this._datasource.num?r.FE.upItems("已超过最大数量！"):(this._num++,this.lab_num.text=""+this._num,this.lab_reward_num.text=""+this._num*this._datasource.split[0][1],this.check_.selected&&i.E.ins.event(n.EventName.HOLYDRESS_SELECTED,[this._datasource.id,this._num,!0]))},e.prototype.onBtnJian=function(){1!=this._num?(this._num--,this.lab_num.text=""+this._num,this.lab_reward_num.text=""+this._num*this._datasource.split[0][1],this.check_.selected&&i.E.ins.event(n.EventName.HOLYDRESS_SELECTED,[this._datasource.id,this._num,!0])):r.FE.upItems("请至少选择1个！")},e.prototype.setData=function(e){this._num=1,this.check_.selected=!1;var t=this._datasource=e;this.lab_name.text=t.name,this.item_.img_item.skin=o.ItemUtils.getIconByIconId(t.icon),this.item_.img_quality.skin=o.ItemUtils.getQualitybjByQualityId(t.quality),this.lab_name.color=o.ItemUtils.getColorByQuality(t.quality),this.lab_num.text="1";var i=this._datasource.split[0][0];this.img_reward.skin=o.ItemUtils.getSmallIcon(i),this.lab_reward_num.text=""+this._num*this._datasource.split[0][1],this.item_.img_fs_job.visible=!0,this.item_.img_fs_job.skin=o.ItemUtils.getfsJobIcon(t.job)},e}(ui.holydress.HolyDressRecoverItemUI);t.HolyDressRecoverItem=s}),define("src/g/holydress/view/HolyDressRecoverView",["require","exports","../../../manager/RoleCenter","../../../utils/ItemUtils","../../../core/E","../../../enum/EventName","src/g/holydress/view/HolyDressRecoverItem","../../net/messages/EquipSplitC2GS","../../../manager/GameSocketManager","../../../utils/system/FloatEffect"],function(e,t,h,u,i,n,s,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function e(){var e=t.call(this)||this;return e.eqDataHash={},e.view_bg.btn_back.visible=!1,e.view_bg.btn_back.on(Laya.Event.CLICK,e,e.close),e.view_bg.btn_close.on(Laya.Event.CLICK,e,e.close),e.list_.renderHandler=new Laya.Handler(e,e.listRenderHandler),e.list_.itemRender=s.HolyDressRecoverItem,e.btn_all_recover.on(Laya.Event.CLICK,e,e.onAllRecover),i.E.ins.on(n.EventName.HOLYDRESS_SELECTED,e,e.onHolyDressSelected),i.E.ins.on(n.EventName.EQUIPSPLITOVER,e,e.onEquipSplit),e}return __extends(e,t),e.prototype.initEquipsList=function(e){this._heroIdx=e,this.p_heroData=h.RoleCenter.instans.vo.getOpenHeroByIdx(this._heroIdx),this.jobId=this.p_heroData.jobid;for(var t={},i=h.RoleCenter.instans.self.bagdata.equBagData,n=[],s=0;s<i.length;s++){var a=i[s],o=u.ItemUtils.getFsEquipVoById(a.equtemplet);o&&(o.job==this.jobId&&1!=o.pos&&2!=o.pos&&(t[""+o.id]=t[""+o.id]?++t[""+o.id]:1,-1==n.indexOf(o)&&n.push(o)))}this.setEquipsData(n,t)},e.prototype.onEquipSplit=function(){this.eqDataHash={},this.initEquipsList(this._heroIdx)},e.prototype.onAllRecover=function(){var e=[];for(var t in this.eqDataHash)if(this.eqDataHash.hasOwnProperty(t)){var i=this.eqDataHash[t];if(0<i.length)for(var n=0;n<i.length;n++){var s=i[n];e.push(s)}}if(16<e.length)l.FE.upItems("最多一次分解16件装备!");else{var a=new o.EquipSplitC2GS;a.splittype=o.ESplitType.fsEquip,a.equipidarr=e,0<a.equipidarr.length&&r.GSM.sendServer(a)}},e.prototype.onHolyDressSelected=function(e,t,i){for(var n=this.eqDataHash,s=h.RoleCenter.instans.self.bagdata.equBagData,a=[],o=0;o<s.length;o++){var r=s[o],l=u.ItemUtils.getFsEquipVoById(r.equtemplet);l&&(l.id==e&&a.push(r.equid))}n[""+e]=a,i?n[""+e].length=t:n[""+e]=[],console.log(n),this.eqDataHash=n},e.prototype.setEquipsData=function(e,t){0<e.length&&e.sort(function(e,t){return t.quality-e.quality});for(var i=0;i<e.length;i++){var n=e[i];n.num=t[n.id]}this.list_.array=e},e.prototype.listRenderHandler=function(e,t){e.setData(e.dataSource)},e.prototype.onClosed=function(){this.list_.renderHandler=null,this.list_.itemRender=null,this.btn_all_recover.off(Laya.Event.CLICK,this,this.onAllRecover),i.E.ins.off(n.EventName.HOLYDRESS_SELECTED,this,this.onHolyDressSelected),i.E.ins.off(n.EventName.EQUIPSPLITOVER,this,this.onEquipSplit)},e}(ui.holydress.HolyDressRecoverViewUI);t.HolyDressRecoverView=a}),define("src/g/holydress/view/HolyDressTZTipsView",["require","exports","../../../meta/FsEquipSuitVo","../../../utils/ItemUtils","../../../meta/QualiyVo","../../../meta/ShuXingVo","../../../enum/enumItem","../../net/messages/sbkFormula","../../../manager/RoleCenter"],function(e,t,o,d,g,s,p,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setData=function(e,t){this.height=this.img_bg.height=e?650:(this.vbox_title.visible=this.hbox_next.visible=this.vbox_next.visible=!1,460),e=e||1;var i=o.FsEquipSuitStruct.Ins.getFsEquipSuitVoByType(t+1);for(var n in i)if(i.hasOwnProperty(n)){var s=i[n],a=i[""+(Number(n)+1)];if(e!=s.limitlv)continue;this.fsEquipSuit=s,this.nextFsEquipSuit=a||s}this.lab_name.text=this.fsEquipSuit.name,this.setFight(),this.setIcon(0),this.setIcon(1),this.initBaseInfo(),this.initNextInfo()},t.prototype.initBaseInfo=function(){for(var e=this.fsEquipSuit.prop,t=0;t<e.length;t++){var i=this.vbox_base.getChildByName("lab_"+t);if(i){var n=d.ItemUtils.getShuXingByName(e[t][0]);n&&(i.text=n.desc+":"+s.ShuXingVo.getString4Vo(e[t][1],n),i.color=n.color,4!=t&&5!=t||(i.text=n.desc+":"+s.ShuXingVo.getString4Vo(e[t][1]/100,n)+"%"))}}},t.prototype.initNextInfo=function(){var e=this.nextFsEquipSuit.prop;this.lab_next_name.text=this.nextFsEquipSuit.name;for(var t=0;t<e.length;t++){var i=this.vbox_next.getChildByName("lab_"+t);if(i){var n=d.ItemUtils.getShuXingByName(e[t][0]);n&&(i.text=n.desc+":"+s.ShuXingVo.getString4Vo(e[t][1],n),i.color="#8b8070",4!=t&&5!=t||(i.text=n.desc+":"+s.ShuXingVo.getString4Vo(e[t][1]/100,n)+"%"))}}},t.prototype.setEquipsData=function(e,t){this._equips=e,this.p_heroIdx=t,this.p_heroData=n.RoleCenter.instans.vo.getOpenHeroByIdx(this.p_heroIdx),this.jobId=this.p_heroData.jobid},t.prototype.setIcon=function(e){var t=this.fsEquipSuit.need[e],i=this._equips[t-1].ins[0]?this._equips[t-1].ins[0].equtemplet:0,n=0<i,s=d.ItemUtils.getFsEquipVoById(i);s||(n=!1);var a=n?d.ItemUtils.getIconByIconId(s.icon):"res/custom/equipIcon/fs_equip_"+ktgame.RoleDefineMod.arr_fs_equipPosConst[t-1]+".png",o=n?"#b98e42":"#8b8070",r=this["item_"+(e+1)];r.img_item.skin=a;var l=n?s.quality:1,h=g.QualityStruct.Ins.getQPicById(l);r.img_quality.skin="res/custom/"+h+".png",r.img_fs_job.visible=!0,r.img_fs_job.skin=d.ItemUtils.getfsJobIcon(this.jobId);var u=this["lab_pos1"+e],c=this["lab_pos2"+e];u.text=p.enumItem.arr_fsEquipPosNameNs[t-1],u.color=o,c.text=p.enumItem.arr_fsEquipPosNameNs[t-1]},t.prototype.setFight=function(){var e=this.fsEquipSuit.prop;this.clip_fight.value=i.sbkFormula.calEquipCombat(e[0][1],e[1][1],e[2][1],e[3][1])+""},t}(ui.holydress.HolyDressTZTipsViewUI);t.HolyDressTZTipsView=a}),define("src/g/holydress/view/HolyDressAllPropTipsView",["require","exports","../../../meta/FsEquipSuitVo","../../../utils/ItemUtils","../../../manager/RoleCenter","../../../config/GameConfig","../../../meta/ShuXingVo"],function(e,t,S,E,R,x,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.regularArr=[0,0,0,0,0,0],e.rateArr=[0,0,0,0,0,0,0,0,0,0],e}return __extends(e,t),e.prototype.setData=function(){for(var e=R.RoleCenter.instans.vo,t=this.rateArr,i=this.regularArr,n=0;n<e.heronum;n++){for(var s=e.getOpenHeroByIdx(n).fshData,a=s.equpos,o=s.equipSuitLvArr,r=0;r<o.length;r++){var l=o[r],h=r+1;if(l){for(var u=S.FsEquipSuitStruct.Ins.getFsEquipSuitVoByTypeAndLv(h,l).prop,c=0;c<u.length;c++){var d=u[c][0],g=u[c][1];switch(d){case"FSEQUIP1":t[0]+=g/100;break;case"FSEQUIP2":t[1]+=g/100;break;case"FSEQUIP3":t[2]+=g/100;break;case"FSEQUIP4":t[3]+=g/100;break;case"FSEQUIP5":t[4]+=g/100;break;case"FSEQUIP6":t[5]+=g/100;break;case"FSEQUIP7":t[6]+=g/100;break;case"FSEQUIP8":t[7]+=g/100;break;case"FSEQUIP9":t[8]+=g/100;break;case"FSEQUIP10":t[9]+=g/100}}i[0]+=u[0][1],i[1]+=u[1][1],i[2]+=u[2][1],i[3]+=u[3][1]}}for(var p=0;p<a.length;p++){var m=a[p].ins[0];if(m){var f=E.ItemUtils.getFsEquipVoById(m.equtemplet).prop;i[0]+=f[0][1],i[1]+=f[1][1],i[2]+=f[2][1],i[3]+=f[3][1];var y=E.ItemUtils.getShuXingByName(f[4][0]);"JFHURT"==y.name?i[5]+=Number(L.ShuXingVo.getString4Vo(f[4][1],y)):"REXUEHURT"==y.name&&(i[4]+=Number(L.ShuXingVo.getString4Vo(f[4][1],y)));var v=a[p].strongLv,_=a[p].breachLv,C=x.GameConfig.fsequipstrongjson[v],w=x.GameConfig.fsequipbreachjson[_],I=C?C.prop:[],b=w.prop;I.length&&(i[0]+=I[0][1],i[1]+=I[1][1]),b.length&&(i[0]+=b[0][1],i[1]+=b[1][1])}}}this.rateArr=t,this.regularArr=i,console.log("rate",this.rateArr),console.log("regular",this.regularArr),this.setText()},e.prototype.setText=function(){for(var e=R.RoleCenter.instans.vo,t=0;t<3;t++)this.lab_score0.text=e.getAllShengZhanPF(),this.lab_score1.text=e.getAllShengMoPF(),this.lab_score2.text=e.getAllShengDaoPF();for(t=0;t<6;t++)this["lab_prop_"+t].text=this.regularArr[t];for(t=1;t<=10;t++)this["lab_add_"+t].text=this.rateArr[t-1]+"%"},e}(ui.holydress.HolyDressAllPropTipsViewUI);t.HolyDressAllPropTipsView=i}),define("src/g/holydress/view/HolyDressView",["require","exports","../../../manager/RoleCenter","../../Effects/UIEffectsFactory","../../../meta/QualiyVo","../../../utils/ItemUtils","src/g/holydress/view/HolyDressSelectView","src/g/holydress/view/HolyDressTipsView","src/g/holydress/view/HolyDressRecoverView","src/g/holydress/view/HolyDressTZTipsView","../../accessctrl/AccessCenter","../../../vo/RedDot/RedDot_HolyDress","../../net/messages/sbkFormula","../../../meta/FsEquipSuitVo","src/g/holydress/view/HolyDressAllPropTipsView","../../../init/Switches"],function(e,t,l,g,p,m,h,u,i,n,s,a,f,y,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){function e(){var e=t.call(this)||this;return e.eqRedArr=[],e.posCombatArr=[],e.addEvent(),e}return __extends(e,t),e.prototype.addEvent=function(){this.btn_hecheng.on(Laya.Event.CLICK,this,this.onBtnHeCheng),this.btn_fenjie.on(Laya.Event.CLICK,this,this.onBtnFenJie),this.btn_zong.on(Laya.Event.CLICK,this,this.onBtnZong);for(var e=0;e<5;e++){this["taozhuang_"+(e+1)].on(Laya.Event.CLICK,this,this.onBtnTaoZhuang,[e])}},e.prototype.onBtnZong=function(){console.log("总属性");var e=new o.HolyDressAllPropTipsView;e.setData(),e.popup()},e.prototype.onBtnTaoZhuang=function(e){var t=this.p_heroData.fsEqSuitLvArr[e],i=new n.HolyDressTZTipsView;i.setEquipsData(this.p_heroData.fsequpos,this.p_heroIdx),i.setData(t,e),i.popup()},e.prototype.offEvent=function(){},e.prototype.onBtnHeCheng=function(){console.log("点击合成"),r.Switches.ins.event(s.enumAccessId.shengzhaungHeCheng)},e.prototype.onBtnFenJie=function(){var e=new i.HolyDressRecoverView;e.initEquipsList(this.p_heroIdx),e.popup()},e.prototype.showView=function(){},e.prototype.updatePanelData=function(){},e.prototype.showData=function(e){this.p_heroIdx=e,this.p_heroData=l.RoleCenter.instans.vo.getOpenHeroByIdx(this.p_heroIdx),this.jobId=this.p_heroData.jobid,this.initShow(),console.log("圣装相关",this.p_heroData.fsequpos),console.log("圣装相关",this.p_heroData.fsEqSuitLvArr),console.log("sdsdsdooooo",this.p_heroData.allPosPower),this.calCombat()},e.prototype.initShow=function(){this.eqRedArr=a.RedDot_HolyDress.Ins.getRedArrByHeroIdx(this.p_heroIdx),this.initEquip(this.p_heroData.fsequpos),this.initTaoZhuangBtn()},e.prototype.initTaoZhuangBtn=function(){for(var e=this.p_heroData.fsEqSuitLvArr,t=0;t<e.length;t++){this["taozhuang_"+(t+1)].skin=e[t]?"res/holydress/tz_1"+(t+1)+".png":"res/holydress/tz_2"+(t+1)+".png"}},e.prototype.initEquip=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=i.pos-1,s=this.getChildByName("equip_"+ktgame.RoleDefineMod.arr_fs_equipPosConst[n]);if(s){s.lab_ItemName.visible=!1,s.setClieckHD(null);var a=i.ins[0]?i.ins[0].equtemplet:0,o=new Laya.Handler(this,this.equipClick,[i]);s.setClieckHD(o),s.showTip(!1);var r=0<a,l=m.ItemUtils.getFsEquipVoById(a);l||(r=!1);var h=r?m.ItemUtils.getIconByIconId(l.icon):"res/custom/equipIcon/fs_equip_"+ktgame.RoleDefineMod.arr_fs_equipPosConst[n]+".png";s.setName(r?m.ItemUtils.getEquipLv(l.limit):"");var u,c=r?l.quality:1;for(s.setTrait(c,p.QualityStruct.Ins.getQPicById(c)),s.setEnhance(r?i.strongLv:0);0<s.qualAni.numChildren;)(u=s.qualAni.removeChildAt(s.qualAni.numChildren-1))&&u.destroy();if(l&&5<=l.quality){var d=p.QualityStruct.Ins.getQEffById(l.quality);u=g.UIEffectsFactory.Ins.createUIAniById(d,!0),g.UIEffectsFactory.Ins.centered4Parent(u,s.qualAni,!0),u.play()}s.showIcon(h),s.img_god.visible=s.lab_soul.visible=!1,s.showTip(this.eqRedArr[t]),s.img_fs_job.visible=!0,s.img_fs_job.skin=r?m.ItemUtils.getfsJobIcon(this.jobId):"",s.lab_soul.text=r?l.limit+"阶":"",s.lab_soul.visible=r}}},e.prototype.equipClick=function(e){console.log(e),e.ins[0]?this.hasDress(e):this.noDress(e)},e.prototype.noDress=function(e){for(var t,i=e.pos,n=l.RoleCenter.instans.self.bagdata.equBagData,s=[],a=0;a<n.length;a++){var o=n[a],r=m.ItemUtils.getFsEquipVoById(o.equtemplet);r&&(r.pos==i&&r.job==this.jobId&&s.push(o))}0<s.length?((t=new h.HolyDressSelectView).setEquipsData(s),t.setCurHeroEquip(this.p_heroIdx,0,i),t.popup()):((t=new u.HolyDressTipsView).setEquipData(this.p_heroIdx,i),t.popup())},e.prototype.hasDress=function(e){var t=new u.HolyDressTipsView;t.setEquipData(this.p_heroIdx,e.pos,e,this.posCombatArr[e.pos-1]),t.popup()},e.prototype.calCombat=function(){for(var e=this.p_heroData.fsequpos,t=this.p_heroData.fsEqSuitLvArr,i=0,n=[0,0,0,0,0,0,0,0,0,0],s=0;s<t.length;s++){var a=t[s],o=s+1;if(a){for(var r=y.FsEquipSuitStruct.Ins.getFsEquipSuitVoByTypeAndLv(o,a).prop,l=0;l<r.length;l++){var h=r[l][0],u=r[l][1];switch(h){case"FSEQUIP1":n[0]=u/1e4;break;case"FSEQUIP2":n[1]=u/1e4;break;case"FSEQUIP3":n[2]=u/1e4;break;case"FSEQUIP4":n[3]=u/1e4;break;case"FSEQUIP5":n[4]=u/1e4;break;case"FSEQUIP6":n[5]=u/1e4;break;case"FSEQUIP7":n[6]=u/1e4;break;case"FSEQUIP8":n[7]=u/1e4;break;case"FSEQUIP9":n[8]=u/1e4;break;case"FSEQUIP10":n[9]=u/1e4}}i+=f.sbkFormula.calEquipCombat(r[0][1],r[1][1],r[2][1],r[3][1])}}console.log("战力rate",n);for(s=0;s<e.length;s++){var c=e[s].ins[0];if(c){var d=m.ItemUtils.getFsEquipVoById(c.equtemplet),g=d.prop,p=Math.floor(f.sbkFormula.calEquipCombat(g[0][1],g[1][1],g[2][1],g[3][1])*(1+n[s]))+d.power;i+=this.posCombatArr[s]=p}}this.box_fight.num_Fight.value=i+""},e}(ui.holydress.HolyDressViewUI);t.HolyDressView=c}),define("src/g/holydress/ctrl/HolyDressCtrl",["require","exports","../../base/BaseCtrl","../../clearRes/ClearResM","src/g/holydress/view/HolyDressView","../../../manager/RoleCenter","../../../manager/GameSocketManager","../../net/messages/feishengzhuang/sbkFeiShengZhuangMsg","../../../core/E","../../../enum/EventName","../../../utils/RoleUtil","../../net/messages/sbkEquipIns","../../../utils/ItemUtils","../../../vo/RedDot/RedDot_HolyDress","../../../vo/RedDot/EventRedDot","../../../plugin/sbkPropTool","../../../init/ResManager"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(t){function e(){var e=t.call(this)||this;return e._nowSelectHero=0,e}return __extends(e,t),e.prototype.init=function(){this._view=new s.HolyDressView},e.prototype.showPage=function(e,t){this._view||this.init(),e.removeChildren(),e.addChild(this._view),this.addEvent(),this._view.showView(),n.ClearResM.resetViewImg(this._view),f.ResManager.getInstance().showRolePageCtrl(this)},e.prototype.changePerson=function(e,t){if(this._nowSelectHero=e,this._view){this.refreshData(),console.log(a.RoleCenter.instans.self.openhero[this._nowSelectHero].fshData);var i=this._view.role_show,n=a.RoleCenter.instans.vo.getOpenHeroByIdx(e);u.RoleUtil.refreshZww(n,120,i.wing,i.weapon,i.role,i.ani_fumo)}},e.prototype.addEvent=function(){o.GSM.ins.on(r.updateFSEquipPosGS2C.KEY,this,this.onUpdateFSEquipPosGS2C),o.GSM.ins.on(r.FSEquipSuitGS2C.KEY,this,this.onFSEquipSuitGS2C),l.E.ins.on(p.EventRedDot.REFRESH_HOLYDRESS,this,this.refreshData),l.E.ins.on(h.EventName.EQUIPSPLITOVER,this,this.onEquipSplit),this._view.on(Laya.Event.REMOVED,this,this.onRemoved)},e.prototype.onRemoved=function(){this._view.off(Laya.Event.REMOVED,this,this.onRemoved)},e.prototype.onFSEquipSuitGS2C=function(e){a.RoleCenter.instans.vo.getOpenHeroByIdx(e.heroIdx).fsEqSuitLvArr=e.suitLvArr,this._view.displayedInStage&&this.refreshData(e.heroIdx),l.E.ins.event(p.EventRedDot.REFRESH_HOLYDRESS)},e.prototype.onEquipSplit=function(){this._view.displayedInStage&&this.refreshData(),this.floatCombat(),l.E.ins.event(p.EventRedDot.REFRESH_HOLYDRESS)},e.prototype.onUpdateFSEquipPosGS2C=function(e){console.log(e),a.RoleCenter.instans.vo.getOpenHeroByIdx(e.heroIdx).fsequpos[e.fsEqu.pos-1]=e.fsEqu,this.refreshData(e.heroIdx),this.floatCombat(),l.E.ins.event(p.EventRedDot.REFRESH_HOLYDRESS)},e.prototype.refreshData=function(e){g.RedDot_HolyDress.Ins.checkHolyDress(),this.refreshFsProp(e),this._view&&this._view.showData(this._nowSelectHero)},e.prototype.refreshFsProp=function(e){if(e+1)for(var t=a.RoleCenter.instans.vo.getOpenHeroByIdx(e).fsequpos,i=0;i<t.length;i++){var n=t[i].ins[0];if(n){var s=d.ItemUtils.getFsEquipVoById(n.equtemplet);s&&(n.fsProp=new c.fsEquipProp,s.setPF(n.fsProp))}}},e.prototype.floatCombat=function(){var e=a.RoleCenter.instans.vo,t=a.RoleCenter.instans.vo.getOpenHeroByIdx(this._nowSelectHero);m.sbkPropTool.reSetHolyDress(t);var i=e.combat;t.combat=t.reCheckComBat(),e.combat=e.reCheckComBat();var n=e.combat-i;a.RoleCenter.instans.event(h.EventName.FIGHT_UP,n)},e.prototype.getTitle=function(){return"res/title/title_shengzhuang.png"},e.prototype.hidePage=function(){f.ResManager.getInstance().hidePageCtrl(this)},e.prototype.destroyPage=function(){f.ResManager.getInstance().destroyPageCtrl(this)},e}(i.BaseCtrl);t.HolyDressCtrl=y}),define("src/g/holydress/ctrl/HolyDressMainCtrl",["require","exports","../../base/BaseCtrl","../../accessctrl/AccessCenter","../../clearRes/ClearResM","../../../enum/EventName","../../../core/E","../../proxy/MultiLevelUIProxy","../../../utils/ItemUtils","../../../manager/RuledescManager","../../../enum/BagItemType","src/g/holydress/view/HolyDressMainView","src/g/holydress/ctrl/HolyDressCtrl","../../../manager/RoleCenter","../../../vo/RedDot/RedDot_TwoBlade","../../../vo/RedDot/EventRedDot","../../../vo/RedDot/RedDot_HolyDress","../../feisheng/ctrl/FeishengCtrl","../../zhanyu/ctrl/ZhanyuCtrl","../../net/messages/sbkEquipIns","../../../init/Switches","../../twoBlade/ctrl/TwoBladeCtrl"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=function(i){function e(){var e=i.call(this)||this;e._flyup=new y.FeishengCtrl,e._kfzyctrl=new v.ZhanyuCtrl,e._nowSelectHero=0,e.curIndex=0,e.urls=["res/atlas/res/holydress.json","res/atlas/res/twoBlade.json"];var t=C.Switches.ins;return t.on(n.enumAccessId.feisheng,e,e.onOpenHandler,[n.enumAccessId.feisheng]),t.on(n.enumAccessId.shengzhuang,e,e.onOpenHandler,[n.enumAccessId.shengzhuang]),t.on(n.enumAccessId.shuangren,e,e.onOpenHandler,[n.enumAccessId.shuangren]),t.on(n.enumAccessId.kfzy,e,e.onOpenHandler,[n.enumAccessId.kfzy]),o.E.ins.on(a.EventName.CHANGEITEM_COUNT,e,e.onChangeItem),o.E.ins.on(m.EventRedDot.REFRESH_TWOBLADE,e,e.refreshHead),o.E.ins.on(m.EventRedDot.REFRESH_HOLYDRESS,e,e.refreshHead),o.E.ins.once(a.EventName.INIT_SELFSETOVER,e,e.dataInited),e}return __extends(e,i),e.prototype.dataInited=function(){for(var e=g.RoleCenter.instans.vo.heronum,t=0;t<e;t++)this.refreshFsProp(t)},e.prototype.refreshFsProp=function(e){if(e+1)for(var t=g.RoleCenter.instans.vo.getOpenHeroByIdx(e).fsequpos,i=0;i<t.length;i++){var n=t[i].ins[0];if(n){var s=l.ItemUtils.getFsEquipVoById(n.equtemplet);s&&(n.fsProp=new _.fsEquipProp,s.setPF(n.fsProp))}}},e.prototype.onChangeItem=function(e){var t=l.ItemUtils.getItemVoById(e);t&&(t.type==u.BagItemType.shuangren&&(p.RedDot_TwoBlade.Ins.checkTwoBlade(),this.refreshHead()))},e.prototype.onOpenHandler=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this.openId=e,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenRoleView(this.openId)},e.prototype.realOpenRoleView=function(e){this._view||this.initView(),this.addUIEvent(),this._tabProxy.open(e),this._view.showView(),s.ClearResM.resetViewImg(this._view),o.E.ins.on(a.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),this._view.tab_head.initData(g.RoleCenter.instans.self.openhero,0,g.RoleCenter.instans.vo)},e.prototype.onClick=function(e){h.RuledescManager.showRuledesc(e)},e.prototype.addUIEvent=function(){this._view.view_bg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_help.visible=!0,this._tabProxy||(this._tabProxy=new r.MultiLevelUIProxy,this._tabProxy.registerTab(this._view.tab_page,0),this._tabProxy.registerTagIndex(n.enumAccessId.feisheng,0),this._tabProxy.registerTagIndex(n.enumAccessId.shengzhuang,1),this._tabProxy.registerTagIndex(n.enumAccessId.shuangren,2),this._tabProxy.registerTagIndex(n.enumAccessId.kfzy,3),this._tabProxy.selectHandler=new Laya.Handler(this,this.onChangePage)),this._view.tab_head.setCallbackHandler(new Laya.Handler(this,this.HeroSelect)),this._view.on(Laya.Event.REMOVED,this,this.onClose),this._view.view_bg.btn_help.on(Laya.Event.CLICK,this,this.helpHandler)},e.prototype.helpHandler=function(){h.RuledescManager.showRuledesc(n.enumAccessId.kfzy)},e.prototype.onChangePage=function(e){switch(void 0===e&&(e=0),this._view.tab_head.visible=!0,this._view.view_bg.btn_help.visible=!1,e){case 0:this._page=this._flyup,this._view.tab_head.visible=!1;break;case 1:this._page=this._holydress;break;case 2:this._page=this._twoBlade;break;case 3:this._view.tab_head.visible=!1,this._page=this._kfzyctrl,this._view.view_bg.btn_help.visible=!0}this._page.showPage(this._view.view_bg.box_page),this._page.changePerson(this._nowSelectHero),this._view.tab_head.setSelectIndex(this._nowSelectHero),this._view.view_bg.img_title.skin=this._page.getTitle(),this.refreshHead()},e.prototype.refreshHead=function(){if(null!=this._view&&this._view.displayedInStage)switch(this._view.tab_page.selectedIndex){case 0:break;case 1:f.RedDot_HolyDress.Ins.checkHolyDress();var e=f.RedDot_HolyDress.Ins.getHeadRedArr();this._view.tab_head.refreshHeadRedHint(e);break;case 2:this._view.tab_head.refreshHeadRedHint(p.RedDot_TwoBlade.Ins.getTwoBladeArr(!0))}},e.prototype.HeroSelect=function(e,t){g.RoleCenter.instans.vo.heronum>e?(this._nowSelectHero=e,this._view.tab_head.setSelectIndex(e),this._holydress.changePerson(e),this._twoBlade.changePerson(e),this._nowSelectHero==this.curIndex?this.curIndex=this._nowSelectHero:this._nowSelectHero>this.curIndex?(this.curIndex=this._nowSelectHero,o.E.ins.event(a.EventName.HERO_TWEENL)):this._nowSelectHero<this.curIndex&&(this.curIndex=this._nowSelectHero,o.E.ins.event(a.EventName.HERO_TWEENR))):C.Switches.ins.event(n.enumAccessId.partner)},e.prototype.HeroHuaDong=function(e){g.RoleCenter.instans.vo.heronum<=e||(this._nowSelectHero=e,this._view.tab_head.setSelectIndex(e),this._holydress.changePerson(e),this._nowSelectHero==this.curIndex?this.curIndex=this._nowSelectHero:this._nowSelectHero>this.curIndex?(this.curIndex=this._nowSelectHero,o.E.ins.event(a.EventName.HERO_TWEENL)):this._nowSelectHero<this.curIndex&&(this.curIndex=this._nowSelectHero,o.E.ins.event(a.EventName.HERO_TWEENR)))},e.prototype.initView=function(){this._view=new c.HolyDressMainView,this._holydress=new d.HolyDressCtrl,this._twoBlade=new w.TwoBladeCtrl},e.prototype.closeClearRes=function(){o.E.ins.off(a.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),this.clearCtrlRes(),s.ClearResM.clearResFolder("holydress/"),s.ClearResM.clearResFolder("twoBlade/")},e.prototype.onClose=function(){this._view.view_bg.btn_back.off(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_close.off(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_help.off(Laya.Event.CLICK,this,this.onClick),this._view.destroyView()},e}(i.BaseCtrl);t.HolyDressMainCtrl=I}),define("src/g/holydress/view/HolyDressComposeView",["require","exports","../../../manager/RoleCenter","../../../utils/ItemUtils","../../../utils/ItemCellUtils","../../net/messages/feishengzhuang/sbkFeiShengZhuangMsg","../../../utils/system/FloatEffect","../../../manager/GameSocketManager","../../../meta/ShuXingVo","../../net/messages/sbkFormula","../../net/messages/InventoryAddGS2C","../../../manager/LayerManager","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../bag/tips/view/ItemTips","../../bag/vo/BagDataVo"],function(e,t,g,p,m,i,n,s,r,l,a,o,h,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){function e(){var e=t.call(this)||this;return e.stageLvArr=[10,15,20,25],e.eqHeroArr=[101e3,102e3,103e3],e.eqPosArr=[0,100],e.nowIdx=1,e.nowStageIdx=1,e.nowHeroJob=1,e.canCompose=!1,e.addEvent(),e}return __extends(e,t),e.prototype.showView=function(e){void 0===e&&(e=!1),o.LayerManager.addInPOPWindowLayer(this,e),this.select(this.nowIdx),this.setTitle()},e.prototype.hideView=function(){this.removeSelf()},e.prototype.destroyView=function(){this.hideView()},e.prototype.setTitle=function(){this.view_bg.img_title.skin="res/title/holydressCompose.png"},e.prototype.addEvent=function(){for(var e=1;e<=6;e++){this["select_"+e].on(Laya.Event.CLICK,this,this.select,[e])}for(e=1;e<=4;e++){this["stage"+e].on(Laya.Event.CLICK,this,this.selectStage,[e])}this.btn_up.on(Laya.Event.CLICK,this,this.onCompose),s.GSM.ins.on(a.InventoryAddGS2C.KEY,this,this.receiveMsg),this.on(Laya.Event.UNDISPLAY,this,this.removeHandler),this.img_icon.on(Laya.Event.CLICK,this,this.clickIcon,[!1]);for(e=1;e<=3;e++){this["eq_"+e].on(Laya.Event.CLICK,this,this.clickIcon,[!0])}},e.prototype.offEvent=function(){},e.prototype.clickIcon=function(e){void 0===e&&(e=!1);var t=new d.BagDataVo,i=p.ItemUtils.getFsEquipVoById(this.targetEqutemplet);t.fsEquipVo=i,e&&(t.fsEquipVo=p.ItemUtils.getFsEquipVoById(this.needEqtemplate)),c.ItemTips.ins.showTips(t)},e.prototype.select=function(e){if(!isNaN(e)){this.nowIdx=e,this.selectStage(this.nowStageIdx);var t=this["select_"+e];this.img_S.x=t.x-3,this.img_S.y=t.y-3}},e.prototype.selectStage=function(e){if(!isNaN(e)){this.nowStageIdx=e,this.renderNeedEq();var t=this["stage"+e];this.img_stageS.x=t.x,this.img_stageS.y=t.y}},e.prototype.renderNeedEq=function(){var e=this.getEqtemplet();this.targetEqutemplet=e,console.log("eefdefef",e);var t=p.ItemUtils.getFsEquipVoById(e);if(t&&t.worth){var i=+t.worth[0][0];this.needEqtemplate=i;for(var n={},s=g.RoleCenter.instans.self.bagdata.equBagData,a=[],o=[],r=0,l=0;l<s.length;l++){var h=s[l],u=p.ItemUtils.getFsEquipVoById(h.equtemplet);u&&u.worth&&(u.job==this.nowHeroJob&&u.id==i&&(n[""+u.id]=n[""+u.id]?++n[""+u.id]:1,a.push(u),o.push(h.equid),r+=1))}this.equipIdArr=o;var c=p.ItemUtils.getFsEquipVoById(i);for(l=1;l<=3;l++){var d=this["eq_"+l];m.ItemCellUtils.fillCellForItemNameView(d,i,1),d.item_name.text="",this["lab_has"+l].color=l<=r?(this["lab_has"+l].text="1","#03bb00"):(this["lab_has"+l].text="0","#ff0f15"),this["lab_stage"+l].text=c.limit+"阶"}this.updateCost(t.worth[3][0],t.worth[3][1]),this.updateShuXin(i,e),this.updateIcon(i)}},e.prototype.updateIcon=function(e){var t=p.ItemUtils.getItemOrEq(e);null!=t?this.img_icon.skin=p.ItemUtils.getIconByIconId(t.icon):console.error("yxq:道具ID错误"+e)},e.prototype.updateCost=function(e,t){var i=p.ItemUtils.getItemVoById(e);this.item_cost.setNeedName(i.name,p.ItemUtils.getSmallIcon(i.icon)),this.item_cost.setQualColor(p.ItemUtils.getColorByQuality(i.quality));var n=g.RoleCenter.instans.vo.bagdata.getItemCount(+e);this.item_cost.setNeed(n,t),this.item_cost.visible=!0,this.btn_up.disabled=!1,this.item_cost.lab_jump.visible=!1,this.canCompose=t<=n},e.prototype.updateShuXin=function(e,t){var i=p.ItemUtils.getFsEquipVoById(e),n=p.ItemUtils.getFsEquipVoById(t);if(i&&n){this.clip_now.value=l.sbkFormula.calEquipCombat(i.prop[0][1],i.prop[1][1],i.prop[2][1],i.prop[3][1])+i.power+"",this.clip_next.value=l.sbkFormula.calEquipCombat(n.prop[0][1],n.prop[1][1],n.prop[2][1],n.prop[3][1])+"";for(var s=0;s<i.prop.length;s++){var a=this["lab_now_"+s],o=this["lab_next_"+s];a.text=r.ShuXingVo.getString4Vo(i.prop[s][1],p.ItemUtils.getShuXingByName(i.prop[s][0]),!0),o.text=r.ShuXingVo.getString4Vo(n.prop[s][1],p.ItemUtils.getShuXingByName(n.prop[s][0]),!0),a.color=p.ItemUtils.getShuXingColorByName(i.prop[s][0])+"",o.color=p.ItemUtils.getShuXingColorByName(n.prop[s][0])+""}}},e.prototype.onCompose=function(){if(3<=this.equipIdArr.length&&this.canCompose){var e=new i.CompoundFSEquipC2GS;e.equipCfgId=this.targetEqutemplet,e.equipIdArr=this.equipIdArr.slice(0,3),s.GSM.sendServer(e)}else n.FE.upItems("合成材料不足")},e.prototype.getEqtemplet=function(){var e=this.nowIdx,t=this.nowStageIdx,i=-1,n=-1,s=1;switch(e){case 1:n=i=0,s=1;break;case 2:i=0,s=n=1;break;case 3:i=1,n=0,s=2;break;case 4:n=i=1,s=2;break;case 5:i=2,n=0,s=3;break;case 6:i=2,n=1,s=3}return this.nowHeroJob=s,this.eqHeroArr[i]+this.stageLvArr[t-1]+this.eqPosArr[n]},e.prototype.receiveMsg=function(e){this.select(this.nowIdx),h.UIEffectsFactory.Ins.playAniOnce(u.UIEffectsEnum.wingcomp,this.aniSp)},e.prototype.removeHandler=function(){s.GSM.ins.off(a.InventoryAddGS2C.KEY,this,this.receiveMsg)},e}(ui.holydress.HolyDressComposeViewUI);t.HolyDressComposeView=f}),define("src/g/holydress/ctrl/HolyDressComposeCtrl",["require","exports","../../base/BaseCtrl","../../accessctrl/AccessCenter","../../clearRes/ClearResM","../../../enum/EventName","../../../core/E","../../../manager/RuledescManager","src/g/holydress/view/HolyDressComposeView","../../../init/Switches"],function(e,t,i,n,s,a,o,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(){var e=t.call(this)||this;return e.urls=["res/atlas/res/holydress.json"],h.Switches.ins.on(n.enumAccessId.shengzhaungHeCheng,e,e.onOpenHandler,[n.enumAccessId.shengzhaungHeCheng]),e}return __extends(e,t),e.prototype.onOpenHandler=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this.openId=e,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenRoleView(this.openId)},e.prototype.realOpenRoleView=function(e){this._view||this.initView(),this.addUIEvent(),this._view.showView(),s.ClearResM.resetViewImg(this._view),o.E.ins.on(a.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.onClick=function(e){r.RuledescManager.showRuledesc(e)},e.prototype.addUIEvent=function(){this._view.view_bg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_help.visible=!1,this._view.on(Laya.Event.UNDISPLAY,this,this.onClose)},e.prototype.initView=function(){this._view=new l.HolyDressComposeView},e.prototype.closeClearRes=function(){o.E.ins.off(a.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),this.clearCtrlRes(),s.ClearResM.clearResFolder("holydress/")},e.prototype.onClose=function(){this._view.view_bg.btn_back.off(Laya.Event.CLICK,this,this.onClose),this._view.view_bg.btn_close.off(Laya.Event.CLICK,this,this.onClose),this._view.destroyView()},e}(i.BaseCtrl);t.HolyDressComposeCtrl=u}),define("src/g/shenweiyu/view/ShenWeiYuRankItem",["require","exports","../../../init/GameMain"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setData=function(e,t){t<3?this.setRankWithIcon(t):this.setRankNormal(t),this.areaServer.text=n.GameMain.getSvrIdStr(e.svrid);var i=e.nickname.split(":");this.nickName.text=i[0],this.level.text=0==+i[1]?i[2]+"级":i[1]+"转"+i[2]+"级",this.layer.text=""+e.value2,this.integral.text=""+e.value1},t.prototype.setRankWithIcon=function(e){this.rank.visible=!1,this.rankIcon.visible=!0,this.rankIcon.skin="res/rank/new/paihang_huizhang"+(e+1)+"st.png",this.bg1.skin=this.bg2.skin="res/di/paihangbang_"+(e+1)+"stdiban.png"},t.prototype.setRankNormal=function(e){this.rank.visible=!0,this.rankIcon.visible=!1,this.bg1.skin=this.bg2.skin="res/di/paihangbang_diban.png",this.rank.text=""+(e+1)},t}(ui.shenweiyu.ShenWeiYuRankItemUI);t.ShenWeiYuRankItem=i}),define("src/g/shenweiyu/view/ShenWeiYuRankView",["require","exports","src/g/shenweiyu/view/ShenWeiYuRankItem","../../../core/E","../../../enum/EventName","../../../config/GameConfig","../../net/messages/rank/sbkRankDataBase"],function(e,t,i,n,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e.dataArr=[],e.selfRankTotal=a.GameConfig.rankconfigJSON[o.enumRankID.rankid_22].count||10,e.crossRankTotal=a.GameConfig.rankconfigJSON[o.enumRankID.rankid_23].count||10,e.initRankList(),e.addEvent(),e}return __extends(e,t),e.prototype.initRankList=function(){this.rankList.vScrollBarSkin="",this.rankList.scrollBar.elasticDistance=50,this.rankList.itemRender=i.ShenWeiYuRankItem,this.rankList.renderHandler=new Laya.Handler(this,this.rankRenderHandler),this.rankList.array=[]},e.prototype.addEvent=function(){this.viewReward.on(Laya.Event.CLICK,this,function(){n.E.ins.event(s.EventName.SHENWEIYU_RANK_CLICK_VIEW_REWARD)})},e.prototype.rankRenderHandler=function(e,t){e.setData(this.dataArr[t],t)},e.prototype.refreshRank=function(e){this.dataArr=[];for(var t=0;t<e.rankDataArr.length;++t){var i=e.rankDataArr[t];if(!i)break;this.dataArr.push(i)}this.rankList.array=this.dataArr},e}(ui.shenweiyu.ShenWeiYuRankPageUI);t.ShenWeiYuRankView=r}),define("src/g/shenweiyu/ctrl/ShenWeiYuSelfRankCtrl",["require","exports","src/g/shenweiyu/view/ShenWeiYuRankView","../../../core/GNet","../../../manager/GameSocketManager","../../net/messages/rank/RankDataGS2C","../../net/messages/rank/sbkRankDataBase","../../clearRes/ClearResM"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this.isAddEvent=!1,this.sourceUrls=[]}return e.prototype.init=function(){this.rankView||(this.rankView=new i.ShenWeiYuRankView)},e.prototype.showPage=function(e,t){this.init();var i=this.rankView;i.parent!=e&&e.removeChildren(),e.addChild(i),this.isAddEvent||this.addEvent(),r.ClearResM.resetViewImg(i),this.refreshData()},e.prototype.addEvent=function(){s.GSM.ins.on(a.RankDataGS2C.KEY,this,this.refreshRank),this.isAddEvent=!0},e.prototype.removeEvent=function(){s.GSM.ins.off(a.RankDataGS2C.KEY,this,this.refreshRank),this.isAddEvent=!1},e.prototype.requestRank=function(){n.GNet.getRankList(o.enumRankID.rankid_22,1,this.rankView.selfRankTotal)},e.prototype.refreshRank=function(e){this.rankView.refreshRank(e)},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(){},e.prototype.refreshData=function(){this.requestRank()},e.prototype.getTitle=function(){return"res/title/shenweiyu_rank.png"},e.prototype.hidePage=function(){this.isAddEvent&&this.removeEvent()},e.prototype.destroyPage=function(){this.hidePage()},e}();t.ShenWeiYuSelfRankCtrl=l}),define("src/g/shenweiyu/ctrl/ShenWeiYuCrossRankCtrl",["require","exports","src/g/shenweiyu/view/ShenWeiYuRankView","../../../manager/GameSocketManager","../../../core/GNet","../../net/messages/rank/RankDataGS2C","../../net/messages/rank/sbkRankDataBase","../../clearRes/ClearResM"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this.isAddEvent=!1,this.sourceUrls=[]}return e.prototype.init=function(){this.rankView||(this.rankView=new i.ShenWeiYuRankView)},e.prototype.showPage=function(e,t){this.init();var i=this.rankView;i.parent!=e&&e.removeChildren(),e.addChild(i),this.isAddEvent||this.addEvent(),r.ClearResM.resetViewImg(i),this.refreshData()},e.prototype.addEvent=function(){n.GSM.ins.on(a.RankDataGS2C.KEY,this,this.refreshRank),this.isAddEvent=!0},e.prototype.removeEvent=function(){n.GSM.ins.off(a.RankDataGS2C.KEY,this,this.refreshRank),this.isAddEvent=!1},e.prototype.requestRank=function(){s.GNet.getRankList(o.enumRankID.rankid_23,1,this.rankView.crossRankTotal)},e.prototype.refreshRank=function(e){this.rankView.refreshRank(e)},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(){},e.prototype.refreshData=function(){this.requestRank()},e.prototype.getTitle=function(){return"res/title/shenweiyu_rank.png"},e.prototype.hidePage=function(){this.isAddEvent&&this.removeEvent()},e.prototype.destroyPage=function(){this.hidePage()},e}();t.ShenWeiYuCrossRankCtrl=l}),define("src/g/shenweiyu/view/ShenWeiYuRankBg",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),i.LayerManager.addInPOPWindowLayer(this,e,!0,!0,!1,t)},t.prototype.hideView=function(){this.removeSelf(),this.view_bg.box_page.removeChildren()},t.prototype.destroyView=function(){this.hideView()},t}(ui.shenweiyu.ShenWeiYuRankBgUI);t.ShenWeiYuRankBg=n}),define("src/g/shenweiyu/ctrl/ShenWeiYuRankHallCtrl",["require","exports","src/g/shenweiyu/ctrl/ShenWeiYuSelfRankCtrl","src/g/shenweiyu/ctrl/ShenWeiYuCrossRankCtrl","../../base/BaseCtrl","src/g/shenweiyu/view/ShenWeiYuRankBg","../../../core/E","../../../enum/EventName"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function e(){var e=t.call(this)||this;return e.closeOther=!1,e.forceOpen=!1,e.selectIndex=0,e.nowPageIndex=-1,e.isAddEvent=!1,o.E.ins.on(r.EventName.SHENWEIYU_CLICK_RANKREWARD,e,e.onOpenPage,[0,!0,!1]),e.initCtrl(),e}return __extends(e,t),e.prototype.initCtrl=function(){this.selfRankCtrl=new i.ShenWeiYuSelfRankCtrl,this.crossRankCtrl=new n.ShenWeiYuCrossRankCtrl},e.prototype.initView=function(){this.view=new a.ShenWeiYuRankBg},e.prototype.onOpenPage=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t&&this.showView(e,i,n)},e.prototype.showView=function(e,t,i){switch(void 0===t&&(t=!0),void 0===i&&(i=!1),e){case 0:this.openPage(0,t,i);break;case 1:this.openPage(1,t,i)}},e.prototype.openPage=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this.selectIndex=e,this.closeOther=t,this.forceOpen=i,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenPage(this.selectIndex,this.closeOther,this.forceOpen)},e.prototype.realOpenPage=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this.view||this.initView(),this.isAddEvent||this.addUIEvent(),this.view.showView(t,i),this.view.tab_page.selectedIndex==e?this.onChangePage(e):this.view.tab_page.selectedIndex=e},e.prototype.addUIEvent=function(){this.view.view_bg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this.view.view_bg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this.view.tab_page.selectHandler=new Laya.Handler(this,this.onChangePage),this.view.on(Laya.Event.REMOVED,this,this.onClose),this.isAddEvent=!0},e.prototype.removeUIEvent=function(){this.view.view_bg.btn_back.off(Laya.Event.CLICK,this,this.onClose),this.view.view_bg.btn_close.off(Laya.Event.CLICK,this,this.onClose),this.view.tab_page.selectHandler=null,this.view.off(Laya.Event.REMOVED,this,this.onClose),this.isAddEvent=!1},e.prototype.onChangePage=function(e){void 0===e&&(e=0),this.nowPageIndex!=e&&(-1!=this.nowPageIndex&&(this.page=this.getPageByIndex(this.nowPageIndex),this.page.destroyPage()),this.page=this.getPageByIndex(e),this.nowPageIndex=e,this.page.showPage(this.view.view_bg.box_page),this.view.view_bg.img_title.skin=this.page.getTitle())},e.prototype.getPageByIndex=function(e){switch(e){case 0:return this.selfRankCtrl;case 1:return this.crossRankCtrl;default:return null}},e.prototype.getBtnContent=function(){return[["本服榜",0],["跨服榜",1]]},e.prototype.onClose=function(){this.view.view_bg.box_page.removeChildren(),this.nowPageIndex=-1,this.removeUIEvent(),this.view.destroyView()},e}(s.BaseCtrl);t.ShenWeiYuRankHallCtrl=l}),define("src/g/shenweiyu/view/ShenWeiYuBg",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),i.LayerManager.addInPOPWindowLayer(this,e,!0,!0,!1,t)},t.prototype.hideView=function(){this.removeSelf(),this.view_bg.box_page.removeChildren()},t.prototype.destroyView=function(){this.hideView()},t}(ui.shenweiyu.ShenWeiYuBgUI);t.ShenWeiYuBg=n}),define("src/g/shenweiyu/view/ShenWeiYuItem",["require","exports"],function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.ShenWeiYuItemType||(t.ShenWeiYuItemType={}))[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM";var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setData=function(e,t,i){var n;switch(t){case 0:n=0;break;case i-1:n=2;break;default:n=1}this.setItemStyleByType(n),this.changeStatus(t<3),this.setRankInfo(e,t)},t.prototype.setRankInfo=function(e,t){var i=this.playerInfo;if(i.layerCountsValue.text=e?""+e.value2:"",i.reelCountsValue.text=e?""+e.value1:"",i.rank.value=""+(t+1),i.layerHBox.centerX=0,i.reelHBox.centerX=0,e){var n=e.nickname.split(":");i.nickName.text=n[0],n[3]&&n[4]?this.playerInfo.headIcon.skin="res/custom/heads/y_"+n[3]+"_"+n[4]+".png":this.playerInfo.headIcon.skin=""}else i.nickName.text="虚位以待",this.playerInfo.headIcon.skin=""},t.prototype.changeStatus=function(e){e?this.haveAvatarStatus():this.noAvatarStatus()},t.prototype.haveAvatarStatus=function(){this.playerInfo.avatar.visible=!0,this.playerInfo.detail.y=102},t.prototype.noAvatarStatus=function(){this.playerInfo.avatar.visible=!1,this.playerInfo.detail.y=54},t.prototype.setItemStyleByType=function(e){switch(e){case 0:this.setTopStyle();break;case 1:this.setMiddleStyle();break;case 2:this.setBottomStyle()}},t.prototype.setTopStyle=function(){this.height=283,this.bg.skin="res/shenweiyu/shenweiyu_ta_001.png",this.bg.y=-77,this.playerInfo.y=100},t.prototype.setMiddleStyle=function(){this.height=213,this.bg.skin="res/shenweiyu/shenweiyu_ta_002.png",this.bg.y=-3,this.playerInfo.y=30},t.prototype.setBottomStyle=function(){this.height=226,this.bg.skin="res/shenweiyu/shenweiyu_ta_003.png",this.bg.y=-26,this.playerInfo.y=52},t}(ui.shenweiyu.ShenWeiYuItemUI);t.ShenWeiYuItem=n}),define("src/g/shenweiyu/view/ShenWeiYuView",["require","exports","src/g/shenweiyu/view/ShenWeiYuItem","../../../enum/EventName","../../../core/E","../../fight/osprite/play/shenweiyu/ShenweiyuManager","../../../manager/RoleCenter","../../../config/GameConfig","../../../utils/ItemCellUtils","../../net/messages/rank/sbkRankDataBase","../../Effects/UIEffectsFactory","../../Effects/UIEffectsEnum","../../bag/tips/view/ItemTips","../../../init/TextConst"],function(e,t,n,s,a,o,r,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e){var t=i.call(this)||this;return t.itemArr=[],t.dataArr=[],t.selfRankTotal=l.GameConfig.rankconfigJSON[u.enumRankID.rankid_22].count||10,t.crossRankTotal=l.GameConfig.rankconfigJSON[u.enumRankID.rankid_23].count||10,t.isOpen=!1,t.isCreatedReceiveBtnEffect=!1,t.isSelfOrCross=e,t.playerRankPanel.vScrollBarSkin="",t.playerRankPanel.vScrollBar.elasticDistance=50,t.propList.renderHandler=new Laya.Handler(t,t.propRenderHandler),t.propList.mouseHandler=new Laya.Handler(t,t.propMouseHandler),t.propList.array=[],t.initMyRankPanel(),t.addEvent(),t.refreshPanel(),t}return __extends(e,i),e.prototype.initMyRankPanel=function(){this.propList.visible=!1,this.receiveBtn.visible=this.receiveEffect.visible=!1,this.receiveRedDot.visible=!1,this.myRankHBox.visible=this.layerHBox.visible=!1},e.prototype.propRenderHandler=function(e,t){var i=e.dataSource.split(":");h.ItemCellUtils.fillCellForItemNameView(e,i[0],+i[1])},e.prototype.propMouseHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i=this.propList.array[t].split(":");g.ItemTips.ins.showTip(i[0],+i[1])}},e.prototype.addEvent=function(){var e=this;this.rankReward.on(Laya.Event.CLICK,this,function(){a.E.ins.event(s.EventName.SHENWEIYU_CLICK_RANKREWARD,[e.isSelfOrCross,!0,!1])}),this.enterBtn.on(Laya.Event.CLICK,this,this.enterShenweiyu),this.receiveBtn.on(Laya.Event.CLICK,this,function(){a.E.ins.event(s.EventName.SHENWEIYU_RECEIVE_REWARD,e.isSelfOrCross)})},e.prototype.enterShenweiyu=function(){var e=r.RoleCenter.instans.self.swyLayer;e<=0&&(e=1);var t=o.ShenweiyuWarManager.getInstance().getSetting(e).portID[0];o.ShenweiyuWarManager.getInstance().enterShenWeiYuWar(t)},e.prototype.refreshPanel=function(e){void 0===e&&(e=!0),this.playerRankPanel.removeChildren();var t=0,i=0;for(this.dataArr.length=e?this.selfRankTotal:this.crossRankTotal;t<this.dataArr.length;){var n=this.getItem(t);n.setData(this.dataArr[t],t,this.dataArr.length),i+=n.height,n.y=i-n.height,this.playerRankPanel.addChild(n),++t}},e.prototype.getItem=function(e){return this.itemArr[e]||(this.itemArr[e]=new n.ShenWeiYuItem),this.itemArr[e]},e.prototype.refreshRank=function(e,t){this.dataArr=e.rankDataArr,this.refreshPanel(t)},e.prototype.refreshLayer=function(e){this.layerCountsValue.text=""+e},e.prototype.refreshSelfRank=function(e){this.myRankValue.text=e},e.prototype.refreshReward=function(e){this.propList.array=e},e.prototype.refreshOpenInfo=function(e){if(e){this.isOpen=e.actOpen,this.openTimestamp=e.openTime;var t=l.GameConfig.commonJson.shenweiyu,i=20;t&&(i=t.val2num),this.openTime.text="每天开启时间"+this.changeTime(1e3*this.openTimestamp)+"-"+this.changeTime(1e3*(this.openTimestamp+60*i)),this.description.text=p.TextConst.get(1267)}},e.prototype.refreshReceiveRedDot=function(e){this.receiveRedDot.visible=e},e.prototype.changeTime=function(e){var t=new Date(e);return[t.getHours(),t.getMinutes()].map(function(e){var t=""+e;return t[1]?t:"0"+t}).join(":")},e.prototype.refreshRankPanelStatus=function(e,t){this.notOpenText.visible=!this.isOpen,this.enterBtn.visible=this.isOpen,this.propList.visible=!this.isOpen&&e,this.receiveBtn.visible=this.receiveEffect.visible=!this.isOpen&&e,e?this.isOpen?this.myRankHBox.centerX=this.layerHBox.centerX=0:(this.myRankHBox.x=this.layerHBox.x=21,this.myRankHBox.y=28,this.layerHBox.y=68,this.refreshRankRewardStatus(t)):this.myRankHBox.centerX=this.layerHBox.centerX=0,e||this.isOpen?(this.myRankHBox.y=28,this.layerHBox.y=68):(this.myRankHBox.y=41,this.layerHBox.y=84),this.myRankHBox.visible||(this.myRankHBox.visible=!0),this.layerHBox.visible||(this.layerHBox.visible=!0)},e.prototype.refreshRankRewardStatus=function(e){var t;this.receiveBtn.label=e?"已领取":"领取",(this.receiveBtn.disabled=e)?t&&(t.destroy(),t=null,this.receiveEffect.visible=!1):this.isCreatedReceiveBtnEffect||(t=c.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.receiveEffect,d.UIEffectsEnum.getTip_Big,1,1),this.isCreatedReceiveBtnEffect=!0),this.receiveEffect.visible=!e},e}(ui.shenweiyu.ShenWeiYuPageUI);t.ShenWeiYuView=i}),define("src/g/shenweiyu/vo/ShenWeiYuRankRewardVo",["require","exports","../../../config/GameConfig"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getRewardInfoByRank=function(e,t){if(isNaN(parseInt(e)))return null;var i=s.GameConfig.shenweiyuRankVo;for(var n in i)if(e>=i[n].rank[0]&&e<=i[n].rank[1])return t?i[n].selfReward:i[n].crossReward;return null},e.getAllRankInfo=function(e){var t=s.GameConfig.shenweiyuRankVo,i=[];for(var n in t)i.push({id:t[n].id,arr:e?t[n].selfReward:t[n].crossReward});return i},e}();t.ShenWeiYuRankRewardVo=i}),define("src/g/shenweiyu/ctrl/RedDot_ShenWeiYu",["require","exports","../../../manager/GameSocketManager","../../../core/GNet","../../../config/GameConfig","../../../manager/RoleCenter","../../../manager/NewRedHintsCenter","../../net/messages/rank/RankDataGS2C","../../net/messages/rank/sbkRankDataBase"],function(e,t,i,n,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(){this.isAddEvent=!1,this.isOpen=!1,this.selfRedDotComplete=!1,this.crossRedDotComplete=!1}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.addEvent=function(){i.GSM.ins.on(r.RankDataGS2C.KEY,this,this.refreshRank),this.isAddEvent=!0},e.prototype.removeEvent=function(){i.GSM.ins.off(r.RankDataGS2C.KEY,this,this.refreshRank),this.isAddEvent=!1},e.prototype.refreshRank=function(e){if(e&&(e.rankIdArr[0]==l.enumRankID.rankid_22||e.rankIdArr[0]==l.enumRankID.rankid_23)){var t,i=this.checkRank(e.rankDataArr);switch(e.rankIdArr[0]){case l.enumRankID.rankid_22:t=!isNaN(+i)&&!this.isOpen&&!a.RoleCenter.instans.self.swyLing1,o.NewRedHintsCenter.ins.setRedHintOpenOrClose(o.enumRedHints.shenweiyu_self_receive_reward,t),this.selfRedDotComplete=!0;break;case l.enumRankID.rankid_23:t=!isNaN(+i)&&!this.isOpen&&!a.RoleCenter.instans.self.swyLing2,o.NewRedHintsCenter.ins.setRedHintOpenOrClose(o.enumRedHints.shenweiyu_cross_receive_reward,t),this.selfRedDotComplete=!0}this.selfRedDotComplete&&this.crossRedDotComplete&&(this.selfRedDotComplete=this.crossRedDotComplete=!1,this.removeEvent())}},e.prototype.checkRank=function(e){for(var t="暂无排名",i=a.RoleCenter.instans.self,n=0;n<e.length;++n){if(!e[n])break;if(e[n].username==i.username){t=""+(n+1);break}}return t},e.prototype.refreshRedDot=function(){this.isAddEvent||(this.addEvent(),this.refreshSelfRankRedDot(),this.refreshCrossRankRedDot())},e.prototype.refreshSelfRankRedDot=function(){n.GNet.getRankList(l.enumRankID.rankid_22,1,s.GameConfig.rankconfigJSON[l.enumRankID.rankid_22].count||10)},e.prototype.refreshCrossRankRedDot=function(){n.GNet.getRankList(l.enumRankID.rankid_23,1,s.GameConfig.rankconfigJSON[l.enumRankID.rankid_23].count||10)},e}();t.RedDot_ShenWeiYu=h}),define("src/g/shenweiyu/ctrl/ShenWeiYuSelfCtrl",["require","exports","src/g/shenweiyu/view/ShenWeiYuView","../../../manager/GameSocketManager","../../../core/GNet","../../../manager/RoleCenter","src/g/shenweiyu/vo/ShenWeiYuRankRewardVo","../../../core/E","../../../enum/EventName","../../account/ctrl/GetRewwardCtrl","../../../manager/NewRedHintsCenter","../../net/messages/SWYMsg","../../clearRes/ClearResM","../../net/messages/rank/RankDataGS2C","../../net/messages/rank/sbkRankDataBase","src/g/shenweiyu/ctrl/RedDot_ShenWeiYu","../../../config/GameConfig","../../fightactivity/ctrl/FightActivityCtrl","../../accessctrl/AccessCenter"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(){function e(){this.sourceUrls=[],this.isOpen=!1,this.isAddEvent=!1,this.isOpenedActivity=!1,n.GSM.ins.on(c.swyOpenState.KEY,this,this.refreshOpenInfo)}return e.prototype.init=function(){this.swyView||(this.swyView=new i.ShenWeiYuView(0))},e.prototype.showPage=function(e,t){this.init();var i=this.swyView;i.parent!=e&&e.removeChildren(),e.addChild(i),this.isAddEvent||this.addEvent(),d.ClearResM.resetViewImg(i),this.refreshData()},e.prototype.addEvent=function(){var e=n.GSM.ins;e.on(g.RankDataGS2C.KEY,this,this.refreshRank),e.on(c.swyJiFenGS2C.KEY,this,this.refreshMyRankInfo),e.on(c.swylingjiangGS2C.KEY,this,this.receiveRewardHandler),r.E.ins.on(l.EventName.SHENWEIYU_RECEIVE_REWARD,this,this.onReceiveReward),this.isAddEvent=!0},e.prototype.removeEvent=function(){var e=n.GSM.ins;e.off(g.RankDataGS2C.KEY,this,this.refreshRank),e.off(c.swyJiFenGS2C.KEY,this,this.refreshMyRankInfo),e.off(c.swylingjiangGS2C.KEY,this,this.receiveRewardHandler),r.E.ins.off(l.EventName.SHENWEIYU_RECEIVE_REWARD,this,this.onReceiveReward),this.isAddEvent=!1},e.prototype.onReceiveReward=function(e){if(1!=e){var t=new c.swylingjiangC2GS;t.type=0,n.GSM.sendServer(t)}},e.prototype.receiveRewardHandler=function(e){if(100!=e.type){for(var t=[],i=0;i<e.inV.itemList.length;i++){var n=e.inV.itemList[i];t.push(n)}0!=t.length&&h.GetRewwardCtrl.showReward(t),h.GetRewwardCtrl.inventoryAddGS2C(e.inV)}},e.prototype.refreshMyRankInfo=function(e){var t=a.RoleCenter.instans.self;t.swyJiFen=e.jifen,t.swyLayer=e.layer,t.swyLing1=e.ling1,t.swyLing2=e.ling2,t.swyTime=e.swytime,this.refreshData()},e.prototype.requestRank=function(){s.GNet.getRankList(p.enumRankID.rankid_22,1,this.swyView.selfRankTotal)},e.prototype.refreshRank=function(e){if(e&&e.rankIdArr[0]==p.enumRankID.rankid_22){this.swyView.refreshRank(e,!0);var t=a.RoleCenter.instans.self;86400<=Math.abs(t.swyTime-this.openStateMsg.openTime)&&(t.swyLayer=1),this.swyView.refreshLayer(t.swyLayer),this.rank="暂无排名";for(var i=0;i<e.rankDataArr.length;++i){if(!e.rankDataArr[i])break;if(e.rankDataArr[i].username==t.username){this.rank=""+(i+1);break}}this.swyView.refreshSelfRank(this.rank),this.swyView.refreshRankPanelStatus(!isNaN(+this.rank),a.RoleCenter.instans.self.swyLing1),this.refreshReward(),this.refreshRedDot()}},e.prototype.refreshRedDot=function(){var e=!isNaN(+this.rank)&&!this.isOpen&&!a.RoleCenter.instans.self.swyLing1;u.NewRedHintsCenter.ins.setRedHintOpenOrClose(u.enumRedHints.shenweiyu_self_receive_reward,e),this.swyView.refreshReceiveRedDot(e)},e.prototype.refreshData=function(){this.requestRank(),this.swyView.refreshOpenInfo(this.openStateMsg)},e.prototype.refreshOpenInfo=function(e){if(this.openStateMsg=e,this.isOpen=e.actOpen,this.isOpen){var t=f.GameConfig.commonJson.shenweiyu;y.FightActivityCtrl.startActivity(v.enumAccessId.shenweiyuSelf,t?t.val2num:void 0),this.isOpenedActivity=!0}else this.isOpenedActivity&&(y.FightActivityCtrl.endActivtiy(v.enumAccessId.shenweiyuSelf),this.isOpenedActivity=!1);m.RedDot_ShenWeiYu.instance.isOpen=e.actOpen,m.RedDot_ShenWeiYu.instance.refreshRedDot(),this.swyView&&this.refreshData()},e.prototype.refreshReward=function(){var e=o.ShenWeiYuRankRewardVo.getRewardInfoByRank(this.rank,!0);this.swyView.refreshReward(e)},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(){},e.prototype.getTitle=function(){return"res/title/shenweiyu.png"},e.prototype.hidePage=function(){this.isAddEvent&&this.removeEvent()},e.prototype.destroyPage=function(){this.hidePage()},e}();t.ShenWeiYuSelfCtrl=_}),define("src/g/shenweiyu/ctrl/ShenWeiYuCrossCtrl",["require","exports","../../../manager/GameSocketManager","../../../core/GNet","../../../manager/RoleCenter","src/g/shenweiyu/vo/ShenWeiYuRankRewardVo","../../../core/E","../../../enum/EventName","../../account/ctrl/GetRewwardCtrl","../../../manager/NewRedHintsCenter","../../net/messages/SWYMsg","../../net/messages/rank/RankDataGS2C","../../net/messages/rank/sbkRankDataBase","src/g/shenweiyu/view/ShenWeiYuView","src/g/shenweiyu/ctrl/RedDot_ShenWeiYu","../../clearRes/ClearResM"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(){this.isOpen=!1,this.isAddEvent=!1,this.sourceUrls=[],i.GSM.ins.on(u.swyOpenState.KEY,this,this.refreshOpenInfo)}return e.prototype.init=function(){this.swyView||(this.swyView=new g.ShenWeiYuView(1))},e.prototype.showPage=function(e,t){this.init();var i=this.swyView;i.parent!=e&&e.removeChildren(),e.addChild(i),this.isAddEvent||this.addEvent(),m.ClearResM.resetViewImg(i),this.refreshData()},e.prototype.addEvent=function(){var e=i.GSM.ins;e.on(c.RankDataGS2C.KEY,this,this.refreshRank),e.on(u.swyJiFenGS2C.KEY,this,this.refreshMyRankInfo),e.on(u.swylingjiangGS2C.KEY,this,this.receiveRewardHandler),o.E.ins.on(r.EventName.SHENWEIYU_RECEIVE_REWARD,this,this.onReceiveReward),this.isAddEvent=!0},e.prototype.removeEvent=function(){var e=i.GSM.ins;e.off(c.RankDataGS2C.KEY,this,this.refreshRank),e.off(u.swyJiFenGS2C.KEY,this,this.refreshMyRankInfo),e.off(u.swylingjiangGS2C.KEY,this,this.receiveRewardHandler),o.E.ins.off(r.EventName.SHENWEIYU_RECEIVE_REWARD,this,this.onReceiveReward),this.isAddEvent=!1},e.prototype.onReceiveReward=function(e){if(0!=e){var t=new u.swylingjiangC2GS;t.type=1,i.GSM.sendServer(t)}},e.prototype.receiveRewardHandler=function(e){if(100!=e.type){for(var t=[],i=0;i<e.inV.itemList.length;i++){var n=e.inV.itemList[i];t.push(n)}l.GetRewwardCtrl.showReward(t),l.GetRewwardCtrl.inventoryAddGS2C(e.inV)}},e.prototype.refreshMyRankInfo=function(e){var t=s.RoleCenter.instans.self;t.swyJiFen=e.jifen,t.swyLayer=e.layer,t.swyLing1=e.ling1,t.swyLing2=e.ling2,t.swyTime=e.swytime,this.refreshData()},e.prototype.requestRank=function(){n.GNet.getRankList(d.enumRankID.rankid_23,1,this.swyView.crossRankTotal)},e.prototype.refreshRank=function(e){if(e&&e.rankIdArr[0]==d.enumRankID.rankid_23){this.swyView.refreshRank(e,!1);var t=s.RoleCenter.instans.self;86400<=Math.abs(t.swyTime-this.openStateMsg.openTime)&&(t.swyLayer=1),this.swyView.refreshLayer(t.swyLayer),this.rank="暂无排名";for(var i=0;i<e.rankDataArr.length;++i){if(!e.rankDataArr[i])break;if(e.rankDataArr[i].username==t.username){this.rank=""+(i+1);break}}this.swyView.refreshSelfRank(this.rank),this.swyView.refreshRankPanelStatus(!isNaN(+this.rank),s.RoleCenter.instans.self.swyLing2),this.refreshReward(),this.refreshRedDot()}},e.prototype.refreshRedDot=function(){var e=!isNaN(+this.rank)&&!this.isOpen&&!s.RoleCenter.instans.self.swyLing2;h.NewRedHintsCenter.ins.setRedHintOpenOrClose(h.enumRedHints.shenweiyu_cross_receive_reward,e),this.swyView.refreshReceiveRedDot(e)},e.prototype.refreshData=function(){this.requestRank(),this.swyView.refreshOpenInfo(this.openStateMsg)},e.prototype.refreshOpenInfo=function(e){this.openStateMsg=e,this.isOpen=e.actOpen,p.RedDot_ShenWeiYu.instance.isOpen=e.actOpen,p.RedDot_ShenWeiYu.instance.refreshRedDot(),this.swyView&&this.refreshData()},e.prototype.refreshReward=function(){var e=a.ShenWeiYuRankRewardVo.getRewardInfoByRank(this.rank,!1);this.swyView.refreshReward(e)},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(){},e.prototype.getTitle=function(){return"res/title/shenweiyu.png"},e.prototype.hidePage=function(){this.isAddEvent&&this.removeEvent()},e.prototype.destroyPage=function(){this.hidePage()},e}();t.ShenWeiYuCrossCtrl=f}),define("src/g/shenweiyu/ctrl/ShenWeiYuHallCtrl",["require","exports","../../base/BaseCtrl","src/g/shenweiyu/view/ShenWeiYuBg","src/g/shenweiyu/ctrl/ShenWeiYuSelfCtrl","src/g/shenweiyu/ctrl/ShenWeiYuCrossCtrl","../../accessctrl/AccessCenter","src/g/shenweiyu/ctrl/RedDot_ShenWeiYu","../../../config/GameConfig","../../../manager/RoleCenter","../../../utils/system/DateUitl","../../../plugin/view/ToolTip","../../../manager/RuledescManager","../../../init/Switches","../../../utils/system/FloatEffect"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function e(){var i=t.call(this)||this;i.closeOther=!1,i.forceOpen=!1,i.selectIndex=0,i.nowPageIndex=-1,i.isAddEvent=!1,i.urls=["res/atlas/res/shenweiyu.json"];var e=g.Switches.ins;return e.on(o.enumAccessId.shenweiyuSelf,i,function(e){var t=l.GameConfig.timingActivity[6];if(t){if(h.RoleCenter.instans.vo.getCurLv()<t.level)return void p.FE.outErrorInfo(6342);if(u.DateUtil.getKFDay()<t.firstCron)return void p.FE.upItems(t.firstTips,c.BubbleEnum.center);r.RedDot_ShenWeiYu.instance.refreshRedDot(),i.onOpenPage(e,!0)}},[o.enumAccessId.shenweiyuSelf]),e.on(o.enumAccessId.shenweiyuCross,i,i.onOpenPage,[o.enumAccessId.shenweiyuCross]),i.initCtrl(),i}return __extends(e,t),e.prototype.initCtrl=function(){this.swySelfCtrl=new s.ShenWeiYuSelfCtrl,this.swyCrossCtrl=new a.ShenWeiYuCrossCtrl},e.prototype.initView=function(){this.view=new n.ShenWeiYuBg,this.view.view_bg.btn_help.visible=!0,this.view.view_bg.btn_help.on(Laya.Event.CLICK,this,this.onHelp)},e.prototype.onHelp=function(){d.RuledescManager.showRuledesc(o.enumAccessId.shenweiyuSelf)},e.prototype.onOpenPage=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t&&this.showView(e,i,n)},e.prototype.showView=function(e,t,i){switch(void 0===t&&(t=!0),void 0===i&&(i=!1),e){case o.enumAccessId.shenweiyuSelf:this.openPage(0,t,i);break;case o.enumAccessId.shenweiyuCross:this.openPage(1,t,i)}},e.prototype.openPage=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this.selectIndex=e,this.closeOther=t,this.forceOpen=i,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenPage(this.selectIndex,this.closeOther,this.forceOpen)},e.prototype.realOpenPage=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this.view||this.initView(),this.isAddEvent||this.addUIEvent(),this.view.showView(t,i),this.view.tab_page.selectedIndex==e?this.onChangePage(e):this.view.tab_page.selectedIndex=e},e.prototype.addUIEvent=function(){this.view.view_bg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this.view.view_bg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this.view.tab_page.selectHandler=new Laya.Handler(this,this.onChangePage),this.view.on(Laya.Event.REMOVED,this,this.onClose),this.isAddEvent=!0},e.prototype.removeUIEvent=function(){this.view.view_bg.btn_back.off(Laya.Event.CLICK,this,this.onClose),this.view.view_bg.btn_close.off(Laya.Event.CLICK,this,this.onClose),this.view.tab_page.selectHandler=null,this.isAddEvent=!1,this.view.off(Laya.Event.REMOVED,this,this.onClose),this.view.view_bg.off(Laya.Event.CLICK,this,this.onHelp)},e.prototype.onChangePage=function(e){void 0===e&&(e=0),this.nowPageIndex!=e&&(-1!=this.nowPageIndex&&(this.page=this.getPageByIndex(this.nowPageIndex),this.page.destroyPage()),this.page=this.getPageByIndex(e),this.nowPageIndex=e,this.page.showPage(this.view.view_bg.box_page),this.view.view_bg.img_title.skin=this.page.getTitle())},e.prototype.getPageByIndex=function(e){switch(e){case 0:return this.swySelfCtrl;case 1:return this.swyCrossCtrl;default:return null}},e.prototype.onClose=function(){this.view.view_bg.box_page.removeChildren(),this.nowPageIndex=-1,this.removeUIEvent(),this.page.destroyPage(),this.view.destroyView()},e}(i.BaseCtrl);t.ShenWeiYuHallCtrl=m}),define("src/g/shenweiyu/view/ShenWeiYuRewardItem",["require","exports","../../../utils/ItemCellUtils","../../bag/tips/view/ItemTips"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.initRewardRankItem(),e}return __extends(e,t),e.prototype.initRewardRankItem=function(){this.rewardList.renderHandler=new Laya.Handler(this,this.rankRewardRenderHandler),this.rewardList.mouseHandler=new Laya.Handler(this,this.rankRewardMouseHandler),this.rewardList.array=[]},e.prototype.rankRewardRenderHandler=function(e,t){var i=e.dataSource.split(":");n.ItemCellUtils.fillCellForItemNameView(e,i[0],+i[1])},e.prototype.rankRewardMouseHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i=this.rewardList.array[t].split(":");s.ItemTips.ins.showTip(i[0],+i[1])}},e.prototype.setData=function(e,t){this.rewardList.array=e.arr,this.rankIcon.skin="res/shenweiyu/shenweiyu_jiangliming_00"+e.id+".png"},e}(ui.shenweiyu.ShenWeiYuRewardItemUI);t.ShenWeiYuRewardItem=i}),define("src/g/shenweiyu/view/ShenWeiYuRewardView",["require","exports","src/g/shenweiyu/view/ShenWeiYuRewardItem"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e.initRewardRankList(),e}return __extends(e,t),e.prototype.initRewardRankList=function(){this.rewardRankList.vScrollBarSkin="",this.rewardRankList.scrollBar.elasticDistance=50,this.rewardRankList.itemRender=i.ShenWeiYuRewardItem,this.rewardRankList.renderHandler=new Laya.Handler(this,this.rewardRenderHandler),this.rewardRankList.array=[]},e.prototype.rewardRenderHandler=function(e,t){e.setData(this.rewardRankList.array[t],t)},e.prototype.refreshRankReward=function(e){this.rewardRankList.array=e},e}(ui.shenweiyu.ShenWeiYuRewardPageUI);t.ShenWeiYuRewardView=n}),define("src/g/shenweiyu/ctrl/ShenWeiYuSelfRewardCtrl",["require","exports","src/g/shenweiyu/view/ShenWeiYuRewardView","src/g/shenweiyu/vo/ShenWeiYuRankRewardVo","../../clearRes/ClearResM"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this.sourceUrls=[]}return e.prototype.init=function(){this.rewardView||(this.rewardView=new i.ShenWeiYuRewardView)},e.prototype.showPage=function(e,t){this.init();var i=this.rewardView;i.parent!=e&&e.removeChildren(),e.addChild(i),s.ClearResM.resetViewImg(i),this.refreshData()},e.prototype.refreshData=function(){var e=n.ShenWeiYuRankRewardVo.getAllRankInfo(!0);this.rewardView.refreshRankReward(e)},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(){},e.prototype.getTitle=function(){return"res/title/shenweiyu_reward.png"},e.prototype.hidePage=function(){},e.prototype.destroyPage=function(){},e}();t.ShenWeiYuSelfRewardCtrl=a}),define("src/g/shenweiyu/ctrl/ShenWeiYuCrossRewardCtrl",["require","exports","src/g/shenweiyu/view/ShenWeiYuRewardView","src/g/shenweiyu/vo/ShenWeiYuRankRewardVo","../../clearRes/ClearResM"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this.sourceUrls=[]}return e.prototype.init=function(){this.rewardView||(this.rewardView=new i.ShenWeiYuRewardView)},e.prototype.showPage=function(e,t){this.init();var i=this.rewardView;i.parent!=e&&e.removeChildren(),e.addChild(i),s.ClearResM.resetViewImg(i),this.refreshData()},e.prototype.refreshData=function(){var e=n.ShenWeiYuRankRewardVo.getAllRankInfo(!1);this.rewardView.refreshRankReward(e)},e.prototype.loadUrls=function(){},e.prototype.changePerson=function(){},e.prototype.getTitle=function(){return"res/title/shenweiyu_reward.png"},e.prototype.hidePage=function(){},e.prototype.destroyPage=function(){},e}();t.ShenWeiYuCrossRewardCtrl=a}),define("src/g/shenweiyu/view/ShenWeiYuRewardBg",["require","exports","../../../manager/LayerManager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),i.LayerManager.addInPOPWindowLayer(this,e,!0,!0,!1,t)},t.prototype.hideView=function(){this.removeSelf(),this.view_bg.box_page.removeChildren()},t.prototype.destroyView=function(){this.hideView()},t}(ui.shenweiyu.ShenWeiYuRewardBgUI);t.ShenWeiYuRewardBg=n}),define("src/g/shenweiyu/ctrl/ShenWeiYuRewardHallCtrl",["require","exports","src/g/shenweiyu/ctrl/ShenWeiYuSelfRewardCtrl","src/g/shenweiyu/ctrl/ShenWeiYuCrossRewardCtrl","../../base/BaseCtrl","src/g/shenweiyu/view/ShenWeiYuRewardBg","../../../core/E","../../../enum/EventName"],function(e,t,i,n,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function e(){var e=t.call(this)||this;return e.pageIndex=0,e.closeOther=!1,e.forceOpen=!1,e.selectIndex=0,e.nowPageIndex=-1,e.isAddEvent=!1,o.E.ins.on(r.EventName.SHENWEIYU_RANK_CLICK_VIEW_REWARD,e,e.onOpenPage,[0,!0,!1]),o.E.ins.on(r.EventName.SHENWEIYU_RANK_SELECTMOUDLE_CHANGED,e,e.onChangePageIndex),e.initCtrl(),e}return __extends(e,t),e.prototype.initCtrl=function(){this.selfRewardCtrl=new i.ShenWeiYuSelfRewardCtrl,this.crossRewardCtrl=new n.ShenWeiYuCrossRewardCtrl},e.prototype.initView=function(){this.view=new a.ShenWeiYuRewardBg},e.prototype.onOpenPage=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t&&this.showView(e,i,n)},e.prototype.showView=function(e,t,i){switch(void 0===t&&(t=!0),void 0===i&&(i=!1),e){case 0:this.openPage(0,t,i);break;case 1:this.openPage(1,t,i)}},e.prototype.onChangePageIndex=function(e){this.pageIndex=e},e.prototype.openPage=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this.selectIndex=e,this.closeOther=t,this.forceOpen=i,this.opens()},e.prototype.onAtlasLoaded=function(){this.realOpenPage(this.selectIndex,this.closeOther,this.forceOpen)},e.prototype.realOpenPage=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=!1),this.view||this.initView(),this.isAddEvent||this.addUIEvent(),this.view.showView(t,i),this.view.tab_page.selectedIndex==e?this.onChangePage(e):this.view.tab_page.selectedIndex=e},e.prototype.addUIEvent=function(){this.view.view_bg.btn_back.on(Laya.Event.CLICK,this,this.onClose),this.view.view_bg.btn_close.on(Laya.Event.CLICK,this,this.onClose),this.view.tab_page.selectHandler=new Laya.Handler(this,this.onChangePage),this.view.on(Laya.Event.REMOVED,this,this.onClose),this.isAddEvent=!0},e.prototype.removeUIEvent=function(){this.view.view_bg.btn_back.off(Laya.Event.CLICK,this,this.onClose),this.view.view_bg.btn_close.off(Laya.Event.CLICK,this,this.onClose),this.view.tab_page.selectHandler=null,this.view.off(Laya.Event.REMOVED,this,this.onClose),this.isAddEvent=!1},e.prototype.onChangePage=function(e){void 0===e&&(e=0),this.nowPageIndex!=e&&(-1!=this.nowPageIndex&&(this.page=this.getPageByIndex(this.nowPageIndex),this.page.destroyPage()),this.page=this.getPageByIndex(e),this.nowPageIndex=e,this.page.showPage(this.view.view_bg.box_page),this.view.view_bg.img_title.skin=this.page.getTitle())},e.prototype.getPageByIndex=function(e){switch(e){case 0:return this.selfRewardCtrl;case 1:return this.crossRewardCtrl;default:return null}},e.prototype.onClose=function(){this.view.view_bg.box_page.removeChildren(),this.nowPageIndex=-1,this.removeUIEvent(),this.view.destroyView()},e}(s.BaseCtrl);t.ShenWeiYuRewardHallCtrl=l}),define("src/g/shenweiyu/ctrl/ShenweiyuDeathCtrl",["require","exports","../../../utils/CountDown","../../../manager/LayerManager","../../../utils/system/ServerTime","../../../utils/system/FloatEffect"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.fuhuoCD=new i.CountDown,this._endtime=0}return e.prototype.onDeath=function(e,t){if(this.freeFuHuoCallBack=e,this._endtime=0,null==this.view){this.view=new ui.shenweiyu.ShenweiyuDeathViewUI,this.view.centerX=0,this.view.bottom=440,n.LayerManager.addInHighUILayer(this.view),this.view.scoreTxt.text="-"+t.KillLoseintegral;var i;i=15+s.ServerTime.serverTime,this.fuhuoCD.start(i,this.updFuHuoCountDown,this)}},e.prototype.freeFuHuoHander=function(){this._endtime<=s.ServerTime.serverTime?this.freeFuHuoCallBack.run():a.FE.upItems("时间未到，请稍后")},e.prototype.relase=function(){this.view&&(this.fuhuoCD.stop(),this.freeFuHuoCallBack=null,this.view.removeSelf(),this.view.destroy(),this.view=null)},e.prototype.updFuHuoCountDown=function(e){this.view.timeTxt.text=e+"s",0==e&&this.freeFuHuoHander()},e}();t.ShenweiyuDeathCtrl=o}),define("src/g/shenweiyu/view/ShenweiyuWar",["require","exports","../../../manager/LayerManager","../../../core/E","../../../enum/EventName","../../boss/view/SCFoeHead","../../../utils/ItemUtils","../../../manager/RoleCenter","../../../utils/GPUtils","../../crossserboss/PointWarPlayer"],function(e,t,i,n,s,a,o,r,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(){var e=t.call(this)||this;return e.hunDunMaxvalue=0,e.huDunValue=0,e.mouseThrough=!0,e.width=Laya.stage.width,e.height=Laya.stage.height,e.foeIndexDict=new Laya.Dictionary,e.familyIndexDict=new Laya.Dictionary,e.playerIndexDict=new Laya.Dictionary,e.bossHead=new h.PointWarPlayer,e.bossHead.setType(0),e.bossHead.right=0,e.bossHead.y=137,e.addChild(e.bossHead),e.guiShuZhe=new h.PointWarPlayer,e.guiShuZhe.setType(1),e.guiShuZhe.y=34,e.guiShuZheBox.addChildAt(e.guiShuZhe,0),e.setGuiShuZhe(null),e.initList(e.playerList,e.playerRender,h.PointWarPlayer),e.guiShuZheBox.on(Laya.Event.CLICK,e,e.attackGuiShuzheHander),e}return __extends(e,t),e.prototype.attackGuiShuzheHander=function(){n.E.ins.event(s.EventName.SELECT_PK_TARGET,this.guiShuZhe.getDataAsFightGroup().groupID)},e.prototype.initList=function(e,t,i){e.selectEnable=!0,e.vScrollBarSkin="",e.itemRender=i,e.scrollBar.elasticDistance=100,e.renderHandler=new Laya.Handler(this,t),e.array=[]},e.prototype.foeRender=function(e,t){e.update2("right"),e.showAttackerEf(),e.on(Laya.Event.CLICK,this,this.attFoeHander)},e.prototype.playerRender=function(e,t){e.update2("right"),e.on(Laya.Event.CLICK,this,this.attplayerHander)},e.prototype.showView=function(){i.LayerManager.addInUILayer(this)},e.prototype.updMyFamilyList=function(e){},e.prototype.updPlayerList=function(e){var t=l.GPUtils.deleteEmptyData(e,this.playerIndexDict,!0);this.playerList.array=t,l.GPUtils.caculateListH(this.playerList,4)},e.prototype.attplayerHander=function(e){var t=e.currentTarget,i=this.playerIndexDict.get(t.dataSource);n.E.ins.event(s.EventName.SELECT_TARGET_INDEX,i)},e.prototype.attFoeHander=function(e){var t=e.currentTarget,i=this.foeIndexDict.get(t.dataSource);n.E.ins.event(s.EventName.SELECT_REVENGE_TARGET_INDEX,i)},e.prototype.attackFamilyList=function(e){var t=e.currentTarget,i=this.familyIndexDict.get(t.dataSource);n.E.ins.event(s.EventName.SELECT_FAMILYMEMBER_INDEX,i)},e.prototype.changeAttackTarget=function(e){this.clearAttackSign(),null!=e&&(""==e?this.bossHead.updStatus(a.SCFoeHead.BE_ATTACK):(null!=this.guiShuZhe.getDataAsFightGroup()&&this.guiShuZhe.getDataAsFightGroup().groupID==e&&this.guiShuZhe.updStatus(a.SCFoeHead.BE_ATTACK),this.showAttackSignInList(this.playerList,e)))},e.prototype.clearAttackSign=function(){this.bossHead.reset(),this.guiShuZhe.reset(),this.clearListAttackSign(this.playerList)},e.prototype.clearListAttackSign=function(e){for(var t=0;t<e.cells.length;t++)e.cells[t].reset()},e.prototype.showAttackSignInList=function(e,t){for(var i,n=0;n<e.cells.length;n++)(i=e.cells[n]).getName()==t&&i.updStatus(a.SCFoeHead.BE_ATTACK)},e.prototype.onDeath=function(){this.clearAttackSign()},e.prototype.setBoss=function(e,t){this.bossMaxHP=t,this.bossBar.imgTargetFoeHead.skin=o.ItemUtils.getBossIconByPort(e.port),this.bossBar.targetFoeName.text=e.name,this.bossHead.updateBoss(e)},e.prototype.updBossHP=function(e){var t=Math.min(330*e/this.bossMaxHP>>0,330),i=this.bossBar;i.progressBar.width=t,i.progress_txt.text=e+"/"+this.bossMaxHP,i.visible=!(e<=0)},e.prototype.setGuiShuZhe=function(e){e?(this.guiShuZheBox.visible=!0,this.guiShuZhe.updWinner2(e),r.RoleCenter.instans.self.username==e.groupID||r.RoleCenter.instans.self.ufData.familyUId==e.getFamilyUid()&&r.RoleCenter.instans.self.ufData.familyUId,r.RoleCenter.instans.self.username==e.groupID?(this.imgowner.visible=!0,this.attackBoss.visible=!1):(this.imgowner.visible=!1,this.attackBoss.visible=!0)):(this.guiShuZheBox.visible=!1,this.imgowner.visible=!1,this.attackBoss.visible=!0)},e.prototype.updGuiShuZheHP=function(e,t){this.guiShuZhe.updBlood(e,t)},e.prototype.visibleBossView=function(e){this.bossBar.visible=e,this.bossHead.visible=e,this.buttonBox.visible=e},e.prototype.showShield=function(e,t,i){this.bossBar.hudunView.visible=!0,this.hunDunMaxvalue=t,this.hdValue=e,Laya.Tween.clearAll(this),Laya.Tween.to(this,{hdValue:0},e/i*1e3)},e.prototype.hideHuDunView=function(){Laya.Tween.clearAll(this),this.bossBar.hudunView.visible=!1},Object.defineProperty(e.prototype,"hdValue",{get:function(){return this.huDunValue},set:function(e){this.huDunValue=e;var t=this.bossBar.hudunBar;isNaN(this.hudunBarWidth)&&(this.hudunBarWidth=t.width),t.width=e/this.hunDunMaxvalue*this.hudunBarWidth},enumerable:!0,configurable:!0}),e}(ui.shenweiyu.ShenweiyuWarUI);t.ShenweiyuWar=u}),define("src/g/shenweiyu/view/ShenweiyuSenceView",["require","exports","../../fight/osprite/GameScene","../../../config/GameConfig","../../../manager/LayerManager","../../fight/osprite/play/shenweiyu/ShenweiyuManager","../../../manager/RoleCenter","../../../utils/ItemUtils"],function(e,t,l,h,a,u,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function e(){var e=n.call(this)||this;e._smallMap=null,e._smallMapSprite=new Laya.Sprite,e._bossSprite=new Laya.Sprite,e._image=null,e._monsterList=[],e.curLayerMonsterData=[],e.width=Laya.stage.width,e.mouseThrough=!0;var t=o.RoleCenter.instans.self.swyLayer;e.curLayerMonsterData=u.ShenweiyuWarManager.getInstance().getSetting(t).portID;for(var i=0;i<10;i++)e._monsterList[i]=new Laya.Image("res/shenweiyu/rxzc_hongdian01.png"),e._monsterList[i].visible=!1,e._bossSprite.addChild(e._monsterList[i]);return e._image=new Laya.Image("res/shenweiyu/rxzc_wanjiaweizhi.png"),e._image.on(Laya.Event.LOADED,e,e.onRoleImage),e._smallMapSprite.addChild(e._image),e}return __extends(e,n),e.prototype.refreshMonsterData=function(){var e=o.RoleCenter.instans.self.swyLayer;this.curLayerMonsterData=u.ShenweiyuWarManager.getInstance().getSetting(e).portID},e.prototype.onRoleImage=function(){this._image.x=-this._image.width/2,this._image.y=-this._image.height/2},e.prototype.show=function(){var e=o.RoleCenter.instans.self.swyLayer,t=u.ShenweiyuWarManager.getInstance().getSetting(e).portID[0],i=r.ItemUtils.getPortVoById(t),n=h.GameConfig.getMapJSON(i.boss_scene),s=(r.ItemUtils.getMapUrl()+"{0}/small_2.jpg").replace("{0}",""+n.mapID);null==this._smallMap?(this._smallMap=new Laya.Image(s),this.mapBox.addChild(this._smallMap),this.mapBox.addChild(this._smallMapSprite),this.mapBox.addChild(this._bossSprite),a.LayerManager.addInUILayer(this)):this._smallMap.skin=s,this.visible=!0,Laya.timer.frameLoop(1,this,this.update)},e.prototype.hide=function(){Laya.timer.clear(this,this.update),this.visible=!1},e.prototype.exit=function(){Laya.timer.clear(this,this.update),this._smallMapSprite&&(this._smallMapSprite.removeSelf(),this._smallMapSprite=null),this._smallMap&&(this._smallMap.removeSelf(),this._smallMap=null)},e.prototype.update=function(){var e=u.ShenweiyuWarManager.getInstance();if(e.gamePlay&&this._smallMap&&0!=l.GameScene.ins.map.width&&0!=l.GameScene.ins.map.height&&0!=this._smallMap.width&&0!=this._smallMap.height){this.refreshMonsterData();var t=e.gamePlay.getSelfPos(),i=t[0]/l.GameScene.ins.map.width*this._smallMap.width,n=t[1]/l.GameScene.ins.map.height*this._smallMap.height;this._smallMapSprite.x=i,this._smallMapSprite.y=n;for(var s=1;s<this.curLayerMonsterData.length;s++){var a=Number(this.curLayerMonsterData[s]),o=h.GameConfig.getPortByID(a),r=h.GameConfig.getMapJSON(o.boss_scene);r&&0<r.bossXY.length&&(i=r.bossXY[0][0]/l.GameScene.ins.map.width*this._smallMap.width,n=r.bossXY[0][1]/l.GameScene.ins.map.height*this._smallMap.height,this._monsterList[s].x=i-9,this._monsterList[s].y=n-9,this._monsterList[s].visible=!0)}for(;s<this._monsterList.length;++s)this._monsterList[s].visible=!1}},e}(ui.shenweiyu.ShenweiyuSceneViewUI);t.ShenweiyuSenceView=i;var n=function(){this.stateKey=!1,this.portId=-1};t.HotBloodBossInfoItemData=n}),define("src/g/shenweiyu/view/ShenweiyuScoreView",["require","exports","../../../manager/LayerManager","../../Effects/UIEffectsEnum","../../Effects/UIEffectsFactory"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showView=function(){i.LayerManager.addInUILayer(this),this.ani||(this.ani=s.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.nextBox,n.UIEffectsEnum.gift,.5,.9)),this.ani.x-=20,this.ani.visible=!1},t.prototype.hideView=function(){this.ani&&(this.ani.stop(),this.ani=null)},t}(ui.shenweiyu.ShenweiyuScoreViewUI);t.ShenweiyuScoreView=a}),define("src/g/shenweiyu/view/ShenWeiYuNearbyPlayersItem",["require","exports","../../../utils/ItemUtils","../../../core/E","../../../enum/EventName"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function e(){var e=t.call(this)||this;return e.btn_fight.on(Laya.Event.CLICK,e,e.fightHandler),e}return __extends(e,t),e.prototype.setData=function(e,t){this.vo=e,this.icon.skin=i.ItemUtils.getHeadUrl(this.vo.sex,this.vo.job),this.user_name.text=this.vo.nickname,this.curScore.text=this.vo.jifen.toString()},e.prototype.fightHandler=function(){Laya.Dialog.closeAll(),n.E.ins.event(s.EventName.SELECT_PK_TARGET1,this.vo)},e}(ui.shenweiyu.ShenweiyuFightNearbyPlayerItemUI);t.ShenWeiYuNearbyPlayersItem=a}),define("src/g/shenweiyu/view/ShenweiyuNearbyPlayerView",["require","exports","src/g/shenweiyu/view/ShenWeiYuNearbyPlayersItem","../../../manager/RoleCenter"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.playerList.itemRender=i.ShenWeiYuNearbyPlayersItem,e.playerList.vScrollBarSkin="",e.playerList.scrollBar.elasticDistance=100,e.playerList.renderHandler=new Laya.Handler(e,e.refreshHandler),e.bg.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,t),e.prototype.refreshHandler=function(e,t){e.setData(this.playerList.array[t],t)},e.prototype.setListData=function(e){for(var t=0;t<e.length;t++){e[t].username==n.RoleCenter.instans.self.username&&e.splice(t,1)}this.playerList.dataSource=e},e}(ui.shenweiyu.ShenweiyuNearbyPlayerViewUI);t.ShenweiyuNearbyPlayerView=s}),define("src/g/shenweiyu/view/ShenweiyuFightRankView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.rankList.itemRender=ui.shenweiyu.ShenweiyuFightRankItemUI,e.rankList.vScrollBarSkin="",e.rankList.scrollBar.elasticDistance=100,e.rankList.renderHandler=new Laya.Handler(e,e.refreshHandler),e}return __extends(e,t),e.prototype.refreshHandler=function(e,t){var i=this.rankList.array[t];if(i){e.rankTxt.text=(t+1).toString();var n=i.nickname.split(":");e.nameTxt.text=n[0],e.scoleTxt.text=i.value1.toString(),e.layerTxt.text=i.value2.toString()}else e.rankTxt.text=e.nameTxt.text=e.scoleTxt.text=e.layerTxt.text=""},e.prototype.updateListData=function(e){this.rankList.array=e},e}(ui.shenweiyu.ShenweiyuFightRankViewUI);t.ShenweiyuFightRankView=i}),define("src/g/shenweiyu/view/ShenWeiYuSettlePage",["require","exports","../../../manager/RoleCenter"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setPanelData=function(){this.layerCounts.text=i.RoleCenter.instans.self.swyLayer.toString(),this.integral.text=i.RoleCenter.instans.self.swyJiFen.toString()},t}(ui.shenweiyu.ShenWeiYuSettlePageUI);t.ShenWeiYuSettlePage=n}),define("src/g/shenweiyu/ctrl/ShenweiyuSettlePageCtrl",["require","exports","src/g/shenweiyu/view/ShenWeiYuSettlePage","../../../utils/CountDown","../../../utils/system/ServerTime","../../../utils/system/FloatEffect"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.cd=new n.CountDown,this._endtime=0}return e.prototype.onOpenSettlePanel=function(e){this.exitCallBack=e,this._endtime=0,null==this.view&&(this.view=new i.ShenWeiYuSettlePage),this.view.btn_get.on(Laya.Event.CLICK,this,this.freeFuHuoHander),this.view.popup(),this.view.setPanelData();var t;t=5+s.ServerTime.serverTime,this.cd.start(t,this.upCountDown,this)},e.prototype.upCountDown=function(e){this.view.btn_get.label="前往领奖("+e+"s)",0==e&&this.freeFuHuoHander()},e.prototype.freeFuHuoHander=function(){this._endtime<=s.ServerTime.serverTime?this.exitCallBack.run():a.FE.upItems("时间未到，请稍后")},e.prototype.relase=function(){this.view&&(this.cd.stop(),this.exitCallBack=null,this.view.btn_get.off(Laya.Event.CLICK,this,this.freeFuHuoHander),this.view=null)},e}();t.ShenweiyuSettlePageCtrl=o}),define("src/g/shenweiyu/ctrl/ShenweiyuWarCtrl",["require","exports","src/g/shenweiyu/ctrl/ShenweiyuDeathCtrl","../../../core/E","../../../enum/EventName","../../fight/osprite/play/shenweiyu/ShenweiyuManager","src/g/shenweiyu/view/ShenweiyuWar","../../../utils/ItemUtils","src/g/shenweiyu/view/ShenweiyuSenceView","src/g/shenweiyu/view/ShenweiyuScoreView","../../../manager/RoleCenter","src/g/shenweiyu/view/ShenweiyuNearbyPlayerView","src/g/shenweiyu/view/ShenweiyuFightRankView","src/g/shenweiyu/ctrl/ShenweiyuSettlePageCtrl","../../net/messages/rank/sbkRankDataBase","../../../utils/system/DateUitl","../../clearRes/ClearResM"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(){this.totalInfoView=null,this.scoreView=null,this.isNextLayer=!1,this.isAutoEnter=!1,this.isSendRankData=!1,this.deathCtrl=new i.ShenweiyuDeathCtrl,this.settleCtrl=new g.ShenweiyuSettlePageCtrl,n.E.ins.on(s.EventName.SHENWEIYU_SCENE_PANEL,this,this.openPanel),n.E.ins.on(s.EventName.SHENWEIYU_CHNAGE_LAYER,this,this.updateLayerShow)}return e.prototype.openPanel=function(){null==(this.manager().viewCtrl=this).totalInfoView&&(this.totalInfoView=new l.ShenweiyuSenceView,f.ClearResM.resetViewImg(this.totalInfoView)),this.totalInfoView.show(),null==this.view&&(this.view=new o.ShenweiyuWar,this.view.showView(),this.view.visible=!1),null==this.scoreView&&(this.scoreView=new h.ShenweiyuScoreView,this.scoreView.showView(),this.scoreView.nextBox.on(Laya.Event.CLICK,this,this.enterNextLayer),this.scoreView.aotuLayerBox.on(Laya.Event.CLICK,this,this.setAutoNextState),this.scoreView.selectBtn.on(Laya.Event.CLICK,this,this.sendSelectList),this.scoreView.rankBtn.on(Laya.Event.CLICK,this,this.openRankListView),this.scoreView.selectImg.visible=!1,this.sendRankList(),this.updateRoleJifen(u.RoleCenter.instans.self.swyLayer,u.RoleCenter.instans.self.swyJiFen))},e.prototype.getDeathCtrl=function(){return this.deathCtrl},e.prototype.manager=function(){return a.ShenweiyuWarManager.getInstance()},e.prototype.showBattlePanel=function(e){this.currportid=e,this.lastportid=NaN,n.E.ins.on(s.EventName.UPDATE_VIEW_TARGET,this,this.updPlayerListHander),n.E.ins.on(s.EventName.CHANGE_PK_TARGET,this,this.attackTargetChangedHander),this.view.attackBoss.on(Laya.Event.CLICK,this,this.attackBossHander),this.view.bossHead.on(Laya.Event.CLICK,this,this.attackBossHander),this.view.visible=!0;var t=r.ItemUtils.getBossVoByPortId(e),i=r.ItemUtils.getMonsterVOById(e);t&&i&&this.view.setBoss(t,i.HP),this.totalInfoView.hide()},e.prototype.updPlayerListHander=function(e){this.view&&this.view.updPlayerList(e)},e.prototype.hideBattlePanel=function(e){void 0===e&&(e=!0),this.view&&(n.E.ins.off(s.EventName.UPDATE_VIEW_TARGET,this,this.updPlayerListHander),n.E.ins.off(s.EventName.CHANGE_PK_TARGET,this,this.attackTargetChangedHander),this.view.attackBoss.off(Laya.Event.CLICK,this,this.attackBossHander),this.view.bossHead.off(Laya.Event.CLICK,this,this.attackBossHander),this.view.visible=!1),e&&this.totalInfoView.show()},e.prototype.onDeath=function(e,t){var i=this.manager().checkIsMainScene();this.lastportid=i?NaN:this.currportid,this.deathCtrl.onDeath(e,t),this.view&&this.view.visible&&this.view.onDeath()},e.prototype.onShowSettlePanel=function(e){this.settleCtrl&&(this.settleCtrl.onOpenSettlePanel(e),this.manager().rankListData(p.enumRankID.rankid_22),this.manager().rankListData(p.enumRankID.rankid_23))},e.prototype.exit=function(){this.manager().viewCtrl=null,this.view&&(this.view.visible&&this.hideBattlePanel(!1),this.view.removeSelf(),this.view.destroy(!0),this.view=null),this.totalInfoView&&(this.totalInfoView.exit(),this.totalInfoView.removeSelf(),this.totalInfoView.destroy(!0),this.totalInfoView=null),this.scoreView&&(this.scoreView.nextBox.off(Laya.Event.CLICK,this,this.enterNextLayer),this.scoreView.aotuLayerBox.off(Laya.Event.CLICK,this,this.setAutoNextState),this.scoreView.selectBtn.off(Laya.Event.CLICK,this,this.sendSelectList),this.scoreView.rankBtn.off(Laya.Event.CLICK,this,this.openRankListView),this.scoreView.hideView(),this.scoreView.removeSelf(),this.scoreView.destroy(!0),this.scoreView=null),this.currportid=this.lastportid=NaN,this.deathCtrl.relase(),this.settleCtrl.relase()},e.prototype.visibleBossView=function(e){this.view&&this.view.visibleBossView(e)},e.prototype.attackBossHander=function(){this.manager().findBoss()},e.prototype.attackTargetChangedHander=function(e){this.view&&this.view.changeAttackTarget(e)},e.prototype.updateBossHp=function(e){this.view&&this.view.updBossHP(e)},e.prototype.updateBossOwner=function(e){this.view&&this.view.setGuiShuZhe(e)},e.prototype.updateBossOwnerHp=function(e,t){this.view&&this.view.updGuiShuZheHP(e,t)},e.prototype.updateRoleJifen=function(e,t){if(this.scoreView){e<=0&&(e=1),this.scoreView.myScoreTxt.text="我的积分:"+t;var i=this.manager().getSetting(e).integral[1],n=this.manager().getSetting(e+1).id;this.scoreView.nextLayerTxt.text=n?i<t?"可进入下一层":"达到"+(i+1)+"可进入下一层":"已到达最高层",this.isNextLayer=i<t,this.scoreView.ani.visible=this.isNextLayer,this.isAutoEnter&&this.enterNextLayer()}},e.prototype.updateLayerShow=function(e){this.scoreView.curLayerTxt.text="当前层数:"+e},e.prototype.enterNextLayer=function(){var e=this.manager().gamePlay;e&&e.fightGroup&&e.fightGroup.isDeath()||this.isNextLayer&&this.manager().sendNextLayer()},e.prototype.setAutoNextState=function(){var e=this.manager().gamePlay;if(!(e&&e.fightGroup&&e.fightGroup.isDeath())){this.scoreView.selectImg.visible?this.isAutoEnter=this.scoreView.selectImg.visible=!1:this.isAutoEnter=this.scoreView.selectImg.visible=!0;var t=u.RoleCenter.instans.self.swyLayer,i=this.manager().getSetting(t).integral[1];this.isNextLayer=u.RoleCenter.instans.self.swyJiFen>i,this.isNextLayer&&this.enterNextLayer()}},e.prototype.openRankListView=function(){this.isSendRankData=!0,this.sendRankList()},e.prototype.sendSelectList=function(){var e=this.manager().gamePlay;e&&e.fightGroup&&e.fightGroup.isDeath()||this.manager().sendNearByData()},e.prototype.sendRankList=function(){this.manager().rankListData()},e.prototype.updateNearByListData=function(e){var t=new c.ShenweiyuNearbyPlayerView;t.popup(),t.setListData(e)},e.prototype.updateRankData=function(e){if(e.opresult&&(e.rankIdArr[0]==p.enumRankID.rankid_22||e.rankIdArr[0]==p.enumRankID.rankid_23)){if(this.isSendRankData){var t=new d.ShenweiyuFightRankView;t.updateListData(e.rankDataArr),t.popup(),this.isSendRankData=!1}for(var i=e.rankDataArr.length,n=!1,s="暂无排名",a=0;a<i;a++){var o=e.rankDataArr[a];if(o&&(o&&o.username==u.RoleCenter.instans.vo.username)){n=!0,s=""+(a+1);break}}this.scoreView.curRankTxt.text="我的排名:"+s,this.settleCtrl&&this.settleCtrl.view&&this.settleCtrl.view.isPopup&&(e.rankIdArr[0]==p.enumRankID.rankid_22?this.settleCtrl.view.selfServerRank.text=n?"本服排名:第 "+s+" 名":"本服排名:"+s:this.settleCtrl.view.crossServerRank.text=n?"跨服排名:第 "+s+" 名":"跨服排名:"+s)}},e.prototype.updateTime=function(e){this.scoreView&&(this.scoreView.label_actionTime.text=m.DateUtil.timeCountDown1(e))},e.prototype.showHuDunView=function(){var e=this.view,t=this.manager().getSetting(u.RoleCenter.instans.self.swyLayer).hudun;e&&t&&e.showShield(t[1],t[1],t[2])},e.prototype.hideHuDunView=function(){this.view&&this.view.hideHuDunView()},e}();t.ShenweiyuWarCtrl=y}),define("src/g/ringling/view/RingDanTip",["require","exports","../../../utils/ItemUtils","../../../config/GameConfig","../../net/messages/sbkRingWraithData","../../../manager/GameSocketManager","../../../manager/RoleCenter","../../../utils/RoleUtil"],function(e,t,h,u,n,s,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.btn_use.on(Laya.Event.CLICK,e,e.userHandler),e}return __extends(e,t),e.prototype.setData=function(e,t,i,n){void 0===n&&(n=!1),this.itemid=e;var s=h.ItemUtils.getItemVoById(e),a=u.GameConfig.proDan[e];this.tip_txt.text=s.name;for(var o=0;o<a.pro.length;o++){var r=a.pro[o][1],l=a.pro[o][1]*i;n&&(r=r/100+"%",l=l/100+"%",this.combat.visible=!1),this["pro"+o].text=h.ItemUtils.getShuXingByName(a.pro[o][0]).desc+":"+r,this["prototal"+o].text=h.ItemUtils.getShuXingByName(a.pro[o][0]).desc+":"+l}this.count.text=t+"",this.curuse.text=i+"",this.icon.skin=h.ItemUtils.getIconById(e),this.combat.num_Fight.value=d.RoleUtil.calFightByProp(a.pro)*c.RoleCenter.instans.vo.heronum*i+"",this.tip_tip.text=s.name+"可提升戒灵属性"},e.prototype.userHandler=function(){var e=c.RoleCenter.instans.vo,t=(e.ringLing,e.bagdata.getItemCount(this.itemid)),i=new n.RingWarithDanMsg;i.count=t,i.itemId=this.itemid,s.GSM.sendServer(i),this.close()},e}(ui.ringling.RingDanTipUI);t.RingDanTip=i}),define("src/g/ringling/view/RingLingView",["require","exports","../../../manager/RoleCenter","../../../config/GameConfig","../../net/messages/sbkRingWraithData","../../../manager/GameSocketManager","../../../utils/ItemUtils","../../../utils/system/FloatEffect","../../itemGets/View/ItemGetDlg","../../../plugin/sbkPropTool","../../../enum/EventName","../../../utils/RoleUtil","../../../core/E","../../../manager/NewRedHintsCenter","src/g/ringling/view/RingDanTip","../../Effects/UIEffectsEnum","../../Effects/UIEffectsFactory","../../../component/GAnimation","../../../manager/RuledescManager","../../accessctrl/AccessCenter","../../net/messages/sbkFormula","../../../utils/UIUtils","../../../utils/system/DateUitl"],function(e,t,b,S,n,s,E,a,o,r,l,R,h,x,u,c,d,g,p,m,L,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;e.aniani=new g.GAnimation,e._chuid=0,e._msg=new n.RingWarithMsg,e._uplevel=!1,e.bg.btn_help.visible=!0,e.bg.btn_help.on(Laya.Event.CLICK,e,e.helpHandler),e._eff=d.UIEffectsFactory.Ins.createSAniAndCenter(e.btn_up,c.UIEffectsEnum.getTip_Big,1.6),e.list.hScrollBarSkin="",e.list.scrollBar.elasticDistance=100,e.list.renderHandler=new Laya.Handler(e,e.rendHandler),e.list.selectHandler=new Laya.Handler(e,e.selectHandler),e.btn_up.on(Laya.Event.CLICK,e,e.upHandler),f.UIUtils.initHtmlDiv(e.desc,"#a89e8f"),e.desc.style.leading=5,e.desc.style.wordWrap=!0,e.addChild(e.aniani),e.aniani.x=e.pox.x,e.aniani.y=e.pox.y;var t=s.GSM.ins;return t.on(n.RingWarithMsg.KEY,e,e.ringWarithMsg),t.on(n.RingWarithFightMsg.KEY,e,e.ringWarithFightMsg),t.on(n.RingWarithDanMsg.KEY,e,e.ringWarithDanMsg),e.tabbg1.visible=!0,e.tabbg2.visible=!1,e.btn_tab1.on(Laya.Event.CLICK,e,e.tabclick,[1]),e.btn_tab2.on(Laya.Event.CLICK,e,e.tabclick,[2]),e.tabclick(1),e.btn_get.on(Laya.Event.CLICK,e,e.getItemHandler),e.btn_eat.on(Laya.Event.CLICK,e,e.tipHandler,[8301]),e.btn_eat1.on(Laya.Event.CLICK,e,e.tipHandler,[8302]),e.btn_chu.on(Laya.Event.CLICK,e,e.chuHandler),h.E.ins.on(l.EventName.CHANGEITEM_COUNT,e,e.onChangeItem),e}return __extends(e,i),e.prototype.helpHandler=function(){p.RuledescManager.showRuledesc(m.enumAccessId.ring_ling)},e.prototype.onChangeItem=function(){this.showView()},e.prototype.chuHandler=function(){if(this._chuid!=b.RoleCenter.instans.vo.ringLing.chuzhanId){var e=new n.RingWarithFightMsg;e.id=this._chuid,s.GSM.sendServer(e)}},e.prototype.tipHandler=function(e){var t=e,i=b.RoleCenter.instans.vo,n=new u.RingDanTip;8301==e?n.setData(e,i.bagdata.getItemCount(t),i.ringLing.dan8301):n.setData(e,i.bagdata.getItemCount(t),i.ringLing.dan8302,!0),n.popup()},e.prototype.getItemHandler=function(){o.ItemGetDlg.create(this.itemid)},e.prototype.tabclick=function(e){1==e?(this.tabbg1.visible=!0,this.tabbg2.visible=!1,this.box1.visible=!0,this.box2.visible=!1,this.btn_tab1.color="#f7f8ad",this.btn_tab2.color="#b3af9d",this.btn_tab1.strokeColor="#432306",this.btn_tab2.strokeColor="#24201c"):(this.tabbg1.visible=!1,this.tabbg2.visible=!0,this.box1.visible=!1,this.box2.visible=!0,this.btn_tab2.color="#f7f8ad",this.btn_tab1.color="#b3af9d",this.btn_tab2.strokeColor="#432306",this.btn_tab1.strokeColor="#24201c")},e.prototype.ringWarithFightMsg=function(e){b.RoleCenter.instans.vo.ringLing.chuzhanId=e.id,h.E.ins.event(l.EventName.updateringling),this.list.refresh(),this.selectHandler(this.list.selectedIndex),a.FE.upItems("出战成功")},e.prototype.ringWarithDanMsg=function(e){var t=e.count,i=e.itemId,n=b.RoleCenter.instans.vo.ringLing,s=n["dan"+i];isNaN(s)||(s+=t,n["dan"+i]=s,b.RoleCenter.instans.vo.bagdata.chgItemCount(i,-t)),this.resetPower(),this.showView()},e.prototype.resetPower=function(){var e=b.RoleCenter.instans.vo.combat;r.sbkPropTool.resetRingLing();var t=b.RoleCenter.instans.vo.reCheckComBat();b.RoleCenter.instans.event(l.EventName.FIGHT_UP,[t-e])},e.prototype.ringWarithMsg=function(e){var t=b.RoleCenter.instans.vo.ringLing.idArr,i=b.RoleCenter.instans.vo.ringLing.lvArr,n=t.indexOf(e.id);0<=n?i[n]=e.curLv:(t.push(e.id),i[t.length-1]=e.curLv),this.resetPower(),this.selectHandler(this.list.selectedIndex),this.updateUse(),this.showView()},e.prototype.upHandler=function(){if(!this._uplevel)return a.FE.upItems("道具不足");s.GSM.sendServer(this._msg)},e.prototype.selectHandler=function(e){if(!(e<0)){this.list.selectedIndex=e,this.btn_up.label="升级",this.btn_up.disabled=!1,this.box3.visible=!0;var t,i=this.list.array[e],n=b.RoleCenter.instans.vo.ringLing,s=n.idArr;if(i){this.img_name.skin="res/ringling/jieling_jieshu"+(1==i.id?"":i.id)+".png",this.aniani.load("dynamic2/zhiwawa/jieling/"+i.res+".json"),this.skillicon.skin="dynamic/skillicon/"+i.skill+".png",t=S.GameConfig.ringLingSkillvo[i.skill],this.desc.innerHTML=t.desc;var a=this.list.getCell(e);a&&a.addChild(this.selectimg);var o=s.indexOf(i.id),r=void 0,l=void 0;if(0<=o)l=n.lvArr[o]+1e3*i.id,this._chuid=i.id,S.GameConfig.ringLingvo[l+1]||(this.btn_up.label="已满级",this.btn_up.disabled=!0,this.box3.visible=!1,this._eff.visible=!1),r=S.GameConfig.ringLingvo[l],a&&(a.gray=!1);else l=1e3*i.id+1,r=S.GameConfig.ringLingvo[l],this._chuid=0,this.btn_up.label="激活",this.box3.visible=!0,a&&(a.gray=!0),this._eff.visible=!0;var h=r.prop2,u=0;if(this._chuid){t&&(u+=t.power);for(var c=n.danProp,d=[],g=0;g<h.length;g++){var p=h[g],m=p[0],f=p[1];L.sbkFormula.chkBasicsAttribute(m)&&(f*=1+c[m+"_MULTI"]/L.sbkFormula.BASEDIV_VAL),d.push([m,f])}u+=R.RoleUtil.calFightByProp(d)*b.RoleCenter.instans.vo.heronum+r.power}this.combat.num_Fight.value=u+"";var y=r.upcost[0][0],v=r.upcost[0][1],_=b.RoleCenter.instans.vo.bagdata.getItemCount(y);this._uplevel=v<=_,x.NewRedHintsCenter.ins.setRedHintOpenOrClose(x.enumRedHints.ringlinghuan,this._uplevel),this._eff.visible=this._uplevel&&!this.btn_up.disabled,this.count.text=_+"/"+v,this.icon.skin=E.ItemUtils.getIconById(y);var C=n.lvArr[o]||0;this._msg.id=i.id,this._msg.curLv=C,this.itemid=y;for(var w=0;w<h.length;w++)0<this._chuid?this["pro"+w].text=E.ItemUtils.getShuXingByName(h[w][0]).desc+":"+h[w][1]:this["pro"+w].text=E.ItemUtils.getShuXingByName(h[w][0]).desc+":0";var I=n.chuzhanId;this.lv_font.value=C+"",i&&(-1==n.idArr.indexOf(i.id)?this.btn_chu.disabled=!0:this.btn_chu.disabled=I==i.id)}}},e.prototype.rendHandler=function(e,t){var i=this.list.array[t];if(i){var n=e.getChildByName("m_icon"),s=e.getChildByName("chuicon");n.skin="dynamic/jielingicon/"+i.res+".png",i.id==b.RoleCenter.instans.vo.ringLing.chuzhanId?s.visible=!0:s.visible=!1,-1==b.RoleCenter.instans.vo.ringLing.idArr.indexOf(i.id)?e.gray=!0:e.gray=!1}},e.prototype.showView=function(){var e=S.GameConfig.ringLingShow,t=[],i=y.DateUtil.getKFDay(),n=b.RoleCenter.instans.vo.ringLing;for(var s in e){var a=e[s],o=a.display,r=a.id;if(a.day<=i)if(0<o){var l=n.idArr,h=b.RoleCenter.instans.vo.bagdata.getItemCount(o);(-1!=l.indexOf(r)||0<h)&&t.push(a)}else t.push(a)}this.list.array=t,this.updateUse();var u=this.list.selectedIndex;this.selectHandler(-1==u?0:u)},e.prototype.updateUse=function(){for(var e=b.RoleCenter.instans.vo.ringLing,t=S.GameConfig.proDan[8301],i=S.GameConfig.proDan[8302],n=0,s=e.lvArr,a=0;a<s.length;a++)n+=s[a];if(0<n){var o=t.limit;for(a=0;a<o.length;a++)+o[a][0]<=n&&(this.dan1.text=e.dan8301+"/"+o[a][1]);o=i.limit;for(a=0;a<o.length;a++)+o[a][0]<=n&&(this.dan2.text=e.dan8302+"/"+o[a][1])}else this.dan1.text=this.dan2.text="0/0"},e}(ui.ringling.RingLingUI);t.RingLingView=i}),define("src/g/ringling/ctrl/RingLingCtrl",["require","exports","../../accessctrl/AccessCenter","src/g/ringling/view/RingLingView","../../../manager/LayerManager","../../base/BaseCtrl","../../../manager/GameSocketManager","../../net/messages/sbkRingWraithData","../../../manager/RoleCenter","../../../plugin/sbkPropTool","../../../config/GameConfig","../../../core/E","../../../enum/EventName","../../clearRes/ClearResM","../../../init/Switches"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function e(){var e=t.call(this)||this;return p.Switches.ins.on(i.enumAccessId.ring_ling,e,e.openHandler),e.url="res/atlas/res/ringling.json",o.GSM.ins.on(r.sbkRingWraithData.KEY,e,e.sbkRingWraithData),e}return __extends(e,t),e.prototype.sbkRingWraithData=function(e){var t=l.RoleCenter.instans.vo;t.ringLing=e,h.sbkPropTool.resetRingLing(),t.reCheckComBat(!1),this.checkRed()},e.prototype.checkRed=function(){var e=u.GameConfig.ringLingvo[1001];l.RoleCenter.instans.vo.bagdata.getItemCount(e.upcost[0][0]),e.upcost[0][1]},e.prototype.onAtlasLoaded=function(){this._view||(this._view=new n.RingLingView,this._view.bg.btn_back.on(Laya.Event.CLICK,this,this.closeHandler),this._view.bg.btn_close.on(Laya.Event.CLICK,this,this.closeHandler)),g.ClearResM.resetViewImg(this._view),s.LayerManager.addInPOPWindowLayer(this._view),this._view.showView()},e.prototype.closeHandler=function(){this._view.removeSelf(),this.closeClearRes()},e.prototype.closeClearRes=function(){Laya.loader.clearTextureRes(this.url)},e.prototype.openHandler=function(){this.open(),c.E.ins.on(d.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e}(a.BaseCtrl);t.RingLingCtrl=m}),define("src/g/killtip/view/KillTip",["require","exports","../../../manager/LayerManager","../../../init/TextConst"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.htxt_info.style.font="SimHei",e.htxt_info.style.color="#e3cca9",e.htxt_info.style.stroke=1,e.htxt_info.style.strokeColor="#0d0500",e.htxt_info.style.fontSize=24,e.anchorX=e.anchorY=.5,e.x=Laya.stage.width>>1,e}return __extends(e,t),e.prototype.show=function(e,t){var i=this;this.scaleX=this.scaleY=0,Laya.Tween.clearAll(this),this.y=300,this.htxt_info.innerHTML=s.TextConst.get(607,t,e),this.htxt_info.x=this.width-130-this.htxt_info.contextWidth>>0,this.parent||n.LayerManager.addAlertLayer(this),Laya.Tween.to(this,{scaleX:1,scaleY:1},300,Laya.Ease.sineInOut,new Laya.Handler(this,function(){Laya.timer.once(2e3,i,i.destoryHander)}))},e.prototype.destoryHander=function(){this.removeSelf(),this.destroy(!0)},e}(ui.alert.KillInfoAlertUI);t.KillTip=i}),define("src/g/killtip/ctrl/KillTipCtrl",["require","exports","../../../core/E","../../../enum/EventName","src/g/killtip/view/KillTip"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){i.E.ins.on(n.EventName.POP_KILL_TIP,this,this.popHandler)}return e.prototype.popHandler=function(e,t){if(e){(new s.KillTip).show(e,t)}},e}();t.KillTipCtrl=a}),define("src/g/xunbao/view/XunBaoBoxRewardDlg",["require","exports","../../bag/tips/view/ItemTips","../../../utils/ItemCellUtils","../../../config/GameConfig"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function e(){var e=t.call(this)||this;return e.list_reward.itemRender=ui.custom.ItemNameViewUI,e.list_reward.renderHandler=new Laya.Handler(e,e.onListRender),e.list_reward.clickHandler=new Laya.Handler(e,e.onMouseListRender),e}return __extends(e,t),e.prototype.showBox=function(e){var t=s.GameConfig.fuwenBoxJson[e];t&&(this.list_reward.array=t.reward,this.popup())},e.prototype.onMouseListRender=function(e){i.ItemTips.ins.showTip(this.list_reward.array[e][0],Number(this.list_reward.array[e][1]))},e.prototype.onListRender=function(e,t){n.ItemCellUtils.fillCellForItemNameView(e,this.list_reward.array[t][0],Number(this.list_reward.array[t][1]))},e}(ui.xunbao.XunBaoBoxRewardDlgUI);t.XunBaoBoxRewardDlg=a}),define("src/g/xunbao/view/XunBaoRewardDlg",["require","exports","../../net/messages/sbkLotteryBagData","../../../utils/ItemUtils","../../../utils/ItemCellUtils","../../bag/tips/view/ItemTips","../../forge_new/view/ZhanWenTips","../../../meta/ZhanWenVo","../../../manager/RoleCenter","../../../config/GameConfig","../../../utils/UIUtils","../../../manager/LayerManager","../../../enum/BagItemType","../../../init/TextConst"],function(e,t,d,g,n,o,r,l,p,m,h,u,c,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function a(e){var t=i.call(this)||this;return t._isFlying=!1,t._r=5,t._c=4,t.btn_enter.on(Laya.Event.CLICK,t,t.onCloseHandler),t.view.btn_close.on(Laya.Event.CLICK,t,t.onCloseHandler),t.btn_buy.on(Laya.Event.CLICK,t,t.doBuyHandler),t.list_item.renderHandler=new Laya.Handler(t,t.onListRender),t.list_item.mouseHandler=new Laya.Handler(t,t.onMouseClickHandler),t.list_item.scrollBar.elasticDistance=200,t.listP=new Laya.Point,t.listP.x=t.list_item.x,t.listP.y=t.list_item.y,t._ctrl=e,t.closeHandler=new Laya.Handler(t,t.doCloseEffect),t.view.btn_back.visible=!1,t.count.style.color="#c0b4a3",t.count.style.font="SimHei",t.count.style.fontSize=20,t}return __extends(a,i),a.prototype.doBuyHandler=function(){this.isFlying||(this._isTen?this._ctrl.onBuyTenClickHandler(this._currLotteryId):this._ctrl.onBuyOneClickHandler(this._currLotteryId))},a.prototype.onListRender=function(e,t){g.ItemUtils.getItemOrEq(e.dataSource[0]);n.ItemCellUtils.fillCellForItemNameView(e,e.dataSource[0],Number(e.dataSource[1]),-1)},a.prototype.onMouseClickHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i=g.ItemUtils.getItemOrEq(this.list_item.array[t][0]);if(i.type==c.BagItemType.part&&0<i.effect.length){var n=new r.ZhanWenTips,s=l.ZhanWenStruct.Ins.getZhanWenVo(i.quality,1);n.initData(s,i.id),n.popup()}else o.ItemTips.ins.showTip(this.list_item.array[t][0],Number(this.list_item.array[t][1]))}},a.prototype.showBuyEquipBack=function(e){this.isPopup||this.popup(),this._currLotteryId=e.lotteryId,this.icon1.skin=g.ItemUtils.getSmallIcon(269),this.icon10.skin=g.ItemUtils.getSmallIcon(269),this._isTen=e.type==d.enumLotteryBagDataType.lottery_10_coin||e.type==d.enumLotteryBagDataType.lottery_10_GOLD||e.type==d.enumLotteryBagDataType.lottery_Little10_coin;var t=m.GameConfig.lotterySettingJSON[1],i=p.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery);this.showChange(this._isTen,i);var n=this._isTen?10:1;this.layer_one.visible=this.layer_ten.visible=this.layer_gold.visible=!1,i<n?(this.layer_gold.visible=!0,this.txt_cost.changeText(this._isTen?t.const2[0][1]:t.cost1[0][1])):this._isTen?this.layer_ten.visible=!0:this.layer_one.visible=!0;for(var s=[],a=e.idArr.length,o=0;o<a;){var r=e.idArr[o],l=e.equipIdArr.indexOf(r);if(-1!=l){var h=g.ItemUtils.getEquipVoById(e.equipObj[l].equtemplet);if(!h||!h.id){o++;continue}s.push([h.id,1,r])}else{var u=g.ItemUtils.getItemVoById(r);if(!u||!u.id){o++;continue}s.push([u.id,e.numArr[o]])}o++}a=s.length,this.list_item.array=s,(this.list_item.scrollBar.value=0)<a&&this.fly();var c=t.lottery;this.setCostIconCount(c)},a.prototype.showBuyJadeBack=function(e){this.isPopup||this.popup(),this._currLotteryId=e.lotteryId,this.icon1.skin=g.ItemUtils.getSmallIcon(510),this.icon10.skin=g.ItemUtils.getSmallIcon(510),this._isTen=e.type==d.enumLotteryBagDataType.lottery_10_coin||e.type==d.enumLotteryBagDataType.lottery_10_GOLD||e.type==d.enumLotteryBagDataType.lottery_Little10_coin;var t=m.GameConfig.lotterySettingJSON[3],i=p.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery);this.showChange(this._isTen,i);var n=this._isTen?10:1;this.layer_one.visible=this.layer_ten.visible=this.layer_gold.visible=!1,i<n?(this.layer_gold.visible=!0,this.txt_cost.changeText(this._isTen?t.const2[0][1]:t.cost1[0][1])):this._isTen?this.layer_ten.visible=!0:this.layer_one.visible=!0;for(var s=[],a=e.idArr.length,o=0;o<a;){var r=e.idArr[o],l=e.equipIdArr.indexOf(r);if(-1!=l){var h=g.ItemUtils.getEquipVoById(e.equipObj[l].equtemplet);if(!h||!h.id){o++;continue}s.push([h.id,1,r])}else{var u=g.ItemUtils.getItemVoById(r);if(!u||!u.id){o++;continue}s.push([u.id,e.numArr[o]])}o++}a=s.length,this.list_item.array=s,(this.list_item.scrollBar.value=0)<a&&this.fly();var c=t.lottery;this.setCostIconCount(c)},a.prototype.showBuyLinesBack=function(e){this.isPopup||this.popup(),this._currLotteryId=e.lotteryId,this.icon1.skin=g.ItemUtils.getSmallIcon(881),this.icon10.skin=g.ItemUtils.getSmallIcon(881),this._isTen=e.type==d.enumLotteryBagDataType.lottery_10_coin||e.type==d.enumLotteryBagDataType.lottery_10_GOLD||e.type==d.enumLotteryBagDataType.lottery_Little10_coin;var t=m.GameConfig.lotterySettingJSON[2],i=p.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery);this.showChange(this._isTen,i);var n=this._isTen?10:1;this.layer_one.visible=this.layer_ten.visible=this.layer_gold.visible=!1,i<n?(this.layer_gold.visible=!0,this.txt_cost.changeText(this._isTen?t.const2[0][1]:t.cost1[0][1])):this._isTen?this.layer_ten.visible=!0:this.layer_one.visible=!0;for(var s=[],a=e.idArr.length,o=0;o<a;){var r=e.idArr[o],l=e.zhanwenIdArr.indexOf(r),h=g.ItemUtils.getItemVoById(-1!=l?e.zhanwenDataArr[l].cfgId:r);h&&h.id?(s.push([h.id,e.numArr[o]]),o++):o++}a=s.length,this.list_item.array=s,(this.list_item.scrollBar.value=0)<a&&this.fly();var u=t.lottery;this.setCostIconCount(u)},a.prototype.showChange=function(e,t){this.desc.text=e?s.TextConst.get(789,10<t||0==t?10:t):s.TextConst.get(789,1),this.btn_buy.label=e?s.TextConst.get(790,10):s.TextConst.get(790,1)},Object.defineProperty(a.prototype,"isFlying",{get:function(){return this._isFlying},enumerable:!0,configurable:!0}),a.prototype.fly=function(){this._isFlying=!0,this.list_item.mouseEnabled=!1,this.doFadeIn()},a.prototype.doFadeIn=function(){var e=this.list_item.array.length;e=Math.min(this._r*this._c,e);for(var t=0;t<e;)this.list_item.getCell(t).alpha=0,t++;this.fadeIn(0)},a.prototype.fadeIn=function(e){var t=this,i=this.list_item.array.length;i=Math.min(this._r*this._c,i);var n=this.list_item.getCell(e);Laya.Tween.to(n,{alpha:1},100),++e<i?Laya.timer.once(80,this,this.fadeIn,[e]):Laya.timer.once(100,this,function(){t._isFlying=!1,t.list_item.mouseEnabled=!0})},a.prototype.onCloseHandler=function(){this.close()},a.prototype.doCloseEffect=function(){var e=this.list_item.array.length;e=Math.min(this._r*this._c,e);for(var t,i=0;i<e;){if(t=this.list_item.getCell(i)){var n=t.item,s=n.item.img_item.skin;s&&this.flyIcon(s,h.UIUtils.localToGlobal(n,new Laya.Point(n.item.x+n.item.width/2,n.item.y+n.item.height/2)),a.flyPoint,5<e?500:250)}i++}},a.prototype.flyIcon=function(e,t,i,n){var s=new Laya.Sprite;s.loadImage(e,-25,-25,50,50),s.x=t.x,s.y=t.y,s.scaleX=1.8,s.scaleY=1.8,u.LayerManager.addAlertLayer(s),Laya.Tween.to(s,{x:i.x,y:i.y,scaleX:.8,scaleY:.8},500,null,Laya.Handler.create(this,function(){s.removeSelf(),s.destroy()}))},a.prototype.setCostIconCount=function(e){e&&(this.icon_cost.skin=g.ItemUtils.getSmallIcon(e),this.count.innerHTML="  "+p.RoleCenter.instans.vo.bagdata.getItemCount(e))},a}(ui.xunbao.XunBaoRewardDlgUI);t.XunBaoRewardDlg=i}),define("src/g/xunbao/view/page/LinesPage",["require","exports","../../../../core/E","../../../../enum/EventName","../../../../config/GameConfig","src/g/xunbao/view/XunBaoBoxRewardDlg","../../../../manager/RoleCenter","../../../../utils/ItemCellUtils","../../../bag/tips/view/ItemTips","../../../clearRes/ClearResM","src/g/xunbao/view/XunBaoRewardDlg","../../../../utils/UIUtils","../../../../manager/RuledescManager"],function(e,t,i,n,r,s,l,h,u,c,a,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){function e(e){var t=o.call(this)||this;t._progressArr=[],c.ClearResM.addBgUrl(t.bgimg.skin),t._ctrl=e,t.btn_buy1.on(Laya.Event.CLICK,t,t.onBuyOneHandler),t.btn_buy10.on(Laya.Event.CLICK,t,t.onBuyTenHandler),t.btn_warehouse.on(Laya.Event.CLICK,t,t.openWarehouseHandler),t.count1.style.color="#c0b4a3",t.count1.style.font="SimHei",t.count1.style.fontSize=20,t.count10.style.color="#c0b4a3",t.count10.style.font="SimHei",t.count10.style.fontSize=20;var i=r.GameConfig.lotterySettingJSON[2];if(i)for(var n,s=i.show.length,a=0;a<16;)n=t["item"+a],a<s?(n.visible=!0,h.ItemCellUtils.fillCellForItemNameView(n,i.show[a],1),n.on(Laya.Event.CLICK,t,function(e){u.ItemTips.ins.showTip(e,1)},[i.show[a]])):n.visible=!1,a++;return t._fuwenY=t.img_fuwen.y,t.lab_rule.on(Laya.Event.CLICK,t,function(){g.RuledescManager.showRuledesc(100)}),t}return __extends(e,o),e.prototype.onListRenderHandler=function(e,t){h.ItemCellUtils.fillCellForItemNameView(e,e.dataSource,1)},e.prototype.showPage=function(e){e.removeChildren(),e.addChild(this),this.refreshData(),c.ClearResM.resetViewImg(this),this.bgimg.restskin(),a.XunBaoRewardDlg.flyPoint=d.UIUtils.localToGlobal(this,new Laya.Point(this.btn_warehouse.x+this.btn_warehouse.width/2,this.btn_warehouse.y+this.btn_warehouse.height/2))},e.prototype.refreshData=function(){var e=r.GameConfig.lotterySettingJSON[2];if(e){var t=e.cost1[0][1],i=e.const2[0][1];this.gold1.changeText(999<t?t+"(":t+" ("),this.gold10.changeText(999<i?i+"(":i+" (");var n=l.RoleCenter.instans.vo.bagdata.getItemCount(e.lottery);this.count1.innerHTML=1<=n?"<font color='#03bb00'>"+n+"/1</font>)":"<font color='#ff0f15'>"+n+"/1</font>)",this.count10.innerHTML=10<=n?"<font color='#03bb00'>"+n+"/10</font>)":"<font color='#ff0f15'>"+n+"/10</font>)"}this.lab_num.changeText(this._ctrl.xunbaoNum.toString()),this.updateBoxState();var s=r.GameConfig.commonJson.zhanwenzhufumax,a=this._ctrl.blessing/Number(s.value);this.lab_zf.changeText(this._ctrl.blessing.toString()),0==this.img_fuwen.height?this.img_fuwen.once(Laya.Event.LOADED,this,this.setFuwenProgress,[a]):this.setFuwenProgress(a)},e.prototype.setFuwenProgress=function(e){var t=this.img_fuwen.height*(1-e);this.img_fuwen.scrollRect?this.img_fuwen.scrollRect.y=t:this.img_fuwen.scrollRect=new Laya.Rectangle(0,t,this.img_fuwen.width,this.img_fuwen.height),this.img_fuwen.y=this._fuwenY+t},e.prototype.updateBoxState=function(){var e,t=1;for(this._progressArr[0]=0;t<=5;)(e=r.GameConfig.fuwenBoxJson[t])&&(this._progressArr[t]=e.numb,this["effect"+t].visible=!1,this._ctrl.checkBoxGetState(t)?this["img_box"+t].skin="res/unpack/baoxiang_lv0"+t+"kai.png":(this["img_box"+t].skin="res/unpack/baoxiang_lv0"+t+".png",this._ctrl.xunbaoNum>=e.numb&&(this["effect"+t].visible=!0)),this["img_box"+t].offAll(),this["img_box"+t].on(Laya.Event.CLICK,this,this.onBoxClickHandler,[t])),t++;this.updateBoxProgress()},e.prototype.onBoxClickHandler=function(e){var t=r.GameConfig.fuwenBoxJson[e];!this._ctrl.checkBoxGetState(e)&&this._ctrl.xunbaoNum>=t.numb?this._ctrl.getXunBaoBox(2,e):(this._rewardDlg||(this._rewardDlg=new s.XunBaoBoxRewardDlg),this._rewardDlg.showBox(e))},e.prototype.updateBoxProgress=function(){for(var e=this._progressArr.length,t=1/(e-1),i=0,n=0,s=0,a=0,o=this._ctrl.xunbaoNum;i<e-1;){if(n=this._progressArr[i],!((s=this._progressArr[i+1])<=o)){a+=Math.max(0,(o-n)/(s-n)*t);break}a+=t,i++}this.img_progress.scaleX=Math.min(1,a)},e.prototype.onBuyOneHandler=function(){this._ctrl.onBuyOneClickHandler(2)},e.prototype.onBuyTenHandler=function(){this._ctrl.onBuyTenClickHandler(2)},e.prototype.openWarehouseHandler=function(){i.E.ins.event(n.EventName.OPEN_XUNBAO_WAREHOUSE,2)},e}(ui.xunbao.page.LinesPageUI);t.LinesPage=o}),define("src/g/xunbao/view/page/OrangeEquipPage",["require","exports","../../../../enum/EventName","../../../../core/E","../../../../utils/ItemUtils","../../../../config/GameConfig","../../../../manager/RoleCenter","../../../../utils/ItemCellUtils","../../../bag/tips/view/ItemTips","src/g/xunbao/view/XunBaoRewardDlg","../../../../utils/UIUtils","../../../clearRes/ClearResM","../../../../init/TextConst","../../../../manager/RuledescManager"],function(e,t,l,h,o,u,c,d,i,n,s,a,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){function e(e){var t=r.call(this)||this;t._ctrl=e,t.btn_buy1.on(Laya.Event.CLICK,t,t.onBuyOneHandler),t.btn_buy10.on(Laya.Event.CLICK,t,t.onBuyTenHandler),t.btn_warehouse.on(Laya.Event.CLICK,t,t.openWarehouseHandler),t._des=new laya.html.dom.HTMLDivElement,t._des.width=t.con_log.width=t.con_panel.width,t._des.style.font="SimHei",t._des.style.color="#c0b4a3",t._des.style.fontSize=20,t._des.style.leading=8,t.con_log.addChild(t._des),t.con_panel.vScrollBar.elasticDistance=100,h.E.ins.on(l.EventName.ADDED_XUNBAO_LOG,t,t.onAddedLog),t.count1.style.color="#c0b4a3",t.count1.style.font="SimHei",t.count1.style.fontSize=20,t.count10.style.color="#c0b4a3",t.count10.style.font="SimHei",t.count10.style.fontSize=20;var i=u.GameConfig.lotterySettingJSON[1];if(i)var n=i.show,s=n?n.length:0;for(var a,o=0;o<14;)(a=t["item"+o]).offAll(),o<2&&(a.item_name.visible=!1),a.visible=o<s&&(d.ItemCellUtils.fillCellForItemNameView(a,n[o],1),a.on(Laya.Event.CLICK,t,t.onMouseHandler,[n[o]]),!0),o++;return t.lab_rule.on(Laya.Event.CLICK,t,function(){p.RuledescManager.showRuledesc(99)}),t}return __extends(e,r),e.prototype.onMouseHandler=function(e){i.ItemTips.ins.showTip(e,1)},e.prototype.onAddedLog=function(e){1==e.lotteryId&&this.displayedInStage&&this.appendLog(e)},e.prototype.showPage=function(e){e.removeChildren(),e.addChild(this),a.ClearResM.resetViewImg(this),this.refreshData(),n.XunBaoRewardDlg.flyPoint=s.UIUtils.localToGlobal(this,new Laya.Point(this.btn_warehouse.x+this.btn_warehouse.width/2,this.btn_warehouse.y+this.btn_warehouse.height/2))},e.prototype.refreshData=function(){var e=u.GameConfig.lotterySettingJSON[1];if(e){var t=e.cost1[0][1],i=e.const2[0][1];this.gold1.changeText(999<t?t+"(":t+" ("),this.gold10.changeText(999<i?i+"(":i+" (");var n=c.RoleCenter.instans.vo.bagdata.getItemCount(e.lottery);this.count1.innerHTML=1<=n?"<font color='#03bb00'>"+n+"/1</font>)":"<font color='#ff0f15'>"+n+"/1</font>)",this.count10.innerHTML=10<=n?"<font color='#03bb00'>"+n+"/10</font>)":"<font color='#ff0f15'>"+n+"/10</font>)"}this._des.innerHTML="";for(var s=this._ctrl.getShowLogList(1),a=s.length,o=0;o<a;)this.appendLog(s[o]),o++},e.prototype.appendLog=function(e){var t="",i=o.ItemUtils.getQualityColorById(e.itemCfgId),n=o.ItemUtils.getItemVoById(e.itemCfgId);n&&(t=n.name);var s=o.ItemUtils.getEquipVoById(e.itemCfgId);s&&(t=s.name+"("+o.ItemUtils.getEquipLv(s.limit)+" "+o.ItemUtils.getJobCNById(s.id)+")");var a=o.ItemUtils.getWingEquipVoById(e.itemCfgId);a&&(t=a.name),this._des.appendHTML(g.TextConst.get(788,e.userName,i,t)),this.con_log.height=this._des.contextHeight,this.con_panel.vScrollBar.value=this.con_panel.vScrollBar.max},e.prototype.onBuyOneHandler=function(){this._ctrl.onBuyOneClickHandler(1)},e.prototype.onBuyTenHandler=function(){this._ctrl.onBuyTenClickHandler(1)},e.prototype.openWarehouseHandler=function(){h.E.ins.event(l.EventName.OPEN_XUNBAO_WAREHOUSE,1)},e}(ui.xunbao.page.OrangeEquipPageUI);t.OrangeEquipPage=r}),define("src/g/xunbao/view/page/JadePage",["require","exports","../../../../core/E","../../../../enum/EventName","../../../../config/GameConfig","../../../../utils/ItemCellUtils","../../../bag/tips/view/ItemTips","../../../../utils/UIUtils","src/g/xunbao/view/XunBaoRewardDlg","../../../../manager/RoleCenter","../../../../utils/ItemUtils","../../../clearRes/ClearResM","../../../../init/TextConst","../../../../manager/RuledescManager"],function(e,t,l,h,u,c,i,n,s,d,o,a,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){function e(e){var t=r.call(this)||this;t._ctrl=e,t.btn_buy1.on(Laya.Event.CLICK,t,t.onBuyOneHandler),t.btn_buy10.on(Laya.Event.CLICK,t,t.onBuyTenHandler),t.btn_warehouse.on(Laya.Event.CLICK,t,t.openWarehouseHandler),t._des=new laya.html.dom.HTMLDivElement,t._des.width=t.con_log.width=t.con_panel.width,t._des.style.font="SimHei",t._des.style.color="#c0b4a3",t._des.style.fontSize=20,t._des.style.leading=8,t.con_log.addChild(t._des),t.con_panel.vScrollBar.elasticDistance=100,l.E.ins.on(h.EventName.ADDED_XUNBAO_LOG,t,t.onAddedLog),t.count1.style.color="#c0b4a3",t.count1.style.font="SimHei",t.count1.style.fontSize=20,t.count10.style.color="#c0b4a3",t.count10.style.font="SimHei",t.count10.style.fontSize=20;var i=u.GameConfig.lotterySettingJSON[3];if(i)var n=i.show,s=n?n.length:0;for(var a,o=0;o<8;)(a=t["item"+o]).offAll(),a.visible=o<s&&(c.ItemCellUtils.fillCellForItem0View(a,n[o],1),a.on(Laya.Event.CLICK,t,t.onMouseHandler,[n[o]]),!0),o++;return t.lab_rule.on(Laya.Event.CLICK,t,function(){p.RuledescManager.showRuledesc(210)}),t}return __extends(e,r),e.prototype.onMouseHandler=function(e){i.ItemTips.ins.showTip(e,1)},e.prototype.onAddedLog=function(e){3==e.lotteryId&&this.displayedInStage&&this.appendLog(e)},e.prototype.showPage=function(e){e.removeChildren(),e.addChild(this),a.ClearResM.resetViewImg(this),this.refreshData(),s.XunBaoRewardDlg.flyPoint=n.UIUtils.localToGlobal(this,new Laya.Point(this.btn_warehouse.x+this.btn_warehouse.width/2,this.btn_warehouse.y+this.btn_warehouse.height/2))},e.prototype.refreshData=function(){var e=u.GameConfig.lotterySettingJSON[3];if(e){var t=e.cost1[0][1],i=e.const2[0][1];this.gold1.changeText(999<t?t+"(":t+" ("),this.gold10.changeText(999<i?i+"(":i+" (");var n=d.RoleCenter.instans.vo.bagdata.getItemCount(e.lottery);this.count1.innerHTML=1<=n?"<font color='#03bb00'>"+n+"/1</font>)":"<font color='#ff0f15'>"+n+"/1</font>)",this.count10.innerHTML=10<=n?"<font color='#03bb00'>"+n+"/10</font>)":"<font color='#ff0f15'>"+n+"/10</font>)"}this._des.innerHTML="";for(var s=this._ctrl.getShowLogList(3),a=s.length,o=0;o<a;)this.appendLog(s[o]),o++},e.prototype.appendLog=function(e){var t="",i=o.ItemUtils.getQualityColorById(e.itemCfgId),n=o.ItemUtils.getItemVoById(e.itemCfgId);n&&(t=n.name);var s=o.ItemUtils.getEquipVoById(e.itemCfgId);s&&(t=s.name+"("+o.ItemUtils.getEquipLv(s.limit)+" "+o.ItemUtils.getJobCNById(s.id)+")");var a=o.ItemUtils.getWingEquipVoById(e.itemCfgId);a&&(t=a.name),this._des.appendHTML(g.TextConst.get(788,e.userName,i,t)),this.con_log.height=this._des.contextHeight,this.con_panel.vScrollBar.value=this.con_panel.vScrollBar.max},e.prototype.onBuyOneHandler=function(){this._ctrl.onBuyOneClickHandler(3)},e.prototype.onBuyTenHandler=function(){this._ctrl.onBuyTenClickHandler(3)},e.prototype.openWarehouseHandler=function(){l.E.ins.event(h.EventName.OPEN_XUNBAO_WAREHOUSE,3)},e}(ui.xunbao.page.JadePageUI);t.JadePage=r}),define("src/g/xunbao/view/XunBaoView",["require","exports","../../../enum/EventName","../../../core/E","src/g/xunbao/view/page/LinesPage","../../../manager/LayerManager","src/g/xunbao/view/page/OrangeEquipPage","../../accessctrl/AccessCenter","../../proxy/MultiLevelUIProxy","../../monopoly/view/MonopolyView","../../clearRes/ClearResM","../../../manager/AM","../../../manager/RoleCenter","../../../manager/NewRedHintsCenter","../../net/messages/sbkLotteryBagC2GS","../../net/messages/OpResultType","../../../manager/GameSocketManager","src/g/xunbao/view/page/JadePage","../../../runtime/resload/GameResLoad","../../../init/TextConst"],function(e,t,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e){var t=i.call(this)||this;return t.xunBaoshenzhuang=0,t.xunBaofuwen=1,t.xunBaoJade=2,t.monopoly=3,t._ctrl=e,t.bg.btn_back.on(Laya.Event.CLICK,t,t.onCloseHandler),t.bg.btn_close.on(Laya.Event.CLICK,t,t.onCloseHandler),t._tabProxy=new h.MultiLevelUIProxy,t._tabProxy.registerTab(t.tab_x,0),t._tabProxy.registerTagIndex(l.enumAccessId.xunBaoshenzhuang,t.xunBaoshenzhuang),t._tabProxy.registerTagIndex(l.enumAccessId.xunBaofuwen,t.xunBaofuwen),t._tabProxy.registerTagIndex(l.enumAccessId.xunBaoJade,t.xunBaoJade),t._tabProxy.registerTagIndex(l.enumAccessId.monopoly,t.monopoly),t._tabProxy.selectHandler=new Laya.Handler(t,t.changePageHandler),t}return __extends(e,i),e.prototype.showView=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this._tabProxy.open(e),o.LayerManager.addInPOPWindowLayer(this,t,!0,!0,!1,i),c.ClearResM.resetViewImg(this),s.E.ins.on(n.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.closeClearRes=function(){s.E.ins.off(n.EventName.CLOSEALLWINDOWS,this,this.closeClearRes),c.ClearResM.clearResFolder("xunbao/"),c.ClearResM.clearResFolder("monopoly/")},e.prototype.revertTab=function(){this._tabProxy.revertTab()},e.prototype.onCloseHandler=function(){p.NewRedHintsCenter.ins.checkRedIsOpen(p.enumRedHints.xunbao_lines_warehouse)||p.NewRedHintsCenter.ins.checkRedIsOpen(p.enumRedHints.xunbao_equip_warehouse)||p.NewRedHintsCenter.ins.checkRedIsOpen(p.enumRedHints.xunbao_jade_warehouse)?d.AM.showAdvanced(C.TextConst.get(791),new Laya.Handler(this,this.takeOutAll),new Laya.Handler(this,this.doClose),new Laya.Handler(this,this.doClose),C.TextConst.get(792),C.TextConst.get(793)):this.doClose()},e.prototype.takeOutAll=function(){var e;g.RoleCenter.instans.bagRoomEnough()?((e=new m.sbkLotteryBagC2GS).msgidx=f.enumOpResultType.lotteryBag_takeOutAll,y.GSM.sendServer(e),(e=new m.sbkLotteryZhanwenBagC2GS).msgidx=f.enumOpResultType.lotteryZhanwenBag_takeOutAll,y.GSM.sendServer(e),(e=new m.sbkLotteryShenyuBagC2GS).msgidx=f.enumOpResultType.lotteryShenyuBag_takeOutAll,y.GSM.sendServer(e),this.doClose()):Laya.timer.frameOnce(2,this,function(){d.AM.showBagNotEnough()})},e.prototype.doClose=function(){this.removeSelf(),this.closeClearRes()},e.prototype.changePageHandler=function(e){e==this.xunBaoshenzhuang?(this._orangeEquip||(this._orangeEquip=new r.OrangeEquipPage(this._ctrl)),this._selectPage=this._orangeEquip):e==this.xunBaofuwen?(this._lines||(this._lines=new a.LinesPage(this._ctrl)),this._selectPage=this._lines):e==this.xunBaoJade?(this._jade||(this._jade=new v.JadePage(this._ctrl)),this._selectPage=this._jade):e==this.monopoly&&(this._monopoly||(_.GameResLoad.load("res/atlas/res/monopoly.json"),this._monopoly=new u.MonopolyView),this._selectPage=this._monopoly),this._selectPage&&this._selectPage.showPage(this.box_con)},e.prototype.refreshData=function(){this._selectPage&&this._selectPage.refreshData()},e}(ui.xunbao.XunBaoViewUI);t.XunBaoView=i}),define("src/g/xunbao/ctrl/XunBaoCtrl",["require","exports","src/g/xunbao/view/XunBaoView","../../../core/E","../../../enum/EventName","../../../config/GameConfig","../../net/messages/OpResultType","../../../manager/GameSocketManager","../../net/messages/sbkLotteryC2GS","../../net/messages/sbkLotteryShowListGS2C","../../../manager/StateManger","../../../manager/RoleCenter","../../net/messages/sbkLotteryBagData","src/g/xunbao/view/XunBaoRewardDlg","../../../manager/NewRedHintsCenter","../../../init/Switches","../../accessctrl/AccessCenter","../../../init/GameEventDispatcher","../../../init/TextConst","../../../component/LotteryBuyAlert"],function(e,t,n,a,o,r,s,l,h,i,u,c,d,g,p,m,f,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(){function e(){this._showLogList=[],this._boxGetting=[],this._blessing=0,this._xunbaoNum=0}return e.prototype.init=function(){var e=m.Switches.ins;e.on(f.enumAccessId.xunBao,this,this.onOpenIdHandler,[f.enumAccessId.xunBaoshenzhuang]),e.on(f.enumAccessId.xunBaofuwen,this,this.onOpenIdHandler,[f.enumAccessId.xunBaofuwen]),e.on(f.enumAccessId.xunBaoJade,this,this.onOpenIdHandler,[f.enumAccessId.xunBaoJade]),e.on(f.enumAccessId.xunBaoshenzhuang,this,this.onOpenIdHandler,[f.enumAccessId.xunBaoshenzhuang]),e.on(f.enumAccessId.monopoly,this,this.onOpenIdHandler,[f.enumAccessId.monopoly]),c.RoleCenter.instans.on(s.enumOpResultType.lottery_buy1+"",this,this.onBuyOneBack),c.RoleCenter.instans.on(s.enumOpResultType.lottery_buy10+"",this,this.onBuyTenBack),c.RoleCenter.instans.on(s.enumOpResultType.lottery_Zhanwendata+"",this,this.onBoxInitDataBack),c.RoleCenter.instans.on(s.enumOpResultType.lotteryZhanwen_weekboxClear+"",this,this.onClearBoxDataBack),l.GSM.ins.on(i.sbkLotteryShowListGS2C.KEY,this,this.onInitDataBack),l.GSM.ins.on(i.sbkLotteryShowListData.KEY,this,this.onAddShowDataBack),l.GSM.ins.on(d.sbkLotteryBagData.KEY,this,this.onLotteryDataBack),l.GSM.ins.on(d.sbkLotteryShenyuBagData.KEY,this,this.onLotteryShenyuDataBack),l.GSM.ins.on(d.sbkLotteryZhanwenBagData.KEY,this,this.onLotteryZhanwenDataBack),l.GSM.ins.on(h.sbkGetLotteryZhanwenWeekBoxMsg.KEY,this,this.onBoxGetHandler),a.E.ins.once(o.EventName.INIT_SELFSETOVER,this,this.doInitData)},e.prototype.doInitData=function(){this.requestInitData(),this.requestJadeInitData(),this.requestZhanWenInitData(),this.requestBoxInitData(),f.AccessCenter.ins.inited?this.onInitRed():a.E.ins.on(o.EventName.ACCESS_CENTER_INITED,this,this.onInitRed)},e.prototype.onInitRed=function(){f.AccessCenter.ins.checkOpen(f.enumAccessId.xunBaoshenzhuang)?this.checkEquipTurnRed():f.AccessCenter.ins.on(f.enumAccessId.xunBaoshenzhuang,this,this.checkEquipTurnRed),f.AccessCenter.ins.checkOpen(f.enumAccessId.xunBaofuwen)?this.checkZhanwenTurnRed():f.AccessCenter.ins.on(f.enumAccessId.xunBaofuwen,this,this.checkZhanwenTurnRed),f.AccessCenter.ins.checkOpen(f.enumAccessId.xunBaoJade)?this.checkJadeTurnRed():f.AccessCenter.ins.on(f.enumAccessId.xunBaoJade,this,this.checkJadeTurnRed),a.E.ins.on(o.EventName.CHANGEITEM_COUNT,this,this.onBagItemChanged)},e.prototype.onBagItemChanged=function(e){e==r.GameConfig.lotterySettingJSON[1].lottery?this.checkEquipTurnRed():e==r.GameConfig.lotterySettingJSON[2].lottery?this.checkZhanwenTurnRed():e==r.GameConfig.lotterySettingJSON[3].lottery&&this.checkJadeTurnRed()},e.prototype.onOpenIdHandler=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),t&&this.onOpenHandler(e,i,n)},e.prototype.onOpenHandler=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this._view||(this._view=new n.XunBaoView(this)),this._view.showView(e,t,i)},e.prototype.requestInitData=function(){var e=r.GameConfig.lotterySettingJSON[1],t=new h.sbkLotteryC2GS;t.msgidx=s.enumOpResultType.lottery_showList,t.lotteryId=e.lotteryId,l.GSM.sendServer(t)},e.prototype.requestJadeInitData=function(){var e=r.GameConfig.lotterySettingJSON[3],t=new h.sbkLotteryC2GS;t.msgidx=s.enumOpResultType.lottery_showList,t.lotteryId=e.lotteryId,l.GSM.sendServer(t)},e.prototype.requestZhanWenInitData=function(){var e=r.GameConfig.lotterySettingJSON[2],t=new h.sbkLotteryZhanwenC2GS;t.msgidx=s.enumOpResultType.lottery_showList,t.lotteryId=e.lotteryId,l.GSM.sendServer(t)},e.prototype.onInitDataBack=function(e){this._showLogList[e.lotteryId-1]=e.showList},e.prototype.getShowLogList=function(e){return this._showLogList[e-1]},e.prototype.onAddShowDataBack=function(e){this._showLogList[e.lotteryId-1]?this._showLogList[e.lotteryId-1].push(e):this._showLogList[e.lotteryId-1]=[e],a.E.ins.event(o.EventName.ADDED_XUNBAO_LOG,e)},e.prototype.checkEquipTurnRed=function(){var e=r.GameConfig.lotterySettingJSON[1],t=c.RoleCenter.instans.vo.bagdata.getItemCount(e.lottery),i=f.AccessCenter.ins.checkOpen(f.enumAccessId.xunBaoshenzhuang);i&&0<t?p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_turn1,!0):p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_turn1,!1),i&&10<=t?p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_turn10,!0):p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_turn10,!1)},e.prototype.checkJadeTurnRed=function(){var e=r.GameConfig.lotterySettingJSON[3],t=c.RoleCenter.instans.vo.bagdata.getItemCount(e.lottery),i=f.AccessCenter.ins.checkOpen(f.enumAccessId.xunBaoJade);i&&0<t?p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_turn1,!0):p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_turn1,!1),i&&10<=t?p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_turn10,!0):p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_turn10,!1)},e.prototype.checkZhanwenTurnRed=function(){var e=r.GameConfig.lotterySettingJSON[2],t=c.RoleCenter.instans.vo.bagdata.getItemCount(e.lottery),i=f.AccessCenter.ins.checkOpen(f.enumAccessId.xunBaofuwen);i&&0<t?p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_turn1,!0):p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_turn1,!1),i&&10<=t?p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_turn10,!0):p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_turn10,!1)},e.prototype.onBuyOneClickHandler=function(e){var t=r.GameConfig.lotterySettingJSON[e];if(u.StateManger.showLotteryBuyAlert&&c.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery)<1){this._buyAlert||(this._buyAlert=new _.LotteryBuyAlert);var i,n=t.cost1[0][1];1==e?i=v.TextConst.get(784):2==e?i=v.TextConst.get(785):3==e&&(i=v.TextConst.get(786)),this._buyAlert.showAlert(v.TextConst.get(787,n,i,1),Laya.Handler.create(this,this.onBuyOneHandler,[e]))}else this.onBuyOneHandler(e)},e.prototype.onBuyTenClickHandler=function(e){var t=r.GameConfig.lotterySettingJSON[e];if(u.StateManger.showLotteryBuyAlert&&!c.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery)){this._buyAlert||(this._buyAlert=new _.LotteryBuyAlert);var i,n=t.const2[0][1];1==e?i=v.TextConst.get(784):2==e?i=v.TextConst.get(785):3==e&&(i=v.TextConst.get(786)),this._buyAlert.showAlert(v.TextConst.get(787,n,i,10),Laya.Handler.create(this,this.onBuyTenHandler,[e]))}else this.onBuyTenHandler(e)},e.prototype.onBuyOneHandler=function(e){var t=r.GameConfig.lotterySettingJSON[e],i=t.cost1[0][1];if(c.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery)||c.RoleCenter.instans.self.GOLD>=i){if(1==e)(n=new h.sbkLotteryC2GS).msgidx=s.enumOpResultType.lottery_buy1,n.lotteryId=t.lotteryId,l.GSM.sendServer(n);else if(2==e){(n=new h.sbkLotteryZhanwenC2GS).msgidx=s.enumOpResultType.lottery_buy1,n.lotteryId=t.lotteryId,l.GSM.sendServer(n)}else if(3==e){var n;(n=new h.sbkLotteryShenyuC2GS).msgidx=s.enumOpResultType.lottery_buy1,n.lotteryId=t.lotteryId,l.GSM.sendServer(n)}}else m.Switches.ins.event(f.enumAccessId.goldInsufficient)},e.prototype.onBuyOneBack=function(e){e.opresult?console.log("买1个成功！"):console.log("买1个失败！")},e.prototype.onBuyTenHandler=function(e){var t=r.GameConfig.lotterySettingJSON[e],i=t.const2[0][1];!c.RoleCenter.instans.vo.bagdata.getItemCount(t.lottery)&&c.RoleCenter.instans.self.GOLD<i?m.Switches.ins.event(f.enumAccessId.goldInsufficient):this.lottery_buy10(e)},e.prototype.lottery_buy10=function(e){if(1==e)(t=new h.sbkLotteryC2GS).msgidx=s.enumOpResultType.lottery_buy10,t.lotteryId=e,l.GSM.sendServer(t);else if(2==e){(t=new h.sbkLotteryZhanwenC2GS).msgidx=s.enumOpResultType.lottery_buy10,t.lotteryId=e,l.GSM.sendServer(t)}else if(3==e){var t;(t=new h.sbkLotteryShenyuC2GS).msgidx=s.enumOpResultType.lottery_buy10,t.lotteryId=e,l.GSM.sendServer(t)}},e.prototype.onBuyTenBack=function(e){e.opresult?console.log("买10个成功！"):console.log("买10个失败！")},e.prototype.onLotteryDataBack=function(e){e.type!=d.enumLotteryBagDataType.bag&&(this._rewardDlg||(this._rewardDlg=new g.XunBaoRewardDlg(this)),this._rewardDlg.showBuyEquipBack(e),this.lotterySuccess(e))},e.prototype.onLotteryZhanwenDataBack=function(e){e.type!=d.enumLotteryBagDataType.bag&&(this._rewardDlg||(this._rewardDlg=new g.XunBaoRewardDlg(this)),this._rewardDlg.showBuyLinesBack(e),this.lotteryZhanWenSuccess(e))},e.prototype.onLotteryShenyuDataBack=function(e){e.type!=d.enumLotteryBagDataType.bag&&(this._rewardDlg||(this._rewardDlg=new g.XunBaoRewardDlg(this)),this._rewardDlg.showBuyJadeBack(e),this.lotteryShenyuSuccess(e))},e.prototype.lotterySuccess=function(e){var t=0,i=r.GameConfig.lotterySettingJSON[e.lotteryId];if(e.type==d.enumLotteryBagDataType.lottery_10_GOLD)c.RoleCenter.instans.vo.GOLD-=i.const2[0][1],c.RoleCenter.instans.event(o.EventName.ROLE_PROP_CHANGE),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10;else if(e.type==d.enumLotteryBagDataType.lottery_1_GOLD)c.RoleCenter.instans.vo.GOLD-=i.cost1[0][1],c.RoleCenter.instans.event(o.EventName.ROLE_PROP_CHANGE),y.GE.ins.event(y.enumGameEvent.XUNBAO_ONE_SUCCESS),t=1;else if(e.type==d.enumLotteryBagDataType.lottery_10_coin)c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery)<10&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-10),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10;else if(e.type==d.enumLotteryBagDataType.lottery_1_coin)c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery)<1&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-1),y.GE.ins.event(y.enumGameEvent.XUNBAO_ONE_SUCCESS),t=1;else if(e.type==d.enumLotteryBagDataType.lottery_Little10_coin){var n=c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery);c.RoleCenter.instans.vo.chgItemCount(i.lottery,-n),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10}0<t&&a.E.ins.event(o.EventName.SHENZHUANG_XUNBAO_SUCCESS,t),this._view&&this._view.refreshData()},e.prototype.lotteryShenyuSuccess=function(e){var t=0,i=r.GameConfig.lotterySettingJSON[e.lotteryId];if(e.type==d.enumLotteryBagDataType.lottery_10_GOLD)c.RoleCenter.instans.vo.GOLD-=i.const2[0][1],c.RoleCenter.instans.event(o.EventName.ROLE_PROP_CHANGE),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10;else if(e.type==d.enumLotteryBagDataType.lottery_1_GOLD)c.RoleCenter.instans.vo.GOLD-=i.cost1[0][1],c.RoleCenter.instans.event(o.EventName.ROLE_PROP_CHANGE),y.GE.ins.event(y.enumGameEvent.XUNBAO_ONE_SUCCESS),t=1;else if(e.type==d.enumLotteryBagDataType.lottery_10_coin)c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery)<10&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-10),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10;else if(e.type==d.enumLotteryBagDataType.lottery_1_coin)c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery)<1&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-1),y.GE.ins.event(y.enumGameEvent.XUNBAO_ONE_SUCCESS),t=1;else if(e.type==d.enumLotteryBagDataType.lottery_Little10_coin){var n=c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery);c.RoleCenter.instans.vo.chgItemCount(i.lottery,-n),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10}0<t&&a.E.ins.event(o.EventName.SHENYU_XUNBAO_SUCCESS,t),this._view&&this._view.refreshData()},e.prototype.lotteryZhanWenSuccess=function(e){var t=0,i=r.GameConfig.lotterySettingJSON[e.lotteryId],n=r.GameConfig.commonJson.zhanwenzhufunum;if(e.type==d.enumLotteryBagDataType.lottery_10_GOLD)c.RoleCenter.instans.vo.GOLD-=i.const2[0][1],c.RoleCenter.instans.event(o.EventName.ROLE_PROP_CHANGE),this.xunbaoNum+=10,this.blessing+=10*Number(n.value),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10;else if(e.type==d.enumLotteryBagDataType.lottery_1_GOLD)c.RoleCenter.instans.vo.GOLD-=i.cost1[0][1],c.RoleCenter.instans.event(o.EventName.ROLE_PROP_CHANGE),this.xunbaoNum++,this.blessing+=Number(n.value),y.GE.ins.event(y.enumGameEvent.XUNBAO_ONE_SUCCESS),t=1;else if(e.type==d.enumLotteryBagDataType.lottery_10_coin)c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery)<10&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-10),this.xunbaoNum+=10,this.blessing+=10*Number(n.value),y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10;else if(e.type==d.enumLotteryBagDataType.lottery_1_coin)c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery)<1&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-1),this.xunbaoNum++,this.blessing+=Number(n.value),y.GE.ins.event(y.enumGameEvent.XUNBAO_ONE_SUCCESS),t=1;else if(e.type==d.enumLotteryBagDataType.lottery_Little10_coin){var s=c.RoleCenter.instans.vo.bagdata.getItemCount(i.lottery);10<s&&console.log("寻宝消耗与后台不同步了"),c.RoleCenter.instans.vo.chgItemCount(i.lottery,-s),this.xunbaoNum+=s,this.blessing+=Number(n.value)*s,y.GE.ins.event(y.enumGameEvent.XUNBAO_TEN_SUCCESS),t=10}0<t&&a.E.ins.event(o.EventName.ZHANWEN_XUNBAO_SUCCESS,t),this._view&&this._view.refreshData()},e.prototype.requestBoxInitData=function(){var e=new h.sbkLotteryZhanwenC2GS;e.lotteryId=2,e.msgidx=s.enumOpResultType.lottery_Zhanwendata,l.GSM.sendServer(e)},e.prototype.onBoxInitDataBack=function(e){this.blessing=e.reservedata.shift(),this.xunbaoNum=e.reservedata.shift(),this._boxGetting=e.reservedata},e.prototype.onClearBoxDataBack=function(e){this.xunbaoNum=0,this._boxGetting.length=0,this._view&&this._view.refreshData(),this.checkBoxRed()},e.prototype.onBoxGetHandler=function(e){-1==this._boxGetting.indexOf(e.weekBoxId)&&this._boxGetting.push(e.weekBoxId),this._view&&this._view.refreshData(),this.checkBoxRed()},Object.defineProperty(e.prototype,"blessing",{get:function(){return this._blessing},set:function(e){var t=r.GameConfig.commonJson.zhanwenzhufumax;this._blessing=e%Number(t.value),this._view&&this._view.refreshData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xunbaoNum",{get:function(){return this._xunbaoNum},set:function(e){this._xunbaoNum=e,this._view&&this._view.refreshData(),Laya.timer.callLater(this,this.checkBoxRed)},enumerable:!0,configurable:!0}),e.prototype.checkBoxGetState=function(e){return-1!=this._boxGetting.indexOf(e)},e.prototype.checkBoxRed=function(){for(var e,t=1,i=!1;t<=5;){if((e=r.GameConfig.fuwenBoxJson[t])&&this.xunbaoNum>=e.numb&&!this.checkBoxGetState(t)){i=!0;break}t++}p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_box,i)},e.prototype.getXunBaoBox=function(e,t){var i=new h.sbkGetLotteryZhanwenWeekBoxMsg;i.lotteryId=e,i.weekBoxId=t,l.GSM.sendServer(i)},e}();t.XunBaoCtrl=C}),define("src/g/xunbao/view/XunBaoWarehouseDlg",["require","exports","../../../utils/ItemCellUtils","../../../manager/RoleCenter","../../../utils/ItemUtils","../../../core/E","../../../enum/EventName","../../clearRes/ClearResM"],function(e,t,n,l,u,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e){var t=i.call(this)||this;return t._ctrl=e,t.list_item.renderHandler=new Laya.Handler(t,t.onRenderItemHandler),t.btn_get.on(Laya.Event.CLICK,t,t.onTakeAllOutHandler),t.bg.btn_close.on(Laya.Event.CLICK,t,t.onClose),t.bg.btn_back.visible=!1,t.list_item.mouseHandler=new Laya.Handler(t,t.onMouseClickHandler),s.E.ins.on(a.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,t,t.onDataChanged),t}return __extends(e,i),e.prototype.showView=function(e){this._currLotteryId=e,1==this._currLotteryId?this.img_title.skin="res/xunbao/biaoti_xunbaocangku.png":2==this._currLotteryId?this.img_title.skin="res/title/title_zhanwen.png":3==this._currLotteryId&&(this.img_title.skin="res/xunbao/biaoti_shenyucangku.png"),this.refreshData(),this.popup(),o.ClearResM.resetViewImg(this)},e.prototype.refreshData=function(){1==this._currLotteryId?this.updateItemList():2==this._currLotteryId?this.updateZhanwenList():3==this._currLotteryId&&this.updateShenyuItemList()},e.prototype.onDataChanged=function(e){this.displayedInStage&&this.refreshData()},e.prototype.onClose=function(){this.close()},e.prototype.updateItemList=function(){for(var e=l.RoleCenter.instans.self.lotteryData.bagData,t=[],i=e.idArr.length,n=0;n<i;){var s=e.idArr[n],a=e.equipIdArr.indexOf(s);if(-1!=a){var o=u.ItemUtils.getEquipVoById(e.equipObj[a].equtemplet);if(!o||!o.id){n++;continue}t.push([o.id,1,s])}else{var r=u.ItemUtils.getItemVoById(s);if(!r||!r.id){n++;continue}t.push([r.id,e.numArr[n]])}n++}this.list_item.array=t.sort(function(e,t){var i=e[0],n=13e3;if(i<1e4){var s=u.ItemUtils.getItemVoById(i);s&&(n=1e5*s.quality)}else{var a=u.ItemUtils.getEquipVoById(i);a&&(n=1e5*a.quality+a.limit)}var o=t[0],r=13e3;if(o<1e4){var l=u.ItemUtils.getItemVoById(o);l&&(r=1e5*l.quality)}else{var h=u.ItemUtils.getEquipVoById(o);h&&(r=1e5*h.quality+h.limit)}return r-n})},e.prototype.updateShenyuItemList=function(){for(var e=l.RoleCenter.instans.self.lotteryShenyuData.bagData,t=[],i=e.idArr.length,n=0;n<i;){var s=e.idArr[n],a=e.equipIdArr.indexOf(s);if(-1!=a){var o=u.ItemUtils.getEquipVoById(e.equipObj[a].equtemplet);if(!o||!o.id){n++;continue}t.push([o.id,1,s])}else{var r=u.ItemUtils.getItemVoById(s);if(!r||!r.id){n++;continue}t.push([r.id,e.numArr[n]])}n++}this.list_item.array=t.sort(function(e,t){var i=e[0],n=13e3;if(i<1e4){var s=u.ItemUtils.getItemVoById(i);s&&(n=2e5*s.quality)}else{var a=u.ItemUtils.getEquipVoById(i);a&&(n=1e5*a.quality+a.limit)}var o=t[0],r=13e3;if(o<1e4){var l=u.ItemUtils.getItemVoById(o);l&&(r=2e5*l.quality)}else{var h=u.ItemUtils.getEquipVoById(o);h&&(r=1e5*h.quality+h.limit)}return r-n})},e.prototype.updateZhanwenList=function(){for(var e=l.RoleCenter.instans.self.lotteryZhanwenData.bagData,t=[],i=e.idArr.length,n=0;n<i;){var s=e.idArr[n],a=e.zhanwenIdArr.indexOf(s),o=u.ItemUtils.getItemVoById(-1!=a?e.zhanwenDataArr[a].cfgId:s);o&&o.id?(-1==a?t.push([o.id,e.numArr[n]]):t.push([o.id,e.numArr[n],s]),n++):n++}this.list_item.array=t.sort(function(e,t){var i=e[0],n=13e3,s=u.ItemUtils.getItemVoById(i);s&&(n=1e5*s.quality);var a=t[0],o=13e3,r=u.ItemUtils.getItemVoById(a);return r&&(o=1e5*r.quality),o-n})},e.prototype.onRenderItemHandler=function(e,t){u.ItemUtils.getItemOrEq(e.dataSource[0]);n.ItemCellUtils.fillCellForItemNameView(e,e.dataSource[0],Number(e.dataSource[1]))},e.prototype.onMouseClickHandler=function(e,t){if(e.type==Laya.Event.CLICK){var i=this.list_item.selectedItem;i&&this._ctrl.takeOutOne(this._currLotteryId,2<i.length?i[2]:i[0])}},e.prototype.onTakeAllOutHandler=function(){0<this.list_item.array.length&&Laya.timer.once(800,this,this.onClose),this._ctrl.takeOutAll(this._currLotteryId)},e}(ui.xunbao.XunBaoWarehouseDlgUI);t.XunBaoWarehouseDlg=i}),define("src/g/xunbao/ctrl/XunBaoWarehouseCtrl",["require","exports","../../net/messages/sbkLotteryBagC2GS","../../net/messages/OpResultType","../../../manager/GameSocketManager","../../../manager/RoleCenter","../../net/messages/sbkLotteryBagData","../../../core/E","../../../enum/EventName","../../net/messages/ErrConst","../../../utils/system/FloatEffect","../../../manager/AM","src/g/xunbao/view/XunBaoWarehouseDlg","../../../manager/NewRedHintsCenter","../../../plugin/view/ToolTip","../../../utils/system/ErrCodeView","../../../utils/DialogQueue"],function(e,t,n,s,a,l,h,u,c,d,g,o,i,p,m,f,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(){}return e.prototype.init=function(){u.E.ins.on(c.EventName.OPEN_XUNBAO_WAREHOUSE,this,this.onOpenViewHandler),l.RoleCenter.instans.on(s.enumOpResultType.lotteryBag_takeOutOne+"",this,this.onTakeOutOneBack),l.RoleCenter.instans.on(s.enumOpResultType.lotteryBag_takeOutAll+"",this,this.onTakeOutAllBack),l.RoleCenter.instans.on(s.enumOpResultType.lotteryShenyuBag_takeOutOne+"",this,this.onTakeShenyuOutOneBack),l.RoleCenter.instans.on(s.enumOpResultType.lotteryShenyuBag_takeOutAll+"",this,this.onTakeShenyuOutAllBack),l.RoleCenter.instans.on(s.enumOpResultType.lotteryZhanwenBag_takeOutAll+"",this,this.onTakeZhanWenOutAllBack),l.RoleCenter.instans.on(s.enumOpResultType.lotteryZhanwenBag_takeOutOne+"",this,this.onTakeZhanWenOutOneBack),a.GSM.ins.on(h.sbkLotteryBagData.KEY,this,this.onUpdateDataBack),a.GSM.ins.on(h.sbkLotteryZhanwenBagData.KEY,this,this.onUpdateZhanWenDataBack),a.GSM.ins.on(h.sbkLotteryShenyuBagData.KEY,this,this.onUpdateShenyuDataBack),u.E.ins.on(c.EventName.INIT_SELFSETOVER,this,this.doInitData)},e.prototype.doInitData=function(){this.requestInitData(),this.requestZhanwenInitData(),this.requesJadetInitData()},e.prototype.onOpenViewHandler=function(e){1!=e&&2!=e&&3!=e||(this._view||(this._view=new i.XunBaoWarehouseDlg(this)),this._view.showView(e))},e.prototype.requestInitData=function(){var e=new n.sbkLotteryBagC2GS;e.msgidx=s.enumOpResultType.lotteryBag_get,a.GSM.sendServer(e)},e.prototype.requesJadetInitData=function(){var e=new n.sbkLotteryShenyuBagC2GS;e.msgidx=s.enumOpResultType.lotteryShenyuBag_get,a.GSM.sendServer(e)},e.prototype.requestZhanwenInitData=function(){var e=new n.sbkLotteryZhanwenBagC2GS;e.msgidx=s.enumOpResultType.lotteryZhanwenBag_get,a.GSM.sendServer(e)},e.prototype.takeOutOne=function(e,t){if(1==e){if(!l.RoleCenter.instans.bagRoomEnough(1))return void o.AM.showBagNotEnough(1);(i=new n.sbkLotteryBagC2GS).msgidx=s.enumOpResultType.lotteryBag_takeOutOne,i.id=t,a.GSM.sendServer(i)}else if(2==e){if(!l.RoleCenter.instans.zhanwenRoomEnough(1))return r.DialogQueue.getInstance().reset(),Laya.Dialog.closeAll(),void o.AM.showZhanWenBagNotEnough(1);(i=new n.sbkLotteryZhanwenBagC2GS).msgidx=s.enumOpResultType.lotteryZhanwenBag_takeOutOne,i.id=t,a.GSM.sendServer(i)}else if(3==e){if(!l.RoleCenter.instans.bagRoomEnough(1))return void o.AM.showBagNotEnough(1);var i;(i=new n.sbkLotteryShenyuBagC2GS).msgidx=s.enumOpResultType.lotteryShenyuBag_takeOutOne,i.id=t,a.GSM.sendServer(i)}},e.prototype.takeOutAll=function(e){if(1==e){if(!l.RoleCenter.instans.bagRoomEnough(10))return r.DialogQueue.getInstance().reset(),Laya.Dialog.closeAll(),void o.AM.showBagNotEnough(10);(t=new n.sbkLotteryBagC2GS).msgidx=s.enumOpResultType.lotteryBag_takeOutAll,a.GSM.sendServer(t)}else if(2==e){if(!l.RoleCenter.instans.zhanwenRoomEnough(10))return r.DialogQueue.getInstance().reset(),Laya.Dialog.closeAll(),void o.AM.showZhanWenBagNotEnough(10);(t=new n.sbkLotteryZhanwenBagC2GS).msgidx=s.enumOpResultType.lotteryZhanwenBag_takeOutAll,a.GSM.sendServer(t)}else if(3==e){if(!l.RoleCenter.instans.bagRoomEnough(10))return r.DialogQueue.getInstance().reset(),Laya.Dialog.closeAll(),void o.AM.showBagNotEnough(10);var t;(t=new n.sbkLotteryShenyuBagC2GS).msgidx=s.enumOpResultType.lotteryShenyuBag_takeOutAll,a.GSM.sendServer(t)}},e.prototype.onUpdateDataBack=function(e){if(e.type==h.enumLotteryBagDataType.bag)return l.RoleCenter.instans.self.lotteryData.bagData=e,u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!0),void p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_warehouse,l.RoleCenter.instans.self.lotteryData.isHave);for(var t=e.idArr.length,i=0;i<t;){var n=e.idArr[i],s=e.equipIdArr.indexOf(n);-1!=s?h.sbkLotteryBagData.add2LotteryBag(l.RoleCenter.instans.self.lotteryData.bagData,e.equipObj[s],e.numArr[i]):h.sbkLotteryBagData.add2LotteryBag(l.RoleCenter.instans.self.lotteryData.bagData,n,e.numArr[i]),i++}l.RoleCenter.instans.self.lotteryData.isHave=0<t,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_warehouse,l.RoleCenter.instans.self.lotteryData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)},e.prototype.onUpdateShenyuDataBack=function(e){if(e.type==h.enumLotteryBagDataType.bag)return l.RoleCenter.instans.self.lotteryShenyuData.bagData=e,u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!0),void p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_warehouse,l.RoleCenter.instans.self.lotteryShenyuData.isHave);for(var t=e.idArr.length,i=0;i<t;){var n=e.idArr[i],s=e.equipIdArr.indexOf(n);-1!=s?h.sbkLotteryShenyuBagData.add2LotteryBag(l.RoleCenter.instans.self.lotteryShenyuData.bagData,e.equipObj[s],e.numArr[i]):h.sbkLotteryShenyuBagData.add2LotteryBag(l.RoleCenter.instans.self.lotteryShenyuData.bagData,n,e.numArr[i]),i++}l.RoleCenter.instans.self.lotteryShenyuData.isHave=0<t,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_warehouse,l.RoleCenter.instans.self.lotteryShenyuData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)},e.prototype.onUpdateZhanWenDataBack=function(e){if(e.type==h.enumLotteryBagDataType.bag)return l.RoleCenter.instans.self.lotteryZhanwenData.bagData=e,u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!0),void p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_warehouse,l.RoleCenter.instans.self.lotteryZhanwenData.isHave);for(var t=e.idArr.length,i=0;i<t;){var n=e.idArr[i],s=e.zhanwenIdArr.indexOf(n);-1!=s?h.sbkLotteryZhanwenBagData.add2LotteryBag(l.RoleCenter.instans.self.lotteryZhanwenData.bagData,e.zhanwenDataArr[s],e.numArr[i]):h.sbkLotteryZhanwenBagData.add2LotteryBag(l.RoleCenter.instans.self.lotteryZhanwenData.bagData,n,e.numArr[i]),i++}l.RoleCenter.instans.self.lotteryZhanwenData.isHave=0<t,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_warehouse,l.RoleCenter.instans.self.lotteryZhanwenData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)},e.prototype.onTakeOutOneBack=function(e){if(e.opresult){var t=e.reservedata[0],i=l.RoleCenter.instans.self.lotteryData.bagData,n=i.idArr.indexOf(t),s=i.equipIdArr.indexOf(t);-1!=s?(l.RoleCenter.instans.vo.addEquipIns(i.equipObj[s]),g.FE.addEquipsToCFloats([i.equipObj[s]])):(l.RoleCenter.instans.vo.chgItemCount(t,i.numArr[n]),g.FE.addItemsToCFloats([t,i.numArr[n]])),h.sbkLotteryBagData.remove(l.RoleCenter.instans.self.lotteryData.bagData,t),u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!1),l.RoleCenter.instans.self.lotteryData.isHave=0<i.idArr.length,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_warehouse,l.RoleCenter.instans.self.lotteryData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)}},e.prototype.onTakeShenyuOutOneBack=function(e){if(e.opresult){var t=e.reservedata[0],i=l.RoleCenter.instans.self.lotteryShenyuData.bagData,n=i.idArr.indexOf(t),s=i.equipIdArr.indexOf(t);-1!=s?(l.RoleCenter.instans.vo.addEquipIns(i.equipObj[s]),g.FE.addEquipsToCFloats([i.equipObj[s]])):(l.RoleCenter.instans.vo.chgItemCount(t,i.numArr[n]),g.FE.addItemsToCFloats([t,i.numArr[n]])),h.sbkLotteryBagData.remove(l.RoleCenter.instans.self.lotteryShenyuData.bagData,t),u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!1),l.RoleCenter.instans.self.lotteryShenyuData.isHave=0<i.idArr.length,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_warehouse,l.RoleCenter.instans.self.lotteryShenyuData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)}},e.prototype.onTakeZhanWenOutOneBack=function(e){if(e.opresult){var t=e.reservedata[0],i=l.RoleCenter.instans.self.lotteryZhanwenData.bagData,n=i.idArr.indexOf(t),s=i.zhanwenIdArr.indexOf(t);-1!=s?(l.RoleCenter.instans.vo.addZhanWen(i.zhanwenDataArr[s]),g.FE.addZhanWenToCFloats([i.zhanwenDataArr[s]])):(l.RoleCenter.instans.vo.chgItemCount(t,i.numArr[n]),g.FE.addItemsToCFloats([t,i.numArr[n]])),h.sbkLotteryZhanwenBagData.remove(l.RoleCenter.instans.self.lotteryZhanwenData.bagData,t),u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!1),l.RoleCenter.instans.self.lotteryZhanwenData.isHave=0<i.idArr.length,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_warehouse,l.RoleCenter.instans.self.lotteryZhanwenData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)}},e.prototype.onTakeZhanWenOutAllBack=function(e){if(e.opresult){var t=e.reservedata[0];0==t?l.RoleCenter.instans.self.lotteryZhanwenData.isHave=!1:t==d.enumErrConst.code_2206&&(l.RoleCenter.instans.self.lotteryZhanwenData.isHave=!0,g.FE.upItems(f.ErrCodeView.getErrStr(d.enumErrConst.code_2209),m.BubbleEnum.center));for(var i=l.RoleCenter.instans.self.lotteryZhanwenData.bagData,n=e.reservedata.length,s=1;s<n;){var a=e.reservedata[s],o=i.idArr.indexOf(a),r=i.zhanwenIdArr.indexOf(a);-1!=r?(l.RoleCenter.instans.vo.addZhanWen(i.zhanwenDataArr[r]),g.FE.addZhanWenToCFloats([i.zhanwenDataArr[r]])):(l.RoleCenter.instans.vo.chgItemCount(a,i.numArr[o]),g.FE.addItemsToCFloats([a,i.numArr[o]])),h.sbkLotteryZhanwenBagData.remove(l.RoleCenter.instans.self.lotteryZhanwenData.bagData,a),s++}u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!1),l.RoleCenter.instans.self.lotteryZhanwenData.isHave=0<i.idArr.length,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_lines_warehouse,l.RoleCenter.instans.self.lotteryZhanwenData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)}},e.prototype.onTakeOutAllBack=function(e){if(e.opresult){var t=e.reservedata[0];0==t?l.RoleCenter.instans.self.lotteryData.isHave=!1:t==d.enumErrConst.code_2206&&(l.RoleCenter.instans.self.lotteryData.isHave=!0,g.FE.upItems(f.ErrCodeView.getErrStr(d.enumErrConst.code_2209),m.BubbleEnum.center));for(var i=l.RoleCenter.instans.self.lotteryData.bagData,n=e.reservedata.length,s=1;s<n;){var a=e.reservedata[s],o=i.idArr.indexOf(a),r=i.equipIdArr.indexOf(a);-1!=r?(l.RoleCenter.instans.vo.addEquipIns(i.equipObj[r]),g.FE.addEquipsToCFloats([i.equipObj[r]])):(l.RoleCenter.instans.vo.chgItemCount(a,i.numArr[o]),g.FE.addItemsToCFloats([a,i.numArr[o]])),h.sbkLotteryBagData.remove(l.RoleCenter.instans.self.lotteryData.bagData,a),s++}u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!1),l.RoleCenter.instans.self.lotteryData.isHave=0<i.idArr.length,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_equip_warehouse,l.RoleCenter.instans.self.lotteryData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)}},e.prototype.onTakeShenyuOutAllBack=function(e){if(e.opresult){var t=e.reservedata[0];0==t?l.RoleCenter.instans.self.lotteryShenyuData.isHave=!1:t==d.enumErrConst.code_2206&&(l.RoleCenter.instans.self.lotteryShenyuData.isHave=!0,g.FE.upItems(f.ErrCodeView.getErrStr(d.enumErrConst.code_2209),m.BubbleEnum.center));for(var i=l.RoleCenter.instans.self.lotteryShenyuData.bagData,n=e.reservedata.length,s=1;s<n;){var a=e.reservedata[s],o=i.idArr.indexOf(a),r=i.equipIdArr.indexOf(a);-1!=r?(l.RoleCenter.instans.vo.addEquipIns(i.equipObj[r]),g.FE.addEquipsToCFloats([i.equipObj[r]])):(l.RoleCenter.instans.vo.chgItemCount(a,i.numArr[o]),g.FE.addItemsToCFloats([a,i.numArr[o]])),h.sbkLotteryBagData.remove(l.RoleCenter.instans.self.lotteryShenyuData.bagData,a),s++}u.E.ins.event(c.EventName.LOTTERY_WAREHOUSE_DATA_CHANGED,!1),l.RoleCenter.instans.self.lotteryShenyuData.isHave=0<i.idArr.length,p.NewRedHintsCenter.ins.setRedHintOpenOrClose(p.enumRedHints.xunbao_jade_warehouse,l.RoleCenter.instans.self.lotteryShenyuData.isHave),u.E.ins.event(c.EventName.LOTTERY_STATE_CHANGED)}},e}();t.XunBaoWarehouseCtrl=y}),define("src/g/hunyin/view/HuanlingHh",["require","exports","../../../plugin/sbkPropTool","../../../manager/RoleCenter","../../net/messages/PropFightMain","../../net/messages/sbkPhantomData","../../../manager/GameSocketManager","../../../config/GameConfig","../../../utils/ItemUtils","../../itemGets/View/ItemGetDlg","../../../utils/ItemCellUtils","../../Effects/UIEffectsFactory","../../../component/SAnimation","../../../manager/RedDotM","../../Effects/UIEffectsEnum","../../../utils/RoleUtil","../../../init/TextConst"],function(e,t,F,q,W,o,r,Y,j,n,d,K,J,z,X,Q,Z){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;e.clickHandler=new Laya.Handler(e,e.getItemDlg),e.btn_active.on(Laya.Event.CLICK,e,e.active),e.items.mouseHandler=new Laya.Handler(e,e.mouseHandler),e.items.renderHandler=new Laya.Handler(e,e.renderHandler),e.item_cost.setJump(Z.TextConst.get(487),e.clickHandler);var t=e.lab_desc.style;return t.fontSize=20,t.color="#b98e42",t.align="center",e}return __extends(e,i),e.prototype.renderHandler=function(e,t){var i=+e.dataSource,n=q.RoleCenter.instans.self.phData,s=n.huanIDArr,a=n.huanLvArr,o=s.indexOf(i),r=-1!=o?a[o]:0,l=Y.GameConfig.HuanlingHhUp[1e3*i+r],h=!l;l||(l=Y.GameConfig.HuanlingHhUp[1e3*i+1]);var u=e.item,c=+l.cost[0][0];d.ItemCellUtils.fillCellForItem0View(u,c,1),h&&u.effect_con.removeChildren(),u.gray=h,u.img_occupation.visible=!1,u.img_select.visible=this.lastIdx==t,e.img_red.visible=z.RedDotM._hl.hhRed[t]},e.prototype.mouseHandler=function(e,t){e.type==Laya.Event.CLICK&&this.selectItem(t)},e.prototype.selectItem=function(e){if(this.lastIdx!=e){var t=!1;if(!isNaN(this.lastIdx)){var i=this.items.getCell(this.lastIdx);i&&(i.item.img_select.visible=!1),t=!0}this.items.getCell(e).item.img_select.visible=!0,this.lastIdx=e,t&&this.refresh()}},e.prototype.active=function(){var e=this.items.array[this.lastIdx],t=q.RoleCenter.instans.self.phData,i=t.huanIDArr,n=t.huanLvArr,s=i.indexOf(e),a=new o.PhantomHuanLvMSG;a.huanId=e,a.huanLv=-1!=s?n[s]:0,r.GSM.sendServer(a)},e.prototype.refresh=function(){var e=this.items,t=e.array||[];if(0==t.length){for(var i=Y.GameConfig.HuanlingSetting.phantommodel.value.split(","),n=1;n<i.length;n++){var s=+i[n];t.push(s)}e.array=t}else e.refresh();isNaN(this.lastIdx)&&this.selectItem(0);var a=q.RoleCenter.instans.vo,o=t[this.lastIdx],r=a.phData,l=r.huanIDArr,h=r.huanLvArr,u=l.indexOf(o),c=-1!=u?h[u]:0,d=Y.GameConfig.HuanlingHhUp[1e3*o+c],g=Y.GameConfig.HuanlingHhUp[1e3*o+c+1],p=this.ani,m=p.getChildByName("ani");m?m.source=" ":((m=new J.SAnimation).width=m.height=500,m.interval=200,m.name="ani",m.play(),p.addChild(m)),K.UIEffectsFactory.Ins.loadSource(m,"dynamic2/huanling/"+(o<10?"0"+o:o)+".json"),K.UIEffectsFactory.Ins.alignCenter(m,p);var f=this.btn_active;if(z.RedDotM._hl.hhRed[this.lastIdx])K.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(f,X.UIEffectsEnum.getTip_Big,1.6,1.1);else{var y=f.getChildByName("ani");y&&y.removeSelf()}f.label=0==c?Z.TextConst.get(237):Z.TextConst.get(615),f.disabled=!g;var v=this.item_cost;if(g){var _=g.cost,C=j.ItemUtils.getItemVoById(_[0][0]),w=C.id,I=a.bagdata.getItemCount(w),b=_[0][1];this.itemid=w,v.setNeed(I,b),v.setNeedName(C.name,j.ItemUtils.getSmallIcon(w)),v.setQualColor(j.ItemUtils.getColorByQuality(C.quality)),v.visible=!0}else v.visible=!1;var S=this.box_curr,E=this.box_next,R=d?d.prop:null,x=g?g.prop:null;for(n=0;n<4;n++){var L=S.getChildByName("lab_"+n),k=E.getChildByName("lab_"+n),T=!1,A=!1;if(R){var H=R[n];if(H){var P=j.ItemUtils.getShuXingByName(H[0]);L.text=P.desc+":"+H[1],T=!0}}else{var D=x[n];if(D){var G=j.ItemUtils.getShuXingByName(D[0]);L.text=G.desc+":0",T=!0}}if(x){var N=x[n];if(N){var M=j.ItemUtils.getShuXingByName(N[0]);k.text=M.desc+":"+N[1],A=!0}}else{R[n]&&(k.text=Z.TextConst.get(208),A=!0)}L.visible=T,k.visible=A}this.box_curr.x=this.box_next.x-this.box_curr.width-10;for(n=0;n<5;n++){var O=this["img_star"+n];if(6<c){var B="";B=n+1<=c-6?"res/custom/xing_zi.png":"res/custom/juese_jingmai_xing.png",O.skin=B}else O.skin="res/custom/juese_jingmai_"+(0<c-1&&n+1<=c-1?"xing":"kongxing")+".png"}var U=new W.PhantomProp,V=Y.GameConfig.HuanlingHhUp[1e3*o+c];V&&F.sbkPropTool.reSetProp(U,V.prop),this.box_fight.setFightNum((V?V.power:0)+Q.RoleUtil.calHlCombat(U)*a.heronum),this.img_name.skin="res/huanling/n"+o+".png",this.lab_desc.innerHTML=Z.TextConst.get(1125,(0==c?Math.floor(g.combo/100):Math.floor(d.combo/100))+"%",""+(0==c?"":g?Z.TextConst.get(1127,(g.combo-d.combo)/100+"%"):""))},e.prototype.getItemDlg=function(){n.ItemGetDlg.create(this.itemid)},e}(ui.hunyin.page.HuanlingHhUI);t.HuanlingHh=i}),define("src/g/hunyin/ctrl/page/HuanlingHhCtrl",["require","exports","../../../base/BaseCtrl","../../../clearRes/ClearResM","../../../proxy/MultiLevelUIProxy","src/g/hunyin/view/HunYinBg","../../../accessctrl/AccessCenter","../../../../manager/LayerManager","src/g/hunyin/view/HuanlingHh","../../../../manager/GameSocketManager","../../../net/messages/sbkPhantomData","../../../../manager/RoleCenter","../../../../plugin/sbkPropTool","../../../../enum/EventName","../../../../core/NumE","../../../shenshou/view/ShenActTip","../../../../init/Switches","../../../../meta/HlHhUpVo"],function(e,t,i,s,a,o,r,l,n,h,u,c,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){function e(){var e=t.call(this)||this;return e.urls=["res/atlas/res/huanling.json"],f.Switches.ins.on(r.enumAccessId.huanlingHh,e,e.onOpenHandler,[r.enumAccessId.huanlingHh]),h.GSM.ins.on(u.PhantomHuanLvMSG.KEY,e,e.hlhhUp),e}return __extends(e,t),e.prototype.hlhhUp=function(e){var t=c.RoleCenter.instans.vo,i=t.phData,n=e.huanId,s=e.huanLv,a=i.huanIDArr,o=i.huanLvArr,r=a.indexOf(n);-1==r?(a.push(n),o.push(s)):o[r]=s;var l=t.combat;d.sbkPropTool.resetHuanling();var h=t.reCheckComBat();if(c.RoleCenter.instans.event(g.EventName.FIGHT_UP,h-l),-1==r){var u=new m.ShenActTip;u.popTip("dynamic2/huanling/"+(n<10?"0"+n:n)+".json"),u.ani.y-=100}this.tab_selectHandler()},e.prototype.onOpenHandler=function(e,t,i){void 0===i&&(i=!1),t&&(this.id=e,this.closeOther=i,this.opens())},e.prototype.onAtlasLoaded=function(){var e=this.view,t=this._tabProxy;if(!e){this.view=e=new o.HunYinBg,e.tab_page.visible=!1,e.box_tip.visible=!1,this._tabProxy=t=new a.MultiLevelUIProxy,t.registerTab(e.tab_page,0),t.registerTagIndex(r.enumAccessId.huanlingHh,0),t.selectHandler=new Laya.Handler(this,this.tab_selectHandler),e.view_bg.btn_close.on(Laya.Event.CLICK,this,this.closeSelf),e.view_bg.btn_back.on(Laya.Event.CLICK,this,this.closeSelf);for(var i=y.HlHhUpVo.costIdArr,n=0;n<i.length;n++)p.NumE.ins.on(i[n]+p.NumE.CHANGED,this,this.tab_selectHandler)}t.open(this.id),e.displayedInStage||(l.LayerManager.addInPOPWindowLayer(e,this.closeOther),s.ClearResM.resetViewImg(e))},e.prototype.closeSelf=function(){this.view.view_bg.box_page.removeChildren(),this.view.removeSelf()},e.prototype.tab_selectHandler=function(e){void 0===e&&(e=0),this.page||(this.page=new n.HuanlingHh),this.view.view_bg.box_page.addChild(this.page),this.page.refresh(),this.view.view_bg.img_title.skin="res/title/huanhua_biaoti.png"},e}(i.BaseCtrl);t.HuanlingHhCtrl=v}),define("src/g/a/GameInit2",["require","exports","src/g/answerActivity/ctrl/AnswerStart","src/g/bossmeet/ctrl/BossMeetViewCtrl","src/g/familyredpacket/ctrl/FamilyRedPacketCtrl","src/g/godcastnew/ctrl/NGodCastCtrl","src/g/guild/ctrl/GuildStorageMainViewCtrl","src/g/guild/ctrl/attackCity/AttackSandyCityRewardViewCtrl","src/g/guild/ctrl/attackCity/PreviousFightingViewCtrl","src/g/guild/ctrl/attackCity/AttackSandyCityViewCtrl","src/g/guild/ctrl/warehouse/GuildWarehouseViewCtrl","src/g/guild/ctrl/task/GuildTaskCtrl","src/g/guild/ctrl/skill/GuildSkillCtrl","src/g/guild/ctrl/manage/GuildManageCtrl","src/g/guild/ctrl/task/MiJingBossViewCtrl","src/g/guild/ctrl/shacheng/ShaChengCtrl","src/g/guild/ctrl/ApplyGuildCtrl","src/g/guild/ctrl/GuildMainCtrl","src/g/leitower/ctrl/LeiTowerCtrl","../lottery/ctrl/GLotteryCtrl","src/g/playtype_new/ctrl/NPlayTypeCtrl","../rank/ctrl/RankViewCtrl","../rexue/ctrl/ReXueDlgCtrl","../rexue/ctrl/ReXueOrnamentBgCtrl","src/g/achieve/ctrl/GActiveCtrl","src/g/chop/ctrl/ChopViewCtrl","src/g/hunyin/ctrl/HunYinBgCtrl","src/g/hunyin/ctrl/page/HunYinTaskPageCtrl","src/g/aegis/ctrl/AegisCtrl","src/g/bosswaring/ctrl/BossWarningCtrl","src/g/GodWing/Ctrl/GGodWingCtrl","../xingwang/ctrl/XwBgCtrl","../shenshou/ctrl/ShenShouCtrl","../shenbing/ctrl/ShenBingBgCtrl","../shenbing/ctrl/ShenBingFantasyCtrl","src/g/sandycitynight/ctrl/SandyCityNightCtrl","../pvp1v1/ctrl/PVP1V1Ctrl","../pvp1v1/ctrl/CreateMinerCtrl","../pvp1v1/ctrl/MineIngViewCtrl","../pvp1v1/ctrl/MineAccountCtrl","src/g/pointwar/ctrl/PointWarCtrl","src/g/pointwar/ctrl/PointWarResultCtrl","src/g/pointwar/ctrl/PointNPCEntryCtrl","src/g/pointwar/ctrl/NightWarNPCEntry","src/g/rough/ctrl/RoughCtrl","../crossserboss/ctrl/KFShenQiJinDiWarCtrl","src/g/holydress/ctrl/HolyDressMainCtrl","src/g/holydress/ctrl/HolyDressComposeCtrl","../fight/osprite/play/shenweiyu/ShenweiyuManager","src/g/shenweiyu/ctrl/ShenWeiYuRankHallCtrl","src/g/shenweiyu/ctrl/ShenWeiYuHallCtrl","src/g/shenweiyu/ctrl/ShenWeiYuRewardHallCtrl","src/g/shenweiyu/ctrl/ShenweiyuWarCtrl","src/g/ringling/ctrl/RingLingCtrl","src/g/killtip/ctrl/KillTipCtrl","src/g/xunbao/ctrl/XunBaoCtrl","src/g/xunbao/ctrl/XunBaoWarehouseCtrl","src/g/hunyin/ctrl/page/HuanlingHhCtrl"],function(e,t,i,n,s,a,o,r,l,h,u,c,d,g,p,m,f,y,v,_,C,w,I,b,S,E,R,x,L,k,T,A,H,P,D,G,N,M,O,B,U,V,F,q,W,Y,j,K,J,z,X,Q,Z,$,ee,te,ie,ne){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var se=function(){new q.NightWarNPCEntry,new S.GActiveCtrl,new i.AnswerStart,(new n.BossMeetViewCtrl).init(),(new E.ChopViewCtrl).init(),new s.FamilyRedPacketCtrl,new a.NGodCastCtrl,new L.AegisCtrl,new k.BossWarningCtrl,new y.GuildMainCtrl,new f.ApplyGuildCtrl,new m.ShaChengCtrl,(new p.BossCallCtrl).init(),new g.GuildManageCtrl,new d.GuildSkillCtrl,new c.GuildTaskCtrl,new u.GuildWarehouseViewCtrl,(new h.AttackSandyCityViewCtrl).init(),(new l.PreviousFightingViewCtrl).init(),(new r.AttackSandyCityRewardViewCtrl).init(),new o.GuildStorageMainViewCtrl,new T.GGodWingCtrl,new R.HunYinBgCtrl,new x.HunYinTaskPageCtrl,new v.LeiTowerCtrl,new _.GLotteryCtrl,new C.NPlayTypeCtrl,(new w.RankViewCtrl).init(),new I.ReXueDlgCtrl,new b.ReXueOrnamentBgCtrl,new A.XwBgCtrl,new H.ShenShouCtrl,new P.ShenBingBgCtrl,new D.ShenBingFantasyCtrl,(new G.SandyCityNightCtrl).init(),new N.PVP1V1Ctrl,(new M.CreateMinerCtrl).init(),(new O.MineIngViewCtrl).init(),(new B.MineAccountCtrl).init(),new U.PointWarCtrl,new V.PointWarResultCtrl,new F.PointNPCEntryCtrl,new W.RoughCtrl,new Y.KFShenQiJinDiWarCtrl,new j.HolyDressMainCtrl,new K.HolyDressComposeCtrl,J.ShenweiyuWarManager.getInstance(),new X.ShenWeiYuHallCtrl,new z.ShenWeiYuRankHallCtrl,new Q.ShenWeiYuRewardHallCtrl,new Z.ShenweiyuWarCtrl,new $.RingLingCtrl,new ee.KillTipCtrl,(new te.XunBaoCtrl).init(),(new ie.XunBaoWarehouseCtrl).init(),new ne.HuanlingHhCtrl};new(t.GameInit2=se)}),define("src/g/achieve/view/Item/AchievementRewardItem",["require","exports","../../../../utils/ItemUtils","../../../../init/TextConst"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e,t){var i=n.call(this)||this;return i._itemId=e,i._num=t,Laya.timer.frameOnce(2,i,i.init),i}return __extends(e,n),e.prototype.init=function(){var e=i.ItemUtils.getIconByDefine(this._itemId);e||(e=i.ItemUtils.getIconByIconId(Number(this._itemId))),this.img_icon.skin=e,this.txt_count.changeText(1e4<this._num?s.TextConst.get(1,this._num/1e4>>0):this._num.toString())},e}(ui.achievement.item.RewardItemUI);t.AchievementRewardItem=n}),define("src/g/answerActivity/view/AnswerGuideView",["require","exports","src/g/answerActivity/view/AnswerRankPanel","../../clearRes/ClearResM","../../../core/E","../../../enum/EventName","../../../config/GameConfig","../../../manager/GameSocketManager","../../net/messages/AnswerMsg","../../../utils/system/DateUitl","../../fight/osprite/play/MainCityManager","../../../init/TextConst"],function(e,t,i,n,s,a,o,r,l,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){function e(){var e=t.call(this)||this;return e._cdcount=0,e.btn_go.on(Laya.Event.CLICK,e,e.activityGo),e.btn_rank.on(Laya.Event.CLICK,e,e.gotoRank),e}return __extends(e,t),e.prototype.activityGo=function(){var e=o.GameConfig.answerconfig[1].coordinate;e=e||17,u.MainCityManager.getInstance().ChangeToMainCity({portid:100,npcid:e})},e.prototype.gotoRank=function(){var e=r.GSM;e.ins.once(l.EndAnswerGS2C.KEY,this,this.endResult);var t=new l.GetLastAnswerRankC2GS;e.sendServer(t)},e.prototype.endResult=function(e){e&&(this._rankview||(this._rankview=new i.AnswerRankPanel),this._rankview.showView(e))},e.prototype.showView=function(){var e=o.GameConfig.answerconfig[1],t=(new Date).setHours(0,0,0);t+=1e3*e.startTime,this.lab_countTime.text=c.TextConst.get(278,h.DateUtil.getHM(t)),this.visible=!0,n.ClearResM.resetViewImg(this),s.E.ins.on(a.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e.prototype.closeClearRes=function(){s.E.ins.off(a.EventName.CLOSEALLWINDOWS,this,this.closeClearRes)},e}(ui.answer.AnswerGuideViewUI);t.AnswerGuideView=d}),define("src/g/bossmeet/view/ItemIconEffect",["require","exports","../../../utils/ItemUtils","../../../meta/QualiyVo"],function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.scale(.7,.7),e}return __extends(e,t),e.prototype.setData=function(e){var t=a.ItemUtils.getEquipVoById(e);this.qicon.skin=a.ItemUtils.getQualityBjById(e),this.jobicon.skin=a.ItemUtils.getOccupationIconById(e),this.icon.skin=a.ItemUtils.getIconById(e),this.lvl.text=t.name,this.lvl.color=a.ItemUtils.getQualityColorById(e)},e.initItem=function(e,t,i){if(void 0===i&&(i=0),t instanceof Number){var n=t,s=a.ItemUtils.getItemOrEq(n);e.qicon.skin=a.ItemUtils.getQualitybjByQualityId(s.quality),e.jobicon.skin=a.ItemUtils.getOccupationIconById(s.jobid),e.icon.skin=a.ItemUtils.getIconById(s.id),e.lvl.text=s.name,e.lvl.color=o.QualityStruct.Ins.getQColorById(s.quality)}else{s=t;e.qicon.skin=a.ItemUtils.getQualitybjByQualityId(s.quality),e.jobicon.skin=a.ItemUtils.getOccupationIconById(s.jobid),e.icon.skin=a.ItemUtils.getIconById(s.id),e.lvl.text=s.name,e.lvl.color=o.QualityStruct.Ins.getQColorById(s.quality)}},e}(ui.boss.IconItemUI);t.ItemIconEffect=i}),define("src/g/chop/view/ChopGetMaterialDlg",["require","exports","../../itemGets/View/ItemGet_TipItem","../../../utils/ItemUtils"],function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var e=o.ItemUtils.getCurrencyVoByDefine("JUNGONG");e&&(this.img_icon.skin=o.ItemUtils.getIconByIconId(e.icon),this.lab_name.text=e.name);for(var t=[[6,0],[9,0]],i=t.length,n=0;n<i;n++){var s=(new a.ItemGet_TipItem).init(t[n][0],t[n][1]);s.scale(1.2,1.2),s.on(Laya.Event.CLICK,this,this.closePanel),this.getway_con.addChild(s)}this.bg.btn_back.on(Laya.Event.CLICK,this,this.close),this.bg.btn_close.on(Laya.Event.CLICK,this,this.close)},e.prototype.popPanel=function(){this.popup()},e.prototype.closePanel=function(){Laya.timer.callLater(this,this.close)},e}(ui.chop.ChopGetMaterialDlgUI);t.ChopGetMaterialDlg=i}),define("src/g/chop/view/ChopInfoDlg",["require","exports","../../../manager/RoleCenter","../../../config/GameConfig","../../../utils/ItemUtils","../../../meta/QualiyVo","../../../init/TextConst"],function(e,t,i,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(){var e=t.call(this)||this;return e._maxLv=10,e._showLv=-1,e.htxt_income.style.color="#e1a32a",e.htxt_income.style.font="SimHei",e.htxt_income.style.fontSize=20,e.htxt_income.style.align="center",e.turn_left.on(Laya.Event.CLICK,e,e.turnToLeft),e.turn_right.on(Laya.Event.CLICK,e,e.turnToRigth),e.bg.btn_back.on(Laya.Event.CLICK,e,e.close),e.bg.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(e,t),e.prototype.turnToLeft=function(){this.updateShow(this._showLv-1)},e.prototype.turnToRigth=function(){this.updateShow(this._showLv+1)},e.prototype.popPanel=function(){this.updateShow(i.RoleCenter.instans.self.chopData.chopLv),this.popup()},e.prototype.updateShow=function(e){if(this._showLv!=e){this._showLv=e,this._showLv<=0?this.turn_left.visible=!1:this.turn_left.visible=!0,10<=this._showLv?this.turn_right.visible=!1:this.turn_right.visible=!0;var t=a.GameConfig.chopJSON[e+1];if(t){for(var i=t.prop.length,n=0;n<i;){var s=t.prop[n];"HP"==s[0]?this.lab_hp.text=s[1]:"ATT"==s[0]&&(this.lab_att.text=s[1]),n++}this.chop_icon.lab_num.text="",this.chop_icon.img_item.skin="dynamic/chopicon/"+t.icon+".png",this.chop_icon.img_quality.skin=o.ItemUtils.getQualitybjByQualityId(t.quality),this.chop_name.color=r.QualityStruct.Ins.getQColorById(t.quality),this.chop_name.text=t.name,this.htxt_income.innerHTML=l.TextConst.get(324,t.income)}}},e}(ui.chop.ChopInfoDlgUI);t.ChopInfoDlg=n}),define("src/g/guild/GuildUtils",["require","exports","../net/messages/sbkHeroLMData"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getSylmLv=function(e,t){var i=0;switch(t){case n.enumLMType.qianghua:i=e.getStrongLv();break;case n.enumLMType.zhuling:i=e.getSoulLv();break;case n.enumLMType.stone:i=e.getGemLv();break;case n.enumLMType.jingmai:i=e.jingmaiStage;break;case n.enumLMType.longwenId:i=e.longwenId;break;case n.enumLMType.wing:i=e.heroWing.level;break;case n.enumLMType.zhuzai:i=e.zhuzai.getAllLv();break;case n.enumLMType.shenyu:break;case n.enumLMType.zhanwen:i=e.zhanwenData.getZhanwenAllLv();break;case n.enumLMType.shenzhu:i=e.shenzhuStage;break;case n.enumLMType.longlinId:i=e.longlinId;break;case n.enumLMType.ring3:i=e.ring3Id;break;case n.enumLMType.ring4:i=e.ring4Id;break;case n.enumLMType.ring2:i=e.ring2Id;break;case n.enumLMType.ring1:i=e.ring1Id}return i},e}();t.GuildUtils=i}),define("src/g/guild/vo/DragonPyVo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.init=function(e,t){var i=0;this.id=e[i++],this.condition=e[i++],this.consume=e[i++],this.attribute=e[i++],this.power=e[i++],t[this.id]=this},e}();t.DragonPyVo=i}),define("src/g/guild/vo/DragonZjVo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.init=function(e,t){var i=0;this.id=e[i++],this.name=e[i++],this.type=e[i++],t[this.id]=this},e}();t.DragonZjVo=i}),define("src/g/guild/view/sylm/Sylm",["require","exports","../../../../config/GameConfig","../../../../manager/GameSocketManager","../../../../manager/RoleCenter","../../../../utils/ItemUtils","../../../accessctrl/AccessCenter","../../../clearRes/ClearResM","../../../Effects/UIEffectsFactory","../../../net/messages/sbkFormula","../../../net/messages/sbkHeroLMData","../../../../manager/RedDotM","src/g/guild/GuildUtils","../../../../init/Switches","../../../../init/TextConst"],function(e,t,H,i,P,D,s,_,l,G,a,o,N,r,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function A(){var e=n.call(this)||this;e.lastIdx=0,e.lastIdxY=0,e.heroIdx=0;var t=e.lab_lv.style;t.fontFamily="SimHei",t.color="#dac494",t.fontSize=24,t.align="center";for(var i=0;i<3;i++){e["box_page"+i].on(Laya.Event.CLICK,e,e.select,[i])}for(i=0;i<5;i++){e["box_s"+i].on(Laya.Event.CLICK,e,e.selectY,[i])}return e.heroRed=o.RedDotM._sylmRed,e.btn_up.on(Laya.Event.CLICK,e,e.up),e.lab_get.on(Laya.Event.CLICK,e,e.gotoShop),e}return __extends(A,n),A.prototype.gotoShop=function(){r.Switches.ins.event(s.enumAccessId.shengyu_contest_shop)},A.prototype.up=function(){var e=H.GameConfig.DragonZj[this.lastIdx+1].type[this.lastIdxY],t=new a.LMUpGradeMSG;t.heroIdx=this.heroIdx,t.idx=e-1,t.curId=this.lmData.typeIDArr[e-1],i.GSM.sendServer(t)},A.prototype.selectY=function(e){var t=this.lastIdxY;if(t!=e){if(isNaN(t))for(var i=0;i<5;i++)this.setY(i,!1);else this.setY(t,!1);if(this.lastIdxY=e,!isNaN(e)){this.setY(e,!0);var n=this.lastIdx+1,s=H.GameConfig.DragonPy,a=H.GameConfig.DragonZj[n].type[e],o=this.lmData.typeIDArr[a-1],r=0==o?100*a+1:o+1,l=s[o],h=s[r];this.img_currIcon.skin=D.ItemUtils.getIconByIconId(A.baseItemId+a);var u=M.TextConst.get(615);0==o&&(u=M.TextConst.get(237)),this.btn_up.label=u;var c=!1,d=this.box_need,g=e+5*this.lastIdx;if(h){c=this.btn_up.visible=!0;var p=H.GameConfig.commonJson.zhangjiedesc.value.split(","),m=M.TextConst.get(1073);0==o&&(m=M.TextConst.get(1074));var f=N.GuildUtils.getSylmLv(this.hvo,a-1);this.lab_lv.innerHTML=m+M.TextConst.replace(p[g],'<font color="'+(h.condition<=f?"#03bb00":"#ff0f15")+'">'+f+"/"+h.condition+"</font>");var y=h.consume;for(i=0;i<2;i++){var v=this["box_need"+i],_=y[i];if(_){var C=v.getChildByName("num"),w=v.getChildByName("icon"),I=_[0],b=_[1],S=P.RoleCenter.instans.self.bagdata.getItemCount(I),E=D.ItemUtils.getItemVoById(I);w.skin=D.ItemUtils.getSmallIcon(E.icon),C.text=S+"/"+b,C.color=S<b?"#ff0f15":"#03bb00",d.addChild(v)}else v.removeSelf()}}else this.btn_up.visible=!1,this.lab_lv.innerHTML=M.TextConst.get(208);this.box_cost.visible=c,d.centerX=d.centerX,Laya.timer.once(10,this,function(){d.centerX=d.centerX});var R=H.GameConfig.commonJson.zhangjievalue.value.split(",")[g].split(":");for(i=0;i<2;i++){var x=(v=this["prop"+i]).getChildByName("curr"),L=v.getChildByName("next"),k=0,T=0;0<o&&(k=l.attribute[i]),h&&(T=h.attribute[i]),isNaN(k)||isNaN(T)?v.visible=!1:(v.visible=!0,x.text=M.TextConst.replace(R[i],k/G.sbkFormula.BASEPERCENTAGE+"%"),L.text=0==T?M.TextConst.get(208):M.TextConst.replace(R[i],T/G.sbkFormula.BASEPERCENTAGE+"%"))}}}},A.prototype.refresh=function(e,t){this.hvo=t,this.lmData=t.lmData,this.heroIdx=e;var i=this.lastIdx;this.select(NaN),this.select(i||0),this.refreshRedHead()},A.prototype.sonRedChecked=function(e){var t=e.getKeyList();if(0<t.length)for(var i=0;i<t.length;i++)e!=e[t[i]]&&this.sonRedChecked(e[t[i]]);else e.checkRed()},A.prototype.refreshRedHead=function(){var e=0;if(0<this.heroRed.getKeyList().length){for(this.tab_head.refreshHeadRedHint([!1,!1,!1]),this.tab_head.refreshHeadRedHint([this.heroRed[0].hasRed(),this.heroRed[1].hasRed(),this.heroRed[2].hasRed()]),e=0;e<3;e++)this["drgon_red"+e].visible=!1,this["drgon_red"+e].visible=this.heroRed[this.heroIdx][e+1].hasRed();for(e=0;e<5;e++)this["box_s"+e].red.visible=!1,this["box_s"+e].red.visible=this.heroRed[this.heroIdx][this.lastIdx+1][e].hasRed(),this["box_s"+e].red.visible&&(this["box_s"+e].red.gray=!1)}},A.prototype.select=function(e){var t=this.lastIdx;if(t!=e&&(isNaN(t)||this.setM(t,!0),this.lastIdx=e,!isNaN(e))){var i=this.img_pageS,n=this["box_page"+e];i.x=n.x,i.y=n.y,this.setM(e,!1);var s=e+1,a=H.GameConfig.DragonZj,o=H.GameConfig.DragonPy,r=a[s].type;this.img_bg.skin="res/bg/sylgBg"+e+".jpg";for(var l=this.lmData.typeIDArr,h=0;h<r.length;h++){var u=r[h],c=this["box_s"+h],d=c.icon,g=c.bg;d.skin=D.ItemUtils.getIconByIconId(A.baseItemId+u),g.skin="res/sylm/iconBg"+e+".png",_.ClearResM.resetViewImg(g);var p=l[u-1],m=!1;0==p&&(m=!0),c.getChildByName("box").gray=m;for(var f=p%100,y=0==p?100*u+1:p;o[y+1];)y++;y%=100,c.lv.text=f+"/"+y}var v=this.lastIdxY;this.selectY(NaN),this.selectY(v||0),this.refreshRedHead()}},A.prototype.setY=function(e,t){var i=this["box_s"+e],n=i.bg,s=i.ani,a=i.icon;n.index=t?0:1;var o=s.getChildByName("ani");if(t){if(!o){(o=new Laya.Animation).name="ani",s.addChild(o),o.interval=120,o.autoPlay=!0;o.width=o.height=300,o.pivotX=150,o.pivotY=150,o.scale(.5,.5),l.UIEffectsFactory.Ins.centerSAni4Parent(o,s)}var r=H.GameConfig.DragonZj[this.lastIdx+1].type[e];o.source=" ",o.loadAtlas("dynamic2/sylm/"+r+".json")}o&&(o.visible=t,a.visible=!t)},A.prototype.setM=function(e,t){this["box_page"+e].getChildByName("m").visible=t},A.baseItemId=1600,A}(ui.guild.sylm.SylmUI);t.Sylm=n}),define("src/g/guild/ctrl/sylm/SylmCtrl",["require","exports","../../../accessctrl/AccessCenter","src/g/guild/view/sylm/Sylm","../../../../manager/RoleCenter","../../../../manager/LayerManager","../../../clearRes/ClearResM","../../../base/BaseCtrl","../../../../manager/GameSocketManager","../../../net/messages/sbkHeroLMData","../../../../config/GameConfig","../../../../core/NumE","../../../../plugin/sbkPropTool","../../../../enum/EventName","../../../../manager/RedDotM","../../../../init/Switches"],function(e,t,i,c,d,g,a,n,o,r,p,m,l,h,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(s){function e(){var e=s.call(this)||this;return e._nowSelectHero=0,e.url="res/atlas/res/sylm.json",f.Switches.ins.on(i.enumAccessId.shengyulongmai,e,e.onOpenHandler,[i.enumAccessId.shengyulongmai]),o.GSM.ins.on(r.LMUpGradeMSG.KEY,e,e.lmUp),e}return __extends(e,s),e.prototype.change=function(){var e=this._nowSelectHero;this.refresh(e,d.RoleCenter.instans.self.openhero[e])},e.prototype.refresh=function(e,t,i){void 0===i&&(i=!0);var n=this._view;if(n){if(i&&!n.displayedInStage)return;n.refresh(e,t)}},e.prototype.lmUp=function(e){var t=d.RoleCenter.instans.vo,i=e.heroIdx;t.getOpenHeroByIdx(i).lmData.typeIDArr[e.idx]=e.curId,this._view.sonRedChecked(u.RedDotM._sylmRed),this.refresh(i,d.RoleCenter.instans.self.openhero[i]);var n=t.combat;l.sbkPropTool.resetSyLm(i),d.RoleCenter.instans.event(h.EventName.FIGHT_UP,t.reCheckComBat()-n)},e.prototype.onOpenHandler=function(e,t,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),t){var s=this._nowSelectHero,a=this._view;if(!a){this._view=a=new c.Sylm,a.on(Laya.Event.UNDISPLAY,this,this.clearCtrlRes),a.btn_close.on(Laya.Event.CLICK,this,this.clearCtrlRes),a.tab_head.initData(d.RoleCenter.instans.self.openhero,s,d.RoleCenter.instans.vo),a.tab_head.setCallbackHandler(new Laya.Handler(this,this.HeroSelect)),this.refreshRedHead();var o=p.GameConfig.DragonZj,r=m.NumE.ins;for(var l in o)for(var h=o[l].type,u=0;u<h.length;u++)r.on(c.Sylm.baseItemId+h[u]+m.NumE.CHANGED,this,this.change)}this.HeroSelect(s),g.LayerManager.addInPOPWindowLayer(a,i,!0,!0,!1,n),this.open()}},e.prototype.refreshRedHead=function(){this._view.refreshRedHead()},e.prototype.clearCtrlRes=function(){s.prototype.clearCtrlRes.call(this),this._view.removeSelf();var e=p.GameConfig.DragonZj;for(var t in e)for(var i=e[t].type,n=0;n<i.length;n++)a.ClearResM.clearUrl("dynamic2/sylm/"+i[n]+".json")},e.prototype.onAtlasLoaded=function(){a.ClearResM.resetViewImg(this._view)},e.prototype.HeroSelect=function(e){d.RoleCenter.instans.vo.heronum>e?(this._nowSelectHero=e,this._view.tab_head.setSelectIndex(e),this.refresh(e,d.RoleCenter.instans.self.openhero[e],!1)):f.Switches.ins.event(i.enumAccessId.partner)},e}(n.BaseCtrl);t.SylmCtrl=s}),define("src/g/guild/view/sylm/SylmRedListenner",["require","exports","../../../redhints/RedListenner","../../../../core/E","../../../../enum/EventName","../../../accessctrl/AccessCenter","../../../../core/NumE","../../../../config/GameConfig","../../../../manager/RoleCenter","src/g/guild/GuildUtils"],function(e,t,i,l,h,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(s){function e(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=s.call(this,e)||this;return n.heroIdx=t[0],n.zhangjieType=t[1],n.addEvent(),n}return __extends(e,s),e.prototype.addEvent=function(){var e=c.NumE.ins,t=d.GameConfig.DragonPy,i=[],n=d.GameConfig.DragonZj[this.zhangjieType];for(var s in this.type=n.type[this.key],t)for(var a=t[s].consume,o=0;o<a.length;o++){var r=+a[o][0];-1==i.indexOf(r)&&(i.push(r),e.on(r+c.NumE.CHANGED,this,this.checkRed))}l.E.ins.on(h.EventName.SOCIETY_SELFUFDATACHANGE,this,this.checkRed),g.RoleCenter.instans.on(h.EventName.FIGHT_UP,this,this.checkRed)},e.prototype.removeEvent=function(){},e.prototype.checkRed=function(){if(u.AccessCenter.ins.checkOpen(u.enumAccessId.shengyulongmai)){this.removeEvent();var e=g.RoleCenter.instans.vo;if(e.ufVo.inFamily){var t=e.getOpenHeroByIdx(this.heroIdx);if(t){var i=d.GameConfig.DragonPy,n=t.lmData.typeIDArr[this.type-1],s=0==n?100*this.type+1:n+1;if(!i[s])return void(this.red=!1);var a=i[s].condition;if(p.GuildUtils.getSylmLv(g.RoleCenter.instans.self.openhero[this.heroIdx],this.type-1)<a)return void(this.red=!1);var o=i[s].consume;for(var r in o){var l=o[r][0],h=o[r][1];if(g.RoleCenter.instans.vo.bagdata.getItemCount(l)<h)return void(this.red=!1)}this.red=!0}}else this.red=!1}},e}(i.RedListenner);t.SylmRedListenner=n}),define("src/g/guild/view/task/MiJingBossView",["require","exports","../../../../config/GameConfig","../../../../utils/ItemCellUtils","../../../bag/tips/view/ItemTips","../../../../manager/RoleCenter","../../../net/messages/UseItemC2GS","../../../../manager/GameSocketManager","../../../../manager/LayerManager","../../../../manager/AM","../../../../utils/system/FloatEffect","../../../../plugin/view/ToolTip","../../../accessctrl/AccessCenter","../../../clearRes/ClearResM","../../../../utils/system/ErrCodeView","../../../net/messages/ErrConst","../../../../init/Switches","../../../../init/TextConst"],function(e,t,a,i,n,o,s,r,l,h,u,c,d,g,p,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),g.ClearResM.addBgUrl(this.bgimg.skin),this.list_.renderHandler=new Laya.Handler(this,this.onRenderHandler),this.list_.mouseHandler=new Laya.Handler(this,this.onListeMouseHandler),this.lab_upVip.on(Laya.Event.CLICK,this,this.gotoVipPanel),this.btn_call.on(Laya.Event.CLICK,this,this.onBossCall),this.bg.btn_close.on(Laya.Event.CLICK,this,this.onClosePanel),this.bg.btn_back.on(Laya.Event.CLICK,this,this.onClosePanel),this.bg.btn_help.visible=!0},t.prototype.onClosePanel=function(){this.removeSelf()},t.prototype.gotoVipPanel=function(){f.Switches.ins.event(d.enumAccessId.vip)},t.prototype.showView=function(e){l.LayerManager.addInPOPWindowLayer(this,!1),this._itemId=e;var t=a.GameConfig.bossCallJson[e];t&&(this.lab_title.text=t.title,this.list_.dataSource=t.bonus);var i=a.GameConfig.vipJSON[o.RoleCenter.instans.vo.VIP],n=i?i.getRewardSummonCut():0,s=n-o.RoleCenter.instans.vo.ufVo.summonBossCnt;this.lab_count.text=y.TextConst.get(575,s,n),this.bgimg.restskin()},t.prototype.onRenderHandler=function(e,t){i.ItemCellUtils.fillCellForItemNameView(e,e.dataSource[0],Number(e.dataSource[1]))},t.prototype.onListeMouseHandler=function(e,t){e.type==laya.events.Event.CLICK&&n.ItemTips.ins.showTip(this.list_.dataSource[t][0],Number(this.list_.dataSource[t][1]))},t.prototype.onBossCall=function(){if(!o.RoleCenter.instans.bagRoomEnough())return h.AM.show(p.ErrCodeView.getErrStr(m.enumErrConst.code_2206),Laya.Handler.create(this,function(){f.Switches.ins.event(d.enumAccessId.huishou)})),!1;o.RoleCenter.instans.vo.ufVo.inFamily||u.FE.upItems(y.TextConst.get(533),c.BubbleEnum.center);var e=a.GameConfig.vipJSON[o.RoleCenter.instans.vo.VIP];if(0<(e?e.getRewardSummonCut():0)-o.RoleCenter.instans.vo.ufVo.summonBossCnt){var t=new s.UseItemC2GS;t.cfgId=this._itemId,t.count=1,r.GSM.sendServer(t),o.RoleCenter.instans.vo.lastUseBossCellItemId=this._itemId,this.onClosePanel()}else u.FE.upItems(y.TextConst.get(534),c.BubbleEnum.center)},t}(ui.guild.task.MiJingBossViewUI);t.MiJingBossView=v}),define("src/g/hunyin/view/LianHunDlg",["require","exports","../../../meta/HunYinVo","../../../manager/RoleCenter","../../../utils/ItemUtils","../../net/messages/ComboCultivateMsg","../../../manager/GameSocketManager"],function(e,t,o,r,a,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.recolverArr=[],e.canGet=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.addEvent(),this.initData()},e.prototype.addEvent=function(){this._list.renderHandler=new Laya.Handler(this,this.renderHandler),this.btn_close.on(Laya.Event.CLICK,this,this.onClose),this.btn_back.on(Laya.Event.CLICK,this,this.onClose),this.btn_lian.on(Laya.Event.CLICK,this,this.onLian)},e.prototype.onLian=function(){if(0!=this.recolverArr.length){var e=new i.ComboHunYinFenJieMsg;e.itemArr=this.recolverArr,n.GSM.sendServer(e),this.close()}},e.prototype.initData=function(){this.recolverArr=[];for(var e=[],t=[],i=[],n=r.RoleCenter.instans.vo.bagdata,s=0;s<n.itemId.length;s++)4e3<=n.itemId[s]&&n.itemId[s]<=4100&&e.indexOf(n.itemId[s])<0&&(this.recolverArr.push(n.itemId[s]),this.recolverArr.push(n.itemNum[s]),t.push(n.itemId[s]),i.push(n.itemNum[s]));this.canGet=0,this._list.dataSource=t;for(s=0;s<t.length;s++){var a=o.HeJiStruct.Ins.getHunYinCoseVo(t[s]);a&&(this.canGet+=parseInt(a.fenjie[0][1])*i[s])}this.lab_get.text=this.canGet+""},e.prototype.renderHandler=function(e,t){var i=e.dataSource,n=a.ItemUtils.getItemVoById(i);e.item.img_occupation.skin="",e.item.img_select.visible=!1,e.item.item.img_item.skin=a.ItemUtils.getIconByIconId(n.icon),e.item.item.img_quality.skin=a.ItemUtils.getQualitybjByQualityId(n.quality),e.item.item.lab_num.text="",e.item_name.text=n.name,e.item_name.color=a.ItemUtils.getColorByQuality(n.quality);var s=o.HeJiStruct.Ins.getHunYinCoseVo(i);s&&(this.canGet+=parseInt(s.fenjie[0][1]+""))},e.prototype.removeEvent=function(){this._list.renderHandler=null,this.btn_close.off(Laya.Event.CLICK,this,this.onClose),this.btn_back.off(Laya.Event.CLICK,this,this.onClose),this.btn_lian.off(Laya.Event.CLICK,this,this.onLian)},e.prototype.onClose=function(){this.removeEvent(),this.close()},e.prototype.onRemove=function(){this.removeEvent()},e}(ui.hunyin.LianHunDlgUI);t.LianHunDlg=s}),define("src/g/hunyin/view/HunShopDlg",["require","exports","../../../config/GameConfig","../../../utils/ItemUtils","../../../manager/RoleCenter","../../../utils/system/FloatEffect","../../net/messages/ComboCultivateMsg","../../../manager/GameSocketManager","../../../plugin/view/ToolTip","src/g/hunyin/view/HunYinTips","src/g/hunyin/view/LianHunDlg","../../../init/TextConst"],function(e,t,n,o,s,i,a,r,l,h,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){function e(){var e=t.call(this)||this;return e.hdArr=[],e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.addEvent(),this.initData()},e.prototype.addEvent=function(){this._list.renderHandler=new Laya.Handler(this,this.renderHandler),this.btn_close.on(Laya.Event.CLICK,this,this.onClose),this.btn_back.on(Laya.Event.CLICK,this,this.onClose),this.btn_huoqu.on(Laya.Event.CLICK,this,this.onClickHQ)},e.prototype.onClickHQ=function(){(new u.LianHunDlg).popup()},e.prototype.initData=function(){var e=[];for(var t in n.GameConfig.hunyincost)e.push(n.GameConfig.hunyincost[t]);this._list.dataSource=e;var i=s.RoleCenter.instans.vo.bagdata.getItemCount(4998);this.need_number.text=i+""},e.prototype.renderHandler=function(e,t){var i=e.dataSource,n=o.ItemUtils.getItemVoById(i.id),s=o.ItemUtils.getItemVoById(i.cost[0][0]);e.setName(n.name),e.setIcon(o.ItemUtils.getIconByIconId(n.icon)),e.setNeedIcon(o.ItemUtils.getSmallIcon(s.icon)),e.setNeedNum(i.cost[0][1]),e.setQual(o.ItemUtils.getQualitybjByQualityId(n.quality),o.ItemUtils.getColorByQuality(n.quality));var a=Laya.Handler.create(this,this.buyCall,[i],!1);this.hdArr.push(a),e.setCallBack(a),e._item.offAll(),e._item.on(Laya.Event.CLICK,this,function(){var e=new h.hunYinTips;e.initData(i.id),e.popup()}),this.image_icon.skin=o.ItemUtils.getSmallIcon(s.icon)},e.prototype.buyCall=function(e){o.ItemUtils.getItemVoById(e.id),o.ItemUtils.getItemVoById(e.cost[0][0]);if(s.RoleCenter.instans.vo.bagdata.getItemCount(parseInt(e.cost[0][0]+""))<e.cost[0][1])i.FE.upItems(c.TextConst.get(585),l.BubbleEnum.center);else{var t=new a.ComboHunYinBuyMsg;t.itemId=e.id,t.count=1,r.GSM.sendServer(t)}},e.prototype.removeEvent=function(){this._list.renderHandler=null,this.btn_close.off(Laya.Event.CLICK,this,this.onClose);for(var e=0;e<this.hdArr.length;e++)this.hdArr[e].recover()},e.prototype.onClose=function(){this.removeEvent(),this.close()},e}(ui.hunyin.HunShopDlgUI);t.HunShopDlg=d}),define("src/g/hunyin/view/OpenHunYinDlg",["require","exports","../../../meta/HunYinVo","../../Effects/UIEffectsFactory"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function i(){var e=t.call(this)||this;return e.url="",e.btn_again.on(Laya.Event.CLICK,e,e.onAgain),e.btn_close.on(Laya.Event.CLICK,e,e.close),e}return __extends(i,t),i.show=function(e){var t=new i;t.initView(e),t.popup()},i.prototype.initView=function(e){var t=n.HeJiStruct.Ins.getHunYinVo(e);this.url="/dynamic/hunyin2/"+e+".json",this.img.skin=n.HeJiStruct.getHunIconByIconId(t.icon),this.loadUrl()},i.prototype.loadUrl=function(){this.img.visible=!1,this.box_load.visible=!0,this.box_btn.visible=!1,this._box.visible=!1,Laya.loader.load(this.url,new Laya.Handler(this,this.onLoadComp),new Laya.Handler(this,this.onLoading),Laya.Loader.ATLAS)},i.prototype.onLoading=function(e){this.setBar(100*e>>0,100)},i.prototype.onLoadComp=function(e){this.box_load.visible=!1,this.box_btn.visible=!1,this._box.visible=!0,this.ani.once(Laya.Event.COMPLETE,this,this.onPlayComp);var t=Laya.loader.getRes(this.url).frames;for(var i in this.ani.source=this.url,t)if(t[i]&&t[i].sourceSize){this.ani.width=t[i].sourceSize.w,this.ani.height=t[i].sourceSize.h;break}s.UIEffectsFactory.Ins.centered4Parent(this.ani,this._box),this.ani.play(0)},i.prototype.onPlayComp=function(){this.img.visible=!0,this.ani.stop(),this.box_btn.visible=!0,this.box_load.visible=!1,this._box.visible=!0},i.prototype.onAgain=function(){this.loadUrl()},i.prototype.close=function(){this.btn_again.off(Laya.Event.CLICK,this,this.onAgain),this.btn_close.off(Laya.Event.CLICK,this,this.close),Laya.loader.clearRes(this.url),t.prototype.close.call(this)},i.prototype.setBar=function(e,t){void 0===e&&(e=0),void 0===t&&(t=100),this.lab_barCount.changeText(e+"%");var i=this.bar_img.width/t*e;i=0==i?1:i,this.bar_panl.width=i},i}(ui.hunyin.OpenHunYinDlgUI);t.OpenHunYinDlg=i}),define("src/g/hunyin/view/Tips_Hl",["require","exports","../../../utils/ItemUtils","../../Effects/UIEffectsFactory","../../../component/SAnimation","../../accessctrl/AccessCenter","../../net/messages/PropFightMain","../../../config/GameConfig","../../../plugin/sbkPropTool","../../../utils/RoleUtil","../../../manager/RoleCenter","../../../init/Switches","../../../init/TextConst","../../../meta/HlHhUpVo"],function(e,t,f,y,v,n,_,C,w,I,b,s,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var e=i.call(this)||this;e.btn_use.on(Laya.Event.CLICK,e,e.onUse);var t=e.lab_desc.style;return t.fontSize=20,t.color="#b98e42",e}return __extends(e,i),e.prototype.onUse=function(){s.Switches.ins.event(n.enumAccessId.huanling),this.close()},e.prototype.initData=function(e,t){void 0===t&&(t=!1);var i=E.HlHhUpVo.typeById[e.id],n=this.ani,s=n.getChildByName("ani");s?s.source=" ":((s=new v.SAnimation).width=s.height=500,s.interval=200,s.name="ani",s.play(),n.addChild(s)),y.UIEffectsFactory.Ins.loadSource(s,"dynamic2/huanling/"+(i<10?"0"+i:i)+".json"),y.UIEffectsFactory.Ins.alignCenter(s,n);for(var a,o=C.GameConfig.HuanlingHhUp,r=new _.PhantomProp,l=o[1e3*i+1],h=1;h<9999&&(a=o[1e3*i+h],o[1e3*i+h+1]);h++);var u=l.prop;w.sbkPropTool.reSetProp(r,u),this.lab_title.text=e.name,this.lab_fight.text=S.TextConst.get(79,l.power+I.RoleUtil.calHlCombat(r)*b.RoleCenter.instans.vo.heronum),this.lab_desc.innerHTML=S.TextConst.get(1130,Math.floor(l.combo/100)+"%",Math.floor(a.combo/100)+"%");for(h=0;h<5;h++){var c=this["attr_"+h],d=c.getChildByName("key"),g=c.getChildByName("val"),p=u[h];if(p){var m=f.ItemUtils.getShuXingByName(p[0]);d.text=m.desc+":",g.text=""+p[1]}else d.removeSelf(),g.removeSelf()}},e}(ui.hunyin.page.Tips_HlUI);t.Tips_Hl=i}),define("src/g/hunyin/view/page/NHunYinTruePage",["require","exports","../../../../config/GameConfig","../../../../meta/HunYinVo","../../../../manager/RoleCenter","../../../Effects/UIEffectsFactory","../../../../utils/ItemUtils","../../../Effects/UIEffectsEnum","../../../net/messages/PropFightMain","../../../../plugin/sbkPropTool","../../../net/messages/sbkFormula","src/g/hunyin/view/HunShopDlg","src/g/hunyin/view/LianHunDlg","../../../net/messages/ComboCultivateMsg","../../../../manager/GameSocketManager","src/g/hunyin/RedDot_hunTrue","src/g/hunyin/view/HunYinTips","../../../clearRes/ClearResM","../../../../init/TextConst"],function(e,t,s,r,i,l,h,u,a,o,c,n,d,g,p,m,f,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(t){function e(){var e=t.call(this)||this;return e.resCache=[],e.nowSelectPos=0,e.breathe=!1,e.bg1=!0,e.bg2=!1,e.addEvent(),e}return __extends(e,t),e.prototype.initView=function(){var e=[];for(var t in s.GameConfig.hunyin){var i=r.HeJiStruct.Ins.getHunYinVo(parseInt(t));i&&e.push(i)}this.list_hunyin.dataSource=e},e.prototype.addEvent=function(){this.list_hunyin.renderHandler=new Laya.Handler(this,this.hunyinListRender),this.list_hunyin.selectHandler=new Laya.Handler(this,this.onListSelect),this.on(Laya.Event.REMOVED,this,this.onRemoved),this.btn_achivate.on(Laya.Event.CLICK,this,this.onAchivateHunYin),this.item_0.on(Laya.Event.CLICK,this,this.onItemClick,[0]),this.item_1.on(Laya.Event.CLICK,this,this.onItemClick,[1]),this.item_2.on(Laya.Event.CLICK,this,this.onItemClick,[2]),this.item_3.on(Laya.Event.CLICK,this,this.onItemClick,[3]),this.item_4.on(Laya.Event.CLICK,this,this.onItemClick,[4]),this.item_5.on(Laya.Event.CLICK,this,this.onItemClick,[5]),l.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(this.btn_achivate,u.UIEffectsEnum.btn_001,.78,1.1).play()},e.prototype.onAchivateDebris=function(e){this["item_"+e].sp.removeChildren(),l.UIEffectsFactory.Ins.playAniOnce(u.UIEffectsEnum.governUpLv,this["item_"+e].sp)},e.prototype.showAni=function(){l.UIEffectsFactory.Ins.playAniOnce(u.UIEffectsEnum.hunyinopen,this.upAni,1.3,1.3)},e.prototype.onItemClick=function(e){var t=this.list_hunyin.dataSource[this.nowSelectPos],i=parseInt(t.hunyin[e][0]),n=-1<this.data.curHunYinIdArr.indexOf(i),s=this.user.bagdata.getItemCount(i)>=t.hunyin[e][1];if(!n&&s){var a=new g.ComboHunYinActivateMsg;a.curJie=t.id,a.itemId=i,p.GSM.sendServer(a)}else{console.log("tips");var o=new f.hunYinTips;o.initData(i),o.popup()}},e.prototype.onAchivateHunYin=function(){var e=this.list_hunyin.dataSource[this.nowSelectPos],t=new g.ComboHunYinUpgradeMsg;t.curJie=e.id,p.GSM.sendServer(t)},e.prototype.checkAchivateHunYin=function(){for(var e=this.list_hunyin.dataSource[this.nowSelectPos],t=!0,i=0;i<e.hunyin.length;i++){var n=parseInt(e.hunyin[i][0]);if(this.data.curHunYinIdArr.indexOf(n)<0){t=!1;break}}var s=-1<this.data.curHunYinJieArr.indexOf(e.id);t=t&&!s,this.btn_achivate.visible=t,this.lab_name.visible=!t},e.prototype.checkHunYinPower=function(){for(var e=new a.PropFightMain,t=0;t<this.data.curHunYinIdArr.length;t++){var i=s.GameConfig.hunyinProp[this.data.curHunYinIdArr[t]];o.sbkPropTool.reSetProp(e,i.prop,!1)}var n=0;for(t=0;t<this.data.curHunYinJieArr.length;t++){n+=(i=r.HeJiStruct.Ins.getHunYinVo(this.data.curHunYinJieArr[t])).power}this.box_fightnum.num_Fight.value=c.sbkFormula.calPropFightMainCombat(e)+n+""},e.prototype.refreshAttrShow=function(){var e,t=this.list_hunyin.dataSource[this.nowSelectPos];0<t.danti?((e=this.skill_show.getChildByName("danti"))||(e=new ui.hunyin.item.HunSkillItemUI),e.img_skill.skin="res/index1/zhujiemian_heji_jienng3.png",e.lab_des.text=v.TextConst.get(591),e.lab_num.text="+"+t.danti+"%",e.lab_name.text=v.TextConst.get(594),e.name="danti",this.skill_show.addChild(e)):(e=this.skill_show.getChildByName("danti"))&&e.removeSelf();0<t.qunti?((e=this.skill_show.getChildByName("qunti"))||(e=new ui.hunyin.item.HunSkillItemUI),e.img_skill.skin="res/index1/zhujiemian_heji_jienng2.png",e.lab_des.text=v.TextConst.get(591),e.lab_num.text="+"+t.qunti+"%",e.lab_name.text=v.TextConst.get(595),e.name="qunti",this.skill_show.addChild(e)):(e=this.skill_show.getChildByName("qunti"))&&e.removeSelf();0<t.wudi?((e=this.skill_show.getChildByName("wudi"))||(e=new ui.hunyin.item.HunSkillItemUI),e.img_skill.skin="res/index1/zhujiemian_heji_jienng1.png",e.lab_des.text=v.TextConst.get(592),e.lab_num.text="+"+v.TextConst.get(13,t.wudi),e.lab_name.text=v.TextConst.get(593),e.name="wudi",this.skill_show.addChild(e)):(e=this.skill_show.getChildByName("wudi"))&&e.removeSelf();this.skill_show.width=185*this.skill_show._childs.length,this.skill_show.x=(this.width-this.skill_show.width)/2},e.prototype.refreshHunYinList=function(){null==this.list_hunyin.dataSource||0==this.list_hunyin.dataSource.length?this.initView():this.list_hunyin.refresh()},e.prototype.refreshData=function(){this.user=i.RoleCenter.instans.vo,this.data=this.user.comboData,this.list_hunyin.mouseEnabled&&(this.refreshHunYinList(),-1==this.list_hunyin.selectedIndex?this.list_hunyin.selectedIndex=0:this.refreshBox()),this.breathe||this.displayedInStage&&this.startBreath(),y.ClearResM.resetViewImg(this)},e.prototype.refreshBox=function(){var e=this.list_hunyin.dataSource[this.nowSelectPos],t=-1<this.data.curHunYinJieArr.indexOf(e.id);t?(this.ani.visible=!0,this.loadAni()):(this.ani.stop(),this.ani.visible=!1,this.img_big.skin=r.HeJiStruct.getHunIconByIconId(e.id),this.img_big.disabled=!0),this.img_big.visible=!t,this.lab_name.skin="dynamic/hunyin/"+e.icon+".png",this.refreshItem(),this.checkAchivateHunYin(),this.checkHunYinPower(),this.refreshAttrShow(),y.ClearResM.resetViewImg(this)},e.prototype.refreshItem=function(){for(var e=this.list_hunyin.dataSource[this.nowSelectPos],t=0;t<6;t++){var i=this["item_"+t],n=parseInt(e.hunyin[t][0]+""),s=h.ItemUtils.getItemVoById(n);i.icon.skin=h.ItemUtils.getIconById(n);var a=-1<this.data.curHunYinIdArr.indexOf(n),o=this.user.bagdata.getItemCount(n)>=e.hunyin[t][1];if(i.icon.gray=!a,i.bg.skin="res/hunyin/zhanhun_wupindiban1.png",i.lab_name.text=s.name,i.bg.restskin(),i.icon.restskin(),y.ClearResM.resetViewImg(i),a)i.sp.removeChildren();else if(o)i.sp.getChildByName("ani")||l.UIEffectsFactory.Ins.createCenterSAniAndMonopolize(i.sp,u.UIEffectsEnum.hunyinsuipianjihuo,1.6,1.6);else i.sp.removeChildren()}},e.prototype.loadAni=function(){var i=this,n="dynamic2/hunyin/"+this.list_hunyin.dataSource[this.nowSelectPos].id+"a.json";this.resCache.indexOf(n)<0&&this.resCache.push(n),Laya.loader.load(n,Laya.Handler.create(this,function(){i.ani.source=n;var e=Laya.loader.getRes(n).frames;for(var t in e)if(e[t]&&e[t].sourceSize){i.ani.width=e[t].sourceSize.w,i.ani.height=e[t].sourceSize.h;break}l.UIEffectsFactory.Ins.centered4Parent(i.ani,i.box_),i.ani.interval=200,i.ani.play(0)}))},e.prototype.hunyinListRender=function(e,t){var i=e.getChildByName("img"),n=e.getChildByName("bg"),s=e.getChildByName("red"),a=e.getChildByName("select");a.visible=this.nowSelectPos==t;var o=e.dataSource;i.skin=r.HeJiStruct.getHunIconByIconId(o.id),n.skin="res/hunyin/zhanhun_wupindiban"+(-1<this.data.curHunYinJieArr.indexOf(o.id)?2:3)+".png",i.gray=this.data.curHunYinJieArr.indexOf(o.id)<0,s.visible=m.RedDot_hunTrue.Ins.red(!0)[t],a.restskin(),n.restskin(),s.restskin()},e.prototype.onListSelect=function(e){this.list_hunyin.mouseEnabled=!1,this.nowSelectPos=e;for(var t=0;t<6;t++)this["item_"+t].mouseEnabled=!1,Laya.Tween.to(this["item_"+t],{alpha:0},500);this.list_hunyin.refresh(),Laya.Tween.to(this.box_,{alpha:0},500,null,Laya.Handler.create(this,this.onChange))},e.prototype.onChange=function(){var e=this;this.refreshBox(),Laya.Tween.to(this.box_,{alpha:1},500,null,Laya.Handler.create(this,function(){e.list_hunyin.mouseEnabled=!0}));for(var t=0;t<6;t++)this["item_"+t].mouseEnabled=!0,Laya.Tween.to(this["item_"+t],{alpha:1},500)},e.prototype.onRemoved=function(){this.stopBreath(),this.upAni.removeChildren()},e.prototype.startBreath=function(){this.lbg1.alpha=1,this.lbg2.alpha=1,Laya.timer.loop(100,this,this.breath)},e.prototype.breath=function(){var e,t,i=this.lbg1.alpha,n=this.lbg2.alpha;e=.9<=i?.01:i<=.2?.02:.05,t=.9<=n?.01:n<=.2?.02:.05,this.lbg1.alpha<=.2&&(this.bg1=!0),1<=this.lbg1.alpha&&(this.bg1=!1),this.lbg2.alpha<=.2&&(this.bg2=!1),1<=this.lbg2.alpha&&(this.bg2=!0),this.lbg1.alpha=this.bg1?this.lbg1.alpha+e:this.lbg1.alpha-e,this.lbg2.alpha=this.bg2?this.lbg2.alpha-t:this.lbg2.alpha+t},e.prototype.onOpenShop=function(){(new n.HunShopDlg).popup()},e.prototype.onOpenLianHun=function(){(new d.LianHunDlg).popup()},e.prototype.stopBreath=function(){this.breathe=!1,Laya.timer.clear(this,this.breath)},e}(ui.hunyin.page.NHunYinTrueUI);t.NHunYinTruePage=_});