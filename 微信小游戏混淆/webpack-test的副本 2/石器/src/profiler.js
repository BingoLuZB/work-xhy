(function(){return function o(a,r,h){function l(e,t){if(!r[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(c)return c(e,!0);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}var n=r[e]={exports:{}};a[e][0].call(n.exports,function(t){return l(a[e][1][t]||t)},n,n.exports,o,a,r,h)}return r[e].exports}for(var c="function"==typeof require&&require,t=0;t<h.length;t++)l(h[t]);return l}})()({1:[function(t,e,i){"use strict";(function(){var t;t=b8e.BaseDisplay.extends({_bg:null,_callback:null,_thisArg:null,ctor:function(t,e,i,s,n){var o=0<arguments.length&&void 0!==t?t:"Button",a=e,r=i,h=3<arguments.length&&void 0!==s?s:28,l=4<arguments.length&&void 0!==n?n:4289374890,c=this;c._super(),c.displaySniffEnable=!1,c._callback=a,c._thisArg=r,c._bg=bui.Graphics.get(),c._bg.displaySniffEnable=!1,c.addChild(c._bg),c._bg.setPosition(0,0),b8e.evt.onC(c._bg,c._onClick,c);var u=c._label=bui.Label.get();u.displaySniffEnable=!1,u.fontAtlasName="profiler",c.addChild(c._label),u.setFontSize(h),u.setLineHeight(h+2),u.setColor(l),u.setFontFamily("Microsoft YaHei"),u.setText(o),c._bg.clear(),c._bg.setSize(u.width+10,u.height+5),c._bg.fillColor(4280427042),c._bg.lineWidth(2),c._bg.strokeColor(4289374890),c._bg.fillRect(0,0,c._bg.width,c._bg.height),u.setPosition(c._bg.width-u.width>>1,c._bg.y+(c._bg.height-u.height>>1)-2),c.setSize(c._bg.width,c._bg.height)},_onClick:function(){this._callback&&this._callback.call(this._thisArg,this)}}),b8e.RC("$$b8e","$$SimpleButton",t)})(),function(){var t;t=b8e.SimpleButton.extends({_isChecked:!1,ctor:function(t,e,i,s,n){var o=0<arguments.length&&void 0!==t?t:"Button",a=e,r=i,h=3<arguments.length&&void 0!==s?s:28,l=4<arguments.length&&void 0!==n?n:11184810;this._super(o,a,r,h,l),this._draw()},_onClick:function(t){this._isChecked=!this._isChecked,this._draw(),this._super(t)},_draw:function(){var t=this._bg;t.clear(),t.fillColor(4280427042),t.lineWidth(2),t.strokeColor(4289374890),t.fillRect(0,0,t.width,t.height),this._isChecked||(t.moveTo(0,0),t.lineTo(t.width,t.height),t.moveTo(0,t.height),t.lineTo(t.width,0)),t.stroke()},setChecked:function(t){this._isChecked!=t&&(this._isChecked=t,this._draw())},getChecked:function(){return this._isChecked},isChecked:{get:function(){return this.getChecked()}}}),b8e.RC("$$b8e","$$SimpleToggleButton",t)}(),function(){var t;t=b8e.Object.extends({_capabilityWatchs:null,_capabilityItems:null,_statsWatchs:null,_statsItems:null,_watchs:null,_updateType:0,ctor:function(){this._super(),this._watchs=[]},init:function(){this._capabilityWatchs={fps:{desc:"Framerate (FPS)",below:20,average:500},frameTime:{desc:"Frame Time (ms)",min:0,max:50,over:18,average:500},draws:{desc:"Draw Call"},logic:{desc:"Game Logic (ms)",min:0,max:50,average:500,color:"#080"},render:{desc:"Renderer (ms)",min:0,max:50,average:500,color:"#f90"},memoryUsed:{desc:"Used Memory",extension:"memory.used",average:1e3,threshold:!0},memoryTotal:{desc:"Total Memory",extension:"memory.total",average:1e3,threshold:!0},memoryLimit:{desc:"Limit Memory",extension:"memory.limit",average:1e3,threshold:!0},costFrame:{desc:"Cost Frame (ms)"},textureMemory:{desc:"Texture Memory (MB)",over:1e-6*b8e.TextureCache.MAX_MEMORY},raf:{desc:"Raf Time (ms)",average:100}};var t=this._capabilityItems={};for(var e in this._capabilityWatchs){var i=this._capabilityWatchs[e];t[e]=new o(i)}for(var s in this._statsWatchs={gameVersion:{desc:"Game Version"},engineVersion:{desc:"Engine Version"},resVersion:{desc:"Res Version"},isMobile:{desc:"Is Mobile"},textureFormat:{desc:"Texture Format"},runTime:{desc:"Run Time"},serverTime:{desc:"Server Time"},ping:{desc:"Ping (ms)"},framerate:{desc:"Framerate (FPS)"},os:{desc:"OS"},renderType:{desc:"Render Type"},resCount:{desc:"Res Count"},resStatus:{desc:"Res Status"},netIo:{desc:"Net IO"},displayCount:{desc:"Display Count"},nodeEventCount:{desc:"Node Event Count"},tickerCount:{desc:"Ticker Count"},timerCount:{desc:"Timer Count"},timeoutCount:{desc:"Timeout Count"},tweenCount:{desc:"Tween Count"},shaderCount:{desc:"Shader Count"},glProgramCount:{desc:"GLProgram Count"},parseQueueCount:{desc:"Parse Queue Count"},poolLazyCount:{desc:"Pool Lazy Count"},sceneDisplay:{desc:"Scene Display"},tileCount:{desc:"Tile Count"},bufferCount:{desc:"Buffer Count"},imageCount:{desc:"Image Count"},textureCount:{desc:"Texture Count"},textureRenderCount:{desc:"Texture Render Count"},instCount:{desc:"Inst Count"},clsCount:{desc:"Cls Count"},funcCount:{desc:"Func Count"},mapCount:{desc:"Map Count"},configCount:{desc:"Config Count"},callLaterCount:{desc:"CallLater Count"},processLostTime:{desc:"Process Lost Time (s)"},stageSize:{desc:"Stage Size"},screenSize:{desc:"Screen Size"},gameFps:{desc:"Game (FPS)"}},this._watchs.forEach(function(t){this._statsWatchs[t.label]={desc:t.desc}},this),t=this._statsItems={},this._statsWatchs){i=this._statsWatchs[s];t[s]=new o(i)}t.gameVersion.value="V"+game.VERSION,t.engineVersion.value="V"+b8e.BUILD_VERSION,t.resVersion.value="V"+b8e.res.getInitVersion()+"."+b8e.res.getVersion()+"."+b8e.res.getResVersion(),t.isMobile.value=b8e.isMobile;var n="";b8e.renderType===b8e.RenderType.CANVAS?n="canvas":b8e.renderType===b8e.RenderType.WEBGL&&(n="webgl"),t.renderType.value=n,t.os.value=b8e.os,t.textureFormat.value=b8e.Texture2DAsset.getFileFormat(!1)+","+b8e.Texture2DAsset.getFileFormat(!0)},addWatch:function(t,e,i,s){this._watchs.push({label:t,desc:e,getter:i,thisArg:s})},setUpdateType:function(t){this._updateType=t},getFpsData:function(t){if(t){var e=this._capabilityWatchs[t];return e||null}return this._capabilityWatchs},getStatsData:function(t){if(t){var e=this._statsWatchs[t];return e||null}return this._statsWatchs},beforeUpdate:function(){if(0==this._updateType||1==this._updateType){var t=this._capabilityItems;t.frameTime.start(),t.logic.start(),t.memoryUsed.snapshot(),t.memoryTotal.snapshot(),t.memoryLimit.snapshot()}},afterUpdate:function(){if(0==this._updateType||1==this._updateType){var t=this._capabilityItems;t.logic.end(),t.draws.value=b8e.getDrawCalls(),t.raf.tick(),t.fps.frame(),t.frameTime.end(),t.costFrame.value=b8e.ticker.getCostFrame()+"/"+b8e.ticker.getMaxCostFrame(),t.textureMemory.value=Math.round(1e-4*b8e.TextureCache.getTotalBytes())/100}if(0==this._updateType||2==this._updateType){var e=this._statsItems,i=b8e.NetMgr.getMgr("main"),s=b8e.SceneMgr.inst().getScene("main"),n=s?s.getMapLayer().getEarthSurface()._startTileX:null;n=isNaN(n)?0:n;var o=s?s.getMapLayer().getEarthSurface()._endTileX:null;o=isNaN(o)?0:o;var a=s?s.getMapLayer().getEarthSurface()._startTileY:null;a=isNaN(a)?0:a;var r=s?s.getMapLayer().getEarthSurface()._endTileY:null;r=isNaN(r)?0:r,e.runTime.value=b8e.TimeUtil.formatTime(b8e.timeStamp),e.serverTime.value=b8e.TimeUtil.formatTimestamp(b8e.startup.getServerTime()),e.ping.value=b8e.startup.getPing(),e.framerate.value=b8e.Ticker.getFps()+"/"+b8e.Ticker.getRenderFps()+"/"+b8e.Ticker.getFrameRate(),e.tileCount.value=s?s.tileRenderCount+"/"+s.tileCount+"/"+n+","+o+","+a+","+r:"",e.resCount.value=b8e.res.resCount+"/"+b8e.res.recycleCount+"/"+b8e.res.cacheCount,e.resStatus.value=b8e.res.isLoading()?"loading":"free",e.netIo.value=b8e.StringUtil.bytesToSize(i.getInputTotalbytes())+"/"+b8e.StringUtil.bytesToSize(i.getOutputTotalbytes())+"/"+i.maxFrameReceiveCount,e.displayCount.value=b8e.BaseDisplay.inHierarchyCount+"/"+b8e.BaseDisplay.count,e.nodeEventCount.value=b8e.BaseDisplay.nodeEventCount,e.tickerCount.value=b8e.Ticker.getCount(),e.timerCount.value=b8e.Timer?b8e.Timer.getCount():"0",e.timeoutCount.value=b8e.timeoutCount(),e.tweenCount.value=b8e.Tween?b8e.Tween.getCount()+"/"+b8e.Tween.poolCount():"0/0",e.shaderCount.value=b8e.ShaderProgram?b8e.ShaderProgram.getCount():0,e.glProgramCount.value=0,e.parseQueueCount.value=b8e.Texture2DAsset.parseQueueCount(),e.poolLazyCount.value=b8e.Pool.getLazyCount(),e.sceneDisplay.value=s?s.entityRenderCount+"/"+s.entityCount:"",e.bufferCount.value=b8e.ByteBuffer.count+"/"+b8e.ByteBuffer.pool.count,e.imageCount.value=b8e.Texture2DAsset.imageCount,e.textureCount.value=b8e.TextureCache.getCounter(),e.textureRenderCount.value=b8e.GLTexture.getActiveCount()+"/"+b8e.Texture2D.getFreeCount()+"/"+b8e.GLTexture.getPoolCount()+"/"+b8e.GLTexture.getCreateCount(),e.instCount.value=b8e.instCount,e.clsCount.value=b8e.clsCount,e.funcCount.value=b8e.funcCount,e.mapCount.value=b8e.mapCount,e.configCount.value=b8e.ConfigData.parseCount+"/"+b8e.ConfigData.totalCount,e.callLaterCount.value=b8e.CallLater.processingCount,e.processLostTime.value=(b8e.ProcessStateMachine.getLostTime()/1e3).toFixed(2),e.stageSize.value=b8e.stageWidth+"*"+b8e.stageHeight,e.screenSize.value=b8e.screenWidth+"*"+b8e.screenHeight,e.gameFps.value=b8e.ticker.getFps()+"/"+b8e.ticker.getRenderFps()+"/"+b8e.ticker.getFrameRate(),this._watchs.forEach(function(t){e[t.label].value=t.getter.call(t.thisArg)},this)}},beforeDraw:function(){0!=this._updateType&&1!=this._updateType||this._capabilityItems.render.start()},afterDraw:function(){0!=this._updateType&&1!=this._updateType||this._capabilityItems.render.end()}});var o=b8e.Object.extends({_opts:null,_field:null,_time:0,_value:0,_average:void 0,_total:0,_averageValue:0,_accumValue:0,_accumSamples:0,_accumStart:0,ctor:function(t){this._super(),(this._opts=t).extension&&0===t.extension.indexOf("memory.")&&(this._field=t.extension.substring(7)),this._average=t.average,this._accumStart=b8e.getNow(),this.value="n/a"},value:{set:function(t){this._opts.value=t}},start:function(){this._time=b8e.getNow()},end:function(){this._value=b8e.getNow()-this._time,this.average(this._value),this.value=this.human()},snapshot:function(){this._field&&(this._value=this[this._field]),this.value=this.human()},tick:function(){this.end(),this.start()},frame:function(){var t=b8e.getNow(),e=t-this._time;this._total++,(this._average||1e3)<e&&(this._value=1e3*this._total/e,this._total=0,this._time=t,this.average(this._value)),this.value=this.human()},average:function(t){if(this._average){this._accumValue+=t,++this._accumSamples;var e=b8e.getNow();e-this._accumStart>=this._average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=e,this._accumSamples=0)}},human:function(){if("number"!=typeof this._value)return this._value;var t=this._average?this._averageValue:this._value;return Math.round(100*t)/100},used:{get:function(){return"n/a"}},total:{get:function(){return"n/a"}},limit:{get:function(){return"n/a"}}});o.poolCall=!0,b8e.RC("$$b8e","$$Detector",t)}(),function(){var t;t=b8e.Object.extends({_stats:null,_root:null,ctor:function(){this._super();function t(t,e){this._color=e||"#666",this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvasDot=document.createElement("canvas"),this._ctxDot=this._canvasDot.getContext("2d"),this._canvasAlarm=document.createElement("canvas"),this._ctxAlarm=this._canvasAlarm.getContext("2d"),this._canvas.className="stats-canvas",t.appendChild(this._canvas)}t.prototype.init=function(t,e){this._canvas.width=t,this._canvas.height=e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px",this._ctx.fillStyle="#444",this._ctx.fillRect(0,0,t,e),this._canvasDot.width=1,this._canvasDot.height=2*e,this._ctxDot.fillStyle="#444",this._ctxDot.fillRect(0,0,1,2*e),this._ctxDot.fillStyle=this._color,this._ctxDot.fillRect(0,e,1,e),this._ctxDot.fillStyle="#fff",this._ctxDot.globalAlpha=.5,this._ctxDot.fillRect(0,e,1,1),this._ctxDot.globalAlpha=1,this._canvasAlarm.width=1,this._canvasAlarm.height=2*e,this._ctxAlarm.fillStyle="#444",this._ctxAlarm.fillRect(0,0,1,2*e),this._ctxAlarm.fillStyle="#b70000",this._ctxAlarm.fillRect(0,e,1,e),this._ctxAlarm.globalAlpha=.5,this._ctxAlarm.fillStyle="#fff",this._ctxAlarm.fillRect(0,e,1,1),this._ctxAlarm.globalAlpha=1};(function(i){function t(t,e){i.call(this,t,e),this._current=0,this._max=0}i&&(t.prototype=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.draw=function(t,e){this._current+=.1*(t-this._current),this._max*=.99,this._current>this._max&&(this._max=this._current);var i=Math.round(-this._canvas.height*this._current/this._max);this._ctx.drawImage(this._canvas,1,0,this._canvas.width-1,this._canvas.height,0,0,this._canvas.width-1,this._canvas.height),e?this._ctx.drawImage(this._canvasAlarm,this._canvas.width-1,i):this._ctx.drawImage(this._canvasDot,this._canvas.width-1,i)}})(t),function(i){function t(t,e){i.call(this,t,e),this._threshold=0,this._canvas2=document.createElement("canvas"),this._ctx2=this._canvas2.getContext("2d")}i&&(t.prototype=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.init=function(t,e){i.prototype.init.call(this,t,e),this._canvas2.width=t,this._canvas2.height=e,this._ctx2.fillStyle="#444",this._ctx2.fillRect(0,0,t,e)},t.prototype.draw=function(t,e){if(t>this._threshold){var i=(t-t%this._canvas.height)/this._canvas.height,s=this._canvas.height*(1+i),n=this._threshold/(this._threshold=s);this._ctx2.drawImage(this._canvas,0,0),this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height),this._ctx.drawImage(this._canvas2,1,0,this._canvas.width-1,this._canvas.height,0,(1-n)*this._canvas.height,this._canvas.width-1,this._canvas.height)}else this._ctx.drawImage(this._canvas,1,0,this._canvas.width-1,this._canvas.height,0,0,this._canvas.width-1,this._canvas.height);var o=Math.round(-this._canvas.height*t/this._threshold);e?this._ctx.drawImage(this._canvasAlarm,this._canvas.width-1,o):this._ctx.drawImage(this._canvasDot,this._canvas.width-1,o)}}(t),function(n){function t(t,e,i,s){n.call(this,t,e),this._min=i,this._max=s}n&&(t.prototype=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.draw=function(t,e){var i=(t-this._min)/(this._max-this._min),s=-Math.ceil(this._canvas.height*i);this._ctx.drawImage(this._canvas,1,0,this._canvas.width-1,this._canvas.height,0,0,this._canvas.width-1,this._canvas.height),e?this._ctx.drawImage(this._canvasAlarm,this._canvas.width-1,s):this._ctx.drawImage(this._canvasDot,this._canvas.width-1,s)}}(t);function e(t,e){this._id=t,this._opts=e||{},this._value=0,this._total=0,this._averageValue=0,this._accumValue=0,this._accumSamples=0,this._accumStart=b8e.getNow()}var i={value:{}};e.prototype._average=function(t){if(this._opts.average){this._accumValue+=t,++this._accumSamples;var e=b8e.getNow();e-this._accumStart>=this._opts.average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=e,this._accumSamples=0)}},i.value.get=function(){return this._value},i.value.set=function(t){this._value=t},e.prototype.sample=function(){"number"==typeof this._value&&this._average(this._value)},e.prototype.human=function(){if("number"!=typeof this._value)return this._value;var t=this._opts.average?this._averageValue:this._value;return Math.round(100*t)/100},e.prototype.alarm=function(){return"number"==typeof this._value&&(this._opts.below&&this._value<this._opts.below||this._opts.over&&this._value>this._opts.over)},Object.defineProperties(e.prototype,i);function s(){window.performance.memory.totalJSHeapSize,this._used=0,this._total=0,this._limit=0,this._lastUsed=0}var a=function(i){function t(t,e){i.call(this,t,e),this._time=b8e.getNow()}return i&&(t.prototype=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.start=function(){this._time=b8e.getNow()},t.prototype.end=function(){this._value=b8e.getNow()-this._time,this._average(this._value)},t.prototype.tick=function(){this.end(),this.start()},t.prototype.frame=function(){var t=b8e.getNow(),e=t-this._time;this._total++,(this._opts.average||1e3)<e&&(this._value=1e3*this._total/e,this._total=0,this._time=t,this._average(this._value))},t}(e),n=function(s){function t(t,e,i){s.call(this,e,i),this._stats=t,(this._start=0)===i.extension.indexOf("memory.")&&(this._field=i.extension.substring(7))}return s&&(t.prototype=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.snapshot=function(){this._value=this._stats[this._field]},t.prototype.start=function(){this._start=this._stats[this._field]},t.prototype.end=function(){this._value=this._stats[this._field]-this._start},t.prototype.human=function(){var t=s.prototype.human.call(this);return t?b8e.StringUtil.bytesToSize(t):"n/a"},t}(e),o={alarm:{},used:{},total:{},limit:{}};s.prototype.tick=function(){this._lastUsed=this._used,this._used=window.performance.memory.usedJSHeapSize,this._total=window.performance.memory.totalJSHeapSize,this._limit=window.performance.memory.jsHeapSizeLimit},o.alarm.get=function(){return this._used-this._lastUsed<0},o.used.get=function(){return this._used},o.total.get=function(){return this._total},o.limit.get=function(){return this._limit},s.prototype.counter=function(t,e){return new n(this,t,e)},Object.defineProperties(s.prototype,o);var S={memory:s},r=document.createElement("style");r.type="text/css",r.textContent="\n  .stats {\n    position: absolute;\n    z-index: 9999;\n\n    padding: 5px;\n    width: 150px;\n    right: 0;\n    bottom: 0;\n\n    font-size: 10px;\n    font-family: 'Roboto Condensed', tahoma, sans-serif;\n    overflow: hidden;\n    user-select: none;\n    cursor: default;\n\n    background: #222;\n    border-radius: 3px;\n\n  }\n\n  .stats-container {\n    display: flex;\n    flex-direction: column;\n    color: #888;\n    white-space: nowrap;\n  }\n\n.stats-item {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    border-bottom:1px solid #333;\n    }\n\n.stats-label {\n    display: flex;\n    flex-direction: row;\n    flex: 1;\n\n    text-align: left;\n    margin-right: 0px;\n\n    transition: background 0.3s;\n  }\n\n  .stats-label.alarm {\n    color: #ccc;\n    background: #800;\n\n    transition: background 0s;\n  }\n\n  .stats-counter-id {\n    flex: 1;\n  }\n\n  .stats-counter-value {\n    flex: 1;\n    text-align: right;\n  }\n\n  .stats-fraction {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-top: 1px;\n    margin-bottom: 1px;\n  }\n\n  .stats-legend {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n\n    text-align: right;\n    margin-right: 5px;\n  }\n.stats-canvas {\nwidth: 150px;\nheight: 10px;\n}\n",document.head.appendChild(r);function h(t,e){if(e=e||{},this._values=e.values||{},this._fractions=e.fractions||[],this._id2counter={},this._id2item={},this._name2extStats={},e.css){var i=document.createElement("style");i.type="text/css",i.textContent=e.css,document.head.appendChild(i)}if(e.extensions)for(var s=0;s<e.extensions.length;++s){var n=e.extensions[s],o=S[n];o?this._name2extStats[n]=new o:b8e.warn("Can not find extensions "+n+", please register your extension via stats.register().")}this._root=document.createElement("div"),this._root.className="stats";var a=document.createElement("div");a.className="stats-container",this._root.appendChild(a);var r=0;for(var h in this._values){var l=this._values[h],c=document.createElement("div");c.className="stats-item",c.style.top=12*r+"px";var u=document.createElement("div");u.className="stats-label";var d=document.createElement("span");d.className="stats-counter-id",d.textContent=l.desc||h;var _=document.createElement("div");_.className="stats-counter-value";var p=document.createTextNode("");p.nodeValue="0",u.appendChild(d),u.appendChild(_),_.appendChild(p),c.appendChild(u),this._id2item[h]={label:u,valueText:p},a.appendChild(c),r++}if(a.style.height=12*r,e.fractions)for(var m=0;m<e.fractions.length;++m){var f=e.fractions[m];f.colors=f.colors||["#850700","#c74900","#fcb300","#284280","#4c7c0c"];var g=document.createElement("div");g.className="stats-fraction";var b=document.createElement("div");b.className="stats-legend";for(var v=f.steps,C=0;C<v.length;++C){var y=document.createElement("span");y.textContent=v[C],y.style.color=f.colors[C],b.appendChild(y)}g.appendChild(b),g.style.height=10*v.length+"px",f.values=new Array(v.length),a.appendChild(g)}t.appendChild(this._root)}h.prototype.item=function(t){if(!t)return null;var e=this._id2counter[t];if(e)return e;var i=this._values[t];if(!i)return null;if(i.extension){var s=i.extension.indexOf("."),n=i.extension.substring(0,s),o=this._name2extStats[n];if(!o)return b8e.error("extension "+n+" not found, make sure you have register and enable it."),null;e=o.counter(t,i)}else e=new a(t,i);return this._id2counter[t]=e},h.prototype.tick=function(){var t=this;for(var e in t._name2extStats){t._name2extStats[e].tick()}for(var i in t._values){var s=t._id2counter[i];if(s){s.sample();var n=s.alarm(),o=s.human(),a=t._id2item[i];a.label.classList.toggle("alarm",0<n),a.valueText.nodeValue=o}}for(var r=0;r<this._fractions.length;++r){var h=t._fractions[r],l=t._id2counter[h.base];if(l)for(var c=h.steps,u=0;u<c.length;++u){var d=c[u],_=t._id2counter[d];_&&(h.values[u]=_.value/l.value)}}},this._stats={newnew$1:function(t,e){var i=new h(t,e);return function(t){return t?i.item(t):i}},registerregister:function(t,e){S[t]=e}}},init:function(t,e){return this._stats.new(t,e)},getRoot:function(){return this._root}}),b8e.RC("$$b8e","$$Stats",t)}(),function(){var u=b8e.DebugUI={};u.Element=function(t){this.dom=t},u.Element.prototype={add:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];e instanceof u.Element?this.dom.appendChild(e.dom):b8e.error("UI.Element:",e,"is not an instance of UI.Element.")}return this},remove:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];e instanceof u.Element?e.dom.parentElement===this.dom&&this.dom.removeChild(e.dom):b8e.error("UI.Element:",e,"is not an instance of UI.Element.")}return this},clear:function(){for(;this.dom.children.length;)this.dom.removeChild(this.dom.lastChild)},setId:function(t){return this.dom.id=t,this},setClass:function(t){return this.dom.className=t,this},setStyle:function(t,e){for(var i=0;i<e.length;i++)this.dom.style[t]=e[i];return this},setDisabled:function(t){return this.dom.disabled=t,this},setTextContent:function(t){return this.dom.textContent=t,this},addEventListener:function(t,e){this.dom.addEventListener(t,e,!1)},removeEventListener:function(t,e){this.dom.removeEventListener(t,e)}};["position","left","top","right","bottom","width","height","display","overflow","border","borderLeft","borderTop","borderRight","borderBottom","borderColor","margin","marginLeft","marginTop","marginRight","marginBottom","padding","paddingLeft","paddingTop","paddingRight","paddingBottom","color","background","backgroundColor","opacity","verticalAlign","fontSize","fontWeight","textAlign","textDecoration","textTransform","cursor","zIndex"].forEach(function(t){var e="set"+t.substr(0,1).toUpperCase()+t.substr(1,t.length);u.Element.prototype[e]=function(){return this.setStyle(t,arguments),this}});["KeyUp","KeyDown","MouseOver","MouseOut","Click","DblClick","Change"].forEach(function(e){var t="on"+e;u.Element.prototype[t]=function(t){return this.dom.addEventListener(e.toLowerCase(),t.bind(this),!1),this}}),u.Span=function(){return u.Element.call(this),this.dom=document.createElement("span"),this},u.Span.prototype=Object.create(u.Element.prototype),u.Span.prototype.constructor=u.Span,u.Div=function(){return u.Element.call(this),this.dom=document.createElement("div"),this},u.Div.prototype=Object.create(u.Element.prototype),u.Div.prototype.constructor=u.Div,u.Row=function(){u.Element.call(this);var t=document.createElement("div");return t.className="Row",this.dom=t,this},u.Row.prototype=Object.create(u.Element.prototype),u.Row.prototype.constructor=u.Row,u.Panel=function(){u.Element.call(this);var t=document.createElement("div");return t.className="Panel",this.dom=t,this},u.Panel.prototype=Object.create(u.Element.prototype),u.Panel.prototype.constructor=u.Panel,u.Text=function(t){u.Element.call(this);var e=document.createElement("span");return e.className="Text",e.style.cursor="default",e.style.display="inline-block",e.style.textAlign="left",e.style.fontSize="12px",e.style.width="50px",this.dom=e,this.setValue(t),this},u.Text.prototype=Object.create(u.Element.prototype),u.Text.prototype.constructor=u.Text,u.Text.prototype.getValue=function(){return this.dom.textContent},u.Text.prototype.setValue=function(t){return void 0!==t&&(this.dom.textContent=t),this},u.Input=function(t){u.Element.call(this);var e=document.createElement("input");return e.className="Input",e.style.padding="2px",e.style.border="1px solid transparent",e.addEventListener("keydown",function(t){t.stopPropagation()},!1),this.dom=e,this.setValue(t),this},u.Input.prototype=Object.create(u.Element.prototype),u.Input.prototype.constructor=u.Input,u.Input.prototype.getValue=function(){return this.dom.value},u.Input.prototype.setValue=function(t){return this.dom.value=t,this},u.TextArea=function(){u.Element.call(this);var i=document.createElement("textarea");return i.className="TextArea",i.style.padding="2px",i.spellcheck=!1,i.addEventListener("keydown",function(t){if(t.stopPropagation(),9===t.keyCode){t.preventDefault();var e=i.selectionStart;i.value=i.value.substring(0,e)+"\t"+i.value.substring(e),i.selectionStart=e+1,i.selectionEnd=i.selectionStart}},!1),this.dom=i,this},u.TextArea.prototype=Object.create(u.Element.prototype),u.TextArea.prototype.constructor=u.TextArea,u.TextArea.prototype.getValue=function(){return this.dom.value},u.TextArea.prototype.setValue=function(t){return this.dom.value=t,this},u.TextArea.prototype.setReadOnly=function(t){return this.dom.readOnly=t,this},u.TextArea.prototype.setResize=function(t){return this.dom.style.resize=t,this},u.Select=function(){u.Element.call(this);var t=document.createElement("select");return t.className="Select",t.style.padding="2px",this.dom=t,this},u.Select.prototype=Object.create(u.Element.prototype),u.Select.prototype.constructor=u.Select,u.Select.prototype.setMultiple=function(t){return this.dom.multiple=t,this},u.Select.prototype.setOptions=function(t){for(var e=this.dom.value;0<this.dom.children.length;)this.dom.removeChild(this.dom.firstChild);for(var i in t){var s=document.createElement("option");s.value=i,s.innerHTML=t[i],this.dom.appendChild(s)}return this.dom.value=e,this},u.Select.prototype.getValue=function(){return this.dom.value},u.Select.prototype.setValue=function(t){return t=String(t),this.dom.value!==t&&(this.dom.value=t),this},u.Checkbox=function(t){u.Element.call(this);var e=document.createElement("input");return e.className="Checkbox",e.type="checkbox",this.dom=e,this.setValue(t),this},u.Checkbox.prototype=Object.create(u.Element.prototype),u.Checkbox.prototype.constructor=u.Checkbox,u.Checkbox.prototype.getValue=function(){return this.dom.checked},u.Checkbox.prototype.setValue=function(t){return void 0!==t&&(this.dom.checked=t),this},u.Color=function(){u.Element.call(this);var t=document.createElement("input");t.className="Color",t.style.width="64px",t.style.height="17px",t.style.border="0px",t.style.padding="2px",t.style.backgroundColor="transparent";try{t.type="color",t.value="#ffffff"}catch(t){}return this.dom=t,this},u.Color.prototype=Object.create(u.Element.prototype),u.Color.prototype.constructor=u.Color,u.Color.prototype.getValue=function(){return this.dom.value},u.Color.prototype.getHexValue=function(){return parseInt(this.dom.value.substr(1),16)},u.Color.prototype.setValue=function(t){return this.dom.value=t,this},u.Color.prototype.setHexValue=function(t){return this.dom.value="#"+("000000"+t.toString(16)).slice(-6),this},u.Number=function(t){u.Element.call(this);var s=this,n=document.createElement("input");n.className="Number",n.value="0.00",n.addEventListener("keydown",function(t){t.stopPropagation(),13===t.keyCode&&n.blur()},!1),this.value=0,this.min=-1/0,this.max=1/0,this.precision=2,this.step=1,this.unit="",this.dom=n,this.setValue(t);var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!0);var a=0,r=0,h=[0,0],l=[0,0];function e(t){var e=s.value;h=[t.clientX,t.clientY],a+=h[0]-l[0]-(h[1]-l[1]);var i=r+a/(t.shiftKey?5:50)*s.step;e!==(i=Math.min(s.max,Math.max(s.min,i)))&&(s.setValue(i),n.dispatchEvent(o)),l=[t.clientX,t.clientY]}function i(t){document.removeEventListener("mousemove",e,!1),document.removeEventListener("mouseup",i,!1),Math.abs(a)<2&&(n.focus(),n.select())}function c(t){n.style.backgroundColor="transparent",n.style.cursor="col-resize"}return c(),n.addEventListener("mousedown",function(t){t.preventDefault(),a=0,r=s.value,l=[t.clientX,t.clientY],document.addEventListener("mousemove",e,!1),document.addEventListener("mouseup",i,!1)},!1),n.addEventListener("change",function(t){s.setValue(n.value)},!1),n.addEventListener("focus",function(t){n.style.backgroundColor="",n.style.cursor=""},!1),n.addEventListener("blur",c,!1),this},u.Number.prototype=Object.create(u.Element.prototype),u.Number.prototype.constructor=u.Number,u.Number.prototype.getValue=function(){return this.value},u.Number.prototype.setValue=function(t){return void 0!==t&&((t=parseFloat(t))<this.min&&(t=this.min),t>this.max&&(t=this.max),this.value=t,this.dom.value=t.toFixed(this.precision),""!==this.unit&&(this.dom.value+=" "+this.unit)),this},u.Number.prototype.setPrecision=function(t){return this.precision=t,this},u.Number.prototype.setStep=function(t){return this.step=t,this},u.Number.prototype.setRange=function(t,e){return this.min=t,this.max=e,this},u.Number.prototype.setUnit=function(t){return this.unit=t,this},u.Integer=function(t){u.Element.call(this);var s=this,n=document.createElement("input");n.className="Number",n.value="0",n.addEventListener("keydown",function(t){t.stopPropagation()},!1),this.value=0,this.min=-1/0,this.max=1/0,this.step=1,this.dom=n,this.setValue(t);var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!0);var a=0,r=0,h=[0,0],l=[0,0];function e(t){var e=s.value;h=[t.clientX,t.clientY],a+=h[0]-l[0]-(h[1]-l[1]);var i=r+a/(t.shiftKey?5:50)*s.step;e!==(i=0|Math.min(s.max,Math.max(s.min,i)))&&(s.setValue(i),n.dispatchEvent(o)),l=[t.clientX,t.clientY]}function i(t){document.removeEventListener("mousemove",e,!1),document.removeEventListener("mouseup",i,!1),Math.abs(a)<2&&(n.focus(),n.select())}function c(t){n.style.backgroundColor="transparent",n.style.cursor="col-resize"}return c(),n.addEventListener("mousedown",function(t){t.preventDefault(),a=0,r=s.value,l=[t.clientX,t.clientY],document.addEventListener("mousemove",e,!1),document.addEventListener("mouseup",i,!1)},!1),n.addEventListener("change",function(t){s.setValue(n.value)},!1),n.addEventListener("focus",function(t){n.style.backgroundColor="",n.style.cursor=""},!1),n.addEventListener("blur",c,!1),this},u.Integer.prototype=Object.create(u.Element.prototype),u.Integer.prototype.constructor=u.Integer,u.Integer.prototype.getValue=function(){return this.value},u.Integer.prototype.setValue=function(t){return void 0!==t&&(t=parseInt(t),this.value=t,this.dom.value=t),this},u.Integer.prototype.setStep=function(t){return this.step=parseInt(t),this},u.Integer.prototype.setRange=function(t,e){return this.min=t,this.max=e,this},u.Break=function(){u.Element.call(this);var t=document.createElement("br");return t.className="Break",this.dom=t,this},u.Break.prototype=Object.create(u.Element.prototype),u.Break.prototype.constructor=u.Break,u.HorizontalRule=function(){u.Element.call(this);var t=document.createElement("hr");return t.className="HorizontalRule",this.dom=t,this},u.HorizontalRule.prototype=Object.create(u.Element.prototype),u.HorizontalRule.prototype.constructor=u.HorizontalRule,u.Button=function(t){u.Element.call(this);var e=document.createElement("button");return e.className="Button",this.dom=e,this.dom.textContent=t,this},u.Button.prototype=Object.create(u.Element.prototype),u.Button.prototype.constructor=u.Button,u.Button.prototype.setLabel=function(t){return this.dom.textContent=t,this},u.Modal=function(t){var e=this,i=document.createElement("div");return i.style.position="absolute",i.style.width="100%",i.style.height="100%",i.style.backgroundColor="rgba(0,0,0,0.5)",i.style.display="none",i.style.alignItems="center",i.style.justifyContent="center",i.addEventListener("click",function(t){e.hide()}),this.dom=i,this.container=new u.Panel,this.container.dom.style.width="200px",this.container.dom.style.padding="20px",this.container.dom.style.backgroundColor="#ffffff",this.container.dom.style.boxShadow="0px 5px 10px rgba(0,0,0,0.5)",this.add(this.container),this},u.Modal.prototype=Object.create(u.Element.prototype),u.Modal.prototype.constructor=u.Modal,u.Modal.prototype.show=function(t){return this.container.clear(),this.container.add(t),this.dom.style.display="flex",this},u.Modal.prototype.hide=function(){return this.dom.style.display="none",this}}(),function(){var t;t=b8e.Object.extends({_inited:!1,_isShow:!1,_fpsStats:null,_watchStats:null,_ctrlItems:null,_isShowPanel:!1,_rootElem:null,_ctrlElem:null,_fpsStatsElem:null,_watchStatsElem:null,_showFPS:!1,_showWatch:!1,_showInfo:!1,_showCtrl:!1,_msgElem:null,_msgArea:null,_ctrlPanel:null,_openButton:null,_openFpsStatsCheck:null,_openWatchStatsCheck:null,_openCtrlPanelCheck:null,_areaChecks:null,_currInfoType:0,_x:0,_y:0,_detector:null,_isRemote:!1,ctor:function(){this._super(),this._ctrlItems=[],this._areaChecks=[],this._detector=new b8e.Detector},addWatch:function(t,e,i,s){this._detector.addWatch(t,e,i,s)},addCtrl:function(t,e,i,s){var n={label:t,value:e,handler:i,thisArg:s};this._ctrlItems.push(n),this._ctrlPanel&&this.addCtrlItem(n)},getCtrlItems:function(){return this._ctrlItems},_ctrlWidth:0,_ctrlHeight:0,_currPosX:0,_currPosY:0,_nextX:0,_nextY:0,setCtrlItems:function(t){this._currPosX=0,this._currPosY=0,this._nextX=0,this._nextY=0,this._ctrlWidth=0,this._ctrlHeight=0;for(var e=t.length,i=0;i<e;i++){var s=t[i];this.addCtrlItem(s)}},initCtrlItems:function(){this._isRemote||this.setCtrlItems(this._ctrlItems)},addCtrlItem:function(){},setPosition:function(t,e){this._x=t,this._y=e},updateCtrlState:function(){},updateIsRemote:function(){},isRemote:function(){return this._isRemote},setIsRemote:function(t){this._isRemote=t,this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel(),this.updateIsRemote(),this._detector.setUpdateType(this._isConnected?0:-1),t?this.setCtrlItems([]):this.setCtrlItems(this._ctrlItems),this.showFpsStats()},isShow:function(){return this._isShow},startWatch:function(){b8e.onBeforeUpdate=this.beforeUpdate.bind(this),b8e.onAfterUpdate=this.afterUpdate.bind(this),b8e.onBeforeRender=this.beforeDraw.bind(this),b8e.onAfterRender=this.afterDraw.bind(this)},stopWatch:function(){b8e.onBeforeUpdate=null,b8e.onAfterUpdate=null,b8e.onBeforeRender=null,b8e.onAfterRender=null;var t=b8e.NetMgr.getMgr("profiler");t&&t.closeConnection()},show:function(t,e){if(!this._isShow){this._isShow=!0,this._x=0|t,this._y=0|e,this._inited||(this._inited=!0,this.init()),this.onShow(),b8e.info("\u6e38\u620f\u540d\u79f0\uff1a"+b8e.startup.getTitle());var i=window.navigator.appName,s=window.navigator.appVersion,n=window.navigator.platform,o=window.location?window.location.href:"";for(var a in b8e.info("\u6d4f\u89c8\u5668\u540d\u79f0\uff1a"+i),b8e.info("\u6d4f\u89c8\u5668\u7248\u672c\uff1a"+s),b8e.info("\u64cd\u4f5c\u7cfb\u7edf\uff1a"+n),b8e.info("URL\uff1a"+o),b8e.isCocos190||(b8e.info("GL\u6269\u5c55\uff1a"+b8e.GLUtil.getGLExtensions()),b8e.info("\u7eb9\u7406\u652f\u6301\uff1a"+b8e.GLUtil.getTextureSupported())),b8e.info("========== params =========="),b8e.params)b8e.info(a+":"+b8e.params[a]);b8e.info("============================")}},hide:function(){this._isShow&&(this._isShow=!1,this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel(),this.onHide())},onShow:function(){},onHide:function(){},showPanel:function(){this._isShowPanel||(this.onShowPanel(),this.showFpsStats(),this._openButton&&this._openButton.setChecked&&this._openButton.setChecked(!0),this._isShowPanel=!0,this.startWatch())},hidePanel:function(){this._isShowPanel&&(this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel(),this.onHidePanel(),this._openButton&&this._openButton.setChecked&&this._openButton.setChecked(!1),this._isShowPanel=!1,this.stopWatch())},onHidePanel:function(){},onShowPanel:function(){},showFpsStats:function(){this._showFPS||(this._showFPS=!0,this._openFpsStatsCheck&&this._openFpsStatsCheck.setChecked(!0),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel(),this.onShowFpsStats(),this.updateCtrlState(0),this._detector.setUpdateType(this._isConnected?0:1))},hideFpsStats:function(){this._showFPS&&(this._showFPS=!1,this._openFpsStatsCheck&&this._openFpsStatsCheck.setChecked(!1),this.onHideFpsStats(),this.updateCtrlState(-1),this._detector.setUpdateType(this._isConnected?0:-1))},onShowFpsStats:function(){},onHideFpsStats:function(){},showWatchStats:function(){this._showWatch||(this._showWatch=!0,this._openWatchStatsCheck&&this._openWatchStatsCheck.setChecked(!0),this.hideFpsStats(),this.hideInfoArea(),this.hideCtrlPanel(),this.onShowWatchStats(),this.updateCtrlState(1),this._detector.setUpdateType(this._isConnected?0:2))},hideWatchStats:function(){this._showWatch&&(this._showWatch=!1,this._openWatchStatsCheck&&this._openWatchStatsCheck.setChecked(!1),this.onHideWatchStats(),this.updateCtrlState(-1),this._detector.setUpdateType(this._isConnected?0:-1))},onShowWatchStats:function(){},onHideWatchStats:function(){},showCtrlPanel:function(){this._showCtrl||(this._showCtrl=!0,this._openCtrlPanelCheck&&this._openCtrlPanelCheck.setChecked(!0),this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea(),this.onShowCtrlPanel(),this.updateCtrlState(7))},hideCtrlPanel:function(){this._showCtrl&&(this._showCtrl=!1,this._openCtrlPanelCheck&&this._openCtrlPanelCheck.setChecked(!1),this.onHideCtrlPanel(),this.updateCtrlState(-1))},onShowCtrlPanel:function(){this._ctrlPanel||this.initCtrlItems()},onHideCtrlPanel:function(){},hideInfoArea:function(){this._showInfo&&this.updateInfoArea()},updateInfoArea:function(t){var e,i=0<arguments.length&&void 0!==t?t:-1,s=this._areaChecks.length;for(e=0;e<s;e++){var n=this._areaChecks[e];e==i?n.setChecked(!0):n.setChecked(!1)}for(e=0;e<s;e++){if((n=this._areaChecks[e]).getChecked())return void this.showInfoArea(e)}this._showInfo=!1,this.onHideInfoArea()},onHideInfoArea:function(){this.updateCtrlState(-1)},init:function(){this._detector.init(),this.initView(),this._showOpenButton()},initView:function(){},_showOpenButton:function(){},getFpsData:function(t){return this._detector.getFpsData(t)},getStatsData:function(t){return this._detector.getStatsData(t)},beforeUpdate:function(){this._detector.beforeUpdate()},_frameCount:0,afterUpdate:function(){this._frameCount++;var t=this._detector;if(t.afterUpdate(),this._frameCount%10==0){this._isConnected&&this._onSend();if(this._showFPS&&this._fpsStats){if(!this._isRemote){var e=t.getFpsData();for(var i in e)this._fpsStats(i).value=e[i].value}this._fpsStats().tick()}if(this._showWatch&&this._watchStats){if(!this._isRemote){var s=t.getStatsData();for(var n in s)this._watchStats(n).value=s[n].value}this._watchStats().tick()}}},beforeDraw:function(){this._detector.beforeDraw()},afterDraw:function(){this._detector.afterDraw()},setFpsValues:function(t){if(this._showFPS&&this._fpsStats)for(var e in t)this._fpsStats(e).value=t[e].value},setWatchValues:function(t){if(this._showWatch&&this._watchStats)for(var e in t)this._watchStats(e).value=t[e].value},_onAddLog:null,onAddLog:function(t,e){this._onAddLog={callback:t,thisArg:e}},addLog:function(){this._onAddLog&&this._onAddLog.callback.call(this._onAddLog.thisArg),this._isRemote||this._showInfo&&0==this._currInfoType&&this.updateInfo(b8e.Logger.logMsg)},clearLog:function(){b8e.Logger.logMsg.length=0,this._showInfo&&0==this._currInfoType&&this.updateInfo(b8e.Logger.logMsg)},_onAddInfo:null,onAddInfo:function(t,e){this._onAddInfo={callback:t,thisArg:e}},addInfo:function(){this._onAddInfo&&this._onAddInfo.callback.call(this._onAddInfo.thisArg),this._isRemote||this._showInfo&&1==this._currInfoType&&this.updateInfo(b8e.Logger.infoMsg)},_onAddWarn:null,onAddWarn:function(t,e){this._onAddWarn={callback:t,thisArg:e}},addWarn:function(){this._onAddWarn&&this._onAddWarn.callback.call(this._onAddWarn.thisArg),this._isRemote||this._showInfo&&2==this._currInfoType&&this.updateInfo(b8e.Logger.warnMsg)},_onAddError:null,onAddError:function(t,e){this._onAddError={callback:t,thisArg:e}},addError:function(){this._onAddError&&this._onAddError.callback.call(this._onAddError.thisArg),this._isRemote||this._showInfo&&3==this._currInfoType&&this.updateInfo(b8e.Logger.errorMsg)},_onAddBenchmark:null,onAddBenchmark:function(t,e){this._onAddBenchmark={callback:t,thisArg:e}},addBenchmark:function(){var t=Array.prototype.slice.call(arguments).join(" ");this._onAddBenchmark&&this._onAddBenchmark.callback.call(this._onAddBenchmark.thisArg,t),this._isRemote||this._showInfo&&4==this._currInfoType&&this.updateInfo(b8e.Logger.benchmarkMsg)},updateInfo:function(t,e){},showInfoArea:function(t){this._currInfoType=t,this._showInfo=!0,this.hideFpsStats(),this.hideWatchStats(),this.hideCtrlPanel(),this.updateCtrlState(2+t)},connectServer:function(t){b8e.Toast.launch("\u6b63\u5728\u8fde\u63a5\u5206\u6790\u670d\u52a1\u5668...");var e=b8e.NetMgr.createMgr("profiler");e.initSocket(b8e.Socket.TYPE_JSON),e.connectServer("ws://"+t+":9090",0,this._onConnected,this._onClose,this._onError,this._onReceiveData,this)},_isConnected:!1,_onConnected:function(){if(!this._isConnected){b8e.Toast.launch("\u5206\u6790\u670d\u52a1\u5668\u8fde\u63a5\u6210\u529f"),this._isConnected=!0,this.setIsRemote(!1),this.updateIsRemote(),this._detector.setUpdateType(0);var i=b8e.NetMgr.getMgr("profiler");this.onAddLog(function(t){var e={type:2,msg:t};i.sendString(e)},this),this.onAddInfo(function(t){var e={type:3,msg:t};i.sendString(e)},this),this.onAddWarn(function(t){var e={type:4,msg:t};i.sendString(e)},this),this.onAddError(function(t){var e={type:5,msg:t};i.sendString(e)},this),this.onAddBenchmark(function(t){var e={type:6,msg:t};i.sendString(e)},this)}},_onSend:function(){var t=b8e.NetMgr.getMgr("profiler"),e={type:0,values:this.getFpsData()};t.sendString(e),e={type:1,values:this.getStatsData()},t.sendString(e)},_onClose:function(){this._isConnected&&(b8e.Toast.launch("\u5206\u6790\u670d\u52a1\u5668\u8fde\u63a5\u5173\u95ed"),this._isConnected=!1,this.updateIsRemote())},_onError:function(){this._isConnected&&(b8e.Toast.launch("\u5206\u6790\u670d\u52a1\u5668\u8fde\u63a5\u9519\u8bef"),this._isConnected=!1,this.updateIsRemote())},_onReceiveData:function(t){var e=t.type,i=t.data;switch(e){case"script":b8e.log("Script Return:"+Function(i)());break;case"capture_event":b8e.setCaptureEventEnabled(!!i)}}}),b8e.RC("$$b8e","$$BaseProfiler",t)}(),function(){var t,a=void 0;t=b8e.BaseProfiler.extends({_bodyElem:null,_fpsStatsDiv:null,_watchStatsDiv:null,_activateCheck:null,_useImgCheck:null,_cacheCheck:null,_guiCheck:null,_sceneCheck:null,_tickCheck:null,_tweenCheck:null,_fpsInput:null,_fpsButton:null,_gcButton:null,_closeButton:null,_resetButton:null,_widthInput:null,_heightInput:null,_resizeButton:null,ctor:function(){this._super()},onShow:function(){this._super(),this._bodyElem.add(this._rootElem)},onHide:function(){this._super(),this._bodyElem.remove(this._rootElem)},onHideFpsStats:function(){this._super(),this._fpsStatsDiv&&this._fpsStatsDiv.parentElement===this._fpsStatsElem.dom&&this._fpsStatsElem.dom.removeChild(this._fpsStatsDiv)},onShowFpsStats:function(){this._super(),null===this._fpsStatsDiv.parentElement&&this._fpsStatsElem.dom.appendChild(this._fpsStatsDiv)},onHideWatchStats:function(){this._watchStatsDiv&&this._watchStatsDiv.parentElement===this._watchStatsElem.dom&&this._watchStatsElem.dom.removeChild(this._watchStatsDiv)},onShowWatchStats:function(){null===this._watchStatsDiv.parentElement&&this._watchStatsElem.dom.appendChild(this._watchStatsDiv)},initView:function(){this._super(),this._bodyElem=new b8e.DebugUI.Element(document.body),this._rootElem=new b8e.DebugUI.Div,this._rootElem.setZIndex(1e3),this._fpsStatsElem=new b8e.DebugUI.Div,this._rootElem.add(this._fpsStatsElem),this._watchStatsElem=new b8e.DebugUI.Div,this._rootElem.add(this._watchStatsElem),this._ctrlElem=new b8e.DebugUI.Div,this._rootElem.setPosition("absolute"),this._rootElem.setLeft("0px"),this._rootElem.setBottom("0px"),this._fpsStatsDiv=document.createElement("div"),this._fpsStatsDiv.id="fps_stats_div";var t=new b8e.Stats;this._fpsStats=t.init(this._fpsStatsDiv,{showGraph:!0,values:this._capabilityWatchs,fractions:[],extensions:["memory"],css:".stats {left: "+b8e.macro.PROFILER_POSITION.x+"px; bottom: "+b8e.macro.PROFILER_POSITION.y+"px;}"}),this._watchStatsDiv=document.createElement("div"),this._watchStatsDiv.id="watch_stats_div";var e=new b8e.Stats;this._watchStats=e.init(this._watchStatsDiv,{showGraph:!0,values:this._statsWatchs,fractions:[],css:".stats {left: "+b8e.macro.PROFILER_POSITION.x+"px; bottom: "+b8e.macro.PROFILER_POSITION.y+"px;}"});var i=this,s=b8e.macro.PROFILER_POSITION.x,n=b8e.macro.PROFILER_POSITION.y;s+=40,this._openFpsStatsCheck=new a(this._ctrlElem,s,n,"\u6027\u80fd",function(t){t?i.showFpsStats():i.hideFpsStats()}),s+=30,this._openWatchStatsCheck=new a(this._ctrlElem,s,n,"\u72b6\u6001",function(t){t?i.showWatchStats():i.hideWatchStats()}),s+=30,o=new a(this._ctrlElem,s,n,"\u65e5\u5fd7",function(t){t?i.updateInfoArea(0):i.updateInfoArea()},"#AAA"),this._areaChecks.push(o),s+=30;var o=new a(this._ctrlElem,s,n,"\u4fe1\u606f",function(t){t?i.updateInfoArea(1):i.updateInfoArea()},"#00FF00");this._areaChecks.push(o),s+=30,o=new a(this._ctrlElem,s,n,"\u8b66\u544a",function(t){t?i.updateInfoArea(2):i.updateInfoArea()},"#FFFF00"),this._areaChecks.push(o),s+=30,o=new a(this._ctrlElem,s,n,"\u9519\u8bef",function(t){t?i.updateInfoArea(3):i.updateInfoArea()},"#FF0000"),this._areaChecks.push(o),s+=30,o=new a(this._ctrlElem,s,n,"\u8d44\u6e90",function(t){t?i.updateInfoArea(4):i.updateInfoArea()},"#AAA"),this._areaChecks.push(o),s+=30,this._openCtrlPanelCheck=new a(this._ctrlElem,s,n,"\u63a7\u5236",function(t){t?i.showCtrlPanel():i.hideCtrlPanel()}),s=b8e.macro.PROFILER_POSITION.x,n=b8e.macro.PROFILER_POSITION.y,n-=65,this._gcButton=new b8e.DebugUI.Button("G"),this._ctrlElem.add(this._gcButton),this._gcButton.setPosition("absolute"),this._gcButton.setWidth("28px"),this._gcButton.setLeft(s+"px"),this._gcButton.setBottom(n+"px"),this._gcButton.addEventListener("click",function(t){b8e.res.purge(!0),b8e.Toast.launch("\u6267\u884cGC\uff01")}),s+=35,this._closeButton=new b8e.DebugUI.Button("C"),this._ctrlElem.add(this._closeButton),this._closeButton.setPosition("absolute"),this._closeButton.setWidth("28px"),this._closeButton.setLeft(s+"px"),this._closeButton.setBottom(n+"px"),this._closeButton.addEventListener("click",function(t){b8e.net.closeConnection()}),s+=35,this._resetButton=new b8e.DebugUI.Button("RS"),this._ctrlElem.add(this._resetButton),this._resetButton.setPosition("absolute"),this._resetButton.setWidth("28px"),this._resetButton.setLeft(s+"px"),this._resetButton.setBottom(n+"px"),this._resetButton.addEventListener("click",function(t){b8e.ticker.debugReset(),b8e.net.debugReset()}),s=b8e.macro.PROFILER_POSITION.x,n=b8e.macro.PROFILER_POSITION.y,n-=95,this._widthInput=new b8e.DebugUI.Input(""),this._ctrlElem.add(this._widthInput),this._widthInput.setPosition("absolute"),this._widthInput.setWidth("28px"),this._widthInput.setLeft(s+"px"),this._widthInput.setBottom(n+"px"),s+=35,this._heightInput=new b8e.DebugUI.Input(""),this._ctrlElem.add(this._heightInput),this._heightInput.setPosition("absolute"),this._heightInput.setWidth("28px"),this._heightInput.setLeft(s+"px"),this._heightInput.setBottom(n+"px"),s+=35,this._resizeButton=new b8e.DebugUI.Button("R"),this._ctrlElem.add(this._resizeButton),this._resizeButton.setPosition("absolute"),this._resizeButton.setWidth("28px"),this._resizeButton.setLeft(s+"px"),this._resizeButton.setBottom(n+"px"),this._resizeButton.addEventListener("click",function(t){b8e.SceneMgr.inst().setEmulatedScreenSize({width:parseInt(i._widthInput.getValue()),height:parseInt(i._heightInput.getValue())})}),s+=35,this._fpsInput=new b8e.DebugUI.Input(""),this._ctrlElem.add(this._fpsInput),this._fpsInput.setPosition("absolute"),this._fpsInput.setWidth("28px"),this._fpsInput.setLeft(s+"px"),this._fpsInput.setBottom(n+"px"),s+=35,this._fpsButton=new b8e.DebugUI.Button("F"),this._ctrlElem.add(this._fpsButton),this._fpsButton.setPosition("absolute"),this._fpsButton.setWidth("28px"),this._fpsButton.setLeft(s+"px"),this._fpsButton.setBottom(n+"px"),this._fpsButton.addEventListener("click",function(t){b8e.startup.setFrameRate(parseInt(i._fpsInput.getValue()))}),s=b8e.macro.PROFILER_POSITION.x,n=b8e.macro.PROFILER_POSITION.y,n-=95,this._activateCheck=new a(this._ctrlElem,s,n,"ACT",function(t){t?b8e.startup.activate():b8e.startup.deactivate()}),cc.game.on(cc.game.EVENT_SHOW,function(){i._activateCheck.setChecked(!0)}),cc.game.on(cc.game.EVENT_HIDE,function(){i._activateCheck.setChecked(!1)}),this._activateCheck.setChecked(b8e.isActivated),s+=30,this._cacheCheck=new a(this._ctrlElem,s,n,"\u7f13\u5b58",function(t){t?b8e.res.setUseCache(!0):b8e.res.setUseCache(!1)}),this._cacheCheck.setChecked(!0),s+=30,this._useImgCheck=new a(this._ctrlElem,s,n,"IMG",function(t){b8e.ResMgr.ALLOW_SET_DEFAULT_FORMAT?b8e.ResMgr.DEFAULT_FORMAT=t?"img":"png":(i._useImgCheck.setChecked("img"==b8e.ResMgr.DEFAULT_FORMAT),b8e.Toast.launch("\u5728\u52a8\u753b\u52a0\u8f7d\u524d\u624d\u5141\u8bb8\u5207\u6362\u683c\u5f0f\uff01"))}),this._useImgCheck.setChecked("img"==b8e.ResMgr.DEFAULT_FORMAT),s+=30,this._guiCheck=new a(this._ctrlElem,s,n,"GUI",function(t){t?b8e.layer.getGuiLayer().setVisible(!0):b8e.layer.getGuiLayer().setVisible(!1)}),this._guiCheck.setChecked(!0),s+=30,this._sceneCheck=new a(this._ctrlElem,s,n,"\u573a\u666f",function(t){t?b8e.layer.getSceneLayer().setVisible(!0):b8e.layer.getSceneLayer().setVisible(!1)}),this._sceneCheck.setChecked(!0),s+=30,this._tickCheck=new a(this._ctrlElem,s,n,"TIC",function(t){t?b8e.ticker.setPaused(!1):b8e.ticker.setPaused(!0)}),this._tickCheck.setChecked(!0),s+=30,this._tweenCheck=new a(this._ctrlElem,s,n,"TWE",function(t){b8e.Tween.tickPaused=!t}),this._tweenCheck.setChecked(!0)},_showOpenButton:function(){var e=this,t=b8e.macro.PROFILER_POSITION.x,i=b8e.macro.PROFILER_POSITION.y;this._openButton=new b8e.DebugUI.Button("P"),this._rootElem.add(this._openButton),this._openButton.setPosition("absolute"),this._openButton.setWidth("28px"),this._openButton.setLeft(t+"px"),this._openButton.setBottom(Number(i-35)+"px"),this._openButton.addEventListener("click",function(t){e._isShowPanel?e.hidePanel():e.showPanel()})},onHidePanel:function(){this._rootElem.remove(self._ctrlElem)},onShowPanel:function(){this._rootElem.add(self._ctrlElem)},onShowCtrlPanel:function(){if(this._super(),!this._ctrlPanel){var t=this._testItems.length;this._ctrlPanel=new b8e.DebugUI.Div,this._ctrlPanel.setWidth("300px"),0<t?this._ctrlPanel.setHeight(30*((t-1)/3>>0)+38+"px"):this._ctrlPanel.setHeight("0px"),this._ctrlPanel.setPosition("absolute"),this._ctrlPanel.setLeft(b8e.macro.PROFILER_POSITION.x+"px"),this._ctrlPanel.setBottom(b8e.macro.PROFILER_POSITION.y+"px"),this._ctrlPanel.setBackgroundColor("rgba(0,0,0,0.2)"),this._ctrlPanel.setBorder("1px solid #444");for(var e=0,i=0,s=0;s<t;s++){e=s%3*100+8,i=30*(s/3>>0)+8;var n=this._testItems[s],o=n.label,a=new b8e.DebugUI.Input("");this._ctrlPanel.add(a),(n.input=a).setPosition("absolute"),a.setWidth("36px"),a.setLeft(e+"px"),a.setBottom(i+"px"),e+=40;var r=new b8e.DebugUI.Button(o);this._ctrlPanel.add(r),r.dom._item=n,r.setPosition("absolute"),r.setWidth("46px"),r.setHeight("22px"),r.setLeft(e+"px"),r.setBottom(i+"px"),r.addEventListener("click",function(t){var e=this._item,i=e.input,s=e.handler,n=e.thisArg;s?s.call(n,i.getValue()):b8e.Toast.launch("\u53ef\u4ee5\u4f7f\u7528engine.profiler.addTestItem\u6dfb\u52a0\u6d4b\u8bd5\u5904\u7406\u9879\uff01(\u8f93\u5165\u503c\uff1a"+i.getValue()+")")})}}this._rootElem.add(this._ctrlPanel)},onHideCtrlPanel:function(){this._super(),this._ctrlPanel&&this._rootElem.remove(this._ctrlPanel)},onHideInfoArea:function(){this._msgElem&&(this._msgArea.setValue(""),this._rootElem.remove(this._msgElem))},showInfoArea:function(t){this._super(t),this._msgElem||(this._msgElem=new b8e.DebugUI.Div),this._msgArea||(this._msgArea=new b8e.DebugUI.TextArea,this._msgArea.setReadOnly(!0),this._msgArea.setPosition("absolute"),this._msgArea.setResize("none"),this._msgArea.setBackground("#444"),this._msgArea.setWidth("300px"),this._msgArea.setHeight("300px"),this._msgArea.setLeft(b8e.macro.PROFILER_POSITION.x+"px"),this._msgArea.setBottom(b8e.macro.PROFILER_POSITION.y+"px"),this._msgElem.add(this._msgArea)),this._rootElem.add(this._msgElem),0==t?(this._msgArea.setColor("#AAA"),this.updateInfo(b8e.Logger.logMsg)):1==t?(this._msgArea.setColor("#00FF00"),this.updateInfo(b8e.Logger.infoMsg)):2==t?(this._msgArea.setColor("#FFFF00"),this.updateInfo(b8e.Logger.warnMsg)):3==t?(this._msgArea.setColor("#FF0000"),this.updateInfo(b8e.Logger.errorMsg)):4==t&&(this._msgArea.setColor("#AAA"),this.updateInfo(this._resMsg))},updateInfo:function(t,e){var i=1<arguments.length&&void 0!==e?e:0,s=t.join("\n");0<i&&s.length>i&&(s=s.substr(0,i)),this._msgArea.setValue(s)}});a=b8e.Object.extends({_label:null,_check:null,ctor:function(t,e,i,s,n,o){var a=5<arguments.length&&void 0!==o?o:"#AAA";this._super(),this._label=new b8e.DebugUI.Text(s),this._label.setColor(a),t.add(this._label),this._label.setPosition("absolute"),this._label.setLeft(e+"px"),this._label.setBottom(Number(i-20)+"px"),this._check=new b8e.DebugUI.Checkbox(!1),t.add(this._check),this._check.setPosition("absolute"),this._check.setLeft(e+"px"),this._check.setBottom(Number(i-40)+"px");var r=this;this._check.addEventListener("change",function(t){n(r._check.getValue())})},setChecked:function(t){this._check.setValue(t)},getChecked:function(){return this._check.getValue()}}),b8e.RC("$$b8e","$$DomProfiler",t),b8e.RC("$$b8e","$$ProfilerCheckbox",a)}(),function(){var t;t=b8e.BaseDisplay.extends({_itemByKey:null,ctor:function(){this._super(),this._itemByKey={}},init:function(t){var e=0,i=this.bg=bui.Graphics.get();this.addChild(i);var s=0;for(var n in t)s+=35;for(var n in this.setSize(this.width,s),i.setSize(this.width,s),i.lineWidth(2),i.strokeColor(4282664004),t){var o=t[n],a=new l(o,this.width-10,30);this.addChild(a);var r=e-a.height;a.setPosition(5,r),i.moveTo(5,r-2),i.lineTo(this.width-5,r-2),e-=a.height+5,this._itemByKey[n]=a}i.stroke();var h=this;return function(t){return t?h.item(t):h}},item:function(t){return this._itemByKey[t]},tick:function(){}});var l=b8e.BaseDisplay.extends({_opts:null,_below:void 0,_over:void 0,_vl:null,_isWarn:!1,_warnNum:0,_lineHeight:0,ctor:function(t,e,i){var s=2<arguments.length&&void 0!==i?i:30;this._super(),this._lineHeight=s,this.setSize(e,this._lineHeight),this._opts=t,this._below=t.below,this._over=t.over;var n=t.desc,o=this.bg=bui.Graphics.get();this.addChild(o),o.setSize(e,this._lineHeight);var a=bui.Label.get();a.fontAtlasName="profiler",a.setFontSize(28),a.setLineHeight(30),a.setColor(4289374890),a.setSize(e,this._lineHeight),a.horizontalAlign=b8e.HorizontalAlign.LEFT,a.setText(n),this.addChild(a);var r=bui.Label.get();r.fontAtlasName="profiler",r.setFontSize(28),r.setLineHeight(30),r.setColor(4289374890),r.setSize(e,this._lineHeight),r.setOverflow(b8e.OverflowType.CLAMP),r.horizontalAlign=b8e.HorizontalAlign.RIGHT,this.addChild(r),this._vl=r,this.value="n/a",this.setSize(e,this._lineHeight)},value:{set:function(t){this._vl.setText(t);var e=parseFloat(t);(void 0!==this._below&&e<this._below||void 0!==this._over&&e>this._over)&&this.warn(),this._isWarn&&(this._warnNum++,4<this._warnNum&&this.normal())}},warn:function(){if(this._warnNum=0,!this._isWarn){this._isWarn=!0;var t=this.bg;t.clear(),t.fillColor(2298413056),t.fillRect(0,0,t.width,t.height)}},normal:function(){this._isWarn&&(this._isWarn=!1,this._warnNum=0,this.bg.clear())}});b8e.RC("$$b8e","$$CanvasStats",t)}();var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){var t,i=t=b8e.BaseProfiler.extends({root:null,_minConW:0,_minConH:0,_typeText:null,_ctrlText:null,_ctrlContainer:null,_maxConW:600,_maxConH:350,ctor:function(){this._super()},initView:function(){this._super(),this.root=b8e.BaseDisplay.get(),b8e.root.addChild(this.root),this.root.setLocalZOrder(3e4),this._rootElem=b8e.BaseDisplay.get();var t=bui.Graphics.get();t.setSize(this._maxConW,this._maxConH),t.fillColor(4280427042),t.strokeColor(4289374890),t.lineWidth(2),t.fillRoundRect(0,0,t.width,t.height,10,10),t.moveTo(0,t.height-36-8),t.lineTo(t.width,t.height-36-8),t.stroke();var e=this._ctrlElem=b8e.BaseDisplay.get();e.addChild(t),e.setPosition(5,46),e.setSize(this._maxConW,this._maxConH);var i=bui.Label.get();i.fontAtlasName="profiler",i.setPosition(5,e.height-36),e.addChild(i),i.setColor(4289374890),i.setFontSize(28),i.setLineHeight(30),i.setSize(t.width,30),i.setOverflow(b8e.OverflowType.CLAMP),i.horizontalAlign=b8e.HorizontalAlign.CENTER,i.setText("Black8 Game Engine Profiler"),(i=bui.Label.get()).fontAtlasName="profiler",(this._typeText=i).setPosition(5,e.height-36),e.addChild(i),i.setColor(11184810),i.setFontSize(28),i.setLineHeight(30),i.setSize(t.width-10,30),i.horizontalAlign=b8e.HorizontalAlign.LEFT,i.setText(""),(i=bui.Label.get()).fontAtlasName="profiler",(this._ctrlText=i).setPosition(5,e.height-36),e.addChild(i),i.setColor(11184810),i.setFontSize(28),i.setLineHeight(30),i.setSize(t.width-10,30),i.setOverflow(b8e.OverflowType.CLAMP),i.horizontalAlign=b8e.HorizontalAlign.RIGHT,i.setText("");var s=new b8e.CanvasStats;s.setSize(this._maxConW,this._maxConH-36-8);var n=this._fpsStatsElem=bui.ScrollView.get();n.setSize(s.width,s.height),this._fpsStats=s.init(this._detector._capabilityWatchs),n.setContent(s),n.bounces=!1,(s=new b8e.CanvasStats).setSize(this._maxConW,this._maxConH-36-8);var o=this._watchStatsElem=bui.ScrollView.get();o.setSize(s.width,s.height),this._watchStats=s.init(this._detector._statsWatchs),o.setContent(s),o.bounces=!1;var a=35,r=this._openFpsStatsCheck=new b8e.SimpleToggleButton("\u6027\u80fd",this.onClickFpsStats,this);r.setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,a+=r.width+5,(r=this._openWatchStatsCheck=new b8e.SimpleToggleButton("\u72b6\u6001",this.onClickWatchStats,this)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,a+=r.width+5,(r=new b8e.SimpleToggleButton("\u65e5\u5fd7",function(t){t.isChecked?this.updateInfoArea(0):this.updateInfoArea()},this)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,this._areaChecks.push(r),a+=r.width+5,(r=new b8e.SimpleToggleButton("\u4fe1\u606f",function(t){t.isChecked?this.updateInfoArea(1):this.updateInfoArea()},this,28,65280)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,this._areaChecks.push(r),a+=r.width+5,(r=new b8e.SimpleToggleButton("\u8b66\u544a",function(t){t.isChecked?this.updateInfoArea(2):this.updateInfoArea()},this,28,16776960)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,this._areaChecks.push(r),a+=r.width+5,(r=new b8e.SimpleToggleButton("\u9519\u8bef",function(t){t.isChecked?this.updateInfoArea(3):this.updateInfoArea()},this,28,16711680)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,this._areaChecks.push(r),a+=r.width+5,(r=new b8e.SimpleToggleButton("\u68c0\u6d4b",function(t){t.isChecked?this.updateInfoArea(4):this.updateInfoArea()},this)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,this._areaChecks.push(r),a+=r.width+5,(r=this._openCtrlPanelCheck=new b8e.SimpleToggleButton("\u63a7\u5236",function(t){t.isChecked?this.showCtrlPanel():this.hideCtrlPanel()},this)).setLocalZOrder(3e4),this._ctrlElem.addChild(r),r.x=a,r.y=-5-r.height,this.updateIsRemote()},setPosition:function(t,e){this._super(t,e),this.root&&this.root.setPosition(this._x,this._y)},onShow:function(){this._super(),this.root.addChild(this._rootElem)},onHide:function(){this._super(),this.root.removeChild(this._rootElem)},_showOpenButton:function(){this._super();var t=this._openButton=new b8e.SimpleToggleButton("P",this.onClickProfiler,this,28);t.setLocalZOrder(3e4),this._rootElem.addChild(t),this._minConW=10+t.width,this._minConH=10+t.height,this.root.setSize(this._minConW,this._minConH),t.setPosition(5,5)},onShowFpsStats:function(){this._super(),this._ctrlElem.addChild(this._fpsStatsElem)},onHideFpsStats:function(){this._super(),this._ctrlElem.removeChild(this._fpsStatsElem)},onShowWatchStats:function(){this._super(),this._ctrlElem.addChild(this._watchStatsElem)},onHideWatchStats:function(){this._super(),this._ctrlElem.removeChild(this._watchStatsElem)},initCtrlItems:function(){var t=b8e.BaseDisplay.get();this._ctrlContainer=t,this._ctrlPanel=bui.ScrollView.get(),this._ctrlPanel.setPosition(5,5),this._ctrlPanel.setSize(this._maxConW-10,this._maxConH-50),this._ctrlPanel.setContent(t),this._ctrlPanel.bounces=!1,this._super()},onShowCtrlPanel:function(){this._super(),this._ctrlElem.addChild(this._ctrlPanel)},addCtrlItem:function(t){var e=this._ctrlContainer,i=new n(t);e.addChild(i),this._currPosX=this._nextX+10,this._currPosX+i.width>this._ctrlPanel.width&&(this._currPosX=this._currPosX=0,this._currPosY=this._nextY),i.x=this._currPosX,this._nextX=this._currPosX+i.width;var s=this._currPosY-i.height;s-10<this._nextY&&(this._nextY=s-10),i.y=s,this._nextX>this._ctrlWidth&&(this._ctrlWidth=this._nextX),-this._nextY>this._ctrlHeight&&(this._ctrlHeight=-this._nextY),e.setSize(this._ctrlWidth,this._ctrlHeight)},setCtrlItems:function(t){this._ctrlPanel&&(this._ctrlContainer.removeAllChildren(),this._super(t))},onHideCtrlPanel:function(){this._super(),this._ctrlElem.removeChild(this._ctrlPanel)},onClickProfiler:function(){this._isShowPanel?this.hidePanel():this.showPanel()},updateCtrlState:function(t){if(this._super(t),this._ctrlText){var e=i.stateTexts[t]||"";this._ctrlText.setText(e)}},updateIsRemote:function(){var t,e;this._super(),this._typeText&&(e=this._isRemote||this._isConnected?(t="(remote)",16776960):(t="(local)",11184810),this._typeText.setColor(e),this._typeText.setText(t))},onHidePanel:function(){this._super(),this._rootElem.removeChild(this._ctrlElem),this.root.setSize(this._minConW,this._minConH)},onShowPanel:function(){this._super(),this.root.setSize(this._maxConW+10,this._maxConH+40),this._rootElem.addChild(this._ctrlElem)},onClickFpsStats:function(){this._openFpsStatsCheck.isChecked?this.showFpsStats():this.hideFpsStats()},onClickWatchStats:function(){this._openWatchStatsCheck.isChecked?this.showWatchStats():this.hideWatchStats()},onHideInfoArea:function(){this._super(),this._msgArea.setText(""),this._msgElem.scrollTop=0,this._ctrlElem.removeChild(this._msgElem)},showInfoArea:function(t){this._super(t);var e=!1;if(this._currInfoType!=t&&(e=!0),this._super(t),!this._msgArea){var i=this._msgArea=bui.Label.get();i.fontAtlasName="profiler",i.isMultiline(!0),i.setColor(4289374890),i.setFontSize(28),i.setSize(this._maxConW-10,0),this._msgElem=bui.ScrollView.get(),this._msgElem.setContent(i),this._msgElem.setPosition(5,5),this._msgElem.setSize(this._maxConW-10,this._maxConH-50),this._msgElem.bounces=!1}this._ctrlElem.addChild(this._msgElem),0==t?(this._msgArea.setColor(4289374890),this.updateInfo(b8e.Logger.logMsg,0,e)):1==t?(this._msgArea.setColor(4278255360),this.updateInfo(b8e.Logger.infoMsg,0,e)):2==t?(this._msgArea.setColor(4294967040),this.updateInfo(b8e.Logger.warnMsg,0,e)):3==t?(this._msgArea.setColor(4294901760),this.updateInfo(b8e.Logger.errorMsg,0,e)):4==t&&(this._msgArea.setColor(4289374890),this.updateInfo(b8e.Logger.benchmarkMsg,0,e))},updateInfo:function(t,e,i){var s=1<arguments.length&&void 0!==e?e:0,n=2<arguments.length&&void 0!==i&&i,o=t.join("\n");0<s&&o.length>s&&(o=o.substr(0,s)),this._msgArea&&(this._msgArea.setText(o),n&&(this._msgElem.scrollTop=0))}}),n=b8e.BaseDisplay.extends({_toggleBtn:null,ctor:function(t){this._super(),this.displaySniffEnable=!1;var i=t.label,s=t.value,n=t.handler,o=t.thisArg,e=0,a=0,r=void 0,h=void 0;if(null==s)r=new b8e.SimpleButton(i,function(){if(n)try{n.call(o)}catch(t){b8e.error("\u5206\u6790\u5668"+i+"\u63a7\u5236\u9519\u8bef\uff1a"+t.stack)}},this),this.addChild(r),e=r.width,a=r.height;else{var l=void 0===s?"undefined":f(s);switch(l){case"string":r=new b8e.SimpleButton(i,function(){if(n)try{n.call(o,h.getText())}catch(t){b8e.error("\u5206\u6790\u5668"+i+"\u63a7\u5236\u9519\u8bef\uff1a"+t.stack)}},this),(h=bui.EditBox.get()).setText(s),h.setColor(4289374890),h.setFontSize(28),h.setSize(100,r.height);var c=bui.Graphics.get();this.addChild(c),c.setSize(100,r.height),c.fillColor(4280427042),c.lineWidth(2),c.strokeColor(4289374890),c.fillRect(0,0,c.width,c.height),this.addChild(h),this.addChild(r),r.x=h.width+4,e=r.x+r.width,a=r.height;break;case"boolean":var u=new b8e.SimpleToggleButton(i,function(t){if(n)try{n.call(o,t.isChecked)}catch(t){b8e.error("\u5206\u6790\u5668"+i+"\u63a7\u5236\u9519\u8bef\uff1a"+t.stack)}},this);u.setChecked(s),this.addChild(u),e=u.width,a=u.height;break;case"object":var d={};r=new b8e.SimpleButton(i,function(){if(n){var t=[];for(var e in s)t.push(d[e].getText());try{n.apply(o,t)}catch(t){b8e.error("\u5206\u6790\u5668"+i+"\u63a7\u5236\u9519\u8bef\uff1a"+t.stack)}}},this);var _=0;for(var p in s){(h=bui.Label.get()).setText(p),h.setColor(4289374890),h.setFontSize(28),h.setPosition(_,0),this.addChild(h),_+=h.width+2,(h=bui.EditBox.get()).setText(s[p]),h.setColor(4289374890),h.setFontSize(28),h.setPosition(_,0),h.setSize(100,r.height);var m=bui.Graphics.get();this.addChild(m),m.setSize(100,r.height),m.fillColor(4280427042),m.lineWidth(2),m.strokeColor(4289374890),m.fillRect(0,0,m.width,m.height),m.setPosition(_,0),this.addChild(h),_+=(d[p]=h).width+4}this.addChild(r),r.x=_,e=r.x+r.width,a=r.height;break;default:b8e.warn("\u672a\u77e5\u7684\u63a7\u5236\u7c7b\u578b\uff1a"+l+"\uff01")}}this.setSize(e,a)},setChecked:function(t){this._toggleBtn&&this._toggleBtn.setChecked(t)}});i.stateTexts=["\u6027\u80fd","\u72b6\u6001","\u65e5\u5fd7","\u4fe1\u606f","\u8b66\u544a","\u9519\u8bef","\u68c0\u6d4b","\u63a7\u5236"],b8e.RC("$$b8e","$$CanvasProfiler",t)})(),function(){var t=b8e.EngineProfiler=function(){};b8e.EngineProfiler.init=function(){if(!b8e.profiler){var e=b8e.profiler=new b8e.CanvasProfiler;e.addCtrl("\u5f3a\u5236\u56de\u6536",null,function(){b8e.res.purge(!0),b8e.Toast.launch("\u6267\u884cGC\uff01")}),e.addCtrl("\u5173\u95ed\u94fe\u63a5",null,function(){b8e.net.closeConnection()}),e.addCtrl("\u91cd\u7f6e\u5206\u6790",null,function(){b8e.ticker.debugReset(),b8e.net.debugReset()}),e.addCtrl("\u5206\u8fa8\u7387",{width:0,height:0},function(t,e){b8e.SceneMgr.inst().setEmulatedScreenSize({width:parseInt(t),height:parseInt(e)})}),e.addCtrl("\u5e27\u7387","30",function(t){b8e.startup.setFrameRate(parseInt(t))}),e.addCtrl("\u6fc0\u6d3b",b8e.isActivated,function(t){t?b8e.startup.activate():b8e.startup.deactivate()}),e.addCtrl("\u7f13\u5b58",!0,function(t){t?b8e.res.setUseCache(!0):b8e.res.setUseCache(!1)}),e.addCtrl("IMG","img"==b8e.ResMgr.DEFAULT_FORMAT,function(t){b8e.ResMgr.ALLOW_SET_DEFAULT_FORMAT?b8e.ResMgr.DEFAULT_FORMAT=t?"img":"png":(this.setChecked("img"==b8e.ResMgr.DEFAULT_FORMAT),b8e.Toast.launch("\u5728\u52a8\u753b\u52a0\u8f7d\u524d\u624d\u5141\u8bb8\u5207\u6362\u683c\u5f0f\uff01"))}),e.addCtrl("GUI",!0,function(t){t?b8e.layer.getGuiLayer().setVisible(!0):b8e.layer.getGuiLayer().setVisible(!1)}),e.addCtrl("\u573a\u666f",!0,function(t){t?b8e.layer.getSceneLayer().setVisible(!0):b8e.layer.getSceneLayer().setVisible(!1)}),e.addCtrl("Ticker",!0,function(t){t?b8e.ticker.setPaused(!1):b8e.ticker.setPaused(!0)}),e.addCtrl("Step",null,function(t){b8e.ticker.step()}),e.addCtrl("Tween",!0,function(t){b8e.Tween.tickPaused=!t}),e.addCtrl("\u6e32\u67d3",!0,function(t){b8e.renderable=!!t}),e.addCtrl("\u963b\u6b62\u52a8\u753b\u52a0\u8f7d",!1,function(t){b8e.ResMgr.setForbidRes("b8e.AnimatorResource",t)}),e.addCtrl("\u963b\u6b62\u7cbe\u7075\u52a0\u8f7d",!1,function(t){b8e.ResMgr.setForbidRes("b8e.SpriteFrame",t),b8e.ResMgr.setForbidRes("b8e.FrameAtlas",t)}),e.addCtrl("\u65b9\u6cd5\u6d88\u8017\u4fe1\u606f",null,function(t){e.clearLog(),b8e.log(b8e.ClassMgr.dumpInfo())}),e.addCtrl("\u8c03\u8bd5\u5b9e\u4f8b\u5316",!1,function(t){b8e.ClassMgr.isInstDebug=t}),e.addCtrl("\u8d34\u56fe\u8c03\u8bd5",!1,function(t){b8e.Texture2DAsset.isDebug(t)}),e.addCtrl("\u663e\u793a\u55c5\u63a2",!1,function(t){b8e.stage.displaySniff(t)}),e.addCtrl("\u663e\u793a\u8c03\u8bd5",!1,function(t){b8e.stage.displayDebug(t)}),e.addCtrl("\u542f\u7528\u5b89\u5353\u8bbe\u5907\u8d34\u56fe",b8e.Texture2DAsset.ENABLE_FORMAT_ASTC,function(t){b8e.Texture2DAsset.ENABLE_FORMAT_ASTC=t}),e.addCtrl("\u542f\u7528\u82f9\u679c\u8bbe\u5907\u8d34\u56fe",b8e.Texture2DAsset.ENABLE_FORMAT_PVR,function(t){b8e.Texture2DAsset.ENABLE_FORMAT_PVR=t}),e.addCtrl("\u542f\u7528\u8d34\u56fe\u89e3\u538b",b8e.Texture2DAsset.ENABLE_UNZIP,function(t){b8e.Texture2DAsset.ENABLE_UNZIP=t}),e.addCtrl("\u542f\u7528\u5f02\u6b65\u89e3\u538b",b8e.ResMgr.ASYNC_UNZIP,function(t){b8e.ResMgr.ASYNC_UNZIP=t}),e.addCtrl("\u6587\u5b57\u56fe\u96c6\u4fe1\u606f",null,function(t){e.clearLog(),b8e.log(b8e.letterAssembler.dumpInfo())}),e.addCtrl("\u8d34\u56fe\u4fe1\u606f",null,function(t){e.clearLog(),b8e.log(b8e.TextureCache.dumpInfo())}),e.addCtrl("\u8d44\u6e90\u8c03\u8bd5",!1,function(t){b8e.ResMgr.IS_DEBUG=t}),e.addCtrl("\u8d44\u6e90\u4fe1\u606f",null,function(t){e.clearLog(),b8e.log(b8e.res.dumpInfo())}),e.addCtrl("\u5f02\u5e38\u63d0\u793a",b8e.Logger.ERROR_CAUTION,function(t){b8e.Toast.launch(t?"\u5f00\u542f\u5f02\u5e38\u63d0\u793a\uff01":"\u5173\u95ed\u5f02\u5e38\u63d0\u793a\uff01"),b8e.Logger.ERROR_CAUTION=b8e.Logger.WARN_CAUTION=t}),e.addCtrl("\u914d\u7f6e\u4fe1\u606f",null,function(t){e.clearLog(),b8e.log(b8e.ConfigData.dumpInfo())}),e.addCtrl("\u8fdc\u7a0b\u5206\u6790","127.0.0.1",function(t){e.connectServer(t)}),e.addCtrl("vConsole",null,function(t){if("undefined"==typeof VConsole){b8e.res.loadScript("module/vconsole.bgp",function(){window.vConsole=new VConsole},this)}},t),e.addCtrl("\u4fe1\u606f\u672c\u5730\u5316",null,function(t){if(b8e.localization)b8e.Toast.launch("\u4fe1\u606f\u5df2\u7ecf\u672c\u5730\u5316\uff01");else{b8e.res.loadScript("module/localization.bgp",function(){b8e.Toast.launch("\u4fe1\u606f\u672c\u5730\u5316\u6210\u529f\uff01")},this)}})}},b8e.createPerf=function(){return new b8e.Benchmark.Suite},b8e.addPerf=function(t,e,i,s){return e.add(t,i,s)},b8e.runPerf=function(t){t.on("cycle",function(t){b8e.log("Perf:"+String(t.target))}).on("start",function(t){b8e.log("Perf:Start Perf")}).on("reset",function(t){b8e.log("Perf:Reset Perf")}).on("abort",function(t){b8e.warn("Perf:"+String(t.target))}).on("error",function(t){b8e.error("Perf:"+String(t.target))}).on("complete",function(){b8e.log("Perf:Fastest is "+this.filter("fastest").map("name"))}).run({async:!0})};var o=[];b8e.captureEventEnabled=!1,b8e.setCaptureEventEnabled=function(t){var e=b8e.NetMgr.getMgr("profiler");if(e&&e._socket.connected){if(b8e.captureEventEnabled!=t){if(t?b8e.Toast.launch("\u5f00\u59cb\u64cd\u4f5c\u91c7\u96c6"):b8e.Toast.launch("\u5173\u95ed\u64cd\u4f5c\u91c7\u96c6"),b8e.captureEventEnabled=t,0<o.length){var i={type:"capture_event",data:o};e.sendString(i),b8e.Toast.launch("\u64cd\u4f5c\u91c7\u96c6\u5b8c\u6210")}o.length=0}}else b8e.Toast.launch("\u672a\u8fde\u63a5\u5230\u5206\u6790\u5668")},b8e.captureEvent=function(t){var e=null;if(t instanceof cc.Event){var i=[],s=t._touches,n=s?s[0]:null;n&&(i[i.length]={id:n.id,_lastModified:n._lastModified,_point:{x:n._point.x,y:n._point.y},_prevPoint:{x:n._prevPoint.x,y:n._prevPoint.y},_startPoint:{x:n._startPoint.x,y:n._prevPoint.y},_startPointCaptured:n._startPointCaptured}),e={bubbles:t.bubbles,currentTarget:null,eventPhase:t.eventPhase,target:null,type:t.type,_button:null,_eventType:t._eventType,_eventCode:t._eventCode,_prevX:t._prevX,_prevY:t._prevY,_propagationImmediateStopped:t._propagationImmediateStopped,_propagationStopped:t._propagationStopped,_scrollX:t._scrollX,_scrollY:t._scrollY,_x:t._x,_y:t._y,_touches:i,timestamp:b8e.timeStamp}}e&&(o[o.length]=e)},b8e.autoRunCaptureEvent=function(t){b8e.captureEventEnabled=!1;var e=t.type,r=t.data;if("capture_event"==e){var i=function t(e){var i=null;if("mouse"==e.type)i=new cc.Event.EventMouse;else if("touch"==e.type){var s=[],n=e._touches[0];u.id=n.id,u._lastModified=n._lastModified,u._point=cc.v2(n._point.x,n._point.y),u._prevPoint=cc.v2(n._prevPoint.x,n._prevPoint.y),u._startPoint=cc.v2(n._startPoint.x,n._startPoint.y),u._startPointCaptured=n._startPointCaptured,s[0]=u,i=new cc.Event.EventTouch(s)}else b8e.warn("\u672a\u77e5\u7684\u4e8b\u4ef6\u7c7b\u578b\uff1a"+e.type);if(i&&(i.bubbles=e.bubbles,i.currentTarget=null,i.eventPhase=e.eventPhase,i.target=null,i.type=e.type,i._button=null,i._eventType=e._eventType,i._eventCode=e._eventCode,i._prevX=e._prevX,i._prevY=e._prevY,i._propagationImmediateStopped=e._propagationImmediateStopped,i._propagationStopped=e._propagationStopped,i._scrollX=e._scrollX,i._scrollY=e._scrollY,i._x=e._x,i._y=e._y,cc.eventManager.dispatchEvent(i)),++l<h){var o=r[l],a=o.timestamp-c;c=o.timestamp,setTimeout(function(){t(o)},a)}else b8e.log("\u64cd\u4f5c\u8fd0\u884c\u5b8c\u6210")},h=r.length,l=0,c=0,u=new cc.Touch;setTimeout(function(){var t=r[l];c=t.timestamp,i(t)},0)}}}()},{}]},{},[1]);