(function(){return function s(o,r,g){function l(t,e){if(!r[t]){if(!o[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var n=r[t]={exports:{}};o[t][0].call(n.exports,function(e){return l(o[t][1][e]||e)},n,n.exports,s,o,r,g)}return r[t].exports}for(var c="function"==typeof require&&require,e=0;e<g.length;e++)l(g[e]);return l}})()({1:[function(a,n,s){"use strict";(function(){var e=void 0;(e=b8e.Object.extends({_isInit:!1,ctor:function(){if(this._super(),1==this._singleton)throw new Error("DataMgr \u53ea\u80fd\u901a\u8fc7\u5355\u4f8b\u65b9\u6cd5\u83b7\u53d6")},init:function(){var e=this;e._isInit||(e.mgrList=[],e.mgrMap=b8e.createMap(),e.addMgr(game.TestMgr,"TestMgr"),e.addMgr(game.FosterEquipMgr,"FosterEquipMgr"),e.addMgr(game.ExchangeActiveMgr,"ExchangeActiveMgr"),e.addMgr(game.MibaoMgr,"MibaoMgr"),e.addMgr(game.SpecialWarTokenMgr,"SpecialWarTokenMgr"),e.addMgr(game.QQVideoMgr,"QQVideoMgr"),e.addMgr(game.BossShowMgr,"BossShowMgr"),e.addMgr(game.TopNoticeMgr,"TopNoticeMgr"),e.addMgr(game.AoyiExpandMgr,"AoyiExpandMgr"),e.addMgr(game.GodAnimalMgr,"GodAnimalMgr"),e.addMgr(game.YuHuaMgr,"YuHuaMgr"),e.addMgr(game.QmStarMgr,"QmStarMgr"),e.initAllMgr(),e._isInit=!0)},addMgr:function(e,t){var a=this;a.mgrMap[t]=e,a.mgrList[a.mgrList.length]=e},initAllMgr:function(){var e=this;if(e.mgrList)for(var t=0,a=e.mgrList.length;t<a;t++){var i=e.mgrList[t];i&&i.inst&&i.inst().init()}},getMgr:function(e){var t=this.mgrMap[e];return t?t.inst():(b8e.error("\u4e0d\u5b58\u5728\u7684mgr",e),null)}}))._instance=null,e._singleton=!0,e.inst=function(){return null==e._instance&&(e._singleton=!1,e._instance=new e,e._singleton=!0),e._instance},b8e.RC("$$game","$$DataMgr",e)})(),function(){var e;e=b8e.EventDispatcher.extends({ctor:function(){if(this._super(),1==this._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7\u5355\u4f8b\u65b9\u6cd5\u83b7\u53d6")},init:function(){this._addEvents()},_addEvents:function(){b8e.evt.addG(this,game.TriggerEvts.C_TRIGGER_OPEN,this._onTriggerOpen)},_onTriggerOpen:function(e){this.triggerOpen&&this.triggerOpen(e.data)},addEventByModule:function(e,t,a){var i=b8e.module.getControl(e);i?i.addEventListener(t,a,this):b8e.error("\u4e0d\u5b58\u5728\u5bf9\u5e94\u6a21\u5757")},removeEventByModule:function(e,t,a){var i=b8e.module.getControl(e);i?i.removeEventListener(t,a,this):b8e.error("\u4e0d\u5b58\u5728\u5bf9\u5e94\u6a21\u5757")},addEvent:function(e,t,a){this.addEventListener(e,t,a)},removeEvent:function(e,t,a){this.removeEventListener(e,t,a)},send:function(e,t){this.dispatchEventWith(e,t)},addListenerPb:function(e,t){b8e.net.addMsgHandler(e,t,this)},removeListenerPb:function(e,t){b8e.net.removeMsgHandler(e,t)},sendPb:function(e,t){t&&b8e.NetSender.getBytes().writeProtobuf(t),b8e.net.sendBinary(e)}}),b8e.RC("$$game","$$GameBaseMgr",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this.moduleMap=b8e.HashMap.get()},initModule:function(e){var t=game.ModuleCfg.getData(e);if(!t||!t.moduleName){return null}var a=this.getModuleInfo(t.moduleName);if(a){return a.moduleEnum=e,a}if((a=new game.ModuleInfo).moduleName=t.moduleName,a.moduleEnum=e,this.moduleMap.set(t.moduleName,a,this),t.dependsName){var i=this.getModuleInfo(t.dependsName);if(!i){(i=new game.ModuleInfo).moduleName=t.dependsName,this.moduleMap.set(t.dependsName,i,this)}i.relySelfModules.push(a),a.relyModule=i}return a},getModuleInfo:function(e){return this.moduleMap.get(e,this)}});game.moduleData=game.moduleData||new e}(),function(){var e;e=b8e.Object.extends({moduleEnum:0,moduleName:null,relyModule:null,relySelfModules:null,loading:!1,loaded:!1,ctor:function(){this.relySelfModules=[]}}),b8e.RC("$$game","$$ModuleInfo",e)}(),function(){var e;e=b8e.Object.extends({ctor:function(){this._super(),this.ipc(),this._initReq()},ipc:function(){},_initReq:function(){if(this.msg)b8e.net.req(this.msg,game.protoId,this);else;},byte:{get:function(){return b8e.NetSender.getBytes()}},write:function(e){b8e.NetSender.getBytes().writeProtobuf(e)},send:function(e,t){if(t){b8e.NetSender.getBytes().writeProtobuf(t)}b8e.sendN(e),b8e.warn("\u4e0d\u518d\u5efa\u8bae\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5 Class1.send")}}),b8e.RC("$$game","$$Sender",e)}(),function(){var e;e=b8e.BaseControl.extends({ipc:function(){},onShow:function(){},onHide:function(){},handelNS:function(){return game.protoId},selectToggle:function(){},helpBtn:function(){game.RuleView.inst().showView(this.moduleEnum)}}),b8e.RC("$$game","$$Control",e)}();var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){game.MODULE_VERSION="2.1.0";var e=b8e.Object.extends({ctor:function(){var e=this;e._showModule=[],e._waitShow=b8e.createMap(),e._showModuleGroupMap=b8e.HashMap.get(),e._waitModuleMap=[];var t=b8e.AnimatorResource.setSecondActionName;t("standAndRide","stand"),t("runAndRide","run"),t("hitAndRide","hit"),t("attack1AndRide","attack1"),t("attack2AndRide","attack2"),t("dieAndRide","die"),e._openModule=[],e._mainModule=[]},initGameBaseModule:function(){b8e.module.initWait(),b8e.app.initWait(),game.DataMgr.inst().init()},debug:function(){b8e.profiler.clearLog(),this.DEBUG=!0},show:function(e,t,a){var i=!(2<arguments.length&&void 0!==a)||a;if("number"!=typeof t)if(e!=game.ME.GotoBattle){var n=this;if(!i||game.moduleOpen.checkOpenWithTips(e))if(b8e.module.isInited(e)||b8e.app.isInited(e)){n.DEBUG;var s=b8e.module.getView(e);if(!(s=s||b8e.app.getView(e)))return void b8e.error(e," view \u6ca1\u6709\u5b8c\u6210\u521d\u59cb\u5316");s.fadeEnabel=!0;var o=game.ShowViewManagerCfg.getData(e,null,null,!1),r=2;o&&(r=o.groupId);var g=n._showModuleGroupMap.get(r);if(g||(g=[],n._showModuleGroupMap.set(r,g)),-1==g.indexOf(e)){if(1==r){for(var l=0,c=g.length;l<c;l++)n.hide(g[l]);g.length=0,game.GameViewMgr.inst().showView(e,t),g.push(e)}}else if(1==r){for(var h=0,m=g.length;h<m;h++)n.hide(g[h]);g.length=0}1!=r&&game.GameViewMgr.inst().showView(e,t),n._showModule.indexOf(e)<0&&n._showModule.push(e),!t&&n._mainModule.indexOf(e)<0&&n._openModule.indexOf(e)<0&&n._openModule.push(e),n.checkTask(e)}else{var u=b8e.createMap();u.parent=t,u.checkOpen=i,n._waitShow[e]=u,n.initModule(e)}}else{var d=b8e.module.getControl(game.ME.MainUIBottom);d&&d.showZhanYi&&d.bottomZhanYi()}else b8e.error("\u4f5c\u4e3a\u5b50\u9762\u677f\u7684\u754c\u9762\u8bf7\u4f7f\u7528showTab\uff01",e)},showToggle:function(e,t,a,i){var n=1<arguments.length&&void 0!==t?t:void 0,s=2<arguments.length&&void 0!==a?a:void 0,o=!(3<arguments.length&&void 0!==i)||i;if("number"!=typeof s){var r=this;if(b8e.module.isInited(e)||b8e.app.isInited(e)){r.DEBUG;var g=b8e.module.getView(e);if(!(g=g||b8e.app.getView(e)))return void b8e.error(e," view \u6ca1\u6709\u5b8c\u6210\u521d\u59cb\u5316");var l=g.getToggleIndex(n);if(l&&!game.moduleOpen.checkOpenWithTips(l))return;if(!game.moduleOpen.checkOpenWithTips(e))return;if(g.fadeEnabel=!0,isNaN(n))return game.GameViewMgr.inst().showView(e,s),r._showModule.indexOf(e)<0&&r._showModule.push(e),!s&&r._mainModule.indexOf(e)<0&&r._openModule.indexOf(e)<0&&r._openModule.push(e),void r.checkTask(e);if(game.GameViewMgr.inst().showView(e,s),r._showModule.indexOf(e)<0&&r._showModule.push(e),!s&&r._mainModule.indexOf(e)<0&&r._openModule.indexOf(e)<0&&r._openModule.push(e),g.isNewMvc)g.toggleSelect(n);else{var c=b8e.module.getControl(e),h=b8e.module.getControl(b8e.module._bindVC[e]);if(!c&&!h)return void b8e.error(e," control \u548c bindCtrl \u6ca1\u6709\u5b8c\u6210\u521d\u59cb\u5316");if(c&&!c.selectToggle)return void b8e.error(e," control \u6ca1\u6709\u5b9e\u73b0 selectToggle\u63a5\u53e3 \u9700\u8981\u5ba2\u6237\u7aef\u901a\u77e5\u5b9e\u73b0");if(c)c.selectToggle(n);else{if(h&&!h.selectToggle)return void b8e.error(e," control \u6ca1\u6709\u5b9e\u73b0 selectToggle\u63a5\u53e3 \u9700\u8981\u5ba2\u6237\u7aef\u901a\u77e5\u5b9e\u73b0");h&&h.selectToggle(n)}}r.checkTask(e)}else{if(!game.moduleOpen.checkOpenWithTips(e))return;var m=b8e.createMap();m.toggle=n,m.parent=s,m.checkOpen=o,r._waitShow[e]=m,r.initModule(e)}}else b8e.error("\u4f5c\u4e3a\u5b50\u9762\u677f\u7684\u754c\u9762\u8bf7\u4f7f\u7528showTab\uff01",e)},checkTask:function(e){b8e.evt.dptG(game.TaskEvts.G_TASK_OPEN_UI,e)},showHide:function(e,t){b8e.module.isShowView(e)||b8e.app.isShowView(e)?this.hide(e):this.show(e,t)},toggleShow:function(e,t){b8e.module.isShowView(e)||b8e.app.isShowView(e)?this.hide(e):this.show(e,t)},showHideOther:function(e,t){b8e.module.isShowView(e)&&b8e.app.isShowView(e)||this.show(e,t)},closeAll:function(){if(!game.mainCenterData.isAutoFight)for(var e=void 0,t=this._openModule.slice(),a=t.length,i=0;i<a;i++)(e=t[i])&&((void 0===e?"undefined":p(e))===b8e.TypeNumber?this.hide(e):e.removeFromParent())},showTab:function(e,t,a){var i=!(2<arguments.length&&void 0!==a)||a;if(!i||game.moduleOpen.checkOpenWithTips(e))if(b8e.module.isInited(e)||b8e.app.isInited(e))this.DEBUG,game.GameViewMgr.inst().showView(e,t);else{var n=b8e.createMap();n.parent=t,n.checkOpen=i,this._waitShow[e]=n,this.initModule(e)}},hideTab:function(e){b8e.module.hideView(e)},hide:function(e){var t=this,a=t._showModule.indexOf(e);-1<a&&t._showModule.splice(a,1),t._waitShow[e]&&delete t._waitShow[e];var i=game.ShowViewManagerCfg.getData(e,null,null,!1),n=2;i&&(n=i.groupId);var s=t._showModuleGroupMap.get(n);s||(s=[],t._showModuleGroupMap.set(n,s));var o=s.indexOf(e);-1<o&&s.splice(o,1),game.GameViewMgr.inst().hideView(e),game.moduleDelay.delayShowModule(e)},removeOpenModule:function(e){var t=void 0;e&&e.moduleEnum&&(t=e.moduleEnum);var a=void 0;-1<(a=t?this._openModule.indexOf(t):this._openModule.indexOf(e))&&this._openModule.splice(a,1)},addOtherModule:function(e){this._openModule.push(e)},getShowModule:function(){return this._showModule.slice()},hasShowModule:function(){return!!this._showModule&&0<this._showModule.length},initModule:function(e){if(!b8e.module.isInited(e)){var t=game.moduleData.initModule(e);if(t&&!t.loaded&&!t.loading)if(t.relyModule){var a=t.relyModule;a.loaded?this._loadModule(t):this._loadModule(a)}else this._loadModule(t)}},_loadModule:function(e){if(!e.loading&&!e.loaded){var t=void 0;e.loading=!0,b8e.macro.IS_RELEASE?(t="module/app/"+e.moduleName+".bgp",b8e.res.loadRes(t,null,this.loadReleaseComplete,this,[e])):(t="../app_dist/"+e.moduleName,b8e.res.loadRes(t,null,this.loadDebugModule,this,[e]))}},loadDebugModule:function(e,t,a){e?b8e.error(e):this._laodComplete(t,a)},loadReleaseComplete:function(e,t,a){e?b8e.error(e):(t&&b8e.res.parseScript(a.moduleName,t),this._laodComplete(t,a))},_laodComplete:function(e,t){var a=this;if(t.loading=!1,t.loaded=!0,0<t.relySelfModules.length)for(var i=0,n=t.relySelfModules.length;i<n;i++)a._loadModule(t.relySelfModules[i]);var s=t.moduleEnum;if(s){var o=a._waitShow[s];o&&(a._waitShow[s]&&delete a._waitShow[s],o.toggle?a.showToggle(s,o.toggle,o.parent,o.checkOpen):a.show(s,o.parent,o.checkOpen))}},initMainProcess:function(){var e=game.mainProcess;e||(e=game.mainProcess=new game.MainProcessRun,b8e.startup.initMainScene(),e.initProcess())},runMainProcess:function(){game.VERSION==game.MODULE_VERSION?(this.initMainProcess(),game.mainProcess.runProcess()):b8e.Toast.launch("Game Version\u548cModule Version\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nGame:V"+game.VERSION+" & Module:V"+game.MODULE_VERSION,4294901760,0)},showMainView:function(){var e=this,t=game.ME;e._mainModule=[t.MainUIBottom,t.MainUITop,t.MainUIChat,t.MainUIRight,t.MainUILeft,t.MainActivityNotice,t.Task,t.MainUIHead,t.MainMap,t.MainCenter,t.MainUIHeadMiddle,t.MainUIModulePre,t.MainUITopFightAmount,t.PlayBackRound,t.PlaybackInfo,t.PlayBackSpeedRatio,t.Home,t.OnlineGiftAward,t.InstanceSuccess,t.GuajiUp],e.show(t.MainUIBottom,null,!1),b8e.module.isShowView(t.PlayBackFormation)||e.show(t.MainUIBottom,null,!1),e.show(t.MainUITop,null,!1),e.show(t.MainUIChat,null,!1),e.show(t.MainUIRight,null,!1),e.show(t.MainUILeft,null,!1),e.show(t.MainActivityNotice,null,!1),e.show(t.MainUIHead,null,!1),e.show(t.MainMap,null,!1),e.show(t.MainCenter,null,!1),e.show(t.MainUIHeadMiddle,null,!1)}});game.module=game.module||new e})(),function(){var e;e=b8e.Enum({$$CultivateBaseSkillTips2:998,$$CultivateBaseSkillTips:999,$$GotoBattle:9999,$$Demo:1e3,$$MainRole:1001,$$Scene:1002,$$Trigger:1003,$$Instance:1005,$$GameAlert:1006,$$MainUIBottom:1008,$$MainUITop:1009,$$MainUILeft:1010,$$MainUIRight:1011,$$MainUIChat:1012,$$Task:1013,$$Back:1014,$$BackGoods:1015,$$BackEquip:1016,$$EffectItemTips:1017,$$EquipTips:1018,$$RoleAttr:1019,$$Chat:1020,$$MainUIHead:1021,$$MainMap:1022,$$PlayBackRound:1023,$$InstanceSuccess:1024,$$MainUIModulePre:1025,$$ModulePre:1026,$$ModuleOpen:1027,$$PlaybackInfo:1028,$$MainCenter:1029,$$MainUIHeadMiddle:1030,$$AutoFight:1031,$$PlayBackSpeedRatio:1032,$$MainModulePre:1033,$$PlayBackSkip:1034,$$ModuleOpenFlyBtn:1035,$$GM:2e3,$$Role:2001,$$RoleEquip:2002,$$RoleSpell:2003,$$RoleSortSkill:2006,$$Mail:2007,$$MailSee:2008,$$ChatEmotion:2009,$$ChatQuickSend:2010,$$ChatPlayerInfo:2011,$$ChatPrivate:2012,$$EquipForge:2022,$$EquipIntensify:2023,$$EquipRefine:2024,$$EquipPurify:2025,$$EquipGem:2026,$$ForgeMasterTips:2027,$$FosterExpTips:2042,$$FosterHandel:2043,$$FosterEquipTips:2044,$$HuanXing:2045,$$Suit:2046,$$Daily:2047,$$Dangkou:2048,$$DangkouAward:2049,$$Rank:2050,$$Guaji:2051,$$GuajiTips:2052,$$Vip:2054,$$FightAmount:2055,$$ItemTips:2056,$$Sell:2057,$$SellSelect:2058,$$Cs:2059,$$Relation:2060,$$CsTeam:2061,$$TeamHandel:2062,$$CsTeamDetailsView:2063,$$CsTeamSelectPartnerView:2064,$$InstanceFunc:2070,$$InstanceMaterial:2071,$$InstanceHall:2069,$$MainInstance:2072,$$MainInstanceHelp:2073,$$MainInstanceRank:2074,$$InstancePrizeTips:2075,$$Home:2076,$$InstanceAwardPreview:2077,$$Boss:2080,$$PersonalBoss:2081,$$PublicBoss:2082,$$PublicBossBattle:2083,$$PublicBossLog:2084,$$PublicBossDamageView:2085,$$PublicBossSetting:2086,$$PublicBossVip:2087,$$WildBoss:2088,$$WildBossInfo:2089,$$TaoFaPage:2090,$$TaoFaView:2091,$$WildBossShop:2092,$$ZhanJiang:2100,$$ZhaoQin:2101,$$ZhaoqinPrize:2102,$$ZhanJiangAwardPreview:2104,$$ZhanJiangSweep:2105,$$GuardianSkillTips:2140,$$BaoZang:2150,$$BaoZangPrize:2151,$$PeachGarden:2400,$$MasterApprentice:2401,$$MyMasterView:2402,$$MyApprentice:2403,$$InviteApprentice:2404,$$ApprenticeItem:2405,$$ApprenticeTask:2406,$$ChushiItem:2407,$$InviteApprenticeItem:2408,$$MasterChushiItem:2409,$$MasterTaskItem:2410,$$ChuanGong:2411,$$ZhuChu:2412,$$Surface:2500,$$GodEquip:2507,$$GodEquipUpgrade:2508,$$GodEquipWash:2509,$$GodEquipQuenching:2510,$$GodEquipResolve:2511,$$GodEquipResonance:2512,$$GodEquipChooseEquips:2513,$$GEduanHun:2514,$$GEfuHun:2515,$$GEjingCui:2516,$$Escort:2520,$$EscortRevenge:2521,$$EscortList:2522,$$EscortFinish:2523,$$EscortLog:2524,$$EscortRob:2525,$$SuitMain:2700,$$GoldEquipShop:2701,$$CommonShop:2702,$$Shop:2703,$$DailyJuyi:2704,$$DailyExploit:2705,$$WeeklyExp:2730,$$DailyExploitRecover:2706,$$DailyExploitPrize:2711,$$Exam:2707,$$ExamRank:2708,$$ExamEnter:2709,$$ExamResult:2710,$$SHOP_TOGGLE_1:2720,$$SHOP_TOGGLE_2:2721,$$SHOP_TOGGLE_3:2722,$$SHOP_TOGGLE_4:2723,$$WorldWar:2750,$$WorldWarTeam:2751,$$WorldWarBoxAward:2752,$$WorldWarTeamDetailsView:2753,$$WorldWarTeamSelectPartnerView:2754,$$WorldMap:2800,$$WorldMapAlert:2801,$$ZhaoQinRank:2900,$$ZhanJiangRank:2901,$$BaoZangRank:2902,$$ZhaoQinAward:2903,$$GoldEquipResolve:3801,$$Recharge:3802,$$FirstRechargeMain:3803,$$FirstRecharge:3804,$$DiscountRecharge:3805,$$TodayDiscountRecharge:3806,$$DailyRecharge:3807,$$FundMain:3808,$$Welfare:3809,$$WeekCard:3810,$$MonthCard:3811,$$ActiveBar:3812,$$HomeLeftBar:3813,$$HomeRightBar:3814,$$HomeBottomBar:3815,$$MainLeftBar:3821,$$MainRightBar:3822,$$FreeGift:3823,$$TimeLimitPrize:3824,$$AccCost:3825,$$QrcodeView:3826,$$MergeFreeGift:3827,$$FreeFatherGift:3828,$$FundMine:3830,$$FundAll:3831,$$Guild:3901,$$CreateGuild:3902,$$GuildApplyList:3903,$$GuildHall:3904,$$GuildLogList:3905,$$GuildMember:3906,$$GuildNotice:3907,$$GuildQuest:3908,$$GuildRank:3909,$$GuildRecommend:3910,$$GuildRename:3911,$$GuilMemberTips:3912,$$GuildSkill:3913,$$GuildIncense:3914,$$GuildDonate:3915,$$GuildTeam:3916,$$GuildTeamDetailsView:3917,$$GuildTeamSelectPartnerView:3918,$$GuildCollect:3921,$$GuildCollectBar:3922,$$GuildExchange:3923,$$GuildCollectMenu:3924,$$GuildTaskResetAlert:3925,$$Marry:3950,$$MarryReq:3951,$$MarryConfirm:3952,$$MarryGift:3953,$$MarryOath:3954,$$House:3970,$$HouseAtt:3971,$$HouseRec:3972,$$ActivitiesHall:4100,$$OpenServer:4101,$$ArenaMain:4300,$$Arena:4301,$$ArenaRank:4302,$$ArenaLog:4303,$$ArenaFinish:4304,$$ArenaAwardPreview:4305,$$ArenaBuyView:4306,$$Pve:4510,$$SaleRecharge:4511,$$Investment:5001,$$LevelPrize:5003,$$JinjieRank:5005,$$DiscountShop:5006,$$QuanminPurchase:5007,$$AccumulatedRecharge:5008,$$UpgradeRebate:5009,$$SpecialShop:5010,$$MysteryShop:5011,$$ContinuousRecharge:5012,$$ProgressGoal:5013,$$ProgressGoalAward:5014,$$ConRecharge2:5015,$$JinjieRankTip:5016,$$DianWei:5051,$$DianWeiRank:5052,$$RedPacket:5060,$$RedPacketSendAlert:5061,$$RedPacketSend:5062,$$RedPacketRecv:5063,$$RedPacketSee:5065,$$CsBoss:5200,$$CsBossAward:5201,$$CsBossBattle:5202,$$CsBossChallenge:5203,$$CsBossRank:5204,$$CsBossTopLeft:5205,$$CsBossTopRight:5206,$$CsBossBottom:5207,$$CsBossEnter:5208,$$CsBossGuildAward:5209,$$CsBossPlayerAward:5210,$$CsBossGuildRank:5211,$$CsBossPlayerRank:5212,$$SceneCollectBar:5500,$$SceneRevive:5501,$$SignInPrize:7001,$$LoginAwards:7002,$$ActivationCode:7003,$$StarPlayback:7004,$$ManyFirstCharge:7005,$$MainActivityNotice:7006,$$MainActivityNoticeBar:7007,$$LoginAwardsMain:7008,$$PetTurnplate:7013,$$PetTurnAward:7014,$$PetTurnLog:7015,$$GetHufu:7016,$$WalfCheckin:7017,$$GuanDu:7020,$$GuanDuAlert:7021,$$GuanDuBottom:7022,$$GuanDuOpenAlert:7023,$$GuanDuRank:7024,$$GuanDuChallenge:7025,$$GuanDuTop:7026,$$GuanDuWindow:7027,$$GuanDuEnd:7028,$$GuanDuExit:7029,$$ZcTurnplate:7030,$$LuckyLogTip:7031,$$EggTurnplate:7032,$$Siliver:7100,$$Announcement:7101,$$GuildActivePage:7201,$$GuildAwardPre:7202,$$GuildActive:7203,$$GuildDailyActive:7204,$$VipBanner:7301,$$VipMain:7302,$$TipsOpen:7303,$$YongzheWelfare:7310,$$YongzheView:7311,$$YongzheRulePage:7312,$$YongzheExpPage:7313,$$YongzheZuanshiPage:7314,$$Welcome:7400,$$MoneyTree:7401,$$DrawLot:7410,$$ManyFirstAdvert:7411,$$FestivalBoss:7420,$$FestivalBossRank:7421,$$LotPrize:7412,$$OnlineGift:7430,$$OnlineGiftAward:7431,$$Auction:7440,$$AuctionServer:7441,$$AuctionCorps:7442,$$AuctionLog:7443,$$AuctionTip:7444,$$MillionsLogin:7460,$$MainRoleInfoView:7501,$$Setting:7502,$$Rename:7503,$$ShareMain:7510,$$Achieve:7511,$$AchieveModelTip:7512,$$AchieveTip:7513,$$ShareTip:7514,$$ShareView:7515,$$CsArrow:7601,$$CsArrowRank:7602,$$CsArrowScene:7603,$$CsArrowRoom:7604,$$CsArrowBag:7605,$$CsArrowMail:7606,$$CsArrowMain:7607,$$CsArrowGameInfo:7608,$$CsArrowPlayBar:7609,$$CsArrowPlayerBar:7610,$$CsArrowEnter:7611,$$WuShengMain:7650,$$WuShengActive:7651,$$WuShengCollect:7652,$$WushengBuff:7653,$$WushengQulity:7654,$$Military:7701,$$MilitaryAward:7702,$$Throne:7800,$$ThroneRank:7801,$$ThroneMonthlyRank:7802,$$ThroneExit:7803,$$ThroneLayer:7804,$$ThroneMain:7805,$$ThroneEnter:7806,$$CsActivity:7901,$$NormalActivity:7902,$$NewYearRecharge:7910,$$NewYearAccuRecharge:7911,$$NewYearExcharge:7912,$$NewYearSignIn:7920,$$NewYearRecharge2:7921,$$NewYearRecharge3:7922,$$NewYearAccuRecharge2:7923,$$NewYearAccuRecharge3:7924,$$Hunting:7930,$$HuntingPrize:7931,$$HuntingRank:7932,$$GuildBoss:8e3,$$CsWar:8002,$$CsWarRank:8003,$$CsWarRule:8004,$$CsWarLog:8005,$$CsWarBattleTeam:8006,$$CsWarChallenge:8007,$$CsWarLeftBottom:8008,$$CsWarLeftTop:8009,$$CsWarMiddle:8010,$$CsWarRightBottom:8011,$$CsWarRightTop:8012,$$CsWarTeam:8013,$$CsWarQuickEntry:8014,$$CsWarMinePre:8015,$$CsWarEnd:8016,$$AccumulativeRecharge:8101,$$NewYearDiscountMall:8102,$$RechargeRank:8103,$$RechargeRankList:8104,$$ConsumptionRank:8105,$$ConsumptionRankList:8106,$$NewYearSaleMall:8107,$$NewYearMysteryMall:8108,$$GeneralBoss:8300,$$GeneralBossBattle:8301,$$GeneralBossLog:8302,$$GeneralBossDamageView:8303,$$GeneralBossSetting:8304,$$GeneralBossVip:8305,$$GeneralBossTip:8306,$$CsGuild:8500,$$CsGuildAward:8501,$$CsGuildBattle:8502,$$CsGuildChallenge:8503,$$CsGuildRank:8504,$$CsGuildTopLeft:8505,$$CsGuildTopRight:8506,$$CsGuildBottom:8507,$$CsGuildBossAward:8509,$$CsGuildPlayerAward:8510,$$CsGuildExit:8520,$$CsGuildTop:8521,$$Festival:9001,$$FstResetRechage:9002,$$VerifyAward:9101,$$VerifyName:9102,$$VerifyVipcn:9103,$$VerifyWeiduan:9104,$$VerifyCollection:9105,$$VerifyAddShortcut:9106,$$VerifyInterestTribe:9108,$$QQVipPrivilege:9109,$$QQVipDaily:9110,$$QQVipDiscount:9111,$$QQVipGiftView:9112,$$VerifyVipcnWx:9107,$$FalseRealName:9113,$$BindMobile:9114,$$SuperVip:9115,$$FollowGift:9116,$$YearTask:9201,$$YearTaskPrize:9202,$$YearPay:9205,$$YearPay2:9206,$$YearPay3:9207,$$LuckyActId1:9501,$$LuckyActId2:9502,$$LuckyActId3:9503,$$LuckyActId4:9504,$$LuckyActId5:9505,$$LuckyActId6:9506,$$LuckyActId7:9507,$$LuckyActId8:9508,$$LuckyActId9:9509,$$LuckyActId10:9510,$$LuckyActId11:9511,$$LuckyActId12:9512,$$LuckyActId13:9513,$$LuckyActId14:9514,$$LuckyActId15:9515,$$LuckyActId16:9516,$$LuckyActId17:9517,$$LuckyActId18:9518,$$LuckyActId19:9519,$$LuckyActId20:9520,$$RareItemShow:9601,$$TaskAutoFight:9900,$$CSArena:10100,$$CSArenaRank:10101,$$CSArenaAward:10102,$$CSArenaScore:10103,$$CSArenaDanGrading:10104,$$CSArenaSeason:10105,$$CSArenaChallenge:10106,$$CSArenaLog:10107,$$CSArenaBuyView:10108,$$ChallengeCbp:10200,$$ChallengeCbpMap:10201,$$ChallengeCbpBuff:10202,$$ChallengeCbpBuffTips:10203,$$EnemyTeam:10204,$$ChallengeCbpRenascence:10205,$$ChallengeTeam:10206,$$ChallengeSetTeam:10207,$$MysticShop:10208,$$PreviewAward:10209,$$RestLevelAlert:10210,$$Stronger:10250,$$LevelUpWay:10251,$$GetBangYuan:10252,$$GetYinLiang:10253,$$ChatView:10401,$$FuncNotice:10600,$$TodayFuncNotice:10601,$$GuoshiChallenge:10900,$$GuoshiCKillLog:10901,$$GuoshiCDamageLog:10902,$$GuoshiChallengeBattle:10903,$$FightPosNotice:11e3,$$GoodGift:11200,$$SpecialGift:11201,$$SingleRecharge:11202,$$TotalRecharge:11203,$$TTAccCost:11204,$$AccConCarnival:11300,$$AccCost2:11301,$$GrowGift:11400,$$GrowGiftPage:11401,$$DailyGift:11402,$$CardsBreak:11503,$$CardsAwakeTips:11504,$$CardsDetail:11505,$$CardsSuit:11506,$$FeedBack:11550,$$WorldChallenge:11700,$$WorldChallengeBet:11701,$$WorldChallengeBetTips:11702,$$WorldChallengeLog:11703,$$Mystery2Shop:11800,$$Mystery2ShopPage:11801,$$Mystery2ScoreShopPage:11802,$$Mystery2ShopPage2:11803,$$MysteryShopFrame:11810,$$AllServerWar:11900,$$AllServerWarBet:11901,$$AllServerWarBetTips:11902,$$AllServerWarLog:11903,$$RecycleSurface:12e3,$$GuildWar:12200,$$GuildWarAward:12201,$$GuildWarAwardGuild:12202,$$GuildWarAwardSinge:12203,$$GuildWarAwardHit:12204,$$GuildWarRankSinge:12205,$$GuildWarRankGuild:12206,$$GuildWarRankScore:12207,$$GuildWarRank:12208,$$GuildWarEnter:12209,$$GuildWarSettlement:12210,$$GuildWarBattle:12211,$$GuildWarSnatch:12212,$$GuildWarPlay:12213,$$GuildWarQuickEntry:12214,$$MergeServer:12300,$$MergePve:12301,$$MergeDiscountShop:12302,$$MergeMysteryShop:12303,$$MergeSpecialShop:12304,$$MergeLogin:12305,$$MergeTotalRecharge:12307,$$MergeConRecharge:12308,$$MergeAccCost:12309,$$MergeTurnplate:12310,$$LimitedTimeRank:12400,$$LimitedTimeRankList:12401,$$SelectGift:12402,$$RebateAward:12601,$$Puzzle:12700,$$PuzzleTask:12701,$$PuzzleHelp:12702,$$MarryMission:12800,$$GuildMission:12801,$$SmashGoldEgg:13e3,$$GetRewardResult:13110,$$QQVipDailyGift:13111,$$ZSShiLian:13400,$$ZSShiLianTip:13401,$$XinyueAward:13501,$$MoreExciting:13502,$$CSTreasure:13700,$$CSTMain:13701,$$CSTTime:13702,$$CSTExit:13703,$$CSTEnter:13704,$$Map:13705,$$Monopoly:13800,$$GuanDuRightTop:13911,$$NotOpenTip:14104,$$WorldWar2:14500,$$WorldWar2Team:14501,$$WorldWar2BoxAward:14502,$$WorldWar2HelpTip:14503,$$WorldWar2TeamDetailsView:14504,$$WorldWar2TeamSelectPartnerView:14505,$$DailyFuLi:14600,$$DailyOfficial:14601,$$FlagWar:14800,$$FlagWarRank:14801,$$FlagWarBattle:14802,$$VipWelfare:15001,$$QqVipLogin:15002,$$CServRank:15100,$$CServRankList:15101,$$DigTreasure:15200,$$DigAward:15201,$$DigLog:15202,$$DigBar:15203,$$DigTreasureHelpBtn:15204,$$DigResult:15205,$$DifficultSelect:15501,$$FestSRecharge:15600,$$GoodGiftRMB:15601,$$CultureGift:15602,$$CultureGiftAlert:15603,$$Occupied:15700,$$OccupiedRank:15701,$$OccupiedGuildRank:15702,$$OccupiedPlayerRank:15703,$$OccupiedBattle:15704,$$OccupiedShop:15705,$$FlagWarShop:15706,$$Medal:15900,$$MedalSkillTips:15901,$$SRTurnplate:16e3,$$SRTurnplateSelect:16001,$$SRTurnplate2:16002,$$SRTurnplateSelect2:16003,$$TeamLeague:16100,$$TeamLeagueList:16101,$$TeamLeagueCreate:16102,$$TeamLeagueHall:16103,$$TeamLeagueRename:16104,$$TeamLeagueApply:16105,$$TeamLeagueTeam:16106,$$TeamLeagueSetTeam:16107,$$TeamLeagueMyLog:16108,$$TeamLeagueRank:16109,$$TeamLeagueScoreRank:16110,$$TeamLeagueMatchAward:16111,$$TeamLeagueScoreAward:16112,$$TeamLeagueMatch:16113,$$TeamLeagueBet:16114,$$TeamLeagueBetTips:16115,$$TeamLeagueMatchLog:16116,$$TeamLeagueSettlement:16117,$$TeamLeagueAssistMain:16118,$$TeamLeagueAssist:16119,$$TeamLeagueActAward:16121,$$ChainGift:16600,$$ChainGiftMain:16601,$$QuestLink:17e3,$$CsOverlord:17300,$$CsOverlordWorship:17301,$$CsOverlordRank:17302,$$CsOverlordScoreRank:17303,$$CsOverlordMatchAward:17304,$$CsOverlordScoreAward:17305,$$CsOverlordBet:17306,$$CsOverlordBetTips:17307,$$CsOverlordMatchLog:17308,$$CsOverlordMatchIng:17309,$$CsOverlordMyLog:17310,$$TVDailyRecharge:17600,$$TVDailyRechargeAlert:17601,$$ThousandTower:17700,$$ThousandTowerTeam:17701,$$LuckyTurn:17900,$$FuDai:18100,$$FuDaiAward:18101,$$FuDaiLog:18102,$$FuDaiResult:18103,$$FuDaiHelpBtn:18104,$$PrizeTips:18105,$$FestivalRecharge:18200,$$FestivalAccuRecharge:18201,$$JuBaoPen:18300,$$JuBaoPenAward:18301,$$JuBaoPenLog:18302,$$JuBaoPenResult:18303,$$JuBaoPenShow:18304,$$JuBaoPenHelpBtn:18305,$$CsFestivalBoss:18800,$$CsFestivalBossRankMain:18801,$$CsFestivalBossRank:18802,$$CsFestivalBossAward:18803,$$ShengZhuang:18900,$$ShengZhuangTips:18901,$$TreasurePavilion:19200,$$TPStepAward:19201,$$TPAwardLogs:19202,$$FcmOnlineTips:19300,$$PetWarsSuitMain:19400,$$PetWarsSuitEquip:19401,$$PetWarsSuitStar:19402,$$PetWarsSuitPreview:19403,$$PetWarsSuitBattle:19404,$$PetWarsSuitBreak:19405,$$PetWarsEquipTips:19406,$$PetWarsChain:19407,$$PetWarsSKill:19408,$$ComradeBack:19500,$$RegressActivity:19501,$$SevenLogin:19502,$$RegressGift:19503,$$Recall:19504,$$InviteGift:19505,$$Incense:19600,$$IncensePrize:19601,$$IncenseAward:19602,$$Bottle:19700,$$BottleModule:19701,$$BottleGrow:19702,$$BottleBreak:19703,$$BottleAttrItem:19704,$$BottleTip:19705,$$BottleBattle:19706,$$FosterSkinSkillTips:19800,$$ModulePreList:19801,$$ModulePreListItem:19802,$$Rewarder:20200,$$RewarderChoose:20201,$$RewarderLv:20202,$$ElementAttr:19900,$$NewYearRecharge4:2e4,$$NewYearRecharge5:20001,$$NewYearRecharge6:20002,$$NewYearAccuRecharge4:20003,$$NewYearAccuRecharge5:20004,$$NewYearAccuRecharge6:20005,$$FestSRecharge2:20006,$$YearPay4:20007,$$YearPay5:20008,$$YearPay6:20009,$$VipBossMain:20100,$$VipBossChallenge:20101,$$VipBossBattle:20102,$$PetAdvanceSkillTips:20103,$$PetAdvanceSkillUpAlert:20104,$$PetAdvanceSkillUpTips:20105,$$LimitGift:20300,$$Transfer:20400,$$TransferLevelUp:20401,$$TransferTalent:20402,$$TransferUpgrade:20403,$$TransferEquip:20404,$$TransferExpGet:20405,$$TransferEquipDetail:20406,$$TransferEquipBreak:20407,$$TransferSkillUpgrade:20408,$$TransferSkillTips:20409,$$TransferAttrItem:20410,$$TransferSelect:20411,$$TransferEquipSuitTips:20412,$$TransferTalentSkillLvUpTips:20413,$$TransferTalentActiveTips:20414,$$TransferTalentResetGroupTips:20415,$$VipPromote:20500,$$VerifyAwardColorTicket:20600,$$ActiveChildren:20601,$$MysteriousEgg:20700,$$MysteriousEggHatch:20701,$$VipBossWelfare:20800,$$PushPrize:20900,$$Partner:21e3,$$PartnerUpgrade:21001,$$PartnerBreak:21002,$$PartnerStar:21003,$$PartnerDetails:21004,$$PartnerQuickStar:21005,$$PartnerSpriteStat:21006,$$PartnerEquipDetails:21007,$$PartnerChange:21008,$$PartnerFormation:21009,$$PartnerSkillTips:21010,$$PartnerEquipChange:21011,$$PartnerEquipNotWear:21012,$$PartnerEquipToWear:21013,$$PartnerMain:21014,$$PartnerHelp:21015,$$PartnerHelpSelect:21016,$$PartnerActive:21017,$$PartnerSpirit:21130,$$PartnerSpiritAttr:21129,$$PartnerTalent:21140,$$PartnerTalentQulity:21141,$$PartnerExcEquipDetails:21018,$$PartnerExcEquipInfo:21019,$$PartnerExcEquipBreak:21020,$$ExcEquipDetails:21021,$$ExcEquipDetailsTips:21025,$$PartnerTalentInfo:21022,$$EquipDetails:21023,$$EquipDetailsTips:21024,$$PartnerAwaken:21026,$$PartnerAwakenSkill:21027,$$PartnerCombine:21028,$$PartnerElementFettersTips:21029,$$GuajiUp:21030,$$QuickBattle:21031,$$QuickBattleAward:21032,$$ShenQi:21300,$$ShenQiActive:21301,$$ShenQiJinJie:21302,$$ShenQiJingLian:21303,$$ShenQiBattle:21304,$$CommonSkillTips:21305,$$ShenQiStar:21306,$$ShenQiBless:21307,$$ShenQiBlessMaster:21308,$$ShenQiBlessLock:21309,$$ShenQiStarSkillTips:21310,$$ShenQiStarSuccess:21311,$$PlayBackFormation:21200,$$PlayBackFormationCombine:21201,$$TitleReward:21060,$$AwardShowTip:21040,$$AwardPreviewTip:21041,$$Hunlu:21100,$$HunluHunka:21101,$$HunluAchievement:21102,$$HunluZhuhun:21103,$$HunluSpriteStat:21104,$$HunluAward:21105,$$HunluQiuzeng:21106,$$HunluSelect:21107,$$HunluZengSong:21108,$$EquipForgeAlertSet:22e3,$$EquipForgeLvUpTips:22001,$$EquipForgeAttrTips:22002,$$ZhenXing:21600,$$ZhenXingActive:21601,$$ZhenXingLv:21602,$$ZhenXingStar:21603,$$ZhenXingDetail:21604,$$ZhenXingStarTips:21605,$$ZhenXingAttrItem:21606,$$Reborn:21401,$$SellSubpage:21402,$$RebornSelect:21403,$$Foster:21410,$$Mount:21411,$$Wing:21412,$$Shenhun:21413,$$Zhanji:21414,$$Halo:21415,$$FosterChase:21416,$$FosterAttrItem:21417,$$FosterFetters:21418,$$FosterFettersUpgrade:21419,$$FosterInfo:21420,$$FosterUpgrade:21421,$$FosterUpStar:21422,$$FosterUpStarSuccess:21423,$$FosterSkill:21424,$$JuLing:21430,$$JuLingPreview:21431,$$JuLingUnlockTips:21432,$$JuLingFast:21433,$$KeYin:21440,$$KeYinPreview:21441,$$KeYinActivateTips:21442,$$YuHua:21450,$$MyMap:21500,$$PartnerMap:21501,$$PartnerMapBox:21502,$$RewardsShow:21510,$$StarUpTips:21520,$$MainUITopFightAmount:21530,$$MoneyCat:21540,$$MoneyCatLogItem:21541,$$DailyDeal:21545,$$ContinuousConsume:21550,$$PartnerGift:21555,$$StarSoul:21700,$$XunBao:21800,$$NickNameSkin:23e3,$$FashionSkin:23001,$$MountSkin:23002,$$WeaponSkin:23003,$$WingSkin:23004,$$SurfaceStat:23005,$$RecruitPreView:23050,$$RecruitSubPreView1:23051,$$RecruitSubPreView2:23052,$$RecruitSubPreView3:23053,$$RecruitSubPreView4:23054,$$Recruit:23055,$$RecruitMain:23056,$$RecruitSubA:23057,$$RecruitSubB:23058,$$RecruitShowItem:23059,$$RecruitElement:23060,$$RecruitAlert:23061,$$WarOrderMain:24e3,$$WarOrder:24001,$$WarOrderDailyTask:24002,$$WarOrderWeeklyTask:24003,$$WarOrderQuarterTask:24004,$$WarOrderSupreme:24005,$$WarOrdeBuyLevel:24006,$$OpenSerCarnival:24100,$$WeekActivity:24101,$$Story:24200,$$MobileBind:24201,$$OpenServCR:25001,$$OpenServBuqianAlert:25002,OpenCompetition:25010,OCRank:25011,OCRankAward:25012,$$VipActivity:25100,$$VipActivityDay:25101,$$VipActivityWeek:25102,$$VipActivityForever:25103,$$SurpriseScratch:25120,$$Scratch:25121,$$ScratchRank:25122,$$ScratchRankReward:25123,$$ScratchLuckyRecord:25124,$$ScratchRecord:25125,$$RecruitRebate:25200,$$Shell:25210,$$ShellAward:25211,$$Coffers:25300,$$QqRedPacket:25400,$$QqRedPacketCarry:25401,$$ValueRebate:25500,$$ValueRebateReward:25501,$$BoonRecharge:25600,$$RoleLvUp:25700,$$PartnerSkin:25800,$$PartnerSkinActive:25801,$$RecRecovery:26910,$$RecRecoveryAlert:26911,$$OneYuanBuy:26920,$$ElementTips:25805,$$HuntingMain:25900,$$HuntingContest:25901,$$HuntingTask:25902,$$HuntingGift:25903,$$HuntingPartner:25904,$$HuntingScoreReward:25905,$$HuntingContestRank:25906,$$EquipZhuling:26e3,$$EquipFuse:26100,$$EquipFuseStarSkillTips:26101,$$ZhuanJi:26200,$$ZhuanJiBattle:26201,$$ZhuanJiTimesTips:26202,$$ZhuanJiBoxTips:26203,$$ZhuanJiBattleTips:26204,$$ZhuanJiResetTimesTips:26205,$$TribalResearch:26300,$$TribalBattle:26301,$$TribalSurvival:26302,$$TribalSkillSpeed:26303,$$TribalAssist:26304,$$TribalSkillDetails:26305,$$TribalSkillTips:26306,$$PushTip:26400,$$DayOrWeekGift:26900,$$NewFirstCharge:26930,$$NewFirstChargeGuide:26931,$$RecruitPartner:27e3,$$MainInstanceReward:27100,$$Explore:27500,$$ExploreShop:27501,$$ExploreTurnCard:27502,$$ExploreBattle:27503,$$ExploreSelectBuff:27504,$$ExploreMysticalEvent:27505,$$ExploreBuy:27506,$$ExploreLevelBox:27507,$$ExploreAwardShow:27508,$$ExploreNew:27509,$$OCCompetitionBase:25013,$$OpenCompetitionNew:25014,$$OCRankNew:25015,$$OCRankAwardNew:25016,$$PartnerSkillInfoTips:28e3,$$WelfareTarget:28001,$$WanFaZhiYin:28010,$$PrivilegeShop:28100,$$MaterialGrade:28020,$$Barbarian:28200,$$BarbarianDifficulty:28201,$$BarbarianLayerAward:28202,$$BarbarianSweep:28203,$$BarbarianAddAttr:28204,$$BarbarianBuffSelect:28205,$$BarbarianAwardPreview:28206,$$BarbarianDieGifs:28207,$$BarbarianResult:28208,$$BarbarianLayerGet:28209,$$BarbarianRank:28210,$$BarbarianCloudTween:28211,$$MapAchieve:25021,$$MapAchieveRank:25022,$$MapAchieveLvUp:25023,$$MapAchieveLvPop:25024,$$MapAchieveLevel:25025,$$MapAchieveAllAttr:25026,$$MapAchieveActivaSucc:25027,$$MapAchieveValuePop:25028,$$PartnerBack:29e3,$$PartnerBackList:29001,$$PartnerBackChip:29002,$$PartnerBackOp:29003,$$PartnerBackUpgrade:29004,$$PartnerBackBreak:29005,$$PartnerBackStar:29006,$$PartnerBackSpirit:29007,$$PartnerBackTalent:29008,$$PartnerBackBreakTips:29009,$$PayGuideCondition:29100,$$PayGuidePreview:29101,$$LoadActiveShow:29200,$$BattleDetails:29300,$$RechargeHall:29400,$$GuildConflictMain:3e4,$$GuildConflictSeasonStage:30002,$$GuildConflictBuyGoods:30003,$$GuildConflictGather:30004,$$GuildConflictTask:30005,$$GuildConflictWarSitua:30006,$$GuildConflictRank:30007,$$GuildConflictOccupyRank:30008,$$GuildConflictCity:30009,$$GuildConflictAddPower:30010,$$GuildConflictCityMove:30012,$$GuildConflictBuyFoods:30013,$$GuildConflictBattle:30014,$$GuildConflictSweep:30015,$$GuildConflictResult:30016,$$GuildConflictBattleLog:30017,$$GuildConflictRival:20018,$$GuildConflictEnemie:20019,$$GuildConflictMarsRank:20020,$$GuildConflictRichRank:20021,$$GuildConflictOccupyRew:20022,$$GuildConflictCityOccupy:20023,$$GuildConflictFail:30024,$$GuildConflictSeaSettle:30025,$$GuidConflictChat:30026,$$GuildInstance:29500,$$GuildInstanceRank:29501,$$GuildInstanceAward:29502,$$RecruitSelectMain:29503,$$RecruitSelect:29504,$$TodayAlert:29505,$$DailyWish:29600,$$DailyWishAward:29601,$$DailyWishTasks:29602,$$DailyWishGifts:29603,$$DailyWishShop:29604,$$ExchangePanel:29700,$$ExchangeWelfare:29701,$$ExchangeDrop:29702,$$ExchangeTask:29703,$$ExchangeConvert:29704,$$ExchangeDiscount:29705,$$PartnerHelpBase:30100,$$PartnerHelpArmy:30101,$$PartnerHelpArmySelect:30102,$$PartnerHelpArmyChain:30103,$$FosterEquip:30200,$$FosterEquipInfo:30201,$$FosterEquipIntensify:30202,$$FosterEquipUpstar:30203,$$FosterEquipRefine:30204,$$FosterEquipWear:30205,$$FosterEquipDetail:30206,$$ShenhunEquip:30207,$$MountEquip:30208,$$LimitSalePrize:30300,$$OptionalLottery:30310,$$OptionalLotterySelect:30311,$$OptionalLotteryValue:30312,$$OptionalLotteryShop:30313,$$OptionalLotteryTask:30314,$$OptionalLotteryFinally:30315,$$OptionalLotteryReward:30316,$$Mibao:30400,$$MibaoTask:30401,$$MibaoScoreAward:30402,$$MibaoRank:30403,$$MibaoGift:30404,$$MibaoExpect:30405,$$MibaoCash:30406,$$MibaoAccess:30407,$$BossShowView:1036,$$QQVideo:32e3,$$HuntingLimitedGift:30510,SpecialWarToken:30500,$$GodAnimalPanel:30600,$$GodAnimalMain:30601,$$GodAnimalUpgrade:30602,$$GodAnimalStar:30603,$$GodAnimalChange:30604,$$GodAnimalExChange:30605,$$GodAnimalEquipTips:30606,$$GodAnimalBag:30607,$$GodAnimalBagList:30608,$$GodAnimalBagChip:30609,$$GodAnimalBagOp:30610,$$GodAnimalBook:30611,$$GodAnimalDetails:30612,$$GodAnimalSkillInfoTip:30613,$$GodAnimalEquipBag:30614,$$GodAnimalWearStrong:30615,$$GodAnimalBagStrong:30616,$$GodAnimalSkillTip:30617,$$GodAnimalBagUpgrade:30618,$$GodAnimalBagStar:30619,$$GodAnimalActive:30620,$$GodAnimalStarTips:30621,$$GuildNewBoss:31e3,$$GuildNewBossSkill:31001,$$GuildNewBossAward:31002,$$GuildNewBossLog:31003,$$TopNotice:32001,$$AoyiEnchDetail:33001,$$AoyiEnchUnlockSuccess:33002,$$AoyiExpand:33003,$$AoyiRuneInsertSuccess:33004,$$AoyiRuneInsert:33005,$$AoyiRune:33006,$$AoyiEnch:33007,$$ChatPlayerPartnerInfo:34e3,$$ChatPartnerSpriteStat:34001,$$ChatSkillInfoTips:34002,$$QmStar1:34100,$$QmStar2:34101,$$PartnerFetter:35e3,$$PartnerSkillInfoTips2:35001,$$PartnerQualityFetterTips:35002,$$PartnerUpFetter:35003,$$PartnerUpStar:35004,$$HomeRightTop:36e3}),b8e.module.ME=e,b8e.RC("$$game","$$ME",e)}(),function(){var t=void 0;(t=b8e.SkinWidget.extends({ctor:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this.absPath=a,e&&!b8e.StringUtil.isNumber(e)&&(e=this.getUIUrl(e)),this._super(e)},show:function(){var e=this;if(e.urlId){var t=game.UIUrl.get(e.urlId);-1<(t=e.getUIUrl(t)).indexOf(".bui")?e.setBuiUrl(t):e.setPreUrl(t)}e._super()},getUIUrl:function(e){return this.absPath||(e=t.SKIN_ROOT_PATH?t.SKIN_ROOT_PATH+e:e),e+".bui"}})).SKIN_ROOT_PATH="app/module/",b8e.RC("$$game","$$Widget",t)}(),function(){var e;e=game.Widget.extends({_showModel:!1,_popLv:0,_modelTouchClose:!0,addNodeTouch:!1,_mutex:0,_layout:0,_showType:0,showType:0,offsetX:0,offsetY:0,ctor:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this._super(e,a),this.addNodeTouch=!0},addSpotAlert:function(){var e=this;if(e.spotAlerts&&!e._setSpotAlert){var t=void 0,a=void 0;for(var i in e.spotAlerts)(t=b8e.getDPV(game.SAE,i))?(a=e.spotAlerts[i])?game.spotAlert.setCb(t,a,e):b8e.error("spotAlert\u4e0d\u5b58\u5728\u6307\u5b9a\u56de\u8c03\u65b9\u6cd5",i):b8e.error("spotAlertEnum \u4e0d\u5b58\u5728\u679a\u4e3e",i);e._setSpotAlert=!0}},rmvSpotAlert:function(){var e=this;if(e.spotAlerts&&e._setSpotAlert){var t=void 0,a=void 0;for(var i in e.spotAlerts)t=b8e.getDPV(game.SAE,i),a=e.spotAlerts[i],game.spotAlert.delCb(t,a,e);e._setSpotAlert=!1}},_addToggle:function(){var e=this;if(!e._toggle&&e.toggles){var t=void 0,a=void 0,i=void 0,n=[];for(var s in e.toggles)(t=e.getComponent(s))?(a=e.toggles[s],(i=b8e.createMap()).t=t,i.m=a,n.push(i)):b8e.error("\u8bd5\u56fe\u6dfb\u52a0\u4e0d\u5b58\u5728\u7684toggle target",e.moduleEnum,s);e._toggle=new b8e.Toggle,e._toggle.init(n),e._toggle.onSelectCheck(e._selectToggleCheck,e),e._toggle.onSelectChange(e._toggleSelect,e),e._toggle.onHide(e._toggleHide,e)}},_selectToggleCheck:function(e){return!!e&&(!e||!e.m||game.moduleOpen.checkOpenWithTips(e.m))},_toggleSelect:function(e,t){t&&t.m&&game.module.hideTab(t.m),e&&e.m&&game.module.showTab(e.m,this.moduleEnum)},_toggleHide:function(e){e&&e.m&&game.module.hideTab(e.m)},toggleSelect:function(e){if(this._toggle){var t=this.getToggleIndex(e);return!(t&&!game.moduleOpen.checkOpenWithTips(t))&&(this._toggle.select(e),!0)}return b8e.error("\u6ca1\u6709\u542f\u7528toggle"),!1},getToggleIndex:function(e){var t=this;if(!t.toggles)return null;if(t.toggleMeEnums&&0<t.toggleMeEnums.length)return t.toggleMeEnums.length>e?t.toggleMeEnums[e]:null;t.toggleMeEnums=[];var a=void 0;for(var i in t.toggles)a=t.toggles[i],t.toggleMeEnums.push(a);return t.toggleMeEnums.length>e?t.toggleMeEnums[e]:null},hide:function(){var e=this;b8e.Tween.kill(e),e._toggle&&e._toggle.hide(),e.rmvSpotAlert(),b8e.evt.rmvG(e,b8e.Event.STAGE_RESIZE,e.onStageResize),e._super(),e._popLv&&e._popLv,e.removeModuleMask(),game.module.removeOpenModule(e)},show:function(){this._super(),game.SoundEffectMgr.inst().playViewSound(this.moduleEnum,game.SoundEffectType.SoundTypeViewOpen)},_initShow:function(){var e=this;e.addNodeTouch&&e.skin&&b8e.evt.onC(e.skin.node,e.onTouchNode,e),e._addToggle()},_preShow:function(){var e=this;if(e.moduleEnum){var t=game.ViewPropsCfg.getData(e.moduleEnum,!1,!1);t&&(e._layout=t.layout,e._mutex=t.mutex,e._showModel=!!t.showModal,e._popLv=t.popLv,e._showType=t.showType)}if(e.onStageResize(),e.__isShow&&b8e.evt.addG(e,b8e.Event.STAGE_RESIZE,e.onStageResize),e._popLv&&e._popLv,e.addModuleMask(),e.isTweenOver=!1,e.hideTweenOver=!0,e._showType&&1==e._showType){e.scaleX=.6,e.scaleY=.6;var a=e.x,i=e.y;e.x=e.width/2*(1-e.scaleX)+e.x,e.y=e.y-e.height/2*(1-e.scaleY),b8e.Tween.get(e).to({x:a,y:i,scaleX:1,scaleY:1},300,b8e.Ease.backOut).call(e.tweenOver,e)}e._toggle&&e._toggle.defaultSelect(),e.addSpotAlert()},tweenOver:function(){b8e.Tween.kill(this),this.isTweenOver=!0},addModuleMask:function(){this._showModel&&(game.viewModule.addModule(this),game.mainTopByFightAmount.addModule(this))},removeModuleMask:function(){this._showModel&&(game.mainTopByFightAmount.removeModule(this),game.viewModule.removeModule(this))},onStageResize:function(){var e=this,t=b8e.stageWidth,a=b8e.stageHeight,i=0,n=0,s=game.LayoutType;switch(e._layout){case s.CENTER:a-=163,i=(t-e.width>>1)+e.anchorX*e.width,n=e.anchorY*e.height+(a-e.height>>1)+113;break;case s.TOP:i=(t-e.width>>1)+e.anchorX*e.width,n=(e.anchorY-1)*e.height+a;break;case s.BOTTOM:i=(t-e.width>>1)+e.anchorX*e.width,n=e.anchorY*e.height;break;case s.LEFT:i=e.anchorX*e.width,n=e.anchorY*e.height+(a-e.height>>1);break;case s.RIGHT:i=t-(1-e.anchorX)*e.width,n=e.anchorY*e.height+(a-e.height>>1);break;case s.LEFT_TOP:i=e.anchorX*e.width,n=(e.anchorY-1)*e.height+a;break;case s.RIGHT_TOP:i=t-(1-e.anchorX)*e.width,n=(e.anchorY-1)*e.height+a;break;case s.LEFT_BOTTOM:i=e.anchorX*e.width,n=e.anchorY*e.height;break;case s.RIGHT_BOTTOM:i=t-(1-e.anchorX)*e.width,n=e.anchorY*e.height}i+=e.offsetX,n+=e.offsetY,e.setPosition(i,n)},getModelTouchClose:function(){if(this.moduleEnum){var e=game.ViewPropsCfg.getData(this.moduleEnum,!1,!1);e&&(this._modelTouchClose=!!e.touchModalClose)}return this._modelTouchClose},onTouchNode:function(){},closeBtn:function(){this.tweenHide()},returnBtn:function(){this.tweenHide()},tweenHide:function(){this.hideView()},hideView:function(){this.hideTweenOver=!0,game.module.hide(this.moduleEnum)}}),b8e.RC("$$game","$$View",e)}(),function(){var e;(e=b8e.ScrollList.extends({_option:null,ctor:function(e,t){this._super(e,t)},setScrollParams:function(e){var t=this;if(e&&e.thisArg)t._option=e;else{var a=e,i=a.skin,n=i.frontBtn,s=i.afterBtn,o=i.frontAlert,r=i.afterAlert;t._option=b8e.createMap(),t._option.thisArg=a,t._option.func=a.func,t._option.frontBtn=n,t._option.afterBtn=s,t._option.frontAlert=o,t._option.afterAlert=r,t._option.time=a.time}t._option.frontBtn||b8e.warn("List.setScrollParams \u7f3a\u5c11 frontBtn \u6309\u94ae\uff01\uff01\uff01"),t._option.afterBtn||b8e.warn("List.setScrollParams \u7f3a\u5c11 afterBtn \u6309\u94ae\uff01\uff01\uff01"),t.setScrollViewCb(t._scrollFunc,t),t._registerEvent()},_registerEvent:function(){var e=this;if(e._option){var t=e._option;t.frontBtn&&(b8e.evt.onC(t.frontBtn,e.onFrontCb,e),b8e.evt.addButtonHandler(t.frontBtn)),t.afterBtn&&(b8e.evt.onC(t.afterBtn,e.onAfterCb,e),b8e.evt.addButtonHandler(t.afterBtn))}},_unregisterEvent:function(){var e=this;if(e._option){var t=e._option;t.frontBtn&&(b8e.evt.offC(t.frontBtn,e.onFrontCb,e),b8e.evt.removeButtonHandler(t.frontBtn)),t.afterBtn&&(b8e.evt.offC(t.afterBtn,e.onAfterCb,e),b8e.evt.removeButtonHandler(t.afterBtn))}},onFrontCb:function(){var e=this,t=e._option;e._scrollType==b8e.ScrollBoxType.Horizontal?e.scrollContainerLeft(t&&t.time):e._scrollType==b8e.ScrollBoxType.Vertical&&e.scrollContainerTop(t&&t.time)},onAfterCb:function(){var e=this,t=e._option;e._scrollType==b8e.ScrollBoxType.Horizontal?e.scrollContainerRight(t&&t.time):e._scrollType==b8e.ScrollBoxType.Vertical&&e.scrollContainerBottom(t&&t.time)},_scrollFunc:function(e,t,a){if(this._option){var i=this._option;if(i&&i.func&&i.thisArg&&i.func.call(i.thisArg,e,t,a),i.frontBtn&&i.afterBtn){var n=0,s=!1,o=!1;if(s=0<(n=e.length),i.frontBtn.active=s,i.frontAlert){if(s)for(var r=0;r<n;r++)if(e[r].isAlert){o=!0;break}i.frontAlert.active=o}if(s=0<(n=a.length),i.afterBtn.active=s,i.frontAlert){if(s)for(var g=0;g<n;g++)if(a[g].isAlert){o=!0;break}i.afterAlert.active=o}}}},onStageResize:function(e,t){if(e&&t){var a=this;if(a.width!=e||a.heigth!=t){a.width=e,a.heigth=t;var i=a.getContainer();i&&(i.width=e,i.heigth=t,a.callLayout())}}},dispose:function(){this._unregisterEvent(),this._super()}})).poolCall=!0,b8e.RC("$$game","$$List",e)}(),function(){var e;e=b8e.ListItem.extends({ctor:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this.absPath=a,e&&!b8e.StringUtil.isNumber(e)&&(e=this.getUIUrl(e)),this._super(e)},show:function(){var e=this;if(e.urlId){var t=game.UIUrl.get(e.urlId);-1<(t=e.getUIUrl(t)).indexOf(".bui")?e.setBuiUrl(t):e.setPreUrl(t)}e._super()},getUIUrl:function(e){return this.absPath||(e=game.Widget.SKIN_ROOT_PATH?game.Widget.SKIN_ROOT_PATH+e:e),e+".bui"}}),b8e.RC("$$game","$$ListItem",e)}(),function(){var e;e=game.Widget.extends({_addNodeTouch:!1,_isBlackBG:!0,_modalNode:null,isShow:{get:function(){return!!this.parent}},ctor:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this._super(e,a)},onShow:function(){if(this._showTween){this._showTween()}this.showModal(),this.__onStageResize()},_initShow:function(){this.initModal()},initModal:function(){var e=this;e._modalNode=b8e.Graphics.get(),e._modalNode.setAnchor(0,1),b8e.evt.onC(e._modalNode,e.onTouchNode,e)},showModal:function(){var e=b8e.LayerMgr.inst().getGuiTopLayer();if(e){e.addChild(this._modalNode)}else b8e.error("gui layer is null or underfined");var t=this.getLocalZOrder()-1;this._modalNode&&(this._modalNode.setLocalZOrder(t),this._modalNode.setVisible(!0))},hideModal:function(){var e=b8e.LayerMgr.inst().getGuiTopLayer();if(e){e.removeChild(this._modalNode)}else b8e.error("gui layer is null or underfined");var t=this.getLocalZOrder()-1;this._modalNode&&(this._modalNode.setLocalZOrder(t),this._modalNode.setVisible(!1))},showPopView:function(){if(this.parent)this.show();else{b8e.LayerMgr.inst().getGuiTopLayer().addChild(this)}},hidePopView:function(){this.removeFromParent(),this.hideModal()},__onStageResize:function(){var e=this,t=b8e.stageWidth,a=b8e.stageHeight;if(e._modalNode.clear(),e._isBlackBG){this._modalNode.fillColor(2991936853)}else e._modalNode.fillColor(0);e._modalNode.fillRect(0,0,t,a),e._modalNode.setSize(t,a),e._modalNode.setPosition(0,a-43)},onTouchNode:function(){this.hidePopView()}}),b8e.RC("$$game","$$GamePopView",e)}(),function(){var t=void 0;(t=b8e.BaseDisplay.extends({ctor:function(){var e=this;e._super(),e.reset(),b8e.evt.addButtonHandler(e),b8e.evt.onC(e,e.fnOnClickGrid,e)},setData:function(e){var t=this;if(e&&(t.btnInfo=e,t.setSize(e.width,e.height),e.cfg)){var a=e.getUrl();t.addIcon(),t.setIcon(a,e);var i=e.getEffData();if(t.addEffect(i.effect,i.effectOffectX,i.effectOffectY),t.addCountDown(),t.addLabel(),t.btnInfo.spotAlertEnum){0!=t.spotAlertEnum&&t.spotAlertEnum!=t.btnInfo.spotAlertEnum&&t.unbindAlert(t.spotAlertEnum),t.spotAlertEnum=t.btnInfo.spotAlertEnum;var n=game.spotAlert.get(t.spotAlertEnum);n?t.updateAlert(n):t.setRedIcon(!1),t.bindAlert()}else t.unbindAlert(t.spotAlertEnum),t.setRedIcon(!1),t.spotAlertEnum=0}},unbindAlert:function(e){this._bindAlert&&(game.spotAlert.delCb(e,this.updateAlert,this),this._bindAlert=!1)},addIcon:function(){var e=this;e._iconImg||(e._iconImg=b8e.Sprite.get(),e._iconImg.setVisible(!1)),e._iconImg&&!e._iconImg.parent&&e.addChild(e._iconImg);var t=e._redIcon;if(!t){(t=e._redIcon=b8e.Sprite.get()).setAnchor(.5,.5);var a=game.ResCfg.getImgUrl("icon/redIcon");t.loadTexture(a,null,null),t.setVisible(!1)}t.parent||e.addChild(t);var i=e._tagIcon;if(e.btnInfo&&e.btnInfo.cfg&&e.btnInfo.cfg.tagIcon){i||((i=e._tagIcon=b8e.Sprite.get()).setAnchor(.5,1),i.setPosition(12,e.btnInfo.cfg.iconHeight-13)),i.parent||(e.addChild(i),i.setLocalZOrder(100));a=game.ResCfg.getUrl(10224,e.btnInfo.cfg.tagIcon);i.loadTexture(a,null,null)}else i&&i.parent&&(i.unloadTexture(),i.removeFromParent())},addCountDown:function(){var e=this,t=e.btnInfo;if(t.countDown&&!(t.countDown<1)||t.cfg.activeBarType==game.ActiveBarItemType.ONLINEGIFT||t.activeBarType==game.ActiveBarItemType.WELFARETARGET)if(e._timeLab||(e._timeLab=b8e.Label.get(),e._timeLab.setFontFile(b8e.ResMgr.UI_ROOT+"/app/font/countdown/countdown.bbf"),e._timeLab.setFontSize(21),e._timeLab.setLineHeight(22),e._timeLab.setAnchor(.5,1),e._timeLab.setPosition(t.width>>1,6)),e._timeLab&&!e._timeLab.parent&&e.addChild(e._timeLab),e._timeLab.setVisible(!0),t.activeBarType==game.ActiveBarItemType.WELFARETARGET){var a=game.welfareTargetData.curCfg;e._timeLab.setText(a?a.desc:"")}else e._timeLab.setText(b8e.TimeUtil.formatTime(t.countDown)),e.createCountDownTimer();else e._timeLab&&e._timeLab.setVisible(!1)},addLabel:function(){var e=this,t=e.btnInfo;t.labString<1?e._strLab&&e._strLab.setVisible(!1):(e._strLab||(e._strLab=b8e.Label.get(),e._strLab.setColor(4278255360),e._strLab.setFontSize(16),e._strLab.setLineHeight(17),e._strLab.setStroke(1,4278190080),e._strLab.setAnchor(.5,1),e._strLab.setPosition(t.width>>1,5)),e._strLab&&!e._strLab.parent&&e.addChild(e._strLab),e._strLab.setVisible(!0),e._strLab.setText(t.labString),!t.countDown||t.countDown<1||t.actStartTime<1?e._timeLab&&e._timeLab.setVisible(!1):t.countDown<t.actStartTime?(e._strLab.setVisible(!1),e._timeLab.setVisible(!0)):t.countDown>=t.actStartTime&&(e._strLab.setVisible(!0),e._timeLab.setVisible(!1)))},addEffect:function(e,t,a){var i=this;if(e){var n=i.btnInfo;if(!i._effect){i._effect=b8e.Animator.get(game.AnimType.UI_EFFECT,1);var s=(n.width>>1)+t,o=(n.height>>1)+a;i._effect.setPosition(s,o),i._effect.setAnchor(.5,.5)}i._effect&&!i._effect.parent&&(i.addChild(i._effect),i._redIcon&&i._redIcon.parent&&i._redIcon.removeFromParent(),i.addChild(i._redIcon)),i._effect.load(game.ResCfg.getUrl(5019,e)),i._effect.play()}else i._effect&&i._effect.removeFromParent()},rmvCountDown:function(){this._timeLab&&this.btnInfo.cfg.activeBarType!=game.ActiveBarItemType.ONLINEGIFT&&this._timeLab.setVisible(!1),this.clearCountDownTimer()},createCountDownTimer:function(){var e=this;e._timer||(e._timer=b8e.Timer.add(e,e.updateTime,1e3)),e._lastTime=b8e.timeStamp,e._timer.reset(),e._timer.start()},clearCountDownTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){var e=this,t=e.btnInfo;if(t)if(t.countDown){var a=b8e.timeStamp,i=a-e._lastTime;e._lastTime=a,t.countDown-=i,t.countDown<1&&e.rmvCountDown(),t.countDown<t.actStartTime&&(e._strLab&&e._strLab.setVisible(!1),e._timeLab.setVisible(!0)),e._timeLab&&e._timeLab.setText(b8e.TimeUtil.formatTime(t.countDown))}else e.rmvCountDown()},bindAlert:function(){var e=this;e._bindAlert||(game.spotAlert.setCb(e.spotAlertEnum,e.updateAlert,e),e._bindAlert=!0)},updateAlert:function(e){var t=this;if(e){t.setRedIcon(e.alert);var a=t.btnInfo;if(a&&a.miscData&&(3==a.miscData.id||4==a.miscData.id)){if(b8e.module.isShowView(game.ME.HomeRightBar))return;var i=game.homeLeftBarData.spotAlertTime,n=game.SysTime.curTime;if(n<i){if(!b8e.hasTimeout(t._refreshHomeSpotAlert,t)){var s=i-n;b8e.setTimeout(t._refreshHomeSpotAlert,t,s)}return}game.homeLeftBarData.spotAlertTime=game.SysTime.curTime+500,t._refreshHomeSpotAlert()}}else t.setRedIcon(!1)},_refreshHomeSpotAlert:function(){var e=b8e.module.isShowView(game.ME.HomeRightBar),t=b8e.module.isShowView(game.ME.Home);if(!e&&t){var a=b8e.module.getView(game.ME.Home);if(a.skin&&a.skin.shrink_red_spot){var i=void 0;(i=this.getMenuSpotAlert(game.homeRightBarData))?a.skin.shrink_red_spot.active=!0:(i=this.getMenuSpotAlert(game.homeBottomBarData),a.skin.shrink_red_spot.active=i)}}},getMenuSpotAlert:function(e){var t=e.getBtns();if(t&&0<t.length)for(var a=void 0,i=void 0,n=t.length,s=0;s<n;s++)if((a=t[s].spotAlertEnum)&&(i=game.spotAlert.get(a))&&i.alert)return!0;return!1},setIcon:function(e,t){var a=this;if(""==e)return a._iconImg&&a._iconImg.setVisible(!1),void a._redIcon.setPosition(a.btnInfo.width-12,a.btnInfo.height-15);a._iconResName!=e?(a._iconImg.setVisible(!1),a._iconImg.setVisible(!0),a._iconResName=e,a._iconImg.setPosition(t.offsetX,t.offsetY),a._iconImg.loadTexture(a._iconResName,a.onComplete,a)):a._iconImg&&a._iconImg.setVisible(!0)},onComplete:function(){this._redIcon&&this._redIcon.setPosition(this._iconImg.width-12,this._iconImg.height-20)},setRedIcon:function(e){var t=0<arguments.length&&void 0!==e&&e;this._redIcon&&this._redIcon.setVisible(t)},onClickShrinkIcon:function(){var e=this.btnInfo;if(e){var t=e.miscData;t&&b8e.module.sendToView(t.menuModuleEnum,[game.ActiveBarEvts.V2V_CHANGE_SHRINK_STATE,!e.isShrink])}},fnOnClickGrid:function(){var e=this;if(e.btnInfo){var t=e.btnInfo.cfg,a=e.btnInfo.miscData,i=t.activeBarType,n=game.ActiveBarItemType,s=void 0;switch(0<t.parentId&&b8e.module.isShowView(game.ME.ActiveChildren)&&game.module.hide(game.ME.ActiveChildren),i){case n.SWITCH_ACCOUNT:game.sdk.logout();break;case n.TODAY_FUNC_NOTICE:var o=game.funcNoticeData.getCurDayCfg();if(!o||!o.moduleEnum)return;var r=o.moduleEnum;if(0<o.toggleIndex){var g=o.toggleIndex-1;game.module.showToggle(r,g)}else game.module.show(r);break;case n.SHRINK_BTN:e.onClickShrinkIcon();break;case n.CHAIN_GIFT:game.chainGiftData.selectGroup(t.type),game.module.show(game.ME.ChainGiftMain);break;case n.QUEST_LINK:var l=+game.LoginConfig.gameChannelId,c=game.QuestLinkCfg.getData(l);if(!c)return;e.createQuestLink(c.url);break;case n.LUCKY_TURNPLATE_LIST:s=e.localToGlobal(),game.activeBarData.setLuckyTurnPos([s.x,s.y]),game.module.show(t.moduleEnum);break;case n.LUCKY_TURNPLATE:b8e.evt.dptG(game.XunBaoEvts.C2C_SHOW_XUNBAO,t.luckyId);break;default:if(t.isParentBtn)return game.activeChildrenData.setActiveBtn(a.id,t.id,e),void game.module.show(game.ME.ActiveChildren);if(0<t.actId&&0==t.actType)return game.timeLimitPrizeData.setActId(t.actId),void game.module.show(game.ME.TimeLimitPrize);if(0<t.shopEntrance)return void b8e.evt.dptG(game.ShopGEvts.SHOW_ENTRANCE,t.shopEntrance);if(0<t.openServerType)return e.obj||(e.obj={openServerType:t.openServerType,type:t.type}),e.obj.type=t.type,void b8e.evt.dptG(game.OpenServerGEvts.C2C_SHOW_OPENSERVER,e.obj);if(0<t.welfareId)return void game.module.showToggle(game.ME.Welfare,t.welfareId);if(t.isFestival&&(game.festivalData.setOriginMenu(i),game.module.show(t.moduleEnum)),0<t.isNotOpenUI)b8e.evt.dptG(game.MainUIEvts.NOT_OPEN_UI,t.moduleEnum);else if(0<t.toggleIndex){var h=t.toggleIndex-1;game.module.showToggle(t.moduleEnum,h)}else game.module.show(t.moduleEnum)}}},clearData:function(){var e=this;e._iconImg&&e._iconImg.removeFromParent(),e._redIcon&&e._redIcon.removeFromParent(),e._timeLab&&e._timeLab.removeFromParent(),e._strLab&&e._strLab.removeFromParent(),e._tagIcon&&e._tagIcon.removeFromParent(),e.spotAlertEnum&&e._bindAlert&&(e._bindAlert=!1,game.spotAlert.delCb(e.spotAlertEnum,e.updateAlert,e),e.spotAlertEnum=0),e._effect&&e._effect.removeFromParent(),e.btnInfo=null,e.alert=!1,e.clearCountDownTimer()},createQuestLink:function(e){if("undefined"!=typeof document){var t=document.getElementById("gameContainer");if(t){var a=document.createElement("div"),i=!1;if(void 0!==window.navigator&&window.navigator.userAgent){var n=window.navigator.userAgent.toLowerCase();if(n)i=!!n.match(/ipad/i)}a.id="questLink",(!b8e.isMobile||b8e.isMobile&&b8e.os!==b8e.OS.IOS||i)&&(a.style.width="100%",a.style.height="100%"),a.style.backgroundColor="white",a.style.position="absolute",a.style.top=0,a.style.overflowX="hidden",a.style.overflowY="hidden",t.parentNode.appendChild(a),a.innerHTML='<iframe id="questLinkFrame" src='+e+' width = 100% height = 95% scrolling = "yes"></iframe>';var s=document.createElement("input");s.id="questLinkCloseBtn",s.type="button",s.value=game.Lang.get(9373),s.style.position="relative",s.style.left="50%",s.style.top=0,a.appendChild(s),s.onclick=this.closeQuestLink}}},closeQuestLink:function(){var e=document.getElementById("questLink");e&&e.remove()},reset:function(){this.clearData()},restore:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},release:function(){t.put(this)},dispose:function(){this._super()},destroy:function(){this._super()}})).pool=new b8e.Pool(t,128),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},t.LAZY_IN_HIERARCHY=!0,t.BATCH_IN_HIERARCHY_NUM=1,b8e.RC("$$game","$$MenuBarItem",t)}(),function(){var e;e=game.View.extends({_barDatas:null,_miscId:0,ctor:function(e,t,a){var i=0<arguments.length&&void 0!==e?e:null,n=1<arguments.length&&void 0!==t?t:null,s=2<arguments.length&&void 0!==a?a:0,o=this;o._barDatas=n,o._miscId=s,o.btnPool=[],o._super(i),o.addNodeTouch=!1},init:function(){},notify:function(e,t){switch(e){case this.Evts.V_REFRESH_BTNS:this.refreshBtns();break;case game.ActiveBarEvts.V2V_CHANGE_SHRINK_STATE:this._barDatas.isShrink=t,this._delayRefresh()}},refreshBtns:function(){b8e.hasTimeout(this._delayRefresh,this)||b8e.setTimeout(this._delayRefresh,this,500)},_delayRefresh:function(){this._layout(),this._updatePosition()},_layout:function(){var e=this,t=game.GameBarMiscCfg.getData(e._miscId);if(t){e.btns=e._barDatas.getBtns();var a,i,n=t.showShrinkBtn,s=t.lineCount,o=t.iconWidth,r=t.rowCount,g=t.spacingX,l=t.spacingY,c=0,h=0,m=e.btns.length>e.btnPool.length?e.btns.length:e.btnPool.length;0<r&&(h=r<m?r*(t.iconHeight+l):m*(t.iconHeight+l));for(var u=0,d=0,f=0;f<m;f++)if(i=e.btns[f],a=e.btnPool[f],i){a||(a=game.MenuBarItem.get(),e.btnPool[f]=a),a.parent||e.addChild(a),a.setData(i),a.x=c+i.offsetX,a.y=h+i.offsetY,0<s?(f+1)%s==0?(c=0,h+=i.height+l):c+=o+g:(f+1)%r==0?(h=n&&i.activeBarType==game.ActiveBarItemType.SHRINK_BTN?r*(t.iconHeight+l):(r-1)*(t.iconHeight+l),c+=o+g):h-=i.height+l;var p=a.x+o+g,_=void 0;u<p&&(u=p),d<(_=0<r?r<m?r*(i.height+l):m*(i.height+l):a.y+i.height+l)&&(d=_),i.cfg.moduleEnum==game.ME.ManyFirstCharge&&game.manyFirstChargeData.setBtnPort(a)}else a&&a.removeFromParent();e.setSize(u,d)}},_updatePosition:function(){var e=this,t=0,a=0;if(e.parent){var i=game.GameBarMiscCfg.getData(e._miscId);i&&(0<i.marginLeft?t=i.marginLeft:0<i.marginRight&&(t=e.parent.width-i.marginRight-e.width),0<i.marginTop?a=-i.marginTop-e.height:0<i.marginBottom&&(a=-(e.parent.height-i.marginBottom))),e.setPosition(t,a)}},$$getActivityBtn:function(e){for(var t=0,a=this.btnPool.length;t<a;t++){var i=this.btnPool[t];if(i&&i.btnInfo&&i.btnInfo.cfg.id==e)return i}return null},onShow:function(){this._layout(),this._updatePosition(),this.send(this.Evts.V2C_REFRESH_VIEW_STATE)},onHide:function(){b8e.Tween.kill(this),this.send(this.Evts.V2C_REFRESH_VIEW_STATE)},onStageResize:function(){this._layout(),this._updatePosition()}}),b8e.RC("$$game","$$GameMenuBar",e)}();p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;e=game.Widget.extends({_showModel:!1,_modelTouchClose:!0,_addNodeTouch:!1,_offsetX:0,_offsetY:0,isNewMvc:!0,_event:null,_layout:0,_defaultToggleIndex:-1,_modelMap:null,ctor:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this._super(e,a),this._addNodeTouch=!0,this._event=new b8e.EventDispatcher},addSpotAlert:function(){var e=this;if(e.spotAlerts&&!e._setSpotAlert){var t=void 0,a=void 0;for(var i in e.spotAlerts)(t=b8e.getDPV(game.SAE,i))?(a=e.spotAlerts[i])?game.spotAlert.setCb(t,a,e):b8e.error("spotAlert\u4e0d\u5b58\u5728\u6307\u5b9a\u56de\u8c03\u65b9\u6cd5",i):b8e.error("spotAlertEnum \u4e0d\u5b58\u5728\u679a\u4e3e",i);e._setSpotAlert=!0}},rmvSpotAlert:function(){var e=this;if(e.spotAlerts&&e._setSpotAlert){var t=void 0,a=void 0;for(var i in e.spotAlerts)t=b8e.getDPV(game.SAE,i),a=e.spotAlerts[i],game.spotAlert.delCb(t,a,e);e._setSpotAlert=!1}},_registerModuleEvents:function(){this.moduleEvts&&!this.moduleEventsRegistered&&(this._operateModuleEvt(!0),this.moduleEventsRegistered=!0)},_unregisterModuleEvents:function(){this.moduleEvts&&this.moduleEventsRegistered&&(this._operateModuleEvt(!1),this.moduleEventsRegistered=!1)},_operateModuleEvt:function(e){var t=void 0,a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=void 0,l=this.moduleEvts;for(a in l)if(g=l[a],t=game.ME[a])if(i=b8e.module.getControl(t))if(r=i.Evts)for(n in g)(s=r[n])?(o=g[n])?e?this.addEventByModule(t,s,o):this.removeEventByModule(t,s,o):b8e.error("\u6a21\u5757id\u4e0d\u5b58\u5728\u6a21\u5757id\u7684\u4e8b\u4ef6\u56de\u8c03",this.moduleEnum,t):b8e.error("\u6a21\u5757id\u4e3a\u7684control\u6ca1\u6709\u7ed1\u5b9a\u7684\u4e8b\u4ef6\u679a\u4e3e",t,n);else b8e.error("\u6a21\u5757id\u4e3a\u7684control\u6ca1\u6709\u7ed1\u5b9a\u4e8b\u4ef6!!",t);else b8e.error("\u4e0d\u5b58\u5728\u6a21\u5757id\u4e3a\u7684control!!",t);else b8e.error("\u4e0d\u5b58\u5728\u6a21\u5757id\u4e3a\u7684\u6a21\u5757\u679a\u4e3e",t)},_registerMgrEvents:function(){this.mgrEvts&&!this.mgrEventsRegistered&&(this._operateMgrEvt(!0),this.mgrEventsRegistered=!0)},_unregisterMgrEvents:function(){this.mgrEvts&&this.mgrEventsRegistered&&(this._operateMgrEvt(!1),this.mgrEventsRegistered=!1)},_operateMgrEvt:function(e){var t=void 0,a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=void 0,l=void 0,c=this.mgrEvts,h=game.DataMgr.inst();for(t in c)if(l=c[t],a=h.getMgr(t))for(g in l)if(s=l[g],i=game[g])for(n in s)(o=i[n])?(r=s[n])?e?a.addEvent(o,r,this):a.removeEvent(o,r,this):b8e.error("\u4e0d\u5b58\u5728\u4e8b\u4ef6\u56de\u8c03!!"):b8e.error("\u4e8b\u4ef6\u679a\u4e3e\u4e0d\u5b58\u5728\u679a\u4e3e",g,n);else b8e.error("\u4e0d\u5b58\u5728\u4e8b\u4ef6\u679a\u4e3e\u7c7b",g)},_addToggle:function(){var e=this;if(!e._toggle&&e.toggles){var t=void 0,a=void 0,i=void 0,n=[];for(var s in e.toggles)(t=e.getComponent(s))?(a=e.toggles[s],(i=b8e.createMap()).t=t,(void 0===a?"undefined":p(a))===b8e.TypeNumber?i.m=a:i.m=a?new a:a,n.push(i)):b8e.error("\u8bd5\u56fe\u6dfb\u52a0\u4e0d\u5b58\u5728\u7684toggle target",e.moduleEnum,s);e._toggle=new b8e.Toggle,e._toggle.init(n),e._toggle.onSelectCheck(e._selectToggleCheck,e),e._toggle.onSelectChange(e._toggleSelect,e),e._toggle.onHide(e._toggleHide,e)}},_selectToggleCheck:function(e){return!!e&&(!e||!e.m||("undefined"==typeof moduleValue?"undefined":p(moduleValue))!==b8e.TypeNumber||game.moduleOpen.checkOpenWithTips(e.m))},_toggleSelect:function(e,t){var a=this;if(t&&t.m&&game.GameViewMgr.inst().hideView(t.m),e&&e.m)game.GameViewMgr.inst().showView(e.m,a.moduleEnum||a);else if(a._toggle){var i=a._toggle.toggles.indexOf(e);a.selectChangedHandle(i)}},_toggleHide:function(e){e&&e.m&&game.GameViewMgr.inst().hideView(e.m)},selectChangedHandle:function(){},toggleSelect:function(e){var t=this;if(t._toggle){t._defaultToggleIndex=-1;var a=t.getToggleIndex(e);return!(a&&("undefined"==typeof moduleValue?"undefined":p(moduleValue))===b8e.TypeNumber&&!game.moduleOpen.checkOpenWithTips(a))&&(t._toggle.select(e),!0)}return t._defaultToggleIndex=e,!1},getToggleIndex:function(e){var t=this;if(!t.toggles)return null;if(t.toggleMeEnums&&0<t.toggleMeEnums.length)return t.toggleMeEnums.length>e?t.toggleMeEnums[e]:null;t.toggleMeEnums=[];var a=void 0;for(var i in t.toggles)a=t.toggles[i],t.toggleMeEnums.push(a);return t.toggleMeEnums.length>e?t.toggleMeEnums[e]:null},hide:function(){var e=this;b8e.Tween.kill(e),e._toggle&&e._toggle.hide(),e.rmvSpotAlert(),b8e.evt.rmvG(e,b8e.Event.STAGE_RESIZE,e.onStageResize),e._super(),e.removeModuleMask(),game.module.removeOpenModule(e),e._unregisterMgrEvents(),e._unregisterModuleEvents()},show:function(){this._super(),game.SoundEffectMgr.inst().playViewSound(this.moduleEnum,game.SoundEffectType.SoundTypeViewOpen)},_initShow:function(){var e=this;e._addNodeTouch&&e.skin&&b8e.evt.onC(e.skin.node,e.onTouchNode,e),e._addToggle()},onTouchNode:function(){},_preShow:function(){var e=this;if(e.moduleEnum){var t=game.ViewPropsCfg.getData(e.moduleEnum,!1,!1);t&&(e._showModel=!!t.showModal)}e.onStageResize(),e.__isShow&&b8e.evt.addG(e,b8e.Event.STAGE_RESIZE,e.onStageResize),e.addModuleMask(),e.isTweenOver=!1,e.hideTweenOver=!0,e._toggle&&e._toggle.defaultSelect(),-1!=e._defaultToggleIndex&&e.toggleSelect(e._defaultToggleIndex),e.addSpotAlert(),e._registerModuleEvents(),e._registerMgrEvents()},addModuleMask:function(){this._showModel&&(game.viewModule.addModule(this),game.mainTopByFightAmount.addModule(this))},removeModuleMask:function(){this._showModel&&(game.mainTopByFightAmount.removeModule(this),game.viewModule.removeModule(this))},onStageResize:function(){var e=this,t=b8e.stageWidth,a=b8e.stageHeight,i=0,n=0,s=game.LayoutType;switch(e._layout){case s.CENTER:a-=163,i=(t-e.width>>1)+e.anchorX*e.width,n=e.anchorY*e.height+(a-e.height>>1)+113;break;case s.TOP:i=(t-e.width>>1)+e.anchorX*e.width,n=(e.anchorY-1)*e.height+a;break;case s.BOTTOM:i=(t-e.width>>1)+e.anchorX*e.width,n=e.anchorY*e.height;break;case s.LEFT:i=e.anchorX*e.width,n=e.anchorY*e.height+(a-e.height>>1);break;case s.RIGHT:i=t-(1-e.anchorX)*e.width,n=e.anchorY*e.height+(a-e.height>>1);break;case s.LEFT_TOP:i=e.anchorX*e.width,n=(e.anchorY-1)*e.height+a;break;case s.RIGHT_TOP:i=t-(1-e.anchorX)*e.width,n=(e.anchorY-1)*e.height+a;break;case s.LEFT_BOTTOM:i=e.anchorX*e.width,n=e.anchorY*e.height;break;case s.RIGHT_BOTTOM:i=t-(1-e.anchorX)*e.width,n=e.anchorY*e.height}i+=e.offsetX,n+=e.offsetY,e.setPosition(i,n)},getModelTouchClose:function(){if(this.moduleEnum){var e=game.ViewPropsCfg.getData(this.moduleEnum,!1,!1);e&&(this._modelTouchClose=!!e.touchModalClose)}return this._modelTouchClose},closeBtn:function(){game.module.hide(this.moduleEnum)},returnBtn:function(){game.module.hide(this.moduleEnum)},helpBtn:function(){game.RuleView.inst().showView(this.moduleEnum)},addEventByModule:function(e,t,a){var i=this,n=b8e.module.getControl(e);if(n){i._moduleEventMap||(i._moduleEventMap=b8e.HashMap.get());var s=i._moduleEventMap.get(e);s||(s=[],i._moduleEventMap.set(e,s)),s[s.length]={type:t,evtFunc:a,thisArge:i},n.addEventListener(t,a,i)}else b8e.error("\u4e0d\u5b58\u5728\u5bf9\u5e94\u6a21\u5757")},removeEventByModule:function(e,t,a){var i=b8e.module.getControl(e);if(i){i.removeEventListener(t,a,this);var n=this._moduleEventMap.get(e);if(n)for(var s=0,o=n.length;s<o;s++)if(n[s].type==t)return void n.splice(s,1)}else b8e.error("\u4e0d\u5b58\u5728\u5bf9\u5e94\u6a21\u5757")},removeAllEventByModule:function(e){var t=b8e.module.getControl(e);if(t){var a=this._moduleEventMap.get(e);if(a)for(var i=0,n=a.length;i<n;i++){var s=a[i];t.removeEventListener(s.type,s.evtFunc,s.thisArge)}a.length=0,this._moduleEventMap.del(e)}else b8e.error("\u4e0d\u5b58\u5728\u5bf9\u5e94\u6a21\u5757")},addEvent:function(e,t,a){this._event.addEventListener(e,t,a)},removeEvent:function(e,t,a){this._event.removeEventListener(e,t,a)},send:function(e,t){this._event.dispatchEventWith(e,t)},addListenerPb:function(e,t){var a=this;a._pbMap||(a._pbMap=b8e.HashMap.get()),a._pbMap.has(e)||a._pbMap.set(e,t),b8e.net.addMsgHandler(e,t,a)},removeListenerPb:function(e,t){b8e.net.removeMsgHandler(e,t)},removeAllPb:function(){var a=this;a._pbMap&&a._pbMap.forEach(function(e,t){a.removeListenerPb(e,t)},a)},sendPb:function(e,t){b8e.NetSender.getBytes().writeProtobuf(t),b8e.net.sendBinary(e)}}),b8e.RC("$$game","$$GamePanel",e)})(),function(){var h=game.AutoLayoutUtil={};h.ICONSIZE=40,h.ICONSIZE_HALF=.5*h.ICONSIZE,h.ICON_LABEL_INTERVAL=5,h.NEXT_ICON_INTERVAL=20,h.POWERBG_WIDTH=195,h.POWER_LEFT_INTERVAL=10,h.POWER_RIGHT_INTERVAL=10,h.LEFT=1,h.CENTER=2,h.RIGHT=3,h.layoutWith2Icon2Label=function(e,t,a,i){if(e&&t&&a&&i){var n=e.node.x,s=e.node.y;n+=h.ICONSIZE_HALF,n+=h.ICON_LABEL_INTERVAL,t.node.x=n,t.node.y=s,n+=t.width,n+=h.NEXT_ICON_INTERVAL,n+=h.ICONSIZE_HALF,a.node.x=n,a.node.y=s,n+=h.ICONSIZE_HALF,n+=h.ICON_LABEL_INTERVAL,i.node.x=n,i.node.y=s}else{b8e.error("\u4f20\u5165\u7684icon\u548clabel\u4e0d\u53ef\u4e3a\u7a7a")}},h.layoutHorizontal=function(e,t){var a,i={};if(t){a=t.localToGlobal(),i.x=a.x,i.y=a.y,i.z=0;var n=arguments.length;if(n<3){b8e.error("\u4f20\u5165\u7684\u53c2\u6570\u4e0d\u6b63\u786e")}else{for(var s=null,o=0,r=2;r<n;r++){if(s=arguments[r]){if(s.addToParent(t),o+=s.getWidth(),s instanceof b8e.RichText||s instanceof b8e.Label){if(2<r){o+=h.ICON_LABEL_INTERVAL}}else if(s instanceof b8e.BaseDisplay){if(!(c=arguments[r-1])){continue}if(2<r){if(c instanceof b8e.RichText||c instanceof b8e.Label){if(3==r){o+=h.ICON_LABEL_INTERVAL}else o+=h.NEXT_ICON_INTERVAL}}}}else;}var g=0;switch(e){case h.LEFT:g=0;break;case h.CENTER:g=-.5;break;case h.RIGHT:g=.5;break;default:g=-.5}i.x=o*g;var l=0;for(r=2;r<n;r++){if((s=arguments[r])instanceof b8e.RichText||s instanceof b8e.Label){if(2<r){i.x+=h.ICON_LABEL_INTERVAL}}else if(s instanceof b8e.BaseDisplay){if(2<r){var c;if(!(c=arguments[r-1])){continue}if(c instanceof b8e.RichText||c instanceof b8e.Label){if(3==r){i.x+=h.ICON_LABEL_INTERVAL}else i.x+=h.NEXT_ICON_INTERVAL}}}if(s)l=.5*s.getWidth(),i.x+=l,s.setPosition(i.x,s.y),i.x+=l;else;}}}else{b8e.error("\u4f4d\u7f6e\u951a\u70b9\u672a\u8bbe\u7f6e")}},h.layoutWithIconLabel=function(e,t){if(e&&t){var a=e.node.x,i=e.node.y;a+=h.ICONSIZE_HALF,a+=h.ICON_LABEL_INTERVAL,t.node.x=a,t.node.y=i}else{b8e.error("\u4f20\u5165\u7684icon\u548clabel\u4e0d\u53ef\u4e3a\u7a7a")}},h.layoutPower=function(e,t,a,i){var n;if(t)if(n=t.width,e)if(e.width=h.POWERBG_WIDTH+n,t.addToParent(e),t.x=0,t.y=4,a){a.addToParent(e);var s=a.node.width;if(a.x=-(h.POWER_LEFT_INTERVAL+.5*(n+s)),a.y=7,i){i.addToParent(e);var o=i.width;i.x=h.POWER_RIGHT_INTERVAL+.5*(n+o),i.y=6}else;}else;else{b8e.error("powerBg\u4e3a\u7a7a")}else{b8e.error("powerLab\u4e3a\u7a7a")}}}(),function(){var e;e=game.Control.extends({lastIndex:-1,lastModuleEnum:-1,curTime:0,init:function(){},ipc:function(){var e=this;e.gevts={ActiveBarGEvts:{REFRESH_BTNS:e.refreshBtn},FestivalEvts:{SERV_UPDATE_DATA:e.refreshBtn}},e.evts={MainRole:{C_RESET_DAILY:e.refreshBtn,C_LEVEL_UP:e.refreshBtn},Recharge:{C_RECHARGE_SUCCESS:e.refreshBtn,C_GET_CARD_AWARD:e.refreshBtn,C_INIT_MODEL:e.refreshBtn,C2C_CHANGE_CARD:e.refreshBtn},DiscountRecharge:{C_DISCOUNT_RECHARGE_GET_AWARD:e.refreshBtn},DailyRecharge:{C_DAILY_RECHARGE_GET_AWARD:e.refreshBtn},Trigger:{C_TRIGGER_BATCH:e.triggerBatch},OpenServer:{C2C_CHANGE_OPENSERVER_OPEN:e.refreshBtn},SaleRecharge:{C2C_REFRESH_BTNS:e.refreshBtn},LoginAwards:{C2C_REFRESH_BTNS:e.refreshBtn,GET_AD_POS:e.getAdPos},MainActivityNotice:{C2C_REFRESH_BTNS:e.refreshBtn},FreeGift:{C2C_REFRESH_BTNS:e.refreshBtn},AccumulativeRecharge:{C2C_REFRESH_BTNS:e.refreshBtn},ManyFirstCharge:{C2C_REFRESH_BTNS:e.refreshBtn,MANYRECHARGE_ADVERT:e.manyRechargeAdvert},VerifyAward:{C2C_REFRESH_BTNS:e.refreshBtn},FirstRecharge:{C_GET_PRIZE:e.refreshBtn},ShareView:{C_FRIST_GET:e.refreshBtn},OnlineGift:{REFRESHBTN_HOME:e.refreshBtn},TimeLimitPrize:{C2C_REFRESH_BTNS:e.refreshBtn},FightPosNotice:{C2C_REFRESH_BTNS:e.refreshBtn},GoodGift:{C2C_REFRESH_BTNS:e.refreshBtn},AccConCarnival:{C2C_CHANGE_ACC_CON_OPEN:e.refreshBtn},Welfare:{C2C_REFRESH_REBATE_BTN:e.refreshBtn},SmashGoldEgg:{C2C_ALL_COMPLETE:e.refreshBtn},Monopoly:{C2C_REFRESH_BTNS:e.refreshBtn},VipWelfare:{C2C_REFRESH_BTNS:e.refreshBtn},ChainGift:{C2C_REFRESH_BTNS:e.refreshBtn},TVDailyRecharge:{C2C_REFRESH_BTNS:e.refreshBtn},FestivalRecharge:{C2C_REFRESH_BTNS:e.refreshBtn},PushPrize:{C2C_REFRESH_BTNS:e.refreshBtn},OneYuanBuy:{C2C_REFRESH_BTNS:e.refreshBtn},NewFirstCharge:{C2C_REFRESH_BTNS:e.refreshBtn,NEW_CHARGE:e.manyNewFirstCharge},WelfareTarget:{C2C_REFRESH_BTNS:e.refreshBtn},LimitSalePrize:{REFRESHBTN_HOME:e.refreshBtn}},e.handels={}},triggerBatch:function(e){if(e&&e.data)this.refreshBtn();else;},getAdPos:function(){this.send(game.ActiveBarEvts.C2V_GET_AD_POS)},notify:function(e){switch(e){case this.Evts.V2C_REFRESH_VIEW_STATE:this.dpt(this.Evts.C2C_REFRESH_VIEW_STATE)}},refreshBtn:function(){this.lock||(this.lock=!0,b8e.setTimeout(this._refreshBtn,this,1e3))},_refreshBtn:function(){var e=this;e.lock=!1,e.send(e.Evts.V_REFRESH_BTNS),b8e.module.isShowView(game.ME.LoginAwardsMain)&&e.getAdPos(),b8e.module.isShowView(game.ME.ManyFirstAdvert)&&e.send(e.Evts.MANYRECHARGE_ADVERT),e.dpt(e.Evts.C2C_ACTIVE_BAR_DATA)},manyRechargeAdvert:function(){this.send(game.ActiveBarEvts.MANYRECHARGE_CHANGEPOS)},manyNewFirstCharge:function(){this.send(game.ActiveBarEvts.NEW_FIRST_CHARGE2)}}),b8e.RC("$$game","$$BaseActiveBarControl",e)}(),function(){var e;e=b8e.Enum({None:0,V2C_INIT_ACTIVE_BAR:-1,C2C_INIT_ACTIVE_BAR:-1,V_REFRESH_BTNS:-1,V_SHOW_VIEW:-1,C2V_GET_AD_POS:-1,MANYRECHARGE_ADVERT:-1,MANYRECHARGE_CHANGEPOS:-1,V2V_CHANGE_SHRINK_STATE:-1,C2C_REFRESH_ACTIVE_BAR:-1,C2V_OPEN_ACTIVEBAR_GROUP:-1,NEW_FIRST_CHARGE2:-1,V2C_REFRESH_VIEW_STATE:-1,C2C_REFRESH_VIEW_STATE:-1,C2C_ACTIVE_BAR_DATA:-1}),b8e.RC("$$game","$$ActiveBarEvts",e)}(),function(){var e;e=b8e.Enum({None:0,REFRESH_BTNS:b8e.enc()}),b8e.RC("$$game","$$ActiveBarGEvts",e)}(),function(){var e;e=b8e.Enum({SHOW_NONE:0,SHOW_NAME:1,SHOW_NUM:2,SHOW_ALL:3}),b8e.RC("$$game","$$IconLayoutEnum",e)}(),function(){var e;e=b8e.Enum({SIZE_32:32,SIZE_36:36,SIZE_60:60,SIZE_68:68,SIZE_70:70,SIZE_74:70,SIZE_76:76,SIZE_78:78,SIZE_84:84,SIZE_104:104,SIZE_128:128,SIZE_64:64,SIZE_40:40,SIZE_54:54,SIZE_83:83,GRID_SIZE_105:105,GRID_SIZE_84:84,GRID_SIZE_69:69,GRID_SIZE_42:42,CIRCLE_SIZE_104:104,CIRCLE_SIZE_84:84,CIRCLE_SIZE_70:70,ICON_IMG_SIZE_82:82,SKILL_IMG_SIZE_84:84}),game.IconWidthSizeEnumMap={105:100,84:80,69:66,42:40},game.IconScaleEnum={104:1,105:1,84:.8,70:.66,69:.66,40:.45,42:.5},b8e.RC("$$game","$$IconSizeEnum",e)}(),function(){var e;e=b8e.Enum({Q_WHITE:0,Q_GREEN:1,Q_BLUE:2,Q_PURPLE:3,Q_YELLOW:4,Q_RED:5,Q_UNPARALLELED:6,Q_COLORFUL:7,Q_COLORFUL_HIGH:8}),b8e.RC("$$game","$$Quality",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_iconSize:90,_iconImg:null,_iconBg:null,_iconResName:"",iconResUrl:"",_bgSize:90,ctor:function(e,t,a,i){var n=this;n._super(),n.setIconSize(e),n.setImgSize(t),n.setBgSize(a),n.setTopImgSize(i),n.setAnchor(.5,.5)},setIconSize:function(e){this._iconSize=e<=0?game.IconSizeEnum.SIZE_84:e,this.setSize(this._iconSize,this._iconSize)},setImgSize:function(e){e=e||this._iconSize,this._imgSize=e<=0?game.IconSizeEnum.SIZE_84:e},setBgSize:function(e){e=e||this._iconSize,this._bgSize=e<=0?game.IconSizeEnum.SIZE_84:e},setTopImgSize:function(e){e=e||this._iconSize,this._topImgSize=e<=0?game.IconSizeEnum.SIZE_84:e},setIcon:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!==t){var i=a.calIconSize();a._iconResName!=t?(a._iconImg||(a._iconImg=b8e.Sprite.get(),a._iconImg.setAnchor(.5,.5)),a._iconImg&&!a._iconImg.parent&&a.addChild(a._iconImg),a._iconImg.setSize(i,i),a._iconImg.setVisible(!0),a._iconResName=t,a._iconImg.loadTexture(a._iconResName)):a._iconImg&&(a._iconImg.setSize(i,i),a._iconImg.setVisible(!0))}else a._iconImg&&a._iconImg.setVisible(!1)},calIconSize:function(){return this._imgSize/game.IconSizeEnum.CIRCLE_SIZE_104*game.IconSizeEnum.CIRCLE_SIZE_84},calIconScale:function(){return this._imgSize/game.IconSizeEnum.SIZE_84},setBgImage:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!==t){var i=a._bgSize;if(a._iconResUrl!=t){a._iconBg||(a._iconBg=b8e.Sprite.get(),a._iconBg.setAnchor(.5,.5)),a._iconBg&&!a._iconBg.parent&&a.addChild(a._iconBg),a._iconResUrl=t,a._iconBg.setVisible(!0),a._iconBg.setSize(i,i);var n=a.getBgUrl(a._iconResUrl);a._iconBg.loadTexture(n),a.updateLayout()}else a._iconBg&&(a._iconBg.setSize(i,i),a._iconBg.setVisible(!0))}else a._iconBg&&a._iconBg.setVisible(!1)},setTopImg:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!==t){var i=a._topImgSize;if(a._iconResUrl!=t){a._topImg||(a._topImg=b8e.Sprite.get(),a._topImg.setAnchor(.5,.5)),a._topImg&&!a._topImg.parent&&a.addChild(a._topImg),a._iconResUrl=t,a._topImg.setVisible(!0),a._topImg.setSize(i,i);var n=a.getBgUrl(a._iconResUrl);a._topImg.loadTexture(n),a.updateLayout()}else a._topImg&&(a._topImg.setSize(i,i),a._topImg.setVisible(!0))}else a._topImg&&a._topImg.setVisible(!1)},getBgUrl:function(e){return game.ResCfg.getUrl(60,e)},addIconImage:function(){this._iconImg&&!this._iconImg.parent&&this.addChild(this._iconImg)},updateLayout:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;this._iconBg&&this._iconBg.setPosition(a,i),this._topImg&&this._topImg.setPosition(a,i)},clearData:function(){},iconSize:{get:function(){return this._iconSize}},iconResName:{get:function(){return this._iconResName}}}),b8e.RC("$$game","$$GameIcon",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_iconSize:84,_iconImg:null,_iconBg:null,_iconResName:"",iconResUrl:"",_bgSize:84,ctor:function(e){var t=this;t._super(),t.setIconSize(e),t.setAnchor(.5,.5);var a=game.IconScaleEnum[t._iconSize];a||b8e.warn("\u6ca1\u6709\u5bf9\u5e94\u5c3a\u5bf8\u7684scale\uff0c\u8bf7\u6b63\u786e\u8bbe\u7f6e\u5c3a\u5bf8:",t._iconSize),t.setScale(a,a)},setIconSize:function(e){this._iconSize=e<=0?game.IconSizeEnum.SIZE_84:e;var t=game.IconSizeEnum.GRID_SIZE_105,a=game.IconWidthSizeEnumMap[t];this.setSize(a,t)},setIconScale:function(){var e=game.IconScaleEnum[this._iconSize];e||b8e.warn("\u6ca1\u6709\u5bf9\u5e94\u5c3a\u5bf8\u7684scale\uff0c\u8bf7\u6b63\u786e\u8bbe\u7f6e\u5c3a\u5bf8:",this._iconSize),this.setScale(e,e)},setIcon:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!=t){var i=game.IconSizeEnum.ICON_IMG_SIZE_82;a._iconResName!=t?(a._iconImg||(a._iconImg=b8e.Sprite.get(),a._iconImg.setAnchor(.5,.5)),a._iconImg&&!a._iconImg.parent&&a.addChild(a._iconImg),a._iconImg.setSize(i,i),a._iconImg.setVisible(!0),a._iconResName=t,a._iconImg.loadTexture(a._iconResName),a.setIconImgPos()):a._iconImg&&(a._iconImg.setSize(i,i),a._iconImg.setVisible(!0))}else a._iconImg&&a._iconImg.setVisible(!1)},calIconSize:function(){return game.IconSizeEnum.ICON_IMG_SIZE_82},calIconScale:function(){return game.IconScaleEnum[this._iconSize]},setBgImage:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!=t){var i=game.IconSizeEnum.GRID_SIZE_105,n=game.IconWidthSizeEnumMap[i];if(a._iconResUrl!=t){a._iconBg||(a._iconBg=b8e.Sprite.get(),a._iconBg.setAnchor(.5,.5),a._iconBg.setStyle(b8e.SpriteStyle.SLICED),a._iconBg.scale9Inset={top:19,bottom:23,left:20,right:20}),a._iconBg&&!a._iconBg.parent&&a.addChild(a._iconBg),a._iconResUrl=t,a._iconBg.setVisible(!0),a._iconBg.setSize(n,i);var s=a.getBgUrl(a._iconResUrl);a._iconBg.loadTexture(s),a.updateLayout()}else a._iconBg&&(a._iconBg.setSize(n,i),a._iconBg.setVisible(!0))}else a._iconBg&&a._iconBg.setVisible(!1)},setTopImg:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!=t){var i=game.IconSizeEnum.GRID_SIZE_105,n=game.IconWidthSizeEnumMap[i];if(a._iconResUrl!=t){a._topImg||(a._topImg=b8e.Sprite.get(),a._topImg.setAnchor(.5,.5)),a._topImg&&!a._topImg.parent&&a.addChild(a._topImg),a._iconResUrl=t,a._topImg.setVisible(!0),a._topImg.setSize(n,i);var s=a.getBgUrl(a._iconResUrl);a._topImg.loadTexture(s),a.updateLayout()}else a._topImg&&(a._topImg.setSize(n,i),a._topImg.setVisible(!0))}else a._topImg&&a._topImg.setVisible(!1)},getBgUrl:function(e){return game.ResCfg.getUrl(240,e)},addIconImage:function(){this._iconImg&&!this._iconImg.parent&&this.addChild(this._iconImg)},updateLayout:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;this._iconBg&&this._iconBg.setPosition(a,i),this._topImg&&this._topImg.setPosition(a,i)},setIconImgPos:function(){this.iconImg&&this.iconImg.parent&&this.iconImg.setPosition(0,2)},clearData:function(){},iconImg:{get:function(){return this._iconImg}},iconSize:{get:function(){return this._iconSize}},iconResName:{get:function(){return this._iconResName}}}),b8e.RC("$$game","$$GameItemIcon",e)}(),function(){var e;(e=game.GameItemIcon.extends({ctor:function(e){e=e||game.IconSizeEnum.GRID_SIZE_84,this._super(e)},getBgUrl:function(e){return game.ResCfg.getUrl(240,e)},clearData:function(){}})).poolCall=!0,b8e.RC("$$game","$$HeadIcon",e)}(),function(){var e;(e=game.GameItemIcon.extends({_cfg:null,itemInfo:null,isShowName:!0,isShowNum:!0,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.SIZE_84;this._super(t),b8e.evt.onC(this,this._fnOnClickGrid,this)},setItemInfo:function(e,t,a,i){var n=1<arguments.length&&void 0!==t&&t,s=2<arguments.length&&void 0!==a?a:game.IconLayoutEnum.SHOW_ALL,o=!(3<arguments.length&&void 0!==i)||i,r=this;if(n&&r.clearData(),r.itemInfo=e,r.itemInfo){r.setIconType(s);var g=e.id,l=e.num,c=r._cfg=game.ItemInfoCfg.getData(g);if(c){r.setBgImage(game.ResCfg.getQualityBg(c.quality));var h=c.icon;h&&""!=h&&"0"!=h||(h="1"),r.setIcon(game.ResCfg.getUrl(137,h)),r.setHunluQualityImg(c),r.setElement(c),r.setTagIcon();var m=!!e.isDarkBg&&e.isDarkBg,u=game.HtmlUtil.getColorByQuality(c.quality,m);r.isShowNum?c.cfgType==game.ItemCfgType.Amount?r.setNum(l,null,null,!0,2):r.setNum(l):r.setNum(""),r.isShowName?c.quality==game.Quality.Q_COLORFUL?r.setRichName(c.name,c.quality,e.fontSize):r.setName(c.name,u,e.fontSize):r.setName("",u),o&&r.setEffect(c.qualityEffect)}}else r.setBgImage(game.ResCfg.getQualityBg(0))},setEffect:function(e){var t=this;if(!e||""==e)return t._effect&&(t._effect.clear(),t._effect.parent&&t._effect.removeFromParent()),void(t._qualityEffect="");if(t._qualityEffect!=e){t._qualityEffect=e,t._effect||(t._effect=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)),t._effect&&!t._effect.parent&&t.addChild(t._effect);var a=game.ResCfg.getUrl(5022,e);t._effect.load(a),t._effect.play()}},setIconType:function(e){this.isShowName=0<(e&game.IconLayoutEnum.SHOW_NAME),this.isShowNum=0<(e&game.IconLayoutEnum.SHOW_NUM)},_fnOnClickGrid:function(){var e=this;e._clickCb&&e._clickCb.thisArg?e._clickCb.func.call(e._clickCb.thisArg,e):e.fnOnClickGrid()},fnOnClickGrid:function(){var e=this;if(e.itemInfo){game.tipsData.setInfo(e.itemInfo);var t=game.ItemInfoCfg.getCfgTypeById(e.itemInfo.id),a=game.ItemCfgType;switch(t){case a.Equip:case a.PartnerProper:var i=game.partnerEquipData.createInfoById(e.itemInfo.id);i.setData(e.itemInfo),game.tipsData.setInfo(i),game.partnerEquipData.selInfo=i,t==a.Equip&&game.module.show(game.ME.EquipDetailsTips),t==a.PartnerProper&&game.module.show(game.ME.ExcEquipDetailsTips);break;case a.Amount:case a.ShowItem:case a.EffectItem:case a.NormalItem:game.module.show(game.ME.ItemTips);break;case a.FosterEquip:game.FosterEquipMgr.inst().showEquipTips(e._cfg);break;case a.GOD_ANIMAL_EQUIP:game.godAnimalEquipData.showIdIdx=e.t.itemInfo.id,game.module.show(game.ME.GodAnimalEquipTips);break;default:game.module.show(game.ME.ItemTips)}}},setClickCb:function(e,t){this._clickCb=e?{func:e,thisArg:t}:null},setLabBg:function(){var e=this;e._labBg||(e._labBg=b8e.Sprite.get(),e._labBg.setStyle(b8e.SpriteStyle.SLICED),e._labBg.setAnchor(1,0)),e._labBg.setVisible(!0),e._labBg.scale9Inset={top:8,bottom:8,left:11,right:11},e._labBg.loadTexture(game.ResCfg.getUrl(239)),e.setLabBgPos(),e.setLabBgSize()},setLabBgPos:function(){if(this._labBg){var e=game.IconSizeEnum.GRID_SIZE_105,t=(game.IconWidthSizeEnumMap[e]>>1)-9,a=14-(e>>1);this._labBg.setPosition(t,a)}},setLabBgSize:function(){this._numText&&this._labBg.setSize(this._numText.width+12,24)},setName:function(e,t,a,i){var n=2<arguments.length&&void 0!==a?a:20,s=3<arguments.length&&void 0!==i&&i,o=this;o._labRichNameText&&(o._labRichNameTextString="",o._labRichNameText.setText("")),""!=e?(o._labNameText||(o._labNameText=o.getLabText(n,t)),o._labNameText.isBold(!0),o._labNameText&&!o._labNameText.parent&&o.addChild(o._labNameText),o._labNameText.setVisible(!0),o._labNameTextString!=e&&(6<(o._labNameTextString=e).length&&(e=e.substring(0,4),e+="..."),o._labNameText.setText(e)),o._labNameTextColor!=t&&(o._labNameTextColor=t,o._labNameText.setColor(t)),s?o.setLabNamePos(0,-5):o.setLabNamePos()):o._labNameText&&(o._labNameTextString=e,o._labNameText.setText(e),o._labNameText.setVisible(!1))},setRichName:function(e,t,a,i){var n=2<arguments.length&&void 0!==a?a:20,s=3<arguments.length&&void 0!==i&&i,o=this;o._labNameText&&(o._labNameTextString="",o._labNameText.setText("")),""!=e?(o._labRichNameText||(o._labRichNameText=o.getRichLabText(n)),o._labRichNameText&&!o._labRichNameText.parent&&o.addChild(o._labRichNameText),o._labRichNameText.setVisible(!0),o._labRichNameTextString!=e&&(6<(o._labRichNameTextString=e).length&&(e=e.substring(0,4),e+="..."),e=game.HtmlUtil.getColorStrByQuality(t,e,!0),o._labRichNameText.setText(e)),s?o.setRichLabNamePos(0,-5):o.setRichLabNamePos()):o._labRichNameText&&(o._labRichNameTextString=e,o._labRichNameText.setText(e),o._labRichNameText.setVisible(!1))},setLabNamePos:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;if(this._labNameText){var n=game.IconSizeEnum.GRID_SIZE_105,s=-this._labNameText.width/2,o=-(n>>1)-1-this._labNameText.height-3;this._labNameText.setPosition(s+a,o+i)}},setRichLabNamePos:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;if(this._labRichNameText){var n=game.IconSizeEnum.GRID_SIZE_105,s=-this._labRichNameText.width/2,o=-(n>>1)-1-this._labRichNameText.height-3;this._labRichNameText.setPosition(s+a,o+i)}},setNum:function(e,t,a,i,n,s){var o=!(3<arguments.length&&void 0!==i)||i,r=4<arguments.length&&void 0!==n?n:2,g=this;if(e<=1&&!s)return g._numText&&(g._numTextString="",g._numText.setText(""),g._numText.setVisible(!1)),void(g._labBg&&g._labBg.parent&&g._labBg.setVisible(!1));o&&(e=game.CCommonUtil.replaceNum(e,r)),e+="",g._numText||(g._numText=g.getLabText(a,t)),g._numTextColor!=t&&(g._numTextColor=t,g._numText.setColor(t)),g._numTextString!=e&&(g._numTextString=e,g._numText.setText(e)),g.setLabBg(),g._labBg&&!g._labBg.parent&&g.addChild(g._labBg),g._numText&&!g._numText.parent&&g.addChild(g._numText),g._numText.setVisible(!0),g.setLabNumPos()},setLabNumPos:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;if(this._numText){var n=game.IconSizeEnum.GRID_SIZE_105,s=(game.IconWidthSizeEnumMap[n]>>1)-16-this._numText.width,o=13-(n>>1);this._numText.setPosition(s+a,o+i)}},getLabText:function(e,t){t=t||game.Color.WHITE,e=e||18;var a=b8e.Label.get();return a.setFontSize(e),a.setColor(t),a.setLineHeight(e+4),a},getRichLabText:function(e){e=e||18;var t=b8e.RichText.get();return t.setFontSize(e),t.setLineHeight(e+4),t},addLabNameText:function(){this._labNameText&&!this._labNameText.parent&&this.addChild(this._labNameText)},addRichLabNameText:function(){this._labRichNameText&&!this._labRichNameText.parent&&this.addChild(this._labRichNameText)},addLabNumText:function(){this._numText&&!this._numText.parent&&this.addChild(this._numText)},addLabBg:function(){this._labBg&&!this._labBg.parent&&this.addChild(this._labBg)},setLabScale:function(e,t){var a=this;a._labBg&&a._labBg.parent&&a._labBg.setScale(e,t),a._numText&&a._numText.setScale(e,t)},setElement:function(e){if(e){if(e.element){if(this.addElement(),this.element){var t=game.ResCfg.getUrl(10048,e.element);this.element.loadTexture(t)}}else this.removeElement()}},addElement:function(){var e=this;e.element||(e.element=b8e.Sprite.get(),e.element.setPosition(15,15)),e.element.parent||e.addChild(e.element)},removeElement:function(){this.element&&this.element.removeFromParent()},setHunluQualityImg:function(e){var t=this;if(e&&e.itemType==game.ItemType.Hunlu){if(t._hunluQualityImg||(t._hunluQualityImg=b8e.Sprite.get(),t._hunluQualityImg.setAnchor(.5,.5)),!t._hunluQualityImg.parent&&t._iconImg&&(t._iconImg.addChild(t._hunluQualityImg),t._hunluQualityImg.setPosition(0,-2)),t._hunluQualityImg){var a=game.ResCfg.getUrl(271,e.quality);t._hunluQualityImg.loadTexture(a)}}else t._hunluQualityImg&&(t._hunluQualityImg.unloadTexture(),t._hunluQualityImg.removeFromParent())},setTagIcon:function(){var e=this;if(e.itemInfo)if(e.itemInfo.tagId){if(e.addTagIcon(),e.tagIcon){var t=game.ResCfg.getUrl(10125,e.itemInfo.tagId);e.tagIcon.loadTexture(t)}}else e.removeTagIcon()},addTagIcon:function(){var e=this;e.tagIcon||(e.tagIcon=b8e.Sprite.get(),e.tagIcon.setPosition(-50,-7)),e.tagIcon.parent||e.addChild(e.tagIcon)},removeTagIcon:function(){this.tagIcon&&this.tagIcon.removeFromParent()},clearData:function(){var e=this;e.itemInfo=null,e._iconImg&&(e._iconResName="",e._iconImg.unloadTexture()),e._labNameText&&(e._labNameTextString="",e._labNameText.setText("")),e._labRichNameText&&(e._labRichNameTextString="",e._labRichNameText.setText("")),e._numText&&(e._numTextString="",e._numText.setText("")),e._labBg&&e._labBg.unloadTexture(),e._effect&&(e._qualityEffect="",e._effect.clear()),e._iconBg&&(e._iconBg.unloadTexture(),e._iconResUrl=""),e._hunluQualityImg&&e._hunluQualityImg.unloadTexture(),e.element&&e.element.unloadTexture(),e._qualityEffect=""}})).poolCall=!0,b8e.RC("$$game","$$ItemIcon",e)}(),function(){var e;e=game.GameIcon.extends({ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.SIZE_32,i=!(1<arguments.length&&void 0!==t)||t;this._super(a),i&&b8e.evt.onC(this,this.fnOnClickGrid,this)},setItemInfo:function(e,t,a,i,n,s){var o=3<arguments.length&&void 0!==i?i:20,r=!(5<arguments.length&&void 0!==s)||s,g=this;if(4<arguments.length&&void 0!==n&&n){this.clearData()}if(g._cfg=game.ItemInfoCfg.getData(e),g._cfg){var l=g._cfg.icon;if(!l||""==l||"0"==l){l="1"}if(g.setIcon(game.ResCfg.getUrl(137,l)),a=a||game.HtmlUtil.getColorByQuality(g._cfg.quality),g.setNum(t,a,o),r){this.setEffect(this._cfg.qualityEffect)}}else;},setEffect:function(e){var t=this;if(e&&""!=e){t._effect||(t._effect=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)),t._effect&&!t._effect.parent&&t.addChild(t._effect);var a=t.calIconScale();t._effect.setScale(a,a);var i=game.ResCfg.getUrl(5022,e);t._effect.load(i),t._effect.play()}else t._effect&&(t._effect.clear(),t._effect.parent&&t._effect.removeFromParent())},setNum:function(e,t,a){var i=this;i._numText||(i._numText=i.getRichText(a),i._numText.setAnchor(0,.5),i.addChild(i._numText)),i._numText&&!i._numText.parent&&i.addChild(i._numText);var n=null!=e;i._numText.setColor(t),i._numText.setText(n?e+"":""),i._numText.setVisible(n),i.setLabNumPos()},setLabNumPos:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;if(this._numText){var n=4+(this.iconSize>>1);this._numText.setPosition(n+a,i)}else;},getRichText:function(e){e=e||18;var t=b8e.RichText.get();return t.setFontSize(e),t},getLabText:function(e,t){t=t||4294967295,e=e||20;var a=b8e.Label.get();return a.setFontSize(e),a.setColor(t),a},fnOnClickGrid:function(){if(this._cfg)game.tipsData.setInfo(this._cfg),game.module.show(game.ME.ItemTips);else;},clearData:function(){if(this._iconImg){this._iconResName="",this._iconImg.removeFromParent(),this._iconImg.setVisible(!1)}if(this._numText){this._numTextString="",this._numText.removeFromParent(),this._numText.setVisible(!1)}if(this._effect){this._effect.clear(),this._effect.removeFromParent()}},getIconWidth:function(){var e=this._numText?this._numText.width:0;return this.width+e}}),b8e.RC("$$game","$$AmountIcon",e)}(),function(){var e;(e=game.ItemIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.GRID_SIZE_105;this._super(t)},setItemInfo:function(e,t){var a=this;if(t&&a.clearData(),a.itemInfo=e,a.itemInfo){var i=e.id,n=e.num,s=a._cfg=game.ItemInfoCfg.getData(i);if(s){a.setBgImage(game.ResCfg.getQualityBg(s.quality));var o=s.icon;o&&""!=o&&"0"!=o||(o="1"),a.setIcon(game.ResCfg.getUrl(137,o)),a.setElement(s),a.setHunluQualityImg(s);var r=game.HtmlUtil.getColorByQuality(s.quality,!0),g="";g=(e.isEquip,s.name),s.quality==game.Quality.Q_COLORFUL?a.setRichName(g,s.quality):a.setName(g,r),a.setNum(n);var l=!1;s.cfgType!=game.ItemCfgType.EffectItem&&s.pageId!=game.BackPageId.BACK_PACK_SHARD||(l=game.itemData.getEffectItemAlert(i,n)),a.setEffect(s.qualityEffect),a._redIcon&&a._redIcon.parent&&a._redIcon.removeFromParent(),a.setRedIcon(l)}}else a.setBgImage(game.ResCfg.getQualityBg(0))},setRedIcon:function(e,t,a){var i=0<arguments.length&&void 0!==e&&e,n=1<arguments.length&&void 0!==t?t:0,s=2<arguments.length&&void 0!==a?a:0,o=this;if(i){if(!o._redIcon){o._redIcon=b8e.Sprite.get(),o._redIcon.setAnchor(.5,.5),o._redIcon.setPosition(42+n,42+s);var r=game.ResCfg.getImgUrl("icon/redIcon");o._redIcon.loadTexture(r,null,null),o._redIcon.setVisible(!1)}o._redIcon&&!o._redIcon.parent&&o.addChild(o._redIcon),o._redIcon.setVisible(i)}else o._redIcon&&o._redIcon.setVisible(i)},addRedIcon:function(){this._redIcon&&!this._redIcon.parent&&this.addChild(this._redIcon)},fnOnClickGrid:function(){var e=this;if(e.itemInfo&&e._cfg){var t=void 0;if(e._cfg.cfgType==game.ItemCfgType.PartnerProper)return t=game.equipData.getPetEquipInfoByIdx(e.itemInfo.idx),game.tipsData.setInfo(t),void game.module.show(game.ME.ExcEquipDetailsTips);if(e._cfg.cfgType==game.ItemCfgType.FosterEquip)return t=game.equipData.getFosterEquipInfo(e.itemInfo.idx),void game.FosterEquipMgr.inst().showEquipNotChange(t);if(e._cfg.cfgType==game.ItemCfgType.GOD_ANIMAL_EQUIP)return game.godAnimalEquipData.showIdIdx=e.itemInfo.idx,void game.module.show(game.ME.GodAnimalEquipTips);if(e._cfg.pageId==game.BackPageId.BACK_PACK_EQUIP)return t=game.equipData.getPetEquipInfoByIdx(e.itemInfo.idx),game.tipsData.setInfo(t),void game.module.show(game.ME.EquipDetailsTips);game.tipsData.setInfo(e.itemInfo,0,!0),e._cfg.cfgType==game.ItemCfgType.EffectItem&&9==e._cfg.effectType?(game.selectGiftData.itemInfo=e.itemInfo,game.selectGiftData.createGift(e.itemInfo.id),game.module.show(game.ME.SelectGift)):game.module.show(game.ME.ItemTips)}},clearData:function(){this._super(),this._redIcon&&(this._redIcon.removeFromParent(),this._redIcon.setVisible(!1))}})).poolCall=!0,b8e.RC("$$game","$$BackItemIcon",e)}(),function(){var e;e=game.GameItemIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.GRID_SIZE_105;this._super(t),b8e.evt.onC(this,this.fnOnClickGrid,this)},setItemInfo:function(e,t,a,i){var n=!(3<arguments.length&&void 0!==i)||i,s=this;if(1<arguments.length&&void 0!==t&&t){this.clearData()}if(s._cfg=game.ItemInfoCfg.getData(e),s._cfg){s.setBgImage(game.ResCfg.getQualityBg(s._cfg.quality));var o=s._cfg.icon;if(!o||""==o||"0"==o){o="1"}if(s.setIcon(game.ResCfg.getUrl(137,o)),n){this.setEffect(this._cfg.qualityEffect)}}else{this.setBgImage(game.ResCfg.getQualityBg(0))}},setEffect:function(e){var t=this;if(e&&""!=e){if(!t._effect){t._effect=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)}if(t._effect&&!t._effect.parent){t.addChild(t._effect)}var a=game.ResCfg.getUrl(5022,e);t._effect.load(a),t._effect.play()}else{if(t._effect){if(t._effect.clear(),t._effect.parent){t._effect.removeFromParent()}}}},fnOnClickGrid:function(){if(this._cfg)this._cfg.cfgType!=game.ItemCfgType.FosterEquip?(game.tipsData.setInfo(this._cfg),game.module.show(game.ME.ItemTips)):game.FosterEquipMgr.inst().showEquipTips(this._cfg);else;},clearData:function(){if(this._iconImg){this._iconResName="",this._iconImg.unloadTexture(),this._iconImg.removeFromParent()}if(this._effect){this._effect.clear(),this._effect.removeFromParent()}}}),b8e.RC("$$game","$$CostItemIcon",e)}(),function(){var e;(e=game.ItemIcon.extends({_cfg:null,itemInfo:null,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.SIZE_104;this._super(t)},setItemInfo:function(e,t,a,i){var n=2<arguments.length&&void 0!==a?a:3,s=!(3<arguments.length&&void 0!==i)||i,o=this;if(1<arguments.length&&void 0!==t&&t){this.clearData()}if(o.itemInfo=e,o.itemInfo){o.setIconType(n);var r=e.id,g=e.num;if(o._cfg=game.ItemInfoCfg.getData(r),o._cfg){o.setBgImage(game.ResCfg.getQualityBg(o._cfg.quality));var l=o._cfg.icon;if(!l||""==l||"0"==l){l="1"}o.setIcon(game.ResCfg.getUrl(137,l));var c="Lv."+o._cfg.level;if(o.isShowName)if(o._cfg.quality==game.Quality.Q_COLORFUL)o.setRichName(c,o._cfg.quality);else{var h=game.HtmlUtil.getColorByQuality(o._cfg.quality,!0);o.setName(c,h)}else o.setName("");if(o.isShowNum){this.setNum(g)}else o.setNum(1);if(s){this.setEffect(this._cfg.qualityEffect)}}else;}else{this.setBgImage(game.ResCfg.getQualityBg(0))}},setIconType:function(e){this.isShowName=0<(e&game.IconLayoutEnum.SHOW_NAME),this.isShowNum=0<(e&game.IconLayoutEnum.SHOW_NUM)},fnOnClickGrid:function(){if(this.itemInfo){var e=game.equipData.getPetEquipInfoByIdx(this.itemInfo.idx);game.tipsData.setInfo(e),game.module.show(game.ME.EquipDetailsTips)}else;},clearData:function(){this._super()}})).poolCall=!0,b8e.RC("$$game","$$EquipIcon",e)}(),function(){var e;e=game.EquipIcon.extends({_cfg:null,itemInfo:null,nameColor:null,nameSize:18,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.GRID_SIZE_105;this._super(t),this.nameColor=game.Color.BLACK},setItemInfo:function(e,t,a,i){var n=!(3<arguments.length&&void 0!==i)||i,s=this;if(1<arguments.length&&void 0!==t&&t&&s.clearData(),e&&(s.itemInfo=e,s._cfg=game.ItemInfoCfg.getData(e.id),s._cfg)){s.setBgImage(game.ResCfg.getQualityBg(s._cfg.quality));var o=s._cfg.icon;o&&""!=o&&"0"!=o||(o="1"),s.setIcon(game.ResCfg.getUrl(137,o));var r=s._cfg.types==game.RoleEquipType.SZ?9639:9638,g=game.Lang.get(r,s._cfg.level);s.setName(g,s.nameColor,s.nameSize,!0),s.setLabNamePos(0,5),n&&s.setEffect(s._cfg.qualityEffect)}},fnOnClickGrid:function(){this.itemInfo&&this._cfg&&(game.tipsData.setInfo(this.itemInfo),game.module.show(game.ME.EquipForgeTips))},clearData:function(){this._super()},clearSZInfo:function(){this.itemInfo=null}}),b8e.RC("$$game","$$EquipSlotIcon",e)}(),function(){var e;e=game.ItemIcon.extends({ctor:function(e){if(!e){e=game.IconSizeEnum.GRID_SIZE_105}this._super(e)},setItemInfo:function(e,t,a,i){var n=2<arguments.length&&void 0!==a?a:1,s=!(3<arguments.length&&void 0!==i)||i,o=this;if(1<arguments.length&&void 0!==t&&t){this.clearData()}if(o.itemInfo=e,o.itemInfo)if(o.setIconType(n),o._cfg=game.ItemInfoCfg.getData(o.itemInfo.id),o._cfg){o.setBgImage(game.ResCfg.getQualityBg(o._cfg.quality));var r,g,l=o._cfg.icon;if(!l||""==l||"0"==l){l="1"}if(o.itemInfo.equip){g="+"+this.itemInfo.equip.attrNum}else g="";if(r=game.Lang.get(9590,o._cfg.openLv),o.setIcon(game.ResCfg.getUrl(137,l)),o.setTopName(r,game.Color.YELLOW,18),o.setTopRightName(g,game.Color.GREEN,18),o.setBottomName(o._cfg.shortName,null,18),o.isShowName){var c=game.HtmlUtil.getColorByQuality(this._cfg.quality);this.setName(r,c)}else o.setName("");if(s){this.setEffect(this._cfg.qualityEffect)}}else;else{this.setBgImage(game.ResCfg.getQualityBg(0))}},setIconType:function(e){this.isShowName=0<(e&game.IconLayoutEnum.SHOW_NAME)},setTopName:function(e,t,a){var i=this;if(""!=e){if(!i._topNameText){this._topNameText=this.getLabText(a,t)}if(i._topNameTextString!=e){this._topNameTextString=e,this._topNameText.setText(e)}if(!i._topBg){this._topBg=b8e.Sprite.get(),this._topBg.setStyle(b8e.SpriteStyle.SLICED),this._topBg.setAnchor(0,1)}if(i._topBg&&!i._topBg.parent){this.addChild(this._topBg)}if(i._topNameText&&!i._topNameText.parent){this.addChild(this._topNameText)}i._topNameText.setVisible(!0),i.setTopNamePos()}else{if(this._topNameText){this._topNameTextString=e,this._topNameText.setText(e),this._topNameText.setVisible(!1)}}},setTopNamePos:function(){if(this._topNameText){var e=game.IconSizeEnum.GRID_SIZE_105,t=12-(game.IconWidthSizeEnumMap[e]>>1),a=(e>>1)-(this._topNameText.height>>1)-22;this._topNameText.setPosition(t,a)}},setTopRightName:function(e,t,a){var i=this;if(""!=e){if(i._topRightNameText||(i._topRightNameText=i.getLabText(a,t),i._topRightNameText.setAnchor(.5,.5)),i._topRightNameText.setVisible(!0),i._topRightNameTextString!=e&&(i._topRightNameTextString=e,i._topRightNameText.setText(e)),i.setTopBg(),i._topRightNameText&&!i._topRightNameText.parent){this._topBg.addChild(this._topRightNameText)}i.setTopBgSize(),i.setTopRightNamePos()}else{if(this._topRightNameText){this._topRightNameTextString=e,this._topRightNameText.setText(e),this._topRightNameText.setVisible(!1)}}},setTopRightNamePos:function(){var e=0;if(this._topNameText){e=this._topNameText.width}if(this._topRightNameText){var t=(this._topNameText.width>>1)+e,a=-this._topBg.height>>1;this._topRightNameText.setPosition(t,a)}},setBottomName:function(e,t,a){var i=this;if(""!=e){if(!i._bottomNameText){this._bottomNameText=this.getLabText(a,t)}if(i._bottomNameText.setVisible(!0),i._bottomNameTextString!=e){this._bottomNameTextString=e,this._bottomNameText.setText(e)}if(i.setBottomBg(),i._bottomBg&&!i._bottomBg.parent){this.addChild(this._bottomBg)}if(i._bottomNameText&&!i._bottomNameText.parent){this.addChild(this._bottomNameText)}i.setBottomNamePos()}else{if(this._bottomNameText){this._bottomNameTextString=e,this._bottomNameText.setText(e),this._bottomNameText.setVisible(!1)}}},setBottomNamePos:function(){if(this._bottomNameText){var e=game.IconSizeEnum.GRID_SIZE_105,t=(game.IconWidthSizeEnumMap[e]>>1)-17-this._bottomNameText.width,a=13-(e>>1);this._bottomNameText.setPosition(t,a)}},fnOnClickGrid:function(){if(this.itemInfo){var e=game.equipData.getPetEquipInfoByIdx(this.itemInfo.idx);game.tipsData.setInfo(e),3==e.type?game.module.show(game.ME.ExcEquipDetailsTips):game.module.show(game.ME.EquipDetailsTips)}else;},addTopNameText:function(){if(this._topNameText&&!this._topNameText.parent){this.addChild(this._topNameText)}},addTopRightNameText:function(){if(this._topRightNameText&&!this._topRightNameText.parent){this.addChild(this._topRightNameText)}},addBottomNameText:function(){if(this._bottomNameText&&!this._bottomNameText.parent){this.addChild(this._bottomNameText)}},setTopBg:function(){this._topBg.setVisible(!0),this._topBg.scale9Inset={top:8,bottom:8,left:11,right:11},this._topBg.loadTexture(game.ResCfg.getUrl(239)),this.setTopBgPos()},setTopBgPos:function(){if(this._topBg&&this._topNameText){var e=game.IconSizeEnum.GRID_SIZE_105,t=10-(game.IconWidthSizeEnumMap[e]>>1),a=(e>>1)-10;this._topBg.setPosition(t,a)}},setTopBgSize:function(){if(this._topNameText&&this._topRightNameText){this._topBg.setSize(this._topNameText.width+this._topRightNameText.width+8,this._topNameText.height)}},setBottomBg:function(){var e=this;if(!e._bottomBg){this._bottomBg=b8e.Sprite.get(),this._bottomBg.setStyle(b8e.SpriteStyle.SLICED),this._bottomBg.setAnchor(1,0)}e._bottomBg.setVisible(!0),e._bottomBg.scale9Inset={top:8,bottom:8,left:11,right:11},e._bottomBg.loadTexture(game.ResCfg.getUrl(239)),e.setBottomBgPos(),e.setBottomBgSize()},setBottomBgPos:function(){if(this._bottomBg&&this._bottomNameText){var e=game.IconSizeEnum.GRID_SIZE_105,t=(game.IconWidthSizeEnumMap[e]>>1)-11,a=14-(e>>1);this._bottomBg.setPosition(t,a)}},setBottomBgSize:function(){this._bottomNameText&&this._bottomBg.setSize(this._bottomNameText.width+12,24)},clearData:function(){var e=this;if(e._super(),e._bottomNameText){this._bottomNameTextString="",this._bottomNameText.removeFromParent()}if(e._topRightNameText){this._topRightNameTextString="",this._topRightNameText.removeFromParent()}if(e._topNameText){this._topNameTextString="",this._topNameText.removeFromParent()}if(e._topBg){this._topBg.removeFromParent()}if(e._bottomBg){this._bottomBg.removeFromParent()}}}),b8e.RC("$$game","$$FosterEquipIcon",e)}(),function(){var e;(e=game.GameIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.SIZE_70;this._super(t)},setItemInfo:function(e,t,a){var i=this;if(1<arguments.length&&void 0!==t&&t){this.clearData()}i.itemInfo=e;var n=i.itemInfo.getCfg();if(n){var s=n.icon;if(!s||""==s||"0"==s){s="1"}var o=i.itemInfo.isActive?n.lv:n.openLv+game.Lang.get(9591),r=game.ResCfg.getUrl(i.itemInfo.isActive?63:64,s);i.setIcon(r),i.setSkillLv(o);var g=!1,l=i.itemInfo.getMaxLv();if(i.itemInfo.isActive&&n.itemNum<=game.itemData.getNumById(n.itemId)&&n.lv<l){g=!0}i.setRedIcon(g)}else;},setIcon:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!=t)if(a._iconResName!=t){if(!a._iconImg){this._iconImg=b8e.Sprite.get(),this._iconImg.setAnchor(.5,.5)}if(a._iconImg&&!a._iconImg.parent){this.addChild(this._iconImg)}a._iconImg.setSize(a._iconSize,a._iconSize),a._iconImg.setVisible(!0),a._iconResName=t,a._iconImg.loadTexture(a._iconResName)}else a._iconImg&&(a._iconImg.setSize(a._iconSize,a._iconSize),a._iconImg.setVisible(!0));else a._iconImg&&a._iconImg.setVisible(!1)},setSkillLv:function(e){var t=this;if(!t._lvText){this._lvText=this.getLabText()}if(e+="",t._lvTextString!=e){this._lvTextString=e,this._lvText.setText(e)}t.setLvBg(),t._lvText&&!t._lvText.parent&&t._lvBg.addChild(t._lvText),t._lvText.setFontSize(16),t.setLvBgSize(),t.setLvTextPos()},setLvTextPos:function(){if(this._lvText){var e=-this._lvBg.width>>1,t=this._lvText.height>>1;this._lvText.setPosition(e,t)}},getLabText:function(){var e=b8e.Label.get();if(this.iconSize==game.IconSizeEnum.SIZE_60){e.setFontSize(14),e.setLineHeight(15)}else e.setFontSize(16),e.setLineHeight(17);return e.setAnchor(.5,.5),e},setLvBg:function(){if(!this._lvBg){var e=this;e._lvBg=b8e.Sprite.get(),e._lvBg.setStyle(b8e.SpriteStyle.SLICED),e._lvBg.setAnchor(1,0),e._lvBg.scale9Inset={top:0,bottom:0,left:10,right:11},e._lvBg.loadTexture(game.ResCfg.getUrl(239))}this.addLvBg(),this._lvBg.setVisible(!0),this.setLvBgPos()},setLvBgPos:function(){if(this._lvBg){var e=1+(this.iconSize>>1),t=4-(this.iconSize>>1);this._lvBg.setPosition(e,t)}},setLvBgSize:function(){var e=this,t=void 0;e._lvText&&(t=e._lvText.width<20?20:55<e._lvText.width?e._iconSize:e._lvText.width+20,e._lvBg.setSize(t,18))},addLvBg:function(){if(this._lvBg&&!this._lvBg.parent){this.addChild(this._lvBg)}},setRedIcon:function(e){var t=0<arguments.length&&void 0!==e&&e;if(t){if(!this._redIcon){var a=this;a._redIcon=b8e.Sprite.get(),a._redIcon.setAnchor(.5,.5),a._redIcon.setPosition((a.iconSize>>1)-10,(a.iconSize>>1)-10);var i=game.ResCfg.getImgUrl("icon/redIcon");a._redIcon.loadTexture(i),a._redIcon.setVisible(!1)}if(this._redIcon&&!this._redIcon.parent){this.addChild(this._redIcon)}this._redIcon.setVisible(t)}else{if(this._redIcon){this._redIcon.setVisible(t)}}},addRedIcon:function(){if(this._redIcon&&!this._redIcon.parent){this.addChild(this._redIcon)}},addLabLvText:function(){if(this._lvText&&!this._lvText.parent){this.addChild(this._lvText)}},clearData:function(){if(this._super(),this._redIcon){this._redIcon.removeFromParent(),this._redIcon.setVisible(!1)}if(this._lvBg){this._lvBg.removeFromParent(),this._lvBg.setVisible(!1)}}})).poolCall=!0,b8e.RC("$$game","$$FosterSkillIcon",e)}(),function(){var e;e=game.EquipSlotIcon.extends({setAlert:function(e){var t=this;t._alertImg||(t._alertImg=b8e.Sprite.get(),t._alertImg.setAnchor(.5,.5),t._alertImg.setPosition(30,30),t._alertImg.loadTexture(game.ResCfg.getUrl(5))),e?t._alertImg.parent||t.addChild(t._alertImg):t._alertImg.removeFromParent(),t._alertImg.setVisible(e)},clearData:function(){var e=this;e._super(),e._alertImg&&(e._alertImg.removeFromParent(),e._alertImg.setVisible(!1)),e._fhBgImg&&(e._fhBgImg.removeFromParent(),e._fhBgImg.setVisible(!1)),e._fhLvText&&(e._fhLvText.removeFromParent(),e._fhLvText.setVisible(!1))},setFhLvBg:function(){var e=this;e._fhBgImg||(e._fhBgImg=b8e.Sprite.get(),e._fhBgImg.setAnchor(.5,.5),e._fhBgImg.setPosition(0,-28),e._fhBgImg.loadTexture(game.ResCfg.getUrl(196))),e._fhBgImg.parent||e.addChild(e._fhBgImg),e._fhBgImg.setVisible(!0)},setFhLvLab:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:game.Color.WHITE,n=2<arguments.length&&void 0!==a?a:18,s=this,o="+"+e;s.setFhLvBg(),s._fhLvText||(s._fhLvText=s.getLabText(n,i),s._fhLvText.setPosition(8,-42)),s._fhLvText.isBold(!0),s._fhLvText&&!s._fhLvText.parent&&s.addChild(s._fhLvText),s._fhLvText.setVisible(!0),s._fhLvText.setText(o),s._fhLvText.setColor(i)}}),b8e.RC("$$game","$$GodEquipSlotIcon",e)}(),function(){var e;e=game.GameIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.SIZE_104;this._super(t)},setData:function(e){this.skillId=e,this._updateSkillData(game.SkillCfg.getData(e))},_updateSkillData:function(e){e&&this.setSkillData(e)},setSkillData:function(e){if(e){this.setBgImage(e.quality);var t=game.ResCfg.getUrl(62,e.icon);this.setIcon(t,.72,.72)}},getBgUrl:function(e){return game.ResCfg.getUrl(92,e)},calIconSize:function(){return this._iconSize}}),b8e.RC("$$game","$$ShengZhuangSkillIcon",e)}(),function(){var e;e=game.GameIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.GRID_SIZE_42,a=this;a._super(t),b8e.evt.onC(a,a.fnOnClickGrid,a),a.itemInfo={id:0},b8e.evt.addButtonHandler(a)},setItemId:function(e){if(e){this.itemInfo.id=e;var t=game.ItemInfoCfg.getData(e);if(t){var a=t.icon;a&&""!=a&&"0"!=a||(a="1"),this.setIcon(game.ResCfg.getUrl(137,a))}}},fnOnClickGrid:function(){this.itemInfo.id&&(game.tipsData.setInfo(this.itemInfo),game.module.show(game.ME.ItemTips))}}),b8e.RC("$$game","$$ViewClicklIcon",e)}(),function(){var e;(e=game.ItemIcon.extends({_cfg:null,itemInfo:null,isShowName:!0,isShowNum:!0,ctor:function(e){e=e||game.IconSizeEnum.GRID_SIZE_84,this._super(e)},setItemInfo:function(e,t,a,i){var n=1<arguments.length&&void 0!==t&&t,s=2<arguments.length&&void 0!==a?a:2,o=!(3<arguments.length&&void 0!==i)||i;this._super(e,n,s,o)},clearData:function(){this._super()}})).poolCall=!0,b8e.RC("$$game","$$PrizeIcon",e)}(),function(){var e;(e=b8e.BaseDisplay.extends({_cfg:null,puzzleInfo:null,_iconSize:0,_iconImg:null,_iconResName:"",ctor:function(e){var t=this;t._super(),t.setIconSize(e),t.setAnchor(0,1),b8e.evt.onC(t,t._fnOnClickGrid,t)},setIcon:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=this;if(""!=t){var i=a.calIconSize();if(a._iconResName!=t){if(!a._iconImg){this._iconImg=b8e.Sprite.get(),this._iconImg.setAnchor(0,1)}if(a._iconImg&&!a._iconImg.parent){this.addChild(this._iconImg)}a._iconImg.setSize(i,i),a._iconImg.setVisible(!0),a._iconResName=t,a._iconImg.loadTexture(a._iconResName)}else{if(this._iconImg){this._iconImg.setSize(i,i),this._iconImg.setVisible(!0)}}}else{if(this._iconImg){this._iconImg.setVisible(!1)}}},calIconSize:function(){return this._iconSize},iconSize:{get:function(){return this._iconSize}},iconResName:{get:function(){return this._iconResName}},addIconImage:function(){if(this._iconImg&&!this._iconImg.parent){this.addChild(this._iconImg)}},setIconSize:function(e){this._iconSize=e,this.setSize(this._iconSize,this._iconSize)},setPuzzleInfo:function(e,t,a){var i=this;if(2<arguments.length&&void 0!==a&&a&&i.clearData(),i.puzzleInfo=e,i.puzzleInfo&&(i._cfg=e.cfg,i._cfg)){var n=i._cfg.icon;i.setIcon(game.ResCfg.getUrl(153,n)),i.setIconSize(t),i._iconImg&&i._iconImg.setSize(t,t)}},_fnOnClickGrid:function(){var e=this;e._clickCb&&e._clickCb.thisArg&&e._clickCb.func.call(e._clickCb.thisArg,e)},setClickCb:function(e,t){this._clickCb=e?{func:e,thisArg:t}:null},clearData:function(){if(this._iconImg){this._iconResName="",this._iconImg.unloadTexture()}}})).poolCall=!0,b8e.RC("$$game","$$PuzzleIcon",e)}(),function(){var e;e=game.EquipIcon.extends({ctor:function(){this._super()},setItemInfo:function(e,t,a,i){var n=1<arguments.length&&void 0!==t&&t,s=2<arguments.length&&void 0!==a?a:0,o=!(3<arguments.length&&void 0!==i)||i;this._super(e,n,s,o)},fnOnClickGrid:function(){},clearData:function(){this._super()}}),b8e.RC("$$game","$$SellEquipIcon",e)}(),function(){var e;e=game.FosterEquipIcon.extends({_cfg:null,itemInfo:null,ctor:function(){this._super(game.IconSizeEnum.GRID_SIZE_105)},setItemInfo:function(e,t,a,i){var n=1<arguments.length&&void 0!==t&&t,s=2<arguments.length&&void 0!==a?a:0,o=!(3<arguments.length&&void 0!==i)||i;this._super(e,n,s,o)},fnOnClickGrid:function(){},clearData:function(){this._super()}}),b8e.RC("$$game","$$SellFosterEquipIcon",e)}(),function(){var e;e=game.ItemIcon.extends({ctor:function(e){if(!e){e=game.IconSizeEnum.SIZE_84}this._super(e)},setItemInfo:function(e,t,a,i){var n=1<arguments.length&&void 0!==t&&t,s=2<arguments.length&&void 0!==a?a:2,o=!(3<arguments.length&&void 0!==i)||i;this._super(e,n,s,o)},clearData:function(){this._super()}}),b8e.RC("$$game","$$ShopIcon",e)}(),function(){var e;e=game.ItemIcon.extends({_cfg:null,ctor:function(e){this._super(e)},setItemInfo:function(e,t,a,i){var n=2<arguments.length&&void 0!==a?a:0,s=!(3<arguments.length&&void 0!==i)||i,o=this;if(1<arguments.length&&void 0!==t&&t&&o.clearData(),o.itemInfo=e,o.itemInfo){o.setIconType(n);var r=e.id,g=e.num,l=o._cfg=game.ItemInfoCfg.getData(r);if(l){o.setBgImage(game.ResCfg.getQualityBg(l.quality));var c=l.icon;c&&""!=c&&"0"!=c||(c="1"),o.setIcon(game.ResCfg.getUrl(137,c)),o.setHunluQualityImg(l),s&&o.setEffect(l.qualityEffect),o.isShowNum?l.cfgType==game.ItemCfgType.Amount?o.setNum(g,null,null,!0,2):o.setNum(g):o.setNum("")}}else o.setBgImage(game.ResCfg.getQualityBg(0))}}),b8e.RC("$$game","$$TipsIcon",e)}(),function(){var e;e=game.ItemIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.GRID_SIZE_84;this._super(t)},setItemInfo:function(e,t,a,i,n){var s=1<arguments.length&&void 0!==t&&t,o=2<arguments.length&&void 0!==a?a:"",r=3<arguments.length&&void 0!==i&&i,g=4<arguments.length&&void 0!==n?n:game.IconLayoutEnum.SHOW_ALL,l=this;l._super(e,r,g,!1);var c=game.TreasureItemCfg.getData(e.cfgId);c?(l.setEffect(c.qualityEffect),l.setEffect1(c.qualityEffect1)):(l._effect&&(l._effect.clear(),l._effect.parent&&l._effect.removeFromParent()),l._effect1&&(l._effect1.clear(),l._effect1.parent&&l._effect1.removeFromParent())),l.setTag(s),l.setTitle(o)},setEffect1:function(e){var t=this;if(e&&""!=e){if(!t._effect1){t._effect1=b8e.Animator.get(game.AnimType.ITEM_EFFECT,2)}if(t._effect1&&!t._effect1.parent){t.addChild(t._effect1)}var a=this.calIconScale();this._effect1.setScale(a,a);var i=game.ResCfg.getUrl(5022,e);t._effect1.load(i),t._effect1.play()}else{if(t._effect1){if(t._effect1.clear(),t._effect1.parent){t._effect1.removeFromParent()}}}},setTag:function(e){if(e){this.addTagEffect(game.ResCfg.getUrl(5019,2001))}else this.clearTagEffect()},setTitle:function(e){if(this.itemInfo){var t=game.ItemInfoCfg.getData(this.itemInfo.id);if(e&&""!=e){var a=this;if(!a._titleBg){this._titleBg=b8e.Sprite.get(),this._titleBg.setAnchor(.5,.5),this.addChild(this._titleBg)}if(a._titleBg.setPosition(0,-(a.iconSize>>1)-10),a._titleBg.setVisible(!0),a._titleBg.loadTexture(game.ResCfg.getImgUrl("turnplate/titleBg")),!a._titleText){var i=this;i._titleText=i.getRichText(),i._titleText.setAnchor(.5,.5),i._titleBg.addChild(i._titleText)}a._titleText.setVisible(!0),a._titleText.setText(game.HtmlUtil.getColorStrByQuality(t.quality,e))}else this.clearTitle()}else{this.clearTitle()}},getRichText:function(e){e=e||18;var t=b8e.RichText.get();return t.setFontSize(e),t},clearTitle:function(){if(this._titleBg){this._titleBg.setVisible(!1),this._titleBg.unloadTexture()}if(this._titleText){this._titleText.setText(""),this._titleText.setVisible(!1)}},addTagEffect:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:1,n=2<arguments.length&&void 0!==a?a:1;if(!this._tagEffect){this._tagEffect=b8e.BaseDisplay.get(),this._tagEffect.setAnchor(.5,.5),this._tagEffect.addToParent(this)}if(e){var s=this;if(!s._anim){this._anim=b8e.Animator.get(game.AnimType.EFFECT,1),this._tagEffect.addChild(this._anim)}s._tagEffect.setVisible(!0),s._tagEffect.setScale(i,n),s._anim.load(e),s._anim.play()}else if(this._anim){this._anim.clear()}},clearTagEffect:function(){if(this._anim){this._anim.clear()}if(this._tagEffect){this._tagEffect.setVisible(!1)}},fnOnClickGrid:function(){if(this.itemInfo){game.tipsData.setInfo(this.itemInfo);var e=game.ItemInfoCfg.getCfgTypeById(this.itemInfo.id);game.module.show(e==game.ItemCfgType.Equip?game.ME.EquipTips:game.ME.ItemTips)}else;},clearData:function(){if(this._super(),this.clearTagEffect(),this.clearTitle(),this._effect1){this._effect1.clear(),this._effect1.removeFromParent()}}}),b8e.RC("$$game","$$TurnplateIcon",e)}(),function(){var e;e=b8e.BaseDisplay.extends({setString:function(e){var t=this;t._bg_left||(t._bg_left=b8e.Sprite.get(),t._bg_left.setAnchor(1,.5),t._bg_left.setPosition(-23,0),t._bg_left.setStyle(b8e.SpriteStyle.SLICED),t._bg_left.scale9Inset={top:0,bottom:0,left:104,right:0},t._bg_left.loadTexture(game.ResCfg.getImgUrl("SpeechBubble/bg_left")),t.addChild(t._bg_left)),t._bg_right||(t._bg_right=b8e.Sprite.get(),t._bg_right.setAnchor(0,.5),t._bg_right.setPosition(23,0),t._bg_right.setStyle(b8e.SpriteStyle.SLICED),t._bg_right.scale9Inset={top:0,bottom:0,left:0,right:104},t._bg_right.loadTexture(game.ResCfg.getImgUrl("SpeechBubble/bg_right")),t.addChild(t._bg_right)),t._bg_center||(t._bg_center=b8e.Sprite.get(),t._bg_center.setAnchor(.5,.5),t._bg_center.setStyle(b8e.SpriteStyle.SLICED),t._bg_center.scale9Inset={top:0,bottom:0,left:0,right:0},t._bg_center.loadTexture(game.ResCfg.getImgUrl("SpeechBubble/bg_center")),t.addChild(t._bg_center)),t._lab||(t._lab=b8e.Label.get(),t._lab.setFontFile(b8e.ResMgr.UI_ROOT+"/app/font/story/story_text.bbf"),t._lab.setFontSize(32),t._lab.setLineHeight(34),t._lab.setAnchor(.5,.5),t._bg_center&&t._bg_center.addChild(t._lab)),t._lab.setText(e),b8e.hasTimeout(t._resize,t)||b8e.setTimeout(t._resize,t,150),t._lab.setPosition(0,4),t._lab.setVisible(!1),t._bg_left.setVisible(!1),t._bg_center.setVisible(!1),t._bg_right.setVisible(!1)},_resize:function(){var e=this,t=e._lab.getWidth();t<1&&(t=26*e._lab.string.length),t=(t=198<t?t+60:258)-46>>1,e._bg_left.setSize(t,69),e._bg_center.setSize(46,69),e._bg_right.setSize(t,69),e._lab.setVisible(!0),e._bg_left.setVisible(!0),e._bg_center.setVisible(!0),e._bg_right.setVisible(!0)}}),b8e.RC("$$game","$$SpeechBubble",e)}(),function(){var e;e=game.EquipSlotIcon.extends({ctor:function(e){this._super(e)},fnOnClickGrid:function(){}}),b8e.RC("$$game","$$TransferEquipSlotIcon",e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(100,110)},init:function(){var e=this;e._icon=game.GridUtil.createItemIcon(game.IconSizeEnum.GRID_SIZE_105),e._icon.setAnchor(.5,.5),e._icon.setPosition(50,-52),e._icon.addToParent(e)},setData:function(){this.data&&game.GridUtil.setItemIcon(this._icon,this.data,!1,game.IconLayoutEnum.SHOW_ALL)}})).poolCall=!0,b8e.RC("$$game","$$AwardTipIcon",e)}(),function(){var e;e=game.ItemIcon.extends({nameLab:null,strengLvBg:null,strengLvLab:null,stepLab:null,isShowStreng:!0,canClick:!0,isShowOpBtn:!1,setData:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i=this;e?(i.setItemActive(!0),i.setItemInfo(e),i.setStreng(e.lv),i.setNameActive(a),a&&i.setLabNamePos(0,0),e.cfg&&i.setStep(e.cfg.level)):(i.setItemActive(!1),i.setNameActive(!1)),i.info=e},setCfg:function(e){var t=this;t.setName(""),t.setStreng(0),t.setStep(e.level),t.setBgImage(game.ResCfg.getQualityBg(e.quality)),t.setIcon(game.ResCfg.getUrl(137,e.icon)),t.setEffect(e.qualityEffect)},setItemActive:function(e){var t=this;t.strengLvBg&&(t.strengLvBg.setVisible(e),t.strengLvLab.setVisible(e)),t.stepLab&&t.stepLab.setVisible(e)},setNameActive:function(e){e||this.setName(""),this.nameLab&&this.nameLab.setVisible(e)},setStreng:function(e){var t=this;t.strengLvBg||(t.strengLvBg=b8e.Sprite.get(),t.strengLvBg.setStyle(b8e.SpriteStyle.SLICED),t.strengLvBg.scale9Inset={top:18,bottom:18,left:18,right:18},t.strengLvBg.setAnchor(.5,.5),t.strengLvBg.setSize(50,18),t.strengLvBg.loadTexture(game.ResCfg.getUrl(71,"skillNameBg")),t.addChild(t.strengLvBg),t.strengLvBg.setPosition(-15,-27)),t.strengLvLab||(t.strengLvLab=b8e.Label.get(),t.strengLvLab.setAnchor(.5,.5),t.strengLvLab.setFontSize(18),t.addChild(t.strengLvLab),t.strengLvLab.setPosition(-16,-28));var a="Lv."+e;t.strengLvLab.setText(a)},setStep:function(e){var t=this;t.stepLab||(t.stepLab=b8e.Label.get(),t.stepLab.setAnchor(1,.5),t.stepLab.setFontSize(35),t.addChild(t.stepLab),t.stepLab.setPosition(40,20),t.stepLab.setFontFile(b8e.ResMgr.UI_ROOT+"/app/font/cultivateLv/cultivateLv.bbf"));var a=e+"J";t.stepLab.setText(a)},fnOnClickGrid:function(){this.canClick&&(game.godAnimalEquipData.showIdIdx=this.info.idx,game.godAnimalEquipData.isShowOpBtn=this.isShowOpBtn,game.module.show(game.ME.GodAnimalEquipTips))}}),b8e.RC("$$game","$$GodAnimalEquipIcon",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(e){this._super(e)},get:function(){if(arguments&&!(arguments.length<1)){var e=Array.prototype.slice.call(arguments),t=e[0];return e.shift(),this.getLang(t,e)}b8e.error("BaseLang.get \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570")},getLang:function(e,t){t=this.getArrAgs(t);var a=this.getData(e),i=void 0;return i=a||isNaN(e)?a?a.lang:e:(b8e.warn("\u5ba2\u6237\u7aef\u6587\u5b57\u914d\u7f6e\u8868\uff0c\u627e\u4e0d\u5230\u5bf9\u5e94\u7684id\uff1a ",e," \u662f\u5426\u662f\u6ca1\u6709\u540c\u6b65\u8868\uff01\uff01\uff01"),a?a.lang:t?"$":""),i=this.replaceStr(i,t)},getArrAgs:function(e){return e&&1==e.length&&e[0]instanceof Array&&(e=e[0]),e},replaceStr:function(e,t){if(null!=(t=this.getArrAgs(t))&&0<t.length&&null!=e){var a=void 0,i=t.length;for(a=0;a<i;a++)e=e.replace("$",t[a])}return e},specialReplaceStr:function(e,t){if(null!=(t=this.getArrAgs(t))&&0<t.length&&null!=e){var a=void 0,i=t.length;for(a=0;a<i;a++)e=e.replace("@",t[a])}return e}}),b8e.RC("$$game","$$BaseLang",e)}();p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;e=b8e.GameConfig.extends({ctor:function(e){this._super(e)},get:function(e){var t=this,a="";if(!arguments||0==arguments.length)return b8e.error("UIUrl get \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570"),a;var i=e;if(void 0!==i&&(void 0===i?"undefined":p(i))!=b8e.TypeNumber)return b8e.error("UIUrl key \u5fc5\u987b\u662f\u4e00\u4e2a\u6570\u5b57\uff01 key\uff1a"+i),a;if(t._uiUrlList&&0<t._uiUrlList.length&&(a=t._uiUrlList[i]))return a;var n=t.getData(i);return n&&n.url&&(t._uiUrlList||(t._uiUrlList=[]),a=n.url,t._uiUrlList[i]=a),a}}),b8e.RC("$$game","$$UIUrl",e)})(),function(){var e;game.AE=e=b8e.Enum({A1:-1,A2:-1,A3:-1,A4:-1,A5:-1,A6:-1,A7:-1,A8:-1}),b8e.RC("$$game","$$AsyncEnum",e)}();p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,h=e=game.AsyncData=b8e.PoolObject.extends({asyncType:0,tempKeyObj:null,tempProp:null,ctor:function(){this._super()},setHashKey:function(e,t){this._target=e,this._thisArg=t},addAsyncData:function(e,t,a,i,n,s){var o=this;o._queueList||(o._queueList=[]),o._queueList.length<1?(o._addQueueList(e,t,a,i,n,s),o._queueIndex=0,o.asyncType==m.MULTIPLE&&(o.keysIndex=0),o._getNextAsyncConfig()):o._addQueueList(e,t,a,i,n,s)},_addQueueList:function(e,t,a,i,n,s){this._queueList[this._queueList.length]=this.getAsyncObj(e,t,a,i,n,s)},_getNextAsyncConfig:function(){var e=this;if(e._queueIndex>e._queueList.length-1)return e.asyncType==m.NONE||e.asyncType==m.MULTIPLE?h.recycleAsyncData(e._thisArg,e._target):e.asyncType==m.ANONYMITY&&h.clearAsyncEnumList(e._target),void e._recycleQueueObj();var t=void 0,a=e._queueList[e._queueIndex],i=void 0;if(e.asyncType==m.MULTIPLE){var n=a.keys[e.keysIndex];if(n=e.getTempKeyObj(n),i=[e._getDataAsyncComplete,e],a.optionalArgs){var s=a.optionalArgs[e.keysIndex];s&&(i=[e._getDataAsyncComplete,e].concat(s))}t=n.concat(i)}else{i=a.optionalArgs?[e._getDataAsyncComplete,e].concat(a.optionalArgs):[e._getDataAsyncComplete,e];var o=a.keys;t=(o=e.getTempKeyObj(o)).concat(i)}a.cls.getDataAsync.apply(a.cls,t)},_getDataAsyncComplete:function(e){var t=this;e||b8e.warn("AsyncData._getDataAsyncComplete \u914d\u7f6e\u627e\u4e0d\u5230\uff01");var a=t._queueList[t._queueIndex];if(a){if(t.asyncType==m.MULTIPLE)if(t.keysIndex==a.keys.length-1){if(a.func&&a.thisArg){t._tempDatas.push(e);var i=t._tempDatas.concat(),n=(a.funcArgs?i.concat(a.funcArgs):i).concat([t]);a.func.apply(a.thisArg,n),t._queueIndex++,t.keysIndex=0,t._tempDatas.length=0,t._getNextAsyncConfig()}}else t._tempDatas||(t._tempDatas=[]),t._tempDatas.push(e),t.keysIndex++,t._getNextAsyncConfig();else if(a.func&&a.thisArg){var s=[e],o=(a.funcArgs?s.concat(a.funcArgs):s).concat([t]);a.func.apply(a.thisArg,o),t._queueIndex++,t._getNextAsyncConfig()}}else b8e.warn("\u627e\u4e0d\u5230t._queueIndex\u5bf9\u5e94\u7684\u6570\u636e\uff01")},getAsyncObj:function(e,t,a,i,n,s){var o=void 0;return(o=this._queueObjPool&&1<this._queueObjPool.length?this._queueObjPool.pop():b8e.createMap()).cls=e,o.keys=t,o.func=a,o.thisArg=i,o.funcArgs=n,o.optionalArgs=s,o},getTempKeyObj:function(e){if(e&&0<e.length){var t=e[0];if(t&&(void 0===t?"undefined":p(t))==b8e.TypeObject){for(var a in t)this.tempKeyObj[this.tempProp]=t[a];e[0]=this.tempKeyObj}}return e},getKeyObj:function(){return this._keyObjPool&&1<this._keyObjPool.length?this._keyObjPool.pop():b8e.createMap()},_recycleQueueObj:function(){var e=this;if(e._queueList){e._queueObjPool||(e._queueObjPool=[]);for(var t=void 0;e._queueList.length;)(t=e._queueList.pop())&&(t.cls=null,t.keys=null,t.func=null,t.thisArg=null,t.funcArgs=null,t.optionalArgs=null,e._queueObjPool.push(t));e._queueList.length=0}if(e.keyObjList){e._keyObjPool||(e._keyObjPool=[]);for(var a=void 0;e.keyObjList.length;)if(a=e.keyObjList.pop()){for(var i in a)a[i]=null;e._keyObjPool.push(a)}e.keyObjList.length=0}e._tempDatas&&(e._tempDatas.length=0),e._target=null,e._thisArg=null},recycle:function(){this._recycleQueueObj(),this._super()}}),t=new b8e.Pool(h,1024);h.get=function(){return t.get()},h.put=function(e){return t.put(e)},h.poolCall=!0,h.asyncFuncMap=b8e.HashMap.get(),h.asyncEnumList=[];var m=b8e.Enum({NONE:0,ANONYMITY:1,MULTIPLE:2});h.AsyncType=m,h.getAsyncData=function(){if(!arguments||arguments.length<1)b8e.error("AsyncData.getAsyncData \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570");else{var e=arguments,t=e[0],a=e[1],i=e[3],n=e[4],s=e[5],o=e[6];if(!e[2]||e[2].length<1)b8e.warn("AsyncData.getAsyncData \u6ca1\u6709\u4f20\u53c2\u6570");else{var r=h.asyncEnumList,g=(r=r||[])[t];if(g){g.asyncType=m.ANONYMITY;var l=h._setTempObj(e[2],g);g.addAsyncData(a,l,i,n,s,o)}else{(g=h.get()).asyncType=m.ANONYMITY,g.setHashKey(t,n);var c=h._setTempObj(e[2],g);g.addAsyncData(a,c,i,n,s,o),r[t]=g}}}},h.clearAsyncEnumList=function(e){var t=h.asyncEnumList;t&&t[e]&&(h.put(t[e]),t[e]=null)},h.getEAsyncData=function(){if(!arguments||arguments.length<1)b8e.error("AsyncData.getEAsyncData \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570");else{var e=arguments;h._setAsyncData(e,m.NONE)}},h.getMAsyncData=function(){if(!arguments||arguments.length<1)b8e.error("AsyncData.getMAsyncData \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570");else{var e=arguments;h._setAsyncData(e,m.MULTIPLE)}},h._setAsyncData=function(e,t){var a=e[0],i=e[2],n=e[3],s=e[4],o=e[5];if(b8e.applyType(i),i.__TypeFunction){var r=h.asyncFuncMap,g=r.get(i,n);if(g){g.asyncType=t;var l=h._setTempObj(e[1],g);return g.getAsyncObj(a,l,i,n,s,o),void g.addAsyncData(a,l,i,n,s,o)}g=h.get(),r.set(i,g,n),g.asyncType=t,g.setHashKey(i,n);var c=h._setTempObj(e[1],g);g.getAsyncObj(a,c,i,n,s,o),g.addAsyncData(a,c,i,n,s,o)}else b8e.warn(2020)},h._setTempObj=function(e,t){if(e&&0<e.length){var a=e[0];if(e[1]&&p(e[1])==b8e.TypeObject&&b8e.warn("AsyncData \u6682\u65f6\u4e0d\u652f\u6301\u591a\u4e2a\u5bf9\u8c61"),a&&(void 0===a?"undefined":p(a))==b8e.TypeObject){var i=void 0;for(var n in a)t.tempKeyObj||(t.tempKeyObj=b8e.createMap(),t.tempProp=n,t.tempKeyObj[n]=null),(i=t.getKeyObj())[n]=a[n];t.keyObjList||(t.keyObjList=[]),t.keyObjList[t.keyObjList.length]=i,e[0]=i}}return e},h.recycleAsyncData=function(e,t){if(b8e.applyType(t),t.__TypeFunction){var a=h.asyncFuncMap,i=a.get(t,e);i?(h.put(i),a.del(t,e)):b8e.warn("\u6ce8\u610f\uff1a\u8bd5\u56fe\u79fb\u9664\u4e0d\u5b58\u5728\u7684AsyncData\uff01")}else b8e.warn(2020)},b8e.RC("$$game","$$asyncData",e)})(),function(){var e;e=b8e.Enum({PUBLIC_BOSS:0,CS_ARENA:1,GENERAL_BOSS:2,GUOSHI_CHALLENGE:3,MYSTER_SHOP:4,LEAGUE_ASSIST:5,ZHUANJI_COST:6}),b8e.RC("$$game","$$CostType",e)}(),function(){var a=game.ResCfg=function(){};a.getUrl=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a=game.ResUrlCfg.getUData(e);if(!a)return"";var i="";return i+=a.resRoot,i+=a.resUrl,i+=t,-1!=(i+=a.resSuffix).indexOf(".btb")&&(i=i.replace(".btb",".btf")),i},a.getImgUrl=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return a.getUrl(t?151:70,e)},a.getQualityBg=function(){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:84)+"_"+(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)},a.getHead=function(e){return a.getUrl(59,e?"head_1":"head_2")}}(),function(){var e=b8e.Object.extends({_config:null,_initModuleConfig:function(){var e=this._config;e.allot("_$UIUrl","UIUrl","_$UIUrl"),e.allot("_$ModuleCfg","OpenModule","_$TriggerCfg"),e.allot("_$ModuleMiscCfg","OpenModuleMisc"),e.allot("_$SceneCfg","Map","_$SceneCfg"),e.allot("_$FosterItemMiscCfg","FosterItemMisc"),e.allot("_$ItemInfoCfg","NormalItem","_$ItemInfoCfg"),e.allot("_$ItemInfoCfg","Equip","_$ItemInfoCfg"),e.allot("_$ItemInfoCfg","PartnerProper","_$ItemInfoCfg"),e.allot("_$ItemInfoCfg","Amount","_$ItemInfoCfg"),e.allot("_$ItemInfoCfg","EffectItem","_$ItemInfoCfg"),e.allot("_$ItemInfoCfg","ShowItem","_$ItemInfoCfg"),e.allot("_$PlayBackPosCfg","FightPos"),e.allot("_$LangSkill","LangSkill","_$BaseLang"),e.allot("_$SkillCfg","Skill"),e.allot("_$ClientSkillCfg","ClientSkill"),e.allot("_$BuffCfg","Buff"),e.allot("_$AttrRulesCfg","AttrRules"),e.allot("_$AttrPowerCoefCfg","AttrPowerCoef"),e.allot("_$RoleExpCfg","RoleExp"),e.allot("_$RoleLvUpCfg","RoleLvUp"),e.allot("_$ClientGMCfg","ClientGM"),e.allot("_$ServerGMCfg","ServerGM"),e.allot("_$NoticeCfg","Notice"),e.allot("_$SkillMiscCfg","SkillMisc"),e.allot("_$EffectSkillCfg","EffectSkill"),e.allot("_$ClientEffectDescCfg","ClientEffectDesc"),e.allot("_$MailLang","MailText","_$BaseLang"),e.allot("_$MarqueeLang","MarqueeText","_$BaseLang"),e.allot("_$Lang","Lang","_$BaseLang"),e.allot("_$UILang","UILang","_$BaseLang"),e.allot("_$AnimGMCfg","AnimGM"),e.allot("_$ChatCfg","Chat"),e.allot("_$ChatContentCfg","ChatContent"),e.allot("_$ForgeQualityCfg","EquipCostRate"),e.allot("_$ForgeAttrRateCfg","EquipAttrRate"),e.allot("_$ForgeUpgradeCfg","EquipQianghua","_$ForgeUpgradeCfg"),e.allot("_$ForgeRefineCfg","EquipChuilian","_$ForgeRefineCfg"),e.allot("_$ForgePurifyCfg","EquipFuhun","_$ForgePurifyCfg"),e.allot("_$ForgeGemCfg","EquipGem","_$ForgeGemCfg"),e.allot("_$ForgeMasterCfg","EquipMaster","_$ForgeMasterCfg"),e.allot("_$ForgeMiscCfg","EquipForgeMisc"),e.allot("_$ForgeZhulingCfg","EquipZhuling","_$ForgeZhulingCfg"),e.allot("_$RankCfg","Rank"),e.allot("_$SuitExpertCfg","SuitExpert"),e.allot("_$MaterialCfg","Material"),e.allot("_$WorldWarCfg","Zhengzhan"),e.allot("_$DailyMiscCfg","DailyMisc"),e.allot("_$DailyDangkouCfg","DailyDangkou","_$DailyDangkouCfg"),e.allot("_$DailyDangkouAwardCfg","DailyDangkouAward","_$DailyDangkouAwardCfg"),e.allot("_$DailyTeamAwardCfg","DailyTeamAward","_$DailyTeamAwardCfg"),e.allot("_$DailyExploitCfg","DailyExpLv","_$DailyExploitCfg"),e.allot("_$DailyExploitMissionCfg","DailyExpGet","_$DailyExploitMissionCfg"),e.allot("_$VipMiscCfg","VipMisc"),e.allot("_$VipCfg","Vip","_$VipCfg"),e.allot("_$VipForeverCfg","VipForever","_$VipForeverCfg"),e.allot("_$TeamInstanceCfg","TeamInstance","_$TeamInstanceCfg"),e.allot("_$InstanceMiscCfg","InstanceMisc"),e.allot("_$MonGroupCfg","MonGroup"),e.allot("_$MonsterCfg","Monster"),e.allot("_$MonDropCfg","MonDrop","_$MonDropCfg"),e.allot("_$InstanceCfg","Instance","_$InstanceCfg"),e.allot("_$InstanceAwardCfg","InstanceAward"),e.allot("_$PersonalBossCfg","Personal","_$PersonalBossCfg"),e.allot("_$PublicBossCfg","QuanMin"),e.allot("_$InstanceHallCfg","InstanceHall"),e.allot("_$DailyTaofaCfg","DailyTaofa"),e.allot("_$DailyTaofaAwardCfg","DailyTaofaAward","_$DailyTaofaAwardCfg"),e.allot("_$ZhanJiangCfg","ZhanJiang","_$ZhanJiangCfg"),e.allot("_$ZhanJiangAwardCfg","ZhanJiangAward"),e.allot("_$ZhaoQinCfg","ZhaoQin","_$ZhaoQinCfg"),e.allot("_$ZhaoQinAwardCfg","ZhaoQinAward"),e.allot("_$XiandiCfg","Xiandi","_$XiandiCfg"),e.allot("_$XiandiStarCfg","XiandiStar","_$XiandiStarCfg"),e.allot("_$XiandiAwardCfg","XiandiAward","_$XiandiAwardCfg"),e.allot("_$NicknameCfg","Nickname","_$NicknameCfg"),e.allot("_$DefaultHero","DefaultHero"),e.allot("_$MasterQuestCfg","MasterQuest"),e.allot("_$InstanceSuccessCfg","InstanceSuccess"),e.allot("_$MasterMiscCfg","MasterMisc","_$MasterMiscCfg"),e.allot("_$MasterExpCfg","MasterExp","_$MasterExpCfg"),e.allot("_$CostCfg","CountCost","_$CostCfg"),e.allot("_$SuitCfg","Suit"),e.allot("_$SuitAttrCfg","SuitAttr","_$SuitAttrCfg"),e.allot("_$SuitSkinCfg","Fashion","_$SuitSkinCfg"),e.allot("_$GuideTriggerCfg","GuideTrigger"),e.allot("_$GuideEffectCfg","GuideEffect"),e.allot("_$GuideViewDescCfg","GuideViewDesc"),e.allot("_$GuideCommandCfg","GuideCommand"),e.allot("_$GuideEventCfg","GuideEvent"),e.allot("_$EscortCfg","Escort","_$EscortCfg"),e.allot("_$EscortMiscCfg","EscortMisc","_$EscortMiscCfg"),e.allot("_$ShopCfg","ShopCfg","_$ShopCfg"),e.allot("_$ShopItemCfg","Shop","_$ShopItemCfg"),e.allot("_$HighEquipMiscCfg","HighEquipMisc"),e.allot("_$GodEquipUpgradeCfg","HighEquipUpgrade","_$GodEquipUpgradeCfg"),e.allot("_$GodEquipWashTypeCostCfg","HighEquipWashType","_$GodEquipCfg"),e.allot("_$GodEquipWashValueCostCfg","HighEquipWashValue","_$GodEquipWashValueCostCfg"),e.allot("_$GodEquipQuenchingCfg","HighEquipRefine"),e.allot("_$GodEquipLvResonanceCfg","HighEquipLv","_$GodEquipCfg"),e.allot("_$GodEquipChainResonanceCfg","HighEquipNumber","_$GodEquipCfg"),e.allot("_$GuildMiscCfg","GuildMisc","_$GuildMiscCfg"),e.allot("_$GuildLvCfg","GuildLv","_$GuildLvCfg"),e.allot("_$GuildSkillCfg","GuildSkill","_$GuildSkillCfg"),e.allot("_$GuildIncenseCfg","GuildIncense"),e.allot("_$GuildIncenseAwardCfg","GuildIncenseAward"),e.allot("_$GuildDonateCfg","GuildDonate"),e.allot("_$GuildShopCfg","GuildShop"),e.allot("_$GuildCollectCfg","GuildCollect","_$GuildCollectCfg"),e.allot("_$GuildBossCfg","GuildBoss"),e.allot("_$ActiveLvCfg","ActiveLv","_$ActiveLvCfg"),e.allot("_$WildBossCfg","Wild"),e.allot("_$RechargeCfg","Recharge","_$RechargeCfg"),e.allot("_$NormalRechargeCfg","NormalRecharge"),e.allot("_$CardRechargeCfg","CardRecharge","_$CardRechargeCfg"),e.allot("_$FirstRechargeCfg","FirstRecharge"),e.allot("_$DiscountRechargeCfg","DiscountRecharge","_$DiscountRechargeCfg"),e.allot("_$DailyRechargeCfg","DailyRecharge","_$DailyRechargeCfg"),e.allot("_$ChooseRechargeCfg","ChooseRecharge"),e.allot("_$RechargeMiscCfg","RechargeMisc"),e.allot("_$ExamCfg","Exam"),e.allot("_$ExamAwardCfg","ExamAward","_$ExamAwardCfg"),e.allot("_$ExamMiscCfg","ExamMisc"),e.allot("_$MarryCfg","Marry"),e.allot("_$MarryGiftsCfg","MarryGifts"),e.allot("_$MarryMiscCfg","MarryMisc"),e.allot("_$HouseAttrCfg","HouseAttr"),e.allot("_$HouseAdvCfg","HouseAdvanced","_$HouseAdvCfg"),e.allot("_$ClientMonsterGenCfg","ClientMonsterGen"),e.allot("_$ClientCollectGenCfg","ClientCollectGen"),e.allot("_$ActivitiesHallCfg","ActivitiesHall"),e.allot("_$ActivitiesHallShowCfg","ActivitiesHallShow"),e.allot("_$RuleCfg","Rule"),e.allot("_$WelfareMiscCfg","WelfareMisc"),e.allot("_$WelfareBtnCfg","WelfareBtn"),e.allot("_$ActiveBarCfg","ActiveBar"),e.allot("_$HomeLeftBarCfg","HomeLeftBar"),e.allot("_$HomeRightBarCfg","HomeRightBar"),e.allot("_$HomeBottomBarCfg","HomeBottomBar"),e.allot("_$MainLeftBarCfg","MainLeftBar"),e.allot("_$ActiveNoticeCfg","ActiveNotice"),e.allot("_$MainRightBarCfg","MainRightBar"),e.allot("_$GameBarMiscCfg","GameBarMisc"),e.allot("_$TreasureCfg","XunbaoDisplay"),e.allot("_$TreasureLuckCfg","XunbaoLuck"),e.allot("_$TreasureLuckStore","XunbaoLuckStore"),e.allot("_$TreasureCostCfg","XunbaoBase","_$TreasureCostCfg"),e.allot("_$TreasureItemCfg","XunbaoGrid"),e.allot("_$TreasureShopCfg","XunbaoShop"),e.allot("_$TreasureMiscCfg","XunbaoMisc"),e.allot("_$LevelAwardCfg","LevelAward"),e.allot("_$SignInAwardCfg","SignAward","_$SignInAwardCfg"),e.allot("_$OpenServiceMiscCfg","OpenServiceMisc"),e.allot("_$OpenServerClientCfg","OpenServerClient"),e.allot("_$InvestPlanCfg","InvestorPlan"),e.allot("_$DianWeiCfg","DianWei"),e.allot("_$DianWeiInsGroupCfg","DianWeiInsGroup","_$DianWeiInsGroupCfg"),e.allot("_$ArenaMiscCfg","ArenaMisc"),e.allot("_$ArenaRewardCfg","ArenaReward","_$ArenaRewardCfg"),e.allot("_$ArenaAimsCfg","ArenaAims"),e.allot("_$LoginAwardCfg","LoginAward"),e.allot("_$RedPacketCfg","HongBao"),e.allot("_$ProgressActivityCfg","ProgressActivity","_$ProgressActivityCfg"),e.allot("_$PlayBackSpeedRatioCfg","PlayBackSpeedRatio"),e.allot("_$ViewTriggerCfg","ViewTrigger"),e.allot("_$ViewPropsCfg","ViewProps"),e.allot("_$ShowViewManagerCfg","ShowViewManager"),e.allot("_$ViewPriorityCfg","ViewPriority"),e.allot("_$BounceCharacterCfg","BounceCharacter"),e.allot("_$BounceCharacterTweenCfg","BounceCharacterTween"),e.allot("_$AmountCfg","amount","_$AmountCfg"),e.allot("_$SilverExchangeCfg","SilverExchange","_$SilverExchangeCfg"),e.allot("_$DailyTaofaStarCfg","DailyTaofaStar"),e.allot("_$SaleRechargeCfg","SaleRecharge"),e.allot("_$CsBossRankAwardCfg","CrossBossRankAward","_$CsBossRankAwardCfg"),e.allot("_$CsBossRankPlayerAwardCfg","CrossBossPlayerRankAward","_$CsBossRankPlayerAwardCfg"),e.allot("_$CsMiscCfg","CrossMisc"),e.allot("_$GuildActiveCfg","GuildActive"),e.allot("_$ActiveAwardCfg","ActiveAward"),e.allot("_$QuanMinPurchaseCfg","QuanMinPurchase","_$QuanMinPurchaseCfg"),e.allot("_$QuanMinPurchaseRuleCfg","QuanMinPurchaseRule"),e.allot("_$UpgradeRebateCfg","UpgradeRebate","_$UpgradeRebateCfg"),e.allot("_$YongzheWelfareCfg","ExpWelfare"),e.allot("_$ClientSettingCfg","ClientSetting"),e.allot("_$ClientSettingTypesCfg","ClientSettingTypes"),e.allot("_$ClientSceneEffectCfg","ClientSceneEffect"),e.allot("_$BoxCfg","Box"),e.allot("_$ThroneBaseCfg","ThroneBase"),e.allot("_$ThroneScoreAwardCfg","ThroneScoreAward"),e.allot("_$ThroneRankCfg","ThroneRank","_$ThroneRankCfg"),e.allot("_$ThroneMonthlyRankCfg","ThroneMonthlyRank"),e.allot("_$ThroneMiscCfg","ThroneMisc"),e.allot("_$CrossWarRankAwardCfg","CrossWarRankAward","_$CrossWarRankAwardCfg"),e.allot("_$BingShuCfg","BingShu"),e.allot("_$BingShuNameCfg","BingShuName"),e.allot("_$BingShuCountCfg","BingShuCount"),e.allot("_$AchievementCfg","Achievement"),e.allot("_$AchievementMiscCfg","AchievementMisc"),e.allot("_$AchievementAllBtnCfg","AchievementAllBtn"),e.allot("_$ZeroCfg","Zero"),e.allot("_$TODSilverCfg","TODSilver"),e.allot("_$TODGoldCostCfg","TODGoldCost"),e.allot("_$GuanDuWarRankAwardCfg","GuanDuWarRankAward"),e.allot("_$ClientTowerGenCfg","ClientTowerGen"),e.allot("_$SceneUnitCfg","SceneUnit"),e.allot("_$CampCfg","Camp"),e.allot("_$ShareAwardCfg","ShareAward"),e.allot("_$XunbaoActivityOpenCfg","XunbaoActivityOpen"),e.allot("_$ArrowCfg","Arrow"),e.allot("_$ArrowRankCfg","ArrowRank"),e.allot("_$ArrowMiscCfg","ArrowMisc"),e.allot("_$GetHuFuCfg","GetHuFu"),e.allot("_$MilitaryRankCfg","MilitaryRank"),e.allot("_$AccumulativeRechargeCfg","AccumulativeRecharge","_$AccumulativeRechargeCfg"),e.allot("_$StickCfg","Stick","_$StickCfg"),e.allot("_$StickRateCfg","StickRate"),e.allot("_$VerifyAwardCfg","VerifyAward"),e.allot("_$WanbaPrizeCfg","WanbaWelfare"),e.allot("_$FestivalBossCfg","FestivalBoss"),e.allot("_$NewYearSignInCfg","NewYearSignIn"),e.allot("_$ContinuousRechargeCfg","ContinuousRecharge","_$ContinuousRechargeCfg"),e.allot("_$ActivateSkillCfg","ActivateSkill"),e.allot("_$TimeLimitPrizeCfg","TimeLimitPrize","_$TimeLimitPrizeCfg"),e.allot("_$WanShouCfg","WanShou","_$WanShouCfg"),e.allot("_$AccumulativeCostCfg","AccumulativeCost"),e.allot("_$KeepCostCfg","KeepCost","_$KeepCostCfg"),e.allot("_$GodArmyMiscCfg","GodArmyMisc"),e.allot("_$GodArmyCfg","GodArmy"),e.allot("_$GodArmyAttrCfg","GodArmyAttr","_$GodArmyAttrCfg"),e.allot("_$GodArmyUpCfg","GodArmyUpgrade","_$GodArmyUpCfg"),e.allot("_$GodArmyTopCfg","GodArmyTop","_$GodArmyTopCfg"),e.allot("_$GodArmyEquipCfg","GodArmyEquip","_$GodArmyEquipCfg"),e.allot("_$GodArmySoliderCfg","GodArmyBingHun","_$GodArmySoliderCfg"),e.allot("_$GodArmyTopSkillCfg","GodArmyTopSkill","_$GodArmyTopSkillCfg"),e.allot("_$GodArmyEquipLvCfg","GodArmyEquipLv","_$GodArmyEquipLvCfg"),e.allot("_$ChangbanpoCfg","Changbanpo"),e.allot("_$ChangbanpoBuffCfg","ChangbanpoBuff"),e.allot("_$ChangbanpoGoodsCfg","ChangbanpoGoods"),e.allot("_$ChangbanpoResetCfg","ChangbanpoReset"),e.allot("_$ChangbanpoMiscCfg","ChangbanpoMisc"),e.allot("_$ChangbanpoBoxCfg","ChangbanpoBox"),e.allot("_$OnlineCfg","OnlineAward"),e.allot("_$OnlineAwardBannerCfg","OnlineAwardBanner"),e.allot("_$WuShengCfg","StarMapBase","_$WuShengCfg"),e.allot("_$WuShengPosActivateCfg","StarMapPosActivate","_$WuShengPosActivateCfg"),e.allot("_$WuShengMiscCfg","StarMapMisc"),e.allot("_$WuShengBtnCfg","StarMapBtn"),e.allot("_$WuShengStarMapCfg","StarMapPage"),e.allot("_$CSArenaGradeCfg","CrossArenaGrade","_$CSArenaGradeCfg"),e.allot("_$CSArenaScoreAwardCfg","CrossArenaScoreAward","_$CSArenaScoreAwardCfg"),e.allot("_$CSArenaMiscCfg","CrossArenaMisc"),e.allot("_$StrongerCfg","Stronger"),e.allot("_$StrongerIndexCfg","StrongerIndex"),e.allot("_$ContinuousRecharge2Cfg","ContinuousRecharge2","_$ContinuousRecharge2Cfg"),e.allot("_$GodArmyTalentCfg","GodArmyTalent","_$GodArmyTalentCfg"),e.allot("_$GodArmyTalentSkillCfg","GodArmyTalentSkill"),e.allot("_$FuncNoticeCfg","FuncNotice","_$FuncNoticeCfg"),e.allot("_$XiandiMiscCfg","XiandiMisc"),e.allot("_$GeneralBossCfg","JiangHun"),e.allot("_$ChatMiscCfg","ChatMisc"),e.allot("_$ChatTipsCfg","ChatTips"),e.allot("_$GuoShiChallengeCfg","GuoShi"),e.allot("_$BannerBarCfg","BannerBar"),e.allot("_$GoodGiftBtnCfg","GoodGiftBtn"),e.allot("_$GoodGiftMiscCfg","GoodGiftMisc"),e.allot("_$SalePrizeCfg","SalePrize","_$SalePrizeCfg"),e.allot("_$SingleRechargeCfg","SingleRecharge","_$SingleRechargeCfg"),e.allot("_$StrongerExpAwardCfg","StrongerExpAward"),e.allot("_$AuctionCfg","Auction"),e.allot("_$AuctionMiscCfg","AuctionMisc"),e.allot("_$AlbumCfg","Album","_$AlbumCfg"),e.allot("_$AlbumUpgradeCfg","AlbumUpgrade"),e.allot("_$AlbumSuitCfg","AlbumSuit"),e.allot("_$AlbumOpenCfg","AlbumOpen"),e.allot("_$GuildBossRankAwardCfg","GuildBossRankAward"),e.allot("_$CsGuildAwardCfg","CrossGuildBossAward","_$CsGuildAwardCfg"),e.allot("_$BetsCfg","Bets"),e.allot("_$MatchMiscCfg","MatchMisc"),e.allot("_$PatriotTalentCfg","PatriotTalent"),e.allot("_$PatriotTacticCfg","PatriotTactic"),e.allot("_$PatriotTianmaiCfg","PatriotTianmai"),e.allot("_$GrowthPrizeCfg","GrowthPrize","_$GrowthPrizeCfg"),e.allot("_$DailySalePrizeCfg","DailySalePrize","_$DailySalePrizeCfg"),e.allot("_$DragonBallCfg","DragonBall","_$DragonBallCfg"),e.allot("_$GodPatternCfg","GodPattern","_$GodPatternCfg"),e.allot("_$AvatarCfg","Avatar"),e.allot("_$AnimCfg","Anim"),e.allot("_$ResUrlCfg","ResUrl"),e.allot("_$AnimUrlCfg","AnimUrl"),e.allot("_$RoleUrlCfg","RoleUrl"),e.allot("_$FollowCfg","Follow"),e.allot("_$FollowHiddenCfg","FollowHidden"),e.allot("_$AvatarHiddenCfg","AvatarHidden"),e.allot("_$FollowRelationCfg","FollowRelation"),e.allot("_$FostersCfg","Fosters"),e.allot("_$ShengshouUpgradeCfg","ShengshouUpgrade","_$ShengshouUpgradeCfg"),e.allot("_$ShengshouSkillCfg","ShengshouSkill"),e.allot("_$ShengshouJLCfg","ShengshouJL"),e.allot("_$ShengshouSHCfg","ShengshouSH"),e.allot("_$ShengshouMiscCfg","ShengshouMisc"),e.allot("_$ShengshouWashCfg","ShengshouWash"),e.allot("_$SurfaceRecycleCfg","SurfaceRecycle"),e.allot("_$ShenJiangCfg","ShenJiang"),e.allot("_$ShenJiangMiscCfg","ShenJiangMisc"),e.allot("_$OpenServerBtnCfg","OpenServerBtn","_$OpenServerBtnCfg"),e.allot("_$GuildWarGuildScoreRankAwardCfg","GuildWarGuildScoreRankAward"),e.allot("_$GuildWarPersonalScoreRankAwardCfg","GuildWarPersonalScoreRankAward","_$GuildWarPersonalScoreRankAwardCfg"),e.allot("_$GuildWarBossRankAwardCfg","GuildWarBossRankAward"),e.allot("_$GuildWarBossScoreCfg","GuildWarBossScore"),e.allot("_$GuildWarScoreAwardCfg","GuildWarScoreAward"),e.allot("_$MergeLoginCfg","MergeLogin"),e.allot("_$DaySignCfg","SignAward2"),e.allot("_$PuzzleCfg","Jigsaw","_$PuzzleCfg"),e.allot("_$PuzzleTaskCfg","JigsawTask","_$PuzzleTaskCfg"),e.allot("_$PuzzleMiscCfg","JigsawMisc"),e.allot("_$PuzzleRewardCfg","JigsawAward"),e.allot("_$MergeKeepRechargeCfg","MergeKeepRecharge","_$MergeKeepRechargeCfg"),e.allot("_$MergeCostGoldCfg","MergeCostGold","_$MergeCostGoldCfg"),e.allot("_$MergeAccuRechargeCfg","MergeAccuRecharge","_$MergeAccuRechargeCfg"),e.allot("_$SocialGoalCfg","SocialGoal"),e.allot("_$MillionsLoginCfg","MillionsLoginAward"),e.allot("_$SmashGoldEggMiscCfg","MashEggsMisc"),e.allot("_$SmashGoldEggOpenCfg","StartsMashEggs","_$SmashGoldEggOpenCfg"),e.allot("_$SmashGoldEggCfg","MashEggsLibrary","_$SmashGoldEggCfg"),e.allot("_$RebirthCfg","Rebirth"),e.allot("_$ChooseRechargeAwardCfg","ChooseRechargeAward"),e.allot("_$BingShuMiscCfg","BingShuMisc"),e.allot("_$MonopolyOpenCfg","MonopolyOpen","_$MonopolyOpenCfg"),e.allot("_$MonopolyAwardCfg","MonopolyAward"),e.allot("_$NpcCfg","Npc"),e.allot("_$VipWelfareBtnCfg","VipWelfareBtn"),e.allot("_$QQVipLoginCfg","QQVipLogin"),e.allot("_$CityCfg","City"),e.allot("_$CityMiscCfg","CityMisc"),e.allot("_$RefineCfg","Refine"),e.allot("_$ZhenBaoCfg","ZhenBao"),e.allot("_$ZhenBaoUpgradeCfg","ZhenBaoUpgrade"),e.allot("_$ZhenBaoBreakthroughCfg","ZhenBaoBreakthrough"),e.allot("_$ZhenBaoMiscCfg","ZhenBaoMisc"),e.allot("_$DigTreasureOpenCfg","DigTreasureOpen"),e.allot("_$DigTreasureNumAwardsCfg","DigTreasureNumAwards","_$DigTreasureNumAwardsCfg"),e.allot("_$SuperVipCfg","SuperVip"),e.allot("_$CServRankCfg","CrossRank","_$CServRankCfg"),e.allot("_$CServRankAwardCfg","CrossRankAward"),e.allot("_$MilitaryArrayMiscCfg","JunZhenMisc"),e.allot("_$MilitaryArrayCfg","JunZhenBase"),e.allot("_$MilitaryArrayUpCfg","JunZhen","_$MilitaryArrayUpCfg"),e.allot("_$MilitaryArrayFlagUpCfg","ZhenQi","_$MilitaryArrayFlagUpCfg"),e.allot("_$MilitaryArrayMapUpCfg","ZhenTu","_$MilitaryArrayMapUpCfg"),e.allot("_$InstanceDifficultCfg","InstanceDifficult"),e.allot("_$CultureGiftCfg","assetPrize","_$CultureGiftCfg"),e.allot("_$MedalBaseCfg","MedalBase"),e.allot("_$MedalUpgradeCfg","MedalUpgrade"),e.allot("_$MedalSkillCfg","MedalSkill"),e.allot("_$MedalMiscCfg","MedalMisc"),e.allot("_$ConquerCfg","Conquer"),e.allot("_$ConquerMiscCfg","ConquerMisc"),e.allot("_$ConquerGuildRankCfg","ConquerGuildRank"),e.allot("_$ConquerPlayerRankCfg","ConquerPlayerRank"),e.allot("_$LeagueCupMiscCfg","LeagueCupMisc"),e.allot("_$LeagueCupTeamLvCfg","LeagueCupTeamLv"),e.allot("_$LeagueCupPredictionCfg","LeagueCupPrediction"),e.allot("_$LeagueCupScoreAwardCfg","LeagueCupScoreAward"),e.allot("_$LeagueCupRankAwardCfg","LeagueCupRankAward"),e.allot("_$LeagueAssistCfg","LeagueAssist"),e.allot("_$LeagueActAwardCfg","TeamAssistanceScoreReward"),e.allot("_$GoodGiftRMBCfg","GoodGiftRMB"),e.allot("_$BianshenTopCfg","BianshenTop"),e.allot("_$IOSRechargeCfg","IOSRecharge"),e.allot("_$HighEquipDHCfg","HighEquipDH",null,"pos","lv"),e.allot("_$HighEquipFHCfg","HighEquipFH"),e.allot("_$FHAdvanceCfg","FHAdvance"),e.allot("_$HighEquipJCCfg","HighEquipJC"),e.allot("_$VerifyCollectionCfg","VerifyCollection"),e.allot("_$SRTurnplateClientCfg","XunbaoSRTClient"),e.allot("_$WorldWar2Cfg","ZhuLuInstance"),e.allot("_$KeepPrizeCfg","KeepPrize"),e.allot("_$QuestLinkCfg","QuestLink"),e.allot("_$OverlordMiscCfg","OverlordMisc"),e.allot("_$OverlordPredictionCfg","OverlordPrediction"),e.allot("_$OverlordScoreAwardCfg","OverlordScoreAward"),e.allot("_$OverlordRankAwardCfg","OverlordRankAward"),e.allot("_$QQDailyRechargeCfg","QQDailyRecharge"),e.allot("_$TowerCfg","Tower"),e.allot("_$CaptureFlagCfg","CaptureFlag"),e.allot("_$CaptureFlagPlayerRankCfg","CaptureFlagPlayerRank"),e.allot("_$CaptureFlagTeamRankCfg","CaptureFlagTeamRank"),e.allot("_$CaptureFlagMiscCfg","CaptureFlagMisc"),e.allot("_$FestivalRechargeBtnCfg","FestivalRechargeBtn"),e.allot("_$LimitDailyRechargeCfg","LimitDailyRecharge"),e.allot("_$LimitAccuRechargeCfg","LimitAccuRecharge"),e.allot("_$DigTreasureResCfg","DigTreasureRes"),e.allot("_$FuDaiOpenCfg","FuDaiOpen"),e.allot("_$FuDaiCostCfg","FuDaiCost"),e.allot("_$FuDaiDailyAwardsCfg","FuDaiDailyAwards","_$FuDaiDailyAwardsCfg"),e.allot("_$FuDaiTotalAwardsCfg","FuDaiTotalAwards","_$FuDaiTotalAwardsCfg"),e.allot("_$CshiBaseCfg","CshiBase"),e.allot("_$CshiAttrCfg","CshiAttr"),e.allot("_$WakoolRechargeCfg","WakoolRecharge"),e.allot("_$FollowGiftCfg","FollowGift"),e.allot("_$JuBaoPenOpenCfg","JuBaoPenOpen"),e.allot("_$JuBaoPenCostCfg","JuBaoPenCost"),e.allot("_$JuBaoPenLevelCfg","JuBaoPenLevel"),e.allot("_$JuBaoPenScoreAwardsCfg","JuBaoPenScoreAwards"),e.allot("_$JubaoPenMiscCfg","JubaoPenMisc"),e.allot("_$JubaoPenShowCfg","JubaoPenShow"),e.allot("_$ShengZhuangExpertCfg","ShengZhuangExpert"),e.allot("_$CsFestivalBossCfg","CsFestivalBoss"),e.allot("_$CfbRankAwardCfg","CfbRankAward"),e.allot("_$CfbTargetAwardCfg","CfbTargetAward"),e.allot("_$CsFestivalBossMiscCfg","CsFestivalBossMisc"),e.allot("_$CrossBossShowCfg","CrossBossShow"),e.allot("_$ArrowShowCfg","ArrowShow"),e.allot("_$CangBaoGeOpenCfg","CangBaoGeOpen"),e.allot("_$CangBaoGeAwardsCfg","CangBaoGeAwards"),e.allot("_$CangBaoGeDaysAwardsCfg","CangBaoGeDaysAwards"),e.allot("_$CangBaoGePliesAwardsCfg","CangBaoGePliesAwards"),e.allot("_$TreasurePavilionMiscCfg","TreasurePavilionMisc"),e.allot("_$RecallOpenCfg","RecallOpen"),e.allot("_$RecallMiscCfg","RecallMisc"),e.allot("_$RecallLoginCfg","RecallLogin"),e.allot("_$RecallSaleCfg","RecallSale"),e.allot("_$TempleOpenCfg","TempleOpen"),e.allot("_$TempleCfg","Temple"),e.allot("_$TempleRateCfg","TempleRate"),e.allot("_$TempleAwardCfg","TempleAward"),e.allot("_$MainBottomCfg","MainBottom"),e.allot("_$AchievementBtnCfg","AchievementBtn"),e.allot("_$AchievementAwardTaskCfg","AchievementAwardTask"),e.allot("_$ZhenFaNameCfg","ZhenFaName"),e.allot("_$BountyQuestCfg","BountyQuest"),e.allot("_$BountyQuestLevelCfg","BountyQuestLevel"),e.allot("_$BountyQuestMiscCfg","BountyQuestMisc"),e.allot("_$ResolveAttrCfg","ResolveAttr"),e.allot("_$VipBossCfg","VipBoss"),e.allot("_$VipBossLevelCfg","VipBossLevel"),e.allot("_$TransferBaseCfg","ReJobBase"),e.allot("_$TransferActivateCfg","ReJobActivate"),e.allot("_$TransferLvUpCfg","ReJobAdvance"),e.allot("_$TransferGetExpCfg","ReJobPointItem"),e.allot("_$TransferMiscCfg","RejobMisc"),e.allot("_$TransferEquipSuitCfg","ReJobSuit"),e.allot("_$TransferSkillCfg","ReJobSkill"),e.allot("_$TransferUpgradeCfg","ReJobStrength"),e.allot("_$TransferEquipCfg","ReJobEquip"),e.allot("_$TransferTalentActiveCfg","ReJobTalentGroupActive"),e.allot("_$TransferTalentCfg","ReJobTalent"),e.allot("_$TransferAttrItemCfg","ReJobAttrItem","_$TransferAttrItemCfg"),e.allot("_$ShopMiscCfg","ShopMisc"),e.allot("_$LimitGiftOpenCfg","LimitGiftOpen"),e.allot("_$LimitGiftGearCfg","LimitGiftGear"),e.allot("_$LimitGiftMiscCfg","LimitGiftMisc"),e.allot("_$PushPrizeCfg","PushPrize"),e.allot("_$MysteryEggCfg","MysteryEgg"),e.allot("_$MysteryEggMiscCfg","MysteryEggMisc"),e.allot("_$PartnerBoxCfg","PartnerBox"),e.allot("_$PartnerCfg","Partner"),e.allot("_$PartnerBattleCfg","PartnerBattle"),e.allot("_$PartnerUpgradeCfg","PartnerUpgrade"),e.allot("_$PartnerBookCfg","PartnerBook"),e.allot("_$PartnerTopCfg","PartnerTop"),e.allot("_$PartnerStarCfg","PartnerStar"),e.allot("_$PartnerJingpoCfg","PartnerJingpo"),e.allot("_$PartnerHelpCfg","PartnerHelp"),e.allot("_$PartnerFateCfg","PartnerFate"),e.allot("_$ItemInfoCfg","PartnerProper","_$ItemInfoCfg"),e.allot("_$PartnerProperTopCfg","PartnerProperTop"),e.allot("_$PartnerSuitCfg","PartnerSuit"),e.allot("_$PartnerMiscCfg","PartnerMisc",null,"key"),e.allot("_$HunluBaseCfg","HunluBase"),e.allot("_$HunluCombinationCfg","HunluCombination"),e.allot("_$HunluUpgradeCfg","HunluUpgrade"),e.allot("_$HunluAchievementCfg","HunluAchievement"),e.allot("_$HunluPointAwardCfg","HunluPointAward"),e.allot("_$HunluMiscCfg","HunluMisc"),e.allot("_$PartnerAwakenCfg","PartnerAwaken"),e.allot("_$PartnerAwakenSkillCfg","PartnerAwakenSkill"),e.allot("_$ShenQiCfg","ShenQi"),e.allot("_$ShenQiUpgradeCfg","ShenQiUpgrade"),e.allot("_$ShenQiJLCfg","ShenQiJL"),e.allot("_$ShenQiSLCfg","ShenQiSL"),e.allot("_$ShenQiSLTaskCfg","ShenQiSLTask"),e.allot("_$ShenQiMiscCfg","ShenQiMisc"),e.allot("_$BattleMiscCfg","BattleMisc",null,"key"),e.allot("_$HangUpMiscCfg","HangUpMisc",null,"key"),e.allot("_$QuickBattleCostCfg","QuickBattleCost",null,"num"),e.allot("_$FormationBaseCfg","FormationBase"),e.allot("_$FormationUpgradeCfg","FormationUpgrade"),e.allot("_$FormationStarCfg","FormationStar"),e.allot("_$FormationExpCfg","FormationExp"),e.allot("_$FormationRestrainCfg","FormationRestrain"),e.allot("_$FormationMiscCfg","FormationMisc"),e.allot("_$FormationAttrItemCfg","FormationAttrItem"),e.allot("_$FormationAwakenCfg","FormationAwaken"),e.allot("_$FormationAwakenSkillCfg","FormationAwakenSkill"),e.allot("_$BackSettingCfg","BackSetting"),e.allot("_$ResolveMiscCfg","ResolveMisc"),e.allot("_$FosterClientCfg","FosterClient"),e.allot("_$ZhanjiBaseCfg","ZhanjiBase"),e.allot("_$ZhanjiUpgradeCfg","ZhanjiUpgrade"),e.allot("_$ZhanjiBookCfg","ZhanjiBook"),e.allot("_$ZhanjiStarCfg","ZhanjiStar"),e.allot("_$ZhanjiFetterCfg","ZhanjiFetter"),e.allot("_$ZhanjiAttrItemCfg","ZhanjiAttrItem"),e.allot("_$ZhanjiMiscCfg","ZhanjiMisc"),e.allot("_$ZhanjiAwakenCfg","ZhanjiAwaken"),e.allot("_$ZhanjiAwakenSkillCfg","ZhanjiAwakenSkill"),e.allot("_$ShenhunBaseCfg","ShenhunBase"),e.allot("_$ShenhunUpgradeCfg","ShenhunUpgrade"),e.allot("_$ShenhunBookCfg","ShenhunBook"),e.allot("_$ShenhunStarCfg","ShenhunStar"),e.allot("_$ShenhunFetterCfg","ShenhunFetter"),e.allot("_$ShenhunAttrItemCfg","ShenhunAttrItem"),e.allot("_$ShenhunMiscCfg","ShenhunMisc"),e.allot("_$ShenhunAwakenCfg","ShenhunAwaken"),e.allot("_$ShenhunAwakenSkillCfg","ShenhunAwakenSkill"),e.allot("_$MountBaseCfg","MountBase"),e.allot("_$MountUpgradeCfg","MountUpgrade"),e.allot("_$MountBookCfg","MountBook"),e.allot("_$MountStarCfg","MountStar"),e.allot("_$MountFetterCfg","MountFetter"),e.allot("_$MountAttrItemCfg","MountAttrItem"),e.allot("_$MountMiscCfg","MountMisc"),e.allot("_$MountAwakenCfg","MountAwaken"),e.allot("_$MountAwakenSkillCfg","MountAwakenSkill"),e.allot("_$HaloBaseCfg","HaloBase"),e.allot("_$HaloUpgradeCfg","HaloUpgrade"),e.allot("_$HaloBookCfg","HaloBook"),e.allot("_$HaloStarCfg","HaloStar"),e.allot("_$HaloFetterCfg","HaloFetter"),e.allot("_$HaloAttrItemCfg","HaloAttrItem"),e.allot("_$HaloMiscCfg","HaloMisc"),e.allot("_$HaloAwakenCfg","HaloAwaken"),e.allot("_$HaloAwakenSkillCfg","HaloAwakenSkill"),e.allot("_$HaloSpiritCfg","HaloSpirit"),e.allot("_$HaloSealCfg","HaloSeal"),e.allot("_$HaloSpiritPreviewCfg","HaloSpiritPreview"),e.allot("_$WingBaseCfg","WingBase"),e.allot("_$WingUpgradeCfg","WingUpgrade"),e.allot("_$WingBookCfg","WingBook"),e.allot("_$WingStarCfg","WingStar"),e.allot("_$WingFetterCfg","WingFetter"),e.allot("_$WingSkillCfg","WingSkill"),e.allot("_$WingAttrItemCfg","WingAttrItem"),e.allot("_$WingMiscCfg","WingMisc"),e.allot("_$WingAttrItemCfg","WingAttrItem"),e.allot("_$WingAwakenCfg","WingAwaken"),e.allot("_$WingAwakenSkillCfg","WingAwakenSkill"),e.allot("_$WingFeatherCfg","WingFeather"),e.allot("_$WingFeatherRefineCfg","WingFeatherRefine"),e.allot("_$StarMapQualityAttrCfg","StarMapQualityAttr"),e.allot("_$WarTokenOpenCfg","WarTokenOpen"),e.allot("_$WarTokenUpgradeCfg","WarTokenUpgrade"),e.allot("_$WarTokenLevelCfg","WarTokenLevel"),e.allot("_$WarTokenDailyTaskCfg","WarTokenDailyTask"),e.allot("_$WarTokenDialyScoreCfg","WarTokenDialyScore"),e.allot("_$WarTokenWeekTaskCfg","WarTokenWeekTask"),e.allot("_$WarTokenSeasonTaskCfg","WarTokenSeasonTask"),e.allot("_$WarTokenMiscCfg","WarTokenMisc"),e.allot("_$MoneyCatCfg","FortuneCat"),e.allot("_$MoneyCatRechargeCfg","FortuneCatRecharge"),e.allot("_$MoneyCatInputCfg","FortuneCatInput"),e.allot("_$MoneyCatMiscCfg","FortuneCatMisc"),e.allot("_$FundOpenCfg","FundOpen"),e.allot("_$GrowthFundCfg","GrowthFund"),e.allot("_$FullFundCfg","FullFund"),e.allot("_$SummonPreViewCfg","SummonPreView","_$SummonPreViewCfg"),e.allot("_$SummonOpenCfg","SummonOpen"),e.allot("_$SummonBaseCfg","SummonBase"),e.allot("_$SummonLuckWeightCfg","SummonLuckWeight"),e.allot("_$SummonScoreCfg","SummonScore"),e.allot("_$SummonCostCfg","SummonCost"),e.allot("_$SummonMiscCfg","SummonMisc"),e.allot("_$SummonOpenCfg","SummonAdOpen"),e.allot("_$CarnivalOpenCfg","CarnivalOpen"),e.allot("_$CarnivalTaskCfg","CarnivalTask"),e.allot("_$CarnivalTaskClientCfg","CarnivalTaskClient"),e.allot("_$CountinueRechargeCfg","KeepRecharge"),e.allot("_$RechargeReplenishCfg","RechargeReplenish"),e.allot("_$VipWeeklyCfg","VipWeekly"),e.allot("_$StarCfg","Star"),e.allot("_$RaceRankCfg","RaceRank"),e.allot("_$RaceAwardCfg","RaceAward"),e.allot("_$RaceTargetCfg","RaceTarget"),e.allot("_$RaceSummonScoreCfg","RaceSummonScore"),e.allot("_$PartnerAwardCfg","PartnerAward","_$PartnerAwardCfg"),e.allot("_$RecruitRebateCfg","RecruitRebate"),e.allot("_$QQHbTaskCfg","QQHbTask"),e.allot("_$QQHbCashCfg","QQHbCash"),e.allot("_$QQHbOpenCfg","QQHbOpen"),e.allot("_$TreasuryOpenCfg","TreasuryOpen"),e.allot("_$TreasuryTakeCfg","TreasuryTake"),e.allot("_$TreasuryMiscCfg","TreasuryMisc"),e.allot("_$SoundEffectsCfg","SoundEffects"),e.allot("_$ViewSoundCfg","ViewSound"),e.allot("_$MiscSoundCfg","MiscSound"),e.allot("_$CashBackOpenCfg","CashBackOpen"),e.allot("_$CashBackPoolCfg","CashBackPool"),e.allot("_$CashBackAwardCfg","CashBackAward"),e.allot("_$BoonRechargeOpenCfg","BoonRechargeOpen"),e.allot("_$BoonRechargeAwardCfg","BoonRechargeAward"),e.allot("_$BoonRechargeMiscCfg","BoonRechargeMisc"),e.allot("_$PartnerSkinCfg","PartnerSkin","_$PartnerSkinCfg"),e.allot("_$ShellOpenCfg","ShellOpen"),e.allot("_$ShellNumAwardCfg","ShellNumAward"),e.allot("_$ShellMiscCfg","ShellMisc"),e.allot("_$ScratchOpenCfg","ScratchOpen"),e.allot("_$ScratchLuckyAwardCfg","ScratchLuckyAward"),e.allot("_$ScratchMiscCfg","ScratchMisc"),e.allot("_$MemoirCfg","Memoir"),e.allot("_$MemoirStarCfg","MemoirStar"),e.allot("_$MemoirMiscCfg","MemoirMisc"),e.allot("_$MemoirMapCfg","MemoirMap"),e.allot("_$MemoirDiffCfg","MemoirDiff"),e.allot("_$HuntingOpenCfg","HuntingOpen"),e.allot("_$HuntingStoreCfg","HuntingStore"),e.allot("_$HuntingTaskCfg","HuntingTask"),e.allot("_$HuntingGiftCfg","HuntingGift"),e.allot("_$HuntingScoreCfg","HuntingScore"),e.allot("_$HuntingRechargeCfg","HuntingRecharge"),e.allot("_$HuntingMiscCfg","HuntingMisc"),e.allot("_$PeriodicPrizeCfg","PeriodicPrize"),e.allot("_$ForgeFuseCfg","EquipFuse","_$ForgeFuseCfg"),e.allot("_$ForgeFuseSuitCfg","EquipFuseSuit"),e.allot("_$ResFindCfg","ResFind"),e.allot("_$YiyuanBuyCfg","YiyuanBuy"),e.allot("_$DailyTaskCfg","DailyTask","_$DailyScoreAwardCfg"),e.allot("_$DailyTaskActiveCfg","DailyTaskActive","_$DailyScoreAwardCfg"),e.allot("_$WeekTaskActiveCfg","WeekTaskActive","_$DailyScoreAwardCfg"),e.allot("_$AchievementBtnMenuCfg","AchievementBtnMenu"),e.allot("_$TribesTechConditionCfg","TribesTechCondition"),e.allot("_$TribesTechBattleCfg","TribesTechBattle"),e.allot("_$TribesTechSkillCfg","TribesTechSkill"),e.allot("_$TribesTechSurviveCfg","TribesTechSurvive"),e.allot("_$TribesTechPrivilegeCfg","TribesTechPrivilege"),e.allot("_$TribesTechAcclerateCfg","TribesTechAcclerate"),e.allot("_$TribesTechAssistantCfg","TribesTechAssistant"),e.allot("_$TribesTechMiscCfg","TribesTechMisc"),e.allot("_$TribesTechBattleBaseCfg","TribesTechBattleBase"),e.allot("_$TribesTechSurviveBaseCfg","TribesTechSurviveBase"),e.allot("_$TribesTechAccelerateCfg","TribesTechAccelerate"),e.allot("_$ElementFetterCfg","ElementFetter"),e.allot("_$PushTipCfg","PushTip"),e.allot("_$WelfareTargetCfg","WelfareTarget","_$WelfareTargetCfg"),e.allot("_$NewFirstRechargeCfg","NewFirstRecharge"),e.allot("_$ExploreRoutesCfg","ExploreRoutes"),e.allot("_$ExploreGridCfg","ExploreGrid"),e.allot("_$ExploreBattleEventsCfg","ExploreBattleEvents"),e.allot("_$ExploreRandomEventsCfg","ExploreRandomEvents"),e.allot("_$ExploreBuffsCfg","ExploreBuffs"),e.allot("_$ExploreGoodsCfg","ExploreGoods"),e.allot("_$ExploreMiscCfg","ExploreMisc"),e.allot("_$ExploreLuckyDayDescCfg","ExploreLuckyDayDesc"),e.allot("_$FundRechargeCfg","FundRecharge"),e.allot("_$SpotAlertCfg","SpotAlert","_$SpotAlertCfg"),e.allot("_$PrivilegeRechargeCfg","PrivilegeRecharge"),e.allot("_$BarbarianCfg","Barbarian","_$BarbarianCfg"),e.allot("_$BarbarianDifficultyCfg","BarbarianDifficulty"),e.allot("_$BarbarianCritCfg","BarbarianCrit"),e.allot("_$BarbarianLayerAwardCfg","BarbarianLayerAward"),e.allot("_$BarbarianBuffCfg","BarbarianBuff"),e.allot("_$BarbarianAimsCfg","BarbarianAims"),e.allot("_$BarbarianRankCfg","BarbarianRank"),e.allot("_$BarbarianMiscCfg","BarbarianMisc"),e.allot("_$BarbarianGiftCfg","BarbarianGift"),e.allot("_$BarbarianDeathGiftCfg","BarbarianDeathGift"),e.allot("_$LoadActiveShowCfg","LoadActiveShow"),e.allot("_$IconAchStarCfg","IconAchStar"),e.allot("_$IconAchCfg","IconAch"),e.allot("_$PayGuideConditionCfg","PayGuideCondition"),e.allot("_$PayGuideOverviewCfg","PayGuideOverview"),e.allot("_$PayGuideMiscCfg","PayGuideMisc"),e.allot("_$RechargeHallCfg","RechargeHall"),e.allot("_$PeriodFastBuyCfg","PeriodFastBuy"),e.allot("_$ClashNodeCfg","ClashNode"),e.allot("_$ClashTaskCfg","ClashTask"),e.allot("_$ClashTaskAwardCfg","ClashTaskAward"),e.allot("_$ClashMiscCfg","ClashMisc"),e.allot("_$ClashPointCfg","ClashPoint"),e.allot("_$PartnerTalentCfg","PartnerTalent"),e.allot("_$PartnerTalentTaskCfg","PartnerTalentTask"),e.allot("_$GuildInstanceCfg","GuildInstance"),e.allot("_$GuildInstanceRankCfg","GuildInstanceRank"),e.allot("_$StarAddAttrCfg","StarAddAttr"),e.allot("_$ItemInfoCfg","FosterEquip","_$ItemInfoCfg"),e.allot("_$FosterEquipMiscCfg","FosterEquipMisc"),e.allot("_$FosterEquipQHCfg","FosterEquipQH"),e.allot("_$FosterEquipQHCostCfg","FosterEquipQHCost"),e.allot("_$FosterEquipStarfg","FosterEquipStar"),e.allot("_$FosterEquipLockCostCfg","FosterEquipLockCost"),e.allot("_$FosterEquipWashLimitCfg","FosterEquipWashLimit"),e.allot("_$FosterEquipOpenCfg","FosterEquipOpen"),e.allot("_$PartnerAidCfg","PartnerAid"),e.allot("_$PartnerAidChainCfg","PartnerAidChain"),e.allot("_$DailyWishCfg","DailyWish"),e.allot("_$WishTaskCfg","WishTask"),e.allot("_$WishGiftBagCfg","WishGiftBag"),e.allot("_$WishMiscCfg","WishMisc"),e.allot("_$ExchangeOpenCfg","ExchangeOpen"),e.allot("_$ExchangeGoodsCfg","ExchangeGoods"),e.allot("_$ExchangeDropCfg","ExchangeDrop"),e.allot("_$ExchangeTaskCfg","ExchangeTask"),e.allot("_$ExchangeCashCfg","ExchangeCash"),e.allot("_$ExchangeDiscountCfg","ExchangeDiscount"),e.allot("_$ExchangeMiscCfg","ExchangeMisc"),e.allot("_$ExchangeTabCfg","ExchangeTab"),e.allot("_$LimitSalePrizeCfg","LimitSalePrize"),e.allot("_$GuildNewBossCfg","GuildNewBoss"),e.allot("_$GuildNewBossRewardCfg","GuildNewBossReward"),e.allot("_$GuildNewBossFirstShowCfg","GuildNewBossFirstShow"),e.allot("_$FreeDrawOpenCfg","FreeDrawOpen"),e.allot("_$FreeDrawWaveCfg","FreeDrawWave"),e.allot("_$FreeDrawStoreCfg","FreeDrawStore"),e.allot("_$FreeDrawTaskCfg","FreeDrawTask"),e.allot("_$FreeDrawShopCfg","FreeDrawShop"),e.allot("_$FreeDrawCashCfg","FreeDrawCash"),e.allot("_$FreeDrawMiscCfg","FreeDrawMisc"),e.allot("_$MibaoOpenCfg","MibaoOpen"),e.allot("_$MibaoStoreCfg","MibaoStore"),e.allot("_$MibaoTaskCfg","MibaoTask"),e.allot("_$MibaoGiftCfg","MibaoGift"),e.allot("_$MibaoCashCfg","MibaoCash"),e.allot("_$MibaoScoreCfg","MibaoScore"),e.allot("_$MibaoMiscCfg","MibaoMisc"),e.allot("_$QQVideoCfg","QQVideo"),e.allot("_$SpecialTokenOpenCfg","SpecialTokenOpen"),e.allot("_$SpecialTokenTaskCfg","SpecialTokenTask"),e.allot("_$TokenRechargeCfg","TokenRecharge"),e.allot("_$SpecialLvIntervalCfg","SpecialLvInterval"),e.allot("_$AoyiRunesCfg","AoyiRunes"),e.allot("_$AoyiRunesAttrCfg","AoyiRunesAttr"),e.allot("_$AoyiRunesMasterCfg","AoyiRunesMaster"),e.allot("_$AoyiEnchCfg","AoyiEnch"),e.allot("_$AoyiEnchMasterCfg","AoyiEnchMaster"),e.allot("_$AoyiExpandOpenCfg","AoyiExpandOpen"),e.allot("_$AoyiExpandMiscCfg","AoyiExpandMisc"),e.allot("_$MythBaseCfg","MythBase"),e.allot("_$MythUpgradeCfg","MythUpgrade"),e.allot("_$MythBookCfg","MythBook"),e.allot("_$MythStarCfg","MythStar","_$MythStarCfg"),e.allot("_$ItemInfoCfg","MythEquip","_$ItemInfoCfg"),e.allot("_$MythEquipUpgradeCfg","MythEquipUpgrade"),e.allot("_$MythEquipExpCfg","MythEquipExp"),e.allot("_$MythEquipAttrCfg","MythEquipAttr"),e.allot("_$MythFettersCfg","MythFetters"),e.allot("_$MythBattleCfg","MythBattle"),e.allot("_$MythMiscCfg","MythMisc"),e.allot("_$MasterStarCfg","MasterStar"),e.allot("_$MasterBattleFetterCfg","MasterBattleFetter"),e.allot("_$MasterQualityFetterCfg","MasterQualityFetter"),e.allot("_$ShenQiBlessCfg","ShenQiBless"),e.allot("_$ShenQiBlessMasterCfg","ShenQiBlessMaster"),e.allot("_$ShenQiBlessChainCfg","ShenQiBlessChain"),e.allot("_$ShenQiBlessOpenCfg","ShenQiBlessOpen"),e.allot("_$ShenQiStarCfg","ShenQiStar"),e.allot("_$ShenQiExpandMiscCfg","ShenQiExpandMisc"),e.allot("_$CarnivalScoreCfg","CarnivalScore"),e.allot("_$CarnivalMiscCfg","CarnivalMisc"),e.allot("_$QuanminStarOpenCfg","QuanminStarOpen"),e.allot("_$QuanminStarTaskCfg","QuanminStarTask"),e.allot("_$QuanminStarAwardCfg","QuanminStarAward"),e.allot("_$HomeRightTopBarCfg","HomeRightTopBar")},parseConfig:function(e,t,a){this._config=e,this._initModuleConfig(),e.runAllot(t,a,{onP:function(e,t,a){game.loadingPage.setPromptText(game.LanguageData.get(82)+"("+t+"/"+a+")...")},onProgressThis:this})}});e._inst=null,e.inst=function(){return e._inst||(e._inst=new e),e._inst},game.configMgr=e.inst()}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getData:function(e){var t=this,a=void 0;return t._mapDic&&(a=t._mapDic[e])||(t._mapDic||(t._mapDic=[]),(a=t._super(e))&&(t._mapDic[e]=a)),a}}),b8e.RC("$$game","$$SceneCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({maxLv:0,fosterType:1,ctor:function(){this._super()},onDataCreate:function(e){if(!e.spriteStat){var t=game.SpriteStatUtil.setDataByCfg(e);e.spriteStat=t}e.power||(e.power=game.CCommonUtil.getPower(e.spriteStat))},getData:function(e){var t=this._super(e);if(t)return t;return null},getMaxLv:function(){return 0}}),b8e.RC("$$game","$$FosterAdvancedCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({list:null,ctor:function(){this._super()},getAttrItemId:function(){if(!this.list){this.list=this.getDatas()}if(this.list&&0<this.list.length){return this.list[0].itemId}return 0},getData:function(e){var t=this._super(e);if(!t){return null}if(!t.spriteStat){var a=game.SpriteStatUtil.setDataByCfg(t);t.spriteStat=a}if(!t.power){t.power=game.CCommonUtil.getPower(t.spriteStat)}return t}}),b8e.RC("$$game","$$FosterAttrItemCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({lvMap:null,maxId:0,fosterType:1,ctor:function(){this._super()},onInited:function(){this.obj={id:0}},onDataCreate:function(e){if(!e.spriteStat){var t=game.SpriteStatUtil.setDataByCfg(e);e.spriteStat=t}e.power||(e.power=game.CCommonUtil.getPower(e.spriteStat))},getCfgByLv:function(e){return this.getData(e,0)},getDataById:function(e){this.obj.id=e;var t=this.getData(this.obj);if(t)return t;return null},getMax:function(){return 0}}),b8e.RC("$$game","$$FosterAwakeningCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({initSkillMap:null,skillMap:null,maxLv:0,maxOpenLv:0,fosterType:1,ctor:function(){this._super()},onInited:function(){this.obj={id:0}},onDataCreate:function(e){if(!e.spriteStat){var t=game.SpriteStatUtil.setDataByCfg(e);e.spriteStat=t}e.power||(e.power=game.CCommonUtil.getPower(e.spriteStat))},getDataById:function(e){this.obj.id=e;var t=this.getData(this.obj);if(t)return t;return null},getInitSkill:function(){var e=this;if(e.initSkillMap)return e.initSkillMap;e.initSkillMap=b8e.HashMap.get();for(var t=e.getMiscCfgValue("fosterSlot"),a=void 0,i=void 0,n=0;n<t;n++)i=n+1,(a=e.getSkillByLv(i,1))&&e.initSkillMap.set(a.slot,a.id);return e.initSkillMap},getMaxLv:function(){var e=this;return e.maxLv||(e.maxLv=e.getMiscCfgValue("fosterSkillMaxLv")),e.maxLv},getMaxOpenLv:function(){var e=this;return e.maxOpenLv||(e.maxOpenLv=e.getMiscCfgValue("fosterSkillMaxOpenLv")),e.maxOpenLv},getSkillByLv:function(e,t){var a=this.getData(e,t);return a||null},getMiscCfgValue:function(){return 0}}),b8e.RC("$$game","$$FosterSkillCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({skinList:null,ctor:function(){this._super()},onDataCreate:function(e){if(!e.spriteStat){var t=game.SpriteStatUtil.setDataByCfg(e);e.spriteStat=t}if(!e.power){e.power=game.CCommonUtil.getPower(e.spriteStat)}},getList:function(){return this.skinList}}),b8e.RC("$$game","$$FosterSkinCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this._typeObj={type:0}},getDatasByType:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t;return this._typeObj.type=e,this.getData(this._typeObj,a)},getCostCfg:function(e,t){return this.getData(e,t)}}),b8e.RC("$$game","$$CostCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getItemId:function(e){var t=this.getData(e);return t?t.itemId:0},getItemTipsKey:function(e){var t=this.getData(e);return t&&t.noticeKey?t.noticeKey:112}}),b8e.RC("$$game","$$AmountCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.maxLv=Number(game.CfgUtil.getMiscValue(game.GuildMiscCfg,"activeMaxLv"))},onDataCreate:function(e){if(!e.spriteStat){var t=game.SpriteStatUtil.setDataByCfg(e);e.spriteStat=t}},getMaxLv:function(){return this.maxLv}}),b8e.RC("$$game","$$ActiveLvCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj1={days:0}},getDataByDays:function(e){return this.obj1.days=e,this.getData(this.obj1,!0)},getCurDay:function(){var e=this.getDatas(),t=game.miscData.openServerDay,a=game.SearchUtil.findLastEqualSmaller(e,t,"_$days");this._days=a.days},resetDaily:function(){this._days=0},getCurDayCfgs:function(){return this._days||this.getCurDay(),this.getDataByDays(this._days)},getCfgByRank:function(e){return this._days||this.getCurDay(),this.getData(this._days,e)}}),b8e.RC("$$game","$$ActivePrizeModelCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,rechargeList:null,ctor:function(){this._super(),this.groupMap=b8e.HashMap.get(),this.groupList=[]},onInited:function(){var e=this;e.obj1={id:0},e.obj2={serverStart:0},e.obj3={group:0},e.obj4={type:0};for(var t=e.getKeys("group"),a=t.length,i=0;i<a;i++){var n=t[i];e.obj3.group=n;var s=e.getData(e.obj3,!1,!1,!1);e.groupList.push(s)}},getListByDay:function(e){return this.obj3.group=e,this.getData(this.obj3,!0,!1)},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getOneDataByDay:function(e){return this.obj3.group=e,this.getData(this.obj3,!1,!1,!1)},getDataByType:function(e){return this.obj4.type=e,this.getData(this.obj4,!0)},getCurGroup:function(e){for(var t=this.groupList,a=t.length,i=0;i<a;i++){var n=t[i];if(e>=n.serverStart&&e<n.serverEnd)return n.group}return 0}}),b8e.RC("$$game","$$AccumulativeRechargeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.rankRange=[]},_onSortRank:function(e,t){return t-e},onInited:function(){var e=game.CfgUtil.getMiscValue(game.ArenaMiscCfg,"rankAwardRange"),t=void 0;if(e&&e.length)for(var a=0,i=(t=e.split(",")).length;a<i;a++)this.rankRange.push(Number(t[a]));this.rankRange.sort(this._onSortRank)},_findRank:function(e){var t=0,a=this.rankRange;if(a&&0<a.length){t=a[0];for(var i=0,n=a.length;i<n;i++){if(a[i]<e){break}t=a[i]}}return t},getData:function(e){var t=this._findRank(e);return this._super(t)}}),b8e.RC("$$game","$$ArenaRewardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,ctor:function(){this._super()},onInited:function(){this.obj1={rechargeId:0},this.obj2={cardType:0}},getDataById:function(e){return this.obj1.rechargeId=e,this.getData(this.obj1)},getDataByType:function(e){return this.obj2.cardType=e,this.getData(this.obj2)}}),b8e.RC("$$game","$$CardRechargeCfg",e)}(),function(){var e;e=game.ActivePrizeModelCfg.extends({_findRank:function(e){var t=void 0,a=this.getCurDayCfgs();if(a&&!(a.length<1)){for(var i=void 0,n=a.length-1;0<=n;n--)e<=(i=a[n]).rank&&(t=i.rank);return t}},getDataByRank:function(e){var t=this;if(e){var a=t._findRank(e);if(a)return t._days||t.getCurDay(),t.getData(t._days,a)}}}),b8e.RC("$$game","$$CsBossRankAwardCfg",e)}(),function(){var e;e=game.CsBossRankAwardCfg.extends({}),b8e.RC("$$game","$$CsBossRankPlayerAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super("id","activityType","serverStart")},onInited:function(){this.obj={id:0},this.obj1={activityType:0},this.obj2={serverStart:0},this.tempList=[]},getListByType:function(e){var t=this;return this.obj1.activityType=e,t.getData(this.obj1,!0)},getDataById:function(e){var t=this;return this.obj.id=e,t.getData(this.obj)}}),b8e.RC("$$game","$$CServRankCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.rankRange=[]},_findRank:function(e){var t=0,a=this.rankRange;if(a&&0<a.length)for(var i=a.length-1;0<=i&&(t=a[i].rank,!(e>=a[i].rank));i--);return t},getDataByRank:function(e){t.rankRange.length||(t.rankRange=t.getDatas());var a=this._findRank(e);return this.getData(a)}}),b8e.RC("$$game","$$CrossWarRankAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({levelList:null,ctor:function(){this._super(),this.levelList=[]},onDataCreate:function(e){e=game.CfgUtil.setPrizeKey(e,"_$exp",e.giveItems)},getCfgData:function(e,t){var a=this;if(a.idListMap||a.setIdListMap(),a.levelList=a.idListMap.get(t),!a.levelList||a.levelList.length<=0){return null}for(var i,n=a.levelList.length-1;0<=n;n--){if((i=this.levelList[n])<=e){return this.getData(i,t)}}return a.getData(a.levelList[0],t)},setIdListMap:function(){this.idListMap=b8e.HashMap.get();var e=game.CfgUtil.getMiscValue(game.DailyMiscCfg,"dailyDangkouAwards",!0,"|");if(e&&2<=e.length)for(var t=Number(e[0]),a=e[1].split(","),i=void 0,n=1;n<=t;n++){i=[],this.idListMap.set(n,i);for(var s=0,o=a.length;s<o;s++)i.push(Number(a[s]))}}}),b8e.RC("$$game","$$DailyDangkouAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({topGrade:0,spacing:0,obj1:null,obj2:null,ctor:function(){this._super(),this.obj1={id:0},this.obj2={count:0}},onInited:function(){this.awardCountList=this.getKeys("count")},getTopGradeCfg:function(){var e=this;if(!e.topGrade){if(1<this.awardCountList.length){var t=this.awardCountList.length;this.topGrade=this.awardCountList[t-1]}}return e.obj2.count=e.topGrade,e.getData(e.obj2,!1)},getSpacing:function(){if(!this.spacing){if(2<this.awardCountList.length){var e=this.awardCountList.length;this.spacing=this.awardCountList[e-1]-this.awardCountList[e-2]}}return this.spacing},getAwardId:function(e){for(var t,a=0,i=this.awardCountList.length-1;0<=i;i--){if((t=this.awardCountList[i])<=e){a=t;break}}if(0==a){return 0}this.obj2.count=a;var n=this.getData(this.obj2,!1);if(n)return n.id;return null},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getIds:function(){return this.getKeys("id")}}),b8e.RC("$$game","$$DailyDangkouCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.maxLv=0},onInited:function(){this.maxLv=Number(game.CfgUtil.getMiscValue(game.DailyMiscCfg,"dailyExpMaxLv"))}}),b8e.RC("$$game","$$DailyExploitCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.totalExp=0},onInited:function(){this.totalExp=Number(game.CfgUtil.getMiscValue(game.DailyMiscCfg,"dailyExpTotal"))}}),b8e.RC("$$game","$$DailyExploitMissionCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({maxDay:0,ctor:function(){this._super()},onInited:function(){this.obj={serverStart:0},this.obj1={id:0}},getMaxDay:function(){if(this.maxDay){return this.maxDay}var e=this.getKeys("serverStart");if(!e||e.length<1){return 0}var t=e.length;this.maxDay=e[t-1]},getDataByDay:function(e){var t=this.getKeys("serverStart");if(!t||t.length<1){return 0}for(var a,i=t.length-1;0<=i;i--){if((a=t[i])<=e){return this.obj.serverStart=a,this.getData(this.obj,!0)}}return null},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)}}),b8e.RC("$$game","$$DailyRechargeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({awardList:null,ctor:function(){this._super(),this.awardList=[]},sort:function(e,t){return e.level-t.level},onDataCreate:function(e){e=game.CfgUtil.setPrizeKey(e,"_$exp",e.items,"_$showItems"),e=game.CfgUtil.setPrizeKey(e,"_$totalExp",e.totalItems,"_$showtotalItems")},gettotalItemsBylevel:function(e){var t=this.getCfgByLevel(e);if(t)return t.showtotalItems;return null},getItemsBylevel:function(e){var t=this.getCfgByLevel(e);if(t)return t.showItems;return null},getCfgByLevel:function(e){var t,a=this;if(a.awardList||(a.awardList=[]),a.awardList.length<1){for(var i=a.getDatas(),n=0;n<i.length;++n)a.awardList.push(i[n]);a.awardList&&0<a.awardList.length&&a.awardList.sort(a.sort)}for(n=a.awardList.length-1;0<=n;n--)if(e>=(t=a.awardList[n]).level)return t;return a.awardList[0]}}),b8e.RC("$$game","$$DailyTaofaAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({awardList:null,ctor:function(){this._super()},onInited:function(){if(this.awardList=this.getDatas(),this.awardList&&0<this.awardList.length){this.awardList.sort(this.sort)}},onDataCreate:function(e){e=game.CfgUtil.setPrizeKey(e,"_$exp",e.items)},sort:function(e,t){return e.level-t.level},getItemsBylevel:function(e){var t;if(!this.awardList||this.awardList.length<1){return null}for(var a=this.awardList.length-1;0<=a;a--){if(e>=(t=this.awardList[a]).level){return t.prizeItems}}return this.awardList[0].prizeItems}}),b8e.RC("$$game","$$DailyTeamAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.obj={id:0}},getDatasById:function(e){return this.obj.id=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$DianWeiInsGroupCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({maxDay:0,ctor:function(){this._super()},onInited:function(){this.obj={serverStart:0}},getMaxDay:function(){var e=this;if(e.maxDay)return e.maxDay;var t=e.getKeys("serverStart");if(!t||t.length<1)return 0;var a=t.length;return e.maxDay=t[a-1],e.maxDay},getData:function(e){var t=this,a=t.getKeys("serverStart");if(!a||a.length<1)return null;t.obj.serverStart=0;var i,n=a.length,s=void 0;for(s=n-1;0<=s;s--)if((i=a[s])<=e){t.obj.serverStart=i;break}if(0==t.obj.serverStart)return null;var o=t._super(t.obj,!0);if(!o||o.length<1)return null;var r=void 0;for(s=0;s<n;s++)if(r=o[s],game.CCommonUtil.getGameChannelIdOpen(r))return r;return null}}),b8e.RC("$$game","$$DiscountRechargeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){var e=this;e.obj={fosterType:1},e.obj1={id:1},e.obj2={type:1,serverStart:1},e.obj3={serverStart:1},e.obj4={type:1,mergeStart:1},e.obj5={mergeStart:1},e.obj6={type:1,fosterType:1,mergeStart:1},e.days=[]},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getDataByType:function(e){return this.obj.fosterType=e,this.getData(this.obj,!0)},getDataByTTD:function(e,t,a){return this.getData(e,t,a,!0,!1)},getDataByTD:function(e,t){return this.obj2.type=e,this.obj2.serverStart=t,this.getData(this.obj2,!0,!1)},getServerStart:function(e){var t=this,a=t.getKeys("serverStart");if(!a||a.length<1)return null;for(var i=a.length,n=void 0,s=void 0,o=t.days.length=0;o<i;o++)n=a[o],t.obj3.serverStart=n,e>=(s=t.getData(t.obj3,!1)).serverStart&&e<s.serverEnd&&t.days.push(n);return t.days},getOneDataByTD:function(e,t){return this.obj2.type=e,this.obj2.serverStart=t,this.getData(this.obj2,!1,!1,!1)},getDatasByDay:function(e){return this.obj3.serverStart=e,this.getData(this.obj3,!0)},getOneDataByTMd:function(e,t){return this.obj4.type=e,this.obj4.mergeStart=t,this.getData(this.obj4,!1,!1,!1)},getDataByTTMd:function(e,t,a){var i=this;return i.obj6.type=e,i.obj6.fosterType=t,i.obj6.mergeStart=a,i.getData(i.obj6,!0,!1)},getDataByTMd:function(e,t){return this.obj4.type=e,this.obj4.mergeStart=t,this.getData(this.obj4,!0,!1)}}),b8e.RC("$$game","$$DiscountShopCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.LvRange=[],this.key={lv:0},this.obj1={days:0}},onDataCreate:function(e){var t=this.LvRange;if(t&&-1==t.indexOf(e.lv)){if(t.push(e.lv),1<t.length){t.sort(this._onSortLv)}}},_onSortLv:function(e,t){return t<e},_findLv:function(e){var t=0,a=this.LvRange;if(a&&0<a.length){t=a[0];for(var i=0,n=a.length;i<n&&!(a[i]>e);i++)t=a[i]}return t},getDatasByLv:function(e){return this.key.lv=this._findLv(e),this.getData(this.key,!0)},getCfgsById:function(e){var t=this.getData(e);if(t)return this.obj1.days=t.days,this.getData(this.obj1,!0)}}),b8e.RC("$$game","$$EscortCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({getNumber:function(e){var t=this.getData(e);return t?parseInt(t.value):0},getString:function(e){var t=this.getData(e);return t?t.value:""}}),b8e.RC("$$game","$$EscortMiscCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.rankRange=[]},onDataCreate:function(e){var t=this.rankRange;if(t&&-1==t.indexOf(e.rank)){if(t.push(e.rank),1<t.length){t.sort(this._onSort)}}},_onSort:function(e,t){return e<t},_findRank:function(e){var t=0,a=this.rankRange;if(a&&0<a.length){t=a[0];for(var i=0,n=a.length;i<n;i++){if(a[i]<e){break}t=a[i]}}return t},getDataByRank:function(e){var t=this;t.rankRange&&t.rankRange.length||t.getDatas();var a=t._findRank(e);return t.getData(a)}}),b8e.RC("$$game","$$ExamAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this.obj={masterType:0,lv:0},this.obj1={masterType:0}},getAllDataByMasterType:function(e){return this.obj1.masterType=e,this.getData(this.obj1,!0)},getMasterConfig:function(e,t){return this.obj.masterType=e,this.obj.lv=t,this.getData(this.obj)},getShowAttr:function(e,t){var a=[],i=this.getMasterConfig(e,t);if(!i)return a;var n=i.clientMasterHpPer,s=i.clientMasterAtkPer,o=i.clientMasterDefPer;return 0<n?(n/=1e3,a.push({type:game.SpriteStatType.Health,value:n,isPer:!0})):0<i.hp&&(n=i.hp,a.push({type:game.SpriteStatType.Health,value:n,isPer:!1})),0<s?(s/=1e3,a.push({type:game.SpriteStatType.Attack,value:s,isPer:!0})):0<i.atk&&(s=i.atk,a.push({type:game.SpriteStatType.Attack,value:s,isPer:!1})),0<o?(o/=1e3,a.push({type:game.SpriteStatType.Defense,value:o,isPer:!0})):0<i.def&&(o=i.def,a.push({type:game.SpriteStatType.Defense,value:o,isPer:!1})),a}}),b8e.RC("$$game","$$ForgeMasterCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.cfgs=null},getMaxNum:function(){var e=this.getCfgs();return e?e.length:0},getNextOpenDay:function(e){var t=this;t.cfgs||(t.cfgs=t.getDatas()||[],t.cfgs.sort(function(e,t){return e.openDay-t.openDay}));for(var a=game.mainRoleData.lv,i=0;i<t.cfgs.length;i++){var n=t.cfgs[i];if(!(e>n.openDay)){if(e<n.openDay)return n;if(e==n.openDay&&a<n.lv)return n}}return null},getCfgs:function(){var e=this;return e.cfgs||(e.cfgs=e.getDatas()||[],e.cfgs.sort(function(e,t){return e.openDay-t.openDay})),e.cfgs},getCurDayCfg:function(e){var t=this.getCfgs();if(!t)return null;for(var a=void 0,i=t.length,n=0;n<i;n++)if((a=t[n])&&a.openDay==e)return a;return null}}),b8e.RC("$$game","$$FuncNoticeCfg",e)}(),function(){var e;e=game.FosterAttrItemCfg.extends({list:null}),b8e.RC("$$game","$$GodArmyAttrCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({_maxPos:0,maxPos:{get:function(){return this._maxPos||(this._maxPos=+game.CfgUtil.getMiscValue(game.GodArmyMiscCfg,"godArmyEquigpMaxPos")),this._maxPos}},ctor:function(){this._super(["pos","lv"])},getTypeSpriteStatCount:function(e,t,a,i){var n=this.getData(e,t);if(!n){return 0}var s=game.SpriteStatType;switch(i){case s.Health:return n.hp;case s.Attack:return n.atk;case s.Defense:return n.def;default:return 0}return 0}}),b8e.RC("$$game","$$GodArmyEquipCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.cfgs=null},getLimitLv:function(e){var t=this;t.cfgs||(t.cfgs=t.getDatas(),t.cfgs.sort(function(e,t){return t.maxLv-e.maxLv}));for(var a=0;a<t.cfgs.length;a++){var i=t.cfgs[a];if(e>=i.maxLv)return i.maxLv}return 0},getTypeSpriteStatCount:function(e,t){var a=this.getLimitLv(e);if(0==a)return 0;var i=this.getData(a);if(!i){return 0}var n=game.SpriteStatType;switch(t){case n.Health:return i.hp;case n.Attack:return i.atk;case n.Defense:return i.def;default:return 0}return 0}}),b8e.RC("$$game","$$GodArmyEquipLvCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(["id","lv"],"id"),this.maxSoliderLv={},this.obj={id:1,lv:1},this.obj1={id:1}},getMaxSoliderLvById:function(e){var t=this,a=t.maxSoliderLv[e];if(a)return a;a=0,t.obj1.id=e;var i=t.getData(t.obj1,!0);return i?(i.sort(function(e,t){return t.lv-e.lv}),0==i.length?a:(a=i[0].lv,t.maxSoliderLv[e]=a)):a},getTypeSpriteStatCount:function(e,t,a,i){var n=this.getData(e,t);if(!n){return 0}var s=0;this.getMaxSoliderLvById(e)!=t&&0!=n.value&&(s=a/n.value);var o=game.SpriteStatType;switch(i){case o.Health:return n.perHp*s+n.hp;case o.Attack:return n.perAtk*s+n.atk;case o.Defense:return n.perDef*s+n.def;default:return 0}return 0}}),b8e.RC("$$game","$$GodArmySoliderCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(["godArmyId","topLv"],"godArmyId"),this.maxTopLv={},this.obj={godArmyId:1,topLv:1},this.obj1={godArmyId:1}},getMaxTopLvById:function(e){var t=this,a=t.maxTopLv[e];if(a)return a;a=0,t.obj1.godArmyId=e;var i=t.getData(t.obj1,!0);return i?(i.sort(function(e,t){return t.topLv-e.topLv}),0==i.length?a:(a=i[0].topLv,t.maxTopLv[e]=a)):a},getNextTopConfig:function(e,t){var a=null;this.obj1.godArmyId=e;var i=this.getData(this.obj1,!0);if(!i)return topLv;for(var n=null,s=0;s<i.length;s++)(n=i[s]).topLv<=t||(!a||n.godArmyLv<a.godArmyLv)&&(a=n);return a}}),b8e.RC("$$game","$$GodArmyTopCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(["id","lv"],"id"),this.obj={id:1,lv:1},this.obj1={id:1}},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1,!0)}}),b8e.RC("$$game","$$GodArmyTopSkillCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(["godArmyId","lv"],"godArmyId"),this.maxUpLv={},this.obj={godArmyId:1,lv:1},this.obj1={godArmyId:1}},getMaxUpLvById:function(e){var t=this,a=t.maxUpLv[e];if(a)return a;a=0,t.obj1.godArmyId=e;var i=t.getData(t.obj1,!0);return i?(i.sort(function(e,t){return t.lv-e.lv}),0==i.length?a:(a=i[0].lv,t.maxUpLv[e]=a)):a},getTypeSpriteStatCount:function(e,t,a,i){var n=this.getData(e,t);if(!n){return 0}var s=0;this.getMaxUpLvById(e)!=t&&0!=n.value&&(s=a/n.value);var o=game.SpriteStatType;switch(i){case o.Health:return n.perHp*s+n.hp;case o.Attack:return n.perAtk*s+n.atk;case o.Defense:return n.perDef*s+n.def;default:return 0}return 0}}),b8e.RC("$$game","$$GodArmyUpCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onDataCreate:function(e){if(!e.spriteStat){e.spriteStat=game.SpriteStatUtil.setDataByCfg(e)}}}),b8e.RC("$$game","$$GodEquipCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onDataCreate:function(a){if(!a.spriteStat){var i=game.SpriteStatUtil.setDataByCfg(a),e=i?i.getSpriteStats():null;if(e&&0<e.count()){e.forEach(function(e,t){i.setStatValue(e,Math.floor(t*a.attrPercent))},this)}a.spriteStat=i}if(!a.maxSpriteStat){a.maxSpriteStat=game.SpriteStatUtil.setDataByCfg(a)}if(!a.power){a.power=game.CCommonUtil.getPower(a.spriteStat)}}}),b8e.RC("$$game","$$GodEquipUpgradeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.LvRange=[]},_onSortLv:function(e,t){return t<e},_findLv:function(e){var t=0,a=this.LvRange;if(a&&0<a.length){t=a[0];for(var i=0,n=a.length;i<n&&!(a[i]>e);i++)t=a[i]}return t},getData:function(e){return this.LvRange.length||this.setLvRange(),e=this._findLv(e),this._super(e)},setLvRange:function(){var e=game.CfgUtil.getMiscValue(game.HighEquipMiscCfg,"highEquipWashLvRange",!0,",");if(e&&e.length)for(var t=0,a=e.length;t<a;t++)this.LvRange.push(Number(e[t]));this.LvRange.sort(this._onSortLv)}}),b8e.RC("$$game","$$GodEquipWashValueCostCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onDataCreate:function(e){game.CfgUtil.setPrizeKey(e,"_$exp",e.challengeAward,"_$challengePrizes"),game.CfgUtil.setPrizeKey(e,"_$exp",e.collectAward,"_$collectPrizes")}}),b8e.RC("$$game","$$GuildCollectCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({getMaxLv:function(){if(this.maxLv){return this.maxLv}return this.maxLv=+game.CfgUtil.getMiscValue(game.GuildMiscCfg,"guildMaxLv"),this.maxLv},getMaxSkillLv:function(){if(!this.maxLv){this.maxLv=this.getMaxLv()}var e=this.getData(this.maxLv);if(e)return e.skillLv;return 0}}),b8e.RC("$$game","$$GuildLvCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({}),b8e.RC("$$game","$$GuildMiscCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({groupList:null,groupListMap:null,ctor:function(){this._super()},onInited:function(){this.groupListMap=b8e.HashMap.get();var e=game.CfgUtil.getMiscValue(game.GuildMiscCfg,"guildSkillGroup",!0,"|");if(e&&e.length)for(var t=void 0,a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=0,g=e.length;r<g;r++)if((t=e[r].split(","))&&4<=t.length){a=Number(t[0]),i=Number(t[1]),n=Number(t[2]),s=Number(t[3]),o=[],this.groupListMap.set(a,o),o.push(i);for(var l=i-1+n;l<=s;l+=n)o.push(l)}},getInitSkill:function(){var e=this;return e.groupList||(e.groupList=e.groupListMap.keys(),e.groupList.sort(e.onSort)),!e.groupList||e.groupList.length<1?null:e.groupList},getMaxLv:function(){return this.maxLv||(this.maxLv=Number(game.CfgUtil.getMiscValue(game.GuildMiscCfg,"guildSkillMaxLv"))),this.maxLv},onSort:function(e,t){return e-t},getData:function(e,t){var a=this.groupListMap.get(e);if(!a){return null}for(var i,n=a.length-1;0<=n;n--){if((i=a[n])<=t){break}}var s=this._super(e,i);if(s)return s;return null},getSkillSpaceList:function(e){return this.groupListMap.get(e)}}),b8e.RC("$$game","$$GuildSkillCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({}),b8e.RC("$$game","$$HeroCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},maxLv:0,onInited:function(){for(var e=this.getDatas(),t=null,a=0,i=e.length;a<i;a++){if((t=e[a]).houseLv>this.maxLv){this.maxLv=t.houseLv}}}}),b8e.RC("$$game","$$HouseAdvCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({_fosterRiseMap:null,_fosterExpMap:null,_list:null,effectItemMap:null,_fosterItems:null,ctor:function(){var e=this;e._super("id","quality"),e._fosterRiseMap=b8e.HashMap.get(),e._fosterExpMap=b8e.HashMap.get(),e.effectItemMap=b8e.HashMap.get(),e.obj={quality:0};var t=game.ItemCfgType;e.cfgTypeMapping={NormalItem:t.NormalItem,Equip:t.Equip,Amount:t.Amount,EffectItem:t.EffectItem,ShowItem:t.ShowItem,PartnerProper:t.PartnerProper,FosterEquip:t.FosterEquip,MythEquip:t.GOD_ANIMAL_EQUIP}},onInited:function(){},onDataCreate:function(e,t){var a=game.ItemCfgType,i=b8e.getDPV(this.cfgTypeMapping,t);i=i||a.None,e.cfgType=i,e.effectValue&&(e.effectValue=e.effectValue.split("|")),e.openLv&&(e.level=e.openLv);var n=void 0,s=void 0;if(e.cfgType==a.EffectItem){if(e.effectType==game.ItemEffectType.RISE&&e.effectValue&&0<e.effectValue.length)for(n=e.effectValue.length,s=0;s<n;s++)e.effectValue[s]=0|e.effectValue[s];if(e.effectType==game.ItemEffectType.F0STER_EXP&&e.effectValue&&0<e.effectValue.length)for(n=e.effectValue.length,s=0;s<n;s++)e.effectValue[s]=0|e.effectValue[s]}},getData:function(e){if(e){var t=this._super(e);if(!t)return null;var a=game.ItemCfgType;switch(t.cfgType){case a.Equip:case a.PartnerProper:case a.FosterEquip:case a.GOD_ANIMAL_EQUIP:if(!t.spriteStat){var i=game.SpriteStatUtil.setDataByCfg(t);t.spriteStat=i}if(t.cfgType!=a.Equip&&t.cfgType!=a.GOD_ANIMAL_EQUIP&&!t.appendSpriteStat){i=game.SpriteStatUtil.setAppendSpriteStat(t);t.appendSpriteStat=i}t.power||(t.power=game.CCommonUtil.getPower(t.spriteStat))}return t}b8e.warn("id\u4e0d\u80fd\u4e3anull\u6216\u8005underfind",e)},getCfgTypeById:function(e){var t=this.getData(e);if(t)return t.cfgType;return 0},getIsAddById:function(e){var t=this.getData(e);if(!t){return!1}if(t.cfgType==game.ItemCfgType.EffectItem){if(0<=t.maxCount){return!0}}return!1},getRiseItemList:function(e){var t=this;if(t.initRiseEffectItem||(t.setFosterItemTypeMap(game.ItemEffectType.RISE),t.initRiseEffectItem=!0),t.riseItemList=t._fosterRiseMap.get(e),!t.riseItemList||t.riseItemList.length<=0){return null}return t.riseItemList.sort(t.onSort.bind(t)),t.riseItemList},setFosterItemTypeMap:function(e){var t=this;if(t._fosterItems||(t._fosterItems=game.FosterItemMiscCfg.getDatas(),t._fosterItems))for(var a=void 0,i=0,n=t._fosterItems.length;i<n;i++)a=t._fosterItems[i],e==game.ItemEffectType.RISE&&t._fosterRiseMap.set(a.type,a.riseItemId),e==game.ItemEffectType.F0STER_EXP&&t._fosterExpMap.set(a.type,a.fosterExpItemId)},getFosterExpItemList:function(e){var t=this;if(t.initFosterExpEffectItem||(t.setFosterItemTypeMap(game.ItemEffectType.F0STER_EXP),t.initFosterExpEffectItem=!0),t.fosterExpItemList=t._fosterExpMap.get(e),!t.fosterExpItemList||t.fosterExpItemList.length<=0){return null}return t.fosterExpItemList.sort(t.onSort.bind(t)),t.fosterExpItemList},getItemNameById:function(e){var t=this.getData(e);if(t)return t.name;return null},getFosterType:function(){return 0},getCfgByQL:function(e,t){return this.obj.quality=e,this.obj.level=t,this.getData(this.obj,!1,!1)},onSort:function(e,t){var a=this.getData(e),i=this.getData(t);if(a&&i){if(a.effectValue[1]&&i.effectValue[1]){return i.effectValue[1]-i.effectValue[1]}return 0}return 0},getCfgItemTypeById:function(e){var t=this.getData(e);if(t)return t.itemType;return 0}}),b8e.RC("$$game","$$ItemInfoCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getCfgData:function(e,t){var a=this.getData(e,!0);if(!a){return null}for(var i=null,n=null,s=0,o=a.length;s<o;s++){if(i=a[s],!n){n=i}if(i.level>=t&&n.level<t){n=i}}return n}}),b8e.RC("$$game","$$MasterExpCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getAwards:function(e){var t=this.getData(e);if(!t||!t.value){return null}if(t.rewards){return t}t.rewards=[];for(var a,i=t.value.split("|"),n=0;n<i.length;n++){if((a=i[n].split(","))&&2==a.length)t.rewards.push({Id:a[0],Num:a[1]});else{b8e.error("MasterMiscCfg:",e,"\u5956\u52b1\u914d\u7f6e\u9519\u8bef")}}return t}}),b8e.RC("$$game","$$MasterMiscCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({_dropMap:null,ctor:function(){this._super(),this._dropMap=b8e.HashMap.get()},getItems:function(s,o,r){var e=this._dropMap.get(s);if(e){o.call(r,e)}else this.getDataAsync(s,function(e){var t=[];if(e)for(var a=e.length,i=0;i<a;i++){var n=e[i];t.push(n.itemId)}this._dropMap.set(s,t),o.call(r,t)},this,!0)}}),b8e.RC("$$game","$$MonDropCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()}}),b8e.RC("$$game","$$NicknameCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({getCfgByDay:function(e){var t=this.getDatas();if(!t||t.length<1)return null;for(var a=!1,i=void 0,n=t.length,s=0;s<n;s++)if((i=t[s]).serverStart<=e&&i.serverEnd>e){a=!0;break}return a?i:null}}),b8e.RC("$$game","$$OpenServerBtnCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(["activityType","type"])}}),b8e.RC("$$game","$$OpenServerTypesClientCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({maxSweepLv:0,ctor:function(){this._super()},onInited:function(){this.maxSweepLv=Number(game.CfgUtil.getMiscValue(game.InstanceMiscCfg,"personalSweepLv"))}}),b8e.RC("$$game","$$PersonalBossCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},_maxLv:0,maxLv:{get:function(){return this._maxLv||(this._maxLv=Number(game.CfgUtil.getMiscValue(game.PetMiscCfg,"petMaxLv"))),this._maxLv}}}),b8e.RC("$$game","$$PetUpgradeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,rechargeList:null,ctor:function(){this._super()},onInited:function(){this.obj1={rechargeId:0},this.obj2={pfType:0}},getRechargeList:function(e){return this.obj2.pfType=e,this.getData(this.obj2,!0)},getDataById:function(e){return this.obj1.rechargeId=e,this.getData(this.obj1)},getDataByType:function(e,t){return e&&t?this.getData(e,t,!0):null}}),b8e.RC("$$game","$$RechargeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.shopEntranceMap=b8e.HashMap.get(),this.spotShopMap=b8e.HashMap.get(),this.spotEntranceMap=b8e.HashMap.get()},onInited:function(){this.obj={shopEntrance:0},this.obj1={id:0}},onDataCreate:function(e){var t=this;if(e.showCondition&&0==e.resetType||e.id==game.ShopIdEnum.GOLDEQUIP_SHOP||e.id==game.ShopIdEnum.SHENJIANG_SHOP){var a=t.spotEntranceMap.get(e.shopEntrance);if(!a){a=[]}a.push(e),t.spotEntranceMap.set(e.shopEntrance,a),t.spotShopMap.set(e.id,e)}},getShopListByEntrance:function(e){var t=this;return t.obj.shopEntrance=e,t.getData(t.obj,!0)},getSpotEntrance:function(e){var t=this;return t.obj.shopEntrance=e,t.getData(t.obj,!0),t.spotEntranceMap.get(e)},getSpotShop:function(e){var t=this;return this.obj1.id=e,t.getData(this.obj1),t.spotShopMap.get(e)},getDataByShopId:function(e){return this.obj1.id=e,this.getData(this.obj1,!1)}}),b8e.RC("$$game","$$ShopCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){var e=this;e._super(),e.shopGroupMap=b8e.HashMap.get(),e.shopGroupNameMap=b8e.HashMap.get(),e.goodsMap=b8e.HashMap.get(),e.gEMinLvMap=b8e.HashMap.get()},onInited:function(){var e=this;e.obj={goodsId:0},e.obj1={shopId:0},e.obj2={shopId:0,itemId:0},e.obj3={shopId:0,hide:0},e.obj4=b8e.createMap()},onDataCreate:function(e){var t=this;if(t.goodsMap.set(e.goodsId,e),e.group&&""!=e.groupName){var a=t.shopGroupNameMap.get(e.shopId);if(!a){a=b8e.HashMap.get()}a.set(e.group,e),t.shopGroupNameMap.set(e.shopId,a)}},getShopList:function(e){return this.obj3.shopId=e,this.getData(this.obj3,!0)},getGroupNameList:function(e){var t=this;this.obj1.shopId=e,t.getData(this.obj1,!0);var a=t.shopGroupNameMap.get(e);if(!a||a.length<1){return null}return a.values()},getGroupList:function(e,t){return this.getData(e,t,0,!0)},getDataByGoodsId:function(e){return this.obj.goodsId=e,this.getData(this.obj)},getEGECfg:function(e){return this.obj2.shopId=game.ShopIdEnum.GOLDEQUIP_SHOP,this.obj2.itemId=e,this.getData(this.obj2)},initGoldEquipList:function(){var e=this.getGroupList(game.ShopIdEnum.GOLDEQUIP_SHOP,1);if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=e.length,n=0;n<i;n++)(t=e[n])&&(a=game.ItemInfoCfg.getData(t.itemId))&&this.gEMinLvMap.set(a.pos,a.level)},getGEMinLv:function(e){var t=e-1;if(!this.posArr){var a=game.ShopMiscCfg.getData("minGoldEquipLv");if(!a)return 0;this.posArr=a.value.split(",")}return+this.posArr[t]||0},getGEByLv:function(e){var t=this;return t.obj4||(t.obj4=b8e.createMap()),t.obj4.equipLv=e,t.getData(t.obj4)}}),b8e.RC("$$game","$$ShopItemCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getDataByDay:function(e,t){var a;if(!this.openServerList||this.openServerList.length<1){this.openServerList=[];var i=game.CfgUtil.getMiscValue(game.WelfareMiscCfg,"signAwardDays",!0,",");if(i&&i.length)for(var n=0,s=i.length;n<s;n++)this.openServerList.push(Number(i[n]))}if((s=this.openServerList.length)<1)return null;for(n=s-1;0<=n;n--){if(t>=this.openServerList[n]){a=this.openServerList[n]}}return this.getData(e,a)}}),b8e.RC("$$game","$$SignInAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getIdDatas:function(e){return this.getData(e,!0)}}),b8e.RC("$$game","$$SuitAttrCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({}),b8e.RC("$$game","$$SuitExpertCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj={},this.obj.types=0},getTypeDatas:function(e){return this.obj.types=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$SuitSkinCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getDataByCount:function(e){var t,a=this.getDatas();if(!a||a.length<1){return null}for(var i=a.length-1;0<=i;i--){if((t=a[i]).exchangeNum<=e){break}}return t}}),b8e.RC("$$game","$$SilverExchangeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.condition1Obj={condition1:0}},getPurchaseTitleList:function(){var e=this;if(e._purchaseTitleList&&0<e._purchaseTitleList.length)return e._purchaseTitleList;var t=e.getDatas();if(!t||t.length<1)return null;e._purchaseTitleMap||(e._purchaseTitleMap=b8e.HashMap.get());for(var a,i,n=0,s=t.length;n<s;n++)if(a=t[n])if(e._purchaseTitleMap.get(a.condition1));else(i=new game.PurchaseTitleInfo).setData(n,a),e._purchaseTitleMap.set(i.condition,i);return e._purchaseTitleList=e._purchaseTitleMap.values(),e._purchaseTitleList},getPurchaseTitleMap:function(){return this._purchaseTitleMap||this.getPurchaseTitleList(),this._purchaseTitleMap},getPurchaseTitleInfo:function(e){if(!e)return null;var t=this.getPurchaseTitleMap();return t&&0<t.count()?t.get(e):null},getPuechaseList:function(e){if(!e)return null;var t=this,a=void 0;if(t._purchaseInfoMap&&0<t._purchaseInfoMap.count()&&(a=t._purchaseInfoMap.get(e))){return a}t.condition1Obj.condition1=e;var i=t.getData(t.condition1Obj,!0);if(!i||i.length<1)return null;var n=0,s=void 0,o=i.length,r=void 0;for(a=[];n<o;n++)(s=i[n])&&((r=new game.PurchaseInfo).setData(s),a.push(r));return a&&0<a.length&&(t._purchaseInfoMap||(t._purchaseInfoMap=b8e.HashMap.get()),t._purchaseInfoMap.set(e,a)),a},getPurchaseInfoMap:function(){if(!this._purchaseInfoMap){var e=this.getKeys("condition1");if(!e||e.length<1)return null;for(var t=0,a=e.length,i=void 0;t<a;t++)i=e[t],this.getPuechaseList(i)}return this._purchaseInfoMap},getFirstCfg:function(){if(this._firstCfg)return this._firstCfg;var e=this.getDatas();if(!e||e.length<1)return null;var t=e[0];return t?this._firstCfg=t:null}}),b8e.RC("$$game","$$QuanMinPurchaseCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({insMap:null,ctor:function(){this._super(),this.obj={type:0},this.insMap=b8e.HashMap.get()},onInited:function(){},onSort:function(e,t){return e.limitLv-t.limitLv},getCurInsId:function(e,t){var a=1<arguments.length&&void 0!==t?t:1,i=this.getList(a);if(!i||i.length<=0)return b8e.warn("\u6ca1\u6709\u526f\u672c\u914d\u7f6e,type:",a),0;for(var n,s=i.length-1;0<=s;s--)if((n=i[s]).limitLv<=e)return n.id;return b8e.warn("\u6ca1\u6709\u53ef\u5f00\u542f\u7684\u526f\u672c\u914d\u7f6e"),i[0].id},getList:function(e){var t=0<arguments.length&&void 0!==e?e:1,a=this,i=a.insMap.get(t);if(!i){if(a.obj.type=t,!(i=a.getData(a.obj,!0)))return null;i.sort(a.onSort),a.insMap.set(t,i)}return i}}),b8e.RC("$$game","$$TeamInstanceCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({lvTriggers:null,vipTriggers:null,guildLvTriggers:null,openDaysTriggers:null,openTaskMap:null,rechargeTriggers:null,ctor:function(){var e=this;e._super(),e.lvTriggers=[],e.vipTriggers=[],e.openDaysTriggers=[],e.guildLvTriggers=[],e.rechargeTriggers=[],e.openTaskMap=b8e.HashMap.get()},onInited:function(){this.getDatas(),this.lvTriggers.sort(function(e,t){return e.__level-t.__level}),this.vipTriggers.sort(function(e,t){return e.__vipLevel-t.__vipLevel}),this.guildLvTriggers.sort(function(e,t){return e.__guildLv-t.__guildLv})},onDataCreate:function(e){var t=this;e.trigger1&&t._initTrigger(e,e.trigger1),e.trigger2&&t._initTrigger(e,e.trigger2)},_initTrigger:function(e,t){var a=this;if(e&&t&&0!=t.length)for(var i,n,s,o=a.lvTriggers,r=a.vipTriggers,g=a.rechargeTriggers,l=a.guildLvTriggers,c=t.length,h=game.TriggerType,m=0;m<c;m++)switch(n=(i=t[m]).Value,i.Type){case h.Level:e.__level=n,o[o.length]=e;break;case h.Vip:e.__vipLevel=n,r[r.length]=e;break;case h.Task:(s=a.openTaskMap.get(n))||(s=[],a.openTaskMap.set(n,s)),s[s.length]=e;break;case h.OpenDays:a.openDaysTriggers.indexOf(e)<0&&a.openDaysTriggers.push(e);break;case h.GuildLv:e.__guildLv=n,l[l.length]=e;break;case h.Days:case h.Times:case h.NotCross:case h.CrossGuild:break;case h.RechargePlatform:e.__rechargePlatform=n,g[g.length]=e;break;default:b8e.warn("\u672a\u5904\u7406\u7684\u529f\u80fd\u5f00\u542f\u89e6\u53d1\u7c7b\u578b",i.Type)}},getLvTriggers:function(e){for(var t=[],a=this.lvTriggers,i=a.length,n=0;n<i;n++){var s=a[n];if(s.__level>e)break;t[t.length]=s}return t},getGuildLvTriggers:function(e){for(var t=[],a=this.guildLvTriggers,i=a.length,n=0;n<i;n++){var s=a[n];if(s.__guildLv>e)break;t[t.length]=s}return t},removeTrigger:function(e){var t=void 0;if(void 0!==e.__level){var a=this.lvTriggers;-1<(t=a.indexOf(e))?a.splice(t,1):b8e.error("\u7b49\u7ea7\u5f00\u542f\u540e\u5217\u8868\u5904\u7406\u5f02\u5e38\uff01")}if(void 0!==e.__vipLevel){var i=this.vipTriggers;-1<(t=i.indexOf(e))?i.splice(t,1):b8e.error("\u7b49\u7ea7\u5f00\u542f\u540e\u5217\u8868\u5904\u7406\u5f02\u5e38\uff01")}if(null!=e.__rechargePlatform){var n=this.rechargeTriggers;-1<(t=n.indexOf(e))?n.splice(t,1):b8e.error("\u5145\u503c\u5f00\u542f\u540e\u5217\u8868\u5904\u7406\u5f02\u5e38\uff01")}},getModulesByTask:function(e){return this.openTaskMap.get(e)||null},getVipTriggers:function(e){for(var t=[],a=this.vipTriggers,i=a.length,n=0;n<i;n++){var s=a[n];if(s.__vipLevel>e)break;t[t.length]=s}return t},getRechargeTriggers:function(){return this.rechargeTriggers},getCfgByME:function(e){return e?this.getData(e,null,!1):null}}),b8e.RC("$$game","$$TriggerCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({_groupObj:null,ctor:function(){this._groupObj={group:0},this._super()},getGroupDatasAsync:function(e,t,a){if(e){var i=this._groupObj;i.group=e,this.getDataAsync(i,function(e){t.call(a,e)},this,!0)}}}),b8e.RC("$$game","$$InstanceCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({levelList:null,ctor:function(){this._super()},onInited:function(){this.obj={id:0},this.obj1={activityType:0},this.obj3={clientGroup:0},this.tempList=[]},getListByType:function(e){var t=this;return this.obj1.activityType=e,t.getData(this.obj1,!0)},getDataById:function(e){var t=this;return this.obj.id=e,t.getData(this.obj)},getListByOpenDay:function(e){var t=this,a=t.getKeys("clientGroup");if(a||!(a.length<1)){for(var i=void(t.tempList.length=0),n=void 0,s=a.length,o=void 0,r=0;r<s;r++)i=a[r],t.obj3.clientGroup=i,(n=t.getData(t.obj3,!1,!0,!1))&&n.serverStart<=e&&n.serverEnd>e&&(o=t.getData(t.obj3,!0),t.tempList=t.tempList.concat(o));return t.tempList}}}),b8e.RC("$$game","$$UpgradeRebateCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.sweepMap=b8e.HashMap.get()},maxVipLv:0,maxSweepTime:0,sweepMap:null,sweepArr:null,questCompleteLv:0,autoSellLv:0,onInited:function(){var e=this,t=game.CfgUtil,a=game.VipMiscCfg;e.maxVipLv=Number(t.getMiscValue(a,"vipMaxLevel")),e.autoSellLv=Number(t.getMiscValue(a,"vipAutoSellLv")),e.maxSweepTime=Number(t.getMiscValue(a,"vipMaxmaterialBuyTimes"));var i=t.getMiscValue(a,"vipMaterialBuyTimes"),n=void 0,s=void 0;if(i&&i.length){for(var o=0,r=(n=i.split("|")).length;o<r;o++)(s=n[o].split(","))&&2<=s.length&&e.sweepMap.set(Number(s[1]),Number(s[0]));e.sweepArr=e.sweepMap.values(),e.sweepArr.sort(e.sortFunc)}},getMaxLv:function(){return this.maxVipLv},getAutoSellLv:function(){return this.autoSellLv},getNextMatTimesVipCfg:function(a){var i=this.maxSweepTime,n=0;if(this.sweepMap.forEach(function(e,t){if(a<e&&e<i){i=e,n=t}},this),n<=0){return null}return this.getData(n)},getQuestComplete:function(){},getBackAddSlots:function(e){var t=this.getData(e);if(t)return t.bagAddSlots;return 0},getSilverNum:function(e){var t=this.getData(e);if(t)return t.silverNum;return 0},getTreeNum:function(e){var t=this.getData(e);if(t)return t.treeNum;return 0},getZhuanJiNum:function(e){var t=this.getData(e);return t?t.memoir:0},getGuoShi:function(e){var t=this.getData(e);if(t)return t.guoShi;return 0},getMysterShopNum:function(e){var t=this.getData(e);if(t)return t.mysteryRefreshTimes;return 0},onSort:function(e,t){return e.vipLv-t.vipLv}}),b8e.RC("$$game","$$VipCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj={group:0}},getAwardByGroup:function(e){return this.obj.group=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$XiandiAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({_xiandiMap:null,_xiandiAreaIdMap:null,_xiandiList:null,_minIndex:1,_maxIndex:0,ctor:function(){this._super(),this._xiandiList=[]},onInited:function(){this.obj={group:0},this.obj2={showAwardTag:0},this.obj3={diffcultType:0}},getAreaList:function(e){var t=this;if(t._needInit(),!t._xiandiMap.has(e)){if(!t._xiandiAreaIdMap.has(e))return null;for(var a=t._xiandiAreaIdMap.get(e),i=[],n=0,s=a.length;n<s;n++)i.push(t.getData(a[n]));t._xiandiMap.set(e,i)}return t._xiandiMap.get(e)},getShowAward:function(){return this.obj2.showAwardTag=1,this.getData(this.obj2,!0)},getListByDiffcult:function(e){return this.obj3.diffcultType=e,this.getData(this.obj3,!0)},minIndex:{get:function(){return this._minIndex}},maxIndex:{get:function(){if(!this._maxIndex){var e=game.XiandiMiscCfg.getData("maxIndex");if(e){var t=e.value;this._maxIndex=+t}}return this._maxIndex}},_needInit:function(){var e=this;if(!e._xiandiAreaIdMap){var t=Number(game.CfgUtil.getMiscValue(game.XiandiMiscCfg,"maxId")),a=Number(game.CfgUtil.getMiscValue(game.XiandiMiscCfg,"areaLen")),i=game.CfgUtil.getMiscValue(game.XiandiMiscCfg,"diffcults",!0,",");e._xiandiMap=b8e.HashMap.get(),e._xiandiAreaIdMap=b8e.HashMap.get();for(var n,s=1,o=1;o<=t;o++){for(var r=0,g=i.length;r<g;r++)if(o<=Number(i[r])){e._xiandiList.push({id:o,diffcultType:r+1});break}(!n||a<=n.length)&&(n=[],e._xiandiAreaIdMap.set(s,n),s++),n.push(o)}}}}),b8e.RC("$$game","$$XiandiCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getStar:function(e){var t=this.getDatas();if(!t||t.length<=0){return 0}var a=0;t.sort(this.sort);for(var i=a=0;i<t.length;++i){if(e<=t[i].round){a=t[i].star;break}}return a},sort:function(e,t){return e.round-t.round}}),b8e.RC("$$game","$$XiandiStarCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({_layerGroup:null,ctor:function(){this._super(),this._layerGroup={layerGroup:0},this._maxLayer=game.CfgUtil.getZhanjiangLastLayer()},getAreaList:function(e){var t=this;return e>t._maxLayer&&(e=t._maxLayer),t._layerGroup.layerGroup=e,t.getData(t._layerGroup,!0)}}),b8e.RC("$$game","$$ZhanJiangCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({zhaoqinMap:null,layerAwardList:null,ctor:function(){this._super(),this.zhaoqinMap=b8e.HashMap.get(),this._maxLayer=game.CfgUtil.getZhaoqinLastLayer()},onInited:function(){this.obj1={layer:0},this.obj2={awardGround:0},this.obj3={type:0},this.obj4={monsterType:1}},getAreaList:function(e){var t=this.zhaoqinMap.get(e);if(t)return t;t=[];for(var a,i=3*(e-1)+1,n=3+i,s=void 0,o=i;o<n;o++)s?t.push(null):(s=(a=this.getData(o)).lastRound,t.push(a));return this.zhaoqinMap.set(e,t),t},getPrizeList:function(e){var t=this;if(e)return e>t._maxLayer&&(e=t._maxLayer),t.obj2.awardGround=e,t.getData(t.obj2,!0)},getMonsterText:function(){return this.getData(this.obj4,!0)},getLayerAwardList:function(){var e,t,a=this;if(a.layerAwardList&&0<a.layerAwardList.length)return a.layerAwardList;a.layerAwardList=[];for(var i=1;i<=a._maxLayer;i++)if(e=a.getPrizeList(i)){e.length;for(var n=0;n<e.length;n++)(t=e[n])&&a.layerAwardList.push(t)}return a.layerAwardList},getListByType:function(e){return this.obj3.type=e,this.getData(this.obj3,!0)}}),b8e.RC("$$game","$$ZhaoQinCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj={id:0},this.obj1={activityType:0}},getListByType:function(e){var t=this;return this.obj1.activityType=e,t.getData(this.obj1,!0)},getDataById:function(e){var t=this;return this.obj.id=e,t.getData(this.obj)}}),b8e.RC("$$game","$$ProgressActivityCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({getCostNumByForgeType:function(e,t,a){var i=0,n=this._getCostRateByQuality(t,e);return e!=game.EquipForgeType.GEM&&(i=Math.ceil(n*a)),i},_getCostRateByQuality:function(e,t){var a=game.ForgeQualityCfg.getData(e),i=0;if(!a)return i;var n=game.EquipForgeType;switch(t){case n.INTENSIFY:i=a.qhRate;break;case n.REFINE:i=a.clRate;break;case n.PURIFY:i=a.fhRate;break;default:b8e.error("[\u953b\u9020]\u6ca1\u6709\u627e\u5230\u7c7b\u578b"+t)}return i},getShowAttrPercent:function(e,t,a){var i=[];if(!t)return i;var n=game.ForgeAttrRateCfg.getData(t);if(!n)return i;var s=0,o=0,r=0;switch(e){case game.EquipForgeType.INTENSIFY:s=n.clientQhHpPer,o=n.clientQhAtkPer,r=n.clientQhDefPer;break;case game.EquipForgeType.REFINE:s=n.clientClHpPer,o=n.clientClAtkPer,r=n.clientClDefPer;break;case game.EquipForgeType.PURIFY:s=n.clientFhHpPer,o=n.clientFhAtkPer,r=n.clientFhDefPer}var g=s/1e3*a,l=o/1e3*a,c=r/1e3*a;return 0<g&&i.push({type:game.SpriteStatType.Health,value:g,isPer:!0}),0<l&&i.push({type:game.SpriteStatType.Attack,value:l,isPer:!0}),0<c&&i.push({type:game.SpriteStatType.Defense,value:c,isPer:!0}),i},getShowAttr:function(e,t,a){var i=[];if(!t)return i;var n=game.ForgeAttrRateCfg.getData(t);if(!n)return i;var s=0,o=0,r=0;switch(e){case game.EquipForgeType.INTENSIFY:s=n.clientQhHpBase,o=n.clientQhAtkBase,r=n.clientQhDefBase;break;case game.EquipForgeType.REFINE:s=n.clientClHpBase,o=n.clientClAtkBase,r=n.clientClDefBase;break;case game.EquipForgeType.PURIFY:s=n.clientFhHpBase,o=n.clientFhAtkBase,r=n.clientFhDefBase}var g=s*a,l=o*a,c=r*a;return 0<g&&i.push({type:game.SpriteStatType.Health,value:g,isPer:!1}),0<l&&i.push({type:game.SpriteStatType.Attack,value:l,isPer:!1}),0<c&&i.push({type:game.SpriteStatType.Defense,value:c,isPer:!1}),i},getAttrDataByForgeType:function(e,t,a){if(t){var i=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Health]),n=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Attack]),s=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Defense]),o=game.ForgeAttrRateCfg.getData(t);if(o){var r=0,g=0,l=0,c={};switch(e){case game.EquipForgeType.INTENSIFY:r=o.qhHp*a,g=o.qhAtk*a,l=o.qhDef*a;break;case game.EquipForgeType.REFINE:r=o.clHp*a,g=o.clAtk*a,l=o.clDef*a;break;case game.EquipForgeType.PURIFY:r=o.fhHp*a,g=o.fhAtk*a,l=o.fhDef*a;break;default:return}return c[i]=r,c[n]=g,c[s]=l,c}}}}),b8e.RC("$$game","$$ForgeCfg",e)}(),function(){var e;e=game.ForgeCfg.extends({getCostNum:function(e,t){return this.getCostNumByForgeType(game.EquipForgeType.INTENSIFY,e,t)}}),b8e.RC("$$game","$$ForgeUpgradeCfg",e)}(),function(){var e;e=game.ForgeCfg.extends({getCostNum:function(e,t){return this.getCostNumByForgeType(game.EquipForgeType.REFINE,e,t)}}),b8e.RC("$$game","$$ForgeRefineCfg",e)}(),function(){var e;e=game.ForgeCfg.extends({ctor:function(){this._super(["types","lv"])},getCostNum:function(e,t){return this.getCostNumByForgeType(game.EquipForgeType.PURIFY,e,t)}}),b8e.RC("$$game","$$ForgePurifyCfg",e)}(),function(){var e;e=game.ForgeCfg.extends({getShowAttrPercent:function(e,t,a){var i=[],n=this.getData(e,t,a);if(!n)return i;var s=n.clientGemHpPer/1e3,o=n.clientGemAtkPer/1e3,r=n.clientGemDefPer/1e3;return 0<s&&i.push({type:game.SpriteStatType.Health,value:s,isPer:!0}),0<o&&i.push({type:game.SpriteStatType.Attack,value:o,isPer:!0}),0<r&&i.push({type:game.SpriteStatType.Defense,value:r,isPer:!0}),i},getShowAttr:function(e,t,a){var i=[],n=this.getData(e,t,a);if(!n)return i;var s=n.clientGemHpBase,o=n.clientGemAtkBase,r=n.clientGemDefBase;return 0<s&&i.push({type:game.SpriteStatType.Health,value:s,isPer:!1}),0<o&&i.push({type:game.SpriteStatType.Attack,value:o,isPer:!1}),0<r&&i.push({type:game.SpriteStatType.Defense,value:r,isPer:!1}),i}}),b8e.RC("$$game","$$ForgeGemCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(["group","subId"],"group"),this.groupSubIdObj={},this.obj1={group:0}},getMaxSubIdCfgByGroup:function(e){var t=this;if(!t.groupSubIdObj[e]){t.obj1.group=e;var a=t.getData(t.obj1,!0);a&&0<a.length&&(a.sort(function(e,t){return t.subId-e.subId}),t.groupSubIdObj[e]=a[0].subId)}return t.groupSubIdObj[e]}}),b8e.RC("$$game","$$SmashGoldEggCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.obj1={id:0},this.groupList=[]},onInited:function(){for(var e=this,t=e.getKeys("id"),a=0;a<t.length;a++){e.obj1.id=t[a];var i=e.getData(e.obj1,!1,!1,!1);e.groupList.push(i)}},getEndTime:function(e){this.obj1.id=e;var t=this.getData(this.obj1);return t&&t.endTime?b8e.TimeUtil.dateParse(t.endTime,"yyyy-MM-dd  hh:mm:ss").getTime():0},getCurGroup:function(){for(var e=game.miscData.openServerDay,t=game.SysTime.curTime,a=0;a<this.groupList.length;a++){var i=this.groupList[a];if(!(e<i.serverStart||e>=i.serverEnd)){if(0!=i.startTime&&0!=i.endTime){var n=b8e.TimeUtil.dateParse(i.startTime,"yyyy-MM-dd  hh:mm:ss").getTime(),s=b8e.TimeUtil.dateParse(i.endTime,"yyyy-MM-dd  hh:mm:ss").getTime();if(t<n||s<=t)continue}return i.id}}return 0}}),b8e.RC("$$game","$$SmashGoldEggOpenCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({stickObj:null,pfTypeObj:null,rechargeObj:null,ctor:function(){this._super()},onInited:function(){this.stickObj={stickId:0},this.pfTypeObj={pfType:0},this.rechargeObj={rechargeId:0}},getDataByType:function(e){return this.pfTypeObj.pfType=e,this.getData(this.pfTypeObj,!0)},getDataById:function(e){return this.stickObj.stickId=e,this.getData(this.stickObj)},getDataByRechargeId:function(e){return this.rechargeObj.rechargeId=e,this.getData(this.rechargeObj)}}),b8e.RC("$$game","$$StickCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({levelList:null,ctor:function(){this._super()},onInited:function(){this.obj={id:0},this.obj1={serverStart:0},this.obj2={group:0}},getListByDay:function(e){var t=this,a=t.getKeys("group");if(!a||a.length<1)return null;for(var i=!1,n=void 0,s=void 0,o=a.length,r=0;r<o;r++)if(s=a[r],t.obj2.group=s,(n=t.getData(t.obj2,!1,!0,!1))&&n.serverStart<=e&&n.serverEnd>e){i=!0;break}return i&&n?(t.obj1.serverStart=n.serverStart,t.getData(t.obj1,!0)):null},getDataByDay:function(e){var t=this.getListByDay(e);return!t||t.length<1?null:t[0]},getDataById:function(e){return this.obj.id=e,this.getData(this.obj)}}),b8e.RC("$$game","$$ContinuousRechargeCfg",e)}(),function(){var e;e=game.ContinuousRechargeCfg.extends({levelList:null,ctor:function(){this._super()}}),b8e.RC("$$game","$$ContinuousRecharge2Cfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){var e=this;e._super(),e.pDatas={},e.groupList=[],e.gMax={},e.firstData={}},onInited:function(){var e=this;e.obj1={group:0},e.obj2={serverStart:0},e.obj3={id:0};for(var t=e.getKeys("group"),a=0;a<t.length;a++){e.obj1.group=t[a];var i=e.getData(e.obj1,!1,!1,!1);e.groupList.push(i)}},getMaxPuzzleByGroup:function(e){var t=this;if(!t.gMax[e]){t.obj1.group=e;var a=t.getData(t.obj1,!0);a.sort(function(e,t){return t.id-e.id});var i=0;0<a.length&&(i=a[0]),t.gMax[e]=i}return t.gMax[e]},getCurGroup:function(e){for(var t=0;t<this.groupList.length;t++){var a=this.groupList[t];if(e>=a.serverStart&&e<a.serverEnd)return a.group}return 0},getCurGroupTime:function(e){for(var t=0;t<this.groupList.length;t++){var a=this.groupList[t];if(e>=a.serverStart&&e<a.serverEnd)return a}return 0},getChipsById:function(e){var t=this;if(!t.pDatas[e]){t.obj3.id=e;var a=t.getData(t.obj3,!0);a.sort(function(e,t){return e.chip-t.chip}),t.pDatas[e]=a}return t.pDatas[e]},getFirstPuzzleId:function(e){var t=this;if(!t.firstData[e]){t.obj1.group=e;var a=t.getData(t.obj1,!0);if(!a)return 0;a.sort(function(e,t){return e.id-t.id});for(var i=null,n=0;n<a.length;n++)if(1==a[n].isFirst){i=a[n];break}t.firstData[e]=i}return t.firstData[e].id}}),b8e.RC("$$game","$$PuzzleCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.obj={id:1,TaskType:1},this.obj1={TaskType:1},this.firstTaskCfgs={}},getTaskByIdTyp:function(e,t){return this.obj.id=e,this.obj.TaskType=t,this.getData(this.obj)},getFirstTaskByType:function(e){var t=this;if(!t.firstTaskCfgs[e]){t.obj1.TaskType=e;var a=t.getData(t.obj1,!0),i=null;if(!a||0==a.length)return null;for(var n=0;n<a.length;n++){var s=a[n];if(1==s.isFirst){i=s;break}}i&&(t.firstTaskCfgs[e]=i)}return t.firstTaskCfgs[e]}}),b8e.RC("$$game","$$PuzzleTaskCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj1={id:0},this.obj2={id:0,itemId:0}},getListById:function(e){return this.obj1.id=e,this.getData(this.obj1,!0)}}),b8e.RC("$$game","$$QualityExpCfg",e)}(),function(){var e;e=game.ZhaoQinCfg.extends({ctor:function(){this._super(),this._maxLayer=game.CfgUtil.getWanshouLastLayer()}}),b8e.RC("$$game","$$WanShouCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.aKey={starMapId:0},this.bKey={starMapId:0,pos:1}},onDataCreate:function(e){e.spriteStat||(e.spriteStat=game.SpriteStatUtil.setDataByCfg(e)),e.power||(e.power=game.CCommonUtil.getPower(e.spriteStat))},getDataByWsId:function(e){return this.aKey.starMapId=e,this.getData(this.aKey,!0)},getDatasByWsIdAndPos:function(e,t){return this.bKey.starMapId=e,this.bKey.pos=t,this.getData(this.bKey,!0)}}),b8e.RC("$$game","$$WuShengCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onDataCreate:function(e){e.spriteStat||(e.spriteStat=game.SpriteStatUtil.setDataByCfg(e)),e.power||(e.power=game.CCommonUtil.getPower(e.spriteStat))},getDataById:function(e){return this._idKey||(this._idKey={id:0}),this._idKey.id=e,this.getData(this._idKey,!1,!1)},getDatasByWsId:function(e){return this._wsIdKey||(this._wsIdKey={starMapId:0}),this._wsIdKey.starMapId=e,this.getData(this._wsIdKey,!0)},getDatasByQuality:function(e){return this._qualityKey||(this._qualityKey={changeQuality:0}),this._qualityKey.changeQuality=e,this.getData(this._qualityKey,!0)}}),b8e.RC("$$game","$$WuShengPosActivateCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getGradeByRank:function(e){var t;if(this._grades&&0<this._grades.length&&(t=this._grades[e]))return t;this._grades||(this._grades=[]);var a=this.getDatas();if(!a||a.length<1)return null;for(var i,n,s=0,o=a.length;s<o;s++)if((i=a[s])&&e<=i.rank){n=i;break}return this._grades[e]=n},getNextGradeByRank:function(e){var t;if(this._nextGrades&&0<this._nextGrades.length&&(t=this._nextGrades[e]))return t;this._nextGrades||(this._nextGrades=[]);var a=this.getDatas();if(!a||a.length<1)return null;for(var i,n,s=a.length-1;0<=s;s--)if((i=a[s])&&e>i.rank){n=i;break}return this._nextGrades[e]=n},getIconUrl:function(e){var t=this.getGradeByRank(e),a="";return t&&""!=t.gradeIcon&&(a=game.ResCfg.getImgUrl("csArena/"+t.gradeIcon)),a},getSeasonRewards:function(){if(this._seasonRewards&&0<this._seasonRewards.length)return this._seasonRewards;var e=this.getDatas();if(!e||e.length<1)return null;this._seasonRewards||(this._seasonRewards=[]);for(var t,a,i=0,n=e.length;i<n;i++){if(t=e[i]){(a=new game.CSArenaSeasonInfo).cfg=t,this._seasonRewards.push(a)}}return this._seasonRewards},getRankList:function(){if(this._rankList&&0<this._rankList.length)return this._rankList;var e=this.getDatas();if(!e||e.length<1)return null;this._rankList||(this._rankList=[]);for(var t,a,i=0,n=e.length;i<n;i++){if(t=e[i]){(a=new game.CSArenaGradeInfo).cfg=t,this._rankList.push(a)}}return this._rankList}}),b8e.RC("$$game","$$CSArenaGradeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getList:function(){if(this._lists&&0<this._lists.length)return this._lists;var e=this.getDatas();if(!e||e.length<1)return null;this._lists||(this._lists=[]);for(var t,a,i=0,n=e.length;i<n;i++){if(t=e[i]){(a=new game.CSArenaScoreInfo).cfg=t,a.score=game.csArenaData.score,a.labelId=5610,this._lists.push(a)}}return this._lists}}),b8e.RC("$$game","$$CSArenaScoreAwardCfg",e)}(),function(){var e;e=game.FosterAttrItemCfg.extends({list:null}),b8e.RC("$$game","$$PatriotAttrCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},maxLv:0,onInited:function(){this.maxLv=Number(game.CfgUtil.getMiscValue(game.PatriotMiscCfg,"upgradeMaxLv"))}}),b8e.RC("$$game","$$PatriotUpgradeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onDataCreate:function(e){e.spriteStat||(e.spriteStat=game.SpriteStatUtil.setDataByCfg(e)),e.power||(e.power=game.CCommonUtil.getPower(e.spriteStat))}}),b8e.RC("$$game","$$AlbumCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj1={rank:0},this.obj2={show:1}},getDataByRank:function(e){if(e)return this.obj1.rank=e,this.getData(this.obj1,!1)},getDataByShow:function(){return this.getData(this.obj2,!0)}}),b8e.RC("$$game","$$CsGuildAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj1={id:0,lv:0},this.obj2={id:0}},getDataByIdLv:function(e,t){return this.obj1.id=e,this.obj1.lv=t,this.getData(this.obj1,!1)},getDataById:function(e){return this.obj2.id=e,this.getData(this.obj2,!0)}}),b8e.RC("$$game","$$ShengshouUpgradeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.idObj={id:0},this.lvObj={lv:0}},getDataByType:function(e,t){return this.getData(e,t)}}),b8e.RC("$$game","$$DragonBallCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.idObj={id:0},this.lvObj={lv:0}},getDataByType:function(e,t){return this.getData(e,t,!0)}}),b8e.RC("$$game","$$GodPatternCfg",e)}(),function(){var e;e=game.FosterAttrItemCfg.extends({ctor:function(){this._super()}}),b8e.RC("$$game","$$TransferAttrItemCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.obj={count:0,activityId:0}},getBaseData:function(e,t){return this.obj.count=e,this.obj.activityId=t,this.getData(this.obj)}}),b8e.RC("$$game","$$TreasureCostCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({levelList:null,ctor:function(){this._super()},onInited:function(){this.obj={id:0},this.obj1={mergeStart:0},this.obj2={group:0}},getListByDay:function(e){var t=this.getKeys("group");if(!t||t.length<1)return null;for(var a=!1,i=void 0,n=void 0,s=t.length,o=0;o<s;o++)if(n=t[o],this.obj2.group=n,(i=this.getData(this.obj2,!1,!0,!1))&&i.mergeStart<=e&&i.mergeEnd>e){a=!0;break}return a&&i?(this.obj1.mergeStart=i.mergeStart,this.getData(this.obj1,!0)):null},getGroupListByDay:function(e,t){var a=this.getKeys("group");if(!a||a.length<1)return null;var i=[],n=void 0,s=void 0,o=void 0,r=void 0,g=a.length;for(r=0;r<g;r++)o=a[r],this.obj2.group=o,!(n=this.getData(this.obj2,!0,!0,!1))||n.length<1||(s=n[0]).mergeVer==t&&s.mergeStart<=e&&s.mergeEnd>e&&(i=i.concat(n));return i},getDataByDay:function(e){var t=this.getListByDay(e);return!t||t.length<1?null:t[0]},getDataById:function(e){return this.obj.id=e,this.getData(this.obj)},getOnceDataByGroup:function(e){return this.obj2.group=e,this.getData(this.obj2,!1,!0,!1)}}),b8e.RC("$$game","$$MergeKeepRechargeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({levelList:null,ctor:function(){this._super()},onInited:function(){this.obj={id:0},this.obj1={mergeStart:0},this.obj2={group:0}},getListByDay:function(e){var t=this.getKeys("group");if(!t||t.length<1)return null;for(var a=!1,i=void 0,n=void 0,s=t.length,o=0;o<s;o++)if(n=t[o],this.obj2.group=n,(i=this.getData(this.obj2,!1,!0,!1))&&i.mergeStart<=e&&i.mergeEnd>e){a=!0;break}return a&&i?(this.obj1.mergeStart=i.mergeStart,this.getData(this.obj1,!0)):null},getGroupListByDay:function(e,t){var a=this.getKeys("group");if(!a||a.length<1)return null;var i=[],n=void 0,s=void 0,o=void 0,r=void 0,g=a.length;for(r=0;r<g;r++)o=a[r],this.obj2.group=o,!(n=this.getData(this.obj2,!0,!0,!1))||n.length<1||(s=n[0]).mergeVer==t&&s.mergeStart<=e&&s.mergeEnd>e&&(i=i.concat(n));return i},getDataByDay:function(e){var t=this.getListByDay(e);return!t||t.length<1?null:t[0]},getDataById:function(e){return this.getData(e)},getOnceDataByGroup:function(e){return this.obj2.group=e,this.getData(this.obj2,!1,!0,!1)},getTypeList:function(){var e=this.typeList;if(e&&0<e.length)return e;e=e||(this.typeList=[]);var t=this.getKeys("type");if(!t||t.length<1)return e;for(var a=void 0,i=t.length,n=0;n<i;n++)a=t[n],e.indexOf(a)<0&&e.push(a);return e.sort(function(e,t){return e-t}),e}}),b8e.RC("$$game","$$MergeCostGoldCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.maxUpLv=0},getCfg:function(e,t){return this.getUData(e,t)},getNextAttrCfg:function(e,t){this.maxUpLv||(this.maxUpLv=Number(game.CfgUtil.getMiscValue(game.MilitaryArrayMiscCfg,"zhenqiMaxLv")));for(var a=null,i=t;i<=this.maxUpLv;i++)if(1==(a=this.getCfg(e,i)).break){i+1<=this.maxUpLv&&(a=this.getCfg(e,i+1));break}return a}}),b8e.RC("$$game","$$MilitaryArrayFlagUpCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},getCfg:function(e,t){return this.getData(e,t)},getTypeSpriteStatCount:function(e,t,a,i){var n=this.getCfg(e,t);if(!n){return 0}var s=0;n.isMax||0==n.value||(s=a/n.value);var o=game.SpriteStatType;switch(i){case o.Health:return n.perHp*s+n.hp;case o.WushuangAtk:return n.perWushuangAtk*s+n.wushuangAtk;case o.WushuangDef:return n.perWushuangDef*s+n.wushuangDef;default:return 0}return 0}}),b8e.RC("$$game","$$MilitaryArrayMapUpCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.maxUpLv={},this.obj={id:1,lv:1},this.obj1={id:1}},getCfg:function(e,t){return this.obj.id=e,this.obj.lv=t,this.getData(this.obj)}}),b8e.RC("$$game","$$MilitaryArrayUpCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj={store:0}},getDataByStore:function(e){return this.obj.store=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$DigTreasureNumAwardsCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onInited:function(){this.obj={id:0}},getDataById:function(e){return this.obj.id=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$FuDaiDailyAwardsCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onInited:function(){this.obj={id:0}},getDataById:function(e){return this.obj.id=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$FuDaiTotalAwardsCfg",e)}(),function(){var e;e=game.ActivePrizeModelCfg.extends({}),b8e.RC("$$game","$$ThroneRankCfg",e)}(),function(){var e;e=game.ActivePrizeModelCfg.extends({}),b8e.RC("$$game","$$GuildWarPersonalScoreRankAwardCfg",e)}(),function(){var e;e=game.FosterAttrItemCfg.extends({ctor:function(){this._super()}}),b8e.RC("$$game","$$WineVesselAttrItemCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onInited:function(){this.key1={serverDay:0},this.key2={serverDay:0,active:0},this.key3={daliyType:0},this.key4={daliyType:0,dailyExpType:0}},getDatasByDay:function(e){return this.key1.serverDay=e,this.getData(this.key1,!0)},getDataByScore:function(e,t){return this.key2.serverDay=e,this.key2.active=t,this.getData(this.key2)},getTaskDatasByDaliyType:function(e){return this.key3.daliyType=e,this.getData(this.key3,!0)},getTaskDataByType:function(e,t){return this.key4.daliyType=e,this.key4.dailyExpType=t,this.getData(this.key4)}}),b8e.RC("$$game","$$DailyScoreAwardCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({onInited:function(){this.key1={id:0,actId:0},this.key2={actId:0},this.key3={rechargeId:0},this.key4={actType:0}},getDatasByAcid:function(e){return this.key2.actId=e,this.getData(this.key2,!0)},getDatasByAcType:function(e){return this.key4.actType=e,this.getData(this.key4,!0)},getDataByRechargeId:function(e){return this.key3.rechargeId=e,this.getData(this.key3)},getDataByIdAcid:function(e,t){return this.key1.id=e,this.key1.actId=t,this.getData(this.key1)}}),b8e.RC("$$game","$$TimeLimitPrizeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},onInited:function(){this.obj={group:0},this.obj1={id:0},this.obj2={openServerDay:0}},getDataByDay:function(e){return this.obj2.openServerDay=e,this.getData(this.obj2)},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getGroupList:function(e){return this.obj.group=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$KeepCostCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.aKey={id:0,types:0},this.bKey={types:0}},getDataById:function(e,t){return this.aKey.id=e,this.aKey.types=t,this.getData(this.aKey)},getDataByType:function(e){return this.bKey.types=e,this.getData(this.bKey,!0)},getDataByVip:function(e,t){var a=this.getDataByType(t);if(!a)return null;for(var i=void 0,n=0,s=a.length;n<s;n++)if((i=a[n])&&e==i.vipLv)return i}}),b8e.RC("$$game","$$VipForeverCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.key1={id:0},this.key2={id:0,selectId:0}},getDataById:function(e){return this.key1.id=e,this.getData(this.key1)},getDataByIdAndSId:function(e,t){return this.key2.id=e,this.key2.selectId=t,this.getData(this.key2)}}),b8e.RC("$$game","$$SummonPreViewCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.obj1={id:0},this.obj2={partnerId:0}},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getDataByPartnerId:function(e){return this.obj2.partnerId=e,this.getData(this.obj2)}}),b8e.RC("$$game","$$PartnerAwardCfg",e)}(),function(){var e;e=game.ForgeCfg.extends({getShowAttr:function(e,t,a){var i=this;i.result||(i.result=[]),i.result.length=0;var n=i.getData(e,t);if(!n)return i.result;var s=i.getEndAttr(n,a),o=s.hp,r=s.atk,g=s.def;return 0<o&&i.result.push({type:game.SpriteStatType.Health,value:o,isPer:!1}),0<r&&i.result.push({type:game.SpriteStatType.Attack,value:r,isPer:!1}),0<g&&i.result.push({type:game.SpriteStatType.Defense,value:g,isPer:!1}),i.result},getShowAttr2:function(e,t){this.result2||(this.result2=[]),this.result2.length=0;var a=this.getData(e,t);if(!a)return this.result2;var i=a.clientHpAdd||0,n=a.clientAtkAdd||0,s=a.clientDefAdd||0;return 0<i&&this.result2.push({type:game.SpriteStatType.Health,value:i}),0<n&&this.result2.push({type:game.SpriteStatType.Attack,value:n}),0<s&&this.result2.push({type:game.SpriteStatType.Defense,value:s}),this.result2},getAttrDataByLvAndExp:function(e,t,a){if(e){var i=this.getData(e,t);if(i){var n=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Health]),s=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Attack]),o=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Defense]),r=Math.round(a/i.value)||0;return this.attr={},this.attr[n]=(i.hp||0)+r*(i.perHp||0),this.attr[s]=(i.atk||0)+r*(i.perAtk||0),this.attr[o]=(i.def||0)+r*(i.perDef||0),this.attr}}},getEndAttr:function(e,t){var a=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Health]),i=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Attack]),n=b8e.getNormP(game.KeyByStatType[game.SpriteStatType.Defense]),s=Math.round(t/e.value)||0;return this.attr2={},this.attr2[a]=(e.clientHp||0)+s*(e.perHp||0),this.attr2[i]=(e.clientAtk||0)+s*(e.perAtk||0),this.attr2[n]=(e.clientDef||0)+s*(e.perDef||0),this.attr2},getCostNum:function(e,t,a){var i=0;if(!e)return i;var n=this.getData(e,t);return n?(i=(n.totalNum||0)+Math.round(a/n.value)*n.itemNum)||0:i}}),b8e.RC("$$game","$$ForgeZhulingCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({getShowAttr:function(e,t){this.result||(this.result=[]),this.result.length=0;var a=this.getData(e,t);if(!a)return this.result;for(var i=game.SpriteDefine,n=i.length,s=void 0,o=void 0,r=void 0,g=void 0,l=0;l<n;l++){if(r=i[l])if(o=r.type,g=!!((s=a[b8e.getNormP(r.clientPer)])&&0<s)||(s=a[b8e.getNormP(r.key)],!1),s&&!(s<=0))game.AttrRulesCfg.getData(o)&&this.result.push({type:o,value:s,isPer:g})}return this.result},getAttrDataByLvAndId:function(e,t){if(e)return this.getData(e,t)}}),b8e.RC("$$game","$$ForgeFuseCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj:null,ctor:function(){this._super("id","partnerId")},getSkinByPartnerId:function(e){return this.obj||(this.obj=b8e.createMap()),this.obj.partnerId=e,this.getData(this.obj,!0)}}),b8e.RC("$$game","$$PartnerSkinCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,obj3:null,ctor:function(){this._super(),this.groupMap=b8e.HashMap.get(),this.groupList=[]},onInited:function(){this.obj1={id:0},this.obj2={serverStart:0},this.obj3={group:0};for(var e=this.getKeys("group"),t=e.length,a=0;a<t;a++){var i=e[a];this.obj3.group=i;var n=this.getData(this.obj3,!1,!1,!1);this.groupList.push(n)}},getListByDay:function(e){return this.obj3.group=e,this.getData(this.obj3,!0,!1)},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getCurGroup:function(e){for(var t=this.groupList,a=t.length,i=0;i<a;i++){var n=t[i];if(e>=n.serverStart&&e<n.serverEnd)return n.group}return 0}}),b8e.RC("$$game","$$WelfareTargetCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({isOpen:function(e){var t=game.mainRoleData.lv,a=this.getData(e);return!a||t>=a.lv}}),b8e.RC("$$game","$$SpotAlertCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,ctor:function(){this._super()},onInited:function(){this.obj1={id:0,star:0},this.obj2={id:0}},getDataById:function(e){return this.obj2.id=e,this.getData(this.obj2,!0)},getOneData:function(e,t){return this.obj1.id=e,this.obj1.star=t,this.getData(this.obj1)}}),b8e.RC("$$game","$$MythStarCfg",e)}(),function(){var e;e=b8e.Object.extends({activeBtns:null,activeBtnByGroup:null,activeBtnsMap:null,_miscId:0,isShrink:!1,showShrinkBtn:!1,luckyTurnArr:null,activeParentList:null,ctor:function(e){var t=this;t._super(),t._miscId=e,t.activeBtns=[],t.activeBtnByGroup=b8e.HashMap.get(),t.luckyTurnArr=[],t.activeParentList=[]},getDatas:function(){return null},getData:function(){return null},initBtns:function(){if(!this.activeBtnsMap){var e=this.miscData=game.GameBarMiscCfg.getData(this._miscId);this.activeBtnsMap=b8e.HashMap.get();var t=this.getDatas();if(!t||t.length<1)return null;var a=void 0,i=void 0,n=t.length;this.isShrink=!e.defaultOpen,this.showShrinkBtn=e.showShrinkBtn;for(var s=0;s<n;s++)a=t[s],(i=new game.ActiveBarInfo).setMiscData(e),i.setBaseData(a),this.activeBtnsMap.set(i.id,i)}},getBtns:function(){var e=this;if(e.tempBtn=null,!e.activeBtnsMap){e.initBtns()}if(e.activeBtns.length=0,e.luckyTurnArr.length=0,e.activeParentList.length=0,e.activeBtnByGroup.clear(),!e.activeBtnsMap){return e.activeBtns}var t=e.activeBtnsMap.values(),a=e.miscData.shrinkCount,i=e.miscData.id,n=game.activeChildrenData;n.clearActiveMap(i);for(var s,o=t.length,r=void 0,g=void 0,l=void 0,c=0<a,h=!1,m=0;m<o;m++)if(s=t[m],e.isShowActive(s.id,!1,c)){if(r=e.getData(s.id),s.setData(r),s.setShrink(e.isShrink),s.countDown=e.getCountDown(s.id),s.labString=e.getLabString(s.id),s.actStartTime=e.getActStartTime(s.id),r.parentsae?s.spotAlertEnum=r.parentsae:s.spotAlertEnum=e.getTypeIsAlert(r.activeBarType,s.id),r.activeBarType==game.ActiveBarItemType.SHRINK_BTN&&(e.tempBtn=s),0<r.groupType){var u=e.activeBtnByGroup.get(r.groupType);if(u){if(u.groupPriority>s.groupPriority)continue;var d=e.activeBtns.indexOf(u);-1<d&&e.activeBtns.splice(d,1)}e.activeBtnByGroup.set(r.groupType,s)}if(g=r.parentId){if(h=1==e.activeParentList[g],e.activeParentList[g]=1,n.setActiveMap(i,g,s),(l=e.getData(g))&&e.changeAlertEnum(s.spotAlertEnum,l.parentsae),h)continue;if(!(s=e.activeBtnsMap.get(g)))continue;r=e.getData(g),s.setData(r),e.activeBtns.push(s)}else r.isParentBtn||e.activeBtns.push(s)}var f=e.activeBtns.length;return 0<f&&(e.showShrinkBtn&&e.isShrink&&0<a&&a<f?(e.activeBtns.sort(e.shrinkSortBtns),e.activeBtns.splice(a),e.activeBtns[a-1].activeBarType!=game.ActiveBarItemType.SHRINK_BTN&&e.activeBtns[0].activeBarType!=game.ActiveBarItemType.SHRINK_BTN&&(e.activeBtns[a]=e.tempBtn)):e.activeBtns.sort(e.sortBtns)),e.activeBtns},changeAlertEnum:function(e,t){if(t&&e){var a=b8e.spotAlert.get(e);if(a&&a.__owner__){var i=a.__owner__.type;if(i==t)return;game.spotAlert.cover(e,t);var n=b8e.spotAlert.get(t);n&&n.__owner__&&a.__owner__.type!=t&&game.spotAlert.cover(t,i)}else game.spotAlert.cover(e,t)}},sortBtns:function(e,t){return e.sortId==t.sortId?e.groupPriority-t.groupPriority:e.sortId-t.sortId},shrinkSortBtns:function(e,t){return e.shrinkSortId==t.shrinkSortId?e.groupPriority-t.groupPriority:e.shrinkSortId-t.shrinkSortId},isShowActive:function(e,t,a){var i=this.getData(e);if(!i)return!1;var n=i.activeBarType,s=game.ActiveBarItemType;if(n==s.ACTIVE_NOTICE&&2==game.miscData.openServerDay){var o=!1;return""!=this.getTomorrowNotice(i)&&(o=!0),o}if(0<i.checkOpenEnum&&!game.moduleOpen.checkOpen(i.checkOpenEnum)){return!1}switch(n){case s.DISCOUNT_RECHARGE:return game.rechargeData.getDiscountRechargeIsShow(1);case s.TODAY_DISCOUNT_RECHARGE:return game.rechargeData.getDiscountRechargeIsShow(2);case s.DAILY_RECHARGE:return game.rechargeData.getDailyRechargeIsShow();case s.FUND:return game.welfareData.getFundIsShow();case s.INVESTMENT:return!!game.investData.getInvestOpen();case s.DIANWEI:return!!game.dwData.isOpenById(i.id);case s.PARTNER_GIFT:return!!game.partnerGiftData.isOpen();case s.MONTH_CARD:return!game.rechargeData.getCardIsHas(game.CardType.MONTH);case s.WEEK_CARD:return!game.rechargeData.getCardIsHas(game.CardType.WEEK);case s.DAILY:return game.moduleOpen.checkOpen(game.ME.Daily);case s.BACK:return game.moduleOpen.checkOpen(game.ME.Back);case s.MAIL:return game.moduleOpen.checkOpen(game.ME.Mail);case s.RELATION:return game.moduleOpen.checkOpen(game.ME.Relation);case s.YUANBAO_SHOP:return game.shopData.getHasShopList(game.ShopEntrance.COMMON_1)&&game.moduleOpen.checkOpen(game.ME.Shop);case s.WANFA_SHOP:return game.shopData.getHasShopList(game.ShopEntrance.COMMON_2)&&game.moduleOpen.checkOpen(game.ME.Shop);case s.INSTFUNC_SHOP:return game.shopData.getHasShopList(game.ShopEntrance.GOLD_SHOP)&&game.moduleOpen.checkOpen(game.ME.Shop);case s.ARENA_SHOP:return game.shopData.getHasShopList(game.ShopEntrance.COMMON_3)&&game.moduleOpen.checkOpen(game.ME.Shop);case s.PEACHGARDEN:return game.moduleOpen.checkOpen(game.ME.PeachGarden);case s.LOGINAWARDS:return game.moduleOpen.checkOpen(game.ME.LoginAwards)&&!game.loginAwardsData.isGetAllPrize()&&game.loginAwardsData.getShowDay()==i.loginDay;case s.OPEN_SERVER:return game.moduleOpen.checkOpen(game.ME.OpenServer)&&game.openServerData.getOpenServerIsOpen();case s.WELFARE:return game.moduleOpen.checkOpen(game.ME.Welfare);case s.SALE_RECHARGE:return game.saleRechargeData.isShowBtn();case s.CHOOSE_RECHARGE:return game.moduleOpen.checkOpen(game.ME.ManyFirstCharge)&&game.manyFirstChargeData.isShowBtn();case s.SWITCH_ACCOUNT:return game.sdk.supportLogout();case s.LUCKY_TURNPLATE:return game.xunBaoData.checkOpenById(i.luckyId);case s.SHARE_ACHIEVE:return game.moduleOpen.checkOpen(game.ME.ShareMain)&&game.GlobalCfg.getOpenShare(game.LoginConfig.gameChannelId);case s.ACTIVE_NOTICE:e=parseInt(i.id);var r=game.mainActivityNoticeBarData.getData(e).weektime,g=0<=game.mainActivityNoticeBarData.getCountdown(e,3);if(!r||g)return!1;var l=0!=b8e.TimeUtil.getDay(game.SysTime.curTime)?b8e.TimeUtil.getDay(game.SysTime.curTime):7;return r&&-1!=r.indexOf(l)&&!g;case s.FREE_GIFT:return game.moduleOpen.checkOpen(game.ME.FreeGift)&&game.freeGiftData.isStartAct()&&!game.freeGiftData.isGetAllPrise(!1);case s.PET_TURNPLATE:return game.moduleOpen.checkOpen(game.ME.PetTurnplate);case s.ACCUMULATIVE_RECHARGE:return game.accumulativeRechargeData.checkOpenType(i.type)&&!game.accumulativeRechargeData.getAllAward();case s.FESTIVAL:return game.moduleOpen.checkOpen(game.ME.Festival)&&game.festivalData.getHasOpenFestivalByType(s.FESTIVAL);case s.STICK:return game.moduleOpen.checkOpen(game.ME.Festival)&&game.festivalData.getHasOpenFestivalByType(s.STICK);case s.FUNC_NOTICE:return game.moduleOpen.checkOpen(game.ME.FuncNotice)&&game.funcNoticeData.getNoticeIsOpen();case s.VERIFY_NAME:return game.LoginConfig.hasRealVerify&&game.moduleOpen.checkOpen(game.ME.VerifyName)&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyName);case s.VERIFY_VIPCN:return game.LoginConfig.canFocus&&game.moduleOpen.checkOpen(game.ME.VerifyVipcn)&&game.JunHaiSdk.wanbaViewCanShow("followWechat")&&(!game.LoginConfig.isFocus||!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyVipcn));case s.VERIFY_WEIDUAN:return game.LoginConfig.canDownloadMicro&&game.moduleOpen.checkOpen(game.ME.VerifyWeiduan)&&game.JunHaiSdk.wanbaViewCanShow("downloadGameAPP")&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyWeiDuan);case s.VERIFY_COLLECTION:if(!game.moduleOpen.checkOpen(game.ME.VerifyCollection))return!1;if(game.IS_WANBA)return!1;if(game.IS_BAIZE)return game.verifyAwardData.canShowByGCId(game.LoginConfig.gameChannelId);if(b8e.isWeChatGame){var c=game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyCollection);if(!c){var h=wx.getSystemInfoSync();if(h){var m=h.system,u=h.version,d=/iPad|iPhone|iOS|iPod/.test(m),f=-1<m.indexOf("Android");if(d)return this.getWXVersion(u,"6.7.1")&&!c;if(f)return!c}}}return!1;case s.VERIFY_ADD_SHORTCUT:return game.LoginConfig.canAddShortcut&&game.JunHaiSdk.wanbaViewCanShow("favoritesToDesktop")&&game.moduleOpen.checkOpen(game.ME.VerifyAddShortcut);case s.FIRST_RECHARGE:return game.moduleOpen.checkOpen(game.ME.FirstRecharge)&&game.rechargeData.getFRIsShowById(i.type);case s.QQ_INTEREST_TRIBE:return game.moduleOpen.checkOpen(game.ME.VerifyInterestTribe)&&game.IS_WANBA&&"QZ"!==game.JunHaiSdk.getApp()&&!b8e.isWeChatGame&&game.JunHaiSdk.wanbaViewCanShow("buluo");case s.TIME_LIMIT_GIFT:return game.timeLimitPrizeData.checkOpenByActId(i.actId)&&!game.timeLimitPrizeData.isBuyAll(i.actId)&&game.timeLimitPrizeData.checkLv(i.lvLimit);case s.ACC_COST:return game.accCostData.checkOpenByGroup(i.accGroup);case s.QQ_VIP_PRIVILEGE:return game.moduleOpen.checkOpen(game.ME.QQVipPrivilege)&&game.IS_WANBA&&!b8e.isWeChatGame&&game.JunHaiSdk.wanbaViewCanShow("miniGameVIP");case s.QQ_VIP_GIFT:return game.moduleOpen.checkOpen(game.ME.QQVipDailyGift)&&game.IS_WANBA&&!game.verifyAwardData.collectedWanbaQQVipPrize&&"QQVip"===game.JunHaiSdk.getChannel();case s.ONLINEGIFT:return!1;case s.WUSHENG:return game.moduleOpen.checkOpen(game.ME.WuShengMain);case s.STRONGER:return game.moduleOpen.checkOpen(game.ME.Stronger);case s.GOOD_GIFT:return game.goodGiftData.isOpen();case s.FESTIVAL_RECHARGE:return game.festivalRechargeData.isOpen();case s.ACC_CON_CARNIVAL:return game.accConCarnivalData.getOpenServerIsOpen();case s.GROW_GIFT:return game.growGiftData.getOpenServerIsOpen();case s.MYSTERY_SHOP:return game.mystery2ShopData.checkOpen(i.type);case s.MERGE_SERVER:return game.moduleOpen.checkOpen(game.ME.MergeServer)&&game.mergeServerData.getOpenServerIsOpen();case s.CROSS_SERVICE_RANK_COST:case s.CROSS_SERVICE_RANK_RECHARGE:return game.moduleOpen.checkOpen(game.ME.CServRank)&&game.cservRankData.getOpenByType(i.type);case s.MERGE_FREE_GIFT:return game.moduleOpen.checkOpen(game.ME.MergeFreeGift)&&game.freeGiftData.isMergeStartAct()&&!game.freeGiftData.isGetAllPrise(!0);case s.PUZZLE:return game.moduleOpen.checkOpen(game.ME.Puzzle)&&game.puzzleData.getIsOpen();case s.TODAY_FUNC_NOTICE:return game.moduleOpen.checkOpen(game.ME.FuncNotice)&&game.funcNoticeData.getCurDayIsOpen();case s.REBATE_AWARD:return game.welfareData.getIsShowRebateAward();case s.SMASH_GOLD_EGG:return game.smashGoldEggData.getIsOpen();case s.XINYUE:return game.IS_WANBA&&"xinYueClub"==game.JunHaiSdk.getApp();case s.MORE_EXCITING:return game.IS_WANBA&&"QQLive"==game.JunHaiSdk.getApp();case s.MONOPOLY:return game.monopolyData.getIsOpen();case s.VIP_WELFARE:return game.vipWelfareData.getIsOpen();case s.DIG_TREASURE:return game.digTreasureData.isDigOpen();case s.SUPER_VIP:return game.verifyAwardData.showSVActive;case s.BIND_MOBILE:return game.LoginConfig.canBindPhone&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyPhone);case s.SPECIAL_OFFER:return game.moduleOpen.checkOpen(game.ME.Festival)&&game.festivalData.getHasOpenFestivalByType(s.SPECIAL_OFFER);case s.CHAIN_GIFT:return game.chainGiftData.checkOpenByGroup(i.type,i.rechargeId);case s.QUEST_LINK:return game.verifyAwardData.showQuestLink();case s.DAILY_FULI:return game.moduleOpen.checkOpen(game.ME.DailyFuLi);case s.QQ_VIEW_DAILY_RECHARGE:return game.tVDailyRechargeData.getIsOpen();case s.FUDAI:return game.fuDaiData.isFuDaiOpen();case s.FOLLOW_GIFT:return game.verifyAwardData.hasFollowGift();case s.JUBAOPEN:return game.juBaoPenData.isJuBaoOpen();case s.FESTIVAL_BOSS_CS:return game.csFestivalBossData.isActOpen();case s.TREASURE_PAVILION:return game.treasurePavilionData.isActOpen();case s.COMRADE_BACK:return game.regressRewardData.isComradeBackOpen();case s.REGRESS_ACTIVITY:return game.regressRewardData.isRegressActOpen();case s.TEMPLE:return game.incenseData.checkOpenTime();case s.LIMIT_GIFT:return game.limitGiftData.checkOpen();case s.COLOR_TICKET:return game.IS_QQ_GAME&&b8e.isWeChatGame;case s.PUSH_PRIZE_RECHARGE:return game.pushPrizeData.getIsShow();case s.CONTINUOUS_CONSUME:return game.continuousConsumeData.checkActIsOpen();case s.CATCH_PET:return!1;case s.WAR_ORDER:return game.warOrderData.getIsOpen();case s.MONEY_CAT:return game.moneyCatData.checkOpen();case s.OPEN_SER_CARNIVAL:return game.openSerCarnivalData.getIsOpenType(0);case s.WEEK_ACTIVITY:return game.openSerCarnivalData.getIsOpenType(1);case s.HUNLU:return game.moduleOpen.checkOpen(game.ME.Hunlu);case s.OPEN_COMPETITION:return game.openCompetitionData.getIsOpen();case s.QQ_REDPACKET:return game.qqRedPacketData.getIsOpen();case s.COFFERS:return game.moduleOpen.checkOpen(game.ME.Coffers)&&!!game.coffersData.getCurActCfg();case s.MOBILE_BIND:return game.MobileBindData.checkOpen();case s.BOON_RECHARGE:return game.moduleOpen.checkOpen(game.ME.BOON_RECHARGE)&&!!game.boonRechargeData.getCurActCfg();case s.VALUE_REBATE:return game.moduleOpen.checkOpen(game.ME.ValueRebate)&&!!game.valueRebateData.getCurActCfg();case s.DAYORWEEK:return game.moduleOpen.checkOpen(game.ME.DayOrWeekGift)&&!!game.dayOrWeekGiftData.getOpenAct();case s.SHELL:return!!game.shellData.getOpenId();case s.SCRATCH:return game.surpriseScratchData.checkActIsOpen();case s.ONEYUANBUY:return game.moduleOpen.checkOpen(game.ME.OneYuanBuy)&&game.oneYuanBuyData.checkActIsOpen();case s.HUNTING_CONTEST:return game.huntingContestData.getIsOpen();case s.NEWFIRSTCHARGE:return game.newFirstChargeData.getIsOpen();case s.NEW_COMPETITION:return game.openCompetitionDataNew.getIsOpen();case s.WELFARETARGET:return game.welfareTargetData.checkOpen();case s.DAILY_WISH:return game.moduleOpen.checkOpen(game.ME.DailyWish);case s.LIMIT_EXCHANGE:return game.moduleOpen.checkOpen(game.ME.ExchangePanel)&&0<game.ExchangeActiveMgr.inst().getCurProceedId();case s.LIMIT_SALE_PRIZE_ACTIVE:return game.limitSalePrizeData.checkLimitSaleOpen()&&!game.limitSalePrizeData.isBuyAll();case s.OPTIONAL_LOTTERY:return game.moduleOpen.checkOpen(game.ME.OptionalLottery)&&game.optionalLotteryData.isOpenAct();case s.MIBAO:return game.mibaoData.checkOpen();case s.QQVIDEO:return game.IS_QQ_GAME;case s.QM_STAR_1:return game.QmStarMgr.inst().checkOpenByActiveId(1);case s.QM_STAR_2:return game.QmStarMgr.inst().checkOpenByActiveId(2);default:return!0}},getWXVersion:function(e,t){for(var a=e.split("."),i=t.split("."),n=Math.min(a.length,i.length),s=0,o=0;s<n&&0==(o=parseInt(a[s])-parseInt(i[s]));)s++;return 0<=o},getTypeIsAlert:function(e,t){if(!this.getData(t))return 0;var a=game.ActiveBarItemType;switch(e){case a.DISCOUNT_RECHARGE:case a.TODAY_DISCOUNT_RECHARGE:return game.SAE.DISCOUNT_RECHARGE_ALERT;case a.DAILY_RECHARGE:return game.SAE.DAILY_RECHARGE_ALERT;case a.FUND:return game.SAE.FUND_ALERT;case a.WELFARE:return game.SAE.WELFARE_ALERT;case a.INVESTMENT:return game.SAE.INVEST_ALERT;case a.DIANWEI:return game.SAE.DIANWEI_ALERT;case a.PARTNER_GIFT:return game.SAE.PARTNER_GIFT_ALERT;case a.DAILY:return game.SAE.DAILY_ALERT;case a.BACK:return game.SAE.BACK_PACK;case a.MAIL:return game.SAE.MAIL;case a.RELATION:return game.SAE.RELATION;case a.YUANBAO_SHOP:return game.SAE.SHOP_ALERT_1;case a.WANFA_SHOP:return game.SAE.SHOP_ALERT_2;case a.INSTFUNC_SHOP:return game.SAE.SHOP_ALERT_3;case a.ARENA_SHOP:return game.SAE.SHOP_ALERT_4;case a.PEACHGARDEN:return game.SAE.PEACH_GARDEN;case a.LOGINAWARDS:return game.SAE.LOGIN_PRIZE;case a.OPEN_SERVER:return game.SAE.OPEN_SERVER_ALERT;case a.CHOOSE_RECHARGE:return game.SAE.MANY_FIRST_CHARGE;case a.WAR_BOOK:return game.SAE.WAR_BOOK_BASE;case a.FREE_GIFT:return game.SAE.FREE_GIFT;case a.PET_TURNPLATE:return game.SAE.PET_TURNPLATE;case a.SHARE_ACHIEVE:return game.SAE.ACHIEVE_ALERT_BASE;case a.ACCUMULATIVE_RECHARGE:return game.SAE.ACCUMULATIVERECHARGE_PAGE_ALERT;case a.FESTIVAL:return game.SAE.FESTIVAL;case a.STICK:return game.SAE.DRAWLOT;case a.VERIFY_NAME:return game.SAE.VERIFY_NAME_ALERT;case a.VERIFY_VIPCN:return game.SAE.VERIFY_VIPCN_ALERT;case a.VERIFY_WEIDUAN:return game.SAE.VERIFY_WEIDUAN_ALERT;case a.VERIFY_COLLECTION:return game.SAE.VERIFY_COLLECTION_ALERT;case a.MILITARY:return game.SAE.MILITARY_ALERT;case a.FIRST_RECHARGE:return game.SAE.FIRST_RECHARGE_ALERT;case a.ACC_COST:return game.SAE.ACC_COST_ALERT;case a.ONLINEGIFT:return!1;case a.WUSHENG:case a.WUSHENG2:case a.WUSHENG3:case a.WUSHENG4:return game.SAE.WUSHEN_MAIN_ALERT;case a.SHINV_ADV:return game.SAE.SHINV_ADV_ALERT;case a.FIGHTPOS_NOTICE:return game.SAE.FIGHTPOS_NOTICE_ALERT;case a.VERIFY_ADD_SHORTCUT:return game.SAE.VERIFY_ADD_SHORTCUT_ALERT;case a.GOOD_GIFT:return game.SAE.GOOD_GIFT_ALERT;case a.FESTIVAL_RECHARGE:return game.SAE.FESTIVAL_RECHARGE_ALERT;case a.STRONGER:return game.SAE.STRONGER_ALERT;case a.ACC_CON_CARNIVAL:return game.SAE.ACC_CON_CARNIVAL_ALERT;case a.GROW_GIFT:return game.SAE.GROW_GIFT_ALERT;case a.MYSTERY_SHOP:return game.SAE.MYSTERY2_SHOP_ALERT;case a.MERGE_SERVER:return game.SAE.MERGE_SERVER_ALERT;case a.MERGE_FREE_GIFT:return game.SAE.MERGE_FREE_GIFT;case a.PUZZLE:return game.SAE.PUZZLE;case a.SMASH_GOLD_EGG:return game.SAE.SMASH_GOLD_EGG;case a.QQ_VIP_GIFT:return game.SAE.QQ_VIP_GIFT;case a.XINYUE:return game.SAE.XINYUE;case a.MONOPOLY:return game.SAE.MONOPOLY;case a.VIP_WELFARE:return game.SAE.VIP_WELFARE_ALERT;case a.DIG_TREASURE:return game.SAE.DIG_ALERT;case a.SUPER_VIP:return game.SAE.SUPER_VIP;case a.BIND_MOBILE:return game.SAE.BIND_MOBILE;case a.SPECIAL_OFFER:return game.SAE.SPECIAL_OFFER;case a.DAILY_FULI:return game.SAE.DAILY_FULI;case a.QQ_VIEW_DAILY_RECHARGE:return game.SAE.QQ_VIEW_DAILY_RECHARGE;case a.LUCKY_TURNPLATE_LIST:return game.SAE.LUCKYTURN;case a.FUDAI:return game.SAE.FUDAI_ALERT;case a.JUBAOPEN:return game.SAE.JUBAO_ALERT;case a.FESTIVAL_BOSS_CS:return game.SAE.FESTIVAL_BOSS_CS;case a.TREASURE_PAVILION:return game.SAE.TREASURE_PAVILION;case a.COMRADE_BACK:return game.SAE.COMRADE_BACK;case a.REGRESS_ACTIVITY:return game.SAE.REGRESS_ACTIVITY;case a.TEMPLE:return game.SAE.INCENSE_ALERT;case a.REWARDER:return game.SAE.REWARDER;case a.COLOR_TICKET:return game.SAE.VERIFY_COLOR_TICKET_ALERT;case a.PUSH_PRIZE_RECHARGE:return game.SAE.PUSH_PRIZE;case a.MY_MAP:return game.SAE.MY_MAP;case a.RANK:return game.SAE.RANK;case a.WAR_ORDER:return game.SAE.WAR_ORDER;case a.CONTINUOUS_CONSUME:return game.SAE.CONTINUOUS_CONSUME;case a.MONEY_CAT:return game.SAE.MONEY_CAT_ALERT;case a.OPEN_SER_CARNIVAL:case a.WEEK_ACTIVITY:return game.SAE.OPEN_SER_CARNIVAL;case a.HUNLU:return game.SAE.HUNLU;case a.OPEN_COMPETITION:return game.SAE.OPEN_COMPETITION_ALERT;case a.QQ_REDPACKET:return game.SAE.QQ_REDPACKET;case a.COFFERS:return game.SAE.COFFERS;case a.VALUE_REBATE:return game.SAE.VALUE_REBATE_ALL;case a.BOON_RECHARGE:return!1;case a.SHELL:return game.SAE.SHELL;case a.SCRATCH:return game.SAE.SCRATCH;case a.HUNTING_CONTEST:return game.SAE.HUNTING_CONTEST;case a.DAYORWEEK:return game.SAE.DAYORWEEK_ALL;case a.ONEYUANBUY:return game.SAE.ONE_YUAN_ALERT;case a.NEWFIRSTCHARGE:return game.SAE.NEW_FIRST_CHARGE;case a.NEW_COMPETITION:return game.SAE.OPEN_COMPETITION_ALERT_NEW;case a.WELFARETARGET:return game.SAE.WELFARE_TARGET_ALERT;case a.PARTNER_BACK:return game.SAE.PARTNER_BACK;case a.REBORN:return game.SAE.REBORN;case a.DAILY_WISH:return game.SAE.DAILYWISH;case a.LIMIT_EXCHANGE:return game.SAE.EXCHANGE;case a.LIMIT_SALE_PRIZE:return game.SAE.LIMIT_SALE_PRIZE;case a.OPTIONAL_LOTTERY:return game.SAE.OPTION_LOTTERY_PIONT;case a.MIBAO:return game.SAE.MIBAO;case a.QQVIDEO:return game.SAE.QQVIDEO;case a.QM_STAR_1:return game.SAE.QM_STAR_1;case a.QM_STAR_2:return game.SAE.QM_STAR_2}return 0},getCountDown:function(e){var t=0,a=this.getData(e);if(!a){return t}if(0<a.checkOpenEnum&&!game.moduleOpen.checkOpen(a.checkOpenEnum)){return t}var i=a.activeBarType,n=game.ActiveBarItemType;switch(i){case n.SALE_RECHARGE:t=game.saleRechargeData.getCountDown();break;case n.CHOOSE_RECHARGE:t=game.manyFirstChargeData.getCountDown();break;case n.ONLINEGIFT:return!1;case n.ACTIVE_NOTICE:e=parseInt(a.id);t=game.mainActivityNoticeBarData.getCountdown(e,1);break;case n.ACCUMULATIVE_RECHARGE:t=game.accumulativeRechargeData.getEndTime();break;case n.ACC_COST:t=game.accCostData.getCountdown();break;case n.TIME_LIMIT_GIFT:t=game.timeLimitPrizeData.getCountdown();break;case n.INVESTMENT:t=game.investData.getCountdown();break;case n.FUND:t=game.welfareData.getFundCountdown();break;case n.DIANWEI:t=game.dwData.getCountdown();break;case n.PARTNER_GIFT:t=game.partnerGiftData.getCountdown();break;case n.DISCOUNT_RECHARGE:case n.TODAY_DISCOUNT_RECHARGE:t=game.rechargeData.getDiscountRechargeCountdown();break;case n.DAILY_RECHARGE:t=game.rechargeData.getDailyRechargeCountdown();break;case n.QUEST_LINK:t=game.verifyAwardData.getLinkCountDown();break;case n.PUSH_PRIZE_RECHARGE:t=game.pushPrizeData.getCountdown();break;case n.MONEY_CAT:t=game.moneyCatData.getCountDown();break;case n.HUNTING_CONTEST:t=game.huntingContestData.getCountDown();break;case n.ONEYUANBUY:t=game.oneYuanBuyData.getCountDown();break;case n.MIBAO:t=game.mibaoData.getCountDown()}return t},getLabString:function(e){var t="",a=this.getData(e);if(!a){return t}var i=a.activeBarType,n=game.ActiveBarItemType;if(0<a.checkOpenEnum&&!game.moduleOpen.checkOpen(a.checkOpenEnum))return i==n.ACTIVE_NOTICE&&(t=this.getTomorrowNotice(a)),t;switch(i=a.activeBarType){case(n=game.ActiveBarItemType).ACTIVE_NOTICE:e=parseInt(a.id);t=game.mainActivityNoticeBarData.getData(e).tips;break;case n.FUNC_NOTICE:var s=game.miscData.openServerDay;t=game.funcNoticeData.getNoticeStr(s);break;case n.TODAY_FUNC_NOTICE:t=a.tips;case n.LOGINAWARDS:t=game.loginAwardsData.getStr()}return t},getTomorrowNotice:function(e){var t="";if(2<game.miscData.openServerDay)return t;var a=b8e.TimeUtil.getDay(game.SysTime.curTime),i=0!=a?a+1:1,n=e.weektime;return n&&-1<n.indexOf(i)&&(t=game.Lang.get(9e3)),t},getActStartTime:function(e){var t=0,a=this.getData(e);if(!a){return t}if(0<a.checkOpenEnum&&!game.moduleOpen.checkOpen(a.checkOpenEnum)){return t}switch(a.activeBarType){case game.ActiveBarItemType.ACTIVE_NOTICE:e=parseInt(a.id);t=game.mainActivityNoticeBarData.getCountdown(e,2)}return t}}),b8e.RC("$$game","$$GameMenuBarData",e)}(),function(){var e=b8e.Object.extends({yuanbao:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.YUAN_BAO)}},bindYuanbao:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.BIND_YUAN_BAO)}},silver:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.SILVER)}},military:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.MILITARY)}},wuxun:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.WU_XUN)}},vipExp:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.VIP_EXP)}},prestige:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.PRESTIGE)}},friendshipPoint:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.FRIENDSHIP_POINT)}},worldFirstScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.WORLD_FIRST_SCORE)}},kingScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.KING_SCORE)}},xunBaoScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.XUNBAO_SCORE)}},transferExp:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.TRANSFER_EXP)}},adb:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.ADB)}},mysteryScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.MYSTERY_SCORE)}},zcScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.ZC_SCORE)}},jsScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.JS_SCORE)}},gsScore:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.GS_SCORE)}},zhaoqin:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.ZHAOQIN)}},rebate:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.REBATE)}},keji:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.KEJI_DIAN)}},warrior:{get:function(){return b8e.warn("\u8bf7\u4f7f\u7528get\u63a5\u53e3"),this.get(game.AmountType.WARRIOR)}},ctor:function(){this._super(),this.amountMap=b8e.HashMap.get()},setAmount:function(e){this.amountMap.set(e.type,e.curNum)},getAmountById:function(e){var t=game.ItemInfoCfg.getData(e);if(!t){return b8e.warn("\u4e0d\u5b58\u5728id\u914d\u7f6e:"+e),0}if(t.cfgType==game.ItemCfgType.Amount)return this.get(t.type);return b8e.warn("\u4e0d\u5b58\u5728id\u5bf9\u5e94\u7684\u8d27\u5e01\uff0cid:"+e),0},getAmountByType:function(e){return b8e.warn("amount getAmountByType\u63a5\u53e3\u5df2\u5f03\u7f6e\uff0c\u8bf7\u4f7f\u7528get\u63a5\u53e3",e),this.get(e)},get:function(e){var t=this.amountMap.get(e);return isNaN(t)?(this.amountMap.set(e,0),0):t},getCfgByType:function(e){var t=game.AmountCfg.getItemId(e);if(t)return game.ItemInfoCfg.getData(t);return b8e.warn("\u6ca1\u6709\u4e0e\u4f20\u5165\u7c7b\u578b\u5bf9\u5e94\u7684\u9053\u5177id,type:",e),null},getAmountTypeById:function(e){var t=game.ItemInfoCfg.getData(e);if(t)return t.type;return b8e.warn("\u4f20\u5165\u4e86\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684id\u9053\u5177"+e),game.AmountType.None},getCfgById:function(e){var t=this.getAmountTypeById(e);return t?this.getCfgByType(t):null},changeAmount:function(e,t,a){var i=!(2<arguments.length&&void 0!==a)||a,n=this.get(e);n=n||0,i?n+=t:n-=t,this.amountMap&&this.amountMap.set(e,n)}});game.amount=game.amount||new e}(),function(){var e;e=b8e.Enum({None:0,YUAN_BAO:1,BIND_YUAN_BAO:2,SILVER:3,MILITARY:4,WU_XUN:5,VIP_EXP:6,PRESTIGE:7,FRIENDSHIP_POINT:8,WORLD_FIRST_SCORE:9,KING_SCORE:10,XUNBAO_SCORE:11,ADB:13,MYSTERY_SCORE:14,ZC_SCORE:15,JS_SCORE:16,GS_SCORE:17,ZHAOQIN:18,REBATE:19,OB:21,OVERLORD:22,FLAGWAR:23,TP_SCORE:24,CATCH_SCORE:25,KEJI_DIAN:27,WARRIOR:28,EXP:555}),b8e.RC("$$game","$$AmountType",e)}(),function(){var e;e=b8e.Object.extends({_itemIdsMap:null,_itemIdxMap:null,ctor:function(){this._super(),this._itemIdsMap=b8e.HashMap.get(),this._itemIdxMap=b8e.HashMap.get()},addItem:function(){},removeItem:function(e){var t=!1,a=this._itemIdsMap.get(e.id);if(a&&0<a.length){var i,n=0,s=a.length;for(n=0;n<s;n++){if((i=a[n])&&i.id==e.id&&i.idx==e.idx){a.splice(n,1),t=!0}}}if(this._itemIdxMap.has(e.idx)){this._itemIdxMap.del(e.idx)}if(this.infoPool&&i&&t){this.infoPool.put(i)}},removeItemByIdx:function(e){var t=this._itemIdxMap.get(e);if(t){this.removeItem(t)}},getItemById:function(e){var t=this._itemIdsMap.get(e);if(t&&0<t.length){return t[0]}return null},getItemByIdx:function(e){var t=this._itemIdxMap.get(e);if(t){return t}return null},getItemIdByIdx:function(e){var t=this.getItemByIdx(e);return t?t.id:0},getItemList:function(){return this._itemIdxMap&&0<this._itemIdxMap.count()?this._itemIdxMap.values():null},change:function(e,t,a){var i,n=!(2<arguments.length&&void 0!==a)||a;if(i=this._itemIdxMap.get(e))if(n){i.num+=t}else i.num-=t,i.num<=0&&this.removeItemByIdx(e);else;},getIdxCount:function(){return this._itemIdxMap.count()},getItemListById:function(e){var t=this._itemIdsMap.get(e);if(t&&0<t.length){return t}return null},getNumById:function(e){var t=0,a=this._itemIdsMap.get(e);if(a&&0<a.length)for(var i,n=0,s=a.length;n<s;n++){if(i=a[n]){t+=i.num}}return t}}),b8e.RC("$$game","$$BaseItemData",e)}(),function(){var e;e=b8e.PoolObject.extends({idx:0,id:0,num:0,iconSize:105,tagId:0,ctor:function(){this._super()},setData:function(e){this.idx=e.idx,this.id=e.id,this.num=e.num}}),b8e.RC("$$game","$$BaseItemInfo",e)}(),function(){var t=void 0;t=game.BaseItemInfo.extends({lv:0,star:0,totalFight:0,sortId:0,select:!1,quality:0,baseSpriteStat:{get:function(){return this._baseSpriteStat||(this._baseSpriteStat=game.SpriteStat.get()),this._baseSpriteStat}},intensifySpriteStat:{get:function(){return this._intensifySpriteStat||(this._intensifySpriteStat=game.SpriteStat.get()),this._intensifySpriteStat}},upstarSpriteStat:{get:function(){return this._upstarSpriteStat||(this._upstarSpriteStat=game.SpriteStat.get()),this._upstarSpriteStat}},refineSpriteStat:{get:function(){return this._refineSpriteStat||(this._refineSpriteStat=game.SpriteStat.get()),this._refineSpriteStat}},allSpriteStat:{get:function(){return this._allSpriteStat||(this._allSpriteStat=game.SpriteStat.get()),this._allSpriteStat}},tempSpriteStat:{get:function(){return this._tempSpriteStat||(this._tempSpriteStat=game.SpriteStat.get()),this._tempSpriteStat}},ctor:function(){this._super()},setFosterData:function(e,t){this.slot=e.slot,this.fosterId=t,this.setData(e.equip)},wearEquip:function(e,t,a){this.fosterId=t,this.slot=a,this.setData(e)},setData:function(e){var t=this;t._super(e);var a=t.getCfg();if(a)if(t.quality=a.quality,t.sortId=a.sortId,t.fosterType=game.fosterEquipData.getFosterTypeToEquipType(a.types),t.pos=a.pos,t.baseSpriteStat.setupByCfg(a),e.equip){var i=e.equip;t.lv=i.fosterEquipLv,t.star=i.fosterEquipStar;var n=t.fosterEquipAttrs=i.fosterEquipAttrs,s=t.getQhCfg();if(s&&(t.intensifySpriteStat.clear(),t.intensifySpriteStat.addByCfg(s,!0,t.lv)),0<t.star){var o=game.FosterEquipStarfg.getData(t.id,t.star);o&&t.upstarSpriteStat.setupByCfg(o)}else t.upstarSpriteStat.clear();t.clearRefineAttrs(),t.setRefineInfoList(n),t.setAllSpriteStat()}else t.setAllSpriteStat()},setLv:function(e){this.lv=e;var t=this.getQhCfg();t&&(this.intensifySpriteStat.clear(),this.intensifySpriteStat.addByCfg(t,!0,this.lv)),this.setAllSpriteStat()},getCfg:function(){var e=game.ItemInfoCfg.getData(this.id);return e||null},getRefineInfoList:function(){return this.refineAttrs&&this.refineAttrs.length,this.refineAttrs},setRefineInfoList:function(e){var t=this;if(t.refineAttrs||(t.refineAttrs=[]),!e||e.length<1)return null;var a=void 0,i=void 0,n=void 0,s=e.length;t.refineSpriteStat.clear();for(var o=0;o<s;o++)i=(n=e[o]).attrSlot,a=n.attr,i<1||((t.refineAttrs[i-1]||(t.refineAttrs[i-1]=game.FosterEquipRefineInfo.get())).setData(t.fosterType,t.fosterId,t.slot,t.id,t.star,n),t.refineSpriteStat.addServerStatValue(a.id,a.value));return t.refineAttrs},updateLock:function(e){var t=e.attrSlot;t<1||this.refineAttrs&&this.refineAttrs[t-1]&&this.refineAttrs[t-1].updateLockData(e)},updateWashAttrs:function(e){this.setRefineInfoList(e),this.setAllSpriteStat()},getRefineLockDesc:function(){var e=this.getRefineInfoLockCostCfg();if(!e||!e.costItems||e.costItems.length<1)return"";var t=e.costItems[0],a=t.Id,i=t.Num,n=game.ItemInfoCfg.getData(a);return n?game.Lang.get(53520,e.lock,i,n.name):void 0},getRefineInfoLockCostCfg:function(){var e=this.getRefineInfoList(),t=0;if(e&&0<e.length)for(var a=void 0,i=e.length,n=0;n<i;n++)(a=e[n])&&a.lock&&t++;if(t<1)return null;var s=game.fosterEquipData.getEquipTypeToFosterType(this.fosterType);return game.FosterEquipLockCostCfg.getData(s,t)},setAllSpriteStat:function(){var e=this.allSpriteStat;e.clear(),e.addSpriteStat(this.baseSpriteStat,1,!0,!1),e.addSpriteStat(this.intensifySpriteStat,1,!0,!1),e.addSpriteStat(this.upstarSpriteStat,1,!0,!1),e.addSpriteStat(this.refineSpriteStat,1,!0,!1),this.totalFight=e.getTeamPower()},getCurIntensifySpriteStat:function(){if(this.intensifySpriteStat.getCount()<1){var e=this.getQhCfg();e&&this.intensifySpriteStat.addByCfg(e,!0,0)}return this.intensifySpriteStat},getNextIntensifySpriteStat:function(){var e=this.tempSpriteStat;e.clear();var t=this.getQhCfg();return t&&(e.addSpriteStat(this.intensifySpriteStat),e.addByCfg(t)),e},getCurUpstarSpriteStat:function(){if(this.upstarSpriteStat.getCount()<1){var e=game.fosterEquipData.getUpstarCfg(this.id,1);e&&this.upstarSpriteStat.addByCfg(e,!0,0)}return this.upstarSpriteStat},getNextUpstarSpriteStat:function(){var e=this.tempSpriteStat;e.clear();var t=game.fosterEquipData.getUpstarCfg(this.id,this.star+1);return t&&e.setupByCfg(t),e},getCurRefineSpriteStat:function(){return this.refineSpriteStat},getAllSpriteStat:function(){return this.allSpriteStat},getPower:function(){return this.allSpriteStat.getTeamPower()},getQhCfg:function(){return game.fosterEquipData.getQhCfg(this.id)},getIntensifyCostCfg:function(){return game.fosterEquipData.getIntensifyCostCfg(this.fosterType,this.lv)},getUpstarCfg:function(){return game.fosterEquipData.getUpstarCfg(this.id,this.star)},clearRefineAttrs:function(){var e=this.refineAttrs;if(e&&0<e.length){for(var t=e.length,a=0;a<t;a++)e[a].release();e.length=0}},recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.id=0,e.pos=0,e.idx=0,e.sortId=0,e.fosterType=0,e.select=!1,e.totalFight=0,e.clearRefineAttrs(),e.baseSpriteStat.clear(),e.intensifySpriteStat.clear(),e.upstarSpriteStat.clear(),e.refineSpriteStat.clear(),e.allSpriteStat.clear()}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$FosterEquipInfo",t)}(),function(){var e;e=game.BaseItemInfo.extends({spriteStat:null,titleName:"",power:0}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$FosterSpriteInfo",e)}(),function(){var e;e=b8e.Enum({$$None:0,$$NormalItem:1,$$Equip:2,$$Amount:3,$$EffectItem:4,$$ShowItem:6,$$TreasurePavilion:23,$$PartnerProper:25,$$FosterEquip:26,$$GOD_ANIMAL_EQUIP:27}),b8e.RC("$$game","$$ItemCfgType",e)}(),function(){var e;e=b8e.Enum({None:0,Surface:2,TransferEquip:4,Hunlu:5,HunluCost:6}),b8e.RC("$$game","$$ItemType",e)}(),function(){var e;e=b8e.Enum({$$None:0,$$TYPE_1:1,$$TYPE_2:2,$$TYPE_3:3,$$TYPE_4:4,$$TYPE_5:5,$$TYPE_6:6,$$TYPE_7:7,$$TYPE_8:8}),b8e.RC("$$game","$$ItemFunctionType",e)}(),function(){var e;e=b8e.Enum({GET_ITEM:1,GET_PRIZE:2,EXP:3,RISE:4,F0STER_EXP:5,DAILY_LIMIT:10}),b8e.RC("$$game","$$ItemEffectType",e)}(),function(){var t=void 0;t=game.BaseItemInfo.extends({expireTime:0,idx:0,id:0,num:0,sortId:0,quality:0,isAlert:!1,setData:function(e){this._super(e),this.expireTime=e.expireTime,this.isAlert=!1;var t=game.ItemInfoCfg.getData(this.id);t&&(t.order?this.sortId=t.order:this.sortId=0,this.quality=t.quality)},recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.idx=0,e.num=0,e.sortId=0,e.isAlert=!1}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,1024),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$ItemInfo",t)}(),function(){var e;e=b8e.Object.extends({id:0,num:0,iconLayoutEnum:0,iconSize:0,__renderType:0,setData:function(e,t,a,i,n){var s=2<arguments.length&&void 0!==a?a:3,o=3<arguments.length&&void 0!==i?i:0,r=4<arguments.length&&void 0!==n?n:game.IconSizeEnum.GRID_SIZE_84;this.id=e,this.num=t,this.iconLayoutEnum=s,this.iconSize=r,this.__renderType=o}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PrizeInfo",e)}(),function(){var e;e=b8e.Object.extends({refresh:0,setData:function(e){this.idx=e.idx,this.id=e.id,this.num=e.num,this.iconLayoutEnum=game.IconLayoutEnum.SHOW_ALL,this.refresh++}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$TreasureItemInfo",e)}(),function(){var e=game.BaseItemData.extends({equipMaxCount:200,isChoiceSZ:!0,ctor:function(){var e=this;e._super(),e.godEquipResolveInfoMap=b8e.HashMap.get(),e.readyList=[],e.readyEquipMap=b8e.HashMap.get(),e.fosterAlertMap=b8e.HashMap.get(),e.goldEquipResolveInfoMap=b8e.HashMap.get(),e.posMap=b8e.HashMap.get(),e.warsMap=b8e.HashMap.get(),e.petEquipMap=b8e.HashMap.get(),e.fosterEquipMap=b8e.HashMap.get(),e.godAnimalEquipMap=b8e.HashMap.get()},addItem:function(e){var t=game.ItemUtil.createEquipInfo(e),a=this._itemIdsMap.get(e.id);a?a.push(t):(a=[]).push(t),this._itemIdsMap.set(t.id,a),this._itemIdxMap.set(t.idx,t);var i=game.ItemInfoCfg.getData(e.id);if(!i)return 0;if(i.cfgType==game.ItemCfgType.Equip||i.cfgType==game.ItemCfgType.PartnerProper){var n=game.partnerEquipData,s=n.createInfoById(i.id);if(s.setData(e),n.isInitWearOrNotWearMap()){var o=i.pos,r=n.notWearInfoMap.get(o);r||(r=b8e.HashMap.get(),n.notWearInfoMap.set(o,r)),r.set(e.idx,s)}this.petEquipMap.set(e.idx,s)}if(i.cfgType==game.ItemCfgType.FosterEquip){var g=game.fosterEquipData.createEquipInfo(i,e);this.fosterEquipMap.set(e.idx,g)}if(i.cfgType==game.ItemCfgType.GOD_ANIMAL_EQUIP){var l=game.godAnimalEquipData.getNotWearEquipInfo(i.pos,e);this.godAnimalEquipMap.set(e.idx,l)}},removeItemByIdx:function(e){this._super(e),this.petEquipMap.has(e)&&(game.partnerEquipData.delNotWearEquipByIdx(e),this.petEquipMap.del(e)),this.fosterEquipMap.has(e)&&(game.fosterEquipData.delEquipByIdx(e),this.fosterEquipMap.del(e)),this.godAnimalEquipMap.has(e)&&(game.godAnimalEquipData.delNotWearEquipByIdx(e),this.godAnimalEquipMap.del(e))},removeItem:function(e){if(e){this._super(e);var t=e.idx;this.petEquipMap.has(t)&&(game.partnerEquipData.delNotWearEquipByIdx(t),this.petEquipMap.del(t)),this.fosterEquipMap.has(t)&&(game.fosterEquipData.delEquipByIdx(t),this.fosterEquipMap.del(t)),this.godAnimalEquipMap.has(t)&&(game.godAnimalEquipData.delNotWearEquipByIdx(t),this.godAnimalEquipMap.del(t))}},getGodEquipResolveInfos:function(){return this.godEquipResolveInfoMap.values()},getGodEquipResolveInfoByIdx:function(e){return this.godEquipResolveInfoMap.get(e)},getGodEquipResolveInfosCount:function(){return this.godEquipResolveInfoMap.count()},getWarsList:function(){return this.warsMap.values()},getWarsEquipsByIdx:function(e){return this.warsMap.get(e)},getGoldEquipResolveInfos:function(){var e=this;if(e.goldEquipResolveList)e.goldEquipResolveList.length=0;else{e.goldEquipResolveList=[]}this.posMap.clear();var t=e.goldEquipResolveInfoMap.values();if(t&&0<t.length)for(var a=t.length,i=void 0,n=void 0,s=void 0,o=void 0,r=0;r<a;r++){if(i=t[r],s=game.equipData.getItemByIdx(i.idx))if(n=s.getCfg())if(o=game.shengZhuangSlotData.getSlot(n.pos)){if(o.power<s.power){var g=b8e.CommonUtil.xyToInt(n.pos,n.level),l=e.posMap.get(g);if(!l){e.posMap.set(g,i);continue}if(game.equipData.getItemByIdx(l.idx).power<s.power){e.goldEquipResolveList.push(l),e.posMap.set(g,i);continue}}e.goldEquipResolveList.push(i)}else;else;else;}return e.goldEquipResolveList},getGoldEquipResolveInfoByIdx:function(e){return this.goldEquipResolveInfoMap.get(e)},getGoldEquipResolveInfosCount:function(){return this.goldEquipResolveInfoMap.count()},getGoldEquipAlert:function(){var e=this.getGoldEquipResolveInfos();return e&&0<e.length},getCanWearGodEquip:function(){for(var e,t,a=this.getGodEquipResolveInfos(),i=[],n=0,s=a.length;n<s;n++)(t=i[(e=this.getItemByIdx(a[n].idx)).pos])?e.power>t.power&&(i[e.pos]=e):i[e.pos]=e;return i},getWearGodEquip:function(e){return this.getCanWearGodEquip()[e]},getPetEquipList:function(){return this.petEquipMap.values()},getPetEquipInfoByIdx:function(e){return this.petEquipMap.get(e)},getGodAnimalEquipInfoByIdx:function(e){return this.godAnimalEquipMap.get(e)},getAllGodAnimalEquipList:function(){return this.godAnimalEquipMap.values()},getItemNumById:function(e){var t=0,a=this._itemIdsMap.get(e);return a&&(t=a.length),t},setEquips:function(){},setRoleReadyEquip:function(){var e=this.getItemList();if(e){for(var t,a,i,n=e.length,s=!1,o=game.mainRoleData.lv,r=0;r<n;r++){if(t=e[r],a=game.ItemInfoCfg.getData(t.id)){if(a.cfgType==game.ItemCfgType.Equip&&!(o<a.level)&&a.types!=game.RoleEquipType.SZ){if(!(i=game.equipSlotData.getSlot(a.pos))){s=!0;break}if(s=i.power<a.power){break}}}else{b8e.error("\u7269\u54c1\u7684id\u914d\u7f6e\u4e0d\u5b58\u5728,id:",t.id)}}this.roleEquipReadyAlert=s}else{this.roleEquipReadyAlert=!1}},setSZReadyEquip:function(){var e=this.getItemList();if(!e||e.length<1)this.shengzhuangAlert=!1;else{for(var t=e.length,a=!1,i=game.mainRoleData.lv,n=void 0,s=void 0,o=void 0,r=0;r<t;r++)if(n=e[r],s=game.ItemInfoCfg.getData(n.id)){if(s.cfgType==game.ItemCfgType.Equip&&!(i<s.level)&&s.types==game.RoleEquipType.SZ&&(a=!(o=game.shengZhuangSlotData.getSlot(s.pos))||o.power<s.power))break}else b8e.error("\u7269\u54c1\u7684id\u914d\u7f6e\u4e0d\u5b58\u5728,id:",n.id);this.shengzhuangAlert=a}},getRoleEquipReadyList:function(){this.readyList.length=0,this.readyEquipMap.clear();var e=this.getItemList();if(e){for(var t,a,i,n,s=e.length,o=!1,r=game.mainRoleData.lv,g=0;g<s;g++){if(t=e[g],a=game.ItemInfoCfg.getData(t.id)){if(a.cfgType==game.ItemCfgType.Equip&&!(r<a.level)&&a.types!=game.RoleEquipType.SZ){if(i=this.readyEquipMap.get(a.pos))n=game.ItemInfoCfg.getData(i.id);else{n=game.equipSlotData.getSlot(a.pos)}if(n)o=n.power<a.power;else{o=!0}if(o){this.readyEquipMap.set(a.pos,t)}}}else{b8e.error("\u7269\u54c1\u7684id\u914d\u7f6e\u4e0d\u5b58\u5728,id:",t.id)}}return this.readyEquipMap.forEach(function(e,t){this.readyList.push(t.idx)},this),this.readyList}},getSZReadyList:function(){var a=this;a.readyList.length=0,a.readyEquipMap.clear();var e=a.getItemList();if(e&&!(e.length<1)){for(var t=e.length,i=game.mainRoleData.lv,n=void 0,s=void 0,o=void 0,r=void 0,g=0;g<t;g++)n=e[g],(s=game.ItemInfoCfg.getData(n.id))?s.cfgType==game.ItemCfgType.Equip&&(i<s.level||s.types==game.RoleEquipType.SZ&&(!(r=(o=a.readyEquipMap.get(s.pos))?game.ItemInfoCfg.getData(o.id):game.shengZhuangSlotData.getSlot(s.pos))||r.power<s.power)&&a.readyEquipMap.set(s.pos,n)):b8e.error("\u7269\u54c1\u7684id\u914d\u7f6e\u4e0d\u5b58\u5728,id:",n.id);return a.readyEquipMap.forEach(function(e,t){a.readyList.push(t.idx)},a),a.readyList}},getRoleEquipCanWear:function(){return this.roleEquipReadyAlert},getSZCanWear:function(){return this.shengzhuangAlert},getFosterEquipCanWear:function(e){var t=this.fosterAlertMap.get(e);if(t)return t;return!1},getCfgByQL:function(e,t){var a=game.ShopItemCfg.getGEByLv(t);if(!a)return null;var i=a.itemId;return game.ItemInfoCfg.getData(i)},initGoleEquipMap:function(){if(!this.goldEquipMap){this.goldEquipMap=b8e.HashMap.get();var e=game.ShopItemCfg.getShopList(game.ShopIdEnum.GOLDEQUIP_SHOP);if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=void 0,n=e.length,s=0;s<n;s++)(i=e[s])&&(a=i.itemId,(t=game.ItemInfoCfg.getData(a))&&this.goldEquipMap.set(t.level,t))}},getEquipMaxCount:function(){var e=this.equipMaxCount,t=game.mainRoleData.vipLevel,a=game.VipCfg.getBackAddSlots(t);if(e=this.equipMaxCount+a,game.rechargeData.getCardInfoByType(game.CardType.FOREVER)){e+=game.rechargeData.getCardRechargeCfg(game.CardType.FOREVER).addBagSlot}var i=game.rechargeData.getCardInfoByType(game.CardType.MONTH);if(!i||i.expireTime<game.SysTime.curTime){return e}return e+=game.rechargeData.getCardRechargeCfg(game.CardType.MONTH).addBagSlot},getFosterEquipList:function(){return this.fosterEquipMap.values()},getFosterEquipInfo:function(e){return this.fosterEquipMap.get(e)}});game.equipData=game.equipData||new e}(),function(){var e;(e=b8e.Object.extends({pos:0,forgeType:0,lv:0,setData:function(e,t,a){if(e){this.lv=e.lv}else this.lv=0;this.type=t,this.pos=a}})).poolCall=!0,b8e.RC("$$game","$$EquipForgeInfo",e)}(),function(){var e,t;t=b8e.Enum({NONE:0,INTENSIFY:1,REFINE:2,GEM:3,PURIFY:4,ZHULING:5,FUSE:6,MAX:7}),e=b8e.Enum({NONE:0,INTENSIFY:1,REFINE:2,PURIFY:3}),b8e.RC("$$game","$$EquipForgeType",t),b8e.RC("$$game","$$EquipForgeRpType",e)}(),function(){var e,t=e=game.BaseItemInfo.extends({idx:0,id:0,num:0,power:0,quality:0,equip:null,baiZhanStar:0,isEquip:!0,setData:function(e){this._super(e);var t=e.equip;if(t){if(!this.equip){this.equip={}}if(t.highAttrs){this.equip.highSpriteStat=game.SpriteStatUtil.setDataByServer(t.highAttrs),this.equip.refineRate=t.refineRate}else this.equip.highSpriteStat&&(this.equip.highSpriteStat.release(),this.equip.highSpriteStat=null);if(t.attrNum){this.equip.attrNum=t.attrNum}this.fosterEquipLv=t.fosterEquipLv,this.fosterEquipStar=t.fosterEquipStar}else this.equip&&this.equip.highSpriteStat&&(this.equip.highSpriteStat.release(),this.equip.highSpriteStat=null),this.equip=null;var a=this.getCfg();if(a){this.quality=a.quality,this.baiZhanStar=e.baiZhanStar}this.resetPower()},resetPower:function(){var e=0,t=this.getCfg();if(t){if(t.spriteStat){e+=game.CCommonUtil.getPower(t.spriteStat)}if(this.equip&&this.equip.attrNum){if(t.appendSpriteStat){e+=game.CCommonUtil.getPower(t.appendSpriteStat)*this.equip.attrNum}}if(this.equip&&this.equip.highSpriteStat){e+=game.CCommonUtil.getPower(this.equip.highSpriteStat)}this.pos=t.pos}this.power=e},getCfg:function(){var e=game.ItemInfoCfg.getData(this.id);if(e)return e;return null}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$EquipInfo",e)}(),function(){var e=b8e.Object.extends({equipSlotMap:null,needGoldShard:0,ctor:function(){this._super(),this.equipSlotMap=b8e.HashMap.get()},setup:function(e){if(this.equipSlotMap.clear(),!e&&e.length<1);else for(var t,a,i=0,n=e.length;i<n;i++){t=(a=e[i])&&a.item?game.ItemUtil.createEquipSlotInfo(a.item,a.pos):null,this.equipSlotMap.set(a.pos,t)}},change:function(e){if(e){var t=game.ItemInfoCfg.getData(e.id);if(t&&t.cfgType==game.ItemCfgType.Equip){var a=this.equipSlotMap.get(t.pos);if(a)a.setData(e);else{a=game.ItemUtil.createEquipSlotInfo(e,t.pos)}this.equipSlotMap.set(t.pos,a)}else;}else;},getSlot:function(e){var t=this.equipSlotMap.get(e);if(t){return t}return null},getEquipSlot:function(){return this.equipSlotMap},getEquipSlots:function(){return this.equipSlotMap?this.equipSlotMap.values():null},getEquipSlotPos:function(){return this.equipSlotMap?this.equipSlotMap.keys():null},getCEGoldEquipByPos:function(e){var t=game.shengZhuangSlotData.getSlot(e),a=game.mainRoleData.lv;if(!t)return!1;var i=t.id,n=game.ItemInfoCfg.getData(i);if(!n)return!1;var s=game.ShopItemCfg.getGEMinLv(n.pos);if(!s||a<s)return!1;var o=s+20;if(n.quality>game.Quality.Q_YELLOW||n.quality==game.Quality.Q_YELLOW&&a<o)return!1;var r=s;n.quality==game.Quality.Q_YELLOW&&(r=o);for(var g=void 0,l=void 0,c=void 0,h=game.Quality.Q_YELLOW,m=Math.floor((a-s)/20)+1,u=Math.floor((r-s)/20);u<m&&(g=20*u+s,!(l=game.equipData.getCfgByQL(h,g))||l.power<=n.power||!(c=game.ShopItemCfg.getEGECfg(l.id)));u++);if(!c)return!1;if(!game.shopData.getIsCanBuy(c.goodsId))return!1;var d=c.costItems;if(d&&0<d.length){var f=d[0].Num;(f&&f<this.needGoldShard||0==this.needGoldShard)&&(this.needGoldShard=f)}return game.UpgradeUtil.checkItemList(c.costItems,1,!1)}});game.equipSlotData=game.equipSlotData||new e}(),function(){var e;e=game.EquipInfo.extends({power:0,ctor:function(e){this._super(),this.pos=e},setData:function(e){this._super(e);var t=0;if(e.equip);if(this._cfg=game.ItemInfoCfg.getData(this.id),this._cfg&&this._cfg.spriteStat){t+=game.CCommonUtil.getPower(this._cfg.spriteStat)}if(this.equip&&this.equip.highSpriteStat){t+=game.CCommonUtil.getPower(this.equip.highSpriteStat)}this.power=t}}),b8e.BindingUtil.bind(game.EquipInfo),b8e.RC("$$game","$$EquipSlotInfo",e)}(),function(){var e;e=b8e.Enum({NORMAL:0,SZ:1}),b8e.RC("$$game","$$RoleEquipType",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.equipSlotMap=b8e.HashMap.get()},setup:function(e){if(this.equipSlotMap.clear(),e||!(e.length<1)){for(var t=void 0,a=void 0,i=0,n=e.length;i<n;i++)t=(a=e[i])&&a.shengZhuang?game.ItemUtil.createSZSlotInfo(a.shengZhuang,a.pos):null,this.equipSlotMap.set(a.pos,t);this.updateCurSuitCfg()}},change:function(e){if(e){var t=game.ItemInfoCfg.getData(e.id);if(t&&t.cfgType==game.ItemCfgType.Equip&&t.types==game.RoleEquipType.SZ){var a=this.equipSlotMap.get(t.pos);a?a.setData(e):a=game.ItemUtil.createSZSlotInfo(e,t.pos),this.equipSlotMap.set(t.pos,a)}}},getSlot:function(e){var t=this.equipSlotMap.get(e);return t||null},getEquipSlot:function(){return this.equipSlotMap},getEquipSlots:function(){return this.equipSlotMap?this.equipSlotMap.values():null},getEquipSlotPos:function(){return this.equipSlotMap?this.equipSlotMap.keys():null},updateCurSuitCfg:function(){var e=game.ShengZhuangExpertCfg.getDatas();if(e&&!(e.length<1)){for(var t=void 0,a=0,i=e.length-1;0<=i;i--)if(t=e[i],this._updateCurSuitCfg(t)){a=t.id;break}this.isActiveSuit=!!a,this.suitCfg=a?game.ShengZhuangExpertCfg.getData(a):e[0]}},_updateCurSuitCfg:function(e){var t=this.getEquipSlots();if(t&&!(t.length<1)){for(var a=0,i=t.length,n=game.Quality.Q_YELLOW,s=e.level,o=e.number,r=void 0,g=0;g<i;g++)!(r=t[g])||!r._cfg||r._cfg.quality<n||r._cfg.level>=s&&a++;return o<=a}},getCurSZSuitCfg:function(){return this.suitCfg},getGoldShopCfg:function(e){var t=this.getSlot(e),a=game.mainRoleData.lv;if(t){var i=t.id,n=game.ItemInfoCfg.getData(i);if(!n)return null;var s=game.ShopItemCfg.getGEMinLv(n.pos);if(!s||a<s)return null;var o=s+20,r=game.Quality;if(n.quality>r.Q_YELLOW||n.quality==r.Q_YELLOW&&a<o)return null;for(var g=n.quality==r.Q_YELLOW?o:s,l=void 0,c=void 0,h=void 0,m=!1,u=r.Q_YELLOW,d=Math.floor((a-s)/20),f=Math.floor((g-s)/20),p=d;f<=p&&(l=20*p+s,!(c=game.equipData.getCfgByQL(u,l))||c.power<=n.power||!(h=game.ShopItemCfg.getEGECfg(c.id))||!game.shopData.getIsCanBuy(h.goodsId)||!(m=game.UpgradeUtil.checkItemList(h.costItems,1,!1)));p--);return c&&h&&m?h:null}return null}});game.shengZhuangSlotData=game.shengZhuangSlotData||new e}(),function(){var e;e=game.EquipInfo.extends({power:0,ctor:function(e){this._super(),this.pos=e},setData:function(e){this._super(e),this._cfg=game.ItemInfoCfg.getData(this.id)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ShengZhuangSlotInfo",e)}(),function(){var e;game.SAE=e=b8e.Enum({$$FIGHT:1e3,$$HOME:1001,$$ROLE:1002,$$BACK_PACK:1003,$$BACK_PACK_GOODS:1004,$$BACK_PACK_EQUIP:1005,$$EQUIP:1006,$$MAIL:1007,$$UPGRAD_ROLESKILL:1008,$$UPGRAD_ALLROLESKILL:1009,$$EQUIP_INTENSIFY:1010,$$EQUIP_ZHULING:1011,$$EQUIP_FUSE:1012,$$EQUIP_REFINE:1013,$$EQUIP_PURIFY:1014,$$EQUIP_GEM:1015,$$EQUIP_FORGE:1016,$$HUAN_XING_ALERT:1017,$$DAILY_ALERT:1018,$$DANGKOU_ALERT:1019,$$DAILY_FULI:1020,$$VIP_ALERT:1021,$$RELATION:1022,$$INSTFUNC:1023,$$INST_MAT:1024,$$BAO_ZANG:1025,$$FIGHT_MARRY:1026,$$INSTFUNC_HALL:1027,$$BAO_ZANG_TAG:1028,$$ZHAOQIN_TAG:1029,$$HUNTING_TAG:1030,$$BAO_ZANGFIGHT:1031,$$ZHANJIANG:1032,$$ZHAOQIN_FIGHT:1033,$$HUNTING_FIGHT:1034,$$ZHANJIANG_AWARD:1035,$$BOSS:1036,$$BOSS_PER:1037,$$BOSS_PUB:1038,$$BOSS_WORLDWAR:1039,$$BOSS_WILD:1040,$$BOSS_GEN:1041,$$SELL:1042,$$CS_TEAM_ALERT:1043,$$CS_TEAM_DOUBLE_ALERT:1044,$$CS_ARROW:1045,$$CS_ALERT:1046,$$BOSS_WORLDWAR2:1047,$$SURFACE:1048,$$NICKNAME_PAGE:1049,$$FASHION_PAGE:1050,$$MOUNT_PAGE:1051,$$WING_PAGE:1052,$$WEAPON_PAGE:1053,$$NICKNAME:1054,$$FASHION:1055,$$MOUNT:1056,$$WING:1057,$$WEAPON:1058,$$PET:1059,$$PET_UPGRADE_TAB:1060,$$PET_CUR_BATTLE:1061,$$PET_CUR_UPGRADE:1062,$$PET_CUR_ADVANCE:1063,$$PET_CUR_ACTIVE:1064,$$PET_CUR_FLY:1065,$$PET_BATTLE:1066,$$PET_UPGRADE:1067,$$PET_ADVANCE:1068,$$PET_ACTIVE:1069,$$PET_FLY:1070,$$PET_FLY_RECY:1071,$$PET_BZ:1072,$$PET_SKILL_TAB:1073,$$SHOP_ALERT_1:1074,$$SHOP_ALERT_2:1075,$$SHOP_ALERT_3:1076,$$SHOP_ALERT_4:1077,$$CHAT_PRIVATE:1078,$$PEACH_GARDEN:1079,$$GODEQUIP:1080,$$GODEQUIP_UPGRADE:1081,$$GODEQUIP_WASH:1082,$$GODEQUIP_QUENCHING:1083,$$ESCORT:1084,$$ESCORT_LOG:1085,$$WORLD_MAP_ALERT:1086,$$DAILY_EXPLOIT:1087,$$DAILY_OFFICIAL:1088,$$WEEKLY_TASK:1089,$$FIRST_RECHARGE_MAIN_ALERT:1090,$$FIRST_RECHARGE_ALERT:1091,$$DISCOUNT_RECHARGE_ALERT:1092,$$DAILY_RECHARGE_ALERT:1093,$$MASTER:1094,$$MASTER_TASK:1095,$$MASTER_APPRENTICE:1096,$$APPRENTICE_ALERT:1097,$$HOUSE_ADV_ALERT:1098,$$GUILD:1099,$$GUILD_MAP:1100,$$GUILD_COLLECT_GET_PRIZE:1101,$$GUILD_MONSTER_GET_PRIZE:1102,$$GUILD_EXCHANGE:1103,$$FUND_ALERT:1104,$$MONTH_CARD_ALERT:1105,$$WEEK_CARD_ALERT:1106,$$WELFARE_ALERT:1107,$$MONEY_TREE:1108,$$TREASURE_ALERT:1109,$$INVEST_ALERT:1110,$$DIANWEI_ALERT:1111,$$ACTIVITIES_HALL:1112,$$GUILD_HALL:1113,$$GUILD_APPLY:1114,$$GUILD_DONATE:1115,$$GUILD_INCENSE:1116,$$GUILD_TEAM:1117,$$GUILD_SKILL:1118,$$LEVEL_PRIZE:1119,$$ACTIVE_LEVEL_UP:1120,$$QUANMIN_CHONGJI:1121,$$QUANMIN_JINJIE:1122,$$OPEN_SERVER_ALERT:1123,$$SIGNIN_PRIZE:1124,$$LOGIN_PRIZE:1125,$$ACTIVATION_CODE:1126,$$PURCHASE_ALERT:1127,$$ACCUMULATED_RECHARGE_ALERT:1128,$$DAILY_SIGN:1129,$$EXAM:1130,$$ARENA:1131,$$CSARENA:1132,$$CSARENA_COUNT:1133,$$CSARENA_AWARD:1134,$$CSARENA_SCORE:1135,$$CSARENA_RANK:1136,$$ARENA_AWARD:1137,$$TURNPLATE:1138,$$TREASURE:1139,$$TREASURE_SHOP:1140,$$TREASURE_SCORE:1141,$$LUCKY_TURNPLATE:1142,$$GUILD_BOSS:1143,$$PVE_MAININS:1144,$$PVE_XIANDI:1145,$$PVE_MATERIAL:1146,$$PVE_ARENA:1147,$$PVE_ZHANJIANG:1148,$$PVE_XIANDISTAR:1149,$$PVE_ZHAOQIN:1150,$$PVE_XIANLV:1151,$$PVE_FORGEUPGRADE:1152,$$PVE_FORGEREFINE:1153,$$PVE_FORGEPURIFY:1154,$$PVE_FORGEGEM:1155,$$PVE_PET:1156,$$PVE_JIANGHUN:1157,$$PVE_GUOSHI:1158,$$PVE_WANSHOU:1159,$$PVE_CBP:1160,$$MERGE_PVE_MAININS:1161,$$MERGE_PVE_XIANDI:1162,$$MERGE_PVE_MATERIAL:1163,$$MERGE_PVE_ARENA:1164,$$MERGE_PVE_ZHANJIANG:1165,$$MERGE_PVE_XIANDISTAR:1166,$$MERGE_PVE_ZHAOQIN:1167,$$MERGE_PVE_XIANLV:1168,$$MERGE_PVE_FORGEUPGRADE:1169,$$MERGE_PVE_FORGEREFINE:1170,$$MERGE_PVE_FORGEPURIFY:1171,$$MERGE_PVE_FORGEGEM:1172,$$MERGE_PVE_PET:1173,$$MERGE_PVE_JIANGHUN:1174,$$MERGE_PVE_GUOSHI:1175,$$MERGE_PVE_WANSHOU:1176,$$MERGE_PVE_CBP:1177,$$ROLE_EQUIP:1178,$$TAO_FA_ALERT:1179,$$TAO_FA_ALERT_AWARD:1180,$$TAO_FA_KILL_ALERT:1181,$$SHOP_PERSONAL:1182,$$SHOP_PUBLIC:1183,$$SHOP_WORLDWAR:1184,$$SHOP_MATERIAL:1185,$$SHOP_ZHANJIANG:1186,$$SHOP_ARENA:1187,$$SHOP_ARENA_WELFARE:1188,$$SHOP_GUILD:1189,$$SHOP_RELATION:1190,$$SHOP_GENERAL:1191,$$SHOP_CSWAR:1192,$$SHOP_GUANDU:1193,$$SHOP_CSGUILDBOSS:1194,$$SHOP_CSARROW:1195,$$SHOP_WORLDWAR2:1196,$$CS_BOSS:1197,$$EXP_ALERT:1198,$$GUILD_ACTIVE_PAGE:1199,$$GUILD_DAILY_ACTIVE:1200,$$GUILD_ACTIVE:1201,$$GUILD_ACTIVE_UPGRADE:1202,$$MANY_FIRST_CHARGE:1203,$$GOLD_EQUIP_RESOLVE:1204,$$CS_ACTIVITY_ALERT:1205,$$CS_WAR_ALERT:1206,$$CS_WAR_LOG_ALERT:1207,$$CS_WAR_RANK_ALERT:1208,$$NORMAL_ACTIVITY_ALERT:1209,$$WAR_BOOK:1210,$$WAR_BOOK_BASE:1211,$$FREE_GIFT:1212,$$PET_TURNPLATE:1213,$$YONGZHE_WELFARE:1214,$$ACHIEVE_ALERT_BASE:1215,$$ACHIEVE_ALERT:1216,$$SHARE_ALERT:1217,$$FESTIVAL:1218,$$ACCUMULATIVERECHARGE_ALERT:1219,$$ACCUMULATIVERECHARGE_PAGE_ALERT:1220,$$NEWYEARDISCOUNTMALL:1221,$$NEWYEARSALEMALL:1222,$$NEWYEARMYSTERYMALL:1223,$$MILITARY_ALERT:1224,$$RECHARGE_RANK:1225,$$CONSUMPTION_RANK:1226,$$VERIFY_NAME_ALERT:1227,$$VERIFY_VIPCN_ALERT:1228,$$VERIFY_WEIDUAN_ALERT:1229,$$VERIFY_COLLECTION_ALERT:1230,$$VERIFY_ADD_SHORTCUT_ALERT:1231,$$VERIFY_QQ_VIP_PRIVILEGE_ALERT:1232,$$VERIFY_QQ_VIP_DAILY_ALERT:1233,$$VERIFY_COLOR_TICKET_ALERT:1234,$$THRONE_ALERT:1235,$$GUANDU_ALERT:1236,$$FESTIVAL_BOSS:1237,$$NEWYEAREXCHANGE_ALERT:1238,$$NEWYEARKEEP_ALERT:1239,$$NEWYEARKEEP_ALERT2:1240,$$NEWYEARKEEP_ALERT3:1241,$$NEWYEARACCU_ALERT:1242,$$NEWYEARACCU_ALERT2:1243,$$NEWYEARACCU_ALERT3:1244,$$YEAR_COST:1245,$$YEAR_COST2:1246,$$YEAR_COST3:1247,$$YEAR_TASK:1248,$$DRAWLOT:1249,$$NEWYEAR_SIGNIN:1250,$$CON_RECHARGE_ALERT:1251,$$CON_RECHARGE1_ALERT:1252,$$CON_RECHARGE2_ALERT:1253,$$PROGRESS_GOAL_ALERT:1254,$$PROGRESS_GOAL_TASK_ALERT:1255,$$PROGRESS_GOAL_AWARD_ALERT:1256,$$EXCHANGE_GOLD_EQUIP:1257,$$HUNTING_ALERT:1258,$$ACC_COST_ALERT:1259,$$FIGHT_PET_REBATE:1260,$$GOD_ARMY_REBATE:1261,$$GUO_SHI_REBATE:1262,$$ONLINE_GIFT:1263,$$CHALLENGE:1264,$$CHALLENGE_CBP:1265,$$CHALLENGE_CBP_BOX:1266,$$CHALLENGE_CBP_TEAM:1267,$$WUSHEN_MAIN_ALERT:1268,$$LUCKY_ALERT_1:1269,$$LUCKY_ALERT_2:1270,$$LUCKY_ALERT_3:1271,$$LUCKY_ALERT_4:1272,$$LUCKY_ALERT_5:1273,$$LUCKY_ALERT_6:1274,$$LUCKY_ALERT_7:1275,$$LUCKY_ALERT_8:1276,$$LUCKY_ALERT_9:1277,$$LUCKY_ALERT_10:1278,$$LUCKY_ALERT_11:1279,$$LUCKY_ALERT_12:1280,$$LUCKY_ALERT_13:1281,$$LUCKY_ALERT_14:1282,$$LUCKY_ALERT_15:1283,$$LUCKY_ALERT_16:1284,$$LUCKY_ALERT_17:1285,$$LUCKY_ALERT_18:1286,$$LUCKY_ALERT_19:1287,$$LUCKY_ALERT_20:1288,$$LUCKY_ALERT_21:1289,$$LUCKY_ALERT_22:1290,$$LUCKY_ALERT_23:1291,$$LUCKY_ALERT_24:1292,$$LUCKY_ALERT_25:1293,$$LUCKY_ALERT_26:1294,$$LUCKY_ALERT_27:1295,$$LUCKY_ALERT_28:1296,$$LUCKY_ALERT_29:1297,$$LUCKY_ALERT_30:1298,$$SHINV_ADV_ALERT:1299,$$AUCTION_ALLSER:1300,$$AUCTION_CORPS:1301,$$CS_GUILD:1302,$$GUOSHI_CHALLENGE:1303,$$FIGHTPOS_NOTICE_ALERT:1304,$$FIGHTPOS_NOTICE_CUR_ALERT:1305,$$GOOD_GIFT_ALERT:1306,$$SPECIAL_GIFT_ALERT_1:1307,$$SPECIAL_GIFT_ALERT_2:1308,$$SPECIAL_GIFT_ALERT_3:1309,$$SINGLE_RECHARGE_ALERT:1310,$$TOTAL_RECHARGE_ALERT:1311,$$TT_ACC_COST2_ALERT:1312,$$STRONGER_ALERT:1313,$$ACC_CON_CARNIVAL_ALERT:1314,$$ACC_COST2_ALERT:1315,$$CON_RECHARGE_ACC_1:1316,$$CON_RECHARGE_ACC_2:1317,$$WORLD_CHALLENGE:1318,$$GROW_GIFT_ALERT:1319,$$GROW_GIFT_PAGE_ALERT:1320,$$DAILY_GIFT_ALERT:1321,$$MYSTERY2_SHOP_ALERT:1322,$$MYSTERY2_SHOP_PAGE_ALERT:1323,$$MYSTERY2_SCORE_SHOP_ALERT:1324,$$ALL_SERVER_WAR:1325,$$RECYCLE_SURFACE1_ALERT:1326,$$RECYCLE_SURFACE2_ALERT:1327,$$RECYCLE_SURFACE3_ALERT:1328,$$RECYCLE_SURFACE4_ALERT:1329,$$RECYCLE_SURFACE5_ALERT:1330,$$RECYCLE_SURFACE6_ALERT:1331,$$RECYCLE_SURFACE7_ALERT:1332,$$MYSTERY2_SHOP2_ALERT:1333,$$MERGE_SERVER_ALERT:1334,$$ARENA_ALERT:1335,$$MERGELOGIN_ALERT:1336,$$MERGE_TURNPLATE_ALERT:1337,$$MERGE_FREE_GIFT:1338,$$MERGE_CON_RECHARGE_ALERT:1339,$$MERGE_ACC_COST_ALERT:1340,$$MERGE_TOTAL_RECHARGE:1341,$$MARRY_MISSION_ALERT:1342,$$GUILD_MISSION_ALERT:1343,$$PUZZLE:1344,$$PUZZLE_ACTIVE_CHIP:1345,$$PUZZLE_TASK:1346,$$MILLIONS_LOGIN:1347,$$FA_ZHEN_REBATE:1348,$$SMASH_GOLD_EGG:1349,$$SMASH_GOLD_EGG_SMASH:1350,$$REBITRH_FIGHT:1351,$$REBITRH_AWARD:1352,$$QQ_VIP_GIFT:1353,$$MK_TURNPLATE:1354,$$PET_WASH_REBATE:1355,$$MONOPOLY:1356,$$XINYUE:1357,$$CS_TREASURE_ALERT:1358,$$VIP_WELFARE_ALERT:1359,$$QQ_VIP_LOGIN_ALERT:1360,$$DIG_ALERT:1361,$$DIG_BTN_ALERT_1:1362,$$DIG_BTN_ALERT_10:1363,$$DIG_PRIZE_ALERT:1364,$$SUPER_VIP:1365,$$BIND_MOBILE:1366,$$BING_FU:1367,$$FESTIVAL_SINGLERecharge:1368,$$MILITARYARRAY_REBATE:1369,$$MILITARYARRAY_LV:1370,$$MILITARYARRAY_LV_ALERT:1371,$$MILITARYARRAY_FLAG_ALERT:1372,$$MILITARYARRAY_MAP_ALERT:1373,$$MILITARYARRAY_TURNPLATE:1374,$$MILITARYARRAY_LV_CUR_FLAG:1375,$$MILITARYARRAY_LV_CUR_MAP:1376,$$MILITARYARRAY_LV_CUR_BATTLE:1377,$$MILITARYARRAY_LV_CUR_ADV:1378,$$MILITARYARRAY_LV_CUR_ACTIVE:1379,$$MILITARYARRAY_FLAG_CUR_ADV:1380,$$MILITARYARRAY_FLAG_CUR_BREAK:1381,$$MILITARYARRAY_MAP_CUR_ADV:1382,$$CULTURE_GIFT:1383,$$MEDAL_ALERT:1384,$$MYSTERY2_SHOP3_ALERT:1385,$$MYSTERY2_SHOP4_ALERT:1386,$$SHOP_TEAMLEAGUE:1387,$$SHOP_TEAMLEAGUE_MATCH:1388,$$TEAMLEAGUE:1389,$$TEAMLEAGUE_HALL:1390,$$TEAMLEAGUE_APPLY:1391,$$TEAMLEAGUE_MATCH:1392,$$TEAMLEAGUE_MATCH_CHALLENGE:1393,$$TEAMLEAGUE_MATCH_BET:1394,$$TEAMLEAGUE_SET_TEAM:1395,$$TEAMLEAGUE_ASSIST:1396,$$TEAMLEAGUE_ASSISTREW:1397,$$TEAMLEAGUE_ASSIST_MAIN:1398,$$SPECIAL_OFFER:1399,$$GE_DUANHUN:1400,$$GE_FUHUN:1401,$$GE_JINGCUI:1402,$$CSOVERLORD_MATCH:1403,$$CSOVERLORD_WORSHIP:1404,$$CSOVERLORD_MATCH_APPLY:1405,$$CSOVERLORD_MATCH_BET:1406,$$CSOVERLORD_MATCH_CHALLENGE:1407,$$QQ_VIEW_DAILY_RECHARGE:1408,$$LUCKYTURN:1409,$$BOSS_THOUSANDTOWER:1410,$$THOUSANDTOWER_SWEEP:1411,$$SHOP_THOUSANDTOWER:1412,$$SHENJIANG_SHOP_ALERT:1413,$$SHENJIANG_ITEM_ALERT:1414,$$FESTIVAL_RECHARGE_ALERT:1415,$$FESTIVAL_ACCURECHARGE_ALERT:1416,$$FESTIVAL_ACCURECHARGE:1417,$$FESTIVAL_DAYRECHARGE:1418,$$FUDAI_ALERT:1419,$$FUDAI_BTN_ALERT_1:1420,$$FUDAI_BTN_ALERT_10:1421,$$FUDAI_QUAN_ALERT:1422,$$FUDAI_PRIZE_ALERT:1423,$$JUBAO_ALERT:1424,$$JUBAO_BTN_ALERT_1:1425,$$JUBAO_BTN_ALERT_10:1426,$$JUBAO_PRIZE_ALERT:1427,$$SZ_ALERT:1428,$$FESTIVAL_BOSS_CS:1429,$$FESTIVAL_BOSS_CS_AWARD:1430,$$PETWARSSUIT:1431,$$PETWARSSUIT_EQUIP_TAB_ALERT:1432,$$PETWARSSUIT_STAR_TAB_ALERT:1433,$$PETWARSSUIT_BREAK:1434,$$TREASURE_PAVILION:1435,$$TREASURE_PAVILION_AWARD:1436,$$TREASURE_PAVILION_PLIES_AWARD:1437,$$TREASURE_PAVILION_THROW:1438,$$COMRADE_BACK:1439,$$REGRESS_ACTIVITY:1440,$$SEVEN_LOGIN:1441,$$RECALL:1442,$$INCENSE_ALERT:1443,$$COMMON_SHOP_ALERT:1444,$$GOLD_EQUIP_SHOP:1445,$$SHOP_ALERT:1446,$$MYSTERYSHOPFRAME_ALERT:1447,$$REWARDER:1448,$$NEWYEARKEEP_ALERT4:1449,$$NEWYEARKEEP_ALERT5:1450,$$NEWYEARKEEP_ALERT6:1451,$$NEWYEARACCU_ALERT4:1452,$$NEWYEARACCU_ALERT5:1453,$$NEWYEARACCU_ALERT6:1454,$$FESTIVAL_SINGLE_RECHARGE:1455,$$TRANSFER_ALERT:1456,$$TRANSFER_LEVEL_PAGE:1457,$$TRANSFER_TALENT_PAGE:1458,$$TRANSFER_UPGRADE_PAGE:1459,$$TRANSFER_EQUIP_PAGE:1460,$$TRANSFER_LV:1461,$$TRANSFER_LV_BTN:1462,$$TRANSFER_ACTIVE_BTN:1463,$$TRANSFER_SKILL_BTN:1464,$$TRANSFER_ATTRITEM:1465,$$TRANSFER_USE_EXPITEM:1466,$$TRANSFER_UPGRADE_BTN:1467,$$TRANSFER_TALENT_LV_BTN:1468,$$TRANSFER_EQUIP_WEAR:1469,$$TRANSFER_EQUIP_LV:1470,$$TRANSFER_EQUIP_ALERT:1471,$$VIP_BOSS:1472,$$PUSH_PRIZE:1473,$$BACK_PACK_SHARD:1474,$$BACK_PACK_HUNSHI:1475,$$BACK_PACK_GOD_EQUIP:1476,$$MY_MAP:1477,$$PARTNER_MAP:1478,$$RECRUIT_MAP:1479,$$PARTNER:1480,$$PARTNER_MAIN:1481,$$PARTNER_UPGRADE:1482,$$PARTNER_STAR:1483,$$PARTNER_BREAK:1484,$$PARTNER_CUR_MAIN_TAB:1485,$$PARTNER_CUR_UPGRADE_TAB:1486,$$PARTNER_CUR_STAR_TAB:1487,$$PARTNER_CUR_BREAK_TAB:1488,$$PARTNER_CUR_SPIRIT_TAB:1489,$$PARTNER_BATTLE:1490,$$PARTNER_HELP:1491,$$PARTNER_AUTOEQUIP:1492,$$PARTNER_EQUIP_BREAK:1493,$$PARTNER_CUR_AUTOEQUIP:1494,$$PARTNER_CUR_UPGRADE:1495,$$PARTNER_CUR_STAR:1496,$$PARTNER_CUR_BREAK:1497,$$PARTNER_CUR_BATTLE:1498,$$PARTNER_CUR_HELP:1499,$$PARTNER_CUR_EQUIP_BREAK:1500,$$PARTNER_CUR_SPIRIT:1501,$$ZHENXING:1502,$$ZHENXING_COST:1503,$$ZHENXING_BATTLE:1504,$$ZHENXING_ATTR:1505,$$FOSTER_MOUNT:1506,$$FOSTER_WING:1507,$$FOSTER_ZHANJI:1508,$$FOSTER_HALO:1509,$$FOSTER_SHENHUN:1510,$$FOSTER_MOUNT_FETTER:1511,$$FOSTER_WING_FETTER:1512,$$FOSTER_ZHANJI_FETTER:1513,$$FOSTER_HALO_FETTER:1514,$$FOSTER_SHENHUN_FETTER:1515,$$SHENQI:1516,$$SHENQI_COST:1517,$$SHENQI_BATTLE:1518,$$SHENQI_SHILIAN:1519,$$WAR_ORDER:1520,$$WAR_ORDER_LEVEL:1521,$$WAR_ORDER_DAILY:1522,$$WAR_ORDER_WEEK:1523,$$WAR_ORDER_QUARTER:1524,$$HUNLU:1525,$$HUNLU_HUNKA:1526,$$HUNLU_ACHIEVEMENT:1527,$$FUND_AWARD:1528,$$FULL_AWARD:1529,$$RANK:1530,$$FOSTER_MOUNT_ATTR_ITEM:1531,$$FOSTER_WING_ATTR_ITEM:1532,$$FOSTER_ZHANJI_ATTR_ITEM:1533,$$FOSTER_HALO_ATTR_ITEM:1534,$$FOSTER_SHENHUN_ATTR_ITEM:1535,$$FOSTER_MOUNT_INFO:1536,$$FOSTER_WING_INFO:1537,$$FOSTER_ZHANJI_INFO:1538,$$FOSTER_HALO_INFO:1539,$$FOSTER_SHENHUN_INFO:1540,$$MONEY_CAT_ALERT:1541,$$YANGCHENG_ALERT:1542,$$PARTNER_AWAKEN:1543,$$PARTNER_CUR_AWAKEN:1544,$$RECRUIT:1545,$$CONTINUOUS_CONSUME:1546,$$MOUNT_AWAKE_ALERT:1547,$$WING_AWAKE_ALERT:1548,$$ZHANJI_AWAKE_ALERT:1549,$$HALO_AWAKE_ALERT:1550,$$SHENHUN_AWAKE_ALERT:1551,$$OPEN_SER_CARNIVAL:1552,$$PARTNER_GIFT_ALERT:1553,$$VIP_ACTIVITY:1554,$$OPEN_SERV_CR1:1555,$$OPEN_SERV_CR2:1556,$$OPEN_SERV_CR3:1557,$$OPEN_SERV_CR4:1558,$$OPEN_SERV_CR5:1559,$$OPEN_COMPETITION_ALERT:1560,$$OPEN_COMPETITION_ALERT_NEW:1561,$$RECRUIT_REBATE:1562,$$QQ_REDPACKET:1563,$$COFFERS:1564,$$COFFERS_SAVE_JIN:1565,$$COFFERS_SAVE_YIN:1566,$$COFFERS_TASK:1567,$$SHELL:1568,$$SHELL_FREE:1569,$$SHELL_FRESH:1570,$$SHELL_AWARDS:1571,$$VALUE_REBATE_ALL:1572,$$VALUE_CHOU_ALERT:1573,$$VALUE_CHOU_ALERT2:1574,$$VALUE_RWARD_ALERT:1575,$$SCRATCH:1576,$$PARTNER_SKIN:1577,$$PARTNER_CUR_SKIN:1578,$$QUICK_FITHG:1579,$$HUNTING_CONTEST:1580,$$HUNTING_CONTEST_BUY:1581,$$HUNTING_CONTEST_SCORE:1582,$$HUNTING_CONTEST_TASK:1583,$$HUNTING_CONTEST_GIFT:1584,$$DAYORWEEK_ALL:1585,$$DAYORWEEK_BTN1:1586,$$DAYORWEEK_BTN2:1587,$$REC_RECOVERY_ALERT:1588,$$ONE_YUAN_ALERT:1589,$$ZHUANJI:1590,$$ZHUANJI_BATTLE:1591,$$ZHUANJI_BOX:1592,$$TRIBAL_RESEARCH:1593,$$TRIBAL_BATTLE:1594,$$TRIBAL_SURVIVAL:1595,$$TRIBAL_ASSIST:1596,$$PARTNER_BACK:1597,$$PARTNER_BACK_UPGRADE:1598,$$PARTNER_BACK_BREAK:1599,$$PARTNER_BACK_STAR:1600,$$PARTNER_BACK_JP:1601,$$PARTNER_BACK_AWAKEN:1602,$$PARTNER_BACK_ACTIVE:1603,$$PARTNER_BACK_CUR_UPGRADE:1604,$$PARTNER_BACK_CUR_BREAK:1605,$$PARTNER_BACK_CUR_STAR:1606,$$PARTNER_BACK_CUR_JP:1607,$$PARTNER_BACK_CUR_AWAKEN:1608,$$WELFARE_TARGET_ALERT:1609,$$PARTNER_BACK_TAB_LIST:1610,$$PARTNER_BACK_TAB_CHIP:1611,$$EXPLORE:1612,$$EXPLORE_THROW:1613,$$EXPLORE_BOX:1614,$$NEW_FIRST_CHARGE:1615,$$PARTNER_CUR_SURFACE:1616,$$MAP_ACHIEVE:1617,$$BARBARIAN:1618,$$BARBARIAN_AWARD:1619,$$BARBARIAN_RESET:1620,$$RECHARGE_HALL_RECHARGE:1621,$$REBORN:1622,$$GUILD_INSTANCE:1623,$$RECRUIT_SELECT:1624,$$DAILYWISH:1625,$$DAILYWISH_AWARD:1626,$$DAILYWISH_TASKS:1627,$$PARTNER_CUR_TALENT_TAB:1628,$$PARTNER_CUR_TALENT:1629,$$PARTNER_BACK_CUR_TALENT:1630,$$PARTNER_TALENT:1631,$$EXCHANGE:1632,$$EXCHANGE_TASK:1633,$$EXCHANGE_CONVERT:1634,$$HELP_ARMY:1635,$$HELP_ARMY_CHANGE:1636,$$HELP_ARMY_PAGE_ONE:1637,$$HELP_ARMY_PAGE_TWO:1638,$$PARTNER_HELP_BASE:1639,$$LIMIT_SALE_PRIZE:1640,$$MIBAO:1641,$$MIBAO_CHANGE:1642,$$MIBAO_TASK:1643,$$MIBAO_SCORE:1644,$$OPTION_LOTTERY_PIONT:1645,$$OPTION_LOTTERY_LOTTERY:1646,$$OPTION_LOTTERY_TASK:1647,$$SPECIAL_WAR_MAIN_TASK_TOKEN:1648,$$SPECIAL_WAR_MEMOIR_TOKEN:1649,$$SPECIAL_WAR_ZHANJIANG_TOKEN:1650,$$SPECIAL_WAR_ZHAOQIN_TOKEN:1651,$$SPECIAL_WAR_BARBARIAN_TOKEN:1652,$$QQVIDEO:1653,$$GUILD_NEW_BOSS:1654,$$GUILD_NEW_BOSS_OPEN:1655,$$GUILD_NEW_BOSS_CHALLENGE:1656,$$SPECIAL_WAR_MEMOIR_TOKEN2:1657,$$SPECIAL_WAR_ZHANJIANG_TOKEN2:1658,$$AOYI_ENCH:1659,$$AOYI_RUNE:1660,$$GUILD_CONFLICT_MAIN:1661,$$GUILD_CONFLICT_TASK:1662,$$GUILD_CONFLICT_PRO_TASK:1663,$$GUILD_CONFLICT_BATTLE_LOG:1664,$$GUILD_CONFLICT_FIRST_ENTER:1665,$$GOD_ANIMAL:1666,$$GOD_ANIMAL_MESSAGE:1667,$$GOD_ANIMAL_BAG:1668,$$GOD_ANIMAL_BAG_ACT:1669,$$GOD_ANIMAL_BAG_CHIP:1670,$$ZHANJIANG_SWEEP:1671,$$PARTNER_QUALITY_FETTER:1672,$$SHENQI_STAR:1673,$$SHENQI_BLESS:1674,$$QM_STAR_1:1675,$$QM_STAR_2:1676}),b8e.RC("$$game","$$SpotAlertEnum",e)}(),function(){var e=void 0;e=b8e.PoolObject.extends({type:0,val:0,clientVal:0,clientPer:0,ctor:function(){this._super(),this.reset()},restore:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.type=0,this.val=0,this.clientVal=0,this.clientPer=0}}),b8e.BindingUtil.bind(e);var t=new b8e.Pool(e,1024);e.get=function(){return t.get()},e.put=function(e){return t.put(e)},b8e.RC("$$game","$$SpriteStatUnitInfo",e)}(),function(){var e=void 0;e=b8e.PoolObject.extends({ctor:function(){this._super(),this._map=b8e.HashMap.get()},setData:function(e){this._map&&this._recycleSpriteStatInfo();var t=game.SpriteDefine;if(t&&!(t.length<1))for(var a=0,i=t.length,n=void 0,s=void 0,o=void 0,r=void 0,g=void 0,l=void 0,c=void 0,h=void 0;a<i;a++)(r=t[a])&&(o=s=n=0,g=b8e.getNormP(r.key),l=r.type,(n=e[g])&&(c=game.AttrRulesCfg.getData(l))&&2==c.format&&(n/=1e3),(s=e[g=b8e.getNormP(r.clientKey)])||(n=e[g=b8e.getNormP(game.KeyByStatType[r.type])])&&(c=game.AttrRulesCfg.getData(l))&&2==c.format&&(n/=1e3),o=e[g=b8e.getNormP(r.clientPer)],(n||s||o)&&((h=game.SpriteStatUnitInfo.get()).type=l,h.val=n,h.clientVal=s,h.clientPer=o/1e3,this._map.set(l,h)))},getSpriteStatList:function(){return this._map?this._map.values():null},clear:function(){this._recycleSpriteStatInfo()},_recycleSpriteStatInfo:function(){this._map&&(this._map.forEach(this._clearSpriteStatInfo,this),this._map.clear())},_clearSpriteStatInfo:function(e,t){t&&t.release()},recycle:function(){this._recycleSpriteStatInfo(),this._super()}}),b8e.BindingUtil.bind(e);var t=new b8e.Pool(e,1024);e.get=function(){return t.get()},e.put=function(e){return t.put(e)},b8e.RC("$$game","$$SpriteStatInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({ctor:function(){this._super(),this.clear(),this.dataHashMap=b8e.HashMap.get(),this.isAddTeam=!0,this.isSetZero=!1,this.coef=1},setStatValue:function(e,t){this.dataHashMap.set(e,t)},getStatValue:function(e){var t=this.dataHashMap.get(e);return t||(t=0,this.dataHashMap.set(e,t)),t},addServerStatValue:function(e,t,a,i){var n=!(2<arguments.length&&void 0!==a)||a,s=!(3<arguments.length&&void 0!==i)||i;if((n||!n&&game.statType.isNomralStat(e))&&(t||s)){var o=this.dataHashMap.get(e)||0,r=game.AttrPowerCoefCfg.getData(e);t=r&&1==r.type?(o+t)/1e4:o+t,this.dataHashMap.set(e,t)}},initSpriteStat:function(){for(var e=game.DefaultType.length,t=0;t<e;t++)this.dataHashMap.set(game.DefaultType[t],0)},initFosterSpriteStat:function(){for(var e=game.FosterDefaultType.length,t=0;t<e;t++)this.dataHashMap.set(game.FosterDefaultType[t],0)},setupByCfg:function(e,t,a){var i=!(1<arguments.length&&void 0!==t)||t,n=2<arguments.length&&void 0!==a&&a;if(this.dataHashMap.clear(),e)for(var s=game.SpriteDefine,o=0,r=s.length,g=void 0,l=void 0,c=void 0;o<r;o++)if((c=s[o])&&(l=c.type,g=e[b8e.getNormP(c.key)],(i||!i&&game.statType.isNomralStat(l))&&(g||null!=g&&n))){var h=game.AttrRulesCfg.getData(l);h&&2==h.format&&(g/=1e3),this.dataHashMap.set(l,g)}},setupByOverlordCfg:function(e){if(this.dataHashMap.clear(),e)for(var t=game.SpriteDefine,a=0,i=t.length,n=void 0,s=void 0,o=void 0;a<i;a++)if(o=t[a]){s=o.type,n=e[b8e.getNormP(o.key)];var r=game.AttrRulesCfg.getData(s);n&&(r&&2==r.format&&(n/=1e3),this.dataHashMap.set(s,n))}},addByCfg:function(e,t,a){var i=!(1<arguments.length&&void 0!==t)||t,n=2<arguments.length&&void 0!==a?a:1;if(e)for(var s=game.SpriteDefine,o=0,r=s.length,g=void 0,l=void 0,c=void 0;o<r;o++)if((c=s[o])&&(l=c.type,g=e[b8e.getNormP(c.key)],(i||!i&&game.statType.isNomralStat(l))&&g)){var h=this.dataHashMap.get(l)||0,m=game.AttrRulesCfg.getData(l);m&&2==m.format&&(g/=1e3),g*=n,this.dataHashMap.set(l,g+h)}},updateStat:function(e,t){var a=1<arguments.length&&void 0!==t&&t;if(e&&e.attrs)for(var i=void 0,n=void 0,s=0,o=void 0;s<e.attrs.length;s++){if(o=e.attrs[s],a){if(!(i=game.AttrPowerCoefCfg.getData(o.id)))continue;n=1==i.type?o.value/1e4:o.value}else n=o.value;this.setStatValue(o.id,n)}},getCount:function(){return this.dataHashMap?this.dataHashMap.count():0},getFirstSpriteStat:function(){var a=0;return this.dataHashMap.forEach(function(e,t){t<=0||0<a||(a=t)},this),a},clear:function(){this.dataHashMap&&this.dataHashMap.clear()},setZero:function(){var a=this;a.dataHashMap.forEach(function(e,t){a.dataHashMap.set(e,0)},a)},getSpriteStats:function(){return this.dataHashMap},addSpriteStat:function(e,t,a,i){var n=1<arguments.length&&void 0!==t?t:1,s=!(2<arguments.length&&void 0!==a)||a,o=!(3<arguments.length&&void 0!==i)||i,r=this;if(e){var g=e.getSpriteStats();g&&g.forEach(function(e,t){if(s||!s&&game.statType.isNomralStat(e)){if(!t&&!o)return;var a=1e3*(r.getStatValue(e)||0);a+=t*n*1e3,r.setStatValue(e,a/1e3)}},r)}},sunSpriteStat:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:1,n=!(2<arguments.length&&void 0!==a)||a,s=this;if(e){var o=e.getSpriteStats();o&&o.forEach(function(e,t){if(n||!n&&game.statType.isNomralStat(e)){var a=1e3*(s.getStatValue(e)||0);a-=t*i*1e3,s.setStatValue(e,a/1e3)}},s)}},addSpriteStateByType:function(e,t,a){var i=!(2<arguments.length&&void 0!==a)||a,n=this.getSpriteStats();if(n&&(i||!i&&game.statType.isNomralStat(e))){var s=n.get(e)||0,o=game.AttrPowerCoefCfg.getData(e);o&&1==o.type&&(t=(t+1e3*s)/1e3),n.set(e,t)}},addSpriteStatTeam:function(e,i){var n=this,t=e.getSpriteStats();t&&t.forEach(function(e,t){if(!game.statType.isNomralStat(e)){var a=n.getStatValue(e%100);if(a|=0,game.statType.isElementStat(e))(e-e%100)/100==i&&n.setStatValue(e%100,a+t);else n.setStatValue(e%100,a+t)}},n)},delSpriteByType:function(e){this.dataHashMap&&this.dataHashMap.del(e)},getPower:function(){return game.CCommonUtil.getPower(this)},getTeamPower:function(){var e=game.partnerData.getToBattleCount()+1;return this.getPower()*e},multiply:function(a){var i=this;i.dataHashMap.forEach(function(e,t){t=t*a|0,i.setStatValue(e,t)},i)},recycle:function(){this.dataHashMap&&this.dataHashMap.clear(),this._super()},dispose:function(){this.dataHashMap&&(this.dataHashMap.release(),this.dataHashMap=null),this._super()}}),a=t.pool=new b8e.Pool(t,4096);t.get=function(e,t){return a.get(e,t)},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$SpriteStat",e)}(),function(){var e,t=game.statType={},a=e=b8e.Enum({None:0,Health:1,Attack:2,Defense:3,Hit:4,Crit:5,CritRes:6,Dodge:7,Speed:8,IgnoreDef:9,IgnoreDefRes:10,Damage:11,DamageRes:12,CritDamage:13,CritDamageRes:14,PvpDamage:15,PvpDamageRes:16,PveDamage:17,PveDamageRes:18,WushuangAtk:19,WushuangDef:20,Anger:21,WaterHp:101,WaterAtk:102,WaterDef:103,FireHp:201,FireAtk:202,FireDef:203,WindHp:301,WindAtk:302,WindDef:303,EarthHp:401,EarthAtk:402,EarthDef:403,TeamHp:901,TeamAtk:902,TeamDef:903,TeamHit:904,TeamCrit:905,TeamCritRes:906,TeamDodge:907,TeamSpeed:908,TeamIgnoreDef:909,TeamIgnoreDefRes:910,TeamDamage:911,TeamDamageRes:912,TeamCritDamage:913,TeamCritDamageRes:914,TeamPvpDamage:915,TeamPvpDamageRes:916,TeamPveDamage:917,TeamPveDamageRes:918,TeamWushuangAtk:919,TeamWushuangDef:920,TeamAnger:921});t._create=function(e,t,a,i){var n=b8e.createMap();return n.key=e,n.type=t,n.clientKey=a,n.clientPer=i,n},game.SpriteDefine=[t._create("_$hp",a.Health,"_$clientHp","_$clientHpPer"),t._create("_$atk",a.Attack,"_$clientAtk","_$clientAtkPer"),t._create("_$def",a.Defense,"_$clientDef","_$clientDefPer"),t._create("_$hit",a.Hit,"_$clientHit","_$clientHitPer"),t._create("_$dodge",a.Dodge,"_$clientDodge","_$clientDodgePer"),t._create("_$speed",a.Speed,"_$clientSpeed","_$clientSpeedPer"),t._create("_$crit",a.Crit,"_$clientCrit","_$clientCritPer"),t._create("_$critRes",a.CritRes,"_$clientCritRes","_$clientCritResPer"),t._create("_$ignoreDef",a.IgnoreDef,"_$clientIgnoreDef","_$clientIgnoreDefPer"),t._create("_$ignoreDefRes",a.IgnoreDefRes,"_$clientIgnoreDefRes","_$clientIgnoreDefResPer"),t._create("_$pveDamage",a.PveDamage,"_$clientPveDamage","_$clientPveDamagePer"),t._create("_$pveDamageRes",a.PveDamageRes,"_$clientPveDamageRes","_$clientPveDamageResPer"),t._create("_$pvpDamage",a.PvpDamage,"_$clientPvpDamage","_$clientPvpDamagePer"),t._create("_$pvpDamageRes",a.PvpDamageRes,"_$clientPvpDamageRes","_$clientPvpDamageResPer"),t._create("_$critDamage",a.CritDamage,"_$clientCritDamage","_$clientCritDamagePer"),t._create("_$critDamageRes",a.CritDamageRes,"_$clientCritDamageRes","_$clientCritDamageResPer"),t._create("_$damage",a.Damage,"_$clientDamage","_$clientDamagePer"),t._create("_$damageRes",a.DamageRes,"_$clientDamageRes","_$clientDamageResPer"),t._create("_$wushuangAtk",a.WushuangAtk,"_$clientWushuangAtk","_$clientWushuangAtkPer"),t._create("_$wushuangDef",a.WushuangDef,"_$clientWushuangDef","_$clientWushuangDefPer"),t._create("_$anger",a.Anger,"_$clientAnger","_$clientAngerPer"),t._create("_$waterHp",a.WaterHp,"_$clientWaterHp","_$clientWaterHpPer"),t._create("_$waterAtk",a.WaterAtk,"_$clientWaterAtk","_$clientWaterAtkPer"),t._create("_$waterDef",a.WaterDef,"_$clientWaterDef","_$clientWaterDefPer"),t._create("_$windHp",a.WindHp,"_$clientWindHp","_$clientWindHpPer"),t._create("_$windAtk",a.WindAtk,"_$clientWindAtk","_$clientWindAtkPer"),t._create("_$windDef",a.WindDef,"_$clientWindDef","_$clientWindDefPer"),t._create("_$earthHp",a.EarthHp,"_$clientEarthHp","_$clientEarthHpPer"),t._create("_$earthAtk",a.EarthAtk,"_$clientEarthAtk","_$clientEarthAtkPer"),t._create("_$earthDef",a.EarthDef,"_$clientEarthDef","_$clientEarthDefPer"),t._create("_$fireHp",a.FireHp,"_$clientFireHp","_$clientFireHpPer"),t._create("_$fireAtk",a.FireAtk,"_$clientFireAtk","_$clientFireAtkPer"),t._create("_$fireDef",a.FireDef,"_$clientFireDef","_$clientFireDefPer"),t._create("_$teamHp",a.TeamHp,"_$clientTeamHp","_$clientTeamHpPer"),t._create("_$teamAtk",a.TeamAtk,"_$clientTeamAtk","_$clientTeamAtkPer"),t._create("_$teamDef",a.TeamDef,"_$clientTeamDef","_$clientTeamDefPer"),t._create("_$teamHit",a.TeamHit,"_$clientTeamHit","_$clientTeamHitPer"),t._create("_$teamDodge",a.TeamDodge,"_$clientTeamDodge","_$clientTeamDodgePer"),t._create("_$teamSpeed",a.TeamSpeed,"_$clientTeamSpeed","_$clientTeamSpeedPer"),t._create("_$teamCrit",a.TeamCrit,"_$clientTeamCrit","_$clientTeamCritPer"),t._create("_$teamCritRes",a.TeamCritRes,"_$clientTeamCritRes","_$clientTeamCritResPer"),t._create("_$teamIgnoreDef",a.TeamIgnoreDef,"_$clientTeamIgnoreDef","_$clientTeamIgnoreDefPer"),t._create("_$teamIgnoreDefRes",a.TeamIgnoreDefRes,"_$clientTeamIgnoreDefRes","_$clientTeamIgnoreDefResPer"),t._create("_$teamDamage",a.TeamDamage,"_$clientTeamDamage","_$clientTeamDamagePer"),t._create("_$teamDamageRes",a.TeamDamageRes,"_$clientTeamDamageRes","_$clientTeamDamageResPer"),t._create("_$teamCritDamage",a.TeamCritDamage,"_$clientTeamCritDamage","_$clientTeamCritDamagePer"),t._create("_$teamCritDamageRes",a.TeamCritDamageRes,"_$clientTeamCritDamageRes","_$clientTeamCritDamageResPer"),t._create("_$teamPvpDamage",a.TeamPvpDamage,"_$clientTeamPvpDamage","_$clientTeamPvpDamagePer"),t._create("_$teamPvpDamageRes",a.TeamPvpDamageRes,"_$clientTeamPvpDamageRes","_$clientTeamPvpDamageResPer"),t._create("_$teamPveDamage",a.TeamPveDamage,"_$clientTeamPveDamage","_$clientTeamPveDamagePer"),t._create("_$teamPveDamageRes",a.TeamPveDamageRes,"_$clientTeamPveDamageRes","_$clientTeamPveDamageResPer"),t._create("_$teamWushuangAtk",a.TeamWushuangAtk,"_$clientTeamWushuangAtk","_$clientTeamWushuangAtkPer"),t._create("_$teamWushuangDef",a.TeamWushuangDef,"_$clientTeamWushuangDef","_$clientTeamWushuangDefPer"),t._create("_$teamAnger",a.TeamAnger,"_$clientTeamAnger","_$clientTeamAngerPer")],game.DefaultType=[a.Health,a.Attack,a.Defense,a.Hit,a.Crit,a.CritRes,a.Dodge,a.Speed,a.IgnoreDef,a.IgnoreDefRes,a.Damage,a.DamageRes,a.CritDamage,a.CritDamageRes,a.PvpDamage,a.PvpDamageRes,a.PveDamage,a.PveDamageRes,a.WushuangAtk,a.WushuangDef,a.Anger,a.WaterHp,a.WaterAtk,a.WaterDef,a.WindHp,a.WindAtk,a.WindDef,a.EarthHp,a.EarthAtk,a.EarthDef,a.FireHp,a.FireAtk,a.FireDef,a.TeamHp,a.TeamAtk,a.TeamDef,a.TeamHit,a.TeamCrit,a.TeamCritRes,a.TeamDodge,a.TeamSpeed,a.TeamIgnoreDef,a.TeamIgnoreDefRes,a.TeamDamage,a.TeamDamageRes,a.TeamCritDamage,a.TeamCritDamageRes,a.TeamPvpDamage,a.TeamPvpDamageRes,a.TeamPveDamage,a.TeamPveDamageRes,a.TeamWushuangAtk,a.TeamWushuangDef,a.TeamAnger],game.FosterDefaultType=[a.Health,a.Attack,a.Defense],game.KeyByStatType=[],game.KeyByStatType[a.Health]="_$hp",game.KeyByStatType[a.Attack]="_$atk",game.KeyByStatType[a.Defense]="_$def",game.KeyByStatType[a.Hit]="_$hit",game.KeyByStatType[a.Crit]="_$crit",game.KeyByStatType[a.CritRes]="_$critRes",game.KeyByStatType[a.Dodge]="_$dodge",game.KeyByStatType[a.Speed]="_$speed",game.KeyByStatType[a.IgnoreDef]="_$ignoreDef",game.KeyByStatType[a.IgnoreDefRes]="_$ignoreDefRes",game.KeyByStatType[a.Damage]="_$damage",game.KeyByStatType[a.DamageRes]="_$damageRes",game.KeyByStatType[a.CritDamage]="_$critDamage",game.KeyByStatType[a.CritDamageRes]="_$critDamageRes",game.KeyByStatType[a.PvpDamage]="_$pvpDamage",game.KeyByStatType[a.PvpDamageRes]="_$pvpDamageRes",game.KeyByStatType[a.PveDamage]="_$pveDamage",game.KeyByStatType[a.PveDamageRes]="_$pveDamageRes",game.KeyByStatType[a.WushuangAtk]="_$wushuangAtk",game.KeyByStatType[a.WushuangDef]="_$wushuangDef",game.KeyByStatType[a.Anger]="_$anger",game.KeyByStatType[a.WaterHp]="_$waterHp",game.KeyByStatType[a.WaterAtk]="_$waterAtk",game.KeyByStatType[a.WaterDef]="_$waterDef",game.KeyByStatType[a.WindHp]="_$windHp",game.KeyByStatType[a.WindAtk]="_$windAtk",game.KeyByStatType[a.WindDef]="_$windDef",game.KeyByStatType[a.EarthHp]="_$earthHp",game.KeyByStatType[a.EarthAtk]="_$earthAtk",game.KeyByStatType[a.EarthDef]="_$earthDef",game.KeyByStatType[a.FireHp]="_$fireHp",game.KeyByStatType[a.FireAtk]="_$fireAtk",game.KeyByStatType[a.FireDef]="_$fireDef",game.KeyByStatType[a.TeamHp]="_$teamHp",game.KeyByStatType[a.TeamAtk]="_$teamAtk",game.KeyByStatType[a.TeamDef]="_$teamDef",game.KeyByStatType[a.TeamHit]="_$teamHit",game.KeyByStatType[a.TeamCrit]="_$teamCrit",game.KeyByStatType[a.TeamCritRes]="_$teamCritRes",game.KeyByStatType[a.TeamDodge]="_$teamDodge",game.KeyByStatType[a.TeamSpeed]="_$teamSpeed",game.KeyByStatType[a.TeamIgnoreDef]="_$teamIgnoreDef",game.KeyByStatType[a.TeamIgnoreDefRes]="_$teamIgnoreDefRes",game.KeyByStatType[a.TeamDamage]="_$teamDamage",game.KeyByStatType[a.TeamDamageRes]="_$teamDamageRes",game.KeyByStatType[a.TeamCritDamage]="_$teamCritDamage",game.KeyByStatType[a.TeamCritDamageRes]="_$teamCritDamageRes",game.KeyByStatType[a.TeamPvpDamage]="_$teamPvpDamage",game.KeyByStatType[a.TeamPvpDamageRes]="_$teamPvpDamageRes",game.KeyByStatType[a.TeamPveDamage]="_$teamPveDamage",game.KeyByStatType[a.TeamPveDamageRes]="_$teamPveDamageRes",game.KeyByStatType[a.TeamWushuangAtk]="_$teamWushuangAtk",game.KeyByStatType[a.TeamWushuangDef]="_$teamWushuangDef",game.KeyByStatType[a.TeamAnger]="_$teamAnger",game.KeyPerStatType=[],game.KeyPerStatType[a.Health]="_$perHp",game.KeyPerStatType[a.Attack]="_$perAtk",game.KeyPerStatType[a.Defense]="_$perDef",game.KeyPerStatType[a.Hit]="_$perHit",game.KeyPerStatType[a.Crit]="_$perCrit",game.KeyPerStatType[a.CritRes]="_$perCritRes",game.KeyPerStatType[a.Dodge]="_$perDodge",game.KeyPerStatType[a.Speed]="_$perSpeed",game.KeyPerStatType[a.IgnoreDef]="_$perIgnoreDef",game.KeyPerStatType[a.IgnoreDefRes]="_$perIgnoreDefRes",game.KeyPerStatType[a.Damage]="_$perDamage",game.KeyPerStatType[a.DamageRes]="_$perDamageRes",game.KeyPerStatType[a.CritDamage]="_$perCritDamage",game.KeyPerStatType[a.CritDamageRes]="_$perCritDamageRes",game.KeyPerStatType[a.PvpDamage]="_$perPvpDamage",game.KeyPerStatType[a.PvpDamageRes]="_$perPvpDamageRes",game.KeyPerStatType[a.PveDamage]="_$perPveDamage",game.KeyPerStatType[a.PveDamageRes]="_$perPveDamageRes",game.KeyPerStatType[a.WushuangAtk]="_$perWushuangAtk",game.KeyPerStatType[a.WushuangDef]="_$perWushuangDef",game.KeyPerStatType[a.Anger]="_$perAnger",game.KeyPerStatType[a.WaterHp]="_$perWaterHp",game.KeyPerStatType[a.WaterAtk]="_$perWaterAtk",game.KeyPerStatType[a.WaterDef]="_$perWaterDef",game.KeyPerStatType[a.WindHp]="_$perWindHp",game.KeyPerStatType[a.WindAtk]="_$perWindAtk",game.KeyPerStatType[a.WindDef]="_$perWindDef",game.KeyPerStatType[a.EarthHp]="_$perEarthHp",game.KeyPerStatType[a.EarthAtk]="_$perEarthAtk",game.KeyPerStatType[a.EarthDef]="_$perEarthDef",game.KeyPerStatType[a.FireHp]="_$perFireHp",game.KeyPerStatType[a.FireAtk]="_$perFireAtk",game.KeyPerStatType[a.FireDef]="_$perFireDef",game.KeyPerStatType[a.TeamHp]="_$perTeamHp",game.KeyPerStatType[a.TeamAtk]="_$perTeamAtk",game.KeyPerStatType[a.TeamDef]="_$perTeamDef",game.KeyPerStatType[a.TeamHit]="_$perTeamHit",game.KeyPerStatType[a.TeamCrit]="_$perTeamCrit",game.KeyPerStatType[a.TeamCritRes]="_$perTeamCritRes",game.KeyPerStatType[a.TeamDodge]="_$perTeamDodge",game.KeyPerStatType[a.TeamSpeed]="_$perTeamSpeed",game.KeyPerStatType[a.TeamIgnoreDef]="_$perTeamIgnoreDef",game.KeyPerStatType[a.TeamIgnoreDefRes]="_$perTeamIgnoreDefRes",game.KeyPerStatType[a.TeamDamage]="_$perTeamDamage",game.KeyPerStatType[a.TeamDamageRes]="_$perTeamDamageRes",game.KeyPerStatType[a.TeamCritDamage]="_$perTeamCritDamage",game.KeyPerStatType[a.TeamCritDamageRes]="_$perTeamCritDamageRes",game.KeyPerStatType[a.TeamPvpDamage]="_$perTeamPvpDamage",game.KeyPerStatType[a.TeamPvpDamageRes]="_$perTeamPvpDamageRes",game.KeyPerStatType[a.TeamPveDamage]="_$perTeamPveDamage",game.KeyPerStatType[a.TeamPveDamageRes]="_$perTeamPveDamageRes",game.KeyPerStatType[a.TeamWushuangAtk]="_$perTeamWushuangAtk",game.KeyPerStatType[a.TeamWushuangDef]="_$perTeamWushuangDef",game.KeyPerStatType[a.TeamAnger]="_$perTeamAnger",game.TeamKeyByStatType=[],game.TeamKeyByStatType[a.TeamHp]=a.Health,game.TeamKeyByStatType[a.TeamAtk]=a.Attack,game.TeamKeyByStatType[a.TeamDef]=a.Defense,game.TeamKeyByStatType[a.TeamHit]=a.Hit,game.TeamKeyByStatType[a.TeamCrit]=a.Crit,game.TeamKeyByStatType[a.TeamCritRes]=a.CritRes,game.TeamKeyByStatType[a.TeamDodge]=a.Dodge,game.TeamKeyByStatType[a.TeamSpeed]=a.Speed,game.TeamKeyByStatType[a.TeamIgnoreDef]=a.IgnoreDef,game.TeamKeyByStatType[a.TeamIgnoreDefRes]=a.IgnoreDefRes,game.TeamKeyByStatType[a.TeamDamage]=a.Damage,game.TeamKeyByStatType[a.TeamDamageRes]=a.DamageRes,game.TeamKeyByStatType[a.TeamCritDamage]=a.CritDamage,game.TeamKeyByStatType[a.TeamCritDamageRes]=a.CritDamageRes,game.TeamKeyByStatType[a.TeamPvpDamage]=a.PvpDamage,game.TeamKeyByStatType[a.TeamPvpDamageRes]=a.PvpDamageRes,game.TeamKeyByStatType[a.TeamPveDamage]=a.PveDamage,game.TeamKeyByStatType[a.TeamPveDamageRes]=a.PveDamageRes,game.TeamKeyByStatType[a.TeamWushuangAtk]=a.WushuangAtk,game.TeamKeyByStatType[a.TeamWushuangDef]=a.WushuangDef,game.TeamKeyByStatType[a.TeamAnger]=a.Anger,game.MaxKeyByStatType=[],game.MaxKeyByStatType[a.TeamHp]="_$maxTeamHp",game.MaxKeyByStatType[a.TeamAtk]="_$maxTeamAtk",game.MaxKeyByStatType[a.TeamDef]="_$maxTeamDef",game.MaxKeyByStatType[a.TeamDodge]="_$maxTeamDodge",game.MaxKeyByStatType[a.TeamCritRes]="_$maxTeamCritRes",game.MaxKeyByStatType[a.TeamHit]="_$maxTeamHit",game.MaxKeyByStatType[a.TeamCrit]="_$maxTeamCrit",game.MaxKeyByStatType[a.TeamSpeed]="_$maxTeamSpeed",game.MaxKeyByStatType[a.TeamIgnoreDef]="_$maxTeamIgnoreDef",game.MaxKeyByStatType[a.TeamIgnoreDefRes]="_$maxTeamIgnoreDefRes",game.MaxKeyByStatType[a.TeamDamage]="_$maxTeamDamage",game.MaxKeyByStatType[a.TeamDamageRes]="_$maxTeamDamageRes",t.isNomralStat=function(e){return e<=100},t.isElementStat=function(e){return 100<e&&e<=900},b8e.RC("$$game","$$SpriteStatType",e)}(),function(){var e;e=b8e.Enum({V_IS_SHOW_WEAR:-1,V_CHANGE_EQUIP:-1,V_EXP_CHANGE:-1,V_LEVEL_CHANGE:-1,V_POWER_CHANGE:-1,V_TRIGGER_OPEN:-1,C2C_WEAR_GOLD_EQUIP:-1,C2V_UPDATE_SLOTS:-1,UPGRADE_DOMIN_LEVEL:-1,UPDATEMODEL:-1,C2V_SWITCH_SZ:-1}),b8e.RC("$$game","$$EquipEvts",e)}(),function(){var e;e=b8e.Enum({FIRST_ENTER_SCENE:b8e.enc(),LEAVE_SCENE:b8e.enc(),ENTER_SCENE:b8e.enc(),C2C_RECONNECT_ENTER_SCENE:b8e.enc(),SCENE_CHANGE_MAP:b8e.enc(),CLEAR_SCENE:b8e.enc(),CHANGE_SCENE:b8e.enc(),CLICK_HERO:b8e.enc(),CLICK_MONSTER:b8e.enc(),CLICK_BOX:b8e.enc(),CLICK_NPC:b8e.enc(),SCENE_ADD_DISPLAY:b8e.enc(),SCENE_REQ_NPC:b8e.enc(),C2C_CHALLENGE:b8e.enc(),MAIN_MOVE_COMPLETE:b8e.enc(),MAIN_ROLE_DIE:b8e.enc(),MAIN_ROLE_REVIVE:b8e.enc(),SCENE_REVIVE:b8e.enc(),SCENE_EXIT:b8e.enc(),COLLECT_READ_PROGRESS_COMPLETE:b8e.enc(),SCENE_COLLECT:b8e.enc(),SCENE_COLLECT_NOTIFY:b8e.enc(),SCENE_COLLECT_FINISH:b8e.enc(),SCENE_COLLECT_FINISH_NOTIFY:b8e.enc(),SCENE_CHALLENGE:b8e.enc(),C2C_HIDE_CARD:b8e.enc(),C2C_SHOW_CARD:b8e.enc(),C2C_UPDATA_CAMP:b8e.enc(),C2C_CHALLENGE_ROLE:b8e.enc(),C2C_SHOW_ENEMY_TEAM:b8e.enc(),C2C_UPDATA_BTN:b8e.enc(),C2C_CHANGE_ROLE:b8e.enc(),SCENE_UNIT_UPDATE_ARROW:b8e.enc(),SCENE_UNIT_LEAVE:b8e.enc(),CLICK_CSWAR_MINE:b8e.enc(),SCENE_PLAYER_INFO_REQ:b8e.enc(),ENTER_CS_SCENE:b8e.enc(),CANCEL_AUTO_CHALLENGE:b8e.enc(),SCENE_AUTO_CHALLENGE:b8e.enc(),SCENE_REQ_PLAYEND:b8e.enc(),SCENE_CHANGE_THRONE:b8e.enc(),SCENE_THRONE_MONARCH:b8e.enc(),SCENE_THRONE_CHALLENGE_NPC:b8e.enc(),SCENE_THRONE_CHALLENGE_PLAYER_SUCCESS:b8e.enc(),SCENE_THRONE_CHALLENGE_PLAYER_FAIL:b8e.enc(),SCENE_THRONE_BE_CHALLENGE_SUCCESS:b8e.enc(),SCENE_THRONE_BE_CHALLENGE_FAIL:b8e.enc(),SCENE_GUILD_WAR_CHALLENGE:b8e.enc(),CSWARTEAM_INFO:b8e.enc(),TOWER_STATE:b8e.enc(),SCENE_GUILD_WAR_SNATCH:b8e.enc(),UPDATE_TREASURE_KEYS:b8e.enc(),STORY_BATTLE:b8e.enc(),ENTER_XEPLORE_SCENE:b8e.enc(),LEAVE_XEPLORE_SCENE:b8e.enc()}),b8e.RC("$$game","$$SceneGEvts",e)}(),function(){var e=b8e.Object.extends({_openModule:null,ctor:function(){this._openModule=[],this._result={ok:!0,desc:""}},checkOpen:function(e){return this.checkOpenWithTips(e,!1)},checkOpenWithTips:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i=game.ModuleCfg.getCfgByME(e);if(!i)return!0;var n=!1;if(i.trigger1&&(n=this._checkTriggers(i.trigger1)),!n.ok&&i.trigger2&&0<i.trigger2.length&&(n=this._checkTriggers(i.trigger2)),!n.ok&&a){var s=n.desc&&""!=n.desc?n.desc:i.desc;s&&""!=s&&game.notice.show(s)}return n.ok},checkOpenLv:function(e){var t=game.ModuleCfg.getCfgByME(e);if(!t)return!1;var a=!1;if(t.trigger1)for(var i=t.trigger1,n=i.length,s=game.TriggerType,o=void 0,r=void 0,g=0;g<n;g++)if((o=i[g]).Type==s.Level){r=o.Value,game.mainRoleData.lv>=+r&&(a=!0);break}return a},getOpenLv:function(e){var t=game.ModuleCfg.getCfgByME(e);if(!t)return!1;if(t.trigger1)for(var a=t.trigger1,i=a.length,n=game.TriggerType,s=void 0,o=0;o<i;o++)if((s=a[o]).Type==n.Level)return s.Value},getOpenValueByType:function(e,t){var a=game.ModuleCfg.getCfgByME(e);if(!a)return 0;var i=a.trigger1;if(!i||i.length<1)return 0;for(var n=i.length,s=void 0,o=0;o<n;o++)if((s=i[o]).Type==t)return s.Value;return 0},checkTriggers:function(e){return this._checkTriggers(e).ok},_checkTriggers:function(e){var t=this._result;if(t.ok=!0,t.desc="",!e)return t;for(var a,i,n=e.length,s=game.TriggerType,o=0;o<n;o++)if((i=(a=e[o]).Value)&&""!=i){switch(t.desc=a.Desc,a.Type){case s.Level:game.mainRoleData.lv<+i&&(t.ok=!1);break;case s.Vip:game.mainRoleData.vipLevel<+i&&(t.ok=!1);break;case s.Task:game.taskData.getTaskId()<+i&&(t.ok=!1);break;case s.OpenDays:game.miscData.openServerDay<+i&&(t.ok=!1);break;case s.Days:var r=b8e.TimeUtil.getDay(game.SysTime.curTime);-1==i.split("/").indexOf(r)&&(t.ok=!1);break;case s.Times:var g=i.split("/"),l=[];for(o=0,n=g.length;o<n;o++)l.push(game.TimeUtil.createOpenTime(g[o],"hh:mm"));game.TimeUtil.isOpen(l,"hh:mm")||(t.ok=!1);break;case s.GuildLv:game.guildData.getGuildLevel()<+i&&(t.ok=!1);break;case s.NotCross:1==+i&&game.sceneData.isCsScene(!0)&&(t.ok=!1);break;case s.RechargePlatform:var c=i.split("/");(b8e.isWeChatGame&&b8e.weChatEnv==b8e.WeChatEnv.TRIAL&&b8e.os===b8e.OS.IOS||c&&0<c.length&&-1<c.indexOf(game.RECHARGE_PLATFORM+""))&&(t.ok=!1);break;case s.FirstRechargeDaily:game.rechargeData.rechargeMoneyDaily<1&&(t.ok=!1);break;case s.CrossGuild:1==+i&&game.sceneData.isCsScene()&&(t.ok=!1);break;case s.PartnerMaxStarNum:game.partnerData.maxStarNum<+i&&(t.ok=!1);break;default:b8e.warn("\u672a\u5904\u7406\u7684\u529f\u80fd\u5f00\u542f\u89e6\u53d1\u7c7b\u578b",a.Type)}if(!t.ok)return t}else b8e.warn("\u529f\u80fd\u5f00\u542f\u89e6\u53d1\u6761\u4ef6\u4e0d\u80fd\u4e3a\u7a7a",a.Type);return t}});game.moduleOpen=game.moduleOpen||new e}(),function(){var e=b8e.Object.extends({selfMove:function(e,t,a,i,n){this.move(game.mainRole,e,0,1,t,a,i,n)},baseSpeed:{get:function(){return Number(game.GlobalCfg.getValue("baseSpeed"))}},flySpeed:{get:function(){return Number(game.GlobalCfg.getValue("flySpeed"))}},move:function(e,t,a,i,n,s,o,r){var g=2<arguments.length&&void 0!==a?a:0,l=3<arguments.length&&void 0!==i?i:1,c=!(4<arguments.length&&void 0!==n)||n,h=s,m=o,u=r;if(b8e.scene.isLoaded())if(e){var d=e.getStateRef(game.WalkStateReference);d.setParams(t,this.baseSpeed,g,l,c),d.onArrive(h,m,u),e.transition(game.RoleStateType.ACTION_WALK,d,!0)}else b8e.error("\u6ca1\u6709\u627e\u5230\u884c\u8d70\u7684\u76ee\u6807");else b8e.warn("\u573a\u666f\u6ca1\u6709\u521d\u59cb\u5316\u5b8c\u6210\uff0c\u4f46\u662f\u60f3\u8981\u5f00\u59cb\u5bfb\u8def\u4e86")},movePath:function(e,t,a,i,n,s){if(b8e.scene.isLoaded())if(e)if(!t||t.length<2)b8e.error("\u8def\u5f84\u4e3a\u7a7a\u6216\u8005\u4e0d\u8db32\u4e2a\u70b9");else{var o=e.getStateRef(game.WalkStateReference);o.setParams(t[t.length-1],this.baseSpeed,0,a,!1),o.setPath(t),o.onArrive(i,n,s),e.transition(game.RoleStateType.ACTION_WALK,o,!0)}else b8e.error("\u6ca1\u6709\u627e\u5230\u884c\u8d70\u7684\u76ee\u6807");else b8e.warn("\u573a\u666f\u6ca1\u6709\u521d\u59cb\u5316\u5b8c\u6210\uff0c\u4f46\u662f\u60f3\u8981\u5f00\u59cb\u5bfb\u8def\u4e86")},fly:function(e,t,a,i,n,s){if(b8e.scene.isLoaded())if(e){var o=e.getStateRef(game.FlyStateRefrence);o.setParams(t,this.flySpeed,a),o.onArrive(i,n,s),e.transition(game.RoleStateType.ACTION_FLY,o,!0)}else b8e.error("\u6ca1\u6709\u627e\u5230\u98de\u884c\u7684\u76ee\u6807");else b8e.warn("\u573a\u666f\u6ca1\u6709\u521d\u59cb\u5316\u5b8c\u6210\uff0c\u4f46\u662f\u60f3\u8981\u5f00\u59cb\u5bfb\u8def\u4e86")}});game.moveTo=game.moveTo||new e}(),function(){var e;e=b8e.Object.extends({_lastTm:0,ctor:function(){this._super()},addNotice:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:"",n=game.NoticeCfg.getData(e);if(n){var s,o=this,r=n.maxLine;if(o._cfg=n,!o._ncList){o._ncList=[]}for(;o._ncList.length>r;){if(s=o._ncList.shift()){s.removeFromParent(),game.NoticeUnit.put(s)}}var g=b8e.timeStamp;if(s=game.notice.getNoticeUnit(e,t,i),g-o._lastTm<500){if(o._ncList.push(s),!o._isStart){if(o._isStart=!0,o._timerObj){o._timerObj.stop()}if(!o._timerObj){o._timerObj=b8e.Timer.add(o,o.delayNotice,o._cfg.delayTime)}o._timerObj.reset(),o._timerObj.start()}}else o._lastTm=g,o.showNotice(s);if(!o._isRegisterEvt){o._isRegisterEvt=!0,b8e.evt.addG(o,b8e.Event.STAGE_RESIZE,o._onStageResize)}}else;},delayNotice:function(){var e=this,t=e._ncList.pop();if(t){e.showNotice(t),e._lastTm=b8e.timeStamp}},showNotice:function(e){b8e.Tween.kill(this),b8e.Tween.get(this).wait(50).call(this.onStartTween,this,[e])},onStartTween:function(e){var t=this;if(t.adjustLayout(e),e.setAlpha(1),e.setVisible(!0),e.setLocalZOrder(t._cfg.layerOrder),game.GameViewMgr.inst().showView(e),t._nc=e,b8e.Tween.kill(e),0<t._cfg.moveTime){b8e.Tween.get(e).to(null,t._cfg.showTime).to({y:e.y+t._cfg.endPosY},t._cfg.moveTime).to({alpha:0},t._cfg.hideTime).call(t.onEndTween,t,[e])}else b8e.Tween.get(e).to(null,t._cfg.showTime).to({alpha:0},t._cfg.hideTime).call(t.onEndTween,t,[e])},onEndTween:function(e){b8e.Tween.kill(e),game.NoticeUnit.put(e),e.removeFromParent();var t=this;if(t._ncList.length<1){if(t._timerObj){t._timerObj.stop()}if(t._nc=null,t._isStart=!1,t._isRegisterEvt){t._isRegisterEvt=!1,b8e.evt.rmvG(t,b8e.Event.STAGE_RESIZE,t._onStageResize)}}},adjustLayout:function(e){if(e&&this._cfg){var t=(b8e.stageWidth-e.width)/2,a=(b8e.stageHeight-e.height)/2;e.setPosition(t+this._cfg.offsetX,a+this._cfg.offsetY)}},_onStageResize:function(){this.adjustLayout(this._nc)}}),b8e.RC("$$game","$$Notice",e)}(),function(){var e;e=b8e.Object.extends({ctor:function(){this._super(),this._isReset=!0,this._lastTime=0,this._speed=.035},addNotice:function(e,t,a){var i=this;if(i._type=e,i._cfg=game.NoticeCfg.getData(i._type),i._cfg){i._ncList||(i._ncList=[]);var n=i._getNCObj(t,a,0,null,"","");i._ncList.push(n),i._ncList.sort(i._onSort),i._onScorll()}},addNotice2:function(e,t){var a=this;if(a._type=e,a._cfg=game.NoticeCfg.getData(a._type),a._cfg){var i=void 0,n=void 0,s=void 0,o=game.ChatFuncType;switch(t.funcType){case o.CHAT_FUNC_XUNBAO:s="xunbao",i=a.getContent(t,s);break;case o.CHAT_FUNC_SHELL:s="shell",i=a.getContent(t,s);break;case o.CHAT_FUNC_HUNTING:s="hunting_contest",i=a.getContent(t,s);break;case o.CHAT_MAIN_INT:s="main_ins",i=a.getContent2(t,s);break;case o.CHAT_ZHANJIANG:s="zhanjiang",i=a.getContent2(t,s);break;case o.CHAT_FIRST_RECHARGE:s="first_recharge",i=a.getContent2(t,s);break;case o.CHAT_CARD_MONTH:s="card_month",i=game.MarqueeLang.get(s,t.roleName);break;case o.CHAT_CARD_FOREVER:s="card_forever",i=game.MarqueeLang.get(s,t.roleName);break;case o.CHAT_PRIVILEGE_BATTLE:s="privilege_battle",i=game.MarqueeLang.get(s,t.roleName);break;case o.CHAT_PARTNER_STAR:s="partner_star";var r=a.tempArgs;if((r=r||(a.tempArgs=[])).length=0,r.push(t.roleName),!(n=t.params?t.params.split("|"):[])&&n.length<1)return;var g=+n[0],l=game.PartnerCfg.getData(g);if(l){var c=game.HtmlUtil.getColorStrByQuality(l.quality,l.name,!0);r.push(c)}n[1]&&r.push(n[1]),i=game.MarqueeLang.getLang(s,r);break;case o.CHAT_FUNC_SUMMON:if(s="partner_recruit",!(n=t.params?t.params.split("|"):[])&&n.length<1)return;var h=+n[0],m=game.ItemInfoCfg.getData(h);if(!m)return;h=+n[1];var u=game.SummonOpenCfg.getData(h);if(!u)return;var d=game.HtmlUtil.getColorStrByQuality(m.quality,m.name);i=game.MarqueeLang.get("partner_recruit",t.roleName,u.name,d)}if(s&&i){a._ncList||(a._ncList=[]);var f=-1,p="",_=game.MarqueeLang.getData(s);_&&(f=_.sort,p=_.linkText);var v=a._getNCObj(i,f,t.funcType,t,p,s);a._ncList.push(v),a._ncList.sort(a._onSort),a._onScorll()}}},getContent:function(e,t){var a=e.params?e.params.split("|"):[];if(!a||a.length<1)return"";var i=[],n=e.roleName;if(i.push(n),e.funcType==game.ChatFuncType.CHAT_FUNC_XUNBAO){var s=+a[1],o=game.xunBaoData.getCfgById(s);if(!o)return"";i.push(o.name)}var r=parseInt(+a[0]),g=game.ItemInfoCfg.getData(r);if(g){var l=game.HtmlUtil.getColorStrByQuality(g.quality,g.name,!0);return i.push(l),game.MarqueeLang.getLang(t,i)}},getContent2:function(e,t){var a=this.tempArgs;(a=a||(this.tempArgs=[])).length=0,a.push(e.roleName);var i=e.params?e.params.split("|"):[];if(i&&0<i.length)for(var n=i.length,s=0;s<n;s++)a.push(i[s]);return game.MarqueeLang.getLang(t,a)},_onSort:function(e,t){return e.sort==t.sort?t.time-e.time:e.sort-t.sort},_onScorll:function(){var e=this;e._init(),e._container&&e._isReset&&(e._isReset=!1,e._container.setVisible(!0),e._adjustLayout(),b8e.Ticker.add(e,e._onStartScorll),b8e.evt.addG(e,b8e.Event.STAGE_RESIZE,e._onStageResize))},_init:function(){var e=this,t=e._cfg.url;if(t&&!e._bg){e._bg=b8e.Sprite.get(),e._bg.setStyle(b8e.SpriteStyle.SLICED);var a=game.notice.getScale9Inset(e._type);e._bg.setSize(e._cfg.width,e._cfg.height),e._bg.scale9Inset=a,e._bg.loadTexture(t)}e._lab||(e._lab=b8e.RichText.get(),e._lab.setTouchable(!0),e._lab.setAnchor(0,0),e._lab.setFontSize(e._cfg.textSize),e._lab.setPosition(0,6),e._lab.setLineHeight(e._cfg.textSize+2)),e._container||(e._container=b8e.BaseDisplay.get(),e._container.setMask(cc.Mask.Type.RECT),e._container.setSize(e._cfg.width,e._cfg.height),e._container._specialLayer=!0,e._bg&&e._container.addChild(e._bg),e._container.addChild(e._lab),e._container.setLocalZOrder(e._cfg.layerOrder),e._container.setTouchEnabled(!1)),e._container.parent||game.GameViewMgr.inst().showView(e._container,null,!1,2,!0)},_onStartScorll:function(){var e=this;if(e._isScroll){0==e._lastTime&&(e._lastTime=game.SysTime.curTime);var t=game.SysTime.curTime-e._lastTime;e._lastTime=game.SysTime.curTime,e._lab.x-=e._cfg.distance*t*e._speed;var a=-e._lab.width;if(e._lab.x<a){e._isScroll=!1;var i=e.curNcObj,n=e._ncList.indexOf(e.curNcObj);-1<n?e._ncList.splice(n,1):i=e._ncList.pop(),i&&(e._ncObjPool||(e._ncObjPool=[]),i.msg="",i.sort=-1,i.time=0,i.chatType=0,i.chatContent=null,i.linkText="",i.marqueeKey="",e._ncObjPool.push(i)),e.curNcObj=null}}else{if(e._ncList&&e._ncList.length<1)return e.curNcObj=null,void e._reset();e._isScroll=!0,e._lab.x=e._cfg.width;var s=e._ncList[e._ncList.length-1];if(!s||!s.msg)return e.curNcObj=null,void e._reset();var o=s.msg;if(s.linkText){var r=b8e.getNormP("_$clickFunc");o+=game.HtmlUtil.getClickableText2(e,e._lab,s.linkText,r,e.clickFunc)}e.curNcObj=s,e._lab.setText(o)}},clickFunc:function(){var e=this.thisArg.curNcObj;if(e){var t=e.chatContent;if(t.funcType!=game.ChatFuncType.CHAT_FUNC_XUNBAO){var a=game.MarqueeLang.getData(e.marqueeKey);a&&a.funcId&&game.module.showToggle(a.funcId,a.pageIndex)}else{var i=t.params?t.params.split("|"):[];if(i.length<1)return;var n=+i[1];b8e.evt.dptG(game.XunBaoEvts.C2C_SHOW_XUNBAO,n)}}},_adjustLayout:function(){if(this._cfg&&this._container){var e=(b8e.stageWidth-this._cfg.width)/2,t=b8e.stageHeight-this._cfg.height;this._container.setPosition(e+this._cfg.offsetX,t-this._cfg.offsetY)}},_getNCObj:function(e,t,a,i,n,s){var o=void 0;return(o=this._ncObjPool&&0<this._ncObjPool.length?this._ncObjPool.shift():{msg:"",sort:-1,time:0,chatType:0,chatContent:null,linkText:"",marqueeKey:""}).msg=e,o.sort=t,o.chatType=a,o.linkText=n,o.marqueeKey=s,o.chatContent=i,o.time=game.SysTime.curTime,o},_reset:function(){var e=this;e._isReset=!0,e._container&&e._container.setVisible(!1),e._lab&&e._lab.setText(""),e._lastTime=0,b8e.Ticker.remove(e,e._onStartScorll),b8e.evt.rmvG(e,b8e.Event.STAGE_RESIZE,e._onStageResize)},_onStageResize:function(){this._adjustLayout()}}),b8e.RC("$$game","$$SystemNotice",e)}(),function(){var e=b8e.Object.extends({SYSTEM_ROLL:101,WINDOW_CENTER:102,WINDOW_BIG_CENTER:103,WINDOW_GUAJI:104,WINDOW_BOTTOM:601,SPRITE_STAT:602,array:null,tempList:null,tweenSpace:200,ctor:function(){this._super(),this.array=[],this.tempList=[]},show:function(){if(!arguments||arguments.length<1)b8e.error("notice.show \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570");else{var e=Array.prototype.slice.call(arguments),t=e[0];e.shift();var a=void 0,i=void 0;"string"==typeof t?a=t:(a=(i=game.Lang.getData(t))&&i.lang?i.lang:t+"",e=game.Lang.getArrAgs(e)),a=game.Lang.replaceStr(a,e),this.showNotice(this.WINDOW_CENTER,a)}},noticeError:function(e){var t=game.ServerCodeCfg.getData(e);t?this.show(t.desc):this.show(9570,e)},amountNotice:function(e,t){var a=game.AmountCfg.getData(e);a?this.getNotice(a.itemId,t):b8e.warn("\u8d27\u5e01\u7c7b\u578b\u672a\u627e\u5230\u5bf9\u5e94\u7684\u914d\u7f6e\u7c7b\u578bamountType\uff1a",e)},getNotice:function(e,t){var a=game.ItemInfoCfg.getData(e);if(a){var i=game.HtmlUtil.getColorStrByQuality(a.quality,a.name),n=game.Lang.get(202,i,t);this.tempList.push(n)}},broadcast:function(e,t){this.showNotice(this.SYSTEM_ROLL,e,t)},broadcast2:function(e){var t=this.getModuleClass(this.SYSTEM_ROLL);t&&t.addNotice2(this.SYSTEM_ROLL,e)},showNotice:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:"",n=this.getModuleClass(e);n&&n.addNotice(e,t,i)},showPreciousItemNotice:function(e){this.showNotice(this.WINDOW_BOTTOM,e)},showSpriteStat:function(e){var t=this.getModuleClass(this.SPRITE_STAT);t&&t.addNotice(this.SPRITE_STAT,e)},showNoticeList:function(e){var t=this;e=e||t.WINDOW_CENTER,void 0!==t.key&&(clearTimeout(t.key),t.key=void 0);var a=t.tempList,i=void 0;0<a.length&&(t.key=setTimeout(function(){for(;a&&0<a.length;)i=a.shift(),t.showNotice(e,i,"")},0))},getNoticeUnit:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:"",n=game.NoticeUnit.get(),s=game.NoticeCfg.getData(e);return s?(n.create(e,t,i),n.setLocalZOrder(s?s.layerOrder:6666),n):null},getPreciousItemsUnit:function(e,t){var a=game.PreciousItemsUnit.get(),i=game.NoticeCfg.getData(e);return i?(a.setViewData(e,t),a.setLocalZOrder(i?i.layerOrder:6666),a):null},getSpriteStatUnit:function(e,t){var a=game.SpriteStatUnit.get(),i=game.NoticeCfg.getData(e);return i?(a.setViewData(e,t),a.setLocalZOrder(i?i.layerOrder:6666),a):null},getModuleClass:function(e){var t=void 0;if(this._moduleClass&&0<this._moduleClass.length&&(t=this._moduleClass[e]))return t;var a=game.NoticeCfg.getData(e);if(a&&a.moduleName){var i=this._getNoticeModuleName(a.moduleName),n=b8e.getDPV(game,i);i&&n&&(this._moduleClass||(this._moduleClass=[]),t=new n,this._moduleClass[e]=t)}return t},getScale9Inset:function(e){var t=void 0;if(this._scale9InsetArr&&0<this._scale9InsetArr.length&&(t=this._scale9InsetArr[e]))return t;this._scale9InsetArr||(this._scale9InsetArr=[]);var a=2,i=2,n=2,s=2,o=game.NoticeCfg.getData(e);if(o){var r=o.scale9Inset.split(";");if(r&&3<r.length)return t={top:a=+r[0],bottom:i=+r[1],left:n=+r[2],right:s=+r[3]},this._scale9InsetArr[e]=t}return{top:a,bottom:i,left:n,right:s}},_getNoticeModuleName:function(e){var t="_$NoticeView";switch(e){case"NoticeView":t="_$NoticeView";break;case"SystemNotice":t="_$SystemNotice";break;case"PreciousItemsView":t="_$PreciousItemsView";break;case"SpriteStatView":t="_$SpriteStatView";break;case"GJNoticeView":t="_$GJNoticeView"}return b8e.getNormP(t)}});game.notice=game.notice||new e}(),function(){var t=void 0;(t=b8e.BaseDisplay.extends({type:-1,ctor:function(){this._super(),this.init()},init:function(){var e=this;e._bg=b8e.Sprite.get(),e._bg.clearDisabled=!0,e._bg.setStyle(b8e.SpriteStyle.SLICED),e.addChild(e._bg),e._lab=b8e.RichText.get(),e._lab.clearDisabled=!0,e._lab.setHorizontalAlign(b8e.HorizontalAlign.CENTER),e._bg.addChild(e._lab),e._icon=b8e.Sprite.get(),e._icon.clearDisabled=!0,e._bg.addChild(e._icon)},create:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:"",n=this;if(n._iconUrl=i,n.type!=e){if(n.type=e,n._cfg=game.NoticeCfg.getData(e),!n._cfg){return}var s=n._cfg.url;if(!n._bgUrl||n._bgUrl!=s){n._bgUrl=s;n._bg||(n._bg=b8e.Sprite.get());var o=game.notice.getScale9Inset(e);n._bg.scale9Inset=o,n._bg.loadTexture(s)}0<n._cfg.width?n._lab.setSize(n._cfg.width,n._lab.height):n._lab.setSize(0,n._lab.height),n._lab.setFontSize(n._cfg.textSize),n._lab.setLineHeight(n._cfg.textSize+2),n._lab.setTouchable(!1),n._lab.setAnchor(0,0),n._lab.setColor(game.Color.WHITE)}t="<b>"+t+"</b>",n._lab.setText(t),""!=n._iconUrl&&(n._icon||(n._icon=b8e.Sprite.get()),n._bg.addChild(n._icon),n._icon.loadTexture(n._iconUrl)),n.layout()},layout:function(){var e=this,t=0,a=0,i=0,n=0;if(e._lab.width<1)e.setVisible(!1);else{if(0<e._cfg.width&&0<e._cfg.height){t=50,a=e._cfg.height-e._lab.height>>1,e._bg.setSize(e._cfg.width+100,e._cfg.height),i=e._cfg.width+100,n=e._cfg.height}else if(""!=e._iconUrl){var s=0<e._icon.width?e._icon.width:39,o=0<e._icon.height?e._icon.height:39;i=s+e._lab.width+38,n=e._lab.height+18,e._bg.setSize(i,n),t=16,a=e._bg.height-o>>1,e._icon.setPosition(16,0),t=19+(e._lab.width>>1)+s,a=e._bg.height-e._lab.height>>1,e._lab.setPosition(t,a)}else i=e._lab.width+38,n=e._lab.height+18,e._bg.setSize(i,n),t=19+(e._lab.width>>1),a=e._bg.height-e._lab.height>>1;e._lab.setPosition(t,a+1),e.setSize(i,n)}},getCfg:function(){return this._cfg},clearData:function(){var e=this;if(e._icon){e._icon.unloadTexture()}},restore:function(){var e=this;e._super(),e.setPosition(0,0)},recycle:function(){var e=this;e.clearData(),e._super()}})).pool=new b8e.Pool(t,255),t.get=function(e){return t.pool.get(e)},t.put=function(e){return e=t.pool.put(e)},b8e.RC("$$game","$$NoticeUnit",t)}(),function(){var e;e=b8e.Object.extends({_index:0,_viewY:0,_count:0,_ncTempList:null,spaceTime:30,ncOffsetY:0,ctor:function(){this._super(),this._ncTempList=[],this.tempPool=[]},addNotice:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:null;if(!this.maxLine){var n=game.NoticeCfg.getData(e);n&&(this.maxLine=n.maxLine)}var s=this.getNoticeUnit(e,t,i);s&&(this._ncTempList.length<1&&b8e.setTimeout(this._showNoticeList,this,this.spaceTime),this._ncTempList.push(s))},_showNoticeList:function(){void 0!==this.key&&(b8e.clearTimeout(this.key),this.key=void 0);for(var e=0,t=this._ncTempList;t&&0<t.length&&e<11;)e++,this._showNotice();0<t.length&&(this.key=b8e.setTimeout(this._showNoticeList,this,this.spaceTime))},_showNotice:function(){var e=this;e._container.parent||game.GameViewMgr.inst().showView(e._container,null,!1,2,!0);var t=e._ncTempList.shift(),a=t.getCfg();if(a){if(e._container.x=b8e.stageWidth/2+a.offsetX,e._container.setLocalZOrder(a.layerOrder?a.layerOrder:890),!e._ncList){e._ncList=[]}e._index++,e._viewY=b8e.stageHeight/2-a.offsetY,e._ncList.unshift(t),b8e.Tween.get(t).wait(a.showTime).to({alpha:0},a.hideTime).call(e.onTweenEnd,e,[t]),t.setPosition(-(t.width>>1),-(e._container.y-e._viewY)),t.setVisible(!0),e.ncOffsetY+=t.height+3,b8e.Tween.get(t).to({y:-e.ncOffsetY},a.moveTime);var i=a.maxLine;if(e._ncList.length>i){t=e._ncList[i],e._ncList.splice(i,1),b8e.Tween.kill(t),e.onRecycle(t)}var n=e._viewY+e.ncOffsetY;b8e.Tween.kill(e._container),b8e.Tween.get(e._container).to({y:n},a.moveTime)}},onTweenEnd:function(e){var t=this;if(t._ncList){if(t._ncList.pop(),t._ncList.length<1){t._count=0}}t.onRecycle(e)},onRecycle:function(e){if(null!=e){e.setScale(1,1),e.setAlpha(1),e.setVisible(!1),e.clearData(),this.tempPool.push(e)}},getNoticeUnit:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:"",n=void 0;if(this.tempPool.length<1){if(!(n=game.notice.getNoticeUnit(e,t,i)))return null;this._container||(this._container=b8e.BaseDisplay.get()),this._container.parent||game.GameViewMgr.inst().showView(this._container,null,!1,2,!0),n.setVisible(!1),this._container.addChild(n)}else{n=this.tempPool.shift();var s=game.NoticeCfg.getData(e);if(!s)return n;n.setVisible(!1),n.create(e,t,i),n.setLocalZOrder(s?s.layerOrder:6666)}return n}}),b8e.RC("$$game","$$NoticeView",e)}(),function(){var e;e=game.NoticeView.extends({getNoticeUnit:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:"",n=void 0;if(this.tempPool.length<1){if(!(n=game.notice.getNoticeUnit(e,t,i)))return null;this._container||(this._container=b8e.BaseDisplay.get()),this._container.parent||game.GameViewMgr.inst().showView(this._container,null,!1,0,!0),n.setVisible(!1),this._container.addChild(n)}else{n=this.tempPool.shift();var s=game.NoticeCfg.getData(e);if(!s)return n;n.setVisible(!1),n.create(e,t,i),n.setLocalZOrder(s?s.layerOrder:6666)}return n}}),b8e.RC("$$game","$$GJNoticeView",e)}(),function(){var t=void 0;(t=b8e.BaseDisplay.extends({ctor:function(){this._super(),this.init()},init:function(){var e=this._bg=b8e.Sprite.get();e.clearDisabled=!0,e.setStyle(b8e.SpriteStyle.SLICED),this.addChild(e);var t=this._lab=b8e.RichText.get();t.clearDisabled=!0,t.setHorizontalAlign(b8e.HorizontalAlign.LEFT),e.addChild(t);var a=this._iconBg=b8e.Sprite.get();a.clearDisabled=!0,a.setAnchor(.5,.5),e.addChild(a);var i=this._icon=b8e.Sprite.get();i.clearDisabled=!0,i.setAnchor(.5,.5),a.addChild(i);var n=this._animat=b8e.Animator.get(game.AnimType.UI_EFFECT,99);n.clearDisabled=!0,n.setAnchor(.5,.5),e.addChild(n);var s=this._iconEffect=b8e.Animator.get(game.AnimType.UI_EFFECT,99);s.clearDisabled=!0,s.setAnchor(.5,.5),i.addChild(s)},setViewData:function(e,t){var a=this;if(a._itemCfg=t,a.type=e,(a._noticeCfg=game.NoticeCfg.getData(e))&&t){a.setSize(a._noticeCfg.width,a._noticeCfg.height);var i=a._noticeCfg.height/2,n=a._noticeCfg.width/2;a._iconBg.setPosition(70,i),a._lab.setPosition(125,i),a._animat.setPosition(n,i),a.setBg(),a.setIconBg(),a.setIcon(),a.setLab(),a.setAnimat(),a.setIconEffect()}},setBg:function(){if(this._noticeCfg&&this._bg){var e=this._noticeCfg.url,t=this._bg;if(e){var a=game.notice.getScale9Inset(this.type);t.scale9Inset=a,t.loadTexture(e)}this._noticeCfg.width<1||this._noticeCfg.height<1?b8e.warn("\u63d0\u793a\u914d\u7f6e\u6ca1\u6709\u914d\u7f6e\u80cc\u666f\u56fe\u7247\u7684\u5bbd\u9ad8"):t.setSize(this._noticeCfg.width,this._noticeCfg.height)}},setLab:function(){if(this._noticeCfg&&this._itemCfg&&this._lab){this._noticeCfg;var e=this._itemCfg,t=this._lab;t.setFontSize(this._noticeCfg.textSize),t.setLineHeight(this._noticeCfg.textSize+2),t.setTouchable(!1),t.setAnchor(0,.5),t.setColor(game.Color.WHITE);var a="";if(e.preciousKey){var i=game.HtmlUtil.getColorStrByQuality(e.quality,e.name,!0);a=game.Lang.get(e.preciousKey,i)}t.setText(a)}},setIconBg:function(){this._itemCfg&&this._iconBg&&(this._iconBgName=game.ResCfg.getQualityBg(this._itemCfg.quality),this._iconBgUrl=game.ResCfg.getUrl(60,this._iconBgName),this._iconBg.loadTexture(this._iconBgUrl))},setIcon:function(){this._itemCfg&&this._icon&&(this._iconUrl=game.ResCfg.getUrl(137,this._itemCfg.icon),this._icon.loadTexture(this._iconUrl))},setAnimat:function(){var e=this;e._itemCfg&&e._animat?(e._preciousEffect=e._itemCfg.preciousEffect,e._preciousEffect?(e._animat.load(game.ResCfg.getUrl(5019,e._preciousEffect)),e._animat.play()):e._animat.unload()):e._animat.unload()},setIconEffect:function(){var e=this;e._itemCfg&&e._iconEffect?(e._qualityEffect=e._itemCfg.qualityEffect,e._qualityEffect?(e._iconEffect.load(game.ResCfg.getUrl(5019,e._qualityEffect)),e._iconEffect.play()):e._iconEffect.unload()):e._iconEffect.unload()},getCfg:function(){return this._noticeCfg},clearData:function(){var e=this;e.icon&&e.icon.unloadTexture(),e._lab&&(e._lab.string=""),e._iconBg&&e._iconBg.unloadTexture(),e._animat&&e._animat.unload(),e._iconEffect&&e._iconEffect.unload()},restore:function(){this._super(),this.setPosition(0,0)},recycle:function(){this.clearData(),this._super()}})).pool=new b8e.Pool(t,255),t.get=function(e){return t.pool.get(e)},t.put=function(e){return e=t.pool.put(e)},b8e.RC("$$game","$$PreciousItemsUnit",t)}(),function(){var e;e=b8e.Object.extends({_index:0,_viewY:0,_count:0,_ncTempList:null,spaceTime:30,ncOffsetY:0,ctor:function(){this._super(),this._ncTempList=[]},addNotice:function(e,t){var a=this;if(!a.maxLine){var i=game.NoticeCfg.getData(e);i&&(a.maxLine=i.maxLine)}var n=game.notice.getSpriteStatUnit(e,t);n&&(1<a._ncTempList.length?(a._ncTempList.push(n),null==a.key&&(a.key=b8e.setTimeout(a._showNoticeList,a,a.spaceTime))):(a._ncTempList.push(n),a._showNoticeList()))},_showNoticeList:function(){void 0!==this.key&&(b8e.clearTimeout(this.key),this.key=void 0);for(var e=0,t=this._ncTempList;t&&0<t.length&&e<11;)e++,this._showNotice();0<t.length&&(this.key=b8e.setTimeout(this._showNoticeList,this,this.spaceTime))},_showNotice:function(){var e=this;if(!e._container){e._container=b8e.BaseDisplay.get();var t=b8e.layer.getTopLayer();game.GameViewMgr.inst().showView(e._container,t,!1,2,!0)}var a=e._ncTempList.shift(),i=a.getCfg();if(i){if(e._container.x=b8e.stageWidth/2-i.offsetX,e._container.setLocalZOrder(i.layerOrder?i.layerOrder:890),!e._ncList){e._ncList=[]}e._index++,e._viewY=b8e.stageHeight/2-i.offsetY,e._container.addChild(a),e._ncList.unshift(a),b8e.Tween.get(a).wait(i.showTime).to({alpha:0},i.hideTime).call(e.onTweenEnd,e,[a]),a.setPosition(0,-(e._container.y-e._viewY)),e.ncOffsetY+=a.height+3,b8e.Tween.get(a).to({y:-e.ncOffsetY},i.moveTime);var n=i.maxLine;if(e._ncList.length>n){a=e._ncList[n],e._ncList.splice(n,1),b8e.Tween.kill(a),e.onRecycle(a)}var s=e._viewY+e.ncOffsetY;b8e.Tween.kill(e._container),b8e.Tween.get(e._container).to({y:s},i.moveTime)}},onTweenEnd:function(e){var t=this;if(t._ncList){if(t._ncList.pop(),t._ncList.length<1){t._count=0}}t.onRecycle(e)},onRecycle:function(e){if(null!=e){e.removeFromParent(),e.setScale(1,1),e.setAlpha(1),e.release()}}}),b8e.RC("$$game","$$SpriteStatView",e)}(),function(){var t=void 0;(t=b8e.BaseDisplay.extends({ctor:function(){this._super(),this.init()},init:function(){var e=this._bg=b8e.Sprite.get();e.clearDisabled=!0,e.setStyle(b8e.SpriteStyle.SLICED),e.setAnchor(.5,.5),this.addChild(e);var t=this._lab=b8e.Label.get();t.clearDisabled=!0,t.setHorizontalAlign(b8e.HorizontalAlign.LEFT),t.setAnchor(.5,.5),e.addChild(t)},setViewData:function(e,t){this._msg=t,this.type=e,(this._noticeCfg=game.NoticeCfg.getData(e))&&t&&(this.setSize(this._noticeCfg.width,this._noticeCfg.height),this.setLab(),this.setBg())},setBg:function(){var e=this;if(e._noticeCfg&&e._bg){var t=e._bg;if(!e.url){var a=e.url=e._noticeCfg.url;if(a){var i=game.notice.getScale9Inset(e.type);t.scale9Inset=i,t.loadTexture(a)}}if(e._noticeCfg.width<1||e._noticeCfg.height<1)b8e.warn("\u63d0\u793a\u914d\u7f6e\u6ca1\u6709\u914d\u7f6e\u80cc\u666f\u56fe\u7247\u7684\u5bbd\u9ad8");else{var n=e._noticeCfg.width,s=e._noticeCfg.height;if(e._lab&&e._lab.width)n=e._lab.width+20;t.setSize(n,s)}}},setLab:function(){var e=this._noticeCfg;if(e&&this._msg&&this._lab){var t=this._msg,a=this._lab;a.setFontSize(e.textSize),e.font&&a.setFontFile(b8e.ResMgr.UI_ROOT+"/app/font/"+e.font+".bbf"),a.setLineHeight(e.textSize+2),a.setColor(game.Color.GREEN),a.setText(t)}},getCfg:function(){return this._noticeCfg},clearData:function(){this._lab&&(this._lab.string="")},restore:function(){this._super()},recycle:function(){this.clearData(),this._super()},release:function(){t.put(this)},dispose:function(){this._super()},destroy:function(){this._super()}})).pool=new b8e.Pool(t,255),t.get=function(e){return t.pool.get(e)},t.put=function(e){return e=t.pool.put(e)},b8e.RC("$$game","$$SpriteStatUnit",t)}(),function(){var e;e=b8e.Object.extends({_index:0,_viewY:0,_count:0,_ncTempList:null,spaceTime:30,ncOffsetY:0,ctor:function(){this._super(),this._ncTempList=[]},addNotice:function(e,t,a){var i=this;if(!i.maxLine){var n=game.NoticeCfg.getData(e);n&&(i.maxLine=n.maxLine)}var s=game.notice.getPreciousItemsUnit(e,t);s&&(1<i._ncTempList.length?(i._ncTempList.push(s),null==i.key&&(i.key=b8e.setTimeout(i._showNoticeList,i,i.spaceTime))):(i._ncTempList.push(s),i._showNoticeList()))},_showNoticeList:function(){void 0!==this.key&&(b8e.clearTimeout(this.key),this.key=void 0);for(var e=0,t=this._ncTempList;t&&0<t.length&&e<11;)e++,this._showNotice();0<t.length&&(this.key=b8e.setTimeout(this._showNoticeList,this,this.spaceTime))},_showNotice:function(){var e=this;e._container||(e._container=b8e.BaseDisplay.get()),e._container.parent||game.GameViewMgr.inst().showView(e._container);var t=e._ncTempList.shift(),a=t.getCfg();if(a){if(e._container.x=b8e.stageWidth/2+a.offsetX,e._container.setLocalZOrder(a.layerOrder?a.layerOrder:890),!e._ncList){e._ncList=[]}e._index++,e._viewY=b8e.stageHeight/2-a.offsetY,e._container.addChild(t),e._ncList.unshift(t),b8e.Tween.get(t).wait(a.showTime).to({alpha:0},a.hideTime).call(e.onTweenEnd,e,[t]),t.setPosition(-(t.width>>1),-(e._container.y-e._viewY)),e.ncOffsetY+=t.height+3,b8e.Tween.get(t).to({y:-e.ncOffsetY},a.moveTime);var i=a.maxLine;if(e._ncList.length>i){t=e._ncList[i],e._ncList.splice(i,1),b8e.Tween.kill(t),e.onRecycle(t)}var n=e._viewY+e.ncOffsetY;b8e.Tween.kill(e._container),b8e.Tween.get(e._container).to({y:n},a.moveTime)}},onTweenEnd:function(e){var t=this;if(t._ncList){if(t._ncList.pop(),t._ncList.length<1){t._count=0}}t.onRecycle(e)},onRecycle:function(e){if(null!=e){e.removeFromParent(),e.setScale(1,1),e.setAlpha(1),game.PreciousItemsUnit.put(e)}}}),b8e.RC("$$game","$$PreciousItemsView",e)}(),function(){var e;e=b8e.Object.extends({_callback:null,_thisArg:null,ctor:function(e,t){this._callback=e,this._thisArg=t},syncInfo:function(){this._callback.call(this._thisArg)}}),b8e.RC("$$game","$$MainRoleSync",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_clickChallengeBtnFun:null,_clickCancelBtnFun:null,_thisArg:null,_lastType:-1,ctor:function(){this._super()},show:function(e,t,a,i){var n=1<arguments.length&&void 0!==t?t:2,s=2<arguments.length&&void 0!==a?a:null,o=3<arguments.length&&void 0!==i?i:null,r=this;switch(r.isShow&&r.hide(),r._thisArg=e,r._clickChallengeBtnFun=s,r._clickCancelBtnFun=o,r.isShow=!0,r._bg||(r._bg=b8e.Sprite.get(),r.addChild(r._bg),r._bg.loadTexture(game.ResCfg.getUrl(38))),r._bg.setVisible(1!=n),n){case 1:r._cancelBtn&&r._cancelBtn.setVisible(!1),r.addChallengeBtn(n),b8e.evt.onC(r._challengeBtn,r.onClickChallenge,r);break;case 2:case 3:r.addChallengeBtn(n),r._cancelBtn||(r._cancelBtn=b8e.Sprite.get(),r.addChild(r._cancelBtn),r._cancelBtn.loadTexture(game.ResCfg.getUrl(40))),r._cancelBtn.setVisible(!0),b8e.evt.onC(r._challengeBtn,r.onClickChallenge,r),b8e.evt.onC(r._cancelBtn,r.onClickCancel,r)}r.onLayout(n),r.setVisible(!0)},addChallengeBtn:function(e){if(this._challengeBtn||(this._challengeBtn=b8e.Sprite.get(),this.addChild(this._challengeBtn)),this._lastType!=e){var t=39;3==e&&(t=166),this._lastType,this._challengeBtn.loadTexture(game.ResCfg.getUrl(t))}this._challengeBtn.setVisible(!0)},onLayout:function(e){var t=this;switch(e){case 1:t._bg&&(t._bg.setSize(103,112),t._bg.setPosition(-75,-37)),t._challengeBtn&&t._challengeBtn.setPosition(-60,-23);break;case 2:case 3:t._bg&&(t._bg.setSize(206,112),t._bg.setPosition(-75,-37)),t._challengeBtn&&t._challengeBtn.setPosition(-60,-23),t._cancelBtn&&t._cancelBtn.setPosition(30,-23)}},hide:function(){var e=this;e._bg&&e._bg.setVisible(!1),e._challengeBtn&&(e._challengeBtn.setVisible(!1),e.isShow&&b8e.evt.offC(e._challengeBtn,e.onClickChallenge,e)),e._cancelBtn&&(e._cancelBtn.setVisible(!1),e.isShow&&b8e.evt.offC(e._cancelBtn,e.onClickCancel,e)),e&&e.setVisible(!1),e._thisArg=null,e._clickChallengeBtnFun=null,e._clickCancelBtnFun=null,e.isShow=!1},onClickChallenge:function(){this._clickChallengeBtnFun&&null!=this._clickChallengeBtnFun&&this._clickChallengeBtnFun.call(this._thisArg,this)},fnOnClickChallenge:function(e,t){this._thisArg=e,this._clickChallengeBtnFun=t},onClickCancel:function(){this._clickCancelBtnFun&&null!=this._clickCancelBtnFun&&this._clickCancelBtnFun.call(this._thisArg,this)},fnOnClickCancel:function(e,t){this._thisArg=e,this._clickCancelBtnFun=t},getIconWidth:function(){return this._bg?this._bg.width:0},getIconHeight:function(){return this._bg?this._bg.height:0}}),b8e.RC("$$game","$$ChallengeIcon",e)}(),function(){var e=b8e.Object.extends({_isShow:!1,ctor:function(){this._super()},show:function(e,t,a,i,n,s){var o=1<arguments.length&&void 0!==t?t:2,r=2<arguments.length&&void 0!==a&&a,g=3<arguments.length&&void 0!==i?i:null,l=4<arguments.length&&void 0!==n?n:null,c=5<arguments.length&&void 0!==s?s:null,h=this;if(e&&(!h._sceneEntiy||h._sceneEntiy.id!=e.id||!h._isShow))if(h._isShow&&h.hide(),h._isFixed=r,h._isShow=!0,h._sceneEntiy=e,h._thisArg=g,h._callCChallengeFun=l,h._callCCancelFun=c,r)h._sceneEntiy.showChallengeIcon(h,o,h._fnOnClickChallenge,h._fnOnClickCancel);else{if(!h._challengeIcon)h._challengeIcon=new game.ChallengeIcon,b8e.layer.getSceneLayer().addChild(h._challengeIcon);h._challengeIcon.show(h,o,h._fnOnClickChallenge,h._fnOnClickCancel),h._displaySyncInfo=new b8e.DisplaySyncInfo(h),h._sceneEntiy.addSyncInfo(h._displaySyncInfo),h.syncInfo(h._sceneEntiy),h._mainRoleSync=new game.MainRoleSync(h._updatePos,h),h._mainRoleSyncInfo=new b8e.DisplaySyncInfo(h._mainRoleSync),game.mainRole.addSyncInfo(h._mainRoleSyncInfo)}},_updatePos:function(){this._isShow&&this._sceneEntiy&&this._sceneEntiy.data&&this.syncInfo(this._sceneEntiy.localToGlobal())},syncInfo:function(e){if(e){if(this._sceneEntiy){var t=this._sceneEntiy.localToGlobal();this._challengeIcon&&this._challengeIcon.setPosition(t.x,t.y)}}else this.hide()},hide:function(){if(this._isShow){if(this._isFixed)this._sceneEntiy.hideChallengeIcon();else switch(this._clear(),this._challengeIcon&&this._challengeIcon.hide(),game.sceneData.getSceneType()){case game.SceneType.THRONE:game.throneData.removeRoleState()}this._sceneEntiy=null,this._isShow=!1}},_clear:function(){this._sceneEntiy&&!this._sceneEntiy.isRecycled&&this._sceneEntiy.removeSyncInfo(this),this._displaySyncInfo=null,this._mainRoleSync||game.mainRole.removeSyncInfo(this._mainRoleSync),this._mainRoleSync=null,this._mainRoleSyncInfo=null},_fnOnClickChallenge:function(){if(this._callCChallengeFun&&null!=this._callCChallengeFun)this._callCChallengeFun.call(this._thisArg,this);else{switch(game.sceneData.getSceneType()){case game.SceneType.THRONE:case game.SceneType.TREASURE:b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE);break;case game.SceneType.CS_BOSS:switch(game.csBossData.state){case 1:game.notice.show(734);break;case 2:b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE);break;case 3:game.notice.show(735)}break;case game.SceneType.CS_GUILD:switch(game.csGuildBossData.state){case 1:game.notice.show(734);break;case 2:case 3:b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE)}break;case game.SceneType.GUANDU_MAP:if(4==game.guanDuData.challengeId){var e=game.sceneHelper.lastSceneEntiy;game.sceneHelper.chaseEntiy=e,game.sceneHelper.calEntiyDistance(e)<=3?b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE):(game.guanDuData.isChase=!0,game.sceneHelper.moveToEntiy(e,3))}else b8e.evt.dptG(game.SceneGEvts.C2C_SHOW_ENEMY_TEAM);break;case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:this._guildWarChallange()}this.hide()}},_guildWarChallange:function(){var e=this._sceneEntiy;if(e.data&&e.data.type==game.RoleType.Tower)if(0<e.data.master)b8e.evt.dptG(game.SceneGEvts.SCENE_GUILD_WAR_SNATCH);else{var t=this._alertOptions;t=t||(this._alertOptions={lang:6535,btn:game.Lang.get(9001),okcb:this._guildWarChallangeBtn,langArgs:[game.CsMiscCfg.getData("guildWarOwnerTs").value,game.CsMiscCfg.getData("guildWarOwnerScore").value],thisArg:this}),game.alert.showTwo(t)}else b8e.evt.dptG(game.SceneGEvts.SCENE_GUILD_WAR_CHALLENGE)},_guildWarChallangeBtn:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_GUILD_WAR_CHALLENGE)},_fnOnClickCancel:function(){this._callCCancelFun&&null!=this._callCCancelFun?this._callCCancelFun.call(this._thisArg,this):this.hide()}});game.challengeIcon=game.challengeIcon||new e}(),function(){var e;e=b8e.Enum({MISS:0,NORMALHIT:1,CRITHIT:2,STUN:3,HEALTH:4,MP:5,SHIELD:7,RESPAWN:8,POISON:9,ABSORB:10,PROTECT:11,REFLECT:12,SHIELD2:13,WUSHUANG:14,EXECUTE:15,DAMAGEADVANTAGE1:16,DAMAGEADVANTAGE2:17,DOUBLE_ATTACK:20,RETURN_ATTACK:21,FOLLOW_ATTACK:121}),b8e.RC("$$game","$$BounceCharacterType",e)}(),function(){var e,t=e=b8e.BaseDisplay.extends({ctor:function(){this._super(),this.setAnchor(.5,.5),this._spPool=[],this._richTextPool=[]},create:function(e,t,a,i){this._opCb=t?{func:t,thisArg:a,args:i}:null,this.op=e,this._cfg=e.cfg,this._val=e.val,this._createCharacter()},_createCharacter:function(){var e=this;if(e.op.characterUrl){e._sprite||(e._sprite=b8e.Sprite.get()),e._sprite.loadTexture(e.op.characterUrl),e.addChild(e._sprite);var t=e._cfg,a=t.width,i=t.height;e._sprite.setSize(a,i),e._sprite.setPosition(t.characterOffsetX,t.characterOffsetY),e.setSize(a,i),e._createNumber()}else e.op.numberUrl?e._createNumber():e._onCompleteCallBack()},_createNumber:function(){var e=this,t=e._cfg;if(e.op.numberUrl){e._label||(e._label=b8e.Label.get()),e._label.setFontFile(e.op.numberUrl),e._label.setFontSize(30),e._label.setLineHeight(t.lineHeight),e._label.setText(e._val),e.addChild(e._label);var a=e._label.getWidth(),i=(e._label.getHeight(),0),n=0;e._sprite&&(i=t.width,n=t.height-t.lineHeight>>1),e._label.setPosition(i,Math.abs(n));var s=t.width+a,o=t.height;e.setSize(s,o),e._onCompleteCallBack()}else e._onCompleteCallBack()},_onCompleteCallBack:function(){if(this._opCb&&this._opCb.thisArg){var e=[this];this._opCb.args&&(e=e.concat(this._opCb.args)),this._opCb.func.apply(this._opCb.thisArg,e)}},_resetData:function(){this.op=null,this._cfg=null,this._val=0},restore:function(){this._super(),this._resetData()},recycle:function(){this._resetData(),this._super()},release:function(){var e=this;e._resetData(),e._sprite&&(e._sprite.clear(),e._sprite.setSize(0,0),e._sprite.setScale(1,1),e._sprite.removeFromParent()),e._label&&(e._label.setText(""),e._label.setFontFile(null),e._label.removeFromParent()),e.removeFromParent(),e.constructor===t?t.put(e):e.destroy()},destroy:function(){this._resetData(),this._super()},dispose:function(){this._resetData(),this._super()}}),a=new b8e.Pool(t,64);t.get=function(){return a.get()},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$BounceCharacterUnit",e)}(),function(){var e,t=e=b8e.PoolObject.extends({val:0,speedRatio:1,cfg:null,releaseRole:null,characterUrl:null,numberUrl:null,isLoaded:!1,ctor:function(){this._super()},reset:function(){this.cfg=null,this.val=0,this.releaseRole=null,this.speedRatio=1,this.numberUrl=null,this.characterUrl=null,this.isLoaded=!1},restore:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},release:function(){this.constructor===t?t.put(this):this.destroy()},dispose:function(){this.cfg=null,this.val=null,this.releaseRole=null,this.speedRatio=null,this.numberUrl=null,this.characterUrl=null,this.isLoaded=null,this._super()}});b8e.BindingUtil.bind(t);var a=new b8e.Pool(t,64);t.get=function(e){return a.get(e)},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$BounceCharacterInfo",e)}(),function(){var e=void 0,t=e=b8e.Object.extends({ctor:function(){if(e._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6SoundManager\u5b9e\u4f8b\uff01");this._loadList=b8e.HashMap.get(),this._super()},showHurt:function(e,t,a,i,n){var s=3<arguments.length&&void 0!==i?i:1,o=4<arguments.length&&void 0!==n?n:0;if(game.playBackScene.scene)if(a)if(null!=e){0==s&&(b8e.warn("\u4f24\u5bb3\u98d8\u5b57\u4f20\u8fc7\u6765\u7684speedRatio\u600e\u4e48\u4e3a\uff1a0 \uff01\uff01\uff01",t),s=1);var r=game.BounceCharacterCfg.getData(t);if(r){var g=game.BounceCharacterInfo.get();g.cfg=r,g.val=e,g.speedRatio=s,g.releaseRole=a,g.speedRatio=s,g.x=a.x,g.y=a.y;var l=a.scaleX||1,c=a.scaleY||1,h=a.getHpBindNode();h&&(g.hpBindeNodeX=h.x,g.hpBindeNodeY=h.y),g.scaleX=l,g.scaleY=c,g.mountOffsetY=0,a.getIsRide()&&a.data&&a.data.heroModel&&(g.mountOffsetY=Math.abs(a.data.heroModel.mountOffsetY)),game.playBack.copyType==game.InstanceType.GUILD_INS&&a.type==game.RoleType.Monster&&(game.playBack.dmgAllValue+=e,game.playBack.dmgAllValue>game.playBack.maxDmg&&(game.playBack.dmgAllValue=game.playBack.maxDmg),b8e.evt.dptG(game.InstanceEvts.C_UPDATE_BOSS_DAMGE,game.playBack.dmgAllValue)),game.playBack.copyType==game.InstanceType.GUILD_NEW_BOSS&&a.type==game.RoleType.Monster&&(game.guildNewBossData.dmgValue+=e,b8e.evt.dptG(game.InstanceEvts.C_UPDATE_GUILD_NEW_BOSS_DMG,game.guildNewBossData.dmgValue)),0<o?b8e.Tween.get(this).wait(o/s).call(this._showHurtCall,this,[g]):this._showHurtCall(g)}else b8e.warn("\u5ba2\u6237\u7aef\u6e38\u620f\u4f24\u5bb3\u98d8\u5b57\u914d\u7f6e\uff0c\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u7c7b\u578b\u914d\u7f6e--type\uff1a",t)}else b8e.warn("\u4f24\u5bb3\u98d8\u5b57\u4f20\u8fc7\u6765\u7684value\u600e\u4e48\u662f\u4e00\u4e2aundefined\uff01\uff01\uff01",t);else b8e.warn("\u98d8\u5b57\u76ee\u6807\u4e0d\u5b58\u5728\uff01");else b8e.warn("\u573a\u666f\u6ca1\u6709\u521d\u59cb\u5316\u5c31\u5f00\u59cb\u98d8\u5b57\u4e86\u3002")},_showHurtCall:function(e){var t=e.cfg;t.atlas&&(e.numberUrl=game.ResCfg.getUrl(4304,t.atlas+"/"+t.atlas)),t.character&&(e.characterUrl=game.ResCfg.getUrl(4303,t.character)),this._onStartTween(e)},_onStartTween:function(e){var t=game.BounceCharacterUnit.get();this._viewDisplay||(this._viewDisplay=game.playBackScene.scene.getViewDisplay(),this._bcContainer=b8e.BaseDisplay.get(),this._viewDisplay.addChild(this._bcContainer),this._bcContainer.setLocalZOrder(9999)),t.create(e,this._onCreateCallBack,this,[e])},_onCreateCallBack:function(e,t){var a=t.cfg,i=t.x,n=t.y;i+=t.hpBindeNodeX*t.scaleX,n+=t.hpBindeNodeY*t.scaleY,n+=t.mountOffsetY;var s=game.playBackScene.scene.sceneGLToViewGLPos(i,n),o=game.BounceCharacterTweenCfg.getData(a.tweenId);if(o){var r=s.x+o.startOffsetX-.5*e.width,g=s.y+o.startOffsetY;e.setPosition(r,g),e.setAlpha(1);var l=r+o.offsetX,c=g+o.offsetY,h=c+o.moveDistance,m=t.speedRatio;this._bcContainer.addChild(e),b8e.Tween.kill(e),b8e.Tween.get(e).to({x:l,y:c,scaleX:o.afterScale,scaleY:o.afterScale},o.afterScaleTime/m,b8e.Ease.quadIn).to(null,o.afterStagnationTime/m,b8e.Ease.quadIn).to({scaleX:o.agoScale,scaleY:o.agoScale},o.agoScaleTime/m,b8e.Ease.quadIn).to(null,o.agoStagnationTime/m,b8e.Ease.quadIn).to({y:h,alpha:.5},o.moveTime/m).call(this._onEndTween,this,[e,t])}},_onEndTween:function(e,t){e&&e.release(),t&&t.release()},clear:function(){if(this._bcContainer){var e=this._bcContainer.children;e&&e.forEach(function(e){e&&(b8e.Tween.kill(e),e.op&&e.op.release(),e.release())})}}});t._instance=null,t._singleton=!0,t.inst=function(){return t._instance||(t._singleton=!1,t._instance=new t,t._singleton=!0),t._instance},b8e.RC("$$game","$$BounceCharacterMgr",e)}(),function(){var t=game.PlayBackAvatarUtil=function(){};t.update=function(e){e&&e.data&&e.data.avatar&&(t.updateBody(e),t.updateNickName(e),t.updateMount(e),t.updateAvatar(e,game.AnimType.WEAPON),t.updateAvatar(e,game.AnimType.WING),t.updateAvatar(e,game.AnimType.HALO))},t.updateAvatar=function(e,t){e&&e.data&&e.data.avatar&&game.AvatarUtil.doUpdateAvatar(e,t)},t.updateBody=function(e){game.AvatarUtil.updateBody(e)},t.updateNickName=function(e){e&&e.updateNickName()},t.updateRoleEffect=function(e,t){game.AvatarUtil.updateRoleEffect(e,t)},t.updateMount=function(e){game.AvatarUtil.updateMount(e)}}(),function(){var e=b8e.Object.extends({isInit:!1,usable:!0,speedRatio:1,hitMoveTime:0,hitWaitTime:0,hitBackTime:0,combineEffect:null,godAnimalEffect:null,copyType:1,dmgAllValue:0,maxDmg:0,ctor:function(){this.infoList=[],this._instId=1,this.speed=[0,0],this.formation=[0,0],this.monsterArr=[],this.copyType=0,this.dmgAllValue=0},init:function(){var e=this;if(!e.isInit){var t=void 0;e.hitMoveTime<1&&(t=game.BattleMiscCfg.getData("hitMoveTime"),e.hitMoveTime=t?+t.value:20),e.hitWaitTime<1&&(t=game.BattleMiscCfg.getData("hitWaitTime"),e.hitWaitTime=t?+t.value:300),e.hitBackTime<1&&(t=game.BattleMiscCfg.getData("hitBackTime"),e.hitBackTime=t?+t.value:50),t=game.BattleMiscCfg.getData("enterSpeed"),game.playBackCreate.speedRatio=t?+t.value:1,e.combineEffect=new game.CombineEffect,e.godAnimalEffect=new game.GodAnimalEffect,e.isInit=!0}},combinePos:{get:function(){if(!this._combinePos){this._combinePos=[];var e=game.BattleMiscCfg.getData("combinePos");if(e)for(var t=e.value.split("#"),a=0,i=t.length;a<i;a++){for(var n=t[a].split("|"),s=[],o=0,r=n.length;o<r;o++){var g=n[o].split(",");s.push({x:+g[0],y:+g[1]})}this._combinePos.push(s)}}return this._combinePos}},play:function(e,t){var a=this;if(game.playBackFormationData.setModule(0,0),e&&e.units&&!(e.units.length<1)){a.setMonsterArr(e,t),a.init(),game.taskData.isAutoPass&&t.type>game.InstanceType.CHUANG_GUAN&&game.taskData.endAutoPass();var i=game.PlayBackData.get();i.setData(e,t),a.isFighting?a._isNomalBattle(a.options)&&!a._isNomalBattle(t)?(a.infoList.unshift(i),a.stop()):a.infoList.push(i):(a.infoList.push(i),a._begin())}},setMonsterArr:function(e,t){if(this.copyType=t.type,this.maxDmg=t.damage,t.type==game.InstanceType.GUILD_INS)for(var a=e.units,i=a.length,n=this.monsterArr,s=void(n.length=0),o=0;o<i;o++)(s=a[o]).type==game.RoleType.Monster&&n.push(s.id)},stop:function(){b8e.Tween.kill(this),this._waitStop()},stopAll:function(){this.infoList.length=0,b8e.Tween.kill(this),this._waitStop()},_begin:function(){var e=this;if(!(e.infoList.length<1)){var t=e.infoList.shift();if(t){var a=t.info,i=t.options;e.isFighting=!0,e.info=a,e.info.instId=e._getInstId(),e.options=i,e.options.win=a.win,e.options.maxRound=a.roundLimit,e.startCastIndex=0,e.actionIndex=0,e.setFormationAndSpeed(a.units),e._switchScene(i),game.scene.clearBattleState(),t.release()}}},setFormationAndSpeed:function(e){var t=this;if(t.formation[0]=0,t.formation[1]=0,t.speed[0]=0,t.speed[1]=0,e)for(var a=void 0,i=0,n=e.length;i<n;i++){if(0<t.speed[0]&&0<t.speed[1]&&0<t.formation[0]&&0<t.formation[1])return;(a=e[i]).attack?(t.speed[1]=a.speed,t.formation[1]=a.formation):(t.speed[0]=a.speed,t.formation[0]=a.formation)}},_switchScene:function(e){b8e.evt.dptG(game.InstanceEvts.G_START_PLAY,e),this.scene.clearEntity(),game.playBackScene.activeScene(e,this._activeSceneComplete,this)},_activeSceneComplete:function(){if(this.isFighting){var e=this.options,t=this.info;e.type&&e.type!=game.InstanceType.NORMAL&&game.GameLevelMgr.inst().setPlayBackMode(!0,e.type),game.playBackCreate.createRole(t.units,e.turn,this._createRoleComplete,this)}},_createRoleComplete:function(){this.isFighting&&this.checkBossShow()},_waitStart:function(){b8e.Tween.kill(this),b8e.Tween.get(this).wait(500).call(this._startStateMachine,this)},_startStateMachine:function(){this.options.wait||this.stateMachine.start()},_waitStop:function(){var e=this;e.isFighting&&(e.combineEffect&&e.combineEffect.setVisible(!1),e.godAnimalEffect&&e.godAnimalEffect.setVisible(!1),e.isFighting=!1,e.action=null,e.options&&e.options.type&&e.options.type!=game.InstanceType.NORMAL&&game.GameLevelMgr.inst().setPlayBackMode(!1,e.options.type),game.playBackScene.unactiveScene(),e.monsterArr.length=0,e.copyType=0,e.dmgAllValue=0,e.maxDmg=0,b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,e.options),b8e.Tween.kill(e),e._begin())},haveNextAction:function(){return!(!this.info||!this.info.actions||this.actionIndex>=this.info.actions.length)},startAction:function(){this.haveNextAction()&&(this.action=this.info.actions[this.actionIndex],b8e.evt.dptG(game.InstanceEvts.G_ROUND_CHANGE,{round:this.action.round,maxRound:this.info.roundLimit}),this.castIndex=0)},playNextAction:function(){this.actionIndex++,this.startAction()},playSkill:function(e,t){if(this.action){var a=this.action.spellCast;!a||a.length<1?e.call(t,!1):this._playSkill(a[this.castIndex],e,t)}else e.call(t,!1)},_playSkill:function(e,t,a){var i=this;if(i.isFighting)if(i.spellCast=e,i.spellCast){for(var n=void 0,s=void 0,o=void 0,r=0,g=i.spellCast.targets,l=g.length,c=0;c<l;c++)if((n=g[c])&&(o=n.effect)&&0!=n.unitId&&0<o.value){if(!(s=i.scene.getDisplayById(n.unitId)))continue;b8e.evt.dptG(game.InstanceEvts.G_SKILL_HIT,{roleId:s.data.configId,value:o.value,roleData:s.data}),r+=o.value}var h=game.SkillCfg.getData(i.spellCast.spellId);if(h.group||(i.releaseRole=i.scene.getDisplayById(i.spellCast.unitId),i.releaseRole&&i.releaseRole.data)){var m=i.combineRoles,u=void 0;m||(i.combineRoles=m=[]);for(var d=m.length=0,f=i.spellCast.combine.length;d<f;d++)(u=i.scene.getDisplayById(i.spellCast.combine[d]))&&u.data&&m.push(u);var p=void 0;i.releaseRole&&(p=i.releaseRole.data).isAttack&&b8e.evt.dptG(game.InstanceEvts.G_SKILL_RELEASE,r),i._playSkillCallBack(h,p,e,t,a)}else t.call(a,!1)}else t.call(a,!1);else t.call(a,!1)},_playSkillCallBack:function(e,t,a,i,n){if(!e)return b8e.warn("\u6ca1\u6709\u627e\u5230\u670d\u52a1\u5668\u6280\u80fd\uff1a",a.spellId),void i.call(n,!1);var s=t&&!t.isMale?e.clientSkill2:e.clientSkill;if(this.skillCfg=game.ClientSkillCfg.getData(s),!this.skillCfg)return b8e.warn("\u6ca1\u6709\u627e\u5230\u5ba2\u6237\u7aef\u6280\u80fd\u8868\u73b0\uff1a",s),void i.call(n,!1);i.call(n,!0)},playNextSkill:function(){this.castIndex++},getNextSkill:function(){return this.isFighting&&this.action&&this.action.spellCast?this.action.spellCast[this.castIndex+1]:null},haveNextSkill:function(){return!(!this.action||this.castIndex>=this.action.spellCast.length)},checkAttachEffect:function(){if(!this.info)return!1;var e=this.info.actions;if(!e)return!1;for(var t=void 0,a=void 0,i=this.actionIndex+1,n=this.info.actions.length;i<n;i++)if((t=e[i]).type==game.PlayBackActionType.SpellCast&&(a=t.spellCast)&&!(a.length<1))return 0<a[0].attachEffect;return!1},checkRespawn:function(e){if(!this.info)return!1;var t=this.info.actions;if(!t)return!1;var a=t[this.actionIndex+1];if(!a||a.type!=game.PlayBackActionType.Buff)return!1;var i=a.buffs[0];if(!i)return!1;if(i.unitId!=e)return!1;var n=i.effects[0];return n&&n.type==game.BounceCharacterType.RESPAWN},scene:{get:function(){return game.playBackScene.scene}},_stateMachine:null,stateMachine:{get:function(){return this._stateMachine||(this._stateMachine=new game.PlayBackStateMachine(this)),this._stateMachine}},startStateMachine:function(){this.options.wait&&(this.options.wait=!1,b8e.Tween.kill(this),this.stateMachine.start())},stopStateMachine:function(){this.options&&(b8e.Tween.kill(this),this._isNomalBattle(this.options)&&0!=this.infoList.length?this._waitStop():b8e.Tween.get(this).wait(500).call(this._waitStop,this))},getCurInstType:function(){if(this.options){return this.options.type}return null},_getInstId:function(){return++this._instId},_isNomalBattle:function(e){return!e||e.type==game.InstanceType.NORMAL},isInstanceFighting:function(e){var t=!(0<arguments.length&&void 0!==e)||e;if(!this.isFighting)return!1;var a=!this._isNomalBattle(this.options);return a&&t&&game.notice.show(709),a},getMosterElement:function(e,t){var a=this.info;if(a&&a.units&&!(a.units.length<1)){for(var i=a.units,n=i.length,s=void 0,o=0;o<n;o++)if((s=i[o])&&s.type==game.RoleType.Monster)return void e.call(t,s.roleId);e.call(t,0)}},getElementMaxNum:function(e){var t=this.info;if(!t||!t.units||t.units.length<1)return null;this.elementMap||(this.elementMap=b8e.HashMap.get()),this.elementMap.clear();for(var a=t.units,i=a.length,n=void 0,s=void 0,o=0,r=0;r<i;r++)if(s=(n=a[r]).element,n&&0!=s&&n.attack==e){this.elementMap.get(s)||this.elementMap.set(s,0);var g=this.elementMap.get(s);g++,this.elementMap.set(s,g),o<g&&(o=g)}var l=this.elementMap.values();return l.sort(function(e,t){return t-e}),game.partnerData.getElemeltFettersCfg(l)},checkBossShow:function(){for(var a=this.info.units,i=this.copyType+"",e=function(t){a[t].type==game.RoleType.Monster&&game.MonsterCfg.getDataAsync(a[t].roleId,function(e){e?e.type&&e.isShow&&-1!=e.isShow.split("_")[1].split("|").indexOf(i)&&game.BossShowMgr.inst().pushShowArr(a[t].roleId):b8e.error("\u602a\u7269\u4e0d\u5b58\u5728id: ",a[t].roleId)})},t=0,n=a.length;t<n;t++)e(t);game.BossShowMgr.inst().startShow(this._waitStart,this)}});game.playBack=game.playBack||new e}(),function(){var e=b8e.Object.extends({ctor:function(){this.unitsMap=b8e.HashMap.get(),this._needCreateCount=0,this._createCompleteCount=0,this.speedRatio=1},createRole:function(e,t,a,i){if(game.playBack.isFighting&&e&&!(e.length<1)){this.unitsMap.clear(),this._isCreateAttacker=!1,this._isCreateTargeter=!1;var n=this._needCreateCount=e.length;this._createCompleteCount=0,this._onCreateComplete=a,this._thisArg=i;for(var s=void 0,o=void 0,r=game.playBackScene.scene,g=0;g<n;g++)(s=e[g])&&(o=b8e.SceneTask.get(s,this._callCRSceneTask,this,[s,t]),r.addCreateTask(o))}},_callCRSceneTask:function(e,t){if(game.playBack.isFighting){game.RoleData.get().setData(e,t,this._callCreateRoleSetData,this)}},_callCreateRoleSetData:function(e){if(game.playBack.isFighting){var t=game.playBackScene.scene;this._createCompleteCount++;var a=this._createRole(e,t);a.transition(game.RoleStateType.ACTION_IDLE);var i=this.unitsMap.get(e.posType);i||(i={},this.unitsMap.set(e.posType,i)),i[e.pos]=e.id;var n=game.playBackScene.getViewOffset(),s=n.x,o=n.y,r=s+e.createPos.x,g=o-e.createPos.y;game.moveTo.fly(a,{x:r,y:g},this.speedRatio)}},createNewRole:function(e,t,a,i,n,s){if(game.playBack.isFighting){if(this._callCNRole=i,this._callCNRoleThisArg=n,this._callCNRoleArgs=s,e&&0!=e.length)for(var o=this._needCreateCount=e.length,r=void(this._createCompleteCount=0),g=void 0,l=game.playBackScene.scene,c=0;c<o;c++)(r=e[c])&&(g=b8e.SceneTask.get(r,this._callCNRSceneTask,this,[r,t,a]),l.addCreateTask(g));else i&&i.apply(n,s)}},_callCNRSceneTask:function(e,t,a){if(game.playBack.isFighting){game.RoleData.get().setData(e,t,this._callCNRoleSetData,this,a)}},_callCNRoleSetData:function(e,t){if(game.playBack.isFighting){var a=this,i=game.playBackScene.scene;a._createCompleteCount++;var n=a.unitsMap.get(e.posType);if(n&&n[e.pos]){var s=n[e.pos];i.removeDisplayById(s)}a._createCompleteCount==a._needCreateCount&&a._callCNRole&&a._callCNRole.apply(a._callCNRoleThisArg,a._callCNRoleArgs);var o=a._createRole(e,i);o.transition(game.RoleStateType.ACTION_IDLE),n||(n={},a.unitsMap.set(e.posType,n)),n[e.pos]=e.id;var r=game.playBackScene.getViewOffset(),g=r.x,l=r.y,c=g+e.createPos.x,h=l-e.createPos.y;t?game.moveTo.fly(o,{x:c,y:h},a.speedRatio):o.setScenePosition(c,h)}},_createRole:function(e,t){if(game.playBack.isFighting){var a=t.getDisplayByTypeAndId(e.type,e.id);a&&t.removeDisplayByTypeAndId(e.type,e.id),a=game.PlayBackRole.get(e.type,e.id);var i=e.config;if(e.type==game.RoleType.Monster&&i){var n=i.scale?i.scale:1;a.setScale(n,n)}a.data=e,a.isUniqueId=!0,a.clearDisabled=!1,a.setTouchable(!1);var s=game.playBackScene.getViewOffset(),o=e.birthPos.x+s.x,r=-e.birthPos.y+s.y;return a.setScenePosition(o,r),a.setDirection(game.Direction.getAnimatDirection(e.direction)),a.setSceneVisitCallback(this._calSceneVisitCallback,this,[a,e]),a.updateHpBar(),a.updateMpBar(),t.addDisplay(a,void 0,!0,e.configId!=game.mainRoleData.roleId,!1),a}},_calSceneVisitCallback:function(e,t){if(game.playBack.isFighting){var a=this,i=game.RoleType,n=game.PlayBackAvatarUtil;switch(t.type){case i.Hero:n.update(e),e.updateName(t.quality);break;case i.Partner:n.update(e);break;case i.Monster:n.updateBody(e);var s=t.config;s&&1==s.type&&n.updateRoleEffect(e,game.AnimType.BOSS_EFFECT);break;default:n.updateBody(e)}e.updateHpBar(),e.updateMpBar(),e.data&&0<e.data.hp?e.transition(game.RoleStateType.ACTION_IDLE):e.transition(game.RoleStateType.ACTION_DEATH),e.data.isAttack?a._isCreateAttacker=!0:a._isCreateTargeter=!0,a._isCreateAttacker&&a._isCreateTargeter&&a._createCompleteCount==a._needCreateCount&&a._onCreateComplete&&a._thisArg&&(a._onCreateComplete.call(a._thisArg),a._onCreateComplete=null,a._thisArg=null)}},_updateAnimAvatar:function(e){e&&e.data&&e.data.heroModel}});game.playBackCreate=game.playBackCreate||new e}(),function(){var e=b8e.Object.extends({_scene:null,isSceneShow:!1,ctor:function(){this._super(),this.bgWidth=960,this.bgHeight=1600,this._isChange=!1,this._sceneSize={width:720,height:1280},this._designPosSize={width:720,height:1280},b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageResize)},activeScene:function(e,t,a){var i=this,n=i._scene;if(n){i.options=e,b8e.scene.getEntityLayer().setVisible(!1),i.isSceneShow=!0;var s=e.scene;if(s)return i._isChange=!0,void i._showOptionScene(s,t,a);i._sceneSize;var o=!1;if(i._config?i._isChange&&(i._isChange=!1,i._setDefaultMapConfig(),o=!0):(i._setDefaultMapConfig(),o=!0),n.startRender(),e.type!=game.InstanceType.NORMAL){var r=game.InstanceSuccessCfg.getData(e.type);if(r&&r.fightBgm){var g=game.ResCfg.getUrl(4200,r.fightBgm);b8e.SoundMgr.inst().playBackgroundMusic(g)}}i._addSceneBg(o,t,a)}},_setDefaultMapConfig:function(){var e=this,t=e._scene;e._config||(e._config={}),e._config.mapWidth=720,e._config.mapHeight=1280,e._sceneSize.width=720,e._sceneSize.height=1280,t.soundEffectsEnabled=!1,t.setMapConfig(null,e._config),t.getCamera().setFocus(e._sceneSize.width>>1,e._sceneSize.height>>1)},unactiveScene:function(){if(this._scene){if(this._scene.clearEntity(),this._scene.stopRender(),game.exploreScene.isInExploreScene()){var e=game.ResCfg.getUrl(10182);b8e.SoundMgr.inst().playBackgroundMusic(e,!0)}else b8e.scene.getEntityLayer().setVisible(!0,!1),b8e.scene.playMusic();this.isSceneShow=!1;var t=this._getSceneBg();t&&t.parent&&t.removeFromParent()}},_showOptionScene:function(e,t,a){this._loadComplete=t,this._thisArg=a;var i=this._scene;i.soundEffectsEnabled=!0,i.loadMap(e,this._onLoadMapComplete,this)},_onLoadMapComplete:function(e,t){if(e)b8e.error("\u52a0\u8f7d\u56de\u653e\u5730\u56fe\u6570\u636e\u5931\u8d25",e);else{var a=this,i=b8e.scene.getMapLayer().getEarthSurface().getThumbUrl();if(a._batchList?a._batchList.length=0:a._batchList=[],i&&""!=i){var n=a._getBatchObj(i);a._batchList.push(n)}0<a._batchList.length&&b8e.res.loadBatchRes(a._batchList,a.batchLoadProcess,a,null,!0),t.startRender();var s=t.getSceneSize();s&&(a._sceneSize.width=s.width,a._sceneSize.height=s.height);var o=b8e.scene.getViewSize();t.setSize(o.width,o.height),t.getCamera().setFocus(a._sceneSize.width>>1,a._sceneSize.height>>1),a._addSceneBg(!0,a._loadComplete,a._thisArg)}},batchLoadProcess:function(e,t,a,i){e&&game.loadingPage.setErrorText(game.LanguageData.get(78)),a==i&&(this._recycleBatchObj(),this._batchList.length=0)},_getBatchObj:function(e){var t=void 0;return this._batchObjPool&&0<this._batchObjPool.length?(t=this._batchObjPool.shift()).url=e:t={url:e,type:b8e.SpriteFrame},t},_recycleBatchObj:function(){if(this._batchList){this._batchObjPool||(this._batchObjPool=[]);for(var e=void 0;this._batchList.length;)(e=this._batchList.shift())&&(e.url=null,this._batchObjPool.push(e))}},_addSceneBg:function(e,t,a){var i=0<arguments.length&&void 0!==e&&e,n=t,s=a,o=this._getSceneBg();i&&o&&o.parent&&o.removeFromParent();var r=this._scene.getMapLayer();if(r){var g=r.getContainer();g&&(o.parent||(o.alpha=0,o.scaleX=3,o.scaleY=3,this.onStageResize(),b8e.Tween.get(o).to({alpha:1,scaleX:1,scaleY:1},150).call(n,s),g.addChild(o)))}},_getSceneBg:function(){var e=this._sceneBg;return e||((e=this._sceneBg=b8e.Sprite.get()).lazyInHierarchy=!1,e.isLazy=!1,e.setAnchor(.5,.5),e.loadTexture(game.ResCfg.getUrl(10019))),e},scene:{get:function(){this._scene||(this._scene=b8e.SceneMgr.inst().createScene("playBack",b8e.layer.getSceneLayer()),this._scene.autoCenter(!0),this._scene.getViewDisplay().setLocalZOrder(5));return this._scene}},getViewOffset:function(){var e=this,t=e._scene;return e._offsetObj||(e._offsetObj={x:0,y:0}),t&&(e._offsetObj.x=e._sceneSize.width-e._designPosSize.width>>1,e._offsetObj.y=e._sceneSize.height-(e._sceneSize.height-e._designPosSize.height>>1)),e._offsetObj},getDisplayById:function(e){var t=this._scene,a=game.RoleType,i=t.getDisplayByTypeAndId(a.Hero,e);return(i=(i=i||t.getDisplayByTypeAndId(a.Partner,e))||t.getDisplayByTypeAndId(a.Monster,e))||t.getDisplayById(e)},resetSceneBgPos:function(){if(this._scene&&this._sceneBg){var e=this._sceneSize;if(!e)return;var t=(e.width-this.bgWidth>>1)+.5*this.bgWidth,a=.5*this.bgHeight+(e.height-this.bgHeight>>1);this._sceneBg.setPosition(t,a)}},onStageResize:function(){this._scene&&this._scene.setSize(b8e.stageWidth,b8e.stageHeight),this.resetSceneBgPos()}});game.playBackScene=game.playBackScene||new e}(),function(){var e=b8e.Object.extends({callBack:function(e,t){this._callBack=e,this._callBackThis=t},show:function(){var e=this;e.bossContainer||(e.bossContainer=b8e.Sprite.get(),e.bossContainer.setAnchor(.5,.5),e.bossAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.bossAnim.addToParent(e.bossContainer),e.bossAnim.load(game.ResCfg.getUrl(5019,1075))),e.bossAnim.play();var t=b8e.stageWidth/720;e.bossContainer.setScale(t,t),e.bossContainer.x=-(b8e.stageWidth>>1),e.bossContainer.y=b8e.stageHeight>>1,game.GameViewMgr.inst().showView(e.bossContainer),b8e.Tween.get(e.bossContainer).to({x:b8e.stageWidth>>1},100).wait(800).to({x:b8e.stageWidth+(b8e.stageWidth>>1)},100).call(e.hide,e)},hide:function(){var e=this.bossContainer;e&&(e.removeFromParent(),b8e.Tween.kill(e));var t=this.bossAnim;t&&t.stop(),this._callBack&&this._callBackThis&&this._callBack.call(this._callBackThis)}});game.playBackStart=game.playBackStart||new e}(),function(){var e=b8e.Object.extends({target:null,pick:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t;if((this.target=e)&&a){var i=this.target.data;if(i)switch(i.type){case game.RoleType.Monster:b8e.evt.dptG(game.SceneGEvts.CLICK_MONSTER,i.id)}}}});game.scenePick=game.scenePick||new e}(),function(){var e=b8e.Object.extends({createMainRole:function(){return this.createHero(game.mainRoleData,!0)},createHero:function(e,t,a,i,n){var s=1<arguments.length&&void 0!==t&&t,o=2<arguments.length&&void 0!==a?a:null,r=3<arguments.length&&void 0!==i?i:null,g=4<arguments.length&&void 0!==n?n:0,l=game.SceneRole.get(e.type,e.id);return l.data=e,l.isUniqueId=!0,l.clearDisabled=e.isSelf,l.setTouchable(s),l.setScenePosition(e.createPos.x,e.createPos.y),l.setSceneVisitCallback(this._calCreateHero,this,[l,o,r]),b8e.scene.addDisplay(l,void 0,!1,!e.isSelf,!e.isSelf,g),l},_calCreateHero:function(e,t,a){game.AvatarUtil.update(e),a&&a.call(t,e)},create:function(e,t,a){if(!e||!e.data)return null;var i=e.getScene();if(i){var n=e.data,s=n.id,o=i.getDisplayByTypeAndId(t,s);if(!o){o=game.Follower.get(t,s);var r=game.BaseRoleData.get(t,s);r.isSelf=n.isSelf,o.data=r,o.clearDisabled=n.isSelf,o.setTouchable(!1);var g=e.getScenePosition();o.setScenePosition(g.x,g.y);var l=game.FollowCfg.getUData(t);l&&l.isFlyFollow&&o.setFollowTarget(e,l.distance),o.setSceneVisitCallback(this._calCreate,this,[o]);var c=game.mainRoleData.roleId!=s;i.addDisplay(o,a,c,c,!n.isSelf)}return o}},_calCreate:function(e){game.AvatarUtil.updateAvatar(e,e.type)},createUIRole:function(e){var t=game.BaseRole.get(game.RoleType.UIRole,e.id);return t.data=e,t.clearDisabled=!1,t.setTouchable(!1),t},createMonsterRole:function(e,a,i){var n;return(n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e))&&b8e.scene.removeDisplay(n),(n=game.SceneRole.get(game.RoleType.Monster,e)).data=game.RoleData.get(game.RoleType.Monster,e),e<=0&&b8e.warn("monsterId <= 0, monId: ",e),game.CfgUtil.getMosterModelId(e,function(t){e||b8e.error("\u602a\u7269\u7ec4\u4e0d\u5b58\u5728id: ",e),game.MonsterCfg.getDataAsync(t,function(e){e?(n.data.heroModel.setBody(game.RoleType.Monster,e.model),n.isUniqueId=!0,n.clearDisabled=!1,n.setTouchable(!0),n.setScenePosition(a,i),n.setDirection(game.Direction.getAnimatDirection(game.Direction.DownLeft)),n.setSceneVisitCallback(function(){game.AvatarUtil.update(n)},n),b8e.scene.addDisplay(n,void 0,!0,!0,!0)):b8e.error("\u602a\u7269\u4e0d\u5b58\u5728id: ",t)})},n),n},createMonsterUnit:function(t,a,i){var n=this,s=game.SceneRole.get(game.RoleType.Monster,t.id);s.data=game.RoleData.get(game.RoleType.Monster,t.id),s.data.configId=t.roleId,s.data.hp=t.hp||0,s.data.maxHp=t.maxHp||0,s.data.ownerId=t.ownerId||0;var o=t.roleId;game.MonsterCfg.getDataAsync(o,function(e){e?(s.data.heroModel.setBody(game.RoleType.Monster,e.model),s.isUniqueId=!0,s.clearDisabled=!1,s.setTouchable(!0),s.setScenePosition(t.createPos.x,t.createPos.y),s.setDirection(game.Direction.getAnimatDirection(t.direction)),s.setSceneVisitCallback(n._calCreateMonsterUnit,n,[s,a,i]),b8e.scene.addDisplay(s,void 0,!1,!0,!0)):b8e.error("\u602a\u7269\u4e0d\u5b58\u5728id: ",o)},n)},_calCreateMonsterUnit:function(e,t,a){game.AvatarUtil.updateBody(e),t&&t.call(a,e)},createBoxUnit:function(e){var t=game.SceneRole.get(game.RoleType.Collect,e.id);t.data=game.RoleData.get(game.RoleType.Collect,e.id),t.data.roleId=e.roleId;var a=e.roleId,i=game.BoxCfg.getData(a);i?(t.data.heroModel.setBody(game.RoleType.Collect,i.model),t.isUniqueId=!0,t.clearDisabled=!1,t.setTouchable(!0),t.setScenePosition(e.createPos.x,e.createPos.y),t.setDirection(game.Direction.getAnimatDirection(game.Direction.Down)),t.setSceneVisitCallback(this._calCreateBoxUnit,this,[t]),b8e.scene.addDisplay(t,void 0,!1,!0,!0)):b8e.error("\u5b9d\u7bb1\u4e0d\u5b58\u5728id: ",a)},_calCreateBoxUnit:function(e){game.AvatarUtil.updateBody(e)},createTower:function(e,t,a,i){var n=1<arguments.length&&void 0!==t?t:null,s=2<arguments.length&&void 0!==a?a:null,o=3<arguments.length&&void 0!==i?i:null,r=e.roleId,g=game.ClientTowerGenCfg.getData(r);if(!g)return b8e.error("\u5efa\u7b51\u4e0d\u5b58\u5728id: ",r),null;var l=game.SceneRole.get(game.RoleType.Tower,e.id);return l.data=game.RoleData.get(game.RoleType.Tower,e.id),l.data.roleId=e.roleId,l.data.master=e.master,l.data.heroModel.setBody(game.RoleType.Tower,g.bodyResId),l.setTouchable(!0),l.setScenePosition(e.createPos.x,e.createPos.y),l.setDirection(game.Direction.getAnimatDirection(game.Direction.Down)),l.setSceneVisitCallback(this._calCreateTower,this,[l,o,n,s]),b8e.scene.addDisplay(l,void 0,!1,!0,!0),l},_calCreateTower:function(e,t,a,i){game.AvatarUtil.updateBody(e),e.hideShadow(),i&&i.call(a,e,t)},createNpc:function(e){var t=e.roleId,a=game.NpcCfg.getData(t);if(!a)return b8e.error("NPC\u4e0d\u5b58\u5728\uff0cid: ",t),null;var i=game.SceneRole.get(game.RoleType.Npc,e.id);return i.data=game.RoleData.get(game.RoleType.Npc,e.id),i.data.roleId=e.roleId,a.name&&(i.data.name=a.name),i.data.heroModel.setBody(game.RoleType.Npc,a.model),i.setTouchable(!0),i.setScenePosition(e.createPos.x,e.createPos.y),i.setDirection(game.Direction.getAnimatDirection(game.Direction.Down)),i.setSceneVisitCallback(this._calCreateNpc,this,[i]),b8e.scene.addDisplay(i,void 0,!1,!0,!0),i},_calCreateNpc:function(e){game.AvatarUtil.updateBody(e)},createPartner:function(e){var t=e.roleId,a=game.PartnerCfg.getData(t);if(!a)return b8e.error("Pet\u4e0d\u5b58\u5728\uff0cid: ",t),null;var i=game.SceneRole.get(game.RoleType.Partner,e.id);i.data=game.RoleData.get(game.RoleType.Partner,e.id),i.data.roleId=e.roleId,i.data.hp=e.hp||0,i.data.maxHp=e.maxHp||0,a.name&&(i.data.name=a.name);var n=e.useSkin?e.useSkin:a.model;return i.data.heroModel.setBody(game.RoleType.Partner,n),i.setTouchable(!1),i.setScenePosition(e.createPos.x,e.createPos.y),i.setDirection(game.Direction.getAnimatDirection(game.Direction.Down)),i.setSceneVisitCallback(this._calCreatePartner,this,[i]),b8e.scene.addDisplay(i,void 0,!1,!0,!0),i},_calCreatePartner:function(e,t,a){game.AvatarUtil.updateBody(e),a&&a.call(t,e)}});game.sceneRoleCreate=game.sceneRoleCreate||new e}(),function(){var e=b8e.Object.extends({isDelayRun:!1,unitsMap:null,monsterId:1e5,attackPos:null,testFashion:null,ctor:function(){this._super(),this.unitsMap=b8e.HashMap.get(),this.attackPos=[],this.testFashion=[1501,1502,1505,1508,1509,1519]},robotMsg:function(){},createTestRoles:function(){for(var e,t,a=this,i=game.mainRoleData.mapId,n=(game.mainRoleData.partrolIndex,a.createTestRolesData()),s=n.length,o=0;o<s;o++)e=n[o],(t=game.HeroData.get(game.RoleType.Hero,e.roleId)).setRobotData(e),t.mapId=i,t.resetPatrolPos(game.mainRoleData.partrolIndex),0,b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.roleId),game.sceneRoleCreate.createHero(t,!1,a,function(e){a.createPartners(e,game.partnerData.partnerSlots),e.runAi()},1e3)},createTestRolesData:function(){for(var e=[],t=0;t<20;t++){var a={};a.roleId=1e8*Math.random(),a.isMale=.5<=Math.random(),a.roleName="\u6d4b\u8bd5\u673a\u5668\u4eba"+t,a.surface={},a.surface.nickname=340+(9*Math.random()>>0),a.surface.halo=1+(7*Math.random()>>0),a.surface.mount=1+(9*Math.random()>>0),a.surface.shenqi=1+(7*Math.random()>>0),a.surface.wing=1+(7*Math.random()>>0),a.surface.skins=[this.testFashion[7*Math.random()>>0],1810+(5*Math.random()>>0)],e.push(a)}return e},getRobots:function(){return this._robots},createMonsters:function(e){this._createPos||(this._createPos={}),this._createPos.x=e.x,this._createPos.y=e.y,this._createMonsters(game.mainRoleData.id,game.mainInstanceData.id,this._createMonsterComplete,[this._createPos],this)},_createMonsters:function(e,t,a,i,n){game.CfgUtil.getRandomMonsters(t,this._getMonstersComplete,this,[e,a,i,n])},_getMonstersComplete:function(e,t,n,s,o){var a=this;if(!e||e.length<1)b8e.warn("\u672a\u968f\u673a\u83b7\u53d6\u5230\u602a\u7269\u914d\u7f6e\uff0c\u521b\u5efa\u666e\u901a\u573a\u666f\u602a\u7269\u5931\u8d25");else for(var i=1+Math.random()*game.sceneData.partnerCount|0,r=0,g=e.length,l=function(i){r=e[Math.random()*g|0],game.MonsterCfg.getDataAsync(r,function(e){if(e){var t=this._unitData;t=t||(this._unitData=b8e.createMap());var a=s[0];this.monsterId++,t.id=this.monsterId,t.type=game.SceneUnitType.MONSTER,t.maxhp=t.hp=5+5*Math.random()|0,t.x=a.x+(1+6*Math.random()|0)-3,t.y=a.y+(1+6*Math.random()|0)-3,this.isPathSolid(t)?i--:(this.setPathSolid(t),t.monster||(t.monster=b8e.createMap()),t.monster.id=e.id,this._setMonsterUnit(t,n,o))}else b8e.warn("\u9519\u8bef\u7684\u602a\u7269ID")},a),c=i},c=0;c<i;c++)l(c)},createBirthEffect:function(e){if(e){var t=game.ResCfg.getUrl(5001,997),a=b8e.scene.getPixelPosByGrid(e.x,e.y);game.EffectUtil.playSceneEffect(b8e.scene,t,a,0)}},setAttackPos:function(e,t){this.attackPos[e]=t},isAttackPos:function(e){return this.attackPos[e]},clearAttackPos:function(){this.attackPos.length=0},adjustMonsterPos:function(e,t){if(e&&t){var a=e.getGridPosition(),i=e.getDirection(),n=t.getGridPosition(),s=game.Direction.DownLeft;switch(game.Direction.getDirection(i)){case game.Direction.Up:case game.Direction.UpRight:n.x=a.x+2,n.y=a.y-2,s=game.Direction.DownLeft;break;case game.Direction.Right:case game.Direction.DownRight:case game.Direction.Down:n.x=a.x+2,n.y=a.y+2,s=game.Direction.UpLeft;break;case game.Direction.Left:case game.Direction.DownLeft:n.x=a.x-2,n.y=a.y+2,s=game.Direction.UpRight;break;case game.Direction.UpLeft:n.x=a.x-2,n.y=a.y-2,s=game.Direction.DownRight}var o=b8e.scene.getPixelPosByGrid(n.x,n.y);t.setScenePosition(o.x,o.y),t.setDirection(game.Direction.getAnimatDirection(s));this._allotHitPos(e,t)}},_setAttackPathSolid:function(e,t){var a={x:0,y:0},i=t.getGridPosition();this.setPathSolid(i);for(var n=i.x,s=i.y,o=0,r=0,g=1;g<=2;g++){for(o=s+g,r=n-g;0<=r&&r<=n+g;r++)a.x=r,a.y=o,this.setPathSolid(a);for(r=n+g,o=s-g;0<=o&&o<=s+g;o++)a.x=r,a.y=o,this.setPathSolid(a);for(o=s-g,r=n-g;0<=r&&r<=n+g;r++)a.x=r,a.y=o,this.setPathSolid(a);for(r=n-g,o=s-g;0<=o&&o<=s+g;o++)a.x=r,a.y=o,this.setPathSolid(a)}},_allotHitPos:function(e,t){var a=t.data.beHitPos;a=a||(t.data.beHitPos=[]);var i=t.data.retainHitPos;i=i||(t.data.retainHitPos=[]);var n=t.getGridPosition();i[0]=a[0]={x:n.x-2,y:n.y-2,dir:game.Direction.DownRight},i[1]=a[1]={x:n.x,y:n.y-2,dir:game.Direction.Down},i[2]=a[2]={x:n.x+2,y:n.y-2,dir:game.Direction.DownLeft},i[3]=a[3]={x:n.x+2,y:n.y,dir:game.Direction.Left},i[4]=a[4]={x:n.x+2,y:n.y+2,dir:game.Direction.UpLeft},i[5]=a[5]={x:n.x,y:n.y+2,dir:game.Direction.Up},i[6]=a[6]={x:n.x-2,y:n.y+2,dir:game.Direction.UpRight},i[7]=a[7]={x:n.x-2,y:n.y,dir:game.Direction.Right};for(var s=b8e.scene.getMapLayer().getEarthSurface().getConfig(),o=s.mapWidth/s.gridWidth>>0,r=s.mapHeight/s.gridHeight>>0,g=0,l=a.length;g<l;g++)a[g].x>=o?i.x=a[g].x=n.x-1:a[g].x<1&&(i.x=a[g].x=1),a[g].y>=r?i.y=a[g].y=n.y-1:a[g].y<1&&(i.y=a[g].y=1)},setPathSolid:function(){},isPathSolid:function(e){return b8e.scene.getMapLayer().getEarthSurface().getPathFinding().isSolid(e.x,e.y)},clearPathSolid:function(){},clearAllPathSolid:function(){},createPartners:function(e,t){if(!game.sceneData.isCsScene()){var a=void 0,i=e.data.id%1e9*10,n=e.getGridPosition(),s=void 0,o={};o.type=game.SceneUnitType.PARTNER,o.x=n.x,o.y=n.y,o.hp=1e3,o.maxhp=1e3,game.sceneData.partnerCount=0,game.follow.delQueueListById(e.data.id);for(var r=1;r<6;r++)if((s=t[r])&&0<s.id){if(o.id=i+r,o.pet={id:s.id},o.useSkin=0,(a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Partner,i+r))&&a.data&&a.data.heroModel){a.data.roleId=s.id;var g=game.PartnerCfg.getData(s.id),l=s.info;if(g&&l){var c=l.cfg.model;if(l.useSkin){var h=l.skinInfoMap.get(l.useSkin);h&&(c=h.cfg.model)}a.data.heroModel.setBody(game.RoleType.Partner,c),game.AvatarUtil.updateBody(a),game.sceneData.partnerCount++}else b8e.warn("\u573a\u666f\u4f19\u4f34\u521b\u5efa\u627e\u4e0d\u5230\u914d\u7f6e: ",s.id)}else{var m=s.info;if(m&&m.useSkin){var u=m.skinInfoMap.get(m.useSkin);u&&(o.useSkin=u.cfg.model)}this._setPartner(o),game.sceneData.partnerCount++}game.follow.updatePetFollower(o.id,e.data.id)}else b8e.scene.removeDisplayByTypeAndId(game.RoleType.Partner,i+r)}},_createMonsterComplete:function(e){if(e&&e.data){this._allotHitPos(null,e),e.setDirection(game.Direction.getRandDirection()),b8e.hasTimeout(this._battleStart,this)||b8e.setTimeout(this._battleStart,this,300)}},clearBattleState:function(){var e=game.sceneData;e.setSceneBattle(!1),e.isCsScene()||e.clearMonsterIds()},_battleStart:function(){if(!game.playBack.isFighting){game.sceneData.setSceneBattle(!0);var e=b8e.scene.getDisplayByType(game.RoleType.Hero);this._setAiFindState(e);var t=b8e.scene.getDisplayByType(game.RoleType.Partner);this._setAiFindState(t)}},_setAiFindState:function(e){for(var t=void 0,a=0,i=e.length;a<i;a++)(t=e[a]).getAiStateMachine().isAttack()||(t.data&&(t.data.hp=t.data.maxHp=1e3),t.getAiStateMachine().find())},removeMonster:function(e){var t=game.sceneData.monsterIds.indexOf(e);-1<t&&(game.sceneData.monsterIds.splice(t,1),b8e.scene.removeDisplayByTypeAndId(game.RoleType.Monster,e))},clearSceneMonster:function(){game.sceneData.clearMonsterIds(),b8e.scene.removeDisplayByType(game.RoleType.Monster),this.clearAllPathSolid(),this.resetPetState()},resetPetState:function(){for(var e=b8e.scene.getDisplayByType(game.RoleType.Partner),t=0,a=e.length;t<a;t++)e[t].getAiStateMachine().stop()},createDropItems:function(e){if(e&&e.userItem){var t,a,i=[],n=e.userItem.list,s=e.userItem.amount;if(n)for(a=0;a<n.length;a++){var o=n[a];(t=game.DropItemData.get()).setItemData(o),i.push(t)}if(s&&s.list&&0<s.list.length){this._tempAmountInfo||(this._tempAmountInfo=new game.AmountInfo),this._tempAmountInfo.resetData(),this._tempAmountInfo.setData(s);var r=this._tempAmountInfo.getAllDatas();for(a=0;a<r.length;a++)0<(o=r[a]).value&&((t=game.DropItemData.get()).setAmountDropData(o),i.push(t))}if(game.SceneMgr.inst().sceneId==e.mapid){var g,l,c,h=9<i.length?9:i.length,m=Math.floor(Math.sqrt(h));g=b8e.scene.getPixelPosByGrid(e.pos.x,e.pos.y),g=b8e.scene.sceneUIToGLPos(g.x,g.y);var u=game.mainRole.mainRoleEntity,d=-m/2*100;for(a=0;a<h;a++){t=i[a],l=g.x-a%m*100-d,c=g.y-100*Math.floor(a/m)-d,t.setPosition(cc.v2(g.x,g.y));var f=game.SceneRole.get(t.type,t.id);f.data=t,f.setPosition(l,c),f.addVisibledCallback(function(n){return function(){var e=n.data,t=b8e.Sprite.get();t.loadTexture(e.getResId(),null,null,{useManifest:!1}),t.setScale(.5,.5),t.setPosition(-20,0),t.setAnchor(.5,.5),b8e.stage.addChild(t);var a=n.getAnimator(game.AnimatorType.BODY,1);a.addChildToBindNode(t,"body");var i="";switch(e.quality){case game.Quality.Q_PURPLE:i=game.ClientCfg.getSceneFx(10080);break;case game.Quality.Q_YELLOW:i=game.ClientCfg.getSceneFx(10081);break;case game.Quality.Q_RED:i=game.ClientCfg.getSceneFx(10082)}i&&((a=(a=n.getAnimator(game.AnimatorType.DROP_ITEM_EFFECT,1))||n.addAnimator(game.AnimatorType.DROP_ITEM_EFFECT,1,1e3,!0)).setBlendMode(b8e.BlendMode.LIGHTEN),a.load(i),a.play())}}(f),this),b8e.Tween.get(f).wait(1500).to({x:u.x,y:u.y},300,b8e.Ease.quadIn).call(this._onDropItemTweenComplete,this,[f]),b8e.scene.addDisplay(f)}}}},_onDropItemTweenComplete:function(e){e.usable&&b8e.scene.removeDisplay(e)},setSceneUnit:function(e){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:this._setCsWar(e);break;case game.SceneType.CS_ARROW:this._setSceneUnit(e),b8e.evt.dptG(game.SceneGEvts.SCENE_UNIT_UPDATE_ARROW,e);break;case game.SceneType.GUANDU_MAP:this._setSceneUnit(e),game.guanDuData.firstEnter&&(game.guanDuData.firstEnter=!1,game.guanDuData.isInActive=!0,game.guanDuData.setChange(),game.guanDuData.addEvent(),b8e.evt.dptG(game.SceneGEvts.C2C_HIDE_CARD));break;default:this._setSceneUnit(e)}},_setSceneUnit:function(e){if(e&&!(e.length<1))for(var t,a=game.SceneUnitType,i=0,n=e.length;i<n;i++)if(t=e[i])switch(this.unitsMap.set(t.id,t),t.type){case a.PLAYER:this._setSceneRoleUnit(t);break;case a.MONSTER:this._setMonsterUnit(t);break;case a.BOX:this._setBoxUnit(t);break;case a.TOWER:this._setTower(t);break;case a.NPC:this._setNpc(t);break;case uintType.PARTNER:this._setPartner(uint)}},_setSceneRoleUnit:function(e){switch(game.sceneData.getSceneType()){case game.SceneType.THRONE:this.modifySceneRole(e,function(e){game.throneData.setMonarchState(e)});break;case game.SceneType.GUANDU_MAP:this.modifySceneRole(e,function(e){game.guanDuData.calMmodifySceneRole(e)}),this.isSelf(e)&&(game.guanDuData.activeCamp=e.player.camp,game.guanDuData.homePos={x:e.x,y:e.y},b8e.evt.dptG(game.SceneGEvts.C2C_UPDATA_CAMP));break;case game.SceneType.CS_ARROW:game.CsArrowData.modifySceneRole(e);break;case game.SceneType.CS_GUILD:this.modifySceneRole(e,function(e){game.csGuildBossData.setPlayerName(e)});break;default:this.modifySceneRole(e,this._calModifySceneRole)}},_calModifySceneRole:function(e){if(e){var t=e.data;t&&t.teamId&&game.follow.updateTeamFollower(t.id,t.teamLeaderIdx)}},_setMonsterUnit:function(e,t,a){this.getDisplayById(e.id)&&b8e.scene.removeDisplayByTypeAndId(game.RoleType.Monster,e.id);var i=this.getUnitData(e);i.direction=game.Direction.DownRight,i.ownerId=e.ownerId,game.sceneRoleCreate.createMonsterUnit(i,t,a),i.release(),game.sceneData.monsterIds.push(e.id)},_setBoxUnit:function(e){var t=this.getDisplayById(e.id);if(t)this.modifySceneEntity(t,e);else{var a=this.getUnitData(e);game.sceneRoleCreate.createBoxUnit(a)}},_setTower:function(e){var t=this.getDisplayById(e.id);if(t)this.modifySceneEntity(t,e);else{var a=this.getUnitData(e);switch(game.sceneRoleCreate.createTower(a,this,this._towerVisitCallback,e),game.sceneData.getSceneType()){case game.SceneType.GUANDU_MAP:var i=game.guanDuData;switch(e.tower.id){case game.GuanDuTowerType.Fight:case game.GuanDuTowerType.Blood:case game.GuanDuTowerType.Flag:i.setTowerData(e)}}}},_towerVisitCallback:function(e,t){var a=game.guanDuData.getTowerBar(t.id);a&&e&&(e.addChild(a),a.updataBar(e))},_setNpc:function(e){var t=this.getDisplayById(e.id);if(t)this.modifySceneEntity(t,e);else{var a=this.getUnitData(e);game.sceneRoleCreate.createNpc(a)}},_setPartner:function(e){var t=this.getDisplayById(e.id);t&&b8e.scene.removeDisplayByTypeAndId(game.RoleType.Partner,e.id);var a=this.getUnitData(e);return t=game.sceneRoleCreate.createPartner(a),a.release(),t},modifySceneEntity:function(e,t){e.data.id=t.id,b8e.scene.modifyDisplayId(e,t.id),e.data.setUnitData(t),game.AvatarUtil.updateBody(e)},getUnitData:function(e){var t=game.mainRoleData.mapId,a=game.HeroData.get(e.type,e.id);return a.mapId=t,a.setUnitData(e),a},_setCsWar:function(e){if(e&&!(e.length<1)){var t,a;this.updateSceneList?this.updateSceneList.length=0:this.updateSceneList=[];for(var i=0;i<e.length;i++)t=e[i],(a=game.csSceneData.setSceneUnitMap(t))&&this.updateSceneList.push(a.idx);game.GameLevelMgr.inst().updateSceneUnit(this.updateSceneList)}},mainLeaveScene:function(){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:game.csWarTeamData.clearTeamData(),game.GameLevelMgr.inst().clearSceneUnit(),game.csWarData.setEnterTime();break;case game.SceneType.THRONE:case game.SceneType.TREASURE:game.throneData.mainLeaveScene(),game.csTreasureData.mainLeaveScene();break;case game.SceneType.GUANDU_MAP:this.leaveGuandu();break;case game.SceneType.CS_BOSS:game.csBossData.mainLeaveScene();break;case game.SceneType.CS_ARROW:game.CsArrowData.reset();break;case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:game.csWarTeamData.clearTeamData(),game.guildWarData.setEndCDTime()}this.unitsMap&&this.unitsMap.clear()},leaveGuandu:function(){game.guanDuData.clear(),game.csWarTeamData.clearTeamData(),b8e.evt.dptG(game.SceneGEvts.C2C_SHOW_CARD)},sceneRoleLeaveMsg:function(e,t){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:this._csWarSceneLeaveMsg(e,t);break;case game.SceneType.CS_ARROW:b8e.evt.dptG(game.SceneGEvts.SCENE_UNIT_LEAVE,e),this._onSceneLeave(e,t);break;default:game.challengeIcon.hide(),this._onSceneLeave(e,t)}},_onSceneLeave:function(e,t){if(e!=game.mainRoleData.id)switch(t){case game.SceneUnitType.PLAYER:var a=game.sceneData.getSceneType();a!=game.SceneType.CS_GUILD_WAR_LY&&a!=game.SceneType.CS_GUILD_WAR_HG&&a!=game.SceneType.CS_GUILD_WAR_LD&&a!=game.SceneType.TREASURE||game.follow.updateTeamFollower(e),b8e.scene.removeDisplayByTypeAndId(game.RoleType.Hero,e);break;case game.SceneUnitType.MONSTER:this.removeMonster(e),b8e.scene.removeDisplayByTypeAndId(game.RoleType.Monster,e);break;case game.SceneUnitType.TOWER:b8e.scene.removeDisplayByTypeAndId(game.RoleType.Tower,e);break;case game.SceneUnitType.BOX:b8e.scene.removeDisplayByTypeAndId(game.RoleType.Collect,e)}},_csWarSceneLeaveMsg:function(e){if(e!=game.mainRole.idx){var t=game.csSceneData.getSceneUnitData(e);if(t){game.GameLevelMgr.inst().removeSceneUnit(e,t.type);var a=game.csSceneData.sceneLeaveNotify(e);game.GameLevelMgr.inst().updateSceneUnit(a)}}},moveMsg:function(e,t,a){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:game.GameLevelMgr.inst().moveSceneUnit(e,t,a);break;default:if(e==game.mainRoleData.id)return;var i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e);if(!i)return;game.sceneHelper.sceneMoveNotify(i,t,a)}},moveToMap:function(e,t){game.sceneData.mapId=e,game.sceneData.lineId=t;var a=game.SceneCfg.getData(e);if(!a)return game.loadingPage.setErrorText(game.LanguageData.get(75)+sceneId+game.LanguageData.get(76)),void b8e.error("\u60f3\u8fdb\u5165\u4e00\u4e2a\u6ca1\u6709\u914d\u7f6e\u7684\u573a\u666f\uff1f");switch(a.type){case game.SceneType.CSWAR:case game.SceneType.CS_BOSS:case game.SceneType.CS_GUILD:case game.SceneType.GUANDU_MAP:case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:case game.SceneType.TREASURE:this.clear();break;case game.SceneType.THRONE:game.throneData.saveLastSceneRole(),this.clear();break;case game.SceneType.CS_ARROW:this.clear(),b8e.evt.dptG(game.SceneGEvts.SCENE_CHANGE_MAP);break;default:this.clear(),this.isDelayRun=!0,game.mainRoleData.mapId=e,game.mainRoleData.id=game.mainRoleData.roleId}game.mainProcess.runSceneProcess(e)},clear:function(){this.unitsMap&&this.unitsMap.clear(),game.challengeIcon.hide(),game.mainRole.stopAi(),this.removeSelf(),game.playBack.stop(),game.CsArrowData.reset(),game.sceneData.clearMonsterIds(),b8e.scene.clearEntity(),game.follow.clear()},sceneRevive:function(e,t,a){var i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e);if(i){i.setVisible(!0),i.transition(game.RoleStateType.ACTION_IDLE);var n=b8e.scene.getPixelPosByGrid(t,a);i.setScenePosition(n.x,n.y)}},mainChallengeMsg:function(e){var t={type:e.clientParam,rewards:e.useritem};switch(game.playBack.play(e.battlelog,t),game.challengeIcon.hide(),game.sceneData.getSceneType()){case game.SceneType.THRONE:game.throneData.mainChallengeMsg(e);break;case game.SceneType.TREASURE:var a=game.SysTime.curTime+game.csTreasureData.getKillMonsterCD()*b8e.TimeUtil.SECOND_MICRO_SECONDS;game.csTreasureData.nextChallengeTm=a,e.battlelog.win&&(game.csTreasureData.updateKeys(e),b8e.evt.dptG(game.SceneGEvts.UPDATE_TREASURE_KEYS),game.csWarTeamData.isInTeam&&b8e.evt.dptG(game.CsWarTeamEvts.C2C_REQ_TEAM_DATA))}},onSceneBattleMsg:function(e){var t=void 0;switch(game.sceneData.getSceneType()){case game.SceneType.TREASURE:t=game.InstanceType.TREASURE,e.battlelog.win&&game.csTreasureData.updateKeys(e)}var a={type:t,rewards:e.useritem};game.playBack.play(e.battlelog,a),game.challengeIcon.hide()},sceneRoleChallengeMsg:function(e){switch(game.challengeIcon.hide(),game.sceneData.getSceneType()){case game.SceneType.THRONE:game.throneData.sceneRoleChallengeMsg(e);break;case game.SceneType.CS_GUILD:var t={type:game.InstanceType.CS_GUILD_PVP,turn:!0};e.battlelog.win=!e.battlelog.win,game.playBack.play(e.battlelog,t),game.mainRole.transition(game.RoleStateType.ACTION_IDLE);break;default:t={type:game.InstanceType.CS_PVP,turn:!0};e.battlelog.win=!e.battlelog.win,game.playBack.play(e.battlelog,t),game.mainRole.transition(game.RoleStateType.ACTION_IDLE)}},onScenePlayEndResp:function(){switch(game.sceneData.getSceneType()){case game.SceneType.THRONE:game.throneData.scenePlayEnd()}},onSceneBattleStateMsg:function(e){for(var t=e.ids,a=e.state,i=e.dead,n=0,s=t.length;n<s;n++){var o=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,t[n]);o&&o.data&&((o.data.isFighting=a)?(this._addBattleState(o),o.transition(game.RoleStateType.ACTION_IDLE)):(i&&(o.transition(game.RoleStateType.ACTION_DEATH),o.setVisible(!1),t[n]==game.mainRoleData.id&&b8e.evt.dptG(game.SceneGEvts.MAIN_ROLE_DIE),o.setKill(0)),this.rmvBattleState(o),game.CsArrowData.isFightStart=!1))}},_addBattleState:function(e){var t=game.ResCfg.getUrl(5019,2002);if(t){var a=e.getAnimator(game.AnimType.BATTLE,1);a||((a=e.addAnimator(game.AnimType.BATTLE,1)).y=150),a.load(t),a.play()}},rmvBattleState:function(e){var t=e.getAnimator(game.AnimType.BATTLE,1);t&&t.clear()},sceneFollowMsg:function(e){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:var t=game.csSceneData.sceneFollow(e.unitId,e.targetUnitId,e.teamId);game.GameLevelMgr.inst().updateSceneUnit(t);break;case game.SceneType.GUANDU_MAP:case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:case game.SceneType.TREASURE:game.follow.updateTeamFollower(e.unitId,e.targetUnitId)}},moveToPos:function(e){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:game.GameLevelMgr.inst().MoveToPosNotify(e.id);var t=game.csSceneData.moveToPosNotify(e.id,e.x,e.y);game.GameLevelMgr.inst().updateSceneUnit(t);break;case game.SceneType.GUANDU_MAP:game.guanDuData.moveToPos(e)}},scenePlayerInfo:function(e){switch(game.sceneData.getSceneType()){case game.SceneType.CSWAR:game.csWarTeamData.setChallengeTeam(e.id,e.team,e.hp,e.maxHp),game.module.show(game.ME.CsWarChallenge);break;case game.SceneType.GUANDU_MAP:if(e.team)game.csWarTeamData.setChallengeTeam(e.id,e.team,e.hp,e.maxHp),game.module.show(game.ME.GuanDuChallenge);else{var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.id).data,a={members:[{id:e.id,name:t.name,level:t.lv,power:t.power,isMale:t.isMale,isLeader:!1,hp:e.hp,maxHp:e.maxHp}]};game.csWarTeamData.setChallengeTeam(e.id,a,e.hp,e.maxHp),game.module.show(game.ME.GuanDuChallenge)}break;case game.SceneType.CS_ARROW:game.sceneData.currentPlayerInfo=e,b8e.evt.dptG(game.SceneGEvts.SCENE_PLAYER_INFO_REQ)}},modifySceneRole:function(e,t){var a=1<arguments.length&&void 0!==t?t:null,i=this.isSelf(e);i&&(game.mainRoleData.id=e.id);var n,s=!i;game.sceneData.getSceneType()==game.SceneType.TREASURE&&(s=!1);var o=this.getDisplayById(e.id);if(o){if(game.mainRoleData.isSelf=i,o.data.id=e.id,b8e.scene.modifyDisplayId(o,e.id),(n=o.data).setUnitData(e),-1<e.x&&-1<e.y){var r=b8e.scene.getPixelPosByGrid(e.x,e.y);o.setScenePosition(r.x,r.y)}game.AvatarUtil.update(o),a&&a.call(this,o)}else e.player.surface&&(e.player.surface.nickname=null),(n=this.getUnitData(e)).isSelf=i,o=game.sceneRoleCreate.createHero(n,s,this,a),i&&(game.mainRole=o,game.mainRole.data=n,b8e.scene.getCamera().setFocusTarget(game.mainRole),game.chatData.setPlayerInfoId(e.id));return e.player&&0<e.player.killCount&&o.setKill(e.player.killCount),this._setVisibleGuildName(n,o,i),o},_setVisibleGuildName:function(e,t,a){if(e){switch(game.sceneData.getSceneType()){case game.SceneType.GUANDU_MAP:e.isShowGuildName=!1;break;case game.SceneType.CS_BOSS:case game.SceneType.CS_GUILD:case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:e.isShowGuildName=!0,t.setVisible(!e.guildWarOwner);break;case game.SceneType.CS_ARROW:e.isShowGuildName=!0;break;default:e.isShowGuildName=a}t.updateGuildName()}},isSelf:function(e){var t=game.mainRoleData.roleId;return!(!e.player||e.player.roleId!=t)},removeSelf:function(){if(game.mainRoleData){var e=game.mainRoleData.roleId;this._removeSelf(e),this._removeSelf(game.mainRoleData.id)}},_removeSelf:function(e){this._removeFollower(game.RoleType.Partner,e),this.getDisplayById(e)&&b8e.scene.removeDisplay(game.mainRole,!1)},_removeFollower:function(e,t){b8e.scene.removeDisplayByTypeAndId(e,t)},getDisplayById:function(e){var t=void 0,a=b8e.scene,i=game.SceneUnitType;return(t=a.getDisplayByTypeAndId(i.PLAYER,e))?t:(t=a.getDisplayByTypeAndId(i.MONSTER,e))?t:(t=a.getDisplayByTypeAndId(i.BOX,e))?t:(t=a.getDisplayByTypeAndId(i.MINE,e))?t:(t=a.getDisplayByTypeAndId(i.TOWER,e))?t:(t=a.getDisplayByTypeAndId(i.NPC,e))?t:t=a.getDisplayById(e)},getUnitMap:function(){return this.unitsMap},getUnit:function(e){return this.unitsMap?this.unitsMap.get(e):null}});game.scene=game.scene||new e}(),function(){var e,l=b8e.Enum({Effect:0,Apply:1,Remove:2});e=b8e.Enum({Arrest:1});var a=b8e.Object.extends({ctor:function(){this._super(),this._pos={x:0,y:0}},buffs:function(e,t,a){if(!e||e.length<1)return 0;for(var i=100,n=void 0,s=e.length,o=void 0,r=0,g=0;g<s;g++)if((n=e[g])&&(o=t.getDisplayById(n.unitId))){switch(n.state){case l.Effect:this.addBuff(o,n,a,r);break;case l.Apply:this.applyBuff(t,o,n,a,r);break;case l.Remove:this.removeBuff(o,n),i=0}r+=300}return i},addBuff:function(e,a,i,n){if(a&&e&&!(e&&e.data&&e.data.hp<1)){var s=game.BuffCfg.getData(a.buffId);if(s){s.bcType&&(n+=s.waitTime,game.BounceCharacterMgr.inst().showHurt(0,s.bcType,e,i,n)),this.addEffect(e,s,i);var o=a.targets;if(o&&!(o.length<1))for(var r=void 0,g=0,l=o.length;g<l;g++)(r=o[g])&&(e=scene.getDisplayById(r.unitId),t.addEffect(e,s,i))}}},addEffect:function(e,t,a){if(t&&t.clientEffect){var i=e.getAnimator(game.AnimType.BODY,1);if(i){var n=e.getAnimator(game.AnimType.BUFF,t.id);(n=n||e.addAnimator(game.AnimType.BUFF,t.id)).setSpeedRatio(a);var s=game.ResCfg.getUrl(5001,t.clientEffect);n.load(s);var o=t.clientEffectBind?t.clientEffectBind:"root";i.addChildToBindNode(n,o,100),n.play();n.addFinishCallback(this._effectFinished,this),e.data.buffs.push(t.id)}}},_effectFinished:function(e){e&&e.usable&&e.release()},applyBuff:function(e,t,a,i,n){if(a&&t){for(var s=a.effects,o=s.length,r=game.BuffCfg.getData(a.buffId),g=void 0,l=game.BounceCharacterType,c=0;c<o;c++)if(g=s[c]){switch(g.type){case l.RESPAWN:this._reliveBuff(t,i);break;case l.REFLECT:this._reflectBuff(t,i)}game.skillHit.setTargetEffect(t,g,i,1,1,r,n)}this.addEffect(t,r,i);var h=a.targets;if(h&&!(h.length<1))for(var m=void 0,u=0,d=h.length;u<d;u++)(m=h[u])&&(t=e.getDisplayById(m.unitId),this.addEffect(t,r,i),game.skillHit.setTargetHit(e,t,m,i))}},removeBuff:function(e,t){if(t&&e){var a=e.getAnimator(game.AnimType.BUFF,t.buffId);a&&a.release();var i=e.data.buffs;if(i&&!(i.length<1)){var n=i.indexOf(t.buffId);-1<n&&i.splice(n,1)}}},removeAllBuff:function(e){if(e){var t=e.data.buffs;if(t&&!(t.length<1)){for(var a=0,i=t.length;a<i;a++)this._removeBuff(e,t[a]);t.length=0}}},_removeBuff:function(e,t){var a=e.getAnimator(game.AnimType.BUFF,t);a&&a.release()},_reliveBuff:function(e,t){var a=game.Direction.getDirection(e.getDirection()),i=game.Direction.getRadian(a),n=e.getScenePosition();this._pos.x=n.x,this._pos.y=n.y;var s=e.getScene(),o=game.ResCfg.getUrl(5001,2039);game.EffectUtil.playHitEffect(e,"root",s,o,this._pos,i,t),game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.RESPAWN,e,t)},_reflectBuff:function(e,t){e&&game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.REFLECT,e,t)}});game.skillBuff=game.skillBuff||new a,b8e.RC("$$game","$$SkillSpecialType",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this._pos={x:0,y:0}},hit:function(e,t,a,i){var n=this;if(e&&t&&a){var s=void 0;if(s=e.getDisplayById(a.unitId)){var o=void 0,r=void 0,g=void 0,l=void 0;t.shakeTimes&&0<t.shakeTimes.length&&n.addShake(e,t.shakeTimes,t.shakeOffset,i),t.hitEffect&&(o=game.ResCfg.getUrl(5001,t.hitEffect));var c=game.Direction.getDirection(s.getDirection()),h=game.Direction.getRadian(c),m=s.getScenePosition();if(n._pos.x=m.x,n._pos.y=m.y,n.addAoe(e,t,i,s.data.isAttack,h),t.hitTime){if(o){var u=t.hitEffectTime?t.hitEffectTime:t.hitTime;game.EffectUtil.playHitEffect(s,t.hitBindNode,e,o,n._pos,h,i,t.autoRotation,u)}b8e.Tween.get(s).wait(t.hitTime/i).call(n.setTargetHit,n,[e,s,a,i])}else if(t.hitTimes&&0<t.hitTimes.length){l=(g=t.hitTimes).length;for(var d=0;d<l;d++)r=g[d],0==d&&o&&game.EffectUtil.playHitEffect(s,t.hitBindNode,e,o,n._pos,h,i,t.autoRotation,r),b8e.Tween.get(s).wait(r/i).call(n.setTargetHit,n,[e,s,a,i,l,d+1])}if(t.hitEffect2)if(o=game.ResCfg.getUrl(5001,t.hitEffect2),t.hitTime2)game.EffectUtil.playHitEffect(s,t.hitBindNode,e,o,n._pos,h,i,t.autoRotation,t.hitTime2);else if(t.hitTimes2&&0<t.hitTimes2.length){l=(g=t.hitTimes2).length;for(var f=0;f<l;f++)r=g[f],0==f&&o&&game.EffectUtil.playHitEffect(s,t.hitBindNode,e,o,n._pos,h,i,t.autoRotation,r)}}}},addAoe:function(e,t,a,i,n){if(t&&t.aoeEffect){var s=i?t.aoeAttackPos:t.aoeDefendPos;if(s){var o=game.playBackScene.getViewOffset(),r=s.X+o.x,g=-s.Y+o.y;this._playPos||(this._playPos={x:0,y:0}),this._playPos.x=r,this._playPos.y=g;var l=game.ResCfg.getUrl(5001,t.aoeEffect);game.EffectUtil.playSceneEffect(e,l,playPos,n,a,!1,t.aoeTime)}}},addShake:function(e,t,a,i){if(t&&a){var n=t.length;if(0!=n){b8e.scene.getContainer().setOffset(0,0),e.getContainer().setOffset(0,0),e==game.playBackScene.scene&&game.playBackScene.resetSceneBgPos();for(var s=void 0,o=void 0,r=0;r<n;r++)s=t[r]/i,(o=a[r])&&b8e.Tween.get(this).wait(s).call(this.shake,this,[e,o,i,2])}}},shake:function(e,t,a,i,n){var s=4<arguments.length&&void 0!==n?n:0;if(i!=s&&0!=s||(b8e.scene.getContainer().setOffset(0,0),e.getContainer().setOffset(0,0),e==game.playBackScene.scene&&game.playBackScene.resetSceneBgPos(),i!=s)){var o=s%2==0?-1*t:t;b8e.scene.getContainer().setOffset(o,0),e.getContainer().setOffset(o,0),s++,b8e.Tween.kill(e),b8e.Tween.get(e).wait(30/a).call(this.shake,this,[e,t,a,i,s])}},setTargetHit:function(e,t,a,i,n,s){var o=4<arguments.length&&void 0!==n?n:1,r=5<arguments.length&&void 0!==s?s:1;this.setTargetEffect(t,a.effect,i,o,r)},setTargetEffect:function(e,t,a,i,n,s,o){var r=3<arguments.length&&void 0!==i?i:1,g=4<arguments.length&&void 0!==n?n:1,l=s,c=o;if(t&&e){var h=0;if(30<t.type)l&&l.bcType&&game.BounceCharacterMgr.inst().showHurt(h,l.bcType,e,a,c+l.waitTime);else{var m=t.value/r>>0;switch(0!=t.value&&0==(h=m)&&(h=1),t.type){case game.BounceCharacterType.RESPAWN:if(r==g&&(e.data.hp=t.value),0<e.data.hp){var u=e.getScene(),d=e.data.isAttack?100+e.data.pos:200+e.data.pos;game.EffectUtil.delDeathEffect(d,u),e.setVisible(!0),e.reliveShowAllBar(),e.transition(game.RoleStateType.ACTION_IDLE,null,!0)}else b8e.error("\u91cd\u751f\u4e4b\u540e\u8840\u91cf\u8fd8\u662f\u5c0f\u4e8e0\u7684",e.data.hp,t.value,r,g);break;case game.BounceCharacterType.SHIELD2:return void(e.data.shield=e.data.maxShield=t.value);case game.BounceCharacterType.HEALTH:e.data.hp+=t.value;break;case game.BounceCharacterType.MP:e.data.mp+=t.value,e.updateMpBar();break;default:if(r==g&&(0<e.data.shield?(e.data.shield-=t.value,e.data.shield<0&&(e.data.shield=0)):e.data.hp-=t.value,0<t.value)){var f=e.getStateRef(game.HitStateReference);f.setParams(a),e.transition(game.RoleStateType.ACTION_HIT,f)}}e.updateHpBar(),t.type==game.BounceCharacterType.MP&&h<0||(l?0<l.bcType&&game.BounceCharacterMgr.inst().showHurt(h,l.bcType,e,a,c+l.waitTime):game.BounceCharacterMgr.inst().showHurt(h,t.type,e,a,c))}}},sceneHit:function(e,t,a,i,n,s){if(e&&t&&a&&a.data){var o=void 0;t.hitEffect&&(o=game.ResCfg.getUrl(5001,t.hitEffect));var r=game.Direction.getDirection(a.getDirection()),g=game.Direction.getRadian(r),l=a.getScenePosition();if(this._pos.x=l.x,this._pos.y=l.y,t.hitTime){if(o){var c=t.hitEffectTime?t.hitEffectTime:t.hitTime;game.EffectUtil.playHitEffect(a,t.hitBindNode,e,o,this._pos,g,i,t.autoRotation,c)}b8e.Tween.get(s).wait(t.hitTime/i).call(this.setSceneTargetEffect,this,[a,i,n,s])}}else n&&n.call(s,a)},setSceneTargetEffect:function(e,t,a,i){e&&e.data&&(e.data.type==game.RoleType.Monster&&(e.data.hp-=1,e.data.hp<0&&(e.data.hp=0)),e.getStateMachine().isHit()||e.transition(game.RoleStateType.ACTION_HIT)),a&&a.call(i,e)}});game.skillHit=game.skillHit||new e}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this._pos={x:0,y:0},this._endPos={sceneX:0,sceneY:0}},release:function(e,t,a,i,n,s,o,r){var g=3<arguments.length&&void 0!==i?i:1,l=4<arguments.length&&void 0!==n?n:null,c=5<arguments.length&&void 0!==s?s:null,h=6<arguments.length&&void 0!==o?o:null,m=7<arguments.length&&void 0!==r?r:null;if(t){if(a)switch(a.stype){case 0:this._releaseRangeSkill(e,t,a,g,l,c,h,m);break;case 1:this._releaseAttack(e,t,a,g,c,h,m)}}else b8e.error("release role null")},_releaseAttack:function(e,t,a,i,n,s,o){var r=t.getDirection();if(r){r=game.Direction.getDirection(r);var g=game.Direction.getRadian(r),l=t.getStateRef(game.AttackStateReference);l.setParams(a.actionType,g,i),l.onTotal(n,s,o),t.transition(game.RoleStateType.ACTION_ATTACK,l);var c=t.getScenePosition();a.attackEffect&&this._playSceneEffect(a.attackEffect,e,c,g,i,a.autoRotation,a.attackTime),a.attackEffect2&&this._playSceneEffect(a.attackEffect2,e,c,g,i,a.autoRotation2,a.attackTime2)}},_releaseRangeSkill:function(e,t,a,i,n,s,o,r){var g=game.Direction.getDirection(t.getDirection()),l=game.Direction.getRadian(g),c=a.godAnimalType?game.RoleStateType.ACTION_IDLE:game.RoleStateType.ACTION_ATTACK,h=t.getStateRef(game.AttackStateReference);h.setParams(a.actionType,l,i),h.onTotal(this._afterAttack,this,[t]),t.transition(c,h);var m=void 0;if(n&&(m=e.getDisplayById(n.unitId)),a.attackEffect){var u=t.getScenePosition();this._playSceneEffect(a.attackEffect,e,u,l,i,a.autoRotation,a.attackTime)}a.bulletEffect?m&&this._bulletEffect(e,t,m,a,i,s,o,r):a.aoeFlyEffect?this._aoeFlyEffect(e,t,a,i,s,o,r):s&&s.call(o,r)},_bulletEffect:function(e,t,a,i,n,s,o,r){var g=this,l=game.Direction.getDirection(t.getDirection()),c=game.Direction.getRadian(l),h=game.playBackScene.getViewOffset(),m=game.EffectUtil.getBindPos(t),u=t.getScenePosition();g._pos.x=u.x,g._pos.y=u.y,g._pos.x+=m.x,g._pos.y+=m.y,m=game.EffectUtil.getBindPos(a,i.hitBindNode);var d=a.data,f=d.beAttackedPos.x+m.x+h.x,p=-d.beAttackedPos.y+m.y+h.y;g._endPos.sceneX=f,g._endPos.sceneY=p;var _=g._playSceneEffect(i.bulletEffect,e,g._pos,c,n,i.autoRotation,i.bulletTime,!1);if(i.autoRotation){var v=b8e.MathUtil.getDegree(g._pos.x,g._pos.y,f,p);v=b8e.MathUtil.normalDegree(v),v-=90,_.setRotation(v,v,v)}var E=i.hitTime-i.bulletTime;if(0!=i.bulletTime){var C={sceneX:f,sceneY:p};b8e.Tween.get(g).wait(i.bulletTime/n).call(g._bulletRelease,g,[_,C,E/n,s,o,r])}else g._bulletRelease(_,g._endPos,E/n,s,o,r)},_aoeFlyEffect:function(e,t,a,i,n,s,o){var r=this,g=void 0,l=void 0;l=t.data.isAttack?(g=a.aoeFlyAttackPos,a.aoeFlyDefendPos):(g=a.aoeFlyDefendPos,a.aoeFlyAttackPos);var c=game.Direction.getDirection(t.getDirection()),h=game.Direction.getRadian(c),m=game.playBackScene.getViewOffset(),u=g.X+m.x,d=-g.Y+m.y;r._pos.x=u,r._pos.y=d;var f=r._playSceneEffect(a.aoeFlyEffect,e,r._pos,h,i,a.autoRotation,a.aoeFlyEffectWaitTime,!1);u=l.X+m.x,d=-l.Y+m.y,r._endPos.sceneX=u,r._endPos.sceneY=d,a.aoeFlyEffectWaitTime?(a.aoeEffectReleaseStartTime&&b8e.Tween.get(r).wait(a.aoeEffectReleaseStartTime/i).call(r._aoeEffectRelease,r,[f,a.aoeEffectReleaseTime/i]),b8e.Tween.get(r).wait(a.aoeFlyEffectWaitTime/i).call(r._bulletRelease,r,[f,r._endPos,a.aoeEffectFlyTime/i,n,s,o])):r._bulletRelease(f,r._endPos,a.aoeEffectFlyTime/i,n,s,o)},_playSceneEffect:function(e,t,a,i,n,s,o,r){var g=!(7<arguments.length&&void 0!==r)||r,l=game.ResCfg.getUrl(5001,e);return game.EffectUtil.playSceneEffect(t,l,a,i,n,s,o,g)},_afterAttack:function(e){e?e.transition(game.RoleStateType.ACTION_IDLE):b8e.error("release role null")},_aoeEffectRelease:function(){},_bulletRelease:function(e,t,a,i,n,s){0<a?(b8e.Tween.get(e).to(t,a),b8e.Tween.get(this).wait(a).call(this._bulletEnd,this,[e,i,n,s])):this._bulletEnd(e,i,n,s)},_bulletEnd:function(e,t,a,i){e.release(),t&&t.apply(a,i)}});game.skillRelease=game.skillRelease||new e}(),game.spotAlert=b8e.spotAlert,function(){var e,t=e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e._triggerDataByType={type:null},e._triggerSender=new game.TriggerSender,e._triggerByType=b8e.HashMap.get(),e._triggerDataById=b8e.HashMap.get(),e._allotTriggerDatas("task"),e._allotTriggerDatas("taskDone"),e._allotTriggerDatas("instance"),e._allotTriggerDatas("instanceDone"),e._allotTriggerDatas("level"),e._allotTriggerDatas("zhanjiangDone"),b8e.TriggerMgr.inst().onSave(e._onSave,e);var t=b8e.GuideMgr.inst();t.onAdded(e._onGuideAdded,e),t.onBeforeRemove(e._onGuideBeforeRemoved,e);var a=b8e.CommandMgr.inst();a.onOpenView(e._onOpenView,e),a.onCloseView(e._onCloseView,e)},_onOpenView:function(e){var t=e.moduleId;game.moduleDelay.checkDelayModule(t)&&game.module.showToggle(t,void 0)},_onCloseView:function(e){var t=e.moduleId;game.module.hide(t)},initData:function(){var a=[];game.triggerData.triggers.forEach(function(e,t){a.push({id:e,triggerTimes:t})},this),b8e.TriggerMgr.inst().initData(a)},initTrigger:function(){b8e.TriggerMgr.inst().initTrigger(),b8e.evt.dptG(game.InstanceEvts.G_RESTAR_AI)},trigger:function(e,t){var a=1<arguments.length&&void 0!==t&&t;e=+e;var i=game.GuideTriggerCfg.getData(e);if(i){var n=b8e.TriggerMgr.inst(),s=this._createTriggerData(i);n.trigger(s,a)}else b8e.warn("\u6307\u5f15\u89e6\u53d1id="+e+"\u7684\u89e6\u53d1\u5668\u672a\u627e\u5230\uff01")},complete:function(e){var t=game.GuideTriggerCfg.getData(e);if(t){var a=b8e.TriggerMgr.inst(),i=this._createTriggerData(t);a.complete(i)}else b8e.warn("\u6307\u5f15\u89e6\u53d1id="+e+"\u7684\u89e6\u53d1\u5668\u672a\u627e\u5230\uff01")},completeByEventType:function(e){var t=game.GuideEventCfg.getData(e);if(t){var a=t.completeTriggerId;this.complete(a)}else b8e.warn("\u6307\u5f15\u4e8b\u4ef6\u914d\u7f6e\u4e2dtype="+e+"\u7684\u4e8b\u4ef6\u672a\u627e\u5230\uff01")},_allotTriggerDatas:function(e){this._triggerDataByType.type=e;var t=game.GuideTriggerCfg.getData(this._triggerDataByType,!0);if(t)for(var a=t.length,i=0;i<a;i++){var n=t[i],s=this._triggerByType.get(e);s||(s={},this._triggerByType.set(e,s));var o=void 0;switch(e){case"task":case"taskDone":case"instance":case"instanceDone":case"level":case"zhanjiangDone":o=n.taskId}if(o){var r=this._createTriggerData(n);(s[o]||(s[o]=[])).push(r)}}},_getTriggerDatas:function(e,t){var a=this._triggerByType.get(e);if(a){return a[t]}return null},_onSave:function(e,t){var a=e.id;game.triggerData.saveTimes(a,t),this._triggerSender.SaveClientTriggerReq(a,t)},_onGuideBeforeRemoved:function(e){var t=b8e.GuideMgr.inst(),a=this;if(a._lastRect=t.getWidgetRect(e.id),a._lastGuide=e,a._lastMoveEffect){a._lastMoveEffect.release(),a._lastMoveEffect=null}},_onGuideAdded:function(e){var a=this,t=e.id,i=game.GuideEffectCfg.getData(t);if(i){var n=i.moveEffectUrl,s=i.moveSpeed;if(n&&0<s){if(a._lastGuide){var o=b8e.GuideMgr.inst();e.visible=!1,o.updateGuideState(t);var r=b8e.layer.getGuiLayer(),g=b8e.Animator.get();(a._lastMoveEffect=g).load(n+"/animate.bac"),g.play(),g.setLocalZOrder(9999),r.addChild(g);var l=a._lastGuide.targetEffectOffsetX,c=a._lastGuide.targetEffectOffsetY,h=a._lastRect.x+.5*a._lastRect.width+l,m=a._lastRect.y+.5*a._lastRect.height+c;g.setPosition(h,m);var u=o.getWidgetRect(t);l=e.targetEffectOffsetX,c=e.targetEffectOffsetY;var d=u.x+.5*u.width+l,f=u.y+.5*u.height+c,p=b8e.MathUtil.getDistance(h,m,d,f)/s*1e3;b8e.Tween.get(g).to({x:d,y:f},p).call(function(e,t){e.release(),t.visible=!0,b8e.GuideMgr.inst().updateGuideState(t.id),a._lastMoveEffect=null},a,[g,e])}}}},_createTriggerData:function(e,t){var a=1<arguments.length&&void 0!==t?t:null,i=this,n=i._triggerDataById.get(e.id);if(n)return n;(n=new b8e.TriggerData).id=e.id,n.type=e.type,n.queueGroup=e.queueGroup,n.delay=e.delay,n.limitCount=e.limitCount,n.cancelDuration=e.cancelDuration,n.duration=e.duration;var s=e.commandId;if(s){var o=game.GuideCommandCfg.getData(s);if(o){var r=new b8e.CommandData;(n.cmdData=r).id=o.id;var g=o.viewDescId;if(0<g){var l=game.GuideViewDescCfg.getData(g);if(l){var c=new b8e.ViewDesc;(r.viewDesc=c).id=l.id,c.moduleId=l.moduleId,c.nextModuleId=l.nextModuleId,c.widgetName=l.widgetName,c.closeModuleId=l.closeModuleId,c.startCloseModuleId=l.startCloseModuleId}else b8e.warn("\u6307\u5f15\u547d\u4ee4id="+o.id+"\u7684\u754c\u9762\u63cf\u8ff0id="+g+"\u672a\u627e\u5230\uff01")}r.openView=0<o.openView,r.closeView=0<o.closeView,r.optionName=o.optionName,r.optionValues=o.optionValues,r.completeTypes=o.completeTypes,r.completeOnViewHide=0<o.completeOnViewHide,r.completeOnViewShow=0<o.completeOnViewShow;var h=o.guideId;if(0<h){var m=game.GuideEffectCfg.getData(h);if(m){var u=new b8e.GuideData;(r.guideData=u).id=m.id,u.imageBringToTop=0<m.imageBringToTop,u.effectBringToTop=0<m.effectBringToTop,u.imageZOrder=m.imageZOrder,u.effectZOrder=m.effectZOrder,u.isModal=0<m.isModal,u.showModal=0<m.showModal,u.modalColor=m.modalColor?0|+m.modalColor:4278190080,u.direction=m.direction,u.viewOffsetX=0|+m.viewOffset[0],u.viewOffsetY=0|+m.viewOffset[1],u.targetImageUrl=m.targetImageUrl,u.targetImageOffsetX=0|+m.targetImageOffset[0],u.targetImageOffsetY=0|+m.targetImageOffset[1],u.viewClassName=m.viewType,u.allModal=m.allModal,u.textOffsetX=0|+m.textOffset[0],u.textOffsetY=0|+m.textOffset[1],u.textMsg=m.textMsg,u.fontSzie=m.fontSzie;var d=m.targetEffectUrls;if(d)for(var f=u.targetEffectUrls=[],p=d.length,_=0;_<p;_++){f.push(d[_]+"/animate.bac")}u.targetEffectOffsetX=0|+m.targetEffectOffset[0],u.targetEffectOffsetY=0|+m.targetEffectOffset[1],u.description=m.description}else b8e.warn("\u6307\u5f15\u547d\u4ee4id="+o.id+"\u7684\u6307\u5f15\u6548\u679cid="+h+"\u672a\u627e\u5230\uff01")}}else b8e.warn("\u6307\u5f15\u89e6\u53d1id="+e.id+"\u7684\u547d\u4ee4id="+s+"\u672a\u627e\u5230\uff01")}a=a||n,n.rootData=a;var v=e.chainId;if(0<v){var E=game.GuideTriggerCfg.getData(v);E?n.chainData=i._createTriggerData(E,a):b8e.warn("\u6307\u5f15\u89e6\u53d1id="+e.id+"\u7684\u5e76\u884c\u89e6\u53d1\u5668id="+v+"\u672a\u627e\u5230\uff01")}var C=e.nextId;if(0<C){var T=game.GuideTriggerCfg.getData(C);T?n.nextData=i._createTriggerData(T,a):b8e.warn("\u6307\u5f15\u89e6\u53d1id="+e.id+"\u7684\u4e32\u884c\u89e6\u53d1\u5668id="+v+"\u672a\u627e\u5230\uff01")}return i._triggerDataById.set(e.id,n),n},task:function(e){var t=this._getTriggerDatas("task",e);this._onTrigger(t)},taskDone:function(e){var t=this._getTriggerDatas("taskDone",e);this._onTrigger(t)},instanceDone:function(e){var t=this._getTriggerDatas("instanceDone",e);this._onTrigger(t)},instance:function(e){var t=this._getTriggerDatas("instance",e);this._onTrigger(t)},level:function(e){var t=this._getTriggerDatas("level",e);this._onTrigger(t)},zhanjiangDone:function(e){var t=this._getTriggerDatas("zhanjiangDone",e);this._onTrigger(t)},_onTrigger:function(e){if(e)for(var t=b8e.TriggerMgr.inst(),a=e.length,i=0;i<a;i++)t.trigger(e[i])}});t._instance=null,t.inst=function(){return null==t._instance&&(t._instance=new t),t._instance},game.GuideEventType={SEND_MAIN_CHAT:"SEND_MAIN_CHAT"},b8e.RC("$$game","$$GameGuideMgr",e)}();p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,f=e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e._enterShowInstanceTypeMap=b8e.HashMap.get(),e._enterShowSceneTypeMap=b8e.HashMap.get(),e._enterHideInstanceTypeMap=b8e.HashMap.get(),e._enterHideSceneTypeMap=b8e.HashMap.get(),e._leaveShowInstanceType=b8e.HashMap.get(),e._leaveHideInstanceType=b8e.HashMap.get(),e._leaveShowSceneTypeMap=b8e.HashMap.get(),e._leaveHideSceneTypeMap=b8e.HashMap.get(),e._isStrongViewMap=b8e.HashMap.get(),e._isGuildViewMap=b8e.HashMap.get(),e._leaveShowModuleMap=b8e.HashMap.get(),e._currIsShowModuleMap=b8e.HashMap.get();for(var t=game.ViewTriggerCfg.getDatas(),a=t.length,i=0;i<a;i++){var n=t[i];e._allotMap(n,n.enterShowInstanceType,e._enterShowInstanceTypeMap),e._allotMap(n,n.enterShowSceneType,e._enterShowSceneTypeMap),e._allotMap(n,n.enterHideInstanceType,e._enterHideInstanceTypeMap),e._allotMap(n,n.enterHideSceneType,e._enterHideSceneTypeMap),e._allotMap(n,n.leaveShowInstanceType,e._leaveShowInstanceType),e._allotMap(n,n.leaveHideInstanceType,e._leaveHideInstanceType),e._allotMap(n,n.leaveShowSceneType,e._leaveShowSceneTypeMap),e._allotMap(n,n.leaveHideSceneTypeMap,e._leaveHideSceneTypeMap);var s=n.moduleId;n.isStrongView&&e._isStrongViewMap.set(s,!0),n.isGuildView&&e._isGuildViewMap.set(s,!0),n.isLeaveSceneShow&&e._leaveShowModuleMap.set(s,n)}},_allotMap:function(e,t,a){for(var i=t.length,n=0;n<i;n++){var s=t[n];if(0<s){var o=a.get(s);o||(o=[],a.set(s,o)),o.push(e.id)}}},_canShow:function(e){return e.needInGuild?game.guildData&&0<game.guildData.id:55==e.id?game.vipData.getCanShowBanner():e.moduleId==game.ME.ExamEnter?game.examData.isShowEnter:e.moduleId==game.ME.MysteriousEgg?game.mysteriousEggData.checkCanShowEgg():e.moduleId!=game.ME.OnlineGiftAward||game.onlineGiftData.iconIsShow()},enterScene:function(){var e=game.sceneData.getConfig();if(e){var t=this._enterShowSceneTypeMap.get(e.type);if(t)for(var a=t.length,i=0;i<a;i++){var n=t[i],s=game.ViewTriggerCfg.getData(n);if(s&&this._canShow(s)){var o=s.moduleId;if(!o)continue;var r=s.pageIndex;game.module.showToggle(o,r)}}if(t=this._enterHideSceneTypeMap.get(e.type))for(var g=t.length,l=0;l<g;l++){var c=t[l],h=game.ViewTriggerCfg.getData(c);if(h&&h.moduleId){var m=h.moduleId;game.module.hide(m)}}}},leaveScene:function(){game.module.closeAll();var e=game.sceneData.lastSceneId,t=0<e?game.SceneCfg.getData(e):null;if(t){var a=this._leaveHideSceneTypeMap.get(t.type);if(a)for(var i=a.length,n=0;n<i;n++){var s=a[n],o=game.ViewTriggerCfg.getData(s);if(o){var r=o.moduleId;if(!r)continue;game.module.hide(r)}}if(a=this._leaveShowSceneTypeMap.get(t.type))for(var g=a.length,l=0;l<g;l++){var c=a[l],h=game.ViewTriggerCfg.getData(c);if(h&&this._canShow(h)){var m=h.moduleId;if(!m)continue;var u=h.pageIndex;game.module.showToggle(m,u)}}}},enterExpolre:function(){var e=this._enterShowSceneTypeMap.get(game.SceneType.EXPLORE);if(e)for(var t=e.length,a=0;a<t;a++){var i=e[a],n=game.ViewTriggerCfg.getData(i);if(n&&this._canShow(n)){var s=n.moduleId;if(!s)continue;var o=n.pageIndex;game.module.showToggle(s,o)}}if(e=this._enterHideSceneTypeMap.get(game.SceneType.EXPLORE))for(var r=e.length,g=0;g<r;g++){var l=e[g],c=game.ViewTriggerCfg.getData(l);if(c&&c.moduleId){var h=c.moduleId;game.module.hide(h)}}},leaveExpolre:function(){var e=this._leaveHideSceneTypeMap.get(game.SceneType.EXPLORE);if(e)for(var t=e.length,a=0;a<t;a++){var i=e[a],n=game.ViewTriggerCfg.getData(i);if(n){var s=n.moduleId;if(!s)continue;game.module.hide(s)}}if(e=this._leaveShowSceneTypeMap.get(game.SceneType.EXPLORE))for(var o=e.length,r=0;r<o;r++){var g=e[r],l=game.ViewTriggerCfg.getData(g);if(l&&this._canShow(l)){var c=l.moduleId;if(!c)continue;var h=l.pageIndex;game.module.showToggle(c,h)}}},enterPlayBack:function(e){game.module.closeAll();var t=this._enterShowInstanceTypeMap.get(e);if(t)for(var a=t.length,i=0;i<a;i++){var n=t[i],s=game.ViewTriggerCfg.getData(n);if(s&&this._canShow(s)){var o=s.moduleId;if(!o)continue;var r=s.pageIndex;game.module.showToggle(o,r)}}if(t=this._enterHideInstanceTypeMap.get(e))for(var g=t.length,l=0;l<g;l++){var c=t[l],h=game.ViewTriggerCfg.getData(c);if(h&&h.moduleId){var m=h.moduleId;game.module.hide(m)}}},leavePlayBack:function(e){for(var t=this._currIsShowModuleMap.values(),a=t.length,i=void 0,n=0;n<a;n++)i=t[n],game.module.showToggle(i.moduleId,i.pageIndex);this._currIsShowModuleMap.clear();var s=this._leaveHideInstanceType.get(e);if(s)for(var o=s.length,r=0;r<o;r++){var g=s[r],l=game.ViewTriggerCfg.getData(g);if(l&&l.moduleId){var c=l.moduleId;game.module.hide(c)}}if(!game.reconnect.isLoginAgain&&(s=this._leaveShowInstanceType.get(e)))for(var h=s.length,m=0;m<h;m++){var u=s[m],d=game.ViewTriggerCfg.getData(u);if(d&&this._canShow(d)){var f=d.moduleId;if(!f)continue;var p=d.pageIndex;game.module.showToggle(f,p)}}},hideUnStrongViews:function(e){for(var t=!(0<arguments.length&&void 0!==e)||e,a=game.module.getShowModule(),i=a.length,n=0;n<i;n++){var s=a[n];if(s&&(this._isStrongViewMap.get(s)||game.module.hide(s),t)){var o=this._leaveShowModuleMap.get(s);o&&(this._currIsShowModuleMap.get(s)||this._currIsShowModuleMap.set(s,o))}}},hideGuildViews:function(){for(var e=game.module.getShowModule(),t=e.length,a=0;a<t;a++){var i=e[a];i&&this._isGuildViewMap.get(i)&&game.module.hide(i)}},showView:function(e,t,a,i,n){var s=arguments.length;if(s){var o=e,r=1<s?t:null,g=3<s?i:0,l=4<s?n:0,c=0,h=o,m=r;if((void 0===o?"undefined":p(o))===b8e.TypeNumber&&(c=o,h=(h=b8e.module.getView(c))||b8e.app.getView(c)),o&&o.moduleEnum&&(c=o.moduleEnum),h&&h.__BaseDisplay){r&&(void 0===r?"undefined":p(r))===b8e.TypeNumber&&(m=(m=b8e.module.getView(r))||b8e.app.getView(r));var u=c?game.ViewPropsCfg.getData(c,!1,!1):null;u&&(null==u.mutex?0:u.mutex,g=null==u.layer?0:u.layer,l=null==u.limitedMutex?0:u.limitedMutex);var d=void 0;m?d=m:(d=b8e.layer.getGuiBottomLayer(),h._specialLayer||h.setLocalZOrder(f.WindowViewIndex),c||h.isSpecialModule||game.module.addOtherModule(h)),h.limitedMutex=l,d?d.addWidget?d.addWidget(h):(h.parent&&h.removeFromParent(),d.addChild(h)):b8e.error("\u5c42\u7ea7\u4fe1\u606f\u9519\u8bef"+g)}else b8e.error("\u8981\u663e\u793a\u7684moduleValue\u4e0d\u662f\u4e00\u4e2a\u6b63\u786e\u7684\u663e\u793a\u5bf9\u8c61")}else b8e.error("\u81f3\u5c11\u6709\u4e00\u4e2a\u6a21\u5757\u679a\u4e3e\u6216\u8005\u663e\u793a\u5bf9\u8c61\u672c\u8eab")},removeLayerAllView:function(e){var t=e.getChildren();if(t)for(var a=t.values(),i=void 0,n=0,s=a.length;n<s;n++)(i=a[n])&&!i.limitedMutex&&(i.moduleEnum?game.module.hide(i.moduleEnum):this.hideView(i))},hideView:function(e){if(e){if((void 0===e?"undefined":p(e))===b8e.TypeNumber){var t=b8e.module.getView(e);(t=t||b8e.app.getView(e))&&t.__isShow&&t.removeFromParent()}else e.__BaseDisplay&&e.removeFromParent();game.gamePopupMgr.hide(e)}else b8e.error("\u8bd5\u56fe\u5173\u95ed\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u89c6\u56fe")}});f._instance=null,f.inst=function(){return null==f._instance&&(f._instance=new f),f._instance},f.DefaultIndex=1,f.HomeViewIndex=-20,f.MainHeadViewIndex=-10,f.MainBottomViewIndex=10,f.MainCenterViewIndex=-25,f.LowLayerViewIndex=-100,f.WindowViewIndex=500,f.WindowViewTop=9999,b8e.RC("$$game","$$GameViewMgr",e)})(),function(){var e,t=e=b8e.Object.extends({moduleQueue:null,currShowModule:0,ctor:function(){this._super(),this.moduleQueue=[]},show:function(e,t){var a=this;if(-1==a.moduleQueue.indexOf(e)&&a.moduleQueue.push(e),a.moduleQueue.sort(a.sortHandler),a.currShowModule&&(b8e.module.isShowView(a.currShowModule)||(a.currShowModule=0)),t||a.canShow()&&0==a.currShowModule){var i=a.moduleQueue.pop();if((a.currShowModule=i)==game.ME.GuajiTips)return void game.guajiData.shopTips();if(i==game.ME.RedPacket)return void game.redPacketData.shopTips();game.module.show(i)}},hide:function(e){e==this.currShowModule&&(this.currShowModule=0,this.canShow()&&0<this.moduleQueue.length&&this.showNext())},showNext:function(){var e=this.moduleQueue.pop();if(e)if((this.currShowModule=e)==game.ME.ModuleOpen)b8e.evt.dptG(game.RoleLvUpEvts.G_SHOW_POPUP,e);else{if(e==game.ME.GuajiTips)return void game.guajiData.shopTips();if(e==game.ME.RedPacket)return void game.redPacketData.shopTips();game.module.show(e)}},canShow:function(){var e=game.playBack.isInstanceFighting(!1),t=b8e.module.isShowView(game.ME.PlayBackFormation);return!e&&!t},sortHandler:function(e,t){var a=game.ViewPriorityCfg.getData(e),i=game.ViewPriorityCfg.getData(t);return a&&i?i.sort-a.sort:0}});game.gamePopupMgr=game.gamePopupMgr||new t,b8e.RC("$$game","$$GamePopupMgr",e)}(),function(){var e,t=e=b8e.Object.extends({_isInstanceMode:!1,_monsterDataByScene:null,_collectDataByScene:null,_collectTween:null,ctor:function(){var e=this;e._super(),e._monsterDataByScene={sceneId:0},e._collectDataByScene={sceneId:0}},isInstanceMode:{get:function(){return this._isInstanceMode}},applyTrackTypes:function(){var e=this._gameLevelDesigner,t=game.sceneData.getConfig();if(t&&t.type===game.SceneType.GUILD_MAP)if(this._isPlayBackMode)e.setTrackTypes(null);else{var a=game.guildCollectData.isAutoCollect,i=game.guildCollectData.isAutoMonster,n=game.guildCollectData.isTaskMode(!0),s=game.guildCollectData.isTaskMode();if(a&&n&&i&&s)e.setTrackTypes([game.RoleType.ClientMonster,game.RoleType.ClientCollect]);else if(a&&n)e.setTrackTypes([game.RoleType.ClientCollect]);else if(i&&s)e.setTrackTypes([game.RoleType.ClientMonster]);else{game.mainRole.getStateMachine().transition(game.RoleStateType.ACTION_IDLE),e.setTrackTypes(null)}}},setPlayBackMode:function(e,t){var a=this;(a._isPlayBackMode=e)?game.GameViewMgr.inst().enterPlayBack(t):game.GameViewMgr.inst().leavePlayBack(t),a.applyTrackTypes()},enterScene:function(){var e=this;e._isPlayBackMode=!1,e._isInstanceMode=!1;var t=e.getMainSceneDesigner(),a=game.sceneData.getConfig();if(a)switch(game.SceneEffectMgr.inst().play(a.id),game.GameViewMgr.inst().enterScene(),a.type){case game.SceneType.GUILD_MAP:t.start(),e.applyTrackTypes(),e.createSceneClientMonster(),e.createSceneClientCollect();break;case game.SceneType.CSWAR:e.getCsWarSceneDesigner().start();break;case game.SceneType.NONE0:case game.SceneType.NONE1:e._isInstanceMode=!0,b8e.evt.dptG(game.InstanceEvts.G_START_PLAY)}},leaveScene:function(){this._isPlayBackMode=!1,this._isInstanceMode=!1,game.SceneEffectMgr.inst().stop(),this.getMainSceneDesigner().stop(),this.getCsWarSceneDesigner().stop(),game.mainRole.getStateMachine().transition(game.RoleStateType.ACTION_IDLE),game.mainRole.getAiStateMachine().stop(),game.playBack.stop(),game.GameViewMgr.inst().leaveScene(),this._collectTween&&(this._collectTween.kill(this),this._collectTween=null)},updateSceneUnit:function(e){if(e&&!(e.length<1))for(var t,a,i=game.csSceneData.sceneUnitMap,n=game.csSceneData.sceneUnitDatas,s=game.SceneUnitType,o=e.length,r=0;r<o;r++)if(t=e[r],a=i.get(t))switch(a.sceneUnitType){case s.PLAYER:this._addCsWarHero(a);break;case s.MONSTER:case s.BOX:break;case s.MINE:this._addCsWarMine(a)}else{var g=n.get(t);g&&this.removeSceneUnit(g.idx,g.type)}},removeSceneUnit:function(e,t){game.sceneData.getSceneType()===game.SceneType.CSWAR&&this.getCsWarSceneDesigner().removeEntity(t,e)},moveSceneUnit:function(e,t,a){if(game.sceneData.getSceneType()===game.SceneType.CSWAR){var i=game.csSceneData.moveNotify(e,t,a),n=this.getCsWarSceneDesigner();n.resetPosition(e),this.updateSceneUnit(i),n.moveNotify(e,t,a)}},clearSceneUnit:function(){game.sceneData.getSceneType()===game.SceneType.CSWAR&&game.csSceneData.clearSceneData()},updateCameraFollow:function(){game.sceneData.getSceneType()===game.SceneType.CSWAR&&this.getCsWarSceneDesigner().updateCameraFollow()},MoveToPosNotify:function(e){game.sceneData.getSceneType()===game.SceneType.CSWAR&&this.getCsWarSceneDesigner().moveToPosNotify(e)},getMainSceneDesigner:function(){var e=this,t=e._gameLevelDesigner;if(!t){(t=e._gameLevelDesigner=new b8e.GameLevelDesigner(b8e.scene)).onEntityBeforeRemove(e._onEntityBeforeRemove,e),t.onApproach(e._onApproach,e),t.onTrack(e._onTrack,e)}return t.setPlayer(game.mainRole),t},getCsWarSceneDesigner:function(){var e=this._csWarGameLevelDesigner;return e=e||(this._csWarGameLevelDesigner=new game.CsWarGameLevelDesigner(b8e.scene))},_addMonster:function(e,t,a){var i=this,n={bodyRes:a};i.getMainSceneDesigner().addEntity(game.RoleType.ClientMonster,n,i._generaterMonster,i,[e,t])},_addCollect:function(e,t,a){var i=this,n={bodyRes:a};i.getMainSceneDesigner().addEntity(game.RoleType.ClientCollect,n,i._generaterCollect,i,[e,t])},_addCsWarMine:function(e){var t=e;this.getCsWarSceneDesigner().addEntity(game.RoleType.CsWarMine,t,this._generaterCsWarMine,this,[e])},_addCsWarHero:function(e){var t=e;this.getCsWarSceneDesigner().addEntity(game.RoleType.CsWarHero,t,this._generaterCsWarHero,this,[e])},_generaterMonster:function(e,t){var a=game.SceneRole.get(game.RoleType.ClientMonster,e),i=game.RoleData.get();return i.type=game.RoleType.ClientMonster,i.id=e,i.groupId=t,a.data=i,a},_generaterCollect:function(e,t){var a=game.SceneRole.get(game.RoleType.ClientCollect,e),i=game.RoleData.get();return i.type=game.RoleType.ClientCollect,i.id=e,i.groupId=t,a.data=i,a},_generaterCsWarMine:function(e){var t=e.idx,a=game.CsWarMine.get(game.RoleType.CsWarMine,t);return a.data=e,a},_generaterCsWarHero:function(e){var t=e.idx,a=game.CsWarPlayer.get(game.RoleType.CsWarHero,t);return a.data=e,a},createSceneClientMonster:function(){var e=this,t=game.sceneData.getConfig().id;e._monsterDataByScene.sceneId=t;for(var a=game.ClientMonsterGenCfg.getData(e._monsterDataByScene,!0),i=a.length,n=0;n<i;n++){var s=a[n],o=s.id,r=s.groupId,g=s.bodyResId,l=game.ResCfg.getUrl(5e3,g);e._addMonster(o,r,l)}},createSceneClientCollect:function(){var e=this,t=game.sceneData.getConfig().id;e._collectDataByScene.sceneId=t;for(var a=game.ClientCollectGenCfg.getData(e._collectDataByScene,!0),i=a.length,n=0;n<i;n++){var s=a[n],o=s.id,r=s.groupId,g=s.bodyResId,l=game.ResCfg.getUrl(5e3,g);e._addCollect(o,r,l)}},pickEntity:function(e){var t=this,a=e.data,i=t.getMainSceneDesigner(),n=game.sceneData.getConfig();if(n){if(n.type===game.SceneType.GUILD_MAP){if(a.type===game.RoleType.ClientMonster){i.setTrackTarget(e)}else if(a.type===game.RoleType.ClientCollect){i.setTrackTarget(e)}}else if(n.type===game.SceneType.CSWAR){if(i=t.getCsWarSceneDesigner(),1==game.csWarData.startState)return void game.notice.show(9002);var s=game.csWarTeamData;if(s.isInTeam&&!s.isLeader)return void game.notice.show(52215);i.checkPickTaget(e)}}},gotoEntityById:function(e){var t=game.sceneData.getConfig();if(t&&t.type===game.SceneType.CSWAR){var a=game.csWarTeamData;if(!a.isInTeam||a.isInTeam&&a.isLeader)this.getCsWarSceneDesigner().gotoEntityById(e)}},crossWarChallengeEnd:function(){var e=game.sceneData.getConfig();e&&e.type===game.SceneType.CSWAR&&this.getCsWarSceneDesigner().crossWarChallengeEnd()},_onEntityBeforeRemove:function(e){var t=e.data,a=game.sceneData.getConfig();a&&a.type===game.SceneType.GUILD_MAP&&(t.type===game.RoleType.ClientMonster?b8e.module.sendToControl(game.ME.GuildCollect,[game.GuildCollectEvts.V_PICK_MONSTER,t.groupId]):t.type===game.RoleType.ClientCollect&&b8e.module.sendToControl(game.ME.GuildCollect,[game.GuildCollectEvts.V_PICK_COLLECT]))},_onApproach:function(e){var t=this.getMainSceneDesigner(),a=e.data,i=game.sceneData.getConfig();i&&i.type===game.SceneType.GUILD_MAP&&(game.mainRole.getStateMachine().transition(game.RoleStateType.ACTION_IDLE),a.type===game.RoleType.ClientMonster?(t.removeEntity(a.type,a.id),t.setTrackTypes(null)):a.type===game.RoleType.ClientCollect&&(this._collectTween&&(this._collectTween.kill(this),this._collectTween=null),this._collectTween=b8e.Tween.get(this).wait(game.guildCollectData.collectTotalTime).call(function(){this._collectTween&&(this._collectTween.kill(this),this._collectTween=null),t.removeEntity(a.type,a.id)},this),game.module.show(game.ME.GuildCollectBar,null,!1)))},_onTrack:function(e){if(!game.mainRole.getStateMachine().isWalkMoving()){var t={x:e.gridX,y:e.gridY};game.moveTo.move(game.mainRole,t,1,1,!0)}}});t._instance=null,t.inst=function(){return null==t._instance&&(t._instance=new t),t._instance},b8e.RC("$$game","$$GameLevelMgr",e)}(),function(){var e,t=e=b8e.Object.extends({_sceneImages:null,_sceneDisplays:null,_weights:null,_totalWeight:0,_datas:null,ctor:function(){this._super(),this._sceneImages=[],this._sceneDisplays=[],this._weights=[],this._datas=[],this._totalWeight=0},play:function(e){this.stop();var t=game.ClientSceneEffectCfg.getData(e,!0,!1);if(t&&0<t.length){for(var a=0,i=this._sceneImages,n=this._sceneDisplays,s=this._weights,o=t.length,r=0,g=0;g<o;g++)for(var l=t[g],c=l.count;0<c;){if((this._datas[r]=l).imageName){var h=game.ResCfg.getUrl(4e3,l.imageName),m=b8e.Sprite.get(),u=b8e.SceneDisplay.get();u.addDisplay(m),m.loadTexture(h),i[r]=m,n[r]=u}else i[r]=null,n[r]=null;a+=l.weight,s[r]=a,r++,c--}this._totalWeight=a,this.runEffect()}},stop:function(){for(var e=this._sceneImages,t=e.length,a=0;a<t;a++)e[a];e.length=0;var i=this._sceneDisplays;t=i.length;for(var n=0;n<t;n++)i[n];i.length=0,this._weights.length=0,(this._totalWeight=0)<this._datas.length&&(b8e.Timer.remove(this,this.updateTime),this._datas.length=0)},runEffect:function(){b8e.Timer.add(this,this.updateTime,20)},updateTime:function(){for(var e=Math.random()*this._totalWeight>>0,t=this._weights,a=t.length,i=0,n=this._datas,s=-1,o=0;o<a;o++){var r=t[o];if(i<=e&&e<r){s=o;break}i=r}if(-1<s){var g=this._sceneDisplays[s];if(g&&!g.getScene()){var l=n[s],c=l.leftBorder,h=l.rightBorder,m=l.topBorder,u=l.bottomBorder;if(0==c&&0==h){var d=l.startPos[0],f=m+Math.random()*(u-m)>>0,p=l.endPos[0],_=m+Math.random()*(u-m)>>0,v=b8e.scene.sceneUIToGLPos(d,f);g.setPosition(v.x,v.y),v=b8e.scene.sceneUIToGLPos(p,_),b8e.Tween.kill(g);var E=b8e.MathUtil.getDegree(g.x,g.y,v.x,v.y);g.rotation=360-E+90,b8e.Tween.get(g).to({x:v.x,y:v.y},1e3).call(function(){b8e.scene.removeDisplay(g,!1)}),b8e.scene.addDisplay(g,1e4,!1)}else if(0==m&&0==u){var C=c+Math.random()*(h-c)>>0,T=l.startPos[1],A=c+Math.random()*(h-c)>>0,I=l.endPos[1],S=b8e.scene.sceneUIToGLPos(C,T);g.setPosition(S.x,S.y),S=b8e.scene.sceneUIToGLPos(A,I),b8e.Tween.kill(g);var R=b8e.MathUtil.getDegree(g.x,g.y,S.x,S.y);g.rotation=360-R+90,b8e.Tween.get(g).to({x:S.x,y:S.y},1e3).call(function(){b8e.scene.removeDisplay(g,!1)}),b8e.scene.addDisplay(g,1e4,!1)}else b8e.warn("\u4e0d\u652f\u6301\u7684\u8fd0\u52a8\u7c7b\u578b\u914d\u7f6e\uff1aid:"+l.id)}}}});t._instance=null,t.inst=function(){return null==t._instance&&(t._instance=new t),t._instance},b8e.RC("$$game","$$SceneEffectMgr",e)}(),function(){var e,t;t=b8e.Enum({SoundTypeNone:0,SoundTypeUpgrade:1,SoundTypeStar:2,SoundTypeStrengthen:3,SoundTypeTemper:4,SoundTypeMosaic:5,SoundTypeAttach:6,SoundTypeReceive:7,SoundTypeConsume:8,SoundTypeViewOpen:9,SoundTypeViewClose:10,SoundTypeEquip:11,SoundTypeTupo:12,SoundTypeGet:13,SoundTypeSmelt:14,SoundTypeActivation:15,SoundTypeGoBattle:16,SoundTypeVictory:17});var a=e=b8e.Object.extends({_viewSounds:null,ctor:function(){this._super(),this._viewSounds=b8e.HashMap.get();for(var e=game.ViewSoundCfg.getDatas(),t=e.length,a=0;a<t;a++){var i=e[a];this._viewSounds.set(i.moduleId,!0)}},playViewSound:function(e,t){null!=e&&this._viewSounds.has(e)&&this.playSoundByType(t)},playSoundByType:function(e){var t=game.MiscSoundCfg.getData(e);if(t){var a=game.SoundEffectsCfg.getData(t.soundId);a?b8e.sound.playEffectSound(a.url):b8e.error("\u627e\u4e0d\u5230\u97f3\u6548\u914d\u7f6e")}else b8e.error("\u627e\u4e0d\u5230\u7c7b\u578b\u97f3\u6548\u914d\u7f6e")}});a._instance=null,a.inst=function(){return null==a._instance&&(a._instance=new a),a._instance},b8e.RC("$$game","$$SoundEffectType",t),b8e.RC("$$game","$$SoundEffectMgr",e)}(),function(){var e,t=e=b8e.Object.extends({init:function(){b8e.evt.addG(this,game.TriggerEvts.C_TRIGGER_OPEN,this.triggerOpen),this.enterScene=!1,this.resKey=[],this.resValue=[],this.isLoading=!1},triggerOpen:function(e){if(e&&e.data){var t=e.data;if(-1==this.resKey.indexOf(t)){var a=game.ResLoadCfg.getData(t,1,!0,!1);!a||a.length<1||(this.resKey.push(t),this.resValue.push(a),this.resValue.sort(function(e,t){return t[0].priority-e[0].priority}),!this.isLoading&&this.enterScene&&this._beginLoad())}}},beginLoad:function(){this.enterScene=!0,b8e.hasTimeout(this._beginLoad,this)||b8e.setTimeout(this._beginLoad,this,5e3)},_beginLoad:function(){if(!this.isLoading&&this.resValue&&!(this.resValue.length<1)){for(var e=this.resValue.shift(),t=[],a=void 0,i=0,n=e.length;i<n;i++)a=e[i],t[t.length]={url:a.url,loadDepends:!0};b8e.res.loadBatchRes(t,this.batchLoadProcess,this),this.isLoading=!0}},batchLoadProcess:function(e,t,a,i){a==i&&(this.isPreProcessing||(this.isLoading=!1,this.haveNext()&&!b8e.hasTimeout(this._beginLoad,this)&&b8e.setTimeout(this._beginLoad,this,5e3)))},haveNext:function(){return this.resValue&&0<this.resValue.length}});t._instance=null,t.inst=function(){return null==t._instance&&(t._instance=new t,t._instance.init()),t._instance},b8e.RC("$$game","$$ResBackLoadMgr",e)}(),function(){var e;e=b8e.Enum({None:0,C_SELECTCHANGE:b8e.enc(),V_SELECTCHANGE:b8e.enc(),V_AUTO_UPGRADE:b8e.enc(),V_AUTOBUY:b8e.enc(),V_UPDATEHEADLIST:b8e.enc(),V_TOGGLECHANGE:b8e.enc(),V_UPDATE_DATA:b8e.enc(),UP_ANIMA:b8e.enc(),V_SCROLLLEFT:b8e.enc(),V_SCROLLRIGHT:b8e.enc()}),b8e.RC("$$game","$$CultivateBaseEvts",e)}(),function(){var e;e=game.Control.extends({isAuto:!1,shopEnum:0,autoBuyName:"_$autoBuy",isInfoUpgrade:!0,upgradeReq:function(e){var t=!(0<arguments.length&&void 0!==e)||e,a=this;if(a._canAddExp){if(t){var i=a.data.getCurInfo();if(!i||!i.active)return a.noActiveShow(),void a.setAuto(!1)}var n=a.getUpgradeCfg();a.autoBuyName=a.getAutoName();var s=b8e.getNormP(a.autoBuyName);game.autoBuyMgr.cultivateAutoBuyBegin(n.costItem,a.data[s],a.isAuto,a,a.upgradeCallback,a.shopEnum)&&(a.isAuto||(a._canAddExp=!1,b8e.Tween.kill(a),b8e.Tween.get(a).wait(200).call(function(){a._canAddExp=!0,b8e.Tween.kill(a)},a)),a.autoUpgradeReq(a.autoType))}},upgradeCallback:function(e){if(this.isPass=e){var t=b8e.module.isShowView(this.moduleEnum);this.autoBuyName=this.getAutoName();var a=b8e.getNormP(this.autoBuyName);t&&this.data[a]&&(this._canAddExp=!0,this.autoUpgradeReq(1))}else this.setAuto(!1)},setAuto:function(e){var t=!(0<arguments.length&&void 0!==e)||e;this.isAuto=t,this.send(game.CultivateBaseEvts.V_AUTO_UPGRADE,{isAuto:this.isAuto})},autoBuyBtn:function(){this.autoBuyName=this.getAutoName();var e=b8e.getNormP(this.autoBuyName);this.data[e]=!this.data[e],this.send(game.CultivateBaseEvts.V_AUTOBUY)},updateHeadList:function(){this.send(game.CultivateBaseEvts.V_UPDATEHEADLIST)},upgradeBtn:function(){this.isAuto||(this._canAddExp=!0,this.upgradeReq(this.isInfoUpgrade))},autoUpgradeBtn:function(){this.setAuto(!this.isAuto),this.isAuto&&(this._canAddExp=!0,this.isPass=!1,this.upgradeReq(this.isInfoUpgrade))},getUpgradeCfg:function(){return b8e.error("\u4f7f\u7528\u5347\u7ea7\u9700\u8986\u76d6"),null},autoUpgradeReq:function(){b8e.error("\u4f7f\u7528\u81ea\u52a8\u5347\u7ea7\u9700\u8986\u76d6\u8bf7\u6c42\u534f\u8bae")},getAutoName:function(){b8e.error("\u4f7f\u7528\u81ea\u52a8\u8d2d\u4e70\u8986\u76d6auto\u5b57\u6bb5")}}),b8e.RC("$$game","$$CultivateBaseControl",e)}(),function(){var e;e=game.Control.extends({init:function(){},touch:function(){game.module.hide(game.ME.CultivateBaseSkillTips2)}}),b8e.module.registerControl(game.ME.CultivateBaseSkillTips2,e),b8e.RC("$$game","$$CultivateBaseSkillTips2Control",e)}(),function(){var e;e=game.Control.extends({init:function(){},touch:function(){game.module.hide(game.ME.CultivateBaseSkillTips)}}),b8e.module.registerControl(game.ME.CultivateBaseSkillTips,e),b8e.RC("$$game","$$CultivateBaseSkillTipsControl",e)}();p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;e=b8e.Object.extends({infoClass:null,isInit:!1,allFightAmount:0,activeCount:0,selectId:0,singleSpriteStatList:null,totalSpriteStatList:null,ctor:function(e){this._super(),this.infoClass=e},initMap:function(){if(!this.isInit){var e=this.getInfoMap(),t=this.getInfoList();if(e&&t){var a=this.getDataCfgs();if(a){var i=void 0,n=this.infoClass;if(n){for(var s=0,o=a.length;s<o;s++){i=a[s];var r=new n;e.set(i.id,r),r.setCfgData(i),t.push(r)}this.sortInfoList()}else b8e.error("\u8fdb\u9636\u7ebf\u5b50\u7c7b\u5f15\u7528\u4e3a\u7a7a")}else b8e.error("\u8fdb\u9636\u7ebf\u57fa\u7840\u914d\u7f6e\u4e0d\u5b58\u5728")}else b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoMap\u6216infoList")}},setInfoList:function(e){if(e)for(var t=0,a=e.length;t<a;t++){var i=e[t];if(i){var n=this.getInfoById(i.id);n&&(n.setData(i),this.setInfoOtherOperate(n,i),n.active&&this.activeCount++)}}else b8e.error("\u6570\u636e\u4e3a\u7a7a")},setInfoOtherOperate:function(){},setBattleSlots:function(e){if(e)for(var t=void 0,a=void 0,i=0,n=e.length;i<n;i++)t=e[i],this.updateBattleSlot(t),(a=this.getInfoById(t.id))&&(a.battleSlot=t.slot);else b8e.error("\u6570\u636e\u4e3a\u7a7a")},updateBattleSlot:function(e){if(e){var t=this.getInfoBattleMap();t?0<e.slot&&0<e.id?t.set(e.slot,e.id):e.slot&&t.del(e.slot):b8e.error("\u672a\u521d\u59cb\u5316infoBattleMap")}},isInBattle:function(e){var t=this.getInfoById(e);if(t)return 0<t.battleSlot},onBattle:function(e,t){var a=this.getInfoBattleMap();if(a){var i=a.get(e);if(0<i&&this.unBattle(i),0<t){var n=this.getInfoById(t);if(!n)return;n.battleSlot=e,a.set(e,t)}}else b8e.error("\u672a\u521d\u59cb\u5316infoBattleMap")},unBattle:function(e){var t=this.getInfoBattleMap();if(t){var a=this.getInfoById(e);if(a&&a.battleSlot){var i=a.battleSlot;a.battleSlot=0,t.del(i)}}else b8e.error("\u672a\u521d\u59cb\u5316infoBattleMap")},sortInfoList:function(){var e=this.getInfoList();e&&1<e.length&&e.sort(this.infoSortFunc)},infoSortFunc:function(e,t){if(0<e.battleSlot&&t.battleSlot<=0)return-1;if(e.battleSlot<=0&&0<t.battleSlot)return 1;if(0<e.battleSlot&&0<t.battleSlot)return e.battleSlot-t.battleSlot;var a=e.id-t.id;return e.active&&!t.active?-1:!e.active&&t.active?1:e.active||t.active?e.isAlert&&!t.isAlert?-1:!e.isAlert&&t.isAlert?1:-a:e.isAlert&&!t.isAlert?-1:!e.isAlert&&t.isAlert?1:e.isAlert&&t.isAlert?-a:a},updateActiveCount:function(){var e=0,t=void 0,a=this.getInfoList();if(a){for(var i=0,n=a.length;i<n;i++)(t=a[i])&&t.active&&e++;this.activeCount=e}else b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoMap\u6216infoList")},updateAllFightAmount:function(){var e=0,t=void 0,a=this.getInfoList();if(a){for(var i=0,n=a.length;i<n;i++)(t=a[i])&&(t.updateFightAmount(),t.active&&(e+=t.fightAmount));this.allFightAmount=e+this.getOtherFightAmount()}else b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoMap\u6216infoList")},getOtherFightAmount:function(){return 0},getInfoSortList:function(){var e=this.getInfoList();if(e)return this.sortInfoList(),e;b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoList")},getInfoList:function(){return b8e.error("\u9700\u5b50\u7c7b\u8986\u76d6\u6b64\u65b9\u6cd5"),null},getInfoMap:function(){return b8e.error("\u9700\u5b50\u7c7b\u8986\u76d6\u6b64\u65b9\u6cd5"),null},getInfoBattleMap:function(){return b8e.error("\u9700\u5b50\u7c7b\u8986\u76d6\u6b64\u65b9\u6cd5"),null},getInfoBattleBySlot:function(e){var t=this.getInfoBattleMap().get(e);return this.getInfoById(t)},getDataCfgs:function(){return b8e.error("\u9700\u5b50\u7c7b\u8986\u76d6\u6b64\u65b9\u6cd5"),null},getMaxBattleCount:function(){return b8e.error("\u9700\u5b50\u7c7b\u8986\u76d6\u6b64\u65b9\u6cd5"),0},getUpgradeCfgByType:function(){return null},getInfoById:function(e){var t=this.getInfoMap();if(t)return t.get(e);b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoMap")},getCurInfo:function(){return this.getInfoById(this.selectId)},selectFirstInfo:function(){var e=this.getInfoList();e?e&&0<e.length&&this.selectInfoById(e[0].id):b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoList")},selectInfoById:function(e){var t=this.getInfoById(this.selectId),a=this.getInfoById(e);t&&(t.select=!1),a.select=!0,this.selectId=e},canInfoUpgrade:function(e,t,a){if(!e||!e.active)return!1;if(!e.getUpgradeCfgByType)return b8e.error("\u6b64\u65b9\u6cd5\u9700info\u4e2d\u5305\u542bgetUpgradeCfgByType\u65b9\u6cd5"),!1;var i=e.getUpgradeCfgByType(t,a);return!(!i||i.isMax)&&game.UpgradeUtil.checkUpgradeCost(i.costItem||i.costItems)},canInfoAsyncUpgrade:function(e,t,a,i,n){e&&e.active&&e.getUpgradeCfgByType?e.getUpgradeCfgByType(t,a,function(e){if(e&&!e.isMax){var t=game.UpgradeUtil.checkUpgradeCost(e.costItem);i(t,n)}else i(!1,n)}):i(!1,n)},canUpgrade:function(e,t){var a=this.getUpgradeCfgByType(e,t);return!(!a||a.isMax)&&game.UpgradeUtil.checkUpgradeCost(a.costItem)},canActive:function(e){if(!e||e.active)return!1;var t=e.cfg;return game.UpgradeUtil.checkUpgradeCost(t.costItem)},canBattle:function(e){if(!e)return!1;if(!e.active)return!1;var t=this.getInfoBattleMap();if(!t)return b8e.error("\u672a\u521d\u59cb\u5316infoBattleMap"),!1;var a=t.count(),i=this.isInBattle(e.id),n=this.getMaxBattleCount();return!i&&a<n},checkAllInfoCanAnyAlert:function(e){var t=void 0,a=!1,i=this.getInfoList();if(!i)return b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoList"),!1;if(!arguments.length)return b8e.error("\u81f3\u5c11\u6709\u4e00\u4e2a\u68c0\u6d4b\u65b9\u6cd5"),!1;var n=e;if((void 0===n?"undefined":p(n))!=b8e.TypeFunction)return b8e.error("\u68c0\u6d4b\u65b9\u6cd5\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570"),!1;for(var s=Array.prototype.slice.call(arguments),o=0,r=i.length;o<r;o++)if(t=i[o],s[0]=t,a=n.apply(this,s))return a;return a},checkAnyInfosCanAnyAlert:function(e,t){var a=void 0,i=!1;if(arguments.length<2)return b8e.error("\u81f3\u5c11\u6709\u4e00\u4e2a\u68c0\u6d4b\u65b9\u6cd5\u548c\u68c0\u6d4b\u5217\u8868"),!1;var n=e;if((void 0===n?"undefined":p(n))!=b8e.TypeFunction)return b8e.error("\u68c0\u6d4b\u65b9\u6cd5\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570"),!1;var s=t,o=Array.prototype.slice.call(arguments);o.splice(1,1);for(var r=0,g=s.length;r<g;r++)if(a=s[r],o[0]=a,i=n.apply(this,o))return i;return i},checkAsyncAllInfoCanAnyAlert:function(e){var t=void 0,a=this.getInfoList();if(!a)return b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoList"),!1;if(!arguments.length)return b8e.error("\u81f3\u5c11\u6709\u4e00\u4e2a\u68c0\u6d4b\u65b9\u6cd5"),!1;var i=e;if((void 0===i?"undefined":p(i))!=b8e.TypeFunction)return b8e.error("\u68c0\u6d4b\u65b9\u6cd5\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570"),!1;for(var n=arguments[arguments.length-1],s=Array.prototype.slice.call(arguments),o=s.length,r=0,g=a.length;r<g;r++){t=a[r],s[0]=t;s[o-1]=function(e,t){e&&n?(n(!0),n=null):t+1>=a.length&&n&&n(!1)},s[o]=r,i.apply(this,s)}},getShowTotalSpriteStat:function(){var e=arguments.length;if(!e)return b8e.error("\u9700\u4f20\u5165\u5c5e\u6027\u5b57\u6bb5\u540d\u79f0"),null;var t,a=0,i=0,n=void 0,s=void 0,o=void 0;if(!this.totalSpriteStatList)for(this.totalSpriteStatList=[],a=0;a<e;a++)o=arguments[a],(s=new game.CultivateBaseSpriteInfo).spriteStat=game.SpriteStat.get(),s.titleName=game.Lang.get(o.title),this.totalSpriteStatList.push(s);var r=this.getInfoList();if(!r)return b8e.error("\u672a\u521d\u59cb\u5316\u8fdb\u9636\u7ebfinfoList"),!1;for(a=0;a<e;a++)this.totalSpriteStatList[a].spriteStat.clear(),this.totalSpriteStatList[a].changeData();for(a=0,t=r.length;a<t;a++)if((n=r[a]).active)for(i=0;i<e;i++){o=arguments[i],s=this.totalSpriteStatList[i];var g=b8e.getNormP(o.statName);n[g]&&s.spriteStat.addSpriteStat(n[g])}return this.totalSpriteStatList},getShowSingleSpriteStat:function(e){var t=arguments.length;if(t<2)return b8e.error("\u9700\u4f20\u5165infoID\u548c\u5c5e\u6027\u5b57\u6bb5\u540d\u79f0"),null;var a,i=0,n=void 0,s=void 0,o=e;if(!o)return null;if(!this.singleSpriteStatList)for(this.singleSpriteStatList=[],i=1;i<t;i++)s=arguments[i],(n=new game.CultivateBaseSpriteInfo).spriteStat=game.SpriteStat.get(),n.titleName=game.Lang.get(s.title),this.singleSpriteStatList.push(n);for(i=0,a=this.singleSpriteStatList.length;i<a;i++)this.singleSpriteStatList[i].spriteStat.clear(),this.singleSpriteStatList[i].changeData();if(o)for(i=1;i<t;i++){s=arguments[i],n=this.singleSpriteStatList[i-1];var r=b8e.getNormP(s.statName);o[r]&&n.spriteStat.addSpriteStat(o[r])}return this.singleSpriteStatList}}),b8e.RC("$$game","$$CultivateBaseData",e)})(),function(){var e;e=b8e.Object.extends({id:0,name:0,lv:0,active:!1,select:!1,isAlert:!1,fightAmount:0,cfg:null,battleSlot:0,isShowStar:!1,isShowName:!1,isShowLv:!1,isShowBattle:!1,normalUrl:0,grayUrl:0,isShowEffect:!0,ctor:function(){this._super()},setCfgData:function(e){this.cfg=e},setData:function(){},updateFightAmount:function(){},getUpgradeCfgByType:function(){return null},getHaveSpriteType:function(e){if(e){var t=e.getSpriteStats(),a=[];return t.forEach(function(e,t){t&&a.push(parseInt(e))}),a}},setPerAttrToSpriteStat:function(a,i,n){var s=this;a&&i&&(a.clear(),a.setupByCfg(i),a.getSpriteStats().forEach(function(e,t){a.setStatValue(e,s.getTypeSpriteStatCount(i,n,e))}))},getTypeSpriteStatCount:function(e,t,a){if(!e)return 0;var i=0;0!=e.addExp&&null!=e.addExp&&(i=t/e.addExp);var n=game.KeyPerStatType[a];n=b8e.getNormP(n);var s=game.KeyByStatType[a];return s=b8e.getNormP(s),null!=e[n]&&null!=e[s]?e[n]*i+e[s]:0},getBattleOrWaitBattle:function(){return 0},getShowStepOrLv:function(){return 1}}),b8e.RC("$$game","$$CultivateBaseInfo",e)}(),function(){var e;e=game.BaseItemInfo.extends({change:!1,titleName:"",spriteStat:null,changeData:function(){this.change=!this.change}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CultivateBaseSpriteInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(282),this.setSize(540,156)},setData:function(){var i=this;if(i.skin){var n,s,e=i.data.spriteStat.getSpriteStats(),o=0,t=0<e.count();i.clearSpriteNum(),i.skin.titleLab.string=i.data.titleName,t&&e.forEach(function(e,t){var a=game.AttrRulesCfg.getData(e);o++;n=i.getComponent("spriteNumLab_"+o),s=i.getComponent("spriteLab_"+o),n.string=t,s.string=a.name+":",n.x=s.x+s.width},i)}},clearSpriteNum:function(){for(var e=1;e<=9;e++){var t=this.getComponent("spriteNumLab_"+e);t&&(t.string=" "),(t=this.getComponent("spriteLab_"+e))&&(t.string=" ")}}}),b8e.RC("$$game","$$CultivateBaseAttSpriteItem",e)}(),function(){var e;e=game.GameItemIcon.extends({battleIcon:null,nameLbl:null,lvLbl:null,info:null,starLab:null,mainRoleIcon:null,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.GRID_SIZE_105;this._super(t)},setIconData:function(e){if(this.info=e){this._setConfig(e.cfg);var t=void 0;t=e.isMainRole?game.ResCfg.getHead(game.mainRoleData.isMale):game.ResCfg.getUrl(e.active?e.normalUrl:e.grayUrl,null==e.cfg.icon?e.cfg.photo:e.cfg.icon),this.setIcon(t)}else this.clearData()},setData:function(e){var t=this;if(t.info=e){t.setIconData(e);var a=e.active;a&&e.isShowLv?t.setLv(e.lv):t.removeLv(),e.isShowName?t.setName():t.removeNameLbl(),e.isShowBattle?t.showBattle():t.removeBattleState(),e.isShowEffect&&t.setEffect(),t.setElement(e.cfg,a),t.setStar(e,a),e.isMainRole?t.addMainRoleIcon():t.removeMainRoleIcon()}else t.clearData()},_setConfig:function(e){if(e){var t=0;t=this.info&&null!=this.info.quality&&this.info.quality?this.info.quality:e.quality,this.setBgImage(game.ResCfg.getQualityBg(t)),this.addIconImage()}},setName:function(){var e=this,t=0;t=e.info&&null!=e.info.quality&&e.info.quality?e.info.quality:e.info.cfg.quality;var a=game.HtmlUtil.getColorStrByQuality(t,e.info.name||e.info.cfg.name);e.addNameLbl(),e.nameLbl.setText(a);var i=.5*e.nameLbl.width;e.nameLbl.setPosition(-i,-81)},addNameLbl:function(){this.nameLbl||(this.nameLbl=b8e.RichText.get(),this.nameLbl.setFontSize(20)),this.nameLbl.parent||(this.addChild(this.nameLbl),this.nameLbl.setVisible(!0))},removeNameLbl:function(){this.nameLbl&&this.nameLbl.removeFromParent()},setLv:function(e){this.addLvLbl();var t=1==this.info.getShowStepOrLv()?"L"+e:e+"J";this.lvLbl.setText(t)},addLvLbl:function(){var e=this.lvLbl;e||((e=this.lvLbl=b8e.Label.get()).setAnchor(.5,0),e.setFontSize(35),e.setLineHeight(35),this.addLvParent(),e.setFontFile(b8e.ResMgr.UI_ROOT+"/app/font/cultivateLv/cultivateLv.bbf")),this.addLvParent()},addLvParent:function(){var e=this.lvLbl;e&&!e.parent&&(this.addChild(e),e.setPosition(this.info.isMainRole?7:0,-65),e.setVisible(!0))},removeLv:function(){this.lvLbl&&this.lvLbl.removeFromParent()},addBattleState:function(){this.battleIcon||(this.battleIcon=b8e.Sprite.get()),this.battleIcon.parent||this.addChild(this.battleIcon),this.battleIcon.setPosition(-50,-8)},removeBattleState:function(){if(this.battleIcon){this.battleIcon.removeFromParent()}},clearData:function(){this.setIcon(),this.setBgImage(),this.removeBattleState(),this.removeLv(),this.removeStar(),this.nameLbl&&this.nameLbl.removeFromParent(),this._effect&&this._effect.clear()},setIconImgPos:function(){this.iconImg&&this.iconImg.parent&&this.iconImg.setPosition(0,2)},setElement:function(e,t){if(e){e.element?this.setIconElement(e.element,t):this.removeElement()}},setIconElement:function(e,t){if(this.addElement(),this.element){var a=t?10048:10049,i=game.ResCfg.getUrl(a,e);this.element.loadTexture(i)}},addElement:function(){this.element||(this.element=b8e.Sprite.get(),this.element.setPosition(15,15)),this.element.parent||this.addChild(this.element)},removeElement:function(){this.element&&this.element.removeFromParent()},setStar:function(e,t){e.isShowStar&&t&&!e.isMainRole?(this.addStar(),this.starLab.setText(e.star)):this.removeStar()},addStar:function(){var e=this;e.starBg||(e.starBg=b8e.Sprite.get(),e.starBg.setAnchor(.5,.5),e.starBg.setScale(.7,.7),e.starBg.setPosition(45,-30),e.starBg.loadTexture(game.ResCfg.getUrl(10078))),e.starLab||(e.starLab=b8e.Label.get(),e.starLab.setAnchor(.5,.5),e.starLab.setPosition(45,-32),e.starLab.setColor(game.Color.BLACK),e.starLab.setFontSize(18)),e.starBg.parent||e.addChild(e.starBg),e.starLab.parent||e.addChild(e.starLab)},removeStar:function(){this.starBg&&this.starBg.removeFromParent(),this.starLab&&this.starLab.removeFromParent()},addMainRoleIcon:function(){this.mainRoleIcon||(this.mainRoleIcon=b8e.Sprite.get(),this.mainRoleIcon.setPosition(-55,-42),this.mainRoleIcon.loadTexture(game.ResCfg.getUrl(10079))),this.mainRoleIcon.parent||this.addChild(this.mainRoleIcon)},removeMainRoleIcon:function(){this.mainRoleIcon&&this.mainRoleIcon.removeFromParent()},showBattle:function(){var e=void 0,t=this.info.getBattleOrWaitBattle();2==t?e=10008:1==t?e=10009:this.removeBattleState(),e&&(this.addBattleState(),this.battleIcon.loadTexture(game.ResCfg.getUrl(e)))},setEffect:function(){var e=this;if(e.info){var t=e.info.cfg,a=void 0;if(a=e.info.isMainRole?game.CCommonUtil.getqualityEffect(e.info.quality):0<e.info.qualityNum?game.CCommonUtil.getqualityEffect(e.info.quality):t.qualityEffect&&""!=t.qualityEffect?t.qualityEffect:game.CCommonUtil.getqualityEffect(t.quality)){e._effect||(e._effect=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)),e._effect&&!e._effect.parent&&e.addChild(e._effect);var i=game.ResCfg.getUrl(5022,a);i&&(e._effect.setVisible(!0),e._effect.load(i),e._effect.play())}else e._effect&&(e._effect.setVisible(!1),e._effect.stop())}}}),b8e.RC("$$game","$$CultivateBaseIcon",e)}(),function(){var e;e=game.ListItem.extends({icon:null,ctor:function(e){this._super(e||159),this.setSize(114,155)},init:function(){this.icon=new game.CultivateBaseIcon,this.icon.setEffect=this.setEffect,this.icon.addToParent(this.skin.icon)},setEffect:function(){},setData:function(e){this.icon.setData(e),this.setSelect(),this.setAlert(e),this.setStar(e)},setAlert:function(e){this.skin.redPoint.node.active=e.isAlert},setSelect:function(){this.skin.headSelect.node.active=this.data.select},touchIcon:function(){this.send(game.CultivateBaseEvts.C_SELECTCHANGE,{id:this.data.id,extend:this.data})},setStar:function(e){e.isShowItemStar&&e.active?(this.addStar(),this.starLab.setText(e.star)):this.removeStar()},addStar:function(){var e=this;e.starBg||(e.starBg=b8e.Sprite.get(),e.starBg.setAnchor(.5,.5),e.starBg.setScale(.7,.7),e.starBg.setPosition(45,-30),e.starBg.loadTexture(game.ResCfg.getUrl(10078))),e.starLab||(e.starLab=b8e.Label.get(),e.starLab.setAnchor(.5,.5),e.starLab.setPosition(45,-32),e.starLab.setColor(game.Color.BLACK),e.starLab.setFontSize(18)),e.starBg.parent||e.skin.starNode.addChild(e.starBg),e.starLab.parent||e.skin.starNode.addChild(e.starLab)},removeStar:function(){this.starBg&&this.starBg.removeFromParent(),this.starLab&&this.starLab.removeFromParent()}}),b8e.RC("$$game","$$CultivateBaseListItem",e)}(),function(){var e;e=game.View.extends({showProgEffect:function(e){e&&this._setFrameEffect(e)},_setFrameEffect:function(e){var t=this;t._tmpProgFrameEffNode||(t._tmpProgFrameEffNode=b8e.Sprite.get(),t._tmpProgFrameEffNode.addToParent(e),t._tmpProgFrameEffNode.setAnchor(.5,.5)),t._progFrameEff||(t._progFrameEff=b8e.Animator.get(game.AnimType.UI_EFFECT,1),t._progFrameEff.addToParent(t._tmpProgFrameEffNode),t._progFrameEff.setScale(e.width/504,1),t._progFrameEff.load(game.ResCfg.getUrl(5019,1085)),t._progFrameEff.addFinishCallback(t._onProgFrameEffect,t)),t._progFrameEff.active=!0,t._progFrameEff.play(null,0)},_onProgFrameEffect:function(){this._progFrameEff.active=!1}}),b8e.RC("$$game","$$CultivateBaseView",e)}(),function(){var e;e=game.CultivateBaseView.extends({_modelMap:null,ctor:function(e){this._super(e)},initModel:function(){this._modelMap||(this._modelMap=b8e.HashMap.get());var e=arguments.length;if(e)for(var t=void 0,a=void 0,i=0;i<e;i++)(t=arguments[i])&&t.type&&t.node?(t.type==game.RoleType.Hero?(a=game.sceneRoleCreate.createUIRole(game.mainRoleData)).addToParent(t.node):((a=new game.SurfaceModel).addToParent(t.node),a.initModel(),a.roleData.heroModel.type=t.type),this._modelMap.set(t.type,a)):b8e.error("initModel\u53c2\u6570\u5f02\u5e38")},updateModel:function(e,t){var a=this._modelMap.get(e);a?(this._hideModel(e),game.AvatarUtil.updateModel(t,a,e)):b8e.error("\u4e0d\u5b58\u5728\u7c7b\u578b",e,"\u7684\u6a21\u578b")},updateModel2:function(e,t){var a=this._modelMap.get(e);a?(this._hideModel(e),game.AvatarUtil.updateModel2(t,a,e)):b8e.error("\u4e0d\u5b58\u5728\u7c7b\u578b",e,"\u7684\u6a21\u578b")},updateRoleModel:function(){var e=this._modelMap.get(game.RoleType.Hero);e?(this._hideModel(game.RoleType.Hero),game.AvatarUtil.updateUIModel(e,1,!0),e.transition(game.RoleStateType.ACTION_IDLE)):b8e.error("\u4e0d\u5b58\u5728\u4eba\u7269\u7684\u6a21\u578b")},_hideModel:function(a){this._modelMap.forEach(function(e,t){t.setVisible(e==a)},this)},showModelEffectByImg:function(e){this.showModelEffect(e)},showModelEffect:function(e){if(e){this._modelEffect||(this._modelEffect=b8e.Animator.get(game.AnimType.UI_EFFECT,1),this._modelEffect.addToParent(e),this._modelEffect.load(game.ResCfg.getUrl(5019,1077)),this._modelEffect.addFinishCallback(this._onModelEffectFinish,this)),this._modelEffect.active=!0,this._modelEffect.play(null,0)}},_onModelEffectFinish:function(){this._modelEffect.active=!1}}),b8e.RC("$$game","$$CultivateBaseModelView",e)}(),function(){var e;e=game.GameIcon.extends({skillNameLab:null,skillNameBg:null,skillId:0,skillParam:null,showMainSKillIcon:!1,showPassiveSKillIcon:!0,showNewSKillIcon:!1,isShowTips:!0,clickCallBack:null,normalUrl:62,grayUrl:62,grayQuality:0,isShowIconBg:!0,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.CIRCLE_SIZE_104,a=this;a._super(t),a._iconBg=b8e.Sprite.get(),a._iconBg.setAnchor(.5,.5),a.addChild(a._iconBg),a._iconImg=b8e.Sprite.get(),a._iconImg.setAnchor(.5,.5),a.addChild(a._iconImg),b8e.evt.onC(a,a.fnOnClickGrid,a)},setClickCallBack:function(e,t){this.clickCallBack={callBack:e,thisArg:t}},fnOnClickGrid:function(){if(this.skillId&&this.isShowTips&&this.clickCallBack){var e={};e.skillId=this.skillId,e.skillParam=this.skillParam,this.clickCallBack.callBack.call(this.clickCallBack.thisArg,e)}},setData:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this.clearData(),this.skillId=e,this._updateSkillData(game.SkillCfg.getData(e),a),this.showNewSKillIcon&&this.addNewSKillIcon()},_updateSkillData:function(e,t){if(e){this.setSkillData(e,t),0==e.clientType&&this.showMainSKillIcon&&this.addMainSkillIcon(),1==e.clientType&&this.showPassiveSKillIcon&&this.addPassiveSKillIcon()}},setSkillData:function(e,t){if(e){var a;this.isShowIconBg?this.setBgImage(t?this.grayQuality:e.quality,!0):this.setBgImage(""),a=game.ResCfg.getUrl(t?this.grayUrl:this.normalUrl,e.icon),this.setIcon(a,.72,.72),this.addIconImage(),this.removeLock()}else b8e.error("\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6280\u80fd")},setShowMainSkillIcon:function(e){this.showMainSKillIcon=!!e},setShowPassiveSkillIcon:function(e){this.showPassiveSKillIcon=!!e},setShowNewSkillIcon:function(e){this.showNewSKillIcon=!!e},setShowTips:function(e){this.isShowTips=e},getBgUrl:function(e){return game.ResCfg.getUrl(74,e)},calIconSize:function(){return this._imgSize/game.IconSizeEnum.CIRCLE_SIZE_104*game.IconSizeEnum.CIRCLE_SIZE_84},setEmpty:function(){this.skillId=0,this.clearData(),this.setBgImage("skillBg"),this.setIcon("")},setLock:function(){this.skillId=0,this.clearData(),this.setIcon(),this.setBgImage("0"),this.addLock()},addLock:function(){if(!this.lockImg){this.lockImg=b8e.Sprite.get();var e=this.getBgUrl("lock");this.lockImg.loadTexture(e),this.lockImg.setAnchor(.5,.5)}this.lockImg.parent||this.addChild(this.lockImg)},removeLock:function(){this.lockImg&&this.lockImg.removeFromParent()},addMainSkillIcon:function(){this.mainIcon||(this.mainIcon=b8e.Sprite.get()),this.setTypeIcon(this.mainIcon,10014)},addPassiveSKillIcon:function(){this.passiveIcon||(this.passiveIcon=b8e.Sprite.get()),this.setTypeIcon(this.passiveIcon,10016)},addNewSKillIcon:function(){this.newIcon||(this.newIcon=b8e.Sprite.get()),this.setTypeIcon(this.newIcon,10054)},setTypeIcon:function(e,t){var a=game.ResCfg.getUrl(t);if(e.loadTexture(a),!e.parent){this.addChild(e);var i=this.getOffsetScale();e.setPosition(-50- -50*i,10)}},removeMainSKillIcon:function(){this.mainIcon&&this.mainIcon.removeFromParent()},removePassiveSKillIcon:function(){this.passiveIcon&&this.passiveIcon.removeFromParent()},removeNewSKillIcon:function(){this.newIcon&&this.newIcon.removeFromParent()},setName:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:game.Color.WHITE,n=2<arguments.length&&void 0!==a&&a;this.addName();var s=e;i!==game.Color.WHITE&&(s=game.HtmlUtil.getColorStrByQuality(i,e,!1)),this.skillNameLab.setText(s),this.skillNameBg&&this.skillNameBg.setSize(this.skillNameLab.width+10,33),n&&(s=game.HtmlUtil.getText(game.Color.WHITE,e),this.skillNameLab.setText(s))},addName:function(){var e=this;if(!e.skillNameBg){e.skillNameBg=b8e.Sprite.get(),e.skillNameBg.setAnchor(.5,.5),e.skillNameBg.scale9Inset={top:16,bottom:16,left:16,right:16},e.skillNameBg.setStyle(b8e.SpriteStyle.SLICED);var t=game.ResCfg.getUrl(10015);e.skillNameBg.loadTexture(t)}e.skillNameLab||(e.skillNameLab=b8e.RichText.get(),e.skillNameLab.setAnchor(.5,.5),e.skillNameLab.setFontSize(20)),e.skillNameBg.parent||(e.addChild(e.skillNameBg,98),e.skillNameBg.setPosition(0,-45)),e.skillNameLab.parent||(e.addChild(e.skillNameLab,99),e.skillNameLab.setPosition(0,-45))},removeName:function(){this.skillNameLab&&this.skillNameLab.removeFromParent(),this.skillNameBg&&this.skillNameBg.removeFromParent()},addFlyLock:function(){if(!this.flyLock){this.flyLock=b8e.Sprite.get(),this.flyLock.setScale(.8,.8);var e=game.ResCfg.getUrl(10017);this.flyLock.loadTexture(e)}if(!this.flyLock.parent){this.addChild(this.flyLock);var t=this.getOffsetScale();this.flyLock.setPosition(10-10*t,10)}},getOffsetScale:function(){return 1-this._iconSize/game.IconSizeEnum.CIRCLE_SIZE_104},removeFlyLock:function(){this.flyLock&&this.flyLock.removeFromParent()},setNormalUrlId:function(e){this.normalUrl=e},setGrayUrlId:function(e){this.grayUrl=e},setGrayQuality:function(e){this.grayQuality=e},setIconGray:function(e){game.ShaderUtil.setGray(this._iconImg,e)},clearData:function(){this.removeName(),this.removeFlyLock(),this.removePassiveSKillIcon(),this.removeMainSKillIcon(),this.removeNewSKillIcon(),this.removeLock()}}),b8e.RC("$$game","$$CultivateBaseSkillIcon",e)}(),function(){var e;game.skillTipsInfo=null,e=game.View.extends({_showModel:!0,ctor:function(){this._super(284)},init:function(){this.skillIcon=new game.CultivateBaseSkillIcon,this.skillIcon.addToParent(this.skin.skillNode)},onShow:function(){this.updateData()},updateData:function(){this.skin;var e=game.skillTipsInfo;if(null!=e){var t=e.skillId;this.skillIcon.setData(t),this._updateSkillData(game.SkillCfg.getData(t))}},_updateSkillData:function(e){if(e){var t=this,a=t.skin,i=e.quality,n=e.name;0==e.clientType?a.skillType.string=game.Lang.get(4812):a.skillType.string=game.Lang.get(4832),a.skillName.string=game.HtmlUtil.getColorStrByQuality(i,n,!0),t.pArr||(t.pArr=[]);for(var s=t.pArr.length=0;s<e.descParam.length;s++){var o=e.descParam[s];t.pArr.push(t.stripNum(+o))}t.skin.skillDes.string=game.LangSkill.get(e.desc,t.pArr),t.skin.node_2.y=0-t.skin.node_1.height,t.skin.node_2.height=20+t.skin.skillDesTitle.height+2+t.skin.skillDes.height+20,t.skin.tipsbg.height=t.skin.node_1.height+t.skin.node_2.height}},stripNum:function(e,t){var a=1<arguments.length&&void 0!==t?t:12;return+parseFloat(e.toPrecision(a))}}),b8e.module.registerView(game.ME.CultivateBaseSkillTips,e),b8e.RC("$$game","$$CultivateBaseSkillTipsView",e)}(),function(){var e;game.skillTips2Info={skillId:0,skillLv:0,nextSkillId:0,skillMaxLv:0,skillDesUpTitle:"",skillDesUpStr:"",isZeroActive:!1},e=game.View.extends({_showModel:!0,ctor:function(){this._super(283)},init:function(){this.skillIcon=new game.CultivateBaseSkillIcon,this.skillIcon.setShowMainSkillIcon(!0),this.skillIcon.setShowPassiveSkillIcon(!0),this.skillIcon.addToParent(this.skin.skillNode)},onShow:function(){this.updateData()},onHide:function(){game.skillTips2Info={skillId:0,skillLv:0,nextSkillId:0,skillMaxLv:0,skillDesUpTitle:"",skillDesUpStr:""}},updateData:function(){var e=this.skin,t=game.skillTips2Info;if(null!=t){var a=t.skillId,i=t.nextSkillId,n=t.skillLv;this.skillIcon.setData(a),this._updateCurSkillData(game.SkillCfg.getData(a),t);var s="";s=""==t.skillDesUpTitle?game.Lang.get(50144):t.skillDesUpTitle,e.skillDesUpTitle.string=s,n+1<=t.skillMaxLv?this._updateNextSkillData(game.SkillCfg.getData(i),t):(e.skillDesNext.string=game.Lang.get(50101),e.skillDesUp.string=game.Lang.get(50101),this._layoutSkillTipsView(t))}},_updateCurSkillData:function(e,t){var a=this.skin;if(e){var i=e.quality,n=e.name,s=t.skillLv;a.skillName.string=game.HtmlUtil.getColorStrByQuality(i,n,!0),a.skillLv.string=s,this.pArr||(this.pArr=[]);for(var o=this.pArr.length=0;o<e.descParam.length;o++){var r=e.descParam[o];this.pArr.push(this.stripNum(+r))}t.isZeroActive?(a.skillDes.color=game.Color.GREEN,a.skillDes.string=game.LangSkill.get(e.desc,this.pArr)):(a.skillDes.color=0<s?game.Color.GREEN:game.Color.RED,a.skillDes.string=0==s?game.Lang.get(50138):game.LangSkill.get(e.desc,this.pArr))}},_updateNextSkillData:function(e,t){var a=this.skin;if(e){this.pNextArr||(this.pNextArr=[]);for(var i=this.pNextArr.length=0;i<e.descParam.length;i++){var n=e.descParam[i];this.pNextArr.push(this.stripNum(+n))}a.skillDesNext.string=game.LangSkill.get(e.desc,this.pNextArr),a.skillDesUp.string=t.skillDesUpStr,this._layoutSkillTipsView(t)}},_layoutSkillTipsView:function(e){var t=this.skin;t.node_2.y=0-t.node_1.height,t.node_2.height=20+t.skillDesTitle.height+2+t.skillDes.height+20,t.node_3.y=0-t.node_1.height-t.node_2.height,t.node_3.height=20+t.skillDesNextTitle.height+2+t.skillDesNext.height+20,t.node_4.y=0-t.node_1.height-t.node_2.height-t.node_3.height,""==e.skillDesUpStr?(t.node_4.height=0,t.node_4.setVisible(!1)):(t.node_4.height=20+t.skillDesUpTitle.height+2+t.skillDesUp.height+20,t.node_4.setVisible(!0)),t.tipsbg.height=t.node_1.height+t.node_2.height+t.node_3.height+t.node_4.height},stripNum:function(e,t){var a=1<arguments.length&&void 0!==t?t:12;return+parseFloat(e.toPrecision(a))}}),b8e.module.registerView(game.ME.CultivateBaseSkillTips2,e),b8e.RC("$$game","$$CultivateBaseSkillTips2View",e)}(),function(){var e;e=game.GamePanel.extends({showProgEffect:function(e){e&&this._setFrameEffect(e)},_setFrameEffect:function(e){var t=this;t._tmpProgFrameEffNode||(t._tmpProgFrameEffNode=b8e.Sprite.get(),t._tmpProgFrameEffNode.addToParent(e),t._tmpProgFrameEffNode.setAnchor(.5,.5)),t._progFrameEff||(t._progFrameEff=b8e.Animator.get(game.AnimType.UI_EFFECT,1),t._progFrameEff.addToParent(t._tmpProgFrameEffNode),t._progFrameEff.setScale(e.width/504,1),t._progFrameEff.load(game.ResCfg.getUrl(5019,1085)),t._progFrameEff.addFinishCallback(t._onProgFrameEffect,t)),t._progFrameEff.active=!0,t._progFrameEff.play(null,0)},_onProgFrameEffect:function(){this._progFrameEff.active=!1}}),b8e.RC("$$game","$$CultivateNewBaseView",e)}(),function(){var e;e=game.CultivateNewBaseView.extends({_modelMap:null,ctor:function(e){this._super(e)},initModel:function(){this._modelMap||(this._modelMap=b8e.HashMap.get());var e=arguments.length;if(e)for(var t=void 0,a=void 0,i=0;i<e;i++)(t=arguments[i])&&t.type&&t.node?(t.type==game.RoleType.Hero?(a=game.sceneRoleCreate.createUIRole(game.mainRoleData)).addToParent(t.node):((a=new game.SurfaceModel).addToParent(t.node),a.initModel(),a.roleData.heroModel.type=t.type),this._modelMap.set(t.type,a)):b8e.error("initModel\u53c2\u6570\u5f02\u5e38")},updateModel:function(e,t){var a=this._modelMap.get(e);a?(this._hideModel(e),game.AvatarUtil.updateModel(t,a,e)):b8e.error("\u4e0d\u5b58\u5728\u7c7b\u578b",e,"\u7684\u6a21\u578b")},updateModel2:function(e,t){var a=this._modelMap.get(e);a?(this._hideModel(e),game.AvatarUtil.updateModel2(t,a,e)):b8e.error("\u4e0d\u5b58\u5728\u7c7b\u578b",e,"\u7684\u6a21\u578b")},updateRoleModel:function(){var e=this._modelMap.get(game.RoleType.Hero);e?(this._hideModel(game.RoleType.Hero),game.AvatarUtil.updateUIModel(e,1,!0),e.transition(game.RoleStateType.ACTION_IDLE)):b8e.error("\u4e0d\u5b58\u5728\u4eba\u7269\u7684\u6a21\u578b")},_hideModel:function(a){this._modelMap.forEach(function(e,t){t.setVisible(e==a)},this)},showModelEffectByImg:function(e){this.showModelEffect(e)},showModelEffect:function(e){if(e){this._modelEffect||(this._modelEffect=b8e.Animator.get(game.AnimType.UI_EFFECT,1),this._modelEffect.addToParent(e),this._modelEffect.load(game.ResCfg.getUrl(5019,1077)),this._modelEffect.addFinishCallback(this._onModelEffectFinish,this)),this._modelEffect.active=!0,this._modelEffect.play(null,0)}},_onModelEffectFinish:function(){this._modelEffect.active=!1}}),b8e.RC("$$game","$$CultivateNewBaseModelView",e)}(),function(){var e;e=b8e.Enum({NONE:0,G_RESTAR_AI:b8e.enc(),G_START_PLAY:b8e.enc(),G_STOP_PLAY:b8e.enc(),G_SHOWITEMS:b8e.enc(),G_REQ_HELP:b8e.enc(),G_SKILL_RELEASE:b8e.enc(),G_SKILL_HIT:b8e.enc(),G_ROUND_CHANGE:b8e.enc(),SYNC_INSTANCE_DATA:b8e.enc(),C_UPDATE_CHALLENGE_NUM:b8e.enc(),C_BOSSCHALLENGE_RESULT:b8e.enc(),C_START_MAIN_INSTANCE:b8e.enc(),C_UPDATE_VIEW:b8e.enc(),C2C_WORLD_WAR_TEAM_STOP_PLAY:b8e.enc(),C2C_WORLD_WAR2_TEAM_STOP_PLAY:b8e.enc(),C_UPDATE_CHALLENGE:b8e.enc(),C_UPDATE_BOSS_DAMGE:b8e.enc(),C_UPDATE_GUILD_NEW_BOSS_DMG:b8e.enc()}),b8e.RC("$$game","$$InstanceEvts",e)}(),function(){var e=game.Control.extends({lastChallTime:0,curChallTime:0,ipc:function(){var e=this;e.gevts={InstanceEvts:{G_RESTAR_AI:e.restartAi,G_STOP_PLAY:e.restartAi,G_START_PLAY:e.stopPlay},SceneGEvts:{LEAVE_SCENE:e.stopPlay,FIRST_ENTER_SCENE:e.instanceDataReq,ENTER_XEPLORE_SCENE:e.stopPlay,LEAVE_XEPLORE_SCENE:e.restartAi},ChatEvts:{C_CHAT_FUNC_HELP:e.onReqHelp}},e.evts={MainInstance:{C_REQ_SEEKHELP:e.onReqSeekHelp},MainRole:{C_RESET_DAILY:e.resetDaily},InstanceSuccess:{C2C_REQ_SEEKHELP:e.onReqSeekHelp},MainUIRight:{C_AUTO_FIGHT_CHANGE:e.autoFightChange}},e.handels={ChallengeResp:e.onChallengeResp,InsDataResp:e.syncInstanceData,SeekHelpResp:e.onSeekHelpResp,HelpResp:e.onHelpResp,HelpMsg:e.onHelpNotify,BattleTestResp:e.onBattleTest}},init:function(){game.testSender=this.sender},autoFightChange:function(){!game.playBack.isFighting&&game.mainInstanceData.autoFight&&this._timer&&!this._timer.running&&this.startInstanceTime()},onBattleTest:function(e){var t=e.readProtobuf(game.pb.BattleLog);game.playBack.play(t)},resetDaily:function(){this.instanceDataReq()},instanceDataReq:function(){this.sender.InsDataReq()},syncInstanceData:function(e){var t=e.readProtobuf(game.pb.InstanceDataResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(game.InstanceEvts.SYNC_INSTANCE_DATA,t),game.InsFunCountData.insChallengeTimes=t.insChallengeTimes)},stopPlay:function(){game.GameLevelMgr.inst().isInstanceMode&&(game.mainRole.stopAi(),game.scene.clearSceneMonster()),this._timer&&this._timer.stop()},restartAi:function(){game.scene.isDelayRun||game.GameLevelMgr.inst().isInstanceMode&&(game.playBack.isFighting||game.exploreScene.isInExploreScene()||(game.mainRole.runAi(),game.scene.createPartners(game.mainRole,game.partnerData.partnerSlots),this.startInstanceTime()))},startInstanceTime:function(){var a=this;a._timer||(a._timer=b8e.Timer.add(a,a.onReqChallenge,5e3,1));var i=game.mainInstanceData.id;i?game.InstanceCfg.getDataAsync(i,function(e){var t=5e3;e?t=1e3*e.interval:b8e.warn("\u6253\u91ce\u914d\u7f6e\u4e0d\u5b58\u5728id\uff1a",i),t=Math.max(5e3,t),a._onStart(t+500)},a):a._onStart(5e3)},_onStart:function(e){this._timer.delay=e,this._timer.reset(),this._timer.start()},onReqChallenge:function(){this._reqChallenge()},_reqChallenge:function(){var t=this;if(b8e.TriggerMgr.inst()._triggerInited&&!b8e.module.isShowView(game.ME.Welcome)){var a=game.mainInstanceData.id;t._interval=5e3,game.InstanceCfg.getDataAsync(a,function(e){e?t._interval=1e3*e.interval:b8e.warn("\u6253\u91ce\u914d\u7f6e\u4e0d\u5b58\u5728id\uff1a",a),t._interval=Math.max(5e3,t._interval)},t),game.SysTime.curTime-t.lastChallTime<t._interval||(t.sender.ChallengeReq(),t.lastChallTime=game.SysTime.curTime,t.dpt(t.Evts.C_UPDATE_CHALLENGE))}},onChallengeResp:function(e){var t=e.readProtobuf(game.pb.ChallengeResponse);0<t.code?game.notice.noticeError(t.code):(game.ServerItemUtil.analyzeItems(t,1,!0),this.dpt(game.InstanceEvts.C_UPDATE_CHALLENGE_NUM),this.startInstanceTime())},onSeekHelpResp:function(e){var t=e.readProtobuf(game.pb.SeekHelpResponse);0<t.code?game.notice.noticeError(t.code):(game.mainInstanceData.reqNum++,this.dpt(this.Evts.C_UPDATE_VIEW),game.module.hide(game.ME.MainInstanceHelp))},onHelpResp:function(e){var t=e.readProtobuf(game.pb.HelpResponse);0<t.code?game.notice.noticeError(t.code):(game.mainInstanceData.helpNum++,this.dpt(this.Evts.C_UPDATE_VIEW),this._playNotice(t))},onHelpNotify:function(e){var t=e.readProtobuf(game.pb.HelpNotify);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.nextInstanceId;game.mainInstanceData.beHelp(a),this._playNotice(t,!0)}},_playNotice:function(e,t){var a=1<arguments.length&&void 0!==t&&t;if(e.battleLog){e.battleLog.win||game.notice.show(9033),a&&game.module.hide(game.ME.Instance),game.GameViewMgr.inst().hideUnStrongViews(),this._play(e,game.InstanceType.CHUANG_GUAN)}},_play:function(e,t){var a={type:t,rewards:e.useritem,exp:e.exp};game.playBack.play(e.battlelog,a)},onReqSeekHelp:function(e){if(!game.UpgradeUtil.checkEquipTooMuch()){var t=e.data;this.sender.SeekHelpReq(t)}},onReqHelp:function(e){var t=e.data;if(t)if(game.mainInstanceData.helpNum>=game.mainInstanceData.getMainInsHelpNum())game.notice.show(9034);else if(!game.UpgradeUtil.checkEquipTooMuch()){var a=t.roleId;if(a!=game.mainRoleData.id){var i=t.instId;this.sender.HelpReq(a,i)}else game.notice.show(9035)}}}),t=game.Sender.extends({ipc:function(){this.msg={ChallengeReq:null,InsDataReq:null,SeekHelpReq:this.reqSeekHelp,HelpReq:this.reqHelpReq,BattleTestReq:null}},reqHelpReq:function(e,t){var a=game.pb.HelpRequest;a.roleid=e,a.insid=t,this.write(a)},reqSeekHelp:function(e){var t=game.pb.SeekHelpRequest;t.type=e,this.write(t)}});b8e.module.registerControl(game.ME.Instance,e,game.InstanceEvts,t)}(),function(){var e;e=b8e.Enum({NONE:0,C_UPDATE_MAININSTANCE_VIEW:-1,C_GET_MAIN_INSTANCE_AWARDS:-1,C_AUTO_FIGHT_CHANGE:-1,V_UPDATE_MAININSTANCE_VIEW:-1,V_REQ_SEEKHELP:-1,C_REQ_SEEKHELP:-1,V_GET_GROUP_AWARDS:-1,V_REQ_RANKINFO:-1,C_REQ_RANKINFO:-1,C2C_CHALLENGE_WIN:-1,V_AUTO_PASS:-1,G_AUTO_PASS_END:-1,V_ON_VIEW_HIDE:-1,C2C_SYNC_MAIN_INSTANCE:-1,C2V_SWITCH_PAGE:-1,C2C_SET_FORMATION:-1,BOSS_BATTLE_FAIL:-1,C2V_UPDATE_AWARD:-1,V_ISGET_AWARD:-1,C2C_CHALLENGE_WIN_2:-1}),b8e.RC("$$game","$$MainInstanceEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){var e=this;e.evts={Instance:{SYNC_INSTANCE_DATA:e.syncMainInstanceData,C_UPDATE_CHALLENGE_NUM:e.addInstanceStarNum,C_BOSSCHALLENGE_RESULT:e.boosChallengeResult,C_UPDATE_VIEW:e.updateView},Rank:{C_UPDATE_DATA:e.updateRankInfo},InstanceSuccess:{V_SHOW_INS_SUCCESS:e.stopPlay},ArenaFinish:{V_SHOW_INS_SUCCESS:e.stopPlay},MainUIRight:{CV2_GET_GROUP_AWARDS:e.getGroupAwards},MainCenter:{C2C_BOSS_BATTLE:e.bossBattle,C2C_AUTO_BOSS_BATTLE:e.autoBossBattle}},e.gevts={},e.handels={MainInsClearanceAwardResp:e.onMainInsClearanceAward,BossChallengeResp:e.onBossChallengeResp}},notify:function(e,t){var a=this;switch(e){case a.Evts.V_REQ_SEEKHELP:a.reqSeekHelp(t);break;case a.Evts.V_GET_GROUP_AWARDS:a.getGroupAwards();break;case a.Evts.V_REQ_RANKINFO:a.onReqRankInfo();break;case a.Evts.V_AUTO_PASS:a.onChapterAutoPass();break;case a.Evts.V_ON_VIEW_HIDE:a.onViewHide();break;case a.Evts.V_ISGET_AWARD:a.items=t.award,a.getGroupAwards()}},stopPlay:function(e){var a=this,i=e.data,t=game.mainInstanceData;i&&i.type==game.InstanceType.CHUANG_GUAN&&(i.lastId&&i.win&&i.lastId!=t.id&&(t.getInstanceCfg(function(t){t&&(t.gainPop&&game.gamePopupMgr.show(game.ME.GuajiUp),game.InstanceCfg.getDataAsync(i.lastId,function(e){e&&t.mapId!=e.mapId&&b8e.evt.dptG(game.TaskEvts.G_TASK_ENTER_MAP)},a))},a),game.GameGuideMgr.inst().instanceDone(i.lastId),a.dpt(a.Evts.C2C_CHALLENGE_WIN_2)),a.updateView())},reqSeekHelp:function(e){if(game.mainInstanceData.reqNum>=game.mainInstanceData.getMainInsReqNum()){game.notice.show(9036)}else{if(1==e);else if(2==e){var t=game.guildData;if(t&&!t.hasGuild()){return void game.notice.show(9037)}}this.dpt(game.MainInstanceEvts.C_REQ_SEEKHELP,e)}},getGroupAwards:function(){game.UpgradeUtil.checkEquipTooMuch()||this.sender.MainInsClearanceAwardReq()},setsendMap:function(){this.send(this.Evts.V_GET_GROUP_AWARDS)},syncMainInstanceData:function(e){var t=e.data;if(t){var a=t.main;if(a){if(game.mainInstanceData.quickCount=t.quickBattleTimes||0,game.mainInstanceData.privilegeQuickCount=t.quickFreeTimes||0,game.mainInstanceData.quickBattleTotalTimes=t.quickBattleTotalTimes||0,game.mainInstanceData.setup(a),game.GameGuideMgr.inst().instance(game.mainInstanceData.id),this.dpt(this.Evts.C_GET_MAIN_INSTANCE_AWARDS),this.dpt(this.Evts.C2C_SYNC_MAIN_INSTANCE),!b8e.module.isShowView(game.ME.Welcome)){var i=game.mainRole.getAiStateMachine();i.isAttack()||i.isFind()||i.isMove()||i.start()}}else;}},addInstanceStarNum:function(){game.mainInstanceData.addInstanceStarNum()},boosChallengeResult:function(e){if(!e.data);},showRankBtn:function(){game.module.show(game.ME.MainInstanceRank)},helpBtn:function(){game.module.show(game.ME.MainInstanceHelp)},onChapterAutoPass:function(){this.onReqBossChallenge()},fightBtn:function(){this.onReqBossChallenge()},buzhenBtn:function(){game.module.show(game.ME.PartnerFormation)},onReqRankInfo:function(){this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.InsMain)},autoBossBattle:function(){this.onReqBossChallenge(!1)},bossBattle:function(){this.onReqBossChallenge(!0)},onReqBossChallenge:function(e){var t=game.mainInstanceData;if(!game.playBack.isInstanceFighting()&&!game.sceneData.isGuildMap()){if(game.UpgradeUtil.checkEquipTooMuch())return t.autoFight=!1,void this.dpt(this.Evts.C_AUTO_FIGHT_CHANGE);e?this.dpt(this.Evts.C2C_SET_FORMATION,[game.ME.MainInstance,t.id,this.formationCb,null,this]):this.sender.BossChallengeReq()}},formationCb:function(){var e=b8e.module.getControl(game.ME.PlayBackFormation);e&&e.callback&&(e.callback=null),this.sender.BossChallengeReq()},onBossChallengeResp:function(e){var t=this,a=e.readProtobuf(game.pb.BossChallengeResponse);if(0<a.code)game.notice.noticeError(a.code);else{var i={type:game.InstanceType.CHUANG_GUAN,rewards:a.useritem,exp:a.exp,lastId:game.mainInstanceData.id,win:a.battlelog.win};game.playBack.play(a.battlelog,i),game.mainInstanceData.isEnterInstance=!0,t.timerKey&&(b8e.clearTimeout(t.timerKey),t.timerKey=0),game.module.hide(game.ME.MainInstance),a.battlelog.win?t.dpt(t.Evts.C2C_CHALLENGE_WIN):(game.mainInstanceData.autoFight=!1,t.dpt(t.Evts.C_AUTO_FIGHT_CHANGE),t.dpt(t.Evts.BOSS_BATTLE_FAIL));var n=a.instance;n&&(game.mainInstanceData.setup(n),game.GameGuideMgr.inst().instance(game.mainInstanceData.id),t.dpt(t.Evts.C_GET_MAIN_INSTANCE_AWARDS))}},onMainInsClearanceAward:function(e){var t=e.readProtobuf(game.pb.MainInsClearanceAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mainInstanceData.getAwardSuccess(),game.awardsData.setItemsByArray(this.items,!0),game.module.show(game.ME.AwardShowTip),this.send(this.Evts.C2V_UPDATE_AWARD),this.dpt(this.Evts.C_GET_MAIN_INSTANCE_AWARDS),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},updateView:function(){this.send(this.Evts.V_UPDATE_MAININSTANCE_VIEW)},updateRankInfo:function(){this.send(this.Evts.V_UPDATE_MAININSTANCE_VIEW)},box:function(){game.module.show(game.ME.InstancePrizeTips)},onViewHide:function(){game.mainInstanceData.isEnterInstance||(this.timerKey=b8e.setTimeout(this.showView,this,3e3))},showView:function(){game.taskData.isAutoPass&&game.module.show(game.ME.MainInstance)},bossBtn:function(){this.send(this.Evts.C2V_SWITCH_PAGE,0)},guajiBtn:function(){this.send(this.Evts.C2V_SWITCH_PAGE,1)}}),t=game.Sender.extends({ipc:function(){this.msg={BossChallengeReq:null,MainInsClearanceAwardReq:null}}}),a=[game.ME.MainInstanceRank,game.ME.MainInstanceHelp,game.ME.InstancePrizeTips,game.ME.MainInstanceReward,game.ME.InstanceAwardPreview];b8e.module.registerControl(game.ME.MainInstance,e,game.MainInstanceEvts,t,a)}(),function(){var t=void 0;t=b8e.PoolObject.extends({id:0,isBossDrop:!1,ctor:function(){this._super()},setData:function(e,t){this.id=e,this.isBossDrop=t},setIsBossDrop:function(e){this.isBossDrop=e},recycle:function(){this.reset(),this._super()},reset:function(){this.id=0,this.isBossDrop=!0}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,8),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$MainInstanceRewardInfo",t)}();p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e=b8e.Object.extends({id:0,star:0,helpNum:0,reqNum:0,progress:0,award:null,autoFight:!1,awardConfigs:null,mainInsReqNum:0,mainInsHelpNum:0,quickCount:0,privilegeQuickCount:0,_maxQuickFreeCount:0,_autoPassOpenId:0,isEnterInstance:!1,nextBattleTime:0,awardArr:null,curAwardGroup:0,mapId:0,isQuickBattle:!0,quickItmeNum:0,ctor:function(){this._super(),this.awardConfigs={},this.awardArr=[],this.showItemsMap=b8e.HashMap.get(),this.offlineShowItemsMap=b8e.HashMap.get(),this.bossShowItemsMap=b8e.HashMap.get()},setup:function(t){if(t){var a=this;a.id=t.id,a.star=t.star,a.awardGroup=t.awardGroup,a.nextBattleTime=0|t.nextBattleTime,a.getInstanceCfg(function(e){e&&(a.star=t.star>=e.star?e.star:t.star,a.group=e.group),a.helpNum=t.helpNum,a.reqNum=t.reqNum,a.progress=t.progress,a.award=t.award,a.mapId=e.mapId},a)}else;},maxQuickFreeCount:{get:function(){if(!this._maxQuickFreeCount)for(var e=game.QuickBattleCostCfg.getDatas(),t=0,a=e.length;t<a;t++)e[t].gold<=0&&e.length>t+1&&(this._maxQuickFreeCount=e[t+1].num);return this._maxQuickFreeCount+this.privilegeCount}},maxQuickCount:{get:function(){var e=0,t=game.VipCfg.getData(game.mainRoleData.vipLevel);if(t&&(e+=t.quickBattle),game.privilegeShopData.isActByType(game.PrivilegeType.QUICK_BATTLE)){var a=game.privilegeShopData.getCfgByType(game.PrivilegeType.QUICK_BATTLE);a&&(e+=a.quickAddTimes)}return e}},privilegeCount:{get:function(){return p(this._privilegeCount)!==b8e.TypeNumber&&this.setPrivilegeCount(),this._privilegeCount}},setPrivilegeCount:function(){if(this._privilegeCount=0,game.privilegeShopData.isActByType(game.PrivilegeType.QUICK_BATTLE)){var e=game.privilegeShopData.getCfgByType(game.PrivilegeType.QUICK_BATTLE);e&&(this._privilegeCount=e.quickFreeTimes)}},resetDaily:function(){this.setPrivilegeCount()},beHelp:function(e){e&&e!=this.id&&(this.id=e,this.star=0,this.progress++)},addInstanceStarNum:function(){var a=this;a.getInstanceCfg(function(e){var t=e?e.star:3;a.star<t&&a.star++},a)},getAwardSuccess:function(){var e=this;e.awardGroup<e.group&&e.awardGroup++,e.awardArr&&0<e.awardArr.length&&(e.awardArr.sort(e._sort),e.awardArr.splice(0,1),1<e.awardArr.length&&(e.awardArr[0].isCanGet=!0))},getInstanceCfg:function(t,a){this.id?game.InstanceCfg.getDataAsync(this.id,function(e){t.call(a,e)},this):t.call(a,null)},canFightByLv:function(a,i,n){this.getInstanceCfg(function(e){if(e){var t=e.limitLv<=game.mainRoleData.lv;!t&&n&&game.notice.show(53021,e.limitLv),a.call(i,t)}else a.call(i,!1)},this)},canFight:function(a,i){var n=this;n.needMoveNextMap(function(e){e?a.call(i,!1):n.getInstanceCfg(function(e){var t=e?e.star:3;a.call(i,n.star>=t)})},n)},canGetMainInsRew:function(a,i){var n=this;n.getInstanceCfg(function(e){var t=e.group;a.call(i,n.awardGroup<t)})},needMoveNextMap:function(t,a){this.getInstanceCfg(function(e){e&&e.mapId>game.mainRoleData.mapId?t.call(a,!0):t.call(a,!1)},this)},getPrizeConfig:function(t,a,i){var n=this;game.InstanceCfg.getGroupDatasAsync(t,function(e){if(!e)return b8e.error("\u65e0\u6cd5\u83b7\u53d6\u4e3b\u7ebf\u4efb\u52a1group",n.group),void a.call(i,null);e.sort(n._sortAwardConfig),n.awardConfigs[t]=e[e.length-1],a.call(i,n.awardConfigs[t])},n)},getMaxProgress:function(t,a){var i=this;game.InstanceCfg.getGroupDatasAsync(i.awardGroup,function(e){if(!e)return b8e.error("\u65e0\u6cd5\u83b7\u53d6\u4e3b\u7ebf\u4efb\u52a1group",i.group),void t.call(a,null);t.call(a,e.length)},i)},_sortAwardConfig:function(e,t){return e.id-t.id},getCurAwardConfig:function(t,a){this.getPrizeConfig(this.awardGroup,function(e){t.call(a,e)},this)},haveLastPrizeConfig:function(){return this.awardGroup<this.group},finishMainInstance:function(){this.star=0,this.progress++},getShowItem:function(a,i){this.getPrizeConfig(this.group,function(e){if(e){var t=e.award;t&&0<t.length?a.call(i,t[0]):a.call(i,null)}else a.call(i,null)},this)},getShowItems:function(g,l){var c=this;c.getInstanceCfg(function(e){if(e){var t=e.id;if(c.showItemsMap.has(t)){var a=c.showItemsMap.get(t);g.call(l,a)}else{if(!(a=e.showItems)||a.length<1)g.call(l,null);else{for(var i,n=a.length,s=[],o=void 0,r=0;r<n;r++)o=a[r].split(","),(i=game.ItemUtil.createBaseItemInfo(+o[0],1)).iconSize=game.IconSizeEnum.GRID_SIZE_84,1<o.length&&(i.tagId=+o[1]),s.push(i);c.showItemsMap.set(t,s),g.call(l,s)}}}else g.call(l,null)},c)},getShowItemsByConfig:function(e,t,a){var i=e.id,n=t?this.bossShowItemsMap:this.offlineShowItemsMap;if(n.has(i))return n.get(i);var s=t?e.showItems:e.offlineShowItems;if(!s||s.length<1)return null;for(var o=s.length,r=void 0,g=[],l=void 0,c=0;c<o;c++)l=s[c].split(","),r=game.ItemUtil.createBaseItemInfo(+l[0],1),1<l.length&&(r.tagId=+l[1]),r.iconSize=game.IconSizeEnum.GRID_SIZE_105,g.push(r);return n.set(i,g),g},getMainInsReqNum:function(){return this.mainInsReqNum||(this.mainInsReqNum=+game.InstanceMiscCfg.getData("mainInsReqNum").value),this.mainInsReqNum},getMainInsHelpNum:function(){return this.mainInsHelpNum||(this.mainInsHelpNum=+game.InstanceMiscCfg.getData("mainInsHelpNum").value),this.mainInsHelpNum},autoPassOpenId:{get:function(){return 0==this._autoPassOpenId&&(this._autoPassOpenId=+game.CfgUtil.getMiscValue(game.InstanceMiscCfg,"autoPassOpenId")),this._autoPassOpenId}},canOpenAutoPass:function(){var t=this,a=!1;return game.InstanceCfg.getDataAsync(t.id,function(e){e&&e.id>t.autoPassOpenId&&(a=!0)},t),a},checkAutoRedPoint:function(){return this.id==this.autoPassOpenId+1},getMaxInsId:function(){if(this.maxInsId)return this.maxInsId;var e=game.InstanceMiscCfg.getData("maxInstanceId");return e?(this.maxInsId=0|e.value,this.maxInsId):0},setQuickBattleAward:function(e,t){this.userItem=e,this.exp=t,game.module.show(game.ME.QuickBattleAward)},getInstanceAward:function(){var e=this;if(e.group==e.curAwardGroup)return e.awardArr;e.clearList(e.awardArr),e.curAwardGroup=e.group;var t=game.InstanceAwardCfg.getDatas();if(!t)return 0;var a=t.length;if(a<1)return 0;t.sort(e._sort);var i=game.InstanceMiscCfg.getData("InstanceMaxAward");if(!i)return 0;for(var n=void 0,s=i.value,o=e.awardGroup-1;o<a;o++){var r=t[o],g=e.awardArr[o];if(e.awardArr.length==s)break;g||(n=game.InstanceAwardInfo.get(),e.awardArr.push(n)),n.setData(r,e.group),n.canGet&&s++}return e.awardArr},clearList:function(e){for(var t=0,a=e.length;t<a;t++)e[t].release();e.length=0},_sort:function(e,t){return e.group-t.group},traceLog:function(e){this.id<2||game.sdk.traceLog(e)}});game.mainInstanceData=game.mainInstanceData||new e})(),function(){var t=void 0;t=b8e.PoolObject.extends({group:0,name:"",id:0,award:null,canGet:!1,isGet:!1,isCanGet:!1,setData:function(e,t){this.id=e.id,this.group=e.group,this.name=e.name,this.award=e.award,this.group<t&&(this.canGet=!0),game.mainInstanceData.awardGroup>=this.group&&this.canGet&&(this.isCanGet=!0)},setComplete:function(){this.isGet=!0,this.canGet=!1},recycle:function(){this.reset(),this._super()},reset:function(){this.group=0,this.name="",this.award=null}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$InstanceAwardInfo",t)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(1186),this.itemInfos=[]},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.PrizeListItem,e.layout.spacingX=30,e.addToParent(this.skin.prizeNode)},onShow:function(){var n=this,s=n.skin;game.mainInstanceData.getCurAwardConfig(function(e){var t,a=n,i=e.award;if(a.clearItemInfos(),i){i.forEach(function(e){(t=game.ItemInfo.get()).id=e.Id,t.num=e.Num,t.iconLayoutEnum=game.IconLayoutEnum.SHOW_ALL,a.itemInfos.push(t)}),s.prizetips.string=game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9038))+game.HtmlUtil.getText(game.Color.GREEN,e.name)+game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9039))}else s.prizetips.string="";n.list.setData(a.itemInfos),s.titlelab.string=game.Lang.get(51582,e.name)},n),game.mainInstanceData.getInstanceCfg(function(e){e.group==game.mainInstanceData.awardGroup?s.getPrizetips.string=game.Lang.get(51754):s.getPrizetips.string=game.Lang.get(9057)},n)},viewGetBtn:function(){var t=this,a=game.mainInstanceData;a.canGetMainInsRew(function(e){e?(t.send(t.Evts.V_GET_GROUP_AWARDS),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive),t.removeFromParent()):a.getMaxProgress(function(e){if(e){var t=e-a.progress;game.notice.show(52358,t)}},t)},t)},clearItemInfos:function(){this.itemInfos.forEach(function(e){e.release()}),this.itemInfos.length=0},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.InstancePrizeTips,e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(1185)},init:function(){},onShow:function(){},viewPostworldBtn:function(){this.send(this.Evts.V_REQ_SEEKHELP,1)},viewPostguildBtn:function(){this.send(this.Evts.V_REQ_SEEKHELP,2)}});b8e.module.registerView(game.ME.MainInstanceHelp,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1184),this.spotAlerts={},this.setSize(560,95)},setData:function(){var e=this.data;if(e){var t=this.skin;if(t.rank.string=e.rank+"",t.name.string=e.name,t.power.string=e.power+"",t.instancenum.string=e.score+"",t.rank1.node.active=!1,t.rank2.node.active=!1,t.rank3.node.active=!1,t.rank_bg.node.active=!0,1==e.rank){t.rank1.node.active=!0,t.rank.node.active=!1,t.rank_bg.node.active=!1}else if(2==e.rank){t.rank2.node.active=!0,t.rank.node.active=!1,t.rank_bg.node.active=!1}else if(3==e.rank){t.rank3.node.active=!0,t.rank.node.active=!1,t.rank_bg.node.active=!1}}else;}}),b8e.RC("$$game","$$MainInstanceRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(1183),this.spotAlerts={}},init:function(){this.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.rankList.itemRender=game.MainInstanceRankItem,this.rankList.bindEnum=game.ME.MainInstanceRank,this.rankList.layout.spacingY=3,this.rankList.addToParent(this.skin.listNode)},onShow:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.InsMain);this.rankList.setData(e);var t=game.rankData.getSelfRankInfo(game.RankType.InsMain);if(t){this.skin.rankNum.string=t.rank,this.skin.instanceNum.string=t.score}}});b8e.module.registerView(game.ME.MainInstanceRank,e)}(),function(){var e=game.View.extends({_bossModel:null,barWidth:354,INST_NUM_MAX:10,ctor:function(){this._super(1182),this.spotAlerts={}},init:function(){this._bossModel=b8e.SceneEntity.get(),this._bossModel.addToParent(this.skin.modleNode);var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ShowItemListItem,e.layout.spacingX=45,e.addToParent(this.skin.prizeListNode)},notify:function(e){switch(e){case game.MainInstanceEvts.V_UPDATE_MAININSTANCE_VIEW:this.updateView()}},onShow:function(){this.updateView(),this.checkIsAutoPass(),this.send(this.Evts.V_REQ_RANKINFO),game.mainInstanceData.isEnterInstance=!1},onHide:function(){var e=this._bossModel.getAnimator(game.AnimType.BODY,1);if(e){e.clear()}this.timerKey&&(b8e.clearTimeout(this.timerKey),this.timerKey=0),this.send(this.Evts.V_ON_VIEW_HIDE)},updateView:function(){var a=this,i=game.mainInstanceData,e=game.rankData.getRankInfoArrByType(game.RankType.InsMain);if(e&&0<e.length)for(var t=0;t<e.length&&t<3;++t)a.getComponent("rank_"+t).string=game.Lang.get(9563,e[t].score),a.getComponent("rankname_"+t).string=e[t].rank+"    "+e[t].name;i.getInstanceCfg(function(e){e&&(a.skin.instanceName.string=e.name,game.InstanceCfg.getGroupDatasAsync(e.group,function(e){if(e&&e.length){var t=e[e.length-1];a.skin.desLab.string=game.Lang.get(51517,t.name),a.skin.progressLab.string=i.progress+"/"+e.length,a.skin.progress.node.width=i.progress/e.length*a.barWidth}},a),i.getShowItems(function(e){e&&a.list.setData(e)},a),game.CfgUtil.getMosterModelRes(e.boss,function(e){this.setAnim(game.ResCfg.getUrl(5e3,e))},a))},a)},setAnim:function(e){var t;if(e){if(!(t=this._bossModel.getAnimator(game.AnimType.BODY,1))){t=this._bossModel.addAnimator(game.AnimType.BODY,1)}t.load(e),t.play()}else if(t){t.clear()}},checkIsAutoPass:function(){game.taskData.isAutoPass&&(b8e.hasTimeout(this.startAutoPass,this)||(this.timerKey=b8e.setTimeout(this.startAutoPass,this,3e3)))},startAutoPass:function(){this.send(this.Evts.V_AUTO_PASS)}});b8e.module.registerView(game.ME.MainInstance,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1511),this.toggles={left_select_img:null,right_select_img:null}},init:function(){var e=this.skin,t=this.prizeList=new game.List;t.itemRender=game.MainInstanceRewardItem,t.addToParent(e.prizeNode),t.layout.spacingX=5,e.bossBtn.isButton=!1,e.guajiBtn.isButton=!1},notify:function(e,t){switch(e){case this.Evts.C2V_SWITCH_PAGE:this.toggleSelect(t)}},toggleSelect:function(e){this.isBossDrop=0==e,this.isBossDrop?this.showBossDropList():this.showGuajiDropList(),this._super(e)},onShow:function(){this.isBossDrop=!0,this.showBossDropList()},onHide:function(){this.clearInfoList(),this.prizeList.clear()},showBossDropList:function(){this.prizeInfoList||(this.prizeInfoList=[]),this.clearInfoList();for(var e=void 0,t=this.isBossDrop,a=game.mainInstanceData.id,i=game.mainInstanceData.getMaxInsId(),n=i<a+3?i+1:a+4,s=a;s<n;s++)(e=game.MainInstanceRewardInfo.get()).setData(s,t),this.prizeInfoList.push(e);this.prizeList.setData(this.prizeInfoList)},showGuajiDropList:function(){var r=this;r.prizeInfoList||(r.prizeInfoList=[]),r.clearInfoList(),game.mainInstanceData.getInstanceCfg(function(e){if(e){var t=void 0,a=r.isBossDrop,i=game.mainInstanceData.id;if((t=game.MainInstanceRewardInfo.get()).setData(i,a),r.prizeInfoList.push(t),e.showIds&&0<e.showIds.length)for(var n=e.showIds,s=n.length,o=0;o<s;o++)(t=game.MainInstanceRewardInfo.get()).setData(n[o],a),r.prizeInfoList.push(t);r.prizeList.setData(r.prizeInfoList)}},r)},clearInfoList:function(){if(this.prizeInfoList&&!(this.prizeInfoList.length<1)){for(var e=this.prizeInfoList.length,t=0;t<e;t++)this.prizeInfoList[t].release();this.prizeInfoList.length=0}}});b8e.module.registerView(game.ME.MainInstanceReward,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1510),this.setSize(540,170)},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=0,e.layout.spacingX=20},setData:function(){var a=this;if(a.data){var i=a.data.id,n=a.data.isBossDrop;game.InstanceCfg.getDataAsync(i,function(e){if(!e)return a.skin.name.string="",void a.prizeList.clear();a.skin.name.string=game.mainInstanceData.id==i?game.Lang.get(53023):e.name;var t=game.mainInstanceData.getShowItemsByConfig(e,n);a.prizeList.setData(t)},a)}}}),b8e.RC("$$game","$$MainInstanceRewardItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1509),this.setSize(540,169)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.awardList.itemRender=game.PrizeListItem,this.awardList.addToParent(this.skin.awardList)},setData:function(e){var t=this.skin;t.name.string=e.name,t.isGet.active=e.isGet,t.goTo.active=!e.canGet&&!e.isGet,t.canGet_Btn.active=e.isCanGet&&e.canGet,t.isCanGetLab.active=!e.isCanGet&&e.canGet;var a=game.CfgUtil.getPrizeListInfo(e.award,null,game.IconSizeEnum.GRID_SIZE_84);a&&this.awardList.setData(a.items)},canGet_Btn:function(){game.mainInstanceData.traceLog(10),this.send(game.MainInstanceEvts.V_ISGET_AWARD,this.data)},goTo:function(){game.module.hide(game.ME.InstanceAwardPreview)}}),b8e.RC("$$game","$$InstanceAwardItme",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1508)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.InstanceAwardItme,e.bindEnum=game.ME.MainInstance,e.addToParent(this.skin.list)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_AWARD:this.updateList()}},onShow:function(){this.updateList()},updateList:function(){this.infos=game.mainInstanceData.getInstanceAward(),this.list.setData(this.infos)},$$getAwardItem:function(e){if(!this.list||!this.infos||this.infos.length<=e)return null;var t=this.infos[e];if(!t)return null;var a=this.list.getItemRender(t);return a&&a.skin?a.skin.canGet_Btn:null}});b8e.module.registerView(game.ME.InstanceAwardPreview,e)}(),function(){var e;e=b8e.Enum({C_LEVEL_UP:1,C_EXP_CHANGE:-1,C_SPRITE_STATE_CHANGE:-1,C_POWER_CHANGE:-1,C_INIT_MAIN_ROLE:-1,C_VIP_LEVEL_CHANGE:-1,C_RESET_DAILY:-1,C_RESET_WEEK:-1,C_INIT_SERVER_DATA:-1,C_INIT_MSIC_DATA:-1,C_RESET_MONTH:-1,C_RECONNECT_MSIC_DATA:-1}),b8e.RC("$$game","$$MainRoleEvts",e)}(),function(){var e=game.Control.extends({init:function(){var e=game.LoginConfig.heroData;if(e){game.mainRoleData=game.HeroData.get(game.RoleType.Hero,e.id),game.mainRoleData.setMainRoleData(e),game.mainRole=game.sceneRoleCreate.createMainRole(),b8e.scene.getCamera().setFocusTarget(game.mainRole);var t=game.PartnerMiscCfg.getData("maxLv");game.mainRoleData.maxLv=+t.value,game.SysTime.syncTime(),this.sender.RoleMiscReq(),this.sender.ServerDataReq()}else b8e.error("\u4e3b\u89d2\u6570\u636e\u521d\u59cb\u5316\u5931\u8d25\uff0c\u6ca1\u6709\u627e\u5230HeroData")},ipc:function(){var e=this;e.gevts={SceneGEvts:{FIRST_ENTER_SCENE:e.firstEnterScene}},e.evts={Recharge:{C_RECHARGE_SUCCESS:e.rechargeSuccess},Partner:{C_UPDATE_POWER:e.updatePower,C_INIT_ROLE_DATA:e.updateNameColor,C2C_ROLE_QUALITY_CHANGE:e.updateNameColor},Scene:{C2C_RECONNECT_ENTER_SCENE:e.reconnect}},e.handels={QryServerTimeResp:e.syncTime,LevelUpResp:e.levelUpRp,LevelExpMsg:e.levelExpNotify,RoleAttrUpdateMsg:e.roleAttrUpdateNotify,RoleMiscResp:e.setMiscData,ServerDataResp:e.onServerDataResp,VipLvMsg:e.vipLvNotify,ResetDailyMsg:e.resetDailyMsg,ResetWeeklyMsg:e.resetWeeklyMsg,ResetMonthlyMsg:e.resetMonthlyMsg}},firstEnterScene:function(){var e=this;game.GameGuideMgr.inst().initTrigger();var t=game.LoginConfig;if(game.LoginConfig.needVerify&&!e.onceTips){if(game.LoginConfig.getOpenGameLimit())if(9==t.fcm)b8e.setTimeout(e.fcmAlert,e,33e5);else if(2==t.fcm){var a=51e5-game.miscData.dailyOnlineTime;b8e.setTimeout(e.fcmAlert,e,a)}var i=game.LoginConfig.getOpenFcmOnlineTips();0==t.fcm&&i&&(e.timer=b8e.Timer.add(e,e.fcmOnlineAlert,36e5)),e.onceTips=!0}e.dpt(e.Evts.C_INIT_MAIN_ROLE)},fcmAlert:function(){var e=9==game.LoginConfig.fcm?9668:9645,t=game.Lang.get(e);game.alert.showMsg(t)},fcmOnlineAlert:function(){var e=game.miscData;e.fcmOnlineIndex++,e.fcmOnlineTime=60*e.fcmOnlineIndex,game.module.show(game.ME.FcmOnlineTips),4==e.fcmOnlineIndex&&this.timer&&(this.timer.stop(),this.timer.callBack=this.fcmOnlineAlert2,this.timer.delay=18e5,this.timer.start())},fcmOnlineAlert2:function(){var e=game.miscData;e.fcmOnlineIndex2++,e.fcmOnlineTime=240+30*e.fcmOnlineIndex2,game.module.show(game.ME.FcmOnlineTips),4==e.fcmOnlineIndex2&&this.timer&&(this.timer.stop(),this.timer.callBack=this.fcmOnlineAlert3,this.timer.delay=9e5,this.timer.start())},fcmOnlineAlert3:function(){var e=game.miscData;e.fcmOnlineIndex3++,e.fcmOnlineTime=360+15*e.fcmOnlineIndex3,game.module.show(game.ME.FcmOnlineTips)},onServerDataResp:function(e){var t=e.readProtobuf(game.pb.ServerDataResponse);game.miscData.setupServerData(t),this.dpt(this.Evts.C_INIT_SERVER_DATA)},setMiscData:function(e){var t=e.readProtobuf(game.pb.RoleMiscModel);this.isMiscInit?(game.onlineGiftData.setData(t),this.dpt(this.Evts.C_RECONNECT_MSIC_DATA)):(game.miscData.setup(t),game.settingData.setup(t),game.triggerData.setup(t),game.shopData.setupMiscData(t),game.regressRewardData.setup(t),game.GameGuideMgr.inst().initData(),game.moduleOpenData.setup(t),game.mysteriousEggData.setData(t),game.onlineGiftData.setData(t),game.guajiData.setMiscData(t),game.loadActiveShowData.setData(t),this.dpt(this.Evts.C_INIT_MSIC_DATA),this.isMiscInit=!0)},syncTime:function(e,t){var a=e.readProtobuf(game.pb.QryServerTimeResponse);if(!a||0<a.code){game.notice.noticeError(a.code)}else b8e.startup.setServerTime(a.ts,t)},levelUpRp:function(e){var t=e.readProtobuf(game.pb.LevelUpResponse);if(!t||0<t.code){game.notice.noticeError(t.code)}else{var a=game.mainRoleData,i=a.lv,n=a.exp;a.lv=t.level,a.exp=t.exp,a.levelUpTime=t.levelUpTime,game.sdk.levelUpLog();var s=this.getExpObj(i,n);this.dpt(game.MainRoleEvts.C_LEVEL_UP),this.dpt(game.MainRoleEvts.C_EXP_CHANGE,s)}},notifySpotAlert:function(){for(var e=game.SpotAlertCfg.getDatas(),t=null,a=0,i=e.length;a<i;a++)(t=game.spotAlert.get(e[a].id))&&t.dirty()},levelExpNotify:function(e){var t=e.readProtobuf(game.pb.LevelExpNotify),a=game.mainRoleData,i=a.lv,n=a.exp;if(0!=t.level){var s=t.level-i;game.roleLvUpData.addLv=s,a.lv=t.level,a.levelUpTime=t.levelUpTime,game.sdk.levelUpLog(),this.dpt(game.MainRoleEvts.C_LEVEL_UP),this.notifySpotAlert()}if(0<t.addExp){game.notice.amountNotice(game.AmountType.EXP,t.addExp),game.notice.showNoticeList()}a.exp=t.exp;var o=this.getExpObj(i,n);this.dpt(game.MainRoleEvts.C_EXP_CHANGE,o)},getExpObj:function(e,t){return this.expObj||(this.expObj={lv:0,exp:0}),this.expObj.lv=e,this.expObj.exp=t,this.expObj},updatePower:function(e){var t=e.data,a=game.mainRoleData.spriteStat;game.FightAmount.inst().canCover&&(game.FightAmount.inst().setReadyData(a),game.FightAmount.inst().setReadyPower(),game.FightAmount.inst().sunSpriteStatByServer(t.stat)),a.updateStat(t.stat,!0);var i=game.mainRoleData.power;game.mainRoleData.power=t.power,this.dpt(game.MainRoleEvts.C_SPRITE_STATE_CHANGE),game.mainRoleData.power!=i&&(game.FightAmount.inst().canShowPower&&(game.FightAmount.inst().showFightAmount(),game.FightAmount.inst().endShow()),this.dpt(game.MainRoleEvts.C_POWER_CHANGE,i),game.sdk.updateFightScoreLog())},updateNameColor:function(){game.mainRole&&game.mainRole.updateName()},roleAttrUpdateNotify:function(e){var t=e.readProtobuf(game.pb.RoleAttrUpdateNotify),a=game.mainRoleData.spriteStat;game.FightAmount.inst().canCover&&(game.FightAmount.inst().setReadyData(a),game.FightAmount.inst().setReadyPower(),game.FightAmount.inst().sunSpriteStatByServer(t.stat)),a.clear(),a.updateStat(t.stat,!0);var i=game.mainRoleData.power,n=game.mainRoleData.maxPower;if(game.mainRoleData.power=t.power,game.mainRoleData.maxPower=n>t.power?n:t.power,this.dpt(game.MainRoleEvts.C_SPRITE_STATE_CHANGE),game.mainRoleData.power!=i){game.FightAmount.inst().canShowPower&&(game.FightAmount.inst().showFightAmount(),game.FightAmount.inst().endShow()),this.dpt(game.MainRoleEvts.C_POWER_CHANGE,i),game.sdk.updateFightScoreLog()}},sendSSNotice:function(e){var t=e;if(t&&!(t.length<1)){var a=game.mainRoleData.spriteStat;if(a)for(var i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=t.length,l=void 0,c=0;c<g;c++)n=(i=t[c]).value,r=i.id,s=a.getStatValue(r),(l=game.AttrRulesCfg.getData(r))&&(2==l.format&&(n/=1e4),n<=s||(o=2==l.format?(o=n-s,Math.floor(1e4*o)/100+"%"):n-s,o=l.bmf+"+"+o,game.notice.showSpriteStat(o)))}},vipLvNotify:function(e){var t=e.readProtobuf(game.pb.VipLvNotify);game.mainRoleData.vipLevel=t.vipLv,this.dpt(game.MainRoleEvts.C_VIP_LEVEL_CHANGE)},resetDailyMsg:function(){if(!this.isNeedDaily){this.isNeedDaily=!0;var e=b8e.TimeUtil.getTodayTime(game.SysTime.curTime);5e3<game.SysTime.curTime-e?b8e.setTimeout(this.delayFunc,this,2e3):this.delayFunc()}},delayFunc:function(){this.isNeedDaily=!1;var e=game.miscData;e.openServerDay++,e.loginDay++,0<e.serverMergeDays&&e.serverMergeDays++,this.dpt(this.Evts.C_RESET_DAILY)},reconnect:function(){this.sender.RoleMiscReq()},resetWeeklyMsg:function(){this.dpt(this.Evts.C_RESET_WEEK)},resetMonthlyMsg:function(){this.dpt(this.Evts.C_RESET_MONTH)},rechargeSuccess:function(e){if(e&&e.data){var t=game.amount.get(game.AmountType.VIP_EXP),a=game.mainRoleData.vipLevel,i=game.VipCfg.getMaxLv();if(a<i)for(var n=i;a<n;n--){if(t>game.VipCfg.getData(n).needNum){game.mainRoleData.setVipLevel(n),this.dpt(this.Evts.C_VIP_LEVEL_CHANGE);break}}}else;}}),t=game.Sender.extends({ipc:function(){this.msg={RoleMiscReq:null,ServerDataReq:null}}});b8e.module.registerControl(game.ME.MainRole,e,game.MainRoleEvts,t)}(),function(){var e=b8e.Object.extends({loginTime:0,totalOnlineTime:0,loginDay:0,dailyOnlineTime:0,collectedVipLv:0,logoutTime:0,openServerDay:1,serverMergeDays:1,mergeVersion:1,fcmOnlineTime:0,fcmOnlineIndex:0,fcmOnlineIndex2:0,fcmOnlineIndex3:0,triggerData:null,setupServerData:function(e){this.openServerDay=e.serverStartDays,this.serverMergeDays=e.serverMergeDays,this.mergeVersion=e.mergeVersion,this.openServerTime=e.serverStartTime,this.mergeServerTime=e.serverMergeTime},setup:function(e){e&&(this.loginTime=e.loginTime,this.loginDay=e.loginDay,this.totalOnlineTime=e.totalOnlineTime,this.dailyOnlineTime=e.dailyOnlineTime,this.logoutTime=e.logoutTime,this.collectedVipLv=e.collectedVipLv)}});game.miscData=game.miscData||new e}(),function(){var e;e=b8e.Enum({NONE:-1,V_SWITCH_PAGE:-1,C_BACK_SYN_BACK_INFO:-1,C_BACK_USE_ITEM_RESPONSE:-1,C_BACK_UPDATE_ITEMINFO:-1,V_BACK_UPDATE_ITEMINFO:-1,C_BACK_REMOVE_ITEMINFO:-1,C_CAN_WEAR:-1,C_UPDATE_AMOUNT:-1,C_EQUIP_UPDATE:-1,C_BACK_REMOVE_EQUIPS:-1,C2C_UPDATE_SURFACE:-1,C2C_REMOVE_SURFACE:-1,C_UPDATE_DESTINY:-1,C2C_UPDATE_TRANSFERRQUIP:-1,C_UPDATE_PARTNER_ACTIVE:-1,C2V_UPDATE_PAGE:-1,V2C_SWITCH_PAGE:-1,C2V_SWITCH_PAGE:-1,C2V_SWITCH_PAGE_TASK:-1,C2C_REMOVE_AMOUNT:-1}),b8e.RC("$$game","$$BackEvts",e)}(),function(){var e=game.Control.extends({backpackAlert:null,tweenSpace:300,init:function(){this.backpackAlert=game.spotAlert.set(game.SAE.BACK_PACK)},ipc:function(){var e=this;e.evts={Recharge:{C_RECHARGE_SUCCESS:e.rechargeSuccess},MainRole:{C_LEVEL_UP:e.updateEffectItem,C_VIP_LEVEL_CHANGE:e.updateEffectItem},Task:{C_UPDATE_BACK_VIEW:e.updatePage},BoonRecharge:{C2C_POINT_ADD:e.evtsSend},Partner:{C_INIT_DATA:e.updateEffectItem,V_UPDATE_STAR:e.updateEffectItem,C_UPDATE_ACTIVE:e.updateEffectItem},Foster:{C2C_FOSTER_DATA_INIT:e.updateEffectItem,C2C_FOSTER_ACTIVE:e.updateEffectItem,C2C_FOSTER_UPSTAR:e.updateEffectItem},ShenQi:{C2C_SYS_DATA:e.updateEffectItem},ShenQiActive:{C2C_UPDATE_ACTIVE:e.updateEffectItem},ZhenXing:{C2C_SYS_DATA:e.updateEffectItem},ZhenXingActive:{C2C_UPDATE_ACTIVE:e.updateEffectItem},ZhenXingStar:{C2C_STAR_SUCCESS:e.updateEffectItem}},e.handels={BagDataResp:e.synBackItemInfo,GiveItemMsg:e.addItemOrAmount,TakeItemMsg:e.removeItemOrAmount,UseItemResp:e.useItemRp}},triggerOpen:function(e){e==this.moduleEnum&&(game.itemData.initTitleInfoList(),this.sender.BagDataReq())},updateEffectItem:function(){game.itemData.updateEffectItem(),b8e.module.isShowView(this.moduleEnum)&&this.send(this.Evts.C2V_UPDATE_PAGE)},synBackItemInfo:function(e){var t=this,a=e.readProtobuf(game.pb.BagDataResponse);if(0<a.code)game.notice.noticeError(a.code);else{t.evtList||(t.evtList=[]);var i=!1,n=!1,s=void 0,o=void 0,r=void 0,g=0,l=0,c=void 0,h=a.userItem;if(game.itemData.consume=h.useTotalGold,h.items&&0<h.items.length){for(g=h.items.length,l=0;l<g;l++)if((o=h.items[l])&&(r=game.ItemInfoCfg.getData(o.id))){var m=r.moduleId;if(m&&0<m.length)for(var u=void 0,d=m.length,f=0;f<d;f++)u=m[f],t.evtList.indexOf(u)<0&&t.evtList.push(u);var p=game.ItemCfgType;switch(r.cfgType){case p.Equip:case p.PartnerProper:case p.FosterEquip:case p.GOD_ANIMAL_EQUIP:game.equipData.addItem(o),s=i=!0;break;default:game.itemData.addItem(o),r.cfgType!=p.EffectItem&&r.pageId!=game.BackPageId.BACK_PACK_SHARD||(n=!0),s=!1}game.itemData.addItemPageList(o,s)}n&&t.updateEffectItem(),t.checkAlert()}if(h.amounts&&0<h.amounts.length){for(g=h.amounts.length,l=0;l<g;l++)(c=h.amounts[l])&&game.amount.setAmount(c);t.dpt(t.Evts.C_UPDATE_AMOUNT)}if(t.dpt(t.Evts.C_BACK_SYN_BACK_INFO),i&&(game.equipData.setEquips(),t.dpt(t.Evts.C_EQUIP_UPDATE)),t.evtList&&0<t.evtList.length){var _=void 0;for(g=t.evtList.length,l=0;l<g;l++)_=t.evtList[l],t.dpt(_);t.evtList.length=0}game.itemData.setItemlimit(a.dailyUseItems),game.sdk.enterGameLog()}},addItemOrAmount:function(e){var t=this,a=e.readProtobuf(game.pb.GiveItemNotify),i=!1,n=!1,s=!1,o=!1,r=!1,g=void 0,l=void 0,c=0,h=0,m=void 0,u=a.userItem,d=a.hide;if(u){if(t.evtList||(t.evtList=[]),u.items&&0<u.items.length){for(c=u.items.length,h=0;h<c;h++)if(g=u.items[h],l=game.ItemInfoCfg.getData(g.id)){var f=l.moduleId;if(f&&0<f.length)for(var p=void 0,_=f.length,v=0;v<_;v++)p=f[v],t.evtList.indexOf(p)<0&&t.evtList.push(p);var E=game.ItemCfgType;switch(l.itemType==game.ItemType.Surface&&(n=!0),l.itemType==game.ItemType.TransferEquip&&(s=!0),l.cfgType){case E.Equip:case E.PartnerProper:case E.FosterEquip:case E.GOD_ANIMAL_EQUIP:game.equipData.addItem(g),o=i=!0;break;default:game.itemData.getItemByIdx(g.idx)?game.itemData.change(g.idx,g.num,!0):game.itemData.addItem(g),l.cfgType!=E.EffectItem&&l.pageId!=game.BackPageId.BACK_PACK_SHARD||(r=!0),o=!1}d||(l.isRare&&!b8e.module.isShowView(game.ME.RareItemShow)&&(game.tipsData.setInfo(l),game.module.show(game.ME.RareItemShow)),game.notice.getNotice(g.id,g.num),l.preciousTips&&game.notice.showPreciousItemNotice(l)),game.itemData.addItemPageList(g,o)}else b8e.error("\u670d\u52a1\u5668\u53d1\u9001\u4e86\u4e00\u4e2a\u9519\u8bef\u7684id",g.id);r&&t.updateEffectItem(),t.checkAlert()}if(u.amounts&&0<u.amounts.length){for(c=u.amounts.length,h=0;h<c;h++)m=u.amounts[h],game.amount.setAmount(m),d||game.notice.amountNotice(m.type,m.updateNum);t.dpt(t.Evts.C_UPDATE_AMOUNT)}if(u.partners&&!d)for(h=0,c=u.partners.length;h<c;h++){var C=u.partners[h],T={},A=game.ItemInfoCfg.getData(C.id);T.id=A.partnerId,T.repeat=!0,T.num=C.num,game.partnerData.partnerActiveTips.push(T),t.dpt(t.Evts.C_UPDATE_PARTNER_ACTIVE)}if(b8e.hasTimeout(t._backUpdateItemInfo,t)||b8e.setTimeout(t._backUpdateItemInfo,t,32),t.evtList&&0<t.evtList.length){var I=void 0;for(c=t.evtList.length,h=0;h<c;h++)I=t.evtList[h],t.dpt(I);t.evtList.length=0}i&&(game.equipData.setEquips(),t.dpt(t.Evts.C_EQUIP_UPDATE)),n&&t.dpt(t.Evts.C2C_UPDATE_SURFACE),s&&t.dpt(t.Evts.C2C_UPDATE_TRANSFERRQUIP),game.notice.showNoticeList()}},removeItemOrAmount:function(e){var t=this,a=e.readProtobuf(game.pb.TakeItemNotify),i=!1,n=a.goldIgnore,s=!1,o=!1,r=!1,g=void 0,l=void 0,c=void 0,h=0,m=0,u=void 0,d=a.userItem;t.evtList||(t.evtList=[]);var f=!1;if(d.items&&0<d.items.length){for(h=d.items.length,m=0;m<h;m++)if(l=d.items[m],c=game.ItemInfoCfg.getData(l.id)){var p=c.moduleId;if(p&&0<p.length)for(var _=void 0,v=p.length,E=0;E<v;E++)_=p[E],t.evtList.indexOf(_)<0&&t.evtList.push(_);var C=game.ItemCfgType;switch(c.itemType==game.ItemType.Surface&&(s=!0),c.itemType==game.ItemType.TransferEquip&&(f=!0),c.cfgType){case C.Equip:case C.PartnerProper:case C.FosterEquip:case C.GOD_ANIMAL_EQUIP:game.equipData.removeItem(l),o=i=!0;break;default:(g=game.itemData.getItemByIdx(l.idx))&&(g.num<=l.num?game.itemData.removeItem(l):game.itemData.change(l.idx,l.num,!1)),c.cfgType!=C.EffectItem&&c.pageId!=game.BackPageId.BACK_PACK_SHARD||(r=!0),o=!1}game.itemData.removeItemPageList(l,o)}else b8e.error("\u670d\u52a1\u5668\u53d1\u9001\u4e86\u4e00\u4e2a\u9519\u8bef\u7684id",l.id);r&&t.updateEffectItem(),t.checkAlert()}if(d.amounts&&0<d.amounts.length){h=d.amounts.length;var T=0;for(m=0;m<h;m++)(u=d.amounts[m]).type==game.AmountType.YUAN_BAO&&(game.itemData.consume+=u.updateNum,T=u.updateNum),game.amount.setAmount(u);!n&&0<T&&t.dpt(t.Evts.C2C_REMOVE_AMOUNT,T),t.dpt(t.Evts.C_UPDATE_AMOUNT,n)}if(i&&(game.equipData.setEquips(),t.dpt(t.Evts.C_EQUIP_UPDATE)),s&&t.dpt(t.Evts.C2C_REMOVE_SURFACE),f&&t.dpt(t.Evts.C2C_UPDATE_TRANSFERRQUIP),t.evtList&&0<t.evtList.length){var A=void 0;for(h=t.evtList.length,m=0;m<h;m++)A=t.evtList[m],t.dpt(A);t.evtList.length=0}b8e.hasTimeout(t._backUpdateItemInfo,t)||b8e.setTimeout(t._backUpdateItemInfo,t,32)},_backUpdateItemInfo:function(){this.dpt(this.Evts.C_BACK_UPDATE_ITEMINFO),b8e.module.isShowView(this.moduleEnum)&&this.send(this.Evts.C2V_UPDATE_PAGE)},useItemRp:function(e){var t=e.readProtobuf(game.pb.UseItemResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.idx,i=t.num,n=game.itemData.getItemByIdx(a);if(n){var s=game.ItemInfoCfg.getData(n.id);if(s){if(s.effectType==game.ItemEffectType.DAILY_LIMIT){var o=game.itemData.getitemlimitNum(s.id);o||(game.itemData.setItemlimitNum(s.id,0),o=0),game.itemData.setItemlimitNum(s.id,o+=i)}var r=s.name;if(r&&""!=r&&game.notice.show(114,r),0!=i){n.num>i&&0<n.num?game.itemData.change(a,i,!1):game.itemData.removeItem(n),game.itemData.removeItemPageList(n,!1);var g=s.moduleId;if(g&&0<g.length)for(var l=void 0,c=g.length,h=0;h<c;h++)l=g[h],this.dpt(l);if(b8e.hasTimeout(this._backUpdateItemInfo,this)||b8e.setTimeout(this._backUpdateItemInfo,this,32),b8e.hasTimeout(this._backuseItemResponse),this&&b8e.setTimeout(this._backuseItemResponse,this,32),t.userItem){var m=game.mainInstanceData;m.isQuickBattle=!1,m.quickItmeNum=i,m.setQuickBattleAward(t.userItem,t.exp)}}}}}},_backuseItemResponse:function(){this.dpt(this.Evts.C_BACK_USE_ITEM_RESPONSE)},rechargeSuccess:function(e){if(e&&e.data){var t=e.data.id,a=e.data.isFirst,i=e.data.money;if(t){var n,s,o=game.RechargeCfg.getDataById(t);if(!o)return;var r=o.rechargeType,g=game.RechargeType;if(r==g.NORMAL){if(!(n=game.NormalRechargeCfg.getData(t)))return;s=a?n.gold+n.firstExtraGold:n.gold+n.extraGold}else{if(r==g.SALE||r==g.TIMELIMITPRIZE||r==g.DAILY_SALE_PRIZE||r==g.GROWTH_PRIZE||r==g.ASSET_PRIZE||r==g.KEEP_PRIZE||r==g.RECALL_PRIZE||r==g.SUPREME_WAR_ORDER||r==g.KEEP_RECHARGE_REPLENISH)return;if(r==g.CHOOSE){if(!(n=game.ChooseRechargeCfg.getData(t)))return;s=a?n.gold+n.firstExtraGold:n.gold}else(n=game.CardRechargeCfg.getDataById(t))&&(s=n.gold)}s&&0<s&&game.amount.changeAmount(game.AmountType.YUAN_BAO,s)}else game.amount.changeAmount(game.AmountType.YUAN_BAO,i);this.dpt(this.Evts.C_UPDATE_AMOUNT)}},notify:function(e,t,a,i){switch(e){case this.Evts.V2C_SWITCH_PAGE:this.switchPage(t,a,i)}},switchPage:function(e,t,a){(game.itemData.canSwitchPage(e)||a)&&this.send(this.Evts.C2V_SWITCH_PAGE,t)},updatePage:function(e){var t=e.data;this.send(this.Evts.C2V_SWITCH_PAGE_TASK,t)},checkAlert:function(){this.checkLock||(this.checkLock=!0,b8e.setTimeout(this._checkAlert,this,500))},_checkAlert:function(){this.checkLock=!1;var e=game.itemData.getTitleInfoList();if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=e.length,l=0;l<g;l++)if((n=(o=e[l]).id)!=game.BackPageId.BACK_PACK_EQUIP&&(r=this.getSpotAlertInfo(o.spotAlertEnum)))if(!(s=game.itemData.getItemListByPageId(n))||s.length<1)r.alert=!1;else{i=!1;for(var c=0;c<s.length&&(a=s[c],!(t=game.ItemInfoCfg.getData(a.id))||t.cfgType!=game.ItemCfgType.EffectItem&&t.pageId!=game.BackPageId.BACK_PACK_SHARD||!(i=game.itemData.getEffectItemAlert(a.id,a.num)));c++);r.alert=i}},evtsSend:function(){this.dpt(this.Evts.C_UPDATE_AMOUNT)},getSpotAlertInfo:function(e){if(!e)return null;var t=b8e.getDPV(game.SAE,e);return t&&game.spotAlert.get(t)?game.spotAlert.get(t):null},smeltingBtn:function(){game.module.show(game.ME.Sell)}}),t=game.Sender.extends({ipc:function(){this.msg={BagDataReq:null}}});b8e.module.registerControl(game.ME.Back,e,game.BackEvts,t)}(),function(){var e;e=b8e.PoolObject.extends({id:0,alert:!1,name:"",index:0,select:!1,setData:function(e,t){if(e){this.alert=!1,this.cfg=e,this.index=t,this.id=e.id,this.name=e.name,this.spotAlertEnum=e.spotAlertEnum}},getCfg:function(){return this.cfg}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$BackTitleInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,BACK_PACK_GOODS:1,BACK_PACK_EQUIP:2,BACK_PACK_SHARD:3,BACK_PACK_HUNSHI:4,BACK_PACK_GOD_EQUIP:5,BACK_PACK_EXCLUSIVE_WEAPON:6}),b8e.RC("$$game","$$BackPageId",e)}(),function(){var e=game.BaseItemData.extends({consume:0,selectIndex:-1,ctor:function(){this._super(),this.infoPool=game.ItemInfo,this._itemTypeMap=b8e.HashMap.get(),this._itemPageMap=b8e.HashMap.get(),this._itemlimitMap=b8e.HashMap.get()},addItem:function(e){var t=this._itemIdsMap.get(e.id),a=game.ItemUtil.createItemInfo(e);if(!t){t=[]}var i=!1;if(0<t.length)for(var n,s=t.length,o=0;o<s;o++){if((n=t[o])&&n.id==e.id&&n.idx==e.idx){t[o]=a,i=!0}}else t.push(a),i=!0;if(!i){t.push(a)}this._itemIdsMap.set(a.id,t),this._itemIdxMap.set(a.idx,a);var r=game.ItemInfoCfg.getCfgItemTypeById(a.id);if(r){var g=this._itemTypeMap.get(r);if(-1<(g=g||[]).indexOf(a.id))return;g.push(a.id),this._itemTypeMap.set(r,g)}},removeItem:function(e){this._super(e);var t=e.id,a=game.ItemInfoCfg.getCfgItemTypeById(t);if(a&&this._itemIdsMap.get(t).length<1){var i=this._itemTypeMap.get(a);if(i){var n=i.indexOf(t);-1<n&&i.splice(n,1)}}},removeItemByIds:function(e){if(e&&!(e.length<1))for(var a=void 0,i=void 0,n=e.length,s=0;s<n;s++)a=e[s],(i=t.getItemById(a))&&t.change(i.idx,1,!1)},getCountById:function(e){var t=0;if(game.ItemInfoCfg.getCfgTypeById(e)==game.ItemCfgType.Amount){t=game.amount.getAmountById(e)}else t=this.getNumById(e);return t},updateEffectItem:function(){game.mainRoleData.lv,game.mainRoleData.vipLevel;this._itemIdxMap.forEach(function(e,t){var a=game.ItemInfoCfg.getData(t.id);if(a){if(a.cfgType==game.ItemCfgType.EffectItem||a.pageId==game.BackPageId.BACK_PACK_SHARD){t.isAlert=game.itemData.getEffectItemAlert(a.id,t.num)}}else;},this)},updateEffectItemByIdx:function(e){var t=this.getItemByIdx(e);t&&(t.isAlert=this.getEffectItemAlert(t.id,t.num))},getEffectItemAlert:function(e,t){var a=!1,i=game.ItemInfoCfg.getData(e);if(!i)return!1;if(i.foreverAlert)return!0;if(i.partnerId){var n=game.partnerData.getInfoById(i.partnerId);if(!n)return!1;if(n.active)return game.partnerData.canStar(n);var s=n.cfg;return!!s&&(s.chipItems&&s.chipItems[0]&&s.chipItems[0].Num<=t)}if(i.fosterType&&i.fosterId){if(i.fosterType==game.NewFosterType.ZHENXING){if(!game.moduleOpen.checkOpen(game.ME.ZhenXing))return!1;var o=game.zhenXingData.getInfoById(i.fosterId);if(!o||!o.active){var r=game.FormationBaseCfg.getData(i.fosterId);return r?r.costItem&&t>=r.costItem.Num:(b8e.warn("\u9053\u5177\u5c0f\u7ea2\u70b9\u68c0\u67e5\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u9635\u578b\u914d\u7f6e:"+i.fosterType+"   "+i.fosterId),!1)}var g=game.zhenXingData.getObj(o.id,o.star),l=game.FormationStarCfg.getData(g);if(!l)return!1;var c=l.costItem;return!(!c||c.length<1)&&(c[0].Id==e&&t>=c[0].Num)}if(i.fosterType==game.NewFosterType.SHENQI){if(!game.moduleOpen.checkOpen(game.ME.ShenQi))return!1;var h=game.shenQiData.getInfoById(i.fosterId);if(h&&h.active)return!1;var m=game.ShenQiCfg.getData(i.fosterId);return m?m.itemId==e&&t>=m.itemNum:(b8e.warn("\u9053\u5177\u5c0f\u7ea2\u70b9\u68c0\u67e5\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u795e\u5668\u914d\u7f6e:"+i.fosterType+"   "+i.fosterId),!1)}var u=game.fosterData.getFosterClientCfgByType(i.fosterType);if(!u)return!1;if(!game.moduleOpen.checkOpen(u.moduleEnum))return!1;var d=game.fosterData.getFosterInfo(i.fosterType,i.fosterId);if(!d||!d.active){var f=game.fosterData.getFosterBaseCfg(i.fosterType,i.fosterId);return f?f.itemId==e&&t>=f.itemNum:(b8e.error("\u9053\u5177\u5c0f\u7ea2\u70b9\u68c0\u67e5\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u8fdb\u9636\u7ebf\u7c7b\u578b\u7684\u8fdb\u9636\u7ebfid:"+i.fosterType+"   "+i.fosterId),!1)}var p=game.fosterData.getFosterUpStarCfg(i.fosterType,d.id,d.star);if(!p)return;return p.itemId==e&&t>=p.itemNum}if(i.cfgType!=game.ItemCfgType.EffectItem||i.level>game.mainRoleData.lv||i.vip>game.mainRoleData.vipLevel)return!1;if(i.ignoreRedSpot)return!1;switch(i.effectType){case game.ItemEffectType.EXP:var _=game.RoleExpCfg.getData(game.mainRoleData.lv);_&&_.exp>game.mainRoleData.exp&&(a=!0);break;default:a=!0}if(i.useCost&&0<i.useCost.length){a=game.UpgradeUtil.checkItemList(i.useCost,1,!1)}return a},getListByItemType:function(e){return this._itemTypeMap.get(e)?this._itemTypeMap.get(e):null},initTitleInfoList:function(){this.titleInfoList=[];var e=game.BackSettingCfg.getDatas();if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=void 0,n=e.length,s=0;s<n;s++)a=e[s],(i=new game.BackTitleInfo).setData(a,s),this.titleInfoList.push(i),a.spotAlertEnum&&(t=b8e.getDPV(game.SAE,a.spotAlertEnum),game.spotAlert.set(t,game.SAE.BACK_PACK))},getTitleInfoList:function(){return this.titleInfoList},addItemPageList:function(e,t){if(e){var a=e.idx,i=this.getPageIdById(e.id),n=this.getItemInfo(a,t);if(n){var s=this._itemPageMap.get(i);s||(s=b8e.HashMap.get(),this._itemPageMap.set(i,s)),s.set(a,n)}}},removeItemPageList:function(e,t){var a=e.idx,i=this.getPageIdById(e.id),n=this.getItemInfo(a,t),s=this._itemPageMap.get(i);s&&(n?s.set(a,n):s.del(a))},getItemInfo:function(e,t){return(t?game.equipData.getItemByIdx(e):this.getItemByIdx(e))||null},getPageIdById:function(e){var t=game.ItemInfoCfg.getData(e);return t&&t.pageId?t.pageId:game.BackPageId.BACK_PACK_GOODS},getItemListByPageId:function(e){var t=this._itemPageMap.get(e);return t&&0<t.count()?t.values():null},canSwitchPage:function(e){var t=this.selectIndex;if(t==e)return!1;var a=this.titleInfoList[e];return!!a&&(-1<t&&(this.titleInfoList[t].select=!1),a.select=!0,this.selectIndex=e,!0)},setItemlimit:function(e){if(e)for(var t=e.length,a=0;a<t;a++){var i=e[a];this._itemlimitMap.set(i.id,i.num)}},getitemlimitNum:function(e){return this._itemlimitMap.get(e)},setItemlimitNum:function(e,t){this._itemlimitMap.set(e,t)},clearlimit:function(){this._itemlimitMap.clear()}});game.itemData=game.itemData||new e}(),function(){var e;(e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(1201),this.setSize(100,120)},setData:function(){if(!this._itemGrid){this._itemGrid=game.GridUtil.createBackItemIcon(game.IconSizeEnum.GRID_SIZE_105),this._itemGrid.addToParent(this.skin.icon)}game.GridUtil.setItemIcon(this._itemGrid,this.data)}})).poolCall=!0,b8e.RC("$$game","$$BackGoodsItem",e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(1290),this.setSize(130,60),this.bindEnum=game.ME.Back},init:function(){b8e.evt.onC(this,this.onClickTab,this)},loadComplete:function(){if(this.hide(),this.data){this.show(this.data)}},show:function(e){this.data=e,this._super()},onShow:function(){this.setData(),this.setVisible(!0)},onHide:function(){this.setVisible(!1)},setData:function(){var e=this.skin,t=this.btnInfo=this.data;if(t){var a=t.getCfg();if(a)if(e.title.string=a.name,e.selectImg.active=t.select,a.spotAlertEnum){var i=b8e.getDPV(game.SAE,a.spotAlertEnum);this.bindAlert(i)}else e.alert.active=!1,this.unbindAlert()}},setSelect:function(e){this.skin&&(this.skin.selectImg.active=e==this.btnInfo.id)},bindAlert:function(e){var t=this;t._bindAlert&&t.sae==e||(0!=t.sae&&t.unbindAlert(t.sae),t.sae=e,t.sae&&(game.spotAlert.setCb(t.sae,t.updateAlert,t),t._bindAlert=!0))},unbindAlert:function(e){this._bindAlert&&(game.spotAlert.delCb(e,this.updateAlert,this),this._bindAlert=!1)},updateAlert:function(e){var t=this.skin;t.alert.active=!!e&&e.alert},clickBtn:function(){},onClickTab:function(){this.btnInfo&&this.send(game.BackEvts.V2C_SWITCH_PAGE,this.btnInfo.index,this.btnInfo.id)}}),b8e.RC("$$game","$$BackTitleItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1198),this.spotAlerts={SELL:this.sellAlert}},init:function(){var e=this.skin,t=this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.BackGoodsItem,t.addToParent(e.scrollGrid),t.layout.paddingLeft=13,t.layout.spacingX=20,t.layout.spacingY=15,t.safetyTraversal=!1,this.initTitleList()},initTitleList:function(){var e=this;if(e.titleInfoList=game.itemData.getTitleInfoList(),e.titleInfoList){if(0<e.titleInfoList.length){var t=e.titleInfoList[0];e.defaultSelectId=t.id}e.titleList=[];for(var a=void 0,i=void 0,n=e.titleInfoList,s=n.length,o=0;o<s;o++)i=n[o],(a=new game.BackTitleItem).addToParent(e.skin.titleList),a.x=133*o,a.show(i),e.titleList.push(a);e.skin.titleList.width=133*s}},updateTitleSelect:function(){var e=this.titleList;if(e&&!(e.length<1))for(var t=this.selectPageId,a=e.length,i=0;i<a;i++)e[i].setSelect(t)},notify:function(e,t){switch(e){case this.Evts.C2V_SWITCH_PAGE:this.toggleSelect(t);break;case this.Evts.C2V_UPDATE_PAGE:this.updataPage();break;case this.Evts.C2V_SWITCH_PAGE_TASK:this.send(this.Evts.V2C_SWITCH_PAGE,t,t+1,!0)}},sellAlert:function(e){this.skin.sell_spot.active=e.alert},toggleSelect:function(e){this.selectPageId=e,this.updataPage()},updataPage:function(){var e=this;if(e.selectPageId){e.selectPageId==game.BackPageId.BACK_PACK_SHARD&&game.itemData.updateEffectItem(),e.infoList=game.itemData.getItemListByPageId(e.selectPageId),e.infoList&&0<e.infoList.length&&e.infoList.sort(e.onSort),e.gridList.setData(e.infoList);var t=e.selectPageId==game.BackPageId.BACK_PACK_EQUIP;if(e.skin.count.active=t,e.skin.lab_count.active=t){var a=game.equipData.getIdxCount(),i=game.equipData.getEquipMaxCount();e.skin.count.string=0==a?game.Lang.get(901,a,i):game.Lang.get(902,a,i)}var n=game.BackSettingCfg.getData(e.selectPageId);n&&e.skin.title_bag.loadTexture(game.ResCfg.getImgUrl(n.titleUrl)),e.updateTitleSelect()}},onSort:function(e,t){return e.isAlert==t.isAlert?e.sortId==t.sortId?e.quality!=t.quality?t.quality-e.quality:e.id-t.id:t.sortId-e.sortId:e.isAlert?-1:1},onShow:function(){this.selectPageId=this.defaultSelectId,this.send(this.Evts.V2C_SWITCH_PAGE,0,this.defaultSelectId,!0)},$$getTabBtn:function(e){if(!this.titleList||this.titleList.length<=e)return null;var t=this.titleList[e];return t||null},$$getGoodsItem:function(e){var t=void 0;if(!this.infoList||!this.infoList.length)return null;for(var a=0,i=this.infoList.length;a<i;a++)if(this.infoList[a].id==e){t=this.infoList[a];break}if(!t)return null;var n=this.gridList.getItemRender(t);return n._itemGrid?n._itemGrid:null}});b8e.module.registerView(game.ME.Back,e)}(),function(){var e,t=e=b8e.Object.extends({items:null,fontSize:null,ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:game.IconLayoutEnum.SHOW_NUM,i=1<arguments.length&&void 0!==t?t:game.IconSizeEnum.GRID_SIZE_105;this._super(),this.items=[],this.iconLayoutEnum=a,this.iconSize=i},setup:function(e){this.setListData(e,!0)},setup2:function(e){this.setListData(e,!1)},setListData:function(e,t){var a=this.items.slice();if(this.items.length=0,e){for(var i=void 0,n=void 0,s=void 0,o=0,r=e.length;o<r;o++){i=a.pop(),n=t?e[o].Id:e[o].id,s=t?e[o].Num:e[o].num;var g=game.ItemUtil.createBaseItemInfo(n,s,i);g.iconLayoutEnum=this.iconLayoutEnum,g.iconSize=this.iconSize,this.fontSize&&(g.fontSize=this.fontSize),this.items.push(g)}for(var l=0,c=a.length;l<c;l++)(i=a[l]).release()}},setDropItems:function(e){if(this.items.length=0,e)for(var t=0,a=e.length;t<a;t++){var i=game.ItemUtil.createBaseItemInfo(e[t],0);i.iconLayoutEnum=this.iconLayoutEnum,i.iconSize=this.iconSize,this.items.push(i)}}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$CfgPrizeInfo",e)}(),function(){var e;e=b8e.Enum({CLOSE_FUNC_BTN:b8e.enc(),SHOW_FUNC_BTN:b8e.enc(),OPEN_CHAT:b8e.enc(),OPEN_CHAT2:b8e.enc(),SELECT_CHANNEL:b8e.enc(),SEND_CHAT:b8e.enc(),UPDATE_CHANNEL:b8e.enc(),SHOW_NEW_CHAT:b8e.enc(),SHOW_AND_SELECT_ROLE:b8e.enc(),CLOSE_ONE_PRIVATE_CHAT:b8e.enc(),CLOSE_PRIVATE_CHAT:b8e.enc(),MIN_PRIVATE_CHAT:b8e.enc(),SELECT_ROLE_WITH_PRIVATE_CHAT:b8e.enc(),SEND_PRIVATE_CHAT:b8e.enc(),ADD_PRIVATE:b8e.enc(),UPDATE_PRIVATE_CHAT:b8e.enc(),MIN_PRIVATE_WIN:b8e.enc(),SHOW_EMOTION:b8e.enc(),ADD_CHAT_EMOTION:b8e.enc(),ADD_CHAT_CONTENT:b8e.enc(),SHOW_TIPS:b8e.enc(),QUICK_CHAT_SELECT:b8e.enc(),SHOW_EDIT_BOX:b8e.enc(),QURY_ROLES_ONLINE:b8e.enc(),SHOW_PLAYER:b8e.enc(),COPY_PLAYER_NAME:b8e.enc(),C_CHAT_FUNC_NONE:b8e.enc(),C_CHAT_FUNC_PET_SHOW:b8e.enc(),C_CHAT_FUNC_TEAM:b8e.enc(),C_CHAT_FUNC_HELP:b8e.enc(),C_CHAT_FUNC_GUILD_NEW_BOSS:b8e.enc(),C_CHAT_FUNC_MASTER:b8e.enc(),C_CHAT_FUNC_CREATE_GUILD:b8e.enc(),C_CHAT_FUNC_FOSTER_ADVANCE:b8e.enc(),C_CHAT_FUNC_FOSTER_AWAKEN:b8e.enc(),C_SHOW_CHAT_VIEW:b8e.enc(),SHOW_CHATVIEW:b8e.enc(),SHOW_CLIENT_CHAT:b8e.enc(),C2C_OPEN_CHAT:b8e.enc(),C_REQ_ENTER_TEAM:b8e.enc(),C2C_APPRENTICE:b8e.enc(),V2C_REQ_ENTER_CS_WAR:b8e.enc(),C2C_REQ_ENTER_CS_WAR:b8e.enc(),V2C_REQ_GOTO_CS_WAR:b8e.enc(),C2C_REQ_GOTO_CS_WAR:b8e.enc(),V2C_REQ_RECRUIT_CS_WAR:b8e.enc(),C2C_REQ_RECRUIT_CS_WAR:b8e.enc(),V2C_REQ_RECRUIT_GUANDU:b8e.enc(),C2C_REQ_RECRUIT_GUANDU:b8e.enc(),V2C_REQ_ENTER_THRONE:b8e.enc(),C2C_REQ_ENTER_THRONE:b8e.enc(),V2C_REQ_ENTER_GUILDWAR:b8e.enc(),C2C_REQ_ENTER_GUILDWAR:b8e.enc(),V2C_REQ_ENTER_CSARROW:b8e.enc(),C2C_REQ_ENTER_CSARROW:b8e.enc(),V2C_ARROW_GET:b8e.enc(),C2C_ARROW_GET:b8e.enc(),V2C_REQ_JOIN_CSARENA:b8e.enc(),C2C_REQ_JOIN_CSARENA:b8e.enc(),C2V_BLACK_CHANGE:b8e.enc(),SEND_CHAT2:b8e.enc(),SELECT_CHANNEL2:b8e.enc(),ADD_CHAT_EMOTION2:b8e.enc(),V2C_CSGUILD_RELIVE:b8e.enc(),V2C_CSGUILD_KILL:b8e.enc(),C2C_CSGUILD_RELIVE:b8e.enc(),C2C_CSGUILD_KILL:b8e.enc(),V2C_REQ_ENTER_TREASURE:b8e.enc(),C2C_REQ_ENTER_TREASURE:b8e.enc(),ADD_SELF_PRIVATE_CHAT:b8e.enc(),V2C_CSFESTIVAL_BOSS_RELIVE:b8e.enc(),V2C_CSFESTIVAL_BOSS_KILL:b8e.enc(),C_WORLDWAR_INVITE:b8e.enc()}),b8e.RC("$$game","$$ChatEvts",e)}(),game.Control.extends({init:function(){},emotion_sp:function(){},notify:function(e,t){switch(e){case game.ChatEvts.ADD_CHAT_EMOTION:var a=t||"";this.dpt(game.ChatEvts.ADD_CHAT_EMOTION,a)}}}),function(){var e=game.Control.extends({playerInfo:null,ipc:function(){this.gevts={ChatEvts:{SHOW_PLAYER:this.getPlayerInfo}},this.evts={Relation:{C_BLACK_CHANGE:this.updateShowPlayer,C_FOLLOW_CHANGE:this.updateShowPlayer}},this.handels={ViewRoleResp:this.roleInfoResp}},updateShowPlayer:function(){this.send(game.ChatEvts.SHOW_PLAYER)},roleInfoResp:function(e){var t=e.readProtobuf(game.pb.ViewRoleResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.chatData.updatePlayerInfo(t),this.send(game.ChatEvts.SHOW_PLAYER);var a=game.ME.ChatPlayerInfo;b8e.module.isShowView(a)&&game.module.hide(a),game.module.show(a)}},notify:function(e,t){switch(e){case game.ChatEvts.SHOW_PLAYER:if(!t)return;this.sender.ViewRoleReq(t.roleId)}},getPlayerInfo:function(e){e&&this.sender.ViewRoleReq(e.data)},chat_btn:function(){var e=game.chatData.playerInfo,t=game.ChatCfg.getData(game.ChatChannelType.PRIVATE);t?game.mainRoleData&&game.mainRoleData.lv<t.limitLv?game.notice.show(9585,t.limitLv):this.dptG(game.ChatEvts.SHOW_AND_SELECT_ROLE,e):b8e.warn(this._selectChannel,"\u804a\u5929\u9891\u9053\u4e3a\u5565\u6ca1\u6709\u914d\u7f6e\uff1f")},follow_btn:function(){var e=game.chatData.playerInfo.roleId;game.relationData&&(game.relationData.isFollowed(e)?this.dptG(game.RelationEvts.CANCEL_FOLLOW,e):this.dptG(game.RelationEvts.FOLLOW,e))},black_btn:function(){for(var e=game.chatData.playerInfo.roleId,t=[game.mAData.masterData,game.mAData.apprentice1,game.mAData.apprentice2,game.marryData.patnerData],a=0;a<t.length;a++)if(t[a]&&(e==t[a].roleid||e==t[a].partner))return void game.notice.show(3202);game.relationData&&(game.relationData.isInBlackList(e)?this.dptG(game.RelationEvts.CANCEL_BLACK,e):this.dptG(game.RelationEvts.BLACK,e))},apprentice_btn:function(){if(game.UpgradeUtil.checkItemInfo(305001,1)){var e=game.chatData.playerInfo.roleId;this.dpt(this.Evts.C2C_APPRENTICE,e)}},copy_name_btn:function(){this.send(game.ChatEvts.COPY_PLAYER_NAME,null)},vip_btn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP)}}),t=game.Sender.extends({ipc:function(){this.msg={ViewRoleReq:this.roleInfoReq}},roleInfoReq:function(e){var t=game.pb.ViewRoleRequest;t.roleId=e,game.chatData.setPlayerInfoId(e),this.write(t)}});b8e.module.registerControl(game.ME.ChatPlayerInfo,e,game.ChatEvts,t)}(),function(){var e=game.Control.extends({init:function(){var e=game.spotAlert;this.spotPrivateAlert=e.set(game.SAE.CHAT_PRIVATE)},ipc:function(){this.gevts={ChatEvts:{ADD_PRIVATE:this.addPrivate,SHOW_AND_SELECT_ROLE:this.showAndSelectRole,ADD_SELF_PRIVATE_CHAT:this.addSelfPriveteChat}},this.evts={Relation:{C_BLACK_CHANGE:this.changeBlack}},this.handels={PrivateChatMsg:this.privateChatNotify,QryRoleOnlineResp:this.roleOnlineResponse}},changeBlack:function(e){if(e&&e.data){game.chatData.delPriChatHeadById(e.data),this.send(this.Evts.UPDATE_PRIVATE_CHAT)}},checkNewPrivateChat:function(){b8e.module.isShowView(game.ME.ChatPrivate)||this.dpt(game.ChatEvts.SHOW_NEW_CHAT)},showAndSelectRole:function(e){if(e){var t=e.data,a=t.roleId,i=t.name,n=t.isMale,s=t.lv,o=game.ME.ChatPrivate;b8e.module.isShowView(o)&&game.module.hide(o),game.module.showHideOther(o),this.addAndSlectRole(a,i,n,s),this.selectChatRole(a)}},addPrivate:function(e){this.addPrivateChats(e.data,!0)},addSelfPriveteChat:function(e){this.addOnePrivateChat(e.data),b8e.module.isShowView(game.ME.ChatPrivate)&&this.send(game.ChatEvts.UPDATE_PRIVATE_CHAT,null)},addOnePrivateChat:function(e){if(!e)return!1;var t=e.roleId;return!game.relationData.isInBlackList(t)&&(game.chatData.addPriChat(e),!0)},addPrivateChats:function(e,t){var a=!1,i=void 0;if(e&&0<e.length)for(var n=0,s=e.length;n<s;n++){var o=e[n];o&&(i=this.addOnePrivateChat(o),a=a||i)}a&&(b8e.module.isShowView(game.ME.ChatPrivate)?(this.send(game.ChatEvts.UPDATE_PRIVATE_CHAT),this.dpt(game.ChatEvts.UPDATE_PRIVATE_CHAT,null)):(this.checkNewPrivateChat(),this.dpt(game.ChatEvts.SHOW_TIPS,{isShow:!0})))},addHistoryPrivateChats:function(e){for(var t=0,a=game.relationData,i=game.mainRoleData.id,n=0,s=e.length;n<s;n++){var o=e[n];t=o.roleId;for(var r=!1,g=0,l=o.contents.length;g<l;g++){var c=o.contents[g];if(a){if(a.isInBlackList(t))continue;r=!0}i!=t&&game.chatData.addHistoryPriChat(t,c,o.roleName,o.isMale,o.vipLevel,o.level)}}r&&(game.chatData.hasPrivHistory=!0,this.checkNewPrivateChat(),b8e.module.isShowView(game.ME.ChatPrivate)||this.dpt(game.ChatEvts.SHOW_TIPS,{isShow:!0}))},privateChatNotify:function(e){var t=e.readProtobuf(game.pb.PrivateChatNotify);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.privateDatas;this.addHistoryPrivateChats(a,!0)}},roleOnlineResponse:function(e){var t=e.readProtobuf(game.pb.QryRoleOnlineResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.roleData;game.chatData.updateOnlineState(a),this.send(game.ChatEvts.UPDATE_PRIVATE_CHAT,null)}},delPrivateChatRole:function(e){game.chatData.delPriChatHeadById(e),this.send(game.ChatEvts.UPDATE_PRIVATE_CHAT,null);var t=game.chatData.getChatHeadArr();t?t.length<=0&&game.module.hide(game.ME.ChatPrivate):game.module.hide(game.ME.ChatPrivate)},addAndSlectRole:function(e,t,a,i){game.chatData.addPriChatHead(e,t,a,i)},selectChatRole:function(e){game.chatData.selectPriChatRole(e),this.send(game.ChatEvts.SELECT_ROLE_WITH_PRIVATE_CHAT,e)},addEmotion:function(e){game.chatData.curEmotionType===game.ChatEmotionType.PRIVATE&&e&&this.send(game.ChatEvts.ADD_CHAT_EMOTION,e)},notify:function(e,t){var a=game.ChatEvts;switch(e){case a.SEND_PRIVATE_CHAT:this.sendOnePrivateChat(t.content,t.targetRoleId);break;case a.CLOSE_ONE_PRIVATE_CHAT:t&&t.roleId&&this.delPrivateChatRole(t.roleId);break;case a.SELECT_ROLE_WITH_PRIVATE_CHAT:t&&0<t&&this.selectChatRole(t);break;case a.SHOW_AND_SELECT_ROLE:t&&(game.module.show(game.ME.ChatPrivate),this.addAndSlectRole(t.roleId,t.name,t.isMale),this.selectChatRole(t.roleId));break;case a.SEND_CHAT:if(t){var i=t.content,n=t.targetName;game.chatData.selectPriChatRoleId<=0?game.notice.show(9003):this.sendOnePrivateChat(i,game.chatData.selectPriChatRoleId,n)}break;case a.ADD_CHAT_EMOTION:this.addEmotion(t);break;case a.QURY_ROLES_ONLINE:this.qryRolesOnlineState();break;case a.MIN_PRIVATE_WIN:this.minWin()}},qryRolesOnlineState:function(){var e=game.chatData.getChatHeadIdArr();if(e&&0<e.length)for(var t=[],a=e.length,i=0,n=Math.min(a,10);i<n&&n<=a;){t.length=0;for(var s=i;s<n;s++){var o=parseInt(e[s]);t.push(o)}this.sender.sendRoleOnLineReqquest(t),i+=10,n=Math.min(n+10,a)}},sendOnePrivateChat:function(e,t,a){if(e){var i=game.relationData;if(i)if(i.isInBlackList(t))return void game.notice.show(9004);this.sender.sendPrivateChatRequest(e,t,a)}},send_btn:function(){this.send(game.ChatEvts.SEND_CHAT,null)},emotion_btn:function(){var e=game.ChatCfg.getData(game.ChatChannelType.PRIVATE);e?game.mainRoleData.lv<e.limitLv?game.notice.show(9586,e.openLv):game.ChatEmotionView.inst().isShow?game.ChatEmotionView.inst().hidePopView():(game.chatData.curEmotionType=game.ChatEmotionType.PRIVATE,game.ChatEmotionView.inst().showPopView()):b8e.warn(this._selectChannel,"\u804a\u5929\u9891\u9053\u6ca1\u6709\u914d\u7f6e\uff1f")},minWin:function(){game.module.hide(game.ME.ChatPrivate),this.dpt(game.ChatEvts.SHOW_TIPS,{isShow:!0})},min_btn:function(){this.minWin()}}),t=game.Sender.extends({sendPrivateChatRequest:function(e,t,a){var i=game.pb.ChatRequest,n=game.pb.ChatContentProto;n.chatType=game.ChatChannelType.PRIVATE,n.content=e,i.targetRoleId=t,i.chatContent=n,i.targetName=a,b8e.NetSender.getBytes().writeProtobuf(i),b8e.sendN(game.protoId.ChatReq)},sendHistoryChatRequest:function(){b8e.sendN(game.protoId.HistoryChatReq)},sendRoleOnLineReqquest:function(e){var t=game.pb.QryRoleOnlineRequest;t.roleIds=e,b8e.NetSender.getBytes().writeProtobuf(t),b8e.sendN(game.protoId.QryRoleOnlineReq)}});b8e.module.registerControl(game.ME.ChatPrivate,e,game.ChatEvts,t)}(),function(){var e;e=b8e.Enum({ALL:0,WORLD:1,CROSS:2,GUILD:3,PRIVATE:4,SYSTEM:5,Clash:6,CSARROW:7}),b8e.RC("$$game","$$ChatChannelType",e)}(),function(){var e;e=b8e.Enum({MAIN:1,PRIVATE:2,MAIN2:3}),b8e.RC("$$game","$$ChatEmotionType",e)}(),function(){var e;e=b8e.Enum({CHAT_FUNC_NONE:0,CHAT_FUNC_PET_SHOW:1,CHAT_FUNC_TEAM:2,CHAT_FUNC_HELP:3,CHAT_FUNC_MASTER:4,CHAT_FUNC_CREATE_GUILD:5,CHAT_FUNC_FOSTER_ADVANCE:6,CHAT_FUNC_FOSTER_AWAKEN:7,CHAT_FUNC_GUILD_RECRUITMENT:8,CHAT_FUNC_ESCORT:9,CHAT_FUNC_ESCORT_REVENGE:10,CHAT_FUNC_XUNBAO:11,CHAT_FUNC_ARENA:12,CHAT_FUNC_TEAM_RECRUIT:13,CHAT_FUNC_CSBOSS_KILL:14,CHAT_FUNC_CSBOSS_SHIELD:15,CHAT_FUNC_GUANDU_AWARD:16,CHAT_FUNC_THRONE_AWARD:17,CHAT_FUNC_FIGHT_PET:18,CHAT_FUNC_GOD_ARMY:20,CHAT_FUNC_CROSS_ARENA:21,CHAT_FUNC_ARROW_GET:22,CHAT_FUNC_RECHARGE_NORMAL:31,CHAT_FUNC_RECHARGE_SALE:32,CHAT_FUNC_RECHARGE_CHOOSE:33,CHAT_FUNC_RECHARGE_TIMELIMIT:34,CHAT_FUNC_RECHARGE_DAILY:35,CHAT_FUNC_RECHARGE_DISCOUNT:36,CHAT_FUNC_RECHARGE_FIRST:37,CHAT_FUNC_RECHARGE_ACCU:38,CHAT_FUNC_RECHARGE_ZERO:39,CHAT_FUNC_FUND:40,CHAT_FUNC_INVESTOR_PLAN:41,CHAT_FUNC_CS_GUILD_FIGHT:42,CHAT_FUNC_CS_GUILD_KILL:43,CHAT_FUNC_CS_GUILD_OPEN:44,CHAT_FUNC_GUILD_WAR_BOSS:45,CHAT_FUNC_GUILD_WAR_TOWER:46,CHAT_FUNC_JIGSAW_GUILD_HELP:47,CHAT_FUNC_TREASURE_KILLBOSS:48,CHAT_FUNC_TREASURE_BOX:49,CHAT_FUNC_USE_ITEM1:51,CHAT_FUNC_OVERLORD_KILL3:52,CHAT_FUNC_OVERLORD_KILL5:53,CHAT_FUNC_OVERLORD_KILL7:54,CHAT_FUNC_OVERLORD_KILL10:55,CHAT_FUNC_OVERLORD_TERMINATED:56,CHAT_FUNC_OVERLORD_R16:57,CHAT_FUNC_OVERLORD_OPEN:58,CHAT_FUNC_OVERLORD_PROMOTION:59,CHAT_FUNC_OVERLORD_CHAMPION:60,CHAT_FUNC_CS_FESTIVAL_BOSS:61,CHAT_FUNC_CS_FESTIVAL_BOSS_KILL:62,CHAT_GUILD_BOSS1_OPEN:63,CHAT_GUILD_BOSS2_OPEN:64,CHAT_FUNC_FESTIVAL_BOSS:104,CHAT_FUNC_EQUIP:110,CHAT_FUNC_SUMMON:111,CHAT_FUNC_SHELL:112,CHAT_FUNC_HUNTING:113,CHAT_MAIN_INT:115,CHAT_ZHANJIANG:116,CHAT_FIRST_RECHARGE:117,CHAT_CARD_MONTH:118,CHAT_CARD_FOREVER:119,CHAT_PRIVILEGE_BATTLE:120,CHAT_PARTNER_STAR:121,CHAT_FUNC_MIBAO:122,CHAT_CLASH_GLOBAL:123,CHAT_CLASH_OCCUPIED:124,CHAT_CLASH_LOST_EXCLUSIVE:125,CHAT_CLASH_LOST_OCCUPIED:126,CHAT_CLASH_BATTLE_WIN:127,CHAT_CLASH_BATTLE_LOSS:128,CHAT_CLASH_GATHER_GLOBAL:129,CHAT_CLASH_GATHER_GUILD:130,CHAT_FUNC_DIANWEI:80,CHAT_FUNC_WILD_BOSS:100,CHAT_FUNC_QUANMIN_BOSS:101,CHAT_FUNC_WILD_AWARD:102,CHAT_FUNC_SHENJIANG:103,CHAT_FUNC_CS_ARROW:105,CHAT_FUNC_GOD_HEAD:108,CHAT_FUNC_HUNLU:109,CHAT_FUNC_JIANGHUN_BOSS:106,CHAT_FUNC_GD_HOLD_FIGHT:200,CHAT_FUNC_GD_HOLD_BLOOD:201,CHAT_FUNC_GD_HOLD_FLAG:202,CHAT_FUNC_GD_CHALLENGE_WIN:203,CHAT_FUNC_GD_CHALLENGE_LOST:204,CHAT_FUNC_GD_BE_CHALLENGE_WIN:205,CHAT_FUNC_GD_BE_CHALLENGE_LOST:206,CHAT_FUNC_GD_OPEN:207,CHAT_FUNC_MARQUEE:998,CHAT_FUNC_DANGER_AREA:999,CHAT_FUNC_THRONE:1e3,CHAT_FUNC_CS_WAR:1001,CHAT_FUNC_MASTER_FAKE:1002,CHAT_FUNC_TIPS:1003,CHAT_FUNC_GUILD_WAR:1004,CHAT_FUNC_TREASURE:1005}),b8e.RC("$$game","$$ChatFuncType",e)}(),function(){var e=b8e.Object.extends({MOVE_TOP_DIST:80,scrollViewH1:90,scrollViewH2:80,ALL_MAX:50,WORLD_GUILD_MAX:30,PRIVATE_MAX:50,curEmotionType:game.ChatEmotionType.MAIN,allChatInfos:null,worldChatInfos:null,guildChatInfos:null,clashChatInfos:null,selectChannelType:game.ChatChannelType.ALL,privateHeadInfoMap:null,privateChatMap:null,lastPrivateChatTimeMap:null,selectPriChatRoleId:0,lastSendTimeMap:null,chatCDMap:null,quickChatInfos:null,isSetQuickContent:!1,playerInfo:null,cacheChatArr:null,hasPrivHistory:!1,isOpenChat:!1,TEMP_MAX:10,chatTempList:null,unReadNum:0,worldWarNewsArr:null,ctor:function(){var e=this;e.allChatInfos=[],e.worldChatInfos=[],e.guildChatInfos=[],e.clashChatInfos=[],e.worldWarNewsArr=[],e.privateHeadInfoMap=b8e.HashMap.get(),e.privateChatMap=b8e.HashMap.get(),e.lastPrivateChatTimeMap=b8e.HashMap.get(),e.lastSendTimeMap=b8e.HashMap.get(),e.lastSendTimeMap.set(game.ChatChannelType.ALL,0),e.lastSendTimeMap.set(game.ChatChannelType.WORLD,0),e.lastSendTimeMap.set(game.ChatChannelType.GUILD,0),e.lastSendTimeMap.set(game.ChatChannelType.Clash,0),e.chatCDMap=b8e.HashMap.get(),e.quickChatInfos=[],e.cacheChatArr=[],e.chatTempList=[]},getQuickChatContentArr:function(){if(!this.isSetQuickContent){var e=game.ChatContentCfg.getDatas();if(e&&0<e.length)for(var t=1,a=e.length;t<=a;t++){var i=game.ChatContentCfg.getData(t);if(i){var n=new game.ChatQuickItemInfo;n.setData(i),this.quickChatInfos.push(n)}}this.isSetQuickContent=!0}return this.quickChatInfos},getRandomChatCfg:function(){var e=game.ChatContentCfg.getDatas();if(!e)return null;var t=e.length;return e[Math.floor(Math.random()*t)]},getLastSendTimeByChannel:function(e){if(!this.lastSendTimeMap){return 0}var t=e===game.ChatChannelType.ALL?game.ChatChannelType.WORLD:e,a=this.lastSendTimeMap.get(t);return a||0},setLastSendTimeByChannel:function(e,t){if(this.lastSendTimeMap){var a=e===game.ChatChannelType.ALL?game.ChatChannelType.WORLD:e;return this.lastSendTimeMap.set(a,t)}},getChannelChatCD:function(e){if(!this.chatCDMap){return 5e3}var t=e===game.ChatChannelType.ALL?game.ChatChannelType.WORLD:e,a=this.chatCDMap.get(t);if(!a){var i=game.ChatCfg.getData(t);if(!i){return b8e.warn(t," \u5f53\u524d\u804a\u5929\u9891\u9053\u914d\u7f6e\u4e0d\u5b58\u5728"),5e3}a=1e3*i.interval,this.chatCDMap.set(t,a)}return a},getChatListByChannelType:function(e){var t=null;switch(e){case game.ChatChannelType.WORLD:t=this.worldChatInfos;break;case game.ChatChannelType.GUILD:t=this.guildChatInfos;break;case game.ChatChannelType.Clash:t=this.clashChatInfos;break;default:t=this.allChatInfos}return t},cleanAllMainChatData:function(){this.allChatInfos.length=0,this.worldChatInfos.length=0,this.guildChatInfos.length=0,this.clashChatInfos.length=0},clearChatDataByChannel:function(e){switch(e){case game.ChatChannelType.WORLD:this.worldChatInfos.length=0;break;case game.ChatChannelType.GUILD:this.guildChatInfos.length=0;break;case game.ChatChannelType.Clash:this.clashChatInfos.length=0}},cleanAllData:function(){this.allChatInfos.length=0,this.worldChatInfos.length=0,this.guildChatInfos.length=0,this.privateChatMap.length=0},addChat:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i=this,n=null,s=e.chatType;switch(s){case game.ChatChannelType.SYSTEM:break;case game.ChatChannelType.CROSS:case game.ChatChannelType.CSARROW:case game.ChatChannelType.WORLD:if(!i.worldChatInfos){this.worldChatInfos=[]}n=i.worldChatInfos;break;case game.ChatChannelType.GUILD:if(!i.guildChatInfos){this.guildChatInfos=[]}n=i.guildChatInfos;break;case game.ChatChannelType.Clash:if(!i.clashChatInfos){this.clashChatInfos=[]}n=i.clashChatInfos;break;default:return void b8e.warn("\u672a\u6709\u8be5\u7c7b\u578b\u7684\u9891\u9053type: ",s)}var o=null;if(i.needCache(e)&&a){this.cacheChatArr.push(e)}else if(i.checkShowChatInfo(e)){n&&((o=n.length>=i.WORLD_GUILD_MAX?n.shift():game.ChatItemInfo.get()).setData(e),n.push(o));var r=null;if(!i.allChatInfos){this.allChatInfos=[]}if(i.allChatInfos.length>=i.ALL_MAX){r=this.allChatInfos.shift()}else r=game.ChatItemInfo.get();r.setData(e),i.allChatInfos.push(r),i.chatTempList.length>=i.TEMP_MAX&&i.chatTempList.shift(),i.chatTempList.push(r)}else;},needCache:function(e){var t=game.pb.ChatFuncType;switch(e.funcType){case t.CHAT_FUNC_ARENA:case t.CHAT_FUNC_DIANWEI:case t.CHAT_FUNC_FESTIVAL_BOSS:return!0;default:return!1}},processCacheChat:function(e){var t=!1;switch(e.type){case game.InstanceType.ARENA:case game.InstanceType.DIANWEI:t=!0}if(t){var a=this.cacheChatArr.shift();if(a){this.addChat(a,!1)}}else;},checkShowChatInfo:function(){return!0},addPriChatHead:function(e,t,a,i){if(!this.privateHeadInfoMap){this.privateHeadInfoMap=b8e.HashMap.get()}var n=this.privateHeadInfoMap.get(e);if(!n){n=new game.PrivateHeadItemInfo,this.privateHeadInfoMap.set(e,n),n.setData(e,t,a,i)}if(this.selectPriChatRoleId!==e){n.unRead=!0}n.headInfo=game.SysTime.curTime},getHeadInfoById:function(e){return this.privateHeadInfoMap.get(e)},delPriChatHeadById:function(e){if(this.privateHeadInfoMap){var t=this.privateHeadInfoMap.get(e);if(t){if(!0===t.isSelect){this.selectPriChatRoleId=0}this.privateHeadInfoMap.del(e)}else;}else;},updateOnlineState:function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){var a=e[t];if(a){var i=a.roleId,n=a.isOnline;this.updateRoleHeadInfoOnlineState(i,n)}else;}},updateRoleHeadInfoOnlineState:function(e,t){if(this.privateHeadInfoMap){var a=this.privateHeadInfoMap.get(e);if(a)a.isOnline=t;else;}else;},hasRoleChatHeadInfo:function(e){if(!this.privateHeadInfoMap){return!1}if(this.privateHeadInfoMap.get(e))return!0;return!1},selectPriChatRole:function(a){if(this.privateHeadInfoMap){var i=this;this.privateHeadInfoMap.forEach(function(e,t){if(t){if(t.isSelect=t.roleId===a,t.isSelect){i.selectPriChatRoleId=t.roleId,t.unRead=!1}}},this)}else;},getSortedHeadArr:function(){return this.getChatHeadArr().sort(this.sortHead)},sortHead:function(e,t){if(e.unRead&&!t.unRead){return-1}if(!e.unRead&&t.unRead){return 1}if(e.lastTime>t.lastTime){return-1}if(e.lastTime<t.lastTime){return 1}return 0},getChatHeadArr:function(){if(this.privateHeadInfoMap)return this.privateHeadInfoMap.values()},getChatHeadIdArr:function(){if(this.privateHeadInfoMap)return this.privateHeadInfoMap.keys();return[]},addPriChat:function(e){if(!this.privateChatMap){this.privateChatMap=b8e.HashMap.get()}var t=null,a=e.roleId;if(a===game.mainRoleData.id){a=e.targetRoleId}else this.addPriChatHead(a,e.roleName,e.isMale,e.level);if(this.privateChatMap.has(a))t=this.privateChatMap.get(a);else{t=[],this.privateChatMap.set(a,t)}if(!t){t=[],this.privateChatMap.set(a,t)}var i=null;if(t.length>=this.PRIVATE_MAX){i=t.shift()}else i=new game.PrivateChatItemInfo;i.setData(e.roleId,e.content,e.roleName,e.isMale,e.vipLevel,e.targetRoleId,e.level),t.push(i),this.setRoleLastPrivateChatTime(a)},addHistoryPriChat:function(e,t,a,i,n,s){if(!this.privateChatMap){this.privateChatMap=b8e.HashMap.get()}var o=null;if(this.privateChatMap.has(e))o=this.privateChatMap.get(e);else{o=[],this.privateChatMap.set(e,o)}if(!o){o=[],this.privateChatMap.set(e,o)}var r=null;if(o.length>=this.PRIVATE_MAX){r=o.shift()}else r=new game.PrivateChatItemInfo;var g=game.mainRoleData.id;r.setData(e,t,a,i,n,g,s),o.push(r),this.addPriChatHead(e,a,i,s)},getPriChatList:function(e){if(!this.privateChatMap){this.privateChatMap=b8e.HashMap.get()}if(this.privateChatMap.has(e))return this.privateChatMap.get(e);return[]},getRoleLastPrivateChatTime:function(e){if(!this.lastPrivateChatTimeMap){this.lastPrivateChatTimeMap=b8e.HashMap.get()}var t=this.lastPrivateChatTimeMap.get(e);if(!t){this.lastPrivateChatTimeMap.set(e,0),t=0}return t},setRoleLastPrivateChatTime:function(e){if(!this.lastPrivateChatTimeMap){this.lastPrivateChatTimeMap=b8e.HashMap.get()}var t=game.SysTime.curTime;this.lastPrivateChatTimeMap.set(e,t)},setPlayerInfoId:function(e){if(!this.playerInfo){this.playerInfo=new game.ChatPlayerInfo}this.playerInfo.roleId=e},updatePlayerInfo:function(e){if(!this.playerInfo){this.playerInfo=new game.ChatPlayerInfo}this.playerInfo.setData(e)},setWorldWarNewsData:function(e){var t=game.InstanceMiscCfg.getData("worldwarMaxNews");if(t){var a=t.value,i={};i.teamId=e.teamid,i.instId=e.insid,this.checkWorldWarNews(e)||(i.teamType=game.TeamInstType.WORLDWAR_TEAM,this.worldWarNewsArr.length>=a&&this.worldWarNewsArr.pop(),this.worldWarNewsArr.push(i))}},checkWorldWarNews:function(e){var t=this.worldWarNewsArr.length;if(t<1)return!1;for(var a=0;a<t;a++){if(this.worldWarNewsArr[a].teamId==e.teamid)return!0}return!1}});game.chatData=game.chatData||new e}(),function(){var t=void 0;t=b8e.PoolObject.extends({refresh:0,ctor:function(){var e=this;e._super(),e.chatChannelType=null,e.contentStr="",e.quickContent="",e.zoneId=0,e.roleId=0,e.name="",e.isMale=!1,e.vipLv=0,e.level=0,e.timeStamp=0},setData:function(e){var t=this;if(t.chatChannelType=e.chatType,t.contentStr=e.content,e.textId&&0<e.textId){var a=game.ChatContentCfg.getData(e.textId);if(a)t.contentStr=a.content;else{b8e.warn("\u5feb\u901f\u804a\u5929id",e.textId,"\u4e0d\u5b58\u5728"),t.contentStr=""}}t.contentStr&&(t.contentStr=t.contentStr.replace(/[0-9]{6,}/g,"*")),t.quickContent=e.textId,t.zoneId=e.zone,t.roleId=e.roleId,t.name=e.roleName,t.isMale=e.isMale,t.vipLv=e.vipLevel,t.level=e.level,t.funcType=e.funcType,t.godArmy=e.godArmy,t.teamId=e.teamid,t.instId=e.insid,t.fosterType=e.fosterType,t.fosterLv=e.fosterLv,t.guildId=e.guildId,t.guildName=e.guildName,t.equip=e.equip,t.hunluIdx=e.hunluIdx,t.hunluItemId=e.hunluItemId,t.params=e.params?e.params.split("|"):[],t.marqueeKey=e.marqueeKey,t.clientParams=e.clientParams,t.chatChannelType==game.ChatChannelType.WORLD&&t.funcType==game.ChatFuncType.CHAT_FUNC_NONE&&t.roleId?t.__renderType=t.roleId===game.mainRoleData.id?0:1:t.__renderType=2,t.refresh++},setDataByInfo:function(e){var t=this;t.chatChannelType=e.chatChannelType,t.contentStr=e.contentStr,t.quickContent=e.quickContent,t.zoneId=e.zoneId,t.roleId=e.roleId,t.name=e.name,t.isMale=e.isMale,t.vipLv=e.vipLv,t.level=e.level,t.funcType=e.funcType,t.godArmy=e.godArmy,t.teamId=e.teamId,t.instId=e.instId,t.fosterType=e.fosterType,t.fosterLv=e.fosterLv,t.guildId=e.guildId,t.guildName=e.guildName,t.equip=e.equip,t.params=e.params,t.marqueeKey=e.marqueeKey,t.clientParams=e.clientParams,t.hunluIdx=e.hunluIdx,t.hunluItemId=e.hunluItemId,t.chatChannelType==game.ChatChannelType.WORLD&&t.roleId?t.__renderType=t.roleId===game.mainRoleData.id?0:1:t.__renderType=2,t.refresh=e.refresh},clearData:function(){var e=this;e.chatChannelType=0,e.contentStr="",e.quickContent="",e.zoneId=0,e.roleId=0,e.name="",e.isMale=!1,e.vipLv=0,e.level=0,e.funcType=0,e.godArmy=null,e.teamId=0,e.instId=0,e.fosterType=0,e.fosterLv=0,e.guildId=0,e.guildName="",e.params=null,e.marqueeKey=0,e.clientParams=null,e.__renderType=0},recycle:function(){this.reset(),this._super()},reset:function(){this.clearData()}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,1024),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$ChatItemInfo",t)}(),function(){var e;e=b8e.Object.extends({roleId:0,power:0,name:"",isMale:!1,lv:0,guildName:"",cpName:"",vipCardType:0,relation:0,vipLv:0,timeStamp:0,lookSlot:0,ctor:function(){this._super()},setData:function(e){var t=this;e&&(t.name=e.roleName,t.lv=e.roleLevel,t.vipLv=e.vipLevel,t.power=e.power,t.isMale=e.isMale,t.cpName=e.mateName,t.guildName=e.guildName,t.fashion=e.fashion,t.nickname=e.nickname,t.fosters=e.fosters,t.partners=e.partners,t.shenqi=e.shenqi,t.formation=e.formation,t.quality=e.quality,t.partners&&0<t.partners.length&&t.partners.sort(t.onSort))},getPartnerInfoList:function(){var e=this.partnerInfoList;this.clearList(e),e=e||(this.partnerInfoList=[]);var t=this.partners;if(!t||t.length<1)return null;for(var a=this.partners.length,i=void 0,n=0;n<a;n++)(i=game.ChatPlayerPartnerInfo.get()).setData(t[n]),i.isMainRole&&(i.quality=this.quality),e[n]=i;return e},getPartnerInfoBySlot:function(e){var t=this.getPartnerBySlot(e);if(!t)return null;var a=this.tempPartnerInfo;return(a=a||(this.tempPartnerInfo=game.ChatPlayerPartnerInfo.get())).setData(t),a.isMainRole&&(a.quality=this.quality),a},getMainRoleInfo:function(){var e=this.getPartnerBySlot(1);if(!e)return null;var t=this.mainRoleInfo;return(t=t||(this.mainRoleInfo=game.ChatPlayerPartnerInfo.get())).setData(e),t.isMainRole&&(t.quality=this.quality),t},getPartnerBySlot:function(e){var t=this.partners;if(!t||t.length<1)return null;for(var a=void 0,i=t.length,n=0;n<i;n++)if((a=t[n]).slot==e)return a;return null},onSort:function(e,t){return e.slot-t.slot},getFosterInfoList:function(){var e=this,t=e.fosterInfoList;e.shenqiInfo=null,e.formationInfo=null,e.zhanjiInfo=null,e.clearList(t),t=t||(e.fosterInfoList=[]);var a=e.fosters;if(a&&0<a.length){for(var i=e.fosters.length,n=void 0,s=0;s<i;s++)(n=t[s]=game.ChatPlayerFosterInfo.get()).setFosterData(a[s]),n.type==game.NewFosterType.ZHANJI&&(e.zhanjiInfo=n);t.sort(e.onTypeSort)}var o=e.shenqi;if(o&&0<o.id){var r=e.shenqiInfo=game.ChatPlayerFosterInfo.get();r.setShenqiData(o),t[t.length]=r}var g=e.formation;if(g&&0<g.id){var l=e.formationInfo=game.ChatPlayerFosterInfo.get();l.setFormationData(g),t[t.length]=l}return t},onTypeSort:function(e,t){return e.type-t.type},getCurLookInfo:function(){return this.getPartnerInfoBySlot(this.lookSlot)},getShenQiSkill:function(){var e=this.shenqiInfo;if(!e)return 0;var t=game.shenQiData.getObj(e.id,e.lv),a=game.ShenQiUpgradeCfg.getData(t);return a?a.skill:0},getZhanjiSkill:function(){var e=this.zhanjiInfo;if(!e)return 0;var t=game.fosterData.getFosterUpStarCfg(e.type,e.id,e.star);return t?t.skill:0},clearList:function(e){if(e&&!(e.length<1)){for(var t=e.length,a=0;a<t;a++)e[a].release();e.length=0}},clear:function(){this.roleId=0,this.name="",this.lv=0,this.vipLv=0,this.power=0,this.isMale=0,this.guildName="",this.cpName=""}}),b8e.RC("$$game","$$ChatPlayerInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,contentStr:"",width:535,ctor:function(){this._super()},setData:function(e){this.id=e.id,this.contentStr=e.content,this.updateWidth()},updateWidth:function(e){this.width=1==e?487:b8e.stageWidth-191}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ChatQuickItemInfo",e)}(),function(){var e;e=b8e.Object.extends({contentStr:"",roleId:0,name:"",isMale:!1,vipLv:0,lv:0,isShowTime:!1,curTimeMin:"",targetRoleId:0,__renderType:0,ctor:function(){this._super()},setData:function(e,t,a,i,n,s,o){var r=this;r.contentStr=t,r.contentStr=r.contentStr.replace(/[0-9]{6,}/g,"*"),r.roleId=e,r.lv=o;var g=0;if(e===game.mainRoleData.id){this.__renderType=0,g=game.chatData.getRoleLastPrivateChatTime(s)}else r.__renderType=1,r.roleId=game.mainRoleData.id,g=game.chatData.getRoleLastPrivateChatTime(r.roleId);r.name=a,r.isMale=i,r.vipLv=n;var l=game.SysTime.curTime;if(r.isShowTime=3e5<l-g,!r.isShowTime){if((b8e.TimeUtil.getDay(g)+1)%6===b8e.TimeUtil.getDay(l)){this.isShowTime=!0}}if(r.isShowTime){var c=new Date(l),h=(c.getHours()<10?"0"+c.getHours():c.getHours())+" : ",m=c.getMinutes()<10?"0"+c.getMinutes():c.getMinutes();this.curTimeMin=h+m}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PrivateChatItemInfo",e)}(),function(){var e;e=b8e.Object.extends({roleId:0,name:"",isMale:!1,lv:0,vipLv:0,isOnline:!1,isSelect:!1,unRead:!0,lastTime:0,ctor:function(){this._super()},setData:function(e,t,a,i){this.roleId=e,this.name=t,this.isMale=a,this.lv=i,this.isSelect=!1,this.isOnline=!1,this.unRead=!0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PrivateHeadItemInfo",e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(e){e=e||1217,this._super(e),this.setSize(b8e.stageWidth-150,23)},init:function(){this.skin.ChatItem.touchEffectDisabled=!0},ChatItem:function(){game.module.show(game.ME.ChatView)},name_btn:function(e){var t=this;if(t&&t.data&&t.data&&t.data.roleId){var a=game.sceneData.getSceneType();a!=game.SceneType.CS_ARROW&&a!=game.SceneType.CSWAR&&a!=game.SceneType.GUANDU_MAP&&a!=game.SceneType.THRONE&&a!=game.SceneType.CS_BOSS&&a!=game.SceneType.CS_GUILD_WAR_LY&&a!=game.SceneType.CS_GUILD_WAR_HG&&a!=game.SceneType.CS_GUILD_WAR_LD&&a!=game.SceneType.TREASURE&&a!=game.SceneType.GUILD_CONFLICT&&t.data.funcType!=game.ChatFuncType.CHAT_FUNC_CSBOSS_KILL&&t.data.funcType!=game.ChatFuncType.CHAT_FUNC_CSBOSS_SHIELD&&t.data.roleId!==game.mainRoleData.id&&(e&&e.stopPropagation(),t.dptG(game.ChatEvts.SHOW_PLAYER,t.data.roleId))}},setMaxWidth:function(){this.skin&&(this.skin.lab_content._richText.maxWidth=b8e.stageWidth-150)},setData:function(){var e=this;if(e.data){e.cancelClickFunc(e.skin.lab_content,e.clickFunc),e.setMaxWidth();var t=e.data,a=game.ChatFuncType;switch(t.funcType){case a.CHAT_FUNC_NONE:e.normalChat();break;case a.CHAT_FUNC_TEAM:e.teamChat();break;case a.CHAT_FUNC_HELP:e.helpChat();break;case a.CHAT_FUNC_MASTER:e.masterChat();break;case a.CHAT_FUNC_CREATE_GUILD:e.createGuildChat();break;case a.CHAT_FUNC_GUILD_RECRUITMENT:e.guildRecruitment();break;case a.CHAT_FUNC_WILD_BOSS:e.wildBossChat();break;case a.CHAT_FUNC_WILD_AWARD:e.wildBossAwardChat();break;case a.CHAT_FUNC_ESCORT:e.escortChat();break;case a.CHAT_FUNC_ESCORT_REVENGE:e.escortRevengeChat();break;case a.CHAT_FUNC_XUNBAO:e.xunbaoChat();break;case a.CHAT_GUILD_BOSS2_OPEN:e.bossOpen();break;case a.CHAT_FUNC_ARENA:e.arenaChat();break;case a.CHAT_FUNC_DIANWEI:e.dianweiChat();break;case a.CHAT_FUNC_QUANMIN_BOSS:e.publicBossChat();break;case game.pb.ChatFuncType.CHAT_FUNC_MARQUEE:e.marqueeChat();break;case a.CHAT_FUNC_CS_WAR:case a.CHAT_FUNC_THRONE:case a.CHAT_FUNC_TREASURE:e.csWarChat();break;case a.CHAT_FUNC_GUILD_WAR:e.csGuildWarChat();break;case a.CHAT_FUNC_GUILD_WAR_BOSS:e.guildWarBossDie();break;case a.CHAT_FUNC_GUILD_WAR_TOWER:e.guildWarYuxi();break;case a.CHAT_FUNC_TEAM_RECRUIT:e.csWarRecruitChat();break;case a.CHAT_FUNC_SHENJIANG:e.petTurnChat();break;case a.CHAT_FUNC_CSBOSS_KILL:e.csBossKillChat();break;case a.CHAT_FUNC_CSBOSS_SHIELD:e.csBossShield();break;case a.CHAT_FUNC_DANGER_AREA:e.dangerAreaChar();break;case a.CHAT_FUNC_GUANDU_AWARD:e.guanduAward();break;case a.CHAT_FUNC_TREASURE_KILLBOSS:e.csTreasureKillBoss();break;case a.CHAT_FUNC_TREASURE_BOX:e.csTreasureBox();break;case a.CHAT_FUNC_GD_HOLD_FIGHT:e.guanduHoldFight();break;case a.CHAT_FUNC_GD_HOLD_BLOOD:e.guanduHoldBlood();break;case a.CHAT_FUNC_GD_HOLD_FLAG:e.guanduHoldFlag();break;case a.CHAT_FUNC_GD_CHALLENGE_WIN:e.guanduChallengeWin();break;case a.CHAT_FUNC_GD_CHALLENGE_LOST:e.guanduChallengeLost();break;case a.CHAT_FUNC_GD_BE_CHALLENGE_WIN:e.guanduBeChallengeWin();break;case a.CHAT_FUNC_GD_BE_CHALLENGE_LOST:e.guanduBeChallengeLost();break;case a.CHAT_FUNC_GD_OPEN:e.guanduOpen();break;case a.CHAT_FUNC_THRONE_AWARD:e.throneSarSurpriseChat();break;case a.CHAT_FUNC_CS_ARROW:e.csarrowOpenChat();break;case a.CHAT_FUNC_HUNLU:e.hunluChat();break;case a.CHAT_FUNC_MASTER_FAKE:e.fakeMaster();break;case a.CHAT_FUNC_CROSS_ARENA:e.csArenaChat();break;case a.CHAT_FUNC_ARROW_GET:e.csArrowChat();break;case a.CHAT_FUNC_RECHARGE_SALE:case a.CHAT_FUNC_RECHARGE_CHOOSE:case a.CHAT_FUNC_RECHARGE_TIMELIMIT:case a.CHAT_FUNC_RECHARGE_DAILY:case a.CHAT_FUNC_RECHARGE_DISCOUNT:case a.CHAT_FUNC_RECHARGE_FIRST:case a.CHAT_FUNC_RECHARGE_ACCU:case a.CHAT_FUNC_RECHARGE_ZERO:case a.CHAT_FUNC_FUND:case a.CHAT_FUNC_INVESTOR_PLAN:e.recharegeChat(t.funcType);break;case a.CHAT_FUNC_USE_ITEM1:e.giftChat();break;case a.CHAT_FUNC_TIPS:e.tipsChat();break;case a.CHAT_FUNC_CS_GUILD_OPEN:e.guildChatOpen();break;case a.CHAT_FUNC_CS_GUILD_FIGHT:e.guildChatFight();break;case a.CHAT_FUNC_CS_GUILD_KILL:e.guildChatKill();break;case a.CHAT_FUNC_JIGSAW_GUILD_HELP:e.puzzleChatHelp();break;case a.CHAT_FUNC_OVERLORD_KILL3:case a.CHAT_FUNC_OVERLORD_KILL5:case a.CHAT_FUNC_OVERLORD_KILL7:case a.CHAT_FUNC_OVERLORD_KILL10:case a.CHAT_FUNC_OVERLORD_TERMINATED:case a.CHAT_FUNC_OVERLORD_R16:case a.CHAT_FUNC_OVERLORD_OPEN:case a.CHAT_FUNC_OVERLORD_PROMOTION:case a.CHAT_FUNC_OVERLORD_CHAMPION:e.overlordMatch();break;case a.CHAT_FUNC_CS_FESTIVAL_BOSS:e.csFestivalBossOpen();break;case a.CHAT_FUNC_CS_FESTIVAL_BOSS_KILL:e.csFestivalKillBoss();break;case a.CHAT_FUNC_EQUIP:e.showPartnerEquip();break;case a.CHAT_FUNC_SUMMON:e.showSummon();break;case a.CHAT_FUNC_SHELL:e.shellChat();break;case a.CHAT_FUNC_HUNTING:e.huntingChat();break;case a.CHAT_MAIN_INT:e.mainIntChat();break;case a.CHAT_ZHANJIANG:e.zhanjiangChat();break;case a.CHAT_FIRST_RECHARGE:e.firstRechargeChat();break;case a.CHAT_CARD_MONTH:e.monthChat();break;case a.CHAT_CARD_FOREVER:e.cardForeverChat();break;case a.CHAT_PRIVILEGE_BATTLE:e.privilegeBattleChat();break;case a.CHAT_PARTNER_STAR:e.partnerStarChat();break;case a.CHAT_CLASH_GLOBAL:e.guildClashGlobl();break;case a.CHAT_CLASH_OCCUPIED:e.guildClashOccupied();break;case a.CHAT_CLASH_LOST_EXCLUSIVE:e.guildClashLostExclusive();break;case a.CHAT_CLASH_LOST_OCCUPIED:e.guildClashLostOccupied();break;case a.CHAT_CLASH_BATTLE_WIN:e.guildClashBattleWin();break;case a.CHAT_CLASH_BATTLE_LOSS:e.guildClashBattleLoss();break;case a.CHAT_CLASH_GATHER_GLOBAL:e.guildClashGatherGolbal();break;case a.CHAT_CLASH_GATHER_GUILD:e.guildClashGatherGuild();case a.CHAT_FUNC_MIBAO:e.mibaoChat()}b8e.hasTimeout(e._resetSize,e)||b8e.setTimeout(e._resetSize,e,300)}else{b8e.error("ChatItemView data is null")}},guildClashGatherGuild:function(){this.guildCommonText("clash_gather_guild")},guildClashGatherGolbal:function(){var e=this.data,t=e.params[0],a=+e.params[1],i=+e.params[2],n=game.guildConflictData.getCityInfoById(i);if(n){var s=game.HtmlUtil.getColorByQuality(n.cfg.quality),o=game.HtmlUtil.getColorByQuality(a),r=n.cfg.name,g=game.HtmlUtil.getText(o,t),l=game.HtmlUtil.getText(s,r),c=game.MarqueeLang.getLang("clash_gather_global",[g,l]);this.skin.lab_content.string=c}},guildClashBattleLoss:function(){var e=this.data,t=e.params[0],a=e.params[1],i=+e.params[2],n=game.guildConflictData.getCityInfoById(i);if(n){var s=game.HtmlUtil.getColorByQuality(n.cfg.quality),o=n.cfg.name,r=game.HtmlUtil.getText(s,o),g=game.MarqueeLang.getLang("clash_battle_loss",[t,r,a]);this.skin.lab_content.string=g}},guildClashBattleWin:function(){var e=this.data,t=e.params[0],a=e.params[1],i=+e.params[2],n=game.guildConflictData.getCityInfoById(i);if(n){var s=game.HtmlUtil.getColorByQuality(n.cfg.quality),o=n.cfg.name,r=game.HtmlUtil.getText(s,o),g=game.MarqueeLang.getLang("clash_battle_win",[t,r,a]);this.skin.lab_content.string=g}},guildClashLostOccupied:function(){this.guildCommonText("clash_lost_exclusive")},guildClashLostExclusive:function(){this.guildCommonText("clash_lost_occupied")},guildClashOccupied:function(){this.guildCommonText("clash_occupied")},guildClashGlobl:function(){this.guildCommonText("clash_global")},guildCommonText:function(e){var t=this.data,a=t.params[0],i=+t.params[1],n=game.guildConflictData.getCityInfoById(i);if(n){var s=game.HtmlUtil.getColorByQuality(n.cfg.quality),o=n.cfg.name,r=game.HtmlUtil.getText(s,o),g=e,l=game.MarqueeLang.getLang(g,[a,r]);this.skin.lab_content.string=l}},_resetSize:function(){var e=this.skin.lab_content.getTextHeight();this.setSize(b8e.stageWidth-150,e),this.layout()},fakeMaster:function(){var e=this.data,t=(e.name,e.params),a=game.MarqueeLang.getLang(e.marqueeKey,t);this.skin.lab_content.string=a},getChatChannelStr:function(e){var t=null,a=null;switch(e){case game.ChatChannelType.SYSTEM:case game.ChatChannelType.WORLD:t=game.Lang.get(9005),a=game.Color.YELLOW;break;case game.ChatChannelType.CROSS:t=game.Lang.get(9006),a=game.Color.PURPLE;break;case game.ChatChannelType.GUILD:t=game.Lang.get(9007),a=game.Color.BLUE;break;case game.ChatChannelType.Clash:t=game.Lang.get(53501),a=game.Color.BLUE;break;default:t=game.Lang.get(9008),a=game.Color.RED}return t="["+t+"] ",t=game.HtmlUtil.getText(a,t)},getChatNameStr:function(e,t,a){var i=!(2<arguments.length&&void 0!==a)||a,n=this.data,s=e,o=null;if(n.isMale){o=game.Color.BLUE}else o=game.Color.PURPLE;!game.sceneData.isCsScene()||game.ChatChannelType.CROSS!==n.chatChannelType&&game.ChatChannelType.GUILD!==n.chatChannelType||(s="s."+n.zoneId+" "+s),this.data.roleId!==game.mainRoleData.id&&i&&(s=game.HtmlUtil.getulText(s));e=game.HtmlUtil.getText(o,s);var r=b8e.getNormP("_$clickFunc");return game.HtmlUtil.getClickableText(this,this.skin.lab_content,e,r,this.name_btn,!1)},normalChat:function(){var e=this.data,t=this.getChatChannelStr(e.chatChannelType),a=e.name;a=this.getChatNameStr(a,e.isMale);var i;e.vipLv;i=game.HtmlUtil.getImgText("V")+" ";var n=" :"+e.contentStr,s=game.Color.WHITE;n=game.HtmlUtil.analyzeEmotion(n);var o=t+i+a+(n=game.HtmlUtil.getText(s,n));this.skin.lab_content.string=o,this.addClickFunc(this.skin.lab_content,e.name,this.name_btn,!0)},dangerAreaChar:function(){var e=game.MarqueeLang.getLang("danger_area");this.skin.lab_content.string=e},guanduAward:function(){this._setContent("gd_get_award")},csTreasureKillBoss:function(){this._setContent("cs_treasure_skill_boss")},csTreasureBox:function(){this._setContent("cs_treasure_box")},_setContent:function(e){var t=this.data.name,a=game.MarqueeLang.getLang(e,[t]);this.skin.lab_content.string=a},guanduHoldFight:function(){var e=this.data,t=e.contentStr,a=e.name,i=game.MarqueeLang.getLang("gd_hold_fight",[t,a]);this.skin.lab_content.string=i},guanduHoldBlood:function(){var e=this.data,t=e.contentStr,a=e.name,i=game.MarqueeLang.getLang("gd_hold_blood",[t,a,t]);this.skin.lab_content.string=i},guanduHoldFlag:function(){var e=this.data.contentStr,t=game.MarqueeLang.getLang("gd_hold_flag",[e]);this.skin.lab_content.string=t},guanduChallengeWin:function(){var e=this.data.name,t=game.MarqueeLang.getLang("gd_challenge_win",[e]);this.skin.lab_content.string=t},guanduChallengeLost:function(){this._setContent("gd_challenge_lost")},guanduBeChallengeWin:function(){this._setContent("gd_be_challenge_win")},guanduBeChallengeLost:function(){this._setContent("gd_be_challenge_lost")},guanduOpen:function(){var e=game.MarqueeLang.getLang("gd_open");this.skin.lab_content.string=e},csBossKillChat:function(){var e=this.data,a=e.roleId,i=this.getChatNameStr(e.name,e.isMale,!1);game.MonsterCfg.getDataAsync(a,function(e){if(e){var t=game.MarqueeLang.getLang("cs_boss_kill",["@","@"]);t=game.MarqueeLang.specialReplaceStr(t,[i,e.name]),this.skin.lab_content.string=t}else b8e.error("\u602a\u7269\u4e0d\u5b58\u5728id: ",a)},this)},csBossShield:function(){var e=this.data,t=this.getChatNameStr(e.name,e.isMale,!1),a=game.MarqueeLang.getLang("cs_boss_shield",[t]);this.skin.lab_content.string=a},petTurnChat:function(){var e=this.data,t=e.contentStr,a=parseInt(e.params[0]),i=game.ItemInfoCfg.getData(a),n=e.name,s=game.MarqueeLang.getData("pet_turn"),o=(t=game.MarqueeLang.getLang("pet_turn",[n,game.HtmlUtil.getColorStrByQuality(i.quality,i.name,!0)]),s.linkText),r=b8e.getNormP("_$clickFunc"),g=t+(o=game.HtmlUtil.getClickableText(this,this.skin.lab_content,o,r,this.clickFunc,!1));this.skin.lab_content.string=g,this.addClickFunc(this.skin.lab_content,o,this.clickFunc)},teamChat:function(){var e=this.data,t=e.instId,a=game.TeamInstanceCfg.getData(t);if(a){var i=a.type,n=game.TeamInstType,s="",o=this.getChatNameStr(e.name,e.isMale),r=null;switch(i){case n.CS_TEAM:r=game.MarqueeLang.getData("cs_team"),s=game.MarqueeLang.getLang("cs_team",["@","@"]);break;case n.GUILD_TEAM:r=game.MarqueeLang.getData("guild_war"),s=game.MarqueeLang.getLang("guild_war",["@","@"]);break;case n.WORLDWAR_TEAM:r=game.MarqueeLang.getData("world_war"),s=game.MarqueeLang.getLang("world_war",["@","@"]);break;case n.WORLDWAR2_TEAM:r=game.MarqueeLang.getData("world_war2"),s=game.MarqueeLang.getLang("world_war2",["@","@"]);break;case n.THOUSANDTOWER_TEAM:r=game.MarqueeLang.getData("thousandtower"),s=game.MarqueeLang.getLang("thousandtower",["@","@"])}if(s=game.MarqueeLang.specialReplaceStr(s,[o,a.name]),r){var g=r.linkText,l=b8e.getNormP("_$clickFunc"),c=""+s+(g=game.HtmlUtil.getClickableText(this,this.skin.lab_content,g,l,this.clickFunc,!1));this.skin.lab_content.string=c,this.addClickFunc(this.skin.lab_content,g,this.clickFunc)}else;}else{b8e.error("\u804a\u5929\u516c\u544a\uff0c\u672a\u627e\u5230\u5bf9\u5e94\u7684\u526f\u672cid :",t)}},helpChat:function(){var s=this,e=s.data,o=e.instId,r=(e.roleId,e.contentStr,s.getChatChannelStr(e.chatChannelType)),g=s.getChatNameStr(e.name,e.isMale),l=game.MarqueeLang.getData("req_help");game.InstanceCfg.getDataAsync(o,function(e){if(e){var t=game.MarqueeLang.getLang("req_help",[e.name]),a=l.linkText,i=b8e.getNormP("_$clickFunc");a=game.HtmlUtil.getClickableText(s,s.skin.lab_content,a,i,s.clickFunc,!1);var n=r+g+t+a;s.skin.lab_content.string=n,s.addClickFunc(s.skin.lab_content,a,s.clickFunc)}else b8e.error("\u4e0d\u5b58\u5728\u526f\u672cid: ",o)},s)},masterChat:function(){var e=this.data,t=e.contentStr,a=(this.getChatChannelStr(e.chatChannelType),e.name),i=game.MarqueeLang.getData("req_master"),n=(t=game.MarqueeLang.getLang("req_master",[a]),i.linkText),s=b8e.getNormP("_$clickFunc"),o=t+(n=game.HtmlUtil.getClickableText(this,this.skin.lab_content,n,s,this.clickFunc,!1));this.skin.lab_content.string=o,this.addClickFunc(this.skin.lab_content,n,this.clickFunc)},xunbaoChat:function(){var e=this.data,t=game.Lang.get(9009),a=+e.params[1];if(0<a){var i=game.xunBaoData.getCfgById(a);if(!i)return;t=i.name}var n=+e.params[0],s=game.ItemInfoCfg.getData(n);if(s){var o=game.MarqueeLang.getData("xunbao");if(o){var r=o.linkText,g=e.name,l=game.MarqueeLang.getLang("xunbao",[g,t,game.HtmlUtil.getColorStrByQuality(s.quality,s.name,!0)]),c=b8e.getNormP("_$clickFunc"),h=l+(r=game.HtmlUtil.getClickableText(this,this.skin.lab_content,r,c,this.clickFunc,!1));this.skin.lab_content.string=h,this.addClickFunc(this.skin.lab_content,r,this.clickFunc)}}},bossOpen:function(){var e=this.skin,t=game.MarqueeLang.getData("guild_new_boss");if(t){var a=t.linkText,i=game.MarqueeLang.getLang("guild_new_boss"),n=b8e.getNormP("_$clickFunc"),s=i+(a=game.HtmlUtil.getClickableText(this,e.lab_content,a,n,this.clickFunc,!1));e.lab_content.string=s,this.addClickFunc(e.lab_content,a,this.clickFunc)}},arenaChat:function(){var e=this.data,t=e.name,a=e.params[0],i=e.params[1];if(a&&i){var n=game.MarqueeLang.getLang("arena",[t,a,i]);this.skin.lab_content.string=n}else{b8e.error("\u7ade\u6280\u573a\u516c\u544a otehrName: ",a,"rank: ",i)}},createGuildChat:function(){var e=this.data.guildName,t=game.MarqueeLang.getData("create_guild"),a=game.MarqueeLang.getLang("create_guild",[e]),i=t.linkText,n=b8e.getNormP("_$clickFunc"),s=a+(i=game.HtmlUtil.getClickableText(this,this.skin.lab_content,i,n,this.clickFunc,!1));this.skin.lab_content.string=s,this.addClickFunc(this.skin.lab_content,i,this.clickFunc)},guildRecruitment:function(){var e=this.data.guildName,t=game.MarqueeLang.getData("guild_rec"),a=game.MarqueeLang.getLang("guild_rec",[e]),i=t.linkText,n=b8e.getNormP("_$clickFunc"),s=a+(i=game.HtmlUtil.getClickableText(this,this.skin.lab_content,i,n,this.clickFunc,!1));this.skin.lab_content.string=s,this.addClickFunc(this.skin.lab_content,i,this.clickFunc)},wildBossChat:function(){var e=this.data,t=game.MarqueeLang.getData(e.marqueeKey),a=game.MarqueeLang.getLang(e.marqueeKey),i=t.linkText,n=b8e.getNormP("_$clickFunc"),s=a+(i=game.HtmlUtil.getClickableText(this,this.skin.lab_content,i,n,this.clickFunc,!1));this.skin.lab_content.string=s,this.addClickFunc(this.skin.lab_content,i,this.clickFunc)},wildBossAwardChat:function(){var e=this.data,t=e.name,a=game.MarqueeLang.getData(e.marqueeKey),i="";if(e.clientParams){var n=e.clientParams,s=game.ItemInfoCfg.getData(n);s&&(i=s.name)}var o=game.MarqueeLang.getLang(e.marqueeKey,[t,i]),r=a.linkText,g=b8e.getNormP("_$clickFunc"),l=o+(r=game.HtmlUtil.getClickableText(this,this.skin.lab_content,r,g,this.clickFunc,!1));this.skin.lab_content.string=l,this.addClickFunc(this.skin.lab_content,r,this.clickFunc)},publicBossChat:function(){var e=this.data,t=e.name,a=parseInt(e.params[0]),i=game.PublicBossCfg.getData(a),n=game.Lang.get(9560,i.name,i.challengeLv),s=game.HtmlUtil.getColorStrByQuality(i.quality,n,!0),o=game.MarqueeLang.getData(e.marqueeKey),r=game.MarqueeLang.getLang(e.marqueeKey,[t,s]),g=o.linkText,l=b8e.getNormP("_$clickFunc"),c=r+(g=game.HtmlUtil.getClickableText(this,this.skin.lab_content,g,l,this.clickFunc,!1));this.skin.lab_content.string=c,this.addClickFunc(this.skin.lab_content,g,this.clickFunc)},escortChat:function(){var e=this.data,t=game.EscortCfg.getData(parseInt(e.params[0])),a=e.contentStr,i=e.name,n=game.MarqueeLang.getData("escort"),s=(a=game.MarqueeLang.getLang("escort",[i,game.HtmlUtil.getColorStrByQuality(t.quality-1,t.name,!0)]),n.linkText),o=b8e.getNormP("_$clickFunc"),r=a+(s=game.HtmlUtil.getClickableText(this,this.skin.lab_content,s,o,this.clickFunc,!1));this.skin.lab_content.string=r,this.addClickFunc(this.skin.lab_content,s,this.clickFunc)},escortRevengeChat:function(){var e=this.data,t=(e.contentStr,this.getChatChannelStr(e.chatChannelType)),a=e.name,i=(game.MarqueeLang.getData("escort_revenge"),t+game.MarqueeLang.getLang("escort_revenge",[a,e.params[0]]));this.skin.lab_content.string=i},dianweiChat:function(){var e=this.data,t=e.name,a=e.params[0],i=e.params[1],n=game.DianWeiCfg.getData(a),s="";if(n){s=n.name}else s=game.Lang.get(9011);var o=game.MarqueeLang.getData("dianwei"),r=game.DianWeiInsGroupCfg.getData(a,i),g="";if(r){g=r.broadCastParam}var l=game.MarqueeLang.getLang("dianwei",[t,s,i,g]),c=o.linkText,h=b8e.getNormP("_$clickFunc");c=game.HtmlUtil.getClickableText(this,this.skin.lab_content,c,h,this.clickFunc,!1),this.skin.lab_content.string=l,this.addClickFunc(this.skin.lab_content,c,this.clickFunc)},recharegeChat:function(e){var t="recharge"+e,a=game.MarqueeLang.getData(t);if(a){var i,n=this.data,s=+n.params[0],o="";e==game.ChatFuncType.CHAT_FUNC_RECHARGE_FIRST?o=(i=game.FirstRechargeCfg.getData(s))?i.showName:"":e==game.ChatFuncType.CHAT_FUNC_RECHARGE_ACCU?o=(i=game.AccumulativeRechargeCfg.getDataById(s))?i.name:"":e==game.ChatFuncType.CHAT_FUNC_RECHARGE_ZERO&&(o=(i=game.ZeroCfg.getData(s))?i.name:"");var r=game.MarqueeLang.getLang(t,[n.name,o]),g=a.linkText,l=b8e.getNormP("_$clickFunc");g=game.HtmlUtil.getClickableText(this,this.skin.lab_content,g,l,this.clickFunc,!1),this.skin.lab_content.string=r+g,this.addClickFunc(this.skin.lab_content,g,this.clickFunc)}},marqueeChat:function(){var e=this.data,t=game.Lang.get(9013)+e.contentStr;return t=game.HtmlUtil.getText(game.Color.WHITE,t),this.skin.lab_content.string=t},csWarChat:function(){var e=this.data,t=(e.name,e.params),a=game.MarqueeLang.getData(e.marqueeKey),i=game.MarqueeLang.getLang(e.marqueeKey,t),n=a.linkText;if(n){var s=b8e.getNormP("_$clickFunc"),o=i+(n=game.HtmlUtil.getClickableText(this,this.skin.lab_content,n,s,this.clickFunc,!1));this.skin.lab_content.string=o,this.addClickFunc(this.skin.lab_content,n,this.clickFunc)}else this.skin.lab_content.string=i},csGuildWarChat:function(){var e=this.data,t=(e.name,e.params),a=game.MarqueeLang.getData(e.marqueeKey),i=game.MarqueeLang.getLang(e.marqueeKey,t),n=a.linkText;if(n){var s=b8e.getNormP("_$clickFunc"),o=i+(n=game.HtmlUtil.getClickableText(this,this.skin.lab_content,n,s,this.clickFunc,!1));this.skin.lab_content.string=o,this.addClickFunc(this.skin.lab_content,n,this.clickFunc)}else this.skin.lab_content.string=i},guildWarYuxi:function(){var e=game.MarqueeLang.get("guild_war_yuxi");this.skin.lab_content.string=e},guildWarBossDie:function(){var e=this.data,t=game.MarqueeLang.get("guild_war_boss_die",e.name);this.skin.lab_content.string=t},csWarRecruitChat:function(){var e=this.data,t=e.name,a=(e.teamId,"");switch(game.sceneData.getSceneType()){case game.SceneType.TREASURE:a="cs_treasure_recruit";break;default:a="cs_war_recruit"}var i=game.MarqueeLang.getData(a),n=game.MarqueeLang.getLang(a,[t]),s=i.linkText,o=b8e.getNormP("_$clickFunc"),r=n+(s=game.HtmlUtil.getClickableText(this,this.skin.lab_content,s,o,this.clickFunc,!1));this.skin.lab_content.string=r,this.addClickFunc(this.skin.lab_content,s,this.clickFunc)},throneSarSurpriseChat:function(){var e=this.getThroneWarSurprise();if(e&&1<e.length){var t=game.ItemInfoCfg.getData(+e[0]);if(!t)return;var a=this.data.name,i=game.HtmlUtil.getColorStrByQuality(t.quality,t.name,!0),n=game.MarqueeLang.getLang("throne_war_surprise",[a,i,e[1]]);this.skin.lab_content.string=n}},getThroneWarSurprise:function(){if(!this._throneWarSurprise||this._throneWarSurprise.length<1){var e=game.ThroneMiscCfg.getData("throneWarSurprise");if(!e||""==e.value)return!1;this._throneWarSurprise=e.value.split(",")}return this._throneWarSurprise},csarrowOpenChat:function(){var e=game.MarqueeLang.getLang("csarrow_open");this.skin.lab_content.string=e},hunluChat:function(){var e=this.data,t=game.MarqueeLang.getData("hunlu_help"),a="",i=game.ItemInfoCfg.getData(e.hunluItemId);i&&(a=game.HtmlUtil.getColorStrByQuality(i.quality,i.name));var n=game.MarqueeLang.getLang("hunlu_help",[a]),s=t.linkText,o=b8e.getNormP("_$clickFunc"),r=n+(s=game.HtmlUtil.getClickableText(this,this.skin.lab_content,s,o,this.clickFunc,!1));this.skin.lab_content.string=r,this.addClickFunc(this.skin.lab_content,s,this.clickFunc)},csArenaChat:function(){var e=this.data,t=game.MarqueeLang.getData("csArena"),a=game.MarqueeLang.getLang("csArena",[e.name+"s."+e.zoneId]),i=t.linkText,n=b8e.getNormP("_$clickFunc"),s=a+(i=game.HtmlUtil.getClickableText(this,this.skin.lab_content,i,n,this.clickFunc,!1));this.skin.lab_content.string=s,this.addClickFunc(this.skin.lab_content,i,this.clickFunc)},csFestivalBossOpen:function(){var e=game.MarqueeLang.get("csFestival_boss");this.skin.lab_content.string=e},csFestivalKillBoss:function(){this._setContent("csFestival_boss_kill")},showPartnerEquip:function(){var e=this.data,t=e.name,a=e.equip,i=game.ItemInfoCfg.getData(a.id);if(i){var n=game.MarqueeLang.getLang("partner_equip",[t,i.name]),s=game.MarqueeLang.getData("partner_equip").linkText,o=b8e.getNormP("_$clickFunc"),r=n+(s=game.HtmlUtil.getClickableText(this,this.skin.lab_content,s,o,this.clickFunc,!1));this.skin.lab_content.string=r,this.addClickFunc(this.skin.lab_content,s,this.clickFunc)}},showSummon:function(){var e=this.data,t=e.name,a=+e.params[0],i=game.ItemInfoCfg.getData(a);if(i){a=+e.params[1];var n=game.SummonOpenCfg.getData(a);if(n){var s=game.HtmlUtil.getColorStrByQuality(i.quality,i.name),o=game.MarqueeLang.getLang("partner_recruit",[t,n.name,s]),r=game.MarqueeLang.getData("partner_recruit").linkText,g=b8e.getNormP("_$clickFunc"),l=o+(r=game.HtmlUtil.getClickableText(this,this.skin.lab_content,r,g,this.clickFunc,!1));this.skin.lab_content.string=l,this.addClickFunc(this.skin.lab_content,r,this.clickFunc)}}},shellChat:function(){var e=this.data,t=+e.params[0],a=game.ItemInfoCfg.getData(t);if(a){var i=game.MarqueeLang.getData("shell");if(i){var n=i.linkText,s=e.name,o=game.HtmlUtil.getColorStrByQuality(a.quality,a.name,!0),r=game.MarqueeLang.getLang("shell",[s,o]),g=b8e.getNormP("_$clickFunc"),l=r+(n=game.HtmlUtil.getClickableText(this,this.skin.lab_content,n,g,this.clickFunc,!1));this.skin.lab_content.string=l,this.addClickFunc(this.skin.lab_content,n,this.clickFunc)}}},csArrowChat:function(){var e=this.data,t=e.params,a=e.name;if(t&&2==t.length){var i=t[0],n=t[1],s=game.CsArrowData.getArrowItemInfo(n),o=game.HtmlUtil.getColorStrByQuality(s.quality,s.name,!0),r=game.MarqueeLang.get("cs_arrow_get",a,i,o),g=game.MarqueeLang.getData("cs_arrow_get").linkText,l=b8e.getNormP("_$clickFunc"),c=r+(g=game.HtmlUtil.getClickableText(this,this.skin.lab_content,g,l,this.clickFunc,!1));this.skin.lab_content.string=c,this.addClickFunc(this.skin.lab_content,g,this.clickFunc)}},giftChat:function(){var e=this.data,t=e.params;if(t&&!(t.length<1)){var a=+t[0],i=game.ItemInfoCfg.getData(a);if(i){var n=game.HtmlUtil.getColorStrByQuality(i.quality,i.name,!0),s=i.braodcastDesc?i.braodcastDesc:"",o=game.MarqueeLang.get("gift_item",e.name,n,s);this.skin.lab_content.string=o}}},tipsChat:function(){var e=game.MarqueeLang.get(this.data.marqueeKey);this.skin.lab_content.string=e},guildChatOpen:function(){var e=game.MarqueeLang.get("guild_open");this.skin.lab_content.string=e,this.send(game.ChatEvts.V2C_CSGUILD_RELIVE)},guildChatFight:function(){var e=game.MarqueeLang.get("guild_fight");this.skin.lab_content.string=e},guildChatKill:function(){var e=game.MarqueeLang.get("guild_kill",this.data.name);this.skin.lab_content.string=e,this.send(game.ChatEvts.V2C_CSGUILD_KILL)},puzzleChatHelp:function(){var e=game.MarqueeLang.getData("puzzle_help"),t=game.MarqueeLang.get("puzzle_help",this.data.name),a=e.linkText,i=b8e.getNormP("_$clickFunc");t+=a=game.HtmlUtil.getClickableText(this,this.skin.lab_content,a,i,this.clickFunc,!1),this.skin.lab_content.string=t,this.addClickFunc(this.skin.lab_content,a,this.clickFunc)},huntingChat:function(){var e=this.data,t=+e.params[0],a=game.ItemInfoCfg.getData(t);if(a){var i=game.MarqueeLang.getData("hunting_contest");if(i){var n=i.linkText,s=e.name,o=game.HtmlUtil.getColorStrByQuality(a.quality,a.name,!0),r=game.MarqueeLang.getLang("hunting_contest",[s,o]),g=b8e.getNormP("_$clickFunc"),l=r+(n=game.HtmlUtil.getClickableText(this,this.skin.lab_content,n,g,this.clickFunc,!1));this.skin.lab_content.string=l,this.addClickFunc(this.skin.lab_content,n,this.clickFunc)}}},overlordMatch:function(){var e=this.data,t=e.funcType,a=game.ChatFuncType,i=void 0,n=void 0;if(t==a.CHAT_FUNC_OVERLORD_KILL3||t==a.CHAT_FUNC_OVERLORD_KILL5||t==a.CHAT_FUNC_OVERLORD_KILL7||t==a.CHAT_FUNC_OVERLORD_KILL10){var s=t==a.CHAT_FUNC_OVERLORD_KILL3?3:t==a.CHAT_FUNC_OVERLORD_KILL5?5:t==a.CHAT_FUNC_OVERLORD_KILL7?7:10;e.params&&e.params.length&&(i=game.Lang.get(8338,e.params[0],s))}t==a.CHAT_FUNC_OVERLORD_OPEN&&(i=game.Lang.get(8336)),t==a.CHAT_FUNC_OVERLORD_R16&&e.params&&e.params.length&&(i=game.Lang.get(8337,e.params[0])),t==a.CHAT_FUNC_OVERLORD_TERMINATED&&(n=e.params)&&2<=n.length&&(i=game.Lang.get(8339,n[0],n[1],n[0])),t==a.CHAT_FUNC_OVERLORD_PROMOTION&&(n=e.params)&&2<=n.length&&(i=game.Lang.get(8340,n[0],n[1])),t==a.CHAT_FUNC_OVERLORD_CHAMPION&&e.params&&e.params.length&&(i=game.Lang.get(8341,e.params));var o=this.getChatChannelStr(e.chatChannelType)+i;this.skin.lab_content.string=o},mainIntChat:function(){this._setLinkContent("main_ins",!0)},zhanjiangChat:function(){this._setLinkContent("zhanjiang",!0)},firstRechargeChat:function(){this._setLinkContent("first_recharge",!0)},monthChat:function(){this._setLinkContent("card_month",!1)},cardForeverChat:function(){this._setLinkContent("card_forever",!1)},privilegeBattleChat:function(){this._setLinkContent("privilege_battle",!1)},partnerStarChat:function(){var e="partner_star",t=game.MarqueeLang.getData(e);if(t&&(params=this.data.params,params||!(params.length<1))){var a=+params[0],i=game.PartnerCfg.getData(a);if(i){var n=game.HtmlUtil.getColorStrByQuality(i.quality,i.name,!0),s=game.MarqueeLang.getLang(e,[this.data.name,n,params[1]]),o=b8e.getNormP("_$clickFunc"),r=t.linkText;s+=r=game.HtmlUtil.getClickableText(this,this.skin.lab_content,r,o,this.clickFunc,!1),this.skin.lab_content.string=s,this.addClickFunc(this.skin.lab_content,r,this.clickFunc)}}},_setLinkContent:function(e,t){var a=this,i=a.data,n=game.MarqueeLang.getData(e);if(n){a.tempArgs||(a.tempArgs=[]),a.tempArgs.length=0,a.tempArgs.push(i.name);var s=i.params;if(t&&s&&0<s.length)for(var o=s.length,r=0;r<o;r++)a.tempArgs.push(s[r]);var g=game.MarqueeLang.getLang(e,a.tempArgs),l=n.linkText;if(l){var c=b8e.getNormP("_$clickFunc");g+=l=game.HtmlUtil.getClickableText(a,a.skin.lab_content,l,c,a.clickFunc,!1),a.skin.lab_content.string=g,a.addClickFunc(a.skin.lab_content,l,a.clickFunc)}else a.skin.lab_content.string=g}},mibaoChat:function(){var e=this.data,t=+e.params[0],a=game.ItemInfoCfg.getData(t);if(a){var i=game.MarqueeLang.getData("mibao");if(i){var n=i.linkText,s=e.name,o=game.MarqueeLang.getLang("mibao",[s,game.HtmlUtil.getColorStrByQuality(a.quality,a.name,!0)]),r=b8e.getNormP("_$clickFunc"),g=o+(n=game.HtmlUtil.getClickableText(this,this.skin.lab_content,n,r,this.clickFunc,!1));this.skin.lab_content.string=g,this.addClickFunc(this.skin.lab_content,n,this.clickFunc)}}},clickFunc:function(e){var t=this;if(t&&t.data){var a=t.data,i=game.ChatFuncType,n=a.funcType,s=game.ChatEvts,o={};switch(n){case i.CHAT_FUNC_NONE:return;case i.CHAT_FUNC_TEAM:var r=a.instId,g=game.TeamInstanceCfg.getData(r);if(!g)return;var l=g.type,c=game.TeamInstType,h=null,m={},u=0;switch(l){case c.CS_TEAM:h=game.MarqueeLang.getData("cs_team"),m.teamType=game.TeamInstType.CS_TEAM,u=game.ME.CsTeam;break;case c.GUILD_TEAM:if(h=game.MarqueeLang.getData("guild_war"),!game.guildData.hasGuild()){var d=game.Lang.get(2621);return void game.notice.show(d)}m.teamType=game.TeamInstType.GUILD_TEAM,u=game.ME.GuildTeam;break;case c.WORLDWAR_TEAM:h=game.MarqueeLang.getData("world_war"),m.teamType=game.TeamInstType.WORLDWAR_TEAM,u=game.ME.WorldWar;break;case c.WORLDWAR2_TEAM:h=game.MarqueeLang.getData("world_war2"),m.teamType=game.TeamInstType.WORLDWAR2_TEAM,u=game.ME.WorldWar2;break;case c.THOUSANDTOWER_TEAM:h=game.MarqueeLang.getData("thousandtower"),m.teamType=c.THOUSANDTOWER_TEAM,u=game.ME.ThousandTower}if(game.playBack.isInstanceFighting(!0))return;if(game.sceneData.isGuildMap())return;if(!game.moduleOpen.checkOpenWithTips(u))return;m.teamId=a.teamId,m.instId=a.instId,t.send(game.ChatEvts.C_REQ_ENTER_TEAM,m);break;case i.CHAT_FUNC_HELP:if(game.playBack.isInstanceFighting(!0))return;if(game.sceneData.isGuildMap())return;o.instId=a.instId,o.roleId=a.roleId,t.dptG(s.C_CHAT_FUNC_HELP,o);break;case i.CHAT_FUNC_MASTER:game.moduleOpen.checkOpenWithTips(game.ME.PeachGarden)&&game.module.showToggle(game.ME.PeachGarden,2);break;case i.CHAT_FUNC_CREATE_GUILD:game.guildData.hasGuild()?game.notice.show(2620):game.module.show(game.ME.GuildRecommend);break;case i.CHAT_FUNC_FOSTER_ADVANCE:if(f=a.fosterType)(h=game.MarqueeLang.getData("foster_advance"+f))&&game.module.showToggle(h.funcId,h.pageIndex);break;case i.CHAT_FUNC_FOSTER_AWAKEN:var f;if(f=a.fosterType)(h=game.MarqueeLang.getData("foster_Awake"+f))&&game.module.showToggle(h.funcId,h.pageIndex);break;case i.CHAT_FUNC_GUILD_RECRUITMENT:if(game.guildData.hasGuild()){d=game.Lang.get(2620);game.notice.show(d)}else game.module.show(game.ME.GuildRecommend);break;case i.CHAT_FUNC_WILD_BOSS:case i.CHAT_FUNC_WILD_AWARD:game.moduleOpen.checkOpenWithTips(game.ME.Boss)&&game.module.showToggle(game.ME.Boss,2);break;case i.CHAT_FUNC_QUANMIN_BOSS:game.moduleOpen.checkOpenWithTips(game.ME.Boss)&&game.module.showToggle(game.ME.Boss,1);break;case i.CHAT_FUNC_ESCORT:game.module.show(game.ME.Escort);break;case i.CHAT_FUNC_XUNBAO:var p=parseInt(a.params[1]);b8e.evt.dptG(game.XunBaoEvts.C2C_SHOW_XUNBAO,p);break;case i.CHAT_GUILD_BOSS2_OPEN:game.module.show(game.ME.GuildNewBoss);break;case i.CHAT_FUNC_SHENJIANG:game.moduleOpen.checkOpenWithTips(game.ME.PetTurnplate)&&game.module.showToggle(game.ME.Turnplate,2);break;case i.CHAT_FUNC_DIANWEI:game.module.show(game.ME.OpenServer),game.module.show(game.ME.DianWei);break;case i.CHAT_FUNC_CS_WAR:if(!game.csWarData.state)return void game.notice.show(9014);var _=game.sceneData.getSceneType();switch(a.marqueeKey){case"cs_war_open":if(_===game.SceneType.CSWAR)return void game.notice.show(9015);t.send(game.ChatEvts.V2C_REQ_ENTER_CS_WAR);break;case"cs_war_goto":if(_!=game.SceneType.CSWAR)return void game.notice.show(9016);t.send(game.ChatEvts.V2C_REQ_GOTO_CS_WAR,a.clientParams)}break;case i.CHAT_FUNC_THRONE:var v=game.sceneData.isCsScene();switch(a.marqueeKey){case"throne_open":case"throne_monarch":if(v)return void game.notice.show(9017);t.send(game.ChatEvts.V2C_REQ_ENTER_THRONE)}break;case i.CHAT_FUNC_TREASURE:v=game.sceneData.isCsScene();switch(a.marqueeKey){case"treasure_open":if(v)return void game.notice.show(9018);t.send(game.ChatEvts.V2C_REQ_ENTER_TREASURE)}break;case i.CHAT_FUNC_CROSS_ARENA:t.send(game.ChatEvts.V2C_REQ_JOIN_CSARENA);break;case i.CHAT_FUNC_TEAM_RECRUIT:switch(_=game.sceneData.getSceneType()){case game.SceneType.CSWAR:if(!game.csWarData.state)return void game.notice.show(9014);if(_!=game.SceneType.CSWAR)return void game.notice.show(9016);t.send(game.ChatEvts.V2C_REQ_RECRUIT_CS_WAR,a.teamId);break;case game.SceneType.GUANDU_MAP:if(!game.guanDuData.guanduIsOpen)return void game.notice.show(9019);t.send(game.ChatEvts.V2C_REQ_RECRUIT_GUANDU,a.teamId);break;case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:if(!game.guildWarData.guildWarIsOpen)return void game.notice.show(9020);t.send(game.ChatEvts.V2C_REQ_ENTER_GUILDWAR,a.teamId);break;case game.SceneType.TREASURE:if(!game.csTreasureData.isOpen())return void game.notice.show(9021);t.send(game.ChatEvts.V2C_REQ_RECRUIT_CS_WAR,a.teamId)}break;case i.CHAT_FUNC_CS_ARROW:switch(a.marqueeKey){case"csarrow_open":game.notice.show(9019),t.send(game.ChatEvts.C2C_REQ_ENTER_CSARROW)}break;case i.CHAT_FUNC_HUNLU:if(a.roleId==game.mainRoleData.id)return void game.notice.show("\u4e0d\u80fd\u7ed9\u81ea\u5df1\u8d60\u9001\uff01");(h=game.MarqueeLang.getData("hunlu_help"))&&(game.hunluData.curChatHunluIdx=a.hunluIdx,game.hunluData.curChathunluItemId=a.hunluItemId,game.hunluData.curChatQiuZengRoleName=a.name,game.hunluData.curChatQiuZengRoleId=a.roleId,game.module.show(h.funcId));break;case i.CHAT_FUNC_RECHARGE_SALE:case i.CHAT_FUNC_RECHARGE_CHOOSE:case i.CHAT_FUNC_RECHARGE_TIMELIMIT:case i.CHAT_FUNC_RECHARGE_DAILY:case i.CHAT_FUNC_RECHARGE_DISCOUNT:case i.CHAT_FUNC_RECHARGE_FIRST:case i.CHAT_FUNC_RECHARGE_ACCU:case i.CHAT_FUNC_RECHARGE_ZERO:case i.CHAT_FUNC_FUND:case i.CHAT_FUNC_INVESTOR_PLAN:(h=game.MarqueeLang.getData("recharge"+n))&&game.module.showToggle(h.funcId,h.pageIndex);break;case i.CHAT_FUNC_GUILD_WAR:(h=game.MarqueeLang.getData("guild_war_close"))&&game.module.showToggle(h.funcId,h.pageIndex);break;case i.CHAT_FUNC_ARROW_GET:if((_=game.sceneData.getSceneType())!=game.SceneType.CS_ARROW)return void game.notice.show(6324);t.send(game.ChatEvts.V2C_ARROW_GET);break;case i.CHAT_FUNC_JIGSAW_GUILD_HELP:(h=game.MarqueeLang.getData("puzzle_help"))&&(game.puzzleData.openHelpType=2,game.module.show(h.funcId));break;case i.CHAT_FUNC_EQUIP:var E=a.equip,C=game.partnerEquipData.createInfoById(E.id);C.setData(E),game.partnerEquipData.selInfo=C,game.tipsData.setInfo(C),3==C.type?game.module.show(game.ME.ExcEquipDetailsTips):game.module.show(game.ME.EquipDetailsTips);break;case i.CHAT_FUNC_SUMMON:t.gotoME("partner_recruit");break;case i.CHAT_FUNC_SHELL:game.shellData.getOpenId()?game.module.show(game.ME.Shell):game.notice.show(52347);break;case i.CHAT_FUNC_HUNTING:game.huntingContestData.getIsOpen()?game.module.show(game.ME.HuntingMain):game.notice.show(52347);break;case i.CHAT_MAIN_INT:t.gotoME("main_ins");break;case i.CHAT_ZHANJIANG:t.gotoME("zhanjiang");break;case i.CHAT_FIRST_RECHARGE:t.gotoME("first_recharge");break;case i.CHAT_CARD_MONTH:t.gotoME("card_month");break;case i.CHAT_CARD_FOREVER:t.gotoME("card_forever");break;case i.CHAT_PRIVILEGE_BATTLE:t.gotoME("privilege_battle");break;case i.CHAT_PARTNER_STAR:t.gotoME("partner_star");break;case i.CHAT_FUNC_MIBAO:t.gotoME("mibao")}e&&e.stopPropagation()}},gotoME:function(e){var t=game.MarqueeLang.getData(e);t&&t.funcId&&(t.pageIndex?game.module.showToggle(t.funcId,t.pageIndex):game.module.show(t.funcId))},cancelClickFunc:function(e,t){if(e&&e.string){if(this.clickStrList&&!(this.clickStrList.length<1)){var a=e.getNode();if(a){var i=a.children;if(i&&!(i.length<1))for(var n=void 0,s=void 0,o=i.length,r=this.skin.clickBtn,g=0;g<o;g++)if((s=i[g].getComponent(cc.Label))&&-1<(n=this.clickStrList.indexOf(s.string))){r.setPosition(0,0),r.setSize(0,0),b8e.evt.offC(r,t,this),this.clickStrList.splice(n,1);break}}}}},addClickFunc:function(e,t,a,i){if(e&&e.string&&!(e.string.indexOf(t)<-1)){var n=e.getNode();if(n){var s=n.children;if(s&&!(s.length<1)){this.clickStrList||(this.clickStrList=[]),i||(this.reg||(this.reg=/[^\u4e00-\u9fa5]/gi),t=t.replace(this.reg,""));for(var o=void 0,r=void 0,g=s.length,l=this.skin.clickBtn,c=0,h=s[g-1].y,m=0,u=0;u<g;u++)if(h!=(r=s[u]).y?(c=r.width,h=r.y,m=1):c+=r.width,(o=r.getComponent(cc.Label))&&-1<t.indexOf(o.string)){l.setPosition(c,o.node.y-12*m),l.setSize(o.node.width,o.node.height),this.clickStrList.push(o.string),b8e.evt.onC(l,a,this);break}}}}}})).poolCall=!0,b8e.RC("$$game","$$ChatItemView",e)}(),function(){var e=game.View.extends({_showModel:!0,model:null,ctor:function(){this._super(1197)},init:function(){this.headIcon=new game.CultivateBaseIcon,this.headIcon.addToParent(this.skin.sp_head);var e=this.partnerList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ChatPlayerPartnerListItem,e.addToParent(this.skin.partnerList),e.layout.paddingLeft=-5,e.layout.spacingX=-30;var t=this.fosterList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.ChatPlayerFosterListItem,t.addToParent(this.skin.fosterList),t.layout.paddingLeft=-5,t.layout.spacingX=-30},notify:function(e){switch(e){case game.ChatEvts.SHOW_PLAYER:this.updateInfo();break;case game.ChatEvts.COPY_PLAYER_NAME:this.copyPlayerName()}},onShow:function(){this.updateInfo()},onHide:function(){},updateInfo:function(){var e=game.chatData.playerInfo;if(e){var t=this.skin;if(t){var a=e.getPartnerInfoList();a&&0<a.length?this.partnerList.setData(a):this.fosterList.setData(null);var i=e.getFosterInfoList();i&&0<i.length?this.fosterList.setData(i):this.fosterList.setData(null),t.name_lab.string=e.name,t.roleId_lab.string=e.roleId,0==e.guildName.length?t.guild_lab.string=game.Lang.get(9024):t.guild_lab.string=e.guildName,0==e.cpName.length?t.cp_lab.string=game.Lang.get(9024):t.cp_lab.string=e.cpName;var n=e.getMainRoleInfo(),s=this.headIcon;if(n){s.setData(n),s.removeMainRoleIcon(),s.lvLbl&&s.lvLbl.setPosition(0,-65);var o=game.ResCfg.getHead(e.isMale);s.setIcon(o)}else s.clearData();t.power_lab.string=e.power,t.powerBg.width=t.power_lab.width+70,t.vip_lab.string=game.HtmlUtil.getImgText("v"+e.vipLv);var r=!1,g=!1,l=e.roleId;game.relationData&&(r=game.relationData.isInBlackList(l),g=game.relationData.isFollowed(l)),t.difriend_lab.string=r?game.Lang.get(9025):game.Lang.get(9026),t.follow_lab.string=g?game.Lang.get(9027):game.Lang.get(9028)}}},copyPlayerName:function(){game.CCommonUtil.setClipboardData(this.skin.name_lab.string)},onStageResize:function(){var e=b8e.stageHeight;this.setPosition(.5*(b8e.stageWidth-this.width),.5*(e+this.height))}});b8e.module.registerView(game.ME.ChatPlayerInfo,e)}(),function(){var e=void 0;(e=game.GamePopView.extends({_isBlackBG:!1,_emotionList:null,tmp_vec2:null,ctor:function(){this._super(1196),this.tmp_vec2=new cc.Vec2},init:function(){b8e.evt.onC(this.skin.emotion_sp.node,this.selectEmotion,this,0,!0)},onShow:function(){var e=this;switch(b8e.setTimeout(function(){b8e.evt.onC(b8e.stage,this.onTouchStage,this)},e,1),game.chatData.curEmotionType){case game.ChatEmotionType.MAIN:e.bindEnum=game.ME.MainUIChat,e.x=570,e.y=170;break;case game.ChatEmotionType.PRIVATE:e.bindEnum=game.ME.ChatPrivate,e.x=500,e.y=280;break;case game.ChatEmotionType.MAIN2:e.bindEnum=game.ME.MainUIChat,e.x=500,e.y=280;break;default:e.x=500,e.y=150}},onTouchStage:function(){e.inst().hidePopView()},selectEmotion:function(e){var t=e.getLocation();if(e.target){t=e.target.convertToNodeSpaceAR(t),this.tmp_vec2={x:0,y:0};var a=t.x-this.tmp_vec2.x,i=this.tmp_vec2.y-t.y,n=parseInt(a/57)+1,s=6*(parseInt(i/57)+1-1)+n,o="#"+(s<10?"0"+s:s+"")+"#";return this.send(game.ChatEvts.ADD_CHAT_EMOTION,o),!0}},onHide:function(){b8e.evt.offC(b8e.stage,this.onTouchStage,this)}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$ChatEmotionView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1195),this.setSize(115,155)},init:function(){this.headIcon=b8e.Sprite.get(),this.headIcon.setAnchor(0,1),this.headIcon.setSize(84,84),this.headIcon.addToParent(this.skin.sp_head)},setData:function(){var e=this.data;if(e){var t=this.skin,a=game.HtmlUtil.getText(game.Color.BLACK,e.name);t.name_lab.string=a,t.head_select.node.active=e.isSelect,t.onlineState_sp.node.active=e.isOnline,t.offlineState_sp.node.active=!e.isOnline,t.unread_sp.node.active=e.unRead,this.loadHeadIcon(e.isMale)}},loadHeadIcon:function(e){var t=game.ResCfg.getHead(e);this.headIcon.loadTexture(t)},closeChat_btn:function(){this.send(game.ChatEvts.CLOSE_ONE_PRIVATE_CHAT,this.data)},sp_head:function(){var e=game.chatData.selectPriChatRoleId,t=this.data.roleId;if(e===t){this.dptG(game.ChatEvts.SHOW_PLAYER,t)}else this.send(game.ChatEvts.SELECT_ROLE_WITH_PRIVATE_CHAT,t)},name_btn:function(){var e=this.data.roleId;this.dptG(game.ChatEvts.SHOW_PLAYER,e)}}),b8e.RC("$$game","$$ChatPrivateHeadItemView",e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(1194),this.setSize(430,130)},init:function(){this.headIcon=b8e.Sprite.get(),this.headIcon.setAnchor(0,1),this.headIcon.setSize(84,84),this.headIcon.addToParent(this.skin.sp_head)},setData:function(){var e=this.data;if(e){var t=this.skin,a=e.name,i=e.vipLv;i=game.HtmlUtil.getImgText("V"),t.lab_name.string=i+"  "+a;var n=game.HtmlUtil.analyzeEmotion(e.contentStr);t.lab_content.string=n,this.loadHeadIcon(e.isMale)}},loadHeadIcon:function(e){var t=game.ResCfg.getHead(e);this.headIcon.loadTexture(t)},sp_head:function(){this&&this.data&&this.data&&this.data.roleId&&game.sceneData.getSceneType()!=game.SceneType.CS_ARROW&&this.data.funcType!=game.ChatFuncType.CHAT_FUNC_CSBOSS_KILL&&this.data.funcType!=game.ChatFuncType.CHAT_FUNC_CSBOSS_SHIELD&&this.data.roleId!==game.mainRoleData.id&&this.dptG(game.ChatEvts.SHOW_PLAYER,this.data.roleId)}})).poolCall=!0,b8e.RC("$$game","$$ChatPrivateItemOtherView",e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(1193),this.setSize(430,115)},init:function(){this.headIcon=b8e.Sprite.get(),this.headIcon.setAnchor(0,1),this.headIcon.setSize(84,84),this.headIcon.addToParent(this.skin.sp_head)},setData:function(){var e=this.data;if(e){var t=this.skin,a=game.HtmlUtil.analyzeEmotion(e.contentStr);t.lab_content.string=a,this.loadHeadIcon(e.isMale)}},loadHeadIcon:function(e){var t=game.ResCfg.getHead(e);this.headIcon.loadTexture(t)}})).poolCall=!0,b8e.RC("$$game","$$ChatPrivateItemSelfView",e)}(),function(){var e=game.View.extends({_showModel:!0,_roleList:null,_chatList:null,_selectRoleId:0,INPUT_MAX:40,ctor:function(){this._super(1192)},init:function(){var e=this;e._chatList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._chatList.itemRender=[game.ChatPrivateItemSelfView,game.ChatPrivateItemOtherView],e._chatList.layout.paddingTop=0,e._chatList.addToParent(e.skin.chatScrollView),e._chatList.bindEnum=game.ME.ChatPrivate,e._roleList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._roleList.itemRender=game.ChatPrivateHeadItemView,e._roleList.layout.paddingTop=2,e._roleList.layout.spacingY=20,e._roleList.addToParent(e.skin.headScrollView),e._roleList.bindEnum=game.ME.ChatPrivate},notify:function(e,t){switch(e){case game.ChatEvts.UPDATE_PLAYER_INFO:this.updateInfo(t.playerInfo);break;case game.ChatEvts.UPDATE_PRIVATE_CHAT:this.updateHeadList(),this.updatePriChatList();break;case game.ChatEvts.SELECT_ROLE_WITH_PRIVATE_CHAT:if(t){this._selectRoleId=t,this.updateHeadList(),this.updatePriChatList()}break;case game.ChatEvts.ADD_CHAT_EMOTION:this.addEmotion(t);break;case game.ChatEvts.SEND_CHAT:this.sendInputText()}},sendInputText:function(){var a=this,e=game.ChatCfg.getData(game.ChatChannelType.PRIVATE);if(e)if(game.mainRoleData.lv<e.limitLv)game.notice.show(9585,e.limitLv);else{var i=game.chatData.getHeadInfoById(a._selectRoleId);i&&i.lv<e.limitLv&&game.notice.show(9588,e.limitLv);var t=a.skin.input_edtbox.string;if(""!==t)if(t.length>a.INPUT_MAX)game.notice.show(9589,e.wordLimit);else{var n=game.SysTime.curTime;game.chatData.getChannelChatCD(game.ChatChannelType.PRIVATE)<n-game.chatData.getLastSendTimeByChannel(game.ChatChannelType.PRIVATE)?game.sdk.msgSecCheck(t,function(e,t){a.skin.input_edtbox.string="",a.send(game.ChatEvts.SEND_CHAT,{content:t,targetName:i.name})},a,!1):game.notice.show(9032)}else game.notice.show(9031)}else b8e.warn(a._selectChannel,"\u804a\u5929\u9891\u9053\u4e3a\u5565\u6ca1\u6709\u914d\u7f6e\uff1f")},addEmotion:function(e){var t=game.ChatCfg.getData(game.ChatChannelType.PRIVATE);if(t){var a=e;4+this.skin.input_edtbox.string.length>this.INPUT_MAX?game.notice.show(9589,t.wordLimit):this.skin.input_edtbox.string+=a,this.skin.input_edtbox._editBox.setFocus()}else b8e.warn(this._selectChannel,"\u804a\u5929\u9891\u9053\u6ca1\u6709\u914d\u7f6e\uff1f")},onShow:function(){this.updateHeadList(),this.updatePriChatList(),this.qryRolesOnlineState()},updateHeadList:function(){var e=game.chatData.getChatHeadArr();if(this._roleList)e&&this._roleList.setData(e);else;},updatePriChatList:function(e){if(!game.chatData.hasRoleChatHeadInfo(this._selectRoleId)){var t=game.chatData.getChatHeadArr();if(t&&0<t.length){this._selectRoleId=t[0].roleId}else this._selectRoleId=0}var a;a=game.chatData.getPriChatList(this._selectRoleId),game.chatData.selectPriChatRole(this._selectRoleId),this._chatList.setData(a),b8e.hasTimeout(this.layoutList,this)||b8e.setTimeout(this.layoutList,this,100)},layoutList:function(){this._chatList.scrollToBottom()},qryRolesOnlineState:function(){this.send(game.ChatEvts.QURY_ROLES_ONLINE,null)},onHide:function(){},returnBtn:function(){this.send(game.ChatEvts.MIN_PRIVATE_WIN)}});b8e.module.registerView(game.ME.ChatPrivate,e)}(),function(){var e;e=game.ListItem.extends({id:0,ctor:function(){this._super(1191),this.setSize(535,50)},setData:function(){var e=this.data;if(e){this.id=e.id;var t=game.HtmlUtil.getText(game.Color.BLACK,e.contentStr);this.skin.content_lab.string=t,this.width=e.width,this.skin.bg.width=e.width,this.skin.content_btn.width=e.width}},content_btn:function(){this.send(game.ChatEvts.QUICK_CHAT_SELECT,{contentStr:this.data.contentStr,id:this.data.id}),game.ChatQuickSendView.inst().hidePopView()}}),b8e.RC("$$game","$$ChatQuickItemView",e)}(),function(){var e=void 0;(e=game.GamePopView.extends({_isBlackBG:!1,_showModel:!1,_quickList:null,ctor:function(){this._super(1190)},init:function(){this._quickList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._quickList.itemRender=game.ChatQuickItemView,this._quickList.layout.paddingTop=0,this._quickList.layout.spacingY=1,this._quickList.addToParent(this.skin.quickScrollView),this._quickList.bindEnum=game.ME.MainUIChat},notify:function(e){switch(e){case game.ChatEvts.SEND_CHAT:}},showPopView:function(e){this.type=0|e,this.parent?this.show():game.GameViewMgr.inst().showView(this,null,!1,2)},onShow:function(){b8e.evt.onC(b8e.stage,this.onClickStage,this),this.type?this.setPosition(200,660):this.setPosition(60,560),this.updateWidth(),this.updateData()},updateWidth:function(){var e=this.type,t=1==e?500:b8e.stageWidth-178;this.skin.bg.width=t,this._quickList.width=t-8,this.skin.sanjiao_bg.x=t-80,this.skin.quickScrollView.width=t;for(var a=game.chatData.getQuickChatContentArr()||[],i=a.length,n=0;n<i;n++){var s=a[n];s&&s.updateWidth(e)}},onStageResize:function(){},onClickStage:function(){e.inst().hidePopView()},onHide:function(){this.pos=null,b8e.evt.offC(b8e.stage,this.onClickStage,this)},updateData:function(){var e=game.chatData.getQuickChatContentArr();if(this._quickList){this._quickList.setData(e)}}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$ChatQuickSendView",e)}(),function(){var e=void 0;(e=game.Widget.extends({oldPower:0,nowPower:0,tweenTime:1e3,index:0,ctor:function(){this._super(1189)},showTeamStatPower:function(e){var t=0<arguments.length&&void 0!==e&&e;this.startShow(!0,!0,t)},setNomalStat:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this.startShow(!1,!0,a),this.setReadyData(e),this.setReadyPower()},setUpdatedStat:function(e){this.sunSpriteStat(e)},showStatBySS:function(e,t,a){var i=2<arguments.length&&void 0!==a&&a;this.startShow(!1,!0,i),this.setReadyData(e),this.setReadyPower(),this.sunSpriteStat(t)},startShow:function(e,t,a){this.showFightAmount(!0),this.showing=!0,this.canCover=e,this.canShowPower=t,this.showAllSp=a},endShow:function(){this.showing=!1,this.canCover=!1,this.canShowPower=!1,this.showAllSp=!1},setReadyPower:function(){if(this.showing){var e=this.index;this.createTempData(),this.powerTempMap.set(e,game.mainRoleData.power)}},setReadyData:function(e){if(this.showing){this.index++;var t=this.index;this.createTempData(),this.tempList.push(t);var a=this.oldStat;(a=a||(this.oldStat=game.SpriteStat.get())).clear(),a.addSpriteStat(e,1)}},sunSpriteStat:function(e){if(this.showing){this.createTempData();var t=this.index;if(this.tempList.indexOf(t)<0)this.endShow();else{var a=game.SpriteStat.get();a.clear(),a.addSpriteStat(e,1),a.sunSpriteStat(this.oldStat,1),a.getFirstSpriteStat()?this.statTempMap.set(t,a):this.endShow()}}},sunSpriteStatByServer:function(e){if(this.showing){this.createTempData();var t=this.index;if(this.tempList.indexOf(t)<0)this.endShow();else{var a=game.SpriteStat.get();a.clear(),a.updateStat(e,1),a.sunSpriteStat(this.oldStat,1),a.getFirstSpriteStat()?this.statTempMap.set(t,a):this.endShow()}}},showFightAmount:function(e){if((this.showing||e)&&this.tempList&&!(this.tempList.length<1)){var t=this.tempList[0],a=game.mainRoleData.power,i=this.powerTempMap.get(t);if(a<=i)return this.endShow(),void this.clearTempData(t);this.play(i,a),this.powerTempMap.del(t)}},clearCurTempData:function(){this.clearTempData(this.index)},clearTempData:function(e){this.createTempData();var t=this.tempList.indexOf(e);if(!(t<0)){this.tempList.splice(t,1),this.powerTempMap.del(e);var a=this.statTempMap.get(e);a&&(a.clear(),game.SpriteStat.put(a),this.statTempMap.del(e))}},clearAllData:function(){if(this.tempList&&!(this.tempList.length<1))for(var e=void 0,t=this.tempList.length,a=0;a<t;a++)e=this.tempList[a],this.clearTempData(e)},createTempData:function(){this.tempList||(this.tempList=[]),this.statTempMap||(this.statTempMap=b8e.HashMap.get()),this.powerTempMap||(this.powerTempMap=b8e.HashMap.get())},play:function(e,t){if(t<=e);else if(this.oldPower=e,this.nowPower=t,this.parent){if(this.isInit){this.playFightAmount()}}else{var a=b8e.layer.getTopLayer();game.GameViewMgr.inst().showView(this,a,!1,2,!0)}},stopPlay:function(){this.removeFromParent()},init:function(){this.skin.statLab.horizontalAlign=1},onShow:function(){b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageResize),this.playFightAmount()},onHide:function(){b8e.Tween.kill(this),b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onStageResize)},playFightAmount:function(){var e=this;if(e._last=e.oldPower,e._now=e.nowPower,e._curLast=e._last,e._space=Math.floor((e._now-e._last)/15),e._space<=0){this._space=1}if(e.skin){this.skin.add.node.active=!1}var t=150+25*((e._now+"").length+("+"+(e._now-e._last)).length);if(e.width=t<376?376:t,b8e.Tween.kill(e),!e._isPlaying){b8e.Ticker.add(this,this.fightAmountUpdate)}e._isPlaying=!0,e.showSpriteStat(),e.onStageResize()},showSpriteStat:function(){var a=this,e=a.tempList.shift(),t=a.statTempMap.get(e);if(t){var i=a.skin.statLab;i.string="";var n=t.getSpriteStats();if(n){var s=void 0,o=game.SpriteStatType;a.showStatType||(a.showStatType=[o.Health,o.Attack,o.Defense,o.Speed,o.TeamHp,o.TeamAtk,o.TeamDef,o.TeamSpeed]);var r=void 0;n.forEach(function(e,t){t<=0||!a.showAllSp&&a.showStatType.indexOf(e)<0||(e=+e,(s=game.AttrRulesCfg.getData(e))&&2==s.format&&(t=1e4*t/100+"%"),r=game.Lang.get(52399,s.name,t),game.notice.showSpriteStat(r))},a),a.skin.statSpriteNode.x=i.x=a.width/2,t.clear(),game.SpriteStat.put(t),a.statTempMap.del(e)}}else a.updateComplete()},fightAmountUpdate:function(){if(this._last+=this._space,this._last>=this._now){this._last=this._now,this.updateComplete(),this.onStartTween()}this.skin.amount.string=this._last+""},updateComplete:function(){var e=this,t=e.skin.amount.node.x+e.skin.amount.node.width+10,a="+"+(e._now-e._curLast);if(e.skin.add.string=a,e.skin.add.node.x=t,e.skin.add.node.active=!0,e._isPlaying){b8e.Ticker.remove(this,this.fightAmountUpdate)}e._isPlaying=!1,b8e.Tween.kill(e),b8e.Tween.get(e).wait(1e3).call(e._onTweenUpComplete,e)},_onTweenUpComplete:function(){this.stopPlay()},onStartTween:function(){var e=this.skin;if(e.add.node.setAlpha(1),e.add.active=!0,e.add.y=-29,b8e.Tween.kill(e.add),0<this.tweenTime){b8e.Tween.get(e.add).to({y:e.add.y+50,alpha:1},this.tweenTime).to({alpha:0},this.tweenTime).call(this.onEndTween,this,[e.add])}else b8e.Tween.get(e.add).to(null,this.tweenTime).to({alpha:0},this.tweenTime).call(this.onEndTween,this,[e.add])},onEndTween:function(){var e=this.skin;b8e.Tween.kill(e.add),e.add.node.setAlpha(0),this.tweenTime<1&&b8e.Tween.kill(e.add)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height+300))}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$FightAmount",e)}(),function(){var e=game.Control.extends({init:function(){}});b8e.module.registerControl(game.ME.ForgeMasterTips,e)}(),function(){var e=b8e.Object.extends({info:null,ctor:function(){this._super()},setInfo:function(e){this.info=e},getInfo:function(){return this.info},getMasterMaxLv:function(e){var t=game.EquipForgeType,a="";switch(e){case t.INTENSIFY:a="upgradeMasterMaxLv";break;case t.REFINE:a="refineMasterMaxLv";break;case t.PURIFY:a="purifyMasterMaxLv";break;case t.GEM:a="gemStoneMasterMaxLv"}if(""==a){return 0}var i=game.ForgeMiscCfg.getData(a);if(i&&i.value)return 0|i.value;return 0}});game.forgeMasterTipsData=game.forgeMasterTipsData||new e}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1188)},init:function(){var e=this.skin;this.icon_0=b8e.Sprite.get(),this.icon_0.setAnchor(.5,.5),this.icon_0.addToParent(e.masterIcon_0),this.icon_1=b8e.Sprite.get(),this.icon_1.setAnchor(.5,.5),this.icon_1.addToParent(e.masterIcon_1)},onShow:function(){this.itemInfo=game.forgeMasterTipsData.getInfo(),this.setData()},setData:function(){if(this.itemInfo){this._recycleSpriteStat();var e=this.skin,t=null;if(null,e.jieji.string="",e.curPower.string=game.Lang.get(9024),e.ismaster.string=game.Lang.get(6587),e.curNode.active=!1,e.curNode.height=0,t=null){e.nextNode.active=!0,e.nextNode.height=-(e.next_power.y-36),e.greatprogress.active=!0,e.greatprogress.string="("+this.itemInfo.lv+"/"+t.upgradeLv+")",e.power_1.string=game.Lang.get(6585,t.upgradeLv);var a=this._getSpriteStat(t);if(a){this._addSpriteStat(a);var i=game.CCommonUtil.getPower(a);e.next_power.string=game.Lang.get(6588,i),e.spritestate_1.string=this.getSpriteStat(a)}}else e.greatprogress.active=!1,e.nextNode.active=!1,e.nextNode.height=0;e.nextNode.y=e.curNode.y-e.curNode.height,e.tipsbg.height=e.node_1.height+e.curNode.height+e.nextNode.height,e.masterIcon_0.active=!0,e.masterIcon_1.active=!1,this.icon_0.loadTexture(game.ResCfg.getUrl(96,this.itemInfo.type+"icon_0")),this.icon_1.loadTexture(game.ResCfg.getUrl(96,this.itemInfo.type+"icon_1")),this.onStageResize()}else;},getSpriteStat:function(e){var a="";if(e){var i,t=e.getSpriteStats();if(t)return t.forEach(function(e,t){e=+e,i=game.AttrRulesCfg.getData(e),a+=i.name+"+"+t+" "},this),a}else;},_addSpriteStat:function(e){this._spriteStatList||(this._spriteStatList=[]),this._spriteStatList.push(e)},_getSpriteStat:function(e){var t=void 0;return this._spriteStatPool&&0<this._spriteStatPool.length?((t=this._spriteStatPool.shift()).clear(),t.setupByCfg(e)):t=game.SpriteStatUtil.setDataByCfg(e),t},_recycleSpriteStat:function(){if(this._spriteStatList){this._spriteStatPool||(this._spriteStatPool=[]);for(var e=void 0;this._spriteStatList.length;)(e=this._spriteStatList.shift()).clear(),this._spriteStatPool.push(e);this._spriteStatList.length=0}}});b8e.module.registerView(game.ME.ForgeMasterTips,e)}(),function(){var e;e=b8e.Enum({C2V_CHANGE_CARD:-1,C_SDK_SHARE:-1,V_UPDATE_QUICK:-1,V2C_SHOW_VIEW:-1,C2V_CHANGE_EA:-1,C2C_UPDATE_QUICK:-1,C2C_UPDATE_TOTAL_TIME:-1,C2C_REQUEST_RANKINFO:-1,C2C_GUAJI_GET_AWARD:-1,V2C_OPEN_ROLE_UP:-1,V_SHOW_INS_SUCCESS:-1}),b8e.RC("$$game","$$GuajiEvts",e)}(),function(){var e=game.Control.extends({guajiData:null,nextTotalTime:0,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.QUICK_FITHG),this.guajiData=game.guajiData},ipc:function(){var e=this;e.evts={Recharge:{C_INIT_MODEL:e.changeCard,C_RECHARGE_SUCCESS:e.updateItemInfo,C2C_CHANGE_CARD:e.changeCard},ShareView:{C2C_SHARE_SUCCESS:e.shareSuccess},Back:{C_BACK_UPDATE_ITEMINFO:e.updateItemInfo},WorldMap:{C_MAP_CHANGE:e.updateEA},MainInstance:{C_GET_MAIN_INSTANCE_AWARDS:e.updateEA,C2C_SYNC_MAIN_INSTANCE:e.checkAlert},MainRole:{C_INIT_MSIC_DATA:e.initMsicData,C_RESET_DAILY:e.resetDaily},YongzheWelfare:{C2C_UPDATE_WORLD_LV:e.updateEA},PrivilegeShop:{C2C_PRIVILEGE_UPDATE:e.updatePrivilege},WanFaZhiYin:{C_UPDATE_GJ:e.updateGJ}},e.handels={GuajiMsg:e.guajiMsg,ShareHangUpAwardResp:e.shareHangUpAwardResp,QuickBattleResp:e.quickBattleResp,GuaJiAwardResp:e.guaJiAwardResp}},triggerOpen:function(e){e==game.ME.QuickBattle&&this.checkAlert()},notify:function(e){switch(e){case this.Evts.V2C_SHOW_VIEW:this.reqRankLevel(),this.sender.GuaJiAwardReq(1);break;case this.Evts.V2C_OPEN_ROLE_UP:this.dpt(this.Evts.V_SHOW_INS_SUCCESS)}},resetDaily:function(){game.mainInstanceData.resetDaily()},updatePrivilege:function(){game.mainInstanceData.setPrivilegeCount(),this.send(this.Evts.V_UPDATE_QUICK)},guaJiAwardResp:function(e){var t=e.readProtobuf(game.pb.GuaJiAwardResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=0;1==t.types?(this.send(this.Evts.C2V_PRE_AWARDS,t.guaJiExp,t.guaJiAwards,t.guaJiTotalTime),a=t.guaJiTotalTime,game.guajiData.setTotalTime(a),this.updateTotleTime(),this.dpt(this.Evts.C2C_UPDATE_TOTAL_TIME)):(game.ServerItemUtil.analyzeGuajiItems(t.guaJiExp,t.guaJiAwards,1),game.module.hide(this.moduleEnum),game.guajiData.setTotalTime(a),this.updateTotleTime(),this.dpt(this.Evts.C2C_GUAJI_GET_AWARD),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))}},updateItemInfo:function(){this.checkAlert(),this.send(this.Evts.V_UPDATE_QUICK)},updateGJ:function(){this.reqRankLevel(),this.sender.GuaJiAwardReq(1)},updateEA:function(){this.send(this.Evts.C2V_CHANGE_EA)},reqRankLevel:function(){this.dpt(this.Evts.C2C_REQUEST_RANKINFO,game.RankType.RankLevel)},initMsicData:function(){this.updateTotleTime()},updateTotleTime:function(){var e=game.guajiData.clientTotalTime,t=game.guajiData.getNeedTimeList();if(t&&!(t.length<1)){for(var a=0,i=t.length,n=0;n<i;n++)if(e<t[n]){a=t[n]-e,this.nextTotalTime=t[n];break}var s=this.timer;0<a?s?(s.delay=a,s.reset(),s.start()):s=this.timer=b8e.Timer.add(this,this.updateTime,a,1):s&&s.stop()}},updateTime:function(){game.guajiData.setClientTotalTime(this.nextTotalTime),this.dpt(this.Evts.C2C_UPDATE_TOTAL_TIME),this.updateTotleTime()},quickBattleResp:function(e){var t=e.readProtobuf(game.pb.QuickBattleResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.mainInstanceData;a.privilegeQuickCount<a.privilegeCount&&a.privilegeQuickCount++,a.quickCount++,a.quickBattleTotalTimes++,a.isQuickBattle=!0,a.setQuickBattleAward(t.userItem,t.exp),this.checkAlert(),this.send(this.Evts.V_UPDATE_QUICK),this.dpt(this.Evts.C2C_UPDATE_QUICK),b8e.evt.dptG(game.PushTipEvts.C2C_FINISH_CHOUJIANG,game.ME.QuickBattle)}},shareHangUpAwardResp:function(e){var t=e.readProtobuf(game.pb.ShareHangUpAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.module.hide(this.moduleEnum),this.send())},guajiMsg:function(e){var t=e.readProtobuf(game.pb.GuajiNotify);this.guajiData.offlineTime=t.offlineTime,this.guajiData.silver=t.silver,this.guajiData.equips=t.equips,this.guajiData.exp=t.exp,this.guajiData.items=t.items,game.moduleDelay.checkDelayModule(this.moduleEnum)&&game.module.show(this.moduleEnum,null,!1)},checkAlert:function(){var e=game.guajiData.checkAlert();this.spotAlert.alert=e&&game.moduleOpen.checkOpen(game.ME.QuickBattle)},shareSuccess:function(){},openBoxBtn:function(){this.dpt(this.Evts.C_SDK_SHARE)},changeCard:function(){this.send(this.Evts.C2V_CHANGE_CARD)},lookMonthBtn:function(){this.buyMonthBtn()},lookForeverBtn:function(){this.buyMonthBtn()},buyForeverBtn:function(){this.buyMonthBtn()},buyMonthBtn:function(){game.moduleOpen.checkOpenWithTips(game.ME.MonthCard)&&(game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.MONTH_CARD),game.module.hide(this.moduleEnum))},vipBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP),game.module.hide(game.ME.QuickBattle)},monthBtn:function(){this.buyMonthBtn()},foreverBtn:function(){this.buyMonthBtn()},quickBattleBtn:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){var e=game.mainInstanceData,t=e.maxQuickFreeCount,a=+game.CfgUtil.getMiscValue(game.HangUpMiscCfg,"quickBattleItemID"),i=game.itemData.getNumById(a);if(e.quickCount>=e.maxQuickCount)return game.mainInstanceData.privilegeCount<=0?void game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.PRIVILEGE):void game.notice.show(51516);var n=!1;if(e.privilegeQuickCount<e.privilegeCount)this.sender.QuickBattleReq(n);else{if(t<=e.quickCount)if(i)n=!0;else if(!game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,this.getCostCount()))return;this.sender.QuickBattleReq(n)}}},getCostCount:function(){for(var e=+game.CfgUtil.getMiscValue(game.HangUpMiscCfg,"quickBattleItemID"),t=(game.itemData.getNumById(e),game.QuickBattleCostCfg.getDatas()),a=0,i=0,n=t.length;i<n;i++)game.mainInstanceData.quickCount-game.mainInstanceData.privilegeQuickCount>=t[i].num&&(a=t[i].gold);return a},getBtn:function(){game.UpgradeUtil.checkEquipTooMuch()||this.sender.GuaJiAwardReq(2)},mCardActiveLab:function(){this.activeGo(game.CardType.MONTH)},fCardActiveLab:function(){this.activeGo(game.CardType.FOREVER)},activeGo:function(e){var t=game.rechargeData.getCardInfoByType(e);(e==game.CardType.FOREVER?t:t&&t.expireTime>game.SysTime.curTime)||game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.MONTH_CARD)},gotoBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.PRIVILEGE)},quickBattlrHelpBtn:function(){game.RuleView.inst().showView(game.ME.QuickBattle)}}),t=[game.ME.GuajiUp,game.ME.QuickBattle,game.ME.QuickBattleAward],a=game.Sender.extends({ipc:function(){this.msg={ShareHangUpAwardReq:null,QuickBattleReq:this.quickBattleReq,GuaJiAwardReq:this.guaJiAwardReq}},quickBattleReq:function(e){var t=game.pb.QuickBattleRequest;t.useItem=e,this.write(t)},guaJiAwardReq:function(e){var t=game.pb.GuaJiAwardRequest;t.types=e,this.write(t)}});b8e.module.registerControl(game.ME.Guaji,e,game.GuajiEvts,a,t)}(),function(){var e=b8e.Object.extends({offlineTime:0,silver:0,equips:0,exp:0,items:null,clientTotalTime:0,totalTime:0,isShowTips:!1,checkAlert:function(){return game.mainInstanceData.privilegeQuickCount<game.mainInstanceData.privilegeCount||game.mainInstanceData.maxQuickFreeCount>game.mainInstanceData.quickCount},setMiscData:function(e){this.clientTotalTime=e.guaJiTotalTime},shopTips:function(){if(!this.isShowTips){this.isShowTips=!0;var e=game.CfgUtil.getMiscValue(game.HangUpMiscCfg,"tipsNeedTime");this.clientTotalTime>=e&&game.alert.show({lang:53062,btn:game.Lang.get(53061),okcb:this.showGuaji,thisArg:this})}},showGuaji:function(){game.module.show(game.ME.GotoBattle)},setTotalTime:function(e){this.clientTotalTime=this.totalTime=e},setClientTotalTime:function(e){this.clientTotalTime=e},getNeedTimeList:function(){if(this.timeList)return this.timeList;var e=game.CfgUtil.getMiscValue(game.HangUpMiscCfg,"timeState");if(!e)return null;var t=e.split("|");if(!t||t.length<1)return null;this.timeList=[];for(var a=t.length,i=0;i<a;i++)this.timeList.push(+t[i]);return this.timeList},getBoxAnima:function(e){return this.boxAnimaArr||(this.boxAnimaArr=this.getToInitArr("boxAnima")),+this.boxAnimaArr[e]},getGoldAnima:function(e){return this.goldAnimaArr||(this.goldAnimaArr=this.getToInitArr("goldAnima")),+this.goldAnimaArr[e]},getBoxWidth:function(e){return this.boxWidthArr||(this.boxWidthArr=this.getToInitArr("boxWidth")),+this.boxWidthArr[e]},getBoxAnimaX:function(e){return this.boxAnimaXArr||(this.boxAnimaXArr=this.getToInitArr("boxAnimaX")),+this.boxAnimaXArr[e]},getBoxX:function(e){return this.boxXArr||(this.boxXArr=this.getToInitArr("boxX")),+this.boxXArr[e]},getToInitArr:function(e){var t=game.CfgUtil.getMiscValue(game.HangUpMiscCfg,e);return t?t.split("|"):[]}});game.guajiData=game.guajiData||new e}(),function(){var e=game.View.extends({guajiData:null,_str:"",_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(1187)},init:function(){var e=this.skin,t=this.prizeList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.PrizeListItem,t.addToParent(e.list),t.layout.paddingLeft=0,t.layout.spacingX=45,t.layout.spacingY=15,this._prizeInfoList=[],this.posArray=[253,183,117,45]},notify:function(e,t,a,i){switch(e){case this.Evts.C2V_CHANGE_CARD:this.changeCard();break;case this.Evts.C2V_PRE_AWARDS:this.updatePrizeList(t,a),this.setTotalTime(i);break;case this.Evts.C2V_CHANGE_EA:this.updateEA()}},onShow:function(){this.send(this.Evts.V2C_SHOW_VIEW),this.changeCard()},onHide:function(){this.stopTime();for(var e=this._prizeInfoList,t=e.length,a=0;a<t;a++)e[a].release();e.length=0,this.prizeList.setData(e)},changeCard:function(){var e=void 0,t=this.skin,a=game.rechargeData.getCardInfoByType(game.CardType.MONTH),i=game.rechargeData.getCardInfoByType(game.CardType.FOREVER),n=a&&a.expireTime>game.SysTime.curTime,s=i;e=game.rechargeData.getCardRechargeCfg(game.CardType.MONTH);var o=game.Lang.get(52404),r=game.Lang.get(52405);t.mCardDesc.string=e?game.Lang.get(52406,e.addExpRate):"",t.mCardActiveLab.string=n?o:r,e=game.rechargeData.getCardRechargeCfg(game.CardType.FOREVER),t.fCardDesc.string=e?game.Lang.get(52407,e.addExpRate):"",t.fCardActiveLab.string=s?o:r,this.updateEA()},updatePrizeList:function(e,t){var a=this,i=a.skin;if(e||t&&!(t.length<1)){if(a.tempList1||(a.tempList1=[]),a.tempList1.length=0,a.tempList2||(a.tempList2=[]),a.tempList2.length=0,i.emptyNode.active=!1,0<e){var n=game.ItemInfo.get();n.id=220001,n.num=e,n.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,a.tempList1.push(n)}if(t&&0<t.length){for(var s=void 0,o=t.length,r=0;r<o;r++)s=t[r],(n=game.ItemInfo.get()).setData(s),n.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,23==s.id||21==s.id?a.tempList1.push(n):a.tempList2.push(n);a.tempList1.sort(a.onSort),a.tempList2.sort(a.onSort),a._prizeInfoList=a.tempList1.concat(a.tempList2),a.tempList1.length=0,a.tempList2.length=0}a.prizeList.setData(a._prizeInfoList);var g=a._prizeInfoList.length,l=g>a.posArray.length?a.posArray[3]:a.posArray[g-1];a.skin.list.setPosition(l,-353)}else i.emptyNode.active=!0},onSort:function(e,t){return e.quality!=t.quality?t.quality-e.quality:e.id-t.id},setTotalTime:function(e){if(!(e<0)){var t=game.VipCfg.getData(game.mainRoleData.vipLevel);this.totalTime=e,this.maxTime=60*t.offlineTime*1e3,this.updateTime(),this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.updateTime,1e3)}},updateTime:function(){this.totalTime+=1e3;var e=void 0;this.maxTime<=this.totalTime?(e=this.maxTime,this.stopTime()):e=this.totalTime;var t=b8e.TimeUtil.formatTime(e);this.skin.totalTime.string=game.Lang.get(52408,t)},stopTime:function(){this.timer&&this.timer.stop()},updateEA:function(){var t=this.skin,e=game.rechargeData.getCardInfoByType(game.CardType.MONTH),a=game.rechargeData.getCardInfoByType(game.CardType.FOREVER),i=e&&e.expireTime>game.SysTime.curTime,n=a,s=void 0,o=1;(s=game.rechargeData.getCardRechargeCfg(game.CardType.MONTH))&&i&&(o+=.01*s.addExpRate),(s=game.rechargeData.getCardRechargeCfg(game.CardType.FOREVER))&&n&&(o+=.01*s.addExpRate);var r=.01*game.yongzheData.getExpBonus();o+=r,game.mainInstanceData.getInstanceCfg(function(e){e&&(t.getGoldCount.string=game.Lang.get(52409,game.CCommonUtil.replaceNum(e.silver*o*(60/e.interval))),t.getExpCount.string=game.Lang.get(52409,game.CCommonUtil.replaceNum(e.exp*o*(60/e.interval))))},this)},closeBtn:function(){this._super(),game.sdk.subscribeApp()}});b8e.module.registerView(game.ME.Guaji,e)}(),function(){var e=game.View.extends({ctor:function(){this._super("guaji/GuajiUpView")},init:function(){this.skin},onShow:function(){var a=this,i=a.skin;game.mainInstanceData.getInstanceCfg(function(t){game.InstanceCfg.getDataAsync(t.id-1,function(e){t&&e?(i.coinLab1.string=game.CCommonUtil.replaceNum(e.silver*(60/e.interval)),i.expLab1.string=game.CCommonUtil.replaceNum(e.exp*(60/e.interval)),i.coinLab2.string=game.Lang.get(52410,game.CCommonUtil.replaceNum(t.silver*(60/t.interval))),i.expLab2.string=game.Lang.get(52410,game.CCommonUtil.replaceNum(t.exp*(60/t.interval))),i.titleLab.string=t.name):game.module.hide(a.moduleEnum)},a)},a),i.guajiNode.setAlpha(0),b8e.Tween.get(i.guajiNode).to({alpha:1},1e3).call(a.showDelite,a)},showDelite:function(){var e=this.skin;b8e.Tween.get(e.guajiNode).wait(3e3).to({alpha:0},1e3).call(this.hideDelite,this)},hideDelite:function(){game.module.hide(this.moduleEnum)},onHide:function(){var e=this.skin;b8e.Tween.kill(e.guajiNode)}});b8e.module.registerView(game.ME.GuajiUp,e)}(),function(){var e;e=b8e.Enum({NONE:0,BOTTOM_SELECT_INDEX_CHANGE:-1,ALERT_DEMO_1:-1,ALERT_DEMO_2:-1,V_LEVEL_CHANGE:-1,V_EXP_CHANGE:-1,V_AMOUNT_CHANGE:-1,V_POWER_CHANGE:-1,V_VIP_CHANGE:-1,V_AUTOFIGHT:-1,V_UPDATERIGHTVIEW_STAR:-1,V_SHOW_HONGYAN:-1,V_MAP_CHANGE:-1,C_AUTO_FIGHT_CHANGE:-1,C_UPDATE_CENTER_BAR:-1,C_CLICK_ENLIST:-1,HIDELOGINAWARDS:-1,C_COLLECT_NEXT_REDPACKET:-1,C2V_JINJIERANK_CHANGE:-1,V_SHOW_MAIN_LEFT_VIEW:-1,V_SHOW_MAIN_RIGHT_VIEW:-1,V_REFRESH_BTNS:-1,C2V_CHANGE_CARD:-1,V_FOLLOW_CHAT:-1,CLICKINSTANCEBTN:-1,CLOSE_INSTANCE_AUTOFIGHT:-1,V_SHOW_MAIN_ACTIVITY_NOTICE_VIEW:-1,C2C_REFRESH_BTNS:-1,V_FIRST_DIAMON:-1,C2V_HIDE_CARD:-1,C2V_SHOW_CARD:-1,V_HONGYAN_CHANGE:-1,CLOSE_AUTO_FIGHT:-1,V2C_SHOW_VIEW:-1,C2C_SHOW_MHM_VIEW:-1,C_GO_HOME:-1,C_SHOWBUBLLE:-1,C_HIDEBUBLLE:-1,C_SHOW_OCCUPIED_SNATCH:-1,NOT_OPEN_UI:-1,C2C_SELECT_VIPBOSS:-1,C_GO_BATTLE:-1,V_CHAT_CHANGE:-1,SHOW_HOME_BTN:-1,SHOW_FIGHT_BTN:-1,C2V_UPDATE_ROLE_INFO:-1,MODULE_CHANGE:-1,C2V_UPDATE_ROLE_LV:-1,BIND_FLY_BOTTOM_BTN_POS:-1,C2V_BEGINPLAYANI:-1,C_BEGINPLAYANI:-1,SHOW_CHANGE_EFF:-1,C2V_ONCLICK_EDITORBOX:-1,V_SET_HONGYAN_OPEN:-1,C2V_UPDATE_ICON:-1,V2C_GET_GROUP_AWARDS:-1,CV2_GET_GROUP_AWARDS:-1,C2V_SHOW_RESEARCH:-1,C2V_UPDATE_GUAJI_BOX:-1,C2V_UPDATE_AUTO_BATTLE:-1,C2V_UPDATE_BOSS_BTN:-1,C2C_BOSS_BATTLE:-1,C2C_AUTO_BOSS_BATTLE:-1,C2V_GUAJI_GET_AWARD:-1,BIND_FLY_TASK_BTN_POS:-1,C_REQ_ENTER_TEAM:-1,C2V_WUSHENG_TIPS:-1,V_SET_HONGYAN_HIDE:-1}),b8e.RC("$$game","$$MainUIEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Back:{C_UPDATE_AMOUNT:this.updateAmount},Welcome:{V_FIRSTANIM_DIAMON:this.animEffect},InstanceSuccess:{C2C_EFFECT:this.animEffect},MainRole:{C_SPRITE_STATE_CHANGE:this.updateFightAmount}}},updateFightAmount:function(){this.send(this.Evts.C2V_UPDATE_ROLE_INFO)},moneyBtn:function(){game.module.show(game.ME.GetYinLiang)},goldBtn:function(){b8e.isWeChatGame&&b8e.os===b8e.OS.IOS&&(game.moduleOpen.checkOpen(game.ME.Recharge)||game.notice.show(9382)),game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},updateAmount:function(){this.send(this.Evts.V_AMOUNT_CHANGE)},animEffect:function(e){var t=e?e.data:null;t&&this.send(this.Evts.V_FIRST_DIAMON,t)}});b8e.module.registerControl(game.ME.MainUITopFightAmount,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({fightAlert:null,roleAlert:null,init:function(){this.fightAlert=game.spotAlert.set(game.SAE.FIGHT),this.roleAlert=game.spotAlert.set(game.SAE.ROLE)},ipc:function(){var e=this;e.evts={MainRole:{C_EXP_CHANGE:e.updateExp},TeamHandel:{C_TEAM_CREATE:e.stopAutoBattle,C_TEAM_JOIN:e.stopAutoBattle,C_TEAM_QUICK_JOIN:e.stopAutoBattle},Home:{C2C_SHOW_VIEW:e.showZhanYi,C2C_HIDE_VIEW:e.showJiaYuan},PartnerStar:{C_SHOW_FIGHT:e.showZhanYi},ModuleOpen:{BIND_FLY_BOTTOM_BTN_POS:e.bindFlyBtnPos}},e.gevts={SceneGEvts:{LEAVE_XEPLORE_SCENE:e.showJiaYuan}}},notify:function(e){switch(e){case this.Evts.C2V_BEGINPLAYANI:this.dpt(this.Evts.C_BEGINPLAYANI)}},bindFlyBtnPos:function(e){if(e&&e.data){var t=e.data;b8e.module.isShowView(this.moduleEnum)?this.send(this.Evts.BIND_FLY_BOTTOM_BTN_POS,t):(game.moduleOpenData.bindFlyAnimBtnPos=null,this.dpt(this.Evts.C_BEGINPLAYANI))}},showBubble:function(){},stopAutoBattle:function(){this.dpt(game.MainUIEvts.CLOSE_INSTANCE_AUTOFIGHT,0)},updateExp:function(e){if(e&&e.data){var t=e.data;this.send(game.MainUIEvts.V_EXP_CHANGE,t)}},bottomInstfunc:function(){this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,0),game.module.toggleShow(game.ME.InstanceFunc)},bottomBag:function(){game.mainInstanceData.traceLog(11),this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,1),game.module.toggleShow(game.ME.Back)},bottomDuanZao:function(){this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,2),game.module.toggleShow(game.ME.EquipForge)},showZhanYi:function(){this.send(this.Evts.SHOW_FIGHT_BTN)},showJiaYuan:function(){this.send(this.Evts.SHOW_HOME_BTN)},bottomZhanYi:function(){game.GameViewMgr.inst().hideUnStrongViews(!1),this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,3),this.dpt(this.Evts.C_GO_BATTLE),this.send(this.Evts.SHOW_HOME_BTN),this.send(this.Evts.SHOW_CHANGE_EFF)},bottomJiaYuan:function(){b8e.module.isShowView(game.ME.SceneRevive)?game.notice.show(53228):(game.GameViewMgr.inst().hideUnStrongViews(!1),this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,3),game.module.toggleShow(game.ME.Home),this.dpt(this.Evts.C_GO_HOME),this.send(this.Evts.SHOW_FIGHT_BTN),this.send(this.Evts.SHOW_CHANGE_EFF))},bottomHongYan:function(){game.mainInstanceData.traceLog(12),this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,4),game.module.toggleShow(game.ME.Partner),game.module.hide(game.ME.PartnerBackOp),game.module.hide(game.ME.PartnerBack)},bottomWuJiang:function(){this.send(game.MainUIEvts.V_SHOW_HONGYAN)},bottomZhaohuan:function(){if(this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,6),1==game.mainInstanceData.id)return game.sdk.traceLog(5),void game.module.show(game.ME.RecruitSubA);game.module.toggleShow(game.ME.RecruitMain)},publicBoss:function(){var e=game.bossData;this.send(game.MainUIEvts.C_HIDEBUBLLE),game.module.hide(game.ME.VipBossChallenge),game.module.showToggle(game.ME.Boss,e.openToggle);var t=e.vipLv;t&&this.dpt(this.Evts.C2C_SELECT_VIPBOSS,t)}});b8e.module.registerControl(game.ME.MainUIBottom,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){var e=this;e.gevts={MainInstanceEvts:{G_AUTO_PASS_END:e.autoBattleBtn}},e.evts={House:{C_SHOW_HOUSE_ICON:e.showHouseIcon,C_HIDE_HOUSE_ICON:e.hideHouseIcon},RedPacket:{C_SHOW_REDPACKET_ICON:e.showRedPacketIcon,C_HIDE_REDPACKET_ICON:e.hideRedPacketIcon},Welfare:{C_INIT_MODEL:e.showAnnouncement,C2C_SHOW_ANNOUNCEMENT:e.hideAnnouncement},Escort:{C2C_CHANGE_ESCORT_ICON:e.changeEscortIcon},EscortLog:{C2C_CHANGE_ESCORT_ICON:e.changeEscortIcon},EscortList:{C2C_ESCORT_START:e.changeEscortIcon},WorldWarTeam:{C2C_CHANGE_TEAM_STATE:e.changeWorldWarTeam},WorldWar2Team:{C2C_CHANGE_TEAM_STATE:e.changeWorldWar2Team},ThousandTowerTeam:{C2C_CHANGE_TEAM_STATE:e.changeQianCengTeam},WorldChallenge:{C_SHOW_WORLD_CHALLENGE:e.changeWorldChallenge},Occupied:{C_SHOW_OCCUPIED:e.changeOccupied},CsOverlord:{C_SHOW_CSOVERLORD:e.changeCsOverlord},Mail:{C_SHOW_MAIL:e.changeMailIcon},Guild:{C_INIT_MODEL:e.showAssist},TribalBattle:{C_UPDATE_ASSIST:e.showAssist},Guaji:{C2C_UPDATE_TOTAL_TIME:e.updateGuaji,C2C_GUAJI_GET_AWARD:e.guajiGetAward},MainRole:{C_INIT_MSIC_DATA:e.updateGuaji,C_LEVEL_UP:e.levelUp},MainInstance:{C_GET_MAIN_INSTANCE_AWARDS:e.updateRewBoxRedPoint,C2C_SYNC_MAIN_INSTANCE:e.syncMainInstance,BOSS_BATTLE_FAIL:e.bossBattleFail,C2C_CHALLENGE_WIN:e.setBattleWin},InstanceSuccess:{V_SHOW_INS_SUCCESS:e.stopPlay},ModuleOpen:{BIND_FLY_TASK_BTN_POS:e.onBindFlyTaskBtnPos},MainUIChat:{C_WORLDWAR_INVITE:e.showWorldWarInvite},WuShengMain:{C_SHOW_TIPS:e.showWuShengTips}}},notify:function(e){switch(e){case this.Evts.BIND_FLY_TASK_BTN_POS:this.dpt(this.Evts.C_BEGINPLAYANI)}},showWuShengTips:function(){var e=game.wushengData;game.mainCenterData.wuShengCurId!=e.curId&&(game.mainCenterData.wuShengCurId=e.curId,this.send(this.Evts.C2V_WUSHENG_TIPS))},onBindFlyTaskBtnPos:function(){this.send(this.Evts.BIND_FLY_TASK_BTN_POS)},showWorldWarInvite:function(){var e=game.chatData.worldWarNewsArr;if(e){var t=0<e.length;game.mainCenterData.worldWarInviteActive=t,this.send(this.Evts.C_UPDATE_CENTER_BAR)}},changeMailIcon:function(){var e;e=0<game.mailData.needReadCount(),game.mainCenterData.mailActive=e,this.send(this.Evts.C_UPDATE_CENTER_BAR)},showAssist:function(){var e=game.tribalResearchData.getAssistList().length,t=game.TribesTechMiscCfg.getData("tribesTechDailyNum"),a=0;t&&(a=t.value-game.tribalResearchData.assistantNum),game.mainCenterData.assistActive=!!(0<e&&0<a),this.send(this.Evts.C_UPDATE_CENTER_BAR)},showEnlistIcon:function(){game.mainCenterData.enlistActive=!0,this.send(this.Evts.C_UPDATE_CENTER_BAR)},hideEnlistIcon:function(){game.mainCenterData.enlistActive=!1,this.send(this.Evts.C_UPDATE_CENTER_BAR)},showHouseIcon:function(){game.mainCenterData.houseActive=!0,this.send(this.Evts.C_UPDATE_CENTER_BAR)},hideHouseIcon:function(){game.mainCenterData.houseActive=!1,this.send(this.Evts.C_UPDATE_CENTER_BAR)},showRedPacketIcon:function(){game.mainCenterData.redPacketActive=!0,this.send(this.Evts.C_UPDATE_CENTER_BAR)},hideRedPacketIcon:function(){game.mainCenterData.redPacketActive=!1,this.send(this.Evts.C_UPDATE_CENTER_BAR)},showAnnouncement:function(){if(this.first);else this.first=!0,game.mainCenterData.announcementActive=!0,this.send(this.Evts.C_UPDATE_CENTER_BAR)},hideAnnouncement:function(){game.mainCenterData.announcementActive=!1,this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeEscortIcon:function(){game.mainCenterData.escortActive=game.escortData.mainViewAlert(),this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeWorldWarTeam:function(){game.mainCenterData.worldWarActive=game.worldWarData.isInTeam,this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeWorldWar2Team:function(){game.mainCenterData.worldWar2Active=game.worldWar2Data.isInTeam,this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeQianCengTeam:function(){game.mainCenterData.qianCengActive=game.thousandTowerData.isInTeam,this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeJuntuan:function(){var e=game.csGuildBossData;game.mainCenterData.juntuan=e.reliveTime<1&&e.enterBtnShow&&game.moduleOpen.checkOpen(game.ME.CsGuild),this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeWorldChallenge:function(){game.mainCenterData.worldChallenge=game.worldChallengeData.checkOpenApply(),this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeCsOverlord:function(){game.mainCenterData.csOverlord=game.csOverlordData.checkCanApply(),this.send(this.Evts.C_UPDATE_CENTER_BAR)},changeOccupied:function(){this.send(this.Evts.C_UPDATE_CENTER_BAR)},enlist:function(){},MailBtn:function(){game.module.show(game.ME.Mail)},houseBtn:function(){game.module.show(game.ME.HouseRec)},redPacketBtn:function(){this.dpt(this.Evts.C_COLLECT_NEXT_REDPACKET)},announcementBtn:function(){game.module.showToggle(game.ME.Welfare,game.WelfareType.ANNOUNCEMENT)},escortBtn:function(){},escortRevenge:function(){game.module.show(game.ME.EscortLog)},escortRate:function(){game.module.show(game.ME.Escort)},escortFinish:function(){game.module.show(game.ME.Escort)},worldWarInviteBtn:function(){var e=game.chatData.worldWarNewsArr;e&&(this.dpt(this.Evts.C_REQ_ENTER_TEAM,e[0]),e.splice(0,1),game.mainCenterData.worldWarInviteActive=0<e.length,this.send(this.Evts.C_UPDATE_CENTER_BAR))},worldWarBtn:function(){game.worldWarData.isInTeam?b8e.module.isShowView(game.ME.WorldWarTeamDetailsView)||game.module.show(game.ME.WorldWarTeamDetailsView):game.module.show(game.ME.WorldWarTeam)},juntuanBtn:function(){game.module.show(game.ME.CsGuild)},worldChallengeBtn:function(){game.module.showToggle(game.ME.ArenaMain,2)},ocBtn:function(){this.dpt(this.Evts.C_SHOW_OCCUPIED_SNATCH)},worldWar2Btn:function(){game.worldWar2Data.isInTeam?b8e.module.isShowView(game.ME.WorldWar2TeamDetailsView)||game.module.show(game.ME.WorldWar2TeamDetailsView):game.module.show(game.ME.WorldWar2Team)},qianCengBtn:function(){game.module.show(game.ME.ThousandTowerTeam)},csOverlordBtn:function(){game.module.showToggle(game.ME.ArenaMain,4)},assistBtn:function(){game.module.show(game.ME.TribalAssist)},guajiBox:function(){game.module.show(game.ME.Guaji)},updateGuaji:function(){this.send(this.Evts.C2V_UPDATE_GUAJI_BOX)},updateRewBoxRedPoint:function(){this.send(this.Evts.C2V_UPDATE_REWARD_REDPOINT)},fastFightBtn:function(){game.module.show(game.ME.QuickBattle)},bossBattleBtn:function(){var a=this,e=game.mainInstanceData.id;1==e?game.sdk.traceLog(7):2==e&&game.sdk.traceLog(13),game.mainInstanceData.canFightByLv(function(e){if(e){var t=game.mainCenterData.nextBattleTime-game.SysTime.curTime;0<t?game.notice.show(53022,Math.floor(t/1e3)):a.dpt(a.Evts.C2C_BOSS_BATTLE)}else game.module.show(game.ME.WanFaZhiYin)},a,!0)},bossBattleFail:function(){game.mainCenterData.isAutoFight=!1,this.send(this.Evts.C2V_UPDATE_AUTO_BATTLE)},autoBossBattle:function(){var t=this;game.mainInstanceData.canFightByLv(function(e){if(game.mainCenterData.isAutoFight){if(!e||!t.canBossBattle())return game.mainCenterData.isAutoFight=!1,void t.send(t.Evts.C2V_UPDATE_AUTO_BATTLE);t.dpt(t.Evts.C2C_AUTO_BOSS_BATTLE)}},t,!0)},canBossBattle:function(){return!game.playBack.isInstanceFighting(!1)&&(!game.sceneData.isGuildMap()&&(!game.sceneData.isCsScene()&&(!game.exploreScene.isInExploreScene()&&!game.UpgradeUtil.checkEquipTooMuch())))},autoBattleBtn:function(){var a=this,i=game.mainInstanceData;game.InstanceCfg.getDataAsync(i.autoPassOpenId,function(e){if(e)if(i.canOpenAutoPass()){var t=game.mainCenterData;t.isAutoFight=!t.isAutoFight,t.isAutoFight||game.notice.show(51877),t.isAutoFight&&(!t.nextBattleTime||t.nextBattleTime<game.SysTime.curTime)&&a.autoBossBattle(),a.send(a.Evts.C2V_UPDATE_AUTO_BATTLE)}else game.notice.show(51619,e.name)},a)},syncMainInstance:function(){game.mainCenterData.nextBattleTime=1e3*game.mainInstanceData.nextBattleTime,this.send(this.Evts.C2V_UPDATE_BOSS_BTN)},setBattleWin:function(){this.needCountdown=!0},stopPlay:function(e){var t=e.data;t&&t.type==game.InstanceType.CHUANG_GUAN&&this.needCountdown&&(this.needCountdown=!1,game.mainInstanceData.getInstanceCfg(this.startBattle,this))},guajiGetAward:function(){this.send(this.Evts.C2V_GUAJI_GET_AWARD)},startBattle:function(e){if(e){var t=1e3*game.mainInstanceData.nextBattleTime,a=game.mainCenterData.nextBattleTime=game.SysTime.curTime+1e3*e.battleCd,i=a<t?t:a;this.createCountdown(i)}},levelUp:function(){this.send(this.Evts.C2V_UPDATE_BOSS_BTN)},createCountdown:function(e){var t=e-game.SysTime.curTime;b8e.removeTimeout(this.autoBossBattle,this),b8e.setTimeout(this.autoBossBattle,this,t),this.send(this.Evts.C2V_UPDATE_BOSS_BTN)},detailBtn:function(){game.module.show(game.ME.MainInstanceReward)},wushengBtn:function(){game.module.showToggle(game.ME.ShareMain,0)}});b8e.module.registerControl(game.ME.MainCenter,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({init:function(){this.broadcastChat={chatType:game.ChatChannelType.SYSTEM,funcType:game.pb.ChatFuncType.CHAT_FUNC_MARQUEE,content:""},this.lastHisChannel=-1,this.chat={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"fake_master",funcType:game.ChatFuncType.CHAT_FUNC_MASTER_FAKE},this.tipsChat={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"",funcType:game.ChatFuncType.CHAT_FUNC_TIPS}},ipc:function(){var e=this;e.gevts={SceneGEvts:{FIRST_ENTER_SCENE:e.reqChatHistory},ViewModuleEvts:{MODULE_CHANGE:e.moduleChange},ChatEvts:{SHOW_FUNC_BTN:e.showFuncBtn,CLOSE_FUNC_BTN:e.closeFuncBtn,SHOW_CLIENT_CHAT:e.showClientChat},InstanceEvts:{G_STOP_PLAY:e.showEndChat}},e.evts={ChatPrivate:{SHOW_TIPS:e.showTips,SHOW_NEW_CHAT:e.showNewChat},MainRole:{C_LEVEL_UP:e.checkLevelUp,C_INIT_SERVER_DATA:e.initServerData},Relation:{C_BLACK_CHANGE:e.changeBlack,C2C_INIT_RELATION:e.reqChatHistory}},e.handels={HistoryChatResp:e.historyChatResponse,ChatResp:e.chatResponse,ChatBroadcast:e.chatNotify,MarqueeMsg:e.marqueeNotify}},changeBlack:function(e){if(e&&e.data){this.send(this.Evts.C2V_BLACK_CHANGE,e.data)}},initServerData:function(){var e=this;e.startTime=game.SysTime.curTime,e.fakeMasterCount=1,e.tipsCount=1,e.fakeMasterSpace=18e5,e.tipsSpace=6e4;var t=game.ChatMiscCfg.getData("tipsTime");t&&(e.tipsSpace=+t.value);var a=e.tipsSpace+1e3;e.timer=b8e.Timer.add(e,e.updateTime,a)},updateTime:function(){var e=game.SysTime.curTime-this.startTime,t=this.checkFakeMaster(e),a=this.checkTipsChat(e);t||a||this.timer&&b8e.Timer.remove(this,this.updateTime)},checkFakeMaster:function(e){return game.miscData.openServerDay<3&&this.fakeMasterCount*this.fakeMasterSpace<=e&&(this.fakeMasterCount++,this.sendFakeMaster(),!0)},checkTipsChat:function(e){return this.tipsCount*this.tipsSpace<=e&&(this.tipsCount++,this.sendTipsChat())},sendFakeMaster:function(){this.chat.params=game.GlobalCfg.getRandomName(!1)+"|"+game.GlobalCfg.getRandomName(!0),game.chatData.addChat(this.chat),this.send(game.ChatEvts.UPDATE_CHANNEL,null)},sendTipsChat:function(){var e=this.getRandomTips();return!!e&&(this.tipsChat.marqueeKey=e,game.chatData.addChat(this.tipsChat),this.send(game.ChatEvts.UPDATE_CHANNEL,null),!0)},getRandomTips:function(){var e=this;if(!e.tipsList){var t=game.ChatMiscCfg.getData("tipsList");if(t){var a=t.value;e.tipsList=a.split(",");for(var i=e.tipsList.length,n=0;n<i;n++)e.tipsList[n]=+e.tipsList[n]}}if(!e.tipsList||e.tipsList.length<1)return"";(!e.tipsTempList||e.tipsTempList.length<1)&&(e.tipsTempList=e.tipsList.slice(0));var s=e.tipsTempList.length,o=Math.floor(Math.random()*s);if(!e.tipsTempList[o])return"";var r=e.tipsTempList[o];e.tipsTempList.splice(o,1);var g=game.ChatTipsCfg.getData(r);return g?g.marqueeKey:""},checkLevelUp:function(){this.send(game.MainUIEvts.V_LEVEL_CHANGE)},showFuncBtn:function(e){var t=e.data.funcType;this.send(game.ChatEvts.SHOW_FUNC_BTN,{funcType:t})},closeFuncBtn:function(e){var t=e.data.funcType;this.send(game.ChatEvts.CLOSE_FUNC_BTN,{funcType:t})},showClientChat:function(e){var t=e.data;this.send(game.ChatEvts.UPDATE_CHANNEL,t)},showEndChat:function(e){var t=e.data,a=game.InstanceType;if(t){switch(t.type){case a.DIANWEI:case a.ARENA:break;default:return}game.chatData.processCacheChat(t),this.send(game.ChatEvts.UPDATE_CHANNEL,null)}else;},reqChatHistory:function(){this.reqChatHistoryFirst||(this.reqChatHistoryFirst=!0,this.sender.HistoryChatReq(game.ChatChannelType.WORLD),b8e.setTimeout(function(){this.sender.HistoryChatReq(game.ChatChannelType.GUILD)},this,1e3))},synChat:function(){},addOneChat:function(e){var t=e.roleId,a=game.relationData;if(a&&a.isInBlackList(t))return;game.chatData.addChat(e)},addChats:function(e,t,a){var i=2<arguments.length&&void 0!==a&&a;if(t!==game.ChatChannelType.PRIVATE||i){if(e&&0<e.length){i&&game.chatData.clearChatDataByChannel(t);var n=e.length;b8e.module.isShowView(game.ME.ChatView)||(game.chatData.unReadNum+=n);for(var s=0;s<n;s++){var o=e[s];o&&(0<t&&(o.chatType=t,t=o.chatType),this.addOneChat(o))}}this.refreshList()}else this.dptG(game.ChatEvts.ADD_PRIVATE,e)},refreshList:function(){this.send(game.ChatEvts.UPDATE_CHANNEL,null)},historyChatResponse:function(e){var t=e.readProtobuf(game.pb.HistoryChatResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.chatContents,i=game.ChatMiscCfg.getData("historyNum");if(i&&i.value){var n=+i.value;a.length>n&&a.splice(n)}a.reverse(),this.addChats(a,t.chatType,!0)}},chatResponse:function(e){var t=e.readProtobuf(game.pb.ChatResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.chatType,i=t.targetRoleId,n=t.content;if(a==game.ChatChannelType.PRIVATE){var s=b8e.ProtobufUtil.createMessage(game.pb.ChatContentProto),o=game.mainRoleData;s.chatType=game.ChatChannelType.PRIVATE,s.content=n,s.roleId=o.id,s.targetRoleId=i,s.isMale=o.isMale,s.vipLevel=o.vipLevel,b8e.evt.dptG(game.ChatEvts.ADD_SELF_PRIVATE_CHAT,s)}else{var r=game.SysTime.curTime;game.chatData.setLastSendTimeByChannel(a,r)}}},chatNotify:function(e){var t=e.readProtobuf(game.pb.ChatNotify);if(0<t.code){game.notice.noticeError(t.code)}else{var a=[];a.push(t.chatContent),this.addChats(a,t.chatContent.chatType),t.chatContent.funcType==game.ChatFuncType.CHAT_GUILD_BOSS2_OPEN&&this.dptG(game.ChatEvts.C_CHAT_FUNC_GUILD_NEW_BOSS),this.worldWarInvite(t.chatContent),game.notice.broadcast2(t.chatContent)}},worldWarInvite:function(e){if(game.settingData.isWorldWar()&&game.moduleOpen.checkOpen(game.ME.WorldWar)){var t=game.TeamInstanceCfg.getData(e.insid);if(t)t.type==game.TeamInstType.WORLDWAR_TEAM&&(game.chatData.setWorldWarNewsData(e),this.dpt(this.Evts.C_WORLDWAR_INVITE))}},marqueeNotify:function(e){var t=e.readProtobuf(game.pb.MarqueeNotify);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.content,i=t.sort,n=t.state;this.addMarquee(a,i,n)}},addMarquee:function(e,t,a){this.broadcastChat.content=e;var i=game.HtmlUtil.getText(game.Color.WHITE,e);if(1==a){game.chatData.addChat(this.broadcastChat),this.send(game.ChatEvts.UPDATE_CHANNEL,null)}else if(2==a){game.notice.broadcast(i,t)}else if(3==a){game.notice.broadcast(i,t),game.chatData.addChat(this.broadcastChat),this.send(game.ChatEvts.UPDATE_CHANNEL,null)}},notify:function(e,t){var a=this,i=game.ChatEvts;switch(e){case i.SEND_CHAT:a.sendOneChat(t.content,t.channel,t.quickChatContent,t.targetRoleId);break;case i.QUICK_CHAT_SELECT:a.sendQuickContent(t);break;case i.ADD_CHAT_EMOTION:a.addEmotion(t);break;case i.C_SHOW_CHAT_VIEW:a.dpt(i.SHOW_CHATVIEW);break;case i.C_REQ_ENTER_TEAM:a.dpt(i.C_REQ_ENTER_TEAM,t);break;case i.V2C_REQ_ENTER_CS_WAR:a.dpt(i.C2C_REQ_ENTER_CS_WAR);break;case i.V2C_REQ_ENTER_THRONE:a.dpt(i.C2C_REQ_ENTER_THRONE);break;case i.V2C_REQ_ENTER_TREASURE:a.dpt(i.C2C_REQ_ENTER_TREASURE);break;case i.V2C_REQ_ENTER_GUILDWAR:a.dpt(i.C2C_REQ_ENTER_GUILDWAR,t);break;case i.V2C_REQ_JOIN_CSARENA:a.dpt(i.C2C_REQ_JOIN_CSARENA);break;case i.V2C_REQ_GOTO_CS_WAR:a.dpt(i.C2C_REQ_GOTO_CS_WAR,t);break;case i.V2C_REQ_RECRUIT_CS_WAR:a.dpt(i.C2C_REQ_RECRUIT_CS_WAR,t);break;case i.V2C_REQ_RECRUIT_GUANDU:a.dpt(i.C2C_REQ_RECRUIT_GUANDU,t);break;case i.V2C_REQ_ENTER_CSARROW:a.dpt(i.C2C_REQ_ENTER_CSARROW);break;case i.V2C_CSGUILD_RELIVE:a.dpt(i.C2C_CSGUILD_RELIVE);break;case i.V2C_CSGUILD_KILL:a.dpt(i.C2C_CSGUILD_KILL);break;case i.V2C_ARROW_GET:a.dpt(i.C2C_ARROW_GET)}},sendQuickContent:function(e){this.sendOneChat(e.contentStr,game.chatData.selectChannelType,e.id,0)},addEmotion:function(e){e&&(game.chatData.curEmotionType===game.ChatEmotionType.MAIN?this.send(game.ChatEvts.ADD_CHAT_EMOTION,e):game.chatData.curEmotionType===game.ChatEmotionType.MAIN2&&this.send(game.ChatEvts.ADD_CHAT_EMOTION2,e))},moduleChange:function(){var e=!game.viewModule.hasShowModule();this.send(game.ChatEvts.SHOW_EDIT_BOX,e)},showTips:function(e){var t=e.data;if(t){var a=t.isShow;this.send(game.ChatEvts.SHOW_TIPS,{isShow:a})}else;},showNewChat:function(){this.send(game.ChatEvts.SHOW_NEW_CHAT)},sendOneChat:function(e,t,a,i){if(e||a){var n=game.ChatChannelType;if(t===n.ALL){t=n.WORLD}this.sender.ChatReq(e,t,a,i),game.GameGuideMgr.inst().completeByEventType(game.GuideEventType.SEND_MAIN_CHAT)}},open_btn:function(){game.chatData.isOpenChat=!game.chatData.isOpenChat,b8e.evt.dptG(game.ChatEvts.OPEN_CHAT2,null),this.send(game.ChatEvts.OPEN_CHAT)},all_btn:function(){game.module.showToggle(game.ME.ChatView,3)},world_btn:function(){game.chatData.selectChannelType=game.ChatChannelType.WORLD,this.send(game.ChatEvts.SELECT_CHANNEL,game.ChatChannelType.WORLD)},guild_btn:function(){var e=game.guildData;if(e&&e.hasGuild()){game.chatData.selectChannelType=game.ChatChannelType.GUILD,this.send(game.ChatEvts.SELECT_CHANNEL,game.ChatChannelType.GUILD)}else game.notice.show(9044)},send_btn:function(){this.send(game.ChatEvts.SEND_CHAT,null)},send_btn2:function(){this.send(game.ChatEvts.SEND_CHAT2,null)},emotion_btn:function(){this.checkEmotion()&&this.openChatEmotionView(game.ChatEmotionType.MAIN)},emotion_btn2:function(){this.checkEmotion()&&this.openChatEmotionView(game.ChatEmotionType.MAIN2)},openChatEmotionView:function(e){if(game.ChatEmotionView.inst().isShow){game.ChatEmotionView.inst().hidePopView()}else game.chatData.curEmotionType=e,game.ChatEmotionView.inst().showPopView()},checkEmotion:function(){var e=0,t=game.ChatMiscCfg.getData("emotionLv");return t&&(e=+t.value),!(game.mainRoleData.lv<e)||(game.notice.show(9586,e),!1)},chatTips_btn:function(){if(game.chatData.hasPrivHistory){game.chatData.hasPrivHistory=!1,this.sender.DeletePrivateChatReq()}game.module.show(game.ME.ChatPrivate),this.send(game.ChatEvts.SHOW_TIPS,{isShow:!1})},houseBtn:function(){game.module.show(game.ME.HouseRec)},btn1:function(){this.selectToggle(0)},btn2:function(){this.selectToggle(1)},btn3:function(){this.selectToggle(2)},btn4:function(){this.selectToggle(3)},selectToggle:function(e){this.send(this.Evts.SELECT_CHANNEL2,e)},clickBg:function(){game.module.showToggle(game.ME.ChatView,3)},scrollViewAll:function(){game.module.show(game.ME.ChatView)},scrollViewWorld:function(){game.module.show(game.ME.ChatView)},scrollViewGuild:function(){game.module.show(game.ME.ChatView)}}),t=[game.ME.ChatView,game.ME.GuidConflictChat],a=game.Sender.extends({ipc:function(){this.msg={ChatReq:this.sendChatRequest,HistoryChatReq:this.sendHistoryChatRequest,DeletePrivateChatReq:null}},sendChatRequest:function(e,t,a,i){var n=game.pb.ChatRequest,s=game.pb.ChatContentProto;if(s.chatType=t,a){s.textId=a}else s.textId=0,s.content=e;if(i){n.targetRoleId=i}else n.targetRoleId=0;n.chatContent=s,this.write(n)},sendHistoryChatRequest:function(e){var t=game.pb.HistoryChatRequest;t.chatType=e,this.write(t)}});b8e.module.registerControl(game.ME.MainUIChat,e,game.ChatEvts,a,t)}(),function(){var e=game.Control.extends({ipc:function(){var e=this;e.evts={MainRole:{C_LEVEL_UP:e.levelUp,C_POWER_CHANGE:e.changePower},Recharge:{C_INIT_MODEL:e.changeCard,C2C_CHANGE_CARD:e.changeCard},Setting:{C_CHANGE_NAME_COMPLETE:e.updateName},Partner:{C_INIT_ROLE_DATA:e.onPartnerInfoResp,C2C_ROLE_QUALITY_CHANGE:e.onHeaderQualityChange},CreateGuild:{C_CREATE_GUILD:e.updateResearch},Guild:{C_JOIN_GUILD:e.updateResearch,C_INIT_MODEL:e.updateResearch},GuildMember:{C2C_UPDATE_GUILD_ACTIVE:e.updateResearch},TribalBattle:{C_UPDATE_TIME:e.updateResearch},GuildRecommend:{C_JOIN_GUILD:e.updateResearch}},this.gevts={SceneGEvts:{C2C_HIDE_CARD:e.hideCard,C2C_SHOW_CARD:e.showCard}}},onHeaderQualityChange:function(){var e=game.partnerData.getMainRoleInfo();e&&this.send(this.Evts.C2V_UPDATE_ROLE_INFO,e)},onPartnerInfoResp:function(e){if(e&&e.data){var t=e.data;this.send(this.Evts.C2V_UPDATE_ROLE_INFO,t)}},hideCard:function(){this.send(this.Evts.C2V_HIDE_CARD)},showCard:function(){this.send(this.Evts.C2V_SHOW_CARD)},updateName:function(){this.send(this.Evts.V_LEVEL_CHANGE)},updateResearch:function(){this.send(this.Evts.C2V_SHOW_RESEARCH)},triggerOpen:function(e){e!=game.ME.WeekCard&&e!=game.ME.MonthCard||this.send(this.Evts.C2V_CHANGE_CARD)},changePower:function(){this.send(this.Evts.V_POWER_CHANGE)},levelUp:function(){this.send(this.Evts.V_LEVEL_CHANGE)},changeCard:function(){this.send(this.Evts.C2V_CHANGE_CARD)},gmBtn:function(){game.module.show(game.ME.GM,null,!1)},tiaoguoBtn:function(){game.playBack.stop()},monthBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.MONTH_CARD)},weekBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.PRIVILEGE)},foreverBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.MONTH_CARD)},researchBtn:function(){var e=game.tribalResearchData;e.isInit||(e.isInit=!0,e.initData()),game.module.show(game.ME.TribalResearch)},headBtn:function(){game.module.show(game.ME.MainRoleInfoView)}});b8e.module.registerControl(game.ME.MainUIHead,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={MainRole:{C_VIP_LEVEL_CHANGE:this.changeVipLevel}}},notify:function(e){switch(e){case this.Evts.V2C_SHOW_VIEW:this.dpt(this.Evts.C2C_SHOW_MHM_VIEW)}},changeVipLevel:function(){this.send(this.Evts.V_VIP_CHANGE)},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},vipBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP)}});b8e.module.registerControl(game.ME.MainUIHeadMiddle,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={MainUIChat:{C2C_OPEN_CHAT:this.openChat}}},openChat:function(){this.send(this.Evts.V_FOLLOW_CHAT)},notify:function(e){switch(e){case this.Evts.V_SHOW_MAIN_LEFT_VIEW:game.module.showTab(game.ME.MainLeftBar,this.moduleEnum,!1)}}});b8e.module.registerControl(game.ME.MainUILeft,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({cdIndex:0,init:function(){this.cdArr=[];for(var e=game.mainActivityNoticeBarData.getDatas().length,t=0!=b8e.TimeUtil.getDay(game.SysTime.curTime)?b8e.TimeUtil.getDay(game.SysTime.curTime):7,a=0;a<e;a++){var i=parseInt(game.mainActivityNoticeBarData.getDatas()[a].id),n=game.mainActivityNoticeBarData.getCountdown(i,1),s=game.mainActivityNoticeBarData.getData(i).weektime,o=0<=game.mainActivityNoticeBarData.getCountdown(i,3);if(s&&-1!=s.indexOf(t)&&!o&&0<n){n+=2e3,this.cdArr.push(n)}}this.cdArr.sort(function(e,t){return e-t}),this.createCountDownTimer()},ipc:function(){this.evts={}},notify:function(e){switch(e){case this.Evts.V_SHOW_MAIN_ACTIVITY_NOTICE_VIEW:game.module.showTab(game.ME.MainActivityNoticeBar,this.moduleEnum,!1)}},createCountDownTimer:function(){if(!this._timer){this._timer=b8e.Timer.add(this,this.updateTime,1e3)}this._lastTime=b8e.timeStamp,this._timer.reset(),this._timer.start()},updateTime:function(){var e=this,t=e.cdIndex;if(e.cdArr){var a=b8e.timeStamp,i=a-e._lastTime;e._lastTime=a;for(var n=e.cdArr.length,s=0;s<n;s++)e.cdArr[s]-=i;e.cdArr[t]<1&&(t+1>=e.cdArr.length?e.clearCountDownTimer():e.cdIndex++,e.dpt(e.Evts.C2C_REFRESH_BTNS))}},clearCountDownTimer:function(){if(this._timer)b8e.Timer.remove(this,this.updateTime),this._timer=null;else;}});b8e.module.registerControl(game.ME.MainActivityNotice,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SpotAlertEnum.WORLD_MAP_ALERT)},ipc:function(){this.evts={MainInstance:{C_GET_MAIN_INSTANCE_AWARDS:this.alertChange},WorldMap:{C_MAP_CHANGE:this.mapChange}},this.gevts={SceneGEvts:{ENTER_SCENE:this.mapChange}}},mapChange:function(){this.send(this.Evts.V_MAP_CHANGE)},alertChange:function(){this.spotAlert.alert=game.mainInstanceData.haveLastPrizeConfig(),this.mapChange()},worldMap:function(){game.module.show(game.ME.WorldMap)},quickBattleBtn:function(){game.module.show(game.ME.QuickBattle)}});b8e.module.registerControl(game.ME.MainMap,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({ipc:function(){var e=this;e.gevts={InstanceEvts:{G_STOP_PLAY:e.updateStarNum},SceneGEvts:{ENTER_SCENE:e.updateAutoFight}},e.evts={MainInstance:{C_AUTO_FIGHT_CHANGE:e.updateAutoFight,C_GET_MAIN_INSTANCE_AWARDS:e.updateIcon},MainRole:{C_LEVEL_UP:e.updateLevel},TeamHandel:{C_TEAM_CREATE:e.stopAutoBattle,C_TEAM_JOIN:e.stopAutoBattle,C_TEAM_QUICK_JOIN:e.stopAutoBattle},ZhanJiang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},ZhaoQin:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},BaoZang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Hunting:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},InstanceMaterial:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Scene:{ENTER_CS_SCENE:e.stopAutoBattle}}},notify:function(e){var t=this;switch(e){case t.Evts.V_SHOW_MAIN_RIGHT_VIEW:game.module.showTab(game.ME.MainRightBar,t.moduleEnum,!1);break;case t.Evts.V_AUTOFIGHT:t.dpt(t.Evts.C_AUTO_FIGHT_CHANGE);break;case t.Evts.CLICKINSTANCEBTN:t.clickInstanceBtn();break;case t.Evts.V2C_GET_GROUP_AWARDS:t.dpt(t.Evts.CV2_GET_GROUP_AWARDS)}},stopAutoBattle:function(){},updateIcon:function(){this.send(this.Evts.C2V_UPDATE_ICON)},updateLevel:function(){this.send(this.Evts.V_LEVEL_CHANGE)},updateStarNum:function(){this.send(this.Evts.V_UPDATERIGHTVIEW_STAR)},updateAutoFight:function(){this.send(this.Evts.V_AUTOFIGHT)},clickInstanceBtn:function(){game.mainInstanceData.needMoveNextMap(function(e){e?game.module.show(game.ME.WorldMap):game.module.show(game.ME.MainInstance)},this)},moveToNewMap:function(){this.clickInstanceBtn()}});b8e.module.registerControl(game.ME.MainUIRight,e,game.MainUIEvts)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Back:{C_UPDATE_AMOUNT:this.updateAmount},Welcome:{V_FIRSTANIM_DIAMON:this.animEffect},InstanceSuccess:{C2C_EFFECT:this.animEffect},Partner:{C_INIT_ROLE_DATA:this.onRoleDataUpdate,C_UPDATE_ROLE_DATA:this.onRoleDataUpdate},MainRole:{C_LEVEL_UP:this.onRoleLvUp}}},onRoleLvUp:function(){this.send(this.Evts.C2V_UPDATE_ROLE_LV)},onRoleDataUpdate:function(e){if(e&&e.data){var t=e.data;this.send(this.Evts.C2V_UPDATE_ROLE_INFO,t)}},moneyBtn:function(){game.module.show(game.ME.GetYinLiang)},goldBtn:function(){b8e.isWeChatGame&&b8e.os===b8e.OS.IOS&&(game.moduleOpen.checkOpen(game.ME.Recharge)||game.notice.show(9382)),game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},updateAmount:function(){this.send(this.Evts.V_AMOUNT_CHANGE)},animEffect:function(e){var t=e?e.data:null;t&&this.send(this.Evts.V_FIRST_DIAMON,t)}});b8e.module.registerControl(game.ME.MainUITop,e,game.MainUIEvts)}(),function(){var e=game.BaseActiveBarControl.extends({ipc:function(){this._super(),this.evts.Task={C_INIT_TASK:this.refreshBtn,C_TASK_COMPLETE:this.refreshBtn}}});b8e.module.registerControl(game.ME.MainLeftBar,e,game.MainUIEvts)}(),function(){var e=game.BaseActiveBarControl.extends({ipc:function(){this._super()}});b8e.module.registerControl(game.ME.MainActivityNoticeBar,e,game.MainUIEvts)}(),function(){var e=game.BaseActiveBarControl.extends({ipc:function(){this._super()}});b8e.module.registerControl(game.ME.MainRightBar,e,game.MainUIEvts)}(),function(){var e;e=b8e.Enum({NONE:0,HOUSE:1}),b8e.RC("$$game","$$ChatFuncBtnType",e)}(),function(){var e=b8e.Object.extends({enlistActive:!1,isAutoFight:!1});game.mainCenterData=game.mainCenterData||new e}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(5)},getDatas:function(){return game.MainLeftBarCfg.getDatas()},getData:function(e){return game.MainLeftBarCfg.getData(e)}});game.mainLeftBarData=game.mainLeftBarData||new e}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(7)},getDatas:function(){return game.ActiveNoticeCfg.getDatas()},getData:function(e){return game.ActiveNoticeCfg.getData(e)},getCountdown:function(e,t){if(!game.ActiveNoticeCfg.getData(e)){return 0}var a=new Date,i=game.SysTime.curTime,n=game.ActiveNoticeCfg.getData(e).startime,s=game.ActiveNoticeCfg.getData(e).endtime,o=n.split(":"),r=s.split(":"),g=0;if(2==o.length){a.setHours(o[0]),a.setMinutes(o[1]),g=a.valueOf()}else{if(3!=o.length)return 0;a.setHours(o[0]),a.setMinutes(o[1]),a.setSeconds(o[2]),g=a.valueOf()}var l=0;if(2==r.length){a.setHours(r[0]),a.setMinutes(r[1]),l=a.valueOf()}else{if(3!=r.length)return 0;a.setHours(r[0]),a.setMinutes(r[1]),a.setSeconds(r[2]),l=a.valueOf()}if(1==t){if(l<i){return 0}if(g<=i&&i<l){return l-i}if(i<=g){return l-i}}else{if(2==t){return l-g}if(3==t){return i-l}}return 0}});game.mainActivityNoticeBarData=game.mainActivityNoticeBarData||new e}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(6)},getDatas:function(){return game.MainRightBarCfg.getDatas()},getData:function(e){return game.MainRightBarCfg.getData(e)}});game.mainRightBarData=game.mainRightBarData||new e}(),function(){var e=b8e.Object.extends({_showModules:null,_moduleNode:null,ctor:function(){this._showModules=[]},addModule:function(e){e&&(-1<this._showModules.indexOf(e)||(this._showModules.push(e),game.module.show(game.ME.MainUITopFightAmount)))},removeModule:function(e){var t=this._showModules.indexOf(e);-1<t&&(this._showModules.splice(t,1),this._showModules.length<=0?game.module.hide(game.ME.MainUITopFightAmount):e=this._showModules[this._showModules.length-1])}});game.mainTopByFightAmount=game.mainTopByFightAmount||new e}(),function(){var e=game.View.extends({_showModel:!1,barWidth:0,_spaceTime:1e3,_spaceExp:15,lastTime:0,_specialLayer:!0,ctor:function(){var e=this;e._super(game.baseUIUrl[15]),e.setLocalZOrder(999),e.spotAlerts={FIGHT:e.fightAlert,HOME:e.homeAlert,RECRUIT:e.zhaohuanAlert,EQUIP_FORGE:e.equipForgeAlert,YANGCHENG_ALERT:e.yangchengAlert,PARTNER:e.huobanAlert,BACK_PACK:e.bagAlert,INSTFUNC_HALL:e.instfuncAlert}},bindModuleOpenFlyBottomPos:function(e){var t=this.getComponent("bottom_"+e);if(!t)return this.send(this.Evts.C2V_BEGINPLAYANI),void b8e.error("\u6ca1\u6709\u627e\u5230\u5e95\u90e8\u6309\u94ae\u7d22\u5f15\u4f4d\u7f6e index:"+e);game.moduleOpenData.bindFlyAnimBtnPos=t.localToGlobal(),this.send(this.Evts.C2V_BEGINPLAYANI)},bagAlert:function(e){this.skin.red_spot_2.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert},instfuncAlert:function(e){this.skin.red_spot_1.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert},equipForgeAlert:function(e){this.skin.red_spot_3.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert},fightAlert:function(e){this.skin.red_spot_4_zhanyi.node.active=e.alert},homeAlert:function(e){this.skin.red_spot_4_jiayuan.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert&&game.moduleOpen.checkOpen(game.ME.Home)},huobanAlert:function(e){this.skin.red_spot_5.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert},yangchengAlert:function(e){this.skin.red_spot_6.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert},zhaohuanAlert:function(e){this.skin.red_spot_7.node.active=game.SpotAlertCfg.isOpen(e.type)&&e.alert},hongyanInnerAlert:function(e){this.skin.red_spot_hongyan.node.active=e.alert},huweiMainAlert:function(e){this.skin.red_spot_huwei.node.active=e.alert},fightPetAlert:function(e){this.skin.red_spot_fightPet.node.active=e.alert},junshenAlert:function(e){this.skin.red_spot_junshen.node.active=e.alert},guoshiAlert:function(e){this.skin.red_spot_guoshi.node.active=e.alert},chariotAlert:function(e){this.skin.red_spot_chariot.node.active=e.alert},bianyiAlert:function(e){this.skin.red_spot_bianyi.node.active=e.alert},init:function(){this.barWidth=this.skin.bar.node.width,this.pageModules=[],this.pageBtns={},this.skin.publicBoss.active=!1,b8e.evt.onC(this.skin.bottom_bg,this.onTouchBottomNode,this)},onTouchBottomNode:function(){},showSelect:function(e){for(var t=1;t<=7;t++)4!=t&&this.getComponent("bottom_selectIcon_"+t).setVisible(t==e+1)},notify:function(e,t){var a=this;switch(e){case game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE:a.showSelect(t);break;case game.MainUIEvts.V_EXP_CHANGE:a.updateExp(t);break;case game.MainUIEvts.V_SHOW_HONGYAN:a.isOnBtn=!0,a.setHongyanPage(!a.skin.hongyanPage.active);break;case game.MainUIEvts.C_HIDEBUBLLE:a.hideBuule();break;case a.Evts.SHOW_HOME_BTN:a.toggleHideHome(!1);break;case a.Evts.SHOW_FIGHT_BTN:a.toggleHideHome(!0);break;case a.Evts.BIND_FLY_BOTTOM_BTN_POS:a.bindModuleOpenFlyBottomPos(t);break;case a.Evts.SHOW_CHANGE_EFF:a.playChangeEff();break;case a.Evts.V_SET_HONGYAN_OPEN:a.isOnBtn=!0;break;case a.Evts.V_SET_HONGYAN_HIDE:a.isOnBtn=!1,a.onClickStage()}},playChangeEff:function(){var e=this;e.changeEffect||(e.changeEffect=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.changeEffect.addToParent(e.skin.bottom_4),e.changeEffect.load(game.ResCfg.getUrl(5019,1092)),e.changeEffect.addFinishCallback(e.chanegAnimaCB,e),e.changeEffect.active=!1),e.changeEffect.active=!0,e.changeEffect.play(null,0)},chanegAnimaCB:function(){this.changeEffect.active=!1},toggleHideHome:function(e){game.moduleOpen.checkOpen(game.ME.Home)&&(this.skin.bottomZhanYi.setVisible(e),this.skin.bottomJiaYuan.setVisible(!e))},checkFightPetOpen:function(){},setHongyanPage:function(e){var t=this.skin.hongyanPage;(t.active=e)?(t.parent||t.addToParent(this),this.updataBtnByCfg()):t.removeFromParent()},onShow:function(){this.skin.hongyanPage.node.active=!1,this.setExpBar(),b8e.evt.onC(b8e.stage,this.onClickStage,this);var e=this.bottomInstfuncAnim;e||(e=this.bottomInstfuncAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,2)).addToParent(this.skin.bottomInstfuncAnimNode),e.load(game.ResCfg.getUrl(5019,1132)),e.play()},onHide:function(){b8e.evt.offC(b8e.stage,this.onClickStage,this),this.bottomInstfuncAnim.stop()},onClickStage:function(){if(this.isOnBtn){this.isOnBtn=!1}else this.skin.hongyanPage.active=!1},setExpBar:function(){var e=game.RoleExpCfg.getData(game.mainRoleData.lv),t=0;e&&(t=e.exp),this.skin.exp.string=game.mainRoleData.exp+"/"+t;var a=1<game.mainRoleData.exp/t?1:game.mainRoleData.exp/t;this.skin.bar.node.width=this.barWidth*a,this._curLv=game.mainRoleData.lv,this._curExp=game.mainRoleData.exp},updateExp:function(){var e=this,t=e._curLv,a=e._curExp,i=game.mainRoleData.lv,n=game.mainRoleData.exp,s=game.RoleExpCfg.getData(t);if(s)if(s&&(e._curMaxExp=s.exp),t==i&&s.exp<=a)e.setExpBar();else{b8e.Tween.kill(e.skin.bar);var o=b8e.Tween.get(e.skin.bar,{onUpdate:e._updateExpNum,onUpdateThis:e}),r=void 0,g=void 0,l=void 0;if(e._curCfg=s,e.startTime=game.SysTime.curTime,e.complete=!1,t==i&&a<n){(e.campExp=n)>s.exp&&(n=s.exp),r=(n-a)/s.exp;var c=e._playTime=e._spaceTime*r,h=n/s.exp;return g=e.barWidth*h,e.endTime=c,e._spaceExp=(n-a)/c,void o.to({width:g},c).call(e.updateComplete,e)}if(t==i&&n<a){r=n/s.exp;var m=e._playTime=e._spaceTime*r;return g=e.barWidth*r,e.endTime=m,e._spaceExp=(n-a)/m,void o.to({width:g},m).call(e.updateComplete,e)}if(i<t)e.setExpBar();else{e.campExp=s.exp,r=(s.exp-a)/s.exp;var u=e._playTime=e._spaceTime*r;l=t+1,e.endTime=u,e._spaceExp=(s.exp-a)/u,o.to({width:e.barWidth},u).call(e.updateCurExpInfo,e,[l]);for(var d=t+1;d<i;d++)if(game.RoleExpCfg.getData(d)){var f=e._playTime=e._spaceTime;l=d+1,o.to({width:0}).to({width:e.barWidth},f).call(e.updateCurExpInfo,e,[l])}if(0<n){var p=game.RoleExpCfg.getData(i);if(!p)return;r=n/p.exp;var _=e._playTime=e._spaceTime*r;g=e.barWidth*r,o.to({width:0}).to({width:g},_).call(e.updateComplete,e)}else o.to({width:0}).call(e.updateComplete,e)}}},updateCurExpInfo:function(e){var t=this;if(t._curLv>=game.mainRoleData.lv)t._curLv=game.mainRoleData.lv;else{t._curLv=e;var a=game.RoleExpCfg.getData(t._curLv);if(a){if(t._curCfg=a,t.campExp=a.exp,t.startTime=game.SysTime.curTime,e<game.mainRoleData.lv)t.endTime=t._spaceTime,t._spaceExp=a.exp/t.endTime;else{var i=game.mainRoleData.exp/a.exp;t.endTime=t._spaceTime*i,t._spaceExp=game.mainRoleData.exp/t.endTime}t._curMaxExp=a.exp,t._curExp=0,t.skin.exp.string=t._curExp+"/"+t._curMaxExp}}},updateComplete:function(){var e=game.RoleExpCfg.getData(game.mainRoleData.lv),t=0;e&&(t=e.exp),this.skin.exp.string=game.mainRoleData.exp+"/"+t,this._curExp=game.mainRoleData.exp,this._curLv=game.mainRoleData.lv,this.complete=!0},_updateExpNum:function(){var e=this;if(!(!e._curCfg||e.startTime>game.SysTime.curTime||e.complete)){var t=game.SysTime.curTime-e.startTime;e.startTime=game.SysTime.curTime;var a=e._spaceExp*t>>0;e._curExp=e._curExp+a,e._curExp>=e.campExp&&(e._curExp=e.campExp),e.skin.exp.string=e._curExp+"/"+e._curMaxExp}},showBubble:function(){},hideBuule:function(){this.skin.publicBoss.active=!1},btnSort:function(e,t){return e.sortId-t.sortId},onStageResize:function(){var e=this,t=b8e.stageWidth;e.skin&&e.skin.bottom_bg&&(e.setPosition(t/2,e.height),e.skin.bottom_bg.width=t,e.skin.proBg.width=t,e.skin.proBg.x=-t/2,e.skin.bottom_bg.height=113+b8e.bottomSpace,e.skin.bar.x=-t/2,e.barWidth=t,e.setExpBar())},updataBtnByCfg:function(){var e=this;e.pageModules.length<1&&(e.pageModules=game.MainBottomCfg.getDatas(),e.pageModules.sort(e.btnSort));for(var t=game.LoginConfig.MainBottomUrl?game.LoginConfig.MainBottomUrl:"mainui/",a=e.pageModules.length,i=void 0,n=void 0,s=0,o=0,r=0;r<a;r++)(i=e.pageModules[r])&&((n=e.pageBtns[i.sortId])||((n=new game.MainBottom(i.moduleId,b8e.getDPV(game.SAE,i.alert),i)).setBtnImg(game.ResCfg.getUrl(5075,t+i.res)),n.addToParent(e.skin.hongyanPage),e.pageBtns[i.sortId]=n),n.x=58+s%6*120,n.y=56+120*Math.floor(s/6),s++,o++);6<s&&(s=6),e.updataHongyanPage(s,o)},updataHongyanPage:function(e,t){var a=120*e,i=193-(a>>1);360<i+a&&(i=360-a),this.skin.hongyanPage.width=a,this.skin.hongyanPage.height=115*Math.ceil(t/6),this.skin.hongyanPage.x=i,this.skin.emotion_bg.x=193-i},$$getFosterBtn:function(e){if(!e||!this.pageBtns)return null;for(var t in this.pageBtns)if(this.pageBtns[t]._moduleNum==e)return this.pageBtns[t];return null}});b8e.module.registerView(game.ME.MainUIBottom,e)}(),function(){var e=game.View.extends({BTN_WIDTH:70,_specialLayer:!0,boxIndex:0,ctor:function(){this._super(game.baseUIUrl[22]),this.spotAlerts={QUICK_FITHG:this.quickFightAlert,WUSHEN_MAIN_ALERT:this.wushengMainAlert}},init:function(){var e=this;e._super(),e.setLocalZOrder(game.GameViewMgr.MainCenterViewIndex);var t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.layout.spacingX=5,t.layout.paddingLeft=0,t.addToParent(e.skin.dropList),t.touchMovable=!1,e.skin.guajiBox.isButton=!1,e.wuShengAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,2),e.wuShengAnim.addToParent(e.skin.wushengAnim),e.wuShengAnim.load(game.ResCfg.getUrl(5019,1134)),e.wuShengAnim.play(null,0)},notify:function(e){var t=this;switch(e){case t.Evts.C_UPDATE_CENTER_BAR:t.updateCenterBar();break;case t.Evts.C2V_UPDATE_GUAJI_BOX:t.updateGuajiBox();break;case t.Evts.C2V_UPDATE_AUTO_BATTLE:t.updateAutoBattleBtn();break;case t.Evts.C2V_UPDATE_REWARD_REDPOINT:t.updateDetailInfo();break;case t.Evts.C2V_UPDATE_BOSS_BTN:t.updateBossBtn();break;case t.Evts.C2V_GUAJI_GET_AWARD:t.guajiGetAward();break;case t.Evts.BIND_FLY_TASK_BTN_POS:t.onBindFlyTaskBtnPos();break;case t.Evts.C2V_WUSHENG_TIPS:t.updateWuShengTips()}},updateWuShengTips:function(){var e=this,t=e.skin,a=game.wushengData,i=game.WuShengPosActivateCfg.getDataById(a.curId);if(i&&i.tipsDesc){if(t.wusheng_chatbg.active=!0,t.wusheng_des.string=i.tipsDesc,!e.tipsDesTime){var n=game.WuShengMiscCfg.getData("tipsDesTime");e.tipsDesTime=+n.value}game.mainCenterData.tipsDesEndTime=game.SysTime.curTime+e.tipsDesTime,e.wuShengtimer?(e.wuShengtimer.reset(),e.wuShengtimer.start()):e.wuShengtimer=b8e.Timer.add(e,e.wuShengUpdateTime,e.tipsDesTime),b8e.Tween.kill(t.wusheng_chatbg),b8e.Tween.get(t.wusheng_chatbg,{loop:!0}).to({y:-204},500).to({y:-180},500)}},stopAnim:function(){},wuShengUpdateTime:function(){game.mainCenterData.tipsDesEndTime-game.SysTime.curTime<0&&(this.skin.wusheng_chatbg.active=!1,this.wuShengTipsStopTime(),this.stopAnim())},onBindFlyTaskBtnPos:function(){game.moduleOpenData.bindFlyAnimBtnPos=this.skin.fastFightBtn.localToGlobal(),this.send(this.Evts.BIND_FLY_TASK_BTN_POS)},quickFightAlert:function(e){this.skin.fastFightBtnAlert.active=e.alert},wushengMainAlert:function(e){this.skin.wushengBtnAlert.active=e.alert},updateAutoBattleBtn:function(){var e=this.skin,t=game.mainCenterData.isAutoFight;e.autoBattleBtnSelect.active=t},updateDetailInfo:function(){var t=this,a=t.skin,e=game.mainInstanceData;e.getInstanceCfg(function(e){e&&(a.goldNum.string=game.Lang.get(52409,game.CCommonUtil.replaceNum(e.silver*(60/e.interval))),a.expNum.string=game.Lang.get(52409,game.CCommonUtil.replaceNum(e.exp*(60/e.interval))))},t),e.getShowItems(function(e){e&&t.prizeList.setData(e)},t)},updateBossBtn:function(){var a=this,i=a.skin,n=a.bossAnim,s=game.mainCenterData.nextBattleTime-game.SysTime.curTime;game.mainInstanceData.getInstanceCfg(function(e){if(!e)return i.bossTime.active=!1,i.bossLab.active=!0,void(i.bossLvLab.active=!1);var t=e.limitLv<=game.mainRoleData.lv;i.bossLvLab.active=!t,t&&0<s?(i.bossTime.active=!0,i.bossLab.active=!1,n&&n.setVisible(!1),i.bossTime.string=game.Lang.get(53022,Math.floor(s/1e3)),a.timer?(a.timer.reset(),a.timer.start()):a.timer=b8e.Timer.add(a,a.updateTime,500)):(i.bossTime.active=!1,i.bossLab.active=t,n||((n=a.bossAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,2)).addToParent(a.skin.bossAnim),n.load(game.ResCfg.getUrl(5019,1111))),t?(n.setVisible(!0),n.play(null,0)):(n.setVisible(!1),i.bossLvLab.string=game.Lang.get(53021,e.limitLv)),a.stopTime())},a)},updateTime:function(){var e=this.skin,t=game.mainCenterData.nextBattleTime-game.SysTime.curTime;if(t<0)return this.updateBossBtn(),void this.stopTime();e.bossTime.active=!0,e.bossLab.active=!1,e.bossTime.string=game.Lang.get(53022,Math.floor(t/1e3))},stopTime:function(){this.timer&&this.timer.stop()},wuShengTipsStopTime:function(){this.wuShengtimer&&this.wuShengtimer.stop()},updateCenterBar:function(){var e=game.mainCenterData,t=[],a=this.skin;if(a.worldWarBtn.active=!!e.worldWarActive,e.worldWarActive&&t.push(a.worldWarBtn),e.enlistActive){a.enlist.active=!0,t.push(a.enlist)}else a.enlist.active=!1;a.worldWarInviteBtn.active=!!e.worldWarInviteActive,e.worldWarInviteActive&&t.push(a.worldWarInviteBtn);var i=game.chatData.worldWarNewsArr;if(a.worldWarInviteLab.string=i.length,a.assistBtn.active=!!e.assistActive,e.assistActive&&t.push(a.assistBtn),a.MailBtn.active=!!e.mailActive,e.mailActive){t.push(a.MailBtn)}if(a.houseBtn.active=!!e.houseActive,e.houseActive){t.push(a.houseBtn)}if(a.redPacketBtn.active=!!e.redPacketActive,e.redPacketActive){t.push(a.redPacketBtn)}if(a.escortBtn.active=!!e.escortActive,e.escortActive){var n=game.escortData,s=n.getRateAlert(),o=n.getRevengeAlert(),r=n.getFinishAlert();a.escortRate.active=s,a.escortRevenge.active=!s&&o,a.escortFinish.active=!s&&!o&&r,t.push(a.escortBtn)}if(a.juntuanBtn.active=!!e.juntuan,e.juntuan){t.push(a.juntuanBtn)}if(a.worldChallengeBtn.active=!!e.worldChallenge,e.worldChallenge){t.push(a.worldChallengeBtn)}if(a.ocBtn.active=game.occupiedData&&!!game.occupiedData.isSnatch,game.occupiedData&&game.occupiedData.isSnatch&&t.push(a.ocBtn),a.worldWar2Btn.active=!!e.worldWar2Active,e.worldWar2Active&&t.push(a.worldWar2Btn),a.qianCengBtn.active=!!e.qianCengActive,e.qianCengActive&&t.push(a.qianCengBtn),a.csOverlordBtn.active=!!e.csOverlord,e.csOverlord){t.push(a.csOverlordBtn)}for(var g=t.length,l=-(g-1)*this.BTN_WIDTH*.5,c=0;c<g;c++){t[c].x=l+this.BTN_WIDTH*c}},updateGuajiBox:function(){var e=game.guajiData,t=e.clientTotalTime,a=e.getNeedTimeList();if(a&&!(a.length<1)){for(var i=a.length,n=void 0,s=this.boxIndex=0;s<i&&!(t<a[s]);s++)n=e.getBoxAnima(s),this.skin.guajiBox.width=0|e.getBoxWidth(s),this.skin.guajiBoxAnim.x=0|e.getBoxAnimaX(s),this.skin.guajiBox.x=0|e.getBoxX(s),this.boxIndex=s;var o=this.anima;this.skin.guajiBox.active=!!n,n?(o||(o=this.anima=b8e.Animator.get(game.AnimType.UI_EFFECT,1)).addToParent(this.skin.guajiBoxAnim),o.load(game.ResCfg.getUrl(5019,n)),o.setVisible(!0),o.play()):o&&(o.stop(),o.setVisible(!1))}},guajiGetAward:function(){var e=this,t=e.skin,a=game.guajiData.getGoldAnima(e.boxIndex);if(a){var i=e.goldAnim;i||((i=e.goldAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,3)).addFinishCallback(e.onComplete,e),i.addToParent(e.skin.guajiBox)),i.load(game.ResCfg.getUrl(5019,a)),i.setVisible(!0),i.play(null,0),b8e.Tween.kill(t.guajiBox),b8e.Tween.get(t.guajiBox).to({scaleX:1.2,scaleY:1.2},150).to({scaleX:1,scaleY:1},150).wait(150).to({alpha:0},300).call(function(){e.updateGuajiBox(),t.guajiBox.alpha=1},e)}else e.updateGuajiBox()},onComplete:function(){this.goldAnim&&this.goldAnim.setVisible(!1)},onShow:function(){this.updateCenterBar(),this.updateGuajiBox(),this.updateBossBtn(),this.updateDetailInfo(),this.onStageResize(),this.updateAutoBattleBtn()},onHide:function(){this.anima&&(this.anima.stop(),this.anima.setVisible(!1)),this.bossAnim&&this.bossAnim.setVisible(!1)},onStageResize:function(){var e=.5*b8e.stageWidth,t=this.skin;t.bottom_bg.width=b8e.stageWidth+10,t.bg2.width=b8e.stageWidth+10,t.awardLab2.x=.5*-b8e.stageWidth,t.awardLab.x=.5*-b8e.stageWidth,this.setPosition(e,450)}});b8e.module.registerView(game.ME.MainCenter,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(game.baseUIUrl[24]),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.UPDATE_CHANNEL:this.updateNum();break;case game.ChatEvts.SHOW_TIPS:t&&(this.skin.chatTips_btn.node.active=t.isShow,t.isShow||this.showNewPrivateChat(!1));break;case game.ChatEvts.SHOW_NEW_CHAT:this.showNewPrivateChat(!0)}},showNewPrivateChat:function(e){b8e.Tween.kill(this.skin.chatTips_btn),e?(this.skin.chatTips_btn.alpha=1,b8e.Tween.get(this.skin.chatTips_btn,{loop:!0}).to({alpha:0},1e3).to({alpha:1})):this.skin.chatTips_btn.alpha=1},init:function(){var e=this.skin,t=e.chatBtn;t.x=b8e.stageWidth-t.width/2-10,e.chatTips_btn.y=t.y=550,e.chatTips_btn.x=e.chatBtn.x-e.chatBtn.width-5},onShow:function(){var e=this.skin,t=e.chatBtn,a=e.boundary;this.updateDrag(),e.chatTips_btn.node.active=!1,a.x=t.width/2,a.y=t.height/2,game.dragEffectMgr.addDrag(t,null,this.placeCb,this,this.clickBtn,this,null,null,a,{autoBack:!1}),this.updateNum()},updateDrag:function(){var e=this.skin,t=e.chatBtn,a=e.boundary;a.width=b8e.stageWidth-t.width,a.height=b8e.stageHeight-165-t.height,t.x>b8e.stageWidth-t.width/2&&(t.x=b8e.stageWidth-t.width/2),t.y>b8e.stageHeight-165-t.height/2&&(t.y=b8e.stageHeight-165-t.height/2),e.chatTips_btn.x=e.chatBtn.x-e.chatBtn.width-5},onHide:function(){game.dragEffectMgr.delDrag(this.skin.chatBtn)},placeCb:function(){var e=this.skin;e.chatTips_btn.x=e.chatBtn.x-e.chatBtn.width-5,e.chatTips_btn.y=e.chatBtn.y},clickBtn:function(){game.module.show(game.ME.ChatView),0<game.chatData.unReadNum&&(game.chatData.unReadNum=0,this.updateNum())},updateNum:function(){var e=this.skin,t=game.chatData.unReadNum;e.chatImg.active=0<t,0<t&&(e.chatNum.string=99<t?"+99":t)},onStageResize:function(){this.updateDrag(),this.setPosition(0,113)}});b8e.module.registerView(game.ME.MainUIChat,e)}(),function(){var e=game.View.extends({_showModel:!1,_specialLayer:!0,ctor:function(){this._super(game.baseUIUrl[23]),this.spotAlerts={VIP_ALERT:this.vipAlert,RECHARGE_HALL_RECHARGE:this.rechargeAlert},this.setLocalZOrder(game.GameViewMgr.MainHeadViewIndex)},init:function(){},notify:function(e){switch(e){case this.Evts.V_VIP_CHANGE:this.updateVipLv()}},vipAlert:function(e){this.skin.vip_spot.node.active=e.alert},rechargeAlert:function(e){this.skin.recharge_spot.active=e.alert},onShow:function(){this.skin.vipBtn.active=game.moduleOpen.checkOpen(game.ME.Vip),this.skin.rechargeBtn.active=game.moduleOpen.checkOpen(game.ME.Recharge),this.updateVipLv(),this.send(this.Evts.V2C_SHOW_VIEW)},updateVipLv:function(){this.skin.vipLab.string="V"+game.mainRoleData.vipLevel},onStageResize:function(){b8e.stageWidth;var e=b8e.stageHeight;this.setPosition(325,e-50)}});b8e.module.registerView(game.ME.MainUIHeadMiddle,e)}(),function(){var e=game.View.extends({_showModel:!1,_isFrist:!0,index:0,current:0,_specialLayer:!0,ctor:function(){this._super(game.baseUIUrl[20]),this.setLocalZOrder(game.GameViewMgr.MainHeadViewIndex)},init:function(){var e=this;e._iconBg=b8e.Sprite.get(),e._iconBg.addToParent(e.skin.head),e._iconBg.setAnchor(.5,.5),e._headImg=b8e.Sprite.get(),e._headImg.addToParent(e.skin.head),e._headImg.setAnchor(.5,.5),e._headImg.setSize(84,84),e._headImg.y=2,e.skin.gmBtn.node.active=!b8e.macro.IS_RELEASE,e.skin.tiaoguoBtn.node.active=!b8e.macro.IS_RELEASE},notify:function(e,t){var a=this;switch(e){case a.Evts.V_LEVEL_CHANGE:a.updateLv();break;case a.Evts.V_POWER_CHANGE:a.updatePower();break;case a.Evts.C2V_CHANGE_CARD:a.updateCard();break;case a.Evts.C2V_HIDE_CARD:a.hideCard();break;case a.Evts.C2V_SHOW_CARD:a.showCard();break;case a.Evts.C2V_UPDATE_ROLE_INFO:a.updateHead(t);break;case a.Evts.C2V_SHOW_RESEARCH:a.skin.researchBtn.active=!1,game.guildData.hasGuild()&&a.updateTime()}},onShow:function(){var e=this;e.updateLv(),e.updatePower(),e.updateCard(),this._isFrist&&(game.IS_YUNYOU||game.IS_YUNYOU_MZ)&&b8e.setTimeout(function(){e.updateCard()},this,8e3)},updateHead:function(e){var t=this;if(e){var a=game.ResCfg.getUrl(60,game.ResCfg.getQualityBg(e.quality));t._iconBg.loadTexture(a);var i=game.ResCfg.getHead(game.mainRoleData.isMale);t._headImg.loadTexture(i),t._effect||(t._effect=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1),t.addChild(t._effect),t._effect.setPosition(50,-50));var n=game.CCommonUtil.getqualityEffect(e.quality);n?(i=game.ResCfg.getUrl(5022,n))&&(t._effect.load(i),t._effect.play()):t._effect&&(t._effect.clear(),t._effect=null)}},hideCard:function(){this.skin.monthBtn.active=!1,this.skin.weekBtn.active=!1,this.skin.foreverBtn.active=!1},showCard:function(){var e=game.moduleOpen.checkOpen(game.ME.WeekCard),t=game.moduleOpen.checkOpen(game.ME.MonthCard);this.skin.monthBtn.active=t,this.skin.weekBtn.active=e,this.skin.foreverBtn.active=t,this.updateRecharge()},updatePower:function(){this.skin.fightAmount.string=game.mainRoleData.power},updateLv:function(){(game.IS_YUNYOU||game.IS_YUNYOU_MZ)&&this.updateRecharge()},updateCard:function(){var e=game.moduleOpen.checkOpen(game.ME.WeekCard),t=game.moduleOpen.checkOpen(game.ME.MonthCard);if(game.guanDuData.firstEnter&&(this.skin.monthBtn.active=t,this.skin.weekBtn.active=e,this.skin.foreverBtn.active=t),t){var a=game.rechargeData.getCardIsHas(game.CardType.MONTH);this.skin.monthCardGray.active=!a;var i=game.rechargeData.getCardIsHas(game.CardType.FOREVER);this.skin.foreverCardGray.active=!i}if(e){var n=game.rechargeData.getCardIsHas(game.CardType.WEEK);this.skin.weekCardGray.active=!n}this.updateRecharge()},updateRecharge:function(){},updateTime:function(){var e=this.skin;e.researchBtn.active=!0,e.redPoint.active=!1;var t=game.tribalResearchData;if(t.isInit){var a=t.getCountDown(),i=t.getUpInfo();if(!i)return e.researchName.active=!0,e.researchName.string=game.Lang.get(52416),e.time.active=!1,e.redPoint.active=!0,this.current=0,this.index=0,void this.clearTimer();0<a&&(this.timer||(this.timer=b8e.Timer.add(this,this.updateActTime,1e3)),e.time.string=b8e.TimeUtil.formatTime(a),e.researchName.string=i.isGet?game.Lang.get(52417):game.Lang.get(52418),e.time.active=!1,e.researchName.active=!0)}else this.initTime()},initTime:function(){var e=game.tribalResearchData,t=e.getCountDown(),a=this.skin;if(a.researchName.active=!0,a.time.active=!1,0==e.endTime)return a.researchName.string=game.Lang.get(52416),void(a.redPoint.active=!0);0<t?(this.timer||(this.timer=b8e.Timer.add(this,this.updateActTime,1e3)),a.time.string=b8e.TimeUtil.formatTime(t),a.time.active=!0,a.researchName.active=!1):(a.researchName.string=game.Lang.get(52417),a.redPoint.active=!0)},updateCut:function(e){var t=game.tribalResearchData,a=t.getCountDown(),i=t.getUpInfo(),n=this.skin;1==e&&(n.researchName.active=!0,n.researchName.string=i.isGet?game.Lang.get(52417):game.Lang.get(52418),n.time.active=!1,i.isGet&&(n.redPoint.active=!0)),2==e&&(n.researchName.active=!0,n.researchName.string=i.name,n.time.active=!1),3!=e||i.isGet||(n.researchName.active=!1,n.time.active=!0,n.time.string=b8e.TimeUtil.formatTime(a),i.free||(n.redPoint.active=!0))},updateActTime:function(){var e=this,t=game.tribalResearchData,a=t.getCountDown(),i=void 0;if(!t.isInit||(i=t.getUpInfo())){if(0<a){if(e.skin.time.string=b8e.TimeUtil.formatTime(a),!t.isInit)return}else{if(!t.isInit)return e.skin.researchName.string=game.Lang.get(52417),e.skin.time.active=!1,e.skin.researchName.active=!0,e.skin.redPoint.active=!0,void e.clearTimer();i.isGet||t.setIsGet(i),e.skin.time.active=!1}e.index++;var n=i.isGet?2:3;5==e.index&&(e.index=0,e.current>=n?e.current=1:e.current++,e.updateCut(e.current))}},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.updateActTime),this.timer=null)},onStageResize:function(){b8e.stageWidth;var e=b8e.stageHeight;this.setPosition(0,e-50)}});b8e.module.registerView(game.ME.MainUIHead,e)}(),function(){var e=game.View.extends({_showModel:!1,_specialLayer:!0,ctor:function(){var e=game.baseUIUrl[17];game.IS_HUIXUAN_IOS&&(e="base/mainui/huixuan/base/MainLeftView"),this._super(e),this.addNodeTouch=!1,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex),this.spotAlerts={BACK_PACK:this.backPackAlert,MAIL:this.mailAlert,CS_TEAM_DOUBLE_ALERT:this.csTeamDoubleAlert,DAILY_ALERT:this.dailyAlert,LOGIN_PRIZE:this.loginPrizeAlert}},init:function(){},backPackAlert:function(){},mailAlert:function(){},relationAlert:function(){},firstRechargeMainAlert:function(){},dailyAlert:function(){},loginPrizeAlert:function(){},hideLoginAwards:function(){},csTeamDoubleAlert:function(){},notify:function(e){switch(e){case game.MainUIEvts.HIDELOGINAWARDS:this.hideLoginAwards()}},onShow:function(){this.send(this.Evts.V_SHOW_MAIN_LEFT_VIEW),this._isMoveUp=game.chatData.isOpenChat,this.onStageResize()},onStageResize:function(){this.setPosition(0,1220)}});b8e.module.registerView(game.ME.MainUILeft,e)}(),function(){var e=game.View.extends({_showModel:!1,_specialLayer:!0,ctor:function(){this._super(1179),this.addNodeTouch=!1,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},onShow:function(){this.send(this.Evts.V_SHOW_MAIN_ACTIVITY_NOTICE_VIEW)},onStageResize:function(){var e=b8e.stageWidth;this.setPosition(0,0),this.setSize(e,0)}});b8e.module.registerView(game.ME.MainActivityNotice,e)}(),function(){var e=game.View.extends({_showModel:!1,_specialLayer:!0,ctor:function(){this._super(game.baseUIUrl[26]),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.V_MAP_CHANGE:this.updateMapInfo()}},updateMapInfo:function(){var t=this.skin;game.mainRoleData.mapId;game.sceneData.isCsScene()?this.setVisible(!1):(this.setVisible(!0),game.mainInstanceData.getInstanceCfg(function(e){e&&(t.mapName.string=e.name,t.mapName.node.isBold(!0))},this))},onShow:function(){this.updateMapInfo()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e-130,t-52)}});b8e.module.registerView(game.ME.MainMap,e)}(),function(){var e=game.View.extends({_showModel:!1,_isautoFight:!1,_specialLayer:!0,ctor:function(){this._super(game.baseUIUrl[18]),this.addNodeTouch=!1,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){this.icon=game.GridUtil.createItemIcon(),this.icon.addToParent(this.skin.iconNode);var e=this.anim=b8e.Animator.get(game.AnimType.UI_EFFECT,2);e.addToParent(this.skin.anim),e.load(game.ResCfg.getUrl(5019,1123)),e.setScale(1.2,1.2),e.play(null,0)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_ICON:this.setAward()}},onShow:function(){this.send(this.Evts.V_SHOW_MAIN_RIGHT_VIEW),this.onStageResize()},setAward:function(){var s=this,a=s.skin,i=game.mainInstanceData;i.getCurAwardConfig(function(e){if(e){var t=e.award;if(t&&!(t.length<1)){var a=t[0],i=game.ItemUtil.createBaseItemInfo(a.Id,a.Num,s.awardInfo);game.GridUtil.setItemIcon(s.icon,i,!1,game.IconLayoutEnum.SHOW_NUM);var n=game.InstanceAwardCfg.getData(e.group);n&&(s.skin.des.string=n.des)}}},s),i.canGetMainInsRew(function(e){(a.redPoint.active=e)?a.countLab.string=game.Lang.get(52357):i.getMaxProgress(function(e){if(e){var t=e-i.progress;a.countLab.string=game.Lang.get(52356,t)}},s)},s)},viewMainInstanceBtn:function(){game.mainInstanceData.traceLog(9),game.module.show(game.ME.InstanceAwardPreview)},onStageResize:function(){var e=b8e.stageWidth;this.setPosition(e,670)}});b8e.module.registerView(game.ME.MainUIRight,e)}(),function(){var e=game.View.extends({_showModel:!1,tweenTime:50,_specialLayer:!0,ctor:function(){this._super(game.baseUIUrl[16])},init:function(){this.setLocalZOrder(1001)},notify:function(e,t){switch(e){case this.Evts.V_AMOUNT_CHANGE:this.updateAmount();break;case this.Evts.V_FIRST_DIAMON:this.randomAnimPos(t);break;case this.Evts.C2V_UPDATE_ROLE_INFO:this.updateInfo(t);break;case this.Evts.C2V_UPDATE_ROLE_LV:this.updateLv()}},onShow:function(){this.updateAmount()},updateLv:function(){this.skin.lv.string="Lv."+game.mainRoleData.lv},updateInfo:function(e){e&&(this.skin.name.string=game.HtmlUtil.getColorStrByQuality(e.quality,e.name),this.skin.lv.x=this.skin.name.width+this.skin.name.x+10,this.skin.lv.string="Lv."+e.lv)},updateAmount:function(){var e=game.amount.get(game.AmountType.SILVER),t=game.amount.get(game.AmountType.YUAN_BAO);this.skin.money.string=game.CCommonUtil.replaceNum(e,2),this.skin.gold.string=game.CCommonUtil.replaceNum(t,2)},randomAnimPos:function(e){var t,a,i=this;i.animList||(i.animList=[]),1==e?(t=game.ResCfg.getImgUrl("noticeIcon/21"),a={x:-70.8,y:609}):2==e&&(t=game.ResCfg.getImgUrl("noticeIcon/23"),a={x:134.6,y:609});for(var n=0;n<20;n++){i.animList[n]=b8e.Sprite.get(),i.animList[n].setAnchor(.5,.5),i.animList[n].addToParent(i.skin.anim);var s=10*n*Math.random(0,1);i.animList[n].setPosition(s,10*n*Math.random(0,1)),i.animList[n].loadTexture(t),b8e.Tween.get(i.animList[n]).to({x:2*s,y:300},i.tweenTime*n,b8e.Ease.circIn(2)).to(a,i.tweenTime*n,b8e.Ease.circOut(2)).call(i.removeList,i,[i.animList[n]])}},removeList:function(e){e.release()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e/2,t),this.skin.bg.width=e,this.skin.bg.height=50+b8e.topSpace}});b8e.module.registerView(game.ME.MainUITop,e)}(),function(){var e=game.GameMenuBar.extends({_specialLayer:!0,ctor:function(){this._super(null,game.mainLeftBarData,5),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},onShow:function(){this._super()},notify:function(e,t,a){switch(this._super(e,t,a),e){case this.Evts.C2V_GET_AD_POS:this.getLoginAwardsAdPos();break;case game.ActiveBarEvts.MANYRECHARGE_CHANGEPOS:this.changeAdvertPos();break;case game.ActiveBarEvts.NEW_FIRST_CHARGE2:this.changenewFirstCh()}},_delayRefresh:function(){this._super(),this.getLoginAwardsAdPos(),this.changeAdvertPos(),this.changenewFirstCh()},getLoginAwardsAdPos:function(){this.sysViewToBtn(21)},changeAdvertPos:function(){this.sysViewToBtn(25)},changenewFirstCh:function(){this.sysViewToBtn(132)},sysViewToBtn:function(e){var t=this._barDatas.activeBtns,a=void 0,i=void 0,n=void 0,s=void 0;if(t&&!(t.length<1)){var o=this.btnPool;if(o&&!(o.length<1))for(var r=void 0,g=0;g<t.length;g++)if((a=t[g]).cfg&&a.cfg.activeBarType==e){if(s=a.miscData,game.taskData.task&&0<s.taskBottom&&game.taskData.task.state==game.TaskStateType.COMPLETE_STATE?s.taskBottom:s.marginBottom,!(r=o[g]))return;var l=r.globalToLocal();return void((i=a.cfg.moduleEnum)==game.ME.LoginAwards?(n=b8e.module.getView(game.ME.LoginAwardsMain))&&n.setPosition(76-l.x,265-l.y):i==game.ME.ManyFirstCharge?(n=b8e.module.getView(game.ME.ManyFirstAdvert))&&n.setPosition(76-l.x,270-l.y):i==game.ME.NewFirstCharge&&(n=b8e.module.getView(game.ME.NewFirstChargeGuide))&&n.setPosition(76-l.x,270-l.y))}}},getPos:function(){},_updatePosition:function(){var e=0,t=0,a=game.GameBarMiscCfg.getData(this._miscId);if(a)if(0<a.marginLeft?e=a.marginLeft:0<a.marginRight&&(e=this.parent.width-a.marginRight-this.width),0<a.marginTop){var i=this.parent.localToGlobal();t=b8e.stage.height-i.y-a.marginTop-this.height}else if(0<a.marginBottom||0<a.taskBottom){var n=void 0;n=game.taskData.task&&0<a.taskBottom&&game.taskData.task.state==game.TaskStateType.COMPLETE_STATE?a.taskBottom:a.marginBottom,t=-(this.parent.height-n)}this.setPosition(e,t)}});b8e.module.registerView(game.ME.MainLeftBar,e)}(),function(){var e=game.GameMenuBar.extends({ctor:function(){this._super(null,game.mainActivityNoticeBarData,7)},onShow:function(){this._super()},_layout:function(){var e=this,t=game.GameBarMiscCfg.getData(e._miscId);if(t){e.btns=e._barDatas.getBtns();var a=t.lineCount,i=t.spacingX,n=t.spacingY;e.btnPool.forEach(function(e){e.clearData(),e.setVisible(!1)});for(var s,o,r=e.btns.length,g=0,l=0,c=0,h=0,m=(b8e.module.isShowView(game.ME.MainModulePre),0);m<r;m++){o=e.btns[m],e.btnPool[m]?s=e.btnPool[m]:(s=game.MenuBarItem.get(),e.addChild(s),e.btnPool[m]=s),s.setVisible(!0),s.setData(o),c=o.width+i,h=o.height+n,s.x=m%a*c+o.offsetX+-100,s.y=(m/a>>0)*h+o.offsetY;var u=s.x+c- -100,d=s.y+h;g<u&&(g=u),l<d&&(l=d)}e.setSize(g,l)}},_updatePosition:function(){var e=0,t=0,a=game.GameBarMiscCfg.getData(this._miscId);a&&(0<a.marginLeft?e=a.marginLeft:0<a.marginRight&&(e=this.parent.width-a.marginRight-this.width),0<a.marginTop?t=b8e.stageHeight-a.marginTop:0<a.marginBottom&&(t=-(this.parent.height-a.marginBottom))),this.setPosition(e,t)}});b8e.module.registerView(game.ME.MainActivityNoticeBar,e)}(),function(){var e=game.GameMenuBar.extends({ctor:function(){this._super(null,game.mainRightBarData,6)},onShow:function(){this._super()},_updatePosition:function(){var e=0,t=0,a=game.GameBarMiscCfg.getData(this._miscId);if(a)if(0<a.marginLeft?e=a.marginLeft:0<a.marginRight&&(e=-a.marginRight-this.width),0<a.marginTop){var i=this.parent.globalToLocal();t=b8e.stage.height+i.y-a.marginTop-this.height}else 0<a.marginBottom&&(t=-(this.parent.height-a.marginBottom));this.setPosition(e,t)}});b8e.module.registerView(game.ME.MainRightBar,e)}(),function(){var e=game.View.extends({_showModel:!1,tweenTime:50,_specialLayer:!0,ctor:function(){this._super("base/mainui/MainTopViewByFightAmount")},init:function(){this.setLocalZOrder(1002)},notify:function(e,t){switch(e){case this.Evts.V_AMOUNT_CHANGE:this.updateAmount();break;case this.Evts.V_FIRST_DIAMON:this.randomAnimPos(t);break;case this.Evts.C2V_UPDATE_ROLE_INFO:this.updateInfo(t)}},onShow:function(){this.updateAmount(),this.updateInfo()},updateAmount:function(){var e=game.amount.get(game.AmountType.SILVER),t=game.amount.get(game.AmountType.YUAN_BAO);this.skin.money.string=game.CCommonUtil.replaceNum(e,2),this.skin.gold.string=game.CCommonUtil.replaceNum(t,2)},updateInfo:function(){var e=game.mainRoleData.power;this.skin.fightAmountVal.string=game.CCommonUtil.replaceNum(e,2)},randomAnimPos:function(e){var t,a,i=this;i.animList||(i.animList=[]),1==e?(t=game.ResCfg.getImgUrl("noticeIcon/21"),a={x:-70.8,y:609}):2==e&&(t=game.ResCfg.getUrl(28),a={x:134.6,y:609});for(var n=0;n<20;n++){i.animList[n]=b8e.Sprite.get(),i.animList[n].setAnchor(.5,.5),i.animList[n].addToParent(i.skin.anim);var s=10*n*Math.random(0,1);i.animList[n].setPosition(s,10*n*Math.random(0,1)),i.animList[n].loadTexture(t),b8e.Tween.get(i.animList[n]).to({x:2*s,y:300},i.tweenTime*n,b8e.Ease.circIn(2)).to(a,i.tweenTime*n,b8e.Ease.circOut(2)).call(i.removeList,i,[i.animList[n]])}},removeList:function(e){e.release()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e/2,t),this.skin.bg.width=e,this.skin.bg.height=50+b8e.topSpace}});b8e.module.registerView(game.ME.MainUITopFightAmount,e)}(),function(){var e=game.View.extends({_showModel:!1,_isOpenChat:!1,_chatListMap:null,_selectChannel:game.ChatChannelType.Clash,quickChatId:void 0,ALL_MAX:50,allChatInfos:null,WORLD_GUILD_MAX:30,updateTimeSpace:50,lastTime:0,_specialLayer:!0,ctor:function(){this._super("base/mainui/chat/GuidConflictChatView")},init:function(){var e=this.skin;this._chatListMap=b8e.HashMap.get();var t=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=[game.ChatItemView,game.ChatItemView,game.ChatItemView],t.addToParent(e.scrollViewClash),this._chatListMap.set(game.ChatChannelType.Clash,t),this._chatListMap.forEach(function(e,t){t.bindEnum=game.ME.MainUIChat,t.layout.spacingY=0},this),this.openViewCloseChatList=!1,this._chatInfoListMap=b8e.HashMap.get(),this.ids=[],this.skin.clickBg.touchEffectDisabled=!0},showChatTips:function(){var e=this._selectChannel<=0?game.ChatChannelType.Clash:this._selectChannel;if(!game.ChatCfg.getData(e)){b8e.warn(this._selectChannel,"\u90e8\u843d\u51b2\u7a81\u804a\u5929\u9891\u9053\u4e3a\u5565\u6ca1\u6709\u914d\u7f6e\uff1f")}},notify:function(e,t){var a=this;switch(e){case game.ChatEvts.OPEN_CHAT:a.openChat();break;case game.ChatEvts.SELECT_CHANNEL:null===t?(a.onSelectChannel(a._selectChannel),a.updateChatDataList(a._selectChannel)):(a.onSelectChannel(t),a.updateChatDataList(t));break;case game.ChatEvts.UPDATE_CHANNEL:a.updateChatData(a._selectChannel);break;case game.ChatEvts.SHOW_EDIT_BOX:a.showChatList(t);break;case game.ChatEvts.SHOW_NEW_CHAT:a.showNewPrivateChat(!0)}},onShow:function(){this.skin;this.send(game.ChatEvts.C_SHOW_CHAT_VIEW),this.updateChatData(this._selectChannel),this.onSelectChannel(this._selectChannel,!0),this.showChatTips(),this.startShowChat()},updateChatList:function(){var e=game.chatData.chatTempList;!e||e.length<1||this.updateChatDataList(this._selectChannel)},updateChatDataList:function(e){var t=game.chatData.getChatListByChannelType(this._selectChannel),a=this._chatListMap.get(e);a&&t&&(a.setData(t),b8e.hasTimeout(this.layoutList,this)||b8e.setTimeout(this.layoutList,this,400))},layoutList:function(){var e=this._selectChannel;if(this._chatListMap&&this._chatListMap.has(e)){var t=this._chatListMap.get(e);t&&t.scrollToBottom()}},getChatListByChannelType:function(e){var t=this._chatInfoListMap.get(e);return t||(t=[],this._chatInfoListMap.set(e,t)),t},onHide:function(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)},startShowChat:function(){var e=this;e.timer||(e.timer=setTimeout(function(){e.timer=void 0,e.updateChatList()},50))},onStageResize:function(){this.setPosition(0,200),this.resizeUI()},resizeUI:function(){var e=b8e.stageWidth;this.skin.bg.width=e,this.skin.scrollViewClash.width=e-70,b8e.hasTimeout(this._resizeChatList,this)||b8e.setTimeout(this._resizeChatList,this,300)},_resizeChatList:function(){if(this._chatListMap){b8e.stageWidth;for(var e=this.getChatListByChannelType(this._selectChannel),t=0,a=e.length;t<a;t++)e[t].refresh=e[t].refresh+1;b8e.hasTimeout(this._resetListPos,this)||b8e.setTimeout(this._resetListPos,this,500)}},_resetListPos:function(){var a=b8e.stageWidth;this._chatListMap.forEach(function(e,t){t.setSize(a-150,t.height),t.scrollToBottom()},this)},showChatList:function(e){this.openViewCloseChatList&&(this.skin.allChannel.node.active=!!e)},openChat:function(){var e=this.skin.bg.node;if(b8e.Tween.kill(e),this._isOpenChat=!this._isOpenChat,this._isOpenChat){b8e.Tween.get(e).to({x:e.x,y:e.y+30},200).call(this.reSizeScrollView,this)}else b8e.Tween.get(e).to({x:e.x,y:e.y-30},200).call(this.reSizeScrollView,this)},addQuickContent:function(e,t){this.quickChatId=t,this.skin.input_editbox.string=e},reSizeScrollView:function(){var e=this.skin,a=game.chatData.scrollViewH1,t=game.chatData.scrollViewH2;this._isOpenChat?(e.scrollViewClash.height=t,this._chatListMap.forEach(function(e,t){t.height=130},this),e.up.node.active=!1,e.down.node.active=!0):(e.scrollViewClash.height=a,this._chatListMap.forEach(function(e,t){t.height=a},this),e.up.node.active=!0,e.down.node.active=!1),this._chatListMap.forEach(function(e,t){t.scrollToBottom()},this)},updateChatData:function(){var e=game.chatData.getChatListByChannelType(this._selectChannel);e&&0<e.length&&this.startShowChat()},onSelectChannel:function(e,t){if(1<arguments.length&&void 0!==t&&t||this._selectChannel!=e){var a=this.skin;switch(a.all_btn_select.node.active=!1,a.scrollViewClash.active=!1,e){case game.ChatChannelType.Clash:this._selectChannel=e,a.scrollViewClash.active=!0,a.all_btn_select.node.active=!0}}},blackChange:function(e){this.delChatById(game.ChatChannelType.Clash,e),this.delChatById(game.ChatChannelType.WORLD,e),this.delChatById(game.ChatChannelType.GUILD,e)},delChatById:function(e,t){var a=this._chatListMap.get(e),i=this._chatInfoListMap.get(e);if(a&&i&&0<i.length){var n=i.length,s=void 0,o=void 0;for(o=this.ids.length=0;o<n;o++)(s=i[o]).roleId==t&&this.ids.push(o);n=this.ids.length;var r=void 0;for(o=0;o<n;o++)(s=i[r=this.ids[o]-o])&&game.ChatItemInfo.put(s),i.splice(r,1);a.setData(i)}},placeCb:function(){},clickBtn:function(){game.module.show(game.ME.ChatView),0<game.chatData.unReadNum&&(game.chatData.unReadNum=0,this.updateNum())},updateNum:function(){var e=this.skin,t=game.chatData.unReadNum;e.chatImg.active=0<t,0<t&&(e.chatNum.string=99<t?"+99":t)}});b8e.module.registerView(game.ME.GuidConflictChat,e)}(),function(){var e;e=b8e.Enum({None:0,SWITCH_PAGE:-1}),b8e.RC("$$game","$$PeachGardenEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={},this.handels={}},notify:function(e){},init:function(){this.spotAlert=game.spotAlert.set(game.SAE.PEACH_GARDEN,game.SAE.HOME)},Btn1:function(){this.selectToggle(0)},Btn2:function(){if(game.marryData.hasPartner){this.selectToggle(1)}else game.notice.show(9048)},Btn3:function(){this.selectToggle(2)},Btn4:function(){this.selectToggle(3)},selectToggle:function(e){this.send(this.Evts.SWITCH_PAGE,e)}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.PeachGarden,e,game.PeachGardenEvts,t,[])}(),function(){var e=b8e.Object.extends({ctor:function(){this._super()}});game.peachGardenData=game.peachGardenData||new e}(),function(){var e=game.View.extends({ctor:function(){this._super(1177),this.toggles={tab1_select:game.ME.Marry,tab2_select:game.ME.House,tab3_select:game.ME.MasterApprentice,tab4_select:null},this.spotAlerts={HOUSE_ADV_ALERT:this.houseAlert,MASTER_APPRENTICE:this.masterAlert}},houseAlert:function(e){this.skin.red_spot_2.node.active=e.alert},masterAlert:function(e){this.skin.red_spot_3.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.SWITCH_PAGE:this.toggleSelect(t)}},toggleSelect:function(e){var t=this;if(t._super(e))switch(e){case 0:t.skin.marry.active=!0,t.skin.MasterApprentice.active=!1,t.skin.house.active=!1;break;case 1:t.skin.marry.active=!1,t.skin.MasterApprentice.active=!1,t.skin.house.active=!0;break;case 2:t.skin.marry.active=!1,t.skin.MasterApprentice.active=!0,t.skin.house.active=!1}else;},onShow:function(){},onHide:function(){},updateView:function(){}});b8e.module.registerView(game.ME.PeachGarden,e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(84,84)},init:function(){this._icon=game.GridUtil.createItemIcon(game.IconSizeEnum.CIRCLE_SIZE_84),this._icon.setPosition(42,-42),this._icon.addToParent(this)},setData:function(){game.GridUtil.setItemIcon(this._icon,this.data,!1,2)}})).poolCall=!0,b8e.RC("$$game","$$FosterAchievementAwardItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,_data:null,ctor:function(){this._super(),this.setSize(89,110)},setData:function(){var e=this;if(e.data){var t=e.data.iconLayoutEnum?e.data.iconLayoutEnum:game.IconLayoutEnum.SHOW_NUM,a=e.data.iconSize?e.data.iconSize:game.IconSizeEnum.GRID_SIZE_105;e._icon||(e._icon=game.GridUtil.createPrizeIcon(a),e._icon.setPosition(50,-53),e._icon.addToParent(e)),game.GridUtil.setItemIcon(e._icon,e.data,!1,t)}else;}});b8e.RC("$$game","$$PrizeListItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(70,70)},setData:function(){var e=this.data.iconSize?this.data.iconSize:game.IconSizeEnum.GRID_SIZE_105;this._icon||(this._icon=game.GridUtil.createPrizeIcon(e),this._icon.setPosition(50,-52),this._icon.addToParent(this)),game.GridUtil.setItemIcon(this._icon,this.data,!1,0)}}),b8e.RC("$$game","$$ShowEquipListItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(70,70)},setData:function(){var e=this.data.iconSize?this.data.iconSize:game.IconSizeEnum.GRID_SIZE_105;this._icon||(this._icon=game.GridUtil.createPrizeIcon(e),this._icon.setPosition(50,-52),this._icon.addToParent(this)),game.GridUtil.setItemIcon(this._icon,this.data,!1,0)}}),b8e.RC("$$game","$$ShowFosterEquipListItem",e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(70,70)},setData:function(){var e=this;if(e.data){var t=e.data.iconLayoutEnum?e.data.iconLayoutEnum:game.IconLayoutEnum.SHOW_NUM,a=e.data.iconSize?e.data.iconSize:game.IconSizeEnum.GRID_SIZE_105;e._icon||(e._icon=game.GridUtil.createPrizeIcon(a),e._icon.setPosition(50,-52),e._icon.addToParent(e)),game.GridUtil.setItemIcon(e._icon,e.data,!1,t)}else;}})).poolCall=!0,b8e.RC("$$game","$$ShowItemListItem",e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(68,68)},init:function(){this._icon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_69),this._icon.setPosition(35,-35),this._icon.addToParent(this)},setData:function(){if(this.data){var e=game.ItemInfoCfg.getData(this.data.id);this._icon.setItemInfo(e,!1,!1),this._icon.setNum(this.data.num)}else;}})).poolCall=!0,b8e.RC("$$game","$$CsGuildBossAwardListItem",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_CLOSE_RESULTWIN:-1}),b8e.RC("$$game","$$GetRewardResultEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.prizes=[]},setData:function(e,t){if(e){if(0<this.prizes.length)for(var a=0;a<this.prizes.length;a++)this.prizes[a].release();for(var i=this.prizes.length=0;i<e.length;i++){var n=e[i],s=n.id;0!=s&&this.prizes.push(game.ItemUtil.createBaseItemInfo(s,n.num))}this.cdTime=t||5}}});game.getRewardResultData=game.getRewardResultData||new e}(),function(){var e=game.Control.extends({okBtn:function(){this.send(this.Evts.C2V_CLOSE_RESULTWIN)}});b8e.module.registerControl(game.ME.GetRewardResult,e,game.GetRewardResultEvts)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1176)},notify:function(e){switch(e){case this.Evts.C2V_CLOSE_RESULTWIN:game.module.hide(game.ME.GetRewardResult)}},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this._list.itemRender=game.PrizeListItem,this._list.addToParent(this.skin.node_prize)},onShow:function(){game.TweenUtil.rotationEffect(this.skin.light),this.updateView()},updateView:function(){var e=game.getRewardResultData;e&&(this.countDownTime=e.cdTime,this.createPrize(e.prizes),this.updateTime(),this.createCountDown())},createCountDown:function(){if(!this.timer){this.timer=b8e.Timer.add(this,this.updateTime,1e3)}this.timer.reset(),this.timer.start()},clearCountDown:function(){if(this.timer)b8e.Timer.remove(this,this.updateTime),this.timer=null;else;},updateTime:function(){if(this.countDownTime--,this.skin.timeLab.string=game.Lang.get(598,this.countDownTime),this.countDownTime<1){game.module.hide(game.ME.GetRewardResult)}},createPrize:function(e){0==e.length&&this._list?this._list.clear():this._list.setData(e)},onHide:function(){b8e.Tween.kill(this.skin.light),this.clearCountDown()},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.GetRewardResult,e)}(),b8e.module.registerControl(game.ME.SceneCollectBar,game.Control,null,null),function(){var e=game.Control.extends({init:function(){game.sceneHelper.init();this.chat={chatType:game.ChatChannelType.CROSS,funcType:game.ChatFuncType.CHAT_FUNC_DANGER_AREA}},ipc:function(){var e=this;e.evts={CsWar:{C2C_LOOK_PLAYERINFO:e.lookPlayerInfo},GuanDu:{C2C_PLAYER_INFO:e.lookPlayerInfo},Home:{C2C_SHOW_VIEW:e.showHomeView,C2C_HIDE_VIEW:e.hideHomeView}},e.gevts={SceneGEvts:{CHANGE_SCENE:e.changeScene,ENTER_SCENE:e.enterScene,LEAVE_SCENE:e.leaveScene,CLEAR_SCENE:e.clearScene,CLICK_CSWAR_MINE:e.clickCsWarBox,SCENE_EXIT:e.sceneExit,SCENE_REVIVE:e.sceneRevive,CLICK_BOX:e.reqCollect,COLLECT_READ_PROGRESS_COMPLETE:e.reqCollectFinish,SCENE_CHALLENGE:e.sceneChallenge,SCENE_AUTO_CHALLENGE:e.autoSceneChallenge,SCENE_REQ_NPC:e.reqNpc},InstanceEvts:{G_STOP_PLAY:e.onScenePlayEndReq}},e.handels={SceneReadyResp:e.onSceneReadyResp,RobotMsg:e.onRobotMsg,SceneUnitMsg:e.onSceneUnitMsg,SceneLeaveResp:e.onSceneLeaveResp,SceneLeaveMsg:e.onSceneLeaveMsg,SceneMoveResp:e.onSceneMoveResp,SceneMoveMsg:e.onSceneMoveMsg,SceneStopMoveMsg:e.onSceneStopMoveMsg,SceneCollectResp:e.onSceneCollectRsp,SceneCollectMsg:e.onSceneCollectMsg,SceneFinishCollectResp:e.onSceneFinishCollectRsp,SceneFinishCollectMsg:e.onSceneFinishCollectMsg,SceneReviveResp:e.onSceneReviveRsp,SceneMoveToMapMsg:e.onSceneMoveToMapMsg,SceneReviveMsg:e.onSceneReviveMsg,SceneChallengeResp:e.onSceneChallengeRsp,SceneChallengeMsg:e.onSceneChallengeMsg,ScenePlayEndResp:e.onScenePlayEndResp,SceneBattleStateMsg:e.onSceneBattleStateMsg,SceneFollowMsg:e.onSceneFollowMsg,SceneMoveToPosMsg:e.onSceneMoveToPosMsg,ScenePlayerInfoResp:e.onScenePlayerInfoResp,GuanDuWarTowerStateMsg:e.towerStateMsg,SceneAbandonTowerResp:e.sceneAbandonTowerResp,SceneBattleMsg:e.onSceneBattleMsg,SceneNpcResp:e.onSceneNpcResp}},onSceneReadyResp:function(e){var t=e.readProtobuf(game.pb.SceneReadyResponse);0<t.code&&game.notice.noticeError(t.code)},onRobotMsg:function(e){var t=e.readProtobuf(game.pb.RobotNotify);game.scene.robotMsg(t.datas)},onSceneUnitMsg:function(e){var t=e.readProtobuf(game.pb.SceneUnitNotify);game.scene.setSceneUnit(t.units);this.dptG(this.Evts.SCENE_ADD_DISPLAY)},onSceneLeaveResp:function(e){var t=e.readProtobuf(game.pb.SceneLeaveResponse);0<t.code?game.notice.noticeError(t.code):game.scene.mainLeaveScene()},onSceneLeaveMsg:function(e){var t=e.readProtobuf(game.pb.SceneLeaveNotify);game.scene.sceneRoleLeaveMsg(t.id,t.type)},onSceneMoveResp:function(e){var t=e.readProtobuf(game.pb.SceneMoveResponse);0<t.code&&game.notice.noticeError(t.code)},onSceneMoveMsg:function(e){var t=e.readProtobuf(game.pb.SceneMoveNotify);game.scene.moveMsg(t.id,t.x,t.y)},onSceneStopMoveMsg:function(){},onSceneCollectRsp:function(e){var t=e.readProtobuf(game.pb.SceneCollectResponse);if(0<t.code)return game.module.hide(game.ME.SceneCollectBar),void game.notice.noticeError(t.code);this.dptG(this.Evts.SCENE_COLLECT)},onSceneCollectMsg:function(e){var t=e.readProtobuf(game.pb.SceneCollectNotify),a=t.id,i=t.targetId;this._onShowCollectBar(a,i)},_onShowCollectBar:function(e,t){e==game.mainRoleData.id&&(game.sceneData.collectId=t,game.module.show(game.ME.SceneCollectBar))},onSceneFinishCollectRsp:function(e){game.module.hide(game.ME.SceneCollectBar);var t=e.readProtobuf(game.pb.SceneFinishCollectResponse);if(0<t.code)game.notice.noticeError(t.code);else{this.dptG(this.Evts.SCENE_COLLECT_FINISH)}},onSceneFinishCollectMsg:function(){this.dptG(this.Evts.SCENE_COLLECT_FINISH_NOTIFY)},towerStateMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarTowerStateNotify);if(0<t.code)game.notice.noticeError(t.code);else{this.dptG(this.Evts.TOWER_STATE,t)}},onSceneReviveRsp:function(e){var t=e.readProtobuf(game.pb.SceneReviveResponse);0<t.code&&game.notice.noticeError(t.code)},onSceneMoveToMapMsg:function(e){var t=e.readProtobuf(game.pb.SceneMoveToMapNotify);0<t.code?game.notice.noticeError(t.code):game.scene.moveToMap(t.mapId,t.lineId)},onSceneReviveMsg:function(e){for(var t=e.readProtobuf(game.pb.SceneReviveNotify),a=t.ids,i=0,n=a.length;i<n;i++)game.scene.sceneRevive(a[i],t.x,t.y),a[i]==game.mainRoleData.id&&this.dptG(this.Evts.MAIN_ROLE_REVIVE)},onSceneChallengeRsp:function(e){var t=e.readProtobuf(game.pb.SceneChallengeResponse);0<t.code?game.notice.noticeError(t.code):game.scene.mainChallengeMsg(t)},onSceneChallengeMsg:function(e){var t=e.readProtobuf(game.pb.SceneChallengeNotify);0<t.code?game.notice.noticeError(t.code):game.scene.sceneRoleChallengeMsg(t)},onScenePlayEndResp:function(e){var t=e.readProtobuf(game.pb.ScenePlayEndResponse);0<t.code?game.notice.noticeError(t.code):game.scene.onScenePlayEndResp()},onSceneBattleStateMsg:function(e){var t=e.readProtobuf(game.pb.SceneBattleStateNotify);game.scene.onSceneBattleStateMsg(t)},onSceneFollowMsg:function(e){var t=e.readProtobuf(game.pb.SceneFollowNotify);game.scene.sceneFollowMsg(t)},onSceneMoveToPosMsg:function(e){var t=e.readProtobuf(game.pb.SceneMoveToPosNotify);game.scene.moveToPos(t)},onScenePlayerInfoResp:function(e){var t=e.readProtobuf(game.pb.ScenePlayerInfoResponse);game.scene.scenePlayerInfo(t)},sceneAbandonTowerResp:function(e){var t=e.readProtobuf(game.pb.SceneAbandonTowerResponse);0<t.code&&game.notice.noticeError(t.code)},onSceneBattleMsg:function(e){var t=e.readProtobuf(game.pb.SceneBattleNotify);game.scene.onSceneBattleMsg(t)},onSceneNpcResp:function(e){var t=e.readProtobuf(game.pb.SceneNpcResponse);0<t.code&&game.notice.noticeError(t.code)},onClickMap:function(e){game.sceneHelper.clickMap(e.data)},onClickEntity:function(e){game.sceneHelper.clickEntiy(e.data)},changeScene:function(e){if(!e.data){b8e.error("\u8bf7\u6c42\u6539\u53d8\u573a\u666f\u9519\u8bef\uff0c\u573a\u666fid"+e.data)}},enterScene:function(){var e=this;game.reconnect.isLoginAgain?e.reconnectEnterScene():e.firstEnterScene(),b8e.module.isShowView(game.ME.SceneRevive)&&game.module.hide(game.ME.SceneRevive);var t=game.sceneData.getConfig();if(!t||t.type!=game.SceneType.NONE0&&t.type!=game.SceneType.NONE1||game.csWarTeamData.clearTeamData(),t&&t.type!=game.SceneType.NONE0&&t.type!=game.SceneType.NONE1&&e.dpt(e.Evts.ENTER_CS_SCENE),game.sceneData.isCsScene()){if(t&&t.type!=game.SceneType.TREASURE&&(game.chatData.addChat(e.chat),e.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)),t)switch(t.type){case game.SceneType.GUANDU_MAP:e.dptG(e.Evts.C2C_HIDE_CARD);break;case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:game.guildWarData.isAutoChallenge=!1,game.guildWarData.isClickChallenge=!1}}else e._restoreMainRole();e.sender.SceneReadyReq(),e.dptG(game.InstanceEvts.G_RESTAR_AI),e.dptG(e.Evts.CSWARTEAM_INFO)},_restoreMainRole:function(){if(game.scene.isDelayRun)return game.scene.isDelayRun=!1,game.follow.clear(),void this._createMainRole();if(game.reconnect.isLoginAgain){var e=game.LoginConfig.heroData;if(e){var t=game.mainRoleData;game.mainRoleData=game.HeroData.get(game.RoleType.Hero,e.id),game.mainRoleData.setMainRoleData(e),game.mainRoleData.heroModel=t.heroModel,game.mainRoleData.avatar.setup(game.mainRoleData.heroModel),this._createMainRole()}this.firstEnterScene(),game.reconnect.isLoginAgain=!1}},_createMainRole:function(){if(game.mainRole=game.sceneRoleCreate.createMainRole(),b8e.scene.getCamera().setFocusTarget(game.mainRole),!game.sceneData.isCsScene()){b8e.hasTimeout(this._createPartners,this)||b8e.setTimeout(this._createPartners,this,1e3)}},_createPartners:function(){var e=game.partnerData;e&&e.partnerSlots&&(game.sceneData.clearMonsterIds(),game.scene.createPartners(game.mainRole,e.partnerSlots))},firstEnterScene:function(){if(game.sceneData.isFirst){this.dptG(this.Evts.FIRST_ENTER_SCENE),b8e.scene.addEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,this.onClickMap,this),b8e.scene.addEventListener(b8e.SceneEvent.SCENE_ENTITY_CLICK,this.onClickEntity,this),game.sceneData.isFirst=!1,game.sdk.checkSetState(),this.dptG(game.ActiveBarGEvts.REFRESH_BTNS)}},showHomeView:function(){game.sceneData.isShowHome&&(game.GameLevelMgr.inst().enterScene(),b8e.evt.dptG(game.SceneGEvts.ENTER_SCENE),this.timerKey=b8e.setTimeout(this.hideLoading,this,800))},hideLoading:function(){game.loadingPage.hide(),this.timerKey&&(b8e.clearTimeout(this.timerKey),this.timerKey=0)},hideHomeView:function(){game.sceneData.isShowHome&&(game.sceneData.isShowHome=!1)},reconnectEnterScene:function(){game.scene.rmvBattleState(game.mainRole),game.csSceneData.clearSceneData(),game.csWarTeamData.clearTeamData(),game.CsArrowData.reset(),game.scene.leaveGuandu(),game.scene.removeSelf(),game.follow.clear(),game.exploreScene.unactiveScene(),game.guildConflictScene.leaveScene(),game.throneData.isOpen(!1)&&game.throneData.setCoolTime(),game.csTreasureData.isOpen(!1)&&game.csTreasureData.setCoolTime(),game.moduleOpen.checkOpen(game.ME.CsBoss)&&game.csBossData.isOpen&&game.csBossData.setCoolTime(),b8e.module.isShowView(game.ME.Map)&&game.module.hide(game.ME.Map),this.dpt(this.Evts.C2C_RECONNECT_ENTER_SCENE)},leaveScene:function(){game.reconnect.isLoginAgain&&(game.sceneData.lastSceneId=0)},clearScene:function(){game.sceneData.isFirst=!0,b8e.scene.removeEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,this.onClickMap,this),b8e.scene.removeEventListener(b8e.SceneEvent.SCENE_ENTITY_CLICK,this.onClickEntity,this)},clickCsWarBox:function(e){e&&e.data&&this.sender.SceneMoveReq(e.data.x,e.data.y)},sceneChallenge:function(){var e=game.scenePick.target;if(e){var t=e.id?e.id:e.unitId;if(t!=game.mainRoleData.id){var a,i=e.type==game.SceneUnitType.PLAYER||e.type==game.RoleType.Hero;switch(game.sceneData.getSceneType()){case game.SceneType.CS_BOSS:a=i?game.InstanceType.CS_PVP:game.InstanceType.CS_PVE;break;case game.SceneType.THRONE:a=i?game.InstanceType.THRONE_PVP:game.InstanceType.THRONE_PVE;break;case game.SceneType.CS_ARROW:a=game.InstanceType.CS_ARROW;break;case game.SceneType.CS_GUILD:a=i?game.InstanceType.CS_GUILD_PVP:game.InstanceType.CS_GUILD_PVE;break;case game.SceneType.TREASURE:a=game.InstanceType.TREASURE}if(a==game.InstanceType.CS_GUILD_PVP&&e.data&&e.data.guildId==game.guildData.id)game.notice.show(52219);else{if(a==game.InstanceType.CS_PVP||a==game.InstanceType.THRONE_PVP){var n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,t);if(!n||!n.data)return;if(n.data.isFighting)return void game.notice.show(728)}this.sender.SceneChallengeReq(a,t)}}else game.notice.show(727)}},autoSceneChallenge:function(e){var t=e.data;game.sceneHelper.autoSceneChallenge(t)},sceneExit:function(){this.sender.SceneLeaveReq()},sceneRevive:function(e){this.sender.SceneReviveReq(e.data)},reqCollect:function(){var e=game.scenePick.target;e&&e.id&&e.type==game.RoleType.Collect&&this.sender.SceneCollectReq(e.id)},reqCollectFinish:function(){this.sender.SceneFinishCollectReq()},reqNpc:function(e){if(e&&e.data){var t=e.data.npcId,a=e.data.unitId;this.sender.SceneNpcReq(t,a)}},onScenePlayEndReq:function(){game.sceneData.isCsScene()&&(game.sceneData.isGuildConflict()||this.sender.ScenePlayEndReq())},lookPlayerInfo:function(e){if(e&&e.data){var t=e.data;this.sender.ScenePlayerInfoReq(t)}}}),t=game.Sender.extends({ipc:function(){this.msg={SceneReadyReq:null,SceneMoveReq:this.sceneMoveReq,NextMapReq:null,SceneLeaveReq:null,ScenePlayEndReq:null,SceneFinishCollectReq:null,SceneChallengeReq:this.sceneChallengeReq,SceneReviveReq:this.sceneReviveReq,SceneCollectReq:this.sceneCollectReq,ScenePlayerInfoReq:this.scenePlayerInfoReq,SceneAbandonTowerReq:null,SceneNpcReq:this.sceneNpcReq}},sceneMoveReq:function(e,t){var a=game.pb.SceneMoveRequest;a.x=e,a.y=t,this.write(a)},sceneChallengeReq:function(e,t){var a=game.pb.SceneChallengeRequest;a.id=t,a.clientParam=e,this.write(a)},sceneReviveReq:function(e){var t=game.pb.SceneReviveRequest;t.type=e,this.write(t)},sceneCollectReq:function(e){var t=game.pb.SceneCollectRequest;t.id=e,this.write(t)},scenePlayerInfoReq:function(e){var t=game.pb.ScenePlayerInfoRequest;t.id=e,this.write(t)},sceneNpcReq:function(e,t){var a=game.pb.SceneNpcRequest;a.npcId=e,a.unitId=t,this.write(a)}});b8e.module.registerControl(game.ME.Scene,e,game.SceneGEvts,t)}(),function(){var e=b8e.Object.extends({moveType:0,_toPos:null,_control:null,_movePath:null,chaseEntiy:null,lastSceneEntiy:null,isClickMap:!1,init:function(){this._control=b8e.module.getControl(game.ME.Scene),this._sender=this._control?this._control.sender:null,this._toPos={x:0,y:0}},clickEntiy:function(e){this._clickEntiy(e)},clickMap:function(e){b8e.log(e),this._clickMap(e)},_clickEntiy:function(e){var t=game.sceneData.getSceneType();if((t==game.SceneType.CSWAR||!this._isDeath(game.RoleType.Hero,game.mainRoleData.id))&&e)if(game.GameLevelMgr.inst().isInstanceMode)game.scenePick.pick(e);else if(game.follow.isFollow())game.notice.show(3920);else switch(t){case game.SceneType.CS_BOSS:case game.SceneType.CS_GUILD:game.scenePick.pick(e,!1),this._csClickEntiy(e);break;case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:game.guildWarData.isCanAutoChallage(!0)&&(game.scenePick.pick(e,!1),this._csGuildWarClickEntiy(e));break;case game.SceneType.THRONE:game.throneData.sceneEntityTarget=e,game.scenePick.pick(e,!1),this._csClickEntiy(e),game.throneData.setRoleState(e);break;case game.SceneType.GUANDU_MAP:game.guanDuData.clickEntiy(e);break;case game.SceneType.GUILD_CONFLICT:case game.SceneType.CS_ARROW:var a=e.data;b8e.evt.dptG(game.SceneGEvts.CLICK_HERO,a);break;case game.SceneType.TREASURE:if(e.data&&e.data.type==game.RoleType.Monster){var i=game.csTreasureData.getRemainChallengeTm();if(0<i)return void game.notice.show(6924,i)}game.scenePick.pick(e,!1),this._csClickEntiy(e);break;default:game.GameLevelMgr.inst().pickEntity(e)}},_clickMap:function(e){if(!game.playBackScene.isSceneShow&&!game.mainRole.getStateMachine().isDeath())if(game.follow.isFollow())game.notice.show(3918);else{var t=this;game.challengeIcon.hide(),t.moveType=game.SceneMoveType.CLICK_MAP;var a=b8e.scene.getGridPosByPixel(e.x,e.y);switch(t._toPos.x=a.x,t._toPos.y=a.y,game.sceneData.getSceneType()){case game.SceneType.CS_BOSS:case game.SceneType.TREASURE:t.moveToPos(t._toPos);break;case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:if(game.guildWarData.isCanAutoChallage(!0)){var i=game.mainRole.data;i&&!i.guildWarOwner&&t.moveToPos(t._toPos)}break;case game.SceneType.THRONE:game.throneData.sceneEntityTarget=null,game.throneData.resetRoleState(),t.moveToPos(t._toPos);break;case game.SceneType.GUANDU_MAP:game.guanDuData.checkClickMap(t._toPos);break;case game.SceneType.CSWAR:break;case game.SceneType.CS_ARROW:if(!game.CsArrowData.getIsMove())return;t.moveToPos(t._toPos);break;case game.SceneType.GUILD_CONFLICT:break;default:game.moveTo.selfMove(t._toPos,!0,t._selfMoveComplete,t)}b8e.evt.dptG(game.SceneGEvts.CANCEL_AUTO_CHALLENGE),game.scenePick.pick(null)}},_csClickEntiy:function(e){var t=this,a=e.data;if(a)switch(a.type){case game.RoleType.Monster:t.moveType=game.SceneMoveType.CLICK_MONSTER;break;case game.RoleType.Hero:if(game.sceneData.getSceneType()==game.SceneType.CS_BOSS){if(t._isDeath(game.RoleType.Hero,a.id)||t.isSameGuild(e)||2!=game.csBossData.state)return t.moveType=game.SceneMoveType.CLICK_MAP,void t.moveToEntiy(e);t.moveType=game.SceneMoveType.CLICK_PLAYER}else{if(t._isDeath(game.RoleType.Hero,a.id))return;t.moveType=game.SceneMoveType.CLICK_PLAYER}break;case game.RoleType.Collect:t.moveType=game.SceneMoveType.CLICK_BOX;break;case game.RoleType.Npc:t.moveType=game.SceneMoveType.CLICK_NPC;break;default:t.moveType=game.SceneMoveType.CLICK_MAP}else t.moveType=game.SceneMoveType.CLICK_MAP;if(t.calEntiyDistance(e)<=3){var i=game.mainRole.getGridPosition();t.sceneMoveNotify(game.mainRole,i.x,i.y)}else t.moveToEntiy(e,3)},_csGuildWarClickEntiy:function(e){var t=this,a=e.data;if(!t.isSameGuild(e)&&a){var i=game.mainRole.data;if(i&&i.guildWarOwner)return;switch(a.type){case game.RoleType.Monster:t.moveType=game.SceneMoveType.CLICK_MONSTER;break;case game.RoleType.Hero:if(t._isDeath(game.RoleType.Hero,a.id))return;t.moveType=game.SceneMoveType.CLICK_PLAYER;break;case game.RoleType.Tower:t.moveType=game.SceneMoveType.CLICK_TOWER;break;default:t.moveType=game.SceneMoveType.CLICK_MAP}}else t.moveType=game.SceneMoveType.CLICK_MAP;var n=t.calEntiyDistance(e),s=game.guildWarData.challengeDistance;if(n<=s){var o=game.mainRole.getGridPosition();t.sceneMoveNotify(game.mainRole,o.x,o.y)}else t.moveToEntiy(e,s)},moveToEntiy:function(e,t){var a=game.mainRole.getGridPosition(),i=this._toPos,n=this.calEntiyDistance(e);if(0<t&&t<n){var s=b8e.scene.findPath(a.x,a.y,i.x,i.y,!1);if(s&&0<s.length){for(var o,r=0,g=s.length;r<g&&!((o=s[r])&&b8e.MathUtil.getDistance(o.x,o.y,i.x,i.y)<=t);r++);i=o}}this.moveToPos(i)},calEntiyDistance:function(e){var t=game.mainRole.getGridPosition(),a=this._toPos;return a.x=e.gridX,a.y=e.gridY,b8e.MathUtil.getDistance(t.x,t.y,a.x,a.y)},_moveToPosDistance:function(e,t){var a=game.mainRole.getGridPosition(),i=e,n=this._calPosDistance(e);if(0<t&&t<n){for(var s,o=b8e.scene.findPath(a.x,a.y,i.x,i.y,!1),r=0,g=o.length;r<g&&(s=o[r],!(b8e.MathUtil.getDistance(s.x,s.y,i.x,i.y)<=t));r++);i=s}this.moveToPos(i)},_calPosDistance:function(e){var t=game.mainRole.getGridPosition(),a=e;return b8e.MathUtil.getDistance(t.x,t.y,a.x,a.y)},sceneMoveNotify:function(e,t,a){if(e){var i=this._toPos;i.x=t,i.y=a;var n=e.data;n&&n.isSelf?game.moveTo.move(e,i,0,1,!0,this._moveComplete,this):game.moveTo.move(e,this._toPos)}},_moveComplete:function(){if(!this._checkMove()){var e=this._control,t=game.sceneData.getSceneType();if(t===game.SceneType.CS_BOSS||t===game.SceneType.CS_GUILD||t===game.SceneType.CS_GUILD_WAR_LY||t===game.SceneType.CS_GUILD_WAR_HG||t===game.SceneType.CS_GUILD_WAR_LD||t===game.SceneType.TREASURE){e=this._control;b8e.evt.dptG(e.Evts.MAIN_MOVE_COMPLETE,this.moveType)}else if(t===game.SceneType.GUANDU_MAP)if(game.guanDuData.isChase){var a=game.sceneHelper.chaseEntiy;game.sceneHelper.calEntiyDistance(a)<=3?(game.guanDuData.isChase=!1,b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE)):game.sceneHelper.moveToEntiy(a,3)}else b8e.module.isShowView(game.ME.GuanDuAlert)&&game.module.hide(game.ME.GuanDuAlert)}},moveToPos:function(e){if(game.scene.getDisplayById(game.mainRole.id)){var t=game.mainRole.getGridPosition(),a=this._movePath=b8e.scene.findPath(t.x,t.y,e.x,e.y,!0);a&&0<a.length&&(e=a[0]).x==t.x&&e.y==t.y&&a.shift(),this._checkMove()}},_isDeath:function(e,t){var a=b8e.scene.getDisplayByTypeAndId(e,t);return!a||a.getStateMachine().isDeath()},isSameGuild:function(e){if(!e||!e.data||e.type!=game.RoleType.Hero)return!1;var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.data.id);if(!t||!t.data)return!1;var a=t.data.guildId;return 0<a&&a==game.guildData.id},_checkMove:function(){var e=this._movePath;if(!e||e.length<1)return!1;var t=e.shift();return this._sender.SceneMoveReq(t.x,t.y),this.sceneMoveNotify(game.mainRole,t.x,t.y),!0},_selfMoveComplete:function(){game.GameLevelMgr.inst().isInstanceMode&&game.mainRole.runAi()},autoSceneChallenge:function(e){var t=game.sceneData.monsterIds;if(!(t.length<1))for(var a,i=0,n=t.length;i<n;i++)if((a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,t[i]))&&!a.getStateMachine().isDeath()&&(!e||a.data.configId==e))return void this.clickEntiy(a)},_abandonTower:function(){this._alertOptions||(this._alertOptions={lang:6550,okcb:this.onClickGameAlert,thisArg:this}),game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(){this._sender.SceneAbandonTowerReq()}});game.sceneHelper=game.sceneHelper||new e}(),function(){var e=game.Control.extends({init:function(){this._reliveOptions={lang:723,okcb:this.onClickReliveAlert,thisArg:this}},ipc:function(){this.gevts={SceneGEvts:{MAIN_ROLE_REVIVE:this.onRevive,MAIN_ROLE_DIE:this.onDie}}},onDie:function(){if(game.sceneData.isAutoRelive&&!game.sceneData.isGuildWar()){var e=game.amount.get(game.AmountType.YUAN_BAO),t=game.CsMiscCfg.getData("revivalCost");if((t?parseInt(t.value):200)<=e)return void b8e.evt.dptG(game.SceneGEvts.SCENE_REVIVE,2)}game.module.show(game.ME.SceneRevive)},onRevive:function(){game.module.hide(game.ME.SceneRevive)},reliveBtn:function(){game.sceneData.isGuildWar()?(this._reliveOptions.lang=6531,this._reliveOptions.langArgs=[Number(game.CsMiscCfg.getData("guildWarReviveCost").value)]):this._reliveOptions.lang=723,game.alert.showTwo(this._reliveOptions)},onClickReliveAlert:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_REVIVE,2)}});b8e.module.registerControl(game.ME.SceneRevive,e,null,null)}(),function(){var e=b8e.Object.extends({isFirst:!0,moveType:0,isAutoRelive:!1,collectId:0,mapId:0,lastSceneId:0,lineId:0,isShowHome:!1,_monsterIds:null,monsterIds:{get:function(){return this._monsterIds||(this._monsterIds=[]),this._monsterIds}},currentPlayerInfo:null,sceneId:{get:function(){if(game.mainRoleData){return game.mainRoleData.mapId}return 0}},clearMonsterIds:function(){this._monsterIds&&(this._monsterIds.length=0)},getConfig:function(){return game.SceneCfg.getData(this.sceneId)},getLastConfig:function(){return 0<this.lastSceneId?game.SceneCfg.getData(this.lastSceneId):null},getSceneType:function(){var e=this.getConfig();return e?e.type:game.SceneType.NONE0},getSceneTypeById:function(e){var t=game.SceneCfg.getData(e);return t?t.type:game.SceneType.NONE0},getLastSceneType:function(){var e=this.getLastConfig();return e?e.type:null},isGuildConflict:function(){return this.getSceneType()==game.SceneType.GUILD_CONFLICT},isCsScene:function(e){var t=this.getSceneType(),a=game.SceneType;if(!e&&t===a.CS_GUILD)return!0;switch(t){case a.CS_BOSS:case a.CSWAR:case a.GUANDU_MAP:case a.CS_ARROW:case a.THRONE:case a.CS_GUILD_WAR_LY:case a.CS_GUILD_WAR_HG:case a.CS_GUILD_WAR_LD:case a.TREASURE:case a.GUILD_CONFLICT:return!0}return!1},isGuildMap:function(e){var t=!(0<arguments.length&&void 0!==e)||e;return this.getSceneType()==game.SceneType.GUILD_MAP&&(t&&game.notice.show(4601),!0)},isGuildWar:function(){var e=this.getSceneType(),t=game.SceneType;return e===t.CS_GUILD_WAR_LY||e===t.CS_GUILD_WAR_HG||e===t.CS_GUILD_WAR_LD},setSceneBattle:function(e){this._isSceneBattle=e},isSecneBattle:function(){return this._isSceneBattle},canEnterHome:function(){if(!this._enterHomes){var e=game.GlobalCfg.enterHome();this._enterHomes=e.split(",")}return!!(this._enterHomes&&1<this._enterHomes.length&&game.TimeUtil.getDateDiffDay(1e3*game.mainRoleData.createTime,game.SysTime.curTime)>=this._enterHomes[0]&&game.mainRoleData.lv>=this._enterHomes[1])}});game.sceneData=game.sceneData||new e}(),function(){var e;e=b8e.Enum({CLICK_MAP:0,CLICK_PLAYER:1,CLICK_MONSTER:2,CLICK_BOX:3,CLICK_TOWER:4,CLICK_NPC:5}),b8e.RC("$$game","$$SceneMoveType",e)}(),function(){var e;e=b8e.Enum({NONE:0,PLAYER:1,MONSTER:2,BOX:3,MINE:4,TOWER:5,NPC:6,PARTNER:99}),b8e.RC("$$game","$$SceneUnitType",e)}(),function(){var t=void 0;(t=b8e.PoolObject.extends({idx:0,name:"",level:0,SceneUnitType:0,x:0,y:0,hp:0,maxHp:0,roleId:0,isMale:!1,surface:null,zone:0,guildName:"",camp:0,teamId:0,teamLeader:0,mineUnitId:0,id:0,master:0,count:0,guildWarOwner:!1,ctor:function(){this._super(),this.type=game.RoleType.Hero,this.reset(),t.count++},setSceneUnitInfo:function(e){var t=this,a=game.SceneUnitType;switch(t.idx=e.id,t.name=e.name,t.level=e.level,t.sceneUnitType=e.type,t.x=e.x,t.y=e.y,t.hp=e.hp,t.maxHp=e.maxHp,t.sceneUnitType){case a.PLAYER:t.setPlayerInfo(e.player),t.type=game.RoleType.CsWarHero;break;case a.MONSTER:t.setMonsterInfo(e.monster);break;case a.BOX:t.setBoxInfo(e.box);break;case a.MINE:t.setMineInfo(e.mine),t.type=game.RoleType.CsWarMine}},setPlayerInfo:function(e){this.roleId=e.roleId,this.isMale=e.isMale,this.camp=e.camp,this.teamId=e.teamId,this.teamLeader=e.teamLeader,this.zone=e.zone,this.guildName=e.guildName,this.mineUnitId=e.mineUnitId,this.guildWarOwner=e.guildWarOwner},setMonsterInfo:function(e){this.id=e.id},setBoxInfo:function(e){this.id=e.id},setMineInfo:function(e){this.id=e.id,this.master=e.master,this.count=e.count},setTeamInfo:function(e,t){this.teamId=e,this.teamLeader=t},setLeaderInfo:function(e){this.teamId=e.teamId,this.teamLeader=e.teamLeader,this.mineUnitId=e.mineUnitId,this.x=e.x,this.y=e.y},getMineIsMax:function(){var e=game.SceneUnitCfg.getData(this.id);if(!e)return!0;var t=e.param1;return this.count>=t},getCanOccupy:function(){var e=game.SceneUnitCfg.getData(this.id);return!e||e.camp},clearTeamInfo:function(){this.teamId=0,this.teamLeader=0},setPosition:function(e,t){this.x=e,this.y=t},clearInfo:function(){this.teamId=0,this.teamLeader=0,this.mineUnitId=0},clearData:function(){},reset:function(){this.clearData()},recycle:function(){this.reset(),this._super()}})).count=0,t.pool=new b8e.Pool(t,1024),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$SceneUnitInfo",t)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,_maxBarWidth:0,_specialLayer:!0,ctor:function(){this._super(1175),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){this._maxBarWidth=this.skin.bar.node.width},notify:function(){},onShow:function(){var e=game.sceneData.collectId,t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Collect,e),a=game.BoxCfg.getData(t.data.roleId);if(a){var i=this.skin.bar.node;i.width=0,b8e.Tween.kill(i);var n=1e3*(a.collectTime+1);b8e.Tween.get(i).to({width:this._maxBarWidth},n).call(function(){b8e.evt.dptG(game.SceneGEvts.COLLECT_READ_PROGRESS_COMPLETE)},this)}else this.hide()},onHide:function(){var e=this.skin.bar.node;b8e.Tween.kill(e),game.sceneData.collectId=0},onStageResize:function(){this._super();var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),t-250)}});b8e.module.registerView(game.ME.SceneCollectBar,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,_reviveTime:20,ctor:function(){this._super(1279)},onShow:function(){this.skin.reliveBtn.active=!0,game.sceneData.isGuildWar()?(this._reviveTime=Number(game.CsMiscCfg.getData("guildWarReviveTime").value),game.csWarTeamData.isInTeam&&!game.csWarTeamData.isLeader&&(this.skin.reliveBtn.active=!1)):this._reviveTime=20,this.createTimer()},createTimer:function(){this._timer||(this.skin.reliveTimeLab.string=game.Lang.get(719,this._reviveTime),this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){this._reviveTime--,this.skin.reliveTimeLab.string=game.Lang.get(719,this._reviveTime),this._reviveTime<1&&(b8e.evt.dptG(game.SceneGEvts.SCENE_REVIVE,1),this.clearTimer())},onHide:function(){this.clearTimer()},onStageResize:function(){this._super();var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*t)}});b8e.module.registerView(game.ME.SceneRevive,e)}(),function(){var e;e=b8e.Enum({NONE:0,C_TASK_NOTIFY:b8e.enc(),C_TASK_COMPLETE:b8e.enc(),V_PROCESS_CHANGE:b8e.enc(),C_INIT_TASK:b8e.enc(),G_TASK_OPEN_UI:b8e.enc(),G_TASK_ENTER_MAP:b8e.enc(),V_FOLLOW_CHAT:b8e.enc(),C2V_SHOW_BANNER:b8e.enc(),C_COMPLETE_NOCOND_TASK:b8e.enc(),C_AUTO_PASS:b8e.enc(),C_UPDATE_REWARD_REDPOINT:b8e.enc(),C_UPDATE_BACK_VIEW:b8e.enc(),BIND_FLY_TASK_BTN_POS:b8e.enc(),C_BEGINPLAYANI:b8e.enc()}),b8e.RC("$$game","$$TaskEvts",e)}(),function(){var e=game.Control.extends({_initTask:!1,canComplete:!0,lastTaskId:0,challengeCount:0,init:function(){},handels:function(){return[{e:game.protoId.MainTaskMsg,f:this.taskMsg},{e:game.protoId.MainTaskProcessMsg,f:this.processMsg},{e:game.protoId.CompleteMainTaskResp,f:this.completeMainTaskResp}]},notify:function(e){switch(e){case this.Evts.BIND_FLY_TASK_BTN_POS:this.dpt(this.Evts.C_BEGINPLAYANI)}},ipc:function(){var e=this;e.gevts={TaskEvts:{G_TASK_OPEN_UI:e.openUITask},MainInstanceEvts:{G_AUTO_PASS_END:e.autoPassBtn}},e.evts={MainUIRight:{C_AUTO_FIGHT_CHANGE:e.autoFightChange},MainRole:{C_INIT_SERVER_DATA:e.initServerData,C_VIP_LEVEL_CHANGE:e.checkBanner,C_LEVEL_UP:e.checkBanner},Recharge:{C_RECHARGE_SUCCESS:e.checkBanner},TitleReward:{C_GET_REWARD:e.completeNoCondTaskReq},MainInstance:{C_GET_MAIN_INSTANCE_AWARDS:e.updateRewBoxRedPoint},ModuleOpen:{BIND_FLY_TASK_BTN_POS:e.onBindFlyTaskBtnPos},InstanceSuccess:{V_ON_NIEW_HIDE:e.onBattleEnd}},e.handels={MainTaskMsg:e.taskMsg,MainTaskProcessMsg:e.processMsg,CompleteMainTaskResp:e.completeMainTaskResp,CompleteNoConditionTaskResp:e.completeNoConditionTaskResp}},onUpdateChallenge:function(){this.challengeCount++;var e=game.taskData.task;e&&e.taskType==game.TaskType.TASK_TYPE_PVE_BATTLE&&e.state!=game.TaskStateType.IN_STATE&&e.progress<e.conditionParam1&&this.challengeCount-2>=e.conditionParam1&&(e.progress=e.conditionParam1,e.state=game.TaskStateType.RECEIVE_STATE,game.GameGuideMgr.inst().taskDone(e.id),this.send(game.TaskEvts.V_PROCESS_CHANGE),this.checkAutoPass(e))},onBindFlyTaskBtnPos:function(){this.send(this.Evts.BIND_FLY_TASK_BTN_POS)},taskMsg:function(e){var t=this,a=e.readProtobuf(game.pb.MainTaskNotify);if(a)game.taskData&&(game.taskData.task=a,t.challengeCount=0,a.state==game.TaskStateType.RECEIVE_STATE?game.GameGuideMgr.inst().taskDone(a.id):a.state==game.TaskStateType.IN_STATE&&game.GameGuideMgr.inst().task(a.id),t.send(game.TaskEvts.V_PROCESS_CHANGE),t.dpt(game.TaskEvts.C_TASK_NOTIFY),a.state==game.TaskStateType.COMPLETE_STATE&&(t.dpt(game.TaskEvts.C_TASK_COMPLETE),t.canComplete=!0,t.checkBanner(!0)),t._initTask||(t._initTask=!0,t.dpt(game.TaskEvts.C_INIT_TASK)),a.taskType==game.TaskType.TASK_FINISH_CHAPTER&&game.taskData.isAutoPass&&(t.timerKey=b8e.setTimeout(t.completeTask,t,3e3)));else;},processMsg:function(e){var t=e.readProtobuf(game.pb.MainTaskProcessNotify);if(t){if(game.taskData&&game.taskData.task){var a=game.taskData.task;a.progress=t.progress,a.state=t.state,a.state==game.TaskStateType.RECEIVE_STATE&&game.GameGuideMgr.inst().taskDone(a.id),this.send(game.TaskEvts.V_PROCESS_CHANGE),this.checkAutoPass(a)}}else;},completeMainTaskResp:function(e){var t=e.readProtobuf(game.pb.CompleteMainTaskResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},completeNoConditionTaskResp:function(e){var t=e.readProtobuf(game.pb.CompleteNoConditionTaskResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C_COMPLETE_NOCOND_TASK),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},completeTask:function(){if(game.taskData.task&&game.taskData.task){var e=game.taskData.task;if(e.state!=game.TaskStateType.COMPLETE_STATE){if(e.state==game.TaskStateType.RECEIVE_STATE){if(game.UpgradeUtil.checkEquipTooMuch()){return}if(b8e.Tween.kill(this),b8e.Tween.get(this).wait(2e3).call(function(){this.lastTaskId=0,b8e.Tween.kill(this)},this),this.lastTaskId!=e.id){this.lastTaskId=e.id,this.sender.CompleteMainTaskReq()}}if(e.state==game.TaskStateType.IN_STATE){var t=e.taskType,a=game.TaskType;switch(t){case a.TASK_TYPE_ENTER_MAP:b8e.evt.dptG(game.TaskEvts.G_TASK_ENTER_MAP);break;case a.TASK_TYPE_ROLE_LEVEL:var i=game.mainRoleData.lv<e.conditionParam1;return void(e.moduleId&&i&&game.module.show(e.moduleId));case a.TASK_TYPE_CHAT_COUNT:game.taskData.isChatTask=!0;break;case a.TASK_TYPE_PVE_BATTLE:return void game.notice.show(51773)}if(e.moduleId){if(e.moduleId==game.ME.Back)return this.send(game.MainUIEvts.BOTTOM_SELECT_INDEX_CHANGE,1),game.module.show(game.ME.Back),void this.dpt(this.Evts.C_UPDATE_BACK_VIEW,e.toggleId);game.module.showToggle(e.moduleId,e.toggleId)}}}else;}else;},openUITask:function(e){var t=e.data,a=game.taskData.task;if(a&&a.taskType==game.TaskType.TASK_TYPE_OPEN_UI&&a.conditionParam2==t)this.sender.CompleteNoConditionTaskReq(1);else;},completeNoCondTaskReq:function(){this.sender.CompleteNoConditionTaskReq(2)},autoFightChange:function(){b8e.evt.dptG(game.TaskEvts.G_TASK_OPEN_UI,game.ME.TaskAutoFight)},closeBanner:function(e){game.bannerBarData.closeBanner(),game.bannerBarData.showBanner=!1,this.checkBanner(),e&&e.stopPropagation()},banner:function(){var e=game.bannerBarData.getOpenBanner();e&&e.moduleEnum&&(game.module.show(e.moduleEnum),game.bannerBarData.showBanner=!1,this.checkBanner())},checkBanner:function(e){var t=0<arguments.length&&void 0!==e&&e,a=game.bannerBarData;if(a.isAllShow)this.send(this.Evts.C2V_SHOW_BANNER,!1);else{var i=a.getIsComplete();if(!a.showBanner||t||i){var n=a.getIsOpen();a.showBanner=n,this.send(this.Evts.C2V_SHOW_BANNER,n)}}},initServerData:function(){game.bannerBarData.initBanner();var e=game.bannerBarData.getIsOpen();this.send(this.Evts.C2V_SHOW_BANNER,e)},autoPassBtn:function(){var a=this,i=game.mainInstanceData;game.InstanceCfg.getDataAsync(i.autoPassOpenId,function(e){if(e)if(i.canOpenAutoPass()){var t=game.taskData;t.isAutoPass=!t.isAutoPass,t.isAutoPass||(game.module.hide(game.ME.MainInstance),game.notice.show(51877)),t.isAutoPass?a.completeTask():a.timerKey&&(b8e.clearTimeout(a.timerKey),a.timerKey=0),a.send(a.Evts.C_AUTO_PASS)}else game.notice.show(51619,e.name)},a)},checkAutoPass:function(e,t){var a=1<arguments.length&&void 0!==t&&t;if(e.state==game.TaskStateType.RECEIVE_STATE&&game.taskData.isAutoPass){if(e.taskType==game.TaskType.TASK_FINISH_CHAPTER&&!a)return;this.timerKey=b8e.setTimeout(this.completeTask,this,3e3)}},onBattleEnd:function(){this.checkAutoPass(game.taskData.task,!0)},rewBoxBtn:function(){game.module.show(game.ME.InstancePrizeTips)},updateRewBoxRedPoint:function(){this.send(this.Evts.C_UPDATE_REWARD_REDPOINT)},fastFightBtn:function(){game.module.show(game.ME.QuickBattle)}}),t=game.Sender.extends({ipc:function(){this.msg={CompleteMainTaskReq:null,CompleteNoConditionTaskReq:this.completeNoCondTaskReq}},completeNoCondTaskReq:function(e){var t=game.pb.CompleteNoConditionTaskRequest;t.type=e,this.write(t)}});b8e.module.registerControl(game.ME.Task,e,game.TaskEvts,t)}(),function(){var e=b8e.Object.extends({isAutoPass:!1,isChatTask:!1,task:null,getTaskId:function(){if(this.task){return this.task.id}return 0},endAutoPass:function(){b8e.evt.dptG(game.MainInstanceEvts.G_AUTO_PASS_END)}});game.taskData=game.taskData||new e}(),function(){var e=b8e.Object.extends({showBanner:!1,isAllShow:!1,initBanner:function(){var e=game.BannerBarCfg.getDatas();if(e&&(this.bannerList=e.slice(0),this.bannerList&&!(this.bannerList.length<1)))for(var t=void 0,a=this.bannerList.length,i=0;i<a;i++)if((t=this.bannerList.shift())&&!this.getComplete(t)){this.bannerList.unshift(t);break}},getCurBanner:function(){return!this.bannerList||this.bannerList.length<1?null:this.bannerList[0]},closeBanner:function(){if(this.bannerList&&!(this.bannerList.length<1)){this.bannerList.length;this.bannerList.shift(),this.isAllShow=0==this.bannerList.length}},getComplete:function(e){if(!e)return!1;var t=!1,a=game.moduleOpen.checkTriggers(e.completeTrigger1);return e.completeTrigger2&&0<e.completeTrigger2.length&&(t=game.moduleOpen.checkTriggers(e.completeTrigger2)),!(!a&&!t)},getOpen:function(e){return!!e&&!!game.moduleOpen.checkTriggers(e.openTrigger)},getIsOpen:function(){if(!this.bannerList||this.bannerList.length<1)return!1;var e=this.bannerList[0];return this.getOpen(e)},getIsComplete:function(){if(!this.bannerList||this.bannerList.length<1)return!1;for(var e=void 0,t=!1,a=this.bannerList.length,i=0;i<a;i++){e=this.bannerList.shift();var n=this.getComplete(e);n?t=n:this.bannerList.push(e)}return this.isAllShow=0==this.bannerList.length,t},getOpenBanner:function(){return this.getIsOpen()?!this.bannerList||this.bannerList.length<1?null:this.bannerList[0]:null}});game.bannerBarData=game.bannerBarData||new e}(),function(){var e;e=b8e.Enum({IN_STATE:0,RECEIVE_STATE:1,COMPLETE_STATE:2}),b8e.RC("$$game","$$TaskStateType",e)}(),function(){var e;e=b8e.Enum({NONE:0,TASK_TYPE_PVE_BATTLE:1,TASK_FINISH_CHAPTER:3,TASK_TYPE_ROLE_LEVEL:4,TASK_TYPE_CHAT_COUNT:7,TASK_TYPE_OPEN_UI:8,TASK_TYPE_ENTER_MAP:9}),b8e.RC("$$game","$$TaskType",e)}(),function(){var e=game.View.extends({_showModel:!1,_isMoveUp:!1,_specialLayer:!0,ctor:function(){this._super(game.baseUIUrl[19]),this.addNodeTouch=!1,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex),this.spotAlerts={QUICK_FITHG:this.quickFightAlert}},quickFightAlert:function(e){this.skin.quick_redPoint.active=e.alert},init:function(){var e=this;e.anima1=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima1.addToParent(e.skin.anima1),e.anima1.load(game.ResCfg.getUrl(5019,1017)),e.anima2=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima2.addToParent(e.skin.anima2),e.anima2.load(game.ResCfg.getUrl(5019,1019)),e.anima3=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima3.addToParent(e.skin.anima3),e.anima3.load(game.ResCfg.getUrl(5019,1020)),e.skin.banner.isButton=!1,e.skin.closeBanner.isButton=!1,(e.bannerAnima=b8e.Animator.get(game.AnimType.UI_EFFECT,1)).addToParent(e.skin.banner)},onShow:function(){this.processChange(),this._isMoveUp=game.chatData.isOpenChat,this.onStageResize(),this.updateAutoPass(),this.anima1.play(),this.anima2.play(),this.anima3.play()},notify:function(e,t){switch(e){case game.TaskEvts.V_PROCESS_CHANGE:this.processChange();break;case game.TaskEvts.C2V_SHOW_BANNER:this.showBanner(t);break;case game.TaskEvts.C_AUTO_PASS:this.updateAutoPass();break;case game.TaskEvts.C_UPDATE_REWARD_REDPOINT:this.updateRewBoxRedPoint();break;case this.Evts.BIND_FLY_TASK_BTN_POS:this.onBindFlyTaskBtnPos()}},onBindFlyTaskBtnPos:function(){game.moduleOpenData.bindFlyAnimBtnPos=this.skin.fastFightBtn.localToGlobal(),this.send(this.Evts.BIND_FLY_TASK_BTN_POS)},processChange:function(){if(game.taskData&&game.taskData.task){var e=game.taskData.task;if(e.state!=game.TaskStateType.COMPLETE_STATE){var t,a=e.desc;e.state==game.TaskStateType.RECEIVE_STATE?(t=game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9049)),this.skin.anima.active=!0):(t=game.HtmlUtil.getText(game.Color.RED,"("+e.progress+" / "+e.conditionParam1+")"),this.skin.anima.active=!1),this.skin.task.string=a+t;var i=e.showItem;i&&0<i.length?this.skin.roleExpVal.string="+"+i[0].num:this.skin.prize.string=game.Lang.get(9050),this.drawCurve()}else this.skin.taskNode.active=!1}},showBanner:function(e){var t=e,a=this.skin;if(a.banner.active=t){var i=game.bannerBarData.getCurBanner();if(i){a.banner.active=!0;var n=game.taskData.task,s=i.posY;if(n&&n.state==game.TaskStateType.COMPLETE_STATE&&(s=i.taskCompletePosY),a.banner.setPosition(i.posX,s),i.banner){var o=game.ResCfg.getImgUrl(i.banner);a.banner.loadTexture(o)}i.effect?(this.bannerAnima.load(game.ResCfg.getUrl(5019,i.effect)),this.bannerAnima.play()):this.bannerAnima&&this.bannerAnima.clear()}else a.banner.active=!1}},updateAutoPass:function(){var e=game.taskData.isAutoPass,t=this.skin;t.autobtn_gray_sprite.active=!e,e?(this.autoPassAnmi||(this.autoPassAnmi=b8e.Animator.get(game.AnimType.UI_EFFECT,1),this.autoPassAnmi.addToParent(t.autoPassAnmi),this.autoPassAnmi.load(game.ResCfg.getUrl(5019,1086)),this.autoPassAnmi.play()),t.autoPassAnmi.active=!0):t.autoPassAnmi.active=!1,this.updateAutoRedPoint()},updateRewBoxRedPoint:function(){var t=this;game.mainInstanceData.canGetMainInsRew(function(e){t.skin.redPoint.active=e,t.skin.anima1.active=e},t),t.updateAutoRedPoint()},updateAutoRedPoint:function(){this.skin.auto_redPoint.active=game.mainInstanceData.checkAutoRedPoint()},onStageResize:function(){this.setPosition(0,460),this.skin.autoPassAnmi.x=b8e.stageWidth/2},drawCurve:function(){var o=this;o.graphicsImg||(o.graphicsImg=b8e.Graphics.get(),o.graphicsImg.setAnchor(.5,.5),o.graphicsImg.addToParent(o.skin.proNode),o.graphicsImg.addChild(o.skin.yuan),o.graphicsImg.setMask(b8e.MaskType.GRAPH),o.maskG=o.graphicsImg.getMaskGraphics(),o.poly=[],o.maskRadius=200),game.mainInstanceData.getMaxProgress(function(e){var t=360*game.mainInstanceData.progress/e,a=180<t,i=o.poly;i.length=0,t=180<t?360-t:-t,i.push(0,0);var n=Math.PI/180,s=0;i.push(Math.cos(s)*o.maskRadius,Math.sin(s)*o.maskRadius),s=t/2*n,i.push(Math.cos(s)*(o.maskRadius+20),Math.sin(s)*(o.maskRadius+20)),s=t*n,i.push(Math.cos(s)*o.maskRadius,Math.sin(s)*o.maskRadius),o.maskG.clear(),o.maskG.fillPoly(i),o.graphicsImg._node.getComponent(cc.Mask).inverted=a})}});b8e.module.registerView(game.ME.Task,e)}(),function(){var e;e=b8e.Enum({NONE:-1,V_CHANGE_COUNT:-1,C2C_WEAR_EQUIP:-1,C2C_SMELIT_EQUIP:-1,C2V_OPEN_EQUIP:-1,V2C_USE_ITEM:-1,V2C_ACTIVE_PARTNER:-1,C2C_ACTIVE_PARTNER:-1,V2C_HIDE_AWARDTIP:-1,V2C_UPDATE_ITEM:-1}),b8e.RC("$$game","$$TipsEvts",e)}(),function(){var e,t=game.Control.extends({maxCount:500,init:function(){this._alertOptions={lang:4401,okcb:this.onGameAlert,thisArg:this}},ipc:function(){this.evts={SelectGift:{C2C_USE_EFFECT_ITEM:this.useSelectGiftItem},Back:{C_BACK_USE_ITEM_RESPONSE:this.updateItem},MainRole:{C_RESET_DAILY:this.resetDaily}}},notify:function(e,t,a,i){switch(e){case this.Evts.V2C_USE_ITEM:this.useBtn(t,a,i);break;case this.Evts.V2C_ACTIVE_PARTNER:this.dpt(this.Evts.C2C_ACTIVE_PARTNER,t)}},resetDaily:function(){game.itemData.clearlimit()},updateItem:function(){this.send(this.Evts.V2C_UPDATE_ITEM)},useBtn:function(e,t){if(t&&e){var a=game.mainRoleData.lv,i=game.mainRoleData.vipLevel,n=game.ItemInfoCfg.getData(t.id);if(n)if(a<n.level)game.notice.show(5812,n.level);else if(i<n.vip)game.notice.show(5811,n.vip);else if(n.useCost&&0<n.useCost.length&&!game.UpgradeUtil.checkItemList(n.useCost,e,!1))game.notice.show(113);else{if(n.useAlert)return this._alertOptions.lang=n.useAlertLang?n.useAlertLang:4401,this._alertOptions.langArgs=game.HtmlUtil.getColorStrByQuality(n.quality,n.name),this._alertOptions.args=[t.idx,e],void game.alert.showTwo(this._alertOptions);if(n.effectType==game.ItemEffectType.DAILY_LIMIT){var s=game.itemData.getitemlimitNum(n.id);if(s&&s==n.dailyLimit)return void game.notice.show(53448);if((s=s||0)+e>n.dailyLimit)return void game.notice.show(53449,n.dailyLimit-s)}this.sender.UseItemReq(t.idx,e),t.num>e||game.module.hide(game.ME.ItemTips)}}},onGameAlert:function(e,t){this.sender.UseItemReq(e,t),game.module.hide(this.moduleEnum)},maxBtn:function(){var e=game.tipsData.getInfo(),t=game.ItemInfoCfg.getData(e.id);if(t){var a=game.tipsData.curCount;if(t.useCost&&0<t.useCost.length)for(var i,n,s,o,r,g=t.useCost,l=g.length,c=0;c<l;c++){if(s=g[c]){if(i=s.Id,(n=s.Num)<(o=game.itemData.getNumById(i))){r=Math.floor(o/n)}else r=1;a=a<r?r:a}else;}else if(a<e.num){a=e.num<this.maxCount?e.num:this.maxCount}game.tipsData.curCount=a,this.send(this.Evts.V_CHANGE_COUNT)}else;},minBtn:function(){game.tipsData.curCount;game.tipsData.curCount=1,this.send(this.Evts.V_CHANGE_COUNT)},addBtn:function(){var e=game.tipsData.getInfo(),t=game.ItemInfoCfg.getData(e.id);if(t){var a=game.tipsData.curCount;if(t.useCost&&0<t.useCost.length){var i=a+1;if(a<e.num&&a<this.maxCount&&game.UpgradeUtil.checkItemList(t.useCost,i,!1)){a++}}else if(a<e.num&&a<this.maxCount){a++}game.tipsData.curCount=a,this.send(this.Evts.V_CHANGE_COUNT)}else;},lessenBtn:function(){var e=game.tipsData.curCount;if(1<e){e--}game.tipsData.curCount=e,this.send(this.Evts.V_CHANGE_COUNT)},useBtnGray:function(){},useEffectItem:function(e){if(e&&e.data){this.sender.UseItemReq(e.data,1)}},useSelectGiftItem:function(){var e=game.selectGiftData.itemInfo,t=game.selectGiftData.curCount,a=game.selectGiftData.selectGiftId;!e||t<1||a<1||this.sender.UseItemReq(e.idx,t,a)}}),a=[game.ME.ItemTips,game.ME.RewardsShow,game.ME.EquipDetailsTips,game.ME.ExcEquipDetailsTips],i=e=game.Sender.extends({ipc:function(){this.msg={UseItemReq:this.useItemReq}},useItemReq:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:0,n=game.pb.UseItemRequest;n.idx=e,n.num=t,n.param=i,b8e.net.getBytes().writeProtobuf(n)}});b8e.module.registerControl(game.ME.EffectItemTips,t,game.TipsEvts,i,a),b8e.RC("$$game","$$UseItemSender",e)}(),function(){var e=game.Control.extends({init:function(){}});b8e.module.registerControl(game.ME.EquipTips,e)}(),function(){var e=game.Control.extends({init:function(){}});b8e.module.registerControl(game.ME.FosterEquipTips,e)}(),function(){var e=game.Control.extends({sureBtn:function(){var e=game.tipsData.getInfo();this.sender.UseItemReq(e.idx,1),game.module.hide(this.moduleEnum)}});b8e.module.registerControl(game.ME.FosterExpTips,e,game.TipsEvts,game.UseItemSender)}(),function(){var e=game.Control.extends({init:function(){}});b8e.module.registerControl(game.ME.GuardianSkillTips,e,game.TipsEvts)}(),function(){var e=game.Control.extends({init:function(){}});b8e.module.registerControl(game.ME.RoleAttr,e)}(),function(){var e=game.Control.extends({touch:function(){game.module.hide(game.ME.ShengZhuangTips)}});b8e.module.registerControl(game.ME.ShengZhuangTips,e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Achieve:{C2C_SET_SHOW_AWARD:this.setShowData,C2C_SET_PREVIEW_AWARD:this.setPreviewData},Recruit:{C2C_PREVIEW_BOX:this.setPreviewData},Hunlu:{C2C_SET_SHOW_AWARD:this.setShowData,C2C_SET_PREVIEW_AWARD:this.setPreviewData},Barbarian:{C2C_SET_SHOW_AWARD:this.setShowData2}}},notify:function(e){switch(e){case this.Evts.V2C_HIDE_AWARDTIP:this.newShowPage()}},setShowData:function(e){var t=e.data;t&&(t.isNoHide||game.module.hide(t.moduleEnum),game.awardsData.setInfo(t.awards,t.title),game.awardsData.setShowPage(t.moduleEnum,t.toggle),game.module.show(game.ME.AwardShowTip))},setShowData2:function(e){var t=e.data;t&&(t.isNoHide||game.module.hide(t.moduleEnum),game.awardsData.setInfo(t.awards,t.title,!1),game.awardsData.setNewShowPage(t.moduleEnum,t.toggle),game.module.show(game.ME.AwardShowTip))},setPreviewData:function(e){var t=e.data;t&&(this._okCall=t.okCall,this._thisArg=t.thisArg,game.awardsData.setPreviewInfo(t.awards,t.title,t.btnStr),game.module.show(game.ME.AwardPreviewTip))},showPage:function(){game.awardsData.showModule&&(game.awardsData.showToggle?game.module.showToggle(game.awardsData.showModule,game.awardsData.showToggle):game.module.show(game.awardsData.showModule)),game.awardsData.clearShow()},newShowPage:function(){game.awardsData.newShowModule&&(game.awardsData.newShowToggle?game.module.showToggle(game.awardsData.newShowModule,game.awardsData.newShowToggle):game.module.show(game.awardsData.newShowModule)),game.awardsData.clearShow()},sureBtn:function(){this._okCall&&this._thisArg?this._okCall.call(this._thisArg):game.module.hide(game.ME.AwardPreviewTip)}}),t=[game.ME.AwardPreviewTip];b8e.module.registerControl(game.ME.AwardShowTip,e,game.TipsEvts,null,t)}(),function(){var e=b8e.Object.extends({info:null,curCount:1,isBack:!1,inBackOpen:!1,ctor:function(){this._super()},setInfo:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:0,n=2<arguments.length&&void 0!==a&&a;this.info=e,this.lv=i,this.curCount=1,this.inBackOpen=n},getInfo:function(){return this.info},setBack:function(e){this.isBack=e}});game.tipsData=game.tipsData||new e}(),function(){var e=b8e.Object.extends({isBaseAttr:!1,ctor:function(){this._super()},setInfo:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this.isBaseAttr=a,this.info=e},getInfo:function(){return this.info}});game.psTipsData=game.psTipsData||new e}(),function(){var e=b8e.Object.extends({items:null,title:"",btnStr:"",showModule:0,showToggle:0,newShowModule:0,newShowToggle:0,setInfo:function(e,t,a){var i=!(2<arguments.length&&void 0!==a)||a;this.title=t||"",this.setItemsByArray(e,i)},setShowPage:function(e,t){this.showModule=e,this.showToggle=t},setNewShowPage:function(e,t){this.newShowModule=e,this.newShowToggle=t},setPreviewInfo:function(e,t,a){this.title=t||"",this.btnStr=a||"",this.setItemsByArray(e)},setItemsByArray:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t;if(e&&!(e.length<1))for(var i=this.items=[],n=void 0,s=void 0,o=void 0,r=0,g=e.length;r<g;r++)(n=e[r])&&(s=a?n.Id:n.id,o=a?n.Num:n.num,i[r]=game.ItemUtil.createBaseItemInfo(s,o))},setCompleteCb:function(e,t){this.callback=e,this.thisArg=t},getInfo:function(){return this.items},setTitle:function(e){this.title=e||""},getTitle:function(){return this.title},getBtnStr:function(){return this.btnStr},clearShow:function(){this.showModule=0,this.showToggle=0,this.newShowModule=0,this.newShowToggle=0}});game.awardsData=game.awardsData||new e}(),function(){var e=game.View.extends({itemInfo:null,_cfg:null,_itemGrid:null,_curCount:1,_showModel:!0,ctor:function(){this._super(1205)},init:function(){this.surfaceModel=new game.SurfaceModel,this.surfaceModel.addToParent(this.skin.model),this.posY=this.skin.desc2.y,this.posY2=this.skin.line2.y},notify:function(e){switch(e){case this.Evts.V_CHANGE_COUNT:this.setCount()}},onShow:function(){this.itemInfo=game.tipsData.getInfo(),this.skin.useBtnGray.active=!1,this.skin.useBtn.active=!0,this.setData(this.itemInfo)},setData:function(){var e=this;if(e.itemInfo)if(e._cfg=game.ItemInfoCfg.getData(e.itemInfo.id),e._cfg){switch(e._cfg.cfgType){case game.ItemCfgType.NormalItem:e.skin.effectNode.node.active=!1;break;case game.ItemCfgType.EffectItem:e.skin.effectNode.node.active=!0,e.skin.batchNode.active=e._cfg.batch}if(!e._itemGrid){this._itemGrid=game.GridUtil.createTipsIcon(),this._itemGrid.addToParent(this.skin.icon)}game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo),e.skin.name.string=game.HtmlUtil.getColorStrByQuality(e._cfg.quality,e._cfg.name,!0),e.skin.num.string=e.itemInfo.num,e.skin.level.string=e._cfg.level,e.skin.desc.string=e._cfg.des;var t=e.skin.desc.height-64;if(e.skin.desc2.string=e._cfg.des2,e.skin.desc2.y=e.posY-t,e.skin.line2.y=e.skin.desc2.y-e.skin.desc2.height-22,t+=e.skin.desc2.height-22,e.setCount(),e._cfg.roleType){this.skin.effectNode.node.height=750+t,this.skin.usePage.y=-700-t,this.height=750+t,this.surfaceModel.showSurface(this._cfg),this.skin.modelNode.active=!0,this._isModel=!0}else e.skin.modelNode.active=!1,e.skin.effectNode.node.height=505+t,e.skin.usePage.y=-450-t,e.height=505+t,e._isModel=!1;e.width=590,e.onStageResize()}else;else;},setCount:function(){if(this._cfg)if(this._curCount=game.tipsData.curCount,this._cfg.useCost&&0<this._cfg.useCost.length){for(var e,t,a,i,n,s=this._cfg.useCost,o=s.length,r=1,g=0;g<o;g++){if(a=s[g]){if(e=a.Id,(t=a.Num)<(i=game.itemData.getNumById(e))){n=Math.floor(i/t)}else n=1;r=r<n?n:r}else;}this.skin.count.string=this._curCount+"/"+r}else this.skin.count.string=this._curCount+"/"+this.itemInfo.num;else;}});b8e.module.registerView(game.ME.EffectItemTips,e)}(),function(){var e=game.View.extends({_cfg:null,_itemGrid:null,_string:"",_addNodeTouch:!0,_showModel:!0,ctor:function(){this._super(1172)},init:function(){var e=this.qualityBg=b8e.Sprite.get();e.addToParent(this.skin.bg),e.setAnchor(0,1),this.curX=this.skin.score.x,this.curBgW=this.skin.bg.width},onShow:function(){this.itemInfo=game.tipsData.getInfo(),this.setData()},setData:function(){var e=this,t=e.skin;if(e.itemInfo){e._curCount=1;var a=0;if(e._cfg=game.ItemInfoCfg.getData(e.itemInfo.id),e._cfg){if(!e._itemGrid){this._itemGrid=game.GridUtil.createTipsIcon(),this._itemGrid.addToParent(t.icon)}if(game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo),t.name.string=game.HtmlUtil.getColorStrByQuality(e._cfg.quality,e._cfg.name),t.level.string=e._cfg.level,e._cfg.spriteStat){this.setSpriteStat(this._cfg.spriteStat),a+=game.CCommonUtil.getPower(this._cfg.spriteStat)}t.power.string=a,t.score.string=game.Lang.get(9597,a);var i=t.name.width+t.score.width;if(250<i){var n=i-250;t.score.x=e.curX+n,t.bg.width=e.curBgW+n,e.width=e.curBgW+n}else t.score.x=e.curX,t.bg.width=e.curBgW,e.width=e.curBgW;e.onStageResize(),t.pos.string=game.EquipUtil.getPosName(e._cfg.cfgType,e._cfg.pos);var s=game.ResCfg.getUrl(150,e._cfg.quality);e.qualityBg.loadTexture(s)}else;}else;},setSpriteStat:function(e){if(this.skin.sprite.string=this._string="",e){var a,t=e.getSpriteStats();if(t)t.forEach(function(e,t){e=+e,a=game.AttrRulesCfg.getData(e),this._string+=game.HtmlUtil.getText(game.Color.WHITE,a.name+": "+t+"<br/>")},this),this.skin.sprite.string=this._string,this.skin.node.height=this.skin.bg.node.height=this.skin.sprite.node.height+280,this.onStageResize();else;}else;}});b8e.module.registerView(game.ME.EquipTips,e)}(),function(){var e=game.View.extends({_cfg:null,_itemGrid:null,_string:"",_addNodeTouch:!0,_showModel:!0,ctor:function(){this._super(1171)},init:function(){},onShow:function(){this.itemInfo=game.tipsData.getInfo(),this.setData()},setData:function(){var e=this;if(e.itemInfo){var t=e.skin;e._curCount=1;var a=0;if(e._cfg=game.ItemInfoCfg.getData(e.itemInfo.id),e._cfg){if(!e._itemGrid){this._itemGrid=game.GridUtil.createTipsIcon(),this._itemGrid.addToParent(t.icon)}if(game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo),t.name.string=game.HtmlUtil.getColorStrByQuality(e._cfg.quality,e._cfg.name,!0),e._cfg.openLv?(t.level.active=!0,t.levelDesc.active=!0,t.level.string=game.Lang.get(9590,e._cfg.openLv)):(t.levelDesc.active=!1,t.level.active=!1),e._cfg.spriteStat){this.setSpriteStat(this._cfg.spriteStat),a+=game.CCommonUtil.getPower(this._cfg.spriteStat)}if(e.itemInfo.equip){t.appendPage.active=!0,this.setAppendSpriteStat(this._cfg.appendSpriteStat,this.itemInfo.equip.attrNum),a+=game.CCommonUtil.getPower(this._cfg.appendSpriteStat)*this.itemInfo.equip.attrNum}else t.appendPage.active=!1;t.power.string=a,t.score.string=game.Lang.get(9597,a);var i=game.EquipUtil.getPosName(e._cfg.cfgType,e._cfg.pos);t.pos.string=i}else;}else;},setSpriteStat:function(e){var t=this.skin;if(this._string="",t.sprite.string=this._string,e){var a,i=e.getSpriteStats();if(i)i.forEach(function(e,t){e=+e,a=game.AttrRulesCfg.getData(e),this._string+=game.HtmlUtil.getText(game.Color.WHITE,a.name+": "+t+"<br/>")},this),t.sprite.string=this._string,t.node.height=t.bg.node.height=t.sprite.node.height+300,this.onStageResize();else;}else;},setAppendSpriteStat:function(e,a){var t=this.skin;if(this._string="",t.appendPage.y=-(t.bg.node.height-t.appendSpriteDesc.node.height)-20,t.appendSprite.string=this._string,e){var i,n,s=e.getSpriteStats();if(s)s.forEach(function(e,t){for(e=+e,i=game.AttrRulesCfg.getData(e),n=0;n<a;n++){this._string+=game.HtmlUtil.getText(game.Color.WHITE,i.name+": "+t+"<br/>")}},this),t.appendSprite.string=this._string,t.node.height=t.bg.node.height=t.appendSprite.node.height+t.bg.node.height+30,this.onStageResize();else;}else;}});b8e.module.registerView(game.ME.FosterEquipTips,e)}(),function(){var e=game.View.extends({_addNodeTouch:!0,_showModel:!0,ctor:function(){this._super(1170)},onShow:function(){if(this.itemInfo=game.tipsData.getInfo(),this.itemInfo)if(this._cfg=game.ItemInfoCfg.getData(this.itemInfo.id),this._cfg)this.skin.des.string=this._cfg.des,this.skin.des2.string="("+this._cfg.des2+")";else;else;}});b8e.module.registerView(game.ME.FosterExpTips,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1343)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.ExcEquipDetailsView,this._list.bindEnum=game.ME.PartnerEquipChange,this._list.layout.paddingTop=-10,this._list.addToParent(this.skin.detailsList)},onShow:function(){this._list.scrollToTop(),this.addDetailsView()},addDetailsView:function(){var e=[],t=game.tipsData.getInfo(),a=game.partnerEquipData.getShowInfo();a.updateInfos(t),a.setShowME(this.moduleEnum),game.tipsData.setBack(!0),e.push(a),this._list.setData(e)}});b8e.module.registerView(game.ME.ExcEquipDetailsTips,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1344)},init:function(){var e=this.skin;this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.EquipDetailsView,this._list.bindEnum=game.ME.PartnerEquipChange,this._list.layout.paddingTop=-10,this._list.addToParent(e.detailsList)},onShow:function(){this._list.scrollToTop(),this.addDetailsView()},addDetailsView:function(){var e=[],t=game.tipsData.getInfo(),a=game.partnerEquipData.getShowInfo();a.updateInfos(t),a.setShowME(this.moduleEnum),game.tipsData.setBack(!0),e.push(a),this._list.setData(e)}});b8e.module.registerView(game.ME.EquipDetailsTips,e)}(),function(){var e=game.View.extends({_addNodeTouch:!0,_modelTouchClose:!0,_showModel:!0,skillIcon:null,ctor:function(){this._super(1168)},init:function(){this.skillIcon=b8e.Sprite.get(),this.skillIcon.addToParent(this.skin.guardianIcon1),this.skillIcon.setSize(game.IconSizeEnum.SIZE_84,game.IconSizeEnum.SIZE_84),this.skillIcon.setAnchor(.5,.5)},onShow:function(){this.itemInfo=game.tipsData.getInfo(),this.itemInfo&&this._updateSkillData(game.SkillCfg.getData(this.itemInfo))},_updateSkillData:function(e){if(e){var t=this.skin;t.desc.string=game.LangSkill.get(e.desc,e.descParam),t.name.string=e.name,t.hide.active=!0,t.skillType.string=0==e.type?game.Lang.get(9051):game.Lang.get(9052);var a=0==e.type;t.activeIcon.active=a,t.passiveIcon.active=!a,t.guardianIcon.active=!0,t.guardianIcon1.active=!1}}});b8e.module.registerView(game.ME.GuardianSkillTips,e)}(),function(){var e=game.View.extends({itemInfo:null,_cfg:null,_itemGrid:null,_showModel:!0,_isModel:!1,_maxCount:500,ctor:function(){this._super(1167)},init:function(){this.surfaceModel=new game.SurfaceModel,this.surfaceModel.addToParent(this.skin.model),this.showList=[],this.labPool=[]},onShow:function(){this.itemInfo=game.tipsData.getInfo(),this.inBackOpen=game.tipsData.inBackOpen,this.clearAccessLab(),this.setData(),game.exploreScene.isInExploreScene()&&(this.skin.accessPage.active=!1)},setBasePage:function(){var e=void 0;e=this._cfg.quality==game.Quality.Q_COLORFUL?game.HtmlUtil.getColorStrByQuality(this._cfg.quality,this._cfg.name):game.HtmlUtil.getText(game.HtmlUtil.getColorByQuality(this._cfg.quality),this._cfg.name),skin.name.string=e},notify:function(e){switch(e){case this.Evts.V2C_UPDATE_ITEM:var t=this.itemInfo;if(!t)return;var a=game.ItemInfoCfg.getData(t.id);if(a.useCost&&!game.UpgradeUtil.checkItemList(a.useCost,1,!1))return void game.module.hide(this.moduleEnum);this.updatItemCount()}},updatItemCount:function(){var e=this.itemInfo;if(e){var t=game.ItemInfoCfg.getData(e.id);if(t){var a,i=this.skin,n=a=game.itemData.getCountById(e.id),s=t.useCost;if(s&&0<s.length)for(var o,r,g,l,c=void 0,h=s.length,m=0;m<h;m++)(g=s[m])&&(o=g.Id,n=n<(c=(r=g.Num)<(l=game.itemData.getNumById(o))?Math.floor(l/r):1)?n:c);this.maxCount=this.count=n>this._maxCount?this._maxCount:n,i.count.string=this.count+"/"+this.count,i.num.string=t.isHideNum?"":a+"",i.numLab.active=!t.isHideNum}}},setData:function(){var e=this,t=e.skin,a=e.itemInfo;if(a&&(e._cfg=game.ItemInfoCfg.getData(a.id),e._cfg)){var i=e._cfg,n=i.skipName;e._itemGrid||(e._itemGrid=game.GridUtil.createTipsIcon(),e._itemGrid.addToParent(t.icon)),game.GridUtil.setItemIcon(e._itemGrid,a,!1,0);var s=game.HtmlUtil.getColorStrByQuality(i.quality,i.name,!0);t.name.string=s,e.updatItemCount(),t.desc.string=i.des,t.desc.width=500;var o=e.isEffectItem=i.cfgType==game.ItemCfgType.EffectItem,r=e.isShowRole=!!i.roleType,g=e.isShowUsePage=o&&!!i.batch,l=e.isShowAccess=n&&0<n.length;r&&e.surfaceModel.showSurface(i),t.modelPage.active=r,t.usePage.active=e.inBackOpen&&g,t.accessPage.active=l,t.view_useBtn.active=e.inBackOpen&&!r&&(!g&&i.gotoME||o&&!i.batch),t.view_useBtn2.active=e.inBackOpen&&r&&(!g&&i.partnerId||i.gotoME||o&&!i.batch),t.view_useBtn3.active=e.inBackOpen&&o&&i.batch,n&&0<n.length&&e.setSkipName(n),t.view_partnerBtn.active=i.partnerId&&0<i.partnerId,e.layoutView(),e.onStageResize(),game.viewModule.updateLayout(e)}},setSkipName:function(e){for(var t=void 0,a=void 0,i=this.skin,n=e.length,s=i.acessLabList.width/(n+1),o=0;o<n;o++)a=game.HtmlUtil.getulText(e[o]),(t=this.labPool[o])||((t=this.labPool[o]=b8e.RichText.get()).setAnchor(.5,.5),t.setColor(game.Color.GREEN),b8e.evt.onC(t,this.onTouchAccess,this)),t.parent||t.addToParent(i.acessLabList),this.showList.push(t),t.x=s*(o+1),t.setText(a)},onTouchAccess:function(e){if(e&&e.target){var t=this._cfg;if(!(!this.labPool||this.labPool.length<1||!t||!t.skipName||t.skipName.length<1)){var a=this.labPool.indexOf(e.target);if(!(a<0)){var i=t.skipId;if(i&&!(i.length<a)){var n=i[a];if(n){var s=t.toggle;if(!s||s.length<1)game.module.show(n);else{var o=s[a];o&&-1!=o?game.module.showToggle(n,o):game.module.show(n)}game.module.hide(this.moduleEnum)}else{var r=t.skipShopId;if(r&&r.length>a&&r[a]){var g=r[a];return this.dptG(game.ShopGEvts.SHOW_SHOP,g),void game.module.hide(this.moduleEnum)}var l=t.skipXb;if(l&&l.length>a){var c=l[a],h=game.xunBaoData.getOpenIdByType(c,!0);if(!h)return;return this.dptG(game.XunBaoEvts.C2C_SHOW_XUNBAO,h),void game.module.hide(this.moduleEnum)}}}}}}},clearAccessLab:function(){if(this.showList&&!(this.showList.length<1)){for(var e=this.showList.length,t=0;t<e;t++)this.showList[t].removeFromParent();this.showList.length=0}},view_useBtn:function(){this.useBtnFunc()},view_useBtn2:function(){this.useBtnFunc()},useBtnFunc:function(){var e=this,t=e._cfg;if(t)if(t.cfgType!=game.ItemCfgType.EffectItem){if(t&&t.partnerId&&0<t.partnerId)if(game.partnerData.getIsActive(t.partnerId)){if(game.partnerData.quickStarInfo=game.partnerData.getInfoById(t.partnerId)){if(!game.moduleOpen.checkOpenWithTips(game.ME.PartnerQuickStar))return;game.module.show(game.ME.PartnerQuickStar),game.module.hide(e.moduleEnum)}}else e.send(e.Evts.V2C_ACTIVE_PARTNER,t.partnerId),game.module.hide(e.moduleEnum);else if(t.gotoME){var a=t.gotoME;t.gotoToggle?game.module.showToggle(a,t.gotoToggle-1):game.module.show(a),game.module.hide(e.moduleEnum)}}else e.send(e.Evts.V2C_USE_ITEM,e.count,e.itemInfo)},view_useBtn3:function(){this.send(this.Evts.V2C_USE_ITEM,this.count,this.itemInfo)},view_minBtn:function(){var e=this.count-1;this.setValue(!1,e)},view_maxBtn:function(){var e=this.maxCount-this.count;0<e&&this.setValue(!0,e)},view_lessenBtn:function(){this.setValue(!1,1)},view_addBtn:function(){this.setValue(!0,1)},view_partnerBtn:function(){var e=this._cfg;e&&e.partnerId&&(game.partnerData.setShowInfo(e.partnerId),game.module.show(game.ME.PartnerDetails),game.module.hide(this.moduleEnum))},setValue:function(e,t){var a=void 0;(a=e?(a=this.count+t)>this.maxCount?this.maxCount:a:(a=this.count-t)<1?1:a)!=this.count&&(this.count=a,this.skin.count.string=a+"/"+this.maxCount)},onStageResize:function(){this._super()},layoutView:function(){var e=this.skin,t=56<e.desc.height?e.desc.height-56:0,a=e.descPage.y-e.descPage.height-t;e.view_useBtn.active?e.view_useBtn.y=e.desc.y-t-90:a+=50;var i=a;this.isShowRole&&(e.modelPage.y=a,a=e.view_useBtn2.active?a:a+50,i=a-=e.modelPage.height),this.isShowUsePage&&(e.usePage.y=a,i=a-=e.usePage.height),this.isShowAccess&&(i=(e.accessPage.y=a)-e.accessPage.height),i+=70,e.bg2.height=-i,e.node.height=this.height=e.tipsBg.height=185-i,e.returnBtn.y=50-this.height}});b8e.module.registerView(game.ME.ItemTips,e)}(),function(){var e=game.View.extends({_itemInfo:null,_cfg:null,_itemGrid:null,_showModel:!0,_modelTouchClose:!0,ctor:function(){this._super(1165)},init:function(){(this._surfaceModel=new game.SurfaceModel).addToParent(this.skin.model),(this._itemGrid=game.GridUtil.createTipsIcon()).addToParent(this.skin.icon),this.timer=b8e.Timer.add(this,this.updateTime,500)},onShow:function(){game.TweenUtil.rotationEffect(this.skin.light),this._itemInfo=game.tipsData.getInfo(),this._itemInfo&&this.setData(),this.endTime=game.SysTime.curTime+3e3,this.skin.time.string=game.Lang.get(9598,game.TimeUtil.formatTimeSpace(3e3)),this.timer.reset(),this.timer.start()},onHide:function(){b8e.Tween.kill(this.skin.light),this.timer&&this.timer.stop()},updateTime:function(){if(!this.endTime)return this.skin.time.string=game.Lang.get(9053),void this.stopTime();var e=this.endTime-game.SysTime.curTime;if(e<=0)return this.skin.time.string=game.Lang.get(9053),void this.stopTime();this.skin.time.string=game.Lang.get(9598,game.TimeUtil.formatTimeSpace(e))},stopTime:function(){this.timer&&this.timer.stop(),game.module.hide(this.moduleEnum)},setData:function(){var e=this.skin,t=this._cfg=game.ItemInfoCfg.getData(this._itemInfo.id);t&&(t.roleType?(this._surfaceModel.showSurface(t),e.model.active=!0,e.icon.active=!1):(game.GridUtil.setItemIcon(this._itemGrid,this._itemInfo,!1,0),e.model.active=!1,e.icon.active=!0),e.name.string=game.HtmlUtil.getColorStrByQuality(t.quality,t.name,!1),this.setElement(t))},setElement:function(e){var t=this.skin,a=e.element;if(t.eleNode.active=0<a,0<a){var i=game.ResCfg.getUrl(10048,a);t.eleIcon.loadTexture(i)}t.eleLab.string=game.CCommonUtil.getElementText(a)},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.RareItemShow,e)}(),function(){var e=game.View.extends({leftStr:"",rightStr:"",_showModel:!0,ctor:function(){this._super(1164)},onShow:function(){var e=game.mainRoleData.spriteStat;this.setSpriteStat(e)},setSpriteStat:function(e){var t=this;if(t.skin.spriteLeft.string=t.leftStr="",t.skin.spriteRight.string=t.rightStr="",e){var a=e.getSpriteStats();if(a){if(t.list=a.keys(),t.list&&0<t.list.length){t.list.sort(t.onSort);for(var i=t.list.length,n=void 0,s=void 0,o=void 0,r=void 0,g=0;g<i;g++)n=t.list[g],o=a.get(n),n=+n,(s=game.AttrRulesCfg.getData(n))&&(2==s.format&&(o=Math.floor(1e4*o)/100+"%"),(r=s.name).length<3&&(r=r[0]+"       "+r[1]),o=game.HtmlUtil.getText(game.Color.GREEN,o),r=game.HtmlUtil.getText(game.Color.WHITE,r),g%2?t.rightStr+=r+game.HtmlUtil.getText(game.Color.WHITE,":")+o+"\n":t.leftStr+=r+game.HtmlUtil.getText(game.Color.WHITE,":")+o+"\n")}t.skin.spriteLeft.string=t.leftStr,t.skin.spriteRight.string=t.rightStr}else;}else;},onSort:function(e,t){var a=+e,i=+t,n=game.AttrRulesCfg.getData(a),s=game.AttrRulesCfg.getData(i);return n&&s?n.sort-s.sort:n?-1:1}});b8e.module.registerView(game.ME.RoleAttr,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1163)},init:function(){this.icon=game.GridUtil.createTipsIcon(),this.icon.addToParent(this.skin.icon),this.skillIcon=new game.ShengZhuangSkillIcon,this.skillIcon.addToParent(this.skin.skillIcon)},onShow:function(){this.info=game.tipsData.getInfo(),this.info&&this.info.id&&this.info._cfg&&(this.setBaseInfo(),this.setSkill())},setBaseInfo:function(){var e=this.skin,t=this.info,a=t._cfg;game.GridUtil.setItemIcon(this.icon,t,!1,0),e.equipName.string=game.HtmlUtil.getColorStrByQuality(a.quality,a.name),e.posName.string=game.EquipUtil.getPosName(a.cfgType,a.pos),e.lv.string=a.level,e.fightAmountLbl.string=t.power,game.AutoLayoutUtil.layoutPower(e.power,e.fightAmountLbl,e.powerImg,e.preBtn);var i=game.Color.WHITE;e.attrDesc.string=game.SpriteStatUtil.getSpriteStatDesc(a.spriteStat,i,i)},setSkill:function(){var e=game.shengZhuangSlotData;if(t){var t=(this.szData=e).getCurSZSuitCfg();if(t){var a=t.skillId;this.skillIcon.setData(a),this._updateSkillData(game.SkillCfg.getData(a))}}},_updateSkillData:function(e){if(e){var t=this.skin;t.skillName.string=game.HtmlUtil.getColorStrByQuality(e.quality,e.name);var a=game.LangSkill.get(e.desc,e.descParam),i=this.szData.isActiveSuit?9647:9644;a+=game.Lang.get(i),t.skillDes.string=a}},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.ShengZhuangTips,e)}(),function(){var e,t=e=game.View.extends({countDownTime:3,_showModel:!0,ctor:function(e){e?this._super(e):this._super(1347)},init:function(){this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this.gridList.itemRender=game.AwardTipIcon,this.gridList.addToParent(this.skin.scrollGrid),this.gridList.layout.spacingX=40,this.gridList.layout.spacingY=40,this.posArray=[260,190,120,55]},onShow:function(){game.TweenUtil.rotationEffect(this.skin.light),this.skin.time.string=game.Lang.get(51538,3),this.countDownTime=3,this.createCountDown(),this.setTitle(),this.setAward(),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeGet)},onHide:function(){this.clearCountDown(),b8e.Tween.kill(this.skin.light),game.awardsData.setTitle(""),this.send(this.Evts.V2C_HIDE_AWARDTIP)},setTitle:function(){var e=game.awardsData.getTitle();e&&""!=e||(e="normal"),this.skin.title_get.loadTexture(game.ResCfg.getUrl(10108,e))},setAward:function(){var e=this.skin,t=game.awardsData.getInfo();if(t&&!(t.length<1)){this.gridList.setData(t);var a=t.length,i=4<a?400:339;i=8<a?560:i;var n=4<a?-435:-460,s=Math.min(a,4),o=this.width/2-70*s+10;this.gridList.height=i-50,e.scrollGrid.setPosition(o,n),e.gray.setSize(b8e.stageWidth+100,i),e.huawen_3.width=e.huawen_1.width=b8e.stageWidth+100,e.pathNode.setPosition(325,e.gray.y-e.gray.height)}},createCountDown:function(){this.timer||(this.timer=b8e.Timer.add(this,this.updateTime,1e3)),this.timer.reset(),this.timer.start()},clearCountDown:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},updateTime:function(){this.countDownTime--,this.skin.time.string=game.Lang.get(51538,this.countDownTime),this.countDownTime<1&&game.module.hide(this.moduleEnum)},onStageResize:function(){this._super(),this.skin.gray.setSize(b8e.stageWidth+50,339)}});b8e.module.registerView(game.ME.AwardShowTip,t),b8e.RC("$$game","$$AwardShowView",e)}(),function(){var e=game.View.extends({_itemInfo:null,_cfg:null,_itemGrid:null,_showModel:!0,_modelTouchClose:!0,ctor:function(){this._super(1346)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.layout.spacingX=30,e.layout.paddingLeft=40,e.addToParent(this.skin.list),this.timer=b8e.Timer.add(this,this.updateTime,500),this._lightEffect=new game.LightEffect},onShow:function(){var e=this;if(e._lightEffect||(e._lightEffect=new game.LightEffect),e._lightEffect.parent||(e._lightEffect.addToParent(e.skin.anima),e._lightEffect.setVisible(!0)),e._itemInfo=game.tipsData.getInfo(),e._itemInfo){var t=game.CfgUtil.getPrizeListInfo(e._itemInfo.giveItems,3,game.IconSizeEnum.GRID_SIZE_105);e.list.setData(t.items)}e.endTime=game.SysTime.curTime+3e3,e.skin.time.string=game.Lang.get(9598,game.TimeUtil.formatTimeSpace(3e3)),e.timer.reset(),e.timer.start()},onHide:function(){this._lightEffect&&this._lightEffect.removeFromParent(),this.timer&&this.timer.stop()},updateTime:function(){if(!this.endTime)return this.skin.time.string=game.Lang.get(9053),void this.stopTime();var e=this.endTime-game.SysTime.curTime;if(e<=0)return this.skin.time.string=game.Lang.get(9053),void this.stopTime();this.skin.time.string=game.Lang.get(9598,game.TimeUtil.formatTimeSpace(e))},stopTime:function(){this.timer&&this.timer.stop(),game.module.hide(this.moduleEnum)}});b8e.module.registerView(game.ME.RewardsShow,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1380)},init:function(){this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this.gridList.itemRender=game.AwardTipIcon,this.gridList.addToParent(this.skin.scrollGrid),this.gridList.layout.spacingX=30,this.gridList.layout.spacingY=40,this.posArray=[235,170,105,45]},onShow:function(){this.setTitle(),this.setBtnStr(),this.setAward()},onHide:function(){this.send(this.Evts.V2C_HIDE_AWARDTIP)},setTitle:function(){var e=game.awardsData.getTitle();e&&""!=e||(e=51751),this.skin.titleLbl.string=game.Lang.get(e)},setBtnStr:function(){var e=game.awardsData.getBtnStr();e&&""!=e||(e=51752),this.skin.sureBtnLab.string=game.Lang.get(e)},setAward:function(){var e=this.skin,t=game.awardsData.getInfo();if(t&&!(t.length<1)){this.gridList.setData(t);var a=t.length,i=4<a?-133:-187,n=a>this.posArray.length?this.posArray[3]:this.posArray[a-1];e.scrollGrid.setPosition(n,i)}}});b8e.module.registerView(game.ME.AwardPreviewTip,e)}(),function(){var e;e=b8e.Enum({C_TRIGGER_OPEN:b8e.enc(),C_TRIGGER_BATCH:b8e.enc()}),b8e.RC("$$game","$$TriggerEvts",e)}(),function(){var e;e=game.Sender.extends({ipc:function(){this.msg={SaveClientTriggerReq:this.saveTrigger}},saveTrigger:function(e,t){var a=game.pb.SaveClientTriggerRequest;a.id=e,a.triggerTimes=t,this.write(a)}}),b8e.RC("$$game","$$TriggerSender",e)}(),function(){var e;e=b8e.Enum({None:0,Level:1,Vip:2,Task:3,OpenDays:4,Days:5,Times:6,GuildLv:7,NotCross:8,RechargePlatform:9,FirstRechargeDaily:10,CrossGuild:11,PartnerMaxStarNum:12}),b8e.RC("$$game","$$TriggerType",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this.triggers=b8e.HashMap.get()},setup:function(e){if(e&&e.triggerData){var t=e.triggerData;if(t&&0!=t.length)for(var a,i=this,n=t.length,s=0;s<n;s++)a=t[s],i.triggers.set(a.id,a.triggerTimes)}},saveTimes:function(e,t){this.triggers.set(e,t)},getTimes:function(e){var t=this.triggers.get(e);return t||0}});game.triggerData=game.triggerData||new e}(),function(){var e=game.Control.extends({lastTriggerLv:0,clientTriggerSave:null,_waitTriggers:null,_timeoutIdx:void 0,init:function(){this.clientTriggerSave={},this._waitTriggers=[]},ipc:function(){this.evts={MainRole:{C_INIT_MAIN_ROLE:this.initLvTrigger,C_LEVEL_UP:this.levelTrigger,C_VIP_LEVEL_CHANGE:this.vipTrigger,C_RESET_DAILY:this.initLvTrigger},Task:{C_INIT_TASK:this.initTaskTrigger,C_TASK_NOTIFY:this.taskTrigger},Guild:{C_UPDATE_GUILD:this.guildLvTrigger}}},initLvTrigger:function(){this._initLv=!0,this.levelTrigger(),this.vipTrigger(),this._runTriggers()},initTaskTrigger:function(){this._initTask=!0,this.taskTrigger(),this._runTriggers()},levelTrigger:function(){var e=game.mainRoleData.lv,t=game.ModuleCfg.getLvTriggers(e);this.doTriggers(t)},taskTrigger:function(){var e=game.taskData.getTaskId(),t=game.ModuleCfg.getModulesByTask(e);this.doTriggers(t)},vipTrigger:function(){var e=game.mainRoleData.vipLevel,t=game.ModuleCfg.getVipTriggers(e);this.doTriggers(t)},guildLvTrigger:function(){var e=game.guildData.getGuildLevel(),t=game.ModuleCfg.getGuildLvTriggers(e);this.doTriggers(t)},rechargeTrigger:function(){var e=game.ModuleCfg.getRechargeTriggers();this.doTriggers(e)},doTriggers:function(e){if(e&&!(e.length<=0)){for(var t,a=this._waitTriggers,i=0,n=e.length;i<n;i++)t=e[i],a.indexOf(t)&&(a[a.length]=t);this._runTriggers()}},_runTriggers:function(){var e=this;e._timeoutIdx||(e._timeoutIdx=setTimeout(function(){e._timeoutIdx=void 0,e._processTriggers()},0))},_processTriggers:function(){if(this._initLv&&this._initTask&&!(this._waitTriggers.length<1)){for(;0<this._waitTriggers.length;){var e=this._waitTriggers.pop();this.doTrigger(e)}this.dpt(this.Evts.C_TRIGGER_BATCH)}},doTrigger:function(e){if(e){if(!this.clientTriggerSave[e.id]&&game.moduleOpen.checkOpen(e.moduleId)){this.clientTriggerSave[e.id]=!0,game.ModuleCfg.removeTrigger(e),b8e.evt.dptG(this.Evts.C_TRIGGER_OPEN,e.moduleId);var t=b8e.module.getView(e.moduleId);if(!t||!t.bindEnum)return;if(t&&t.updateBackItem){var a=b8e.module.getControl(game.ME.Back);a&&a.addEventListener(e.moduleId,t.updateBackItem,t)}var i=t.bindEnum,n=b8e.module.getControl(i);if(!n)return void b8e.warn("\u6ca1\u6709\u627e\u5230\u5bf9\u5e94moduleId\u7684control\uff0cmoduleId:",e.moduleId,"bindEnum:",i);if(!n.triggerOpen)return;n.triggerOpen(e.moduleId)}}else{b8e.error("\u5c1d\u8bd5\u89e6\u53d1\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u529f\u80fd\u5f00\u542f")}},saveTrigger:function(e,t){game.triggerData.saveTimes(e,t),this.sender.SaveClientTriggerReq(e,t)}});b8e.module.registerControl(game.ME.Trigger,e,game.TriggerEvts,game.TriggerSender)}(),function(){var e;e=b8e.Enum({None:0,SILVER_EXCHANGE:-1}),b8e.RC("$$game","$$SiliverEvts",e)}(),function(){var t=void 0;t=b8e.PoolObject.extends({setData:function(e,t){this.idx=e,this.cfg=t},recycle:function(){this.reset(),this._super()},reset:function(){this.idx=-1,this.cfg=null}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,256),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$AccessShopInfo",t)}(),function(){var e=void 0;(e=game.View.extends({_modelTouchClose:!0,_showModel:!0,ctor:function(e){if(e)this._super(e);else{this._super(8)}},showView:function(e){var t=this;t.itemId=e;var a=t.itemCfg=game.ItemInfoCfg.getData(e);a&&(t.shopSkipId=a.shopId,t.skipId=a.skipId,t.shopGoodsId=a.shopGoodsId,(t.shopSkipId||t.skipId||t.shopGoodsId)&&(t.parent?t.isInit&&t.setData():game.GameViewMgr.inst().showView(t,null,!1,2)))},init:function(){var e=this;e._itemGrid=game.GridUtil.createTipsIcon(game.IconSizeEnum.GRID_SIZE_105),e._itemGrid.addToParent(e.skin.icon)},onShow:function(){this.setData(),this.setLab()},onHide:function(){this.clearAccessLab()},setData:function(){var e=this;if(e._itemGrid){var t=e.itemCfg,a=e.skin;e.itemInfo=game.ItemUtil.createBaseItemInfo(t.id,1,e.itemInfo),game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo,!1,0);var i=game.HtmlUtil,n=i.getColorByQuality(t.quality);a.name.string=i.getText(n,t.name)}},setLab:function(){var e=this.itemCfg;!e||!e.skipName||e.skipName.length<1||this.setSkipName(e.skipName)},setSkipName:function(e){var t=void 0,a=void 0,i=this,n=i.skin,s=e.length,o=n.acessLabList.width/(s+1);i.labPool||(i.labPool=[]),i.showLabList||(i.showLabList=[]);for(var r=0;r<s;r++)a=game.HtmlUtil.getulText(e[r]),(t=i.labPool[r])||((t=i.labPool[r]=b8e.RichText.get()).setAnchor(.5,.5),t.setColor(game.Color.GREEN),b8e.evt.onC(t,i.onTouchAccess,i)),t.parent||t.addToParent(n.acessLabList),i.showLabList.push(t),t.x=o*(r+1),t.setText(a)},onTouchAccess:function(e){if(e&&e.target){var t=this.itemCfg;if(!(!this.labPool||this.labPool.length<1||!t||!t.skipName||t.skipName.length<1)){var a=this.labPool.indexOf(e.target);if(!(a<0)){var i=t.skipId;if(i&&!(i.length<a)){var n=i[a];if(!n){var s=t.skipShopId;if(!s&&s.length<0)return void b8e.error("\u6ca1\u6709\u914d\u7f6e\u5546\u5e97id");var o=s[a];return this.dptG(game.ShopGEvts.SHOW_SHOP,o),void this.closeBtn()}var r=t.toggle;if(!r||r.length<1)game.module.show(n);else{var g=r[a];g&&-1!=g?game.module.showToggle(n,g):game.module.show(n)}this.closeBtn()}}}}},clearAccessLab:function(){if(this.showLabList&&!(this.showLabList.length<1)){for(var e=this.showLabList.length,t=0;t<e;t++)this.showLabList[t].removeFromParent();this.showLabList.length=0}},closeBtn:function(){this.removeFromParent()},returnBtn:function(){this.removeFromParent()},otherLab_2:function(){var e=this,t=e.itemCfg.toggle;if(t&&0<t.length){if(e.isHasShop){game.module.showToggle(e.scenond,t[0])}else if(t[1]){game.module.showToggle(e.scenond,t[1])}else game.module.show(e.scenond)}else game.module.show(e.scenond);e.removeFromParent()},otherLab_1:function(){var e=this;if(e.isHasShop){e.dptG(game.ShopGEvts.SHOW_SHOP,e.first)}else{var t=e.itemCfg.toggle;if(t&&0<t.length){game.module.showToggle(e.first,t[0])}else game.module.show(e.first)}e.removeFromParent()}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$AccessView",e)}(),function(){var e=void 0;(e=game.AccessView.extends({pageH1:490,pageH2:586,shopId:0,itemId:0,goodsId:0,_modelTouchClose:!0,_showModel:!0,count:0,boughtNum:0,maxNum:0,canBuyMaxNum:9999,ctor:function(){this._super(7)},showView:function(e,t,a,i,n,s){var o=1<arguments.length&&void 0!==t&&t,r=2<arguments.length&&void 0!==a?a:0,g=i,l=n,c=s,h=this;h.itemId=e;var m=h.itemCfg=game.ItemInfoCfg.getData(e);if(m)if(!m.shopGoodsId||m.shopGoodsId.length<1)o&&game.notice.show(7251,m.name);else{m.shopGoodsId.length;h.goodsId=m.shopGoodsId[0],h.shopSkipId=m.shopId,h.skipId=m.skipId,h.remedyNum=r;var u=h.shopItemCfg=game.ShopItemCfg.getDataByGoodsId(h.goodsId);u&&(h.shopId=u.shopId,h.itemId=u.itemId,h.buyCompleteCb=g,h.thisArg=l,h.params=c,h.parent?h.isInit&&h.setData():game.GameViewMgr.inst().showView(h,null,!1,2))}},init:function(){var e=this,t=e.skin;e._super();var a,i=e._amountSp=b8e.Sprite.get();i.addToParent(e.skin.costSprite_1),i.setSize(40,40),i.setAnchor(.5,.5),(a=e._amountSp2=b8e.Sprite.get()).addToParent(e.skin.costSprite_2),a.setSize(40,40),a.setAnchor(.5,.5),(a=e._amountSp3=b8e.Sprite.get()).addToParent(e.skin.costSprite_3),a.setSize(40,40),a.setAnchor(.5,.5),t.count._editBox._textLabel.horizontalAlign=b8e.HorizontalAlign.CENTER,t.count.onEditingEnded(e.editingEnd,e),e.patt=/^[0-9]*[1-9][0-9]*$/;var n=e.skipList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);n.itemRender=game.AccessShopItem,n.layout.paddingLeft=0,n.layout.paddingTop=3,n.layout.spacingY=5,n.addToParent(t.acessLabList)},onShow:function(){var e=this,t=e.skin,a=e.itemCfg;if((!a.shopId||a.shopId.length<1)&&(!a.skipId||a.skipId.length<1)){e.skin.otherPage.active=!1}else e.skin.otherPage.active=!0;if(game.moduleOpen.checkOpen(game.ME.Recharge)){t.rechargeBtn.active=!0,t.rechargeBtn.x=195,t.buyBtn.x=402}else t.rechargeBtn.active=!1,t.buyBtn.x=301;e.setData(),e.setSkipList()},setData:function(){var e=this;if(e._itemGrid){var t=e.itemCfg,a=e.skin,i=game.HtmlUtil,n=i.getColorByQuality(t.quality);a.name.string=i.getText(n,t.name);var s=e.shopItemCfg;e.itemInfo=game.ItemUtil.createBaseItemInfo(s.itemId,s.itemNum,e.itemInfo),game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo,!1,2),e.shopCfg=game.ShopCfg.getDataByShopId(s.shopId),e.maxNum=s.maxNum,e.canBuyMaxNum=s.buyNum;var o=1,r=a.costSprite_1,g=a.costSprite_2,l=a.costSprite_3,c=a.costSprite_4,h=s.costItems;if(h&&0<h.length){var m=void 0,u=h[0].Id,d=game.ItemInfoCfg.getData(u);if(d?(m=game.ResCfg.getUrl(137,d.icon),r.loadTexture(m),g.loadTexture(m)):(r.unloadTexture(),g.unloadTexture()),h[1]){var f=h[1].Id;(d=game.ItemInfoCfg.getData(f))?(m=game.ResCfg.getUrl(137,d.icon),l.loadTexture(m),c.loadTexture(m)):(l.unloadTexture(),c.unloadTexture()),a.costNum_4.string=h[1].Num}if(a.costNum_1.string=h[0].Num,e.remedyNum){var p=game.itemData.getCountById(u);if(h[1]){var _=game.itemData.getCountById(h[1].Id);p=p<_?p:_}o=e.remedyNum>p?p:e.remedyNum}}else r.unloadTexture(),g.unloadTexture(),l.unloadTexture(),c.unloadTexture();o=o>s.buyNum?s.buyNum:o,e.count=0<o?o:1,e.refreshCount()}},setSkipList:function(){var e=this.itemCfg;if(e&&e&&e.skipName&&!(e.skipName.length<1)){var t=this.passList;if(t){for(var a=t.length,i=0;i<a;i++)game.AccessShopInfo.put(t[i]);t.length=0}else t=this.passList=[];for(var n=e.skipName.length,s=void 0,o=0;o<n;o++)(s=game.AccessShopInfo.get()).setData(o,e),t.push(s);this.skipList.setData(t)}},refreshCount:function(){var e=this,t=e.shopItemCfg;if(e.skin.count.string=e.count+"",e.skin.costNum_2.string="0",e.skin.costNum_3.string="",t){var a=t.costItems;if(a&&0<a.length){var i=a[0].Num*e.count;if(e.skin.costNum_2.string=game.CCommonUtil.replaceNum(i),a[1]){i=a[1].Num*e.count;e.skin.costNum_3.string=game.CCommonUtil.replaceNum(i)}}}},addBtn:function(){var e=this.count+1;this.check(e)},lessBtn:function(){var e=this.count-1;this.check(e)},addTenBtn:function(){this.check(this.canBuyMaxNum)},lessTenBtn:function(){this.check(1)},editingEnd:function(){var e=this.skin.count.string;if(!this.patt.test(e)||""===e)return this.skin.count.string=this.count+"",void game.notice.show(1607);this.check(+e)},check:function(e){var t=this,a=1,i=1;if(1<e){var n=t.shopItemCfg;if(n){var s=n.costItems;if(s&&0<s.length){var o=s[0].Num,r=game.itemData.getCountById(s[0].Id);if(o<r&&(i=r/o|0),s[1]){o=s[1].Num;var g=(r=game.itemData.getCountById(s[1].Id))/o|0;i=i<g?i:g}}}if(0<t.maxNum){if(t.maxNum>t.boughtNum){var l=t.maxNum-t.boughtNum;i=l<i?l:i,a=e<=l?e:l}}else a=(i=i>t.canBuyMaxNum?t.canBuyMaxNum:i)<e?i:e}t.count=a,t.refreshCount()},buyBtn:function(){var e=this,t=e.shopItemCfg;if(t){if(t.conditionType)if(!game.shopData.getIsPass(t.conditionType,t.conditionValue))return;if(0<e.maxNum&&(e.boughtNum=game.shopData.getBoughtNum(e.goodsId),e.boughtNum>=e.maxNum))game.notice.show(53746);else game.UpgradeUtil.checkItemList(t.costItems,e.count)&&(e.buyData||(e.buyData=b8e.createMap(),e.buyData.buyComplete=b8e.createMap()),e.buyData.goodsId=e.goodsId,e.buyData.count=e.count,e.buyData.buyComplete.callback=e.buyCompleteCb,e.buyData.buyComplete.thisArg=e.thisArg,e.buyData.buyComplete.params=[e.count,e.remedyNum,e.params],e.dptG(game.ShopGEvts.BUY_ITEM,e.buyData),e.removeFromParent())}},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE),this.removeFromParent()}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$AccessShopView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1588),this.setSize(520,98)},setData:function(e){var t=this.skin,a=e.cfg,i=e.idx;t.name.string=a.skipName[i],t.gotoBtn.active=!1;var n=a.skipId;if(!n||n.length<i)b8e.error("\u6ca1\u6709\u914d\u7f6e\u8df3\u8f6cid");else{var s=n[i];if(s){if(!this.checkModule(s))return;var o=a.toggle;if(!o||o.length<1)return void b8e.error("\u6ca1\u6709\u914d\u7f6e\u8df3\u8f6c\u9875\u7b7e");if(s!=game.ME.GotoBattle){var r=o[i],g=b8e.module.getView(s);if(!g)return void b8e.error(s," view \u6ca1\u6709\u5b8c\u6210\u521d\u59cb\u5316");var l=g.getToggleIndex(r);if(l&&!this.checkModule(l))return}}else{var c=a.skipShopId;if(c&&c.length>i){var h=c[i],m=game.ShopCfg.getDataByShopId(h);if(!m)return;if(!this.checkLv(m.openLv))return;if(!this.checkDay(m.openDays))return}}t.gotoBtn.active=!0}},checkModule:function(e){var t=game.moduleOpen.getOpenValueByType(e,game.TriggerType.Level);if(!this.checkLv(t))return!1;var a=game.moduleOpen.getOpenValueByType(e,game.TriggerType.OpenDays);return!!this.checkDay(a)},checkLv:function(e){var t=game.mainRoleData.lv>=e;return this.skin.openLab.string=t?"":game.Lang.get(53299,e),t},checkDay:function(e){var t=game.miscData.openServerDay>=e;return this.skin.openLab.string=t?"":game.Lang.get(53300,e),t},gotoBtn:function(){var e=this.data,t=e.cfg,a=e.idx,i=t.skipId;if(i&&!(i.length<a)){var n=i[a];if(n){var s=t.toggle;if(!s||s.length<1)game.module.show(n);else{var o=s[a];o&&-1!=o?game.module.showToggle(n,o):game.module.show(n)}}else{var r=t.skipShopId;if(r&&r.length>a){var g=r[a];this.dptG(game.ShopGEvts.SHOW_SHOP,g)}var l=t.skipXb;if(l&&l.length>a){var c=l[a],h=game.xunBaoData.getOpenIdByType(c,!0);if(!h)return;this.dptG(game.XunBaoEvts.C2C_SHOW_XUNBAO,h)}}game.AccessShopView.inst().removeFromParent()}}}),b8e.RC("$$game","$$AccessShopItem",e)}(),function(){var e=game.View.extends({_modelTouchClose:!1,_showModel:!0,gainHourTime:4,gainTime:14400,ctor:function(){this._super(9)},notify:function(e){switch(e){case this.Evts.SILVER_EXCHANGE:this.setData()}},init:function(){var e=this,t=e.siliverIcon=b8e.Sprite.get();t.addToParent(e.skin.siliverIcon),t.setAnchor(.5,.5),t.setSize(40,40);var a=game.amount.getCfgByType(game.AmountType.SILVER);if(a){t.loadTexture(game.ResCfg.getUrl(137,a.icon),null,null,{useMainfest:!1})}var i=e.exchangeIcon=b8e.Sprite.get();i.addToParent(e.skin.exchangeIcon),i.setAnchor(.5,.5),i.setSize(40,40);var n=game.WelfareMiscCfg.getData("returnsTime");if(n){e.gainHourTime=0|n.value,e.gainTime=60*e.gainHourTime*60}},onShow:function(){this.setData()},setData:function(){var o=this,r=o.skin;r.titleDesc.string=game.Lang.get(2801,o.gainHourTime);var e=game.welfareData.silverExchangeNum,t=game.mainRoleData.vipLevel,a=game.VipCfg.getSilverNum(t),i=0<a-e?a-e:0;r.buyDesc.string=game.Lang.get(2802,i);var n=t+1;if(n<game.VipCfg.maxVipLv){r.vipDesc.active=!0;var s=game.VipCfg.getSilverNum(n)-a;r.vipDesc.string=game.Lang.get(2803,n,s)}else r.vipDesc.active=!1;game.mainInstanceData.getInstanceCfg(function(e){if(e){var t,a,i=1;if((t=game.rechargeData.getCardInfoByType(game.CardType.MONTH))&&t.expireTime>game.SysTime.curTime)(a=game.rechargeData.getCardRechargeCfg(game.CardType.MONTH))&&(i+=.01*a.addAwardRate);if((t=game.rechargeData.getCardInfoByType(game.CardType.WEEK))&&t.expireTime>game.SysTime.curTime)(a=game.rechargeData.getCardRechargeCfg(game.CardType.WEEK))&&(i+=.01*a.addAwardRate);var n=e.interval,s=e.silver*i;r.siliverNum.string=o.gainTime/n*s,game.AutoLayoutUtil.layoutWithIconLabel(r.siliverIcon,r.siliverNum),o.setCost()}},this)},setCost:function(){var e=this,t=e.skin,a=game.welfareData.silverExchangeNum;if(e.silverExchangeCfg=game.SilverExchangeCfg.getDataByCount(a+1),e.silverExchangeCfg){var i=e.exchangeIcon,n=e.silverExchangeCfg.costItem,s=game.UpgradeUtil.checkItemList(n,1,!1);if(n&&0<n.length&&s){var o=n[0].Id,r=n[0].Num,g=game.ItemInfoCfg.getData(o);if(g){i.loadTexture(game.ResCfg.getUrl(137,g.icon),null,null,{useMainfest:!1})}var l=game.itemData.getNumById(o);t.costNum.string=game.Lang.get(1621,l,r)}else{var c=game.amount.getCfgByType(game.AmountType.YUAN_BAO);if(c){i.loadTexture(game.ResCfg.getUrl(137,c.icon),null,null,{useMainfest:!1})}t.costNum.string=e.silverExchangeCfg.costGold}game.AutoLayoutUtil.layoutWithIconLabel(e.skin.exchangeIcon,e.skin.costNum)}else;}});b8e.module.registerView(game.ME.Siliver,e)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={Back:{C_BACK_UPDATE_ITEMINFO:this.silverExchange,C_UPDATE_AMOUNT:this.silverExchange}},this.handels={SilverExchangeResp:this.silverExchangeResp}},exchangeBtn:function(){var e=game.welfareData.silverExchangeNum,t=game.mainRoleData.vipLevel,a=game.VipCfg.getSilverNum(t);if(0!=(0<a-e?a-e:0)){var i=game.SilverExchangeCfg.getDataByCount(e+1);if(i)if(game.UpgradeUtil.checkItemList(i.costItem,1,!1)){this.sender.SilverExchangeReq(!1)}else{if(!game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,i.costGold,!0)){return}this.sender.SilverExchangeReq(!0)}else;}else{if(t!=game.VipCfg.maxVipLv)return void game.notice.show(3101);game.notice.show(3102)}},silverExchangeResp:function(e){var t=e.readProtobuf(game.pb.SilverExchangeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.welfareData.silverExchangeNum++,this.send(this.Evts.SILVER_EXCHANGE)},silverExchange:function(){this.send(this.Evts.SILVER_EXCHANGE)}}),t=game.Sender.extends({ipc:function(){this.msg={SilverExchangeReq:this.silverExchangeReq}},silverExchangeReq:function(e){var t=game.pb.SilverExchangeRequest;t.isGold=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.Siliver,e,game.SiliverEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ACTIVATION_CODE,game.SAE.WELFARE_ALERT)},ipc:function(){this.evts={},this.handels={ExchangeCouponResp:this.onExchangeCouponResponse}},onExchangeCouponResponse:function(e){var t=e.readProtobuf(game.pb.ExchangeCouponResponse);if(0<t.code){game.notice.noticeError(t.code)}else;},notify:function(e,t){switch(e){case game.ActivationCodeEvts.SENDEDIT:this.sendEdit(t)}},sendEdit:function(e){this.sender.ExchangeCouponReq(e)},getBtn:function(){this.send(game.ActivationCodeEvts.CLICKBTN)}}),t=game.Sender.extends({ipc:function(){this.msg={ExchangeCouponReq:this.onExchangeCouponRequest}},onExchangeCouponRequest:function(e){var t=game.pb.ExchangeCouponRequest;t.coupon=e,this.write(t)}});b8e.module.registerControl(game.ME.ActivationCode,e,game.ActivationCodeEvts,t)}(),function(){var e=b8e.Object.extends({});game.activationCodeData=game.activationCodeData||new e}(),function(){var e;e=b8e.Enum({None:0,CLICKBTN:-1,SENDEDIT:-1}),b8e.RC("$$game","$$ActivationCodeEvts",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(19)},init:function(){this.skin.tip2.string=game.Lang.get(2310)},notify:function(e){switch(e){case game.ActivationCodeEvts.CLICKBTN:this.sendEdit()}},sendEdit:function(){var e=this.skin.editbox.string;""!==e?this.send(game.ActivationCodeEvts.SENDEDIT,e):game.notice.show(2311)},onShow:function(){this.skin.editbox.string=""},onHide:function(){},onStageResize:function(){}});b8e.module.registerView(game.ME.ActivationCode,e)}(),function(){var e;e=b8e.Enum({None:0,C2S_GUILD_BOSS_REQ:-1,C2S_JOIN_GUILD_BOSS:-1,C2S_GET_GUILD_BOSS_AWARD:-1,C2V_UPDATE_GUILD_BOSS_INFO:-1,V2C_GUILD_BOSS_REQ:-1,C2C_JOIN_GUILD_BOSS:-1,C2C_GET_GUILD_BOSS_AWARD:-1,V_SWITCH_PAGE:-1}),b8e.RC("$$game","$$ActivitiesHallEvts",e)}(),function(){var e;e=b8e.Enum({None:0,BULUO_GUAIWU:1,HUSONG_WUZI:2,DATI:3,KUAFU_ZHENGBA:4,SHOULIE_DAHUI:5,ZHENYING_ZHANYI:6,BULUO_BOSS:7,BULUO_ZHAN:8,YIJI_TREASURE:9,BULUO_DUOBAO:10,BUYU:11}),b8e.RC("$$game","$$ActivitiesHallType",e)}(),function(){var e=game.Control.extends({init:function(){this.normalSpotAlert=game.spotAlert.set(game.SAE.NORMAL_ACTIVITY_ALERT,game.SAE.ACTIVITIES_HALL),this.spotAlert=game.spotAlert.set(game.SAE.ACTIVITIES_HALL,game.SAE.HOME),game.activitiesHallData.init()},ipc:function(){this.evts={GuildBoss:{C2C_UPDATE_GUILD_BOSS_INFO:this.onUpdeteGuildBossInfo},MainRole:{C_RESET_DAILY:this.resetDaily}}},notify:function(e){switch(e){case this.Evts.V2C_GUILD_BOSS_REQ:this.dpt(this.Evts.C2S_GUILD_BOSS_REQ);break;case this.Evts.C2C_JOIN_GUILD_BOSS:this.dpt(this.Evts.C2S_JOIN_GUILD_BOSS);break;case this.Evts.C2C_GET_GUILD_BOSS_AWARD:this.dpt(this.Evts.C2S_GET_GUILD_BOSS_AWARD)}},resetDaily:function(){game.activitiesHallData.resetDailyAct()},onUpdeteGuildBossInfo:function(){this.send(this.Evts.C2V_UPDATE_GUILD_BOSS_INFO)},csTeamBtn:function(){this.selectToggle(1)},normalActivityBtn:function(){this.selectToggle(0)},csActivityBtn:function(){this.selectToggle(2)},selectToggle:function(e){this.send(this.Evts.V_SWITCH_PAGE,e)}}),t=[game.ME.NormalActivity];b8e.module.registerControl(game.ME.ActivitiesHall,e,game.ActivitiesHallEvts,null,t)}(),function(){var e=b8e.Object.extends({init:function(){var t;this.activites=[],this.csActivites=[],this.obj={id:0},game.ActivitiesHallCfg.getDatas().forEach(function(e){(t=new game.ActivityItemInfo).setData(e),e.isCs?this.csActivites.push(t):this.activites.push(t)},this)},getCsActivityInfos:function(){return this.csActivites.forEach(function(e){e.isOpen=e.checkOpen(),e.rankAlert=e.checkRankAlert()},this),this.csActivites.sort(this._sort),this.csActivites},getActivityInfos:function(){return this.activites.forEach(function(e){1!=e.id&&7!=e.id||e.count++,e.checkOpen()},this),this.activites.sort(this._sort),this.activites},_sort:function(e,t){if(e.sortId>t.sortId){return 1}if(e.sortId<t.sortId){return-1}if(e.id>t.id){return 1}if(e.id<t.id){return-1}return 0},resetDailyAct:function(){var e=this.activites;if(e&&!(e.length<1))for(var t=e.length,a=0;a<t;a++)e[a].resetCount++},resetCsAct:function(){var e=this.csActivites;if(e&&!(e.length<1))for(var t=e.length,a=0;a<t;a++)e[a].resetCount++},getShowCfgById:function(e){this.obj.id=e;var t=game.ActivitiesHallShowCfg.getData(this.obj,!0);if(t&&!(t.length<1))for(var a=t.length,i=game.miscData.openServerDay,n=void 0,s=0;s<a;s++)if((n=t[s]).serverStart<=i&&i<n.serverEnd)return n}});game.activitiesHallData=game.activitiesHallData||new e}(),function(){var e;e=b8e.Object.extends({id:0,isOpen:!0,count:0,rankAlert:!1,resetCount:0,setData:function(e){var t=this;if(t.id=e.id,t.sortId=e.sortId,t.cfg=e,t.isOpen=t.checkOpen(),e.isCs)t.__renderClass="_$CsActivityItem";else{var a=game.ActivitiesHallType;switch(t.id){case a.BULUO_GUAIWU:t.__renderClass="_$ActivityGuildBossWidget";break;case a.HUSONG_WUZI:t.__renderClass="_$ActivityEscortWidget";break;case a.DATI:t.__renderClass="_$ActivityExamWidget";break;case a.BULUO_BOSS:t.__renderClass="_$ActivityCsGuildBossWidget";break;default:t.__renderClass="_$ActivityItem"}}},getCfg:function(){return this.cfg},checkOpen:function(){var e=this.cfg;if(e.isCs){var t=game.ActivitiesHallType;switch(e.id){case t.SHOULIE_DAHUI:return game.throneData.isOpening;case t.ZHENYING_ZHANYI:return game.guanDuData.guanduIsOpen;case t.YIJI_TREASURE:return game.csTreasureData.isOpening;case t.KUAFU_ZHENGBA:return game.csWarData.isOpening}}if(e.openDay.length<1&&game.TimeUtil.isOpen(e.openTime,"hhmm"))return!0;var a=b8e.TimeUtil.getDay(game.SysTime.curTime);return!(-1==e.openDay.indexOf(a)||!game.TimeUtil.isOpen(e.openTime,"hhmm"))},checkRankAlert:function(){var e=this.getCfg(),t=void 0;if(e.moduleId)switch(e.moduleId){case game.ME.CsWar:if(t=game.spotAlert.get(game.SAE.CS_WAR_RANK_ALERT))return t.alert}return!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ActivityItemInfo",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(22),this.toggles={selectBtn2:game.ME.NormalActivity,selectBtn1:game.ME.CsTeam,selectBtn3:game.ME.CsActivity},this.spotAlerts={NORMAL_ACTIVITY_ALERT:this.changeAlert2,CS_ACTIVITY_ALERT:this.changeAlert3,CS_TEAM_ALERT:this.csTeamAlert,CS_TEAM_DOUBLE_ALERT:this.csTeamDoubleAlert}},notify:function(e,t){switch(e){case this.Evts.V_SWITCH_PAGE:if(1==t&&game.csTeamData.isInTeam)return void(b8e.module.isShowView(game.ME.CsTeamDetailsView)||game.module.show(game.ME.CsTeamDetailsView));this.toggleSelect(t)}},csTeamAlert:function(e){this.skin.red_spot_1.node.active=e.alert},csTeamDoubleAlert:function(e){this.skin.double_spot.node.active=e.alert},changeAlert2:function(e){this.skin.red_spot_2.node.active=e.alert},changeAlert3:function(e){this.skin.red_spot_3.node.active=e.alert},onShow:function(){this.toggleSelect(0)}});b8e.module.registerView(game.ME.ActivitiesHall,e)}(),function(){var e;e=game.ListItem.extends({bindEnum:0,ctor:function(e){e=e||26,this._super(e),this.setSize(599,188),this.bindEnum=game.ME.ActivitiesHall},init:function(){this.registerSP=!1,this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.layout.paddingLeft=-10,this._prizeList.layout.paddingTop=10,this._prizeList.layout.spacingX=15,this._prizeList.addToParent(this.skin.prize_scrollview)},onHide:function(){var e=this.skin;e.redPoint&&(e.redPoint.node.active=!1),e.btn_shop&&(e.btn_shop.active=!1),e.btn_goto&&(e.btn_goto.active=!1),e.lab_desc&&(e.lab_desc.string="")},setData:function(){this.createBg(),this.createBtn(),this.createHint(),this.createPrize(),this.registerSpotAlertCb()},registerSpotAlertCb:function(){if(!this.registerSP){this.registerSP=!0;var e=this.data.getCfg();if(e.spotAlertEnum){var t=b8e.getDPV(game.SAE,e.spotAlertEnum);t&&game.spotAlert.setCb(t,this.showAlert,this)}else this.skin.redPoint.node.active=!1}},showAlert:function(e){this.data&&(this.data.isOpen=this.data.checkOpen(),this.skin.redPoint.node.active=e.alert)},createBg:function(){var e=this.data.getCfg();e.bgRes&&""!=e.bgRes&&(this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.setAnchor(0,1),this._bgImg.addToParent(this.skin.bg)),this._bgImg.loadTexture(game.ResCfg.getImgUrl(e.bgRes))),this.skin.name.string=e.name},createBtn:function(){var e=this,t=e.data.getCfg();t&&(e.skin.btn_goto.active=!0,t.btnShopRes?(e._btnShopImg||(e._btnShopImg=b8e.Sprite.get(),e._btnShopImg.setAnchor(.5,.5),e._btnShopImg.addToParent(e.skin.btn_shop)),e.skin.btn_shop.active=!0,e._btnShopImg.loadTexture(game.ResCfg.getImgUrl(t.btnShopRes))):(e.skin.btn_shop.active=!1,e._btnShopImg&&e._btnShopImg.unloadTexture()))},createHint:function(){var e=this.data.getCfg();e&&""!=e.desc?this.skin.lab_desc.string=e.desc:this.skin.lab_desc.string=""},createPrize:function(){var e=this.data.getCfg();if(e&&e.isShow){var t=game.activitiesHallData.getShowCfgById(e.id);t&&(t.prizeInfo||(t.prizeInfo=game.CfgUtil.getPrizeListInfo(t.showItems,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84)),this._prizeList.setData(t.prizeInfo.items))}else $._prizeList.clear()},clickGoto:function(e,t){!e||e<1?b8e.warn("\u672a\u914d\u7f6e\u8df3\u8f6c"):game.moduleOpen.checkOpenWithTips(e)&&(game.GameViewMgr.inst().hideUnStrongViews(!1),game.module.showToggle(e,t))},btn_shop:function(){var e=this.data.getCfg();1==e.btnShopType?this.dptG(game.ShopGEvts.SHOW_SHOP,e.btnShopModule):this.clickGoto(e.btnShopModule,e.btnShopTab)},btn_goto:function(){var e=this.data.getCfg();this.clickGoto(e.moduleId,e.tab)}}),b8e.RC("$$game","$$ActivityItem",e)}(),function(){var e;e=game.ActivityItem.extends({ctor:function(){this._super(),this._renderType=2},setData:function(){this._super(),this.checkAlert()},createHint:function(){this._super();var e=game.EscortMiscCfg.getNumber("escortNum");this.skin.lab_hint.string=game.Lang.get(642,e-game.escortData.escortNum+"/"+e)},checkAlert:function(){this.data.getCfg()&&(this.skin.redPoint.active=game.escortData.mainViewAlert())}}),b8e.RC("$$game","$$ActivityEscortWidget",e)}(),function(){var e;e=game.ActivityItem.extends({ctor:function(){this._super(),this._renderType=3},createHint:function(){this._super(),this.skin.lab_hint.string=game.Lang.get(592,game.examData.champion?game.examData.champion.roleName:game.Lang.get(9055))}}),b8e.RC("$$game","$$ActivityExamWidget",e)}(),function(){var e;e=game.ActivityItem.extends({ctor:function(){this._super(25),this._renderType=1},onShow:function(){this.updateInfo()},onHide:function(){this.setDefaultVisible(),this._super()},registerSpotAlertCb:function(){},createBtn:function(){},createHint:function(){var e=game.guildBossData.getGuildBossTime();this.skin.lab_hint.string=game.Lang.get(2604,e)},createPrize:function(){var e=game.guildBossData.guildLv;if(this._lastGuildLv!=e){var t=void 0;if((this._lastGuildLv=e)<=0){var a=game.GuildBossCfg.getDatas();a&&0<a.length&&(t=a[0])}else t=game.GuildBossCfg.getData(e);if(t){var i=game.CfgUtil.getPrizeListInfo(t.award,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);this._prizeList.setData(i.items)}}},setData:function(){this._super(),this.updateInfo()},updateInfo:function(){var e=this.skin,t=game.guildBossData;this.updateBossHp(),this.setDefaultVisible();var a=game.guildBossData.guildLv,i=t.getMinLv();if(a<i)return e.labOpen.node.active=!0,void(e.labOpen.string=game.Lang.get(2605,i));this.setBtnVisible()},updateBossHp:function(){var e=this.skin,t=game.guildBossData,a=t.bossHp,i=t.maxHp,n=0,s=void 0;0<a&&(n=a/i*e.bar.node.width),s=a/i*100,e.maskNode.width=n,s=0<s?0|s:0,e.labRate.string=game.Lang.get(2606,s)},setBtnVisible:function(){var e=this.skin,t=game.guildBossData,a=t.bossHp;t.isUnderWay()?0<a?(e.btn_goto.node.active=!0,e.redPoint.node.active=!0):a<=0&&!t.isAward?(e.redPoint.node.active=!0,e.btnGetAward.node.active=!0):e.btnGray.node.active=!0:e.btnGray.node.active=!0},setDefaultVisible:function(){var e=this.skin;e.btnGetAward.node.active=!1,e.btn_goto.node.active=!1,e.btnGray.node.active=!1,e.labOpen.node.active=!1,e.redPoint.node.active=!1},btn_goto:function(){game.guildBossData.IsJoinGuildBoss()&&this.send(game.ActivitiesHallEvts.C2C_JOIN_GUILD_BOSS)},btnGetAward:function(){this.send(game.ActivitiesHallEvts.C2C_GET_GUILD_BOSS_AWARD)},labOpen:function(){game.guildBossData.IsJoinGuildBoss()}}),b8e.RC("$$game","$$ActivityGuildBossWidget",e)}(),function(){var e;e=game.ActivityItem.extends({ctor:function(){this._super(23),this._renderType=7},registerSpotAlertCb:function(){},createBtn:function(){},createHint:function(){var e=game.GuildMiscCfg.getData("crossGuildTitle");this.skin.lab_hint.string=game.Lang.get(e.value)},setData:function(){this._super(),this.updateInfo()},onShow:function(){this.updateInfo(),this.skin.labGrayName.string=game.Lang.get(9054)},onHide:function(){this._super(),this.setDefaultVisible()},_createPrizeItems:function(e){for(var t=e.value.split("|"),a=[],i=void 0,n=void 0,s=0,o=t.length;s<o;s++)n=t[s].split(","),(i=game.ItemInfo.get()).id=parseInt(n[0]),i.num=parseInt(n[1]),i.iconSize=game.IconSizeEnum.GRID_SIZE_84,i.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,a.push(i);return a},createPrize:function(){var e=game.GuildMiscCfg.getData("guildBossAward4"),t=this._createPrizeItems(e);this._prizeList.setData(t)},updateInfo:function(){this.setDefaultVisible(),this.setBtnVisible()},setBtnVisible:function(){var e=this.skin,t=game.csGuildBossData;e.btnGray.node.active=!t.getOpenTime(),e.btn_goto.node.active=t.getOpenTime(),e.redPoint.node.active=game.guildData.hasGuild()&&t.getOpenTime()&&0==t.reliveTime},setDefaultVisible:function(){var e=this.skin;e.btnGetAward.node.active=!1,e.btn_goto.node.active=!1,e.btnGray.node.active=!1,e.labOpen.node.active=!1,e.redPoint.node.active=!1},btn_goto:function(){game.moduleOpen.checkOpenWithTips(8500)&&(game.GameViewMgr.inst().hideUnStrongViews(!1),game.module.showToggle(8500,1))},btnGetAward:function(){},labOpen:function(){}}),b8e.RC("$$game","$$ActivityCsGuildBossWidget",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(27)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.bindEnum=game.ME.ActivitiesHall,this._list.layout.paddingLeft=0,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_GUILD_BOSS_INFO:this.updateInfo()}},onShow:function(){this.send(this.Evts.V2C_GUILD_BOSS_REQ),this.updateInfo()},onHide:function(){this._list&&this._list.clear()},updateInfo:function(){this._list.setData(game.activitiesHallData.getActivityInfos())},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.NormalActivity,e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SYS_DATA:-1,C2V_UPDATE_VIEW:-1,C2V_UPDATE_INFO:-1,C2V_UPDATE_TIME:-1,V2C_CHALLENGE:-1,C2C_UPDATE_MINE_RANK:-1,C2C_SYS_DATA_SUCCEED:-1,C2C_CHALLENGE_SUCCEED:-1,C2C_SET_FORMATION:-1,C2V_UPDATE_AWARD:-1,V_ISGET_AWARD:-1,C2V_UPDATE_BUY_NUM:-1}),b8e.RC("$$game","$$ArenaEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,V_SHOW_INS_SUCCESS:-1,V2C_SHOW_PRIZE:-1}),b8e.RC("$$game","$$ArenaFinishEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SYS_DATA:-1,C2V_UPDATE_VIEW:-1}),b8e.RC("$$game","$$ArenaLogEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V_SELECT_CHANGE:-1}),b8e.RC("$$game","$$ArenaMainEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SYS_DATA:-1,C2V_UPDATE_VIEW:-1,C_REQ_RANKINFO:-1}),b8e.RC("$$game","$$ArenaRankEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ARENA,game.SAE.HOME),this.spotAwardAlert=game.spotAlert.set(game.SAE.ARENA_AWARD,game.SAE.ARENA),this.spotArenaAlert=game.spotAlert.set(game.SAE.ARENA_ALERT,game.SAE.ARENA),game.arenaData.init(),this._alertOptions={lang:611,btn:game.Lang.get(9059),okcb:this.onClickGameAlert,thisArg:this}},ipc:function(){this.gevts={SceneGEvts:{FIRST_ENTER_SCENE:this.ArenaDataReq}},this.handels={ArenaDataResp:this.onArenaDataRsp,ArenaBuyResp:this.onArenaBuyRsp,ArenaChallengeResp:this.onArenaChallengeRsp,ArenaAimsAwardResp:this.arenaAimsAwardResp}},ArenaDataReq:function(){this.sender.ArenaDataReq()},notify:function(e,t){switch(e){case this.Evts.V2C_SYS_DATA:this.sender.ArenaDataReq();break;case this.Evts.V2C_CHALLENGE:if(!game.playBack.isInstanceFighting()&&!game.sceneData.isGuildMap()){this.challenge(t.roleId,t.rank,t.isSeckill)}break;case this.Evts.V_ISGET_AWARD:this.sender.ArenaAimsAwardReq(t)}},onArenaDataRsp:function(e){var t=e.readProtobuf(game.pb.ArenaDataResponse);if(0<t.code){game.notice.noticeError(t.code)}else{if(game.arenaData.setup(t),0<game.arenaData.remTime){this.createTimer()}this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),this.dpt(this.Evts.C2C_SYS_DATA_SUCCEED)}},onArenaBuyRsp:function(e){var t=e.readProtobuf(game.pb.ArenaBuyResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.arenaData.getReadyBuyNum();game.arenaData.buys+=a,game.arenaData.challenges+=a,game.arenaData.remTime=0,this.clearTimer(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_INFO),game.module.hide(game.ME.ArenaBuyView)}},onArenaChallengeRsp:function(e){var t=e.readProtobuf(game.pb.ArenaChallengeResponse);if(0<t.code){if(game.notice.noticeError(t.code),3450==t.code){this.sender.ArenaDataReq()}}else{game.GameViewMgr.inst().hideUnStrongViews();var a=game.arenaData.mineRank-t.rank;if(t.battlelog){var i={type:game.InstanceType.ARENA,rewards:t.useritem,exp:0,rank:a,scene:game.ResCfg.getUrl(4100,"arena")};game.playBack.play(t.battlelog,i)}else{var n={win:!0,type:game.InstanceType.ARENA,rewards:t.useritem,exp:0,rank:a};b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,n),game.module.showToggle(game.ME.ArenaMain,0)}game.InsFunCountData.addChallengeCount(game.InsFunCountType.ARENA),game.arenaData.mineRank=t.rank,game.arenaData.historyRank=t.historyRank,this.dpt(this.Evts.C2C_UPDATE_MINE_RANK),this.dpt(this.Evts.C2C_CHALLENGE_SUCCEED)}},arenaAimsAwardResp:function(e){var t=e.readProtobuf(game.pb.ArenaAimsAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.arenaData.setIsGet(t.aimsId),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_AWARD)},checkAlert:function(){this.spotArenaAlert.alert=0<game.arenaData.challenges;var e=game.arenaData.getAwardList();if(e){var t=e.length;if(!(t<1)){for(var a=void 0,i=!1,n=game.arenaData.mineRank,s=0;s<t;s++)if(!(a=e[s]).isGet)if(a.canGet)i=!0;else{if(n>a.rank)break;n<=a.rank&&(i=a.canGet=!0)}this.spotAwardAlert.alert=i}}},challenge:function(e,t,a){e!=game.mainRoleData.id&&(game.UpgradeUtil.checkEquipTooMuch()||(game.arenaData.challenges<1?game.notice.show(613):(game.playBackFormationData.setModule(game.ME.ArenaMain,0),this.dpt(this.Evts.C2C_SET_FORMATION,[game.ME.ArenaMain,e,this.sender.ArenaChallengeReq,[e,t,a],this]))))},awardBtn:function(){game.module.show(game.ME.ArenaAwardPreview)},createTimer:function(){if(this._timer);else this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start()},clearTimer:function(){if(this._timer)b8e.Timer.remove(this,this.updateTime),this._timer=null;else;},updateTime:function(){var e=game.arenaData;if(e.remTime--,this.send(this.Evts.C2V_UPDATE_TIME),e.remTime<1){if(e.challenges++,this.checkAlert(),e.challenges<5){e.remTime=e.recoverInterval}else this.clearTimer()}},buyBtn:function(){game.module.show(game.ME.ArenaBuyView)},onClickGameAlert:function(){var e=game.mainRoleData.vipLevel;if(game.VipCfg.getData(e).arena-game.arenaData.buys<1){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)}else{var t=game.arenaData.arenaBuyCost;if(game.amount.get(game.AmountType.YUAN_BAO)<t){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)}else this.sender.ArenaBuyReq()}},rankBtn:function(){game.module.show(game.ME.ArenaRank)},logBtn:function(){game.module.show(game.ME.ArenaLog)},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.ARENA_SHOP)},maxBtn:function(){if(this.isHasNum()){var e=game.arenaData.getCanBuyNum();this._updateBuyNum(e)}},minBtn:function(){this.isHasNum()&&this._updateBuyNum(1)},addOneBtn:function(){if(this.isHasNum()){var e=game.arenaData,t=e.getReadyBuyNum(),a=e.getCanBuyNum(),i=t+1;i=a<i?a:i,this._updateBuyNum(i)}},lessOneBtn:function(){if(this.isHasNum()){var e=game.arenaData.getReadyBuyNum()-1;e=e<2?1:e,this._updateBuyNum(e)}},isHasNum:function(){var e=0<game.arenaData.getCanBuyNum();return e||game.notice.show(52425),e},_updateBuyNum:function(e){var t=game.arenaData;t.getReadyBuyNum()!=e&&(t.setReadyBuyNum(e),this.send(this.Evts.C2V_UPDATE_BUY_NUM))},cancelbuyBtn:function(){game.module.hide(game.ME.ArenaBuyView)},buyTimesBtn:function(){if(this.isHasNum()){var e=game.arenaData,t=e.getPerTimeCost(),a=e.getReadyBuyNum(),i=a*t;game.amount.get(game.AmountType.YUAN_BAO)<i?game.notice.show(52271):this.sender.ArenaBuyReq(a)}}}),t=[game.ME.ArenaAwardPreview,game.ME.ArenaBuyView],a=game.Sender.extends({ipc:function(){this.msg={ArenaDataReq:null,ArenaChallengeReq:this.arenaChallengeReq,ArenaBuyReq:this.arenaBuyReq,ArenaAimsAwardReq:this.arenaAimsAwardReq}},arenaChallengeReq:function(e,t,a){var i=game.pb.ArenaChallengeRequest;i.roleid=e,i.rank=t,i.quick=a,this.write(i)},arenaAimsAwardReq:function(e){var t=game.pb.ArenaAimsAwardRequest;t.aimsId=e,this.write(t)},arenaBuyReq:function(e){var t=game.pb.ArenaBuyRequest;t.times=e,this.write(t)}});b8e.module.registerControl(game.ME.Arena,e,game.ArenaEvts,a,t)}(),function(){var e=game.Control.extends({ipc:function(){this.gevts={InstanceEvts:{G_STOP_PLAY:this.playStop}}},notify:function(e){switch(e){case this.Evts.V2C_SHOW_PRIZE:this._showPrize()}},playStop:function(e){if(e){var t=this.data=e.data;if(t.type==game.InstanceType.ARENA)game.gamePopupMgr.show(game.ME.ArenaFinish),this.send(this.Evts.C2V_UPDATE_VIEW,t),this.dpt(this.Evts.V_SHOW_INS_SUCCESS,t);else;}else;},prizeBtn:function(){this._showPrize(),game.module.hide(game.ME.ArenaFinish),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},_showPrize:function(){game.ServerItemUtil.analyzeItems(this.data,1)},details_btn:function(){game.module.show(game.ME.BattleDetails)}});b8e.module.registerControl(game.ME.ArenaFinish,e,game.ArenaFinishEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.handels={ArenaLogResp:this.onArenaLogRsp}},notify:function(e){switch(e){case this.Evts.V2C_SYS_DATA:this.sender.ArenaLogReq()}},onArenaLogRsp:function(e){var t=e.readProtobuf(game.pb.ArenaLogResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.arenaData.setupLogs(t.logs),this.send(this.Evts.C2V_UPDATE_VIEW)}}),t=game.Sender.extends({ipc:function(){this.msg={ArenaLogReq:null}}});b8e.module.registerControl(game.ME.ArenaLog,e,game.ArenaLogEvts,t)}(),function(){var e=game.Control.extends({btn_1:function(){this.send(this.Evts.V_SELECT_CHANGE,0)},btn_2:function(){this.send(this.Evts.V_SELECT_CHANGE,1)},btn_3:function(){this.send(this.Evts.V_SELECT_CHANGE,2)},btn_4:function(){this.send(this.Evts.V_SELECT_CHANGE,3)},btn_5:function(){this.send(this.Evts.V_SELECT_CHANGE,4)},btn_6:function(){this.send(this.Evts.V_SELECT_CHANGE,5)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.ArenaMain,e,game.ArenaMainEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Rank:{C_UPDATE_DATA:this.onUpdateData}}},notify:function(e){switch(e){case this.Evts.V2C_SYS_DATA:this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.Arena)}},onUpdateData:function(){this.send(this.Evts.C2V_UPDATE_VIEW)}});b8e.module.registerControl(game.ME.ArenaRank,e,game.ArenaRankEvts,null)}(),function(){var e;e=b8e.Object.extends({rank:0,rewards:null,canGet:!1,isGet:!1,des:"",setData:function(e){this.rewards=e.rewards,this.rank=e.rank,this.des=e.des},setComplete:function(){this.isGet=!0,this.canGet=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ArenaAwardInfo",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.awardMap=b8e.HashMap.get(),this.readyBuyNum=1},init:function(){var e=game.ArenaMiscCfg.getData("arenaQuick");this.arenaQuick=e?parseInt(e.value):2e3,e=game.ArenaMiscCfg.getData("arenaRecoverInterval"),this.recoverInterval=e?parseInt(e.value):7200;var t=(e=game.ArenaMiscCfg.getData("arenaBuyCost")).value.split(",");this.arenaBuyCost=parseInt(t[0]),this.arenaBuyCount=parseInt(t[1]),e=game.ArenaMiscCfg.getData("arenaMaxChallenges"),this.arenaMaxChallenges=e?parseInt(e.value):5,this.logs=[],this.historyRank=5e3},setup:function(e){this.mineRank=e.rank,this.challenges=e.challenges,this.buys=e.buys,this.remTime=e.remTime,this.setupDefiers(e.list),this.historyRank=e.historyRank,this.aims=e.aims},setupDefiers:function(e){if(e){if(1<(this.defiers=e).length){this.defiers.sort(function(e,t){return e.rank-t.rank})}for(var t,a=this.mineRank<=this.arenaQuick,i=game.mainRoleData.id,n=0,s=this.defiers.length;n<s;n++){(t=this.defiers[n]).isSelf=t.roleId==i,t.isSeckill=a&&n==s-1&&!t.isSelf}}else;},setupLogs:function(e){var t;this.logs.length=0,e.forEach(function(e){(t=new game.ArenaLogInfo).setData(e),this.logs.push(t)},this)},getMainRank:function(){return this.mineRank},getPrizeNumById:function(e,t){for(var a=t.rewards2,i=a.length,n=void 0,s=0;s<i;s++)if((n=a[s]).Id==e)return n.Num;return 0},isGet:function(){var e=this.getAwardList();if(!e)return!1;var t=e.length;if(t<1)return!1;for(var a=0;a<t;a++)if(!e[a].isGet)return!1;return!0},setAwardData:function(){if(this.aims){var e=this.aims.length;if(!(e<1)){for(var t=void 0,a=0;a<e;a++){var i=this.aims[a];(t=this.getAwardInfo(i))&&t.setComplete()}var n=this.getAwardList();n&&n.sort(this._sort)}}},setIsGet:function(e){var t=this.getAwardInfo(e);if(t){t.setComplete();var a=this.getAwardList();a&&a.sort(this._sort)}},initAwardData:function(){var e=game.ArenaAimsCfg.getDatas();if(e){var t=e.length;if(!(t<1))for(var a=void 0,i=0;i<t;i++){var n=e[i];if(!n)break;(a=this.awardMap.get(n.rank))||(a=new game.ArenaAwardInfo,this.awardMap.set(n.rank,a)),a.setData(n)}}},getAwardList:function(){return this.awardMap.values()},getAwardInfo:function(e){return this.awardMap.get(e)},_sort:function(e,t){return e.isGet==t.isGet?e.canGet==t.canGet?t.rank-e.rank:e.canGet?-1:1:e.isGet?1:t.isGet?-1:void 0},getCanBuyNum:function(){var e=game.mainRoleData.vipLevel;return game.VipCfg.getData(e).arena-game.arenaData.buys},getReadyBuyNum:function(){return this.readyBuyNum},getPerTimeCost:function(){return this.arenaBuyCost},setReadyBuyNum:function(e){this.readyBuyNum=e}});game.arenaData=game.arenaData||new e}(),function(){var e;e=b8e.Object.extends({type:0,name:"",rank:0,time:0,setData:function(e){this.type=e.type,this.name=e.name,this.rank=e.lastRank-e.rank,this.time=e.time}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ArenaLogInfo",e)}(),function(){var e;e=game.Widget.extends({ctor:function(e){this._super(44),this.bindEnum=e},loadComplete:function(){this.hide(),this.data&&this.show(this.data)},init:function(){this.roleData=game.BaseRoleData.get(game.RoleType.Hero,1)},show:function(e){this.data=e,this._super()},onShow:function(){this.setData(this.data),this.setVisible(!0)},onHide:function(){this.clearModel(),this.setVisible(!1)},setData:function(e){e&&(this.skin.nameLab.string=e.name,this.skin.infoLab.string=game.Lang.get(607,e.rank,e.power),this.skin.self.node.active=e.isSelf,this.skin.seckill.node.active=e.isSeckill,this.createModel())},createModel:function(){var e=this,t=e.data;if(t){e.roleData&&e.roleData.reset(),e.roleData.type=game.RoleType.Hero,e.roleData.setMale(t.isMale),e.roleData.heroModel.setSurface(t.surface),e.roleData.heroModel.type=game.RoleType.Hero,e.model=game.sceneRoleCreate.createUIRole(e.roleData),e.model.addToParent(e.skin.model);var a=game.AvatarUtil;a.updateUIModel(e.model,a.ID_16,!1),e.model.transition(game.RoleStateType.ACTION_IDLE)}},clearModel:function(){this.model&&(this.model.removeFromParent(),this.model.release(),this.model=null)},challengeBtn:function(){this.send(game.ArenaEvts.V2C_CHALLENGE,this.data)}}),b8e.RC("$$game","$$ArenaDefier",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(45)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._list.itemRender=game.PrizeListItem,this._list.layout.spacingX=52.5,this._list.addToParent(this.skin.prize_scrollview);var e=game.GridUtil.createViewClickIcon(game.IconSizeEnum.GRID_SIZE_42);e.setItemId(21),e.addToParent(this.skin.bind_gold)},notify:function(e,t){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateView(t)}},onHide:function(){if(this.clearTimer(),this._list){this._list.clear()}this.skin.light||b8e.Tween.kill(this.skin.light),b8e.sound.stopAllEffectSound(),game.playBack.info=null},createTimer:function(){if(this._timer);else this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start()},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){if(this.closeTime<1)return this.send(this.Evts.V2C_SHOW_PRIZE),void game.module.hide(game.ME.ArenaFinish);this.closeTime--,this.skin.btnLab.string=game.Lang.get(624,this.closeTime)},updateView:function(e){var t=this.skin;this.data=e,this.closeTime=6,this.createBg(),this.updateTime(),this.createTimer(),this.createPrize(),this.createInfo();var a=game.playBack.info;a&&(t.roundLab.string=game.Lang.get(1621,a.rounds,a.roundLimit)),t.roundLab.active=t.roundDesc.active=t.details_btn.active=null!=a},createBg:function(){var e=this.data.win;this.skin.winPanel.active=e,this.skin.losePanel.active=!e,e&&(game.TweenUtil.rotationEffect(this.skin.light),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeVictory))},createPrize:function(){for(var e=game.ServerItemUtil.analyzeItems(this.data),t=[],a=void 0,i=0,n=e.length;i<n;i++){var s=e[i],o=game.AmountCfg.getItemId(game.AmountType.YUAN_BAO);s.id!=o?(s.iconLayoutEnum=game.IconLayoutEnum.SHOW_ALL,t.push(s)):a=s}this._list.setData(t),this.resetPrizeList(t.length),this.skin.prizeLab.string=a?a.num:0,this.skin.huawen_3.width=b8e.stageWidth+100,this.skin.huawen_1.width=b8e.stageWidth+100},resetPrizeList:function(e){var t=void 0;switch(e){case 1:t=290;break;case 2:t=220;break;case 3:t=150;break;default:t=90}this.skin.prize_scrollview.setPosition(t,-336)},createInfo:function(){var e=game.arenaData,t=this.data.rank;this.skin.historyRankLab.string=game.Lang.get(620,e.historyRank),this.skin.rankLab.string=game.Lang.get(0==t?622:621,e.mineRank,t)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t),this.skin.gray.setSize(b8e.stageWidth+50,530)}});b8e.module.registerView(game.ME.ArenaFinish,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(46),this.setSize(540,65)},setData:function(e){var t=this.skin,a=e.type,i=e.rank;t.win.node.active=1==a||3==a,t.lose.node.active=2==a||4==a,t.logLab.string=game.Lang.get(1==a||2==a?614:615,e.name),t.timeLab.string=b8e.TimeUtil.formatTimestamp(e.time),t.stateLab.string=game.Lang.get(0==i?616:0<i?617:618,Math.abs(i))}}),b8e.RC("$$game","$$ArenaLogItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(47)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.ArenaLogItem,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this._list.setData(game.arenaData.logs)}},onShow:function(){this.send(this.Evts.V2C_SYS_DATA)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.ArenaLog,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(48),this.toggles={toggle_btn_1:game.ME.Arena,toggle_btn_2:game.ME.CSArena,toggle_btn_3:game.ME.WorldChallenge,toggle_btn_4:game.ME.AllServerWar,toggle_btn_5:game.ME.CsOverlord,toggle_btn_6:game.ME.CsOverlordWorship},this.spotAlerts={ARENA_ALERT:this.arenaAlert,CSARENA:this.csAarenaAlert,WORLD_CHALLENGE:this.worldChallengeAlert,ALL_SERVER_WAR:this.allServerWarAlert,CSOVERLORD_MATCH:this.csOverlordMatchAlert,CSOVERLORD_WORSHIP:this.csOverlordWorshipAlert}},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},arenaAlert:function(e){this.skin.red_spot_1.node.active=e.alert},csAarenaAlert:function(e){this.skin.red_spot_2.node.active=e.alert},worldChallengeAlert:function(e){this.skin.red_spot_3.node.active=e.alert},allServerWarAlert:function(e){this.skin.red_spot_4.node.active=e.alert},csOverlordMatchAlert:function(e){this.skin.red_spot_5.node.active=e.alert},csOverlordWorshipAlert:function(e){this.skin.red_spot_6.node.active=e.alert}});b8e.module.registerView(game.ME.ArenaMain,e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(49),this.setSize(542,65)},init:function(){var e=this.skin,t=game.IconSizeEnum.GRID_SIZE_42;this.prizeIcon0=game.GridUtil.createViewClickIcon(t),this.prizeIcon0.addToParent(e.cost0);var a=game.GridUtil.createViewClickIcon(t);a.setItemId(21),a.addToParent(e.cost1);var i=game.GridUtil.createViewClickIcon(t);i.setItemId(25),i.addToParent(e.cost2)},setData:function(e){var t=this.skin,a=e.rank;t.rankLab.node.active=3<a;var i=0<(t.rankLab.string=a)?game.ArenaRewardCfg.getData(a):null;if(i){var n=i.rewards2.length;if(t.cost0.active=2<n,2<n){var s=i.rewards2[0];this.prizeIcon0.setItemId(s.Id),t.costLab0.string=s.Num}var o=game.arenaData;t.costLab1.string=o.getPrizeNumById(21,i),t.costLab2.string=o.getPrizeNumById(25,i),a=e.rank<4?e.rank:4,this.rankBg=this.getComponent("rank"+a),this.rankBg.node.active=!0,t.nameLab.string=e.name}},onHide:function(){this.rankBg&&(this.rankBg.active=!1)}})).poolCall=!0,b8e.RC("$$game","$$ArenaRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(50)},init:function(){var e=this.skin;this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.ArenaRankItem,this._list.bindEnum=game.ME.ArenaRank,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview);var t=game.IconSizeEnum.GRID_SIZE_42,a=game.GridUtil.createViewClickIcon(t);a.setItemId(21),a.addToParent(e.costIcon1);var i=game.GridUtil.createViewClickIcon(t);i.setItemId(25),i.addToParent(e.costIcon2)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateView()}},onShow:function(){this.send(this.Evts.V2C_SYS_DATA)},updateView:function(){var e=this.skin,t=game.rankData.getRankInfoArrByType(game.RankType.Arena);this._list.setData(t);var a=game.arenaData.mineRank;e.mineRankLab.string=game.Lang.get(619,a);var i=0<a?game.ArenaRewardCfg.getData(a):null;if(i){var n=game.arenaData;e.costLab1.string=n.getPrizeNumById(21,i),e.costLab2.string=n.getPrizeNumById(25,i)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+100;this.setPosition(e,t)}});b8e.module.registerView(game.ME.ArenaRank,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(51),this.spotAlerts={SHOP_ARENA:this.shopAlert,ARENA_AWARD:this.AwardAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},AwardAlert:function(e){this.skin.redFight1.active=e.alert},init:function(){var e=this,t=e.skin;e.initDefiers(),e._bgImg=b8e.Sprite.get(),e._bgImg.setAnchor(0,1),e._bgImg.addToParent(e.skin.bg);var a=game.IconSizeEnum.GRID_SIZE_42,i=game.GridUtil.createViewClickIcon(a);i.setItemId(25),i.addToParent(t.score_icon);var n=game.GridUtil.createViewClickIcon(a);n.setItemId(21),n.addToParent(t.cost1);var s=game.GridUtil.createViewClickIcon(a);s.setItemId(25),s.addToParent(t.cost2),game.arenaData.initAwardData(),game.arenaData.setAwardData(),e.item=game.GridUtil.createItemIcon(game.IconSizeEnum.CIRCLE_SIZE_84),e.item.addToParent(e.skin.iconNode);var o=e.anim=b8e.Animator.get(game.AnimType.UI_EFFECT,2);o.addToParent(e.skin.anim),o.load(game.ResCfg.getUrl(5019,1123)),o.play(null,0)},notify:function(e){var t=this;switch(e){case t.Evts.C2V_UPDATE_VIEW:t.showDefiners(),t.createInfo(),t.updateAward();break;case t.Evts.C2V_UPDATE_INFO:t.createInfo();break;case t.Evts.C2V_UPDATE_TIME:t.createRemTime();break;case t.Evts.C2V_UPDATE_AWARD:t.updateAward()}},onShow:function(){this.createBg(),this.updateAward(),this.send(this.Evts.V2C_SYS_DATA)},updateAward:function(){var e=this,t=game.arenaData.getAwardList();if(t){var a=t[0],i=a.rewards;if(i&&!(i.length<1)){game.arenaData.isGet()?(e.skin.isGet.active=!0,e.skin.count_lab.active=!1,e.skin.des.active=!1):(e.skin.isGet.active=!1,e.skin.count_lab.active=!0,e.skin.des.active=!0),e.skin.des.string=a.des,e.skin.count_lab.string=a.canGet?game.Lang.get(52357):game.Lang.get(53058,game.arenaData.mineRank-a.rank);var n=i[0],s=game.ItemUtil.createBaseItemInfo(n.Id,n.Num,e.awardInfo);game.GridUtil.setItemIcon(e.item,s,!1,game.IconLayoutEnum.SHOW_NUM)}}},initDefiers:function(){var e;this.defiers=[];for(var t=1;t<=5;t++){(e=new game.ArenaDefier(game.ME.Arena)).addToParent(this.getComponent("info"+t)),this.defiers.push(e)}},showDefiners:function(){for(var e,t,a=game.arenaData.defiers,i=0;i<5;i++){if(e=this.defiers[i],t=a[i]){e.show(t)}else e.hide()}},hideDefiners:function(){this.defiers.forEach(function(e){e.hide()},this)},createBg:function(){this._bgImg.loadTexture(game.ResCfg.getImgUrl("arena/arenaBg",!0))},createInfo:function(){var e=this.skin,t=game.arenaData;e.rankLab.string=game.Lang.get(608,t.mineRank),e.countLab.string=game.Lang.get(609,t.challenges);var a=0<t.mineRank?game.ArenaRewardCfg.getData(t.mineRank):null;if(a){var i=game.arenaData;e.costLab1.string=i.getPrizeNumById(21,a),e.costLab2.string=i.getPrizeNumById(25,a);var n=game.amount.get(game.AmountType.WU_XUN);e.scoreLab.string=n,e.powerLab.string=game.mainRoleData.power,this.createRemTime()}},createRemTime:function(){if(game.arenaData.remTime<1){this.skin.timeLab.string=""}else this.skin.timeLab.string=game.Lang.get(610,b8e.TimeUtil.formatTime(1e3*game.arenaData.remTime))},$$getArenaItem:function(e){return this.defiers&&this.defiers[e]?this.defiers[e]:null},onHide:function(){this.hideDefiners()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.Arena,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1697)},init:function(){this.data=game.arenaData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_BUY_NUM:this.updateBuyNum()}},onShow:function(){this.resetBuyNum(),this.updateBuyNum(),this.updateDesc()},updateBuyNum:function(){var e=this.data,t=this.skin,a=e.getPerTimeCost(),i=e.getReadyBuyNum();t.buyNum.string=i,t.amountNum.string=i*a},onHide:function(){this.resetBuyNum()},resetBuyNum:function(){var e=this.data,t=e.getCanBuyNum()<1?0:1;e.setReadyBuyNum(t)},updateDesc:function(){var e=this.skin,t=game.mainRoleData.vipLevel,a=game.VipCfg.getMaxLv(),i=game.VipCfg.getData(t),n=game.VipCfg.getData(Math.min(a,t+1)),s=i.arena-game.arenaData.buys,o=void 0,r=void 0;r=a<=t?(o=612,s):(o=611,[s,t+1,n.arena-i.arena]),e.mainDesc.string=game.Lang.get(o,r)}});b8e.module.registerView(game.ME.ArenaBuyView,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1520),this.setSize(540,169)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.awardList.itemRender=game.PrizeListItem,this.awardList.addToParent(this.skin.awardList)},setData:function(e){var t=this.skin;t.name.string=game.Lang.get(53066,e.rank),t.canGet_Btn.active=e.canGet,t.isGet.active=e.isGet,t.goTo.active=!e.canGet&&!e.isGet;var a=game.CfgUtil.getPrizeListInfo(e.rewards,null,game.IconSizeEnum.GRID_SIZE_84);a&&this.awardList.setData(a.items)},canGet_Btn:function(){this.send(game.ArenaEvts.V_ISGET_AWARD,this.data.rank)}}),b8e.RC("$$game","$$ArenaAwardItme",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1521)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.ArenaAwardItme,e.bindEnum=game.ME.Arena,e.addToParent(this.skin.list)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_AWARD:this.updateList()}},onShow:function(){this.list.scrollToTop(),this.updateList()},updateList:function(){var e=game.arenaData.getAwardList();this.list.setData(e)}});b8e.module.registerView(game.ME.ArenaAwardPreview,e)}(),function(){var e;e=b8e.Enum({NONE:-1,V_FOSTER_SKIN_LEFT:-1,V_FOSTER_SKIN_RIGHT:-1,V_SELECT_SKIN:-1,V_SHOW_VIEW:-1,V_HIDE_VIEW:-1,V_UPDATE_ITEM:-1,V_SKIN_ACTIVE:-1,V_SKIN_CHANGE:-1}),b8e.RC("$$game","$$FosterSkinEvts",e)}(),function(){var e=b8e.Object.extends({cfg:null,openSkillTips:function(e){game.skillTipsInfo=e,game.module.show(game.ME.CultivateBaseSkillTips)}});game.skinData=game.skinData||new e}(),function(){var e;e=game.Control.extends({skinData:null,fosterData:null,init:function(){},preBtn:function(){},btn_illusion:function(){this.sender.FosterHuanhuaReq(this.fosterData.fosterType,2,this.skinData.curSelectId)},activeBtn:function(){this.sender.FosterSkinReq(this.fosterData.fosterType,this.skinData.curSelectId)},leftBtn:function(){this.send(this.Evts.V_FOSTER_SKIN_LEFT)},rightBtn:function(){this.send(this.Evts.V_FOSTER_SKIN_RIGHT)},recycleSurfaceBtn:function(){game.module.show(game.ME.RecycleSurface)},toGet:function(){var e=this.skinData.curSelectId,t=this.skinData.getCfg(e);if(!t||!t.approachId);},updateItemInfo:function(){this.updateSkinList(),this.send(this.Evts.V_UPDATE_ITEM)},skinActive:function(){this.updateSkinList(),this.send(this.Evts.V_SKIN_ACTIVE)},skinChange:function(){this.updateSkinList(),this.send(this.Evts.V_SKIN_CHANGE)},initSkinList:function(){this.updateSkinList()},updateSkinList:function(){var e,t,a;if(!this.skinData.skinList){this.skinData.initSkinList()}for(var i=this.skinData.skinList.length,n=this.skinData.curSelectId,s=0;s<i;s++){if((e=this.skinData.skinList[s]).isSelect=e.id==n,e.isSelect);if(e.isWeared=2==this.fosterData.wearedType&&this.fosterData.wearedId==e.id,e.isActive=-1!=this.fosterData.skinIds.indexOf(e.id),t=e.getCfg(),e.isCanActive=!1,t&&!e.isActive){a=game.itemData.getNumById(t.itemId),e.isCanActive=a>=t.itemNum}this.skinData.skinList[s]=e}this.skinData.skinList.sort(this.onSort)},onSort:function(e,t){if(e.isCanActive&&!t.isCanActive){return-1}if(!e.isCanActive&&t.isCanActive){return 1}if(e.isWeared&&!t.isWeared){return-1}if(!e.isWeared&&t.isWeared){return 1}if(e.isActive&&!t.isActive){return-1}if(e.isActive||!t.isActive)return e.id-t.id;return 1},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SELECT_SKIN:a.skinData.curSelectId=t,a.updateSkinList(),a.send(a.Evts.V_SELECT_SKIN);break;case a.Evts.V_SHOW_VIEW:if(a.updateSkinList(),0==a.skinData.curSelectId){if(this.skinData.skinList&&0<this.skinData.skinList.length){this.skinData.curSelectId=this.skinData.skinList[0].id,this.skinData.skinList[0].isSelect=!0}}a.send(a.Evts.V_SELECT_SKIN);break;case a.Evts.V_HIDE_VIEW:if(a.skinData.skinList&&0<a.skinData.skinList.length){this.skinData.curSelectId=this.skinData.skinList[0].id,this.skinData.skinList[0].isSelect=!0}}}}),b8e.RC("$$game","$$FosterSkinControl",e)}(),function(){var e=game.Control.extends({touch:function(){game.module.hide(game.ME.FosterSkinSkillTips)}}),t=[game.ME.FosterSkinSkillTips];b8e.module.registerControl(game.ME.FosterSkinSkillTips,e,game.FosterSkinEvts,null,t)}(),function(){var e;(e=game.ListItem.extends({fosterData:null,ctor:function(){this._super(428),this.setSize(110,250)},setData:function(){var e=this.data.getCfg();if(e){var t=this.skin;t.selectImg.node.active=this.data.isSelect,t.activeImg.node.active=this.data.isActive,t.name.string=e.name,t.red_alert.active=this.data.isCanActive,t.illusionImg.node.active=this.data.isWeared,t.time.node.active=!1}},click:function(){this.send(game.FosterSkinEvts.V_SELECT_SKIN,this.data.id)}})).poolCall=!0,b8e.RC("$$game","$$FosterSkinItem",e)}(),function(){var e;e=game.View.extends({skinList:null,gridList:null,fosterData:null,skinData:null,_spriteStr:"",power:0,_fosterModel:null,_modelTouchClose:!1,_showModel:!0,ctor:function(){this._super(430),this.spotAlerts={RECYCLE_SURFACE1_ALERT:this.recycleAlert}},recycleAlert:function(e){this.skin.recycle_alert.active=e.alert},init:function(){var e=this,t=e.gridList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.FosterSkinItem,t.addToParent(e.skin.scrollGrid),t.layout.paddingLeft=0,t.layout.spacingX=7,e.fosterType=e.fosterData.fosterType;var a=e.roleData=game.BaseRoleData.get(game.RoleType.Hero,e.fosterType);a.heroModel.type=game.RoleType.Foster,a.setMale(game.mainRoleData.isMale);var i=game.mainRoleData.isMale?1001:1002;a.heroModel.setBody(game.RoleType.Foster,i),e.role=game.sceneRoleCreate.createUIRole(a),e.role.addToParent(e.skin.model);var n=e.titleImg=b8e.Sprite.get();n.addToParent(e.skin.titleImg),n.setAnchor(.5,.5),e.skillIcon=new game.CultivateBaseSkillIcon(game.IconSizeEnum.CIRCLE_SIZE_105),e.skillIcon.setShowPassiveSkillIcon(!1),e.skillIcon.setClickCallBack(game.skinData.openSkillTips,game.skinData),e.skillIcon.addToParent(e.skin.skillNode)},onShow:function(){var e=this;e.setSkinList(),e.send(e.Evts.V_SHOW_VIEW,this.skinData.curSelectId),e.setActiveDesc();var t=game.FosterUtil.getFosterNameImgByType(e.fosterType);t&&""!=t&&e.titleImg.loadTexture(t);var a=game.FosterUtil.getFosterNameByType(e.fosterType);e.skin.lab_total_power.string=game.Lang.get(3001,a),e.skin.lab_active_power.string=game.Lang.get(3002,a)},onHide:function(){},skinChange:function(){var a=this;if(a.skinData){var e=a.skinData.curSelectId,i=a.cfg=a.skinData.getCfg(e);if(game.skinData.cfg=i){var t=a.skin;t.btn_illusion.node.active=!1,t.illusionImg.node.active=!1,t.activePage.active=!1,t.activeBtn.node.active=!1,t.power.string=i.power,game.AutoLayoutUtil.layoutPower(t.img_power,t.power,t.img_power0,t.preBtn),1!=a.fosterData.wearedType&&a.fosterData.wearedId==e?(t.illusionImg.node.active=!0,t.maskImg.node.active=!1,t.takeEffectLab.string=game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9847))):(t.maskImg.node.active=!0,t.takeEffectLab.string=game.HtmlUtil.getText(game.Color.RED,game.Lang.get(9848)),-1!=a.fosterData.skinIds.indexOf(e)?t.btn_illusion.node.active=!0:a.setCost()),a.setAnim();var n=i.spriteStat.getSpriteStats();a._spriteStr="",n.forEach(function(e,t){e=+e,i=game.AttrRulesCfg.getData(e),a._spriteStr+=game.Lang.get(507,i.name,t)+"<br/>"},a),t.spriteLab.string=a._spriteStr,a.setSkill()}else b8e.warn("SkinCfg\u4e0d\u5b58\u5728id\uff1a",i.id,"\u7684\u914d\u7f6e")}},setAnim:function(){},setSkill:function(){if(this.skinData){var e=this.skinData.curSelectId,t=this.skinData.getCfg(e);if(t){var a=t.skill[0];this.skillIcon.setData(a)}}},setCost:function(){var e=this;if(e.skinData){var t=e.skinData.curSelectId,a=e.skinData.getCfg(t);if(a){var i=e.skin;e._itemGrid||(e._itemGrid=game.GridUtil.createCostItemIcon(),e._itemGrid.addToParent(i.icon)),game.GridUtil.setItemIcon(e._itemGrid,a.itemId);var n=game.ItemInfoCfg.getData(a.itemId),s=game.itemData.getNumById(a.itemId);if(n){if(s>=a.itemNum)i.activeBtn.node.active=!0,i.activePage.active=!1;else{i.activePage.active=!0,i.activeBtn.node.active=!1;var o=game.Lang,r=game.HtmlUtil.IsEnoughGOR(s>=a.itemNum),g=o.get(3004,s,a.itemNum);g=game.HtmlUtil.getText(r,g);var l=game.HtmlUtil.getColorStrByQuality(n.quality,n.name);i.cost.string=o.get(3003,l,g);var c=i.toGet.width,h=i.cost.width,m=120+(h<c?c:h)+20;s>=a.itemNum&&m<270&&(m=270),e.skin.infoBg_3.width=m}var u=game.HtmlUtil;g=u.getText(game.Color.GREEN,a.approach);0<a.approachId?e.skin.toGet.string=u.getulText(g):e.skin.toGet.string=g}else b8e.warn("\u4e0d\u5b58\u5728cfg.itemId:"+a.itemId+"\u7684\u914d\u7f6e")}}},setSkinList:function(){var e=this;if(e.skinData){this.selectNewSkin(),e.skinList=e.skinData.skinList;var t=e.skinData.getIndex(this.skinData.curSelectId);e.gridList.setData(e.skinList);var a=0,i=e.skinList.length-5;a=Math.min(i,t),a=Math.max(0,a),a*=-110,e.gridList.scrollToPos({x:a,y:0})}},selectNewSkin:function(){var e=this;e.skinList=e.skinData.skinList;for(var t=!1,a=0;a<e.skinList.length;a++){var i=e.skinList[a];if(i.isCanActive){t=!0,this.send(this.Evts.V_SELECT_SKIN,i.id);break}}t||this.send(this.Evts.V_SELECT_SKIN,this.skinData.curSelectId)},setActiveDesc:function(){var e=this;if(e.fosterData&&e.skinData){var t=e.fosterData.skinIds;if(e.skin.activeSkinCount.string=t.length,(e.power=0)<t.length)for(var a,i,n=t.length,s=0;s<n;s++)a=t[s],(i=e.skinData.getCfg(a))&&(e.power+=i.power);e.skin.activePower.string=e.power+""}},view_right:function(){this.gridList.scrollContainerRight()},view_left:function(){this.gridList.scrollContainerLeft()},getUrl:function(e){return b8e.warn("\u5916\u90e8\u91cd\u5199\u65b9\u6cd5\uff0c\u4e0d\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528"),game.ResCfg.getUrl(5003,e)}}),b8e.RC("$$game","$$FosterSkinView",e)}(),function(){var e;e=game.CultivateBaseSkillIcon.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:game.IconSizeEnum.SIZE_84;this._super(t)},fnOnClickGrid:function(){this.skillId&&this.isShowTips&&game.module.show(game.ME.FosterSkinSkillTips)}}),b8e.RC("$$game","$$FosterSkinSkillIcon",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(429)},init:function(){this.skillIcon=new game.FosterSkinSkillIcon,this.skillIcon.addToParent(this.skin.skillNode)},onShow:function(){this.updateData()},updateData:function(){var e=game.skinData.cfg;if(e){var t=e.skill[0];this.skillIcon.setData(t),game.AsyncData.getEAsyncData(game.SkillCfg,[t],this._updateData,this)}},_updateData:function(e){if(e){var t=this.skin,a=e.quality,i=e.name;t.skillName.string=game.HtmlUtil.getColorStrByQuality(a,i,!0),t.skillType.string=0==e.type?game.Lang.get(9051):game.Lang.get(9052),t.skillDes.string=game.LangSkill.get(e.desc,e.descParam),t.tipsbg.height=170+this.skin.skillDes.height+36}},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.FosterSkinSkillTips,e)}(),function(){var e;e=b8e.Enum({None:0,CHANGESHOWBOX:-1,UPDATE_XIANDIVIEW:-1,INIT_SETSHOWINDEX:-1,SETSHOWINDEX:-1,GET_PRIZE:-1,GET_PRIZESUCCEED:-1,V_REQ_RANKINFO:-1,C_REQ_RANKINFO:-1,V_AUTO_FIGHT_CHANGE:-1,V_START_FIGHT:-1,C2C_SYS_DATA_SUCCEED:-1,C2C_CHALLENGE_SUCCEED:-1,SHOW_NOTICE_NEEDVIP:-1,CLOSE_PRIZETIPS:-1,C2C_UPDATE_AUTOFIGHT:-1,CLOSE_RANKVIEW:-1,C2C_CHALLENGE_WIN:-1,C2C_SET_FORMATION:-1,C2C_CHALLENGE_WIN_NUM:-1}),b8e.RC("$$game","$$BaoZangEvts",e)}(),function(){var e=game.Control.extends({isAssist:!1,isRequest:!1,ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.syncXiandi},InstanceFunc:{UPDATE_AUTOFIGHT:this.updateAutoFight},Rank:{C_UPDATE_DATA:this.updateRankInfo},DifficultSelect:{C2C_SELECT_DIFFICULT:this.selectDifficult}},this.handels={XiandiChallengeResp:this.onRpXiandiChallenge,XiandiSweepResp:this.onRpXiandiSweep,XiandiAwardResp:this.onRpXiandiAward}},init:function(){this.baoZangTag=game.spotAlert.set(game.SAE.BAO_ZANG_TAG,game.SAE.INSTFUNC),this.baoZangAlert=game.spotAlert.set(game.SAE.BAO_ZANG),this.fightAlert=game.spotAlert.set(game.SAE.BAO_ZANGFIGHT)},notify:function(e,t){var a=this;switch(e){case a.Evts.CHANGESHOWBOX:a.changeShowBox(t);break;case a.Evts.SETSHOWINDEX:a.setShowIndex();break;case a.Evts.INIT_SETSHOWINDEX:a.init_setShowIndex();break;case a.Evts.GET_PRIZE:a.reqAwardByStar();break;case a.Evts.V_REQ_RANKINFO:break;case a.Evts.V_START_FIGHT:a.startFight();break;case a.Evts.CLOSE_RANKVIEW:a._rankViewShow=!1}},updateAutoFight:function(){this.send(this.Evts.V_AUTO_FIGHT_CHANGE)},startFight:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return game.baoZangData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}var e=game.baoZangData.curId+1,t=game.XiandiCfg.getData(e),a=game.mainRoleData.lv;if(t.needlv>a)game.notice.show(game.Lang.get(514,t.needlv));else{if(!t){return game.notice.show(9066),void this.autoBg_1()}if(t.diffcultType!=game.baoZangData.curDifficulty)return game.baoZangData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),game.difficultSelectData.curInstType=game.DifficultSelectType.BAOZANG,void game.module.show(game.ME.DifficultSelect);if(game.UpgradeUtil.checkEquipTooMuch()){this.autoBg_1()}else if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){this.autoBg_1()}else game.baoZangData.fightData=game.XiandiCfg.getData(e),this.sender.XiandiChallengeReq(e,0)}},syncXiandi:function(e){if(game.moduleOpen.checkOpen(game.ME.BaoZang)){var t=e.data;if(t)game.baoZangData.setInitInfo(t),this.checkAllAlert(),this.dpt(this.Evts.C2C_SYS_DATA_SUCCEED);else;}},init_setShowIndex:function(){if(game.baoZangData.maxId){var e=game.XiandiCfg.getData(game.baoZangData.maxId);game.baoZangData.curDifficulty=e.diffcultType}game.baoZangData.setShowIndex(),this.send(this.Evts.UPDATE_XIANDIVIEW)},setShowIndex:function(){var e=game.baoZangData;if(game.baoZangData.curId){var t=game.XiandiCfg.getData(game.baoZangData.curId);t.diffcultType!=e.curDifficulty&&(e.curDifficulty=t.diffcultType)}e.setShowIndex(),this.send(this.Evts.UPDATE_XIANDIVIEW)},onRpXiandiChallenge:function(e){var t=e.readProtobuf(game.pb.XiandiChallengeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.battlelog.rounds;game.baoZangData.setStar(t.id,a,t.battlelog.win),game.GameViewMgr.inst().hideUnStrongViews();var i={type:game.InstanceType.XIAN_DI_BAO_ZANG,rewards:t.useritem,exp:t.exp};game.baoZangData.fightId=t.id;var n=game.XiandiCfg.getData(t.id),s=game.XiandiCfg.getData(t.id+1);if(t.battlelog.win){var o=!0;s&&s.diffcultType>n.diffcultType&&(o=game.baoZangData.dfcGetIsStar(n.diffcultType)),o||(game.baoZangData.fightId-=1)}else game.baoZangData.fightId-=1;if(game.playBack.play(t.battlelog,i),this.checkAllAlert(),this.dpt(this.Evts.C2C_CHALLENGE_SUCCEED),i.win)this.dpt(this.Evts.C2C_CHALLENGE_WIN),this.dpt(this.Evts.C2C_CHALLENGE_WIN_NUM,1);else{game.baoZangData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT)}},onRpXiandiSweep:function(e){var t=e.readProtobuf(game.pb.XiandiSweepResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a={win:!0,type:game.InstanceType.XIAN_DI_BAO_ZANG,rewards:t.useritem,exp:t.exp};b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,a),game.baoZangData.xiandiSweepSucceed(),game.baoZangData.setShowIndex();var i=game.baoZangData.xiandiSweepNum2();this.dpt(this.Evts.C2C_CHALLENGE_WIN_NUM,i),this.checkAllAlert(),this.send(this.Evts.UPDATE_XIANDIVIEW)}},onRpXiandiAward:function(e){var t=e.readProtobuf(game.pb.XiandiAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else{for(var a=t.ids,i=game.baoZangData.xiandiAwardList||[],n=0;n<a.length;n++)i.push(a[n]);game.baoZangData.xiandiAwardList||(game.baoZangData.xiandiAwardList=i),this.send(this.Evts.GET_PRIZESUCCEED),this.send(this.Evts.UPDATE_XIANDIVIEW),this.send(this.Evts.CLOSE_PRIZETIPS),this.checkAllAlert()}},checkAllAlert:function(){this.checkAlert(),this.checkPassAlert(),this.checkFightAlert(),this.checkTagAlert()},checkAlert:function(){var e=game.baoZangData;this.baoZangAlert.alert=e.isAlert()},checkPassAlert:function(){var e=game.baoZangData.getPass();this.baoZangAlert.alert=e},checkFightAlert:function(){var e=game.baoZangData.getAllStarNum();this.fightAlert.alert=!e},checkTagAlert:function(){this.baoZangTag.alert=this.baoZangAlert.alert||this.fightAlert.alert},changeShowBox:function(e){game.baoZangData.curShowIndex=e;var t=game.baoZangData.getCurInstanceData(e);game.baoZangData.curId=t.id,this.send(this.Evts.UPDATE_XIANDIVIEW)},prizeBoxBtn0:function(){this.showTipsView(6)},prizeBoxBtn1:function(){this.showTipsView(12)},prizeBoxBtn2:function(){this.showTipsView(18)},showTipsView:function(e){game.baoZangData.curStar=e,game.module.show(game.ME.BaoZangPrize)},rightBtn:function(){if(game.baoZangData.curGroup>=game.baoZangData.maxGroup){game.baoZangData.curGroup=game.baoZangData.maxGroup}else game.baoZangData.setCurGroup(1);this.send(this.Evts.UPDATE_XIANDIVIEW)},leftBtn:function(){if(game.baoZangData.curGroup<=game.baoZangData.minGroup){game.baoZangData.curGroup=game.baoZangData.minGroup}else game.baoZangData.setCurGroup(-1);this.send(this.Evts.UPDATE_XIANDIVIEW)},oneKeyBtn:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e);if(t&&t.xiandiSweep){if(!game.UpgradeUtil.checkEquipTooMuch()){this.sender.XiandiSweepReq()}}else game.notice.show(9484)},waBaoBtn:function(){this.isAssist=!1,this.xiandiChallengeReq()},assistBtn:function(){game.teamLeagueAssistData.canChallenge()&&(this.isAssist=!0,this.xiandiChallengeReq())},xiandiChallengeReq:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap())return game.baoZangData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE);var e=game.baoZangData.getCurInstanceData(game.baoZangData.curShowIndex),t=game.mainRoleData.lv;if(e.needlv>t)game.notice.show(game.Lang.get(514,e.needlv));else if(e)if(!(1<e.id-game.baoZangData.maxId)){if(!game.UpgradeUtil.checkEquipTooMuch()){if(game.UpgradeUtil.checkEquipTooMuch())return;if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap())return;game.baoZangData.fightData=game.XiandiCfg.getData(e.id),this.dpt(this.Evts.C2C_SET_FORMATION,[game.ME.BaoZang,e.id,this.sender.XiandiChallengeReq,[e.id,this.isAssist?1:0],this])}}else game.notice.show(9067)},autoBg_1:function(){game.baoZangData.autoFight=!game.baoZangData.autoFight,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,game.baoZangData.autoFight)},reqAwardByStar:function(){var e=game.baoZangData.getBoxPrizeInfo();this.sender.XiandiAwardReq([e.id])},closeAllBtn:function(){game.module.hide(game.ME.BaoZang),game.module.hide(game.ME.InstanceFunc)},reqRankInfo:function(){this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.InsXianDi)},updateRankInfo:function(){this.send(this.Evts.UPDATE_XIANDIVIEW),this._rankViewShow&&!b8e.module.isShowView(game.ME.BaoZangRank)&&(game.module.show(game.ME.BaoZangRank),this.isRequest=!0)},showRankBtn:function(){this._rankViewShow||(this._rankViewShow=!0),this.reqRankInfo(),this.isRequest&&this.updateRankInfo()},sureBtn:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){this.reqAwardByStar()}},yijianBtn:function(){var e,t=game.mainRoleData.vipLevel,a=game.VipCfg.getData(t);if(a&&a.xiandiSweep){var i=!0,n=game.baoZangData.maxId;if(n){var s=game.XiandiCfg.getData(n);if(s)for(var o=0,r=[],g=1;g<=s.group;g++){e=game.XiandiAwardCfg.getAwardByGroup(g),o=game.baoZangData.awardBoxGet(g);for(var l=0;l<e.length;l++)o>=e[l].star&&(game.baoZangData.isGetAward(e[l].id)||(i=i&&!1,r.push(e[l].id)))}}i?game.notice.show(9068):this.sender.XiandiAwardReq(r)}else this.send(this.Evts.SHOW_NOTICE_NEEDVIP)},selectDifficult:function(e){if(e&&e.data){var t=e.data;t.instType==game.DifficultSelectType.BAOZANG&&(game.baoZangData.curDifficulty=t.difficult,game.baoZangData.changeDfcSetShowIndex(t.difficult),this.send(this.Evts.UPDATE_XIANDIVIEW,t.difficult))}},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.BAOZANG_SHOP)}}),t=game.Sender.extends({ipc:function(){this.msg={XiandiChallengeReq:this.reqXiandiChallenge,XiandiSweepReq:null,XiandiAwardReq:this.reqXiandiAward}},reqXiandiChallenge:function(e,t){var a=game.pb.XiandiChallengeRequest;a.id=e,a.type=t,this.write(a)},reqXiandiAward:function(e){var t=game.pb.XiandiAwardRequest;t.ids=e,this.write(t)}}),a=[game.ME.BaoZangPrize,game.ME.BaoZangRank];b8e.module.registerControl(game.ME.BaoZang,e,game.BaoZangEvts,t,a)}(),function(){var e=b8e.Object.extends({autoFight:!1,xiandiInstanceMap:null,xiandiAwardList:null,curGroup:1,curStar:0,curShowIndex:0,showBoxNum:6,minGroup:1,maxGroup:1,maxId:0,minId:0,curId:0,fightId:0,curDifficulty:1,maxDifficulty:1,dailyPass:!1,fightData:null,ctor:function(){this._super(),this.xiandiInstanceMap=b8e.HashMap.get()},setInitInfo:function(e){var t=this;if(e){var a,i=e.xiandi.sort(t.sort),n=0,s=0;if(t.xiandiInstanceMap&&t.xiandiInstanceMap.clear(),i&&0<i.length){for(var o=i.length,r=0;r<o;++r)(a=t.xiandiInstanceMap.get(i[r].id))||(a=new game.XiandiInstance,t.xiandiInstanceMap.set(i[r].id,a)),a.setup(i[r]),n=n>=i[r].id?n:i[r].id,i[r].passAward||0!=s||(s=i[r].id);0==s&&(s=i[o-1].id+1)}t.maxId=n,t.curId=0==s?0:s-1,t.xiandiAwardList=e.XiandiAward,t.xiandiFinishList=i,t.maxGroup=Math.floor(n/t.showBoxNum),t.maxGroup=t.maxGroup<game.XiandiCfg.maxIndex&&3*n==t.getAllStar()?t.maxGroup+1:t.maxGroup,t.maxGroup=t.maxGroup>game.XiandiCfg.maxIndex?game.XiandiCfg.maxIndex:t.maxGroup;for(var g=1;g<n;g++){this.xiandiInstanceMap.get(g).fristFight=!0}t.fightId?t.fightId=0==s?0:s-1:t.fightId=0==n?0:n-1,t.setShowIndex(0<t.fightId)}else;},setShowIndex:function(e){var t=this;if(!e){var a=t.getMaxIdByDiffcult(t.curDifficulty);t.fightId==a&&(t.fightId-=1)}0<t.fightId?(t.curGroup=1+(t.fightId/t.showBoxNum|0),t.curShowIndex=t.fightId%t.showBoxNum):(t.curGroup=1,t.curShowIndex=0),6==t.curShowIndex&&(t.curShowIndex=0)},changeDfcSetShowIndex:function(e){var t=this,a=t.xiandiInstanceMap.values();if(a&&0<a.length){a.sort(t.sort);for(var i=a[a.length-1].id,n=game.XiandiCfg,s=0;s<a.length;++s){var o=n._xiandiList.length,r=!1;if(n._xiandiList[s].diffcultType==e)for(var g=0;g<o;g++)if(n._xiandiList[g].id==a[s].id){if(!a[s].firstAward||!a[s].passAward){i=a[s].id-1,t.minId=i,r=!0;break}i=a[s].id-1}if(r)break}0<i?(t.curGroup=1+(i/t.showBoxNum|0),t.curShowIndex=i%t.showBoxNum,t.fightId=i,t.curId=t.fightId+1):(t.curGroup=1,t.curShowIndex=0,t.fightId=0,t.curId=1)}},setCurGroup:function(e){var t=0<arguments.length&&void 0!==e?e:0;if(this.curGroup+=t,this.curGroup!=this.maxGroup){var a,i=this.getInstanceDatas(this.curGroup);if(i&&0<i.length)for(var n=0;n<i.length;++n){if(!(a=game.baoZangData.getXiandiData(i[n].id))){this.curShowIndex=n;break}if(!a.passAward){this.curShowIndex=(a.id-1)%this.showBoxNum;break}}}else this.curShowIndex=this.maxId%this.showBoxNum},sort:function(e,t){return e.id-t.id},getXiandiData:function(e){return this.xiandiInstanceMap.get(e)},isGetAward:function(e){if(this.xiandiAwardList&&0<this.xiandiAwardList.length){return-1!=this.xiandiAwardList.indexOf(e)}return!1},addAwardId:function(e){if(!this.xiandiAwardList||this.xiandiAwardList.length<=0){this.xiandiAwardList=[]}this.xiandiAwardList.push(e)},setStar:function(e,t,a){if(a){var i=this.getXiandiData(e);if(!i){i=new game.XiandiInstance,this.xiandiInstanceMap.set(e,i),this.maxId=e}this.curId=e,i.id=e;var n=game.XiandiStarCfg.getStar(t);n>i.star&&(i.star=n),i.firstAward&&(i.battleSkip=!0),i.firstAward=!0,i.passAward=!0;var s=this.xiandiInstanceMap.values().length;this.maxGroup=Math.floor(s/this.showBoxNum),this.maxGroup=this.maxGroup<game.XiandiCfg.maxIndex?this.maxGroup+1:this.maxGroup}},getAllStarXiandiId:function(){var a=[];return this.xiandiInstanceMap.forEach(function(e,t){if(3<=t.star){a.push(e)}},this),a},getAllStar:function(){var a=0;return this.xiandiInstanceMap.forEach(function(e,t){a+=t.star},this),a},xiandiSweepSucceed:function(){this.xiandiInstanceMap.forEach(function(e,t){t.passAward=!0},this);var e=this.xiandiInstanceMap.values(),t=e.length-1;this.maxId=e[t].id,this.fightId=this.maxId-1},xiandiSweepNum2:function(){return this.xiandiInstanceMap.forEach(function(e,t){t.passAward=!0},this),this.xiandiInstanceMap.values().length},getBoxPrizeInfo:function(){return game.XiandiAwardCfg.getData(this.curGroup,this.curStar)},getBoxCfgInfo:function(e,t){return game.XiandiAwardCfg.getData(e,t)},getInstanceDatas:function(e){return game.XiandiCfg.getAreaList(e)},getCurInstanceData:function(e){var t=this.getInstanceDatas(this.curGroup);if(t&&0<t.length&&e<t.length){return t[e]}return null},dfcGetIsPass:function(e){var t=!1,a=this.xiandiInstanceMap.values();if(a&&0<a.length){a.sort(this.sort);for(var i=game.XiandiCfg,n=i._xiandiList.length,s=0;s<n;s++)if(i._xiandiList[s].diffcultType==e){if(a.length<i._xiandiList[s].id)return t=!1;for(var o=0;o<a.length;++o)if(i._xiandiList[s].id==a[o].id){if(!a[o].firstAward||!a[o].passAward)return t=!1;t=!0}}}return t},dfcGetIsStar:function(e){var t=0,a=this.xiandiInstanceMap.values(),i=[];if(a&&0<a.length){a.sort(this.sort);for(var n=game.XiandiCfg,s=n._xiandiList.length,o=0;o<s;o++)if(n._xiandiList[o].diffcultType==e){i.push(n._xiandiList[o]);for(var r=0;r<a.length;++r)n._xiandiList[o].id==a[r].id&&(t+=a[r].star)}if(i.length==t/3)return!0}return!1},dfcGetIsLast:function(){var e=this.getMaxIdByDiffcult(this.curDifficulty);return this.maxId>=e},isAlert:function(){var e,t,a,i,n,s,o=this;for(s=o.minGroup;s<o.maxGroup;s++){if(a=0,(i=game.XiandiCfg.getAreaList(s))&&0<i.length)for(t=0;t<i.length;++t)(n=o.getXiandiData(i[t].id))&&(a+=n.star);var r,g=!1;for(t=0;t<3;++t)if(e=t+1,(r=game.XiandiAwardCfg.getData(s,6*e))&&(g=o.isGetAward(r.id)),6*e<=a&&!g)return!0}return!1},getPass:function(){var a=[];this.xiandiInstanceMap.forEach(function(e,t){a.push(t)},this);for(var e=0;e<a.length;e++){if(!a[e].passAward&&7<=game.mainRoleData.vipLevel)return this.dailyPass=!0}return this.dailyPass=!1},getAllStarNum:function(){var e=0,t=this.xiandiInstanceMap.values();if(t&&0<t.length){t.sort(this.sort);for(var a=0;a<t.length;++a)e+=t[a].star}return 3*game.XiandiCfg._xiandiList.length-e==0},awardBoxGet:function(e){for(var t,a=0,i=this.getInstanceDatas(e),n=0;n<i.length;++n)(t=this.getXiandiData(i[n].id))&&(a+=t.star);return a},getMaxDifficulty:function(){var e=game.XiandiCfg.getData(this.maxId);if(!e)return 1;var t=e.diffcultType,a=this.dfcGetIsStar(t),i=this.dfcGetIsLast(t);return this.getMaxDfc()<=t?t:a&&i?t+1:t},getLangKey:function(e){if(!this.langKeyArr){var t=game.InstanceMiscCfg.getData("baozangLangKey");if(!t)return null;this.langKeyArr=t.value.split("|")}return this.langKeyArr[e]},getMaxDfc:function(){if(!this.maxDfc){var e=game.XiandiMiscCfg.getData("maxDfc");if(!e)return null;this.maxDfc=+e.value}return this.maxDfc},getDiffcults:function(){return this.diffcults||(this.diffcults=game.CfgUtil.getMiscValue(game.XiandiMiscCfg,"diffcults",!0,",")),this.diffcults},getMaxIdByDiffcult:function(e){var t=this.getDiffcults();if(t&&!(t.length<1))return+t[e-1]}});game.baoZangData=game.baoZangData||new e}(),function(){var e=void 0;e=b8e.Object.extends({id:0,star:0,firstAward:!1,passAward:!1,battleSkip:!1,ctor:function(){this._super()},setup:function(e){if(e)this.id=e.id,this.star=e.star,this.firstAward=e.firstAward,this.passAward=e.passAward;else;}}),b8e.BindingUtil.bind(e),e.poolCall=!0,b8e.RC("$$game","$$XiandiInstance",e)}(),function(){var e;e=game.Widget.extends({boxInfo:null,index:0,maxStar:3,number:0,ctor:function(){this._super(83),this.spotAlerts={},this.setSize(132,132)},init:function(){this.item=game.GridUtil.createItemIcon(game.IconSizeEnum.GRID_SIZE_84),this.item.addToParent(this.skin.icon)},onShow:function(){this.setData(this.boxInfo)},baoxiang:function(){this.send(game.BaoZangEvts.CHANGESHOWBOX,this.index)},setData:function(e){var t=this.skin;if(this.boxInfo=e,t&&this.boxInfo){this.skin.baoxiang.active=game.baoZangData.curShowIndex!=this.index;var a=game.baoZangData.getXiandiData(e.id),i=0,n=!1;if(a){i=a.star,n=a.passAward}for(var s=0;s<this.maxStar;++s){this.getComponent("starIcon_"+s).node.active=s<i}t.geted.node.active=n;var o=game.ItemInfoCfg.getData(e.itme);game.GridUtil.setItemIcon(this.item,o,!1,game.IconLayoutEnum.SHOW_NONE)}else;},setElementBtn:function(e){var t=this.skin;e&&e.element?(this.elementAttr=e.element,t.view_elementBtn.active=!0,t.view_elementBtn.loadTexture(game.ResCfg.getUrl(10050,e.element))):t.view_elementBtn.active=!1},view_elementBtn:function(){this.elementAttr&&(game.elementData.setElementInfo(this.elementAttr,50369,this.skin.view_elementBtn.localToGlobal(),!1),game.module.show(game.ME.ElementAttr))}}),b8e.RC("$$game","$$BaoZangItem",e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(84),this.spotAlerts={}},init:function(){this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.list.itemRender=game.PrizeListItem,this.list.layout.paddingLeft=20,this.list.layout.paddingRight=0,this.list.layout.paddingTop=0,this.list.layout.spacingX=58,this.list.addToParent(this.skin.prizeNode)},notify:function(e){switch(e){case this.Evts.GET_PRIZESUCCEED:this.updateView();break;case this.Evts.CLOSE_PRIZETIPS:this.closeBtn()}},onShow:function(){this.updateView(),game.TweenUtil.rotationEffect(this.skin.light)},updateView:function(){this.skin;var e,t=game.baoZangData,a=game.baoZangData.getInstanceDatas(t.curGroup),i=0;if(a&&0<a.length)for(var n=0;n<a.length;++n){if(e=game.baoZangData.getXiandiData(a[n].id)){i+=e.star}}var s=i>=game.baoZangData.curStar,o=game.baoZangData.getBoxPrizeInfo(),r=!1;if(o){r=game.baoZangData.isGetAward(o.id);var g=game.CfgUtil.getPrizeListInfo(o.award);if(g){this.list.setData(g.items)}}this.skin.sureBtn.node.active=s&&!r;var l=game.CCommonUtil.replaceChineseNum(game.baoZangData.curGroup);this.skin.prizetips.string=game.Lang.get(1203,l,game.baoZangData.curStar)},onHide:function(){b8e.Tween.kill(this.skin.light)},closeBtn:function(){game.module.hide(this.moduleEnum)},onStageResize:function(){this.setPosition(b8e.stageWidth/2,b8e.stageHeight/2+106)}});b8e.module.registerView(game.ME.BaoZangPrize,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(85),this.spotAlerts={},this.setSize(540,94)},setData:function(){this.onClear();var e=this.data;if(e){var t=this.skin;t.rank.node.active=3<e.rank,t.rank.string=e.rank+"",t.name.string=e.name,t.power.string=e.power+"",t.instancenum.string=e.score+"";var a=e.rank;if(3<a){this.skin.rank4.node.active=!0}else this.getComponent("rank"+a).node.active=!0}else;},onClear:function(){this.skin;for(var e=1;e<5;e++){this.getComponent("rank"+e).node.active=!1}}}),b8e.RC("$$game","$$BaoZangRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(86)},init:function(){var e=this;e.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.rankList.itemRender=game.BaoZangRankItem,e.rankList.bindEnum=game.ME.BaoZangRank,e.rankList.addToParent(e.skin.listNode),e.rankList.layout.paddingLeft=0,e.rankList.layout.paddingRight=0,e.rankList.layout.paddingTop=0,e.rankList.layout.paddingBottom=0,e.rankList.layout.spacingX=0,e.rankList.layout.spacingY=5},onShow:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.InsXianDi);this.rankList.setData(e);var t=game.rankData.getSelfRankInfo(game.RankType.InsXianDi);if(t){this.skin.rankNum.string=0==t.rank?game.Lang.get(9069):t.rank,this.skin.instanceNum.string=t.score}},onHide:function(){this.send(this.Evts.CLOSE_RANKVIEW)}});b8e.module.registerView(game.ME.BaoZangRank,e)}(),function(){var e=game.View.extends({boxNum:6,boxItemList:null,barWidth:420,maxStar:18,maxProgressNum:12,needVip:0,_barwidthList:null,ctor:function(){this._super(87),this.boxItemList=[],this.spotAlerts={BAO_ZANGFIGHT:this.updataFight},this._barwidthList=[0,12,24,36,48,60,72,98,124,150,176,202,228,253,278,303,328,353,380]},notify:function(e){switch(e){case this.Evts.UPDATE_XIANDIVIEW:this.updateView();break;case this.Evts.V_AUTO_FIGHT_CHANGE:this.autoFightChange();break;case this.Evts.SHOW_NOTICE_NEEDVIP:this.showNoticeVip()}},init:function(){for(var e,t=this,a=t.skin,i=0;i<t.boxNum;++i){(e=new game.BaoZangItem).bindEnum=game.ME.BaoZang,e.index=i,e.addToParent(this.getComponent("baoxiang_"+i)),this.boxItemList.push(e)}t.firstList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),t.firstList.itemRender=game.PrizeListItem,t.firstList.layout.paddingLeft=0,t.firstList.layout.paddingRight=0,t.firstList.layout.paddingTop=0,t.firstList.layout.spacingX=0,t.firstList.addToParent(a.firstPrizeList),t.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),t.prizeList.itemRender=game.PrizeListItem,t.prizeList.layout.paddingLeft=0,t.prizeList.layout.paddingRight=0,t.prizeList.layout.paddingTop=0,t.prizeList.layout.spacingX=0,t.prizeList.addToParent(a.prizeList),t.send(t.Evts.INIT_SETSHOWINDEX);var n=game.baoZangData,s=n.getInstanceDatas(n.curGroup);game.baoZangData.curDifficulty=s[0].diffcultType,game.baoZangData.maxDifficulty=s[0].diffcultType,t.insAutoTime=game.CfgUtil.getInsAutoTimeSpace(),t.insAutoTimeDesc=game.CfgUtil.getInsAutoTime()},onShow:function(){this.autoFightChange(),this.send(this.Evts.SETSHOWINDEX),this.skin.shopBtn.active=game.shopData.getOpenByShopId(game.ShopIdEnum.BAOZANG_SHOP)},onHide:function(){var e=this;if(e.autoFightTimer){e.autoFightTimer.stop()}e.skin.tips_1.string=game.Lang.get(9070)},autoFightChange:function(){var e=this,t=game.baoZangData.autoFight;if(e.skin.autoBg_2.node.active=t){if(e.autoFightEndTime=game.SysTime.curTime+this.insAutoTime,!e.autoFightTimer){e.autoFightTimer=b8e.Timer.add(e,e.updateFightTime,500)}e.autoFightTimer.reset(),e.autoFightTimer.start(),e.skin.tips_1.string=game.Lang.get(9607,this.insAutoTimeDesc)}else{if(e.autoFightTimer){e.autoFightTimer.stop()}e.skin.tips_1.string=game.Lang.get(9070)}},updateFightTime:function(){var e=this,t=e.autoFightEndTime-game.SysTime.curTime;if(0<t){e.skin.tips_1.string=game.Lang.get(9607,t/1e3>>0)}else e.autoFightTimer.stop(),e.skin.tips_1.string=game.Lang.get(9071),e.send(e.Evts.V_START_FIGHT)},updateView:function(){var e=this,t=e.skin,a=game.baoZangData,i=a.curShowIndex;t.clickBg.node.setPosition(e.getComponent("baoxiang_"+i).getPosition());var n,s=a.getInstanceDatas(a.curGroup),o=game.baoZangData.curDifficulty,r=(game.baoZangData.maxDifficulty,0);if(s&&0<s.length)for(var g=0;g<s.length&&g<this.boxNum;++g){if(this.boxItemList[g].setData(s[g]),n=a.getXiandiData(s[g].id)){r+=n.star}}var l=a.getCurInstanceData(i);if(l){t.gaunqiaTips.string=l.name;var c=game.CfgUtil.getPrizeListInfo(l.showItems,null,game.IconSizeEnum.GRID_SIZE_84);if(c){this.firstList.setData(c.items)}var h=game.CfgUtil.getPrizeListInfo(l.award,null,game.IconSizeEnum.GRID_SIZE_84);if(h){this.prizeList.setData(h.items)}var m=a.getXiandiData(l.id);if(m)t.firstgeted.node.active=m.firstAward;else{t.firstgeted.node.active=!1}}t.allstarNum.string=r+"/"+e.maxStar,t.bar_0.node.width=r<=18?e._barwidthList[r]:0;for(var u,d=game.mainRoleData.vipLevel,f=0;f<game.VipCfg.maxVipLv;f++){if((u=game.VipCfg.getData(f))&&u.xiandiSweep){this.needVip=f,t.viptips.string=game.Lang.get(9609,f);break}}var p=game.VipCfg.getData(d);if(p&&p.xiandiSweep){t.viptips.node.active=!1}var _=s[0].desc;t.mapName.string=game.Lang.get(9610,a.curGroup,_);for(var v,E=!1,C=(g=0,1);C<=3;++g,++C){if(v=a.getBoxCfgInfo(a.curGroup,6*C)){E=a.isGetAward(v.id)}this.getComponent("geted_"+g).node.active=E,this.getComponent("redPoint_"+g).node.active=6*C<=r&&!E}var T=game.XiandiCfg.getShowAward();if(T){var A,I;e.matCostIcon||(e.matCostIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_84),e.matCostIcon.setPosition(0,0),e.matCostIcon.addToParent(t.award_node.node));for(f=0;f<T.length;f++)if(I=T[f],game.baoZangData.maxId<I.id){A=game.ItemInfoCfg.getData(I.showAward),t.lbl_award.node.string=game.Lang.get(9483,I.name);break}if(t.award.active=A){e.matCostIcon.setItemInfo(A,!1,!1);var S=game.HtmlUtil.getColorByQuality(A.quality,!1);e.matCostIcon.setName(A.name,S)}}t.rightBtn.node.active=a.curGroup<a.maxGroup;var R=game.baoZangData.getInstanceDatas(a.curGroup+1);if(R){if(R[0].diffcultType!=o){t.rightBtn.node.active=!1}}t.leftBtn.node.active=a.curGroup>a.minGroup;var y=game.baoZangData.getInstanceDatas(a.curGroup-1);if(y){if(y[0].diffcultType!=o){t.leftBtn.node.active=!1}}for(f=1;f<a.curGroup;f++){var D,b,L,w=!1,k=!1,M=0;if(b=a.getInstanceDatas(f)){if(b&&0<b.length)for(g=0;g<b.length&&g<this.boxNum;++g){if(L=a.getXiandiData(b[g].id)){M+=L.star}}for(C=1;C<=3;++C){if(D=a.getBoxCfgInfo(f,6*C)){w=a.isGetAward(D.id)}if(k=6*C<=M&&!w){break}}if(t.redPoint_left.node.active=k){break}}}for(f=a.curGroup+1;f<a.maxGroup+1;f++){var P,B,N,O=!1,G=!1,$=0;if(B=a.getInstanceDatas(f)){if(B&&0<B.length)for(g=0;g<B.length&&g<this.boxNum;++g){if(N=a.getXiandiData(B[g].id)){$+=N.star}}for(C=1;C<=3;++C){if(P=a.getBoxCfgInfo(f,6*C)){O=a.isGetAward(P.id)}if(G=6*C<=$&&!O){break}}if(t.redPoint_right.node.active=G){break}}}e.showDifficultyBtn(),e.updataPass()},showNoticeVip:function(){game.notice.show(51814)},onStageResize:function(){this.setPosition(0,0)},updataPass:function(){this.skin.redPass.active=game.baoZangData.dailyPass},updataFight:function(e){this.skin.redFight.active=e.alert},viewLevelBtn:function(){game.difficultSelectData.curInstType=game.DifficultSelectType.BAOZANG,game.module.show(game.ME.DifficultSelect)},showDifficultyBtn:function(){var e=game.baoZangData.curDifficulty,t=game.ResCfg.getUrl(5033,e);this.skin.viewLevelBtn.loadTexture(t)}});b8e.module.registerView(game.ME.BaoZang,e)}(),function(){var e=game.View.extends({_progress:1,maxRound:0,percent:1,_specialLayer:!0,ctor:function(){this._super(979),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case game.StarPlaybackEvts.UPDATE_ROUND:var a=this.caculatePercent(t.round);this.setProgress(a),this.updateSkinBtn(t.round)}},caculatePercent:function(e){var t=0;return e<=4?t=.05*e:4<e&&e<9?(t+=.1*(e-4),t+=.2):9<=e&&(t+=.2*(e-8),t+=.2,t+=.4),1<(t=1-t)&&(b8e.error("\u767e\u5206\u6bd4\u8ba1\u7b97\u51fa\u9519percent: ",t),t=1),t},onShow:function(){for(var e=this.skin,t=game.XiandiStarCfg.getDatas().length,a=0;a<t;a++){var i=game.XiandiStarCfg.getDatas()[a].round;if(!i)return void this.hide();this.getComponent("lb_starNum"+a).string=i,this.maxRound<i&&(this.maxRound=i)}var n=game.baoZangData.fightData.id,s=game.XiandiCfg.getData(n);s&&(e.lb_title2.string=s.name);var o=game.InstanceSuccessCfg.getData(7);o&&(e.lb_awards.string=game.Lang.get(9547,o.award)),e.btn_skip.active=!1,this.percent=this._progress,this.setProgress(this._progress)},setProgress:function(e){var t=this;t.skin&&(t.skin.bar.node.scaleX=e)},onHide:function(){this._btnSkip=!1,this.skin.btn_skip.active=!1},onStageResize:function(){this.setPosition(b8e.stageWidth-140,b8e.stageHeight-55)},updateSkinBtn:function(){}});b8e.module.registerView(game.ME.StarPlayback,e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={PlayBackRound:{C2C_ROUND_CHANGE:this.updateRound}}},updateRound:function(e){var t=e.data;this.send(game.StarPlaybackEvts.UPDATE_ROUND,t)},btn_skip:function(){game.playBack.stop()}});b8e.module.registerControl(game.ME.StarPlayback,e)}(),function(){var e;e=b8e.Enum({None:0,UPDATE_ROUND:-1}),b8e.RC("$$game","$$StarPlaybackEvts",e)}(),function(){var e;e=b8e.Enum({SWITCH_PAGE:-1,UPDATE_DATA:-1,PERBOSS_CHALL:-1,PERBOSS_QUICK_SWEEP:-1,PERBOSS_ONE_SWEEP:-1,C2C_UPDATE_FINISH_COUNT:-1,C2C_ADD_FINISH_COUNT:-1}),b8e.RC("$$game","$$BossEvts",e)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.BOSS,game.SAE.HOME)},notify:function(){},Btn1:function(){this.selectToggle(0)},Btn2:function(){this.selectToggle(1)},Btn3:function(){this.selectToggle(2)},Btn4:function(){this.selectToggle(3)},Btn5:function(){this.selectToggle(4)},Btn6:function(){this.selectToggle(5)},Btn7:function(){this.selectToggle(6)},Btn8:function(){this.selectToggle(7)},Btn9:function(){this.selectToggle(8)},selectToggle:function(e){this.send(this.Evts.SWITCH_PAGE,e)}});b8e.module.registerControl(game.ME.Boss,e,game.BossEvts)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){},ipc:function(){this.gevts={},this.evts={Instance:{SYNC_INSTANCE_DATA:this.syncPerBossDataResp},MainRole:{C_LEVEL_UP:this.lvUpdate}},this.handels={PersonalChallengeResp:this.challengeResp,PersonalSweepResp:this.quickSweepResp}},checkAlert:function(){},syncPerBossDataResp:function(e){var t=e.data,a=t.personal;if(a)game.bossData.setPerBossData(a),game.bossData.setCount(t.personCount),this.checkAlert(),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT);else;},challengeResp:function(e){var t=e.readProtobuf(game.pb.PersonalChallengeResponse);if(0<t.code);else{var a=t.battlelog;if(a){var i={type:game.InstanceType.PERSONAL_BOSS,rewards:t.useritem,exp:t.exp};if(game.playBack.play(a,i),a.win){game.bossData.addCount(),game.bossData.updateChallCount(t.id,t.challengeNum),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT),this.dpt(this.Evts.C2C_ADD_FINISH_COUNT,1)}game.GameViewMgr.inst().hideUnStrongViews()}else{this.showItem(t)}this.checkAlert(),this.send(game.BossEvts.UPDATE_DATA)}},quickSweepResp:function(e){var t=e.readProtobuf(game.pb.PersonalSweepResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.bossData.updateQuickSweepCount(t.ids),t.ids&&0<t.ids.length&&(game.bossData.addCount(t.ids.length),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT),this.dpt(this.Evts.C2C_ADD_FINISH_COUNT,t.ids.length)),this.showItem(t),this.send(game.BossEvts.UPDATE_DATA),this.checkAlert()},showItem:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i={type:game.InstanceType.PERSONAL_BOSS,rewards:e.useritem,exp:e.exp,win:a};b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,i)},lvUpdate:function(){var e=game.mainRoleData.lv;game.bossData.updateAllCanSweep(),game.bossData.lvUp(e),game.bossData.updateCanQuickSweep(),this.send(game.BossEvts.UPDATE_DATA),this.checkAlert()},notify:function(e,t){switch(e){case game.BossEvts.PERBOSS_CHALL:if(!t)break;this.challenge(t.id);break;case game.BossEvts.PERBOSS_QUICK_SWEEP:this.quickSweep();break;case game.BossEvts.PERBOSS_ONE_SWEEP:this.oneSweep(t.id)}},challenge:function(e){game.UpgradeUtil.checkEquipTooMuch()||this.sender.PersonalChallengeReq(e)},quickSweep:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){var e=game.bossData.getQuickSweepIdArr();this.sender.PersonalSweepReq(e)}},oneSweep:function(e){game.UpgradeUtil.checkEquipTooMuch()||this.sender.PersonalSweepReq([e])},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.EQUIP_SHOP)}}),t=game.Sender.extends({ipc:function(){this.msg={PersonalChallengeReq:this.personalChallengeReq,PersonalSweepReq:this.personalSweepReq}},personalChallengeReq:function(e){var t=game.pb.PersonalChallengeRequest;t.id=e,this.write(t)},personalSweepReq:function(e){var t=game.pb.PersonalSweepRequest;t.ids=e,this.write(t)}});b8e.module.registerControl(game.ME.PersonalBoss,e,game.BossEvts,t)}(),function(){var e=b8e.Object.extends({perBossInfoMap:null,perBossAllCanSweep:!1,victoryCount:0,openToggle:1,ctor:function(){this._super(),this.perBossInfoMap=b8e.HashMap.get()},createPerBossInfos:function(){if(this.perBossInfoMap){this.perBossInfoMap.clear()}var e=game.PersonalBossCfg.getDatas();if(e)for(var t=0,a=e.length;t<a;t++){var i=e[t];if(i){var n=this.perBossInfoMap.get(i.id);if(!n){n=new game.PerBossItemInfo,this.perBossInfoMap.set(i.id,n)}n.id=i.id,n.useChallCount=0,n.canQuickSweep=this.perBossAllCanSweep,n.killed=!1,n.bossLv=i.openLv}else;}else;},setPerBossData:function(e){if(e){this.updateAllCanSweep(),this.createPerBossInfos();for(var t=0,a=e.length;t<a;t++){var i=e[t];if(i)this.updatePerBossInfo(i);else;}}else;},getPerBossSortedArr:function(){var e=this.perBossInfoMap.values();if(!e||e.lenght<=0){return[]}return e.sort(this.perBossSortFunc),e},perBossSortFunc:function(e,t){var a=0;if(e.id<t.id){a=-1}else if(e.id>t.id){a=1}else a=0;if(!e.killed&&t.killed){return-1}if(!e.killed||t.killed)return a;return 1},getPerBossInfoArrByLv:function(){var e=this.getPerBossSortedArr();if(e){var t=game.mainRoleData;if(t){for(var a=t.lv,i=[],n=0,s=null,o=0,r=e.length;o<r;o++){var g=e[o];if(g){var l=g.id,c=game.PersonalBossCfg.getData(l);if(c){if(a>=c.openLv){i.push(g)}else if(n<1){s=g,n++}}else;}else;}return s&&i.push(s),i.sort(this.onSort),i}b8e.error("mainRoleData is null ?")}else;},onSort:function(e,t){var a=game.mainRoleData.lv;return a>=e.bossLv&&a>=t.bossLv?e.killed==t.killed?t.bossLv-e.bossLv:e.killed?1:-1:a<e.bossLv&&a<t.bossLv?e.bossLv-t.bossLv:a>e.bossLv?-1:a>t.bossLv?1:0},getQuickSweepIdArr:function(){var i=[],n=game.mainRoleData.lv;return this.perBossInfoMap.forEach(function(e,t){var a=game.PersonalBossCfg.getData(e);if(a){if(a.sweepLv<=n){if(0<a.Challengetime-t.useChallCount&&t.firstChall){i.push(t.id)}}}},this),i},lvUp:function(a){this.perBossInfoMap.forEach(function(e,t){t.lv=a},this)},updateChallCount:function(e,t){var a=this.perBossInfoMap.get(e);if(a){var i=game.PersonalBossCfg.getData(e).Challengetime;a.useChallCount=t,a.firstChall||(a.firstChall=!0),a.useChallCount>=i&&(a.killed=!0),a.canQuickSweep=a.useChallCount==i}},updateQuickSweepCount:function(e){for(var t=0,a=e.length;t<a;t++){var i=e[t],n=this.perBossInfoMap.get(i);n||(n=new game.PerBossItemInfo,this.perBossInfoMap.set(i,n));var s=game.PersonalBossCfg.getData(i);n.useChallCount++,n.canQuickSweep=!1,n.killed=n.useChallCount==s.Challengetime,n.bossLv=s.openLv}},updatePerBossInfo:function(e){var t=this.perBossInfoMap.get(e.id);if(!t){t=new game.PerBossItemInfo,this.perBossInfoMap.set(e.id,t)}t.setData(e),t.lv=game.mainRoleData.lv;var a=game.PersonalBossCfg.getData(t.id),i=a.Challengetime-t.useChallCount;if(t.bossLv=a.openLv,0<i){t.canQuickSweep=this.perBossAllCanSweep&&0==t.useChallCount}else t.killed=!0,t.canQuickSweep=!1},updateAllCanSweep:function(){var e=game.mainRoleData.lv;this.perBossAllCanSweep=e>=game.PersonalBossCfg.maxSweepLv},updateCanQuickSweep:function(){this.perBossInfoMap.forEach(function(e,t){t.canQuickSweep=this.perBossAllCanSweep},this)},hasPerBossChall:function(){for(var e=this.getPerBossInfoArrByLv(),t=game.mainRoleData.lv,a=0,i=e.length;a<i;a++){var n=e[a];if(n){var s=game.PersonalBossCfg.getData(n.id);if(s&&!(s.openLv>t)&&0==n.useChallCount)return!0}}return!1},setCount:function(e){this.victoryCount=e},getCount:function(){return this.victoryCount},addCount:function(e){var t=0<arguments.length&&void 0!==e?e:1;this.victoryCount+=t}});game.bossData=game.bossData||new e}(),function(){var e,t=e=b8e.Object.extends({id:0,useChallCount:0,lv:0,canQuickSweep:!1,killed:!1,firstChall:!1,bossLv:0,ctor:function(){this._super()},setData:function(e){if(e)this.useChallCount=e.challenge,this.firstChall=e.flag;else;}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$PerBossItemInfo",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(115),this.toggles={tab1_select:game.ME.Barbarian,tab2_select:game.ME.ZhaoQin,tab3_select:game.ME.WorldWar},this.spotAlerts={ZHAOQIN_TAG:this.marryAlert,BOSS_WORLDWAR:this.worldWarBossAlert,BARBARIAN:this.barbarianAlert}},init:function(){this.titleLab=this.skin.title_lab},marryAlert:function(e){this.skin.red_spot2.node.active=e.alert},worldWarBossAlert:function(e){this.skin.red_spot3.node.active=e.alert},barbarianAlert:function(e){this.skin.red_spot1.node.active=e.alert},notify:function(e,t){switch(e){case game.BossEvts.SWITCH_PAGE:this.toggleSelect(t)}},onShow:function(){this.toggleSelect(0)}});b8e.module.registerView(game.ME.Boss,e)}(),function(){var e;e=game.ListItem.extends({itemIcons:null,bossModel:null,ctor:function(){this._super(116),this.setSize(600,260)},init:function(){this.skin.item_bg.loadTexture(game.ResCfg.getUrl(10070))},canEnter_btn:function(){var e=this.data;if(this.data){var t=game.PersonalBossCfg.getData(e.id),a={};a.id=this.data.id;var i=(t=game.PersonalBossCfg.getData(e.id)).Challengetime-e.useChallCount,n=game.mainRoleData.lv>=t.sweepLv;if(e.firstChall&&n)e.canQuickSweep?this.send(game.BossEvts.PERBOSS_QUICK_SWEEP):0<i&&this.send(game.BossEvts.PERBOSS_ONE_SWEEP,a);else{if(game.playBack.isInstanceFighting(!0))return;if(game.sceneData.isGuildMap())return;this.send(game.BossEvts.PERBOSS_CHALL,a)}}},setData:function(){var e=this.data;if(e){this.itemIcons||(this.itemIcons=[]);var t=this.skin,a=game.PersonalBossCfg.getData(e.id);this.setBossModel(a.monGroup);var i=a.Challengetime-e.useChallCount,n=game.mainRoleData.lv;if(t.boss_name_lab.string=game.Lang.get(9488,a.name,a.openLv),t.canEnter_btn.node.active=n>=a.openLv,t.openBg.active=!1,t.drop_lab.node.active=!0,t.count_root.active=!0,t.count_lab.string=game.Lang.get(9489,i),t.btn_gray.active=0==i,t.redPoint.active=0==e.useChallCount,n<a.openLv)t.enter_lab.string="",t.count_root.active=!1,t.openCondi_lab.string=game.Lang.get(9490,a.openLv),t.openBg.active=!0,t.canEnter_btn.node.active=!1;else{if(e.firstChall){var s=game.mainRoleData.lv>=a.sweepLv;t.enter_lab.string=s?game.Lang.get(9193):game.Lang.get(9190)}else t.enter_lab.string=game.Lang.get(9190);var o=game.InstanceMiscCfg.getData("personalCostGold");if(o){var r=+o.value,g=e.useChallCount*r;t.free.string=0<g?game.Lang.get(51908,g):game.Lang.get(51907)}t.free.active=0<i,0==i&&(t.enter_lab.string=game.Lang.get(9190))}var l=a.showItems;if(l&&0<l.length)for(var c=0,h=l.length;c<h;c++){var m=l[c];this.createIcon(m,c+1,0)}}},setBossModel:function(e){var n=this;n.bossModel||(n.bossModel=b8e.SceneEntity.get(),n.bossModel.addToParent(n.skin.model_root)),game.CfgUtil.getMonsterCfgByMonGroup(e,1,function(e){var t=game.AvatarUtil.getUIModel(e,0,!1),a=game.ResCfg.getUrl(5e3,t),i=n.bossModel.getAnimator(game.AnimType.BOSS,1);(i=i||n.bossModel.addAnimator(game.AnimType.BOSS,1))&&(i.load(a),i.play()),n.setElementBtn(e)},n)},onHide:function(){},createIcon:function(e,t,a){var i=game.ItemInfoCfg.getData(e),n=this.itemIcons[t-1];if(!n){n=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_84),this.itemIcons.push(n)}n.addToParent(this.skin.prizeList),n.setItemInfo(i),n.setNum(a),n.x=45+89*(t-1),n.y=-42},setElementBtn:function(e){var t=this.skin;e&&e.element?(this.elementAttr=e.element,t.view_elementBtn.active=!0,t.view_elementBtn.loadTexture(game.ResCfg.getUrl(10050,e.element))):t.view_elementBtn.active=!1},view_elementBtn:function(){this.elementAttr&&(game.elementData.setElementInfo(this.elementAttr,50369,this.skin.view_elementBtn.localToGlobal(),!1),game.module.show(game.ME.ElementAttr))}}),b8e.RC("$$game","$$PerBossItemView",e)}(),function(){var e=game.View.extends({bossList:null,ctor:function(){this._super(117),this.spotAlerts={SHOP_PERSONAL:this.shopAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},$$getInstEnterBtn:function(e){if(!(this.bossList&&this.bossList._container&&this.bossList._container._layoutContent&&this.bossList._container._layoutContent[e]))return null;var t=this.bossList._container._layoutContent[e].skin;return t?t.canEnter_btn:null},init:function(){this.bossList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.bossList.itemRender=game.PerBossItemView,this.bossList.bindEnum=game.ME.PersonalBoss,this.bossList.addToParent(this.skin.scrollView),this.bossList.layout.spacingY=5},notify:function(e){switch(e){case game.BossEvts.UPDATE_DATA:this.updateData()}},onStageResize:function(){this.setPosition(0,0)},onShow:function(){this.updateData()},updateData:function(){var e=game.bossData.getPerBossInfoArrByLv();this.bossList.setData(e)}});b8e.module.registerView(game.ME.PersonalBoss,e)}(),function(){var e;e=b8e.Enum({None:0,C2C_UPDATE_GUILD_BOSS_INFO:-1}),b8e.RC("$$game","$$GuildBossEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.GUILD_BOSS,game.SAE.NORMAL_ACTIVITY_ALERT)},triggerOpen:function(e){e==this.moduleEnum&&this.senderGuildBossReq()},ipc:function(){this.evts={ActivitiesHall:{C2S_GUILD_BOSS_REQ:this.guildBossReq,C2S_JOIN_GUILD_BOSS:this.guildBossChallengeReq,C2S_GET_GUILD_BOSS_AWARD:this.guildBossAwardReq},Guild:{C_UPDATE_GUILD:this._firstEnterScene}},this.handels={GuildBossResp:this.guildBossResp,GuildBossAwardResp:this.guildBossAwardResp,GuildBossChallengeResp:this.guildBossChallengeResp}},_firstEnterScene:function(){var e=game.guildData;if(!e||e.hasGuild()){var t=e.getGuildLevel();game.guildBossData.getMinLv()<=t&&(this._isReqSender?game.guildBossData.isUnderWay()&&this.senderGuildBossReq():(this._isReqSender=!0,this.senderGuildBossReq()))}},checkAlert:function(){this.spotAlert.alert=game.guildBossData.isShowAlert()},guildBossReq:function(e){if(e)this.senderGuildBossReq();else;},senderGuildBossReq:function(){var e=this,t=game.SysTime.curTime;if(e._lastSenderTime&&t<=e._lastSenderTime);else e._lastSenderTime=t+10*b8e.TimeUtil.SECOND_MICRO_SECONDS,this.sender.GuildBossReq()},guildBossChallengeReq:function(e){if(e)this.sender.GuildBossChallengeReq();else;},guildBossAwardReq:function(e){if(e)this.sender.GuildBossAwardReq();else;},guildBossResp:function(e){var t=e.readProtobuf(game.pb.GuildBossResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.guildBossData.setData(t),this.checkAlert(),this.dpt(this.Evts.C2C_UPDATE_GUILD_BOSS_INFO)},guildBossAwardResp:function(e){var t=e.readProtobuf(game.pb.GuildBossAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.guildBossData.isAward=!0,this.checkAlert(),this.dpt(this.Evts.C2C_UPDATE_GUILD_BOSS_INFO)},guildBossChallengeResp:function(e){var t=e.readProtobuf(game.pb.GuildBossChallengeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.GameViewMgr.inst().hideUnStrongViews();var a={type:game.InstanceType.GUILD_BOSS};game.playBack.play(t.battlelog,a),game.guildBossData.setGuildBossHp(t),this.checkAlert(),this.dpt(this.Evts.C2C_UPDATE_GUILD_BOSS_INFO)}}}),t=game.Sender.extends({ipc:function(){this.msg={GuildBossReq:null,GuildBossChallengeReq:null,GuildBossAwardReq:null}}});b8e.module.registerControl(game.ME.GuildBoss,e,game.GuildBossEvts,t)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super();var e=this;e.bossHp=0,e.maxHp=0,e.joinMinLv=0,e.guildLv=0,e.isAward=!0,e._isEnd=!1,e._guildBossTime="",e._lastTime=0,e._openTime=0,e._endTime=0},setData:function(e){var t=this;if(e)t.guildLv=e.guildLv,t.isAward=e.isAward,t.setGuildBossHp(e);else;},setGuildBossHp:function(e){var t=this;t.bossHp=e.bossHp,t.maxHp=e.maxHp},IsJoinGuildBoss:function(){var e=game.guildData;if(e&&!e.hasGuild()){return game.notice.show(2601),!1}var t=this;if(e.getGuildLevel()<t.getMinLv()){return game.notice.show(2602),!1}if(t.bossHp<=0){return game.notice.show(2603),!1}return!0},getMinLv:function(){var e=this;if(0!=e.joinMinLv){return e.joinMinLv}var t=game.GuildBossCfg.getDatas();if(!t||t.length<1){return 0}if(t[0]){e.joinMinLv=t[0].guildLv}return e.joinMinLv},getGuildBossTime:function(){var e=this,t=game.SysTime.curTime;if(""!=e._guildBossTime&&t<e._lastTime||e._isEnd){return e._guildBossTime}var a=e.getGuildBossTimeList();if(!a||a.length<1){return""}for(var i,n,s,o,r,g,l=b8e.TimeUtil.getTodayTime(t),c=0,h=a.length;c<h;c++){if(""!=(o=a[c])){if(0==c){i=o}if(!(n=o.split("-"))||n.length<1);else if(r=n[n.length-1]){if((s=r.split(":"))&&1<s.length){if(t<=(g=l+s[0]*b8e.TimeUtil.HOUR_MICRO_SECONDS+s[1]*b8e.TimeUtil.MINUTE_MICRO_SECONDS)){return e._lastTime=g,e._guildBossTime=o,e._guildBossTime}if(c==h-1){return e._isEnd=!0,e._guildBossTime=i,e._guildBossTime}}}else;}else;}return""},isUnderWay:function(){var e=this,t=game.SysTime.curTime;if(t>=e._openTime&&t<e._endTime){return!0}var a=e.getGuildBossTimeList();if(!a||a.length<1){return!1}for(var i,n,s,o,r,g,l=b8e.TimeUtil.getTodayTime(t),c=0,h=a.length;c<h;c++){if(""!=(o=a[c])){if(!(i=o.split("-"))||i.length<1);else if(r=i[0],g=i[1],n=r.split(":"),s=g.split(":"),!n||n.length<1||!s||s.length<1);else if(e._openTime=l+n[0]*b8e.TimeUtil.HOUR_MICRO_SECONDS+n[1]*b8e.TimeUtil.MINUTE_MICRO_SECONDS,e._endTime=l+s[0]*b8e.TimeUtil.HOUR_MICRO_SECONDS+s[1]*b8e.TimeUtil.MINUTE_MICRO_SECONDS,t>e._endTime);else if(t>=e._openTime&&t<e._endTime){return!0}}else;}if(t>=e._openTime&&t<e._endTime){return!0}return!1},getGuildBossTimeList:function(){var e=this;if(e._guildBossTimeArr&&0<e._guildBossTimeArr.length){return e._guildBossTimeArr}var t=game.GuildMiscCfg.getData("guildBossTime");if(!t){return null}if(!e._guildBossTimeArr||e._guildBossTimeArr.length<1){if(t.value){e._guildBossTimeArr=t.value.split("|")}}return e._guildBossTimeArr},isShowAlert:function(){var e=this;if(e.guildLv<1){return!1}if(e.isUnderWay()){if(0<e.bossHp){return!0}if(e.bossHp<=0&&!e.isAward){return!0}}return!1}});game.guildBossData=game.guildBossData||new e}(),function(){var e;e=b8e.Enum({None:0,V_SHOW_VIEW:b8e.enc(),V_HIDE_VIEW:b8e.enc(),V_SET_TEAM:b8e.enc(),V_TEAM_JOIN:b8e.enc(),V_TEAM_LEAVE:b8e.enc(),V_TEAM_CREATE:b8e.enc(),V_SELECT_BOSS:b8e.enc(),V_REFRESH_BOSS_LIST:b8e.enc(),V_UPDATE_TIME:b8e.enc(),C_UPDATE_TIME:b8e.enc(),V_UPDATE_AUTO:b8e.enc(),V_KICK_MEMBER:b8e.enc(),V_UPDATE_DATA:b8e.enc(),V_SCROLL_TO_TOP:b8e.enc(),C_SHOW_VIEW:b8e.enc(),C_HIDE_VIEW:b8e.enc(),C_TEAM_RATE:b8e.enc(),C_SET_TEAM:b8e.enc(),C_TEAM_JOIN:b8e.enc(),C_TEAM_QUICK_JOIN:b8e.enc(),C_TEAM_LEAVE:b8e.enc(),C_TEAM_CREATE:b8e.enc(),C_KICK_MEMBER:b8e.enc(),C_TEAM_JOIN_NOTIFY:b8e.enc(),C_TEAM_LEAVE_NOTIFY:b8e.enc(),C_TEAM_START_NOTIFY:b8e.enc(),C_ENTER_BATTLE:b8e.enc(),C_BATTLE_END:b8e.enc(),C_REFRESH_BOSS_LIST:b8e.enc(),C_UPDATE_AUTO:b8e.enc(),C_REQ_TEAM_DATA:b8e.enc(),C_CHECK_ALERT:b8e.enc(),C_PARTNER_TEAM_EMBATTLE_REQ:b8e.enc(),G_SELECT_BOSS:b8e.enc(),C2C_CHANGE_TEAM_STATE:b8e.enc(),C2C_CHALLENGE_COUNT:b8e.enc(),C2C_UPDATE_FINISH_COUNT:b8e.enc(),C2C_CSTEAM_NOTIFY:b8e.enc(),C2C_BUY_ALL_BOX:b8e.enc(),C2C_TEAMLEAGUE_ASSIST:b8e.enc(),C2C_TEAM_EMBATTLE:b8e.enc(),C2C_TEAM_PARTNER_TEAM_EMBATTLE:b8e.enc(),C2C_TEAM_INVITE_COOL_TIME:b8e.enc(),C2C_TEAM_PARTNER_UPDATE_POS_REQ:b8e.enc(),C2V_TEAM_EMBATTLE:b8e.enc(),C2V_TEAM_PARTNER_TEAM_EMBATTLE_CHANGE:b8e.enc(),C2V_TEAM_PARTNER_TEAM_EMBATTLE:b8e.enc(),C2V_UPDATE_WORLDWAR2_TITLE:b8e.enc(),C2V_TEAM_INVITE_COOL_TIME:b8e.enc(),V2C_TEAM_OPEN_SELECT_PARTNER_PANEL:b8e.enc(),V2C_TEAM_CHANGE_BATTLE_PARTNER_REQ:b8e.enc(),V2C_TEAM_INVITE:b8e.enc(),V2C_TEAM_PARTNER_UPDATE_POS_REQ:b8e.enc(),V2C_TEAM_CHECK_TIME:b8e.enc(),C_CHANGE_NEWS_STATE:b8e.enc(),C2V_CHANGE_NEWS_STATE:b8e.enc()}),b8e.RC("$$game","$$TeamEvts",e)}(),function(){var e;e=game.Control.extends({timer:null,memberIds:null,autoReqTime:0,curTeamInstType:0,invInstId:0,teamDataReq:function(e){this.dptG(this.Evts.C_REQ_TEAM_DATA,{instId:e})},teamDataResp:function(e,t){e!=this.curTeamInstType&&0!=e||(this.teamData.setTeamData(t),this.send(this.Evts.V_SET_TEAM))},teamJoinNotify:function(e,t){e==this.curTeamInstType&&(this.teamData.teamJoin(t),this.teamData.isMineLeader&&this.teamData.isFull&&this.setAutoFullStartTime(),this.send(this.Evts.V_TEAM_JOIN))},teamLeaveNotify:function(e,t){var a=this;e==a.curTeamInstType&&(a.teamData.teamLeave(t),a.teamData.isInTeam?a.teamData.isMineLeader&&(a.teamData.isFull&&a.setAutoFullStartTime(),a.setAutoStartTime()):(a.teamData.resetInsId(),a.autoReqTime=0,a.teamDataReq(a.teamData.curInsId),a.stopAutoTime(),a.setAutoJoinTime()),a.send(a.Evts.V_TEAM_LEAVE))},teamCreateResp:function(e,t){e==this.curTeamInstType&&this.createTeam(t.team)},teamJoinResp:function(e,t){e==this.curTeamInstType&&(this.showTeamInstView(),this.createTeam(t.team))},showTeamInstView:function(){},teamQuickJoinResp:function(e,t){e==this.curTeamInstType&&this.createTeam(t.team)},createTeam:function(e){var t=this;t.teamData.setTeam(e),t.stopAutoTime(),t.teamData.isMineLeader&&(t.teamData.isFull&&t.setAutoFullStartTime(),t.setAutoStartTime()),t.send(t.Evts.V_TEAM_CREATE),t.dpt(t.Evts.C2C_CHANGE_TEAM_STATE)},_setTeamData:function(e){var t=e.data,a=t.type,i=t.rp;a!=this.curTeamInstType&&0!=a||this.teamDataResp(a,i)},_createTeam:function(e){var t=e.data,a=t.type,i=t.rp;this.teamCreateResp(a,i)},_joinTeam:function(e){var t=e.data,a=t.type,i=t.rp;this.teamJoinResp(a,i)},_leaveTeam:function(e){var t=this;e.data.type==t.curTeamInstType&&(t.teamData.clearTeamData(),t.teamData.resetInsId(),t.autoReqTime=0,t.stopAutoTime(),t.setAutoJoinTime(),t.teamDataReq(t.teamData.curInsId),t.startAutoTime(),t.send(t.Evts.V_TEAM_LEAVE),t.dpt(t.Evts.C2C_CHANGE_TEAM_STATE))},_kickMember:function(){},receiveNewsBtn:function(){var e=game.settingData.isWorldWar()?0:1;this.dpt(this.Evts.C_CHANGE_NEWS_STATE,e),this.send(this.Evts.C2V_CHANGE_NEWS_STATE,e)},_quickJoinTeam:function(e){var t=e.data,a=t.type,i=t.rp;this.teamQuickJoinResp(a,i)},_joinTeamNotify:function(e){var t=e.data,a=t.type,i=t.rp;this.teamJoinNotify(a,i)},_leaveTeamNotify:function(e){var t=e.data,a=t.type,i=t.rp;this.teamLeaveNotify(a,i)},_enterBattle:function(){this.stopAutoTime()},_battleEnd:function(){},_teamRate:function(e){var t=e.data,a=t.type;if(a==this.curTeamInstType||0==a){var i=t.rp;this.teamData.setDouble(i.rate)}},_teamEmbattle:function(e){var t=e.data,a=t.type;if(a==this.curTeamInstType||0==a){var i=t.rp;this.teamData.updateTemaMember(i.member),this.send(this.Evts.C2V_TEAM_EMBATTLE)}},_partnerTeamEmbattle:function(e){var t=e.data.type;t!=this.curTeamInstType&&0!=t||this.teamData&&this.teamData.isInTeam&&this.send(this.Evts.C2V_TEAM_PARTNER_TEAM_EMBATTLE)},_teamInviteCoolTime:function(e){var t=e.data.type;t!=this.curTeamInstType&&0!=t||this.teamData&&this.teamData.isInTeam&&(this.teamData.setTeamInviteCoolEndTime(),this.send(this.Evts.C2V_TEAM_INVITE_COOL_TIME))},stopAutoBattle:function(e){e.data&&(this.changeAutoJoin(!1),this.teamData.isInTeam&&this.leaveBtn())},inviteJoin:function(e){if(e&&e.data){var t=e.data;if(t.teamType==this.curTeamInstType)if(this.teamData.isInTeam)game.notice.show(9320);else{var a=t.instId;if(this.teamData.curInsId=a,this.teamData.curSelectInsId=a,this.checkInstCanEnter(a)){var i=t.teamId;this.joinTeam(i,a)}else game.notice.show(9321)}}},selectBoss:function(e){this.teamData.selectInsId(e),this.send(this.Evts.V_SELECT_BOSS);var t=this.teamData.curInsId;this.teamData.isInTeam||this.teamDataReq(t),this.dptG(this.Evts.G_SELECT_BOSS,{instId:t})},selectBoss2:function(e){this.teamData.selectInsId2(e),this.send(this.Evts.V_SELECT_BOSS)},showView:function(){this.teamData.isInTeam||(this.autoReqTime=0,this.setAutoJoinTime(),this.startAutoReq()),this.teamData.initBossList()},hideView:function(){this.invInstId=0,this.teamData.isInTeam||this.stopAutoTime()},setAutoJoinTime:function(){var e=b8e.module.isShowView(this.moduleEnum);if(this.checkLv(!1)||this.changeAutoJoin(!0),e&&!this.teamData.isInTeam&&this.teamData.isAutoJoin){var t=game.InstanceMiscCfg.getData("teamAutoJoinTime");t&&(this.teamData.autoJoinTime=0|t.value),this.startAutoTime()}},setAutoStartTime:function(){if(this.teamData.isInTeam&&this.teamData.isAutoStart){var e=game.InstanceMiscCfg.getData("teamAutoStartTime");e&&(this.teamData.autoStartTime=0|e.value),this.startAutoTime()}},setAutoFullStartTime:function(){if(!game.playBack.isFighting&&this.teamData.isInTeam&&this.teamData.isFull&&this.teamData.isAutoFullStart){var e=game.InstanceMiscCfg.getData("teamAutoFullStartTime");e&&(this.teamData.autoFullStartTime=0|e.value),this.startAutoTime()}},startAutoTime:function(){this.timer||(this.timer=b8e.Timer.add(this,this.autoTime,1e3,0,0)),this.timer.reset(),this.timer.start(),this.send(this.Evts.V_UPDATE_TIME)},stopAutoTime:function(){this.timer&&this.timer.stop()},autoTime:function(){var e=this;0<e.teamData.autoStartTime&&e.teamData.autoStartTime--,0<e.teamData.autoJoinTime&&e.teamData.autoJoinTime--,0<e.teamData.autoFullStartTime&&e.teamData.autoFullStartTime--,e.teamData.isInTeam?(e.teamData.isFull&&e.teamData.isAutoFullStart&&e.teamData.autoFullStartTime<=0&&(e.startFight(),e.stopAutoTime()),e.teamData.isAutoStart&&e.teamData.autoStartTime<=0&&(e.startFight(),e.stopAutoTime())):e.teamData.isAutoJoin&&e.teamData.autoJoinTime<=0?(e.quickJoinTeam(),e.stopAutoTime()):(e.autoReqTime++,e.autoReq()),b8e.module.isShowView(e.moduleEnum)||!e.teamData.isAutoStart&&!e.teamData.isAutoFullStart||e.dpt(e.Evts.C_UPDATE_TIME),e.send(e.Evts.V_UPDATE_TIME)},startFight:function(){var e=this;if(game.playBack.isInstanceFighting(!0)||game.sceneData.isGuildMap()||game.sceneData.isCsScene(!0))e.send(e.Evts.V_UPDATE_AUTO);else{var t=e.teamData.curMembers;e.memberIds.length=0;for(var a=t.length,i=void 0,n=0;n<a;n++)i=t[n],e.memberIds.push(i.roleid);var s=e.teamData.curTeamId,o=e.teamData.curInsId,r=b8e.createMap();r.teamId=s,r.instId=o,r.memberIds=e.memberIds,e.dptG(e.Evts.C_ENTER_BATTLE,r)}},startAutoReq:function(){this.timer||(this.timer=b8e.Timer.add(this,this.autoTime,1e3,0,0)),this.timer.reset(),this.timer.start()},autoReq:function(){this.autoReqTime%3==0&&(this.teamData.isInTeam||this.dptG(this.Evts.C_REQ_TEAM_DATA,{instId:this.teamData.curInsId}))},checkInstCanEnter:function(e,t){return!0},joinTeam:function(e,t){this.dptG(this.Evts.C_TEAM_JOIN,{teamId:e,instId:t})},kickMember:function(e){this.dptG(this.Evts.C_KICK_MEMBER,{roleId:e})},setCurSelectPartnerId:function(e){this.teamData.curSelectPartnerId=e},partnerTeamEmbattleReq:function(e){var t=game.mainRoleData.id,a=this.teamData.getTeamMemberInfoById(t);if(a){var i=a.partners;if(i&&!(i.length<2))if(a.getIsBattle(e.id))game.notice.show(51626);else{var n=a.getPartnerIndex(this.teamData.curSelectPartnerId);if(-1!=n){var s=[],o=void 0;0==n?(s.push(e.battlePos),-1!=(o=this._getSlot(i,1))&&s.push(o)):(-1!=(o=this._getSlot(i,0))&&s.push(o),s.push(e.battlePos)),!s||s.length<2||this.dptG(this.Evts.C_PARTNER_TEAM_EMBATTLE_REQ,{slots:s})}else game.notice.show(51627)}}},_getSlot:function(e,t){var a=e[t];if(a){var i=game.partnerData.getInfoById(a.id);if(i)return i.battlePos}return-1},teamPartnerUpdatePosReq:function(){var e=game.mainRoleData.id,t=this.teamData.getTeamMemberInfoById(e);if(t){var a=t.partners;if(a&&!(a.length<2)){var i=a[0];a[0]=a[1],a[1]=i;var n=[],s=this._getSlot(a,0);-1!=s&&n.push(s),-1!=(s=this._getSlot(a,1))&&n.push(s),!n||n.length<2||this.dptG(this.Evts.C2C_TEAM_PARTNER_UPDATE_POS_REQ,{slots:n})}}},quickJoinTeam:function(){var e=this.teamData.curInsId,t=!0,a=game.TeamInstanceCfg.getData(e);if(a&&(t=game.mainRoleData.lv>=a.limitLv),!t)return this.changeAutoJoin(!1),void game.notice.show(52220,a.limitLv);var i=game.playBack.isInstanceFighting(),n=game.sceneData.isGuildMap(),s=game.UpgradeUtil.checkEquipTooMuch(),o=game.exploreScene.isInExploreScene();s||!t||i||n||o?this.changeAutoJoin(!1):this.dptG(this.Evts.C_TEAM_QUICK_JOIN,{curTeamInstType:this.curTeamInstType})},changeAutoJoin:function(e){this.teamData.isAutoJoin=e,this.send(this.Evts.V_UPDATE_AUTO)},checkLv:function(e){var t=!(0<arguments.length&&void 0!==e)||e;return game.mainRoleData.lv>=this.teamData.teamAutoLv||(t&&game.notice.show(9550,this.teamData.teamAutoLv),!1)},checkTime:function(){this.timer&&(!this.teamData.isInTeam||this.teamData.isAutoStart||this.teamData.isAutoFullStart?(this.setAutoJoinTime(),this.setAutoStartTime(),this.setAutoFullStartTime()):this.stopAutoTime())},receiveBtn:function(){0<this.teamData.getRemainCoolTime()||this.dptG(this.Evts.V2C_TEAM_INVITE)},startBtn:function(){this.startFight()},leaveBtn:function(){this.dptG(this.Evts.C_TEAM_LEAVE,{instId:this.teamData.curInsId})},autoFullStartSelectBtn:function(){this.checkLv()&&(this.teamData.isAutoFullStart=!this.teamData.isAutoFullStart,this.checkTime(),this.send(this.Evts.V_UPDATE_TIME),this.send(this.Evts.V_UPDATE_AUTO))},autoStartSelectBtn:function(){this.checkLv()&&(this.teamData.isAutoStart=!this.teamData.isAutoStart,this.checkTime(),this.send(this.Evts.V_UPDATE_TIME),this.send(this.Evts.V_UPDATE_AUTO))},autoJoinSelectBtn:function(){!this.checkLv()&&this.teamData.isAutoJoin||(this.teamData.isAutoJoin=!this.teamData.isAutoJoin,this.checkTime(),this.send(this.Evts.V_UPDATE_TIME),this.send(this.Evts.V_UPDATE_AUTO))},createrTeamBtn:function(){var e=this.teamData.curInsId,t=!0,a=game.TeamInstanceCfg.getData(e);a&&(t=game.mainRoleData.lv>=a.limitLv),t?this.dptG(this.Evts.C_TEAM_CREATE,{instId:this.teamData.curInsId}):game.notice.show(52220,a.limitLv)},quickJoinTeamBtn:function(){this.quickJoinTeam()},quickJoinBtn:function(){},exchangeBtn:function(){this.dptG(this.Evts.C_REQ_TEAM_DATA,{instId:this.teamData.curInsId})}}),b8e.RC("$$game","$$TeamControl",e)}(),function(){var e=game.Control.extends({curTeamInstType:0,lockTime:0,lockUpTime:1e3,startFightTime:0,canEnter:!0,triggerOpen:function(e){e==this.moduleEnum&&this.sender.TeamDataReq(0)},ipc:function(){var e=this;e.gevts={TeamEvts:{G_SELECT_BOSS:e.selectBoss,C_REQ_TEAM_DATA:e.teamDataReq,C_TEAM_JOIN:e.joinTeam,C_TEAM_LEAVE:e.leaveTeam,C_TEAM_CREATE:e.createTeam,C_KICK_MEMBER:e.kickMember,C_TEAM_QUICK_JOIN:e.quickJoinTeam,C_ENTER_BATTLE:e.startFight,C_PARTNER_TEAM_EMBATTLE_REQ:e.partnerTeamEmbattleReq,C2C_TEAM_PARTNER_UPDATE_POS_REQ:e.partnerTeamEmbattleReq,V2C_TEAM_INVITE:e.teamInviteReq}},e.evts={MainRole:{C_LEVEL_UP:e.levelUP}},e.handels={TeamDataResp:e._teamDataResp,TeamCreateResp:e._teamCreateResp,TeamJoinResp:e._teamJoinResp,TeamLeaveResp:e._teamLeaveResp,TeamKickResp:e._teamKickResp,TeamQuickJoinResp:e._teamQuickJoinResp,TeamJoinMsg:e._teamJoinMsg,TeamLeaveMsg:e._teamLeaveMsg,TeamStartResp:e._teamStartResp,TeamBattleMsg:e._teamBattleMsg,TeamRateMsg:e._teamRateMsg,TeamEmbattleMsg:e._teamEmbattleMsg,PartnerTeamEmbattleResp:e._partnerTeamEmbattleResp,TeamInviteResp:e._teamInviteResp}},notify:function(e,t,a){var i=this;switch(e){case i.Evts.V_SHOW_VIEW:i.showView();break;case i.Evts.V_KICK_MEMBER:i.kickMember(t);break;case i.Evts.V_JOIN_TEAM:i.joinTeam(t,a);break;case i.Evts.V_SELECT_BOSS:i.selectBoss(t);break;case i.Evts.V_HIDE_VIEW:i.hideView()}},levelUP:function(){this.dpt(this.Evts.C_REFRESH_BOSS_LIST)},_teamDataResp:function(e){var t=e.readProtobuf(game.pb.TeamDataResponse);0<t.code?game.notice.noticeError(t.code):this.dpt(this.Evts.C_SET_TEAM,{type:this.curTeamInstType,rp:t})},_teamCreateResp:function(e){var t=e.readProtobuf(game.pb.TeamCreateResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C_TEAM_CREATE,{type:this.curTeamInstType,rp:t}),this.lockTime=game.SysTime.curTime)},_teamJoinResp:function(e){var t=e.readProtobuf(game.pb.TeamJoinResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C_TEAM_JOIN,{type:this.curTeamInstType,rp:t}),this.lockTime=game.SysTime.curTime)},_teamLeaveResp:function(e){var t=e.readProtobuf(game.pb.TeamLeaveResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C_TEAM_LEAVE,{type:this.curTeamInstType,rp:t}),this.lockTime=game.SysTime.curTime,this.canEnter=!0)},_teamKickResp:function(e){var t=e.readProtobuf(game.pb.TeamKickResponse);0<t.code?game.notice.noticeError(t.code):this.dpt(this.Evts.C_KICK_MEMBER,{type:this.curTeamInstType,rp:t})},_teamQuickJoinResp:function(e){var t=e.readProtobuf(game.pb.TeamQuickJoinResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C_TEAM_QUICK_JOIN,{type:this.curTeamInstType,rp:t}),this.lockTime=game.SysTime.curTime)},_teamJoinMsg:function(e){var t=e.readProtobuf(game.pb.TeamJoinNotify);this.dpt(this.Evts.C_TEAM_JOIN_NOTIFY,{type:this.curTeamInstType,rp:t}),this.lockTime=game.SysTime.curTime},_teamLeaveMsg:function(e){var t=e.readProtobuf(game.pb.TeamLeaveNotify);this.dpt(this.Evts.C_TEAM_LEAVE_NOTIFY,{type:this.curTeamInstType,rp:t}),this.canEnter=!0},_teamStartResp:function(e){var t=e.readProtobuf(game.pb.TeamStartResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C_ENTER_BATTLE,{type:this.curTeamInstType,rp:t}),this.startFightTime=game.SysTime.curTime,this.canEnter=!0)},_teamBattleMsg:function(e){var t=e.readProtobuf(game.pb.TeamBattleNotify),a=this.getInstTypeById(t.insid);this.dpt(this.Evts.C_BATTLE_END,{type:a,rp:t})},_teamRateMsg:function(e){var t=e.readProtobuf(game.pb.TeamRateNotify);this.dpt(this.Evts.C_TEAM_RATE,{type:this.curTeamInstType,rp:t})},_teamEmbattleMsg:function(e){var t=e.readProtobuf(game.pb.TeamEmbattleNotify);0<t.code?game.notice.noticeError(t.code):this.dpt(this.Evts.C2C_TEAM_EMBATTLE,{type:this.curTeamInstType,rp:t})},_partnerTeamEmbattleResp:function(e){var t=e.readProtobuf(game.pb.PartnerTeamEmbattleResponse);0<t.code?game.notice.noticeError(t.code):this.dpt(this.Evts.C2C_TEAM_PARTNER_TEAM_EMBATTLE,{type:this.curTeamInstType,rp:t})},_teamInviteResp:function(e){var t=e.readProtobuf(game.pb.TeamInviteResponse);0<t.code?game.notice.noticeError(t.code):(game.notice.show(51631),this.dpt(this.Evts.C2C_TEAM_INVITE_COOL_TIME,{type:this.curTeamInstType}))},selectBoss:function(){},joinTeam:function(e){if(!(game.UpgradeUtil.checkEquipTooMuch()||0!=this.lockTime&&this.lockTime+this.lockUpTime>game.SysTime.curTime)){var t=e.data,a=t.instId,i=this.getInstTypeById(a);this.isInOtherTeam(i)?game.notice.show(9322):this.curTeamInstType=i;var n=t.teamId;this.sender.TeamJoinReq(n,a)}},kickMember:function(e){var t=this,a=e.data.roleId;t.canEnter&&(t.sender.TeamKickReq(a),t.canEnter=!1,b8e.Tween.kill(t),b8e.Tween.get(t).wait(5e3).call(function(){t.canEnter=!0,b8e.Tween.kill(t)},t))},teamDataReq:function(e){var t=e.data.instId,a=this.getInstTypeById(t);this.isInOtherTeam(a)?game.notice.show(9322):(this.curTeamInstType=a,this.sender.TeamDataReq(t))},createTeam:function(e){var t=e.data.instId,a=this.getInstTypeById(t);this.isInOtherTeam(a)?game.notice.show(9322):(this.curTeamInstType=a,game.UpgradeUtil.checkEquipTooMuch()||0!=this.lockTime&&this.lockTime+this.lockUpTime>game.SysTime.curTime||this.sender.TeamCreateReq(t))},quickJoinTeam:function(e){if(e&&e.data)if(this.checkIsInOtherTypeTeamInst())game.notice.show(9322);else if(!game.playBack.isInstanceFighting(!0)&&!game.sceneData.isGuildMap()){var t=e.data.curTeamInstType,a=void 0,i=game.TeamInstType;switch(t){case i.CS_TEAM:a=game.csTeamData.curInsId;break;case i.GUILD_TEAM:a=game.guildTeamData.curInsId;break;case i.WORLDWAR_TEAM:a=game.worldWarData.curInsId;break;case i.WORLDWAR2_TEAM:a=game.worldWar2Data.curInsId;break;case i.THOUSANDTOWER_TEAM:a=game.thousandTowerData.curInsId}this.curTeamInstType=t,0!=this.lockTime&&this.lockTime+this.lockUpTime>game.SysTime.curTime||this.sender.TeamQuickJoinReq(a)}},startFight:function(e){var t=this,a=e.data,i=a.teamId,n=a.instId,s=a.memberIds;game.playBack.isInstanceFighting(!0)||game.sceneData.isGuildMap()||0!=t.startFightTime&&t.startFightTime+t.lockUpTime>game.SysTime.curTime||(t.startFightTime=game.SysTime.curTime,t.canEnter&&(t.sender.TeamStartReq(i,n,s),t.canEnter=!1,b8e.Tween.kill(t),b8e.Tween.get(t).wait(5e3).call(function(){this.canEnter=!0,b8e.Tween.kill(this)},t)))},partnerTeamEmbattleReq:function(e){var t=e.data.slots;this.sender.PartnerTeamEmbattleReq(t)},leaveTeam:function(e){if(!(0!=this.lockTime&&this.lockTime+this.lockUpTime>game.SysTime.curTime)){var t=e.data.instId,a=this.getInstTypeById(t);this.curTeamInstType=a,this.sender.TeamLeaveReq()}},teamInviteReq:function(){this.sender.TeamInviteReq()},checkIsInOtherTypeTeamInst:function(){return this.isInOtherTeam(this.curTeamInstType)},getInstTypeById:function(e){if(0==e)return game.TeamInstType.NONE;var t=game.TeamInstanceCfg.getData(e);return t?t.type:(b8e.warn("\u7ec4\u961f\u526f\u672c\u4e0d\u5b58\u5728id: ",e),game.TeamInstType.NONE)},isInOtherTeam:function(e){for(var t=null,a=game.TeamInstType.CS_TEAM;a<game.TeamInstType.MAX;a++)if(e!=a&&(t=this.getTeamDataByType(a)),t&&t.isInTeam)return!0;return!1},getTeamDataByType:function(e){var t=game.TeamInstType,a=null;switch(e){case t.CS_TEAM:a=game.csTeamData;break;case t.GUILD_TEAM:a=game.guildTeamData;break;case t.WORLDWAR_TEAM:a=game.worldWarData;break;case t.WORLDWAR2_TEAM:a=game.worldWar2Data}return a}}),t=game.Sender.extends({ipc:function(){this.msg={TeamCreateReq:this.teamCreateReq,TeamJoinReq:this.teamJoinReq,TeamLeaveReq:null,TeamKickReq:this.teamKickReq,TeamQuickJoinReq:this.teamQuickJoinReq,TeamStartReq:this.teamStartReq,TeamDataReq:this.teamDataReq,PartnerTeamEmbattleReq:this.sendPartnerTeamEmbattleReq,TeamInviteReq:null}},teamCreateReq:function(e){var t=game.pb.TeamCreateRequest;t.insid=e,b8e.net.getBytes().writeProtobuf(t)},teamJoinReq:function(e,t){var a=game.pb.TeamJoinRequest;a.teamid=e,a.insid=t,b8e.net.getBytes().writeProtobuf(a)},teamQuickJoinReq:function(e){var t=game.pb.TeamQuickJoinRequest;t.insid=e,b8e.net.getBytes().writeProtobuf(t)},teamKickReq:function(e){var t=game.pb.TeamKickRequest;t.roleid=e,b8e.net.getBytes().writeProtobuf(t)},teamStartReq:function(e,t,a){var i=game.pb.TeamStartRequest;i.teamid=e,i.insid=t,i.members=a,b8e.net.getBytes().writeProtobuf(i)},teamDataReq:function(e){var t=game.pb.TeamDataRequest;t.insid=e,b8e.net.getBytes().writeProtobuf(t)},sendPartnerTeamEmbattleReq:function(e){var t=game.pb.PartnerTeamEmbattleRequest;t.slots=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.TeamHandel,e,game.TeamEvts,t)}(),function(){var e=void 0;e=b8e.Object.extends({id:0,isSelect:!1,isOpen:!1,isFirst:!1,setData:function(e,t,a,i){this.id=e,this.isSelect=t,this.isOpen=a,this.isFirst=i}}),b8e.BindingUtil.bind(e),e.poolCall=!0,b8e.RC("$$game","$$TeamBossInfo",e)}(),function(){var e;e=b8e.Object.extends({teamMap:null,curTeamId:0,curMembers:null,isInTeam:!1,bossInfoList:null,_curInsId:0,_curSelectInsId:0,isMineLeader:!1,teamList:null,isInitData:!1,hasCount:30,maxCount:30,isFull:!1,isAutoStart:!0,isAutoJoin:!0,isAutoFullStart:!0,teamAutoLv:0,autoStartTime:0,autoJoinTime:0,autoFullStartTime:0,maxMemberCount:3,doubleTime1:"",doubleTime2:"",rate:1,isHasRate:!0,prizeInfoPool:null,prizeInfoList:null,prizeFirstPool:null,prizeFirstList:null,selectIdx:0,curTeamInstType:0,curSelectPartnerId:0,teamInviteCoolEndTime:0,ctor:function(){this._super(),this.teamMap=b8e.HashMap.get(),this.teamList=[],this.curMembers=[],this.bossInfoList=[],this.prizeInfoPool=[],this.prizeInfoList=[],this.prizeFirstPool=[],this.prizeFirstList=[]},curInsId:{get:function(){return this._curInsId},set:function(e){this._curInsId=e}},curSelectInsId:{get:function(){return this._curSelectInsId},set:function(e){this._curSelectInsId=e}},resetInsId:function(){this.curInsId=this.curSelectInsId},initData:function(){},setTeamData:function(e){var t=this;t.isInTeam||t.clearTeamData(),t.setDouble(e.rate),t.hasCount=e.challengeNum>t.maxCount?0:t.maxCount-e.challengeNum,t._recycleTeamInfo(),t._setTeamList(e.list),t.initBossList(),t._setBossInfoList(e.insList)},setDouble:function(e){this.rate=e,this.isHasRate=1<this.rate},_recycleTeamInfo:function(){if(!(this.teamList.length<1))for(var e=void 0;this.teamList.length;)(e=this.teamList.pop())&&(game.TeamInfo.put(e),this.teamList.pop())},_setTeamList:function(e){if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=0,n=e.length;i<n;i++)(t=e[i])&&((a=game.TeamInfo.get()).setData(t,this.curInsId),this.teamList.push(a))},_setBossInfoList:function(e){if(e&&0<e.length){if(!this.bossInfoList)return;for(var t=void 0,a=0,i=this.bossInfoList.length;a<i;a++)(t=this.bossInfoList[a])&&-1<e.indexOf(t.id)&&(t.isFirst=!0,this.bossInfoList[a]=t)}},initBossList:function(){},refreshBossList:function(){},selectInsId:function(e){this.curSelectInsId=e,this.isInTeam||(this.curInsId=e),this._setSelect(e)},selectInsId2:function(e){this.curSelectInsId=e,this.curInsId=e,this._setSelect()},_setSelect:function(e){for(var t=this.bossInfoList.length,a=void 0,i=0;i<t;i++)(a=this.bossInfoList[i]).id==e?(a.isSelect=!0,this.selectIdx=i):a.isSelect=!1},setTeam:function(e){var t=this;t.clearTeamData(),t.isInTeam=!0,t.curTeamId=e.id;for(var a=game.mainRoleData.id,i=e.members,n=i.length,s=void 0,o=void 0,r=0;r<n;r++)(s=i[r])&&(s.leader&&s.roleid==a&&(t.isMineLeader=!0),(o=game.TeamMemberInfo.get()).setData(s,t.isMineLeader),o.setTeamInstType(t.curTeamInstType),t.curMembers.push(o));if(t.isMineLeader){var g=void 0;n=t.curMembers.length;for(var l=0;l<n;l++)(g=t.curMembers[l])&&g.roleid!=a&&(g.isKick=!0)}0<t.curMembers.length&&t.curMembers.sort(t.sortMembers)},clearTeamData:function(){this.curTeamId=0,this.isInTeam=!1,this.isMineLeader=!1;for(var e=void 0;this.curMembers.length;)(e=this.curMembers.pop())&&game.TeamMemberInfo.put(e);this.curMembers.length=0,this.isFull=!1},teamJoin:function(e){var t=game.TeamMemberInfo.get();t.setData(e.member,this.isMineLeader),t.setTeamInstType(this.curTeamInstType),this.curMembers.push(t),this.curMembers.sort(this.sortMembers),this.isFull=!(this.curMembers.length<this.maxMemberCount)},teamLeave:function(e){var t=this,a=game.mainRoleData.id;if(a==e.roleid)return t.isInTeam&&t.clearTeamData(),!0;if(t.curMembers.length<=0)return b8e.warn("\u5f53\u524d\u961f\u4f0d\u6ca1\u6709\u73a9\u5bb6"),!1;t.isFull=!1;for(var i=void 0,n=t.curMembers.length,s=0;s<n;s++)if((i=t.curMembers[s])&&i.roleid==e.roleid){t.curMembers.splice(s,1),i.clearData(),game.TeamMemberInfo.put(i);break}if(0<e.leader){a==e.leader&&(t.isMineLeader=!0),n=t.curMembers.length;for(var o=0;o<n;o++)if(i=t.curMembers[o]){if(i.roleid==e.leader&&(i.leader=!0),!t.isMineLeader)break;i.roleid!=a&&(i.isKick=!0)}}return t.curMembers.sort(t.sortMembers),!1},sortMembers:function(e,t){return e.leader?-1:t.leader?1:e.roleid-t.roleid},updateTemaMember:function(e){if(this.curMembers&&!(this.curMembers.length<1))for(var t=0,a=this.curMembers.length,i=void 0;t<a;t++)(i=this.curMembers[t])&&i.roleid==e.roleid&&(i.setData(e,this.isMineLeader),i.setTeamInstType(this.curTeamInstType))},getTeamMemberInfoById:function(e){if(!this.curMembers||this.curMembers.length<1)return null;for(var t=0,a=this.curMembers.length,i=void 0;t<a;t++)if((i=this.curMembers[t])&&i.roleid==e)return i;return null},setTeamInviteCoolEndTime:function(){this.teamInviteCoolEndTime=game.SysTime.curTime+5e3},getRemainCoolTime:function(){return(this.teamInviteCoolEndTime-game.SysTime.curTime)/1e3>>0},teamBattle:function(){this.hasCount=Math.max(--this.hasCount,0)},getTeamList:function(){return this.teamList},getTeamMembers:function(){return this.curMembers},isInTeamPartner:function(e){var t=this.getTeamMemberInfoById(game.mainRoleData.roleId);if(!t)return!1;var a=t.partners;if(!a||a.length<1)return!1;for(var i=0,n=a.length,s=void 0;i<n;i++)if((s=a[i])&&s.id==e)return!0;return!1},getBossInfoList:function(){return this.bossInfoList},getBossInfoByIdx:function(e){return e=e||this.selectIdx,this.bossInfoList[e]},getCurMemberCount:function(){return this.curMembers.length},getPrizeList:function(){var e=game.TeamInstanceCfg.getData(this.curInsId);if(!e||!e.showItems||e.showItems.length<1)return null;this.prizeInfoList.length=0;for(var t=e.showItems,a=t.length,i=void 0,n=void 0,s=void 0,o=void 0,r=game.IconSizeEnum.GRID_SIZE_84,g=0;g<a;g++)if(s=t[g],n=game.ItemInfoCfg.getData(s)){switch(n.cfgType){case game.ItemCfgType.NormalItem:i=0;break;case game.ItemCfgType.Equip:i=1;break;default:i=0}(o=this.prizeInfoPool[g])?o.setData(s,1,0,i,r):o=game.ItemUtil.createPrizeInfo(s,1,i,r),this.prizeInfoList.push(o)}else b8e.warn("showItemId\u5bf9\u5e94\u7684\u914d\u7f6e\u4e0d\u5b58\u5728,showItemId:",s);return this.prizeInfoList},getPrizeFirstList:function(e){e=e||this.curInsId;var t=game.TeamInstanceCfg.getData(e);if(!t||!t.award||t.award.length<1)return null;for(var a=t.award,i=a.length,n=void 0,s=void 0,o=0,r=0;r<i;r++)s=a[r],game.ItemInfoCfg.getData(s.Id)?((n=this.prizeFirstPool[r])||(n=game.ItemUtil.createPrizeInfo(s.id,s.Num,2),this.prizeFirstPool[r]=n),n.setData(s.Id,s.Num,2),o++):b8e.warn("showItemId\u5bf9\u5e94\u7684\u914d\u7f6e\u4e0d\u5b58\u5728,showItem:",s.Id);if(o<this.prizeFirstPool.length){var g=this.prizeFirstPool.length-o;this.prizeFirstPool.splice(o,g)}return this.prizeFirstPool}}),b8e.RC("$$game","$$teamData",e)}(),function(){var e,t=e=b8e.PoolObject.extends({id:0,memberCount:0,leaderName:"",insId:0,ismale:!1,ctor:function(){this._super()},setData:function(e,t){var a=1<arguments.length&&void 0!==t?t:0;this.id=e.id,this.insId=a,this.memberCount=e.members.length;for(var i=void 0,n=e.members,s=n.length,o=0;o<s;o++)if((i=n[o])&&i.leader){this.leaderName=i.name,this.ismale=i.ismale;break}},clearData:function(){this.id=0,this.memberCount=0,this.leaderName=""},recycle:function(){this.clearData(),this._super()}});b8e.BindingUtil.bind(t);var a=new b8e.Pool(t,10);t.get=function(e){return a.get(e)},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$TeamInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,CS_TEAM:-1,GUILD_TEAM:-1,WORLDWAR_TEAM:-1,WORLDWAR2_TEAM:-1,THOUSANDTOWER_TEAM:-1,MAX:-1}),b8e.RC("$$game","$$TeamInstType",e)}(),function(){var e,t=e=b8e.PoolObject.extends({id:0,level:0,power:0,starLv:0,topLv:0,skin:null,qualityNum:0,ctor:function(){this._super()},setData:function(e){this.id=e.id,this.level=e.level,this.power=e.power,this.starLv=e.starLv,this.topLv=e.topLv,this.skin=e.skin,this.qualityNum=e.qualityNum},clearData:function(){this.id=0,this.level=0,this.power=0,this.starLv=0,this.topLv=0,this.skin=null,this.qualityNum=0},recycle:function(){this.clearData(),this._super()}});b8e.BindingUtil.bind(t);var a=new b8e.Pool(t,12);t.get=function(e){return a.get(e)},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$TeamPartnerInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({roleid:0,name:"",level:0,power:0,ismale:!1,leader:!1,partners:null,_isUpIndex:0,isKick:!1,teamInstType:0,setData:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=this;i.roleid=e.roleid,i.name=e.name,i.level=e.level,i.power=e.power,i.ismale=e.ismale,i.leader=e.leader,i.surface=e.surface,i._isUpIndex++;var n=e.partners;if(n&&0<n.length){var s=0,o=n.length,r=void 0,g=void 0;for(i.partners?(i.recyclePartnerInfo(),i._tempPartner.length=0):(i.partners=[],i._tempPartner=[]);s<o;s++)(r=n[s])&&((g=game.TeamPartnerInfo.get()).setData(r),i.partners.push(g),i._tempPartner[g.id]=g)}i.isKick=a&&!e.leader},setTeamInstType:function(e){this.teamInstType=e},getIsBattle:function(e){return!!this._tempPartner&&this._tempPartner[e]},getPartnerIndex:function(e){if(!this.partners||this.partners.length<1)return-1;for(var t=0,a=this.partners.length,i=void 0;t<a;t++)if((i=this.partners[t])&&i.id==e)return t;return-1},clearData:function(){var e=this;e.roleid=0,e.name="",e.level=0,e.power=0,e.ismale=!1,e.leader=!1,e.isKick=!1,e.teamInstType=0,e.surface=null,e._isUpIndex=0,e.recyclePartnerInfo()},recyclePartnerInfo:function(){if(this.partners&&!(this.partners.length<1)){for(var e=0,t=this.partners.length,a=void 0;e<t;e++)(a=this.partners[e])&&a.release();this.partners.length=0,this._tempPartner&&(this._tempPartner.length=0)}},recycle:function(){this.clearData(),this._super()}});b8e.BindingUtil.bind(t);var a=new b8e.Pool(t,3);t.get=function(e){return a.get(e)},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$TeamMemberInfo",e)}(),function(){var e;e=game.ListItem.extends({_bossModel:null,_infoList:null,cfg:null,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:"";t=t||1212,this._super(t),this.setSize(196,323)},setData:function(){this.cfg=game.TeamInstanceCfg.getData(this.data.id),this.setSelect(),this.setTitle(),this.setPrize(),this.setBossModel(),this.setDesc()},setTitle:function(){this.skin.name.string=this.cfg.name},setSelect:function(){this.skin.selectImg.node.active=this.data.isSelect},setPrize:function(){var e=this,t=e.cfg;if(t){var a=void 0;a=e.data.isOpen&&e.data.isFirst?e.getFirstInfoList():e.getInfoList(t.award),e._prizeList||(e._prizeList=[]);for(var i=2<a.length?2:a.length,n=void 0,s=game.IconSizeEnum.GRID_SIZE_84,o=0;o<i;o++)(n=e._prizeList[o])||((n=game.GridUtil.createPrizeIcon(s)).addToParent(e.skin.icon),e._prizeList[o]=n),n.setVisible(!0),game.GridUtil.setPrizeIcon(n,e._infoList[o]),n.setPosition(o*s,0);var r=(196-i*s>>1)+(s>>1);e.skin.icon.x=r}},getFirstInfoList:function(){var e=this.cfg;if(!e)return null;this._infoList?this._recycleInfos():this._infoList=[];var t=this._getInfoByPool();return t.id=220001,t.num=e.exp,t.isDarkBg=!1,this._infoList.push(t),e.silver&&((t=this._getInfoByPool()).id=23,t.num=e.silver,t.isDarkBg=!1,this._infoList.push(t)),this._infoList},getInfoList:function(e){this._infoList?this._recycleInfos():this._infoList=[];for(var t=0,a=e.length,i=void 0,n=void 0;t<a;t++)(i=e[t])&&((n=this._getInfoByPool()).id=i.Id,n.num=i.Num,n.isDarkBg=!1,this._infoList.push(n));return this._infoList},_getInfoByPool:function(){return this._infoPool&&0<this._infoPool.length?this._infoPool.pop():game.ItemInfo.get()},_recycleInfos:function(){var e=this;if(e._infoList&&!(e._infoList.length<1)){for(var t=void 0;e._infoList.length;)(t=e._infoList.pop())&&(t.reset(),t.id=0,e._infoPool||(e._infoPool=[]),e._infoPool.push(t));if(e._prizeList&&!(e._prizeList.length<1))for(var a=0,i=e._prizeList.length,n=void 0;a<i;a++)(n=e._prizeList[a])&&n.setVisible(!1)}},setBossModel:function(e,t){game.CfgUtil.getMonsterModelByMonGroup(this.cfg.monGroup,e,!0,t,this._setBossModelCall,this)},_setBossModelCall:function(e){if(e||0==e){this._bossModel||(this._bossModel=b8e.Animator.get(game.AnimType.BOSS,1),this._bossModel.addToParent(this.skin.model));var t=game.ResCfg.getUrl(5e3,e);this._bossModel.load(t),this._bossModel.setScale(.5,.5),this._bossModel.play()}else this._bossModel&&this._bossModel.clear()},setDesc:function(){var e=this.skin,t=this.data;t.isOpen?(e.desc.node.color=game.Color.GREEN,e.desc.string=game.Lang.get(t.isFirst?10010:10011)):(e.desc.string=game.Lang.get(9323),e.desc.node.color=game.Color.RED)},click:function(){this.send(game.TeamEvts.V_SELECT_BOSS,this.data.id)},setElementBtn:function(e){if(e){var t=e.monGroup;!t||t.length<1||game.CfgUtil.getMonsterCfgByMonGroup(t[0],0,this._setElementBtnCall,this)}},_setElementBtnCall:function(e){var t=this.skin;e&&e.element?(this.elementAttr=e.element,t.view_elementBtn.active=!0,t.view_elementBtn.loadTexture(game.ResCfg.getUrl(10050,e.element))):t.view_elementBtn.active=!1},view_elementBtn:function(){this.elementAttr&&(game.elementData.setElementInfo(this.elementAttr,50369,this.skin.view_elementBtn.localToGlobal(),!1),game.module.show(game.ME.ElementAttr))}}),b8e.RC("$$game","$$TeamBossItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1293),this.setSize(192,403)},init:function(){var e=this,t=e.skin,a=e._model1=b8e.Animator.get(game.AnimType.PET_ANIM,1);a.addToParent(t.animNode1),a.setScale(.6,.6),e.roleData1=game.BaseRoleData.get(game.RoleType.Hero,1),e.roleModel1=game.sceneRoleCreate.createUIRole(e.roleData1),e.roleModel1.addToParent(t.roleModel1),e.roleModel1.setScale(.8,.8),(a=e._model2=b8e.Animator.get(game.AnimType.PET_ANIM,2)).addToParent(t.animNode2),a.setScale(.6,.6),e.roleData2=game.BaseRoleData.get(game.RoleType.Hero,2),e.roleModel2=game.sceneRoleCreate.createUIRole(e.roleData2),e.roleModel2.addToParent(t.roleModel2),e.roleModel2.setScale(.8,.8)},onShow:function(){var e=this,t=e.skin;if(e._super(),!e._isInitDraged){e._isInitDraged=!0;var a=game.mainRoleData.id;e.data&&a==e.data.roleid&&(game.dragEffectMgr.addDrag(t.model1,[t.model2],e._dragCallBack,e,null,null,null,null,null,{autoGoto:!1}),game.dragEffectMgr.addDrag(t.model2,[t.model1],e._dragCallBack,e,null,null,null,null,null,{autoGoto:!1}))}},onHide:function(){var e=this.skin;this._isInitDraged=!1,game.dragEffectMgr.delDrag(e.model1),game.dragEffectMgr.delDrag(e.model2),this._super()},_dragCallBack:function(e,t){t&&e&&this.send(game.TeamEvts.V2C_TEAM_PARTNER_UPDATE_POS_REQ)},setData:function(){var e=this.skin,t=this.data,a=game.mainRoleData.id==t.roleid;e.select_bg.node.active=a,e.default_bg.node.active=!a,e.btn_exchange1.node.active=a,e.btn_exchange2.node.active=a;var i=t.partners;i&&0<i.length?(this._setItem1(t,i[0],a),this._setItem2(t,i[1],a)):(this._clearItem1(),this._clearItem2())},_onSort:function(e,t){return e.id-t.id},_setItem1:function(e,t){var a=this;if(e&&t){var i=a.skin;if(i.starIcon1.active=1!=t.id,1==t.id){i.animNode1.setVisible(!1),i.roleModel1.setVisible(!0),a.roleData1.reset(),a.roleData1.type=game.RoleType.Hero,a.roleData1.setMale(e.ismale),a.roleData1.heroModel.setSurface(e.surface),a.roleData1.heroModel.type=game.RoleType.Hero,a.roleModel1.data=a.roleData1;var n=game.AvatarUtil;n.updateUIModel(a.roleModel1,n.ID_2,!1),a.roleModel1.transition(game.RoleStateType.ACTION_IDLE),a.roleModel1.active=!1,a.roleModel1.active=!0,i.nameLab1.string=game.HtmlUtil.getColorStrByQuality(e.surface.roleQuality,e.name+"+"+t.topLv,!0),i.powerLab1.string=game.Lang.get(1008,game.CCommonUtil.replaceNum(t.power))}else{i.animNode1.setVisible(!0),i.roleModel1.setVisible(!1);var s=game.PartnerCfg.getData(t.id);if(s){var o=s.UIModel;if(t.skin){var r=game.PartnerSkinCfg.getData(t.skin);r&&(o=r.UIModel)}a._model1.load(game.ResCfg.getUrl(5e3,o)),a._model1.play(),a._model1.active=!1,a._model1.active=!0;var g=void 0,l=game.PartnerTalentCfg.getData(t.id,t.qualityNum);g=l?l.quality:s.quality,i.nameLab1.string=game.HtmlUtil.getColorStrByQuality(g,s.name+"+"+t.topLv,!0)}i.powerLab1.string=game.Lang.get(1008,game.CCommonUtil.replaceNum(t.power)),i.star1.string=t.starLv}}else a._clearItem1()},_setItem2:function(e,t){var a=this;if(e&&t){var i=a.skin;if(i.starIcon2.active=1!=t.id,1==t.id){i.animNode2.setVisible(!1),i.roleModel2.setVisible(!0),a.roleData2.reset(),a.roleData2.type=game.RoleType.Hero,a.roleData2.setMale(e.ismale),a.roleData2.heroModel.setSurface(e.surface),a.roleData2.heroModel.type=game.RoleType.Hero,a.roleModel2.data=a.roleData2;var n=game.AvatarUtil;n.updateUIModel(a.roleModel2,n.ID_2,!1),a.roleModel2.transition(game.RoleStateType.ACTION_IDLE),a.roleModel2.active=!1,a.roleModel2.active=!0,i.nameLab2.string=game.HtmlUtil.getColorStrByQuality(e.surface.roleQuality,e.name+"+"+t.topLv,!0),i.powerLab2.string=game.Lang.get(1008,game.CCommonUtil.replaceNum(t.power))}else{i.animNode2.setVisible(!0),i.roleModel2.setVisible(!1);var s=game.PartnerCfg.getData(t.id);if(s){var o=s.UIModel;if(t.skin){var r=game.PartnerSkinCfg.getData(t.skin);r&&(o=r.UIModel)}a._model2.load(game.ResCfg.getUrl(5e3,o)),a._model2.play(),a._model2.active=!1,a._model2.active=!0;var g=void 0,l=game.PartnerTalentCfg.getData(t.id,t.qualityNum);g=l?l.quality:s.quality,i.nameLab2.string=game.HtmlUtil.getColorStrByQuality(g,s.name+"+"+t.topLv,!0)}i.powerLab2.string=game.Lang.get(1008,game.CCommonUtil.replaceNum(t.power)),i.star2.string=t.starLv}}else a._clearItem2()},_clearItem1:function(){var e=this.skin;e.animNode1.setVisible(!1),e.roleModel1.setVisible(!1),e.nameLab1.string="",e.powerLab1.string="",e.starIcon1.active=!1,this._model1&&this._model1.clear()},_clearItem2:function(){var e=this.skin;e.animNode2.setVisible(!1),e.roleModel2.setVisible(!1),e.nameLab2.string="",e.powerLab2.string="",e.starIcon2.active=!1,this._model2&&this._model2.clear()},btn_exchange1:function(){this._sendExchange(0)},btn_exchange2:function(){this._sendExchange(1)},_sendExchange:function(e){if(this.data&&this.data.partners){var t=this.data.partners[e];t&&this.send(game.TeamEvts.V2C_TEAM_OPEN_SELECT_PARTNER_PANEL,t.id)}}}),b8e.RC("$$game","$$TeamDetailsModelItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(995),this.setSize(178,194)},setData:function(){this.skin.leaderName.string=this.data.leaderName,this.skin.memberCount.string=game.Lang.get(1009,this.data.memberCount)},joinBtn:function(){game.playBack.isInstanceFighting(!0)||game.sceneData.isGuildMap()||this.send(game.TeamEvts.V_JOIN_TEAM,this.data.id,this.data.insId)}}),b8e.RC("$$game","$$TeamItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1291),this.setSize(583,123)},setData:function(){this.skin.nameLab.string=this.data.leaderName,this.skin.numberLab.string=game.Lang.get(1009,this.data.memberCount),this.updateHead()},updateHead:function(){var e=this.data.ismale?"head_1":"head_2";e="circle_"+e;var t=game.ResCfg.getUrl(59,e);this.skin.icon.loadTexture(t)},joinBtn:function(){game.playBack.isInstanceFighting(!0)||game.sceneData.isGuildMap()||this.send(game.TeamEvts.V_JOIN_TEAM,this.data.id,this.data.insId)}}),b8e.RC("$$game","$$TeamListItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(996),this.setSize(186,213)},init:function(){this._headImg||(this._headImg=b8e.Sprite.get(),this._headImg.setAnchor(.5,.5),this._headImg.addToParent(this.skin.head))},setData:function(){var e=this.skin,t=this.data;if(e.name.string=t.name,e.level.string=game.Lang.get(1007,t.level),e.power.string=game.Lang.get(1008,game.CCommonUtil.replaceNum(t.power)),e.leaderImg.node.active=t.leader,e.kickBtn.node.active=t.isKick,this._headImg){var a=t.ismale?"head_1":"head_2",i=game.ResCfg.getUrl(59,a);this._headImg.loadTexture(i)}var n=t.teamInstType,s=game.TeamInstType,o=n==s.CS_TEAM||n==s.GUILD_TEAM||n==s.WORLDWAR_TEAM||n==s.WORLDWAR2_TEAM,r=!t.leader&&o;e.prepare_img.setVisible(r)},kickBtn:function(){this.send(game.TeamEvts.V_KICK_MEMBER,this.data.roleid)}}),b8e.RC("$$game","$$TeamMemberItem",e)}(),function(){var e;e=game.View.extends({bossList:null,prizeList:null,teamList:null,teamData:null,teamInfoList:null,bossInfoList:null,prizeInfoList:null,string:"",doubleTime1:"",doubleTime2:"",curTeamInstType:0,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:"";t=t||1213,this._super(t)},init:function(){var e=this.skin;this.prizeInfoList=[];var t=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=[game.ShowItemListItem,game.ShowEquipListItem,game.ShowFosterEquipListItem],t.bindEnum=this.moduleEnum,t.layout.paddingLeft=-10,t.layout.spacingX=17,t.layout.paddingTop=9,t.addToParent(e.prizeList),(t=this.teamList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical)).itemRender=game.TeamListItem,t.bindEnum=this.moduleEnum,t.addToParent(e.teamList),t.layout.paddingLeft=0,t.layout.paddingTop=0,t.layout.spacingX=0,t.layout.spacingY=3},notify:function(e){var t=this;switch(e){case t.Evts.V_SET_TEAM:t.setTeamList(),t.setCount();break;case t.Evts.V_TEAM_LEAVE:case t.Evts.V_TEAM_JOIN:case t.Evts.V_TEAM_CREATE:t.setTeamList();break;case t.Evts.V_UPDATE_TIME:t.setTeamList(),t.setAutoTime();break;case t.Evts.V_UPDATE_AUTO:t.setAutoBtn();break;case t.Evts.V_SELECT_BOSS:t.setTeamBossList(),t.setPrizeList()}},onShow:function(){this.setTeamList(),this.send(this.Evts.V_SHOW_VIEW),this.setAutoTime(),this.setAutoBtn()},onHide:function(){this.send(this.Evts.V_HIDE_VIEW)},setTeamList:function(){var e=this.skin;this.teamInfoList=this.teamData.getTeamList(),this.teamList.setData(this.teamInfoList);var t=this.teamInfoList&&0<this.teamInfoList.length;e.noTeamLab&&(e.noTeamLab.active=!t)},setTeamBossList:function(){this.bossInfoList=this.teamData.getBossInfoList(),this.bossList.setData(this.bossInfoList)},setPrizeList:function(){this.prizeInfoList=this.teamData.getPrizeList(),this.prizeList.setData(this.prizeInfoList)},view_left:function(){this.bossList&&this.bossList.scrollContainerLeft()},view_right:function(){this.bossList&&this.bossList.scrollContainerRight()},setCount:function(){this.skin.hasCountLab.string=game.Lang.get(1002,this.teamData.hasCount,this.teamData.maxCount)},setAutoTime:function(){var e=this.skin,t="";if(this.teamData.isAutoJoin)t=game.Lang.get(1006,this.teamData.autoJoinTime);else{this.string="10";var a=game.InstanceMiscCfg.getData("teamAutoJoinTime");a&&(this.string=a.value),t=game.Lang.get(1006,this.string)}e.autoJoinLab.string=t},setAutoBtn:function(){this.skin.autoJoinSelectImg.node.active=this.teamData.isAutoJoin}}),b8e.RC("$$game","$$TeamView",e)}(),function(){var e;e=game.View.extends({bossList:null,prizeList:null,teamList:null,teamData:null,teamInfoList:null,bossInfoList:null,string:"",doubleTime1:"",doubleTime2:"",curTeamInstType:0,bindModuleEnum:0,ctor:function(){this._super(1292)},init:function(){var e=this.skin,t=this.teamModelList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.TeamDetailsModelItem,t.bindEnum=this.bindModuleEnum,t.layout.paddingLeft=5,t.layout.paddingTop=0,t.layout.spacingX=1,t.layout.spacingY=0,t.addToParent(e.teamModelList),(t=this.teamNumberList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal)).itemRender=game.TeamMemberItem,t.bindEnum=this.bindModuleEnum,t.addToParent(e.teamNumberList),t.layout.paddingLeft=0,t.layout.paddingTop=0,t.layout.spacingX=10,t.layout.spacingY=3},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SET_TEAM:a.setTeamTitle(),a.setTeamList(),a.setAutoBtns(),a.setCount(),a.setBtn();break;case a.Evts.V_TEAM_LEAVE:case a.Evts.V_TEAM_JOIN:a.setTeamList(),a.setAutoBtns(),a.setBtn();break;case a.Evts.V_TEAM_CREATE:a.setTeamList(),a.setAutoBtns(),a.setCount(),a.setBtn();break;case a.Evts.V_UPDATE_TIME:case a.Evts.C2V_TEAM_EMBATTLE:case a.Evts.C2V_TEAM_PARTNER_TEAM_EMBATTLE_CHANGE:a.setTeamList(),a.setAutoTime(),a.setCount();break;case a.Evts.V_UPDATE_AUTO:a.setAutoBtn();break;case a.Evts.C2V_TEAM_PARTNER_TEAM_EMBATTLE:a.setTeamModelList();break;case a.Evts.C2V_TEAM_INVITE_COOL_TIME:a.startCoolTime();break;case a.Evts.C2V_CHANGE_NEWS_STATE:a.changeReceiveState(!0,t)}},onShow:function(){var e=this;e.setTeamList(),e.setAutoBtns(),e.setCount(),e.setBtn(),e.send(e.Evts.V2C_TEAM_CHECK_TIME),e.setAutoTime(),e.setTeamTitle(),e.startCoolTime(),e.changeReceiveState()},onHide:function(){this.teamModelList&&this.teamModelList.clear(),this.teamNumberList&&this.teamNumberList.clear(),this.stopCoolTime(),this.skin.coolTimeLab.string="",this.send(this.Evts.V_HIDE_VIEW)},changeReceiveState:function(e,t){var a=void 0;a=0<arguments.length&&void 0!==e&&e?0<t:game.settingData.isWorldWar(),this.skin.select.active=a},startCoolTime:function(){this.timer||(this.timer=b8e.Timer.add(this,this.updateCoolTime,1e3)),this.timer.reset(),this.timer.start()},stopCoolTime:function(){this.timer&&this.timer.stop()},updateCoolTime:function(){var e=this.skin,t=this.teamData.getRemainCoolTime();if(t<1)return e.coolTimeLab.string="",game.ShaderUtil.setGray(this.skin.receiveBtn,null),void this.stopCoolTime();game.ShaderUtil.setGray(this.skin.receiveBtn),e.coolTimeLab.string=t},setAutoBtns:function(){var e=this.skin;e.autoStart.active=!1,e.autoFullStart.active=!1,this.teamData.isMineLeader&&(e.autoStart.active=!0,e.autoFullStart.active=!0,this.setAutoBtn())},setTeamList:function(){var e=this.teamData.getTeamMembers();this.teamNumberList.setData(e),this.setTeamModelList(),this.skin.receiveBtn.active=this.teamData.isMineLeader},setTeamModelList:function(){var e=this.teamData.getTeamMembers();this.teamModelList.setData(e)},setCount:function(){var e=game.TeamInstType,t=void 0,a=void 0,i=this.skin,n=void 0,s=void 0;switch(this.teamData.curTeamInstType){case e.CS_TEAM:t=51449,a=51453,n=this.teamData.hasCount;break;case e.GUILD_TEAM:t=51450,a=51454,n=this.teamData.hasCount;break;case e.WORLDWAR_TEAM:t=51451,a=51455,n=0<(s=game.worldWarData.allHelpNum-game.worldWarData.helpNum)?s:0;break;case e.WORLDWAR2_TEAM:t=51452,a=51456,n=0<(s=game.worldWar2Data.allHelpNum-game.worldWar2Data.helpNum)?s:0}i.hasCountLab.string=game.Lang.get(t,n),i.doubleTimeLab.string=game.Lang.get(a)},setAutoTime:function(){var e=this.skin,t="";if(t=this.teamData.isFull&&this.teamData.isAutoFullStart?game.Lang.get(1003,this.teamData.autoFullStartTime):game.Lang.get(1005),e.autoFullStartLab.string=t,this.teamData.isAutoStart)t=game.Lang.get(1004,this.teamData.autoStartTime);else{this.string="60";var a=game.InstanceMiscCfg.getData("teamAutoStartTime");a&&(this.string=a.value),t=game.Lang.get(1004,this.string)}e.autoStartLab.string=t},setAutoBtn:function(){var e=this.skin;e.autoStartSelectImg.node.active=this.teamData.isAutoStart,e.autoFullStartSelectImg.node.active=this.teamData.isAutoFullStart},setBtn:function(){var e=this.skin;e.leaveBtn.node.active=this.teamData.isInTeam;var t=this.teamData.isInTeam&&this.teamData.isMineLeader;e.startBtn.node.active=t,e.receiveBtn.node.active=t},setTeamTitle:function(){var e=game.ResCfg.getUrl(10086,this.curTeamInstType);this.skin.titleImg.loadTexture(e),this.skin.auto_node.active=this.curTeamInstType==game.TeamInstType.WORLDWAR_TEAM}}),b8e.RC("$$game","$$TeamDetailsView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1352),this.setSize(540,126)},init:function(){this.icon=new game.CultivateBaseIcon,this.icon.addToParent(this.skin.icon)},setData:function(){var e=this.skin,t=this.data.info;this.icon.setData(t),this.icon.showBattle();var a=0;a=t&&null!=t.quality&&t.quality?t.quality:t.cfg.quality;var i=game.HtmlUtil.getColorStrByQuality(a,t.name||t.cfg.name);e.nameLab.string=i+"+"+t.breakLv,e.lvLab.string=game.Lang.get(51618,t.lv),e.powerLab.string=game.Lang.get(1008,t.fightAmount)},battleBtn:function(){this.data&&this.data.info&&this.send(game.TeamEvts.V2C_TEAM_CHANGE_BATTLE_PARTNER_REQ,this.data.info)}}),b8e.RC("$$game","$$TeamSelectPartnerListItem",e)}(),function(){var e;e=game.View.extends({bindModuleEnum:0,ctor:function(){this._super(1351)},init:function(){var e=this.skin,t=this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.TeamSelectPartnerListItem,t.bindEnum=this.bindModuleEnum,t.layout.paddingLeft=2,t.layout.paddingTop=0,t.layout.spacingX=0,t.layout.spacingY=5,t.addToParent(e.list)},onShow:function(){var e=this.getPartners();this._list.setData(e)},getPartners:function(){var e=game.partnerData.partnerSlots;if(!e||e.length<1)return null;this._partners?this._partners.length=0:this._partners=[];var t=void 0;switch(this.bindModuleEnum){case game.ME.CsTeam:t=game.csTeamData;break;case game.ME.GuildTeam:t=game.guildTeamData;break;case game.ME.WorldWarTeam:t=game.worldWarData;break;case game.ME.WorldWar2Team:t=game.worldWar2Data}for(var a=0,i=e.length,n=void 0;a<i;a++)(n=e[a])&&n.info&&!t.isInTeamPartner(n.id)&&this._partners.push(n);return this._partners}}),b8e.RC("$$game","$$TeamSelectPartnerView",e)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_CHANGE:-1,C2C_UPDATE_AUTOFIGHT:-1}),b8e.RC("$$game","$$CsEvts",e)}(),function(){var e=game.Control.extends({csAlert:null,init:function(){this.csAlert=game.spotAlert.set(game.SAE.CS_ALERT,game.SAE.HOME)},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},btn_3:function(){game.moduleOpen.checkOpenWithTips(game.ME.CsArrow)&&this.selectToggle(2)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.Cs,e,game.CsEvts,null)}(),function(){var e=game.View.extends({ctor:function(){this._super(181),this.toggles={toggle_btn_1:game.ME.CsTeam,toggle_btn_2:game.ME.CsBoss,toggle_btn_3:game.ME.CsArrowMain},this.spotAlerts={CS_TEAM_ALERT:this.csTeamAlert,CS_TEAM_DOUBLE_ALERT:this.csTeamDoubleAlert,CS_BOSS:this.csBossAlert,CS_ARROW:this.csArrowAlert}},csTeamAlert:function(e){this.skin.red_spot_1.node.active=e.alert},csTeamDoubleAlert:function(e){this.skin.double_spot.node.active=e.alert},csBossAlert:function(e){this.skin.red_spot_2.node.active=e.alert},csArrowAlert:function(e){this.skin.red_spot_3.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},toggleSelect:function(e){this._super(e)&&(this.skin.titile_sp.node.active=0==e)},onShow:function(){}});b8e.module.registerView(game.ME.Cs,e)}(),function(){var e;e=b8e.Enum({None:0,GOTO:-1,RANK:-1,RULE:-1,C2C_CSWAR_GOTO:-1,C2C_GUANDU_GOTO:-1,C2C_THRONE_GOTO:-1,C2C_GUILDWAR_GOTO:-1,C2C_TREASURE_GOTO:-1,V2C_GOTO_SHOP:-1}),b8e.RC("$$game","$$CsActivityEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.CS_ACTIVITY_ALERT,game.SAE.ACTIVITIES_HALL)},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily}}},resetDaily:function(){game.activitiesHallData.resetCsAct(),game.ThroneRankCfg.resetDaily()},notify:function(e,t){switch(e){case this.Evts.GOTO:this.gotoByEnum(t);break;case this.Evts.RANK:var a=this.getRankEnum(t);game.module.show(a);break;case this.Evts.RULE:game.RuleView.inst().showView(t);break;case this.Evts.V2C_GOTO_SHOP:this.dptG(game.ShopGEvts.SHOW_SHOP,t)}},getRankEnum:function(e){var t=game.ME;switch(e){case t.CsWar:return t.CsWarRank;case t.GuanDu:return t.GuanDuRank;case t.Throne:return t.ThroneMonthlyRank;case t.GuildWar:return t.GuildWarAward;case t.CsBoss:return t.CsBossAward;default:b8e.warn("\u6ca1\u6709\u53ef\u9009\u7684\u6392\u884c\u6a21\u5757\u679a\u4e3e")}return 0},gotoByEnum:function(e){var t=this,a=game.ME;switch(e){case a.CsWar:t.dpt(t.Evts.C2C_CSWAR_GOTO);break;case a.GuanDu:t.dpt(t.Evts.C2C_GUANDU_GOTO);break;case a.Throne:t.dpt(t.Evts.C2C_THRONE_GOTO);break;case a.GuildWar:t.dpt(t.Evts.C2C_GUILDWAR_GOTO);break;case a.CSTreasure:t.dpt(t.Evts.C2C_TREASURE_GOTO);break;case a.CsArrowMain:game.module.show(a.CsArrowMain);break;case a.CsBoss:game.module.show(a.CsBoss);break;default:b8e.warn("\u6ca1\u6709\u53ef\u9009\u7684\u524d\u5f80\u6a21\u5757\u679a\u4e3e")}}});b8e.module.registerControl(game.ME.CsActivity,e,game.CsActivityEvts)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,_alert:!1,ctor:function(){this._super(182),this.setSize(599,188)},init:function(){this.bindEnum=game.ME.ActivitiesHall;var e=this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ShowItemListItem,e.layout.paddingLeft=-10,e.layout.paddingTop=10,e.layout.spacingX=15,e.addToParent(this.skin.scrollview);var t=this.sprite=b8e.Sprite.get();t.addToParent(this.skin.bg),t.setAnchor(0,1)},setData:function(){var e=this,t=e.data;if(e.cfg=t.getCfg(),e.cfg){e.skin.timeDescLab.string=e.cfg.desc,e.sprite.loadTexture(game.ResCfg.getImgUrl(e.cfg.bgRes)),e.skin.name.string=e.cfg.name,e.skin.alert.active=t.isOpen,e.skin.rankAlert.active=t.rankAlert;var a=t.cfg;if(e._btnCustomizeImg){e._btnCustomizeImg.unloadTexture()}else e._btnCustomizeImg=b8e.Sprite.get(),e._btnCustomizeImg.setAnchor(.5,.5),e._btnCustomizeImg.addToParent(e.skin.rankBtn);if(a.btnShopRes){e._btnCustomizeImg.loadTexture(game.ResCfg.getImgUrl(a.btnShopRes)),e.skin.rankBtn.active=!0}else e.skin.rankBtn.active=!1;var i=e.getPrizeInfo();e._prizeList.setData(i)}},getPrizeInfo:function(){var e=this.cfg;if(e&&e.isShow){var t=game.activitiesHallData.getShowCfgById(e.id);if(t)return t.prizeListInfo||(t.prizeListInfo=game.CfgUtil.getPrizeListInfo(t.showItems,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84)),t.prizeListInfo.items}},gotoBtn:function(){if(this.cfg){var e=this.cfg;if(game.moduleOpen.checkOpenWithTips(e.moduleId))if(this.data.checkOpen()||8==this.data.id)this.send(game.CsActivityEvts.GOTO,e.moduleId);else{var t=this.getStrByDAT(e.openTime,e.openDay);game.notice.show(t)}}},getStrByDAT:function(e,t){if(this.data.openStr)return this.data.openStr;var a=e.length,i=t.length;if(a<1||i<1)return"";for(var n="",s=0,o="\u3001";s<i;s++){var r=t[s];s==i-1&&(o=""),n=n+b8e.TimeUtil.getDayString(r)+o}for(n+=o=" ",s=0;s<a;s++){var g=e[s];n=n+b8e.TimeUtil.formatTimestamp(b8e.TimeUtil.dateParse(g.Start,"hhmm").getTime(),"h:m")+o}return this.data.openStr=game.Lang.get(9491,n),this.data.openStr},rankBtn:function(){this.cfg&&this.send(game.CsActivityEvts.RANK,this.cfg.moduleId)},ruleBtn:function(){this.cfg&&this.send(game.CsActivityEvts.RULE,this.cfg.moduleId)},shopBtn:function(){}}),b8e.RC("$$game","$$CsActivityItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(183)},init:function(){var e=this.gridList=new game.List;e.itemRender=game.CsActivityItem,e.addToParent(this.skin.scrollGrid),e.layout.spacingY=5,e.bindEnum=game.ME.CsActivity},notify:function(e){e},onShow:function(){this.list=game.activitiesHallData.getCsActivityInfos(),this.gridList.setData(this.list)},onHide:function(){},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CsActivity,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_CHANGE_POWER:-1,C2V_UPDATE_LIST:-1,V2C_CHECK_POWER:-1}),b8e.RC("$$game","$$CsWarBattleTeamEvts",e)}(),function(){var e;e=b8e.Enum({None:0,MOVE:-1,C2C_OCCUPY_NONE:-1,C2C_OCCUPY_SAME_CAMP:-1,C2C_OCCUPY_DIFFERENT:-1,C2V_UPDATE_SCORE:-1,C2C_UPDATE_STATE:-1,C2C_UPDATE_OPEN_STATE:-1,C2C_INIT_CS_WAR_DATA:-1,C2C_UPDATE_CS_MINE_STATE:-1,C2V_UPDATE_LOG:-1,V2C_SHOW_LOG_VIEW:-1,C2V_UPDATE_CAMERA_SETTING:-1,C2C_UPDATE_CAMERA_SETTING:-1,C2C_LEAVE_CS_WAR:-1,C2V_MINE_TEAM_UPDATE:-1,C2V_LEVEL_CHANGE:-1,C2V_POWER_CHANGE:-1,C2V_UPDATE_OPEN_STATE:-1,C2V_UPDATE_CAMP_SCORE:-1,C2C_LEAVE_CSWAR:-1,C2C_UPDATE_TEAM_STATE:-1,C2V_UPDATE_TEAM_STATE:-1,C2C_LOOK_PLAYERINFO:-1,C2V_FOLLOW_CHAT:-1,C2C_UPDATE_SHOP_COUNT:-1}),b8e.RC("$$game","$$CsWarEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_LOG:-1,V2C_SHOW_VIEW:-1}),b8e.RC("$$game","$$CsWarLogEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_CHANGE_PAGE:-1,V2C_SHOW_VIEW:-1,C2V_SHOW_VIEW:-1,C2V_INIT_DATA:-1}),b8e.RC("$$game","$$CsWarRankEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_LIST:b8e.enc(),C2V_CHANGE_POWER:b8e.enc(),C2V_UPDATE_BATTLE_LIST:b8e.enc(),V2C_CHECK_POWER:b8e.enc(),C2V_UPDATE_CHALLENGE_LIST:b8e.enc(),C2V_CREATE_TEAM:b8e.enc(),C2C_CREATE_TEAM:b8e.enc(),C2V_JOIN_TEAM:b8e.enc(),C2C_JOIN_TEAM:b8e.enc(),C2V_JOIN_TEAM_NOTIFY:b8e.enc(),C2C_JOIN_TEAM_NOTIFY:b8e.enc(),C2V_LEAVE_TEAM:b8e.enc(),C2C_LEAVE_TEAM:b8e.enc(),C2V_LEAVE_TEAM_NOTIFY:b8e.enc(),C2C_LEAVE_TEAM_NOTIFY:b8e.enc(),C2V_KICK_TEAM:b8e.enc(),C2C_KICK_TEAM:b8e.enc(),C2C_UPDATE_TEAM_STATE:b8e.enc(),V2C_KICK_MEMBER:b8e.enc(),V2C_JOIN_TEAM:b8e.enc(),C2C_CHALLENGE_TEAM:b8e.enc(),ENTER_BATTLE_AREA:b8e.enc(),V2C_LOOK_TEAM_LIST:b8e.enc(),C2C_GUANDU_LOOT:b8e.enc(),C2C_HIDE_TEAMBTN:b8e.enc(),V2C_REQ_TEAM_DATA:b8e.enc(),C2C_REQ_TEAM_DATA:b8e.enc()}),b8e.RC("$$game","$$CsWarTeamEvts",e)}(),function(){var e=b8e.Object.extends({sceneUnitDatas:null,sceneUnitMap:null,ctor:function(){this._super(),this.tempList=[]},getSceneUnitData:function(e){return this.sceneUnitDatas?this.sceneUnitDatas.get(e):null},setSceneUnitMap:function(e){var t=this;t.sceneUnitMap||(t.sceneUnitMap=b8e.HashMap.get()),t.sceneUnitDatas||(t.sceneUnitDatas=b8e.HashMap.get()),t.sceneTeamMap||(t.sceneTeamMap=b8e.HashMap.get());var a=game.SceneUnitType,i=t.sceneUnitDatas.get(e.id);if(i){if(i.sceneUnitType==a.PLAYER&&0<i.teamId&&0==e.player.teamId)if((s=t.sceneTeamMap.get(i.teamId))&&0<s.length){var n=s.indexOf(i.idx);-1<n&&s.splice(n,1)}i.setSceneUnitInfo(e)}else(i=game.SceneUnitInfo.get()).setSceneUnitInfo(e),t.sceneUnitDatas.set(i.idx,i);switch(i.sceneUnitType){case a.PLAYER:i.roleId==game.mainRoleData.id&&(game.csWarData.myMineUnitId=i.mineUnitId,game.csWarData.mySceneIdx=i.idx,game.csWarData.mineCamp=i.camp);var s,o=i.teamLeader,r=i.teamId;if(0<o)o==i.roleId&&0==i.mineUnitId?t.sceneUnitMap.set(i.idx,i):t.sceneUnitMap.del(i.idx),(s=t.sceneTeamMap.get(r))||(s=[],t.sceneTeamMap.set(r,s)),s.indexOf(i.idx)<0&&s.push(i.idx);else 0==i.mineUnitId&&t.sceneUnitMap.set(i.idx,i);break;case a.MONSTER:case a.BOX:t.sceneUnitMap.set(i.idx,i);break;case a.MINE:0<i.master&&t.sceneUnitMap.del(i.master),t.sceneUnitMap.set(i.idx,i)}return i},sceneFollow:function(e,t,a){var i=this;i.tempList.length=0;var n=i.getSceneUnitData(e);if(n){if(n.sceneUnitType!=game.SceneUnitType.PLAYER)return i.tempList;var s;if((r=i.sceneTeamMap.get(n.teamId))&&0<r.length&&-1<(s=r.indexOf(n.idx))&&r.splice(s,1),i.tempList.push(e),0==t){if(i.tempList.push(n.teamLeader),0!=n.teamId&&n.teamId==a){if(r){if(0<r.length&&-1<(s=r.indexOf(n.teamLeader))){r.splice(s,1);var o=i.getSceneUnitData(n.teamLeader);o&&o.clearTeamInfo()}r.push(n.idx),n.setTeamInfo(a,n.idx)}}else 0<a?((r=i.sceneTeamMap.get(a))||(r=[],i.sceneTeamMap.set(a,r)),n.setTeamInfo(a,n.idx)):n.clearTeamInfo();0==n.mineUnitId&&i.sceneUnitMap.set(n.idx,n)}else{var r,g=i.getSceneUnitData(t);if(!g)return b8e.error("\u573a\u666f\u4e2d\u6ca1\u6709\u8be5id\u7684\u73a9\u5bb6\u6570\u636e"),i.tempList;if(!a)return b8e.error("unitId:"+e+"\u8bd5\u56fe\u8ddf\u968f\u4e00\u4e2a\u6ca1\u6709\u961f\u4f0d\u7684\u73a9\u5bb6,targetUnitId::"+t),i.tempList;(r=i.sceneTeamMap.get(a))||(r=[],i.sceneTeamMap.set(a,r)),g.setTeamInfo(a,t),n.setLeaderInfo(g),0==g.mineUnitId&&i.sceneUnitMap.set(g.idx,g),i.sceneUnitMap.del(n.idx),r.indexOf(n.idx)<0&&r.push(n.idx),r.indexOf(g.idx)<0&&r.push(g.idx),i.tempList.push(t)}}else b8e.error("\u573a\u666f\u4e2d\u6ca1\u6709\u8be5\u73a9\u5bb6\u4fe1\u606f,unitId:"+e);return n.roleId==game.mainRoleData.id&&(game.csWarData.myMineUnitId=n.mineUnitId),i.tempList},moveNotify:function(e,t,a){this.tempList.length=0;var i=this.getSceneUnitData(e);if(i){i.mineUnitId=0;var n=i.teamId;if(0<n){var s=this.getTeamListById(n);if(s&&0<s.length)for(var o=s.length,r=0;r<o;r++){var g=s[r];if(g!=e){var l=this.getSceneUnitData(g);l&&(l.mineUnitId=0,l.setPosition(t,a))}}}this.sceneUnitMap.get(e)||(this.sceneUnitMap.set(e,i),this.tempList.push(e))}return this.tempList},sceneLeaveNotify:function(e){this.tempList.length=0;var t=this.getSceneUnitData(e);if(!t)return this.tempList;if(0<t.teamId&&t.teamLeader!=e){this.tempList.push(t.teamLeader);var a=this.sceneTeamMap.get(t.teamId);if(a&&0<a.length){var i=a.indexOf(t.idx);-1<i&&a.splice(i,1)}}return this.sceneUnitDatas.del(e),this.sceneUnitMap.del(e),this.tempList},moveToPosNotify:function(e,t,a){var i=this;i.tempList.length=0;var n=i.getSceneUnitData(e);if(!n||n.sceneUnitType!=game.SceneUnitType.PLAYER)return i.tempList;if(i.tempList.push(e),0<n.teamId&&n.teamLeader==n.idx){var s=i.sceneTeamMap.get(n.teamId);if(s&&0<s.length)for(var o=s.length,r=0;r<o;r++){var g=s[r];if(g!=e){var l=i.getSceneUnitData(g);l&&l.setPosition(t,a),i.tempList.push(g)}}}return i.sceneUnitMap.set(n.idx,n),n.setPosition(t,a),n.mineUnitId=0,n.roleId==game.mainRoleData.id&&(i.tempList.push(game.csWarData.myMineUnitId),game.csWarData.myMineUnitId=n.mineUnitId),i.tempList},selfMove:function(){var e=this;e.tempList.length=0,game.csWarData.myMineUnitId=0;var t=game.csWarData.mySceneIdx,a=e.getSceneUnitData(t);if(!a)return e.tempList;var i=a.teamId,n=a.teamLeader;if(0<i){var s,o=e.getTeamListById(i);if(o&&0<o.length){for(var r=o.length,g=0;g<r;g++){var l=o[g];(s=e.getSceneUnitData(l))&&(s.mineUnitId=0)}var c=e.getSceneUnitData(n);c&&(e.sceneUnitMap.set(n,c),e.tempList.push(n))}}else a.mineUnitId=0,e.sceneUnitMap.set(t,a),e.tempList.push(t);return e.tempList},updatePlayerOccupyData:function(e,t){var a=this;a.tempList.length=0;var i=a.getSceneUnitData(t);if(!i)return a.tempList;if(0<i.teamId){var n=a.sceneTeamMap.get(i.teamId);if(n&&0<n.length)for(var s=n.length,o=0;o<s;o++){var r=n[o],g=a.getSceneUnitData(r);g&&(g.mineUnitId=e,a.sceneUnitMap.del(r),a.tempList.push(r),g.roleId==game.mainRoleData.id&&(game.csWarData.myMineUnitId=g.mineUnitId))}}else i.mineUnitId=e,a.sceneUnitMap.del(t),a.tempList.push(t),i.roleId==game.mainRoleData.id&&(game.csWarData.myMineUnitId=i.mineUnitId);return a.tempList},updatePos:function(e,t,a){var i=this.getSceneUnitData(e);if(i&&i.sceneUnitType==game.SceneUnitType.PLAYER){if(0<i.teamId&&i.teamLeader==i.idx){var n=this.sceneTeamMap.get(i.teamId);if(n&&0<n.length)for(var s=n.length,o=0;o<s;o++){var r=n[o];if(r!=e){var g=this.getSceneUnitData(r);g&&g.setPosition(t,a)}}}i.setPosition(t,a)}},getTeamListById:function(e){return this.sceneTeamMap?this.sceneTeamMap.get(e):null},clearSceneData:function(){this.sceneUnitMap&&this.sceneUnitMap.clear(),this.sceneUnitDatas&&this.sceneUnitDatas.clear(),this.sceneTeamMap&&this.sceneTeamMap.clear()}});game.csSceneData=game.csSceneData||new e}(),function(){var e;e=b8e.Enum({NONE:0,WEI:1,SHU:2,WU:3}),b8e.RC("$$game","$$CsWarCampType",e)}(),function(){var e;e=b8e.Enum({NONE:0,ENTER_BATTLE:1001,ENTER_ARE_YUAN:5001,ENTER_AREA_CAO:5002,ENTER_YUAN_FIGHT:5003,ENTER_YUAN_FLAG:5004,ENTER_YUAN_BLOOD:5005}),b8e.RC("$$game","$$CsEventAreaEnum",e)}(),function(){var e=b8e.Object.extends({state:!1,startState:1,remTime:0,myScore:0,campScore1:0,campScore2:0,campScore3:0,endCampScore1:0,endCampScore2:0,endCampScore3:0,PER_PAGE_COUNT:6,pageMaxCount:1,pageNum:1,mineTime:0,maxMineCount:4,mineNeedTime:30,mineRank:0,isCameraFollow:!0,preMineId:0,_myMineUnitId:0,myMineUnitId:{set:function(e){this._myMineUnitId=e},get:function(){return this._myMineUnitId}},enterTime:0,mySceneIdx:0,mineCamp:0,isInBattleArea:!1,ctor:function(){this.ranks=[],this.rankPool=[],this.showPageList=[],this.warAlert=!1,this.rankAlert=!1,this.logAlert=!1,this.isOpening=!1},sysData:function(e){var t,a,i=this;i.state=e.state,i.ranks.length=0;for(var n=e.ranks.length,s=game.LoginConfig.serverId,o=0;o<n;o++)t=e.ranks[o],i.rankPool[o]||(i.rankPool[o]=new game.CsWarRankInfo),t.zone==s&&(i.mineRank=t.rank),(a=i.rankPool[o]).setData(t),i.ranks.push(a);i.pageNum=1,0<i.ranks.length?i.pageMaxCount=Math.ceil(i.ranks.length/i.PER_PAGE_COUNT):i.pageMaxCount=1},getRankInfoList:function(){var e=this;if(e.pageNum<=0&&(e.pageNum=1),!e.ranks||e.ranks.length<1)return null;var t=e.PER_PAGE_COUNT;e.showPageList.length=0;var a=(e.pageNum-1)*t,i=e.pageNum*t,n=e.ranks.length;i=Math.min(i,n);if(a<n)for(var s=a;s<i;s++){var o=e.ranks[s];o&&e.showPageList.push(o)}return e.showPageList},gotoNextRankPage:function(){this.pageNum<1&&(this.pageNum=1);var e=this.PER_PAGE_COUNT;this.pageNum*e<this.ranks.length&&this.pageNum++},gotoPerRankPage:function(){this.pageNum<1&&(this.pageNum=1),1<this.pageNum&&this.pageNum--},crossWarStateNotify:function(e){this.startState=e.state,this.remTime=e.remTime,this.remTimeStamp=game.SysTime.curTime+1e3*this.remTime},crossWarScoreNotify:function(e){this.myScore=e.myScore,this.campScore1=e.campScore1,this.campScore2=e.campScore2,this.campScore3=e.campScore3},setMineTime:function(e){this.spaceTime||(this.spaceTime=3e4);var t=game.SceneUnitCfg.getData(e);t&&(this.spaceTime=1e3*t.param2),this.mineTime=game.SysTime.curTime+this.spaceTime},setEnterTime:function(){this.enterSpaceTime||(this.enterSpaceTime=6e4),this.enterTime=game.SysTime.curTime+this.enterSpaceTime},getEndTime:function(){var e=game.CsMiscCfg.getData("crossWarTime");return!(!e||""==e.value)&&(this.crossWarTimeArr=e.value.split("-"),!this.crossWarTimeArr||this.crossWarTimeArr.length<2?0:b8e.TimeUtil.dateParse(this.crossWarTimeArr[1],"hh:mm").getTime())},setIsOpen:function(e,t,a){null!=e&&(this.warAlert=e),null!=t&&(this.rankAlert=t),null!=a&&(this.logAlert=a),this.isOpening=this.warAlert||this.rankAlert||this.logAlert}});game.csWarData=game.csWarData||new e}(),function(){var e=b8e.Object.extends({ctor:function(){this.logsInfoList=[]},setCsWarLogList:function(e,t,a,i){var n;n=19<this.logsInfoList.length?this.logsInfoList.pop():new game.CsWarLogInfo,this.logsInfoList&&(n.type=e,n.time=t,n.name=a,n.win=i.win,n.battlelog=i,this.logsInfoList.push(n)),this.logsInfoList.sort(this.onLogsSort)},getLogs:function(){return this.logsInfoList},onLogsSort:function(e,t){return t.time-e.time}});game.csWarLogData=game.csWarLogData||new e}(),function(){var e;e=b8e.Object.extends({type:0,time:0,name:"",win:!1,battlelog:null,ctor:function(){this._super()},setData:function(e){this.type=e.type,this.time=e.time,this.name=e.name,this.win=e.win,this.battlelog=this.battlelog}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsWarLogInfo",e)}(),function(){var e;e=b8e.Enum({ATTACK:0,DEFEND:1}),b8e.RC("$$game","$$CsWarLogType",e)}(),function(){var e;e=b8e.Object.extends({zone:0,score:0,rank:0,ctor:function(){this._super()},setData:function(e){this.zone=e.zone,this.score=e.score,this.rank=e.rank},getPrizeList:function(){if(this.prizeList)return this.prizeList;if(this.prizeList=[],this.cfg=game.CrossWarRankAwardCfg.getDataByRank(this.rank),!this.cfg)return null;var e=this.cfg.items;if(e&&0<e.length)for(var t,a,i=e.length,n=0;n<i;n++)t=e[n],(a=new game.PrizeInfo).setData(t.Id,t.Num,game.IconLayoutEnum.SHOW_NUM),this.prizeList.push(a);return this.prizeList}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsWarRankInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,READY:1,SEIZE:2}),b8e.RC("$$game","$$CsWarState",e)}(),function(){var e=b8e.Object.extends({isInTeam:!1,isLeader:!1,mineCamp:0,mineMaster:0,maxMemberCount:3,teamId:0,powerLimit:0,canTeam:!0,challengeId:0,isShowView:!1,recruitTime:0,occupiedMemberList:null,ctor:function(){this._super(),this.teamList=[],this.teamPool=[],this.memberList=[],this.challengeList=[],this.occupiedMemberList=[],this.memberMap=b8e.HashMap.get()},setTeamList:function(e){if(this.teamList.length=0,e&&!(e.length<1))for(var t,a,i=e.length,n=0;n<i;n++)t=e[n],this.teamPool[n]||(this.teamPool[n]=new game.CsWarTeamInfo),(a=this.teamPool[n]).setData(t),this.teamList.push(a)},setChallengeTeam:function(e,t,a,i){var n,s;if(this.clearChallengeTeam(),this.challengeId=e,this.challengeHp=a,this.challengeMaxHp=i,t)for(var o=t.members.length,r=0;r<o;r++)n=t.members[r],(s=game.CsWarTeamMemberInfo.get()).setData(n,!1),this.challengeList.push(s)},createTeam:function(e){var t,a;this.isInTeam=!0,this.isLeader=!0,this.teamId=e.id,this.powerLimit=e.powerLimit,this.mineMaster=game.mainRoleData.id;for(var i=e.members.length,n=0;n<i;n++)t=e.members[n],(a=game.CsWarTeamMemberInfo.get()).setData(t,this.isLeader),this.memberMap.set(a.id,a),this.memberList.push(a);this.canTeam=!1},setMineTeamData:function(e){var t=e.members;if(t&&!(t.length<1)){for(var a=t.length,i=0;i<a;i++){var n=t[i],s=this.memberMap.get(n.id);s&&s.setData(n,this.isLeader)}game.csTreasureData.isTreasureScene()&&this._updateTeamMemberList(e)}},_updateTeamMemberList:function(e){if(this.memberList&&!(this.memberList.length<1))for(var t=e.members,a=t.length,i=void 0,n=void 0,s=0;s<a;s++)if(i=t[s])for(var o=0;o<this.memberList.length;o++)if((n=this.memberList[o])&&i.id==n.id){n.keys=i.keys;break}},joinTeam:function(e){var t,a;this.isInTeam=!0,this.isLeader=!1,this.teamId=e.id,this.powerLimit=e.powerLimit;for(var i=e.members.length,n=0;n<i;n++)t=e.members[n],(a=game.CsWarTeamMemberInfo.get()).setData(t,this.isLeader),this.memberMap.set(a.id,a),this.memberList.push(a),t.isLeader&&(this.mineMaster=t.id);this.canTeam=!1},joinTeamNotify:function(e){var t=game.CsWarTeamMemberInfo.get();t.setData(e,this.isLeader),this.memberList.push(t)},LeaveTeamNotify:function(e,t){var a,i=this,n=i.memberList.length,s=game.mainRoleData.roleId,o=game.sceneData.getSceneType();if(e==s&&i.isInTeam)i.clearTeamData();else{0<t&&(o===game.SceneType.GUANDU_MAP?i.isLeader=game.mainRoleData.roleId==t:i.isLeader=s==t,i.mineMaster=t);for(var r=-1,g=0;g<n;g++)(a=i.memberList[g]).id==e?(game.CsWarTeamMemberInfo.put(a),r=g):(o===game.SceneType.GUANDU_MAP?i.isLeader&&(a.isKick=a.id!=game.mainRoleData.roleId):i.isLeader&&(a.isKick=a.id!=s),0!=t&&a.id==t&&(a.isLeader=!0));-1<r&&i.memberList.splice(r,1)}},leaveTeam:function(){this.clearTeamData()},kickTeam:function(e){for(var t,a=this.memberList.length,i=0;i<a;i++)if((t=this.memberList[i]).id==e){game.CsWarTeamMemberInfo.put(t),this.memberList.splice(i,1);break}},getTeamList:function(){return this.teamList.sort(this.onSortTeam),this.teamList},onSortTeam:function(e,t){return 3<=e.memberCount?1:3<=t.memberCount?-1:e.powerLimit>game.mainRoleData.power?1:t.powerLimit>game.mainRoleData.power?-1:e.id-t.id},getMineTeam:function(){return this.memberList},getChallengeTeam:function(){return this.challengeList},count:{get:function(){return this.memberList.length}},setCanTeam:function(e){var t=0<arguments.length&&void 0!==e&&e;this.canTeam=t},setRecruitTime:function(){this.recruitSpaceTime||(this.recruitSpaceTime=5e3),this.recruitTime=game.SysTime.curTime+this.recruitSpaceTime},clearTeamData:function(){var e=this;if(e.isInTeam=!1,e.isLeader=!1,e.memberList&&0<e.memberList.length){for(var t,a=e.memberList.length,i=0;i<a;i++)t=e.memberList[i],game.CsWarTeamMemberInfo.put(t);e.memberList.length=0}e.canTeam=!0,e.mineMaster=0,e.teamId=0},clearChallengeTeam:function(){for(var e,t=this.challengeList.length,a=0;a<t;a++)e=this.challengeList[a],game.CsWarTeamMemberInfo.put(e);this.challengeList.length=0},clearOccupiedTeam:function(){for(var e,t=this.occupiedMemberList.length,a=0;a<t;a++)e=this.occupiedMemberList[a],game.CsWarTeamMemberInfo.put(e);this.occupiedMemberList.length=0},setTeamInfo:function(e){var t,a,i=this;i.clearTeamData(),i.isInTeam=!0,i.teamId=e.id,i.powerLimit=e.powerLimit;for(var n=e.members.length,s=0;s<n;s++)t=e.members[s],(a=game.CsWarTeamMemberInfo.get()).setData(t,i.isLeader),i.memberMap.set(a.id,a),i.memberList.push(a),t.isLeader&&(i.mineMaster=t.id);i.isLeader=i.mineMaster==game.mainRoleData.id,i.canTeam=!1},setOccupiedMember:function(e){this.clearOccupiedTeam();for(var t,a,i=e.length,n=0;n<i;n++)t=e[n],(a=game.CsWarTeamMemberInfo.get()).setData(t,!1),this.occupiedMemberList.push(a)}});game.csWarTeamData=game.csWarTeamData||new e}(),function(){var e;e=b8e.Object.extends({id:0,powerLimit:0,memberCount:0,name:"",ctor:function(){this._super()},setData:function(e){this.id=e.id,this.powerLimit=e.powerLimit,this.memberCount=e.count,this.name=e.name}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsWarTeamInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({_objName:"CsWarTeamMemberInfo",ctor:function(){this.constructor===t&&(t.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(),this.clearData()},setData:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=this;i.name=e.name,i.level=e.level,i.power=e.power,i.isMale=e.isMale,i.isLeader=e.isLeader,i.isKick=a&&!e.isLeader,i.id=e.id,i.hp=e.hp,i.maxHp=e.maxHp,i.keys=e.keys},clearData:function(){var e=this;e.id=0,e.name="",e.level=0,e.power=0,e.isMale=!1,e.leader=!1,e.isLeader=!1,e.isKick=!1,e.hp=0,e.maxHp=0,e.keys=0},recycle:function(){this.clearData(),this._super()}});b8e.BindingUtil.bind(t);var a=new b8e.Pool(t,6);t.get=function(){return a.get()},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$CsWarTeamMemberInfo",e)}(),function(){var e=game.Control.extends({init:function(){this._alertOptions={lang:3707,okcb:this.onOccupyGameAlert,thisArg:this},this.csWarAlert=game.spotAlert.set(game.SAE.CS_WAR_ALERT,game.SAE.CS_ACTIVITY_ALERT),this.csWarRankAlert=game.spotAlert.set(game.SAE.CS_WAR_RANK_ALERT,game.SAE.CS_ACTIVITY_ALERT),this.csWarLogAlert=game.spotAlert.set(game.SAE.CS_WAR_LOG_ALERT,game.SAE.CS_ACTIVITY_ALERT),this.chat={chatType:game.ChatChannelType.CROSS,marqueeKey:"cs_war_open",funcType:game.ChatFuncType.CHAT_FUNC_CS_WAR}},ipc:function(){var e=this;e.evts={CsActivity:{C2C_CSWAR_GOTO:e.joinCrossWar},CsWarTeam:{C2C_CREATE_TEAM:e.updateTeam,C2C_JOIN_TEAM:e.updateTeam,C2C_LEAVE_TEAM:e.updateTeam,C2C_LEAVE_TEAM_NOTIFY:e.updateTeam,C2C_CHALLENGE_TEAM:e.challengeTeam,C2C_REQ_TEAM_DATA:e.reqTeamData},CsWarRank:{C2V_SHOW_VIEW:e.showRankView},MainUIChat:{C2C_REQ_ENTER_CS_WAR:e.joinCrossWar,C2C_REQ_GOTO_CS_WAR:e.reqGoto},MainRole:{C_RESET_DAILY:e.resetDaily}},e.gevts={CsWarTeamEvts:{C2C_REQ_TEAM_DATA:e.reqTeamData}},e.handels={CrossWarDataResp:e.crossWarDataResp,CrossWarJoinResp:e.crossWarJoinResp,CrossWarStateMsg:e.crossWarStateMsg,CrossWarDataMsg:e.crossWarDataMsg,CrossWarChallengeResp:e.crossWarChallengeResp,CrossWarBattleMsg:e.crossWarBattleMsg,CrossWarMsg:e.crossWarMsg,CrossWarMineMsg:e.crossWarMineMsg,CrossWarChallengeMsg:e.crossWarChallengeMsg,CrossWarOccupyMsg:e.crossWarOccupyMsg,CrossWarReturnToCampResp:e.crossWarReturnToCampResp}},crossWarDataResp:function(e){var t=e.readProtobuf(game.pb.CrossWarDataResponse);game.csWarData.sysData(t),game.csWarData.state&&this.checkActivityAlert(!0),this.dpt(this.Evts.C2C_INIT_CS_WAR_DATA)},crossWarJoinResp:function(e){var t=e.readProtobuf(game.pb.CrossWarJoinResponse);0<t.code?game.notice.noticeError(t.code):(game.module.hide(game.ME.ActivitiesHall),game.csWarTeamData.clearTeamData())},crossWarStateMsg:function(e){var t=this,a=e.readProtobuf(game.pb.CrossWarStateNotify);game.csWarData.crossWarStateNotify(a),0==game.csWarData.startState?(game.csWarData.endCampScore1=a.campScore1,game.csWarData.endCampScore2=a.campScore2,game.csWarData.endCampScore3=a.campScore3,game.alert.hide(),game.module.show(game.ME.CsWarEnd),b8e.Tween.kill(t),b8e.Tween.get(t).wait(1e3).call(t.sender.CrossWarDataReq),t.checkActivityAlert(!1),t.end=!0):t.end||(t.sendCsWarOpenChat(),t.end=!0),t.dpt(t.Evts.C2C_UPDATE_STATE),t.send(t.Evts.C2V_UPDATE_OPEN_STATE)},crossWarDataMsg:function(e){var t=e.readProtobuf(game.pb.CrossWarDataNotify);game.csWarData.crossWarScoreNotify(t),this.send(this.Evts.C2V_UPDATE_SCORE),this.send(this.Evts.C2V_UPDATE_CAMP_SCORE)},crossWarChallengeResp:function(e){var t=e.readProtobuf(game.pb.CrossWarChallengeResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.targetUnitId,i=t.battlelog;if(i){i.win?(game.csWarData.myMineUnitId=a,game.notice.show(3708),this.sendCsWarSelfChat(a,"cs_war_snatch")):(game.csWarData.myMineUnitId=0,game.notice.show(3709),game.csWarData.isCameraFollow=!0,this.updateCameraFollow());var n=game.csSceneData.getSceneUnitData(a);if(n&&n.master){var s=game.csSceneData.getSceneUnitData(n.master);s&&game.csWarLogData.setCsWarLogList(game.CsWarLogType.ATTACK,game.SysTime.curTime,s.name,i)}this.checkBattleLogAlert(!0),this.send(this.Evts.C2V_UPDATE_LOG)}else{game.csWarData.myMineUnitId=a;var o=game.csSceneData.getSceneUnitData(a);if(o){var r=game.csSceneData.getSceneUnitData(game.csWarData.mySceneIdx);r&&r.setPosition(o.x,o.y)}}game.GameLevelMgr.inst().crossWarChallengeEnd()}},crossWarBattleMsg:function(e){var t=e.readProtobuf(game.pb.CrossWarBattleNotify),a=t.challenger,i=t.battlelog;i.win&&(game.csWarData.myMineUnitId=0,this._alertOptions.okcb=null,this._alertOptions.lang=3710,this._alertOptions.langArgs=[a],this._alertOptions.btn=game.Lang.get(9112),game.alert.show(this._alertOptions),game.csWarData.isCameraFollow=!0,this.updateCameraFollow()),this.checkBattleLogAlert(!0),game.csWarLogData.setCsWarLogList(game.CsWarLogType.DEFEND,game.SysTime.curTime,a,i),this.send(this.Evts.C2V_UPDATE_LOG)},crossWarMsg:function(e){var t=this,a=e.readProtobuf(game.pb.CrossWarNotify).state;if(1==(game.csWarData.startState=a)||2==a){if(t.end||(t.sendCsWarOpenChat(),t.end=!0),game.moduleOpen.checkOpen(t.moduleEnum)){t.showQuick=!0,game.module.show(game.ME.CsWarQuickEntry),t.checkActivityAlert(!0);var i=game.csWarData.getEndTime()-game.SysTime.curTime;t.timer?t.timer.delay=i:t.timer=b8e.Timer.add(t,t.endTimeCb,i,1),t.timer.reset(),t.timer.start()}game.csWarData.state=!0}else game.csWarData.state=!1,t.checkActivityAlert(!1),t.checkRankAlert(!0);t.dpt(t.Evts.C2C_UPDATE_OPEN_STATE,a)},endTimeCb:function(){this.checkActivityAlert(!1)},crossWarMineMsg:function(e){var t=e.readProtobuf(game.pb.CrossWarMineNotify).score,a=game.csWarData;0!=t&&(a.myScore=t,this.sendCsWarSelfChat(a.myMineUnitId,"cs_war_occupy"));var i=game.csSceneData.getSceneUnitData(a.myMineUnitId);if(i){a.setMineTime(i.id);var n=b8e.scene.getDisplayByTypeAndId(game.RoleType.CsWarMine,a.myMineUnitId);n&&(n.updataRootBar(!0),n.updataProgress(!0))}this.dpt(this.Evts.C2V_UPDATE_SCORE)},crossWarChallengeMsg:function(e){var t=e.readProtobuf(game.pb.CrossWarChallengeNotify),a=t.targetUnitId,i=t.battlelog;if(i){i.win?(game.csWarData.myMineUnitId=a,game.notice.show(3708),this.sendCsWarSelfChat(a,"cs_war_snatch")):(game.csWarData.myMineUnitId=0,game.notice.show(3709),game.csWarData.isCameraFollow=!0,this.updateCameraFollow());var n=game.csSceneData.getSceneUnitData(a);n&&game.csWarLogData.setCsWarLogList(game.CsWarLogType.ATTACK,game.SysTime.curTime,n.name,i),this.checkBattleLogAlert(!0),this.send(this.Evts.C2V_UPDATE_LOG)}else game.csWarData.myMineUnitId=a},crossWarOccupyMsg:function(e){var t,a=e.readProtobuf(game.pb.CrossWarOccupyNotify),i=a.mineUnitId,n=a.playerUnitId,s="",o="";if(t=game.csSceneData.getSceneUnitData(i)){var r=game.SceneUnitCfg.getData(t.id);r&&(o=r.name)}(t=game.csSceneData.getSceneUnitData(n))&&t.camp==game.csWarData.mineCamp&&(s=t.name,this.sendCsWarGotoChat(s,o,i));var g=game.csSceneData.updatePlayerOccupyData(i,n);game.GameLevelMgr.inst().updateSceneUnit(g)},crossWarReturnToCampResp:function(){},triggerOpen:function(e){e==this.moduleEnum&&(this.showQuick||game.csWarData.state&&(game.module.show(game.ME.CsWarQuickEntry),this.checkActivityAlert(!0)))},notify:function(e,t,a,i){var n=this,s=n.Evts;switch(e){case s.C2C_OCCUPY_NONE:n._alertOptions.okcb=n.onOccupyGameAlert,n._alertOptions.lang=3707,n._alertOptions.args=[t,0],game.alert.showTwo(n._alertOptions);break;case s.C2C_OCCUPY_SAME_CAMP:n._alertOptions.okcb=n.onOccupyGameAlert,n._alertOptions.lang=3711,n._alertOptions.args=[t,a],n._alertOptions.langArgs=i,game.alert.showTwo(n._alertOptions);break;case s.C2C_OCCUPY_DIFFERENT:n._alertOptions.okcb=n.onLookPlayerInfo,n._alertOptions.lang=3712,n._alertOptions.args=[t],n._alertOptions.langArgs=a,game.alert.showTwo(n._alertOptions);break;case s.C2C_UPDATE_CAMERA_SETTING:game.csWarData.isCameraFollow=!game.csWarData.isCameraFollow,n.updateCameraFollow();break;case s.C2C_UPDATE_TEAM_STATE:game.csWarTeamData.setCanTeam(t),n.send(s.C2V_UPDATE_TEAM_STATE);break;case s.V2C_SHOW_LOG_VIEW:n.checkBattleLogAlert(!1)}},onOccupyGameAlert:function(e,t){t=t||0;this.sender.CrossWarChallengeReq(e,t)},onLookPlayerInfo:function(e){this.dpt(this.Evts.C2C_LOOK_PLAYERINFO,e)},returnCampBtn:function(){!game.csWarTeamData.isLeader&&game.csWarTeamData.isInTeam||(0<game.csWarData.myMineUnitId?(this._alertOptions.okcb=this.returnCamp,this._alertOptions.lang=3738,game.alert.showTwo(this._alertOptions)):this.sender.CrossWarReturnToCampReq())},checkBtn:function(){game.csWarData.isCameraFollow=!game.csWarData.isCameraFollow,this.updateCameraFollow()},exitBtn:function(){this._alertOptions.lang=718,this._alertOptions.okcb=this.onExitGameAlert,game.alert.showTwo(this._alertOptions)},onExitGameAlert:function(){this.dptG(game.SceneGEvts.SCENE_EXIT)},ruleBtn:function(){game.RuleView.inst().showView(this.moduleEnum)},teamBtn:function(){this.reqTeamData(),game.module.show(game.ME.CsWarBattleTeam)},reqTeamData:function(){var t=this,e=game.csWarTeamData.teamId;0<e&&(b8e.Tween.kill(t),b8e.Tween.get(t).wait(500).call(function(e){t.sender.SceneTeamDataReq(e)},t,[e]))},logBtn:function(){game.module.show(game.ME.CsWarLog)},headBtn:function(){},middleTeamBtn:function(){game.module.show(game.ME.CsWarTeam)},enterBtn:function(){this.joinCrossWar(),game.module.hide(game.ME.CsWarQuickEntry)},joinCrossWar:function(){if(game.moduleOpen.checkOpenWithTips(this.moduleEnum))if(game.csWarData.state)if(game.SysTime.curTime>game.csWarData.enterTime)this.sender.CrossWarJoinReq();else{var e=game.csWarData.enterTime-game.SysTime.curTime,t=game.TimeUtil.formatTimeSpace(e,1);game.notice.show(3721,t)}else game.notice.show(593)},returnCamp:function(){this.sender.CrossWarReturnToCampReq()},updateCameraFollow:function(){game.GameLevelMgr.inst().updateCameraFollow(),this.send(this.Evts.C2V_UPDATE_CAMERA_SETTING)},updateTeam:function(){this.send(this.Evts.C2V_UPDATE_TEAM_STATE)},challengeTeam:function(e){if(e&&e.data){var t=e.data,a=game.csSceneData.getSceneUnitData(t);if(a&&0!=a.mineUnitId){var i=game.csSceneData.getSceneUnitData(a.mineUnitId);i&&this.sender.CrossWarChallengeReq(i.idx,i.master)}}},showRankView:function(){this.reqRank||(this.sender.CrossWarDataReq(),this.reqRank=!0),this.checkRankAlert(!1)},resetDaily:function(){this.reqRank=!1},sendCsWarOpenChat:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.chat.params=null,this.chat.clientParams=null,this.chat.marqueeKey="cs_war_open",game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null))},sendCsWarGotoChat:function(e,t,a){this.chat.params=e+"|"+t,this.chat.clientParams=a,this.chat.marqueeKey="cs_war_goto",game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)},sendCsWarRecruitChat:function(e,t){this.chat.params=e,this.chat.clientParams=t,this.chat.marqueeKey="cs_war_recruit",game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)},sendCsWarSelfChat:function(e,t){var a,i,n,s,o="",r=game.csSceneData.getSceneUnitData(e);r&&(s=game.SceneUnitCfg.getData(r.id))&&(o=s.name,(n="cs_war_occupy"==t?s.items1:s.items2)&&0<n.length&&(a=n[0].Id,i=n[0].Num));if(a&&i&&(s=game.ItemInfoCfg.getData(a))){var g=game.HtmlUtil.getColorStrByQuality(s.quality,s.name,!0);this.chat.params=o+"|"+g+"|"+i,this.chat.clientParams=null,this.chat.marqueeKey=t,game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)}},reqGoto:function(e){if(e&&e.data){var t=e.data;game.GameLevelMgr.inst().gotoEntityById(t)}},checkActivityAlert:function(e){this.csWarAlert.alert=e,game.csWarData.setIsOpen(e,null,null)},checkBattleLogAlert:function(e){this.csWarLogAlert.alert=e,game.csWarData.setIsOpen(null,null,e)},checkRankAlert:function(e){this.csWarRankAlert.alert=e,game.csWarData.setIsOpen(null,e,null)}}),t=[game.ME.CsWarLeftBottom,game.ME.CsWarLeftTop,game.ME.CsWarMiddle,game.ME.CsWarRightTop,game.ME.CsWarRightBottom,game.ME.CsWarLog,game.ME.CsWarQuickEntry,game.ME.CsWarMinePre,game.ME.CsWarEnd],a=game.Sender.extends({ipc:function(){this.msg={CrossWarDataReq:null,CrossWarJoinReq:null,CrossWarChallengeReq:this.crossWarChallengeReq,SceneTeamDataReq:this.SceneTeamDataReq,CrossWarReturnToCampReq:null}},crossWarChallengeReq:function(e,t){var a=game.pb.CrossWarChallengeRequest;a.targetUnitId=e,a.master=t,this.write(a)},SceneTeamDataReq:function(e){var t=game.pb.SceneTeamDataRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.CsWar,e,game.CsWarEvts,a,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={CsWar:{C2C_INIT_CS_WAR_DATA:this.initCsWarData}}},notify:function(e){switch(e){case this.Evts.V2C_SHOW_VIEW:this.dpt(this.Evts.C2V_SHOW_VIEW)}},initCsWarData:function(){this.send(this.Evts.C2V_INIT_DATA)},leftBtn:function(){game.csWarData.gotoPerRankPage(),this.send(this.Evts.C2V_CHANGE_PAGE)},rightBtn:function(){game.csWarData.gotoNextRankPage(),this.send(this.Evts.C2V_CHANGE_PAGE)}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.CsWarRank,e,game.CsWarRankEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){var e=this;e.evts={MainUIChat:{C2C_REQ_RECRUIT_CS_WAR:e.reqRecruit,C2C_REQ_RECRUIT_GUANDU:e.reqRecruit,C2C_REQ_ENTER_GUILDWAR:e.reqRecruit},Scene:{CSWARTEAM_INFO:e.getCsWarTeam}},e.handels={SceneCreateTeamResp:e.sceneCreateTeamResp,SceneJoinTeamResp:e.sceneJoinTeamResp,SceneJoinTeamMsg:e.sceneJoinTeamMsg,SceneLeaveTeamResp:e.sceneLeaveTeamResp,SceneLeaveTeamMsg:e.sceneLeaveTeamMsg,SceneKickTeamResp:e.sceneKickTeamResp,SceneTeamDataResp:e.sceneTeamDataResp,SceneTeamListResp:e.sceneTeamListResp,SceneTeamPowerLimitResp:e.sceneTeamPowerLimitResp,SceneTeamRecruitResp:e.sceneTeamRecruitResp,SceneTeamResp:e.sceneTeamResp}},notify:function(e,t){var a=this;switch(e){case a.Evts.V2C_CHECK_POWER:a.alterPower=0|t,a.sender.SceneTeamPowerLimitReq(a.alterPower);break;case a.Evts.V2C_KICK_MEMBER:a.sender.SceneKickTeamReq(t);break;case a.Evts.V2C_JOIN_TEAM:a.sender.SceneJoinTeamReq(t);break;case a.Evts.ENTER_BATTLE_AREA:if(game.csWarTeamData.isInTeam)return;a.sender.SceneCreateTeamReq(0);break;case a.Evts.V2C_LOOK_TEAM_LIST:a.sender.SceneTeamListReq();break;case a.Evts.V2C_KICK_MEMBER:a.sender.SceneKickTeamReq(t);break;case a.Evts.V2C_REQ_TEAM_DATA:a.dpt(a.Evts.C2C_REQ_TEAM_DATA)}},getCsWarTeam:function(){this.sender.SceneTeamReq()},sceneTeamResp:function(e){var t=e.readProtobuf(game.pb.SceneTeamResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.team;a&&game.csWarTeamData.setTeamInfo(a)}},sceneCreateTeamResp:function(e){var t=e.readProtobuf(game.pb.SceneCreateTeamResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.team;game.csWarTeamData.createTeam(a),game.module.hide(game.ME.CsWarTeam),game.guanDuData.isHasTeam=!0,game.csWarTeamData.isShowView&&(game.module.show(game.ME.CsWarBattleTeam),game.notice.show(3727)),this.dpt(this.Evts.C2C_CREATE_TEAM)}},sceneJoinTeamResp:function(e){var t=e.readProtobuf(game.pb.SceneJoinTeamResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.team;game.guanDuData.isHasTeam=!0,game.csWarTeamData.joinTeam(a),game.module.hide(game.ME.CsWarTeam),game.module.show(game.ME.CsWarBattleTeam),this.dpt(this.Evts.C2C_JOIN_TEAM)}},sceneJoinTeamMsg:function(e){var t=e.readProtobuf(game.pb.SceneJoinTeamNotify).member;game.csWarTeamData.joinTeamNotify(t),this.send(this.Evts.C2V_UPDATE_BATTLE_LIST),this.dpt(this.Evts.C2C_JOIN_TEAM_NOTIFY)},sceneLeaveTeamResp:function(e){var t=e.readProtobuf(game.pb.SceneLeaveTeamResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csWarTeamData.leaveTeam(),game.guanDuData.isHasTeam=!1,game.module.hide(game.ME.CsWarBattleTeam),this.dpt(this.Evts.C2C_LEAVE_TEAM),game.sceneData.getSceneType()==game.SceneType.GUANDU_MAP&&b8e.evt.dptG(game.SceneGEvts.C2C_UPDATA_BTN)}},sceneLeaveTeamMsg:function(e){var t=e.readProtobuf(game.pb.SceneLeaveTeamNotify),a=t.memberId,i=t.newLeader,n=t.memberIdx;0<i&&game.follow.delQueueListById(n),game.csWarTeamData.LeaveTeamNotify(a,i),game.csWarTeamData.isInTeam?this.send(this.Evts.C2V_UPDATE_BATTLE_LIST):game.module.hide(game.ME.CsWarBattleTeam),this.send(this.Evts.C2V_LEAVE_TEAM_NOTIFY),this.dpt(this.Evts.C2C_LEAVE_TEAM_NOTIFY),game.mainRole.data.roleId==t.memberId&&(game.guanDuData.isHasTeam=!1,game.module.hide(game.ME.CsWarBattleTeam),this.dpt(this.Evts.C2C_HIDE_TEAMBTN),game.csWarTeamData.leaveTeam())},sceneKickTeamResp:function(e){var t=e.readProtobuf(game.pb.SceneKickTeamResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.memberId;game.csWarTeamData.kickTeam(a),this.send(this.Evts.C2V_UPDATE_BATTLE_LIST),this.dpt(this.Evts.C2C_LEAVE_TEAM_NOTIFY)}},sceneTeamDataResp:function(e){var t=e.readProtobuf(game.pb.SceneTeamDataResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.team;game.csWarTeamData.setMineTeamData(a),this.send(this.Evts.C2V_UPDATE_BATTLE_LIST)}},sceneTeamListResp:function(e){var t=e.readProtobuf(game.pb.SceneTeamListResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csWarTeamData.setTeamList(t.teams);this.send(this.Evts.C2V_UPDATE_LIST)}},sceneTeamPowerLimitResp:function(e){var t=e.readProtobuf(game.pb.SceneTeamPowerLimitResponse);0<t.code?game.notice.noticeError(t.code):(game.notice.show(3740),game.csWarTeamData.powerLimit=0|this.alterPower,this.send(this.Evts.C2V_CHANGE_POWER))},sceneTeamRecruitResp:function(e){var t=e.readProtobuf(game.pb.SceneTeamRecruitResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csWarTeamData.setRecruitTime(),game.notice.show(3728)}},createTeamBtn:function(){game.csWarTeamData.isShowView=!0,this.sender.SceneCreateTeamReq(0)},leaveTeamBtn:function(){this.sender.SceneLeaveTeamReq()},recruitBtn:function(){var e=game.sceneData.getConfig();if(e.type==game.SceneType.CSWAR){if(!(t=game.csSceneData.getSceneUnitData(game.csWarData.mySceneIdx)))return;if((a=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(t.x,t.y))!=game.CsEventAreaEnum.ENTER_BATTLE)return void game.notice.show(9113)}else if(e.type==game.SceneType.GUANDU_MAP){var t,a;if(!(t=game.mainRole._gridPos))return;if((a=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(t.x,t.y))!=game.CsEventAreaEnum.ENTER_ARE_YUAN&&12==game.mainRole.data.campId)return void game.notice.show(9113);if(a!=game.CsEventAreaEnum.ENTER_AREA_CAO&&11==game.mainRole.data.campId)return void game.notice.show(9113)}if(game.SysTime.curTime<game.csWarTeamData.recruitTime){var i=game.csWarTeamData.recruitTime-game.SysTime.curTime,n=game.TimeUtil.formatTimeSpace(i,1);game.notice.show(3729,n)}else this.sender.SceneTeamRecruitReq()},challengeBtn:function(){this.dpt(this.Evts.C2C_CHALLENGE_TEAM,game.csWarTeamData.challengeId),game.module.hide(game.ME.CsWarChallenge)},giveUpBtn:function(){game.module.hide(game.ME.GuanDuChallenge)},lootBtn:function(){this.dpt(this.Evts.C2C_GUANDU_LOOT),game.module.hide(game.ME.GuanDuChallenge)},reqRecruit:function(e){e&&e.data&&(game.csWarTeamData.isInTeam?game.notice.show(3739):this.sender.SceneJoinTeamReq(e.data))},snatchBtn:function(){},abortBtn:function(){}}),t=[game.ME.CsWarBattleTeam,game.ME.CsWarChallenge,game.ME.GuanDuChallenge],a=game.Sender.extends({ipc:function(){this.msg={SceneCreateTeamReq:this.sceneCreateTeamReq,SceneJoinTeamReq:this.sceneJoinTeamReq,SceneLeaveTeamReq:null,SceneKickTeamReq:this.sceneKickTeamReq,SceneTeamListReq:null,SceneTeamPowerLimitReq:this.sceneTeamPowerLimitReq,SceneTeamRecruitReq:null,SceneTeamReq:null}},sceneCreateTeamReq:function(e){var t=game.pb.SceneCreateTeamRequest;t.powerLimit=e,this.write(t)},sceneJoinTeamReq:function(e){var t=game.pb.SceneJoinTeamRequest;t.teamId=e,this.write(t)},sceneKickTeamReq:function(e){var t=game.pb.SceneKickTeamRequest;t.memberId=e,this.write(t)},sceneTeamPowerLimitReq:function(e){var t=game.pb.SceneTeamPowerLimitRequest;t.power=e,this.alterPower=e,this.write(t)}});b8e.module.registerControl(game.ME.CsWarTeam,e,game.CsWarTeamEvts,a,t)}(),function(){var e;e=b8e.Object.extends({ctor:function(){this._super()},syncGridInfo:function(e){!e||e.x<0||e.y<0||this._areaChecker(e)},_areaChecker:function(e){var t=game.sceneData.getConfig();if(t){var a=e.x,i=e.y,n=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(a,i);switch(t.type){case game.SceneType.CSWAR:this._csWarEventAreaChecker(n);break;case game.SceneType.GUANDU_MAP:this._csGuanDuWventAreaChecker(n)}}},_csWarEventAreaChecker:function(e){var t=e==game.CsEventAreaEnum.ENTER_BATTLE;game.csWarData.isInBattleArea!=t&&(game.csWarData.isInBattleArea=t,game.notice.show(game.csWarData.isInBattleArea?3726:3725))},_csGuanDuWventAreaChecker:function(e){if(game.mainRole&&game.mainRole.data){var t=game.mainRole.data.guanduMapEvent;if(t!=e){switch(e){case game.CsEventAreaEnum.ENTER_ARE_YUAN:11==game.mainRole.data.campId?b8e.setTimeout(function(){game.mainRole.transition(game.RoleStateType.ACTION_IDLE,null,!0)},this,1):12==game.mainRole.data.campId&&(game.guanDuData.canTeam=!0,b8e.evt.dptG(game.SceneGEvts.C2C_UPDATA_BTN));break;case game.CsEventAreaEnum.ENTER_AREA_CAO:11==game.mainRole.data.campId?(game.guanDuData.canTeam=!0,b8e.evt.dptG(game.SceneGEvts.C2C_UPDATA_BTN)):12==game.mainRole.data.campId&&b8e.setTimeout(function(){game.mainRole.transition(game.RoleStateType.ACTION_IDLE,null,!0)},this,1);break;default:game.guanDuData.canTeam=!1,this._updateGuanDuEventData(e)||(b8e.evt.dptG(game.SceneGEvts.C2C_UPDATA_BTN),5003!=t&&5004!=t&&5005!=t||game.challengeIcon.hide())}game.mainRole.data.guanduMapEvent=e}else if(game.guanDuData.towerIsEmeny||game.sceneHelper.isClickMap)game.guanDuData.towerIsEmeny=!1,game.sceneHelper.isClickMap=!1,this._updateGuanDuEventData(e);else if(game.guanDuData.towerIsSelf){game.guanDuData.towerIsSelf=!1;var a=game.guanDuData.challengeId;1!=a&&2!=a&&3!=a||game.challengeIcon.hide()}}},_updateGuanDuEventData:function(e){var t=!1;switch(e){case game.CsEventAreaEnum.ENTER_YUAN_FIGHT:t=!0,this._updateGuanDuData(game.GuanDuTowerType.Fight,1);break;case game.CsEventAreaEnum.ENTER_YUAN_FLAG:t=!0,this._updateGuanDuData(game.GuanDuTowerType.Flag,3);break;case game.CsEventAreaEnum.ENTER_YUAN_BLOOD:t=!0,this._updateGuanDuData(game.GuanDuTowerType.Blood,2)}return t},_updateGuanDuData:function(e,t){var a=game.guanDuData.getTowerData(e);if(a&&a&&0!=a.master){var i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,a.master);if(i){var n=i.data;if(n&&n.campId!=game.mainRole.data.campId){game.guanDuData.challengeId=t;var s=b8e.scene.getDisplayByTypeAndId(game.RoleType.Tower,a.id);game.challengeIcon.show(s,1,!0)}}}}});b8e.RC("$$game","$$CsEventAreaChecker",e)}(),function(){var t=void 0;t=b8e.BaseDisplay.extends({ctor:function(){this._super(),this.init()},init:function(){this.addCamp(),this.addHead(),this.addName()},addHead:function(){this._headImg&&this._headImg.parent||(this._headImg||(this._headImg=b8e.Sprite.get(),this._headImg.setAnchor(.5,.5),this._headImg.clearDisabled=!0),this.addChild(this._headImg))},addCamp:function(){var e=this;if(!e._campImg||!e._campImg.parent){if(!e._campImg){e._campImg=b8e.Sprite.get(),e._campImg.setAnchor(.5,.5),e._campImg.setStyle(b8e.SpriteStyle.SLICED),e._campImg.scale9Inset={top:19,bottom:23,left:20,right:20};var t=game.IconSizeEnum.GRID_SIZE_105,a=game.IconWidthSizeEnumMap[t];e._campImg.setSize(a,t),e._campImg.clearDisabled=!0}e.addChild(e._campImg)}},addName:function(){this._rootBar&&this._rootBar.parent||(this._rootBar||(this._rootBar=new game.RootBar,this._rootBar.setLocalZOrder(50),this._rootBar.setPosition(0,-30),this._rootBar.clearDisabled=!0),this.addChild(this._rootBar))},setHeadImg:function(e){if(this._headImg)if(null!=e&&null!=e){var t=game.ResCfg.getHead(e);this._headImg.loadTexture(t)}else this._headImg.unloadTexture()},setCampImg:function(e){if(this._campImg)if(e){var t=game.ResCfg.getUrl(144,e);this._campImg.loadTexture(t)}else this._campImg.unloadTexture()},setName:function(e,t,a){var i=2<arguments.length&&void 0!==a&&a;if(this._rootBar){var n=i?70:-70;this._rootBar.setPosition(0,n);var s=game.Color.GREEN;switch(t){case game.CsWarCampType.SHU:s=game.Color.RED;break;case game.CsWarCampType.WEI:s=game.Color.BLUE;break;case game.CsWarCampType.WU:s=game.Color.GREEN}this._rootBar.setNameSize(22),this._rootBar.setNameColor(s),this._rootBar.setNameText(e)}},recycle:function(){this.reset(),this._super()},reset:function(){this._campImg&&this._campImg.unloadTexture(),this._headImg&&this._headImg.unloadTexture(),this._rootBar&&this._rootBar.reset()},release:function(){t.put(this)},dispose:function(){var e=this;e._rootBar&&(e._rootBar.release(),e._rootBar=null),e._headImg&&(e._headImg.release(),e._headImg=null),e._campImg&&(e._campImg.release(),e._campImg=null),e._super()}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,128),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$CsHeadBar",t)}(),function(){var e;e=b8e.GameLevelDesigner.extends({baseSpeed:.03,spriteLocalZOrder:50,firstEnter:!0,ctor:function(e){this._super(e)},start:function(){var e=this;if(e.firstEnter&&(e.firstEnter=!1,game.RuleView.inst().showView(game.ME.CsWar)),!e.addTouch){var t=b8e.scene.getViewDisplay();b8e.evt.onTouchStart(t,e._onTouchBegan,e),b8e.evt.onTouchEnd(t,e._onTouchEnd,e),b8e.evt.onTouchCancel(t,e._onTouchCancelled,e),b8e.evt.onTouchMove(t,e._onTouchMove,e)}if(e.addTouch=!0,e._scene.getCamera().setFocusTarget(null),!e.sprite){var a=e.sprite=b8e.Sprite.get();a.addToParent(e._scene.getEntityLayer().getContainer()),a.setLocalZOrder(e.spriteLocalZOrder),a.setStyle(b8e.SpriteStyle.TILED)}e._alertOptions||(e._alertOptions={lang:3713,okcb:e.onGameAlert,thisArg:e}),e.setMainRole=!1},updateCameraFollow:function(){if(this.isCameraFollow=game.csWarData.isCameraFollow,this.isCameraFollow){if(this._player)this._scene.getCamera().setFocusTarget(this._player);else if(0<game.csWarData.myMineUnitId){var e=b8e.scene.getDisplayByTypeAndId(game.RoleType.CsWarMine,game.csWarData.myMineUnitId);e&&this._scene.getCamera().setFocusTarget(e)}}else this._scene.getCamera().setFocusTarget(null)},stop:function(){var e=this;if(e._player&&(e._player=null),e.addTouch){var t=b8e.scene.getViewDisplay();b8e.evt.offTouchStart(t,e._onTouchBegan,e),b8e.evt.offTouchEnd(t,e._onTouchEnd,e),b8e.evt.offTouchCancel(t,e._onTouchCancelled,e),b8e.evt.offTouchMove(t,e._onTouchMove,e)}e.addTouch=!1,e.sprite&&(b8e.Tween.kill(e.sprite),e.sprite.unloadTexture(),e.sprite.removeFromParent(),e.sprite.release(),e.sprite=null),e._scene.getCamera().setFocusTarget(game.mainRole)},nextPosX:0,nextPosY:0,offsetX:0,offsetY:0,location:null,moveThreshold:3,isCameraFollow:!0,_onTouchBegan:function(e){var t=e.target,a=e.touch.getLocation();t.hitTest(a)&&(this._startTouch||(this._startTouch=!0,this._lastPos=this._startPos=a))},_onTouchEnd:function(e){var t=e.target,a=e.touch.getLocation();t.hitTest(a)&&(this._lastPos=null,this._touchMoved&&e.stopPropagation(),this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1))},_onTouchCancelled:function(){this._lastPos=null,this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1)},_onTouchMove:function(e){var t=this,a=e.touch.getLocation();if(t._lastPos){t.isCameraFollow&&b8e.module.sendToControl(game.ME.CsWar,[game.CsWarEvts.C2C_UPDATE_CAMERA_SETTING]),t.location=a,t.offsetX=t._lastPos.x-a.x,t.offsetY=a.y-t._lastPos.y,t._lastPos=t.location,t._endPos=t.location,t._touchMoved=!0;var i=t._scene.getCamera(),n=i.focusX+t.offsetX,s=i.focusY+t.offsetY;i.setFocus(n,s)}},moveToPosNotify:function(e){var t=game.csSceneData.getSceneUnitData(e);if(t){var a=this._scene.getDisplayByTypeAndId(t.type,e);a&&b8e.Tween.kill(a),this._player&&this._player.id==e&&(b8e.Tween.kill(this),b8e.Tween.kill(this.sprite),this.sprite.width=0)}},setPlayer:function(e){var t=this;if(!t._player||t._player.id!=e.id){t._player&&t._player.removeAllSyncInfo(),t._player=e,t.setMainRole||game.mainRole.setGridPosition(t._player.gridX,t._player.gridY),t._scene.getCamera().setFocusTarget(t._player),game.csWarData.isCameraFollow||t._scene.getCamera().setFocusTarget(null);var a=t._player.gridX,i=t._player.gridY,n=t._scene.getMapLayer().getEarthSurface().getGridEventType(a,i);game.csWarData.isInBattleArea=n==game.CsEventAreaEnum.ENTER_BATTLE;var s=new game.CsEventAreaChecker;t._player.addSyncInfo(new b8e.SceneDisplaySyncInfo(s))}},addEntity:function(e,t,a,i,n){var s,o=this,r=null;if(a?(r={callBack:a,thisArg:i,args:n,options:t},o._onGeneraterByType[e]=r):r=o._onGeneraterByType[e],s=o._scene.getDisplayByTypeAndId(e,t.idx))s.updateExterior(t);else if(r?(a=r.callBack,i=r.thisArg,n=r.args,t=r.options,s=a.apply(i,n)):(o._onGeneraterByType[e]=void 0,delete o._onGeneraterByType[e],o._entityUid++,(s=b8e.SceneEntity.get(1e8,o._entityUid)).defaultSurface()),s.setTouchable(!0),s.setSceneVisitCallback(function(){s.updateExterior(t)},o),e==game.RoleType.CsWarHero){o._scene.addDisplay(s,200,!1)}else o._scene.addDisplay(s,void 0,!1);return s.setGridPosition(t.x,t.y),0<game.csWarTeamData.teamId?t.roleId==game.csWarTeamData.mineMaster&&o.setPlayer(s):t.roleId==game.mainRoleData.id&&o.setPlayer(s),s},removeEntity:function(e,t){var a=this,i=a._scene.getDisplayByTypeAndId(e,t);i==a._player&&(a._player=null),i&&(a._onEntityBeforeRemove&&a._onEntityBeforeRemove.callBack.call(a._onEntityBeforeRemove.thisArg,i),a._scene.removeDisplayByTypeAndId(e,t)&&a._onEntityRemoved&&a._onEntityRemoved.callBack.call(a._onEntityRemoved.thisArg,e,t))},resetPosition:function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.CsWarHero,e);if(t){var a=game.csSceneData.getSceneUnitData(e);a&&a.setPosition(t.gridX,t.gridY)}},moveNotify:function(e,t,a){var i=game.csSceneData.getSceneUnitData(e);if(i){e!=game.csWarData.mySceneIdx&&(i.x=t,i.y=a);var n=this._scene.getDisplayByTypeAndId(i.type,e);if(n){var s=this._scene.getPixelPosByGrid(t,a);s=this._scene.sceneUIToGLPos(s.x,s.y);var o=b8e.MathUtil.getDistance(n.x,n.y,s.x,s.y)/this.baseSpeed;b8e.Tween.kill(n),b8e.Tween.get(n).to({x:s.x,y:s.y},o)}}},gotoEntityById:function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.CsWarMine,e);t&&this.checkPickTaget(t)},selfMove:function(e){var t=this;if(t.obj||(t.obj={x:0,y:0}),t.obj.x=e.gridX,t.obj.y=e.gridY,t._player){0==game.csWarTeamData.teamId&&(game.csWarTeamData.isShowView=!1,t.enterBattle()),b8e.evt.dptG(game.SceneGEvts.CLICK_CSWAR_MINE,t.obj);var a=b8e.MathUtil.getDistance(t._player.x,t._player.y,e.x,e.y),i=t.sprite,n=t._player.getCamp();i.loadTexture(game.ResCfg.getUrl(146,n),t.onComplete,t),i.setPosition(e.x,e.y),i.width=a;var s=b8e.MathUtil.getDegree(e.x,e.y,t._player.x,t._player.y);i.rotation=-s;var o=b8e.MathUtil.getDistance(e.x,e.y,t._player.x,t._player.y)/t.baseSpeed;b8e.Tween.kill(t._player),b8e.Tween.get(t._player).to({x:e.x,y:e.y},o),b8e.Tween.kill(t),b8e.Tween.get(t).wait(500+o).call(t.playerMoveComplete,t,[e]),b8e.Tween.kill(i),b8e.Tween.get(i).to({width:0},o)}},checkPickTaget:function(e){if(e.data)switch(e.data.sceneUnitType){case game.SceneUnitType.MINE:var t=e.getMineId();if(0!=t&&t==game.csWarData.myMineUnitId)return;var a=e.data.getCanOccupy(),i=game.csWarData.mineCamp;if(0!=a&&a!=i)return void game.notice.show(3714);var n=e.data.master;if(0<n){var s=game.csSceneData.getSceneUnitData(n);if(s)if(s.camp==i)if(e.data.getMineIsMax())return void game.notice.show(3715)}0<game.csWarData.myMineUnitId?(this._alertOptions.args=[e],game.alert.showTwo(this._alertOptions)):this.selfMove(e)}},crossWarChallengeEnd:function(){b8e.Tween.kill(this._player),b8e.Tween.kill(this),b8e.Tween.kill(this.sprite),this.sprite.width=0},enterBattle:function(){b8e.module.sendToControl(game.ME.CsWarTeam,[game.CsWarTeamEvts.ENTER_BATTLE_AREA])},onGameAlert:function(e){var t=game.csSceneData.selfMove();game.GameLevelMgr.inst().updateSceneUnit(t),this.selfMove(e)},onComplete:function(){this.sprite&&this.sprite.spriteFrame&&(this.sprite.height=this.sprite.spriteFrame.getRect().height)},playerMoveComplete:function(e){if(e.data&&e.data.sceneUnitType==game.SceneUnitType.MINE){if(this._player&&this._player.data){var t=game.csSceneData.getSceneUnitData(this._player.data.idx);t&&t.setPosition(e.data.x,e.data.y)}var a=e.getMaster(),i=e.getMineId();if(a){var n=game.csSceneData.getSceneUnitData(a);if(!n)return;n.camp==game.csWarData.mineCamp?b8e.module.sendToControl(game.ME.CsWar,[game.CsWarEvts.C2C_OCCUPY_SAME_CAMP,i,a,n.name]):b8e.module.sendToControl(game.ME.CsWar,[game.CsWarEvts.C2C_OCCUPY_DIFFERENT,a,n.name])}else b8e.module.sendToControl(game.ME.CsWar,[game.CsWarEvts.C2C_OCCUPY_NONE,i])}}}),b8e.RC("$$game","$$CsWarGameLevelDesigner",e)}(),function(){var a=void 0;(a=b8e.SceneEntity.extends({ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:void 0,i=1<arguments.length&&void 0!==t?t:void 0;this._super(a,i),this.reset()},onHierarchyVisible:function(e){this._super(e),e&&(this.addPreImg(),this.addRootBar(),this.showMineAnim())},showMineAnim:function(){if(this.data&&this.data.options){var e=this.data.options;e&&e.sceneUnitType==game.SceneUnitType.MINE&&e&&this.updateMine()}},addPreImg:function(){var e=this;e._preImg||(e._preImg=b8e.Sprite.get(),e._preImg.setAnchor(.5,.5),e.addChild(e._preImg),b8e.evt.onC(e._preImg,e.onPreClick,e)),e._preImg.loadTexture(game.ResCfg.getUrl(34)),e._preImg.setPosition(60,70)},addRootBar:function(){this._rootBar&&this._rootBar.parent||(this._rootBar||(this._rootBar=new game.RootBar,this._rootBar.setLocalZOrder(50),this._rootBar.setPosition(0,-60)),this._rootBar.reset(),this.addChild(this._rootBar))},updateExterior:function(e){var t=this;if(!e||e.sceneUnitType!=game.SceneUnitType.MINE||!e)return t.data.options&&(t.data.options=null),t.resetRootBar(),void t.resetMaster();if(t.data.options=e,t.updateMine(),t.mineId=e.idx,0<e.master){var a=t.mineId==game.csWarData.myMineUnitId;t.updataMaster(),t.updataRootBar(a),t.updataProgress(a)}else t.resetRootBar(),t.resetMaster(),t.resetProgress()},updataRootBar:function(e){var t=0<arguments.length&&void 0!==e&&e,a=this;if(a.addRootBar(),a._rootBar)if(t)a._rootBar.setNameSize(22),a._rootBar.setNameText(game.Lang.get(9114)),a._rootBar.setPosition(0,-40);else{var i=a.data.options,n=4,s=game.SceneUnitCfg.getData(i.id);s&&(n=s.param1),a._rootBar.setNameSize(22),a._rootBar.setNameText(game.Lang.get(9495,a.data.options.count,n)),a._rootBar.setPosition(0,-60)}},updataProgress:function(e){var t=this;e?(t.addProgress(),game.csWarData.mineTime>game.SysTime.curTime?(t.timer||(t.timer=b8e.Timer.add(t,t.updateTime,500)),t.timer.reset(),t.timer.start()):t.timer&&t.timer.stop()):t._progress&&t.resetProgress()},addProgress:function(){this._progress&&this._progress.parent||(this._progress||(this._progress=game.ProgressBar.get(),this.addChild(this._progress)),this._progress.setProgressWidth(140),this._progress.setPosition(0,-70))},updateTime:function(){var e=game.csWarData.mineTime-game.SysTime.curTime;if(this._progress){var t=game.TimeUtil.formatTimeSpace(e,1);if(this.data&&this.data.options){var a=game.SceneUnitCfg.getData(this.data.options.id);if(a){var i=.001*e/a.param2;this._progress.setProgressPer(i)}}this._progress.setProgressText(t)}e<=0&&this.timer.stop()},updateMine:function(){var e=this,t=e.data.options;e._mineAnim||(e._mineAnim=e.addAnimator(game.AnimType.CS_WAR_MINE,1,10)),e._mineAnim.setAsBoundary(!0),e._mineAnim.setTouchable(!0);var a=game.SceneUnitCfg.getData(t.id);a&&a.url?(e._mineAnim.load(game.ResCfg.getUrl(5023,a.url)),e._mineAnim.play(null,0)):e._mineAnim&&e._mineAnim.clear()},updataMaster:function(){var e=this;e._masterHead||(e._masterHead=game.CsHeadBar.get(),e.addChild(e._masterHead),e._masterHead.setPosition(0,30));var t=e.data.options;if(0<t.master){var a=game.csSceneData.getSceneUnitData(t.master);if(!a)return void e.resetMaster();e._masterHead.setHeadImg(a.isMale),e._masterHead.setCampImg(a.camp);var i="S."+a.zone+a.name;e._masterHead.setName(i,a.camp,!0)}else e.resetMaster()},onPreClick:function(){this.data&&this.data.options&&(game.csWarData.preMineId=this.data.options.id,game.module.show(game.ME.CsWarMinePre))},resetMaster:function(){this._masterHead&&(this._masterHead.removeFromParent(),this._masterHead.release(),this._masterHead=null)},resetProgress:function(){this._progress&&(this._progress.removeFromParent(),this._progress.release(),this._progress=null),this.timer&&this.timer.stop()},resetMineAnim:function(){this._mineAnim&&(this._mineAnim.clear(),this._mineAnim=null)},resetPreImg:function(){this._preImg&&(b8e.evt.offC(this._preImg,this.onPreClick,this),this._preImg.removeFromParent(),this._preImg.release(),this._preImg=null)},resetRootBar:function(){this._rootBar&&this._rootBar.reset()},getMaster:function(){return this.data&&this.data.options?this.data.options.master:0},getMineId:function(){return this.data&&this.data.options?this.data.options.idx:0},reset:function(){this.resetRootBar(),this.resetMaster(),this.resetMineAnim(),this.resetPreImg(),this.resetProgress()},restore:function(e,t){this._super(e,t),this.reset()},recycle:function(){this._super()},release:function(){a.put(this)},dispose:function(){this._rootBar&&(this._rootBar.release(),this._rootBar=null),this.resetMaster(),this.resetProgress(),this.resetMineAnim(),this.resetPreImg(),this._super()},destroy:function(){this._super()}})).pool=new b8e.Pool(a,128),a.get=function(e,t){return a.pool.get(e,t)},a.put=function(e){a.pool.put(e)},b8e.RC("$$game","$$CsWarMine",a)}(),function(){var a=void 0;(a=b8e.SceneEntity.extends({_rootBar:null,ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:void 0,i=1<arguments.length&&void 0!==t?t:void 0;this._super(a,i),this.reset()},updateExterior:function(e){e&&e.sceneUnitType==game.SceneUnitType.PLAYER&&e?(this.data.options=e,this.updateHead(),this.updateCamp(),this.updateLayout()):this.data.options&&(this.data.options=null)},updateCamp:function(){var e=this,t=e.data.options;if(t&&t.camp){e._camp||(e._camp=b8e.Sprite.get(),e._camp.setAnchor(.5,.5),e.addChild(e._camp),e._camp.setLocalZOrder(50));var a=game.ResCfg.getUrl(145,t.camp);e._camp.loadTexture(a)}else e._camp&&e._camp.unloadTexture()},getCamp:function(){return this.options&&this.options.camp?this.options.camp:1},getIdx:function(){},updateHead:function(){var e,t,a,i=this,n="";if(i._headBarList){for(t=i._headBarList.length,a=0;a<t;a++)(e=i._headBarList[a]).removeFromParent(),game.CsHeadBar.put(e);i._headBarList.length=0}else i._headBarList=[];var s=i.data.options;if(s&&s.sceneUnitType==game.SceneUnitType.PLAYER&&s&&(i._headBarList[0]=game.CsHeadBar.get(),i._headBarList[0].setHeadImg(s.isMale),i._headBarList[0].setCampImg(s.camp),n="S."+s.zone+s.name,i._headBarList[0].setName(n,s.camp),i.addChild(i._headBarList[0]),0<s.teamId)){var o=game.csSceneData.sceneTeamMap.get(s.teamId),r=game.csSceneData,g=0;if(o&&0<o.length)for(t=o.length,a=0;a<t;a++){var l=o[a],c=r.getSceneUnitData(l);c&&c.idx!=s.idx&&(g++,i._headBarList[g]=game.CsHeadBar.get(),i._headBarList[g].setHeadImg(c.isMale),i._headBarList[g].setCampImg(c.camp),n="S."+c.zone+c.name,i._headBarList[g].setName(n,c.camp),i.addChild(i._headBarList[g]))}}},updateLayout:function(){var e=this;if(e._headBarList||!(e._headBarList.length<1))switch(e._headBarList.length){case 1:e._headBarList[0].setPosition(0,0),e._camp.setPosition(70,30);break;case 2:e._headBarList[0].setPosition(-55,0),e._headBarList[1].setPosition(55,0),e._camp.setPosition(130,30);break;case 3:e._headBarList[0].setPosition(0,80),e._headBarList[1].setPosition(-60,-24),e._headBarList[2].setPosition(60,-24),e._camp.setPosition(70,120)}},reset:function(){if(this._headBarList&&0<this._headBarList.length){for(var e=this._headBarList.length,t=0;t<e;t++){var a=this._headBarList[t];a.removeFromParent(),game.CsHeadBar.put(a)}this._headBarList.length=0}this._camp&&(this._camp.release(),this._camp=null)},restore:function(e,t){this._super(e,t)},recycle:function(){this.reset(),this._super()},release:function(){a.put(this)},dispose:function(){this._headBarList=null,this._super()},destroy:function(){this._super()}})).pool=new b8e.Pool(a,128),a.get=function(e,t){return a.pool.get(e,t)},a.put=function(e){a.pool.put(e)},b8e.RC("$$game","$$CsWarPlayer",a)}(),function(){var t=void 0;t=b8e.BaseDisplay.extends({_progressLab:null,_progressBg:null,factor:.5,ctor:function(){this._super()},addProgressBg:function(){var e=this;e._progressBg&&e._progressBg.parent?e._progressBg.width=e.progressWidth+7:(e._progressBg=b8e.Sprite.get(),e._progressBg.setAnchor(.5,.5),e._progressBg.scale9Inset={top:8,bottom:11,left:9,right:9},e._progressBg.loadTexture(game.ResCfg.getUrl(32),e.onComplete,e),e._progressBg.setStyle(b8e.SpriteStyle.SLICED),e.addChild(e._progressBg),e._progressBg.setPosition(0,-1))},addProgressLab:function(){var e=this;e._progressLab&&e._progressLab.parent||(e._progressLab=b8e.Label.get(),e._progressLab.setAnchor(.5,.5),e._progressLab.setPosition(0,-3),e._progressLab.setFontSize(16/e.factor),e._progressLab.setColor(game.Color.BLACK),e.addChild(e._progressLab),e._progressLab.isBold(!0),e._progressLab.lineHeight=40,e._progressLab.setScale(.5,.5),e._progressLab.setText(""))},addProgressImg:function(){var e=this;e._progressImg&&e._progressImg.parent||(e._progressImg=b8e.Sprite.get(),e._progressImg.setAnchor(0,.5),e._progressImg.scale9Inset={top:7,bottom:7,left:7,right:7},e._progressImg.loadTexture(game.ResCfg.getUrl(33),e.onComplete2,e),e._progressImg.setStyle(b8e.SpriteStyle.SLICED),e.addChild(e._progressImg),e._progressImg.setPosition(9,0))},setProgressVisible:function(e){this._progressLab.setVisible(e),this._progressBg.setVisible(e),this._progressImg.setVisible(e)},setProgressText:function(e){this._progressLab.setText(e)},setProgressWidth:function(e){this.progressWidth=e,this.addProgressBg(),this.addProgressImg(),this.addProgressLab(),this._progressImg.x=.5*-e},onComplete:function(){this._progressBg.width=this.progressWidth+20},onComplete2:function(){this._progressImg.width=0,this._progressImg.height=this._progressImg.spriteFrame.getRect().height},setProgressPer:function(e){var t=this.progressWidth*e;this._progressImg.width=t},recycle:function(){this.reset(),this._super()},reset:function(){this._progressBg&&(this._progressBg.width=0),this._progressImg&&(this._progressImg.width=0),this._progressLab&&this._progressLab.setText("")},release:function(){t.put(this)},dispose:function(){this._progressBg&&(this._progressBg.removeFromParent(),this._progressBg.release(),this._progressBg=null),this._progressLab&&(this._progressLab.removeFromParent(),this._progressLab.release(),this._progressLab=null),this._progressImg&&(this._progressImg.removeFromParent(),this._progressImg.release(),this._progressImg=null),this._super()}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,128),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$ProgressBar",t)}(),function(){var e;e=game.ListItem.extends({hpWidth:155,ctor:function(){this._super(266),this.setSize(176,253)},init:function(){this.hpWidth=this.skin.hp.width;var e=this._headImg=b8e.Sprite.get();e.addToParent(this.skin.head),e.setAnchor(.5,.5)},setData:function(){var e=this.skin,t=this.data,a=t.isMale;if(null!=a&&null!=a){var i=game.ResCfg.getHead(a);this._headImg.loadTexture(i)}else this._headImg.unloadTexture();e.name.string=t.name,e.level.string=t.level,e.power.string=t.power,e.kickBtn.active=t.isKick,game.csTreasureData.isTreasureScene()?(e.keyNode.active=!0,e.labNum.string=t.keys):e.keyNode.active=!1,e.masterTag.active=t.isLeader,e.hp.width=this.hpWidth*t.hp/t.maxHp},kickBtn:function(){this.send(game.CsWarTeamEvts.V2C_KICK_MEMBER,this.data.id)}}),b8e.RC("$$game","$$CsWarBattleTeamItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(267)},init:function(){var e=this.skin;e.masterPage.active=!0,e.challengeBtn.active=!1,e.desc2.string=game.Lang.get(3732),e.title2.string=game.Lang.get(3733);var t=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.CsWarBattleTeamItem,t.addToParent(e.list),t.bindEnum=game.ME.CsWarTeam,this.patt=/^[0-9]*[1-9][0-9]*$/},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_BATTLE_LIST:this.updateList();break;case this.Evts.C2V_CHANGE_POWER:this.updatePower()}},onShow:function(){this.skin.leaderNode.active=game.csWarTeamData.isLeader,this.skin.leaveTeamBtn.x=game.csWarTeamData.isLeader?185:320,this.updateList(),this.updatePower(),this.send(this.Evts.V2C_REQ_TEAM_DATA)},onHide:function(){},updateList:function(){this.teamInfoList=game.csWarTeamData.getMineTeam(),this.list.setData(this.teamInfoList)},updatePower:function(){this.skin.power.string=game.csWarTeamData.powerLimit},view_changeBtn:function(){var e=this.skin.power.string;""!==e?this.patt.test(e)?this.send(this.Evts.V2C_CHECK_POWER,e):game.notice.show(1607):game.notice.show(1606)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CsWarBattleTeam,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(267)},init:function(){var e=this.skin;e.masterPage.active=!1,e.challengeBtn.active=!0,e.desc2.string=game.Lang.get(3730),e.title2.string=game.Lang.get(3731);var t=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.CsWarBattleTeamItem,t.addToParent(e.list)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_CHALLENGE_LIST:this.updateList()}},onShow:function(){this.updateList()},onHide:function(){},updateList:function(){this.teamInfoList=game.csWarTeamData.getChallengeTeam(),this.list.setData(this.teamInfoList)},view_changeBtn:function(){},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CsWarChallenge,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(269),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_CAMERA_SETTING:this.updateSetting()}},onShow:function(){this.updateSetting()},onHide:function(){},updateSetting:function(){this.skin.checkImg.active=game.csWarData.isCameraFollow},onStageResize:function(){this.setPosition(0,275)}});b8e.module.registerView(game.ME.CsWarLeftBottom,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(270),this.spotAlerts={CS_WAR_LOG_ALERT:this.logAlert},this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){this._headImg=b8e.Sprite.get(),this._headImg.addToParent(this.skin.head),this._headImg.setAnchor(.5,.5)},logAlert:function(e){this.skin.logAlert.active=e.alert},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_TEAM_STATE:this.updateTeamBtn(),this.updateLayout();break;case this.Evts.C2V_UPDATE_SCORE:this.updateScore();break;case this.Evts.C2V_LEVEL_CHANGE:this.updateLv();break;case this.Evts.C2V_POWER_CHANGE:this.updatePower()}},onShow:function(){this.updateTeamBtn(),this.updateLayout(),this.updateScore(),this.updateLv(),this.updatePower(),this.updateHead()},onHide:function(){},updateScore:function(){this.skin.mineScore.string=game.Lang.get(3701,game.csWarData.myScore)},updateTeamBtn:function(){this.skin.teamBtn.active=game.csWarTeamData.isInTeam},updateHead:function(){var e,t=game.mainRoleData.getDefaultCfg();t&&(e=game.ResCfg.getUrl(59,t.head),this._headImg.loadTexture(e))},updatePower:function(){this.skin.fightAmount.string=game.mainRoleData.power},updateLv:function(){var e=this.skin;e.headName.string=game.mainRoleData.name,e.level.string=game.mainRoleData.lv,e.headName.node.isBold(!0)},updateLayout:function(){var e=this.skin,t=-100;e.ruleBtn.active&&(e.ruleBtn.y=t,t-=86),e.teamBtn.active&&(e.teamBtn.y=t,t-=86),e.logBtn.active&&(e.logBtn.y=t)},onStageResize:function(){b8e.stageWidth;var e=b8e.stageHeight;this.setPosition(0,e-43)}});b8e.module.registerView(game.ME.CsWarLeftTop,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(271),this.setSize(600,94)},init:function(){this.format="Y-M-D h:m:s"},setData:function(){var e,t=this.skin,a=this.data,i=game.Lang,n=game.CsWarLogType;t.timeLab.string=b8e.TimeUtil.formatTimestamp(a.time,this.format);var s=!0;switch(a.type){case n.ATTACK:e=i.get(3702,a.name),s=a.win;break;case n.DEFEND:e=i.get(3703,a.name),s=!a.win;break;default:e=""}t.infoLab.string=e,t.failImg.active=!s,t.successImg.active=s},checkVideoBtn:function(){if(this.data.battlelog){game.module.hide(game.ME.CsWarLog),game.GameViewMgr.inst().hideUnStrongViews();var e={type:game.InstanceType.CS_WAR};game.playBack.play(this.data.battlelog,e)}}}),b8e.RC("$$game","$$CsWarLogItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(272)},init:function(){var e=this.logList=new game.List;e.itemRender=game.CsWarLogItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.CsWarLog,e.layout.paddingLeft=0,e.layout.paddingTop=0},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_LOG:this.updataList()}},onShow:function(){this.updataList(),this.send(this.Evts.V2C_SHOW_LOG_VIEW)},onHide:function(){},updataList:function(){this.list=game.csWarLogData.getLogs(),this.logList.setData(this.list),this.list&&0<this.list.length?this.skin.emptyNode.active=!1:this.skin.emptyNode.active=!0},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.CsWarLog,e)}(),function(){var e=game.View.extends({timeSpace:0,_specialLayer:!0,ctor:function(){this._super(273),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e=this;e.sortList=[],e.camp1={langKey:3717,score:0},e.sortList.push(e.camp1),e.camp2={langKey:3718,score:0},e.sortList.push(e.camp2),e.camp3={langKey:3719,score:0},e.sortList.push(e.camp3)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_CAMP_SCORE:this.updateScore();break;case this.Evts.C2V_MINE_TEAM_UPDATE:case this.Evts.C2V_UPDATE_TEAM_STATE:this.updateTeamBtn()}},onShow:function(){this.updateScore(),this.updateTeamBtn()},onHide:function(){},updateTeamBtn:function(){this.skin.middleTeamBtn.active=game.csWarTeamData.canTeam},updateScore:function(){var e=this,t=e.skin;e.camp1.score=game.csWarData.campScore1,e.camp2.score=game.csWarData.campScore2,e.camp3.score=game.csWarData.campScore3,e.sortList.sort(e.onSort),0<e.sortList[0].score?t.firstName.string=game.Lang.get(e.sortList[0].langKey,e.sortList[0].score):t.firstName.string=game.Lang.get(3720),0<e.sortList[1].score?t.secondName.string=game.Lang.get(e.sortList[1].langKey,e.sortList[1].score):t.secondName.string=game.Lang.get(3720),0<e.sortList[2].score?t.thirdName.string=game.Lang.get(e.sortList[2].langKey,e.sortList[2].score):t.thirdName.string=game.Lang.get(3720)},onSort:function(e,t){return t.score-e.score},onStageResize:function(){var e=b8e.stageWidth;this.setPosition(.5*(e-this.width),170)}});b8e.module.registerView(game.ME.CsWarMiddle,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(276),this.setSize(548,90)},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ShowItemListItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingY=-10},setData:function(){var e=this.skin,t=(this.data.cfg,this.data);this.prizeInfoList=this.data.getPrizeList(),this.prizeList.setData(this.prizeInfoList),e.first_root.active=1==t.rank,e.second_root.active=2==t.rank,e.third_root.active=3==t.rank,e.other_root.active=3<t.rank||0==t.rank,e.rankLab.string=t.rank;var a=game.Color.WHITE;switch(t.rank){case 1:a=game.Color.YELLOW;break;case 2:a=game.Color.BLUE;break;case 3:a=game.Color.GREEN}var i=game.Lang.get(3704,t.zone);e.name.string=game.HtmlUtil.getText(a,i),e.score.string=game.Lang.get(9497,t.score)}}),b8e.RC("$$game","$$CsWarRankItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(277)},init:function(){var e=this.list=new game.List;e.itemRender=game.CsWarRankItem,e.addToParent(this.skin.list),e.layout.spacingY=10},notify:function(e){switch(e){case this.Evts.C2V_CHANGE_PAGE:this.updateList();break;case this.Evts.C2V_INIT_DATA:this.updateList(),this.skin.self_rank.string=game.csWarData.mineRank}},onShow:function(){this.updateList(),this.skin.self_rank.string=game.csWarData.mineRank,this.send(this.Evts.V2C_SHOW_VIEW)},updateList:function(){this.infoList=game.csWarData.getRankInfoList(),this.list.setData(this.infoList),this.skin.page_lab.string=game.csWarData.pageNum+"/"+game.csWarData.pageMaxCount,this.skin.emptyDesc.active=!this.infoList||this.infoList.length<1},onHide:function(){},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.CsWarRank,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(278),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},onShow:function(){},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth;this.setPosition(e-this.width,260)}});b8e.module.registerView(game.ME.CsWarRightBottom,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(279),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_OPEN_STATE:this.updateDesc()}},onShow:function(){this.updateDesc()},onHide:function(){this.timer&&this.timer.stop()},updateDesc:function(){var e=this;if(e.timeSpace=game.csWarData.remTimeStamp,e.startState=game.csWarData.startState,e.timeSpace>game.SysTime.curTime)e.timer||(e.timer=b8e.Timer.add(e,e.updateTime,500)),e.timer.reset(),e.timer.start();else{e.timer&&e.timer.stop();var t=b8e.TimeUtil.formatTime(0);e.skin.time.string=t}1==game.csWarData.startState?e.skin.timeDesc.string=game.Lang.get(9116):e.skin.timeDesc.string=game.Lang.get(9117)},updateTime:function(){var e=game.SysTime.curTime;if(this.timeSpace>e){var t=this.timeSpace-e,a=b8e.TimeUtil.formatTime(t);this.skin.time.string=a}else this.timer&&this.timer.stop()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e-this.width,t-50)}});b8e.module.registerView(game.ME.CsWarRightTop,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(280),this.setSize(197,203)},setData:function(){var e=this.skin,t=this.data,a=t.memberCount<game.csWarTeamData.maxMemberCount;if(e.noFullPage.active=a,e.fullImg.active=!a,e.memberCount.string=game.Lang.get(3705,t.memberCount,game.csWarTeamData.maxMemberCount),a){var i=game.CCommonUtil.replaceNum(t.powerLimit,1);e.power.string=game.Lang.get(3706,i)}e.name.string=t.name},joinBtn:function(){game.mainRoleData.power<this.data.powerLimit?game.notice.show(3724):this.send(game.CsWarTeamEvts.V2C_JOIN_TEAM,this.data.id)}}),b8e.RC("$$game","$$CsWarTeamItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(281)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.CsWarTeamItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.CsWarTeam,e.layout.paddingLeft=0,e.layout.paddingRight=0},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_LIST:this.updateList()}},onShow:function(){this.send(this.Evts.V2C_LOOK_TEAM_LIST);var e=game.sceneData.getSceneType();this.skin.desc.active=e!=game.SceneType.TREASURE},onHide:function(){},updateList:function(){this.teamInfoList=game.csWarTeamData.getTeamList(),this.list.setData(this.teamInfoList)},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.CsWarTeam,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(""),this.toggles={},this.spotAlerts={}},notify:function(e){e},onShow:function(){},onHide:function(){},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.CsWar,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(275)},notify:function(e){e},onShow:function(){},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth-this.width;this.setPosition(e-17,320)}});b8e.module.registerView(game.ME.CsWarQuickEntry,e)}(),function(){var e=game.View.extends({_cfg:null,_showModel:!0,ctor:function(){this._super(274)},onShow:function(){var e=game.SceneUnitCfg.getData(game.csWarData.preMineId);e&&(this.skin.desc.string=e.desc,this.skin.name.string=e.name)},onStageResize:function(){var e=b8e.stageWidth,t=.5*b8e.stageHeight+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.CsWarMinePre,e)}(),function(){var e=game.View.extends({_cfg:null,_showModel:!0,ctor:function(){this._super(268)},init:function(){var e=this;e.sortList=[],e.camp1={langKey:3735,score:0},e.sortList.push(e.camp1),e.camp2={langKey:3736,score:0},e.sortList.push(e.camp2),e.camp3={langKey:3737,score:0},e.sortList.push(e.camp3)},onShow:function(){var e=this,t=e.skin;e.camp1.score=game.csWarData.endCampScore1,e.camp2.score=game.csWarData.endCampScore2,e.camp3.score=game.csWarData.endCampScore3,e.sortList.sort(e.onSort),0<e.sortList[0].score?t.firstName.string=game.Lang.get(e.sortList[0].langKey,e.sortList[0].score):t.firstName.string=game.Lang.get(3720),0<e.sortList[1].score?t.secondName.string=game.Lang.get(e.sortList[1].langKey,e.sortList[1].score):t.secondName.string=game.Lang.get(3720),0<e.sortList[2].score?t.thirdName.string=game.Lang.get(e.sortList[2].langKey,e.sortList[2].score):t.thirdName.string=game.Lang.get(3720),e.endTime=game.SysTime.curTime+1e4,e.timer||(e.timer=b8e.Timer.add(e,e.updateTime,500)),e.timer.reset(),e.timer.start()},updateTime:function(){if(!this.endTime)return this.skin.returnLab.string=game.Lang.get(9115),void this.stopTime();var e=this.endTime-game.SysTime.curTime;if(e<=0)return this.skin.returnLab.string=game.Lang.get(9115),void this.stopTime();this.skin.returnLab.string=game.Lang.get(9496,game.TimeUtil.formatTimeSpace(e))},stopTime:function(){this.timer&&this.timer.stop(),game.module.hide(this.moduleEnum)},onSort:function(e,t){return t.score-e.score},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CsWarEnd,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1}),b8e.RC("$$game","$$CsBossChallengeEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1}),b8e.RC("$$game","$$CsBossTopLeftEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_VIEW:-1}),b8e.RC("$$game","$$CsBossPlayerRankEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_RESET_DAILY:-1}),b8e.RC("$$game","$$CsBossPlayerAwardEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_VIEW:-1}),b8e.RC("$$game","$$CsBossGuildRankEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_RESET_DAILY:-1}),b8e.RC("$$game","$$CsBossGuildAwardEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V_SELECT_CHANGE:-1,C2C_SYS_RANK:-1}),b8e.RC("$$game","$$CsBossRankEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_SYS_DATA:-1,C2C_SYS_BOSS_DATA:-1,C2C_CHALLENGE:-1,C2C_JOIN:-1,C2C_OPEN_STATE:-1,C2V_RESET_DAILY:-1,C2C_RESET_DAILY:-1}),b8e.RC("$$game","$$CsBossEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_ENTER:-1}),b8e.RC("$$game","$$CsBossEnterEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,C2V_UPDATE_TIME:-1,C2V_UPDATE_CHECK:-1,C2V_UPDATE_PRO:-1,C2C_SHOW_RANK:-1,V_FOLLOW_CHAT:-1}),b8e.RC("$$game","$$CsBossBottomEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V_FOLLOW_CHAT:-1,C2V_UPDATE_VIEW:-1,C2V_SKILL_HIT:-1}),b8e.RC("$$game","$$CsBossBattleEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,C2V_UPDATE_TIME:-1,V2C_SHOW_INFO:-1,V2C_PAGE_UP:-1,V2C_PAGE_DOWN:-1,V2C_SHOW_RANK:-1,C2C_SHOW_INFO:-1}),b8e.RC("$$game","$$CsBossTopRightEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V_SELECT_CHANGE:-1}),b8e.RC("$$game","$$CsBossAwardEvts",e)}(),function(){var e;e=b8e.Object.extends({rank:0,setData:function(e){this.rank=e.rank},getCfg:function(){return game.CsBossRankAwardCfg.getCfgByRank(this.rank)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$csBossAwardInfo",e)}(),function(){var e;e=b8e.Object.extends({rank:0,setData:function(e){this.rank=e.rank},getCfg:function(){return game.CsBossRankPlayerAwardCfg.getCfgByRank(this.rank)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$csBossPlayerAwardInfo",e)}(),function(){var e;e=b8e.Object.extends({rank:0,name:"",hurt:0,setData:function(){}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsBossRankInfo",e)}(),function(){var e;e=b8e.Object.extends({refresh:0,resetCount:0,ctor:function(e){this._super(),this.rank=e},setData:function(e){var t=this;e?(t.unitId=e.unitId,t.name=e.name,t.isMale=e.isMale,t.guildName=e.guildName,t.level=e.level,t.hp=e.hp,t.maxHp=e.maxHp,t.power=e.power,t.dmg=e.dmg,t.refresh++):t.clear()},clear:function(){this.unitId=0,this.name="",this.isMale=!0,this.guildName="",this.level=0,this.hp=0,this.maxHhp=0,this.power=0,this.dmg=0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$csBossPlayerRankInfo",e)}(),function(){var e;e=b8e.Object.extends({refresh:0,ctor:function(){this._super(),this.guildName="",this.dmg=0,this.rank=0,this.zone=0},setData:function(e){this.guildName=e.guildName,this.dmg=e.dmg,this.rank=e.rank,this.zone=e.zone,this.refresh++}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$csBossGuildRankInfo",e)}(),function(){var e=b8e.Object.extends({state:1,remTime:0,hp:0,maxHp:0,shield:0,maxShield:0,isAutoChallenge:!1,isHideBoss:!1,isHidePlayer:!1,reviveTime:0,guildRanks:0,myGuildRank:0,enterTime:0,oldGuildRanks:null,oldMyGuildRank:0,oldPlayerRanks:null,oldPlayerRankData:null,playerRanks:null,curPlayerRanks:null,curPlayerRankData:null,playerRankInfoPool:null,setup:function(e){var t=this;t.guildRanks=[],t.oldGuildRanks=[],t.curPlayerRanks=[],t.oldPlayerRanks=[],t.oldMyGuildRank=t.setupGuildRanks(e.ranks,t.oldGuildRanks),t.oldPlayerRank=t.setupViewPlayerRanks(e.playerRanks,t.oldPlayerRanks),t.isOpen=e.state,t.initPlayerRanks()},setupData:function(e){this.hp=e.hp,this.maxHp=e.maxHp,this.shield=e.shield,this.maxShield=e.maxShield,this.setupPlayerRanks(e.playerRanks)},setupGuildRanks:function(e,t){var a=t;if(a.length=0,!e||e.length<1)return 0;for(var i,n=0,s=0,o=e.length;s<o;s++)(i=new game.csBossGuildRankInfo).setData(e[s]),a.push(i),e[s].guildId==game.guildData.id&&(n=e[s].rank);return n},getGuildRanks:function(){return game.sceneData.getSceneType()==game.SceneType.CS_BOSS?this.guildRanks:this.oldGuildRanks},getMyGuildRank:function(){return game.sceneData.getSceneType()==game.SceneType.CS_BOSS?this.myGuildRank:this.oldMyGuildRank},initPlayerRanks:function(){if(this.playerRanks||(this.playerRanks=[]),!(0<this.playerRanks.length))for(var e,t=0;t<10;t++)(e=this.getPlayerRanksInfo(t+1)).clear(),this.playerRanks.push(e)},setupPlayerRanks:function(e){if(e&&!(e.length<1)){var t=this.playerRanks;if(t){e.sort(function(e,t){return e.rank-t.rank});for(var a=this.playerRank=0,i=t.length;a<i;a++)t[a].setData(e[a])}}},setupViewPlayerRanks:function(e,t){for(var a,i=0,n=t.length;i<n;i++)this.recyclePlayerRanksInfo(t[i]);if(t.length=0,!e||e.length<1)return null;var s=null;for(i=0,n=e.length;i<n;i++){var o=e[i];(a=this.getPlayerRanksInfo(o.rank)).setData(o),a.rank=o.rank,t.push(a),o.roleId==game.mainRoleData.roleId&&(s=o)}return s},getMyRank:function(){return game.sceneData.getSceneType()==game.SceneType.CS_BOSS?this.curPlayerRank:this.oldPlayerRank},getPlayerRanks:function(){return game.sceneData.getSceneType()==game.SceneType.CS_BOSS?this.curPlayerRanks:this.oldPlayerRanks},getPlayerRanksInfo:function(e){var t=0<arguments.length&&void 0!==e?e:0;return this.playerRankInfoPool||(this.playerRankInfoPool=[]),0<this.playerRankInfoPool.length?this.playerRankInfoPool.pop():new game.csBossPlayerRankInfo(t)},recyclePlayerRanksInfo:function(e){this.playerRankInfoPool||(this.playerRankInfoPool=[]),e&&(e.clear(),this.playerRankInfoPool.push(e))},setupRanks:function(e,t){this.curPlayerRank=this.setupViewPlayerRanks(e,this.curPlayerRanks),this.myGuildRank=this.setupGuildRanks(t,this.guildRanks)},resetAwards:function(){this.guildAwards=null,this.playerAwards=null},getGuildAwards:function(){var e=this.guildAwards;if(e)return e;this.guildAwards=e=[];for(var t,a=game.CsBossRankAwardCfg.getCurDayCfgs(),i=0,n=a.length;i<n;i++)(t=new game.csBossAwardInfo).setData(a[i]),e.push(t);return e},getPlayerAwards:function(){var e=this.playerAwards;if(e)return e;this.playerAwards=e=[];for(var t,a=game.CsBossRankPlayerAwardCfg.getCurDayCfgs(),i=0,n=a.length;i<n;i++)(t=new game.csBossPlayerAwardInfo).setData(a[i]),e.push(t);return e},resetGuildRanks:function(){var e=this.oldGuildRanks;if(e&&0<e.length)for(var t=e.length,a=0;a<t;a++)e[a].resetCount++},resetPlayerRanks:function(){var e=this.oldPlayerRanks;if(e&&0<e.length)for(var t=e.length,a=0;a<t;a++)e[a].resetCount++},isInCoolTime:function(){var e=game.SysTime.curTime;if(0<this._coolEndTime&&this._coolEndTime>e){var t=(this._coolEndTime-e)/1e3>>0;return 0<t&&game.notice.show(3821,t),!0}return!1},mainLeaveScene:function(){this.setCoolTime()},setCoolTime:function(){var e=game.SysTime.curTime,t=this.getCoolTime();this._coolEndTime=e+t*b8e.TimeUtil.SECOND_MICRO_SECONDS},getCoolTime:function(){if(this._coolTime)return this._coolTime;var e=game.ThroneMiscCfg.getData("throneCoolTime");return e&&""!=e.value?(this._coolTime=+e.value,this._coolTime):void 0}});game.csBossData=game.csBossData||new e}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsBossRank:{C2C_SYS_RANK:this.sysRank}}},sysRank:function(){this.send(this.Evts.C2V_UPDATE_VIEW)}});b8e.module.registerControl(game.ME.CsBossPlayerRank,e,game.CsBossPlayerRankEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.handels={CrossBossRankResp:this.onCrossBossRankRsp},this.evts={CsBossBottom:{C2C_SHOW_RANK:this.showRank}}},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)},showRank:function(){this.sender.CrossBossRankReq()},onCrossBossRankRsp:function(e){var t=e.readProtobuf(game.pb.CrossBossRankResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csBossData.setupRanks(t.playerRanks,t.guildRanks);this.dpt(this.Evts.C2C_SYS_RANK)}}}),t=game.Sender.extends({ipc:function(){this.msg={CrossBossRankReq:null}}});b8e.module.registerControl(game.ME.CsBossRank,e,game.CsBossRankEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.gevts={SceneGEvts:{ENTER_SCENE:this.enterScene}}},enterScene:function(){if(game.sceneData.getSceneType()==game.SceneType.CS_BOSS){var e=game.csBossData;e.isHideBoss=!1,this.hideBoss(e.isHideBoss),e.isHidePlayer=!1,this.hideOtherPlayer(e.isHidePlayer),this.hideNickName(),this.send(this.Evts.C2V_UPDATE_VIEW)}},hideNickName:function(){b8e.scene.setMaxAttachNum(game.RoleType.Hero,game.AnimType.NICK_NAME,0),game.playBackScene.scene.setMaxAttachNum(game.RoleType.Hero,game.AnimType.NICK_NAME,0)},hideBoss:function(e){b8e.scene.setMaxRenderNum(game.RoleType.Monster,e?0:9999)},hideOtherPlayer:function(e){b8e.scene.setMaxRenderNum(game.RoleType.Hero,e?0:9999)},hideBossBtn:function(){var e=game.csBossData,t=e.isHideBoss=!e.isHideBoss;this.hideBoss(t),this.send(this.Evts.C2V_UPDATE_VIEW)},hidePlayerBtn:function(){var e=game.csBossData,t=e.isHidePlayer=!e.isHidePlayer;this.hideOtherPlayer(t),this.send(this.Evts.C2V_UPDATE_VIEW)}});b8e.module.registerControl(game.ME.CsBossTopLeft,e,game.CsBossTopLeftEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this._alertOptions={lang:718,okcb:this.onClickGameAlert,thisArg:this},this.evts={CsBoss:{C2C_SYS_DATA:this.sysData,C2C_SYS_BOSS_DATA:this.sysData}}},sysData:function(e){var t=e.data;if(t){0<t.remTime&&this.createTimer(),this.send(this.Evts.C2V_UPDATE_VIEW,t)}},createTimer:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){var e=game.csBossData;e.remTime--,this.send(this.Evts.C2V_UPDATE_TIME,e),e.remTime<1&&this.clearTimer()},notify:function(e,t){switch(e){case this.Evts.V2C_SHOW_INFO:this.dpt(this.Evts.C2C_SHOW_INFO,t)}},upBtn:function(){this.send(this.Evts.V2C_PAGE_UP)},downBtn:function(){this.send(this.Evts.V2C_PAGE_DOWN)},showRankBtn:function(){this.send(this.Evts.V2C_SHOW_RANK)},hideRankBtn:function(){this.send(this.Evts.V2C_SHOW_RANK)},exitBtn:function(){game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_EXIT)}});b8e.module.registerControl(game.ME.CsBossTopRight,e,game.CsBossTopRightEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.gevts={InstanceEvts:{G_SKILL_HIT:this.onSkillHit}}},onSkillHit:function(e){if(b8e.module.isShowView(game.ME.CsBossBattle)){var t=e.data;if(t&&t.roleData.type==game.RoleType.Monster){var a=this;game.MonsterCfg.getDataAsync(t.roleId,function(e){e&&1==e.type&&a.send(a.Evts.C2V_SKILL_HIT,t)},a)}}}});b8e.module.registerControl(game.ME.CsBossBattle,e,game.CsBossBattleEvts,null)}(),function(){var e=game.Control.extends({btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.CsBossAward,e,game.CsBossAwardEvts,null)}(),function(){var e=game.Control.extends({init:function(){this._alertOptions={lang:718,okcb:this.onClickGameAlert,thisArg:this},this._reliveOptions={lang:732,okcb:this.onClickReliveAlert,thisArg:this}},ipc:function(){this.gevts={SceneGEvts:{MAIN_ROLE_REVIVE:this.onRevive,CANCEL_AUTO_CHALLENGE:this.onCancelAuto}},this.evts={CsBoss:{C2C_SYS_DATA:this.sysData,C2C_SYS_BOSS_DATA:this.sysBossData}}},sysData:function(e){var t=e.data;if(t){1==t.state&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e3*t.remTime).call(this.autoChallage,this)),this.send(this.Evts.C2V_UPDATE_VIEW,t)}},sysBossData:function(e){var t=e.data;if(t){this.send(this.Evts.C2V_UPDATE_PRO,t)}},autoChallage:function(){game.csBossData.isAutoChallenge&&2==game.csBossData.state&&b8e.evt.dptG(game.SceneGEvts.SCENE_AUTO_CHALLENGE)},onRevive:function(){this.autoChallage()},exitBtn:function(){game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_EXIT)},reliveBtn:function(){this._reliveOptions.okcb=this.onClickRelive,game.alert.showTwo(this._reliveOptions)},onClickRelive:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_REVIVE,2)},rankBtn:function(){game.module.show(game.ME.CsBossRank),this.dpt(this.Evts.C2C_SHOW_RANK)},onCancelAuto:function(){game.csBossData.isAutoChallenge=!1,this.send(this.Evts.C2V_UPDATE_CHECK)},autoChallageBtn:function(){game.csBossData.isAutoChallenge=!game.csBossData.isAutoChallenge,this.send(this.Evts.C2V_UPDATE_CHECK),game.csBossData.isAutoChallenge&&2==game.csBossData.state&&b8e.evt.dptG(game.SceneGEvts.SCENE_AUTO_CHALLENGE)},autoReliveBtn:function(){game.sceneData.isAutoRelive?this.onClickReliveAlert():(this._reliveOptions.okcb=this.onClickReliveAlert,game.alert.showTwo(this._reliveOptions))},onClickReliveAlert:function(){game.sceneData.isAutoRelive=!game.sceneData.isAutoRelive,this.send(this.Evts.C2V_UPDATE_CHECK)}});b8e.module.registerControl(game.ME.CsBossBottom,e,game.CsBossBottomEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsBossTopRight:{C2C_SHOW_INFO:this.showInfo}}},showInfo:function(e){game.module.show(game.ME.CsBossChallenge),this.send(this.Evts.C2V_UPDATE_VIEW,e.data)},challengeBtn:function(){if(game.sceneHelper.isSameGuild(game.scenePick.target))game.notice.show(733);else switch(game.csBossData.state){case 1:game.notice.show(734);break;case 2:b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE);break;case 3:game.notice.show(735)}},cancelBtn:function(){game.module.hide(this.moduleEnum)}});b8e.module.registerControl(game.ME.CsBossChallenge,e,game.CsBossChallengeEvts,null)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.CS_BOSS,game.SAE.CS_ALERT)},ipc:function(){var e=this;e.evts={CsBossEnter:{C2C_ENTER:e.challenge},MainRole:{C_RESET_DAILY:e.resetDaily}},e.gevts={SceneGEvts:{MAIN_MOVE_COMPLETE:e.onMoveComplete,LEAVE_SCENE:e.leaveScene}},e.handels={CrossBossDataResp:e.onCrossBossDataRsp,CrossBossMsg:e.onCrossBossMsg,CrossBossJoinResp:e.onCrossBossJoinRsp,CrossBossStateMsg:e.onCrossBossStateMsg,CrossBossDataMsg:e.onCrossBossDataMsg,KillCountMsg:e.onKillCountMsg}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.CrossBossDataReq()},resetDaily:function(){game.CsBossRankAwardCfg.resetDaily(),game.CsBossRankPlayerAwardCfg.resetDaily(),game.csBossData.resetPlayerRanks(),game.csBossData.resetGuildRanks(),game.csBossData.resetAwards(),this.dpt(this.Evts.C2C_RESET_DAILY),this.send(this.Evts.C2V_RESET_DAILY)},leaveScene:function(){game.sceneData.getLastSceneType()==game.SceneType.CS_BOSS&&(game.csBossData.enterTime=60,this.createTimer())},createTimer:function(){this.enterTimer?(this.enterTimer.reset(),this.enterTimer.start()):this.enterTimer=b8e.Timer.add(this,this.updateTime,1e3)},clearTimer:function(){this.enterTimer&&(b8e.Timer.remove(this,this.updateTime),this.enterTimer=null)},updateTime:function(){game.csBossData.enterTime--,game.csBossData.enterTime<0&&this.clearTimer()},checkAlert:function(){this.spotAlert.alert=game.csBossData.isOpen&&game.moduleOpen.checkOpen(game.ME.CsBoss)},onCrossBossDataRsp:function(e){var t=e.readProtobuf(game.pb.CrossBossDataResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csBossData.setup(t),this.checkAlert(),this.dpt(this.Evts.C2C_SYS_DATA,game.csBossData),this.dpt(this.Evts.C2C_OPEN_STATE)}},onCrossBossMsg:function(e){var t=e.readProtobuf(game.pb.CrossBossNotify);if(0<t.code)game.notice.noticeError(t.code);else{game.csBossData.isOpen=t.state,this.checkAlert(),this.dpt(this.Evts.C2C_OPEN_STATE)}},onCrossBossDataMsg:function(e){var t=e.readProtobuf(game.pb.CrossBossDataNotify);if(0<t.code)game.notice.noticeError(t.code);else{game.csBossData.setupData(t);this.dpt(this.Evts.C2C_SYS_BOSS_DATA,game.csBossData)}},onCrossBossJoinRsp:function(e){var t=e.readProtobuf(game.pb.CrossBossJoinResponse);0<t.code?game.notice.noticeError(t.code):(game.csBossData.isAutoChallenge=!1,game.shopData.setCACount(game.ShopConditionType.SHOPCSBOSS)&&this.dpt(this.Evts.C2C_UPDATE_SHOP_COUNT))},onCrossBossStateMsg:function(e){var t=e.readProtobuf(game.pb.CrossBossStateNotify);if(0<t.code)game.notice.noticeError(t.code);else{game.csBossData.state=t.state,game.csBossData.remTime=t.remTime,game.csBossData.isOpen=t.state<3;this.checkAlert(),this.dpt(this.Evts.C2C_SYS_DATA,game.csBossData)}},rankBtn:function(){game.module.show(game.ME.CsBossRank)},prizeBtn:function(){game.module.show(game.ME.CsBossAward)},challengeBtn:function(){game.moduleOpen.checkOpenWithTips(this.moduleEnum)&&this.challenge()},challenge:function(){game.csBossData.isInCoolTime()||(0<game.csBossData.enterTime?game.notice.show(3821,game.csBossData.enterTime):this.sender.CrossBossJoinReq())},onMoveComplete:function(e){var t=game.sceneData.getConfig();if(t&&t.type==game.SceneType.CS_BOSS)switch(e.data){case game.SceneMoveType.CLICK_PLAYER:game.challengeIcon.show(game.scenePick.target);break;case game.SceneMoveType.CLICK_MONSTER:game.csBossData.isAutoChallenge?b8e.evt.dptG(game.SceneGEvts.SCENE_CHALLENGE):game.challengeIcon.show(game.scenePick.target);break;case game.SceneMoveType.CLICK_BOX:b8e.evt.dptG(game.SceneGEvts.CLICK_BOX)}},onKillCountMsg:function(e){var t=e.readProtobuf(game.pb.KillCountNotify);if(0<t.code)game.notice.noticeError(t.code);else{var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,t.unitId);a&&a.setKill(t.count)}},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.GUILD_BOSS_FULI)}}),t=game.Sender.extends({ipc:function(){this.msg={CrossBossDataReq:null,CrossBossJoinReq:null}}});b8e.module.registerControl(game.ME.CsBoss,e,game.CsBossEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsBoss:{C2C_OPEN_STATE:this.checkShowEnter}}},checkShowEnter:function(){if(game.csBossData.isOpen){game.moduleOpen.checkOpen(game.ME.CsBoss)&&game.module.show(this.moduleEnum)}},enterBtn:function(){game.module.hide(this.moduleEnum),this.dpt(this.Evts.C2C_ENTER)}});b8e.module.registerControl(game.ME.CsBossEnter,e,game.CsBossEnterEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsBoss:{C2C_RESET_DAILY:this.resetDaily}}},resetDaily:function(){this.send(this.Evts.C2V_RESET_DAILY)}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.CsBossGuildAward,e,game.CsBossGuildAwardEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsBossRank:{C2C_SYS_RANK:this.sysRank}}},sysRank:function(){this.send(this.Evts.C2V_UPDATE_VIEW)}});b8e.module.registerControl(game.ME.CsBossGuildRank,e,game.CsBossGuildRankEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsBoss:{C2C_RESET_DAILY:this.resetDaily}}},resetDaily:function(){this.send(this.Evts.C2V_RESET_DAILY)}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.CsBossPlayerAward,e,game.CsBossPlayerAwardEvts,t)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(212),this.setSize(540,94)},init:function(){this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.layout.paddingLeft=0,this._prizeList.layout.spacingX=2,this._prizeList.addToParent(this.skin.prizeView)},setData:function(e){var t=e.getCfg();this.skin.rankLab.string=t.range;var a=3<e.rank?4:e.rank;this._rankBg=this.getComponent("rank"+a),this._rankBg&&(this._rankBg.node.active=!0);var i=game.CfgUtil.getPrizeListInfo(t.items,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_69);i&&i.items&&this._prizeList.setData(i.items)},clearData:function(){this._rankBg&&(this._rankBg.node.active=!1),this._prizeList&&this._prizeList.clear()},onHide:function(){}}),b8e.RC("$$game","$$CsBossAwardItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(213),this.toggles={toggle_btn_1:game.ME.CsBossGuildAward,toggle_btn_2:game.ME.CsBossPlayerAward}},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CsBossAward,e)}(),function(){var e=game.View.extends({_isMoveUp:!1,_specialLayer:!0,ctor:function(){this._super(214),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateView(t);break;case this.Evts.C2V_SKILL_HIT:this.onSkillHit(t)}},onShow:function(){},updateView:function(e){if(e){var t=this.skin;t.hpBg1.node.active=0<e.shield;var a=.7*b8e.stageWidth;this.skin.hpBg_1.width=a,this.skin.hpBg_2.width=a,this.barLen=a-21,t.shieldLab.x=this.skin.hpBg_1.x+.5*a,t.hpLab.x=this.skin.hpBg_2.x+.5*a,t.shield.node.width=this.barLen*e.shield/e.maxShield,t.shieldLab.string=e.shield+"/"+e.maxShield,t.hp.node.width=this.barLen*e.hp/e.maxHp,t.hpLab.string=e.hp+"/"+e.maxHp}},onSkillHit:function(e){this.updateView(e.roleData)},onHide:function(){},onStageResize:function(){b8e.stageHeight,b8e.stageWidth;this._isMoveUp=game.chatData.isOpenChat,this.setPosition(0,this.height+130)}});b8e.module.registerView(game.ME.CsBossBattle,e)}(),function(){var e=game.View.extends({_isMoveUp:!1,_specialLayer:!0,ctor:function(){this._super(215),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateView(t);break;case this.Evts.C2V_UPDATE_CHECK:this.setAutoBtnState();break;case this.Evts.C2V_UPDATE_PRO:this.setBossPro(t)}},onShow:function(){this.updateView(game.csBossData)},updateView:function(e){if(e){this.skin;this.setBossPro(e),this.setAutoBtnState(e)}},setBossPro:function(e){var t=this.skin,a=.7*b8e.stageWidth;this.skin.hpBg_1.width=a,this.skin.hpBg_2.width=a,this.barLen=a-21,t.shieldLab.x=this.skin.hpBg_1.x+.5*a,t.hpLab.x=this.skin.hpBg_2.x+.5*a,t.hpBg1.node.active=0<e.shield;var i=e.shield/e.maxShield;t.shield.node.width=this.barLen*i,t.shieldLab.string=(100*i).toFixed(2)+"%",t.hp.node.width=this.barLen*e.hp/e.maxHp,t.hpLab.string=e.hp+"/"+e.maxHp},setAutoBtnState:function(){var e=this.skin;e.autoRelive.node.active=game.sceneData.isAutoRelive,e.autoChallage.node.active=game.csBossData.isAutoChallenge},onStageResize:function(){b8e.stageHeight,b8e.stageWidth;this._isMoveUp=game.chatData.isOpenChat,this.setPosition(0,this.height+320)}});b8e.module.registerView(game.ME.CsBossBottom,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(216)},notify:function(e,t){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateView(t)}},onHide:function(){var e=this.role;e&&e.removeFromParent(),this.selectData=null},updateView:function(e){this.selectData=e;var t=this.skin;t.nameLab.string=e.name,t.powerLab.string=e.power,t.lvLab.string=e.level,t.guildLab.string=e.guildName,t.rankLab.string=e.rank,t.hurtLab.string=game.CCommonUtil.replaceNum(e.dmg),t.hpLab.string=e.hp+"/"+e.maxHp,t.hp.node.width=410*e.hp/e.maxHp;var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.unitId);if(a&&a.data){this.role=game.sceneRoleCreate.createUIRole(a.data);var i=game.AvatarUtil;i.updateUIModel(this.role,i.ID_2),this.role.addToParent(t.modelRoot)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CsBossChallenge,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(217)},onStageResize:function(){var e=b8e.stageWidth-this.width;this.setPosition(e-17,320)}});b8e.module.registerView(game.ME.CsBossEnter,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(218)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.CsBossAwardItem,e._list.layout.paddingLeft=0,e._list.layout.paddingTop=0,e._list.layout.spacingY=5,e._list.addToParent(e.skin.prizeView),e._prizeList1=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList1.itemRender=game.ShowItemListItem,e._prizeList1.layout.paddingLeft=0,e._prizeList1.addToParent(e.skin.prizeView1),e._prizeList2=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList2.itemRender=game.ShowItemListItem,e._prizeList2.layout.paddingLeft=0,e._prizeList2.addToParent(e.skin.prizeView2),e._prizeList3=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList3.itemRender=game.ShowItemListItem,e._prizeList3.layout.paddingLeft=0,e._prizeList3.addToParent(this.skin.prizeView3)},notify:function(e){switch(e){case this.Evts.C2V_RESET_DAILY:this.createPrize()}},createPrize:function(){var e=game.csBossData.getGuildAwards();this._list.setData(e),this._prizeList1.setData(this._createPrizeItems("crossBossAward1")),this._prizeList2.setData(this._createPrizeItems("crossBossAward2")),this._prizeList3.setData(this._createPrizeItems("crossBossAward3"))},_createPrizeItems:function(e){for(var t,a,i=game.CsMiscCfg.getData(e).value.split("|"),n=[],s=0,o=i.length;s<o;s++)a=i[s].split(","),(t=game.ItemInfo.get()).id=parseInt(a[0]),t.num=parseInt(a[1]),t.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,t.iconSize=game.IconSizeEnum.GRID_SIZE_69,n.push(t);return n},onShow:function(){this.createPrize()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CsBossGuildAward,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(219)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updataView()}},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.CsBossRankItem,this._list.layout.paddingLeft=10,this._list.layout.spacingY=5,this._list.addToParent(this.skin.rankView)},updataView:function(){var e=game.csBossData,t=e.getMyGuildRank();this.skin.mineRankLab.string=game.Lang.get(5333,0<t?t:"--"),this._list.setData(e.getGuildRanks())},onShow:function(){this.updataView()},onHide:function(){this._list&&this._list.clear()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CsBossGuildRank,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(220)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.CsBossAwardItem,this._list.layout.paddingLeft=0,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.prizeView)},notify:function(e){switch(e){case this.Evts.C2V_RESET_DAILY:this.createPrize()}},createPrize:function(){var e=game.csBossData.getPlayerAwards();this._list.setData(e)},onShow:function(){this.createPrize()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CsBossPlayerAward,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(221),this.setSize(92,96)},init:function(){this._headIcon=b8e.Sprite.get(),this._headIcon.setAnchor(.5,.5),this._headIcon.setSize(64,64),this._headIcon.addToParent(this.skin.icon)},setData:function(e){this.skin.rankLab.string=e.rank;var t=e.unitId<1;if(this.skin.nameBg.node.active=!t,this.skin.hintLab.node.active=t)this._headIcon.unloadTexture();else{var a=game.ResCfg.getHead(e.isMale);this._headIcon.loadTexture(a),this.skin.nameLab.string=game.Lang.get(725,e.name,e.guildName)}},clickBtn:function(){var e=this.data;if(!(e.unitId<1)){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.unitId);t?(game.scenePick.pick(t,!1),this.send(game.CsBossTopRightEvts.V2C_SHOW_INFO,e)):game.notice.show(726)}}}),b8e.RC("$$game","$$CsBossPlayerItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(219)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updataView()}},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.CsBossPlayerRankItem,this._list.layout.paddingLeft=10,this._list.layout.spacingY=5,this._list.addToParent(this.skin.rankView)},updataView:function(){var e=game.csBossData,t=e.getMyRank(),a=t&&0<t.rank?t.rank:"--",i=t?t.dmg:0;this.skin.mineRankLab.string=game.Lang.get(5334,a,i),this._list.setData(e.getPlayerRanks())},onShow:function(){this.updataView()},onHide:function(){this._list&&this._list.clear()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CsBossPlayerRank,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(222),this.setSize(550,91)},init:function(){this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.layout.paddingLeft=0,this._prizeList.layout.spacingX=5,this._prizeList.addToParent(this.skin.prizeView)},setData:function(e){this.skin.nameLab.string=game.HtmlUtil.getColorStrByRank(e.rank,e.guildName),this.skin.hurtLab.string=game.Lang.get(724,game.CCommonUtil.replaceNum(e.dmg,1)),this.skin.rankLab.string=e.rank;var t=3<e.rank?4:e.rank;this._rankBg=this.getComponent("rank"+t),this._rankBg&&(this._rankBg.node.active=!0),this.createPrize(e.rank)},createPrize:function(e){var t=game.CsBossRankAwardCfg.getDataByRank(e);if(t){var a=game.CfgUtil.getPrizeListInfo(t.items,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_69);a&&a.items&&this._prizeList.setData(a.items)}},clearData:function(){this._rankBg&&(this._rankBg.node.active=!1),this._prizeList&&this._prizeList.clear()},onHide:function(){this.clearData()}}),b8e.RC("$$game","$$CsBossRankItem",e)}(),function(){var e;e=game.CsBossRankItem.extends({setData:function(e){this.skin.nameLab.string=game.HtmlUtil.getColorStrByRank(e.rank,e.name),this.skin.hurtLab.string=game.Lang.get(5332,game.CCommonUtil.replaceNum(e.dmg,1)),this.skin.rankLab.string=e.rank;var t=3<e.rank?4:e.rank;this._rankBg=this.getComponent("rank"+t),this._rankBg&&(this._rankBg.node.active=!0),this.createPrize(e.rank)},createPrize:function(e){var t=game.CsBossRankPlayerAwardCfg.getDataByRank(e);if(t){var a=game.CfgUtil.getPrizeListInfo(t.items,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_69);a&&a.items&&this._prizeList.setData(a.items)}}}),b8e.RC("$$game","$$CsBossPlayerRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(223),this.toggles={toggle_btn_1:game.ME.CsBossGuildRank,toggle_btn_2:game.ME.CsBossPlayerRank}},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},onShow:function(){game.sceneData.getSceneType()==game.SceneType.CS_BOSS?this.skin.titleLab.string=game.Lang.get(9109):this.skin.titleLab.string=game.Lang.get(9110)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CsBossRank,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(224),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.setCheckState()}},onShow:function(){this.setCheckState()},setCheckState:function(){var e=this.skin,t=game.csBossData;e.check3.node.active=t.isHideBoss,e.check4.node.active=t.isHidePlayer},onStageResize:function(){var e=b8e.stageHeight;this.setPosition(0,e-50-120)}});b8e.module.registerView(game.ME.CsBossTopLeft,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(225),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){this._rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._rankList.itemRender=game.CsBossPlayerItem,this._rankList.bindEnum=game.ME.CsBossTopRight,this._rankList.layout.paddingLeft=10,this._rankList.layout.spacingY=14,this._rankList.addToParent(this.skin.playerView)},notify:function(e,t){var a=this;switch(e){case a.Evts.C2V_UPDATE_VIEW:a.updateView(t);break;case a.Evts.C2V_UPDATE_TIME:a.updateTime(t);break;case a.Evts.V2C_PAGE_UP:a._rankList.scrollToTop();break;case a.Evts.V2C_PAGE_DOWN:a._rankList.scrollToBottom();break;case a.Evts.V2C_SHOW_RANK:a.showRank()}},showRank:function(){var e=this.skin.mask,t=e.height<580,a=t?580:30,i=200*e.height/580;b8e.Tween.kill(e),b8e.Tween.get(e).to({height:a},i),this.setShowRankBtn(t)},setShowRankBtn:function(e){this.skin.hideRankBtn.active=!e,this.skin.showRankBtn.active=e},updateView:function(e){this._rankList.setData(e.playerRanks),this.updateTime(e)},updateTime:function(e){var t=e.state,a=b8e.TimeUtil.formatTime(1e3*e.remTime),i=0;i=1==t?720:2==t?721:722;var n=this.skin;n.timeLab.string=game.Lang.get(i,a),n.exitTime.node.active=3==t,n.exitTimeLab.string=game.Lang.get(731,e.remTime)},onShow:function(){this._rankList.setData(game.csBossData.playerRanks),this.skin.mask.height=580,this.setShowRankBtn(!0)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e,t-55)}});b8e.module.registerView(game.ME.CsBossTopRight,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(226)},init:function(){var e=this;e._bgImg=b8e.Sprite.get(),e._bgImg.setAnchor(0,1),e._bgImg.addToParent(e.skin.bg),e.createBg(),e.awardsList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),e.awardsList.itemRender=game.PrizeListItem,e.awardsList.bindEnum=e.moduleEnum,e.awardsList.addToParent(e.skin.prizeNode),e.awardsList.layout.paddingLeft=26,e.awardsList.layout.paddingTop=10,e.awardsList.layout.spacingX=26,e.awardsList.layout.spacingY=0,e.setShopBtn();var t=game.CsMiscCfg.getData("crossBossDesc");t&&""!=t.value&&(e.skin.hintLab.string=t.value)},_createPrizeItems:function(){var e=game.CrossBossShowCfg.getDatas();if(e&&!(e.length<1)){for(var t=e.length,a=game.miscData.openServerDay,i=void 0,n=void 0,s=0;s<t;s++)if((i=e[s]).serverStart<=a&&a<i.serverEnd){n=i;break}if(n){var o=game.CfgUtil.getPrizeListInfo(n.showItems);this.awardsList.setData(o.items)}}},notify:function(e){switch(e){case this.Evts.C2V_RESET_DAILY:this._createPrizeItems()}},createBg:function(){this._bgImg.loadTexture(game.ResCfg.getUrl(10004))},onShow:function(){this._createPrizeItems()},setShopBtn:function(){}});b8e.module.registerView(game.ME.CsBoss,e)}(),function(){var e=game.TeamControl.extends({csTeamAlert:null,csTeamDoubleAlert:null,init:function(){this.curTeamInstType=game.TeamInstType.CS_TEAM,this.memberIds=[],this.teamData=game.csTeamData,this.csTeamAlert=game.spotAlert.set(game.SAE.CS_TEAM_ALERT,game.SAE.ACTIVITIES_HALL),this.csTeamDoubleAlert=game.spotAlert.set(game.SAE.CS_TEAM_DOUBLE_ALERT),this.teamData.initData()},test:function(){this.teamData.initBossList()},ipc:function(){var e=this;e.gevts={SceneGEvts:{FIRST_ENTER_SCENE:e.firstEnterScene}},e.evts={MainRole:{C_LEVEL_UP:e.levelUP},TeamHandel:{C_SET_TEAM:e._setTeamData,C_TEAM_CREATE:e._createTeam,C_TEAM_JOIN:e._joinTeam,C_TEAM_LEAVE:e._leaveTeam,C_KICK_MEMBER:e._kickMember,C_TEAM_QUICK_JOIN:e._quickJoinTeam,C_TEAM_JOIN_NOTIFY:e._joinTeamNotify,C_TEAM_LEAVE_NOTIFY:e._leaveTeamNotify,C_ENTER_BATTLE:e._enterBattle,C_BATTLE_END:e._battleEnd,C_TEAM_RATE:e._teamRate,C2C_TEAM_EMBATTLE:e._teamEmbattle,C2C_TEAM_PARTNER_TEAM_EMBATTLE:e._partnerTeamEmbattle,C2C_TEAM_INVITE_COOL_TIME:e._teamInviteCoolTime},MainUIChat:{C_REQ_ENTER_TEAM:e.inviteJoin},ZhanJiang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},ZhaoQin:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},BaoZang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Hunting:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Scene:{ENTER_CS_SCENE:e.stopAutoBattle,C2C_RECONNECT_ENTER_SCENE:e.reconnect}}},triggerOpen:function(e){e==this.moduleEnum&&(this.teamDataReq(0),this.checkCsTeamAlert(),this.checkCsTeamDoubleAlert())},firstEnterScene:function(){},reconnect:function(){this.teamData.clearTeamData(),b8e.module.isShowView(game.ME.CsTeamDetailsView)&&game.module.hide(game.ME.CsTeamDetailsView)},notify:function(e,t,a){var i=this;switch(e){case i.Evts.V_SHOW_VIEW:i.showView();break;case i.Evts.V_KICK_MEMBER:i.kickMember(t);break;case i.Evts.V_JOIN_TEAM:i.joinTeam(t,a);break;case i.Evts.V_SELECT_BOSS:i.selectBoss(t);break;case i.Evts.V_HIDE_VIEW:i.hideView();break;case i.Evts.V2C_TEAM_OPEN_SELECT_PARTNER_PANEL:i.openTeamSelectPartnerPanel(t);break;case i.Evts.V2C_TEAM_CHANGE_BATTLE_PARTNER_REQ:i.partnerTeamEmbattleReq(t);break;case i.Evts.V2C_TEAM_PARTNER_UPDATE_POS_REQ:i.teamPartnerUpdatePosReq();break;case i.Evts.V2C_TEAM_CHECK_TIME:i.checkTime()}},openTeamSelectPartnerPanel:function(e){this.teamData&&this.teamData.isInTeam&&(this.setCurSelectPartnerId(e),b8e.module.isShowView(game.ME.CsTeamSelectPartnerView)||game.module.show(game.ME.CsTeamSelectPartnerView))},checkInstCanEnter:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t;this.invInstId=0;var i=game.mainRoleData.lv,n=game.TeamInstanceCfg.getData(e);return n?n.limitLv>i?(a&&game.notice.show(9111),!1):(this.invInstId=e,!0):(b8e.error("\u5bf9\u5e94\u7ec4\u961f\u526f\u672c\u914d\u7f6e\u4e0d\u5b58\u5728"),!1)},showTeamInstView:function(){b8e.module.isShowView(game.ME.CsTeam)||game.module.showToggle(game.ME.ActivitiesHall,0)},levelUP:function(){this.teamData.refreshBossList(),this.send(this.Evts.V_REFRESH_BOSS_LIST)},_setTeamData:function(e){this._super(e),this.checkCsTeamAlert(),this.checkCsTeamDoubleAlert()},_battleEnd:function(e){var t=e.data,a=t.type,i=t.rp;if(a==this.curTeamInstType){var n={type:game.InstanceType.CS_TEAM,rewards:i.useritem,exp:i.exp};game.GameViewMgr.inst().hideUnStrongViews(),game.playBack.play(i.battlelog,n),i.battlelog.win&&this.teamData.teamBattle(),i.battlelog&&i.battlelog.win&&this.dpt(this.Evts.C2C_CSTEAM_NOTIFY)}},_partnerTeamEmbattle:function(e){e.data.type==this.curTeamInstType&&(b8e.module.isShowView(game.ME.CsTeamSelectPartnerView)&&game.module.hide(game.ME.CsTeamSelectPartnerView),this._super(e))},_teamRate:function(e){this._super(e),this.checkCsTeamDoubleAlert()},createTeam:function(e){b8e.module.isShowView(game.ME.ActivitiesHall)&&game.module.hide(game.ME.ActivitiesHall),b8e.module.isShowView(game.ME.CsTeamDetailsView)||game.module.show(game.ME.CsTeamDetailsView),this._super(e)},_leaveTeam:function(e,t){t?this._super(e):this.__leaveTeam(e,1)},_leaveTeamNotify:function(e,t){t?this._super(e):this.__leaveTeam(e,2)},__leaveTeam:function(e,t){e.data.type==game.TeamInstType.CS_TEAM&&(1==t?this._leaveTeam(e,!0):2==t&&this._leaveTeamNotify(e,!0),this._openViewState(e))},_openViewState:function(e){var t=e.data.rp;game.mainRoleData.roleId==t.roleid&&(b8e.module.isShowView(game.ME.CsTeamDetailsView)&&game.module.hide(game.ME.CsTeamDetailsView),game.module.showToggle(game.ME.ActivitiesHall,1))},showView:function(){if(this._super(),0<this.invInstId)this.teamData.curInsId=this.invInstId;else if(!this.teamData.isInTeam){var e=game.mainRoleData.lv,t=game.TeamInstanceCfg.getCurInsId(e);this.teamData.curInsId=t}this.selectBoss(this.teamData.curInsId)},selectBoss:function(e){var t=this,a=game.TeamInstanceCfg.getData(e);a&&(game.mainRoleData.lv<a.limitLv&&!t.teamData.isInTeam?(t.teamData.isAutoJoin=!1,t.stopAutoTime(),t.send(t.Evts.V_UPDATE_AUTO),t.send(t.Evts.V_UPDATE_TIME)):t.teamData.isInTeam||(t.autoReqTime=0,t.setAutoJoinTime(),t.startAutoReq()),t._super(e))},checkCsTeamAlert:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.csTeamAlert.alert=0<this.teamData.hasCount)},checkCsTeamDoubleAlert:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.csTeamDoubleAlert.alert=2==this.teamData.rate)}}),t=[game.ME.CsTeamDetailsView,game.ME.CsTeamSelectPartnerView];b8e.module.registerControl(game.ME.CsTeam,e,game.TeamEvts,null,t)}(),function(){var e=game.teamData.extends({ctor:function(){this._super(),this.curTeamInstType=game.TeamInstType.CS_TEAM},initData:function(){var e;if((e=game.InstanceMiscCfg.getData("teamAutoLv"))&&(this.teamAutoLv=0|e.value),(e=game.InstanceMiscCfg.getData("teamInsChallengeNum"))&&(this.maxCount=0|e.value),e=game.InstanceMiscCfg.getData("teamInsDoubleTime")){var t,a=e.value.split("|");if(a&&0<a.length)a[0]&&(t=a[0].split("-"),this.doubleTime1=t[0]+"-"+t[1]),a[1]&&(t=a[1].split("-"),this.doubleTime2=t[0]+"-"+t[1])}},initBossList:function(){if(!this.isInitData){var e=game.mainRoleData.lv;this.isInitData=!0;var t=game.TeamInstanceCfg.getList();if(t&&!(t.length<=0))for(var a,i=t.length,n=0;n<i;n++){a=t[n];var s=new game.TeamBossInfo;s.id=a.id,s.isOpen=a.limitLv<=e,this.bossInfoList.push(s)}}},refreshBossList:function(){for(var e=game.mainRoleData.lv,t=this.bossInfoList.length,a=0;a<t;a++){var i,n=this.bossInfoList[a];(i=game.TeamInstanceCfg.getData(n.id))&&i.limitLv<=e&&(n.isOpen=!0,this.bossInfoList[a]=n)}}});game.csTeamData=game.csTeamData||new e}(),function(){var e;e=game.TeamBossItem.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:"";t=t||1218,this._super(t)},setData:function(){this._super(),this.setElementBtn(this.cfg)},setBossModel:function(){this._super(1)},setDesc:function(){var e=this.data,t=this.skin;e.isOpen?(t.desc.node.color=game.Color.GREEN,t.desc.string=game.Lang.get(e.isFirst?10010:10011)):(t.desc.node.color=game.Color.RED,t.desc.string=game.Lang.get(10012,this.cfg.limitLv))}}),b8e.RC("$$game","$$CsTeamBossItem",e)}(),function(){var e=game.TeamView.extends({ctor:function(){this._super()},init:function(){var e=this;e.teamData=game.csTeamData,e.curTeamInstType=game.TeamInstType.CS_TEAM,e._super(),e.bossList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.bossList.itemRender=game.CsTeamBossItem,e.bossList.bindEnum=e.moduleEnum,e.bossList.addToParent(e.skin.bossList),e.bossList.layout.paddingLeft=0,e.bossList.layout.paddingRight=0,e.bossList.layout.spacingX=5,e.skin.doubleTimeLab.string=game.Lang.get(1001)},onShow:function(){this._super(),this.selectBtn()},onHide:function(){this._super(),this.bossList.scrollToLeft(0)},setTeamBossList:function(){this._super()},selectBtn:function(){var e=this.teamData.getBossInfoList();if(e&&!(e.length<=0)){var t=this.teamData.selectIdx;t&&0!=t?this.bossList.scrollToRight(184*t):this.bossList.scrollToLeft(0)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CsTeam,e)}(),function(){var e=game.TeamDetailsView.extends({ctor:function(){this._super(),this.bindModuleEnum=game.ME.CsTeam},init:function(){this._super(),this.teamData=game.csTeamData,this.curTeamInstType=game.TeamInstType.CS_TEAM},onHide:function(){this._super(),game.module.showToggle(game.ME.ActivitiesHall,0)}});b8e.module.registerView(game.ME.CsTeamDetailsView,e)}(),function(){var e=game.TeamSelectPartnerView.extends({ctor:function(){this._super(),this.bindModuleEnum=game.ME.CsTeam}});b8e.module.registerView(game.ME.CsTeamSelectPartnerView,e)}(),function(){var e;e=b8e.Enum({NONE:-1,V_SELECT_CHANGE:-1,C_INIT_MODULE:-1,C2C_TASK_PROGRESS:-1}),b8e.RC("$$game","$$DailyEvts",e)}(),function(){var e=game.Control.extends({btn_1:function(){this.send(this.Evts.V_SELECT_CHANGE,0)},btn_2:function(){this.send(this.Evts.V_SELECT_CHANGE,1)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.Daily,e,game.DailyEvts)}(),function(){var e=b8e.Object.extends({});game.dailyData=game.dailyData||new e}(),function(){var e=game.View.extends({ctor:function(){this._super(288),this.toggles={toggle_btn_1:game.ME.TaoFaPage,toggle_btn_2:game.ME.DailyJuyi},this.spotAlerts={CS_TEAM_DOUBLE_ALERT:this.csTeamDoubleAlert,DANGKOU_ALERT:this.dangkouAlert}},csTeamDoubleAlert:function(e){this.skin.double.node.active=e.alert},taofaAlert:function(e){this.skin.red_spot_1.active=e.alert},dangkouAlert:function(e){this.skin.red_spot_2.active=e.alert},onShow:function(){this.toggleSelect(0)},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},toggleSelect:function(e){this._super(e),this.skin.title_shanzei.active=0==e,this.skin.title_juyi.active=1==e},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.Daily,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,C2V_UPDATE_ITEM:-1,C2V_PAGE_LEFT:-1,C2V_PAGE_RIGHT:-1,V2C_GET_AWARD:-1,V2C_TASK_GET:-1,C_DAILYEXPLOIT_EXP:-1,C_DAILYEXPLOIT_EXP2:-1}),b8e.RC("$$game","$$DailyExploitEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,V2C_RECOVER:-1,C2C_RECOVER_SUCCEED:-1}),b8e.RC("$$game","$$DailyExploitRecoverEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.DAILY_EXPLOIT,game.SAE.DAILY_FULI),this.exploitData=game.dailyExploitData,this.exploitData.init()},ipc:function(){var e=this;e.evts={DailyFuLi:{C_INIT_MODULE:e.initModule,C2C_TASK_PROGRESS:e.onExperienceNotify},DailyExploitRecover:{C2C_RECOVER_SUCCEED:e.onRecoverSucceed},DailyOfficial:{C2C_GET_AWARD:e.checkAlert},Recharge:{C2C_CHANGE_CARD:e.checkAllAlert,C2C_WEEKCARE_OPEN:e.checkAllAlert},MainRole:{C_RESET_DAILY:e.resetDaily}},e.handels={DailyTaskAwardResp:e.awardResp,DailyActiveAwardResp:e.activeAwardResp}},initModule:function(e){var t=this;e&&e.data&&(t.initData=e.data,game.dailyExploitData.setup(t.initData),t.checkAlert(),t.send(t.Evts.C2V_UPDATE_VIEW),b8e.setTimeout(function(){t.dpt(game.DailyExploitEvts.C_DAILYEXPLOIT_EXP)},t,5e3))},notify:function(e,t){switch(e){case this.Evts.V2C_GET_AWARD:this.getAward(t);break;case this.Evts.V2C_TASK_GET:this.taskGet(t)}},resetDaily:function(){game.dailyExploitData.resetDaily()},onRecoverSucceed:function(){this.send(this.Evts.C2V_UPDATE_VIEW)},activeWeek:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.PRIVILEGE),game.module.hide(game.ME.DailyFuLi)},getAward:function(e){if(e){var t=e.active;if(game.dailyExploitData.experienceExpDaily>=t&&!e.isLock)this.sender.DailyActiveAwardReq(t,e.isWeekCard);else{game.dailyExploitData.showPrizeLayer=t;var a=game.DailyTaskActiveCfg.getDataByScore(game.dailyExploitData.openServer,t);game.dailyExploitData.showItems=a?e.isWeekCard?a.weekItems:a.items:null,game.module.show(game.ME.DailyExploitPrize)}}},taskGet:function(e){if(e){this.sender.DailyTaskAwardReq(e)}},awardResp:function(e){var t=e.readProtobuf(game.pb.DailyTaskAwardResponse);0<t.code?game.notice.noticeError(t.code):(this.exploitData.updateDailyTask(t),this.exploitData.updataShowAward(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),this.dpt(game.DailyExploitEvts.C_DAILYEXPLOIT_EXP),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},activeAwardResp:function(e){var t=e.readProtobuf(game.pb.DailyActiveAwardResponse);0<t.code?game.notice.noticeError(t.code):(this.exploitData.updateActiveAward(t),this.exploitData.updataWeekScore(t.dailyActive),this.exploitData.updataShowAward(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},onExperienceNotify:function(e){if(e&&e.data){var t=e.data;1==t.dailyType&&(this.exploitData.updateInfo(t.dailyType,t.dailyTask),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),this.dpt(game.DailyExploitEvts.C_DAILYEXPLOIT_EXP,t))}},checkAlert:function(){this.spotAlert.alert=this.exploitData.checkAlert()},checkAllAlert:function(){this.exploitData.updataShowAward(),this.checkAlert()},dailyIcon:function(){this.itemInfo||(this.itemInfo=game.ItemInfo.get(),this.itemInfo.id=game.dailyExploitData.dailyItemId),this.itemInfo.num=game.dailyExploitData.experienceExpDaily,game.tipsData.setInfo(this.itemInfo),game.module.show(game.ME.ItemTips)}}),t=[game.ME.DailyExploitPrize],a=game.Sender.extends({ipc:function(){this.msg={DailyTaskAwardReq:this.DailyTaskAwardReq,DailyActiveAwardReq:this.DailyActiveAwardReq}},DailyTaskAwardReq:function(e){var t=game.pb.DailyTaskAwardRequest;t.dailyExpType=e,this.write(t)},DailyActiveAwardReq:function(e,t){var a=game.pb.DailyActiveAwardRequest;a.dailyActive=e,a.activeType=t?2:1,this.write(a)}});b8e.module.registerControl(game.ME.DailyExploit,e,game.DailyExploitEvts,a,t)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.WEEKLY_TASK,game.SAE.DAILY_FULI),this.exploitData=game.dailyExploitData},ipc:function(){this.evts={DailyFuLi:{C_INIT_MODULE:this.initModule,C2C_TASK_PROGRESS:this.onExperienceNotify},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={WeekTaskAwardResp:this.awardResp,WeekActiveAwardResp:this.activeAwardResp}},initModule:function(e){e&&e.data&&(this.initData=e.data,game.dailyExploitData.setupWeekly(this.initData),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW))},awardResp:function(e){var t=e.readProtobuf(game.pb.WeekTaskAwardResponse);0<t.code?game.notice.noticeError(t.code):(this.exploitData.updateWeeklyTask(t),this.exploitData.updataShowWeekAward(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},activeAwardResp:function(e){var t=e.readProtobuf(game.pb.WeekActiveAwardResponse);0<t.code?game.notice.noticeError(t.code):(this.exploitData.updateWeekActiveAward(t),this.exploitData.updataShowWeekAward(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},resetDaily:function(){var e=game.SysTime.curTime;1==b8e.TimeUtil.getDay(e)&&game.dailyExploitData.resetWeekly()},onExperienceNotify:function(e){if(e&&e.data){var t=e.data;2==t.dailyType&&(this.exploitData.updateInfo(t.dailyType,t.dailyTask),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),this.dpt(game.DailyExploitEvts.C_DAILYEXPLOIT_EXP2,t))}},checkAlert:function(){this.spotAlert.alert=this.exploitData.checkWeekAlert()},notify:function(e,t){switch(e){case this.Evts.V2C_GET_AWARD:this.getAward(t);break;case this.Evts.V2C_TASK_GET:this.taskGet(t)}},getAward:function(e){if(e){var t=e.active;if(game.dailyExploitData.weekActive>=t)this.sender.WeekActiveAwardReq(t);else{game.dailyExploitData.showPrizeLayer=t;var a=game.WeekTaskActiveCfg.getDataByScore(game.dailyExploitData.weeklyOpenServer,t);game.dailyExploitData.showItems=a?a.items:null,game.module.show(game.ME.DailyExploitPrize)}}},taskGet:function(e){if(e){this.sender.WeekTaskAwardReq(e)}},dailyIcon:function(){this.itemInfo||(this.itemInfo=game.ItemInfo.get(),this.itemInfo.id=game.dailyExploitData.weeklyItemId),this.itemInfo.num=game.dailyExploitData.weekActive,game.tipsData.setInfo(this.itemInfo),game.module.show(game.ME.ItemTips)}}),t=game.Sender.extends({ipc:function(){this.msg={WeekTaskAwardReq:this.WeekTaskAwardReq,WeekActiveAwardReq:this.WeekActiveAwardReq}},WeekTaskAwardReq:function(e){var t=game.pb.WeekTaskAwardRequest;t.dailyExpType=e,this.write(t)},WeekActiveAwardReq:function(e){var t=game.pb.WeekActiveAwardRequest;t.weekActive=e,this.write(t)}});b8e.module.registerControl(game.ME.WeeklyExp,e,game.DailyExploitEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.exploitData=game.dailyExploitData,this._alertOptions={lang:566,okcb:this.onClickGameAlert,thisArg:this}},notify:function(e,t){switch(e){case this.Evts.V2C_RECOVER:this.sender.ExperienceRetrieveReq(t)}},ipc:function(){this.handels={ExperienceRetrieveResp:this.onExperienceRetrieveRsp}},btn_recover:function(){var e=this.exploitData.expRetrieveInfos;if(!e||e.count()<1){game.notice.show(714)}else{var a,i=0,n=0;e.forEach(function(e,t){a=game.DailyExploitMissionCfg.getData(t.type),i+=t.times*a.exp,n+=t.times*a.retrieveCost},this),this._alertOptions.langArgs=[n,i],game.alert.showTwo(this._alertOptions)}},onClickGameAlert:function(){this.sender.ExperienceRetrieveReq(0)},onExperienceRetrieveRsp:function(e){var t=e.readProtobuf(game.pb.ExperienceRetireveResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.exploitData.experienceExp=t.experienceExp,this.exploitData.updateRetrieveInfos(t.experienceRetrieve),this.send(this.Evts.C2V_UPDATE_VIEW),this.dpt(this.Evts.C2C_RECOVER_SUCCEED)}}),t=game.Sender.extends({ipc:function(){this.msg={ExperienceRetrieveReq:this.experienceRetrieveReq}},experienceRetrieveReq:function(e){var t=game.pb.ExperienceRetireveRequest;t.experienceType=e,this.write(t)}});b8e.module.registerControl(game.ME.DailyExploitRecover,e,game.DailyExploitRecoverEvts,t)}(),function(){var e=b8e.Object.extends({_expInfos:null,_expWeekInfos:null,experienceExp:0,showPrizeLayer:0,openServer:0,showTipTag:0,weekActive:0,weekActiveAwards:null,weeklyOpenServer:0,showItems:null,dailyItemId:0,weeklyItemId:0,ctor:function(){var e=this;e._super(),e.expRetrieveInfos=b8e.HashMap.get(),e.experienceLv=1,e.dailyAward=b8e.HashMap.get(),e.weekCardAward=b8e.HashMap.get(),e.weeklyActAward=b8e.HashMap.get(),e.experienceScore=[],e.experienceWeekScore=[],e.weekActiveAwards=[]},init:function(){var e=game.DailyMiscCfg.getData("dailyItemId");this.dailyItemId=+e.value,e=game.DailyMiscCfg.getData("weeklyItemId"),this.weeklyItemId=+e.value},expInfos:{get:function(){return this._expInfos||(this._expInfos=b8e.HashMap.get(),this._creatExpInfo()),this._expInfos}},expWeekInfos:{get:function(){return this._expWeekInfos||(this._expWeekInfos=b8e.HashMap.get(),this._creatWeekExpInfo()),this._expWeekInfos}},_creatExpInfo:function(){var t,a=this;game.DailyTaskCfg.getTaskDatasByDaliyType(1).forEach(function(e){(t=a._expInfos.get(e.dailyExpType))||(t=game.DailyExploitInfo.get(1,e.dailyExpType),a._expInfos.set(t.type,t))},a)},_creatWeekExpInfo:function(){var t,a=this;game.DailyTaskCfg.getTaskDatasByDaliyType(2).forEach(function(e){(t=a._expWeekInfos.get(e.dailyExpType))||(t=game.DailyExploitInfo.get(2,e.dailyExpType),a._expWeekInfos.set(t.type,t))},a)},resetDaily:function(){for(var e,t=this.expInfos.values(),a=0,i=t.length;a<i;a++)(e=t[a]).isGet=!1,e.setTimes(0);this.experienceExpDaily=0,this.expRetrieveInfos.clear(),this.updataShowAward()},resetWeekly:function(){for(var e,t=this.expWeekInfos.values(),a=0,i=t.length;a<i;a++)(e=t[a]).isGet=!1,e.setTimes(0);this.weekActive=0,this.updataShowWeekAward()},setup:function(e){var t=this;t.experienceExpDaily=e.dailyActive||0,null!=e.dailyActiveAwards&&(t.experienceScore=e.dailyActiveAwards),null!=e.dailyActiveWeekAwards&&(t.experienceWeekScore=e.dailyActiveWeekAwards),t.updataServerDay();for(var a,i=void 0,n=void 0,s=0,o=t.experienceWeekScore.length;s<o;s++)n=t.experienceWeekScore[s],(i=game.DailyTaskActiveCfg.getDataByScore(t.openServer,n))&&i.weekScore&&(t.experienceExpDaily+=i.weekScore);e.dailyTask.forEach(function(e){(a=t.expInfos.get(e.dailyExpType))&&a.setData(e)},t),t.updataShowAward(),e.experienceRetrieve.forEach(function(e){(a=t.expRetrieveInfos.get(e.experienceType))||(a=game.DailyExploitInfo.get(e.experienceType),t.expRetrieveInfos.set(e.experienceType,a)),a.setData(e)},t)},setupWeekly:function(e){var t,a=this;a.weekActive=e.weekActive||0,null!=e.weekActiveAwards&&(a.weekActiveAwards=e.weekActiveAwards),a.updataWeeklyServerDay(),e.weekTask.forEach(function(e){(t=a.expWeekInfos.get(e.dailyExpType))&&t.setData(e)},a),a.updataShowWeekAward()},updataServerDay:function(){var e=game.DailyMiscCfg.getData("dailyServer").value.split(","),t=e.length;if(!(t<1))if(t<2)this.openServer=+e[t-1];else for(var a=game.miscData.openServerDay,i=t-1;-1<i;i--)if(a>=e[i]){this.openServer=+e[i];break}},updataWeeklyServerDay:function(){var e=game.DailyMiscCfg.getData("weeklyServer").value.split(","),t=e.length;if(!(t<1))if(t<2)this.weeklyOpenServer=+e[t-1];else for(var a=game.miscData.openServerDay,i=t-1;-1<i;i--)if(a>=e[i]){this.weeklyOpenServer=+e[i];break}},updateDailyTask:function(e){if(e){this.experienceExpDaily=e.dailyActive;var t=this.expInfos.get(e.dailyExpType);t&&(t.isGet=!0)}},updateWeeklyTask:function(e){if(e){this.weekActive=e.weekActive;var t=this.expWeekInfos.get(e.dailyExpType);t&&(t.isGet=!0)}},updateActiveAward:function(e){if(e){1==e.activeType?this.experienceScore.push(e.dailyActive):2==e.activeType&&this.experienceWeekScore.push(e.dailyActive)}},updateWeekActiveAward:function(e){if(e){this.weekActiveAwards.push(e.weekActive)}},updateRetrieveInfos:function(e){for(var t,a,i=0,n=e.length;i<n;i++)t=e[i],(a=this.expRetrieveInfos.get(t.experienceType))&&(t.times<1?(a.release(),this.expRetrieveInfos.del(t.experienceType)):a.setData(t))},updateInfo:function(e,t){if(t){if(1==e)var a=this.expInfos.get(t.dailyExpType);else if(2==e)a=this.expWeekInfos.get(t.dailyExpType);a&&a.setTimes(t.progress)}},updataWeekScore:function(e){var t=game.DailyTaskActiveCfg.getDataByScore(this.openServer,e);if(t){var a=game.rechargeData.getCardInfoByType(game.CardType.WEEK),i=a&&a.expireTime>game.SysTime.curTime;t.weekScore&&i&&(this.experienceExp+=t.weekScore)}},getExpInfos:function(){var e=this.expInfos.values();return e.sort(this._sort),e},getWeeklyTaskInfo:function(){var e=this.expWeekInfos.values();return e.sort(this._sort),e},_sort:function(e,t){return!e.isGet&&t.isGet?-1:e.isGet&&!t.isGet?1:e.isFinished&&!t.isFinished?-1:!e.isFinished&&t.isFinished?1:t.times-e.times},updataShowAward:function(){var e=this,t=game.rechargeData.getCardInfoByType(game.CardType.WEEK),a=t&&t.expireTime>game.SysTime.curTime,i=e.getCfgsListByServert(e.openServer);if(i)for(var n=void 0,s=void 0,o=void 0,r=0,g=i.length;r<g;r++)(n=i[r])&&(n.items&&((s=e.dailyAward.get(r))||((s=new game.DailyPointInfo).setData(r,n,n.items[0]),e.dailyAward.set(r,s)),s.isGet=-1!=e.experienceScore.indexOf(n.active),s.isAlert=e.experienceExpDaily>=s.active&&!s.isGet),n.weekItems&&((o=e.weekCardAward.get(r))||((o=new game.DailyPointInfo).setData(r,n,n.weekItems[0]),o.setIsWeekCard(!0),e.weekCardAward.set(r,o)),o.isLock=!a,o.isGet=-1!=e.experienceWeekScore.indexOf(n.active),o.isAlert=e.experienceExpDaily>=o.active&&!o.isGet&&a))},updataShowWeekAward:function(){var e=this.getCfgsListByServert2(this.weeklyOpenServer);if(e)for(var t=void 0,a=void 0,i=0,n=e.length;i<n;i++)(t=e[i])&&t.items&&((a=this.weeklyActAward.get(i))||((a=new game.DailyPointInfo).setData(i,t,t.items[0]),this.weeklyActAward.set(i,a)),a.isGet=-1!=this.weekActiveAwards.indexOf(t.active),a.isAlert=this.weekActive>=a.active&&!a.isGet)},getDailyAwards:function(){return this.dailyAward.values()},getWeekCardAwards:function(){return this.weekCardAward.values()},getWeeklyAwards:function(){return this.weeklyActAward.values()},checkAlert:function(){for(var e=this.expInfos.values(),t=void 0,a=e.length,i=0;i<a;i++)if(!(t=e[i]).isGet&&t.isFinished)return!0;var n=this.getDailyAwards(),s=void 0;a=n.length;for(var o=0;o<a;o++)if((s=n[o])&&(this.experienceExpDaily>=s.active&&!s.isGet))return!0;var r=game.rechargeData.getCardInfoByType(game.CardType.WEEK),g=r&&r.expireTime>game.SysTime.curTime,l=this.getWeekCardAwards(),c=void 0;for(a=l.length,o=0;o<a;o++)if((c=l[o])&&(this.experienceExpDaily>=c.active&&!c.isGet&&g))return!0;return!1},checkWeekAlert:function(){for(var e=this.expWeekInfos.values(),t=void 0,a=e.length,i=0;i<a;i++)if(!(t=e[i]).isGet&&t.isFinished)return!0;var n=this.getWeeklyAwards(),s=void 0;a=n.length;for(var o=0;o<a;o++)if((s=n[o])&&(this.weekActive>=s.active&&!s.isGet))return!0;return!1},getCfgsListByServert:function(e){var t=game.DailyTaskActiveCfg.getDatasByDay(e);return(t=t&&t.sort(this.sortOnActive))||[]},getCfgsListByServert2:function(e){var t=game.WeekTaskActiveCfg.getDatasByDay(e);return(t=t&&t.sort(this.sortOnActive))||[]},sortOnActive:function(e,t){return e.active-t.active}});game.dailyExploitData=game.dailyExploitData||new e}(),function(){var e,a=e=b8e.PoolObject.extends({type:0,times:0,taskType:0,isGet:!1,ctor:function(e,t){this._super(),this.taskType=e,this.type=t},setData:function(e){this.isGet=!!e.isGet,this.setTimes(e.progress)},setTimes:function(e){this.times=e;var t=game.DailyTaskCfg.getTaskDataByType(this.taskType,this.type);this.isFinished=!!t&&this.times>=t.progress},clear:function(){this.times=0}});b8e.BindingUtil.bind(a),a.pool=new b8e.Pool(a,32),a.get=function(e,t){return a.pool.get(e,t)},a.put=function(e){a.pool.put(e)},b8e.RC("$$game","$$DailyExploitInfo",e)}(),function(){var e;e=b8e.Object.extends({index:0,id:0,num:0,active:0,isAlert:!1,isGet:!1,isLock:!1,isWeekCard:!1,setData:function(e,t,a){this.index=e,this.active=t.active,this.id=a.Id,this.num=a.Num},setIsWeekCard:function(e){this.isLock=e,this.isWeekCard=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$DailyPointInfo",e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,ctor:function(){this._super(289),this.setSize(80,84)},init:function(){this._icon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_84),this._icon.addToParent(this.skin.icon)},setData:function(e){var t=this.skin;e=this.data,this.data&&(game.GridUtil.setItemIcon(this._icon,e),t.black.active=e.isGet||e.isLock,t.lbl_get.active=e.isGet,t.lock.active=e.isLock,t.redPoint.active=e.isAlert)},touchIcon:function(){this.send(game.DailyExploitEvts.V2C_GET_AWARD,this.data)}})).poolCall=!0,b8e.RC("$$game","$$DailyExploitAwardItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super("dailyExploit/DailyExploitItem"),this.setSize(600,130)},setData:function(e){var t=this,a=game.DailyTaskCfg.getTaskDataByType(e.taskType,e.type);if(t.type=e.type,a){t.cfg=a;var i=e.isGet;t.skin.lab_name.string=a.name,t.skin.lab_progress.string=e.times+"/"+a.progress,t.skin.proImg.width=Math.min(e.times/a.progress*188,188);var n=e.isFinished;t.skin.btn_goto.node.active=!i&&!n,t.skin.getBtn.node.active=!i&&n,t.skin.lab_status.node.active=i,t.list||(t.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),t.list.itemRender=game.PrizeListItem,t.list.layout.spacingX=20,t.list.addToParent(t.skin.prizeNode)),t.cfg.showItem&&(t.prizeInfo||(t.prizeInfo=new game.ZhaoqinPrizeInfo),t.prizeInfo.setup(t.cfg.showItem),t.skin.proNode.x=1<t.prizeInfo.items.length?235:180,t.list.setData(t.prizeInfo.items))}},btn_goto:function(){var e=this.cfg,t=e.moduleId;!t||t<1||(t!=game.ME.Guild||game.guildData.hasGuild()?(game.module.hide(game.ME.DailyFuLi),0<e.toggle?game.module.showToggle(t,e.toggle):game.module.show(t)):game.notice.show(9037))},getBtn:function(){this.send(game.DailyExploitEvts.V2C_TASK_GET,this.type)}}),b8e.RC("$$game","$$DailyExploitItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(292),this.setSize(540,94),this._alertOptions={lang:566,okcb:this.onClickGameAlert,thisArg:this}},setData:function(e){this.cfg=game.DailyExploitMissionCfg.getData(e.type),this.skin.lab_name.string=this.cfg.name,this.skin.lab_count.string=game.Lang.get(565,this.cfg.exp*e.times),this.skin.lab_exp.string=game.Lang.get(564,this.cfg.exp)},btn_recover:function(){this._alertOptions.langArgs=[this.cfg.retrieveCost,this.cfg.exp],game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(){this.send(game.DailyExploitRecoverEvts.V2C_RECOVER,this.data.type)}}),b8e.RC("$$game","$$DailyExploitRecoverItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(293)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.DailyExploitRecoverItem,e._list.bindEnum=game.ME.DailyExploitRecover,e._list.layout.paddingLeft=0,e._list.layout.spacingX=5,e._list.addToParent(e.skin.node_scrollview),e.exploitData=game.dailyExploitData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createItems()}},onShow:function(){this.createItems()},createItems:function(){var e=this.exploitData.expRetrieveInfos.values();this.skin.no_info.node.active=!e||e.length<1,this._list.setData(e)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.DailyExploitRecover,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(294)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.DailyExploitItem,e._list.bindEnum=game.ME.DailyExploit,e._list.addToParent(e.skin.listNode);var t=void 0;e.dailyItems=[];var a=void 0;e.weekItems=[];for(var i=1;i<=4;i++)(t=new game.WeeklyBoxIcon(game.ME.DailyExploit,i)).addToParent(e.getComponent("box"+i)),e.dailyItems.push(t),(a=new game.WeeklyBoxIcon(game.ME.DailyExploit,i)).addToParent(e.getComponent("cardBox"+i)),e.weekItems.push(a);e.exploitData=game.dailyExploitData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createView()}},onShow:function(){this.createView()},createView:function(){var e=this,t=e.skin,a=game.rechargeData.getCardInfoByType(game.CardType.WEEK);e.activeWeekCard=a&&a.expireTime>game.SysTime.curTime,t.activeWeek.active=!e.activeWeekCard,t.desc2.active=e.activeWeekCard;var i=e.exploitData.getCfgsListByServert(e.exploitData.openServer),n=void 0;if(i)for(var s=1,o=i.length;s<=o&&!(4<s);s++)(n=i[s-1])&&(e.getComponent("num"+s).string=n.active,e.maxSc=n.active);e.createItems(),e.creatTreasurebox()},onHide:function(){},createItems:function(){this.listInfos=this.exploitData.getExpInfos(),this._list.setData(this.listInfos)},creatTreasurebox:function(){var e=this,t=e.exploitData.experienceExpDaily;e.maxSc&&(e.skin.active_num.string=t+"/"+e.maxSc,e.skin.proImg.width=Math.min(t/e.maxSc*474,474));for(var a=void 0,i=void 0,n=0;n<4;n++)(a=e.exploitData.dailyAward.get(n))&&(i=e.dailyItems[n])&&i.setData(a),(a=e.exploitData.weekCardAward.get(n))&&(i=e.weekItems[n])&&i.setData(a)},onStageResize:function(){this.setPosition(0,0)},$$getDailyExploit:function(e){if(!this._list||!this.listInfos||this.listInfos.length<=e)return null;var t=this.listInfos[e];if(!t)return null;var a=this._list.getItemRender(t);return a&&a.skin?a.skin.getBtn:null}});b8e.module.registerView(game.ME.DailyExploit,e)}(),function(){var e;e=game.Widget.extends({urlStr:null,iconState:null,index:null,ctor:function(e,t){this._super("dailyExploit/WeeklyBoxIcon"),this.bindEnum=e,this.index=t,this.urlStr="box"+t+"_"},setInitIcon:function(){var e=game.ResCfg.getUrl(10159,this.urlStr+this.iconState);this.skin.icon.loadTexture(e),2==this.iconState?(this.skin.light.active=!0,game.TweenUtil.rotationEffect(this.skin.light)):(b8e.Tween.kill(this.skin.light),this.skin.light.active=!1)},setBoxState:function(e){e!=this.iconState&&(this.iconState=e,this.setInitIcon())},onShow:function(){this.setData(this.data)},onHide:function(){},setData:function(e){if(e){this.data=e;var t=this.skin;if(t){var a=void 0;a=e.isLock?3:e.isAlert?2:1,this.setBoxState(a),t.getImg.active=e.isGet}}},touchIcon:function(){this.send(game.DailyExploitEvts.V2C_GET_AWARD,this.data)}}),b8e.RC("$$game","$$WeeklyBoxIcon",e)}(),function(){var e=game.View.extends({ctor:function(){this._super("dailyExploit/WeeklyExpView")},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.DailyExploitItem,this._list.bindEnum=game.ME.WeeklyExp,this._list.addToParent(this.skin.listNode);var e=void 0;this.weeklyItems=[];for(var t=1;t<=4;t++)(e=new game.WeeklyBoxIcon(game.ME.WeeklyExp,t)).addToParent(this.getComponent("boxNode"+t)),this.weeklyItems.push(e);this.exploitData=game.dailyExploitData},onShow:function(){this.createView()},createView:function(){var e=this.exploitData.getCfgsListByServert2(this.exploitData.weeklyOpenServer),t=void 0;if(e)for(var a=1,i=e.length;a<=i&&!(4<a);a++)(t=e[a-1])&&(this.getComponent("num"+a).string=t.active,this.maxSc=t.active);this._list.setData(this.exploitData.getWeeklyTaskInfo()),this.creatTreasurebox()},creatTreasurebox:function(){var e=this.exploitData.weekActive;this.maxSc&&(this.skin.active_num.string=e+"/"+this.maxSc,this.skin.proImg.width=Math.min(e/this.maxSc*474,474));for(var t=void 0,a=void 0,i=0;i<4;i++)(t=this.exploitData.weeklyActAward.get(i))&&(a=this.weeklyItems[i])&&a.setData(t)},onHide:function(){},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createView()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.WeeklyExp,e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(291),this.spotAlerts={}},init:function(){this._prizeInfo=new game.ZhaoqinPrizeInfo,this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.list.itemRender=game.PrizeListItem,this.list.layout.paddingLeft=20,this.list.layout.paddingRight=0,this.list.layout.paddingTop=0,this.list.layout.spacingX=57,this.list.addToParent(this.skin.prizeNode)},onShow:function(){this.updateView(),game.TweenUtil.rotationEffect(this.skin.light)},updateView:function(){var e=game.dailyExploitData.showPrizeLayer;this.skin.title.string=game.Lang.get(5955,e),this.skin.huawen_3.width=b8e.stageWidth+100,this.skin.huawen_1.width=b8e.stageWidth+100;var t=game.dailyExploitData.showItems;if(t){var a=this._prizeInfo;a.setup(t),this.resetPrizeList(a.items.length),this.list.setData(a.items)}},resetPrizeList:function(e){var t=this.skin,a=void 0;switch(e){case 1:a=295;break;case 2:a=215;break;case 3:a=145;break;default:a=80}this._isMore=4<e,this.list.setSize(560,this._isMore?250:140),t.prizeNode.setPosition(a,-320),t.pathNode.setPosition(360,this._isMore?-635:-525),t.gray.setSize(b8e.stageWidth+50,this._isMore?442:330),this.onStageResize()},onHide:function(){b8e.Tween.kill(this.skin.light)},closeBtn:function(){game.module.hide(this.moduleEnum)},onStageResize:function(){var e=b8e.stageHeight,t=b8e.stageWidth,a=this._isMore?190:100;this.setPosition(.5*(t-this.width),.5*(e+this.height)+a),game.viewModule.updateLayout(this)}});b8e.module.registerView(game.ME.DailyExploitPrize,e)}(),function(){var e;e=b8e.Enum({None:0,V_SWITCH_PAGE:-1,V_SHOW_VIEW:-1,V_RECHARGE_SUCCESS:-1,C_DAILY_RECHARGE_GET_AWARD:-1}),b8e.RC("$$game","$$DailyRechargeEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.DAILY_RECHARGE_ALERT),this.ids=[]},ipc:function(){this.evts={Recharge:{C_RECHARGE_SUCCESS:this.rechargeSuccess,C_INIT_MODEL:this.checkAlert},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={DailyRechargeResp:this.dailyRechargeResp}},resetDaily:function(){game.rechargeData.dailyRechargeAwards=[],this.dpt(this.Evts.C_DAILY_RECHARGE_GET_AWARD)},dailyRechargeResp:function(e){var t=e.readProtobuf(game.pb.DailyRechargeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.rechargeData.dailyRechargeResponse(t.id),this.checkAlert(),this.send(this.Evts.V_GET_PRIZE),this.dpt(this.Evts.C_DAILY_RECHARGE_GET_AWARD),b8e.module.isShowView(game.ME.DailyRecharge)&&game.module.hide(game.ME.DailyRecharge)},notify:function(e){switch(e){case this.Evts.V_SHOW_VIEW:this.showView()}},getPrizeBtn:function(){this.sender.DailyRechargeReq(this.selectId)},rechargeBtn:function(){game.moduleOpen.checkOpen(game.ME.DayOrWeekGift)?game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.DAY_GIFT):game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},btn1:function(){this.switchPage(0)},btn2:function(){this.switchPage(1)},switchPage:function(e){this.ids[e]&&(this.selectId=this.ids[e],this.send(this.Evts.V_SWITCH_PAGE,e))},showView:function(){this.ids.length=0;var e=game.miscData.openServerDay;game.DailyRechargeCfg.getMaxDay()<e&&(e=0);var t=game.DailyRechargeCfg.getDataByDay(e);if(t&&!(t.length<1)){t.sort(this.onSort);for(var a,i=t.length,n=0,s=game.rechargeData.rechargeMoneyDaily,o=game.CCommonUtil.getGameChannelIdOpen,r=0;r<i;r++)o(a=t[r])&&(this.ids.push(a.id),s>a.money&&(n=r));this.selectId=this.ids[n],this.send(this.Evts.V_SWITCH_PAGE,n)}},onSort:function(e,t){return e.money-t.money},rechargeSuccess:function(){this.checkAlert(),this.send(this.Evts.V_RECHARGE_SUCCESS)},checkAlert:function(){if(game.rechargeData.rechargeMoneyDaily){var e=game.miscData.openServerDay;game.DailyRechargeCfg.getMaxDay()<e&&(e=0);var t=game.DailyRechargeCfg.getDataByDay(e);if(!t||t.length<1)this.spotAlert.alert=!1;else{for(var a,i,n=game.CCommonUtil.getGameChannelIdOpen,s=t.length,o=0;o<s&&(!n(a=t[o])||(i=game.rechargeData.getDailyRecharge(a.id)));o++);if(i)this.spotAlert.alert=!1;else{var r=game.rechargeData.rechargeMoneyDaily>=a.money;this.spotAlert.alert=r}}}else{this.spotAlert.alert=!1}}}),t=game.Sender.extends({ipc:function(){this.msg={DailyRechargeReq:this.dailyRechargeReq}},dailyRechargeReq:function(e){var t=game.pb.DailyRechargeRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.DailyRecharge,e,game.DailyRechargeEvts,t)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(299),this.toggles={toggle_btn_1:null,toggle_btn_2:null}},init:function(){this.ids=[];var e=this.skin;this.prizeInfoList=[],this.prizeInfoPool=[];var t=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.prizeList),t.layout.spacingX=24,t.layout.paddingTop=2},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SWITCH_PAGE:a.toggleSelect(t),a.switchPage(t);break;case a.Evts.V_RECHARGE_SUCCESS:a.updateMoney(),a.setBtns(),a.updateRedPoint();break;case a.Evts.V_GET_PRIZE:a.setBtns(),a.updateRedPoint()}},onShow:function(){var e=this;e.ids.length=0;var t=e.skin;t.btn1.active=!1,t.btn2.active=!1;var a=game.miscData.openServerDay;game.DailyRechargeCfg.getMaxDay()<a&&(a=0);var i=game.DailyRechargeCfg.getDataByDay(a);if(i&&!(i.length<1)){var n;i.sort(e.onSort);for(var s,o=Math.min(i.length,2),r=0,g=game.CCommonUtil.getGameChannelIdOpen,l=void 0,c=0;c<o;c++)g(s=i[c])&&(e.ids.push(s.id),r++,l=game.ResCfg.getImgUrl(i[c].name+"_1"),e.getComponent("toggle_btn_"+r).loadTexture(l),l=game.ResCfg.getImgUrl(i[c].name+"_2"),e.getComponent("toggle_unsel_"+r).loadTexture(l),e.getComponent("btn"+r).active=!0,!n&&s.descKey&&(n=s.descKey));n&&(t.desc.string=game.Lang.get(n)),e.send(e.Evts.V_SHOW_VIEW),e.updateRedPoint()}},onSort:function(e,t){return e.money-t.money},onHide:function(){},switchPage:function(e){var t=this;if(t.ids&&!(t.ids.length<e+1)){var a=t.ids[e],i=t.cfg=game.DailyRechargeCfg.getDataById(a);if(i){if(i.award&&0<i.award.length){t.prizeInfoList.length=0;for(var n,s,o=i.award.length,r=0;r<o;r++)n=i.award[r],t.prizeInfoPool[r]||(t.prizeInfoPool[r]=new game.PrizeInfo),(s=t.prizeInfoPool[r]).setData(n.Id,n.Num,2,0,game.IconSizeEnum.GRID_SIZE_105),t.prizeInfoList.push(s);t.prizeList.setData(t.prizeInfoList)}t.skin.lab_img.loadTexture(game.ResCfg.getImgUrl(i.banner+i.money)),t.setBtns(),t.updateMoney()}}},toggleSelect:function(e){this._super(e)},setBtns:function(){if(this.cfg){var e=game.rechargeData.rechargeMoneyDaily;if(game.rechargeData.getDailyRecharge(this.cfg.id))this.skin.getImg.node.active=!0,this.skin.getPrizeBtn.node.active=!1,this.skin.rechargeBtn.node.active=!1;else{this.skin.getImg.node.active=!1;var t=e>=this.cfg.money;this.skin.getPrizeBtn.node.active=t,this.skin.rechargeBtn.node.active=!t}}},updateMoney:function(){},updateRedPoint:function(){for(var e=void 0,t=void 0,a=void 0,i=game.rechargeData.rechargeMoneyDaily,n=Math.min(this.ids.length,2),s=void 0,o=0;o<n;o++)a=this.ids[o],s=o+1,e=game.rechargeData.getDailyRecharge(a),t=game.DailyRechargeCfg.getDataById(a),this.getComponent("redPoint_"+s).active=!!t&&(!e&&i>=t.money)}});b8e.module.registerView(game.ME.DailyRecharge,e)}(),function(){var e;e=b8e.Enum({None:0}),b8e.RC("$$game","$$DemoEvts",e)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={}},notify:function(e){}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.Demo,e,game.DemoEvts,t)}(),function(){var e=b8e.Object.extends({});game.demoData=game.demoData||new e}(),function(){var e;e=b8e.Object.extends({id:0}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$DemoListInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(301),this.setSize(50,100)},setData:function(e){this.skin.lbl.string=e.id}}),b8e.RC("$$game","$$DemoListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(302)},init:function(){this.list=new b8e.ScrollList(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this.list.itemRender=game.DemoListItem,this.list.addToParent(this.skin.list),this.list.setScrollViewCb(this.listViewCb,this);for(var e=[],t=0;t<100;t++){var a=new game.DemoListInfo;a.id=t,e.push(a)}this.list.setData(e)},listViewCb:function(){},view_left:function(){this.list.scrollContainerLeft()},view_right:function(){this.list.scrollContainerRight()},notify:function(){}});b8e.module.registerView(game.ME.Demo,e)}(),function(){var e;e=b8e.Enum({None:0,V_UPDATEDATA:b8e.enc(),V_PAGE_CHANGE:b8e.enc(),V_PROGRESS_UPDATE:b8e.enc(),V_VIEW_OPENED:b8e.enc(),C_SELECT_LAYER:b8e.enc(),C_VIEW_OPENED:b8e.enc()}),b8e.RC("$$game","$$DianWeiEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.dianweiSpot=game.spotAlert.set(game.SAE.DIANWEI_ALERT)},ipc:function(){this.evts={OpenServer:{C2C_INIT_OPENSERVER:this.initOpenserver},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={DianWeiResp:this.dianWeiResp}},triggerOpen:function(e){e==this.moduleEnum&&this.initData&&!this.initOpenServerData&&this.updateData()},checkAlert:function(){this.dianweiSpot.alert=game.dwData.dwCfg&&game.dwData.canChall()&&!game.dwData.firstOpened},resetDaily:function(){var e=game.dwData.dwCfg;e&&(game.dwData.createCfgData(game.miscData.openServerDay),game.dwData.dwCfg||(game.dwData.dwCfg=e),this.dptG(game.ActiveBarGEvts.REFRESH_BTNS))},dianWeiResp:function(e){var t=e.readProtobuf(game.pb.DianWeiResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.dwData.updateLayer(t.layer),game.dwData.setLayerPass(t.layer);var a={type:game.InstanceType.DIANWEI,rewards:t.userItem};game.playBack.play(t.battleLog,a),game.GameViewMgr.inst().hideUnStrongViews(),this.closeDw(),this.send(this.Evts.V_UPDATEDATA)}},dianWeiLogsResp:function(){},initOpenserver:function(e){var t=e.data.dianWei;if(this.initData=!0,game.miscData){var a=game.miscData.openServerDay;game.dwData.synData(t,a)}else b8e.warn("game.miscData\u672a\u521d\u59cb\u5316");this.updateData()},updateData:function(){if(game.moduleOpen.checkOpen(this.moduleEnum)){this.initOpenServerData=!0;var e=!!game.dwData.dwCfg&&game.dwData.canChall();this.isClose=!e,game.dwData.firstOpened=!1,this.checkAlert()}},closeDw:function(){this.dptG(game.ActiveBarGEvts.REFRESH_BTNS)},notify:function(e,t){switch(e){case this.Evts.C_SELECT_LAYER:this.selectLayer(t);break;case this.Evts.C_VIEW_OPENED:game.dwData.firstOpened||(game.dwData.firstOpened=!0,this.checkAlert(),this.dptG(game.ActiveBarGEvts.REFRESH_BTNS)),this.autoSelectPage()}},leftBtn:function(){game.dwData.setPage(1),this.send(this.Evts.V_PAGE_CHANGE,1),this.send(this.Evts.V_PROGRESS_UPDATE)},rightBtn:function(){game.dwData.setPage(2),this.send(this.Evts.V_PAGE_CHANGE,2),this.send(this.Evts.V_PROGRESS_UPDATE)},selectLayer:function(e){e!=game.dwData.selectInfo.layer&&(game.dwData.setSelectInfo(e),this.send(this.Evts.V_UPDATEDATA))},challBtn:function(){var e=game.dwData.getSelectInfo().layer,t=game.dwData.curLayer;if(t+1<e)game.notice.show(4410,e-1);else if(e==t+1){if(game.UpgradeUtil.checkEquipTooMuch())return;game.dwData.dwCfg&&this.sender.DianWeiReq(game.dwData.dwCfg.id)}else game.notice.show(9120)},parnterBtn:function(){if(game.dwData&&game.dwData.dwCfg){var e=game.dwData.dwCfg.partnerId;game.partnerData.setShowInfo(e),game.module.show(game.ME.PartnerDetails)}},autoSelectPage:function(){var e=game.dwData.getSelectInfo(),t=(e.layer,game.dwData.curLayer);t<game.dwData.maxLayer?game.dwData.setSelectInfo(t+1):game.dwData.setSelectInfo(t),t<5?(game.dwData.setPage(1),this.send(this.Evts.V_PAGE_CHANGE,1)):(game.dwData.setPage(2),this.send(this.Evts.V_PAGE_CHANGE,2)),(e=game.dwData.getSelectInfo())&&e.layer,this.send(this.Evts.V_UPDATEDATA)}}),t=game.Sender.extends({ipc:function(){this.msg={DianWeiReq:this.dianWeiReq}},dianWeiReq:function(e){var t=game.pb.DianWeiRequest;t.id=e,this.write(t)},dianWeiLogsReq:function(){}});b8e.module.registerControl(game.ME.DianWei,e,game.DianWeiEvts,t)}(),function(){var e=b8e.Object.extends({firstOpened:!1,maxLayer:10,synData:function(e,t){this.curLayer=e,this.curPage=1,this.createCfgData(t,!0)},getCurLayer:function(){return this.curLayer},createCfgData:function(e,t){var a=this,i=game.DianWeiCfg.getDatas();if(i){var n=null,s=null,o=a.dwCfg;a.dwCfg=null;for(var r=0,g=i.length;r<g;r++)if(e>=(n=i[r]).serverStart&&e<n.serverEnd){s=n,a.endTime=b8e.TimeUtil.getTodayTime(game.SysTime.curTime)+(n.serverEnd-e)*b8e.TimeUtil.DAY_MICRO_SECONDS;break}if(s){!t&&o&&s.id!=o.id&&(a.curLayer=0,a.curPage=1),a.dwCfg=s;var l=game.DianWeiInsGroupCfg.getDatasById(s.id);l||b8e.warn("\u795e\u5c06\u5178\u97e6\u526f\u672c\u6570\u636e\u4e0d\u5b58\u5728, id: ",s.id);var c=null,h=null;a.instInfoArr=a.instInfoArr||[],a.instInfoArr.length=0,a.instInfoMap=a.instInfoMap||b8e.HashMap.get(),a.instInfoMap.clear();for(r=0,g=l.length;r<g;r++)c=l[r],(h=new game.DianWeiInstInfo).setCfgData(c),h.layer<=a.curLayer&&(h.isPass=!0),a.instInfoArr.push(h),a.instInfoMap.set(h.layer,h);a.setSelectInfo(a.instInfoArr[0].layer)}}},setLayerPass:function(e){var t=this.instInfoMap.get(e);t&&(t.isPass=!0)},synRank:function(){},getInfoArr:function(){return this.instInfoArr},setSelectInfo:function(e){this.selectInfo&&(this.selectInfo.select=!1);var t=this.instInfoMap.get(e);t&&(this.selectInfo=t,this.selectInfo.select=!0)},getSelectInfo:function(){return this.selectInfo},setPage:function(e){2<e||e<1?b8e.warn("\u795e\u5c06\u5178\u97e6\u9875\u6570\u4e0d\u5bf9pageNum\uff1a",e):this.curPage=e},updateLayer:function(e){this.curLayer=e},isOpen:function(){return game.SysTime.curTime<this.endTime},isOpenById:function(e){return!!this.dwCfg&&(e==this.dwCfg.id&&this.isOpen()&&this.canChall())},canChall:function(){return this.curLayer<this.maxLayer},getCountdown:function(){return this.endTime-game.SysTime.curTime}});game.dwData=game.dwData||new e}(),function(){var e;e=b8e.Object.extends({layer:0,isPass:!1,select:!1,ctor:function(){this._super()},setData:function(){},setCfgData:function(e){this.cfg=e,this.layer=e.layer}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$DianWeiInstInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(325),this.setSize(126,156)},setData:function(){var e=this.skin,t=this.data;if(t){var a=t.cfg;if(a){e.qz_select.node.active=t.select,e.qz_unselect.node.active=!t.select,e.passImg.node.active=t.isPass,this.icon||(this.icon=b8e.Sprite.get(),this.icon.setAnchor(.5,.5),this.icon.addToParent(e.iconNode));var i=game.ResCfg.getImgUrl("dianwei/"+a.itemIconId);this.icon.loadTexture(i),e.lv.string=game.Lang.get(50137,game.CCommonUtil.numConvertToChineseNum(t.layer))}}},selectBtn:function(){this.send(game.DianWeiEvts.C_SELECT_LAYER,this.data.layer)}}),b8e.RC("$$game","$$DianWeiListItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(328)},init:function(){var e=this;e._super();var t=e.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.DianWeiListItem,t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingX=0,t.bindEnum=e.moduleEnum,t.addToParent(e.skin.list),(t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal)).itemRender=game.PrizeListItem,t.layout.paddingLeft=5,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingX=25,t.layout.spacingY=0,t.addToParent(e.skin.awardList),t.touchMovable=!1;var a=game.ResCfg.getImgUrl("dianwei/bg",!0);e.bg=b8e.Sprite.get(),e.bg.setAnchor(0,1),e.skin.bg.addChild(e.bg),e.bg.loadTexture(a)},notify:function(e){switch(e){case this.Evts.V_UPDATEDATA:this.updateData()}},onShow:function(){this.send(this.Evts.C_VIEW_OPENED)},updateData:function(){var e=this,t=e.skin,a=game.dwData.dwCfg;if(a){var i=game.dwData.getInfoArr();e.list.setData(i);var n=game.dwData.getSelectInfo();if(n){n.cfg;var s=n.layer,o=game.dwData.curLayer;t.instLab.string=game.Lang.get(2261,game.CCommonUtil.numConvertToChineseNum(s)),t.dialogLab.string=a.tips,e.timer?(e.timer.reset(),e.timer.start()):e.timer=b8e.Timer.add(e,e.updateTime,1e3);var r=game.CfgUtil.getPrizeListInfo(n.cfg.award,game.IconLayoutEnum.SHOW_ALL);r&&e.prizeList.setData(r.items),t.challBtn.node.active=!1,t.passLab.node.active=!1,t.passBtn.node.active=!0,o+1<s?t.passBtnLab.string=game.Lang.get(4410):s==o+1?(t.passBtn.node.active=!1,t.challBtn.node.active=!0):t.passBtnLab.string=game.Lang.get(4411),e.updateModel()}}},updateTime:function(){var e=this.skin,t=game.dwData.endTime-game.SysTime.curTime,a=game.TimeUtil.formatTimeSpace(t,3);e.timeLab.string=game.Lang.get(2262,a)},updateModel:function(){var e=game.dwData.dwCfg;if(e){this.showModel||(this.showModel=b8e.SceneEntity.get(),this.showModel.addToParent(this.skin.modelNode));var t=e.showModel;t=game.ResCfg.getUrl(5e3,t);var a=this.showModel.getAnimator(game.AnimType.BOSS,1);(a=a||this.showModel.addAnimator(game.AnimType.BOSS,1))&&(a.load(t),a.play())}},onHide:function(){}});b8e.module.registerView(game.ME.DianWei,e)}(),function(){var e;e=b8e.Enum({None:0,V_RECHARGE_SUCCESS:-1,C_DISCOUNT_RECHARGE_GET_AWARD:-1}),b8e.RC("$$game","$$DiscountRechargeEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.DISCOUNT_RECHARGE_ALERT)},ipc:function(){this.evts={Recharge:{C_RECHARGE_SUCCESS:this.rechargeSuccess,C_INIT_MODEL:this.checkAlert}},this.handels={DiscountRechargeResp:this.discountRechargeResp}},discountRechargeResp:function(e){var t=e.readProtobuf(game.pb.DiscountRechargeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.rechargeData.discountRechargeResponse(t.id),this.dpt(this.Evts.C_DISCOUNT_RECHARGE_GET_AWARD),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},getPrizeBtn:function(){var e=game.miscData.openServerDay;game.DiscountRechargeCfg.getMaxDay()<e&&(e=0);var t=game.DiscountRechargeCfg.getData(e);if(t)this.sender.DiscountRechargeReq(t.id),game.module.hide(this.moduleEnum),game.module.hide(game.ME.TodayDiscountRecharge);else;},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},rechargeSuccess:function(){this.checkAlert(),this.send(this.Evts.V_RECHARGE_SUCCESS)},checkAlert:function(){var e=game.miscData.openServerDay;game.DiscountRechargeCfg.getMaxDay()<e&&(e=0);var t=game.DiscountRechargeCfg.getData(e);if(t)if(game.rechargeData.getDiscountRecharge(t.id))this.spotAlert.alert=!1;else{var a=game.rechargeData.rechargeMoneyDaily>=t.money;this.spotAlert.alert=a}else this.spotAlert.alert=!1}}),t=[game.ME.TodayDiscountRecharge],a=game.Sender.extends({ipc:function(){this.msg={DiscountRechargeReq:this.discountRechargeReq}},discountRechargeReq:function(e){var t=game.pb.DiscountRechargeRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.DiscountRecharge,e,game.DiscountRechargeEvts,a,t)}(),function(){var e=game.View.extends({timer:null,_showModel:!0,ctor:function(){this._super(337)},init:function(){var e=this,t=e.skin;e.prizeInfoList=[],e.prizeInfoPool=[];var a=e.prizeList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);a.itemRender=game.PrizeListItem,a.addToParent(t.prizeList),a.layout.spacingY=-2,a.layout.spacingX=13,a.layout.paddingTop=2;var i=e.banner=b8e.Sprite.get();i.addToParent(e.skin.banner),i.setAnchor(.5,.5);var n=e.upAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1);n.addToParent(t.anim),n.load(game.ResCfg.getUrl(5019,1062)),e.timer=b8e.Timer.add(e,e.updateTime,1e3,0,0),e.timer.reset(),e.timer.start()},notify:function(e){switch(e){case this.Evts.V_RECHARGE_SUCCESS:this.updateMoney(),this.setBtns()}},onShow:function(){var e=this,t=game.miscData.openServerDay;game.DiscountRechargeCfg.getMaxDay()<t&&(t=0);var a=e.cfg=game.DiscountRechargeCfg.getData(t);if(a){var i=game.ResCfg.getUrl(99,a.banner);if(e.banner.loadTexture(i),a.award&&0<a.award.length){e.prizeInfoList.length=0;for(var n,s,o=a.award.length,r=0;r<o;r++){if(n=a.award[r],!e.prizeInfoPool[r]){e.prizeInfoPool[r]=new game.PrizeInfo}(s=e.prizeInfoPool[r]).setData(n.Id,n.Num,2,0,game.IconSizeEnum.GRID_SIZE_105),e.prizeInfoList.push(s)}e.prizeList.setData(e.prizeInfoList)}if(e.setBtns(),e.updateMoney(),e.upAnim.play(),e.skin.name.string=e.cfg.name,e.updateTime(),e.timer){e.timer.reset(),e.timer.start()}}else;},onHide:function(){if(this.timer){this.timer.stop()}},updateTime:function(){var e=this;if(e.cfg){var t=e.cfg.serverEnd-e.cfg.serverStart,a=b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,t)-game.SysTime.curTime;if(a<=0){e.timer.stop(),game.module.hide(this.moduleEnum)}var i=b8e.TimeUtil.formatTime(a);e.skin.time.string=game.Lang.get(1708,i)}else{e.timer.stop()}},setBtns:function(){var e=this;if(e.cfg){var t=game.rechargeData.rechargeMoneyDaily;if(game.rechargeData.getDiscountRecharge(e.cfg.id)){e.skin.getImg.node.active=!0,e.skin.getPrizeBtn.node.active=!1,e.skin.rechargeBtn.node.active=!1}else{e.skin.getImg.node.active=!1;var a=t>=e.cfg.money;e.skin.getPrizeBtn.node.active=a,e.skin.rechargeBtn.node.active=!a}}else;},updateMoney:function(){this.skin.money.string=game.Lang.get(1709,game.rechargeData.rechargeMoneyDaily)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+30;this.setPosition(e,t)}});b8e.module.registerView(game.ME.DiscountRecharge,e)}(),function(){var e;e=game.View.extends({_showModel:!0,ctor:function(e){e=e||"discountRecharge/TodayDiscountRechargeView",this._super(e)},notify:function(e){switch(e){case this.Evts.V_RECHARGE_SUCCESS:this.updateMoney(),this.setBtns()}},init:function(){var e=this.skin;this.prizeInfoList=[],this.prizeInfoPool=[];var t=this.prizeList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.PrizeListItem,t.addToParent(e.prizeList),t.layout.spacingY=50,t.layout.spacingX=100,t.layout.paddingTop=10,t.layout.paddingLeft=10,this.timer=b8e.Timer.add(this,this.updateTime,1e3,0,0),this.timer.reset(),this.timer.start()},onShow:function(){var e=this,t=game.miscData.openServerDay;game.DiscountRechargeCfg.getMaxDay()<t&&(t=0);var a=e.cfg=game.DiscountRechargeCfg.getData(t);if(a){var i=game.ResCfg.getUrl(99,a.bannerBg);if(e.skin.banner.loadTexture(i),i=game.ResCfg.getUrl(99,a.banner),e.skin.labImg.loadTexture(i),a.award&&0<a.award.length){e.prizeInfoList.length=0;for(var n,s,o=a.award.length,r=0;r<o;r++)n=a.award[r],e.prizeInfoPool[r]||(e.prizeInfoPool[r]=new game.PrizeInfo),(s=e.prizeInfoPool[r]).setData(n.Id,n.Num,3,0,game.IconSizeEnum.GRID_SIZE_105),e.prizeInfoList.push(s);e.prizeList.setData(e.prizeInfoList)}if(e.setBtns(),e.updateMoney(),e.updateTime(),e.timer){e.timer.reset(),e.timer.start()}}},updateTime:function(){if(this.cfg){var e=this.cfg.serverEnd-this.cfg.serverStart,t=b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,e)-game.SysTime.curTime;t<=0&&(this.timer.stop(),game.module.hide(this.moduleEnum));var a=b8e.TimeUtil.formatTime(t);this.skin.time.string=game.Lang.get(1708,a)}else this.timer.stop()},setBtns:function(){var e=this.skin;if(this.cfg){var t=game.rechargeData.rechargeMoneyDaily;if(game.rechargeData.getDiscountRecharge(this.cfg.id))e.getImg.node.active=!0,e.getPrizeBtn.node.active=!1,e.rechargeBtn.node.active=!1;else{e.getImg.node.active=!1;var a=t>=this.cfg.money;e.getPrizeBtn.node.active=a,e.rechargeBtn.node.active=!a}}},updateMoney:function(){this.cfg&&(this.skin.money.string=game.Lang.get(52252,game.rechargeData.rechargeMoneyDaily,this.cfg.money))},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}}),b8e.module.registerView(game.ME.TodayDiscountRecharge,e),b8e.RC("$$game","$$TodayDiscountRechargeView",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_SYN_DATA:-1,C2V_ESCORT_FINISHED:-1,C2V_UPDATE_VIEW:-1,C2V_ROB_VIEW_CLOSE:-1,C2V_PAGE_LEFT:-1,C2V_PAGE_RIGHT:-1,V2C_ASK_SYN_DATA:-1,C2C_ASK_LOG:-1,C2C_CHANGE_ESCORT_ICON:-1}),b8e.RC("$$game","$$EscortEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_COLLECT_REWARD_SUCCEED:-1}),b8e.RC("$$game","$$EscortFinishEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,C2C_ESCORT_START:-1}),b8e.RC("$$game","$$EscortListEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_SYN_LOG_SUCCEED:-1,V2C_SYN_LOG:-1,V2C_CLICK_REVENGE:-1,C2C_CLICK_REVENGE:-1,C2C_CHANGE_ESCORT_ICON:-1}),b8e.RC("$$game","$$EscortLogEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_ROB_VIEW_CLOSE:-1,C2C_ROB_VIEW_CLOSE:-1,C2C_ASK_LOG:-1}),b8e.RC("$$game","$$EscortRobEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ESCORT,game.SAE.NORMAL_ACTIVITY_ALERT),this._alertOptions={lang:536,okcb:this.onClickGameAlert,thisArg:this}},ipc:function(){this.evts={EscortList:{C2C_ESCORT_START:this.onEscortStart},EscortFinish:{C2C_COLLECT_REWARD_SUCCEED:this.onCollectRewardSucceed},EscortRob:{C2C_ROB_VIEW_CLOSE:this.onRobViewClose}},this.handels={EscortDataResp:this.onEscortDataRsp,EscortFinishResp:this.onEscortFinishResp}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.EscortDataReq()},notify:function(e){switch(e){case this.Evts.V2C_ASK_SYN_DATA:this.sender.EscortDataReq()}},onEscortStart:function(){game.escortData.escortNum++,game.escortData.addSelf(),this.startEscortTime(!0),this.send(this.Evts.C2V_UPDATE_VIEW)},startEscortTime:function(e){var t=0<arguments.length&&void 0!==e&&e,a=game.escortData.getEscortRemainingTime();0<a&&(t&&b8e.removeTimeout(this.completeEscort,this),b8e.hasTimeout(this.completeEscort,this)||b8e.setTimeout(this.completeEscort,this,a))},completeEscort:function(){this.sender.EscortDataReq()},onCollectRewardSucceed:function(){game.escortData.rmvSelf(),game.escortData.myEscort=null,this.sender.EscortDataReq()},onRobViewClose:function(){this.send(this.Evts.C2V_ROB_VIEW_CLOSE)},onEscortDataRsp:function(e){var t=e.readProtobuf(game.pb.EscortDataResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.escortData.setup(t),game.escortData.addSelf(),game.escortListData.setDouble(),this.checkAlert(),this.calDoubleTime(),this.startEscortTime(),this.dpt(this.Evts.C2C_ASK_LOG),this.send(this.Evts.C2V_SYN_DATA),this.dpt(this.Evts.C2C_SYN_DATA,game.escortData)},onEscortFinishResp:function(e){var t=e.readProtobuf(game.pb.EscortFinishResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.send(this.Evts.C2V_ESCORT_FINISHED),this.sender.EscortDataReq()},btn_escort:function(){if(game.escortData.isFinished()){game.module.show(game.ME.EscortFinish)}else if(game.escortData.myEscort){game.notice.show(552)}else game.module.show(game.ME.EscortList)},btn_quickly:function(){if(game.escortData.myEscort){var e=game.EscortCfg.getData(game.escortData.myEscort.itemId);if(e)this._alertOptions.langArgs=e.cost,game.alert.showTwo(this._alertOptions);else;}else;},btn_log:function(){game.module.show(game.ME.EscortLog)},btn_left:function(){this.send(this.Evts.C2V_PAGE_LEFT)},btn_right:function(){this.send(this.Evts.C2V_PAGE_RIGHT)},onClickGameAlert:function(){if(game.escortData.myEscort)this.sender.EscortFinishReq(2);else;},checkAlert:function(){this.dpt(this.Evts.C2C_CHANGE_ESCORT_ICON),this.spotAlert.alert=game.escortData.mainViewAlert()},calDoubleTime:function(){if(0!=game.escortData.doubleStartTime&&0!=game.escortData.doubleEndTime){b8e.Tween.kill(this);var e=0;if(game.SysTime.curTime<game.escortData.doubleStartTime){e=game.escortData.doubleStartTime-game.SysTime.curTime}else e=game.escortData.doubleEndTime-game.SysTime.curTime;if(e<0){e=0}b8e.Tween.get(this).wait(e+2e3).call(this.onTime,this)}else;},onTime:function(){this.sender.EscortDataReq(),b8e.Tween.kill(this)}}),t=game.Sender.extends({ipc:function(){this.msg={EscortDataReq:null,EscortFinishReq:this.escortFinishReq}},escortFinishReq:function(e){var t=game.pb.EscortFinishRequest;t.costType=e,this.write(t)}});b8e.module.registerControl(game.ME.Escort,e,game.EscortEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.handels={EscortCollectRewardResp:this.onEscortCollectRewardRsp}},btn_receive:function(){this.sender.EscortCollectRewardReq()},onEscortCollectRewardRsp:function(e){var t=e.readProtobuf(game.pb.EscortCollectRewardResponse);if(0<t.code){game.notice.noticeError(t.code)}else{if(t.is_high){game.escortData.addHighCount()}game.module.hide(game.ME.EscortFinish),this.dpt(game.EscortFinishEvts.C2C_COLLECT_REWARD_SUCCEED)}}}),t=game.Sender.extends({ipc:function(){this.msg={EscortCollectRewardReq:null}}});b8e.module.registerControl(game.ME.EscortFinish,e,game.EscortFinishEvts,t)}(),function(){var e=game.Control.extends({init:function(){game.escortListData.init(),this._alertOptions={lang:530,okcb:this.onClickRefreshGameAlert,thisArg:this},this._alertOptions2={lang:531,okcb:this.onClickOneRefreshGameAlert,thisArg:this},this._alertOptions3={lang:712,okcb:this.onClickEscortGameAlert,thisArg:this}},ipc:function(){this.evts={Escort:{C2C_SYN_DATA:this.onSynData}},this.handels={EscortStartResp:this.onEscortStartRsp,EscortRefreshResp:this.onEscortRefreshRsp}},btn_refresh:function(){if(game.escortData.isMaxQuality()){game.notice.show(532)}else{var e=game.EscortMiscCfg.getNumber("escortRefreshCost1");if(game.amount.get(game.AmountType.BIND_YUAN_BAO)<e){return this._alertOptions.langArgs=e,void game.alert.showTwo(this._alertOptions)}this.sender.EscortRefreshReq(1,1)}},onClickRefreshGameAlert:function(){this.sender.EscortRefreshReq(1,2)},btn_one_refresh:function(){if(game.escortData.isMaxQuality()){game.notice.show(532)}else{var e=game.EscortMiscCfg.getNumber("escortCostItem");if(0<game.itemData.getNumById(e)){var t=game.ItemInfoCfg.getData(e);this._alertOptions2.lang=599,this._alertOptions2.langArgs=game.HtmlUtil.getColorStrByQuality(t.quality,t.name)}else{var a=game.EscortMiscCfg.getNumber("escortRefreshCost2");this._alertOptions2.lang=531,this._alertOptions2.langArgs=a}game.alert.showTwo(this._alertOptions2)}},onClickOneRefreshGameAlert:function(){if(game.EscortMiscCfg.getNumber("escortRefreshCost2")<=game.amount.get(game.AmountType.BIND_YUAN_BAO)){this.sender.EscortRefreshReq(2,1)}else this.sender.EscortRefreshReq(2,2)},btn_escort:function(){if(game.escortData.isMaxEscortNum()){game.notice.show(533)}else if(game.escortData.rate<=1){game.alert.showTwo(this._alertOptions3)}else this.sender.EscortStartReq()},onClickEscortGameAlert:function(){this.sender.EscortStartReq()},onSynData:function(e){if(e&&e.data)game.escortListData.curItemId=e.data.itemId,game.escortListData.initGrainCarDatas(),this.send(this.Evts.C2V_UPDATE_VIEW);else;},onEscortStartRsp:function(e){var t=e.readProtobuf(game.pb.EscortStartResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.escortData.myEscort=t.escort,game.module.hide(game.ME.EscortList),game.escortListData.setFirstSelect(),game.escortListData.refreshCar(),this.dpt(this.Evts.C2C_ESCORT_START)},onEscortRefreshRsp:function(e){var t=e.readProtobuf(game.pb.EscortRefreshResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.itemId,i=game.EscortCfg.getData(game.escortData.itemId),n=game.EscortCfg.getData(a);if(i&&n){var s=i.days!=n.days;game.escortData.itemId!=a&&(game.escortData.itemId=a,game.escortListData.curItemId=a,s?(game.escortListData.initGrainCarDatas(),this.send(this.Evts.C2V_UPDATE_VIEW)):game.escortListData.refreshCar());var o=game.EscortCfg.getData(a);o&&game.notice.show(707,game.HtmlUtil.getColorStrByQuality(o.quality-1,o.name))}}}}),t=game.Sender.extends({ipc:function(){this.msg={EscortStartReq:null,EscortRefreshReq:this.escortRefreshReq}},escortRefreshReq:function(e,t){var a=game.pb.EscortRefreshRequest;a.type=e,a.costType=t,this.write(a)}});b8e.module.registerControl(game.ME.EscortList,e,game.EscortListEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ESCORT_LOG)},ipc:function(){this.evts={EscortRob:{C2C_ASK_LOG:this.reqLog},Escort:{C2C_ASK_LOG:this.reqLog}},this.handels={EscortLogResp:this.onEscortLogRsp}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.EscortLogReq()},reqLog:function(){this.sender.EscortLogReq()},notify:function(e,t){switch(e){case this.Evts.V2C_SYN_LOG:this.sender.EscortLogReq();break;case this.Evts.V2C_CLICK_REVENGE:game.module.hide(game.ME.EscortLog),this.dpt(this.Evts.C2C_CLICK_REVENGE,t)}},onEscortLogRsp:function(e){var t=e.readProtobuf(game.pb.EscortLogResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.escortLogData.setup(t.logs),this.checkAlert(),this.send(this.Evts.C2V_SYN_LOG_SUCCEED),this.dpt(this.Evts.C2C_CHANGE_ESCORT_ICON)},checkAlert:function(){this.spotAlert.alert=game.escortLogData.canRevenge()}}),t=game.Sender.extends({ipc:function(){this.msg={EscortLogReq:null,EscortRevengeReq:this.escortRevengeReq}}});b8e.module.registerControl(game.ME.EscortLog,e,game.EscortLogEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={EscortLog:{C2C_CLICK_REVENGE:this.onClickRevenge}},this.handels={EscortRevengeResp:this.onEscortRevengeRsp}},onClickRevenge:function(e){if(e&&e.data)game.escortData.targetRevenge=e.data,game.module.show(game.ME.EscortRevenge);else;},btn_revenge:function(){var e=game.escortData.targetRevenge;if(e)if(game.playBack.isInstanceFighting());else game.sceneData.isGuildMap()||this.sender.EscortRevengeReq(e.roleId,e.time,1);else;},onEscortRevengeRsp:function(e){var t=e.readProtobuf(game.pb.EscortRevengeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.GameViewMgr.inst().hideUnStrongViews();var a={type:game.InstanceType.ESCORT,rewards:t.useritem,exp:t.exp};game.playBack.play(t.battlelog,a)}}}),t=game.Sender.extends({ipc:function(){this.msg={EscortRevengeReq:this.escortRevengeReq}},escortRevengeReq:function(e,t,a){var i=game.pb.EscortRevengeRequest;i.roleId=e,i.time=t,i.type=a,this.write(i)}});b8e.module.registerControl(game.ME.EscortRevenge,e,null,t)}(),function(){var e=game.Control.extends({ipc:function(){this.handels={EscortRobResp:this.onEscortRobRsp}},notify:function(e){switch(e){case this.Evts.V2C_ROB_VIEW_CLOSE:this.dpt(this.Evts.C2C_ROB_VIEW_CLOSE)}},onEscortRobRsp:function(e){var t=e.readProtobuf(game.pb.EscortRobResponse);if(0<t.code){game.notice.noticeError(t.code)}else{this.dpt(this.Evts.C2C_ASK_LOG),game.GameViewMgr.inst().hideUnStrongViews();var a={type:game.InstanceType.ESCORT,rewards:t.useritem,exp:t.exp};game.playBack.play(t.battlelog,a),game.escortData.robNum++,game.escortData.targetRob.robNum++}},btn_rob:function(){var e=game.escortData.targetRob;if(e)if(game.playBack.isInstanceFighting());else game.sceneData.isGuildMap()||this.sender.EscortRobReq(e.id);else;}}),t=game.Sender.extends({ipc:function(){this.msg={EscortRobReq:this.escortRobReq}},escortRobReq:function(e){var t=game.pb.EscortRobRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.EscortRob,e,game.EscortRobEvts,t)}(),function(){var e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e.escortNum=0,e.robNum=0,e.helpNum=0,e.inviteNum=0,e.freeNum=0,e.itemId=0,e.targetRob=null,e.targetRevenge=null,e.doubleStartTime=0,e.doubleEndTime=0,e.rate=1,e.highCount=0},setup:function(e){var t=this;t.robList=e.list,t.escortNum=e.escortNum,t.robNum=e.robNum,t.helpNum=e.helpNum,t.inviteNum=e.inviteNum,t.freeNum=e.freeNum,t.myEscort=e.myEscort,t.itemId=e.itemId,t.doubleStartTime=e.doubleStartTime,t.doubleEndTime=e.doubleEndTime,t.rate=e.rate,t.highCount=e.highCount},addSelf:function(){if(this.myEscort){if(!this.robList){this.robList=[]}this.robList.push(this.myEscort)}},rmvSelf:function(){if(this.robList&&this.myEscort){var e=this.robList.indexOf(this.myEscort);if(-1<e){this.robList.splice(e,1)}}},isFinished:function(){return this.myEscort&&this.getEscortEndTime()<game.SysTime.curTime},mainViewAlert:function(){if(!game.moduleOpen.checkOpen(game.ME.Escort))return!1;var e=game.EscortMiscCfg.getNumber("escortNum")-this.escortNum;return 1<this.rate&&0<e&&!this.myEscort||!!this.isFinished()},getRateAlert:function(){var e=game.EscortMiscCfg.getNumber("escortNum")-this.escortNum;return 1<this.rate&&0<e&&!this.myEscort},getFinishAlert:function(){return!!this.isFinished()},getRevengeAlert:function(){return!!game.escortLogData.canRevenge()},getEscortEndTime:function(){var e=this.myEscort;if(!e){return game.SysTime.curTime+b8e.TimeUtil.WEEK_MICRO_SECONDS}var t=game.EscortCfg.getData(e.itemId);if(t)return e.startTime+t.seconds*b8e.TimeUtil.SECOND_MICRO_SECONDS;return game.SysTime.curTime+b8e.TimeUtil.WEEK_MICRO_SECONDS},getEscortRemainingTime:function(){var e=this.getEscortEndTime()-game.SysTime.curTime;return 0<e?e:0},isMaxQuality:function(){var e=game.EscortCfg.getData(this.itemId);return e&&e.quality==game.Quality.Q_RED},isMaxEscortNum:function(){var e=game.EscortMiscCfg.getNumber("escortNum");return this.escortNum>=e},getHighCount:function(){return this.highCount},addHighCount:function(){this.highCount++}});game.escortData=game.escortData||new e}(),function(){var e;e=b8e.Object.extends({id:0,isSelected:!1,isDoubleExp:!1,setData:function(e){this.id=e,this.isSelected=!1;var t=this.getCfg();this.quality=t.quality},getCfg:function(){return game.EscortCfg.getData(this.id)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$EscortGrainCarInfo",e)}(),function(){var e=b8e.Object.extends({init:function(){this.grainCarList=[],this.curItemId=-1},initGrainCarDatas:function(){if(!(this.curItemId<1)){var e=game.EscortCfg.getCfgsById(this.curItemId);if(e&&!(e.length<1)){for(var t=void 0,a=void 0,i=0,n=e.length;i<n;i++)t=e[i],(a=this.grainCarList[i])||(a=new game.EscortGrainCarInfo,this.grainCarList[i]=a),a.setData(t.id),a.isSelected=a.id==this.curItemId;this.grainCarList.sort(function(e,t){return e.quality-t.quality})}}},refreshCar:function(){for(var e,t=this.grainCarList,a=0,i=t.length;a<i;a++){if(e=t[a]){e.isSelected=e.id==this.curItemId}}},setDouble:function(){var t=1<game.escortData.rate;this.grainCarList.forEach(function(e){e.isDoubleExp=t},this)},setFirstSelect:function(){var e=this.grainCarList;!e||e.length<1||(this.curItemId=e[0].id)}});game.escortListData=game.escortListData||new e}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.Logs=[]},setup:function(e){if(!e||e.length<1);else for(var t,a=0,i=e.length;a<i;a++){if(!(t=this.Logs[a])){t=new game.EscortLogInfo,this.Logs[a]=t}t.setData(e[a])}},getCurRobLog:function(e){var t=this.Logs;if(!t||t.length<1){return null}for(var a,i=[],n=0;n<t.length;n++){if((a=t[n]).id==e&&2==a.type&&!a.win){i.push(a)}}return i},checkRob:function(e){var t,a=this.Logs;if(!a||a.length<1){return!1}for(var i=0;i<a.length;i++){if((t=a[i]).id==e&&1==t.type){return!0}}return!1},canRevenge:function(){var e,t=this.Logs;if(!t||t.length<1){return!1}for(var a=t.length-1;0<=a;a--){if(2==(e=t[a]).type&&!e.win&&!e.revenge){return!0}}return!1}});game.escortLogData=game.escortLogData||new e}(),function(){var e;e=b8e.Object.extends({type:0,id:0,itemId:0,roleId:0,roleName:0,rolePower:0,guildName:"",isMale:!0,zone:0,time:0,win:!1,revenge:!1,revengeWin:!1,setData:function(e){if(e){var t=this;t.type=e.type,t.id=e.id,t.itemId=e.itemId,t.roleId=e.roleId,t.roleName=e.roleName,t.rolePower=e.rolePower,t.guildName=e.guildName,t.isMale=e.isMale,t.zone=e.zone,t.time=e.time,t.win=e.win,t.revenge=e.revenge,t.revengeWin=e.revengeWin}else;}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$EscortLogInfo",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(347)},onShow:function(){this.createView(),game.TweenUtil.rotationEffect(this.skin.light)},onHide:function(){if(this._graincar){this._graincar.node.active=!1}if(this._nameBg){this._nameBg.node.active=!1}b8e.Tween.kill(this.skin.light)},createView:function(){var e=game.escortData.myEscort;if(e){var t=game.EscortCfg.getData(e.itemId);if(t){if(this._graincar=this.getComponent("graincar"+t.quality),this._graincar){this._graincar.node.active=!0}this.skin.huawen_3.width=b8e.stageWidth+100,this.skin.huawen_1.width=b8e.stageWidth+100;game.HtmlUtil.getColorByQuality(t.quality-1,!0);this.skin.lab_name.string=t.name,this.createPrize(e.id,e.rate,t.quality,t.rewards,t.robRewards),this.createLog(e.id)}else;}else;},createPrize:function(e,i,t,a,n){var s=game.escortLogData.getCurRobLog(e),o=s?s.length:0;if(t==game.Quality.Q_RED){o=0}var r=game.CfgUtil.getPrizeListInfo(a);if(r&&r.items){var g=game.CfgUtil.getPrizeListInfo(n);if(g&&g.items){var l,c,h="",m="",u="",d=0;r.items.forEach(function(e){if(c=game.ItemInfoCfg.getData(e.id)){if(0<o)for(var t=0,a=g.items.length;t<a;t++){if((l=g.items[t]).id==e.id){break}l=null}if(h=game.Lang.get(549,c.name,e.num*i,l?"-"+l.num*i*o:""),h+="<br/>",d<2){m+=h}else u+=h;d++}else;},this),this.skin.lab_award.string=m,this.skin.lab_award1.string=u}else;}else;},createLog:function(e){var t=game.escortLogData.getCurRobLog(e);if(!t||t.length<1){this.skin.lab_log.string=game.Lang.get(9124),this.skin.lab_log.x=329,this.skin.lab_log.y=-652}else{var a="";t.forEach(function(e){a+=game.Lang.get(548,e.roleName)},this),this.skin.lab_log.string=a,this.skin.lab_log.x=139,this.skin.lab_log.y=-634}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+100;this.setPosition(e,t),this.skin.gray.setSize(b8e.stageWidth+50,660)}});b8e.module.registerView(game.ME.EscortFinish,e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(348)},onShow:function(){this.createCar(),this.createTimer(),this.setVisible(!0)},onHide:function(){if(this._car){this._car.node.active=!1}this.clearTimer(),this.setVisible(!1)},createTimer:function(){if(!this._timer){this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start()}},clearTimer:function(){if(this._timer){b8e.Timer.remove(this,this.updateTime),this._timer=null}},createCar:function(){var e=this,t=e.carData,a=e.cfg;if(t&&a){var i=game.EscortMiscCfg.getNumber("escortMaxRobNum");if(e.canRob=t.robNum<i&&!game.escortLogData.checkRob(t.id),t.roleId==game.mainRoleData.id){this._car=this.getComponent("graincar"+a.quality)}else e._car=e.getComponent("graincar"+(e.canRob?a.quality:0));e._car.node.active=!0,e.skin.lab_name.string=t.roleName+" S."+t.zone,e.skin.namebg.width=e.skin.lab_name.width+70,e.updateTime()}else;},setData:function(e){this.carData=e,this.cfg=game.EscortCfg.getData(e.itemId)},updateTime:function(){if(this.cfg&&this.carData){var e=this.carData.startTime+1e3*this.cfg.seconds-game.SysTime.curTime>>0;e=0<=e?e:0,this.skin.lab_time.string=b8e.TimeUtil.formatTime(e)}else{this._timer.stop()}},btn_select:function(){var e=game.escortData;if(e&&e.myEscort&&this.carData.roleId==e.myEscort.roleId){game.notice.show(547)}else if(this.canRob){if(game.escortData.targetRob=this.carData,game.module.show(game.ME.EscortRob),this.parent){b8e.Tween.pause(this.parent)}}else{game.notice.show(551)}}}),b8e.RC("$$game","$$EscortGrainCar",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(349),this.setSize(600,135)},init:function(){this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this.list.itemRender=game.ShowItemListItem,this.list.layout.paddingTop=0,this.list.layout.spacingX=15,this.list.addToParent(this.skin.node_prize)},setData:function(e){if(e){var t=game.EscortCfg.getData(e.id);if(t){var a=game.HtmlUtil.getColorByQuality(t.quality-1,!0);this.skin.lab_name.string=game.HtmlUtil.getText(a,t.name),this.getComponent("graincar"+t.quality).node.active=!0,this.getComponent("nameBg"+(t.quality-1)).node.active=!0,this.skin.item_bg2.node.active=e.isSelected,this.skin.img_double_exp.node.active=e.isDoubleExp,this.createPrize(t.rewards)}else;}else;},createPrize:function(e){if(this.list&&e&&!(e.length<1)){var t=game.CfgUtil.getPrizeListInfo(e,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);t&&this.list.setData(t.items)}}}),b8e.RC("$$game","$$EscortGrainCarItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(350)},init:function(){var e=this.skin;this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.EscortGrainCarItem,this.list.layout.paddingLeft=5,this.list.layout.paddingTop=2,this.list.layout.spacingY=5,this.list.addToParent(this.skin.node_scrollview),this.escortData=game.escortData;var t=game.IconSizeEnum.GRID_SIZE_42,a=game.GridUtil.createViewClickIcon(t);a.setItemId(21),a.addToParent(e.gold1);var i=game.GridUtil.createViewClickIcon(t);i.setItemId(21),i.addToParent(e.gold2)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createPanel()}},onShow:function(){this.createPanel(),this.createCost()},createPanel:function(){this.createItemList(),this.createInfo()},createItemList:function(){if(this.list){var e=game.escortListData.grainCarList;if(!e||e.length<1);else this.list.setData(e)}else;},createCost:function(){this.skin.lab_cost1.string=game.EscortMiscCfg.getNumber("escortRefreshCost1"),this.skin.lab_cost2.string=game.EscortMiscCfg.getNumber("escortRefreshCost2")},createInfo:function(){if(this.escortData){var e=game.EscortMiscCfg.getNumber("escortNum");this.skin.lab_escort_info.string=game.Lang.get(527,e-this.escortData.escortNum+"/"+e)}else;}});b8e.module.registerView(game.ME.EscortList,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(351),this.setSize(542,92)},setData:function(e){var t=this.skin;t.btn_revenge.active=!1;var a=game.EscortCfg.getData(e.itemId),i=game.HtmlUtil.getColorStrByQuality(a.quality-1,a.name,!0),n=e.roleName,s="";switch(this.skin.status1.node.active=!1,this.skin.status2.node.active=!1,this.skin.status3.node.active=!1,e.type){case 0:s=game.Lang.get(544,i);break;case 1:if(e.win){this.skin.status1.node.active=!0}else this.skin.status3.node.active=!0;s=game.Lang.get(539,n,i);break;case 2:if(e.win){this.skin.status3.node.active=!0}else if(e.revenge)if(e.revengeWin){this.skin.status2.node.active=!0}else this.skin.status3.node.active=!0;else{t.btn_revenge.active=!0}s=game.Lang.get(543,n,i)}t.lab_content.string=s,t.lab_time.string=b8e.TimeUtil.formatTimestamp(e.time)},btn_revenge:function(){this.send(game.EscortLogEvts.V2C_CLICK_REVENGE,this.data)}}),b8e.RC("$$game","$$EscortLogItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(352)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.EscortLogItem,this._list.bindEnum=game.ME.EscortLog,this._list.layout.paddingLeft=5,this._list.addToParent(this.skin.node_scrollview)},notify:function(e){switch(e){case this.Evts.C2V_SYN_LOG_SUCCEED:this.createLogs()}},onShow:function(){this.send(this.Evts.V2C_SYN_LOG)},createLogs:function(){if(this._list)this._list.setData(game.escortLogData.Logs);else;}});b8e.module.registerView(game.ME.EscortLog,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(353)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.list.itemRender=game.PrizeListItem,e.list.layout.spacingX=15,e.list.addToParent(e.skin.node_prize),e.headIcon=b8e.Sprite.get(),e.headIcon.setAnchor(.5,.5),e.headIcon.setSize(68,68),e.headIcon.addToParent(e.skin.node_head)},notify:function(e){},onShow:function(){this.createInfo()},createInfo:function(){var e=game.escortData.targetRevenge;if(e){this.skin.lab_player_info.string=game.Lang.get(545,e.roleName,e.rolePower,e.guildName?e.guildName:game.Lang.get(9024));var t=game.EscortCfg.getData(e.itemId);if(t){this.createPrize(t.revengeRewards)}var a=game.ResCfg.getHead(e.isMale);this.headIcon.loadTexture(a)}else;},createPrize:function(e){if(!this.list||!e||e.length<1);else{var t=game.CfgUtil.getPrizeListInfo(e);if(t)this.list.setData(t.items),this.list.setScale(.85,.85);else;}}});b8e.module.registerView(game.ME.EscortRevenge,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(354)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.list.itemRender=game.PrizeListItem,e.list.layout.spacingX=18,e.list.addToParent(e.skin.node_prize)},notify:function(e){},onShow:function(){this.createInfo()},onHide:function(){if(this._car){this._car.node.active=!1}if(this._nameBg){this._nameBg.node.active=!1}this.send(this.Evts.V2C_ROB_VIEW_CLOSE)},createInfo:function(){var e=game.escortData.targetRob;if(e){this.skin.lab_player_info.string=game.Lang.get(545,e.roleName,e.rolePower,e.guildName?e.guildName:game.Lang.get(9024));var t=game.EscortCfg.getData(e.itemId);if(t){this.createPrize(t.robRewards),this._car=this.getComponent("graincar"+t.quality),this._car.node.active=!0,this._nameBg=this.getComponent("nameBg"+t.quality),this._nameBg.node.active=!0,this.skin.lab_name.string=game.HtmlUtil.getColorStrByQuality(t.quality,t.name)}var a=game.EscortMiscCfg.getNumber("escortRobNum");this.skin.lab_robnum.string=game.Lang.get(546,a-game.escortData.robNum+"/"+a)}else;},createPrize:function(e){if(!this.list||!e||e.length<1);else{var t=game.CfgUtil.getPrizeListInfo(e);if(t)this.list.setData(t.items),this.list.setScale(.85,.85);else;}}});b8e.module.registerView(game.ME.EscortRob,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(355),this._remainingTime=0,this._pos=[{x:-118,y:-403},{x:-340,y:-240},{x:-340,y:-540},{x:-538,y:-403},{x:-812,y:-240},{x:-812,y:-540}],this._carList=[],this._layer=1,this._showCarCount=0,this._moveLen=640,this.spotAlerts={ESCORT_LOG:this.logAlert}},notify:function(e){var t=this;switch(e){case t.Evts.C2V_ESCORT_FINISHED:t.createInfo(),t.createGrainCar(),t.checkShowFinishView();break;case t.Evts.C2V_SYN_DATA:t.createView();break;case t.Evts.C2V_UPDATE_VIEW:t.createInfo(),t.createGrainCar(),t.setPageBtnStatus(),t.escortAlert(),t.checkShowFinishView();break;case t.Evts.C2V_ROB_VIEW_CLOSE:t.resumeCarMove();break;case t.Evts.C2V_PAGE_LEFT:t.onClickPageLeft();break;case t.Evts.C2V_PAGE_RIGHT:t.onClickPageRight()}},init:function(){this._bgImg=b8e.Sprite.get(),this._bgImg.addToParent(this.skin.node_bg),this._bgImg.setAnchor(0,1),this._timer=b8e.Timer.add(this,this.updateTime,500),this._timer.stop()},onShow:function(){this.send(this.Evts.V2C_ASK_SYN_DATA)},createView:function(){this.createBg(),this.createInfo(),this.checkShowFinishView(),this.createGrainCar(),this.setPageBtnStatus(),this.escortAlert()},onHide:function(){if(this._timer){this._timer.stop()}b8e.Tween.kill(this.skin.node_car);for(var e=this._carList,t=0,a=e.length;t<a;t++){e[t].hide()}},setPageBtnStatus:function(){var e=game.escortData.robList;this._maxLayer=e?Math.ceil(e.length/6):1,this.skin.btn_right.node.active=this._layer<this._maxLayer,this.skin.btn_left.node.active=1<this._layer},onClickPageLeft:function(){var e=this._layer;if(this._layer=Math.max(1,this._layer-1),e!=this._layer){this.createGrainCar(),this.setPageBtnStatus()}},onClickPageRight:function(){var e=this._layer;if(this._layer=Math.min(this._layer+1,this._maxLayer),e!=this._layer){this.createGrainCar(),this.setPageBtnStatus()}},checkShowFinishView:function(){if(game.escortData.isFinished()){game.module.show(game.ME.EscortFinish),this.skin.lab_escort.string=game.Lang.get(550)}else{var e=0<this._remainingTime&&game.escortData.myEscort;this.skin.lab_escort.string=game.Lang.get(e?535:534)}},createBg:function(){this._bgImg.loadTexture(game.ResCfg.getUrl(15))},createInfo:function(){var e=game.escortData,t=game.EscortMiscCfg.getNumber("escortNum"),a=game.EscortMiscCfg.getNumber("escortRobNum");this.skin.lab_escort_info.string=game.Lang.get(528,t-e.escortNum+"/"+t,a-e.robNum+"/"+a),this._remainingTime=e.getEscortRemainingTime();var i=0<this._remainingTime&&e.myEscort;if(this.skin.lab_escort_time.node.active=i,this.skin.lab_escort_time.string=b8e.TimeUtil.formatTime(this._remainingTime),this.skin.btn_quickly.node.active=i,this.skin.img_double.node.active=1<game.escortData.rate,0<this._remainingTime){this._timer.reset(),this._timer.start()}},createGrainCar:function(){var e=game.escortData.robList;if(e){for(var t,a,i,n=6*(this._layer-1),s=0,o=0;o<6;o++){if(t=this._carList[o]){t.hide()}if(i=e[n+o]){if(t)t.setData(i),t.show();else{(t=new game.EscortGrainCar).setData(i),t.addToParent(this.skin.node_car),this._carList.push(t)}a=this._pos[o],t.x=a.x,t.y=a.y,s=Math.min(s,t.x),this._showCarCount++}}if(this._moveLen=640+Math.abs(s)+115,this._moveTime=this._moveLen/60,0<this._showCarCount){this.onTweenComplete()}}else;},logAlert:function(e){this.skin.logAlert.node.active=e.alert},escortAlert:function(){this.skin.escortAlert.node.active=game.escortData.mainViewAlert()},resumeCarMove:function(){b8e.Tween.resume(this.skin.node_car)},onTweenComplete:function(){this.skin.node_car.x=0,b8e.Tween.kill(this.skin.node_car),b8e.Tween.get(this.skin.node_car).to({x:this._moveLen,y:-150},this._moveTime*b8e.TimeUtil.SECOND_MICRO_SECONDS).call(this.onTweenComplete,this)},updateTime:function(){if(this._remainingTime=game.escortData.getEscortRemainingTime(),this.skin.lab_escort_time.string=b8e.TimeUtil.formatTime(this._remainingTime),this._remainingTime<=0){this.createInfo(),this.checkShowFinishView(),this._timer.stop()}}});b8e.module.registerView(game.ME.Escort,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,C2V_UPDATE_RANK:-1,V2C_ANSWER:-1,C2C_SHOW_ENTER:-1,C2C_INIT_MODEL:-1,C2C_EXAM_QUESTION:-1,C2C_CLOSE_ENTER:-1,C2C_EXAM_QUESTION_RIGHT:-1}),b8e.RC("$$game","$$ExamEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.EXAM,game.SAE.ACTIVITIES_HALL),this.examData=game.examData,this.examData.init()},ipc:function(){var e=this;e.gevts={SceneGEvts:{ENTER_SCENE:e.checkEnter}},e.evts={DailyFuLi:{C_INIT_MODULE:e.initModule},ExamEnter:{C2C_CLOSE_ENTER:e.closeEnter}},e.handels={ExamMsg:e.onExamNotify,ExamInfoResp:e.onExamInfoRsp,ExamAnswerResp:e.onExamAnswerRsp,ExamChampionMsg:e.onExamChampionNotify}},notify:function(e,t){switch(e){case this.Evts.V2C_ANSWER:this.examData.isAnswer||this.sender.ExamAnswerReq(this.examData.index,t)}},checkAlert:function(){game.moduleOpen.checkOpen(this.moduleEnum)?this.spotAlert.alert=!1:this.spotAlert.alert=this.examData.examStartTime<=game.SysTime.curTime&&game.SysTime.curTime<=this.examData.examEndTime},initModule:function(e){e&&e.data&&(this.examData.champion=e.data.examChampion,this.examData.count=e.data.examCount,this.dpt(this.Evts.C2C_INIT_MODEL))},btn_rank:function(){game.module.show(game.ME.ExamRank)},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.DATI_SHOP)},checkEnter:function(){var e=this.examData.examStartTime,t=this.examData.examEndTime,a=game.SysTime.curTime;if(a<e){var i=e-a+1e3;this.createEnterTimer(i)}else e<=a&&a<t?this._synExamData():this.closeEnter()},createEnterTimer:function(e){b8e.hasTimeout(this._synExamData,this)||b8e.setTimeout(this._synExamData,this,e)},_synExamData:function(){this.sender.ExamInfoReq()},closeEnter:function(){game.module.hide(game.ME.ExamEnter),this.checkAlert()},createTimer:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._lastTime=b8e.timeStamp,this._timer.start())},clearTimer:function(){if(this._timer)b8e.Timer.remove(this,this.updateTime),this._timer=null;else;},updateTime:function(){var e=this,t=b8e.timeStamp,a=.001*(t-e._lastTime);if(e._lastTime=t,e.examData.endTime=Math.max(0,e.examData.endTime-a),e.examData.enterViewTime=Math.max(0,e.examData.enterViewTime-a),0==e.examData.endTime)if(e.examData.isAnswer)e.clearTimer();else{var i=4*Math.random()+1>>0;e.sender.ExamAnswerReq(e.examData.index,i)}},setQuestion:function(e,t,a){var i=this.examData.setQuestion(e,t,a);return i&&0<this.examData.endTime&&this.createTimer(),i},onExamNotify:function(e){var t=e.readProtobuf(game.pb.ExamNotify);if(0<t.code)game.notice.noticeError(t.code);else if(game.moduleOpen.checkOpen(game.ME.Exam)){var a=this.setQuestion(t.index,t.id);this.examData.setRankData(t.rank),a?(this.send(this.Evts.C2V_UPDATE_VIEW),this.dpt(this.Evts.C2C_SHOW_ENTER)):this.send(this.Evts.C2V_UPDATE_RANK),this.checkAlert(),t.isLast&&0<game.examData.score&&game.module.show(game.ME.ExamResult)}},onExamInfoRsp:function(e){var t=e.readProtobuf(game.pb.ExamInfoResponse);0<t.code?game.notice.noticeError(t.code):(this.setQuestion(t.index,t.id,t.curEndTime),this.examData.setup(t),this.dpt(this.Evts.C2C_SHOW_ENTER),this.checkAlert())},onExamAnswerRsp:function(e){var t=this,n=e.readProtobuf(game.pb.ExamAnswerResponse);0<n.code?game.notice.noticeError(n.code):(t.examData.index=n.index,t.examData.result=n.result,t.examData.score=n.score,t.examData.setResult(t.examData.id,n.result),game.ExamCfg.getDataAsync(t.examData.id,function(e){for(var t=!1,a=0,i=game.examData.answers.length;a<i;a++){if(game.examData.answers[a].id==n.result&&e.result==n.result){t=!0;break}}t&&this.dpt(this.Evts.C2C_EXAM_QUESTION_RIGHT)},t),t.send(t.Evts.C2V_UPDATE_VIEW),t.dpt(t.Evts.C2C_EXAM_QUESTION))},onExamChampionNotify:function(e){var t=e.readProtobuf(game.pb.ExamChampionNotify);0<t.code?game.notice.noticeError(t.code):this.examData.champion=t.champion}}),t=game.Sender.extends({ipc:function(){this.msg={ExamInfoReq:null,ExamAnswerReq:this.examAnswerReq}},examAnswerReq:function(e,t){var a=game.pb.ExamAnswerRequest;a.index=e,a.result=t,this.write(a)}});b8e.module.registerControl(game.ME.Exam,e,game.ExamEvts,t)}(),function(){var e=game.Control.extends({okBtn:function(){game.module.hide(this.moduleEnum)},closeBtn:function(){game.module.hide(this.moduleEnum)}});b8e.module.registerControl(game.ME.ExamResult,e,null,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Exam:{C2C_SHOW_ENTER:this.showEnter}}},showEnter:function(){if(game.examData.isShowEnter)if(game.moduleOpen.checkOpen(this.moduleEnum)){if(!game.sceneData.isGuildConflict()){game.module.show(this.moduleEnum,null,!1);var e=game.examData.examEndTime,t=game.SysTime.curTime,a=Math.max(0,e-t);this.createCloseTimer(a+500)}}else;else;},createCloseTimer:function(e){if(this._closeTimer);else this._closeTimer=b8e.Timer.add(this,this.updateCloseTime,e),this._closeTimer.start()},clearCloseTimer:function(){if(this._closeTimer)b8e.Timer.remove(this,this.updateCloseTime),this._closeTimer=null;else;},updateCloseTime:function(){this.closeEnter(),this.clearCloseTimer()},closeEnter:function(){this.dpt(this.Evts.C2C_CLOSE_ENTER)},btn_enter:function(){game.module.show(game.ME.Exam)}});b8e.module.registerControl(game.ME.ExamEnter,e,game.ExamEvts)}(),b8e.module.registerControl(game.ME.ExamRank,game.Control),function(){var e;e=b8e.Object.extends({index:0,id:0,status:0,isShow:!1,ctor:function(e){this._super(),this.id=e},clear:function(){this.status=0,this.isShow=!1,this.isSelected=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ExamAnswerInfo",e)}(),function(){var e=b8e.Object.extends({count:0,isShowEnter:!0,init:function(){var e=this;e.index=1,e.id=1,e.ranks=[],e.answers=[];for(var t=1;t<=4;t++){this.answers.push(new game.ExamAnswerInfo(t))}var a=game.ExamMiscCfg.getData("examQuestionDuration");e.questionDuration=a?parseInt(a.value):3,a=game.ExamMiscCfg.getData("examAnswerDuration"),e.answerDuration=(a?parseInt(a.value):18)-e.questionDuration;var i=(a=game.ExamMiscCfg.getData("examStartTime"))?parseInt(a.value):12;e.examStartTime=b8e.TimeUtil.getTodayTime(game.SysTime.curTime)+i*b8e.TimeUtil.HOUR_MICRO_SECONDS,a=game.ExamMiscCfg.getData("examNumber"),e.examNumber=a?parseInt(a.value):20,e.examEndTime=e.examStartTime+(e.answerDuration+e.questionDuration)*e.examNumber*b8e.TimeUtil.SECOND_MICRO_SECONDS,e.enterViewTime=0,e.isShowEnter=!0},setup:function(e){if(this.rank=0,this.score=e.examScore,this.setRankData(e.rank),e.index==e.lastAnswer){this.setResult(e.id,e.lastResult)}},setRankData:function(e){this.clearRankData();for(var t,a,i=game.mainRoleData.id,n=0,s=0,o=0,r=e.length;o<r;o++){if(a=e[o],(t=game.ExamRankInfo.get()).setData(o+1,a),this.ranks.push(t),a.roleId==i){n=o+1,s=a.score}}this.rank=n,this.score=s},clearRankData:function(){for(var e=this.ranks,t=0,a=e.length;t<a;t++){e[t].release()}this.ranks.length=0},setQuestion:function(e,t,a){var i=this;if(i.index==e){return!1}if(i.index=e,i.id=t,a)i.endTime=a-.001*game.SysTime.curTime>>0,i.enterViewTime=i.endTime;else{this.endTime=this.answerDuration,this.enterViewTime=this.endTime+this.questionDuration}return i.isAnswer=i.endTime<=i.questionDuration,i.resetAnswers(),i.randAnswers(),!0},resetAnswers:function(){for(var e=0,t=this.answers.length;e<t;e++){this.answers[e].clear()}},randAnswers:function(){for(var e,t,a=0,i=this.answers.length;a<i;a++){e=parseInt(Math.random()*(i-1)),t=this.answers[a],this.answers[a]=this.answers[e],this.answers[e]=t}for(a=0,i=this.answers.length;a<i;a++){this.answers[a].index=a}},autoResult:function(){this.setResult(this.id,0,!0)},setResult:function(e,s,t){var o=2<arguments.length&&void 0!==t&&t;if(this.isAnswer=!0,o){this.endTime=this.questionDuration}else this.endTime+=this.questionDuration,this.count++;game.ExamCfg.getDataAsync(e,function(e){for(var t,a=e.result==s,i=0,n=this.answers.length;i<n;i++)(t=this.answers[i]).isShow=!0,t.id!=s||o||(t.status=a?1:2)},this)},getExamCount:function(){return this.count}});game.examData=game.examData||new e}(),function(){var e,t=e=b8e.PoolObject.extends({rank:0,score:0,roleId:0,roleName:"",setData:function(e,t){this.rank=e,this.score=t.score,this.roleId=t.roleId,this.roleName=t.roleName,this.power=t.power},clear:function(){this.times=0}});b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,128),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$ExamRankInfo",e)}(),function(){var e=game.View.extends({_showModel:!1,ctor:function(){this._super(356)},onShow:function(){if(game.examData.isShowEnter)this.createTimer(),this.updateTime();else{game.module.hide(game.ME.ExamEnter)}},onHide:function(){this.clearTimer()},createTimer:function(){if(this._timer);else this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start()},clearTimer:function(){if(this._timer)b8e.Timer.remove(this,this.updateTime),this._timer=null;else;},updateTime:function(){this.skin.lab_num.string=game.Lang.get(572,game.examData.index+1),this.skin.lab_time.string=game.Lang.get(573,game.examData.enterViewTime>>0)},onStageResize:function(){var e=b8e.stageWidth;this.setPosition(e,286)},closeBtn:function(){this._super(),game.examData.isShowEnter=!1}});b8e.module.registerView(game.ME.ExamEnter,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(357),this.setSize(600,132)},setData:function(i){game.ExamCfg.getDataAsync(game.examData.id,function(e){var t=b8e.getDPV(e,"option"+i.id);if(t&&""!=t){this.setVisible(!0),this.skin.lab_answer.string=t,this.skin.right.node.active=i.isShow&&e.result==i.id,this.skin.wrong.node.active=i.isShow&&e.result!=i.id;for(var a=0;a<4;a++)this.getComponent("option"+a).node.active=i.index==a,a<3&&(this.getComponent("item"+a).node.active=i.status==a)}else this.setVisible(!1)},this)},btn_select:function(){this.send(game.ExamEvts.V2C_ANSWER,this.data.id)}}),b8e.RC("$$game","$$ExamItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(358),this.setSize(540,94)},setData:function(e){var t=this;switch(t.skin.rank1.active=!1,t.skin.rank2.active=!1,t.skin.rank3.active=!1,t.skin.item_bg.active=!1,t.skin.lab_rank.string="",e.rank){case 1:t.skin.rank1.active=!0;break;case 2:t.skin.rank2.active=!0;break;case 3:t.skin.rank3.active=!0;break;default:t.skin.item_bg.active=!0,t.skin.lab_rank.string=e.rank}t.skin.lab_name.string=e.roleName,t.skin.lab_score.string=e.score,t.skin.lab_pow.string=e.power}}),b8e.RC("$$game","$$ExamRankItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(359),this.setSize(240,32)},setData:function(e){var t;switch(e.rank){case 1:t=game.Color.RED;break;case 2:t=game.Color.BLUE;break;case 3:t=game.Color.GREEN;break;default:t=game.Color.BLACK}this.skin.lab_name.string=game.HtmlUtil.getText(t,e.rank+"."+e.roleName),this.skin.lab_score.string=game.HtmlUtil.getText(t,game.Lang.get(9497,e.score))}}),b8e.RC("$$game","$$ExamRankMiniItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(360)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.ExamRankItem,this._list.layout.paddingTop=0,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)},onShow:function(){this._list.setData(game.examData.ranks),this.skin.lab_rank.string=0<game.examData.rank?game.examData.rank+"":game.Lang.get(706),this.skin.lab_score.string=game.examData.score},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.ExamRank,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(362)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.ExamItem,e._list.bindEnum=game.ME.Exam,e._list.layout.paddingTop=0,e._list.addToParent(e.skin.node_scrollview),e._rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._rankList.itemRender=game.ExamRankMiniItem,e._rankList.layout.paddingTop=0,e._rankList.bindEnum=game.ME.Exam,e._rankList.addToParent(e.skin.node_rank_scrollview),e.examData=game.examData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createQuestion(),this.createRank();break;case this.Evts.C2V_UPDATE_RANK:this.createRank()}},onShow:function(){this.createQuestion(),this.createRank()},onHide:function(){this.clearTimer()},createTimer:function(){if(this._timer);else this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start()},clearTimer:function(){if(this._timer)b8e.Timer.remove(this,this.updateTime),this._timer=null;else;},updateTime:function(){if(this.examData.endTime<1){if(this.examData.index+1>=this.examData.examNumber){return this.skin.lab_time.string=game.Lang.get(576),void this.clearTimer()}}this.skin.lab_time.string=game.Lang.get(this.examData.isAnswer?570:569,this.examData.endTime>>0)},createQuestion:function(){var e=this;game.ExamCfg.getDataAsync(e.examData.id,function(e){this.skin.lab_question.string=e.question},e);var t=game.ExamMiscCfg.getData("examNumber");e.skin.lab_count.string=game.Lang.get(568,e.examData.index+1,t.value),e._list.setData(e.examData.answers),0<e.examData.endTime&&e.createTimer(),e.skin.lab_time.string=game.Lang.get(e.examData.isAnswer?570:569,e.examData.endTime>>0)},createRank:function(){this._rankList.setData(this.examData.ranks);var e=0<this.examData.rank?this.examData.rank:"--";this.skin.lab_mine_rank.string=game.Lang.get(571,e,this.examData.score)}});b8e.module.registerView(game.ME.Exam,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(361)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._list.itemRender=game.PrizeListItem,e._list.layout.paddingTop=-9,e._list.layout.spacingX=25,e._list.addToParent(e.skin.prizeNode)},onShow:function(){var e=game.examData,t=this.skin;t.rankLab.string=e.rank,t.scoreLab.string=game.Lang.get(640,e.score);var a=game.ExamAwardCfg.getDataByRank(e.rank);if(a){var i=game.CfgUtil.getPrizeListInfo(a.award);if(i)this._list.setData(i.items),this.countDownTime=6;else;}else;},onHide:function(){this.clearCountDown()},createCountDown:function(){if(!this.timer){this.timer=b8e.Timer.add(this,this.updateTime,1e3)}this.timer.reset(),this.timer.start()},clearCountDown:function(){if(this.timer)b8e.Timer.remove(this,this.updateTime),this.timer=null;else;},updateTime:function(){if(this.countDownTime--,this.skin.okLab.string=game.Lang.get(641,this.countDownTime),this.countDownTime<1){game.module.hide(game.ME.ExamResult)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.ExamResult,e)}(),function(){var e,t;t=b8e.Enum({NONE:0,UPDATE_MODULE_DATA:-1,C2V_UPDATE_DATA:-1,V_SHOW:-1,C2V_ACTIVE_SUCCEED:-1,C2V_CHANGE_SUCCEED:-1,C2V_SELECTED:-1,C2V_SKIN_LEFT:-1,C2V_SKIN_RIGHT:-1,C2V_UPDATE_ITEM:-1,V2C_SELECTED:-1,V2C_HIDE:-1,UPDATE_NICK_ATT:-1,C2V_UPDATE_LIST:-1,C2C_UPDATE_MODEL:-1,V2C_ACTIVE:-1,V2C_CHANGE:-1,V2C_GOTO:-1,V2C_PRE_STAT:-1,C2C_UPDATE_SURFACE:-1,V2C_CANCEL:-1}),e=b8e.Enum({NICKNMAE:0,FASHION:1,MOUNT:2,WING:3,WEAPON:4}),b8e.RC("$$game","$$SurfaceEvts",t),b8e.RC("$$game","$$SurfaceTypes",e)}(),function(){var e=game.Control.extends({init:function(){var e=this;e.surfaceAlert=game.spotAlert.set(game.SAE.SURFACE,game.SAE.PARTNER_MAIN),e.nickNameTabAlert=game.spotAlert.set(game.SAE.NICKNAME_PAGE,game.SAE.SURFACE),e.fashionTabAlert=game.spotAlert.set(game.SAE.FASHION_PAGE,game.SAE.SURFACE),e.mountTabAlert=game.spotAlert.set(game.SAE.MOUNT_PAGE,game.SAE.SURFACE),e.wingTabAlert=game.spotAlert.set(game.SAE.WING_PAGE,game.SAE.SURFACE),e.weaponTabAlert=game.spotAlert.set(game.SAE.WEAPON_PAGE,game.SAE.SURFACE),e.nickNameAlert=game.spotAlert.set(game.SAE.NICKNAME,game.SAE.NICKNAME_PAGE),e.fashionAlert=game.spotAlert.set(game.SAE.FASHION,game.SAE.FASHION_PAGE),e.mountAlert=game.spotAlert.set(game.SAE.MOUNT,game.SAE.MOUNT_PAGE),e.wingAlert=game.spotAlert.set(game.SAE.WING,game.SAE.WING_PAGE),e.weaponAlert=game.spotAlert.set(game.SAE.WEAPON,game.SAE.WEAPON_PAGE),e.data=game.surfaceData},triggerOpen:function(e){this.isInitAll||e==this.moduleEnum&&this.sender.QrySurfaceReq()},ipc:function(){var e=this;e.evts={Back:{C_BACK_SYN_BACK_INFO:e.onUpdateItem,C_BACK_UPDATE_ITEMINFO:e.onUpdateItem}},e.handels={QrySurfaceResp:e.onQrySurfaceRsp,ActivateFashionResp:e.onActivateFashionRsp,FashionHuanhuaResp:e.onFashionHuanhuaRsp,ActivateNicknameResp:e.onActiveNickNameRsp,NicknameHuanhuaResp:e.onNickNameHuanhuaRsp,RemoveNicknameMsg:e.onRemoveNickname}},onUpdateItem:function(){this.checkAllAlert(),this.send(this.Evts.C2V_UPDATE_DATA)},checkAllAlert:function(){var e=this,t=game.SurfaceTypes;e.isInitAll&&(game.moduleOpen.checkOpen(game.ME.NickNameSkin)&&(e.nickNameAlert.alert=e.data.checkIsCanActive(t.NICKNMAE)),game.moduleOpen.checkOpen(game.ME.FashionSkin)&&(e.fashionAlert.alert=e.data.checkIsCanActive(t.FASHION)),game.moduleOpen.checkOpen(game.ME.MountSkin)&&(e.mountAlert.alert=e.data.checkIsCanActive(t.MOUNT)),game.moduleOpen.checkOpen(game.ME.WeaponSkin)&&(e.weaponAlert.alert=e.data.checkIsCanActive(t.WEAPON)),game.moduleOpen.checkOpen(game.ME.WingSkin)&&(e.wingAlert.alert=e.data.checkIsCanActive(t.WING)))},onQrySurfaceRsp:function(e){var t=this,a=e.readProtobuf(game.pb.SurfaceModelResponse);if(0<a.code){game.notice.noticeError(a.code)}else t.data.setup(a.fashions,a.useFashions),t.data.setup(a.nicknames,[a.useNickname]),t.isInitAll=!0,t.checkAllAlert(),t.updateFashionModel(),t.updateNickNameModel(),t.dpt(t.Evts.UPDATE_MODULE_DATA,a),t.send(t.Evts.C2V_UPDATE_DATA)},notify:function(e,t){var a=this;switch(e){case a.Evts.V2C_SELECTED:a.data.setSelected(t.type,t.id),a.send(a.Evts.C2V_SELECTED,t);break;case a.Evts.V2C_HIDE:break;case a.Evts.V2C_ACTIVE:a.activeSurface(t);break;case a.Evts.V2C_CHANGE:a.changeSurface(t);break;case a.Evts.V2C_GOTO:t&&game.module.show(t);break;case a.Evts.V2C_PRE_STAT:a.data.statType=t,game.module.show(game.ME.SurfaceStat);break;case a.Evts.V2C_CANCEL:a.data.statType=t,a.cancelSurface(t)}},btn_left:function(){this.send(this.Evts.C2V_SKIN_LEFT)},btn_right:function(){this.send(this.Evts.C2V_SKIN_RIGHT)},recycleSurfaceBtn:function(){game.module.show(game.ME.RecycleSurface)},cancelSurface:function(e){var t=this.data.surfaceSelects.get(e);if(t){var a=this.data.getInfo(t);a.type==game.SurfaceTypes.NICKNMAE?this.sender.NicknameHuanhuaReq(0):this.sender.FashionHuanhuaReq(0,a.type)}},changeSurface:function(e){var t=this.data.surfaceSelects.get(e);if(t){var a=this.data.getInfo(t);a.type==game.SurfaceTypes.NICKNMAE?this.sender.NicknameHuanhuaReq(t):this.sender.FashionHuanhuaReq(t,a.type)}},activeSurface:function(e){var t=this.data.surfaceSelects.get(e);t&&(this.data.getInfo(t).type==game.SurfaceTypes.NICKNMAE?this.sender.ActivateNicknameReq(t):this.sender.ActivateFashionReq(t))},btn_1:function(){this.send(this.Evts.V_SELECT_CHANGE,0)},btn_2:function(){this.send(this.Evts.V_SELECT_CHANGE,1)},btn_3:function(){this.send(this.Evts.V_SELECT_CHANGE,2)},btn_4:function(){this.send(this.Evts.V_SELECT_CHANGE,3)},btn_5:function(){this.send(this.Evts.V_SELECT_CHANGE,4)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)},onActiveNickNameRsp:function(e){var t=e.readProtobuf(game.pb.ActivateNicknameResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=this.data.surfaceInfos.get(t.id);this.data.getTotalStatByType(a.type);game.FightAmount.inst().showTeamStatPower(),this.data.add(t.id,t.expireTime),this.data.getTotalStatByType(a.type),this.send(this.Evts.C2V_UPDATE_DATA),this.sender.NicknameHuanhuaReq(t.id),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeActivation)}},onNickNameHuanhuaRsp:function(e){var t=e.readProtobuf(game.pb.NicknameHuanhuaResponse);0<t.code?game.notice.noticeError(t.code):(this.data.change(t.id,game.SurfaceTypes.NICKNMAE),this.send(this.Evts.C2V_UPDATE_DATA),this.updateNickNameModel(),this.dpt(this.Evts.C2C_UPDATE_SURFACE))},updateNickNameModel:function(){var e=game.mainRoleData.heroModel,t=this.data.getCurWearType(game.SurfaceTypes.NICKNMAE);if(t){var a=game.NicknameCfg.getData(t);a?e.setAnim(game.AnimType.NICK_NAME,a.model):e.setAnim(game.AnimType.NICK_NAME,null)}else e.setAnim(game.AnimType.NICK_NAME,null);game.AvatarUtil.updateNickName(game.mainRole),this.dpt(this.Evts.C2C_UPDATE_MODEL)},onRemoveNickname:function(e){var t=e.readProtobuf(game.pb.RemoveNicknameNotify);if(0<t.code)game.notice.noticeError(t.code);else{this.data.remove(t.id);var a=this.data.getTopId();a&&(this.data.setSelected(game.SurfaceTypes.NICKNMAE,a),t.id==this.data.getCurWearType(game.SurfaceTypes.NICKNMAE)&&this.sender.NicknameHuanhuaReq(a),this.send(this.Evts.C2V_UPDATE_DATA))}},onActivateFashionRsp:function(e){var t=e.readProtobuf(game.pb.ActivateSurfaceResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=this.data.surfaceInfos.get(t.id);this.data.getTotalStatByType(a.type);game.FightAmount.inst().showTeamStatPower(),this.data.add(t.id),this.data.getTotalStatByType(a.type),this.sender.FashionHuanhuaReq(t.id,a.type),this.send(this.Evts.C2V_UPDATE_DATA),this.dpt(this.Evts.C2V_ACTIVE_SUCCEED,t.id),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeActivation)}},onFashionHuanhuaRsp:function(e){var t=e.readProtobuf(game.pb.FashionHuanhuaResponse);0<t.code?game.notice.noticeError(t.code):(this.data.change(t.id,t.types),this.send(this.Evts.C2V_UPDATE_DATA),this.updateFashionModel(),this.dpt(this.Evts.C2C_UPDATE_SURFACE))},updateFashionModel:function(){var e=game.mainRoleData.heroModel,t=this.data.surfaceWearMap.values();e.setSurfaces(t,!1),game.AvatarUtil.update(game.mainRole)}}),t=game.Sender.extends({ipc:function(){this.msg={QrySurfaceReq:null,ActivateFashionReq:this.activateFashionReq,FashionHuanhuaReq:this.fashionHuanhuaReq,ActivateNicknameReq:this.activateNickNameReq,NicknameHuanhuaReq:this.nickNameHuanhuaReq}},activateFashionReq:function(e){var t=game.pb.ActivateSurfaceRequest;t.id=e,this.write(t)},fashionHuanhuaReq:function(e,t){var a=game.pb.FashionHuanhuaRequest;a.id=e,a.types=t,this.write(a)},activateNickNameReq:function(e){var t=game.pb.ActivateNicknameRequest;t.id=e,this.write(t)},nickNameHuanhuaReq:function(e){var t=game.pb.NicknameHuanhuaRequest;t.id=e,this.write(t)}}),a=[game.ME.NickNameSkin,game.ME.FashionSkin,game.ME.MountSkin,game.ME.WeaponSkin,game.ME.WingSkin,game.ME.SurfaceStat];b8e.module.registerControl(game.ME.Surface,e,game.SurfaceEvts,t,a)}(),function(){var e=void 0;e=b8e.Object.extends({statType:0,ctor:function(){this._super(),this.surfaceTypesInfo=b8e.HashMap.get(),this.surfaceWearMap=b8e.HashMap.get();var e=game.SurfaceTypes;this.surfaceTypes=[e.FASHION,e.MOUNT,e.WING,e.WEAPON],this.surfaceSelects=b8e.HashMap.get(),this.surfaceSpriteStat=game.SpriteStat.get()},getUseIdByType:function(e){return this.surfaceWearMap.get(e)||0},setup:function(e,t){var a=this,i=void 0;a._initInfos(),a.surfaceDatas&&(a.surfaceDatas=a.surfaceDatas.concat(e)),a.surfaceDatas||(a.surfaceDatas=e);for(var n=0,s=t.length;n<s;n++)(i=a.surfaceInfos.get(t[n]))&&a.surfaceWearMap.set(i.type,t[n]);if(a.surfaceDatas)for(var o=void 0,r=a.surfaceDatas.length-1;0<=r;r--)o="number"==typeof a.surfaceDatas[r]?a.surfaceDatas[r]:a.surfaceDatas[r].id,(i=a.surfaceInfos.get(o))&&(i.isActive=!0,i.isWeared=i.id==a.getUseIdByType(i.type),i.isSelect=i.isWeared,i.type==game.SurfaceTypes.NICKNMAE&&(i.expireTime=a.surfaceDatas[r].expireTime),i.isWeared&&a.surfaceSelects.set(i.type,i.id))},add:function(e,t){if(this.surfaceInfos){var a=this.surfaceInfos.get(e);a.type==game.SurfaceTypes.NICKNMAE?this.surfaceDatas.push({id:e,expireTime:t}):this.surfaceDatas.push(e),a&&(a.isActive=!0,a.isCanActive=!1,a.expireTime=t)}},change:function(e,t){if(this.surfaceInfos){var a=this.surfaceInfos.get(0|this.surfaceWearMap.get(t));if(a&&(a.isWeared=!1),0!=e){var i=this.surfaceInfos.get(e);i&&(this.surfaceWearMap.set(t,i.id),i.isWeared=!0)}else this.surfaceWearMap.del(t)}},remove:function(e){var t=this.surfaceDatas;if(t&&!(t.length<1)){for(var a,i=-1,n=t.length,s=0;s<n;s++)if("number"!=typeof(a=t[s])&&a.id==e){i=s;break}if(-1!=i&&(this.surfaceDatas.splice(i,1),this.surfaceInfos)){var o=this.surfaceInfos.get(e);o.isWeared&&this.surfaceWearMap.set(o.type,0),o&&(o.isActive=!1,o.expireTime=0,o.isWeared=!1)}}},getCurWearType:function(e){return 0|this.surfaceWearMap.get(e)},getCurSelectByType:function(e){return 0|this.surfaceSelects.get(e)},getCurSelectInfoByType:function(e){var t=0|this.surfaceSelects.get(e);return this.surfaceInfos.get(t)},getTopId:function(){var e=this.surfaceTypesInfo.get(game.SurfaceTypes.NICKNMAE),t=0;if(!e||e.length<1)return t;for(var a,i=e.length,n=0;n<i;n++)t=(a=e[n]).id>t?a.id:t;return t},setSelected:function(e,t){if(this.surfaceInfos){var a=this.surfaceInfos.get(0|this.surfaceSelects.get(e));a&&(a.isSelect=!1);var i=this.surfaceInfos.get(t);i&&(i.isSelect=!0),this.surfaceSelects.set(e,t)}},selectfirstByType:function(e){var t=this.surfaceTypesInfo.get(e);if(t&&t.length)return t[0].id},getSortInfos:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=this.surfaceTypesInfo.get(e);return i&&i.sort(this._onSort),a&&i&&this.setSelected(e,i[0].id),i},getInfo:function(e){return this.surfaceInfos?this.surfaceInfos.get(e):null},_initInfos:function(){if(!this.surfaceInfos){this.surfaceInfos=b8e.HashMap.get();for(var e=void 0,t=void 0,a=void 0,i=void 0,n=0,s=this.surfaceTypes.length;n<s;n++){a=this.surfaceTypes[n],t=game.SuitSkinCfg.getTypeDatas(a),this.surfaceTypesInfo.has(a)||(i=[],this.surfaceTypesInfo.set(a,i));for(var o=0,r=t.length;o<r;o++)t[o].isShow&&(e=new game.SurfaceInfo(t[o]),i.push(e),this.surfaceInfos.set(e.id,e))}t=game.NicknameCfg.getDatas(),i=[],this.surfaceTypesInfo.set(game.SurfaceTypes.NICKNMAE,i);for(var g=0,l=t.length;g<l;g++)e=new game.SurfaceInfo(t[g]),i.push(e),this.surfaceInfos.set(e.id,e)}},checkIsCanActive:function(e){for(var t,a=!1,i=0,n=this.surfaceTypesInfo.get(e),s=void 0,o=0,r=n.length;o<r;o++)(s=n[o]).isActive||(t=s.getCfg())&&(i=game.itemData.getNumById(t.itemId),s.isCanActive=i>=t.itemNum&&!s.isActive,s.isCanActive&&(a=!0));return a&&n.sort(this._onSort),a},getTotalStatByType:function(e){this.surfaceSpriteStat.clear();for(var t=this.surfaceTypesInfo.get(e),a=void 0,i=0,n=t.length;i<n;i++)(a=t[i]).isActive&&this.surfaceSpriteStat.addSpriteStat(a.surfaceSpriteStat);return this.surfaceSpriteStat},getDefaultMountCfg:function(){var e=this.surfaceInfos.get(1602);return e?e.getCfg():null},selectTopId:function(e){var t=this.surfaceTypesInfo.get(e);if(t)for(var a=0,i=t.length;a<i;a++)t[a]},_onSort:function(e,t){if(e.isCanActive&&!t.isCanActive){return-1}if(!e.isCanActive&&t.isCanActive){return 1}if(e.isWeared&&!t.isWeared){return-1}if(!e.isWeared&&t.isWeared){return 1}if(e.isActive&&!t.isActive){return-1}if(e.isActive||!t.isActive)return e.id-t.id;return 1}}),game.surfaceData=game.surfaceData||new e,b8e.RC("$$game","$$SurfaceData",e)}(),function(){var e,t=e=b8e.Object.extends({id:0,isSelect:!1,isActive:!1,isWeared:!1,isCanActive:!1,isTimeLimit:!1,expireTime:0,type:0,ctor:function(e){this._super(),this.id=0,this.cfg=e,this.surfaceSpriteStat||(this.surfaceSpriteStat=game.SpriteStat.get(),this.surfaceSpriteStat.setupByCfg(e)),null!=e.types&&(this.type=e.types),this.setData(e)},setData:function(e){e&&(this.id=e.id,this.isTimeLimit=0<e.duration)},getCfg:function(){return this.cfg}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$SurfaceInfo",e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(428),this.setSize(146,84)},setData:function(){var e=this,t=e.data.getCfg();if(t)e.skin.selectImg.node.active=e.data.isSelect,e.skin.activeImg.node.active=e.data.isActive,e.skin.name.string=t.name,e.skin.illusionImg.node.active=e.data.isWeared,e.skin.red_alert.node.active=!e.data.isActive&&e.data.isCanActive,e.skin.time.node.active=e.data.isTimeLimit;else;},click:function(){this.send(game.SurfaceEvts.V2C_SELECTED,{id:this.data.id,type:this.data.type})}})).poolCall=!0,b8e.RC("$$game","$$SurfaceItem",e)}(),function(){var e;e=game.View.extends({_surfaceType:1,surfaceData:null,surfaceCfg:null,curSelectId:0,ctor:function(){this._super(990),this.spotAlerts={RECYCLE_SURFACE1_ALERT:this.recycleAlert}},recycleAlert:function(e){this.skin.recycle_alert.active=e.alert},init:function(){var e=this;e._gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._gridList.itemRender=game.SurfaceItem,e._gridList.bindEnum=game.ME.Surface,e._gridList.layout.spacingY=7,e._gridList.addToParent(e.skin.node_scrollview),e._model=b8e.SceneEntity.get(),e._model.addToParent(e.skin.node_model),e.surfaceData=game.surfaceData},creatRoleModel:function(){var e=this;e.roleData=game.BaseRoleData.get(game.RoleType.Hero,e._surfaceType),e.role=game.sceneRoleCreate.createUIRole(e.roleData),e.role.addToParent(e.skin.node_model),e.roleData.setMale(game.mainRoleData.isMale),e.roleData.heroModel.type=game.RoleType.Hero,e.roleData.heroModel.setAnims(game.mainRoleData.heroModel.copyAnim()),game.mainRoleData.heroModel.surfaces&&e.roleData.heroModel.setSurfaces(game.mainRoleData.heroModel.surfaces),e.roleData.heroModel.body=game.mainRoleData.heroModel.body,game.AvatarUtil.updateUIModel(e.role,1,!0),e.role.transition(game.RoleStateType.ACTION_IDLE)},setDefaultMount:function(){var e=this.surfaceData.getDefaultMountCfg();e&&this.roleData&&(this.roleData.heroModel.surfaceMount=e.model,this.roleData.heroModel.surfaceMountHead=e.mountHead,this.roleData.heroModel.uiMountOffsetY=e.mountOffsetY)},onShow:function(){this.surfaceData&&this.send(this.Evts.V2C_SELECTED,{type:this._surfaceType,id:this.surfaceData.selectfirstByType(this._surfaceType)}),this._gridList&&this._gridList.scrollToTop()},onHide:function(){if(this._model){var e=this._model.getAnimator(game.AnimType.BODY,1);e&&e.clear()}this.send(this.Evts.V2C_HIDE),this.clearTimer()},setAnim:function(e,t){var a=1<arguments.length&&void 0!==t?t:1;if(this._model){var i=this._model.getAnimator(game.AnimType.BODY,1);e?((i=i||this._model.addAnimator(game.AnimType.BODY,1)).load(e),i.setScale(a,a),i.play()):i&&i.clear()}},setAttr:function(){var e=this.getCurInfo();if(e){var t=game.SpriteStatType,a=e.surfaceSpriteStat,i=this.skin,n=e.getCfg();this.setStatStr(i.addStatLab1,t.TeamHp,a.getStatValue(t.TeamHp),n.clientTeamHp),this.setStatStr(i.addStatLab2,t.TeamAtk,a.getStatValue(t.TeamAtk),n.clientTeamAtk),this.setStatStr(i.addStatLab3,t.TeamDef,a.getStatValue(t.TeamDef),n.clientTeamDef)}},getCurInfo:function(){return this.surfaceData.getCurSelectInfoByType(this._surfaceType)},setStatStr:function(e,t,a,i){var n=game.AttrRulesCfg.getData(t),s=i?i/10+"%":a;e.string=game.Lang.get(51428,n.name,s)},setPower:function(){var e=this.getCurInfo();if(e){var t=this.skin;t.lab_power.string=e.surfaceSpriteStat.getTeamPower(),game.AutoLayoutUtil.layoutPower(t.view_power,t.lab_power,t.img_power0,t.btn_pre)}},setCost:function(){var e=this.getCurInfo();if(e){var t=e.getCfg(),a=this.skin;if(e.isActive&&e.isTimeLimit&&e.expireTime?(a.timeNode.active=!0,this.createTimer()):(a.timeNode.active=!1,this.clearTimer()),e.isActive)return a.panel_active.active=!1,void(a.view_btn_active.active=!1);var i=game.ItemInfoCfg.getData(t.itemId),n=game.itemData.getNumById(t.itemId);n>=t.itemNum?(a.view_btn_active.active=!0,a.view_lab_toget.active=!1):(a.view_btn_active.active=!1,a.view_lab_toget.active=!0),a.panel_active.active=!0,this._itemGrid||(this._itemGrid=game.GridUtil.createCostItemIcon(),this._itemGrid.addToParent(a.node_cost)),game.GridUtil.setItemIcon(this._itemGrid,t.itemId);var s=game.Lang.get(404,i.name,n,t.itemNum);a.lab_cost.string=game.HtmlUtil.getColorStrByQuality(i.quality,s),0<t.moduleEnum?a.view_lab_toget.string="<u>"+t.approach+"</u>":a.view_lab_toget.string=t.approach}},createTimer:function(){this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.updateTime,1e3)},updateTime:function(){var e=this.getCurInfo().expireTime;if(e){var t=e-game.SysTime.curTime;if(t<=0)this.clearTimer();else{var a=game.TimeUtil.formatTimeSpace(t,3);this.skin.timeLabNum.string=a}}else this.clearTimer()},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},setIllusion:function(){var e=this.getCurInfo();e&&(this.skin.view_btn_illusion.active=e.isActive&&!e.isWeared,this.skin.view_btn_cancel.active=e.isActive&&e.isWeared)},setItemList:function(e){e&&this._gridList&&this._gridList.setData(e)},onClickLeft:function(){this._gridList&&this._gridList.scrollContainerLeft()},onClickRight:function(){this._gridList&&this._gridList.scrollContainerRight()},listCb:function(e,t,a){this.skin.btn_left.active=0!=e.length,this.skin.btn_right.active=0!=a.length},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_DATA:case this.Evts.C2V_SELECTED:this.updateSurface()}},updateSurface:function(){var e=this;e.infoArr=e.surfaceData.getSortInfos(e._surfaceType),e.infoArr&&(e.setItemList(e.infoArr),e.updateTime(),e.setAttr(),e.setPower(),e.setCost(),e.setIllusion(),e.setModel())},setModel:function(){},view_btn_cancel:function(){this.send(this.Evts.V2C_CANCEL,this._surfaceType)},view_btn_illusion:function(){this.send(this.Evts.V2C_CHANGE,this._surfaceType)},view_power:function(){this.send(this.Evts.V2C_PRE_STAT,this._surfaceType)},view_btn_active:function(){this.send(this.Evts.V2C_ACTIVE,this._surfaceType)},view_lab_toget:function(){var e=this.getCurInfo();this.send(this.Evts.V2C_GOTO,e.getCfg().moduleEnum)},onStageResize:function(){this.setPosition(0,0)},$$getSurfaceItem:function(e){var t=void 0;if(!this._gridList||!this.infoArr||!this.infoArr.length)return null;for(var a=0,i=this.infoArr.length;a<i;a++)if(this.infoArr[a].id==e){t=this.infoArr[a];break}if(!t)return null;var n=this._gridList.getItemRender(t);return n?n.click:null}}),b8e.RC("$$game","$$SurfaceSkinView",e)}(),function(){var e;e=game.View.extends({_showModel:!0,_fosterModel:null,ctor:function(){this._super("surface/SurfaceSkinStat")},init:function(){this._model=b8e.SceneEntity.get(),this._model.addToParent(this.skin.modelNode),this.skin.modelNode.setScale(.5,.5),this.creatRoleModel()},creatRoleModel:function(){var e=this;e.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),e.role=game.sceneRoleCreate.createUIRole(e.roleData),e.role.addToParent(e.skin.modelNode),e.roleData.setMale(game.mainRoleData.isMale),e.roleData.heroModel.type=game.RoleType.Hero,e.roleData.heroModel.setAnims(game.mainRoleData.heroModel.copyAnim()),game.mainRoleData.heroModel.surfaces&&e.roleData.heroModel.setSurfaces(game.mainRoleData.heroModel.surfaces),e.roleData.heroModel.body=game.mainRoleData.heroModel.body,game.AvatarUtil.updateUIModel(e.role,1,!0),e.role.transition(game.RoleStateType.ACTION_IDLE)},updateView:function(){var e=this,t=game.SpriteStatType,a=game.surfaceData.statType,i=e.spriteStat,n=e.skin;if(e.setStatStr(n.addStatLab1,t.TeamHp,i.getStatValue(t.TeamHp)),e.setStatStr(n.addStatLab2,t.TeamAtk,i.getStatValue(t.TeamAtk)),e.setStatStr(n.addStatLab3,t.TeamDef,i.getStatValue(t.TeamDef)),n.fightAmountLbl.string=i.getPower(),game.AutoLayoutUtil.layoutPower(n.power,n.fightAmountLbl,n.powerImg),e.role.setVisible(a!=game.SurfaceTypes.NICKNMAE),e._model.setVisible(a==game.SurfaceTypes.NICKNMAE),a==game.SurfaceTypes.NICKNMAE){var s=e.getCurInfo();if(!s)return;var o=s.getCfg();if(!o)return;var r=game.AvatarUtil.getUIModel(o),g=game.ResCfg.getUrl(5004,r);e.setAnim(g,o.uiScale),e._model&&(e._model.y=o.offsetY)}else e.setModel()},setStatStr:function(e,t,a){var i=game.AttrRulesCfg.getData(t);e.string=game.Lang.get(51428,i.name,a)},getCurInfo:function(){return game.surfaceData.getCurSelectInfoByType(game.surfaceData.statType)},setModel:function(){var e=this,t=e.getCurInfo();if(t){var a=t.getCfg();if(a){var i=game.AvatarUtil;switch(e.roleData.heroModel.setAnims(game.mainRoleData.heroModel.copyAnim()),game.mainRoleData.heroModel.surfaces&&e.roleData.heroModel.setSurfaces(game.mainRoleData.heroModel.surfaces),t.type){case game.SurfaceTypes.FASHION:e.roleData.heroModel.surfaceFashion=game.mainRoleData.isMale?a.model:a.model1;break;case game.SurfaceTypes.MOUNT:e.roleData.heroModel.setAnim(game.AnimType.MOUNT_HEAD,0),e.roleData.heroModel.surfaceMount=a.model,e.roleData.heroModel.surfaceMountHead=a.mountHead,e.roleData.heroModel.uiMountOffsetY=a.UIMountOffsetY;break;case game.SurfaceTypes.WEAPON:e.roleData.heroModel.surfaceWeapon=a.model;break;case game.SurfaceTypes.WING:e.roleData.heroModel.surfaceWing=a.model}e.roleData.heroModel.getAnim(game.AnimType.MOUNT)||e.roleData.heroModel.surfaceMount||e.setDefaultMount(),i.updateUIModel(e.role,1,!0),e.role.transition(game.RoleStateType.ACTION_IDLE)}}},setDefaultMount:function(){var e=game.surfaceData.getDefaultMountCfg();e&&this.roleData&&(this.roleData.heroModel.surfaceMount=e.model,this.roleData.heroModel.surfaceMountHead=e.mountHead,this.roleData.heroModel.uiMountOffsetY=e.mountOffsetY)},onHide:function(){var e=this._model.getAnimator(game.AnimType.BODY,1);if(e){e.clear()}},onShow:function(){this.spriteStat=game.surfaceData.getTotalStatByType(game.surfaceData.statType),this.updateView()},setAnim:function(e,t){var a=1<arguments.length&&void 0!==t?t:1;if(this._model){var i=this._model.getAnimator(game.AnimType.BODY,1);e?((i=i||this._model.addAnimator(game.AnimType.BODY,1)).load(e),i.setScale(a,a),i.play()):i&&i.clear()}}}),b8e.module.registerView(game.ME.SurfaceStat,e),b8e.RC("$$game","$$SurfaceSpriteView",e)}(),function(){var e;e=game.View.extends({surfaceData:null,surfaceCfg:null,init:function(){this._lightEffect=new game.LightEffect,this._fosterModel||(this._fosterModel=b8e.SceneEntity.get(),this._fosterModel.addToParent(this.skin.model))},onShow:function(){var e=this;e.surfaceCfg&&e.surfaceData&&(e.closeTime=5,e.initPanel(),e.cfg=e.surfaceCfg.getData(e.surfaceData.curSelectId),e.cfg&&(e.setAnim(game.ResCfg.getUrl(5003,1001)),e.setPower(e.cfg.power+""),e.setName(e.cfg.name),e.setBtnLab(game.Lang.get(9549,e.closeTime)),e.closeTimer||(e.closeTimer=b8e.Timer.add(e,e.updateTime,1e3)),e.closeTimer.reset(),e.closeTimer.start(),e._lightEffect||(t._lightEffect=new game.LightEffect),e._lightEffect.parent||(e._lightEffect.addToParent(e.skin.effect),e._lightEffect.setVisible(!0))))},onHide:function(){this._super(),this.closeTimer&&this.closeTimer.stop(),this._lightEffect&&this._lightEffect.removeFromParent()},initPanel:function(){this.skin.text_bg.node.active=!0,this.skin.successBtn.node.y=-465},updateTime:function(){this.closeTime<1||(this.closeTime--,this.setBtnLab(game.Lang.get(9549,this.closeTime)))},setAnim:function(e){if(e){var t=this._fosterModel.getAnimator(game.AnimType.FOSTER,1);(t=t||this._fosterModel.addAnimator(game.AnimType.FOSTER,1)).load(e),t.play()}else t&&t.clear()},setPower:function(e){this.skin.power.string=e},setName:function(e){var t=e.length;2==t&&(e=e[0]+"\n\n"+e[1]),this.skin.nameBg.height=4<t?28*(t-4)+this.bgHeight:this.bgHeight,this.skin.name.string=e},setBtnLab:function(e){this.skin.successLab.string=e},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+170)}}),b8e.RC("$$game","$$SurfaceUpgradeView",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(991),this.toggles={toggle_btn_1:game.ME.NickNameSkin,toggle_btn_2:game.ME.FashionSkin,toggle_btn_3:game.ME.MountSkin,toggle_btn_4:game.ME.WeaponSkin,toggle_btn_5:game.ME.WingSkin},this.spotAlerts={NICKNAME_PAGE:this.nickNameAlert,FASHION_PAGE:this.fashionAlert,MOUNT_PAGE:this.mountAlert,WING_PAGE:this.wingAlert,WEAPON_PAGE:this.weaponAlert}},nickNameAlert:function(e){this.skin.red_spot_1.active=e.alert||game.spotAlert.get(game.SAE.RECYCLE_SURFACE1_ALERT).alert},fashionAlert:function(e){this.skin.red_spot_2.active=e.alert||game.spotAlert.get(game.SAE.RECYCLE_SURFACE1_ALERT).alert},mountAlert:function(e){this.skin.red_spot_3.active=e.alert||game.spotAlert.get(game.SAE.RECYCLE_SURFACE1_ALERT).alert},weaponAlert:function(e){this.skin.red_spot_4.active=e.alert||game.spotAlert.get(game.SAE.RECYCLE_SURFACE1_ALERT).alert},wingAlert:function(e){this.skin.red_spot_5.active=e.alert||game.spotAlert.get(game.SAE.RECYCLE_SURFACE1_ALERT).alert},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},updateAlert:function(e){this.skin.red_spot_1.active=e.alert||game.spotAlert.get(game.SAE.NICKNAME_PAGE).alert,this.skin.red_spot_2.active=e.alert||game.spotAlert.get(game.SAE.FASHION_PAGE).alert,this.skin.red_spot_3.active=e.alert||game.spotAlert.get(game.SAE.MOUNT_PAGE).alert,this.skin.red_spot_4.active=e.alert||game.spotAlert.get(game.SAE.WEAPON_PAGE).alert,this.skin.red_spot_5.active=e.alert||game.spotAlert.get(game.SAE.WING_PAGE).alert},onShow:function(){game.spotAlert.setCb(game.SAE.RECYCLE_SURFACE1_ALERT,this.updateAlert,this)},onHide:function(){game.spotAlert.delCb(game.SAE.RECYCLE_SURFACE1_ALERT,this.updateAlert,this)}});b8e.module.registerView(game.ME.Surface,e)}(),function(){var e;e=b8e.Enum({None:0,V_SHOW_VIEW:-1,V_SWITCH_PAGE:-1,V_GET_PRIZE:-1,V_UPDATE_MONEY:-1,C_GET_PRIZE:-1}),b8e.RC("$$game","$$FirstRechargeEvts",e)}(),function(){var e=game.Control.extends({selectId:0,firstRechargeAlert:null,init:function(){game.firstRechargeData.initPageList(),this.ids=game.FirstRechargeCfg.getKeys(),this.firstRechargeAlert=game.spotAlert.set(game.SAE.FIRST_RECHARGE_ALERT,game.SAE.FIRST_RECHARGE_MAIN_ALERT)},ipc:function(){this.evts={Recharge:{C_RECHARGE_SUCCESS:this.rechargeSuccess,C_INIT_MODEL:this.checkAlert}},this.handels={FirstRechargeResp:this.firstRechargeResp}},notify:function(e,t){var a=this;game.firstRechargeData;switch(e){case a.Evts.V_SWITCH_PAGE:this.selectId=t,a.send(a.Evts.V_SWITCH_PAGE,t);break;case a.Evts.V_SHOW_VIEW:a.showView();var i=a.ids.indexOf(a.selectId);a.send(a.Evts.V_SWITCH_PAGE,this.selectId,i)}},firstRechargeResp:function(e){var t=e.readProtobuf(game.pb.FirstRechargeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.rechargeData.firstRechargeResponese(t.id),this.checkAlert();var a=this.ids.indexOf(this.selectId);this.send(this.Evts.V_GET_PRIZE,t.id,this.selectId,a),this.dpt(this.Evts.C_GET_PRIZE),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)}},showView:function(){if(!this.ids||this.ids.length<1);else{this.ids.length,game.rechargeData.rechargeMoney;this.checkList()}},checkList:function(){if(this.ids&&!(this.ids.length<1)){for(var e,t=this.ids.length,a=game.rechargeData,i=a.rechargeMoney,n=0;n<t;n++){if(e=this.ids[n],game.FirstRechargeCfg.getData(e).money>i){return this.selectId=e,!1}if(!a.getFirstRecharge(e)){return this.selectId=e,!0}}return!1}},rechargeSuccess:function(){this.checkAlert(),this.send(this.Evts.V_UPDATE_MONEY,this.selectId)},checkAlert:function(){var e=!1;if(0<game.rechargeData.rechargeMoney){e=this.checkList()}this.firstRechargeAlert.alert=e},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},getPrizeBtn:function(){this.sender.FirstRechargeReq(this.selectId)}}),t=game.Sender.extends({ipc:function(){this.msg={FirstRechargeReq:this.firstRechargeReq}},firstRechargeReq:function(e){var t=game.pb.FirstRechargeRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.FirstRecharge,e,game.FirstRechargeEvts,t)}(),function(){var e=b8e.Object.extends({initPageList:function(){this.pageList=[];var e=game.FirstRechargeCfg.getDatas();if(!e||e.length<1);else for(var t,a,i=e.length,n=0;n<i;n++){t=e[n],(a=new game.FirstRechargeInfo).setData(t.id),this.pageList.push(a)}},getPageList:function(){return this.pageList}});game.firstRechargeData=game.firstRechargeData||new e}(),function(){var e;e=b8e.Object.extends({id:null,isSelect:!1,setData:function(e){this.id=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$FirstRechargeInfo",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(407),this.setSize(145,82)},setData:function(){var e=this.skin,t=this.data,a=game.FirstRechargeCfg.getData(t.id);if(a)e.name.string=a.name,e.selectImg.node.active=t.isSelect;else;},click:function(){this.send(game.FirstRechargeEvts.V_SWITCH_PAGE,this.data.id)}}),b8e.RC("$$game","$$FirstRechargeItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(408),this.prizeInfoList=[]},init:function(){var e=this,t=e.skin;(e.banner=b8e.Sprite.get()).addToParent(t.banner),(e.anim=b8e.Animator.get(game.AnimType.UI_EFFECT,1)).addToParent(e.skin.model);var a=e.pageItemList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.FirstRechargeItem,a.addToParent(t.pageList),a.layout.spacingX=5,a.bindEnum=game.ME.FirstRecharge,e.pageList=game.firstRechargeData.getPageList(),a.setData(e.pageList),a.setScrollViewCb(e.listCb,e);var i=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);i.itemRender=game.PrizeListItem,i.addToParent(t.prizeList),e.anima1=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima1.addToParent(e.skin.anim),e.anima1.load(game.ResCfg.getUrl(5019,1061))},notify:function(e,t,a,i){var n=this;switch(e){case this.Evts.V_SWITCH_PAGE:isNaN(a)||n.scrollToPage(a),this.switchPageData(t),this.setSelectId(t);break;case this.Evts.V_GET_PRIZE:if(isNaN(i)||n.scrollToPage(i),this.getPrize(t),t!=a){this.switchPageData(a),this.setSelectId(a)}break;case this.Evts.V_UPDATE_MONEY:this.updateMoney(),this.setBtns(n.selectId)}},scrollToPage:function(e){if(--e&&0!=e){this.pageItemList.scrollToRight(136*e/2,50)}else this.pageItemList.scrollToLeft(0)},setSelectId:function(e){if(!this.pageList||this.pageList.length<1);else for(var t,a=this.pageList.length,i=0;i<a;i++){(t=this.pageList[i]).isSelect=t.id==e}},onShow:function(){this.send(this.Evts.V_SHOW_VIEW),this.updateMoney(),this.anima1.play()},onHide:function(){},updateMoney:function(){this.skin.rechargeMoney.string=game.Lang.get(1706,game.rechargeData.rechargeMoney)},switchPageData:function(e){var t=this;t.skin;t.selectId=e;var a=game.FirstRechargeCfg.getData(e);if(a){if(a.banner){var i=game.ResCfg.getUrl(99,a.banner);t.banner.loadTexture(i)}else t.banner.unloadTexture();if(this.setAnim(a),a.award&&0<a.award.length)for(var n,s=a.award.length,o=0;o<s;o++){if(n=a.award[o],t.prizeInfoList[o])t.prizeInfoList[o].setData(n.Id,n.Num);else{var r=new game.PrizeInfo;r.setData(n.Id,n.Num,2),t.prizeInfoList[o]=r}}t.prizeList.setData(t.prizeInfoList),this.setBtns(e)}else;},getPrize:function(e){if(this.selectId==e)this.setBtns(e);else;},setBtns:function(e){var t=this.skin,a=game.FirstRechargeCfg.getData(e);if(a){var i=game.rechargeData;if(i.getFirstRecharge(e)){t.isGetImg.node.active=!0,t.rechargeBtn.node.active=!1,t.getPrizeBtn.node.active=!1}else{t.isGetImg.node.active=!1;var n=a.money<=i.rechargeMoney;t.rechargeBtn.node.active=!n,t.getPrizeBtn.node.active=n}}else;},setAnim:function(e){var t=this.anim;if(t)if(e.animUrlKey&&e.anim){t.load(game.ResCfg.getUrl(e.animUrlKey,e.anim)),t.play(null,0);var a=e.scale?e.scale:1;t.setScale(a,a),this.skin.model.y=e.offsetY}else t.clear()},listCb:function(e,t,a){var i=!1;i=0<e.length,this.skin.view_leftBtn.active=i,i=0<a.length,this.skin.view_rightBtn.active=i},view_leftBtn:function(){this.pageItemList.scrollContainerLeft()},view_rightBtn:function(){this.pageItemList.scrollContainerRight()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.FirstRecharge,e)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_CHANGE:-1,V_CHANGE_ACTIVE:-1}),b8e.RC("$$game","$$FirstRechargeMainEvts",e)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={}},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},btn_3:function(){this.selectToggle(2)},changeActive:function(){this.send(this.Evts.V_CHANGE_ACTIVE)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.FirstRechargeMain,e,game.FirstRechargeMainEvts)}(),function(){var e=game.View.extends({ctor:function(){this._super(409),this.toggles={toggle_btn_1:game.ME.FirstRecharge,toggle_btn_3:game.ME.Investment},this.spotAlerts={FIRST_RECHARGE_ALERT:this.firstRechargeAlert,FUND_ALERT:this.fundAlert,INVEST_ALERT:this.investAlert}},firstRechargeAlert:function(e){this.skin.red_spot_1.node.active=e.alert},fundAlert:function(e){this.skin.red_spot_2.node.active=e.alert},investAlert:function(e){this.skin.red_spot_3.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t);break;case this.Evts.V_CHANGE_ACTIVE:this.changeActive(t)}},onShow:function(){},changeActive:function(){var e,t=0,a=this.skin;game.rechargeData.getFirstRechargeIsShow()?(e=132*t+84,t++,a.btn_1.active=!0,a.btn_1.x=e):a.btn_1.active=!1,game.welfareData.getFundIsShow()?(e=132*t+84,t++,a.btn_2.x=e,a.btn_2.active=!0):a.btn_2.active=!1,game.investData.getInvestOpen()?(e=132*t+84,t++,a.btn_3.x=e,a.btn_3.active=!0):a.btn_3.active=!1},onHide:function(){},toggleSelect:function(e){var t=this,a=t.skin;if(t._super(e))switch(e){case 0:a.title.string=game.Lang.get(9126);break;case 1:a.title.string=game.Lang.get(9127)}else;},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.FirstRechargeMain,e)}(),function(){var e;e=b8e.Enum({None:0,V_BUY_FUND:-1,V_GET_FUND_AWARD_SUCCESS:-1,V_GET_FUND_AWARD:-1,V_GET_FULL_AWARD:-1,C_BUY_FUND:-1,C_GET_FUND_AWARD_SUCCESS:-1,V_REFRESH_LV:-1,C_GET_ALL_PEOPLE:-1,V_GET_ALL_PEOPLE:-1,V_SELECT_CHANGE:-1,V_CHANGE_OPEN_FUND:-1,V_UPDATE_VIEW:-1,C_CHECK_ALERT:-1,C2C_RECHARGE:-1,V2C_ON_HIDE:-1,C2C_CLOSR_ACT:-1}),b8e.RC("$$game","$$FundEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.FUND_ALERT,game.SAE.OPEN_SERVER_ALERT),this._alertOptions={lang:704,btn:game.Lang.get(9059),okcb:this.onClickGameAlert,thisArg:this,align:1}},ipc:function(){this.evts={OpenServer:{C2C_INIT_OPENSERVER:this.syncData},MainRole:{C_LEVEL_UP:this.refreshLv},FundAll:{C_GET_ALL_PEOPLE:this.AllPeopleFundFundReq},Recharge:{C_RECHARGE_SUCCESS:this.rechargeSuccess}},this.handels={ReceiptGrowthFundResp:this.receiptGrowthFundResp,ReceiptFullFundResp:this.receiptFullFundResp,AllPeopleFundFundResp:this.allPeopleFundFundResp}},triggerOpen:function(e){e==this.moduleEnum&&this.checkOpen()},syncData:function(e){e&&e.data&&(game.fundData.setData(e.data),this.checkOpen(),this.AllPeopleFundFundReq())},checkOpen:function(){var e=game.fundData,t=(!e.isMax||!e.isFullAllGet())&&game.moduleOpen.checkOpen(this.moduleEnum),a={openServerType:game.OpenServerType.FUND,isActive:t,sae:game.SAE.FUND_ALERT};this.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER,a),t||this.dptG(game.ActiveBarGEvts.REFRESH_BTNS)},notify:function(e,t){switch(e){case this.Evts.V_GET_FUND_AWARD:this.ReceiptGrowthFundReq(t);break;case this.Evts.V_GET_FULL_AWARD:this.ReceiptFullFundReq(t);break;case this.Evts.C_GET_ALL_PEOPLE:this.AllPeopleFundFundReq();break;case this.Evts.V2C_ON_HIDE:this.dpt(this.Evts.C2C_CLOSR_ACT)}},btn_1:function(){this.send(this.Evts.V_SELECT_CHANGE,0)},btn_2:function(){this.send(this.Evts.V_SELECT_CHANGE,1)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)},refreshLv:function(){game.fundData.checkFundState(),this.checkOpen(),this.checkAlert(),this.send(this.Evts.V_REFRESH_LV)},ReceiptGrowthFundReq:function(e){if(game.fundData.openCfg){var t=game.fundData.openCfg.id;this.sender.ReceiptGrowthFundReq(t,e)}},ReceiptFullFundReq:function(e){this.sender.ReceiptFullFundReq(e)},AllPeopleFundFundReq:function(){this.sender.AllPeopleFundFundReq()},rechargeSuccess:function(e){if(e&&e.data&&e.data.id==this.rechargeId){var t=game.fundData;t.purchasedId=t.openCfg.id,t.awards?t.awards.length=0:t.awards=[],t.checkFundState(),t.people+=1,t.setAllInfos(t.fullAwards),this.send(this.Evts.V_UPDATE_VIEW),this.dpt(this.Evts.V_UPDATE_VIEW),this.checkAlert()}},receiptGrowthFundResp:function(e){var t=e.readProtobuf(game.pb.ReceiptGrowthFundResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.fundData,i=game.fundData.openCfg;t.id==i.id&&(a.setFundState(t.lv),(i=game.fundData.openCfg)&&!game.fundData.isMax?t.id!=i.id&&this.send(this.Evts.V_UPDATE_VIEW):this.checkOpen(),this.checkAlert(),this.dpt(this.Evts.V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))}},receiptFullFundResp:function(e){var t=e.readProtobuf(game.pb.ReceiptFullFundResponse);0<t.code?game.notice.noticeError(t.code):(game.fundData.setAllState(t.people),this.checkAlert(),this.send(this.Evts.V_UPDATE_VIEW),this.dpt(this.Evts.V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},allPeopleFundFundResp:function(e){var t=e.readProtobuf(game.pb.AllPeopleFundResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.fundData;a.people=t.allPeople,a.setAllInfos(a.fullAwards),this.checkAlert(),this.send(this.Evts.V_GET_ALL_PEOPLE)}},buyFundBtn:function(){if(!game.fundData.isPurchased()){var e=game.FundRechargeCfg.getData(game.fundData.openCfg.id);e&&(this.rechargeId=e.rechargeId,this.dpt(this.Evts.C2C_RECHARGE,this.rechargeId))}},onClickGameAlert:function(){this.sender.BuyFundReq(game.fundData.openCfg.id)},checkAlert:function(){this.dpt(this.Evts.C_CHECK_ALERT)}}),t=game.Sender.extends({ipc:function(){this.msg={BuyFundReq:this.buyFundReq,ReceiptGrowthFundReq:this.receiptGrowthFundReq,ReceiptFullFundReq:this.receiptFullFundReq,AllPeopleFundFundReq:null}},buyFundReq:function(e){var t=game.pb.BuyFundRequest;t.id=e,this.write(t)},receiptGrowthFundReq:function(e,t){var a=game.pb.ReceiptGrowthFundRequest;a.id=e,a.lv=t,this.write(a)},receiptFullFundReq:function(e){var t=game.pb.ReceiptFullFundRequest;t.people=e,this.write(t)}});b8e.module.registerControl(game.ME.FundMain,e,game.FundEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.FULL_AWARD,game.SAE.FUND_ALERT)},ipc:function(){this.evts={FundMain:{C_CHECK_ALERT:this.checkAlert,V_UPDATE_VIEW:this.updateView}}},checkAlert:function(){this.spotAlert.alert=0<game.fundData.allCanGetCount},updateView:function(){this.send(this.Evts.V_UPDATE_VIEW)},notify:function(e){switch(e){case this.Evts.C_GET_ALL_PEOPLE:this.dpt(this.Evts.C_GET_ALL_PEOPLE)}}});b8e.module.registerControl(game.ME.FundAll,e,game.FundEvts)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.FUND_AWARD,game.SAE.FUND_ALERT)},ipc:function(){this.evts={FundMain:{V_UPDATE_VIEW:this.updateView,C_CHECK_ALERT:this.checkAlert}}},checkAlert:function(){this.spotAlert.alert=0<game.fundData.fundCanGetCount},updateView:function(){this.send(this.Evts.V_UPDATE_VIEW)}});b8e.module.registerControl(game.ME.FundMine,e,game.FundEvts)}(),function(){var e=b8e.Object.extends({people:0,purchasedId:0,awards:null,index:0,isMax:!1,fundCanGetCount:0,allCanGetCount:0,setData:function(e){var t=this,a=e.fundAwards,i=game.FundOpenCfg.getDatas();if(i&&!(i.length<1)){t.purchasedId=0;var n=a.length;t.index=0<n?n-1:0;var s=i[t.index],o=void 0,r=void 0;(t.openCfg=s)&&(0<n?(a.sort(function(e,t){return e.id-t.id}),(o=a[n-1])&&(t.purchasedId=s.id,r=game.GrowthFundCfg.getData(s.group,!0),o.awards.length==r.length?(t.index+=1,s=i[t.index],(t.openCfg=s)?t.setFundInfos(null):(t.isMax=!0,t.openCfg=i[t.index-1],t.setFundInfos(o.awards),t.fundCanGetCount=0)):t.setFundInfos(o.awards))):t.setFundInfos(null)),t.setAllInfos(e.fullAwards)}},setFundInfos:function(e){var t=this,a=t.fundInfos;a=a||(t.fundInfos=[]);var i=t.openCfg;if(i){var n=game.GrowthFundCfg.getData(i.group,!0);if(n&&!(n.length<1)){t.awards=e,t.fundCanGetCount=0;var s=t.fundInfoMap;(s=s||(t.fundInfoMap=b8e.HashMap.get())).clear();var o=n.length;o<a.length&&(t.fundInfos=a.splice(0,o),a=t.fundInfos);for(var r=void 0,g=void 0,l=!1,c=!1,h=0;h<o;h++)g=n[h],(r=a[h])||(r=new game.FundInfo,a.push(r)),c=e?(l=-1<e.indexOf(g.lv),game.mainRoleData.lv>=g.lv):l=!1,r.setData(g,l,c),s.set(g.lv,r),!l&&c&&t.fundCanGetCount++}}},checkFundState:function(){this.isPurchased()&&this.setFundInfos(this.awards)},setFundState:function(e){var t=this;if(t.isPurchased()){var a=t.fundInfoMap;if(a){var i=a.get(e);if(i){i.isGet=!0,t.fundCanGetCount--,t.awards.push(e);var n=t.openCfg;if(n){var s=game.GrowthFundCfg.getData(n.group,!0);if(t.awards&&t.awards.length==s.length){var o=game.FundOpenCfg.getDatas();t.index+=1,(n=t.openCfg=o[t.index])?t.setFundInfos(null):(t.isMax=!0,t.openCfg=o[t.index-1],t.fundCanGetCount=0)}}}}}},setAllInfos:function(e){var t=this.allInfos;t=t||(this.allInfos=[]),this.fullAwards=e,this.allCanGetCount=0;var a=this.allInfoMap;a||(this.allInfoMap=a=b8e.HashMap.get()),a.clear();for(var i=void 0,n=!1,s=!1,o=void 0,r=game.FullFundCfg.getDatas(),g=0,l=r.length;g<l;g++)o=r[g],(i=t[g])||(i=new game.FundInfo,t.push(i)),n=-1<e.indexOf(o.people),s=this.people>=o.people,i.setData(o,n,s),a.set(o.people,i),!n&&s&&this.allCanGetCount++},setAllState:function(e){var t=this.allInfoMap;if(t){var a=t.get(e);a&&(a.isGet=!0,this.allCanGetCount--,this.fullAwards.push(e))}},isPurchased:function(){return this.openCfg&&this.openCfg.id==this.purchasedId},canPurchased:function(){var e=this.openCfg;return!!e&&(!this.isMax&&(!this.isPurchased()&&(!(e.vipLv<game.mainRoleData.vipLevel)&&!!game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,this.getCost(),!1))))},getCost:function(){return this.openCfg?this.openCfg.cost:0},isFullAllGet:function(){if(!this.fullAwards)return!1;var e=game.FullFundCfg.getDatas();return this.fullAwards.length==e.length}});game.fundData=game.fundData||new e}(),function(){var e;e=b8e.Object.extends({cfg:null,isGet:!1,isCanGet:!1,setData:function(e,t,a){this.isGet=t,this.isCanGet=a,this.cfg=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$FundInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(e){this._super(442),this.setSize(602,180),this.type=e},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.layout.paddingLeft=5,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingX=25,e.layout.spacingY=0,e.addToParent(this.skin.list),e.touchMovable=!1},setData:function(){var e=this.data,t=e.cfg,a=this.skin;a.desc.string=game.Lang.get(1710,t.lv),a.cantGetImg.node.active=!1,a.isGetImg.node.active=!1,a.getPrizeBtn.node.active=!1,e.isCanGet?e.isGet?a.isGetImg.node.active=!0:a.getPrizeBtn.node.active=!0:a.cantGetImg.node.active=!0,this.items?(this.items[0].Id=21,this.items[0].Num=t.awards):this.items=[{Id:21,Num:t.awards}];var i=game.CfgUtil.getPrizeListInfo(this.items);i&&this.prizeList.setData(i.items)},getPrizeBtn:function(){this.send(game.FundEvts.V_GET_FUND_AWARD,this.data.cfg.lv)}}),b8e.RC("$$game","$$FundItem",e)}(),function(){var e;e=game.FundItem.extends({setData:function(){this._super(),this.skin.desc.string=game.Lang.get(51842,this.data.cfg.people)},getPrizeBtn:function(){this.send(game.FundEvts.V_GET_FULL_AWARD,this.data.cfg.people)}}),b8e.RC("$$game","$$FundAllItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super("fund/FundMainView"),this.toggles={toggle_btn_1:game.ME.FundMine,toggle_btn_2:game.ME.FundAll},this.spotAlerts={FUND_AWARD:this.fundAlert,FULL_AWARD:this.fullAlert}},fundAlert:function(e){this.skin.red_spot_1.node.active=e.alert},fullAlert:function(e){this.skin.red_spot_2.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.V_UPDATE_VIEW:this.updateView();break;case this.Evts.V_GET_ALL_PEOPLE:this.updatePeople();break;case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t)}},onShow:function(){this.updateView(),this.send(this.Evts.C_GET_ALL_PEOPLE)},updateView:function(){var e=this.skin,t=game.fundData,a=(t.openCfg,t.isPurchased());e.grayFundBtn.active=a,e.buyFundBtn.active=!a;var i=0,n=game.FundRechargeCfg.getData(t.openCfg.id);if(n){var s=game.RechargeCfg.getDataById(n.rechargeId);s&&(i=s.money)}e.buyFundLab.string=game.Lang.get(1701,i),this.updatePeople()},updatePeople:function(){this.skin.countLab.string=game.Lang.get(51750,game.fundData.people)},onStageResize:function(){this.setPosition(0,0)},onHide:function(){this.send(this.Evts.V2C_ON_HIDE)}});b8e.module.registerView(game.ME.FundMain,e)}(),function(){var e=game.View.extends({ctor:function(){this._super("fund/FundView")},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.FundItem,e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingX=0,e.bindEnum=game.ME.FundMain,e.addToParent(this.skin.list)},notify:function(e){switch(e){case this.Evts.V_UPDATE_VIEW:this.updateView()}},onShow:function(){this.updateView()},updateView:function(){var e=game.fundData.fundInfos;e.sort(this._sort),this.list.setData(e)},_sort:function(e,t){return e.isGet&&!t.isGet?1:!e.isGet&&t.isGet?-1:e.isCanGet&&!t.isCanGet?-1:!e.isCanGet&&t.isCanGet?1:e.cfg.id-t.cfg.id},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.FundMine,e)}(),function(){var e=game.View.extends({ctor:function(){this._super("fund/FundView")},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.FundAllItem,e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingX=0,e.bindEnum=game.ME.FundMain,e.addToParent(this.skin.list)},notify:function(e){switch(e){case this.Evts.V_UPDATE_VIEW:this.updateView()}},onShow:function(){this.updateView()},updateView:function(){var e=game.fundData.allInfos;e.sort(this._sort),this.list.setData(e)},_sort:function(e,t){return e.isGet&&!t.isGet?1:!e.isGet&&t.isGet?-1:e.isCanGet&&!t.isCanGet?-1:!e.isCanGet&&t.isCanGet?1:e.cfg.people-t.cfg.people},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.FundAll,e)}(),function(){var e;e=b8e.Enum({ClickClientGM:1,ClickServerGM:2,ChangeIndex:3}),b8e.RC("$$game","$$GMEvts",e)}(),function(){var e;e=b8e.Enum({GM_UPDATE:b8e.enc()}),b8e.RC("$$game","$$GMGEvts",e)}(),function(){var e=game.Control.extends({init:function(){var e=game.ClientGMCfg.getDatas();game.gmData.initClientGm(e),e=game.ServerGMCfg.getDatas(),game.gmData.initServerGm(e)},ipc:function(){this.gevts={GMGEvts:{GM_UPDATE:this.gmUpdate}},this.handels={ExecGmCmdResp:this.execGmCmd}},notify:function(e,t){switch(e){case this.Evts.ClickClientGM:this.clickClientGM(t);break;case this.Evts.ClickServerGM:this.clickServerGm(t)}},clickClientGM:function(e){switch(e.cmd){case"playback":game.playBack.stop();break;case"showAnim":game.playBack.posDemo();break;case"removeAnim":game.playBack.stop()}},clickServerGm:function(e){switch(e.cmd){case"playBackSpeed":game.playBack.speedRatio=Number(e.args);break;default:this.sender.ExecGmCmdReq(e)}},gmUpdate:function(e){if(e&&e.data)this.sender.ExecGmCmdReq(e.data);else;},clientGM:function(){this.send(this.Evts.ChangeIndex,0)},serverGM:function(){this.send(this.Evts.ChangeIndex,1)},execGmCmd:function(e){var t=e.readProtobuf(game.pb.CreateRoleResponse);if(0<t.code){game.notice.noticeError(t.code)}else;}}),t=game.Sender.extends({ipc:function(){this.msg={ExecGmCmdReq:this.sendGm}},sendGm:function(e){var t=game.pb.ExecGmCmdRequest;t.cmd=e.cmd+" "+e.args,this.write(t)}});b8e.module.registerControl(game.ME.GM,e,game.GMEvts,t)}(),function(){var e=b8e.Object.extends({clientGm:null,serverGm:null,ctor:function(){this._super(),this.clientGm=[],this.serverGm=[]},initClientGm:function(e){this._setData(e,this.clientGm)},initServerGm:function(e){this._setData(e,this.serverGm)},_setData:function(e,t){if(e&&0!=e.length)for(var a,i=0;i<e.length;i++){(a=new game.GMItemData).setData(e[i]),t.push(a)}else;}});game.gmData=game.gmData||new e}(),function(){var e;e=b8e.Object.extends({id:0,name:null,args:null,setData:function(e){this.id=e.id,this.name=e.name,this.args=e.args,this.cmd=e.cmd}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GMItemData",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(454),this.setSize(180,60)},setData:function(){this.skin.gmLbl.string=this.data.name},gmBtn:function(){this.send(game.GMEvts.ClickClientGM,this.data)}}),b8e.RC("$$game","$$GMClientItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(455),this.setSize(580,60)},setData:function(){this.skin.gmName.string=this.data.name,this.skin.args.string=this.data.args},sendBtn:function(){this.data.args=this.skin.args.string,this.send(game.GMEvts.ClickServerGM,this.data)}}),b8e.RC("$$game","$$GMServerItem",e)}(),function(){var e=game.View.extends({_showModel:!0,clientList:null,serverList:null,ctor:function(){this._super(456)},init:function(){var e=this;e.clientList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.clientList.itemRender=game.GMClientItem,e.clientList.bindEnum=game.ME.GM,e.clientList.addToParent(e.skin.clientList),e.serverList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.serverList.itemRender=game.GMServerItem,e.serverList.bindEnum=game.ME.GM,e.serverList.addToParent(e.skin.serverList),e.skin.serverList.active=!1},onShow:function(){this.skin.clientList.active=!0,this.skin.serverList.active=!1,this.clientList.setData(game.gmData.clientGm)},notify:function(e,t){switch(e){case this.Evts.ChangeIndex:if(0==t){this.skin.clientList.active=!0,this.skin.serverList.active=!1,this.clientList.setData(game.gmData.clientGm)}else this.skin.clientList.active=!1,this.skin.serverList.active=!0,this.serverList.setData(game.gmData.serverGm)}}});b8e.module.registerView(game.ME.GM,e)}(),function(){var e;e=b8e.Enum({NONE:0,V_SELECT_CHANGE:-1}),b8e.RC("$$game","$$GodEquipEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){game.spotAlert.set(game.SAE.GODEQUIP,game.SAE.ROLE_EQUIP)},btn_1:function(){this.send(this.Evts.V_SELECT_CHANGE,0)},btn_2:function(){this.send(this.Evts.V_SELECT_CHANGE,1)},btn_3:function(){this.send(this.Evts.V_SELECT_CHANGE,2)},btn_4:function(){this.send(this.Evts.V_SELECT_CHANGE,3)},btn_5:function(){this.send(this.Evts.V_SELECT_CHANGE,4)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.GodEquip,e,game.GodEquipEvts,null)}(),function(){var e;e=b8e.Object.extends({type:0,value1:0,value2:0,setup:function(e,t,a){this.type=e,this.value1=t,this.value2=a}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GodEquipAttrInfo",e)}(),function(){var e;e=game.CultivateBaseView.extends({init:function(){var e=this;e._highList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._highList.addToParent(e.skin.attr_scrollview),e._equipIcons=[],e._highAttrInfos=b8e.HashMap.get(),e._attrPool=[];var t=b8e.Sprite.get();t.setAnchor(.5,.5);var a=game.ResCfg.getImgUrl("turnplate/icon/godEquip");t.loadTexture(a),t.addToParent(e.skin.btn_goto_turnplate),t.setSize(86,86)},onShow:function(){this.index=0,this.setDefault(),this.setEquipSlot()},setDefault:function(){var e=game.equipSlotData.getEquipSlot();if(!e||e.count()<=0);else{if(game.godEquipData.curSlotIndex){this.selectedSlotInfo=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex)}if(!this.selectedSlotInfo)for(var t,a,i=e.values(),n=0,s=i.length;n<s;n++){if((t=i[n])&&0<t.id){if((a=game.ItemInfoCfg.getData(t.id))&&a.quality==game.Quality.Q_RED){this.selectedSlotInfo=t;break}}}if(this.selectedSlotInfo){this.send(this.Evts.V2C_SELECTED,this.selectedSlotInfo.pos)}}},createEquipAttrInfo:function(a,e,t){if(a&&e&&t){var i=this._types;i?i.length=0:i=this._types=[];var n,s=e.getSpriteStats(),o=t.getSpriteStats(),r=0;s&&o&&s.forEach(function(e,t){i.push(e),r=o.get(e),(n=a.get(e))||(n=new game.GodEquipAttrInfo,a.set(e,n)),n.setup(e,t,r)},this);var g=this._delList;g?g.length=0:g=this._delList=[],a.forEach(function(e,t){-1==i.indexOf(e)&&g.push(e)},this);for(var l=0,c=g.length;l<c;l++)a.del(g[l])}},createAttrShow:function(e,t){!e||!t||t.length<1||e.setData(t)},setEquipSlot:function(){var e=game.equipSlotData.getEquipSlot();if(e&&0<e.count()){e.forEach(this.setSlot,this)}},setSlot:function(e,t){if(t){this.slotInfo=t;var a=0|e,i=this._equipIcons[a],n=game.ItemInfoCfg.getData(t.id);if(n)if(n.quality==game.Quality.Q_RED){if(!i){(i=game.GridUtil.createGodEquipSlotIcon(game.IconSizeEnum.GRID_SIZE_105)).setClickCb(this.clickGrid,this),i.addToParent(this.getComponent("equip_"+e)),this._equipIcons[a]=i}game.GridUtil.setGodEquipIcon(i,t)}else i&&game.GridUtil.setGodEquipIcon(i,null,!0)}else;},setSelectImg:function(e){this.skin.selectImg.active=!1,this.skin.selectImg.parent&&this.skin.selectImg.removeFromParent();var t=this.getComponent("equip_"+e);t&&(this.skin.selectImg.active=!0,this.skin.selectImg.addToParent(t))},clickGrid:function(){var e=this;e.slotInfo&&(e.selectedSlotInfo&&e.selectedSlotInfo.pos==e.slotInfo.pos||(e.send(e.Evts.V2C_SELECTED,e.slotInfo.pos),e.selectedSlotInfo=e.slotInfo,e.createSelected()))},playEffect:function(e){var t=0|e,a=this.getComponent("equip_"+t);if(a)this._playEffect(a);else;},_playEffect:function(e){var t=this,a=game.ResCfg.getUrl(5019,1008);if(a&&e){if(!t._effect){t._effect=b8e.Animator.get(game.AnimType.UI_EFFECT,1)}if(t._effect.parent&&t._effect.parent!==e){t._effect.removeFromParent()}t._effect.addToParent(e),t._effect.load(a),t._effect.addFinishCallback(t._clearEffect,t),t._effect.play(null,0)}else t._clearEffect()},_clearEffect:function(){var e=this._effect;if(e)e.clear();else;},onHide:function(){this._clearEffect()},createSelected:function(){},onStageResize:function(){this.setPosition(0,0)}}),b8e.RC("$$game","$$GodEquipSkinView",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(469),this.toggles={toggle_btn_1:game.ME.GodEquipUpgrade,toggle_btn_2:game.ME.GodEquipWash,toggle_btn_3:game.ME.GodEquipQuenching,toggle_btn_4:game.ME.GEduanHun,toggle_btn_5:game.ME.GEfuHun},this.spotAlerts={GODEQUIP_UPGRADE:this.godEquipUpgradeAlert,GODEQUIP_WASH:this.godEquipWashAlert,GODEQUIP_QUENCHING:this.godEquipQuenchingAlert,GE_DUANHUN:this.GEduanHunAlert,GE_FUHUN:this.GEfuHunAlert}},godEquipUpgradeAlert:function(e){this.skin.red_spot_1.node.active=e.alert},godEquipWashAlert:function(e){this.skin.red_spot_2.node.active=e.alert},godEquipQuenchingAlert:function(e){this.skin.red_spot_3.node.active=e.alert},GEduanHunAlert:function(e){this.skin.red_spot_4.node.active=e.alert},GEfuHunAlert:function(e){this.skin.red_spot_5.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.selcetToggle(t)}},selcetToggle:function(e){var t=game.godEquipData2;if(2!=e||game.godEquipData.isQuenchingOpen()){if(3==e)if(!t.isDhOpen())return void game.notice.show(7560);if(4==e)if(!t.isFhOpen())return void game.notice.show(7561);this.toggleSelect(e)}else game.notice.show(6321)}});b8e.module.registerView(game.ME.GodEquip,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_CANCEL:-1,C2V_AUTO_SELECT:-1,V2C_SELECTED:-1,C2V_SELECTED:-1,V2C_UN_SELECTED:-1,C2V_UN_SELECTED:-1,C2C_SELECTED:-1,C2C_UN_SELECTED:-1}),b8e.RC("$$game","$$GodEquipChooseEquipsEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GodEquipQuenching:{C2C_QUENCHING_RESULT:this.onQuenchingResult}}},notify:function(e,t){switch(e){case this.Evts.V2C_SELECTED:this.onSelected(t);break;case this.Evts.V2C_UN_SELECTED:this.onUnSelected(t)}},onQuenchingResult:function(){game.godEquipChooseEquipsData.chooseList&&(game.godEquipChooseEquipsData.chooseList.length=0),this.send(this.Evts.C2V_CANCEL)},onSelected:function(e){var t=game.equipData.getGodEquipResolveInfoByIdx(e);if(t){var a=game.godEquipChooseEquipsData.chooseList,i=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex);if(i&&i.equip&&i.equip.highSpriteStat){var n=game.GodEquipQuenchingCfg.getData(i.equip.highSpriteStat.getCount());if(n)a.length>=n.costItem||(t.isSelected=!0,a.push(e),this.send(this.Evts.C2V_SELECTED),this.dpt(this.Evts.C2C_SELECTED,a))}}},onUnSelected:function(e){var t=game.equipData.getGodEquipResolveInfoByIdx(e);if(t){var a=game.godEquipChooseEquipsData.chooseList,i=a.indexOf(e);i<0||(t.isSelected=!1,a.splice(i,1),this.send(this.Evts.C2V_UN_SELECTED),this.dpt(this.Evts.C2C_UN_SELECTED,a))}},btn_cancel:function(){var t,e=game.godEquipChooseEquipsData.chooseList;!e||e.length<1||(e.forEach(function(e){if(t=game.equipData.getGodEquipResolveInfoByIdx(e)){t.isSelected=!1}},this),e.length=0,this.send(this.Evts.C2V_CANCEL),this.dpt(this.Evts.C2C_UN_SELECTED,e))},btn_choose:function(){var e=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex);if(e&&e.equip&&e.equip.highSpriteStat){var t=game.GodEquipQuenchingCfg.getData(e.equip.highSpriteStat.getCount());if(t){var a=game.godEquipChooseEquipsData.chooseList,i=a.length,n=t.costItem-i;if(n<1);else{var s=game.equipData.getGodEquipResolveInfos();if(!s||s.length<1);else{var o,r=0;for(s.length;r<s.length;r++){if(o=s[r]){if(o.isSelected);else if(o.isSelected=!0,a.push(o.idx),--n<=0){break}}else;}this.send(this.Evts.C2V_SELECTED),this.dpt(this.Evts.C2C_SELECTED,a)}}}else;}else;}});b8e.module.registerControl(game.ME.GodEquipChooseEquips,e,game.GodEquipChooseEquipsEvts,null)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.chooseList=[]}});game.godEquipChooseEquipsData=game.godEquipChooseEquipsData||new e}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(461)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e._list.itemRender=game.GodEquipItem,e._list.bindEnum=game.ME.GodEquipChooseEquips,e._list.addToParent(e.skin.node_scrollview),e._list.layout.spacingX=60,e._list.layout.spacingY=30},notify:function(e){var t=this;switch(e){case t.Evts.C2V_CANCEL:case t.Evts.C2V_AUTO_SELECT:case t.Evts.C2V_SELECTED:case t.Evts.C2V_UN_SELECTED:t.createEquipList(),t.createCost()}},onShow:function(){this.createEquipList(),this.createCost()},createEquipList:function(){var e=game.equipData.getGodEquipResolveInfos();if(e&&this._list)this._list.setData(e);else;},createCost:function(){var e=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex);if(e&&e.equip&&e.equip.highSpriteStat){var t=game.GodEquipQuenchingCfg.getData(e.equip.highSpriteStat.getCount());if(!t||!t.returnItem||t.returnItem.length<1);else{var a=game.godEquipChooseEquipsData.chooseList.length,i=game.HtmlUtil.getText(a>=t.costItem?game.Color.GREEN:game.Color.RED,a+"/"+t.costItem);this.skin.lab_choose.string=game.Lang.get(525,i,t.returnItem[0].Num)}}else;},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.GodEquipChooseEquips,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(462),this.setSize(120,120)},setData:function(e){if(e){var t=game.ItemInfoCfg.getData(e.id);if(t){if(!this.icon){this.icon=game.GridUtil.createGodEquipSlotIcon(),this.icon.addToParent(this.skin.node_equip)}game.GridUtil.setItemIcon(this.icon,t),this.skin.autpBg_2.node.active=e.isSelected}else;}else;},btn_select:function(){var e=this.data;if(e)if(e.isSelected){this.send(game.GodEquipChooseEquipsEvts.V2C_UN_SELECTED,e.idx)}else this.send(game.GodEquipChooseEquipsEvts.V2C_SELECTED,e.idx);else;}}),b8e.RC("$$game","$$GodEquipItem",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_QUENCHING_SUCCEED:-1,C2V_UPDATE_ITEM_COUNT:-1,C2V_UPDATE_ITEMS:-1,V2C_SELECTED:-1,C2C_QUENCHING_RESULT:-1}),b8e.RC("$$game","$$GodEquipQuenchingEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.spotAlert=game.spotAlert.set(game.SAE.GODEQUIP_QUENCHING,game.SAE.GODEQUIP),this.evts={GodEquipChooseEquips:{C2C_SELECTED:this.onChooseItems,C2C_UN_SELECTED:this.onChooseItems},Back:{C_BACK_SYN_BACK_INFO:this.onUpdateItem,C_BACK_UPDATE_ITEMINFO:this.onUpdateItem}},this.handels={HighEquipRefineResp:this.onHighEquipRefineRsp}},onUpdateItem:function(){this.checkCanQuenching(),this.send(this.Evts.C2V_UPDATE_ITEMS)},checkCanQuenching:function(){if(game.moduleOpen.checkOpen(game.ME.GodEquipQuenching))if(game.godEquipData.isQuenchingOpen()){var e=game.equipData.getGodEquipResolveInfosCount();if(e<1)this.spotAlert.alert=!1;else{var t=game.equipSlotData.getEquipSlots();if(!t||t.length<1)this.spotAlert.alert=!1;else{for(var a,i=game.GodEquipQuenchingCfg.getDatas(),n=i?i.length:0,s=0,o=0,r=t.length;o<r;o++)if((a=t[o])&&a.equip&&a.equip.highSpriteStat&&(s=a.equip.highSpriteStat.getCount())<n&&e>=game.GodEquipQuenchingCfg.getData(s).costItem&&game.moduleOpen.checkOpen(game.ME.GodEquipQuenching))return void(this.spotAlert.alert=!0);this.spotAlert.alert=!1}}}else this.spotAlert.alert=!1;else this.spotAlert.alert=!1},onHighEquipRefineRsp:function(e){var t=e.readProtobuf(game.pb.HighEquipRefineResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.equipSlotData.getSlot(t.slot);if(a){if(t.isRefine){if(a.equip&&t.highAttr){a.equip.highSpriteStat.setStatValue(t.highAttr.id,t.highAttr.value),a.equip.refineRate=t.refineRate}}this.send(this.Evts.C2V_QUENCHING_SUCCEED,a),this.dpt(this.Evts.C2C_QUENCHING_RESULT)}else;}},notify:function(e,t){switch(e){case this.Evts.V2C_SELECTED:game.godEquipData.curSlotIndex=t}},onChooseItems:function(e){if(e&&e.data)this.chooseList=e.data,this.send(this.Evts.C2V_UPDATE_ITEM_COUNT,this.chooseList.length);else;},checkCanUpgrade:function(){var e=this.chooseList;if(!e||e.length<1)return game.notice.show(717),!1;var t=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex);if(!t||!t.equip||!t.equip.highSpriteStat)return!1;var a=game.GodEquipQuenchingCfg.getData(t.equip.highSpriteStat.getCount());return!!a&&(!(e.length<a.costItem)||(game.notice.show(6632),!1))},btn_upgrade:function(){this.checkCanUpgrade()&&this.sender.HighEquipRefineReq(game.godEquipData.curSlotIndex,this.chooseList)},btn_choose_items:function(){game.module.show(game.ME.GodEquipChooseEquips)},btn_goto_turnplate:function(){game.luckyTurnplateData.openLuckyById(2)}}),t=game.Sender.extends({ipc:function(){this.msg={HighEquipRefineReq:this.highEquipRefineReq}},highEquipRefineReq:function(e,t){var a=game.pb.HighEquipRefineRequest;a.slot=e,a.idx=t,this.write(a)}});b8e.module.registerControl(game.ME.GodEquipQuenching,e,game.GodEquipQuenchingEvts,t)}(),function(){var e=b8e.Object.extends({isReSetHighAttr:!1,curSlotIndex:0,_isQuenchingOpen:!1,isQuenchingOpen:function(){var e=this._isQuenchingOpen;return e||(this._isQuenchingOpen=e=this._checkQuenchingOpen()),e},_checkQuenchingOpen:function(){var e=game.equipSlotData.getEquipSlot();if(!e||e.count()<1)return!1;for(var t,a,i=e.values(),n=0,s=i.length;n<s;n++)if((t=i[n])&&t.id&&t.equip&&t.equip.highSpriteStat&&(a=game.GodEquipUpgradeCfg.getData(t.id))&&this._isMaxSpriteStat(t.equip.highSpriteStat,a.maxSpriteStat))return!0;return!1},_isMaxSpriteStat:function(e,t){if(!e||!t)return!1;var a=e.getSpriteStats(),i=t.getSpriteStats(),n=!1;return a&&i&&a.forEach(function(e,t){i.get(e)<=t&&(n=!0)},this),n}});game.godEquipData=game.godEquipData||new e}(),function(){var e=game.GodEquipSkinView.extends({ctor:function(){this._super(463),this.chooseCount=0},init:function(){if(this._super(),this._highList){this._highList.itemRender=game.GodEquipWashItem}this.curIcon=game.GridUtil.createGodEquipSlotIcon(),this.curIcon.addToParent(this.getComponent("equip_11"))},notify:function(e,t){var a=this;switch(e){case a.Evts.C2V_UPDATE_ITEM_COUNT:a.onChooseItems(t);break;case a.Evts.C2V_QUENCHING_SUCCEED:a.selectedSlotInfo=t,a.playEffect(t.pos),a.onChooseItems(0),a.createSelected(),a.createCost();break;case a.Evts.C2V_UPDATE_ITEMS:a.createCost(),a.checkAlert()}},onShow:function(){this._super(),this.createSelected(),this.createCost(),this.checkAlert()},createSelected:function(){var e=this.selectedSlotInfo;if(e){var t=game.GodEquipUpgradeCfg.getData(e.id);if(t){this.setSelectImg(e.pos),game.GridUtil.setGodEquipIcon(this.curIcon,e);var a=game.ItemInfoCfg.getData(e.id);a&&(this.skin.lab_cur_name.string=game.HtmlUtil.getColorStrByQuality(a.quality,a.name)),e.equip&&(this.createEquipAttrInfo(this._highAttrInfos,e.equip.highSpriteStat,t.maxSpriteStat),this.createAttrShow(this._highList,this._highAttrInfos.values()))}}},checkAlert:function(){var e=game.equipSlotData.getEquipSlots();if(!e||e.length<1);else for(var t,a,i,n=game.GodEquipQuenchingCfg.getDatas(),s=n?n.length:0,o=game.equipData.getGodEquipResolveInfosCount(),r=0,g=0,l=e.length;g<l;g++){if((a=e[g])&&a.equip&&a.equip.highSpriteStat)if(i=this._equipIcons[a.pos])r=a.equip.highSpriteStat.getCount(),t=game.GodEquipQuenchingCfg.getData(r),i.setAlert(o>=t.costItem&&r<s);else;else;}},onChooseItems:function(e){this.chooseCount=e,this.createCost()},createCost:function(){var e=this.selectedSlotInfo;if(e&&e.equip&&e.equip.highSpriteStat){var t=game.GodEquipQuenchingCfg.getData(e.equip.highSpriteStat.getCount());if(t){var a=this.chooseCount,i=a<t.costItem?game.Color.RED:game.Color.GREEN;if(this.skin.lab_cost_item1.node.color=i,this.skin.lab_cost_item1.string=a+"/"+t.costItem,t.returnItem&&0<t.returnItem.length){this.skin.lab_hint1.string=game.Lang.get(524,t.returnItem[0].Num)}}this.skin.lab_cost_item2.string=e.equip.refineRate+"%"}else;}});b8e.module.registerView(game.ME.GodEquipQuenching,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_RESOLVE_SUCCEED:-1,V2C_RESOLVE_EQUIP:-1,C2C_SMELIT_EQUIP:-1}),b8e.RC("$$game","$$GodEquipResolveEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Sell:{C2C_SMELIT_SUCCEED:this.onSmelitSucceed},Back:{C_BACK_SYN_BACK_INFO:this.showItemCount,C_BACK_UPDATE_ITEMINFO:this.showItemCount}}},notify:function(e,t){switch(e){case this.Evts.V2C_RESOLVE_EQUIP:this.dpt(this.Evts.C2C_SMELIT_EQUIP,t)}},showItemCount:function(){this.send(this.Evts.C2V_RESOLVE_SUCCEED)},onSmelitSucceed:function(){this.send(this.Evts.C2V_RESOLVE_SUCCEED)}});b8e.module.registerControl(game.ME.GodEquipResolve,e,game.GodEquipResolveEvts,null)}(),function(){var e;e=b8e.Object.extends({id:0,idx:0,isSelected:!1,setup:function(e,t){this.id=e,this.idx=t}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GodEquipResolveInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(464),this.setSize(504,124)},init:function(){this.icon=game.GridUtil.createGodEquipSlotIcon(),this.icon.addToParent(this.skin.node_equip)},setData:function(e){if(e){var t=game.ItemInfoCfg.getData(e.id);if(t){if(this.skin.lab_name.string=game.HtmlUtil.getColorStrByQuality(t.quality,t.name),game.GridUtil.setItemIcon(this.icon,t),this.icon.setName(""),t.recycleItems&&0<t.recycleItems.length){this.skin.lab_count.string=t.recycleItems[0].Num}}else;}else;},btn_resolve:function(){if(this.data)this.send(game.GodEquipResolveEvts.V2C_RESOLVE_EQUIP,this.data.idx);else;}}),b8e.RC("$$game","$$GodEquipResolveItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(465)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.GodEquipResolveItem,e._list.bindEnum=game.ME.GodEquipResolve,e._list.addToParent(e.skin.node_scrollview),e.costIcon=b8e.Sprite.get(),e.costIcon.setAnchor(.5,.5),e.costIcon.addToParent(e.skin.icon2),e.costIcon.setSize(40,40)},notify:function(e){switch(e){case this.Evts.C2V_RESOLVE_SUCCEED:this.showItemCount(),this.createEquipList()}},onShow:function(){this.createEquipList(),this.showItemCount()},showItemCount:function(){var e=game.itemData.getNumById(308006);this.skin.lab_item_count.string=e+"";var t=game.ItemInfoCfg.getData(308006);this.costIcon.loadTexture(game.ResCfg.getUrl(137,t.icon))},createEquipList:function(){var e=game.equipData.getGodEquipResolveInfos();if(e&&this._list)this._list.setData(e);else;},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.GodEquipResolve,e)}(),b8e.module.registerControl(game.ME.GodEquipResonance,game.Control,null,null),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(466)},init:function(){},onShow:function(){this.createPanel()},createPanel:function(){var a=this,i=0,n=0,s=null;if(game.equipSlotData.getEquipSlot().forEach(function(e,t){t&&(s=game.ItemInfoCfg.getData(t.id))&&s.quality==game.Quality.Q_RED&&(n+=s.level,i++)},a),a.skin.lab_lv.string=game.Lang.get(526,n),0<n)if(s=game.GodEquipLvResonanceCfg.getData(a.getLvRange(n))){if(e=s.spriteStat.getSpriteStats()){var o=0;e.forEach(function(e,t){e=+e,(s=game.AttrRulesCfg.getData(e))&&(o<4&&(a.getComponent("lab_lv_attr"+o).string=s.name+"\uff1a"+t),o++)},a)}}else a.clearLvAttr();else a.clearLvAttr();var r="";if(a.skin.lab_count.string=game.Lang.get(522,i),!(i<1)){var e;if(s=game.GodEquipChainResonanceCfg.getData(i))(e=s.spriteStat.getSpriteStats())&&e.forEach(function(e,t){e=+e,(s=game.AttrRulesCfg.getData(e))&&(r+=s.name+"\uff1a"+t+"\n")},a);a.skin.lab_attr2.string=r}},clearLvAttr:function(){for(var e=0;e<4;e++)this.getComponent("lab_lv_attr"+e).string=""},getLvRange:function(e){var t,a=game.GodEquipLvResonanceCfg.getDatas();if(!a||a.length<1)return 0;for(var i=a[0],n=0,s=a.length;n<s;n++){if((t=a[n])&&t.number>e)return i.number;i=t}return 0},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.GodEquipResonance,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_RADIO_SWITH:-1,C2V_UPGRADE_SUCCEED:-1,C2C_UPGRADE_SUCCEED:-1,C2V_UPDATE_ITEMS:-1,C2V_UPDATE_VIEW:-1,V2C_SELECTED:-1,C2C_WEAR_EQUIP:-1}),b8e.RC("$$game","$$GodEquipUpgradeEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.spotAlert=game.spotAlert.set(game.SAE.GODEQUIP_UPGRADE,game.SAE.GODEQUIP),this.evts={Back:{C_BACK_SYN_BACK_INFO:this.onUpdateItem,C_BACK_UPDATE_ITEMINFO:this.onUpdateItem},RoleEquip:{V_CHANGE_EQUIP:this.onChangeEquip}},this.handels={HighEquipUpgradeResp:this.onHighEquipUpgradeRsp}},notify:function(e,t){switch(e){case this.Evts.V2C_SELECTED:game.godEquipData.curSlotIndex=t}},onUpdateItem:function(){this.checkCanUpgrade(),this.send(this.Evts.C2V_UPDATE_ITEMS)},onChangeEquip:function(e){this.send(this.Evts.C2V_UPDATE_VIEW,e.data)},btn_radio:function(){game.godEquipData.isReSetHighAttr=!game.godEquipData.isReSetHighAttr,this.send(this.Evts.C2V_RADIO_SWITH)},btn_upgrade:function(){var e=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex);if(e){var t=game.GodEquipUpgradeCfg.getData(e.id);if(t)if(t.nextId<1)game.notice.show(9150);else game.ItemInfoCfg.getData(t.nextId).level>game.mainRoleData.lv?game.notice.show(9151):this.sender.HighEquipUpgradeReq(game.godEquipData.curSlotIndex,game.godEquipData.isReSetHighAttr)}},costIconBtn:function(){var e=game.equipSlotData.getSlot(game.godEquipData.curSlotIndex);if(e){var t=game.GodEquipUpgradeCfg.getData(e.id);if(t&&!(t.nextId<1)){var a=t.itemId,i=game.ItemInfoCfg.getData(a);i&&(i.shopGoodsId&&0<i.shopGoodsId.length?game.AccessShopView.inst().showView(a):game.AccessView.inst().showView(a))}}},btn_resonance:function(){game.module.show(game.ME.GodEquipResonance)},btn_goto:function(){game.module.show(game.ME.GodEquipResolve)},btn_goto_turnplate:function(){game.luckyTurnplateData.openLuckyById(2)},checkCanWearGodEquip:function(){for(var e,t,a=game.equipData.getCanWearGodEquip(),i=1;i<=10;i++)if((e=a[i])&&(t=game.equipSlotData.getSlot(i))&&(t._cfg.quality!=game.Quality.Q_RED||t.power<e.power))return!0;return!1},checkCanUpgrade:function(){if(game.moduleOpen.checkOpen(game.ME.GodEquipUpgrade))if(this.checkCanWearGodEquip())this.spotAlert.alert=!0;else{var e=game.equipSlotData.getEquipSlots();if(!e||e.length<1){this.spotAlert.alert=!1}else{for(var t,a,i=game.amount.get(game.AmountType.SILVER),n=0,s=e.length;n<s;n++){if((t=e[n])&&t.equip&&t.equip.highSpriteStat){if((a=game.GodEquipUpgradeCfg.getData(t.id))&&0<a.nextId){if(i<a.silver){continue}var o=game.ItemInfoCfg.getData(a.nextId);if(game.mainRoleData.lv>=o.level&&game.itemData.getNumById(a.itemId)>=a.itemNum&&game.moduleOpen.checkOpen(game.ME.GodEquipUpgrade)){return void(this.spotAlert.alert=!0)}}}}this.spotAlert.alert=!1}}else this.spotAlert.alert=!1},onHighEquipUpgradeRsp:function(e){var t=e.readProtobuf(game.pb.HighEquipUpgradeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.equipSlotData.change(t.newEquip);var a=game.equipSlotData.getSlot(t.slot);this.send(this.Evts.C2V_UPGRADE_SUCCEED,a),this.checkCanUpgrade(),this.dpt(this.Evts.C2C_UPGRADE_SUCCEED)}},sendWearEquip:function(e){var t=game.equipData.getWearGodEquip(e);t&&this.dpt(this.Evts.C2C_WEAR_EQUIP,t.idx)},wearBtn_1:function(){this.sendWearEquip(1)},wearBtn_2:function(){this.sendWearEquip(2)},wearBtn_3:function(){this.sendWearEquip(3)},wearBtn_4:function(){this.sendWearEquip(4)},wearBtn_5:function(){this.sendWearEquip(5)},wearBtn_6:function(){this.sendWearEquip(6)},wearBtn_7:function(){this.sendWearEquip(7)},wearBtn_8:function(){this.sendWearEquip(8)},wearBtn_9:function(){this.sendWearEquip(9)},wearBtn_10:function(){this.sendWearEquip(10)}}),t=game.Sender.extends({ipc:function(){this.msg={HighEquipUpgradeReq:this.highEquipUpgradeReq}},highEquipUpgradeReq:function(e,t){var a=game.pb.HighEquipUpgradeRequest;a.slot=e,a.isRefashion=t,this.write(a)}});b8e.module.registerControl(game.ME.GodEquipUpgrade,e,game.GodEquipUpgradeEvts,t)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(467),this.setSize(340,30)},setData:function(e){if(e){var t=game.AttrRulesCfg.getData(+e.type),a=t?t.name:"";a.length<3&&(a=a[0]+"       "+a[1]),this.skin.attr_name.string=a+":",this.skin.attr_cur_value.string=e.value1+"",this.skin.attr_next_value.string=a+":"+e.value2}}}),b8e.RC("$$game","$$GodEquipUpgradeAttrItem",e)}(),function(){var e=game.GodEquipSkinView.extends({ctor:function(){this._super(468)},init:function(){var e=this;e._super(),e._baseList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._baseList.itemRender=game.GodEquipUpgradeAttrItem,e._baseList.bindEnum=game.ME.GodEquipUpgrade,e._baseList.layout.paddingLeft=3,e._baseList.layout.paddingTop=0,e._baseList.layout.spacingY=0,e._baseList.addToParent(e.skin.attr_scrollview1),e._highList&&(e._highList.itemRender=game.GodEquipUpgradeAttrItem,e._highList.bindEnum=game.ME.GodEquipUpgrade,e._highList.layout.paddingLeft=3,e._highList.layout.paddingTop=0,e._highList.layout.spacingY=2),e.curIcon=game.GridUtil.createGodEquipSlotIcon(),e.curIcon.addToParent(e.getComponent("equip_11")),e.nextIcon=game.GridUtil.createGodEquipSlotIcon(),e.nextIcon.addToParent(e.getComponent("equip_12")),e._baseAttrInfos=b8e.HashMap.get(),e.costIcon=b8e.Sprite.get(),e.costIcon.setAnchor(.5,.5),e.costIcon.addToParent(e.skin.icon1),e.costIcon.setSize(40,40)},notify:function(e,t){var a=this;switch(e){case a.Evts.C2V_RADIO_SWITH:a.createReSetRadioBtnState();break;case a.Evts.C2V_UPGRADE_SUCCEED:a.selectedSlotInfo=t,a.playEffect(t.pos),a.createSelected(),a.setEquipSlot();break;case a.Evts.C2V_UPDATE_ITEMS:a.createCost(),a.checkAlert(),a.checkWear();break;case a.Evts.C2V_UPDATE_VIEW:a.onWearEquip(t)}},onShow:function(){this._super(),this.createSelected(),this.checkAlert(),this.checkWear()},onWearEquip:function(e){for(var t,a,i=0,n=e.length;i<n;i++)t=e[i],a=game.equipSlotData.getSlot(t),this.setSlot(t,a)},checkWear:function(){for(var e,t,a,i=game.equipData.getCanWearGodEquip(),n=1;n<=10;n++)(a=this.getComponent("wearBtn_"+n))&&((e=i[n])?(t=game.equipSlotData.getSlot(n))&&t._cfg.quality==game.Quality.Q_RED&&t.power>e.power?a.node.active=!1:a.node.active=!0:a.node.active=!1)},checkAlert:function(){var e=game.equipSlotData.getEquipSlots();if(e&&!(e.length<1))for(var t,a,i,n=game.amount.get(game.AmountType.SILVER),s=0,o=e.length;s<o;s++)if((a=e[s])&&a.equip&&a.equip.highSpriteStat&&(i=this._equipIcons[a.pos])){var r=!1;if((t=game.GodEquipUpgradeCfg.getData(a.id))&&0<t.nextId){var g=game.ItemInfoCfg.getData(t.nextId);game.mainRoleData.lv>=g.level&&game.itemData.getNumById(t.itemId)>=t.itemNum&&n>=t.silver&&(r=!0)}i.setAlert(r)}},createSelected:function(){var e=this,t=e.selectedSlotInfo;if(t){var a=game.ItemInfoCfg.getData(t.id);if(a&&a.quality==game.Quality.Q_RED){var i=game.GodEquipUpgradeCfg.getData(t.id);if(i){if(e.setSelectImg(t.pos),game.GridUtil.setGodEquipIcon(e.curIcon,t),e.skin.lab_cur_name.string=game.HtmlUtil.getColorStrByQuality(a.quality,a.name),i.nextId){var n=game.ItemInfoCfg.getData(i.nextId);n&&(e.nextSlotInfo=game.ItemUtil.createEquipSlotInfo(n,0),game.GridUtil.setGodEquipIcon(e.nextIcon,e.nextSlotInfo),e.skin.lab_next_name.string=game.HtmlUtil.getColorStrByQuality(n.quality,n.name))}e.index=0,a&&n&&(e.createEquipAttrInfo(e._baseAttrInfos,a.spriteStat,n.spriteStat),e.createAttrShow(e._baseList,e._baseAttrInfos.values())),e._spriteStat||(e._spriteStat=game.SpriteStat.get(),e._spriteStat.initSpriteStat());var s=void 0;i.nextId&&(s=game.GodEquipUpgradeCfg.getData(i.nextId),e.calNextAttrInfo(e._spriteStat,t.equip.highSpriteStat,i.maxSpriteStat,s.maxSpriteStat),t.equip&&s&&(e.createEquipAttrInfo(e._highAttrInfos,t.equip.highSpriteStat,e._spriteStat),e.createAttrShow(e._highList,e._highAttrInfos.values()))),e.createCost(),e.createReSetRadioBtnState()}}}},calNextAttrInfo:function(a,e,t,i){if(a&&e&&t&&i){a.clear();var n=e.getSpriteStats(),s=t.getSpriteStats(),o=i.getSpriteStats(),r=1,g=0,l=0;n&&s&&o&&n.forEach(function(e,t){g=s.get(e),l=o.get(e),0<t&&(r=t/g),a.addSpriteStateByType(e,l*r>>0)},this)}},createReSetRadioBtnState:function(){this.skin.autpBg_2.node.active=game.godEquipData.isReSetHighAttr},createCost:function(){if(this.selectedSlotInfo){var e=game.ItemInfoCfg.getData(this.selectedSlotInfo.id);if(e&&e.quality==game.Quality.Q_RED){var t=game.GodEquipUpgradeCfg.getData(this.selectedSlotInfo.id);if(t){var a=game.ItemInfoCfg.getData(t.itemId);this.costIcon.loadTexture(game.ResCfg.getUrl(137,a.icon));var i=this.skin,n=game.itemData.getNumById(t.itemId);i.lab_cost_item.string=game.HtmlUtil.getText(n<t.itemNum?game.Color.RED:game.Color.GREEN,n+"/"+t.itemNum),n=game.amount.get(game.AmountType.SILVER),i.lab_cost_silver.string=game.HtmlUtil.getText(n<t.silver?game.Color.RED:game.Color.GREEN,t.silver),game.AutoLayoutUtil.layoutWith2Icon2Label(i.icon1,i.lab_cost_item,i.silver,i.lab_cost_silver)}else;}}else;}});b8e.module.registerView(game.ME.GodEquipUpgrade,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_WASH_SUCCEED:-1,C2V_UPDATE_ITEMS:-1,V2C_SELECTED:-1}),b8e.RC("$$game","$$GodEquipWashEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.spotAlert=game.spotAlert.set(game.SAE.GODEQUIP_WASH,game.SAE.GODEQUIP),this.evts={Back:{C_BACK_SYN_BACK_INFO:this.onUpdateItem,C_BACK_UPDATE_ITEMINFO:this.onUpdateItem}},this.handels={HighEquipWashTypeResp:this.onHighEquipWashTypeRsp,HighEquipWashValueResp:this.onHighEquipWashValueRsp}},notify:function(e,t){switch(e){case this.Evts.V2C_SELECTED:game.godEquipData.curSlotIndex=t}},onUpdateItem:function(){this.checkCanWash(),this.send(this.Evts.C2V_UPDATE_ITEMS)},checkCanWash:function(){if(game.moduleOpen.checkOpen(game.ME.GodEquipWash)){var e=game.equipSlotData.getEquipSlots();if(!e||e.length<1){this.spotAlert.alert=!1}else{for(var t,a,i,n=0,s=e.length;n<s;n++){if((t=e[n])&&t.equip&&t.equip.highSpriteStat){if((a=game.GodEquipWashTypeCostCfg.getData(t.equip.highSpriteStat.getCount()))&&a.costItem&&0<a.costItem.length){if(game.itemData.getNumById(a.costItem[0].Id)>=a.costItem[0].Num&&game.moduleOpen.checkOpen(game.ME.GodEquipWash)){return void(this.spotAlert.alert=!0)}}if((i=game.ItemInfoCfg.getData(t.id))&&i.quality==game.Quality.Q_RED){if(a=game.GodEquipWashValueCostCfg.getData(i.level)){if(game.itemData.getNumById(a.itemId)>=a.itemNum&&game.moduleOpen.checkOpen(game.ME.GodEquipWash)){return void(this.spotAlert.alert=!0)}}}}}this.spotAlert.alert=!1}}else this.spotAlert.alert=!1},btn_wash_type:function(){var e,t,a,i,n=game.godEquipData.curSlotIndex,s=game.equipSlotData.getSlot(n);s&&s.equip&&s.equip.highSpriteStat&&(e=game.GodEquipWashTypeCostCfg.getData(s.equip.highSpriteStat.getCount()))&&e.costItem&&0<e.costItem.length&&(t=e.costItem[0].Id,a=e.costItem[0].Num,i=game.UpgradeUtil.checkItemInfo(t,a)),i&&this.sender.HighEquipWashTypeReq(n)},btn_wash_value:function(){var e,t,a,i,n,s=game.godEquipData.curSlotIndex,o=game.equipSlotData.getSlot(s);o&&o.equip&&o.equip.highSpriteStat&&(e=game.ItemInfoCfg.getData(o.id))&&e.quality==game.Quality.Q_RED&&(t=game.GodEquipWashValueCostCfg.getData(e.level))&&(a=t.itemId,i=t.itemNum,n=game.UpgradeUtil.checkItemInfo(a,i)),n&&this.sender.HighEquipWashValueReq(s)},onHighEquipWashTypeRsp:function(e){var t=e.readProtobuf(game.pb.HighEquipWashTypeResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.equipSlotData.getSlot(t.slot);a.equip&&(a.equip.highSpriteStat=game.SpriteStatUtil.setDataByServer(t.highAttrs),this.send(this.Evts.C2V_WASH_SUCCEED,a))}},onHighEquipWashValueRsp:function(e){var t=e.readProtobuf(game.pb.HighEquipWashValueResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.equipSlotData.getSlot(t.slot);a.equip&&(a.equip.highSpriteStat=game.SpriteStatUtil.setDataByServer(t.highAttrs),a.resetPower(),this.send(this.Evts.C2V_WASH_SUCCEED,a))}},btn_goto_turnplate:function(){game.luckyTurnplateData.openLuckyById(2)}}),t=game.Sender.extends({ipc:function(){this.msg={HighEquipWashTypeReq:this.highEquipWashTypeReq,HighEquipWashValueReq:this.highEquipWashValueReq}},highEquipWashTypeReq:function(e){var t=game.pb.HighEquipWashTypeRequest;t.slot=e,this.write(t)},highEquipWashValueReq:function(e){var t=game.pb.HighEquipWashValueRequest;t.slot=e,this.write(t)}});b8e.module.registerControl(game.ME.GodEquipWash,e,game.GodEquipWashEvts,t)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(470),this.setSize(370,36)},setData:function(e){if(e){var t=game.AttrRulesCfg.getData(e.type),a=t?t.name:"";a.length<3&&(a=a[0]+"       "+a[1]),this.skin.attr_name.string=a+":",this.skin.attr_value.string=e.value1,this.skin.pro.node.width=240*e.value1/e.value2}else;},clear:function(){if(this.skin){this.skin.attr_name.string="",this.skin.attr_value.string="",this.skin.pro.node.width=0}},onHide:function(){this.clear()}}),b8e.RC("$$game","$$GodEquipWashItem",e)}(),function(){var e;e=game.GodEquipSkinView.extends({ctor:function(){this._super(471)},init:function(){var e=this;if(e._super(),e._highList){this._highList.itemRender=game.GodEquipWashItem}e.curIcon=game.GridUtil.createGodEquipSlotIcon(),e.curIcon.addToParent(e.getComponent("equip_11")),e.costIcon_1=b8e.Sprite.get(),e.costIcon_1.setAnchor(.5,.5),e.costIcon_1.addToParent(e.skin.icon1),e.costIcon_1.setSize(40,40),e.costIcon_2=b8e.Sprite.get(),e.costIcon_2.setAnchor(.5,.5),e.costIcon_2.addToParent(e.skin.icon2),e.costIcon_2.setSize(40,40)},notify:function(e,t){switch(e){case this.Evts.C2V_WASH_SUCCEED:this.selectedSlotInfo=t,this.playEffect(t.pos),this.createSelected();break;case this.Evts.C2V_UPDATE_ITEMS:this.createCost(),this.checkAlert()}},onShow:function(){this._super(),this.createSelected(),this.createCost(),this.checkAlert()},createSelected:function(){var e=this.selectedSlotInfo;if(e){var t=game.GodEquipUpgradeCfg.getData(e.id);if(t){this.setSelectImg(e.pos),game.GridUtil.setGodEquipIcon(this.curIcon,e);var a=game.ItemInfoCfg.getData(e.id);a&&(this.skin.lab_cur_name.string=game.HtmlUtil.getColorStrByQuality(a.quality,a.name)),e.equip&&(this.createEquipAttrInfo(this._highAttrInfos,e.equip.highSpriteStat,t.maxSpriteStat),this.createAttrShow(this._highList,this._highAttrInfos.values()))}}},isMaxSpriteStat:function(e,t){if(!e||!t)return!0;var a=e.getSpriteStats(),i=t.getSpriteStats(),n=!0;return a&&i&&a.forEach(function(e,t){t<i.get(e)&&(n=!1)},this),n},checkAlert:function(){var e=game.equipSlotData.getEquipSlots();if(e&&!(e.length<1))for(var t,a,i,n,s,o,r,g,l=0,c=e.length;l<c;l++)(a=e[l])&&a.equip&&a.equip.highSpriteStat&&(i=this._equipIcons[a.pos])&&(g=r=o=!1,(t=game.GodEquipWashTypeCostCfg.getData(a.equip.highSpriteStat.getCount()))&&t.costItem&&0<t.costItem.length&&game.itemData.getNumById(t.costItem[0].Id)>=t.costItem[0].Num&&(r=!0),r||(o=(s=game.GodEquipUpgradeCfg.getData(a.id))&&this.isMaxSpriteStat(a.equip.highSpriteStat,s.maxSpriteStat))||(n=game.ItemInfoCfg.getData(a.id))&&(t=game.GodEquipWashValueCostCfg.getData(n.level))&&game.itemData.getNumById(t.itemId)>=t.itemNum&&(g=!0),i.setAlert(r||!o&&g))},createCost:function(){var e=this.selectedSlotInfo;if(e&&e.equip&&e.equip.highSpriteStat){var t=this.skin,a=void 0,i=game.GodEquipWashTypeCostCfg.getData(e.equip.highSpriteStat.getCount());if(i&&i.costItem&&0<i.costItem.length){a=i.costItem[0];var n=game.itemData.getNumById(a.Id);t.lab_cost_item1.string=n+"/"+a.Num;var s=n<a.Num?game.Color.RED:game.Color.GREEN;t.lab_cost_item1.node.color=s;var o=game.ItemInfoCfg.getData(a.Id);this.costIcon_1.loadTexture(game.ResCfg.getUrl(137,o.icon))}var r=game.ItemInfoCfg.getData(e.id);if(r&&(i=game.GodEquipWashValueCostCfg.getData(r.level))){n=game.itemData.getNumById(i.itemId);this.costIcon_2.loadTexture(game.ResCfg.getUrl(137,i.itemId));s=n<i.itemNum?game.Color.RED:game.Color.GREEN;t.lab_cost_item2.node.color=s,t.lab_cost_item2.string=n+"/"+i.itemNum}t.icon2.x=t.lab_cost_item2.x-t.lab_cost_item2.width-20,t.lab_cost_title2.x=t.icon2.x-20}}}),b8e.module.registerView(game.ME.GodEquipWash,e),b8e.RC("$$game","$$GodEquipWashView",e)}(),function(){var e;e=b8e.Enum({NONE:0,V_RESOLVE_SUCCEED:-1,V_RESOLVE_EQUIP:-1,C_SMELIT_EQUIP:-1,V_UPDATE_ITEMINFO:-1}),b8e.RC("$$game","$$GoldEquipResolveEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.GOLD_EQUIP_RESOLVE,game.SAE.GOLD_EQUIP_SHOP),this.smeltList=[]},ipc:function(){this.evts={Sell:{C2C_SMELIT_SUCCEED:this.onSmelitSucceed},Back:{C_BACK_SYN_BACK_INFO:this.updateItem,C_BACK_UPDATE_ITEMINFO:this.updateItem,C_EQUIP_UPDATE:this.checkAlert}}},notify:function(e,t){switch(e){case this.Evts.V_RESOLVE_EQUIP:this.dpt(this.Evts.C_SMELIT_EQUIP,t)}},updateItem:function(){this.send(this.Evts.V_UPDATE_ITEMINFO)},onSmelitSucceed:function(){this.checkAlert(),this.send(this.Evts.V_RESOLVE_SUCCEED)},checkAlert:function(){this.spotAlert.alert=game.equipData.getGoldEquipAlert()},accessLab_1:function(){game.module.showToggle(game.ME.InstanceFunc,2),game.module.hide(this.moduleEnum)},accessLab_2:function(){game.module.showToggle(game.ME.Boss,2),game.module.hide(this.moduleEnum)},smeltBtn:function(){var e=game.equipData.getGoldEquipResolveInfos();if(e){this.smeltList.length=0;for(var t=e.length,a=void 0,i=0;i<t;i++)(a=e[i])&&this.smeltList.push(a.idx);this.smeltList.length<1||this.dpt(this.Evts.C_SMELIT_EQUIP,this.smeltList)}}});b8e.module.registerControl(game.ME.GoldEquipResolve,e,game.GoldEquipResolveEvts)}(),function(){var t=void 0;t=b8e.PoolObject.extends({id:0,idx:0,isSelected:!1,setup:function(e,t){var a=this;a.id=e,a.idx=t},recycle:function(){this.reset(),this._super()},reset:function(){this.idx=0}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,1024),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$GoldEquipResolveInfo",t)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(490),this.setSize(540,126)},init:function(){this.icon=game.GridUtil.createEquipIcon(game.IconSizeEnum.SIZE_74),this.icon.addToParent(this.skin.node_equip)},setData:function(){var e=this.data,t=game.ItemInfoCfg.getData(e.id);if(t){if(this.skin.lab_name.string=t.name,game.GridUtil.setItemIcon(this.icon,t,!1,game.IconLayoutEnum.SHOW_NAME),t.recycleItems&&0<t.recycleItems.length){this.skin.lab_count.string=t.recycleItems[0].Num}}else;},btn_resolve:function(){if(this.data)this.send(game.GoldEquipResolveEvts.V_RESOLVE_EQUIP,this.data.idx);else;}}),b8e.RC("$$game","$$GoldEquipResolveItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(491)},init:function(){var e=this._list=new game.List;e.itemRender=game.GoldEquipResolveItem,e.bindEnum=game.ME.GoldEquipResolve,e.addToParent(this.skin.node_scrollview)},notify:function(e){switch(e){case this.Evts.V_RESOLVE_SUCCEED:this.createEquipList();break;case this.Evts.V_UPDATE_ITEMINFO:this.showItemCount()}},onShow:function(){this.createEquipList(),this.showItemCount()},showItemCount:function(){var e=game.itemData.getNumById(308002);this.skin.lab_item_count.string=e+""},createEquipList:function(){var e=game.equipData.getGoldEquipResolveInfos();if(e&&this._list)this._list.setData(e);else;},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}});b8e.module.registerView(game.ME.GoldEquipResolve,e)}(),function(){var e;e=b8e.Enum({None:0,C_UPDATE_GUILD:-1,V_UPDATE_GUILD:-1,C_UPDATE_MASTER:-1,V_UPDATE_MASTER:-1,C_UPDATE_GUILD_NAME:-1,V_UPDATE_GUILD_NAME:-1,V_UPDATE_LOG:-1,C_UPDATE_MEMBERS:-1,C_UPDATE_GUILD_SETTING:-1,V_UPDATE_GUILD_SETTING:-1,V_UPDATE_LIST:-1,C_UPDATE_NOTICE:-1,V_UPDATE_NOTICE:-1,V_SHOW_GUILD_VIEW:-1,V_APPLY_JOIN:-1,V_CANCEL_JOIN:-1,V_CREATE_GUILD:-1,V_SELECT_CREATE_LV:-1,V_AGREE:-1,V_REFUSE:-1,V_APPOINT:-1,V_KICK:-1,V_DEMISE:-1,V_DEMOTION:-1,V_MERGER:-1,V_CHECK_PASS:-1,V_SWITCH_PAGE:-1,C_SEND_GUILD_DATA:-1,C_INIT_GUILD_MODEL_DATA:-1,C_INIT_MODEL:-1,C2C_UPDATE_GUILD_ACTIVE:-1,C_JOIN_GUILD:-1,C_CREATE_GUILD:-1,C2C_MERGE_SUCCESS:-1}),b8e.RC("$$game","$$GuildEvts",e)}(),function(){var e=game.Control.extends({createVipList:null,costVipList:null,secondCreateLv:2,init:function(){this.data=game.guildData,game.createGuildData.initData()},ipc:function(){this.handels={GuildCreateResp:this.guildCreateResp}},guildCreateResp:function(e){var t=e.readProtobuf(game.pb.GuildCreateResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=this;a.data.setGuildData(t.data),game.module.hide(game.ME.GuildRecommend),game.module.hide(this.moduleEnum),game.module.show(game.ME.Guild),a.dpt(a.Evts.C2C_UPDATE_GUILD_ACTIVE),a.dpt(a.Evts.C_CREATE_GUILD)}},notify:function(e,t){var a=game.createGuildData;switch(e){case this.Evts.V_CHECK_PASS:a.setGuildName(t),this.checkPass();break;case this.Evts.V_SHOW_GUILD_VIEW:a.setSelectLv(1),a.setSelectIndex(0)}},createGuildBtn:function(){this.send(this.Evts.V_CREATE_GUILD)},checkPass:function(){var e=this,t=game.createGuildData,a=t.guildName,i=t.selectIndex,n=t.guildLv,s=game.mainRoleData.vipLevel,o=t.createVipList[i];if(s<o){game.notice.show(1601,o)}else if(6<a.length)game.notice.show(50154);else{var r=t.createCostList[i];if(game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,r))e.sender.GuildCreateReq(a,n);else;}},leftBg:function(){var e=game.createGuildData;e.setSelectLv(1),e.setSelectIndex(0),this.selectToggle(0)},rightBg:function(){var e=game.createGuildData,t=e.secondCreateLv;e.setSelectLv(t),e.setSelectIndex(1),this.selectToggle(1)},selectToggle:function(e){this.send(this.Evts.V_SWITCH_PAGE,e)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildCreateReq:this.guildCreateReq}},guildCreateReq:function(e,t){var a=game.pb.GuildCreateRequest;a.name=e,a.type=t,b8e.net.getBytes().writeProtobuf(a)}});b8e.module.registerControl(game.ME.CreateGuild,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({alterPower:0,init:function(){this.data=game.guildData,this.spotAlert=game.spotAlert.set(game.SAE.GUILD_APPLY,game.SAE.GUILD_HALL)},ipc:function(){this.evts={Guild:{C_UPDATE_GUILD:this.updateGuild,C2C_UPDATE_GUILD_ACTIVE:this.checkAlert},GuildMember:{C2C_UPDATE_GUILD_ACTIVE:this.checkAlert}},this.handels={GuildReqListResp:this.guildReqListResp,GuildSettingResp:this.guildSettingResp,GuildHandleReqResp:this.guildHandleReqResp}},notify:function(e,t){var a=this,i=a.Evts;switch(e){case i.V_SHOW_GUILD_VIEW:a.showGuildApplyView();break;case i.V_AGREE:a.sender.GuildHandleReqReq(t,game.GuildApplyType.AGREE);break;case i.V_REFUSE:a.sender.GuildHandleReqReq(t,game.GuildApplyType.REFUSE);break;case i.V_CHECK_PASS:a.alterPower=t,a.checkPass()}},updateGuild:function(){if(0!=game.guildData.id){var e=game.guildData.getMineRank();if(e==game.GuildRankType.GUILDMASTER||e==game.GuildRankType.ZHANGLAO){this.sender.GuildReqListReq()}}},guildReqListResp:function(e){var t=e.readProtobuf(game.pb.GuildReqListResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setApplyList(t.players),this.checkAlert(),this.send(this.Evts.V_UPDATE_LIST)},guildSettingResp:function(e){var t=e.readProtobuf(game.pb.GuildSettingResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setSetting(t.power,t.state),game.notice.show(1671),this.send(this.Evts.V_UPDATE_GUILD_SETTING),this.dpt(this.Evts.C_UPDATE_GUILD_SETTING)},guildHandleReqResp:function(e){var t=e.readProtobuf(game.pb.GuildHandleReqResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.guildHandleReq(t.type,t.playerIds),this.checkAlert(),this.send(this.Evts.V_UPDATE_LIST)},showGuildApplyView:function(){this.alterPower=game.guildData.powerLimit,this.sender.GuildReqListReq()},autoBtn:function(){var e,t=game.GuildApplyState;if(game.guildData.state==t.OPEN){e=t.CHECK}else e=t.OPEN;var a=game.guildData.powerLimit;this.sender.GuildSettingReq(a,e)},changeBtn:function(){if(game.guildData.state!=game.GuildApplyState.CHECK)this.send(this.Evts.V_CHECK_PASS);else;},checkPass:function(){var e=game.guildData.state;this.sender.GuildSettingReq(this.alterPower,e)},checkAlert:function(){if(0!=game.guildData.id){var e=game.guildData.getApplyList();if(!e||e.length<1){this.spotAlert.alert=!1}else this.spotAlert.alert=!0}else{this.spotAlert.alert=!1}}}),t=game.Sender.extends({ipc:function(){this.msg={GuildReqListReq:null,GuildSettingReq:this.guildSettingReq,GuildHandleReqReq:this.guildHandleReqReq}},guildSettingReq:function(e,t){var a=game.pb.GuildSettingRequest;a.power=e,a.state=t,b8e.net.getBytes().writeProtobuf(a)},guildHandleReqReq:function(e,t){var a=game.pb.GuildHandleReqRequest;a.playerId=e,a.type=t,b8e.net.getBytes().writeProtobuf(a)}});b8e.module.registerControl(game.ME.GuildApplyList,e,game.GuildEvts,t)}(),function(){var e,t=game.Control.extends({init:function(){this.data=game.guildData,this.spotAlert=game.spotAlert.set(game.SAE.GUILD,game.SAE.HOME),this._alertOptions={lang:1610,okcb:this.onClickGameAlert,thisArg:this}},ipc:function(){var e=this;e.evts={MainRole:{C_RESET_DAILY:e.resetDaily},GuildRecommend:{C_JOIN_GUILD:e.onJoin},CreateGuild:{C_CREATE_GUILD:e.onJoin}},e.handels={GuildDataResp:e.guildDataResp,GuildJoinMsg:e.guildJoinMsg,GuildKickMsg:e.guildKickMsg,GuildMergeMsg:e.guildMergeMsg,AgreeMergeResp:e.agreeMergeResp,GuildIncenseLogResp:e.guildIncenseLogResp,GuildModelResp:e.guildModelResp,GuildMergeMsg2:e.guildMergeMsg2,GuildDataMsg:e.guildDataMsg,GuildNewMemberMsg:e.guildNewMemberMsg,GuildRankNotify:e.guildRankNotify}},triggerOpen:function(e){e==this.moduleEnum&&(this.sender.GuildDataReq(),this.sender.GuildModelReq())},resetDaily:function(){if(game.moduleOpen.checkOpen(this.moduleEnum))this.sender.GuildModelReq();else;},guildDataResp:function(e){var t=e.readProtobuf(game.pb.GuildDataResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setGuildData(t.data),game.guildIncenseData.setData(t.data),game.guildNewBossData.updateBossOpen(t.data),this.dpt(this.Evts.C_UPDATE_GUILD),this.checkAlert()},guildJoinMsg:function(e){var t=e.readProtobuf(game.pb.GuildJoinNotify);if(b8e.module.isShowView(game.ME.GuildRecommend)){b8e.module.hideView(game.ME.GuildRecommend)}this.sender.GuildDataReq(),this.sender.GuildModelReq(),game.notice.show(1602,t.name),this.dpt(this.Evts.C2C_UPDATE_GUILD_ACTIVE),this.dpt(this.Evts.C_JOIN_GUILD),this.checkAlert()},onJoin:function(){this.sender.GuildModelReq()},guildKickMsg:function(){this.data.clearData(),game.GameViewMgr.inst().hideGuildViews(),this.dpt(this.Evts.C2C_UPDATE_GUILD_ACTIVE),this.checkAlert()},guildMergeMsg:function(e){var t=e.readProtobuf(game.pb.GuildMergeNotify),a=t.guildName;t.roleName;this._alertOptions.langArgs=a,game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(){this.sender.AgreeMergeReq()},guildMergeMsg2:function(){this.sender.GuildDataReq(),this.dpt(this.Evts.C2C_MERGE_SUCCESS)},guildDataMsg:function(e){var t=e.readProtobuf(game.pb.GuildDataNotify);this.data.setFundData(t),this.dpt(this.Evts.C_UPDATE_GUILD)},guildNewMemberMsg:function(e){var t=e.readProtobuf(game.pb.GuildNewMemberNotify);this.data.newMember(t.members),this.dpt(this.Evts.C_UPDATE_GUILD)},guildRankNotify:function(){this.sender.GuildDataReq()},agreeMergeResp:function(e){var t=e.readProtobuf(game.pb.AgreeMergeResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.sender.GuildDataReq()},guildIncenseLogResp:function(e){var t=e.readProtobuf(game.pb.GuildIncenseLogResponse);game.guildIncenseData.setLogs(t.logs)},guildModelResp:function(e){var t=e.readProtobuf(game.pb.GuildModelResponse);game.guildIncenseData.setModelData(t.incensed,t.incenseAwards),game.guildSkillData.initSkillData(),game.guildSkillData.setSkillData(t.skills),game.guildCollectData.setResetTimes(t.mapCollectResetTimes,t.mapChallengeResetTimes),game.guildCollectData.setAward(t.mapCollectCollected,t.mapChallengeCollected),game.guildCollectData.setTaskCount(t.mapCollectTimes,t.mapChallengeTimes),game.guildActiveData.setActiveData(t),game.tribalResearchData.setData(t),game.guildNewBossData.updatechallengeInfo(t.challengeInfo),this.dpt(this.Evts.C_INIT_GUILD_MODEL_DATA),this.dpt(this.Evts.C_INIT_MODEL)},notify:function(e){switch(e){case this.Evts.V_SHOW_GUILD_VIEW:this.sender.GuildDataReq(),this.sender.GuildIncenseLogReq()}},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},btn_3:function(){this.selectToggle(2)},btn_4:function(){this.selectToggle(3)},selectToggle:function(e){this.send(this.Evts.V_SWITCH_PAGE,e)},checkAlert:function(){this.spotAlert.alert=!game.guildData.id}});e=game.Sender.extends({ipc:function(){this.msg={GuildDataReq:null,GuildModelReq:null,AgreeMergeReq:null,GuildIncenseLogReq:null}},guildTransferMasterReq:function(e){var t=game.pb.GuildTransferMasterRequest;t.memberId=e,b8e.net.getBytes().writeProtobuf(t)},guildSettingReq:function(e,t){var a=game.pb.GuildSettingRequest;a.power=e,a.state=t,b8e.net.getBytes().writeProtobuf(a)}}),b8e.module.registerControl(game.ME.Guild,t,game.GuildEvts,e),b8e.RC("$$game","$$GuildSender",e)}(),function(){var e=game.Control.extends({lastRecTime:0,init:function(){this.data=game.guildData,this.spotAlert=game.spotAlert.set(game.SAE.GUILD_MAP,game.SAE.GUILD),this.spotAlert2=game.spotAlert.set(game.SAE.GUILD_HALL,game.SAE.GUILD)},ipc:function(){var e=this;e.evts={Guild:{C_UPDATE_GUILD:e.updataGuild},GuildNotice:{C_UPDATE_NOTICE:e.updataNotice},GuildMember:{C_UPDATE_GUILD:e.updataGuild},GuildRename:{C_UPDATE_GUILD_NAME:e.updataGuild},GuildDonate:{C2C_JUMP_TO_MAP:e.guildMapBtn},GuildActive:{C2C_JUMP_TO_MAP:e.guildMapBtn}},e.handels={GuildRecruitmentResp:e.guildRecruitmentResp,GuildMapResp:e.guildMapResp}},guildRecruitmentResp:function(e){var t=e.readProtobuf(game.pb.GuildRecruitmentResponse);if(0<t.code){game.notice.noticeError(t.code)}},guildMapResp:function(e){var t=e.readProtobuf(game.pb.GuildMapResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.mapId;if(t.enter){var i=0,n=game.GuildMiscCfg.getData("guildMapId");if(n){i=0|+n.value}var s=game.SceneCfg.getData(i);if(s&&s.type===game.SceneType.GUILD_MAP);else b8e.error("\u519b\u56e2\u5730\u56fe\u7684type\u5fc5\u987b\u4e3a\uff1a"+game.SceneType.GUILD_MAP)}game.mainProcess.runSceneProcess(a),this.dpt(this.Evts.C_MAP_CHANGE)}},updataGuild:function(){this.send(this.Evts.V_UPDATE_GUILD)},updataNotice:function(){this.send(this.Evts.V_UPDATE_NOTICE)},guildLogBtn:function(){game.module.show(game.ME.GuildLogList)},changeNoticeBtn:function(){if(this.checkRank())game.module.show(game.ME.GuildNotice);else;},changeNameBtn:function(){if(this.checkRank())game.module.show(game.ME.GuildRename);else;},trickBtn:function(){if(this.checkRank()){var e=game.MarqueeLang.getData("guild_rec"),t=game.SysTime.curTime-this.lastRecTime;if(0==this.lastRecTime||t>1e3*e.sendCDTime){this.lastRecTime=game.SysTime.curTime,this.sender.GuildRecruitmentReq()}else{var a=game.Lang.get(3204,e.sendCDTime);game.notice.show(a)}}else;},checkApplyBtn:function(){if(this.checkRank())game.module.show(game.ME.GuildApplyList);else;},checkRank:function(){if(this.data.getMineRank()!=game.GuildRankType.MEMBER)return!0;return game.notice.show(1603),!1},guildDonateBtn:function(){game.module.show(game.ME.GuildDonate)},memberInfoBtn:function(){game.module.show(game.ME.GuildMember)},guildListBtn:function(){game.module.show(game.ME.GuildRank)},guildTaskBtn:function(){game.module.show(game.ME.GuildActive)},guildShopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.BULUO_SHOP)},guildMapBtn:function(){if(game.playBack.isInstanceFighting());else this.sender.GuildMapReq()},researchBtn:function(){game.module.show(game.ME.TribalResearch)},assistBtn:function(){game.module.show(game.ME.TribalAssist)},guildBossBtn:function(){game.module.show(game.ME.GuildNewBoss)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildRecruitmentReq:null,GuildMapReq:this.guildMapReqEnter}},guildMapReqEnter:function(){var e=game.pb.GuildMapRequest;e.enter=!0,this.write(e)}});b8e.module.registerControl(game.ME.GuildHall,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.data=game.guildData},ipc:function(){this.evts={},this.handels={GuildLogResp:this.guildLogResp}},notify:function(e){switch(e){case this.Evts.V_SHOW_GUILD_VIEW:this.showGuilView()}},guildLogResp:function(e){var t=e.readProtobuf(game.pb.GuildLogResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setGuildLogList(t.logs),this.send(this.Evts.V_UPDATE_LOG)},showGuilView:function(){this.sender.GuildLogReq()}}),t=game.Sender.extends({ipc:function(){this.msg={GuildLogReq:null}}});b8e.module.registerControl(game.ME.GuildLogList,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.data=game.guildData,this._alertOptions={lang:1677,okcb:this.onClickGameAlert,thisArg:this,align:1}},ipc:function(){this.evts={},this.handels={GuildLeaveResp:this.guildLeaveResp,GuildChangeRankResp:this.guildChangeRankResp,GuildKickResp:this.guildKickResp,GuildTransferMasterResp:this.guildTransferMasterResp}},notify:function(e,t,a){var i=this,n=i.Evts;game.GuildRankType;switch(e){case n.V_APPOINT:i.sender.GuildChangeRankReq(t,a-1);break;case n.V_KICK:i.sender.GuildKickReq(t);break;case n.V_DEMISE:i.sender.GuildTransferMasterReq(t,void 0);break;case n.V_DEMOTION:i.sender.GuildChangeRankReq(t,a+1)}},leaveBtn:function(){game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(){this.leaveGuildReq()},leaveGuildReq:function(){if(game.guildTeamData.isInTeam){var e=game.Lang.get(2622);game.notice.show(e)}else{var t=game.InstanceType,a=game.playBack.getCurInstType();if(a&&game.playBack.isInstanceFighting(!1)){if(a==t.GUILD||a==t.GUILD_MAP||a==t.GUILD_BOSS){return void game.notice.show(9164)}}var i=game.sceneData.getSceneType();if(i&&i==game.SceneType.GUILD_MAP){game.notice.show(9165)}else this.sender.GuildLeaveReq()}},guildChangeRankResp:function(e){var t=e.readProtobuf(game.pb.GuildChangeRankResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.changeRank(t.memberId,t.rank),this.send(this.Evts.V_UPDATE_LIST)},guildKickResp:function(e){var t=e.readProtobuf(game.pb.GuildKickMemberResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.kickMember(t.memberId),this.dpt(this.Evts.C_UPDATE_GUILD),this.send(this.Evts.V_UPDATE_LIST)},guildTransferMasterResp:function(e){var t=e.readProtobuf(game.pb.GuildTransferMasterResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.transferMaster(t.memberId),this.dpt(this.Evts.C_UPDATE_GUILD),this.send(this.Evts.V_UPDATE_LIST)},guildLeaveResp:function(e){var t=e.readProtobuf(game.pb.GuildLeaveResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.clearData(),game.guildNewBossData.clearData(),b8e.module.hideView(game.ME.Guild),b8e.module.hideView(this.moduleEnum),this.dpt(this.Evts.C2C_UPDATE_GUILD_ACTIVE)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildLeaveReq:null,GuildChangeRankReq:this.guildChangeRankReq,GuildKickReq:this.guildKickReq,GuildTransferMasterReq:this.guildTransferMasterReq}},guildChangeRankReq:function(e,t){var a=game.pb.GuildChangeRankRequest;a.memberId=e,a.rank=t,b8e.net.getBytes().writeProtobuf(a)},guildKickReq:function(e){var t=game.pb.GuildKickMemberRequest;t.memberId=e,b8e.net.getBytes().writeProtobuf(t)},guildTransferMasterReq:function(e){var t=game.pb.GuildTransferMasterRequest;t.memberId=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildMember,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({alterNotice:"",init:function(){this.data=game.guildData},ipc:function(){this.evts={},this.handels={GuildSetNoticeResp:this.guildSetNoticeResp}},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SHOW_GUILD_VIEW:a.showView();break;case a.Evts.V_CHECK_PASS:a.alterNotice=t,a.sender.GuildSetNoticeReq(a.alterNotice),game.module.hide(a.moduleEnum)}},showView:function(){this.alterNotice=""},saveBtn:function(){this.send(this.Evts.V_CHECK_PASS)},guildSetNoticeResp:function(e){var t=e.readProtobuf(game.pb.GuildSetNoticeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(1671),this.data.setNotice(this.alterNotice),this.dpt(this.Evts.C_UPDATE_NOTICE)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildSetNoticeReq:this.guildSetNoticeReq}},guildSetNoticeReq:function(e){var t=game.pb.GuildSetNoticeRequest;t.notice=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildNotice,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.data=game.guildData,this._alertOptions={lang:1611,okcb:this.onClickGameAlert,thisArg:this}},ipc:function(){this.evts={},this.handels={GuildRankResp:this.guildRankResp,GuildMergeResp:this.guildMergeResp}},notify:function(e,t,a){var i=this;switch(e){case i.Evts.V_SHOW_GUILD_VIEW:i.showGuildView();break;case i.Evts.V_MERGER:if(i.data.getMineRank()!=game.GuildRankType.GUILDMASTER){return void game.notice.show(9166)}i.merge(t,a)}},showGuildView:function(){this.sender.GuildRankReq()},merge:function(e,t){this._alertOptions.langArgs=t,this._alertOptions.args=e,game.alert.showTwo(this._alertOptions)},onClickGameAlert:function(e){this.sender.GuildMergeReq(e)},guildRankResp:function(e){var t=e.readProtobuf(game.pb.GuildRankResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setRankGuild(t.list),this.send(this.Evts.V_UPDATE_LIST)},guildMergeResp:function(e){var t=e.readProtobuf(game.pb.GuildMergeResponse);if(0<t.code){game.notice.noticeError(t.code)}else;}}),t=game.Sender.extends({ipc:function(){this.msg={GuildRankReq:null,GuildMergeReq:this.guildMergeReq}},guildMergeReq:function(e){var t=game.pb.GuildMergeRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildRank,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.data=game.guildData},ipc:function(){this.evts={},this.handels={GuildRecommendResp:this.guildRecommendResp,GuildJoinResp:this.guildJoinResp,GuildCancelResp:this.guildCancelResp}},notify:function(e,t){var a=this,i=a.Evts;switch(e){case i.V_SHOW_GUILD_VIEW:a.showGuilView();break;case i.V_APPLY_JOIN:a.sender.GuildJoinReq(t);break;case i.V_CANCEL_JOIN:a.sender.GuildCancelReq(t)}},guildRecommendResp:function(e){var t=e.readProtobuf(game.pb.GuildRecommendResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setRecommendGuild(t),this.send(this.Evts.V_UPDATE_LIST)},guildJoinResp:function(e){var t=e.readProtobuf(game.pb.GuildJoinResponse);if(0<t.code){game.notice.noticeError(t.code)}else if(t.state==game.GuildApplyState.OPEN){game.module.hide(this.moduleEnum),game.module.show(game.ME.Guild),this.dpt(this.Evts.C_JOIN_GUILD)}else this.data.setRecommendGuildState(t.id,!0),this.send(this.Evts.V_UPDATE_LIST)},guildCancelResp:function(e){var t=e.readProtobuf(game.pb.GuildCancelResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setRecommendGuildState(t.id,!1),this.send(this.Evts.V_UPDATE_LIST)},showGuilView:function(){this.sender.GuildRecommendReq()},createGuildBtn:function(){game.module.show(game.ME.CreateGuild)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildRecommendReq:null,GuildJoinReq:this.guildJoinReq,GuildCancelReq:this.guildCancelReq}},guildJoinReq:function(e){var t=game.pb.GuildJoinRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)},guildCancelReq:function(e){var t=game.pb.GuildCancelRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildRecommend,e,game.GuildEvts,t)}(),function(){var e=game.Control.extends({alterName:"",renameCost:0,init:function(){var e=game.GuildMiscCfg.getData("guildRenameCost");if(e){this.renameCost=0|e.value}this.data=game.guildData},ipc:function(){this.handels={GuildRenameResp:this.guildRenameResp}},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SHOW_GUILD_VIEW:a.showView();break;case a.Evts.V_CHECK_PASS:a.alterName=t,a.checkPass()}},showView:function(){this.alterName=""},renameBtn:function(){this.send(this.Evts.V_CHECK_PASS)},checkPass:function(){if(game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,this.renameCost))this.sender.GuildRenameReq(this.alterName),game.module.hide(this.moduleEnum);else;},guildRenameResp:function(e){var t=e.readProtobuf(game.pb.GuildRenameResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.data.setName(this.alterName),this.dpt(this.Evts.C_UPDATE_GUILD_NAME)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildRenameReq:this.guildRenameReq}},guildRenameReq:function(e){var t=game.pb.GuildRenameRequest;t.name=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildRename,e,game.GuildEvts,t)}(),function(){var e=b8e.Object.extends({guildName:"",guildLv:1,initData:function(){var e,t=this;if(t.createVipList=[],e=game.GuildMiscCfg.getData("guildCreateVip1")){var a=0|e.value;t.createVipList.push(a)}if(e=game.GuildMiscCfg.getData("guildCreateVip2")){var i=0|e.value;t.createVipList.push(i)}if(t.createCostList=[],e=game.GuildMiscCfg.getData("guildCreateCost1")){var n=0|e.value;t.createCostList.push(n)}if(e=game.GuildMiscCfg.getData("guildCreateCost2")){var s=0|e.value;t.createCostList.push(s)}if(e=game.GuildMiscCfg.getData("guildCreateLv")){t.secondCreateLv=0|e.value}},setGuildName:function(e){this.guildName=e},setSelectLv:function(e){this.guildLv=e},setSelectIndex:function(e){this.selectIndex=e},getCreateVip:function(e){if(!this.createVipList||this.createVipList.length<1){return 0}return this.createVipList[e]},getCreateCost:function(e){if(!this.createCostList||this.createCostList.length<1){return 0}return this.createCostList[e]}});game.createGuildData=game.createGuildData||new e}(),function(){var e;e=b8e.Object.extends({guildLv:0,creatCost:0,creatVip:0,setData:function(e,t,a){this.guildLv=e,this.creatCost=t,this.creatVip=a},getCfg:function(){return game.GuildCfg.getData(this.guildLv)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CreateGuildInfo",e)}(),function(){var e;e=b8e.Enum({OPEN:0,CLOSED:1,CHECK:2}),b8e.RC("$$game","$$GuildApplyState",e)}(),function(){var e;e=b8e.Enum({NONE:0,REFUSE:1,AGREE:2,ALL_AGREE:4,ALL_REFUSE:3}),b8e.RC("$$game","$$GuildApplyType",e)}(),function(){var e=void 0;e=b8e.Object.extends({id:0,name:"",level:0,master:0,masterName:"",count:0,state:0,powerLimit:0,createTime:0,notice:"",fund:0,point:0,mineMemberInfo:null,infoList:null,membersMap:null,guildInfoList:null,reqs:null,guildInfoMap:null,guildRankInfoMap:null,applyInfoMap:null,applyInfoList:null,logsInfoList:null,skillInfoMap:null,skillInfoList:null,studyingMembers:null,ctor:function(){var e=this;e._super(),e.membersMap=b8e.HashMap.get(),e.guildInfoMap=b8e.HashMap.get(),e.guildRankInfoMap=b8e.HashMap.get(),e.applyInfoMap=b8e.HashMap.get(),e.infoList=[],e.reqs=[],e.guildInfoList=[],e.applyInfoList=[],e.logsInfoList=[],e.guildQuestList=[],e.skillInfoMap=b8e.HashMap.get(),e.skillInfoList=[]},setGuildData:function(e){var t=this;if(t.id=e.id,t.name=e.name,t.level=e.level,t.master=e.master,t.masterName=e.masterName,t.count=e.count,t.state=e.state,t.point=e.point,t.powerLimit=e.powerLimit,t.createTime=e.createTime,t.studyingMembers=e.studyingMembers,""==e.notice){t.notice=game.Lang.get(1665)}else t.notice=e.notice;if(t.fund=e.fund,t.membersMap.clear(),e.members||e.members.length<1)for(var a,i,n=game.mainRoleData.id,s=e.members.length,o=e.members,r=0;r<s;r++){if(i=o[r],!t.infoList[r]){t.infoList[r]=new game.MemberInfo}if((a=t.infoList[r]).setData(i),i.id==n){t.mineMemberInfo=a}t.membersMap.set(a.id,a)}game.tribalResearchData.setAssistData(t.studyingMembers)},initSkillList:function(){},setRecommendGuild:function(e){var t=this;t.reqs=e.reqs,t.guildInfoMap.clear();var a=e.list;if(a&&0<a.length)for(var i,n,s=a.length,o=0;o<s;o++){if(i=a[o],!t.guildInfoList[o]){t.guildInfoList[o]=new game.GuildItemInfo}(n=t.guildInfoList[o]).setData(i),n.isReq=-1!=t.reqs.indexOf(i.id),t.guildInfoMap.set(n.id,n)}},setRankGuild:function(e){var t=this;if(t.guildRankInfoMap.clear(),e&&0<e.length)for(var a,i,n=e.length,s=0;s<n;s++){if(a=e[s],!t.guildInfoList[s]){t.guildInfoList[s]=new game.GuildItemInfo}(i=t.guildInfoList[s]).setData(a),t.guildRankInfoMap.set(i.id,i)}},kickMember:function(e){this.membersMap.has(e)&&(this.membersMap.del(e),this.count--)},newMember:function(e){var t=this,a=t.membersMap.count();if(e&&0<e.length)for(var i,n,s,o=e.length,r=0;r<o;r++){if(n=e[r],s=a+r,!t.infoList[s]){t.infoList[s]=new game.MemberInfo}if((i=t.infoList[s]).setData(n),t.membersMap.has(i.id));else t.membersMap.set(i.id,i),t.count++}},changeRank:function(e,t){var a=this.membersMap.get(e);if(a)a.rank=t;else{b8e.warn("\u6539\u53d8\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u73a9\u5bb6\u804c\u4f4d")}},setNotice:function(e){this.notice=e},setName:function(e){this.name=e},setApplyList:function(e){var t=this;if(t.applyInfoMap.clear(),e&&0<e.length)for(var a,i,n=e.length,s=0;s<n;s++){if(a=e[s],!t.applyInfoList[s]){t.applyInfoList[s]=new game.MemberInfo}(i=t.applyInfoList[s]).setData(a),t.applyInfoMap.set(i.id,i)}},guildHandleReq:function(e,t){var a=game.GuildApplyType;switch(e){case a.AGREE:case a.REFUSE:if(t&&0<t.length)for(var i,n=t.length,s=0;s<n;s++){i=t[s],this.applyInfoMap.del(i)}break;case a.ALL_AGREE:case a.ALL_REFUSE:this.applyInfoMap.clear()}},transferMaster:function(a){var i=this,n=game.GuildRankType,s=i.master;i.membersMap.get(i.master).rank=n.MEMBER;var e=i.membersMap.get(a);e.rank=n.GUILDMASTER,i.master=a,i.masterName=e.name,i.membersMap.forEach(function(e,t){if(e==s){t.rank=n.MEMBER}if(e==a){t.rank=n.GUILDMASTER,i.masterName=t.name}t.flag=!t.flag},i)},setGuildLogList:function(e){if(e&&0<e.length)for(var t,a=20<e.length?20:e.length,i=0;i<a;i++){if(t=e[i],!this.logsInfoList[i]){this.logsInfoList[i]=new game.GuildLogInfo}this.logsInfoList[i].setData(t)}},setSetting:function(e,t){this.powerLimit=e,this.state=t},setRecommendGuildState:function(e,t){this.guildInfoMap.get(e).isReq=t},setFundData:function(e){this.level=e.level,this.fund=e.fund,this.point=e.point},getMemberList:function(){var e=this.membersMap.values();return e.sort(this.onMemberSort),e},getRecommendGuildList:function(){var e=this.guildInfoMap.values();e.sort(this.onGuildSort);for(var t=e.length,a=0;a<t;a++){e[a].rank=a+1}return e},getRankGuildList:function(){var e=this.guildRankInfoMap.values();e.sort(this.onGuildSort);for(var t=e.length,a=0;a<t;a++){e[a].rank=a+1}return e},getApplyList:function(){var e=this.applyInfoMap.values();return e.sort(this.onApplySort),e},getLogs:function(){return this.logsInfoList.sort(this.onLogsSort),this.logsInfoList},getMineRank:function(){if(this.mineMemberInfo)return this.mineMemberInfo.rank;return 0},getMineRankStr:function(){var e;if(!this.mineMemberInfo){return game.Lang.get(9024)}var t=game.GuildRankType;switch(this.mineMemberInfo.rank){case t.GUILDMASTER:e=game.Lang.get(1612);break;case t.ZHANGLAO:e=game.Lang.get(1613);break;case t.MEMBER:e=game.Lang.get(1614);break;default:e=""}return e},getMineScore:function(){if(this.mineMemberInfo)return this.mineMemberInfo.score;return 0},getSkillCount:function(){return this.skillInfoMap.count()},getSkillData:function(e){return this.skillInfoMap.get(e)},getMinSkillGroup:function(){return this.minSkillGroup},getSkillDatas:function(){return this.skillInfoList},getGuildLevel:function(){return this.level},clearData:function(){var e=this;e.id=0,e.name="",e.level=0,e.master=0,e.masterName="",e.count=0,e.state=0,e.powerLimit=0,e.createTime=0,e.notice="",e.fund=0},onGuildSort:function(e,t){if(e.level!=t.level){return t.level-e.level}if(e.fund==t.fund)return e.createTime-t.createTime;return t.fund-e.fund},onMemberSort:function(e,t){if(e.rank!=t.rank){return e.rank-t.rank}if(e.logoutTime==t.logoutTime){return t.score-e.score}if(0==e.logoutTime){return-1}if(0!=t.logoutTime)return t.score-e.score;return 1},onApplySort:function(e,t){return e.power-t.power},onLogsSort:function(e,t){return t.time-e.time},hasGuild:function(){return 0<this.id},isLeader:function(){if(!this.hasGuild())return!1;var e=game.GuildRankType,t=this.getMineRank();return t==e.GUILDMASTER||t==e.ZHANGLAO},checkSpStr:function(e){return this.myReg||(this.myReg=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>\u300a\u300b/?~\uff01@#\uffe5\u2026\u2026&*\uff08\uff09\u2014\u2014|{}\u3010\u3011\u2018\uff1b\uff1a\u201d\u201c'\u3002\uff0c\u3001\uff1f ]")),!!this.myReg.test(e)&&(game.notice.show(52214),!0)}}),game.guildData=game.guildData||new e,b8e.RC("$$game","$$GuildData",e)}(),function(){var e;e=b8e.Object.extends({id:0,name:"",level:0,master:0,masterName:"",count:0,state:0,powerLimit:0,isReq:!1,rank:0,ctor:function(){this._super()},setData:function(e){var t=this;t.isReq=!1,t.id=e.id,t.name=e.name,t.level=e.level,t.master=e.master,t.count=e.count,t.state=e.state,t.powerLimit=e.powerLimit,t.createTime=e.createTime,t.masterName=e.masterName}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildItemInfo",e)}(),function(){var e;e=b8e.Object.extends({type:0,time:0,ctor:function(){this._super()},setData:function(e){this.type=e.type,this.time=e.time,this.logData=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildLogInfo",e)}(),function(){var e;e=b8e.Enum({JOIN:0,LEAVE:1,KICK:2,LEVEL_UP:3,CHANGE_RANK:4}),b8e.RC("$$game","$$GuildLogType",e)}(),function(){var e;e=b8e.Enum({GUILDMASTER:0,ZHANGLAO:1,MEMBER:2}),b8e.RC("$$game","$$GuildRankType",e)}(),function(){var e;e=b8e.Object.extends({id:0,name:"",head:"",level:0,power:0,rank:0,logoutTime:0,flag:!1,score:0,isMale:!1,ctor:function(){this._super()},setData:function(e){var t=this;if(t.id=e.id,t.name=e.name,t.head=e.head,t.isMale=e.isMale,t.level=e.level,t.rank=e.rank,t.power=e.power,0<e.logoutTime){var a=game.SysTime.curTime;t.logoutTime=a-e.logoutTime}else t.logoutTime=e.logoutTime;t.score=e.score}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$MemberInfo",e)}(),function(){var e=game.View.extends({secondCreateLv:2,rightDesc:"",_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(507),this.toggles={leftPageSelect:null,rightPageSelect:null}},init:function(){var e,t=this;if(e=game.GuildMiscCfg.getData("guildCreateDesc")){t.rightDesc=e.value}if(this.setLeftPage(),this.setRightPage(),!this.skin.editBox);},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SWITCH_PAGE:a.toggleSelect(t);break;case a.Evts.V_CREATE_GUILD:a.checkCreate()}},onShow:function(){this.skin.editBox.string="",this.send(this.Evts.V_SHOW_GUILD_VIEW)},setLeftPage:function(){var e=this.skin,t=game.Lang,a=game.createGuildData,i=game.CCommonUtil.replaceChineseNum(1),n=a.getCreateVip(0),s=a.getCreateCost(0),o=game.GuildLvCfg.getData(1);if(o)e.leftTitle.string=t.get(1615,i),e.leftVipDesc.string=t.get(1616,n),e.leftCount.string=t.get(1617,o.maxMembers),e.leftCost.string=t.get(1618,s);else;},setRightPage:function(){var e=this,t=e.skin,a=game.Lang,i=game.createGuildData;e.secondCreateLv=i.secondCreateLv;var n=game.CCommonUtil.replaceChineseNum(e.secondCreateLv),s=i.getCreateVip(1),o=i.getCreateCost(1),r=game.GuildLvCfg.getData(e.secondCreateLv);if(r)t.rightTitle.string=a.get(1615,n),t.rightVipDesc.string=a.get(1616,s),t.rightCount.string=a.get(1617,r.maxMembers),t.rightCost.string=a.get(1618,o),t.skinDesc.string=e.rightDesc.replace("$",e.secondCreateLv);else;},checkCreate:function(){var t=this,a=t.skin.editBox.string;if(-1<a.indexOf(" ")){game.notice.show(1678)}else if(""!==a){game.guildData.checkSpStr(a)||game.sdk.msgSecCheck(a,function(e){e&&t.send(t.Evts.V_CHECK_PASS,a)},t)}else{game.notice.show(1604)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CreateGuild,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(508),this.setSize(602,142)},init:function(){var e=this;e.head=b8e.Sprite.get(),e.head.addToParent(e.skin.head),e.head.setAnchor(.5,.5)},setData:function(){var e=this,t=e.skin,a=e.data,i=game.Lang;t.name.string=i.get(1619,a.name,a.level),t.power.string=i.get(1620,a.power);var n=game.ResCfg.getHead(a.isMale);e.head.loadTexture(n)},agreeBtn:function(){this.send(game.GuildEvts.V_AGREE,this.data.id)},refuseBtn:function(){this.send(game.GuildEvts.V_REFUSE,this.data.id)}}),b8e.RC("$$game","$$GuildApplyListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(509)},init:function(){var e=this,t=e.guildList=new game.List;t.itemRender=game.GuildApplyListItem,t.addToParent(e.skin.list),t.bindEnum=game.ME.GuildApplyList,e.patt=/^[0-9]*[1-9][0-9]*$/;var a=game.GuildMiscCfg.getData("guildPowerLimit");if(a){e.limitPower=0|a.value}},notify:function(e){var t=this;switch(e){case t.Evts.V_UPDATE_LIST:t.updataList();break;case t.Evts.V_UPDATE_GUILD_SETTING:t.updataSetting();break;case t.Evts.V_CHECK_PASS:t.checkPass()}},onShow:function(){this.send(this.Evts.V_SHOW_GUILD_VIEW),this.updataSetting()},onHide:function(){},updataList:function(){this.list=game.guildData.getApplyList(),this.guildList.setData(this.list)},updataSetting:function(){var e=this,t=game.guildData;e.skin.autoImg.node.active=t.state==game.GuildApplyState.OPEN,e.skin.power.string=t.powerLimit},checkPass:function(){var e=this,t=e.skin.power.string;if(""!==t){if(e.patt.test(t)){var a=0|t;if(e.limitPower>a){game.notice.show(1672,e.limitPower)}else e.send(e.Evts.V_CHECK_PASS,t)}else{game.notice.show(1607)}}else{game.notice.show(1606)}},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.GuildApplyList,e)}(),function(){var e=game.View.extends({ctor:function(){var e=this;e._super(510),e.spotAlerts={GUILD_MAP:e._guildMapAlert,GUILD_APPLY:e._guildApplyAlert,GUILD_DONATE:e._guildDonateAlert,SHOP_GUILD:e.shopAlert,GUILD_ACTIVE:e.guildActiveAlert,TRIBAL_ASSIST:e._assistAlert,TRIBAL_RESEARCH:e.researchAlert,GUILD_NEW_BOSS:e.guildNewBossAlert}},init:function(){},notify:function(e){var t=this;switch(e){case t.Evts.V_UPDATE_GUILD:t.setGuildInfo(),t.setNotice();break;case t.Evts.V_UPDATE_NOTICE:t.setNotice()}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},_guildMapAlert:function(e){this.skin.guildMapRedSpot.active=e.alert},_guildApplyAlert:function(e){this.skin.guildApplyRedSpot.active=e.alert},_guildDonateAlert:function(e){this.skin.guildDonateRedSpot.active=e.alert},_assistAlert:function(e){this.skin.assistRedSpot.active=e.alert},researchAlert:function(e){this.skin.researchRedSpot.active=e.alert},guildNewBossAlert:function(e){this.skin.guildBossAlert.active=e.alert},guildActiveAlert:function(e){this.skin.guildActiveRedSpot.active=e.alert},onShow:function(){this.setGuildInfo(),this.setNotice()},onHide:function(){},setNotice:function(){this.skin.notice.string=game.guildData.notice},setGuildInfo:function(){var e=this.skin,t=game.guildData,a=game.Lang;if(e.name.string=t.name,e.masterName.string=t.masterName,e.level.string=t.level,t.level<1);else{var i=game.GuildLvCfg.getData(t.level);if(i){e.count.string=a.get(1621,t.count,i.maxMembers);var n=game.GuildLvCfg.getMaxLv(),s=t.level<n?t.level+1:n,o=game.GuildLvCfg.getData(s);e.exp.string=a.get(1621,t.fund,o.fund),e.point.string=t.point}else;}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuildHall,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(511),this.setSize(602,96)},setData:function(){var e=this.skin,t=this.data,a=game.Lang,i=(game.GuildLvCfg.getMaxLv(),t.level),n=game.GuildLvCfg.getData(i);if(n){var s=t.rank,o=game.Color.BLACK;switch(s){case 1:o=game.Color.YELLOW;break;case 2:o=game.Color.PURPLE;break;case 3:o=game.Color.GREEN}e.guildName.string=game.HtmlUtil.getText(o,a.get(1675,t.name,t.level)),e.master.string=a.get(1622,t.masterName),e.count.string=a.get(1623,t.count,n.maxMembers);var r=game.CCommonUtil.replaceNum(t.powerLimit,0),g=game.GuildApplyState;switch(t.state){case g.OPEN:e.applyStr.string=a.get(1624,r);break;case g.CLOSED:e.applyStr.string=a.get(1625);break;case g.CHECK:e.applyStr.string=a.get(1626)}e.rank.string=3<s?s:"",e.applyBtn.node.active=!t.isReq,e.cancelBtn.node.active=t.isReq,this.setRankBg(s)}else;},setRankBg:function(e){var t=this.skin,a=3<e?4:e;if(!this.flagIcon){var i=this.flagIcon=b8e.Sprite.get();i.addToParent(t.flagIcon),i.setAnchor(.5,.5)}var n=game.ResCfg.getUrl(141,a);this.flagIcon.loadTexture(n)},applyBtn:function(){this.send(game.GuildEvts.V_APPLY_JOIN,this.data.id)},cancelBtn:function(){this.send(game.GuildEvts.V_CANCEL_JOIN,this.data.id)}}),b8e.RC("$$game","$$GuildListItem",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(512),this.setSize(600,94)},init:function(){this.format="Y-M-D h:m:s"},setData:function(){var e,t=this.skin,a=this.data,i=game.Lang,n=this.data.logData,s=game.GuildLogType;switch(t.time.string=b8e.TimeUtil.formatTimestamp(a.time,this.format),a.type){case s.JOIN:e=i.get(1628,n.join.name);break;case s.LEAVE:e=i.get(1629,n.leave.name);break;case s.KICK:e=i.get(1630,n.kick.name,n.kick.memberName);break;case s.LEVEL_UP:e=i.get(1631,n.levelUp.level);break;case s.CHANGE_RANK:var o=game.CCommonUtil.getGuildRankText(n.changeRank.rank);e=i.get(1632,n.changeRank.name,o);break;default:e=""}t.log.string=e}}),b8e.RC("$$game","$$GuildLogItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(513)},init:function(){var e=this.guildList=new game.List;e.itemRender=game.GuildLogItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.GuildLogList},notify:function(e){switch(e){case this.Evts.V_UPDATE_LOG:this.updataList()}},onShow:function(){this.send(this.Evts.V_SHOW_GUILD_VIEW)},onHide:function(){},updataList:function(){this.list=game.guildData.getLogs(),this.guildList.setData(this.list)},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.GuildLogList,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(514),this.setSize(602,142)},init:function(){var e=this;e.head=b8e.Sprite.get(),e.head.addToParent(e.skin.head),e.head.setAnchor(.5,.5)},setData:function(){var e=this,t=e.skin,a=e.data,i=game.Lang,n="";switch(a.rank){case game.GuildRankType.GUILDMASTER:n=game.Lang.get(1612);break;case game.GuildRankType.ZHANGLAO:n=game.Lang.get(1613);break;case game.GuildRankType.MEMBER:n=game.Lang.get(1614)}if(t.name.string=i.get(1633,n,a.name,a.level),t.power.string=a.power,0<a.logoutTime){var s=game.TimeUtil.formatTimeSpace(a.logoutTime,1);t.time.string=i.get(1634,s)}else t.time.string=i.get(1635);var o=game.ResCfg.getHead(a.isMale);e.head.loadTexture(o),t.score.string=i.get(1636,a.score),t.power.string=i.get(1637,a.power),e.setBtnActive()},setBtnActive:function(){var e=this.skin,t=this.data,a=game.guildData.getMineRank(),i=game.GuildRankType;switch(e.appointBtn.node.active=!1,e.kickBtn.node.active=!1,e.demiseBtn.node.active=!1,e.demotionBtn.node.active=!1,a){case i.GUILDMASTER:if(t.rank==i.ZHANGLAO){e.demiseBtn.node.active=!0,e.demotionBtn.node.active=!0}else if(t.rank==i.MEMBER){e.appointBtn.node.active=!0,e.kickBtn.node.active=!0}break;case i.ZHANGLAO:if(t.rank==i.MEMBER){e.appointBtn.node.active=!0,e.kickBtn.node.active=!0}}},appointBtn:function(){this.str=game.Lang.get(1638,this.data.name),this.clickBtn(this.str,game.GuildEvts.V_APPOINT)},kickBtn:function(){this.str=game.Lang.get(1639,this.data.name),this.clickBtn(this.str,game.GuildEvts.V_KICK)},demiseBtn:function(){this.str=game.Lang.get(1641,this.data.name),this.clickBtn(this.str,game.GuildEvts.V_DEMISE)},demotionBtn:function(){this.str=game.Lang.get(1640,this.data.name),this.clickBtn(this.str,game.GuildEvts.V_DEMOTION)},clickBtn:function(e,t){game.GuildMemberTipsView.inst().showView(this.click,e,this,t)},click:function(e,t){e.send(t,e.data.id,e.data.rank)}}),b8e.RC("$$game","$$GuildMemberItem",e)}(),function(){var e=void 0;(e=game.View.extends({ctor:function(){this._super(515)},showView:function(e,t,a,i){var n=this;if(n._clickCb=e,n.str=t,n.thisArg=a,n.evt=i,n.parent)n.show();else{game.GameViewMgr.inst().showView(n)}},onShow:function(){this.skin.desc.string=this.str},sureBtn:function(){this._clickCb.call(this,this.thisArg,this.evt),this.removeFromParent()},closeBtn:function(){this.removeFromParent()},cancelBtn:function(){this.removeFromParent()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height))}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$GuildMemberTipsView",e)}(),function(){var e=game.View.extends({mineMemberInfo:null,memberInfoList:null,ctor:function(){this._super(516)},init:function(){var e=this.guildList=new game.List;e.itemRender=game.GuildMemberItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.GuildMember},notify:function(e){switch(e){case this.Evts.V_UPDATE_LIST:this.updateMemberList()}},onShow:function(){var e=this,t=e.skin,a=game.guildData,i=a.getMineRankStr(),n=a.getMineScore();t.mineRank.string=game.Lang.get(1642,i),t.mineScore.string=game.Lang.get(1643,n),e.updateMemberList()},onHide:function(){},updateMemberList:function(){var e=this;e.memberInfoList=game.guildData.getMemberList(),e.guildList.setData(e.memberInfoList)},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.GuildMember,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(517)},notify:function(e){switch(e){case this.Evts.V_CHECK_PASS:this.checkPass()}},onShow:function(){this.skin.editBox.string=game.guildData.notice,this.send(this.Evts.V_SHOW_GUILD_VIEW)},onHide:function(){},checkPass:function(){var t=this,a=t.skin.editBox.string;if(""!==a)game.sdk.msgSecCheck(a,function(e){e&&t.send(t.Evts.V_CHECK_PASS,a)},t);else{game.notice.show(1608)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GuildNotice,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(518),this.setSize(600,93)},setData:function(){var e=this.skin,t=this.data,a=game.Lang,i=game.GuildLvCfg.getMaxLv(),n=t.level<i?t.level:i,s=game.GuildLvCfg.getData(n);if(s){var o=t.rank,r=game.Color.BLACK;switch(o){case 1:r=game.Color.YELLOW;break;case 2:r=game.Color.PURPLE;break;case 3:r=game.Color.GREEN}e.guildName.string=game.HtmlUtil.getText(r,a.get(1675,t.name,t.level)),e.master.string=a.get(1622,t.masterName),e.count.string=a.get(1623,t.count,s.maxMembers),e.rank.string=3<o?o:"",e.mergerBtn.node.active=t.id!=game.guildData.id,this.setRankBg(o)}else;},setRankBg:function(e){var t=this.skin,a=3<e?4:e;if(!this.flagIcon){var i=this.flagIcon=b8e.Sprite.get();i.addToParent(t.flagIcon),i.setAnchor(.5,.5)}var n=game.ResCfg.getUrl(141,a);this.flagIcon.loadTexture(n)},mergerBtn:function(){this.send(game.GuildEvts.V_MERGER,this.data.id,this.data.name)}}),b8e.RC("$$game","$$GuildRankListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(519)},init:function(){var e=this.guildList=new game.List;e.itemRender=game.GuildRankListItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.GuildRank},notify:function(e){switch(e){case this.Evts.V_UPDATE_LIST:this.updataList()}},onShow:function(){this.send(this.Evts.V_SHOW_GUILD_VIEW)},onHide:function(){},updataList:function(){this.list=game.guildData.getRankGuildList(),this.guildList.setData(this.list)},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.GuildRank,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(520)},init:function(){var e=this.guildList=new game.List;e.itemRender=game.GuildListItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.GuildRecommend},notify:function(e){switch(e){case this.Evts.V_UPDATE_LIST:this.updataList()}},onShow:function(){this.send(this.Evts.V_SHOW_GUILD_VIEW)},onHide:function(){},updataList:function(){this.list=game.guildData.getRecommendGuildList(),this.guildList.setData(this.list)},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.GuildRecommend,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(521)},init:function(){if(!this.skin.editBox);},notify:function(e){switch(e){case this.Evts.V_CHECK_PASS:this.checkPass()}},onShow:function(){this.guildRenameCost||(this.guildRenameCost=+game.CfgUtil.getMiscValue(game.GuildMiscCfg,"guildRenameCost")),this.skin.costNum.string=this.guildRenameCost,this.skin.editBox.string="",this.send(this.Evts.V_SHOW_GUILD_VIEW)},onHide:function(){},checkPass:function(){var t=this,a=t.skin.editBox.string;if(-1<a.indexOf(" ")){game.notice.show(1678)}else if(""!==a){game.guildData.checkSpStr(a)||game.sdk.msgSecCheck(a,function(e){e&&t.send(t.Evts.V_CHECK_PASS,a)},t)}else{game.notice.show(1604)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GuildRename,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(522),this.toggles={toggle_btn_1:game.ME.GuildHall,toggle_btn_2:game.ME.GuildIncense,toggle_btn_3:game.ME.GuildInstance,toggle_btn_4:game.ME.GuildSkill},this.spotAlerts={GUILD_HALL:this._guildHallAlert,GUILD_INCENSE:this._guildIncenseAlert,GUILD_INSTANCE:this._guildInsAlert,GUILD_SKILL:this._guildSkillAlert}},init:function(){},notify:function(e,t){switch(e){case this.Evts.V_SWITCH_PAGE:if(2==t&&game.guildTeamData.isInTeam)return void(b8e.module.isShowView(game.ME.GuildTeamDetailsView)||game.module.show(game.ME.GuildTeamDetailsView));this.toggleSelect(t)}},_guildHallAlert:function(e){this.skin.guildHallRedSpot.node.active=e.alert},_guildIncenseAlert:function(e){this.skin.guildIncenseRedSpot.node.active=e.alert},_guildInsAlert:function(e){this.skin.guildTeamRedSpot.node.active=e.alert},_guildSkillAlert:function(e){this.skin.guildSkillRedSpot.node.active=e.alert},onShow:function(){this.toggleSelect(0),this.send(this.Evts.V_SHOW_GUILD_VIEW)},toggleSelect:function(e){var t=this;if(t._super(e))switch(e){case 2:t.skin.teamTitle.active=!0;break;default:t.skin.teamTitle.active=!1}},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.Guild,e)}(),function(){var e;e=b8e.Enum({None:0,V2C_GET_PRIZE:-1,C2V_UPDATE_GUILD_ACTIVE:-1,C2V_INIT_DATA:-1,C2V_UPDATE_DAILY_GUILD_ACTIVE:-1,C2V_SWITCH_PAGE:-1,C2V_TASK_NUM_UPDATE:-1,V2C_JUMP_TO_MAP:-1,C2C_JUMP_TO_MAP:-1}),b8e.RC("$$game","$$GuildActiveEvts",e)}(),function(){var e;e=b8e.Enum({None:0,GuildBoss:1,Green:2,Blue:3,Purple:4,GuildTeam:5,GuildMonster:6,GuildCollect:7,GuildIncense:8}),b8e.RC("$$game","$$GuildActiveType",e)}(),function(){var e=b8e.Object.extends({activeLv:0,exp:0,taskList:null,activeAwards:null,todayExp:0,setActiveData:function(e){var t=this;if(!t.initData){t.initData=!0,t.prizeList=[],t.prizePool=[],t.taskList=[],t.activeList=[],t.levelPool=[],t.levelList=[],t.taskMap=b8e.HashMap.get(),t.activeMap=b8e.HashMap.get()}t.activeLv=e.activeLv,t.exp=e.exp,t.taskNums=e.taskNum,t.todayExp=e.todayExp,t.activeAwards=e.activeAwards,t.setTaskList(),t.setActiveList(),t.setPrizeList(),t.refreshLevelList()},setTaskList:function(){var e,t,a=this,i=game.GuildActiveCfg.getDatas();if(!i||i.length<1){return null}a.taskList.length=0;for(var n=i.length,s=0;s<n;s++){if(e=i[s],t=a.taskMap.get(e.activeType)){t.clearData()}else t=new game.GuildTaskInfo,a.taskMap.set(e.activeType,t);t.setCfgData(e),a.taskList.push(t)}if(a.taskNums&&0<a.taskNums.length){var o,r;for(n=a.taskNums.length,s=0;s<n;s++){if(o=a.taskNums[s],r=a.taskMap.get(o.activeType))r.setNum(o.num);else;}}a.taskList.sort(this.taskSortFunc)},taskSortFunc:function(e,t){var a=e.getComplete();if(a==t.getComplete()){return e.id-t.id}if(a){return 1}return-1},getTaskList:function(){if(!this.taskList||this.taskList.length<0){return null}return this.taskList},taskNotify:function(e){if(this.taskMap){var t=this.taskMap.get(e.activeType);if(t){if(t.setNum(e.num),this.exp=e.exp,this.todayExp!=e.todayExp){this.todayExp=e.todayExp,this.setActiveList()}}else;}},getAward:function(e){var t=this;if(t.activeAwards.indexOf(e)<0){t.activeAwards.push(e);var a=t.activeMap.get(e);if(a){a.setGet(!0)}}this.setActiveList()},setActiveList:function(){var e,t,a,i=this,n=game.ActiveAwardCfg.getDatas();if(!n||n.length<1){return null}for(var s=n.length,o=0;o<s;o++){if(i.activeList[o])t=i.activeList[o];else{e=n[o],(t=new game.GuildDailyActiveInfo).setCfgData(e),i.activeList.push(t),i.activeMap.set(t.value,t)}a=-1<i.activeAwards.indexOf(t.value),t.setGet(a),t.setCurValue(this.todayExp)}i.activeList.sort(i.activeSortFunc)},activeSortFunc:function(e,t){if(e.getAward==t.getAward){return e.value-t.value}if(e.getAward){return 1}return-1},getActiveList:function(){return this.activeList},guildActiveUpgradeResp:function(e){var t=this;t.activeLv=e.activeLv,t.exp=e.exp,t.refreshLevelList(),t.setPrizeList()},refreshLevelList:function(){for(var e,t,a=this,i=game.ActiveLvCfg.maxLv,n=a.levelList.length=0,s=1<a.activeLv-20?a.activeLv-20:1,o=a.activeLv+20>i?i:a.activeLv+20,r=s;r<=o;r++){if(!a.levelPool[n]){a.levelPool[n]=new game.GuildPreInfo}e=a.levelList[n]=a.levelPool[n],t=r<=a.activeLv,e.setData(r,t),n++}},getLevelList:function(){return this.levelList},setPrizeList:function(){var e=this,t=game.ActiveLvCfg.getData(e.activeLv+1);if(t){e.prizeList.length=0;var a=t.reward;if(a&&0<a.length)for(var i,n,s=a.length,o=0;o<s;o++){if(i=a[o],!e.prizePool[o]){e.prizePool[o]=new game.PrizeInfo}(n=e.prizePool[o]).setData(i.Id,i.Num,game.IconLayoutEnum.SHOW_NUM),e.prizeList.push(n)}}else;},getPrizeList:function(){return this.prizeList},getDailyActiveAlert:function(){var e=this;if(!e.activeList||e.activeList.length<1){return!1}for(var t,a=!1,i=e.activeList.length,n=0;n<i;n++){if((t=e.activeList[n]).value>e.todayExp){break}if(!(-1<e.activeAwards.indexOf(t.value))){a=!0;break}}return a},getActiveAlert:function(){var e=game.ActiveLvCfg.getMaxLv();if(this.activeLv>=e){return!1}var t=game.ActiveLvCfg.getData(this.activeLv+1);if(t)return this.exp>=t.exp;return!1}});game.guildActiveData=game.guildActiveData||new e}(),function(){var e,t=e=b8e.Object.extends({value:0,curValue:0,getAward:!1,setCfgData:function(e){this.value=e.value,this.cfg=e},setGet:function(e){this.getAward=e},setCurValue:function(e){this.curValue=e},getPrizeList:function(){var e=this;if(e.prizeList){return e.prizeList}e.prizeList=[];var t=e.cfg.reward;if(t&&0<t.length)for(var a,i,n=t.length,s=0;s<n;s++){a=t[s],(i=new game.PrizeInfo).setData(a.Id,a.Num,game.IconLayoutEnum.SHOW_NUM,0,game.IconSizeEnum.GRID_SIZE_84),e.prizeList.push(i)}return e.prizeList}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$GuildDailyActiveInfo",e)}(),function(){var e;e=b8e.Object.extends({lv:0,complete:!1,setData:function(e,t){this.lv=e,this.complete=t},getPrizeList:function(){var e=this;if(e.prizeList)e.prizeList.length=0;else{e.prizeList=[]}if(!e.prizePool){e.prizePool=[]}var t=game.ActiveLvCfg.getData(this.lv);if(!t){return null}var a=t.reward;if(a&&0<a.length)for(var i,n,s=a.length,o=0;o<s;o++){if(i=a[o],!e.prizePool[o]){e.prizePool[o]=new game.PrizeInfo}(n=e.prizePool[o]).setData(i.Id,i.Num,game.IconLayoutEnum.SHOW_NUM),e.prizeList.push(n)}return e.prizeList}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildPreInfo",e)}(),function(){var e;e=b8e.Object.extends({activeType:0,num:0,targetNum:0,exp:0,taskName:"",setCfgData:function(e){this.exp=e.exp,this.targetNum=e.targetNum,this.taskName=e.taskName,this.activeType=e.activeType},setNum:function(e){this.num=e},getComplete:function(){return this.num>=this.targetNum},clearData:function(){this.exp=0,this.targetNum=0,this.taskName="",this.activeType=0,this.num=0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildTaskInfo",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert1=game.spotAlert.set(game.SAE.GUILD_DAILY_ACTIVE,game.SAE.GUILD_ACTIVE),this.spotAlert2=game.spotAlert.set(game.SAE.GUILD_ACTIVE_UPGRADE,game.SAE.GUILD_ACTIVE_PAGE),this.spotAlert3=game.spotAlert.set(game.SAE.GUILD_ACTIVE_PAGE,game.SAE.GUILD_ACTIVE),this.spotAlert3=game.spotAlert.set(game.SAE.GUILD_ACTIVE,game.SAE.GUILD_HALL)},ipc:function(){this.evts={Guild:{C_INIT_GUILD_MODEL_DATA:this.initData}},this.handels={GuildActiveUpgradeResp:this.guildActiveUpgradeResp,GuildActiveAwardResp:this.guildActiveAwardResp,GuildActiveTaskNumMsg:this.guildActiveTaskNumMsg}},guildActiveUpgradeResp:function(e){var t=e.readProtobuf(game.pb.GuildActiveUpgradeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.guildActiveData.guildActiveUpgradeResp(t),this.checkGuildActiveAlert(),this.send(this.Evts.C2V_UPDATE_GUILD_ACTIVE)},guildActiveAwardResp:function(e){var t=e.readProtobuf(game.pb.GuildActiveAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.guildActiveData.getAward(t.value),this.checkDailyActiveAlert(),this.send(this.Evts.C2V_UPDATE_DAILY_GUILD_ACTIVE)},guildActiveTaskNumMsg:function(e){var t=e.readProtobuf(game.pb.GuildActiveTaskNumNotify);game.guildActiveData.taskNotify(t),this.checkGuildActiveAlert(),this.checkDailyActiveAlert(),this.send(this.Evts.C2V_TASK_NUM_UPDATE)},notify:function(e,t){switch(e){case this.Evts.V2C_GET_PRIZE:this.sender.GuildActiveAwardReq(t);break;case this.Evts.V2C_JUMP_TO_MAP:this.dpt(this.Evts.C2C_JUMP_TO_MAP)}},initData:function(){this.checkGuildActiveAlert(),this.checkDailyActiveAlert(),this.send(this.Evts.C2V_INIT_DATA)},upgradeBtn:function(){if(game.UpgradeUtil.checkEquipTooMuch());else{var e=game.ActiveLvCfg.getMaxLv(),t=game.guildActiveData.activeLv;if(e<=t);else{var a=game.ActiveLvCfg.getData(t+1);if(a)if(game.guildActiveData.exp<a.exp){game.notice.show(9170)}else this.sender.GuildActiveUpgradeReq();else;}}},awardPreBtn:function(){game.module.show(game.ME.GuildAwardPre)},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},selectToggle:function(e){this.send(this.Evts.C2V_SWITCH_PAGE,e)},checkDailyActiveAlert:function(){this.spotAlert1.alert=game.guildActiveData.getDailyActiveAlert()},checkGuildActiveAlert:function(){this.spotAlert2.alert=game.guildActiveData.getActiveAlert()}}),t=[game.ME.GuildAwardPre,game.ME.GuildActivePage,game.ME.GuildDailyActive],a=game.Sender.extends({ipc:function(){this.msg={GuildActiveUpgradeReq:null,GuildActiveAwardReq:this.guildActiveAwardReq}},guildActiveAwardReq:function(e){var t=game.pb.GuildActiveAwardRequest;t.value=e,this.write(t)}});b8e.module.registerControl(game.ME.GuildActive,e,game.GuildActiveEvts,a,t)}(),function(){var e=game.View.extends({_progressWidth:562,ctor:function(){this._super(523),this.spotAlerts={GUILD_ACTIVE_UPGRADE:this.guildActiveAlert}},guildActiveAlert:function(e){this.skin.spotAlert.active=e.alert},init:function(){var e=this,t=e.skin,a=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.PrizeListItem,a.addToParent(t.awardList);var i=e.taskList=new game.List;i.itemRender=game.GuildTaskItem,i.addToParent(t.taskList),i.bindEnum=game.ME.GuildActive},notify:function(e){var t=this;switch(e){case t.Evts.C2V_UPDATE_GUILD_ACTIVE:t.updataView();break;case t.Evts.C2V_TASK_NUM_UPDATE:t.setTaskList(),t.setProgress()}},onShow:function(){this.updataView()},onHide:function(){},updataView:function(){var e=this,t=e.skin,a=game.guildActiveData.activeLv;t.activeLvLab.string=game.Lang.get(1680,a);var i=game.ActiveLvCfg.getMaxLv(),n=i<=a;if(t.leftPage.active=!n,t.rightPage.active=!n,t.maxPage.active=n,e.setProgress(),e.setTaskList(),i<=a){var s=game.ActiveLvCfg.getData(i);e.setMaxSpriteStat(s)}else e.setLeftSpriteStat(),e.setRightSpriteStat(),e.setPrizeList()},setLeftSpriteStat:function(){var e=this,t=game.guildActiveData.activeLv,a=0<t;if(e.skin.notActiveLab.active=!a,e.skin.leftSprite.active=a){var i=game.ActiveLvCfg.getData(t);if(i){var n=e.getSpriteLab(i.spriteStat);e.skin.leftSprite.string=n}}},setRightSpriteStat:function(){var e=game.guildActiveData.activeLv,t=game.ActiveLvCfg.getData(e+1);if(t){var a=this,i=a.getSpriteLab(t.spriteStat);a.skin.rightSprite.string=i}else;},setMaxSpriteStat:function(e){if(e){var t=this,a=t.getSpriteLab(e.spriteStat);t.skin.maxSprite.string=a}else;},getSpriteLab:function(e){if(!e){return""}var a,i=this,t=e.getSpriteStats();return i._spriteStr="",t.forEach(function(e,t){e=+e,a=game.AttrRulesCfg.getData(e),i._spriteStr+=game.Lang.get(1682,a.name,t)+"<br/>"},i),i._spriteStr},setTaskList:function(){var e=this;e.taskInfoList=game.guildActiveData.getTaskList(),e.taskList.setData(e.taskInfoList)},setPrizeList:function(){var e=this;e.prizeInfoList=game.guildActiveData.getPrizeList(),e.prizeList.setData(e.prizeInfoList)},setProgress:function(){var e=game.ActiveLvCfg.getMaxLv(),t=game.guildActiveData.activeLv;t=t<e?t+1:e;var a=game.ActiveLvCfg.getData(t);if(a){var i=this.skin,n=game.guildActiveData.exp;i.progressLab.string=n+"/"+a.exp;var s=n/a.exp;s=1<s?1:s,b8e.Tween.kill(i.progress),b8e.Tween.get(i.progress).to({width:s*this._progressWidth},150)}else;},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuildActivePage,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(524),this.toggles={toggle_btn_1:game.ME.GuildActivePage,toggle_btn_2:game.ME.GuildDailyActive},this.spotAlerts={GUILD_ACTIVE_PAGE:this.guildActivePageAlert,GUILD_DAILY_ACTIVE:this.guildDailyActiveAlert}},guildActivePageAlert:function(e){this.skin.red_spot_1.node.active=e.alert},guildDailyActiveAlert:function(e){this.skin.red_spot_2.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.C2V_SWITCH_PAGE:this.toggleSelect(t)}},onShow:function(){this.toggleSelect(0)},onHide:function(){},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.GuildActive,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(525)},init:function(){var e=this,t=e.skin,a=e.list=new game.List;a.itemRender=game.GuildPreItem,a.addToParent(t.list)},notify:function(e){},onShow:function(){this.infoList=game.guildActiveData.getLevelList(),this.list.setData(this.infoList)},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.GuildAwardPre,e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(526),this.setSize(600,140)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.prizeList)},setData:function(){var e=this,t=e.skin,a=e.data;e.prizeInfoList=a.getPrizeList(),e.prizeList.setData(e.prizeInfoList),t.progress.string=game.Lang.get(1679,a.value,a.curValue,a.value);var i=a.curValue>=a.value;t.getBtnGray.active=!i,t.getBtn.active=i&&!a.getAward,t.getImg.active=i&&a.getAward},getBtn:function(){if(game.UpgradeUtil.checkEquipTooMuch());else this.send(game.GuildActiveEvts.V2C_GET_PRIZE,this.data.value)}}),b8e.RC("$$game","$$GuildDailyActiveItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(527)},init:function(){var e=this.list=new game.List;e.itemRender=game.GuildDailyActiveItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.GuildActive},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_DAILY_GUILD_ACTIVE:this.updateList()}},onShow:function(){this.updateList()},onHide:function(){},updateList:function(){this.infoList=game.guildActiveData.getActiveList(),this.list.setData(this.infoList)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuildDailyActive,e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(528),this.setSize(540,130)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.prizeList)},setData:function(){var e=this,t=e.skin,a=e.data;e.prizeInfoList=a.getPrizeList(),e.prizeList.setData(e.prizeInfoList),t.level.string=game.Lang.get(1681,a.lv),t.getImg.active=a.complete,t.uncompleteImg.active=!a.complete}}),b8e.RC("$$game","$$GuildPreItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(529),this.setSize(600,94)},init:function(){},setData:function(){var e=this.skin,t=this.data;e.name.string=t.taskName;var a=t.getComplete(),i=game.HtmlUtil.IsEnoughGOR(!a);e.progress.string=game.HtmlUtil.getText(i,t.num+"/"+t.targetNum),e.exp.string=game.Lang.get(9498,t.exp),e.gotoBtn.active=t.num<t.targetNum,e.completeImg.active=t.num>=t.targetNum},gotoBtn:function(){var e=this.data.activeType,t=game.GuildActiveType,a=!1;switch(e){case t.GuildBoss:game.module.show(game.ME.ActivitiesHall),game.module.hide(game.ME.GuildActive);break;case t.Green:case t.Blue:case t.Purple:game.module.show(game.ME.GuildExchange);break;case t.GuildTeam:a=!0,game.module.showToggle(game.ME.Guild,2);break;case t.GuildMonster:case t.GuildCollect:if(game.playBack.isInstanceFighting())return;a=!0,this.send(game.GuildActiveEvts.V2C_JUMP_TO_MAP);break;case t.GuildIncense:a=!0,game.module.showToggle(game.ME.Guild,1)}a&&game.module.hide(game.ME.GuildActive)}}),b8e.RC("$$game","$$GuildTaskItem",e)}(),function(){var e;e=b8e.Enum({None:0,V_DONATE:-1,V_UPDATE_ITEM:-1,C2C_JUMP_TO_MAP:-1}),b8e.RC("$$game","$$GuildDonateEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.guildDonateIds=game.GuildDonateCfg.getKeys("itemId"),this.spotAlert=game.spotAlert.set(game.SAE.GUILD_DONATE,game.SAE.GUILD_HALL)},ipc:function(){this.evts={Back:{C_BACK_UPDATE_ITEMINFO:this.updateItemInfo},Guild:{C2C_UPDATE_GUILD_ACTIVE:this.checkAlert},GuildMember:{C2C_UPDATE_GUILD_ACTIVE:this.checkAlert}},this.handels={GuildDonateResp:this.guildDonateResp}},notify:function(e,t){switch(e){case this.Evts.V_DONATE:this.sender.GuildDonateReq(t)}},guildDonateResp:function(e){var t=e.readProtobuf(game.pb.GuildDonateResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(1669)},updateItemInfo:function(){if(this.send(this.Evts.V_UPDATE_ITEM),0!=game.guildData.id){this.checkAlert()}},accessLab_1:function(){game.module.hide(this.moduleEnum),game.module.showToggle(game.ME.Guild,2)},accessLab_2:function(){this.dpt(this.Evts.C2C_JUMP_TO_MAP)},checkAlert:function(){if(0!=game.guildData.id)if(!this.guildDonateIds||this.guildDonateIds.length<1){this.spotAlert.alert=!1}else{for(var e,t=this.guildDonateIds,a=t.length,i=0;i<a;i++){if(e=t[i],0<game.itemData.getNumById(e)){return void(this.spotAlert.alert=!0)}}this.spotAlert.alert=!1}else{this.spotAlert.alert=!1}}}),t=game.Sender.extends({ipc:function(){this.msg={GuildDonateReq:this.guildDonateReq}},guildDonateReq:function(e){var t=game.pb.GuildDonateRequest;t.itemId=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildDonate,e,game.GuildDonateEvts,t)}(),function(){var e=b8e.Object.extends({});game.guildDonateData=game.guildDonateData||new e}(),function(){var e;e=b8e.Object.extends({id:0,ctor:function(){this._super()},setData:function(e){this.id=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildDonateInfo",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(530),this.setSize(542,134)},init:function(){this._itemGrid=game.GridUtil.createTipsIcon(),this._itemGrid.addToParent(this.skin.icon)},setData:function(){var e,t=this.skin,a=this.data;if(e=game.GuildDonateCfg.getData(a.id))if(t.desc.string=game.Lang.get(1648,e.fund),e=game.ItemInfoCfg.getData(a.id))t.name.string=e.name,game.GridUtil.setItemIcon(this._itemGrid,a,!1,0);else;else;},donateBtn:function(){this.send(game.GuildDonateEvts.V_DONATE,this.data.id)}}),b8e.RC("$$game","$$GuildDonateItem",e)}(),function(){var e=game.View.extends({donateInfoList:null,_showModel:!0,ctor:function(){this._super(531)},init:function(){var e=this.gridList=new game.List;e.layout.paddingLeft=3,e.itemRender=game.GuildDonateItem,e.addToParent(this.skin.scrollGrid),e.bindEnum=this.moduleEnum,this.list=[],this.donateInfoList=[],this.guildDonateIds=game.GuildDonateCfg.getKeys("itemId")},notify:function(e){switch(e){case this.Evts.V_UPDATE_ITEM:this.setList(),this.gridList.setData(this.list)}},onShow:function(){var e=this;this.setList(),e.gridList.setData(this.list)},setList:function(){var e=this;if(e.list.length=0,!e.guildDonateIds||e.guildDonateIds.length<1);else{var t,a,i,n,s,o=0,r=e.guildDonateIds.length;for(i=0;i<r;i++){if(t=e.guildDonateIds[i],(a=game.itemData.getNumById(t))<1);else for(n=0;n<a;n++){if(!e.donateInfoList[o]){e.donateInfoList[o]=new game.GuildDonateInfo}(s=e.donateInfoList[o]).setData(t),e.list.push(s),o++}}}},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.GuildDonate,e)}(),function(){var e;e=b8e.Enum({None:0,INCENSE_SUCCESS:-1,GET_AWARD_SUCCESS:-1}),b8e.RC("$$game","$$GuildIncenseEvts",e)}(),function(){var e=game.Control.extends({incenseAwardList:null,incenseIdList:null,init:function(){var e=this;game.guildIncenseData.initData(),e.incenseAwardList=game.guildIncenseData.getIncenseAwardList(),e.incenseIdList=game.guildIncenseData.getIncenseIdList(),this.spotAlert=game.spotAlert.set(game.SAE.GUILD_INCENSE,game.SAE.GUILD)},ipc:function(){this.evts={Guild:{C_UPDATE_GUILD:this.updateGuild,C2C_UPDATE_GUILD_ACTIVE:this.checkAlert},GuildMember:{C2C_UPDATE_GUILD_ACTIVE:this.checkAlert}},this.handels={GuildIncenseResp:this.guildIncenseResp,GuildIncenseAwardResp:this.guildIncenseAwardResp}},updateGuild:function(){if(0!=game.guildData.id){this.checkAlert()}},guildIncenseResp:function(e){var t=e.readProtobuf(game.pb.GuildIncenseResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.guildIncenseData.setIncenseData(t.id),game.notice.show(1670),this.checkAlert(),this.send(this.Evts.INCENSE_SUCCESS)},guildIncenseAwardResp:function(e){var t=e.readProtobuf(game.pb.GuildIncenseAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.guildIncenseData.setAward(t.incense),this.checkAlert(),this.send(this.Evts.GET_AWARD_SUCCESS)},incenseBtn_0:function(){this.clickIncenseBtn(0)},incenseBtn_1:function(){this.clickIncenseBtn(1)},incenseBtn_2:function(){this.clickIncenseBtn(2)},clickIncenseBtn:function(e){var t=this,a=game.guildIncenseData.getIncenseCount(),i=game.GuildLvCfg.getData(game.guildData.level);if(a!=(i?i.maxMembers:40))if(t.incenseIdList&&t.incenseIdList[e]){var n=t.incenseIdList[e];t.sender.GuildIncenseReq(n)}else;else{game.notice.show(1609)}},award_0:function(){this.clickAwardBtn(0)},award_1:function(){this.clickAwardBtn(1)},award_2:function(){this.clickAwardBtn(2)},clickAwardBtn:function(e){if(this.incenseAwardList&&this.incenseAwardList[e]){var t=this.incenseAwardList[e];game.GuildIncenseAwardViw.inst().showView(this.clickCb,t,this)}else;},clickCb:function(e,t){e.sender.GuildIncenseAwardReq(t)},checkAlert:function(){var e=this;if(0!=game.guildData.id)if(game.guildIncenseData.incensed)if(!e.incenseAwardList||e.incenseAwardList.length<1){e.spotAlert.alert=!1}else{for(var t,a=e.incenseAwardList.length,i=game.guildIncenseData,n=i.getIncense(),s=0;s<a;s++){if(n<(t=e.incenseAwardList[s])){return void(e.spotAlert.alert=!1)}if(!i.getIsGetByIncense(t)){return void(e.spotAlert.alert=!0)}}e.spotAlert.alert=!1}else{e.spotAlert.alert=!0}else{this.spotAlert.alert=!1}}}),t=game.Sender.extends({ipc:function(){this.msg={GuildIncenseReq:this.guildIncenseReq,GuildIncenseAwardReq:this.guildIncenseAwardReq,GuildIncenseLogReq:null}},guildIncenseAwardReq:function(e){var t=game.pb.GuildIncenseAwardRequest;t.incense=e,b8e.net.getBytes().writeProtobuf(t)},guildIncenseReq:function(e){var t=game.pb.GuildIncenseRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildIncense,e,game.GuildIncenseEvts,t)}(),function(){var e=b8e.Object.extends({_logList:null,_awardList:null,incensed:!1,_incenseIdList:null,_incenseAwardList:null,_logPool:null,incense:0,incenseCount:0,ctor:function(){this._logList=[],this._awardList=[],this._incenseIdList=[],this._incenseAwardList=[],this._logPool=[]},initData:function(){this._incenseIdList=game.GuildIncenseCfg.getKeys("id"),this._incenseAwardList=game.GuildIncenseAwardCfg.getKeys("incense"),this.maxIncenseCount=100},setData:function(e){this.incense=e.incense,this.incenseCount=e.IncenseCount},setModelData:function(e,t){this.incensed=e,this._awardList=t},setLogs:function(e){var t=this;t._logList.length=0;for(var a,i,n=e.length,s=0;s<n;s++){if(a=e[s],!t._logPool[s]){t._logPool[s]=new game.GuildIncenseLogInfo}(i=t._logPool[s]).setData(a),t._logList.push(i)}t._logList.sort(t.onSort)},setAward:function(e){this._awardList.push(e)},setIncenseData:function(e){this.incensed=!0;var t=game.GuildIncenseCfg.getData(e);if(t){this.incense+=t.incense,this.incenseCount++}var a=game.SysTime.curTime,i=game.mainRoleData.name;if(50==this._logList.length){this._logList[49].setMineData(a,i,e)}else{var n=new game.GuildIncenseLogInfo;n.setMineData(a,i,e),this._logList.push(n)}this._logList.sort(this.onSort)},onSort:function(e,t){return t.time-e.time},getIsGetByIncense:function(e){return-1<this._awardList.indexOf(e)},getIsIncense:function(){return this.incensed},getIncenseIdList:function(){return this._incenseIdList},getIncenseAwardList:function(){return this._incenseAwardList},getIncenseCount:function(){return this.incenseCount},getIncense:function(){return this.incense},getMaxIncenseCount:function(){return this.maxIncenseCount},getLogs:function(){return this._logList}});game.guildIncenseData=game.guildIncenseData||new e}(),function(){var e;e=b8e.Object.extends({time:0,name:"",id:0,ctor:function(){this._super()},setData:function(e){this.time=e.time,this.name=e.name,this.id=e.id},setMineData:function(e,t,a){this.time=e,this.name=t,this.id=a}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildIncenseLogInfo",e)}(),function(){var e=void 0;(e=game.View.extends({prizeInfoList:null,gridList:null,_showModel:!0,ctor:function(){this._super(532)},init:function(){var e=this,t=e.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.ShowItemListItem,t.addToParent(e.skin.scrollGrid),t.layout.spacingX=50,t.layout.spacingY=21,e.prizeInfoList=[],e.prizeList=[],e.posArray=[235,170,105,45]},showView:function(e,t,a){var i=this;if(i._clickCb=e,i.incense=t,i.thisArg=a,i.parent)i.show();else{game.GameViewMgr.inst().showView(i)}},onShow:function(){var e=this;e.skin.des.string=game.Lang.get(1649,e.incense);var t=game.guildIncenseData.getIsGetByIncense(e.incense),a=game.guildIncenseData.incense>=e.incense;e.skin.sureBtn.node.active=!t&&a,e.skin.canGetBtn.node.active=!a,e.skin.sureBtn_gray.active=t,e.setPrizeList()},setPrizeList:function(){var e,t=this,a=t.incense,i=game.GuildIncenseAwardCfg.getData(a);if(t.prizeList.length=0,i&&i.awardItems&&0<i.awardItems.length)for(var n,s=i.awardItems.length,o=0;o<s;o++){if(n=i.awardItems[o],!t.prizeInfoList[o]){t.prizeInfoList[o]=new game.PrizeInfo}(e=t.prizeInfoList[o]).setData(n.Id,n.Num,game.IconLayoutEnum.SHOW_ALL,0,game.IconSizeEnum.GRID_SIZE_105),t.prizeList.push(e)}t.gridList.setData(t.prizeList);var r=t.prizeList.length,g=4<r?-133:-187,l=r>t.posArray.length?t.posArray[3]:t.posArray[r-1];t.skin.scrollGrid.setPosition(l,g)},sureBtn:function(){this._clickCb.call(this,this.thisArg,this.incense),this.removeFromParent()},closeBtn:function(){this.removeFromParent()},cancelBtn:function(){this.removeFromParent()},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,t)}}))._instance=null,e.inst=function(){if(!e._instance){e._instance=new e}return e._instance},b8e.RC("$$game","$$GuildIncenseAwardViw",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(533),this.setSize(530,25)},init:function(){this.format="Y-M-D h:m:s"},setData:function(){var e,t=this.skin,a=this.data,i=(game.Lang,b8e.TimeUtil.formatTimestamp(a.time,this.format)),n=game.GuildIncenseCfg.getData(a.id);if(n){var s=game.Color.GREEN;switch(a.id){case 1:s=game.Color.GREEN;break;case 2:s=game.Color.BLUE;break;case 3:s=game.Color.PURPLE}e=game.HtmlUtil.getText(s,n.name)}else e="";t.lab.string=game.Lang.get(1650,i,a.name,e)}}),b8e.RC("$$game","$$GuildIncenseLogItem",e)}(),function(){var e=game.View.extends({costSpriteList:null,width:540,ctor:function(){this._super(534)},notify:function(e){var t=this;switch(e){case t.Evts.INCENSE_SUCCESS:t.setGuildInceseActive(),t.setInceseDesc(),t.setLogs(),t.setAwardIsGet();break;case t.Evts.GET_AWARD_SUCCESS:t.setAwardIsGet()}},init:function(){var e;this.skin;this.costSpriteList=[];for(var t=0;t<3;t++)(e=b8e.Sprite.get()).addToParent(this.getComponent("incenseCost_"+t)),e.setAnchor(.5,.5),e.setSize(40,40),this.costSpriteList.push(e);this.width=this.skin.progress.node.width,this.setGuildIncese();var a=this.gridList=new game.List;a.itemRender=game.GuildIncenseLogItem,a.addToParent(this.skin.scrollGrid),a.layout.spacingY=0},onShow:function(){this.setAwardIsGet(),this.setGuildInceseActive(),this.setInceseDesc(),this.setLogs()},onHide:function(){},setAwardIsGet:function(){var e=game.guildIncenseData;if(this.incenseAwardList=e.getIncenseAwardList(),this.incenseAwardList&&!(this.incenseAwardList.length<1)){this.skin;for(var t,a,i=this.incenseAwardList.length,n=e.getIncense(),s=0;s<i;s++)t=this.incenseAwardList[s],a=e.getIsGetByIncense(t),this.getComponent("isGet_"+s).node.active=a,this.getComponent("spot_"+s).node.active=!a&&t<=n}},setGuildIncese:function(){var e=this;if(e.incenseIdList=game.guildIncenseData.getIncenseIdList(),e.incenseIdList&&!(e.incenseIdList.length<1)){e.skin;for(var t,a,i,n=game.guildIncenseData.getIsIncense(),s=e.incenseIdList.length,o=0;o<s;o++)a=e.incenseIdList[o],(t=game.GuildIncenseCfg.getData(a))&&(e.getComponent("incenseNode_"+o).active=!0,e.getComponent("incenseName_"+o).string=t.name,e.getComponent("incenseDesc_"+o).string=game.Lang.get(1651,t.fund,t.contribution,t.incense),e.getComponent("incenseBtn_"+o).node.active=n,e.getComponent("incenseCostNum_"+o).string=game.Lang.get(1652,t.costItems[0].Num),i=game.ResCfg.getUrl(137,t.costItems[0].Id),e.costSpriteList[o].loadTexture(i))}},setGuildInceseActive:function(){if(this.incenseIdList=game.guildIncenseData.getIncenseIdList(),this.incenseIdList&&!(this.incenseIdList.length<1)){this.skin;for(var e=this.incenseIdList.length,t=game.guildIncenseData.getIsIncense(),a=0;a<e;a++)this.getComponent("incenseBtn_"+a).node.active=!t,this.getComponent("incenseBtnGray_"+a).node.active=t}},setInceseDesc:function(){var e=this,t=game.guildIncenseData;if(e.incenseAwardList=t.getIncenseAwardList(),!e.incenseAwardList||e.incenseAwardList.length<1);else{var a=e.skin,i=e.incenseAwardList.length,n=t.getIncense(),s=t.getIncenseCount(),o=e.incenseAwardList[i-1],r=game.GuildLvCfg.getData(game.guildData.level),g=r?r.maxMembers:40;a.incenseProgressLab.string=game.Lang.get(1653,n,o),a.incenseCount.string=game.Lang.get(1654,s,g);var l=n/o;l=l<1?l:1,a.progress.node.width=l*e.width}},setLogs:function(){this.logList=game.guildIncenseData.getLogs(),this.gridList.setData(this.logList)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuildIncense,e)}(),function(){var e;e=b8e.Enum({None:0}),b8e.RC("$$game","$$GuildCollectBarEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C_UPDATE_MODE:-1,C_MONSTER_KILL_COUNT_UPDATE:-1,C_COLLECT_COUNT_UPDATE:-1,C_CHALLENGE_COUNT_UPDATE:-1,C_AUTO_BUY:-1,C_UPDATA_ALL_FINISH:-1,V_RESET_TASK_ALERT_OK:-1,V_ON_COLLECT_TASK:-1,V_ON_MONSTER_TASK:-1,V_ON_COLLECT_GET_PRIZE:-1,V_ON_MONSTER_GET_PRIZE:-1,V_PICK_MONSTER:-1,V_PICK_COLLECT:-1}),b8e.RC("$$game","$$GuildCollectEvts",e)}(),function(){var e;e=b8e.Enum({None:0,V_UPDATE_EXCHANGE_DATAS:-1,V_SELECT_ITEM:-1,V2C_REQ_DATA:-1}),b8e.RC("$$game","$$GuildExchangeEvts",e)}(),function(){var e;e=b8e.Enum({None:0}),b8e.RC("$$game","$$GuildTaskResetAlertEvts",e)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={}},notify:function(e){}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.GuildCollectBar,e,game.GuildCollectBarEvts,t)}(),function(){var e=game.Control.extends({init:function(){var t=this;t._collectGetPrizeAlert=game.spotAlert.set(game.SAE.GUILD_COLLECT_GET_PRIZE,game.SAE.GUILD_MAP),t._monsterGetPrizeAlert=game.spotAlert.set(game.SAE.GUILD_MONSTER_GET_PRIZE,game.SAE.GUILD_MAP),t._alertOptions={lang:1909,okcb:function(e){t.sender.GuildMapQuickReq(e===t.Evts.V_ON_COLLECT_TASK)},thisArg:t},t._autoOptions={lang:8313,okcb:function(){t.sender.GuildMapFinishReq()},thisArg:t}},ipc:function(){var e=this;e.evts={Guild:{C_INIT_GUILD_MODEL_DATA:e._initGuildModelData},GuildCollectMenu:{C_AUTO_BUY:e._autoFinish}},e.handels={GuildMapResetResp:e.guildMapResetResp,GuildMapQuickResp:e.guildMapQuickResp,GuildMapAwardResp:e.guildMapAwardResp,GuildMapChallengeResp:e.guildMapChallengeResp,GuildMapCollectResp:e.guildMapCollectResp,GuildMapFinishResp:e.guildMapFinishResp}},_initGuildModelData:function(){var e=this;e._checkCollectGetPrizeAlert(),e._checkMonsterGetPrizeAlert()},_checkCollectGetPrizeAlert:function(){var e=game.guildCollectData;this._collectGetPrizeAlert.alert=0<game.guildData.id&&e.isShowAlert(!0)},_checkMonsterGetPrizeAlert:function(){var e=game.guildCollectData;this._monsterGetPrizeAlert.alert=0<game.guildData.id&&e.isShowAlert(!1)},guildMapResetResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildMapResetResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.isCollect,n=a.resetTimes;game.guildCollectData.resetTask(i,n),t.send(t.Evts.C_UPDATE_MODE,i)}},guildMapQuickResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildMapQuickResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.isCollect;if(game.guildCollectData.setTaskComplete(i),t.send(t.Evts.C_UPDATE_MODE,i),i){t._checkCollectGetPrizeAlert()}else t._checkMonsterGetPrizeAlert()}},guildMapAwardResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildMapAwardResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.isCollect;if(game.guildCollectData.setIsAward(i),t.send(t.Evts.C_UPDATE_MODE,i),i){t._checkCollectGetPrizeAlert()}else t._checkMonsterGetPrizeAlert()}},guildMapChallengeResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildMapChallengeResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=game.guildCollectData,n=a.battleLog,s=a.userItem,o=a.challengeCount;if(i.challengeCount=o,i.isGetMode(!1)){i.isAutoMonster=!1}if(t.send(t.Evts.C_MONSTER_KILL_COUNT_UPDATE),t._checkMonsterGetPrizeAlert(),n)game.playBack.play(n,{type:game.InstanceType.GUILD_MAP,rewards:s});else;t.dpt(t.Evts.C_CHALLENGE_COUNT_UPDATE)}},guildMapCollectResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildMapCollectResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=game.guildCollectData,n=(a.userItem,a.collectCount);if(i.collectCount=n,i.isGetMode(!0)){i.isAutoCollect=!1}t.send(t.Evts.C_COLLECT_COUNT_UPDATE),t.dpt(t.Evts.C_COLLECT_COUNT_UPDATE),t._checkCollectGetPrizeAlert()}},guildMapFinishResp:function(e){var t=e.readProtobuf(game.pb.GuildMapFinishResponse);0<t.code?game.notice.noticeError(t.code):(game.guildCollectData.setAllTaskComplete(),this.send(this.Evts.C_UPDATA_ALL_FINISH),this._checkCollectGetPrizeAlert(),this._checkMonsterGetPrizeAlert())},notify:function(e,t){var a=this;switch(e){case a.Evts.V_RESET_TASK_ALERT_OK:var i=0,n=0,s=game.GuildMiscCfg.getData("guildMapResetCost");if(s){var o=s.value.split(",");i=0|+o[1],n=0|+o[0]}var r=game.amount.getCfgById(n);if(!r)return;if(game.amount.getAmountById(n)<i){return void game.alert.showLang(1906,r.name)}a.sender.GuildMapResetReq(game.guildCollectData.isCollectReset);break;case a.Evts.V_ON_COLLECT_TASK:case a.Evts.V_ON_MONSTER_TASK:var g=0,l=0,c=game.GuildMiscCfg.getData("guildMapQuickCost");if(c){var h=c.value.split(",");g=0|+h[1],l=0|+h[0]}var m=game.amount.getCfgById(l);if(!m)return;if(game.amount.getAmountById(l)<g){return void game.alert.showLang(1908,m.name)}var u=game.ItemInfoCfg.getData(l);if(!u)return;a._alertOptions.langArgs=[g,u.name],a._alertOptions.args=e,game.alert.showTwo(a._alertOptions);break;case a.Evts.V_ON_COLLECT_GET_PRIZE:case a.Evts.V_ON_MONSTER_GET_PRIZE:a.sender.GuildMapAwardReq(e===a.Evts.V_ON_COLLECT_GET_PRIZE);break;case a.Evts.V_PICK_MONSTER:a.sender.GuildMapChallengeReq(t);break;case a.Evts.V_PICK_COLLECT:a.sender.GuildMapCollectReq()}},_autoFinish:function(){var e=this.getMiscNum("guildMapQuickCost"),t=this.getMiscNum("guildMapResetCost"),a=game.guildData.level,i=game.GuildCollectCfg.getData(a);if(i){var n=game.VipCfg.getData(game.mainRoleData.vipLevel),s=n.guildMapReset2-game.guildCollectData.collectResetCount,o=n.guildMapReset1-game.guildCollectData.challengeResetCount,r=0==s?i.collectTimes:i.collectTimes*(1+s),g=0==o?i.challengeTimes:i.challengeTimes*(1+o),l=(r-game.guildCollectData.collectCount)/30,c=(g-game.guildCollectData.challengeCount)/20,h=e.cost*(l+c),m=t.cost*(s+o);this._autoOptions.langArgs=[h,m],game.alert.showTwo(this._autoOptions)}},getMiscNum:function(e){var t=0,a=0,i=game.GuildMiscCfg.getData(e);if(i){var n=i.value.split(",");t=0|n[1],a=0|n[0]}return{id:+a,cost:+t}},hasMoneyEnough:function(e,t){var a=game.amount.getCfgById(e);return!!a&&(!(game.amount.getAmountById(e)<t)||(game.alert.showLang(1908,a.name),!1))}}),t=game.Sender.extends({ipc:function(){var e=this;e.msg={GuildMapResetReq:e.guildMapResetReq,GuildMapQuickReq:e.guildMapQuickReq,GuildMapAwardReq:e.guildMapAwardReq,GuildMapChallengeReq:e.guildMapChallengeReq,GuildMapCollectReq:null,GuildMapFinishReq:null}},guildMapResetReq:function(e){var t=game.pb.GuildMapAwardRequest;t.isCollect=e,this.write(t)},guildMapQuickReq:function(e){var t=game.pb.GuildMapQuickRequest;t.isCollect=e,this.write(t)},guildMapAwardReq:function(e){var t=game.pb.GuildMapAwardRequest;t.isCollect=e,this.write(t)},guildMapChallengeReq:function(e){var t=game.pb.GuildMapChallengeRequest;t.monGroup=e,this.write(t)}});b8e.module.registerControl(game.ME.GuildCollect,e,game.GuildCollectEvts,t)}(),function(){var e=game.Control.extends({init:function(){this._alertOptions={title:game.Lang.get(9414),lang:1901}},conveneBtn:function(){game.alert.show(this._alertOptions)},buyBtn:function(){game.module.show(game.ME.GuildExchange)},backBtn:function(){this.sender.GuildMapReq()},autoBtn:function(){var e=game.rechargeData.getCardInfoByType(game.CardType.WEEK);e&&e.expireTime>game.SysTime.curTime?game.guildCollectData.checkAutoFinish()?this.dpt(this.Evts.C_AUTO_BUY):game.notice.show(8263):game.notice.show(8262)}}),t=game.Sender.extends({ipc:function(){this.msg={GuildMapReq:this.guildMapReqExit}},guildMapReqExit:function(){var e=game.pb.GuildMapRequest;e.enter=!1,this.write(e)}});b8e.module.registerControl(game.ME.GuildCollectMenu,e,game.GuildCollectEvts,t)}(),function(){var e=game.Control.extends({init:function(){var e=this;e._exchangeAlert=game.spotAlert.set(game.SAE.GUILD_EXCHANGE,game.SAE.GUILD_MAP),e._alertOptions={lang:1910,okcb:e._onClickAlertOK,thisArg:e}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.GuildShopReq()},ipc:function(){this.evts={Back:{C_BACK_UPDATE_ITEMINFO:this._updateItemInfo}},this.handels={GuildShopResp:this.guildShopResp,GuildShopManuallyResp:this.guildShopManuallyResp,GuildShopMsg:this.guildShopMsg,GuildShopBuyResp:this.guildShopBuyResp}},guildShopResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildShopResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.items,n=a.resetTimes,s=a.nextRefreshTime,o=game.guildExchangeData;o.setItems(i),o.resetTimes=n,o.nextRefreshTime=s,t.send(t.Evts.V_UPDATE_EXCHANGE_DATAS),t._checkExchangeAlert()}},guildShopManuallyResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildShopManuallyResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.ids,n=a.resetTimes,s=a.nextRefreshTime,o=game.guildExchangeData;o.setIds(i),o.resetTimes=n,o.nextRefreshTime=s,t.send(t.Evts.V_UPDATE_EXCHANGE_DATAS),t._checkExchangeAlert()}},guildShopMsg:function(e){var t=this,a=e.readProtobuf(game.pb.GuildShopNotify);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.ids,n=a.nextRefreshTime,s=game.guildExchangeData;s.setIds(i),s.nextRefreshTime=n,t.send(t.Evts.V_UPDATE_EXCHANGE_DATAS),t._checkExchangeAlert()}},guildShopBuyResp:function(e){var t=this,a=e.readProtobuf(game.pb.GuildShopBuyResponse);if(0<a.code){game.notice.noticeError(a.code)}else{var i=a.index;a.userItem;game.guildExchangeData.setObtain(i),t.send(t.Evts.V_UPDATE_EXCHANGE_DATAS),t._checkExchangeAlert()}},_updateItemInfo:function(){var e=this;game.guildExchangeData.updateInfos(),e.send(e.Evts.V_UPDATE_EXCHANGE_DATAS),e._checkExchangeAlert()},_checkExchangeAlert:function(){var e=game.guildExchangeData;this._exchangeAlert.alert=0<game.guildData.id&&e.checkExchangeAlert()},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SELECT_ITEM:a.sender.GuildShopBuyReq(t);break;case a.Evts.V2C_REQ_DATA:a.sender.GuildShopReq()}},refreshBtn:function(){var e=this,t=0,a=game.GuildMiscCfg.getData("guildShopRefreshTimes");if(a){t=0|+a.value}if(t-game.guildExchangeData.resetTimes<=0){game.notice.show(game.Lang.get(1902))}else{var i=0,n=0;if(a=game.GuildMiscCfg.getData("guildShopRefreshCost")){var s=a.value.split(",");i=0|+s[1],n=0|+s[0]}if(game.amount.get(game.AmountType.YUAN_BAO)<i){game.notice.show(game.Lang.get(1903))}else{var o=game.ItemInfoCfg.getData(n);o&&(e._alertOptions.langArgs=[i,o.name],game.alert.showTwo(e._alertOptions))}}},_onClickAlertOK:function(){this.sender.GuildShopManuallyReq()}}),t=game.Sender.extends({ipc:function(){this.msg={GuildShopReq:null,GuildShopManuallyReq:null,GuildShopBuyReq:this.guildShopBuyReq}},guildShopBuyReq:function(e){var t=game.pb.GuildShopBuyRequest;t.index=e,this.write(t)}});b8e.module.registerControl(game.ME.GuildExchange,e,game.GuildExchangeEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={}},notify:function(){},okBtn:function(){b8e.module.sendToControl(game.ME.GuildCollect,[game.GuildCollectEvts.V_RESET_TASK_ALERT_OK]),game.module.hide(game.ME.GuildTaskResetAlert)},cancelBtn:function(){game.module.hide(game.ME.GuildTaskResetAlert)},onClickGameAlert:function(e,t){switch(t){case game.GameAlertBtnEnum.LEFT:case game.GameAlertBtnEnum.RIGHT:game.module.hide(game.ME.GameAlert)}}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.GuildTaskResetAlert,e,game.GuildTaskResetAlertEvts,t)}(),function(){var e=b8e.Object.extends({isAutoCollect:!1,isAutoMonster:!1,isCollectReset:!1,challengeCount:0,collectCount:0,isCollectAward:!1,isChallengeAward:!1,collectTotalTime:1e3,collectResetCount:0,challengeResetCount:0,ctor:function(){this._super()},isTaskMode:function(e){var t=game.guildData.level,a=game.GuildCollectCfg.getData(t);if(a){if(e){return this.collectCount<a.collectTimes}return this.challengeCount<a.challengeTimes}return b8e.warn("\u672a\u627e\u5230\u5bf9\u5e94VIP\u7b49\u7ea7\u7684\u91c7\u96c6\u914d\u7f6e\uff1aLevel:"+t),!0},isGetMode:function(e){if(e&&!this.isCollectAward||!e&&!this.isChallengeAward){var t=game.guildData.level,a=game.GuildCollectCfg.getData(t);if(a){if(e){return this.collectCount>=a.collectTimes}return this.challengeCount>=a.challengeTimes}b8e.warn("\u672a\u627e\u5230\u5bf9\u5e94VIP\u7b49\u7ea7\u7684\u91c7\u96c6\u914d\u7f6e\uff1aLevel:"+t)}return!1},isShowAlert:function(e){return e?!this.isCollectAward:!this.isChallengeAward},isResetMode:function(e){return e&&this.isCollectAward||!e&&this.isChallengeAward},resetTask:function(e,t){var a=this;if(e){a.collectCount=0,a.collectResetCount=t,a.isCollectAward=!1}else a.challengeCount=0,a.challengeResetCount=t,a.isChallengeAward=!1},setTaskComplete:function(e){var t=this,a=game.guildData.level,i=game.GuildCollectCfg.getData(a);if(i){if(e){t.collectCount=i.collectTimes,t.isAutoCollect=!1}else t.challengeCount=i.challengeTimes,t.isAutoMonster=!1}else if(b8e.warn("\u672a\u627e\u5230\u5bf9\u5e94VIP\u7b49\u7ea7\u7684\u91c7\u96c6\u914d\u7f6e\uff1aLevel:"+a),e){this.collectCount=0}else this.challengeCount=0},setAllTaskComplete:function(){var e=game.guildData.level,t=game.GuildCollectCfg.getData(e),a=game.VipCfg.getData(game.mainRoleData.vipLevel);t?(this.setResetTimes(a.guildMapReset2,a.guildMapReset1),this.setTaskCount(t.collectTimes,t.challengeTimes),this.setAward(!0,!0)):b8e.warn("\u672a\u627e\u5230\u5bf9\u5e94VIP\u7b49\u7ea7\u7684\u91c7\u96c6\u914d\u7f6e\uff1aLevel:"+e)},checkAutoFinish:function(){var e=game.guildData.level,t=game.GuildCollectCfg.getData(e);if(!t)return!1;var a=game.VipCfg.getData(game.mainRoleData.vipLevel),i=a.guildMapReset2-this.collectResetCount,n=a.guildMapReset1-this.challengeResetCount,s=0==i?t.collectTimes:t.collectTimes*i,o=0==n?t.challengeTimes:t.challengeTimes*n;return s-this.collectCount!=0||o-this.challengeCount!=0||0!=i||0!=i},setIsAward:function(e){if(e){this.isCollectAward=!0}else this.isChallengeAward=!0},setResetTimes:function(e,t){this.collectResetCount=e,this.challengeResetCount=t},setAward:function(e,t){this.isCollectAward=e,this.isChallengeAward=t},setTaskCount:function(e,t){this.collectCount=e,this.challengeCount=t}});game.guildCollectData=game.guildCollectData||new e}(),function(){var e=b8e.Object.extends({resetTimes:0,nextRefreshTime:0,itemInfos:null,itemInfoByIdx:null,ctor:function(){this._super()},setItems:function(e){var t=this;t.itemInfos=[],t.itemInfoByIdx={};for(var a=e.length,i=0;i<a;i++){var n=e[i],s=new game.GuildExchangeItemInfo;s.id=n.id,s.index=i,s.obtain=n.obtain,t.itemInfos.push(s),(t.itemInfoByIdx[i]=s).updateInfo()}},setIds:function(e){var t=this;t.itemInfos=[],t.itemInfoByIdx={};for(var a=e.length,i=0;i<a;i++){var n=e[i],s=new game.GuildExchangeItemInfo;s.id=n,s.index=i,s.obtain=!1,t.itemInfos.push(s),(t.itemInfoByIdx[i]=s).updateInfo()}},setObtain:function(e){if(this.itemInfoByIdx){var t=this.itemInfoByIdx[e];if(t){t.obtain=!0}}else;},updateInfos:function(){if(this.itemInfos)for(var e=this.itemInfos.length,t=0;t<e;t++){this.itemInfos[t].updateInfo()}else;},checkExchangeAlert:function(){if(!this.itemInfos){return!1}for(var e=!1,t=this.itemInfos.length,a=0;a<t;a++){var i=this.itemInfos[a],n=i.id;if(i.obtain);else{var s=game.GuildShopCfg.getData(n);if(s){for(var o=!0,r=s.cost,g=r.length,l=0;l<g;l++){var c=r[l],h=c.Id,m=c.Num;if(game.itemData.getNumById(h)<m){o=!1;break}}if(o){e=!0}if(e){break}}else;}}return e}});game.guildExchangeData=game.guildExchangeData||new e}(),function(){var e;e=b8e.Object.extends({id:0,index:0,obtain:!1,costInfo:"",canExchange:!1,updateInfo:function(){var e=this,t=e.id,a=game.GuildShopCfg.getData(t),i=!1,n=[];if(a){i=!0;for(var s=a.cost,o=s.length,r=0;r<o;r++){var g=s[r],l=g.Id,c=g.Num,h=void 0,m=game.ItemInfoCfg.getData(l);if(m){h=m.name}else h=game.Lang.get(9415);var u=game.itemData.getNumById(l);if(u<c){i=!1}else u=c;n.push(h+"("+u+"/"+c+")")}}e.canExchange=i,e.costInfo=n.join("\n")}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildExchangeItemInfo",e)}(),function(){var e=game.View.extends({_showModel:!0,_maxBarWidth:0,_specialLayer:!0,ctor:function(){this._super(535),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e=this;e._maxBarWidth=e.skin.bar.node.width},notify:function(){},onShow:function(){var e=this.skin.bar.node;e.width=0,b8e.Tween.kill(e);var t=game.guildCollectData.collectTotalTime;b8e.Tween.get(e).to({width:this._maxBarWidth},t).call(function(){game.module.hide(game.ME.GuildCollectBar)},this)},onHide:function(){var e=this.skin.bar.node;b8e.Tween.kill(e)},onStageResize:function(){var e=this;e._super();var t=b8e.stageWidth,a=b8e.stageHeight;e.setPosition(.5*(t-e.width),a-250)}});b8e.module.registerView(game.ME.GuildCollectBar,e)}(),function(){var e;e=game.Widget.extends({_isCollect:!1,_tileName:"",_currNum:0,_totalNum:0,ctor:function(e){var t=!(0<arguments.length&&void 0!==e)||e,a=this;a._super(536),a._isCollect=t,a.isTaskMode()},init:function(){var e=this,t=e.skin;t.autoSelect.node.active=!!e._isAuto;var a=e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.PrizeListItem,a.layout.paddingLeft=0,a.layout.paddingRight=0,a.layout.paddingTop=0,a.layout.spacingX=0,a.addToParent(t.prizeList);var i=0,n=21,s=void 0,o=game.GuildMiscCfg.getData("guildMapQuickCost");if(o){var r=o.value.split(",");i=0|+r[1],n=0|+r[0]}if((s=game.ItemInfoCfg.getData(n))&&s.icon){var g=game.ResCfg.getUrl(137,s.icon);t.taskMoneySprite.loadTexture(g)}if(t.labTaskMoneyCost.string=i+"",i=0,o=game.GuildMiscCfg.getData("guildMapResetCost")){var l=o.value.split(",");i=0|+l[1],n=0|+l[0]}if((s=game.ItemInfoCfg.getData(n))&&s.icon){var c=game.ResCfg.getUrl(137,s.icon);t.resetMoneySprite.loadTexture(c)}t.labResetMoneyCost.string=i+"",e._updateTile(),e._updateMode(),e._updateGetBtnRedSpot(),e._updatePrizeList()},setAuto:function(e){var t=this;t._isAuto=e;var a=t.skin;if(a){a.autoSelect.node.active=t._isAuto}},initAuto:function(e,t,a){var i=this;i._isAuto=e,i._autoCallback={callBack:t,thisArg:a};var n=i.skin;if(n){n.autoSelect.node.active=i._isAuto}},initTask:function(e,t){this._taskCallback={callBack:e,thisArg:t}},initGetPrize:function(e,t){this._getPrizeCallback={callBack:e,thisArg:t}},setPrize:function(e){var t=this;t._award=e,t._updatePrizeList()},_updatePrizeList:function(){var e=this;if(e._prizeList)if(e._award){var t=game.CfgUtil.getPrizeListInfo(e._award,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);if(t){e._prizeList.setData(t.items)}}else;else;},setGetPrizeAlert:function(e){var t=this;t._getPrizeAlert=e,t._updateGetBtnRedSpot()},_updateGetBtnRedSpot:function(){var e=this.skin;if(e)e.getBtnRedSpot.node.active=!!this._getPrizeAlert;else;},isResetMode:function(){var e=this;e._modeType="reset",e._updateMode()},_updateMode:function(){var e=this.skin;if(e)switch(this._modeType){case"reset":e.panelReset.active=!0,e.panelGet.active=!1,e.panelTask.active=!1;break;case"get":e.panelReset.active=!1,e.panelGet.active=!0,e.panelTask.active=!1;break;case"task":e.panelReset.active=!1,e.panelGet.active=!1,e.panelTask.active=!0}else;},setTileName:function(e){var t=this;t._tileName=e,t._updateTile()},_updateTile:function(){var e=this.skin;if(e)e.labTitle.string=this._tileName+"("+this._currNum+"/"+this._totalNum+")";else;},setTitleTotalNum:function(e){var t=this;t._totalNum=e,t._updateTile()},setTitleCurrNum:function(e){var t=this;t._currNum=e,t._updateTile()},isGetMode:function(){var e=this;e._modeType="get",e._updateMode()},isTaskMode:function(){var e=this;e._modeType="task",e._updateMode()},resetBtn:function(){game.guildCollectData.isCollectReset=this._isCollect,game.module.show(game.ME.GuildTaskResetAlert)},getBtn:function(){var e=this;e._getPrizeCallback.callBack.call(e._getPrizeCallback.thisArg)},autoBtn:function(){var e=this,t=e.skin,a=t.autoSelect.node.active;a=!a,t.autoSelect.node.active=a,e._autoCallback.callBack.call(e._autoCallback.thisArg,a)},taskBtn:function(){var e=this;e._taskCallback.callBack.call(e._taskCallback.thisArg)}}),b8e.RC("$$game","$$GuildCollectItem",e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){var e=this;e._super(537),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex),e.spotAlerts={GUILD_EXCHANGE:e._exchangeAlert}},init:function(){},_exchangeAlert:function(e){this.skin.redSpotExchange.node.active=e.alert},notify:function(){},onShow:function(){},onHide:function(){},onStageResize:function(){var e=this;e._super();var t=b8e.stageWidth,a=b8e.stageHeight;e.setPosition(t-90,a-340)}});b8e.module.registerView(game.ME.GuildCollectMenu,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){var e=this;e._super(538),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex),e.spotAlerts={GUILD_COLLECT_GET_PRIZE:e._colloctGetPrizeAlert,GUILD_MONSTER_GET_PRIZE:e._monsterGetPrizeAlert}},init:function(){var e=this,t=game.guildCollectData,a=e._collectItem=new game.GuildCollectItem;a.setTileName(game.Lang.get(9416)),a.initAuto(t.isAutoCollect,function(e){t.isAutoCollect=e,game.GameLevelMgr.inst().applyTrackTypes()},e),a.initTask(e.onCollectTask,e),a.initGetPrize(e.onCollectGetPrize,e),e.addChild(a);var i=e._monsterItem=new game.GuildCollectItem(!1);i.setTileName(game.Lang.get(9417)),i.initAuto(t.isAutoMonster,function(e){t.isAutoMonster=e,game.GameLevelMgr.inst().applyTrackTypes()},e),i.initTask(e.onMonsterTask,e),i.initGetPrize(e.onMonsterGetPrize,e),e.addChild(i),e._monsterItem.y=-254},_colloctGetPrizeAlert:function(e){this._collectItem.setGetPrizeAlert(e.alert)},_monsterGetPrizeAlert:function(e){this._monsterItem.setGetPrizeAlert(e.alert)},onCollectTask:function(){this.send(this.Evts.V_ON_COLLECT_TASK)},onCollectGetPrize:function(){this.send(this.Evts.V_ON_COLLECT_GET_PRIZE)},onMonsterTask:function(){this.send(this.Evts.V_ON_MONSTER_TASK)},onMonsterGetPrize:function(){this.send(this.Evts.V_ON_MONSTER_GET_PRIZE)},notify:function(e,t){var a=this;switch(e){case a.Evts.C_UPDATE_MODE:var i=t;a._updateMode(i);break;case a.Evts.C_COLLECT_COUNT_UPDATE:if(a._collectItem.setTitleCurrNum(game.guildCollectData.collectCount),game.guildCollectData.isGetMode(!0)){a._updateMode(!0)}break;case a.Evts.C_MONSTER_KILL_COUNT_UPDATE:if(a._monsterItem.setTitleCurrNum(game.guildCollectData.challengeCount),game.guildCollectData.isGetMode(!1)){a._updateMode(!1)}break;case a.Evts.C_UPDATA_ALL_FINISH:a._updateAllMode()}},_updateMode:function(e){var t=this,a=game.guildCollectData;if(e){t._collectItem.setTitleCurrNum(a.collectCount)}else t._monsterItem.setTitleCurrNum(a.challengeCount);if(a.isTaskMode(e)){if(e){t._collectItem.isTaskMode()}else t._monsterItem.isTaskMode()}else if(a.isGetMode(e)){if(e){t._collectItem.isGetMode(),t._collectItem.setAuto(a.isAutoCollect),game.GameLevelMgr.inst().applyTrackTypes()}else t._monsterItem.isGetMode(),t._monsterItem.setAuto(a.isAutoMonster),game.GameLevelMgr.inst().applyTrackTypes()}else if(a.isResetMode(e)){if(e){t._collectItem.isResetMode()}else t._monsterItem.isResetMode()}},_updateAllMode:function(){this._collectItem.setTitleCurrNum(game.guildCollectData.collectCount),this._monsterItem.setTitleCurrNum(game.guildCollectData.collectCount),this._collectItem.isResetMode(),this._monsterItem.isResetMode()},onShow:function(){var e=this,t=0,a=null,i=game.guildData.level,n=game.GuildCollectCfg.getData(i);if(n){t=n.collectTimes,a=n.collectPrizes,game.CfgUtil.setPrizeKey(n,"_$collectExp",a,"_$collectPrizeItems"),e._collectItem.setTitleTotalNum(t),e._collectItem.setPrize(n.collectPrizeItems),t=n.challengeTimes,a=n.challengePrizes,game.CfgUtil.setPrizeKey(n,"_$challengeExp",a,"_$challengePrizeItems"),e._monsterItem.setTitleTotalNum(t),e._monsterItem.setPrize(n.challengePrizeItems)}else b8e.warn("\u672a\u627e\u5230\u5bf9\u5e94VIP\u7b49\u7ea7\u7684\u91c7\u96c6\u914d\u7f6e\uff1aLevel:"+i);e._updateMode(!0),e._updateMode(!1)},onHide:function(){},onStageResize:function(){this._super();var e=b8e.stageHeight;this.setPosition(0,e-350)}});b8e.module.registerView(game.ME.GuildCollect,e)}(),function(){var e;e=game.ListItem.extends({_icon:null,_data:null,ctor:function(){var e=this;e._super(539),e.setSize(268,144)},init:function(){var e=this;e._icon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.SIZE_70),e._icon.addToParent(this.skin.icon),e._icon.setClickCb(this.clickIcon,this)},setData:function(){var e=this.skin;e.exchangeBtn.active=!this.data.obtain,e.unExchange.active=this.data.obtain;var t=this.data.id,a=e.labItemName,i=game.GuildShopCfg.getData(t);if(i){var n=i.award,s=game.CfgUtil.getPrizeListInfo(n).items[0];if(s){game.GridUtil.setItemIcon(this._icon,s,!1,0);var o=game.ItemInfoCfg.getData(s.id),r=o?game.HtmlUtil.getColorByQuality(o.quality):4294967295;a.node.color=r,a.string=o?o.name:game.Lang.get(9415)}else a.node.color=4294967295,a.string=game.Lang.get(9418);e.labNeedCost.string=this.data.costInfo}else a.node.color=4294967295,a.string=game.Lang.get(9419),e.labNeedCost.string=game.Lang.get(9420);e.redSpotExchange.node.active=this.data.canExchange&&!this.data.obtain},clickIcon:function(e){var t=e;game.tipsData.setInfo(t.itemInfo);var a=game.ItemInfoCfg.getCfgTypeById(t.itemInfo.id);game.module.show(a==game.ItemCfgType.Equip?game.ME.EquipDetailsTips:game.ME.ItemTips)},exchangeBtn:function(){if(this.data.obtain){game.alert.showLang(1904)}else if(this.data.canExchange)this.send(game.GuildExchangeEvts.V_SELECT_ITEM,this.data.index);else{game.alert.showLang(1905)}}}),b8e.RC("$$game","$$GuildExchangeItem",e)}(),function(){var e=game.View.extends({_nextTime:0,_showModel:!0,ctor:function(){this._super(540)},init:function(){var e=this,t=e._itemList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.GuildExchangeItem,t.bindEnum=game.ME.GuildExchange,t.addToParent(e.skin.listView),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingX=5,t.layout.spacingY=5;var a=0,i=22,n=game.GuildMiscCfg.getData("guildShopRefreshCost");if(n){var s=n.value.split(",");a=0|+s[1],i=0|+s[0]}var o=game.ItemInfoCfg.getData(i);if(o&&o.icon){var r=game.ResCfg.getUrl(137,o.icon);e.skin.moneySprite.loadTexture(r)}e.skin.labMoneyCost.string=a+"",e.send(e.Evts.V2C_REQ_DATA)},notify:function(e){var t=this;switch(e){case t.Evts.V_UPDATE_EXCHANGE_DATAS:t._updataItemList(),t._updateRefreshCount()}},_updataItemList:function(){this._itemList.setData(game.guildExchangeData.itemInfos)},_updateRefreshCount:function(){var e=this,t=0,a=game.GuildMiscCfg.getData("guildShopRefreshTimes");a&&(t=0|+a.value);var i=game.guildExchangeData,n=t-i.resetTimes;n<0&&(n=0),e._nextTime=i.nextRefreshTime,e.skin.labRefreshCount.string=game.Lang.get(9515,n)},onShow:function(){var e=this;e._updataItemList(),e._updateRefreshCount(),e._tickTimer||(e._tickTimer=b8e.Timer.add(e,e._onTickTime,1e3)),e._tickTimer.reset(),e._tickTimer.start()},_onTickTime:function(){var e=this,t=game.SysTime.curTime,a=e._nextTime-t;e.skin.labRefreshTime.string=game.Lang.get(9514,b8e.TimeUtil.formatTime(a))},onHide:function(){var e=this;e._tickTimer&&e._tickTimer.stop()},onStageResize:function(){var e=this;e._super();var t=b8e.stageWidth,a=b8e.stageHeight;e.setPosition(.5*(t-e.width),a-.5*(a-e.height))}});b8e.module.registerView(game.ME.GuildExchange,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(541)},init:function(){var e=this,t=0,a=21,i=game.GuildMiscCfg.getData("guildMapResetCost");if(i){var n=i.value.split(",");t=0|+n[1],a=0|+n[0]}var s=game.ItemInfoCfg.getData(a);if(s&&s.icon){var o=game.ResCfg.getUrl(137,s.icon);e.skin.moneySprite.loadTexture(o)}e.skin.labMoneyCost.string=t+""},notify:function(){},onShow:function(){var e=this,t=0,a=game.mainRoleData.vipLevel,i=game.VipCfg.getData(a),n=0;if(game.guildCollectData.isCollectReset){if(e.skin.lab1.string=game.Lang.get(6592),i){t=i.guildMapReset2}n=t-game.guildCollectData.collectResetCount}else{if(e.skin.lab1.string=game.Lang.get(6593),i){t=i.guildMapReset1}n=t-game.guildCollectData.challengeResetCount}if(n<0){n=0}e.skin.labCount.string=game.Lang.get(1907,n)},onHide:function(){},onStageResize:function(){var e=this;e._super();var t=b8e.stageWidth,a=b8e.stageHeight;e.setPosition(.5*(t-e.width),a-.5*(a-e.height))}});b8e.module.registerView(game.ME.GuildTaskResetAlert,e)}(),function(){var e;e=b8e.Enum({None:0,V_UPGRADE_SKILL:-1,V_UPDATE_SKILL:-1,V_INIT_SKILL:-1,V_UPDATE_AMOUNT:-1}),b8e.RC("$$game","$$GuildSkillEvts",e)}(),function(){var e=game.Control.extends({reqLock:!1,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.GUILD_SKILL,game.SAE.GUILD)},ipc:function(){this.evts={Back:{C_UPDATE_AMOUNT:this.updataAmount},Guild:{C_INIT_MODEL:this.initModel,C2C_UPDATE_GUILD_ACTIVE:this.checkAlert},GuildMember:{C2C_UPDATE_GUILD_ACTIVE:this.checkAlert}},this.handels={GuildSkillResp:this.guildSkillResp}},notify:function(e){switch(e){case this.Evts.V_INIT_SKILL:this.initSkill()}},initModel:function(){this.checkAlert()},initSkill:function(){this.send(this.Evts.V_INIT_SKILL)},guildSkillResp:function(e){var t=e.readProtobuf(game.pb.GuildSkillResponse);if(this.reqLock=!1,0<t.code){game.notice.noticeError(t.code)}else game.guildSkillData.upgradeSkillData(t.group),this.checkAlert(),this.send(this.Evts.V_UPDATE_SKILL,t.group)},updataAmount:function(){this.checkAlert(),this.send(this.Evts.V_UPDATE_AMOUNT)},upgradeBtn:function(){var e=game.guildSkillData.curSelectGroup,t=game.guildData.level;if(s=game.GuildLvCfg.getData(t)){var a=s.skillLv,i=game.guildSkillData.getDataByGroup(e);if(i)if(i.isActive&&i.level>=a){game.notice.show(1673)}else{var n=i.level;i.isActive&&(n=i.level+1);var s=game.GuildSkillCfg.getData(e,n);if(game.UpgradeUtil.checkAmountByType(game.AmountType.MILITARY,s.contribution))if(this.reqLock);else this.reqLock=!0,this.sender.GuildSkillReq(e);else;}}else;},checkAlert:function(){if(0!=game.guildData.id){var e=game.guildSkillData.getCurSelectGroup(),t=game.guildSkillData.getDataByGroup(e),a=game.guildData.level;if((s=game.GuildLvCfg.getData(a))&&t){var i=s.skillLv;if(t.isActive&&t.level>=i){this.spotAlert.alert=!1}else{var n=game.GuildLvCfg.getMaxSkillLv();if(t.level>=n){this.spotAlert.alert=!1}else{var s,o=t.level;if(t.isActive&&(o=t.level+1),s=game.GuildSkillCfg.getData(e,o))this.spotAlert.alert=game.UpgradeUtil.checkAmountByType(game.AmountType.MILITARY,s.contribution,!1);else{this.spotAlert.alert=!1}}}}else{this.spotAlert.alert=!1}}else{this.spotAlert.alert=!1}}}),t=game.Sender.extends({ipc:function(){this.msg={GuildSkillReq:this.guildSkillReq}},guildSkillReq:function(e){var t=game.pb.GuildSkillRequest;t.group=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.GuildSkill,e,game.GuildSkillEvts,t)}(),function(){var e=b8e.Object.extends({curSelectGroup:0,power:0,skillSprite:null,lastGroup:0,ctor:function(){this._super(),this.skillMap=b8e.HashMap.get()},initSkillData:function(){var e=this;e.skillGroupList=game.GuildSkillCfg.getInitSkill();var t=e.skillGroupList;if(!t||t.length<1);else{var a=t.length-1;e.lastGroup=t[a],e.curSelectGroup=t[0]}},setSkillData:function(e){var t=this;if(t.skillSprite)t.skillSprite.clear();else{t.skillSprite=game.SpriteStat.get()}t.power=0,t.curMaxSkillLv=0,t.curMinSkillLv=0;var a=game.GuildSkillCfg.getData(1,1);if(a&&(t.skillSprite.setupByCfg(a,!0,!0),t.skillSprite.setZero(),t.skillSprite.delSpriteByType(game.SpriteStatType.TeamSpeed)),!e||e.length<1){t.curSelectGroup=1}else{var i=e.length<t.lastGroup;if(i){t.curSelectGroup=e.length+1}e.sort(this.onSort);for(var n,s=e.length,o=0,r=void 0,g=void 0,l=void 0,c=void 0,h=0;h<s;h++){if(l=(n=e[h]).level,c=n.group,!(r=t.skillMap.get(c))){r=new game.GuildSkillInfo,t.skillMap.set(c,r)}if(r.setData(n),1==l?(g=game.GuildSkillCfg.getData(c,l),t.skillSprite.addByCfg(g),t.power=t.skillSprite.getPower()):t.initSkillSAP(c,l),!i){if(0==o||l<o){o=l,t.curSelectGroup=c}}if(0==t.curMinSkillLv||t.curMinSkillLv>l){t.curMinSkillLv=l}if(t.curMaxSkillLv<l){t.curMaxSkillLv=l}}}},initSkillSAP:function(e,t){var a=game.GuildSkillCfg.getSkillSpaceList(e);if(a&&!(a.length<1))for(var i=void 0,n=1,s=void 0,o=void 0,r=0;r<t;r++)if(1==(i=a[r]))o=game.GuildSkillCfg.getData(e,i),this.funcA(o,1);else{if(n=a[r-1],t<i)return s=t-n,o=game.GuildSkillCfg.getData(e,n),void this.funcA(o,s);s=i-n,o=game.GuildSkillCfg.getData(e,n),this.funcA(o,s)}},funcA:function(e,t){this.skillSprite.addByCfg(e,!0,t),this.power=this.skillSprite.getPower()},onSort:function(e,t){return e.group-t.group},upgradeSkillData:function(e){var t=this,a=t.skillMap.get(e);if(a.isActive)a.level++;else{a.isActive=!0}if(t.updateSprite(e),t.curMaxSkillLv=a.level>t.curMaxSkillLv?a.level:t.curMaxSkillLv,t.curSelectGroup=e<t.lastGroup?e+1:1,e==t.lastGroup){t.curMinSkillLv=a.level}},updatePower:function(e){var t=this.skillMap.get(e);if(t){e=t.group;var a=t.level,i=game.GuildSkillCfg.getData(e,a).power;this.power+=i}else;},updateSprite:function(e){if(!this.skillSprite){this.skillSprite=game.SpriteStat.get()}var t=this.skillMap.get(e);if(t){e=t.group;var a,i=t.level;a=game.GuildSkillCfg.getData(e,i),this.skillSprite.addByCfg(a),this.power=this.skillSprite.getPower()}else;},getGroupList:function(){return this.skillGroupList},getDataByGroup:function(e){var t=this.skillMap.get(e);if(!t){var a=game.GuildSkillCfg.getData(e,1);if(!a){return null}(t=new game.GuildSkillInfo).initData(a),this.skillMap.set(e,t)}return t},getSprite:function(){return this.spriteStat},getPower:function(){return this.skillSprite?this.skillSprite.getTeamPower():0},getCurSelectGroup:function(){return this.curSelectGroup},getMaxSkillLv:function(){return this.curMaxSkillLv},getMinSkillLv:function(){return this.curMinSkillLv}});game.guildSkillData=game.guildSkillData||new e}(),function(){var e;e=b8e.Object.extends({group:0,level:0,isActive:!1,ctor:function(){this._super()},setData:function(e){this.group=e.group,this.level=e.level,this.isActive=!0},initData:function(e){this.group=e.group,this.level=e.level,this.isActive=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuildSkillInfo",e)}(),function(){var e;e=game.GameIcon.extends({_itemGrid:null,ctor:function(e){if(!e){e=game.IconSizeEnum.CIRCLE_SIZE_104}this._super(e)},setItemInfo:function(e,t){var a,i=this,n=(i.skillInfo=e).isActive;if(n){a=e.level}else a=0;if(i._cfg=game.GuildSkillCfg.getData(e.group,e.level),i._cfg){var s=game.ResCfg.getUrl(n?94:95,i._cfg.icon);i.setIcon(s),i.setLv(a)}else;},setLabBg:function(){if(!this._labBg){this._labBg=b8e.Sprite.get(),this._labBg.setStyle(b8e.SpriteStyle.SLICED),this._labBg.setAnchor(.5,.5)}this._labBg.setVisible(!0),this._labBg.scale9Inset={top:3,bottom:3,left:3,right:3},this._labBg.loadTexture(game.ResCfg.getUrl(30))},setLabBgPos:function(){if(this._labBg){this._labBg.setPosition(0,-76)}},setLabBgSize:function(){if(this._labBg){this._labBg.setSize(50,20)}},setLv:function(e,t,a){if(e<1){if(this._lvText){this._lvTextString="",this._lvText.setText(""),this._lvText.setVisible(!1)}if(this._labBg&&this._labBg.parent){this._labBg.removeFromParent()}}else{if(e="+"+e,!this._lvText){this._lvText=this.getLabText(a,t)}if(this._lvTextString!=e){this._lvTextString=e,this._lvText.setText(e)}if(this.setLabBg(),this._labBg&&!this._labBg.parent){this.addChild(this._labBg)}if(this._lvText&&!this._lvText.parent){this.addChild(this._lvText)}this.setLabLvPos()}},setLabLvPos:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=-this._lvText.width/2;this._lvText.setPosition(i+a,-40)},getLabText:function(e,t){t=t||game.Color.WHITE,e=e||18;var a=b8e.Label.get();return a.setFontSize(e),a.setLineHeight(e+2),a.setColor(t),a},addLabLvText:function(){if(this._lvText&&!this._lvText.parent){this.addChild(this._lvText)}},addLabBg:function(){if(this._labBg&&!this._labBg.parent){this.addChild(this._labBg)}},clearData:function(){if(this._iconImg){this._iconImg.removeFromParent()}if(this._lvText){this._lvText.removeFromParent()}if(this._labBg){this._labBg.removeFromParent()}}}),b8e.RC("$$game","$$GuildSkillIcon",e)}(),function(){var e=game.View.extends({skillIconList:null,str:"",ctor:function(){this._super(543),this.spotAlerts={}},notify:function(e,t){var a=this;switch(e){case a.Evts.V_UPDATE_SKILL:a.setSpriteStat(),a.setMaxLv(),a.setSelect(),a.updateSkillIcon(t),a.setCurSprite();break;case a.Evts.V_INIT_SKILL:a.setSkillIcon();break;case a.Evts.V_UPDATE_AMOUNT:a.setCost()}},init:function(){this.skillIconList=[],this.send(this.Evts.V_INIT_SKILL);var e=this.costIcon=b8e.Sprite.get();e.addToParent(this.skin.costImg),e.setAnchor(.5,.5),e.setSize(40,40);var t=game.amount.getCfgByType(game.AmountType.MILITARY);t&&e.loadTexture(game.ResCfg.getUrl(137,t.icon))},onShow:function(){this.setSelect(),this.setMaxLv(),this.setSpriteStat(),this.setCurSprite(),this.setCost()},onHide:function(){},setSpriteStat:function(){var a=this,e=game.guildSkillData,t=e.skillSprite.getSpriteStats(),i=0,n="",s=void 0,o=a.skin;if(t.forEach(function(e,t){e=+e,s=game.AttrRulesCfg.getData(e),n=game.Lang.get(1655,s.name,t),a.getComponent("spriteLab_"+i).string=n,i++},a),""==n)for(var r=901;r<=908;r++)s=game.AttrRulesCfg.getData(r),n=game.Lang.get(1655,s.name,0),a.getComponent("spriteLab_"+i).string=n,i++;o.power.string=e.getPower(),game.AutoLayoutUtil.layoutPower(o.powerImg,o.power,o.powerImg2)},setMaxLv:function(){var e=game.guildData.level,t=game.GuildLvCfg.getData(e);if(t){var a=game.guildSkillData.getMaxSkillLv(),i=game.GuildLvCfg.getMaxSkillLv(),n=game.guildSkillData.getMinSkillLv();this.skin.upgradeBtn.node.active=n<i,this.skin.levelLimit.string=game.Lang.get(1656,a,t.skillLv)}},setSelect:function(){var e=game.guildSkillData.getCurSelectGroup()-1,t=this.getComponent("icon_"+e);this.skin.selectImg.node.setPosition(t.x,t.y)},setSkillIcon:function(){var e=game.guildSkillData.getGroupList();if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=void 0,n=e.length,s=0;s<n;s++)(i=e[s])&&(this.skillIconList[s]||(this.skillIconList[s]=game.GridUtil.createGuildSkillIcon(),this.skillIconList[s].addToParent(this.getComponent("icon_"+s))),t=this.skillIconList[s],a=game.guildSkillData.getDataByGroup(i),game.GridUtil.setItemIcon(t,a))},updateSkillIcon:function(e){var t=game.guildSkillData.getDataByGroup(e),a=e-1;this.skillIconList[a]||(this.skillIconList[a]=game.GridUtil.createGuildSkillIcon(),this.skillIconList[a].addToParent(this.getComponent("icon_"+a)));var i=this.skillIconList[a];game.GridUtil.setItemIcon(i,t),this.playAnim(a)},playAnim:function(e){if(this.animList||(this.animList=[]),!this.animList[e]){var t=b8e.Animator.get(game.AnimType.UI_EFFECT,e);t.addToParent(this.getComponent("anim_"+e)),t.addFinishCallback(this.onComplete,this,[e]),t.load(game.ResCfg.getUrl(5019,1010)),t.setVisible(!1),this.animList[e]=t}this.animList[e].setVisible(!0),this.animList[e].play(null,0)},onComplete:function(e,t){this.animList[t].setVisible(!1)},setCurSprite:function(){var a=this,e=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=0,t=a.skin,g=!1;a.str="";var l=game.guildSkillData.getCurSelectGroup(),c=game.guildSkillData.getDataByGroup(l);t.leftSprite.active=c.isActive,t.notActiveLab.active=!c.isActive,c.isActive&&(r=c.level,(e=game.GuildSkillCfg.getData(l,r))?(s=0,o="",a._curSpriteStat||(a._curSpriteStat=game.SpriteStat.get()),a._curSpriteStat.setupByCfg(e),a._curSpriteStat.getSpriteStats().forEach(function(e,t){0!=s&&(o="<br/>"),e=+e,i=game.AttrRulesCfg.getData(e),n=o+game.Lang.get(1658,i.name,t*r),a.str+=n,s++},a),t.arrowImg1.active=2==s,t.arrowImg2.active=3==s,t.leftSprite.string=a.str,t.bg3.height=50+t.leftSprite.height,g=!0):t.leftSprite.string="");var h=game.GuildLvCfg.getMaxSkillLv()<++r;t.maxImg.node.active=h,t.rightSprite.node.active=!h,t.costNode.active=!h,h||((e=game.GuildSkillCfg.getData(l,r))?(a.str="",s=0,o="",a._nextspriteStat||(a._nextspriteStat=game.SpriteStat.get()),a._nextspriteStat.setupByCfg(e),a._nextspriteStat.getSpriteStats().forEach(function(e,t){0<s&&(o="<br/>"),e=+e,i=game.AttrRulesCfg.getData(e),n=o+game.Lang.get(1658,i.name,t*r),this.str+=n,s++},a),t.rightSprite.string=a.str,g||(t.arrowImg1.active=2==s,t.arrowImg2.active=3==s,t.bg3.height=50+t.rightSprite.height)):t.rightSprite.string="")},setCost:function(){var e=this.skin,t=game.guildSkillData.getCurSelectGroup(),a=game.guildSkillData.getDataByGroup(t),i=game.GuildLvCfg.getMaxSkillLv(),n=game.amount.get(game.AmountType.MILITARY);if(a.level+1>i)e.cost.string=game.Lang.get(1659,0,n);else{var s=(a.isActive?game.GuildSkillCfg.getData(t,a.level+1):game.GuildSkillCfg.getData(t,a.level)).contribution,o=s<=n,r=game.HtmlUtil.IsEnoughGOR(o,!0),g=game.HtmlUtil.getText(r,n);e.cost.string=game.Lang.get(1621,g,s),game.AutoLayoutUtil.layoutHorizontal(game.AutoLayoutUtil.CENTER,e.costNode,e.costLeftLab,e.costImg,e.cost)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuildSkill,e)}(),function(){var e=game.TeamControl.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.GUILD_TEAM),this.curTeamInstType=game.TeamInstType.GUILD_TEAM,this.memberIds=[],this.teamData=game.guildTeamData,this.teamData.initData()},ipc:function(){var e=this;e.evts={TeamHandel:{C_SET_TEAM:e._setTeamData,C_TEAM_CREATE:e._createTeam,C_TEAM_JOIN:e._joinTeam,C_TEAM_LEAVE:e._leaveTeam,C_KICK_MEMBER:e._kickMember,C_TEAM_QUICK_JOIN:e._quickJoinTeam,C_TEAM_JOIN_NOTIFY:e._joinTeamNotify,C_TEAM_LEAVE_NOTIFY:e._leaveTeamNotify,C_ENTER_BATTLE:e._enterBattle,C_BATTLE_END:e._battleEnd,C2C_TEAM_EMBATTLE:e._teamEmbattle,C2C_TEAM_PARTNER_TEAM_EMBATTLE:e._partnerTeamEmbattle,C2C_TEAM_INVITE_COOL_TIME:e._teamInviteCoolTime},Guild:{C2C_UPDATE_GUILD_ACTIVE:e.checkAlert,C_UPDATE_GUILD:e.updateGuild},GuildMember:{C2C_UPDATE_GUILD_ACTIVE:e.checkAlert},MainUIChat:{C_REQ_ENTER_TEAM:e.inviteJoin},ZhanJiang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},ZhaoQin:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},BaoZang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Hunting:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Scene:{ENTER_CS_SCENE:e.stopAutoBattle,C2C_RECONNECT_ENTER_SCENE:e.reconnect}}},notify:function(e,t,a){var i=this;switch(e){case i.Evts.V_SHOW_VIEW:i.showView();break;case i.Evts.V_KICK_MEMBER:i.kickMember(t);break;case i.Evts.V_JOIN_TEAM:i.joinTeam(t,a);break;case i.Evts.V_SELECT_BOSS:i.selectBoss(t);break;case i.Evts.V_HIDE_VIEW:i.hideView();break;case i.Evts.V2C_TEAM_OPEN_SELECT_PARTNER_PANEL:i.openTeamSelectPartnerPanel(t);break;case i.Evts.V2C_TEAM_CHANGE_BATTLE_PARTNER_REQ:i.partnerTeamEmbattleReq(t);break;case i.Evts.V2C_TEAM_PARTNER_UPDATE_POS_REQ:i.teamPartnerUpdatePosReq();break;case i.Evts.V2C_TEAM_CHECK_TIME:i.checkTime()}},reconnect:function(){this.teamData.clearTeamData(),b8e.module.isShowView(game.ME.GuildTeamDetailsView)&&game.module.hide(game.ME.GuildTeamDetailsView)},openTeamSelectPartnerPanel:function(e){this.teamData&&this.teamData.isInTeam&&(this.setCurSelectPartnerId(e),b8e.module.isShowView(game.ME.GuildTeamSelectPartnerView)||game.module.show(game.ME.GuildTeamSelectPartnerView))},checkInstCanEnter:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t;this.invInstId=0;var i=game.mainRoleData.lv,n=game.TeamInstanceCfg.getData(e);return n?n.limitLv>i?(a&&game.notice.show(9111),!1):(this.invInstId=e,!0):(b8e.error("\u5bf9\u5e94\u7ec4\u961f\u526f\u672c\u914d\u7f6e\u4e0d\u5b58\u5728"),!1)},showTeamInstView:function(){b8e.module.isShowView(game.ME.GuildTeam)||game.module.showToggle(game.ME.Guild,2)},updateGuild:function(){this.teamData.refreshBossList(),this.send(this.Evts.V_REFRESH_BOSS_LIST),this.checkAlert()},_setTeamData:function(e){this._super(e),this.checkAlert()},_battleEnd:function(e){if(e&&e.data){var t=e.data,a=t.type,i=t.rp;if(a==this.curTeamInstType){var n={type:game.InstanceType.GUILD,rewards:i.useritem,exp:i.exp};game.GameViewMgr.inst().hideUnStrongViews(),game.playBack.play(i.battlelog,n),this.teamData.teamBattle(),this.checkAlert(),this.dpt(this.Evts.C2C_CHALLENGE_COUNT)}}},_partnerTeamEmbattle:function(e){e.data.type==this.curTeamInstType&&(b8e.module.isShowView(game.ME.GuildTeamSelectPartnerView)&&game.module.hide(game.ME.GuildTeamSelectPartnerView),this._super(e))},_teamRate:function(e){this._super(e)},createTeam:function(e){b8e.module.isShowView(game.ME.GuildTeamDetailsView)||game.module.show(game.ME.GuildTeamDetailsView),this._super(e)},_leaveTeam:function(e,t){t?this._super(e):this.__leaveTeam(e,1)},_leaveTeamNotify:function(e,t){t?this._super(e):this.__leaveTeam(e,2)},__leaveTeam:function(e,t){if(e&&e.data){e.data.type==this.curTeamInstType&&(1==t?this._leaveTeam(e,!0):2==t&&this._leaveTeamNotify(e,!0),this._openViewState(e))}},_openViewState:function(e){var t=e.data.rp;game.mainRoleData.roleId==t.roleid&&(b8e.module.isShowView(game.ME.GuildTeamDetailsView)&&game.module.hide(game.ME.GuildTeamDetailsView),game.module.showToggle(game.ME.Guild,2))},showView:function(){this._super();var e=0;if(0<this.invInstId)e=this.invInstId,this.teamData.curInsId=e;else if(this.teamData.isInTeam)e=this.teamData.curInsId;else{var t=game.guildData.level;e=game.TeamInstanceCfg.getCurInsId(t,this.curTeamInstType),this.teamData.curInsId=e}this.selectBoss(e)},selectBoss:function(e){var t=this,a=game.TeamInstanceCfg.getData(e);a&&(game.mainRoleData.lv<a.limitLv&&!t.teamData.isInTeam?(t.teamData.isAutoJoin=!1,t.stopAutoTime(),t.send(t.Evts.V_UPDATE_AUTO),t.send(t.Evts.V_UPDATE_TIME)):t.teamData.isInTeam||(t.autoReqTime=0,t.setAutoJoinTime(),t.startAutoReq()),t._super(e))},checkAlert:function(){0!=game.guildData.id?this.spotAlert.alert=0<this.teamData.hasCount:this.spotAlert.alert=!1}}),t=[game.ME.GuildTeamDetailsView,game.ME.GuildTeamSelectPartnerView];b8e.module.registerControl(game.ME.GuildTeam,e,game.TeamEvts,null,t)}(),function(){var e=game.teamData.extends({ctor:function(){this._super(),this.curTeamInstType=game.TeamInstType.GUILD_TEAM},_teamAutoLv:0,teamAutoLv:{get:function(){return this._teamAutoLv||(this._teamAutoLv=this._getVal("teamAutoLv")),this._teamAutoLv}},_maxCount:0,maxCount:{get:function(){return this._maxCount||(this._maxCount=this._getVal("guildInsChallengeNum")),this._maxCount}},_helpAllNum:0,helpAllNum:{get:function(){return this._helpAllNum||(this._helpAllNum=this._getVal("guildInsHelpNum")),this._helpAllNum}},_getVal:function(e){var t=0,a=game.InstanceMiscCfg.getData(e);return a&&(t=0|a.value),t},setTeamData:function(e){var t=this;t.isInTeam||t.clearTeamData(),t.guildHelpNum=e.guildHelpNum>t.helpAllNum?0:t.helpAllNum-e.guildHelpNum,t.hasCount=e.guildChallengeNum>t.maxCount?0:t.maxCount-e.guildChallengeNum,t._recycleTeamInfo(),t._setTeamList(e.list),t.initBossList(),t._setBossInfoList(e.guildinsList)},initBossList:function(){if(!this.isInitData){var e=game.guildData.level;this.isInitData=!0;var t=game.TeamInstanceCfg.getList(game.TeamInstType.GUILD_TEAM);if(t&&!(t.length<=0))for(var a=void 0,i=void 0,n=0,s=t.length;n<s;n++)(a=t[n])&&((i=new game.TeamBossInfo).id=a.id,i.isOpen=a.limitLv<=e,this.bossInfoList.push(i))}},refreshBossList:function(){for(var e=game.guildData.level,t=void 0,a=void 0,i=0,n=this.bossInfoList.length;i<n;i++)(a=this.bossInfoList[i])&&(t=game.TeamInstanceCfg.getData(a.id))&&t.limitLv<=e&&(a.isOpen=!0)},getHelpAllNum:function(){return this.helpAllNum},getHelpNum:function(){return this.guildHelpNum}});game.guildTeamData=game.guildTeamData||new e}(),function(){var e;e=game.TeamBossItem.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:"";t=t||1208,this._super(t)},setData:function(){this._super()},setDesc:function(){var e=this.data,t=this.skin;e.isOpen?(t.desc.node.color=game.Color.GREEN,t.desc.string=game.Lang.get(e.isFirst?10010:10011)):(t.desc.node.color=game.Color.RED,t.desc.string=game.Lang.get(1662,this.cfg.limitLv))}}),b8e.RC("$$game","$$GuildTeamBossItem",e)}(),function(){var e=game.TeamView.extends({ctor:function(){this._super()},init:function(){var e=this;e.teamData=game.guildTeamData,e.curTeamInstType=game.TeamInstType.GUILD_TEAM,e._super(),e.bossList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.bossList.itemRender=game.GuildTeamBossItem,e.bossList.bindEnum=e.moduleEnum,e.bossList.addToParent(e.skin.bossList),e.bossList.layout.spacingX=0},onShow:function(){this._super()},onHide:function(){this._super()},setCount:function(){this._super();var e=this.teamData.getHelpAllNum(),t=this.teamData.getHelpNum();this.skin.doubleTimeLab.string=game.Lang.get(1663,t,e)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuildTeam,e)}(),function(){var e=game.TeamDetailsView.extends({ctor:function(){this._super(),this.bindModuleEnum=game.ME.GuildTeam},init:function(){this._super(),this.teamData=game.guildTeamData,this.curTeamInstType=game.TeamInstType.GUILD_TEAM},onHide:function(){this._super(),game.module.showToggle(game.ME.Guild,0)}});b8e.module.registerView(game.ME.GuildTeamDetailsView,e)}(),function(){var e=game.TeamSelectPartnerView.extends({ctor:function(){this._super(),this.bindModuleEnum=game.ME.GuildTeam}});b8e.module.registerView(game.ME.GuildTeamSelectPartnerView,e)}(),function(){var e;e=b8e.Enum({None:0,SHOW_ENTRANCE:-1,V_SHOW_VIEW:-1,C2V_CHANGE_OPENSERVER:-1,V_HOME_RESIZE:-1,C_HOME_RESIZE:-1,C2V_CLOSE_BANNER:-1,C2V_CHANGE_BANNER:-1,C2V_VIP_CHANGE:-1,C2V_SHOW_MHM_VIEW:-1,C2C_SHOW_VIEW:-1,CSC_OPEN_CHANGE:-1,C2C_ACTBAR_COMPLETE:-1,V_HIDE_VIEW:-1,C2C_HIDE_VIEW:-1,C_ENTER_GUILD_CONFLICT:-1,C2V_UPDATE_SHRINK_BTN:-1}),b8e.RC("$$game","$$HomeEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_RESET_GROUP:-1}),b8e.RC("$$game","$$LuckyTurnEvts",e)}(),function(){var e=game.BaseActiveBarControl.extends({ipc:function(){this._super()},notify:function(e){switch(e){case this.Evts.V2C_INIT_ACTIVE_BAR:this.onInitActiveBar();break;case this.Evts.C2C_REFRESH_ACTIVE_BAR:this.refreshActiveBar()}},onInitActiveBar:function(){this.dpt(this.Evts.C2C_INIT_ACTIVE_BAR)},refreshActiveBar:function(){this.dpt(this.Evts.C2C_REFRESH_ACTIVE_BAR)},btn_open1:function(){this.send(this.Evts.C2V_OPEN_ACTIVEBAR_GROUP,1)},btn_open2:function(){this.send(this.Evts.C2V_OPEN_ACTIVEBAR_GROUP,2)}});b8e.module.registerControl(game.ME.ActiveBar,e,game.ActiveBarEvts)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.LUCKYTURN,game.SAE.HOME)},ipc:function(){this.evts={ActiveBar:{C2C_INIT_ACTIVE_BAR:this.checkAlert},Recharge:{C_GET_CARD_AWARD:this.checkAlert},PetTurnplate:{C2C_PET_TURN_ALERT:this.checkAlert,C2C_RESET_GROUP:this.resetIcon},PetTurnAward:{C2C_PET_TURN_ALERT:this.checkAlert},MainRole:{C_RESET_DAILY:this.checkAlert}}},checkAlert:function(){this.spotAlert.alert=game.luckyTurnData.checkAlert()},resetIcon:function(){this.send(this.Evts.C2V_RESET_GROUP)}});b8e.module.registerControl(game.ME.LuckyTurn,e,game.LuckyTurnEvts)}(),function(){var e=game.Control.extends({init:function(){b8e.evt.addG(this,game.TriggerEvts.C_TRIGGER_OPEN,this.moduleOpen)},ipc:function(){this.evts={Recharge:{C_INIT_MODEL:this.vipBannerCheck,C_RECHARGE_SUCCESS:this.vipBannerCheck},MainRole:{C_VIP_LEVEL_CHANGE:this.changeVipLevel},MainUIHeadMiddle:{C2C_SHOW_MHM_VIEW:this.showMHMView},HomeRightBar:{C2C_REFRESH_VIEW_STATE:this.refreshViewState},HomeBottomBar:{C2C_REFRESH_VIEW_STATE:this.refreshViewState}}},moduleOpen:function(e){if(e&&e.data)switch(e.data){case game.ME.Guild:case game.ME.Boss:case game.ME.InstanceFunc:case game.ME.ActivitiesHall:case game.ME.Cs:case game.ME.ArenaMain:case game.ME.ChallengeCbp:case game.ME.TeamLeague:case game.ME.GuildConflictMain:this.send(this.Evts.CSC_OPEN_CHANGE)}},notify:function(e){var t=this;switch(e){case t.Evts.V_SHOW_VIEW:game.module.showTab(game.ME.ActiveBar,t.moduleEnum,!1),game.module.showTab(game.ME.HomeLeftBar,t.moduleEnum,!1),game.module.showTab(game.ME.HomeRightBar,t.moduleEnum,!1),game.module.showTab(game.ME.HomeBottomBar,t.moduleEnum,!1),game.module.showTab(game.ME.HomeRightTop,t.moduleEnum,!1),t.dpt(t.Evts.C2C_SHOW_VIEW);break;case t.Evts.V_HOME_RESIZE:t.dpt(t.Evts.C_HOME_RESIZE);break;case t.Evts.V_HIDE_VIEW:t.dpt(t.Evts.C2C_HIDE_VIEW)}},guildBtn:function(){if(0!=game.guildData.id){game.module.show(game.ME.Guild)}else game.module.show(game.ME.GuildRecommend)},bossBtn:function(){game.module.show(game.ME.Boss)},instfuncBtn:function(){game.module.show(game.ME.InstanceFunc)},activityBtn:function(){game.module.show(game.ME.ActivitiesHall)},csBtn:function(){game.module.show(game.ME.Cs,null,!0)},arenaBtn:function(){game.module.show(game.ME.ArenaMain)},bannerBtn:function(){game.module.show(game.ME.VipBanner),game.vipData.closeHomeBanner=!0,this.send(this.Evts.C2V_CLOSE_BANNER)},challengeBtn:function(){game.module.show(game.ME.ChallengeCbp)},vipBannerCloseBtn:function(){game.vipData.closeHomeBanner=!0,this.send(this.Evts.C2V_CLOSE_BANNER)},vipBannerCheck:function(){this.send(this.Evts.C2V_CHANGE_BANNER)},changeVipLevel:function(){this.send(this.Evts.C2V_VIP_CHANGE)},refreshViewState:function(){this.send(this.Evts.C2V_UPDATE_SHRINK_BTN)},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},vipBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP)},showMHMView:function(){this.send(this.Evts.C2V_SHOW_MHM_VIEW)},teamLeagueBtn:function(){game.module.show(game.ME.TeamLeague)},shopBtn:function(){game.module.show(game.ME.Shop)},mysteryShopBtn:function(){game.module.show(game.ME.MysteryShopFrame)},guildConflictBtn:function(){this.dpt(this.Evts.C_ENTER_GUILD_CONFLICT)}});b8e.module.registerControl(game.ME.Home,e,game.HomeEvts)}(),function(){var e=game.BaseActiveBarControl.extends({ipc:function(){var e=this;e._super(),e.evts.Home={C_HOME_RESIZE:e.refreshBtn}}});b8e.module.registerControl(game.ME.HomeLeftBar,e,game.ActiveBarEvts)}(),function(){var e=game.BaseActiveBarControl.extends({ipc:function(){var e=this;e._super(),e.evts.Home={C_HOME_RESIZE:e.refreshBtn}}});b8e.module.registerControl(game.ME.HomeRightBar,e,game.ActiveBarEvts)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={MainRole:{C_LEVEL_UP:this.refreshBtn},Home:{C_HOME_RESIZE:this.refreshBtn}},this.gevts={TriggerEvts:{C_TRIGGER_OPEN:this.triggerOpen}}},triggerOpen:function(){this.refreshBtn()},refreshBtn:function(){this.lock||(this.lock=!0,b8e.setTimeout(this._refreshBtn,this,1e3))},_refreshBtn:function(){this.lock=!1,this.send(this.Evts.V_REFRESH_BTNS)}});b8e.module.registerControl(game.ME.HomeBottomBar,e,game.ActiveBarEvts)}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(1)},getDatas:function(){return game.ActiveBarCfg.getDatas()},getData:function(e){return game.ActiveBarCfg.getData(e)},setLuckyTurnPos:function(e){this.luckypos=e},getLuckyTurnPos:function(){return this.luckypos},setLimitGiftPos:function(e){this.limitGiftPos=e},getLimitGiftPos:function(){return this.limitGiftPos},getLuckyTurnArr:function(){return this.luckyTurnArr}});game.activeBarData=game.activeBarData||new e}(),function(){var e=void 0;(e=b8e.Object.extends({spotAlertEnum:0,alert:!1,id:0,sortId:0,miscData:null,cfg:null,width:0,height:0,countDown:0,groupType:0,groupPriority:0,offsetX:0,offsetY:0,isShrink:!1,setMiscData:function(e){if(e){this.miscData=e,this.width=e.iconWidth,this.height=e.iconHeight,this.isShrink=!e.defaultOpen}},setBaseData:function(e){this.id=e.id},setData:function(e){var t=this;t.id=e.id,t.sortId=e.sortId,t.shrinkSortId=e.shrinkSortId,t.activeBarType=e.activeBarType,void 0===e.groupType&&b8e.warn("\u6ce8\u610f\uff1a\u65b0\u589e\u652f\u6301\uff0c\u83dc\u5355\u914d\u7f6e\u8868\u4e2d\uff1a["+e.desc+"]\u6240\u5728\u8868\u9700\u8981\u589e\u52a0groupType:uint32[\u5206\u7ec4\u7c7b\u578b]\u5b57\u6bb5\uff01"),t.groupType=0|+e.groupType,void 0===e.groupPriority&&b8e.warn("\u6ce8\u610f\uff1a\u65b0\u589e\u652f\u6301\uff0c\u83dc\u5355\u914d\u7f6e\u8868\u4e2d\uff1a["+e.desc+"]\u6240\u5728\u8868\u9700\u8981\u589e\u52a0groupPriority:uint32[\u5206\u7ec4\u4f18\u5148\u7ea7]\u5b57\u6bb5\uff01"),t.groupPriority=0|+e.groupPriority;var a=0|+e.iconWidth,i=0|+e.iconHeight;0<a&&(t.width=e.iconWidth),0<i&&(t.height=e.iconHeight),t.offsetX=e.iconOffsetX?e.iconOffsetX:0,t.offsetY=e.iconOffsetY?e.iconOffsetY:0,t.cfg=e},setShrink:function(e){this.cfg.activeBarType==game.ActiveBarItemType.SHRINK_BTN&&(this.isShrink=e)},getUrl:function(){var e="",t=this.cfg;if(t){var a=t.titleBg?t.titleBg:"";t.isFestival&&(a=game.festivalData.getMenuIconByOrigin(t.activeBarType));var i=void 0,n=game.ActiveBarItemType;switch(t.activeBarType){case n.FUNC_NOTICE:a=game.funcNoticeData.getNextOpenIcon();break;case n.TODAY_FUNC_NOTICE:a=game.funcNoticeData.getCurOpenIcon();break;case n.SHRINK_BTN:a=this.isShrink?t.shrinkImg+"_open":t.shrinkImg+"_shrink";break;case n.OPEN_SERVER:var s=game.miscData.openServerDay;(i=game.OpenServerBtnCfg.getCfgByDay(s))?e=game.ResCfg.getImgUrl(i.btnUrl):a=t.titleBg;break;case n.TEMPLE:(i=game.TempleOpenCfg.getData(game.incenseData.openActiveId))?e=game.ResCfg.getImgUrl(i.titleBg):a=t.titleBg;break;case n.MIBAO:(i=game.mibaoData.curCfg)&&i.mainIcon&&(e=game.ResCfg.getImgUrl(i.mainIcon))}return game.IS_WANBA&&t.wanbaBg&&(a=t.wanbaBg),a&&(e=game.ResCfg.getImgUrl(a)),e}},getEffData:function(){if(this.cfg){var e=game.ActiveBarItemType,t=void 0;switch(this.cfg.activeBarType){case e.MIBAO:(t=game.mibaoData.curCfg)&&(this.effData||(this.effData=b8e.createMap()),this.effData.effect=t.effect,this.effData.effectOffectX=t.effectOffectX,this.effData.effectOffectY=t.effectOffectY);break;default:return this.cfg}return this.effData}}})).poolCall=!0,b8e.RC("$$game","$$ActiveBarInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,DISCOUNT_RECHARGE:1,TODAY_DISCOUNT_RECHARGE:2,DAILY_RECHARGE:3,FUND:4,WELFARE:5,INVESTMENT:6,DIANWEI:7,TURNPLATE:8,QUANMINJINJIE:9,MONTH_CARD:10,DAILY:11,BACK:12,MAIL:13,RELATION:14,YUANBAO_SHOP:16,WANFA_SHOP:17,INSTFUNC_SHOP:18,ARENA_SHOP:19,PEACHGARDEN:20,LOGINAWARDS:21,OPEN_SERVER:22,SALE_RECHARGE:23,WEEK_CARD:24,CHOOSE_RECHARGE:25,SWITCH_ACCOUNT:26,UPGRADEREBATE:27,ACTIVE_NOTICE:28,FREE_GIFT:29,SHARE_ACHIEVE:30,WAR_BOOK:31,LUCKY_TURNPLATE:32,PET_TURNPLATE:33,ACCUMULATIVE_RECHARGE:34,MILITARY:35,VERIFY_NAME:36,VERIFY_VIPCN:37,VERIFY_WEIDUAN:38,VERIFY_COLLECTION:39,VERIFY_ADD_SHORTCUT:40,FIRST_RECHARGE:41,FESTIVAL:42,STICK:43,TIME_LIMIT_GIFT:44,PROGRESS_GOAL:47,ACC_COST:48,QQ_INTEREST_TRIBE:50,QQ_VIP_PRIVILEGE:51,WUSHENG:54,ONLINEGIFT:55,FUNC_NOTICE:56,STRONGER:57,SHINV_ADV:58,FOREVER_CARD:59,FIGHTPOS_NOTICE:60,GOOD_GIFT:61,ACC_CON_CARNIVAL:62,AUCTION:64,GROW_GIFT:65,MYSTERY_SHOP:66,MERGE_SERVER:67,MERGE_FREE_GIFT:68,TODAY_FUNC_NOTICE:70,REBATE_AWARD:71,PUZZLE:72,SMASH_GOLD_EGG:73,PET_HOME:74,QQ_VIP_GIFT:75,ACTIVE_LEVEL_UP:76,XINYUE:77,MORE_EXCITING:78,MONOPOLY:79,VIP_WELFARE:80,SHRINK_BTN:81,CROSS_SERVICE_RANK_COST:83,CROSS_SERVICE_RANK_RECHARGE:84,SUPER_VIP:85,BIND_MOBILE:86,DIG_TREASURE:87,SPECIAL_OFFER:89,CHAIN_GIFT:90,QUEST_LINK:91,DAILY_FULI:92,QQ_VIEW_DAILY_RECHARGE:93,LUCKY_TURNPLATE_LIST:94,FUDAI:96,FESTIVAL_RECHARGE:97,JUBAOPEN:98,FOLLOW_GIFT:99,FESTIVAL_BOSS_CS:101,TREASURE_PAVILION:102,TEMPLE:103,COMRADE_BACK:104,REGRESS_ACTIVITY:105,REWARDER:107,CATCH_PET:106,LIMIT_GIFT:108,COLOR_TICKET:109,WUSHENG2:110,WUSHENG3:111,WUSHENG4:112,PUSH_PRIZE_RECHARGE:113,MY_MAP:114,RANK:115,WAR_ORDER:116,MONEY_CAT:117,HUNLU:118,PARTNER_GIFT:119,OPEN_COMPETITION:120,OPEN_SER_CARNIVAL:121,COFFERS:122,QQ_REDPACKET:123,VALUE_REBATE:124,BOON_RECHARGE:125,SHELL:126,SCRATCH:127,MOBILE_BIND:128,HUNTING_CONTEST:129,DAYORWEEK:130,ONEYUANBUY:131,NEWFIRSTCHARGE:132,NEW_COMPETITION:134,WELFARETARGET:133,PARTNER_BACK:135,REBORN:136,DAILY_WISH:137,LIMIT_EXCHANGE:138,LIMIT_SALE_PRIZE_ACTIVE:139,MIBAO:140,OPTIONAL_LOTTERY:141,WEEK_ACTIVITY:142,QQVIDEO:143,QM_STAR_1:144,QM_STAR_2:145}),b8e.RC("$$game","$$ActiveBarItemType",e)}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(2)},getDatas:function(){return game.HomeLeftBarCfg.getDatas()},getData:function(e){return game.HomeLeftBarCfg.getData(e)}});game.homeLeftBarData=game.homeLeftBarData||new e}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(3)},getDatas:function(){return game.HomeRightBarCfg.getDatas()},getData:function(e){return game.HomeRightBarCfg.getData(e)}});game.homeRightBarData=game.homeRightBarData||new e}(),function(){var e=game.GameMenuBarData.extends({ctor:function(){this._super(4)},getDatas:function(){return game.HomeBottomBarCfg.getDatas()},getData:function(e){return game.HomeBottomBarCfg.getData(e)}});game.homeBottomBarData=game.homeBottomBarData||new e}(),function(){var e=b8e.Object.extends({btnList:null,ctor:function(){this.btnList=[]},checkAlert:function(){this.btnList&&0!=this.btnList.length||this.setItemList();for(var e=this.btnList.length,t=0;t<e;t++)if(this.btnList[t].alert)return!0;return!1},setItemList:function(){var e=game.activeBarData.getLuckyTurnArr();if(e&&0!=e.length){this.btnList=[];for(var t=e.length,a=void 0,i=void 0,n=0;n<t;n++)a=e[n],(i=new game.LuckyTurnInfo).setData(a),this.btnList.indexOf(i)<0&&this.btnList.push(i);this.btnList.sort(this.onSort)}},getItemList:function(){return this.btnList}});game.luckyTurnData=game.luckyTurnData||new e}(),function(){var e;e=b8e.Object.extends({data:null,alert:!1,setData:function(e){var t=this;t.spotAlertEnum=e.spotAlertEnum,t.info=e.cfg,t.data=e,t.data.spotAlertEnum?(0!=t.spotAlertEnum&&t.spotAlertEnum!=t.data.spotAlertEnum&&t.unbindAlert(t.spotAlertEnum),t.spotAlertEnum=t.data.spotAlertEnum,t.bindAlert()):(t.unbindAlert(t.spotAlertEnum),t.spotAlertEnum=0)},unbindAlert:function(e){this._bindAlert&&(game.spotAlert.delCb(e,this.updateAlert,this),this._bindAlert=!1)},bindAlert:function(){this._bindAlert||(game.spotAlert.setCb(this.spotAlertEnum,this.updateAlert,this),this._bindAlert=!0)},updateAlert:function(e){this.alert=!!e&&e.alert}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$LuckyTurnInfo",e)}(),function(){var e=game.GameMenuBar.extends({ctor:function(){this._super(1358,game.activeBarData,1)},notify:function(e,t,a){switch(this._super(e,t,a),e){case this.Evts.C2V_OPEN_ACTIVEBAR_GROUP:this.onChangeActiveBarGroup(t)}},onShow:function(){this._super(),this.send(this.Evts.V2C_INIT_ACTIVE_BAR)},onChangeActiveBarGroup:function(e){this.skin.group_1.setVisible(1==e),this.skin.group_2.setVisible(2==e),this.skin.btn_open1.setVisible(2==e),this.skin.btn_open2.setVisible(1==e)},_layout:function(){var e=this,t=game.GameBarMiscCfg.getData(e._miscId);if(t&&(e.btns=e._barDatas.getBtns(),e.btnPool.forEach(function(e){e.clearData(),e.removeFromParent()}),!(e.btns.length<=0))){var a=0,i=t.iconWidth,n=t.iconHeight,s=t.spacingX,o=t.spacingY,r=b8e.stage.width-100,g=void 0,l=void 0,c=0,h=1,m=0,u=0,d=e.btns.length;e.skin.changeToggle.setPosition(r-58,n+n/2+o);for(var f=0;f<d;f++){var p=(l=e.btns[f]).cfg,_=p&&p.bindPage?p.bindPage:1,v=e.getComponent("group_"+_),E=1<_?h:c;e.btnPool[f]?g=e.btnPool[f]:(g=game.MenuBarItem.get(),e.btnPool[f]=g),g.parent||g.addToParent(v),g.setVisible(!0),g.setData(l);var C=E*(i+s);r<=C+i&&(e.skin.changeToggle.setPosition(C-s-i/2,n+n/2+o),a=2<=_?(h=0,-(n+o)*(u+=1)):(c=0,-(n+o)*(m+=1)),C=0),g.setPosition(C,a),1<_?h+=1:c+=1,l.cfg.activeBarType==game.ActiveBarItemType.LIMIT_GIFT&&game.activeBarData.setLimitGiftPos(g)}}},_updatePosition:function(){this._super(),this.send(this.Evts.C2C_REFRESH_ACTIVE_BAR)}});b8e.module.registerView(game.ME.ActiveBar,e)}(),function(){var e=game.View.extends({bg1:null,bg2:null,_specialLayer:!0,ctor:function(){var e=this;e._super("home/HomeView"),e.setLocalZOrder(game.GameViewMgr.HomeViewIndex),e.spotAlerts={CS_ALERT:e.csAlert,BOSS:e.bossAlert,GUILD:e.guildAlert,ACTIVITIES_HALL:e.hallAlert,ARENA:e.arenaAlert,CHALLENGE:e.challengeAlert,VIP_ALERT:e.vipAlert,TEAMLEAGUE:e.teamLeagueAlert,SHOP_ALERT:e.shopAlert,MYSTERYSHOPFRAME_ALERT:e.mysteryShopBtnAlert,GUILD_CONFLICT_MAIN:e.guildConflictAlert}},notify:function(e){var t=this;switch(e){case t.Evts.C2V_CLOSE_BANNER:case t.Evts.C2V_CHANGE_BANNER:t.showBanner=game.vipData.getCanShowHomeBanner();break;case t.Evts.C2V_VIP_CHANGE:t.updateVipLv();break;case t.Evts.C2V_SHOW_MHM_VIEW:t.showMainHead();break;case t.Evts.CSC_OPEN_CHANGE:t.updateBuild();break;case t.Evts.C2V_UPDATE_SHRINK_BTN:t.updateShrinkBtn()}},init:function(){var e=this.skin,t=game.ResCfg.getUrl(10132);e.bg_2.loadTexture(t),t=game.ResCfg.getUrl(10133),e.bg_3.loadTexture(t),this.showBanner=game.vipData.getCanShowHomeBanner(),this.showCrystalEffect()},hallAlert:function(e){this.skin.activity_spot.node.active=e.alert},csAlert:function(e){this.skin.cs_spot.node.active=e.alert},bossAlert:function(e){this.skin.boss_spot.node.active=e.alert},guildAlert:function(e){this.skin.guild_spot.node.active=e.alert},instfuncAlert:function(e){this.skin.instfunc_spot.node.active=e.alert},arenaAlert:function(e){this.skin.arena_spot.node.active=e.alert&&game.moduleOpen.checkOpen(game.ME.ArenaMain)},challengeAlert:function(e){this.skin.challenge_spot.node.active=e.alert},vipAlert:function(e){this.skin.vip_spot.node.active=e.alert},teamLeagueAlert:function(e){this.skin.teamLeague_spot.node.active=e.alert},shopAlert:function(e){this.skin.shop_spot.node.active=e.alert},mysteryShopBtnAlert:function(e){this.skin.mystery_spot.node.active=e.alert},guildConflictAlert:function(e){this.skin.guild_conflict_spot.active=e.alert},onShow:function(){this.send(this.Evts.V_SHOW_VIEW),this.showBanner=game.vipData.getCanShowHomeBanner(),this.showMainHead(),this.updateBuild(),this.updateShrinkBtn(),b8e.Ticker.add(this,this.updateBgPos)},showMainHead:function(){b8e.module.isShowView(game.ME.MainUIHeadMiddle)?this.skin.mainHead.active=!1:(this.skin.mainHead.active=!0,this.updateVipLv())},updateVipLv:function(){this.skin.vipLab.string="V"+game.mainRoleData.vipLevel},onHide:function(){game.module.hide(game.ME.LuckyTurn),this.send(this.Evts.V_HIDE_VIEW),b8e.Ticker.remove(this,this.updateBgPos)},updateBuild:function(){var e=this.skin,t=game.moduleOpen.checkOpen(game.ME.Guild),a=game.moduleOpen.checkOpen(game.ME.Boss),i=game.moduleOpen.checkOpen(game.ME.InstanceFunc),n=game.moduleOpen.checkOpen(game.ME.ActivitiesHall),s=game.moduleOpen.checkOpen(game.ME.Cs),o=game.moduleOpen.checkOpen(game.ME.ArenaMain),r=game.moduleOpen.checkOpen(game.ME.ChallengeCbp),g=game.moduleOpen.checkOpen(game.ME.TeamLeague),l=game.moduleOpen.checkOpen(game.ME.Shop),c=game.moduleOpen.checkOpen(game.ME.MysteryShopFrame),h=game.moduleOpen.checkOpen(game.ME.GuildConflictMain),m=game.sceneData.isCsScene();e.guild_conflict.active=!m&&h,e.guild_conflict_gray.active=m||!h,e.build_troop.active=t,e.build_troop_gray.active=!t,e.build_boss.active=a,e.build_boss_gray.active=!a,e.build_copy.active=i,e.build_copy_gray.active=!i,e.build_active.active=n,e.build_active_gray.active=!n,e.build_boat.active=s,e.build_boat_gray.active=!s,e.build_sports.active=o,e.build_sports_gray.active=!o,e.build_challenge.active=r,e.build_challenge_gray.active=!r,e.build_teamLeague.active=g,e.build_teamLeague_gray.active=!g,e.build_shop.active=l,e.build_shop_gray.active=!l,e.build_mystery.active=c,e.build_mystery_gray.active=!c},view_shrinkBtn:function(){b8e.module.isShowView(game.ME.HomeBottomBar)?(game.module.hide(game.ME.HomeBottomBar),game.module.hide(game.ME.HomeRightBar)):(game.module.showTab(game.ME.HomeBottomBar,this.moduleEnum,!1),game.module.showTab(game.ME.HomeRightBar,this.moduleEnum,!1))},updateShrinkBtn:function(){var e=this.skin,t=b8e.module.isShowView(game.ME.HomeBottomBar);e.shrinkBtn_open.active=!t,e.shrinkBtn_close.active=t},onStageResize:function(){var e,t=this,a=b8e.stageWidth,i=b8e.stageHeight;e=1600*t.anchorY+(i-1600>>1),t.skin.view.setSize(a,1600),t.skin.list.setSize(a,1600),t.skin.mainHead.setPosition(325,-47),t.skin.view_shrinkBtn.setPosition(a-1,130-i),t.setPosition(0,i),t.setSize(a,i),t.skin.list.setPosition(0,e-i),t.skin.list._scrollView._calculateBoundary(),t.send(t.Evts.V_HOME_RESIZE)},updateBgPos:function(){var e=this.skin,t=e.list.content.x;this.lastPos!=t&&(this.lastPos=t,e.bg_3.x=.5*-t,e.bg_2.x=.2*-t)},showCrystalEffect:function(){this.anim||(this.anim=b8e.Animator.get(game.AnimType.UI_EFFECT,1),this.anim.addToParent(this.skin.animNode),this.anim.load(game.ResCfg.getUrl(5016,993)),this.anim.play())}});b8e.module.registerView(game.ME.Home,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(589)},init:function(){var e=this.Luckylist=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.LuckyTurnItem,e.addToParent(this.skin.list),this.setSize(b8e.stageWidth,b8e.stageHeight)},notify:function(e){switch(e){case this.Evts.C2V_RESET_GROUP:this.onShow()}},onShow:function(){game.luckyTurnData.setItemList();var e=game.luckyTurnData.getItemList(),t=this.skin,a=(b8e.stageWidth,b8e.stageHeight,game.GameBarMiscCfg.getData(1).iconWidth),i=60,n=e.length,s=n<6?6:n,o=s%6==0?s/6:1+(s/6>>0),r=a+30;this.Luckylist.height=o*r,t.tipsBg_1.height=o*r;var g=game.activeBarData.getLuckyTurnPos(),l=void 0;(s=6<n?6:n)<4&&(i=32);var c=a*s+i;l=g[0]+c>b8e.stageWidth?b8e.stageWidth-c-10:g[0]+10,t.tipsBg.x=l,t.emotion_bg.x=g[0]+.5*a,t.tipsBg_1.width=c;var h=g[1]-20;t.tipsBg.y=h,t.emotion_bg.y=10+h,this.updateList(e)},updateList:function(e){this.Luckylist.setData(e)},onSort:function(e,t){return e.sortId-t.sortId},onStageResize:function(){this.skin.closeBtn.setSize(b8e.stageWidth,b8e.stageHeight),this.skin.closeBtn.y=b8e.stageHeight,this.setPosition(0,0)}});b8e.module.registerView(game.ME.LuckyTurn,e)}(),function(){var e;e=game.ListItem.extends({isAlert:!1,ctor:function(){this._super(590),this.setSize(79,100)},init:function(){var e=this.icon=b8e.Sprite.get();e.addToParent(this.skin.btn),e.setAnchor(.5,.5)},setData:function(){var e=this.data.info,t=e.titleBg;if(e.moduleEnum==game.ME.Turnplate&&2==e.toggleIndex){var a=game.petTurnplateData.curGroupCfg;a&&(t=a.iconBg)}var i=game.ResCfg.getImgUrl(t);this.icon.loadTexture(i),this.skin.alert.node.active=this.data.alert},clickBtn:function(){var e=this.data.info;if(e&&0<e.luckyId&&(game.luckyTurnplateData.setGroupInfos(e.luckyId),game.module.show(e.moduleEnum)),0<e.toggleIndex){var t=e.toggleIndex-1;game.module.showToggle(e.moduleEnum,t)}else game.module.show(e.moduleEnum)}}),b8e.RC("$$game","$$LuckyTurnItem",e)}(),function(){var e=game.GameMenuBar.extends({ctor:function(){this._super(null,game.homeLeftBarData,2)},onShow:function(){this._super()}});b8e.module.registerView(game.ME.HomeLeftBar,e)}(),function(){var e=game.GameMenuBar.extends({ctor:function(){this._super(null,game.homeRightBarData,3)}});b8e.module.registerView(game.ME.HomeRightBar,e)}(),function(){var e=game.GameMenuBar.extends({ctor:function(){this._super(null,game.homeBottomBarData,4)}});b8e.module.registerView(game.ME.HomeBottomBar,e)}(),function(){var e;e=b8e.Enum({None:0,C_INIT_HOUSE:b8e.enc(),C_UPGRADE:b8e.enc(),C_GET_HOUSE_EXP:b8e.enc(),C_ADD_HOUSE_RECORD:b8e.enc(),C_AUTO_UPGRADE:b8e.enc(),V_UPDATEDATE:b8e.enc(),V_AUTO_UPGRADE:b8e.enc(),V_UPGRADE:b8e.enc(),V_AUTOBUY:b8e.enc(),C_AUTOBUY:b8e.enc(),C_SHOW_HOUSE_ICON:b8e.enc(),C_HIDE_HOUSE_ICON:b8e.enc(),V2C_SHOW_VIEW:b8e.enc()}),b8e.RC("$$game","$$HouseEvts",e)}(),function(){var e=game.Control.extends({isAuto:!1,spotAdvAlert:null,init:function(){this.spotAdvAlert=game.spotAlert.set(game.SAE.HOUSE_ADV_ALERT,game.SAE.PEACH_GARDEN)},ipc:function(){this.evts={Marry:{C_REQ_DATA:this.synHouseData},Back:{C_BACK_UPDATE_ITEMINFO:this.updateItemInfo}},this.handels={HouseAdvancedResp:this.houseAdvancedResp,HouseExpMsg:this.houseExpNotify,GetHouseExpResp:this.getHouseExpResp}},updateItemInfo:function(){this.checkAlert(),this.send(this.Evts.V_UPDATEDATE)},checkAlert:function(){this.spotAdvAlert.alert=game.houseData.canAdv()},houseAdvancedResp:function(e){var t=e.readProtobuf(game.pb.HouseAdvancedResponse);if(0<t.code){return game.notice.noticeError(t.code),this.isAuto=!1,void this.send(this.Evts.V_AUTO_UPGRADE,{isAuto:this.isAuto})}if(game.FightAmount.inst().showTeamStatPower(),game.houseData.updateHouseAdv(t.advancedLv,t.exp),this.send(game.HouseEvts.V_UPGRADE),this.isAuto){b8e.Tween.kill(this),b8e.Tween.get(this).wait(300).call(this.upgradeReq,this)}else b8e.Tween.kill(this)},houseExpNotify:function(e){var t=e.readProtobuf(game.pb.HouseExpNotify);game.houseData.addRecord(t),this.dpt(this.Evts.C_SHOW_HOUSE_ICON)},getHouseExpResp:function(e){var t=e.readProtobuf(game.pb.GetHouseExpResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(9180),game.houseData.clearRecord(),game.houseData.updateHouseAdv(t.advancedLv,t.exp),this.checkAlert(),this.send(game.HouseEvts.V_UPGRADE),this.dpt(this.Evts.C_HIDE_HOUSE_ICON)},synHouseData:function(e){var t=e.data;if(t){if(game.houseData.synData(t.house,t.records),this.checkAlert(),0<t.records.length){this.dpt(this.Evts.C_SHOW_HOUSE_ICON)}}else;},notify:function(e,t){switch(e){case game.HouseEvts.C_AUTO_UPGRADE:this.isAuto=t.isAuto;break;case game.HouseEvts.C_GET_HOUSE_EXP:this.quickGetExp();break;case game.HouseEvts.C_AUTOBUY:game.houseData.autoBuy=t.isAuto;break;case game.HouseEvts.V2C_SHOW_VIEW:this.isPass=!1}},upgradeBtn:function(){if(this.isAuto);else if(game.marryData.hasPartner){this.upgradeReq()}else game.notice.show(9181)},autoUpgradeBtn:function(){if(this.isAuto=!this.isAuto,this.isAuto){this.upgradeReq()}this.send(game.HouseEvts.V_AUTO_UPGRADE,{isAuto:this.isAuto})},autoBuyBtn:function(){game.houseData.switchAutoBuy(),this.send(this.Evts.V_AUTOBUY)},upgradeReq:function(){var e=game.houseData.getAdvLv(),t=game.houseData.getHouseType();if(game.HouseAttrCfg.getData(t)){var a=game.HouseAdvCfg.getData(e);if(a)game.autoBuyMgr.autoBuyBegin(a.itemId,a.itemNum,a.silver,game.houseData.autoBuy,this.isAuto,this,this.cancelcb,this.sureCb,this.setAuto)&&this.sender.HouseAdvancedReq(this.autoType);else;}else;},setAuto:function(e){this.isAuto=e,this.send(this.Evts.V_AUTO_UPGRADE,{isAuto:this.isAuto})},cancelCb:function(){var e=this;e.isAuto=!1,e.isPass=!1,e.send(game.HouseEvts.V_AUTO_UPGRADE,{isAuto:e.isAuto})},sureCb:function(){var e=this;if(b8e.module.isShowView(e.moduleEnum)&&game.houseData.autoBuy)e.isPass=!0,e.sender.HouseAdvancedReq(1);else;},quickGetExp:function(){this.sender.GetHouseExpReq()}}),t=game.Sender.extends({ipc:function(){this.msg={HouseAdvancedReq:this.houseAdvancedReq,GetHouseExpReq:null}},houseAdvancedReq:function(e){var t=0<arguments.length&&void 0!==e?e:0,a=game.pb.HouseAdvancedRequest;a.autoType=t,b8e.net.getBytes().writeProtobuf(a)}}),a=[game.ME.HouseAtt,game.ME.HouseRec];b8e.module.registerControl(game.ME.House,e,game.HouseEvts,t,a)}(),function(){var e=b8e.Object.extends({_houseData:null,houseRecord:null,spriteStat:null,tmpSpriteStat:null,spriteStatType:null,allPower:0,addCount:0,autoBuy:!1,ctor:function(){this._super(),this.houseRecord=[]},synData:function(e,t){this.spriteStat=game.SpriteStat.get(),this.tmpSpriteStat=game.SpriteStat.get();var a=game.SpriteStatType;if(this.spriteStatType=[a.TeamHp,a.TeamDef,a.TeamAtk],this.setHouseData(e),t&&0<t.length)for(var i=0,n=t.length;i<n;i++){this.addRecord(t[i])}},addRecord:function(e){var t=new game.HouseRecInfo;t.setData(e),this.houseRecord.push(t),this.addCount+=t.addExp},clearRecord:function(){this.houseRecord.length=0,this.addCount=0},getRecordArr:function(){return this.houseRecord},setHouseData:function(e){this._houseData=e},getPower:function(){var e=this;if(!e.spriteStat){this.spriteStat=game.SpriteStat.get()}e.spriteStat.clear();var t=e.getAdvLv(),a=e.getHouseType(),i=game.HouseAdvCfg.getData(t);e.spriteStat.setupByCfg(i);var n=null;switch(a){case 1:n=[e.spriteStatType[0]];break;case 2:n=[e.spriteStatType[0],e.spriteStatType[1]];break;case 3:n=e.spriteStatType}var s=game.partnerData.getToBattleCount()+1;return e.allPower=game.CCommonUtil.getPowerByType(e.spriteStat,n)*s,e.allPower},updateHouseAdv:function(e,t){if(this._houseData){this._houseData.advancedLv=e,this._houseData.exp=t}this._houseData.advancedLv=e,this._houseData.exp=t,this.allPower=game.CCommonUtil.getPowerByType(this.spriteStat,this.spriteStatType)},getHouseType:function(){if(this._houseData)return this._houseData.houseType;return 0},getAdvLv:function(){if(this._houseData)return this._houseData.advancedLv;return 0},getExp:function(){if(this._houseData)return this._houseData.exp;return 0},canAdv:function(){var e=!1,t=this.getAdvLv(),a=t>=game.HouseAdvCfg.maxLv;if(t<=0){return!1}if(!a){var i=game.HouseAdvCfg.getData(t);if(!i){return!1}var n=i.itemNum,s=i.itemId;e=(e=n<=game.itemData.getNumById(s))&&game.UpgradeUtil.checkAmountByType(game.AmountType.SILVER,i.silver,!1)}return e},switchAutoBuy:function(){this.autoBuy=!this.autoBuy}});game.houseData=game.houseData||new e}(),function(){var e;e=b8e.Object.extends({time:0,addExp:0,ctor:function(){this._super()},setData:function(e){this.time=e.time,this.addExp=e.addExp}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$HouseRecInfo",e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(591),this.setLocalZOrder(50)},init:function(){this.modelData=game.BaseRoleData.get(game.RoleType.Hero,1),(this.model=game.sceneRoleCreate.createUIRole(this.modelData)).addToParent(this.skin.modelNode)},notify:function(e){switch(e){case this.Evts.V_UPDATEDATE:this.updateData()}},onShow:function(){this.updateData()},updateData:function(){this.skin.amountLab.string=game.houseData.getPower();var e=game.houseData.getHouseType();this.showTypeAtt(e),this.updateModel()},updateModel:function(){var e=this.model;if(e){var t=this.modelData;if(t){var a=t.heroModel;if(a){a.clear();var i=game.mainRoleData.heroModel;if(i){a.setBody(game.RoleType.RANK,i.body),a.setMale(i.isMale),a.type=game.RoleType.Hero,a.setAnims(i.copyAnim()),i.surfaces&&a.setSurfaces(i.surfaces);var n=game.AvatarUtil;n.updateUIModel(this.model,n.ID_2),e.transition(game.RoleStateType.ACTION_IDLE)}}}}},showTypeAtt:function(e){for(var t=game.Color.GREEN,a=game.Color.GRAY,i=this.skin,n=1;n<4;n++){if(n<=e){this.getComponent("attVal"+n).node.color=t,this.getComponent("attNext"+n).node.color=t}else this.getComponent("attVal"+n).node.color=a,this.getComponent("attNext"+n).node.color=t;var s=e<n;if(1<n){this.getComponent("unlockTip"+n).node.active=s;i.attNext1;if(s){this.getComponent("attRoot"+n).y=11}else this.getComponent("attRoot"+n).y=0}}this.updateAtt()},updateAtt:function(){var e=this.skin,t=game.houseData.spriteStat,a=t.getStatValue(game.SpriteStatType.TeamHp),i=t.getStatValue(game.SpriteStatType.TeamDef),n=t.getStatValue(game.SpriteStatType.TeamAtk);e.attVal1.string=a,e.attVal2.string=i,e.attVal3.string=n;var s=game.houseData.getAdvLv(),o=0,r=0,g=0;if(!(s>=game.HouseAdvCfg.maxLv)){var l=game.HouseAdvCfg.getData(s+1);if(l){o=l.teamHp-a,r=l.teamDef-i,g=l.teamAtk-n}}e.attNext1.string=Math.max(o,0),e.attNext2.string=Math.max(r,0),e.attNext3.string=Math.max(g,0)},setHero:function(e){var t=this.modelData.heroModel;t&&e&&t.setFashion(e)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.HouseAtt,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(592),this.setSize(540,94)},init:function(){},setData:function(){var e=this.skin,t=this.data;e.expLab.string=game.Lang.get(1803,t.addExp),e.timeLab.string=b8e.TimeUtil.formatTimestamp(t.time)}}),b8e.RC("$$game","$$HouseRecItem",e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(593)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.HouseRecItem,e.layout.paddingLeft=0,e.bindEnum=game.ME.House,e.addToParent(this.skin.scrollView)},notify:function(e){switch(e){case game.HouseEvts.V_UPDATEDATE:case game.HouseEvts.V_UPGRADE:this.updateData()}},onShow:function(){this.updateData()},onHide:function(){},updateData:function(){var e=this.skin;this.updateList();var t=game.houseData.addCount;e.canGet.string=game.Lang.get(9498,t)},updateList:function(){var e=game.houseData.getRecordArr();this.list.setData(e)},viewquickBtn:function(){if(game.houseData.getRecordArr().length<=0){game.notice.show(9182)}else this.send(this.Evts.C_GET_HOUSE_EXP)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width)-30,.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.HouseRec,e)}(),function(){var e=game.CultivateBaseModelView.extends({autoBuy:!1,progressMaxW:550,ctor:function(){this._super(594),this.spotAlerts={HOUSE_ADV_ALERT:this.advAlert}},advAlert:function(e){this.skin.redPoint1.node.active=e.alert,this.skin.redPoint2.node.active=e.alert},init:function(){var e=this,t=e.bgSp=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(e.skin.bg);var a=e.house=b8e.Sprite.get();a.setAnchor(.5,0),a.addToParent(e.skin.houseNode);var i=e.houseTypeIcon=b8e.Sprite.get();i.setAnchor(.5,.5),i.addToParent(e.skin.houseQuality),(i=e.matIcon=b8e.Sprite.get()).setAnchor(.5,.5),i.setSize(36,36),i.addToParent(e.skin.matCoinNode),(i=e.coinIcon=b8e.Sprite.get()).setAnchor(.5,.5),i.setSize(36,36),i.addToParent(e.skin.coinIconNode)},notify:function(e,t){switch(e){case game.HouseEvts.V_UPDATEDATE:case game.HouseEvts.V_UPGRADE:this.updateData();break;case game.HouseEvts.V_AUTO_UPGRADE:if(t.isAuto){this.skin.autoUpgradeBtnLab.string=game.Lang.get(9061)}else this.skin.autoUpgradeBtnLab.string=game.Lang.get(9083);break;case game.HouseEvts.V_AUTOBUY:this.autoBuy=game.houseData.autoBuy,this.setAutoBuy(this.autoBuy)}},viewfightAmount:function(){game.module.show(game.ME.HouseAtt)},onShow:function(){this.autoBuy=game.houseData.autoBuy,this.setAutoBuy(this.autoBuy),this.updateData(),this.send(this.Evts.V2C_SHOW_VIEW)},onHide:function(){this.skin.autoUpgradeBtnLab.string=game.Lang.get(9083),this.send(game.HouseEvts.C_AUTO_UPGRADE,{isAuto:!1}),this.send(game.HouseEvts.C_AUTOBUY,{isAuto:!1})},updateData:function(){var e=this.skin,t=game.mainRoleData.isMale?game.Color.BLUE:game.Color.PURPLE;e.nameLab1.node.color=t;var a=game.houseData.getHouseType();a=1<a?a+1:1;var i=game.ResCfg.getUrl(104,a);this.house.loadTexture(i);i=game.ResCfg.getUrl(10032);this.bgSp.loadTexture(i),this.updateUpgrade()},updateUpgrade:function(){var e=this.skin,t=this,a="",i=game.houseData.getHouseType();if(game.HouseAttrCfg.getData(i)){i=1<i?i+1:1;var n=game.houseData.getAdvLv(),s=game.HouseAdvCfg.getData(n);if(s){var o,r=s.itemId,g=s.itemNum,l=game.ItemInfoCfg.getData(r),c=game.itemData.getNumById(r);a=game.ResCfg.getUrl(137,l.icon),t.matIcon.loadTexture(a),l=game.ItemInfoCfg.getData(23),a=game.ResCfg.getUrl(137,l.icon),t.coinIcon.loadTexture(a),e.lvLab.string=game.Lang.get(9603,n),1==i?o=game.Lang.get(9521):2==i?o=game.Lang.get(9521):3==i?o=game.Lang.get(9522):4==i&&(o=game.Lang.get(9523)),e.lb_houseName.string=o;var h=game.houseData.getPower();e.fightAmountLbl.string=h,game.AutoLayoutUtil.layoutPower(e.powerbg,e.fightAmountLbl,e.power,e.search);var m=n>=game.HouseAdvCfg.maxLv;e.upgradeBtnRoot.active=!m;var u=void 0;if(m)this.setAutoBuy(!1),u=50129,e.matCostNumNode.string=game.Lang.get(u,"0","--"),e.coinCostLab.setColor(game.Color.GREEN),e.coinCostLab.string="/--";else{r=s.itemId,g=s.itemNum,l=game.ItemInfoCfg.getData(r);u=g<=(c=game.itemData.getNumById(r))?50130:50129,e.matCostNumNode.string=game.Lang.get(u,c,g),g=s.silver,l=game.ItemInfoCfg.getData(23),game.AutoLayoutUtil.layoutWith2Icon2Label(e.matCoinNode,e.matCostNumNode,e.coinIconNode,e.coinCostLab);var d=game.UpgradeUtil.checkAmountByType(game.AmountType.SILVER,s.silver,!1)?game.Color.GREEN:game.Color.RED;e.coinCostLab.setColor(d),e.coinCostLab.string=g}this.updageExpProgress()}}},setAutoBuy:function(e){this.autoBuy=e,this.skin.check.node.active=this.autoBuy},updageExpProgress:function(){var e=game.houseData.getAdvLv(),t=game.houseData.getExp();if(e>=game.HouseAdvCfg.maxLv){this.skin.expLab.string="",this.setProgressVal(1)}else{var a=game.HouseAdvCfg.getData(e).maxValue;this.skin.expLab.string=t+"/"+a,this.setProgressVal(t/a)}},setProgressVal:function(e){b8e.Tween.kill(this),b8e.Tween.get(this.skin.progress.node).to({width:e*this.progressMaxW},150),this.showProgEffect(null,this.skin.progress,e,this.progressMaxW,150)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.House,e)}(),function(){var e;e=b8e.Enum({SWITCH_PAGE:-1,UPDATE_DATA:-1,MAT_CHALL:-1,MAT_SWEEP:-1,MAT_QUICK_SWEEP:-1,V_SCROLL_DOWN:-1,C2C_UPDATE_FINISH_COUNT:-1,C2C_SYS_DATA_SUCCEED:-1,UPDATE_AUTOFIGHT:-1,C2C_UPDATE_AUTOFIGHT:-1,C2C_MATERIAL_RESULT:-1,V2C_SELECT_GRADE:-1,C2V_SELECT_GRADE:-1,C2V_SELECT_MAT:-1,V2C_SELECT_MAT:-1}),b8e.RC("$$game","$$InstanceFuncEvts",e)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.INSTFUNC,game.SAE.HOME)},ipc:function(){},matBtn:function(){this.selectToggle(0)},Btn2:function(){this.selectToggle(1)},Btn3:function(){this.selectToggle(2)},Btn4:function(){this.selectToggle(3)},Btn5:function(){this.selectToggle(4)},Btn6:function(){this.selectToggle(5),this.closeAutoFight(5)},closeAllBtn:function(){this.closeAutoFight(0),game.module.hide(this.moduleEnum);var e=game.zhanjiangData.zhanJiangLayer;if(0<e){var t=game.ZhanJiangCfg.getData(e),a=game.ZhanJiangCfg.getData(e+1);if(t&&a){if(1==t.type&&2==a.type){game.zhanjiangData.difficulty=2}else if(2==t.type&&3==a.type){game.zhanjiangData.difficulty=3}}}},returnAllBtn:function(){this.closeAllBtn()},selectToggle:function(e){this.send(this.Evts.SWITCH_PAGE,e)}}),t=[game.ME.InstanceHall];b8e.module.registerControl(game.ME.InstanceFunc,e,game.InstanceFuncEvts,null,t)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){var t=this;t.instFuncHall=game.spotAlert.set(game.SAE.INSTFUNC,game.SAE.INSTFUNC_HALL),t.spotAlert=game.spotAlert.set(game.SAE.INST_MAT,game.SAE.INSTFUNC),t._autoOptions={lang:8325,okcb:function(e){t.sender.MaterialCostSweepReq(e)},thisArg:t}},ipc:function(){var e=this;e.gevts={},e.evts={Instance:{SYNC_INSTANCE_DATA:e.syncMatDataResp},MainRole:{C_VIP_LEVEL_CHANGE:e.vipLvUpdate,C_LEVEL_UP:e.lvUpdate,C_POWER_CHANGE:e.powerChange}},e.handels={MaterialChallengeResp:e.materialChallengeResp,MaterialCostSweepResp:e.materialCostSweepResp,MaterialSweepResp:e.materialSweepResp}},checkAlert:function(){var e=game.instFuncData.hasMatChall();this.spotAlert.alert=e&&game.moduleOpen.checkOpen(game.ME.InstanceFunc)},powerChange:function(){var e=game.mainRoleData.maxPower;game.instFuncData.powerUp(e),this.send(game.InstanceFuncEvts.UPDATE_DATA),this.checkAlert()},vipLvUpdate:function(){var e=game.mainRoleData.vipLevel;game.instFuncData.viplvUp(e),this.send(game.InstanceFuncEvts.UPDATE_DATA)},lvUpdate:function(){var e=game.mainRoleData.lv;game.instFuncData.updateAllCanSweep(),game.instFuncData.lvUp(e),game.instFuncData.updateCanQuickSweep(),this.send(game.InstanceFuncEvts.UPDATE_DATA),this.checkAlert()},syncMatDataResp:function(e){if(e&&e.data){var t=e.data,a=t.material;if(a)game.instFuncData.setCount(t.materialCount),game.instFuncData.setMatData(a),this.vipLvUpdate(),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT),this.checkAlert();else;}else;},materialChallengeResp:function(e){var t=e.readProtobuf(game.pb.MaterialChallengeResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.instFuncData.updateChallCount(t.id,t.challengeNum),this.checkAlert();var a=t.battlelog;if(a){a.win&&(game.instFuncData.addCount(),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT),game.instFuncData.updateGrade(t.id)),game.module.hide(game.ME.InstanceFunc),game.GameViewMgr.inst().hideUnStrongViews();var i={type:game.InstanceType.MATERIAL,rewards:t.useritem,exp:t.exp};game.playBack.play(a,i)}else{game.instFuncData.addCount(),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT),this.showItem(t)}this.send(game.InstanceFuncEvts.UPDATE_DATA),this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,!0),this.dpt(this.Evts.C2C_MATERIAL_RESULT,1)}},materialCostSweepResp:function(e){var t=e.readProtobuf(game.pb.MaterialCostSweepResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.instFuncData.updateAllSweepCount(t.ins),this.checkAlert();for(var a=0,i=t.ins.length,n=void 0,s=0;s<i;s++)(n=t.ins[s])&&(a+=n.num);t.ins&&0<i&&(game.instFuncData.addCount(a),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT)),this.showItem(t),this.dpt(this.Evts.C2C_MATERIAL_RESULT,a),this.send(game.InstanceFuncEvts.UPDATE_DATA)}},materialSweepResp:function(e){var t=e.readProtobuf(game.pb.MaterialSweepResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.instFuncData.updateQuickSweepCount(t.ins),this.checkAlert();var a=void 0,i=0;if(t.ins&&0<t.ins.length){for(var n=t.ins.length,s=0;s<n;s++)(a=t.ins[s])&&(i+=a.num);game.instFuncData.addCount(i),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT)}this.showItem(t),this.send(game.InstanceFuncEvts.UPDATE_DATA),this.dpt(this.Evts.C2C_MATERIAL_RESULT,i)}},showItem:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i={type:game.InstanceType.MATERIAL,rewards:e.useritem,exp:e.exp,win:a};b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,i)},notify:function(e,t,a){switch(e){case game.InstanceFuncEvts.MAT_CHALL:if(!t)break;this.challange(t.id);break;case game.InstanceFuncEvts.MAT_SWEEP:if(!t)break;this.costSweep(t.id);break;case game.InstanceFuncEvts.MAT_QUICK_SWEEP:this.quickSweep(t.id,t.count);break;case game.InstanceFuncEvts.V2C_SELECT_GRADE:game.instFuncData.selectGrade(t,a),game.module.hide(game.ME.MaterialGrade);break;case game.InstanceFuncEvts.V2C_SELECT_MAT:game.instFuncData.selectMatType(t),this.send(game.InstanceFuncEvts.C2V_SELECT_MAT)}},down_btn:function(){this.send(game.InstanceFuncEvts.V_SCROLL_DOWN)},challange:function(e){if(game.UpgradeUtil.checkEquipTooMuch());else game.playBack.isInstanceFighting(!0)||this.sender.MaterialChallengeReq(e)},costSweep:function(e){if(!game.UpgradeUtil.checkEquipTooMuch()){var t=game.instFuncData.getMaterialCfgById(e).costNum;game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,t)&&this.sender.MaterialCostSweepReq([{id:e,num:1}])}},quickSweep:function(e,t){game.UpgradeUtil.checkEquipTooMuch()||(this.sweepIds||(this.sweepIds=[]),this.sweepIds[0]||(this.sweepIds[0]=new game.pb.InsSweep.ctor),this.sweepIds[0].id=e,this.sweepIds[0].num=t,this.sender.MaterialSweepReq(this.sweepIds))},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.WORLD_FULI)},btn_auto:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){var e=game.instFuncData.getSelectInfo();if(e)if(e.grade<1)game.notice.show(53294);else{var t=game.instFuncData.getMaterialCfgByTG(e.type,e.grade);if(t)if(e.useChallCount>=t.Challengetime)game.notice.show(53295);else{var a=t.Challengetime-e.useChallCount,i=this._alertOptions;(i=i||(this._alertOptions={lang:53296,btn:game.Lang.get(9001),okcb:this.quickSweep,thisArg:this})).langArgs=[game.instFuncData.getDescByGrade(t.grade),t.name,a],i.args=[t.id,a],game.alert.showTwo(i)}}}}}),t=[game.ME.MaterialGrade],a=game.Sender.extends({ipc:function(){this.msg={MaterialChallengeReq:this.materialChallengeReq,MaterialCostSweepReq:this.materialCostSweepReq,MaterialSweepReq:this.materialSweepReq}},materialChallengeReq:function(e){var t=game.pb.MaterialChallengeRequest;t.id=e,this.write(t)},materialCostSweepReq:function(e){var t=game.pb.MaterialCostSweepRequest;t.ins=e,this.write(t)},materialSweepReq:function(e){var t=game.pb.MaterialSweepRequest;t.ins=e,this.write(t)}});b8e.module.registerControl(game.ME.InstanceMaterial,e,game.InstanceFuncEvts,a,t)}(),function(){var e=b8e.Object.extends({getChallengeCount:function(e){var t,a=this.insChallengeTimes;if(!a||a.length<1)return 0;for(var i=0,n=a.length;i<n;i++)if((t=a[i]).id==e)return t.time;return 0},addChallengeCount:function(e){var t,a=this.insChallengeTimes;a||(this.insChallengeTimes=a=[]);for(var i=0,n=a.length;i<n;i++)if((t=a[i]).id==e)return void t.time++;this.insChallengeTimes.push({id:e,time:1})}});game.InsFunCountData=game.InsFunCountData||new e}(),function(){var e;e=b8e.Object.extends({cfg:null,moduleId:0,sortId:0,name:"",openLv:0,setData:function(e){this.cfg=e,this.moduleId=e.moduleId,this.sortId=e.sortId,this.name=e.name,this.openLv=e.openLv}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$InstanceHallInfo",e)}(),function(){var e=b8e.Object.extends({activites:null,ctor:function(){this.activites=[]},initData:function(){var e=game.InstanceHallCfg.getDatas();if(e){var t=e.length;if(!(t<1)){for(var a=void 0,i=0;i<t;i++){var n=e[i];(a=new game.InstanceHallInfo).setData(n),this.activites.push(a)}this.activites.sort(this._sort)}}},_sort:function(e,t){return e.sortId>t.sortId?1:e.sortId<t.sortId?-1:e.id>t.id?1:e.id<t.id?-1:0},getInfos:function(){return 0<this.activites.length||this.initData(),this.activites}});game.instanceHallData=game.instanceHallData||new e}(),function(){var e;e=b8e.Enum({NONE:0,PET:1,EQUIP:2,HIGHEQUIP:3,TAOFA:4,ARENA:5,MATERIALINS:6,PERSONALINS:7,QUANMININS:8,GUILDINS:9,TEAMINS:10,WILDINS:11,ZHAOQIN:12,ZHANJIANG:13,XIANDI:14,WANSHOU:15,JIANGHUN:16,GUOSHI:17}),b8e.RC("$$game","$$InsFunCountType",e)}(),function(){var e=b8e.Object.extends({matFBInfoMap:null,allCanSweep:!1,finishCount:0,autoCost:0,curSelectType:0,tempPower:0,ctor:function(){this._super(),this.matFBInfoMap=b8e.HashMap.get()},createMatInfos:function(){var e=this.getMaterialCfgsByGrade(1);if(e){this.matFBInfoMap&&this.matFBInfoMap.clear();for(var t=0,a=e.length;t<a;t++){var i=e[t];if(i){var n=this.matFBInfoMap.get(i.type);n||(n=new game.MatItemInfo,this.matFBInfoMap.set(i.type,n)),n.initInfo(i,this.allCanSweep),n.power=game.mainRoleData.maxPower}}}},setMatData:function(e){if(e){this.updateAllCanSweep(),this.createMatInfos();for(var t=0,a=e.length;t<a;t++){var i=e[t];if(i)this.updateMatInfo(i);else;}}else;},viplvUp:function(a){this.matFBInfoMap.forEach(function(e,t){t.vipLvUp(a)},this)},lvUp:function(a){this.matFBInfoMap.forEach(function(e,t){t.lvUp(a)},this)},powerUp:function(a){this.matFBInfoMap.forEach(function(e,t){t.powerUp(a)},this)},matQuickChall:function(e){var t=this.matFBInfoMap.get(e);if(t)t.challCount=0;else;},updateMatInfo:function(e){var t=this.matFBInfoMap.get(e.types);t||(t=new game.MatItemInfo,this.matFBInfoMap.set(e.types,t)),t.setData(e),t.vipLv=game.mainRoleData.vipLevel,t.lv=game.mainRoleData.lv},updateChallCount:function(e,t){var a=this.getMaterialCfgById(e);if(a){var i=a.type,n=this.matFBInfoMap.get(i);n||(n=new game.MatItemInfo,this.matFBInfoMap.set(i,n)),n.useChallCount=t}},updateSweepCount:function(e,t){var a=this.getMaterialCfgById(e);if(a){var i=a.type,n=this.matFBInfoMap.get(i);n||(n=new game.MatItemInfo,this.matFBInfoMap.set(i,n)),n.useSweepCount=t}},updateQuickSweepCount:function(e){for(var t=void 0,a=void 0,i=void 0,n=void 0,s=0,o=e.length;s<o;s++)t=e[s],(a=this.getMaterialCfgById(t.id))&&(i=a.type,(n=this.matFBInfoMap.get(i))||(n=new game.MatItemInfo,this.matFBInfoMap.set(i,n)),n.useChallCount+=t.num)},updateAllSweepCount:function(e){for(var t=void 0,a=void 0,i=void 0,n=void 0,s=void 0,o=0,r=e.length;o<r;o++)(n=e[o])&&(t=n.id,(a=this.getMaterialCfgById(t))&&(i=a.type,(s=this.matFBInfoMap.get(i))||(s=new game.MatItemInfo,this.matFBInfoMap.set(i,s)),s.useSweepCount+=n.num,s.canQuickSweep=!1))},getMatSortedArr:function(){if(!this.matFBInfoMap){return[]}var e=this.matFBInfoMap.values();if(!e)return[];return e.sort(this.sortMatInfoById),e},sortMatInfoById:function(e,t){return e.openLv!=t.openLv?e.openLv-t.openLv:e.id-t.id},getMatInfoArrByLv:function(){var e=this.getMatSortedArr();return e?(e.sort(this.materialSort),this.isInitArr||(this.isInitArr=!0,e&&e[0]&&(e[0].isSelect=!0,this.curSelectType=e[0].type)),e):null},getQuickSweepIdArr:function(){for(var e=[],t=this.getMatInfoArrByLv(),a=game.mainRoleData.lv,i=0,n=t.length;i<n;i++){var s=t[i];if(s){var o=this.getMaterialCfgById(s.id);if(o)if(!(o.sweepLv>a))0<o.Challengetime-s.useChallCount&&e.push(s.id)}}return e},getAllSweepIdArr:function(){for(var e=[],t=game.VipCfg.getData(game.mainRoleData.vipLevel),a=this.getMatInfoArrByLv(),i=game.mainRoleData.lv,n=void 0,s=void 0,o=void 0,r=this.autoCost=0,g=a.length;r<g;r++)(n=a[r])&&(s=this.getMaterialCfgById(n.id))&&(s.openLv>i||0<s.Challengetime-n.useChallCount||0<(o=t.materialBuyTimes-n.useSweepCount)&&(e.push({id:n.id,num:o}),this.autoCost+=o*s.costNum));return e},updateAllCanSweep:function(){this.allCanSweep=!1},updateCanQuickSweep:function(){if(this.allCanSweep){game.mainRoleData.lv;this.matFBInfoMap.forEach(function(e,t){t.canQuickSweep=this.allCanSweep},this)}else;},hasMatChall:function(){for(var e=this.getMatInfoArrByLv(),t=game.mainRoleData.lv,a=game.mainRoleData.maxPower,i=0,n=e.length;i<n;i++){var s=e[i];if(s){var o=this.getMaterialCfgById(s.id);if(o)if(!(o.openLv>t||o.openPower>a))if(0<o.Challengetime-s.useChallCount)return!0}}return!1},materialSort:function(e,t){return e.sortId-t.sortId},selectGrade:function(e,t){var a=this.matFBInfoMap.get(e);a&&(a.id=t)},getGradeInfoArr:function(){var e=this,t=e.matFBInfoMap.get(e.curSelectType);if(!t)return null;e.gradeInfoArr||(e.gradeInfoArr=[]),0<e.gradeInfoArr.length&&e.clearGradeInfoArr();var a=e.getMaterialCfgsByType(e.curSelectType);if(!a||a.length<1)return null;var i=void 0,n=void 0,s=void 0,o=a.length,r=!1,g=game.mainRoleData.lv,l=t.power;a.sort(e.gradeSort);for(var c=o-1;-1<c;c--)i=a[c],n=game.MaterialGradeInfo.get(),i.openLv<=g&&i.openPower<=l&&!r?r=s=!0:s=!1,n.setData(i,i.id==t.id,s),e.gradeInfoArr.push(n);return 0<e.gradeInfoArr.length&&e.gradeInfoArr.sort(e.gradeSort),e.gradeInfoArr},gradeSort:function(e,t){return e.sortId-t.sortId},clearGradeInfoArr:function(){if(this.gradeInfoArr&&!(this.gradeInfoArr.length<1)){for(var e=this.gradeInfoArr.length,t=0;t<e;t++)this.gradeInfoArr[t].release();this.gradeInfoArr.length=0}},updateGrade:function(e){var t=this.getMaterialCfgById(e);if(t){var a=this.matFBInfoMap.get(t.type);a&&(a.id=e,a.grade=t.grade)}},setCount:function(e){this.finishCount=e},getCount:function(){return this.finishCount},addCount:function(e){var t=0<arguments.length&&void 0!==e?e:1;this.finishCount+=t},getMatInfoByType:function(e){return this.matFBInfoMap.get(e)},getMaterialCfgById:function(e){return this.cfgObj1||(this.cfgObj1={id:0}),this.cfgObj1.id=e,game.MaterialCfg.getData(this.cfgObj1)},getMaterialCfgByTG:function(e,t){return this.cfgObj2||(this.cfgObj2={type:0,grade:0}),this.cfgObj2.type=e,this.cfgObj2.grade=t,game.MaterialCfg.getData(this.cfgObj2)},getMaterialCfgsByGrade:function(e){return this.cfgObj3||(this.cfgObj3={grade:0}),this.cfgObj3.grade=e,game.MaterialCfg.getData(this.cfgObj3,!0)},getMaterialCfgsByType:function(e){return this.cfgObj4||(this.cfgObj4={type:0}),this.cfgObj4.type=e,game.MaterialCfg.getData(this.cfgObj4,!0)},getDescByGrade:function(e){return this.gradeDescArr||(this.gradeDescArr=game.CfgUtil.getMiscValue(game.InstanceMiscCfg,"materialType",!0,"|")),!this.gradeDescArr||this.gradeDescArr.length<1?"":this.gradeDescArr[e-1]},selectMatType:function(e){if(this.curSelectType){var t=this.matFBInfoMap.get(this.curSelectType);t&&(t.isSelect=!1)}this.curSelectType=e;var a=this.matFBInfoMap.get(e);a&&(a.isSelect=!0)},getSelectInfo:function(){return this.curSelectType?this.matFBInfoMap.get(this.curSelectType):null}});game.instFuncData=game.instFuncData||new e}(),function(){var e;e=b8e.Object.extends({id:0,useChallCount:0,useSweepCount:0,vipLv:0,lv:0,canQuickSweep:!1,openLv:0,sortId:0,type:0,grade:0,isSelect:!1,power:0,ctor:function(){this._super()},setData:function(e){if(e&&(this.useChallCount=e.challengeNum,this.useSweepCount=e.sweepNum,this.grade=e.grade,this.grade)){var t=game.instFuncData.getMaterialCfgByTG(this.type,this.grade);if(!t)return;this.id=t.id}},vipLvUp:function(e){this.vipLv=e},lvUp:function(e){this.lv=e},powerUp:function(e){this.power=this.power<e?e:this.power},initInfo:function(e,t){this.id=e.id,this.useChallCount=0,this.useSweepCount=0,this.canQuickSweep=t,this.openLv=e.openLv,this.sortId=e.sortId,this.type=e.type}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$MatItemInfo",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(605),this.toggles={tab1_select:game.ME.InstanceHall},this.spotAlerts={INSTFUNC_HALL:this.instFuncHallAlert}},notify:function(e,t){switch(e){case game.InstanceFuncEvts.SWITCH_PAGE:this.toggleSelect(t)}},toggleSelect:function(e){if(!this._super(e));},onShow:function(){this.toggleSelect(0)},onHide:function(){},instFuncHallAlert:function(e){this.skin.red_spot1.node.active=e.alert}});b8e.module.registerView(game.ME.InstanceFunc,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1522)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.InstanceHallItem,this._list.bindEnum=game.ME.InstanceFunc,this._list.layout.paddingLeft=0,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)},onShow:function(){this.updateList()},updateList:function(){this.infos=game.instanceHallData.getInfos(),this._list.setData(this.infos)},onHide:function(){},onStageResize:function(){this.setPosition(0,0)},$$getInstanceHallItem:function(e){if(!this._list||!this.infos||this.infos.length<=e)return null;var t=this.infos[e];if(!t)return null;var a=this._list.getItemRender(t);return a&&a.skin?a.skin.btn_goto:null}});b8e.module.registerView(game.ME.InstanceHall,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1523),this.setSize(599,202)},init:function(){this.registerSP=!1,this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.layout.spacingX=15,this._prizeList.addToParent(this.skin.list)},setData:function(e){var t=this.skin;t.des.string=e.cfg.desc;var a=game.mainRoleData.lv;t.btn_goto.active=a>=e.openLv,t.bg_1.active=e.openLv>a,t.lab.string=game.Lang.get(514,e.openLv);var i=game.ResCfg.getUrl(10173,e.cfg.bgRes);t.bg.loadTexture(i),this.createPrize(),this.registerSpotAlertCb()},registerSpotAlertCb:function(){if(!this.registerSP){this.registerSP=!0;var e=this.data.cfg;if(e.spotAlertEnum){var t=b8e.getDPV(game.SAE,e.spotAlertEnum);t&&game.spotAlert.setCb(t,this.showAlert,this)}else this.skin.redPoint.node.active=!1}},showAlert:function(e){this.skin.redPoint.node.active=e.alert},createPrize:function(){if(this.data.cfg){var e=this.data.cfg;e.prizeInfo||(e.prizeInfo=game.CfgUtil.getPrizeListInfo(e.showItems,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84)),this._prizeList.setData(e.prizeInfo.items)}},btn_goto:function(){var e=this.data.moduleId;if(e){if(e==game.ME.Explore){if(!game.moduleOpen.checkOpenWithTips(game.ME.Explore))return;if(game.sceneData.isGuildMap(!1))return void game.notice.show(53114);if(game.sceneData.isCsScene(!0))return void game.notice.show(35115);if(game.exploreData.getCountDown()<5*b8e.TimeUtil.MINUTE_MICRO_SECONDS)return void game.notice.show(53111);if(game.playBack.isInstanceFighting())return;return game.exploreScene.activeScene(),void game.module.show(game.ME.Explore)}game.module.show(e)}else b8e.warn(game.Lang.get(53067))}}),b8e.RC("$$game","$$InstanceHallItem",e)}(),function(){var e=game.View.extends({matList:null,_showModel:!0,ctor:function(){this._super(606),this.spotAlerts={SHOP_MATERIAL:this.shopAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},$$getInstEnterBtn:function(e){if(!(this.matList&&this.matList._container&&this.matList._container._layoutContent&&this.matList._container._layoutContent[e]))return null;var t=this.matList._container._layoutContent[e].skin;return t?t.canEnter_btn:null},init:function(){var e;(e=this.matList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal)).itemRender=game.MaterialItemView,e.bindEnum=game.ME.InstanceMaterial,e.addToParent(this.skin.matScrollView),e.resetContainer=!1,(e=this.gradeList=new game.List).itemRender=game.MaterialGradeItem,e.bindEnum=game.ME.InstanceMaterial,e.addToParent(this.skin.gradeList)},notify:function(e){switch(e){case game.InstanceFuncEvts.UPDATE_DATA:this.updateData(),this.updateView();break;case game.InstanceFuncEvts.C2V_SELECT_MAT:this.updateView()}},onShow:function(){this.updateData(),this.updateView()},updateData:function(){var e=game.instFuncData.getMatInfoArrByLv();this.matList.setData(e)},updateView:function(){this.updateGradeList();var e=game.instFuncData.getSelectInfo();if(e){var t=game.instFuncData.getMaterialCfgById(e.id);if(t){var a=this.skin;a.banner.loadTexture(game.ResCfg.getUrl(10199,e.type));var i=t.Challengetime-e.useChallCount;a.freeNum.string=game.Lang.get(53293,i)}}},updateGradeList:function(){var e=game.instFuncData.getGradeInfoArr();this.gradeList.setData(e)}});b8e.module.registerView(game.ME.InstanceMaterial,e)}(),function(){var e;e=game.ListItem.extends({itemDatas:null,ctor:function(){this._super(607),this.setSize(105,138)},init:function(){},setData:function(){var e=this.data,t=this.skin;if(e){var a=game.instFuncData.getMaterialCfgById(e.id);if(a){t.selectBg.active=e.isSelect,t.titleBg.loadTexture(game.ResCfg.getUrl(10200,a.type));var i=game.mainRoleData.maxPower<a.openPower||game.mainRoleData.lv<a.openLv;t.notOpenImg.active=i,t.redPoint.active=!i&&0<a.Challengetime-e.useChallCount}}else b8e.error("MaterialItemView data is null")},clickBtn:function(){var e=game.instFuncData.getMaterialCfgById(this.data.id);e&&(game.mainRoleData.lv<e.openLv?game.notice.show(53297,e.openLv):this.data.power<e.openPower?game.notice.show(53298,e.openPower):this.send(game.InstanceFuncEvts.V2C_SELECT_MAT,this.data.type))}}),b8e.RC("$$game","$$MaterialItemView",e)}(),function(){var e;e=b8e.Enum({None:0,InstanceSuccess:-1,InstanceTimeChange:-1,V2C_EFFECT:-1,C2C_EFFECT:-1,C2C_REQ_SEEKHELP:-1,C_SELECT:-1,V_ON_NIEW_HIDE:-1,V_SHOW_INS_SUCCESS:-1}),b8e.RC("$$game","$$InstanceSuccessEvts",e)}(),function(){var t=void 0;t=b8e.PoolObject.extends({id:0,showId:0,setData:function(e,t){this.id=e,this.showId=t},recycle:function(){this.reset(),this._super()},reset:function(){this.id=0,this.showId=0}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$InstanceSuccessInfo",t)}(),function(){var e=b8e.Object.extends({ctor:function(){this.failMap=b8e.HashMap.get()},setData:function(e){if(e){var t=e.target.length;this.releaseInfo();for(var a=void 0,i=0;i<t;i++){var n=e.target[i],s=e.showId[i];(a=game.InstanceSuccessInfo.get()).setData(n,s),this.failMap.set(n,a)}}},getFailList:function(){return this.failMap.values()},releaseInfo:function(){var e=this.getFailList(),t=e.length;if(!(t<1)){for(var a=0;a<t;a++)e[a].release();this.failMap.clear()}}});game.instanceSuccessData=game.InstanceSuccessData||new e}(),function(){var e=game.Control.extends({ipc:function(){this.gevts={InstanceEvts:{G_STOP_PLAY:this.playStop}}},notify:function(e,t){switch(e){case this.Evts.V2C_EFFECT:this.dpt(this.Evts.C2C_EFFECT,1);break;case this.Evts.C_SELECT:game.module.hide(game.ME.InstanceSuccess),game.module.show(t);break;case this.Evts.V_ON_NIEW_HIDE:this.closeView()}},playStop:function(e){var t=this;if(e){var a=t.data=e.data;if(a){var i=game.InstanceSuccessCfg.getData(a.type);if(i&&!i.isShow&&(!a.group||a.isEnd))if(t.isWin=a.win,t.isWin&&i.winDontShow){this._showPrize()}else if(!t.isWin&&game.taskData.isAutoPass&&t.dptG(game.MainInstanceEvts.G_AUTO_PASS_END),a.type!=game.InstanceType.guildConflict){if(a.type==game.InstanceType.WORLD_WAR_TEAM&&a.isEnd?(b8e.module.isShowView(game.ME.WorldWarTeamDetailsView)||game.module.show(game.ME.WorldWarTeamDetailsView),t.dptG(game.InstanceEvts.C2C_WORLD_WAR_TEAM_STOP_PLAY,a)):a.type==game.InstanceType.WORLD_WAR_TEAM2&&a.isEnd&&(b8e.module.isShowView(game.ME.WorldWar2TeamDetailsView)||game.module.show(game.ME.WorldWar2TeamDetailsView),t.dptG(game.InstanceEvts.C2C_WORLD_WAR2_TEAM_STOP_PLAY,a)),t.isWin||game.instanceSuccessData.setData(i),game.gamePopupMgr.show(game.ME.InstanceSuccess),t.send(t.Evts.InstanceSuccess,a),t.hideTime=game.SysTime.curTime+5e3,t.send(t.Evts.InstanceTimeChange,t.isWin,5),t.hideTimer)t.hideTimer.reset(),t.hideTimer.start();else{this.hideTimer=b8e.Timer.add(this,this.updateHideTime,500)}t.dpt(t.Evts.V_SHOW_INS_SUCCESS,a)}}}},_showPrize:function(){game.ServerItemUtil.analyzeItems(this.data,1)},updateHideTime:function(){var e=this.hideTime-game.SysTime.curTime;if(e<=0){return this.hideTimer.stop(),void this.sureBtn()}e=e/1e3>>0,this.send(this.Evts.InstanceTimeChange,this.isWin,e)},sureBtn:function(){if(this.hideTimer){this.hideTimer.stop()}this._showPrize(),game.module.hide(game.ME.InstanceSuccess),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},quitBtn:function(){game.module.hide(game.ME.InstanceSuccess)},closeView:function(){this.hideTimer&&this.hideTimer.stop(),this.data.type==game.InstanceType.CHUANG_GUAN&&game.taskData.isAutoPass&&this.dpt(this.Evts.V_ON_NIEW_HIDE),game.playBack.isInstanceFighting(!1)||(game.playBack.info=null)},details_btn:function(){game.module.show(game.ME.BattleDetails)},descBtn:function(){game.RuleView.inst().showView(game.ME.BattleDetails)}}),t=[game.ME.BattleDetails];b8e.module.registerControl(game.ME.InstanceSuccess,e,game.InstanceSuccessEvts,null,t)}(),function(){var e;e=b8e.Enum({NONE:0,NORMAL:1,CHUANG_GUAN:2,CS_TEAM:3,GUILD:4,GUO_GUAN_ZHAN_JIANG:5,PUBLIC_BOSS:6,XIAN_DI_BAO_ZANG:7,PERSONAL_BOSS:8,MATERIAL:9,TAO_FA:10,WILD_BOSS:11,ESCORT:12,ZHAO_QIN:13,WORLD_WAR_TEAM:14,GUILD_MAP:15,ENLIST:16,DIANWEI:17,ARENA:18,GUILD_BOSS:19,XIAN_DI:20,WILD_BOSS_PVP:21,CS_PVP:22,CS_PVE:23,CS_WAR:24,THRONE_PVP:25,THRONE_PVE:26,CS_ARROW:27,GUANDU:30,YEAR_TASK:31,FESTIVALBOSS:35,HUNTING:36,CS_ARENA:37,CBP:40,GENERAL_BOSS:41,GUOSHI_CHALLENGE:42,CS_GUILD_PVP:43,CS_GUILD_PVE:44,WORLD_CHALLENGE:45,ALL_SERVER_WAR:46,GUILD_WAR:47,GUILD_WAR_PVE:48,GUILD_WAR_BOSS:49,GUILD_WAR_PVP:50,PET_HOME:51,REBIRTH:53,TREASURE:54,OCCUPIED:55,TEAMLEAGUE_MATCH:56,WORLD_WAR_TEAM2:57,CS_OVERLORD:58,THOUSANDTOWER:59,FLAGWAR:60,CS_FESTIVAL_BOSS:61,VIPBOSS:62,ZHUANJI:63,EXPLORE:64,BARBARIAN:65,GUILD_INS:66,guildConflict:67,GUILD_NEW_BOSS:68,STORT_BATTLE:900}),b8e.RC("$$game","$$InstanceType",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1436),this.setSize(86,85)},setData:function(){var e=this.skin,t=this.data,a=game.ResCfg.getUrl(10135,t.id);e.bg.loadTexture(a)},btn:function(){this.send(game.InstanceSuccessEvts.C_SELECT,this.data.showId)}}),b8e.RC("$$game","$$InstanceSuccessItme",e)}(),function(){var e=game.View.extends({_showModel:!0,isGuidCopy:!1,ctor:function(){this._super(1435)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.list.itemRender=game.PrizeListItem,e.list.layout.paddingLeft=10,e.list.layout.paddingRight=0,e.list.layout.paddingTop=10,e.list.layout.spacingX=60,e.list.layout.spacingY=20,e.list.addToParent(e.skin.prizeNode),e.failList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.failList.itemRender=game.InstanceSuccessItme,e.failList.bindEnum=game.ME.InstanceSuccess,e.failList.layout.spacingX=50,e.failList.layout.spacingY=50,e.failList.layout.paddingLeft=50,e.failList.addToParent(e.skin.failList)},notify:function(e,t,a){switch(e){case this.Evts.InstanceSuccess:this.data=t,b8e.hasTimeout(this.showView,this)||b8e.setTimeout(this.showView,this,100);break;case this.Evts.InstanceTimeChange:this.skin.endTime.string=(t?game.Lang.get(9194):game.Lang.get(9431))+"("+a+")"}},onShow:function(){this.active=!1},showView:function(){var e=this.skin,t=this.data;if(t){this.active=!0,this.isWin=t.win,this.type=t.type,e.huawen_3.width=b8e.stageWidth+100,e.huawen_1.width=b8e.stageWidth+100;var a=game.InstanceSuccessCfg.getData(t.type);t.win||a&&a.failedShowAward?(e.sureBtn.active=!0,this.showWin(t)):(e.sureBtn.active=!1,this.showFailed(t));var i=game.playBack.info;i&&(e.roundLab.string=game.Lang.get(1621,i.rounds,i.roundLimit));var n=game.playBack.getCurInstType(),s=game.InstanceType;e.roundLab.active=e.roundDesc.active=e.details_btn.active=null!=i&&n!=s.WORLD_WAR_TEAM&&n!=s.CS_PVE&&n!=s.CS_TEAM}else game.module.hide(this.moduleEnum)},showWin:function(e){var t=this.skin;if(t.failedNode.active=!1,t.winNode.active=!0,this.skin.light.active=!0,!e.sweep){var a=game.InstanceType;this.isGuidCopy=e.type==a.GUILD_INS||e.type==a.GUILD_NEW_BOSS,t.instanceCopyNode.active=this.isGuidCopy,this.isGuidCopy&&(t.damgeLab.string=e.damage)}game.TweenUtil.rotationEffect(this.skin.light);var i=game.ServerItemUtil.analyzeItems(e);this.resetPrizeList(i.length),this.list.setData(i),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeVictory)},resetPrizeList:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i=this.skin,n=void 0;switch(e){case 1:n=300;break;case 2:n=225;break;case 3:n=145;break;default:n=80}this._isMore=4<e,a&&this.list.setSize(560,this._isMore?250:140);var s=0;this._isMore&&(s+=90),this.isGuidCopy&&(s+=90),i.prizeNode.setPosition(n,-320),i.pathNode.setPosition(360,-615-s-10),i.details_btn.setPosition(95,-533-s),i.instanceCopyNode.setPosition(0,this._isMore?-90:0),i.gray.setSize(b8e.stageWidth+50,420+s)},showFailed:function(e){this.skin.winNode.active=!1,this.skin.failedNode.active=!0,this.skin.light.active=!1,game.InstanceSuccessCfg.getData(e.type)?this.changeTargetsPos():this.changeTargetsPos(null)},changeTargetsPos:function(){var e=game.instanceSuccessData.getFailList();this.failList.setData(e),this.resetPrizeList(e.length,!1)},onHide:function(){if(this.list){this.list.clear()}var e=this.skin;e.winNode.active=!1,e.failedNode.active=!1,e.instanceCopyNode.active=!1,this._isMore=!1,b8e.Tween.kill(e.light),this.send(this.Evts.V_ON_NIEW_HIDE),b8e.sound.stopAllEffectSound()},onStageResize:function(){var e=b8e.stageHeight,t=b8e.stageWidth;this.setPosition(.5*(t-this.width),.5*(e+this.height))}});b8e.module.registerView(game.ME.InstanceSuccess,e)}(),function(){var e;e=b8e.Enum({None:0,V_UPDATEDATA:b8e.enc(),C_GET_AWARD:b8e.enc(),C_FIRST_OPENED:b8e.enc()}),b8e.RC("$$game","$$InvestmentEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.investSpot=game.spotAlert.set(game.SAE.INVEST_ALERT),this.buyAlertOption={thisArg:this,title:game.Lang.get(9425),lang:2202,okcb:this.okCb,cancelcb:this.cancelCb}},ipc:function(){this.evts={Welfare:{C_INIT_MODEL:this.updateData},Recharge:{C_RECHARGE_SUCCESS:this.updateBtn}},this.handels={BuyInvestorResp:this.buyInvestorResp,InvestorAwardResp:this.investorAwardResp}},checkAlert:function(){var e=game.investData,t=e.getCanGetAwardDay();this.investSpot.alert=0<t||!e.isBuy&&!e.firstOpened},updateBtn:function(){this.send(this.Evts.V_UPDATEDATA)},buyInvestorResp:function(e){var t=e.readProtobuf(game.pb.BuyInvestorResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.investData.synData(!0,1,[]),this.send(this.Evts.V_UPDATEDATA),this.checkAlert()},investorAwardResp:function(e){var t=e.readProtobuf(game.pb.InvestorAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.investData.getAward(t.day),this.send(this.Evts.V_UPDATEDATA),this.checkAlert()},updateData:function(e){game.investData.createCfgData();var t=e.data,a=t.isBuyInvestor,i=t.investorDay,n=t.investorAwards;game.investData.synData(a,i,n),this.checkAlert()},notify:function(e,t){switch(e){case this.Evts.C_GET_AWARD:this.getAwardReq(t);break;case this.Evts.C_FIRST_OPENED:game.investData.firstOpened||(game.investData.firstOpened=!0),this.checkAlert()}},getAwardReq:function(e){if(game.investData.canGetAward(e)){this.sender.InvestorAwardReq(e)}else game.notice.show(9195)},awardBtn:function(){if(game.investData.isBuy){var e=game.investData.getCanGetAwardDay();if(0<e){this.getAwardReq(e)}else game.notice.show(9196)}else{if(!game.rechargeData.getRechargePass())return void game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE);var t=0|game.WelfareMiscCfg.getData("buyInvestCost").value;if(game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,t)){game.Lang.get(2202);game.alert.showTwo(this.buyAlertOption)}}},noAwardBtn:function(){game.notice.show(9197)},okCb:function(){this.sender.BuyInvestorReq(),game.module.hide(game.ME.GameAlert)},cancelCb:function(){game.module.hide(game.ME.GameAlert)}}),t=game.Sender.extends({ipc:function(){this.msg={BuyInvestorReq:null,InvestorAwardReq:this.investorAwardReq}},investorAwardReq:function(e){var t=game.pb.InvestorAwardRequest;t.day=e,this.write(t)}});b8e.module.registerControl(game.ME.Investment,e,game.InvestmentEvts,t)}(),function(){var e;e=b8e.Object.extends({day:0,isGetAward:!1,ctor:function(){this._super()},setData:function(){},setByCfg:function(e){this.day=e.days,this.isGetAward=!1,this.cfg=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$InvestListInfo",e)}(),function(){var e=b8e.Object.extends({investMap:null,investInfoArr:null,investDayMax:0,isOpen:!0,firstOpened:!1,ctor:function(){this._super()},createCfgData:function(){if(!this.investMap){this.investMap=b8e.HashMap.get()}if(!this.investInfoArr){this.investInfoArr=[]}var e=game.WelfareMiscCfg.getData("investDays");this.investDayMax=0|e.value;var t=game.miscData.openServerDay;this.isOpen=t<=this.investDayMax;var a=b8e.TimeUtil.getTodayTime(game.SysTime.curTime);this.endTime=a+(this.investDayMax-t+1)*b8e.TimeUtil.DAY_MICRO_SECONDS;var i=game.InvestPlanCfg.getDatas();if(i){var n=null;this.investMap.clear();for(var s=null,o=this.investInfoArr.length=0,r=i.length;o<r;o++){n=i[o],(s=new game.InvestListInfo).setByCfg(n),this.investInfoArr.push(s),this.investMap.set(s.day,s)}}},synData:function(e,t,a){if(this.isBuy=e,this.dayCount=t,this.awardArr=a,0<this.awardArr.length)for(var i=0,n=this.awardArr.length;i<n;i++){this.getAward(this.awardArr[i])}this.updateIsOpen()},updateIsOpen:function(){if(this.isBuy){this.isOpen=!this.isAllAwardGet()}},isAllAwardGet:function(){if(this.awardArr&&this.investDayMax&&this.awardArr.length<this.investDayMax){return!1}return!0},getAward:function(e){var t=this.investMap.get(e);if(!t.isGetAward){if(this.awardArr.indexOf(t.day)<0){this.awardArr.push(t.day)}t.isGetAward=!0}this.updateIsOpen()},canGetAward:function(e){if(!this.isBuy){return!1}if(e>this.dayCount){return!1}var t=this.investMap.get(e);if(t)return!t.isGetAward;return!1},getInfoArr:function(){return this.investInfoArr},getCanGetAwardDay:function(){if(!this.investInfoArr)return 0;for(var e=null,t=0,a=this.investInfoArr.length;t<a;t++){if(e=this.investInfoArr[t],this.canGetAward(e.day)){return e.day}}return 0},getInvestOpen:function(){return this.isOpen},getCountdown:function(){return this.isOpen?0:this.endTime-game.SysTime.curTime}});game.investData=game.investData||new e}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(608),this.setSize(295,153)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid);e.itemRender=game.ShowItemListItem,e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingX=15,e.addToParent(this.skin.prizeList)},setData:function(){var e=this.skin,t=this.data;e.titleLab.string=game.Lang.get(2201,t.day),e.alreadyGot.node.active=t.isGetAward,e.mask_sp.node.active=t.isGetAward;for(var a=game.CfgUtil.getPrizeListInfo(t.cfg.award,null,game.IconSizeEnum.GRID_SIZE_84),i=0,n=a.items.length;i<n;i++){a.items[i].iconLayoutEnum=2}if(a){this.list.setData(a.items)}},getAwardBtn:function(){this.send(game.InvestmentEvts.C_GET_AWARD,this.data.day)}}),b8e.RC("$$game","$$InvestListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(609)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.InvestListItem,e.layout.spacingX=9,e.layout.spacingY=9,e.bindEnum=game.ME.Investment,e.addToParent(this.skin.rebateList)},notify:function(e){switch(e){case game.InvestmentEvts.V_UPDATEDATA:this.updateData()}},onShow:function(){this.updateData(),this.send(game.InvestmentEvts.C_FIRST_OPENED)},updateData:function(){var e=this.skin,t=game.investData.getInfoArr();this.list.setData(t);var a=0<game.investData.getCanGetAwardDay(),i=game.investData.isBuy;e.timeNode.node.active=!i;var n=game.rechargeData.getRechargePass();if(i){if(a){e.funcLab.string=game.Lang.get(9198)}if(e.noAwardBtn.node.active=!a,e.awardBtn.node.active=a,this.timer){this.timer.stop()}}else{var s,o=0|game.WelfareMiscCfg.getData("buyInvestCost").value;if(s=n?game.Lang.get(1712,o):game.Lang.get(5818),e.funcLab.string=s,this.timer)this.timer.reset(),this.timer.start();else{this.timer=b8e.Timer.add(this,this.updateTime,1e3)}e.noAwardBtn.node.active=a,e.awardBtn.node.active=!a}},updateTime:function(){var e=game.investData.endTime-game.SysTime.curTime,t=game.TimeUtil.formatTimeSpace(e,3);this.skin.timeLab.string=t},onHide:function(){if(this.timer){this.timer.stop()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.Investment,e)}(),function(){var e;e=b8e.Enum({None:0,GetLevelPrize:-1,C2V_GET_PRIZE:-1,C2C_GET_ALL_PRIZE:-1}),b8e.RC("$$game","$$LevelPrizeEvts",e)}(),function(){var e=game.Control.extends({init:function(){game.levelPrizeData.initData(),this.spotAlert=game.spotAlert.set(game.SAE.LEVEL_PRIZE,game.SAE.WELFARE_ALERT)},ipc:function(){this.evts={MainRole:{C_LEVEL_UP:this.checkAlert,C_INIT_MAIN_ROLE:this.checkAlert,C_RESET_DAILY:this.checkAlert},Welfare:{C_INIT_MODEL:this.checkAlert}},this.handels={LevelAwardResp:this.onLevelAwardResponse}},onLevelAwardResponse:function(e){var t=e.readProtobuf(game.pb.LevelAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else{if(game.levelPrizeData.getPrizeComplete(t.level),this.send(this.Evts.C2V_GET_PRIZE),game.levelPrizeData.isGetAllPrize()){this.dpt(this.Evts.C2C_GET_ALL_PRIZE)}this.checkAlert(),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeConsume)}},notify:function(e,t){var a=this;switch(e){case a.Evts.GetLevelPrize:var i=game.mainRoleData.lv,n=game.LevelAwardCfg.getData(t),s=game.amount.get(game.AmountType.YUAN_BAO);if(t<=i&&s>=n.currentPrice){a.sender.LevelAwardReq(t)}else game.notice.show(116)}},checkAlert:function(){this.spotAlert.alert=game.levelPrizeData.checkLevelList()}}),t=game.Sender.extends({ipc:function(){this.msg={LevelAwardReq:this.levelAwardReq}},levelAwardReq:function(e){var t=game.pb.LevelAwardRequest;t.level=e,this.write(t)}});b8e.module.registerControl(game.ME.LevelPrize,e,game.LevelPrizeEvts,t)}(),function(){var e=b8e.Object.extends({levelAwards:null,initData:function(){for(var e,t,a=this.levelMap=b8e.HashMap.get(),i=game.LevelAwardCfg.getDatas(),n=i.length,s=0;s<n;s++){t=i[s],(e=new game.LevelPrizeInfo).setConfig(t),a.set(e.level,e)}this.levelAwards=[],this.checkLevelList()},getLevels:function(){var e=this.levelMap.values();if(e&&0<e.length){e.sort(this.onSort)}return e},onSort:function(e,t){var a=game.levelPrizeData;if(a.isGetPrize(e.level)==a.isGetPrize(t.level)){if(e.canGetPrize==t.canGetPrize){return e.level-t.level}if(e.canGetPrize){return-1}return 1}if(a.isGetPrize(e.level)){return 1}if(a.isGetPrize(t.level)){return-1}},setupLevelAwards:function(e){if(e){if(e.levelAwards){this.levelAwards=e.levelAwards}this.checkLevelList()}else;},getPrizeComplete:function(e){var t=this.levelAwards;if(-1<t.indexOf(e)){b8e.error("\u91cd\u590d\u9886\u53d6\u6210\u529f\uff1f")}else t.push(e)},isGetPrize:function(e){return-1<this.levelAwards.indexOf(e)},canGetPrize:function(e){return!this.isGetPrize(e)&&e<=game.mainRoleData.lv},checkLevelList:function(){var e=this,t=e.levelMap;if(!t){return!1}for(var a,i,n=game.LevelAwardCfg.getDatas(),s=n.length,o=!1,r=0;r<s;r++){if(i=n[r],(a=t.get(i.level)).role_level=game.mainRoleData.lv,a.isGetPrize=e.isGetPrize(i.level),a.canGetPrize=e.canGetPrize(i.level),a.canGetPrize){o=!0}}return o},isGetAllPrize:function(){var e=this;if(!e.levelMap){return!0}for(var t,a=game.LevelAwardCfg.getDatas(),i=a.length,n=0;n<i;n++){if(t=a[n],!e.isGetPrize(t.level)){return!1}}return!0}});game.levelPrizeData=game.levelPrizeData||new e}(),function(){var e;e=b8e.Object.extends({level:0,role_level:0,isGetPrize:!1,canGetPrize:!1,config:null,setConfig:function(e){this.config=e,this.level=e.level},getPrizeItems:function(){var e=this;if(!e.config){return null}if(e.awards){return e.awards}var t,a,i=e.config.award,n=i.length;e.awards=[];for(var s=0;s<n;s++){t=i[s],a=game.ItemUtil.createBaseItemInfo(t.Id,t.Num),e.awards.push(a)}return e.awards}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$LevelPrizeInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(637),this.setSize(601,177)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.prize),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=-5,t.layout.spacingX=17,t.layout.spacingY=-5,e.prev_icon=game.GridUtil.createViewClickIcon(game.IconSizeEnum.GRID_SIZE_42),e.prev_icon.addToParent(e.skin.prev_icon),e.new_icon=game.GridUtil.createViewClickIcon(game.IconSizeEnum.GRID_SIZE_42),e.new_icon.addToParent(e.skin.new_icon)},setData:function(){var e=this,t=e.skin,a=e.data;t.level.string=game.Lang.get(9529,a.level);var i=a.getPrizeItems();if(this.prizeList.setData(i),a.isGetPrize)t.cantGet.active=!1,t.getBtn.active=!1,t.getPrize.active=!0;else if(a.canGetPrize)t.cantGet.active=!1,t.getBtn.active=!0,t.getPrize.active=!1;else{var n=a.role_level,s=game.HtmlUtil.getText(game.Color.RED,game.Lang.get(9587,n))+game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9530,a.level));t.canGetLevel.string=s,t.cantGet.active=!0,t.getBtn.active=!1,t.getPrize.active=!1}t.prev_cost.string=a.config.originalPrice,t.new_cost.string=a.config.currentPrice,e.prev_icon.setItemId(a.config.costItemId),e.new_icon.setItemId(a.config.costItemId)},getBtn:function(){if(game.UpgradeUtil.checkEquipTooMuch())return!1;this.send(game.LevelPrizeEvts.GetLevelPrize,this.data.level)}}),b8e.RC("$$game","$$LevelPrizeListItem",e)}(),function(){var e=game.View.extends({levels:null,ctor:function(){this._super(638)},init:function(){this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.LevelPrizeListItem,this.list.bindEnum=game.ME.LevelPrize,this.list.layout.paddingLeft=0,this.list.layout.spacingY=5,this.list.addToParent(this.skin.list),this.skin.banne.loadTexture(game.ResCfg.getUrl(254))},notify:function(e){switch(e){case this.Evts.C2V_GET_PRIZE:this.levels=game.levelPrizeData.getLevels(),this.list.scrollToTop(),this.list.setData(this.levels)}},onShow:function(){this.list.scrollToTop(),this.levels=game.levelPrizeData.getLevels(),this.list.setData(this.levels)},onHide:function(){},onStageResize:function(){}});b8e.module.registerView(game.ME.LevelPrize,e)}(),function(){var e;e=b8e.Enum({None:0,UPDATE_VIEW:-1,GET_PRIZE:-1,UPDATE_STATE:-1,C2C_REFRESH_BTNS:-1,CHANGE_AD:-1,V2C_GET_AD_POS:-1,GET_AD_POS:-1,C2V_FOLLOW_CHAT:-1,GUID_UPDATA:-1,GUID_UPDATA2:-1,UPDATA_DAY:-1,UPDATA_DAY2:-1}),b8e.RC("$$game","$$LoginAwardsEvts",e)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){game.loginAwardsData.initData(),this.spotAlert=game.spotAlert.set(game.SAE.LOGIN_PRIZE)},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily},Welfare:{C_INIT_MODEL:this.setupData}},this.gevts={InstanceEvts:{G_STOP_PLAY:this.checkShowView}},this.handels={LoginAwardResp:this.onLoginAwardResponse}},setupData:function(e){var t=e.data;game.loginAwardsData.setupLoginDays(t),this.checkAlert(),this.dpt(this.Evts.C2C_REFRESH_BTNS)},onLoginAwardResponse:function(e){var t=this,a=e.readProtobuf(game.pb.LoginAwardResponse);if(0<a.code){game.notice.noticeError(a.code)}else{game.loginAwardsData.getPrizeComplete(a.day),t.checkAlert(),t.send(game.LoginAwardsEvts.UPDATE_STATE),game.loginAwardsData.isGetAllPrize()&&game.module.hide(t.moduleEnum),t.dpt(t.Evts.C2C_REFRESH_BTNS),t.showAward(),t.timer?(t.timer.reset(),t.timer.start()):t.timer=b8e.Timer.add(t,t.updateTime,100,1),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)}},showAward:function(){game.loginAwardsData.typeinfo||(game.awardsData.setItemsByArray(game.loginAwardsData.items,!0),game.module.show(game.ME.AwardShowTip))},updateTime:function(){game.loginAwardsData.checkDaysList1()},checkAlert:function(){this.spotAlert.alert=game.loginAwardsData.checkDaysList()},checkAd:function(){var e=game.loginAwardsData;if(!e.AdIsClick){var t=e.isGetPrize(2),a=e.getShowLv()-1;if(!t&&game.mainRoleData.lv>a){e.AdIsClick=!0;var i=game.sceneData.isCsScene(),n=game.playBack.isInstanceFighting(!1);if(i||n)return void(e.canShowView=!0);game.module.show(game.ME.LoginAwardsMain)}else game.module.hide(game.ME.LoginAwardsMain)}},resetDaily:function(){this.checkAlert(),game.loginAwardsData.checkDaysList1(),this.send(game.LoginAwardsEvts.UPDATE_STATE)},notify:function(e,t){var a=this;switch(e){case game.LoginAwardsEvts.GET_PRIZE:game.miscData.loginDay>=t.days&&(a.sender.LoginAwardReq(t.days),game.loginAwardsData.items=t.items,game.loginAwardsData.typeinfo=t.typeinfo),game.loginAwardsData.isGetAllPrize()&&game.module.hide(game.ME.LoginAwards);break;case game.LoginAwardsEvts.V2C_GET_AD_POS:a.dpt(game.LoginAwardsEvts.GET_AD_POS);break;case game.LoginAwardsEvts.GUID_UPDATA:this.send(game.LoginAwardsEvts.GUID_UPDATA2,t);break;case game.LoginAwardsEvts.UPDATA_DAY:this.send(game.LoginAwardsEvts.UPDATA_DAY2,t)}},getBtn:function(){this.closeAdBtn(),game.module.show(game.ME.LoginAwards)},closeAdBtn:function(){game.loginAwardsData.AdIsClick=!0,game.module.hide(game.ME.LoginAwardsMain)},checkShowView:function(){game.loginAwardsData.canShowView&&(game.module.show(game.ME.LoginAwardsMain),game.loginAwardsData.canShowView=!1)}}),t=[game.ME.LoginAwardsMain],a=game.Sender.extends({ipc:function(){this.msg={LoginAwardReq:this.loginAwardReq}},loginAwardReq:function(e){var t=game.pb.LoginAwardRequest;t.day=e,this.write(t)}});b8e.module.registerControl(game.ME.LoginAwards,e,game.LoginAwardsEvts,a,t)}(),function(){var e=b8e.Object.extends({loginAwards:null,AdIsClick:!1,isInit:!1,canShowView:!1,items:null,typeinfo:null,initData:function(){this.loginDaysMap=b8e.HashMap.get();this.configs=game.LoginAwardCfg.getDatas();for(var e,t,a=this.configs,i=a.length,n=0;n<i;n++){t=a[n],(e=new game.LoginAwardsInfo).setConfig(t),this.loginDaysMap.set(e.days,e)}this.loginAwards=[]},getLoginAwards:function(){this.Awardslist=[];var e=this.loginDaysMap.values();game.miscData.loginDay;this.type=this.getDayType();for(var t=0;t<e.length;t++){var a=e[t];a.type==this.type&&this.Awardslist.push(a)}return this.Awardslist},sortFunc:function(e,t){e.canGetPrize,e.isGetPrize,t.canGetPrize,t.isGetPrize;return!e.isGetPrize&&t.isGetPrize?-1:e.isGetPrize&&!t.isGetPrize?1:e.canGetPrize&&!t.canGetPrize?-1:!e.canGetPrize&&t.canGetPrize?1:e.conDay-t.conDay},setupLoginDays:function(e){if(e)e.loginAwards&&(this.loginAwards=e.loginAwards),this.isInit=!0,this.checkDaysList();else;},getPrizeComplete:function(e){var t=this,a=t.loginAwards;if(-1<a.indexOf(e)){b8e.error("\u91cd\u590d\u9886\u53d6\u6210\u529f\uff1f")}else a.push(e),t.checkDaysList()},isGetPrize:function(e){return-1<this.loginAwards.indexOf(e)},canGetPrize:function(e){return!this.isGetPrize(e)&&e<=game.miscData.loginDay},getStr:function(){var e="",t=this.getShowDay();if(t<1)return e;var a=this.loginDaysMap.get(t);if(!a)return e;var i=a.config;return e=a.canGetPrize?i.curDes:i.nextDes},getDataByDay:function(){var e=game.miscData.loginDay,t=this.loginDaysMap;if(!t)return!1;var a=t.count();return a<e&&(e=a),t.get(e)},checkDaysList:function(){var e=this,t=e.loginDaysMap;if(!t){return!1}for(var a,i,n=e.configs,s=n.length,o=!1,r=0;r<s;r++)i=n[r],(a=t.get(i.days)).isGetPrize=e.isGetPrize(i.days),a.canGetPrize=e.canGetPrize(i.days),a.deadline=i.days-game.miscData.loginDay,a.canGetPrize&&(o=!0);return o},checkDaysList1:function(){var e=this,t=e.loginDaysMap;if(!t)return!1;for(var a,i,n=e.configs,s=n.length,o=0;o<s;o++)i=n[o],(a=t.get(i.days)).isGetPrize1=e.isGetPrize(i.days),a.canGetPrize1=e.canGetPrize(i.days),a.deadline1=i.days-game.miscData.loginDay},isGetAllPrize:function(){var e=this,t=e.loginDaysMap,a=game.miscData.loginDay,i=void 0;if(!t||!this.isInit)return!0;var n=t.values();if(!n)return!0;i=n[a-1]?this.getConDayType():this.getDayType();for(var s,o=e.configs,r=o.length,g=0;g<r;g++){if((s=o[g]).type==i&&!e.isGetPrize(s.days))return!1}return!0},getDayType:function(){var e=this.loginDaysMap.values(),t=0;if(!e)return 0;for(var a=0;a<e.length;a++){e[a].isGetPrize&&t++}return e[t]?e[t].type:e[t-1].type},getConDayType:function(){var e=this.loginDaysMap.values(),t=game.miscData.loginDay,a=0;if(!e)return 0;for(var i=0;i<e.length;i++){e[i].isGetPrize&&a++}return e[t-1]?e[t-1].canGetPrize?e[t-1].type:e[a-1].type:(0==a&&a++,e[a-1].type)},getShowDay:function(){var e=this.configs;if(!e||e.length<1)return 0;e.sort(function(e,t){return e.days-t.days});for(var t,a=e.length,i=0;i<a;i++)if(t=e[i],!this.isGetPrize(t.days))return t.days;return 0},getShowLv:function(){return this.showLv||(this.showLv=0|game.CfgUtil.getMiscValue(game.WelfareMiscCfg,"LoginShowLv")),this.showLv}});game.loginAwardsData=game.loginAwardsData||new e}(),function(){var e;e=b8e.Object.extends({isGetPrize:!1,canGetPrize:!1,deadline:0,isGetPrize1:!1,canGetPrize1:!1,deadline1:0,days:0,type:0,config:null,itemInfo:null,showItem:null,awardsAry:null,setConfig:function(e){var t=this;t.config=e,t.days=e.days,t.type=e.type,t.conDay=e.conDay,t.awardsAry=e.award;var a=t.config.award[0],i=t.config.showItem[0];t.itemInfo=game.ItemUtil.createBaseItemInfo(a.Id,a.Num),t.showItem=game.ItemUtil.createBaseItemInfo(i.Id,i.Num),t.showItem.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM},getFirstItem:function(){var e=this;return e._syncAwards(),e._firstItem}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$LoginAwardsInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(643),this.setSize(139,162)},init:function(){this.skin.getPrizeBtn.touchEffectDisabled=!0},setData:function(){var e=this,t=e.skin,a=e.data;e.itemInfo=a.itemInfo,e.day=a.conDay;var i=game.ResCfg.getUrl(10163,a.conDay);t.iconNode.loadTexture(i),t.day_1.string=game.Lang.get(9556,a.conDay),t.name.string=a.config.itemname,a.isGetPrize1?(t.getBtn.node.active=!1,t.getPrizeBtn.node.active=!1,t.isGetImg.node.active=!0,t.name.node.active=!0,t.day_1.node.active=!0,t.needDay.node.active=!1):a.canGetPrize1?(t.getBtn.node.active=!0,t.getPrizeBtn.node.active=!0,t.day_1.node.active=!0,t.isGetImg.node.active=!1,t.name.node.active=!1,t.needDay.node.active=!1):(t.getBtn.node.active=!1,t.getPrizeBtn.node.active=!1,t.isGetImg.node.active=!1,t.day_1.node.active=!1,1==a.deadline1?(t.name.node.active=!0,t.needDay.node.active=!0,e.createTimer()):1<a.deadline1&&(t.name.node.active=!0,t.needDay.node.active=!0,t.needDay.string=game.Lang.get(53098,a.days-game.miscData.loginDay))),2!=a.conDay&&3!=a.conDay&&8!=a.conDay||e.setEffect(),1==a.conDay&&a.canGetPrize1?this.send(game.LoginAwardsEvts.GUID_UPDATA,1):1==a.conDay&&a.isGetPrize1&&this.send(game.LoginAwardsEvts.GUID_UPDATA,2)},setGuid:function(){this.guid||(this.guid=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)),this.guid&&!this.guid.parent&&this.skin.guid.addChild(this.guid);var e=game.ResCfg.getUrl(5019,1001);this.guid.load(e),this.guid.play()},setEffect:function(){this._effect||(this._effect=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)),this._effect&&!this._effect.parent&&this.skin.effect.addChild(this._effect);var e=game.ResCfg.getUrl(5022,1002);this._effect.load(e),this._effect.play()},createTimer:function(){this.setCountDown(),this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.setCountDown,1e3)},setCountDown:function(){var e=game.SysTime.curTime,t=b8e.TimeUtil.getTodayTime(e)+b8e.TimeUtil.DAY_MICRO_SECONDS-e;if(t<1)this.clearTimer();else{var a=b8e.TimeUtil.formatTime(t);this.skin.needDay.string=a}},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.setCountDown),this.timer=null)},getPrizeBtn:function(){var e={};e.days=this.data.days,e.items=this.data.awardsAry,e.typeinfo=335112==this.itemInfo.id,this.send(game.LoginAwardsEvts.GET_PRIZE,e)},fnOnClickGrid:function(){if(this.itemInfo){this.send(game.LoginAwardsEvts.UPDATA_DAY,this.day),game.tipsData.setInfo(this.itemInfo);var e=game.ItemInfoCfg.getCfgTypeById(this.itemInfo.id),t=game.ItemCfgType;switch(e){case t.Equip:case t.PartnerProper:var a=game.partnerEquipData.createInfoById(this.itemInfo.id);a.setData(this.itemInfo),game.tipsData.setInfo(a),game.partnerEquipData.selInfo=a,e==t.Equip&&game.module.show(game.ME.EquipDetailsTips),e==t.PartnerProper&&game.module.show(game.ME.ExcEquipDetailsTips);break;case t.Amount:case t.ShowItem:case t.EffectItem:case t.NormalItem:default:game.module.show(game.ME.ItemTips)}}}}),b8e.RC("$$game","$$LoginAwardsListItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(645)},init:function(){this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.list.itemRender=game.LoginAwardsListItem,this.list.bindEnum=game.ME.LoginAwards,this.list.layout.paddingLeft=4,this.list.layout.paddingTop=4,this.list.layout.spacingY=8,this.list.layout.spacingX=15,this.list.addToParent(this.skin.list)},notify:function(e,t){switch(e){case game.LoginAwardsEvts.UPDATE_STATE:this.updateList();break;case game.LoginAwardsEvts.GUID_UPDATA2:this.setGuid(t);break;case game.LoginAwardsEvts.UPDATA_DAY2:this.updateSelect(t)}},setGuid:function(e){var t=this;if(1==e){t.guid||(t.guid=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1)),t.guid&&!t.guid.parent&&t.skin.guid.addChild(t.guid);var a=game.ResCfg.getUrl(5019,1001);t.guid.load(a),t.guid.play()}else 2==e&&t.guid&&(t.guid.clear(),t.guid.parent&&t.guid.removeFromParent())},onShow:function(){game.loginAwardsData.checkDaysList1();var e=game.loginAwardsData.getDataByDay().days;this.updateSelect(e),this.updateList()},updateList:function(){this.datas=game.loginAwardsData.getLoginAwards(),this.list.setData(this.datas)},updateSelect:function(e){var t=game.ResCfg.getUrl(10164,e);this.skin.banner_2.loadTexture(t);var a=game.ResCfg.getUrl(10183,e);this.skin.banner_3.loadTexture(a);var i=!1,n=!1;1==e||2==e?i=!0:n=!0,this.skin.bg_tit1.active=i,this.skin.bg_tit2.active=n},onHide:function(){},$$getLoginAwardsItem:function(e){if(!this.list||!this.datas||!this.datas.length)return null;var t=this.list._container._layoutContent[e].skin;return t?t.getPrizeBtn:null},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.LoginAwards,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(644),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){},onShow:function(){this.send(game.LoginAwardsEvts.V2C_GET_AD_POS)},onStageResize:function(){this.send(game.LoginAwardsEvts.V2C_GET_AD_POS)}});b8e.module.registerView(game.ME.LoginAwardsMain,e)}(),function(){var e;e=b8e.Enum({NONE:0,C_ADD_MAIL:-1,C_DEL_MAIL:-1,C_COLLECT_MAIL:-1,C_INIT_MAIL:-1,C2C_DEL_MAIL:-1,C2C_COLLECT_MAIL:-1,V_UPDATE_MAILS:-1,V2C_SEE_MAIL:-1,V_UPDATE_SEE_MAIL:-1,C_SHOW_MAIL:-1}),b8e.RC("$$game","$$MailEvts",e)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.MAIL,game.SAE.HOME)},ipc:function(){var e=this;e.evts={MailSee:{C2C_DEL_MAIL:e.delMail,C2C_COLLECT_MAIL:e.collectMail},Scene:{C2C_RECONNECT_ENTER_SCENE:e.reconnect}},e.handels={MailResp:e.onMailResp,MailCollectResp:e.onMailCollectResponse,MailDeleteResp:e.onMailDeleteResponse,MailDeleteAllResp:e.onMailDeleteAllResponse,MailMsg:e.onMailNotify,MailDeleteMsg:e.onMailDeleteMsg}},reconnect:function(){this.sender.MailReq()},triggerOpen:function(e){e==this.moduleEnum&&this.sender.MailReq()},delMail:function(){var e=game.mailData.getSeeMail();if(e)if(0!=e.read)this.sender.MailDeleteReq(e.id),this.checkAlert();else{game.notice.show(9218)}else;},collectMail:function(){var e=game.mailData.getSeeMail();if(e)if(1!=e.read&&e.items&&0!=e.items.length){if(game.UpgradeUtil.checkEquipTooMuch());else this.sender.MailCollectReq([e.id]),this.checkAlert()}else{game.notice.show(9219)}else;},onMailNotify:function(e){var t=e.readProtobuf(game.pb.MailNotify);game.mailData.addMail(t.mail),this.dpt(game.MailEvts.C_ADD_MAIL),this.send(game.MailEvts.V_UPDATE_MAILS),this.checkAlert()},onMailDeleteMsg:function(e){var t=e.readProtobuf(game.pb.MailDeleteNotify);game.mailData.delMails(t.ids),this.dpt(game.MailEvts.C_ADD_MAIL),this.send(game.MailEvts.V_UPDATE_MAILS),this.checkAlert()},onMailDeleteAllResponse:function(e){var t=e.readProtobuf(game.pb.MailDeleteAllResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mailData.delMails(t.ids),this.dpt(game.MailEvts.C_DEL_MAIL),this.send(game.MailEvts.V_UPDATE_MAILS),this.checkAlert()},onMailDeleteResponse:function(e){var t=e.readProtobuf(game.pb.MailDeleteResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mailData.delMail(t.id),this.dpt(game.MailEvts.C_DEL_MAIL),this.send(game.MailEvts.V_UPDATE_MAILS),game.module.hide(game.ME.MailSee),this.checkAlert()},onMailCollectResponse:function(e){var t=e.readProtobuf(game.pb.MailCollectResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mailData.collectMail(t.ids),this.dpt(game.MailEvts.C_COLLECT_MAIL),this.send(game.MailEvts.V_UPDATE_MAILS),this.checkAlert(),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},onMailResp:function(e){var t=e.readProtobuf(game.pb.MailResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mailData.setData(t.list),this.dpt(game.MailEvts.C_INIT_MAIL),this.checkAlert()},getAll:function(){var e=game.mailData.getMailCollectIds();if(0<e.length){if(game.UpgradeUtil.checkEquipTooMuch()){return}this.sender.MailCollectReq(e)}},delAll:function(){this.sender.MailDeleteAllReq()},breakBtn:function(){game.module.showToggle(game.ME.Welfare,game.WelfareType.FEEDBACK)},notify:function(e,t){switch(e){case game.MailEvts.V2C_SEE_MAIL:game.mailData.seeMail(t);var a=game.mailData.getSeeMail();if(0==a.read&&(!a.items||0==a.items.length)){this.sender.MailCollectReq([a.id])}game.module.show(game.ME.MailSee)}},checkAlert:function(){var e=game.mailData.needReadCount();this.spotAlert.alert=0<e,this.dpt(game.MailEvts.C_SHOW_MAIL)}}),t=game.Sender.extends({ipc:function(){this.msg={MailReq:null,MailDeleteAllReq:null,MailCollectReq:this.mailCollectReq,MailDeleteReq:this.mailDeleteReq}},mailCollectReq:function(e){var t=game.pb.MailCollectRequest;t.ids=e,this.write(t)},mailDeleteReq:function(e){var t=game.pb.MailDeleteRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.Mail,e,game.MailEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Mail:{C_COLLECT_MAIL:this.updateView}}},updateView:function(){this.send(this.Evts.V_UPDATE_SEE_MAIL)},getPrize:function(){this.dpt(game.MailEvts.C2C_COLLECT_MAIL)},delMail:function(){this.dpt(game.MailEvts.C2C_DEL_MAIL)},closeBtn:function(){this._super(),game.mailData.clearSeeMailId()},returnBtn:function(){this._super(),game.mailData.clearSeeMailId()}});b8e.module.registerControl(game.ME.MailSee,e,game.MailEvts)}(),function(){var e=b8e.Object.extends({mails:null,mailPool:null,seeMailId:0,ctor:function(){this.mails=b8e.HashMap.get(),this.mailPool=[],this._super()},setData:function(e){if(e&&0!=e.length)for(var t=0,a=e.length;t<a;t++){this.addMail(e[t])}else;},addMail:function(e){if(e){var t=this.mails.get(e.id);if(t);else(t=this.getMailInfo()).setData(e),this.mails.set(t.id,t)}else;},getMail:function(e){return this.mails.get(e)},needReadCount:function(){var a=0;return this.mails.forEach(function(e,t){if(!t.read){a++}}),a},getMails:function(){var e=this.mails.values();return e.sort(this._sortOn),e},_sortOn:function(e,t){if(e.read){if(e.read!=t.read)return 1;return t.sendTime-e.sendTime}if(e.read!=t.read)return-1;return t.sendTime-e.sendTime},getMailCollectIds:function(){var a=[];return this.mails.forEach(function(e,t){if(0==t.read){a.push(t.id)}},this),a},seeMail:function(e){if(e)if(this.getMail(e))this.seeMailId=e;else{b8e.error("\u8bd5\u56fe\u67e5\u770b\u4e00\u5c01\u4e0d\u5b58\u5728\u7684\u90ae\u4ef6")}},getSeeMail:function(){if(!this.seeMailId){return null}var e=this.getMail(this.seeMailId);if(e)return e;b8e.error("\u8bd5\u56fe\u67e5\u770b\u4e00\u5c01\u4e0d\u5b58\u5728\u7684\u90ae\u4ef6")},clearSeeMailId:function(){this.seeMailId=0},delMails:function(e){for(var t,a=0,i=e.length;a<i;a++){if(t=this.mails.get(e[a]))this.putMailInfo(t);else{b8e.error("\u670d\u52a1\u5668\u5e0c\u671b\u5220\u9664\u4e00\u5c01\u4e0d\u5b58\u5728\u7684\u90ae\u4ef6",e[a])}}},delMail:function(e){var t=this.mails.get(e);if(t)this.putMailInfo(t);else{b8e.error("\u670d\u52a1\u5668\u5e0c\u671b\u5220\u9664\u4e00\u5c01\u4e0d\u5b58\u5728\u7684\u90ae\u4ef6",e)}},collectMail:function(e){for(var t,a=0,i=e.length;a<i;a++){if(t=this.mails.get(e[a]))t.read=!0;else{b8e.error("\u670d\u52a1\u5668\u5e0c\u671b\u6807\u8bb0\u4e00\u5c01\u4e0d\u5b58\u5728\u7684\u90ae\u4ef6",e[a])}}},getMailInfo:function(){if(0<this.mailPool.length){return this.mailPool.shift()}return new game.MailItemInfo},putMailInfo:function(e){if(e){this.mails.del(e.id),e.clear(),this.mailPool.push(e)}},getItmes:function(e){if(!e)return null;if(e.items)return e.items;var t,a,i=[];if(e.exp){(t=game.ItemUtil.createBaseItemInfo(220001,e.exp)).iconLayoutEnum=game.IconLayoutEnum.SHOW_ALL,t.isDarkBg=!0,i.push(t)}for(var n=0,s=e.item.length;n<s;n++){a=e.item[n],(t=game.ItemUtil.createBaseItemInfo(a.id,a.num)).iconLayoutEnum=game.IconLayoutEnum.SHOW_ALL,t.isDarkBg=!0,i.push(t)}return i.sort(this._onSortOn),e.items=i},getTitle:function(e){if(!e)return null;if(e.title)return e;if(e.modelId){var t="";if(10==e.modelId||9==e.modelId){var a=game.RechargeCfg.getDataById(e.params[0]);t=a?[a.name]:e.params}else t=e.params;var i=game.MailLang.getLang(e.modelId,t);i=i.split("|"),e.title=i[0],e.content=i[1]}return e},_onSortOn:function(e,t){return e.id-t.id}});game.mailData=game.mailData||new e}(),function(){var e;e=b8e.Object.extends({id:0,title:null,content:null,sendTime:null,modelId:0,params:null,items:null,read:!1,item:null,setData:function(e){var t=this;t.id=e.id,t.sendTime=e.sendTime,t.modelId=e.modelId,t.params=e.params,t.title=e.title,t.content=e.content,t.item=e.items,t.read=e.read},clear:function(){var e=this;e.id=0,e.title=null,e.content=null,e.sendTime=null,e.modelId=0,e.params=null,e.items=null,e.read=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$MailItemInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(658),this.setSize(600,124)},touch:function(){this.send(game.MailEvts.V2C_SEE_MAIL,this.data.id)},setData:function(){var e,t,a=this.data;t=a.read?50102:50103,e=game.Lang.get(t);var i=game.mailData.getItmes(a);if(i&&0<i.length&&!a.read){this.skin.prizeNode.active=!0}else this.skin.prizeNode.active=!1;var n=game.mailData.getTitle(a),s=game.HtmlUtil.getText(game.Color.BLACK,n.title);this.skin.name.string=s+e,this.skin.time.string=b8e.TimeUtil.formatTimestamp(a.sendTime)}}),b8e.RC("$$game","$$MailListItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(659)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.list.itemRender=game.MailGoodsItem,e.list.layout.paddingLeft=20,e.list.layout.paddingRight=0,e.list.layout.paddingTop=0,e.list.layout.spacingX=46,e.list.layout.spacingY=25,e.list.addToParent(e.skin.prizeList),e.skin.content.node.removeFromParent(),e.contentScrollBox=new b8e.ScrollBox,e.contentScrollBox.setScrollType(b8e.ScrollBoxType.Vertical),e.contentScrollBox.setContainer(e.skin.content.node),e.contentScrollBox.addToParent(e.skin.contentScroller)},onShow:function(){this.updateView()},updateView:function(){var e=game.mailData.getSeeMail();if(e){var t=this.skin;t.content.string=e.content,e.items&&0!=e.items.length?(t.itemsNode.active=!0,this.list.setData(e.items),this.list.scrollToTop(),e.items.length<=5?(t.itemsNode.y=-387,this.list.height=160,this.contentScrollBox.height=270):(t.itemsNode.y=-283,this.list.height=280,this.contentScrollBox.height=160),t.getedBtn.active=e.read,t.getPrize.active=!e.read):(t.getedBtn.active=!1,t.getPrize.active=!0,t.itemsNode.active=!1,this.contentScrollBox.height=460),this.contentScrollBox.scrollToTop()}},notify:function(e){switch(e){case this.Evts.V_UPDATE_SEE_MAIL:this.updateView()}},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+40)}});b8e.module.registerView(game.ME.MailSee,e)}(),function(){var e=game.View.extends({list:null,ctor:function(){this._super(660)},init:function(){this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.MailListItem,this.list.bindEnum=game.ME.Mail,this.list.layout.spacingY=5,this.list.addToParent(this.skin.list)},onShow:function(){this.updateList()},notify:function(e){switch(e){case game.MailEvts.V_UPDATE_MAILS:this.updateList()}},updateList:function(){var e=game.mailData.getMails();this.skin.noMail.node.active=!e||e.length<1,this.list.setData(e)}});b8e.module.registerView(game.ME.Mail,e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,_data:null,ctor:function(){this._super(),this.setSize(89,130)},setData:function(){var e=this;if(e.data){var t=e.data.iconLayoutEnum?e.data.iconLayoutEnum:game.IconLayoutEnum.SHOW_NUM,a=e.data.iconSize?e.data.iconSize:game.IconSizeEnum.GRID_SIZE_105;e._icon||(e._icon=game.GridUtil.createPrizeIcon(a),e._icon.setPosition(50,-53),e._icon.addToParent(e)),game.GridUtil.setItemIcon(e._icon,e.data,!1,t)}else;}})).poolCall=!0,b8e.RC("$$game","$$MailGoodsItem",e)}(),function(){var e;e=b8e.Enum({None:0,C_INIT_MARRY:b8e.enc(),C_REQ_DATA:b8e.enc(),C_SELECT_ROLE:b8e.enc(),C_REQ_MARRY:b8e.enc(),C_COMFIR_SEND_MARRY:b8e.enc(),C_SELECT_RESULT:b8e.enc(),C_SEND_GIFT:b8e.enc(),C_BREAK_MARRY:b8e.enc(),C_MARRY_COMPLETE:b8e.enc(),V_UPDATEDATE:b8e.enc(),V_GIFT_SUCCESS:b8e.enc(),V_SELECT_RESULT:b8e.enc(),V_SELECT_ROLE:b8e.enc(),V_UPDATE_GIFT:b8e.enc(),V_UPDATE_OATHVIEW:b8e.enc()}),b8e.RC("$$game","$$MarryEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.alertOption={thisArg:this,title:game.Lang.get(9425),lang:2254,okcb:this.okCb,cancelcb:this.cancelCb}},ipc:function(){var e=this;e.evts={MainUIChat:{SHOW_CHATVIEW:e.reqData}},e.handels={MarriageModelResp:e.marriageModelResp,MarryResp:e.marryResp,MarryAcceptResp:e.marryAcceptResp,MarryResultMsg:e.marryResultNotify,MarryReqMsg:e.marryReqNotify,MarryMsg:e.marryNotify,MarryGiftsResp:e.marryGiftsResp,DivorceResp:e.divorceResp,DivorceMsg:e.divorceNotify}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.MarriageModelReq()},marriageModelResp:function(e){var t=e.readProtobuf(game.pb.MarryModel);if(0<t.code){game.notice.noticeError(t.code)}else game.marryData.synData(t),this.dpt(this.Evts.C_REQ_DATA,t),this.send(this.Evts.V_UPDATEDATE)},marryResp:function(e){var t=e.readProtobuf(game.pb.MarryResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(9224),game.module.hide(game.ME.MarryReq),this.send(this.Evts.V_UPDATEDATE)},reqData:function(){this.sender.MarriageModelReq()},marryAcceptResp:function(e){var t=e.readProtobuf(game.pb.MarryAcceptResponse);if(0<t.code){game.notice.noticeError(t.code)}else{if(t.result){game.notice.show(game.Lang.get(6633,t.targetName)),this.sender.MarriageModelReq(),game.marryData.patnerIsMale=t.isMale,game.module.show(game.ME.MarryOath),this.dpt(this.Evts.C_MARRY_COMPLETE,t.houseType)}else game.notice.show(game.Lang.get(6634,t.targetName));game.module.hide(game.ME.MarryConfirm),this.send(this.Evts.V_UPDATEDATE),this.send(game.MarryEvts.V_UPDATE_OATHVIEW,t.targetName)}},marryResultNotify:function(e){var t=e.readProtobuf(game.pb.MarryResultNotify);if(t.result){game.notice.show(game.Lang.get(6635,t.targetName)),this.sender.MarriageModelReq(),game.marryData.patnerIsMale=t.isMale,game.module.show(game.ME.MarryOath),this.send(game.MarryEvts.V_UPDATE_OATHVIEW,t.targetName),this.dpt(this.Evts.C_MARRY_COMPLETE,t.houseType)}else game.notice.show(game.Lang.get(6636,t.targetName))},marryReqNotify:function(e){var t=e.readProtobuf(game.pb.MarryReqNotify);game.module.show(game.ME.MarryConfirm),this.send(this.Evts.V_SELECT_RESULT,t)},marryNotify:function(e){var t=e.readProtobuf(game.pb.MarryNotify);game.marryData.addMarryPair(t);var a=game.mainRoleData.id;if(t.roleId!=a&&t.targetId!=a){if(!b8e.module.isShowView(game.ME.MarryGift)){game.module.show(game.ME.MarryGift),this.send(this.Evts.V_UPDATE_GIFT)}}else;},marryGiftsResp:function(e){var t=e.readProtobuf(game.pb.MarryGiftsResponse);if(0<t.code){game.notice.noticeError(t.code)}else if(game.notice.show(9225),0<game.marryData.marryPairArr.length){game.module.show(game.ME.MarryGift),this.send(this.Evts.V_UPDATE_GIFT)}else game.module.hide(game.ME.MarryGift)},divorceResp:function(e){var t=e.readProtobuf(game.pb.DivorceResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.marryData.clearPatnerData(),this.send(this.Evts.V_UPDATEDATE)},divorceNotify:function(e){if(e.readProtobuf(game.pb.DivorceNotify))game.marryData.clearPatnerData(),this.send(this.Evts.V_UPDATEDATE);else;},notify:function(e,t){var a=this;switch(e){case a.Evts.C_REQ_DATA:a.sender.MarriageModelReq();break;case a.Evts.C_SELECT_ROLE:a.selectRole(t);break;case a.Evts.C_REQ_MARRY:a.showMarryConfirm(t.roleId,t.isHusband);break;case a.Evts.C_COMFIR_SEND_MARRY:a.sendMarryReq();break;case a.Evts.C_SELECT_RESULT:a.confirmResult(t.result,t.roleId);break;case a.Evts.C_SEND_GIFT:a.sendGift(t.type,t.id1,t.id2);break;case a.Evts.C_BREAK_MARRY:a.showBreakMarry()}},selectRole:function(e){this.send(this.Evts.V_SELECT_ROLE,e)},showMarryConfirm:function(e,t){game.marryData.targetRoleId=e,game.marryData.isHusband=t,game.module.show(game.ME.MarryReq)},showBreakMarry:function(){game.alert.showTwo(this.alertOption)},okCb:function(){this.sender.DivorceReq(),game.module.hide(game.ME.GameAlert)},cancelCb:function(){game.module.hide(game.ME.GameAlert)},sendMarryReq:function(){var e=game.marryData.marryType,t=game.marryData.targetRoleId,a=game.marryData.isHusband,i=game.MarryCfg.getData(e);if(i)if(game.UpgradeUtil.checkItemList(i)){this.sender.MarryReq(e,t,a)}else game.notice.show(9226)},confirmResult:function(e,t){if(e);this.sender.MarryAcceptReq(e,t)},sendGift:function(e,t,a){this.sender.MarryGiftsReq(e,t,a)}}),t=game.Sender.extends({ipc:function(){this.msg={MarriageModelReq:null,MarryReq:this.marryReq,MarryAcceptReq:this.marryAcceptReq,MarryGiftsReq:this.marryGiftsReq,DivorceReq:null}},marryReq:function(e,t,a){var i=game.pb.MarryRequest;i.marryId=e,i.targetId=t,i.isHusband=a,this.write(i)},marryAcceptReq:function(e,t){var a=game.pb.MarryAcceptRequest;a.result=e,a.targetId=t,this.write(a)},marryGiftsReq:function(e,t,a){var i=game.pb.MarryGiftsRequest;i.id=e,i.targetId1=t,i.targetId2=a,this.write(i)},confirmBtn:function(){},refuseBtn:function(){}}),a=[game.ME.MarryReq,game.ME.MarryConfirm,game.ME.MarryGift,game.ME.MarryOath];b8e.module.registerControl(game.ME.Marry,e,game.MarryEvts,t,a)}(),function(){var e=b8e.Object.extends({selectRoleId:0,selectMarryType:1,marryPairArr:null,patnerData:null,patnerIsMale:!1,targetRoleId:0,isHusband:!0,marryType:1,ctor:function(){this._super(),this.marryPairArr=[]},synData:function(e){this.setPartnerData(e)},setPartnerData:function(e){this.hasPartner=0<e.partner,this.patnerData=e},clearMarryReqInfo:function(){this.marryType=1},clearPatnerData:function(){this.hasPartner=!1,this.patnerData=null,this.marryType=1},addMarryPair:function(e){if(e)this.marryPairArr.push(e);else;},getMarryPair:function(){return this.marryPairArr.shift()}});game.marryData=game.marryData||new e}(),function(){var e;e=b8e.Enum({NONE:0,EASY:1,NORMAL:2,Deluxe:3,MAX:4}),b8e.RC("$$game","$$MarryType",e)}(),function(){var e=game.View.extends({_showModel:!0,MAX_TYPE:3,prizeListArr:null,ctor:function(){this._super(665)},notify:function(e,t){switch(e){case this.Evts.V_SELECT_RESULT:this.updateDate(t)}},onShow:function(){},onHide:function(){},updateDate:function(e){var t=this.skin,a=e.targetName,i=e.houseType,n="";if(1==i){n=game.Lang.get(2251)}else if(2==i){n=game.Lang.get(2252)}else if(3==i){n=game.Lang.get(2253)}t.nameLab.string=game.Lang.get(1801,a,n),this.targetId=e.targetId},viewconfirmBtn:function(){this.send(this.Evts.C_SELECT_RESULT,{result:!0,roleId:this.targetId})},viewrefuseBtn:function(){this.send(this.Evts.C_SELECT_RESULT,{result:!1,roleId:this.targetId})}});b8e.module.registerView(game.ME.MarryConfirm,e)}(),function(){var e=game.View.extends({_showModel:!0,MAX_TYPE:3,prizeListArr:null,pairData:null,_modelTouchClose:!1,ctor:function(){this._super(666)},init:function(){this.iconArr=[],this.costIconArr=[];for(var e=null,t=1;t<4;t++){(e=this.iconArr[t]=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105)).addToParent(this.getComponent("typeNode"+t)),(e=this.costIconArr[t]=b8e.Sprite.get()).setAnchor(.5,.5),e.addToParent(this.getComponent("icon"+t)),e.setSize(36,36)}},onShow:function(){},notify:function(e){switch(e){case game.MarryEvts.V_UPDATE_GIFT:this.updatePairData()}},updatePairData:function(){var e=game.marryData.getMarryPair();if(!e){return!1}var t=this.skin,a=(this.pairData=e).roleName,i=e.targetName;t.nameLab.string=game.Lang.get(1802,a,i);for(var n=null,s=null,o=null,r=null,g=1;g<4;g++){n=this.iconArr[g],o=(s=game.MarryGiftsCfg.getData(g)).award,r=game.ItemInfoCfg.getData(o[0].Id),n.setItemInfo(r),n.setNum(o[0].Num),n=this.costIconArr[g];var l=s.costItem;r=game.ItemInfoCfg.getData(l[0].Id);var c=game.ResCfg.getUrl(137,r.icon);n.loadTexture(c),this.getComponent("costLab"+g).string=l[0].Num}return!0},onHide:function(){},viewsendBtn1:function(){this.sendGift(1)},viewsendBtn2:function(){this.sendGift(2)},viewsendBtn3:function(){this.sendGift(3)},sendGift:function(e){if(this.pairData){var t=game.MarryGiftsCfg.getData(e);if(t){var a=t.costItem;if(game.UpgradeUtil.checkItemList(a))this.send(game.MarryEvts.C_SEND_GIFT,{type:e,id1:this.pairData.roleId,id2:this.pairData.targetId});else;}else;}else;},closeBtn:function(){if(!this.updatePairData()){this._super()}}});b8e.module.registerView(game.ME.MarryGift,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,headIconArr:null,ctor:function(){this._super(667)},init:function(){var e=this;e.headIcon1=b8e.Sprite.get(),e.headIcon1.setAnchor(.5,.5),e.headIcon1.addToParent(e.skin.headBg1.node),e.headIcon2=b8e.Sprite.get(),e.headIcon2.setAnchor(.5,.5),e.headIcon2.addToParent(e.skin.headBg2.node),e.anima1=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima1.addToParent(e.skin.anima1),e.anima1.load(game.ResCfg.getUrl(5019,1015)),e.anima1.addFinishCallback(e.animaCB1,e),e.anima2=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima2.addToParent(e.skin.anima2),e.anima2.load(game.ResCfg.getUrl(5019,1016)),e.anima2.addFinishCallback(e.animaCB2,e),e.anima2.setScale(1.3,1.3)},onShow:function(){var e=this;e.headIcon1.clear(),e.headIcon2.clear(),e.skin.tips2.string=game.Lang.get(2255),this.anima1.active=!0,this.anima2.active=!0,this.anima1.play(null,0),this.anima2.play(null,0)},animaCB1:function(){this.anima1.active=!1},animaCB2:function(){this.anima2.active=!1},notify:function(e,t){switch(e){case game.MarryEvts.V_UPDATE_OATHVIEW:this.updateData(t,game.mainRoleData.name)}},onHide:function(){},updateData:function(e,t){var a=this.skin;this.updateHeadIcon(game.marryData.patnerIsMale,game.mainRoleData.isMale),a.nameLab1.string=e,a.nameLab2.string=t},updateHeadIcon:function(e,t){var a=game.ResCfg.getHead(e);this.headIcon1.loadTexture(a),a=game.ResCfg.getHead(t),this.headIcon2.loadTexture(a)},viewConfirmBtn:function(){this.closeBtn()}});b8e.module.registerView(game.ME.MarryOath,e)}(),function(){var e=game.View.extends({_showModel:!0,MAX_TYPE:3,prizeListArr:null,ctor:function(){this._super(668)},init:function(){this.prizeListArr=[];for(var e=null,t=1;t<=this.MAX_TYPE;t++){(e=this.prizeListArr[t]=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal)).itemRender=game.ShowItemListItem,e.layout.spacingX=15,e.addToParent(this.getComponent("prizeList"+t))}this.costIconArr=[];var a=null;for(t=1;t<4;t++){(a=this.costIconArr[t]=b8e.Sprite.get()).setAnchor(.5,.5),a.addToParent(this.getComponent("gold"+t)),a.setSize(36,36)}},notify:function(e,t){switch(e){case this.Evts.V_SELECT_ROLE:this.updateSelectRoleName(t)}},onShow:function(){var e=this.skin;this.selectMarryType(1);var t=game.marryData.targetRoleId,a=game.relationData.getRoleInfoById(game.RelationTabType.FOLLOW,t);e.nameLab.string=a.name;for(var i=1;i<=this.MAX_TYPE;i++){this.updateTypeInfo(i)}e.cost1.string=game.Lang.get(2251),e.cost2.string=game.Lang.get(2252),e.cost3.string=game.Lang.get(2253)},updateTypeInfo:function(e){this.skin;var t=this.prizeListArr[e];if(t){var a=game.MarryCfg.getData(e);if(a){var i=this.costIconArr[e],n=a.costItem,s=0;if(n){s=n[0].Num;var o=game.ItemInfoCfg.getData(n[0].Id),r=game.ResCfg.getUrl(137,o.icon);i.loadTexture(r)}this.getComponent("costLab"+e).string=s;var g=a.award,l=game.CfgUtil.getPrizeListInfo(g,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);if(l){t.setData(l.items)}}else;}else;},onHide:function(){game.marryData.clearMarryReqInfo()},selectMarryType:function(e){for(var t=1;t<=this.MAX_TYPE;t++){this.getComponent("check"+t).node.active=e==t}game.marryData.marryType=e},viewtype1:function(){this.selectMarryType(1)},viewtype2:function(){this.selectMarryType(2)},viewtype3:function(){this.selectMarryType(3)},viewMarryReqBtn:function(){this.send(game.MarryEvts.C_COMFIR_SEND_MARRY)}});b8e.module.registerView(game.ME.MarryReq,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(669),this.setSize(200,22)},init:function(){},setData:function(){var e=this.skin,t=this.data,a=t.isOnline?game.Color.GREEN:game.Color.BLACK;e.nameLab.node.color=a,e.nameLab.string=t.name},selectBtn:function(){this.send(game.MarryEvts.C_SELECT_ROLE,this.data.roleId)}}),b8e.RC("$$game","$$MarryRoleItem",e)}(),function(){var e=game.View.extends({headIcon:null,selectCheck:1,showRoleList:!1,targetRoleId:0,ctor:function(){this._super(670)},init:function(){var e=this,t=e.skin;e.marryBg=b8e.Sprite.get(),e.marryBg.setAnchor(.5,.5),e.marryBg.addToParent(t.bg),e.headIcon=b8e.Sprite.get(),e.headIcon.setAnchor(.5,.5),e.headIcon.addToParent(e.skin.headBg.node);var a=e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);a.itemRender=game.MarryRoleItem,a.layout.paddingLeft=0,a.bindEnum=game.ME.Marry,a.addToParent(t.scrollView),e.modelArr=[],e.roleDataArr=[];for(var i=null,n=1;n<3;n++){this.roleDataArr[n]=game.BaseRoleData.get(game.RoleType.Hero,1),(i=game.sceneRoleCreate.createUIRole(this.roleDataArr[n])).addToParent(this.getComponent("model"+n)),this.modelArr[n]=i}},notify:function(e,t){switch(e){case this.Evts.V_SELECT_ROLE:this.updateSelectRoleName(t);break;case this.Evts.V_UPDATEDATE:this.updateData()}},onShow:function(){this.headIcon.clear(),this.skin.selecNameLab.string="",this.autoSelectCheck(),this.updateData(),this.targetRoleId=0},onHide:function(){},updateData:function(){var e=this.skin,t=game.marryData.hasPartner;if(e.noPatnerNode.active=!t,t){e.btnDesLab.string=game.Lang.get(9227),this.marryBg.loadTexture(game.ResCfg.getUrl(21));var a;a=game.mainRoleData.heroModel;var i=game.mainRoleData.isMale?game.Color.BLUE:game.Color.PURPLE;e.nameLab1.node.color=i;var n=null;if(game.marryData.patnerData){n=game.marryData.patnerData}if(this.updateModel(1,a),this.updateModel(2,n),e.nameLab1.string=game.mainRoleData.name,game.marryData.patnerData&&game.marryData.patnerData.partnerName){var s=game.marryData.patnerData.isMale;e.nameLab2.string=game.marryData.patnerData.partnerName,e.modelNode1.active=!0,e.modelNode2.active=!0;i=s?game.Color.BLUE:game.Color.PURPLE;e.nameLab2.node.color=i}else e.modelNode2.active=!1}else e.btnDesLab.string=game.Lang.get(9228),this.marryBg.loadTexture(game.ResCfg.getUrl(20)),e.modelNode1.active=!1,e.modelNode2.active=!1;this.updateRoleList(),this.updateShowList(!1)},updateModel:function(e,t){var a=this.modelArr[e];if(a){var i=this.roleDataArr[e];if(i){var n=this.roleDataArr[e].heroModel;if(n&&t){var s=game.AvatarUtil;if(n.clear(),n.setMale(t.isMale),n.setBody(game.RoleType.Hero,t.isMale?1002:1001),1==e)i.heroModel.setAnims(t.copyAnim()),t.surfaces&&i.heroModel.setSurfaces(t.surfaces),s.updateUIModel(a,s.ID_1);else if(2==e){var o=t.surface;n.type=game.RoleType.Hero,n.setSurface(o),s.updateUIModel(a,s.ID_1),a._headBar&&a._headBar.setScale(-1,1)}a.transition(game.RoleStateType.ACTION_IDLE)}}}},updateSelectRoleName:function(e){var t=game.relationData.getRoleInfoById(game.RelationTabType.FOLLOW,e);if(t){this.skin.selecNameLab.string=t.name,this.updateHeadIcon(t.isMale),this.autoSelectCheck(),this.updateShowList(!1),this.targetRoleId=e}else this.headIcon.clear(),this.skin.selecNameLab.string=""},updateRoleList:function(){var e=game.relationData.getSortTabTypeArr(game.RelationTabType.FOLLOW);if(!e||e.length<1);else{var t=this.getOpenLv(),a=e.filter(function(e){return e.level>=t});this.list.setData(a)}},getOpenLv:function(){if(this.openLv)return this.openLv;var e=game.ModuleCfg.getData(game.ME.Marry).trigger1;if(e&&0<e.length)for(var t=e.length,a=void 0,i=0;i<t;i++)if((a=e[i]).Type==game.TriggerType.Level){this.openLv=a.Value;break}return this.openLv=0|this.openLv,this.openLv},updateHeadIcon:function(e){var t=game.ResCfg.getHead(e);this.headIcon.loadTexture(t)},onStageResize:function(){this.setPosition(0,0)},viewSelectBtn:function(){this.showRoleList=!this.showRoleList,this.updateShowList(this.showRoleList)},updateShowList:function(e){var t=this.skin;t.downBtn.node.active=e,t.upBtn.node.active=!e,t.scrollView.active=e,t.scrollViewBg.node.active=e},autoSelectCheck:function(){if(game.mainRoleData.isMale){this.updateCheck(2)}else this.updateCheck(1)},viewcheck1:function(){this.updateCheck(1)},viewcheck2:function(){this.updateCheck(2)},updateCheck:function(e){this.skin;for(var t=1;t<=2;t++){this.getComponent("ok"+t).node.active=e==t}this.selectCheck=e},viewfuncBtn:function(){if(game.marryData.hasPartner){this.send(this.Evts.C_BREAK_MARRY,t)}else{var e=!0;if(2==this.selectCheck){e=!1}if(this.targetRoleId<=0){return void game.notice.show(9229)}var t={};t.roleId=this.targetRoleId,t.isHusband=e,this.send(this.Evts.C_REQ_MARRY,t)}}});b8e.module.registerView(game.ME.Marry,e)}(),function(){var e;e=b8e.Enum({None:0,SWITCH_PAGE:-1,V_UPDATEMAVIEW:-1,REQMASTERDATA:-1,V_POST_ASKMASTER:-1,V_UPDATEMASTERVIEW:-1,SWITCH_APPRENTICE:-1,V_UPDATEAPPRENTICEVIEW:-1,V_UPDATEINVITEVIEW:-1,TAKE_APPRENTIVE:-1,AGREE_INVITE:-1,REPULSE_INVITE:-1,V_POST_CHUANGONG:-1,INIT_MASTER_DATA:-1,COMPLETE_TASK:-1,V2C_CHUSHI:-1,C_UPDATEMASTER:-1,C_UPDATEAPPRENTICE:-1}),b8e.RC("$$game","$$MasterApprenticeEvts",e)}(),function(){var e=game.Control.extends({lastSendTime:0,ipc:function(){var e=this;e.gevts={SceneGEvts:{FIRST_ENTER_SCENE:e.onReqMasterData}},e.evts={ChatPlayerInfo:{C2C_APPRENTICE:e.apprenticeByChat}},e.handels={MasterDataResp:e.syncMasterData,ApprenticeResp:e.onRpApprentice,TakeApprenticeResp:e.onRpTakeApprentice,TakeApprenticeMsg:e.onTakeApprenticeNotify,AddMasterResp:e.onAddMaster,AddApprenticeMsg:e.onAddApprenticeNotify,ChuanGongResp:e.onRpChuanGong,AcceptChuanGongResp:e.onRpAcceptChuanGong,MasterQuestRewardResp:e.onRpMasterQuestReward,FinishApprenticeshipResp:e.onRpFinishApprenticeship,FinishApprenticeshipMsg:e.onFinishApprenticeshipNotify,MasterQuestMsg:e.onMasterQuestMsgNotify,ExtrudeApprenticeResp:e.onExtrudeApprenticeResp}},init:function(){this.spotAlert1=game.spotAlert.set(game.SAE.MASTER_APPRENTICE,game.SAE.PEACH_GARDEN),this.spotAlert=game.spotAlert.set(game.SAE.MASTER,game.SAE.MASTER_APPRENTICE),this.taskSpotAlert=game.spotAlert.set(game.SAE.MASTER_TASK,game.SAE.MASTER_APPRENTICE),this.apprenticeSpotAlert=game.spotAlert.set(game.SAE.APPRENTICE_ALERT,game.SAE.MASTER_APPRENTICE),game.mAData.initModuleOpen()},notify:function(e,t){var a=this;switch(e){case a.Evts.SWITCH_PAGE:a.send(a.Evts.SWITCH_PAGE,t);break;case a.Evts.V_POST_ASKMASTER:a.onReqApprentive();break;case a.Evts.SWITCH_APPRENTICE:a.setApprentice(t);break;case a.Evts.TAKE_APPRENTIVE:a.onReqTakeApprentive(t);break;case a.Evts.AGREE_INVITE:a.agreeInvite(t);break;case a.Evts.REPULSE_INVITE:a.repulseInvite(t);break;case a.Evts.V_POST_CHUANGONG:a.repChuangong();break;case a.Evts.POST_CHUANGONG:a.repApprenticeChuangong(t);break;case a.Evts.INIT_MASTER_DATA:a.onReqMasterData();break;case a.Evts.COMPLETE_TASK:a.completeTask(t);break;case a.Evts.V2C_CHUSHI:a.sendChushi(t)}},onExtrudeApprenticeResp:function(e){var t=e.readProtobuf(game.pb.ExtrudeApprenticeResponse);0<t.code?game.notice.noticeError(t.code):(game.module.hide(game.ME.ZhuChu),game.mAData.zhuChu(t),this.checkApprenticeAlert(),this.send(this.Evts.V_UPDATEAPPRENTICEVIEW))},completeTask:function(e){var t=game.MasterQuestCfg.getData(e);if(t){var a=t.condition,i=game.mAData.getQuest(e);if(i&&i.state){game.notice.show(9230)}else{if((i?i.progress:0)>=a.Param1){this.sender.MasterQuestRewardReq(e)}else if(t.moduleId){game.module.showToggle(t.moduleId,t.toggle)}else b8e.warn("\u5e08\u5f92\u4efb\u52a1\u672a\u6307\u5b9a\u8df3\u8f6c")}}else;},sendChushi:function(e){this.sender.FinishApprenticeshipReq(e)},setApprentice:function(e){game.mAData.curApprentiveType=e,this.send(this.Evts.V_UPDATEAPPRENTICEVIEW)},syncMasterData:function(e){var t=e.readProtobuf(game.pb.MasterResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setup(t),this.send(this.Evts.V_UPDATEMASTERVIEW),this.checkTaskAlert(),this.checkApprenticeAlert()},onRpApprentice:function(e){var t=e.readProtobuf(game.pb.ApprenticeResponse);if(this.lastSendTime=game.SysTime.curTime,0<t.code){game.notice.noticeError(t.code)}else game.notice.show(9231)},onRpTakeApprentice:function(e){var t=e.readProtobuf(game.pb.TakeApprenticeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(9232)},onTakeApprenticeNotify:function(e){var t=e.readProtobuf(game.pb.TakeApprenticeNotify);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setApprenticeNotify(t),this.send(this.Evts.V_UPDATEINVITEVIEW),this.checkAlert()},reqTakeApprentice:function(){},onAddMaster:function(e){var t=e.readProtobuf(game.pb.AddMasterResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setMasterData(t),game.mAData.addMasterReq(),this.checkAlert(),this.selectToggle(0),this.send(this.Evts.V_UPDATEMASTERVIEW),this.dpt(this.Evts.C_UPDATEMASTER)},onAddApprenticeNotify:function(e){var t=e.readProtobuf(game.pb.AddApprenticeNotify);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setApprenticeData(t),this.checkApprenticeAlert(),this.selectToggle(1),this.dpt(this.Evts.C_UPDATEAPPRENTICE)},onRpChuanGong:function(e){var t=e.readProtobuf(game.pb.ChuangongResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.isAcceptChuanGong=!1,game.mAData.setChuangong(t),this.checkApprenticeAlert(),game.module.show(game.ME.ChuanGong),this.send(this.Evts.V_UPDATEAPPRENTICEVIEW)},onRpFinishApprenticeship:function(e){var t=e.readProtobuf(game.pb.FinishApprenticeshipResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.masterData=null,this.send(this.Evts.V_UPDATEMASTERVIEW)},onFinishApprenticeshipNotify:function(e){var t=e.readProtobuf(game.pb.FinishApprenticeshipNotify);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setFinishApprenticeship(t),this.checkApprenticeAlert(),this.send(this.Evts.V_UPDATEAPPRENTICEVIEW)},onRpMasterQuestReward:function(e){var t=e.readProtobuf(game.pb.MasterQuestRewardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setMasterQuestInfo(t),this.checkTaskAlert(),this.send(this.Evts.V_UPDATEMASTERVIEW)},onRpAcceptChuanGong:function(e){var t=e.readProtobuf(game.pb.AcceptChuangongResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.isAcceptChuanGong=!0,game.mAData.acceptChuanGong(),game.module.show(game.ME.ChuanGong),this.checkAlert(),this.checkTaskAlert(),this.send(this.Evts.V_UPDATEMASTERVIEW)},onMasterQuestMsgNotify:function(e){var t=e.readProtobuf(game.pb.MasterQuestNotify);if(0<t.code){game.notice.noticeError(t.code)}else game.mAData.setQuestNotify(t),this.checkTaskAlert()},btn0:function(){this.selectToggle(0)},btn1:function(){this.selectToggle(1)},btn2:function(){this.selectToggle(2)},selectToggle:function(e){this.send(this.Evts.SWITCH_PAGE,e)},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.PRESTIGE_SHOP)},closeAllBtn:function(){game.module.hide(game.ME.MasterApprentice),game.module.hide(game.ME.PeachGarden)},onReqMasterData:function(){this.sender.MasterDataReq()},onReqApprentive:function(){var e=game.MarqueeLang.getData("req_master"),t=game.SysTime.curTime-this.lastSendTime;if(0==this.lastSendTime||t>1e3*e.sendCDTime){this.lastSendTime=game.SysTime.curTime,this.sender.ApprenticeReq()}else{var a=game.Lang.get(3203,e.sendCDTime);game.notice.show(a)}},onReqTakeApprentive:function(e){if(game.UpgradeUtil.checkItemInfo(305001,1))this.sender.TakeApprenticeReq(e),game.mAData.invitedRole(e),this.send(this.Evts.V_UPDATEINVITEVIEW);else;},agreeInvite:function(e){this.sender.AddMasterReq(e),game.mAData.reSetApprenticeInfo(e),this.checkAlert(),this.send(this.Evts.V_UPDATEINVITEVIEW)},repulseInvite:function(e){game.mAData.reSetApprenticeInfo(e),this.checkAlert(),this.send(this.Evts.V_UPDATEINVITEVIEW)},repChuangong:function(){this.sender.AcceptChuanGongReq()},repApprenticeChuangong:function(e){this.sender.ChuanGongReq(e)},checkAlert:function(){this.spotAlert.alert=0<game.mAData.acceptMap.count()},checkTaskAlert:function(){var e=game.mAData.getTaskAlert(),t=game.mAData.masterData&&game.mAData.masterData.chuangong;this.taskSpotAlert.alert=e||t},apprenticeByChat:function(e){if(e||e.data)this.sender.TakeApprenticeReq(e.data);else;},checkApprenticeAlert:function(){var e=game.mAData,t=!1;e.apprentice1&&!e.apprentice1.chuangong&&(t=!0),e.apprentice2&&!e.apprentice2.chuangong&&(t=!0),this.apprenticeSpotAlert.alert=t},sureBtn:function(){game.mAData.zhuChuRoleId&&this.sender.ExtrudeApprenticeReq(game.mAData.zhuChuRoleId)},notSureBtn:function(){game.module.hide(game.ME.ZhuChu)}}),t=game.Sender.extends({ipc:function(){this.msg={MasterDataReq:null,ApprenticeReq:null,TakeApprenticeReq:this.reqTakeApprentice,AddMasterReq:this.reqAddMasterReq,ChuanGongReq:this.reqChuanGong,AcceptChuanGongReq:null,MasterQuestRewardReq:this.reqMasterQuestReward,FinishApprenticeshipReq:this.reqFinishApprenticeship,ExtrudeApprenticeReq:this.extrudeApprenticeReq}},reqTakeApprentice:function(e){var t=game.pb.TakeApprenticeRequest;t.roleid=e,this.write(t)},reqAddMasterReq:function(e){var t=game.pb.AddMasterRequest;t.roleid=e,this.write(t)},reqChuanGong:function(e){var t=game.pb.ChuangongRequest;t.type=e,this.write(t)},reqMasterQuestReward:function(e){var t=game.pb.MasterQuestRewardRequest;t.id=e,this.write(t)},reqFinishApprenticeship:function(e){var t=game.pb.FinishApprenticeshipRequest;t.type=e,this.write(t)},extrudeApprenticeReq:function(e){var t=game.pb.ExtrudeApprenticeRequest;t.roleId=e,this.write(t)}}),a=[game.ME.MyMasterView,game.ME.MyApprentice,game.ME.InviteApprentice,game.ME.ChuanGong,game.ME.ZhuChu];b8e.module.registerControl(game.ME.MasterApprentice,e,game.MasterApprenticeEvts,t,a)}(),function(){var e;e=b8e.Object.extends({roleid:0,name:"",level:0,power:0,ismale:!1,online:0,addTime:0,chuangong:!1,questsMap:null,type:0,maxChushiDate:7,cfgQuestList:null,ctor:function(){this._super(),this.questsMap=b8e.HashMap.get(),this.cfgQuestList=[]},setup:function(e){var t=this;if(e){t.roleid=e.roleid,t.name=e.name,t.level=e.level,t.power=e.power,t.ismale=e.ismale,t.online=e.online,t.addTime=e.addTime,t.chuangong=e.chuangong,t.offlineDays=e.offlineDays;var a=null,i=game.MasterQuestCfg.getDatas();if(t.cfgQuestList.length<1){if(i&&i.length)for(var n=0;n<i.length;++n){(a=new game.MasterQuestInfo).id=i[n].id,this.cfgQuestList.push(a),this.questsMap.set(a.id,a)}}if(e.quests&&0<e.quests.length){if(e.quests&&0<e.quests.length)for(n=0;n<e.quests.length;++n){if(a=this.questsMap.get(e.quests[n])){a.state=!0}}}}else;},getCanChushiDate:function(){if(this.addTime)return this.maxChushiDate-(this.addTime-game.SysTime.curTime)/b8e.TimeUtil.DAY_MICRO_SECONDS|0;return this.maxChushiDate},canChushi:function(){if(!this.addTime){return!1}if(this.chushiTime)return game.SysTime.curTime>this.chushiTime;return!1},getRestChushiDayNum:function(){var e=(this.chushiTime-game.SysTime.curTime)/b8e.TimeUtil.DAY_MICRO_SECONDS;return e=0<e?e:0,e=Math.ceil(e)}}),b8e.RC("$$game","$$ApprenticeInfo",e)}(),function(){var e;e=b8e.Object.extends({__renderType:0,refresh:0,ctor:function(){this._super()},setup:function(e){if(e)this.roleId=e.roleid,this.roleName=e.name,this.level=e.level,this.__renderType=0,this.refresh++;else;},setup2:function(e,t){if(e)this.roleId=e.roleid,this.roleName=e.name,this.time=t,this.__renderType=1,this.refresh++;else;},clearData:function(){this.roleId=0,this.roleName="",this.level=0,this.time=0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$InvitedInfo",e)}(),function(){var e=b8e.Object.extends({masterData:null,cfgQuestList:null,questsMap:null,apprentice1:null,apprentice2:null,tudiInvites:null,curApprentiveType:1,invitedData:null,finishApprenticeship:!1,openLv:0,isAcceptChuanGong:!1,apprenticeship:7,ctor:function(){this._super(),this.questsMap=b8e.HashMap.get(),this.cfgQuestList=[],this.tudiInvites=[],this.invitedData=[],this.invitedPool=[],this.invitedMap=b8e.HashMap.get(),this.acceptMap=b8e.HashMap.get()},initModuleOpen:function(){var e=game.ModuleCfg.getCfgByME(game.ME.MasterApprentice);if(e){var t=e.trigger1;if(t&&0<t.length)for(var a,i=t.length,n=0;n<i;n++){if((a=t[n]).Type==game.TriggerType.Level){this.openLv=a.Value}}}else;},initExp:function(){},setup:function(e){if(e){if(e.master){this.setMasterData(e);var t=game.MasterQuestCfg.getDatas();if(t&&t.length&&0==this.cfgQuestList.length)for(var a=0;a<t.length;++a){(i=new game.MasterQuestInfo).id=t[a].id,this.cfgQuestList.push(i),this.questsMap.set(i.id,i)}}else this.masterData=null;if(e.quests&&0<e.quests.length){var i,n=null;for(a=0;a<e.quests.length;++a){if(n=e.quests[a]){if(!(i=this.questsMap.get(n.id))){i=new game.MasterQuestInfo,this.questsMap.set(n.id,i)}i.setup(n)}else;}}if(e.apprentice1){if(!this.apprentice1){this.apprentice1=new game.ApprenticeInfo}this.apprentice1.setup(e.apprentice1),this.apprentice1.type=1,this.apprentice1.chushiTime=this.getChushiTime(e.apprentice1.addTime)}else this.apprentice1=null;if(e.apprentice2){if(!this.apprentice2){this.apprentice2=new game.ApprenticeInfo}this.apprentice2.setup(e.apprentice2),this.apprentice2.type=2,this.apprentice2.chushiTime=this.getChushiTime(e.apprentice2.addTime)}else this.apprentice2=null;var s,o,r;if(e.invitelist&&0<e.invitelist.length){this.invitedMap.clear();var g=e.invitelist;s=g.length;var l=game.mainRoleData.lv-3,c=0;for(a=0;a<s;a++){if((r=g[a]).level>l||r.level<this.openLv);else{if(!this.invitedPool[c]){o=new game.InvitedInfo,this.invitedPool.push(o)}(o=this.invitedPool[c]).clearData(),o.setup(g[a]),this.invitedMap.set(o.roleId,o),c++}}}var h=this.acceptMap.values();if(h&&0<h.length){for(s=h.length,a=0;a<s;a++){o=h[a],this.invitedMap.set(o.roleId,o)}}}else;},getFilterInvitedData:function(){var e=this.invitedMap.values();return e.sort(this.onSort),e},onSort:function(e,t){if(0!=e.time&&0!=t.time){return e.time-t.time}if(0!=e.time){return-1}if(0==t.time)return e.roleId-t.roleId;return 1},getSortQuestList:function(){return this.cfgQuestList.sort(this.questSortFunc),this.cfgQuestList},questSortFunc:function(e,t){var a=e.getComplete(),i=t.getComplete();if(e.state==t.state){if(e.state)return e.id-t.id;if(a==i){return e.id-t.id}if(a){return-1}return 1}if(e.state)return 1;return-1},setApprenticeNotify:function(e){var t=e.roleid;if(!this.invitedMap.has(t)){var a=new game.InvitedInfo,i=game.SysTime.curTime;a.setup2(e,i),this.invitedMap.set(a.roleId,a),this.acceptMap.set(a.roleId,a)}},addMasterReq:function(){this.acceptMap.forEach(function(e,t){this.invitedMap.del(e)},this),this.acceptMap.clear()},reSetApprenticeInfo:function(e){this.invitedMap.del(e),this.acceptMap.del(e)},setMasterData:function(e){if(e){if(e.master){if(!this.masterData){this.masterData=new game.MasterInfo}this.masterData.setup(e.master),this.masterData.chushiTime=this.getChushiTime(e.master.addTime)}}else;},setApprenticeData:function(e){if(e)switch(e.type){case 1:if(e.apprentice){if(!this.apprentice1){this.apprentice1=new game.ApprenticeInfo}this.apprentice1.setup(e.apprentice),this.apprentice1.type=1,this.apprentice1.chushiTime=this.getChushiTime(e.apprentice.addTime)}break;case 2:if(e.apprentice){if(!this.apprentice2){this.apprentice2=new game.ApprenticeInfo}this.apprentice2.setup(e.apprentice),this.apprentice2.type=2,this.apprentice2.chushiTime=this.getChushiTime(e.apprentice.addTime)}}else;},getChushiTime:function(e){if(!this.apprenticeship){var t=game.MasterMiscCfg.getData("apprenticeship");if(t){this.apprenticeship=0|t.value}}return b8e.TimeUtil.getTodayTime(e)+this.apprenticeship*b8e.TimeUtil.DAY_MICRO_SECONDS},setChuangong:function(e){if(e)switch(e.type){case 1:if(this.apprentice1){this.apprentice1.chuangong=!0}break;case 2:if(this.apprentice2){this.apprentice2.chuangong=!0}}else;},isHasMaster:function(){return!!this.masterData},getCurApprenticeData:function(){switch(this.curApprentiveType){case 1:return this.apprentice1;case 2:return this.apprentice2}},setInvitedData:function(){},invitedRole:function(e){this.invitedMap.del(e)},setFinishApprenticeship:function(e){if(e)if(this.apprentice1&&this.apprentice1.roleid==e.roleid){this.apprentice1=null}else if(this.apprentice2&&this.apprentice2.roleid==e.roleid){this.apprentice2=null}else;else;},zhuChu:function(e){e&&(this.apprentice1&&this.apprentice1.roleid==e.roleId?this.apprentice1=null:this.apprentice2&&this.apprentice2.roleid==e.roleId&&(this.apprentice2=null))},acceptChuanGong:function(){if(this.masterData){this.masterData.chuangong=!1}},setQuestNotify:function(e){if(e){var t=this.questsMap.get(e.id);if(!t){t=new game.MasterQuestInfo,this.questsMap.set(t.id,t)}t.id=e.id,t.progress=e.progress}else;},setMasterQuestInfo:function(e){if(e){var t=this.questsMap.get(e.id);if(t){t.state=!0}}else;},getChuanGongMasterExp:function(){},getExpByType:function(e){var t=0;if(e==game.MasterExpType.ChuanGongMaster){t=this.masterData.level}else t=game.mainRoleData.lv;var a=game.MasterExpCfg.getCfgData(e,t);if(!a){b8e.error("\u5e08\u5f92\u7ecf\u9a8c\u4e0d\u5b58\u5728type\uff1a",e,"lv: ",t)}return a.p1*t*t+a.p2*t+a.p3},getQuest:function(e){return this.questsMap.get(e)},getTaskAlert:function(){var e=this;if(!e.masterData){return!1}if(e.masterData.getRestChushiDayNum()<=0){return!1}for(var t=null,a=game.MasterQuestCfg.getDatas(),i=a.length,n=null,s=null,o=0;o<i;o++){if(t=a[o],n=e.questsMap.get(t.id),s=t.condition,n&&!n.state&&n.progress>=s.Param1){return!0}}return!1}});game.mAData=game.mAData||new e}(),function(){var e;e=b8e.Enum({None:0,ChuanGongMaster:1,ChuanGongTuDi:2,TaskTuDi:3,ChuShiTuDi:4}),b8e.RC("$$game","$$MasterExpType",e)}(),function(){var e;e=b8e.Object.extends({roleid:0,name:"",level:0,power:0,ismale:!1,online:0,addTime:0,chuangong:!1,maxChushiDate:7,ctor:function(){this._super()},setup:function(e){if(e)this.roleid=e.roleid,this.name=e.name,this.level=e.level,this.power=e.power,this.ismale=e.ismale,this.online=e.online,this.addTime=e.addTime,this.chuangong=e.chuangong;else;},getCanChushiDate:function(){if(this.addTime)return this.maxChushiDate-(this.addTime-game.SysTime.curTime)/b8e.TimeUtil.DAY_MICRO_SECONDS|0;return this.maxChushiDate},getRestChushiDayNum:function(){var e=(this.chushiTime-game.SysTime.curTime)/b8e.TimeUtil.DAY_MICRO_SECONDS;return e=Math.ceil(e)}}),b8e.RC("$$game","$$MasterInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,progress:0,state:!1,ctor:function(){this._super()},setup:function(e){if(e)this.id=e.id,this.progress=e.progress,this.state=e.state;else;},getComplete:function(){var e=game.MasterQuestCfg.getData(this.id);if(e&&e.condition)return this.progress>=e.condition.Param1;return!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$MasterQuestInfo",e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(673),this.setSize(624,145)},init:function(){this.headIcon=b8e.Sprite.get(),this.headIcon.setAnchor(.5,.5),this.headIcon.addToParent(this.skin.iconnode),this.headIcon.loadTexture(game.ResCfg.getUrl(10033)),this.outDays=3;var e=game.MasterMiscCfg.getData("offlineDays");e&&e.value&&(this.outDays=e.value)},onShow:function(){this.setData(this._data)},setData:function(e){if(this._data=e,this.skin&&e){var t=this.skin,a=(game.SysTime.curTime,(game.SysTime.curTime-e.offlineDays)/b8e.TimeUtil.DAY_MICRO_SECONDS>=this.outDays),i=!e.online;switch(t.zhuChu.active=i&&a,t.shifuName.string=e.name,t.level.string=e.level+"",t.isOnline.string=e.online?game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9233)):game.HtmlUtil.getText(game.Color.RED,game.Lang.get(9234)),t.expnum.string="",e.type){case 1:t.tudi_1.string=game.Lang.get(9235);break;case 2:t.tudi_1.string=game.Lang.get(9236)}if(0<e.getRestChushiDayNum()){t.expnum.node.active=e.chuangong,t.chushitimeIcon.node.active=e.chuangong,t.canChushi.node.active=!1,t.viewchanggong.node.active=!e.chuangong,t.expnum.string=game.Lang.get(9531,e.getRestChushiDayNum())}else t.expnum.node.active=!1,t.chushitimeIcon.node.active=!1,t.canChushi.node.active=!0,t.viewchanggong.node.active=!1;var n=game.ResCfg.getHead(e.ismale);this.headIcon.loadTexture(n)}else;},viewchanggong:function(){this.send(game.MasterApprenticeEvts.POST_CHUANGONG,this._data.type)},zhuChu:function(){game.mAData.zhuChuRoleId=this._data.roleid,game.module.show(game.ME.ZhuChu)}}),b8e.RC("$$game","$$ApprenticeItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(674),this.setSize(600,107)},init:function(){this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Vertical),this.list.itemRender=game.ShowItemListItem,this.list.layout.paddingLeft=0,this.list.layout.paddingRight=0,this.list.layout.paddingTop=0,this.list.layout.spacingX=0,this.list.addToParent(this.skin.prizeNode)},setData:function(){var e=this.skin,t=game.MasterQuestCfg.getData(this.data.id);if(t){if(e.taskName.string=t.desc,t.condition){var a=game.HtmlUtil.IsEnoughGOR(this.data.state),i=this.data.state?game.Lang.get(9237):game.Lang.get(9211);e.isfinish.string=game.HtmlUtil.getText(a,i)}var n=game.CfgUtil.getPrizeListInfo(t.rewards2,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);if(n){this.list.setData(n.items)}}}}),b8e.RC("$$game","$$ApprenticeTaskItem",e)}(),function(){var e=game.View.extends({_showModel:!0,progress:0,maprogress:100,maxWidth:476,ctor:function(){this._super(675)},toggleSelect:function(e){this._super(e)},init:function(){var e=this.leftRoleData=game.BaseRoleData.get(game.RoleType.Hero,1);(this.leftModel=game.sceneRoleCreate.createUIRole(e)).addToParent(this.skin.roleIcon_1);var t=this.rightRoleData=game.BaseRoleData.get(game.RoleType.Hero,1);(this.rightModel=game.sceneRoleCreate.createUIRole(t)).addToParent(this.skin.roleIcon_0)},onShow:function(){if(this.progress=0,this.updateModel(),this.skin.bar_0.node.width=this.progress/this.maprogress*this.maxWidth,this.timer)this.timer.reset(),this.timer.start();else{this.timer=b8e.Timer.add(this,this.updateTimer,50)}},updateTimer:function(){if(++this.progress,++this.progress<=this.maprogress){this.skin.progress.string=this.progress+"%",this.skin.bar_0.node.width=this.progress/this.maprogress*this.maxWidth}else if(game.module.hide(game.ME.ChuanGong),this.timer){this.timer.stop()}},onHide:function(){if(this.timer){this.timer.stop()}},updateView:function(){},updateModel:function(){var e,t,a;game.mAData.isAcceptChuanGong;if(t=(e=game.mAData.masterData,game.mAData.getCurApprenticeData()),e){var i=this.leftRoleData;if(i.setMale(e.ismale),(a=i.heroModel).clear(),a.setBody(game.RoleType.Hero,i.isMale?1001:1002),game.AvatarUtil.updateBody(this.leftModel,!0),t){var n=this.rightRoleData;n.setMale(t.ismale),(a=n.heroModel).clear(),a.setBody(game.RoleType.Hero,n.isMale?1001:1002),game.AvatarUtil.updateBody(this.rightModel,!0)}}},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.ChuanGong,e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(676),this.setSize(306,226)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.list.itemRender=game.PrizeListItem,e.list.layout.paddingLeft=0,e.list.layout.paddingRight=0,e.list.layout.paddingTop=0,e.list.layout.spacingX=15,e.list.addToParent(e.skin.prizeNode),e.masterRewards1=game.MasterMiscCfg.getAwards("masterRewards1").rewards,e.masterRewards2=game.MasterMiscCfg.getAwards("masterRewards2").rewards},onShow:function(){this.setData(this.type)},setData:function(e){if(this.type=e,this.skin&&e){var t=this.skin,a=null;switch(this.type){case 1:t.chushiName.string=game.Lang.get(9238),a=this.masterRewards1;break;case 2:this.skin.chushiName.string=game.Lang.get(9239),a=this.masterRewards2}var i=game.CfgUtil.getPrizeListInfo(a);if(i){this.list.setData(i.items)}}else;}}),b8e.RC("$$game","$$ChushiItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(677),this.setSize(600,106)},init:function(){},setData:function(){var e=this.skin;e.inviteTips.string=game.HtmlUtil.getulText(this.data.roleName),e.level.string=this.data.level+""},viewInviteBtn:function(){this.send(game.MasterApprenticeEvts.TAKE_APPRENTIVE,this.data.roleId)},inviteTips:function(){this.dptG(game.ChatEvts.SHOW_PLAYER,this.data.roleId)}}),b8e.RC("$$game","$$InviteApprenticeItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(672),this.setSize(600,107)},init:function(){},setData:function(){var e=this.skin,t=this.data;e.inviteTips.string=game.Lang.get(3201,t.roleName)},viewagreeBtn:function(){this.send(game.MasterApprenticeEvts.AGREE_INVITE,this.data.roleId)},viewrepulse:function(){this.send(game.MasterApprenticeEvts.REPULSE_INVITE,this.data.roleId)},inviteTips:function(){this.dptG(game.ChatEvts.SHOW_PLAYER,this.data.roleId)}}),b8e.RC("$$game","$$AcceptApprenticeItem",e)}(),function(){var e=game.View.extends({posY:80,minHeight:465,maxHeight:520,ctor:function(){this._super(678)},init:function(){this.list=new game.List,this.list.itemRender=[game.InviteApprenticeItem,game.AcceptApprenticeItem],this.list.bindEnum=game.ME.MasterApprentice,this.list.layout.paddingLeft=0,this.list.layout.paddingRight=0,this.list.layout.paddingTop=0,this.list.layout.spacingX=0,this.list.addToParent(this.skin.taskNode)},notify:function(e){switch(e){case this.Evts.V_UPDATEINVITEVIEW:this.updateView()}},onShow:function(){this.send(this.Evts.INIT_MASTER_DATA),this.updateView()},onHide:function(){},updateView:function(){this.skin;var e=game.mAData.getFilterInvitedData();this.list.setData(e)},viewagreeBtn:function(){var e=game.mAData.tudiInvites[0];if(e){this.send(this.Evts.AGREE_INVITE,e.roleid)}},viewrepulse:function(){this.send(this.Evts.REPULSE_INVITE)},onStageResize:function(){this.setPosition(0,-390)}});b8e.module.registerView(game.ME.InviteApprentice,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(679),this.toggles={togle_0:game.ME.MyMasterView,togle_1:game.ME.MyApprentice,togle_2:game.ME.InviteApprentice},this.spotAlerts={MASTER:this.masterAlert,MASTER_TASK:this.masterTaskAlert,APPRENTICE_ALERT:this.apprenticeAlert}},masterTaskAlert:function(e){this.skin.red_spot_task.node.active=e.alert},masterAlert:function(e){this.skin.red_spot.node.active=e.alert},apprenticeAlert:function(e){this.skin.red_spot_2.node.active=e.alert},notify:function(e,t){switch(e){case this.Evts.V_UPDATEMAVIEW:this.updateView();break;case this.Evts.SWITCH_PAGE:this.toggleSelect(t)}},toggleSelect:function(e){this._super(e)},init:function(){},onShow:function(){},onHide:function(){},updateView:function(){},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.MasterApprentice,e)}(),function(){var e;e=game.Widget.extends({type:1,finishApprenticeshipCost:0,masterRewards1:null,masterRewards2:null,ctor:function(){this._super(680),this.setSize(305,440)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.list.itemRender=game.PrizeListItem,e.list.layout.paddingLeft=0,e.list.layout.paddingRight=0,e.list.layout.paddingTop=0,e.list.layout.spacingX=15,e.list.addToParent(e.skin.prizeNode),e.finishApprenticeshipCost=0|game.MasterMiscCfg.getData("finishApprenticeshipCost").value,e.masterRewards1=game.MasterMiscCfg.getAwards("masterRewards1").rewards,e.masterRewards2=game.MasterMiscCfg.getAwards("masterRewards2").rewards,e.bindEnum=game.ME.MasterApprentice},onShow:function(){this.setData(this.type)},setData:function(e){if(this.type=e,this.skin&&e){var t=this.skin,a=null;switch(this.type){case 1:t.chushiName.string=game.Lang.get(9238),t.goldBg.node.active=!0,t.freeTitle.node.active=!1,t.costNum.string=this.finishApprenticeshipCost,a=this.masterRewards1,t.putongIcon.active=!1,t.wanmeiIcon.active=!0;break;case 2:this.skin.chushiName.string=game.Lang.get(9239),t.goldBg.node.active=!1,t.freeTitle.node.active=!0,a=this.masterRewards2,t.putongIcon.active=!0,t.wanmeiIcon.active=!1}var i=game.CfgUtil.getPrizeListInfo(a);if(i){this.list.setData(i.items)}}else;},putongIcon:function(){this.send(game.MasterApprenticeEvts.V2C_CHUSHI,this.type)},wanmeiIcon:function(){if(1==this.type){if(!game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,this.finishApprenticeshipCost)){return}}this.send(game.MasterApprenticeEvts.V2C_CHUSHI,this.type)}}),b8e.RC("$$game","$$MasterChushiItem",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,_prizeInfo:null,_finish:!1,expItem:null,ctor:function(){this._super(681),this.setSize(600,106)},init:function(){this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Vertical),this.prizeList.itemRender=game.ShowItemListItem,this.prizeList.layout.paddingLeft=0,this.prizeList.layout.paddingRight=0,this.prizeList.layout.paddingTop=0,this.prizeList.layout.spacingX=0,this.prizeList.addToParent(this.skin.prizeNode),this.expItem={Id:220001,Num:0}},setData:function(){var e=this.skin;e.title_1.node.active=!1,e.title_2.node.active=!1,e.gotoIcon.node.active=!1,e.getPrizeIcon.node.active=!1,e.geted_0.node.active=!1;var t=game.MasterQuestCfg.getData(this.data.id);if(t){this.expItem.Num=game.mAData.getExpByType(game.MasterExpType.TaskTuDi);var a=game.CfgUtil.getPrizeListInfo([this.expItem],game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);if(a){this.prizeList.setData(a.items)}e.taskName.string=t.desc;var i=t.condition,n=game.mAData.getQuest(this.data.id);if(i){var s=n?n.progress:0;if(e.num.string=s+"/"+i.Param1,n&&n.state){e.geted_0.node.active=!0}else e.getPrizeIcon.node.active=s>=i.Param1,e.title_1.node.active=s>=i.Param1,e.title_2.node.active=s<i.Param1,e.gotoIcon.node.active=s<i.Param1}}},viewgetPrizeBtn:function(){this.send(game.MasterApprenticeEvts.COMPLETE_TASK,this.data.id)}}),b8e.RC("$$game","$$MasterTaskItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(682)},notify:function(e){switch(e){case this.Evts.V_UPDATEAPPRENTICEVIEW:this.updateView()}},init:function(){var e=this,t=e.skin,a=e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);a.itemRender=game.ApprenticeTaskItem,a.bindEnum=game.ME.MasterApprentice,a.layout.paddingLeft=0,a.layout.paddingRight=0,a.layout.paddingTop=0,a.layout.spacingX=0,a.addToParent(t.taskNode);var i=e.apprenticeItem1=new game.ApprenticeItem;i.bindEnum=game.ME.MasterApprentice,i.addToParent(t.apprenticeNode_0);var n=e.apprenticeItem2=new game.ApprenticeItem;n.bindEnum=game.ME.MasterApprentice,n.addToParent(t.apprenticeNode_1);var s=e.chushiItem1=new game.ChushiItem;s.setData(1),s.addToParent(t.chushiItemNode_1);var o=e.chushiItem2=new game.ChushiItem;o.setData(2),o.addToParent(t.chushiItemNode_2)},onShow:function(){this.updateView()},onHide:function(){},updateView:function(){var e=this,t=e.skin;if(e.apprenticeItem1.setVisible(!1),e.apprenticeItem2.setVisible(!1),e.chushiItem1.setVisible(!1),e.chushiItem2.setVisible(!1),game.mAData.apprentice1){e.apprenticeItem1.setVisible(!0),e.apprenticeItem1.setData(game.mAData.apprentice1),t.viewTips1.node.active=!1}else t.viewTips1.node.active=!0;if(game.mAData.apprentice2){e.apprenticeItem2.setVisible(!0),e.apprenticeItem2.setData(game.mAData.apprentice2),t.viewTips2.node.active=!1}else t.viewTips2.node.active=!0;var a=game.mAData.getCurApprenticeData();if(a){t.tips_2.node.active=!1,t.chushiItemNode_1.active=!0,t.chushiItemNode_2.active=!0;var i=a.canChushi();if(t.hasappretice.active=!i,i){e.chushiItem1.setVisible(!0),e.chushiItem2.setVisible(!0)}else{var n=a.cfgQuestList;e.list.setData(n)}}else t.chushiItemNode_1.active=!1,t.chushiItemNode_2.active=!1,t.tips_2.node.active=!0,t.hasappretice.active=!1,e.list.setData(null);e.updateBtnView()},viewTips1:function(){this.send(this.Evts.SWITCH_PAGE,2)},viewTips2:function(){this.send(this.Evts.SWITCH_PAGE,2)},viewbtn0:function(){this.send(this.Evts.SWITCH_APPRENTICE,1)},viewbtn1:function(){this.send(this.Evts.SWITCH_APPRENTICE,2)},updateBtnView:function(){this.skin.togle_0.node.active=1==game.mAData.curApprentiveType,this.skin.togle_1.node.active=2==game.mAData.curApprentiveType},onStageResize:function(){this.setPosition(0,-0)}});b8e.module.registerView(game.ME.MyApprentice,e)}(),function(){var e=game.View.extends({chushiItem1:null,chushiItem2:null,ctor:function(){this._super(683)},notify:function(e){switch(e){case this.Evts.V_UPDATEMASTERVIEW:this.updateView()}},init:function(){var e=this,t=e.skin,a=e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);a.itemRender=game.MasterTaskItem,a.bindEnum=game.ME.MasterApprentice,a.layout.paddingLeft=5,a.layout.spacingY=5,a.addToParent(t.prizeNode);var i=e.headIcon=b8e.Sprite.get();if(i.setAnchor(.5,.5),i.addToParent(t.iconNode),i.loadTexture(game.ResCfg.getUrl(10033)),!e.chushiItem1){var n=e.chushiItem1=new game.MasterChushiItem;n.setData(1),n.addToParent(t.chushiItemNode_0)}if(!e.chushiItem2){var s=e.chushiItem2=new game.MasterChushiItem;s.setData(2),s.addToParent(t.chushiItemNode_1)}},onShow:function(){this.send(this.Evts.INIT_MASTER_DATA),this.updateView()},onHide:function(){},updateView:function(){var e=this.skin,t=game.mAData.masterData;if(this.chushiItem1.setVisible(!1),this.chushiItem2.setVisible(!1),t){e.askmasterviewBtn.active=!1,e.askmasterviewBg.active=!1,e.bg_0.node.active=!0,e.shifuName.string=t.name,e.level.string=t.level+"",e.isOnline.string=t.online?game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9233)):game.HtmlUtil.getText(game.Color.RED,game.Lang.get(9234));var a=game.mAData.getExpByType(game.MasterExpType.ChuanGongTuDi);e.expnum.string=game.CCommonUtil.replaceNum(a),0<t.getRestChushiDayNum()?(e.chuangongNode.active=!0,e.expnum.node.active=t.chuangong,e.expBg_0.node.active=t.chuangong,e.viewchanggong.node.active=t.chuangong,e.chushiData.node.active=!t.chuangong,t.chuangong||(e.chushiData.string=game.Lang.get(9531,t.getRestChushiDayNum())),e.chushitimeIcon.node.active=!t.chuangong,e.canChushi.node.active=!1,e.taskNode.active=!0):(this.chushiItem1.setVisible(!0),this.chushiItem2.setVisible(!0),e.chuangongNode.active=!1,e.canChushi.node.active=!0,e.chushiData.node.active=!1,e.taskNode.active=!1);var i=game.mAData.getSortQuestList();this.list.setData(i);var n=game.ResCfg.getHead(t.ismale);this.headIcon.loadTexture(n)}else e.bg_0.node.active=!1,e.askmasterviewBtn.active=!0,e.askmasterviewBg.active=!0},askmasterviewBtn:function(){this.send(this.Evts.V_POST_ASKMASTER)},viewchanggong:function(){this.send(this.Evts.V_POST_CHUANGONG)},onStageResize:function(){this.setPosition(0,-379)}});b8e.module.registerView(game.ME.MyMasterView,e)}(),function(){var e;e=b8e.Enum({None:0,PreConfigChange:-1,ModuleOpen:-1,C_SHOWNEXTMODULEOPEN:-1,V2C_SHOWNEXTMODULEOPEN:-1,C2V_SHOWNEXTMODULEOPEN:-1,BIND_FLY_BOTTOM_BTN_POS:-1,C2V_PLAY_FLY_BOTTOM_BTN_ANI:-1,C2V_BEGINPLAYANI:-1,BIND_FLY_TASK_BTN_POS:-1}),b8e.RC("$$game","$$ModuleOpenEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.waitShowModule=[]},ipc:function(){var e=this;e.evts={MainRole:{C_INIT_MAIN_ROLE:e.checkShowPreModule,C_LEVEL_UP:e.checkShowPreModule,C_RESET_DAILY:e.checkShowPreModule},FosterHandel:{C_FOSTERHUANHUARESPONSE:e.checkShowPreModule},ModulePre:{C2C_ON_GET_REWARD:e.checkShowPreModule},MainUIBottom:{C_BEGINPLAYANI:e.playAni},Task:{C_BEGINPLAYANI:e.playAni},MainCenter:{C_BEGINPLAYANI:e.playAni},ModuleOpenFlyBtn:{C_SHOWNEXTMODULEOPEN:e.onFlyBtnAniEnd},InstanceSuccess:{V_SHOW_INS_SUCCESS:this.playStop},ArenaFinish:{V_SHOW_INS_SUCCESS:this.playStop},RoleLvUp:{ON_VIEW_HIDE:e._showNextModuleOpen}},this.gevts={TriggerEvts:{C_TRIGGER_OPEN:this.moduleOpen},RoleLvUpEvts:{G_SHOW_POPUP:this.showModuleOpen}},e.sender=new game.TriggerSender},notify:function(e,t){switch(e){case this.Evts.BIND_FLY_BOTTOM_BTN_POS:this.dpt(this.Evts.BIND_FLY_BOTTOM_BTN_POS,t);break;case this.Evts.V2C_SHOWNEXTMODULEOPEN:this._showNextModuleOpen();break;case this.Evts.BIND_FLY_TASK_BTN_POS:this.dpt(this.Evts.BIND_FLY_TASK_BTN_POS)}},onFlyBtnAniEnd:function(){this.send(this.Evts.C2V_SHOWNEXTMODULEOPEN)},playAni:function(){this.send(this.Evts.C2V_BEGINPLAYANI)},moduleOpen:function(e){var t=this.waitShowModule,a=e.data,i=game.ModuleCfg.getData(a);if(i&&i.showOpenView){var n=game.ModuleCfg.getCfgByME(a);if(n){if(0<game.triggerData.getTimes(n.id));else if(!game.moduleOpenData.isOpen(a)&&t.indexOf(a)){t.push(a)}}else;}else;},_showNextModuleOpen:function(){var e=this;if(!b8e.module.isShowView(game.ME.ModuleOpen))if(game.moduleDelay.checkDelayModule(game.ME.ModuleOpen)){var t=e.waitShowModule;if(0<t.length){game.gamePopupMgr.show(game.ME.ModuleOpen),e.wait=t.shift();var a=game.ModuleCfg.getCfgByME(e.wait);if(a&&(e.saveTrigger(a.id,1),e.send(e.Evts.ModuleOpen,e.wait)),a.showOpenViewBtn)return void(e.timer&&e.timer.stop());e.cdTime=5,e.send(e.Evts.C2V_UPDATE_TIME,e.cdTime),e.timer?(e.timer.reset(),e.timer.start()):e.timer=b8e.Timer.add(e,e.updateCdTime,1e3)}}else game.moduleDelay.setDelayCall(game.ME.ModuleOpen,e._showNextModuleOpen,e)},updateCdTime:function(){if(this.cdTime-=1,this.cdTime<=0)return this.timer.stop(),void this.send(this.Evts.C2V_PLAY_FLY_BOTTOM_BTN_ANI);this.send(this.Evts.C2V_UPDATE_TIME,this.cdTime)},checkShowPreModule:function(){var e=this;if(e.preCfg=game.moduleOpenData.getNextPreCfg()){if(b8e.module.isShowView(game.ME.MainUIModulePre)){game.module.showTab(game.ME.MainModulePre,game.ME.MainUIModulePre)}e.send(this.Evts.PreConfigChange)}else game.module.hide(game.ME.MainModulePre)},showPre:function(){game.module.show(game.ME.ModulePreList)},sureBtn:function(){game.module.hide(game.ME.ModulePre)},saveTrigger:function(e,t){game.triggerData.saveTimes(e,t),this.sender.SaveClientTriggerReq(e,t)},playStop:function(){0<this.waitShowModule.length&&(this._showNextModuleOpen(),game.gamePopupMgr.show(game.ME.ModuleOpen))},showModuleOpen:function(e){e.data==game.ME.ModuleOpen&&(game.gamePopupMgr.currShowModule=0)<this.waitShowModule.length&&this._showNextModuleOpen()},cancelBtn:function(){this.send(this.Evts.C2V_PLAY_FLY_BOTTOM_BTN_ANI)},gotoBtn:function(){var e=game.ModuleCfg.getData(this.wait);e&&(game.module.hide(this.moduleEnum),game.module.showToggle(e.preJumpId,e.preJumpToggleIndex),b8e.hasTimeout(this.hideModuleOpen,this)||b8e.setTimeout(this.hideModuleOpen,this,1e3))},hideModuleOpen:function(){this._showNextModuleOpen()}}),t=[game.ME.MainUIModulePre,game.ME.MainModulePre,game.ME.ModuleOpen];b8e.module.registerControl(game.ME.ModuleOpen,e,game.ModuleOpenEvts,null,t)}(),function(){var e=game.Control.extends({notify:function(e){switch(e){case this.Evts.V2C_SHOWNEXTMODULEOPEN:this.dpt(this.Evts.C_SHOWNEXTMODULEOPEN)}}});b8e.module.registerControl(game.ME.ModuleOpenFlyBtn,e,game.ModuleOpenEvts)}(),function(){var e=void 0;e=b8e.Object.extends({id:0,config:null,descId:0,ctor:function(){},setData:function(e){this.id=e,this.config=game.ModuleCfg.getData(e),this.config&&(this.descId=this.config.preDescId)}}),b8e.BindingUtil.bind(e),e.poolCall=!0,b8e.RC("$$game","$$ModulePreListInfo",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this.collectedAwards=[],this.allPreModuleIds=[],this.moduleOpenPreList=[],this.nextGetRewardPre=null,this.preCdTime=5,this.bindFlyAnimBtnPos=null},getConditionDescByModuleId:function(e){var t="",a=game.ModuleCfg.getCfgByME(e);if(!a)return t;var i=game.miscData.openServerDay;return t=0<a.openSeverDay&&i<a.openSeverDay?game.Lang.get(51208,a.openSeverDay):game.Lang.get(51209,a.preLv)},setup:function(e){var t=this.getIdsStr();if(t&&!(t.length<1)){this.collectedAwards=e.collectedTriggerAwards||[];for(var a=void(this.moduleOpenPreList.length=0),i=void 0,n=t.length,s=0;s<n;s++)a=+t[s],this.allPreModuleIds.push(a),-1==this.collectedAwards.indexOf(a)&&((i=new game.ModulePreListInfo).setData(a),this.moduleOpenPreList.push(i));this.moduleOpenPreList.sort(this._preItemSortConfigs)}},getIdsStr:function(){if(this._idsStr)return this._idsStr;var e=game.ModuleMiscCfg.getData("ModuleOpenPreId");return e&&e.value?(this._idsStr=e.value.split(","),this._idsStr):null},_preItemSortConfigs:function(e,t){var a=e.config,i=t.config;if(!a||!i)return e.id-t.id;var n=game.miscData.openServerDay,s=a.openSeverDay!=i.openSeverDay&&a.openSeverDay<=n&&i.openSeverDay<=n;return a.openSeverDay==i.openSeverDay||s?a.preLv-i.preLv:a.openSeverDay-i.openSeverDay},updateCollectedAward:function(e){this.collectedAwards.push(e);for(var t=[],a=void 0,i=this.moduleOpenPreList.length,n=0;n<i;n++)(a=this.moduleOpenPreList[n]).id!=e&&t.push(a);this.moduleOpenPreList=t},checkAllPreAlert:function(){for(var e=void 0,t=this.moduleOpenPreList.length,a=0;a<t;a++)if(e=this.moduleOpenPreList[a],this.getIsCanGetRewardById(e.id))return!0;return!1},getIsCanGetRewardById:function(e){var t=game.ModuleCfg.getCfgByME(e);return!!t&&(game.miscData.openServerDay>=t.openSeverDay&&game.mainRoleData.lv>=t.preLv)},getNextPreCfg:function(){var e=this;if(e.collectedAwards.length>=e.allPreModuleIds.length)return e.preCfg=null,e.preCfg;var t=e.getOpenWhetherList();if(!t||0==t.length)return e.preCfg=null,e.preCfg;for(var a=void 0,i=t.length,n=0;n<i;n++)if((a=t[n])&&-1==e.collectedAwards.indexOf(a.moduleId))return e.preCfg=a,e.preCfg;return e.preCfg=null,e.preCfg},getOpenWhetherList:function(){if(this._openWhetherList)return this._openWhetherList;var e=game.ModuleCfg.getDatas();if(!e||e.length<1)return null;this._openWhetherList=[];for(var t=0,a=e.length,i=void 0;t<a;t++)(i=e[t])&&i.openWhether&&this._openWhetherList.push(i);return this._openWhetherList&&1<this._openWhetherList.length&&this._openWhetherList.sort(this._sortConfigs),this._openWhetherList},_sortConfigs:function(e,t){var a=game.miscData.openServerDay,i=e.openSeverDay!=t.openSeverDay&&e.openSeverDay<=a&&t.openSeverDay<=a;return e.openSeverDay==t.openSeverDay||i?e.preLv-t.preLv:e.openSeverDay-t.openSeverDay},getPreCfg:function(){return this.preCfg},isOpen:function(e){if(!e)return!1;var t=game.WuShengPosActivateCfg.getDatas();if(!t)return!1;for(var a=t.length,i=void 0,n=0;n<a;n++)if((i=t[n])&&i.moduleId==e)return!0;return!1}});game.moduleOpenData=game.moduleOpenData||new e}(),function(){var e=b8e.Object.extends({info:null,ctor:function(){this.info={}},setInfo:function(e,t){this.info.me=e,this.info.pos=t},getInfo:function(){return this.info}});game.moduleOpenFlyAniData=game.moduleOpenFlyAniData||new e}(),function(){var e;e=b8e.BaseDisplay.extends({ctor:function(){this._super()},initModel:function(e){var t=0<arguments.length&&void 0!==e?e:game.RoleType.Hero;if(!this.role){var a=this.roleData=game.BaseRoleData.get(t,1);this.role=game.BaseRole.get(a.type,a.id),this.role.data=a,this.role.setTouchable(!1),this.addChild(this.role)}this.role.clearAnim()},showSurface:function(e){this.initModel();var t=this.roleData,a=t.heroModel,i=game.mainRoleData,n=i.heroModel,s=game.RoleType;a.clear(),a.type=e.roleType,a.setMale(i.isMale);game.AnimType;switch(e.roleType){case s.Hero:t.heroModel.setAnims(n.copyAnim());break;case s.Partner:a.body=n.getModel(game.RoleType.Partner)}this.role.setPosition(0,0);var o=e.moduleId,r=game.ME;o!=r.PeachGarden&&o!=r.MasterApprentice&&o!=r.GuildRecommend||this.role.setPosition(-36,60),0==e.bodyId?a.body=null:-1!=e.bodyId&&(a.body=e.bodyId),a.setSurface(e),e.roleType!=s.Hero||a.getAnim(game.AnimType.MOUNT)||a.surfaceMount||(n.surfaceMount?a.surfaceMount=n.surfaceMount:this.setDefaultMount()),this._updateAvatar(e.roleType)},setDefaultMount:function(){var e=game.surfaceData.getDefaultMountCfg();e&&this.roleData&&(this.roleData.heroModel.surfaceMount=e.model,this.roleData.heroModel.surfaceMountHead=e.mountHead,this.roleData.heroModel.uiMountOffsetY=e.UIMountOffsetY)},showJSONSurface:function(e){if(e){var t=JSON.parse(e),a={roleType:b8e.getFPV(t,"roleType")||game.RoleType.None,fashion:b8e.getFPV(t,"fashion")||"",weapon:b8e.getFPV(t,"weapon")||"",nickName:b8e.getFPV(t,"nickName")||"",pet:b8e.getFPV(t,"pet")||"",monster:b8e.getFPV(t,"monster")||""};this.showRoleSurface(a)}},showRoleSurface:function(e){this.initModel();var t=this.roleData.heroModel;t.clear(),this.role.setPosition(0,0);var a=game.RoleType;switch(t.type=e.roleType,e.roleType){case a.Hero:this._setHeroModel(e);break;case a.Pet:t.body=e.body=e.pet;break;case a.Monster:t.body=e.monster}this._updateAvatar(e.roleType,!0)},_setHeroModel:function(e){var t=game.AvatarUtil,a=this.roleData.heroModel,i=game.mainRoleData.heroModel;a.body=i.body,a.setMale(i.isMale),e.fashion?a.setFashion(e.fashion):a.fashion=i.fashion;var n=game.AnimType;if(e.weapon){var s=game.SuitSkinCfg.getData(e.weapon);if(s){var o=void 0;(o=a.isMale?t.getUIModel(s):t.getUIModel(s,t.MT_1))&&a.setAnim(n.WEAPON,o)}}else this._setAnim(n.WEAPON);e.nickName?a.setAnim(n.NICK_NAME,e.nickName):this._setAnim(n.NICK_NAME)},_updateAvatar:function(e,t){var a=this.role,i=game.AvatarUtil;switch(e){case game.RoleType.Hero:i.updateUIModel(a,1,!0);break;case game.RoleType.Partner:default:i.updateBody(a)}a.addHeadBar(),a.updateName()}}),b8e.RC("$$game","$$SurfaceModel",e)}(),function(){var e=game.View.extends({ctor:function(){this._super("moduleOpen/ModuleOpenFlyAniBtn")},updateModel:function(e){this.surfaceModel||(this.surfaceModel=new game.SurfaceModel,this.surfaceModel.addToParent(this.skin.model));var t=game.ModuleCfg.getData(e);if(t){var a=t.moduleOpenScale;this.surfaceModel.setScale(a||1,a||1);var i=t.moduleOpenPos;if(i){var n=i.split("|"),s=0<n.length?+n[0]:0,o=1<n.length?+n[1]:0;this.surfaceModel.setPosition(s,o)}else this.surfaceModel.setPosition(0,0);this.surfaceModel.showSurface(t)}else this.onPlayAniEnd()},onShow:function(){var e=game.moduleOpenFlyAniData.getInfo();if(e){this.setScale(1,1);var t=e.me;this.updateModel(t);var a=e.pos;this.onPlayAniBegin(a)}else this.onPlayAniEnd()},onPlayAniBegin:function(e){b8e.Tween.get(this).to({scaleX:.5,scaleY:.5,x:e.x,y:e.y},1e3).call(this.onPlayAniEnd,this)},onPlayAniEnd:function(){this.send(this.Evts.V2C_SHOWNEXTMODULEOPEN),game.module.hide(game.ME.ModuleOpenFlyBtn)},onStageResize:function(){this.setPosition(.5*b8e.stageWidth,.5*b8e.stageHeight)}});b8e.module.registerView(game.ME.ModuleOpenFlyBtn,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(722)},init:function(){this.surfaceModel=new game.SurfaceModel,this.surfaceModel.addToParent(this.skin.model),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.PreConfigChange:this.updatePreConfig()}},onShow:function(){this.updatePreConfig()},updatePreConfig:function(){var e=game.moduleOpenData.getNextPreCfg();if(e){var t=this,a=t.skin,i=game.moduleOpenData.getIsCanGetRewardById(e.moduleId);a.openLv.string=game.Lang.get(i?51211:51212,game.moduleOpenData.getConditionDescByModuleId(e.moduleId)),a.openName.string=e.name,t.surfaceModel.showSurface(e);var n=e.preScale;t.surfaceModel.setScale(n||1,n||1);var s=e.prePos;if(s){var o=s.split("|"),r=0<o.length?+o[0]:0,g=1<o.length?+o[1]:0;t.surfaceModel.setPosition(r,g)}else t.surfaceModel.setPosition(0,0);a.redPoint.setVisible(game.moduleOpenData.checkAllPreAlert())}else this.removeFromParent()},onStageResize:function(){this.setPosition(b8e.stageWidth-160,b8e.stageHeight-220)}});b8e.module.registerView(game.ME.MainModulePre,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,_lightEffect:null,bgY:0,bgHeight:128,ctor:function(){this._super(724)},init:function(){var e=this;e.surfaceModel=new game.SurfaceModel,e.surfaceModel.addToParent(e.skin.model),e._lightEffect=new game.LightEffect,e._lightEffect.addToParent(e.skin.effect),b8e.evt.onC(e.skin.onClick,e.onClick,e),e.aniIsBegin=!1},onClick:function(){game.ModuleCfg.getData(this.bindFlyModule).showOpenViewBtn||this.playAni()},playAni:function(){var e=this;if(!e.aniIsBegin){var t=game.ModuleCfg.getData(e.bindFlyModule);if(t){var a=t.flyBottomIdx;if(0<a){if(!b8e.module.isShowView(game.ME.MainUIBottom))return void e.onPlayAniEnd();e.send(e.Evts.BIND_FLY_BOTTOM_BTN_POS,a)}else if(t.moduleId==game.ME.QuickBattle){if(!b8e.module.isShowView(game.ME.QuickBattle))return void e.onPlayAniEnd();e.send(e.Evts.BIND_FLY_TASK_BTN_POS)}else e.onPlayAniEnd()}else e.onPlayAniEnd()}},beginPlayAni:function(){var e=this.skin;this.aniIsBegin=!0;var t=game.moduleOpenData.bindFlyAnimBtnPos;t?(e.aniNode.setAlpha(1),e.cancelBtn.active=e.gotoBtn.active=!1,b8e.Tween.get(this.skin.noAniNode).to({alpha:0},200).call(this.onPlayAlphaAniEnd,this,[t])):this.onPlayAniEnd()},onPlayAlphaAniEnd:function(e){b8e.Tween.kill(this.skin.noAniNode),this.skin.aniNode.setAlpha(0),game.viewModule.removeModule(this),game.moduleOpenFlyAniData.setInfo(this.bindFlyModule,e),game.module.show(game.ME.ModuleOpenFlyBtn)},onPlayAniEnd:function(){var e=this.skin;e.noAniNode.setAlpha(1),e.aniNode.setAlpha(1),e.cancelBtn.active=e.gotoBtn.active=!0,game.viewModule.addModule(this),game.module.hide(game.ME.ModuleOpen),this.aniIsBegin=!1,this.send(this.Evts.V2C_SHOWNEXTMODULEOPEN)},notify:function(e,t){var a=this;switch(e){case a.Evts.ModuleOpen:a.showModuleOpen(t);break;case a.Evts.C2V_UPDATE_TIME:a.updateCdTime(t);break;case a.Evts.C2V_PLAY_FLY_BOTTOM_BTN_ANI:a.playAni();break;case a.Evts.C2V_BEGINPLAYANI:a.beginPlayAni();break;case a.Evts.C2V_SHOWNEXTMODULEOPEN:a.onPlayAniEnd()}},showModuleOpen:function(e){var t=this;t.bindFlyModule=e;var a=game.ModuleCfg.getData(e);if(a){var i=t.skin,n=a.name,s=n.length;2==s&&(n=n[0]+"\n\n"+n[1]),4<s?(i.page.node.height=t.bgHeight+24*(s-4),i.moduleName.node.y=t.bgY+12*(s-4)):(i.page.node.height=t.bgHeight,i.moduleName.node.y=t.bgY),i.moduleName.string=n,i.moduleOpen.string=game.Lang.get(9532,a.name);var o=a.moduleOpenScale;t.surfaceModel.setScale(o||1,o||1);var r=a.moduleOpenPos;if(r){var g=r.split("|"),l=0<g.length?+g[0]:0,c=1<g.length?+g[1]:0;t.surfaceModel.setPosition(l,c)}else t.surfaceModel.setPosition(0,0);t.surfaceModel.showSurface(a),i.cancelBtn.active=i.gotoBtn.active=a.showOpenViewBtn,i.cdTime.active=i.tipslbl.active=!a.showOpenViewBtn}else t.removeFromParent()},onShow:function(){this._lightEffect.setVisible(!0)},updateCdTime:function(e){this.skin.cdTime.string=game.Lang.get(51925,e)},onHide:function(){this._lightEffect.setVisible(!1),this.aniIsBegin=!1,b8e.Tween.kill(this.skin.noAniNode),this.skin.noAniNode.setAlpha(1),this.skin.aniNode.setAlpha(1)},onStageResize:function(){var e=this.skin;this.setPosition(.5*b8e.stageWidth,.5*b8e.stageHeight),e.onClick.setSize(b8e.stageWidth,b8e.stageHeight),e.bg.width=e.frame_1.width=e.frame_2.width=b8e.stageWidth}});b8e.module.registerView(game.ME.ModuleOpen,e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(721)},init:function(){this.starAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1),this.starAnim.addToParent(this.skin.anim)},onShow:function(){var e=this,t=this.starAnim;t.load(game.ResCfg.getUrl(5019,1014)),t.play(),game.TweenUtil.rotationEffect(this.skin.light),e.updateRound()},updateRound:function(){var e=this.skin.round.node;e.scaleX=.75,e.scaleY=.75,e.alpha=.5,b8e.Tween.get(e,{loop:!0}).to({scaleX:.9,scaleY:.9,alpha:1},250).to({scaleX:1,scaleY:1,alpha:0},250).wait(400)},onHide:function(){this.starAnim.clear(),b8e.Tween.kill(this.skin.round.node),b8e.Tween.kill(this.skin.light)}}),b8e.RC("$$game","$$LightEffect",e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(723)},init:function(){this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},onShow:function(){if(game.moduleOpenData.getNextPreCfg())game.module.showTab(game.ME.MainModulePre,game.ME.MainUIModulePre);else{game.module.hide(game.ME.MainModulePre)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.MainUIModulePre,e)}(),function(){var e;e=b8e.Enum({None:0,V_UPDATE_DATA:-1,C2C_ON_GET_REWARD:-1,C2V_TIME_CHANGE:-1,V2C_ONSHOW:-1,V2C_ONHIDE:-1,C2V_UPDATE_TIME:-1}),b8e.RC("$$game","$$ModulePreEvts",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(725)},init:function(){var e=this,t=e.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingX=42,t.addToParent(e.skin.prizeList),e.itemInfos=[],e.itemInfoPool=[];var a=e.title=b8e.Sprite.get();a.setAnchor(.5,.5),a.addToParent(e.skin.title)},notify:function(e,t){switch(e){case this.Evts.C2V_TIME_CHANGE:this.skin.endTime.string=game.Lang.get(51210,t)}},onHide:function(){this.send(this.Evts.V2C_ONHIDE),this.list.setData(null)},onShow:function(){var e=this,t=e.skin;t.endTime.string=game.Lang.get(51210,game.moduleOpenData.preCdTime);var a=game.moduleOpenData.nextGetRewardPre;if(a){var i=a.config,n=a.id,s=a.descId;if(e.clearPool(),i)for(var o,r,g=i.openItems,l=g.length,c=0;c<l;c++){r=g[c],o=e.getItemInfo(),o=game.ItemUtil.createBaseItemInfo(r.Id,r.Num,o),e.itemInfos.push(o)}e.list.setData(e.itemInfos),t.lbl_desc.string=game.Lang.get(s),e.title.loadTexture(game.ResCfg.getUrl(10043,n));var h=game.moduleOpenData.getIsCanGetRewardById(n);t.isCanGet.setVisible(h),t.isNoGet.setVisible(!h),t.lbl_tip.string=h?"":game.moduleOpenData.getConditionDescByModuleId(n),this.send(this.Evts.V2C_ONSHOW,a)}else game.module.hide(game.ME.ModulePre)},getItemInfo:function(){var e=this.itemInfoPool;if(0<e.length){return e.shift()}return new game.ItemInfo},clearPool:function(){var e=this.itemInfos,t=this.itemInfoPool;if(0<e.length){t=t.concat(e),e.length=0}},onStageResize:function(){this.setPosition(.5*(b8e.stageWidth-this.width),.5*(b8e.stageHeight+this.height)+50)}});b8e.module.registerView(game.ME.ModulePre,e)}(),function(){var e=void 0;(e=game.ListItem.extends({prizeIcon:null,icon:null,ctor:function(){this._super(1226),this.setSize(598,130)},init:function(){this.prizeIcon=game.GridUtil.createItemIcon(),this.prizeIcon.addToParent(this.skin.prize);var e=this.icon=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.icon)},setData:function(){var e=this.skin,t=this.data.id,a=this.data.config;if(a){if(this.icon.loadTexture(game.ResCfg.getUrl(10044,t)),0<a.openItems.length){var i=a.openItems[0];if(i){var n=game.ItemUtil.createBaseItemInfo(i.Id,i.Num);this.prizeIcon.setItemInfo(n,!1,game.IconLayoutEnum.SHOW_NUM)}}e.title_1.string=game.Lang.get(this.data.descId);var s=game.moduleOpenData.getIsCanGetRewardById(t);e.title_2.string=game.Lang.get(s?51211:51212,game.moduleOpenData.getConditionDescByModuleId(t)),e.redPoint.setVisible(s)}},touch:function(){game.moduleOpenData.nextGetRewardPre=this.data,game.module.show(game.ME.ModulePre)}})).poolCall=!0,b8e.RC("$$game","$$ModulePreListItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1227)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.ModulePreListItem,e.bindEnum=game.ME.ModulePreList,e.addToParent(this.skin.list),e.layout.spacingY=5},notify:function(e){switch(e){case this.Evts.V_UPDATE_DATA:this.updateData()}},onShow:function(){this.updateData()},updateData:function(){var e=game.moduleOpenData.moduleOpenPreList;0!=e.length?this.list.setData(e):game.module.hide(game.ME.ModulePreList)}});b8e.module.registerView(game.ME.ModulePreList,e)}(),function(){var e=game.Control.extends({init:function(){this.preViewTimer=null,this.preInfo=null},ipc:function(){this.handels={CollectTriggerAwardResp:this.onCollectTriggerAwardResp}},notify:function(e,t){var a=this;switch(e){case a.Evts.V2C_ONSHOW:if(a.preInfo=t,a.preInfo)game.moduleOpenData.getIsCanGetRewardById(a.preInfo.id)&&!a.preViewTimer&&(a.preViewCdTime=game.moduleOpenData.preCdTime,a.preViewTimer=b8e.Timer.add(a,a.updatePreViewTime,1e3));break;case a.Evts.V2C_ONHIDE:a.preViewTimer&&(b8e.Timer.remove(a,a.updatePreViewTime),a.preViewTimer=null)}},onCollectTriggerAwardResp:function(e){var t=e.readProtobuf(game.pb.CollectTriggerAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.moduleOpenData.updateCollectedAward(t.id),game.module.hide(game.ME.ModulePre),this.dpt(this.Evts.C2C_ON_GET_REWARD),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},btn_getAndGo:function(){if(this.preInfo){var e=this.preInfo.id;this.getModuleOpenPreReward(e);var t=this.preInfo.config;if(t&&0!==t.preJumpId){var a=t.preJumpId,i=t.preJumpToggleIndex;0<i?game.module.showToggle(a,i-1):game.module.show(a)}}},btn_get:function(){this.preInfo&&this.getModuleOpenPreReward(this.preInfo.id)},getModuleOpenPreReward:function(e){e&&this.sender.CollectTriggerAwardReq(+e)},updatePreViewTime:function(){this.preViewCdTime-=1,this.send(this.Evts.C2V_TIME_CHANGE,this.preViewCdTime<=0?0:this.preViewCdTime),0<this.preViewCdTime||this.preInfo&&this.getModuleOpenPreReward(this.preInfo.id)}}),t=game.Sender.extends({ipc:function(){this.msg={CollectTriggerAwardReq:this.onCollectTriggerAwardReq}},onCollectTriggerAwardReq:function(e){var t=game.pb.CollectTriggerAwardRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.ModulePre,e,game.ModulePreEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={ModulePre:{C2C_ON_GET_REWARD:this.onGetReward}}},onGetReward:function(){this.send(this.Evts.V_UPDATE_DATA)}});b8e.module.registerControl(game.ME.ModulePreList,e,game.ModulePreEvts)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_BTN:-1,V_SHOW_VIEW:-1,V_HIDE_VIEW:-1,C2C_CHANGE_OPENSERVER:-1,C2C_INIT_OPENSERVER:-1,C2C_CHANGE_OPENSERVER_OPEN:-1,C2V_CHANGE_OPENSERVER_OPEN:-1,C2C_UPDATA_OPENSERVER:-1}),b8e.RC("$$game","$$OpenServerEvts",e)}(),function(){var e;e=b8e.Enum({C2C_CHANGE_OPENSERVER:b8e.enc(),C2C_SHOW_OPENSERVER:b8e.enc(),C2C_CHANGE_OPENSERVER_LIST:b8e.enc()}),b8e.RC("$$game","$$OpenServerGEvts",e)}(),function(){var e;e=game.Control.extends({lastModuleEnum:-1,lastId:-1,normalOpen:!0,setServerData:function(e){if(this.serverData&&e&&e.data){var t=e.data,a=t.openServerType,i=t.type?t.type:0,n=t.isActive,s=t.sae?t.sae:null,o=t.param?t.param:null;this.serverData.setServerInfo(a,i,n,s,o),this.dpt(this.Evts.C2C_CHANGE_OPENSERVER_OPEN,a),this.send(this.Evts.C2V_CHANGE_OPENSERVER_OPEN);var r=game.OpenServerClientCfg.getData(a,i);if(r){if(this.serverData.curIndex==r.id){this.showView()}}}else{b8e.warn("\u8bbe\u7f6e\u5f00\u670d\u6d3b\u52a8\u6ca1\u6709\u4f20\u5165\u6570\u636e!!!")}},setServerDataList:function(e){if(this.serverData&&e&&e.data){var t=e.data;if(t)if(Array.isArray(t)){for(var a=t.length,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=void 0,l=void 0,c=void 0,h=this.serverData,m=0;m<a;m++)n=(i=t[m]).openServerType,s=i.type?i.type:0,o=i.isActive,r=i.sae?i.sae:null,g=i.param?i.param:null,h.setServerInfo(n,s,o,r,g),(l=game.OpenServerClientCfg.getData(n,s))&&h.curIndex==l.id&&(c=!0);c&&this.showView(),this.send(this.Evts.C2V_CHANGE_OPENSERVER_OPEN),this.dpt(this.Evts.C2C_CHANGE_OPENSERVER_OPEN,n)}else b8e.warn("\u4f7f\u7528\u6570\u7ec4\u8bbe\u7f6e\u5f00\u670d\u6d3b\u52a8 \u4f20\u5165\u4e00\u4e2a\u975e\u6570\u7ec4\u7684\u53c2\u6570!!!")}else b8e.warn("\u8bbe\u7f6e\u5f00\u670d\u6d3b\u52a8\u6ca1\u6709\u4f20\u5165\u6570\u636e!!!")},showOpenserver:function(e){if(this.serverData&&e&&e.data){var t=e.data,a=t.openServerType,i=t.type?t.type:0;if(0==i){var n=this.serverData.getOpenserverInfoByType(a);if(!n||n.length<1)return void b8e.warn("\u8fd9\u6d3b\u52a8\u6ca1\u6709\u5728\u5f00\u542f\u7684\u5f00\u670d\u6d3b\u52a8\u4e2d...openServerType:"+a);1<n.length&&b8e.warn("\u5f00\u4e862\u4e2a\u6216\u4ee5\u4e0a\u7684\u6d3b\u52a8\uff0c\u9ebb\u70e6\u4f20\u5165\u989d\u5916\u53c2\u6570type:"+a),i=n[0].type}var s=game.OpenServerClientCfg.getData(a,i);if(s)if(game.moduleOpen.checkOpenWithTips(s.moduleId))this.serverData.getIsOpenById(s.id)&&(this.selectId=s.id,this.serverData.normalOpen=!1),game.module.show(this.moduleEnum,null,!1)}else{b8e.warn("\u4ece\u5916\u90e8\u6253\u5f00\u5f00\u670d\u6d3b\u52a8\u6ca1\u6709\u4f20\u5165\u6570\u636e!!!")}},notify:function(e,t,a,i,n){var s=this.Evts;switch(e){case s.V_SELECT_BTN:this.selectBtn(t);break;case s.V_SHOW_VIEW:this.showView();break;case s.V_HIDE_VIEW:this.hideView();break;case s.C2C_CHANGE_OPENSERVER:return void b8e.warn("\u8bf7\u4f7f\u7528dptG OpenServerGEvts\u5b9e\u73b0setServerData\uff0c\u8be5\u65b9\u6cd5\u5df2\u5f03\u7f6e...data1:"+t+"data2:"+a+"data3:"+i+"data4:"+n)}},showView:function(){var e=this;if(e.serverData){var t=e.serverData,a=t.getOpenServerList();if(!a||a.length<1)game.module.hide(e.moduleEnum);else{var i;if(t.normalOpen)if(-1==e.lastId)i=t.getCanOpenId();else if(t.getIsOpenById(e.lastId))i=t.checkOpenById(e.lastId)?e.lastId:t.getCanOpenId();else i=t.getCanOpenId();else i=e.selectId;e.lastId=-1,e.selectBtn(i,!0)}}},hideView:function(){0<this.lastModuleEnum&&game.module.hide(this.lastModuleEnum),this.serverData.selectPage(0,this.lastId),this.lastModuleEnum=-1,this.selectId=0,this.serverData.normalOpen=!0},selectBtn:function(e){var t=this,a=t.serverData.getOpenServerById(e);if(a){var i=a.getCfg();if(i&&game.moduleOpen.checkOpenWithTips(i.moduleId)){var n=i.moduleId;n?t.lastId!=e&&(-1<t.lastModuleEnum&&game.module.hide(t.lastModuleEnum),i.openServerType==game.OpenServerType.OPENSERVCR&&0<i.type&&(game.openServerCRData.openCRType=i.type),t.serverData.selectPage(e,t.lastId),game.module.showTab(n,t.moduleEnum),t.send(t.Evts.V_SELECT_BTN),t.lastId=e,t.lastModuleEnum=n):b8e.error("\u7c7b\u578b:"+i.openServerType+"\u6ca1\u6709\u5bf9\u5e94\u7684moduleEnum")}}}}),b8e.RC("$$game","$$ServerControl",e)}(),function(){var e=game.ServerControl.extends({lastModuleEnum:-1,lastId:-1,normalOpen:!0,init:function(){this.serverData=game.openServerData,this.spotAlert=game.spotAlert.set(game.SAE.OPEN_SERVER_ALERT,game.SAE.HOME)},ipc:function(){this.evts={MainRole:{C_INIT_SERVER_DATA:this.initServerData},OptionalLottery:{C_SEND_ACT:this.sendAct}},this.gevts={OpenServerGEvts:{C2C_CHANGE_OPENSERVER:this.setServerData,C2C_SHOW_OPENSERVER:this.showOpenserver,C2C_CHANGE_OPENSERVER_LIST:this.setServerDataList}},this.handels={ActivityModelResp:this.onActivityModelResponse}},initServerData:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.isInit||this.sender.ActivityModelReq())},triggerOpen:function(e){e==this.moduleEnum&&(this.isInit||this.sender.ActivityModelReq())},onActivityModelResponse:function(e){var t=e.readProtobuf(game.pb.ActivityModelResponse);0<t.code?game.notice.noticeError(t.code):this.isInit?this.dpt(this.Evts.C2C_UPDATA_OPENSERVER,t):(this.isInit=!0,game.upgradeRebateData.setJinjieAward(t.upgradeRebate),game.activityMissionData.setupData(t.socialGoal,t.socialGoalAwards),game.smashGoldEggData.syncModelDatas(t),game.moneyCatData.syncModelDatas(t),this.dpt(this.Evts.C2C_INIT_OPENSERVER,t))},sendAct:function(){this.sender.ActivityModelReq()}}),t=game.Sender.extends({ipc:function(){this.msg={ActivityModelReq:null}}});b8e.module.registerControl(game.ME.OpenServer,e,game.OpenServerEvts,t)}(),function(){var t=void 0;t=b8e.PoolObject.extends({select:!1,alert:!1,id:0,sortId:0,spotAlertEnum:0,param:null,openServerType:0,type:0,setData:function(e,t,a,i){var n=this;n.openServerType=e,n.type=t,n.spotAlertEnum=a,n.param=i;var s=game.OpenServerClientCfg.getData(e,t);if(s){if(n.sortId=s.sortId,n.id=s.id,n.spotAlertEnum){n.bindAlert(n.spotAlertEnum)}}else{b8e.warn("\u6ca1\u6709\u5bf9\u5e94\u7c7b\u578b\u7684\u5f00\u670d\u6d3b\u52a8\u5ba2\u6237\u7aef\u914d\u7f6e,\u6d3b\u52a8\u7c7b\u578b:"+e)}},getCfg:function(){return game.OpenServerClientCfg.getData(this.openServerType,this.type)},bindAlert:function(){var e=this;if(e._bindAlert);else game.spotAlert.setCb(e.spotAlertEnum,e.updateAlert,e),e._bindAlert=!0},updateAlert:function(e){this.alert=e.alert},clearData:function(){var e=this;if(e.spotAlertEnum){e._bindAlert=!1,game.spotAlert.delCb(e.spotAlertEnum,e.updateAlert,e),e.spotAlertEnum=0}e.alert=!1},recycle:function(){this.clearData(),this._super()}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$OpenServerBtnInfo",t)}(),function(){var e=void 0;e=b8e.Object.extends({curIndex:0,normalOpen:!0,ctor:function(){this._super(),this.openServerBtnList=[],this.openServerMap=b8e.HashMap.get(),this.openServerTypeMap=b8e.HashMap.get()},getOpenServerList:function(){return this.openServerBtnList},setServerInfo:function(e,t,a,i,n){var s=this,o=game.OpenServerClientCfg.getData(e,t);if(o){if(game.moduleOpen.checkOpen(o.moduleId)){if(a){var r=s.openServerMap.get(o.id);r||(r=game.OpenServerBtnInfo.get(),s.openServerMap.set(o.id,r),s.openServerBtnList.push(r)),r.setData(e,t,i,n),(f=s.openServerTypeMap.get(e))||(f=[],s.openServerTypeMap.set(e,f));for(var g=void 0,l=f.length,c=0;c<l;c++)if((g=f[c]).openServerType==r.openServerType&&g.type==r.type)return;f.push(r)}else{var h,m,u=s.openServerBtnList.length,d=!1;for(s.openServerMap.has(o.id)&&s.openServerMap.del(o.id),h=0;h<u;h++)if((m=s.openServerBtnList[h]).id==o.id){d=!0,game.OpenServerBtnInfo.put(m),s.openServerBtnList.splice(h,1);break}if(s.openServerTypeMap.has(e)){var f;u=(f=s.openServerTypeMap.get(e)).length;for(h=0;h<u;h++)if((m=f[h]).id==o.id){d||game.OpenServerBtnInfo.put(m),f.splice(h,1);break}0==f.length&&s.openServerTypeMap.del(e)}}s.openServerBtnList.sort(s.onSort)}}else b8e.warn("\u6ca1\u6709\u5bf9\u5e94\u7c7b\u578b\u7684\u5f00\u670d\u6d3b\u52a8\u5ba2\u6237\u7aef\u914d\u7f6e,\u6d3b\u52a8\u7c7b\u578b:"+e,t)},onSort:function(e,t){return e.sortId-t.sortId},getOpenServerById:function(e){return this.openServerMap.get(e)},getIsOpenById:function(e){return this.openServerMap.has(e)},getIsOpenByType:function(e){var t=this.openServerTypeMap.get(e);return t&&0<t.length},getOpenserverInfoByType:function(e){return this.openServerTypeMap.get(e)},selectPage:function(e,t){if(!this.openServerBtnList||this.openServerBtnList.length<1);else{for(var a,i=this.openServerBtnList.length,n=0;n<i;n++){if((a=this.openServerBtnList[n]).id==e){a.select=!0}if(a.id==t){a.select=!1}}this.curIndex=e}},getOpenServerIsOpen:function(){if(this.openServerBtnList)return 0<this.openServerBtnList.length;return!1},getCurId:function(){return this.curIndex},getCurBtnInfo:function(){return this.openServerMap.get(this.curIndex)},getCanOpenId:function(){var e=this.getOpenServerList();if(!e||e.length<1)return 0;for(var t,a,i=e.length,n=0;n<i;n++)if((a=(t=e[n]).getCfg())&&game.moduleOpen.checkOpen(a.moduleId))return t.id;return 0},checkOpenById:function(e){var t=this.getOpenServerById(e);if(!t)return!1;var a=t.getCfg();return!(!a||!game.moduleOpen.checkOpen(a.moduleId))}}),game.openServerData=game.openServerData||new e,b8e.RC("$$game","$$OpenServerData",e)}(),function(){var e;e=b8e.Enum({NONE:0,QUANMIN_FOSTER_UPGRADE:1,ACTIVE_LEVEL_UP:2,DIANWEI:3,JINJIE_RANK:4,DISCOUNT_SHOP:5,PVE:6,RED_PACKET:7,QUANMIN_PURCHASE:8,ACCUMULATED_RECHARGE:9,UPGRADE_REBATE:10,SPECIAL_SHOP:11,MYSTERY_SHOP:12,CON_RECHARGE:13,FIGHT_PET:14,GOD_ARMY:16,CON_RECHARGE2:17,GUO_SHI:18,ACC_COST2:19,GROW_GIFT:20,DAILY_GIFT:21,FIGHT_PETSKILL:22,LOGIN:23,LIMITED_TIME_RANK:24,MERGE_TOTAL_RECHARGE:25,MERGE_ACC_COST:26,TURNPLATE:27,MARRYMISSION:28,GUILDMISSION:29,FA_ZHEN:30,PET_WASH_REBATE:34,CROSS_SERVICE_RANK:36,JUNZHEN_REBATE:37,CULTRUE_GIFT:39,TEMPLE:54,CONTINUOUS_CONSUME:60,FUND:58,MONEYCAT:59,ACC_COST:63,DAILY_DEAL:61,OPENSERVCR:62,ACCRECHARGE:64,RECRUIT_REBATE:65,SCRATCH:66}),b8e.RC("$$game","$$OpenServerType",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1),this.setSize(105,136)},init:function(){var e=this.btn=b8e.Sprite.get();e.addToParent(this.skin.titleImg),e.setAnchor(0,1),this.skin.alert.node.active=!1},setData:function(){var e=this.data;this.skin.titleImgSelect.node.active=e.select;var t=e.getCfg();if(t)if(t.titleBg){var a=game.ResCfg.getImgUrl(t.titleBg);this.btn.loadTexture(a),this.skin.alert.node.active=e.alert}else b8e.error("\u5f00\u670d\u6d3b\u52a8\u6309\u94ae\u914d\u7f6e\u6ca1\u6709\u5bf9\u5e94\u7684\u6807\u9898\u6309\u94ae\u5e95\u56fe,id:",t.id)},onClickBtn:function(){this.send(game.OpenServerEvts.V_SELECT_BTN,this.data.id)}}),b8e.RC("$$game","$$OpenServerBtnItem",e)}(),function(){var e;e=game.View.extends({ctor:function(){this._super(136)},init:function(){this.serverItem||(this.serverItem=game.OpenServerBtnItem);var e=this.openServerBtns=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=this.serverItem,e.addToParent(this.skin.list),e.bindEnum=this.moduleEnum,e.layout.spacingX=0;var t=this.titleImg=b8e.Sprite.get();t.addToParent(this.skin.titleImg),t.setAnchor(.5,.5)},notify:function(e){switch(e){case this.Evts.V_SELECT_BTN:this.setTitleImg(),this.updateBanner();break;case this.Evts.C2V_CHANGE_OPENSERVER_OPEN:this.btns=this.serverData.getOpenServerList(),this.openServerBtns.setData(this.btns)}},onShow:function(){this.btns=this.serverData.getOpenServerList(),this.openServerBtns.setData(this.btns),this.send(this.Evts.V_SHOW_VIEW),this.selectBtn()},onHide:function(){this.send(this.Evts.V_HIDE_VIEW),this.openServerBtns.scrollToLeft(0)},selectBtn:function(){if(this.serverData.normalOpen);else{var e=this.serverData.curIndex;this.serverData.normalOpen=!0;var t=this.serverData.getOpenServerList();if(!t||t.length<=0);else{for(var a,i=this,n=t.length,s=0;s<n;s++){if(t[s].id==e&&t[s].select){a=s}}if(a&&0!=a){i.openServerBtns.scrollToRight(96*a/2,50)}else i.openServerBtns.scrollToLeft(0)}}},setTitleImg:function(){var e=this.serverData.getCurBtnInfo();if(e){var t=e.getCfg();if(t){var a,i=this.getTitleImg(t);a=i&&""!=i?game.ResCfg.getImgUrl(i):game.ResCfg.getUrl(29),this.titleImg.loadTexture(a)}}},updateBanner:function(){var e=this.serverData.getCurBtnInfo();if(e){var t=e.getCfg();if(t){var a=this.getBannerImg(t);if(a){var i=game.ResCfg.getImgUrl(a,!0);this.skin.banner.loadTexture(i)}else this.skin.banner.unloadTexture()}}},getBannerImg:function(e){return e?e.bannerImg:null},getTitleImg:function(e){return e?e.titleImg:null},viewLeftBtn:function(){this.openServerBtns.scrollContainerLeft()},viewRightBtn:function(){this.openServerBtns.scrollContainerRight()}}),b8e.RC("$$game","$$ServerView",e)}(),function(){var e=game.ServerView.extends({ctor:function(){this._super()},init:function(){this.serverItem=game.OpenServerBtnItem,this.serverData=game.openServerData,this._super()}});b8e.module.registerView(game.ME.OpenServer,e)}(),function(){var e;e=b8e.Enum({None:0,UPDATE_ROUND:-1,V_FOLLOW_CHAT:-1}),b8e.RC("$$game","$$PlaybackInfoEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C_UPDATE_TITLE:b8e.enc(),V_UPDATE_TITLE:b8e.enc(),C2C_REFRESH_BTNS:b8e.enc()}),b8e.RC("$$game","$$FreeGiftEvts",e)}(),function(){var e=b8e.Object.extends({titleInfoArr:null,selectedID:null,ctor:function(){this._super(),this.titleInfoArr=b8e.HashMap.get()},initCfg:function(){if(!this._initReady){this.selectedID=1;var e=game.ZeroCfg.getDatas();if(e){for(var t=null,a=e.length,i=0;i<a;i++){t=e[i];var n=new game.TitleInfo;n.setData(t),this.titleInfoArr.set(t.id,n)}this._initReady=!0}}},setZeroAwardsArr:function(e){for(var t=0;t<e.length;t++)this.titleInfoArr.get(e[t].id).setNetData(e[t])},setSelctedID:function(e){for(var t=this.titleInfoArr.values(),a=void 0,i=0;i<t.length;i++)if((a=t[i]).isMerge==e){if(!a.isJoin)return void(this.selectedID=a.id);if(a.isJoin&&!a.isGet&&a.serverDay+a.getTime<=(e?game.miscData.serverMergeDays:game.miscData.openServerDay))return void(this.selectedID=a.id)}for(i=0;i<t.length;i++)if((a=t[i]).isMerge==e&&a.isJoin&&!a.isGet)return void(this.selectedID=a.id)},isStartAct:function(){var e=this.titleInfoArr.values();return!(!e||e.length<1)&&e[0].serverStart<=game.miscData.openServerDay},isMergeStartAct:function(){var e=this.titleInfoArr.values();if(!e||e.length<1)return!1;for(var t,a=e.length,i=void 0,n=game.miscData.mergeVersion,s=0;s<a;s++)if((i=e[s]).isMerge&&i.mergeVer==n){t=i.mergeStart;break}return!!t&&t<=game.miscData.serverMergeDays},isGetAllPrise:function(e){for(var t=this.titleInfoArr.values(),a=0;a<t.length;a++)if(!(e!=t[a].isMerge||t[a].isJoin&&t[a].isGet))return!1;return!0},getTitleArry:function(){return this.titleInfoArr.values()},getTitleById:function(e){return this.titleInfoArr.get(e)},updataSelect:function(e,t){for(var a=this.titleInfoArr.values(),i=a.length,n=void 0,s=0;s<i;s++)t==(n=a[s]).isMerge&&(n.isSelected=n.id==e)}});game.freeGiftData=game.freeGiftData||new e}(),function(){var e;e=b8e.Object.extends({id:null,lv:null,gold:null,isMerge:null,mergeVer:0,serverStart:null,serverDayBuy:null,mergeStart:null,mergeDayBuy:null,award:null,rebateGold:null,getTime:null,name:null,isSelected:null,model:null,isJoin:null,isGet:null,serverDay:null,ctor:function(){this._super()},setData:function(e){var t=this;t.id=e.id,t.lv=e.lv,t.gold=e.gold,t.isMerge=e.mergeVer&&0!=e.mergeVer,t.mergeVer=e.mergeVer,t.serverStart=e.serverStart,t.serverDayBuy=e.serverDayBuy,t.mergeStart=e.mergeStart,t.mergeDayBuy=e.mergeDayBuy,t.award=e.award,t.rebateGold=e.rebateGold,t.getTime=e.getTime,t.name=e.name,t.model=e.model,t.x=e.x,t.y=e.y,t.lab1Pos=e.lab1Pos,t.lab2Pos=e.lab2Pos,t.modelPos=e.modelPos,t.wordsNode=e.wordsNode,t.sortId=e.sortId},setNetData:function(e){this.isJoin=!0,this.isGet=e.isRebate,this.serverDay=this.isMerge?e.mergeDay:e.serverDay},setBuyData:function(){this.isJoin=!0,this.isGet=!1,this.serverDay=this.isMerge?game.miscData.serverMergeDays:game.miscData.openServerDay},setGetData:function(){this.isGet=!0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$TitleInfo",e)}(),function(){var e=game.Control.extends({init:function(){this.freeGiftAlert=game.spotAlert.set(game.SAE.FREE_GIFT),this.mergeFreeGiftAlert=game.spotAlert.set(game.SAE.MERGE_FREE_GIFT)},ipc:function(){this.evts={OpenServer:{C2C_INIT_OPENSERVER:this.onSysData},Recharge:{C_RECHARGE_SUCCESS:this.updateBtn}},this.handels={ZeroAwardResp:this.onZeroAwardResp,ZeroAwardRebateResp:this.onZeroAwardRebateResp}},notify:function(e,t){switch(e){case game.FreeGiftEvts.C_UPDATE_TITLE:game.freeGiftData.updataSelect(t.id,t.type),this.send(game.FreeGiftEvts.V_UPDATE_TITLE,t.id)}},updateBtn:function(){this.send(game.FreeGiftEvts.V_UPDATE_TITLE,game.freeGiftData.selectedID)},onSysData:function(e){var t=e?e.data:null;if(t)game.freeGiftData.initCfg(),game.freeGiftData.setZeroAwardsArr(t.zeroAwards),this.checkAlert(!1),this.checkAlert(!0);else;},checkAlert:function(e){for(var t=game.freeGiftData.getTitleArry(),a=e?game.miscData.serverMergeDays:game.miscData.openServerDay,i=t.length,n=game.miscData.mergeVersion,s=0;s<i;s++)if(e==t[s].isMerge&&n==t[s].mergeVer&&t[s].isJoin&&!t[s].isGet&&t[s].serverDay+t[s].getTime<=a)return void(e?this.mergeFreeGiftAlert.alert=!0:this.freeGiftAlert.alert=!0);e?this.mergeFreeGiftAlert.alert=!1:this.freeGiftAlert.alert=!1},buyBtn:function(){var e=game.freeGiftData.selectedID;game.rechargeData.getRechargePass()?game.UpgradeUtil.checkEquipTooMuch()||this.sender.ZeroAwardReq(e):game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},onZeroAwardResp:function(e){var t=e.readProtobuf(game.pb.ZeroAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.freeGiftData.getTitleById(t.id);a&&(a.setBuyData(),this.send(game.FreeGiftEvts.V_UPDATE_TITLE,t.id))}},getBtn:function(){var e=game.freeGiftData.selectedID;this.sender.ZeroAwardRebateReq(e)},onZeroAwardRebateResp:function(e){var t=e.readProtobuf(game.pb.ZeroAwardRebateResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.freeGiftData.getTitleById(t.id);if(a){if(a.setGetData(),game.freeGiftData.setSelctedID(),this.send(game.FreeGiftEvts.V_UPDATE_TITLE,game.freeGiftData.selectedID),game.freeGiftData.isGetAllPrise()){this.dpt(this.Evts.C2C_REFRESH_BTNS)}this.checkAlert(!1),this.checkAlert(!0)}}}}),t=[game.ME.MergeFreeGift,game.ME.FreeGift],a=game.Sender.extends({ipc:function(){this.msg={ZeroAwardReq:this.zeroAwardReq,ZeroAwardRebateReq:this.zeroAwardRebateReq}},zeroAwardReq:function(e){var t=game.pb.ZeroAwardRequest;t.id=e,this.write(t)},zeroAwardRebateReq:function(e){var t=game.pb.ZeroAwardRebateRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.FreeFatherGift,e,game.FreeGiftEvts,a,t)}(),function(){var e;e=game.View.extends({_showModel:!0,titleList:null,awardsList:null,banner:null,words:null,model:null,ctor:function(){this._super(431)},init:function(){this._super();var e=this;e.banner=b8e.Sprite.get(),e.banner.setAnchor(0,1);var t=game.ResCfg.getImgUrl("active/bannerImg/banner");e.banner.loadTexture(t),e.banner.addToParent(e.skin.banner),e.words=b8e.Sprite.get(),e.words.setAnchor(0,1),e.words.addToParent(e.skin.wordsNode),e.titleList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.titleList.itemRender=game.TitleItemView,e.titleList.bindEnum=game.ME.FreeFatherGift,e.titleList.addToParent(e.skin.titleList),e.titleList.layout.paddingLeft=0,e.titleList.layout.paddingTop=-9,e.titleList.layout.spacingX=4,e.awardsList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.awardsList.itemRender=game.PrizeListItem,e.awardsList.bindEnum=game.ME.FreeFatherGift,e.awardsList.addToParent(e.skin.awardsListNode),e.awardsList.layout.paddingLeft=0,e.awardsList.layout.paddingTop=0,e.awardsList.layout.spacingX=13,e.awardsList.layout.spacingY=0,e.model=b8e.Sprite.get(),e.model.setAnchor(0,1),e.model.addToParent(e.skin.modelNode)}}),b8e.RC("$$game","$$FreeGiftFatherView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(432),this.setSize(129,60)},setData:function(){var e=this;e.skin.title_label.string=e.data.name,e.skin.title_light.node.active=!e.data.isSelected,e.skin.title_dark.node.active=e.data.isSelected;var t=e.data.isMerge?game.miscData.serverMergeDays:game.miscData.openServerDay,a=e.data.serverDay+e.data.getTime,i=e.data.isJoin&&!e.data.isGet,n=a<=t;e.alert(i&&n)},alert:function(e){this.skin.redPoint.node.active=e},onClick:function(){game.freeGiftData.selectedID!=this.data.id&&(game.freeGiftData.selectedID=this.data.id,this.send(game.FreeGiftEvts.C_UPDATE_TITLE,{id:this.data.id,type:this.data.isMerge}))}}),b8e.RC("$$game","$$TitleItemView",e)}(),function(){var e=game.FreeGiftFatherView.extends({ctor:function(){this._super()},notify:function(e,t){switch(e){case game.FreeGiftEvts.V_UPDATE_TITLE:this.updateTitleShow(t)}},onShow:function(){this.updataTitleInfo(),game.freeGiftData.setSelctedID(!1);var e=game.freeGiftData.selectedID;game.freeGiftData.updataSelect(e,!1),this.updateTitleShow(e),this.skin.firstMerge.active=!1},updataTitleInfo:function(){var e=game.freeGiftData.getTitleArry();e&&0<e.length&&e.sort(this.onSort);for(var t=e.length,a=[],i=void 0,n=0;n<t;n++)(i=e[n]).isMerge||a.push(i);this.titleList.setData(a)},onSort:function(e,t){return e.sortId-t.sortId},updateTitleShow:function(e){var t=this.skin,a=(game.freeGiftData.getTitleArry(),game.freeGiftData.getTitleById(e));if(a){var i=0<a.lv,n=game.rechargeData.getRechargePass();a.gold?t.moneyLabel.string=game.Lang.get(51290,a.gold):t.moneyLabel.string="";var s=game.miscData.openServerDay,o=a.serverDay+a.getTime,r=a.serverDayBuy,g=game.mainRoleData.lv;a.isJoin?a.isGet?(t.grayBtn.node.active=!0,t.buyBtn.node.active=!1,t.getBtn.node.active=!1,t.tipsLabel.node.active=!1,t.moneyLabel.node.active=!1):s<o?(t.tipsLabel.string=o-s==1?i?game.Lang.get(5207):game.Lang.get(5208):game.Lang.get(5209,o-s),t.grayBtn.node.active=!1,t.buyBtn.node.active=!1,t.getBtn.node.active=!1,t.tipsLabel.node.active=!0,t.moneyLabel.node.active=!1):(t.moneyLabel.string=game.Lang.get(51290,a.rebateGold),t.grayBtn.node.active=!1,t.buyBtn.node.active=!1,t.getBtn.node.active=!0,t.tipsLabel.node.active=!1,t.moneyLabel.node.active=!0):(t.grayBtn.node.active=!1,t.getBtn.node.active=!1,s<r||g<a.lv?(t.tipsLabel.string=r-s==1?game.Lang.get(5202,a.gold):game.Lang.get(5203,r),g<a.lv&&(t.tipsLabel.string=game.Lang.get(5204)),t.buyBtn.node.active=!1,t.moneyLabel.node.active=!1,t.tipsLabel.node.active=!0):(t.buyBtn.node.active=!0,t.moneyLabel.node.active=!0,t.tipsLabel.node.active=!1,t.buyLabel.string=n?i?game.Lang.get(5205):game.Lang.get(5206):game.Lang.get(5818)));var l=game.CfgUtil.getPrizeListInfo(a.award);if(l){this.awardsList.setData(l.items)}if(0===a.lv){t.label_01.string=a.gold}else t.label_01.string=a.lv;t.label_02.string=a.rebateGold;var c=game.ResCfg.getImgUrl("active/words/"+e),h=a.wordsNode,m=a.lab1Pos,u=a.lab2Pos,d=a.modelPos,f=game.ResCfg.getImgUrl("active/modelImag/"+e);t.wordsNode.setPosition(h.X,h.Y),t.label_01.setPosition(m.X,m.Y),t.label_02.setPosition(u.X,u.Y),t.modelNode.setPosition(d.X,d.Y),this.model.loadTexture(f),this.words.loadTexture(c)}}});b8e.module.registerView(game.ME.FreeGift,e)}(),function(){var e=game.FreeGiftFatherView.extends({ctor:function(){this._super()},notify:function(e,t){switch(e){case game.FreeGiftEvts.V_UPDATE_TITLE:this.updateTitleShow(t)}},onShow:function(){this.updataTitleInfo(),game.freeGiftData.setSelctedID(!0);var e=game.freeGiftData.selectedID;game.freeGiftData.updataSelect(e,!0),this.updateTitleShow(e),this.skin.firstMerge.active=!0},updataTitleInfo:function(){var e=game.freeGiftData.getTitleArry(),t=e.length,a=void 0;this.titleArry=[];for(var i=game.miscData.mergeVersion,n=0;n<t;n++)(a=e[n]).isMerge&&i==a.mergeVer&&this.titleArry.push(a);this.titleList.setData(this.titleArry)},updateTitleShow:function(e){var t=this.skin,a=this.titleArry,i=game.freeGiftData.getTitleById(e),n=0<i.lv,s=game.rechargeData.getRechargePass();i.gold?t.moneyLabel.string=game.Lang.get(51290,i.gold):t.moneyLabel.string="";var o=game.miscData.serverMergeDays,r=i.serverDay+i.getTime,g=i.mergeDayBuy,l=game.mainRoleData.lv;if(i.isJoin)i.isGet?(t.grayBtn.node.active=!0,t.buyBtn.node.active=!1,t.getBtn.node.active=!1,t.tipsLabel.node.active=!1,t.moneyLabel.node.active=!1):o<r?(t.tipsLabel.string=r-o==1?n?game.Lang.get(5207):game.Lang.get(5208):game.Lang.get(5209,r-o),t.grayBtn.node.active=!1,t.buyBtn.node.active=!1,t.getBtn.node.active=!1,t.tipsLabel.node.active=!0,t.moneyLabel.node.active=!1):(t.moneyLabel.string=game.Lang.get(51290,i.rebateGold),t.grayBtn.node.active=!1,t.buyBtn.node.active=!1,t.getBtn.node.active=!0,t.tipsLabel.node.active=!1,t.moneyLabel.node.active=!0);else if(t.grayBtn.node.active=!1,t.getBtn.node.active=!1,o<g||l<i.lv){if(g-o==1){var c=i.gold||"";t.tipsLabel.string=game.Lang.get(5202,c)}else t.tipsLabel.string=game.Lang.get(5210,g);l<i.lv&&(t.tipsLabel.string=game.Lang.get(5204)),t.buyBtn.node.active=!1,t.moneyLabel.node.active=!1,t.tipsLabel.node.active=!0}else t.buyBtn.node.active=!0,t.moneyLabel.node.active=!0,t.tipsLabel.node.active=!1,t.buyLabel.string=s?n?game.Lang.get(5205):game.Lang.get(5206):game.Lang.get(5818);var h=game.CfgUtil.getPrizeListInfo(i.award);h&&this.awardsList.setData(h.items),0===i.lv?t.label_01.string=i.gold:t.label_01.string=i.lv,t.label_02.string=i.rebateGold;for(var m=a.length,u=0;u<m;u++)e==a[u].id&&u+1;var d=game.ZeroCfg.getData(e),f=game.ResCfg.getImgUrl("active/words/"+e),p=game.ResCfg.getImgUrl("active/modelImag/"+e);t.wordsNode.setPosition(d.wordsNode.X,d.wordsNode.Y),t.label_01.setPosition(d.lab1Pos.X,d.lab1Pos.Y),t.label_02.setPosition(d.lab2Pos.X,d.lab2Pos.Y),t.modelNode.setPosition(d.modelPos.X,d.modelPos.Y),this.words.loadTexture(f),this.model.loadTexture(p)}});b8e.module.registerView(game.ME.MergeFreeGift,e)}(),function(){var e=game.Control.extends({round:0,ipc:function(){this.evts={PlayBackRound:{C2C_ROUND_CHANGE:this.updateRound}},this.gevts={InstanceEvts:{G_START_PLAY:this.resetRound,G_STOP_PLAY:this.resetRound}}},resetRound:function(){this.round=0},updateRound:function(e){var t=e.data;this.round=t.round,this.send(game.PlaybackInfoEvts.UPDATE_ROUND,t)},btn_skip:function(){var e=game.InstanceSuccessCfg.getData(game.playBack.options.type);if(e){var t=this.round,a=game.rechargeData.getCardInfoByType(game.CardType.WEEK);if(!game.LoginConfig.isStory)if(a&&a.expireTime>game.SysTime.curTime&&0<e.weekCardSkipRound){if(t<e.weekCardSkipRound)return void game.notice.show(52225,e.weekCardSkipRound)}else{if(!game.moduleOpen.checkOpenWithTips(game.ME.PlayBackSkip,!0))return;if(t<e.showSkipRound)return void game.notice.show(52226,e.showSkipRound)}game.playBack.stop(),game.module.hide(game.ME.PlaybackInfo)}}});b8e.module.registerControl(game.ME.PlaybackInfo,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(856),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case game.PlaybackInfoEvts.UPDATE_ROUND:this.showSkipBtn(t.round)}},onShow:function(){var e=game.playBack.options.type;game.InstanceSuccessCfg.getData(e)?(this.updateZhenxingDesc(),this.showSkipBtn(0)):b8e.module.hideView(this.moduleEnum)},updateZhenxingDesc:function(){var e=this.skin,t=game.zhenXingData,a=e.labMask,i=game.playBack.formation,n=i[1],s=i[0];if(n&&s){var o=t.getKeZhiState(n,s);o?(a.active=!0,e.formationLab.string=t.getKeZhiDesc(o,n,s)):a.active=!1}else a.active=!1},onHide:function(){this.skin.btn_skip.active=!1},onStageResize:function(){var e=this.skin,t=b8e.stageWidth,a=b8e.stageHeight;this.setPosition(t-320,a-55),e.btn_skip.y=-(a-235),e.labMask.setPosition(320-(t>>1),-(a-235))},showSkipBtn:function(e){var t=0<arguments.length&&void 0!==e?e:0,a=game.InstanceSuccessCfg.getData(game.playBack.options.type);if(a){this.skin.btn_skip.active=0<a.showSkipRound;var i=!1,n=game.rechargeData.getCardInfoByType(game.CardType.WEEK);game.LoginConfig.isStory?i=!0:n&&n.expireTime>game.SysTime.curTime&&0<a.weekCardSkipRound?t>=a.weekCardSkipRound&&(i=!0):game.moduleOpen.checkOpen(game.ME.PlayBackSkip)&&t>=a.showSkipRound&&(i=!0),game.ShaderUtil.setGray(this.skin.btn_skip,!i)}}});b8e.module.registerView(game.ME.PlaybackInfo,e)}(),function(){var e;e=b8e.Enum({ROUND_CHANGE:b8e.enc(),C2C_ROUND_CHANGE:b8e.enc(),GUILD_NEW_BOSS_DAMGE_CHANGE:b8e.enc()}),b8e.RC("$$game","$$PlayBackRoundEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.gevts={InstanceEvts:{G_ROUND_CHANGE:this.roundChange,C_UPDATE_BOSS_DAMGE:this.damgeChange,C_UPDATE_GUILD_NEW_BOSS_DMG:this.guildNewBossdamgeChange}}},damgeChange:function(e){var t=e.data;if(t){this.send(this.Evts.DAMGE_CHANGE,t)}},guildNewBossdamgeChange:function(e){var t=e.data;if(t){this.send(this.Evts.GUILD_NEW_BOSS_DAMGE_CHANGE,t)}},roundChange:function(e){var t=e.data;if(t){this.send(this.Evts.ROUND_CHANGE,t),this.dpt(this.Evts.C2C_ROUND_CHANGE,t)}},skip_btn:function(){},ownElemFettersBtn:function(){game.partnerData.elementFettersType=game.PartnerElemFettersTypes.ATTACK,game.module.show(game.ME.PartnerElementFettersTips)},otherElemFettersBtn:function(){game.partnerData.elementFettersType=game.PartnerElemFettersTypes.DEFENSE,game.module.show(game.ME.PartnerElementFettersTips)}});b8e.module.registerControl(game.ME.PlayBackRound,e,game.PlayBackRoundEvts,null)}(),function(){var e=game.View.extends({_specialLayer:!0,barLen:320,ctor:function(){this._super(857),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e=this.skin;this.box=b8e.Sprite.get(),this.box.addToParent(e.boxNode),this.box.setAnchor(.5,.5)},notify:function(e,t){switch(e){case this.Evts.ROUND_CHANGE:this.skin.round.string=t.round+"/"+game.playBack.options.maxRound;break;case this.Evts.DAMGE_CHANGE:this.showDamge(t);break;case this.Evts.GUILD_NEW_BOSS_DAMGE_CHANGE:this.showguildNewBossDamge(t)}},showDamge:function(e){this.skin.damge.string="S"+e},showguildNewBossDamge:function(e){var t=this.skin,a=game.guildNewBossData.getHpPercent(e),i=this.barLen;t.progress.width=Math.min(e/(1e4*a.Damage)*i,i),t.expLab.active=!0;var n=game.CCommonUtil.replaceNum(e),s=game.CCommonUtil.replaceNum(1e4*a.Damage);t.expLab.string=n+"/"+s;var o=game.ResCfg.getUrl(10222,a.Icon);this.box.loadTexture(o)},onShow:function(){var e=this.skin;e.round.string="0/"+game.playBack.options.maxRound;var t=game.playBack.copyType;e.damge.string="S0",e.damge.active=t==game.InstanceType.GUILD_INS,e.guildNewBossNode.active=t==game.InstanceType.GUILD_NEW_BOSS,t==game.InstanceType.GUILD_NEW_BOSS&&this.showguildNewBossDamge(0);var a=game.playBack.speed[0],i=game.playBack.speed[1],n=i<a;e.speed0_0.setVisible(n),e.speed1_0.setVisible(!n),e.speed0_1.setVisible(!n),e.speed1_1.setVisible(n),e.spLab0.string=game.Lang.get(51532,a),e.spLab1.string=game.Lang.get(51533,i);var s=e.ownElemFettersBtn,o=game.playBack.getElementMaxNum(!0);o?s.loadTexture(game.ResCfg.getUrl(10195,o.id)):s.loadTexture(game.ResCfg.getUrl(10195,1)),s=e.otherElemFettersBtn,(o=game.playBack.getElementMaxNum(!1))?s.loadTexture(game.ResCfg.getUrl(10194,o.id)):s.loadTexture(game.ResCfg.getUrl(10194,1))},onStageResize:function(){var e=b8e.stageHeight,t=b8e.stageWidth;this.setPosition(t>>1,e-170);var a=this.skin;a.bg.width=b8e.stageWidth;var i=b8e.stageWidth>>1;a.speed0_0.x=-i,a.speed1_0.x=-i,a.otherElemFettersBtn.x=-i,a.speed0_1.x=i,a.speed1_1.x=i,a.ownElemFettersBtn.x=i}});b8e.module.registerView(game.ME.PlayBackRound,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_DAMAGE_INFO:-1,C2V_SKILL_RELEASE:-1,C2V_SKILL_HIT:-1,V_FOLLOW_CHAT:-1}),b8e.RC("$$game","$$PublicBossBattleEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_ITEM:-1,C2V_UPDATE_VIEW:-1,V2C_CHALLAGE:-1,V2C_REBIRTH:-1,V2C_KILL_LOG:-1,V2C_DAMAGE_LOG:-1,V2C_SYSNINFO:-1,C2C_BATTLE_RESULT:-1,C2C_KILL_LOG:-1,C2C_DAMAGE_LOG:-1,C2C_UPDATE_FINISH_COUNT:-1,V2C_SHOWBUBBLE:-1,C2C_SHOWBUBBLE:-1}),b8e.RC("$$game","$$PublicBossEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_ITEM:-1}),b8e.RC("$$game","$$PublicBossLogViewEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SET_IGNORE:-1,C2V_SET_IGNORE:-1}),b8e.RC("$$game","$$PublicBossSettingEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_BUY_CHALLAGE:-1}),b8e.RC("$$game","$$PublicBossVipEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={PublicBoss:{C2C_BATTLE_RESULT:this.onBattleResult}},this.gevts={InstanceEvts:{G_STOP_PLAY:this.onBattleOver,G_SKILL_HIT:this.onSkillHit}}},onSkillHit:function(e){if(b8e.module.isShowView(game.ME.PublicBossBattle)){var a=e.data;a&&a.roleData.type==game.RoleType.Monster&&game.MonsterCfg.getDataAsync(a.roleId,function(e){if(e&&1==e.type){var t=game.publicBossData.battleResult.emulator;game.publicBossData.selfDamage.damage+=a.value,this.doRank(t),this.send(this.Evts.C2V_SKILL_HIT,a)}else;},this)}else;},onBattleResult:function(e){var t=e?e.data:null;t&&this.send(this.Evts.C2V_DAMAGE_INFO,t)},onBattleOver:function(e){if(e&&e.data&&e.data.type==game.InstanceType.PUBLIC_BOSS){var t=game.publicBossData;t.setBossHp(t.battleResult)}},doRank:function(e){if(e){e.sort(function(e,t){return t.damage-e.damage});for(var t=0,a=e.length;t<a;t++){e[t].rank=t+1}}else;},btn_skip:function(){game.playBack.stop()}});b8e.module.registerControl(game.ME.PublicBossBattle,e,game.PublicBossBattleEvts,null)}(),function(){var e=game.Control.extends({init:function(){this.bossData=game.publicBossData,this.bossData.init(),this.chat={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"quanmin_relive",funcType:game.ChatFuncType.CHAT_FUNC_QUANMIN_BOSS}},ipc:function(){var e=this;e.evts={MainRole:{C_LEVEL_UP:e.onRoleLvUp},Instance:{SYNC_INSTANCE_DATA:e.onSyncInstanceData},PublicBossVip:{C2C_BUY_CHALLAGE:e.onBuyChallage}},e.handels={QuanMinChallengeResp:e.onQuanMinChallengeRsp,QuanMinInfoResp:e.onQuanMinInfoRsp,QuanMinBuyResp:e.onQuanMinBuyRsp,QuanMinReliveResp:e.onQuanMinReliveRsp,QuanMinMsg:e.onQuanMinMsg}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.QuanMinInfoReq()},notify:function(e,t){var a=this;switch(e){case a.Evts.V2C_CHALLAGE:if(!game.playBack.isInstanceFighting()&&!game.sceneData.isGuildMap()){this.sender.QuanMinChallengeReq(t)}break;case a.Evts.V2C_REBIRTH:a.sender.QuanMinReliveReq(t);break;case a.Evts.V2C_KILL_LOG:a.onClickKillLog(t);break;case a.Evts.V2C_DAMAGE_LOG:a.onClickDamageLog(t);break;case a.Evts.V2C_SYSNINFO:a.sender.QuanMinInfoReq();break;case a.Evts.V2C_SHOWBUBBLE:a.showBubble(t)}},checkAlert:function(){},showBubble:function(e){this.maxBoss||(this.maxBoss=e.challengeLv),this.maxBoss<=e.challengeLv&&(this.maxBoss=e.challengeLv,this.dpt(this.Evts.C2C_SHOWBUBBLE,e))},onClickKillLog:function(e){var t=this.bossData&&this.bossData.killRecords?this.bossData.killRecords.get(e):null;if(t)this.dpt(this.Evts.C2C_KILL_LOG,t);else{b8e.warn("\u5168\u6c11BOSS\u6b7b\u4e86\uff0c\u5c45\u7136\u6ca1\u6709\u51fb\u6740\u8bb0\u5f55\uff01\uff01\uff01")}},onClickDamageLog:function(e){var t=this.bossData&&this.bossData.damageInfos?this.bossData.damageInfos.get(e):null;this.dpt(this.Evts.C2C_DAMAGE_LOG,t)},btn_setting:function(){game.module.show(game.ME.PublicBossSetting)},btn_buy:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e),a=t?t.quanMin:0,i=a-game.publicBossData.buyTimes;i=0<=i?i:0;for(var n,s=game.CostCfg.getDatasByType(game.CostType.PUBLIC_BOSS,!0),o=0,r=s.length;o<r;o++){if((n=s[o]).num==game.publicBossData.buyTimes+1){break}}var g="",l=0;if(n&&n.items&&n.items.length){var c=game.ItemInfoCfg.getData(n.items[0].Id);g=c?c.name:"",l=n.items[0].Num}game.alert.show({lang:519,langArgs:[l,g,1,i,e,a],btn:game.Lang.get(9146),okcb:this.onBuyChallage,thisArg:this})},onBuyChallage:function(){this.sender.QuanMinBuyReq()},onSyncInstanceData:function(e){if(e&&e.data&&this.bossData){var t=e.data;this.bossData.setCount(t.quanminCount),this.bossData.buyTimes=t.quanMinBuyTimes,this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT)}else;},onRoleLvUp:function(){if(this.bossData)this.bossData.createBossInfos(),this.send(this.Evts.C2V_UPDATE_ITEM);else;},onQuanMinChallengeRsp:function(e){var t=e.readProtobuf(game.pb.QuanMinChallengeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{this.bossData.setBattleResult(t),this.bossData.addCount(),this.runTokenTimer(),game.InsFunCountData.addChallengeCount(game.InsFunCountType.QUANMININS),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT);var a=this.bossData.battleResult;a.battlelog.win=!0;var i={type:game.InstanceType.PUBLIC_BOSS,rewards:a.useritem,exp:a.exp};game.playBack.play(a.battlelog,i),this.dpt(this.Evts.C2C_BATTLE_RESULT,a)}},onQuanMinInfoRsp:function(e){var t=e.readProtobuf(game.pb.QuanMinInfoResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.bossData.setup(t),this.runTokenTimer(),this.runBossTimer(),this.send(this.Evts.C2V_UPDATE_VIEW),this.checkAlert()},createTokenTimer:function(){if(this.tokenTimer);else this.tokenTimer=b8e.Timer.add(this,this.updateTokenTime,1e3),this.tokenTimer.start()},clearTokenTimer:function(){if(this.tokenTimer)b8e.Timer.remove(this,this.updateTokenTime),this.tokenTimer=null;else;},runTokenTimer:function(){if(0<this.bossData.recoverTime){this.createTokenTimer()}else this.clearTokenTimer()},createBossTimer:function(){if(this.bossTimer);else this.bossTimer=b8e.Timer.add(this,this.updateBossTime,1e3),this.bossTimer.start()},clearBossTimer:function(){if(this.bossTimer)b8e.Timer.remove(this,this.updateBossTime),this.bossTimer=null;else;},runBossTimer:function(){if(this.bossData.isCountdown){this.createBossTimer()}else this.clearBossTimer()},updateTokenTime:function(){if(this.bossData.recoverTime<=0){if(!(this.bossData.challage<10))return this.bossData.recoverTime=0,void this.clearTokenTimer();var e=game.InstanceMiscCfg.getData("quanMinRecover"),t=e?e.value:0;this.bossData.recoverTime=t*b8e.TimeUtil.MINUTE_MICRO_SECONDS}if(this.bossData.recoverTime-=b8e.TimeUtil.SECOND_MICRO_SECONDS,this.bossData.recoverTime<=0){this.bossData.challage++}},updateBossTime:function(){if(this.bossData.bossInfos){var a,i=0;if(this.bossData.bossInfos.forEach(function(e,t){if(0<t.reliveTime){a=t.reliveTime-b8e.TimeUtil.SECOND_MICRO_SECONDS,t.reliveTime=0<=a?a:0,i++}},this),i<1){this.clearBossTimer()}}else;},onQuanMinBuyRsp:function(e){var t=e.readProtobuf(game.pb.QuanMinBuyResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.module.hide(game.ME.PublicBossVip),this.bossData.challage=t.times,this.bossData.recoverTime=t.recoverTime,this.bossData.buyTimes=t.buyTimes,this.runTokenTimer(),this.send(this.Evts.C2V_UPDATE_VIEW),this.checkAlert()},onQuanMinReliveRsp:function(e){var t=e.readProtobuf(game.pb.QuanMinReliveResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.sender.QuanMinChallengeReq(t.bossId)},onQuanMinMsg:function(e){var t=e.readProtobuf(game.pb.QuanMinNotify);if(0<t.code){game.notice.noticeError(t.code)}else{if(!game.publicBossSettingData.isIgnore(t.bossId)&&game.moduleOpen.checkOpen(this.moduleEnum)){if(t.reliveTime<1){this.addChatItem(t.roleName,t.bossId)}}game.publicBossData.rebirthBoss(t.bossId,t.reliveTime),this.runBossTimer(),this.send(this.Evts.C2V_UPDATE_ITEM),this.checkAlert()}},addChatItem:function(e,t){this.chat.roleName=e,this.chat.params=""+t,game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.EQUIP_SHOP)}}),t=game.Sender.extends({ipc:function(){this.msg={QuanMinInfoReq:null,QuanMinBuyReq:null,QuanMinChallengeReq:this.quanMinChallengeReq,QuanMinReliveReq:this.quanMinReliveReq,QuanMinSetNoticeReq:this.quanMinSetNoticeReq}},quanMinChallengeReq:function(e){var t=game.pb.QuanMinChallengeRequest;t.bossId=e,this.write(t)},quanMinReliveReq:function(e){var t=game.pb.QuanMinReliveRequest;t.bossId=e,this.write(t)},quanMinSetNoticeReq:function(e,t){var a=game.pb.QuanMinSetNoticeRequest;a.bossId=e,a.ignore=t,this.write(a)}});b8e.module.registerControl(game.ME.PublicBoss,e,game.PublicBossEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={PublicBoss:{C2C_DAMAGE_LOG:this.onClickLog}}},onClickLog:function(e){game.module.show(game.ME.PublicBossDamageView),this.send(game.PublicBossLogViewEvts.C2V_UPDATE_ITEM,e.data)}});b8e.module.registerControl(game.ME.PublicBossDamageView,e,game.PublicBossLogViewEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={PublicBoss:{C2C_KILL_LOG:this.onClickLog}}},onClickLog:function(e){game.module.show(game.ME.PublicBossLog);var t=e.data;if(!t||t.length<=0);else{var a=0;t.forEach(function(e){e.index=a,a++},this),this.send(game.PublicBossLogViewEvts.C2V_UPDATE_ITEM,t)}}});b8e.module.registerControl(game.ME.PublicBossLog,e,game.PublicBossLogViewEvts,null)}(),function(){var e=game.Control.extends({init:function(){game.publicBossSettingData.init()},ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.onSyncInstanceData},MainRole:{C_LEVEL_UP:this.onRoleLvUp}},this.handels={QuanMinSetNoticeResp:this.onQuanMinSetNoticeRsp}},notify:function(e,t){switch(e){case game.PublicBossSettingEvts.V2C_SET_IGNORE:this.sender.QuanMinSetNoticeReq(t.bossId,!t.ignore)}},onRoleLvUp:function(){game.publicBossSettingData.createSettingInfo()},onSyncInstanceData:function(e){var t=e&&e.data?e.data.quanMinIgnoreList:null;if(!t||t.length<=0);else t.forEach(function(e){game.publicBossSettingData.setIgnoreById(e,!0)},this)},onQuanMinSetNoticeRsp:function(e){var t=e.readProtobuf(game.pb.QuanMinSetNoticeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.publicBossSettingData.setIgnoreById(t.bossId,t.ignore),this.send(game.PublicBossSettingEvts.C2V_SET_IGNORE)}}),t=game.Sender.extends({ipc:function(){this.msg={QuanMinSetNoticeReq:this.quanMinSetNoticeReq}},quanMinSetNoticeReq:function(e,t){var a=game.pb.QuanMinSetNoticeRequest;a.bossId=e,a.ignore=t,this.write(a)}});b8e.module.registerControl(game.ME.PublicBossSetting,e,game.PublicBossSettingEvts,t)}(),function(){var e=game.Control.extends({sureBtn:function(){this.dpt(game.PublicBossVipEvts.C2C_BUY_CHALLAGE)}});b8e.module.registerControl(game.ME.PublicBossVip,e,game.PublicBossVipEvts,null)}(),function(){var e;e=b8e.Object.extends({roleId:0,roleName:0,damage:0,rank:0,setData:function(e){if(e)this.roleId=e.roleId,this.rank=e.rank,this.roleName=e.roleName,this.damage=e.damage;else;}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PublicBossDamageInfo",e)}(),function(){var e=b8e.Object.extends({victoryCount:0,_bossInfos:null,ctor:function(){this._super(),this.killRecords=b8e.HashMap.get(),this.damageInfos=b8e.HashMap.get(),this.buyTimes=0,this.isCountdown=!1,this.battleResult=null},init:function(){},setup:function(e){e&&(this.bossDatas=e.infos,this.challage=e.challenge,this.recoverTime=e.recoverTime,this.updateBossDatas())},updateBossDatas:function(){if(!this.bossDatas||this.bossDatas.length<1);else this.isCountdown=!1,this.bossDatas.forEach(function(e){if(this.checkBossCanShow(e.bossId)){this.updateBossInfo(e.bossId,e)}},this)},bossInfos:{get:function(){if(this._bossInfos){return this._bossInfos}return this._bossInfos=b8e.HashMap.get(),this._initBossInfos(this._bossInfos),this._bossInfos}},_initBossInfos:function(t){if(t){var a,e=game.PublicBossCfg.getDatas();if(e)e.forEach(function(e){if(this.checkBossCanShow(e.id)){if(!(a=t.get(e.id))){a=new game.PublicBossInfo(e.id),t.set(e.id,a)}a.setData()}else;},this);else;}else;},createBossInfos:function(){this._initBossInfos(this.bossInfos)},updateBossInfo:function(t,e){if(this.bossInfos){var a=this.bossInfos.get(t);if(!a){a=new game.PublicBossInfo(t),this.bossInfos.set(t,a)}if(a.setData(e),0<a.reliveTime){this.isCountdown=!0}if(e.record&&0<e.record.length){e.record.forEach(function(e){this.updateKillRecord(t,e)},this)}else this.clearKillRecord(t);if(e.emulator&&0<e.emulator.length){e.emulator.forEach(function(e){this.updateDamageInfo(t,e)},this)}else this.clearDamageInfo(t)}else;},updateKillRecord:function(e,t){if(this.killRecords){var a=this.killRecords.get(e);if(!a){a=[],this.killRecords.set(e,a)}for(var i=0,n=a.length;i<n;i++){if((s=a[i]).roleId==t.roleId&&s.time==t.time){break}s=null}if(!s){var s=new game.PublicBossKillRecord;a.push(s)}s.setData(t)}else;},clearKillRecord:function(e){if(this.killRecords)this.killRecords.del(e);else;},updateDamageInfo:function(e,t){if(this.damageInfos){var a,i=this.damageInfos.get(e);if(!i){i=[],this.damageInfos.set(e,i)}for(var n=0,s=i.length;n<s;n++){if((a=i[n]).roleId==t.roleId){break}a=null}if(!a){a=new game.PublicBossDamageInfo,i.push(a)}a.setData(t)}else;},clearDamageInfo:function(e){if(this.damageInfos)this.damageInfos.del(e);else;},checkBossCanShow:function(e){var t=game.PublicBossCfg.getData(e);if(t)return game.mainRoleData.lv>=t.showLv;return!1},getBossDataById:function(e){if(!this.bossDatas){return null}for(var t,a=this.bossDatas,i=a.length-1;0<i;i--){if((t=a[i]).bossId==e){return t}}return null},rebirthBoss:function(e,t){var a=this.getBossDataById(e);if(a){a.reliveTime=t}this.isCountdown=!1;var i=this.bossInfos?this.bossInfos.get(e):null;if(i){if(t<=0){i.setData()}else if(i.hp=-1,i.hp=0,i.reliveTime=t-game.SysTime.curTime,0<i.reliveTime){this.isCountdown=!0}}},setBossHp:function(e){var t=this.bossInfos?this.bossInfos.get(e.bossId):null;if(t){t.hp=-1,t.hp=0<=e.hp?e.hp:0}},setBattleResult:function(t){if(t){this.battleResult=t,this.challage=t.challenge,this.challageBossHp=t.hp0,this.recoverTime=t.recoverTime;var e=t.emulator;if(e&&0<e.length){e.forEach(function(e){this.updateDamageInfo(t.bossId,e)},this);for(var a=game.mainRoleData.id,i=-1,n=0,s=e.length;n<s;n++){if(e[n].roleId==a){i=n;break}}if(i<0){e.push(t.ownDamage)}else e[i]=t.ownDamage;this.selfDamage=t.ownDamage,this.doRank(e)}else this.clearDamageInfo(t.bossId)}else;},doRank:function(e){if(e){e.sort(function(e,t){return t.damage-e.damage});for(var t=0,a=e.length;t<a;t++){e[t].rank=t+1}}else;},setCount:function(e){this.victoryCount=e},getCount:function(){return this.victoryCount},addCount:function(e){var t=0<arguments.length&&void 0!==e?e:1;this.victoryCount+=t}});game.publicBossData=game.publicBossData||new e}(),function(){var e,t=e=b8e.Object.extends({bossId:0,hp:0,isEnterShow:!1,ctor:function(e){this._super(),this.bossId=e},setData:function(e){var t=this.getCfg(),a=game.mainRoleData.lv;if(this.challengeLv=t.challengeLv,e&&a>=t.challengeLv){if(this.reliveTime=e.reliveTime-game.SysTime.curTime,e.reliveTime<=0){this.hp=e.hp}else this.hp=this.reliveTime<0?t.hp:e.hp}else this.hp=t.hp,this.reliveTime=0;this.isEnterShow=a>=t.challengeLv},getCfg:function(){return game.PublicBossCfg.getData(this.bossId)}});b8e.BindingUtil.bind(t),t.poolCall=!0,b8e.RC("$$game","$$PublicBossInfo",e)}(),function(){var e;e=b8e.Object.extends({time:0,roleId:0,roleName:0,power:0,setData:function(e){if(e)this.time=e.time,this.roleId=e.roleId,this.roleName=e.roleName,this.power=e.power;else;}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PublicBossKillRecord",e)}(),function(){var e=b8e.Object.extends({_settings:null,settings:{get:function(){if(this._settings){return this._settings}return this._settings=b8e.HashMap.get(),this._initSettingInfo(this._settings),this._settings}},_initSettingInfo:function(t){var e=game.PublicBossCfg.getDatas();if(!e||e.length<1);else{var a,i=0,n=game.mainRoleData.lv;e.forEach(function(e){if(n<e.challengeLv);else{if(!(a=t.get(e.id))){a=new game.PublicBossSettingInfo(e.id),t.set(e.id,a)}a.setData(e),a.index=i,i++}},this)}},createSettingInfo:function(){this._initSettingInfo(this.settings)},init:function(){},setIgnoreById:function(e,t){var a=this.settings?this.settings.get(e):null;if(a)a.ignore=t;else;},isIgnore:function(e){var t=this.settings?this.settings.get(e):null;if(t)return t.ignore;return!0},getDatas:function(){return this.settings?this.settings.values():null}});game.publicBossSettingData=game.publicBossSettingData||new e}(),function(){var e;e=b8e.Object.extends({bossId:0,ignore:!1,index:0,name:"",lv:0,ctor:function(e){this._super(),this.bossId=e},setData:function(e){if(e)this.name=e.name,this.lv=e.challengeLv;else;},getCfg:function(){return game.PublicBossCfg.getData(this.bossId)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PublicBossSettingInfo",e)}(),function(){var e=game.View.extends({_specialLayer:!0,_isMoveUp:!1,ctor:function(){this._super(444),this.MaxHp=0,this.Hp=0,this.proWidth=435,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.C2V_DAMAGE_INFO:this.updateDamageInfo(t);break;case this.Evts.C2V_SKILL_HIT:this.onSkillHit(t)}},updateDamageInfo:function(e){if(!e){return this.skin.lab_rank.node.active=!1,void(this.skin.lab_mine.node.active=!1)}this.skin.lab_rank.node.active=!0,this.skin.lab_mine.node.active=!0,this.setBossHp(e.bossId),this.skin.lab_rank.string=this.getDamageInfoStr(e.emulator),this.skin.lab_mine.string=this.getSelfDamageInfoStr(e.ownDamage)},setBossHp:function(e){var t=game.PublicBossCfg.getData(e);if(t)this.MaxHp=t.hp,this.setHp(game.publicBossData.challageBossHp);else;},setHp:function(e){this.Hp=0<=e?e:0,this.setBossHpProgress()},setBossHpProgress:function(){this.skin.lab_progress.string=this.Hp+"/"+this.MaxHp,this.skin.img_progress.node.width=this.proWidth*(this.Hp/this.MaxHp)},getSelfDamageInfoStr:function(e){if(!e||e.damage<1){return""}var t=game.CCommonUtil.replaceNum(Math.min(this.MaxHp,e.damage),0);return game.Lang.get(517,e.rank,e.roleName,t)},getDamageInfoStr:function(e){if(!e||e.length<1){return""}for(var t,a="",i=0,n=0,s=e.length;n<s;n++){if(0<(t=e[n]).damage){var o=game.CCommonUtil.replaceNum(Math.min(this.MaxHp,t.damage),0);a+=game.Lang.get(517,t.rank,t.roleName,o),i++}if(3<i){break}}return a},onShow:function(){this.updateDamageInfo(game.publicBossData.battleResult),this.onStageResize()},onSkillHit:function(e){this.setHp(this.Hp-e.value);var t=game.publicBossData.battleResult.emulator,a=game.publicBossData.selfDamage;this.skin.lab_rank.string=this.getDamageInfoStr(t),this.skin.lab_mine.string=this.getSelfDamageInfoStr(a)},onStageResize:function(){var e=b8e.stageHeight,t=b8e.stageWidth;this.skin.rank_bg.setPosition(t,e-1045),this.setPosition(0,this.height+130)}});b8e.module.registerView(game.ME.PublicBossBattle,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(445),this.setSize(540,94)},setData:function(){var e=this.data;if(e){var t=e.rank+1;this.skin.lab_name.string=e.roleName,this.skin.lab_power.string=e.damage;for(var a=1;a<4;a++){this.getComponent("rank"+a).node.active=t==a}if(3<t){this.skin.lab_time.string=t,this.skin.rank4.active=!0}else this.skin.lab_time.string="",this.skin.rank4.active=!1}else;}}),b8e.RC("$$game","$$PublicBossDamageItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(446)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.PublicBossDamageItem,this._list.bindEnum=game.ME.PublicBossDamageView,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)},onShow:function(){this.skin.labTitle.string=game.Lang.get(520),this.skin.lab_item_title1.string=game.Lang.get(9147),this.skin.lab_item_title2.string=game.Lang.get(9148),this.skin.lab_item_title3.string=game.Lang.get(9149)},notify:function(e,t){switch(e){case game.PublicBossLogViewEvts.C2V_UPDATE_ITEM:this.updateItem(t)}},updateItem:function(e){if(e){if(1<e.length){e.sort(function(e,t){return t.damage-e.damage})}for(var t=0;t<e.length;t++){e[t].rank=t}}this._list.setData(e)}});b8e.module.registerView(game.ME.PublicBossDamageView,e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(863),this.setSize(600,260),this.bossId=0},init:function(){var e=this;e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList.itemRender=game.ShowItemListItem,e._prizeList.layout.paddingTop=10,e._prizeList.layout.spacingX=17,e._prizeList.layout.paddingLeft=-10,e._prizeList.addToParent(e.skin.node_prize),e._costGrid=game.GridUtil.createItemIcon(game.IconSizeEnum.GRID_SIZE_69),e._costGrid.addToParent(e.skin.node_cost),e._model=b8e.SceneEntity.get(),e._model.addToParent(e.skin.model_root),e.progressWidth=e.skin.img_progress.node.width,e.skin.item_bg.loadTexture(game.ResCfg.getUrl(10070))},btn_enter:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){var e=this.bossData;e&&(e.reliveTime<=0?this.send(game.PublicBossEvts.V2C_CHALLAGE,e.bossId):this.send(game.PublicBossEvts.V2C_REBIRTH,e.bossId))}},btn_log:function(){this.bossData&&this.send(game.PublicBossEvts.V2C_KILL_LOG,this.bossData.bossId)},lab_count:function(){this.bossData&&this.send(game.PublicBossEvts.V2C_DAMAGE_LOG,this.bossData.bossId)},setData:function(e){var t=this;t.bossData=e,t.bossData&&(t.bossCfg=t.bossData.getCfg(),t.bossCfg&&(game.CfgUtil.getMonsterCfgByMonGroup(t.bossCfg.monGroup,1,function(e){t.setElementBtn(e)},t),t.setBossName(),t.setModel(),t.createPrize(),t.setProgress(),t.setBossStates()))},setBossName:function(){if(this.bossCfg){var e=game.Lang.get(9562,this.bossCfg.name,this.bossCfg.challengeLv);this.skin.lab_boss_name.string=game.HtmlUtil.getColorStrByQuality(this.bossCfg.quality,e)}},setProgress:function(){var e=this;if(e.bossData&&e.bossCfg){var t=e.bossCfg.hp,a=e.bossData.hp,i=a/t;e.skin.img_progress.node.width=e.progressWidth*i,e.skin.lab_progress.string=(1<=i?100:(100*i).toFixed(1))+"%";var n=0<a;e.skin.img_progress.node.active=n,e.skin.progress_bar_bg.node.active=n,e.skin.lab_progress.node.active=n}},setBossStates:function(){var e=this;if(e.bossData&&e.bossData.bossId){var t=game.mainRoleData.lv>=e.bossCfg.challengeLv;e.skin.lab_open.node.active=!t,e.skin.btn_enter.node.active=t,e.skin.lab_open.string=game.Lang.get(514,e.bossCfg.challengeLv);var a=0<e.bossData.reliveTime&&t;if(a?(e.skin.lab_enter.string=game.Lang.get(512),e.skin.lab_rebirth_time.string=game.Lang.get(513,b8e.TimeUtil.formatTime(e.bossData.reliveTime)),e.setRebirthCost(),e.setRebirthTime()):e.skin.lab_enter.string=game.Lang.get(9190),e.skin.node_rebirth.active=a,e.skin.lab_count.node.active=!a,e.skin.btn_log.node.active=a,t){var i=game.publicBossData&&game.publicBossData.damageInfos?game.publicBossData.damageInfos.get(e.bossData.bossId):null,n=i?i.length:0;e.skin.lab_count.string=game.Lang.get(518,n)}}},setRebirthCost:function(){var e=this.bossCfg.reliveCost;!e||e.length<1||(this.costItemInfo=game.ItemUtil.createBaseItemInfo(e[0].Id,e[0].Num,this.costItemInfo),game.GridUtil.setItemIcon(this._costGrid,this.costItemInfo,!1,0))},setRebirthTime:function(){this.rebirthTimer||(this.rebirthTimer=b8e.Timer.add(this,this.updateTime,1e3)),this.rebirthTimer.reset(),this.rebirthTimer.start()},updateTime:function(){var e=this;e.bossData&&null!=e.bossData.reliveTime&&(e.skin.lab_rebirth_time.string=game.Lang.get(513,b8e.TimeUtil.formatTime(e.bossData.reliveTime)),e.bossData.reliveTime<=0&&(e.rebirthTimer.stop(),e.setBossStates(),e.bossCfg&&!game.publicBossSettingData.isIgnore(e.bossData.bossId)&&e.send(game.PublicBossEvts.V2C_SHOWBUBBLE,e.bossCfg)))},clearData:function(){},setModel:function(){var e=this;if(e.bossData&&e.bossId!==e.bossData.bossId){if(e.bossId=e.bossData.bossId,!e.bossId)return void b8e.warn("bossId: ",e.bossId);var t=game.AvatarUtil.getUIModel(e.bossCfg),a=e.bossCfg?game.ResCfg.getUrl(5e3,t):null,i=e._model.getAnimator(game.AnimType.BODY,1);(i=i||e._model.addAnimator(game.AnimType.BODY,1))&&(a?(i.load(a),i.play()):i.clear())}},createPrize:function(){if(this.bossCfg){var e=this.bossCfg.showItems,t=game.CfgUtil.getPrizeListInfo(e,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);this._prizeList.setData(t.items)}},onHide:function(){},setElementBtn:function(e){var t=this.skin;e&&e.element?(this.elementAttr=e.element,t.view_elementBtn.active=!0,t.view_elementBtn.loadTexture(game.ResCfg.getUrl(10050,e.element))):t.view_elementBtn.active=!1},view_elementBtn:function(){this.elementAttr&&(game.elementData.setElementInfo(this.elementAttr,50369,this.skin.view_elementBtn.localToGlobal(),!1),game.module.show(game.ME.ElementAttr))}})).poolCall=!0,b8e.RC("$$game","$$PublicBossItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(448),this.setSize(540,68)},setData:function(){var e=this.data;if(e)this.skin.lab_time.string=b8e.TimeUtil.formatTimestamp(e.time,"h:m:s"),this.skin.lab_name.string=e.roleName,this.skin.lab_power.string=e.power;else;}}),b8e.RC("$$game","$$PublicBossLogItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(446)},init:function(){if(!this._list){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.PublicBossLogItem,this._list.bindEnum=game.ME.PublicBossLog,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)}},notify:function(e,t){switch(e){case game.PublicBossLogViewEvts.C2V_UPDATE_ITEM:this.updateItem(t)}},updateItem:function(e){if(!this._list||!e||e.length<=0);else this._list.setData(e)}});b8e.module.registerView(game.ME.PublicBossLog,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(449),this.setSize(540,68)},setData:function(){var e=this.data;if(e)this.skin.lab_name.string=e.name,this.skin.lab_lv.string=e.lv,this.skin.autpBg_2.node.active=!e.ignore;else;},btn_ignore:function(){this.send(game.PublicBossSettingEvts.V2C_SET_IGNORE,this.data)}}),b8e.RC("$$game","$$PublicBossSettingItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(450)},init:function(){if(!this._list){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.PublicBossSettingItem,this._list.bindEnum=game.ME.PublicBossSetting,this._list.layout.paddingLeft=2,this._list.layout.paddingRight=0,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)}},onShow:function(){this.updateItem()},updateItem:function(){var e=game.publicBossSettingData.getDatas();if(!this._list||!e||e.length<1);else this._list.setData(e)},notify:function(e){switch(e){case game.PublicBossSettingEvts.C2V_SET_IGNORE:this.updateItem()}}});b8e.module.registerView(game.ME.PublicBossSetting,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(864),this.spotAlerts={SHOP_PUBLIC:this.shopAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},init:function(){if(!this._list){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.PublicBossItemView,this._list.bindEnum=game.ME.PublicBoss,this._list.addToParent(this.skin.node_scrollview)}this.bossData=game.publicBossData},onShow:function(){this.send(this.Evts.V2C_SYSNINFO)},updateChallage:function(){var e=this;if(0<e.bossData.recoverTime){if(!this.rebirthTimer){this.rebirthTimer=b8e.Timer.add(this,this.updateTime,1e3)}this.rebirthTimer.reset(),this.rebirthTimer.start()}var t=game.InstanceMiscCfg.getData("quanMinBuy"),a=t?t.value:0;t=game.InstanceMiscCfg.getData("quanMinMax"),e.quanMinMax=t?t.value:0,e.skin.lab_recover_time.string=game.Lang.get(516,b8e.TimeUtil.formatTime(e.bossData.recoverTime)),e.skin.lab_count.string=game.Lang.get(515,e.bossData.challage,e.quanMinMax),e.skin.btn_buy.node.active=e.bossData.challage<=e.quanMinMax-a},updateTime:function(){if(this.skin.lab_recover_time.string=game.Lang.get(516,b8e.TimeUtil.formatTime(this.bossData.recoverTime)),this.bossData.recoverTime<=0){this.updateChallage()}if(this.bossData.challage>=this.quanMinMax){this.rebirthTimer.stop()}},updateBossItem:function(){if(this._list){var e=game.publicBossData&&game.publicBossData.bossInfos?game.publicBossData.bossInfos.values():null;e.sort(this.onSort),this._list.setData(e)}else;},onSort:function(e,t){return e.isEnterShow==t.isEnterShow?e.reliveTime<=0&&t.reliveTime<=0?t.challengeLv-e.challengeLv:0<e.reliveTime?1:-1:e.isEnterShow?-1:1},notify:function(e){switch(e){case game.PublicBossEvts.C2V_UPDATE_ITEM:this.updateBossItem();break;case game.PublicBossEvts.C2V_UPDATE_VIEW:this.updateChallage(),this.updateBossItem()}},$$getInstEnterBtn:function(e){if(!(this._list&&this._list._container&&this._list._container._layoutContent&&this._list._container._layoutContent[e]))return null;var t=this._list._container._layoutContent[e].skin;return t?t.btn_enter:null},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.PublicBoss,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(453)},onShow:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e),a=t?t.quanMin:0,i=a-game.publicBossData.buyTimes;i=0<=i?i:0;for(var n,s=game.CostCfg.getDatasByType(game.CostType.PUBLIC_BOSS,!0),o=0,r=s.length;o<r;o++){if((n=s[o]).num==game.publicBossData.buyTimes+1){break}}var g="",l=0;if(n&&n.items&&n.items.length){var c=game.ItemInfoCfg.getData(n.items[0].Id);g=c?c.name:"",l=n.items[0].Num}this.skin.lab_tips.string=game.Lang.get(519,l,g,3,i,e,a)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+100;this.setPosition(e,t)}});b8e.module.registerView(game.ME.PublicBossVip,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_SELECT_BTN:-1,V2C_SELECT_BTN:-1,C2V_UPDATE_RECHARGE:-1,V2C_RECEICE_AWARD:-1,C2V_UPDATE_RECHARGE_NUM:-1,C2V_RESET_DAILY:-1}),b8e.RC("$$game","$$QuanminPurchaseEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.purchaseSpotAlert=game.spotAlert.set(game.SAE.PURCHASE_ALERT,game.SAE.OPEN_SERVER_ALERT)},ipc:function(){this.evts={OpenServer:{C2C_INIT_OPENSERVER:this.initOpenServer},Recharge:{C_INIT_MODEL:this.syncRechargeModel,C_RECHARGE_SUCCESS:this.rechargeSuccess,C2C_RESET_RECHARGE:this.resetDaily},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={QuanMinPurchaseMsg:this.quanMinPurchaseMsg,QuanMinPurchaseAwardResp:this.quanMinPurchaseAwardResponse}},notify:function(e,t){var a=this,i=this.Evts;switch(e){case i.V2C_SELECT_BTN:a.selectBtn(t);break;case i.V2C_RECEICE_AWARD:a.receiveAwardReq(t)}},resetDaily:function(){game.moduleOpen.checkOpen(game.ME.QuanminPurchase)&&(game.qmPurchaseData.resetDaily(),this.updateQMPurchaseData(),this.changeOpenServer(),this.send(this.Evts.C2V_RESET_DAILY))},syncRechargeModel:function(){this.updatePurchaseInfo()},rechargeSuccess:function(){this.updatePurchaseInfo()},selectBtn:function(e){game.qmPurchaseData.setSelctInfo(e),this.send(this.Evts.C2V_SELECT_BTN,e)},updatePurchaseInfo:function(){game.qmPurchaseData.isOpenPurchase()&&(this.updateQMPurchaseData(),this.send(this.Evts.C2V_UPDATE_RECHARGE))},receiveAwardReq:function(e){this.sender.QuanMinPurchaseAwardReq(e)},changeOpenServer:function(){var e=game.QuanMinPurchaseCfg.getDatas(),t=!1;if(e&&0<e.length){var a=e[0];if(a){var i=game.miscData.openServerDay;t=i>=a.serverStart&&i<a.serverEnd}}this.obj={openServerType:game.OpenServerType.QUANMIN_PURCHASE,isActive:t,sae:game.SAE.PURCHASE_ALERT},this.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER,this.obj)},initOpenServer:function(e){if(game.qmPurchaseData.isOpenPurchase()){if(game.moduleOpen.checkOpen(game.ME.QuanminPurchase)){var t=e.data;if(t)this.changeOpenServer(),game.qmPurchaseData.setQuanMinPurchaseCollected(t.quanMinPurchaseCollected),game.qmPurchaseData.setQuanMinPurchaseNum(t.quanMinPurchase),this.updateQMPurchaseData();else;}}else;},updateQMPurchaseData:function(){game.qmPurchaseData.updateQMPurchaseData(),this.purchaseSpotAlert.alert=game.qmPurchaseData.isShowRedDot},quanMinPurchaseMsg:function(e){var t=e.readProtobuf(game.pb.QuanMinPurchaseNotify);t&&(game.qmPurchaseData.setQuanMinPurchaseNum(t.num),game.qmPurchaseData.isOpenPurchase()&&(this.updateQMPurchaseData(),this.send(this.Evts.C2V_UPDATE_RECHARGE_NUM)))},quanMinPurchaseAwardResponse:function(e){var t=e.readProtobuf(game.pb.QuanMinPurchaseAwardResponse);if(t)if(0<t.code){game.notice.noticeError(t.code)}else game.qmPurchaseData.setPurchaseCollected(t.id),this.updateQMPurchaseData();else;}}),t=game.Sender.extends({ipc:function(){this.msg={QuanMinPurchaseAwardReq:this.quanMinPurchaseAwardReq}},quanMinPurchaseAwardReq:function(e){var t=game.pb.QuanMinPurchaseAwardRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.QuanminPurchase,e,game.QuanminPurchaseEvts,t)}(),function(){var e;e=b8e.Object.extends({cfg:null,isGet:!1,isCanGet:!1,rechargeMoneyDaily:0,purchaseNum:0,updateInfo:function(){this.rechargeMoneyDaily=game.rechargeData.rechargeMoneyDaily,this.purchaseNum=game.qmPurchaseData.purchaseNum},setData:function(e){this.cfg=e,this.updateInfo()},getPrizeItems:function(){if(!this.cfg)return null;if(this.awards)return this.awards;var e,t,a=this.cfg.award,i=a.length;this.awards=[];for(var n=0;n<i;n++)e=a[n],t=game.ItemUtil.createBaseItemInfo(e.Id,e.Num),this.awards.push(t);return this.awards}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PurchaseInfo",e)}(),function(){var e;e=b8e.Object.extends({index:-1,condition:0,cfg:null,select:!1,isCanGet:!1,setData:function(e,t){this.index=e,this.condition=t.condition1,this.cfg=t}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PurchaseTitleInfo",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this.purchaseNum=0,this._purchaseCollecltedArr=[],this.isShowRedDot=!1,this.isFrist=!1},resetDaily:function(){this.purchaseNum=0,this._purchaseCollecltedArr.length=0},setQuanMinPurchaseNum:function(e){this.purchaseNum=e},setQuanMinPurchaseCollected:function(e){if(e&&!(e.length<1))for(var t=0,a=void 0,i=e.length;t<i;t++){a=e[t],this.setPurchaseCollected(a)}},setPurchaseCollected:function(e){this._purchaseCollecltedArr.push(e)},isReceive:function(e){return-1<this._purchaseCollecltedArr.indexOf(e)},setSelctInfo:function(e){this.selectInfo&&(this.selectInfo.select=!1);var t=game.QuanMinPurchaseCfg.getPurchaseTitleInfo(e);t&&((this.selectInfo=t).select=!0)},updateQMPurchaseData:function(){var o=this;o.isShowRedDot=!1;var e=game.QuanMinPurchaseCfg.getPurchaseInfoMap();e&&e.forEach(function(e,t){if(t&&0<t.length){for(var a=0,i=t.length,n=void 0,s=!1;a<i;a++)(n=t[a])&&(n.isGet=o.isReceive(n.cfg.id),n.updateInfo(),n.isGet||(o.getIsCanGet(n.cfg)?(s=n.isCanGet=!0,o.isShowRedDot=!0):n.isCanGet=!1));if(n=game.QuanMinPurchaseCfg.getPurchaseTitleInfo(+e)){n.isCanGet=s&&o.getIsCanGet(n.cfg)}}},o)},getIsCanGet:function(e){var t=game.rechargeData.rechargeMoneyDaily;return this.purchaseNum>=e.condition1&&t>=e.condition2},getEndTime:function(){if(0<this._endTime)return this._endTime;var e=game.QuanMinPurchaseCfg.getFirstCfg();if(!e)return 0;var t=e.serverStart,a=(e.serverEnd-t-(game.miscData.openServerDay-t))*b8e.TimeUtil.DAY_MICRO_SECONDS,i=game.SysTime.curTime,n=b8e.TimeUtil.getTodayTime(i);return this._endTime=n+a,this._endTime},isOpenPurchase:function(){var e=game.QuanMinPurchaseCfg.getFirstCfg();if(!e)return!1;var t=game.miscData.openServerDay;return t>=e.serverStart&&t<e.serverEnd}});game.qmPurchaseData=game.qmPurchaseData||new e}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(874),this.setSize(110,50)},init:function(){this.data&&0==this.data.index&&(game.qmPurchaseData.isFrist||(game.qmPurchaseData.isFrist=!0,this.btn()))},setData:function(){var e=this.skin;e.lab_num.string=game.Lang.get(3301,this.data.condition),e.btn_selected.node.active=this.data.select,e.redPoint.node.active=this.data.isCanGet},btn:function(){var e=this.data.condition;this.send(game.QuanminPurchaseEvts.V2C_SELECT_BTN,e)}}),b8e.RC("$$game","$$QuanminPurchaseTitleItem",e)}(),function(){var e=void 0;(e=game.ListItem.extends({ctor:function(){this._super(873),this.setSize(600,176)},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.prizeList),e.layout.spacingX=15},setData:function(){var e=this.skin,t=this.data,a=this.data.cfg,i=t.getPrizeItems();this.prizeList.setData(i),e.lab_desc.string=a.desc,e.btn_isGet.setVisible(t.isGet),e.btn_get.setVisible(!t.isGet&&t.isCanGet),e.btn_goto.setVisible(!t.isGet&&!t.isCanGet);if(0!=a.condition2){var n=a.condition2,s=t.rechargeMoneyDaily;e.lab_condition.string=game.Lang.get(n<=s?51904:51905,s,n)}else{var o=a.condition1,r=t.purchaseNum;e.lab_condition.string=game.Lang.get(o<=r?51901:51902,r,o)}},btn_goto:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},btn_get:function(){this.data&&this.send(game.QuanminPurchaseEvts.V2C_RECEICE_AWARD,this.data.cfg.id)}})).poolCall=!0,b8e.RC("$$game","$$QuanminPurchaseListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(875)},notify:function(e,t){var a=this;switch(e){case a.Evts.C2V_UPDATE_RECHARGE:case a.Evts.C2V_RESET_DAILY:a.updateInfo(),a.updateList(a._condition);break;case a.Evts.C2V_SELECT_BTN:a.updatePurchaseTitleList(),a.updateList(t);break;case a.Evts.C2V_UPDATE_RECHARGE_NUM:a.updateList(a._condition)}},init:function(){var e=this,t=e.skin;e.qmPurchaseData=game.qmPurchaseData,e._titleList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._titleList.itemRender=game.QuanminPurchaseTitleItem,e._titleList.bindEnum=e.moduleEnum,e._titleList.layout.spacingX=4,e._titleList.layout.paddingLeft=2,e._titleList.layout.paddingTop=-9,e._titleList.addToParent(t.titleList),e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.QuanminPurchaseListItem,e._list.bindEnum=e.moduleEnum,e._list.layout.paddingLeft=0,e._list.layout.paddingTop=0,e._list.layout.spacingY=5,e._list.addToParent(t.list)},onShow:function(){var e=this;e.updateInfo(),e._condition&&e.send(game.QuanminPurchaseEvts.V2C_SELECT_BTN,e._condition),e.updateQmPurchaseTime(),e._timeObj?(e._timeObj.reset(),e._timeObj.start()):e._timeObj=b8e.Timer.add(e,e.updateQmPurchaseTime,1e3),e._list.scrollToTop()},onHide:function(){this._timeObj&&this._timeObj.stop()},updateInfo:function(){this.updateRecharge(),this.updatePurchaseTitleList()},updateRecharge:function(){var e=game.qmPurchaseData.purchaseNum;this.skin.labRecharge.string=game.Lang.get(3302,e)},updateQmPurchaseTime:function(){var e=this.qmPurchaseData.getEndTime()-game.SysTime.curTime,t=game.TimeUtil.formatTimeSpace(e,3);this.skin.labTime.string=game.Lang.get(51903,t)},updatePurchaseTitleList:function(){var e=game.QuanMinPurchaseCfg.getPurchaseTitleList();this._titleList&&this._titleList.setData(e)},updateList:function(e){var t=game.QuanMinPurchaseCfg.getPuechaseList(e);this._condition||(this._condition=e),this._list&&this._list.setData(t)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.QuanminPurchase,e)}(),function(){var e;e=b8e.Enum({SELECT_TAB:-1,UPDATE_DATA:-1,GET_RANK_TYPE_INFO:-1,C_UPDATE_DATA:-1,C_GET_RANK_TYPE_INFO:-1,C2C_RANK_RESPONSE:-1,C2C_GET_RACE_RANK_INFO:-1,V_UPDATA_ALERT:-1}),b8e.RC("$$game","$$RankEvts",e)}(),function(){var e;e=b8e.Enum({C2C_REQ_RANKINFO:b8e.enc(),C2C_SHOW_RANK:b8e.enc()}),b8e.RC("$$game","$$RankGEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.RANK)},triggerOpen:function(e){e==this.moduleEnum&&(this.isOpen=!0,this.getRankTypeInfo(game.rankData.rankType))},ipc:function(){var e=this;e.evts={MainInstance:{C_REQ_RANKINFO:e.onReqRankInfo},BaoZang:{C_REQ_RANKINFO:e.onReqRankInfo},ZhaoQin:{C_REQ_RANKINFO:e.onReqRankInfo},ZhanJiang:{C_REQ_RANKINFO:e.onReqRankInfo},ArenaRank:{C_REQ_RANKINFO:e.onReqRankInfo},Throne:{C_REQ_RANKINFO:e.onReqRankInfo},Hunting:{C_REQ_RANKINFO:e.onReqRankInfo},CSArenaRank:{C_REQ_RANKINFO:e.onReqRankInfo},BarbarianRank:{C_REQ_RANKINFO:e.onReqRankInfo},MapAchieve:{C_REQ_RANKINFO:e.onReqRankInfo},YongzheWelfare:{C2C_YONGZHE_RANK_LEVEL_REQ:e.onReqRankInfo},OpenCompetition:{C2C_REQ_RACE_RANKINFO:e.onReqRaceRankInfo},OCCompetitionBase:{C2C_REQ_RACE_RANKINFO:e.onReqRaceRankInfo},SurpriseScratch:{C2C_REQUEST_RANKINFO:e.onReqRaceRankInfo},HuntingMain:{C2C_REQ_RANK_DATA:e.onReqRaceRankInfo},Guaji:{C2C_REQUEST_RANKINFO:e.onReqRankInfo}},e.gevts={RankGEvts:{C2C_REQ_RANKINFO:e.onReqRankInfo,C2C_SHOW_RANK:e.showRank}},e.handels={RankResp:e.rankResp,MobaiRankResp:e.onMobaiRankResp,RaceRankResp:e.raceRankResp}},notify:function(e,t){switch(e){case this.Evts.SELECT_TAB:if(t){this.selectTab(t)}break;case this.Evts.GET_RANK_TYPE_INFO:this.getRankTypeInfo(t)}},showRank:function(e){(e||e.data)&&(game.rankData.rankType=e.data,game.rankData.setSelectTab(e.data),game.module.show(this.moduleEnum),this.checkAlert())},onReqRankInfo:function(e){if(e||e.data){var t=e.data;if(game.rankData.isRankTypeCDEnd(t))this.getRankTypeInfo(e.data);else{var a=game.rankData.getRankInfoArrByType(t);this.dpt(this.Evts.C_UPDATE_DATA,t),this.dpt(this.Evts.C2C_RANK_RESPONSE,{rankType:t,list:a})}}},onReqRaceRankInfo:function(e){(e||e.data)&&game.raceRankData.isRankTypeCDEnd(e.data)&&this.getRaceRankIdInfo(e.data)},getRankTypeInfo:function(e){this.sender.RankReq(e)},getRaceRankIdInfo:function(e){this.sender.RaceRankReq(e)},first_btn:function(){},left_btn:function(){game.rankData.gotoPerRankPage(),this.send(this.Evts.UPDATE_DATA,{pageOP:-1})},right_btn:function(){game.rankData.gotoNextRankPage(),this.send(this.Evts.UPDATE_DATA,{pageOP:1})},rankResp:function(e){var t=e.readProtobuf(game.pb.RankResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.type,i=t.userRank,n=t.list;this.updateRankInfos(a,i,n),this.checkAlert(),this.dpt(this.Evts.C_UPDATE_DATA,a),this.send(this.Evts.UPDATE_DATA);var s=game.rankData.getRankInfoArrByType(a);this.dpt(this.Evts.C2C_RANK_RESPONSE,{rankType:a,list:s})}},raceRankResp:function(e){var t=e.readProtobuf(game.pb.RaceRankResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.id,i=t.userRank,n=t.list;game.raceRankData.updateRankInfos(a,i,n),this.dpt(this.Evts.C2C_GET_RACE_RANK_INFO,a)}},onMobaiRankResp:function(e){var t=e.readProtobuf(game.pb.MobaiRankResponse);0<t.code?game.notice.noticeError(t.code):(game.rankData.updataNewMobai(t.rankType),this.checkAlert(),this.send(this.Evts.UPDATE_DATA),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},selectTab:function(e){e!==game.rankData.rankType&&(game.rankData.pageNum=1,game.rankData.setSelectTab(e),this.send(this.Evts.UPDATE_DATA,null),game.rankData.isRankTypeCDEnd(e)&&this.getRankTypeInfo(e))},updateRankInfos:function(e,t,a){game.rankData.updateRankInfos(e,t,a),game.rankData.rankType===e&&this.send(this.Evts.UPDATE_DATA,null)},checkAlert:function(){var e=game.rankData.checkTabAlert();this.spotAlert.alert=e},btn_worship:function(){if(!game.rankData.checkMobai()){this.sender.MobaiRankReq(game.rankData.rankType);var e=game.rankData.checkNextTab(game.rankData.rankType);e&&this.getRankTypeInfo(e)}}}),t=game.Sender.extends({ipc:function(){this.msg={RankReq:this.rankRequest,RaceRankReq:this.raceRankReq,MobaiRankReq:this.mobaiRankReq}},rankRequest:function(e){var t=game.pb.RankRequest;t.type=e,this.write(t)},raceRankReq:function(e){var t=game.pb.RaceRankRequest;t.id=e,this.write(t)},mobaiRankReq:function(e){var t=game.pb.MobaiRankRequest;t.rankType=e,this.write(t)}});b8e.module.registerControl(game.ME.Rank,e,game.RankEvts,t)}(),function(){var e,t=e=b8e.Object.extends({fosterType:0,wearedType:0,wearedId:0,ctor:function(){this._super()},setData:function(e){this.fosterType=e.fosterType,this.wearedType=e.wearedType,this.wearedId=e.wearedId},clear:function(){this.fosterType=0,this.wearedType=0,this.wearedId=0}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$RankFosterRankInfo",e)}(),function(){var e,t=e=b8e.Object.extends({selfRankInfoMap:null,rankInfosMap:null,rankTabInfos:null,cachedInfos:null,rankTypeCDMap:null,mobaiRankMap:null,rankType:1,pageNum:1,PER_PAGE_COUNT:4,CDTime:6e4,ctor:function(){this._super(),this.selfRankInfoMap=b8e.HashMap.get(),this.rankInfosMap=b8e.HashMap.get(),this.rankTypeCDMap=b8e.HashMap.get(),this.rankTabInfos=[],this.cachedInfos=[],this.mobaiRankMap=[]},init:function(){},createRankTabInfos:function(){var e=game.RankCfg.getDatas();if(e&&0<e.length){for(var t=0,a=e.length;t<a;t++){var i=e[t];if(i){var n=new game.RankTabItemInfo;n.setData(i),this.rankTabInfos.push(n)}else;}this.rankTabInfos.sort(this.sortTab)}},sortTab:function(e,t){if(e.sortId>t.sortId){return 1}if(e.sortId<t.sortId){return-1}return 0},getRankTabInfoArr:function(){var e=this;return e.rankTabInfos||(e.rankTabInfos=[]),e.rankTabInfos.length<=0&&e.createRankTabInfos(),e.rankTabInfos&&0<e.rankTabInfos.length&&(e.rankType<=0&&(e.rankType=e.rankTabInfos[0].id),e.setSelectTab(e.rankType)),e.rankTabInfos},getRankInfoArrByType:function(e){if(!this.rankInfosMap){this.rankInfosMap=b8e.HashMap.get()}var t=this.rankInfosMap.get(e);if(!t){t=[],this.rankInfosMap.set(e,t)}return t},getFirstRankTypeInfo:function(e){var t=this.getRankInfoArrByType(e),a=null;return t&&0<t.length&&(a=t[0]),a},getRankInfoByTypeARank:function(e,t){var a=this.getRankInfoArrByType(e),i=null;return a&&a.length>t-1&&(i=a[t-1]),i},getRankInfoArrByPageByType:function(){if(this.pageNum<=0){this.pageNum=1}var e=this.PER_PAGE_COUNT;if(e<=0){return null}var t=null,a=this.getRankInfoArrByType(this.rankType),i=(this.pageNum-1)*e,n=this.pageNum*e,s=a.length;if(n=Math.min(n,s),i<s){t=[];for(var o=i;o<n;o++){var r=a[o];if(r)t.push(r);else;}}return t},getPageCount:function(){var e=this.getRankInfoArrByType(this.rankType);if(e&&0<e.length){var t=e.length;return Math.ceil(t/this.PER_PAGE_COUNT)}return 1},gotoNextRankPage:function(){var e=this;if(e.pageNum<1){e.pageNum=1}var t=e.PER_PAGE_COUNT,a=e.getRankInfoArrByType(e.rankType);e.pageNum;if(e.pageNum*t<a.length){e.pageNum++}},gotoPerRankPage:function(){var e=this;if(e.pageNum<1){e.pageNum=1}var t=e.PER_PAGE_COUNT,a=e.getRankInfoArrByType(e.rankType),i=(e.pageNum-1)*t;e.pageNum;if(i<a.length&&1<e.pageNum){e.pageNum--}},setRankInfoArrByType:function(e,t){var a=this,i=a.rankInfosMap.get(e);if(!i){i=[],a.rankInfosMap.set(e,i)}if(t&&0<t.length){for(var n=i.length,s=t.length,o=0;o<n;o++){var r=i[o];a.cachedInfos.push(r)}for(o=i.length=0;o<s;o++){r=null;if(0<a.cachedInfos.length){r=a.cachedInfos.pop()}if(!r){r=new game.RankItemInfo}var g=t[o];if(g)r.ocId=r.rankType=e,r.setData(g),i.push(r);else;}}},getSelfRankInfo:function(e){if(!this.selfRankInfoMap){this.selfRankInfoMap=b8e.HashMap.get()}var t=this.selfRankInfoMap.get(e);if(!t){t=new game.RankItemInfo,this.selfRankInfoMap.set(e,t)}return t},setSelfRankInfo:function(e,t){if(!this.selfRankInfoMap){this.selfRankInfoMap=b8e.HashMap.get()}var a=this.selfRankInfoMap.get(e);if(!a){a=new game.RankItemInfo,this.selfRankInfoMap.set(e,a)}a.setData(t)},getSelfRank:function(e){var t=this.getSelfRankInfo(e);if(t)return t.rank;return 0},getCDByType:function(e){if(!this.rankTypeCDMap)return 0;var t=this.rankTypeCDMap.get(e);if(null!=t)return t;return this.rankTypeCDMap.set(e,0),0},setRankCDMap:function(e,t){if(!this.rankTypeCDMap){this.rankTypeCDMap=b8e.HashMap.get()}this.rankTypeCDMap.set(e,t)},isRankTypeCDEnd:function(e){var t=this.getCDByType(e);if(game.SysTime.curTime<t){return!1}return!0},updateRankInfos:function(e,t,a){if(!this.playerRank){this.playerRank=new game.RankItemInfo}this.playerRank.rankType=e,this.setSelfRankInfo(e,t),this.setRankInfoArrByType(e,a);var i=game.SysTime.curTime;this.setRankCDMap(e,i+this.CDTime)},setSelectTab:function(e){if(this.rankTabInfos&&0<this.rankTabInfos.length)for(var t=0,a=this.rankTabInfos.length;t<a;t++){var i=this.rankTabInfos[t];if(i)if(e===i.id){i.isSelect=!0,this.rankType=i.id}else i.isSelect=!1;else{b8e.warn("rankTabInfo is null or undefined ?")}}},setWelfData:function(e){this.mobaiRankMap=e.mobaiRankAwards},updataNewMobai:function(e){this.mobaiRankMap.push(e),this.checkSelectTab()},checkSelectTab:function(){for(var e=void 0,t=void 0,a=0,i=this.rankTabInfos.length;a<i;a++)if((e=this.rankTabInfos[a])&&this.mobaiRankMap.indexOf(e.id)<0){t=e.id;break}this.setSelectTab(t)},checkMobai:function(){return-1<this.mobaiRankMap.indexOf(this.rankType)},checkTabAlert:function(){this.rankTabInfos.length<=0&&this.createRankTabInfos();for(var e=void 0,t=!1,a=0,i=this.rankTabInfos.length;a<i;a++)(e=this.rankTabInfos[a])&&(e.isAlert=this.mobaiRankMap.indexOf(e.id)<0,!t&&e.isAlert&&(t=!0));return t},checkNextTab:function(e){for(var t=void 0,a=void 0,i=0,n=0,s=this.rankTabInfos.length;n<s;n++)if((t=this.rankTabInfos[n])&&e==t.id){(a=this.rankTabInfos[n+1])&&(i=a.id);break}return i}});game.rankData=game.rankData||new t,b8e.RC("$$game","$$RankData",e)}(),function(){var e=game.RankData.extends({ctor:function(){this._super()},updateRankInfos:function(e,t,a){this.playerRank||(this.playerRank=new game.RankItemInfo),this.playerRank.ocId=e,this.setSelfRankInfo(e,t),this.setRankInfoArrByType(e,a);var i=game.SysTime.curTime;this.setRankCDMap(e,i+this.CDTime)},makeRankListCompleteByRank:function(e,t){var a=this.getRankInfoArrByType(t);if(a&&a.length>=e)return a;a=a||[];for(var i=void 0,n=this.cachedInfos,s=a.length;s<e;s++)i=null,n&&0<n.length&&(i=n.pop()).clearData(),(i=i||new game.RankItemInfo).rank=s+1,a[s]=i;return a}});game.raceRankData=game.raceRankData||new e}(),function(){var e,t=e=b8e.Object.extends({roleid:0,name:"",rank:0,score:0,level:0,power:0,vipLevel:0,zone:0,time:0,isMale:0,extra1:0,extra2:0,servName:"",rankType:0,fosterInfoArr:null,flag:!1,ocId:0,ctor:function(){this._super()},setData:function(e){var t=this;if(e){t.roleid=e.roleid,t.name=e.name,t.rank=e.rank,t.score=e.score,t.level=e.level,t.power=e.power,t.vipLevel=e.vipLevel,t.zone=e.zone,t.time=e.time,t.isMale=e.male,t.extra1=e.extra1,t.extra2=e.extra2,t.servName="s."+e.zone;var a=e.info;a?(t._recycleFosterInfo(),t.info=a,t.surface=a.surface,t.change()):(t.info=null,t.surface=null)}},_getFosterInfo:function(e){var t=void 0;return this._fosterInfoPool&&0<this._fosterInfoPool.length?(t=this._fosterInfoPool.shift()).clear():t=new game.RankFosterRankInfo,t.setData(e),t},_recycleFosterInfo:function(){if(this.fosterInfoArr){this._fosterInfoPool||(this._fosterInfoPool=[]);for(var e=void 0;0<this.fosterInfoArr.length;)(e=this.fosterInfoArr.shift()).clear(),this._fosterInfoPool.push(e);this.fosterInfoArr.length=0}},getFosterInfoByType:function(e){if(this.fosterInfoMap)return this.fosterInfoMap.get(e);return null},change:function(){this.flag=!this.flag},clearData:function(){var e=this;e.roleid=0,e.name="",e.rank=0,e.score=0,e.level=0,e.power=0,e.vipLevel=0,e.zone=0,e.time="",e.isMale=!1,e.extra1=null,e.extra2=null,e.servName="",e.info=null,e.surface=null}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$RankItemInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,tabName:"",sortId:0,isSelect:!1,isAlert:!1,ctor:function(){this._super()},setData:function(e){this.id=e.type,this.tabName=e.name,this.sortId=e.sort}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$RankTabItemInfo",e)}(),function(){var e;e=b8e.Enum({RTNone:0,RankPower:1,RankLevel:2,InsMain:20,Arena:50,RankPet:3,InsXianDi:21,InsZhanJiang:22,InsZhaoQin:23,InsWanshou:24,IconAch:25,RankJunzhen:38,CrossArena:51,Throne:60,RankArrow:61,BarbarianWeek:62,BarbarianHistory:63}),b8e.RC("$$game","$$RankType",e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(876),this.setSize(446,116)},onShow:function(){this.setData(this._data)},setData:function(e){var t=this;if(e&&(t._data=e),t.skin&&e){var a=t.skin;a.first_root.active=1==e.rank,a.second_root.active=2==e.rank,a.third_root.active=3==e.rank,a.other_root.active=3<e.rank,a.rank_lab.string=e.rank,a.name_lab.string=e.name,a.vip_lab_vip.node.active=0<e.vipLevel,a.name_lab.x=0<e.vipLevel?159:a.tip1.x,a.vip_lab.string=0<e.vipLevel?e.vipLevel:"";var i=game.RankType;game.FosterType;switch(e.rankType){case i.RankPower:case i.RankLevel:a.lv_lab.string=game.Lang.get(9587,e.level),a.power_lab.string=game.CCommonUtil.replaceNum(e.power),a.tip1.string=game.Lang.get(9281),a.tip2.string=game.Lang.get(9279);break;case i.InsMain:a.tip1.string=game.Lang.get(9281),a.tip2.string=game.Lang.get(51926),a.lv_lab.string=game.Lang.get(9587,e.level),game.InstanceCfg.getDataAsync(e.score,function(e){e&&(t.skin.power_lab.string=e.progress)},t);break;case i.Arena:a.tip1.string=game.Lang.get(9281),a.tip2.string=game.Lang.get(51927),a.lv_lab.string=game.Lang.get(9587,e.level),a.power_lab.string=game.CCommonUtil.replaceNum(e.power)}a.tip2.x=a.lv_lab.x+a.lv_lab.width+18,a.power_lab.x=a.tip2.x+a.tip2.width+1}},touch:function(){}}),b8e.RC("$$game","$$RankItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(877),this.setSize(144,86)},setData:function(){if(this.data){var e=this.data;this.skin.unselect.node.active=!e.isSelect,this.skin.select.node.active=e.isSelect,this.skin.name_lab.string=e.tabName,this.skin.redPoint.active=e.isAlert}else{b8e.error("RankTabItemView data is null")}},touch:function(){this.send(game.RankEvts.SELECT_TAB,this.data.id)}}),b8e.RC("$$game","$$RankTabItemView",e)}(),function(){var e=game.View.extends({rankList:null,rankTabList:null,firstModel:null,tabType:0,RANK_MAX_COUNT:100,heroModel:null,ctor:function(){this._super(878)},init:function(){var e=this.rankTabList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.RankTabItemView,e.bindEnum=game.ME.Rank,e.layout.paddingLeft=0,e.layout.paddingTop=10,e.layout.spacingY=5,e.addToParent(this.skin.rankTabScrollView),this.skin.model.setScale(.7,.7),this.rankList=[]},onShow:function(){var e=game.rankData;if(e.checkSelectTab(),e.isRankTypeCDEnd(e.rankType)){this.send(game.RankEvts.GET_RANK_TYPE_INFO,e.rankType)}this.updateList()},onHide:function(){var e=this.firstModel;if(e){var t=e.getAnimator(game.AnimType.BODY,1);t&&t.clear()}},notify:function(e){switch(e){case game.RankEvts.UPDATE_DATA:this.updateList()}},updateList:function(){this.updateTabList(),this.updateRankList(),this.updatePageNum(),this.updageSelfInfo(),this.updateFirstRoleModel(),this.updataMobai()},updateFirstRoleModel:function(){var e=this,t=game.rankData.rankType,a=game.rankData.getFirstRankTypeInfo(t);if(a)e.skin.first_name_lab.string=a.name;else{e.skin.first_name_lab.string=game.Lang.get(9286)}this.updateUIModelByType(t,a)},updateUIModelByType:function(e,t){var a=this,i=a,n=a.roleData,s=game.RoleType;n=n||(a.roleData=game.BaseRoleData.get(s.Hero,1)),a.model&&a.model.release(),a.model=game.sceneRoleCreate.createUIRole(a.roleData),a.model.addToParent(i.skin.model);var o=n.heroModel;if(o)if(o.clear(),t){o.setMale(t.isMale),o.setBody(s.Hero,t.isMale?1001:1002);game.RankType;if(t.info){a.model.active=!0;var r=t.info;if(r)o.setSurface(r.surface,game.RoleType.Hero,!0),game.AvatarUtil.updateUIModel(a.model),a.model.transition(game.RoleStateType.ACTION_IDLE);else a.model.clear()}else a.model.active=!1}else a.model.active=!1},setHero:function(e,t,a){var i=this.roleData.heroModel;if(i&&(i.setMale(e),i.type=game.RoleType.Hero,t&&i.setFashion(t),a)){var n=game.NicknameCfg.getData(a);if(n){var s=util.getUIModel(n);i.setAnim(game.AnimType.NICK_NAME,s)}}},__setBody:function(e,t,a){if(0!=e&&e){var i=t.getData(e);if(i){var n=this.roleData.heroModel;if(n){var s=game.AvatarUtil.getUIModel(i);n.setBody(a,s)}}}},__updateBody:function(e,t,a){this.__setBody(e,t,a),game.AvatarUtil.updateBody(this.model)},updateRankList:function(){var e=game.rankData.getRankInfoArrByPageByType();e=e||[];for(var t=void 0,a=void 0,i=0;i<4;i++)t=e[i],(a=this.rankList[i])||((a=new game.RankItemView).setPosition(0,-121*i),a.addToParent(this.skin.rankScrollView),a.show(),this.rankList[i]=a),a.setVisible(!!t),t&&a.setData(t)},updateTabList:function(){var e=game.rankData.getRankTabInfoArr();e||(e=[],b8e.warn("\u6392\u884c\u699c\u4e3a\u7a7a")),this.rankTabList.setData(e),this.rankTabList.scrollToTop()},updatePageNum:function(){var e=game.rankData.getPageCount(),t=game.rankData.pageNum;this.skin.page_lab.string=t+" / "+e},updageSelfInfo:function(){var e=this.skin,t=game.rankData.getSelfRankInfo(game.rankData.rankType);if(t){var a=t.rank;a<=0||a>this.RANK_MAX_COUNT?e.self_rank.string=game.Lang.get(9069):e.self_rank.string=game.Lang.get(608,t.rank)}else e.self_rank.string=game.Lang.get(9069)},updataMobai:function(){var e=this.skin,t=game.WelfareMiscCfg.getData("mobaiRankGold");if(t){var a=game.rankData.checkMobai();game.ShaderUtil.setGray(e.btn_Gray,a),e.btn_worship.active=!a,e.btn_Gray.active=a,e.getNum.string=t.value}}});b8e.module.registerView(game.ME.Rank,e)}(),function(){var e;e=b8e.Enum({None:0}),b8e.RC("$$game","$$CardRechargeEvts",e)}(),function(){var e;e=b8e.Enum({None:0,V_VIP_EXP_CHANGE:-1,V_VIP_LEVEL_CHANGE:-1,V_RECHARGE_SUCCESS:-1,V_INIT_MODEL:-1,V_RECHARGE:-1,C_RECHARGE_SUCCESS:-1,C_INIT_MODEL:-1,V_GET_CARD_AWARD:-1,C_GET_CARD_AWARD:-1,C2C_CHANGE_CARD:-1,C2C_CHOOSE_RECHARGE_SUCCESS:-1,C2C_CHOOSE_RECHARGE_GET:-1,C2C_RESET_RECHARGE:-1,C2C_WEEKCARE_OPEN:-1,C_RECALL_PRIZE:-1,C_SUPREME_WAR_ORDER:-1,V2C_ON_HIDE:-1,C2C_CLOSR_ACT:-1}),b8e.RC("$$game","$$RechargeEvts",e)}();(function(){var e=game.Control.extends({reqLock:!1,lockTime:0,init:function(){this.params={itemId:0},this.monthCardAlert=game.spotAlert.set(game.SAE.MONTH_CARD_ALERT,game.SAE.RECHARGE_HALL_RECHARGE),this.weekCardAlert=game.spotAlert.set(game.SAE.WEEK_CARD_ALERT,game.SAE.RECHARGE_HALL_RECHARGE),this._alertOptions={lang:1723,okcb:this.onClickGameAlert,thisArg:this},this.sender.RechargeModelReq()},triggerOpen:function(e){e!=game.ME.WeekCard&&e!=game.ME.MonthCard||this.dpt(this.Evts.C2C_CHANGE_CARD)},ipc:function(){var e=this,t=e;t.evts={MainRole:{C_VIP_LEVEL_CHANGE:t.changeVipLevel,C_RESET_DAILY:t.resetDaily,C_RESET_MONTH:t.resetMonth},Back:{C_UPDATE_AMOUNT:t.updateAmount},SaleRecharge:{C2C_RECHARGE:e.onRecharge},FstResetRechage:{C2C_RESET_RECHARGE:e.fstReset},TimeLimitPrize:{C2C_RECHARGE:e.onRecharge},GrowGift:{C2C_RECHARGE:e.onRecharge},DailyGift:{C2C_RECHARGE:e.onRecharge},GoodGiftRMB:{C2C_RECHARGE:e.onRecharge},CultureGift:{C2C_RECHARGE:e.onRecharge},Scene:{C2C_RECONNECT_ENTER_SCENE:e.reconnect},ChainGift:{C2C_RECHARGE:e.onRecharge},RegressActivity:{C2C_RECHARGE:e.onRecharge},PushPrize:{C2C_RECHARGE:e.onRecharge},WarOrderMain:{C_RECHARGE:e.onRecharge},OpenServCR:{C2C_RECHARGE:e.onRecharge},DayOrWeekGift:{C2C_RECHARGE:e.onRecharge},OneYuanBuy:{C2C_RECHARGE:e.onRecharge},OpenSerCarnival:{C2C_RECHARGE:e.onRecharge},FundMain:{C2C_RECHARGE:e.onRecharge},PrivilegeShop:{C2C_RECHARGE:e.onRecharge,C2C_BUY_WEEK_CARD:e.weekRechargeBtn,C2C_GET_WEEK_CARD:e.weekGetPrizeBtn},Barbarian:{C2C_RECHARGE:e.onRecharge},DailyWish:{C2C_RECHARGE:e.onRecharge},ExchangeWelfare:{C2C_RECHARGE:e.onRecharge},LimitSalePrize:{C2C_RECHARGE:e.onRecharge},OptionalLottery:{C2C_RECHARGE:e.onRecharge},HuntingMain:{C2C_RECHARGE:e.onRecharge}},t.gevts={ExchangeEvts:{C2C_WELFARE_BUY:t.onRecharge}},t.handels={RechargeModelResp:t.rechargeModelResp,RechargeMsg:t.rechargeMsg,NormalRechargeMsg:t.normalRechargeMsg,CardAwardResp:t.cardAwardResp,CardRechargeMsg:t.cardRechargeMsg}},reconnect:function(){this.sender.RechargeModelReq()},fstReset:function(){this.sender.RechargeModelReq()},rechargeModelResp:function(e){var t=e.readProtobuf(game.pb.RechargeModel);game.rechargeData.setRechargeData(t),game.rechargeData.initRechargeList(),game.openServerCRData.syncModelDatas(t),this.checkMonthCardAlert(),this.checkWeekCardAlert(),this.send(this.Evts.V_INIT_MODEL),this.dpt(this.Evts.C_INIT_MODEL)},rechargeMsg:function(e){var t=this,a=e.readProtobuf(game.pb.RechargeNotify),i=game.rechargeData,n=!!a.id&&i.getIsFirst(a.id),s=game.NormalRechargeCfg.getData(a.id);s&&(n=n||s.firstForever);var o=t.getGetGold(a.id,n);t.rechargeSuccess(a.id,n,a.money),i.rechargeSuccess(a.id,a.money),(i.getCardIsHas(game.CardType.MONTH)||i.getCardIsHas(game.CardType.WEEK)||i.getCardIsHas(game.CardType.FOREVER))&&t.dpt(t.Evts.C2C_CHANGE_CARD),t.checkMonthCardAlert(),t.checkWeekCardAlert(),t.dpt(t.Evts.C2C_WEEKCARE_OPEN),t.dpt(t.Evts.C_RECHARGE_SUCCESS,t.obj),t.send(t.Evts.V_RECHARGE_SUCCESS);if(a.id){var r=game.RechargeCfg.getDataById(a.id),g=game.rechargeData.chooseCollected;if(!r)return;if(r.rechargeType==game.RechargeType.CHOOSE&&!g){g=!0,i.chooseId=a.id,this.dpt(this.Evts.C2C_CHOOSE_RECHARGE_SUCCESS)}r.rechargeType==game.RechargeType.RECALL_PRIZE&&(game.regressRewardData.updatePrizes(a.id),t.dpt(t.Evts.C_RECALL_PRIZE)),r.rechargeType==game.RechargeType.SUPREME_WAR_ORDER&&(game.warOrderData.updateSupreme(),t.dpt(t.Evts.C_SUPREME_WAR_ORDER)),r.money,0<o?(t._alertOptions.lang=1723,t._alertOptions.langArgs=[o]):t._alertOptions.lang=5102,game.alert.show(t._alertOptions)}else a.money},getGetGold:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=game.RechargeCfg.getDataById(e);if(!i)return 0;var n=0,s=game.RechargeType,o=void 0;switch(i.rechargeType){case s.NORMAL:if(!(o=game.NormalRechargeCfg.getData(e)))return 0;n=a?o.gold+o.firstExtraGold:o.gold+o.extraGold;break;case s.CHOOSE:if(!(o=game.ChooseRechargeCfg.getData(e)))return 0;n=a?o.gold+o.firstExtraGold:o.gold+o.extraGold}return n},onClickGameAlert:function(){},rechargeSuccess:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:0;if(e){var n=game.RechargeCfg.getDataById(e);game.amount.changeAmount(game.AmountType.VIP_EXP,n.addVipExp)}else{var s=i/100;game.amount.changeAmount(game.AmountType.VIP_EXP,s)}this.obj?(this.obj.id=e,this.obj.isFirst=t,this.obj.money=i):this.obj={id:e,isFirst:t,money:i}},normalRechargeMsg:function(){},cardAwardResp:function(e){var t=e.readProtobuf(game.pb.CardAwardResponse);t.code?game.notice.noticeError(t.code):(game.rechargeData.cardAwardResponse(t.cardType),this.checkMonthCardAlert(),this.checkWeekCardAlert(),this.send(this.Evts.V_GET_CARD_AWARD),this.dpt(this.Evts.C_GET_CARD_AWARD),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},cardRechargeMsg:function(e){var t=e.readProtobuf(game.pb.CardRechargeNotify);game.rechargeData.cardRechargeMsg(t.card),this.dpt(this.Evts.C2C_CHANGE_CARD)},notify:function(e,t){switch(e){case this.Evts.V_RECHARGE:this.recharge(t);break;case this.Evts.V2C_ON_HIDE:this.dpt(this.Evts.C2C_CLOSR_ACT)}},onRecharge:function(e){this.recharge(e.data)},recharge:function(e){this.lockTime>game.SysTime.curTime?game.notice.show(6328):(this.lockTime=game.SysTime.curTime+1e3,this.params.itemId=e,game.sdk.pay(this.params))},updateReqLock:function(){this.reqLock=!1},changeVipLevel:function(){this.send(this.Evts.V_VIP_LEVEL_CHANGE)},updateAmount:function(){this.send(this.Evts.V_VIP_EXP_CHANGE)},resetDaily:function(){game.rechargeData.resetDaily(),this.checkMonthCardAlert(),this.checkWeekCardAlert(),this.dpt(this.Evts.C2C_CHANGE_CARD),this.dpt(this.Evts.C2C_RESET_RECHARGE)},resetMonth:function(){game.rechargeData.resetMonth()},checkMonthCardAlert:function(){if(game.moduleOpen.checkOpen(game.ME.MonthCard)){var e=!1,t=!1,a=game.rechargeData.getCardInfoByType(game.CardType.MONTH),i=game.rechargeData.getCardInfoByType(game.CardType.FOREVER);a&&a.expireTime>game.SysTime.curTime&&(a.collectedDaily||(e=!0)),i&&(i.collectedDaily||(t=!0)),this.monthCardAlert.alert=e||t}else{this.monthCardAlert.alert=!1}},checkWeekCardAlert:function(){if(game.moduleOpen.checkOpen(game.ME.WeekCard)){var e=game.rechargeData.getCardInfoByType(game.CardType.WEEK);!e||e.expireTime<=game.SysTime.curTime?this.weekCardAlert.alert=!1:this.weekCardAlert.alert=!e.collectedDaily}else this.weekCardAlert.alert=!1},weekGetPrizeBtn:function(){this.sender.CardAwardReq(game.CardType.WEEK)},weekRechargeBtn:function(){this.bugCard(game.CardType.WEEK)},monthGetPrizeBtn:function(){this.sender.CardAwardReq(game.CardType.MONTH)},refillBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},monthRechargeBtn:function(){this.bugCard(game.CardType.MONTH)},foreverGetPrizeBtn:function(){this.sender.CardAwardReq(game.CardType.FOREVER)},foreverBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},foreverRechargeBtn:function(){this.bugCard(game.CardType.FOREVER)},bugCard:function(e){var t=game.rechargeData.getCardRechargeCfg(e);t&&this.recharge(t.rechargeId)}}),t=[game.ME.WeekCard,game.ME.MonthCard,game.ME.QrcodeView],a=game.Sender.extends({ipc:function(){this.msg={RechargeModelReq:null,CardAwardReq:this.cardAwardReq}},cardAwardReq:function(e){var t=game.pb.CardAwardRequest;t.cardType=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.Recharge,e,game.RechargeEvts,a,t)})(),function(){var e=b8e.Object.extends({});game.cardRechargeData=game.cardRechargeData||new e}(),function(){var e;e=b8e.Object.extends({cardType:0,expireTime:0,collectedDaily:!1,setData:function(e){this.cardType=e.cardType,this.expireTime=e.expireTime,this.collectedDaily=e.collectedDaily}}),b8e.RC("$$game","$$CardRechargeInfo",e)}(),function(){var e;e=b8e.Enum({CARD_NONE:0,WEEK:1,MONTH:2,FOREVER:3}),b8e.RC("$$game","$$CardType",e)}(),function(){var e=b8e.Object.extends({pfType:0,rechargeMoney:0,rechargeMoneyDaily:0,rechargeGold:0,rechargeGoldDaily:0,cardRechargeDataMap:null,saleRecharges:null,firstRechargeAwards:null,discountRechargeAwards:null,dailyRechargeAwards:null,chooseId:0,chooseCollected:!1,accRechargeMoney:0,accRechargeAwards:null,accRechargeGroup:0,accRechargeMoney2:0,accRechargeAwards2:null,accRechargeGroup2:0,singleRechargeGroup:0,singleRechargeAwards:null,singleRechargeMoney:null,dailySalePrizeBuy:null,dailySalePrizeCollected:null,growthGroups:null,growthCollected:null,mergeAccRecharges:null,rechargeTimes:0,limitAccRechargeAwards:null,limitAccRechargeGroup:0,limitAccRechargeMoney:0,limitDailyRecharges:null,isInit:!1,rechargeMoneyMonthly:0,ctor:function(){this._super(),this.rechargeDataMap=b8e.HashMap.get(),this.cardRechargeDataMap=b8e.HashMap.get(),this.firstRechargeAwards=[],this.discountRechargeAwards=[],this.dailyRechargeAwards=[],this.rechargeList=[]},setRechargeData:function(e){var t,a,i,n=this;b8e.isWeChatGame?n.pfType=2:game.LoginConfig.isApplePay?n.pfType=2:n.pfType=1,n.rechargeMoney=e.rechargeMoney,n.rechargeMoneyDaily=e.rechargeMoneyDaily,n.rechargeGold=e.rechargeGold,n.rechargeGoldDaily=e.rechargeGoldDaily;var s,o,r=void 0;if((t=e.rechargeDatas)&&0<t.length)for(a=t.length,i=0;i<a;i++)r=t[i],n.addFisrtData(r.id);if((t=e.cardDatas)&&0<t.length)for(a=t.length,i=0;i<a;i++)s=t[i],(o=(o=n.cardRechargeDataMap.get(s.cardType))||new game.CardRechargeInfo).setData(s),n.cardRechargeDataMap.set(o.cardType,o);n.saleRecharges=e.saleRecharges,n.firstRechargeAwards=e.firstRechargeAwards,n.discountRechargeAwards=e.discountRechargeAwards,n.dailyRechargeAwards=e.dailyRechargeAwards,n.chooseId=e.chooseId,n.chooseCollected=e.chooseCollected,n.accRechargeMoney=e.accRechargeMoney,n.accRechargeGroup=e.accRechargeGroup,n.accRechargeAwards=e.accRechargeAwards,n.timeLimitPrize=e.timeLimitPrize,n.conRechargeDay=e.conRechargeDay,n.conRechargeGroup=e.conRechargeGroup,n.conRechargeAwards=e.conRechargeAwards,n.conRechargeFinish=e.conRechargeFinish,n.conRechargeDay2=e.conRechargeDay2,n.conRechargeGroup2=e.conRechargeGroup2,n.conRechargeAwards2=e.conRechargeAwards2,n.conRechargeFinish2=e.conRechargeFinish2,n.accRechargeMoney2=e.accRechargeMoney2,n.accRechargeAwards2=e.accRechargeAwards2,n.accRechargeGroup2=e.accRechargeGroup2,n.singleRechargeMoney=e.singleRechargeMoney,n.singleRechargeAwards=e.singleRechargeAwards,n.singleRechargeGroup=e.singleRechargeGroup,n.dailySalePrizeBuy=e.dailySalePrizeBuy,n.dailySalePrizeCollected=e.dailySalePrizeCollected,n.growthGroups=e.growthGroups,n.growthCollected=e.growthCollected,n.mergeKeepRecharges=e.mergeKeepRecharges,n.mergeAccRecharges=e.mergeAccRecharges,n.chooseAwards=e.chooseAwards,n.isHudieVip=e.isHudieVip,n.assetPrize=e.assetPrize,n.rechargeTimes=e.rechargeTimes,n.keepPrize=e.keepPrize,n.qqDailyRecharges=e.qqDailyRecharges,n.limitAccRechargeAwards=e.limitAccRechargeAwards,n.limitAccRechargeGroup=e.limitAccRechargeGroup,n.limitAccRechargeMoney=e.limitAccRechargeMoney,n.limitDailyRecharges=e.limitDailyRecharges,n.rechargeMoneyMonthly=e.rechargeMoneyMonthly,n.pushPrize=e.pushPrize,n.pushExpire=e.pushExpire,n.periodic=e.periodic,n.yiyuan=e.yiyuan,n.yiyuanExpireTime=e.yiyuanExpireTime,n.yiyuanRecords=e.yiyuanRecords,n.firstRechargeFree=e.firstRechargeFree,n.newFirstRechargeAwards=e.newFirstRechargeAwards,n.periodFastBuy=e.periodFastBuy,game.privilegeShopData.setData(e.privileges),game.limitSalePrizeData.setData(e.limitSalePrize),n.isInit=!0},initRechargeList:function(){var e=game.RechargeCfg.getRechargeList(this.pfType);if(e&&!(e.length<1)){this.rechargeList.length=0;var t,a,i,n=e.length,s=game.RechargeType;game.CardType;this.rechargeCount=0;game.CCommonUtil.getGameChannelIdOpen;for(var o=void 0,r=0;r<n;r++){(t=e[r]).rechargeType!=s.SALE&&t.rechargeType!=s.CHOOSE&&t.rechargeType!=s.CARD&&(t.rechargeType==s.NORMAL&&(o=game.NormalRechargeCfg.getData(t.rechargeId))&&!o.firstForever&&this.rechargeCount++,a=new game.RechargeInfo,i=this.getIsFirst(t.rechargeId),a.setData(t,i),this.rechargeList.push(a))}this.rechargeList.sort(this.onSort)}},onSort:function(e,t){return e.sortId-t.sortId},getRechargeListHas:function(e){if(!this.rechargeList||this.rechargeList.length<1)return!1;for(var t=0,a=this.rechargeList.length;t<a;t++)if(this.rechargeList[t].rechargeId==e)return!0;return!1},rechargeSuccess:function(e,t){var a=this;if(!e&&0<t)return a.rechargeMoney+=Math.floor(t/100),a.rechargeMoneyDaily+=Math.floor(t/100),a.rechargeGold+=t,a.rechargeGoldDaily+=t,void(a.rechargeMoneyMonthly+=Math.floor(t/100));var i=game.RechargeCfg.getDataById(e);if(i){switch(i.rechargeType){case game.RechargeType.NORMAL:a.normalRechargeSuccess(e);break;case game.RechargeType.CARD:a.cardRechargeSuccess(e);break;case game.RechargeType.SALE:a.saleRechargeSuccess(e)}a.rechargeMoney+=i.money,a.rechargeMoneyDaily+=i.money,a.rechargeGold+=i.addAccuGold,a.rechargeGoldDaily+=i.addAccuGold,a.rechargeMoneyMonthly+=i.money,a.rechargeTimes++}},normalRechargeSuccess:function(e){this.addFisrtData(e);var t=this.rechargeDataMap.count();if(0<this.rechargeCount&&this.rechargeCount==t){this.resetRecharge()}else{if(!this.rechargeList||this.rechargeList.length<1){return}for(var a,i=this.rechargeList.length,n=0;n<i;n++){if((a=this.rechargeList[n]).rechargeId==e){a.isFirst=!1;break}}}},saleRechargeSuccess:function(e){if(!this.saleRecharges){this.saleRecharges=[]}if(-1==this.saleRecharges.indexOf(e)){this.saleRecharges.push(e)}},cardRechargeSuccess:function(e){var t=game.CardRechargeCfg.getDataById(e);if(t){var a=t.cardType,i=this.cardRechargeDataMap.get(t.cardType);if(i)i.expireTime+=t.validDays*b8e.TimeUtil.DAY_MICRO_SECONDS;else{(i=new game.CardRechargeInfo).cardType=a,i.expireTime=b8e.TimeUtil.getTodayTime(game.SysTime.curTime)+t.validDays*b8e.TimeUtil.DAY_MICRO_SECONDS,i.collectedDaily=!1,this.cardRechargeDataMap.set(a,i)}a==game.CardType.FOREVER&&this.delForeverCardRechargeItem()}else;},cardRechargeMsg:function(e){var t=this.cardRechargeDataMap.get(e.cardType);if(!t){t=new game.CardRechargeInfo,this.cardRechargeDataMap.set(e.cardType,t)}t.setData(e),e.cardType==game.CardType.FOREVER&&this.delForeverCardRechargeItem()},delForeverCardRechargeItem:function(){if(!this.rechargeList||this.rechargeList.length<1);else for(var e,t=game.RechargeType,a=game.CardType,i=0;i<this.rechargeList.length;i++){if((e=this.rechargeList[i]).rechargeType==t.CARD)game.CardRechargeCfg.getDataById(e.rechargeId).cardType==a.FOREVER&&this.rechargeList.splice(i,1)}},resetRecharge:function(){if(this.rechargeDataMap.clear(),!this.rechargeList||this.rechargeList.length<1);else for(var e=this.rechargeList.length,t=0;t<e;t++){this.rechargeList[t].isFirst=!0}},addFisrtData:function(e){var t=game.NormalRechargeCfg.getData(e);t&&(t.firstForever||this.rechargeDataMap.set(e,1))},firstRechargeResponese:function(e){if(-1<this.firstRechargeAwards.indexOf(e));else this.firstRechargeAwards.push(e)},discountRechargeResponse:function(e){if(-1<this.discountRechargeAwards.indexOf(e));else this.discountRechargeAwards.push(e)},dailyRechargeResponse:function(e){if(-1<this.dailyRechargeAwards.indexOf(e));else this.dailyRechargeAwards.push(e)},cardAwardResponse:function(e){var t=this.cardRechargeDataMap.get(e);if(t)t.collectedDaily=!0;else;},resetDaily:function(){this.cardRechargeDataMap.forEach(function(e,t){t.collectedDaily=!1},this),this.rechargeMoneyDaily=0,this.rechargeGoldDaily=0},getRechargeList:function(){return this.rechargeList},getIsFirst:function(e){return!this.rechargeDataMap.get(e)},getFirstRecharge:function(e){return-1<this.firstRechargeAwards.indexOf(e)},getDiscountRecharge:function(e){return-1<this.discountRechargeAwards.indexOf(e)},getDailyRecharge:function(e){return-1<this.dailyRechargeAwards.indexOf(e)},getCardInfoByType:function(e){if(this.cardRechargeDataMap.has(e)){return this.cardRechargeDataMap.get(e)}return null},getFirstRechargeIsShow:function(){if(!game.moduleOpen.checkOpen(game.ME.FirstRecharge))return!1;if(!this.firstRechargeLen){var e=game.FirstRechargeCfg.getDatas();if(!e||e.length<1){return!1}this.firstRechargeLen=e.length}return this.firstRechargeAwards.length<this.firstRechargeLen},getFRIsShowById:function(e){return!!this.isInit&&(!!this.getFirstRechargeIsShow()&&(!e||this.firstRechargeAwards.indexOf(e)<0))},getDiscountRechargeIsShow:function(e){var t=game.miscData.openServerDay;game.DiscountRechargeCfg.getMaxDay()<t&&(t=0);var a=this.cfg=game.DiscountRechargeCfg.getData(t);if(!a)return!1;if(a.type!=e)return!1;var i=game.CCommonUtil.getGameChannelIdOpen;return!(2==a.type&&!i(a))&&!this.getDiscountRecharge(a.id)},getDiscountRechargeCountdown:function(){var e=game.miscData.openServerDay,t=void 0;t=game.DiscountRechargeCfg.getMaxDay()<e?0:e;var a=this.cfg=game.DiscountRechargeCfg.getData(t);if(!a)return 0;var i=a.serverEnd;return i=i||game.miscData.openServerDay+1,b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,i-e)-game.SysTime.curTime},getDailyRechargeIsShow:function(){var e=game.miscData.openServerDay;game.DailyRechargeCfg.getMaxDay()<e&&(e=0);var t=game.DailyRechargeCfg.getDataByDay(e);if(!t||t.length<1)return!1;for(var a=t.length,i=game.CCommonUtil.getGameChannelIdOpen,n=0;n<a;n++){var s=t[n];if(i(s))if(!this.getDailyRecharge(s.id))return!0}return!1},getDailyRechargeCountdown:function(){var e=game.miscData.openServerDay,t=void 0;t=game.DailyRechargeCfg.getMaxDay()<e?0:e;var a=game.DailyRechargeCfg.getDataByDay(t);if(!a||a.length<1)return!1;var i=a[0].serverEnd;return i=i||game.miscData.openServerDay+1,b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,i-e)-game.SysTime.curTime},getCardRechargeCfg:function(e){var t=game.RechargeCfg.getDataByType(game.RechargeType.CARD,this.pfType);if(t&&!(t.length<1)){for(var a,i,n=t.length,s=0;s<n;s++)if(a=t[s],(i=game.CardRechargeCfg.getDataById(a.rechargeId)).cardType==e)return i;return null}},getCardIsHas:function(e){var t=this.cardRechargeDataMap.get(e);if(t)return t.expireTime>game.SysTime.curTime||e==game.CardType.FOREVER;return!1},getRechargePass:function(){if(void 0!==this.needCheckRecharge)return!this.needCheckRecharge||0<this.rechargeMoney;if(null==this.needCheckRecharge){var e=game.RechargeMiscCfg.getData("isOpenRecharge");if(e){var t=0|e.value;this.needCheckRecharge=!!t}else this.needCheckRecharge=!1}return!this.needCheckRecharge||0<this.rechargeMoney},resetMonth:function(){this.rechargeMoneyMonthly=0},getIdByMonerAndType:function(e){var t=void 0;this.obj||(this.obj={});var a=this.obj;a.money=e,a.pfType=this.pfType;var i;return a.rechargeType=game.RechargeType.NORMAL,(i=game.RechargeCfg.getData(a))&&(t=i.rechargeId),t}});game.rechargeData=game.rechargeData||new e}(),function(){var e;e=b8e.Object.extends({rechargeId:0,rechargeType:0,sortId:0,isFirst:!1,isForeverFirst:!1,setData:function(e,t){this.rechargeId=e.rechargeId,this.rechargeType=e.rechargeType,this.sortId=e.sortId,this.isFirst=t;var a=game.NormalRechargeCfg.getData(this.rechargeId);a&&(this.isForeverFirst=a.firstForever)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$RechargeInfo",e)}(),function(){var e;e=b8e.Enum({RECHARGE_NONE:0,NORMAL:1,CARD:2,SALE:3,CHOOSE:4,TIMELIMITPRIZE:5,DAILY_SALE_PRIZE:6,GROWTH_PRIZE:7,ASSET_PRIZE:8,KEEP_PRIZE:9,RECALL_PRIZE:10,PUSH_PRIZE:11,SUPREME_WAR_ORDER:12,KEEP_RECHARGE_REPLENISH:13,PRIVILEGE:18,MIBAO_PRIZE:23,SPECIAL_TOKEN:25}),b8e.RC("$$game","$$RechargeType",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(899)},init:function(){var e=game.rechargeData.getCardRechargeCfg(game.CardType.MONTH);if(e){this.setMonthDes(e);var t=game.rechargeData.getCardRechargeCfg(game.CardType.FOREVER);t&&(this.setForeverDes(t),this.timer=b8e.Timer.add(this,this.updateTime,1e3,0,0))}},notify:function(e){switch(e){case this.Evts.V_GET_CARD_AWARD:case this.Evts.V_RECHARGE_SUCCESS:this.updateMonthView(),this.updateForeverView()}},onShow:function(){this.updateMonthView(),this.updateForeverView()},onHide:function(){this.timer&&this.timer.stop(),this.send(this.Evts.V2C_ON_HIDE)},updateMonthView:function(){var e=this.skin,t=this.monthInfo=game.rechargeData.getCardInfoByType(game.CardType.MONTH);if(e.monthGetPrizeBtn.node.active=!1,e.isGetBtn0.node.active=!1,e.time.node.active=!1,e.monthRechargeBtn.node.active=!0,t)if(game.SysTime.curTime<t.expireTime){var a=t.collectedDaily;e.isGetBtn0.node.active=a,e.monthGetPrizeBtn.node.active=!a,e.time.node.active=!0,e.monthRechargeBtn.node.active=!1,this.timer&&(this.timer.reset(),this.timer.start())}else e.monthRechargeBtn.node.active=!0},updateForeverView:function(){var e=this.skin,t=this.foreverInfo=game.rechargeData.getCardInfoByType(game.CardType.FOREVER);if(e.foreverGetPrizeBtn.node.active=!1,e.isGetBtn1.node.active=!1,e.foreverRechargeBtn.node.active=!0,t){var a=t.collectedDaily;e.isGetBtn1.node.active=a,e.foreverGetPrizeBtn.node.active=!a,e.foreverRechargeBtn.node.active=!1}},setMonthDes:function(e){var t=this.skin;t.month_label0.string=game.Lang.get(51634,e.gold),t.month_label1.string=game.Lang.get(51635,e.dailyGold),t.month_label2.string=game.Lang.get(51636,e.addAwardRate)},setForeverDes:function(e){var t=this.skin;t.forever_label0.string=game.Lang.get(51634,e.gold),t.forever_label1.string=game.Lang.get(51637,e.dailyGold),t.forever_label2.string=game.Lang.get(51636,e.addAwardRate)},updateTime:function(){if(this.monthInfo){var e=this.monthInfo.expireTime-game.SysTime.curTime;e<=0&&this.stopTime();var t=game.TimeUtil.formatTimeSpace(e,3);this.skin.time.string=game.Lang.get(1720,t)}else this.stopTime()},stopTime:function(){var e=this.skin;e.isGetBtn0.node.active=!1,e.monthGetPrizeBtn.node.active=!1,e.time.node.active=!1,e.monthRechargeBtn.node.active=!0,this.timer.stop()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.MonthCard,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(901),this.setSize(340,203)},init:function(){var e=this.icon=b8e.Sprite.get();e.addToParent(this.skin.icon),e.setAnchor(.5,.5)},setData:function(){var e,t=this,a=t.data,i=t.skin;if(i.cardPage.active=!1,i.normalPage.active=!1,e=game.RechargeCfg.getDataById(a.rechargeId)){var n=game.ResCfg.getUrl(98,e.icon);if(t.icon.loadTexture(n),i.moneyLab.string=game.Lang.get(1701,e.money),a.rechargeType==game.RechargeType.NORMAL){this.setNormalPage()}else this.setCardPage()}else;},setNormalPage:function(){var e=this.skin,t=this.data,a=t.isFirst,i=t.isForeverFirst,n=game.NormalRechargeCfg.getData(t.rechargeId);if(n){e.normalPage.active=!0,e.firstSign.active=!i&&a;var s=(e.rebateSign.active=i)||a,o=s?n.firstExtraGold:n.extraGold,r=s?1702:1703;0==o?e.desc.active=!1:(e.desc.active=!0,e.desc.string=game.Lang.get(r,o)),e.name.string=game.Lang.get(1704,n.gold)}},setCardPage:function(){var e=this.skin,t=this.data,a=game.CardRechargeCfg.getDataById(t.rechargeId);if(a){e.cardPage.active=!0;var i=void 0;i=a.cardType==game.CardType.WEEK?game.Lang.get(8324):0<a.dailyGold?game.Lang.get(1705,a.dailyGold):game.Lang.get(1726,a.dailyBindGold),e.name.string=game.Lang.get(1704,a.gold),e.desc.string=i}else;},moneyBtn:function(){this.send(game.RechargeEvts.V_RECHARGE,this.data.rechargeId)}}),b8e.RC("$$game","$$RechargeItem",e)}(),function(){var e=game.View.extends({progressWidth:0,ctor:function(){this._super(902)},notify:function(e){var t=this,a=t.Evts;switch(e){case a.V_VIP_EXP_CHANGE:case a.V_VIP_LEVEL_CHANGE:t.setVipProgress();break;case a.V_RECHARGE_SUCCESS:case a.V_INIT_MODEL:t.setRechargeList()}},init:function(){var e=this.skin,t=this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.RechargeItem,t.addToParent(e.list),t.layout.spacingX=6,t.layout.spacingY=5,t.layout.paddingLeft=7,t.layout.paddingTop=2,t.bindEnum=game.ME.Recharge,this.progressWidth=e.progress.node.width;var a=game.IS_WANBA&&game.LoginConfig.isQQWeChatGame;e.qqBalancePage.active=a,e.nomalPage.active=!a},onShow:function(){this.setVipProgress(),this.setRechargeList(),game.LoginConfig.isQQWeChatGame&&game.sdk.getQQBalance(this.refreshQQBalance,this)},setRechargeList:function(){var e=this;e.rechargeList=game.rechargeData.getRechargeList(),e.gridList.setData(e.rechargeList)},onHide:function(){},setVipProgress:function(){var e=this.skin,t=game.mainRoleData.vipLevel;e.curVipLevel.string=t;var a=game.amount.get(game.AmountType.VIP_EXP),i=game.VipCfg.getData(t);if(i){var n=1;if(game.VipCfg.getMaxLv()<=t)e.progressLab.string=a+"/"+i.needNum,e.needRecharge.string="",n=a/i.needNum,e.needRecharge.active=!1,e.words.loadTexture(game.ResCfg.getUrl(10197));else{var s=game.VipCfg.getData(t+1);if(!s)return;e.words.loadTexture(game.ResCfg.getImgUrl(s.banner)),e.progressLab.string=a+"/"+s.needNum;var o=s.needNum-a;e.needRecharge.active=!0,e.needRecharge.string="Z"+o+"YJV"+s.vipLv,n=a/s.needNum}n=1<n?1:n,e.progress.node.width=this.progressWidth*n}},refreshQQBalance:function(e){this.skin.qqBalance.string=e||0},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.Recharge,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(903)},init:function(){var e=this,t=e.skin;e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList.itemRender=game.ShowItemListItem,e._prizeList.addToParent(t.node_prize),e._prizeList.layout.spacingX=18,e._weekList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._weekList.itemRender=game.ShowItemListItem,e._weekList.layout.spacingX=18,e._weekList.layout.paddingLeft=-1,e._weekList.bindEnum=game.ME.DailyExploit,e._weekList.addToParent(e.skin.node_week),e.timer=b8e.Timer.add(e,e.updateTime,1e3,0,0)},notify:function(e){switch(e){case this.Evts.V_GET_CARD_AWARD:case this.Evts.V_RECHARGE_SUCCESS:this.setBottomData()}},onShow:function(){this.skin.info1.string=game.Lang.get(8520),this.skin.info2.string=game.Lang.get(8521);var e=game.DailyTaskActiveCfg.getDatasByDay(game.dailyExploitData.openServer),t=void 0;if(e)for(var a=1,i=e.length;a<=i&&!(4<a);a++)(t=e[a-1])&&(this.getComponent("lbl"+a).string=t.active);this.createPrize(),this.setBottomData()},onHide:function(){this.timer&&this.timer.stop()},createPrize:function(){var e=game.rechargeData.getCardRechargeCfg(game.CardType.WEEK),t=game.CfgUtil.getPrizeListInfo(e.dailyAward,null,game.IconSizeEnum.GRID_SIZE_84);this._prizeList.setData(t.items);var a=game.dailyExploitData.getWeekCardAwards(),i=game.CfgUtil.getPrizeListInfo2(a,null,game.IconSizeEnum.GRID_SIZE_84);this._weekList.setData(i.items)},setBottomData:function(){var e=this.skin,t=this.cardInfo=game.rechargeData.getCardInfoByType(game.CardType.WEEK);if((e.weekGetPrizeBtn.node.active=!1,e.time.node.active=!1,e.weekRechargeBtn.node.active=!0,e.isGetBtn.node.active=!1,t)&&game.SysTime.curTime<t.expireTime){var a=t.collectedDaily;e.weekGetPrizeBtn.node.active=!a,e.isGetBtn.node.active=a,e.time.node.active=!0,e.weekRechargeBtn.node.active=!1,this.timer&&(this.timer.reset(),this.timer.start())}},updateTime:function(){if(this.cardInfo){var e=this.cardInfo.expireTime-game.SysTime.curTime;e<=0&&this.stopTime();var t=game.TimeUtil.formatTimeSpace(e,3);this.skin.time.string=game.Lang.get(1720,t)}else this.stopTime()},stopTime:function(){var e=this.skin;e.isGetBtn.node.active=!1,e.weekGetPrizeBtn.node.active=!1,e.time.node.active=!1,e.weekRechargeBtn.node.active=!0,this.timer.stop()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.WeekCard,e)}(),function(){var e;e=b8e.Enum({UPDATE_DATA:-1,SELECT_TAB:-1,UPDATE_BTN_STATE:-1,UPDATE_RECOMMAND:-1,FOLLOW:b8e.enc(),CANCEL_FOLLOW:b8e.enc(),SEND_GIFT:b8e.enc(),RECV_GIFT:b8e.enc(),BLACK:b8e.enc(),CANCEL_BLACK:b8e.enc(),C_BLACK_CHANGE:b8e.enc(),C_FOLLOW_CHANGE:b8e.enc(),C2C_INIT_RELATION:b8e.enc()}),b8e.RC("$$game","$$RelationEvts",e)}(),function(){var e=game.Control.extends({spotAlert:null,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.RELATION,game.SAE.HOME)},triggerOpen:function(e){e==this.moduleEnum&&this.sender.RelationReq()},ipc:function(){var e=this;e.gevts={RelationEvts:{BLACK:e.blackReqG,CANCEL_BLACK:e.cancelBlackReqG,FOLLOW:e.followReqG,CANCEL_FOLLOW:e.cancelFollowReqG}},e.evts={},e.handels={RelationResp:e.relationResp,RefreshRecommendResp:e.refreshRecommendResp,FollowResp:e.followResp,CancelFollowResp:e.cancelFollowResp,BlackResp:e.blackResp,CancelBlackResp:e.cancelBlackResp,GiveGiftResp:e.giveGiftResp,ReceiveGiftResp:e.receiveGiftResp,FansMsg:e.fansNotify}},blackReqG:function(e){if(e)if(game.relationData.getTabTypeArr(game.RelationTabType.BLACK).length>=game.relationData.BLACK_MAX){game.notice.show(9292)}else this.sender.BlackReq(e.data)},cancelBlackReqG:function(e){if(e)this.sender.CancelBlackReq(e.data);else;},followReqG:function(e){if(e)if(game.relationData.isInBlackList(e.data)){game.notice.show(9004)}else{if(game.relationData.getTabTypeArr(game.RelationTabType.FOLLOW).length>=game.relationData.FOLLOW_MAX){game.notice.show(9293)}else this.sender.FollowReq(e.data)}},cancelFollowReqG:function(e){if(e)this.sender.CancelFollowReq(e.data);else;},refreshRecommendResp:function(e){var t=e.readProtobuf(game.pb.RefreshRecommendResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.list;game.relationData.updateRolesInfo(game.RelationTabType.RECOMMAND,a),this.nextTime=game.SysTime.curTime+5e3,this.send(game.RelationEvts.UPDATE_RECOMMAND),this.dpt(this.Evts.C2C_INIT_RELATION),this.checkAlert()}},checkAlert:function(){var e=game.relationData.recvNum<game.relationData.RECV_MAX,t=0<game.relationData.getCanRecvCount(),a=e&&t;this.spotAlert.alert=a},dailyReset:function(){game.relationData.giveNum=0,game.relationData.recvNum=0,this.sender.RelationReq()},relationResp:function(e){var t=e.readProtobuf(game.pb.RelationResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.followList,i=t.fansList,n=t.blackList,s=t.recommendList,o=t.giveNum,r=t.receiveNum;this.syncRelation(a,i,n,s,o,r),this.send(game.RelationEvts.UPDATE_DATA),this.dpt(this.Evts.C2C_INIT_RELATION),this.checkAlert()}},followResp:function(e){var t=e.readProtobuf(game.pb.FollowResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.player;game.relationData.updateRoleInfo(game.RelationTabType.FOLLOW,a),this.send(game.RelationEvts.UPDATE_DATA),game.notice.show(9294),this.dpt(game.RelationEvts.C_FOLLOW_CHANGE)}},cancelFollowResp:function(e){var t=e.readProtobuf(game.pb.CancelFollowResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.roleid;game.relationData.delRoleInfo(game.RelationTabType.FOLLOW,a),this.send(game.RelationEvts.UPDATE_DATA),game.notice.show(9295),this.dpt(game.RelationEvts.C_FOLLOW_CHANGE)}},blackResp:function(e){var t=e.readProtobuf(game.pb.BlackResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.player;game.relationData.updateRoleInfo(game.RelationTabType.BLACK,a),this.send(game.RelationEvts.UPDATE_DATA),game.notice.show(9296),this.dpt(game.RelationEvts.C_BLACK_CHANGE,a.roleid)}},cancelBlackResp:function(e){var t=e.readProtobuf(game.pb.CancelBlackResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.roleid;game.relationData.delRoleInfo(game.RelationTabType.BLACK,a),this.send(game.RelationEvts.UPDATE_DATA),game.notice.show(9297),this.dpt(game.RelationEvts.C_BLACK_CHANGE)}},giveGiftResp:function(e){var t=e.readProtobuf(game.pb.GiveGiftResponse);if(0<t.code){game.notice.noticeError(t.code)}else{for(var a=t.roleidList,i=0,n=a.length;i<n;i++){var s=a[i];if(null!=s)game.relationData.giveNum++,game.relationData.updateGiftSend(s);else;}this.send(game.RelationEvts.UPDATE_DATA),game.notice.show(9298)}},receiveGiftResp:function(e){var t=e.readProtobuf(game.pb.ReceiveGiftResponse);if(0<t.code){game.notice.noticeError(t.code)}else{for(var a=t.roleidList,i=0,n=a.length;i<n;i++){var s=a[i];if(null!=s)game.relationData.recvNum++,game.relationData.updateGiftRecv(s);else;}this.checkAlert(),this.send(game.RelationEvts.UPDATE_DATA),game.notice.show(9299)}},fansNotify:function(e){var t=e.readProtobuf(game.pb.FansNotify);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.player;game.relationData.updateRoleInfo(game.RelationTabType.FANS,a),this.send(game.RelationEvts.UPDATE_DATA)}},syncRelation:function(e,t,a,i,n,s){game.relationData.updateRolesInfo(game.RelationTabType.FOLLOW,e),game.relationData.updateRolesInfo(game.RelationTabType.FANS,t),game.relationData.updateRolesInfo(game.RelationTabType.BLACK,a),game.relationData.updateRolesInfo(game.RelationTabType.RECOMMAND,i),game.relationData.giveNum=n,game.relationData.recvNum=s},notify:function(e,t){switch(e){case game.RelationEvts.SELECT_TAB:if(t){this.selectTab(t)}break;case game.RelationEvts.FOLLOW:if(!t){return}this.followReqG({data:t.roleId});break;case game.RelationEvts.CANCEL_FOLLOW:if(!t){return}this.cancelFollowReqG({data:t.roleId});break;case game.RelationEvts.SEND_GIFT:if(!t){return}if(this.canSendeGift()){this.sender.GiveGiftReq(t.roleId)}break;case game.RelationEvts.RECV_GIFT:if(!t){return}if(this.canRecv()){this.sender.ReceiveGiftReq(t.roleId)}break;case game.RelationEvts.BLACK:if(!t){return}this.blackReqG({data:t.roleId});break;case game.RelationEvts.CANCEL_BLACK:if(!t){return}this.cancelBlackReqG({data:t.roleId});break;case game.RelationEvts.UPDATE_BTN_STATE:this.updateRefreshRecommend()}},canSendeGift:function(){var e=!0;if(game.relationData.giveNum>=game.relationData.SEND_MAX){game.notice.show(9300),e=!1}else if(game.relationData.getCanSendCount()<=0){game.notice.show(9301),e=!1}return e},updateRefreshRecommend:function(){this.nextTime&&this.nextTime>game.SysTime.curTime||this.sender.RefreshRecommendReq()},canRecv:function(){var e=!0;if(game.relationData.recvNum>=game.relationData.RECV_MAX){game.notice.show(9302),e=!1}else if(game.relationData.getCanRecvCount()<=0){game.notice.show(9303),e=!1}return e},no_friends_sp:function(){this.tabRecommandBtn()},tabFollowBtn:function(){this.selectTab(game.RelationTabType.FOLLOW)},tabFansBtn:function(){this.selectTab(game.RelationTabType.FANS)},tabBlackBtn:function(){this.selectTab(game.RelationTabType.BLACK)},tabRecommandBtn:function(){this.selectTab(game.RelationTabType.RECOMMAND)},selectTab:function(e){game.relationData.setSelectTab(e),this.send(game.RelationEvts.UPDATE_DATA)},selectToggle:function(e){this.selectTab(e+1)},sendGiftBtn:function(){this.canSendeGift()&&this.sender.GiveGiftReq(0)},cancelFollowBtn:function(){game.relationData.switchShowSend(),this.send(game.RelationEvts.UPDATE_DATA)},cancelBtn:function(){game.relationData.switchShowSend(),this.send(game.RelationEvts.UPDATE_DATA)},refreshBtn:function(){if(this.nextTime&&this.nextTime>game.SysTime.curTime){var e=game.TimeUtil.formatTimeSpace(this.nextTime-game.SysTime.curTime+1e3);game.notice.show(52218,e)}else this.updateRefreshRecommend()},recvGiftBtn:function(){if(this.canRecv()){this.sender.ReceiveGiftReq(0)}},left_btn:function(){game.relationData.gotoPerRankPage(),this.send(game.RelationEvts.UPDATE_DATA,{pageOP:-1})},right_btn:function(){game.relationData.gotoNextRankPage(),this.send(game.RelationEvts.UPDATE_DATA,{pageOP:1})},initTestData:function(){for(var e=[],t=1;t<=4;t++){for(var a=[],i=0;i<20;i++){var n=new game.pb.Relation.ctor.Player;n.roleid=1e4*t+i+1,n.name=game.Lang.get(9541,t,i+1),n.level=2*i+50,n.power=3e5+10*i,n.vipLv=i%10,n.online=!!(i%2),n.state=!!(i%2),n.ismale=!!(i%2),a.push(n)}e.push(a)}this.syncRelation(e[0],e[1],e[2],e[3],2,3),this.send(game.RelationEvts.UPDATE_DATA)},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.YUJO_SHOP)}}),t=game.Sender.extends({ipc:function(){this.msg={RelationReq:null,RefreshRecommendReq:null,FollowReq:this.followRequest,CancelFollowReq:this.cancelFollowRequest,BlackReq:this.blackRequest,CancelBlackReq:this.cancelBlackRequest,GiveGiftReq:this.giveGiftRequest,ReceiveGiftReq:this.receiveGiftRequest}},followRequest:function(e){var t=game.pb.FollowRequest;t.roleid=e,this.write(t)},cancelFollowRequest:function(e){var t=game.pb.CancelFollowRequest;t.roleid=e,this.write(t)},blackRequest:function(e){var t=game.pb.BlackRequest;t.roleid=e,this.write(t)},cancelBlackRequest:function(e){var t=game.pb.CancelBlackRequest;t.roleid=e,this.write(t)},giveGiftRequest:function(e){var t=game.pb.GiveGiftRequest;t.roleid=e,this.write(t)},receiveGiftRequest:function(e){var t=game.pb.ReceiveGiftRequest;t.roleid=e,this.write(t)}});b8e.module.registerControl(game.ME.Relation,e,game.RelationEvts,t)}(),function(){var e;e=b8e.Enum({MIN:0,FOLLOW:1,FANS:2,BLACK:3,RECOMMAND:4,MAX:5}),b8e.RC("$$game","$$RelationTabType",e)}(),function(){var e=b8e.Object.extends({isShowSend:!0,pageNum:1,selectType:game.RelationTabType.FOLLOW,roleRelationMap:null,giveNum:0,recvNum:0,PER_PAGE_COUNT:5,FOLLOW_MAX:50,FANS_MAX:200,BLACK_MAX:20,SEND_MAX:50,RECV_MAX:10,ctor:function(){this._super(),this.createRelationMaps()},init:function(){},createRelationMaps:function(){this.roleRelationMap=b8e.HashMap.get();for(var e=1;e<game.RelationTabType.MAX;e++){var t=b8e.HashMap.get();this.roleRelationMap.set(e,t)}},switchShowSend:function(){this.isShowSend=!this.isShowSend;var a=this,e=this.getTabTypeMap(game.RelationTabType.FOLLOW);if(e)e.forEach(function(e,t){t.isShowSend=a.isShowSend},this);else;},getSortTabTypeArr:function(e){var t=null;switch(e){case game.RelationTabType.FOLLOW:t=this.isShowSend?this.followSortRule:this.cancelFollowSortRule;break;case game.RelationTabType.FANS:case game.RelationTabType.BLACK:case game.RelationTabType.RECOMMAND:t=this.followSortRule}var a=this.getTabTypeArr(e);if(t&&a&&0<a.length){a.sort(t)}return a},followSortRule:function(e,t){if(e.isOnline&&!t.isOnline){return-1}if(!e.isOnline&&t.isOnline){return 1}if(e.power>t.power){return-1}if(e.power<t.power){return 1}return 0},cancelFollowSortRule:function(e,t){if(e.isOnline&&!t.isOnline){return 1}if(!e.isOnline&&t.isOnline){return-1}if(e.power>t.power){return 1}if(e.power<t.power){return-1}return 0},fansSortRule:function(){},blackSortRule:function(){},recommadnSortRule:function(){},isFans:function(e){return this.hasRoleInfo(game.RelationTabType.FANS,e)},isFollowed:function(e){return this.hasRoleInfo(game.RelationTabType.FOLLOW,e)},isInBlackList:function(e){return this.hasRoleInfo(game.RelationTabType.BLACK,e)},getTabTypeArr:function(e){var t=this.getTabTypeMap(e);if(t)return t.values();b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728")},getTabTypeMap:function(e){if(e<=game.RelationTabType.MIN||e>=game.RelationTabType.MAX){return b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728"),null}return this.roleRelationMap.get(e)},updateRolesInfo:function(e,t){if(!t||t.length<=0);else if(e<=game.RelationTabType.MIN||e>=game.RelationTabType.MAX){b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728")}else{e==game.RelationTabType.RECOMMAND&&this.clearRecommand();for(var a=0,i=t.length;a<i;a++){var n=t[a];if(n)this.updateRoleInfo(e,n);else;}}},updateRoleInfo:function(e,t){var a=this,i=a.getTabTypeMap(e);if(i){var n=t.roleid,s=i.get(n);if(!s){s=new game.RelationItemInfo,i.set(n,s)}s.setData(t);var o=game.RelationTabType;switch(e){case o.FOLLOW:if(a.delRoleInfo(o.RECOMMAND,n),a.delRoleInfo(o.BLACK,n),!(r=a.getRoleInfoById(o.FANS,n))){break}r.isFollwEachOther=!0;break;case o.FANS:if(a.delRoleInfo(o.RECOMMAND,n),!(r=a.getRoleInfoById(o.FOLLOW,n))){break}r.isFollwEachOther=!0;break;case o.BLACK:a.delRoleInfo(o.FOLLOW,n),a.delRoleInfo(o.FANS,n),a.delRoleInfo(o.RECOMMAND,n);break;case o.RECOMMAND:var r,g=o.RECOMMAND;if(r=a.getRoleInfoById(o.FOLLOW,n)){this.delRoleInfo(g,n)}if(r=a.getRoleInfoById(o.BLACK,n)){this.delRoleInfo(g,n)}}var l=a.isFans(n)&&a.isFollowed(n);s.isFollwEachOther=l}else{b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728")}},getRoleInfoById:function(e,t){var a=this.getTabTypeMap(e);if(!a){return b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728"),null}var i=a.get(t);if(i)return i;return null},clearRecommand:function(){var e=game.RelationTabType,t=this.getTabTypeMap(e.RECOMMAND);0<t.values().length&&t.clear()},getCanSendCount:function(){var e=this.getTabTypeArr(game.RelationTabType.FOLLOW);if(!e||e.length<=0){return 0}for(var t=0,a=0,i=e.length;a<i;a++){var n=e[a];if(n){if(!n.state){t++}}else;}return t},getCanRecvCount:function(){var e=this.getTabTypeArr(game.RelationTabType.FANS);if(!e||e.length<=0){return 0}for(var t=0,a=0,i=e.length;a<i;a++){var n=e[a];if(n){if(n.state){t++}}else;}return t},updateGiftSend:function(e){var t=this.getRoleInfoById(game.RelationTabType.FOLLOW,e);if(t)t.state=!t.state;else;},updateGiftRecv:function(e){var t=this.getRoleInfoById(game.RelationTabType.FANS,e);if(t)t.isRecved=!0,t.state=!1;else;},delRoleInfo:function(e,t){var a=this.getTabTypeMap(e);if(!a){if(!a){return void b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728")}}switch(e){case game.RelationTabType.FOLLOW:if(!(i=this.getRoleInfoById(game.RelationTabType.FANS,t))){break}i.isFollwEachOther=!1;break;case game.RelationTabType.FANS:var i;if(!(i=this.getRoleInfoById(game.RelationTabType.FOLLOW,t))){break}i.isFollwEachOther=!1;break;case game.RelationTabType.BLACK:case game.RelationTabType.RECOMMAND:}a.del(t)},hasRoleInfo:function(e,t){var a=this.getTabTypeMap(e);if(a)return a.has(t);return!1},getroleInfoArrByPageByType:function(){var e=this;if(e.pageNum<=0){this.pageNum=1}game.relationData.getPageCount()<e.pageNum&&(e.pageNum=e.pageNum-1);var t=e.PER_PAGE_COUNT;if(t<=0){return null}var a=null,i=e.getSortTabTypeArr(e.selectType),n=(e.pageNum-1)*t,s=e.pageNum*t,o=i.length;if(o<=n&&(n=(e.pageNum-2)*t,s=(e.pageNum-1)*t),s=Math.min(s,o),0<o){a=[];for(var r=n;r<s;r++){var g=i[r];if(g)a.push(g);else;}}return a},getPageCount:function(){var e=this.getTabTypeArr(this.selectType);if(e&&0<e.length){var t=e.length;return Math.ceil(t/this.PER_PAGE_COUNT)}return 1},gotoNextRankPage:function(){if(this.pageNum<1){this.pageNum=1}var e=this.PER_PAGE_COUNT,t=this.getTabTypeArr(this.selectType);this.pageNum;if(this.pageNum*e<t.length){this.pageNum++}},gotoPerRankPage:function(){if(this.pageNum<1){this.pageNum=1}var e=this.PER_PAGE_COUNT,t=this.getTabTypeArr(this.selectType),a=(this.pageNum-1)*e;this.pageNum;if(a<t.length&&1<this.pageNum){this.pageNum--}},setSelectTab:function(e){if(e<=game.RelationTabType.MIN||e>=game.RelationTabType.MAX){b8e.error("tabType: ",e,"\u4e0d\u5b58\u5728"),this.selectType=game.RelationTabType.FOLLOW}if(this.isShowSend=!0,this.selectType!==e){this.pageNum=1,this.selectType=e}},getCountByType:function(e){var t=this.getTabTypeMap(e);return t?t.count():0}});game.relationData=game.relationData||new e}(),function(){var e;e=b8e.Object.extends({roleId:0,name:"",level:0,vipLv:0,power:0,isOnline:!1,state:!1,isRecved:!1,isMale:!1,isFollwEachOther:!1,isShowSend:!0,ctor:function(){this._super()},setData:function(e){e&&(this.roleId=e.roleid,this.name=e.name,this.level=e.level,this.vipLv=e.vipLv,this.power=e.power,this.isOnline=e.online,this.state=e.state,this.isMale=e.ismale)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$RelationItemInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(924),this.setSize(600,170)},init:function(){this.headIcon=b8e.Sprite.get(),this.headIcon.setAnchor(0,1),this.headIcon.setSize(84,84),this.headIcon.addToParent(this.skin.head_sp)},setData:function(){var e=this.data;if(e){var t=this.skin;t.vip_sp.node.active=0<e.vipLv;var a=e.vipLv;a=game.HtmlUtil.getImgText("V"),t.vip_sp0.string=a,t.follow_each_sp.node.active=e.isFollwEachOther,t.name_lab.string=e.name,t.power_lab.string=e.power,t.lv_lab.string=e.level;var i=e.isOnline?game.Color.GREEN:game.Color.RED;t.state_lab.node.color=i,t.state_lab.string=e.isOnline?game.Lang.get(9233):game.Lang.get(9234),this.loadHeadIcon(e.isMale),t.follow_root.active=!1,t.fans_root.active=!1,t.black_root.active=!1,t.recommand_root.active=!1;var n=game.relationData.selectType,s=e.isShowSend;switch(n){case game.RelationTabType.FOLLOW:t.follow_root.active=!0;var o=s&&!e.state;if(t.sendGiftBtn.node.active=o,s){t.sended_lab.node.active=e.state}else t.sended_lab.node.active=!1;t.delBtn.node.active=!s;break;case game.RelationTabType.FANS:t.fans_root.active=!0,t.red_sp.node.active=game.relationData.recvNum<game.relationData.RECV_MAX,t.fansRecvGiftBtn.node.active=e.state&&!e.isRecved,t.fans_recved_lab.node.active=e.isRecved&&e.isFollwEachOther,t.fansFollowBtn.node.active=!e.isFollwEachOther;break;case game.RelationTabType.BLACK:t.black_root.active=!0;break;case game.RelationTabType.RECOMMAND:t.recommand_root.active=!0}}else;},sendGiftBtn:function(){this.send(game.RelationEvts.SEND_GIFT,{roleId:this.data.roleId})},delBtn:function(){this.send(game.RelationEvts.CANCEL_FOLLOW,{roleId:this.data.roleId})},fansFollowBtn:function(){this.send(game.RelationEvts.FOLLOW,{roleId:this.data.roleId})},fansRecvGiftBtn:function(){this.send(game.RelationEvts.RECV_GIFT,{roleId:this.data.roleId})},cancelBtn:function(){this.send(game.RelationEvts.CANCEL_BLACK,{roleId:this.data.roleId})},followBtn:function(){this.send(game.RelationEvts.FOLLOW,{roleId:this.data.roleId})},headBtn:function(){this.dptG(game.ChatEvts.SHOW_PLAYER,this.data.roleId)},loadHeadIcon:function(e){var t=game.ResCfg.getHead(e);this.headIcon.loadTexture(t)}}),b8e.RC("$$game","$$RelationItemView",e)}(),function(){var e=game.View.extends({roleList:null,tabType:0,time:0,ctor:function(){this._super(925),this.spotAlerts={SHOP_RELATION:this.shopAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},init:function(){this.roleList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.roleList.perPageNum=5,this.roleList.itemRender=game.RelationItemView,this.roleList.bindEnum=game.ME.Relation,this.roleList.layout.paddingLeft=10,this.roleList.layout.spacingY=3,this.roleList.addToParent(this.skin.roleScrollView)},notify:function(e){switch(e){case game.RelationEvts.UPDATE_DATA:this.updateData();break;case game.RelationEvts.UPDATE_RECOMMAND:this.updateData(),this.updataTimer()}},onShow:function(){this.updateData()},onHide:function(){},updateData:function(){this.selectTab(game.relationData.selectType),this.updateList(),this.updateFunBar()},updateFunBar:function(){var e=this.skin;e.follow_root.active=!1,e.fans_root.active=!1,e.refresh_root.active=!1;var t="";switch(game.relationData.selectType){case game.RelationTabType.FOLLOW:e.follow_root.active=!0,e.send_state_root.active=game.relationData.isShowSend,e.cancel_follow_state_root.active=!game.relationData.isShowSend,t=game.relationData.giveNum+"/"+game.relationData.SEND_MAX,e.left_num_lab.string=game.Lang.get(6607,t);var a=game.relationData.getTabTypeArr(game.RelationTabType.FOLLOW).length;e.no_friends_sp.string=game.Lang.get(6608),e.no_friend.active=!(a&&0<a),t=a+"/"+game.relationData.FOLLOW_MAX,e.right_num_lab.string=game.Lang.get(6609,t);break;case game.RelationTabType.FANS:e.fans_root.active=!0,t=game.relationData.recvNum+"/"+game.relationData.RECV_MAX,e.left_num_lab.string=game.Lang.get(6610,t);var i=game.relationData.getTabTypeArr(game.RelationTabType.FANS).length;e.no_friends_sp.string=game.Lang.get(6614),e.no_friend.active=!(i&&0<i),t=i+"/"+game.relationData.FANS_MAX,e.right_num_lab.string=game.Lang.get(6611,t);break;case game.RelationTabType.BLACK:var n=game.relationData.getTabTypeArr(game.RelationTabType.BLACK).length;e.no_friends_sp.string=game.Lang.get(6613),e.no_friend.active=!(n&&0<n),t=n+"/"+game.relationData.BLACK_MAX,e.left_num_lab.string="",e.right_num_lab.string=game.Lang.get(6612,t);break;case game.RelationTabType.RECOMMAND:e.no_friend.active=!1,e.refresh_root.active=!0;a=game.relationData.getTabTypeArr(game.RelationTabType.FOLLOW).length;var s=game.relationData.getTabTypeArr(game.RelationTabType.RECOMMAND).length;t=a+"/"+game.relationData.FOLLOW_MAX,e.right_num_lab.string=game.Lang.get(6609,t),0==s&&this.send(this.Evts.UPDATE_BTN_STATE)}var o=game.relationData.getPageCount(),r=game.relationData.pageNum;o<r&&(r=game.relationData.pageNum-1),e.left_num_lab.x=e.right_num_lab.x-e.right_num_lab.width-20,e.page_lab.string=r+"/"+o},updataTimer:function(){this.time=5,this.skin.refresh.string=game.Lang.get(8629,this.time),this.cdTimer?(this.cdTimer.reset(),this.cdTimer.start()):this.cdTimer=b8e.Timer.add(this,this.updateRecommandTimer,1e3)},updateRecommandTimer:function(){this.time--,0<this.time?this.skin.refresh.string=game.Lang.get(8629,this.time):(this.skin.refresh.string=game.Lang.get(8630),this.cdTimer.stop())},updateList:function(){var e=game.relationData.getroleInfoArrByPageByType();this.roleList.setData(e)},selectTab:function(e){if(this.tabType!==e){this.tabType=e;var t=game.relationData.recvNum<game.relationData.RECV_MAX,a=0<game.relationData.getCanRecvCount();this.skin.red_sp.node.active=t&&a;for(var i=game.RelationTabType.FOLLOW;i<game.RelationTabType.MAX;i++){var n=this.getComponent("checkmark"+i);if(n)if(e===i){n.node.active=!0}else n.node.active=!1;else;}}}});b8e.module.registerView(game.ME.Relation,e)}(),function(){var e;e=b8e.Enum({V_SELECT_CHANGE:-1}),b8e.RC("$$game","$$RoleEvts",e)}(),function(){var e=game.Control.extends({btn_1:function(){this.send(this.Evts.V_SELECT_CHANGE,0)},selectToggle:function(e){this.send(this.Evts.V_SELECT_CHANGE,e)}});b8e.module.registerControl(game.ME.Role,e,game.RoleEvts)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(926),this.toggles={toggle_btn_1:game.ME.RoleEquip},this.spotAlerts={ROLE_EQUIP:this.equipAlert}},equipAlert:function(e){this.skin.red_spot_1.node.active=e.alert},onShow:function(){this.toggleSelect(0)},onHide:function(){},notify:function(e,t){switch(e){case game.RoleEvts.V_SELECT_CHANGE:this.toggleSelect(t)}},toggleSelect:function(e){if(!this._super(e));}});b8e.module.registerView(game.ME.Role,e)}(),function(){var e=game.Control.extends({equipAlert:null,exchangeGold:!1,init:function(){this.roleAlert=game.spotAlert.set(game.SAE.ROLE_EQUIP,game.SAE.ROLE),this.equipAlert=game.spotAlert.set(game.SAE.EQUIP,game.SAE.ROLE_EQUIP),this.shengZhuangAlert=game.spotAlert.set(game.SAE.SZ_ALERT,game.SAE.ROLE_EQUIP),this.huanxingAlert=game.spotAlert.set(game.SAE.HUAN_XING_ALERT,game.SAE.ROLE_EQUIP),this.expAlert=game.spotAlert.set(game.SAE.EXP_ALERT,game.SAE.ROLE_EQUIP),this.exchangeGoldAlert=game.spotAlert.set(game.SAE.EXCHANGE_GOLD_EQUIP,game.SAE.ROLE_EQUIP);var e=game.LoginConfig.heroData;e.equipModel&&e.equipModel.slots&&game.equipSlotData&&game.equipSlotData.setup(e.equipModel.slots),e.equipModel&&game.godEquipData2&&game.godEquipData2.setup(e.equipModel),e.equipModel&&game.shengZhuangSlotData&&game.shengZhuangSlotData.setup(e.equipModel.slots),e.equipModel&&game.sellData&&(game.sellData.updateLv(e.equipModel.resolveLv),game.sellData.setResolveExp(e.equipModel.resolveExp)),this.posIndex=[],this.checkGEA()},levelUp:function(){var e=game.RoleExpCfg.getData(game.mainRoleData.lv),t=0;if(e){t=e.exp}if(game.mainRoleData.exp<t);else this.sender.LevelUpReq()},ipc:function(){var e=this;e.evts={MainRole:{C_EXP_CHANGE:e.updateExp,C_LEVEL_UP:e.updateLevel,C_POWER_CHANGE:e.updatePower,C_INIT_MAIN_ROLE:e.initMainRole},Back:{C_EQUIP_UPDATE:e.changeBothEquip,C_BACK_SYN_BACK_INFO:e.updateEquipAlert,C_BACK_UPDATE_ITEMINFO:e.updateEquipAlert},GodEquipUpgrade:{C2C_WEAR_EQUIP:e.onWearEquip},Sell:{C2C_SMELIT_SUCCEED:e.smelitSucceed},Surface:{C2C_UPDATE_MODEL:e.updateModel}},e.handels={WearEquipResp:e.wearEquipRp}},triggerOpen:function(e){e==this.moduleEnum&&this.send(this.Evts.V_TRIGGER_OPEN)},onWearEquip:function(e){this.sender.WearEquipReq(e.data)},onWearGoldEquip:function(){this.exchangeGold=!0},changeBothEquip:function(){this.changeWear(),this.changeSZWear(),this.send(this.Evts.V_IS_SHOW_WEAR)},changeSZWear:function(){var e=game.equipData.getSZCanWear();this.shengZhuangAlert.alert=e},changeWear:function(){var e=game.equipData.getRoleEquipCanWear();this.equipAlert.alert=e},updateEquipAlert:function(){var e=game.equipSlotData,t=game.itemData.getNumById(308002);!e.needGoldShard||t<e.needGoldShard?this.exchangeGoldAlert.alert=!1:this.exchangeGoldAlert.alert=!0},checkGEA:function(){var e=this.exchangeGoldAlert,t=game.equipSlotData,a=t.getEquipSlotPos();if(!a||a.length<1)e.alert=!1;else{for(var i=!1,n=void(t.needGoldShard=0),s=a.length,o=0;o<s&&(n=a[o],!(i=t.getCEGoldEquipByPos(n)));o++);e.alert=i}},smelitSucceed:function(){this.send(this.Evts.C2V_UPDATE_SLOTS)},initMainRole:function(){this.checkExpAlert()},checkExpAlert:function(){var e=game.mainRoleData,t=game.RoleExpCfg.getData(game.mainRoleData.lv),a=!1;if(t){a=e.exp>=t.exp}this.expAlert.alert=a},updateExp:function(){this.checkExpAlert(),this.send(this.Evts.V_EXP_CHANGE)},updateLevel:function(){game.equipData.setRoleReadyEquip(),game.equipData.setSZReadyEquip(),this.changeBothEquip(),this.send(this.Evts.V_LEVEL_CHANGE)},updatePower:function(){this.send(this.Evts.V_POWER_CHANGE)},upDominLevel:function(){this.send(this.Evts.UPGRADE_DOMIN_LEVEL)},wearEquipRp:function(e){var t=e.readProtobuf(game.pb.WearEquipResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a,i,n=this.posIndex.length=0,s=t.equips.length;for(n=0;n<s;n++)(a=t.equips[n])&&((i=game.ItemInfoCfg.getData(a.id))&&null!=i.pos&&null!=i.pos&&this.posIndex.push(i.pos),game.equipSlotData.change(a));this.send(this.Evts.V_CHANGE_EQUIP,this.posIndex),this.dpt(this.Evts.V_CHANGE_EQUIP,this.posIndex)}},onWearShengZhuangResp:function(e){var t=this,a=e.readProtobuf(game.pb.WearShengZhuangResponse);if(0<a.code)game.notice.noticeError(a.code);else{t.posIndex.length=0;var i=a.equips;if(i&&!(i.length<1)){for(var n=i.length,s=game.shengZhuangSlotData,o=void 0,r=void 0,g=0;g<n;g++)(o=i[g])&&(r=game.ItemInfoCfg.getData(o.id))&&(null!=r.pos&&null!=r.pos&&t.posIndex.push(r.pos),s.change(o));t.checkGEA(),s.updateCurSuitCfg(),t.send(t.Evts.V_CHANGE_EQUIP,t.posIndex),t.dpt(t.Evts.V_CHANGE_EQUIP,t.posIndex),t.exchangeGold&&(t.exchangeGold=!1,t.dpt(t.Evts.C2C_WEAR_GOLD_EQUIP))}}},modelNode:function(){game.module.show(game.ME.RoleAttr)},szBtn:function(){game.moduleOpen.checkOpenWithTips(game.ME.ShengZhuangTips)&&(game.equipData.isChoiceSZ=!game.equipData.isChoiceSZ,this.send(this.Evts.C2V_SWITCH_SZ))},wearBtn:function(){var e=game.equipData,t=(e.isChoiceSZ,e.getRoleEquipReadyList());!t||t.length<1||this.sender.WearEquipReq(t)},taozhuangdaren:function(){game.module.show(game.ME.SuitMain)},suitBtn:function(){game.module.show(game.ME.Suit)},fashionBtn:function(){game.module.showToggle(game.ME.Surface,1)},nicknameBtn:function(){game.module.showToggle(game.ME.Surface,0)},taozhuang:function(){game.module.show(game.ME.SuitMain)},godEquipBtn:function(){game.module.show(game.ME.GodEquip)},btn_find:function(){game.module.show(game.ME.RoleAttr)},updateModel:function(){this.send(this.Evts.UPDATEMODEL)}}),t=game.Sender.extends({ipc:function(){this.msg={WearEquipReq:this.wearEquipReq,LevelUpReq:null}},wearEquipReq:function(e){var t=game.pb.WearEquipRequest;t.idx=e,engine.NetSender.getBytes().writeProtobuf(t)},wearShengZhuangReq:function(e){var t=game.pb.WearShengZhuangRequest;t.idx=e,this.write(t)}});b8e.module.registerControl(game.ME.RoleEquip,e,game.EquipEvts,t)}(),function(){var e=game.View.extends({_moduleSp:null,_equipIconList:null,model:null,_szAlert:!1,_exchangeGoldAlert:!1,bg:null,init:function(){this._equipIconList=[],this.animaList=[]},ctor:function(){this._super("roleEquip/RoleEquipPage"),this.spotAlerts={FASHION:this.fashionAlert,NICKNAME:this.nicknameAlert,GODEQUIP:this.godEquipAlert,EQUIP:this.equipAlert,SZ_ALERT:this.shengZhuangAlert,EXP_ALERT:this.expAlert,EXCHANGE_GOLD_EQUIP:this.exchangeGoldEquipAlert}},fashionAlert:function(e){this.skin.fashionAlert.node.active=e.alert},nicknameAlert:function(e){this.skin.nicknameAlert.node.active=e.alert},godEquipAlert:function(e){this.skin.godEquipAlert.node.active=e.alert},equipAlert:function(e){this.skin.equipAlert.active=e.alert},shengZhuangAlert:function(e){this._szAlert=e.alert,this.skin.szAlert.active=this._szAlert||this._exchangeGoldAlert},exchangeGoldEquipAlert:function(e){this._exchangeGoldAlert=e.alert,this.skin.szAlert.active=this._szAlert||this._exchangeGoldAlert,this.changeEquipAlert()},expAlert:function(e){this.skin.levelUpAlert.node.active=e.alert},notify:function(e,t){var a=this;switch(e){case a.Evts.V_IS_SHOW_WEAR:a.changeEquipAlert();break;case a.Evts.V_CHANGE_EQUIP:a.playAnima(t);break;case a.Evts.V_EXP_CHANGE:a.setExp();break;case a.Evts.V_LEVEL_CHANGE:a.setLevel();break;case a.Evts.V_POWER_CHANGE:a.setPower();break;case a.Evts.V_TRIGGER_OPEN:a.checkFuncOpen();break;case a.Evts.C2V_UPDATE_SLOTS:a.setEquipSlot();case a.Evts.UPGRADE_DOMIN_LEVEL:case a.Evts.UPDATEMODEL:a.updateModel();break;case a.Evts.C2V_SWITCH_SZ:a.switchSZ(),a.setEquipSlot(),a.changeEquipAlert()}},switchSZ:function(){this.skin.szImg.active=!game.equipData.isChoiceSZ,this.skin.equipImg.active=game.equipData.isChoiceSZ},playAnima:function(e){for(var t=this,a=e.length,i=0;i<a;i++){var n=e[i];if(!t.animaList[n]){var s=b8e.Animator.get(game.AnimType.UI_EFFECT,n);s.addToParent(t.getComponent("anima_"+n)),s.addFinishCallback(t.onComplete,t,[n]),s.load(game.ResCfg.getUrl(5019,1008)),s.setVisible(!1),t.animaList[n]=s}t.animaList[n].setVisible(!0),t.animaList[n].play(null,0)}t.finish=!1},onComplete:function(e,t){var a=this;if(a.animaList[t].setVisible(!1),!a.finish){a.finish=!0,a.setEquipSlot()}},onShow:function(){this.setLevel(),this.setExp(),this.setEquipSlot(),this.checkFuncOpen(),this.setPower(),this.switchSZ(),this.changeEquipAlert(),this.updateModel()},setLevel:function(){this.skin.level.string=game.mainRoleData.lv},setExp:function(){var e=game.mainRoleData,t=game.RoleExpCfg.getData(e.lv),a=0,i=game.CCommonUtil.replaceNum(e.exp,1);if(t){a=game.CCommonUtil.replaceNum(t.exp,1)}var n=e.exp>=t.exp,s=game.HtmlUtil.IsEnoughGOR(n);this.skin.exp.string=game.HtmlUtil.getText(s,i)+game.HtmlUtil.getText(game.Color.GREEN,"/"+a);var o=e.exp>=t.exp;this.skin.levelUp.active=o,this.skin.levelUpGray.active=!o},setPower:function(){this.skin.fightAmount.string=game.mainRoleData.power;var e=this.skin;game.AutoLayoutUtil.layoutPower(e.fightAmountBg,e.fightAmount,e.icon,e.btn_find)},setEquipSlot:function(){(game.equipData.isChoiceSZ?game.shengZhuangSlotData:game.equipSlotData).getEquipSlot().forEach(this.setSlot,this)},setSlot:function(e,t){var a,i=0|e;if(this._equipIconList[i])a=this._equipIconList[i];else{(a=game.GridUtil.createEquipSlotIcon()).addToParent(this.getComponent("equip_"+e)),this._equipIconList[i]=a}t?a.setItemInfo(t):(a.clearData(),a.clearSZInfo())},onHide:function(){b8e.Tween.kill(this.skin.left.node),b8e.Tween.kill(this.skin.right.node),b8e.Tween.kill(this.skin.expBar.node),game.equipData.isChoiceSZ=!0},updateSex:function(){},changeEquipAlert:function(){var e=this.skin,t=game.equipData,a=t.isChoiceSZ,i=void 0;for(i=1;i<=10;i++)this.getComponent("pos_alert_"+i).active=a&&game.equipSlotData.getCEGoldEquipByPos(i);var n=a?t.getSZReadyList():t.getRoleEquipReadyList();if(!n||n.length<1)e.wearBtn.active=!1;else{e.wearBtn.active=!0;var s=n.length,o=void 0;for(i=0;i<s;i++)(o=t.getItemByIdx(n[i]))&&o.pos&&(this.getComponent("pos_alert_"+o.pos).active=!0)}},checkFuncOpen:function(){},updateModel:function(){var e=this;if(game.mainRoleData){e.model||(e.model=game.sceneRoleCreate.createUIRole(game.mainRoleData),e.model.addToParent(e.skin.modelNode));var t=game.AvatarUtil;if(t.updateAmbition(e.model),!e.followModel){var a=this.followData=game.BaseRoleData.get(game.RoleType.Rank,1);this.followModel=game.sceneRoleCreate.createUIRole(a),this.followModel.addToParent(this.skin.followModelNode)}t.updateUIModel(e.model),e.model.transition(game.RoleStateType.ACTION_IDLE),t.updateUIModel(e.followModel,t.ID_5),e.followModel.transition(game.RoleStateType.ACTION_IDLE)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.RoleEquip,e)}(),function(){var e=void 0;(e=game.View.extends({_addNodeTouch:!0,_showModel:!0,fixHeight:110,ctor:function(){this._super(931)},showView:function(e){var t=this.ruleCfg=game.RuleCfg.getData(e);if(e==game.ME.DigTreasure){var a=game.DigTreasureOpenCfg.getData(game.digTreasureData.id);a&&(t=this.ruleCfg=game.DigTreasureResCfg.getData(a.urlId))}t&&(this.langKey=t.key,this.titleKey=t.titleKey,this.addToStage())},showViewByKeys:function(e,t){this.langKey=e,this.titleKey=t||0,this.addToStage()},addToStage:function(){this.parent?this.show():game.GameViewMgr.inst().showView(this,null,0,2)},init:function(){this.fixHeight=this.skin.bg.height,this._scrollBox=new b8e.ScrollBox,this._scrollBox.setScrollType(b8e.ScrollBoxType.Vertical),this._scrollBox.setContainer(this.skin.ruleStr),this._scrollBox.addToParent(this.skin.list)},onShow:function(){var e=this,t=e.langKey,a=game.Lang.getData(t);if(a){e.skin.ruleStr.string=a.lang;var i=e.titleKey||51811;a=game.Lang.getData(i),e.skin.titleLab.string=a?a.lang:"";var n=e.skin.ruleStr.height;e._scrollBox.touchMovable=710<n&&(n=710,!0),e._scrollBox.height=n+4,e._scrollBox.scrollToTop(),e.height=e.skin.height=e.skin.bg.height=n+e.fixHeight,e.skin.clickTitle.y=-e.height-26,e.onStageResize(),game.viewModule.updateLayout(e)}},onStageResize:function(){var e=b8e.stageWidth-this.width>>1,t=50+(b8e.stageHeight+this.height>>1);this.setPosition(e,t)}}))._instance=null,e.inst=function(){return e._instance||(e._instance=new e),e._instance},b8e.RC("$$game","$$RuleView",e)}(),function(){var e;e=b8e.Enum({NONE:-1,V_SHOW:-1,V_CHANGE_AUTO:-1,V_SET_LIST_COMPLETE:-1,V_SELECT_SMELTING_ITEM:-1,V_SELECT_EQUIP:-1,C_SELECT_COMPLETE:-1,V_INIT_SELECT_LIST:-1,V_HIDE_SELECT_VIEW:-1,C2C_SMELIT_SUCCEED:-1,C2V_SMELIT_SUCCEED:-1,C2V_SELECT_QUALITY:-1,SWITCH_PAGE:-1,C2V_REFRESH_VIEW:-1,V2C_SELECT_COMPLETE_ITEM:-1,C2V_SELECT_TYPE:-1,C2V_UPDATE_LIST:-1,V2C_UPDATE_LIST:-1,PARTNER_REBORN_COMPLETE:-1}),b8e.RC("$$game","$$SellEvts",e)}(),function(){var e,t=game.Control.extends({sendSellList:null,sellData:null,ipc:function(){this.handels={SellEquipResp:this.sellEquipResp,SellItemResp:this.sellItemResp,PartnerRebirthResp:this.partnerRebirthResp},this.evts={SellSelect:{C_SELECT_COMPLETE:this.selectComplete},GodEquipResolve:{C2C_SMELIT_EQUIP:this.onSmelitEquip},GoldEquipResolve:{C_SMELIT_EQUIP:this.onSmelitEquip}}},init:function(){this.sendSellList=[],this.posList=[],this.sellData=game.sellData,this.posMap=b8e.HashMap.get(),this.emptyPosMap=b8e.HashMap.get()},notify:function(e){switch(e){case this.Evts.V_SHOW:this.selling=!1;var t=game.SellType.EQUIP;game.sellData.setSellType(t),this.selectType("equipBtn");var a=game.sellData.getQuality(t);this.setSmeltingList(game.SellType.EQUIP,a),this.selectQuality();break;case this.Evts.V2C_SELECT_LIST:break;case this.Evts.V2C_UPDATE_LIST:this.send(this.Evts.C2V_UPDATE_LIST)}},setSmeltingList:function(e,t){game.sellData.sellList.length=0;var a=game.sellData.getItemList(e);if(!a||a.length<1)this.send(this.Evts.V_SET_LIST_COMPLETE);else{for(var i=void 0,n=0,s=a.length,o=0;o<s;o++)if(!((i=a[o]).quality>t)){if(5<=n)break;game.sellData.sellList.push(i),n++}this.send(this.Evts.V_SET_LIST_COMPLETE)}},sellBtn:function(){game.sellData.selectType==game.SellType.SHARD?this.sellItem():this.sellEquip()},sellItem:function(){this.sendSellList.length=0;var e=this.sellData.sellList,t=void 0,a=void 0,i=e.length;if(!(i<=0)){for(var n=0;n<i;n++)t=e[n],(a=this.getSellItemObj(n)).id=t.id,a.num=t.num,this.sendSellList.push(a);this.selling||this.sendSellList.length<1||(this.selling=!0,this.sender.SellItemReq(this.sendSellList,!1))}},getSellItemObj:function(e){return this.itemObjPool||(this.itemObjPool=[]),this.itemObjPool[e]||(this.itemObjPool[e]=new game.pb.ItemView.ctor),this.itemObjPool[e]},sellEquip:function(){this.sendSellList.length=0;var e=this.sellData.sellList,t=void 0,a=e.length;if(!(a<=0)){for(var i=0;i<a;i++)t=e[i],-1==this.sendSellList.indexOf(t.idx)&&this.sendSellList.push(t.idx);this.selling||this.sendSellList.length<1||(this.selling=!0,this.sender.SellEquipReq(this.sendSellList,!1))}},sellEquipResp:function(e){this.selling=!1;var t=e.readProtobuf(game.pb.SellEquipResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.idx,i=void 0;if(a&&0<a.length){for(var n=void 0,s=a.length,o=0;o<s;o++)n=a[o],i=game.equipData.getItemByIdx(n),game.itemData.removeItemPageList(i,!0),game.partnerEquipData.delNotWearEquipByIdx(n),game.equipData.removeItemByIdx(n);var r=9<s?9:s;this.send(this.Evts.C2V_SMELIT_SUCCEED,r)}this.setCurSellList(),this.dpt(this.Evts.C2C_SMELIT_SUCCEED),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeSmelt)}},sellItemResp:function(e){this.selling=!1;var t=e.readProtobuf(game.pb.SellItemResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.items;if(a&&0<a.length){for(var i=void 0,n=void 0,s=a.length,o=game.itemData,r=0;r<s;r++){if(i=a[r],1<o.getItemListById(i.id).length)return void b8e.warn("\u7194\u70bc\u7684id\u4e0d\u6b62\u6709\u4e00\u7ec4id\uff0c\u67e5\u770b\u914d\u7f6e\u662f\u5426\u914d\u7f6e\u6210\u4e0d\u53e0\u52a0");(n=o.getItemById(i.id))&&(n.num<=i.num?(o.removeItemByIdx(n.idx),game.itemData.removeItemPageList(n,!1)):o.change(i.idx,i.num,!1))}var g=9<s?9:s;this.send(this.Evts.C2V_SMELIT_SUCCEED,g)}this.setCurSellList(),this.dpt(this.Evts.C2C_SMELIT_SUCCEED),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeSmelt)}},setCurSellList:function(){var e=game.sellData.selectType,t=game.sellData.getQuality(e);this.setSmeltingList(e,t)},partnerRebirthResp:function(e){this.selling=!1;var t=e.readProtobuf(game.pb.PartnerRebirthResponse);0<t.code?game.notice.noticeError(t.code):(game.partnerData.rebirthTimes++,this.dpt(this.Evts.PARTNER_REBORN_COMPLETE,t.id),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeSmelt))},selectComplete:function(){this.send(this.Evts.V_SET_LIST_COMPLETE)},sellIcon_0:function(){this.openSelectView()},sellIcon_1:function(){this.openSelectView()},sellIcon_2:function(){this.openSelectView()},sellIcon_3:function(){this.openSelectView()},sellIcon_4:function(){this.openSelectView()},openSelectView:function(){game.module.show(game.ME.SellSelect)},equipBtn:function(){game.sellData.setSellType(game.SellType.EQUIP),this.selectType("equipBtn"),this.refreshSellView()},catillaBtn:function(){game.sellData.setSellType(game.SellType.CATILLA),this.selectType("catillaBtn"),this.refreshSellView()},exclusiveWeaponBtn:function(){game.sellData.setSellType(game.SellType.EXCLUSIVE_WEAPON),this.selectType("exclusiveWeaponBtn"),this.refreshSellView()},godAnimalBtn:function(){game.sellData.setSellType(game.SellType.GOD_ANIMAL_EQUIP),this.selectType("godAnimalBtn"),this.refreshSellView()},shardBtn:function(){game.sellData.setSellType(game.SellType.SHARD),this.selectType("shardBtn"),this.refreshSellView()},godEquipBtn:function(){game.sellData.setSellType(game.SellType.GOD_EQUIP),this.selectType("godEquipBtn"),this.refreshSellView()},mountEquipBtn:function(){game.sellData.setSellType(game.SellType.MOUNT_EQUIP),this.selectType("mountEquipBtn"),this.refreshSellView()},shenhunEquipBtn:function(){game.sellData.setSellType(game.SellType.SHENHUN_EQUIP),this.selectType("shenhunEquipBtn"),this.refreshSellView()},selectType:function(e){this.send(this.Evts.C2V_SELECT_TYPE,e)},refreshSellView:function(){var e=game.sellData,t=e.selectType,a=e.getQuality(t);e.clearShardList(),this.setSmeltingList(t,a)},select_btn_1:function(){game.sellData.setCurQuality(game.Quality.Q_BLUE),this.refreshSellView(),this.selectQuality()},select_btn_2:function(){game.sellData.setCurQuality(game.Quality.Q_PURPLE),this.refreshSellView(),this.selectQuality()},select_btn_3:function(){game.sellData.setCurQuality(game.Quality.Q_YELLOW),this.refreshSellView(),this.selectQuality()},select_btn_4:function(){game.sellData.setCurQuality(game.Quality.Q_RED),this.refreshSellView(),this.selectQuality()},selectQuality:function(){this.send(this.Evts.C2V_SELECT_QUALITY)},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},selectToggle:function(e){this.send(this.Evts.SWITCH_PAGE,e)},onSmelitEquip:function(e){this.selling||(this.selling=!0,this.sender.SellEquipReq(e.data,!1))}}),a=[game.ME.SellSubpage];e=game.Sender.extends({ipc:function(){this.msg={SellEquipReq:this.sellEquipReq,SellItemReq:this.sellItemReq,PartnerRebirthReq:this.partnerRebirthReq}},sellEquipReq:function(e,t){var a=game.pb.SellEquipRequest;a.idx=e,a.isRebirth=t,b8e.net.getBytes().writeProtobuf(a)},partnerRebirthReq:function(e){var t=game.pb.PartnerRebirthRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)},sellItemReq:function(e){var t=game.pb.SellItemRequest;t.items=e,b8e.net.getBytes().writeProtobuf(t)}}),b8e.module.registerControl(game.ME.Sell,t,game.SellEvts,e,a),b8e.RC("$$game","$$SellSender",e)}(),function(){var e=game.Control.extends({sendSellList:null,sellData:null,ipc:function(){var e=this;e.evts={Sell:{PARTNER_REBORN_COMPLETE:e.rebornComplete,C2C_SMELIT_SUCCEED:e.rebornComplete},Partner:{C2C_REBORN_COMPLETE:e.checkReborn,C_INIT_DATA:e.checkReborn},PartnerSpirit:{V_UPDATE_SPIRIT:e.delayCheckReborn},PartnerUpgrade:{V_UPDATE_LV:e.delayCheckReborn},PartnerBreak:{V_UPDATE_BREAK:e.delayCheckReborn},PartnerChange:{C_UPDATE_BATTLE:e.delayCheckReborn},PartnerHelp:{C_UPDATE_HELP:e.delayCheckReborn}}},triggerOpen:function(e){e==this.moduleEnum&&this.checkReborn()},init:function(){this.sellData=game.rebornData,this.spotAlert=game.spotAlert.set(game.SAE.REBORN,game.SAE.HOME)},notify:function(e){switch(e){case this.Evts.V_SHOW:this.reborning=!1;var t=game.SellType.PARTNER;game.rebornData.setSellType(t),this.refreshView("partnerBtn",!0);break;case this.Evts.V2C_SELECT_COMPLETE_ITEM:this.refreshView(),game.rebornData.clearSelect()}},delayCheckReborn:function(){b8e.hasTimeout(this.checkReborn,this)||b8e.setTimeout(this.checkReborn,this,500)},checkReborn:function(){var e=game.partnerData.getRebornPartners();this.spotAlert.alert=game.moduleOpen.checkOpen(game.ME.Reborn)&&e&&0<e.length},rebornComplete:function(){this.reborning=!1,this.refreshView(null,!0)},rebornBtn:function(){var e=game.rebornData.getSelectInfo();if(e){var t=game.rebornData.getRebornCost();if(game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,t)&&!this.reborning)switch(this.reborning=!0,game.rebornData.selectType){case game.SellType.PARTNER:this.sender.PartnerRebirthReq(e.id);break;default:this.sender.SellEquipReq([e.idx],!0)}}else game.notice.show(51624)},selectComplete:function(){this.send(this.Evts.V_SET_LIST_COMPLETE)},clickBtn:function(){game.module.show(game.ME.RebornSelect)},equipBtn:function(){game.rebornData.setSellType(game.SellType.EQUIP),this.refreshView("equipBtn",!0)},catillaBtn:function(){game.rebornData.setSellType(game.SellType.CATILLA),this.refreshView("catillaBtn",!0)},exclusiveWeaponBtn:function(){game.rebornData.setSellType(game.SellType.EXCLUSIVE_WEAPON),this.refreshView("exclusiveWeaponBtn",!0)},partnerBtn:function(){game.rebornData.setSellType(game.SellType.PARTNER),this.refreshView("partnerBtn",!0)},mountEquipBtn:function(){game.rebornData.setSellType(game.SellType.MOUNT_EQUIP),this.refreshView("mountEquipBtn",!0)},shenhunEquipBtn:function(){game.rebornData.setSellType(game.SellType.SHENHUN_EQUIP),this.refreshView("shenhunEquipBtn",!0)},refreshView:function(e,t){t&&game.rebornData.clearSelectInfo(),this.send(this.Evts.C2V_REFRESH_VIEW,e)},sureBtn:function(){}}),t=[game.ME.RebornSelect];b8e.module.registerControl(game.ME.Reborn,e,game.SellEvts,game.SellSender,t)}(),function(){var e=game.Control.extends({sellData:null,init:function(){this.sellData=game.sellData},sureBtn:function(){game.module.hide(this.moduleEnum)}});b8e.module.registerControl(game.ME.SellSelect,e,game.SellEvts)}(),function(){var e=void 0;e=b8e.Object.extends({sellList:null,readySellList:null,isAutoSell:!1,sellInfoList:null,sellInfoPool:null,selectType:0,selectQuality:0,maxSelectCount:5,ctor:function(){var e=this;e._super(),e.sellList=[],e.readySellList=[],e.tempMap=b8e.HashMap.get(),e.sellInfoList=[],e.sellInfoPool=[],e.sellSelectList=[],e.shardSelectMap=b8e.HashMap.get(),e.tempList=[],e.recycleItemsPool=[],e.extraPool=[]},updateLv:function(e){this.lv=e;var t=this.getCueLvCfg();if(t){var a=this.spriteStat;a?a.setupByCfg(t):a=this.spriteStat=game.SpriteStatUtil.setDataByCfg(t),this.power=game.CCommonUtil.getPower(a)}},getCueLvCfg:function(){var e=this.lv;return game.ResolveAttrCfg.getData(e)},setResolveExp:function(e){this.resolveExp=e},initSellSelect:function(){var e=game.ResolveMiscCfg.getData("defaultSelect");if(e&&e.value){var t=e.value.split(",");if(!(t.length<1))for(var a=void 0,i=void 0,n=void 0,s=t.length,o=0;o<s;o++){if((a=t[o].split("|")).length<2)return;i=+a[0],n=+a[1],this.sellSelectList[i]=n}}},setCurQuality:function(e){var t=this.selectType;this.sellSelectList[t]=e},getQuality:function(e){return this.sellSelectList[e]},getCurQuality:function(){if(!this.selectType)return 0;var e=this.sellSelectList[this.selectType];return e||game.Quality.Q_BLUE},setSellType:function(e){this.selectType=e},getMaterialList:function(){var e=this;if(!e.sellList||e.sellList.length<1)return null;var t=e.selectType;e.tempMap.clear();for(var a=void 0,i=void 0,n=e.sellList.length,s=void 0,o=void 0,r=void 0,g=0;g<n;g++)if((a=e.sellList[g])&&(i=e.getMaterialByInfo(t,a))&&!(i.length<1)){s=i.length;for(var l=void 0,c=void 0,h=0;h<s;h++)(o=i[h])&&(l=o.id,c=o.num,(r=e.tempMap.get(l))?r.num+=c:(r=e.getPrizeInfo(l,c),e.tempMap.set(l,r)))}return 0<e.tempMap.count()?e.tempMap.values():null},getPrizeInfo:function(e,t){this.prizeInfoMap||(this.prizeInfoMap=b8e.HashMap.get());var a=this.prizeInfoMap.get(e);return a||(a=new game.PrizeInfo,this.prizeInfoMap.set(e,a)),a.id=e,a.num=t,a},getShowSelectList:function(){var e=this.selectType,t=this.getItemList(e);return!t||t.length<1?null:t},getMaterialByInfo:function(e,t){var a=this.getExtraMaterialByInfo(e,t),i=this.getRecycleItems(e,t);return a.concat(i)},getRecycleItems:function(e,t){var a=[];if(!t||!t.id)return a;var i=game.ItemInfoCfg.getData(t.id);if(!i||!i.recycleItems)return a;var n=i.recycleItems,s=t.num;if(e==game.SellType.SHARD){var o=this.getShardNum(t.id);s=o||t.num}return a=this.getItemListToItem(n,s,"Id","Num",this.recycleItemsPool,a)},getItemListToItem:function(e,t,a,i,n,s){if(s=s||[],!e||e.length<1||!n)return s;for(var o=void 0,r=void 0,g=void 0,l=void 0,c=e.length,h=0;h<c;h++)g=e[h],l=n[h],o=b8e.getDPV(g,a),r=b8e.getDPV(g,i)*t,l?(l.id=o,l.num=r):l=n[h]=game.ItemUtil.createBaseItemInfo(o,r),s.push(l);return s},getExtraMaterialByInfo:function(e,t){this.extTempList||(this.extTempList=[]);var a=this.extTempList;switch(e){case game.SellType.EQUIP:case game.SellType.CATILLA:a=game.equipForgeData.getTotalCostByEquipInfo(t),a=this.getItemListToItem(a,1,"id","num",this.extraPool);break;case game.SellType.EXCLUSIVE_WEAPON:a=(a=game.partnerEquipData.getPartnerEquipExcCost(t))?this.getItemListToItem(a,1,"Id","Num",this.extraPool):this.extTempList;break;case game.SellType.PARTNER:a=game.partnerData.getRebirthCosts(t.id);break;case game.SellType.SHENHUN_EQUIP:case game.SellType.MOUNT_EQUIP:a=game.fosterEquipData.getRebirthCosts(t);break;case game.SellType.GOD_ANIMAL_EQUIP:a=game.godAnimalEquipData.getRebirthCosts(t)}return a},getItemList:function(e){var t=void 0,a=void 0,i=this;switch(i.tempList.length=0,e){case game.SellType.EQUIP:for(var n=game.EquipPosType.POS_1;n<=game.EquipPosType.POS_4;n++)(a=game.partnerEquipData.getAllInfosByPos(n,!1))&&(i.tempList=i.tempList.concat(a));t=i.tempList;break;case game.SellType.CATILLA:for(var s=game.EquipPosType.POS_5;s<=game.EquipPosType.POS_6;s++)(a=game.partnerEquipData.getAllInfosByPos(s,!1))&&(i.tempList=i.tempList.concat(a));t=i.tempList;break;case game.SellType.EXCLUSIVE_WEAPON:t=game.partnerEquipData.getAllInfosByPos(game.EquipPosType.POS_7,!1);break;case game.SellType.SHARD:var o=i.tempList;if((t=game.itemData.getItemListByPageId(game.BackPageId.BACK_PACK_SHARD))&&0<t.length)for(var r=void 0,g=void 0,l=t.length,c=0;c<l;c++)r=t[c],!(g=game.ItemInfoCfg.getData(r.id))||!g.recycleItems||g.recycleItems.length<1||(o[o.length]=r);t=o;break;case game.SellType.GOD_EQUIP:break;case game.SellType.PARTNER:t=game.partnerData.getRebornPartners();break;case game.SellType.SHENHUN_EQUIP:t=i.getFosterEquipListByType(game.FosterEquipType.SHENHUN);break;case game.SellType.MOUNT_EQUIP:t=i.getFosterEquipListByType(game.FosterEquipType.MOUNT);break;case game.SellType.GOD_ANIMAL_EQUIP:t=game.equipData.getAllGodAnimalEquipList();break;default:t=[]}return t&&0<t.length&&t.sort(i.onSort),t},getFosterEquipListByType:function(e){var t=this.tempFosterEquipList;(t=t||(this.tempFosterEquipList=[])).length=0;var a=game.equipData.getFosterEquipList();if(!a||a.length<1)return null;for(var i=void 0,n=void 0,s=a.length,o=0;o<s;o++)(i=a[o])&&(n=i.getCfg())&&n.types==e&&(t[t.length]=i);return t},onSort:function(e,t){return e.id-t.id},getTypeStr:function(e){var t=void 0;switch(e){case game.SellType.EQUIP:t=game.Lang.get(51598);break;case game.SellType.CATILLA:t=game.Lang.get(51599);break;case game.SellType.EXCLUSIVE_WEAPON:t=game.Lang.get(51600);break;case game.SellType.SHARD:t=game.Lang.get(51601);break;case game.SellType.GOD_EQUIP:t=game.Lang.get(51602);break;case game.SellType.PARTNER:t=game.Lang.get(51603);break;case game.SellType.SHENHUN_EQUIP:t=game.Lang.get(53530);break;case game.SellType.MOUNT_EQUIP:t=game.Lang.get(53531);break;case game.SellType.GOD_ANIMAL_EQUIP:t=game.Lang.get(53636)}return t},checkSelect:function(e){if(!this.sellList||this.sellList.length<1)return this.sellList.push(e),!0;var t=this.sellList.indexOf(e);if(-1<t)return this.sellList.splice(t,1),!0;var a=this.sellList.length<this.maxSelectCount;return a&&this.sellList.push(e),a},getIsSelect:function(e){return!(!this.sellList||this.sellList.length<1)&&-1<this.sellList.indexOf(e)},changeShardList:function(e,t){this.shardSelectMap.set(e,t)},clearShardList:function(){this.shardSelectMap.clear()},getShardNum:function(e){return this.shardSelectMap.get(e)},isChipOpen:function(){if(!this.chipOpenLv||!this.chipOpenDay){var e=game.CfgUtil.getMiscValue(game.ResolveMiscCfg,"chipOpen",!0,"|",!0);if(!e||2!=e.length)return!1;this.chipOpenLv=e[0],this.chipOpenDay=e[1]}return!(game.mainRoleData.lv<this.chipOpenLv)&&!(game.miscData.openServerDay<this.chipOpenDay)}}),game.sellData=game.sellData||new e,b8e.RC("$$game","$$SellData",e)}(),function(){var e=game.SellData.extends({sellList:null,readySellList:null,isAutoSell:!1,sellInfoList:null,sellInfoPool:null,selectType:0,selectQuality:0,rebornCost:0,ctor:function(){this._super(),this.sellList=[],this.readySellList=[],this.tempMap=b8e.HashMap.get(),this.equipList=[],this.sellInfoList=[],this.sellInfoPool=[],this.sellSelectList=[]},setSellType:function(e){this.selectType=e},getShowSelectList:function(){var e=this,t=e.selectType,a=e.getItemList(t);if(!a||a.length<1)return null;var i=void 0,n=void 0,s=a.length;switch(e.selectTempList||(e.selectTempList=[]),e.selectTempList.length=0,t){case game.SellType.EQUIP:case game.SellType.CATILLA:for(i=0;i<s;i++)(0<(n=a[i]).intensifylv||0<n.refinelv||0<n.purifylv||n.gemlv||0<n.zhulinglv||0<n.zhulingExp||0<n.fuseLv)&&e.selectTempList.push(n);return e.selectTempList;case game.SellType.EXCLUSIVE_WEAPON:for(i=0;i<s;i++)0<(n=a[i]).breakLv&&e.selectTempList.push(n);return e.selectTempList;case game.SellType.SHENHUN_EQUIP:case game.SellType.MOUNT_EQUIP:for(i=0;i<s;i++)0<(n=a[i]).star&&e.selectTempList.push(n);return e.selectTempList}return a},clearSelect:function(){this.selectTempList&&(this.selectTempList.length=0)},getMaterialList:function(){var e=this.getMaterialByInfo(this.selectType,this.selectInfo);if(!e||e.length<1)return null;this.tempMap.clear();for(var t=void 0,a=void 0,i=void 0,n=void 0,s=e.length,o=0;o<s;o++)(a=e[o])&&(i=a.id,n=a.num,(t=this.tempMap.get(i))?t.num+=n:(t=this.getPrizeInfo(i,n),this.tempMap.set(i,t)));return 0<this.tempMap.count()?this.tempMap.values():null},getMaterialByInfo:function(e,t){return this.getExtraMaterialByInfo(e,t)},getRebornCost:function(){if(!this.rebornCost){var e=game.ResolveMiscCfg.getData("rebornCost");if(!e||!e.value)return 0;this.rebornCost=+e.value}return this.rebornCost},setSelectInfo:function(e){this.selectInfo=e},getSelectInfo:function(){return this.selectInfo},clearSelectInfo:function(){this.selectInfo=null}});game.rebornData=game.rebornData||new e}(),function(){var e;e=b8e.Enum({NONE:0,EQUIP:1,CATILLA:2,EXCLUSIVE_WEAPON:3,SHARD:4,GOD_EQUIP:5,PARTNER:6,SHENHUN_EQUIP:7,MOUNT_EQUIP:8,GOD_ANIMAL_EQUIP:9}),b8e.RC("$$game","$$SellType",e)}(),function(){var e;e=game.BaseItemInfo.extends({idx:0,id:0,num:0,equip:null,isSelect:!1,setData:function(e){if(this._super(e),e.equip){this.equip=e.equip}var t=game.ItemInfoCfg.getData(this.id);if(t){var a=game.ItemCfgType;switch(t.cfgType){case a.Equip:this.__renderType=0;break;default:b8e.warn("\u65b0\u589e\u7684\u88c5\u5907\u7c7b\u578b\uff1fid:"+this.id+"itemCfgType:"+t.cfgType),this.__renderType=0}}},getCfg:function(){var e=game.ItemInfoCfg.getData(this.id);if(e)return e;return null}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$SellInfo",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(950),this.setSize(100,110)},setData:function(){if(!this._itemGrid){this._itemGrid=game.GridUtil.createSellFosterEquipIcon(game.IconSizeEnum.GRID_SIZE_105),this._itemGrid.addToParent(this.skin.icon)}game.GridUtil.setItemIcon(this._itemGrid,this.data)}}),b8e.RC("$$game","$$SellFosterItem",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super("sell/reborn_select_item"),this.setSize(540,125)},setData:function(){var e=this,t=game.rebornData.selectType;switch(t!=e.curSellType&&(e._itemGrid&&e._itemGrid.parent&&(e._itemGrid.removeFromParent(),e._itemGrid=null),e._itemGrid||(e._itemGrid=e.getIconByType(t),e._itemGrid.addToParent(e.skin.icon))),e.curSellType=t,e.curSellType){case game.SellType.EQUIP:case game.SellType.CATILLA:e.setEquip(),e._itemGrid.setData(e.data,0,!1,!1),e.setItemName(e.data.id);break;case game.SellType.EXCLUSIVE_WEAPON:e.setExclusiveWeapon(),e._itemGrid.setData(e.data,0,!1,!1),e.setItemName(e.data.id);break;case game.SellType.PARTNER:e.setPartner(),e._itemGrid.setData(e.data);break;case game.SellType.SHENHUN_EQUIP:case game.SellType.MOUNT_EQUIP:e.setShEquip(),e.setItemName(e.data.id),e._itemGrid.setData(e.data)}},setItemName:function(e){var t=game.ItemInfoCfg.getData(e);t&&(this.skin.name.string=game.HtmlUtil.getColorStrByQuality(t.quality,t.name))},setEquip:function(){var e=this.skin,t=this.data;this.setNodeActive(!0,!1,!1),e.equipLab_1.string=game.Lang.get(51587,t.intensifylv),e.equipLab_2.string=game.Lang.get(51586,t.refinelv)},setExclusiveWeapon:function(){this.setNodeActive(!1,!1,!0),this.skin.qualityLab.string=game.Lang.get(51595,this.data.breakLv)},setPartner:function(){this.setNodeActive(!1,!0,!1),this.skin.power.string=game.Lang.get(51585,this.data.fightAmount),this.skin.name.string=this.data.name},setShEquip:function(){var e=this.skin,t=this.data;this.setNodeActive(!0,!1,!1),e.equipLab_1.string=game.Lang.get(53528,t.totalFight),e.equipLab_2.string=game.Lang.get(53521,t.star)},setNodeActive:function(e,t,a){var i=this.skin;i.power.active=t,i.equipNode.active=e,i.qualityLab.active=a},selectBtn:function(){game.rebornData.setSelectInfo(this.data),game.module.hide(game.ME.RebornSelect),this.send(game.SellEvts.V2C_SELECT_COMPLETE_ITEM)},getIconByType:function(e){return this.iconPool||(this.iconPool=[]),this.iconPool[e]||(this.iconPool[e]=game.GridUtil.getSellIconByType(e)),this.iconPool[e]}}),b8e.RC("$$game","$$RebornSelectItem",e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(950),this.setSize(100,110)},setData:function(){if(!this._itemGrid){this._itemGrid=game.GridUtil.createSellEquipIcon(game.IconSizeEnum.GRID_SIZE_105),this._itemGrid.addToParent(this.skin.icon)}game.GridUtil.setItemIcon(this._itemGrid,this.data)}}),b8e.RC("$$game","$$SellItem",e)}(),function(){var e=game.View.extends({sellData:null,sellList:null,_showModel:!0,ctor:function(){this._super(952)},init:function(){var e=this.skin;this.sellList=[];var t=this.gridList=new game.List;t.itemRender=game.RebornSelectItem,t.addToParent(this.skin.scrollGrid),t.bindEnum=game.ME.Reborn,t.layout.paddingLeft=0,t.layout.spacingX=0,t.layout.spacingY=5,e.sureBtn.active=!1,e.tipsTitleLab.string=game.Lang.get(51596)},onShow:function(){this.updataSmeltingList()},onHide:function(){},updataSmeltingList:function(){var e=this.skin,t=game.rebornData.selectType;e.desc.active=t==game.SellType.PARTNER,this.sellList=game.rebornData.getShowSelectList(),!this.sellList||this.sellList.length<1?(e.emptyLab.string=game.Lang.get(51597,game.sellData.getTypeStr(t)),e.emptyNode.active=!0):e.emptyNode.active=!1,this.gridList.setData(this.sellList)}});b8e.module.registerView(game.ME.RebornSelect,e)}(),function(){var e=game.View.extends({rebornIconMap:null,iconPool:null,ctor:function(){this._super(1365),this.spotAlerts={REBORN:this.spotAlert1}},init:function(){this.rebornIconMap=b8e.HashMap.get(),this.iconPool=[];var e=this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.MaterialItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=0,e.layout.paddingTop=0,e.layout.spacingX=20,e.layout.spacingY=-20;var t=game.rebornData.getRebornCost();this.skin.rebornCostNum.string=t,this.btnNodes=[{x:77,y:-144},{x:77,y:-234},{x:77,y:-324},{x:77,y:-414},{x:582,y:-144},{x:582,y:-234},{x:582,y:-324}]},notify:function(e,t){switch(e){case this.Evts.C2V_REFRESH_VIEW:this.refreshView(),t&&this.updateSelectImg(t);break;case this.Evts.C2V_SMELIT_SUCCEED:this.playAnima(t)}},spotAlert1:function(e){this.skin.partnerAlert.active=e.alert},playAnima:function(){var e=this.anima;e||((e=this.anima=b8e.Animator.get(game.AnimType.UI_EFFECT,i)).addToParent(this.skin.anima),e.addFinishCallback(this.onComplete,this),e.load(game.ResCfg.getUrl(5019,1008))),e.setVisible(!0),e.play(null,0),this.finish=!1},onComplete:function(e){e.setVisible(!1),this.finish||(this.finish=!0)},onShow:function(){this.send(this.Evts.V_SHOW);var e=this.skin,t=4,a=game.moduleOpen.checkOpen(game.ME.ShenhunEquip);(e.shenhunEquipBtn.active=a)&&(e.shenhunEquipBtn.setPosition(this.btnNodes[t]),t++);var i=game.moduleOpen.checkOpen(game.ME.MountEquip);(e.mountEquipBtn.active=i)&&(e.mountEquipBtn.setPosition(this.btnNodes[t]),t++)},refreshView:function(){var e=game.rebornData.selectType;this.selectIcon&&(this.selectIcon.removeFromParent(),this.selectIcon=null);var t=game.rebornData.getSelectInfo();if(t){var a=this.iconPool;a[e]||(a[e]=this.getIconByType(e));var i=this.selectIcon=a[e];if(i){switch(i&&!i.parent&&i.addToParent(this.skin.rebornIcon),e){case game.SellType.PARTNER:case game.SellType.SHENHUN_EQUIP:case game.SellType.MOUNT_EQUIP:i.setData(t);break;case game.SellType.EQUIP:case game.SellType.CATILLA:case game.SellType.EXCLUSIVE_WEAPON:i.setData(t,0,!1,!1)}var n=game.rebornData.getMaterialList();this.gridList.setData(n)}}else this.gridList.setData(null)},getIconByType:function(e){return game.GridUtil.getSellIconByType(e)},updateSelectImg:function(e){var t=this.getComponent(e);t&&this.skin.selectImg.setPosition(t.x,t.y)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.Reborn,e)}(),function(){var e=game.View.extends({sellData:null,sellList:null,animList:null,sellLen:0,sellIconMap:null,ctor:function(){this._super("sell/sell_main_view"),this.toggles={toggle_btn_1:game.ME.SellSubpage,toggle_btn_2:game.ME.Reborn},this.spotAlerts={REBORN:this.spotAlert1}},notify:function(e,t){switch(e){case this.Evts.SWITCH_PAGE:this.toggleSelect(t)}},spotAlert1:function(e){this.skin.red_spot_2.active=e.alert},onShow:function(){this.toggleSelect(0)}});b8e.module.registerView(game.ME.Sell,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(951),this.setSize(540,125)},setData:function(){var e=this,t=game.sellData.selectType;t!=e.curSellType&&(e._itemGrid&&e._itemGrid.parent&&(e._itemGrid.removeFromParent(),e._itemGrid=null),e._itemGrid||(e._itemGrid=e.getIconByType(t),e._itemGrid.addToParent(e.skin.icon))),e.curSellType=t,e.setSelect();var a=game.ItemInfoCfg.getData(e.data.id);switch(a&&(e.skin.name.string=game.HtmlUtil.getColorStrByQuality(a.quality,a.name,!0)),e.curSellType){case game.SellType.EQUIP:case game.SellType.CATILLA:e._itemGrid.setData(e.data,0,!1,!1),e.setEquip();break;case game.SellType.EXCLUSIVE_WEAPON:e._itemGrid.setData(e.data,0,!1,!1),e.setExclusiveWeapon();break;case game.SellType.SHARD:e._itemGrid.setItemInfo(e.data,!1,game.IconLayoutEnum.SHOW_NUM),e.setShard();break;case game.SellType.GOD_EQUIP:e._itemGrid.setItemInfo(e.data,!1,game.IconLayoutEnum.SHOW_NUM),e.setGodEquip();break;case game.SellType.MOUNT_EQUIP:case game.SellType.SHENHUN_EQUIP:e._itemGrid.setData(e.data),e.setShEquip();break;case game.SellType.GOD_ANIMAL_EQUIP:e._itemGrid.setData(e.data,!1),e.setGodAnimalEquip()}},setEquip:function(){var e=this.skin,t=this.data;this.setNodeActive(!0,!1,!1),e.equipLab_1.string=game.Lang.get(51587,t.intensifylv),e.equipLab_2.string=game.Lang.get(51586,t.refinelv)},setExclusiveWeapon:function(){this.setNodeActive(!1,!1,!0),this.skin.qualityLab.string=game.Lang.get(51595,this.data.breakLv)},setShard:function(){this.setNodeActive(!1,!0,!1);var e=game.sellData.getShardNum(this.data.id);this.count=e||this.data.num,this.maxCount=this.data.num,this.skin.count.string=this.count},setGodEquip:function(){this.setNodeActive(!1,!1,!1)},setShEquip:function(){var e=this.skin,t=this.data;this.setNodeActive(!0,!1,!1),e.equipLab_1.string=game.Lang.get(53528,t.totalFight),e.equipLab_2.string=game.Lang.get(53521,t.star)},setGodAnimalEquip:function(){var e=this.skin;this.setNodeActive(!0,!1,!1,!0),this.data.taleAttr?e.equipLab_1.string=this.data.getTaleAttrStr():e.equipLab_1.string=game.Lang.get(53604),e.equipLab_2.string="",e.fightLab.string=game.Lang.get(1008,this.data.fight)},setNodeActive:function(e,t,a,i){var n=3<arguments.length&&void 0!==i&&i,s=this.skin;s.shardNode.active=t,s.equipNode.active=e,s.qualityLab.active=a,s.fightLab.active=n},selectBtn:function(){game.sellData.checkSelect(this.data)?(this.setSelect(),this.send(game.SellEvts.V2C_UPDATE_LIST)):game.notice.show(51625)},setSelect:function(){this.isSelect=game.sellData.getIsSelect(this.data),this.skin.selectImg.active=this.isSelect},getIconByType:function(e){return this.iconPool||(this.iconPool=[]),this.iconPool[e]||(this.iconPool[e]=game.GridUtil.getSellIconByType(e)),this.iconPool[e]},fiveLessBtn:function(){this.setValue(!1,5)},fiveAddBtn:function(){this.setValue(!0,5)},lessBtn:function(){this.setValue(!1,1)},addBtn:function(){this.setValue(!0,1)},setValue:function(e,t){var a=this,i=void 0;(i=e?(i=a.count+t)>a.maxCount?a.maxCount:i:(i=a.count-t)<1?1:i)!=a.count&&(a.count=i,a.skin.count.string=i,game.sellData.changeShardList(a.data.id,a.count),a.isSelect&&a.send(game.SellEvts.V2C_UPDATE_LIST))}}),b8e.RC("$$game","$$SellSelectItem",e)}(),function(){var e=game.View.extends({sellData:null,sellList:null,_showModel:!0,ctor:function(){this._super(952)},init:function(){var e=this.skin;this.sellList=[],this.sellData=game.sellData;var t=this.gridList=new game.List;t.itemRender=game.SellSelectItem,t.addToParent(this.skin.scrollGrid),t.bindEnum=game.ME.Sell,t.layout.paddingLeft=0,t.layout.spacingX=0,t.layout.spacingY=5,e.sureBtn.active=!0,e.desc.active=!1,e.tipsTitleLab.string=game.Lang.get(51594)},onShow:function(){this.updataSmeltingList()},onHide:function(){},view_topBtn:function(){this.gridList.scrollToTop()},view_bottomBtn:function(){this.gridList.scrollToBottom()},updataSmeltingList:function(){var e=this.skin,t=game.sellData.selectType;this.sellList=game.sellData.getShowSelectList(),!this.sellList||this.sellList.length<1?(e.emptyLab.string=game.Lang.get(51593,game.sellData.getTypeStr(t)),e.emptyNode.active=!0):e.emptyNode.active=!1,this.gridList.setData(this.sellList)}});b8e.module.registerView(game.ME.SellSelect,e)}(),function(){var e=game.View.extends({sellData:null,sellList:null,animList:null,sellLen:0,sellIconMap:null,ctor:function(){this._super(953)},init:function(){this.sellData=game.sellData,this.sellIconMap=b8e.HashMap.get(),this.animaList=[];var e=this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.MaterialItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=0,e.layout.paddingTop=0,e.layout.spacingX=20,e.layout.spacingY=-20,this.sellData.initSellSelect(),this._showList=[],this.btnNodes=[{x:77,y:-144},{x:77,y:-234},{x:77,y:-324},{x:582,y:-144},{x:582,y:-234},{x:582,y:-324},{x:77,y:-414}]},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SET_LIST_COMPLETE:a.setSmeltingList(),a.updateCheckImg();break;case a.Evts.C2V_SMELIT_SUCCEED:a.playAnima(t);break;case a.Evts.C2V_SELECT_QUALITY:a.updateCheckImg();break;case a.Evts.C2V_SELECT_TYPE:a.updateSelectImg(t);break;case a.Evts.C2V_UPDATE_LIST:a.setSmeltingList()}},playAnima:function(e){for(var t=0;t<e;t++){if(!this.animaList[t]){var a=b8e.Animator.get(game.AnimType.UI_EFFECT,t);a.addToParent(this.getComponent("anima_"+t)),a.addFinishCallback(this.onComplete,this,[t]),a.load(game.ResCfg.getUrl(5019,1008)),a.setVisible(!1),this.animaList.push(a)}this.animaList[t].setVisible(!0),this.animaList[t].play(null,0)}this.finish=!1},onComplete:function(e,t){this.animaList[t].setVisible(!1),this.finish||(this.finish=!0,this.setSmeltingList())},onShow:function(){var e=this.skin;this.send(this.Evts.V_SHOW);var t=3,a=game.moduleOpen.checkOpen(game.ME.ShenhunEquip);(e.shenhunEquipBtn.active=a)&&(e.shenhunEquipBtn.setPosition(this.btnNodes[t]),t++);var i=game.moduleOpen.checkOpen(game.ME.MountEquip);(e.mountEquipBtn.active=i)&&(e.mountEquipBtn.setPosition(this.btnNodes[t]),t++);var n=this.sellData.isChipOpen();(e.shardBtn.active=n)&&(e.shardBtn.setPosition(this.btnNodes[t]),t++),e.godEquipBtn.active=!1},setSmeltingList:function(){var e=this,t=void 0,a=void 0,i=void 0,n=void 0;if(0<(t=e._showList.length)){for(a=0;a<t;a++)(i=e._showList[a]).clearData(),i.removeFromParent();e._showList.length=0}var s=e.sellData.sellList;if(!s||s.length<1)e.gridList.setData(null);else{t=s.length;var o=game.sellData.selectType,r=e.sellIconMap.get(o);for(r||(r=[],e.sellIconMap.set(o,r)),a=0;a<t;a++)if(n=s[a],r[a]||(r[a]=e.getIconByType(o)),i=r[a]){switch(i.addToParent(e.getComponent("sellSlot_"+a)),n=e.getListInfo(o,n,a),o){case game.SellType.EQUIP:case game.SellType.CATILLA:case game.SellType.EXCLUSIVE_WEAPON:i.setData(n,0,!1,!1),i.canClick=!1;break;case game.SellType.SHARD:i.setItemInfo(n,!1,game.IconLayoutEnum.SHOW_NUM);break;case game.SellType.MOUNT_EQUIP:case game.SellType.SHENHUN_EQUIP:i.setData(n);break;case game.SellType.GOD_ANIMAL_EQUIP:i.setData(n,!1),i.canClick=!1}e._showList.push(i)}var g=game.sellData.getMaterialList();e.gridList.setData(g)}},getListInfo:function(e,t,a){if(e!=game.SellType.SHARD)return t;this.shardInfoList||(this.shardInfoList=[]);var i=t.id,n=game.sellData.getShardNum(i);n=n||t.num;var s=this.shardInfoList[a];return s?(s.id=i,s.num=n):s=this.shardInfoList[a]=game.ItemUtil.createBaseItemInfo(i,n),s},getIconByType:function(e){return game.GridUtil.getSellIconByType(e)},updateCheckImg:function(){var e=game.sellData.getCurQuality();if(e){var t=e-1,a=this.getComponent("select_btn_"+t);this.skin.check_img.x=a.x}},updateSelectImg:function(e){var t=this.getComponent(e);t&&this.skin.selectImg.setPosition(t.x,t.y)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.SellSubpage,e)}(),function(){var e;(e=game.ListItem.extends({_icon:null,_data:null,ctor:function(){this._super(),this.setSize(89,110)},setData:function(){if(this.data){var e=game.IconLayoutEnum.SHOW_NUM,t=game.IconSizeEnum.GRID_SIZE_84;this._icon||(this._icon=game.GridUtil.createPrizeIcon(t),this._icon.setPosition(50,-53),this._icon.addToParent(this)),game.GridUtil.setItemIcon(this._icon,this.data,!1,e)}else;}})).poolCall=!0,b8e.RC("$$game","$$MaterialItem",e)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_TITLE:-1,V_SELECT_GROUP:-1,V_UPDATE_AMOUNT:-1,V_UPDATE_CONDITION:-1,V_UPDATE_BUY_COUNT:-1,V_UPDATE_SHOP_DATA:-1,V_HIDE:-1,V_SHOW:-1,V_UPDATE_TITLE:-1,C_BUY_COMPLETE:-1,V_BUY_ITEM:-1,C2V_SELECT_TITLE:-1,V2C_INIT_SHOP:-1,V2C_SHOW_COMMON_SHOP:-1}),b8e.RC("$$game","$$ShopEvts",e)}(),function(){var e;e=b8e.Enum({BUY_ITEM:b8e.enc(),SHOW_SHOP:b8e.enc(),SHOW_ENTRANCE:b8e.enc()}),b8e.RC("$$game","$$ShopGEvts",e)}(),function(){var e=game.Control.extends({lastME:0,init:function(){var e=this;e.shopData=game.shopData,e.shopData.initData(),e.shopAlert=game.spotAlert.set(game.SAE.SHOP_ALERT,game.SAE.HOME),e.commonShopAlert=game.spotAlert.set(game.SAE.COMMON_SHOP_ALERT,game.SAE.SHOP_ALERT),e.goldEquipShopAlert=game.spotAlert.set(game.SAE.GOLD_EQUIP_SHOP,game.SAE.SHOP_ALERT),e.shopPersonal=game.spotAlert.set(game.SAE.SHOP_PERSONAL),e.shopPubilc=game.spotAlert.set(game.SAE.SHOP_PUBLIC),e.shopWorldWar=game.spotAlert.set(game.SAE.SHOP_WORLDWAR),e.shopMaterial=game.spotAlert.set(game.SAE.SHOP_MATERIAL),e.shopZhanjiang=game.spotAlert.set(game.SAE.SHOP_ZHANJIANG),e.shopArena=game.spotAlert.set(game.SAE.SHOP_ARENA),e.shopArenaWelfare=game.spotAlert.set(game.SAE.SHOP_ARENA_WELFARE),e.shopGuild=game.spotAlert.set(game.SAE.SHOP_GUILD),e.shopRelation=game.spotAlert.set(game.SAE.SHOP_RELATION),e.shopGeneral=game.spotAlert.set(game.SAE.SHOP_GENERAL),e.shopCsWar=game.spotAlert.set(game.SAE.SHOP_CSWAR),e.shopCsBoss=game.spotAlert.set(game.SAE.SHOP_CSGUILDBOSS),e.shopTeamLeague=game.spotAlert.set(game.SAE.SHOP_TEAMLEAGUE),e.shopTeamLeagueMatch=game.spotAlert.set(game.SAE.SHOP_TEAMLEAGUE_MATCH),e.shopWorldWar2=game.spotAlert.set(game.SAE.SHOP_WORLDWAR2),e.shopTower=game.spotAlert.set(game.SAE.SHOP_THOUSANDTOWER),e.shopShenJiang=game.spotAlert.set(game.SAE.SHENJIANG_SHOP_ALERT,game.SAE.PET_TURNPLATE)},triggerOpen:function(e){e==this.moduleEnum&&this.sendShopReq()},ipc:function(){var e=this,t=e;t.handels={ShopDataResp:t.shopDataResp,ShopResp:t.shopResp},t.gevts={ShopGEvts:{BUY_ITEM:t.buyItem,SHOW_SHOP:t.showShop,SHOW_ENTRANCE:t.showEntrance}},t.evts={Back:{C_UPDATE_AMOUNT:t.updateAmount,C_EQUIP_UPDATE:t.equipUpdate,C_BACK_UPDATE_ITEMINFO:t.updateAmount,C_BACK_SYN_BACK_INFO:t.updateAmount},Sell:{C2C_SMELIT_SUCCEED:t.sellEquipUpdate},Home:{SHOW_ENTRANCE:t.showEntrance},Escort:{C2C_SYN_DATA:e.updateCondition},EscortFinish:{C2C_COLLECT_REWARD_SUCCEED:e.updateCondition},Exam:{C2C_INIT_MODEL:e.updateCondition,C2C_EXAM_QUESTION:e.updateCondition},Guild:{C_UPDATE_GUILD:e.updateGuildShop},ZhanJiang:{C2C_UPDATE_LAYER:e.updateZhanjiangShop},InstanceFunc:{C2C_UPDATE_FINISH_COUNT:e.updateCondition},InstanceMaterial:{C2C_UPDATE_FINISH_COUNT:e.updateMaterialShop},PersonalBoss:{C2C_UPDATE_FINISH_COUNT:e.updatePersonalShop},PublicBoss:{C2C_UPDATE_FINISH_COUNT:e.updatePublicShop},WorldWar:{C2C_UPDATE_FINISH_COUNT:e.updateWorldWarShop},WorldWar2:{C2C_UPDATE_FINISH_COUNT:e.updateWorldWar2Shop},ThousandTower:{C2C_UPDATE_FINISH_COUNT:e.updateThousandTowerShop},Arena:{C2C_UPDATE_MINE_RANK:e.updateArenaShop},MainRole:{C_LEVEL_UP:e.updateShopTitle,C_RESET_DAILY:e.resetDaily},CsGuild:{C2C_UPDATE_SHOP_COUNT:e.updateCsGuildBoss},CsArrowMain:{C2C_UPDATE_SHOP_COUNT:e.updateCsArrow},TeamLeague:{C_UPDATE_TEAMLEAGUE:e.updateTeamLeague}}},sendShopReq:function(){var e=this;if(e.shopIds=game.ShopCfg.getKeys(),e.shopIds&&0<e.shopIds.length){e.sender.ShopDataReq(e.shopIds)}},checkAlert2:function(e){this.spotAlert2.alert=e},updatePersonalShop:function(){this.updateCondition()},checkPersonalShop:function(){this.shopPersonal.alert=this.getSpotByShopId(game.ShopIdEnum.CS_OVERLORD)},updatePublicShop:function(){this.updateCondition()},checkPublicShop:function(){this.shopPubilc.alert=this.getSpotByShopId(game.ShopIdEnum.HUSONG_SHOP)},updateWorldWarShop:function(){this.updateCondition()},checkWorldWarShop:function(){this.shopWorldWar.alert=this.getSpotByShopId(game.ShopIdEnum.PRESTIGE_SHOP)},updateWorldWar2Shop:function(){this.updateCondition()},updateThousandTowerShop:function(){this.updateCondition()},updateMaterialShop:function(){this.updateCondition()},checkMaterialShop:function(){this.shopMaterial.alert=this.getSpotByShopId(game.ShopIdEnum.WORLD_FULI)},updateZhanjiangShop:function(){this.updateCondition()},checkZhanjiangShop:function(){this.shopZhanjiang.alert=this.getSpotByShopId(game.ShopIdEnum.WORLD_SHOP)},updateArenaShop:function(){this.updateCondition()},checkArenaShop:function(){this.shopArena.alert=this.getSpotByShopId(game.ShopIdEnum.EXCLUSIVE_SHOP)},updateGuildShop:function(){this.updateCondition()},checkGuildShop:function(){this.shopGuild.alert=this.getSpotByShopId(game.ShopIdEnum.YUJO_SHOP)},checkRelationShop:function(){this.shopRelation.alert=this.getSpotByShopId(game.ShopIdEnum.YUJO_SHOP)},checkAlert:function(){this.shopList||(this.shopList=game.ShopCfg.getDatas());var e=this.shopList,t=!1;e&&0<e.length&&(t=this.getSpot(e)),this.commonShopAlert.alert=t},updateCsGuildBoss:function(){this.updateCondition(),this.checkGuildBossAlert()},checkGuildBossAlert:function(){this.shopCsBoss.alert=this.getSpotByShopId(game.ShopIdEnum.GUILD_BOSS_FULI)},updateCsArrow:function(){this.updateCondition()},updateTeamLeague:function(){this.updateCondition()},getSpot:function(e){var t=!1,a=game.mainRoleData.lv,i=game.miscData.openServerDay;if(!e||e.length<1)return!1;for(var n=void 0,s=void 0,o=e.length,r=0;r<o;r++)if(s=e[r],n=game.ShopCfg.getSpotShop(s.id)){var g=this.shopData.getInsLevelByType(n.openInsType);if(!(n.openLv>a||n.openDays>i||g<n.openInsLevel)&&(n.id!=game.ShopIdEnum.SHENJIANG_SHOP||game.petTurnplateData.checkIsGetAll())&&game.shopData.getConditionValue(n.showCondition)&&(n.id!=game.ShopIdEnum.GOLDEQUIP_SHOP&&(t=this.shopData.getIsHasBuyNum(n.id)),t))return t}return t},getSpotByShopId:function(e){var t=game.ShopCfg.getSpotShop(e);if(!game.shopData.isInit)return!1;if(!t)return!1;var a=game.mainRoleData.lv,i=game.miscData.openServerDay,n=this.shopData.getInsLevelByType(t.openInsType);return!(t.openLv>a||t.openDays>i||n<t.openInsLevel)&&(!(t.id==game.ShopIdEnum.SHENJIANG_SHOP&&!game.petTurnplateData.checkIsGetAll())&&(!!game.shopData.getConditionValue(t.showCondition)&&this.shopData.getIsHasBuyNum(t.id)))},updateShopTitle:function(){this.send(this.Evts.V_UPDATE_TITLE)},resetDaily:function(){this.updateShopTitle(),game.shopData.resetCACount(),this.sendShopReq()},notify:function(e,t){var a=this.Evts;switch(e){case a.V_SELECT_TITLE:this.selectTitle(t);break;case a.V_SELECT_GROUP:this.selectGroup(t);break;case a.V_BUY_ITEM:this.showBuyItem(t);break;case a.V2C_INIT_SHOP:this.checkAlert();break;case a.V2C_SHOW_COMMON_SHOP:this.shopList||(this.shopList=game.ShopCfg.getDatas());var i=this.shopList;if(i&&0<i.length)for(var n=void 0,s=i.length,o=0;o<s;o++)n=i[o],game.shopData.setShopAlert(n.id)}},buyItem:function(e){if(e&&e.data){var t=e.data,a=game.ShopItemCfg.getDataByGoodsId(t.goodsId);if(a){var i=game.ShopCfg.getDataByShopId(a.shopId);if(i){if(!i.skipBagCheck)if(game.UpgradeUtil.checkEquipTooMuch())return;t.buyComplete&&(this.buyComplete=t.buyComplete),this.sender.ShopReq(t.goodsId,t.count)}else;}else;}else;},showBuyItem:function(e){game.ShopBuyView.inst().showBuyView(e)},showShop:function(e){if(e&&e.data){var t=e.data,a=game.ShopCfg.getDataByShopId(t);if(a){var i=game.miscData.openServerDay,n=game.mainRoleData.lv;if(a.openLv>n)game.notice.show(10080,a.openLv);else if(a.openDays>i)game.notice.show(10081,a.openDays);else{var s=a.toggle;this.shopData.getIndexByShopId(t);this.setSelectShop(s,t),t!=game.ShopIdEnum.DALIYWISH_SHOP?game.module.showToggle(this.moduleEnum,s):game.module.showToggle(game.ME.DailyWish,3)}}}},showEntrance:function(e){if(e&&e.data){var t=e.data,a=this.shopData;a.shopEntrance=t;var i=game.ShopCfg.getShopListByEntrance(t);if(i&&!(i.length<1)){for(var n,s,o,r=game.miscData.openServerDay,g=game.mainRoleData.lv,l=i.length,c=0;c<l;c++){n=i[c];var h=this.shopData.getInsLevelByType(n.openInsType);if(!(n.openLv>g||n.openDays>r||h<n.openInsLevel)&&(n.id!=game.ShopIdEnum.SHENJIANG_SHOP||game.petTurnplateData.checkIsGetAll())){s=n.id,o=n.toggle;break}}if(s){a.shopId=s;this.shopData.getIndexByShopId(s);this.setSelectShop(o,s),game.module.showToggle(this.moduleEnum,o)}}}},selectTitle:function(e){var t=e[0],a=e[1];if(this.shopData.shopId!=a){this.shopData.shopId=a;this.shopData.getIndexByShopId(a);this.setSelectShop(t,a)}},setSelectShop:function(e,t){this.shopData.setShopTitleSelect(e,t),this.send(this.Evts.C2V_SELECT_TITLE)},selectGroup:function(e){this.shopData.group=e,this.send(this.Evts.V_SELECT_GROUP)},skipLink:function(){var e=game.ShopCfg.getDataByShopId(this.shopData.shopId);e&&game.module.show(e.skipId)},updateAmount:function(){game.shopData.isInit&&(this.checkAlert(),this.send(this.Evts.V_UPDATE_AMOUNT))},updateCondition:function(){game.shopData.isInit&&(this.checkAlert(),this.send(this.Evts.V_UPDATE_CONDITION))},updateBuyCount:function(){this.send(this.Evts.V_UPDATE_BUY_COUNT)},equipUpdate:function(){if(game.ShopCfg.getSpotShop(game.ShopIdEnum.GOLDEQUIP_SHOP))this.shopData.setShopAlert(game.ShopIdEnum.GOLDEQUIP_SHOP);else;},sellEquipUpdate:function(){this.equipUpdate(),this.send(this.Evts.V_UPDATE_AMOUNT)},getLab:function(){game.module.show(game.ME.GoldEquipResolve)},commonShopGetLab:function(){var e=game.ShopCfg.getDataByShopId(this.shopData.shopId);if(e){var t=game.ItemInfoCfg.getData(e.skipId);t&&(game.tipsData.setInfo(t),game.module.show(game.ME.ItemTips))}},shopDataResp:function(e){var t=e.readProtobuf(game.pb.ShopDataResponse);if(0<t.code)game.notice.noticeError(t.code);else{this.shopData.setData(t.datas),this.send(this.Evts.V_UPDATE_SHOP_DATA)}},shopResp:function(e){var t=e.readProtobuf(game.pb.ShopResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=this,i=t.goodsId,n=t.buyNum;t.totalNum;a.shopData.addShopData(t),game.sdk.payLog(i,n);var s=game.ShopItemCfg.getDataByGoodsId(t.goodsId);if(s){a.shopData.setShopAlert(s.shopId),a.checkAlert();var o=game.ShopIdEnum;switch(s.shopId){case o.CS_OVERLORD:a.checkPersonalShop();break;case o.HUSONG_SHOP:a.checkPublicShop();break;case o.PRESTIGE_SHOP:a.checkWorldWarShop();break;case o.WORLD_FULI:a.checkMaterialShop();break;case o.WORLD_SHOP:a.checkZhanjiangShop();break;case o.EXCLUSIVE_SHOP:a.checkArenaShop();break;case o.YUJO_SHOP:a.checkGuildShop();break;case o.REWARDBULUO_SHOP:a.checkRelationShop()}}if(a.send(a.Evts.V_UPDATE_BUY_COUNT),a.buyComplete&&a.buyComplete.callback){var r=a.buyComplete.callback,g=a.buyComplete.thisArg,l=a.buyComplete.params;r.call(g,l),a.buyComplete=null}a.dpt(a.Evts.C_BUY_COMPLETE),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeConsume)}},btn_1:function(){this.send(this.Evts.V_SWITCH_PAGE,0)},btn_2:function(){this.send(this.Evts.V_SWITCH_PAGE,1)},btn_3:function(){this.send(this.Evts.V_SWITCH_PAGE,2)},btn_4:function(){this.send(this.Evts.V_SWITCH_PAGE,3)},selectToggle:function(e){this.send(this.Evts.V_SWITCH_PAGE,e)}}),t=game.Sender.extends({ipc:function(){this.msg={ShopDataReq:this.shopDataReq,ShopReq:this.shopReq}},shopDataReq:function(e){var t=game.pb.ShopDataRequest;t.ids=e,b8e.net.getBytes().writeProtobuf(t)},shopReq:function(e,t){var a=game.pb.ShopRequest;a.goodsId=e,a.buyNum=t,b8e.net.getBytes().writeProtobuf(a)}}),a=[game.ME.SHOP_TOGGLE_1,game.ME.SHOP_TOGGLE_2,game.ME.SHOP_TOGGLE_3,game.ME.SHOP_TOGGLE_4,game.ME.GoldEquipShop,game.ME.DailyWishShop];b8e.module.registerControl(game.ME.Shop,e,game.ShopEvts,t,a)}(),function(){var e;e=b8e.Object.extends({group:0,groupName:"",isSelect:!1,ctor:function(){this._super()},setData:function(e){this.group=e.group,this.groupName=e.groupName}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GroupInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,SHOPESCORT:1,SHOPEXAM:2,SHOPGUILD:3,SHOPLEIYIN:4,SHOPMATERIALS:5,SHOPPERSONBOSS:6,SHOPWORLDBOSS:7,SHOPSHENGSIJIE:8,SHOPARENA:9,SHOPKING:10,SHOPJIANGHUNBOSS:11,SHOPZCTURNTABLENUM:12,SHOPJSTURNTABLENUM:13,SHOPGSTURNTABLENUM:14,SHOPGUANDU:15,SHOPCSWAR:16,SHOPCSBOSS:17,SHOPCSARROW:18,SHOPTEAMLEAGUE:19,SHOPZHULU:20,SHOPTOWER:21,SHOPSHENJIANG:22,SHOPBARBARIAN:25}),b8e.RC("$$game","$$ShopConditionType",e)}(),function(){var e=b8e.Object.extends({shopEntrance:0,shopId:0,group:0,shopIndex:0,toggle:0,ctor:function(){this._super(),this.shopMap=b8e.HashMap.get(),this.shopGoodsMap=b8e.HashMap.get(),this.toggleMap=b8e.HashMap.get(),this.toggleTitleMap=b8e.HashMap.get(),this.shopTitleList=[],this.shopTotalList=[],this.shopIdToIndex=[],this.toggleShopId={}},initData:function(){var e=this;if(!e.isInit){e.isInit=!0;var t=void 0,a=void 0,i=game.ShopCfg.getDatas();i.sort(e.onSort);for(var n=i.length,s=0,o=e.shopIndex,r=void 0,g=void 0,l=0;l<n;l++)(t=i[l])&&!t.alone&&(g=t.toggle||0,r=(r=e.toggleMap.get(g))||[],(a=new game.ShopTitleItemInfo).shopId=t.id,a.toggle=g,a.name=t.name,a.shopEntrance=t.shopEntrance,a.shopIndex=s,a.isSelect=a.shopIndex==e.shopIndex,e.shopTotalList.push(a),r.push(a),e.shopIdToIndex[t.id]=s,s++,e.toggleMap.set(g,r));e.shopId=e.shopTotalList[o]?e.shopTotalList[o].shopId:0}},onSort:function(e,t){return e.id-t.id},getShopTitleList:function(e){var t=this.toggleTitleMap.get(e);(t=t||[]).length=0;var a=this.toggleMap.get(e);if(!a||a.length<1)return null;for(var i,n,s=game.miscData.openServerDay,o=game.mainRoleData.lv,r=a.length,g=0;g<r;g++)if((n=a[g])&&(i=game.ShopCfg.getDataByShopId(n.shopId))){var l=this.getInsLevelByType(i.openInsType);if(!(i.openLv>o||i.openDays>s||l<i.openInsLevel)&&i.id!=game.ShopIdEnum.GOLDEQUIP_SHOP&&(i.id!=game.ShopIdEnum.SHENJIANG_SHOP||game.petTurnplateData.checkIsGetAll())){if(i.activityId){var c=parseInt(i.activityId/100),h=i.activityId%100;if(c==game.ActiveBarItemType.TREASURE_PAVILION&&!game.treasurePavilionData.checkIsOpenBuyId(h))continue}n.isHead=!1,n.isTail=!1,this.toggleShopId[e]||(this.toggleShopId[e]=n.shopId),n.isSelect=this.toggleShopId[e]==n.shopId,t.push(n)}}0<(r=t.length)&&(t[0].isHead=!0,t[r-1].isTail=!0);return this.toggleTitleMap.set(e,t),t},getShowTitleList:function(e){return this.toggleTitleMap.get(e)},setShopTitleSelect:function(e,t){var a,i,n=0,s=this.toggleTitleMap.get(e);for(s||(this.getShopTitleList(e),s=this.toggleTitleMap.get(e)),a=s.length,n=0;n<a;n++)(i=s[n]).shopId==t?i.isSelect=!0:i.isSelect=!1;this.toggleShopId[e]=t,this.toggleTitleMap.set(e,s)},setData:function(e){if(this.shopGoodsMap.clear(),e&&!(e.length<1)){var t,a,i,n,s,o,r=e.length;for(o=0;o<r;o++)if((t=e[o])&&(a=t.datas,t.id,a&&0<a.length))for(s=a.length,n=0;n<s;n++)i=a[n],this.shopGoodsMap.set(i.goodsId,i.buyNum)}},addShopData:function(e){this.shopGoodsMap.set(e.goodsId,e.totalNum)},getBoughtNum:function(e){var t=this.shopGoodsMap.get(e);return t||0},getIsHasBuyNum:function(e){var t=game.ShopItemCfg.getShopList(e);if(!t||t.length<1)return!1;for(var a,i=t.length,n=0;n<i;n++)if((a=t[n])&&0!=a.maxNum&&a.conditionType&&a.conditionValue&&this.getIsPass(a.conditionType,a.conditionValue)&&!(this.getBoughtNum(a.goodsId)>=a.maxNum)&&game.UpgradeUtil.checkItemList(a.costItems,1,!1))return!0;return!1},setShopAlert:function(e){var t,a,i=!1,n=!1,s=this.shopTotalList;if(!s||s.length<1)return i;for(var o=s.length,r=game.miscData.openServerDay,g=game.mainRoleData.lv,l=void 0,c=0;c<o;c++)if((l=s[c])&&(a=l.shopId,0==e||a==e)){if(t=game.ShopCfg.getSpotShop(a)){var h=this.getInsLevelByType(t.openInsType);t.openLv>g||t.openDays>r||h<t.openInsLevel?l.alert=!1:n=t.id==game.ShopIdEnum.GOLDEQUIP_SHOP?0!=e&&(l.alert=game.equipData.getGoldEquipAlert()):l.alert=this.getIsHasBuyNum(a)}else l.alert=!1;n&&(i=n)}return i},getShopList:function(e){var t=game.ShopItemCfg.getShopList(e);if(!t||t.length<1)return null;this.setItemInfoList(t,e);var a=this.shopMap.get(e);return a?(this.itemInfoList=a.values(),this.itemInfoList&&0<this.itemInfoList.length&&this.itemInfoList.sort(this.onShopItemSort),this.itemInfoList):null},getCurShopList:function(e){var t=this.toggleShopId[e];return this.getShopList(t)},getHasShopList:function(){return!1},initGroupNameList:function(e){this.groupList?this.groupList.length=0:this.groupList=[];var t=game.ShopItemCfg.getGroupNameList(e);if(t&&!(t.length<1))for(var a,i,n=t.length,s=0;s<n;s++)a=t[s],(i=new game.GroupInfo).setData(a),this.groupList.push(i)},getGroupNameList:function(){return this.groupList},getGroupItemInfoList:function(e){var t=game.ShopIdEnum.GOLDEQUIP_SHOP,a=game.ShopItemCfg.getGroupList(t,e);return!a||a.length<1?null:(this.setItemInfoList(a,t),this.shopMap.get(t)?(this.itemInfoList=masps.values(),this.itemInfoList&&0<this.itemInfoList.length&&this.itemInfoList.sort(this.onShopGoldSort),this.itemInfoList):null)},getCurGroupItemInfoList:function(){return this.getGroupItemInfoList(this.group)},setItemInfoList:function(e,t){var a=this.shopMap.get(t);a||(a=b8e.HashMap.get(),this.shopMap.set(t,a));for(var i,n,s,o,r=e.length,g=0;g<r;g++)(i=e[g])&&(i.openLv&&game.mainRoleData.lv<i.openLv||i.serverStart&&game.miscData.openServerDay<i.serverStart||i.serverEnd&&game.miscData.openServerDay>=i.serverEnd||(i.itemId,o=i.goodsId,(s=a.get(o))||(s=new game.ShopItemInfo,a.set(o,s)),n=(n=this.shopGoodsMap.get(o))||0,s.setData(i,n)))},onShopItemSort:function(e,t){return e.soldOut==t.soldOut?e.isComplete==t.isComplete?e.isComplete?e.buyNum==t.buyNum?e.cost!=t.cost?e.cost-t.cost:e.goodsId-t.goodsId:e.buyNum-t.buyNum:e.conditionValue!=t.conditionValue?e.conditionValue-t.conditionValue:e.goodsId-t.goodsId:e.isComplete?-1:1:e.soldOut?1:-1},onShopGoldSort:function(e,t){return e.cfg&&t.cfg?e.isComplete==t.isComplete?e.cfg.level-t.cfg.level:e.isComplete?-1:1:(b8e.warn("\u6392\u5e8f\u65f6\uff0c\u4f7f\u7528\u7684\u914d\u7f6e\u4e3a\u7a7a:a.cfg:",e.cfg,"b.cfg:",t.cfg),0)},getIsCanBuy:function(e){var t=game.ShopItemCfg.getDataByGoodsId(e);return!!t&&(!t.conditionType||this.getIsPass(t.conditionType,t.conditionValue))},getIsPass:function(e,t){game.ShopConditionType;var a=this.getConditionValue(e);return e==game.ShopConditionType.SHOPARENA||e==game.ShopConditionType.SHOPKING?a<=t:e==game.ShopConditionType.SHOPTOWER?(t=game.thousandTowerData.getTowerIndexByBossID(t))<=a:t<=a},getConditionValue:function(e){var t=game.ShopConditionType,a=0;switch(e){case t.SHOPESCORT:a=game.escortData.getHighCount();break;case t.SHOPEXAM:a=game.examData.getExamCount();break;case t.SHOPGUILD:a=game.guildData.getGuildLevel();break;case t.SHOPLEIYIN:a=game.zhanjiangData.getLayer();break;case t.SHOPMATERIALS:a=game.instFuncData.getCount();break;case t.SHOPPERSONBOSS:a=game.bossData.getCount();break;case t.SHOPWORLDBOSS:a=game.publicBossData.getCount();break;case t.SHOPSHENGSIJIE:a=game.worldWarData.getCount();break;case t.SHOPARENA:a=game.arenaData.getMainRank();break;case t.SHOPKING:a=game.csArenaData.getMaxRank();break;case t.SHOPJIANGHUNBOSS:a=game.generalBossData.getCount();break;case t.SHOPZCTURNTABLENUM:a=game.treasureData.getXunbaoCount(game.TreasureIdEnum.ZC);break;case t.SHOPJSTURNTABLENUM:a=game.treasureData.getXunbaoCount(game.TreasureIdEnum.JS);break;case t.SHOPGSTURNTABLENUM:a=game.treasureData.getXunbaoCount(game.TreasureIdEnum.GS);break;case t.SHOPGUANDU:a=this.getCACountByType(game.ShopConditionType.SHOPGUANDU);break;case t.SHOPCSWAR:a=this.getCACountByType(game.ShopConditionType.SHOPCSWAR);break;case t.SHOPCSBOSS:a=this.getCACountByType(game.ShopConditionType.SHOPCSBOSS);break;case t.SHOPCSARROW:a=this.getCACountByType(game.ShopConditionType.SHOPCSARROW);break;case t.SHOPTEAMLEAGUE:a=game.teamLeagueData.level||0;break;case t.SHOPZHULU:a=game.worldWar2Data.getCount();break;case t.SHOPTOWER:a=game.thousandTowerData.getPassMaxLayer();break;case t.SHOPSHENJIANG:a=game.petTurnplateData.getHadNum();break;case t.SHOPBARBARIAN:a=game.barbarianData.histStar}return a},setupMiscData:function(e){if(e&&e.crossAttend){this.crossAttendMap||(this.crossAttendMap=b8e.HashMap.get());var t=e.crossAttend;if(t&&!(t.length<1))for(var a=void 0,i=void 0,n=t.length,s=0;s<n;s++)i=t[s],(a=new game.ShopCrossAttendInfo).setData(i),this.crossAttendMap.set(a.id,a)}},getCACountByType:function(e){if(!this.crossAttendMap)return 0;var t=this.crossAttendMap.get(e);return t?t.count:0},setCACount:function(e){this.crossAttendMap||(this.crossAttendMap=b8e.HashMap.get());var t=this.crossAttendMap.get(e);return t||((t=new game.ShopCrossAttendInfo).initData(e),this.crossAttendMap.set(t.id,t)),!t.isJoin&&(t.isJoin=!0,t.count++,!0)},resetCACount:function(){this.crossAttendMap.forEach(function(e,t){t.isJoin=!1},this)},getInsLevelByType:function(e){var t=game.InstanceType;switch(e){case t.XIAN_DI_BAO_ZANG:return game.baoZangData.maxId;case t.ZHAO_QIN:return game.zhaoqinData.maxLayer}return 0},getOpenByShopId:function(e){var t=game.ShopCfg.getDataByShopId(e);if(!t)return!1;var a=game.miscData.openServerDay,i=game.mainRoleData.lv,n=this.getInsLevelByType(t.openInsType);return!(t.openLv>i||t.openDays>a||n<t.openInsLevel)},getIndexByShopId:function(e){return this.shopIdToIndex[e]},getAmountBg:function(){var e=b8e.Sprite.get();return e.setAnchor(0,.5),e.loadTexture(game.ResCfg.getUrl(78,"amountBg")),e}});game.shopData=game.shopData||new e}(),function(){var e;e=b8e.Object.extends({id:0,count:0,isJoin:!1,setData:function(e){this.id=e.id,this.count=e.count,this.isJoin=e.isJoin},initData:function(e){this.id=e}}),b8e.RC("$$game","$$ShopCrossAttendInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,COMMON_1:1,COMMON_2:2,GOLD_SHOP:3,COMMON_3:4}),b8e.RC("$$game","$$ShopEntrance",e)}(),function(){var e;e=b8e.Enum({NONE:0,YUANBAO_SHOP:1,EQUIP_SHOP:3,GOLDEQUIP_SHOP:4,EQUIP_FULI:5,BULUO_SHOP:6,BULUO_FULI:7,ARENA_SHOP:8,ARENA_FULI:9,YUSHA_SHOP:10,YUJO_SHOP:11,DATI_SHOP:12,WANGZHE_SHOP:13,WANGZHE_FULI:14,WORLD_SHOP:15,WORLD_FULI:16,CS_OVERLORD:17,HUSONG_SHOP:18,PRESTIGE_SHOP:19,EXCLUSIVE_SHOP:20,RESOURCE_SHOP:21,BARBARIAN_SHOP:23,DALIYWISH_SHOP:24,TRIAL_SHOP:25}),b8e.RC("$$game","$$ShopIdEnum",e)}(),function(){var e,t=e=b8e.Object.extends({goodsId:0,shopId:0,id:0,costItems:null,conditionType:0,conditionValue:0,maxNum:0,buyNum:0,isComplete:!1,num:0,cost:0,cfg:null,alert:!1,_shopCfg:null,ctor:function(){this._super()},setData:function(e,t){var a=this;if(a._shopCfg=e,a.goodsId=e.goodsId,a.shopId=e.shopId,a.id=e.itemId,a.costItems=e.costItems,a.conditionType=e.conditionType,a.conditionValue=e.conditionValue,a.maxNum=e.maxNum,a.buyNum=t,a.num=e.itemNum,a.isComplete=game.shopData.getIsPass(a.conditionType,a.conditionValue),a.costItems&&0<a.costItems.length){a.cost=a.costItems[0].Num}else a.cost=0;a.cfg=game.ItemInfoCfg.getData(a.id)},getComplete:function(){return this.isComplete},soldOut:{get:function(){return 0<this.maxNum&&this.buyNum>=this.maxNum}},getCondition:function(){var e="",t=this.conditionValue;if(0<this.conditionType&&this._shopCfg){var a=game.ShopCfg.getDataByShopId(this._shopCfg.shopId);a&&(a.id==game.ShopIdEnum.THOUSANDTOWER&&(t=game.thousandTowerData.getTowerIndexByBossID(t)),e=game.Lang.get(a.langKey,t))}return e}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$ShopItemInfo",e)}(),function(){var e;e=b8e.Object.extends({shopId:0,toggle:0,shopEntrance:0,isSelect:!1,alert:!1,shopIndex:0,name:null}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ShopTitleItemInfo",e)}(),function(){var e;e=game.View.extends({ctor:function(e){this._super(e)},init:function(){this.shopData=game.shopData;var e=this.titleImg=b8e.Sprite.get();e.addToParent(this.skin.title),e.setAnchor(.5,.5),this.amountIconList=[],this.bgList=[]},onShow:function(){this.updataPage()},updataPage:function(){var e=this.skin,t=this.shopCfg;if(t)if(this.setAmount(),t.resetType)if(e.resetDesc.node.active=!0,1==t.resetType)e.resetDesc.string=game.Lang.get(1321);else{var a=game.TimeUtil.getWeekText(t.resetValue);e.resetDesc.string=game.Lang.get(1322,a)}else e.resetDesc.node.active=!1},setSelectShop:function(){},setAmount:function(){var e=this,t=e.shopCfg;if(t&&t.showAmouts&&!(t.showAmouts.length<1)){var a=void 0,i=e.amountIconList.length,n=t.showAmouts,s=n.length;if(0<i)for(a=i-1;s<=a;a--)e.amountIconList[a].active=!1,e.bgList[a].active=!1;var o=void 0,r=void 0,g=void 0,l=0,c=void 0;for(a=0;a<s;a++)r=n[a],o=game.CCommonUtil.replaceNum(game.itemData.getCountById(r),1),g=e.amountIconList[a],(c=e.bgList[a])||(c=e.bgList[a]=game.shopData.getAmountBg()).addToParent(e.skin.amountIcon),g||(g=e.amountIconList[a]=new game.AmountIcon(game.IconSizeEnum.GRID_SIZE_42)).addToParent(e.skin.amountIcon),c.active=!0,c.x=l,g.active=!0,g.setItemInfo(r,o,game.Color.BLACK,20,!1,!1),g.x=l+10,l+=c.width+50}},getConditionDesc:function(){return this.shopCfg?game.Lang.get(this.shopCfg.descLangKey):""}}),b8e.RC("$$game","$$ShopPageView",e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(965),this.setSize(296,140)},init:function(){(this._itemGrid=game.GridUtil.createItemIcon(game.IconSizeEnum.GRID_SIZE_105)).addToParent(this.skin.icon),this.amountIconList=[],this.bgList=[]},setData:function(){var e=this.data,t=this.skin;t.click.active=!0,this.itemInfo=game.ItemUtil.createBaseItemInfo(e.id,e.num,this.itemInfo),game.GridUtil.setItemIcon(this._itemGrid,this.itemInfo,!1,2);var a=!0,i=t.conditionLab,n=t.buyNode;0<e.conditionType?(a=e.getComplete())?(i.active=!1,n.active=!0):(i.active=!0,n.active=!1,i.string=e.getCondition()):(n.active=!0,i.active=!1);var s=t.limitBuyLab,o=t.soldOut;if(e.maxNum<=0)s.active=!0,o.active=!1,s.string=game.Lang.get(1323);else if(e.buyNum>=e.maxNum)s.active=!1,t.click.active=!1,o.active=!0;else if(o.active=!1,0<e.maxNum&&a){s.active=!0;var r=game.ShopCfg.getDataByShopId(e.shopId);r.resetType?1==r.resetType?s.string=game.Lang.get(53045,e.buyNum,e.maxNum):s.string=game.Lang.get(53046,e.buyNum,e.maxNum):s.string=game.Lang.get(1324,e.buyNum,e.maxNum)}else s.active=!1;this.setAmount(e.costItems);var g=game.ItemInfoCfg.getData(e.id);t.name.string=g?game.HtmlUtil.getColorStrByQuality(g.quality,g.name):""},setAmount:function(e){var t=this;if(e&&!(e.length<1)){var a=void 0,i=t.amountIconList.length,n=e.length;if(0<i)for(a=i-1;n<=a;a--)t.amountIconList[a].active=!1,t.bgList[a].active=!1;var s=void 0,o=void 0,r=void 0,g=0,l=void 0;for(a=0;a<n;a++)o=e[a],s=game.CCommonUtil.replaceNum(o.Num,1),r=t.amountIconList[a],(l=t.bgList[a])||(l=t.bgList[a]=game.shopData.getAmountBg()).addToParent(t.skin.amountIcon),r||(r=t.amountIconList[a]=new game.AmountIcon(game.IconSizeEnum.GRID_SIZE_42)).addToParent(t.skin.amountIcon),r.active=!0,l.active=!0,l.y=g,r.setItemInfo(o.Id,s,game.Color.BLACK,20,!1,!1),r.y=g,r.x=20,g=r.y-30;t.skin.amountIcon.y=1<n?-53:-68}},click:function(){0<this.data.maxNum&&this.data.buyNum>=this.data.maxNum?game.notice.show(1326):this.send(game.ShopEvts.V_BUY_ITEM,this.data.goodsId)}})).poolCall=!0,b8e.RC("$$game","$$CommonShopItem",e)}(),function(){var e;e=game.ShopPageView.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:0;this.toggle=t,this._super(966)},init:function(){this._super();var e=this.shopItemList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.CommonShopItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.Shop,e.layout.spacingX=8,e.layout.spacingY=8,e.layout.paddingRight=0,e.layout.paddingLeft=0;var t=this.titleList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.ShopTitleItem,t.addToParent(this.skin.titleList),t.bindEnum=game.ME.Shop,t.layout.spacingX=-2,t.layout.paddingRight=0,t.layout.paddingLeft=0},notify:function(e){var t=this.Evts,a=this.shopData;switch(e){case t.V_UPDATE_CONDITION:case t.V_UPDATE_BUY_COUNT:case t.V_UPDATE_SHOP_DATA:this.itemList=a.getCurShopList(this.toggle),this.shopItemList.setData(this.itemList);break;case t.V_UPDATE_AMOUNT:this.setAmount();break;case t.C2V_SELECT_TITLE:this.updataPage()}},onShow:function(){var e=this;e.setTitleImg(),e.titleInfoList=e.shopData.getShopTitleList(e.toggle),e.titleInfoList&&1<e.titleInfoList.length?(e.skin.menuNode.active=!0,e.skin.list.height=e.shopItemList.height=760,e.titleList.width=Math.min(588,107*e.titleInfoList.length),e.skin.titleList.x=(614-e.titleList.width)/2):(e.skin.menuNode.active=!1,e.skin.list.height=e.shopItemList.height=830),e._super(),e.send(e.Evts.V2C_SHOW_COMMON_SHOP)},updataPage:function(){var e=this;if(e.shopCfg=game.ShopCfg.getDataByShopId(e.shopData.toggleShopId[e.toggle]),e.shopCfg){e.setAmount();var t=e.shopCfg,a=e.skin.conditionDesc;if(t.showCondition){a.node.active=!0;var i=e.getConditionDesc(),n=e.shopData.getConditionValue(t.showCondition);a.string=game.HtmlUtil.getText(game.Color.BLACK,i+":"+game.HtmlUtil.getText(game.Color.GREEN,n))}else a.node.active=!1;e.titleInfoList=e.shopData.getShowTitleList(e.toggle),e.titleList.setData(e.titleInfoList),e.itemList=e.shopData.getCurShopList(e.toggle),e.shopItemList.setData(e.itemList),e.shopItemList.scrollToTop()}},setTitleImg:function(){},onStageResize:function(){this.setPosition(0,0)}}),b8e.RC("$$game","$$CommonShopView",e)}(),function(){var e=game.CommonShopView.extends({ctor:function(){this._super(0)}});b8e.module.registerView(game.ME.SHOP_TOGGLE_1,e)}(),function(){var e=game.CommonShopView.extends({ctor:function(){this._super(1)}});b8e.module.registerView(game.ME.SHOP_TOGGLE_2,e)}(),function(){var e=game.CommonShopView.extends({ctor:function(){this._super(2)}});b8e.module.registerView(game.ME.SHOP_TOGGLE_3,e)}(),function(){var e=game.CommonShopView.extends({ctor:function(){this._super(3)}});b8e.module.registerView(game.ME.SHOP_TOGGLE_4,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(967),this.setSize(144,67)},setData:function(){var e=this;e.skin.selectImg.node.active=e.data.isSelect,e.skin.groupName.string=game.HtmlUtil.getText(game.Color.BLACK,e.data.groupName)},click:function(){this.send(game.ShopEvts.V_SELECT_GROUP,this.data.group)}}),b8e.RC("$$game","$$GoldEquipShopGroupItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(968),this.setSize(446,146)},init:function(){var e=this,t=e.amountIcon=b8e.Sprite.get();t.addToParent(e.skin.amountIcon),t.setSize(40,40),t.setAnchor(.5,.5),e._itemGrid=game.GridUtil.createItemIcon(game.IconSizeEnum.GRID_SIZE_105),e._itemGrid.addToParent(e.skin.icon)},setData:function(){var e=this,t=e.data,a=e.skin,i=game.ShopCfg.getDataByShopId(t.shopId);if(i){var n=game.ItemInfoCfg.getData(i.showAmout);if(n){var s=game.ResCfg.getUrl(137,n.icon);e.amountIcon.loadTexture(s)}else e.amountIcon.unloadTexture()}e.itemInfo=game.ItemUtil.createBaseItemInfo(t.id,t.num,e.itemInfo),game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo,!1,2);var o=!0,r=a.conditionLab;if(0<t.conditionType){if(o=t.getComplete()){r.node.active=!1}else r.node.active=!0,r.string=t.getCondition()}else r.node.active=!1;var g=a.limitBuyLab,l=a.soldOut;if(t.maxNum<=0){g.node.active=!1,l.node.active=!1}else if(t.buyNum>=t.maxNum){g.node.active=!1,l.node.active=!0}else if(l.node.active=!1,0<t.maxNum&&o){g.node.active=!0,g.string=game.Lang.get(1324,t.buyNum,t.maxNum)}else g.node.active=!1;if(t.costItems&&0<t.costItems.length){a.amountNum.string=t.costItems[0].Num}else a.amountNum.string="";var c=game.ItemInfoCfg.getData(t.id);if(c){var h=game.HtmlUtil,m=game.ItemCfgType;switch(c.cfgType){case m.Equip:var u=0,d=game.shengZhuangSlotData.getSlot(c.pos);if(d)u=c.power-d.power;else{u=c.power}var f=a.powerLab;a.power.active=0<u,f.string=h.getText(game.Color.GREEN,game.Lang.get(1327,u)),a.upgradeImg.node.x=f.node.x+f.node.width+2,a.name.string=game.Lang.get(1325,c.name,c.level);break;default:a.power.active=!1,a.name.string=c.name}var p=game.mainRoleData.lv,_=!!c.level&&c.level>p;a.levelLimitLab.active=_}else a.name.string="",a.power.active=!1},buyBtn:function(){var e=this;if(0<e.data.maxNum&&e.data.buyNum>=e.data.maxNum){game.notice.show(1326)}else e.send(game.ShopEvts.V_BUY_ITEM,e.data.goodsId)}}),b8e.RC("$$game","$$GoldEquipShopItem",e)}(),function(){var e=game.ShopPageView.extends({ctor:function(){this._super(969),this.spotAlerts={GOLD_EQUIP_RESOLVE:this.spotAlert}},spotAlert:function(e){this.skin.spotAlert.active=e.alert},init:function(){this._super();var e=this.groupList=new game.List;e.itemRender=game.GoldEquipShopGroupItem,e.addToParent(this.skin.groupList),e.bindEnum=game.ME.Shop,e.layout.spacingY=5,e.layout.paddingRight=0,e.layout.paddingLeft=0;var t=this.goldShopItemList=new game.List;t.itemRender=game.GoldEquipShopItem,t.addToParent(this.skin.list),t.bindEnum=game.ME.Shop,t.layout.spacingY=5,t.layout.paddingRight=0,t.layout.paddingLeft=0,this.shopData.initGroupNameList(game.ShopIdEnum.GOLDEQUIP_SHOP),this.shopGroupList=this.shopData.getGroupNameList()},notify:function(e){var t=this.shopData,a=this.Evts;switch(e){case a.V_SELECT_GROUP:this.itemList=t.getCurGroupItemInfoList();var i=this.shopGroupList;if(i&&0<i.length)for(var n,s=i.length,o=0;o<s;o++)(n=i[o]).group==t.group?n.isSelect=!0:n.isSelect=!1,i[o]=n;break;case a.V_UPDATE_CONDITION:this.itemList=t.getCurGroupItemInfoList();break;case a.V_UPDATE_AMOUNT:this.setAmount()}},onShow:function(){this.shopCfg=game.ShopCfg.getDataByShopId(game.ShopIdEnum.GOLDEQUIP_SHOP),this._super()},updataPage:function(){this._super();var e=this.skin.conditionDesc;if(this.shopCfg.showCondition){e.node.active=!0;var t=this.getConditionDesc(),a=this.shopData.getConditionValue(this.shopCfg.showCondition);e.string=game.Lang.get(1201,t,a)}else e.node.active=!1;this.setSelectShop()},setSelectShop:function(){var e,t=this.shopGroupList,a=t.length,i=this.shopData;if(t&&0<t.length){for(var n=0;n<a;n++)if((e=t[n]).group==this.shopData.group){e.isSelect=!1;break}t[0].isSelect=!0;var s=t[0].group;this.itemList=i.getGroupItemInfoList(s),this.goldShopItemList.setData(this.itemList)}this.groupList.setData(t)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GoldEquipShop,e)}(),function(){var e=void 0;(e=game.View.extends({shopId:0,itemId:0,goodsId:0,_modelTouchClose:!0,_showModel:!0,count:0,boughtNum:0,maxNum:0,ctor:function(){this._super(747)},notify:function(e){switch(e){case this.Evts.V_CHANGE_COUNT:this.setCount()}},showBuyView:function(e){this.goodsId=e;var t=this.shopItemCfg=game.ShopItemCfg.getDataByGoodsId(e);t&&(this.shopId=t.shopId,this.itemId=t.itemId,this.parent?this.isInit&&this.setData():game.GameViewMgr.inst().showView(this,null,!1,2))},init:function(){var e=this.skin;this._itemGrid=game.GridUtil.createShopIcon(),this._itemGrid.addToParent(e.icon),this.noticeAlert={lang:6661,key:game.AlertKey.SHOP_IMPORTANT_NOTICE,okcb:this.buyItem,thisArg:this,showtips:!0,defaultSelect:!0,align:b8e.HorizontalAlign.CENTER},e.count._editBox._textLabel.horizontalAlign=b8e.HorizontalAlign.CENTER,e.count.onEditingEnded(this.editingEnd,this),this.patt=/^[0-9]*[1-9][0-9]*$/},onShow:function(){this.setData()},setData:function(){var e=this,t=e.shopItemCfg;e.count=1;var a=e.skin;e.itemInfo=game.ItemUtil.createBaseItemInfo(t.itemId,t.itemNum,e.itemInfo),game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo,!1,2);var i=game.ItemInfoCfg.getData(t.itemId);if(i){var n=game.HtmlUtil;i.des||i.des2?a.desc.string=game.Lang.get(1331,i.des,null!=i.des2?i.des2:""):a.desc.string="";var s=game.ItemCfgType;switch(i.cfgType){case s.Equip:var o=game.Lang.get(1325,i.name,i.level);a.name.string=n.getColorStrByQuality(i.quality,o);break;default:a.name.string=n.getColorStrByQuality(i.quality,i.name)}}else a.desc.string="",a.name.string="";var r=t.costItems;if(r&&0<r.length){var g,l=game.ItemInfoCfg.getData(r[0].Id);l?(g=game.ResCfg.getUrl(137,l.icon),e.skin.amountSp.loadTexture(g)):e.skin.amountSp.unloadTexture(),r[1]&&(l=game.ItemInfoCfg.getData(r[1].Id))?(g=game.ResCfg.getUrl(137,l.icon),e.skin.amountSp2.loadTexture(g)):e.skin.amountSp2.unloadTexture()}e.maxNum=t.maxNum,e.maxBuyNum=t.buyNum,a.content.height=a.desc.height,e.refreshCount(),e.refreshBought()},refreshCount:function(){var e=this.skin;e.count.string=this.count+"",e.amountNum.string=game.Lang.get(1330,0);var t=this.shopItemCfg;if(t){var a=t.costItems;if(a&&0<a.length){var i=game.CCommonUtil.replaceNum(a[0].Num*this.count);e.amountNum.string=game.Lang.get(1330,i),a[1]?(i=game.CCommonUtil.replaceNum(a[1].Num*this.count),e.amountNum2.string=game.Lang.get(1330,i)):e.amountNum2.string=""}else e.amountNum.string="",e.amountNum2.string=""}},refreshBought:function(){this.maxNum<=0?this.skin.limitBuyLab.string="":(this.boughtNum=game.shopData.getBoughtNum(this.goodsId),this.skin.limitBuyLab.string=game.Lang.get(1324,this.boughtNum,this.maxNum))},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)},closeBtn:function(){this.removeFromParent()},returnBtn:function(){this.removeFromParent()},addBtn:function(){var e=this.count+1;this.check(e)},lessBtn:function(){var e=this.count-1;this.check(e)},addTenBtn:function(){this.check(this.maxBuyNum)},lessTenBtn:function(){this.check(1)},editingEnd:function(){var e=this.skin.count.string;if(!this.patt.test(e)||""===e)return this.skin.count.string=this.count+"",void game.notice.show(1607);this.check(+e)},check:function(e){var t=this,a=1,i=1;if(1<e){var n=t.shopItemCfg;if(n){var s=n.costItems;if(s&&0<s.length){var o=s[0].Num,r=game.itemData.getCountById(s[0].Id);if(o<r&&(i=r/o|0),s[1]){o=s[1].Num;var g=(r=game.itemData.getCountById(s[1].Id))/o|0;i=i<g?i:g}}}if(0<t.maxNum){if(t.maxNum>t.boughtNum){var l=t.maxNum-t.boughtNum;i=l<i?l:i}}else i=i>t.maxBuyNum?t.maxBuyNum:i;a=i<e?i:e}t.count=a,t.refreshCount()},buyBtn:function(){var e=this,t=e.shopItemCfg;if(t){if(t.conditionType&&t.conditionType!=game.ItemCfgType.TreasurePavilion)if(!game.shopData.getIsPass(t.conditionType,t.conditionValue))return void game.notice.show(9314);if(!(0<e.maxNum&&(e.boughtNum=game.shopData.getBoughtNum(e.goodsId),e.boughtNum>=e.maxNum)))if(game.UpgradeUtil.checkItemList(t.costItems,e.count))if(t.important){var a=void 0,i=game.ItemInfoCfg.getData(t.itemId);i&&(a=game.HtmlUtil.getColorStrByQuality(i.quality,i.name));var n=void 0,s=void 0;if(t.costItems&&0<t.costItems.length&&(s=t.costItems[0])){var o=game.ItemInfoCfg.getData(s.Id);o&&(n=game.HtmlUtil.getColorStrByQuality(o.quality,o.name))}if(a&&s&&n){var r=t.itemNum*e.count,g=s.Num*e.count;e.noticeAlert.langArgs=[a,r,n,g],e.noticeAlert.args=[e.goodsId,e.count],game.alert.showTwo(e.noticeAlert)}}else e.buyItem(e.goodsId,e.count);else e.removeFromParent()}},buyItem:function(e,t){this.buyData||(this.buyData={goodsId:e,count:t}),this.buyData.goodsId=e,this.buyData.count=t,this.dptG(game.ShopGEvts.BUY_ITEM,this.buyData),this.removeFromParent()}}))._instance=null,e.inst=function(){return e._instance||(e._instance=new e),e._instance},b8e.RC("$$game","$$ShopBuyView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(970),this.setSize(107,60)},setData:function(){var e=this,t=e.skin;t.spot_alert.node.active=e.data.alert,t.titleName.string=e.data.name;var a=e.data.isSelect,i=void 0;e.data.isHead?(i="head",e.skin.bg.scaleX=1):e.data.isTail?(i="head",e.skin.bg.scaleX=-1):(i="middle",e.skin.bg.scaleX=1),i+=a?"_sel":"_unsel",e.skin.bg.loadTexture(game.ResCfg.getUrl(10171,i))},click:function(){this.send(game.ShopEvts.V_SELECT_TITLE,[this.data.toggle,this.data.shopId])}}),b8e.RC("$$game","$$ShopTitleItem",e)}(),function(){var e=game.View.extends({curModuleEnum:0,ctor:function(){this._super(971),this.toggles={toggle_btn_1:game.ME.SHOP_TOGGLE_1,toggle_btn_2:game.ME.SHOP_TOGGLE_2,toggle_btn_3:game.ME.SHOP_TOGGLE_3,toggle_btn_4:game.ME.SHOP_TOGGLE_4},this.spotAlerts={}},checkSpotAlert1:function(e){this.skin.red_spot_1.active=e.alert},init:function(){game.shopData.initData(),this.send(this.Evts.V2C_INIT_SHOP)},notify:function(e,t){switch(e){case this.Evts.V_SWITCH_PAGE:this.toggleSelect(t)}},onShow:function(){this.toggleSelect(0)},onHide:function(){},toggleSelect:function(e){game.shopData.toggle=e,this._super(e)}});b8e.module.registerView(game.ME.Shop,e)}(),function(){var e;e=b8e.Enum({None:0,GetTotalPrize:-1,GetOtherPrize:-1,V_UPDATEDATA:-1}),b8e.RC("$$game","$$SignInEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.SIGNIN_PRIZE,game.SAE.WELFARE_ALERT)},ipc:function(){this.evts={MainRole:{C_VIP_LEVEL_CHANGE:this.checkAlert,C_RESET_DAILY:this.resetDaily},Recharge:{C_RECHARGE_SUCCESS:this.checkAlert},Welfare:{C_INIT_MODEL:this.initSignInData}},this.handels={SignAwardResp:this.onSignAwardResponse}},initSignInData:function(){game.signInData.initData(),this.checkAlert()},resetDaily:function(){game.signInData.updateLoginDay(),this.checkAlert()},onSignAwardResponse:function(e){var t=e.readProtobuf(game.pb.GetSignAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.signInData.getPrizeComplete(t.awardType),this.checkAlert(),this.send(this.Evts.V_UPDATEDATA),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},notify:function(e,t){var a=this;switch(e){case a.Evts.GetOtherPrize:a.sender.SignAwardReq(t)}},bt_getTotal:function(){this.sender.SignAwardReq(4)},checkAlert:function(){this.spotAlert.alert=game.signInData.checkSignInList()&&game.moduleOpen.checkOpen(game.ME.SignInPrize)}}),t=game.Sender.extends({ipc:function(){this.msg={SignAwardReq:this.signAwardReq}},signAwardReq:function(e){var t=game.pb.GetSignAwardRequest;t.awardType=e,this.write(t)}});b8e.module.registerControl(game.ME.SignInPrize,e,game.SignInEvts,t)}(),function(){var e=b8e.Object.extends({signInAwards:null,isGetTotalPrize:!1,canGetTotalPrize:!1,signLoginDay:0,recordMonth:0,recordDay:0,initData:function(){var e=this.signInMap=b8e.HashMap.get(),t=this.getCfg();if(t){for(var a,i=[t.dailyAward,t.vipAward,t.rechargeAward],n=i.length,s=0;s<n;s++){(a=new game.SignInInfo).setConfig(s+1,i[s]),e.set(a.type,a)}var o=t.totalLoginAward;if(o&&0<o.length){if(this.todalDayPrizeInfo)this.todalDayPrizeInfo.setData(o[0].Id,o[0].Num,game.IconLayoutEnum.SHOW_NUM);else{this.todalDayPrizeInfo=game.ItemUtil.createPrizeInfo(o[0].Id,o[0].Num),this.todalDayPrizeInfo.iconLayoutEnum=2}}this.checkSignInList()}else;},getInfo:function(){return this.signInMap.values()},setupSignInAwards:function(e){if(e){if(e.signAwards){this.signInAwards=e.signAwards,this.signLoginDay=e.signLoginDay}this.checkSignInList(),this.updateLoginDay()}else;},updateLoginDay:function(){if(31<this.signLoginDay){this.signLoginDay=this.signLoginDay%31==0?31:this.signLoginDay%31}},getPrizeComplete:function(e){var t=this,a=t.signInAwards;if(-1<a.indexOf(e)){b8e.error("\u91cd\u590d\u9886\u53d6\u6210\u529f\uff1f")}else a.push(e),t.checkSignInList()},isGetPrize:function(e){return-1<this.signInAwards.indexOf(e)},canGetPrize:function(e){if(1==e){return!this.isGetPrize(e)}if(2==e){return!this.isGetPrize(e)&&game.mainRoleData.vipLevel>=this.getCfg().vipLv}if(3==e){return!this.isGetPrize(e)&&0<game.rechargeData.rechargeMoneyDaily}if(4==e){return!this.isGetPrize(e)&&this.signLoginDay>=this.getCfg().loginDays}},checkSignInList:function(){var e=this,t=e.signInMap;if(t){if(this.getCfg()){for(var a,i=!1,n=0;n<3;n++){if((a=t.get(1+n)).isGetPrize=e.isGetPrize(1+n),a.canGetPrize=e.canGetPrize(1+n),a.canGetPrize){i=!0}}if(e.isGetTotalPrize=e.isGetPrize(4),e.canGetTotalPrize=e.canGetPrize(4),e.canGetTotalPrize){i=!0}return i}}else;},getCfg:function(){return game.SignInAwardCfg.getDataByDay(this.signLoginDay,game.miscData.openServerDay)}});game.signInData=game.signInData||new e}(),function(){var e;e=b8e.Object.extends({isGetPrize:!1,canGetPrize:!1,itemType:0,config:null,setConfig:function(e){var t=this;t.type=e,t.itemType=e,t.config=game.SignInAwardCfg.getDataByDay(game.signInData.signLoginDay,game.miscData.openServerDay),t.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM},getPrizeItems:function(){var e,t=this,a=t.type;if(!t.config){return null}if(t.awards){return t.awards}if(1==a){e=t.config.dailyAward}else if(2==a){e=t.config.vipAward}else if(3==a){e=t.config.rechargeAward}var i,n,s=e.length;t.awards=[];for(var o=0;o<s;o++){i=e[o],(n=game.ItemUtil.createBaseItemInfo(i.Id,i.Num)).iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,t.awards.push(n)}return t.awards}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$SignInInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(972),this.setSize(601,177)},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.priceList),e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=-5,e.layout.spacingX=17,e.layout.spacingY=-5},setData:function(){var e=this.skin,t=this.data,a=t.getPrizeItems();this.prizeList.setData(a),1==t.itemType?e.lb_tips.string=game.Lang.get(9315):2==t.itemType?e.lb_tips.string=game.Lang.get(9546,t.config.vipLv):3==t.itemType&&(e.lb_tips.string=game.Lang.get(9316)),t.isGetPrize?(e.bt_get.node.active=!1,e.bt_isGet.node.active=!0,e.bt_cantGet.node.active=!1):t.canGetPrize?(e.bt_get.node.active=!0,e.bt_isGet.node.active=!1,e.bt_cantGet.node.active=!1):(e.bt_get.node.active=!1,e.bt_isGet.node.active=!1,e.bt_cantGet.node.active=!0)},bt_get:function(){this.send(game.SignInEvts.GetOtherPrize,this.data.itemType)}}),b8e.RC("$$game","$$SignInListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(973)},init:function(){var e=this,t=e.skin;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.list.itemRender=game.SignInListItem,e.list.bindEnum=game.ME.SignInPrize,e.list.layout.paddingLeft=0,e.list.layout.spacingY=5,e.list.addToParent(t.list),e._icon=game.GridUtil.createItemIcon(game.IconSizeEnum.SIZE_70),e._icon.addToParent(t.icon),e._icon.setAnchor(.5,.5)},notify:function(e){switch(e){case game.SignInEvts.V_UPDATEDATA:this.updateData()}},onShow:function(){this.datas=game.signInData.getInfo(),this.list.setData(this.datas);var e=game.signInData.todalDayPrizeInfo;game.GridUtil.setItemIcon(this._icon,e,!1,2),this.updateData()},updateData:function(){var e=this.skin;e.day.string=game.signInData.signLoginDay;var t=game.HtmlUtil.getText(game.Color.WHITE,game.Lang.get(9317))+game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9531,game.signInData.signLoginDay));e.tips2.string=t,game.signInData.isGetTotalPrize?(e.bt_getTotal.node.active=!1,e.bt_isGetTotal.node.active=!0,e.bt_cantGetTotal.node.active=!1):game.signInData.canGetTotalPrize?(e.bt_getTotal.node.active=!0,e.bt_isGetTotal.node.active=!1,e.bt_cantGetTotal.node.active=!1):(e.bt_getTotal.node.active=!1,e.bt_isGetTotal.node.active=!1,e.bt_cantGetTotal.node.active=!0)},onHide:function(){},onStageResize:function(){}});b8e.module.registerView(game.ME.SignInPrize,e)}(),function(){var e;e=b8e.Enum({NONE:-1,V_SHOW:-1,V_UPDATE_SUIT:-1}),b8e.RC("$$game","$$SuitEvts",e)}(),function(){var e=game.Control.extends({equipSlotData:null,suitData:null,ipc:function(){this.evts={Surface:{UPDATE_MODULE_DATA:this.setSurFaceSkinList,C2V_ACTIVE_SUCCEED:this.addSuitSkinId}}},init:function(){this.equipSlotData=game.equipSlotData,this.suitData=game.suitData},notify:function(e,t){switch(e){case this.Evts.V_UPDATE_SUIT:this.setSuitBtnView(t)}},setSuitBtnView:function(e){game.suitData.selectSuitInfo(e),this.send(this.Evts.V_UPDATE_SUIT)},addSuitSkinId:function(e){if(e&&e.data)game.suitData.addSkinId(e.data),this.send(this.Evts.V_UPDATE_SUIT);else;},setSurFaceSkinList:function(e){if(e&&e.data)game.suitData.setSuitSkinList(e.data),this.send(this.Evts.V_UPDATE_SUIT);else;},btn_left:function(){},btn_right:function(){}}),t=game.Sender.extends({ipc:function(){this.msg={}}}),a=[game.ME.SuitMain];b8e.module.registerControl(game.ME.Suit,e,game.SuitEvts,t,a)}(),function(){var e=void 0;e=b8e.Object.extends({suitLevel:0,number:0,isActive:!1,suitInfoList:null,suitSkinList:null,curId:0,ctor:function(){this.suitSkinList=[]},setSuitSkinList:function(e){if(!e||!e.fashions||e.fashions.length<1);else{var t=e.fashions;if(0<t.length){this.suitSkinList=this.suitSkinList.concat(t)}}},addSkinId:function(e){this.suitSkinList.push(e)},isHasSkinId:function(e){if(!this.suitSkinList||this.suitSkinList.length<1){return!1}return-1!=this.suitSkinList.indexOf(e)},getCurSuitCfgData:function(){return game.SuitCfg.getData(this.curId)},selectSuitInfo:function(e){if(this.suitInfoMap){var t=this.suitInfoMap.get(this.curId);if(t){t.select=!1}this.curId=e;var a=this.suitInfoMap.get(this.curId);if(a){a.select=!0}}else;},getCurSuitSpriteState:function(){return game.SuitAttrCfg.getIdDatas(this.curId)},getSuitData:function(){if(!this.suitInfoList&&!this.suitInfoMap){this.createSuitData()}return this.suitInfoList},createSuitData:function(){if(!this.suitInfoList){this.suitInfoList=[]}if(!this.suitInfoMap){this.suitInfoMap=b8e.HashMap.get()}this.suitInfoList.length=0;for(var e=game.SuitCfg.getDatas(),t=null,a=0;a<e.length;++a){(t=new game.SuitInfo).data=e[a],this.suitInfoList.push(t),this.suitInfoMap.set(t.data.id,t)}if(0==this.curId){if(this.suitInfoList[0]){this.selectSuitInfo(this.suitInfoList[0].data.id)}else b8e.warn("\u5957\u88c5suitInfoList[0]\u4e0d\u5b58\u5728\uff1f")}}}),game.suitData=game.suitData||new e,b8e.RC("$$game","$$SuitData",e)}(),function(){var e;e=b8e.Object.extends({data:null,select:!1}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$SuitInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,FASHION:5}),b8e.RC("$$game","$$SuitSkinType",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(985),this.setSize(95,130)},init:function(){this._iconSp=b8e.Sprite.get(),this._iconSp.setAnchor(.5,.5),this._iconSp.addToParent(this.skin.iconBg)},setData:function(){if(this.data){var e=this.data.data,t=game.ResCfg.getUrl(93,e.nameIcon);this._iconSp.loadTexture(t),this.skin.selected.active=this.data.select}else;},viewsuitBtn:function(){var e=this.data.data;if(game.suitData.curId!=e.id)this.send(game.SuitEvts.V_UPDATE_SUIT,e.id);else;}}),b8e.RC("$$game","$$SuitBtnItem",e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(986),this.setSize(147,222)},init:function(){this.grid=game.GridUtil.createCostItemIcon(),this.grid.addToParent(this.skin.gridNode)},onShow:function(){this.setData(this._data)},setData:function(e){if(this._data=e,this.skin&&e){var t=game.SuitSkinCfg.getData(e);if(t){var a=this.skin,i=game.HtmlUtil.getulText(game.Lang.get(1347,t.name));a.name.string=i;var n=game.suitData.isHasSkinId(e);a.jihuo_1.node.active=n,a.jihuotips.string=n?game.Lang.get(1340):game.Lang.get(1341),this.spriteStat||(this.spriteStat=game.SpriteStat.get()),this.spriteStat.setupByCfg(t);var s=this.spriteStat.getTeamPower();a.power.string=n?game.Lang.get(1344,s):game.Lang.get(1345,s),this.grid.setItemInfo(t.itemId)}else;}else;},viewgotoBtn:function(){var e=game.SuitSkinCfg.getData(this._data);if(e){var t=this._data,a=game.ME.Surface,i=1,n=game.surfaceData;switch(e.types){case game.SurfaceTypes.FASHION:n.setSelected(game.SurfaceTypes.FASHION,t),i=1;break;case game.SurfaceTypes.MOUNT:n.setSelected(game.SurfaceTypes.MOUNT,t),i=2;break;case game.SurfaceTypes.WING:n.setSelected(game.SurfaceTypes.WING,t),i=4;break;case game.SurfaceTypes.WEAPON:n.setSelected(game.SurfaceTypes.WEAPON,t),i=3}0<a&&(-1<i?game.module.showToggle(a,i):game.module.show(a))}}}),b8e.RC("$$game","$$SuitItem",e)}(),function(){var e=game.CultivateBaseModelView.extends({_showModel:!0,maxItem:4,stateMaxItem:3,suitItemList:null,stateItemList:null,ctor:function(){this._super(987),this.suitItemList=[],this.suitInfo=game.suitData.getSuitData(),this.stateItemList=[]},notify:function(e){switch(e){case this.Evts.V_UPDATE_SUIT:this.updateView()}},init:function(){var e=this.skin;this.suitBtnList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);var t,a=this.suitBtnList;a.itemRender=game.SuitBtnItem,a.layout.paddingLeft=0,a.layout.paddingRight=0,a.layout.paddingTop=0,a.layout.spacingX=2,a.bindEnum=game.ME.Suit,a.addToParent(e.suitList),a.setScrollViewCb(this.suitListCb,this);for(var i=0;i<this.maxItem;++i){(t=new game.SuitItem).bindEnum=this.moduleEnum,this.suitItemList.push(t),t.addToParent(this.getComponent("suitItemNode_"+i))}for(i=0;i<this.stateMaxItem;++i){(t=new game.SuitSpriteStateItem).bindEnum=this.moduleEnum,this.stateItemList.push(t),t.addToParent(this.getComponent("itemNode_"+i))}},onShow:function(){this.updateView()},updateView:function(){var e=this,t=game.suitData.getCurSuitCfgData();if(t){e.tempSpriteStat||(e.tempSpriteStat=game.SpriteStat.get()),e.tempSpriteStat.clear();var a=e.skin;a.nameLab.string=game.Lang.get(1347,t.name);var i=t.needs,n=void 0,s=void 0,o=0;if(i&&0<i.length){for(var r=0;r<i.length&&r<this.maxItem;++r){if(n=i[r],this.suitItemList[r].setData(n),s=game.SuitSkinCfg.getData(n)){if(game.suitData.isHasSkinId(n)){this.tempSpriteStat.addByCfg(s),++o}}}this.updateModel(i)}e.tempSpriteStat2||(e.tempSpriteStat2=game.SpriteStat.get()),e.tempSpriteStat2.clear();var g=game.suitData.getCurSuitSpriteState(),l=void 0;if(g&&0<g.length)for(r=0;r<g.length&&r<this.stateMaxItem;++r){if(o>=(l=g[r]).num){this.tempSpriteStat2.setupByCfg(l)}this.stateItemList[r].setData(l,o)}e.tempSpriteStat.addSpriteStat(e.tempSpriteStat2),a.power.string=e.tempSpriteStat.getTeamPower(),game.AutoLayoutUtil.layoutPower(a.compowerImg,a.power,a.iconpower);var c=game.suitData.getSuitData();e.suitBtnList.setData(c)}else;},updateModel:function(e){var t=this;if(e&&0!=e.length||b8e.warn("\u5957\u88c5\u90e8\u4ef6\u6a21\u578b\u6570\u636e\u4e3a\u7a7a"),!t.model){var a=t.roleData=game.BaseRoleData.get(game.RoleType.Hero,1);t.model=game.sceneRoleCreate.createUIRole(a),t.model.addToParent(t.skin.modelNode),t.skin.modelNode.setScale(.8,.8)}var i=t.roleData.heroModel;i.clear();var n=game.mainRoleData.isMale;t.roleData.setMale(n),i.setBody(game.RoleType.Hero,n?1001:1002),i.setSurfaces(e),game.AvatarUtil.updateUIModel(t.model,1,!0),t.model.transition(game.RoleStateType.ACTION_IDLE)},suitListCb:function(e,t,a){var i=!1;i=0<e.length,this.skin.viewbtn_left.node.active=i,i=0<a.length,this.skin.viewbtn_right.node.active=i},viewbtn_left:function(){this.suitBtnList.scrollContainerLeft()},viewbtn_right:function(){this.suitBtnList.scrollContainerRight()}});b8e.module.registerView(game.ME.SuitMain,e,game.SuitEvts)}(),function(){var e;e=game.Widget.extends({num:0,ctor:function(){this._super(988),this.setSize(184,132)},init:function(){},onShow:function(){this.setData(this._data,this.num)},setData:function(e,t){var a=this;if(a._data=e,a.num=t,a.skin&&e){var i=a.skin,n=4==a._data.num;i.itemBg.width=n?224:185,i.spriteStateTips.x=i.power.x=n?-96:-80;var s=a.num>=a._data.num;a.spriteStat||(a.spriteStat=game.SpriteStat.get()),a.spriteStat.setupByCfg(a._data);var o=a.spriteStat.getTeamPower();a.skin.tips_0.string=s?game.Lang.get(1342,a._data.num):game.Lang.get(1343,a._data.num),a.skin.power.string=s?game.Lang.get(1344,o):game.Lang.get(1345,o);var r=a.getSpriteStatDesc(a._data);a.skin.spriteStateTips.string=s?game.Lang.get(1347,r):game.Lang.get(1346,r)}},getSpriteStatDesc:function(e){var t="",a=0,i=game.SpriteStatType;if(e.attrIds)for(var n=0,s=e.attrIds.length;n<s;n++){var o=game.AttrRulesCfg.getData(e.attrIds[n]);switch(o.id){case i.TeamHp:a=e.clientTeamHp;break;case i.TeamDef:a=e.clientTeamDef;break;case i.TeamAtk:a=e.clientTeamAtk;break;case i.TeamIgnoreDef:a=e.clientTeamIgnoreDef;break;case i.TeamIgnoreDefRes:a=e.clientTeamIgnoreDefRes}t+=o.name+":"+a+"<br/>"}return t}}),b8e.RC("$$game","$$SuitSpriteStateItem",e)}(),function(){var e=game.View.extends({_showModel:!0,_addNodeTouch:!0,ctor:function(){this._super(989),this.attrStr=[]},init:function(){this.suitData=game.suitData,this._spriteStat=game.SpriteStat.get()},onShow:function(){this.updateView()},updateView:function(){var e=this.skin,t=game.shengZhuangSlotData,a=t.suitCfg;if(a){var i=this._spriteStat;i.setupByCfg(a);var n=game.Lang,s=t.isActiveSuit;e.effectTitleLab.string=s?n.get(601):n.get(602),e.effectLab.string=n.get(606,a.number,a.level),e.isactivatedImg.active=!s,e.activatedImg.active=s;var o=game.CCommonUtil.getPower(i);e.isactivatedLab.string=n.get(603,o);var r=this.attrStr;r.length=0;var g=i.getSpriteStats(),l=void 0;g.forEach(function(e,t){e=+e,l=game.AttrRulesCfg.getData(e),r.push(l.name),r.push(t)},this),e.attrLab.string=n.get(605,r)}}});b8e.module.registerView(game.ME.Suit,e,game.SuitEvts)}(),function(){var e;e=b8e.Enum({None:0,REQ_TAOFADATA:-1,REQ_QUICKTAOFA:-1,REQ_TAOFAWARD:-1,REQ_TAOFASTAR:-1,UPDATE_TAOFAPAGE:-1,UPDATA_STAR:-1,REQ_TAOFA:-1,C2C_TAOFA:-1}),b8e.RC("$$game","$$TaoFaEvts",e)}(),function(){var e=game.Control.extends({timer:null,init:function(){this.taofaAccumulateNum=0|game.DailyMiscCfg.getData("taofaAccumulateNum").value,this.spotAlert=game.spotAlert.set(game.SAE.TAO_FA_ALERT,game.SAE.DAILY_FULI),this.taofaAlert=game.spotAlert.set(game.SAE.TAO_FA_ALERT_AWARD,game.SAE.TAO_FA_ALERT),this.taofaKillAlert=game.spotAlert.set(game.SAE.TAO_FA_KILL_ALERT,game.SAE.TAO_FA_ALERT)},ipc:function(){var e=this;e.gevts={SceneGEvts:{CLICK_MONSTER:e.onShowTaoFaView,ENTER_SCENE:e.enterScene}},e.evts={DailyFuLi:{C_INIT_MODULE:e.setupDailyData},TaoFaPage:{REQ_TAOFADATA:e.reqTaofaData,REQ_TAOFAWARD:e.reqTaofaAward,REQ_TAOFASTAR:e.reqTaoFaStar},MainRole:{C_LEVEL_UP:e.updateLevel}},e.handels={TaofaDataResp:e.onTaofaDataResp,TaofaResp:e.onTaofaResp,QuickTaofaResp:e.onQuickTaofaResp,TaofaAwardResp:e.onTaofaAwardResp,TaofaStarResp:e.onTaofaStarResp}},notify:function(e){switch(e){case this.Evts.REQ_TAOFADATA:this.reqTaofaData();break;case this.Evts.REQ_TAOFASTAR:this.reqTaoFaStar();break;case this.Evts.REQ_TAOFA:this.onReqTaofa()}},setupDailyData:function(e){e&&e.data&&(game.taoFaData.setupDailyData(e.data),this.checkTaofaAlert(),this.checkTaofaKillAlert(),this.sender.TaofaDataReq())},reSetSceneMonster:function(){var e=game.mainRoleData.mapId,t=game.DailyTaofaCfg.getData(e);if(t){var a,i=t.monGroups,n=t.pos;if(i&&0<i.length&&n&&n.length)for(var s=0;s<i.length&&s<n.length;++s)a=n[s],game.sceneRoleCreate.createMonsterRole(i[s],a.X,a.Y)}},onShowTaoFaView:function(e){e&&e.data},onTaofaDataResp:function(e){var t=e.readProtobuf(game.pb.TaofaDataResponse);0<t.code?game.notice.noticeError(t.code):(game.taoFaData.setTaoFaData(t),this.checkTaofaKillAlert(),this.send(this.Evts.UPDATE_TAOFAPAGE),b8e.Tween.kill(this),0<t.recoverTime&&b8e.Tween.get(this).wait(t.recoverTime).call(this.updateTimer,this))},updateTimer:function(){game.taoFaData.resetMonster(),this.checkTaofaKillAlert(),this.reqTaofaData()},enterScene:function(){var e=game.mainRoleData.mapId;if(e){var t=game.SceneCfg.getData(e);!t||t.type!=game.SceneType.NONE0&&t.type!=game.SceneType.NONE1||game.taoFaData.isWaitReset&&game.taoFaData.resetMonster()}},onTaofaResp:function(e){var t=e.readProtobuf(game.pb.TaofaResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.GameViewMgr.inst().hideUnStrongViews();var a={type:game.InstanceType.TAO_FA,rewards:t.useritem,exp:t.exp};game.playBack.play(t.battlelog,a),game.taoFaData.taofaWins=t.taofaWins,this.checkTaofaAlert(),this.checkTaofaKillAlert(),this.dpt(this.Evts.C2C_TAOFA,1)}},onQuickTaofaResp:function(e){var t=e.readProtobuf(game.pb.QuickTaofaResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.taoFaData.taofaAccumulateNum-game.taoFaData.taofaWins;game.taoFaData.taofaWins=game.taoFaData.taofaAccumulateNum,this.checkTaofaAlert(),this.send(this.Evts.UPDATE_TAOFAPAGE),this.dpt(this.Evts.C2C_TAOFA,a)}},onTaofaAwardResp:function(e){var t=e.readProtobuf(game.pb.TaofaAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.taoFaData.taofaAward=!0,this.checkTaofaAlert(),this.send(this.Evts.UPDATE_TAOFAPAGE),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},onTaofaStarResp:function(e){var t=e.readProtobuf(game.pb.TaofaStarResponse);0<t.code?game.notice.noticeError(t.code):(game.taoFaData.setAllStar(),this.send(this.Evts.UPDATA_STAR))},reqTaofaData:function(){this.sender.TaofaDataReq()},reqTaofaAward:function(){game.UpgradeUtil.checkEquipTooMuch()||this.sender.TaofaAwardReq()},reqTaoFaStar:function(){this.sender.TaofaStarReq()},onekeyBtn:function(){var e=0|game.DailyMiscCfg.getData("taofaAccumulateNum").value;if(game.taoFaData.taofaWins<e){var t=game.mainRoleData.vipLevel,a=game.VipCfg.getData(t);if(a&&a.questComplete){if(!game.taoFaData.taofaAward&&!game.UpgradeUtil.checkEquipTooMuch()){var i=game.taoFaData.getQuickTaofaCost();i<=game.amount.get(game.AmountType.YUAN_BAO)?game.alert.show({lang:1357,langArgs:i,okcb:this.onClickTaoFaAlert,thisArg:this}):game.notice.show(game.Lang.get(115,i))}}else game.notice.show(1356)}else game.taoFaData.taofaAward||this.reqTaofaAward()},onClickTaoFaAlert:function(){this.sender.QuickTaofaReq()},fightBtn:function(){game.taoFaData.setMonster(),game.module.show(game.ME.TaoFaView)},onReqTaofa:function(){game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()||game.UpgradeUtil.checkEquipTooMuch()||this.sender.TaofaReq(game.taoFaData.monsterId)},checkTaofaAlert:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.taofaAlert.alert=!game.taoFaData.taofaAward&&game.taoFaData.taofaWins==this.taofaAccumulateNum)},checkTaofaKillAlert:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.taofaKillAlert.alert=0<game.taoFaData.num)},updateLevel:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&!this._init&&(this.reqTaofaData(),this._init=!0)}}),t=game.Sender.extends({ipc:function(){this.msg={TaofaDataReq:null,TaofaReq:this.reqTaofa,QuickTaofaReq:null,TaofaAwardReq:null,TaofaStarReq:null}},reqTaofa:function(e){var t=game.pb.TaofaRequest;t.monsterGroup=e,this.write(t)}}),a=[game.ME.TaoFaView];b8e.module.registerControl(game.ME.TaoFaPage,e,game.TaoFaEvts,t,a)}(),function(){var e=b8e.Object.extends({taofaWins:0,taofaAward:!1,num:0,star:0,recoverTime:0,maxStar:7,monGroups:null,monsterId:0,teamWins:0,teamAward:!1,teamAwardNeedNum:0,taofaAccumulateNum:0,taofaCost:0,teamAwardCost:0,isWaitReset:!1,ctor:function(){this._super()},setupDailyData:function(e){if(e){this.taofaWins=e.taofaWins,this.taofaAward=e.taofaAward,this.teamWins=e.teamWins,this.teamAward=e.teamAward}this.teamAwardNeedNum=0|game.DailyMiscCfg.getData("teamAwardNeedNum").value,this.taofaAccumulateNum=0|game.DailyMiscCfg.getData("taofaAccumulateNum").value,this.taofaCost=0|game.DailyMiscCfg.getData("taofaCost").value,this.teamAwardCost=0|game.DailyMiscCfg.getData("teamAwardCost").value,this.resetMonster()},getQuickTaofaCost:function(){var e=0,t=this.taofaAccumulateNum-this.taofaWins;if(0<=t){e=t*this.taofaCost}return e},setTaoFaData:function(e){if(e){this.num=e.num,this.star=e.star,this.recoverTime=e.recoverTime+game.SysTime.curTime}},setMonster:function(e){var t=0<arguments.length&&void 0!==e?e:0;if(0!=t){this.monsterId=t}else if(this.resetMonster(),this.monGroups&&0<this.monGroups.length){this.monsterId=this.monGroups[0]}},removeMonster:function(e){if(this.monGroups&&0<this.monGroups.length){var t=this.monGroups.indexOf(e);if(-1<t){this._showModules.splice(t,1)}}},resetMonster:function(){var e=game.mainRoleData.mapId;if(e){var t=game.SceneCfg.getData(e);if(!t||t.type!=game.SceneType.NONE0&&t.type!=game.SceneType.NONE1){this.isWaitReset=!0}else{var a=game.DailyTaofaCfg.getData(e);if(a){this.monGroups=a.monGroups,this.isWaitReset=!1}}}else;},setAllStar:function(){this.star=this.maxStar}});game.taoFaData=game.taoFaData||new e}(),function(){var e;e=b8e.Object.extends({items:null,ctor:function(){this._super(),this.items=[]},setup:function(e,t,a){if(e){var i,n=1;if(t){var s=game.DailyTaofaStarCfg.getData(t);if(s){n=s.multiple}}for(var o=this.items.length=0,r=e.length;o<r;o++){i=e[o].Num*n|0;var g=game.ItemUtil.createPrizeInfo(e[o].Id,i,0,a);this.items.push(g)}}else;}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$TaoFaPrizeInfo",e)}(),function(){var e=game.View.extends({taofaMaxNum:0,taofaAccumulateNum:0,barWidth:517,ctor:function(){this._super(993),this.spotAlerts={TAO_FA_ALERT_AWARD:this.awardAlert,TAO_FA_KILL_ALERT:this.killAlert}},notify:function(e){switch(e){case this.Evts.UPDATE_TAOFAPAGE:this.updateView()}},killAlert:function(e){this.skin.kill_spot.node.active=e.alert},awardAlert:function(e){this.skin.award_spot.node.active=e.alert},init:function(){var e=this.skin,t=this.taoFaBg=b8e.Sprite.get();t.setAnchor(0,1),t.addToParent(e.bgnode),t.loadTexture(game.ResCfg.getUrl(16));var a=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid);a.itemRender=game.PrizeListItem,a.layout.paddingLeft=0,a.layout.paddingRight=0,a.layout.paddingTop=0,a.layout.spacingX=40,a.addToParent(e.prizeList),this.prizeInfo=new game.TaoFaPrizeInfo;var i=game.DailyMiscCfg.getData("taofaMaxNum");i&&(this.taofaMaxNum=+i.value),(i=game.DailyMiscCfg.getData("taofaAccumulateNum"))&&(this.taofaAccumulateNum=+i.value),this.barWidth=e.bar.width},onShow:function(){this.send(this.Evts.REQ_TAOFADATA)},onHide:function(){if(this.timer){this.timer.stop()}},updateView:function(){var e=this,t=e.skin,a=game.taoFaData;if(t.elitemonNum.string=game.Lang.get(1351,a.num,e.taofaMaxNum),t.progressTips.string=game.Lang.get(1355,e.taofaAccumulateNum),t.progress.string=a.taofaWins+"/"+e.taofaAccumulateNum,t.bar.node.width=e.barWidth*(a.taofaWins/e.taofaAccumulateNum),a.taofaWins==e.taofaAccumulateNum){if(a.taofaAward){t.onekeyBtn.active=!1,t.onekeyGray.node.active=!0}else t.title0.string=game.Lang.get(1354)}var i=game.DailyTaofaAwardCfg.gettotalItemsBylevel(game.mainRoleData.lv);e.prizeInfo.setup(i,null,game.IconSizeEnum.GRID_SIZE_105),e.list.setData(e.prizeInfo.items);var n=game.taoFaData.recoverTime-game.SysTime.curTime;if(t.timeTips.string=b8e.TimeUtil.formatTime(n),e.timer)e.timer.reset(),e.timer.start();else{this.timer=b8e.Timer.add(this,this.updateTimer,1e3)}e.skin.fightBtnGray.active=game.taoFaData.num<1,e.skin.fightBtn.active=0<game.taoFaData.num},updateTimer:function(){var e=game.taoFaData.recoverTime-game.SysTime.curTime;if(0<e){this.skin.timeTips.string=b8e.TimeUtil.formatTime(e)}else if(this.skin.timeTips.string=b8e.TimeUtil.formatTime(0),this.timer){this.timer.stop()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.TaoFaPage,e)}(),function(){var e=game.View.extends({taofaStarCost:0,_monModel:null,ctor:function(){this._super(994),this.spotAlerts={}},notify:function(e){switch(e){case this.Evts.UPDATA_STAR:case this.Evts.UPDATE_TAOFAPAGE:this.updateView(),this.updateStar()}},init:function(){var e=this;e._monModel=b8e.SceneEntity.get(),e._monModel.addToParent(e.skin.modelnode),e.taoFaBg=b8e.Sprite.get(),e.taoFaBg.setAnchor(.5,.5),e.taoFaBg.addToParent(e.skin.bgnode),e.taoFaBg.loadTexture(game.ResCfg.getUrl(17)),e.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.list.itemRender=game.PrizeListItem,e.list.layout.paddingLeft=0,e.list.layout.paddingRight=0,e.list.layout.paddingTop=0,e.list.layout.spacingX=15,e.list.addToParent(e.skin.prizeNode),e.taofaStarCost=game.DailyMiscCfg.getData("taofaStarCost").value},onShow:function(){game.CfgUtil.getMosterModelRes(game.taoFaData.monsterId,function(e){this.setAnim(game.ResCfg.getUrl(5e3,e))},this),this.updateStar(),this.updateView()},onHide:function(){var e=this._monModel.getAnimator(game.AnimType.BOSS,1);if(e){e.clear()}},setAnim:function(e){var t;if(e){if(!(t=this._monModel.getAnimator(game.AnimType.BOSS,1))){t=this._monModel.addAnimator(game.AnimType.BOSS,1)}t.load(e),t.play()}else if(t){t.clear()}},updateView:function(){var e=game.mainRoleData.mapId,t=game.SceneCfg.getData(e);if(t){this.skin.mapName.string=t.name}if(!this.prizeInfo){this.prizeInfo=new game.TaoFaPrizeInfo}var a=game.DailyTaofaAwardCfg.getItemsBylevel(game.mainRoleData.lv);this.prizeInfo.setup(a,game.taoFaData.star,game.IconSizeEnum.GRID_SIZE_84),this.list.setData(this.prizeInfo.items),this.skin.costTips.string=game.Lang.get(6583,this.taofaStarCost)},updateStar:function(){for(var e=0;e<7;++e){this.getComponent("starBg_"+e).node.active=e<game.taoFaData.star}},viewjianhaoBtn:function(){if(7<=game.taoFaData.star){game.notice.show(6584)}else game.alert.show({lang:1358,langArgs:this.taofaStarCost,okcb:this.onClickGameAlert,thisArg:this})},onClickGameAlert:function(){this.send(this.Evts.REQ_TAOFASTAR)},viewfightBtn:function(){this.send(this.Evts.REQ_TAOFA)}});b8e.module.registerView(game.ME.TaoFaView,e)}(),function(){var e;e=b8e.Enum({None:0,V_VIP_LEVEL_CHANGE:-1,V_VIP_EXP_CHANGE:-1,V2C_SELECT_CHANGE:-1,C2V_SELECT_CHANGE:-1,V_VIP_GET_PRIZE:-1,C_VIP_GET_PRIZE:-1,V_SHOW:-1,V2C_GET_SHINV:-1,C2C_SELECT_VIP_PAGE:-1,C2V_UPDATE_BTNS:-1,C_UPDATE_VIP_BUY:-1}),b8e.RC("$$game","$$VipEvts",e)}(),function(){var e=game.Control.extends({vipData:null,selectPage:!1,selectLv:0,lockTime:0,init:function(){var t=this,e=t;e.vipData=game.vipData,e.vipAlert=game.spotAlert.set(game.SAE.VIP_ALERT),t._autoOptions={lang:51906,okcb:function(e){t.sender.BuyVipWelfareReq(e)},thisArg:t}},ipc:function(){var e=this;e.evts={MainRole:{C_VIP_LEVEL_CHANGE:e.changeVipLevel,C_INIT_MAIN_ROLE:e.initVipLevel},Back:{C_UPDATE_AMOUNT:e.updateAmount},Recharge:{C_INIT_MODEL:e.vipBannerCheck,C_RECHARGE_SUCCESS:e.vipBannerCheck},VipActivity:{C_BUY_GOODS:e.vipActivityBuy}},e.handels={GetVipAwardResp:e.vipAwardResp,BuyVipWelfareResp:e.vipWelfareResp}},notify:function(e,t){switch(e){case this.Evts.V2C_SELECT_CHANGE:this.vipData.selectPage(t),this.send(this.Evts.C2V_SELECT_CHANGE)}},vipActivityBuy:function(e){var t=e.data;t&&this.sender.BuyVipWelfareReq(t.id,t.isWeek)},vipAwardResp:function(e){var t=e.readProtobuf(game.pb.VipAwardResponse);if((this.lockTime=0)<t.code){game.notice.noticeError(t.code)}else game.miscData.collectedVipLv.push(t.vipLv),this.vipBannerCheck(),this.checkAlert(),this.send(this.Evts.V_VIP_GET_PRIZE),9==t.vipLv&&(this.dptG(game.ActiveBarGEvts.REFRESH_BTNS),game.module.hide(game.ME.VipBanner))},vipWelfareResp:function(e){var t=e.readProtobuf(game.pb.BuyVipWelfareResponse);0<t.code?game.notice.noticeError(t.code):(t.isWeekly||game.welfareData.collectedVipLv.push(t.id),this.checkAlert(),this.dpt(this.Evts.C_UPDATE_VIP_BUY,t),this.vipData.checkAllAlert(),this.send(this.Evts.V_VIP_GET_PRIZE),9==t.vipLv&&(this.dptG(game.ActiveBarGEvts.REFRESH_BTNS),game.module.hide(game.ME.VipBanner)),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeConsume))},vipBannerCheck:function(){var e=this;if(0!=game.rechargeData.rechargeMoney)if(game.vipData.getCanShowBanner()){if(e.isFirst);else if(e.isFirst=!0,game.playBack.isInstanceFighting());else if(b8e.module.isShowView(game.ME.MainUIHeadMiddle));}else{game.module.hide(game.ME.VipMain)}else;},changeVipLevel:function(){this.send(this.Evts.V_VIP_LEVEL_CHANGE),game.module.show(game.ME.VipPromote),this.checkAlert()},initVipLevel:function(){this.checkAlert()},updateAmount:function(){this.vipData.checkAllAlert(),this.send(this.Evts.V_VIP_EXP_CHANGE),this.checkAlert()},getPrizeBtn:function(){if(!(this.lockTime>game.SysTime.curTime)){this.lockTime=game.SysTime.curTime+200;var e=game.VipForeverCfg.getDataByVip(this.vipData.selectLv,this.vipData.bannerSelect);this._autoOptions.langArgs=[e.price,this.vipData.selectLv],this._autoOptions.args=e.id,game.alert.showTwo(this._autoOptions)}},checkAlert:function(){this.vipAlert.alert=game.vipData.checkAlert()},getShinvBtn:function(){game.vipData.closeBanner=!0,game.module.hide(game.ME.VipMain),game.module.hide(game.ME.VipBanner),game.module.show(game.ME.VipBanner)},openShinvBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},closeBannerBtn:function(){game.vipData.closeBanner=!0,game.module.hide(game.ME.VipMain)},skillBtn1:function(){this.huWeiShow(1)},skillBtn2:function(){this.huWeiShow(2)},skillBtn3:function(){this.huWeiShow(3)},skillBtn4:function(){this.huWeiShow(4)},skillBtn5:function(){this.huWeiShow(5)},huWeiShow:function(){game.module.show(game.ME.GuardianSkillTips)},getAwardBtn:function(){}}),t=[game.ME.VipBanner,game.ME.VipMain],a=game.Sender.extends({ipc:function(){this.msg={GetVipAwardReq:this.getVipAwardReq,BuyVipWelfareReq:this.buyVipWelfareReq}},getVipAwardReq:function(e){var t=game.pb.VipAwardRequest;t.vipLv=e,b8e.net.getBytes().writeProtobuf(t)},buyVipWelfareReq:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=game.pb.BuyVipWelfareRequest;i.id=e,i.isWeekly=a,this.write(i)}});b8e.module.registerControl(game.ME.Vip,e,game.VipEvts,a,t)}(),function(){var e=game.Control.extends({btn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP),game.module.hide(game.ME.VipPromote)}});b8e.module.registerControl(game.ME.VipPromote,e,game.VipEvts)}(),function(){var e;e=b8e.Object.extends({str:"",setStr:function(e){this.str=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$VipPrivilegeInfo",e)}(),function(){var e;e=b8e.Object.extends({select:!1,alert:!1,setCfg:function(e){this.vipLv=e.vipLv,this.cfg=e,this.czCfg=game.VipForeverCfg.getDataByVip(this.vipLv,2),this.czCfg&&(this.rechargeId=this.czCfg.id),this.checkAlert()},checkAlert:function(){var e=this.vipLv<=game.mainRoleData.vipLevel,t=this.czCfg;if(t&&this.rechargeId){var a=t&&-1<game.welfareData.collectedVipLv.indexOf(this.rechargeId),i=t.price<=game.amount.get(game.AmountType.YUAN_BAO);this.alert=!a&&e&&i}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$VipInfo",e)}(),function(){var e=b8e.Object.extends({selectLv:0,bannerSelect:2,defaultIndex:0,ctor:function(){this._super(),this.vipMap=b8e.HashMap.get()},checkAlert:function(){var e=!1,t=game.mainRoleData.vipLevel,a=game.welfareData.collectedVipLv,i=game.VipCfg.getMaxLv();if(1<t)if(!a||a.length<=0)this.defaultIndex=1,e=!0;else for(var n=void 0,s=void 0,o=1;o<=i&&(n=game.VipForeverCfg.getDataByVip(o,2),s=game.VipForeverCfg.getDataByVip(o,3),!(n&&n.vipLv>t||s&&s.vipLv>t));o++){if(n&&-1==a.indexOf(n.id)&&n.price<=game.amount.get(game.AmountType.YUAN_BAO)){e=!0,this.defaultIndex=n.vipLv,this.bannerSelect=2;break}if(s&&-1==a.indexOf(s.id)&&s.price<=game.amount.get(game.AmountType.YUAN_BAO)){e=!0,this.defaultIndex=n.vipLv,this.bannerSelect=2;break}}return e},getCanShowBanner:function(){var e=this;if(0==game.rechargeData.rechargeMoney)return!1;if(!e.bannerVipLv){var t=game.VipMiscCfg.getData("vipBannerLv");t&&(e.bannerVipLv=0|t.value)}if(!e.endTime){var a=game.VipMiscCfg.getData("vipContinuedTime");a&&(e.vipContinuedTime=0|a.value,e.endTime=game.SysTime.curTime+e.vipContinuedTime)}return e.closeBanner||(e.closeBanner=game.mainRoleData.vipLevel>=e.bannerVipLv||game.SysTime.curTime>e.endTime),!e.closeBanner},getCanShowHomeBanner:function(){if(0==game.rechargeData.rechargeMoney)return!1;if(this.closeHomeBanner)return!1;if(!this.bannerVipLv){var e=game.VipMiscCfg.getData("vipBannerLv");e&&(this.bannerVipLv=0|e.value)}return!(game.mainRoleData.vipLevel>=this.bannerVipLv)},getPrivilegeList:function(e){this._privilegePool||(this._privilegePool=[]);var t=game.VipCfg.getData(e);if(t){for(var a=t.vipPrivilegeDes.split("|"),i=[],n=void 0,s=void 0,o=0,r=a.length;o<r;o++)(n=a[o])&&((s=this._privilegePool[o])||(s=new game.VipPrivilegeInfo,this._privilegePool[o]=s),s.setStr(n),i.push(s));return i}},getVipList:function(){var e=this.getMap().values();return e.sort(this._sort),e},_sort:function(e,t){return e.vipLv-t.vipLv},initVipMap:function(){var e=this.vipMap,t=game.VipCfg.getDatas();if(t&&!(t.length<1))for(var a=t.length,i=void 0,n=void 0,s=0;s<a;s++)0!=(i=t[s]).vipLv&&((n=new game.VipInfo).setCfg(i),e.set(n.vipLv,n))},checkAllAlert:function(){for(var e=this.getVipList(),t=e.length,a=0;a<t;a++)e[a].checkAlert()},getMap:function(){return this.vipMap.count()<1&&this.initVipMap(),this.vipMap},selectPage:function(e){var t=this.getMap(),a=t.get(this.selectLv);a&&(a.select=!1);var i=t.get(e);i&&(i.select=!0),this.selectLv=e}});game.vipData=game.vipData||new e}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1502),this.setSize(570,25)},setData:function(e){this.skin.des.string=e.str}}),b8e.RC("$$game","$$VipAwardItem",e)}(),function(){var e=game.View.extends({vipData:null,banner:null,prizeIconList:null,itemInfoList:null,progressWidth:0,ctor:function(){this._super(1098)},init:function(){var e=this;e.vipData=game.vipData,e.prizeIconList=[],e.itemInfoList=[],e.progressWidth=e.skin.progress.node.width,e.bannerList=[],e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.VipAwardItem,e._list.bindEnum=e.moduleEnum,e._list.layout.paddingTop=0,e._list.addToParent(e.skin.privilegeList);var t=e.btnList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.VipItem,t.bindEnum=e.moduleEnum,t.layout.paddingLeft=6,t.layout.paddingTop=5,t.layout.spacingY=3,t.addToParent(e.skin.btnList)},notify:function(e){var t=this;switch(e){case t.Evts.V_VIP_LEVEL_CHANGE:t.setVipProgress(),t.setGetPrizeImg();break;case t.Evts.V_VIP_EXP_CHANGE:t.setVipProgress();break;case t.Evts.C2V_SELECT_CHANGE:t.vipChange();break;case t.Evts.V_VIP_GET_PRIZE:t.setGetPrizeImg(),t.vipChange()}},onShow:function(){this.vipData.selectPage(game.mainRoleData.vipLevel),this.btnList.setData(this.vipData.getVipList()),this.vipChange(),this.setVipProgress()},onHide:function(){},setVipProgress:function(){var e=this.skin,t=game.mainRoleData.vipLevel;e.curVipLevel.string=t;var a=game.VipCfg.getData(t);if(a){var i=game.amount.get(game.AmountType.VIP_EXP),n=1;if(game.VipCfg.getMaxLv()<=t)e.progressLab.string=i+"/"+a.needNum,n=i/a.needNum,e.needRecharge.active=!1,e.words.loadTexture(game.ResCfg.getUrl(10197));else{var s=game.VipCfg.getData(t+1);if(!s)return;e.words.loadTexture(game.ResCfg.getImgUrl(s.banner)),e.progressLab.string=i+"/"+s.needNum,n=i/s.needNum;var o=s.needNum-i;e.needRecharge.active=!0,e.needRecharge.string=game.Lang.get("Z"+o+"YJV"+s.vipLv)}n=1<n?1:n,e.progress.node.width=this.progressWidth*n}},vipChange:function(){var e=this,t=e.skin,a=e.vipData.selectLv<1?1:e.vipData.selectLv;if(t.vipTitleLv.string="V"+a+"T",e.setGetPrizeImg(),game.VipCfg.getData(a)){e.updataPrivilege(a);var i=void 0,n=void 0;if(e.prizeIconList&&0<e.prizeIconList.length)for(n=e.prizeIconList.length,i=0;i<n;i++)e.prizeIconList[i].setVisible(!1);var s=game.VipForeverCfg.getDataByVip(a,e.vipData.bannerSelect);if(s&&(t.costNum1.string=game.CCommonUtil.replaceNum(s.originPrice,2),t.costNum2.string=game.CCommonUtil.replaceNum(s.price,2),0<s.award.length)){var o,r=void 0;for(o=110*((n=s.award.length)-1)/2,i=0;i<n;i++){var g=s.award[i];if(e.itemInfoList[i]=game.ItemUtil.createBaseItemInfo(g.Id,g.Num,e.itemInfoList[i],!0),!e.prizeIconList[i]){var l=game.GridUtil.createItemIcon();l.addToParent(t.icon),e.prizeIconList[i]=l}e.prizeIconList[i].setVisible(!0),game.GridUtil.setItemIcon(e.prizeIconList[i],e.itemInfoList[i]),r=e.prizeIconList[i].iconSize*i+10*i-o,e.prizeIconList[i].setPosition(r+15,0)}}}},updataPrivilege:function(e){var t=this.vipData.getPrivilegeList(e);this._list.setData(t)},setGetPrizeImg:function(){var e=this.vipData.selectLv,t=game.welfareData.collectedVipLv,a=game.VipForeverCfg.getDataByVip(e,2),i=game.VipForeverCfg.getDataByVip(e,3),n=e<=game.mainRoleData.vipLevel,s=2==this.vipData.bannerSelect?!!a&&-1<t.indexOf(a.id):!!i&&-1<t.indexOf(i.id);this.skin.getImg.node.active=s,this.skin.getPrizeBtn.node.active=!s&&n,this.skin.costNode.active=!s&&n,this.skin.getPrizeBtnGray.node.active=!n,this.skin.getPrizeGrayLbl.string=game.Lang.get(51898,e)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.Vip,e)}(),function(){var e=game.View.extends({vip:9,_showModel:!0,ctor:function(){this._super(1096)},init:function(){var e=this;e.prizeIconList=[],e.itemInfoList=[];var t=game.ResCfg.getImgUrl("vip/openShiNvBg"),a=b8e.Sprite.get();a.setAnchor(0,1),a.loadTexture(t),a.addToParent(e.skin.bg),e.awardsList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.awardsList.bindEnum=e.moduleEnum,e.awardsList.addToParent(e.skin.prizeNode),e.awardsList.itemRender=game.PrizeListItem,e.awardsList.layout.paddingLeft=0,e.awardsList.layout.paddingTop=0,e.awardsList.layout.spacingX=22,e.awardsList.layout.spacingY=0,e.setPrizeList()},onShow:function(){this.updateBtns()},updateBtns:function(){var e=this.skin;9<=game.mainRoleData.vipLevel?(e.openShinvBtn.active=!1,e.getAwardBtn.active=!0):(e.openShinvBtn.active=!0,e.getAwardBtn.active=!1)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_BTNS:this.updateBtns()}},setPrizeList:function(){this.skin;var e=game.VipCfg.getData(this.vip);if(e){var t=game.CfgUtil.getPrizeListInfo(e.vipAward);t&&this.awardsList.setData(t.items)}else;}});b8e.module.registerView(game.ME.VipBanner,e)}(),function(){var e=game.View.extends({vip:10,_specialLayer:!0,ctor:function(){this._super(1097),this.setLocalZOrder(game.GameViewMgr.MainHeadViewIndex)},init:function(){},onShow:function(){},onStageResize:function(){b8e.stageWidth;var e=b8e.stageHeight;this.setPosition(165,e-125)}});b8e.module.registerView(game.ME.VipMain,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!0,ctor:function(){this._super(game.UIUrl.get(1277))},init:function(){this.prizeIconList=[],this.itemInfoList=[]},onShow:function(){this.updateView(),this.setPrizeList(),game.TweenUtil.rotationEffect(this.skin.light)},updateView:function(){var e=this.skin,t=game.mainRoleData.vipLevel,a=game.VipCfg.getData(t);e.vipLv_1.string=t-1,e.vipLv_2.string=t,e.vipTitleLv.string="V"+t+"T",e.vipDes.string=a.vipPromoteDes;var i=e.vipDes.height;e.dian.height=i,e.bottomNode.y=-738-i,e.gray.setSize(b8e.stageWidth+100,490+i),this.offsetY=.5*(i-120),this.onStageResize()},setPrizeList:function(){var e=game.VipForeverCfg.getDataByVip(game.mainRoleData.vipLevel,2);if(e&&!(e.award.length<1))for(var t=e.award,a=game.IconSizeEnum.GRID_SIZE_105,i=t.length,n=116*(i-1)/2,s=this.prizeIconList,o=this.itemInfoList,r=this.skin.iconNode,g=void 0,l=void 0,c=0;c<i;c++)g=t[c],l=game.ItemUtil.createBaseItemInfo(g.Id,g.Num,o[c],!0),s[c]||(s[c]=game.GridUtil.createItemIcon(a),s[c].addToParent(r)),game.GridUtil.setItemIcon(s[c],l),s[c].setPosition((a+16)*c-n,0)},onHide:function(){b8e.Tween.kill(this.skin.light)}});b8e.module.registerView(game.ME.VipPromote,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1587),this.setSize(144,69)},setData:function(e){var t=this.skin,a=e.cfg;t.vip.string="V"+e.vipLv,t.giftName.string=a.giftName,t.redPoint.active=e.alert,t.yellowBtn.active=e.select},onClick:function(){var e=this.data.vipLv;game.vipData.selectLv!=e&&this.send(game.VipEvts.V2C_SELECT_CHANGE,e)}}),b8e.RC("$$game","$$VipItem",e)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_CHANGE:-1,V_SELECT_BTN:-1,C_INIT_MODEL:-1,V_SHOW_VIEW:-1,V_HIDE_VIEW:-1,C2V_REFRESH_BTN:-1,V2C_SHOW_ANNOUNCEMENT:-1,C2C_SHOW_ANNOUNCEMENT:-1,C2C_REFRESH_REBATE_BTN:-1,SYNC_MONEYTREE:-1,C2V_SCROLL_BTNS:-1}),b8e.RC("$$game","$$WelfareEvts",e)}(),function(){var e=game.Control.extends({lastId:-1,lastModuleEnum:-1,mainEntrance:!0,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.WELFARE_ALERT,game.SAE.HOME),this.sender.WelfareModelReq()},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily},LevelPrize:{C2C_GET_ALL_PRIZE:this.refreshBtn},MillionsLogin:{C2C_GETALLPRIZE:this.refreshBtn}},this.handels={WelfareModelResp:this.welfareModelResp,ShareAwardMsg:this.shareAwardMsg,RebateResp:this.rebateResp}},notify:function(e,t){switch(e){case this.Evts.V_SELECT_BTN:this.selectBtn(t);break;case this.Evts.V_SHOW_VIEW:this.showView();break;case this.Evts.V_HIDE_VIEW:this.hideView();break;case this.Evts.V2C_SHOW_ANNOUNCEMENT:this.dpt(this.Evts.C2C_SHOW_ANNOUNCEMENT)}},refreshBtn:function(){if(this.send(this.Evts.C2V_REFRESH_BTN),game.welfareData.curIndex==game.WelfareType.LEVEL_PRIZE){this.selectFirstBtn()}},resetDaily:function(){game.walfCheckinData.isTodaySign=!1,this.sender.WelfareModelReq()},shareAwardMsg:function(){game.alert.showLang(5301)},welfareModelResp:function(e){var t=e.readProtobuf(game.pb.Welfare);game.welfareData.setData(t),game.levelPrizeData.setupLevelAwards(t),game.signInData.setupSignInAwards(t),game.shareData.setShareData(t),game.verifyAwardData.setWanModelData(t),game.walfCheckinData.setWalfData(t),game.millionsLoginData.syncData(t),game.rankData.setWelfData(t),game.welfareTargetData.setWelfData(t),this.dpt(this.Evts.C_INIT_MODEL,t)},rebateResp:function(e){var t=e.readProtobuf(game.pb.RebateAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.welfareData.rebateAward=!0,game.module.hide(game.ME.RebateAward),this.dpt(this.Evts.C2C_REFRESH_REBATE_BTN))},showView:function(){if(this.mainEntrance)this.selectFirstBtn();else{this.mainEntrance=!0}},hideView:function(){var e=this;if(0<e.lastModuleEnum){game.module.hide(e.lastModuleEnum)}game.welfareData.selectPage(0,this.lastId),e.lastId=-1,e.lastModuleEnum=-1},selectFirstBtn:function(){var e=game.welfareData.getBtns();if(!e||e.length<1){game.module.hide(this.moduleEnum)}else this.selectBtn(e[0].id)},selectBtn:function(e){var t=this,a=game.WelfareBtnCfg.getData(e);if(a){var i=game.miscData.openServerDay,n=!0;switch(e){case game.WelfareType.WEEK_CARD:n=t.checkCardOpen(game.CardType.WEEK,i);break;case game.WelfareType.MONTH_CARD:n=t.checkCardOpen(game.CardType.MONTH,i);break;case game.WelfareType.FOREVER_CARD:n=t.checkCardOpen(game.CardType.FOREVER,i)}if(n)if(t.lastModuleEnum!=a.moduleEnum){if(-1<t.lastModuleEnum){game.module.hide(this.lastModuleEnum)}game.module.showTab(a.moduleEnum,t.moduleEnum);var s=a.id;game.welfareData.selectPage(s,t.lastId),t.send(t.Evts.V_SELECT_BTN),t.lastId=a.id,t.lastModuleEnum=a.moduleEnum}else;else{if(0<this.lastId){this.selectBtn(this.lastId)}else this.selectFirstBtn()}}else;},checkCardOpen:function(e,t){var a=game.rechargeData.getCardRechargeCfg(e);if(!a){return!1}var i=t>=a.serverDays;if(!i){game.notice.show(9339,a.serverDays)}return i},selectToggle:function(e){if(game.WelfareBtnCfg.getData(e)){var t=game.welfareData.getBtns();if(!t||t.length<1){game.module.hide(this.moduleEnum)}else this.mainEntrance=!1,this.selectBtn(e),this.send(this.Evts.C2V_SCROLL_BTNS)}else;},rebateAwardGetBtn:function(){this.sender.RebateReq()}}),t=[game.ME.Announcement,game.ME.RebateAward,game.ME.VipBossWelfare],a=game.Sender.extends({ipc:function(){this.msg={WelfareModelReq:null,RebateReq:null}}});b8e.module.registerControl(game.ME.Welfare,e,game.WelfareEvts,a,t)}(),function(){var e=game.View.extends({ctor:function(){this._super(1107)},init:function(){var t=this,e="",a=t.skin,i=game.LoginConfig.announcementContents;if(i){t._contents=[],i.forEach(function(e){if(2==e.type){t._contents.push(e.content)}},t),e=t._contents.join("<br/>")}t.skin.lab_content.setFontSize(22),t.skin.lab_content.lineHeight=24,t.skin.lab_content.setSize(t.skin.lab_content.width,t.skin.lab_content.height),e=(e=e.replace(/\\r/g,"")).replace(/\\n/g,"<br/>"),a.lab_content.string=e,a.content.height=a.lab_content.height},onShow:function(){this.send(game.WelfareEvts.V2C_SHOW_ANNOUNCEMENT)},onHide:function(){},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.Announcement,e)}(),function(){var e;e=b8e.Enum({NONE:0,DAILY_LOGIN_AWARD:1,VIP_AWARD:2,RECHARGE_AWARD:3,TOTAL_LOGIN_AWARD:4}),b8e.RC("$$game","$$SignAwardType",e)}(),function(){var e;e=b8e.Object.extends({select:!1,alert:!1,id:0,sortId:0,cfg:null,setData:function(e){this.id=e.id,this.sortId=e.sortId,this.cfg=e,this.bindAlert(this.id)},bindAlert:function(e){if(this._bindAlert);else{var t,a=game.WelfareType;switch(e){case a.MONTH_CARD:t=game.SAE.MONTH_CARD_ALERT;break;case a.WEEK_CARD:t=game.SAE.WEEK_CARD_ALERT;break;case a.LEVEL_PRIZE:t=game.SAE.LEVEL_PRIZE;break;case a.SIGNIN_PRIZE:t=game.SAE.SIGNIN_PRIZE;break;case a.ACTIVATION_CODE:t=game.SAE.ACTIVATION_CODE;break;case a.MONEY_TREE:t=game.SAE.MONEY_TREE;break;case a.YONGZHE_WELFARE:t=game.SAE.YONGZHE_WELFARE;break;case a.DAILY_SINGIN:t=game.SAE.DAILY_SIGN;break;case a.MILLIONS_LOGIN:t=game.SAE.MILLIONS_LOGIN;break;case a.VIP_WELFARE:t=game.SAE.VIP_ACTIVITY}if(t){game.spotAlert.setCb(t,this.updateAlert,this),this._bindAlert=!0}}},updateAlert:function(e){this.alert=e.alert}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$WelfareBtnInfo",e)}(),function(){var e=b8e.Object.extends({signLoginDay:0,signAwards:null,verifyAwards:null,silverExchangeNum:0,rebateAmount:0,rebateAward:!1,collectedVipLv:0,ctor:function(){this._super(),this.fundInfoList=[],this.welfareBtns=[],this.welfareBtnsMap=b8e.HashMap.get(),this.verifyAwards=[],this.collectedVipLv=[]},setData:function(e){var t=this;if(t.signLoginDay=e.signLoginDay,t.signAwards=e.signAwards,t.silverExchangeNum=e.silverExchangeNum,t.verifyAwards=e.verifyAwards,this.initFundList(),this.initBtns(),e.vipForever)for(var a=void 0,i=0,n=e.vipForever.length;i<n;i++)(a=e.vipForever[i])&&t.collectedVipLv.push(a.id);this.setRebateAward(e)},initFundList:function(){},buyFundSuccess:function(){},setGetFundAward:function(){},refreshLv:function(){},getFundAwardIsGet:function(){},getFundInfoList:function(){},onSort:function(){},initBtns:function(){this.welfareBtnsMap.clear();var e,t,a=game.WelfareBtnCfg.getDatas();if(!a||a.length<1)return null;for(var i=a.length,n=0;n<i;n++)e=a[n],(t=new game.WelfareBtnInfo).setData(e),this.welfareBtnsMap.set(t.id,t)},getBtns:function(){if(this.welfareBtns.length=0,!this.welfareBtnsMap){return this.welfareBtns}for(var e,t=this.welfareBtnsMap.values(),a=t.length,i=0;i<a;i++){if(e=t[i],this.isShowActive(e.cfg)){this.welfareBtns.push(e)}}return this.welfareBtns.sort(this.sortBtn),this.welfareBtns},sortBtn:function(e,t){return e.sortId-t.sortId},isShowActive:function(e){if(!e)return!1;var t=game.miscData.openServerDay;if(e.hideOpenDay&&t>e.hideOpenDay)return!1;var a=e.id;if(!this.checkIsOpen(a))return!1;var i=game.WelfareType;switch(a){case i.SIGNIN_PRIZE:case i.ANNOUNCEMENT:case i.MONEY_TREE:case i.FEEDBACK:case i.DAILY_SINGIN:case i.MILLIONS_LOGIN:case i.FOREVER_CARD:case i.MONTH_CARD:case i.WEEK_CARD:case i.ACTIVATION_CODE:case i.VIP_BOSS:case i.VIP_WELFARE:return!0;case i.LEVEL_PRIZE:return!game.levelPrizeData.isGetAllPrize();case i.YONGZHE_WELFARE:return game.yongzheData.isOpen();case i.PRIVILEGE_SHOP:return!0;default:return!1}},selectPage:function(e,t){if(this.welfareBtns&&!(this.welfareBtns.length<1)){for(var a,i=this.welfareBtns.length,n=0;n<i;n++)(a=this.welfareBtns[n]).id==e&&(a.select=!0),a.id==t&&(a.select=!1);this.curIndex=e}},setVerifyAward:function(e){this.verifyAwards.push(e)},getOpenIdByType:function(e){var t=game.WelfareBtnCfg.getData(e);return t?t.moduleEnum:1},checkIsOpen:function(e){var t=this.getOpenIdByType(e);return 0==t||!!game.moduleOpen.checkOpen(t)},getFundIsShow:function(){return this.isHasFund},verifyIsGetByType:function(e){return-1<this.verifyAwards.indexOf(e)},getFundCountdown:function(){return this.isOpen?0:this.endTime-game.SysTime.curTime},getIsShowRebateAward:function(){return 0<this.rebateAmount&&!this.rebateAward},setRebateAward:function(e){e&&(this.rebateAmount=e.rebateAmount,this.rebateAward=e.rebateAward)}});game.welfareData=game.welfareData||new e}(),function(){var e;e=b8e.Enum({NONE:0,MONTH_CARD:1,WEEK_CARD:2,LEVEL_PRIZE:3,SIGNIN_PRIZE:4,ACTIVATION_CODE:5,ANNOUNCEMENT:6,YONGZHE_WELFARE:7,MONEY_TREE:8,FOREVER_CARD:9,FEEDBACK:10,DAILY_SINGIN:11,MILLIONS_LOGIN:12,VIP_BOSS:13,VIP_WELFARE:14,PRIVILEGE_SHOP:15}),b8e.RC("$$game","$$WelfareType",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1099),this.setSize(110,106)},init:function(){var e=this.btn=b8e.Sprite.get();e.addToParent(this.skin.btn),e.setAnchor(.5,.5)},setData:function(){var e=this,t=e.data;e.skin.btnSelect.active=t.select;var a,i=game.WelfareBtnCfg.getData(t.id);if(i)if(i.titleBg)a=game.ResCfg.getImgUrl(i.titleBg),e.btn.loadTexture(a),this.skin.alert.node.active=t.alert;else{b8e.error("\u798f\u5229\u6309\u94ae\u914d\u7f6e\u6ca1\u6709\u5bf9\u5e94\u7684\u6807\u9898\u6309\u94ae\u5e95\u56fe,id:",i.id,"\u798f\u5229\u6309\u94ae:",i.desc)}},clickBtn:function(){this.send(game.WelfareEvts.V_SELECT_BTN,this.data.id)}}),b8e.RC("$$game","$$WelfareBtnItem",e)}(),function(){var e=game.View.extends({last:0,now:0,ctor:function(){this._super(1100)},init:function(){var e=this,t=e.welfareBtns=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.WelfareBtnItem,t.addToParent(e.skin.scrollView),t.bindEnum=game.ME.Welfare,t.layout.spacingX=5},notify:function(e){switch(e){case this.Evts.C2V_REFRESH_BTN:this.btns=game.welfareData.getBtns(),this.welfareBtns.setData(this.btns);break;case this.Evts.C2V_SCROLL_BTNS:this.scrollBtnsList()}},onShow:function(){this.btns=game.welfareData.getBtns(),this.welfareBtns.setData(this.btns),this.send(this.Evts.V_SHOW_VIEW)},scrollBtnsList:function(){var e=game.welfareData.getBtns();if(e&&!(e.length<1)){for(var t=0,a=0;a<e.length;a++)if(e[a].select){t=a;break}this.welfareBtns.scrollToRight(10+115*t)}},onHide:function(){this.send(this.Evts.V_HIDE_VIEW),this.welfareBtns.scrollToLeft(0)},viewLeftBtn:function(){this.welfareBtns.scrollContainerLeft()},viewRightBtn:function(){this.welfareBtns.scrollContainerRight()},$$getWelfareBtn:function(e){if(!this.welfareBtns||!this.btns||this.btns.length<=e)return null;var t=this.btns[e];if(!t)return null;var a=this.welfareBtns.getItemRender(t);return a&&a.skin?a.skin.clickBtn:null},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.Welfare,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1108)},init:function(){var e=this.grid=game.GridUtil.createPrizeIcon();e.addToParent(this.skin.prizeIcon);var t=game.WelfareMiscCfg.getData("twRebateAward");if(t&&t.value){var a=t.value.split(",");a&&1<a.length&&(this._prizeInfo=game.ItemUtil.createBaseItemInfo(a[0],a[1],this._prizeInfo),game.GridUtil.setPrizeIcon(e,this._prizeInfo))}},onShow:function(){},onHide:function(){},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width)-10,t=.5*(b8e.stageHeight+300)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.RebateAward,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_VIEW:-1,C2V_RESET_DAILY:-1,C2V_UPDATE_COST:-1,V2C_END_AINM:-1}),b8e.RC("$$game","$$MoneyTreeEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.MONEY_TREE,game.SAE.WELFARE_ALERT),this.data=game.moneyTreeData,this.isShaking=!1},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily,C_VIP_LEVEL_CHANGE:this.updateVipLv,C_LEVEL_UP:this.updateLv},Welfare:{C_INIT_MODEL:this.onSysData},Back:{C_BACK_UPDATE_ITEMINFO:this.updateCost}},this.handels={MoneyTreeAwardResp:this.onMoneyTreeRespon}},notify:function(e){switch(e){case this.Evts.V2C_END_AINM:this.isShaking=!1}},onSysData:function(e){if(e&&e.data){var t=e.data,a=this.data;a.onSysData(t);var i=a.getRemainTime();0<i&&(this.key=b8e.setTimeout(this.updateTime,this,i)),this.checkAlert()}},updateTime:function(){this.clearTime(),this.spotAlert.alert=!0},clearTime:function(){this.key&&(b8e.clearTimeout(this.key),this.key=null)},btnOne:function(){this.shakeReq(!1)},btnFive:function(){this.shakeReq(!0)},shakeReq:function(e){var t=this.data;if(!this.isShaking){if(t.isFree()&&!e)return this.sender.MoneyTreeAwardReq(1,e),void(this.isShaking=!0);if(e?t.enoughCount5:t.enoughCount1){var a=e?5:1,i=t.getItemId(),n=game.itemData.getNumById(i);if(0<n)return a-1<n?(this.sender.MoneyTreeAwardReq(2,e),void(this.isShaking=!0)):void game.notice.show(52247);var s=t.getNeedGold(a);game.amount.get(game.AmountType.YUAN_BAO)<s?game.notice.show(3652):(this.sender.MoneyTreeAwardReq(3,e),this.isShaking=!0)}else game.notice.show(3651)}},resetDaily:function(){this.data.resetDaily(),this.checkAlert(),this.send(this.Evts.C2V_RESET_DAILY)},onMoneyTreeRespon:function(e){var t=e.readProtobuf(game.pb.MoneyTreeAwardResponse);if(0<t.code)return game.notice.noticeError(t.code),void(this.isShaking=!1);var a=this.data;if(a.onMoneyTreeRespon(t),1==t.types){a.setNextFreeTime();var i=a.getRemainTime();0<i&&(this.clearTime(),this.key=b8e.setTimeout(this.updateTime,this,i))}t.crit&&game.notice.show(52241),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeConsume)},checkAlert:function(){var e=this.spotAlert,t=this.data;if(t.isFree())e.alert=!0;else if(t.enoughCount1){var a=t.getItemId(),i=game.itemData.getNumById(a);e.alert=0<i}else e.alert=!1},updateCost:function(){this.checkAlert(),this.send(this.Evts.C2V_UPDATE_COST)},updateVipLv:function(){this.data.updateCountEnough(),this.send(this.Evts.C2V_UPDATE_VIEW)},updateLv:function(){this.send(this.Evts.C2V_UPDATE_VIEW)}}),t=game.Sender.extends({ipc:function(){this.msg={MoneyTreeAwardReq:this.moneyTreeAwardReq}},moneyTreeAwardReq:function(e,t){var a=game.pb.MoneyTreeAwardRequest;a.types=e,a.multiple=t,this.write(a)}});b8e.module.registerControl(game.ME.MoneyTree,e,game.MoneyTreeEvts,t)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.todayNum=0,this.treeGoldNum=0,this.treeRefreshTime=0,this.enoughCount1=!0,this.enoughCount5=!0},onSysData:function(e){this.todayNum=e.treeDailyNum,this.treeGoldNum=e.treeGoldNum,this.treeRefreshTime=e.treeRefreshTime,this.updateCountEnough()},onMoneyTreeRespon:function(e){if(1!=e.types){var t=e.multiple?5:1;3==e.types&&(this.treeGoldNum+=t),this.todayNum+=t,this.updateCountEnough()}},updateCountEnough:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getTreeNum(e),a=this.todayNum+1<=t;this.enoughCount1=a,a=this.todayNum+5<=t,this.enoughCount5=a},getNeedGold:function(e){for(var t=this.getMaxGoldNum(),a=e+1,i=this.treeGoldNum,n=void 0,s=void 0,o=0,r=1;r<a;r++)n=t<(n=i+r)?t:n,(s=game.TODGoldCostCfg.getData(n))&&(o+=s.gold);return o},getItemId:function(){if(!this.itemId){var e=game.WelfareMiscCfg.getData("todItemId");e&&(this.itemId=0|e.value)}return this.itemId},getMaxGoldNum:function(){if(!this.maxGoldNum){var e=game.WelfareMiscCfg.getData("todMaxGoldNum");e&&(this.maxGoldNum=0|e.value)}return this.maxGoldNum},getFreeTime:function(){if(!this.freeTime){var e=game.WelfareMiscCfg.getData("todInterval");e&&(this.freeTime=0|e.value)}return this.freeTime},setNextFreeTime:function(){var e=this.getFreeTime();this.treeRefreshTime=game.SysTime.curTime+e*b8e.TimeUtil.MINUTE_MICRO_SECONDS},isFree:function(){return game.SysTime.curTime>this.treeRefreshTime},getRemainTime:function(){return this.treeRefreshTime-game.SysTime.curTime},resetDaily:function(){this.todayNum=0,this.treeGoldNum=0,this.enoughCount1=!0,this.enoughCount5=!0},getCurLvSliver:function(){var e=game.mainRoleData.lv,t=game.TODSilverCfg.getDatas();if(!t||t.length<1)return 0;for(var a=t.length,i=void 0,n=0,s=0;s<a;s++)if((i=t[s]).low<=e&&e<=i.high)return n=i.silver/1e4,this.isFree()&&(n*=.5),Math.floor(n);return 0}});game.moneyTreeData=game.moneyTreeData||new e}(),function(){var e=game.View.extends({ctor:function(){this._super(735)},init:function(){var e=this,t=e.skin;e.data=game.moneyTreeData;var a=game.ResCfg;t.treeBg.loadTexture(a.getUrl(35));var i=game.AnimType,n=b8e.Animator,s=e.moneyAnim=n.get(i.UI_EFFECT,1);s.addToParent(t.anim1),s.addFinishCallback(e.animaCB,e);var o=e.lightAnim=n.get(i.UI_EFFECT,1);o.addToParent(t.anim2),o.setScale(1,1),o.load(a.getUrl(5019,2005));var r=game.IconSizeEnum.GRID_SIZE_42;e.costIcon1=game.GridUtil.createViewClickIcon(r),e.costIcon1.addToParent(t.icon1),e.costIcon5=game.GridUtil.createViewClickIcon(r),e.costIcon5.addToParent(t.icon5)},notify:function(e){var t=this;switch(e){case t.Evts.C2V_UPDATE_VIEW:t.updateView(),t.createTimer(),t.updateCost(),t.playMoneyAnim();break;case t.Evts.C2V_RESET_DAILY:t.updateView(),t.updateCost();break;case t.Evts.C2V_UPDATE_COST:t.updateCost()}},onShow:function(){this.updateView(),this.createTimer(),this.updateCost(),this.lightAnim&&this.lightAnim.play()},animaCB:function(){this.moneyAnim.clear(),this.send(this.Evts.V2C_END_AINM)},playMoneyAnim:function(){var e=game.ResCfg.getUrl(5019,2004);this.moneyAnim.load(e),this.moneyAnim.play()},updateView:function(){var e=this.skin,t=void 0,a=this.data.todayNum,i=game.mainRoleData.vipLevel,n=game.VipCfg.getTreeNum(i),s=game.VipCfg.getTreeNum(i+1),o=0;t=s?(o=s-n,game.Lang.get(3655,i+1,o)):"",e.count.string=game.Lang.get(52238,n-a),e.vipDesc.string=t,e.vipDesc.active=0<o,e.willGet.string=this.data.getCurLvSliver()},createTimer:function(){this.updateTime(),this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.updateTime,1e3)},updateTime:function(){var e=this.data.getRemainTime();if(e<0)return this.skin.willGet.string=this.data.getCurLvSliver(),this.updateCost(),void this.clearTimer();this.skin.timeLab.string=game.TimeUtil.formatTimeSpace(e,3)},updateCost:function(){var e=this.skin,t=this.data,a=e.red1,i=e.red5,n=t.isFree();if(e.costNode.active=!n,e.free.active=n,e.btnOne.x=n?328:154,e.free.x=n?328:154,n)return a.active=!0,void(i.active=!1);var s=e.costLab1,o=e.costLab5,r=t.getItemId(),g=game.itemData.getNumById(r);if(0<g)return this.costIcon1.setItemId(r),this.costIcon5.setItemId(r),a.active=0<g&&t.enoughCount1,i.active=4<g&&t.enoughCount5,s.string=g+"/1",void(o.string=g+"/5");a.active=!1,i.active=!1,this.costIcon1.setItemId(21),this.costIcon5.setItemId(21),s.string=t.getNeedGold(1),o.string=t.getNeedGold(5)},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},onHide:function(){this.clearTimer(),this.lightAnim&&this.lightAnim.stop()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.MoneyTree,e)}(),function(){var e;e=b8e.Enum({None:0,C2C_GET_AWARDS:-1,C2V_UPDATE_LIST:-1,REFRESHBTN_HOME:-1,C2V_RIGHT_BTN:-1,C2V_LEFT_BTN:-1,C2V_BOTTOM_BTN:-1,C2V_TOP_BTN:-1,C2V_RESET_DAILY:-1,C_UPDATE_AWARD_VIEW:-1}),b8e.RC("$$game","$$OnlineGiftEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){var e=this;e.nextEndTime=0,e.group=0,e.nextTime=0,e.onlineMap=b8e.HashMap.get(),e.onlineArr=[],e.gotAward=[],e.cfgObg={},e.activeTime=0,e.loginTime=0,e.showAward=null},createData:function(){this.gotAward.length=0;var e=this.onlineMap,t=this.onlineArr;e.clear(),t.length=0;var a=game.miscData.openServerDay;this.cfgObg.serverStart=a;var i=game.OnlineCfg.getData(this.cfgObg,!0);if(i&&!(i.length<1)){this.group=i[0].group,this.endDay=i[0].serverEnd;for(var n=i.length,s=void 0,o=0;o<n;o++)(s=new game.GiftItemInfo).setData(i[o]),e.set(s.time,s),t.push(s);i.sort(this.sortFunc),this.cfgList=i}},resetDaily:function(){this.gotAward.length=0,this.activeTime=0,this.loginTime=game.SysTime.curTime,this.cfgList=null},setData:function(e){this.activeTime=e.dailyOnlineTime,this.loginTime=e.loginTime},synData:function(e){this.gotAward=e.onlineAwards,this.updateIsGet()},updateIsGet:function(){for(var e=this.onlineArr,t=e.length,a=0;a<t;a++)e[a].updateIsGet()},isGetAll:function(){return this.gotAward.length>=this.onlineArr.length},setNextTime:function(){this.nextTime=0;var e=this.cfgList;if(e&&!(e.length<1))for(var t=e.length,a=void 0,i=0,n=void 0,s=0;s<t;s++)if(i=e[s].onlineTime,a=this.isGotAward(i),n=this.onlineMap.get(i),!a&&n&&!n.canGet){this.nextTime=i;break}},sortFunc:function(e,t){return e.onlineTime-t.onlineTime},setCanGet:function(e){var t=this.onlineMap.get(e);t&&t.setCanGet()},onlineAwardResp:function(e){this.gotAward.push(e);var t=this.onlineMap.get(e);t&&t.updateIsGet(),this.updateList()},updateList:function(){for(var e=this.onlineArr,t=e.length,a=0;a<t;a++)e[a].updateIdx++},getOnlineList:function(){var e=this.onlineArr;return e.sort(this.onSort),e},onSort:function(e,t){return!e.isHadGet&&t.isHadGet?-1:e.isHadGet&&!t.isHadGet?1:e.canGet&&!t.canGet?-1:!e.canGet&&t.canGet?1:e.onlineTime-t.onlineTime},isGotAward:function(e){return!!this.gotAward&&-1<this.gotAward.indexOf(e)},iconIsShow:function(){if(!game.moduleOpen.checkOpen(game.ME.OnlineGift))return!1;if(this._onlineGiftOpenLv||(this._onlineGiftOpenLv=+game.CfgUtil.getMiscValue(game.WelfareMiscCfg,"onlineGiftOpenLv")),this._onlineGiftOpenLv>game.mainRoleData.lv)return!1;var e=game.miscData.openServerDay;this.cfgObg.serverStart=e;var t=game.OnlineCfg.getData(this.cfgObg,!0);if(!t||t.length<1)return!1;var a=e<t[0].serverEnd,i=this.isGetAll();return a&&!i},getEndRemainTime:function(){var e=this.endDay,t=game.miscData.openServerDay,a=game.SysTime.curTime;return b8e.TimeUtil.getNextDateTime(a,e-t)-a},setNextEndTime:function(e){this.nextEndTime=e+game.SysTime.curTime},getRemainTime:function(){return this.nextEndTime-game.SysTime.curTime},reconnect:function(){for(var e=this.onlineArr,t=e.length,a=0;a<t;a++)e[a].reconnect()},getCanGetAwardInfo:function(){for(var e=void 0,t=this.onlineArr.length,a=0;a<t;a++)if((e=this.onlineArr[a]).canGet)return e;return null},getNotGetAwardInfo:function(){for(var e=void 0,t=this.onlineArr.length,a=0;a<t;a++)if(!(e=this.onlineArr[a]).isHadGet&&!e.canGet)return e;return null}});game.onlineGiftData=game.onlineGiftData||new e}(),function(){var e;e=b8e.Object.extends({isHadGet:!1,canGet:!1,updateIdx:0,setData:function(e){this.cfg=e,this.time=e.onlineTime,this.createPrize()},createPrize:function(){for(var e=this.cfg.award,t=void 0,a=void 0,i=e.length,n=this.award=[],s=0;s<i;s++)t=e[s],a=game.ItemUtil.createBaseItemInfo(t.Id,t.Num),n.push(a)},getPrizeItems:function(){return this.award},updateIsGet:function(){this.isHadGet=game.onlineGiftData.isGotAward(this.time),this.isHadGet&&(this.canGet=!1)},setCanGet:function(){this.canGet=!0},reconnect:function(){this.isHadGet=game.onlineGiftData.isGotAward(this.time),this.canGet=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GiftItemInfo",e)}(),function(){var e=game.Control.extends({canShowAwardView:!1,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ONLINE_GIFT,game.SAE.HOME),this.data=game.onlineGiftData,this.minutes=b8e.TimeUtil.MINUTE_MICRO_SECONDS},notify:function(e,t){switch(e){case this.Evts.C2C_GET_AWARDS:this.sender.OnlineAwardReq(t)}},ipc:function(){var e=this;e.evts={Welfare:{C_INIT_MODEL:e.synData},MainRole:{C_RESET_DAILY:e.resetDaily,C_RECONNECT_MSIC_DATA:e.reconnect,C_LEVEL_UP:e.chekcAwardViewOpen}},e.handels={OnlineAwardResp:e.onlineAwardResp},e.gevts={SceneGEvts:{FIRST_ENTER_SCENE:e.onEnterScene},InstanceEvts:{G_STOP_PLAY:e.playStop}}},reconnect:function(){var e=this.data;0==e.onlineArr.length&&e.createData(),e.iconIsShow()?(e.reconnect(),this.updateTime(),this.send(this.Evts.C_UPDATE_AWARD_VIEW)):game.module.hide(this.moduleEnum)},synData:function(e){if(e&&e.data){var t=e.data,a=this.data;a.createData(),a.synData(t),this.updateTime(),this.onInitData(),this.send(this.Evts.C_UPDATE_AWARD_VIEW)}},onlineAwardResp:function(e){var t=e.readProtobuf(game.pb.OnlineAwardResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=this.data;a.onlineAwardResp(t.onlineTime),game.awardsData.setItemsByArray(a.showAward),game.module.show(game.ME.AwardShowTip),this.send(this.Evts.C2V_UPDATE_LIST),this.dpt(game.OnlineGiftEvts.REFRESHBTN_HOME);var i=a.isGetAll();this.chekcAwardViewOpen(),i?game.module.hide(this.moduleEnum):game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)}},updateTime:function(){var e=this,t=e.data;t.setNextTime();var a=t.nextTime;if(a){var i=a*e.minutes-(t.activeTime+game.SysTime.curTime-t.loginTime);0<i?(e.clearTime(),e.key=b8e.setTimeout(e.setCanget,e,i),t.setNextEndTime(i),t.updateList(),e.send(e.Evts.C2V_UPDATE_LIST)):e.setCanget()}else e.clearTime()},setCanget:function(){this.data.setCanGet(this.data.nextTime),this.updateTime()},resetDaily:function(){var e=this.data;if(this.chekcAwardViewOpen(),e.resetDaily(),!e.iconIsShow())return this.clearTime(),void game.module.hide(this.moduleEnum);e.createData(),this.updateTime(),this.spotAlert.alert=!1,this.send(this.Evts.C2V_RESET_DAILY),this.dpt(game.OnlineGiftEvts.REFRESHBTN_HOME)},clearTime:function(){this.key&&(b8e.clearTimeout(this.key),this.key=null)},rightBtn:function(){this.send(this.Evts.C2V_RIGHT_BTN)},leftBtn:function(){this.send(this.Evts.C2V_LEFT_BTN)},topBtn:function(){this.send(this.Evts.C2V_TOP_BTN)},bottomBtn:function(){this.send(this.Evts.C2V_BOTTOM_BTN)},gotoBtn:function(){var e=this.data.bannerIdx,t=game.OnlineAwardBannerCfg.getData(e);if(t){if(0<t.openServerType){this.obj||(this.obj={});var a=this.obj;return a.openServerType=t.openServerType,a.type=t.type,void b8e.evt.dptG(game.OpenServerGEvts.C2C_SHOW_OPENSERVER,a)}0<t.welfareId?game.module.showToggle(game.ME.Welfare,t.welfareId):game.module.showToggle(t.moduleEnum,t.toggle)}},chekcAwardViewOpen:function(){var e=b8e.module.isShowView(game.ME.OnlineGiftAward),t=game.onlineGiftData.iconIsShow();if(!e&&t){var a=game.sceneData.isCsScene(),i=game.playBack.isInstanceFighting(!1);if(a||i)return void(this.canShowAwardView=!0);game.module.show(game.ME.OnlineGiftAward),this.canShowAwardView=!1}else e&&!t&&game.module.hide(game.ME.OnlineGiftAward)},openViewBtn:function(){game.module.show(game.ME.OnlineGift)},onEnterScene:function(){this.isEnterScene=!0;var e=game.onlineGiftData.iconIsShow(),t=game.sceneData.isCsScene();e&&!t&&game.module.show(game.ME.OnlineGiftAward)},onInitData:function(){var e=game.onlineGiftData.iconIsShow(),t=game.sceneData.isCsScene();this.isEnterScene&&e&&!t&&game.module.show(game.ME.OnlineGiftAward)},playStop:function(){this.canShowAwardView&&this.chekcAwardViewOpen()}}),t=[game.ME.OnlineGiftAward],a=game.Sender.extends({ipc:function(){this.msg={OnlineAwardReq:this.onlineAwardReq}},onlineAwardReq:function(e){var t=game.pb.OnlineAwardRequest;t.group=game.onlineGiftData.group,t.onlineTime=e,this.write(t)}});b8e.module.registerControl(game.ME.OnlineGift,e,game.OnlineGiftEvts,a,t)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(762),this.setSize(600,138)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=6,e.layout.paddingTop=-5,e.layout.spacingX=15},setData:function(){var e=this,t=e.skin,a=e.data,i=a.getPrizeItems();if(e.list.setData(i),t.descLab.string=game.Lang.get(51929,a.time),t.hsaGet.active=a.isHadGet,t.getBtn.active=a.canGet,t.gray.active=!a.isHadGet&&!a.canGet,a.isHadGet||a.canGet)e.timer&&(b8e.Timer.remove(e,e.setCountDown),e.timer=null);else{var n=game.onlineGiftData.nextTime;n&&n==a.time?e.createTimer():e.timer&&(b8e.Timer.remove(e,e.setCountDown),e.timer=null)}},createTimer:function(){this.setCountDown(),this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.setCountDown,1e3)},setCountDown:function(){var e=game.onlineGiftData.getRemainTime();e<0?this.clearTimer():this.skin.timeLab.string=b8e.TimeUtil.formatTime(e)},clearTimer:function(){var e=this.skin;e.hsaGet.active=!1,e.getBtn.active=!0,e.gray.active=!1,this.timer&&(b8e.Timer.remove(this,this.setCountDown),this.timer=null)},getBtn:function(){this.data.cfg&&(game.onlineGiftData.showAward=this.data.cfg.award),this.send(game.OnlineGiftEvts.C2C_GET_AWARDS,this.data.time)}}),b8e.RC("$$game","$$OnlineGiftItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(763)},init:function(){var e=this.skin;this.data=game.onlineGiftData;var t=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.OnlineGiftItem,t.bindEnum=this.moduleEnum,t.layout.paddingLeft=3,t.layout.spacingY=5,t.addToParent(e.scrollview),t.setScrollViewCb(this.listCb,this),this.maxIdx=3;for(var a=void 0,i=void 0,n=1;n<4;n++)(a=game.OnlineAwardBannerCfg.getData(n))&&(i=game.ResCfg.getUrl(10123,a.banner),this.getComponent("banner"+n).loadTexture(i))},notify:function(e){var t=this;switch(e){case t.Evts.C2V_UPDATE_LIST:t.updateList();break;case t.Evts.C2V_RIGHT_BTN:t.scrollBannerRight();break;case t.Evts.C2V_LEFT_BTN:t.scrollBannerLeft();break;case t.Evts.C2V_TOP_BTN:t.list.scrollToTop(0,200);break;case t.Evts.C2V_BOTTOM_BTN:t.list.scrollToBottom(0,200);break;case t.Evts.C2V_RESET_DAILY:t.clearTimer(),t.createTimer(),t.updateList(),t.onShowSetting()}},listCb:function(e,t,a){var i=this.skin;i.topBtn.active=0<e.length,i.bottomBtn.active=0<a.length},bannerListCb:function(){var e=this.skin,t=this.data.bannerIdx;e.leftBtn.active=1!=t,e.rightBtn.active=t!=this.maxIdx,this.scrolling=!1,this.updateBannerView()},scrollBannerRight:function(){this.data.bannerIdx>this.maxIdx-1?this.clearScrollTimer():this.scrolling||(this.scrolling=!0,this.data.bannerIdx++,this.scrollBanner())},scrollBannerLeft:function(){this.data.bannerIdx<1||this.scrolling||(this.scrolling=!0,this.data.bannerIdx--,this.scrollBanner())},scrollBanner:function(){var e=this.skin.bannerList;b8e.Tween.kill(e);var t=-614*(this.data.bannerIdx-1);b8e.Tween.get(e).to({x:t},1600).call(this.bannerListCb,this)},updateBannerView:function(){for(var e=this.maxIdx+1,t=this.data.bannerIdx,a=1;a<e;a++)this.getComponent("light"+a).active=a==t},onShow:function(){this.createTimer(),this.updateList(),this.onShowSetting()},onShowSetting:function(){var e=this.skin;this.list.scrollToTop(),this.data.bannerIdx=1,e.leftBtn.active=!1,e.rightBtn.active=!0,e.bannerList.x=0,this.updateBannerView()},createTimer:function(){var e=this;e.updateTime(),e.timer?(e.timer.reset(),e.timer.start()):e.timer=b8e.Timer.add(e,e.updateTime,1e3),e.scrollTimer?(e.scrollTimer.reset(),e.scrollTimer.start()):e.scrollTimer=b8e.Timer.add(e,e.scrollBannerRight,6e3)},updateTime:function(){var e=this.data.getEndRemainTime();if(e<0)this.clearTimer();else{var t=game.TimeUtil.formatTimeSpace(e,3);this.skin.timeLab.string=t}},updateList:function(){var e=this.data.getOnlineList();this.list.setData(e)},onHide:function(){this.clearTimer(),this.clearScrollTimer()},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},clearScrollTimer:function(){this.scrollTimer&&(b8e.Timer.remove(this,this.scrollBannerRight),this.scrollTimer=null)}});b8e.module.registerView(game.ME.OnlineGift,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(1512),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){this.icon=game.GridUtil.createItemIcon(game.IconSizeEnum.CIRCLE_SIZE_84),this.icon.addToParent(this.skin.iconNode);var e=this.anim=b8e.Animator.get(game.AnimType.UI_EFFECT,2);e.addToParent(this.skin.anim),e.load(game.ResCfg.getUrl(5019,1123)),e.play(null,0)},notify:function(e){switch(e){case this.Evts.C2V_RESET_DAILY:case this.Evts.C_UPDATE_AWARD_VIEW:case this.Evts.C2V_UPDATE_LIST:this.updateView()}},onShow:function(){this.updateView()},onHide:function(){this.clearTimer()},updateView:function(){var e=this.skin,t=game.onlineGiftData,a=t.getCanGetAwardInfo();if(a=a||t.getNotGetAwardInfo()){var i=a.award[0];if(i)if(this.icon.setItemInfo(i,!1,game.IconLayoutEnum.SHOW_NUM),a.isHadGet||a.canGet)this.clearTimer(),e.timeLab.string=game.Lang.get(53011),e.redPoint.active=!0;else{var n=game.onlineGiftData.nextTime;n&&n==a.time&&this.createTimer(),e.redPoint.active=!1}}},createTimer:function(){this.updateTime(),this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.updateTime,1e3)},updateTime:function(){var e=this.skin,t=game.onlineGiftData.getRemainTime();if(t<0)return this.clearTimer(),e.timeLab.string=game.Lang.get(53011),void(e.redPoint.active=!0);var a=b8e.TimeUtil.formatTime(t);this.skin.timeLab.string=a},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},onStageResize:function(){this.setPosition(55,500)}});b8e.module.registerView(game.ME.OnlineGiftAward,e)}(),function(){var e;e=b8e.Enum({None:0,V_FIRSTANIM_DIAMON:-1,V_MONEYTREE:-1}),b8e.RC("$$game","$$WelcomeEvts",e)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={}},notify:function(e){},startBtn:function(){this.dpt(game.WelcomeEvts.V_FIRSTANIM_DIAMON,2),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive),game.module.hide(game.ME.Welcome),b8e.evt.dptG(game.InstanceEvts.G_RESTAR_AI),game.sdk.traceLog(4)}}),t=[game.ME.Welcome],a=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.Welcome,e,game.WelcomeEvts,a,t)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(1106)},init:function(){var e=this.skin,t=game.ResCfg.getUrl(48),a=b8e.Sprite.get();a.addToParent(e.bg),a.setAnchor(.5,.5),a.loadTexture(t),game.TweenUtil.rotationEffect(e.light)},setAnim:function(e){var t=void 0;e&&((t=(t=this.model.getAnimator(game.AnimType.PET_ANIM,1))||this.model.addAnimator(game.AnimType.PET_ANIM,1)).load(e),t.play())},closeBtn:function(){game.sdk.traceLog(4),game.module.hide(this.moduleEnum)}});b8e.module.registerView(game.ME.Welcome,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1,V2C_OPEN_INFO_VIEW:-1,C2C_OPEN_INFO_VIEW:-1,C2C_BOSS_OWNER_CHANGE:-1,C2C_BOSS_DIE:-1,C2C_CLEAR_CD:-1,C2C_QUERY_CD:-1}),b8e.RC("$$game","$$WildBossEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_DATA:-1,C2V_UPDATE_COST:-1,C2V_BOSS_OWNER_CHANGE:-1,C2V_UPDATE_CD:-1,C2C_UPDATE_CD:-1,C2V_QUREY_CD:-1,C2C_ADD_FINISH_COUNT:-1}),b8e.RC("$$game","$$WildBossInfoEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_VIEW:-1}),b8e.RC("$$game","$$WildBossShopEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.chat={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"wildboss_flee",funcType:game.ChatFuncType.CHAT_FUNC_WILD_BOSS},this.chat1={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"wildboss_award1",funcType:game.ChatFuncType.CHAT_FUNC_WILD_AWARD,params:0}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.WildInfoReq()},ipc:function(){this.evts={MainRole:{C_LEVEL_UP:this.onRoleLvUp},WildBossInfo:{C2C_UPDATE_CD:this.onSetCDTime}},this.handels={WildInfoResp:this.onWildInfoRsp,WildStateMsg:this.onWildStateNotify,WildBeChallengeMsg:this.onWildBeChallengeNotify,WildAwardMsg:this.onWildAwardNotify,WildCDResp:this.onWildCDResp}},notify:function(e,t){switch(e){case this.Evts.V2C_OPEN_INFO_VIEW:game.wildBossData.curBossInfo=t,this.dpt(this.Evts.C2C_OPEN_INFO_VIEW,t),this.sender.WildCDReq(t.bossId)}},onRoleLvUp:function(){game.wildBossData.initBossData()},onWildInfoRsp:function(e){var t=e.readProtobuf(game.pb.WildInfoResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.wildBossData.setData(t.info),this.setCDTime(t.cd)},createCDTimer:function(){if(this.cdTimer);else this._lastTime=b8e.timeStamp,this.cdTimer=b8e.Timer.add(this,this.updateCDTime,1e3),this.cdTimer.start()},clearCDTimer:function(){if(this.cdTimer)b8e.Timer.remove(this,this.updateCDTime),this.cdTimer=null;else;},updateCDTime:function(){var e=b8e.timeStamp,t=e-this._lastTime;if(this._lastTime=e,game.wildBossData.cd-=t,game.wildBossData.cd<1){this.clearCDTimer(),this.dpt(this.Evts.C2C_CLEAR_CD)}},onSetCDTime:function(e){this.setCDTime(e.data)},setCDTime:function(e){if(game.wildBossData.cd=0<e?e-game.SysTime.curTime:0,1<game.wildBossData.cd){this.createCDTimer()}else this.clearCDTimer()},onWildStateNotify:function(e){var t=e.readProtobuf(game.pb.WildStateNotify);if(0<t.code){game.notice.noticeError(t.code)}else if(game.wildBossData.setData(t.info),this.dpt(this.Evts.C2C_BOSS_OWNER_CHANGE),game.moduleOpen.checkOpen(this.moduleEnum)&&!game.sceneData.isCsScene()){this.addChatItem(t.globalState)}},addChatItem:function(e){if(e!=game.WildBossState.DIED)this.chat.marqueeKey=e==game.WildBossState.FLEE?"wildboss_flee":"wildboss_relive",game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null);else;},onWildBeChallengeNotify:function(e){var t=e.readProtobuf(game.pb.WildBeChallengeNotify);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(713,t.challengerName)},onWildAwardNotify:function(e){var t=e.readProtobuf(game.pb.WildAwardNotify);if(0<t.code){game.notice.noticeError(t.code)}else{if(t.role&&!game.sceneData.isCsScene()){if(t.items1&&0<t.items1.length){this.addAwardChatItem(1,t.role.roleName,t.items1[0])}if(t.items2&&0<t.items2.length){this.addAwardChatItem(2,t.role.roleName)}}var a=game.wildBossData.getBossInfo(t.bossId);if(a){a.hp=0,a.owner=null,a.curState=game.WildBossState.DIED}this.dpt(this.Evts.C2C_BOSS_DIE,a)}},addAwardChatItem:function(e,t,a){this.chat1.roleName=t,this.chat1.marqueeKey="wildboss_award"+e,this.chat1.clientParams=a,game.chatData.addChat(this.chat1),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)},onWildCDResp:function(e){var t=e.readProtobuf(game.pb.WildCDResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.bossId,i=t.hasCD,n=game.wildBossData.CDState;(n=n||(game.wildBossData.CDState={bossId:0,hasCD:!0})).bossId=a,n.hasCD=i,this.dpt(this.Evts.C2C_QUERY_CD)}}}),t=game.Sender.extends({ipc:function(){this.msg={WildInfoReq:null,WildCDReq:this.wildCdReq}},wildCdReq:function(e){var t=game.pb.WildCDRequest;t.bossId=e,this.write(t)}});b8e.module.registerControl(game.ME.WildBoss,e,game.WildBossEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){var e=this;e.evts={WildBoss:{C2C_OPEN_INFO_VIEW:e.onOpenView,C2C_BOSS_OWNER_CHANGE:e.onOwnerChange,C2C_BOSS_DIE:e.onBossDie,C2C_CLEAR_CD:e.onClearCD,C2C_QUERY_CD:e.onQureyCD},Back:{C_BACK_UPDATE_ITEMINFO:e.onUpdateItemInfo}},e.handels={WildChallengeResp:e.onWildChallengeRsp,WildCDResetResp:e.onWildCDResetRsp}},init:function(){this.exploitData=game.dailyExploitData,this._alertOptions={lang:710,okcb:this.onClickCdBtn,thisArg:this}},onOpenView:function(e){game.module.show(game.ME.WildBossInfo),game.wildBossData.curShow=e.data,this.send(this.Evts.C2V_UPDATE_DATA,e.data)},onBossDie:function(e){game.wildBossData.curShow=e.data,this.send(this.Evts.C2V_UPDATE_DATA,e.data)},onClearCD:function(){this.send(this.Evts.C2V_UPDATE_CD)},onQureyCD:function(){this.send(this.Evts.C2V_QUREY_CD)},onOwnerChange:function(){this.send(this.Evts.C2V_BOSS_OWNER_CHANGE)},onUpdateItemInfo:function(){this.send(this.Evts.C2V_UPDATE_COST)},btn_add:function(){var e=game.wildBossData.curBossInfo,t=game.WildBossCfg.getData(e.bossId);if(t&&t.cost&&!(t.cost.length<1)){var a=t.cost[0].Id;!(t=game.ItemInfoCfg.getData(a))||t.shopGoodsId.length<1||(game.wildBossShopData.itemId=a,game.wildBossShopData.buyData.goodsId=t.shopGoodsId[0],game.module.show(game.ME.WildBossShop))}},btn_challenge:function(){if(!game.UpgradeUtil.checkEquipTooMuch()&&!game.playBack.isInstanceFighting()&&!game.sceneData.isGuildMap()&&game.wildBossData.curBossInfo){var e=game.wildBossData.curBossInfo;if(e.owner&&e.owner.roleId!=game.mainRoleData.id)game.alert.show({lang:555,okcb:this.onClickGameAlert,thisArg:this});else{if(!e.owner||e.owner&&e.owner.roleId!=game.mainRoleData.id){var t=game.wildBossData.getOwnerBossInfo();if(t){var a=t.getCfg(),i=game.HtmlUtil.getColorStrByQuality(a.quality,game.Lang.get(9558,a.name,a.challengeLv));return void game.notice.show(711,i)}}this.sender.WildChallengeReq(e.bossId)}}},onClickGameAlert:function(){this.sender.WildChallengeReq(game.wildBossData.curBossInfo.bossId)},btn_cd:function(){if(!(game.wildBossData.cd<1)){var e=game.InstanceMiscCfg.getData("wildCDRate"),t=e?e.value:3,a=Math.floor(.001*game.wildBossData.cd/t),i=0,n=game.amount.get(game.AmountType.BIND_YUAN_BAO);n<a&&(i=1),(n=game.amount.get(game.AmountType.YUAN_BAO))<a&&(i=0);var s=game.Lang.get(9559,a),o=game.Lang.get(9552,a);this._alertOptions.langArgs=[0==i?s:o,b8e.TimeUtil.formatTime(game.wildBossData.cd)],this._alertOptions.args=[i,a],game.alert.showTwo(this._alertOptions)}},onClickCdBtn:function(e,t){0==e?this.sender.WildCDResetReq(t,0):this.sender.WildCDResetReq(0,t)},onWildCDResetRsp:function(e){var t=e.readProtobuf(game.pb.WildCDResetResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.C2C_UPDATE_CD,0),game.wildBossData.cd=0,this.send(this.Evts.C2V_UPDATE_CD))},onWildChallengeRsp:function(e){var t=e.readProtobuf(game.pb.WildChallengeResponse);if(0<t.code)game.notice.noticeError(t.code);else{if(game.wildBossData.setBossInfo(t.info),t.battlelog){game.GameViewMgr.inst().hideUnStrongViews();var a={type:t.pvp?game.InstanceType.WILD_BOSS_PVP:game.InstanceType.WILD_BOSS,rewards:t.useritem,exp:t.exp};game.playBack.play(t.battlelog,a),this.dpt(this.Evts.C2C_ADD_FINISH_COUNT)}else{var i={win:!0,type:game.InstanceType.WILD_BOSS,exp:0,rewards:t.useritem};b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,i)}game.InsFunCountData.addChallengeCount(game.InsFunCountType.WILDINS),this.dpt(this.Evts.C2C_UPDATE_CD,t.cd),game.wildBossData.cd=0<t.cd?t.cd-game.SysTime.curTime:0,this.send(this.Evts.C2V_UPDATE_CD)}},btn_playerInfo:function(){var e=game.wildBossData.curShow;if(e&&e.owner){var t=e.owner;t.roleId!==game.mainRoleData.id&&this.dptG(game.ChatEvts.SHOW_PLAYER,t.roleId)}}}),t=game.Sender.extends({ipc:function(){this.msg={WildChallengeReq:this.wildChallengeReq,WildCDResetReq:this.wildCDResetReq}},wildChallengeReq:function(e){var t=game.pb.WildChallengeRequest;t.bossId=e,this.write(t)},wildCDResetReq:function(e,t){var a=game.pb.WildCDResetRequest;a.bindGold=e,a.gold=t,this.write(a)}});b8e.module.registerControl(game.ME.WildBossInfo,e,game.WildBossInfoEvts,t)}(),function(){var e=game.Control.extends({init:function(){game.wildBossShopData.init(),this.buyData=game.wildBossShopData.buyData},notify:function(e){},rechargeBtn:function(){game.GameViewMgr.inst().hideUnStrongViews(!1),game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},buyBtn:function(){if(game.UpgradeUtil.checkEquipTooMuch());else{var e=this.buyData,t=game.ShopItemCfg.getDataByGoodsId(e.goodsId);if(t&&game.UpgradeUtil.checkItemList(t.costItems,e.count))this.dptG(game.ShopGEvts.BUY_ITEM,e);else;}},lessTenBtn:function(){this.buyData.count=Math.max(1,this.buyData.count-10),this.send(this.Evts.C2V_UPDATE_VIEW)},addTenBtn:function(){this.buyData.count=Math.min(99,this.buyData.count+10),this.send(this.Evts.C2V_UPDATE_VIEW)},lessBtn:function(){this.buyData.count=Math.max(1,this.buyData.count-1),this.send(this.Evts.C2V_UPDATE_VIEW)},addBtn:function(){this.buyData.count=Math.min(99,this.buyData.count+1),this.send(this.Evts.C2V_UPDATE_VIEW)}});b8e.module.registerControl(game.ME.WildBossShop,e,game.WildBossShopEvts,null)}(),function(){var e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e.bossInfos=b8e.HashMap.get(),e.cd=0,e.curShow=null},setData:function(e){this.datas=e,this.initBossData()},initBossData:function(){var e=this.datas;if(e&&!(e.length<1)){game.mainRoleData.lv;for(var t,a=0,i=e.length;a<i;a++)t=e[a],this.checkBossCanShow(t.bossId)&&this.setBossInfo(t)}},checkBossCanShow:function(e){var t=game.WildBossCfg.getData(e);return!!t&&game.mainRoleData.lv>=t.showLv},setBossInfo:function(e){if(e){var t=this.bossInfos.get(e.bossId);if(!t){t=new game.WildBossInfo,this.bossInfos.set(e.bossId,t)}t.setData(e),t.checkCanEnter()}else;},getBossInfo:function(e){return this.bossInfos.get(e)},getOwnerBossInfo:function(){for(var e,t=this.bossInfos.values(),a=0,i=t.length;a<i;a++){if((e=t[a]).owner&&e.owner.roleId==game.mainRoleData.id){return e}}return null},getBossDatas:function(){var e=this.bossInfos.values();return e.sort(this._onSort),e},_onSort:function(e,t){if(e.curState>t.curState){return-1}if(e.curState<t.curState){return 1}if(!e.canEnter||!t.canEnter){if(e.canEnter){return-1}if(t.canEnter){return 1}if(e.curState==game.WildBossState.RELIVE){if(e.challengeLv>t.challengeLv){return-1}if(e.challengeLv<t.challengeLv){return 1}return 0}if(e.challengeLv>t.challengeLv){return 1}if(e.challengeLv<t.challengeLv){return-1}return 0}if(e.curState==game.WildBossState.FLEE&&t.curState==game.WildBossState.FLEE){if(e.challengeLv>t.challengeLv){return 1}if(e.challengeLv<t.challengeLv){return-1}}else{if(e.challengeLv>t.challengeLv){return-1}if(e.challengeLv<t.challengeLv){return 1}}}});game.wildBossData=game.wildBossData||new e}(),function(){var e,t=e=b8e.Object.extends({bossId:0,hp:0,curState:0,nextState:0,nextTime:0,owner:null,ownerChangedTime:0,canEnter:!1,reliveTime:0,fleeTime:0,setData:function(e){var t=this;if(t.bossId=e.bossId,t.hp=e.hp,t.nextState=e.nextState,t.nextTime=1e3*e.nextTime,t.owner=e.owner,t.reliveTime=1e3*e.reliveTime,t.fleeTime=1e3*e.fleeTime,!t.wildDuration){var a=game.InstanceMiscCfg.getData("wildDuration2");t.wildDuration=a?Number(a.value):0}t.ownerChangedTime=t.owner?e.ownerChangedTime+t.wildDuration:0,t.curState=t.nextState==game.WildBossState.RELIVE?0<t.hp?game.WildBossState.FLEE:game.WildBossState.DIDE:game.WildBossState.RELIVE,t.challengeLv=t.getCfg().challengeLv,t.checkCanEnter()},checkCanEnter:function(){this.canEnter=game.mainRoleData.lv>=this.challengeLv},getCfg:function(){return game.WildBossCfg.getData(this.bossId)}});b8e.BindingUtil.bind(e),t.pollCall=!0,b8e.RC("$$game","$$WildBossInfo",e)}(),function(){var e=b8e.Object.extends({itemId:0,init:function(){this.buyData={},this.buyData.goodsId=0,this.buyData.count=1}});game.wildBossShopData=game.wildBossShopData||new e}(),function(){var e;e=b8e.Enum({DIED:0,FLEE:1,RELIVE:2}),b8e.RC("$$game","$$WildBossState",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1109)},init:function(){var e=this;e.bossId=0,e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList.itemRender=game.PrizeListItem,e._prizeList.addToParent(e.skin.node_prize1),e._prizeList.layout.spacingX=25,e._prizeList.layout.paddingTop=-5,e._dropList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._dropList.itemRender=game.PrizeListItem,e._dropList.addToParent(e.skin.node_prize2),e._dropList.layout.spacingX=25,e._dropList.layout.paddingTop=-5,e._model=b8e.SceneEntity.get(),e._model.addToParent(e.skin.model_root),e._headIcon=b8e.Sprite.get(),e._headIcon.setAnchor(.5,.5),e._headIcon.setSize(80,80),e._headIcon.addToParent(e.skin.head_bg.node),e.progressWidth=128},notify:function(e,t){var a=this;switch(e){case a.Evts.C2V_UPDATE_DATA:a.onUpdateData(t);break;case a.Evts.C2V_UPDATE_COST:a.createCost();break;case a.Evts.C2V_BOSS_OWNER_CHANGE:a.setOwnerInfo();break;case a.Evts.C2V_UPDATE_CD:a.createInfo(),a.updateBtnState();break;case a.Evts.C2V_QUREY_CD:a.updateBtnState()}},onShow:function(){this.onUpdateData(this.bossInfo)},onHide:function(){this.clearTimer(),this.clearOwnerHead()},onUpdateData:function(e){if(e){var t=this;t.bossCfg=e.getCfg(),t.bossCfg&&(t.bossInfo=e,t.createInfo(),t.createModel(),t.setProgress(),t.createCost(),t.setBossName(),t.setOwnerInfo(),t.createDropItem(),t.createHint())}},createInfo:function(){var e=this.bossInfo.curState==game.WildBossState.RELIVE,t=game.Lang.get(562,this.bossCfg.challengeLv),a=game.Lang.get(e?560:561);this.skin.lab_info.string=t,this.skin.lab_info2.string=a,0<(e?this.bossInfo.nextTime-game.SysTime.curTime:0)&&this.createTimer(),this.updateTime()},updateBtnState:function(){var e=game.wildBossData.CDState;e&&e.hasCD?0<game.wildBossData.cd&&this.bossInfo.curState==game.WildBossState.RELIVE?(this.skin.btn_cd.node.active=!0,this.skin.btn_challenge.node.active=!1):(this.skin.btn_cd.node.active=!1,this.skin.btn_challenge.node.active=!0):(this.skin.btn_challenge.node.active=!0,this.skin.btn_cd.node.active=!1)},setProgress:function(){var e=this;if(e.bossCfg){var t=e.bossCfg.hp,a=e.bossInfo.hp/t;e.skin.img_progress.node.width=e.progressWidth*a,e.skin.lab_progress.string=(1<=a?100:(100*a).toFixed(1))+"%"}},setBossName:function(){if(this.bossCfg){var e=game.HtmlUtil.getColorByQuality(this.bossCfg.quality),t=game.Lang.get(9560,this.bossCfg.name,this.bossCfg.challengeLv);this.skin.lab_boss_name.string=game.HtmlUtil.getText(e,t)}},createModel:function(){var e=this;if(e.bossId!==e.bossInfo.bossId){e.bossId=e.bossInfo.bossId;var t=game.AvatarUtil.getUIModel(e.bossCfg),a=e.bossCfg?game.ResCfg.getUrl(5e3,t):null,i=e._model.getAnimator(game.AnimType.BODY,1);(i=i||e._model.addAnimator(game.AnimType.BODY,1))&&(a?(i.load(a),i.play()):i.clear())}},createDropItem:function(){if(this.bossCfg){var e=this.bossCfg,t=game.CfgUtil.getPrizeListInfo(e.award);this._prizeList.setData(t.items);t.items.length,t.items.length;var a=game.CfgUtil.getPrizeListInfo(e.showAward);this._dropList.setData(a.items),.5*(628-(89*a.items.length+5*(a.items.length-1)))-45}},createCost:function(){if(this.bossCfg){var e=this.bossCfg.cost;if(!e||e.length<1)this.skin.info_bg4.node.active=!1;else{this.skin.info_bg4.node.active=!0;var t=e[0],a=game.ItemInfoCfg.getData(t.Id),i=game.itemData.getNumById(t.Id);this.skin.lab_cost.string=game.Lang.get(553,a?a.name:"",i,t.Num)}}},setOwnerInfo:function(){0<this.bossInfo.ownerChangedTime-.001*game.SysTime.curTime>>0&&this.createTimer(),this.updateTime(),this.createOwnerHead()},updateTime:function(){var e=0,t=this.bossInfo.owner,a=this.bossInfo.ownerChangedTime-.001*game.SysTime.curTime>>0,i="";i=!t||a<=0?(e++,game.Lang.get(554,game.Lang.get(9024),"")):game.Lang.get(554,game.HtmlUtil.getulText(t.roleName),"("+a+"s)"),this.skin.lab_affiliation.string=i,(a=this.bossInfo.curState==game.WildBossState.RELIVE?this.bossInfo.fleeTime-game.SysTime.curTime:0)<=0&&e++,this.skin.lab_flee_time.string=b8e.TimeUtil.formatTime(a),2<=e&&this.clearTimer()},createTimer:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},createOwnerHead:function(){if(this.bossInfo.owner){var e=this.bossInfo.owner,t=game.ResCfg.getHead(e.isMale);this._headIcon.loadTexture(t)}else this.clearOwnerHead()},clearOwnerHead:function(){this._headIcon&&this._headIcon.unloadTexture()},createHint:function(){this.skin.lab_hint.string=game.Lang.get(558)}});b8e.module.registerView(game.ME.WildBossInfo,e)}(),function(){var e;(e=game.ListItem.extends({ctor:function(){this._super(1110),this.setSize(600,300)},init:function(){this.bossId=0,this._model=b8e.SceneEntity.get(),this._model.addToParent(this.skin.model_root),this.skin.item_bg.loadTexture(game.ResCfg.getUrl(10071))},btn_enter:function(){this.bossData&&this.send(game.WildBossEvts.V2C_OPEN_INFO_VIEW,this.bossData)},setData:function(e){var t=this;e&&(t.bossData=e,t.bossCfg=e.getCfg(),t.bossCfg&&(game.CfgUtil.getMonsterCfgByMonGroup(t.bossCfg.monGroup,1,function(e){t.setElementBtn(e)},t),t.createModel(),t.setBossName(),t.setBossStates(),t.createInfo()))},setBossName:function(){if(this.bossCfg){var e=game.HtmlUtil.getColorByQuality(this.bossCfg.quality),t=game.Lang.get(9560,this.bossCfg.name,this.bossCfg.challengeLv);this.skin.lab_boss_name.string=game.HtmlUtil.getText(e,t)}},setBossStates:function(){var e=this;if(e.bossData){var t=e.bossData.canEnter;e.skin.lab_open.node.active=!t,e.skin.btn_enter.node.active=t,e.skin.lab_open.string=game.Lang.get(559,e.bossCfg.challengeLv),e.bossStateImg&&(e.bossStateImg.node.active=!1),e.bossStateImg=e.getComponent("state"+e.bossData.curState),e.bossStateImg.node.active=!0,e.skin.lab_next_time.string=b8e.TimeUtil.formatTimestamp(e.bossData.reliveTime,"h:m:s")}},createModel:function(){var e=this;if(e.bossData&&e.bossId!==e.bossData.bossId){if(e.bossId=e.bossData.bossId,!e.bossId)return void b8e.warn("bossId: ",e.bossId);var t=game.AvatarUtil.getUIModel(e.bossCfg),a=e.bossCfg?game.ResCfg.getUrl(5e3,t):null,i=e._model.getAnimator(game.AnimType.BODY,1);(i=i||e._model.addAnimator(game.AnimType.BODY,1))&&(a?(i.load(a),i.play()):i.clear())}},createInfo:function(){this.skin.lab_refresh.string=game.Lang.get(556),this.skin.lab_flee.string=game.Lang.get(557)},setElementBtn:function(e){var t=this.skin;e&&e.element?(this.elementAttr=e.element,t.view_elementBtn.active=!0,t.view_elementBtn.loadTexture(game.ResCfg.getUrl(10050,e.element))):t.view_elementBtn.active=!1},view_elementBtn:function(){this.elementAttr&&(game.elementData.setElementInfo(this.elementAttr,50369,this.skin.view_elementBtn.localToGlobal(),!1),game.module.show(game.ME.ElementAttr))}})).poolCall=!0,b8e.RC("$$game","$$WildBossItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1111)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createCount()}},init:function(){var e=this;e._itemGrid=game.GridUtil.createShopIcon(game.IconSizeEnum.GRID_SIZE_105),e._itemGrid.addToParent(e.skin.icon);var t=e._amountSp1=b8e.Sprite.get();t.addToParent(e.skin.costSprite_1),t.setAnchor(.5,.5),t.setSize(40,40),(t=e._amountSp2=b8e.Sprite.get()).addToParent(e.skin.costSprite_2),t.setAnchor(.5,.5),t.setSize(40,40),this.buyData=game.wildBossShopData.buyData},onShow:function(){this.createInfo()},createInfo:function(){var e=this;if(e.shopItemCfg=game.ShopItemCfg.getDataByGoodsId(e.buyData.goodsId),e.shopItemCfg){var t=game.ItemInfoCfg.getData(e.shopItemCfg.itemId);if(t){var a=game.HtmlUtil.getColorByQuality(t.quality);if(e.skin.name.string=game.HtmlUtil.getText(a,t.name),e.itemInfo=game.ItemUtil.createBaseItemInfo(e.shopItemCfg.itemId,e.shopItemCfg.itemNum,e.itemInfo),game.GridUtil.setItemIcon(e._itemGrid,e.itemInfo,!1,2),e.shopItemCfg.costItems&&0<e.shopItemCfg.costItems.length){var i=game.ItemInfoCfg.getData(this.shopItemCfg.costItems[0].Id);if(i){var n=game.ResCfg.getUrl(137,i.icon);this._amountSp1.loadTexture(n),this._amountSp2.loadTexture(n),this.skin.costNum_1.string=this.shopItemCfg.costItems[0].Num}else this._amountSp1.unloadTexture(),this._amountSp2.unloadTexture()}e.createCount()}else;}else;},createCount:function(){if(this.skin.count.string=this.buyData.count,this.shopItemCfg.costItems&&0<this.shopItemCfg.costItems.length){this.skin.costNum_2.string=this.shopItemCfg.costItems[0].Num*this.buyData.count}}});b8e.module.registerView(game.ME.WildBossShop,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1112)},init:function(){var e=this;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.WildBossItem,e._list.bindEnum=game.ME.WildBoss,this._list.layout.spacingY=5,e._list.addToParent(e.skin.node_scrollview),e.bossData=game.wildBossData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.createBossItem()}},onShow:function(){this.createBossItem()},createBossItem:function(){if(this._list&&this.bossData){var e=this.bossData.getBossDatas();this._list.setData(e)}else;},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.WildBoss,e)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_ICON:-1,C_MAP_CHANGE:-1,V_MAP_DRAGGABLE:-1,C_MAP_DRAGGABLE:-1,V_GET_GROUP_AWARDS:-1,V2C_SELECT_ICON:-1}),b8e.RC("$$game","$$WorldMapEvts",e)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.handels={NextMapResp:this.changeNextMap},this.gevts={TaskEvts:{G_TASK_ENTER_MAP:this.nextMap}}},changeNextMap:function(e){var t=e.readProtobuf(game.pb.NextMapResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.playBack.stop(),game.mainProcess.runSceneProcess(t.mapId),game.module.hide(game.ME.WorldMap),this.dpt(this.Evts.C_MAP_CHANGE)},notify:function(e,t){switch(e){case this.Evts.V_SELECT_ICON:this.selectIcon(t);break;case this.Evts.V_GET_GROUP_AWARDS:this.getGroupAwards();break;case this.Evts.V2C_SELECT_ICON:this.selectIcon(t)}},getGroupAwards:function(){if(game.UpgradeUtil.checkEquipTooMuch());else this.sender.MainInsClearanceAwardReq()},selectIcon:function(t){var a=this,i=game.SceneCfg.getData(game.mainRoleData.mapId);if(i){var n=game.SceneCfg.getData(t);if(n){var e=game.mainInstanceData,s=game.mainRoleData.lv;e.needMoveNextMap(function(e){e&&t==i.nextId&&s>=n.openLv?a.sender.NextMapReq():(game.module.show(game.ME.WorldMapAlert),a.send(a.Evts.V_SELECT_ICON,t))},a)}}else;},sureBtn:function(){game.module.hide(game.ME.WorldMapAlert)},nextMap:function(){this.sender.NextMapReq()},catchPetBtn:function(){var e=game.ME.CatchPet;game.moduleOpen.checkOpenWithTips(e,!0)&&game.module.show(e)}}),t=game.Sender.extends({ipc:function(){this.msg={NextMapReq:null,MainInsClearanceAwardReq:null}}}),a=[game.ME.WorldMapAlert];b8e.module.registerControl(game.ME.WorldMap,e,game.WorldMapEvts,t,a)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1116)},notify:function(e,t){switch(e){case this.Evts.V_SELECT_ICON:this.updateView(t)}},updateView:function(e){var t=this.skin,a=game.SceneCfg.getData(e),i=game.mainRoleData.mapId;if(t.mapName.string=a.name,a.id<i){t.lockNode1.active=!1,t.lockNode2.active=!1,t.unlockNode.active=!0,t.unlockDes.string=game.Lang.get(9341)}else if(a.id==i){t.lockNode1.active=!1,t.lockNode2.active=!1,t.unlockNode.active=!0,t.unlockDes.string=game.Lang.get(9342)}else t.lockNode1.active=!0,t.lockNode2.active=!0,t.unlockNode.active=!1,t.enterDes1.string=a.firstEnterDes,t.enterDes2.string=a.secondEnterDes;var n=a.id>i,s=game.ResCfg.getUrl(n?10097:10096,a.alertImg);t.alertImg.loadTexture(s)},onShow:function(){},onHide:function(){}});b8e.module.registerView(game.ME.WorldMapAlert,e)}(),function(){var e;(e=game.Widget.extends({ctor:function(){this._super(1117)},init:function(){var e=this.mapImg=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.mapIcon)},onShow:function(){this._setData()},onHide:function(){b8e.Tween.kill(this.skin.arrow)},_setData:function(){var e=this.config;e&&(this.mapImg.loadTexture(game.ResCfg.getUrl(58,e.mapIcon)),this.updateState())},setData:function(e){e&&(this.config=e,this.isInit&&this._setData())},updateState:function(){var t=this,a=t.config;if(a&&t.isInit){var e=t.skin,i=e.lock.node,n=e.success.node,s=e.isCurMap.node,o=e.enterShow.node;e.mapName.string=a.name;var r=game.mainRoleData.mapId;if(a.id<r)i.active=!1,n.active=!0,s.active=!1,o.active=!1;else if(a.id==r)i.active=!1,n.active=!1,s.active=!0,o.active=!1;else{var g=game.SceneCfg.getData(r),l=game.mainInstanceData,c=game.mainRoleData.lv;l.needMoveNextMap(function(e){e&&a.id==g.nextId&&c>=a.openLv?(i.active=!1,n.active=!1,s.active=!1,o.active=!0,t.updataEnterAnima()):(i.active=!0,n.active=!1,s.active=!1,o.active=!1)},t)}}},onhide:function(){},touchNode:function(){this.send(game.WorldMapEvts.V_SELECT_ICON,this.config.id)},updataEnterAnima:function(){b8e.Tween.get(this.skin.arrow,{loop:!0}).to({y:80},800).to({y:65},800)}})).poolCall=!0,b8e.RC("$$game","$$WorldMapIcon",e)}(),function(){var e=void 0;(e=game.Widget.extends({ctor:function(){this._super(1222)},init:function(){var e=this.grayPlateImg=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.grayPlate);var t=this.doingPlateImg=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(this.skin.doingPlate),this.skin.mapName.isBold(!0),this.progState=0},onShow:function(){this._setData()},setData:function(e){e&&(this.config=e,this.isInit&&this._setData())},_setData:function(){this.updateState()},updateState:function(){var t=this,a=t.config;if(a&&t.isInit){var e=0,i=game.mainRoleData.mapId,n=t.skin.enterShow;if(t.config.id<i)e=0,n.active=!1;else if(t.config.id==i)e=1,n.active=!1;else{e=2;var s=game.SceneCfg.getData(i),o=game.mainInstanceData,r=game.mainRoleData.lv;o.needMoveNextMap(function(e){e&&a.id==s.nextId&&r>=t.config.openLv?(n.active=!0,n.x=t.config.curAnimPos.X,n.y=t.config.curAnimPos.Y,t.updataEnterAnima(),t.parent&&t.parent.setFixedLocalZOrder(98)):n.active=!1},t)}t.progState=e,1==t.config.id&&(t.skin.doingPlate.y=-4);var g=t.skin;g.doingPlate.setVisible(1==t.progState),g.grayPlate.setVisible(2==t.progState),t.showCurNode(),1==t.progState?t.doingPlateImg.loadTexture(game.ResCfg.getUrl(10041,a.id)):2==t.progState&&t.grayPlateImg.loadTexture(game.ResCfg.getUrl(10042,a.id))}},showCurNode:function(){var e=this;e.skin.mapNameNode.setVisible(1==e.progState||0==e.progState),e.skin.mapNameNode.setPosition(0,e.config.namePos?40:-40),e.skin.mapName.string=e.config.name,e.skin.mask1.width=e.skin.mapName.width+10,e.skin.curNode.x=e.config.curAnimPos.X,e.skin.curNode.y=e.config.curAnimPos.Y,e.skin.qizi_1.setVisible(0==e.progState),e.skin.qizi_2.setVisible(2==e.progState),e.skin.curAnim.setVisible(1==e.progState),1==e.progState?(e.curAnim||(e.curAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.curAnim.addToParent(e.skin.curAnim),e.curAnim.load(game.ResCfg.getUrl(5019,1074))),e.curAnim.play(),e.parent&&e.parent.setFixedLocalZOrder(99)):e.curAnim&&e.curAnim.stop()},updataEnterAnima:function(){b8e.Tween.kill(this.skin.arrow),b8e.Tween.get(this.skin.arrow,{loop:!0}).to({y:80},300).to({y:65},300)},petBtn:function(){}})).poolCall=!0,b8e.RC("$$game","$$WorldMapPlate",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1118)},init:function(){var a=this,e=a.skin,t=a.mapLayer=b8e.BaseDisplay.get();t.addToParent(e.mapNode),a.worldMapIcons={},a.worldMapGrayPlateIcons={};var i=a.scene=b8e.SceneMgr.inst().createScene("worldMap",t);i.setSize(e.mapNode.width,e.mapNode.height);var n=i.getViewDisplay();n&&n.setMask(0);var s=game.ResCfg.getUrl(10036);i.loadMap(s,function(e,t){if(e){b8e.error(e)}else a.wMapLayer=t.getMapLayer(),a.loadMapComplete()},a);var o=i.getViewDisplay();this.mapDisplay=o,b8e.evt.onTouchStart(o,a._onTouchBegan,a),b8e.evt.onTouchEnd(o,a._onTouchEnd,a),b8e.evt.onTouchCancel(o,a._onTouchCancelled,a),b8e.evt.onTouchMove(o,a._onTouchMove,a),i.addEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,a._onClickMap,a)},_onClickMap:function(e){var t=b8e.scene.getGridPosByPixel(e.data.x,e.data.y),a=this.wMapLayer.getEarthSurface().getGridEventType(t.x,t.y);a&&this.send(this.Evts.V2C_SELECT_ICON,a)},_onTouchBegan:function(e){var t=e.target,a=e.touch.getLocation();t.hitTest(a)&&(this._startTouch||(this._startTouch=!0,this._lastPos=a))},_onTouchEnd:function(e){var t=e.target,a=e.touch.getLocation();t.hitTest(a)&&(this._lastPos=null,this._touchMoved&&e.stopPropagation(),this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1))},_onTouchCancelled:function(){this._lastPos=null,this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1)},_onTouchMove:function(e){var t=this,a=e.touch.getLocation();if(t._lastPos){t.location=a,t.offsetMapX=t._lastPos.x-a.x,t.offsetMapY=a.y-t._lastPos.y,t._lastPos=t.location,t._endPos=t.location,t._touchMoved=!0;var i=t.scene.getCamera(),n=i.focusX+t.offsetMapX,s=i.focusY+t.offsetMapY;i.setFocus(n,s)}},loadMapComplete:function(){this.scene.startRender();var e=game.SceneCfg.getDatas();if(e){for(var t,a=game.ME.WorldMap,i=e.length,n=0;n<i;n++){if((t=e[n])&&t.platIconPos){var s=b8e.SceneDisplay.get();s.clearDisabled=!0;var o=new game.WorldMapPlate;o.bindEnum=a,o.setData(t),s.addDisplay(o),s.setScenePosition(t.platIconPos.X,t.platIconPos.Y),this.scene.addDisplay(s,-11e3,!1,!1,!1),this.worldMapGrayPlateIcons[t.id]=o}}this.updateMapState()}else;},onShow:function(){this.updateMapState();game.mainInstanceData},updateMapState:function(){var e=game.SceneCfg.getDatas();if(e){for(var t,a,i=25<=game.mainRoleData.mapId,n=e.length,s=0;s<n;s++)(t=e[s])&&(a=this.worldMapGrayPlateIcons[t.id])&&(i&&1==t.type?(a.setVisible(!0),a.updateState(t)):i||0!=t.type?a.setVisible(!1):(a.setVisible(!0),a.updateState(t)));this.focusCurMap()}},getMapIcon:function(e){if(this.worldMapGrayPlateIcons&&this.worldMapGrayPlateIcons[e])return this.worldMapGrayPlateIcons[e];return null},focusCurMap:function(){var e=game.mainRoleData.mapId;3250<=game.mainInstanceData.id&&(e+=1);var t=game.SceneCfg.getData(e);t&&t.iconPos&&this.scene.getCamera().setFocus(t.iconPos.X,t.iconPos.Y)},viewBtnLeft:function(){var e=this.scene.getCamera();e.setFocus(e.focusX-500,e.focusY)},viewBtnRight:function(){var e=this.scene.getCamera();e.setFocus(e.focusX+500,e.focusY)}});b8e.module.registerView(game.ME.WorldMap,e)}(),function(){var e;e=b8e.Enum({C_INIT_WORLDWAR:b8e.enc(),C_SELECT_WORLDWAR:b8e.enc(),C_SELECT_WORLDWARDETAIL:b8e.enc(),V_UPDATE_DATA:b8e.enc(),V_UPDATE_RECORD:b8e.enc(),C_SHOW_RECORD:b8e.enc(),C2C_UPDATE_FINISH_COUNT:b8e.enc(),C2C_JOIN_TEAM:b8e.enc(),C2V_UPDATEVIEW:b8e.enc(),V2C_UPDATE_SECELT:b8e.enc()}),b8e.RC("$$game","$$WorldWarEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.gameData=game.worldWarData},ipc:function(){this.handels={ZhengzhanOpenBoxResp:this.zhengzhanOpenBoxResp}},zhengzhanOpenBoxResp:function(e){var t=e.readProtobuf(game.pb.ZhengzhanOpenBoxResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.id;game.worldWarData.openBox(a),game.module.hide(game.ME.WorldWarBoxAward)}},notify:function(){},openBoxBtn:function(){if(game.UpgradeUtil.checkAmountByType(game.AmountType.YUAN_BAO,500))if(game.UpgradeUtil.checkEquipTooMuch());else this.sender.ZhengzhanOpenBoxReq(game.worldWarData.selectOpenBoxId);else;}}),t=game.Sender.extends({ipc:function(){this.msg={ZhengzhanOpenBoxReq:this.zhengzhanOpenBoxReq}},zhengzhanOpenBoxReq:function(e){var t=game.pb.ZhengzhanOpenBoxRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.WorldWarBoxAward,e,game.WorldWarEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.gameData=game.worldWarData,this.spotAlert=game.spotAlert.set(game.SAE.BOSS_WORLDWAR,game.SAE.BOSS)},ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.onSyncInstanceData},WorldWarTeam:{C_CHECK_ALERT:this.checkAlert},MainUIChat:{C_REQ_ENTER_TEAM:this.inviteJoin},MainCenter:{C_REQ_ENTER_TEAM:this.inviteJoin},DifficultSelect:{C2C_SELECT_DIFFICULT:this.selectDifficult}}},checkAlert:function(){var e=game.worldWarData.checkWorldWarInfoAlert();this.spotAlert.alert=e},onSyncInstanceData:function(e){var t=e.data;if(t)this.gameData.synDatas(t.zhengzhan),this.dpt(this.Evts.C2C_UPDATE_FINISH_COUNT),this.checkAlert();else;},notify:function(e,t){switch(e){case this.Evts.C_SELECT_WORLDWAR:this.selectWorldWar(t.id),game.worldWarData.isBtnOpen=t.isBtn;break;case this.Evts.C_SHOW_RECORD:this.showSelectWorldWarRecord(t.id)}},inviteJoin:function(e){var t=e.data;if(t){var a=t.instId;game.worldWarData.firstShow();var i=game.worldWarData.getDetailInfoById(a);if(i){var n=i.worldWarId,s=game.worldWarData.getWorldWarInfoById(n);if(s)if(s.isUnlock()){if(i.isPass||i.canChall)game.worldWarData.selectWorldWarId=i.worldWarId,game.worldWarData.initBossList(),this.dpt(this.Evts.C2C_JOIN_TEAM,t);else{game.notice.show(9344)}}else{game.notice.show(9343)}else;}else;}else;},selectWorldWar:function(e){if(e)game.worldWarData.selectWorldWarId=e,game.worldWarData.initBossList(),game.module.show(game.ME.WorldWarTeam);else;},showSelectWorldWarRecord:function(e){game.worldWarData.showRecord=!0,this.selectWorldWar(e),this.dpt(this.Evts.C_SHOW_RECORD)},shop_btn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.PRESTIGE_SHOP)},modeBtn:function(){game.difficultSelectData.curInstType=game.DifficultSelectType.ZHENGZHAN,game.module.show(game.ME.DifficultSelect)},selectDifficult:function(e){if(e&&e.data){var t=e.data;t.instType==game.DifficultSelectType.ZHENGZHAN&&(game.worldWarData.curMode=t.difficult,game.worldWarData.updataNextDifficult(),this.send(this.Evts.V_UPDATE_DATA))}}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.WorldWar,e,game.WorldWarEvts,t)}(),function(){var e=game.TeamControl.extends({memberIds:null,showRecord:!1,init:function(){this.curTeamInstType=game.TeamInstType.WORLDWAR_TEAM,this.memberIds=[],this.teamData=game.worldWarData},ipc:function(){var e=this;e.evts={MainRole:{C_LEVEL_UP:e.levelUP},TeamHandel:{C_SET_TEAM:e._setTeamData,C_TEAM_CREATE:e._createTeam,C_TEAM_JOIN:e._joinTeam,C_TEAM_LEAVE:e._leaveTeam,C_KICK_MEMBER:e._kickMember,C_TEAM_QUICK_JOIN:e._quickJoinTeam,C_TEAM_JOIN_NOTIFY:e._joinTeamNotify,C_TEAM_LEAVE_NOTIFY:e._leaveTeamNotify,C_ENTER_BATTLE:e._enterBattle,C_BATTLE_END:e._battleEnd,C_TEAM_RATE:e._teamRate,C2C_TEAM_EMBATTLE:e._teamEmbattle,C2C_TEAM_PARTNER_TEAM_EMBATTLE:e._partnerTeamEmbattle,C2C_TEAM_INVITE_COOL_TIME:e._teamInviteCoolTime},WorldWar:{C_SHOW_RECORD:e.setShowRecord,C2C_JOIN_TEAM:e.inviteJoin},ZhanJiang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},ZhaoQin:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},BaoZang:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Hunting:{C2C_UPDATE_AUTOFIGHT:e.stopAutoBattle},Scene:{ENTER_CS_SCENE:e.stopAutoBattle,C2C_RECONNECT_ENTER_SCENE:e.reconnect}},e.handels={ZhengzhanBattleMsg:e.zhengZhanBattleEnd,ZhengzhanQuickResp:e.zhengzhanQuickResp,ZhengzhanRecordResp:e.zhengzhanRecordResp},e.gevts={InstanceEvts:{C2C_WORLD_WAR_TEAM_STOP_PLAY:e.battleStop}}},notify:function(e,t,a){var i=this;switch(e){case i.Evts.V_SHOW_VIEW:i.showView();break;case i.Evts.V_KICK_MEMBER:i.kickMember(t);break;case i.Evts.V_JOIN_TEAM:i.joinTeam(t,a);break;case i.Evts.V_SELECT_BOSS:i.selectBoss(t);break;case i.Evts.V_HIDE_VIEW:i.hideView();break;case i.Evts.V2C_TEAM_OPEN_SELECT_PARTNER_PANEL:i.openTeamSelectPartnerPanel(t);break;case i.Evts.V2C_TEAM_CHANGE_BATTLE_PARTNER_REQ:i.partnerTeamEmbattleReq(t);break;case i.Evts.V2C_TEAM_PARTNER_UPDATE_POS_REQ:i.teamPartnerUpdatePosReq();break;case i.Evts.V2C_TEAM_CHECK_TIME:i.checkTime()}},reconnect:function(){this.teamData.clearTeamData(),b8e.module.isShowView(game.ME.WorldWarTeamDetailsView)&&game.module.hide(game.ME.WorldWarTeamDetailsView)},setShowRecord:function(){this.teamData.showRecord=!0,this.recordReq()},zhengZhanBattleEnd:function(e){var t=this,a=e.readProtobuf(game.pb.ZhengzhanBattleNotify);if(0<a.code)game.notice.noticeError(a.code);else{var i=a.insid,n=a.battlelog,s=a.end;t.teamData.helpNum=a.helpNum;var o={type:game.InstanceType.WORLD_WAR_TEAM,rewards:a.useritem,exp:a.exp,group:1,isEnd:s};t.teamData.instId!=i&&game.playBack.stopAll(),game.GameViewMgr.inst().hideUnStrongViews(),game.playBack.play(n,o),n&&n.win&&(0<i?(s&&(t.teamData.updateInstPass(i),t.teamData.updateMaxInsId(i)),t.teamData.instId=i,t.dpt(t.Evts.C2C_UPDATE_FINISH_COUNT)):t.teamData.quickSweepAllInst()),t.send(t.Evts.V_UPDATE_DATA),t.dpt(t.Evts.C_CHECK_ALERT),t.dpt(t.Evts.C2C_CHANGE_TEAM_STATE)}},zhengzhanQuickResp:function(e){var t=e.readProtobuf(game.pb.ZhengzhanQuickResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.id;0!=a?this.teamData.quickSweep(a):this.teamData.quickSweepAll(),this.dpt(this.Evts.C_CHECK_ALERT)}},zhengzhanRecordResp:function(e){var t=e.readProtobuf(game.pb.ZhengzhanRecordResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.record1,i=t.record2;this.send(game.WorldWarEvts.V_UPDATE_RECORD,{firstRec:a,fastRec:i})}},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.PRESTIGE_SHOP)},assistBtn:function(){},openTeamSelectPartnerPanel:function(e){this.teamData&&this.teamData.isInTeam&&(this.setCurSelectPartnerId(e),b8e.module.isShowView(game.ME.WorldWarTeamSelectPartnerView)||game.module.show(game.ME.WorldWarTeamSelectPartnerView))},checkInstCanEnter:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t;if(this.invInstId=0,!game.TeamInstanceCfg.getData(e))return b8e.error("\u5bf9\u5e94\u7ec4\u961f\u526f\u672c\u914d\u7f6e\u4e0d\u5b58\u5728"),!1;var i=this.teamData.getDetailInfoById(e);return!!i&&(i.isPass||i.canChall?(this.invInstId=e,!0):(a&&game.notice.show(9345),!1))},showTeamInstView:function(){b8e.module.isShowView(game.ME.WorldWarTeam)||game.module.show(game.ME.WorldWarTeam)},hideView:function(){this._super(),this.teamData.showRecord=!1},selectBoss:function(e){this._super(e),this.teamData.showRecord&&this.recordReq(),this.send(this.Evts.V_UPDATE_DATA)},levelUP:function(){this.teamData.refreshBossList(),this.send(this.Evts.V_REFRESH_BOSS_LIST)},_setTeamData:function(e){this._super(e)},_battleEnd:function(e){var t=e.data,a=t.type,i=t.rp;if(a==this.curTeamInstType){var n={type:game.InstanceType.WORLD_WAR_TEAM,rewards:i.useritem,exp:i.exp};game.playBack.play(i.battlelog,n),game.GameViewMgr.inst().hideUnStrongViews(),this.teamData.teamBattle()}},_partnerTeamEmbattle:function(e){e.data.type==this.curTeamInstType&&(b8e.module.isShowView(game.ME.WorldWarTeamSelectPartnerView)&&game.module.hide(game.ME.WorldWarTeamSelectPartnerView),this._super(e))},createTeam:function(e){b8e.module.isShowView(game.ME.WorldWarTeamDetailsView)||game.module.show(game.ME.WorldWarTeamDetailsView),this._super(e)},_leaveTeam:function(e,t){t?this._super(e):this.__leaveTeam(e,1)},_leaveTeamNotify:function(e,t){t?this._super(e):this.__leaveTeam(e,2)},__leaveTeam:function(e,t){e.data.type==game.TeamInstType.WORLDWAR_TEAM&&(1==t?this._leaveTeam(e,!0):2==t&&this._leaveTeamNotify(e,!0),this._openViewState(e))},_openViewState:function(e){var t=e.data.rp;game.mainRoleData.roleId==t.roleid&&(b8e.module.isShowView(game.ME.WorldWarTeamDetailsView)&&game.module.hide(game.ME.WorldWarTeamDetailsView),b8e.module.isShowView(game.ME.WorldWarTeam)||game.module.show(game.ME.WorldWarTeam))},showView:function(){var e=this;e._super();var t=0;if(0<e.invInstId)t=e.invInstId;else if(e.teamData.isInTeam){var a=e.teamData.bossInfoList,i=!1;if(a&&0<a.length)for(var n=0;n<a.length;n++)if(a[n].id==e.teamData.curInsId){i=!0;break}i?t=e.teamData.curInsId:a&&0<a.length&&(t=a[0].id)}else{var s=e.teamData.bossInfoList,o=void 0,r=e.teamData.getWorldWarMaxInst();if(!s||s&&s.length<=0)return;for(var g=0;g<s.length;g++)if((o=s[g]).id==e.teamData.maxInsId&&r>o.id){if(e.teamData.checkCurInstByShow(o)){t=o.id+1;break}}else t=s[0].id}e.teamData.curInsId=t,e.selectBoss(t)},autoTime:function(){var e=this;0<e.teamData.autoStartTime&&e.teamData.autoStartTime--,0<e.teamData.autoFullStartTime&&e.teamData.autoFullStartTime--,e.teamData.isInTeam?(e.teamData.isFull&&e.teamData.isAutoFullStart&&e.teamData.autoFullStartTime<=0&&(e.startFight(),e.stopAutoTime()),e.teamData.isAutoStart&&e.teamData.autoStartTime<=0&&(e.startFight(),e.stopAutoTime())):(e.autoReqTime++,e.autoReq()),b8e.module.isShowView(e.moduleEnum)||!e.teamData.isAutoStart&&!e.teamData.isAutoFullStart||e.dpt(e.Evts.C_UPDATE_TIME),e.send(e.Evts.V_UPDATE_TIME)},sweepBtn:function(){var e=this.teamData.curInsId;this.sender.ZhengzhanQuickReq(e)},quickSweepBtn:function(){this.sender.ZhengzhanQuickReq(0)},createrTeamBtn:function(){this.checkInstCanEnter(this.teamData.curInsId)&&this._super()},quickJoinTeamBtn:function(){this.checkInstCanEnter(this.teamData.curInsId)&&this._super()},showRecordBtn:function(){this.teamData.showRecord=!0,this.recordReq(),this.send(this.Evts.V_UPDATE_DATA)},recordReq:function(){var e=this.teamData.curInsId;this.sender.ZhengzhanRecordReq(e)},battleStop:function(e){if(e){var t=this.data=e.data;t&&14==t.type&&(this.teamData.isWin=t.win,t.isEnd&&this.teamData.checkCurInstByBattle(t.win),this.teamData.curInstBossId&&(this.selectBoss2(this.teamData.curInstBossId),this.checkTime(),this.send(this.Evts.V_SET_TEAM)))}}}),t=game.Sender.extends({ipc:function(){this.msg={ZhengzhanQuickReq:this.zhengzhanQuickReq,ZhengzhanRecordReq:this.zhengzhanRecordReq}},zhengzhanQuickReq:function(e){var t=game.pb.ZhengzhanQuickRequest;t.id=e,this.write(t)},zhengzhanRecordReq:function(e){var t=game.pb.ZhengzhanRecordRequest;t.id=e,this.write(t)}}),a=[game.ME.WorldWarTeamDetailsView,game.ME.WorldWarTeamSelectPartnerView];b8e.module.registerControl(game.ME.WorldWarTeam,e,game.TeamEvts,t,a)}(),function(){var e=game.teamData.extends({curMode:1,chaMode:1,selectWorldWarId:0,selectOpenBoxId:0,helpNum:0,firstTimes:0,showRecord:!1,isBtnOpen:!1,isWin:!1,curInstBossId:0,ctor:function(){this._super(),this.recordType=0,this.instId=0,this._allHelpNum=0,this.worldDetailInfoMap=b8e.HashMap.get(),this.worldWarInfoMap=b8e.HashMap.get(),this.worldWarTypeMap=b8e.HashMap.get(),this.curTeamInstType=game.TeamInstType.WORLDWAR_TEAM},allHelpNum:{get:function(){if(this._allHelpNum)return this._allHelpNum;var e=game.InstanceMiscCfg.getData("zhengzhanHelpNum");return e&&(this._allHelpNum=+e.value),this._allHelpNum}},createChapterInfo:function(e,t){for(var a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=!1,l=game.WorldWarType.EASY;l<game.WorldWarType.MAX&&!(e<l);l++){a=[];var c=game.WorldWarCfg.getData(l,!0);if(c){for(var h=0,m=c.length;h<m;h++)if(i=c[h])if((n=this.worldWarInfoMap.get(i.id))||(n=new game.WorldWarInfo).setCfgData(i),0<n.infoArr.length)a[a.length]=n;else{if(!g){for(var u=0,d=(s=i.group).length;u<d;u++)(o=s[u])&&(t<=o&&o!=i.lastGroup&&(g=!0),(r=new game.WorldWarDetailInfo).setCfgData(o),r.idx=u+1,r.modeType=n.modeType,r.worldWarId=n.id,n.infoArr[n.infoArr.length]=r,this.worldDetailInfoMap.set(r.id,r));n.updateAllPass()}a[a.length]=n,this.worldWarInfoMap.set(n.id,n)}if(a.length<1)return;this.worldWarTypeMap.set(l,a)}}},getTypeDetailInfoArr:function(e){if(!e||e<game.WorldWarType.EASY||e>game.WorldWarType.GOD)b8e.warn("\u96be\u5ea6\u6a21\u5f0f\u4e0d\u5b58\u5728type\uff1a",e);else{var t=this.worldWarTypeMap.get(e);if(t)return t}},getCurTypeDetailInfoArr:function(){return this.getTypeDetailInfoArr(this.curMode)},synDatas:function(e){this.chaMode=e.level,this.instId=e.insid,this.helpNum=e.helpNum,this.chaNum=e.challengeNum,this.worldWarInsDatas=e.data,this.setCount(e.firstTimes)},firstShow:function(){if(!this._isInit){var e=this.chaMode||1,t=this.instId||6001;this.createChapterInfo(e,t),this.synLevelModeData(e,this.instId),this.synInsDatas(this.worldWarInsDatas),this._isInit=!0}},synInsDatas:function(e){if(e)for(var t=null,a=0,i=e.length;a<i;a++)t=e[a],this.synInsData(t)},synInsData:function(e){var t=this.worldDetailInfoMap.get(e.id);t&&(t.setData(e),this.updateMaxInsId(e.id),t.updateAlert())},synLevelModeData:function(e,t){for(var a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=!1,g=game.WorldWarType.EASY;g<game.WorldWarType.MAX&&!(e<g);g++)if(a=this.getTypeDetailInfoArr(g))for(var l=0,c=a.length;l<c&&(i=a[l],!r)&&!((s=(o=i.infoArr).length)<1);l++){for(var h=0;h<s;h++)(n=o[h])&&(t>=n.id&&(n.isPass=!0,n.canSweep=!0,this.updateMaxInsId(n.id)),!r&&t<n.id&&(r=n.canChall=!0));i.updateAllPass()}},resetChallMode:function(){this.curMode=game.WorldWarType.EASY},changeNextChallMode:function(){var e=this.curMode;this.canShowNextMode(e)?this.curMode++:this.curMode=game.WorldWarType.EASY},canShowNextMode:function(e){var t=this.getTypeDetailInfoArr(e);if(!t)return!1;if(7<t.length){var a=game.InstanceMiscCfg.getData("worldwarMaxLevel"+e);if(!a)return;var i=+a.value,n=this.getWorldWarInfoById(i);if(!n||n.infoArr.length<1)return;var s=n.infoArr.length;return n.infoArr[s-1].isPass}return!1},showSwitchType:function(e){var t=this.canShowNextMode(e),a=game.WorldWarType.NONE;return t?a=e+1:e>game.WorldWarType.EASY&&(a=game.WorldWarType.EASY),a},openBox:function(e){var t=this.getDetailInfoById(e);t&&(t.openBox=!1)},quickSweepAllInst:function(){var i=this;i.worldDetailInfoMap.forEach(function(e,t){if(t.isPass&&t.canSweep){t.addQuickCount(),t.updateAlert();var a=i.getWorldWarInfoById(t.worldWarId);a&&a.updateData()}})},updateInstPass:function(e){var t=this.getDetailInfoById(e);t&&(t.isPass||this.addCount(),t.isPass=!0,t.canChall=!1,t.quickCount||(t.quickCount=0),t.addQuickCount());var a=this.getDetailInfoById(e+1,t);a&&(this.unlockWorldDetailInfo(a),this.getWorldWarInfoById(a.worldWarId).change());this.getWorldWarInfoById(t.worldWarId).updateAllPass()},unlockWorldDetailInfo:function(e){e&&(e.isPass||(e.canChall=!0,e.openBox=!0,e.canSweep=!1,e.isPass=!1))},quickSweep:function(e){var t=this.getDetailInfoById(e);if(t){t.addQuickCount();var a=this.getWorldWarInfoById(t.worldWarId);a&&a.updateData()}},quickSweepAll:function(){var a=this;a.worldDetailInfoMap.forEach(function(e,t){t.isPass&&t.canSweep&&a.quickSweep(t.id)})},getDetailInfoById:function(e){var t=this.worldDetailInfoMap.get(e);return t||(this.createChapterInfo(this.curMode,e),t=this.worldDetailInfoMap.get(e)),t},getCurDetailInfo:function(){return this.getDetailInfoById(this.curInsId)},getWorldWarInfoById:function(e){return this.worldWarInfoMap.get(e)},getDetailInfoArrById:function(e){if(e){var t=this.worldWarInfoMap.get(e);if(t)return t.infoArr}},initBossList:function(){var e=this.getDetailInfoArrById(this.selectWorldWarId);this.bossInfoList=e},checkWorldWarInfoAlert:function(){for(var e=null,t=game.WorldWarType.EASY;t<game.WorldWarType.MAX;t++){if(!(t>this.chaMode))if(e=this.getTypeDetailInfoArr(t))for(var a=0,i=e.length;a<i;a++)if(e[a].alert)return!0}return!1},setCount:function(e){this.firstTimes=e},getCount:function(){return this.firstTimes},addCount:function(e){var t=0<arguments.length&&void 0!==e?e:1;this.firstTimes+=t},completeId:function(e){this.firstTimes<e&&(this.firstTimes=e)},getWorldWarMaxLay:function(){var e=game.InstanceMiscCfg.getData("worldWarTeamMaxLayer");return e?+e.value:0},getWorldWarMaxInst:function(){var e=game.InstanceMiscCfg.getData("worldWarTeamMaxInst");return e?+e.value:0},updateMaxInsId:function(e){if(e&&!(this.maxInsId>=e)){var t=this.getDetailInfoById(e);t&&(this.maxInsId=e,this.maxWorldWarId=t.worldWarId)}},checkCurInstByBattle:function(e){var t=this;if(e){var a=t.getWorldWarMaxInst(),i=t.instId;i=t.instId>=a?a:t.instId+1;var n=t.getDetailInfoById(i);if(!n){var s=t.getDetailInfoById(t.instId),o=game.InstanceMiscCfg.getData("worldwarMaxLevel"+s.modeType);if(!o)return;s.worldWarId==+o.value&&(t.createChapterInfo(s.modeType+1,i),n=t.getDetailInfoById(i),t.curMode=s.modeType+1)}n&&(t.selectWorldWarId=n.worldWarId,t.curInstBossId=i,t.initBossList())}else t.curInstBossId=t.curInsId},checkCurInstByShow:function(e){var t=e.id,a=this.getWorldWarMaxInst(),i=a<=t?a:t+1,n=this.getDetailInfoById(i),s=this.getDetailInfoById(t);return!(!n||!s)&&n.worldWarId==s.worldWarId},updataNextDifficult:function(){this.createChapterInfo(this.curMode,this.maxInsId+1);var e=this.getDetailInfoById(this.maxInsId+1);e&&(this.unlockWorldDetailInfo(e),this.getWorldWarInfoById(e.worldWarId).change())}});game.worldWarData=game.worldWarData||new e}(),function(){var e,t=e=b8e.Object.extends({id:0,idx:0,worldWarId:0,alert:!1,openBox:!0,isPass:!1,canSweep:!1,isSelect:!1,canChall:!1,quickCount:0,_cfg:null,ctor:function(){this.modeType=0,this.infoArr=[]},pushData:function(e){this.infoArr.push(e)},setData:function(e){this.openBox=!e.box,this.quickCount=e.quickCount,this.firstRec=e.record1,this.fastRec=e.record2,0<this.quickCount?(this.canSweep=!1,this.canChall=!1):this.canSweep=!0,this.isPass=!0},isUnlock:function(){return this.isPass||this.canChall},addQuickCount:function(){this.quickCount++,0<this.quickCount&&(this.canSweep=!1),this.updateAlert()},setCfgData:function(e){this.id=e},cfg:{get:function(){return this._cfg||(this._cfg=game.TeamInstanceCfg.getData(this.id)),this._cfg}},setPass:function(e){var t=!(0<arguments.length&&void 0!==e)||e;this.isPass=t},updateAlert:function(){this.alert=this.canChall||this.canSweep}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$WorldWarDetailInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,alert:!1,modeType:0,isAllPass:!1,isChange:!1,ctor:function(){this.modeType=0,this.infoArr=[]},pushData:function(e){this.infoArr.push(e)},setCfgData:function(e){(this.cfg=e).group&&e.group[0]||b8e.error("\u7ec4\u961f\u90e8\u5206\u7ec4\u914d\u7f6e\u9519\u8befid: ",e.id),this.name=e.name,this.id=e.id,this.modeType=e.level},setData:function(e){for(var t=null,a=this.infoArr.length,i=0;i<a;i++)(t=this.infoArr[i])&&t.id<=e&&t.setPass(!0)},updateAlert:function(){for(var e=null,t=!1,a=0,i=this.infoArr.length;a<i;a++)if((e=this.infoArr[a])&&e.alert){t=!0;break}this.alert=t},change:function(){this.isChange=!this.isChange},updateAllPass:function(){this.isAllPass=this.infoArr[this.infoArr.length-1].isPass},updateData:function(){this.updateAlert(),this.isAllPass=this.isAllInstPass()},isAllInstPass:function(){for(var e=null,t=0,a=this.infoArr.length;t<a;t++){if(!(e=this.infoArr[t]))return!1;if(!e.isPass)return!1}return!0},isUnlock:function(){var e=this.infoArr[0];return!!e&&e.isUnlock()}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$WorldWarInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,EASY:1,HARD:2,GOD:3,MAX:4}),b8e.RC("$$game","$$WorldWarType",e)}(),function(){var e=game.View.extends({prizeInfoList:null,_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(1119),this.prizeInfoList=[]},notify:function(e){},init:function(){this.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this.gridList.itemRender=game.WorldWarBoxItem,this.gridList.addToParent(this.skin.scrollGrid),this.gridList.layout.spacingX=40,this.gridList.layout.spacingY=21},onShow:function(){this.setPrizeList()},onHide:function(){},setPrizeList:function(){var e=game.worldWarData.getCurDetailInfo();if(e){var o=0,r=e.cfg,t=r.boxDropId;game.MonDropCfg.getItems(t,function(e){if(e){for(var t=null,a=0,i=e.length;a<i;a++){if(t=game.ItemInfoCfg.getData(e[a]),this.prizeInfoList[o])this.prizeInfoList[o].setData(t.id,0);else{var n=new game.PrizeInfo;n.setData(t.id,0),this.prizeInfoList[o]=n}o++}if(o<this.prizeInfoList.length){var s=this.prizeInfoList.length-o;this.prizeInfoList.splice(o,s)}this.gridList.setData(this.prizeInfoList)}else{b8e.error("\u5f81\u6218\u5929\u4e0bid: ",r.id,"\u6389\u843d\u5305\u4e0d\u5b58\u5728")}},this)}else;}});b8e.module.registerView(game.ME.WorldWarBoxAward,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1120),this.setSize(100,105)},setData:function(){if(!this._itemGrid){this._itemGrid=game.GridUtil.createPrizeIcon(),this._itemGrid.addToParent(this.skin.icon)}this._prizeInfo=game.ItemUtil.createBaseItemInfo(this.data.id,this.data.num,this._prizeInfo),game.GridUtil.setPrizeIcon(this._itemGrid,this._prizeInfo)}}),b8e.RC("$$game","$$WorldWarBoxItem",e)}(),function(){var e;e=game.TeamBossItem.extends({ctor:function(){this._super(1121)},init:function(){this._super(),this.firstIcons=[];for(var e=null,t=0;t<2;t++)e=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_84),this.firstIcons.push(e),e.addToParent(this.skin.firstIconNode),e.setPosition(88*(t-.5),0);(e=this.sweepIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.CIRCLE_SIZE_84)).addToParent(this.skin.iconNode),e.setPosition(0,0)},setData:function(){var e=this.data;this.skin.redSpot.node.active=e.alert,this._super(),this.setElementBtn(this.cfg)},setBossModel:function(){this._super(1,2)},setTitle:function(){var e=this.data.cfg;this.skin.nameLab.string=e.name},setDesc:function(){var e=this.skin,t=this.data,a="";e.firstIconNode.active=!t.isPass,e.iconNode.active=t.isPass;var i=t.isPass&&!t.canSweep;e.pass.node.active=i,t.isPass?(e.pass_last.node.active=!t.canSweep,t.canSweep?(e.openBoxBtn.node.active=!1,e.iconNode.active=!0,e.descLab.node.color=game.Color.GREEN,a=game.Lang.get(9346)):(e.descLab.node.color=game.Color.GREEN,e.openBoxBtn.node.active=t.openBox,e.iconNode.active=!t.openBox)):(e.openBoxBtn.node.active=!1,e.iconNode.active=!1,a=t.canChall?(e.descLab.node.color=game.Color.BLACK,game.Lang.get(9347)):(e.descLab.node.color=game.Color.RED,game.Lang.get(9348))),""!=a?(e.pass_last.node.active=!0,e.descLab.string=a):e.pass_last.node.active=!1},setPrize:function(){var e=this.data;this._infoList||(this._infoList=[]),e.isPass?this.showSweepPrize():this.showFristPassPrize()},showSweepPrize:function(){var i=this,n=i.data,e=n.cfg;e&&game.MonDropCfg.getItems(e.dropId,function(e){(!e||e.length<1)&&b8e.error("\u7ec4\u961f\u526f\u672cid: ",n.id,"\u5bf9\u5e94\u7684\u6389\u843d\u5956\u52b1\u4e0d\u5b58\u5728");var t=e[0],a=game.ItemInfoCfg.getData(t);i.sweepIcon.setItemInfo(a),i.sweepIcon.setNum(0)},i)},showFristPassPrize:function(){var e=this.data.cfg;if(e)for(var t=e.award,a=null,i=null,n=null,s=0;s<2;s++)a=t[s],(n=this.firstIcons[s])&&(a?(i=game.ItemInfoCfg.getData(a.Id),n.setItemInfo(i),n.setNum(a.Num)):n.clearData())},openBoxBtn:function(){game.worldWarData.selectOpenBoxId=this.data.id,game.module.show(game.ME.WorldWarBoxAward)}}),b8e.RC("$$game","$$WorldWarDetailItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1122),this.setSize(599,168)},init:function(){var e=this.itemBg=b8e.Sprite.get();e.setAnchor(0,1),e.addToParent(this.skin.bgNode),(this.model=b8e.SceneEntity.get()).addToParent(this.skin.modelNode)},setData:function(){var e=this.data,t=this.skin,a=e.cfg;if(a&&(t.mask1.active=e.isUnlock(),this.itemBg.loadTexture(game.ResCfg.getUrl(100,a.bgImg)),t.levelLab.string=a.name,t.pass.node.active=e.isAllPass,t.enterBtn.node.active=e.isUnlock(),a.group)){var i=game.TeamInstanceCfg.getData(a.group[0]);this.updateModel(i.monGroup)}},updateModel:function(e){var i=this;game.CfgUtil.getMonsterModelByMonGroup(e,1,!0,2,function(e){e=game.ResCfg.getUrl(5e3,e);var t=i.model,a=t.getAnimator(game.AnimType.BOSS,1);e&&""!=e?((a=a||t.addAnimator(game.AnimType.BOSS,1)).load(e),a.play()):a&&a.clear()},i,!1)},showRecordBtn:function(){this.send(game.WorldWarEvts.C_SHOW_RECORD,{id:this.data.id})},enterBtn:function(){game.worldWarData.isInTeam?b8e.module.isShowView(game.ME.WorldWarTeamDetailsView)||game.module.show(game.ME.WorldWarTeamDetailsView):this.send(game.WorldWarEvts.C_SELECT_WORLDWAR,{id:this.data.id,isBtn:!0})},view_elementBtn:function(){}}),b8e.RC("$$game","$$WorldWarItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1123),this.spotAlerts={SHOP_WORLDWAR:this.shopAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},init:function(){var e=this.levelList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.WorldWarItem,e.bindEnum=this.moduleEnum,e.layout.paddingLeft=0,e.layout.spacingY=7,e.addToParent(this.skin.levelList)},notify:function(e){switch(e){case this.Evts.V_UPDATE_DATA:this.updateData()}},onShow:function(){game.worldWarData.firstShow(),this.updateData()},updateData:function(){var e=this.skin,t=game.worldWarData.getCurTypeDetailInfoArr();this.levelList.setData(t);var a=game.worldWarData.curMode,i=game.ResCfg.getUrl(101,a);e.modeBtn.loadTexture(i)},onHide:function(){},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.WorldWar,e)}(),function(){var e=game.TeamView.extends({allHelpNum:0,ctor:function(){this._super(1124),this.spotAlerts={SHOP_WORLDWAR:this.shopAlert}},shopAlert:function(e){this.skin.redPoint.node.active=e.alert},init:function(){var e=this;e.teamData=game.worldWarData,e.curTeamInstType=game.TeamInstType.WORLDWAR_TEAM,e._super(),e.bossList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.bossList.itemRender=game.WorldWarDetailItem,e.bossList.bindEnum=e.moduleEnum,e.bossList.addToParent(e.skin.bossList),e.bossList.layout.spacingX=10;var t=game.InstanceMiscCfg.getData("zhengzhanHelpNum");t&&(e.allHelpNum=+t.value)},onShow:function(){this._super(),this.updateData(),this.skin.recordNode.active=!1,this.skin.teamView.active=!0,this.scrollToSelectPos()},scrollToSelectPos:function(){var e=this.teamData.getCurDetailInfo();if(e){var t=e.idx-1;t&&0!=t?(3<t&&(t=3),this.bossList.scrollToRight(196*t)):this.bossList.scrollToLeft(0)}else this.bossList.scrollToLeft(0)},view_left:function(){this.bossList.scrollContainerLeft()},view_right:function(){this.bossList.scrollContainerRight()},notify:function(e,t){switch(this._super(e,t),e){case this.Evts.V_UPDATE_DATA:this.updateData();break;case game.WorldWarEvts.V_UPDATE_RECORD:this.updateRecord(t)}},setCount:function(){},updateData:function(){var e=this.skin,t=game.worldWarData.selectWorldWarId;if(game.worldWarData.getWorldWarInfoById(t)){var a=game.worldWarData.curInsId,i=game.worldWarData.getDetailInfoById(a);if(i){var n=i.canSweep&&i.isPass,s=this.teamData.showRecord;e.teamNode.active=!n&&!s,e.teamList.active=!s,e.sweepNode.active=n&&!s;i.cfg;var o=this.allHelpNum-game.worldWarData.helpNum;o=0<o?o:0,e.awardCountLab.string=game.Lang.get(3004,o,this.allHelpNum),e.bg_2.active=!s}}},updateRecord:function(e){var t=this.skin;if(!e)return t.recordNode.active=!1,void(t.teamView.active=!0);t.firstRecord.active=!0,t.fastRecord.active=!0,t.noFirstRecord.active=!1,t.noFastRecord.active=!1,this.updateRecordByType(1,e.firstRec),this.updateRecordByType(2,e.fastRec),t.recordNode.active=!0,t.teamView.active=!1},updateRecordByType:function(e,t){var a=this.skin;t?(this.getComponent("teamInfo"+e).string=t.team,this.getComponent("roundLab"+e).string=t.rounds,this.getComponent("timeLab"+e).string=b8e.TimeUtil.formatTimestamp(t.time)):1==e?(a.firstRecord.active=!1,a.noFirstRecord.active=!0):2==e&&(a.fastRecord.active=!1,a.noFastRecord.active=!0)},closeBtn:function(){game.module.hide(this.moduleEnum)},returnBtn:function(){game.module.hide(this.moduleEnum)}});b8e.module.registerView(game.ME.WorldWarTeam,e)}(),function(){var e=game.TeamDetailsView.extends({ctor:function(){this._super(),this.bindModuleEnum=game.ME.WorldWarTeam},init:function(){this._super(),this.teamData=game.worldWarData,this.curTeamInstType=game.TeamInstType.WORLDWAR_TEAM},onHide:function(){this._super(),b8e.module.isShowView(game.ME.WorldWarTeam)&&game.module.hide(game.ME.WorldWarTeam)}});b8e.module.registerView(game.ME.WorldWarTeamDetailsView,e)}(),function(){var e=game.TeamSelectPartnerView.extends({ctor:function(){this._super(),this.bindModuleEnum=game.ME.WorldWarTeam}});b8e.module.registerView(game.ME.WorldWarTeamSelectPartnerView,e)}(),function(){var e;e=b8e.Enum({None:0,V_REQ_RANKINFO:-1,C_REQ_RANKINFO:-1,C2C_UPDATE_LAYER:-1,V_AUTO_FIGHT_CHANGE:-1,V_START_FIGHT:-1,C2C_UPDATE_AUTOFIGHT:-1,C2C_CHALLENGE_WIN:-1,V_ISGET_AWARD:-1,C2V_UPDATE_AWARD:-1}),b8e.RC("$$game","$$ZhanJiangEvts",e)}(),function(){var e=game.Control.extends({isAssist:!1,isInit:!1,ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.syncZhanJiang},InstanceFunc:{UPDATE_AUTOFIGHT:this.updateAutoFight},Rank:{C_UPDATE_DATA:this.updateRankInfo},MainRole:{C_VIP_LEVEL_CHANGE:this.changeVipLevel}},this.handels={ZhanJiangChallengeResp:this.onRespZhanJiangChallenge,ZhanJiangAwardResp:this.zhanJiangAwardResp,ZhanJiangSweepResp:this.zhanJiangSweepResp}},init:function(){this.instFuncHall=game.spotAlert.set(game.SAE.ZHANJIANG,game.SAE.INSTFUNC_HALL),this.fightAlert=game.spotAlert.set(game.SAE.ZHANJIANG,game.SAE.INSTFUNC),this.awardAlert=game.spotAlert.set(game.SAE.ZHANJIANG_AWARD,game.SAE.ZHANJIANG),this.sweepAlert=game.spotAlert.set(game.SAE.ZHANJIANG_SWEEP,game.SAE.ZHANJIANG)},notify:function(e,t){switch(e){case this.Evts.V_REQ_RANKINFO:this.isInit||(this.checkAlert(),this.isInit=!0),this.reqRankInfo();break;case this.Evts.V_START_FIGHT:this.startFight();break;case this.Evts.V_ISGET_AWARD:this.sender.ZhanJiangAwardReq(t)}},updateAutoFight:function(){this.send(this.Evts.V_AUTO_FIGHT_CHANGE)},changeVipLevel:function(){this.checkSweepAlert()},startFight:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return game.zhanjiangData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}var e=game.zhanjiangData.getLayer()+1;if(!game.ZhanJiangCfg.getData(e)){return game.notice.show(9066),void this.autoBg_1()}if(game.UpgradeUtil.checkEquipTooMuch()){this.autoBg_1()}else if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){this.autoBg_1()}else this.sender.ZhanJiangChallengeReq(0)},syncZhanJiang:function(e){if(game.moduleOpen.checkOpen(game.ME.ZhanJiang)){var t=e.data;if(t){var a=t.zhanJiangLayer;if(game.zhanjiangData.zhanJiangLayerAwards=t.zhanJiangLayerAwards,game.zhanjiangData.zhanJiangSweepNum=t.zhanJiangSweepNum,a)game.zhanjiangData.zhanJiangLayer=a,this.checkSweepAlert(),this.dpt(this.Evts.C2C_UPDATE_LAYER);else;}}},onRespZhanJiangChallenge:function(e){var t=this,a=e.readProtobuf(game.pb.ZhanJiangChallengeResponse);if(0<a.code)return game.notice.noticeError(a.code),game.zhanjiangData.autoFight=!1,void t.send(t.Evts.V_AUTO_FIGHT_CHANGE);game.zhanjiangData.zhanJiangLayer=a.layer,game.GameViewMgr.inst().hideUnStrongViews();var i={type:game.InstanceType.GUO_GUAN_ZHAN_JIANG,rewards:a.useritem,exp:a.exp};if(game.playBack.play(a.battlelog,i),t.dpt(t.Evts.C2C_UPDATE_LAYER),i.win)game.GameGuideMgr.inst().zhanjiangDone(a.layer),t.dpt(t.Evts.C2C_CHALLENGE_WIN);else{game.zhanjiangData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}1==a.type&&game.teamLeagueAssistData.updateAssistCount(),a.layer<2&&t.checkSweepAlert(),t.send(t.Evts.V_AUTO_FIGHT_CHANGE),t.checkAlert(),t.dpt(t.Evts.C2C_UPDATE_AUTOFIGHT,!0),i.win&&b8e.evt.dptG(game.PushTipEvts.C2C_FINISH_CHOUJIANG,game.ME.ZhanJiang)},zhanJiangSweepResp:function(e){var t=e.readProtobuf(game.pb.ZhanJiangSweepResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.zhanjiangData.zhanJiangSweepNum=t.num;var a=game.ZhanJiangCfg.getData(game.zhanjiangData.zhanJiangLayer);if(a){var i=a.sweepAward;game.awardsData.setItemsByArray(i,!0),game.module.show(game.ME.AwardShowTip),game.module.hide(game.ME.ZhanJiangSweep),this.checkSweepAlert()}}},zhanJiangAwardResp:function(e){var t=e.readProtobuf(game.pb.ZhanJiangAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.zhanjiangData.setIsGet(t.layer),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_AWARD))},fightBtn:function(){this.isAssist=!1,this.challengeReq()},challengeReq:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return game.zhanjiangData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}if(!game.UpgradeUtil.checkEquipTooMuch()){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return}this.isAssist?this.sender.ZhanJiangChallengeReq(1):this.sender.ZhanJiangChallengeReq(0)}},checkSweepAlert:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e);if(t){var a=t.zhanjiangSweepNum-game.zhanjiangData.zhanJiangSweepNum;this.sweepAlert.alert=0<a}},checkAlert:function(){var e=game.zhanjiangData.getAwardList();if(e){var t=e.length;if(!(t<1)){for(var a=void 0,i=!1,n=game.zhanjiangData.zhanJiangLayer,s=0;s<t;s++)if(!(a=e[s]).isGet)if(a.canGet)i=!0;else{if(n<a.layer)break;n>=a.layer&&(i=a.canGet=!0)}this.awardAlert.alert=i}}},sweepBtn:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e);t&&(game.zhanjiangData.zhanJiangSweepNum!=t.zhanjiangSweepNum?this.sender.ZhanJiangSweepReq():game.notice.show(53703))},autoBg_1:function(){game.zhanjiangData.autoFight=!game.zhanjiangData.autoFight,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,game.zhanjiangData.autoFight)},showRankBtn:function(){game.module.show(game.ME.ZhanJiangRank)},reqRankInfo:function(){this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.InsZhanJiang)},updateRankInfo:function(){this.send(this.Evts.V_UPDATEJINGMAIVIEW)},welfareBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.WORLD_SHOP)},assistBtn:function(){game.teamLeagueAssistData.canChallenge()&&(this.isAssist=!0,this.challengeReq())},awardBtn:function(){game.module.show(game.ME.ZhanJiangAwardPreview)}}),t=game.Sender.extends({ipc:function(){this.msg={ZhanJiangChallengeReq:this.ZhanJiangChallengeReq,ZhanJiangAwardReq:this.zhanJiangAwardReq,ZhanJiangSweepReq:null}},ZhanJiangChallengeReq:function(e){var t=game.pb.ZhanJiangChallengeRequest;t.type=e,this.write(t)},zhanJiangAwardReq:function(e){var t=game.pb.ZhanJiangAwardRequest;t.layer=e,this.write(t)}}),a=[game.ME.ZhanJiangRank,game.ME.ZhanJiangAwardPreview,game.ME.ZhanJiangSweep];b8e.module.registerControl(game.ME.ZhanJiang,e,game.ZhanJiangEvts,t,a)}(),function(){var e=b8e.Object.extends({maxShow:3,zhanJiangLayer:0,autoFight:!1,difficulty:1,zhanJiangLayerAwards:null,zhanJiangSweepNum:0,ctor:function(){this._super(),this.awardMap=b8e.HashMap.get()},getShowMonsters:function(e){var t=1+(e/this.maxShow|0);return game.ZhanJiangCfg.getAreaList(t)},getLayer:function(){return this.zhanJiangLayer},setAwardData:function(){if(this.zhanJiangLayerAwards){var e=this.zhanJiangLayerAwards.length;if(!(e<1)){for(var t=0;t<e;t++){var a=this.zhanJiangLayerAwards[t];this.getAwardInfo(a).setComplete()}var i=this.getAwardList();i&&i.sort(this._sort)}}},setIsGet:function(e){var t=this.getAwardInfo(e);if(t){t.setComplete();var a=this.getAwardList();a&&a.sort(this._sort)}},initAwardData:function(){var e=game.ZhanJiangAwardCfg.getDatas();if(e){var t=e.length;if(!(t<1))for(var a=void 0,i=0;i<t;i++){var n=e[i];if(!n)break;(a=this.awardMap.get(n.layer))||(a=new game.ZhanJiangAwardInfo,this.awardMap.set(n.layer,a)),a.setData(n)}}},getAwardList:function(){return this.awardMap.values()},getAwardInfo:function(e){return this.awardMap.get(e)},_sort:function(e,t){return e.isGet==t.isGet?e.canGet==t.canGet?e.layer-t.layer:e.canGet?-1:1:e.isGet?1:t.isGet?-1:void 0}});game.zhanjiangData=game.zhanjiangData||new e}(),function(){var e;e=b8e.Object.extends({layer:0,award:null,canGet:!1,isGet:!1,des:"",setData:function(e){this.award=e.award,this.layer=e.layer,this.des=e.des},setComplete:function(){this.isGet=!0,this.canGet=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ZhanJiangAwardInfo",e)}(),function(){var e;e=b8e.Object.extends({cfgId:0,items:null,ctor:function(){this._super(),this.items=[]},setup:function(e){for(var t=0,a=e.length;t<a;t++){var i=game.ItemUtil.createBaseItemInfo(e[t].Id,e[t].Num);this.items.push(i)}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ZhanJiangPrizeInfo",e)}(),function(){var e=game.View.extends({_modelList:null,_prizeItemList:null,_showModel:!0,ctor:function(){this._super(1152),this.spotAlerts={SHOP_ZHANJIANG:this.shopAlert,ZHANJIANG_AWARD:this.awardAlert,SPECIAL_WAR_ZHANJIANG_TOKEN:this.tokenAlert,ZHANJIANG_SWEEP:this.sweepAlert},this._modelList=[],this._prizeItemList=[]},shopAlert:function(){},sweepAlert:function(e){this.skin.sweepSpotAlert.active=e.alert},awardAlert:function(e){this.skin.redFight1.active=e.alert},tokenAlert:function(e){this.skin.tokenSpotAlert.active=e.alert},notify:function(e){switch(e){case this.Evts.V_UPDATEJINGMAIVIEW:this.updateView(),this.updateAward();break;case this.Evts.V_AUTO_FIGHT_CHANGE:this.autoFightChange();case this.Evts.C2V_UPDATE_AWARD:this.updateAward()}},updateAward:function(){var e=game.zhanjiangData.getAwardList();if(e){var t=e[0],a=t.award;if(a&&!(a.length<1)){this.skin.des.string=t.des,this.skin.countLab.string=t.canGet?game.Lang.get(52357):game.Lang.get(53042,t.layer-game.zhanjiangData.zhanJiangLayer);var i=a[0],n=game.ItemUtil.createBaseItemInfo(i.Id,i.Num,this.awardInfo);game.GridUtil.setItemIcon(this.icon,n,!1,game.IconLayoutEnum.SHOW_NUM)}}},init:function(){var e=this;e.zhanjiangBg=b8e.Sprite.get(),e.zhanjiangBg.setAnchor(0,1),e.zhanjiangBg.addToParent(e.skin.zhanjiangBg),e.zhanjiangBg.loadTexture(game.ResCfg.getUrl(19));for(var t=void 0,a=void 0,i=0;i<3;++i)(t=b8e.SceneEntity.get()).addToParent(e.getComponent("monModel"+i)),e._modelList.push(t),(a=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid)).itemRender=game.PrizeListItem,a.layout.paddingLeft=13,a.layout.paddingRight=0,a.layout.paddingTop=5,a.layout.spacingX=35,a.addToParent(e.getComponent("prizeList_"+i)),e._prizeItemList.push(a);e._maxLayer=3*game.CfgUtil.getZhanjiangLastLayer();var n=game.zhanjiangData.zhanJiangLayer,s=n+1>e._maxLayer?n:n+1,o=game.ZhanJiangCfg.getData(s);game.zhanjiangData.difficulty=o.type,e.zhanjiangTitle=b8e.Sprite.get(),e.zhanjiangTitle.setAnchor(.5,.5),e.zhanjiangTitle.addToParent(e.skin.title),e.zhanjiangTitle.loadTexture(game.ResCfg.getUrl(76,o.type)),e.insAutoTime=game.CfgUtil.getInsAutoTimeSpace(),e.insAutoTimeDesc=game.CfgUtil.getInsAutoTime(),game.zhanjiangData.initAwardData(),game.zhanjiangData.setAwardData(),e.icon=game.GridUtil.createItemIcon(game.IconSizeEnum.CIRCLE_SIZE_84),e.icon.addToParent(e.skin.iconNode);var r=e.anim=b8e.Animator.get(game.AnimType.UI_EFFECT,2);r.addToParent(e.skin.anim),r.load(game.ResCfg.getUrl(5019,1123)),r.play(null,0)},onShow:function(){var e=this,t=e.skin;e.send(e.Evts.V_REQ_RANKINFO),t.viewLevelBtn.active=!1,t.lb_tips.active=!1,t.nd_fight.active=!0;var a=game.zhanjiangData.zhanJiangLayer,i=a+1>e._maxLayer?a:a+1;if(0<a){var n=game.ZhanJiangCfg.getData(a),s=game.ZhanJiangCfg.getData(i);if(n&&s)if(n.type!=s.type){t.viewLevelBtn.active=!0,game.zhanjiangData.autoFight=!1,t.lb_tips.active=!0,t.nd_fight.active=!1;var o=game.ResCfg.getUrl(5033,s.type);t.viewLevelBtn.loadTexture(o),e.updateInfo(a-1)}else e.updateInfo(a)}else e.updateInfo(a);e.autoFightChange(),e.updateAward(),e.skin.view_tokenEnterBtn.active=game.specialWarTokenData.checkOpenByTokenType(game.SpecialWarTokenType.ZhanJiang)},updateInfo:function(e){var i=this,t=(i.skin,game.zhanjiangData.getShowMonsters(e));t.sort(i._sort);for(var a=0;a<t.length;++a)if(i.getComponent("finishIcon_"+a).node.active=game.zhanjiangData.zhanJiangLayer>=t[a].layer,i.getComponent("instanceName"+a).string=game.Lang.get(8551,t[a].layer),a<i._modelList.length&&game.CfgUtil.getMonsterCfgByMonGroup(t[a].monGroup,1,function(a){return function(e){var t=game.AvatarUtil.getUIModel(e,0,!1);i.setAnim(game.ResCfg.getUrl(5e3,t),i._modelList[a]),i.setElementBtn(e,a)}}(a),i),a<i._prizeItemList.length){var n=game.CfgUtil.getPrizeListInfo(t[a].showItems,game.IconLayoutEnum.SHOW_ALL,game.IconSizeEnum.GRID_SIZE_105);i._prizeItemList[a].setData(n.items)}},updateView:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.InsZhanJiang);if(e&&0<e.length)for(var t=0;t<e.length&&t<3;++t)this.getComponent("rank_"+t).string=game.Lang.get(9563,e[t].score),this.getComponent("rankname_"+t).string=e[t].rank+"    "+e[t].name},onHide:function(){for(var e=void 0,t=0;t<this._modelList.length;++t)(e=this._modelList[t].getAnimator(game.AnimType.BODY,1))&&e.clear();this.autoFightTimer&&this.autoFightTimer.stop(),this.skin.autoTips.string=game.Lang.get(9355)},autoFightChange:function(){var e=this,t=game.zhanjiangData.autoFight;(e.skin.autoBg_2.node.active=t)?(e.autoFightEndTime=game.SysTime.curTime+e.insAutoTime,e.autoFightTimer||(e.autoFightTimer=b8e.Timer.add(e,e.updateFightTime,500)),e.autoFightTimer.reset(),e.autoFightTimer.start(),e.skin.autoTips.string=game.Lang.get(9568,e.insAutoTimeDesc)):(e.autoFightTimer&&e.autoFightTimer.stop(),e.skin.autoTips.string=game.Lang.get(9355))},updateFightTime:function(){var e=this.autoFightEndTime-game.SysTime.curTime;0<e?this.skin.autoTips.string=game.Lang.get(9568,e/1e3>>0):(this.autoFightTimer.stop(),this.skin.autoTips.string=game.Lang.get(9356),this.send(this.Evts.V_START_FIGHT))},setAnim:function(e,t){var a=void 0;e?((a=(a=t.getAnimator(game.AnimType.BODY,1))||t.addAnimator(game.AnimType.BODY,1)).load(e),a.play()):a&&a.clear()},_sort:function(e,t){return e.layer-t.layer},viewLevelBtn:function(){var e=this.skin,t=game.zhanjiangData.zhanJiangLayer,a=t+1>this._maxLayer?t:t+1,i=game.ZhanJiangCfg.getData(t),n=game.ZhanJiangCfg.getData(a);i&&n&&(i.type!=n.type?(game.zhanjiangData.difficulty=n.type,this.updateInfo(t),e.lb_tips.node.active=!1,e.nd_fight.node.active=!0,this.zhanjiangTitle.loadTexture(game.ResCfg.getUrl(76,n.type))):game.notice.show(game.Lang.get(1516)),e.viewLevelBtn.active=!1)},setElementBtn:function(e,t){var a=this.getComponent("view_elementBtn_"+t);e&&e.element?(this.element||(this.element=[]),this.element[t]=e.element,a.active=!0,a.loadTexture(game.ResCfg.getUrl(10050,e.element))):a.active=!1},view_elementBtn_0:function(){this.clickElementBtn(0)},view_elementBtn_1:function(){this.clickElementBtn(1)},view_elementBtn_2:function(){this.clickElementBtn(2)},clickElementBtn:function(e){if(this.element||!(this.element.length<1)){var t=this.getComponent("view_elementBtn_"+e),a=this.element[e];game.elementData.setElementInfo(a,50369,t.localToGlobal(),!1),game.module.show(game.ME.ElementAttr)}},view_tokenEnterBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.TOKEN_ZHANJIANG)},view_shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.TRIAL_SHOP)},view_sweepBtn:function(){game.module.show(game.ME.ZhanJiangSweep)}});b8e.module.registerView(game.ME.ZhanJiang,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1153),this.setSize(540,94)},setData:function(){this.onClear();var e=this.data;if(e){var t=this.skin;t.rank.node.active=3<e.rank,t.rank.string=e.rank+"",t.name.string=e.name,t.power.string=e.power+"",t.instancenum.string=e.score+"";var a=e.rank;3<a?this.skin.rank4.node.active=!0:this.getComponent("rank"+a).node.active=!0}else;},onClear:function(){for(var e=1;e<5;e++){this.getComponent("rank"+e).node.active=!1}}}),b8e.RC("$$game","$$ZhanJiangRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(1154),this.spotAlerts={}},init:function(){this.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.rankList.itemRender=game.ZhanJiangRankItem,this.rankList.bindEnum=game.ME.ZhanJiangRank,this.rankList.addToParent(this.skin.listNode),this.rankList.layout.paddingLeft=0,this.rankList.layout.paddingTop=1,this.rankList.layout.spacingY=5},onShow:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.InsZhanJiang);this.rankList.setData(e);var t=game.rankData.getSelfRankInfo(game.RankType.InsZhanJiang);if(t){this.skin.rankNum.string=0==t.rank?game.Lang.get(9069):t.rank,this.skin.instanceNum.string=t.score}}});b8e.module.registerView(game.ME.ZhanJiangRank,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1507),this.setSize(540,169)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.awardList.itemRender=game.PrizeListItem,this.awardList.addToParent(this.skin.awardList)},setData:function(e){var t=this.skin;game.zhanjiangData.zhanJiangLayer>=e.layer?t.name.string=game.Lang.get(53015,e.layer,game.zhanjiangData.zhanJiangLayer,e.layer):t.name.string=game.Lang.get(53020,e.layer,game.zhanjiangData.zhanJiangLayer,e.layer),t.canGet_Btn.active=e.canGet,t.isGet.active=e.isGet,t.goTo.active=!e.canGet&&!e.isGet;var a=game.CfgUtil.getPrizeListInfo(e.award,null,game.IconSizeEnum.GRID_SIZE_84);a&&this.awardList.setData(a.items)},goTo:function(){game.module.hide(game.ME.ZhanJiangAwardPreview)},canGet_Btn:function(){this.send(game.ZhanJiangEvts.V_ISGET_AWARD,this.data.layer)}}),b8e.RC("$$game","$$ZhanJiangAwardItme",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1506)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.ZhanJiangAwardItme,e.bindEnum=game.ME.ZhanJiang,e.addToParent(this.skin.list)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_AWARD:this.updateList()}},onShow:function(){this.list.scrollToTop(),this.updateList()},updateList:function(){var e=game.zhanjiangData.getAwardList();this.list.setData(e)}});b8e.module.registerView(game.ME.ZhanJiangAwardPreview,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1764)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this.awardList.itemRender=game.PrizeListItem,this.awardList.layout.paddingLeft=40,this.awardList.layout.spacingX=50,this.awardList.addToParent(this.skin.awardList)},onShow:function(){var e=game.zhanjiangData.getLayer();if(this.skin.btn_gray.active=e<1,this.skin.lab_des.active=e<1,0<e){var t=game.ZhanJiangCfg.getData(e);if(!t)return;var a=game.CfgUtil.getPrizeListInfo(t.sweepAward,game.IconLayoutEnum.SHOW_ALL,game.IconSizeEnum.CIRCLE_SIZE_104);a&&this.awardList.setData(a.items)}this.skin.sweepBtn.active=0<e,this.skin.count.active=0<e;var i=game.mainRoleData.vipLevel,n=game.VipCfg.getData(i).zhanjiangSweepNum-game.zhanjiangData.zhanJiangSweepNum;this.skin.redPoint.active=0<n,this.skin.curLayer.string=game.Lang.get(53701,e),this.skin.count.string=game.Lang.get(53702,n)}});b8e.module.registerView(game.ME.ZhanJiangSweep,e)}(),function(){var e;e=b8e.Enum({None:0,SHOWNEXTPRIZELIST:-1,UPDATE_PRIZETIPS:-1,GET_PRIZE:-1,V_REQ_RANKINFO:-1,C_REQ_RANKINFO:-1,C2C_SYS_DATA_SUCCEED:-1,C2C_CHALLENGE_SUCCEED:-1,V_AUTO_FIGHT_CHANGE:-1,V_START_FIGHT:-1,CLOSE_PRIZETIPS:-1,DAILY_UPDATE:-1,SWEEP_UPDATEVIEW:-1,C2C_UPDATE_AUTOFIGHT:-1,C2V_UPDATE_VIEW:-1,C2C_CHALLENGE_WIN:-1}),b8e.RC("$$game","$$ZhaoqinEvts",e)}(),function(){var e=game.Control.extends({isAssist:!1,init:function(){this.zhaQinTagAlert=game.spotAlert.set(game.SAE.ZHAOQIN_TAG,game.SAE.BOSS),this.zhaoQinAlert=game.spotAlert.set(game.SAE.FIGHT_MARRY),this.fightAlert=game.spotAlert.set(game.SAE.ZHAOQIN_FIGHT)},ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.syncZhaoqin},Rank:{C_UPDATE_DATA:this.updateRankInfo},InstanceFunc:{UPDATE_AUTOFIGHT:this.updateAutoFight},DifficultSelect:{C2C_SELECT_DIFFICULT:this.selectDifficult}},this.handels={ZhaoQinChallengeResp:this.onRespZhaoQinChallenge,ZhaoQinSweepResp:this.onRespZhaoQinSweep,ZhaoQinCollectAwardResp:this.onRespZhaoQinCollectAward}},notify:function(e){switch(e){case this.Evts.GET_PRIZE:this.sender.ZhaoQinCollectAwardReq(game.zhaoqinData.showPrizeLayer);break;case this.Evts.V_REQ_RANKINFO:this.reqRankInfo();break;case this.Evts.V_START_FIGHT:this.startFight()}},startFight:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return game.zhaoqinData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}var e=game.zhaoqinData.currentLayer+1,t=game.ZhaoQinCfg.getData(e);if(!t)return game.notice.show(9066),void this.autoBg_1();if(t.lastRound)return game.notice.show(9066),void this.autoBg_1();if(t.type!=game.zhaoqinData.curDifficulty)return game.zhaoqinData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),game.difficultSelectData.curInstType=game.DifficultSelectType.ZHAOQIN,void game.module.show(game.ME.DifficultSelect);if(game.UpgradeUtil.checkEquipTooMuch()){this.autoBg_1()}else if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){this.autoBg_1()}else this.sender.ZhaoQinChallengeReq(0)},autoBg_1:function(){game.zhaoqinData.autoFight=!game.zhaoqinData.autoFight,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,game.zhaoqinData.autoFight)},updateAutoFight:function(){this.send(this.Evts.V_AUTO_FIGHT_CHANGE)},syncZhaoqin:function(e){if(game.moduleOpen.checkOpen(game.ME.ZhaoQin)){var t=e.data;if(t){var a=t.zhaoQin;if(a)game.zhaoqinData.setup(a),this.checkAllAlert(),this.dpt(this.Evts.C2C_SYS_DATA_SUCCEED),this.send(this.Evts.DAILY_UPDATE);else;}}},onRespZhaoQinChallenge:function(e){var t=e.readProtobuf(game.pb.ZhaoQinChallengeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.ZhaoQinCfg.getData(t.layer);a&&game.zhaoqinData.curDifficulty!=a.type&&this.send(this.Evts.C2V_UPDATE_VIEW,game.zhaoqinData.curDifficulty),game.zhaoqinData.currentLayer=t.layer,game.zhaoqinData.maxLayer<t.layer&&(game.zhaoqinData.maxLayer=t.layer),game.GameViewMgr.inst().hideUnStrongViews();var i={type:game.InstanceType.ZHAO_QIN,rewards:t.useritem,exp:t.exp};if(game.playBack.play(t.battlelog,i),this.checkAllAlert(),this.dpt(this.Evts.C2C_CHALLENGE_SUCCEED),i.win)this.dpt(this.Evts.C2C_CHALLENGE_WIN);else{game.zhaoqinData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}1==t.type&&game.teamLeagueAssistData.updateAssistCount(),this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,!0)}},onRespZhaoQinSweep:function(e){var t=e.readProtobuf(game.pb.ZhaoQinSweepResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.layer,i=game.ZhaoQinCfg.getData(a+1);i=i||game.ZhaoQinCfg.getData(a),game.zhaoqinData.maxDifficulty=i.type,game.zhaoqinData.curDifficulty=i.type,game.zhaoqinData.isInitial=!0,game.zhaoqinData.currentLayer=a,game.zhaoqinData.curShowBox=game.zhaoqinData.getMinPrice(game.zhaoqinData.curDifficulty);var n={win:!0,type:game.InstanceType.ZHAO_QIN,rewards:t.useritem};this.checkAllAlert(),b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,n),this.send(this.Evts.SHOWNEXTPRIZELIST),this.send(this.Evts.SWEEP_UPDATEVIEW,game.zhaoqinData.currentLayer)}},onRespZhaoQinCollectAward:function(e){var t=e.readProtobuf(game.pb.ZhaoQinCollectAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.zhaoqinData.addPrize(t.layer),game.zhaoqinData.curShowBox=game.zhaoqinData.getMinPrice(game.zhaoqinData.curDifficulty),this.checkAllAlert(),this.send(this.Evts.UPDATE_PRIZETIPS),this.send(this.Evts.SHOWNEXTPRIZELIST),this.send(this.Evts.CLOSE_PRIZETIPS)},nextBtnRight:function(){if(game.ZhaoQinCfg.getPrizeList(game.zhaoqinData.curShowBox+1)){++game.zhaoqinData.curShowBox,this.send(this.Evts.SHOWNEXTPRIZELIST)}},nextBtnLeft:function(){var e=game.zhaoqinData.curShowBox-1;if(0<e){game.ZhaoQinCfg.getPrizeList(e);--game.zhaoqinData.curShowBox,this.send(this.Evts.SHOWNEXTPRIZELIST)}},gemBoxB_0:function(){this.setShowPrizeData(0)},gemBoxB_1:function(){this.setShowPrizeData(1)},gemBoxB_2:function(){this.setShowPrizeData(2)},onZhaoQinCollectAwardReq:function(e){if(e>=game.zhaoqinData.currentLayer){this.sender.ZhaoQinCollectAwardReq(game.zhaoqinData.showPrizeLayer)}else;},setShowPrizeData:function(e){var t=game.ZhaoQinCfg.getPrizeList(game.zhaoqinData.curShowBox),a=0;if(t){a=t.length}if(e<a){game.zhaoqinData.showPrizeLayer=t[e].layer}game.module.show(game.ME.ZhaoqinPrize)},showRankBtn:function(){game.module.show(game.ME.ZhaoQinRank)},fightBtn:function(){this.isAssist=!1,this.zhaoQinChallengeReq()},assistBtn:function(){game.teamLeagueAssistData.canChallenge()&&(this.isAssist=!0,this.zhaoQinChallengeReq())},zhaoQinChallengeReq:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return game.zhaoqinData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}var e=game.zhaoqinData.currentLayer+1,t=game.ZhaoQinCfg.getData(e);if(t&&!t.lastRound){if(t.type!=game.zhaoqinData.curDifficulty)return game.zhaoqinData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),game.difficultSelectData.curInstType=game.DifficultSelectType.ZHAOQIN,void game.module.show(game.ME.DifficultSelect);if(!game.UpgradeUtil.checkEquipTooMuch()){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return}this.send(this.Evts.V_AUTO_FIGHT_CHANGE),this.sender.ZhaoQinChallengeReq(this.isAssist?1:0)}}},oneKeyBtn:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){this.sender.ZhaoQinSweepReq()}},checkAllAlert:function(){this.checkAlert(),this.checkPassAlert(),this.checkFightAlert(),this.checkTagAlert()},checkAlert:function(){var e=game.zhaoqinData.updataAlert(0);this.zhaoQinAlert.alert=e},checkPassAlert:function(){var e=game.zhaoqinData.updataAlert(1);game.zhaoqinData.setPass(game.zhaoqinData.currentLayer!=game.zhaoqinData.maxLayer),this.zhaoQinAlert.alert=e},checkFightAlert:function(){this.fightAlert.alert=!1},checkTagAlert:function(){this.zhaQinTagAlert.alert=this.zhaoQinAlert.alert||this.fightAlert.alert},reqRankInfo:function(){this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.InsZhaoQin)},updateRankInfo:function(){this.send(this.Evts.UPDATE_RANKVIEW)},sureBtn:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){this.sender.ZhaoQinCollectAwardReq(game.zhaoqinData.showPrizeLayer)}},selectDifficult:function(e){if(e&&e.data){var t=e.data;t.instType==game.DifficultSelectType.ZHAOQIN&&(game.zhaoqinData.curDifficulty=t.difficult,this.send(this.Evts.C2V_UPDATE_VIEW,t.difficult))}},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.YUSHA_SHOP)},awardShow:function(){game.module.show(game.ME.ZhaoQinAward)}}),t=game.Sender.extends({ipc:function(){this.msg={ZhaoQinChallengeReq:this.zhaoQinChallengeReq,ZhaoQinSweepReq:null,ZhaoQinCollectAwardReq:this.reqZhaoQinCollectAward}},reqZhaoQinCollectAward:function(e){var t=game.pb.ZhaoQinCollectAwardRequest;t.layer=e,this.write(t)},zhaoQinChallengeReq:function(e){var t=game.pb.ZhaoQinChallengeRequest;t.type=e,this.write(t)}}),a=[game.ME.ZhaoqinPrize,game.ME.ZhaoQinRank,game.ME.ZhaoQinAward];b8e.module.registerControl(game.ME.ZhaoQin,e,game.ZhaoqinEvts,t,a)}(),function(){var e=b8e.Object.extends({maxLayer:0,currentLayer:0,collected:null,layer:0,maxShow:3,curShowBox:1,showPrizeLayer:0,autoFight:!1,passAlert:!1,curDifficulty:1,maxDifficulty:1,fightTag:0,clearTag:1,isinitial:!1,ctor:function(){this._super()},setup:function(e){if(e){this.maxLayer=e.maxLayer,this.currentLayer=e.currentLayer,this.collected=e.collected,this.curShowBox=Math.ceil(e.maxLayer/9),this.isInitial=!0}},getMaxDifficulty:function(){var e=this.getZhaoqinMaxLayer(),t=this.maxLayer>=e?e:this.maxLayer+1,a=game.ZhaoQinCfg.getData(t);return a?a.type:1},getShowMonsters:function(e){var t=e/this.maxShow|0,a=game.ZhaoQinCfg.getData(e+1);return a&&!a.lastRound&&(t+=1),game.ZhaoQinCfg.getAreaList(t)},addPrize:function(e){if(!this.collected){this.collected=[]}this.collected.push(e)},getMinPrice:function(e){for(var t,a=game.ZhaoQinCfg.getListByType(e),i=a.length,n=0;n<i;n++){var s=a[n].awardGround;if(s){var o=a[n].layer;if(this.collected||(this.collected=[]),!(-1!=this.collected.indexOf(o)))return s;t=s}}return t},updataAlert:function(e){var t=!1;if(this.currentLayer!=this.maxLayer)return!0;var a,i,n=game.ZhaoQinCfg.getLayerAwardList(),s=n.length;switch(e){case this.fightTag:a=this.currentLayer;break;case this.clearTag:a=this.maxLayer}for(var o=0;o<s;o++)if(i=n[o].layer,this.collected&&0<this.collected.length){if(t=-1!=this.collected.indexOf(i),i<=a&&!t)return!0}else if(i<=a)return!0;return!1},setPass:function(e){this.passAlert=e},getZhaoqinMaxLayer:function(){if(this._zhaoqinMaxLayer)return this._zhaoqinMaxLayer;var e=game.InstanceMiscCfg.getData("ZhaoqinMaxLayer");return e?(this._zhaoqinMaxLayer=0|+e.value,this._zhaoqinMaxLayer):0},getZhaoqinMaxLevel:function(){if(this.zhaoqinMaxLevel)return this.zhaoqinMaxLevel;var e=game.InstanceMiscCfg.getData("zhaoqinMaxLevel");return e?(this.zhaoqinMaxLevel=e.value,this.zhaoqinMaxLevel):0},getLangKey:function(e){if(!this.langKeyArr){var t=game.InstanceMiscCfg.getData("zhaoqinLangKey");if(!t)return null;this.langKeyArr=t.value.split("|")}return this.langKeyArr[e]},getLastAwardLayer:function(){return 0|+game.InstanceMiscCfg.getData("zhaoqinLastAward").value},getAwardList:function(){if(this._showAward&&0<this._showAward.length)return this._showAward;this._showAward=[];var e=game.ZhaoQinAwardCfg.getDatas();if(e){for(var t=void 0,a=void 0,i=0,n=e.length;i<n;i++)(t=e[i])&&((a=new game.ZhaoqinAwardInfo).setCfgData(t),this._showAward.push(a));return this._showAward}}});game.zhaoqinData=game.zhaoqinData||new e}(),function(){var e;e=b8e.Object.extends({cfgId:0,items:null,ctor:function(){this._super(),this.items=[]},setup:function(e){for(var t=this.items.length=0,a=e.length;t<a;t++){var i=game.ItemUtil.createBaseItemInfo(e[t].Id,e[t].Num);this.items.push(i)}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ZhaoqinPrizeInfo",e)}(),function(){var e;e=b8e.Object.extends({layer:0,award:0,desc:"",setCfgData:function(e){this.layer=e.layer,this.award=e.award,this.desc=e.desc}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ZhaoqinAwardInfo",e)}(),function(){var e=game.View.extends({_modelList:null,_barwidthList:null,barWidth:514,ctor:function(){this._super(1155),this.spotAlerts={ZHAOQIN_FIGHT:this.fightAlert},this._modelList=[],this._barwidthList=[]},notify:function(e,t){var a=this;switch(e){case a.Evts.SHOWNEXTPRIZELIST:a.updatePrizeBox();break;case a.Evts.V_AUTO_FIGHT_CHANGE:a.autoFightChange();break;case a.Evts.DAILY_UPDATE:a.daily_update();break;case a.Evts.SWEEP_UPDATEVIEW:a.updateView(t);break;case a.Evts.C2V_UPDATE_VIEW:var i=a.difficultyMaxLayer(t)-1;a.updateView(i),a.showDifficultyBtn(),game.zhaoqinData.curShowBox=game.zhaoqinData.getMinPrice(t),a.updatePrizeBox()}},init:function(){var e=this;e.zhaoqinBg=b8e.Sprite.get(),e.zhaoqinBg.setAnchor(.5,.5),e.zhaoqinBg.addToParent(e.skin.zhaoqinBg),e.zhaoqinBg.loadTexture(game.ResCfg.getUrl(57));for(var t=0;t<3;++t){var a;(a=b8e.SceneEntity.get()).addToParent(this.getComponent("monModel_"+t)),this._modelList.push(a)}var i,n=game.zhaoqinData.currentLayer;i=n<game.zhaoqinData.getZhaoqinMaxLayer()?game.ZhaoQinCfg.getData(n+1):game.ZhaoQinCfg.getData(n),e.zhaoqinTitle=b8e.Sprite.get(),e.zhaoqinTitle.setAnchor(.5,.5),e.zhaoqinTitle.addToParent(e.skin.title),e.zhaoqinTitle.loadTexture(game.ResCfg.getUrl(77,i.type)),e.insAutoTime=game.CfgUtil.getInsAutoTimeSpace(),e.insAutoTimeDesc=game.CfgUtil.getInsAutoTime()},daily_update:function(){var e=game.zhaoqinData.currentLayer,t=game.ZhaoQinCfg.getData(e+1);t=t||game.ZhaoQinCfg.getData(e),this.zhaoqinTitle.loadTexture(game.ResCfg.getUrl(77,t.type))},fightAlert:function(e){this.skin.redFight.node.active=e.alert},onShow:function(){var e=game.zhaoqinData.currentLayer,t=game.zhaoqinData.maxLayer,a=game.zhaoqinData.isInitial;a&&t<=e&&0<e&&(e-=1,game.zhaoqinData.isInitial=!1);var i=game.ZhaoQinCfg.getData(e+1),n=a?i.type:game.zhaoqinData.maxDifficulty,s=a?i.type:game.zhaoqinData.curDifficulty,o=this.difficultyMaxLayer(s)-1;if(i=i||game.ZhaoQinCfg.getData(e),0<e){i.type==n&&i.type==s?this.updateView(e):i.type>n&&i.type!=s?this.updateView(e-1):s<n?this.updateView(o):this.updateView(e)}else this.updateView(e);game.zhaoqinData.curShowBox=game.zhaoqinData.getMinPrice(game.zhaoqinData.curDifficulty),this.updatePrizeBox(),this.autoFightChange(),this.skin.shopBtn.active=game.shopData.getOpenByShopId(game.ShopIdEnum.EQUIP_SHOP)},updateView:function(e){var t=this,a=this.skin,n=game.zhaoqinData.getShowMonsters(e),i=e+1;a.pointIcon.node.active=!1;for(var s=0;s<n.length;++s){if(this.getComponent("finish_"+s).node.active=game.zhaoqinData.currentLayer>=n[s].layer,this.getComponent("instanceName"+s).string=game.Lang.get(9524,n[s].layer),s<this._modelList.length&&function(){var i=t;game.CfgUtil.getMonsterCfgByMonGroup(n[s].monGroup,1,function(a){return function(e){var t=game.AvatarUtil.getUIModel(e,0,!1);i.setAnim(game.ResCfg.getUrl(5e3,t),i._modelList[a]),i.setElementBtn(e,a)}}(s),i)}(),n[s].layer==i){a.pointIcon.node.x=this.getComponent("finish_"+s).node.x,a.pointIcon.node.active=!0}}this.showDifficultyBtn(),this.zhaoqinTitle.loadTexture(game.ResCfg.getUrl(77,game.zhaoqinData.curDifficulty));var o=game.ZhaoQinCfg.getMonsterText();if(o&&0<o.length){var r,g;this.matCostIcon||(this.matCostIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),this.matCostIcon.setPosition(0,0),this.matCostIcon.addToParent(a.award_node));for(var l=0;l<o.length;l++)if(g=o[l],game.zhaoqinData.maxLayer<g.layer){r=game.ItemInfoCfg.getData(g.showAward);break}if(r){this.matCostIcon.setItemInfo(r,!1,!1);var c=game.HtmlUtil.getColorByQuality(r.quality,!1);this.matCostIcon.setName(r.name,c)}if(game.zhaoqinData.maxLayer>o[o.length-1].layer){return a.monsterTIps.string="",void(a.talkBox.node.active=!1)}for(s=0;s<o.length;++s){if(game.zhaoqinData.maxLayer<o[s].layer){return void(a.monsterTIps.string=o[s].text)}}}else a.monsterTIps.string="",a.talkBox.node.active=!1},difficultyMaxLayer:function(e){var t=game.ZhaoQinCfg.getListByType(e),a=t[t.length-1].layer;return a<=game.zhaoqinData.maxLayer?a:t[0].layer},autoFightChange:function(){var e=this,t=game.zhaoqinData.autoFight;e.skin.autoBg_2.node.active=t;game.InstanceMiscCfg.getData("instanceAutoTime").value;if(t){if(e.autoFightEndTime=game.SysTime.curTime+this.insAutoTime,!e.autoFightTimer){e.autoFightTimer=b8e.Timer.add(e,e.updateFightTime,500)}e.autoFightTimer.reset(),e.autoFightTimer.start(),e.skin.autoTips.string=game.Lang.get(5305,this.insAutoTimeDesc)}else{if(e.autoFightTimer){e.autoFightTimer.stop()}e.skin.autoTips.string=game.Lang.get(5306)}},updateFightTime:function(){var e=this,t=e.autoFightEndTime-game.SysTime.curTime;if(0<t){e.skin.autoTips.string=game.Lang.get(5305,t/1e3>>0)}else e.autoFightTimer.stop(),e.skin.autoTips.string=game.Lang.get(5307),e.send(e.Evts.V_START_FIGHT)},updatePrizeBox:function(){var e=this,t=e.skin,a=game.ZhaoQinCfg.getPrizeList(game.zhaoqinData.curShowBox),i=0;a&&(i=a.length),a.sort(e._sortLayer);for(var n,s=!1,o=0;o<3;++o)e.getComponent("iconBG"+o).node.active=o<i,e.getComponent("redPoint_"+o).node.active=!1,o<i?(e.getComponent("progressLab"+o).string=game.Lang.get(9524,a[o].layer),game.zhaoqinData.collected&&0<game.zhaoqinData.collected.length?(s=-1!=game.zhaoqinData.collected.indexOf(a[o].layer),e.getComponent("geted"+o).node.active=s,e.getComponent("redPoint_"+o).node.active=game.zhaoqinData.currentLayer>=a[o].layer&&!s):(e.getComponent("geted"+o).node.active=!1,e.getComponent("redPoint_"+o).node.active=game.zhaoqinData.currentLayer>=a[o].layer),e.getComponent("progressIcon_"+o).node.active=game.zhaoqinData.currentLayer>=a[o].layer):e.getComponent("progressLab"+o).string="";t.curInstanceName.string=game.Lang.get(9524,game.zhaoqinData.maxLayer);var r,g=game.zhaoqinData.curShowBox-1;if(g){var l=game.ZhaoQinCfg.getPrizeList(g);r=l[l.length-1].layer}else r=0;var c,h,m,u,d=a[i-1].layer;if(game.zhaoqinData.maxLayer>d&&(n=514),!n)for(var f=0;f<i;f++){if(h=a[f].layer,f<i-1&&a[f+1].layer,0<f&&(c=a[f-1].layer),game.zhaoqinData.maxLayer<=h)switch(f){case 0:n=60/(m=h-r)*(u=m-(h-game.zhaoqinData.maxLayer));break;case 1:u=(m=h-c)-(h-game.zhaoqinData.maxLayer),n=Math.floor(200/m)*u+60;break;case 2:u=(m=h-c)-(h-game.zhaoqinData.maxLayer),n=Math.floor(200/m)*u+260}if(n){450<n&&(n=514),n<0&&(n=0);break}}if(t.bar_0.node.width=n,0<game.zhaoqinData.currentLayer){var p=game.ZhaoQinCfg.getPrizeList(game.zhaoqinData.curShowBox-1);p&&p[0].type!=game.zhaoqinData.curDifficulty&&(p=!1),t.nextBtnLeft.node.active=!!p}else t.nextBtnLeft.node.active=!1;if(0<game.zhaoqinData.currentLayer){var _=game.ZhaoQinCfg.getPrizeList(game.zhaoqinData.curShowBox+1),v=!1;if(_&&(v=_[0].type==game.zhaoqinData.curDifficulty),v){var E=game.CfgUtil.getZhaoqinLastLayer();v=!(game.zhaoqinData.curShowBox==E)}t.nextBtnRight.node.active=v}else t.nextBtnRight.node.active=!1;var C=game.zhaoqinData.getLastAwardLayer();t.talkBox.active=game.zhaoqinData.maxLayer<C,e.updataPassAlert()},_sortLayer:function(e,t){return e.layer-t.layer},setAnim:function(e,t){var a;if(e){if(!(a=t.getAnimator(game.AnimType.BODY,1))){a=t.addAnimator(game.AnimType.BODY,1)}a.load(e),a.play()}else if(a){a.clear()}},onHide:function(){for(var e,t=0;t<this._modelList.length;++t){if(e=this._modelList[t].getAnimator(game.AnimType.BODY,1)){e.clear()}}var a=this;if(a.autoFightTimer){a.autoFightTimer.stop()}a.skin.autoTips.string=game.Lang.get(5306)},onStageResize:function(){this.setPosition(0,-0)},updataPassAlert:function(){this.skin.redPass.active=game.zhaoqinData.passAlert},updataClickAnim:function(){var e=this.skin;if(!this.proAnim){this.proAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1);this.proAnim.addToParent(e.nextNode),this.proAnim.load(game.ResCfg.getUrl(5019,1001)),this.proAnim.setPosition(545,-45)}this.proAnim.play()},showDifficultyBtn:function(){var e=game.zhaoqinData.curDifficulty,t=game.ResCfg.getUrl(5033,e);this.skin.viewLevelBtn.loadTexture(t)},viewLevelBtn:function(){game.difficultSelectData.curInstType=game.DifficultSelectType.ZHAOQIN,game.module.show(game.ME.DifficultSelect)},setElementBtn:function(e,t){var a=this.getComponent("view_elementBtn_"+t);e&&e.element?(this.element||(this.element=[]),this.element[t]=e.element,a.active=!0,a.loadTexture(game.ResCfg.getUrl(10050,e.element))):a.active=!1},view_elementBtn_0:function(){this.clickElementBtn(0)},view_elementBtn_1:function(){this.clickElementBtn(1)},view_elementBtn_2:function(){this.clickElementBtn(2)},clickElementBtn:function(e){if(this.element||!(this.element.length<1)){var t=this.getComponent("view_elementBtn_"+e),a=this.element[e];game.elementData.setElementInfo(a,50369,t.localToGlobal(),!1),game.module.show(game.ME.ElementAttr)}}});b8e.module.registerView(game.ME.ZhaoQin,e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(1156),this.spotAlerts={}},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid);e.itemRender=game.PrizeListItem,e.layout.paddingLeft=20,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingX=58,e.addToParent(this.skin.prizeNode)},notify:function(e){switch(e){case this.Evts.UPDATE_PRIZETIPS:this.updateView();break;case this.Evts.CLOSE_PRIZETIPS:this.closeBtn()}},onShow:function(){this.updateView(),game.TweenUtil.rotationEffect(this.skin.light)},updateView:function(){var e=game.zhaoqinData.showPrizeLayer,t=game.ZhaoQinCfg.getData(e);if(t){this.skin.prizetips.string=game.Lang.get(6615,t.layer);var a=game.CfgUtil.getPrizeListInfo(t.layerAward,3);this.resetPrizeList(a.items.length),this.list.setData(a.items)}var i=game.zhaoqinData.currentLayer>=e,n=!1;game.zhaoqinData.collected&&(n=-1!=game.zhaoqinData.collected.indexOf(e)),this.skin.sureBtn.node.active=i&&!n,this.skin.huawen_3.width=b8e.stageWidth+100,this.skin.huawen_1.width=b8e.stageWidth+100},onHide:function(){b8e.Tween.kill(this.skin.light)},closeBtn:function(){game.module.hide(this.moduleEnum)},resetPrizeList:function(e){var t=this.skin,a=void 0;switch(e){case 1:a=-80;break;case 2:a=-145;break;case 3:a=-215;break;default:a=-295}this._isMore=4<e,this.list.setSize(560,this._isMore?300:140),t.prizeNode.setPosition(a,54),t.pathNode.setPosition(0,this._isMore?-350:-250),this.onStageResize()},onStageResize:function(){var e=this._isMore?190:100;this.setPosition(b8e.stageWidth/2,b8e.stageHeight/2+e),this.skin.gray.setSize(b8e.stageWidth+50,this._isMore?524:424),game.viewModule.updateLayout(this)}});b8e.module.registerView(game.ME.ZhaoqinPrize,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1157),this.setSize(540,94)},setData:function(){this.onClear();var e=this.data;if(e){var t=this.skin;t.rank.node.active=3<e.rank,t.rank.string=e.rank+"",t.name.string=e.name,t.power.string=e.power+"",t.instancenum.string=e.score+"";var a=e.rank;3<a?t.rank4.node.active=!0:this.getComponent("rank"+a).node.active=!0}else;},onClear:function(){for(var e=1;e<5;e++){this.getComponent("rank"+e).node.active=!1}}}),b8e.RC("$$game","$$ZhaoQinRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(1158),this.spotAlerts={}},init:function(){var e=this;e.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.rankList.itemRender=game.ZhaoQinRankItem,e.rankList.bindEnum=game.ME.ZhaoQinRank,e.rankList.layout.paddingLeft=0,e.rankList.layout.paddingRight=0,e.rankList.layout.paddingTop=0,e.rankList.layout.spacingX=15,e.rankList.layout.spacingY=5,e.rankList.addToParent(e.skin.listNode)},notify:function(e){switch(e){case this.Evts.UPDATE_RANKVIEW:this.updateView()}},onShow:function(){this.send(this.Evts.V_REQ_RANKINFO)},updateView:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.InsZhaoQin);this.rankList.setData(e);var t=game.rankData.getSelfRankInfo(game.RankType.InsZhaoQin);if(t){this.skin.rankNum.string=0==t.rank?game.Lang.get(9069):t.rank,this.skin.instanceNum.string=t.score}}});b8e.module.registerView(game.ME.ZhaoQinRank,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1407),this.setSize(540,136)},init:function(){this._icon=game.GridUtil.createItemIcon(),this._icon.setAnchor(.5,.5),this._icon.addToParent(this.skin.head)},setData:function(e){var t=this.skin,a=game.ItemUtil.createBaseItemInfo(e.award,1);this._icon.setItemInfo(a,!1,game.IconLayoutEnum.SHOW_NONE);var i=game.ItemInfoCfg.getData(e.award);i&&(t.name.string=game.HtmlUtil.getColorStrByQuality(i.quality,i.name),t.desc.string=e.desc,t.layer.string=game.Lang.get(51895,e.layer))}}),b8e.RC("$$game","$$ZhaoQinAwardItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1406)},init:function(){var e=this;e.List=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.List.itemRender=game.ZhaoQinAwardItem,e.List.bindEnum=e.moduleEnum,e.List.layout.paddingLeft=0,e.List.layout.paddingRight=0,e.List.layout.paddingTop=0,e.List.layout.spacingX=15,e.List.layout.spacingY=5,e.List.addToParent(e.skin.listNode)},onShow:function(){this.updateView()},updateView:function(){var e=game.zhaoqinData.getAwardList();this.List.setData(e)}});b8e.module.registerView(game.ME.ZhaoQinAward,e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_STATE:-1,V2C_GET_PRIZE:-1,V2C_SHOW_VIEW:-1,C2V_UPDATE_LIST:-1}),b8e.RC("$$game","$$PveEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.infoList=[],this.awardList=[],this.progressMap=b8e.HashMap.get(),this.openServerMap=b8e.HashMap.get(),this.infoMap=b8e.HashMap.get(),this.mergeInfoMap=b8e.HashMap.get()},initDataByType:function(e){var t=game.ProgressActivityCfg.getListByType(e);if(!t||t.length<1)return!1;for(var a,i,n=[],s=[],o=game.miscData.openServerDay,r=game.miscData.serverMergeDays,g=0,l=t.length;g<l;g++)o>=(i=t[g]).serverStart&&o<i.serverEnd&&((a=new game.PveInfo).setData(i),n.push(a)),r>=i.mergeStart&&r<i.mergeEnd&&((a=new game.PveInfo).setData(i),s.push(a));this.infoMap.set(e,n),this.mergeInfoMap.set(e,s)},getOSIsOpen:function(e){var t=this.infoMap.get(e);return t&&0<t.length},getMSIsOpne:function(e){var t=this.mergeInfoMap.get(e);return t&&0<t.length},setPveAward:function(e){if(e)this.awardList=e,this.checkAllAlert();else;},setAwardSuccess:function(e,t){this.awardList.push(e),this.checkAlert(t)},isGetAward:function(e){return-1<this.awardList.indexOf(e)},getInfoList:function(e){var t=this.infoMap.get(e);if(!t||t.length<1){return null}return t.sort(this.onSort),t},getMergeInfoList:function(e){var t=this.mergeInfoMap.get(e);return!t||t.length<1?null:(t.sort(this.onSort),t)},onSort:function(e,t){if(e.isGet&&!t.isGet){return 1}if(!e.isGet&&t.isGet){return-1}if(e.canGet&&!t.canGet){return-1}if(e.canGet||!t.canGet)return e.id-t.id;return 1},getInfoByType:function(e){var t=this.infoMap.get(e);if(!t||t.length<1){return null}return t[0]},getMergeInfoByType:function(e){var t=this.mergeInfoMap.get(e);return!t||t.length<1?null:t[0]},checkAllAlert:function(){var e=this,t=e.infoMap.keys();if(t&&0<t.length)for(var a=t.length,i=0;i<a;i++)n=t[i],e.checkAlert(n);if((t=e.mergeInfoMap.keys())&&0<t.length){var n;for(a=t.length,i=0;i<a;i++)n=t[i],e.checkMergeAlert(n)}},checkMergeAlert:function(e){var t=this.mergeInfoMap.get(e);if(!t||t.length<1)return!1;for(var a,i,n,s=!1,o=t.length,r=0;r<o;r++)i=(a=t[r]).cfg,n=game.PveUtil.getModuleConditionValue(a.activityType),a.canGet=a.activityType==game.PveType.ARENA?n<=i.condition:n>=i.condition,a.isGet=this.isGetAward(a.id),a.canGet&&!a.isGet&&(s=!0);return s},checkAlert:function(e){var t=this.infoMap.get(e);if(!t||t.length<1){return!1}for(var a,i,n,s=!1,o=t.length,r=0;r<o;r++){if(i=(a=t[r]).cfg,n=game.PveUtil.getModuleConditionValue(a.activityType),a.canGet=a.activityType==game.PveType.ARENA?n<=i.condition:n>=i.condition,a.isGet=this.isGetAward(a.id),a.canGet&&!a.isGet){s=!0}}return s}});game.pveData=game.pveData||new e}(),function(){var e;e=b8e.Object.extends({cfg:null,num:0,id:0,isGet:!1,canGet:!1,activityType:0,lv:0,serverEnd:0,mergeEnd:0,setData:function(e){this.cfg=e,this.id=e.id,this.lv=e.lv,this.serverEnd=e.serverEnd,this.mergeEnd=e.mergeEnd,this.activityType=e.activityType},getPrizeList:function(){var e=this;if(e.award){return e.award}e.award=[];for(var t,a,i=e.cfg.award,n=i.length,s=0;s<n;s++){t=i[s],a=game.ItemUtil.createBaseItemInfo(t.Id,t.Num),e.award.push(a)}return e.award}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$PveInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,MAININS:1,XIANDI:2,MATERIAL:3,ARENA:4,ZHANJIANG:5,XIANDISTAR:6,ZHAOQIN:7,FORGEUPGRADE:9,FORGEREFINE:10,FORGEPURIFY:11,FORGEGEM:12,PET:13,JIANGHUN:14,GUOSHI:15,WANSHOU:16,CBP:17}),b8e.RC("$$game","$$PveType",e)}(),function(){var e=game.Control.extends({initPveData:!1,init:function(){var e=this;e.mainInsSpotAlert=game.spotAlert.set(game.SAE.PVE_MAININS,game.SAE.OPEN_SERVER_ALERT),e.xiandiSpotAlert=game.spotAlert.set(game.SAE.PVE_XIANDI,game.SAE.OPEN_SERVER_ALERT),e.materialSpotAlert=game.spotAlert.set(game.SAE.PVE_MATERIAL,game.SAE.OPEN_SERVER_ALERT),e.arenaSpotAlert=game.spotAlert.set(game.SAE.PVE_ARENA,game.SAE.OPEN_SERVER_ALERT),e.zhanjiangSpotAlert=game.spotAlert.set(game.SAE.PVE_ZHANJIANG,game.SAE.OPEN_SERVER_ALERT),e.xiandiStarSpotAlert=game.spotAlert.set(game.SAE.PVE_XIANDISTAR,game.SAE.OPEN_SERVER_ALERT),e.zhaoqinSpotAlert=game.spotAlert.set(game.SAE.PVE_ZHAOQIN,game.SAE.OPEN_SERVER_ALERT),e.forgeUpgradeSpotAlert=game.spotAlert.set(game.SAE.PVE_FORGEUPGRADE,game.SAE.OPEN_SERVER_ALERT),e.forgeRefineSpotAlert=game.spotAlert.set(game.SAE.PVE_FORGEREFINE,game.SAE.OPEN_SERVER_ALERT),e.forgePurifySpotAlert=game.spotAlert.set(game.SAE.PVE_FORGEPURIFY,game.SAE.OPEN_SERVER_ALERT),e.forgeGemSpotAlert=game.spotAlert.set(game.SAE.PVE_FORGEGEM,game.SAE.OPEN_SERVER_ALERT),e.petSpotAlert=game.spotAlert.set(game.SAE.PVE_PET,game.SAE.OPEN_SERVER_ALERT),e.jianghunSpotAlert=game.spotAlert.set(game.SAE.PVE_JIANGHUN,game.SAE.OPEN_SERVER_ALERT),e.guoshiSpotAlert=game.spotAlert.set(game.SAE.PVE_GUOSHI,game.SAE.OPEN_SERVER_ALERT),e.wanshouSpotAlert=game.spotAlert.set(game.SAE.PVE_WANSHOU,game.SAE.OPEN_SERVER_ALERT),e.cbpSpotAlert=game.spotAlert.set(game.SAE.PVE_CBP,game.SAE.OPEN_SERVER_ALERT),e.mergeMainInsSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_MAININS,game.SAE.MERGE_SERVER_ALERT),e.mergeXiandiSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_XIANDI,game.SAE.MERGE_SERVER_ALERT),e.mergeMaterialSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_MATERIAL,game.SAE.MERGE_SERVER_ALERT),e.mergeArenaSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_ARENA,game.SAE.MERGE_SERVER_ALERT),e.mergeZhanjiangSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_ZHANJIANG,game.SAE.MERGE_SERVER_ALERT),e.mergeXiandiStarSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_XIANDISTAR,game.SAE.MERGE_SERVER_ALERT),e.mergeZhaoqinSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_ZHAOQIN,game.SAE.MERGE_SERVER_ALERT),e.mergeForgeUpgradeSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_FORGEUPGRADE,game.SAE.MERGE_SERVER_ALERT),e.mergeForgeRefineSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_FORGEREFINE,game.SAE.MERGE_SERVER_ALERT),e.mergeForgePurifySpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_FORGEPURIFY,game.SAE.MERGE_SERVER_ALERT),e.mergeForgeGemSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_FORGEGEM,game.SAE.MERGE_SERVER_ALERT),e.mergePetSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_PET,game.SAE.MERGE_SERVER_ALERT),e.mergeJianghunSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_JIANGHUN,game.SAE.OPEN_SERVER_ALERT),e.mergeGuoshiSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_GUOSHI,game.SAE.OPEN_SERVER_ALERT),e.mergeWanshouSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_WANSHOU,game.SAE.OPEN_SERVER_ALERT),e.mergeCbpSpotAlert=game.spotAlert.set(game.SAE.MERGE_PVE_CBP,game.SAE.OPEN_SERVER_ALERT)},ipc:function(){var e=this;e.evts={MainRole:{C_RESET_DAILY:e.resetDaily},OpenServer:{C2C_INIT_OPENSERVER:e.initOpenServer},MainInstance:{C_GET_MAIN_INSTANCE_AWARDS:e.mainInsCheckAlert},BaoZang:{C2C_SYS_DATA_SUCCEED:e.xiandiCheckAlert,C2C_CHALLENGE_SUCCEED:e.xiandiCheckAlert},Arena:{C2C_SYS_DATA_SUCCEED:e.arenaCheckAlert,C2C_CHALLENGE_SUCCEED:e.arenaCheckAlert},InstanceMaterial:{C2C_SYS_DATA_SUCCEED:e.materialCheckAlert,C2C_UPDATE_FINISH_COUNT:e.materialCheckAlert},ZhanJiang:{C2C_UPDATE_LAYER:e.zhanjiangCheckAlert},ZhaoQin:{C2C_SYS_DATA_SUCCEED:e.zhaoqinCheckAlert,C2C_CHALLENGE_SUCCEED:e.zhaoqinCheckAlert},EquipGem:{C2C_FORGE_SUCCEED:e.forgeGemCheckAlert,C2C_INIT_DATA:e.forgeGemCheckAlert},EquipIntensify:{C2C_FORGE_SUCCEED:e.forgeUpgradeCheckAlert,C2C_INIT_DATA:e.forgeUpgradeCheckAlert},EquipPurify:{C2C_FORGE_SUCCEED:e.forgePurifyCheckAlert,C2C_INIT_DATA:e.forgePurifyCheckAlert},EquipRefine:{C2C_FORGE_SUCCEED:e.forgeRefineCheckAlert,C2C_INIT_DATA:e.forgeRefineCheckAlert},GuoshiChallenge:{C2C_BATTLE_RESULT:e.guoshiCheckAlert},Instance:{SYNC_INSTANCE_DATA:e.checkInstanceAlert},GeneralBoss:{C2C_BATTLE_RESULT:e.jianghunCheckAlert},Hunting:{C2C_SYS_DATA_SUCCEED:e.wanshouCheckAlert,C2C_UPDATE_AUTOFIGHT:e.wanshouCheckAlert},ChallengeCbp:{C_UPDATE_DATA:e.cbpCheckAlert},EnemyTeam:{C_UPDATE_CHALLENGE:e.cbpCheckAlert}},e.handels={ProgressActivityResp:e.onProgressActivityRsp}},notify:function(e,t){switch(e){case this.Evts.V2C_GET_PRIZE:this.sender.ProgressActivityReq(t)}},onProgressActivityRsp:function(e){var t=e.readProtobuf(game.pb.ProgressActivityResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.ProgressActivityCfg.getDataById(t.id);if(a){var i=a.activityType;game.pveData.setAwardSuccess(t.id,i),this.checkAlert(i),this.send(this.Evts.C2V_UPDATE_LIST)}else{b8e.warn("\u6ca1\u6709\u8fd9\u4e2aid\u7684\u914d\u7f6e:"+t.id)}}},initOpenServer:function(e){if(game.moduleOpen.checkOpen(this.moduleEnum)){var t=e.data;game.pveData.setPveAward(t.progressActivity),this.initData()}else;},triggerOpen:function(e){e==this.moduleEnum&&this.initData()},resetDaily:function(){if(game.moduleOpen.checkOpen(this.moduleEnum))this.initPveData=!1,this.initData(),this.checkAllAlert();else;},checkAllAlert:function(){var e=game.pveData.infoMap,t=game.pveData.mergeInfoMap;if(e&&t){var a=e.keys();if(a&&!(a.length<1))for(var i=void 0,n=void 0,s=a.length,o=0;o<s;o++)i=+a[o],(n=e.get(i))&&0<n.length?this.checkAlert(i):(n=t.get(i))&&0<n.length&&this.checkAlert(i)}},initData:function(){var e=this;if(!e.initPveData){e.initPveData=!0;var t=game.ProgressActivityCfg.getKeys("activityType");if(t&&!(t.length<1)){game.miscData.openServerDay;var a,i,n,s,o=t.length,r=game.OpenServerType.PVE;for(e.tempList||(e.tempList=[]),e.tempList.length=0,e.mergeTempList||(e.mergeTempList=[]),a=e.mergeTempList.length=0;a<o;a++){i=t[a],game.pveData.initDataByType(i);var g=game.pveData.getOSIsOpen(i),l=game.pveData.getMSIsOpne(i);if(game.OpenServerClientCfg.getData(r,i)){var c={openServerType:r,type:0,isActive:!0,sae:0,param:0},h={openServerType:r,type:0,isActive:!0,sae:0,param:0};h.type=c.type=i,h.param=c.param=i,n=e.getSpotAlertEnum(i),s=e.getSpotAlertEnum(i,!0),c.sae=n,h.sae=s,c.isActive=g,h.isActive=l,e.tempList.push(c),e.mergeTempList.push(h)}}e.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER_LIST,e.tempList),e.dptG(game.MergeServerGEvts.C2C_CHANGE_MERGESERVER_LIST,e.mergeTempList)}}},gotoBtn:function(){var e=game.openServerData.getCurBtnInfo();if(e){var t=e.getCfg();if(t){if(game.moduleOpen.checkOpen(t.moduleEnum)){game.GameViewMgr.inst().hideUnStrongViews(!1)}if(t.toggleIndex){game.module.showToggle(t.moduleEnum,t.toggleIndex-1)}else game.module.showToggle(t.moduleEnum)}else;}else;},getSpotAlertEnum:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=game.PveType,n=game.SAE;switch(e){case i.MAININS:return a?n.MERGE_PVE_MAININS:n.PVE_MAININS;case i.XIANDI:return a?n.MERGE_PVE_XIANDI:n.PVE_XIANDI;case i.MATERIAL:return a?n.MERGE_PVE_MATERIAL:n.PVE_MATERIAL;case i.ARENA:return a?n.MERGE_PVE_ARENA:n.PVE_ARENA;case i.ZHANJIANG:return a?n.MERGE_PVE_ZHANJIANG:n.PVE_ZHANJIANG;case i.XIANDISTAR:return a?n.MERGE_PVE_XIANDISTAR:n.PVE_XIANDISTAR;case i.ZHAOQIN:return a?n.MERGE_PVE_ZHAOQIN:n.PVE_ZHAOQIN;case i.FORGEUPGRADE:return a?n.MERGE_PVE_FORGEUPGRADE:n.PVE_FORGEUPGRADE;case i.FORGEREFINE:return a?n.MERGE_PVE_FORGEREFINE:n.PVE_FORGEREFINE;case i.FORGEPURIFY:return a?n.MERGE_PVE_FORGEPURIFY:n.PVE_FORGEPURIFY;case i.FORGEGEM:return a?n.MERGE_PVE_FORGEGEM:n.PVE_FORGEGEM;case i.PET:return a?n.MERGE_PVE_PET:n.PVE_PET;case i.JIANGHUN:return a?n.PVE_JIANGHUN:n.MERGE_PVE_JIANGHUN;case i.GUOSHI:return a?n.PVE_GUOSHI:n.MERGE_PVE_GUOSHI;case i.WANSHOU:return a?n.PVE_WANSHOU:n.MERGE_PVE_WANSHOU;case i.CBP:return a?n.PVE_CBP:n.MERGE_PVE_CBP}},mainInsCheckAlert:function(){this.checkAlert(game.PveType.MAININS)},xiandiCheckAlert:function(){this.checkAlert(game.PveType.XIANDI),this.checkAlert(game.PveType.XIANDISTAR)},arenaCheckAlert:function(){this.checkAlert(game.PveType.ARENA)},materialCheckAlert:function(){this.checkAlert(game.PveType.MATERIAL)},zhanjiangCheckAlert:function(){this.checkAlert(game.PveType.ZHANJIANG)},zhaoqinCheckAlert:function(){this.checkAlert(game.PveType.ZHAOQIN)},forgeUpgradeCheckAlert:function(){this.checkAlert(game.PveType.FORGEUPGRADE)},forgeRefineCheckAlert:function(){this.checkAlert(game.PveType.FORGEREFINE)},forgePurifyCheckAlert:function(){this.checkAlert(game.PveType.FORGEPURIFY)},forgeGemCheckAlert:function(){this.checkAlert(game.PveType.FORGEGEM)},petCheckAlert:function(){this.checkAlert(game.PveType.PET)},guoshiCheckAlert:function(){this.checkAlert(game.PveType.GUOSHI)},checkInstanceAlert:function(){this.checkAlert(game.PveType.GUOSHI),this.checkAlert(game.PveType.JIANGHUN)},jianghunCheckAlert:function(){this.checkAlert(game.PveType.JIANGHUN)},wanshouCheckAlert:function(){this.checkAlert(game.PveType.WANSHOU)},cbpCheckAlert:function(){this.checkAlert(game.PveType.CBP)},checkAlert:function(e){var t=this,a=game.PveType,i=game.pveData.checkAlert(e),n=game.pveData.checkMergeAlert(e);switch(e){case a.MAININS:t.mainInsSpotAlert.alert=i,t.mergeMainInsSpotAlert.alert=n;break;case a.XIANDI:t.xiandiSpotAlert.alert=i,t.mergeXiandiSpotAlert.alert=n;break;case a.MATERIAL:t.materialSpotAlert.alert=i,t.mergeMaterialSpotAlert.alert=n;break;case a.ARENA:t.arenaSpotAlert.alert=i,t.mergeArenaSpotAlert.alert=n;break;case a.ZHANJIANG:t.zhanjiangSpotAlert.alert=i,t.mergeZhanjiangSpotAlert.alert=n;break;case a.XIANDISTAR:t.xiandiStarSpotAlert.alert=i,t.mergeXiandiStarSpotAlert.alert=n;break;case a.ZHAOQIN:t.zhaoqinSpotAlert.alert=i,t.mergeZhaoqinSpotAlert.alert=n;break;case a.FORGEUPGRADE:t.forgeUpgradeSpotAlert.alert=i,t.mergeForgeUpgradeSpotAlert.alert=n;break;case a.FORGEREFINE:t.forgeRefineSpotAlert.alert=i,t.mergeForgeRefineSpotAlert.alert=n;break;case a.FORGEPURIFY:t.forgePurifySpotAlert.alert=i,t.mergeForgePurifySpotAlert.alert=n;break;case a.FORGEGEM:t.forgeGemSpotAlert.alert=i,t.mergeForgeGemSpotAlert.alert=n;break;case a.PET:t.petSpotAlert.alert=i,t.mergePetSpotAlert.alert=n;break;case a.JIANGHUN:t.jianghunSpotAlert.alert=i,t.mergeJianghunSpotAlert.alert=n;break;case a.GUOSHI:t.guoshiSpotAlert.alert=i,t.mergeGuoshiSpotAlert.alert=n;break;case a.WANSHOU:t.wanshouSpotAlert.alert=i,t.mergeWanshouSpotAlert.alert=n;break;case a.CBP:t.cbpSpotAlert.alert=i,t.mergeCbpSpotAlert.alert=n}t.send(t.Evts.C2V_UPDATE_STATE)}}),t=[game.ME.MergePve],a=game.Sender.extends({ipc:function(){this.msg={ProgressActivityReq:this.progressActivityReq}},progressActivityReq:function(e){var t=game.pb.ProgressActivityRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.Pve,e,game.PveEvts,a,t)}(),function(){var s=game.PveUtil=function(){};s.getModuleConditionValue=function(e){var t=game.PveType;switch(e){case t.MAININS:return game.mainInstanceData.id;case t.XIANDI:return game.baoZangData.maxId;case t.MATERIAL:return game.instFuncData.getCount();case t.ARENA:return game.arenaData.mineRank;case t.ZHANJIANG:return game.zhanjiangData.getLayer();case t.XIANDISTAR:return game.baoZangData.getAllStar();case t.ZHAOQIN:return game.zhaoqinData.currentLayer;case t.FORGEUPGRADE:return game.equipIntensifyData.totalLv;case t.FORGEREFINE:return game.equipRefineData.totalLv;case t.FORGEPURIFY:return game.equipPurifyData.totalLv;case t.FORGEGEM:return game.equipGemData.totalLv;case t.JIANGHUN:return game.InsFunCountData.getChallengeCount(game.InsFunCountType.JIANGHUN);case t.GUOSHI:return game.InsFunCountData.getChallengeCount(game.InsFunCountType.GUOSHI);case t.WANSHOU:return game.huntingData.maxLayer;case t.CBP:return game.challengeCbpData.winCount;default:return b8e.warn("PVE \u9519\u8bef\u7684\u7c7b\u578b",e),null}},s.getCurState=function(e,t,a){var i=s.getModuleConditionValue(e),n=game.PveType;switch(e){case n.MAININS:game.InstanceCfg.getDataAsync(i,function(e){t.call(a,e?e.name:"")},s);break;case n.XIANDI:t.call(a,game.Lang.get(637,Math.floor(i/6)));break;case n.MATERIAL:t.call(a,game.Lang.get(633,i));break;case n.ARENA:t.call(a,game.Lang.get(632,i));break;case n.ZHANJIANG:t.call(a,game.Lang.get(634,i));break;case n.XIANDISTAR:t.call(a,game.Lang.get(631,i));break;case n.ZHAOQIN:t.call(a,game.Lang.get(635,i));break;case n.FORGEUPGRADE:t.call(a,game.Lang.get(5967,i));break;case n.FORGEREFINE:t.call(a,game.Lang.get(5968,i));break;case n.FORGEPURIFY:t.call(a,game.Lang.get(5969,i));break;case n.FORGEGEM:t.call(a,game.Lang.get(5970,i));break;case n.PET:t.call(a,game.Lang.get(5971,i));break;case n.JIANGHUN:t.call(a,game.Lang.get(6514,i));break;case n.GUOSHI:t.call(a,game.Lang.get(6515,i));break;case n.WANSHOU:t.call(a,game.Lang.get(6516,i));break;case n.CBP:t.call(a,game.Lang.get(6517,i));break;default:t.call(a,"")}}}(),function(){var e;e=game.View.extends({ctor:function(){this._super(542)},init:function(){var e=this,t=e.list=new game.List;t.itemRender=game.PveItem,t.bindEnum=game.ME.Pve,t.layout.paddingTop=0,t.addToParent(e.skin.list),this.timer=b8e.Timer.add(this,this.updateTime,500),e.serverData=game.openServerData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_LIST:this.infoList=game.pveData.getInfoList(this.type),this.list.setData(this.infoList);break;case this.C2V_UPDATE_STATE:this.updateState()}},onShow:function(){var e=this,t=e.serverData.getCurBtnInfo();if(t)if(t.param){e.type=t.param,e.infoList=game.pveData.getInfoList(e.type),e.list.setData(e.infoList);var a=game.miscData,i=game.pveData.getInfoByType(e.type);i&&(e.endTime=a.openServerTime+(i.serverEnd-1)*b8e.TimeUtil.DAY_MICRO_SECONDS),e.timer.reset(),e.timer.start(),e.updateState()}else b8e.warn("\u5173\u5361\u6d3b\u8dc3openServerInfo\u6ca1\u6709\u914d\u7f6e\u989d\u5916\u53c2\u6570,\u5f00\u670d\u6d3b\u52a8id:"+t.id)},updateState:function(){var t=this,a=t.type;game.PveUtil.getCurState(a,function(e){t.updateCurState(a,e)},t)},updateCurState:function(e,t){if(this.type==e){var a=this.skin.curState;a.string=game.Lang.get(638,t),this.skin.view_gotoBtn.x=a.x+a.width+30}else;},onHide:function(){this.stopTime()},updateTime:function(){if(!this.endTime){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}var e=this.endTime-game.SysTime.curTime;if(e<=0){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}this.skin.time.string=game.TimeUtil.formatTimeSpace(e)},stopTime:function(){if(this.timer){this.timer.stop()}},view_gotoBtn:function(){var e=this.serverData.getCurBtnInfo();if(e){var t=e.getCfg();t&&(game.moduleOpen.checkOpen(t.moduleEnum)&&game.GameViewMgr.inst().hideUnStrongViews(!1),t.toggleIndex?game.module.showToggle(t.moduleEnum,t.toggleIndex-1):game.module.showToggle(t.moduleEnum))}else;},onStageResize:function(){this.setPosition(0,0)}}),b8e.module.registerView(game.ME.Pve,e),b8e.RC("$$game","$$PveView",e)}(),function(){var e=game.PveView.extends({ctor:function(){this._super()},init:function(){this._super(),this.serverData=game.mergeServerData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_LIST:this.infoList=game.pveData.getMergeInfoList(this.type),this.list.setData(this.infoList);break;case this.C2V_UPDATE_STATE:this.updateState()}},onShow:function(){var e=this,t=e.serverData.getCurBtnInfo();if(t)if(t.param){e.type=t.param,e.infoList=game.pveData.getMergeInfoList(e.type),e.list.setData(e.infoList);var a=game.miscData,i=game.pveData.getMergeInfoByType(e.type);i&&(e.endTime=a.mergeServerTime+(i.mergeEnd-1)*b8e.TimeUtil.DAY_MICRO_SECONDS),e.timer.reset(),e.timer.start(),e.updateState()}else b8e.warn("\u5173\u5361\u6d3b\u8dc3openServerInfo\u6ca1\u6709\u914d\u7f6e\u989d\u5916\u53c2\u6570,\u5f00\u670d\u6d3b\u52a8id:"+t.id)}});b8e.module.registerView(game.ME.MergePve,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(671),this.setSize(600,176)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.prizeList),t.layout.paddingLeft=6,t.layout.paddingRight=0,t.layout.paddingTop=-5,t.layout.spacingX=15},setData:function(){var e=this,t=e.skin,a=e.data.cfg,i=e.data;t.title.string=a.name,e.prizeInfoList=this.data.getPrizeList(),e.prizeList.setData(e.prizeInfoList),t.getBtn.node.active=i.canGet&&!i.isGet,t.gotoBtn.node.active=!i.canGet&&!i.isGet,t.isGetImg.node.active=i.isGet},getBtn:function(){this.send(game.PveEvts.V2C_GET_PRIZE,this.data.id)},gotoBtn:function(){var e=this.data.activityType,t=game.OpenServerClientCfg.getData(game.OpenServerType.PVE,e);if(t){if(game.moduleOpen.checkOpen(t.moduleEnum)){game.GameViewMgr.inst().hideUnStrongViews(!1)}if(t.toggleIndex){game.module.showToggle(t.moduleEnum,t.toggleIndex-1)}else game.module.showToggle(t.moduleEnum)}else;}}),b8e.RC("$$game","$$PveItem",e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(858),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.SPEED_CHANGE:this.changeSpeedRatio(t)}},onShow:function(){var e=game.settingData.getSpeed();this.changeSpeedRatio(e)},changeSpeedRatio:function(e){for(var t=0;t<4;t++)this.getComponent("speed_"+t).node.active=t==e},onStageResize:function(){var e=b8e.stageWidth;this.setPosition(e-88,300)}});b8e.module.registerView(game.ME.PlayBackSpeedRatio,e)}(),function(){var e;e=b8e.Enum({None:0,SPEED_CHANGE:-1,V_FOLLOW_CHAT:-1}),b8e.RC("$$game","$$PlayBackSpeedRatioEvts",e)}(),function(){var e=game.Control.extends({init:function(){var e=this,t=game.PlayBackSpeedRatioCfg.getDatas();t?4<t.length?b8e.warn("\u52a0\u901f\u914d\u7f6e\u8d85\u8fc74\u884c"):e.configs=t:b8e.warn("\u6ca1\u6709\u627e\u5230\u52a0\u901f\u914d\u7f6e")},ipc:function(){this.evts={Setting:{SAVE_SETTING:this.updateSpeedRatio}}},updateSpeedRatio:function(){var e=game.settingData.getSpeed();this.send(this.Evts.SPEED_CHANGE,e)},changeSpeedRatio:function(){var e=this;if(e.configs){var t,a=e.configs,i=game.settingData.getSpeed();++i>=a.length?i=0:(t=game.PlayBackSpeedRatioCfg.getData(i))?t.vip>game.mainRoleData.vipLevel&&(game.notice.show(9537,t.vip),i=0):(b8e.error("\u6ca1\u6709\u627e\u5230id\u4e3a",i,"\u7684\u52a0\u901f\u914d\u7f6e"),i=0),t=game.PlayBackSpeedRatioCfg.getData(i),game.playBack.speedRatio=t?t.speedRatio:1,e.dpt(this.Evts.SPEED_CHANGE,i),e.send(this.Evts.SPEED_CHANGE,i)}}});b8e.module.registerControl(game.ME.PlayBackSpeedRatio,e,game.PlayBackSpeedRatioEvts)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_RECHARGE:-1,C2C_REFRESH_BTNS:-1,C2V_CHANGE_SALE:-1,C2C_SELECT_BTN:-1}),b8e.RC("$$game","$$SaleRechargeEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Recharge:{C_INIT_MODEL:this.initSaleData,C_RECHARGE_SUCCESS:this.rechargeSuccess}}},triggerOpen:function(e){e==this.moduleEnum&&this.initSaleData()},initSaleData:function(){if(game.moduleOpen.checkOpen(this.moduleEnum))if(game.saleRechargeData.initData()){if(0<game.saleRechargeData.endTime){this.createTimer()}this.dpt(this.Evts.C2C_REFRESH_BTNS)}else{this.dpt(this.Evts.C2C_REFRESH_BTNS)}else;},notify:function(e,t){switch(e){case this.Evts.C2C_SELECT_BTN:this.send(this.Evts.C2V_CHANGE_SALE,t)}},createTimer:function(){if(this.Timer);else this._lastTime=b8e.timeStamp,this.Timer=b8e.Timer.add(this,this.updateTime,1e3),this.Timer.start()},clearTimer:function(){if(this.Timer)b8e.Timer.remove(this,this.updateTime),this.Timer=null;else;},updateTime:function(){var e=b8e.timeStamp,t=e-this._lastTime;if(this._lastTime=e,game.saleRechargeData.endTime-=t,game.saleRechargeData.endTime<1){this.clearTimer()}else;},buyBtn:function(){var e=game.saleRechargeData.saleId;if(game.saleRechargeData.isBuy(e));else this.dpt(this.Evts.C2C_RECHARGE,e)},left_btn:function(){var e=game.saleRechargeData.curSelect;if(!isNaN(e)){var t=e-1;t<0&&(t=0),game.saleRechargeData.curSelect=t,this.send(this.Evts.C2V_CHANGE_SALE,t)}},right_btn:function(){var e=game.saleRechargeData.curSelect;if(!isNaN(e)){var t=e+1,a=game.saleRechargeData.getArrLen();a<t&&(t=a),game.saleRechargeData.curSelect=t,this.send(this.Evts.C2V_CHANGE_SALE,t)}},rechargeSuccess:function(){if(game.moduleOpen.checkOpen(this.moduleEnum))this.initSaleData(),game.module.hide(this.moduleEnum);else;}});b8e.module.registerControl(game.ME.SaleRecharge,e,game.SaleRechargeEvts,null)}(),function(){var e=b8e.Object.extends({saleId:0,endTime:0,maxEndDay:0,curSelect:0,initData:function(){var e=this,t=game.miscData.openServerDay,a=0,i=void 0;e.obj||(e.obj={pfType:1}),b8e.isWeChatGame||game.LoginConfig.isApplePay?e.obj.pfType=2:e.obj.pfType=1,e.saleRechargeArr||(e.saleRechargeArr=[]),e.saleRechargeArr.length=0;var n,s=game.SaleRechargeCfg.getData(e.obj,!0);if(!s||s.length<1)return!1;s.sort(e.onSort);for(var o=void 0,r=!1,g=void 0,l=game.CCommonUtil.getGameChannelIdOpen,c=0,h=s.length;c<h;c++){i=(n=s[c]).rechargeId,l(n)&&(this.saleRechargeArr.push(n),this.isBuy(i)||r||(r=!0,g=i,a=Math.min(t,n.serverStart),o=this.saleRechargeArr.length-1))}if(a<1){return!1}e.curSelect=o;var m=game.SaleRechargeCfg.getData(g);if(!m){return!1}if(e.isBuy(m.rechargeId)){return!1}game.miscData.openServerTime;return e.saleId=m.rechargeId,e.endTime=b8e.TimeUtil.getNextDateTime(game.SysTime.curTime)-game.SysTime.curTime,!0},onSort:function(e,t){return e.sort-t.sort},getMaxEndDay:function(){if(!this.maxEndDay){game.SaleRechargeCfg.getDatas().forEach(function(e){if(e.serverEnd>this.maxEndDay){this.maxEndDay=e.serverEnd}},this)}return this.maxEndDay},getCfg:function(e){if(!this._key){this._key={}}return b8e.isWeChatGame||game.LoginConfig.isApplePay?this._key.pfType=2:this._key.pfType=1,this._key.serverStart=e,game.SaleRechargeCfg.getData(this._key)},isBuy:function(e){var t=game.rechargeData.saleRecharges;return!(!t||-1==t.indexOf(e))},isShowBtn:function(){if(!game.moduleOpen.checkOpen(game.ME.SaleRecharge))return!1;var e=game.SaleRechargeCfg.getDatas();if(!e)return!1;for(var t=!1,a=b8e.isWeChatGame||game.LoginConfig.isApplePay?2:1,i=game.miscData.openServerDay,n=void 0,s=0,o=e.length;s<o;s++)(n=e[s])&&a==n.pfType&&(i<n.serverStart||i>n.serverEnd||this.isBuy(n.rechargeId)||game.CCommonUtil.getGameChannelIdOpen(n)&&(t=!0));return t},getCountDown:function(){return this.endTime},getSaleCfgByIndex:function(e){var t=this.saleRechargeArr;return!t||t.length<1?null:t[e]},getBtnArrByArr:function(){this.btnArr||(this.btnArr=[]),this.btnArr.length=0;var e=this.saleRechargeArr;if(!e||e.length<1)return this.btnArr;for(var t=void 0,a=0;a<e.length;a++)t=new game.SaleRechargeBtnItemInfo(a,e[a].textImg),this.btnArr.push(t);return this.btnArr},updateBtnSelected:function(e){if(e&&!(e.length<1))for(var t=0;t<e.length;t++)e[t].selected=e[t].index==this.curSelect},getArrLen:function(){var e=this.saleRechargeArr;return!e||e.length<1?0:e.length}});game.saleRechargeData=game.saleRechargeData||new e}(),function(){var e;e=b8e.Object.extends({index:null,icon:null,selected:!1,ctor:function(e,t){this._super(),this.index=e,this.icon=t}});b8e.BindingUtil.bind(e),b8e.RC("$$game","$$SaleRechargeBtnItemInfo",e)}(),function(){var e;e=game.ListItem.extends({_icon:null,_select:null,ctor:function(){this._super(),this.setSize(78,82)},setData:function(){var e=this;if(e.data){var t=e.data;e._select||(e._select=b8e.Sprite.get(),e._select.setAnchor(.5,.5),e._select.setPosition(39,-41),e._select.width=78,e._select.height=82,e._select.addToParent(e)),t.selected?e._select.loadTexture(game.ResCfg.getUrl(55,"sel")):e._select.unloadTexture(),e._icon||(e._icon=b8e.Sprite.get(),e._icon.setAnchor(.5,.5),e._icon.setPosition(39,-41),e._icon.addToParent(e),b8e.evt.onC(e._icon,e.clickHandler,e)),t.icon&&""!=t.icon?e._icon.loadTexture(game.ResCfg.getImgUrl(t.icon+"3")):e._icon.unloadTexture()}},clickHandler:function(){this.send(game.SaleRechargeEvts.C2C_SELECT_BTN,this.data.index)}});b8e.RC("$$game","$$SaleRechargeBtnItem",e)}(),function(){var e=game.View.extends({_showModel:!0,_isFirst:!0,maxEndDay:9,ctor:function(){this._super(932)},init:function(){var e=this;e._titleImg=b8e.Sprite.get(),e._titleImg.setAnchor(.5,.5),e._titleImg.addToParent(e.skin.title),e._arrtNode=b8e.Sprite.get(),e._arrtNode.setAnchor(.5,.5),e._arrtNode.addToParent(e.skin.arrtNode),e._textImg=b8e.Sprite.get(),e._textImg.setAnchor(.5,.5),e._textImg.addToParent(e.skin.text),e.leftLab=b8e.Sprite.get(),e.leftLab.setAnchor(.5,.5),e.leftLab.addToParent(e.skin.leftLab),e.rightLab=b8e.Sprite.get(),e.rightLab.setAnchor(.5,.5),e.rightLab.addToParent(e.skin.rightLab),e._list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._list.itemRender=game.PrizeListItem,e._list.layout.spacingX=17,e._list.addToParent(e.skin.prizeNode),e._btnList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._btnList.itemRender=game.SaleRechargeBtnItem,e._btnList.layout.spacingX=25,e._btnList.bindEnum=game.ME.SaleRecharge,e._btnList.addToParent(e.skin.btnNode),e.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),e._model=game.sceneRoleCreate.createUIRole(e.roleData);var t=game.mainRoleData.isMale?1001:1002;e.roleData.heroModel.setBody(game.RoleType.Hero,t),e._model.addToParent(e.skin.modelRoot),e.maxEndDay=game.saleRechargeData.getMaxEndDay(),game.ShaderUtil.setGray(e.skin.grayBtn,!0)},notify:function(e,t){switch(e){case this.Evts.C2V_CHANGE_SALE:game.saleRechargeData.curSelect=t,this.updateImg(t),this.createInfo(t),this.updateBtnList(t)}},onShow:function(){this.updateImg(game.saleRechargeData.curSelect),this.createInfo(game.saleRechargeData.curSelect),this.btnData=game.saleRechargeData.getBtnArrByArr(),this.updateBtnList()},onHide:function(){this.clearTimer(),this.clearModel()},updateBtnList:function(){var e=game.saleRechargeData.curSelect,t=this.skin.btnNode.width,a=103*e+78,i=103*this.btnData.length-t;t<=a?this._btnList.scrollToRight(i):a<i&&this._btnList.scrollToLeft(0),game.saleRechargeData.updateBtnSelected(this.btnData),this._btnList.setData(this.btnData)},clearModel:function(){if(this._model){var e=this._model.getAnimator(game.AnimType.FOSTER,1);e&&e.clear()}},updateImg:function(e){var t=this.skin,a=game.saleRechargeData.getSaleCfgByIndex(e);if(a){var i=a.serverStart;game.saleRechargeData.saleId=a.rechargeId;var n=game.miscData.openServerDay,s=game.saleRechargeData.getArrLen();t.left_btn.active=0<e,t.right_btn.active=e<s-1,t.openDay.active=n<i;var o=a.rechargeId,r=game.saleRechargeData.isBuy(o);t.buyBtn.active=!r&&i<=n,t.grayBtn.active=!r&&n<i,t.isGetImg.active=r,t.prizeLab.loadTexture(game.ResCfg.getUrl(55,a.btnName)),t.prizeLab2.loadTexture(game.ResCfg.getUrl(55,a.btnName)),n<i&&(t.openDayLab.string=a.serverStart),a.arrtImg&&this._arrtNode.loadTexture(game.ResCfg.getImgUrl(a.arrtImg)),t.moneyLab.string=game.Lang.get(52401,a.prizeStr);var g=void 0;0<e&&(g=game.saleRechargeData.getSaleCfgByIndex(e-1)),g&&this.leftLab.loadTexture(game.ResCfg.getImgUrl(g.btnText));var l=void 0;e<s-1&&(l=game.saleRechargeData.getSaleCfgByIndex(e+1)),l?this.rightLab.loadTexture(game.ResCfg.getImgUrl(l.btnText)):t.right_btn.active=!1}},createModel:function(e){var t=e.maleModel;if(0<e.femaleModel)t=game.mainRoleData.isMale?e.maleModel:e.femaleModel;var a=game.ResCfg.getUrl(5020,t),i=this._model.getAnimator(game.AnimType.FOSTER,1);a?((i=i||this._model.addAnimator(game.AnimType.FOSTER,1)).load(a),i.play(),i.setPosition(e.offsetX,e.offsetY),i.setScale(e.scale,e.scale)):i&&i.clear();var n=this.roleData.heroModel;n.clear(),n.type=game.RoleType.Hero;var s=game.AvatarUtil;s.updateUIModel(this._model,s.ID_6),this._model.transition(game.RoleStateType.ACTION_IDLE)},createInfo:function(e){var t,a=this;if(t=game.saleRechargeData.getSaleCfgByIndex(e)){t.titleImg&&""!=t.titleImg?a._titleImg.loadTexture(game.ResCfg.getImgUrl(t.titleImg)):a._titleImg.unloadTexture(),t.textImg&&""!=t.textImg?(a._textImg.loadTexture(game.ResCfg.getImgUrl(t.textImg)),a.skin.descImg.loadTexture(game.ResCfg.getImgUrl(t.textImg+"2"))):(a._textImg.unloadTexture(),a.skin.descImg.unloadTexture()),a.skin.ssr.string=t.ssr;var i=game.CfgUtil.getPrizeListInfoAndFontSize(t.giveItems,game.IconLayoutEnum.SHOW_ALL,game.IconSizeEnum.GRID_SIZE_105,16);i&&a._list.setData(i.items),a.updateTime(),0<game.saleRechargeData.endTime&&a.createTimer(),a.createModel(t)}},createTimer:function(){this.Timer||(this.Timer=b8e.Timer.add(this,this.updateTime,1e3),this.Timer.start())},clearTimer:function(){this.Timer&&(b8e.Timer.remove(this,this.updateTime),this.Timer=null)},updateTime:function(){var e=Math.max(0,game.saleRechargeData.endTime);this.skin.countdownLab.string=game.Lang.get(716,b8e.TimeUtil.formatTime(e)),e<1&&this.clearTimer()}});b8e.module.registerView(game.ME.SaleRecharge,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_FOSTER_UPGRADE:-1,V2C_GET_PRIZE:-1,V2C_SHOW_VIEW:-1,C2V_UPDATE_LIST:-1,C2V_UPDATE_PROGRESS:-1}),b8e.RC("$$game","$$UpgradeRebateEvts",e)}(),function(){var e=game.Control.extends({initUpgradeData:!1,rebateType:0,init:function(){this.godArmySpotAlert=game.spotAlert.set(game.SAE.GOD_ARMY_REBATE,game.SAE.OPEN_SERVER_ALERT),this.junzhenSpotAlert=game.spotAlert.set(game.SAE.MILITARYARRAY_REBATE,game.SAE.OPEN_SERVER_ALERT),this.tempList=[],this.objPool=[],this.fosterObjPool=[]},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily},OpenServer:{C2C_INIT_OPENSERVER:this.initOpenServer}},this.handels={UpgradeRebateAwardResp:this.upgradeRebateAward}},initOpenServer:function(){if(game.moduleOpen.checkOpen(this.moduleEnum))this.initData();else;},triggerOpen:function(e){e==this.moduleEnum&&this.initData()},resetDaily:function(){if(game.moduleOpen.checkOpen(this.moduleEnum))this.initUpgradeData=!1,game.upgradeRebateData.resetDaily(),this.initData();else;},notify:function(e,t){switch(e){case this.Evts.V2C_GET_PRIZE:this.sender.UpgradeRebateAwardReq(t)}},fosterUpgrade:function(e){e&&e.data&&(this.checkAlert(game.UpgradeRebateType.FOSTER,e.data),this.send(this.Evts.C2V_UPDATE_PROGRESS))},junzhenUpdate:function(){this.checkAlert(game.UpgradeRebateType.JUNZHEN,0),this.send(this.Evts.C2V_UPDATE_PROGRESS)},initData:function(){var a=this;if(!a.initUpgradeData){var i=0;a.initUpgradeData=!0;var e=game.upgradeRebateData,t=game.miscData.openServerDay,n=game.UpgradeRebateCfg.getListByOpenDay(t);if(n&&0<n.length){var s=void 0,o=n.length;for(i=0;i<o;i++)(s=n[i])&&e.initData(s)}var r=void 0,g=void 0,l=void 0;if(a.tempList.length=0,!a.rebateType){var c=game.OpenServiceMiscCfg.getData("rebateType");c&&(a.rebateType=+c.value)}for(i=2;i<=a.rebateType;i++)r=e.getOpenFosterTypeList(i),a.objPool[i]||(a.objPool[i]={openServerType:0,isActive:!0,sae:0}),(l=e.getOpenTypeByUpgradeType(i))&&((g=a.objPool[i]).openServerType=l,g.isActive=r&&0<r.length,g.sae=a.getActivitySAE(i),a.tempList.push(g));var h=e.getOpenFosterTypeList(game.UpgradeRebateType.FOSTER),m=game.UpgradeRebateCfg.getKeys("fosterType"),u=h&&0<h.length;if(m&&0<m.length){var d=void 0,f=m.length;for(i=0;i<f;i++)(d=+m[i])&&(a.fosterObjPool[i]||(a.fosterObjPool[i]={openServerType:game.OpenServerType.UPGRADE_REBATE,type:0,isActive:!0,sae:0,param:0}),(g=a.fosterObjPool[i]).isActive=u&&-1<h.indexOf(d),g.type=d,g.param=d,a.tempList.push(g))}var p=e.getOpenTypeMap();if(p){var _=void 0,v=void 0;p.forEach(function(e,t){if(t&&0<t.length)for(_=t.length,i=0;i<_;i++)v=t[i],a.checkAlert(e,v)},a)}a.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER_LIST,a.tempList)}},upgradeRebateAward:function(e){var t=e.readProtobuf(game.pb.UpgradeRebateAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.UpgradeRebateCfg.getDataById(t.id);if(a){var i=a.activityType;game.upgradeRebateData.getAwardSuccess(t.id,i),this.checkAlert(a.activityType,a.fosterType),this.send(this.Evts.C2V_UPDATE_LIST)}else{b8e.warn("\u6ca1\u6709\u8fd9\u4e2aid\u7684\u914d\u7f6e:"+t.id)}}},getActivitySAE:function(e){var t=game.UpgradeRebateType,a=game.SAE;switch(e){case t.GOD_ARMY:return a.GOD_ARMY_REBATE;case t.GUO_SHI:return a.GUO_SHI_REBATE;case t.JUNZHEN:return a.MILITARYARRAY_REBATE}return 0},checkAlert:function(e,t){var a=1<arguments.length&&void 0!==t?t:0;e=+e,a=+a;var i=game.upgradeRebateData.checkAlert(e,a);switch(e){case game.UpgradeRebateType.GOD_ARMY:this.godArmySpotAlert.alert=i;break;case game.UpgradeRebateType.JUNZHEN:this.junzhenSpotAlert.alert=i}},gotoBtn:function(){var e=game.openServerData.getCurBtnInfo();if(e){var t=e.getCfg();if(t)if(t.toggleIndex){game.module.showToggle(t.moduleEnum,t.toggleIndex-1)}else game.module.showToggle(t.moduleEnum);else;}else;},initFosterData:function(){var e=game.UpgradeRebateCfg.getKeys("fosterType");if(e&&!(e.length<1)&&!this.initFosterType){this.initFosterType=!0;for(var t=game.UpgradeRebateType.FOSTER,a=0;a<e.length;a++)game.upgradeRebateData.getIsOpenByTT(t,e[a])&&this.checkAlert(t,e[a])}}}),t=game.Sender.extends({ipc:function(){this.msg={UpgradeRebateAwardReq:this.upgradeReq}},upgradeReq:function(e){var t=game.pb.UpgradeRebateAwardRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.UpgradeRebate,e,game.UpgradeRebateEvts,t)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.infoList=[],this.awardList=[],this.progressMap=b8e.HashMap.get(),this.openServerMap=b8e.HashMap.get(),this.infoMap=b8e.HashMap.get(),this.openTypeMap=b8e.HashMap.get(),this.infoPool=[]},resetDaily:function(){this.infoList.length=0,this.openTypeMap.clear(),this.infoMap.clear()},initData:function(e){var t=this.infoList.length;this.infoPool[t]||(this.infoPool[t]=new game.UpgradeRebateInfo);var a=this.infoPool[t];(this.infoList[t]=a).setData(e);var i=this.infoMap.get(e.activityType);i||(i=b8e.HashMap.get(),this.infoMap.set(e.activityType,i));var n=i.get(e.fosterType);n||(n=[],i.set(e.fosterType,n)),n[n.length]=a;var s=this.openTypeMap.get(a.activityType);s||(s=[],this.openTypeMap.set(a.activityType,s)),s[s.length]=a.fosterType},setJinjieAward:function(e){e&&(this.awardList=e,this.checkAllAlert())},getAwardSuccess:function(e){this.awardList.push(e)},isGetAward:function(e){return-1<this.awardList.indexOf(e)},getInfoByTT:function(e,t){var a=1<arguments.length&&void 0!==t?t:0,i=this.getUpgradeTypeByOpenType(e),n=this.infoMap.get(i);if(!n)return null;var s=n.get(a);return s?(s.sort(this.onSort),s):null},onSort:function(e,t){if(e.isGet&&!t.isGet){return 1}if(!e.isGet&&t.isGet){return-1}if(e.canGet&&!t.canGet){return-1}if(e.canGet||!t.canGet)return e.id-t.id;return 1},getProgress:function(){return 0},checkAllAlert:function(){var i=this;i.infoMap&&i.infoMap.forEach(function(a,e){e.forEach(function(e,t){i.checkAlert(a,e)},i)},i)},checkAlert:function(e,t){e=+e,t=+t;var a=this.infoMap.get(e);if(!a)return!1;var i=a.get(t);if(!i||i.length<1)return!1;for(var n,s=!1,o=void 0,r=void 0,g=void 0,l=i.length,c=0;c<l;c++){switch(n=i[c],r=this.getProgress(n.activityType,n.fosterType),o=n.cfg,n.num=r,o.activityType){case game.UpgradeRebateType.FOSTER:case game.UpgradeRebateType.FA_ZHEN:g=n.lv;break;default:g=n.power}n.canGet=g<=r,n.isGet=this.isGetAward(n.id),n.canGet&&!n.isGet&&(s=!0)}return s},getOpenTypeByUpgradeType:function(e){var t=game.UpgradeRebateType,a=game.OpenServerType;switch(e){case t.FOSTER:return a.UPGRADE_REBATE;case t.FIGHT_PET:return a.FIGHT_PET;case t.GOD_ARMY:return a.GOD_ARMY;case t.GUO_SHI:return a.GUO_SHI;case t.FA_ZHEN:return a.FA_ZHEN;case t.JUNZHEN:return a.JUNZHEN_REBATE}return a.NONE},getUpgradeTypeByOpenType:function(e){var t=game.UpgradeRebateType,a=game.OpenServerType;switch(e){case a.UPGRADE_REBATE:return t.FOSTER;case a.FIGHT_PET:return t.FIGHT_PET;case a.GOD_ARMY:return t.GOD_ARMY;case a.GUO_SHI:return t.GUO_SHI;case a.FA_ZHEN:return t.FA_ZHEN;case a.JUNZHEN_REBATE:return t.JUNZHEN}return t.NONE},getIsOpenByTT:function(e,t){var a=1<arguments.length&&void 0!==t?t:0,i=this.infoMap.get(e);if(!i)return!1;var n=i.get(a);return!(!n||n.length<1)},getOpenFosterTypeList:function(e){return this.openTypeMap.get(e)},getOpenTypeMap:function(){return this.openTypeMap}});game.upgradeRebateData=game.upgradeRebateData||new e}(),function(){var e;e=b8e.Object.extends({cfg:null,num:0,id:0,isGet:!1,canGet:!1,activityType:0,lv:0,serverEnd:0,ctor:function(){this._super()},setData:function(e){this.cfg=e,this.id=e.id,this.lv=e.lv,this.power=e.power,this.serverEnd=e.serverEnd,this.activityType=e.activityType,this.fosterType=e.fosterType,this.isInitPrize=!1},getPrizeList:function(){var e=this;if(e.award&&e.isInitPrize){return e.award}e.isInitPrize=!0,e.award||(e.award=[]);for(var t,a=e.cfg.award,i=a.length,n=0;n<i;n++)t=a[n],e.award[n]=game.ItemUtil.createBaseItemInfo(t.Id,t.Num,e.award[n]);return e.award}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$UpgradeRebateInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,FOSTER:1,FIGHT_PET:2,REBIRTH:3,GOD_ARMY:4,GUO_SHI:5,FA_ZHEN:6,JUNZHEN:11}),b8e.RC("$$game","$$UpgradeRebateType",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(696),this.setSize(600,176)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.prizeList),t.layout.paddingLeft=6,t.layout.paddingRight=0,t.layout.paddingTop=-5,t.layout.spacingX=15},setData:function(){var e=this.skin,t=this.data.cfg,a=this.data,i=3304,n=a.lv,s=0,o=a.num;game.upgradeRebateData;switch(t.activityType){case game.UpgradeRebateType.FOSTER:case game.UpgradeRebateType.FA_ZHEN:s=o;break;case game.UpgradeRebateType.FIGHT_PET:case game.UpgradeRebateType.GOD_ARMY:case game.UpgradeRebateType.GUO_SHI:case game.UpgradeRebateType.JUNZHEN:i=5303,n=game.CCommonUtil.replaceNum(a.power,0),s=game.CCommonUtil.replaceNum(o,1)}e.title.string=game.Lang.get(i,t.name,n,s,n),this.prizeInfoList=this.data.getPrizeList(),this.prizeList.setData(this.prizeInfoList),e.getBtn.node.active=a.canGet&&!a.isGet,e.gotoBtn.node.active=!a.canGet&&!a.isGet,e.isGetImg.node.active=a.isGet},getBtn:function(){this.send(game.UpgradeRebateEvts.V2C_GET_PRIZE,this.data.id)},gotoBtn:function(){var e=this.data.activityType,t=this.data.fosterType,a=game.upgradeRebateData.getOpenTypeByUpgradeType(e),i=game.OpenServerClientCfg.getData(a,t);if(i)if(i.toggleIndex){game.module.showToggle(i.moduleEnum,i.toggleIndex-1)}else game.module.showToggle(i.moduleEnum);else;}}),b8e.RC("$$game","$$UpgradeRebateItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(697)},init:function(){var e=this,t=e.list=new game.List;t.itemRender=game.UpgradeRebateItem,t.bindEnum=game.ME.UpgradeRebate,t.addToParent(e.skin.list),this.timer=b8e.Timer.add(this,this.updateTime,500)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_PROGRESS:this.updateProgress();break;case this.Evts.C2V_UPDATE_LIST:this.updateList()}},onShow:function(){var e=this,t=e.openServerInfo=game.openServerData.getCurBtnInfo();if(t){e.updateList();var a=t.getCfg();if(a){if(e.infoList&&0<e.infoList.length){var i=game.miscData,n=e.infoList[0];e.endTime=i.openServerTime+(n.serverEnd-1)*b8e.TimeUtil.DAY_MICRO_SECONDS}if(e.timer.reset(),e.timer.start(),e.updateProgress(),a.bannerImg&&""!=a.bannerImg){var s=game.ResCfg.getImgUrl(a.bannerImg);e.skin.banner.loadTexture(s)}}}},updateList:function(){},updateProgress:function(){var e=this.openServerInfo;if(e){var t=game.upgradeRebateData,a=t.getUpgradeTypeByOpenType(e.openServerType),i=t.getProgress(a,e.type);switch(a){case game.UpgradeRebateType.FOSTER:case game.UpgradeRebateType.FA_ZHEN:this.skin.curLevel.string=game.Lang.get(2301,i);break;default:var n=game.CCommonUtil.replaceNum(i,1);this.skin.curLevel.string=game.Lang.get(5304,n)}}},onHide:function(){this.stopTime()},updateTime:function(){if(!this.endTime){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}var e=this.endTime-game.SysTime.curTime;if(e<=0){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}this.skin.time.string=game.TimeUtil.formatTimeSpace(e)},stopTime:function(){if(this.timer){this.timer.stop()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.UpgradeRebate,e)}(),function(){var e;e=b8e.Enum({None:0,V_SHOW_GETBTN:-1,CLICK_GET_CHOOSEAWARDS:-1,C2C_REFRESH_BTNS:-1,MANYRECHARGE_SHOWADVERT:-1,MANYRECHARGE_ADVERT:-1,MANYRECHARGE_HIDEROOT:-1,MANYRECHARGE_SHOWROOT:-1,C2V_FOLLOW_CHAT:-1,V2C_SELECT_TITLE:-1,C2V_UPDATE_BTN:-1,V2C_SHOW_VIEW:-1,C2V_BTN_CHANGE:-1,C2V_SHOW_POP_ANI:-1}),b8e.RC("$$game","$$ManyFirstChargeEvts",e)}(),function(){var e=game.Control.extends({spotAlert:null,numTimer:0,advertTimer:null,lockTime:0,currIndex:0,init:function(){var e=this;if(e.spotAlert=game.spotAlert.set(game.SAE.MANY_FIRST_CHARGE),e.params={itemId:0},game.manyFirstChargeData.initData(),0<game.manyFirstChargeData.countDown){this.createTimer()}e._alertOptions={lang:1723,okcb:e.onClickGameAlert,thisArg:e},e._alertOptions2={lang:7014,okcb:e.rechargeMax,cancelcb:e.rechargeFirst,thisArg:e},e.moduleData=game.manyFirstChargeData},ipc:function(){var e=this;e.evts={Recharge:{C2C_CHOOSE_RECHARGE_SUCCESS:e.showBtn,C_INIT_MODEL:e.initRecharge,C_RECHARGE_SUCCESS:e.rechargeSuccess},MainRole:{C_LEVEL_UP:e.playStop,C_RESET_DAILY:e.resetDaily},RoleLvUp:{V_ALREADY_ROLE_LVUP:e.onRoleLvUp}},e.gevts={InstanceEvts:{G_STOP_PLAY:e.showAdvertRoot}},e.handels={ChooseRechargeResp:e.getRecharge}},onRoleLvUp:function(){if(this.moduleData.checkPopAniLv(game.mainRoleData.lv)){if(game.playBack.isInstanceFighting(!1))return;game.gamePopupMgr.show(game.ME.ManyFirstCharge)}},playStop:function(){this.showAdvert();var e=this.moduleData.checkPopAniLv(game.mainRoleData.lv),t=game.playBack.isInstanceFighting(!1);e&&t&&0<game.roleLvUpData.addLv&&game.gamePopupMgr.show(game.ME.ManyFirstCharge)},updateTimer:function(){game.gamePopupMgr.currShowModule==this.moduleEnum&&(this.popAniTimer||(this.popWaitTime=this.moduleData.aniPopWaitTime,this.popAniTimer=b8e.Timer.add(this,this.updatePopAniWaitTime,1e3)))},updatePopAniWaitTime:function(){this.popWaitTime-=1,0<this.popWaitTime||(this.send(this.Evts.C2V_SHOW_POP_ANI),this.popAniTimer=null,b8e.Timer.remove(this,this.updatePopAniWaitTime))},onHide:function(){this.popAniTimer&&(this.popAniTimer=null,b8e.Timer.remove(this,this.updatePopAniWaitTime))},initMainAdvert:function(){},showAdvert:function(){var e=game.moduleOpen.checkOpen(game.ME.ManyFirstCharge)&&game.manyFirstChargeData.isShowBtn(),t=game.manyFirstChargeData.getAdvertIsShow();if(e&&t){var a=game.sceneData.isCsScene(),i=game.playBack.isInstanceFighting(!1);if(a||i)return void(this.moduleData.canShowView=!0);game.module.show(game.ME.ManyFirstAdvert)}b8e.Tween.kill(this)},showAdvertRoot:function(){game.rechargeData.chooseId||this.moduleData.canShowView&&(game.module.show(game.ME.ManyFirstAdvert),this.moduleData.canShowView=!1)},initRecharge:function(){game.manyFirstChargeData.initTitleData(),game.manyFirstChargeData.updateSelectBtn(),this.checkAlert(),this.showAdvert()},checkAlert:function(){this.spotAlert.alert=0!=game.rechargeData.chooseId&&game.manyFirstChargeData.checkAlert()},createTimer:function(){var e=this;e.Timer||(e._lastTime=b8e.timeStamp,e.Timer=b8e.Timer.add(e,e.updateTime,1e3),e.Timer.start())},clearTimer:function(){var e=this;e.Timer&&(b8e.Timer.remove(e,e.updateTime),e.Timer=null)},updateTime:function(){var e=b8e.timeStamp,t=e-this._lastTime;this._lastTime=e,game.manyFirstChargeData.countDown-=t,game.manyFirstChargeData.countDown<1&&this.clearTimer()},chargeBtn0:function(){var e=game.manyFirstChargeData.mfcCfg[0].rechargeId;this.rechargeMoney(e)},chargeBtn1:function(){var e=game.manyFirstChargeData.mfcCfg[1].rechargeId;this.rechargeMoney(e)},chargeBtn2:function(){var e=game.manyFirstChargeData.mfcCfg[2].rechargeId;this.rechargeMoney(e)},chargeBtn3:function(){var e=game.manyFirstChargeData.mfcCfg[3].rechargeId;this.rechargeMoney(e)},showBtn:function(){this.send(this.Evts.V_SHOW_GETBTN),this.checkAlert()},getBtn:function(){var e=game.manyFirstChargeData.selectDay;this.sender.ChooseRechargeReq(e)},recharge:function(e){this.__selectedRechargeId=e,this._alertOptions2.btn=game.Lang.get(9222),this._alertOptions2.title=game.Lang.get(9433),this._alertOptions2.cancelCloseCb=!0,game.alert.show(this._alertOptions2)},__selectedRechargeId:0,rechargeMax:function(){var e=game.manyFirstChargeData.mfcCfg[3].rechargeId;this.rechargeMoney(e)},rechargeFirst:function(){this.rechargeMoney(this.__selectedRechargeId)},rechargeMoney:function(e){this.lockTime>game.SysTime.curTime?game.notice.show(6328):(this.lockTime=game.SysTime.curTime+1e3,this.params.itemId=e,game.sdk.pay(this.params))},gotoRecharge:function(){game.module.hide(game.ME.ManyFirstAdvert),game.module.show(game.ME.ManyFirstCharge)},notify:function(e,t){switch(e){case this.Evts.MANYRECHARGE_SHOWADVERT:this.dpt(game.ManyFirstChargeEvts.MANYRECHARGE_ADVERT);break;case this.Evts.V2C_SHOW_VIEW:game.manyFirstChargeData.updateSelectBtn(),this.send(this.Evts.C2V_UPDATE_BTN),this.updateTimer();break;case this.Evts.V2C_SELECT_TITLE:game.manyFirstChargeData.selectBtn(t)&&this.send(this.Evts.C2V_UPDATE_BTN)}},getRecharge:function(e){var t=e.readProtobuf(game.pb.ChooseRechargeResponse);0<t.code?game.notice.noticeError(t.code):(game.manyFirstChargeData.setAward(t.day),this.checkAlert(),game.manyFirstChargeData.updateSelectBtn(),this.send(this.Evts.C2V_UPDATE_BTN),this.dpt(this.Evts.C2C_REFRESH_BTNS))},resetDaily:function(){this.checkAlert(),game.manyFirstChargeData.updateSelectBtn(),this.send(this.Evts.C2V_UPDATE_BTN)},rechargeSuccess:function(){game.manyFirstChargeData.updateTitleList(),this.checkAlert(),game.manyFirstChargeData.updateSelectBtn(),this.send(this.Evts.C2V_UPDATE_BTN)},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},getPrizeBtn:function(){this.getBtn()},leftBtn:function(){this.send(this.Evts.C2V_BTN_CHANGE,1)},rightBtn:function(){this.send(this.Evts.C2V_BTN_CHANGE,2)},updateData:function(){}}),t=[game.ME.ManyFirstAdvert],a=game.Sender.extends({ipc:function(){this.msg={ChooseRechargeReq:this.chooseRechargeReq}},chooseRechargeReq:function(e){var t=game.pb.ChooseRechargeRequest;t.day=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.ManyFirstCharge,e,game.ManyFirstChargeEvts,a,t)}(),function(){var e=b8e.Object.extends({costList:null,mfcCfg:null,tips:null,giveItems:null,showPetModel:0,countDown:0,isGetAll:!1,btnPortObj:null,aniPopLvs:null,aniPopWaitTime:0,canShowView:!1,createTime:0,ctor:function(){this._super(),this.mfcCfg=[],this.giveItems=[],this.awardList=[],this.aniPopLvs=[]},initData:function(){var e,t=game.ChooseRechargeCfg.getDatas();e=b8e.isWeChatGame?2:game.LoginConfig.isApplePay?2:1;var a=game.RechargeCfg.getDataByType(4,e);if(a&&0<a.length)for(var i=0;i<a.length;i++)for(var n=a[i],s=0;s<t.length;s++){var o=t[s];o.rechargeId==n.rechargeId&&this.mfcCfg.push(o)}var r=game.RechargeMiscCfg.getData("Tipsname");if(r){this.tips=r.value}var g=game.RechargeMiscCfg.getData("chooseRechargeAward");if(g){this.giveItems=g.giveItems}var l=game.RechargeMiscCfg.getData("showPetModel");if(l){this.showPetModel=l.value}var c=game.RechargeMiscCfg.getData("manyFirstChargeAniLv");if(c&&c.value)for(var h=c.value.split(","),m=0;m<h.length;m++)this.aniPopLvs.push(+h[m]);var u=game.RechargeMiscCfg.getData("manyFirstChargeAniTime");u&&u.value&&(this.aniPopWaitTime=+u.value)},isShowBtn:function(){var e=game.miscData.openServerDay,t=game.RechargeMiscCfg.getData("serverEnd");return!(t.value&&e>parseInt(t.value))&&(!this.isGetAll&&game.rechargeData.isInit)},checkPopAniLv:function(e){var t=game.moduleOpen.checkOpen(game.ME.ManyFirstCharge),a=0<game.rechargeData.chooseId;if(!t||a)return!1;for(var i=0;i<this.aniPopLvs.length;i++)if(e==this.aniPopLvs[i])return!0;return!1},isNeedManyCD:function(e){this.needCD=e},getCountDown:function(){return!game.LoginConfig.hasHeroData||this.needCD?b8e.TimeUtil.HOUR_MICRO_SECONDS:0},getAdvertIsShow:function(){var e=this.getEnoughLVLsit(),t=game.mainRoleData.lv;return 0==game.rechargeData.chooseCollected&&!(-1==e.indexOf(t))},getEnoughLV:function(){var e=this.getEnoughLVLsit(),t=game.mainRoleData.lv;return e[0]<=t},getEnoughLVLsit:function(){var e=game.RechargeMiscCfg.getData("manyFirstAdvertLV");if(!e)return b8e.warn("\u5927\u5144\u5f1f\uff0c\u914d\u7f6e\u5462    manyFirstAdvertLV  "),!1;var t=e.MiscArr;return t||(b8e.warn("\u5927\u5144\u5f1f\uff0c\u914d\u7f6e\u5462    manyFirstAdvertLV  "),!1)},initTitleData:function(){this.awardList=game.rechargeData.chooseAwards,this.updateTitleList()},updateTitleList:function(){var e=this;e.titleMap||(e.titleMap=b8e.HashMap.get()),e.titleList?e.titleList.length=0:e.titleList=[];var t=game.ChooseRechargeAwardCfg.getDatas();if(t&&!(t.length<1)){for(var a=void 0,i=void 0,n=t.length,s=game.rechargeData.rechargeTimes,o=0;o<n;o++)a=t[o],(i=e.titleMap.get(a.day))||(i=new game.ManyFirstTitleInfo,e.titleMap.set(a.day,i)),i.setData(a),s+1>=a.rechargeTimes&&e.titleList.push(i);e.titleList.sort(e.onSort)}},onSort:function(e,t){return e.day-t.day},updateSelectBtn:function(){var e=this,t=e.titleList;if(t&&!(t.length<1)){var a=void 0,i=t.length,n=void 0,s=void 0,o=e.selectDay;e.selectDay=t[0].day;for(var r=0;r<i;r++)(a=t[r]).isEnough&&(n=a.day,a.isGet||(s=a.day));if(n&&(e.selectDay=n),s&&(e.selectDay=s),o!=e.selectDay&&e.titleMap){if(o){var g=e.titleMap.get(o);g&&(g.select=!1)}var l=e.titleMap.get(e.selectDay);l&&(l.select=!0)}}},setAward:function(e){var t=this.awardList;(t=t||(this.awardList=[])).push(e)},isGetByDay:function(e){return!(!this.awardList||this.awardList.length<1)&&-1<this.awardList.indexOf(e)},checkAlert:function(){var e=!(this.isGetAll=!0),t=game.rechargeData.rechargeTimes,a=game.rechargeData.rechargeMoney,i=this.titleList;if(i&&0<i.length)for(var n=void 0,s=i.length,o=game.miscData.openServerDay,r=0;r<s;r++)(n=i[r]).isGet=this.awardList&&-1<this.awardList.indexOf(n.day),n.isEnough=n.day<=o&&t>=n.rechargeTimes&&a>=n.rechargeMoney,n.isGet||(this.isGetAll=!1),n.isEnough&&!n.isGet&&(e=!0);return e},selectBtn:function(e){if(this.selectDay==e)return!1;if(!this.titleMap)return!1;var t=this.titleMap.get(this.selectDay);t&&(t.select=!1);var a=this.titleMap.get(e);return a&&(a.select=!0),this.selectDay=e,!0},getTitleInfoByDay:function(e){return this.titleMap?this.titleMap.get(e):null},getTitleList:function(){return this.titleList},setBtnPort:function(e){this.btnPortObj=e}});game.manyFirstChargeData=game.manyFirstChargeData||new e}(),function(){var e=game.View.extends({_showModel:!0,currIndex:0,diamondsId:21,ctor:function(){this._super(662)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.listNode),e.layout.paddingLeft=12,e.layout.paddingRight=0,e.layout.paddingTop=2,e.layout.paddingBottom=0,e.layout.spacingX=15,e.layout.spacingY=0;var t=this.titleList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.ManyFirstTitleItem,t.bindEnum=this.moduleEnum,t.layout.paddingLeft=0,t.addToParent(this.skin.titleList),this.initIcon()},initIcon:function(){for(var e=void 0,t=0;t<4;t++)(e=game.GridUtil.createViewClickIcon(40)).addToParent(this.getComponent("iconNode"+t)),e.setItemId(this.diamondsId)},notify:function(e,t){var a=this;switch(e){case a.Evts.V_SHOW_GETBTN:a.showBtn();break;case a.Evts.C2V_UPDATE_BTN:0!=game.rechargeData.chooseId&&a.updateGetBtn(),a.updateBanner(),a.updatePage();break;case a.Evts.C2V_BTN_CHANGE:a.updateData(t);break;case a.Evts.C2V_SHOW_POP_ANI:a.onAniStop()}},onAniStop:function(){var e=game.manyFirstChargeData.btnPortObj;if(e){var t=e.localToGlobal();game.viewModule.removeModule(this),b8e.Tween.get(this).to({scaleX:0,scaleY:0,x:t.x,y:t.y},400).call(function(){game.module.hide(game.ME.ManyFirstCharge)})}},resetScaleNode:function(){this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,b8e.Tween.kill(this)},showBtn:function(){this.skin;this.updateGetBtn(),this.updatePage();for(var e=0;e<4;e++)this.getComponent("chargeBtn"+e).node.active=!1,this.getComponent("isGet"+e).node.active=!0},updateGetBtn:function(){var e=this.skin;e.tips.active=!1;var t=game.manyFirstChargeData.selectDay,a=t<=game.miscData.openServerDay,i=game.manyFirstChargeData.isGetByDay(t);e.getNode.active=!i&&a,e.cantGet.active=!a,e.isGetImg.active=i;var n=game.ChooseRechargeAwardCfg.getData(t);if(n){var s=game.Lang.get(6716,n.title);e.lb_get.string=s,e.lb_cant_get.string=s}},updateBanner:function(){var e=game.manyFirstChargeData.selectDay,t=game.manyFirstChargeData.getTitleInfoByDay(e);if(t){var a=t.cfg;if(a){var i=game.ResCfg.getImgUrl(a.banner,!0);this.skin.banner.loadTexture(i);var n=a.bannerLabel;if(n&&""!=n){var s=game.ResCfg.getImgUrl(n,!0);this.skin.bannerLab.loadTexture(s)}else this.skin.bannerLab.unloadTexture()}var o=t.getPrizeListInfo();o&&this.list.setData(o.items)}},onShow:function(){var e=this;e.skin.tipsLab.string=game.manyFirstChargeData.tips;for(var t=0;t<4;t++){var a=game.manyFirstChargeData.mfcCfg[t];e.getComponent("costLab"+t).string=a.name,e.getComponent("isGetLab"+t).string=a.name;a.gold,a.firstExtraGold;e.getComponent("recommend"+t).node.active=a.marker;var i=a.gold+a.firstExtraGold;e.getComponent("numLab"+t).string=game.Lang.get(50397,i)}e.updateTime(),0<game.manyFirstChargeData.countDown&&e.createTimer(),0!=game.rechargeData.chooseId&&e.showBtn(),e.updatePage(),e.send(e.Evts.V2C_SHOW_VIEW)},updatePage:function(){var e=this.skin,t=game.manyFirstChargeData.selectDay;this.currIndex=t;var a=game.manyFirstChargeData.getTitleInfoByDay(t);if(a){var i=a.cfg;if(i){var n=i.rechargeTimes,s=game.rechargeData.rechargeTimes,o=0<n,r=game.miscData.openServerDay>=i.day;e.rechargePage.active=!o,e.awardPage.active=o;var g=game.manyFirstChargeData.getTitleList();if(!g||g.length<1)return;var l=g.length,c=t-1,h=t+1;if(0<c&&e.leftImg.loadTexture(game.ResCfg.getUrl(10063,c)),h<=l&&e.rightImg.loadTexture(game.ResCfg.getUrl(10063,h)),e.redPoint_1.active=!a.isGet&&a.isEnough,e.leftBtn.active=e.leftImg.active=1<this.currIndex,e.rightBtn.active=e.rightImg.active=this.currIndex<l,o){if(game.manyFirstChargeData.isGetByDay(t))return e.getNode2.active=!1,void(e.isGetImg2.active=!0);e.getNode2.active=!0,e.isGetImg2.active=!1;var m=game.rechargeData.rechargeMoney,u=i.rechargeMoney;e.condition.string=1<u?game.Lang.get(7237,m,u):game.Lang.get(7238);var d=u<=m&&n<=s;e.grayGetPrizeBtn.active=!d||!r,e.conditionDesc.active=!d||!r,e.conditionDesc.string=d&&!r?game.Lang.get(7239,i.day):game.Lang.get(7240),e.getPrizeBtn.active=d&&r}}}},createTimer:function(){this.Timer||(this.Timer=b8e.Timer.add(this,this.updateTime,1e3),this.Timer.start())},clearTimer:function(){this.Timer&&(b8e.Timer.remove(this,this.updateTime),this.Timer=null)},updateTime:function(){var e=Math.max(0,game.manyFirstChargeData.countDown),t=game.HtmlUtil.getText(game.Color.WHITE,game.Lang.get(9223)),a=game.manyFirstChargeData.countDown-game.SysTime.curTime,i=game.TimeUtil.formatTimeSpace(a,3),n=game.HtmlUtil.getText(game.Color.GREEN,i);this.skin.countLab.string=t+n,e<1&&this.clearTimer()},onHide:function(){this.clearTimer(),this.resetScaleNode()},onStageResize:function(){var e=b8e.stageHeight,t=b8e.stageWidth;this.setPosition(.5*(t-this.width),.5*(e+this.height))},updateData:function(e){var t=game.manyFirstChargeData.getTitleList();if(t&&!(t.length<1)){1==e?this.currIndex--:this.currIndex++;var a=t[this.currIndex-1];game.manyFirstChargeData.selectBtn(a.day),0!=game.rechargeData.chooseId&&this.updateGetBtn(),this.updateBanner(),this.updatePage()}}});b8e.module.registerView(game.ME.ManyFirstCharge,e)}(),function(){var e=game.View.extends({_specialLayer:!0,_model:null,ctor:function(){this._super(661),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e=this.skin,t=this.bg=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(e.bg),t.setAnchor(.5,.5);var a=game.RechargeMiscCfg.getData("ManyFirstAdvertBg"),i=void 0;a&&(i=game.ResCfg.getUrl(70,a.value)),this.bg.loadTexture(i)},onShow:function(){this.send(game.ManyFirstChargeEvts.MANYRECHARGE_SHOWADVERT)},onStageResize:function(){this.send(game.ManyFirstChargeEvts.MANYRECHARGE_SHOWADVERT)}});b8e.module.registerView(game.ME.ManyFirstAdvert,e)}(),function(){var e;e=b8e.Enum({None:0,OPEN_ALERT_GOTO:-1,C2C_LEAVE_TOWER:-1,C2C_OCCUPY_BLOOD:-1,C2C_OCCUPY_FIGHT:-1,C2C_OCCUPY_FLAG:-1,C2C_BIANSHEN:-1}),b8e.RC("$$game","$$GuanDuAlertEvts",e)}(),function(){var e;e=b8e.Enum({None:0,CHANGE_PAGE:-1,V2C_UPDATE_DATA:-1,C2V_UPDATE:-1,C_GUANDU_OPENALERT:-1}),b8e.RC("$$game","$$GuanDuRankEvts",e)}(),function(){var e;e=b8e.Enum({None:0,V_FOLLOW_CHAT:-1,CLICK_CHANGE_BTN:-1,C2V_UPDATE_SCORE:-1,C2C_BIANSHEN:-1,C2V_UPDATA_BTN:-1}),b8e.RC("$$game","$$GuanDuBottomEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_STARE_COUNTDOWN:-1,C2V_CAMP:-1,C2V_UPDATA_BTN:-1,C2V_UPDATA_TEAM:-1}),b8e.RC("$$game","$$GuanDuTopEvts",e)}(),function(){var e;e=b8e.Enum({None:0,CLICK_LEFT_BTN:-1,CLICK_RIGHT_BTN:-1,CLICK_HIGH_BTN:-1,C2C_MOVE_HOME:-1,C2C_MOVE_FLAG:-1,C2C_MOVE_BLOOD:-1,C2C_MOVE_FIGHT:-1}),b8e.RC("$$game","$$GuanDuWindowEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2C_ACTIVE_STATE:-1,C2C_ACTIVE_SCORE:-1,C2C_BIANSHEN_SUCCESS:-1,C2C_FLAG_TOWER_STATE:-1,C2C_BLOOD_TOWER_STATE:-1,C2C_FIGHT_TOWER_STATE:-1,C2C_PLAYER_INFO:-1,C2C_UPDATE_SHOP_COUNT:-1}),b8e.RC("$$game","$$GuanDuEvts",e)}(),function(){var e=game.Control.extends({sureBtn:function(){switch(game.guanDuData.guanduAlertId){case 1:this.attack();break;case 2:this.defense();break;case 3:this.occupy();break;case 4:this.transfiguration();break;case 5:this.leave();break;case 6:this.quit()}game.module.hide(this.moduleEnum)},cancleBtn:function(){game.module.hide(this.moduleEnum)},attack:function(){this.dpt(this.Evts.C2C_OCCUPY_BLOOD)},defense:function(){this.dpt(this.Evts.C2C_OCCUPY_FIGHT)},occupy:function(){this.dpt(this.Evts.C2C_OCCUPY_FLAG)},transfiguration:function(){this.dpt(this.Evts.C2C_BIANSHEN,!game.guanDuData.isChange)},leave:function(){this.dpt(this.Evts.C2C_LEAVE_TOWER)},quit:function(){game.guanDuData.isInActive=!1,b8e.evt.dptG(game.SceneGEvts.SCENE_EXIT);this.createQuitTimer()},createQuitTimer:function(){game.guanDuData.enterCdTime=60,this.timer||(this.timer=b8e.Timer.add(this,this.setCountDown,1e3))},setCountDown:function(){game.guanDuData.enterCdTime-=1,0<game.guanDuData.enterCdTime||this.timer&&(b8e.Timer.remove(this,this.setCountDown),this.timer=null)}});b8e.module.registerControl(game.ME.GuanDuAlert,e,game.GuanDuAlertEvts)}(),function(){var e=game.Control.extends({openAlertEnterBtn:function(){game.moduleOpen.checkOpenWithTips(game.ME.GuanDu)&&this.dpt(this.Evts.OPEN_ALERT_GOTO),game.module.hide(this.moduleEnum)}});b8e.module.registerControl(game.ME.GuanDuOpenAlert,e,game.GuanDuAlertEvts)}(),function(){var e=game.Control.extends({init:function(){game.guanDuRankData.initData()},ipc:function(){this.handels={GuanDuWarActivityResp:this.guanDuRank}},guanDuRank:function(e){var t=e.readProtobuf(game.pb.GuanDuWarActivityResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.ranks,i=t.state;game.guanDuRankData.updateGuanDuRank(a,i);for(var n=game.LoginConfig.serverId,s=0;s<a.length;s++)a[s].zone==n&&(game.guanDuRankData.curRank=a[s].rank);this.send(this.Evts.C2V_UPDATE),i?(game.guanDuData.guanduIsOpen=!0,game.moduleOpen.checkOpen(game.ME.GuanDu)&&!game.guanDuData.isShowOpenAlert&&game.module.show(game.ME.GuanDuOpenAlert)):(game.guanDuData.guanduIsOpen=!1,game.module.hide(game.ME.GuanDuOpenAlert));this.dpt(this.Evts.C_GUANDU_OPENALERT)}},notify:function(e){switch(e){case this.Evts.V2C_UPDATE_DATA:this.sender.GuanDuWarActivityReq()}},left_btn:function(){game.guanDuRankData.pageNum<=1?game.guanDuRankData.pageNum=1:game.guanDuRankData.pageNum=game.guanDuRankData.pageNum-1,this.send(this.Evts.CHANGE_PAGE)},right_btn:function(){game.guanDuRankData.pageNum>=game.guanDuRankData.maxPage?game.guanDuRankData.pageNum=game.guanDuRankData.maxPage:game.guanDuRankData.pageNum=game.guanDuRankData.pageNum+1,this.send(this.Evts.CHANGE_PAGE)}}),t=game.Sender.extends({ipc:function(){this.msg={GuanDuWarActivityReq:null}}});b8e.module.registerControl(game.ME.GuanDuRank,e,game.GuanDuRankEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GuanDu:{C2C_ACTIVE_SCORE:this.updateScore,C2C_BIANSHEN_SUCCESS:this.bianshenSuccess}},this.gevts={SceneGEvts:{C2C_UPDATA_BTN:this.updataBtn}}},updataBtn:function(){this.send(this.Evts.C2V_UPDATA_BTN)},updateScore:function(){this.send(this.Evts.C2V_UPDATE_SCORE)},teamBtn:function(){var e=game.guanDuData.isHasTeam;game.module.show(e?game.ME.CsWarBattleTeam:game.ME.CsWarTeam)},changeBtn:function(){if(game.follow.isFollow())game.notice.show(3927);else{var e=game.guanDuData.isChange;e?this.dpt(this.Evts.C2C_BIANSHEN,!e):(game.guanDuData.guanduAlertId=4,game.module.show(game.ME.GuanDuAlert))}},bianshenSuccess:function(){this.send(this.Evts.CLICK_CHANGE_BTN)},backBtn:function(){game.guanDuData.guanduAlertId=6,game.module.show(game.ME.GuanDuAlert)}});b8e.module.registerControl(game.ME.GuanDuBottom,e,game.GuanDuBottomEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GuanDu:{C2C_ACTIVE_STATE:this.activeState},CsWarTeam:{C2C_HIDE_TEAMBTN:this.updataTopTeam}},this.gevts={SceneGEvts:{C2C_UPDATA_BTN:this.updataBtn,C2C_UPDATA_CAMP:this.updataCamp}}},updataTopTeam:function(){this.send(this.Evts.C2V_UPDATA_TEAM)},updataCamp:function(){this.send(this.Evts.C2V_CAMP)},activeState:function(){this.clearTimer(),this.createTimer()},createTimer:function(){this.Timer||(this.Timer=b8e.Timer.add(this,this.updateTime,1e3),this.Timer.start())},updateTime:function(){game.guanDuData.activeCountdown-=1e3,this.send(this.Evts.C2V_STARE_COUNTDOWN),game.guanDuData.activeCountdown<1&&this.clearTimer()},clearTimer:function(){this.Timer&&(b8e.Timer.remove(this,this.updateTime),this.Timer=null)},updataBtn:function(){this.send(this.Evts.C2V_UPDATA_BTN)},teamBtn:function(){game.guanDuData.isHasTeam?game.module.show(game.ME.CsWarBattleTeam):game.module.show(game.ME.CsWarTeam)}}),t=[game.ME.GuanDuRightTop];b8e.module.registerControl(game.ME.GuanDuTop,e,game.GuanDuTopEvts,null,t)}(),function(){var e=game.Control.extends({leftBtn:function(){this.send(this.Evts.CLICK_LEFT_BTN)},rightBtn:function(){this.send(this.Evts.CLICK_RIGHT_BTN)},flagBtn:function(){this._clickBtn(game.GuanDuTowerType.Flag)},bloodBtn:function(){this._clickBtn(game.GuanDuTowerType.Blood)},fightBtn:function(){this._clickBtn(game.GuanDuTowerType.Fight)},homeBtn:function(){this._clickBtn()},_clickBtn:function(e){if(game.guanDuData.isHold)game.notice.show(3932);else if(game.follow.isFollow())game.notice.show(3933);else{var t=game.GuanDuTowerType;switch(e){case t.Flag:this.dpt(this.Evts.C2C_MOVE_FLAG);break;case t.Blood:this.dpt(this.Evts.C2C_MOVE_BLOOD);break;case t.Fight:this.dpt(this.Evts.C2C_MOVE_FIGHT);break;default:this.dpt(this.Evts.C2C_MOVE_HOME)}}},hideBtn:function(){game.guanDuData.isHide=!game.guanDuData.isHide;var e=game.guanDuData.isHide;this.send(this.Evts.CLICK_HIGH_BTN);var t=b8e.scene.getDisplayByType(game.RoleType.Hero);if(t&&!(t.length<1))for(var a=0,i=t.length,n=void 0;a<i;a++)(n=t[a])&&n.data&&n.data.id!=game.mainRole.id&&n.setVisible(!e)}});b8e.module.registerControl(game.ME.GuanDuWindow,e,game.GuanDuWindowEvts)}(),function(){var e=game.Control.extends({init:function(){this.chat={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"",funcType:null},this.spotAlert=game.spotAlert.set(game.SAE.GUANDU_ALERT,game.SAE.CS_ACTIVITY_ALERT)},ipc:function(){var e=this;e.gevts={SceneGEvts:{SCENE_CHALLENGE:e.challengeRole,C2C_SHOW_ENEMY_TEAM:e.showEnemyTeam,C2C_CHALLENGE:e.challenge,C2C_CHANGE_ROLE:e.otherChange,TOWER_STATE:e.towerStateMsg}},e.evts={GuanDuOpenAlert:{OPEN_ALERT_GOTO:e.openAlertGoto},GuanDuBottom:{C2C_BIANSHEN:e.clickBianshen},GuanDuAlert:{C2C_LEAVE_TOWER:e.leaveTower,C2C_OCCUPY_BLOOD:e.occupyBlood,C2C_OCCUPY_FIGHT:e.occupyFight,C2C_OCCUPY_FLAG:e.occupyFlag,C2C_BIANSHEN:e.clickBianshen},CsWarTeam:{C2C_GUANDU_LOOT:e.guanduLoot},CsActivity:{C2C_GUANDU_GOTO:e.openAlertGoto},GuanDuWindow:{C2C_MOVE_HOME:e.moveToHome,C2C_MOVE_FLAG:e.moveToFlag,C2C_MOVE_BLOOD:e.moveToBlood,C2C_MOVE_FIGHT:e.moveToFight},GuanDuRank:{C_GUANDU_OPENALERT:e.checkAlert}},e.handels={GuanDuWarMsg:e.activityOpen,GuanDuWarJoinResp:e.joinActivity,GuanDuWarStateMsg:e.activityMsg,GuanDuWarDataMsg:e.activityDataMsg,GuanDuWarChallengeResp:e.challengeResponse,GuanDuWarChallengeMsg:e.challengeMsg,GuanDuWarBattleMsg:e.battleMsg,GuanDuWarTowerEffectMsg:e.towerEffectMsg,GuanDuWarBianshenResp:e.bianshenResp,GuanDuWarBianshenMsg:e.bianshenMsg,GuanDuWarLeaveTowerResp:e.leaveTowerResp}},checkAlert:function(){this.spotAlert.alert=game.guanDuData.guanduIsOpen},activityOpen:function(e){var t=e.readProtobuf(game.pb.GuanDuWarNotify);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.state;(game.guanDuData.guanduIsOpen=a)?game.moduleOpen.checkOpenWithTips(game.ME.GuanDu)&&(game.module.show(game.ME.GuanDuOpenAlert),this.chatGdOpen()):this._activeEnd(),this.checkAlert()}},joinActivity:function(e){var t=e.readProtobuf(game.pb.GuanDuWarJoinResponse);0<t.code?game.notice.noticeError(t.code):(game.guanDuData.guanduIsOpen=!0,game.module.hide(game.ME.GuanDuOpenAlert),game.module.hide(game.ME.ActivitiesHall),game.shopData.setCACount(game.ShopConditionType.SHOPGUANDU)&&this.dpt(this.Evts.C2C_UPDATE_SHOP_COUNT),this.checkAlert())},activityMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarStateNotify);if(0<t.code)game.notice.noticeError(t.code);else{game.guanDuData.activeState=t.state,game.guanDuData.activeCountdown=1e3*t.remTime,this.dpt(this.Evts.C2C_ACTIVE_STATE),0==t.state&&this._activeEnd()}},_activeEnd:function(){b8e.module.isShowView(game.ME.GuanDuOpenAlert)&&game.module.hide(game.ME.GuanDuOpenAlert),game.guanDuData.isInActive&&(game.guanDuData.isInActive=!1),b8e.module.isShowView(game.ME.GuanDuEnd)||game.module.show(game.ME.GuanDuEnd)},activityDataMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarDataNotify);0<t.code?game.notice.noticeError(t.code):(game.guanDuData.holder=t.master,game.guanDuData.teamTime1=t.campScore1,game.guanDuData.teamTime2=t.campScore2,this.dpt(this.Evts.C2C_ACTIVE_SCORE))},challengeResponse:function(e){var t=e.readProtobuf(game.pb.GuanDuWarChallengeResponse);if(0<t.code)game.notice.noticeError(t.code);else{if(game.challengeIcon.hide(),game.guanDuData.isChange){if(!t.bianshen)return;if(b8e.scene.getDisplayByTypeAndId(game.RoleType.Tower,t.targetUnitId)){var a=game.guanDuData.getTowerDataById(t.targetUnitId);if(a&&a.master)return void game.notice.show(3928)}}if(t.battlelog){var i={type:game.InstanceType.GUANDU};game.playBack.play(t.battlelog,i),t.battlelog.win?this.chatChallengeWin(t.victimName):this.chatChallengeLost(t.victimName)}}},challengeMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarChallengeNotify);if(0<t.code)game.notice.noticeError(t.code);else{t.targetUnitId,t.bianshen,t.victimName;if(game.challengeIcon.hide(),t.battlelog){var a={type:game.InstanceType.GUANDU};game.playBack.play(t.battlelog,a)}}},battleMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarBattleNotify);if(0<t.code)game.notice.noticeError(t.code);else if(t.battlelog){var a={type:game.InstanceType.GUANDU};game.playBack.play(t.battlelog,a),t.battlelog.win?this.chatBeChallengeLost(t.challengerName):this.chatBeChallengeWin(t.challengerName)}},towerEffectMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarTowerEffectNotify);0<t.code?game.notice.noticeError(t.code):t.isMaster&&(t.id==game.GuanDuTowerType.Fight?game.notice.show(9505,t.value):t.id==game.GuanDuTowerType.Blood&&game.notice.show(9506,t.value))},bianshenResp:function(e){var t=e.readProtobuf(game.pb.GuanDuWarBianshenResponse);0<t.code&&game.notice.noticeError(t.code)},bianshenMsg:function(e){var t=e.readProtobuf(game.pb.GuanDuWarBianshenNotify);0<t.code?game.notice.noticeError(t.code):(t.unitId==game.mainRole.id&&(game.guanDuData.isChange=t.bianshen,this.dpt(this.Evts.C2C_BIANSHEN_SUCCESS)),game.guanDuData.bianShen(t.unitId,t.bianshen))},leaveTowerResp:function(e){var t=e.readProtobuf(game.pb.GuanDuWarLeaveTowerResponse);0<t.code?game.notice.noticeError(t.code):(game.guanDuData.isHold=!1,game.module.hide(game.ME.GuanDuAlert))},moveToHome:function(){var e=game.guanDuData.homePos;game.sceneHelper.moveToPos(e),game.guanDuData.isChase&&(game.guanDuData.isChase=!1)},moveToFlag:function(){this._moveTo(game.GuanDuTowerType.Flag)},moveToBlood:function(){this._moveTo(game.GuanDuTowerType.Blood)},moveToFight:function(){this._moveTo(game.GuanDuTowerType.Fight)},_moveTo:function(e){var t=game.guanDuData.getTowerData(e);t&&(1!=game.guanDuData.activeState?(game.sceneHelper.moveToPos(t.pos),game.guanDuData.isChase&&(game.guanDuData.isChase=!1)):game.notice.show(3917))},challengeRole:function(){if(game.sceneData.getSceneType()==game.SceneType.GUANDU_MAP){var e=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(game.mainRole.gridX,game.mainRole.gridY),t=game.CsEventAreaEnum,a=game.mainRole.data;(e==t.ENTER_ARE_YUAN&&12==a.campId||e==t.ENTER_AREA_CAO&&11==a.campId)&&game.notice.show(9153);var i=game.sceneHelper.chaseEntiy;if(i){var n=i.data;if(n){var s=game.guanDuData;if(0==n.teamFollow)0==n.occupyId?this.reqChallenge(n.id,s.isChange):this.reqChallenge(n.occupyId,s.isChange,n.id);else{var o=n.teamFollow,r=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,o);if(!r||!r.data)return;0==r.data.occupyId?this.reqChallenge(o,s.isChange):this.reqChallenge(r.data.occupyId,s.isChange,o)}}}}},showEnemyTeam:function(){var e=void 0,t=game.guanDuData.isChange,a=game.GuanDuTowerType;switch(game.guanDuData.challengeId){case 1:e=a.Fight;break;case 2:e=a.Blood;break;case 3:e=a.Flag}var i=game.guanDuData.getTowerData(e);i&&(t?this.reqChallenge(i.id,t,i.master):this.dpt(this.Evts.C2C_PLAYER_INFO,i.master))},guanduLoot:function(){var e=void 0,t=game.GuanDuTowerType;switch(game.guanDuData.challengeId){case 1:e=t.Fight;break;case 2:e=t.Blood;break;case 3:e=t.Flag}var a=game.guanDuData.getTowerData(e);if(a){if(a.master){var i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,a.master);if(i&&i.data&&i.data.isFighting)return void game.notice.show(6989)}this.reqChallenge(a.id,game.guanDuData.isChange,a.master)}},occupyBlood:function(){this._occupy(game.GuanDuTowerType.Blood)},occupyFight:function(){this._occupy(game.GuanDuTowerType.Fight)},occupyFlag:function(){this._occupy(game.GuanDuTowerType.Flag)},_occupy:function(e){var t=game.guanDuData.getTowerData(e);t&&this.reqChallenge(t.id,game.guanDuData.isChange)},reqChallenge:function(e,t,a){this.sender.GuanDuWarChallengeReq(e,t,a)},openAlertGoto:function(){var e=game.guanDuData.enterCdTime;0<e?game.notice.show(52221,e):game.moduleOpen.checkOpenWithTips(game.ME.GuanDu)&&this.sender.GuanDuWarJoinReq()},clickBianshen:function(e){var t=e.data;this.sender.GuanDuWarBianshenReq(t)},leaveTower:function(){this.sender.GuanDuWarLeaveTowerReq()},challenge:function(e){if(e.data){var t=e.data;game.guanDuData.activeCamp!=t.campId?0==t.occupyId?this.reqChallenge(t.id,game.guanDuData.isChange):this.reqChallenge(t.occupyId,t.id,game.guanDuData.isChange):game.notice.show(3922)}},towerStateMsg:function(e){if(game.sceneData.getSceneType()==game.SceneType.GUANDU_MAP){var t=e.data;if(t){var a=t.state,i=t.playerUnitId,n=t.towerUnitId;i==game.mainRole.id&&a?(game.guanDuData.isHold=!0,game.mainRole.data.occupyId=n):n==game.mainRole.data.occupyId&&(game.guanDuData.isHold=!1,game.mainRole.data.occupyId=0);var s=game.guanDuData.getTowerDataById(n);if(s){if(s.master=a?i:0,a){var o=game.GuanDuTowerType;switch(s.towerId){case o.Flag:this.chatHoldFlag(i);break;case o.Blood:this.chatHoldBlood(i);break;case o.Fight:this.chatHoldFight(i)}}var r=b8e.scene.getDisplayByTypeAndId(game.RoleType.Tower,s.id);if(r&&r.data){r.data.master=s.master;var g=game.guanDuData.getTowerBar(s.id);g&&g.updataBar(r)}}var l=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,i);l&&l.data&&(l.data.occupyId=a?n:0,l.data.campId!=game.mainRole.data.campId?game.guanDuData.towerIsEmeny=!0:l.data.campId==game.mainRole.data.campId&&(game.guanDuData.towerIsSelf=!0))}}},otherChange:function(e){var t=e.data;game.guanDuData.bianShen(t,!0)},chatHoldFight:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_HOLD_FIGHT,"gd_hold_fight",game.Lang.get(9154),e)},chatHoldBlood:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_HOLD_BLOOD,"gd_hold_blood",game.Lang.get(9155),e)},chatHoldFlag:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_HOLD_FLAG,"gd_hold_flag",null,e)},chatChallengeWin:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_CHALLENGE_WIN,"gd_challenge_win",e)},chatChallengeLost:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_CHALLENGE_LOST,"gd_challenge_lost",e)},chatBeChallengeWin:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_BE_CHALLENGE_WIN,"gd_be_challenge_win",e)},chatBeChallengeLost:function(e){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_BE_CHALLENGE_LOST,"gd_be_challenge_lost",e)},chatGdOpen:function(){this._chatMsg(game.ChatFuncType.CHAT_FUNC_GD_OPEN,"gd_open")},_chatMsg:function(e,t,a,i){if(this.chat.marqueeKey=t,this.chat.funcType=e,a&&(this.chat.roleName=a),i){var n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,i);if(!n||!n.data)return;this.chat.content=11==n.data.campId?game.Lang.get(9156):game.Lang.get(9157)}game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)}}),t=[game.ME.GuanDuEnd],a=game.Sender.extends({ipc:function(){this.msg={GuanDuWarJoinReq:null,GuanDuWarChallengeReq:this.guanDuWarChallengeReq,GuanDuWarBianshenReq:this.guanDuWarBianshenReq,GuanDuWarLeaveTowerReq:null}},guanDuWarChallengeReq:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:0,n=a,s=game.pb.GuanDuWarChallengeRequest;s.targetUnitId=e,n&&(s.master=n),s.bianshen=i,this.write(s)},guanDuWarBianshenReq:function(e){var t=game.pb.GuanDuWarBianshenRequest;t.bianshen=e,this.write(t)}});b8e.module.registerControl(game.ME.GuanDu,e,game.GuanDuEvts,a,t)}(),function(){var e=b8e.Object.extends({guanDuRankMap:null,curRank:0,pageNum:1,maxPage:1,PER_PAGE_COUNT:6,initData:function(){this.guanDuRankMap=b8e.HashMap.get()},updateGuanDuRank:function(e){for(var t,a,i=e.length,n=0;n<i;n++)a=e[n],(t=new game.GuanDuRankItemInfo).setData(a),this.guanDuRankMap.set(t.rank,t);this.maxPage=Math.ceil(i/this.PER_PAGE_COUNT)},getDataByPage:function(){this.pageNum<=0&&(this.pageNum=1);var e=this.PER_PAGE_COUNT,t=null,a=this.guanDuRankMap.values(),i=(this.pageNum-1)*e,n=this.pageNum*e,s=a.length;if(n=Math.min(n,s),i<s){t=[];for(var o=i;o<n;o++){var r=a[o];r&&t.push(r)}}return t}});game.guanDuRankData=game.guanDuRankData||new e}(),function(){var e;e=b8e.Object.extends({rank:1,zone:"",score:0,priceList:null,ctor:function(){this._super()},setData:function(e){if(e){this.rank=e.rank,this.zone=e.zone,this.score=e.score,this.priceList=this.getPrizeListByRank(e.rank)}},getPrizeListByRank:function(e){for(var t=game.GuanDuWarRankAwardCfg.getDatas(),a=t.length,i=[],n=0;n<a;n++)if(e<=t[n].rank){i=t[n].items;break}if(!i)return null;for(var s,o,r=[],g=(a=i.length,0);g<a;g++)s=i[g],o=game.ItemUtil.createBaseItemInfo(s.Id,s.Num),r.push(o),o.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM;return r}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuanDuRankItemInfo",e)}(),function(){var e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e.isHold=!1,e.homePos=null,e.isHasTeam=!1,e.isChase=!1,e.canTeam=!1,e.challengeId=0,e.towerIsEmeny=!1,e.towerIsSelf=!1,e.guanduIsOpen=!1,e.firstEnter=!0,e.isShowOpenAlert=!1,e.isInActive=!1,e.ambitonIds=null,e.guanduAlertId=1,e.isHide=!1,e.activeState=0,e.activeCountdown=0,e.activeCamp=0,e.isChange=!1,e.holder=0,e.teamTime1=0,e.teamTime2=0,e.enterCdTime=0},calMmodifySceneRole:function(e){if(e){var t=e.data;if(t){if(game.mainRole.data.campId)t.campId!=game.mainRole.data.campId&&e.updateNameColor(game.Color.RED);else if(game.mainRole.data.roleId==e.data.roleId){game.mainRole.data=t;var a=b8e.scene.getDisplayByType(game.RoleType.Hero);if(a&&0<a.length)for(var i=0,n=a.length,s=void 0,o=void 0;i<n;i++)(s=a[i])&&(o=s.data).campId!=game.mainRole.data.campId&&o.id!=game.mainRole.id&&s.updateNameColor(game.Color.RED)}this.isHide&&t.id!=game.mainRole.id&&e.setVisible(!this.isHide),t.teamId&&game.follow.updateTeamFollower(t.id,t.teamLeaderIdx)}}},clickEntiy:function(e){if(this.isHold)game.notice.show(3921);else if(e.type==game.RoleType.Hero){if(this.activeCamp==e.data.campId)return void game.notice.show(3922);if(this.isChange)return void game.notice.show(3924);var t=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(e.gridX,e.gridY);t==game.CsEventAreaEnum.ENTER_ARE_YUAN?game.notice.show(3923):t==game.CsEventAreaEnum.ENTER_AREA_CAO?game.notice.show(3923):(game.sceneHelper.lastSceneEntiy=e,this.challengeId=4,game.challengeIcon.show(e,2))}else if(e.type==game.RoleType.Tower){if(game.sceneHelper.calEntiyDistance(e)<=5)if(0<e.data.master){var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.data.master);a&&a.data&&a.data.campId==game.mainRole.data.campId&&game.notice.show(3925)}else this.clickTower(e);else game.sceneHelper.moveToEntiy(e,3);this.isChase&&(this.isChase=!1)}},checkClickMap:function(e){if(1!=this.activeState)return this.isHold?(this.guanduAlertId=5,void game.module.show(game.ME.GuanDuAlert)):void(game.follow.isFollow()?game.notice.show(3918):(this.isChase&&(this.isChase=!1),this.moveCheck(e)));game.notice.show(3917)},clickTower:function(e){if(e&&e.data){var t=e.data,a=this.getTowerData(t.roleId);if(a){var i=game.GuanDuTowerType,n=void 0;switch(a.towerId){case i.Flag:n=3;break;case i.Blood:n=1;break;case i.Fight:n=2}this.guanduAlertId=n,game.module.show(game.ME.GuanDuAlert)}}},moveCheck:function(e){game.sceneHelper.isClickMap=!0;var t=game.mainRole.data.guanduMapEvent;(5003!=t&&5004!=t&&5005!=t||4==this.challengeId)&&game.challengeIcon.hide();var a=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(e.x,e.y);a==game.CsEventAreaEnum.ENTER_ARE_YUAN?11==game.mainRole.data.campId?game.notice.show(3926):12==game.mainRole.data.campId&&game.sceneHelper.moveToPos(e):a==game.CsEventAreaEnum.ENTER_AREA_CAO?(11==game.mainRole.data.campId&&game.sceneHelper.moveToPos(e),12==game.mainRole.data.campId&&game.notice.show(3926)):game.sceneHelper.moveToPos(e)},addEvent:function(){this.eventAreaChecker||(this.eventAreaChecker=new game.CsEventAreaChecker,game.mainRole.addSyncInfo(new b8e.SceneDisplaySyncInfo(this.eventAreaChecker)))},bianShen:function(e,t){var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e);if(a&&a.data){var i=a.data,n=i.heroModel;if(n.clear(),this.ambitonIds||(this.ambitonIds={}),t){var s=game.RoleType.Hero,o=i.campId;t&&(11==o?s=game.RoleType.BianshenBlue:12==o&&(s=game.RoleType.BianshenRed)),n.type=s,this.ambitonIds[e]=0<i.ambiton?i.ambiton:n.ambiton,i.ambiton=0}else{var r=game.HeroData.get(),g=game.scene.getUnit(e);if(!g)return;r.setUnitData(g);var l=0;this.ambitonIds[e]&&(l=this.ambitonIds[e],i.ambiton=l),n.setBody(game.RoleType.Hero,r.heroModel.body),n.setSurfaces(r.heroModel.surface)}game.AvatarUtil.update(a),e!=game.mainRole.id&&this.isHide&&a.clearFosterAnim()}},setChange:function(){var e=b8e.scene.getDisplayByType(game.RoleType.Hero);if(e&&!(e.length<1))for(var t=0,a=e.length,i=void 0,n=void 0;t<a;t++)if((i=e[t])&&i.data&&(n=i.data).id!=game.mainRole.data.id&&n.isBianshen){b8e.evt.dptG(game.SceneGEvts.C2C_CHANGE_ROLE,n.id);break}},moveToPos:function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.id);if(t&&t.data){var a=t.data;if(!a.teamId)return t.stopAi(),void t.setGridPosition(e.x,e.y);var i=b8e.scene.getDisplayByType(game.RoleType.Hero);if(i&&!(i.length<1)){for(var n=0,s=i.length,o=void 0,r=void 0;n<s;n++)(o=i[n])&&(r=o.data).teamId==a.teamId&&r.id!=a.id&&(o.stopAi(),o.setGridPosition(e.x,e.y));t.stopAi(),t.setGridPosition(e.x,e.y)}}},setTowerData:function(e){var t=e.tower;if(t){this._towerMap||(this._towerMap=b8e.HashMap.get());var a=this.getObj();a.id=e.id,a.towerId=t.id,a.master=t.master,a.pos.x=e.x,a.pos.y=e.y,this._towerMap.set(a.towerId,a)}},getObj:function(){var e=void 0;return this._objPool&&0<this._objPool.length&&(e=this._objPool.pop())?e:e={id:0,towerId:0,master:0,pos:{x:0,y:0}}},getTowerData:function(e){return this._towerMap?this._towerMap.get(e):null},getTowerDataById:function(a){if(!this._towerMap)return null;var i=void 0;return this._towerMap.forEach(function(e,t){!t||t.id!=a||i||(i=t)},this),i},getTowerBar:function(e){var t=void 0;if(this._towerArr&&(t=this._towerArr[e]))return t;this._towerArr||(this._towerArr=[]);var a=new game.towerBar;return a.setLocalZOrder(50),a.setPosition(0,100),this._towerArr[e]=a},clearBar:function(){var i=this;if(!i._towerMap)return null;i._towerMap.forEach(function(e,t){if(t){var a=i.getTowerBar(t.id);a&&a.parent&&a.removeFromParent(),i._objPool||(i._objPool=[]),t.id=0,t.towerId=0,t.master=0,t.pos.x=0,t.pos.y=0,i._objPool.push(t)}},i),i._towerArr&&(i._towerArr.length=0)},clear:function(){var e=this;e.isHold=!1,e.homePos=null,e.isHasTeam=!1,e.isChase=!1,e.canTeam=!1,e.challengeId=0,e.towerIsEmeny=!1,e.towerIsSelf=!1,e.firstEnter=!0,e.isShowOpenAlert=!1,e.ambitonIds=null,e.isChange=!1,e.holder=0,e.teamTime1=0,e.teamTime2=0,e.clearBar(),e._towerMap&&e._towerMap.clear(),e.eventAreaChecker&&(game.mainRole.removeSyncInfo(e.eventAreaChecker),e.eventAreaChecker=null)}});game.guanDuData=game.guanDuData||new e}(),function(){var e;e=b8e.Enum({None:0,Fight:200,Blood:201,Flag:202,YuXi:203}),b8e.RC("$$game","$$GuanDuTowerType",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(498)},onShow:function(){var e=game.guanDuData.guanduAlertId,t=game.Lang.get(3910+e);this.skin.tipLab.string=t},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*e,.5*t+100)}});b8e.module.registerView(game.ME.GuanDuAlert,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(501)},onShow:function(){game.guanDuData.isShowOpenAlert=!0},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth-this.width;this.setPosition(e-17,320)}});b8e.module.registerView(game.ME.GuanDuOpenAlert,e)}(),function(){var e=game.View.extends({rankList:null,ctor:function(){this._super(503)},init:function(){var e=this.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.GuanDuRankItem,e.bindEnum=game.ME.GuanDuRank,e.addToParent(this.skin.listNode),e.layout.paddingLeft=12,e.layout.paddingTop=10,e.layout.spacingY=10},notify:function(e){switch(e){case this.Evts.CHANGE_PAGE:this.updatePage(),this.updateList();break;case this.Evts.C2V_UPDATE:game.guanDuRankData.pageNum=1,this.updatePage(),this.updateList()}},onShow:function(){this.send(this.Evts.V2C_UPDATE_DATA)},updateList:function(){var e=game.guanDuRankData.getDataByPage();this.rankList.setData(e);var t=game.guanDuRankData.curRank;this.skin.self_rank.string=0==t?game.Lang.get(9069):t},updatePage:function(){this.skin.page_lab.string=game.guanDuRankData.pageNum+"/"+game.guanDuRankData.maxPage},onHide:function(){game.guanDuRankData.pageNum=1}});b8e.module.registerView(game.ME.GuanDuRank,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(502),this.setSize(550,90)},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ShowItemListItem,e.addToParent(this.skin.listNode)},setData:function(){this.onClear();var e=this.data;if(e){var t=this.skin,a=e.priceList;this.prizeList.setData(a),1==e.rank?t.first_root.active=!0:2==e.rank?t.second_root.active=!0:3==e.rank?t.third_root.active=!0:(t.other_root.active=!0,t.rank_lab.string=e.rank),t.serverLab.string=game.Lang.get(9512,e.zone),t.winLab.string=game.Lang.get(9513,e.score)}},onClear:function(){var e=this.skin;e.first_root.active=!1,e.second_root.active=!1,e.third_root.active=!1,e.other_root.active=!1,e.rank_lab.string=""}}),b8e.RC("$$game","$$GuanDuRankItem",e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(499),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){var t=this.Evts;switch(e){case t.CLICK_CHANGE_BTN:this.change();break;case t.C2V_UPDATE_SCORE:this.updateScore();break;case t.C2V_UPDATA_BTN:this.updataBtn()}},onShow:function(){var e=game.HtmlUtil.getText(game.Color.GREEN,game.Lang.get(9158));this.skin.belongLab.string=game.Lang.get(9507,e),e=game.HtmlUtil.getText(game.Color.GREEN,"0s"),this.skin.camp1Lab.string=game.Lang.get(9508,e),this.skin.camp2Lab.string=game.Lang.get(9509,e),this.change(),this.updataBtn(),this.updateScore(),this.onStageResize()},onHide:function(){},updateScore:function(){var e=game.guanDuData.getTowerData(game.GuanDuTowerType.Flag);if(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e.master);if(t){var a=game.guanDuData.holder,i="";0==a?i=game.Lang.get(9158):1==a?i=game.Lang.get(9510,t.data.zone):2==a&&(i=game.Lang.get(9511,t.data.zone));var n=game.Lang.get(9159),s=game.HtmlUtil.getText(game.Color.GREEN,i);this.skin.belongLab.string=n+s,n=game.Lang.get(9160),s=game.HtmlUtil.getText(game.Color.GREEN,game.guanDuData.teamTime1+"s"),this.skin.camp1Lab.string=n+s,n=game.Lang.get(9161),s=game.HtmlUtil.getText(game.Color.GREEN,game.guanDuData.teamTime2+"s"),this.skin.camp2Lab.string=n+s}}},change:function(){var e=this.skin,t=game.guanDuData.isChange;e.change1.node.active=!t,e.change2.node.active=t},updataBtn:function(){var e=this.skin;e.teamBtn.active=game.guanDuData.canTeam,e.changeBtn.active=game.guanDuData.canTeam},onStageResize:function(){var e=this.skin,t=b8e.stageWidth;b8e.stageHeight;this.setPosition(0,280),e.backBtn.x=t-.5*e.backBtn.width,e.msgBg.x=.5*t,e.teamBtn.x=.5*(t-e.teamBtn.width)-20,e.changeBtn.x=.5*(t+e.changeBtn.width)+20}});b8e.module.registerView(game.ME.GuanDuBottom,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(505),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.C2V_STARE_COUNTDOWN:this.updataData()}},updataData:function(){var e=1==game.guanDuData.activeState?game.Lang.get(9162):game.Lang.get(9163),t=game.TimeUtil.formatTimeSpace(game.guanDuData.activeCountdown,3),a=game.HtmlUtil.getText(game.Color.GREEN,t);this.skin.countdownLab.string=e+a},createTimer:function(){this.Timer||(this.Timer=b8e.Timer.add(this,this.updateTime,1e3),this._lastTime=b8e.timeStamp,this.Timer.start())},clearTimer:function(){this.Timer&&(b8e.Timer.remove(this,this.updateTime),this.Timer=null)},updateTime:function(){var e=b8e.timeStamp,t=e-this._lastTime;this._lastTime=e,game.guanDuData.activeCountdown-=t;var a=1==game.guanDuData.activeState?game.Lang.get(9162):game.Lang.get(9163),i=game.TimeUtil.formatTimeSpace(game.guanDuData.activeCountdown,3),n=game.HtmlUtil.getText(game.Color.GREEN,i);this.skin.countdownLab.string=a+n,game.guanDuData.activeCountdown<1&&this.clearTimer()},onHide:function(){this.clearTimer()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e-140,t-80)}});b8e.module.registerView(game.ME.GuanDuTop,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(506),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e){switch(e){case this.Evts.CLICK_LEFT_BTN:this.left();break;case this.Evts.CLICK_RIGHT_BTN:this.right();break;case this.Evts.CLICK_HIGH_BTN:this.hideOther()}},onShow:function(){var e=this.skin;e.showNode.active=!0,e.hideNode.active=!1},onHide:function(){},left:function(){var e=this.skin;e.showNode.active=!0,e.hideNode.active=!1},right:function(){var e=this.skin;e.showNode.active=!1,e.hideNode.active=!0},hideOther:function(){this.skin.ok.node.active=game.guanDuData.isHide},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e,t/2+220)}});b8e.module.registerView(game.ME.GuanDuWindow,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(267)},init:function(){this.skin.masterPage.active=!1,this.skin.challengeBtn.active=!1,this.skin.team.active=!0;var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.CsWarBattleTeamItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.CsWarTeam},onShow:function(){this.updateList()},onHide:function(){},view_changeBtn:function(){},updateList:function(){this.teamInfoList=game.csWarTeamData.getChallengeTeam(),this.list.setData(this.teamInfoList)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GuanDuChallenge,e)}(),function(){var e=game.View.extends({_cfg:null,_showModel:!0,countDownTime:10,ctor:function(){this._super(500)},init:function(){var e=this;e.sortList=[],e.camp1={langKey:3735,score:0},e.sortList.push(e.camp1),e.camp2={langKey:3736,score:0},e.sortList.push(e.camp2),e.camp3={langKey:3737,score:0},e.sortList.push(e.camp3)},onShow:function(){var e=this.skin,t=game.guanDuData.teamTime1,a=void 0,i=void 0;i=game.guanDuData.teamTime2<t?(a=game.Lang.get(6998),game.Lang.get(6999)):(a=game.Lang.get(6999),game.Lang.get(6998)),e.camp1.string=a,e.camp2.string=i,this.countDownTime=10,e.returnLab.string=game.Lang.get(9496,this.countDownTime),this.createCountDown()},createCountDown:function(){this.timer||(this.timer=b8e.Timer.add(this,this.updateTime,1e3)),this.timer.reset(),this.timer.start()},clearCountDown:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},updateTime:function(){this.countDownTime--,this.skin.returnLab.string=game.Lang.get(9496,this.countDownTime),this.countDownTime<1&&(this.clearCountDown(),game.module.hide(game.ME.GuanDuEnd))},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GuanDuEnd,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_YONGZHE_UPDATE_AWARD_STATE:b8e.enc(),C2V_YONGZHE_UPDATE_DATA:b8e.enc(),C2V_YONGZHE_DAILY_MODULE_DATA:b8e.enc(),C2V_YONGZHE_SWITCH_PAGE:b8e.enc(),C2V_YONGZHE_ACHIEVE_UP_BTN:b8e.enc(),C2V_YONGZHE_ACHIEVE_DOWN_BTN:b8e.enc(),V2C_YONGZHE_GET_AWARD:b8e.enc(),V2C_YONGZHE_RANK_LEVEL_REQ:b8e.enc(),C2C_YONGZHE_RANK_LEVEL_REQ:b8e.enc(),C2C_UPDATE_WORLD_LV:b8e.enc()}),b8e.RC("$$game","$$YongzheWelfareEvts",e)}(),function(){var e,t=e=b8e.Object.extends({globalLevel:0,langKey:0,prizes:null,ctor:function(){this._super(),this.prizes=[]},setPrize:function(e,t){var a=new game.PrizeInfo;a.id=e,a.num=t,this.prizes.push(a)}});b8e.BindingUtil.bind(t),b8e.RC("$$game","$$YongzhePrizeInfo",e)}(),function(){var e,t=e=b8e.Object.extends({score:0,prizeInfo:null,isCanGet:!1,isGet:!1,ctor:function(){this._super(),this.prizeInfo=new game.PrizeInfo},reset:function(){this.score=0,this.prizeInfo&&(this.prizeInfo.id=0,this.prizeInfo.num=0,this.prizeInfo.iconSize=0),this.isGet=!1,this.isCanGet=!1}});b8e.BindingUtil.bind(t),b8e.RC("$$game","$$YongzheInfo",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.EXP=1,this.DIAMOND=2,this.maxScore=0,this.canGetLen=0,this.worldLv=0},resetDaily:function(){this.maxScore=0,this.canGetLen=0,this.worldLv=0,this._recycleInfoList(),this._expWelfare&&(this._expWelfare.length=0)},onSyncData:function(e){this._expWelfare=e.expWelfare,this._expWelfare&&this._expWelfare.length&&(this.canGetLen=this._expWelfare.length)},setWorldLevel:function(e){if(e&&!(e.length<1)){for(var t=0,a=0,i=void 0,n=e.length>this.worldLevelDiff?this.worldLevelDiff:e.length;t<n;t++)(i=e[t])&&(a+=i.level);this.worldLv=a/n>>0,this.updateYongzheList(),this.updateAwardGetState()}},updateYongzheList:function(){var e=this;if(e.worldLv){var t=e.getFitWorldLevel(e.worldLv);if(t){var a=game.YongzheWelfareCfg.getData(t,!0);if(a&&!(a.length<1)){e._recycleInfoList(),e._infoList||(e._infoList=[]);for(var i=void 0,n=0,s=a.length,o=void 0,r=game.mainRoleData.lv,g=void 0,l=void 0,c=Math.abs(r-e.worldLv),h=r>=e.worldLv||c<e.worldLevelDiff+1;n<s;n++){if(!(o=a[n]))return;(i=e._getInfo()).score=o.score,e._isGet(i.score)?(i.isGet=!0,i.isCanGet=!1):e._isCanGet(i.score)&&(i.isCanGet=!0),l=h?(g=21,o.gold):(g=220001,o.exp),i.prizeInfo.id=g,i.prizeInfo.num=l,e._infoList.push(i)}return e.maxScore=o.score,e._infoList}}}},getYongzheList:function(){return this._infoList},_getInfo:function(){return this._infoPool&&0<this._infoPool.length?this._infoPool.pop():new game.YongzheInfo},_recycleInfoList:function(){if(this._infoList&&!(this._infoList.length<1))for(var e=void 0;this._infoList.length;)(e=this._infoList.pop())&&(e.reset(),this._infoPool||(this._infoPool=[]),this._infoPool.push(e))},worldLevelDiff:{get:function(){if(this._worldLevelDiff)return this._worldLevelDiff;var e=game.CfgUtil.getMiscValue(game.WelfareMiscCfg,"worldLevelDiff");return this._worldLevelDiff=+e,this._worldLevelDiff}},expWelfareOpenDay:{get:function(){if(this._expWelfareOpenDay)return this._expWelfareOpenDay;var e=game.CfgUtil.getMiscValue(game.WelfareMiscCfg,"expWelfareOpenDay");return this._expWelfareOpenDay=+e,this._expWelfareOpenDay}},getFitWorldLevel:function(e){var t=this.getYongzheLevels();return game.SearchUtil.findLastEqualSmaller(t,e)},getYongzheLevels:function(){if(this._worldLevels&&0<this._worldLevels.length)return this._worldLevels;var e=game.CfgUtil.getMiscValue(game.WelfareMiscCfg,"yongzheLevels",!0,"|",!0);return this._worldLevels=e},getExpBonus:function(){var e=game.mainRoleData.lv;if(e<+game.CfgUtil.getMiscValue(game.HangUpMiscCfg,"worldLevelLimit")||e>=this.worldLv)return 0;var t=Math.abs(e-this.worldLv),a=10;return 5<=t&&40<=(a+=5*Math.floor(t/5))&&(a=40),a},getExpList:function(){return this._getPrizeListByType(this.EXP)},getDiamondList:function(){return this._getPrizeListByType(this.DIAMOND)},_getPrizeListByType:function(e){var t=this,a=void 0;if(t._typeList&&0<t._typeList.length&&(a=t._typeList[e])&&0<a.length)return a;t._typeList||(t._typeList=[]);var i=game.YongzheWelfareCfg.getDatas();if(!i||i.length<1)return null;for(var n=b8e.HashMap.get(),s=0,o=i.length,r=void 0,g=void 0,l=void 0,c=void 0;s<o;s++)if(r=i[s]){e==t.EXP?(g=220001,l=r.exp):e==t.DIAMOND&&(g=21,l=r.gold);var h=r.globalLevel;(c=n.get(h))||((c=new game.YongzhePrizeInfo).globalLevel=r.globalLevel,c.langKey=r.langKey,n.set(h,c)),c.setPrize(g,l)}return(a=n.values())&&1<a.length&&a.sort(t.onSort),t._typeList[e]||(t._typeList[e]=a),a},onSort:function(e,t){return e.globalLevel-t.globalLevel},updateAwardGetState:function(){var e=this._infoList;if(e&&!(e.length<1))for(var t=0,a=e.length,i=void 0;t<a;t++)(i=e[t])&&(this._isGet(i.score)?(i.isGet=!0,i.isCanGet=!1):this._isCanGet(i.score)&&(i.isCanGet=!0))},setExtWelfare:function(e){this._expWelfare||(this._expWelfare=[]),this._expWelfare.push(e),this.canGetLen=this._expWelfare.length},_isGet:function(e){if(this._expWelfare&&!(this._expWelfare.length<1))return-1!=this._expWelfare.indexOf(e)},_isCanGet:function(e){return e<=game.dailyExploitData.experienceExpDaily},updateInfoByScore:function(e){var t=this._infoList;if(!t||t.length<1)return!1;for(var a=0,i=t.length,n=void 0;a<i;a++)if((n=t[a])&&n.score==e){n.isGet=!0,n.isCanGet=!1;break}},isOpen:function(){return!(game.miscData.openServerDay<this.expWelfareOpenDay)&&!!game.moduleOpen.checkOpen(game.ME.YongzheWelfare)},isAlert:function(){if(!this.isOpen())return!1;if(2<this.canGetLen)return!1;var e=this._infoList;if(!e||e.length<1)return!1;for(var t=0,a=e.length,i=void 0;t<a;t++)if((i=e[t])&&i.isCanGet)return!0;return!1}});game.yongzheData=game.yongzheData||new e}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.YONGZHE_WELFARE,game.SAE.WELFARE_ALERT)},ipc:function(){this.evts={DailyFuLi:{C_INIT_MODULE:this.dailyModuleData},DailyExploit:{C_DAILYEXPLOIT_EXP:this.dailyExploitExp},Rank:{C2C_RANK_RESPONSE:this.onRankResp},MainRole:{C_RESET_DAILY:this.resetDaily}},this.gevts={SceneGEvts:{FIRST_ENTER_SCENE:this.firstEnterScene}},this.handels={ExpWelfareResp:this.expWelfareResp}},notify:function(e,t){switch(e){case this.Evts.V2C_YONGZHE_GET_AWARD:t&&this._awardWelfareReq(t.score);break;case this.Evts.V2C_YONGZHE_RANK_LEVEL_REQ:this._reqRankLevel()}},resetDaily:function(){game.yongzheData.isOpen()&&(game.yongzheData.resetDaily(),this._reqRankLevel(),this.send(this.Evts.C2V_YONGZHE_UPDATE_DATA))},firstEnterScene:function(){game.yongzheData.isOpen()&&this._reqRankLevel()},_reqRankLevel:function(){this.dpt(this.Evts.C2C_YONGZHE_RANK_LEVEL_REQ,game.RankType.RankLevel)},expWelfareResp:function(e){var t=e.readProtobuf(game.pb.ExpWelfareResponse);0<t.code?game.notice.noticeError(t.code):(game.yongzheData.setExtWelfare(t.score),game.yongzheData.updateInfoByScore(t.score),this.checkAlert(),this.send(this.Evts.C2V_YONGZHE_UPDATE_AWARD_STATE),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},dailyModuleData:function(e){if(game.yongzheData.isOpen()&&e&&e.data){var t=e.data;game.yongzheData.onSyncData(t),this.checkAlert(),this.send(this.Evts.C2V_YONGZHE_DAILY_MODULE_DATA)}},dailyExploitExp:function(){if(game.yongzheData.isOpen()){game.yongzheData.updateAwardGetState(),this.checkAlert(),this.send(this.Evts.C2V_YONGZHE_UPDATE_DATA)}},onRankResp:function(e){if(e&&e.data){var t=e.data,a=t.rankType,i=t.list;a==game.RankType.RankLevel&&(game.yongzheData.setWorldLevel(i),this.dpt(this.Evts.C2C_UPDATE_WORLD_LV),game.yongzheData.isOpen()&&(game.yongzheData.updateAwardGetState(),game.yongzheData.updateYongzheList(),this.checkAlert(),this.send(this.Evts.C2V_YONGZHE_UPDATE_DATA)))}},checkAlert:function(){this.spotAlert.alert=game.yongzheData.isAlert()},lab_upLv:function(){b8e.module.isShowView(game.ME.Stronger)||game.module.showToggle(game.ME.Stronger,3)},lab_score:function(){b8e.module.isShowView(game.ME.DailyFuLi)||game.module.show(game.ME.DailyFuLi)},guize_btn:function(){b8e.module.isShowView(game.ME.YongzheView)||game.module.showToggle(game.ME.YongzheView,0)},shuoming_btn:function(){b8e.module.isShowView(game.ME.YongzheView)||game.module.showToggle(game.ME.YongzheView,1)},top_btn:function(){this.send(this.Evts.C2V_YONGZHE_ACHIEVE_UP_BTN)},buttom_btn:function(){this.send(this.Evts.C2V_YONGZHE_ACHIEVE_DOWN_BTN)},rulesBtn:function(){this.selectToggle(0)},expAwardBtn:function(){this.selectToggle(1)},zuanshiBtn:function(){this.selectToggle(2)},selectToggle:function(e){this.send(this.Evts.C2V_YONGZHE_SWITCH_PAGE,e)},_awardWelfareReq:function(e){this.sender.ExpWelfareReq(e)}}),t=game.Sender.extends({ipc:function(){this.msg={ExpWelfareReq:this.expWelfareReq}},expWelfareReq:function(e){var t=game.pb.ExpWelfareRequest;t.score=e,this.write(t)}}),a=[game.ME.YongzheView,game.ME.YongzheRulePage,game.ME.YongzheExpPage,game.ME.YongzheZuanshiPage];b8e.module.registerControl(game.ME.YongzheWelfare,e,game.YongzheWelfareEvts,t,a)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1417),this.setSize(540,128)},init:function(){var e=this,t=e.skin;e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.prizeList.itemRender=game.PrizeListItem,e.prizeList.layout.spacingX=20,e.prizeList.layout.spacingY=0,e.prizeList.layout.paddingLeft=0,e.prizeList.layout.paddingTop=0,e.prizeList.addToParent(t.list);var a=e.data;e.skin.lab_lv.string=game.Lang.get(a.langKey),e.prizeList.setData(a.prizes)}}),b8e.RC("$$game","$$YongzheBaseListItem",e)}(),function(){var e;e=game.View.extends({ctor:function(){this._super(1416)},init:function(){var e=this.skin;this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.YongzheBaseListItem,this._list.bindEnum=game.ME.YongzheWelfare,this._list.layout.spacingX=0,this._list.layout.spacingY=5,this._list.layout.paddingLeft=0,this._list.layout.paddingTop=0,this._list.addToParent(e.list)},updateInfo:function(e){this._list&&this._list.setData(e)},onStageResize:function(){this.setPosition(0,0)}}),b8e.RC("$$game","$$YongzheBasePage",e)}(),function(){var e=game.YongzheBasePage.extends({onShow:function(){var e=game.yongzheData.getExpList();this.updateInfo(e)},notify:function(e){switch(e){case this.Evts.C2V_YONGZHE_ACHIEVE_UP_BTN:this._list&&this._list.scrollContainerTop();break;case this.Evts.C2V_YONGZHE_ACHIEVE_DOWN_BTN:this._list&&this._list.scrollContainerBottom()}},listCb:function(e,t,a){this.skin.top_btn.active=0<e.length,this.skin.buttom_btn.active=0<a.length}});b8e.module.registerView(game.ME.YongzheExpPage,e)}(),function(){var e=game.YongzheBasePage.extends({onShow:function(){var e=game.yongzheData.getDiamondList();this.updateInfo(e)},notify:function(e){switch(e){case this.Evts.C2V_YONGZHE_ACHIEVE_UP_BTN:this._list&&this._list.scrollContainerTop();break;case this.Evts.C2V_YONGZHE_ACHIEVE_DOWN_BTN:this._list&&this._list.scrollContainerBottom()}},listCb:function(e,t,a){this.skin.top_btn.active=0<e.length,this.skin.buttom_btn.active=0<a.length}});b8e.module.registerView(game.ME.YongzheZuanshiPage,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1415)},init:function(){this.skin.lab_desc.string=game.Lang.get(51949)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.YongzheRulePage,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1414),this.toggles={rulesBtnSelect:game.ME.YongzheRulePage,expAwardBtnSelect:game.ME.YongzheExpPage,zuanshiBtnSelect:game.ME.YongzheZuanshiPage}},notify:function(e,t){switch(e){case this.Evts.C2V_YONGZHE_SWITCH_PAGE:this.toggleSelect(t)}}});b8e.module.registerView(game.ME.YongzheView,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1413),this.setSize(180,245)},init:function(){this._item=game.GridUtil.createPrizeIcon(),this._item.addToParent(this.skin.icon)},setData:function(){var e=this.skin,t=this.data;e.lab_score.string=game.Lang.get(51950,t.score),game.GridUtil.setPrizeIcon(this._item,t.prizeInfo),t.isGet?(e.getBtn.active=!0,e.canGetBtn.active=!1,e.noGetBtn.active=!1):(e.getBtn.active=!1,e.canGetBtn.active=t.isCanGet,e.noGetBtn.active=!t.isCanGet)},canGetBtn:function(){this.send(game.YongzheWelfareEvts.V2C_YONGZHE_GET_AWARD,this.data)},noGetBtn:function(){game.notice.show(3505)}}),b8e.RC("$$game","$$YongzheWelfareListItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1412)},init:function(){var e=this,t=e.skin;e._list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._list.itemRender=game.YongzheWelfareListItem,e._list.bindEnum=game.ME.YongzheWelfare,e._list.layout.spacingX=19,e._list.layout.spacingY=0,e._list.layout.paddingLeft=0,e._list.layout.paddingRight=0,e._list.layout.paddingTop=0,e._list.layout.paddingBottom=0,e._list.addToParent(t.list),e.progress=new game.Progress(500,30,0),e.progress.addToParent(t.progress_node)},notify:function(e){switch(e){case this.Evts.C2V_YONGZHE_DAILY_MODULE_DATA:case this.Evts.C2V_YONGZHE_UPDATE_AWARD_STATE:case this.Evts.C2V_YONGZHE_UPDATE_DATA:this.updateInfo()}},onShow:function(){this.send(this.Evts.V2C_YONGZHE_RANK_LEVEL_REQ),this.updateInfo()},updateInfo:function(){var e=this.skin,t=game.yongzheData,a=t.getYongzheList();this._list.setData(a);var i=t.maxScore,n=game.dailyExploitData.experienceExpDaily;i<n&&(n=i),this.progress.updatePro(n,i);var s=t.getExpBonus();s<1?e.lab_progress.active=!1:(e.lab_progress.active=!0,e.lab_progress.string=game.Lang.get(52099,s));var o=t.worldLv-t.worldLevelDiff>>0;e.lab_desc.string=game.Lang.get(51951,o)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.YongzheWelfare,e)}(),function(){var e,a=e=b8e.StateMachine.extends({ctor:function(e){this._super(e),a.init(this)},start:function(){this.transition(game.PlayBackStateType.START)},stop:function(){this.transition(game.PlayBackStateType.IDLE)}});a.stateMapping=null,a.init=function(e){if(!a.stateMapping){var t=a.stateMapping={};t[game.PlayBackStateType.START]=game.PlayBackStartState,t[game.PlayBackStateType.ROUND]=game.PlayBackRoundState,t[game.PlayBackStateType.SKILL]=game.PlayBackSkillState,t[game.PlayBackStateType.MOVE_TO]=game.PlayBackMoveToState,t[game.PlayBackStateType.ATTACK]=game.PlayBackAttackState,t[game.PlayBackStateType.MOVE_BACK]=game.PlayBackMoveBackState,t[game.PlayBackStateType.RANGE_ATTACK]=game.PlayBackRangeState,t[game.PlayBackStateType.IDLE]=game.PlayBackIdleState,t[game.PlayBackStateType.ARREST]=game.PlayBackArrestState,t[game.PlayBackStateType.CHAT]=game.PlayBackChatState}e.setStateMapping(a.stateMapping)},b8e.RC("$$game","$$PlayBackStateMachine",e)}(),function(){var e;e=b8e.Enum({START:100,ROUND:101,SKILL:102,MOVE_TO:103,ATTACK:104,MOVE_BACK:105,RANGE_ATTACK:106,IDLE:107,START_SKILL:108,ARREST:109,CHAT:110}),b8e.RC("$$game","$$PlayBackStateType",e)}(),function(){var e,t=e=b8e.PoolObject.extends({setData:function(e,t){this.info=e,this.options=t||{type:game.InstanceType.NORMAL}},reset:function(){this.info=null,this.options=null},recycle:function(){this.reset(),this._super()}}),a=new b8e.Pool(t,4);t.get=function(){return a.get()},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$PlayBackData",e)}(),function(){var e;e=b8e.Enum({Buff:0,SpellCast:1,NewUnit:2,Chat:90,Bench:91}),b8e.RC("$$game","$$PlayBackActionType",e)}(),function(){var e;e=b8e.ControlState.extends({info:{get:function(){return game.playBack.info}},speedRatio:{get:function(){return game.playBack.speedRatio}},scene:{get:function(){return game.playBackScene.scene}},getStateRef:function(){if(!this._ref)return b8e.error("PlayBackState \u4e0d\u5b58\u5728\u5f53\u524dref\uff01\uff01"),null;var e=this.getReference(game.PlayBackStateReference);return e.setParams(this._ref.instId),e},isCurPlayBack:function(){var e=game.playBack.info;return!!e&&!(!this._ref||this._ref.instId!=e.instId)}}),b8e.RC("$$game","$$PlayBackState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.START)},execute:function(){var e=this.getReference(game.PlayBackStateReference);this.info?(e.setParams(this.info.instId),this.transition(game.PlayBackStateType.ROUND,e)):this.transition(game.PlayBackStateType.IDLE,e)}}),b8e.RC("$$game","$$PlayBackStartState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.START_SKILL)},execute:function(){this.startSkill()},startSkill:function(){var e=game.playBack,t=this.getStateRef();e.haveStartSkill()?e.playStartSkill(this._playStartSkill,this):this.transition(game.PlayBackStateType.ROUND,t)},_playStartSkill:function(e){var t=game.playBack,a=this.getStateRef();if(!e)return t.playNextStartSkill(),void this.transition(game.PlayBackStateType.START_SKILL,a);if(t.spellCast){if(t.skillCfg)switch(t.skillCfg.stype){case 0:this.transition(game.PlayBackStateType.RANGE_ATTACK,a);break;case 1:this.transition(game.PlayBackStateType.MOVE_TO,a)}}else this.transition(game.PlayBackStateType.IDLE,a)}}),b8e.RC("$$game","$$PlayBackStartSkillState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.ATTACK),this.shakeTimes=[],this.shakeTime=[0],this.shakeOffset=[5]},execute:function(){var e=this,t=game.playBack.skillCfg;if(t){var a=game.playBack.spellCast,i=game.SkillCfg.getData(a.spellId);i&&3==i.type?1==a.attachEffect||3==a.attachEffect?e.beginAttackTargets():(t.bcType&&(0<t.beginBcStartTime?(b8e.Tween.kill(game.BounceCharacterMgr.inst()),b8e.Tween.get(game.BounceCharacterMgr.inst()).wait(t.beginBcStartTime/e.speedRatio).call(e._showHurt)):e._showHurt()),0<t.beginEffect&&0==a.attachEffect?0<t.beginEffectStartTime?(b8e.Tween.kill(e),b8e.Tween.get(e).wait(t.beginEffectStartTime/e.speedRatio).call(e._playBeginEffect)):e._playBeginEffect():e.beginAttackTargets()):e.beginAttackTargets()}else{var n=e.getStateRef();e.transition(game.PlayBackStateType.MOVE_BACK,n)}},_showHurt:function(){var e=game.playBack,t=e.releaseRole,a=e.skillCfg;game.BounceCharacterMgr.inst().showHurt(0,a.bcType,t,this.speedRatio)},_playBeginEffect:function(){var e=game.playBack,t=e.releaseRole,a=game.playBack.combineRoles,i=e.skillCfg,n=t.getScene(),s=game.Direction.getDirection(t.getDirection()),o=game.Direction.getRadian(s),r=t.getScenePosition(),g=i.beginEffectBindNode||"root",l=game.ResCfg.getUrl(5001,i.beginEffect),c=game.EffectUtil.playHitEffect(t,g,n,l,r,o,this.speedRatio,!1,0,0);if(a&&0<a.length)for(var h=0,m=a.length;h<m;h++)r=a[h].getScenePosition(),game.EffectUtil.playHitEffect(a[h],g,n,l,r,o,this.speedRatio,!1,0,0);if(i.beginEffectEndTime){var u=c+i.beginEffectEndTime;b8e.Tween.kill(this),b8e.Tween.get(this).wait(u/this.speedRatio).call(this.beginAttackTargets)}else this.beginAttackTargets()},beginAttackTargets:function(){var e=game.playBack.skillCfg;if(0<e.attackWaitTime){b8e.Tween.kill(this);var t=e.attackWaitTime/this.speedRatio>>0;b8e.Tween.get(this).wait(t).call(this.attackTargets,this)}else this.attackTargets()},attackTargets:function(){var e=this;if(e.isCurPlayBack()){var t=game.playBack.releaseRole,a=game.playBack.combineRoles,i=game.playBack.spellCast,n=i.targets,s=e.getStateRef();if(t&&n&&0<n.length){var o=n[0],r=e.scene;if(!r.getDisplayById(o.unitId))return void e.transition(game.PlayBackStateType.MOVE_BACK,s);var g=game.playBack.skillCfg;if(!g)return void e.transition(game.PlayBackStateType.MOVE_BACK,s);var l=e.speedRatio;if(g.godAnimalType?e.releaseSkillComplete():(e.updateMp(),game.skillRelease.release(r,t,g,l,null,e.releaseSkillComplete,e)),a&&0<a.length)for(var c=0,h=a.length;c<h;c++)game.skillRelease.release(r,a[c],g,l,null,null,e);for(var m=!1,u=0,d=n.length;u<d;u++)(o=n[u])&&(game.skillHit.hit(r,g,o,l),o.effect&&2==o.effect.type&&(m=!0));if(1==i.attachEffect?game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.DOUBLE_ATTACK,t,l):2==i.attachEffect?game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.RETURN_ATTACK,t,l):3==i.attachEffect&&game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.FOLLOW_ATTACK,t,l),g.shakeTimes&&0<g.shakeTimes.length&&(m=!1),m&&t.data&&t.data.isAttack){if(e.shakeTimes.length=0,g.hitTimes&&0<g.hitTimes.length)for(var f=0,p=0,_=g.hitTimes.length;p<_;p++)f=g.hitTimes[p]-f,e.shakeTimes.push(f/l);else e.shakeTimes.push(g.hitTime/l);e.addShake(e.shakeTimes)}}else e.transition(game.PlayBackStateType.MOVE_BACK,s)}},addShake:function(e){if(e&&!(e.length<1)){var t=e.shift();b8e.Tween.kill(this),b8e.Tween.get(this).wait(t).call(this.shake,this,e)}},shake:function(e){game.skillHit.addShake(this.scene,this.shakeTime,this.shakeOffset,this.speedRatio),e&&0<e.length&&this.addShake(e)},releaseSkillComplete:function(){if(this.isCurPlayBack()){game.skillBuff.buffs(game.playBack.spellCast.buffs,this.scene,this.speedRatio);var e,t=game.playBack.skillCfg;e=this.getStateRef(),t&&t.specialType==game.SkillSpecialType.Arrest?this.transition(game.PlayBackStateType.ARREST,e):this.transition(game.PlayBackStateType.MOVE_BACK,e)}},updateMp:function(){var e=game.playBack,t=e.spellCast,a=e.releaseRole;t&&a&&a.data&&(a.data.mp=t.mp,a.updateMpBar())}}),b8e.RC("$$game","$$PlayBackAttackState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.CHAT)},execute:function(){var e=game.playBack,t=this.getStateRef();if(!this._ref||!this.isCurPlayBack())return playBack.playNextAction(),void this.transition(game.PlayBackStateType.ROUND,t);var a=e.action;if(a){var i=a.chat;if(!i||i.length<1)return playBack.playNextAction(),void this.transition(game.PlayBackStateType.ROUND,t);this.chats=i,this.index=0,this.showChat()}else this.transition(game.PlayBackStateType.IDLE,t)},showChat:function(){var e=this,t=e.chats[e.index];if(!t||!e.scene){var a=e.getStateRef();return game.playBack.playNextAction(),void e.transition(game.PlayBackStateType.ROUND,a)}0<t.beginWaitTime?(b8e.Tween.kill(e),b8e.Tween.get(e).wait(t.beginWaitTime/e.speedRatio).call(e._showChat,e)):e._showChat()},_showChat:function(){var e=this.chats[this.index];this.index++;var t=this.scene.getDisplayById(e.unitId);if(t){var a=game.Lang.get(e.chatId);t.showChat(0,60,e.showTime+150,a),b8e.Tween.kill(this),b8e.Tween.get(this).wait((e.showTime+150+e.endWaitTime)/this.speedRatio).call(this.showChat,this)}},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$PlayBackChatState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.IDLE)},execute:function(){this.isCurPlayBack()?game.playBack.stopStateMachine():b8e.error("\u5f02\u5e38\u7684\u6218\u6597\u7ed3\u675f\u6d41\u7a0b\uff01\uff01\uff01")}}),b8e.RC("$$game","$$PlayBackIdleState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.MOVE_BACK),this._pos={x:0,y:0}},execute:function(){var e=game.playBack.skillCfg;if(e)if(0<e.attackFinishWaitTime){var t=e.attackFinishWaitTime/this.speedRatio>>0;b8e.Tween.get(this).wait(t).call(this.moveBack,this)}else this.moveBack();else this.moveBack()},moveBack:function(){var e=game.playBack,t=e.releaseRole,a=game.playBack.combineRoles;if(t)if(e.spellCast){if(e.checkAttachEffect())this.moveBackComplete();else if(this._targetMoveBack(t,!0),a&&0<a.length)for(var i=0,n=a.length;i<n;i++)this._targetMoveBack(a[i],!1)}else this.moveBackComplete();else this.moveBackComplete()},_targetMoveBack:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=this,n=e.data;if(n&&n.createPos){var s=game.playBackScene.getViewOffset(),o=s.x,r=s.y,g=o+n.createPos.x,l=r-n.createPos.y;i._pos.x=g,i._pos.y=l;var c=game.playBack.skillCfg;c&&c.godAnimalType?i.moveBackComplete():a?game.moveTo.fly(e,i._pos,i.speedRatio,i.moveBackComplete,i):game.moveTo.fly(e,i._pos,i.speedRatio)}else a&&i.moveBackComplete()},moveBackComplete:function(){var e=game.playBack.skillCfg;if(b8e.Tween.kill(this),e.skillFinishTime){var t=e.skillFinishTime/this.speedRatio>>0;b8e.Tween.get(this).wait(t).call(this._finishSkill,this)}else this._finishSkill()},_finishSkill:function(){if(b8e.Tween.kill(this),this.isCurPlayBack()){var e=game.playBack,t=this.getStateRef();e.isFighting?(e.playNextSkill(),this.transition(game.PlayBackStateType.SKILL,t)):this.transition(game.PlayBackStateType.IDLE,t)}},_callCNRole:function(e,t){e.playNextSkill(),this.transition(game.PlayBackStateType.SKILL,t)}}),b8e.RC("$$game","$$PlayBackMoveBackState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_FLY_MOVE),this._pos={x:0,y:0}},execute:function(){this.startMove()},startMove:function(){var e=game.playBack.skillCfg;e&&e.moreAttack||this.moveToTarget()},moveToTarget:function(){var e=this,t=game.playBack.releaseRole,a=game.playBack.combineRoles,i=game.playBack.spellCast.targets;if(t&&i&&0<i.length){var n=game.playBackScene.getViewOffset(),s=t.data,o=i[0];if(!o)return void e.playNextSkill();var r=e.scene.getDisplayById(o.unitId);if(!r)return void e.playNextSkill();var g=void 0,l=game.playBack.skillCfg;s.isAttack&&l.fightAttackPos?g=l.fightAttackPos:!s.isAttack&&l.fightDefendPos&&(g=l.fightDefendPos),s=r.data;var c=void 0,h=void 0,m=n.x,u=n.y;h=g?(c=m+g.X,u-g.Y):(c=m+(t.data.isAttack==s.isAttack?s.beSelfAttackedPos.x:s.beAttackedPos.x),u-(t.data.isAttack==s.isAttack?s.beSelfAttackedPos.y:s.beAttackedPos.y)),e._pos.x=c,e._pos.y=h;var d=a&&0<a.length,f=d?game.playBack.combinePos[a.length-1].concat():null;if(d&&f&&(e._pos=e.findNearPos(t,f)),l.godAnimalType?e.moveComplete():game.moveTo.fly(t,e._pos,e.speedRatio,e.moveComplete,e),d&&f)for(var p=0,_=a.length;p<_;p++)game.moveTo.fly(a[p],e.findNearPos(a[p],f),e.speedRatio,null,e)}else e.playNextSkill()},ajustPos:function(e,t){var a=game.playBackScene.getViewOffset();return{x:a.x+e,y:a.y-t}},findNearPos:function(e,t){for(var a=e.getScenePosition(),i=9999,n=9999,s=0,o=void 0,r=0,g=t.length;r<g;r++)o=this.ajustPos(t[r].x,t[r].y),(n=b8e.MathUtil.getDistance(a.x,a.y,o.x,o.y))<i&&(i=n,s=r);return o=t.splice(s,1)[0],this.ajustPos(o.x,o.y)},playNextSkill:function(){var e=game.playBack;if(this.isCurPlayBack()){var t=this.getStateRef();e.playNextSkill(),this.transition(game.PlayBackStateType.SKILL,t)}},moveComplete:function(){if(this.isCurPlayBack()){var e=this.getStateRef();this.transition(game.PlayBackStateType.ATTACK,e)}}}),b8e.RC("$$game","$$PlayBackMoveToState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.RANGE_ATTACK),this.shakeTimes=[],this.shakeTime=[0],this.shakeOffset=[5]},execute:function(){if(this.isCurPlayBack()){var e=game.playBack.skillCfg;if(!e||0!=e.stype){b8e.warn("\u5f53\u524d\u56de\u653e\u7684\u6280\u80fd\u4e0d\u662f\u8fdc\u7a0b\u6280\u80fd");var t=this.getStateRef();return game.playBack.playNextSkill(),void this.transition(game.PlayBackStateType.SKILL,t)}0<e.attackWaitTime?(b8e.Tween.kill(this),b8e.Tween.get(this).wait(e.attackWaitTime/game.playBack.speedRatio>>0).call(this.playRangeSkill,this)):this.playRangeSkill()}},playRangeSkill:function(){var e=this,t=game.playBack.spellCast,a=t.targets,i=game.playBack.releaseRole,n=game.playBack.skillCfg;if(n){var s=!1,o=a.length,r=void 0;n.godAnimalType||e.updateMp();for(var g=0;g<o;g++)if(r=a[g]){if(!e.scene.getDisplayById(r.unitId))return void e.playRangeSkillComplete();g==o-1?game.skillRelease.release(e.scene,i,n,e.speedRatio,r,e.playRangeSkillComplete,e):game.skillRelease.release(e.scene,i,n,e.speedRatio,r),game.skillHit.hit(e.scene,n,r,e.speedRatio),r.effect&&2==r.effect.type&&(s=!0)}if(1==t.attachEffect?game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.DOUBLE_ATTACK,i,e.speedRatio):2==t.attachEffect&&game.BounceCharacterMgr.inst().showHurt(0,game.BounceCharacterType.RETURN_ATTACK,i,e.speedRatio),n.shakeTimes&&0<n.shakeTimes.length&&(s=!1),s&&i.data.isAttack){if(e.shakeTimes.length=0,n.hitTimes&&0<n.hitTimes.length)for(var l=0,c=0,h=n.hitTimes.length;c<h;c++)l=n.hitTimes[c]-l,e.shakeTimes.push(l/e.speedRatio);else e.shakeTimes.push(n.hitTime/e.speedRatio);e.addShake(e.shakeTimes)}o<1&&(e._target||(e._target={unitId:0}),e._target.unitId=i.id,e._target.unitId?game.skillRelease.release(e.scene,i,n,e.speedRatio,e._target,e.playRangeSkillComplete,e):e.playRangeSkillComplete())}},addShake:function(e){if(e&&!(e.length<1)){var t=e.shift();b8e.Tween.kill(this),b8e.Tween.get(this).wait(t).call(this.shake,this,[e])}},shake:function(e){game.skillHit.addShake(this.scene,this.shakeTime,this.shakeOffset,this.speedRatio),e&&0<e.length&&this.addShake(e)},playRangeSkillComplete:function(){var e=game.playBack.spellCast;if(e&&game.skillBuff.buffs(e.buffs,this.scene,this.speedRatio),this.isCurPlayBack()){var t=this.getStateRef();this.transition(game.PlayBackStateType.MOVE_BACK,t)}},updateMp:function(){var e=game.playBack,t=e.spellCast,a=e.releaseRole;t&&a&&a.data&&(a.data.mp=t.mp,a.updateMpBar())}}),b8e.RC("$$game","$$PlayBackRangeState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.ROUND)},execute:function(){this.startAction()},startAction:function(){var e=this,t=e.getStateRef();if(e._ref&&e.isCurPlayBack())if(game.playBack.haveNextAction()){var a=game.playBack,i=e.scene,n=e.speedRatio,s=game.PlayBackActionType;a.startAction();var o=a.action;if(!o)return void e.transition(game.PlayBackStateType.IDLE,t);switch(o.type){case s.Buff:var r=game.skillBuff.buffs(o.buffs,i,n);0<r?(b8e.Tween.kill(e),b8e.Tween.get(e).wait(r).call(e.nextAction)):e.nextAction();break;case s.SpellCast:e.spellCast();break;case s.NewUnit:game.playBackCreate.createNewRole(o.units,a.options.turn,!1,e.nextAction,e),e.delDeathEffect(o.units);break;case s.Chat:e.transition(game.PlayBackStateType.CHAT,t);break;case s.Bench:game.playBackCreate.createNewRole(o.units,a.options.turn,!0,e.nextAction,e),e.delDeathEffect(o.units);break;default:e.transition(game.PlayBackStateType.IDLE,t)}}else e.transition(game.PlayBackStateType.IDLE,t);else e.transition(game.PlayBackStateType.IDLE,t)},delDeathEffect:function(e){for(var t=void 0,a=0,i=e.length;a<i;a++){var n=(t=e[a]).attack?100+t.pos:200+t.pos;game.EffectUtil.delDeathEffect(n,this.scene)}},nextAction:function(){if(this.info){var e=this.getReference(game.PlayBackStateReference);this.info&&(e.setParams(this.info.instId),game.playBack.playNextAction(),this.transition(game.PlayBackStateType.ROUND,e))}},spellCast:function(){var e=this.getReference(game.PlayBackStateReference);e.setParams(this._ref.instId),this.transition(game.PlayBackStateType.SKILL,e)},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$PlayBackRoundState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.SKILL)},execute:function(){this.startSkill()},startSkill:function(){var e=game.playBack,t=this.getStateRef();e.haveNextSkill()?e.playSkill(this._startBeginEffect,this):(e.playNextAction(),this.transition(game.PlayBackStateType.ROUND,t))},_startBeginEffect:function(e){var t=this,a=game.playBack,i=t.getStateRef(),n=a.spellCast,s=a.skillCfg,o=a.releaseRole,r=n&&game.SkillCfg.getData(n.spellId);if(r&&1==r.group)s&&0<s.combineBcWaitTime?(b8e.Tween.kill(game.playBack.godAnimalEffect),b8e.Tween.get(game.playBack.godAnimalEffect).wait(300/t.speedRatio).call(function(){game.playBack.godAnimalEffect.play(n.spellId,t.speedRatio)}),b8e.Tween.kill(t),b8e.Tween.get(t).wait(s.combineBcWaitTime/t.speedRatio).call(t._startSkill)):t._startSkill();else{if(!(e&&n&&s&&o))return a.playNextAction(),void t.transition(game.PlayBackStateType.ROUND,i);if(r&&3==r.type)if(1==n.attachEffect||3==n.attachEffect)t._startSkill();else{var g=game.playBack.combineRoles;if(game.BounceCharacterMgr.inst().showHurt(0,s.combineBcType,o,t.speedRatio),g&&0<g.length){for(var l=0,c=g.length;l<c;l++)game.BounceCharacterMgr.inst().showHurt(0,s.combineBcType,g[l],t.speedRatio);0<s.combineBcWaitTime&&(b8e.Tween.kill(game.playBack.combineEffect),b8e.Tween.get(game.playBack.combineEffect).wait(300/t.speedRatio).call(function(){game.playBack.combineEffect.play(n.spellId,o,g[0],t.speedRatio)}))}0<s.combineBcWaitTime?(b8e.Tween.kill(t),b8e.Tween.get(t).wait(s.combineBcWaitTime/t.speedRatio).call(t._startSkill)):t._startSkill()}else if(r&&4==r.type)if(1==n.attachEffect||3==n.attachEffect)t._startSkill();else{var h=game.playBack.combineRoles;if(game.BounceCharacterMgr.inst().showHurt(0,s.combineBcType,o,t.speedRatio),h&&0<h.length){for(var m=0,u=h.length;m<u;m++)game.BounceCharacterMgr.inst().showHurt(0,s.combineBcType,h[m],t.speedRatio);0<s.combineBcWaitTime&&(b8e.Tween.kill(game.playBack.combineEffect),b8e.Tween.get(game.playBack.combineEffect).wait(300/t.speedRatio).call(function(){game.playBack.combineEffect.play(n.spellId,o,h[0],t.speedRatio)}))}0<s.combineBcWaitTime?(b8e.Tween.kill(t),b8e.Tween.get(t).wait(s.combineBcWaitTime/t.speedRatio).call(t._startSkill)):t._startSkill()}else 1==n.attachEffect||3==n.attachEffect?t._startSkill():(s.bcType&&(0<s.beginBcStartTime?(b8e.Tween.kill(game.BounceCharacterMgr.inst()),b8e.Tween.get(game.BounceCharacterMgr.inst()).wait(s.beginBcStartTime/t.speedRatio).call(t._showHurt)):t._showHurt()),0<s.beginEffect&&0==n.attachEffect?0<s.beginEffectStartTime?(b8e.Tween.kill(t),b8e.Tween.get(t).wait(s.beginEffectStartTime/t.speedRatio).call(t._playBeginEffect)):t._playBeginEffect():t._startSkill())}},_showHurt:function(){var e=game.playBack,t=e.releaseRole,a=e.skillCfg;game.BounceCharacterMgr.inst().showHurt(0,a.bcType,t,this.speedRatio)},_playBeginEffect:function(){var e=game.playBack,t=e.releaseRole,a=e.skillCfg,i=t.getScene(),n=game.Direction.getDirection(t.getDirection()),s=game.Direction.getRadian(n),o=t.getScenePosition(),r=a.beginEffectBindNode||"root",g=game.ResCfg.getUrl(5001,a.beginEffect),l=game.EffectUtil.playHitEffect(t,r,i,g,o,s,this.speedRatio,!1,0,0);if(a.beginEffectEndTime){var c=l+a.beginEffectEndTime;b8e.Tween.kill(this),b8e.Tween.get(this).wait(c/this.speedRatio).call(this._startSkill)}else this._startSkill()},_startSkill:function(){var e=this.getStateRef();switch(game.playBack.skillCfg.stype){case 0:this.transition(game.PlayBackStateType.RANGE_ATTACK,e);break;case 1:this.transition(game.PlayBackStateType.MOVE_TO,e)}},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$PlayBackSkillState",e)}(),function(){var e;e=game.PlayBackState.extends({ctor:function(){this._super(game.PlayBackStateType.ARREST),this._pos={x:0,y:0},this._pos1={x:0,y:0}},execute:function(){var e=this,t=game.playBack.releaseRole,a=game.playBack.spellCast,i=a.targets;if(t&&i&&0<i.length){var n=game.playBackScene.getViewOffset(),s=t.data,o=i[0];if(!o)return void e.playNextSkill();var r=e.scene.getDisplayById(o.unitId);if(!r)return void e.playNextSkill();var g=n.x,l=n.y,c=g+s.createPos.x,h=l-s.createPos.y;e._pos.x=c,e._pos.y=h;e.getStateRef();var m=g+r.data.createPos.x,u=l-r.data.createPos.y;a.arrestSuccess?(e._pos1.x=g+s.beAttackedPos.x,e._pos1.y=l-s.beAttackedPos.y):(e._pos1.x=m+c>>1,e._pos1.y=u+h>>1),game.moveTo.fly(t,e._pos,e.speedRatio/5,e.moveBackComplete,e),game.moveTo.fly(r,e._pos1,e.speedRatio/6,a.arrestSuccess?e.moveBackComplete2:e.failureMoveBackComplete,e)}},moveBackComplete:function(){},moveBackComplete2:function(){var e=game.playBack.spellCast.targets[0],t=(this.scene.getDisplayById(e.unitId),this.getStateRef());game.playBack.playNextSkill(),this.transition(game.PlayBackStateType.SKILL,t)},failureMoveBackComplete:function(){var e=game.playBack.spellCast;if(!e.arrestSuccess){var t=game.playBackScene.getViewOffset(),a=t.x,i=t.y,n=e.targets[0],s=this.scene.getDisplayById(n.unitId),o=a+s.data.createPos.x,r=i-s.data.createPos.y;this._pos1.x=o,this._pos1.y=r,game.moveTo.fly(s,this._pos1,this.speedRatio/5,this.moveBackComplete2,this)}}}),b8e.RC("$$game","$$PlayBackArrestState",e)}(),function(){var e;e=b8e.StateReference.extends({setParams:function(e){this.instId=e},clear:function(){this.instId=0}}),b8e.RC("$$game","$$PlayBackStateReference",e)}(),function(){var t;t=b8e.BaseProcess.extends({getState:function(){return game.MainProcessTypes.BEAN},processHandler:function(e){game.loadingPage.setProgress(e)},startProcess:function(){this._super(),game.loadingPage.show(),game.loadingPage.setPromptText(game.LanguageData.get(80)),this.setProcessPercent(1,3e3);var t=game.LoginConfig.heroData;if(t)game.mainRole.onLogin(t),this.isProcessed||0!=game.LoginConfig.isSingle?this.completeProcess():(b8e.profiler.removeDummyHot(),game.BeanRegisterMgr.inst().setup(),game.BeanMgr.inst().register(),game.MiscSender.clientDataRequest());else{var a=game.LanguageData.get(81);game.loadingPage.setErrorText(a),b8e.Toast.launch(a,4294901760,0),b8e.error(a,e)}},completeProcess:function(){this.isProcessed&&!game.LoginConfig.isSingle||(game.mainGui.showMainUI(),game.ClientTriggerMgr.inst().setup()),this._super()}}),b8e.RC("$$game","$$BeanProcess",t)}(),function(){var e;e=b8e.BaseProcess.extends({_batchList:null,ctor:function(){this._super()},getState:function(){return game.MainProcessTypes.ENTER_SCENE},processHandler:function(e){game.loadingPage.setProgress(e)},startProcess:function(){this._super(),game.reconnect.isLoginAgain||game.sceneData.isFirst&&(game.loadingPage.show(),game.loadingPage.setPromptText(game.LanguageData.get(79))),this.setProcessPercent(1,1e3),this.sendSdk(),this._enterScene()},preComplete:function(){this.completeProcess()},_checkComplete:function(){this.completeProcess()},_enterScene:function(){this.preComplete(),!game.LoginConfig.hasHeroData&&game.GlobalCfg.isOpenStory()&&game.channelInfo.open_story&&game.LoginConfig.isOpenStory()?b8e.evt.dptG(game.SceneGEvts.STORY_BATTLE):(game.GameLevelMgr.inst().enterScene(),b8e.evt.dptG(game.SceneGEvts.ENTER_SCENE),game.sceneData.lastSceneId=game.sceneData.sceneId)},sendSdk:function(){if(!this.isProcessed){game.sdk.stepLog({progress:100})}},completeProcess:function(){game.sceneData.canEnterHome()||game.loadingPage.hide(),this._super(),game.sdk.traceLog(2),game.sdk.checkSetState()},dispose:function(){this._super()}}),b8e.RC("$$game","$$EnterScene",e)}(),function(){var e;e=b8e.BaseProcess.extends({getState:function(){return game.MainProcessTypes.INIT_MODULE},processHandler:function(e){game.loadingPage.setProgress(e)},startProcess:function(){this._super(),game.loadingPage.show(),game.loadingPage.setPromptText(game.LanguageData.get(70)),this.setProcessPercent(1,3e3),this.isProcessed||(game.module?this.completeProcess():(game.loadingPage.setErrorText(game.LanguageData.get(71)),b8e.error("\u521d\u59cb\u5316\u57fa\u7840\u6a21\u5757\u9519\u8bef")))},completeProcess:function(){this.isProcessed&&game.LoginConfig.isSingle,this._super()}}),b8e.RC("$$game","$$InitModule",e)}(),function(){var e;e=b8e.BaseProcess.extends({_batchList:null,ctor:function(){this._super(),this._batchList=[]},getState:function(){return game.MainProcessTypes.LOAD_ANIMAT},processHandler:function(e){game.loadingPage.setProgress(e)},startProcess:function(){if(this._super(),game.loadingPage.setPromptText(game.LanguageData.get(19)),this.setProcessPercent(1,5e3),game.sceneData.isFirst){game.sdk.stepLog({progress:50})}var e=[],t=game.mainRoleData.avatar;t.body&&(e[e.length]={url:t.body,loadDepends:!0}),t.petFly&&(e[e.length]={url:t.petFly,loadDepends:!0}),t.weapon&&(e[e.length]={url:t.weapon,loadDepends:!0}),t.nickName&&(e[e.length]={url:t.nickName,loadDepends:!0}),t.ambition&&(e[e.length]={url:t.ambition,loadDepends:!0}),0<e.length?b8e.res.loadBatchRes(e,this.batchLoadProcess,this,null,100):this.completeProcess()},addLoadSpellIds:function(e,t){if(e&&"0"!=e)for(var a=e.split("|"),i=a.length,n=0;n<i;n++){var s=a[n];this.addLoadSpellEffect(s,t)}},addLoadSpellEffect:function(e,t){if(0<e){var a=game.SpellCfg.getSpellById(Number(e));if(a){if(a.releaseEffect){var i=game.ResCfg.getSkillFx(a.releaseEffect);t.push(i)}this.addLoadSpellEffect(a.nextSpellId)}else b8e.warn("\u6280\u80fdID\uff1a"+e+"\u6ca1\u6709\u914d\u7f6e\uff1f")}},batchLoadProcess:function(e,t,a,i){game.loadingPage.setPromptText(game.LanguageData.get(20)+"("+a+"/"+i+")..."),a==i&&(game.loadingPage.setPromptText(game.LanguageData.get(21)),this.completeProcess())}}),b8e.RC("$$game","$$LoadAnimat",e)}(),function(){var e;e=b8e.BaseProcess.extends({_configUrl:null,_isCfgLoading:!1,_isCfgLoaded:!1,ctor:function(){this._configUrl="config/app_config.bcd",this._super()},getState:function(){return game.MainProcessTypes.LOAD_CONFIG},processHandler:function(e){game.loadingPage.setProgress(e)},onPreProcess:function(){this.loadConfig()},startProcess:function(){this._super(),this.isProcessed?this.stopProcess():(game.loadingPage.show(),game.loadingPage.setPromptText(game.LanguageData.get(66)),this.setProcessPercent(.5,3e3),this.loadConfig(),game.mainProcess.runPreload())},loadConfig:function(){var e=this;if(e._isCfgLoaded)e.stopProcess();else if(!e._isCfgLoading){e._isCfgLoading=!0,game.IS_YUNYOU?e._configUrl="config/yunyou_config.bcd":e._configUrl="config/app_config.bcd";var t=[{url:e._configUrl,type:b8e.ConfigData,ns:"conf",onParseProgress:e._onConfigParseProgress,onParseProgressThis:e},{url:"proto/app_proto.bpd"}];b8e.res.loadBatchRes(t,e.batchLoadProcess,e,null,100,!1)}},_onConfigParseProgress:function(){game.loadingPage.setPromptText(game.LanguageData.get(67))},batchLoadProcess:function(e,t,a,i,n){var s=this;e?s.isPreProcessing||game.loadingPage.setErrorText(game.LanguageData.get(68)):n==s._configUrl?(s.isPreProcessing||(game.loadingPage.setPromptText(game.LanguageData.get(69)),s.setProcessPercent(1,3e3)),game.configMgr.parseConfig(t,function(){s._configCompleted=!0,s._protoCompleted&&s.onResComplete()},s)):"proto/app_proto.bpd"==n&&(game.protoId=game.pb.ProtoId,s._protoCompleted=!0,s._configCompleted&&s.onResComplete())},onResComplete:function(){this._isCfgLoaded=!0,this._isCfgLoading=!1,this.stopProcess()},completeProcess:function(){game.module.initGameBaseModule(),this._super()}}),b8e.RC("$$game","$$LoadConfig",e)}(),function(){var e;e=b8e.BaseProcess.extends({_preload:!1,ctor:function(e){this._super(),this._preload=e},getState:function(){return game.MainProcessTypes.LOAD_FONT},processHandler:function(e){game.loadingPage.setProgress(e)},startProcess:function(){this._super(),this.completeProcess()}}),b8e.RC("$$game","$$LoadFont",e)}(),function(){var e;e=b8e.BaseProcess.extends({_isLoading:!1,_isLoaded:!1,ctor:function(){this._super()},getState:function(){return game.MainProcessTypes.LOAD_MAIN_UI},processHandler:function(e){game.loadingPage.setProgress(e)},onPreProcess:function(){this.loadUIs()},startProcess:function(){this._super(),this.isProcessed?this.completeProcess():(game.loadingPage.show(),game.loadingPage.setPromptText(game.LanguageData.get(72)),this.setProcessPercent(1,3e3),this.loadUIs())},loadBuibComplete:function(){this.loadUIs()},loadUIs:function(){if(this._isLoaded)this.stopProcess();else if(!this._isLoading){this._isLoading=!0;b8e.res.loadBatchRes([],this.batchLoadProcess,this,null,100)}},batchLoadProcess:function(e,t,a,i){this.isPreProcessing||game.loadingPage.setPromptText(game.LanguageData.get(73)+"("+a+"/"+i+")..."),a==i&&(this.isPreProcessing||game.loadingPage.setPromptText(""),this._isLoaded=!0,this._isLoading=!1,this.stopProcess())},completeProcess:function(){if(this._super(),game.mainProcess.runSceneProcess(game.mainRoleData.mapId),game.LoginConfig.hasHeroData||!game.GlobalCfg.isOpenStory()||!game.channelInfo.open_story||!game.LoginConfig.isOpenStory()){if(game.sceneData.canEnterHome())game.sceneData.isFirst&&(game.sceneData.isShowHome=!0,game.module.show(game.ME.Home));else game.GameLevelMgr.inst().enterScene(),b8e.evt.dptG(game.SceneGEvts.ENTER_SCENE);game.module.showMainView()}}}),b8e.RC("$$game","$$LoadMainUI",e)}(),function(){var e;e=b8e.BaseProcess.extends({_batchList:null,ctor:function(){this._super(),this._batchList=[]},getState:function(){return game.MainProcessTypes.LOAD_MAP},processHandler:function(e){game.loadingPage.setProgress(e)},startProcess:function(){this._super();var e=game.mainRoleData.mapId;if(game.GameLevelMgr.inst().leaveScene(),b8e.scene.clearEntity(),b8e.evt.dptG(game.SceneGEvts.LEAVE_SCENE),!game.reconnect.isLoginAgain&&game.sceneData.isFirst){game.loadingPage.show(),game.loadingPage.setPromptText(game.LanguageData.get(74));game.sdk.stepLog({progress:25})}this.setProcessPercent(1,3e3);var t=game.sceneData.getConfig();if(!t)return game.loadingPage.setErrorText(game.LanguageData.get(75)+e+game.LanguageData.get(76)),void b8e.error("\u60f3\u8fdb\u5165\u4e00\u4e2a\u6ca1\u6709\u914d\u7f6e\u7684\u573a\u666f\uff1f");this.loadMap(t.mapRes)},loadMap:function(e){var a=this,t=game.sceneData.lastSceneId,i=0<t?game.SceneCfg.getData(t):null;if(i&&e==i.mapRes)a.enterMap();else{var n=game.ResCfg.getUrl(4100,e);b8e.scene.loadMap(n,function(e,t){e?(game.loadingPage.setErrorText(game.LanguageData.get(77)),b8e.error(e)):a.enterMap()},a)}},enterMap:function(){var t=this;t._batchList.length=0;var e=game.mainRole,a=game.mainRoleData;if(a.serverEnterPosX&&a.serverEnterPosY)e.setScenePosition(a.serverEnterPosX,a.serverEnterPosY);else{a.resetPatrolPos();var i=a.createPos;e.setScenePosition(i.x,i.y)}b8e.scene.startRender();var n=b8e.scene.getMapLayer().getEarthSurface().getThumbUrl(),s=[];n&&s.unshift(n),s.forEach(function(e){t._batchList.push({url:e,type:b8e.SpriteFrame})},t),0<t._batchList.length?b8e.res.loadBatchRes(t._batchList,t.batchLoadProcess,t,null,100):t.completeProcess()},batchLoadProcess:function(e,t,a,i){e&&game.loadingPage.setErrorText(game.LanguageData.get(78)),a==i&&(this._batchList.length=0,this.completeProcess())}}),b8e.RC("$$game","$$LoadMap",e)}(),function(){var e;e=b8e.Object.extends({main:null,_preload:null,initProcess:function(){this.main=new b8e.ProcessStateMachine,this.main.pushProcess(new game.LoadConfig),this.main.pushProcess(new game.LoadMainUI),this.main.pushProcess(new game.LoadMap),this.main.pushProcess(new game.EnterScene)},runPreload:function(){},runProcess:function(){this.main.free(),this.main.addPreProcess(game.MainProcessTypes.LOAD_CONFIG,.5,.65),this.main.addPreProcess(game.MainProcessTypes.LOAD_MAIN_UI,.65,.99),this.main.run()},runSceneProcess:function(e){if(e){game.mainRoleData.mapId=e,this.main.free(),this.main.addPreProcess(game.MainProcessTypes.LOAD_MAP,0,.8),this.main.addPreProcess(game.MainProcessTypes.ENTER_SCENE,.8,.98),this.main.run()}else b8e.error("\u5730\u56feID\u975e\u6cd5\uff1a"+e)}}),b8e.RC("$$game","$$MainProcessRun",e)}(),function(){var e;e=b8e.Enum({NONE:0,LOAD_CONFIG:1,LOAD_FONT:2,LOAD_MAIN_UI:3,BEAN:4,LOAD_MAP:5,LOAD_ANIMAT:6,ENTER_SCENE:7,INIT_MODULE:8}),b8e.RC("$$game","$$MainProcessTypes",e)}(),function(){var e;e=b8e.ControlState.extends({ctor:function(){this._super(game.AiStateType.IDLE)},execute:function(){this._machine&&this._machine.usable&&this._machine.owner.getStateMachine().transition(game.RoleStateType.ACTION_IDLE)}}),b8e.RC("$$game","$$AiIdleState",e)}(),function(){var e;e=b8e.ControlState.extends({monsterId:0,ctor:function(){this._super(game.AiStateType.PATROL)},execute:function(){if(this._machine&&this._machine.usable){var a=game.mainInstanceData.id;if(a){this.battleTime=game.SysTime.curTime,this.monsterId=0;var e=this._machine.owner;e.data.type==game.RoleType.Hero&&(e.data.id==game.mainRoleData.id?game.InstanceCfg.getDataAsync(a,function(e){this.interval=5e3,e?this.interval=1e3*e.interval:b8e.warn("\u6253\u91ce\u914d\u7f6e\u4e0d\u5b58\u5728id\uff1a",a),this.interval=Math.max(5e3,this.interval);var t=game.sceneData.getConfig();t&&t.patrol&&this.startPatrol()},this):(this.interval=5e3+5e3*Math.random()>>0,this.startPatrol()))}}},startPatrol:function(){var e=this._machine.owner;if(e){var t=e.data,a=game.sceneData.getConfig();if(!a)return;var i=a.partrolPath;if(i&&0<i.length){var n=i[t.partrolIndex];if(!n)return;if(e.gridX==n.X&&e.gridY==n.Y)this.patrol();else{var s=b8e.scene.getGridPosByPixel(n.X,n.Y);game.moveTo.move(e,s,0,1,!1,this.patrol,this)}}}},patrol:function(){var e,t=this._machine.owner,a=t.data,i=game.sceneData.getConfig().partrolPath,n=i.length,s=a.partrolIndex||0;if(n<=++s&&(s=0),e=i[s]){a.partrolIndex=s;var o=b8e.scene.getGridPosByPixel(e.X,e.Y);game.SysTime.curTime-this.battleTime>this.interval&&(t.data&&t.data.id==game.mainRoleData.id&&(this.battleTime=game.SysTime.curTime,game.scene.createMonsters(o)),n<=++s&&(s=0),a.partrolIndex=s),t.gridX==o.x&&t.gridY==o.y?b8e.error("\u5de1\u903b\u5f02\u5e38\uff0c\u4e0b\u4e00\u4e2a\u70b9\u548c\u5f53\u524d\u70b9\u4e00\u81f4\uff0c\u8d76\u7d27\u67e5\u4e00\u4e0b\uff01"):game.moveTo.move(t,o,0,1,!1,this.patrol,this)}}}),b8e.RC("$$game","$$PatrolState",e)}(),function(){var e;e=b8e.ControlState.extends({ctor:function(){this._super(game.AiStateType.ATTACK)},execute:function(){if(this._machine&&this._machine.usable){var e=this._machine.owner;if(!e||!e.data||e.data.hp<1)return;switch(this.roleType=e.data.type,this.roleId=e.data.id,this.roleType){case game.RoleType.Hero:this.heroAttack();break;case game.RoleType.Monster:this.monsterAttack();break;case game.RoleType.Partner:this.petAttack()}}},heroAttack:function(){this.doAttack(1001)},getAttackWaitTime:function(){var e=this._machine.owner,t=0;if(e&&e.data)if(e.data.type==game.RoleType.Monster)t=1500+500*Math.random()|0;else if((t=e.data.attackWaitTime||0)<1){var a=game.BattleMiscCfg.getData("attackWaitTime");e.data.attackWaitTime=a?+a.value:0}return t},petAttack:function(){var e=1001,t=this._machine.owner.data.roleId,a=game.PartnerCfg.getData(t);if(a){var i=game.SkillCfg.getData(a.skill);i&&(e=i.clientSkill)}this.doAttack(e)},monsterAttack:function(){var a=this,e=a._machine.owner,i=1001,n=e.data.configId;game.MonsterCfg.getDataAsync(n,function(e){if(e){e.skills&&0<e.skills.length&&(i=e.skills[Math.random()*e.skills.length>>0]);var t=game.SkillCfg.getData(i);t&&(i=t.clientSkill),a.doAttack(i)}else b8e.error("\u602a\u7269\u4e0d\u5b58\u5728id: ",n)})},doAttack:function(e){var t=this;if(t._ref instanceof game.AiAttackStateReference&&(t.targets=t._ref.targets),!t.targets||t.targets.length<1)t.transition(game.AiStateType.IDLE);else if(t.skillCfg=game.ClientSkillCfg.getData(e),t.skillCfg){var a=t.getAttackWaitTime();0<(a+=t.skillCfg.attackWaitTime)?(b8e.Tween.kill(t),b8e.Tween.get(t).wait(a).call(t.attackTargets,t)):t.attackTargets()}else t.transition(game.AiStateType.IDLE)},attackTargets:function(){var e=this,t=e._machine.owner;if(t&&t.data&&0<t.data.hp){var a=b8e.scene,i=e.targets[0],n=a.getDisplayById(i),s=e.skillCfg;if(!n||!n.data||n.data.hp<1||!s)return void(e.roleType!=game.RoleType.Monster&&e.find());if(e.targetRole=n,game.skillRelease.release(a,t,s,1,null,e.releaseSkillComplete,e),game.skillHit.sceneHit(a,s,n,1,e.hitComplete,e),n.data.type==game.RoleType.Monster&&0<n.data.hp&&!n.getAiStateMachine().isAttack()){var o=n.getStateRef(game.AiAttackStateReference);o.setParams([t.data.id]),n.getAiStateMachine().attack(o);var r=t.getDirection();n.setDirection(game.Direction.negativeDirection(r))}}},hitComplete:function(e){if(!e||!e.data||e.data.hp<1)return e&&!e.getAiStateMachine().isDeath()&&e.getAiStateMachine().transition(game.AiStateType.DEATH),b8e.Tween.kill(this),b8e.Tween.get(this).wait(300).call(this.find,this),void(this._ref=null);var t=this._ref;this.transition(game.AiStateType.ATTACK,t)},releaseSkillComplete:function(){},find:function(){this.transition(game.AiStateType.FIND)},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$AiAttackState",e)}(),function(){var e;e=b8e.ControlState.extends({ctor:function(){this._super(game.AiStateType.DEATH)},execute:function(){var e=this;if(e._machine&&e._machine.usable){var t=e._machine.owner,a=t.getStateRef(game.DeathStateReference);a.setParams(1,!1),t.getStateMachine().transition(game.RoleStateType.ACTION_DEATH,a);var i=game.Direction.getDirection(t.getDirection()),n=game.Direction.getRadian(i),s=t.getScene(),o=t.getScenePosition(),r=game.ResCfg.getUrl(5001,2e3),g=t.localToGlobal();if(game.EffectUtil.playSceneEffect(s,r,o,n,1,!1,300,!0),game.scene.clearPathSolid(t.getGridPosition()),t.data&&game.scene.removeMonster(t.data.id),e.iconList||(e.iconList=[23,220001]),b8e.hasTimeout(e.dropItem,e))return;e.stagePosList||(e.stagePosList=[]),e.stagePosList.push(g),b8e.setTimeout(e.dropItem,e,1300)}},dropItem:function(){var g=this;if(g.stagePosList&&!(g.stagePosList.length<1)){var l=b8e.module.getView(game.ME.MainCenter);if(l)for(var c=void 0,h=g.stagePosList.shift(),e=Math.floor(2*Math.random()+3),t=function(e){var t=b8e.Sprite.get();t.setSize(40,40),t.addToParent(l),c=(c=g.iconList[e])||(.5<Math.random()?23:220001),t.loadTexture(game.ResCfg.getUrl(137,c)),t.setVisible(!0),t.alpha=1;var a=l.globalToLocal(h),i=a.x+40*(2*Math.random()-1),n=a.y+40*(2*Math.random()-1);t.setPosition(i,n),b8e.Tween.kill(t);var s=l.skin.guajiBoxAnim,o=b8e.MathUtil.getDistance(i,n+20,s.x+20,s.y-30),r=Math.floor(2*o);b8e.Tween.get(t).to({scaleX:2.1,scaleY:2.1,x:i,y:n+20},150).to({x:s.x+20,y:s.y-30,scaleX:.4,scaleY:.4},r).call(function(){t.alpha=1,b8e.Sprite.put(t)},l)},a=0;a<e;a++)t(a)}}}),b8e.RC("$$game","$$AiDeathState",e)}(),function(){var e;e=b8e.ControlState.extends({ctor:function(){this._super(game.AiStateType.MOVE)},execute:function(){if(!game.playBack.isFighting){var e=this;if(e._machine&&e._machine.usable&&e._ref instanceof game.AiMoveStateReference){var t=e._machine.owner,a=e._ref.target,i=e._ref.moveType;if(t&&a&&a.data&&a.data.beHitPos&&!(a.data.beHitPos.length<1)){var n=99999,s=0,o=0,r=t.getGridPosition(),g=void 0,l=void 0;0==i?(l=a.data.beHitPos,e.targetPos=a.data.beHitPos[0]):(l=a.data.retainHitPos,e.targetPos=a.data.retainHitPos[0]);for(var c=0,h=l.length;c<h;c++)g=l[c],(s=b8e.MathUtil.getDistance(r.x,r.y,g.x,g.y))<n&&(e.targetPos=g,n=s,o=c);if(!e.targetPos||!e.targetPos.x||e.targetPos.x<1||!e.targetPos.y||e.targetPos.y<1)e.transition(game.AiStateType.FIND);else if(a.data.beHitPos.splice(o,1),0==i){var m=game.BattleMiscCfg.getData("moveSpeed"),u=m?+m.value:1;game.moveTo.move(t,e.targetPos,0,u,!0,e.moveEnd,e)}else e.moveEnd()}else e.transition(game.AiStateType.FIND)}}},moveEnd:function(){var e=this._machine.owner,t=this._ref.target;if(!t||!t.data||t.data.hp<1)e.data.type!=game.RoleType.Monster&&this.transition(game.AiStateType.FIND);else{this.transition(game.AiStateType.IDLE),e.setDirection(game.Direction.getAnimatDirection(this.targetPos.dir));var a=e.getStateRef(game.AiAttackStateReference);a.setParams([t.data.id]),this.transition(game.AiStateType.ATTACK,a)}},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$AiMoveState",e)}(),function(){var e;e=b8e.ControlState.extends({ctor:function(){this._super(game.AiStateType.FIND)},execute:function(){if(!game.playBack.isFighting){var e=this;if(e._machine&&e._machine.usable){var t=e._machine.owner;e.monster=null,e.moveType=0,t.data.attackWaitTime=0;var a=game.sceneData.monsterIds;if(!a||a.length<1)t.data&&t.data.id==game.mainRoleData.id?(game.sceneData.setSceneBattle(!1),game.scene.clearAllPathSolid(),game.scene.resetPetState(),b8e.Tween.kill(e),b8e.Tween.get(e).wait(300).call(e.patrol,e)):e.transition(game.AiStateType.IDLE);else{var i=9999,n=i,s=t.getScenePosition(),o=void 0;if(t.data.type==game.RoleType.Hero)for(var r=void 0,g=0,l=a.length;g<l;g++)(r=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,a[g]))&&(o=r.getScenePosition(),(n=b8e.MathUtil.getDistance(s.x,s.y,o.x,o.y))<i&&(e.monster=r,i=n));else a.sort(function(){return.5-Math.random()}),e.monster=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,a[0]);e.monster&&(o=e.monster.getScenePosition(),(n=b8e.MathUtil.getDistance(s.x,s.y,o.x,o.y))<100&&(e.moveType=1)),b8e.Tween.kill(e),b8e.Tween.get(e).wait(300).call(e.findEnd,e)}}}},findEnd:function(){var e=this._machine.owner;if(this.monster){var t=e.getStateRef(game.AiMoveStateReference);t.setParams(this.monster,this.moveType),this.transition(game.AiStateType.MOVE,t)}else this.transition(game.AiStateType.FIND)},patrol:function(){this.transition(game.AiStateType.PATROL)},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$AiFindState",e)}(),function(){var e,a=e=b8e.StateMachine.extends({ctor:function(e){this._super(e),a.init(this)},start:function(){this.transition(game.AiStateType.PATROL)},stop:function(){this.transition(game.AiStateType.IDLE)},attack:function(e){this.transition(game.AiStateType.ATTACK,e)},move:function(e){this.transition(game.AiStateType.MOVE,e)},isAttack:function(){var e=this.getCurrState("ControlState");return e&&e.type==game.AiStateType.ATTACK},isMove:function(){var e=this.getCurrState("ControlState");return e&&e.type==game.AiStateType.MOVE},find:function(){this.transition(game.AiStateType.FIND)},isFind:function(){var e=this.getCurrState("ControlState");return e&&e.type==game.AiStateType.FIND},isDeath:function(){var e=this.getCurrState("ControlState");return e&&e.type==game.AiStateType.DEATH}});a.stateMapping=null,a.init=function(e){if(!a.stateMapping){var t=a.stateMapping={};t[game.AiStateType.IDLE]=game.AiIdleState,t[game.AiStateType.PATROL]=game.PatrolState,t[game.AiStateType.ATTACK]=game.AiAttackState,t[game.AiStateType.DEATH]=game.AiDeathState,t[game.AiStateType.MOVE]=game.AiMoveState,t[game.AiStateType.FIND]=game.AiFindState}e.setStateMapping(a.stateMapping)},b8e.RC("$$game","$$AiStateMachine",e)}(),function(){var e;e=b8e.Enum({IDLE:1,PATROL:2,ATTACK:3,DEATH:4,MOVE:5,FIND:6}),b8e.RC("$$game","$$AiStateType",e)}(),function(){var e,t=e=b8e.PoolObject.extends({ctor:function(e,t,a){this.reset(),this.initialize(e,t,a)},initialize:function(e,t,a){this._owner=e,this._target=t,this._distance=a,this.displaySyncInfo=new b8e.SceneDisplaySyncInfo(this),this._target.addSyncInfo(this.displaySyncInfo),this._isWalkMoving=!1},getSyncInfo:function(){return this.displaySyncInfo},syncGridInfo:function(e){if(!(e.x<0||e.y<0)&&b8e.scene.isLoaded())switch(game.sceneData.getSceneType()){case game.SceneType.GUANDU_MAP:case game.SceneType.CS_GUILD_WAR_LY:case game.SceneType.CS_GUILD_WAR_HG:case game.SceneType.CS_GUILD_WAR_LD:case game.SceneType.TREASURE:this._syncGridInfo();break;case game.SceneType.NONE0:case game.SceneType.NONE1:game.sceneData.monsterIds.length<1&&this._syncGridInfo()}},_syncGridInfo:function(){var e=this;if(e._owner&&e._target&&e._owner.data&&e._target.data){var t=e._owner,a=e._target.getScenePosition(),i=t.getScenePosition(),n=b8e.MathUtil.getDistance(a.x,a.y,i.x,i.y);if(!(n<e._distance)){var s=t.getScene();if(s){var o=n-e._distance;if(a=0<o?b8e.MathUtil.getSpaceDistance(i.x,i.y,a.x,a.y,o):i,a=s.getGridPosByPixel(a.x,a.y),n>e._distance){var r=[i=t.getGridPosition(),a];e._isWalkMoving=!0,null!=t.setFollowPos&&t.setFollowPos(a),game.moveTo.movePath(t,r,.99,e._moveComplete,e)}}}}},_moveComplete:function(){this._isWalkMoving=!1,this._owner},sceneX:{set:function(e){if(!(e<0)){if(this._owner)this._owner.getScenePosition().x<0||(this._owner.sceneX=e)}},get:function(){return this._owner.sceneX}},sceneY:{set:function(e){if(!(e<0)){if(this._owner)this._owner.getScenePosition().y<0||(this._owner.sceneY=e)}},get:function(){return this._owner.sceneY}},reset:function(){this._target=null,this._owner=null,this.displaySyncInfo=null,this._distance=0,this._tweenObj&&(this._tweenObj.sceneX&&(this._tweenObj.sceneX=0),this._tweenObj.sceneY&&(this._tweenObj.sceneY=0))},restore:function(e,t,a){this.initialize(e,t,a),this._super()},recycle:function(){this.reset(),this._super()}}),i=new b8e.Pool(t,1024);t.get=function(e,t,a){return i.get(e,t,a)},t.put=function(e){return i.put(e)},b8e.RC("$$game","$$FollowControl",e)}(),function(){var e;e=b8e.Enum({NONE:0,BODY:1,WEAPON:2,FOSTER:3,BOSS:4,EFFECT:5,PET_ANIM:9,BUFF:12,MOUNT:13,WING:14,MOUNT_HEAD:17,PET_FLY:18,ITEM_EFFECT:19,BATTLE:20,CS_WAR_MINE:21,AMBITION:22,NICK_NAME:26,JUNZHEN:29,BOSS_EFFECT:31,SHENHUN:32,HALO:33,SHENHUN2:34,UI_EFFECT:99}),b8e.RC("$$game","$$AnimType",e)}(),function(){var e;e=b8e.Enum({NONE:0,WING:-1,NICK_NAME:-1,YA_HAO:-1,HUA_HUAN:-1,ZHAN_ZHEN:-1}),b8e.RC("$$game","$$AttachType",e)}(),function(){var e;e=b8e.Enum({None:0,Hero:1,Partner:2,Shenhun:3,Monster:9,SceneEffect:1001,Npc:1002,UIRole:1003,HouseRole:1004,Foster:1005,FosterSkin:1006,ShenQi:1007,Wing:1008,UIShenhun:1009,Zhanji:1010,Halo:1011,GodAnimal:1013,DeathEffect:1200,ClientMonster:2010,ClientCollect:2011,ClientTower:2012,BianshenRed:2013,BianshenBlue:2014,Collect:2500,Tower:2600,CsWarHero:3001,CsWarMine:3002,CsArrow:3100,ExploreFloor:4001,ExploreGrid:4002,GuildConflictCity:4100,RANK:9999}),b8e.RC("$$game","$$RoleType",e)}(),function(){var e;e=b8e.Enum({NONE0:0,NONE1:1,CS_BOSS:2,CSWAR:3,GUANDU_MAP:4,CS_ARROW:5,THRONE:6,GUILD_MAP:10,CS_GUILD:11,CS_GUILD_WAR_LY:12,CS_GUILD_WAR_HG:13,CS_GUILD_WAR_LD:14,TREASURE:15,GUILD_CONFLICT:16,EXPLORE:99}),b8e.RC("$$game","$$SceneType",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super()},updatePetFollow:function(e,t,a){!(2<arguments.length&&void 0!==a)||a?this._addPetFollower(e,t):this._removePetFollower(e,t)},_addPetFollower:function(e,t){if(this._isExecute(e,t)){var a=game.FollowCfg.getUData(t.type);if(a){var i=e.data.id;t.queueIdx=a.queueIdx,this.isHasQueueIdx(i,t)||(this._setQueueObj(i),this._setQueueIdx(i,t),this._setPetFollower(i,e,t))}else b8e.warn("\u672a\u914d\u7f6e\u7684\u8ddf\u968f\u7c7b\u578bRoleType\uff1a ",t.type)}},_setQueueObj:function(e){var t=void 0;this._queueMap&&(t=this._queueMap.get(e))||(t=this._getObj(),this._queueMap||(this._queueMap=b8e.HashMap.get()),this._queueMap.set(e,t))},_setQueueIdx:function(e,t){var a=this.getQueueObj(e);if(a){var i=a.queueIdxs;i&&i.set(t.queueIdx,t.queueIdx)}},isHasQueueIdx:function(e,t){var a=this.getQueueObj(e);if(!a)return!1;var i=a.queueIdxs;return!(!i||i.count()<1)&&i.get(t.queueIdx)},_setPetFollower:function(e,t,a){var i=this.getQueueList(e);if(i){if(i.count()<1)return i.append(a),void a.setFollowTarget(t,this._getFollowDistance(a));var n=void 0,s=void 0;i.forEach(function(e){s||(n=e)&&a.queueIdx<e.queueIdx&&!s&&(s=!0)},this),this._insertPetFollower(i,t,a,n)}},_insertPetFollower:function(e,t,a,i){if(i)if(e.getNext(i)){var n=void 0,s=e.getPrev(i);n=s?(s=e.getPrev(i),this._rmvSyncInfo(i,s),s):(this._rmvSyncInfo(i,t),t),a.setFollowTarget(n,this._getFollowDistance(a)),i.removeFollowControl(),i.setFollowTarget(a,this._getFollowDistance(i)),e.insert(a,i)}else a.setFollowTarget(i,this._getFollowDistance(a)),e.insert(a)},_removePetFollower:function(e,t){if(this._isExecute(e,t)){var a=e.data.id,i=this.getQueueList(a);if(i&&!(i.count()<1)){var n=void 0;i.forEach(function(e){!e||e.queueIdx!=t.queueIdx||n||(n=e)},this),n&&(this._delQueueIdx(a,n),this._fixFollower(i,e,n,this._getFollowDistance(t)))}}},_delQueueIdx:function(e,t){var a=this.getQueueObj(e);if(a){var i=a.queueIdxs;!i||i.count()<1||i.del(t.queueIdx)}},updateTeamFollower:function(e,t){var a=1<arguments.length&&void 0!==t?t:0;if(0<a){this._setQueueObj(a);var i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,a),n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e);this._setTeamFollower(a,i,n)}else this._removeTeamFollower(e)},updatePetFollower:function(e,t){var a=1<arguments.length&&void 0!==t?t:0;if(0<a){this._setQueueObj(a);var i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,a),n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Partner,e);this._setTeamFollower(a,i,n)}else this._removeTeamFollower(e)},_removeTeamFollower:function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e);if(t&&t.data)if(this.isFollow(t)){var a=t.data,i=a.teamLeaderIdx,n=this.getQueueList(i);if(n&&!(n.count()<1)){if(n.count()<2)return this._rmvQESyncInfo(n,i),void(this._queueMap&&this._queueMap.del(i));var s=void 0;if(n.forEach(function(e){!e||e.id!=t.id||s||(s=e)},this),s){var o=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,a.teamLeaderIdx);o&&o.data&&this._fixFollower(n,o,s,this._getFollowDistance(t))}}}else t.data.teamLeaderIdx=0},_setTeamFollower:function(e,t,a){if(a&&a.data){var i=this.getQueueList(e);if(i){var n=i.count();if(e!=a.id){if(!t)return a.data.teamLeaderIdx=e,void i.append(a);if(n<1)return a.data.teamLeaderIdx=e,i.append(a),void a.setFollowTarget(t,this._getFollowDistance(a));var s=i.tail();s&&(a.data.teamLeaderIdx=e,a.setFollowTarget(s,this._getFollowDistance(a)),i.insert(a))}else 0<n&&(this._rmvQESyncInfo(i,e),this._fixMemberFollowSyncInfo(i,t))}}},_fixMemberFollowSyncInfo:function(e,t){if(t&&t.data){var a=void 0;e.forEach(function(e){!e||a||(a=e)},this),a&&(a.setFollowTarget(t,this._getFollowDistance(a)),this.__fixSyncInfo(e,a))}},__fixSyncInfo:function(e,t){var a=e.getNext(t);a&&(a.setFollowTarget(t,this._getFollowDistance(a)),this.__fixSyncInfo(e,a))},delQueueListById:function(e){if(e&&this._queueMap){var t=this._queueMap.get(e);if(t){var a=t.queueList;!a||a.count()<1||(this._rmvQESyncInfo(a,e),this._queueMap&&this._queueMap.del(e))}}},_fixFollower:function(e,t,a,i){var n=void 0,s=e.getNext(a);s?(n=e.getPrev(a))?(a.removeFollowControl(),n=e.getPrev(a),s=e.getNext(a),n&&s&&(this._rmvSyncInfo(n,a),this._rmvSyncInfo(a,n),a.removeFollowControl(),s.removeFollowControl(),s.setFollowTarget(n,i),e.remove(a))):((s=e.getNext(a))&&(s.removeFollowControl(),this._rmvSyncInfo(a,t),s.setFollowTarget(t,i)),e.remove(a)):((n=e.getPrev(a))&&this._rmvSyncInfo(a,n),a.removeFollowControl(),e.remove(a))},_rmvSyncInfo:function(e,t){var a=e.getControl();if(a){var i=a.getSyncInfo();if(i){var n=i.getObj();n&&t.removeSyncInfo(n)}}},_isExecute:function(e,t){return!!(e&&e.data&&t&&t.data)},getQueueObj:function(e){return this._queueMap?this._queueMap.get(e):null},getQueueList:function(e){var t=this.getQueueObj(e);if(!t)return null;var a=t.queueList;return a||null},_getObj:function(){if(this._pool&&1<this._pool.length)return this._pool.pop();var e={queueIdxs:null,queueList:null};return e.queueIdxs=b8e.HashMap.get(),e.queueList=b8e.LinkedList.get(),e},_getFollowDistance:function(e){if(!e||!e.data)return 50;var t=e.data.type,a=game.FollowCfg.getUData(t);return a?a.distance:50},_recycle:function(e,t){if(t){var a=t.queueList;!a||a.count()<1||(this._rmvQESyncInfo(a,e),a.clear(),t.queueIdxs.clear(),this._pool||(this._pool=[]),this._pool.push(t))}},_rmvQESyncInfo:function(e,t){if(e&&!(e.count()<1)){e.forEach(this._rmvMemberSyncInfo,this,e);var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,t);if(a){var i=e.values();if(i&&!(i.length<1)){var n=i[0];n&&(this._rmvSyncInfo(n,a),a.removeFollowControl())}}}},_rmvMemberSyncInfo:function(e,t){if(e){if(t){var a=t.getNext(e);if(a)this._rmvSyncInfo(a,e),a.removeFollowControl();else if(e.data&&e.data.teamLeaderIdx){var i=e.data.teamLeaderIdx,n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,i);n&&(this._rmvSyncInfo(e,n),n.removeFollowControl())}e.removeFollowControl()}}},isFollow:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;a=a||game.mainRole;var i=!1;if(this._queueMap){var n=void 0;this._queueMap.forEach(function(e,t){(n=t.queueList)&&!i&&n.has(a)&&(i=!0)},this)}return i},isInQueueListById:function(e,t){var a=1<arguments.length&&void 0!==t?t:null,i=this.getQueueList(e);return!(!i||i.count()<1)&&(a=a||game.mainRole,i.has(a))},isLeader:function(){return!this.isFollow()&&(!!this._queueMap&&!!this._queueMap.get(game.mainRole.id))},isCanMove:function(e){if(0<arguments.length&&void 0!==e&&e)return!0;return!this.isFollow()||this.isLeader()},clear:function(){this._queueMap&&(this._queueMap.forEach(this._recycle,this),this._queueMap.clear())},clearRobot:function(){var a=this;a._queueMap&&a._queueMap.forEach(function(e,t){game.mainRoleData.roleId!=e&&a._recycle(e,t)},a)}});game.follow=game.follow||new e}(),function(){var e,t=e=b8e.PoolObject.extends({_model:null,ctor:function(){this._super(),this.clear()},setup:function(e){this._model=e},body:{get:function(){return this._getBodyUrl()}},bodyUI:{get:function(){return this._getBodyUrl(!0)}},_getBodyUrl:function(e){var t=this._model;if(!t||0==t.type)return"";var a=game.RoleUrlCfg.getUData(t.type);if(!a)return"";if(a.fashion&&t.surfaceFashion){var i=t.surfaceFashion;return e&&-1==(i+"").indexOf("UI")&&(i="UI/"+i),game.ResCfg.getUrl(a.key,i)}if(!a.body&&t.body){var n=t.body;return e&&-1==(n+"").indexOf("UI")&&(n="UI/"+n),game.ResCfg.getUrl(a.key,n)}if(a.body){var s=a.body;return t.type==game.RoleType.Hero&&(s=t.isMale?1001:1002),e&&-1==(s+"").indexOf("UI")&&(s="UI/"+s),game.ResCfg.getUrl(a.key,s)}return""},weapon:{get:function(){return this._getAnim(game.AnimType.WEAPON,!1,this._model.surfaceWeapon)}},weaponUI:{get:function(){return this._getAnim(game.AnimType.WEAPON,!0,this._model.surfaceWeapon)}},nickName:{get:function(){return this._getAnim(game.AnimType.NICK_NAME)}},nickNameUI:{get:function(){return this._getAnim(game.AnimType.NICK_NAME,!0)}},mount:{get:function(){return this._getAnim(game.AnimType.MOUNT,!1,this._model.surfaceMount)}},mountUI:{get:function(){return this._getAnim(game.AnimType.MOUNT,!0,this._model.surfaceMount)}},mountHead:{get:function(){return this._getAnim(game.AnimType.MOUNT_HEAD,!1,this._model.surfaceMountHead)}},mountHeadUI:{get:function(){return this._getAnim(game.AnimType.MOUNT_HEAD,!0,this._model.surfaceMountHead)}},wing:{get:function(){return this._getAnim(game.AnimType.WING,!1,this._model.surfaceWing)}},wingUI:{get:function(){return this._getAnim(game.AnimType.WING,!0,this._model.surfaceWing)}},shenhun:{get:function(){return this._getAnim(game.AnimType.SHENHUN,!1)}},shenhunUI:{get:function(){return this._getAnim(game.AnimType.SHENHUN,!0)}},halo:{get:function(){return this._getAnim(game.AnimType.HALO,!1)}},haloUI:{get:function(){return this._getAnim(game.AnimType.HALO,!0)}},_getAnim:function(e,t,a){var i=this._model,n=i.getAnim(e);if(n=a||n,i&&n){var s=game.AnimUrlCfg.getUData(e);return s?(t&&-1==(n+"").indexOf("UI")&&(n="UI/"+n),game.ResCfg.getUrl(s.key,n)):""}return null},clear:function(){var e=this;e.url=null,e.name=null,e.ext=null,e.resUrl=null,e.type=null,e.priority=0,e.arrivalOrder=0,e.options=null,e.noCache=!1,e.version=null,e.hasCache=!1,e.isLoading=!1,e.isLoaded=!1,e.isUnused=!1,e.lazyParse=!1,e.isCompress=!1,e.loadDepends=!1,e.dependsInited=!1,e.callbacks&&e.callbacks.clear(),e.references&&e.references.clear(),e.err=null,e.asset=null,e.format=null,e.dependKeys=null,e.reloadCount=0,e.onParseProgress=null,e.onParseProgressThis=null,e.rawData=void 0},recycle:function(){this.clear(),this._super()}}),a=new b8e.Pool(t,1024);t.get=function(){return a.get()},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$AvatarInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({_objName:"BaseRoleData",ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,i=1<arguments.length&&void 0!==t?t:0;this._super(),this.reset(),this.heroModel=game.HeroModel.get(),this.avatar=game.AvatarInfo.get(),this.avatar.setup(this.heroModel),this.type=a,this.id=i},reset:function(){var e=this;e.type=0,e.id=0,e.name="",e.direction=0,e.ambiton=0,e.isMale=!1,e.heroModel&&(e.heroModel.clear(),e.avatar&&(e.avatar.clear(),e.avatar.setup(e.heroModel)))},setMale:function(e){this.isMale=e,this.heroModel&&(this.heroModel.isMale=e)},restore:function(e,t){this.reset(),this.type=e,this.id=t,this._super()},recycle:function(){this.reset(),this._super()}}),a=new b8e.Pool(t,1024);t.get=function(e,t){return a.get(e,t)},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$BaseRoleData",e)}(),function(){var i=void 0;(i=b8e.Enum({None:0,Up:-1,UpRight:-1,Right:-1,DownRight:-1,Down:-1,DownLeft:-1,Left:-1,UpLeft:-1})).getRadian=function(e){var t=i.getAnimatDirection(e);return b8e.CommonUtil.getRadianByDirection(t)},i.getAnimatDirection=function(e){var t={x:0,y:0};return e==i.Up?(t.x=0,t.y=1):e==i.UpRight?(t.x=1,t.y=1):e==i.Right?(t.x=1,t.y=0):e==i.DownRight?(t.x=1,t.y=-1):e==i.DownLeft?(t.x=-1,t.y=-1):e==i.Down?(t.x=0,t.y=-1):e==i.Left?(t.x=-1,t.y=0):e==i.UpLeft?(t.x=-1,t.y=1):(t.x=0,t.y=-1),t},i.getDirection=function(e){if(!e)return i.Down;var t=e.x,a=e.y;return 0==t&&1==a?i.Up:1==t&&1==a?i.UpRight:1==t&&0==a?i.Right:1==t&&-1==a?i.DownRight:-1==t&&-1==a?i.DownLeft:0==t&&-1==a?i.Down:-1==t&&0==a?i.Left:-1==t&&1==a?i.UpLeft:i.Down},i.negativeDirection=function(e){switch(i.getDirection(e)){case i.Up:case i.UpRight:return i.getAnimatDirection(i.DownLeft);case i.Right:case i.DownRight:case i.Down:return i.getAnimatDirection(i.UpLeft);case i.Left:case i.DownLeft:return i.getAnimatDirection(i.UpRight);case i.UpLeft:return i.getAnimatDirection(i.DownRight);default:return i.getAnimatDirection(i.DownLeft)}},i.getRandDirection=function(){switch(1+(1e4*Math.random()|0)%8){case i.Up:case i.UpRight:return i.getAnimatDirection(i.DownLeft);case i.Right:case i.DownRight:case i.Down:return i.getAnimatDirection(i.UpLeft);case i.Left:case i.DownLeft:return i.getAnimatDirection(i.UpRight);case i.UpLeft:return i.getAnimatDirection(i.DownRight);default:return i.getAnimatDirection(i.DownLeft)}},b8e.RC("$$game","$$Direction",i)}(),function(){var e,n=e=game.BaseRoleData.extends({ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:game.RoleType.Hero,i=t;this.constructor===n&&(n.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(a,i),this._resetHeroData(),n.count++,this.spriteStat=game.SpriteStat.get(),this.createPos={x:0,y:0},this.attackWaitTime=0},setRobotData:function(e){this.type=game.RoleType.Hero,this.id=e.roleId,this.roleId=e.roleId,this.name=e.roleName,this.isMale=e.isMale;var t=this.getDefaultCfg();this.heroModel.clear(),this.heroModel.setSurface(e.surface),this.heroModel.setBody(game.RoleType.Hero,t.model)},setMainRoleData:function(e){var t=this;t.type=game.RoleType.Hero,t.id=e.id,t.roleId=e.id,t.name=e.name,t.exp=e.exp,t.lv=e.level,t.transferLevel=e.transferLevel,t.setMale(e.isMale),t.power=e.power,t.maxPower=e.historyMaxPower,t.vipLevel=e.vipLevel,e.stat&&t.spriteStat.updateStat(e.stat,!0),t.isSelf=!0,t.mapId=e.map,t.renameFreeUsed=e.renameFreeUsed;var a=t.getDefaultCfg();t.heroModel.clear(),t.heroModel.setBody(game.RoleType.Hero,a.model),t.heroModel.setAnim(game.AnimType.WEAPON,a.weapon),t.resetPatrolPos(),t.guildName=e.guildName,t.createTime=e.createTime,t.levelUpTime=e.levelUpTime?e.levelUpTime:e.createTime},resetPatrolPos:function(e){var t=this,a=game.SceneCfg.getData(t.mapId);if(!a)return b8e.error("\u6ca1\u6709\u627e\u5230\u5730\u56fe\u914d\u7f6e",t.mapId),void t.setCreatePos(0,0);if(a.patrol){var i=a.partrolPath;t.partrolIndex=null!=e?e:i.length*Math.random()>>0;var n=i[t.partrolIndex];t.setCreatePos(n.X,n.Y)}else a.inPos?(t.partrolIndex=0,t.setCreatePos(a.inPos.X,a.inPos.Y)):(t.partrolIndex=0,t.setCreatePos(0,0))},setUnitData:function(e){var t=this;t.type=e.type,t.id=e.id,t.name=e.name;var a=b8e.scene.getPixelPosByGrid(e.x,e.y);t.setCreatePos(a.x,a.y);var i=game.SceneUnitType;switch(t.type){case i.PLAYER:t._setPlayer(e);break;case i.MONSTER:t._setMonster(e);break;case i.BOX:t._setBox(e);break;case i.TOWER:t._setTower(e);break;case i.NPC:t._setNpc(e);break;case i.PARTNER:t._setPartner(e)}},_setPartner:function(e){if(e.pet){this.roleId=e.pet.id,this.hp=e.hp||0,this.maxHp=e.maxhp||0,this.useSkin=e.useSkin||0}},_setPlayer:function(e){var t=e.player;if(t){var a=this;a.roleId=t.roleId,a.isMale=t.isMale,a.setMale(a.isMale),a.heroModel.clear(),a.heroModel.setSurface(t.surface);var i=a.getDefaultCfg();a.heroModel.setBody(game.RoleType.Hero,i.model),a.guildId=t.guildId,a.guildName=t.guildName,a.zone=t.zone,a.arrow=t.arrow,a.ambiton=t.ambiton,a.campId=t.camp,a.isBianshen=t.bianshen,a.occupyId=t.mineUnitId,a.power=t.power,a.zone&&(a.name+=".s"+a.zone),a.guildName&&(a.guildName+=".s"+a.zone),a.monarch=t.monarch,a.guildWarOwner=!!t.guildWarOwner&&t.guildWarOwner,t.teamId&&(a.teamId=t.teamId),t.teamLeaderIdx&&(a.teamLeaderIdx=t.teamLeaderIdx),t.keys&&(a.keys=t.keys)}},_setMonster:function(e){if(e.monster){this.roleId=e.monster.id,this.hp=e.hp||0,this.maxHp=e.maxhp||0}},_setBox:function(e){if(e.box){this.roleId=e.box.id}},_setTower:function(e){if(e.tower){this.roleId=e.tower.id,this.master=e.tower.master}},_setNpc:function(e){if(e.npc){this.roleId=e.npc.id}},setCreatePos:function(e,t){this.createPos&&(this.createPos.x=e,this.createPos.y=t)},setServerPos:function(e,t){this.serverEnterPosX=e,this.serverEnterPosY=t},setVipLevel:function(e){this.vipLevel=e},getDefaultCfg:function(){var e=this.isMale?1001:1002;return game.DefaultHero.getData(e)},_resetHeroData:function(){var e=this;e.spriteStat?e.spriteStat.clear():e.spriteStat=game.SpriteStat.get(),e.createPos?(e.createPos.x=0,e.createPos.y=0):e.createPos={x:0,y:0},e.isSelf=!1,e.roleId=0,e.mapId=0,e.exp=0,e.line=0,e.sex=1,e.lv=0,e.transferLevel=0,e.skillInfo=null,e.power=0,e.vipLevel=0,e.serverEnterPosX=0,e.serverEnterPosY=0,e.guildId=0,e.guildName="",e.createTime=0,e.zone=0,e.isFighting=!1,e.levelUpTime=0,e.renameFreeUsed=!1,e.monarch=!1,e.arrow=!1,e.isBianshen=!1,e.campId=0,e.occupyId=0,e.guanduMapEvent=0,e.teamId=0,e.teamLeaderIdx=0,e.teamLeader=0,e.teamFollow=0,e.teamCount=0,e.isShowGuildName=!1,e.guildWarOwner=!1,e.master=0,e.keys=0,e.attackWaitTime=0,e.useSkin=0},restore:function(e,t){this._resetHeroData(),this._super(e,t),n.count++,this.roleId=t},recycle:function(){this._resetHeroData(),this._super(),n.count--},release:function(){this.constructor===n?n.put(this):this.destroy()},dispose:function(){this.equipSlotsMap&&(this.equipSlotsMap.destroy(),this.equipSlotsMap=null),this.miscData&&(this.miscData=null),this.spriteStat&&(this.spriteStat.release(),this.spriteStat=null),this._super()},destroy:function(){this.constructor===n&&(n.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this.recycle(),this.dispose(),this._super()}});n.count=0;var a=new b8e.Pool(n,1024);n.get=function(e,t){return a.get(e,t)},n.put=function(e){return a.put(e)},b8e.RC("$$game","$$HeroData",e)}(),function(){var e,t=e=b8e.PoolObject.extends({isMale:!0,isUIModel:!1,mountOffsetY:0,uiMountOffsetY:0,ctor:function(){this._super(),this.clear()},setSurface:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:0,n=2<arguments.length&&void 0!==a&&a,s=this;if(s.surface=e){s.roleType=i;var o=void 0;if(e.nickname){var r=game.NicknameCfg.getData(e.nickname);r&&(o=s.__getModel(r),s.setAnim(game.AnimType.NICK_NAME,o))}if(e.skins&&s.setSurfaces(e.skins,n),e.shenqi){var g=game.ShenQiCfg.getData(e.shenqi);g&&(o=game.AvatarUtil.getUIModel(g,0,n),s.setAnim(game.AnimType.WEAPON,o))}else{var l=game.DefaultHero.getData(s.isMale?1001:1002);s.setAnim(game.AnimType.WEAPON,l.weapon)}e.halo&&s.setFosterAnim(game.NewFosterType.HALO,e.halo,game.AnimType.HALO),e.wing&&s.setFosterAnim(game.NewFosterType.WING,e.wing,game.AnimType.WING),e.mount&&s.setFosterAnim(game.NewFosterType.MOUNT,e.mount,game.AnimType.MOUNT,game.AnimType.MOUNT_HEAD),e.shenhun&&s.setFosterAnim(game.NewFosterType.SHENHUN,e.shenhun,game.AnimType.SHENHUN)}},setFosterAnim:function(e,t,a,i){var n=game.fosterData.getFosterBaseCfg(e,t);n&&(this.setAnim(a,n.model),i&&(this.fosterMountId=t,this.surfaceMount||(this.mountOffsetY=n.mountOffsetY,this.uiMountOffsetY=n.UIMountOffsetY,this.setAnim(i,n.mountHead))))},setHeroModelType:function(e){this.type=e},setMale:function(e){this.isMale=e},setMountOffsetY:function(e){this.mountOffsetY=e},setBody:function(e,t,a){var i=2<arguments.length&&void 0!==a&&a;if(this.type=e,this.body=t,!this.body&&i){var n=game.DefaultHero.getData(2001);if(n){var s=this.__getModel(n);this.body=s}}},setFashion:function(e){if(e&&!(e<1)){var t=game.SuitSkinCfg.getData(e);if(t){var a=void 0,i=game.AvatarUtil;a=this.isMale?i.getUIModel(t,0,!1):i.getUIModel(t,game.AvatarUtil.MT_1,!1),this.surfaceFashion=a}}},setSurfaces:function(e,t){var a=this;if(e){a.surfaces=e,a.surfaceFashion=0,a.surfaceWeapon=0,a.surfaceWing=0,a.surfaceMount=0,a.surfaceMountHead=0;for(var i=game.SurfaceTypes,n=game.AvatarUtil,s=void 0,o=0,r=e.length;o<r;o++)if(s=game.SuitSkinCfg.getData(e[o]))switch(s.types){case i.FASHION:a.surfaceFashion=n.getUIModel(s,a.isMale?game.AvatarUtil.MT_0:game.AvatarUtil.MT_1,t);break;case i.MOUNT:a.setAnim(game.AnimType.MOUNT_HEAD,0),a.surfaceMount=n.getUIModel(s,0,t),a.surfaceMountHead=n.getUIModel(s,game.AvatarUtil.MT_3,t),a.mountOffsetY=s.mountOffsetY,a.uiMountOffsetY=s.UIMountOffsetY;break;case i.WING:a.surfaceWing=n.getUIModel(s,0,t);break;case i.WEAPON:a.surfaceWeapon=n.getUIModel(s,0,t)}!a.surfaceMount&&a.fosterMountId&&a.setFosterAnim(game.NewFosterType.MOUNT,a.fosterMountId,game.AnimType.MOUNT,game.AnimType.MOUNT_HEAD)}},setUseFly:function(e){this.useFly=e},setModel:function(e,t){this._modelDic||(this._modelDic=[]),this._modelDic[e]=t},getModel:function(e){return this._modelDic&&this._modelDic[e]?this._modelDic[e]:null},setAnim:function(e,t){this._animDic||(this._animDic=[]),this._animDic[e]=t},copyAnim:function(){var e=[];if(!this._animDic)return e;for(var t in this._animDic)e[t]=this._animDic[t];return e},setAnims:function(e){if(e)for(var t in e)this.setAnim(t,e[t])},getAnim:function(e){return this._animDic&&this._animDic[e]?this._animDic[e]:null},__getModel:function(e,t){var a=e.model;this.isUIModel&&(a=game.AvatarUtil.getUIModel(e,t));return a},clear:function(){var e=this;e.type=0,e.body=null,e.surfaceFashion=0,e.surfaceWeapon=0,e.surfaceWing=0,e.surfaceMount=0,e.surfaceMountHead=0,e.useFly=!1,e.isUIModel=!1,e.fosterMountId=0,e._animDic&&(e._animDic.length=0),e._modelDic&&(e._modelDic.length=0)},recycle:function(){this.clear(),this._super()}}),a=new b8e.Pool(t,1024);t.get=function(){return a.get()},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$HeroModel",e)}(),function(){var e,a=e=game.BaseRoleData.extends({_objName:"RoleData",ctor:function(e,t){this.constructor===a&&(a.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(e,t),this.reset(),this.type=e,this.id=t,this.buffs=[]},setData:function(e,t,a,i,n){var s=1<arguments.length&&void 0!==t&&t,o=a,r=i,g=n;if(e){var l=this;l.id=e.id,l.configId=e.roleId,l.name=e.name,l.hp=e.hp,l.maxHp=e.maxhp,l.shield=e.shield,l.maxShield=e.maxShield,l.mp=e.mp,l.maxMp=e.maxmp,l.setMale(e.ismale),l.isAttack=s?!e.attack:e.attack,l.type=e.type,l.posType=l.isAttack?1:2,l.direction=l.isAttack?game.Direction.UpLeft:game.Direction.DownRight,l.pos=e.pos,0==l.pos&&(l.pos=1),l.posCfg=game.PlayBackPosCfg.getData(l.posType,l.pos),l.posCfg?(l.birthPos.x=l.posCfg.birthPos.X,l.birthPos.y=l.posCfg.birthPos.Y,l.hitPos.x=l.posCfg.hitPos.X,l.hitPos.y=l.posCfg.hitPos.Y,l.createPos.x=l.posCfg.posX,l.createPos.y=l.posCfg.posY,l.beAttackedPos.x=l.posCfg.beAttackPosX,l.beAttackedPos.y=l.posCfg.beAttackPosY,l.beSelfAttackedPos.x=l.posCfg.beSelfAttackPosX,l.beSelfAttackedPos.y=l.posCfg.beSelfAttackPosY):b8e.error("PlayBackPos\u914d\u7f6e\u4e3a\u7a7a\uff1a",l.posType,l.pos);var c=e.surface;l.heroModel.clear(),l.heroModel.setMale(e.ismale),l.heroModel.setSurface(c,l.type),l.quality=c?c.roleQuality:0;var h=void 0,m=void 0,u=game.RoleType;switch(l.type){case u.Hero:(m=game.DefaultHero.getData(l.isMale?1001:1002))&&(h=m.model);break;case u.Monster:return void game.MonsterCfg.getDataAsync(l.configId,function(e){e&&(l.quality=e.quality||5,l.config=e,h=e.model,l.heroModel.setBody(l.type,h),o.call(r,l,g))},l);case u.Partner:if((m=game.PartnerCfg.getData(l.configId))&&(h=m.model),e.surface&&e.surface.skins&&e.surface.skins.length){var d=game.PartnerSkinCfg.getData(e.surface.skins[0]);d&&(h=d.model)}break;case u.Npc:(m=game.NpcCfg.getData(l.configId))&&(h=m.model,l.heroModel.setBody(l.type,h));break;case u.Shenhun:(m=game.ShenhunBaseCfg.getData(l.configId))&&(h=m.model,l.heroModel.setBody(l.type,h))}l.heroModel.setBody(l.type,h),o.call(r,l,g)}},reset:function(){var e=this;e._super(),e.type=0,e.hp=0,e.maxHp=0,e.mp=0,e.maxmp=0,e.groupId=0,e.posType=1,e.pos=0,e.posCfg=null,e.createPos=null,e.beAttackedPos=null,e.beSelfAttackedPos=null,e.roleId=0,e.master=0,e.shield=0,e.maxShield=0,e.configId=0,e.isMale=!1,e.isAttack=!1,e.posType=2,e.direction=game.Direction.DownRight,e.config=null,e.birthPos?(e.birthPos.x=0,e.birthPos.y=0):e.birthPos={x:0,y:0},e.hitPos?(e.hitPos.x=0,e.hitPos.y=0):e.hitPos={x:0,y:0},e.createPos?(e.createPos.x=0,e.createPos.y=0):e.createPos={x:0,y:0},e.beAttackedPos?(e.beAttackedPos.x=0,e.beAttackedPos.y=0):e.beAttackedPos={x:0,y:0},e.beSelfAttackedPos?(e.beSelfAttackedPos.x=0,e.beSelfAttackedPos.y=0):e.beSelfAttackedPos={x:0,y:0},e.buffs?e.buffs.length=0:e.buffs=[]},restore:function(e,t){this.reset(),this._super(e,t)},recycle:function(){this.reset(),this._super()},release:function(){this.constructor===a?a.put(this):this.destroy()},dispose:function(){this.spriteStat&&(this.spriteStat.release(),this.spriteStat=null),this._super()},destroy:function(){this.constructor===a&&(a.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this.recycle(),this.dispose(),this._super()}}),i=new b8e.Pool(a,1024);a.get=function(e,t){return i.get(e,t)},a.put=function(e){return i.put(e)},b8e.RC("$$game","$$RoleData",e)}(),function(){var e,s=e=b8e.SceneEntity.extends({_headBar:null,_rootBar:null,_shadow:null,_stateMachine:null,_bodyAnim:null,_ride:!1,_currRide:!1,queueIdx:-1,ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:void 0,i=1<arguments.length&&void 0!==t?t:void 0;this.constructor===s&&(s.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(a,i);var n=game.AttachType;this.attachLimitable=[n.NICK_NAME,n.WING],this._stateMachine=new game.RoleStateMachine(this),this.reset()},onHierarchyVisible:function(e){this._super(e),this.onDefaultVisibleState()},onDefaultVisibleState:function(){this._rootBar&&this._rootBar.setNameVisible(!1),this._headBar&&(this._headBar.setHpBarVisible(!1),this._headBar.setMpBarVisible(!1))},showChallengeIcon:function(e,t,a,i){var n=1<arguments.length&&void 0!==t?t:2,s=2<arguments.length&&void 0!==a?a:null,o=3<arguments.length&&void 0!==i?i:null;this._challengeIcon||(this._challengeIcon=new game.ChallengeIcon),this._challengeIcon.parent||this.addChild(this._challengeIcon),this._challengeIcon.show(e,n,s,o),this._challengeIcon.setPosition(-this._challengeIcon.getIconWidth()/2,70)},hideChallengeIcon:function(){this._challengeIcon&&this._challengeIcon.hide()},addHeadBar:function(){var e=this;e._headBar||(e._headBar=new game.HeadBar),e._bodyAnim=e.getAnimator(game.AnimType.BODY,1),e._bodyAnim||(e._bodyAnim=e.addAnimator(game.AnimType.BODY,1,10)),e._bodyAnim&&e._bodyAnim.addChildToBindNode(e._headBar,"HP",150)},updateBarPos:function(){this._headBar&&this._headBar.updateBarPosition()},getHpBindNode:function(){if(this._bodyAnim=this.getAnimator(game.AnimType.BODY,1),this._bodyAnim||(this._bodyAnim=this.addAnimator(game.AnimType.BODY,1,10)),this._bodyAnim)return this._bodyAnim.getBindNode("HP")},updateHpBar:function(){this._headBar&&this._headBar.setHpBar(this.data)},updateMpBar:function(){this._headBar&&this._headBar.setMpBar(this.data)},updateNickName:function(e){if(this.data&&this.data.avatar){var t=this.data.avatar,a=e?t.nickNameUI:t.nickName;a?(this.addHeadBar(),this._headBar.setNickName(a),this.updateBarPos()):this.rmvNickName()}else this.rmvNickName()},rmvNickName:function(){this._headBar&&this._headBar.rmvNickName()},updateScale:function(){var e=1/(this.getScene()?this.getScene().getSceneScale():1)/(this._bodyAnim?this._bodyAnim.scaleX:1);this._headBar&&this._headBar.setScale(e,e)},addRootBar:function(){this._rootBar||(this._rootBar=new game.RootBar),this._rootBar&&(this._rootBar.setLocalZOrder(50),this._rootBar.setPosition(0,-33)),this._rootBar.parent||this.addChild(this._rootBar)},hideRootBar:function(){this._rootBar&&this._rootBar.setVisible(!1)},updateName:function(e){var t=0<arguments.length&&void 0!==e?e:3,a=this;if(a._rootBar)if(a.data.name&&""!=a.data.name){a._rootBar.setVisible(!0);var i=a.data&&a.data.heroModel&&a.data.heroModel.surface&&a.data.heroModel.surface.topLv?"+"+a.data.heroModel.surface.topLv:"",n=a.data&&a.data.heroModel&&a.data.heroModel.surface&&a.data.heroModel.surface.roleQuality?a.data.heroModel.surface.roleQuality:0;0<n&&(t=n);var s=a.data.name+i,o=game.HtmlUtil.getColorStrByQuality(t,s,!0);a._rootBar.setNameText(o)}else a._rootBar.setVisible(!1)},updateNameColor:function(){},addShadow:function(){var e=this;e._shadow||(e._shadow=b8e.Sprite.get(),e._shadow.setAnchor(.5,.5),e._shadow.setLocalZOrder(-100),e._shadow.loadTexture(game.ResCfg.getUrl(4e3,"yinying")));var t=void 0;(t=e._currRide?(e._mountAnim||(e._mountAnim=e.getAnimator(game.AnimType.MOUNT,1)),e._mountAnim):(e._bodyAnim=e.getAnimator(game.AnimType.BODY,1),e._bodyAnim||(e._bodyAnim=e.addAnimator(game.AnimType.BODY,1,10)),e._bodyAnim))&&t.addChildToBindNode(e._shadow,"root",-500),e.showShadow()},showShadow:function(){this._shadow&&this._shadow.setVisible(!0)},hideShadow:function(){this._shadow&&this._shadow.setVisible(!1)},updateRideState:function(e){if(this.data&&(this.data.type==game.RoleType.Hero||this.data.type==game.RoleType.UIRole)){if(this._currRide=e,this.addShadow(),e==this._ride)return;this._ride=e,this.addRootBar()}},getIsRide:function(){return this._ride},getStateMachine:function(){return this._stateMachine},transition:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:null,n=2<arguments.length&&void 0!==a&&a;this._stateMachine.transition(e,i,n)},getStateRef:function(e){return this._stateMachine.getReference(e)},clearAnim:function(){this.clearFosterAnim(),this._headBar&&(this._headBar.setNickName(null),this._headBar.removeFromParent())},clearFosterAnim:function(){var e=this,t=game.AnimType;e.clearAnimByType(t.BODY),e.clearAnimByType(t.WEAPON),e.clearAnimByType(t.BUFF),e.clearAnimByType(t.PET_FLY),e.clearAnimByType(t.BATTLE),e.clearAnimByType(t.AMBITION),e.clearAnimByType(t.MOUNT),e.clearAnimByType(t.WING),e.clearAnimByType(t.MOUNT_HEAD),e.clearAnimByType(t.JUNZHEN)},clearAnimByType:function(e){var t=this.getAnimator(e,1);t&&t.clear()},onAttachVisible:function(e,t){var a=void 0;switch(e){case game.AttachType.NICK_NAME:return this.addHeadBar(),void this._headBar.setNickNameAttachVisible(t);case game.AttachType.WING:a=(a=this.getAnimator(game.AnimType.WING,1))||this.addAnimator(game.AnimType.WING,1,-200),this._animAttachVisible[game.AnimType.WING]=t}a&&a.setAnimationActive(t)},getAnimAttachVisible:function(e){if(!this._animAttachVisible)return!0;var t=this._animAttachVisible[e];return null==t||t},showChat:function(e,t,a,i){var n=this;!n.data||!a||a<1||(n._speechBubble||(n._speechBubble=new game.SpeechBubble,n._speechBubble.setPosition(e,t)),!n._speechBubble.parent&&n._headBar&&(n._headBar.addChild(n._speechBubble),n._speechBubble.setLocalZOrder(10)),i?(n._speechBubble.setVisible(!0),n._speechBubble.setString(i),b8e.hasTimeout(n._hideChat,n)||b8e.setTimeout(n._hideChat,n,a)):(n._speechBubble.setVisible(!1),n.data.configId&&game.MonsterCfg.getDataAsync(n.data.configId,function(e){!e||!e.content||""===e.content||e.chatTime<1||(n._speechBubble.setVisible(!0),n._speechBubble.setString(e.content),b8e.hasTimeout(n._hideChat,n)||b8e.setTimeout(n._hideChat,n,e.chatTime))},n)))},_hideChat:function(){this._speechBubble&&this._speechBubble.setVisible(!1)},getHeadOffsetY:function(){return this._headBar?this._headBar.getHeadOffsetY():0},showEffect:function(e){var t=this;e&&(t._effect||(t._effect=b8e.Animator.get(game.AnimType.UI_EFFECT,1),t.addChild(t._effect),t._effect.addFinishCallback(t._onEffectFinish,t)),t._effect.load(e),t._effect.active=!0,t._effect.play(null,0))},_onEffectFinish:function(){this._effect.active=!1},reset:function(){this._headBar&&this._headBar.reset(),this._rootBar&&this._rootBar.reset(),this.hideShadow(),this._ride=!1,this._currRide=!1,this._animAttachVisible={},this.queueIdx=-1},restore:function(e,t){this._super(e,t)},recycle:function(){var e=this;e._stateMachine&&e._stateMachine.clear(),e.clearAnim(),e._bodyAnim&&(e._headBar&&e._bodyAnim.removeBindNodeChild(e._headBar),!e._ride&&e._shadow&&e._bodyAnim.removeBindNodeChild(e._shadow),e._bodyAnim=null),e._mountAnim&&e._shadow&&(e._mountAnim.removeBindNodeChild(e._shadow),e._mountAnim=null),e._effect&&e._effect.clear(),e.data=null,e.reset(),e._super();var t=game.AttachType;e.attachLimitable=[t.NICK_NAME,t.WING]},release:function(){this.constructor===s?s.put(this):this.destroy()},dispose:function(){var e=this;e._headBar&&(e._headBar.release(),e._headBar=null),e._rootBar&&(e._rootBar.release(),e._rootBar=null),e._shadow&&(e._shadow.release(),e._shadow=null),e._effect&&e._effect.clear(),e._super()},destroy:function(){this.constructor===s&&(s.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this._super()}}),a=new b8e.Pool(s,1024);s.get=function(e,t){return a.get(e,t)},s.put=function(e){return a.put(e)},b8e.RC("$$game","$$BaseRole",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_create:function(e,t,a){if(!e)return!1;var i=game.SkillCfg.getData(e);if(!i)return!1;var n=this,s="",o=n._bgLayer;o||((o=n._bgLayer=b8e.Sprite.get()).setAnchor(.5,.5),o.setStyle(b8e.SpriteStyle.SLICED),o.scale9Inset={top:1,bottom:1,left:1,right:1},s=game.ResCfg.getUrl(10138,"bg"),o.loadTexture(s),n.addChild(o)),o.setVisible(!1);var r=n._lightningEffect;r||((r=n._lightningEffect=b8e.Animator.get(game.AnimType.EFFECT,1001)).setScale(4,3.3),n.addChild(r)),s=game.ResCfg.getUrl(5001,995),r.load(s);var g=n._leftHeadIcon;g||((g=n._leftHeadIcon=new game.HeadIcon(game.IconSizeEnum.GRID_SIZE_105)).setPosition(-160,0),n.addChild(g)),n._setHeadIcon(g,t.data),g.setVisible(!1);var l=n._rightHeadIcon;l||((l=n._rightHeadIcon=new game.HeadIcon(game.IconSizeEnum.GRID_SIZE_105)).setPosition(200,2),n.addChild(l)),n._setHeadIcon(l,a.data),l.setVisible(!1);var c=n._headEffect;c||((c=n._headEffect=b8e.Animator.get(game.AnimType.EFFECT,1e3)).setScale(2,2),n.addChild(c)),s=game.ResCfg.getUrl(5001,994),c.load(s);var h=n._skillName;if(h||((h=n._skillName=b8e.Sprite.get()).setAnchor(.5,.5),h.setPosition(20,0),n.addChild(h)),i.effectName&&(s=game.ResCfg.getUrl(10138,i.effectName),h.loadTexture(s),h.setVisible(!1)),n.setSize(720,1280),n.setVisible(!1),!n.parent){var m=b8e.layer.getGuiBottomLayer();m&&(n.setAnchor(.5,.5),n.setLocalZOrder(game.GameViewMgr.HomeViewIndex-1),m.addChild(n))}return!0},_setHeadIcon:function(a,e){if(a&&e){var t=e.configId,i=e.type,n=e.isMale,s=0,o=0,r=null;if(i==game.RoleType.Monster)game.MonsterCfg.getDataAsync(t,function(e){if(e){var t=game.ResCfg.getUrl(72,e.nameIcon);a.setBgImage("84_"+s),a.setIcon(t)}},this);else if(i==game.RoleType.Hero){var g=game.partnerData.getInfoById(1);s=g?g.quality:3,r=game.ResCfg.getHead(n)}else{var l=game.PartnerCfg.getData(t);l&&(s=l.quality,o=l.icon),r=game.ResCfg.getUrl(72,o)}return e.heroModel&&e.heroModel.surface&&e.heroModel.surface.roleQuality&&(s=e.heroModel.surface.roleQuality),r&&(a.setBgImage("84_"+s),a.setIcon(r)),a}},play:function(e,t,a,i){if(!t||!a)return 0;var n=this;if(n.speedRatio=.7*i,!n._create(e,t,a))return 0;var s=n._bgLayer,o=b8e.layer.getGuiLayer();o&&(n.setPosition(o.width>>1,100+(o.height>>1)),s.setSize(o.width,300)),n.setVisible(!0);var r=n._lightningEffect,g=n._headEffect,l=n._skillName,c=n._leftHeadIcon,h=n._rightHeadIcon;n._setBgShow(),b8e.Tween.kill(l),b8e.Tween.get(l).wait(280/i).call(n._setSkillNameShow,n),b8e.Tween.kill(c),b8e.Tween.get(c).wait(440/i).call(n._setHeadShow,n,[c]),b8e.Tween.kill(h),b8e.Tween.get(h).wait(440/i).call(n._setHeadShow,n,[h]),r.play(null,0),g.play(null,0);var m=1e3/i;return b8e.Tween.kill(n),b8e.Tween.get(n).wait(m).call(n._playFinished,n),m},_setBgShow:function(){var e=this._bgLayer;if(e){var t=this.speedRatio;e.setAlpha(0),e.setVisible(!0),b8e.Tween.kill(e),b8e.Tween.get(e).to({alpha:1},120/t).wait(700/t).to({alpha:0},200/t)}},_setSkillNameShow:function(){var e=this._skillName;if(e){var t=this.speedRatio;e.setAlpha(.5),e.setScale(1.4,1.4),e.setVisible(!0),b8e.Tween.kill(e),b8e.Tween.get(e).to({alpha:1,scaleX:.8,scaleY:.8},160/t).wait(600/t).to({alpha:0},200/t)}},_setHeadShow:function(e){if(e){var t=this.speedRatio;e.setAlpha(1),e.setVisible(!0),b8e.Tween.kill(e),b8e.Tween.get(e).wait(600/t).to({alpha:0},200/t)}},_playFinished:function(){this.setVisible(!1)}});b8e.RC("$$game","$$CombineEffect",e)}(),function(){var e,t=e=b8e.SceneEntity.extends({ctor:function(){this.constructor===t&&(t.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),65535<=t.effectId&&(t.effectId=0),this._super(game.RoleType.SceneEffect,++t.effectId),this.addAnimator(game.AnimType.EFFECT,1)},play:function(e,t,a,i,n,s){var o=2<arguments.length&&void 0!==a?a:1,r=3<arguments.length&&void 0!==i&&i,g=4<arguments.length&&void 0!==n?n:0,l=!(5<arguments.length&&void 0!==s)||s,c=this;if(e){var h=c.getAnimator(game.AnimType.EFFECT,1);return(h=h||c.addAnimator(game.AnimType.EFFECT,1,10)).setSpeedRatio(o),r||c.setFaceRadian(t),h.load(e),0==g?(c.setVisible(!0),h.play()):(h.stop(),b8e.Tween.get(c).wait(g/o).call(c._playCall)),l&&(c.animAutoRelease(game.AnimType.EFFECT,1),h.addFinishCallback(c._playFinished,c),b8e.hasTimeout(c._playFinished,c)||(c._delTimeout=b8e.setTimeout(c._playFinished,c,g+h.getDuration()+2e3))),h.getDuration()}b8e.warn("\u64ad\u653e\u4e0d\u80fd\u6ca1\u6709\u8d44\u6e90\u8def\u5f84\u548c\u4f4d\u7f6e")},_playFinished:function(){b8e.Tween.kill(this),this._delTimeout&&(b8e.clearTimeout(this._delTimeout),this._delTimeout=null),this.removeAllChildren(),this.removeFromParent(),this.clear(),this.usable&&this.release()},_playCall:function(){var e=this.getAnimator(game.AnimType.EFFECT,1);e&&(this.setVisible(!0),e.play())},clear:function(){var e=this.getAnimator(game.AnimType.EFFECT,1);e&&e.clear()},restore:function(){65535<=t.effectId&&(t.effectId=0),this._super(game.RoleType.SceneEffect,++t.effectId)},recycle:function(){b8e.Tween.kill(this),this._super()},release:function(){this.constructor===t?t.put(this):this.destroy()},dispose:function(){this.clear(),b8e.Tween.kill(this),this._super()},destroy:function(){this.constructor===t&&(t.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this.recycle(),this.dispose()}});t.effectId=1;var a=new b8e.Pool(t,1024);t.get=function(){return a.get()},t.put=function(e){return a.put(e)},b8e.RC("$$game","$$SceneEffect",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_create:function(e){if(!e)return!1;var t=game.SkillCfg.getData(e);if(!t)return!1;var a=this,i="",n=a._lightningEffect;n||((n=a._lightningEffect=b8e.Animator.get(game.AnimType.EFFECT,1001)).setScale(4,3.3),a.addChild(n)),i=game.ResCfg.getUrl(5001,1009),n.load(i);var s=t.combine;if(s&&!(s.length<1)){var o=a._petLayer;o||((o=a._petLayer=b8e.Sprite.get()).setAnchor(.5,.5),o.setPosition(-500,-50),o.setScale(3,3),a.addChild(o)),i=game.ResCfg.getUrl(305,s[0]),o.loadTexture(i),o.setVisible(!1);var r=a._skillName;if(r||((r=a._skillName=b8e.Sprite.get()).setAnchor(.5,.5),r.setPosition(100,0),a.addChild(r)),t.effectName&&(i=game.ResCfg.getUrl(10138,t.effectName),r.loadTexture(i),r.setVisible(!1)),a.setSize(720,1280),a.setVisible(!1),!a.parent){var g=b8e.layer.getGuiBottomLayer();g&&(a.setAnchor(.5,.5),a.setLocalZOrder(game.GameViewMgr.HomeViewIndex-1),g.addChild(a))}return!0}},play:function(e,t){var a=this;if(a.speedRatio=t,!a._create(e))return 0;var i=b8e.layer.getGuiLayer();i&&a.setPosition(i.width>>1,100+(i.height>>1)),a.setVisible(!0);var n=a._lightningEffect,s=a._skillName,o=a._petLayer;b8e.Tween.kill(s),b8e.Tween.get(s).wait(280/t).call(a._setSkillNameShow,a),b8e.Tween.kill(o),b8e.Tween.get(o).wait(280/t).call(a._setPetShow,a),n.play(null,0);var r=1e3/t;return b8e.Tween.kill(a),b8e.Tween.get(a).wait(r).call(a._playFinished,a),r},_setSkillNameShow:function(){var e=this._skillName;if(e){var t=this.speedRatio;e.setAlpha(.5),e.setScale(1.4,1.4),e.setVisible(!0),b8e.Tween.kill(e),b8e.Tween.get(e).to({alpha:1,scaleX:.8,scaleY:.8},160/t).wait(600/t).to({alpha:0},200/t)}},_setPetShow:function(){var e=this._petLayer;if(e){var t=this.speedRatio;e.setVisible(!0),b8e.Tween.kill(e),b8e.Tween.get(e).to({x:-200,scaleX:1,scaleY:1},200/t).wait(600/t).to({x:-500,scaleX:3,scaleY:3},200/t)}},_playFinished:function(){this.setVisible(!1)}});b8e.RC("$$game","$$GodAnimalEffect",e)}(),function(){var e,i=e=game.BaseRole.extends({ctor:function(e,t){var a=this;a.constructor===i&&(i.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(e,t),a.lazyPoolDisabled=!0},onHierarchyVisible:function(e){if(this._super(e),e)this.addShadow();else;},setFollowTarget:function(e,t){this._control=game.FollowControl.get(this,e,t)},setFollowPos:function(e){this.followPos=e},getControl:function(){return this._control},removeFollowControl:function(){if(this._control){this._control.release(),this._control=null}},restore:function(e,t){this._super(e,t)},recycle:function(){this.removeFollowControl(),this.data&&this.data.release&&this.data.release(),this._super()},release:function(){this.constructor===i?i.put(this):this.destroy()},destroy:function(){this.constructor===i&&(i.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this._super()}}),a=new b8e.Pool(i,1024);i.get=function(e,t){return a.get(e,t)},i.put=function(e){return a.put(e)},b8e.RC("$$game","$$Follower",e)}(),function(){var e;(e=b8e.BaseDisplay.extends({_hpBar:null,_nickName:null,_mpBar:null,_element:null,ctor:function(){this._super()},setHpBarVisible:function(e){var t=this;e&&(t._hpBar||(t._hpBar=new game.HpBar,t.addChild(t._hpBar))),t._hpBar&&t._hpBar.parent&&t._hpBar.setVisible(e)},setHpBar:function(e){this._hpBar&&e&&this._hpBar.setHpBar(e)},setNickName:function(e){e&&""!=e?(this.addNickName(),this._nickNameUrl=e,this._nickName.load(e),this._nickName.play()):this._nickName&&this._nickName.parent&&(this._nickName.clear(),this.rmvNickName())},addNickName:function(){this._nickName&&this._nickName.parent||(this._nickName||(this._nickName=b8e.Animator.get(),this._nickName.setAnchor(.5,0),this._nickName.setPosition(0,25)),this._nickName.parent||this.addChild(this._nickName))},rmvNickName:function(){this._nickName&&this._nickName.parent&&(this._nickName.removeFromParent(),this._nickNameUrl=null)},setNickNameAttachVisible:function(e){this.addNickName(),this._nickName.setAnimationActive(e)},setMpBarVisible:function(e){e&&(this._mpBar||(this._mpBar=new game.MpBar,this.addChild(this._mpBar))),this._mpBar&&this._mpBar.setVisible(e)},setMpBar:function(e){this._mpBar&&e&&(this._mpBar.setMaxMp(e.maxMp),this._mpBar.setMp(e.mp))},updateBarPosition:function(){var e=15,t=0;this._hpBar&&this._hpBar.getVisible()&&(e=this._hpBar.y+50,t=this._hpBar.x),this._nickName&&this._nickName.parent&&this._nickName.setPosition(t,e)},setElement:function(e){var t=this._element;t||((t=this._element=b8e.Sprite.get()).setPosition(-58,-5),this.addChild(t));var a=game.ResCfg.getUrl(6e3,e);t.loadTexture(a)},setElementVisible:function(e){this._element&&this._element.setVisible(e)},getHeadOffsetY:function(){var e=0;return this._hpBar&&this._hpBar.getVisible()&&(e=this._hpBar.y+50,posX=this._hpBar.x),this._nickName&&this._nickName.parent?e+50:0},reset:function(){this._hpBar&&this._hpBar.reset(),this._nickName&&this._nickName.clear(),this._mpBar&&this._mpBar.clear(),this._element&&this._element.unloadTexture()}})).poolCall=!0,b8e.RC("$$game","$$HeadBar",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_lab:null,_bg:null,ctor:function(){this._super(),this.init()},init:function(){var e=this;e._bg=b8e.Sprite.get(),e._bg.setAnchor(.5,.5),e._bg.loadTexture(game.ResCfg.getUrl(4)),e.addChild(e._bg),e._lab=b8e.Label.get(),e._lab.setFontSize(16),e._lab.setFontFile(game.ResCfg.getUrl(4302)),e._lab.setAnchor(0,.5),e._lab.setPosition(20,-5),e.addChild(e._lab)},setVisible:function(e){this._lab.setVisible(e),this._bg.setVisible(e)},setText:function(e){this._lab.setText(e)},dispose:function(){this._bg&&(this._bg.release(),this._bg=null),this._lab&&(this._lab.release(),this._lab=null),this._super()}}),b8e.RC("$$game","$$KillBar",e)}(),function(){var e;(e=b8e.BaseDisplay.extends({hpBar:null,hpBarBg:null,maxHpBarWidth:80,bgWidth:96,ctor:function(){this._super(),this.init()},init:function(){var e=this;e.hpBarBg||(e.hpBarBg=b8e.Sprite.get(),e.hpBarBg.setAnchor(0,0),e.hpBarBg.setPosition(-e.bgWidth>>1,0)),e.hpBarBg.loadTexture(game.ResCfg.getUrl(2)),e.addChild(e.hpBarBg),e.hpBar||(e.hpBar=b8e.Sprite.get(),e.hpBar.setAnchor(0,1)),e.hpBar.loadTexture(game.ResCfg.getUrl(1)),e.hpBarBg.addChild(e.hpBar),e.hpBar.setPosition(12,18)},setHpBar:function(e){if(this.hpBar)if(e.maxHp<=0)this.setVisible(!1);else{this.setVisible(!0);var t=e.hp/e.maxHp;if(0<t){var a=t*this.maxHpBarWidth;this.hpBar.setSize(a,8),this.hpBar.setVisible(!0)}else this.hpBar.setVisible(!1)}},reset:function(){this.hpBar&&(this.hpBar.width=this.maxHpBarWidth,this.hpBar.setVisible(!0)),this.setVisible(!0)}})).poolCall=!0,b8e.RC("$$game","$$HpBar",e)}(),function(){var e;(e=b8e.BaseDisplay.extends({_mpWidth:16,_space:2,_maxMp:0,_maxShow:4,_bgWidth:96,_effect:null,setMaxMp:function(e){var t=this;if(t._maxMp!=e){var a=e>t._maxShow?t._maxShow:e,i=t._mpSprites;i=i||(t._mpSprites=[]);for(var n=void 0,s=14,o=0;o<a;o++)(n=b8e.Sprite.get()).setAnchor(0,0),o+1==a?n.loadTexture(game.ResCfg.getUrl(5081)):n.loadTexture(game.ResCfg.getUrl(5080)),n.setVisible(!1),n.setPosition(s,2),t.addChild(n),i.push(n),s=s+t._mpWidth+t._space;t.numLab||(t.numLab=b8e.Label.get(),t.numLab.setAnchor(0,.5),t.numLab.setFontSize(20),t.numLab.setColor(game.Color.WHITE),t.numLab.setPosition(100,10),t.numLab.setVisible(!0),t.addChild(t.numLab)),this._maxMp=e,t.setAnchor(0,0),t.setPosition(-t._bgWidth>>1,0)}},setMp:function(e){var t=this,a=t._mpSprites;if(a){for(var i=0;i<a.length;i++)a[i].setVisible(i+1<=e);if(t.numLab&&(e>t._maxShow?(t.numLab.setText("x"+e),t.numLab.setVisible(!0)):t.numLab.setVisible(!1)),e>=t._maxShow){var n=t._effect;if(!n){var s=game.ResCfg.getUrl(5019,1093);(n=t._effect=b8e.Animator.get(game.AnimType.EFFECT,1)).setPosition(54,5),t.addChild(n),n.setLocalZOrder(5),n.load(s),n.play()}n.setVisible(!0)}else t._effect&&t._effect.setVisible(!1)}},clear:function(){var e=this;e._clearSprites(e._mpSprites),e._maxMp=0,e.numLab&&(e.numLab.removeFromParent(),e.numLab.release(),e.numLab=null),e._effect&&(e._effect.clear(),e._effect.removeFromParent(),e._effect=null)},_clearSprites:function(e){if(Array.isArray(e)){for(var t=0,a=e.length;t<a;t++)e[t]&&e[t].usable&&e[t].release();e.length=0}}})).poolCall=!0,b8e.RC("$$game","$$MpBar",e)}(),function(){var e,n=e=game.BaseRole.extends({ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:void 0,i=1<arguments.length&&void 0!==t?t:void 0;this.constructor===n&&(n.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(a,i),this.lazyPoolDisabled=!0},onHierarchyVisible:function(e){var t=this;if(e){t.addShadow();var a=game.RoleType;switch(t.data.type){case a.Partner:case a.Hero:t.addHeadBar(),t._headBar.setHpBarVisible(!0),t._headBar.setMpBarVisible(!0),t.addRootBar(),t.updateName(),t._rootBar.setNameVisible(!0),t.updateBarPos(),t.showShadow(),t.updateElement(),t.updataStar(),t._headBar.setElementVisible(!0);break;case a.Monster:t.addHeadBar(),t._headBar.setHpBarVisible(!0),t._headBar.setMpBarVisible(!0),t.addRootBar(),t.updateName(),t._rootBar.setNameVisible(!0),t.showShadow(),t.updateElement(),t.updataStar(),t._headBar.setElementVisible(!0);break;case a.Shenhun:t._headBar&&(t._headBar.removeFromParent(),t._headBar=null);break;default:t.addHeadBar(),t._headBar.setHpBarVisible(!0),t._headBar.setMpBarVisible(!0),t._headBar.setElementVisible(!0),t.showShadow()}}},updateName:function(e){if(!e){var t=this.data;if(t)switch(t.type){case game.RoleType.Hero:var a=game.partnerData.getInfoById(1);e=a?a.quality:0;break;case game.RoleType.Partner:var i=game.PartnerCfg.getData(t.configId);e=i?i.quality:0;break;case game.RoleType.Monster:e=this.data.quality}}this._super(e)},updateElement:function(){var e=0,t=this.data,a=null;if(t)switch(t.type){case game.RoleType.Hero:a=game.PartnerCfg.getData(1);break;case game.RoleType.Partner:a=game.PartnerCfg.getData(t.configId);break;case game.RoleType.Monster:return void game.MonsterCfg.getDataAsync(t.configId,function(e){this._headBar.setElement(e.element)},this)}a&&(e=a.element),this._headBar.setElement(e)},updateNameColor:function(){},updateNameIcon:function(){var e=0;e=this.updataMilitary(e)},updataStar:function(){var e=this;e._starIcon||(e._starIcon=b8e.Sprite.get(),e._starIcon.setAnchor(1,.5),e._starIcon.setSize(28,26),e._starIcon.loadTexture(game.ResCfg.getUrl(259)),e._starLab=b8e.Label.get(),e._starLab.setFontSize(18),e._starLab.setLineHeight(20),e._starLab.setColor(game.Color.BLACK),e._starLab.setAnchor(.5,.5),e._starLab.setPosition(-14,-2),e._starIcon.addChild(e._starLab)),e._starIcon.parent||e._rootBar.addChild(e._starIcon),e._starIcon.setVisible(e.data.type==game.RoleType.Partner),e.data.type==game.RoleType.Partner&&(e._starIcon.setPosition(-e._rootBar._nameLab.width/2,2),e._starLab.string=e.data&&e.data.heroModel&&e.data.heroModel.surface&&e.data.heroModel.surface.starLv?e.data.heroModel.surface.starLv:0)},deathHideAllBar:function(){this._headBar&&(this._headBar.setHpBarVisible(!1),this._headBar.setMpBarVisible(!1),this._headBar.setElementVisible(!1)),this._rootBar&&this._rootBar.setNameVisible(!1),this._speechBubble&&this._speechBubble.setVisible(!1)},reliveShowAllBar:function(){this._headBar&&(this._headBar.setHpBarVisible(!0),this._headBar.setMpBarVisible(!1),this._headBar.setElementVisible(!1)),this._rootBar&&this._rootBar.setNameVisible(!0)},updataMilitary:function(e){var t=this,a=game.militaryData.militaryId,i=t.data.heroModel;if(i.surface){var n=i.surface.militaryRank;n&&(a=n)}var s=0;if(0<a&&t.data.name==game.mainRoleData.name){if(!t._iconImg){var o=t._rootBar.getWidthBg();t._iconImg=b8e.Sprite.get(),t._iconImg.setAnchor(0,.5),t._iconImg.setPosition(0+o/2+e,-33)}t._iconImg.parent||t.addChild(t._iconImg);var r=game.militaryData.getInfoById(a),g=game.ResCfg.getUrl(147,r.icon);t._iconImg.loadTexture(g),s=t._iconImg.width}return s+=e},restore:function(e,t){this._super(e,t)},recycle:function(){this.deathHideAllBar(),this.data&&this.data.release&&this.data.release(),this.transModel&&(this.transModel.release(),this.transModel=null),this._super()},release:function(){this.constructor!==n||this.isRecycled?this.destroy():n.put(this)},dispose:function(){this._iconImg&&(this._iconImg.unloadTexture(),this._iconImg.removeFromParent(),this._iconImg=null),this._super()},destroy:function(){this.constructor===n&&(n.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this._super()}}),a=new b8e.Pool(n,128);n.get=function(e,t){return a.get(e,t)},n.put=function(e){return a.put(e)},b8e.RC("$$game","$$PlayBackRole",e)}(),function(){var e;(e=b8e.BaseDisplay.extends({_nameLab:null,_nameBg:null,ctor:function(){this._super(),this.init()},init:function(){var e=this;e._nameBg||(e._nameBg=b8e.Sprite.get(),e._nameBg.setAnchor(.5,.5),e.addChild(e._nameBg)),e._nameBg.loadTexture(game.ResCfg.getUrl(3)),e._nameLab||(e._nameLab=b8e.RichText.get(),e._nameLab.setAnchor(0,1),e._nameLab.setFontSize(18),e.addChild(e._nameLab))},setNameVisible:function(e){this._nameLab&&this._nameLab.setVisible(e),this._nameBg&&this._nameBg.setVisible(e)},setNameColor:function(){},setNameText:function(e){if(this._nameLab){this._nameLab.setText(e);var t=-.5*this._nameLab.width,a=.5*this._nameLab.height+1;this._nameLab.setPosition(t,a)}if(this._nameBg){var i=this._nameLab.width+4,n=this._nameLab.fontSize+4;this._nameBg.setSize(i+20,n)}},setNameSize:function(e){this._nameLab&&this._nameLab.setFontSize(e)},getWidthBg:function(){return this._nameBg?this._nameBg.width:0},reset:function(){this._nameLab&&(this._nameLab.setText(""),this._nameLab.setAnchor(0,1),this._nameLab.setFontSize(18)),this._nameBg&&this._nameBg.setSize(0,0)}})).poolCall=!0,b8e.RC("$$game","$$RootBar",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_nameLab:null,_nameBg:null,_campIcon:null,ctor:function(){this._super(),this.init()},init:function(){var e=this;e._nameBg||(e._nameBg=b8e.Sprite.get(),e._nameBg.setAnchor(.5,.5),e._nameBg.loadTexture(game.ResCfg.getUrl(41)),e.addChild(e._nameBg)),e._nameLab||(e._nameLab=b8e.Label.get(),e._nameLab.setAnchor(.5,.5),e._nameLab.setFontSize(34),e.addChild(e._nameLab),e._nameLab.isBold(!0),e._nameLab.lineHeight=40,e._nameLab.setScale(.5,.5),e._nameLab.setText(game.Lang.get(9453)));var t=e._nameLab.width+4,a=e._nameLab.fontSize+4;e._nameBg.setSize(t,a),e._campIcon||(e._campIcon=b8e.Sprite.get(),e._campIcon.setAnchor(.5,.5),e._campIcon.setPosition(-50,0),e._campIcon.loadTexture(game.ResCfg.getUrl(44)),e.addChild(e._campIcon))},updataBar:function(e){var t=this,a=e.data;if(a&&a.type==game.RoleType.Tower){if(a.roleId==game.GuanDuTowerType.Fight)t._nameLab.setText(game.Lang.get(9454)),t.setPosition(-100,0);else if(a.roleId==game.GuanDuTowerType.Blood)t._nameLab.setText(game.Lang.get(9455)),t.setPosition(-100,0);else if(a.roleId==game.GuanDuTowerType.Flag)t._nameLab.setText(game.Lang.get(9456)),t.setPosition(0,0);else if(a.roleId==game.GuanDuTowerType.YuXi){var i=game.SceneUnitCfg.getData(a.roleId);i&&(t._nameLab.setText(i.name),t.setPosition(0,80))}if(0==a.master)t._campIcon.loadTexture(game.ResCfg.getUrl(44));else{var n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,a.master);n&&(11==n.data.campId?t._campIcon.loadTexture(game.ResCfg.getUrl(42)):12==n.data.campId&&t._campIcon.loadTexture(game.ResCfg.getUrl(43)))}}}}),b8e.RC("$$game","$$towerBar",e)}(),function(){var e,n=e=game.BaseRole.extends({_aiState:null,_guildBar:null,ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:void 0,i=1<arguments.length&&void 0!==t?t:void 0;this.constructor===n&&(n.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(a,i),this.lazyPoolDisabled=!0},onHierarchyVisible:function(e){var t=this;if(t._super(e),e)switch(t.data.type){case game.RoleType.Hero:t.addShadow(),t.addRootBar(),t._rootBar&&t._rootBar.setNameVisible(!0),t.updateName(),t.isShowGuildName&&t.addGuildBar(),t._guildBar&&t._guildBar.setNameVisible(!0),t.updateGuildName(),t.updateNameIcon();break;case game.RoleType.CsArrow:case game.RoleType.Npc:t.addRootBar(),t._rootBar.setNameVisible(!0),t.updateName(),t.isShowGuildName&&t.addGuildBar(),t._guildBar&&t._guildBar.setNameVisible(!0);break;case game.RoleType.Monster:t.addShadow();break;case game.RoleType.Partner:t.addShadow()}},updateName:function(){var e=3;if(this.data.type==game.RoleType.Hero){var t=game.partnerData.getInfoById(1);e=t?t.quality:0}this._super(e)},updateNameIcon:function(){var e=0;e=this.updataMilitary(e)},onDefaultVisibleState:function(){this._super(),this._guildBar&&this._guildBar.setNameVisible(!1)},setFollowTarget:function(e,t){this._control=game.FollowControl.get(this,e,t)},getControl:function(){return this._control},addGuildBar:function(){this._guildBar||(this._guildBar=new game.RootBar,this._guildBar.setLocalZOrder(50),this._guildBar.setPosition(0,-55)),this._guildBar.parent||this.addChild(this._guildBar)},updateGuildName:function(){this.addGuildBar(),this.isShowGuildName?(this._guildBar.setNameText(this.data.guildName),this._guildBar.setVisible(!0)):this._guildBar.setVisible(!1)},setKill:function(e){this._killBar||this.addKillBar();var t=0<e;this._killBar.setVisible(t),t&&this._killBar.setText(e)},addKillBar:function(){var e=this;e._killBar||(e._killBar=new game.KillBar),e._bodyAnim=e.getAnimator(game.AnimType.BODY,1),e._bodyAnim||(e._bodyAnim=e.addAnimator(game.AnimType.BODY,1,10)),e._bodyAnim.addChildToBindNode(e._killBar,"buff",50),e._killBar.y=20},rmvKillBar:function(){this._killBar&&(this._killBar.release(),this._killBar=null)},updataMilitary:function(e){var t=0<arguments.length&&void 0!==e?e:0,a=this,i=game.militaryData.militaryId,n=a.data.heroModel;n.surface&&(i=n.surface.militaryRank);var s=0;if(0<i&&a.data.name){if(!a._iconImg){var o=a._rootBar.getWidthBg();a._iconImg=b8e.Sprite.get(),a._iconImg.setAnchor(1,.5),a._iconImg.setPosition(0-o/2-t,-33),a.addChild(a._iconImg)}var r=game.militaryData.getInfoById(i),g=game.ResCfg.getUrl(147,r.icon);a._iconImg.loadTexture(g),s=a._iconImg.width}return s+=t},isShowGuildName:{get:function(){return this.data&&this.data.isShowGuildName&&this.data.guildName&&""!=this.data.guildName}},getAiStateMachine:function(){return this._aiState||(this._aiState=new game.AiStateMachine(this)),this._aiState},setFollowPos:function(e){this.followPos=e},runAi:function(){this.getAiStateMachine().start()},stopAi:function(){this.getAiStateMachine().stop()},reset:function(){this._super(),this._guildBar&&this._guildBar.reset(),this.stopAi()},removeFollowControl:function(){if(this._control){this._control.release(),this._control=null}},clearAiState:function(){this._aiState&&this._aiState.stop()},restore:function(e,t){this._super(e,t)},recycle:function(){var e=this;e.stopAi(),e.removeFollowControl(),e.data&&e.data.release&&e.data.release(),e._bodyAnim&&e._killBar&&(e._bodyAnim.removeBindNodeChild(e._killBar),e._bodyAnim=null),e.reset(),e._super()},release:function(){this.constructor===n?(this.clearAiState(),n.put(this)):this.destroy()},dispose:function(){var e=this;e._control&&(e._control.release(),e._control=null),e._guildBar&&(e._guildBar.release(),e._guildBar=null),e._iconImg&&(e._iconImg.release(),e._iconImg=null),e.rmvKillBar(),e._super()},destroy:function(){this.constructor===n&&(n.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this._super()}}),a=new b8e.Pool(n,1024);n.get=function(e,t){return a.get(e,t)},n.put=function(e){return a.put(e)},b8e.RC("$$game","$$SceneRole",e)}(),function(){var e;(e=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_IDLE)},execute:function(){this._machine&&this._machine.usable&&(this._super(),this.transition(game.RoleStateType.CONTROL_STOP_WALK_MOVE),this.syncAnimation(!1,-1))},beforeExecute:function(e){this._machine&&this._machine.usable&&this._super(e)},playAnimation:function(e,t,a,i,n){this._super(e,t,a,i);var s=game.RoleActionType.IDLE;switch(t.type){case game.AnimType.BODY:case game.AnimType.WEAPON:e.getIsRide()&&(s=game.RoleActionType.RIDE_IDLE)}t.play(s,i,n),a&&t.stop(i);var o=e.getAnimAttachVisible(t.type);t.setAnimationActive(o)},leavePass:function(e,t){return!0},enterPass:function(e,t){return!!(1<arguments.length&&void 0!==t&&t)||!this._machine.isDeathFly()}})).poolCall=!0,b8e.RC("$$game","$$IdleState",e)}(),function(){var e;(e=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_WALK)},execute:function(){var e=this;if(e._machine&&e._machine.usable)if(e._super(),e._ref instanceof game.WalkStateReference){e.syncAnimation(!1,-1);var t=e.getReference(game.WalkMoveStateReference);e.setSpeedRatio(1),t.setParams(e._ref.target,e._ref.spacing,e._ref.speed,e._ref.findPath),t.setPath(e._ref.path),e._ref.arriveCb?(t.onArrive(e._ref.arriveCb.func,e._ref.arriveCb.thisArg,e._ref.arriveCb.args),t.onUnable(e._ref.arriveCb.func,e._ref.arriveCb.thisArg,e._ref.arriveCb.args)):(t.onArrive(null),t.onUnable(null)),e.transition(game.RoleStateType.CONTROL_WALK_MOVE,t)}else e.syncAnimation(!1,-1)},leave:function(){this._super(),this.transition(game.RoleStateType.CONTROL_STOP_WALK_MOVE)},afterEnter:function(){this._super()},afterExecute:function(){this._super()},playAnimation:function(e,t,a,i,n){this._super(e,t,a,i);var s=game.RoleActionType.WALK;switch(t.type){case game.AnimType.WEAPON:case game.AnimType.BODY:e.getIsRide()&&(s=game.RoleActionType.RIDE_WALK);break;case game.AnimType.WEAPON:s=game.RoleActionType.IDLE}t._actionName!=s&&t.play(s,i,n),a&&t.stop(i);var o=e.getAnimAttachVisible(t.type);t.setAnimationActive(o)},setAnimationSpeed:function(e,t,a){switch(this._super(e,t,a),t.type){case game.AnimType.BODY:t.setSpeedRatio(a)}},enterPass:function(e,t){return!0},leavePass:function(e,t){return!0},clear:function(){this._super()}})).poolCall=!0,b8e.RC("$$game","$$WalkState",e)}(),function(){var e;e=b8e.ControlState.extends({ctor:function(e){this._super(e)},tribe:{get:function(){return"MoveState"}},roleX:{get:function(){if(this._machine&&this._machine.owner){return this._machine.owner.x}return 0},set:function(e){if(this._machine&&this._machine.owner){this._machine.owner.x=e}}},roleY:{get:function(){if(this._machine&&this._machine.owner){return this._machine.owner.y}return 0},set:function(e){if(this._machine&&this._machine.owner){this._machine.owner.y=e}}}}),b8e.RC("$$game","$$MoveState",e)}(),function(){var e;(e=b8e.ActionState.extends({speedRatio:1,actionType:null,_totalTween:null,_startFrameTime:0,ctor:function(){this._super(game.RoleStateType.ACTION_ATTACK)},execute:function(){var e=this;if(e._machine&&e._machine.usable){if(e._super(),!(e._ref instanceof game.AttackStateReference))throw new Error("\u653b\u51fb\u72b6\u6001\u5f15\u7528\u5fc5\u987b\u662fAttackStateReference\u7c7b\u578b\uff01");e.setSpeedRatio(e._ref.speedRatio),e.actionType=e._ref.actionType,e.syncAnimation(!1,0);var t,a=e._machine.owner.getAnimator(game.AnimType.BODY,1);a=a||e._machine.owner.addAnimator(game.AnimType.BODY,1,10),e._startFrameTime=0,e.actionType&&(t=a?a.getDuration()-e._startFrameTime:0),e._totalTween&&(e._totalTween.kill(e),e._totalTween=null),0==t&&(t=500),0<t?e._totalTween=b8e.Tween.get(e).wait(t).call(e.onTotalFrameCmp,e):e.onTotalFrameCmp()}},playAnimation:function(e,t,a,i,n){var s;switch(this._super(e,t,a,i),t.type){case game.AnimType.WEAPON:case game.AnimType.BODY:case game.AnimType.MOUNT:case game.AnimType.MOUNT_HEAD:e.getIsRide()&&this.actionType&&(s=this.actionType+"AndRide"),!s&&this.actionType&&(s=this.actionType);break;default:s=game.RoleActionType.IDLE}t.play(s,i,n),a&&t.stop(i);var o=e.getAnimAttachVisible(t.type);t.setAnimationActive(o)},setAnimationSpeed:function(e,t,a){this._super(e,t,a),t.setSpeedRatio(a)},onTotalFrameCmp:function(){this._ref&&this._ref.total(),this.transition(game.RoleStateType.ACTION_IDLE),this._totalTween&&(this._totalTween.kill(this),this._totalTween=null)},enterPass:function(e,t){if(this._super(),e){if(e.type==game.RoleStateType.ACTION_DEATH)return!1;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!1}return!0},clear:function(){this.actionType=null,this.speedRatio=1,this._totalTween&&(this._totalTween.kill(this),this._totalTween=null)}})).poolCall=!0,b8e.RC("$$game","$$AttackState",e)}(),function(){var e;e=game.MoveState.extends({_movePos_1:null,_movePos_2:null,_movePos_3:null,ctor:function(){this._super(game.RoleStateType.ACTION_DEATH_FLY)},execute:function(){this._machine&&this._machine.usable&&this._super()},afterExecute:function(){var e=this;if(e._machine&&e._machine.usable){var t=e._machine.owner.data.posCfg;if(!t)return void e.clear();if(e.flyPos=t.deathFlyPos,!e.flyPos||0==e.flyPos)return void e.onRoleDied();e.flyIndex=0,e.startFly()}},startFly:function(){var e=this,t=e.flyPos[e.flyIndex];if(t){var a=e._machine.owner.getScene();if(a){e.flyIndex++;var i=game.playBackScene.getViewOffset(),n=t.X+i.x,s=-t.Y+i.y,o=a.sceneUIToGLPos(n,s);e._deathTween=b8e.Tween.get(e).to({roleX:o.x,roleY:o.y},150).call(e.startFly,e)}else e.onRoleDied()}else e.onRoleDied()},onRoleDied:function(){if(this._machine&&this._machine.usable){this.clear();var e=this._machine.owner.getScene();if(!e)return;e.removeDisplay(this._machine.owner)}},leave:function(){this.clear()},clear:function(){this._deathTween&&(this._deathTween.kill(this),this._deathTween=null)},leavePass:function(e,t){var a=1<arguments.length&&void 0!==t&&t;return e.type==game.RoleStateType.ACTION_IDLE||(e.type==game.RoleStateType.CONTROL_STOP_WALK_MOVE||e.type!=game.RoleStateType.ACTION_HIT&&!!a)}}),b8e.RC("$$game","$$DeathFlyState",e)}(),function(){var e;e=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_DEATH)},execute:function(){if(this._machine&&this._machine.usable){this._super(),this._ref instanceof game.DeathStateReference&&this.setSpeedRatio(this._ref.speedRatio),this.syncAnimation(!1,0);var e=this._machine.owner,t=e&&e.data&&e.data.type==game.RoleType.Hero,a=game.playBack.checkRespawn(e.data.id);this.isFly=2*Math.random()>>0==1&&!t&&!a}},afterExecute:function(){if(this._machine&&this._machine.usable){this._machine.owner;if(this.isFly){var e=this._ref;e&&e instanceof game.DeathStateReference&&e.isFight?(this.createDeathEffect(),this.transition(game.RoleStateType.ACTION_DEATH_FLY)):this.death()}else this.death()}},death:function(){var e=this;e._deathTween&&(e._deathTween.kill(e),e._deathTween=null),0==e._machine.owner.isSelf&&e._machine.owner.hideBar(),game.scenePick.target==e._machine.owner&&game.scenePick.pick(null),b8e.Tween.get(e).wait(100/e.speedRatio).call(e.diedAction,e)},diedAction:function(){this._deathTween&&(this._deathTween.kill(this),this._deathTween=null),this._machine&&this._machine.usable&&this.onRoleDied()},onRoleDied:function(){this._deathTween&&(this._deathTween.kill(this),this._deathTween=null),game.playBack.isFighting&&this.createDeathEffect()},createDeathEffect:function(){if(this._machine&&this._machine.usable){var e=this._machine.owner,t=e.getScene();if(t&&e.data){var a=e.getDirection();a=game.Direction.getDirection(a);var i=game.Direction.getRadian(a),n=game.ResCfg.getUrl(5001,998),s=e.getScenePosition(),o={x:s.x,y:s.y},r=e.data.isAttack?100+e.data.pos:200+e.data.pos;game.EffectUtil.playDeathEffect(r,e.getLocalZOrder(),t,n,o,i,this._ref.speedRatio,!1,0,!1);game.skillBuff.removeAllBuff(e),this.isFly||e.setVisible(!1)}}},clear:function(){this._deathTween&&(this._deathTween.kill(this),this._deathTween=null)},leavePass:function(e,t){var a=1<arguments.length&&void 0!==t&&t;return e.type==game.RoleStateType.ACTION_DEATH_FLY||(e.type==game.RoleStateType.ACTION_IDLE||(e.type==game.RoleStateType.CONTROL_STOP_WALK_MOVE||e.type!=game.RoleStateType.ACTION_HIT&&!!a))}}),b8e.RC("$$game","$$DeathState",e)}(),function(){var e;e=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_FLY)},leave:function(){this._super()},execute:function(){if(this._machine&&this._machine.usable){if(this._super(),!(this._ref instanceof game.FlyStateRefrence))throw new Error("\u884c\u8d70\u72b6\u6001\u5f15\u7528\u5fc5\u987b\u662fWalkStateReference\u7c7b\u578b\uff01");this.syncAnimation(!1,-1);var e=this.getReference(game.FlyMoveStateRefrence);if(e.setParams(this._ref.target,this._ref.speed),this._ref.arriveCb){e.onArrive(this._ref.arriveCb.func,this._ref.arriveCb.thisArg,this._ref.arriveCb.args)}else e.onArrive(null);this.transition(game.RoleStateType.CONTROL_FLY_MOVE,e)}},playAnimation:function(e,t,a,i,n){this._super(e,t,a,i);var s=game.RoleActionType.IDLE;switch(t.type){case game.AnimType.BODY:case game.AnimType.WEAPON:if(e.getIsRide()){s=game.RoleActionType.RIDE_IDLE}}t.play(s,i,n),a&&t.stop(i);var o=e.getAnimAttachVisible(t.type);t.setAnimationActive(o)}}),b8e.RC("$$game","$$FlyState",e)}(),function(){var e;e=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_HIT)},execute:function(){var e=this;if(e._machine&&e._machine.usable)if(e._super(),e._ref instanceof game.HitStateReference){e.setSpeedRatio(e._ref.speedRatio),e.syncAnimation(!1,0);var t=e.getReference(game.HitMoveStateReference);t.setParams(e._ref.speedRatio),e.transition(game.RoleStateType.CONTROL_HIT_MOVE,t)}else{e.syncAnimation(!1,0);var a=e._machine.owner.getAnimator(game.AnimType.BODY,1),i=500;a&&(i=a.getDuration()),e._totalTween=b8e.Tween.get(e).wait(i).call(e.onTotalFrameCmp,e)}},beforeExecute:function(e){this._machine&&this._machine.usable&&this._super(e)},afterEnter:function(){this._super()},afterExecute:function(){this._super()},playAnimation:function(e,t,a,i,n){if(!(e&&e.usable&&e.data.hp<1)){this._super(e,t,a,i);var s=game.RoleActionType.HIT;switch(t.type){case game.AnimType.BODY:case game.AnimType.WEAPON:e.getIsRide()&&(s=game.RoleActionType.RIDE_HIT),t.play(s,i,n),a&&t.stop(i);var o=e.getAnimAttachVisible(t.type);t.setAnimationActive(o)}}},onTotalFrameCmp:function(){var e=this._machine.owner;e&&e.data&&0<e.data.hp?this.transition(game.RoleStateType.ACTION_IDLE):this.switchDeathState(e),this._totalTween&&(this._totalTween.kill(this),this._totalTween=null)},switchDeathState:function(e){if(e){var t=this._ref?this._ref.speedRatio:1,a=e.getStateRef(game.DeathStateReference);a.setParams(t,!1),this.transition(game.RoleStateType.ACTION_DEATH,a)}},leavePass:function(e,t){var a=1<arguments.length&&void 0!==t&&t;return!((this._machine.isDeath()||this._machine.isDeathFly())&&!a)},enterPass:function(e,t){var a=1<arguments.length&&void 0!==t&&t;return!((this._machine.isDeath()||this._machine.isDeathFly())&&!a)},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$HitState",e)}(),function(){var e;e=game.MoveState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_FLY_MOVE)},execute:function(){if(this._super(),this._ref instanceof game.FlyMoveStateRefrence){if(!this._ref.target)return b8e.error("\u6ca1\u6709\u98de\u884c\u76ee\u6807\u70b9"),void this.arrive();this.flyToTarget()}else b8e.error("\u8be5\u72b6\u6001\u53c2\u6570\u5fc5\u987b\u4f20\u5165 game.FlyMoveStateRefrence")},arrive:function(){this._machine&&this._machine.usable&&(b8e.Tween.kill(this),this.transition(game.RoleStateType.ACTION_IDLE),this._ref.arrive())},flyToTarget:function(){var e=this;if(e._machine&&e._machine.usable){var t=e._ref.target,a=e._machine.owner.getScene(),i=e._machine.owner.getScenePosition(),n=b8e.MathUtil.getDistance(i.x,i.y,t.x,t.y)/e._ref.speed;if(0<n){if(!a)return;var s=a.sceneUIToGLPos(t.x,t.y);b8e.Tween.get(e).to({roleX:s.x,roleY:s.y},n).call(e.arrive,e)}else e._machine.owner.setScenePosition(t.x,t.y),e.arrive()}}}),b8e.RC("$$game","$$FlyMoveState",e)}(),function(){var e;e=game.MoveState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_STOP_WALK_MOVE)},execute:function(){this._super()},clear:function(){this._super()}}),b8e.RC("$$game","$$StopWalkMoveState",e)}(),function(){var e;e=game.MoveState.extends({_isMoving:!1,_moveMsg:null,_startPos:null,_lastPos:null,_nextPos:null,_endPos:null,_path:null,_pathEndPos:null,ctor:function(){this._super(game.RoleStateType.CONTROL_WALK_MOVE),this._isMoving=!1,this._nextPos=null,this._lastEndPos=null,this._lastPos=null,this._lastSpeed=0},enter:function(){this._machine&&this._machine.usable&&this._super()},execute:function(){var e=this;if(e._super(),e._ref instanceof game.WalkMoveStateReference){if(e._startPos={x:e._machine.owner.gridX,y:e._machine.owner.gridY},e._pathEndPos=e._ref.target,!e._pathEndPos)return b8e.error("\u884c\u8d70\u8def\u5f84\u4e3a\u7a7a"),void e.unable();e._ref.findPath?e.walkToPos():e._ref.path?e.walkByPath(e._ref.path):e.walkToTarget()}else b8e.error("\u8be5\u72b6\u6001\u53c2\u6570\u5fc5\u987b\u4f20\u5165 game.WalkMoveStateReference")},leave:function(){this._super(),this._machine&&this._machine.usable&&this.stopWalk()},unable:function(){this._machine&&this._machine.usable&&(this.transition(game.RoleStateType.ACTION_IDLE),this._ref.unable())},through:function(){this._ref&&this._ref.through()},arrive:function(){if(this._machine&&this._machine.usable){b8e.Tween.kill(this);var e=this._machine.owner;e&&e.followPos?e.followPos.x==this._pathEndPos.x&&e.followPos.y==this._pathEndPos.y&&(this.transition(game.RoleStateType.ACTION_IDLE),e.followPos=null):this.transition(game.RoleStateType.ACTION_IDLE),this._ref.arrive()}},stopWalk:function(){this._machine&&this._machine.usable&&(b8e.Tween.kill(this),this._ref&&(this._lastEndPos=null,this._lastSpeed=0,this._lastPos=null,this._isMoving=!1,this._pathEndPos=null))},walkToTarget:function(){var e=this._pathEndPos;this._path=[e],this._isMoving=!0,this.moveStep(this._path)},walkToPos:function(){var e=this;if(e._machine&&e._machine.usable){b8e.Tween.kill(e);var t=e._pathEndPos,a=e._machine.owner,i=a.getScene();if(!i)return;var n=a.getGridPosition(),s=i.findPath(n.x,n.y,t.x,t.y,!0);if(null==s||s.length<2)return a.faceToGrid(t.x,t.y),void e.unable();var o=[];if(s.forEach(function(e){o.push({x:e.x,y:e.y})},e),0<e._ref.spacing){var r=o[o.length-2],g=o[o.length-1],l=i.getPixelPosByGrid(r.x,r.y),c=i.getPixelPosByGrid(g.x,g.y),h=b8e.MathUtil.getDistance(l.x,l.y,c.x,c.y)-e._ref.spacing,m=0<h?b8e.MathUtil.getSpaceDistance(l.x,l.y,c.x,c.y,h):{x:l.x,y:l.y};m=i.getGridPosByPixel(m.x,m.y),g.x=m.x,g.y=m.y}e.walkByPath(o)}},isArriveTarget:function(){return!1},walkByPath:function(e){var t=this;if(t._machine&&t._machine.usable){if(t._isMoving=!0,t._startPos=e[0],t._endPos=e[e.length-1],t._path=e,t._lastPos=e.shift(),e.length<1)return void t.arrive();b8e.Tween.kill(t),t.startMoveStep(e)}},startMoveStep:function(e){this._machine&&this._machine.usable&&this.moveStep(e)},moveStep:function(e,t){var a=!(1<arguments.length&&void 0!==t)||t,i=this;if(i._machine&&i._machine.usable){if(!i._isMoving)return;if(b8e.Tween.kill(i),e&&0<e.length){var n,s=i._machine.owner.getScene();if(!s)return;if(i._nextPos=e.shift(),a){var o=s.getPixelPosByGrid(i._nextPos.x,i._nextPos.y);n={x:o.x,y:o.y}}else n=i._nextPos;var r=i._machine.owner.getScenePosition(),g=b8e.MathUtil.getDistance(r.x,r.y,n.x,n.y)/i._ref.speed;if(i._machine.owner.faceTo(n.x,n.y),i._ref.path=e,i._startPos=i._lastPos,i.syncSelf(),i._lastPos=i._nextPos,0<g){var l=s.sceneUIToGLPos(n.x,n.y);b8e.Tween.get(i).to({roleX:l.x,roleY:l.y},g).call(i.moveStep,i,[e,a])}else i._machine.owner.setScenePosition(n.x,n.y),i.moveStep(e,a)}else i.arrive()}},syncSelf:function(){},getPathEndPos:function(){return this._pathEndPos},leavePass:function(e,t){return!0},enterPass:function(e,t){return!0},clear:function(){this._lastEndPos=null,this._lastSpeed=0,this._lastPos=null,this._nextPos=null,this._isMoving=!1,this._pathEndPos=null,this._super()}}),b8e.RC("$$game","$$WalkMoveState",e)}(),function(){var e;e=game.MoveState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_HIT_MOVE)},execute:function(){this._super(),this._ref instanceof game.HitMoveStateReference?this.hitMove():b8e.error("\u8be5\u72b6\u6001\u53c2\u6570\u5fc5\u987b\u4f20\u5165 game.HitMoveStateReference")},hitMove:function(){var e=this._machine.owner;if(e){var t=e.data;if(t){var a=e.getScene();if(a)if(t.hitPos){var i,n,s,o,r=game.playBackScene.getViewOffset(),g=this._ref.speedRatio,l=r.x,c=r.y;if(t.hp<0)b8e.Tween.get(this).wait(300/g).call(this.deathCmp,this);else{var h=game.playBack.hitMoveTime,m=game.playBack.hitWaitTime,u=game.playBack.hitBackTime;i=l+t.hitPos.x,n=c-t.hitPos.y,s=l+t.createPos.x,o=c-t.createPos.y;var d=a.sceneUIToGLPos(i,n);i=d.x,n=d.y;var f=a.sceneUIToGLPos(s,o);s=f.x,o=f.y,b8e.Tween.kill(e),b8e.Tween.get(e).to({x:i,y:n},h/g).wait(m/g).to({x:s,y:o},u/g).wait(100/g).call(this.onTotalFrameCmp,this)}}else e&&e.data&&0<e.data.hp&&this.transition(game.RoleStateType.ACTION_HIT)}}},onTotalFrameCmp:function(){var e=this._machine.owner;e&&e.data&&0<e.data.hp?this.transition(game.RoleStateType.ACTION_IDLE):this.switchDeathState(e)},deathCmp:function(){this.switchDeathState(this._machine.owner)},switchDeathState:function(e){if(e){var t=this._ref?this._ref.speedRatio:1,a=e.getStateRef(game.DeathStateReference);e.deathHideAllBar&&e.deathHideAllBar(),a.setParams(t,!0),this.transition(game.RoleStateType.ACTION_DEATH,a)}},leave:function(){b8e.Tween.kill(this)}}),b8e.RC("$$game","$$HitMoveState",e)}(),function(){var e;e=b8e.Enum({IDLE:"stand",WALK:"run",RIDE_IDLE:"standAndRide",RIDE_WALK:"runAndRide",DIE:"die",HIT:"hit",RIDE_HIT:"hitAndRide"}),b8e.RC("$$game","$$RoleActionType",e)}(),function(){var e;e=b8e.Enum({ACTION_IDLE:1,ACTION_WALK:2,ACTION_ATTACK:3,ACTION_FLY:4,ACTION_DEATH:5,ACTION_DEATH_FLY:6,ACTION_HIT:7,CONTROL_WALK_MOVE:101,CONTROL_STOP_WALK_MOVE:102,CONTROL_FLY_MOVE:103,CONTROL_HIT_MOVE:104}),b8e.RC("$$game","$$RoleStateType",e)}(),function(){var e,a=e=b8e.StateMachine.extends({ctor:function(e){this._super(e),a.init(this)},isIdle:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_IDLE},isWalking:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_WALK},isWalkMoving:function(){var e=this.getCurrState("MoveState");return e&&e.type==game.RoleStateType.CONTROL_WALK_MOVE},isDeath:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_DEATH},isDeathFly:function(){var e=this.getCurrState("MoveState");return e&&e.type==game.RoleStateType.ACTION_DEATH_FLY},isDeadState:function(){return this.isDeath()||this.isDeathFly()},isHit:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_HIT}});a.stateMapping=null,a.init=function(e){if(!a.stateMapping){var t=a.stateMapping={};t[game.RoleStateType.ACTION_IDLE]=game.IdleState,t[game.RoleStateType.ACTION_WALK]=game.WalkState,t[game.RoleStateType.ACTION_FLY]=game.FlyState,t[game.RoleStateType.ACTION_ATTACK]=game.AttackState,t[game.RoleStateType.ACTION_DEATH]=game.DeathState,t[game.RoleStateType.ACTION_DEATH_FLY]=game.DeathFlyState,t[game.RoleStateType.ACTION_HIT]=game.HitState,t[game.RoleStateType.CONTROL_WALK_MOVE]=game.WalkMoveState,t[game.RoleStateType.CONTROL_FLY_MOVE]=game.FlyMoveState,t[game.RoleStateType.CONTROL_STOP_WALK_MOVE]=game.StopWalkMoveState,t[game.RoleStateType.CONTROL_HIT_MOVE]=game.HitMoveState}e.setStateMapping(a.stateMapping)},a.poolCall=!0,b8e.RC("$$game","$$RoleStateMachine",e)}(),function(){var e;e=b8e.StateReference.extends({targets:null,setParams:function(e){this.targets=e},clear:function(){this._super(),this.targets=null}}),b8e.RC("$$game","$$AiAttackStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({target:null,setParams:function(e,t){this.target=e,this.moveType=t},clear:function(){this._super(),this.target=null,this.moveType=0}}),b8e.RC("$$game","$$AiMoveStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({actionType:null,speedRatio:1,radian:null,_totalCb:null,setParams:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:1;this.actionType=e,this.radian=t,this.speedRatio=i},onTotal:function(e,t,a){return this._totalCb=e?{func:e,thisArg:t,args:a}:null,this},total:function(){if(this._totalCb){var e;e=this._totalCb.args?this._totalCb.args.concat(this):[this],this._totalCb.func.apply(this._totalCb.thisArg,e)}},clear:function(){this.actionType=null,this.radian=null,this.speedRatio=1,this._totalCb=null,this._super()}}),b8e.RC("$$game","$$AttackStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({speedRatio:0,ctor:function(){this._super()},setParams:function(e){this.speedRatio=e},clear:function(){this.speedRatio=1,this._super()}}),b8e.RC("$$game","$$HitMoveStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({releaserId:0,deathDelay:0,speedRatio:1,ctor:function(){this._super()},setParams:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:1;this.releaserId=e,this.deathDelay=t,this.speedRatio=i},clear:function(){this._super(),this.deathDelay=0,this.releaserId=0,this.speedRatio=1}}),b8e.RC("$$game","$$DeathFlyReference",e)}(),function(){var e;e=b8e.StateReference.extends({speedRatio:1,isFight:!1,setParams:function(e,t){var a=0<arguments.length&&void 0!==e?e:1,i=1<arguments.length&&void 0!==t&&t;this.speedRatio=a,this.isFight=i},clear:function(){this._super(),this.speedRatio=1}}),b8e.RC("$$game","$$DeathStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({target:null,speed:0,_arriveCb:null,ctor:function(){this._super()},setParams:function(e,t){this.target=e,this.speed=t},arrive:function(){if(this._arriveCb){var e;e=this._arriveCb.args?this._arriveCb.args.concat(this):[this],this._arriveCb.func.apply(this._arriveCb.thisArg,e)}},onArrive:function(e,t,a){return this._arriveCb=e?{func:e,thisArg:t,args:a}:null,this},clear:function(){this.target=null,this.speed=0,this._arriveCb=null,this._super()}}),b8e.RC("$$game","$$FlyMoveStateRefrence",e)}(),function(){var e;e=b8e.StateReference.extends({target:null,speed:0,speedRatio:1,arriveCb:null,ctor:function(){this._super(),this._footSpan=0},setParams:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:1;this.target=e,this.speed=t*i,this.speedRatio=i},onArrive:function(e,t,a){return this.arriveCb={func:e,thisArg:t,args:a},this},clear:function(){this.target=null,this.speed=0,this.spacing=0,this.speedRatio=1,this.arriveCb=null,this._super()}}),b8e.RC("$$game","$$FlyStateRefrence",e)}(),function(){var e;e=b8e.StateReference.extends({setParams:function(e){var t=0<arguments.length&&void 0!==e?e:1;this.speedRatio=t},clear:function(){this.speedRatio=1,this._super()}}),b8e.RC("$$game","$$HitStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({target:null,speed:0,spacing:0,_arriveCb:null,_unableCb:null,_throughCb:null,_stopCb:null,findPath:!0,ctor:function(){this._super()},setParams:function(e,t,a,i){var n=!(3<arguments.length&&void 0!==i)||i;this.target=e,this.spacing=t,this.speed=a,this.findPath=n},setPath:function(e){this.path=e},onUnable:function(e,t,a){return this._unableCb=e?{func:e,thisArg:t,args:a}:null,this},onArrive:function(e,t,a){return this._arriveCb=e?{func:e,thisArg:t,args:a}:null,this},unable:function(){if(this._unableCb){var e;e=this._unableCb.args?this._unableCb.args.concat(this):[this],this._unableCb.func.apply(this._unableCb.thisArg,e)}},arrive:function(){if(this._arriveCb){var e;e=this._arriveCb.args?this._arriveCb.args.concat(this):[this],this._arriveCb.func.apply(this._arriveCb.thisArg,e)}},clear:function(){this.target=null,this.speed=0,this.spacing=0,this._arriveCb=null,this._unableCb=null,this._throughCb=null,this.path=null,this.findPath=!0,this._super()}}),b8e.RC("$$game","$$WalkMoveStateReference",e)}(),function(){var e;e=b8e.StateReference.extends({target:null,speed:0,spacing:0,speedRatio:1,arriveCb:null,findPath:!0,ctor:function(){this._super(),this._footSpan=0},setParams:function(e,t,a,i,n){var s=2<arguments.length&&void 0!==a?a:0,o=3<arguments.length&&void 0!==i?i:1,r=!(4<arguments.length&&void 0!==n)||n;this.target=e,this.spacing=s,this.speed=t*o,this.speedRatio=o,this.findPath=r},setPath:function(e){this.path=e},onArrive:function(e,t,a){return this.arriveCb={func:e,thisArg:t,args:a},this},clear:function(){this.target=null,this.speed=0,this.spacing=0,this.speedRatio=1,this.arriveCb=null,this.findPath=!0,this.path=null,this._super()}}),b8e.RC("$$game","$$WalkStateReference",e)}(),function(){var p=game.AvatarUtil=function(){};p.update=function(e){e&&e.data&&e.data.avatar&&(p._updateAvatarState(e),p._updateFollowState(e))},p._updateAvatarState=function(e){p.updateBody(e);var t=b8e.getNormP("_$anims"),a=p._getFolllowHiddensByName(t);if(a&&!(a.length<1))for(var i=0,n=void 0,s=a.length;i<s;i++)(n=a[i])&&(n==game.AnimType.NICK_NAME?p.updateNickName(e):n==game.AnimType.MOUNT?p.updateMount(e):p._updateAvatar(e,n))},p._updateFollowState=function(e){var t=b8e.getNormP("_$roles"),a=p._getFolllowHiddensByName(t);if(a&&!(a.length<1))for(var i=0,n=void 0,s=a.length;i<s;i++)(n=a[i])&&p._updateByType(e,n)},p.updatePetFly=function(e,t){p._updateAvatar(e,game.AnimType.PET_FLY,t)},p.updateJunzhen=function(e,t){p._updateAvatar(e,game.AnimType.JUNZHEN,t)},p.updateAmbition=function(e,t){p._updateAvatar(e,game.AnimType.AMBITION,t)},p._updateAvatar=function(e,t){var a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e&&e.data&&e.data.avatar&&(a&&!p._isShowAnim(e.type,t)||p.doUpdateAvatar(e,t,i))},p.doUpdateAvatar=function(e,t,a){var i=game.AnimCfg.getUData(t);if(i){var n=e.getAnimator(t,1),s=e.data.avatar,o=e.data.heroModel;if(t!=game.AnimType.WEAPON||e.getIsRide()&&s.body)if(t!=game.AnimType.PET_FLY||o.useFly){var r="",g=p._getAvatarAnim(i.avatar,a);g&&(r=s[g]);var l=0<i.depthFixed,c=i.depth,h=0<i.isShadow,m="";t==game.AnimType.WEAPON&&(m=game.RoleActionType.RIDE_IDLE);var u=0,d=0,f=a?i.uiPosX:i.posX;u=i.isAttack?e.data.isAttack?+f:-f:f,i.mountOffsetY?(d=(d=a?o.uiMountOffsetY:o.mountOffsetY)||0,d+=a?i.uiPosY:i.posY):d=a?i.uiPosY:i.posY,r?((n=n||e.addAnimator(t,1,c,l)).setPosition(u,d),n.load(r),n.play(m,0),h&&e.hideShadow()):(n&&n.clear(),h&&e.showShadow())}else n&&n.clear();else n&&n.clear()}},p._getAvatarAnim=function(e,t){var a="";switch(e){case"weapon":a=t?"_$weaponUI":"_$weapon";break;case"body":a=t?"_$bodyUI":"_$body";break;case"wing":a=t?"_$wingUI":"_$wing";break;case"mountHead":a=t?"_$mountHeadUI":"_$mountHead";break;case"mount":a=t?"_$mountUI":"_$mount";break;case"halo":a=t?"_$haloUI":"_$halo";break;case"shenhun":a=t?"_$shenhunUI":"_$shenhun"}return b8e.getNormP(a)},p.updateBody=function(e,t){if(e&&e.data&&e.data.avatar){var a=e.data.avatar,i=t?a.bodyUI:a.body,n=e.getAnimator(game.AnimType.BODY,1);if(i){(n=n||e.addAnimator(game.AnimType.BODY,1,10)).setAsBoundary(!0),n.setTouchable(!0);e.data.heroModel;e.updateScale(),n.soundEffectsEnabled=e.data.isSelf,n.ghostable=!0,n.load(i,function(){e.addHeadBar()},n);var s=game.RoleActionType.IDLE;e.data.arrow&&(s=game.RoleActionType.HIT),n.play(s),p.updateAmbition(e)}else n&&n.clear()}},p.updateRoleEffect=function(e,t){var a=e.getAnimator(t,1);a=a||e.addAnimator(t,1,0);var i="";t==game.AnimType.BOSS_EFFECT&&(i=game.ResCfg.getUrl(5079)),i?(a.load(i),a.play(null,0)):a.clear()},p.updateMount=function(e,t){if(e&&e.data&&e.data.avatar){var a=game.AnimType,i=e.data.avatar,n=e.getAnimator(a.MOUNT,1),s=e.getAnimator(a.MOUNT_HEAD,1),o=e.getAnimator(a.BODY,1),r=t?i.mountUI:i.mount;if(r&&""!=r){if(!n){var g=game.AnimCfg.getUData(a.MOUNT),l=g?g.depth:-300,c=g&&0<g.depthFixed;n=e.addAnimator(a.MOUNT,1,l,c)}n.load(r),n.play(null,0);var h=t?e.data.heroModel.uiMountOffsetY:e.data.heroModel.mountOffsetY;if(h=h||0,i.mountHead){if(!s){var m=game.AnimCfg.getUData(a.MOUNT_HEAD),u=m?m.depth:100,d=m&&0<m.depthFixed;s=e.addAnimator(a.MOUNT_HEAD,1,u,d)}s.load(t?i.mountHeadUI:i.mountHead),s.play(null,0)}else s&&s.clear();if(e.updateRideState(!0),e.type==game.RoleType.UIRole&&(e.hideShadow(),e.hideRootBar()),o)if(e.getIsRide())o.play(game.RoleActionType.RIDE_IDLE,0),o.setPosition(0,h);else{var f=game.RoleActionType.IDLE;e.data.arrow&&(f=game.RoleActionType.HIT),o.play(f)}}else n&&n.clear(),s&&s.clear(),o&&o.setPosition(0,0),e.updateRideState(!1)}},p.updateNickName=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],a=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e&&e.data&&e.data.avatar&&(t&&!p._isShowAnim(e.type,game.AnimType.NICK_NAME)||e.updateNickName(a))},p.updatePet=function(e){p._updateByType(e,game.RoleType.Partner)},p._updateByType=function(e,t){if(e&&e.data&&e.data.heroModel){var a=e.getScene();if(a&&p._isFollowByType(t)){var i=e.data.heroModel,n=e.data.id,s=a.getDisplayByTypeAndId(t,n);if(i.getModel(t)){if(!s){var o=void 0,r=game.FollowCfg.getUData(t);r&&r.depth&&(o=r.depth),s=game.sceneRoleCreate.create(e,t,o),p._updateFollower(e,t,s)}var g=s.data.heroModel;g.setBody(t,i.getModel(t)),p._setAvatarData(t,i,g),p.updateAvatar(s,t)}else p._updateFollower(e,t,s,!1),p._remove(s,t,a,n)}}},p._updateFollower=function(e,t,a){var i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if(p._isFollowByType(t)){var n=game.FollowCfg.getUData(t);n&&!n.isFlyFollow&&game.follow.updatePetFollow(e,a,i)}},p._remove=function(e,t,a,i){e&&a.removeDisplay(e)},p._setAvatarData=function(e,t,a){var i=game.AvatarHiddenCfg.getData(e,!1,!1);i&&i.useFly&&a.setUseFly(t.useFly);var n=b8e.getNormP("_$setAnims"),s=p._getAvatarHiddensByName(n,e);if(s&&0<s.length)for(var o=0,r=s.length;o<r;o++)(n=s[o])&&a.setAnim(n,t.getAnim(n));n=b8e.getNormP("_$setModels");var g=p._getAvatarHiddensByName(n,e);if(g&&0<g.length)for(var l=0,c=g.length;l<c;l++)(n=g[l])&&a.setModel(n,t.getModel(n))},p.updateAvatar=function(e,t){p.updateBody(e);var a=b8e.getNormP("_$updateAnims"),i=p._getAvatarHiddensByName(a,t);if(i&&0<i.length)for(var n=0,s=i.length;n<s;n++)(a=i[n])&&(a==game.AnimType.NICK_NAME?p.updateNickName(e):p._updateAvatar(e,a));a=b8e.getNormP("_$updateModels");var o=p._getAvatarHiddensByName(a,t);if(o&&0<o.length)for(var r=0,g=o.length;r<g;r++)(a=o[r])&&p._updateByType(e,a)},p._removeFlyPet=function(e,t,a){var i=e.getDisplayByTypeAndId(t,a);i&&e.removeDisplay(i)},p._isFollowByType=function(e){if(e==game.RoleType.Hero||e==game.RoleType.UIRole)return!0;var t=b8e.getNormP("_$roles"),a=p._getFolllowHiddensByName(t);return!(!a||-1==a.indexOf(e))},p._isShowAnimByType=function(e){var t=b8e.getNormP("_$anims"),a=p._getFolllowHiddensByName(t);return!(!a||-1==a.indexOf(e))},p._isShowAnim=function(e,t){var a=b8e.getNormP("_$showAnims"),i=p._getAvatarHiddensByName(a,e);return!!(i&&-1!=i.indexOf(t)&&p._isShowAnimByType(t)&&p._isFollowByType(e))},p._getFolllowHiddensByName=function(e){var t=void 0,a=void 0,i=game.sceneData.getSceneType();if(p._fhns&&0<p._fhns.length&&(t=p._fhns[e])&&(a=t[i])&&0<a.length)return a;var n=game.FollowHiddenCfg.getData(i,!1,!1);if(n&&n[e]&&(t=n[e].split(","))&&0<t.length){for(var s=0,o=t.length;s<o;)t[s]=+t[s],s++;p._fhns||(p._fhns=[]);var r=p._fhns[e];(r=r||[])[i]||(r[i]=t)}return t},p._getAvatarHiddensByName=function(e,t){var a=void 0,i=void 0;if(p._ahns&&0<p._ahns.length&&(a=p._ahns[e])&&(i=a[t])&&0<i.length)return i;var n=game.AvatarHiddenCfg.getData(t,!1,!1);if(n&&n[e]&&(a=n[e].split(","))&&0<a.length){for(var s=0,o=a.length;s<o;)a[s]=+a[s],s++;p._ahns||(p._ahns=[]);var r=p._ahns[e];(r=r||[])[t]||(r[t]=a)}return a},p.ID_1=1,p.ID_2=2,p.ID_3=3,p.ID_4=4,p.ID_5=5,p.ID_6=6,p.ID_7=7,p.ID_8=8,p.ID_9=9,p.ID_10=10,p.ID_11=11,p.ID_12=12,p.ID_13=13,p.ID_14=14,p.ID_15=15,p.ID_16=16,p._avatarDic,p.updateUIModel=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=void 0;if(p._avatarDic&&(i=p._avatarDic[t])&&0<i.length)p._updateUIModel(e,i,a);else{var n=game.AvatarCfg.getUData(t);if(n&&n.anims&&(i=n.anims.split(","))&&0<i.length){for(var s=0,o=i.length;s<o;)i[s]=+i[s],s++;p._avatarDic||(p._avatarDic=[]),p._avatarDic[t]=i,p._updateUIModel(e,i,a)}}},p._updateUIModel=function(e,t,a){for(var i=0,n=void 0,s=t.length;i<s;i++)switch(n=t[i]){case game.AnimType.BODY:p.updateBody(e,a);break;case game.AnimType.NICK_NAME:p.updateNickName(e,!1,a);break;case game.AnimType.MOUNT:p.updateMount(e,a);break;default:p._updateAvatar(e,n,!1,a)}},p.MT_0=0,p.MT_1=1,p.MT_2=2,p.MT_3=3,p.getUIModel=function(e){var t=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=0;switch(1<arguments.length&&void 0!==arguments[1]?arguments[1]:0){case 1:a=e.model1,e.UIModel1&&t&&(a=e.UIModel1),a||(a=e.model,b8e.warn("\u672a\u914d\u7f6e\u5973\u89d2\u8272\u6a21\u578b,\u5c06\u9ed8\u8ba4\u4f7f\u7528\u7537\u89d2\u8272\u6a21\u578b"));break;case 2:a=e.flyModel,e.UIFlyModel&&t&&(a=e.UIFlyModel);break;case 3:a=e.mountHead,e.UIMountHead&&t&&(a=e.UIMountHead);break;case 0:default:a=e.model,e.UIModel&&t&&(a=e.UIModel)}return a},p.updateModel=function(e,t,a){if(e&&t){var i=t.roleData.heroModel;if(i){i.clear();var n=p.getUIModel(e);i.setBody(a,n),p.updateBody(t.role)}}},p.updateModel2=function(e,t,a){if(e&&t){var i=t.roleData.heroModel;i&&(i.clear(),i.setBody(a,e),p.updateBody(t.role))}},p.updatePetModel=function(e,t,a){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(e&&t&&t.roleData){var n=e.cfg;if(n){var s=t.roleData.heroModel;if(s){s.clear();var o=p.getUIModel(n);o&&s.setBody(a,o),p.updateBody(t.role);var r=n.canFly&&e.useFlyModel||n.canFly&&i;s.setUseFly(r),r&&s.setAnim(game.AnimType.PET_FLY,p.getUIModel(n,p.MT_2)),p.updatePetFly(t.role)}}}},p.updateMountModel=function(e,t,a){if(e&&t&&a){var i=t.heroModel;if(i){i.clear();var n=p.getUIModel(a);n&&(i.setAnim(game.AnimType.MOUNT,n),i.setMountOffsetY(a.UIMountOffsetY)),(n=p.getUIModel(a,p.MT_3))&&i.setAnim(game.AnimType.MOUNT_HEAD,n),p.updateMount(e,!0),e.hideShadow(),e.hideRootBar()}}},p.clearFosterMode=function(e){if(e){var t=game.AnimType,a=e.getAnimator(t.BODY,1);a&&a.clear(),(a=e.getAnimator(t.MOUNT,1))&&a.clear(),(a=e.getAnimator(t.MOUNT_HEAD,1))&&a.clear()}}}(),function(){var h=game.CCommonUtil=function(){};h.getPowerByType=function(e,a){if(!e)return 0;var t=e.getSpriteStats();if(!t)return 0;var i,n=0;return t.forEach(function(e,t){if(e=+e,-1<a.indexOf(e)){if(!(i=game.AttrPowerCoefCfg.getData(e)))return;switch(i.type){case 0:n+=t*i.coef;break;case 1:n+=100*t*i.coef}}},this),0|n},h.getPower=function(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(!e)return 0;var t=e.getSpriteStats();if(!t)return 0;var i,n=0;return t.forEach(function(e,t){if(e=+e,i=game.AttrPowerCoefCfg.getData(e))switch(i.type){case 0:n+=t*a*i.coef;break;case 1:n+=t*a*100*i.coef}},this),0|n},h.replaceNum=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;if(t<0&&(t=0),t>>=0,1e8<e){var a=e/1e8;return a=h.floorNum(a,t),game.Lang.get(9571,a)}if(1e7<=e){a=e/1e7;return a=h.floorNum(a,t),game.Lang.get(53004,a)}if(1e4<=e){a=e/1e4;return a=h.floorNum(a,t),game.Lang.get(9545,a)}return 0|e},h.floorNum=function(e,t){var a=Math.pow(10,t),i=e;return(i=Math.floor(h.accMul(i,a))/a)==(0|i)&&(i|=0),i},h.replaceChineseNum=function(e){if(1e4<=e)return"";for(var t="",a=0,i=e,n=e.toString(),s=n.length,o=0;o<s;o++){switch(a=i%10,a|=0){case 0:if(0==o&&o<s-1)break;if(2<s&&0==(a=0|n[s-2]))break;t=game.Lang.get(9572,t);break;case 1:t=game.Lang.get(9573,t);break;case 2:t=game.Lang.get(9574,t);break;case 3:t=game.Lang.get(9575,t);break;case 4:t=game.Lang.get(9576,t);break;case 5:t=game.Lang.get(9577,t);break;case 6:t=game.Lang.get(9578,t);break;case 7:t=game.Lang.get(9579,t);break;case 8:t=game.Lang.get(9580,t);break;case 9:t=game.Lang.get(9581,t)}0==o&&o<s-1?(0!=(a=0|n[s-2])||s<3)&&(t=game.Lang.get(9582,t)):1==o&&o<s-1?t=game.Lang.get(9583,t):2==o&&o<s-1&&(t=game.Lang.get(9584,t)),i/=10}return t},h.numConvertToChineseNum=function(e){if((99<e||e<0)&&b8e.warn("numConvertToChineseNum \u6682\u65f6\u53ea\u652f\u6301\u4e0d\u5927\u4e8e99\u7684\u6b63\u6574\u6570"),9<e&&e<20){var t=e%10;return game.Lang.get(9582,0<t?h.replaceChineseNum(t):"")}return h.replaceChineseNum(e)},h.getQualityStr=function(e){var t=void 0;switch(e){case game.Quality.Q_WHITE:t=9374;break;case game.Quality.Q_GREEN:t=9375;break;case game.Quality.Q_BLUE:t=9376;break;case game.Quality.Q_PURPLE:t=9377;break;case game.Quality.Q_YELLOW:t=9378;break;case game.Quality.Q_RED:t=9379;break;case game.Quality.Q_COLORFUL:t=9381;break;case game.Quality.Q_UNPARALLELED:t=9380}return t?game.Lang.get(t):""},h.getGuildRankText=function(e){var t=void 0;switch(e){case 0:t=9167;break;case 1:t=9168;break;case 2:t=9169}return t?game.Lang.get(t):""},h.getElementText=function(e){var t=void 0;switch(e){case 1:t=51201;break;case 2:t=51202;break;case 3:t=51203;break;case 4:t=51611}return t?game.Lang.get(t):""},h.clearList=function(e){if(e){for(var t=0,a=e.length;t<a;t++)e[t].release();e.length=0}},h.setClipboardData=function(e){if(b8e.isWeChatGame)wx.setClipboardData?wx.setClipboardData({data:e,success:function(){},fail:function(){game.notice.show(9030)}}):game.notice.show(9030);else if(b8e.params.isVivoGame)qg&&qg.setClipboardData?qg.setClipboardData({text:e,success:function(){game.notice.show(9029)},fail:function(){game.notice.show(9030)}}):game.notice.show(9030);else if(b8e.params.isQuickGame)qg&&qg.setClipboardData?qg.setClipboardData({data:e}):game.notice.show(9030);else{var t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select&&t.select();var a=t.value.length;b8e.getFPV(t,"setSelectionRange").call(t,0,a),b8e.getFPV(document,"execCommand").call(document,"Copy"),document.body.removeChild(t),game.notice.show(9029)}},h.getqualityEffect=function(e){var t=game.Quality,a=void 0;switch(e){case t.Q_YELLOW:a=1002;break;case t.Q_RED:a=1003;break;case t.Q_UNPARALLELED:a=1004;break;case t.Q_COLORFUL:a=1005}return a},h.getGameChannelIdOpen=function(e){if(!e)return!1;var t=e.gameChannelIdState;if(!t)return!0;var a=t.split("|");if(!a||a.length<2)return b8e.error("\u914d\u7f6e\u683c\u5f0f\u9519\u8bef:"+e.name+"gameChannelIdState:"+t),!1;var i=1==+a[0],n=a[1].split(",");if(!n||n.length<1)return b8e.error("\u914d\u7f6e\u683c\u5f0f\u9519\u8bef:"+e.name+"gameChannelIdState:"+t),!1;var s=game.LoginConfig.getGameChannelId()+"";return i==-1<n.indexOf(s)},h.getRandomArr=function(e){if(!e||e.length<1)return e;for(var t=void 0,a=e.length,i=0;i<a;i++){var n=Math.floor(Math.random()*a);t=e[n],e[n]=e[i],e[i]=t}return e},h.accAdd=function(e,t){var a=void 0,i=e,n=0,s=e.toString();-1!=s.indexOf(".")&&((a=s.split("."))&&0<a.length&&a[1]&&(n=a[1].length),i=+s.replace(".",""));var o=t,r=0,g=t.toString();-1!=g.indexOf(".")&&((a=g.split("."))&&0<a.length&&a[1]&&(r=a[1].length),o=+g.replace(".",""));var l=Math.abs(n-r),c=Math.pow(10,Math.max(n,r));if(0<l){var h=Math.pow(10,l);t=r<n?(e=i,o*h):(e=i*h,o)}else e=i,t=o;return(e+t)/c},h.accSub=function(e,t){var a=void 0,i=0,n=e.toString();-1!=n.indexOf(".")&&(a=n.split("."))&&0<a.length&&a[1]&&(i=a[1].length);var s=0,o=t.toString();-1!=o.indexOf(".")&&(a=o.split("."))&&0<a.length&&a[1]&&(s=a[1].length);var r=Math.pow(10,Math.max(i,s));return+((e*r-t*r)/r).toFixed(s<=i?i:s)},h.accMul=function(e,t){var a=0,i=e.toString(),n=t.toString(),s=e,o=t,r=void 0;return-1!=i.indexOf(".")&&((r=i.split("."))&&0<r.length&&r[1]&&(a+=r[1].length),s=+i.replace(".","")),-1!=n.indexOf(".")&&((r=n.split("."))&&0<r.length&&r[1]&&(a+=r[1].length),o=+n.replace(".","")),s*o/Math.pow(10,a)},h.accDiv=function(e,t,a){a=a||2;var i=void 0,n=e,s=t,o=0,r=e.toString();-1!=r.indexOf(".")&&((i=r.split("."))&&0<i.length&&i[1]&&(o=i[1].length),n=+r.replace(".",""));var g=0,l=t.toString();-1!=l.indexOf(".")&&((i=l.split("."))&&0<i.length&&i[1]&&(g=i[1].length),s=+l.replace(".",""));var c=n/s*Math.pow(10,g-o);return h.toFixed(c,a)},h.toFixed=function(e,t){if(0==t)return Math.round(e);var a=e.toString();if(-1!=a.indexOf(".")){var i=a.split(".");if(i&&0<i.length&&i[1]){var n=i[1].length,s="",o=0;if(t<n){for(;o<t&&"0"==i[1].substring(0,++o);)s+="0";var r=+i[1].substring(0,t),g=Math.round(+("0."+i[1].substring(t,n)));return t<(n=(r+g).toString().length)?+i[0]+1:n==t?+(i[0]+"."+(r+g)):+(i[0]+"."+s+(r+g))}}}return e},h.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}}(),function(){var e=game.PoolHelper=function(){};e.addForgeSpriteStat=function(e){this._forgeStatList||(this._forgeStatList=[]),this._forgeStatList.push(e)},e.getForgeSpriteStat=function(e){var t=void 0;return this._forgeStatPool&&0<this._forgeStatPool.length?((t=this._forgeStatPool.shift()).clear(),t.setupByCfg(e)):t=game.SpriteStatUtil.setDataByCfg(e),t},e.recycleForgeSpriteStat=function(){if(this._forgeStatList){this._forgeStatPool||(this._forgeStatPool=[]);for(var e=void 0;this._forgeStatList.length;)(e=this._forgeStatList.shift()).clear(),this._forgeStatPool.push(e);this._forgeStatList.length=0}}}(),function(){var r=game.CfgUtil=function(){};r.getMonsterModelByMonGroup=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=arguments[4],n=arguments[5],s=!(6<arguments.length&&void 0!==arguments[6])||arguments[6],o=0;if(!(2<arguments.length&&void 0!==arguments[2])||arguments[2]){if(!e||e.length<1)return void i.call(n,0);o=e.length<a+1?e[0]:e[a]}else o=e;r.getMonsterCfgByMonGroup(o,t,function(e){var t=game.AvatarUtil.getUIModel(e,0,s);i.call(n,t)})},r.getMonsterCfgByMonGroup=function(r,g,l,c){r?game.MonGroupCfg.getDataAsync(r,function(e){if(!e)return b8e.warn("\u6ca1\u6709\u914d\u7f6e\u7684\u602a\u7269\u7ec4,monGroup:",r),void l.call(c,null);var n=e.monsters;if(!n||n.length<1)return b8e.warn("\u602a\u7269\u7ec4\u914d\u7f6e\u7684\u602a\u7269\u7ec4\u957f\u5ea6\u7b49\u4e8e0,monGroup:",r),void l.call(c,null);for(var t=0,s=0,o={},a=0,i=n.length;a<i;a++)t=n[a],game.MonsterCfg.getDataAsync(t,function(e){if(s++,e&&(o[e.id]=e),s>=n.length)for(var t=void 0,a=0,i=n.length;a<i;a++)if(t=o[n[a]]){if(t.type==g){l.call(c,t),l=null;break}}else b8e.warn("\u6ca1\u6709\u5bf9\u5e94\u7684\u602a\u7269\u914d\u7f6e,monsterId:",n[a])})}):l.call(c,null)},r.getRandomMonsters=function(i,n,s,o){i?game.InstanceCfg.getDataAsync(i,function(e){if(e){var t=e.monGroups;if(!t||t.length<1)return;var a=t[Math.random()*t.length>>0];r.getRandomMonsterByMonGroup(a,n,s,o)}else b8e.warn("\u6253\u91ce\u914d\u7f6e\u4e0d\u5b58\u5728id\uff1a",i)},s):n.call(s,null)},r.getRandomMonsterByMonGroup=function(a,i,n,s){a?game.MonGroupCfg.getDataAsync(a,function(e){if(!e)return b8e.warn("\u6ca1\u6709\u914d\u7f6e\u7684\u602a\u7269\u7ec4,monGroup:",a),void i.call(n,null);var t=e.monsters;if(!t||t.length<1)return b8e.warn("\u602a\u7269\u7ec4\u914d\u7f6e\u7684\u602a\u7269\u7ec4\u957f\u5ea6\u7b49\u4e8e0,monGroup:",a),i.call(n,null),void(i=null);Array.isArray(s)?(s.unshift(t),i.apply(n,s)):i.apply(n,[t,s]),i=null}):i.call(n,null)},r.getPrizeListInfoAndFontSize=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.IconLayoutEnum.SHOW_NUM,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.IconSizeEnum.GRID_SIZE_105,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,n=new game.CfgPrizeInfo(t,a);return n.fontSize=i,n.setup(e),n},r.getPrizeListInfo=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.IconLayoutEnum.SHOW_NUM,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.IconSizeEnum.GRID_SIZE_105,i=new game.CfgPrizeInfo(t,a);return i.setup(e),i},r.getPrizeListInfo2=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.IconLayoutEnum.SHOW_NUM,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.IconSizeEnum.GRID_SIZE_105,i=new game.CfgPrizeInfo(t,a);return i.setup2(e),i},r.setPrizeKey=function(e,t,a){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"_$prizeItems";if(!e)return null;if(t=b8e.getNormP(t),e[i=b8e.getNormP(i)]&&0<e[i].length)return e;if(e[i])return b8e.warn("prizeKey\u5df2\u88ab\u5360\u7528\uff0c\u8bf7\u4f7f\u7528\u53e6\u5916\u7684prizeKey\u547d\u540d"),e;if(e[i]=[],t&&e[t]){var n={Id:220001,Num:e[t]};e[i].push(n)}if(a&&0<a.length)for(var s=a.length,o=void 0,r=0;r<s;r++)o=a[r],e[i].push(o);return e},r.getInsAutoTimeSpace=function(){if(this.insAutoTimeSpace)return this.insAutoTimeSpace;var e=game.InstanceMiscCfg.getData("instanceAutoTime");return e?(this.insAutoTimeSpace=1e3*(0|e.value),this.insAutoTimeSpace):0},r.getInsAutoTime=function(){if(this.insAutoTime)return this.insAutoTime;var e=game.InstanceMiscCfg.getData("instanceAutoTime");return e?(this.insAutoTime=0|e.value,this.insAutoTime):0},r.getZhaoqinLastLayer=function(){if(this.zhaoqinLastLayer)return this.zhaoqinLastLayer;var e=game.InstanceMiscCfg.getData("ZhaoqinLastLayer");return e?(this.zhaoqinLastLayer=0|e.value,this.zhaoqinLastLayer):0},r.getWanshouLastLayer=function(){if(this.wanshouLastLayer)return this.wanshouLastLayer;var e=game.InstanceMiscCfg.getData("WanshouLastLayer");return e?(this.wanshouLastLayer=0|e.value,this.wanshouLastLayer):0},r.getZhanjiangLastLayer=function(){if(this.zhanjiangLastLayer)return this.zhanjiangLastLayer;var e=game.InstanceMiscCfg.getData("ZhanjiangLastLayer");return e?(this.zhanjiangLastLayer=0|e.value,this.zhanjiangLastLayer):0},r.getMosterModelRes=function(i,n,s){game.MonGroupCfg.getDataAsync(i,function(e){if(e){var t=e.monsters;if(t&&0<t.length){var a=t[0];return void game.MonsterCfg.getDataAsync(a,function(e){var t=game.AvatarUtil.getUIModel(e);n.call(s,t||"1001")})}return b8e.warn("\u602a\u7269\u7ec4id:"+i+"\u672a\u914d\u7f6e\u4efb\u4f55\u602a\u7269\uff01"),void n.call(s,"1001")}b8e.warn("\u602a\u7269\u7ec4id:"+i+"\u627e\u4e0d\u5230\uff01"),n.call(s,"1001")})},r.getMosterModelId=function(a,i,n){game.MonGroupCfg.getDataAsync(a,function(e){if(e){var t=e.monsters;if(t&&0<t.length)return void i.call(n,t[0])}b8e.warn("\u602a\u7269\u7ec4id:"+a+"\u627e\u4e0d\u5230\uff01"),i.call(n,0)})},r.getMiscValue=function(e,t,a,i,n){var s=e.getData(t);if(s){if(a){var o=s.value.split(i);if(n)for(var r=0,g=o.length;r<g;r++)o[r]=+o[r];return o}return s.value}return 0},r.getSkillCfgById=function(e,t,a){var i=game.SkillCfg.getData(e);i?t.call(a,i):(b8e.warn("\u6280\u80fdid:"+e+"\u627e\u4e0d\u5230\uff01"),t.call(a,null))}}(),function(){var m=game.EffectUtil=function(){};m.playSceneEffect=function(e,t,a,i){var n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,r=!(7<arguments.length&&void 0!==arguments[7])||arguments[7],g=8<arguments.length&&void 0!==arguments[8]?arguments[8]:1e4,l=game.SceneEffect.get();return game.IS_SHIELD_SKILL?l:e?(l.setScenePosition(a.x,a.y),e.addDisplay(l,g,!1,!1,!1),l.play(t,i,n,s,o,r),l):void 0},m.playHitEffect=function(e,t,a,i,n,s){var o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,r=7<arguments.length&&void 0!==arguments[7]&&arguments[7],g=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,l=!(9<arguments.length&&void 0!==arguments[9])||arguments[9];if(game.IS_SHIELD_SKILL)return null;if(!a)return null;if(!e||!i)return null;var c=m.getBindPos(e,t),h=game.SceneEffect.get();return h.setScenePosition(n.x+c.x,n.y+c.y),a.addDisplay(h,1e4,!1,!1,!1),h.play(i,s,o,r,g,l)},m.getBindPos=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"hit",a={x:0,y:0};if(!e)return a;var i=e.getAnimator(game.AnimType.BODY,1);if(!i)return a;t=t||"hit";var n=i.createBindNodeByName(t);return a.x+=n.x,a.y-=n.y,a},m.playDeathEffect=function(e,t,a,i,n,s){var o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,r=7<arguments.length&&void 0!==arguments[7]&&arguments[7],g=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,l=!(9<arguments.length&&void 0!==arguments[9])||arguments[9],c=game.SceneEffect.get();return game.IS_SHIELD_SKILL?c:a?(c._id=e,c._type=game.RoleType.DeathEffect,c.setScenePosition(n.x,n.y),a.addDisplay(c,t,!1,!1,!1),c.play(i,s,o,r,g,l),c):void 0},m.delDeathEffect=function(e,t){t&&t.removeDisplayByTypeAndId(game.RoleType.DeathEffect,e)},m._effectId=1,m.getEffectId=function(){return 65535<=m._effectId&&(m._effectId=1),++m._effectId}}(),function(){var e=game.EquipUtil=function(){};game.posMapping={2:[1401,1402,1403,1404,1405,1406,1407,1408,1409,1410],5:[1411,1412,1413,1414],7:[1415,1416,1417,1418],8:[1419,1420,1421,1422],9:[1423,1424,1425,1426],10:[1427,1428,1429,1430],11:[1431,1432,1433,1434],12:[1435,1436,1437,1438],13:[1439,1440,1441,1442],14:[1443,1444,1445,1446],15:[1447,1448,1449,1450],16:[1451,1452,1453,1454],17:[1455,1456,1457,1458],19:[1473,1474,1475,1476,1477,1478],21:[1401,1402,1405,1476,1408,1406],24:[1401,1402,1403,1404,1405,1406,1407,1408,1409,1410]},e.getPosName=function(e,t){if(!e||!t)return"";var a=game.posMapping[e][t-1];if(a)return game.Lang.get(a);return""}}(),function(){var a=game.GridUtil=function(){};a.loadItemIcon=function(e,t,a,i){if(!a)return null;var n=game.ItemInfoCfg.getData(a),s=game.ResCfg.getUrl(137,n.icon),o=e[i];return o||((o=b8e.Sprite.get()).setAnchor(.5,.5),o.addToParent(t),o.setSize(40,40),e[i]=o),o.loadTexture(s),o},a.setItemIcon=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:game.IconLayoutEnum.SHOW_ALL;return e.setItemInfo(t,a,i),e},a.createEquipIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.SIZE_84;return new game.EquipIcon(e)},a.createItemIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.ItemIcon(e)},a.createPuzzleIcon=function(e){return new game.PuzzleIcon(e)},a.setPuzzleIcon=function(e,t,a){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e.setPuzzleInfo(t,a,i)},a.createBackItemIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.BackItemIcon(e,!1,game.IconLayoutEnum.SHOW_ALL,!0)},a.createTipsIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.TipsIcon(e)},a.createEquipSlotIcon=function(){return new game.EquipSlotIcon},a.createTransferEquipSlotIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_84;return new game.TransferEquipSlotIcon(e)},a.createGodEquipSlotIcon=function(){return new game.GodEquipSlotIcon},a.createFosterEquipIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.SIZE_84;return new game.FosterEquipIcon(e)},a.createFosterSkillIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.SIZE_68;return new game.FosterSkillIcon(e)},a.createCostItemIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.CostItemIcon(e)},a.createPrizeIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.PrizeIcon(e)},a.setPrizeIcon=function(e,t){return e.setItemInfo(t,!1),e},a.createSellEquipIcon=function(){return new game.SellEquipIcon},a.createSellFosterEquipIcon=function(){return new game.SellFosterEquipIcon},a.createPetSkillIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.CIRCLE_SIZE_104;return new game.PetSkillIcon(e)},a.createShopIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.ShopIcon(e)},a.createGuildSkillIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.CIRCLE_SIZE_104;return new game.GuildSkillIcon(e)},a.createTurnplateIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.TurnplateIcon(e)},a.setTurnplateIcon=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",n=4<arguments.length&&void 0!==arguments[4]&&arguments[4];e.setItemInfo(t,a,i,n)},a.createAmountIcon=function(e){return new game.AmountIcon(e)},a.setAmountIcon=function(e,t,a,i){var n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20,s=5<arguments.length&&void 0!==arguments[5]&&arguments[5];e.setItemInfo(game.AmountCfg.getItemId(t),a,i,n,s)},a.createCostIcon=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return new game.AmountIcon(e,t)},a.setCostIcon=function(e,t,a,i,n){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:20,o=6<arguments.length&&void 0!==arguments[6]&&arguments[6],r=7<arguments.length&&void 0!==arguments[7]&&arguments[7],g="";g=isNaN(a)?game.HtmlUtil.getText(i<=a?game.Color.GREEN:game.Color.RED,a)+"/"+i:r?game.CCommonUtil.replaceNum(i)+"":i+"",n=n||game.Color.GREEN,e.setItemInfo(t,g,n,s,o)},a.createViewClickIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_42;return new game.ViewClicklIcon(e)},a.createCultivateBaseIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.CultivateBaseIcon(e)},a.createCultivateBaseSkillIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.CIRCLE_SIZE_104,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=new game.CultivateBaseSkillIcon(e);return i.setShowMainSkillIcon(t),i.setShowPassiveSkillIcon(a),i},a.setGodEquipIcon=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:game.IconLayoutEnum.SHOW_ALL;return e.nameColor=game.Color.WHITE,e.nameSize=26,e.setItemInfo(t,a,i,!0),e.setLabNamePos(0,-5),e},a.createPetEquipIcon=function(){return new game.PartnerEquipIcon},a.createFosterEquipTipsIcon=function(){return new game.FosterEquipTipsIcon},a.createGodAnimalEquipIcon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.IconSizeEnum.GRID_SIZE_105;return new game.GodAnimalEquipIcon(e)},a.getSellIconByType=function(e){var t=void 0;switch(e){case game.SellType.EQUIP:case game.SellType.EXCLUSIVE_WEAPON:case game.SellType.CATILLA:t=a.createPetEquipIcon();break;case game.SellType.PARTNER:t=new game.CultivateBaseIcon;break;case game.SellType.SHENHUN_EQUIP:case game.SellType.MOUNT_EQUIP:t=a.createFosterEquipTipsIcon();break;case game.SellType.GOD_ANIMAL_EQUIP:t=a.createGodAnimalEquipIcon();break;default:t=a.createItemIcon()}return t}}(),function(){var e=game.ItemUtil=function(){};e.createItemInfo=function(e){var t=game.ItemInfo.get();return t.setData(e),t},e.createEquipInfo=function(e){var t=new game.EquipInfo;return t.setData(e),t},e.createEquipSlotInfo=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=new game.EquipSlotInfo(t);return a.setData(e),a},e.createSZSlotInfo=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=new game.ShengZhuangSlotInfo(t);return a.setData(e),a},e.createBaseItemInfo=function(e,t,a){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return(a=a||game.ItemInfo.get()).id=e,a.num=t,a.isDarkBg=i,a},e.createFosterSkillInfo=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=new game.FosterSkillInfo;return i.setData(e,t,a),i},e.createFosterEquipInfo=function(e){var t=new game.FosterEquipInfo;return t.setData(e),t},e.createEquipForgeInfo=function(e,t,a){var i=new game.EquipForgeInfo;return i.setData(e,t,a),i},e.createPrizeInfo=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:game.IconSizeEnum.GRID_SIZE_84,n=new game.PrizeInfo;return n.setData(e,t,0,a,i),n}}(),function(){var e;e=b8e.Object.extends({num:0,add:function(){if(!arguments||arguments.length<1)b8e.error("selectNum.add \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570");else for(var e=0,t=arguments.length;e<t;e++)this.num=this.num|Math.pow(2,arguments[e])},rmv:function(){if(!arguments||arguments.length<1)b8e.error("selectNum.rmv \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570");else for(var e=0,t=arguments.length;e<t;e++)this.num=this.num&~Math.pow(2,arguments[e])},contais:function(){if(arguments&&!(arguments.length<1)){for(var e=0,t=0,a=arguments.length;t<a;t++)if(e=Math.pow(2,arguments[t]),(this.num&e)!=e)return!1;return!0}b8e.error("selectNum.contais \u6ca1\u6709\u4f20\u5165\u4efb\u4f55\u53c2\u6570")}}),b8e.RC("$$game","$$selectNum",e)}(),function(){var s=game.ServerItemUtil=function(){};s._itemInfos=[],s.analyzeItems=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(0==t){s._clearItemInfos()}var i=e.useritem?e.useritem:e.rewards;if(i){s._analyzeAmounts(i.amounts,t),s._analyzeExp(e.exp,t),s._analyzeItems(i.items,t),s._analyzeItems(i.hufu,t)}else s._analyzeExp(e.exp,t);var n=a?104:0;return game.notice.showNoticeList(n),s._itemInfos},s._analyzeItems=function(e,t){var a,i;!e||e.length<1||e.forEach(function(e){if(0==t){(a=game.ItemInfo.get()).setData(e),s._itemInfos.push(a)}else game.notice.getNotice(e.id,e.num),(i=game.ItemInfoCfg.getData(e.id))&&i.preciousTips&&game.notice.showPreciousItemNotice(i)},this)},s._analyzeAmounts=function(e,t){var a;!e||e.length<1||(e.sort(s.amountsSort),e.forEach(function(e){if(0<e.updateNum){if(0==t){(a=game.ItemInfo.get()).id=game.AmountCfg.getItemId(e.type),a.num=e.updateNum,s._itemInfos.push(a)}else game.notice.amountNotice(e.type,e.updateNum)}},this))},s.amountsSort=function(e,t){var a=game.amount.getCfgByType(e.type),i=game.amount.getCfgByType(t.type);if(a&&i)return a.order-i.order;return 0},s._analyzeExp=function(e,t){if(!e||e<1);else if(0==t){var a=game.ItemInfo.get();a.id=220001,a.num=e,s._itemInfos.push(a)}else game.notice.amountNotice(game.AmountType.EXP,e)},s._clearItemInfos=function(){for(var e=s._itemInfos,t=0,a=e.length;t<a;t++){e[t].release()}s._itemInfos.length=0},s.analyzeGuajiItems=function(e,t,a){s._analyzeExp(e,a),s._analyzeItems(t,a)}}(),function(){var e=game.SpriteStatUtil=function(){};e.setDataByCfg=function(e){b8e.warn("game.SpriteStatUtil.setDataByCfg\u63a5\u53e3\uff0c\u5404\u81ea\u6a21\u5757\u7f13\u5b58\u3001\u7ef4\u62a4\u8fd9\u4e00\u4efd\u5c5e\u6027\u6570\u636e");var t=game.SpriteStat.get();return t.setupByCfg(e),t},e.setDataByServer=function(e){if(e&&!(e.length<=0)){for(var t=game.SpriteStat.get(),a=void 0,i=0,n=e.length;i<n;i++)(a=e[i])&&t.setStatValue(a.id,a.value);return t}},e.setAppendSpriteStat=function(e){var t=game.SpriteStat.get();return e.extraAtk&&t.setStatValue(game.SpriteStatType.Attack,e.extraAtk),e.extraDef&&t.setStatValue(game.SpriteStatType.Defense,e.extraDef),e.extraHp&&t.setStatValue(game.SpriteStatType.Health,e.extraHp),t},e.addSpriteStat=function(i,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(b8e.warn("game.SpriteStatUtil.addSpriteStat\u8bf7\u66f4\u6362\u6210spriteStat.addSpriteStat"),i=i||game.SpriteStat.get(),e){var t=e.getSpriteStats();t&&t.forEach(function(e,t){var a=i.getStatValue(e);a=a+=t*n,i.setStatValue(e,a)},this)}return i},e.sunSpriteStat=function(i,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(i=i||game.SpriteStat.get(),e){var t=e.getSpriteStats();t&&t.forEach(function(e,t){var a=i.getStatValue(e);a-=t*n,a|=0,i.setStatValue(e,a)},this)}return i},e.getAllSpriteStat=function(e){var t=(e=e||game.SpriteStat.get()).getSpriteStats();if(t)for(var a=game.SpriteStatType.Health;a<=game.SpriteStatType.Speed;++a)t.get(a)||t.set(a,0);return e},e.getSpriteStatDesc=function(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.Color.WHITE,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.Color.WHITE,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"<br/>",s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:":",o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"",r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1;if(!e)return"";var t=e.getSpriteStats();if(!t)return"";var g=void 0,l="",c=1;return t.forEach(function(e,t){2==(g=game.AttrRulesCfg.getData(+e)).format&&(t=100*t+"%"),0!=t&&(l+=c%r!=0?game.HtmlUtil.getText(a,g.name+s)+game.HtmlUtil.getText(i,t)+o:game.HtmlUtil.getText(a,g.name+s)+game.HtmlUtil.getText(i,t)+o+n),c++},this),l},e.getSpriteDefultStatDesc=function(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.Color.WHITE,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.Color.WHITE,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"<br/>",s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:":",o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"",r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,t=e.getSpriteStats(),g=void 0,l="",c=0;if(t.forEach(function(e,t){2==(g=game.AttrRulesCfg.getData(+e)).format&&(t=100*t+"%"),0!=t&&(l+=c%r!=0?game.HtmlUtil.getText(a,g.name+s)+game.HtmlUtil.getText(i,t)+o:game.HtmlUtil.getText(a,g.name+s)+game.HtmlUtil.getText(i,t)+o+n),c++},this),""==l)for(var h=1;h<=8;h++)g=game.AttrRulesCfg.getData(h),l+=game.HtmlUtil.getText(a,g.name+s)+game.HtmlUtil.getText(i,0)+o+n;return l},e.getSpriteStatArr=function(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,i=[];if(!e)return i;var t=e.getSpriteStats();if(!t)return i;var n=void 0,s=void 0;return t.forEach(function(e,t){n=game.AttrRulesCfg.getData(e),s=2==n.format?t*a+"%":t,0!=t&&i.push({name:n.name,value:s})},this),i}}(),function(){var l=game.TimeUtil={},c="";game.TimeMicroSeconds=["_$DAY_MICRO_SECONDS","_$HOUR_MICRO_SECONDS","_$MINUTE_MICRO_SECONDS","_$SECOND_MICRO_SECONDS"],l.formatTimeSpace=function(e){var t,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;c="";for(var i,n=0,s=e,o=b8e.TimeUtil,r=game.TimeMicroSeconds,g=0;g<4;g++)if(!(e<(i=o[b8e.getNormP(r[g])]))&&(t=s/i>>0,s%=i,c+=t+l.getTimeText(g),++n==a))return c;return""===c&&(c=game.Lang.get(9371)),c},l.formatTimeSpace2=function(e){var t,a=1<arguments.length&&void 0!==arguments[1]&&arguments[1];c="";for(var i,n=e,s=b8e.TimeUtil,o=game.TimeMicroSeconds,r=0;r<3;r++)t=n/(i=s[b8e.getNormP(o[r])])>>0,n%=i,2==r&&0<n&&(t+=1),(0<t||a)&&(c+=t+l.getTimeText(r)),0;return""===c&&(c=game.Lang.get(9371)),c},l.getTimeText=function(e){var t=void 0;switch(e){case 0:t=9359;break;case 1:t=9370;break;case 2:t=9361;break;case 3:t=9362}return t?game.Lang.get(t):""},l.getWeekText=function(e){var t=void 0;switch(e){case 1:t=9363;break;case 2:t=9364;break;case 3:t=9365;break;case 4:t=9366;break;case 5:t=9367;break;case 6:t=9368;break;case 7:t=9369}return t?game.Lang.get(t):""},l.createOpenTime=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"-",i=e.split(a),n={};return n.Start=i[0],n.End=i[1],n},l.isOpen=function(e,t){var a,i,n=e.length;if(n<1)return!0;for(var s=0;s<n;s++)if(a=b8e.TimeUtil.dateParse(e[s].Start,t).getTime(),(i=b8e.TimeUtil.dateParse(e[s].End,t).getTime())<a&&(i+=b8e.TimeUtil.DAY_MICRO_SECONDS),a<=game.SysTime.curTime&&i>game.SysTime.curTime)return!0;return!1},l.getOpenDayByStr=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss",a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=b8e.TimeUtil.dateParse(e,t).getTime();i=i/1e3>>0,i*=1e3;var n=game.miscData.openServerTime;if(a){if(i<n)return-1}else if(i<=n)return-1;return 1+((i-n)/b8e.TimeUtil.DAY_MICRO_SECONDS>>0)},l.getTimeByWeekStr=function(e){var t=e.split("|"),a=t[1].split(":"),i=+a[0],n=+a[1],s=game.SysTime.curTime,o=(0!=+t[0]?+t[0]:7)-(0!=b8e.TimeUtil.getDay(s)?b8e.TimeUtil.getDay(s):7)>>0;return b8e.TimeUtil.getTodayTime(s)+b8e.TimeUtil.HOUR_MICRO_SECONDS*i+b8e.TimeUtil.MINUTE_MICRO_SECONDS*n+o*b8e.TimeUtil.DAY_MICRO_SECONDS},l.getCountDown=function(e){var t=game.SysTime.curTime;return b8e.TimeUtil.getTodayTime(game.SysTime.curTime)+(e-game.miscData.openServerDay)*b8e.TimeUtil.DAY_MICRO_SECONDS-t},l.oneDay=864e5,l.getDateDiffDay=function(e,t){var a=new Date(e),i=new Date(t);return a.setHours(0,0,0,0),i.setHours(0,0,0,0),Math.abs(a.getTime()-i.getTime())/game.TimeUtil.oneDay>>0}}(),function(){var v=game.UpgradeUtil={};v.checkItemInfo=function(e,t){var a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(t<=game.itemData.getCountById(e))return!0;var i=game.ItemInfoCfg.getData(e);return i&&a&&v.showAccessTips(i),!1},v.showAccessTips=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e&&e.showAccess?e.shopGoodsId&&0<e.shopGoodsId.length?game.AccessShopView.inst().showView(e.id):game.AccessView.inst().showView(e.id):e?(t&&game.notice.show(7251,e.name),game.tipsData.setInfo(e),game.module.show(game.ME.ItemTips)):game.notice.show(113)},v.checkAmountById=function(e,t){var a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=game.ItemInfoCfg.getData(e);return i?i.isAmount?t<=game.itemData.getNumById(e)||(game.notice.show(7251,i.name),!1):i.cfgType!=game.ItemCfgType.Amount?(b8e.warn("\u4e0d\u5b58\u5728id\u5bf9\u5e94\u7684\u8d27\u5e01\uff0cid:"+e),!1):v.checkAmountByType(i.type,t,a):(b8e.warn("\u4e0d\u5b58\u5728id\u914d\u7f6e:"+e),!1)},v.checkAmountByType=function(e,t){var a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=game.amount.get(e),n=game.AmountCfg.getItemTipsKey(e);if(t<=i)return!0;if(a)if(e==game.AmountType.SILVER)game.module.show(game.ME.GetYinLiang);else if(e==game.AmountType.YUAN_BAO){game.moduleOpen.checkOpen(game.ME.Recharge)?game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE):game.notice.show(n)}else game.notice.show(n);return!1},v.checkItemList=function(e){var t,a,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,s=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(!e||e.length<=0)return!0;for(var o=e.length,r=0;r<o;r++)if((i=e[r])&&(a=i.Id,t=i.Num*n,!(game.ItemInfoCfg.getCfgTypeById(a)==game.ItemCfgType.Amount?v.checkAmountById(a,t,s):v.checkItemInfo(a,t,s))))return!1;return!0},v.checkFosterUpgrade=function(e,t,a){var i,n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return(i=v.checkAmountByType(game.AmountType.SILVER,a,n))?v.checkItemInfo(e,t,!s):i},v.checkItemWithAutoBuy=function(e,t){var a,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],n=4<arguments.length&&void 0!==arguments[4]&&arguments[4],s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:null;a=!i;var g=v.checkItemInfo(e,t,a);return g||!i?g:game.UpgradeUtil.autoBuy(e,t,n,s,o,r)},game.tmpAutoBuyObj={thisArg:null,cancelCb:null,autoBuyData:null,sureCb:null},v.autoBuy=function(e,t,a,i,n,s){var o=!(6<arguments.length&&void 0!==arguments[6])||arguments[6],r=game.ItemInfoCfg.getData(e);if(!r)return!1;var g=r.shopGoodsId;if(!g||g.length<1)return b8e.error("UpgradeUtil.autoBuy \u81ea\u52a8\u8d2d\u4e70\u6ca1\u6709\u914d\u7f6e\u5546\u54c1id goodsId, itemId:",e),!1;for(var l,c,h,m,u,d,f=g.length,p=0;p<f;p++){if(l=g[p],!(c=game.ShopItemCfg.getDataByGoodsId(l)))return!0;if(d=c.shopId==game.ShopIdEnum.YUANBAO_SHOP,h=t-game.itemData.getNumById(e),m=Math.ceil(h/c.itemNum),u=v.checkItemList(c.costItems,m,!1))break}if(!u)return o&&game.notice.show(7251,r.name),0;if(d&&!a){var _=game.tmpAutoBuyObj;_.thisArg=i,_.cancelCb=n,_.sureCb=s,_.autoBuyData=game.tmpAutoBuyData,game.alert.show({msg:game.Lang.get(9372),args:_,okcb:function(e){var t=e.thisArg;e.sureCb.call(t)},cancelcb:function(e){var t=e.thisArg;e.cancelCb.call(t)},align:1,thisArg:i})}return d?1:2},v.checkEquipTooMuch=function(){var e=game.equipData.getEquipMaxCount()-game.equipData.getIdxCount()<20;return e&&game.alert.show({msg:game.Lang.get(52212),title:game.Lang.get(52211),btn:game.Lang.get(52213),okcb:function(){game.module.show(game.ME.Sell)},align:1,thisArg:v}),e},v.checkUpgradeCost=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!e||!e.length)return!0;for(var a=void 0,i=!0,n=0,s=e.length;n<s;n++)if(a=e[n]){var o=game.ItemInfoCfg.getData(a.Id);if(o){if(!(i=o.cfgType==game.ItemCfgType.Amount?v.checkAmountByType(o.type,a.Num,t):v.checkItemInfo(a.Id,a.Num,t)))return i}else b8e.warn("\u4e0d\u5b58\u5728id\u914d\u7f6e:"+id)}return i},v.checkItemByCostArr=function(e){if(!e||!e.length)return null;for(var t=void 0,a=0,i=e.length;a<i;a++)if(t=e[a]){var n=game.ItemInfoCfg.getData(t.Id);if(n){if(n.cfgType!=game.ItemCfgType.Amount)return t}else b8e.warn("\u4e0d\u5b58\u5728id\u914d\u7f6e:"+id)}return null},v.checkAmountByCostArr=function(e){if(!e||!e.length)return null;for(var t=void 0,a=0,i=e.length;a<i;a++)if(t=e[a]){var n=game.ItemInfoCfg.getData(t.Id);if(n){if(n.cfgType==game.ItemCfgType.Amount)return t}else b8e.warn("\u4e0d\u5b58\u5728id\u914d\u7f6e:"+id)}return null}}(),function(){var e=game.TweenUtil=function(){};e.rotationEffect=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:359,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:3e3;e.node.rotation=0,b8e.Tween.kill(e),b8e.Tween.get(e,{loop:!0}).to({rotation:t},a)},e.trunCardEffect=function(e,t,a,i,n,s){e&&i&&t&&a&&(b8e.Tween.kill(e),b8e.Tween.get(e).to({scaleX:0},275).call(t,i,n).to({scaleX:1},275).call(a,i,s))}}(),function(){var e=void 0;(e=b8e.Object.extends({creatDiscountShopAlert:function(e){var t=e;if(!t.discountShopAlert){var a=game.Lang.get(6314),i=game.Lang.get(6532);t.discountShopAlert={msg:a,key:game.AlertKey.FOSTER_DISCOUNT_SHOP,okcb:game.autoBuyMgr.dSOkCb,cancelcb:game.autoBuyMgr.dSCancelCb,thisArg:t,btn:i,btnReverse:!0,showtips:!0,cancelCloseCb:!0,cancelIsSaveTips:!0,defaultSelect:!0,align:b8e.HorizontalAlign.CENTER}}},dSOkCb:function(){this.isPass?this.upgradeCallback(!0):game.alert.show(this.yuanbaoAlert)},dSCancelCb:function(e,t){t||game.autoBuyMgr.discountShopBtn(this.fosterType,this),this.upgradeCallback(!1)},discountShopBtn:function(e,t){var a=t;a.obj||(a.obj={openServerType:game.OpenServerType.MYSTERY_SHOP}),a.obj.openServerType=e?game.OpenServerType.DISCOUNT_SHOP:game.OpenServerType.MYSTERY_SHOP,a.dptG(game.OpenServerGEvts.C2C_SHOW_OPENSERVER,a.obj)},creatYuanbaoAlert:function(e){var t=e,a=game.Lang.get(6315);t.yuanbaoAlert||(t.yuanbaoAlert={msg:a,okcb:game.autoBuyMgr.sureCb,cancelcb:game.autoBuyMgr.cancelCb,thisArg:t})},sureCb:function(){this.upgradeCallback(!0)},cancelCb:function(){this.upgradeCallback(!1)},autoBuyBegin:function(e,t,a,i,n,s,o,r,g){this.creatYuanbaoAlert(s);var l=game.UpgradeUtil.checkAmountByType(game.AmountType.SILVER,a,!0);if(!l)return i&&g.call(s,!1),!1;if(l=game.UpgradeUtil.checkItemInfo(e,t,!i))s.autoType=0;else{if(!i)return n&&g.call(s,!1),!1;var c=s.isPass;if(s.autoType=game.UpgradeUtil.autoBuy(e,t,c,s,s.cancelCb,s.sureCb),0==s.autoType)return i&&g.call(s,!1),!1;if(1==s.autoType&&!c)return!1}return!0},fosterAutoBuyBegin:function(e,t,a,i,n,s,o,r,g,l){this.creatYuanbaoAlert(s),this.creatDiscountShopAlert(s);var c=game.UpgradeUtil.checkAmountByType(game.AmountType.SILVER,a,!0);if(!c)return i&&o.call(s,!1),!1;if(c=game.UpgradeUtil.checkItemInfo(e,t,!i))s.autoType=0;else{if(!i)return n&&o.call(s,!1),s.isPass=!1,s.isPass;var h=s.isPass;if(s.autoType=this.autoBuy(e,t,h,s,o),0==s.autoType)return n&&o.call(s,!1),s.isPass=!1;if(1==s.autoType){if(!h)return!1;if(isHasShop&&!dontShowShopTips)return game.alert.show(s.discountShopAlert),!1}if(-1==s.autoType)return n&&o.call(s,!1),!1}return!0},autoUpgrade:function(e,t,a,i,n,s,o){this.creatYuanbaoAlert(s);var r=game.UpgradeUtil.checkAmountByType(game.AmountType.SILVER,a,!0);if(!r)return(i||n)&&o.call(s,!1),!1;if(r=game.UpgradeUtil.checkItemInfo(e,t,!i))s.autoType=0;else{if(!i)return n&&o.call(s,!1),s.isPass=!1,s.isPass;var g=s.isPass;if(s.autoType=this.autoBuy(e,t,g,s,o),0==s.autoType)return n&&o.call(s,!1),s.isPass=!1;if(1==s.autoType&&!g)return!1;if(-1==s.autoType)return n&&o.call(s,!1),!1}return!0},autoBuy:function(e,t,a,i,n){var s=game.ItemInfoCfg.getData(e);if(!s)return-1;var o=s.shopGoodsId;if(!o||o.length<1)return-1;for(var r=o.length,g=void 0,l=void 0,c=void 0,h=void 0,m=void 0,u=void 0,d=0;d<r;d++){if(g=o[d],!(l=game.ShopItemCfg.getDataByGoodsId(g)))return-1;if(u=l.shopId==game.ShopIdEnum.YUANBAO_SHOP,c=t-game.itemData.getNumById(e),h=Math.ceil(c/l.itemNum),m=game.UpgradeUtil.checkItemList(l.costItems,h,!1))break}if(!m)return game.notice.show(7251,s.name),-1;if(u&&!a){this.obj||(this.obj={});var f=this.obj;f.thisArg=i,f.callback=n;var p=game.Lang.get(6315);game.alert.show({msg:p,args:f,okcb:function(e){var t=e.thisArg;e.callback.call(t,!0)},cancelcb:function(e){var t=e.thisArg;e.callback.call(t,!1)},align:1,thisArg:this,isTouchClose:!1})}return u?1:2},cultivateAutoBuyBegin:function(e,t,a,i,n,s,o,r){this.creatYuanbaoAlert(i),this.creatDiscountShopAlert(i);for(var g=0,l=0,c=void 0,h=0,m=e.length;h<m;h++){if(c=e[h],game.ItemInfoCfg.getCfgTypeById(c.Id)==game.ItemCfgType.Amount){if(!game.UpgradeUtil.checkAmountById(c.Id,c.Num,!0))return(t||a)&&n.call(i,!1),!1}else g=c.Id,l=c.Num}if(game.UpgradeUtil.checkItemInfo(g,l,!t))i.autoType=0;else{if(!t)return a&&n.call(i,!1),i.isPass=!1,i.isPass;var u=i.isPass;if(i.autoType=this.autoBuy(g,l,u,i,n),0==i.autoType)return a&&n.call(i,!1),i.isPass=!1;if(1==i.autoType){if(!u)return!1;if(isHasShop&&!dontShowShopTips)return game.alert.show(i.discountShopAlert),!1}if(-1==i.autoType)return a&&n.call(i,!1),!1}return!0}}))._inst=null,e.inst=function(){return null==e._inst&&(e._inst=new e),e._inst},game.autoBuyMgr=e.inst(),b8e.RC("$$game","$$AutoBuyMgr",e)}(),function(){var g=game.SearchUtil=function(){};g.binSearch=function(e,t,a){if(!e||e.length<1)return a?null:-1;var i=e[0];if(i&&t==i[a])return i;if((i=e[e.length-1])&&t==i[a])return i;a=a&&b8e.getNormP(a);for(var n=0,s=e.length-1,o=void 0,r=void 0;n<=s;)if(i=e[o=Math.floor(n+(s-n)/2)])if(t<(r=a?i[a]:i))s=o-1;else{if(!(r<t))return i;n=o+1}return a?null:-1},g.findFirstEqual=function(e,t,a){if(!e||e.length<1)return a?null:-1;a=a&&b8e.getNormP(a);for(var i=g._findFirstEqualCount=0,n=e.length-1,s=void 0,o=void 0,r=void 0;i<=n;)(o=e[s=Math.floor(i+(n-i)/2)])&&(t<(r=a?o[a]:o)?n=s-1:r<t?i=s+1:n=s-1);if(a){if(i<e.length&&e[i][a]==t)return i}else if(i<e.length&&e[i]==t)return i;return a?null:-1},g.fingLastEqual=function(e,t,a){if(!e||e.length<1)return a?null:-1;a=a&&b8e.getNormP(a);for(var i=0,n=e.length-1,s=void 0,o=void 0,r=void 0;i<=n;)(o=e[s=Math.floor(i+(n-i)/2)])&&(t<(r=a?o[a]:o)?n=s-1:i=s+1);return r=a?e[n][a]:e[n],0<=n&&r==t?n:a?null:-1},g.findLastEqualSmaller=function(e,t,a){if(!e||e.length<1)return a?null:-1;a=a&&b8e.getNormP(a);for(var i=0,n=e.length-1,s=void 0,o=void 0;i<=n;)(o=e[s=Math.floor(i+(n-i)/2)])&&(t<(a?o[a]:o)?n=s-1:i=s+1);return e[n=-1<n?n:0]},g.findLastSmaller=function(e,t,a){if(!e||e.length<1)return a?null:-1;a=a&&b8e.getNormP(a);for(var i=0,n=e.length-1,s=void 0,o=void 0,r=void 0;i<=n;)(o=e[s=Math.floor(i+(n-i)/2)])&&(t<(r=a?o[a]:o)?n=s-1:i=r<t?s+1:s-1);return e[n=-1<n?n:0]},g.findFirstEqualLarger=function(e,t,a){if(!e||e.length<1)return a?null:-1;a=a&&b8e.getNormP(a);var i=e[0],n=a?i[a]:i;if(t<=n)return a?i:n;for(var s=g._findFirstEqualLargerCount=0,o=e.length-1,r=void 0;s<=o;)(i=e[r=Math.floor(s+(o-s)/2)])&&(t<(n=a?i[a]:i)?o=r-1:n<t?s=r+1:o=r-1);return e[s=-1<s?s:0]},g.findFirstLarger=function(e,t,a){if(!e||e.length<1)return a?null:-1;a=a&&b8e.getNormP(a);var i=e[0],n=a?i[a]:i;if(t<n)return a?i:n;for(var s=0,o=e.length-1,r=void 0;s<=o;)(i=e[r=Math.floor(s+(o-s)/2)])&&(t<(n=a?i[a]:i)?o=r-1:s=r+1);return e[s=-1<s?s:0]}}(),function(){var e=game.LabelUtil=function(){};e.setEditBoxDefault=function(t,e,a,i,n,s,o){if(t&&i&&e){var r=i,g=t.__editBoxPreLab;g||((g=t.__editBoxPreLab=b8e.Label.get()).addToParent(t),g.setAnchor(.5,.5),g.setColor(a)),g.string=game.Lang.get(e);var l=0;switch(n){case 2:l=t.width-g.width/2;break;case 0:l=(g.width-t.width)/2}g.x=l,g.active=""==t.string;t.onEditingEnded(),t.onEditingBegan(),t.onEditingEnded(function(){s&&s.call(i),g.active=""==t.string},r),t.onEditingBegan(function(){o&&o.call(i),g.active=!1},r),t.setEditBoxText?b8e.error("\u5df2\u7ecf\u6709\u4e86setEditBoxText,\u4e0d\u8981\u4e8c\u6b21\u8bbe\u7f6e"):t.setEditBoxText=function(e){t.setText(e),g.active=""==t.string}}},e.cancelEditBoxDefault=function(e,t,a,i,n){if(e&&a){var s=e.__editBoxPreLab;s&&s.parent&&(s.string="",s.removeFromParent(),e.__editBoxPreLab=null),e.onEditingEnded(),e.onEditingBegan()}}}(),function(){var e;e=b8e.BaseDisplay.extends({getTitleBg:function(){var e=b8e.Sprite.get();return e.setAnchor(.5,.5),e.setPosition(0,-23),e.setSize(262,32),e.setStyle(b8e.SpriteStyle.SLICED),e.scale9Inset={top:0,bottom:0,left:59,right:33},e.loadTexture(game.ResCfg.getUrl(10020)),e},getTitleText:function(){var e=this.getLabel(22);return e.setAnchor(.5,.5),e.setColor(game.Color.BLACK),e.setPosition(0,-2),e},getLabel:function(e,t){var a=0<arguments.length&&void 0!==e?e:22,i=1<arguments.length&&void 0!==t?t:game.Color.BLACK,n=b8e.Label.get();return n.setFontSize(a),n.setColor(i),n.setLineHeight(a+2),n},getRichLabel:function(e){var t=0<arguments.length&&void 0!==e?e:22,a=b8e.RichText.get();return a.setFontSize(t),a.setLineHeight(t+2),a}}),b8e.RC("$$game","$$compModel",e)}(),function(){var e;e=game.compModel.extends({_progressWidth:600,_progressHeight:200,_progressForeImg:null,_progressBackImg:null,isShowExpend:!1,_type:0,_cur:0,_target:0,_duration:150,ctor:function(e,t,a,i,n){var s=0<arguments.length&&void 0!==e?e:515,o=1<arguments.length&&void 0!==t?t:30,r=2<arguments.length&&void 0!==a?a:-30,g=3<arguments.length&&void 0!==i?i:game.proGressType.Foster,l=!(4<arguments.length&&void 0!==n)||n;this._super(),this._progressWidth=s,this._progressHeight=o,this._type=g,this.setProSize(s,o),this.setGround(r),this.setLight(),l&&this.setProLab(),this.setAnchor(.5,.5)},setProSize:function(e,t){this.setSize(e+10,t+10)},setGround:function(e){var t=this;if(!t._type)return t._progressForeImg&&t._progressForeImg.setVisible(!1),void(t._progressBackImg&&t._progressBackImg.setVisible(!1));t._progressForeImg||(t._progressForeImg=b8e.Sprite.get(),t._progressForeImg.setStyle(b8e.SpriteStyle.SLICED),t._progressForeImg.setAnchor(0,.5),t._progressForeImg.x=9,t._progressForeImg.y=1),t._progressBackImg||(t._progressBackImg=b8e.Sprite.get(),t._progressBackImg.setStyle(b8e.SpriteStyle.SLICED),t._progressBackImg.setAnchor(0,.5)),t._progressBackImg&&!t._progressBackImg.parent&&t.addChild(t._progressBackImg),t._progressForeImg&&!t._progressForeImg.parent&&(t._progressBackImg.addChild(t._progressForeImg),t._progressBackImg.setPosition(.5*-t.width,e));var a=void 0,i=void 0;1==t._type&&(a=game.ResCfg.getUrl(10022),i=game.ResCfg.getUrl(10023)),t._progressBackImg.setVisible(!0),t._progressBackImg.scale9Inset={top:0,bottom:0,left:57,right:57},t._progressBackImg.loadTexture(i),t._progressBackImg.setSize(t._progressWidth,t._progressHeight),t._progressForeImg.setVisible(!0),t._progressForeImg.scale9Inset={top:0,bottom:0,left:8,right:8},t._progressForeImg.setSize(t._progressWidth-20,t._progressHeight-20),t._progressForeImg.loadTexture(a)},setLight:function(){},setProLab:function(e,t,a){var i=0<arguments.length&&void 0!==e?e:0,n=1<arguments.length&&void 0!==t?t:22,s=2<arguments.length&&void 0!==a?a:game.Color.BLACK,o=this;o._labText||(o._labText=o.getLabel(n,s),o._labText.setAnchor(.5,.5)),o._labText&&!o._labText.parent&&o._progressBackImg.addChild(o._labText),o._labText.setVisible(!0),o._labTextCor!=s&&(o._labTextCor=s,o._labText.setColor(s)),o._labTextStr!=i&&(o._labTextStr=i,o._labText.setText(i)),o._labText.setPosition(o._progressWidth/2,0)},updatePro:function(e,t,a){var i=2<arguments.length&&void 0!==a&&a;this._cur=e;var n=void 0;n=0!=(this._target=t)?Math.min(e/t,1)*(this._progressWidth-18):0,this.setProgressVal(n);var s="";s=i?0==t||0==e?"0%":parseInt(e/t*100)+"%":e+"/"+t,this._labText&&this._labText.setText(s)},setProgressVal:function(e){b8e.Tween.kill(this),b8e.Tween.get(this._progressForeImg).to({width:e},this._duration)},setHide:function(){this._progressBackImg||this._progressBackImg.setVisible(!1),this._progressBackImg||this._progressForeImg.setVisible(!1),this._progressBackImg||this._labText.setVisible(!1)}});b8e.RC("$$game","$$Progress",e)}(),function(){var e;e=b8e.Enum({None:0,Foster:1}),b8e.RC("$$game","$$proGressType",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_renderItem:null,_viewWidth:0,_bindME:0,ctor:function(e,t,a,i){var n=1<arguments.length&&void 0!==t?t:0,s=2<arguments.length&&void 0!==a?a:145,o=3<arguments.length&&void 0!==i?i:480,r=this;r._super(),r._renderItem=e,r._viewWidth=o,r._bindME=n,r.setSize(o,s),r.createList(),r.createBtn(),r.setAnchor(0,1),b8e.evt.onC(r._leftBtn,r.leftBtn,r),b8e.evt.onC(r._rightBtn,r.rightBtn,r),b8e.evt.addButtonHandler(r._leftBtn),b8e.evt.addButtonHandler(r._rightBtn)},createList:function(){var e=this;e._list||(e._list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal)),e._list.itemRender=e._renderItem,e._list.bindEnum=e._bindME,e._list.layout.paddingLeft=0,e._list.layout.paddingTop=0,e._list.setScrollViewCb(e._listCb,e),e.addChild(e._list)},createBtn:function(){var e=this;e._leftBtn||(e._leftBtn=b8e.Sprite.get()),e._leftBtn&&!e._leftBtn.parent&&(e.addChild(e._leftBtn),e._leftBtn.setPosition(0,.5*-e.height),e._leftBtn.setAnchor(.5,.5),e._leftBtn.setScale(1,1),e._leftBtn.isButton=!0),e._rightBtn||(e._rightBtn=b8e.Sprite.get()),e._rightBtn&&!e._rightBtn.parent&&(e.addChild(e._rightBtn),e._rightBtn.setPosition(e._viewWidth,.5*-e.height),e._rightBtn.setAnchor(.5,.5),e._rightBtn.setScale(-1,1),e._rightBtn.isButton=!0),e._leftBtn.setVisible(!0),e._rightBtn.setVisible(!0);var t=game.ResCfg.getUrl(5068);e._leftBtn.loadTexture(t),e._rightBtn.loadTexture(t),e._leftAlertImg||(e._leftAlertImg=b8e.Sprite.get()),e._leftAlertImg&&!e._leftAlertImg.parent&&(e._leftBtn.addChild(e._leftAlertImg),e._leftAlertImg.setPosition(e._leftBtn.width-e._leftAlertImg.width,10)),e._rightAlertImg||(e._rightAlertImg=b8e.Sprite.get()),e._rightAlertImg&&!e._rightAlertImg.parent&&(e._rightBtn.addChild(e._rightAlertImg),e._rightAlertImg.setPosition(e._rightBtn.width-e._rightAlertImg.width,10));var a=game.ResCfg.getUrl(5067);e._rightAlertImg.loadTexture(a),e._leftAlertImg.loadTexture(a)},_listCb:function(e,t,a){var i=0,n=!1,s=!1;if(n=0<(i=e.length),this._leftBtn&&(this._leftBtn.active=n),n)for(var o=0;o<i;o++)if(e[o].isAlert){s=!0;break}var r=!1;if(n=0<(i=a.length),this._rightBtn&&(this._rightBtn.active=n),n)for(var g=0;g<i;g++)if(a[g].isAlert){r=!0;break}this.isShowAlert(s,r)},isShowAlert:function(e,t){this._leftAlertImg.setVisible(e),this._rightAlertImg.setVisible(t)},leftBtn:function(){this._list.scrollContainerLeft()},rightBtn:function(){this._list.scrollContainerRight()},setData:function(e){this._list.setData(e)},scrollLeft:function(){this._list.scrollToLeft(0,200)}});b8e.RC("$$game","$$HeadScroll",e)}(),function(){var e,r="curlab_";e=game.compModel.extends({_isShow:!0,_titlIsShow:!0,_bgWidth:0,_textIndex:0,ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:200,i=1<arguments.length&&void 0!==t?t:190;this._super(),this.setSize(a,i),this.createBg(a,i),this._bgWidth=a,this.setAnchor(0,1)},createBg:function(e,t){var a=this;a.bg1||(a.bg1=b8e.Sprite.get()),a.bg1&&!a.bg1.parent&&(a.addChild(a.bg1),a.bg1.setPosition(0,0),a.bg1.setAnchor(0,1),a.bg1.setSize(e,t),a.bg1.setStyle(b8e.SpriteStyle.SLICED),a.bg1.scale9Inset={top:29,bottom:29,left:32,right:32}),a.titleBg_1||(a.titleBg_1=a.getTitleBg()),a.titleBg_1&&!a.titleBg_1.parent&&(a.titleBg_1.setPosition(.5*e,-18),a.addChild(a.titleBg_1)),a.bg1.setVisible(!0),a.titleBg_1.setVisible(!0);var i=game.ResCfg.getUrl(5069);a.bg1.loadTexture(i),a.title1||(a.title1=b8e.Label.get()),a.title1&&!a.title1.parent&&a.addChild(a.title1),a.title1.setFontSize(20),a.title1.setLineHeight(24),a.title1.setAnchor(.5,1),a.title1.setColor(game.Color.WHITE),a.title1.setPosition(.5*e,-9),a.title1.setText(game.Lang.get(9613)),a.titleBg_1.setSize(a.title1.width+50,32)},updateCom:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=this,n=0;i._textIndex=0,e.forEach(function(e,t){a&&(t=0),e=+e,n++,i._textIndex++,i.setAttrText(e,t,n)},i);var s=i._titlIsShow?30*n+32:30*n;i.bg1.height=s,i._bgHeight=s},updateComByArray:function(e,t,a){var i=2<arguments.length&&void 0!==a&&a,n=t.length,s=void 0;this._textIndex=n;for(var o=void 0,r=0;r<n;r++)s=+(s=t[r]),o=i?0:e.get(s),this.setAttrText(s,o,r+1);var g=this._titlIsShow?30*this._textIndex+32:30*this._textIndex;this.bg1.height=g,this._bgHeight=g},setAttrText:function(e,t,a){var i,n=this,s=game.SpriteStatType,o=game.AttrRulesCfg.getData(e);n[r+a]||(n[r+a]=n.getRichLabel()),n[r+a]&&!n[r+a].parent&&(n.addChild(n[r+a]),n[r+a].setAnchor(.5,.5)),e!=s.Damage&&e!=s.DamageRes&&e!=s.CritDamage&&e!=s.CritDamageRes&&e!=s.PvpDamage&&e!=s.PvpDamageRes&&e!=s.PveDamage&&e!=s.PveDamageRes||(t+="%"),i=n._titlIsShow?-28*a-20:-24*a,n[r+a].setPosition(.5*n._bgWidth,i),n[r+a].setText(game.Lang.get(8210,o.name,t))},setTitle:function(e){var t=0<arguments.length&&void 0!==e?e:"";t&&this.title1.setText(t)},setBgVisible:function(e){var t=0<arguments.length&&void 0!==e&&e;this._isShow=t,this.bg1.setVisible(t)},setTitleBgVisible:function(e){var t=0<arguments.length&&void 0!==e&&e;this.titleBg_1.setVisible(t)},setTitleVisible:function(e){var t=0<arguments.length&&void 0!==e&&e;this._titlIsShow=t,this.title1.setVisible(t),this.titleBg_1.setVisible(t)},setAttrVisible:function(e){for(var t=!(0<arguments.length&&void 0!==e)||e,a=1;a<=this._textIndex;a++)this[r+a].active=t}});b8e.RC("$$game","$$attributeCom",e)}(),function(){var e;e=game.compModel.extends({_activeWidth:580,_activeHeight:190,_titleBgImg:null,_titleText:null,_activeBtn:null,_activeAlert:null,_activeText:null,_itemIcon:null,_iconName:null,_iconNum:null,_pathText:null,_pathBtn:null,_activeback:null,_pathback:null,_thisArg:null,ctor:function(e,t){var a=0<arguments.length&&void 0!==e?e:580,i=1<arguments.length&&void 0!==t?t:190,n=this;n._super(),n._activeWidth=a,n._activeHeight=i,n.createTitle(),n.creatBtn(),n.creatItem(),n.creatPath(),n.setAnchor(.5,0),n.setActiveHeight(a,i),b8e.evt.onC(n._activeBtn,n.activeBtn,n),b8e.evt.onC(n._pathBtn,n.activePath,n),b8e.evt.addButtonHandler(n._activeBtn)},createTitle:function(){this._titleBgImg=this.getTitleBg(),this.addChild(this._titleBgImg),this._titleText=this.getTitleText(),this._titleBgImg.addChild(this._titleText)},creatBtn:function(){var e=this;e._activeBtn||(e._activeBtn=b8e.Sprite.get(),e._activeBtn.setAnchor(.5,.5),e._activeBtn.loadTexture(game.ResCfg.getUrl(10021)),e._activeBtn.setSize(128,60),e._activeBtn.setStyle(b8e.SpriteStyle.SLICED),e._activeBtn.scale9Inset={top:31,bottom:27,left:57,right:21},e._activeBtn.isButton=!0,e.addChild(e._activeBtn)),e._activeText||(e._activeText=e.getLabel(22),e._activeText.setAnchor(.5,.5),e._activeText.setPosition(0,0),e._activeText.string=game.Lang.get(6626),e._activeBtn.addChild(e._activeText)),e._activeAlert||(e._activeAlert=b8e.Sprite.get(),e._activeAlert.setPosition(60,24),e._activeAlert.setAnchor(.5,.5),e._activeAlert.loadTexture(game.ResCfg.getUrl(5067)),e._activeBtn.addChild(e._activeAlert))},creatItem:function(){var e=this;e._itemIcon||(e._itemIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),e._itemIcon.setAnchor(.5,.5),e.addChild(e._itemIcon)),e._iconName||(e._iconName=e.getRichLabel(22),e._iconName.setAnchor(0,.5),e.addChild(e._iconName)),e._iconNum||(e._iconNum=e.getRichLabel(22),e._iconNum.setAnchor(0,.5),e.addChild(e._iconNum))},creatPath:function(){var e=this;e._pathText||(e._pathText=e.getRichLabel(22),e._pathText.setAnchor(.5,.5),e._pathText.setPosition(0,30),e.addChild(e._pathText)),e._pathBtn||(e._pathBtn=b8e.Sprite.get(),e._pathBtn.setAnchor(.5,.5),e._pathBtn.isButton=!0,e._pathBtn.setPosition(0,30),e.addChild(e._pathBtn))},setTitleText:function(e){this._titleText.string=e},setTitleActive:function(e){var t=!(0<arguments.length&&void 0!==e)||e;this._titleText.active=t,this._titleBgImg.active=t},setItemIcon:function(e){this._costCfg=game.ItemInfoCfg.getData(e),this._itemIcon.setItemInfo(this._costCfg,!1,!1),this._itemIcon.setNum(0);var t=game.HtmlUtil.getColorStrByQuality(this._costCfg.quality,this._costCfg.name);this._iconName.string=t},setBtnTitle:function(e){this._activeText.string=e},setCostNum:function(e){this._iconNum.string=game.Lang.get(9616,e)},setPathTitle:function(e){this._pathText.string=game.Lang.get(9615,e),this._pathBtn.setSize(this._pathText.width+10,this._pathText.height+10)},setPathActive:function(e){var t=!(0<arguments.length&&void 0!==e)||e;this._pathBtn.active=t},setActiveAlert:function(e){this._activeAlert.active=e},setActiveHeight:function(e,t){this._activeWidth=e,this._activeHeight=t,this._titleBgImg.setPosition(0,t-34),this._activeBtn.setPosition(.36*e,.41*t),this._itemIcon.setPosition(.41*-e,.41*t),this._iconName.setPosition(.3*-e,.5*t+20),this._iconNum.setPosition(.3*-e,.5*t-20)},onActiveFunc:function(e,t){this._activeback=e,this._thisArg=t},onPathFunc:function(e,t){this._pathback=e,this._thisArg=t},activeBtn:function(){this._activeback.call(this._thisArg)},activePath:function(){this._pathback.call(this._thisArg)},iconBtn:function(){this._costCfg&&(game.tipsData.setInfo(this._costCfg),game.module.show(game.ME.ItemTips))}}),b8e.RC("$$game","$$NoActiveModel",e)}(),function(){var e;e=game.compModel.extends({_btnImg:null,_alertImg:null,_moduleNum:null,_spotAlertEnum:null,ctor:function(e,t,a){var i=this;i._super(),i.setSize(104,98),i.setAnchor(.5,.5),i.creatBtn(),i.creatAlert(),i.setBtnModule(e,t),i.cfg=a,b8e.evt.onC(i,i.showView,i),b8e.evt.addButtonHandler(i)},creatBtn:function(){this._btnImg||(this._btnImg=b8e.Sprite.get()),this._btnImg.setStyle(b8e.SpriteStyle.SIMPLE),this._btnImg.setAnchor(.5,.5),this._btnImg.setPosition(0,0),this._btnImg.isButton=!0,this.addChild(this._btnImg)},creatAlert:function(){this._alertImg||(this._alertImg=b8e.Sprite.get()),this._alertImg.setStyle(b8e.SpriteStyle.SIMPLE),this._alertImg.setAnchor(.5,.5),this._alertImg.setPosition(26,33),this._alertImg.loadTexture(game.ResCfg.getUrl(5067)),this._alertImg.setVisible(!1),this.addChild(this._alertImg)},setBtnModule:function(e,t){this._moduleNum=e,this._spotAlertEnum=t,this.bindAlert()},bindAlert:function(){this._spotAlertEnum&&!this._bindAlert&&(game.spotAlert.setCb(this._spotAlertEnum,this.updateAlert,this),this._bindAlert=!0)},updateAlert:function(e){e?this.setRedIcon(game.SpotAlertCfg.isOpen(e.type)&&e.alert):this.setRedIcon(!1)},setRedIcon:function(e){var t=0<arguments.length&&void 0!==e&&e;this._alertImg&&this._alertImg.setVisible(t)},setBtnImg:function(e){this._btnImg||this.creatBtn(),this._btnImg.loadTexture(e)},showView:function(){var e=this._moduleNum;e&&(game.moduleOpen.checkOpenWithTips(e)?(b8e.module.isShowView(e)&&game.module.hide(e),b8e.module.sendToView(game.ME.MainUIBottom,[game.MainUIEvts.V_SET_HONGYAN_HIDE]),game.module.show(e)):b8e.module.sendToView(game.ME.MainUIBottom,[game.MainUIEvts.V_SET_HONGYAN_OPEN]))}});b8e.RC("$$game","$$MainBottom",e)}(),function(){var e;e=b8e.BaseDisplay.extends({ctor:function(e,t,a){var i=2<arguments.length&&void 0!==a?a:1;this._super(),this._itemPool=[],this._width=i?e.width:e.height,this._spacing=t,this._toDirection=i,this.creatList()},creatList:function(){for(var e=(this._width-game.IconSizeEnum.GRID_SIZE_105)/(game.IconSizeEnum.GRID_SIZE_105+this._spacing)|2,t=void 0,a=0;a<e;a++)(t=this._itemPool[a])||((t=game.GridUtil.createItemIcon()).addToParent(this),this._itemPool[a]=t);this._lastTag=e-1},setData:function(e){var t=this;t._awardList=e;for(var a=game.IconSizeEnum.GRID_SIZE_105,i=a/2,n=void 0,s=void 0,o=0,r=t._itemPool.length;o<r;o++)if(n=e[o]){if(!(s=t._itemPool[o]))return void b8e.warn("item\u672a\u521d\u59cb\u5316\uff01");t._toDirection?s.setPosition(i+(a+t._spacing)*o,-i):s.setPosition(i,-i-(a+t._spacing)*o),game.GridUtil.setItemIcon(s,n,!1,game.IconLayoutEnum.SHOW_NUM)}t._timer?(t._timer.reset(),t._timer.start()):t._timer=b8e.Timer.add(t,t.updateTimer,50)},updateTimer:function(){for(var e=void 0,t=0,a=this._itemPool.length;t<a;t++)(e=this._itemPool[t])&&(this._toDirection?e.setPosition(e.x-1,e.y):e.setPosition(e.x,e.y+1));var i=this._itemPool[0];(this._toDirection?-i.x:i.y)>game.IconSizeEnum.GRID_SIZE_105/2&&this.resetItemInfo()},resetItemInfo:function(){var e=this;e._lastTag=e._lastTag+1<e._awardList.length?e._lastTag+1:0;var t=e._itemPool[e._itemPool.length-1],a=e._itemPool.shift();e._toDirection?a.setPosition(t.x+game.IconSizeEnum.GRID_SIZE_105+e._spacing,t.y):a.setPosition(t.x,t.y-game.IconSizeEnum.GRID_SIZE_105-e._spacing),e._itemPool.push(a);var i=e._awardList[e._lastTag];game.GridUtil.setItemIcon(a,i,!1,game.IconLayoutEnum.SHOW_NUM)},hideList:function(){this._lastTag=(this._width-game.IconSizeEnum.GRID_SIZE_105)/(game.IconSizeEnum.GRID_SIZE_105+this._spacing)|1,this._timer&&(b8e.Timer.remove(this,this.updateTimer),this._timer=null)}}),b8e.RC("$$game","$$SrollShowListModel",e)}(),function(){var e;e=b8e.Enum({None:0,Hunlu:1}),b8e.RC("$$game","$$StarBarType",e)}(),function(){var e;e=b8e.Enum({None:0,Horizontal:1,Vertical:2}),b8e.RC("$$game","$$StarBarLayoutType",e)}(),function(){var e,a=e=b8e.BaseDisplay.extends({ctor:function(e,t){this.constructor===a&&(a.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.get\u4ee3\u66ffnew\u64cd\u4f5c\uff01")),this._super(),this.initialize(e,t)},setData:function(e){this._type?this.isInit(e):b8e.warn("\u8bf7\u8bbe\u7f6e\u661f\u661f\u6761type\uff0c\u5f53\u524d\u7c7b\u578btype\uff1a",this._type)},isInit:function(e){this._resetData(e,!1)},_resetData:function(e,t){var a=game.StarCfg.getData(e,this._type);if(a){var i=this._getVals(e);if(i&&!(i.length<1))for(var n=t?0:e-1,s=void 0,o=void 0,r=a.maxLv,g=0;g<r;g++)s=g-1<n?+i[0]:0==e?+i[0]:+i[1],t&&(o=this._starPool.pop())?this._updateStarSprite(a,o,g,s):o=this._createStarSp(a,g,s),this._starSpLvDic[e+g]=o}},_createStarSp:function(e,t,a){var i=b8e.Sprite.get();return this.addChild(i),i.setAnchor(.5,.5),this._updateStarSprite(e,i,t,a),this._starPool.push(i),i},_updateStarSprite:function(e,t,a,i){var n=game.ResCfg.getUrl(270,this._type+"/"+i);t.loadTexture(n),t.setSize(e.iconWidth,e.iconHeight),this._layout(e,t,a)},_layout:function(e,t,a){switch(this._layoutType){case game.StarBarLayoutType.Horizontal:t.x=e.iconWidth*a+3,this._totalWidth+=e.iconWidth,this._totalHeight||(this._totalHeight=e.iconHeight);break;case game.StarBarLayoutType.Vertical:t.y=e.iconHeight*a+3,this._totalHeight+=e.iconHeight,this._totalWidth||(this._totalWidth=e.iconWidth)}},_getVals:function(e){var t=void 0,a=e+"_"+this._type;if(this._vals&&(t=this._vals[a])&&0<t.length)return t;var i=game.StarCfg.getData(e,this._type);return i&&i.vals?(t=i.vals.split(";"),this._vals[a]=t):null},starBarWidth:{get:function(){return this._totalWidth}},starBarHeigth:{get:function(){return this._totalHeight}},initialize:function(e,t){this._type=e,this._layoutType=t||game.StarBarLayoutType.Horizontal,this._clearData()},_clearData:function(){var e=this;e._totalWidth=0,e._totalHeight=0,e._vals?e._vals.length=0:e._vals=[],e._starPool?e._starPool.length=0:e._starPool=[],e._starSpLvDic?e._starSpLvDic.length=0:e._starSpLvDic=[]},restore:function(e,t){this.initialize(e,t),this._super()},recycle:function(){this._clearData(),this._super()},release:function(){this.constructor===a?a.put(this):this.destroy()},dispose:function(){this._totalWidth=null,this._totalHeight=null,this._vals&&(this._vals=null),this._starPool&&(this._starPool=null),this._starSpLvDic&&(this._starSpLvDic=null),this._super()},destroy:function(){this.constructor===a&&(Sprite.poolCall||b8e.warn("\u5f3a\u70c8\u5efa\u8bae\u7528Class1.put\u6216release\u4ee3\u66ffdestroy\u64cd\u4f5c\uff01")),this._super()}}),i=new b8e.Pool(a,1024);a.get=function(e,t){return i.get(e,t)},a.put=function(e){return i.put(e)},b8e.RC("$$game","$$StarBar",e)}(),function(){var e;e=b8e.BaseDisplay.extends({_direction:0,_listWidth:0,_listHeight:0,_bgImg:null,_mask:null,_dropBtn:null,_showType:!1,_addWidth:10,_addHeight:0,ctor:function(e,t,a,i,n){var s=1<arguments.length&&void 0!==t?t:0,o=a,r=i,g=4<arguments.length&&void 0!==n?n:0,l=this;l._super(),l._listWidth=o,l._listHeight=r,l.createDropBtn(g),l.setSize(o+l._addWidth,r+l._addHeight),l.createMask(g),l.createBg(g),l.createList(e,s,g),b8e.evt.onC(l._dropBtn,l.showList,l),b8e.evt.addButtonHandler(l._dropBtn)},createDropBtn:function(e){var t=this;t._dropBtn||(t._dropBtn=b8e.Sprite.get(),t.addChild(t._dropBtn)),t._dropBtn.setAnchor(e,1),t._dropBtn.setPosition(0,0),t._dropBtn.loadTexture(game.ResCfg.getUrl(5071,"dropBtn"),function(){t._addHeight=t._dropBtn.height,t._mask.setPosition(-34,-t._addHeight),t.setSize(t._listWidth+t._addWidth,t._listHeight+t._addHeight)},t),t._dropBtn.setLocalZOrder(10),t._dropBtn.isButton=!0},createMask:function(e){var t=this;t._mask||(t._mask=b8e.BaseDisplay.get(),t.addChild(t._mask)),t._mask.setAnchor(e,1),t._mask.setMask(cc.Mask.Type.RECT),t._mask.setSize(t._listWidth+t._addWidth,t._listHeight),t._mask.setPosition(-34,-t._addHeight),t._mask.setVisible(!1)},createBg:function(e){var t=this;t._bgImg||(t._bgImg=b8e.Sprite.get(),t._bgImg.addToParent(t._mask)),t._bgImg.setStyle(b8e.SpriteStyle.SLICED),t._bgImg.scale9Inset={top:18,bottom:21,left:23,right:18},t._bgImg.setAnchor(e,1),t._bgImg.setSize(t._listWidth+t._addWidth,t._listHeight),t._bgImg.setPosition(0,t._listHeight),t._bgImg.loadTexture(game.ResCfg.getUrl(5071,"back2"))},createList:function(e,t,a){var i=this;i._list||(i._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),i._list.addToParent(i._bgImg));var n=.5*i._addWidth;i._list.itemRender=e,i._list.bindEnum=t,i._list.setAnchor(0,1),i._list.setSize(i._listWidth,i._listHeight-10),i._list.setPosition(a?-i._mask.width+n:n,-5)},setListData:function(e){this._list?this._list.setData(e):b8e.warn("list not create!")},showList:function(){var e=this._showType?this._listHeight:0;this._mask.setVisible(!0),b8e.Tween.get(this._bgImg).to({y:e},200).call(this.showMask,this)},showMask:function(){this._showType&&this._mask.setVisible(!this._showType),this._showType=!this._showType},hideDrop:function(){this._bgImg.setPosition(0,this._listHeight),this._mask.setVisible(!1),this._showType=!1},checkIsShow:function(){return this._showType}}),b8e.RC("$$game","$$DropBtnsModel",e)}(),function(){var e;e=b8e.Enum({None:0,V_UPDATEDATA:b8e.enc(),V_MYPACKET_UPDATE:b8e.enc(),V_ADD_OTHER_PACKET:b8e.enc(),V_ADD_MY_PACKET:b8e.enc(),V_COLLECT_PACKET:b8e.enc(),C_COLLECT_PACKET:b8e.enc(),C_COLLECT_NEXT_PACKET:b8e.enc(),C_SEND_PACKET:b8e.enc(),C_CLOSE_SEND_PACKET:b8e.enc(),C_UPDATE_PACKET_VIEW:b8e.enc(),V_UPDATE_PACKET_VIEW:b8e.enc(),C_OPEN_SEE_VIEW:b8e.enc(),C_SHOW_REDPACKET_ICON:b8e.enc(),C_HIDE_REDPACKET_ICON:b8e.enc()}),b8e.RC("$$game","$$RedPacketEvts",e)}(),function(){var t=void 0;t=b8e.PoolObject.extends({roleName:"",isMale:!1,itemNum:0,collectTime:0,isBest:!1,ctor:function(){},setData:function(e){this.roleName=e.roleName,this.isMale=e.isMale,this.itemNum=e.itemNum,this.collectTime=e.collectTime},recycle:function(){this.reset(),this._super()},reset:function(){this.roleName="",this.isMale=!1,this.itemNum=0,this.collectTime=0,this.isBest=!1}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$RedPacketRoleInfo",t)}(),function(){var t=void 0;t=b8e.PoolObject.extends({index:0,roleName:"",flag:!0,isMale:!1,isAll:!1,count:0,itemNum:0,itemId:0,isGetCount:0,isGetItemNum:0,ctor:function(){this.rolePacketArr=[]},setData:function(e){this.index=e.index;var t=game.RedPacketCfg.getData(e.id);t&&(this.cfg=t,this.roleName=e.roleName,this.flag=e.flag,this.isMale=e.isMale,this.count=t.count,this.itemNum=t.itemNum,this.itemId=t.itemId,this.setInfo(e.infos,t))},setInfo:function(e,t){var a=this;if(e.length<1)a.rolePacketArr=[];else{a.clearList(a.rolePacketArr),a.isAll=t.count==e.length,a.isGetCount=e.length;for(var i=e.length,n=void 0,s=a.isGetItemNum=0;s<i;s++){var o=e[s];(n=game.RedPacketRoleInfo.get()).setData(o),n.isBest=!1,a.isGetItemNum+=o.itemNum,a.rolePacketArr.push(n)}t.count==e.length&&(a.rolePacketArr.sort(a._sort),a.rolePacketArr[0].isBest=!0)}},_sort:function(e,t){return t.itemNum-e.itemNum},clearList:function(e){for(var t=0,a=e.length;t<a;t++)e[t].release();e.length=0},recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.index=0,e.roleName="",e.flag=!0,e.isMale=!1,e.isAll=!1,e.count=0,e.itemNum=0,e.itemId=0,e.isGetCount=0,e.isGetItemNum=0}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$RedPacketInfo",t)}(),function(){var e=b8e.Object.extends({myPacketArr:null,myPacketMap:null,otherPacketArr:null,otherPacketMap:null,hongbaoNum:0,selectIndex:0,ctor:function(){this.myPacketArr=[],this.myPacketMap=b8e.HashMap.get(),this.otherPacketArr=[],this.otherPacketMap=b8e.HashMap.get()},synBagData:function(e){this.myPacketArr.length=0,this.myPacketMap.clear();for(var t=null,a=0,i=e.length;a<i;a++){t=e[a],this.addOneMyPacket(t)}},synOtherPacket:function(e){this.otherPacketArr.length=0,this.otherPacketMap.clear();var t=game.OpenServiceMiscCfg.getData("hongBaoCollectNum");if(!(this.hongbaoNum>=t.value))for(var a=null,i=0,n=e.length;i<n;i++){a=e[i],this.addOneOtherPacket(a)}},shopTips:function(){this._loginSendAlertOptions={thisArg:this,lang:2358,btn:game.Lang.get(9059),okcb:this.loginSendOkCb,cancelcb:this.sendCancelCb},game.alert.show(this._loginSendAlertOptions)},loginSendOkCb:function(){game.module.show(game.ME.RedPacketSendAlert)},sendCancelCb:function(){game.alert.hide()},addOneMyPacket:function(e){var t=game.RedPacketInfo.get();t.setData(e),this.myPacketMap.set(t.index,t),this.myPacketArr.push(t)},addOneOtherPacket:function(e){var t=game.RedPacketInfo.get();t.setData(e),this.otherPacketMap.set(t.index,t),e.flag||t.isAll||this.otherPacketArr.push(t)},sendSuccess:function(e){var t=this.myPacketMap.get(e);if(t){t.flag=!0}},collectSuccess:function(e){var t=this.otherPacketMap.get(e);if(t){var a=this.otherPacketArr.indexOf(t);if(-1<a){this.otherPacketArr.splice(a,1)}}},getMyPacketInfoByIndex:function(e){return this.myPacketMap.get(e)},getOtherPacketInfoByIndex:function(e){return this.otherPacketMap.get(e)},getOtherPacketList:function(){return this.otherPacketMap.values()},getMyPacketList:function(){return t.myPacketMap.values()},getMyPacketCount:function(){if(this.myPacketArr){return this.myPacketArr.length}return 0},getOtherPacketCount:function(){if(this.otherPacketArr){return this.otherPacketArr.length}return 0},getMyPacketSortArr:function(){return this.myPacketArr.sort(this.myPacketSortFunc)},myPacketSortFunc:function(e,t){return e.flag&&t.flag?e.cfg.itemNum==t.cfg.itemNum?e.index-t.index:t.cfg.itemNum-e.cfg.itemNum:e.flag&&!t.flag?-1:!e.flag&&t.flag?1:e.index-t.index},synData:function(e){this.isOpen=!1,this.hongbaoNum=e;var t=game.miscData.openServerDay,a=game.RedPacketCfg.getDatas();if(a){for(var i=null,n=0,s=0,o=a.length;s<o;s++)if(t>=(i=a[s]).serverStart&&t<i.serverEnd){n=i.serverEnd,this.isOpen=!0;break}this.endDay=n,this.endTime=b8e.TimeUtil.getTodayTime(game.SysTime.curTime)+(n-t)*b8e.TimeUtil.DAY_MICRO_SECONDS}},checkCanSend:function(){for(var e=this.myPacketArr,t=0,a=e.length;t<a;t++){if(!e[t].flag){return!0}}},isActivityOpen:function(){return this.endDay?game.miscData.openServerDay<this.endDay:this.isOpen}});game.redPacketData=game.redPacketData||new e}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1409),this.setSize(127,182)},init:function(){},setData:function(){var e=this.skin;e.name.string=this.data.roleName,e.bg_1.active=!this.data.flag&&!this.data.isAll,e.isGet_lab.active=this.data.isAll},ck_btn:function(){this.send(game.RedPacketEvts.C_OPEN_SEE_VIEW,this.data.index)},btn_qiang:function(){this.send(game.RedPacketEvts.C_COLLECT_PACKET,this.data.index)}}),b8e.RC("$$game","$$RedPacketMyListItme",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1410),this.setSize(458,116)},init:function(){var e=this.itemSp=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.goldNode),e.setSize(40,40),(e=this.headSp=b8e.Sprite.get()).setAnchor(.5,.5),e.addToParent(this.skin.headNode)},setData:function(){var e=this.skin;e.name.string=this.data.roleName,e.time.string=b8e.TimeUtil.formatTime(this.data.collectTime);var t=!!this.data.isMale;e.cost.string=this.data.itemNum,e.zuijia.active=this.data.isBest;var a=game.ResCfg.getHead(t);this.headSp.loadTexture(a);var i=game.amount.getCfgByType(game.AmountType.YUAN_BAO),n=game.ItemInfoCfg.getData(i.id);if(n){a=game.ResCfg.getUrl(137,n.icon);this.itemSp.loadTexture(a)}}}),b8e.RC("$$game","$$RedPacketRoleItme",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(907),this.setSize(124,176)},init:function(){var e=this.itemSp=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.goldNode),e.setSize(40,40)},setData:function(){var e=this.skin,t=this.data,a=t.cfg;if(a){e.descLab.string=a.desc,e.numLab.string=game.CCommonUtil.replaceNum(a.itemNum,0);var i=game.ItemInfoCfg.getData(a.itemId),n=game.ResCfg.getUrl(137,i.icon);this.itemSp.loadTexture(n),e.sendSp.node.active=t.flag}else;},sendBtn:function(){if(this.data.flag);else{var e=this.data.index;this.send(game.RedPacketEvts.C_SEND_PACKET,{index:e,showTips:!0})}}}),b8e.RC("$$game","$$RedPacketListItem",e)}(),function(){var e;e=game.Widget.extends({isSpecialModule:!0,ctor:function(){this._super(912)},init:function(){var e=this.skin,t=this.headSp=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(e.headNode),this.updateData()},setData:function(e){if(this.data=e,this.skin)this.updateData();else;},updateData:function(){var e=this,t=e.data,a=e.skin;if(t){a.nameLab.string=t.roleName.length<1?game.Lang.get(9291):t.roleName;var i=game.ResCfg.getHead(t.isMale);e.headSp.loadTexture(i)}else;},recvBtn:function(){this.send(game.RedPacketEvts.C_COLLECT_PACKET,this.data.index)}}),b8e.RC("$$game","$$RedPacketWidget",e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(1408)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.RedPacketRoleItme,e.bindEnum=game.ME.RedPacketSee,e.layout.spacingY=5,e.addToParent(this.skin.list);var t=this.itemSp=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(this.skin.icon),t.setSize(40,40)},onShow:function(){this.updateData()},updateData:function(){var e=game.redPacketData.selectIndex,t=game.redPacketData.getOtherPacketInfoByIndex(e);if(t){var a=this.skin,i=t.roleName;if(i){a.nameLab.string=game.Lang.get(2355,i)}else a.nameLab.string=game.Lang.get(9291);var n=game.OpenServiceMiscCfg.getData("hongBaoCollectNum");if(n){a.bg_1.active=!t.flag&&t.isAll;var s=n.value-game.redPacketData.hongbaoNum;a.name_num.string=game.Lang.get(51893,s),a.costName.string=game.Lang.get(51894,t.isGetCount,t.count),a.num.string=t.isGetItemNum+"/"+t.itemNum;var o=game.ItemInfoCfg.getData(t.itemId);if(o){var r=game.ResCfg.getUrl(137,o.icon);this.itemSp.loadTexture(r),this.updateList(t)}}}},onHide:function(){},updateList:function(e){this.list.setData(e.rolePacketArr)}});b8e.module.registerView(game.ME.RedPacketSee,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(908)},init:function(){var e=this.itemSp=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.goldNode),e.setSize(40,40),(e=this.headSp=b8e.Sprite.get()).setAnchor(.5,.5),e.addToParent(this.skin.headNode)},notify:function(e){switch(e){case this.Evts.V_COLLECT_PACKET:this.updateData()}},onShow:function(){game.redPacketData.redPacketData=null,this.updateData()},clear:function(){var e=this.skin;this.itemSp.clear(),this.headSp.clear(),e.nameLab.string="",e.numLab.string="",e.send.string=""},updateData:function(){var e=game.redPacketData.collectData;if(e){this.clear();var t=this.skin,a=game.redPacketData.getOtherPacketCount();t.send.string=0<a?game.Lang.get(9289):game.Lang.get(9290);var i=e.roleName;t.nameLab.string=i?game.Lang.get(2355,i):game.Lang.get(9291),t.numLab.string=e.itemNum;var n=e.itemId,s=game.ItemInfoCfg.getData(n),o=game.ResCfg.getUrl(137,s.icon);this.itemSp.loadTexture(o);var r=!!e.isMale;o=game.ResCfg.getHead(r);this.headSp.loadTexture(o)}else;},onHide:function(){game.redPacketData.redPacketData=null},viewOpenPacketBtn:function(){this.send(this.Evts.C_COLLECT_NEXT_PACKET)}});b8e.module.registerView(game.ME.RedPacketRecv,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(909)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.RedPacketListItem,e.layout.spacingX=12,e.layout.spacingY=12,e.layout.paddingTop=10,e.layout.paddingLeft=20,e.bindEnum=game.ME.RedPacket,e.addToParent(this.skin.list)},notify:function(e){switch(e){case this.Evts.V_MYPACKET_UPDATE:this.updateData()}},onShow:function(){this.updateData()},updateData:function(){var e=this,t=(e.skin,game.redPacketData.getMyPacketSortArr());e.list.setData(t)},onStageResize:function(){var e=b8e.stageHeight,t=b8e.stageWidth;this.setPosition(.5*(t-this.width),.5*(e+this.height))}});b8e.module.registerView(game.ME.RedPacketSendAlert,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(910)},init:function(){var e=this.itemSp=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.goldNode),e.setSize(40,40)},notify:function(e,t){switch(e){case this.Evts.V_MYPACKET_UPDATE:this.updateData(t)}},onShow:function(){this.packetIndex=0},updateData:function(e){var t=this,a=t.skin;t.packetIndex=e;var i=game.redPacketData.getMyPacketInfoByIndex(e);if(i){var n=i.cfg;a.titleLab.string=n.desc,a.numLab.string=game.CCommonUtil.replaceNum(n.itemNum,0);var s=game.ItemInfoCfg.getData(n.itemId),o=game.ResCfg.getUrl(137,s.icon);if(t.itemSp.loadTexture(o),t.timeCount=10,t.skin.send.string=game.Lang.get(2356,t.timeCount),t.timer)t.timer.reset(),t.timer.start();else{t.timer=b8e.Timer.add(this,t.updateTime,1e3)}b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e4).call(t.delayCall,this)}else;},delayCall:function(){this.sendPacket()},updateTime:function(){var e=this;e.timeCount--,e.timeCount=e.timeCount<0?0:e.timeCount,e.skin.send.string=game.Lang.get(2356,e.timeCount)},onHide:function(){if(this.timer){this.timer.stop()}b8e.Tween.kill(this)},viewSendPacketBtn:function(){this.sendPacket()},sendPacket:function(){this.send(this.Evts.C_SEND_PACKET,{index:this.packetIndex,showTips:!1})},viewLaterSendBtn:function(){if(this.send(this.Evts.C_CLOSE_SEND_PACKET),this.timer){this.timer.stop()}b8e.Tween.kill(this)},onStageResize:function(){var e=this,t=b8e.stageWidth,a=b8e.stageHeight;e.setPosition(.5*(t-e.width),.5*(a+e.height))}});b8e.module.registerView(game.ME.RedPacketSend,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(911)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.itemRender=game.RedPacketMyListItme,e.bindEnum=game.ME.RedPacket,e.addToParent(this.skin.list),this.moduleData=game.redPacketData},notify:function(e){switch(e){case this.Evts.V_UPDATE_PACKET_VIEW:this.updateRedPacketList()}},onShow:function(){if(this.send(this.Evts.C_UPDATE_PACKET_VIEW),this.skin.descLab.string=game.Lang.get(2352),this.timer)this.timer.reset(),this.timer.start();else{this.timer=b8e.Timer.add(this,this.updateTime,1e3)}},updateTime:function(){var e=game.redPacketData.endTime,t=game.TimeUtil.formatTimeSpace(e-game.SysTime.curTime,2);this.skin.timeLab.string=game.Lang.get(2353,t)},onHide:function(){this.timer.stop()},updateRedPacketList:function(){var e=this.moduleData.getOtherPacketList();this.list.setData(e);var t=game.OpenServiceMiscCfg.getData("hongBaoCollectNum");if(t){var a=t.value-game.redPacketData.hongbaoNum;this.skin.rechargeCountLab.string=game.Lang.get(51893,a)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.RedPacket,e)}(),function(){var e=b8e.Object.extends({ctor:function(){this.packetArr=[],this.packetPool=[],this.packetMap=b8e.HashMap.get()},addPacket:function(e){var t=this;if(e&&!e.flag&&(!t.packetMap.get(e.index)&&t.packetArr&&t.packetArr.length<5)){var a=null;0<t.packetPool.length?a=t.packetPool.shift():(a=new game.RedPacketWidget).setAnchor(.5,.5),a.setVisible(!0),a.setData(e),t.packetArr.push(a),t.packetMap.set(e.index,a),a.bindEnum=game.ME.RedPacket;var i=b8e.MathUtil.random(-20,20);a.rotation=i;var n=t.getRandomStartPos(),s=t.getRandomEndPos();b8e.Tween.kill(a),a.x=n.x,a.y=n.y,game.GameViewMgr.inst().showView(a),b8e.Tween.get(a).to({x:s.x,y:s.y},1e4).wait(1e4).call(t.delayRemovePacket,t,[e])}},delayRemovePacket:function(e){if(e){this.removePacket(e.index)}},getRandomStartPos:function(){var e=b8e.stageWidth;return{x:b8e.MathUtil.random(30,e-30),y:1300}},getRandomEndPos:function(){var e=b8e.stageWidth;return{x:b8e.MathUtil.random(30,e-30),y:150}},removePacket:function(e){var t=this.packetMap.get(e);if(t){var a=this.packetArr.indexOf(t);if(-1<a){var i=this.packetArr[a];this.packetArr.splice(a,1),this.packetPool.push(i),i.setVisible(!1)}}},removeAllPacket:function(){var a=this;a.packetMap.forEach(function(e,t){a.removePacket(e)},a),a.packetMap.clear()}});game.redPacketMgr=game.redPacketMgr||new e}(),function(){var e=game.Control.extends({moduleOpen:!1,init:function(){this._sendAlertOptions={thisArg:this,lang:2357,btn:game.Lang.get(9059),key:"RedPacketControl",okcb:this.sendOKCb,cancelcb:this.sendCancelCb},this.firstIn=!0},initTimer:function(){var e=b8e.startup.lastServerTime,t=this.getNextTime()-e;if(!this.timer){this.timer=new b8e.Timer.add(this,this.updateTime,t)}this.timer.reset(),this.timer.start()},getNextTime:function(){var e=b8e.startup.lastServerTime,t=.5*b8e.TimeUtil.HOUR_MICRO_SECONDS;return Math.ceil(e/t)*t},updateTime:function(){if(this.timer.delay=.5*b8e.TimeUtil.HOUR_MICRO_SECONDS,this.timer.reset(),this.timer.start(),game.redPacketData.isActivityOpen()){this.sender.HongBaoReq()}},ipc:function(){var e=this;e.evts={OpenServer:{C2C_INIT_OPENSERVER:e.updateData},MainRole:{C_RESET_DAILY:e.resetDaily},MainCenter:{C_COLLECT_NEXT_REDPACKET:e.collectNextPacket}},e.handels={HongBaoBagResp:e.hongBaoBagResp,HongBaoResp:e.hongBaoResp,HongBaoSendResp:e.hongBaoSendResp,HongBaoCollectResp:e.hongBaoCollectResp,HongBaoMsg:e.hongBaoNotify,HongBaoBagMsg:e.hongBaoBagNotify}},updateData:function(e){if(game.moduleOpen.checkOpen(this.moduleEnum)){var t=e.data;this.initTimer(),game.redPacketData.synData(t.hongbaoNum),this.checkOpen()}else;},triggerOpen:function(e){e==this.moduleEnum&&(this.initTimer(),game.redPacketData.synData(game.redPacketData.hongbaoNum),this.checkOpen())},resetDaily:function(){this.checkOpen(),b8e.module.isShowView(game.ME.RedPacketSendAlert)&&game.module.hide(game.ME.RedPacketSendAlert),game.redPacketData.hongbaoNum=0},checkOpen:function(){var e=game.redPacketData.isActivityOpen(),t={openServerType:game.OpenServerType.RED_PACKET,isActive:e};this.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER,t),e&&(this.sender.HongBaoBagReq(),this.sender.HongBaoReq())},hongBaoBagResp:function(e){var t=e.readProtobuf(game.pb.HongBaoBagResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.data;if(game.redPacketData.synBagData(a),game.redPacketData.checkCanSend()){game.gamePopupMgr.show(game.ME.RedPacket)}}},hongBaoResp:function(e){var t=e.readProtobuf(game.pb.HongBaoResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.redPacketData.synOtherPacket(t.data);var a=game.redPacketData.otherPacketArr,i=null;if(this.firstIn){this.firstIn=!1}else{if(0<a.length){this.dpt(this.Evts.C_SHOW_REDPACKET_ICON)}for(var n=0,s=a.length;n<s;n++){if(i=a[n])game.redPacketMgr.addPacket(i);else;}this.send(this.Evts.V_UPDATE_PACKET_VIEW)}}},hongBaoSendResp:function(e){var t=e.readProtobuf(game.pb.HongBaoSendResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.notice.show(9288),game.redPacketData.sendSuccess(t.index),game.module.hide(game.ME.RedPacketSend)},hongBaoCollectResp:function(e){var t=e.readProtobuf(game.pb.HongBaoCollectResponse);if(0<t.code){if(1013==t.code||3501==t.code){game.redPacketData.collectSuccess(t.index),game.redPacketMgr.removePacket(t.index)}game.notice.noticeError(t.code)}else game.redPacketMgr.removePacket(t.index),game.redPacketData.hongbaoNum++,game.redPacketData.collectSuccess(t.index),game.module.show(game.ME.RedPacketRecv),this.send(this.Evts.V_COLLECT_PACKET),game.redPacketData.collectData=t,b8e.module.isShowView(game.ME.RedPacket)&&this.sender.HongBaoReq(),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)},hongBaoNotify:function(e){var t=e.readProtobuf(game.pb.HongBao);if(0<t.code){game.notice.noticeError(t.code)}else if(game.redPacketData.addOneOtherPacket(t),game.moduleOpen.checkOpen(this.moduleEnum)){if(t.roleName.length<1||t.roleName!=game.mainRoleData.name){game.redPacketMgr.addPacket(t),this.dpt(this.Evts.C_SHOW_REDPACKET_ICON)}else this.sender.HongBaoCollectReq(t.index);this.send(this.Evts.V_ADD_OTHER_PACKET,t.index)}else;},hongBaoBagNotify:function(e){var t=e.readProtobuf(game.pb.HongBaoBagNotify);if(0<t.code){game.notice.noticeError(t.code)}else{for(var a=t.data,i=null,n=0,s=a.length;n<s;n++){i=a[n],game.redPacketData.addOneMyPacket(i)}if(game.moduleOpen.checkOpen(this.moduleEnum)){if(game.module.show(game.ME.RedPacketSend),a&&0<a.length){this.send(this.Evts.V_MYPACKET_UPDATE,a[0].index)}}else;}},testHongBaoNotify:function(){var e=new game.pb.HongBao.ctor;if(this.testIndex)this.testIndex++;else{this.testIndex=1}e.index=this.testIndex,e.id=e.index%10+1,e.roleName="TName"+e.id,e.flag=!1,game.redPacketData.addOneOtherPacket(e),game.redPacketMgr.addPacket(e),this.send(this.Evts.V_ADD_OTHER_PACKET,e.index)},notify:function(e,t){var a=this;switch(e){case a.Evts.C_SEND_PACKET:a.sendPacket(t.index,t.showTips);break;case a.Evts.C_COLLECT_NEXT_PACKET:a.collectNextPacket();break;case a.Evts.C_CLOSE_SEND_PACKET:game.module.hide(game.ME.RedPacketSend);break;case a.Evts.C_COLLECT_PACKET:a.collectPacket(t),game.redPacketMgr.removePacket(t);break;case a.Evts.C_UPDATE_PACKET_VIEW:a.sender.HongBaoReq();break;case a.Evts.C_OPEN_SEE_VIEW:a.openSee(t)}},sendPacket:function(e,t){if(this.tmpSendIndex=e,this.tmpSendIndex<0){game.module.hide(game.ME.RedPacketSend)}else{var a=game.redPacketData.getMyPacketInfoByIndex(e);if(a)if(a.flag){game.module.hide(game.ME.RedPacketSend)}else if(t){game.alert.showTwo(this._sendAlertOptions)}else this.sender.HongBaoSendReq(this.tmpSendIndex);else{game.module.hide(game.ME.RedPacketSend)}}},openSee:function(e){game.redPacketData.selectIndex=e,game.module.show(game.ME.RedPacketSee)},sendOKCb:function(){this.sender.HongBaoSendReq(this.tmpSendIndex),game.module.hide(game.ME.RedPacketSend)},collectPacket:function(e){var t=game.redPacketData.getOtherPacketInfoByIndex(e),a=game.OpenServiceMiscCfg.getData("hongBaoCollectNum");if(a&&t){if(game.redPacketData.hongbaoNum>=a.value)return game.notice.show(52113),game.redPacketMgr.removeAllPacket(),void this.dpt(this.Evts.C_HIDE_REDPACKET_ICON);this.sender.HongBaoCollectReq(e)}},collectNextPacket:function(){var e=game.redPacketData.getOtherPacketCount(),t=game.OpenServiceMiscCfg.getData("hongBaoCollectNum");if(t)if(0<e){var a=game.redPacketData.otherPacketArr[0];if(a){if(game.redPacketData.hongbaoNum>=t.value)return game.notice.show(52113),game.redPacketMgr.removeAllPacket(),void this.dpt(this.Evts.C_HIDE_REDPACKET_ICON);this.sender.HongBaoCollectReq(a.index)}}else game.module.hide(game.ME.RedPacketRecv),this.dpt(this.Evts.C_HIDE_REDPACKET_ICON)},sendPacketBtn:function(){if(0<game.redPacketData.getMyPacketCount()){game.module.show(game.ME.RedPacketSendAlert)}else game.notice.show(game.Lang.get(2351))},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)}}),t=game.Sender.extends({ipc:function(){this.msg={HongBaoBagReq:null,HongBaoReq:null,HongBaoSendReq:this.hongBaoSendReq,HongBaoCollectReq:this.hongBaoCollectReq}},hongBaoSendReq:function(e){var t=game.pb.HongBaoSendRequest;t.index=e,this.write(t)},hongBaoCollectReq:function(e){var t=game.pb.HongBaoCollectRequest;t.index=e,this.write(t)}}),a=[game.ME.RedPacketSend,game.ME.RedPacketSendAlert,game.ME.RedPacketRecv,game.ME.RedPacketSee];b8e.module.registerControl(game.ME.RedPacket,e,game.RedPacketEvts,t,a)}(),function(){var e;e=b8e.Enum({None:0,CHANGE_NAME:-1,C_CHANGE_NAME_COMPLETE:-1,CLICK_SETTING:-1,UPDATE_SETTING_VIEW:-1,UPDATE_VIPLEVEL:-1,SAVE_SETTING:-1,C2V_UPDATE_NAME:-1}),b8e.RC("$$game","$$SettingEvts",e)}(),function(){var e=game.Control.extends({MAX_RENDER:20,ipc:function(){var e=this,t=e;t.handels={RenameResp:t.renameResp},t.evts={MainRole:{C_VIP_LEVEL_CHANGE:e.vipLevelChange},PlayBackSpeedRatio:{SPEED_CHANGE:e.saveSpeed},GoodGift:{C_AUTO_POP:e.saveAutoPop},VerifyAward:{C2C_SET_SUPER_VIP:e.saveSuperVip,C2C_SET_BIND_MOBILE:e.saveBindMobile},SRTurnplateSelect:{C2C_SELECTREWARD_CONFIRM:e.saveSRTurnplate},SRTurnplateSelect2:{C2C_SELECTREWARD_CONFIRM:e.saveSRTurnplate},TransferSelect:{SAVE_SELECT_TRANSFER:e.saveSelectTransfer},TransferLevelUp:{SAVE_SELECT_TRANSFER:e.saveSelectTransfer},WorldWarTeam:{C_CHANGE_NEWS_STATE:e.saveWorldWar}},t.gevts={SceneGEvts:{ENTER_SCENE:t.enterScene}}},enterScene:function(){game.sceneData.isCsScene()||this.updateGameSetting()},saveSRTurnplate:function(e){var t=e.data,a=t.aid,i=t.arr;if(i&&0!=i.length&&!(i.length>=game.SRTQualityType.SRTQUALITY_TYPE_END)){var n=0;n|=a<<18,n|=i[0]<<12,n|=i[1]<<6,n|=i[2],game.settingData.saveSetting(game.SettingEnum.SRTURNPLATE,n),this.sender.SaveClientSettingReq(game.settingData.settingMap)}},saveSpeed:function(e){var t=e.data;game.settingData.saveSetting(game.SettingEnum.SPEED,t),this.sender.SaveClientSettingReq(game.settingData.settingMap)},saveAutoPop:function(e){var t=e.data;game.settingData.saveSetting(game.SettingEnum.AUTO_POP,t),this.sender.SaveClientSettingReq(game.settingData.settingMap)},saveSelectTransfer:function(e){var t=e.data;game.settingData.saveSetting(game.SettingEnum.LAST_LOOK_TRANSFER,t),this.sender.SaveClientSettingReq(game.settingData.settingMap)},saveSuperVip:function(e){var t=e.data;game.settingData.saveSetting(game.SettingEnum.SUPER_VIP,t),this.sender.SaveClientSettingReq(game.settingData.settingMap)},saveBindMobile:function(e){var t=e.data;game.settingData.saveSetting(game.SettingEnum.BIND_MOBILE,t),this.sender.SaveClientSettingReq(game.settingData.settingMap)},saveWorldWar:function(e){var t=e.data;game.settingData.saveSetting(game.SettingEnum.WORLDWAR,t),this.sender.SaveClientSettingReq(game.settingData.settingMap)},vipLevelChange:function(){this.send(this.Evts.UPDATE_VIPLEVEL)},triggerOpen:function(e){e==this.moduleEnum&&this.updateGameSetting()},updateGameSetting:function(){var e=game.settingData,t=e.getSpeed(),a=game.PlayBackSpeedRatioCfg.getData(t);game.playBack.speedRatio=a.speedRatio,e.isCloseMusic()?(b8e.SoundMgr.inst().pauseBackgroundMusic(),b8e.SoundMgr.inst().pauseEnvironmentAudio(),b8e.SoundMgr.inst().pauseEffectSound()):(b8e.SoundMgr.inst().resumeBackgroundMusic(),b8e.SoundMgr.inst().resumeEnvironmentAudio(),b8e.SoundMgr.inst().resumeEffectSound());var i=game.playBackScene.scene,n=b8e.scene,s=this.MAX_RENDER,o=e.isHideOtherPlayer()?0:s;n.setMaxRenderNum(game.RoleType.Hero,o),i.setMaxRenderNum(game.RoleType.Hero,s),o=e.isHideWing()?0:s,n.setMaxAttachNum(game.RoleType.Hero,game.AttachType.WING,o),i.setMaxAttachNum(game.RoleType.Hero,game.AttachType.WING,o),o=e.isHideNickName()?0:s,n.setMaxAttachNum(game.RoleType.Hero,game.AttachType.NICK_NAME,o),i.setMaxAttachNum(game.RoleType.Hero,game.AttachType.NICK_NAME,o);var r=e.getFps();r&&(b8e.params.isQuickGame?b8e.startup.setFrameRate(60):b8e.startup.setFrameRate(r))},renameResp:function(e){var t=e.readProtobuf(game.pb.RenameResponse);!t||0<t.code?game.notice.noticeError(t.code):(game.mainRoleData.name=this.tempRenameStr,game.mainRole.updateName(),game.mainRoleData.renameFreeUsed=!0,this.dpt(this.Evts.C_CHANGE_NAME_COMPLETE),this.send(this.Evts.C2V_UPDATE_NAME),game.module.hide(game.ME.Rename))},notify:function(e,t){var a=this;switch(e){case a.Evts.CHANGE_NAME:if(!t||0==t.length)return void game.notice.show(3503);if(t==game.mainRoleData.name)return void game.notice.show(3500);game.sdk.msgSecCheck(t,function(e){if(e){if(game.mainRoleData.renameFreeUsed&&!game.UpgradeUtil.checkItemInfo(312001,1))return;a.tempRenameStr=t,a.sender.RenameReq(t)}},this);break;case a.Evts.CLICK_SETTING:var i=game.ClientSettingTypesCfg.getData(t);if(!i)break;var n=0;if(2==i.group){n=t-10,t=game.SettingEnum.SPEED;var s=game.PlayBackSpeedRatioCfg.getData(n);if(s.vip>game.mainRoleData.vipLevel)return void game.notice.show(9543,s.vip)}else n=3==i.group?(t=game.SettingEnum.FPS,i.param):(n=game.settingData.settingTempMap.get(t))?0:1;game.settingData.setTempSettingValue(t,n),a.send(a.Evts.UPDATE_SETTING_VIEW)}},sureBtn:function(){if(game.sceneData.isCsScene())game.notice.show(9305);else{game.settingData.save(),this.updateGameSetting(),this.sender.SaveClientSettingReq(game.settingData.settingMap),game.module.hide(game.ME.Setting),this.dpt(this.Evts.SAVE_SETTING)}},vip_btn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP)},change_name_btn:function(){game.module.show(game.ME.Rename)},login_out_btn:function(){game.sdk.logout()},client_setting_btn:function(){game.module.show(game.ME.Setting)},monthBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.MONTH_CARD)},weekBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.PRIVILEGE)},foreverBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.MONTH_CARD)}}),t=game.Sender.extends({ipc:function(){this.msg={RenameReq:this.renameReq,SaveClientSettingReq:this.saveClientSettingReq}},saveClientSettingReq:function(e){var a,i=game.pb.SaveClientSettingRequest;e.forEach(function(e,t){(a=new game.pb.ClientSettingProto.ctor).id=+e,a.value=t,i.settingData.push(a)},this),this.write(i)},renameReq:function(e){var t=game.pb.RenameRequest;t.name=e,this.write(t)}}),a=[game.ME.MainRoleInfoView,game.ME.Rename];b8e.module.registerControl(game.ME.Setting,e,game.SettingEvts,t,a)}(),function(){var e=b8e.Object.extends({settingMap:null,settingTempMap:null,ctor:function(){this.settingMap=b8e.HashMap.get(),this.settingTempMap=b8e.HashMap.get()},setup:function(e){var t=e.settingData;if(!t||0==t.length){var a=game.ClientSettingCfg.getData(1);if(!a)return;t=a.define}if(t)for(var i,n=0;n<t.length;n++)i=t[n],this.settingMap.set(i.id,i.value),this.settingTempMap.set(i.id,i.value);if(!this.settingMap.has(game.SettingEnum.FPS)){var s=b8e.isWeChatGame?30:60;this.settingMap.set(game.SettingEnum.FPS,s),this.settingTempMap.set(game.SettingEnum.FPS,s)}},isWorldWar:function(){var e=this.settingMap.get(game.SettingEnum.WORLDWAR);return null==e||!!e},isCloseMusic:function(){return!!this.settingMap.get(game.SettingEnum.MUSIC)},isHideWing:function(){return!!this.settingMap.get(game.SettingEnum.WING)},isHideNickName:function(){return!!this.settingMap.get(game.SettingEnum.NICK_NAME)},isHideOtherPlayer:function(){return!!this.settingMap.get(game.SettingEnum.OTHER_PLAYER)},isBanAutoPop:function(){return!!this.settingMap.get(game.SettingEnum.AUTO_POP)},getSpeed:function(){return this.settingMap.get(game.SettingEnum.SPEED)>>0},getSelectTransfer:function(){return this.settingMap.get(game.SettingEnum.LAST_LOOK_TRANSFER)>>0},getFps:function(){return this.settingMap.get(game.SettingEnum.FPS)>>0},getSRTurnplate:function(){var e=this.settingMap.get(game.SettingEnum.SRTURNPLATE),t={aid:0,arr:[]};return e&&(t.aid=e>>18,t.arr.push(e>>12&63),t.arr.push(e>>6&63),t.arr.push(63&e)),t},isSuperVip:function(){return!!this.settingMap.get(game.SettingEnum.SUPER_VIP)},isBindMobile:function(){return!!this.settingMap.get(game.SettingEnum.BIND_MOBILE)},getTempSettingValue:function(e){return this.settingTempMap.get(e)>>0},setTempSettingValue:function(e,t){if(this.settingTempMap.get(e)!=t)this.settingChange=!0,this.settingTempMap.set(e,t);else;},resetTempSetting:function(){if(this.settingChange)this.settingTempMap.clear(),this.settingMap.forEach(function(e,t){this.settingTempMap.set(e,t)},this),this.settingChange=!1;else;},saveSetting:function(e,t){this.settingMap.set(e,t),this.settingTempMap.set(e,t)},save:function(){this.settingMap.clear(),this.settingTempMap.forEach(function(e,t){this.settingMap.set(e,t)},this)}});game.settingData=game.settingData||new e}(),function(){var e;e=b8e.Enum({NONE:0,MUSIC:1,WING:2,NICK_NAME:3,WU_HUN:8,OTHER_PLAYER:9,SPEED:10,FPS:11,AUTO_POP:12,SUPER_VIP:13,BIND_MOBILE:14,SRTURNPLATE:15,LAST_LOOK_TRANSFER:16,WORLDWAR:21}),b8e.RC("$$game","$$SettingEnum",e)}(),function(){var e=game.View.extends({_showModel:!0,model:null,ctor:function(){this._super(954)},init:function(){var e=this.skin;this.headIcon=b8e.Sprite.get(),this.headIcon.setAnchor(.5,.5),this.headIcon.setSize(84,84),this.headIcon.addToParent(e.sp_head),!game.IS_WANBA&&!b8e.isWeChatGame&&game.LoginConfig.isSwitch||(e.login_out_btn.active=!1),game.IS_WANBA&&(e.qqLab.active=!0)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_NAME:this.skin.name_lab.string=game.mainRoleData.name}},onShow:function(){this.updateInfo()},onHide:function(){},updateInfo:function(){var e=game.mainRoleData;if(e){var t=this.skin;if(t.name_lab.string=e.name,t.lv_lab.string=game.Lang.get(9587,e.lv),t.id_lab.string=e.roleId,e.isMale?t.sex_lab.string=game.Lang.get(9022):t.sex_lab.string=game.Lang.get(9023),0==e.guildName.length?t.guild_lab.string=game.Lang.get(9024):t.guild_lab.string=e.guildName,game.marryData&&game.marryData.patnerData&&game.marryData.patnerData.partnerName){t.cp_lab.string=game.marryData.patnerData.partnerName}else t.cp_lab.string=game.Lang.get(9024);this.loadHeadIcon(e.isMale),t.fightAmountLbl.string=e.power,game.AutoLayoutUtil.layoutPower(t.power,t.fightAmountLbl,t.powerImg);var a=e.vipLevel;t.vip_lab.string=a?"VI":"",this.updateModel(e.heroModel);var i=game.moduleOpen.checkOpen(game.ME.WeekCard);if(game.moduleOpen.checkOpen(game.ME.MonthCard)){var n=game.rechargeData.getCardIsHas(game.CardType.MONTH);this.skin.monthCardGray.active=!n;var s=game.rechargeData.getCardIsHas(game.CardType.FOREVER);this.skin.foreverCardGray.active=!s}if(i){var o=game.rechargeData.getCardIsHas(game.CardType.WEEK);this.skin.weekCardGray.active=!o}}else;},updateModel:function(){if(!this.model){this.model=game.sceneRoleCreate.createUIRole(game.mainRoleData),this.model.addToParent(this.skin.modelNode),this.skin.modelNode.setScale(.5,.5)}if(!this.followModel){var e=this.followRoleData=game.BaseRoleData.get(game.RoleType.Rank,1);this.followModel=game.sceneRoleCreate.createUIRole(e),this.followModel.addToParent(this.skin.followModelNode)}var t=game.AvatarUtil;t.updateUIModel(this.model),this.model.transition(game.RoleStateType.ACTION_IDLE),t.updateUIModel(this.followModel,t.ID_5),this.followModel.transition(game.RoleStateType.ACTION_IDLE)},view_copy_name_btn:function(){this.copyStr(this.skin.name_lab.string)},view_copy_id_btn:function(){this.copyStr(this.skin.id_lab.string)},copyStr:function(e){game.CCommonUtil.setClipboardData(e)},loadHeadIcon:function(e){var t=game.ResCfg.getHead(e);this.headIcon.loadTexture(t)},onStageResize:function(){var e=b8e.stageHeight;this.setPosition(.5*(b8e.stageWidth-this.width),.5*(e+this.height))}});b8e.module.registerView(game.ME.MainRoleInfoView,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(955)},init:function(){var e=b8e.Sprite.get();e.setAnchor(.5,.5),e.setSize(40,40),e.loadTexture("images/image/item/312001.png"),e.addToParent(this.skin.costItem)},onShow:function(){this.updateState()},updateState:function(){if(this.skin.nameInput.string=game.mainRoleData.name,game.mainRoleData.renameFreeUsed){this.skin.costChangeName.node.active=!0,this.skin.firstChangeName.node.active=!1;var e,t=game.itemData.getNumById(312001);if(0<t){e=game.HtmlUtil.getText(game.Color.GREEN,t)}else e=game.HtmlUtil.getText(game.Color.RED,0);e+=game.HtmlUtil.getText(game.Color.GREEN,"/1"),this.skin.costCount.string=e}else this.skin.costChangeName.node.active=!1,this.skin.firstChangeName.node.active=!0},view_changeNameSureBtn:function(){this.send(this.Evts.CHANGE_NAME,this.skin.nameInput.string)},onStageResize:function(){var e=b8e.stageHeight;this.setPosition(.5*(b8e.stageWidth-this.width),.5*(e+this.height))}});b8e.module.registerView(game.ME.Rename,e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(956)},onShow:function(){this.setCfg(this.cfg),this.setState(this.isSelect)},setCfg:function(e){if(e){var t=this;if(t.cfg=e,t.skin)t.skin.lbl.string=e.alert;else;}else;},setCb:function(e,t){this._clickCb=e,this._cbThisArg=t},bgBtn:function(){this._clickCb.call(this._cbThisArg,this.cfg.id)},setState:function(e){var t=this;if(t.isSelect=e,t.skin)t.skin.select.node.active=e;else;}}),b8e.RC("$$game","$$SettingCheckBox",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(957)},onShow:function(){this.updateSetting(),this.updateVip()},onHide:function(){game.settingData.resetTempSetting()},notify:function(e){switch(e){case this.Evts.UPDATE_SETTING_VIEW:this.updateSetting();break;case this.Evts.UPDATE_VIPLEVEL:this.updateVip()}},init:function(){var e=game.ClientSettingTypesCfg.getDatas();if(e){var t,a,i,n=this;n.skin;n.checkboxs=[];for(var s=0;s<e.length;s++){if(t=e[s],!(i=this.getComponent(t.bindNode)))return;(a=new game.SettingCheckBox).setCb(n.clickCheckBox,n),a.setCfg(t),n.checkboxs.push(a),i.addChild(a)}}else b8e.error("\u6ca1\u6709\u8bbe\u7f6e\u6309\u94ae\u7684\u914d\u7f6e\u6570\u636e\uff01\uff01")},clickCheckBox:function(e){this.send(this.Evts.CLICK_SETTING,e)},updateSetting:function(){for(var e,t,a,i=this.checkboxs,n=game.settingData.getTempSettingValue(game.SettingEnum.SPEED),s=game.settingData.getTempSettingValue(game.SettingEnum.FPS),o=0;o<i.length;o++){a=(e=i[o]).cfg.id,t=2==e.cfg.group?n==a-10:3==e.cfg.group?s==e.cfg.param:!!game.settingData.getTempSettingValue(a),e.setState(t)}},updateVip:function(){var e=this,t=game.mainRoleData.vipLevel,a=game.PlayBackSpeedRatioCfg.getData(1);if(a.vip>t){e.skin.vip7Alert.node.active=!0}else e.skin.vip7Alert.node.active=!1;if((a=game.PlayBackSpeedRatioCfg.getData(2)).vip>t){e.skin.vip9Alert.node.active=!0}else e.skin.vip9Alert.node.active=!1;if((a=game.PlayBackSpeedRatioCfg.getData(3)).vip>t){e.skin.vip15Alert.node.active=!0}else e.skin.vip15Alert.node.active=!1},onStageResize:function(){var e=b8e.stageHeight;this.setPosition(.5*(b8e.stageWidth-this.width),.5*(e+this.height))}});b8e.module.registerView(game.ME.Setting,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPATE_THRONE_SCORE:-1,C2V_UPATE_THRONE_RANK:-1,C_REQ_RANKINFO:-1,UPDATE_DATA:-1,V_REQ_RANKINFO:-1,V_UPDATE_THRONE_MONTHLY_RANK:-1,V_FOLLOW_CHAT:-1}),b8e.RC("$$game","$$ThroneEvts",e)}(),function(){var e=game.Control.extends({init:function(){var e=this;this._exitOptions={lang:3800,okcb:this.onClickReturn,thisArg:this},e.chat={chatType:game.ChatChannelType.CROSS,marqueeKey:"throne_open",funcType:game.ChatFuncType.CHAT_FUNC_THRONE},this.spotAlert=game.spotAlert.set(game.SAE.THRONE_ALERT,game.SAE.CS_ACTIVITY_ALERT)},ipc:function(){var e=this;e.evts={Rank:{C_UPDATE_DATA:e.updateRankInfo},MainUIChat:{C2C_REQ_ENTER_THRONE:e.enterThroneScene},CsActivity:{C2C_THRONE_GOTO:e.enterThroneScene},MainRole:{C_LEVEL_UP:e.levelUp}},e.gevts={SceneGEvts:{ENTER_SCENE:e.onEnterScene,SCENE_THRONE_MONARCH:e.sendTM,SCENE_THRONE_CHALLENGE_NPC:e.sendTCN,SCENE_THRONE_CHALLENGE_PLAYER_SUCCESS:e.sendTCPS,SCENE_THRONE_CHALLENGE_PLAYER_FAIL:e.sendTCPF,SCENE_THRONE_BE_CHALLENGE_SUCCESS:e.sendTBCS,SCENE_THRONE_BE_CHALLENGE_FAIL:e.sendTBCF}},e.handels={ThroneEnterResp:e.onThroneEnterResp,ThroneRankResp:e.onThroneRankResp,ThroneScoreAwardResp:e.onThroneScoreAwardResp,ThroneScoreMsg:e.onThroneScoreNotify}},notify:function(e){switch(e){case this.Evts.V2C_REQ_RANK:this.onReqRank();break;case this.Evts.V_REQ_RANKINFO:this.reqRankInfo()}},levelUp:function(){this.checkOpen(),this.checkOpenTime()},reqRankInfo:function(){game.rankData.isRankTypeCDEnd(game.RankType.Throne)&&this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.Throne)},updateRankInfo:function(){this.send(this.Evts.V_UPDATE_THRONE_MONTHLY_RANK)},onReqRank:function(){var e=game.SysTime.curTime;this._nextTime&&this._nextTime>e||(this._nextTime=e+5e3,this.sender.ThroneRankReq())},onClickReturn:function(){this.leaveScene()},onEnterScene:function(){this.checkOpen(),this.checkOpenTime(),game.challengeIcon.hide(),game.sceneData.getSceneType()==game.SceneType.THRONE&&(game.throneData.showLayerNotify(),game.throneData.challengeNotify())},checkOpen:function(){if(game.throneData.isFirst&&game.throneData.isOpen(!1)&&(game.throneData.isFirst=!1,!game.exploreScene.isInExploreScene())){game.module.show(game.ME.ThroneEnter);this.sendChat(null,"throne_open")}},sendTM:function(e){if(e&&e.data){var t=e.data,a=game.HtmlUtil.getText(game.Color.YELLOW,t);this.sendChat(a,"throne_monarch")}},sendTCN:function(){var e=game.HtmlUtil.getText(game.Color.YELLOW,game.throneData.diffScore);this.sendChat(e,"throne_challenge_npc"),this.onReqRank()},sendTCPS:function(){var e=this.getName();this.sendChat(e,"throne_challenge_player_success"),this.onReqRank()},sendTCPF:function(){var e=this.getName();this.sendChat(e,"throne_challenge_player_fail"),this.onReqRank()},sendTBCS:function(){var e=this.getName();this.sendChat(e,"throne_be_challenge_success"),this.onReqRank()},sendTBCF:function(){var e=this.getName();this.sendChat(e,"throne_be_challenge_fail"),this.onReqRank()},getName:function(){return game.HtmlUtil.getText(game.Color.YELLOW,game.throneData.targetName)+"|"+game.HtmlUtil.getText(game.Color.YELLOW,game.throneData.diffScore)},sendChat:function(e,t){this.chat.chatType=game.ChatChannelType.CROSS,this.chat.funcType=game.ChatFuncType.CHAT_FUNC_THRONE,this.chat.params=e,this.chat.clientParams=null,this.chat.marqueeKey=t,game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null),"throne_monarch"!=t&&game.throneData.resetChallengeData()},onThroneEnterResp:function(e){var t=e.readProtobuf(game.pb.ThroneEnterResponse);0<t.code?game.notice.noticeError(t.code):(b8e.module.isShowView(game.ME.ThroneEnter)&&game.module.hide(game.ME.ThroneEnter),game.throneData.isFirstEnterThroneScene&&(game.RuleView.inst().showView(game.ME.Throne),game.throneData.isFirstEnterThroneScene=!1),b8e.module.isShowView(game.ME.ActivitiesHall)&&game.module.hide(game.ME.ActivitiesHall))},onThroneRankResp:function(e){var t=e.readProtobuf(game.pb.ThroneRankResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.rank;game.throneData.setRanks(a),game.throneData.rankMonarch=t.monarchId,this.send(this.Evts.C2V_UPATE_THRONE_RANK)}},onThroneScoreAwardResp:function(e){var t=e.readProtobuf(game.pb.ThroneScoreAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.throneData.score=t.score,game.throneData.collected=t.collected,game.throneData.updeteUnclaimedScores(),this.send(this.Evts.C2V_UPATE_THRONE_SCORE))},onThroneScoreNotify:function(e){var t=e.readProtobuf(game.pb.ThroneScoreNotify);0<t.code?game.notice.noticeError(t.code):(game.throneData.score=t.score,game.throneData.collected=t.collected,game.throneData.diffScore=t.score-game.throneData.lastScore,game.throneData.isChallenging||0<game.throneData.diffScore&&game.notice.show(3807,game.throneData.diffScore),game.throneData.lastScore=t.score,game.throneData.updeteUnclaimedScores(),this.send(this.Evts.C2V_UPATE_THRONE_SCORE),this.dpt(this.Evts.C2V_UPATE_THRONE_SCORE))},btn_enter:function(){this.enterThroneScene()},enterThroneScene:function(){game.throneData.isOpen()&&this.sender.ThroneEnterReq()},btn_back:function(){game.alert.show(this._exitOptions)},leaveScene:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_EXIT)},left_btn:function(){game.throneData.gotoPerRankPage(),this.send(this.Evts.UPDATE_DATA)},right_btn:function(){game.throneData.gotoNextRankPage(),this.send(this.Evts.UPDATE_DATA)},desc_btn:function(){game.RuleView.inst().showView(game.ME.Throne)},jifen_btn:function(){b8e.module.isShowView(game.ME.ThroneRank)||game.module.show(game.ME.ThroneRank)},help_btn:function(){game.RuleView.inst().showView(game.ME.Throne)},get_prize:function(){this.sender.ThroneScoreAwardReq()},checkAlert:function(){this.spotAlert.alert=game.throneData.isOpening},checkOpenTime:function(){if(game.moduleOpen.checkOpen(game.ME.Throne)&&game.throneData.isFitWeek()){if(this.isEndTime())return void this.clearCheckOpenTime();this._timeObj||(this._timeObj=b8e.Timer.add(this,this._updateTime,1e3)),this._timeObj.reset(),this._timeObj.start()}else game.throneData.isOpening=!1},_updateTime:function(){var e=game.throneData.getEndTime();e<1||(e<game.SysTime.curTime?this.clearCheckOpenTime():(game.throneData.isOpening=game.throneData.isFitTime(),this.checkOpen(),this.checkAlert()))},isEndTime:function(){var e=game.SysTime.curTime;return game.throneData.getEndTime()<e},clearCheckOpenTime:function(){this._timeObj&&(b8e.Timer.remove(this,this._updateTime),this._timeObj=null,game.throneData.isOpening=!1,this.checkAlert())}}),t=game.Sender.extends({ipc:function(){this.msg={ThroneEnterReq:null,ThroneRankReq:null,ThroneScoreAwardReq:null}}}),a=[game.ME.ThroneEnter,game.ME.ThroneExit,game.ME.ThroneLayer,game.ME.ThroneRank,game.ME.ThroneMonthlyRank,game.ME.ThroneMain];b8e.module.registerControl(game.ME.Throne,e,game.ThroneEvts,t,a)}(),function(){var e;e=b8e.Enum({NONE:0,SCORE_AWARD:1,RANK:2,MONTHLY_RANK:3}),b8e.RC("$$game","$$ThroneCfgType",e)}(),function(){var t=void 0;t=b8e.PoolObject.extends({roleId:0,name:"",rank:0,score:0,scoreCollected:0,ctor:function(){this._super()},setData:function(e){if(e){this.roleId=e.roleId,this.name=e.name,this.rank=e.rank,this.score=e.score,this.scoreCollected=e.scoreCollected}},clearData:function(){this.roleId=0,this.name="",this.rank=0,this.score=0,this.scoreCollected=0},recycle:function(){this.clearData(),this._super()}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,255),t.get=function(e){return t.pool.get(e)},t.put=function(e){return e=t.pool.put(e)},b8e.RC("$$game","$$ThroneRankInfo",t)}(),function(){var e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e.PER_PAGE_COUNT=6,e.pageNum=1,e.score=0,e.lastScore=0,e.diffScore=0,e.collected=0,e._startTime=0,e._endTime=0,e.lastSceneEntiy=null,e.isFirst=!0,e.isFirstEnterThroneScene=!0,e.isChallenge=!1,e.isChallenging=!1,e.isPassive=!1,e.isWin=!1,e.sceneEntityTarget=null,e.targetType=-1,e.targetName="",e.rankMonarch=-1,e._throneCoolEndTime=0,e.isOpening=!1},resetChallengeData:function(){this.isChallenge=!1,this.isPassive=!1,this.isWin=!1,this.sceneEntityTarget=null,this.targetType=-1,this.targetName="",this.isChallenging=!1},setRanks:function(e){if(e&&!(e.length<1)){var t;if(this._ranks)for(;0<this._ranks.length;)(t=this._ranks.pop())&&game.ThroneRankInfo.put(t);this._ranks||(this._ranks=[]);for(var a,i=0,n=e.length,s=game.mainRoleData.roleId;i<n;i++)(a=e[i])&&((t=game.ThroneRankInfo.get()).setData(a),t.roleId==s&&(this._selfRankInfo=t),this._ranks.push(t))}},getRanks:function(){return this._ranks},getSelfRankInfo:function(){return this._selfRankInfo},getCfg:function(e,t){var a,i,n;if(this._typeDic&&(i=this._typeDic[e])&&(a=i[t]))return a;switch(e){case game.ThroneCfgType.SCORE_AWARD:n=game.ThroneScoreAwardCfg.getDatas();break;case game.ThroneCfgType.RANK:n=game.ThroneRankCfg.getCurDayCfgs();break;case game.ThroneCfgType.MONTHLY_RANK:n=game.ThroneMonthlyRankCfg.getDatas()}if(!n||n.length<1)return null;this._typeDic||(this._typeDic=[]),(i=this._typeDic[e])||(i=[],this._typeDic[e]=i);for(var s,o=n.length,r=0;r<o;r++)if(a=n[r])if(e==game.ThroneCfgType.SCORE_AWARD){if(t>=a.score){s=a.score;break}}else if((e==game.ThroneCfgType.RANK||e==game.ThroneCfgType.MONTHLY_RANK)&&t<=a.rank){s=a.rank;break}switch(e){case game.ThroneCfgType.SCORE_AWARD:a=game.ThroneScoreAwardCfg.getData(s);break;case game.ThroneCfgType.RANK:a=game.ThroneRankCfg.getCfgByRank(s);break;case game.ThroneCfgType.MONTHLY_RANK:a=game.ThroneMonthlyRankCfg.getData(s)}return a&&(i[t]=a),a},getRankInfoArrByPageByType:function(){this.pageNum<=0&&(this.pageNum=1);var e=this.PER_PAGE_COUNT;if(e<=0)return null;var t=game.rankData.getRankInfoArrByType(game.RankType.Throne);if(!t||t.length<1)return null;var a=(this.pageNum-1)*e,i=this.pageNum*e,n=t.length;if(i=Math.min(i,n),a<n)for(var s,o=[],r=a;r<i;r++)(s=t[r])&&o.push(s);return o},getPageCount:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.Throne);if(e&&0<e.length){var t=e.length;return Math.ceil(t/this.PER_PAGE_COUNT)}return 1},gotoNextRankPage:function(){this.pageNum<1&&(this.pageNum=1);var e=this.PER_PAGE_COUNT,t=game.rankData.getRankInfoArrByType(game.RankType.Throne);this.pageNum;this.pageNum*e<t.length&&this.pageNum++},gotoPerRankPage:function(){this.pageNum<1&&(this.pageNum=1);var e=this.PER_PAGE_COUNT,t=game.rankData.getRankInfoArrByType(game.RankType.Throne),a=(this.pageNum-1)*e;this.pageNum;a<t.length&&1<this.pageNum&&this.pageNum--},getMaxLayer:function(){if(this._maxLayer)return this._maxLayer;var e=game.ThroneMiscCfg.getData("throneMaxLayer");return e&&""!=e.value?(this._maxLayer=+e.value,this._maxLayer):void 0},getMaxScore:function(){if(this._maxScore)return this._maxScore;var e=game.ThroneMiscCfg.getData("throneMaxScore");return e&&""!=e.value?(this._maxScore=+e.value,this._maxScore):void 0},updeteUnclaimedScores:function(){var e=this.getFitScoreArr();if(e&&!(e.length<1)){this._unclaimedScoreArr?this._unclaimedScoreArr.length=0:this._unclaimedScoreArr=[];for(var t,a=0,i=e.length;a<i;a++)(t=e[a])>this.collected&&this._unclaimedScoreArr.push(t)}},getUnclaimedScores:function(){return this._unclaimedScoreArr},getFitScoreArr:function(){var e=game.ThroneScoreAwardCfg.getDatas();if(!e||e.length<1)return null;this._fitScoreArr?this._fitScoreArr.length=0:this._fitScoreArr=[];for(var t,a=0,i=e.length;a<i;a++)t=e[a],this.score>=t.score&&this._fitScoreArr.push(t.score);return this._fitScoreArr},getRemainArr:function(){var e=game.ThroneScoreAwardCfg.getDatas();if(!e||e.length<1)return null;this._collectedArr?this._collectedArr.length=0:this._collectedArr=[];for(var t,a=0,i=e.length;a<i;a++)(t=e[a]).score>this.score&&this._collectedArr.push(t.score);return this._collectedArr},showLayerNotify:function(){var e=game.sceneData.getLastConfig();if(!e||e.type==game.SceneType.THRONE){var t=game.mainRoleData.mapId,a=game.sceneData.lastSceneId,i=game.ThroneBaseCfg.getData(t),n=game.ThroneBaseCfg.getData(a);if(i&&n){i.layer>n.layer?game.notice.show(3808,this.diffScore,i.layer):i.layer<n.layer&&game.notice.show(3809,this.diffScore,i.layer)}}},setMonarchState:function(e){if(game.sceneData.getSceneType()==game.SceneType.THRONE&&e&&e.data){var t=e.data.heroModel;if(!t)return;var a=game.Color.GREEN;e.data.monarch?(a=game.Color.YELLOW,t.setAnim(game.AnimType.NICK_NAME,this.getNickName()),b8e.evt.dptG(game.SceneGEvts.SCENE_THRONE_MONARCH,e.data.name)):t.setAnim(game.AnimType.NICK_NAME,null),game.AvatarUtil.updateNickName(e),e.updateNameColor(a)}},getNickName:function(){if(this._throneNickNameModel)return this._throneNickNameModel;if(!this._throneNickNameModel){var e=game.ThroneMiscCfg.getData("throneNickNameModel");if(!e||""==e.value)return;this._throneNickNameModel=+e.value}return this._throneNickNameModel},isMaxLayer:function(){var e=game.mainRoleData.mapId,t=game.ThroneBaseCfg.getData(e);return!!t&&this.getMaxLayer()==t.layer},getThroneCoolTime:function(){if(this._throneCoolTime)return this._throneCoolTime;var e=game.ThroneMiscCfg.getData("throneCoolTime");return e&&""!=e.value?(this._throneCoolTime=+e.value,this._throneCoolTime):void 0},onAddVisibledCallback:function(e){this.setMonarchState(e)},mainChallengeMsg:function(e){var t=this;t.isChallenge=!0,t.isChallenging=!0,t.isPassive=!1,t.isWin=e.battlelog.win;var a=t.sceneEntityTarget;t.isWin?t.isChallenge&&a&&a.data&&(a.data.type==game.RoleType.Monster?t.targetType=game.RoleType.Monster:t.isMaxLayer()&&(t.targetName=a.data.name,t.targetType=a.data.type)):(t.targetType=game.RoleType.Hero,t.isChallenge&&a&&a.data&&(t.targetName=a.data.name))},sceneRoleChallengeMsg:function(e){var t={type:game.InstanceType.THRONE_PVE,turn:!0};this.isWin=!e.battlelog.win,this.targetType=game.RoleType.Hero,this.targetName=e.challengerName,this.isChallenge=!0,this.isChallenging=!0,this.isPassive=!0,game.challengeIcon.hide(),e.battlelog.win=!e.battlelog.win,game.playBack.play(e.battlelog,t),game.mainRole.transition(game.RoleStateType.ACTION_IDLE)},saveLastSceneRole:function(){if(this.isChallenge){var e=this.sceneEntityTarget;e&&e.data&&!this.isPassive&&(this.targetName=e.data.name,this.targetType=e.data.type)}},scenePlayEnd:function(){this.isChallenging=!1,this.isChallenge&&(this.isWin?this.isMaxLayer()&&this.challengeNotify():this.challengeNotify())},mainLeaveScene:function(){this.setCoolTime()},setCoolTime:function(){var e=game.SysTime.curTime,t=this.getThroneCoolTime();this._throneCoolEndTime=e+t*b8e.TimeUtil.SECOND_MICRO_SECONDS},getCountDown:function(){var e=game.SysTime.curTime;return this.getEndTime()-e},isFitOpen:function(){return!!this.isFitWeek()&&!!this.isFitTime()},isOpen:function(e){var t=!(0<arguments.length&&void 0!==e)||e;if(!game.moduleOpen.checkOpenWithTips(game.ME.Throne,t))return!1;if(!this.isFitOpen())return t&&game.notice.show(3802),!1;var a=game.SysTime.curTime;if(0<this._throneCoolEndTime&&this._throneCoolEndTime>a){var i=(this._throneCoolEndTime-a)/1e3>>0;return t&&0<i&&game.notice.show(3821,i),!1}return!0},isFitWeek:function(){var e=this.getOpenDays();if(!e||e.length<1)return!1;var t=b8e.TimeUtil.getDay(game.SysTime.curTime);return-1!=e.indexOf(t+"")},isFitTime:function(){var e=this.getOpenTimeArr();if(!e||e.length<1)return!1;var t=game.SysTime.curTime,a=this.getStartTime(),i=this.getEndTime();return a<=t&&t<=i},getStartTime:function(){if(0<this._startTime)return this._startTime;var e=this.getOpenTimeArr();if(!e||e.length<1)return 0;var t=e[0].split(":");if(!t||t.length<1)return 0;var a=game.SysTime.curTime,i=b8e.TimeUtil.getTodayTime(a);return this._startTime=i+b8e.TimeUtil.HOUR_MICRO_SECONDS*t[0]+b8e.TimeUtil.MINUTE_MICRO_SECONDS*t[1],this._startTime},getEndTime:function(){if(0<this._endTime)return this._endTime;var e=this.getOpenTimeArr();if(!e||e.length<1)return 0;var t=e[e.length-1].split(":");if(!t||t.length<1)return 0;var a=game.SysTime.curTime,i=b8e.TimeUtil.getTodayTime(a);return this._endTime=i+b8e.TimeUtil.HOUR_MICRO_SECONDS*t[0]+b8e.TimeUtil.MINUTE_MICRO_SECONDS*t[1],this._endTime},getOpenDays:function(){if(!this._throneOpenDays||this._throneOpenDays.length<1){var e=game.ThroneMiscCfg.getData("throneOpenDays");if(!e||""==e.value)return!1;this._throneOpenDays=e.value.split(",")}return this._throneOpenDays},getOpenTimeArr:function(){if(!this._throneOpenTimeArr||this._throneOpenTimeArr.length<1){var e=game.ThroneMiscCfg.getData("throneOpenTime");if(!e||""==e.value)return!1;this._throneOpenTimeArr=e.value.split("-")}return this._throneOpenTimeArr},setRoleState:function(e){e&&(this.lastSceneEntiy&&(this.lastSceneEntiy.data&&this.lastSceneEntiy.data.monarch?this.lastSceneEntiy.updateNameColor(game.Color.YELLOW):this.lastSceneEntiy.updateNameColor(null)),(this.lastSceneEntiy=e).updateNameColor(game.Color.RED),game.challengeIcon.show(e))},resetRoleState:function(){game.challengeIcon.hide(),this.removeRoleState()},removeRoleState:function(){this.lastSceneEntiy&&(this.lastSceneEntiy.data&&this.lastSceneEntiy.data.monarch?this.lastSceneEntiy.updateNameColor(game.Color.YELLOW):this.lastSceneEntiy.updateNameColor(null),this.lastSceneEntiy=null)},challengeNotify:function(){var e;(e=this).isChallenge&&((e=this).targetType==game.RoleType.Monster?b8e.evt.dptG(game.SceneGEvts.SCENE_THRONE_CHALLENGE_NPC):e.targetType==game.RoleType.Hero&&(e.isPassive?e.isWin?b8e.evt.dptG(game.SceneGEvts.SCENE_THRONE_BE_CHALLENGE_FAIL):b8e.evt.dptG(game.SceneGEvts.SCENE_THRONE_BE_CHALLENGE_SUCCESS):e.isWin?b8e.evt.dptG(game.SceneGEvts.SCENE_THRONE_CHALLENGE_PLAYER_SUCCESS):b8e.evt.dptG(game.SceneGEvts.SCENE_THRONE_CHALLENGE_PLAYER_FAIL)))}});game.throneData=game.throneData||new e}(),function(){var e=game.View.extends({_showModel:!1,ctor:function(){this._super(1030)},closeBtn:function(){this._super()},onStageResize:function(){var e=b8e.stageWidth-this.width;this.setPosition(e-17,320)}});b8e.module.registerView(game.ME.ThroneEnter,e)}(),function(){var e=game.View.extends({_isMoveUp:!1,_specialLayer:!0,ctor:function(){this._super(1031),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},onShow:function(){},onStageResize:function(){b8e.stageHeight;var e=b8e.stageWidth-this.width-10;this.setPosition(e,this.height+130)}});b8e.module.registerView(game.ME.ThroneExit,e)}(),function(){var e=game.View.extends({_specialLayer:!0,ctor:function(){this._super(1032),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},onShow:function(){this._timeObj?(this._timeObj.reset(),this._timeObj.start()):this._timeObj=b8e.Timer.add(this,this.updateEndTime,1e3),this.updateLayer()},onHide:function(){this._timeObj&&this._timeObj.stop()},updateEndTime:function(){var e=game.throneData.getCountDown(),t=game.TimeUtil.formatTimeSpace(e,3),a=(game.throneData.getMaxLayer(),game.throneData.isMaxLayer()?3820:3805);this.skin.lab_time.string=game.Lang.get(a,t)},updateLayer:function(){var e=game.sceneData.sceneId;if(0!=e){var t=game.ThroneBaseCfg.getData(e);if(t){this.skin.lab_title.string=t.layerName}}},onStageResize:function(){this.setPosition(b8e.stageWidth-137,b8e.stageHeight-110)}});b8e.module.registerView(game.ME.ThroneLayer,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1033),this.setSize(200,24)},setData:function(){var e=this.data,t=this.skin,a=void 0;switch(e.rank){case 1:a=6579;break;case 2:a=6580;break;case 3:a=6581;break;default:a=6582}t.lbl_rank.string=game.Lang.get(a,e.rank),t.lbl_name.string=game.Lang.get(a,e.name),t.lbl_point.string=game.Lang.get(a,e.score)}}),b8e.RC("$$game","$$ThroneMainRankItemView",e)}(),function(){var e=game.View.extends({_showModel:!1,_isMoveUp:!1,_specialLayer:!0,ctor:function(){this._super(1034),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e=this;e.anima1=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima1.addToParent(e.skin.anima1),e.anima1.load(game.ResCfg.getUrl(5019,1017)),e.anima2=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima2.addToParent(e.skin.anima2),e.anima2.load(game.ResCfg.getUrl(5019,1019)),e.anima3=b8e.Animator.get(game.AnimType.UI_EFFECT,1),e.anima3.addToParent(e.skin.anima3),e.anima3.load(game.ResCfg.getUrl(5019,1020)),e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.ThroneMainRankItemView,e._list.layout.spacingY=1,e._list.addToParent(e.skin.scrollview)},notify:function(e){switch(e){case this.Evts.C2V_UPATE_THRONE_SCORE:this.updateInfo();break;case this.Evts.C2V_UPATE_THRONE_RANK:this.updataRank()}},onShow:function(){this.anima1.play(),this.anima2.play(),this.anima3.play(),this.updateInfo(),this.send(game.ThroneEvts.V2C_REQ_RANK)},onHide:function(){},updateInfo:function(){var e=this.skin,t=game.throneData.getUnclaimedScores();if(t&&0<t.length)e.anima.active=!0,this.updateScoreInfo(t);else{e.anima.active=!1;var a=game.throneData.getRemainArr();if(a&&0<a.length)this.updateScoreInfo(a);else{var i=game.throneData.getMaxScore();e.lab_desc.string=game.Lang.get(3806,game.throneData.score,i),e.lab_prize.string=game.Lang.get(3816)}}},updateScoreInfo:function(e){var t=this.skin,a=e[0];game.throneData.score>=a?t.lab_desc.string=game.Lang.get(3806,game.throneData.score,a):t.lab_desc.string=game.Lang.get(51291,game.throneData.score,a);var i=game.ThroneScoreAwardCfg.getData(a);t.lab_prize.string=i?i.awardName:""},updataRank:function(){var e=game.throneData.getRanks();e&&0<e.length&&this._list&&this._list.setData(e);var t=game.throneData.getSelfRankInfo();t?(this.skin.lbl_rank.string=game.Lang.get(3818,t.rank),this.skin.lbl_point.string=game.Lang.get(3819,t.score)):(this.skin.lbl_rank.string=game.Lang.get(3818,0),this.skin.lbl_point.string=game.Lang.get(3819,0))},closeBtn:function(){this._super()},onStageResize:function(){b8e.stageHeight,b8e.stageWidth;this.setPosition(0,this.height+230)},smillRank:function(e){var t=this.skin;t.rankPoint.active=e,t.viewBtn1.active=e,t.viewBtnBg.active=!e},viewBtn1:function(){this.smillRank(!1)},viewBtn2:function(){this.smillRank(!0)}});b8e.module.registerView(game.ME.ThroneMain,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1035)},init:function(){var e=this.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.ThroneRankItemView,e.bindEnum=game.ME.ThroneMonthlyRank,e.layout.paddingLeft=0,e.addToParent(this.skin.list)},notify:function(e){switch(e){case game.ThroneEvts.V_UPDATE_THRONE_MONTHLY_RANK:this.updateRankInfo(),this.updatePageNum(),this.updageSelfInfo(),this.updateFirstRoleModel();break;case game.ThroneEvts.UPDATE_DATA:case game.RankEvts.UPDATE_DATA:this.updateRankInfo(),this.updatePageNum()}},onShow:function(){this.send(this.Evts.V_REQ_RANKINFO)},onHide:function(){var e=this.firstModel;if(e){var t=e.getAnimator(game.AnimType.BODY,1);t&&t.clear()}},updateRankInfo:function(){var e=game.throneData.getRankInfoArrByPageByType();e=e||[],this.skin.noTip.active=!e||e.length<1,this.rankList.setData(e)},updatePageNum:function(){var e=game.throneData.getPageCount(),t=game.throneData.pageNum;this.skin.lab_page.string=t+" / "+e},updageSelfInfo:function(){var e=this.skin,t=game.rankData.getSelfRankInfo(game.RankType.Throne);if(!t)return e.lab_rank.string=game.Lang.get(3817),void(e.lab_score.string=game.Lang.get(3819,0));var a=t.rank;e.lab_rank.string=a<=0?game.Lang.get(3817):game.Lang.get(3818,t.rank),e.lab_score.string=game.Lang.get(3819,t.score)},updateFirstRoleModel:function(){var e=game.rankData.getFirstRankTypeInfo(game.RankType.Throne);if(!e)return this.skin.lab_name.string=game.Lang.get(9331),void(this.skin.role_img.node.active=!0);this.skin.lab_name.string=e.name,this.skin.role_img.node.active=!1,this.updateUIModelByType(e)},updateUIModelByType:function(e){var t=this.roleData;t=t||(this.roleData=game.BaseRoleData.get(game.RoleType.Hero,1)),this.model&&this.model.release(),this.model=game.sceneRoleCreate.createUIRole(this.roleData),this.model.addToParent(this.skin.model);var a=t.heroModel;if(a&&(a.clear(),e)){a.setBody(game.RoleType.RANK,e.isMale?1001:1002);var i=this.followData;i=i||(this.followData=game.BaseRoleData.get(game.RoleType.RANK,1)),this.followModel&&this.followModel.release(),this.followModel=game.sceneRoleCreate.createUIRole(this.followData),this.followModel.addToParent(this.skin.followModel);var n=i.heroModel;if(n){n.clear(),n.type=game.RoleType.RANK;game.FosterType;if(!e||!e.info)return this.model.active=!1,void(this.followModel.active=!1);this.model.active=!0,this.followModel.active=!0;var s=e.info;s?(this.setHero(e.isMale,s.fashion,s.nickname),this.model.transition(game.RoleStateType.ACTION_IDLE),this.followModel.transition(game.RoleStateType.ACTION_IDLE)):this.model.clear()}}},setHero:function(e,t,a){var i=this.roleData.heroModel,n=game.AvatarUtil;if(i){if(i.setMale(e),i.type=game.RoleType.Hero,t&&i.setFashion(t),a){var s=game.NicknameCfg.getData(a);if(s){var o=n.getUIModel(s);i.setAnim(game.AnimType.NICK_NAME,o)}}n.updateUIModel(this.model)}},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.ThroneMonthlyRank,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1036),this.setSize(540,94)},init:function(){var e=this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=-8,e.layout.paddingRight=0,e.layout.paddingTop=13,e.layout.spacingX=-15},setData:function(){var e=this.data,t=this.skin,a=null;switch(e.rank){case 1:a=game.Color.RED;break;case 2:a=game.Color.BLUE;break;case 3:a=game.Color.GREEN;break;default:a=game.Color.BLACK}t.rank1.active=1==e.rank,t.rank2.active=2==e.rank,t.rank3.active=3==e.rank,t.rank4.active=3<e.rank,t.lab_rank.string=e.rank,t.nickName.node.active=e.roleId==game.throneData.rankMonarch,t.lab_name.node.color=a,t.lab_name.string=e.name,t.lab_score.string=game.Lang.get(3813,e.score);var i=e.rankType?game.ThroneCfgType.MONTHLY_RANK:game.ThroneCfgType.RANK,n=game.throneData.getCfg(i,e.rank);if(n){var s=game.CfgUtil.getPrizeListInfo(n.award,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_69);s&&this._prizeList&&this._prizeList.setData(s.items)}}}),b8e.RC("$$game","$$ThroneRankItemView",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(1037)},notify:function(e){switch(e){case this.Evts.C2V_UPATE_THRONE_RANK:this.updateRankInfo()}},init:function(){var e=this.skin;this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.ThroneRankItemView,this._list.bindEnum=game.ME.ThroneRank,this._list.layout.spacingY=5,this._list.addToParent(e.list);var t=this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(this.skin.prizeList),t.layout.paddingLeft=-8,t.layout.paddingRight=0,t.layout.paddingTop=15,t.layout.spacingX=-15},onShow:function(){this.send(game.ThroneEvts.V2C_REQ_RANK)},onHide:function(){},updateRankInfo:function(){var e=game.throneData.getRanks();this.skin.noTip.active=!e||e.length<1,e&&0<e.length&&this._list&&this._list.setData(e);var t=game.throneData.getSelfRankInfo();if(t){this.skin.lab_rank.string=game.Lang.get(3814,t.rank);var a=game.throneData.getCfg(game.ThroneCfgType.RANK,t.rank);if(a){var i=game.CfgUtil.getPrizeListInfo(a.award,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_69);i&&this._prizeList&&this._prizeList.setData(i.items)}}}});b8e.module.registerView(game.ME.ThroneRank,e)}(),function(){var e;e=b8e.Enum({NONE:0,C_SELECT_LIST:b8e.enc(),C_GET_PRIZE:b8e.enc(),C_SDK_ACHIEVEVIEW:b8e.enc(),V_SELECT_LIST:b8e.enc(),V_SELECT_TOGGLE:b8e.enc(),V_SHARE_SUCCESS:b8e.enc(),C_FRIST_GET:b8e.enc(),C2C_SHARE_SUCCESS:b8e.enc(),C2V_GET_AWARD:b8e.enc()}),b8e.RC("$$game","$$ShareEvts",e)}(),function(){var e;e=b8e.Object.extends({type:0,title:"",awards:null,isAlert:!1,select:!1,ctor:function(){this._super()},setData:function(e){this.type=e.group,this.title=e.showTitle}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ShareTypeInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,name:"",type:0,shareType:0,num:0,award:null,dailyNum:0,totalNum:0,isGet:!1,isCanGet:!1,isShare:!0,ctor:function(){this._super()},setData:function(e){this.id=e.shareId,this.name=e.showTitle,this.type=e.group,this.shareType=e.shareType,this.num=e.shareNum,this.lang=e.shareName,this.award=e.award},setNum:function(e){this.dailyNum=e.dailyShareNum,this.totalNum=e.totalShareNum}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ShareInfo",e)}(),function(){var e=b8e.Object.extends({dailyShareNum:0,totalShareNum:0,doubleNum:0,doubleExpTime:0,shareTime:0,firstShare:!1,firstShareGet:!1,shareTimeSpace:0,lastShareTimeSpace:0,isShareing:!1,showType:0,firstShareCfg:null,isAllGetAwards:null,ctor:function(){this._super(),this.share=b8e.HashMap.get(),this.btnList=[]},initShare:function(){if(!this._intShareList){var e=game.ShareAwardCfg.getDatas();if(e){for(var t=void 0,a=void 0,i=void 0,n=void 0,s=0;s<e.length;s++)(t=e[s])&&(t.showType?(this.firstShareCfg=t,this.firstShareCfg.id=t.shareId):((a=this.share.get(t.group))||((a=new game.ShareTypeInfo).setData(t),this.share.set(t.group,a),this.btnList.push(a)),a.awards||(a.awards=b8e.HashMap.get()),(n=(i=a.awards).get(t.shareId))||((n=new game.ShareInfo).setData(t),i.set(t.shareId,n)),this.showType||(this.showType=t.group,a.select=!0)));this._intShareList=!0}}},isShowBtn:function(){return null==this.isAllGetAwards&&this.updateIsAllGetAwards(),!this.isAllGetAwards},updateIsAllGetAwards:function(){this.isAllGetAwards=this.isAllGetAward()},isAllGetAward:function(){var e=this.getShareListByType(this.showType);if(!e||!e.awards)return!1;for(var t=e.awards.values(),a=t.length,i=0;i<a;i++){if(!t[i].isGet)return!1}return!0},setShareData:function(a){var e=this;e.initShare();var i=a.dailyShareNum,n=a.totalShareNum;i&&(e.dailyShareNum=i),n&&(e.totalShareNum=n);var t=game.WelfareMiscCfg.getData("dailyDoubleShareNum");e.doubleNum=t.value-a.dailyDoubleShareNum,e.doubleExpTime=a.doubleShareExpTime,e.checkFirstShare();var s=void 0,o=a.totalShareAwards;if(o){s=o.length;for(var r=void 0,g=0;g<s;g++)if((r=game.ShareAwardCfg.getData(o[g]))&&r.showType){e.firstShareGet=!0;break}}var l=e.getShareListByType(e.showType);l&&l.awards.forEach(function(e,t){t.setNum(a),t.isGet||(1==t.shareType?(t.isGet=a.dailyShareAward,t.isGet||(t.isCanGet=i>=t.num)):(o&&(t.isGet=-1!=o.indexOf(t.id)),t.isGet||(t.isCanGet=n>=t.num)))},e)},getShareListByType:function(e){return this.share.get(e)},getCurShareList:function(){var e=this.share.get(this.showType);if(e){var t=e.awards.values();return t.sort(this._sort),t}},getInfoById:function(e){for(var t=this.share.values(),a=void 0,i=void 0,n=void 0,s=0,o=t.length;s<o;s++)if((n=t[s])&&n.awards&&(a=n.awards)&&(i=a.get(e)))return i;return null},getShareBtnList:function(){return this.btnList},getShareTitle:function(){return game.Lang.get(4301)},getShareMessage:function(){var e=game.Lang.get(4302);if(e){var t=e.split("|");return t&&0<t.length?t[Math.random()*t.length>>0]:game.Lang.get(9446)}},setShareBtn:function(e){var t=this.btnList[this.showType-1],a=this.btnList[e-1];t&&(t.select=!1),a.select=!0,this.showType=e},_sort:function(e,t){return e.isGet&&!t.isGet?1:!e.isGet&&t.isGet?-1:e.isCanGet&&!t.isCanGet?-1:!e.isCanGet&&t.isCanGet?1:e.id-t.id},setShareTime:function(e){if(0<this.doubleNum)if(0==e)this.shareTime=e;else{var t=game.WelfareMiscCfg.getData("shareCd");t&&(this.shareTime=t.value*b8e.TimeUtil.SECOND_MICRO_SECONDS+game.SysTime.curTime)}},setShareGet:function(e){if(e){var t=this.getInfoById(e.id);t&&(t.isGet=!0,t.isCanGet=!1),e.showType&&(this.firstShareGet=!0),this.checkFirstShare()}},getShowIconType:function(){return this.getIsCanShowShare()?this.firstShareGet?1:0:1},getIsCanShowShare:function(){if(isNaN(this.canShowShare)){this.canShowShare=!0;var e=game.WelfareMiscCfg.getData("shieldShare");if(e&&e.value&&(this.shieldShareList=e.value.split(","),0<this.shieldShareList.length)){var t=game.LoginConfig.gameChannelId+"",a=-1<this.shieldShareList.indexOf(t);this.canShowShare=!a}}return this.canShowShare},getShareProgress:function(e){var t=e.shareType,a=e.num,i={},n=void 0;switch(t){case 1:n=this.dailyShareNum>=a?a:this.dailyShareNum;break;case 2:n=this.totalShareNum>=a?a:this.totalShareNum}return i.color=a<=n?game.Color.GREEN:game.Color.RED,i.str=game.Lang.get(9309,n+"/"+a),i},checkFirstShare:function(){this.firstShare=0<this.totalShareNum},checkAllAlert:function(){var i=this,n=!1;return i.share.forEach(function(e,t){var a=t.awards;a&&a.forEach(function(e,t){t.isCanGet&&(n=!0)},i)},i),n},checkBtnAlert:function(){var i=this;i.share.forEach(function(e,a){a.isAlert=!1;var t=a.awards;t&&t.forEach(function(e,t){t.isCanGet&&!a.isAlert&&(a.isAlert=!0)},i)},i)}});game.shareData=game.shareData||new e}(),function(){var e=game.Control.extends({showToggle:function(e){b8e.isWeChatGame&&(game.IS_YUNYOU_MZ||game.IS_YUNYOU)&&!game.JunHaiSdk.isOpenYYPay||this.selectToggle(e)},btn_toggle_1:function(){this.showToggle(0)},btn_toggle_2:function(){this.showToggle(1)},btn_toggle_3:function(){this.selectToggle(2)},selectToggle:function(e){this.send(this.Evts.V_SELECT_TOGGLE,e)}});b8e.module.registerControl(game.ME.ShareMain,e,game.ShareEvts)}(),function(){var e=game.Control.extends({init:function(){this._super(),this.data=game.shareData,this.spotAlert=game.spotAlert.set(game.SAE.SHARE_ALERT,game.SAE.ACHIEVE_ALERT_BASE),cc.game.on(cc.game.EVENT_SHOW,this.windowShow,this),cc.game.on(cc.game.EVENT_HIDE,this.windowHide,this),this.canClick=!0},ipc:function(){this.gevts={VerifyAwardGEvts:{SHARE_TYPEA_SUCCESS:this.delayShareNum}},this.evts={Achieve:{C_SDK_ACHIEVEVIEW:this.shareSDKOK},Guaji:{C_SDK_SHARE:this.shareSDKOK},Welfare:{C_INIT_MODEL:this.checkAlert}},this.handels={ShareNumResp:this.shareNumResp,ShareAwardResp:this.shareAwardResp}},notify:function(e,t){switch(e){case this.Evts.C_GET_PRIZE:this.getAward(t)}},shareNumResp:function(e){var t=e.readProtobuf(game.pb.ShareNumResponse);0<t.code?game.notice.noticeError(t.code):(this.data.setShareData(t),this.data.setShareTime(),this.checkAlert(),this.send(this.Evts.V_SHARE_SUCCESS),this.dpt(this.Evts.C2C_SHARE_SUCCESS))},shareAwardResp:function(e){var t=this,a=e.readProtobuf(game.pb.ShareAwardResponse);0<a.code?game.notice.noticeError(a.code):(t.data.setShareGet(t.shardAward),t.checkAlert(),b8e.module.isShowView(game.ME.ShareTip)&&game.module.hide(game.ME.ShareTip),t.dpt(t.Evts.C_FRIST_GET),t.data.updateIsAllGetAwards(),t.send(t.Evts.C2V_GET_AWARD),t.data.isShowBtn()||t.dptG(game.ActiveBarGEvts.REFRESH_BTNS))},shareSDKOK:function(){this.data.isShareing=!0,game.LoginConfig.canShare||null==this.key&&(this.key=b8e.setTimeout(this.delayShareNum,this,500)),game.sdk.share(game.VerifyAwardGEvts.SHARE_TYPEA_SUCCESS)},delayShareNum:function(){this.nextSuccess=!1,void 0!==this.key&&(b8e.clearTimeout(this.key),this.key=void 0),this.data.shareTime&&this.data.shareTime>game.SysTime.curTime?game.notice.show(9308):this.sender.ShareNumReq()},checkAlert:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.spotAlert.alert=this.data.checkAllAlert())},getAward:function(e){this.shardAward=e,this.sender.ShareAwardReq(this.shardAward.id)},windowShow:function(){this.shareTimer||(this.shareTimer=b8e.Timer.add(this,this.delayWindowShow,100),this.shareTimer.start())},delayWindowShow:function(){var e=game.shareData;e.shareTimeSpace=game.SysTime.curTime,e.isShareing&&(e.isShareing=!1,this.shareCall()),this.clearTimer()},clearTimer:function(){this.shareTimer&&(b8e.Timer.remove(this,this.delayWindowShow),this.shareTimer=null)},windowHide:function(){game.shareData.lastShareTimeSpace=game.SysTime.curTime},shareCall:function(){this.nextSuccess=!0;var e=game.shareData.shareTimeSpace,t=game.shareData.lastShareTimeSpace;if(e&&t&&2e3<e-t)if(this.nextSuccess)this.delayShareNum();else{if(this.nextSuccess=3<Math.round(10*Math.random()),!this.nextSuccess)return this.nextSuccess=!0,game.notice.show(9306),void game.sdk.share(game.VerifyAwardGEvts.SHARE_TYPEB_SUCCESS);this.nextSuccess=!0,this.delayShareNum()}else game.notice.show(9306)},btn_share:function(){this.shareSDKOK()},btn_get:function(){this.shardAward=this.data.firstShareCfg,this.sender.ShareAwardReq(this.shardAward.id)}}),t=[game.ME.ShareTip],a=game.Sender.extends({ipc:function(){this.msg={ShareNumReq:null,ShareAwardReq:this.shareAwardReq}},shareAwardReq:function(e){var t=game.pb.ShareAwardRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.ShareView,e,game.ShareEvts,a,t)}(),function(){var e;e=game.ListItem.extends({_icon:null,ctor:function(){this._super(),this.setSize(105,105)},init:function(){this._icon=game.GridUtil.createItemIcon(game.IconSizeEnum.GRID_SIZE_105),this._icon.setPosition(52.5,-52.5),this._icon.addToParent(this),this._icon.setClickCb(this.clickCb,this)},setData:function(){game.GridUtil.setItemIcon(this._icon,this.data,!1,2)},clickCb:function(){this.data&&(game.tipsData.setInfo(this.data),game.module.show(game.ME.ItemTips))}}),b8e.RC("$$game","$$AchievementAwardItem",e)}(),function(){var e;e=game.ListItem.extends({_infoList:null,ctor:function(){this._super(15),this.setSize(446,150)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.awardList.itemRender=game.FosterAchievementAwardItem,this.awardList.layout.paddingLeft=0,this.awardList.layout.paddingRight=0,this.awardList.layout.paddingTop=0,this.awardList.layout.spacingX=3,this.awardList.addToParent(this.skin.prizeList)},clearData:function(){this.awardList&&this.awardList.clear()},setData:function(e){if(e){var t=this,a=t.skin,i=game.shareData.getShareProgress(e);i&&(a.lbl_progress.setColor(i.color),a.lbl_progress.string=i.str),a.titleLab.string=e.lang,a.getPrizeBtn.node.active=!e.isGet,a.lbl_progress.node.active=!e.isGet,a.isGet.node.active=e.isGet,a.gray.active=!e.isCanGet,a.red_spot.active=e.isCanGet,a.label_0.node.string=e.isCanGet?game.Lang.get(9057):game.Lang.get(9311),t._itemInfoList||(t._itemInfoList=[]),t._infoList||(t._infoList=[]),t._infoList.length=0;for(var n=e.award,s=0;s<n.length;s++){var o=n[s];0<o.Id&&(t._itemInfoList[s]=game.ItemUtil.createBaseItemInfo(o.Id,o.Num,t._itemInfoList[s]),t._infoList.push(t._itemInfoList[s]))}t.awardList.setData(t._infoList)}},getPrizeBtn:function(){this.send(game.ShareEvts.C_GET_PRIZE,this.data)}}),b8e.RC("$$game","$$ShareAwardItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(14),this.setSize(146,68)},setData:function(e){var t=this.skin;t.lbl_btn.string=e.title,t.btn_choose.node.active=e.select,t.redPoint.node.active=e.isAlert},btn_bg:function(){this.send(game.ShareEvts.C_SELECT_LIST,this.data.type)}}),b8e.RC("$$game","$$ShareTypeItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(958),this.toggles={toggle_btn_1:game.ME.WuShengMain}},notify:function(e,t){switch(e){case game.ShareEvts.V_SELECT_TOGGLE:this.toggleSelect(t)}},onShow:function(){},onHide:function(){game.shareData.isShareing=!1},toggleSelect:function(e){this._super(e)},shareAlert:function(e){this.skin.red_spot_1.active=e.alert},achieveAlert:function(e){this.skin.red_spot_2.active=e.alert},wushengAlert:function(e){this.skin.red_spot_3.active=e.alert}});b8e.module.registerView(game.ME.ShareMain,e)}(),function(){var e;e=b8e.SkinWidget.extends({ctor:function(){this._super(),this.fadeEnabel=!0},init:function(){var e=this.arrowImg=b8e.Sprite.get();e.setAnchor(1,1),e.addToParent(this),e.loadTexture(game.ResCfg.getImgUrl("sharpTip/shareArrow")),this.setLocalZOrder(9999)},onShow:function(){this.onStageResize(),b8e.evt.onC(b8e.stage,this.onClickStage,this)},closePanle:function(){b8e.evt.offC(b8e.stage,this.onClickStage,this),this.removeFromParent(),this.hide()},onClickStage:function(){this.closePanle()},getModelTouchClose:function(){return!1},onStageResize:function(){this.setPosition(b8e.stageWidth-this.width,b8e.stageHeight)},dispose:function(){this.closePanle(),this._super()}}),b8e.RC("$$game","$$ShareArrow",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(960)},init:function(){var e=this;e._super(),e.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),e.awardList.itemRender=game.AchievementAwardItem,e.awardList.layout.spacingX=2,e.awardList.addToParent(e.skin.prizeList),e.skin.bg.loadTexture(game.ResCfg.getUrl(46)),e.roleData=game.BaseRoleData.get(game.RoleType.Foster,1),e.role=game.sceneRoleCreate.createUIRole(e.roleData),e.role.addToParent(e.skin.model)},notify:function(e){switch(e){case this.Evts.V_SHARE_SUCCESS:this.updataBtn()}},onShow:function(){this.updateAward(),this.updataBtn()},onHide:function(){game.shareData.isShareing=!1},updateAward:function(){var e=this;e.skin;e._itemInfoList||(e._itemInfoList=[]),e._infoList||(e._infoList=[]),e._infoList.length=0;for(var t=game.shareData.firstShareCfg.award,a=t.length,i=0;i<a;i++){var n=t[i];0<n.Id&&(e._itemInfoList[i]=game.ItemUtil.createBaseItemInfo(n.Id,n.Num,e._itemInfoList[i]),e._infoList.push(e._itemInfoList[i]))}e.awardList.setData(e._infoList),e.updataBtn()},updataBtn:function(){var e=game.shareData.firstShare,t=game.shareData.firstShareGet;this.skin.btn_share.active=!e&&!t,this.skin.btn_get.active=e&&!t,this.skin.isGet.active=t}});b8e.module.registerView(game.ME.ShareTip,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(959)},init:function(){this._super(),this.awardList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.awardList.itemRender=game.ShareAwardItem,this.awardList.addToParent(this.skin.scrollGrid),this.awardList.bindEnum=game.ME.ShareView,this.awardList.layout.spacingY=5,this.skin.banner.loadTexture(game.ResCfg.getUrl(10006))},notify:function(e){switch(e){case this.Evts.V_SHARE_SUCCESS:this.updataAwardList(),this.updateShareTime();break;case this.Evts.C2V_GET_AWARD:this.updataAwardList()}},onShow:function(){this.updataAwardList(),this.updateShareTime()},onHide:function(){game.shareData.isShareing=!1},updataAwardList:function(){var e=game.shareData.getCurShareList();this.awardList.scrollToTop(),this.awardList.setData(e)},updateShareTime:function(){var e=game.shareData.shareTime,t=game.SysTime.curTime;!e||e<=t||(this.updateTime(),this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.updateTime,1e3))},updateTime:function(){var e=game.shareData.shareTime-game.SysTime.curTime;if(e<=0)return this.stopTime(),void(this.skin.lbl.string=game.Lang.get(53227));this.skin.lbl.string=b8e.TimeUtil.formatTime(e)},stopTime:function(){this.timer&&this.timer.stop()}});b8e.module.registerView(game.ME.ShareView,e)}(),function(){var e;e=b8e.Enum({NONE:0,C_SELECT_LIST:b8e.enc(),C_GET_PRIZE:b8e.enc(),C_GET_MORE_PRIZE:b8e.enc(),C_SDK_ACHIEVEVIEW:b8e.enc(),C_SHWO_TIP:b8e.enc(),V_SELECT_LIST:b8e.enc(),V_SHWO_TIP:b8e.enc(),V_RED_POINT:b8e.enc(),V_UPDATA_POINT:b8e.enc(),C2C_UPDATE_SHARE_STATE:b8e.enc(),C2C_SET_SHOW_AWARD:b8e.enc(),C2C_SET_PREVIEW_AWARD:b8e.enc(),C_ONSHOW:b8e.enc(),C2C_GET_NEW:b8e.enc()}),b8e.RC("$$game","$$AchievementEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,RoleLv:1,Power:2}),b8e.RC("$$game","$$AchievementType",e)}(),function(){var e=void 0;e=b8e.Object.extends({name:"",tag:0,type:0,awards:null,menuType:0,showAll:!1,isSelect:!1,isAlert:!1,ctor:function(){this._super()},setData:function(e){this.name=e.name,this.type=e.group;var t=game.AchievementAllBtnCfg.getData(e.group);t&&(this.tag=t.btnTag,this.menuType=t.menuType,this.showAll=!!t.showAll)}}),b8e.BindingUtil.bind(e),e.poolCall=!0,b8e.RC("$$game","$$AchievementBtnInfo",e)}(),function(){var e=void 0;e=b8e.Object.extends({name:"",sort:0,type:0,list:null,isSelect:!1,isAlert:!1,ctor:function(){this.list=[],this._super()},setData:function(e){this.name=e.name,this.type=e.type,this.sort=e.sort}}),b8e.BindingUtil.bind(e),e.poolCall=!0,b8e.RC("$$game","$$AchievementMenuBtnInfo",e)}(),function(){var e=void 0;e=b8e.Object.extends({id:0,cfg:null,progress:0,isGet:!1,isCanGet:!1,isShare:!1,isShow:!1,ctor:function(){this._super()},setData:function(e){this.id=e.id,this.cfg=e}}),b8e.BindingUtil.bind(e),e.poolCall=!0,b8e.RC("$$game","$$AchievementInfo",e)}(),function(){var e=b8e.Object.extends({selectType:0,shareTimeSpace:0,lastShareTimeSpace:0,achievePoint:0,achieveTotalPoint:0,pointId:0,ctor:function(){this._super(),this.btnList=b8e.HashMap.get(),this.finishList=[],this.deilyList=[],this.cfgIndex=0,this._achieveList={},this._cfgObj1={group:0}},initBtnData:function(e,t,a){if(this.cfgIndex>e.length-1)return this.cfgIndex=0,void(t&&a&&t.call(a,data));var i=e[this.cfgIndex];if(this.getInfoByType(i.group))return this.cfgIndex++,void this.initBtnData(e);this.initBtnByType(i.group,e)},initBtnByType:function(e,t){game.AchievementAllBtnCfg.getData(e)&&(this.selectType||(this.selectType=e),this._cfgObj1.group=e,game.AchievementCfg.getDataAsync(this._cfgObj1,this.initBtnInfo,this,!0,!0,!0,[e,t]))},firstShow:function(){if(!this._initBtn){var e=game.AchievementAllBtnCfg.getDatas();e&&(this.initBtnData(e),this._initBtn=!0)}},initBtnInfo:function(e,t,a){if(e&&!(e.length<1)&&t){var i=this.getInfoByType(t);if(!i){for(var n=void 0,s=void 0,o=b8e.HashMap.get(),r=0,g=e.length;r<g;r++)if(s=e[r]){0==r&&(i=new game.AchievementBtnInfo).setData(s),(n=new game.AchievementInfo).setData(s),this._awards&&-1!==this._awards.indexOf(n.id)&&(n.isGet=!0);var l=this._achieveList[t+"_"+s.subType];l&&!n.isGet&&(n.progress=l.progress,n.isCanGet=this.getAwardFinish(l,n)),o.set(s.id,n)}i.isSelect=this.selectType==t,i.awards=o,this.btnList.set(t,i),this.cfgIndex++,this.initBtnData(a)}}},setMsgData:function(e,t,a){this._awards=e.Awards,this.achievePoint=e.point,this.achieveTotalPoint=e.totalPoint,this.pointId=e.pointAwardId;for(var i=e.list,n=void 0,s=0,o=i.length;s<o;s++)(n=i[s])&&(this._achieveList[n.group+"_"+n.subType]=n);this.initBtnData(i,t,a)},setAchieveFinish:function(e){var t=this.getInfoByType(e.group);if(t)for(var a=t.awards.values(),i=void 0,n=!1,s=void 0,o=a.length;-1<o;o--)(i=a[o])&&!i.isGet&&i.cfg.subType==e.subType&&((s=this.getAwardFinish(e,i))&&(i.isNew=!1,i.isCanGet||(i.isNew=!0),i.isCanGet=s),i.progress=e.progress,!n&&i.isShow&&(n=!0),n||i.isCanGet&&this.checkFinishList(i)&&this.checkFinishGet(i)&&(i.isShow=!0,this.finishList.push(i)))},setSelect:function(e){for(var t=this.getBtnList(),a=void 0,i=0,n=t.length;i<n;i++)(a=t[i])&&(a.isSelect=a.type==e);this.selectType=e},setTripleShareAward:function(e){if(!e.isShare){var t=game.AchievementMiscCfg.getData("shareAwardMultiple");if(t){for(var a=e.cfg.showItems,i=void 0,n=0,s=a.length;n<s;n++)(i=a[n])&&(i.Num=i.Num*t.value);e.isShare=!0}}},setDeilyList:function(){if(!(this.deilyList.length<0)){for(var e=0,t=this.deilyList.length;e<t;e++)this.setAchieveFinish(this.deilyList[0]);this.deilyList.length=0}},getInfoByType:function(e){var t=this.btnList.get(e);return t||null},getInfoById:function(e,t){return t=t||this.selectType,this.getInfoByType(t).awards.get(e)},getBtnList:function(){var e=this.btnList.values();return e.sort(this.btnSort),e},getAwardListByType:function(e){e=e||this.selectType;var t=this.getInfoByType(e);if(t){var a=t.awards.values();return a.sort(this.achieveSort),a}},getAwardById:function(e){return this.getInfoByType(e)},getProgress:function(e){var t=e.cfg,a=(t.group,void 0),i=void 0,n=void 0,s={str:"\u8fdb\u5ea6:"};return a=e.progress,i=t.progress,t.compareType?a<=i&&(a=i,n=!0):i<=a&&(a=i,n=!0),1e4<=a&&(a=game.CCommonUtil.replaceNum(a,2)),1e4<=i&&(i=game.CCommonUtil.replaceNum(i,2)),s.color=n?game.Color.GREEN:game.Color.RED,s.str=game.Lang.get(9309,a+"/"+i),s},getAwardFinish:function(e,t){return t.cfg.compareType?e.progress<=t.cfg.progress:e.progress>=t.cfg.progress},getConfigByType:function(e,t){var a=void 0,i=game.AchievementType,n=e.cfg;switch(t){case i.NickName:a=game.NicknameCfg.getData(n.subType);break;case i.Fashion:a=game.SuitSkinCfg.getData(n.subType);break;case i.Map:a=game.SceneCfg.getData(n.subType);break;case i.ActivatePet:a=game.PartnerCfg.getData(n.subType)}return a},autoSelectBtn:function(){var e=this.getInfoByType(this.selectType);if(!e||!e.isAlert){for(var t=this.getBtnList(),a=void 0,i=void 0,n=0,s=t.length;n<s;n++)if((a=t[n])&&a.isAlert){if(a.isAlert&&a.isSelect){i=a.type;break}if(a.isAlert&&!a.isSelect){i=a.type;break}}i&&this.setSelect(i)}},btnSort:function(e,t){return e.tag-t.tag},achieveSort:function(e,t){return e.isGet&&!t.isGet?1:!e.isGet&&t.isGet?-1:e.isCanGet&&!t.isCanGet?-1:!e.isCanGet&&t.isCanGet?1:e.id-t.id},checkFinishList:function(e){if(!this.finishList||!e.cfg.showtype)return!1;if(this.finishList&&this.finishList.length<1)return!0;for(var t=void 0,a=0,i=this.finishList.length;a<i;a++)if((t=this.finishList[a])&&(t.id==e.id||t.type==e.cfg.type))return!1;return!0},checkFinishGet:function(e){var t=this.getInfoByType(e.cfg.group);if(t){for(var a=t.awards.values(),i=a.length,n=void 0,s=0;s<i;s++)if((n=a[s])&&n.isGet&&n.id>e.id)return!1;return!0}},checkInfoAlert:function(){for(var e=this.getBtnList(),t=void 0,a=void 0,i=void 0,n=0,s=e.length;n<s;n++)if(t=e[n]){a=t.awards.values(),t.isAlert=!1;for(var o=0,r=a.length;o<r;o++)if((i=a[o])&&i.isCanGet){t.isAlert=!0;break}}},checkAllInfoCanAnyAlert:function(){if(this.checkInfoAlert(),this.checkBoxAlert())return!0;for(var e=this.getBtnList(),t=void 0,a=0,i=e.length;a<i;a++)if((t=e[a])&&t.isAlert)return!0;return!1},checkBoxAlert:function(){var e=game.AchievementAwardTaskCfg.getData(this.pointId);return!!e&&this.achievePoint>=e.num},ceilFinishAchieve:function(){this.finishList.length=0},checkGroupIsInit:function(e){return!!e&&!!this.getInfoByType(e.group)},currMenuType:0,getMenuBtnList:function(){this.menuBtnList||this.initMenuBtnList();for(var e=this.menuBtnList.values(),t=void 0,a=void 0,i=void 0,n=0,s=e.length;n<s;n++){(t=e[n]).isSelect=t.type==this.currMenuType,a=t.list,t.isAlert=!1;for(var o=0,r=a.length;o<r;o++)if((i=this.btnList.get(a[o]))&&i.isAlert){t.isAlert=!0;break}}return this.menuBtnList.values()},initMenuBtnList:function(){this.menuBtnList=b8e.HashMap.get();for(var e=void 0,t=this.btnList.values(),a=void 0,i=void 0,n=void 0,s=0,o=t.length;s<o;s++)!(i=(a=t[s]).menuType)||i<1||((e=this.menuBtnList.get(i))||(e=new game.AchievementMenuBtnInfo,n=game.AchievementBtnMenuCfg.getData(i),e.setData(n)),e.list.indexOf(a.type)<0&&e.list.push(a.type),this.menuBtnList.set(i,e))},getNewAwardListByType:function(e){var t=this;e=e||t.currMenuType;var a=t.menuBtnList.get(e);if(a){t.newAwardList||(t.newAwardList=[]);for(var i=a.list,n=void(t.newAwardList.length=0),s=void 0,o=void 0,r=0,g=i.length;r<g;r++)(n=t.btnList.get(i[r]))&&((s=n.awards.values()).sort(t.achieveSort),n.showAll?t.newAwardList=t.newAwardList.concat(s):(o=t.getShowItemBy(s))&&t.newAwardList.push(o));return t.newAwardList.sort(t.achieveSort),t.newAwardList}},getShowItemBy:function(e){if(e){for(var t=e.length,a=void 0,i=void 0,n=0;n<t;n++)if(i=(a=e[n]).cfg.compareType?a.progress>=a.cfg.progress:a.progress<a.cfg.progress,a.isCanGet||i)return a;return 0<e.length?a=e[t-1]:null}},autoSelectMenuBtn:function(){var e=this.menuBtnList.get(this.currMenuType);if(!e||!e.isAlert){for(var t=this.menuBtnList.values(),a=void 0,i=void 0,n=0,s=t.length;n<s;n++)if((a=t[n])&&a.isAlert&&a.isAlert){i=a.type;break}i&&(this.currMenuType=i)}},getFirstShowMenuType:function(){for(var e=this.getMenuBtnList(),t=void 0,a=1,i=0,n=e.length;i<n;i++)if((t=e[i])&&t.isAlert){a=t.type;break}return a}});game.achievementData=game.achievementData||new e}(),function(){var e=game.Control.extends({isAuto:!1,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ACHIEVE_ALERT,game.SAE.DAILY_FULI),this.updateData=b8e.createMap(),this._modelData=game.achievementData},ipc:function(){var e=this;e.gevts={InstanceEvts:{G_STOP_PLAY:e.playStop}},e.evts={AchieveTip:{C_GET_PRIZE:e.getTipAward,C_GET_MORE_PRIZE:e.getTipAward,C_SDK_ACHIEVEVIEW:e.shareSDKOK},Back:{C_BACK_UPDATE_ITEMINFO:e.checkAlert},MainRole:{C_SPRITE_STATE_CHANGE:e.powerChange}},e.handels={AchievementModelResp:e.AchievementModelResp,AchievementAwardResp:e.AchievementAwardResp,AchievementMsg:e.AchievementNotify,AchievementPointResp:e.AchievementPointResp}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.AchievementModelReq()},powerChange:function(){var e=this.updateData;e.group=game.AchievementType.Power,e.progress=game.mainRoleData.power,e.subType=0,this.updateAchievement(this.updateData)},notify:function(e,t){var a=this;switch(e){case a.Evts.C_SELECT_LIST:if(a._modelData.currMenuType==t)return;a._modelData.currMenuType=t,a.send(a.Evts.V_SELECT_LIST);break;case a.Evts.C_GET_PRIZE:case a.Evts.C_GET_MORE_PRIZE:a.getAward(t);break;case a.Evts.C_SDK_ACHIEVEVIEW:a.shareSDKOK(t);break;case a.Evts.C_ONSHOW:a.checkAlert()}},AchievementModelResp:function(e){var t=e.readProtobuf(game.pb.AchievementModel);0<t.code?game.notice.noticeError(t.code):(this._initData=!0,this._modelData.setMsgData(t,this.checkAlert,this))},AchievementAwardResp:function(e){var a=this,i=e.readProtobuf(game.pb.AchievementAwardResponse);0<i.code?game.notice.noticeError(i.code):(a._showTip&&(a._modelData.finishList.splice(0,1),a._showTip=!1),a._modelData.achievePoint=i.point,a._modelData.achieveTotalPoint=i.totalPoint,a.acObj||(a.acObj={}),a.acObj.id=i.id,game.AchievementCfg.getDataAsync(a.acObj,function(e){var t=a._modelData.getInfoById(i.id,e.group);t&&(t.isGet=!0,t.isCanGet=!1,a.checkAlert(),a.isShowTip(),game.moduleOpen.checkOpen(game.ME.Achieve)&&(a._modelData.autoSelectMenuBtn(),a.send(a.Evts.V_SELECT_LIST),a.send(a.Evts.V_UPDATA_POINT)))},a),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},AchievementNotify:function(e){var t=e.readProtobuf(game.pb.AchievementNotify);0<t.code?game.notice.noticeError(t.code):t.data&&this.updateAchievement(t.data)},updateAchievement:function(e){var t=this;t._initData?t._modelData.checkGroupIsInit(e)?(t._modelData.setAchieveFinish(e),t.checkIsNew(e.group),t.notifyCallback(e.group)):t._modelData.initBtnByType(e.group,t.initCallback,t,e):(t._modelData.deilyList||(t._modelData.deilyList=[]),t._modelData.deilyList.push(e),t.notifyCallback(e.group))},AchievementPointResp:function(e){var t=e.readProtobuf(game.pb.AchievementPointResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.AchievementAwardTaskCfg.getData(this._modelData.pointId);if(a){var i=b8e.createMap();i.awards=a.award,i.moduleEnum=game.ME.ShareMain,i.toggle=1,this.dpt(this.Evts.C2C_SET_SHOW_AWARD,i)}this._modelData.achievePoint=t.point,this._modelData.pointId=t.id,this.send(this.Evts.V_UPDATA_POINT),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive)}},initCallback:function(e){e&&(this._modelData.setAchieveFinish(e),this.notifyCallback(e.group))},notifyCallback:function(){this.isShowTip(),this.checkAlert()},checkAlert:function(){if(game.moduleOpen.checkOpen(game.ME.Achieve)&&this._initData){var e=this._modelData.checkAllInfoCanAnyAlert();this.spotAlert.alert=e,b8e.module.isShowView(game.ME.Achieve)&&this.send(this.Evts.V_RED_POINT)}},playStop:function(e){if(e){var t=[game.InstanceType.ARENA,game.InstanceType.GUO_GUAN_ZHAN_JIANG,game.InstanceType.XIAN_DI_BAO_ZANG,game.InstanceType.ZHAO_QIN],a=e.data;-1!=t.indexOf(a.type)&&this.isShowTip()}},isShowTip:function(){this._modelData.finishList&&0<this._modelData.finishList.length&&this.dpt(game.AchievementEvts.C_SHWO_TIP),this._modelData.finishList.length<1&&(b8e.module.isShowView(game.ME.AchieveTip)&&game.module.hide(game.ME.AchieveTip),b8e.module.isShowView(game.ME.AchieveModelTip)&&game.module.hide(game.ME.AchieveModelTip))},getAward:function(e){if(!e.isCanGet||e.isGet)return 0<this._modelData.finishList.length&&this._modelData.finishList.splice(0,1),void this.isShowTip();this.sender.AchievementAwardReq(e.id,e.isShare)},shareSDKOK:function(e){this.shareData=e.data?e.data:e,this.dpt(this.Evts.C_SDK_ACHIEVEVIEW),this.delayShare()},delayShare:function(){this._modelData.setTripleShareAward(this.shareData),this.dpt(this.Evts.C2C_UPDATE_SHARE_STATE),this.send(this.Evts.V_SELECT_LIST)},getTipAward:function(e){this._showTip||(this._showTip=!0),this.getAward(e.data)},prizebox:function(){var e=game.AchievementAwardTaskCfg.getData(this._modelData.pointId);if(e){if(!(this._modelData.achievePoint>=e.num)){var t=b8e.createMap();t.awards=e.award,t.title=51753,t.btnStr=51754,this.dpt(this.Evts.C2C_SET_PREVIEW_AWARD,t)}}else game.notice.show(51541)},awardbox:function(){var e=game.AchievementAwardTaskCfg.getData(this._modelData.pointId);e?this._modelData.achievePoint<e.num||this.sender.AchievementPointReq(e.id):game.notice.show(51541)},checkIsNew:function(e){var t=[],a=this._modelData.getInfoByType(e);if(a){for(var i=a.awards.values(),n=i.length,s=0;s<n;s++){var o=i[s];o.isNew&&!o.isGet&&t.push(o)}0<t.length&&this.dpt(this.Evts.C2C_GET_NEW,t)}}}),t=game.Sender.extends({ipc:function(){this.msg={AchievementModelReq:null,AchievementAwardReq:this.shareAchievementAwardReq,AchievementPointReq:this.achievementPointReq}},shareAchievementAwardReq:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=game.pb.AchievementAwardRequest;i.id=e,i.isShare=a,this.write(i)},achievementPointReq:function(e){var t=game.pb.AchievementPointRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.Achieve,e,game.AchievementEvts,t)}(),function(){var e=game.Control.extends({showData:null,lockTime:0,ipc:function(){this.evts={ShareView:{C2C_SHARE_SUCCESS:this.updataTip},Achieve:{C_SHWO_TIP:this.showAchieveTip,C2C_UPDATE_SHARE_STATE:this.updataTip}}},showAchieveTip:function(){var e=game.achievementData.finishList;if(this.showData=e.length?e[0]:null,this.showData){this.showData.cfg.group;b8e.module.isShowView(game.ME.AchieveTip)||game.module.show(game.ME.AchieveTip),this.send(this.Evts.V_SHWO_TIP)}},updataTip:function(){this.send(this.Evts.V_SHWO_TIP)},btn_Get:function(){this.dpt(game.AchievementEvts.C_GET_PRIZE,this.showData)}}),t=[game.ME.AchieveModelTip];b8e.module.registerControl(game.ME.AchieveTip,e,game.AchievementEvts,null,t)}(),function(){var e;e=game.ShareTypeItem.extends({setData:function(e){var t=this.skin;t.lbl_btn.string=e.name,t.btn_choose.node.active=e.isSelect,t.redPoint.node.active=e.isAlert},btn_bg:function(){this.send(game.AchievementEvts.C_SELECT_LIST,this.data.type)}}),b8e.RC("$$game","$$AchieveBtnItem",e)}(),function(){var e;e=game.ListItem.extends({_gridList:null,_infoList:null,ctor:function(){this._super(1225),this.setSize(446,150)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this.awardList.itemRender=game.FosterAchievementAwardItem,this.awardList.layout.paddingLeft=0,this.awardList.layout.paddingRight=0,this.awardList.layout.paddingTop=0,this.awardList.layout.spacingX=0,this.awardList.addToParent(this.skin.prizeList)},clearData:function(){this.awardList&&this.awardList.clear()},setData:function(e){var t=this,a=t.skin,i=e.cfg.progress,n=game.achievementData.getProgress(e);n&&(a.lbl_progress.setColor(n.color),a.lbl_progress.string=n.str),a.lbl_progress.active=!e.isGet,1e4<=i&&(i=game.CCommonUtil.replaceNum(i,2)),a.titleLab.string=game.Lang.get(e.cfg.lang,i),a.isGet.active=e.isGet,a.redPoint.setVisible(e.isCanGet),e.isCanGet?(a.label_0.string=game.Lang.get(9057),a.getPrizeBtn.active=!e.isGet):(a.label_0.string=e.cfg.moduleEnum?game.Lang.get(9212):game.Lang.get(9211),a.getPrizeBtn.active=!!e.cfg.moduleEnum&&!e.isGet),t._itemInfoList||(t._itemInfoList=[]),t._infoList||(t._infoList=[]),t._infoList.length=0;for(var s=e.cfg.showItems,o=0;o<s.length;o++){var r=s[o];0<r.Id&&(t._itemInfoList[o]=game.ItemUtil.createBaseItemInfo(r.Id,r.Num,t._itemInfoList[o]),t._infoList.push(t._itemInfoList[o]))}t.awardList.setData(t._infoList)},getPrizeBtn:function(){if(this.data.isCanGet)this.send(game.AchievementEvts.C_GET_PRIZE,this.data);else{var e=this.data.cfg;e&&e.moduleEnum?game.ModuleCfg.getData(e.moduleEnum)&&(e.toggleIndex?game.module.showToggle(e.moduleEnum,e.toggleIndex):game.module.show(e.moduleEnum)):game.notice.show(9312)}}}),b8e.RC("$$game","$$AchieveItem",e)}(),function(){var e=game.View.extends({achievementData:null,list:null,ctor:function(){this._super(1224)},init:function(){var e=this;e._super();var t=e.skin;e.gridList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.gridList.itemRender=game.AchieveBtnItem,e.gridList.bindEnum=e.moduleEnum,e.gridList.layout.spacingY=5,e.gridList.addToParent(t.btn_list),e.awardList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.awardList.itemRender=game.AchieveItem,e.awardList.bindEnum=e.moduleEnum,e.awardList.layout.spacingY=5,e.awardList.addToParent(t.scrollGrid),e.progress=new game.Progress(466,30,0),e.progress.addToParent(t.progress);var a=e._anima=b8e.Animator.get(game.AnimType.UI_EFFECT,1);a.addToParent(e.skin.boxAnim),a.load(game.ResCfg.getUrl(5019,1094)),a.play(null,0),t.banner.loadTexture(game.ResCfg.getUrl(10005)),e._achieveData=game.achievementData},notify:function(e){switch(e){case this.Evts.V_SELECT_LIST:this.updataBtnList(),this.updataPage();break;case this.Evts.V_RED_POINT:this.updataBtnList();break;case this.Evts.V_UPDATA_POINT:this.updataPoint()}},onShow:function(){this.send(game.AchievementEvts.C_ONSHOW),this.updataPage(),this.updataPoint(),this.firstSelType=this._achieveData.getFirstShowMenuType(),this.send(game.AchievementEvts.C_SELECT_LIST,this.firstSelType),this.gridList&&this.gridList.scrollToTop()},onStageResize:function(){this.setPosition(0,0)},updataBtnList:function(){var e=this._achieveData.getMenuBtnList();e.sort(this.newBtnSort),this.gridList.setData(e)},btnSort:function(e,t){return e.isAlert&&!t.isAlert?-1:!e.isAlert&&t.isAlert?1:e.tag-t.tag},newBtnSort:function(e,t){return e.sort-t.sort},updataPage:function(){var e=this._achieveData.getNewAwardListByType();this.awardList.setData(e),this.awardList.scrollToTop()},updataPoint:function(){var e=this;e.skin.point.string=e._achieveData.achieveTotalPoint;var t=game.AchievementAwardTaskCfg.getData(e._achieveData.pointId);if(t){var a=e._achieveData.achievePoint<t.num?e._achieveData.achievePoint:t.num;e.progress.updatePro(a,t.num),e._anima.active=e._achieveData.achievePoint>=t.num,e.skin.awardbox.active=e._achieveData.achievePoint>=t.num,e.skin.prizebox.active=e._achieveData.achievePoint<t.num}},$$getAchieveItem:function(e){if(!(this.awardList&&this.awardList._container&&this.awardList._container._layoutContent&&this.awardList._container._layoutContent[e]))return null;var t=this.awardList._container._layoutContent[e].skin;return t?t.getPrizeBtn:null}});b8e.module.registerView(game.ME.Achieve,e)}(),function(){var e=game.View.extends({_showModel:!0,_modelTouchClose:!1,_lightEffect:null,bgY:-198,bgHeight:236,ctor:function(){this._super(16)},init:function(){var e=this,t=e.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),a=e.role=game.sceneRoleCreate.createUIRole(t);t.setMale(game.mainRoleData.isMale),a.addToParent(e.skin.model),e.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),e.awardList.itemRender=game.FosterAchievementAwardItem,e.awardList.layout.paddingLeft=0,e.awardList.layout.paddingRight=0,e.awardList.layout.paddingTop=0,e.awardList.layout.spacingX=0,e.awardList.addToParent(e.skin.prizeList),e._lightEffect=new game.LightEffect},notify:function(e){switch(e){case this.Evts.V_SHWO_TIP:this.updateData()}},onShow:function(){this._lightEffect||(this._lightEffect=new game.LightEffect),this._lightEffect.parent||(this._lightEffect.addToParent(this.skin.light),this._lightEffect.setVisible(!0)),this.hideTime=game.SysTime.curTime+1e4},onHide:function(){this._lightEffect&&this._lightEffect.removeFromParent(),this.clearMod(),game.achievementData.ceilFinishAchieve()},clearMod:function(){this.role&&this.role.clearAnim(),this._fosterModel&&(this._fosterModel.removeFromParent(),this._fosterModel=null)},onStageResize:function(){this.setPosition(.5*(b8e.stageWidth-this.width),.5*(b8e.stageHeight+this.height)+50)},updateData:function(){var e=this;e.clearMod();var t=game.achievementData.finishList[0],a=t.cfg,i=a.group,n=game.achievementData.getConfigByType(t,i),s=game.AchievementType,o=game.AvatarUtil;switch(i){case s.PetCatch:case s.ActivatePet:e.showEnlistPet(n,i);break;case s.NickName:e.showEnlistNick(n,i);break;case s.Fashion:e.showEnlist(null,null,null,null,null,"fashion",n,i),o.updateUIModel(e.role,o.ID_2)}n&&(e.skin.lbl_finishInfo.node.string=game.Lang.get(a.lang,n.name)),e.skin.btn_Get.node.active=!t.isShare,a.title&&(e.skin.moduleOpen.string=game.Lang.get(a.title)),e._itemInfoList||(e._itemInfoList=[]),e._infoList||(e._infoList=[]),e._infoList.length=0;for(var r=a.showItems,g=void 0,l=0,c=r.length;l<c;l++)(g=r[l])&&0<g.Id&&(e._itemInfoList[l]=game.ItemUtil.createBaseItemInfo(g.Id,g.Num,e._itemInfoList[l]),e._infoList.push(e._itemInfoList[l]));e.awardList.setData(e._infoList)},initBaseRole:function(e,t){var a=game.mainRoleData.heroModel;e.body=a.body;var i=game.AchievementType;switch(t){case i.PetCatch:case i.ActivatePet:e.type=game.RoleType.UIRole;break;case i.Fashion:e.type=game.RoleType.Foster;break;default:return}},showEnlist:function(e,t,a){var i=this.roleData.heroModel;i.clear(),this.initBaseRole(i,a);game.AvatarUtil;var n=e?t.id:game.surfaceData.getCurWearType(game.SurfaceTypes.FASHION);n&&i.setFashion(n),e&&this.role.transition(game.RoleStateType.ACTION_IDLE)},showEnlistPet:function(e){if(e){var t=this.roleData.heroModel;t.clear();var a=game.AvatarUtil,i=a.getUIModel(e);t.setBody(game.RoleType.Partner,i),a.updateBody(this.role)}else this.removeFromParent()},showEnlistNick:function(e){this._fosterModel||(this._fosterModel=b8e.SceneEntity.get(),this._fosterModel.addToParent(this.skin.model));var t=game.AvatarUtil.getUIModel(e),a=game.ResCfg.getUrl(5004,t);this.setAnim(a),this._fosterModel&&(this._fosterModel.y=e.offsetY)},setAnim:function(e){if(e){var t=this._fosterModel.getAnimator(game.AnimType.FOSTER,1);(t=t||this._fosterModel.addAnimator(game.AnimType.FOSTER,1)).load(e),t.play()}else t&&t.clear()}});b8e.module.registerView(game.ME.AchieveModelTip,e)}(),function(){var e=game.View.extends({_lightEffect:null,_showModel:!0,_modelTouchClose:!1,ctor:function(){this._super(17)},init:function(){this._super(),this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.awardList.itemRender=game.AchievementAwardItem,this.awardList.addToParent(this.skin.prizeList)},notify:function(e){switch(e){case this.Evts.V_SHWO_TIP:this.updateData()}},onShow:function(){game.TweenUtil.rotationEffect(this.skin.light),this.skin.huawen_3.width=b8e.stageWidth+100,this.skin.huawen_1.width=b8e.stageWidth+100,this.hideTime=game.SysTime.curTime+1e4},onHide:function(){b8e.Tween.kill(this.skin.light),game.achievementData.ceilFinishAchieve()},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+100),this.skin.gray.setSize(b8e.stageWidth+50,530)},updateData:function(){var e=this,t=e.skin,a=game.achievementData.finishList[0];if(a){var i=a.cfg,n=i.progress;t.advValTitle.node.string=game.Lang.get(i.lang,n),t.btn_Get.node.active=!a.isShare,e._itemInfoList||(e._itemInfoList=[]),e._infoList||(e._infoList=[]),e._infoList.length=0;for(var s=i.showItems,o=void 0,r=0,g=s.length;r<g;r++)(o=s[r])&&0<o.Id&&(e._itemInfoList[r]=game.ItemUtil.createBaseItemInfo(o.Id,o.Num,e._itemInfoList[r]),e._infoList.push(e._itemInfoList[r]));e.awardList.setData(e._infoList);var l=1<g?248:300;t.prizeList.setPosition(l,-400)}}});b8e.module.registerView(game.ME.AchieveTip,e)}(),function(){var e;e=b8e.Enum({ACTIVE_OPEN:-1,UPDATE_PLAYER_LIST:-1,ENTER_GAME_SCENE:-1,EXIT_GAME_SCENE:-1,CHANGE_ARROW_STATE:-1,UPDATE_ROOM_LIST:-1,V2C_CHANGE_ROOM:-1,UPDATE_ARROW_BAG:-1,V2C_COLLECT_ARROW:-1,V2C_ROB_ARROW:-1,V2C_LOOKFOR_PLAYER:-1,UPDATA_ARROW_LOG:-1,UPDATE_RANK_VIEW:-1,RANK_PAGE_LEFT:-1,RANK_PAGE_RIGHT:-1,V_FOLLOW_CHAT:-1,C2C_UPDATE_SHOP_COUNT:-1,C2V_RESET_DAILY:-1}),b8e.RC("$$game","$$CsArrowEvent",e)}(),function(){var e;e=b8e.Object.extends({casterId:0,casterName:"",victimId:0,victimName:"",arrowId:0,win:!1,ts:0,setData:function(){},setLogInfo:function(e){this.casterId=e.casterIdx,this.casterName=e.casterName,this.victimId=e.victimIdx,this.victimName=e.victimName,this.arrowId=e.arrowId,this.win=e.win,this.ts=e.ts}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsArrowLogInfo",e)}(),function(){var e;e=b8e.Object.extends({roleId:-1,unitId:-1,roleName:"",power:0,arrows:null,isAllow:!1,isMale:!1,robCount:0,definedCount:0,score:0,setData:function(){},setNotifyInfo:function(e){var t=e.arrows;this.score=e.score,this.robCount=e.robTimes,this.definedCount=e.defendTimes,this.setArrows(t)},setRoleInfo:function(e){this.roleId=e.id,this.roleName=e.name,this.power=e.power,this.definedCount=e.arrowDefTimes,this.arrows=[],this.setArrows(e.arrows)},setUnitInfo:function(e){this.roleId=e.id,this.unitId=scenePlayerInfo.player.roleId,this.roleName=e.name,this.isAllow=e.player.arrow,this.isMale=e.player.isMale},setArrows:function(e){if(e&&0!=e.length){var t,a,i;this.arrows||(this.arrows=[]);for(var n=0;n<e.length;n++){i=(t=e[n]).num;for(var s=0;s<i;s++)(a=new game.CsArrowItemInfo).arrowId=t.id,a.isMyself=this.roleId==game.mainRoleData.id,this.arrows.push(a)}}},addArrow:function(e){null==this.arrows&&(this.arrows=[]);var t=new game.CsArrowItemInfo;t.arrowId=e,t.isMyself=this.roleId==game.mainRoleData.id,this.arrows.push(t)},removeArrow:function(e){if(this.arrows)for(var t=0;t<this.arrows.length;t++)if(this.arrows[t].arrowId==e){this.arrows.splice(t,1);break}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsArrowInfo",e)}(),function(){var e;e=b8e.Object.extends({index:0,playerCount:0,maxCount:0,setData:function(){}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsArrowRoomInfo",e)}(),function(){var e;e=b8e.Object.extends({arrowId:-1,isMyself:!1,setData:function(){}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsArrowItemInfo",e)}(),function(){var e;e=b8e.Object.extends({roleId:-1,roleName:"",index:0,male:!1,arrows:null,setData:function(e){this.roleId=e.roleId,this.roleName=e.roleName,this.index=e.index,this.male=e.male,this.arrows=e.arrows},clearData:function(){this.roleId=-1,this.roleName="",this.index=0,this.male=!1,this.arrows=null}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CsArrowPlayerInfo",e)}(),function(){var e=b8e.Object.extends({startTime:0,endTime:0,state:1,arrowEndTime:0,roomList:null,arrowMap:null,currentAllowBagMak:0,arrowRobLogArray:null,scenePlayers:null,playerIds:null,activeInfo:null,score:0,robCount:0,definedCount:0,enterStmp:0,isFightStart:!1,maxRobTimes:-1,maxDefendTimes:-1,reset:function(){this.state=1,this.arrowEndTime=0,this.scenePlayers={},this.playerIds&&(this.playerIds.length=0),this.arrowMap=null,this.enterStmp=game.SysTime.curTime+6e4},modifySceneRole:function(e){var t=game.scene.modifySceneRole(e,!1);if(t&&t.data){var a=t.data;if(a){var i=a.heroModel;if(i)if(a.type=game.RoleType.CsArrow,a.ambiton=0,i.clear(),i.setBody(game.RoleType.CsArrow,"1001"),game.AvatarUtil.update(t),e.player.arrow){var n=t.getStateRef(game.HitStateReference);n.setParams(1);var s=game.scene.isSelf(e);t.transition(game.RoleStateType.ACTION_HIT,n,s)}else t.transition(game.RoleStateType.ACTION_IDLE)}}},getIsMove:function(){var e=game.sceneData.getSceneType();return 2==this.state&&e==game.SceneType.CS_ARROW?(game.notice.show(4303),!1):e!=game.SceneType.CS_ARROW||!game.mainRoleData.isFighting||(game.notice.show(4304),!1)},setRoleArrowNotify:function(e){var t=game.mainRoleData.id,a=game.CsArrowData.getArrowInfo(t);a||((a=new game.CsArrowInfo).roleId=game.mainRoleData.id,a.power=game.mainRoleData.power,a.roleName=game.mainRoleData.name,this.addArrowInfo(a)),this.robCount=e.robTimes,this.definedCount=e.defendTimes,a.setNotifyInfo(e)},addArrowInfo:function(e){null==this.arrowMap&&(this.arrowMap=b8e.HashMap.get()),this.arrowMap.set(e.roleId,e)},getArrowInfo:function(e){return null==this.arrowMap&&(this.arrowMap=b8e.HashMap.get()),this.arrowMap.get(e)},setSceneUnits:function(e){var t=this;null==t.scenePlayers&&(t.scenePlayers={}),t.playerIds||(t.playerIds=[]);for(var a,i=game.SceneUnitType,n=0,s=e.length;n<s;n++)switch((a=e[n]).type){case i.PLAYER:-1==t.playerIds.indexOf(a.id)&&t.playerIds.push(a.id);var o=(t.scenePlayers[a.id]=a).id,r=t.getArrowInfo(o);r&&(r.roleId=a.id,r.unitId=o,t.scenePlayers[o]=null,t.arrowMap&&t.arrowMap.has(o)&&t.arrowMap.del(o));break;case i.MONSTER:case i.BOX:}},removeSceneUnit:function(e){for(var t,a=0;a<this.playerIds.length;a++)if((t=this.scenePlayers[e])&&e==t.id){this.scenePlayers[e]=null;break}var i=this.playerIds.indexOf(e);-1<i&&this.playerIds.splice(i,1)},getSceneUnit:function(e){return null==this.scenePlayers?null:this.scenePlayers[e]},__playerInfos:null,getPlayerInfo:function(){var e,t,a,i=this;if(null==i.scenePlayers)return null;for(null==i.playerIds&&(i.playerIds=[]),i.__playerInfos||(i.__playerInfos=[]);0<i.__playerInfos.length;)i.recCsArrowPlayerInfo(i.__playerInfos.pop());for(var n=1,s=0;s<i.playerIds.length;s++)a=i.playerIds[s],(e=i.scenePlayers[a])&&((t=i.createCsArrowPlayerInfo()).roleId=e.id,t.roleName=e.name,t.index=n,t.male=e.player.isMale,i.__playerInfos.push(t),n++);return i.__playerInfos},setArrowRobLogData:function(e){var t,a;for(this.arrowRobLogArray||(this.arrowRobLogArray=[]);0<this.arrowRobLogArray.length;)this.recCsArrowLogInfo(this.arrowRobLogArray.pop());for(var i=0;i<e.length;i++)a=this.createLogInfo(),t=e[i],a.setLogInfo(t),this.arrowRobLogArray.push(a)},getArrowConfig:function(e){return game.ArrowCfg.getData(e)},getArrowRankConfig:function(e){return game.ArrowRankCfg.getData(e)},getArrowBaseConfigValue:function(e){return game.ArrowMiscCfg.getData(e).value},getArrowItemCfg:function(e){return game.ArrowCfg.getData(e)},getArrowItemInfo:function(e){var t=this.getArrowItemCfg(e).awardId;return game.ItemInfoCfg.getData(t)},ranks:null,getRankPrize:function(e){var t;if(null==this.ranks){this.ranks=[];for(var a=game.ArrowRankCfg.getDatas(),i=0;i<a.length;i++)t=a[i],this.ranks.push(t.rank)}var n=-1,s=this.ranks[this.ranks.length-1];if(s<e)return(t=game.ArrowRankCfg.getData(s)).award;for(var o=0;o<this.ranks.length;o++)if(e<=this.ranks[o]){n=this.ranks[o];break}return(t=game.ArrowRankCfg.getData(n)).award},ArrowPlayerInfoPool:null,createCsArrowPlayerInfo:function(){return this.ArrowPlayerInfoPool||(this.ArrowPlayerInfoPool=[]),0<this.ArrowPlayerInfoPool.length?this.ArrowPlayerInfoPool.pop():new game.CsArrowPlayerInfo},recCsArrowPlayerInfo:function(e){e&&this.ArrowPlayerInfoPool.push(e)},csarrowLogPool:null,createLogInfo:function(){return this.csarrowLogPool||(this.csarrowLogPool=[]),0<this.csarrowLogPool.length?this.csarrowLogPool.pop():new game.CsArrowLogInfo},recCsArrowLogInfo:function(e){e&&this.csarrowLogPool.push(e)},csArrowRoomPool:null,createRoomInfo:function(){return this.csArrowRoomPool||(this.csArrowRoomPool=[]),0<this.csArrowRoomPool.length?this.csArrowRoomPool.pop():new game.CsArrowRoomInfo},recRoomInfo:function(e){e&&this.csArrowRoomPool.push(e)},recAllRoomDatas:function(){for(var e=0;e<this.roomList.length;e++)this.csArrowRoomPool.push(this.roomList[e]);this.roomList.length=0},getStartTime:function(){if(0<this.startTime)return this.startTime;var e=this.getArrowBaseConfigValue("arrowOpenTime"),t=new Date(game.SysTime.curTime);if(e){var a=e.split("-")[0].split(":");t.setHours(a[0],a[1])}return this.startTime=t.getTime(),this.startTime},getEndTime:function(){if(0<this.endTime)return this.endTime;var e=this.getArrowBaseConfigValue("arrowOpenTime"),t=new Date(game.SysTime.curTime);if(e){var a=e.split("-")[1].split(":");t.setHours(a[0],a[1])}return this.endTime=t.getTime(),this.endTime},checkCsArrowAlert:function(){if(!game.moduleOpen.checkOpen(game.ME.CsArrow))return!1;var e=game.CsArrowData.getArrowBaseConfigValue("arrowOpenDays").split(","),t=new Date(game.SysTime.curTime).getDay()+"";return-1!=e.indexOf(t)&&(!(game.SysTime.curTime<this.getStartTime())&&!(game.SysTime.curTime>this.getEndTime()))},isRob:function(){if(-1==this.maxRobTimes&&(this.maxRobTimes=this.getArrowBaseConfigValue("arrowRobTimes"),this.maxDefendTimes=this.getArrowBaseConfigValue("arrowDefendTimes")),this.robCount>=this.maxRobTimes)return game.notice.show(4405),!1;var e=this.getArrowInfo(game.CsArrowData.currentAllowBagMak);return!(e&&e.definedCount>=this.maxDefendTimes)||(game.notice.show(4404),!1)}});game.CsArrowData=game.CsArrowData||new e}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsArrowPlayBar:{UPDATE_ARROW_BAG:this.updateArrowBag},CsArrowPlayerBar:{UPDATE_ARROW_BAG:this.updateArrowBag}},this.handels={ArrowCollectResp:this.ArrowCollectResp,ArrowRobResp:this.ArrowRobResp,ArrowBasketMsg:this.ArrowBasketNotify,ArrowMsg:this.ArrowNotify,ArrowRobMsg:this.ArrowRobMsg}},back_btn:function(){game.module.hide(game.ME.CsArrowBag)},ArrowRobMsg:function(e){var t=e.readProtobuf(game.pb.ArrowRobLog),a=t,i=a.casterIdx,n=(a.casterName,a.victimIdx),s=(a.victimName,a.arrowId),o=(game.CsArrowData.getArrowInfo(i),game.CsArrowData.getArrowInfo(n));t.win&&o&&o.removeArrow(s),this.updateArrowBagData(i),this.updateArrowBagData(n)},updateArrowBag:function(){var e=game.CsArrowData.currentAllowBagMak,t=game.CsArrowData.getArrowInfo(e);if(null==t){var a=game.CsArrowData.getSceneUnit(e);if(null==a){if(e!=game.mainRoleData.id)return;a=game.mainRoleData}(t=new game.CsArrowInfo).setRoleInfo(a),game.CsArrowData.addArrowInfo(t)}this.updateArrowBagData(e)},updateArrowBagData:function(e){if(game.CsArrowData.currentAllowBagMak==e){var t=game.CsArrowData.getArrowInfo(e);this.send(this.Evts.UPDATE_ARROW_BAG,t)}},ArrowCollectResp:function(e){var t=e.readProtobuf(game.pb.ArrowCollectResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.CsArrowData.getArrowInfo(game.mainRoleData.id);a&&a.removeArrow(t.id),this.updateArrowBagData(game.mainRoleData.id)}},ArrowRobResp:function(e){var t=e.readProtobuf(game.pb.ArrowRobResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.CsArrowData.robCount++,game.module.hide(game.ME.CsArrowBag);var a=t.log,i=a.casterIdx,n=(a.casterName,a.victimIdx),s=(a.victimName,a.arrowId),o=(game.CsArrowData.getArrowInfo(i),game.CsArrowData.getArrowInfo(n));t.battleLog.win&&o&&o.removeArrow(s),this.updateArrowBagData(i),this.updateArrowBagData(n);var r={type:game.InstanceType.CS_ARROW};game.playBack.play(t.battleLog,r);var g=game.mainRole;if(2==game.CsArrowData.state){var l=g.getStateRef(game.HitStateReference);l.setParams(1),g.transition(game.RoleStateType.ACTION_HIT,l,!0)}}},ArrowNotify:function(e){var t=e.readProtobuf(game.pb.ArrowNotify),a=t.roleIdx,i=t.arrowId,n=game.CsArrowData.getArrowInfo(a);if(n&&(n.addArrow(i),this.updateArrowBagData(i)),a=game.mainRoleData.id){var s=game.CsArrowData.getArrowItemInfo(i);game.notice.show(9492,game.HtmlUtil.getText(game.Color.GREEN,s.name))}},ArrowBasketNotify:function(e){var t=e.readProtobuf(game.pb.ArrowBasketNotify);game.CsArrowData.setRoleArrowNotify(t),this.updateArrowBagData(game.mainRoleData.id)},notify:function(e,t){switch(e){case game.CsArrowEvent.V2C_COLLECT_ARROW:this.sender.ArrowCollectReq(t);break;case game.CsArrowEvent.V2C_ROB_ARROW:if(!game.CsArrowData.isRob())return;game.CsArrowData.isFightStart=!0,this.sender.ArrowRobReq(t)}}}),t=game.Sender.extends({ipc:function(){this.msg={ArrowCollectReq:this.ArrowCollectReq,ArrowRobReq:this.ArrowRobReq,ScenePlayerInfoReq:this.ScenePlayerInfoRequest}},ArrowCollectReq:function(e){var t=game.pb.ArrowCollectRequest;t.id=e,this.write(t)},ArrowRobReq:function(e){var t=game.pb.ArrowRobRequest;t.id=e,t.targetIdx=game.CsArrowData.currentAllowBagMak,this.write(t)},ScenePlayerInfoRequest:function(e){var t=game.pb.ScenePlayerInfoRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.CsArrowBag,e,game.CsArrowEvent,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsArrowMain:{ENTER_GAME_SCENE:this.enterGameScene},MainUIChat:{C2C_ARROW_GET:this.getChatArrowResp}},this.gevts={SceneGEvts:{SCENE_CHANGE_MAP:this.changeMap}},this.handels={ArrowRoomResp:this.ArrowRoomResp}},init:function(){this._alertOptions={lang:4e3,btn:game.Lang.get(9059),okcb:this.exitRoom,thisArg:this}},enterGameScene:function(){var e=game.CsArrowData.activeInfo;e||(e={},game.CsArrowData.activeInfo=e);var t=game.Lang.get(9493,game.HtmlUtil.getText(game.Color.GREEN,"("+game.sceneData.lineId+")"));e.roomName=t,e.endTime=game.CsArrowData.getEndTime(),this.send(this.Evts.ENTER_GAME_SCENE),game.module.hide(game.ME.CsArrowEnter)},getChatArrowResp:function(){this.changBtn()},changeMap:function(){this.enterGameScene()},ArrowRoomResp:function(e){var t=e.readProtobuf(game.pb.ArrowRoomResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a,i=game.CsArrowData.roomList;i||(game.CsArrowData.roomList=i=[]);for(var n=t.roomes,s=game.CsArrowData.getArrowBaseConfigValue("arrowRoomSize"),o=0;o<n.length;o++)(a=i[o])||(a=game.CsArrowData.createRoomInfo(),i.push(a)),a.index=o+1,a.playerCount=n[o],a.maxCount=s;this.dpt(game.CsArrowEvent.UPDATE_ROOM_LIST)}},changBtn:function(){game.module.show(game.ME.CsArrowRoom),this.sender.ArrowRoomReq()},infoBtn:function(){game.module.show(game.ME.CsArrowMail),this.sender.ArrowLogReq()},exitRoomBtn:function(){game.alert.show(this._alertOptions)},exitRoom:function(){b8e.evt.dptG(game.SceneGEvts.SCENE_EXIT)}}),t=game.Sender.extends({ipc:function(){this.msg={ArrowRoomReq:this.ArrowRoomReq,ArrowLogReq:null}}});b8e.module.registerControl(game.ME.CsArrowGameInfo,e,game.CsArrowEvent,t)}(),function(){var e=game.Control.extends({ipc:function(){this.handels={ArrowStateChangeResp:this.ArrowStateChangeResponse}},ArrowStateChangeResponse:function(e){var t=e.readProtobuf(game.pb.ArrowStateChangeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.mainRole;var a=t.state;game.CsArrowData.state=a?2:1,game.CsArrowData.arrowEndTime=t.ts,this.send(this.Evts.CHANGE_ARROW_STATE)}},startBtn:function(){var e=game.mainRole;e&&(e.getStateMachine().isWalkMoving()?game.notice.show(5401):this.sender.ArrowStateChangeReq(!0))},endBtn:function(){this.sender.ArrowStateChangeReq(!1)},bagBtn:function(){var e=game.mainRoleData.id;this.dpt(game.CsArrowEvent.V2C_LOOKFOR_PLAYER,e)},arrowhelpBtn:function(){game.RuleView.inst().showView(game.ME.CsArrowRank)}}),t=game.Sender.extends({ipc:function(){this.msg={ArrowStateChangeReq:this.ArrowStateChangeRequest}},ArrowStateChangeRequest:function(e){var t=game.pb.ArrowStateChangeRequest;t.state=e,this.write(t)}});b8e.module.registerControl(game.ME.CsArrowPlayBar,e,game.CsArrowEvent,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsArrowRoom:{UPDATE_PLAYER_LIST:this.onUpdatePlayerList},CsArrowPlayBar:{V2C_LOOKFOR_PLAYER:this.lookPlayerInfo}},this.gevts={SceneGEvts:{SCENE_UNIT_LEAVE:this.onPlayerLeave,SCENE_UNIT_UPDATE_ARROW:this.updatePlayers,SCENE_PLAYER_INFO_REQ:this.updatePlayerInfo,CLICK_HERO:this.clickRole}},this.handels={}},updatePlayers:function(e){var t=e.data;t&&(game.CsArrowData.setSceneUnits(t),this.send(this.Evts.UPDATE_PLAYER_LIST))},onPlayerLeave:function(e){var t=e.data;game.CsArrowData.removeSceneUnit(t),this.send(this.Evts.UPDATE_PLAYER_LIST)},onUpdatePlayerList:function(){this.send(this.Evts.UPDATE_PLAYER_LIST)},updatePlayerInfo:function(){if(game.sceneData.currentPlayerInfo){var e=game.sceneData.currentPlayerInfo,t=game.CsArrowData.getArrowInfo(e.id);(t=t||new game.CsArrowInfo).setRoleInfo(e),game.CsArrowData.addArrowInfo(t),this.dpt(this.Evts.UPDATE_ARROW_BAG)}},lookPlayerInfo:function(e){this.lookPlayerReq(e.data)},clickRole:function(e){if(game.sceneData.getSceneType()==game.SceneType.CS_ARROW){var t=e.data;t&&this.lookPlayerReq(t.id)}},lookPlayerReq:function(e){game.CsArrowData.currentAllowBagMak=e,game.module.show(game.ME.CsArrowBag),this.sender.ScenePlayerInfoReq(e)},notify:function(e,t){switch(e){case game.CsArrowEvent.V2C_LOOKFOR_PLAYER:this.lookPlayerReq(t)}}}),t=game.Sender.extends({ipc:function(){this.msg={ScenePlayerInfoReq:this.ScenePlayerInfoRequest}},ScenePlayerInfoRequest:function(e){var t=game.pb.ScenePlayerInfoRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.CsArrowPlayerBar,e,game.CsArrowEvent,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Rank:{C_UPDATE_DATA:this.updateRankData}}},updateRankData:function(){this.send(this.Evts.UPDATE_RANK_VIEW)},leftBtn:function(){this.send(this.Evts.RANK_PAGE_LEFT)},rightBtn:function(){this.send(this.Evts.RANK_PAGE_RIGHT)}});b8e.module.registerControl(game.ME.CsArrowRank,e,game.CsArrowEvent)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CsArrowGameInfo:{UPDATE_ROOM_LIST:this.updateRoomList}},this.handels={ArrowSwitchResp:this.ArrowSwitchResponse}},init:function(){this._alertOptions={lang:4001,btn:game.Lang.get(9059),okcb:this.switchRequest,thisArg:this}},ArrowSwitchResponse:function(e){var t=e.readProtobuf(game.pb.ArrowSwitchResponse);0<t.code?game.notice.noticeError(t.code):(game.CsArrowData.state=1,game.module.hide(game.ME.CsArrowRoom),this.dpt(this.Evts.UPDATE_PLAYER_LIST))},back_btn:function(){this.closeBtn()},closeBtn:function(){game.module.hide(game.ME.CsArrowRoom),game.CsArrowData.recAllRoomDatas()},updateRoomList:function(){this.send(this.Evts.UPDATE_ROOM_LIST)},roomId:0,notify:function(e,t){switch(e){case game.CsArrowEvent.V2C_CHANGE_ROOM:if((this.roomId=t)==game.sceneData.lineId)return void game.notice.show(4402);game.alert.show(this._alertOptions)}},switchRequest:function(){this.sender.ArrowSwitchReq(this.roomId)}}),t=game.Sender.extends({ipc:function(){this.msg={ArrowSwitchReq:this.ArrowSwitchRequest}},ArrowSwitchRequest:function(e){var t=game.pb.ArrowSwitchRequest;t.lineId=e,this.write(t)}});b8e.module.registerControl(game.ME.CsArrowRoom,e,game.CsArrowEvent,t)}(),function(){var e=game.Control.extends({csArrowAlert:null,ipc:function(){var e=this;e.gevts={SceneGEvts:{ENTER_SCENE:e.enterScene,FIRST_ENTER_SCENE:e.firstEnterScene,SCENE_EXIT:e.exitScene}},e.evts={MainUIChat:{C2C_REQ_ENTER_CSARROW:e.enterArrowScene},CsArrowEnter:{ENTER_GAME_SCENE:e.enterArrowScene},MainRole:{C_RESET_DAILY:e.resetDaily}},e.handels={ArrowEnterResp:e.ArrowEnterResponse}},resetDaily:function(){this.send(this.Evts.C2V_RESET_DAILY)},init:function(){this.csArrowAlert=game.spotAlert.set(game.SAE.CS_ARROW,game.SAE.CS_ALERT),this.chat={chatType:game.ChatChannelType.CSARROW,marqueeKey:"csarrow_open",funcType:game.ChatFuncType.CHAT_FUNC_CS_ARROW}},ArrowEnterResponse:function(e){var t=e.readProtobuf(game.pb.ArrowEnterResponse);0<t.code?game.notice.noticeError(t.code):(this.dpt(this.Evts.ENTER_GAME_SCENE),game.shopData.setCACount(game.ShopConditionType.SHOPCSARROW)&&this.dpt(this.Evts.C2C_UPDATE_SHOP_COUNT))},exitScene:function(){this.csArrowAlert.alert=game.CsArrowData.checkCsArrowAlert()},triggerOpen:function(e){e==this.moduleEnum&&(this.csArrowAlert.alert=game.CsArrowData.checkCsArrowAlert())},rankBtn:function(){},arrowhelpBtn:function(){game.RuleView.inst().showView(game.ME.CsArrowRank)},enterScene:function(){game.module.hide(game.ME.CsArrowMain)},firstEnterScene:function(){this.checkIsOpen()},enterArrowScene:function(){this.enterSceneBtn()},enterSceneBtn:function(){var e=Math.floor((game.CsArrowData.enterStmp-game.SysTime.curTime)/1e3);if(0<e){var t=game.Lang.get(4307,e);game.notice.show(t)}else this.sender.ArrowEnterReq()},checkIsOpen:function(){if(!game.moduleOpen.checkOpen(game.ME.CsArrow))return!1;var e=game.CsArrowData.getArrowBaseConfigValue("arrowOpenDays").split(","),t=new Date(game.SysTime.curTime).getDay()+"";if(-1==e.indexOf(t))return!1;var a=game.CsArrowData.getEndTime(),i=game.CsArrowData.getStartTime();if(game.SysTime.curTime>a)return!1;var n=i-game.SysTime.curTime;return n<0?(b8e.Tween.get(this).wait(500).call(this.openArrow,this),!0):(b8e.Tween.get(this).wait(n).call(this.openArrow,this),!1)},openArrow:function(){if(b8e.Tween.kill(this),game.sceneData.getSceneType()!=game.SceneType.CS_ARROW&&!game.exploreScene.isInExploreScene()){game.module.show(game.ME.CsArrowEnter);this.sendChat(null,"csarrow_open")}},sendChat:function(e,t){this.chat.chatType=game.ChatChannelType.CSARROW,this.chat.funcType=game.ChatFuncType.CHAT_FUNC_CS_ARROW,this.chat.params=e,this.chat.clientParams=null,this.chat.marqueeKey=t,game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.CS_ARROW_FULI)}}),t=game.Sender.extends({ipc:function(){this.msg={ArrowEnterReq:null,RankReq:this.RankReq}},RankReq:function(e){var t=game.pb.RankRequest;t.type=e,this.write(t)}});b8e.module.registerControl(game.ME.CsArrowMain,e,game.CsArrowEvent,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={},this.handels={ArrowLogResp:this.ArrowLogResp}},ArrowLogResp:function(e){var t=e.readProtobuf(game.pb.ArrowLogResponse);0<t.code?game.notice.noticeError(t.code):(game.CsArrowData.setArrowRobLogData(t.logs),this.send(this.Evts.UPDATA_ARROW_LOG))}});b8e.module.registerControl(game.ME.CsArrowMail,e,game.CsArrowEvent)}(),function(){var e=game.Control.extends({enterBtn:function(){this.dpt(game.CsArrowEvent.ENTER_GAME_SCENE),game.module.hide(game.ME.CsArrowEnter)}});b8e.module.registerControl(game.ME.CsArrowEnter,e,game.CsArrowEvent)}(),function(){var e;e=game.ListItem.extends({itemIcon:null,isMyArrow:!0,ctor:function(){this._super(198),this.setSize(540,95)},init:function(){this.itemIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_84),this.itemIcon.setNum(0),this.itemIcon.addToParent(this.skin.itemContainer)},setData:function(){var e=this,t=e.data;if(e.isMyArrow=t.isMyself,t.arrowId<1)return e.skin.itemContainer.setVisible(!1),e.skin.collectBtn.setVisible(!1),e.skin.tipTxt.setVisible(!0),void e.skin.nameTxt.setVisible(!1);e.skin.itemContainer.setVisible(!0),e.skin.collectBtn.setVisible(!0),e.skin.tipTxt.setVisible(!1),e.skin.nameTxt.setVisible(!0),e.skin.label.string=e.isMyArrow?game.Lang.get(9402):game.Lang.get(9403);var a=game.CsArrowData.getArrowItemInfo(t.arrowId);e.itemIcon.setItemInfo(a,!1,!1),e.skin.nameTxt.string=game.HtmlUtil.getColorStrByQuality(a.quality,a.name)},collectBtn:function(){this.isMyArrow?this.send(game.CsArrowEvent.V2C_COLLECT_ARROW,this.data.arrowId):this.send(game.CsArrowEvent.V2C_ROB_ARROW,this.data.arrowId)}}),b8e.RC("$$game","$$CsArrowBagItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(202),this.setSize(540,94)},init:function(){},setData:function(e){var t=this.skin;t.timeTxt.string=b8e.TimeUtil.formatTimestamp(e.ts);var a,i=e.casterName,n=e.victimName,s=!1;e.casterId==game.mainRoleData.id?e.win&&(s=!0):e.victimId==game.mainRoleData.id&&e.win&&(s=!0),i==game.mainRoleData.name?(i=game.Lang.get(9404),a=game.Lang.get(4305,i,n)):n==game.mainRoleData.name&&(n=game.Lang.get(9404),a=game.Lang.get(4510,i,n)),t.chenggong.setVisible(s),t.shibai.setVisible(!s),t.infiTxt.string=a}}),b8e.RC("$$game","$$CsArrowMailItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(207),this.setSize(160,100)},roleId:0,init:function(){this.skin.iconContainer.setSize(68,68)},mouseBtn:function(){0<this.roleId&&this.send(game.CsArrowEvent.V2C_LOOKFOR_PLAYER,this.roleId)},setData:function(e){var t=this.skin;this.roleId=e.roleId;var a=e.roleId<1,i=0<this.roleId;if(this.skin.ntxt.setVisible(!i),this.skin.nameBg.setVisible(i),this.skin.nameTxt.setVisible(i),this.skin.mouseBtn.setVisible(i),t.rankTxt.string=e.index,i&&(t.nameTxt.string=e.roleName),a)t.iconContainer.unloadTexture();else{var n=game.ResCfg.getHead(e.male);t.iconContainer.loadTexture(n)}}}),b8e.RC("$$game","$$CsArrowPlayerItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(208),this.setSize(550,91)},init:function(){this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.layout.paddingLeft=0,this._prizeList.layout.spacingX=5,this._prizeList.addToParent(this.skin.prizeView)},setData:function(e){this.skin.nameLab.string=game.HtmlUtil.getColorStrByRank(e.rank,e.name),this.skin.scoreTxt.string=game.Lang.get(3813,game.CCommonUtil.replaceNum(e.score)),this.skin.rankLab.string=e.rank;var t=3<e.rank?4:e.rank;this._rankBg=this.getComponent("rank"+t),this._rankBg&&(this._rankBg.node.active=!0),this.createPrize(e.rank)},createPrize:function(e){var t=game.CsArrowData.getRankPrize(e);if(t){var a=game.CfgUtil.getPrizeListInfo(t);a&&a.items&&this._prizeList.setData(a.items)}},clearData:function(){this._rankBg&&(this._rankBg.node.active=!1),this._prizeList&&this._prizeList.clear()},onHide:function(){}}),b8e.RC("$$game","$$CsArrowRankItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(210),this.setSize(175,220)},clickBtn:function(){var e=this.data.index;this.send(game.CsArrowEvent.V2C_CHANGE_ROOM,e)},setData:function(){var e=this.data,t=e.playerCount,a=e.index;this.skin.nameTxt.string=game.Lang.get(9494,a),this.skin.numTxt.string=t+"/"+e.maxCount}}),b8e.RC("$$game","$$CsArrowRoomCellView",e)}(),function(){var e=game.View.extends({_prizeList:null,_prizesInfo:null,ctor:function(){this._super(204)},init:function(){var e=this.skin;e.buyDesc.fontSize=22;game.CsArrowData.getArrowBaseConfigValue("arrowOpenDays");var t=game.CsArrowData.getArrowBaseConfigValue("arrowOpenTime"),a=game.CsArrowData.getArrowBaseConfigValue("arrowOpenTimeDes");e.buyDesc.string=game.Lang.get(4306,a,t),this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.bindEnum=game.ME.YearTask,this._prizeList.layout.spacingX=45,this._prizeList.addToParent(this.skin.prizeNode),this.setShopBtn()},_createPrizeItems:function(){var e=game.ArrowShowCfg.getDatas();if(e&&!(e.length<1)){for(var t=e.length,a=game.miscData.openServerDay,i=void 0,n=void 0,s=0;s<t;s++)if((i=e[s]).serverStart<=a&&a<i.serverEnd){n=i;break}if(n){var o=game.CfgUtil.getPrizeListInfo(n.showItems);this._prizeList.setData(o.items)}}},notify:function(e){switch(e){case game.CsArrowEvent.ACTIVE_OPEN:this.updateView();break;case this.Evts.C2V_RESET_DAILY:this._createPrizeItems()}},onShow:function(){this._createPrizeItems()},setShopBtn:function(){}});b8e.module.registerView(game.ME.CsArrowMain,e)}(),function(){var e=game.View.extends({list:null,listDatas:null,ctor:function(){this._super(199)},init:function(){var e;this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.CsArrowBagItemView,this.list.bindEnum=game.ME.CsArrowBag,this.list.layout.spacingY=5,this.list.addToParent(this.skin.list),this.listDatas=[];for(var t=0;t<5;t++)(e=new game.CsArrowItemInfo).arrowId=-1,this.listDatas.push(e)},onShow:function(){},notify:function(e,t){switch(e){case game.CsArrowEvent.UPDATE_ARROW_BAG:this.updateView(t)}},updateView:function(e){if(e&&e.roleId==game.CsArrowData.currentAllowBagMak){if(this.skin.nameTxt.string=e.roleName,this.skin.powerTxt.string=game.Lang.get(5643,e.power),!e.arrows||0==e.arrows.length)return void this.list.setData(this.listDatas);var t=e.arrows.length,a=5-t%5,i=a+t,n=[];if(0<a)for(var s=0;s<i;s++)s<t?n.push(e.arrows[s]):n.push(this.listDatas[s-t]);this.list.setData(n)}}});b8e.module.registerView(game.ME.CsArrowBag,e)}(),function(){var e=game.View.extends({mailList:null,ctor:function(){this._super(203)},init:function(){this.mailList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.mailList.itemRender=game.CsArrowMailItemView,this.mailList.layout.spacingY=5,this.mailList.addToParent(this.skin.mailContainer)},onShow:function(){},notify:function(e){switch(e){case game.CsArrowEvent.UPDATA_ARROW_LOG:this.updateView()}},updateView:function(){var e=game.CsArrowData.arrowRobLogArray;this.mailList.setData(e)}});b8e.module.registerView(game.ME.CsArrowMail,e)}(),function(){var e=game.View.extends({_list:null,currentPage:1,maxPage:1,pageCount:6,listDatas:null,ctor:function(){this._super(209)},notify:function(e){switch(e){case game.CsArrowEvent.UPDATE_RANK_VIEW:this.updateView();break;case game.CsArrowEvent.RANK_PAGE_LEFT:this.leftBtn();break;case game.CsArrowEvent.RANK_PAGE_RIGHT:this.rightBtn()}},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.CsArrowRankItemView,this._list.layout.paddingLeft=0,this._list.layout.spacingY=10,this._list.addToParent(this.skin.listContainer)},leftBtn:function(){this.currentPage--,this.currentPage<1?this.currentPage=1:this.updateView()},rightBtn:function(){this.currentPage++,this.currentPage>this.maxPage?this.currentPage=this.maxPage:this.updateView()},updateView:function(){var e=this,t=game.rankData.getRankInfoArrByType(game.RankType.RankArrow);if(!t||0==t.length)return e.skin.emptyDesc.setVisible(!0),e.skin.rankTxt.string="0",void(e.skin.scoreTxt.string="0");for(var a,i=0,n=0,s=0;s<t.length;s++)if((a=t[s]).roleid==game.mainRoleData.id||a.roleid==game.mainRoleData.unitId){i=a.rank,n=a.score;break}game.CsArrowData.score=n,e.skin.rankTxt.string=i,e.skin.scoreTxt.string=n,e.skin.emptyDesc.setVisible(!1),e.maxPage=Math.ceil(t.length/e.pageCount),e.skin.page_lab.string=e.currentPage+"/"+e.maxPage;var o=(e.currentPage-1)*e.pageCount,r=(o=o<0?0:o)+e.pageCount;r=r>t.length?t.length:r,e.listDatas=t.slice(o,r),e.listDatas.sort(e._onSortRank),e._list.setData(e.listDatas)},_onSortRank:function(e,t){return t-e},onHide:function(){this._list.clear()}});b8e.module.registerView(game.ME.CsArrowRank,e)}(),function(){var e=game.View.extends({list:null,currentPage:1,maxPage:1,pageCount:6,listDatas:null,ctor:function(){this._super(211)},init:function(){this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.list.itemRender=game.CsArrowRoomCellView,this.list.bindEnum=game.ME.CsArrowRoom,this.list.addToParent(this.skin.roomContainer)},view_left:function(){this.currentPage--,this.currentPage<1?this.currentPage=1:this.updateView()},view_right:function(){this.currentPage++,this.currentPage>this.maxPage?this.currentPage=this.maxPage:this.updateView()},onShow:function(){this.maxPage=Math.ceil(game.CsArrowData.getArrowBaseConfigValue("arrowRooms")/this.pageCount),this.updateView()},notify:function(e){switch(e){case game.CsArrowEvent.UPDATE_ROOM_LIST:this.updateView()}},updateView:function(){this.skin.page_lab.string=this.currentPage+"/"+this.maxPage;var e=(this.currentPage-1)*this.pageCount,t=(e=e<0?0:e)+this.pageCount;game.CsArrowData.roomList&&(t=t>game.CsArrowData.roomList.length?game.CsArrowData.roomList.length:t,this.listDatas=game.CsArrowData.roomList.slice(e,t),this.list.setData(this.listDatas))}});b8e.module.registerView(game.ME.CsArrowRoom,e)}(),function(){var e=game.View.extends({_specialLayer:!0,endTime:0,ctor:function(){this._super(201),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(e-305,t-45)},onShow:function(){this.updateView()},notify:function(e){switch(e){case game.CsArrowEvent.ENTER_GAME_SCENE:this.updateView();break;case game.CsArrowEvent.EXIT_GAME_SCENE:this.onExitGameScene()}},updateView:function(){var e=this.skin,t=game.CsArrowData.activeInfo;t&&(e.arrowNameTxt.string=t.roomName,this.endTime=t.endTime,this.startTime())},startTime:function(){this.endTime<=game.SysTime.curTime?this.clearTimer():this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){var e=this.endTime-game.SysTime.curTime;this.skin.timeNumTxt.string=b8e.TimeUtil.formatTime(e),e<1&&this.clearTimer()},onExitGameScene:function(){this.endTime=0,this.clearTimer()}});b8e.module.registerView(game.ME.CsArrowGameInfo,e)}(),function(){var e=game.View.extends({endTime:0,timeC:0,timeT:0,_specialLayer:!0,ctor:function(){this._super(205),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e=this.skin;e.startBtn.setVisible(!0),e.arrowhelpBtn.setVisible(!0),e.endBtn.setVisible(!1),e.bagBtn.setVisible(!1),e.tipTxt.setVisible(!1),e.timeTxt.setVisible(!1)},onShow:function(){this.updateView()},onStageResize:function(){this._isMoveUp=game.chatData.isOpenChat;var e=b8e.stageWidth;this.setPosition(.5*(e-this.width)+50,this.height+110)},notify:function(e){switch(e){case game.CsArrowEvent.CHANGE_ARROW_STATE:this.updateView()}},updateView:function(){var e=game.CsArrowData,t=this,a=t.skin;a.startBtn.setVisible(1==e.state),a.arrowhelpBtn.setVisible(1==e.state),a.endBtn.setVisible(2==e.state),a.bagBtn.setVisible(2==e.state),a.tipTxt.setVisible(2==e.state),a.timeTxt.setVisible(2==e.state),1!=e.state?(t.endTime=e.arrowEndTime,t.timeC=t.endTime-game.SysTime.curTime,0==t.timeT&&0<t.timeC&&(t.timeT=t.timeC),t.timeC<=0&&(t.timeC=t.timeT,t.endTime=t.timeC+game.SysTime.curTime),a.timeTxt.string="",t.startTime()):t.clearTimer()},startTime:function(){this.timeC<=0?this.clearTimer():this._timer||(this.skin.timeTxt.string=b8e.TimeUtil.formatTime(this.timeC),this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){if(this.skin.timeTxt.string=b8e.TimeUtil.formatTime(this.endTime-game.SysTime.curTime),this.endTime<=game.SysTime.curTime){if(2==game.CsArrowData.state)return void(this.endTime=game.SysTime.curTime+this.timeC+1e3);this.clearTimer()}},onStopArrow:function(){this.timeC=0,this.endTime=0,this.clearTimer()}});b8e.module.registerView(game.ME.CsArrowPlayBar,e)}(),function(){var e=game.View.extends({list:null,listDatas:null,currentPage:1,maxPage:1,pageCount:5,_specialLayer:!0,ctor:function(){this._super(206),this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},init:function(){var e;this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.CsArrowPlayerItemView,this.list.bindEnum=game.ME.CsArrowPlayerBar,this.list.addToParent(this.skin.list),this.listDatas=[];for(var t=0;t<5;t++)(e=new game.CsArrowPlayerInfo).index=t+1,this.listDatas.push(e)},onShow:function(){this.updateList()},notify:function(e){switch(e){case this.Evts.UPDATE_PLAYER_LIST:this.updateList()}},view_left:function(){this.currentPage--,this.currentPage<1?this.currentPage=1:this.updateList()},view_right:function(){this.currentPage++,this.currentPage>this.maxPage?this.currentPage=this.maxPage:this.updateList()},updateList:function(){var e=this,t=game.CsArrowData.getPlayerInfo();if(t&&!(t.length<1)){var a=t.length;e.maxPage=Math.ceil(a/e.pageCount),e.maxPage<e.currentPage&&(e.currentPage=e.maxPage);var i=5-a%5,n=(e.currentPage-1)*e.pageCount,s=(n=n<0?0:n)+e.pageCount;if(0<i)for(var o=0,r=n;r<s;r++)t[r]?e.listDatas[o].setData(t[r]):e.listDatas[o].clearData(),o++;e.list.setData(e.listDatas)}},onStageResize:function(){var e=b8e.stageHeight;this.setPosition(0,.5*(e+this.height)+60)}});b8e.module.registerView(game.ME.CsArrowPlayerBar,e)}(),function(){var e=game.View.extends({mailList:null,ctor:function(){this._super(200)},onStageResize:function(){var e=b8e.stageWidth-this.width;this.setPosition(e-17,320)},onShow:function(){}});b8e.module.registerView(game.ME.CsArrowEnter,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_START_ANI:b8e.enc(),C2V_UPDATE_BOTTOM_VIEW:b8e.enc(),V2C_HIDE_AWARD:b8e.enc(),C2C_HIDE_AWARD:b8e.enc(),C2V_RESET_ROTATION:b8e.enc(),C2V_UPDATE_SHOP_ACTIVE:b8e.enc(),C2C_UPDATE_SHOP_COUNT:b8e.enc(),C2C_PET_TURN_ALERT:b8e.enc(),C2C_RESET_GROUP:b8e.enc(),C2V_RESET_GROUP:b8e.enc()}),b8e.RC("$$game","$$PetTurnplateEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._infoArr=[],this.gridNum=8},initData:function(e){this.group=e.shenjiangGroup?e.shenjiangGroup:1;var t=game.ShenJiangCfg.getData(this.group,!0);if(t&&!(t.length<1)){this.curGroupCfg=t[0];for(var a=t.length,i=this._infoArr,n=void 0,s=0;s<a;s++)(n=new game.PetTurnInfo).initCfg(t[s]),i.push(n);var o=e.shenjiangSubIds;if(e.shenjiangSubIds)for(var r=o.length,g=0;g<r;g++)i[o[g]-1].isGray=!0;var l=game.ShenJiangMiscCfg.getData("shenjiangMax");this.maxCount=l?+l.value:8}},checkIsGetAll:function(){var e=!1,t=this._infoArr;if(!t||t.length<1)return e;for(var a=(this.group-1)*this.gridNum,i=t.length,n=0;n<i;n++)t[n].isGray&&a++;return e=this.maxCount<=a},getHadNum:function(){var e=this._infoArr;if(!e||e.length<1)return!1;for(var t=0,a=e.length,i=0;i<a;i++)e[i].isGray&&t++;return t},updateGray:function(e){this.cardID=e.shenjiangSubId;var t=this._infoArr[this.cardID-1];t&&(t.isGray=!0)},resetInfoArr:function(e){this.group=e;var t=game.ShenJiangCfg.getData(this.group,!0);if(t&&!(t.length<1)){this.curGroupCfg=t[0];for(var a=this._infoArr,i=a.length,n=void 0,s=0;s<i;s++)(n=t[s])&&a[s].initCfg(n)}},setCurAward:function(e){if(e){var t=game.ItemInfo.get();t.setData(e),this.prizes=[],this.prizes.push(t)}},setLog:function(e){if(e){for(var t,a=[],i=e.length,n=0;n<i;n++)(t=new game.logInfo).setNetInfo(e[n]),a.push(t);this._logArr=a}},getLog:function(){return!this._logArr||this._logArr.length<1?null:this._logArr},getInfoArr:function(){return!this._infoArr||this._infoArr.length<1?null:this._infoArr},getCostId:function(){return this.costId||this.getCostData(),this.costId},getCostNum:function(){return this.costNum||this.getCostData(),this.costNum},getCostData:function(){var e=game.ShenJiangMiscCfg.getData("shenjiangCost");if(e){var t=e.value.split(",");!t||t.length<1||(this.costId=0|t[0],this.costNum=0|t[1])}},getHuFuEnterArr:function(){return this.enterArr||(this.enterArr=game.GetHuFuCfg.getDatas()),this.enterArr}});game.petTurnplateData=game.petTurnplateData||new e}(),function(){var e;e=b8e.Object.extends({initCfg:function(e){if(e){var t=game.TreasureItemCfg.getData(e.gridId);t&&(this.isGray=!1,this.cfgId=t.id,this.isTag=t.tag,this.id=t.item.Id,this.num=t.item.Num,this.qualityEffect=t.qualityEffect)}}}),b8e.RC("$$game","$$PetTurnInfo",e)}(),function(){var e;e=b8e.Object.extends({setNetInfo:function(e){if(e.name&&e.itemId){var t=game.ItemInfoCfg.getData(e.itemId);this.itemName=t.name,this.name=e.name}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$logInfo",e)}(),function(){var e=game.Control.extends({init:function(){this.isRecruiting=!1,this.petTurnAlert=game.spotAlert.set(game.SAE.PET_TURNPLATE,game.SAE.TURNPLATE),this.hufuAlert=game.spotAlert.set(game.SAE.SHENJIANG_ITEM_ALERT,game.SAE.PET_TURNPLATE)},ipc:function(){this.evts={OpenServer:{C2C_INIT_OPENSERVER:this.onSysData},Back:{C_BACK_UPDATE_ITEMINFO:this.updateItemInfo},PetTurnAward:{C2C_HIDE_AWARD:this.onEndTurnPlate}},this.handels={ShenJiangResp:this.onShenJiangRespon,ShenJiangLogResp:this.onShenJiangLogResp}},onSysData:function(e){var t=e?e.data:null;if(t)if(game.moduleOpen.checkOpen(game.ME.PetTurnplate))game.petTurnplateData.initData(t);else{game.petTurnplateData.initData({shenjiangGroup:1,shenjiangSubIds:[]})}},onShenJiangRespon:function(e){var t=this,a=game.petTurnplateData,i=e.readProtobuf(game.pb.ShenJiangResponse);if(0<i.code)return game.notice.noticeError(i.code),void(t.isRecruiting=!1);a.updateGray(i);var n=i.shenjiangGroup;a.group!=n&&(a.resetInfoArr(n),t.send(t.Evts.C2V_RESET_GROUP),t.dpt(t.Evts.C2C_RESET_GROUP)),a.setCurAward(i.item),t.send(t.Evts.C2V_START_ANI),t.send(t.Evts.C2V_UPDATE_SHOP_ACTIVE),t.dpt(t.Evts.C2C_UPDATE_SHOP_COUNT)},onShenJiangLogResp:function(e){var t=e.readProtobuf(game.pb.ShenJiangLogResponse);0<t.code?game.notice.noticeError(t.code):(game.petTurnplateData.setLog(t.logs),game.module.show(game.ME.PetTurnLog))},onEndTurnPlate:function(){this.isRecruiting=!1,this.send(this.Evts.C2V_RESET_ROTATION)},updateItemInfo:function(){this.checkAlert(),b8e.module.isShowView(game.ME.PetTurnplate)&&this.send(this.Evts.C2V_UPDATE_BOTTOM_VIEW)},checkAlert:function(){if(game.moduleOpen.checkOpen(game.ME.PetTurnplate)){if(game.petTurnplateData.checkIsGetAll())return this.hufuAlert.alert=!1,void this.dpt(this.Evts.C2C_PET_TURN_ALERT);var e=game.petTurnplateData.getCostId(),t=game.itemData.getNumById(e),a=game.petTurnplateData.getCostNum()<=t;a&&this.dpt(this.Evts.C2C_PET_TURN_ALERT),this.hufuAlert.alert=a}else this.hufuAlert.alert=!1},recruitBtn:function(){this.isRecruiting||(this.isRecruiting=!0,this.sender.ShenJiangReq())},recordBtn:function(){this.sender.ShenJiangLogReq()},gotoBtn:function(){game.module.show(game.ME.GetHufu)},shopBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.SHENJIANG_SHOP)}}),t=game.Sender.extends({ipc:function(){this.msg={ShenJiangReq:null,ShenJiangLogReq:null}}});b8e.module.registerControl(game.ME.PetTurnplate,e,game.PetTurnplateEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={}},notify:function(e){switch(e){case this.Evts.V2C_HIDE_AWARD:this.sendMes()}},sendMes:function(){this.dpt(this.Evts.C2C_HIDE_AWARD),this.dpt(this.Evts.C2C_PET_TURN_ALERT)},okBtn:function(){game.module.hide(game.ME.PetTurnAward)}});b8e.module.registerControl(game.ME.PetTurnAward,e,game.PetTurnplateEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={}}});b8e.module.registerControl(game.ME.PetTurnLog,e,game.PetTurnplateEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={}},notify:function(e){},gotoBtn1:function(){this.goto(1)},gotoBtn2:function(){this.goto(2)},gotoBtn3:function(){this.goto(3)},gotoBtn4:function(){this.goto(4)},goto:function(e){var t=game.GetHuFuCfg.getData(e);if(t)if(t.shopType)this.dptG(game.ShopGEvts.SHOW_SHOP,t.shopType);else{if(!t.checkOpenEnum||!t.moduleEnum)return;if(!game.moduleOpen.checkOpenWithTips(t.checkOpenEnum))return;game.module.showToggle(t.moduleEnum,t.toggle)}},closeBtn:function(){this.removeFromParent()},returnBtn:function(){this.removeFromParent()}});b8e.module.registerControl(game.ME.GetHufu,e,game.PetTurnplateEvts,null)}(),function(){var e=game.View.extends({ctor:function(){this._super(834),this.spotAlerts={SHENJIANG_ITEM_ALERT:this.petTurnAlert,SHENJIANG_SHOP_ALERT:this.shopRedAlert}},notify:function(e){var t=this;switch(e){case t.Evts.C2V_START_ANI:t.startAni();break;case t.Evts.C2V_UPDATE_BOTTOM_VIEW:t.updateHufu();break;case t.Evts.C2V_RESET_ROTATION:t.resetRo();break;case t.Evts.C2V_UPDATE_SHOP_ACTIVE:t.updateShopActive();break;case t.Evts.C2V_RESET_GROUP:t.updateImg()}},petTurnAlert:function(e){this.skin.redPointStart.active=e.alert},shopRedAlert:function(e){this.skin.shopRed.active=e.alert},init:function(){var e,t=this.skin;this._gridArr=[];for(var a=1;a<9;a++)(e=game.GridUtil.createTurnplateIcon(game.IconSizeEnum.SIZE_84)).addToParent(this.getComponent("icon"+a)),this._gridArr.push(e);var i=this.anima=b8e.Animator.get(game.AnimType.UI_EFFECT,10);i.addToParent(this.skin.selectImg),i.load(game.ResCfg.getUrl(5019,1010));var n=game.ShopCfg.getDataByShopId(game.ShopIdEnum.SHENJIANG_SHOP);if(n&&n.icon){var s=game.ResCfg.getUrl(78,n.icon);t.shopBtn.loadTexture(s)}var o=game.GridUtil.createViewClickIcon(game.IconSizeEnum.GRID_SIZE_42);o.addToParent(t.hufuIcon);var r=game.petTurnplateData.getCostId();o.setItemId(r),this.updateImg()},onShow:function(){this.updateShow(),this.updateShopActive()},updateShow:function(){var e=game.petTurnplateData.getInfoArr();if(e){for(var t,a,i=this._gridArr,n=0;n<8;n++)a=i[n],t=e[n],game.GridUtil.setTurnplateIcon(a,t,t.isTag),this.getComponent("choice"+n).node.active=t.isGray;this.updateHufu()}},updateImg:function(){var e=this.skin,t=game.petTurnplateData.curGroupCfg;if(t){if(t.title){var a=game.ResCfg.getImgUrl(t.title);e.title.loadTexture(a)}if(t.desc){var i=game.ResCfg.getImgUrl(t.desc);e.desc.loadTexture(i)}}},updateShopActive:function(){var e=game.ShopCfg.getSpotShop(game.ShopIdEnum.SHENJIANG_SHOP);if(e){var t=game.mainRoleData.lv,a=game.miscData.openServerDay,i=game.shopData.getInsLevelByType(e.openInsType),n=e.openLv<=t&&e.openDays<=a&&e.openInsLevel<=i,s=game.petTurnplateData.checkIsGetAll();this.skin.shopBtn.active=n&&s}},updateHufu:function(){var e=this.skin,t=game.petTurnplateData.getCostId(),a=game.itemData.getNumById(t),i=game.petTurnplateData.getCostNum(),n=i<=a,s=n?game.Color.GREEN:game.Color.RED;e.hufuNum.node.color=s,e.hufuNum.string=a+"/"+i,e.recruitBtn.active=n,e.gray.active=!n},startAni:function(){this._totalRun=1,this._curIndex=1,this.skin.selectImg.active=!0,game.TweenUtil.rotationEffect(this.skin.center,360,800),this._startAni()},_startAni:function(){var e=this,t=e.skin,a=e.getComponent("icon"+e._curIndex);t.selectImg.active=!0,t.selectImg.x=a.x,t.selectImg.y=a.y,e.anima.play(null,0),e._curIndex++,e._totalRun++,8<e._curIndex&&(e._curIndex=1);var i=game.petTurnplateData.cardID;if(i){var n=15+i;e._totalRun>n?e.aniEnd():(b8e.Tween.kill(e),b8e.Tween.get(e).wait(100).call(e._startAni,e))}},aniEnd:function(){var e=this.skin;e.selectImg.node.active=!1;var t=game.petTurnplateData.cardID;e.center.rotation=45*(t-1)+22,b8e.Tween.kill(this),this.updateShow(),b8e.Tween.kill(this.skin.center),game.module.show(game.ME.PetTurnAward)},resetRo:function(){this.skin.center.rotation=0},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.PetTurnplate,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(831)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this._list.itemRender=game.PrizeListItem,this._list.addToParent(this.skin.node_prize),this.countDownTime=5},notify:function(e){},onShow:function(){game.TweenUtil.rotationEffect(this.skin.light),this.updateView()},updateView:function(){this.countDownTime=5,this.createPrize(),this.updateTime(),this.createCountDown()},createPrize:function(){var e=game.petTurnplateData.prizes;this._list.setData(e);var t={};t.useritem={items:e},game.ServerItemUtil.analyzeItems(t,1)},updateTime:function(){if(this.countDownTime--,this.skin.timeLab.string=game.Lang.get(598,this.countDownTime),this.countDownTime<1){game.module.hide(game.ME.PetTurnAward)}},createCountDown:function(){this.timer||(this.timer=b8e.Timer.add(this,this.updateTime,1e3)),this.timer.reset(),this.timer.start()},clearCountDown:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},onHide:function(){this.send(this.Evts.V2C_HIDE_AWARD),b8e.Tween.kill(this.skin.light),this.clearCountDown()},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height);this.setPosition(e,50+t)}});b8e.module.registerView(game.ME.PetTurnAward,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(833)},init:function(){this._super(),this.logList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.logList.itemRender=game.PetTurnLogItemView,this.logList.bindEnum=this.moduleEnum,this.logList.addToParent(this.skin.listNode),this.logList.layout.paddingLeft=9,this.logList.layout.paddingTop=10},notify:function(e){},onShow:function(){this.updateShow()},updateShow:function(){var e=game.petTurnplateData.getLog();e?this.logList.setData(e):this.logList.clear()},onHide:function(){},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.PetTurnLog,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(832),this.setSize(540,94)},setData:function(){var e=this.skin,t=this.data,a=game.Lang.get(3722,t.name,t.itemName);e.lab.string=a}}),b8e.RC("$$game","$$PetTurnLogItemView",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(830)},init:function(){this._itemGrid=game.GridUtil.createTipsIcon(game.IconSizeEnum.SIZE_84),this._itemGrid.addToParent(this.skin.icon)},onShow:function(){var e=game.petTurnplateData.getCostId();this.showView(e)},showView:function(e){var t=this;t.itemId=e;var a=t.itemCfg=game.ItemInfoCfg.getData(e);a&&(t.shopSkipId=a.shopId,t.skipId=a.skipId,t.shopGoodsId=a.shopGoodsId,(t.shopSkipId||t.skipId||t.shopGoodsId)&&(t.parent?t.setData():game.GameViewMgr.inst().showView(t)))},setData:function(){var e=this.itemCfg,t=this.skin;this.itemInfo=game.ItemUtil.createBaseItemInfo(e.id,1,this.itemInfo),game.GridUtil.setItemIcon(this._itemGrid,this.itemInfo,!1,0);var a=game.HtmlUtil,i=a.getColorByQuality(e.quality);t.name.string=a.getText(i,e.name);var n=game.petTurnplateData.getHuFuEnterArr();if(n&&!(n.length<1))for(var s=n.length,o=void 0,r=void 0,g=1;g<5;g++)o=g<=s,((r=this.getComponent("gotoBtn"+g)).active=o)&&(r.string=n[g-1].enterName)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GetHufu,e)}(),function(){var e;e=b8e.Enum({NONE:-1,V_UPGRADE_VIEW:-1,V_UPGRADE_EXP:-1,V_SELECT_VIEW:-1}),b8e.RC("$$game","$$MilitaryEvts",e)}(),function(){var e=b8e.Object.extends({maxRank:0,militaryId:0,militaryExp:0,militaryCost:0,showTag:1,nextTag:2,ctor:function(){this._super(),this.showMilitary=b8e.HashMap.get()},setMilitaryInfo:function(e){var t=game.DailyMiscCfg.getData("maxMilitaryLv");this.maxRank=t.value,e.militaryRankId&&(this.militaryId=e.militaryRankId),e.militaryRankExp&&(this.militaryExp=e.militaryRankExp)},setMilitaryCost:function(e){this.militaryCost=e},getInfoById:function(e,t){var a,i=1<arguments.length&&void 0!==t?t:1;if(this._tagArr&&(a=this._tagArr[i])&&(n=a.get(e)))return n;if(this._tagArr||(this._tagArr=[]),this._tagArr[i]||(a=b8e.HashMap.get(),this._tagArr[i]=a),e){var n,s=game.MilitaryRankCfg.getData(e);if(s)return(n=new game.MilitaryInfo).tag=i,n.setData(s),a.set(e,n),n}return null},getAwardList:function(e){var t;if(this._awardList&&this._awardList[e])return this._awardList[e];t=t||[];for(var a=game.MilitaryRankCfg.getDatas(),i=0;i<a.length;i++){var n=a[i];switch(e){case game.MilitaryType.REACH:var s=this.getInfoById(n.id);s.award=n.award,t.push(s);break;case game.MilitaryType.DAILY:var o=new game.MilitaryInfo;o.setData(n),o.award=n.dailyAward,this.showMilitary.set(n.id,o),t.push(o)}}return t&&0<t.length&&(t.sort(this.listSort),this._awardList||(this._awardList=[]),this._awardList[e]=t),t},listSort:function(e,t){return t.id-e.id},isUpgrade:function(){var e;if(!(this.militaryId<this.maxRank))return!1;e=this.militaryId+1;var t=this.getInfoById(e),a=game.UpgradeUtil.checkItemInfo(t.costId,t.cost,!1),i=this.militaryExp>=t.exp,n=game.mainRoleData.power>=t.power;return!!(a&&i&&n)}});game.militaryData=game.militaryData||new e}(),function(){var e;e=b8e.Object.extends({id:0,name:null,icon:"",power:0,exp:0,cost:0,costId:0,teamHp:0,teamAtk:0,teamDef:0,tag:0,ctor:function(){this._super()},setData:function(e){var t=this;t.id=e.id,t.name=e.rank,t.icon=e.icon,t.power=e.power,t.exp=e.exp,t.cost=e.costNum,t.costId=e.costId,t.teamHp=e.teamHp,t.teamAtk=e.teamAtk,t.teamDef=e.teamDef}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$MilitaryInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,REACH:1,DAILY:2}),b8e.RC("$$game","$$MilitaryType",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.MILITARY_ALERT,game.SAE.DAILY_FULI)},ipc:function(){this.evts={DailyFuLi:{C_INIT_MODULE:this.initModule},Back:{C_BACK_UPDATE_ITEMINFO:this.updateItemInfo},MainRole:{C_POWER_CHANGE:this.updataPower}},this.handels={MilitaryRankUpgradeResp:this.upgradeResp,MilitaryRankExpMsg:this.expNotify}},upgradeResp:function(e){var t=e.readProtobuf(game.pb.MilitaryRankUpgradeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.FightAmount.inst().showTeamStatPower();var a={};a.militaryRankId=t.id,a.militaryRankExp=t.exp,game.militaryData.setMilitaryInfo(a),this.checkAlert(),this.send(this.Evts.V_UPGRADE_VIEW)}},expNotify:function(e){var t=e.readProtobuf(game.pb.MilitaryRankExpNotify);if(0<t.code){game.notice.noticeError(t.code)}else{var a={};a.militaryRankExp=t.exp,game.militaryData.setMilitaryInfo(a),this.checkAlert(),this.send(this.Evts.V_UPGRADE_EXP)}},initModule:function(e){e&&e.data&&(game.militaryData.setMilitaryInfo(e.data),game.mainRole.updateNameIcon(),this.checkAlert())},updateItemInfo:function(){var e=game.militaryData.militaryId||1;if(e){var t=game.militaryData.getInfoById(e);if(t){var a=game.itemData.getNumById(t.costId);a+t.cost!=game.militaryData.militaryCost&&(game.militaryData.setMilitaryCost(a),this.checkAlert(),this.send(this.Evts.V_UPGRADE_EXP))}}},updataPower:function(){this.checkAlert(),this.send(this.Evts.V_UPGRADE_EXP)},btn_up:function(){var e=game.militaryData.militaryId||1,t=game.militaryData.getInfoById(e);if(t&&game.UpgradeUtil.checkItemInfo(t.costId,t.cost)){this.sender.MilitaryRankUpgradeReq()}},lbl_get:function(){game.notice.show(game.Lang.get(4202))},military:function(){game.module.show(game.ME.MilitaryAward)},checkAlert:function(){if(game.moduleOpen.checkOpen(this.moduleEnum)){var e=game.militaryData.isUpgrade();this.spotAlert.alert=e}}}),t=game.Sender.extends({ipc:function(){this.msg={MilitaryRankUpgradeReq:null}}});b8e.module.registerControl(game.ME.Military,e,game.MilitaryEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={}},sureBtn:function(){this.send(this.Evts.V_SELECT_VIEW,1)},dailyBtn:function(){this.send(this.Evts.V_SELECT_VIEW,2)}});b8e.module.registerControl(game.ME.MilitaryAward,e,game.MilitaryEvts)}(),function(){var e;e=game.ListItem.extends({_infoList:null,ctor:function(){this._super(631),this.setSize(540,94)},init:function(){this.prizeList1=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),this.prizeList1.itemRender=game.ShowItemListItem,this.prizeList1.bindEnum=game.ME.MilitaryAward,this.prizeList1.addToParent(this.skin.prizeList),this.prizeList1.layout.spacingX=0,this.prizeList1.layout.paddingLeft=-5},setData:function(e){var t=this.skin,a=e.id,i=game.Color.WHITE;i=1<=a&&a<5?game.Color.GREEN:5<=a&&a<9?game.Color.GREEN:9<=a&&a<13?game.Color.BLUE:13<=a&&a<17?game.Color.PURPLE:17<=a&&a<21?game.Color.YELLOW:game.Color.RED,t.titleLab.setColor(i),t.titleLab.string="\u3010"+e.name+"\u3011";var n=game.ResCfg.getUrl(147,e.icon);t.icon.loadTexture(n),3<e.award.length?this.skin.prizeList.setPosition(230,4):this.skin.prizeList.setPosition(300,4),this.setDailyAward(e)},setDailyAward:function(e){if(e.award){var t=game.CfgUtil.getPrizeListInfo(e.award,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_69);this.prizeList1.setData(t.items)}}}),b8e.RC("$$game","$$MilitaryAwardItem",e)}(),function(){var e=game.View.extends({maxCount:0,maxWidth:513,ctor:function(){this._super(632)},notify:function(e,t){switch(e){case this.Evts.V_SELECT_VIEW:this.updataPanel(t)}},init:function(){var e,t=this,a=t;t.awardList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),t.awardList.itemRender=game.MilitaryAwardItem,t.awardList.addToParent(t.skin.scrollGrid1),t.awardList.bindEnum=game.ME.MilitaryAward,t.awardList.layout.spacingY=5,e=game.militaryData.getAwardList(game.MilitaryType.REACH),a.awardList.setData(e),t.awardDailyList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),t.awardDailyList.itemRender=game.MilitaryAwardItem,t.awardDailyList.addToParent(t.skin.scrollGrid2),t.awardDailyList.bindEnum=game.ME.MilitaryAward,t.awardDailyList.layout.spacingY=5,e=game.militaryData.getAwardList(game.MilitaryType.DAILY),a.awardDailyList.setData(e)},onShow:function(){this.updataPanel(1)},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+50)},updataPanel:function(e){var t=this.skin;t.scrollGrid1.active=1==e,t.scrollGrid2.active=2==e,t.sureBtnLight.node.active=1==e,t.dailyBtnLight.node.active=2==e,t.lbl_type.node.string=1==e?game.Lang.get(9204):game.Lang.get(9205)}});b8e.module.registerView(game.ME.MilitaryAward,e)}(),function(){var e;e=game.Widget.extends({ctor:function(e){this._super(633),this._data=e},init:function(){this.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),this.roleData.setMale(game.mainRoleData.isMale),this.roleData.heroModel.setBody(game.RoleType.Foster,game.mainRoleData.isMale?1001:1002),this.role=game.sceneRoleCreate.createUIRole(this.roleData),this.role.addToParent(this.skin.model),this.skin.model.setScale(.8,.8),this.spriteStat=game.SpriteStat.get()},onShow:function(){this.setData(this._data)},onHide:function(){},setData:function(e){var a=this,t=a.skin;if(a._data=e,t){a.setAnim();var i=!0;if(e){a.spriteStat.clear(),a.spriteStat.setupByCfg(e);var n=e.tag;2==n&&e&&25==e.id&&(i=!1);var s=void 0,o="",r=a.spriteStat.getSpriteStats(),g=1;r.forEach(function(e,t){(s=game.AttrRulesCfg.getData(e))&&(o=game.Lang.get(50135,s.name,t),a.getComponent("lbl_current"+g).string=o),g++});var l=e.id,c=game.Color.WHITE;21<=l?c=game.Color.RED:17<=l&&l<21?c=game.Color.YELLOW:13<=l&&l<17?c=game.Color.PURPLE:9<=l&&l<13?c=game.Color.BLUE:5<=l&&l<9&&(c=game.Color.GREEN),t.lbl_military.setColor(c),t.lbl_military.string=e.name;var h=game.ResCfg.getUrl(147,e.icon);t.img_military.loadTexture(h),2==n&&25==e.id&&(t.lbl_current1.string=game.Lang.get(50133))}else t.lbl_current1.string=game.Lang.get(50134);t.lbl_current2.active=e&&i,t.lbl_current3.active=e&&i,t.img_military.active=e,t.title.active=e,t.lbl_name.string=game.mainRoleData.name,t.name_bg.node.y=e?362:377}},setAnim:function(){this.roleData.heroModel.clear(),this.roleData.heroModel.type=game.RoleType.Hero,this.roleData.heroModel.setAnims(game.mainRoleData.heroModel.copyAnim()),game.mainRoleData.heroModel.surfaces&&this.roleData.heroModel.setSurfaces(game.mainRoleData.heroModel.surfaces);var e=game.AvatarUtil;e.updateUIModel(this.role,e.ID_2),this.role.transition(game.RoleStateType.ACTION_IDLE)}}),b8e.RC("$$game","$$MilitaryItem",e)}(),function(){var e=game.View.extends({maxCount:0,maxWidth:513,ctor:function(){this._super(634)},init:function(){},notify:function(e){switch(e){case this.Evts.V_UPGRADE_VIEW:this.updataPanel();break;case this.Evts.V_UPGRADE_EXP:this.rankExp=game.militaryData.militaryExp,this.updataPower(),this.updatacondition()}},onShow:function(){this.updataPanel()},onHide:function(){},onStageResize:function(){this.setPosition(0,0)},updataPanel:function(){this.rankId=game.militaryData.militaryId,this.rankExp=game.militaryData.militaryExp,this.updataPower(),this.updatacondition(),this.updataShow()},updataPower:function(){var e=this.skin;e.fightAmount.string=game.mainRoleData.power,game.AutoLayoutUtil.layoutPower(e.fightAmountBg,e.fightAmount,e.powerIcon)},onEffectClear:function(e){if(e){e.clear()}},updatacondition:function(){var e=this,t=e.skin,a=e.rankId+1||1,i=game.militaryData.maxRank;e.rankId>=i&&(a=i);var n=game.militaryData.getInfoById(a),s=game.itemData.getNumById(n.costId),o=e.updataString(1,game.mainRoleData.power,n.power),r=e.updataString(2,e.rankExp,n.exp),g=e.updataString(3,s,n.cost);t.lbl_1.string=o,t.lbl_2.string=r,t.lbl_3.string=g,t.lbl_3.active=n.cost,t.icon.active=n.cost,t.lbl_desc.active=n.cost,t.redPoint.node.active=e.con1&&e.con2&&e.con3,t.lbl_max.active=e.rankId==i,t.condition.active=e.rankId!=i;var l=game.ResCfg.getUrl(137,n.costId);t.icon.loadTexture(l)},updataShow:function(){var e=this,t=this.rankId,a=this.rankId+1,i=game.militaryData.getInfoById(t,game.militaryData.showTag);e._curItem||(e._curItem=new game.MilitaryItem,e._curItem.addToParent(e.skin.currentModel),e._curItem.show()),this._curItem.setData(i),a>game.militaryData.maxRank&&(a=game.militaryData.maxRank);var n=game.militaryData.getInfoById(a,game.militaryData.nextTag);e._nextItem||(e._nextItem=new game.MilitaryItem,e._nextItem.addToParent(e.skin.seniorModel),e._nextItem.show()),this._nextItem.setData(n)},updataString:function(e,t,a){var i="";switch(e){case 1:i=game.Lang.get(9208),this.con1=a<=t;break;case 2:i=game.Lang.get(9209),this.con2=a<=t;break;case 3:this.con3=a<=t}return i=t<a?i+"<color=#EA0101>"+t+"<c/><color=#FFFFFF>/"+a+"<c/>":i+"<color=#0ABF00>"+t+"<c/><color=#FFFFFF>/"+a+"<c/>"}});b8e.module.registerView(game.ME.Military,e)}(),function(){var e;e=b8e.Enum({SERV_UPDATE_DATA:b8e.enc(),C2V_SET_BTNS_DATA:b8e.enc(),C2V_MOVE_LIST:b8e.enc(),C2V_SELECT_BTN:b8e.enc(),V2C_SELECT_BTN:b8e.enc(),UPDATE_RANK_INFO:b8e.enc(),UPDATE_CONDITION_INFO:b8e.enc(),GET_RANK_INFO:b8e.enc(),GET_CONDITION_INFO:b8e.enc(),REQ_ATTEND_ACTIVITY:b8e.enc(),GET_ATTEND_ACTIVITY_RESP:b8e.enc(),GET_ATTEND_ACTIVITY_RESP_ERR:b8e.enc(),REQ_COMPLETE_FESTIVALTASK:b8e.enc(),GET_COMPLETE_ACTIVE_RESP:b8e.enc(),ACTIVITY_CLOSE:b8e.enc(),C2V_CLOSE_VIEW:b8e.enc()}),b8e.RC("$$game","$$FestivalEvts",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(365)},init:function(){var e=this,t=e.festivalBtns=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.FestivalBtnItem,t.addToParent(e.skin.list),t.bindEnum=game.ME.Festival,t.layout.spacingX=15},onShow:function(){var e=game.festivalData.getDefauSubType();this.send(game.FestivalEvts.V2C_SELECT_BTN,e)},notify:function(e,t){switch(e){case game.FestivalEvts.C2V_SET_BTNS_DATA:this.setBtnsData();break;case game.FestivalEvts.C2V_MOVE_LIST:this.selectBtn(t);break;case game.FestivalEvts.C2V_SELECT_BTN:this.setImg();break;case game.FestivalEvts.C2V_CLOSE_VIEW:this.closeView()}},closeView:function(){game.module.hide(game.ME.Festival)},selectBtn:function(){},setBtnsData:function(){var e=game.festivalData.getFestivalList()||[];this.festivalBtns.setData(e)},setImg:function(){var e=this,t=game.festivalData.getCurSelectSubType();if(t==game.FestivalSubType.FST_NONE)e.skin.titleNode.setVisible(!1),e.skin.festivalTiltleImg.setVisible(!0);else{var a=game.festivalData.getTitleNameByType(t);if(e.titleImg||(e.titleImg=b8e.Sprite.get(),e.titleImg.addToParent(e.skin.titleNode),e.titleImg.setAnchor(.5,.5)),a){e.skin.titleNode.setVisible(!0),e.skin.festivalTiltleImg.setVisible(!1);var i=game.ResCfg.getImgUrl(a);e.titleImg.loadTexture(i)}else e.skin.titleNode.setVisible(!1),e.skin.festivalTiltleImg.setVisible(!0)}},viewLeftBtn:function(){this.festivalBtns.scrollContainerLeft()},viewRightBtn:function(){this.festivalBtns.scrollContainerRight()}});b8e.module.registerView(game.ME.Festival,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(364),this.setSize(96,106)},init:function(){var e=this.btn=b8e.Sprite.get();e.addToParent(this.skin.titleImg),e.setAnchor(.5,.5)},setData:function(){var e=this.data,t=game.festivalData.getIconNameByType(e.festivalType);if(t){var a=game.ResCfg.getImgUrl(t);this.btn.loadTexture(a)}this.skin.titleImgSelect.setVisible(e.select),this.skin.alert.setVisible(e.alert||!1)},onClickBtn:function(){this.send(game.FestivalEvts.V2C_SELECT_BTN,this.data.festivalType)}}),b8e.RC("$$game","$$FestivalBtnItem",e)}(),function(){var e;e=b8e.Enum({FESTIVAL_NONE:0,FESTIVAL_LOGIN:1,FESTIVAL_EXCHANGE:2,FESTIVAL_STICK:3,FESTIVAL_BOSS:4,FESTIVAL_TASK:5,FESTIVAL_TASK_SCORE:6,FESTIVAL_RESET_RECHARGE:7,FESTIVAL_KEEP_RECHARGE:8,FESTIVAL_ACCU_RECHARGE:9,FESTIVAL_KEEP_RECHARGE2:10,FESTIVAL_SINGLE_RECHARGE2:21,FESTIVAL_SHOP:51,FESTIVAL_COST:100,FESTIVAL_RANK:200}),b8e.RC("$$game","$$FestivalType",e)}(),function(){var e;e=b8e.Enum({FST_NONE:0,FST_LOGIN:1,FST_EXCHANGE:2,FST_STICK:3,FST_BOSS:4,FST_TASK:5,FST_TASK_SCORE:6,FST_RESET_RECHARGE:7,FST_KEEP_RECHARGE:8,FST_ACCU_RECHARGE:9,FST_KEEP_RECHARGE2:10,FST_KEEP_RECHARGE3:11,FST_ACCU_RECHARGE2:12,FST_ACCU_RECHARGE3:13,FST_KEEP_RECHARGE4:14,FST_KEEP_RECHARGE5:15,FST_KEEP_RECHARGE6:16,FST_ACCU_RECHARGE4:17,FST_ACCU_RECHARGE5:18,FST_ACCU_RECHARGE6:19,FESTIVAL_SINGLE_RECHARGE:21,FESTIVAL_SINGLE_RECHARGE2:22,FST_DISCOUNT_SHOP:51,FST_SALE_SHOP:52,FST_MYSTERY_SHOP:53,FST_COST_GOLD:101,FST_COST_GOLD2:102,FST_COST_GOLD3:103,FST_COST_GOLD4:104,FST_COST_GOLD5:105,FST_COST_GOLD6:106,FST_RANK_RECHARGE:201,FST_RANK_COST_GOLD:202}),b8e.RC("$$game","$$FestivalSubType",e)}(),function(){var e=b8e.Object.extends({cDatas:null,curSType:0,endCdFestivals:null,fEndTimestamp:-1,endFestivals:null,originMenu:null,ctor:function(){var e=this;e.fInfo={me:{},saes:{},ctrl:{},alone:{}},e.fMenuBtns=[],e.fBtnInfos=[],e.cDatas={fModel:{}},e.cfME=-1,e.cJSON={},e.endCdFestivals=[],e.endFestivals=[],e.originMenu="",e.fLength=0},setOriginMenu:function(e){this.originMenu=e},getBtnlistByMenu:function(e){if(!e)return[];for(var t=[],a=0;a<this.fMenuBtns.length;a++)if(this.fMenuBtns[a].belongMenu==e){t=this.fMenuBtns[a].btnList;break}return t},getDefauSubType:function(){var e=this.getCurSelectSubType(),t=this.getBtnlistByMenu(this.originMenu);if(0!=e)for(var a=0;a<t.length;a++)if(t[a].festivalType==e)return e;return 0<t.length?t[0].festivalType:game.FestivalSubType.FST_NONE},getSubTypeIndex:function(e){var t=this.getCExtByType(e,"belongMenu");if(!t)return 0;for(var a=this.getBtnlistByMenu(t),i=0;i<a.length;i++){if(a[i].festivalType==e)return i}return 0},delEndTimeFs:function(e){for(var t=this,a=[],i=0;i<t.endCdFestivals.length;i++){var n=t.endCdFestivals[i];if(!(0<n.endTime-e)){for(var s=null,o=n.subType,r=0;r<t.fBtnInfos.length;r++)if(t.fBtnInfos[r].subType==o){s=t.fBtnInfos[r].info;break}if(s)for(var g=t.getCExtByType(o,"belongMenu"),l=0;l<t.fMenuBtns.length;l++){var c=t.fMenuBtns[l].btnList;if(g&&c){var h=c.indexOf(s);-1!=h&&c.splice(h,1)}t.cDatas[o]&&(a.push(t.fInfo.me[o]),delete t.cDatas[o])}}}return a},updateFetivals:function(e){var t=this;t.respFInfo=e,t.fTasks=e.tasks,t.fMenuBtns=[],t.fBtnInfos=[],t.cDatas={fModel:{}},t.cfME=-1,t.cJSON={},t.endCdFestivals=[],t.endFestivals=[],t.fEndTimestamp=-1;var a=e.events;t.fLength=a.length;for(var i=+game.LoginConfig.getGameChannelId(),n=void 0,s=0;s<a.length;s++){var o=a[s];if(o&&o.subType&&(!((n=o.gameChannelIds)&&0<n.length&&0!=n[0])||-1<n.indexOf(i))){var r=o.subType,g=o.sortId;t.cDatas[r]=o;var l=!0;if(r!=game.FestivalSubType.FST_STICK&&r!=game.FestivalSubType.FST_TASK_SCORE||(l=!1),l){var c=t.getMEBySubType(r);if(!game.moduleOpen.checkOpen(c))continue}var h=t.getExtByExtName(r,"menuSAE"),m=t.fInfo.saes[r];if(m&&h){var u=b8e.getDPV(game.SAE,h);if(u){var d=game.spotAlert.cover(m.sae,u);d.alert=!1,m.saeCb&&m.ctrl&&m.saeCb.call(m.ctrl,d)}}if(0<(A=o.endTime)-game.SysTime.curTime){var f=new game.FestivalBtnInfo;f.bindInfo(r,g);var p=t.getCExtByType(r,"belongMenu");if(p){for(var _=[],v=!0,E=0;E<t.fMenuBtns.length;E++)if(t.fMenuBtns[E].belongMenu==p){_=t.fMenuBtns[E].btnList,v=!1;break}_.push(f),v&&t.fMenuBtns.push({belongMenu:p,btnList:_})}t.fBtnInfos.push({subType:r,info:f}),t.endFestivals.push({subType:r,endTime:A}),-1==t.fEndTimestamp?t.fEndTimestamp=A:t.fEndTimestamp=t.fEndTimestamp>A?A:t.fEndTimestamp}}}for(var C=0;C<t.fMenuBtns.length;C++){(_=t.fMenuBtns[C].btnList).sort(function(e,t){return e.sortId-t.sortId})}if(-1!=t.fEndTimestamp)for(var T=0;T<t.endFestivals.length;T++){var A,I=t.endFestivals[T];(A=I.endTime)==t.fEndTimestamp&&t.endCdFestivals.push({subType:I.subType,endTime:A})}t.cDatas[t.curSType]||(t.curSType=t.getDefauSubType()),t.curSType!=game.FestivalSubType.FST_NONE&&t.updateSelect(t.curSType)},updateEndTimestamp:function(){var e=this;e.endCdFestivals=[];for(var t=-1,a=0;a<e.endFestivals.length;a++){(n=e.endFestivals[a].endTime)<=e.fEndTimestamp||(t=-1!=t?n<t?n:t:n)}if(e.fEndTimestamp=t,-1!=e.fEndTimestamp)for(var i=0;i<e.endFestivals.length;i++){var n,s=e.endFestivals[i];(n=s.endTime)==e.fEndTimestamp&&e.endCdFestivals.push({subType:s.subType,endTime:n})}},updateModel:function(e){this.cDatas.fModel=e},getTaskById:function(e){for(var t=0;t<this.fTasks.length;t++)if(this.fTasks[t].taskId==e)return this.fTasks[t];return null},getTasks:function(){return this.fTasks},getData:function(e){return this.cDatas[e]?this.cDatas[e]:null},getDatas:function(){return this.cDatas},getModelData:function(e){var t=this.cDatas.fModel;if(!t)return null;var a=b8e.getDPV(t,e);return a||null},getCExtByType:function(e,t){var a=this.getData(e);if(!a)return"";var i=a.clientExt;if(!i)return"";var n=null;if(this.cJSON[e]?n=this.cJSON[e]:this.cJSON[e]=n=JSON.parse(i),!n)return"";return b8e.getFPV(n,t)||""},getFestivalIsOpen:function(e){var t=!1;if(!this.respFInfo||!this.respFInfo.events)return t;for(var a=this.respFInfo.events,i=0;i<a.length;i++)if(a[i].subType==e){t=!0;break}return t},getTitleNameByType:function(e){return this.getCExtByType(e,"title")},getExtByType:function(e){var t=this.getCExtByType(e,"ext");return t||[]},getExtByExtName:function(e,t){var a=this.getExtByType(e);if(!a)return"";for(var i=0;i<a.length;i++)if(b8e.getFPV(a[i],"extName")==t)return b8e.getFPV(a[i],"extVal");return""},getMenuIconByOrigin:function(e){for(var t=this.getBtnlistByMenu(e),a=0;a<t.length;a++){var i=this.getCExtByType(t[a].festivalType,"menuIcon");if(i)return i}return""},getBannerNameByType:function(e){return this.getCExtByType(e,"banner")},getIconNameByType:function(e){return this.getCExtByType(e,"icon")},getHasOpenFestivalByType:function(e){return 0<this.getBtnlistByMenu(e).length},getFestivalList:function(){return this.getBtnlistByMenu(this.originMenu)},setCurFestivalME:function(e){this.cfME=e},getCurFestivalME:function(){return this.cfME},regAloneData:function(e,t){this.fInfo.alone[e]=t},regData:function(e,t){this.fInfo.me[e]=t},regSaeData:function(e,t,a,i){this.fInfo.saes[e]={sae:t,saeCb:a,ctrl:i}},getMEBySubType:function(e){return this.fInfo.me[e]},setCurSelectSubType:function(e){this.curSType=e},getCurSelectSubType:function(){return this.curSType},updateSelect:function(e){var t=this.getCExtByType(e,"belongMenu");if(t)for(var a=this.getBtnlistByMenu(t),i=0;i<a.length;i++){var n=a[i];n.select=n.festivalType==this.curSType}},updateAlert:function(e,t){var a=this.getCExtByType(e,"belongMenu");if(a)for(var i=this.getBtnlistByMenu(a),n=0;n<i.length;n++){var s=i[n];if(s.festivalType==e){s.alert=t;break}}},delFesByType:function(e){var t=this,a=null;if(t.fBtnInfos&&!(t.fBtnInfos.length<1)){for(var i=0;i<t.fBtnInfos.length;i++)if(t.fBtnInfos[i].subType==e){a=t.fBtnInfos[i].info;break}if(a&&t.fMenuBtns&&!(t.fMenuBtns.length<1))for(var n=t.getCExtByType(e,"belongMenu"),s=0;s<t.fMenuBtns.length;s++){var o=t.fMenuBtns[s].btnList;if(n&&o){var r=o.indexOf(a);-1!=r&&o.splice(r,1)}t.cDatas[e]&&delete t.cDatas[e]}}}});game.festivalData=game.festivalData||new e}(),function(){var e;e=b8e.Object.extends({sortId:0,select:!1,festivalType:0,alert:!1,bindInfo:function(e,t){this.festivalType=e,this.sortId=t}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$FestivalBtnInfo",e)}(),function(){var e;e=game.Control.extends({getData:function(e){var t=e||this.fSubType;return game.festivalData.getData(t)},getModelData:function(e){return""===e?(b8e.error("\u9700\u8981\u4f20\u5165\u6b63\u786e\u7684\u5b57\u7b26\u4e32\u53d8\u91cf\u540d"),null):game.festivalData.getModelData(e)},getDatas:function(){return game.festivalData.getDatas()},reqRankList:function(e){var t=e||this.fSubType;this.dptG(game.FestivalEvts.GET_RANK_INFO,t)},reqConditionInfo:function(e){var t=e||this.fSubType;this.dptG(game.FestivalEvts.GET_CONDITION_INFO,t)},reqAttendActivity:function(e,t){var a=e||this.fSubType;this.dptG(game.FestivalEvts.REQ_ATTEND_ACTIVITY,{subType:a,avtivityId:t})},reqCompleteFestivalTask:function(e){this.dptG(game.FestivalEvts.REQ_COMPLETE_FESTIVALTASK,e)}}),b8e.RC("$$game","$$FestivalActionCtrl",e)}(),function(){var e;e=game.FestivalActionCtrl.extends({fSubType:-1,regFestival:function(e,t,a,i,n){this.fSubType=e,n?game.festivalData.regAloneData(e,t):game.festivalData.regData(e,t),a&&(game.festivalData.regSaeData(e,a,i,this),game.spotAlert.setCb(a,this.updateAlert,this))},updateAlert:function(e){game.festivalData.updateAlert(this.fSubType,e.alert)}}),b8e.RC("$$game","$$FestivalItemCtrl",e)}(),function(){var e;e=game.Control.extends({ipc:function(){var e=this;e.handels={FestivalMsg:e.onFestivalDataUpdate,FestivalModelResp:e.onFModelDataUpdate,FestivalRankResp:e.onFestivalRankResp,FestivalConditionResp:e.onFestivalConditionResp,AttendActivityResp:e.attendActivityResp,CompleteFestivalTaskResp:e.CompleteFestivalTaskResp},e.gevts={FestivalEvts:{GET_RANK_INFO:function(e){this.sender.FestivalRankReq(e.data)},GET_CONDITION_INFO:function(e){this.sender.FestivalConditionReq(e.data)},REQ_ATTEND_ACTIVITY:function(e){this.sender.AttendActivityReq(e.data)},REQ_COMPLETE_FESTIVALTASK:function(e){this.sender.CompleteFestivalTaskReq(e.data)},ACTIVITY_CLOSE:function(){this.send(game.FestivalEvts.C2V_CLOSE_VIEW)}}},e.evts={FestivalBoss:{C2C_COMPLETE:e.completeFesBoss}}},init:function(){this.fData=game.festivalData,this.timer=null},onFestivalRankResp:function(e){var t=e.readProtobuf(game.pb.FestivalRankResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.dptG(game.FestivalEvts.UPDATE_RANK_INFO,t)},onFestivalConditionResp:function(e){var t=e.readProtobuf(game.pb.FestivalConditionResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.dptG(game.FestivalEvts.UPDATE_CONDITION_INFO,t)},attendActivityResp:function(e){var t=e.readProtobuf(game.pb.AttendActivityResponse);if(0<t.code){return game.notice.noticeError(t.code),void this.dptG(game.FestivalEvts.GET_ATTEND_ACTIVITY_RESP_ERR,t)}this.dptG(game.FestivalEvts.GET_ATTEND_ACTIVITY_RESP,t)},CompleteFestivalTaskResp:function(e){var t=e.readProtobuf(game.pb.CompleteFestivalTaskResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.dptG(game.FestivalEvts.GET_COMPLETE_ACTIVE_RESP,t)},updateTime:function(){var e=game.SysTime.curTime;if(0!=game.festivalData.endCdFestivals.length){var t=game.festivalData.fEndTimestamp;if(!(0<t-e)&&this.startCdTime){for(var a=game.festivalData.delEndTimeFs(t),i=0;i<a.length;i++){var n=a[i];n&&game.module.hideTab(n)}var s=game.festivalData.getDefauSubType();b8e.module.isShowView(game.ME.Festival)&&this.switchPage(s),game.festivalData.updateEndTimestamp(),this.startCdTime=-1!=game.festivalData.fEndTimestamp}}},onFModelDataUpdate:function(e){var t=e.readProtobuf(game.pb.FestivalModel);if(0<t.code){game.notice.noticeError(t.code)}else{if(this.fData.updateModel(t),b8e.module.isShowView(game.ME.Festival)){var a=game.festivalData.getDefauSubType();this.switchPage(a)}this.dptG(game.FestivalEvts.SERV_UPDATE_DATA)}},onFestivalDataUpdate:function(e){var t=this,a=e.readProtobuf(game.pb.FestivalActivityNotify);if(0<a.code){game.notice.noticeError(a.code)}else t.timer&&(t.startCdTime=!1,b8e.Timer.remove(t,t.updateTime),t.timer=null),t.fData.updateFetivals(a),-1!=game.festivalData.fEndTimestamp&&(t.startCdTime=!0,t.timer=b8e.Timer.add(t,t.updateTime,1e3)),0==game.festivalData.fLength&&t.dptG(game.FestivalEvts.ACTIVITY_CLOSE),t.sender.FestivalModelReq()},notify:function(e,t){switch(e){case game.FestivalEvts.V2C_SELECT_BTN:this.switchPage(t)}},switchPage:function(e){e==game.FestivalSubType.FST_NONE&&b8e.log("[\u8282\u65e5\u6d3b\u52a8] \u4e00\u4e2a\u6570\u636e\u90fd\u6ca1\u6709");game.festivalData.setCurSelectSubType(e),this.updateBtnInfo(e),this.send(game.FestivalEvts.C2V_MOVE_LIST,e),this.showView(e)},updateBtnInfo:function(e){game.festivalData.updateSelect(e),this.send(game.FestivalEvts.C2V_SET_BTNS_DATA)},showView:function(e){var t=game.festivalData.getCurFestivalME();if(-1<t){game.module.hideTab(t)}var a=game.festivalData.getFestivalList();if(!a||a.length<1){game.festivalData.setCurFestivalME(-1)}else{var i=game.festivalData.getMEBySubType(e);i&&(game.festivalData.setCurFestivalME(i),game.module.showTab(i,game.ME.Festival),this.send(game.FestivalEvts.C2V_SELECT_BTN))}},completeFesBoss:function(){var e=game.festivalData,t=game.FestivalSubType.FST_BOSS;if(e.delFesByType(t),e.getCurSelectSubType()==t){var a=e.getMEBySubType(t);a&&b8e.module.isShowView(a)&&game.module.hideTab(a)}var i=e.getDefauSubType();b8e.module.isShowView(game.ME.Festival)&&this.switchPage(i)}});var t=game.Sender.extends({ipc:function(){this.msg={FestivalModelReq:null,FestivalRankReq:this.festivalRankReq,FestivalConditionReq:this.festivalConditionReq,AttendActivityReq:this.attendActivityReq,CompleteFestivalTaskReq:this.festivalTaskCompleteReq}},festivalRankReq:function(e){var t=game.pb.FestivalRankRequest;t.subType=e,this.write(t)},festivalConditionReq:function(e){var t=game.pb.FestivalConditionRequest;t.subType=e,this.write(t)},attendActivityReq:function(e){var t=game.pb.AttendActivityRequest;t.subType=e.subType,t.id=e.avtivityId,this.write(t)},festivalTaskCompleteReq:function(e){var t=game.pb.CompleteFestivalTaskRequest;t.taskId=e,this.write(t)}});b8e.module.registerControl(game.ME.Festival,e,game.FestivalEvts,t),b8e.RC("$$game","$$FestivalControl",e)}(),function(){var e;e=game.FestivalActionCtrl.extends({regFs:null,regFestivals:function(e){this.regFs={};for(var t=null,a=null,i=null,n=null,s=null,o=0;o<e.length;o++)a=(t=e[o]).fSubType,i=t.sae,n=t.saeCb,s=t.me,game.festivalData.regData(a,s),i&&(game.festivalData.regSaeData(a,i,n,this),game.spotAlert.setCb(i,this.updateAlert,this)),this.regFs[a]=t},updateAlert:function(e){for(var t in this.regFs)if(this.regFs[t].sae==e.spotAlertEnum){game.festivalData.updateAlert(this.regFs[t].fSubType,e.alert);break}}}),b8e.RC("$$game","$$FestivalItemListCtrl",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_MONEY:-1,C2C_UPDATE_MODULE:-1,C2V_CHANGE_PAGE:-1,V2C_SELECT_BTN:-1,V2C_SHOW_VIEW:-1,C2C_REFRESH_BTNS:-1,V2C_GET_REWARD:-1,C2V_UDPATE_DATA:-1}),b8e.RC("$$game","$$AccumulativeRechargeEvts",e)}(),function(){var e=b8e.Object.extends({accRechargeMoney:0,awardList:null,curGroup:0,endTime:0,isGetAllAward:!0,ctor:function(){this._super(),this.activityList=[],this.awardList=[],this.moneyMap=b8e.HashMap.get(),this.activityMap=b8e.HashMap.get()},setupData:function(e,t,a){e&&(this.awardList=e);var i=game.miscData,n=i.openServerDay;if(this.curGroup=game.AccumulativeRechargeCfg.getCurGroup(n),t&&this.moneyMap.set(t,a),this.curGroup){var s=game.AccumulativeRechargeCfg.getOneDataByDay(this.curGroup);s&&(this.endTime=i.openServerTime+(s.serverEnd-1)*b8e.TimeUtil.DAY_MICRO_SECONDS),this.initList()}},initList:function(){var e=this;e.activityList.length=0;var t=game.AccumulativeRechargeCfg.getListByDay(e.curGroup);if(t&&!(t.length<1)){var a=0,i=t.length;e.isGetAllAward=!0;for(var n=e.getAccRechargeMoney(),s=game.CCommonUtil.getGameChannelIdOpen,o=0;o<i;o++){var r=t[o];if(s(r)){var g=new game.AccumulativeRechargeInfo;g.index=a,a++,g.setData(r),g.isGetAward=e.getIsGetAward(g.id),e.isGetAllAward&&(e.isGetAllAward=g.isGetAward),r.money<=n?g.canGet=!0:g.canGet=!1,e.activityMap.set(g.id,g),e.activityList.push(g),g.updateRechageVal(),g.updateState()}}e.activityList.sort(e._sortState)}},_sortState:function(e,t){return e.state==t.state?e.id-t.id:e.state-t.state},getIsGetAward:function(e){return-1<this.awardList.indexOf(e)},setAward:function(e){var t=this;if((n=t.activityMap.get(e)).isGetAward=!0,n.updateState(),t.activityList.sort(t._sortState),t.awardList.push(e),t.isGetAllAward=!0,t.activityList&&!(t.activityList.length<1))for(var a=t.activityList.length,i=0;i<a;i++){var n;if(!(n=t.activityList[i]).isGetAward)return void(t.isGetAllAward=!1)}},updataAccRechargeMoney:function(e){var t=this,a=t.moneyMap.get(t.curGroup);if(a?a+=e:a=e,t.moneyMap.set(t.curGroup,a),t.activityList&&!(t.activityList.length<1)){for(var i=t.activityList.length,n=0;n<i;n++){var s=t.activityList[n];s.needMoney<=a?s.canGet=!0:s.canGet=!1,s.updateRechageVal(),s.updateState()}t.activityList.sort(t._sortState)}},resetDaily:function(){var e=game.miscData,t=e.openServerDay,a=game.AccumulativeRechargeCfg.getCurGroup(t);if(a!=this.curGroup&&((this.curGroup=a)&&this.moneyMap.set(a,0),this.curGroup)){var i=game.AccumulativeRechargeCfg.getOneDataByDay(this.curGroup);i&&(this.endTime=e.openServerTime+(i.serverEnd-1)*b8e.TimeUtil.DAY_MICRO_SECONDS),this.initList()}},checkOpenType:function(e){var t=game.miscData.openServerDay,a=game.AccumulativeRechargeCfg.getDataByType(e);return!!a&&this.getIsOpenType(a,t)},getIsOpenType:function(e,t){for(var a=e.length,i=0;i<a;i++){var n=e[i];if(t>=n.serverStart&&t<n.serverEnd)return!0}return!1},getIsOpen:function(){return!!game.moduleOpen.checkOpen(game.ME.AccumulativeRecharge)&&(!!this.curGroup&&!!game.AccumulativeRechargeCfg.getOneDataByDay(this.curGroup))},getAllAward:function(){return this.isGetAllAward},getAccRechargeMoney:function(){var e=this.moneyMap.get(this.curGroup);return e||0},getActivityList:function(){return this.activityList},getActivityInfo:function(e){return this.activityMap.get(e)},getEndTime:function(){return this.endTime-game.SysTime.curTime},getMaxId:function(){return!this.activityList||this.activityList.length<1?0:this.activityList[this.activityList.length-1].id},checkAlert:function(){if(this.curGroup&&this.activityList&&!(this.activityList.length<1)){if(this.isGetAllAward)return!1;for(var e=this.activityList.length,t=0;t<e;t++){var a=this.activityList[t];if(a.canGet&&!a.isGetAward)return!0}return!1}},getShowPartnerId:function(){var e=0<this.activityList.length?this.activityList[0]:null;if(!e)return 0;var t=e.getCfg();return t?t.partnerId:0}});game.accumulativeRechargeData=game.accumulativeRechargeData||new e}(),function(){var e;e=b8e.Object.extends({id:0,isGetAward:!1,canGet:!1,needMoney:0,index:0,accuRechargeVal:0,state:0,setData:function(e){this.id=e.id,this.needMoney=e.money,this.updateRechageVal()},updateRechageVal:function(){this.accuRechargeVal=game.accumulativeRechargeData.getAccRechargeMoney()},updateState:function(){var e=0;e=this.isGetAward?3:this.canGet?1:2,this.state=e},getCfg:function(){var e=game.AccumulativeRechargeCfg.getDataById(this.id);return e||null},getPrizeList:function(){if(this.prizeList)return this.prizeList;var e=game.AccumulativeRechargeCfg.getDataById(this.id);if(!e)return null;var t=game.CfgUtil.getPrizeListInfo(e.award,game.IconLayoutEnum.SHOW_ALL);return this.prizeInfo=t.items,this.prizeInfo}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$AccumulativeRechargeInfo",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.ACCUMULATIVERECHARGE_PAGE_ALERT,game.SAE.OPEN_SERVER_ALERT)},ipc:function(){this.evts={Recharge:{C_INIT_MODEL:this.initRechargeData,C_RECHARGE_SUCCESS:this.rechargeSuccess},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={AccumulativeRechargeAwardResp:this.accumulativeRechargeAwardResp}},accumulativeRechargeAwardResp:function(e){var t=e.readProtobuf(game.pb.AccumulativeRechargeAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.accumulativeRechargeData.setAward(t.id),this.checkSpotAlert(),this.send(this.Evts.C2V_UDPATE_DATA),this.changeOpenServer(),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},notify:function(e,t){switch(e){case this.Evts.V2C_GET_REWARD:this.getBtn(t)}},initRechargeData:function(){var e=game.rechargeData;game.accumulativeRechargeData.setupData(e.accRechargeAwards,e.accRechargeGroup,e.accRechargeMoney),this.checkSpotAlert(),this.changeOpenServer()},changeOpenServer:function(){var e=this.tempList;(e=e||(this.tempList=b8e.HashMap.get())).clear();var t=game.AccumulativeRechargeCfg.getDatas();if(t&&!(t.length<1)){for(var a=null,i=0,n=t.length;i<n;i++){var s=t[i];(a=e.get(s.type))||a||(a={openServerType:game.OpenServerType.ACCRECHARGE,type:s.type,isActive:game.accumulativeRechargeData.checkOpenType(s.type)&&!game.accumulativeRechargeData.getAllAward(),param:0,sae:game.SAE.ACCUMULATIVERECHARGE_PAGE_ALERT},e.set(s.type,a))}this.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER_LIST,e.values())}},rechargeSuccess:function(e){if(e&&e.data){var t=e.data,a=0;if(t.id){var i=game.RechargeCfg.getDataById(t.id);i&&(a=i.money)}else a=t.money;game.accumulativeRechargeData.updataAccRechargeMoney(a),this.checkSpotAlert(),this.send(this.Evts.C2V_UPDATE_MONEY)}},resetDaily:function(){game.accumulativeRechargeData.resetDaily(),this.checkSpotAlert(),this.send(this.Evts.C2V_UDPATE_DATA),this.dpt(this.Evts.C2C_REFRESH_BTNS),this.changeOpenServer()},getBtn:function(e){e&&this.sender.AccumulativeRechargeAwardReq(e)},checkSpotAlert:function(){var e=game.accumulativeRechargeData;this.spotAlert.alert=e.checkAlert()},btn_huoban:function(){var e=game.accumulativeRechargeData.getShowPartnerId();e&&(game.partnerData.setShowInfo(e),game.module.show(game.ME.PartnerDetails))}}),t=game.Sender.extends({ipc:function(){this.msg={AccumulativeRechargeAwardReq:this.accumulativeRechargeAwardReq}},accumulativeRechargeAwardReq:function(e){var t=game.pb.AccumulativeRechargeAwardRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.AccumulativeRecharge,e,game.AccumulativeRechargeEvts,t)}(),function(){var e=game.View.extends({ctor:function(){this._super(12)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.AccumulativeRechargeListItem,e.addToParent(this.skin.list),e.bindEnum=game.ME.AccumulativeRecharge,e.layout.spacingY=5,e.layout.paddingTop=0},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_MONEY:this.updataMoney();break;case this.Evts.C2V_UDPATE_DATA:this.updateData()}},updateData:function(){this.updateList(),this.updataMoney(),this.updateShowPartner()},updateShowPartner:function(){var e=game.accumulativeRechargeData.getShowPartnerId();if(this.skin.btn_huoban.active=0!=e,this.skin.modelNode.setVisible(0!=e),e){this.surfaceModel||(this.surfaceModel=new game.SurfaceModel,this.surfaceModel.addToParent(this.skin.modelNode),this.surfaceModel.initModel(),this.surfaceModel.roleData.heroModel.type=game.RoleType.Partner);var t=game.PartnerCfg.getData(e);t&&game.AvatarUtil.updateModel(t,this.surfaceModel,game.RoleType.Partner)}},onShow:function(){var e=this;e.endTime=game.accumulativeRechargeData.endTime,e.updateData(),e.updateTime(),0<e.endTime?e.leftTimer=b8e.Timer.add(e,e.updateTime,1e3):(e.skin.time.string="",e.leftTimer=null),e.list.scrollToTop()},onHide:function(){this.leftTimer&&(b8e.Timer.remove(this,this.updateTime),this.leftTimer=null)},updateList:function(){var e=game.accumulativeRechargeData.getActivityList();this.list.setData(e)},updataMoney:function(){var e=game.accumulativeRechargeData.getAccRechargeMoney();this.skin.rechargeMoney.string=game.Lang.get(4101,e)},updateTime:function(){if(this.endTime){var e=this.endTime-game.SysTime.curTime;if(e<=0){this.skin.time.string=""}else{var t=game.TimeUtil.formatTimeSpace(e,3);this.skin.time.string=0<e?game.Lang.get(51896,t):""}}else{this.skin.time.string=game.Lang.get(9053)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.AccumulativeRecharge,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1405),this.setSize(600,176)},init:function(){var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.prizeList),e.layout.spacingX=15},setData:function(){var e=this.data,t=this.skin;t.name.string=game.Lang.get(4102,e.needMoney),t.isGetAward.setVisible(e.isGetAward),t.noGetAward.setVisible(!e.isGetAward),t.canGet.setVisible(e.canGet&&!e.isGetAward),t.cantGet.setVisible(!e.canGet&&!e.isGetAward),t.prog.string=e.isGetAward?"":game.Lang.get(e.canGet?51890:51891,e.accuRechargeVal,e.needMoney);var a=e.getPrizeList()||[];this.prizeList.setData(a)},onClick:function(){this.send(game.AccumulativeRechargeEvts.V2C_GET_REWARD,this.data.id)}}),b8e.RC("$$game","$$AccumulativeRechargeListItem",e)}(),function(){var e=game.FestivalItemCtrl.extends({init:function(){this._super(),this.spotAlert=game.spotAlert.set(game.SAE.DRAWLOT)},ipc:function(){this.evts={Recharge:{C_RECHARGE_SUCCESS:this.rechargeSuccess}},this.gevts={FestivalEvts:{SERV_UPDATE_DATA:this.syncData,ACTIVITY_CLOSE:this.closeView}},this.handels={StickResp:this.onStickRespon}},notify:function(e,t){switch(e){case game.DrawLotEvts.CHANGEITEM_SELECT:this.selectItem(t)}},selectItem:function(e){game.drawLotData.setCurItem(e),game.drawLotData.updateSelectItem(),this.send(game.DrawLotEvts.V_CHANGEITEM_SELECT,e)},rechargeSuccess:function(e){e&&e.data&&(game.drawLotData.setServerList(e.data),this.checkAlert(),this.send(game.DrawLotEvts.RECHARGE_SUCCESS))},closeView:function(){game.module.hide(game.ME.DrawLot)},LotsBtn:function(){var e=game.drawLotData.getCurItem();this.sender.StickReq(e)},checkAlert:function(){if(this.spotAlert){var e=game.drawLotData.isActiveTime(),t=game.drawLotData.checkAlert();this.spotAlert.alert=e&&t}},onStickRespon:function(e){var t=e.readProtobuf(game.pb.StickResponse);0<t.code?game.notice.show(game.Lang.get(9406)):(game.drawLotData.setPrize(t),this.send(game.DrawLotEvts.STICK_COMPLETE,t.stickId),game.module.show(game.ME.LotPrize),this.checkAlert())},syncData:function(){var e=this.getModelData("sticks"),t=game.festivalData.getData(game.FestivalSubType.FST_STICK);e&&(game.drawLotData.synData(e),game.drawLotData.initRechargeList(),game.drawLotData.setUrlData(t),this.checkAlert())}}),t=[game.ME.LotPrize],a=game.Sender.extends({ipc:function(){this.msg={StickReq:this.requestStick}},requestStick:function(e){var t=game.pb.StickRequest;t.stickId=e,this.write(t)}});b8e.module.registerControl(game.ME.DrawLot,e,game.DrawLotEvts,a,t)}(),function(){var e;e=b8e.Object.extends({rechargeId:0,select:!1,state:!1,stickId:0,isRecharge:!1,money:0,sortId:0,setData:function(e){this.rechargeId=e.rechargeId,this.money=e.money,this.addAccuGold=e.addAccuGold,this.sortId=e.sortId}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$LotItemInfo",e)}(),function(){var e=b8e.Object.extends({pfType:0,rechargeList:null,serverStickMap:null,curItemID:0,lastItemId:0,isLastStick:!1,multipleId:0,baseMoney:0,stickId:0,stickRateId:0,stickName:0,extMap:null,endTime:0,ctor:function(){this.serverStickMap=b8e.HashMap.get(),this.rechargeList=[],this.extMap=b8e.HashMap.get()},synData:function(e){for(var t=e,a=void 0,i=0;i<t.length;i++)a=t[i],this.serverStickMap.set(a.id,a)},setData:function(e){this.stickId=e.stickId,this.stickRateId=e.id},getStickState:function(e){var t=this.serverStickMap;if(!t||t.length<1)return!1;for(var a=0;a<t.length;a++){if(t[a].id==e)return t[a].state}return!1},setRechargeList:function(){var e=this.rechargeList,t=this.serverStickMap;if(e&&t)for(var a=0;a<e.length;a++){var i=t.get(e[a].stickId);i?(e[a].isRecharge=!0,e[a].state=i.state):(e[a].isRecharge=!1,e[a].state=!1)}},setServerList:function(e){if(e){var t=e.id,a=game.rechargeData.pfType,i=game.StickCfg.getDataByType(a);if(i){for(var n=!1,s=0;s<i.length;s++)i[s].rechargeId==t&&(n=!0);if(n){var o=game.StickCfg.getDataByRechargeId(t);if(o){var r=this.serverStickMap;r.get(o.stickId)||(r.set(o.stickId,o),o.state=!1),this.setRechargeList()}}}}},initRechargeList:function(){var e=this,t=game.rechargeData.pfType,a=game.StickCfg.getDataByType(t);if(a&&!(a.length<1)){(!e.rechargeList||0<e.rechargeList.length)&&(e.rechargeList=[]);for(var i=void 0,n=void 0,s=void 0,o=void 0,r=0;r<a.length;r++)o=a[r],(i=game.RechargeCfg.getDataById(o.rechargeId))&&((n=new game.LotItemInfo).stickId=a[r].stickId,n.state=e.getStickState(n.stickId),n.isRecharge=e.isRecharge(o.stickId),n.setData(i),s=e.rechargeList.length,e.rechargeList[s]=n);e.rechargeList.sort(e.onSort),s=e.rechargeList.length;var g=e.rechargeList[s-1];e.lastItemId=g.stickId,e.setRechargeList()}},onSort:function(e,t){return e.sortId-t.sortId},getRechargeList:function(){return this.rechargeList},setCurItem:function(e){this.curItemID=e},getCurItem:function(){return this.curItemID},isRecharge:function(e){return!!this.serverStickMap.get(e)},updateSelectItem:function(){for(var e=void 0,t=0;t<this.rechargeList.length;t++)(e=this.rechargeList[t]).select=e.stickId==this.curItemID,e.select&&(this.baseMoney=e.addAccuGold)},getItemState:function(e){return!!this.serverStickMap.get(e)},setPrize:function(e){this.multipleId=e.id;var t=e.stickId,a=this.rechargeList,i=this.serverStickMap.get(t);i.state=!0,this.serverStickMap.set(t,i);for(var n=0;n<a.length;n++){if(a[n].stickId==t)a[n].state=!0}this.hasLast()},getNounPrize:function(e){var t=game.StickCfg.getDataById(e);if(t){var a=gaem.RechargeCfg.getDataById(t.rechargeId);if(a)return a.addAccuGold}},getBaseMoney:function(){return this.baseMoney},hasLast:function(){for(var e=this.serverStickMap,t=this.rechargeList,a=0,i=0;i<t.length;i++){var n=e.get(t[i].stickId);if(!n)break;n.state&&a++}if(a>=t.length)e.clear();else{var s=e.get(this.lastItemId);if(!s)return;s.state&&(e.del(this.lastItemId),this.isLastStick=!0)}this.setRechargeList()},checkAlert:function(){for(var e=this.rechargeList,t=0;t<e.length;t++){var a=e[t].stickId,i=this.serverStickMap.get(a);if(i&&!i.state)return!0}},setUrlData:function(e){if(e){var t=game.festivalData.getCExtByType(game.FestivalSubType.FST_STICK,"ext");if(t&&!(t.length<1)){this.extMap||(this.extMap=b8e.HashMap.get());for(var a=null,i=0;i<t.length;i++){a=t[i];var n=b8e.getFPV(a,"extName"),s=b8e.getFPV(a,"extVal");this.extMap.set(n,s)}this.endTime=e.endTime}}},getUrl:function(e){return this.extMap?this.extMap.get(e):null},isActiveTime:function(){return 0<this.endTime-game.SysTime.curTime}});game.drawLotData=game.DrawLotData||new e}(),function(){var e;e=b8e.Enum({None:0,C_CHANGEITEM_SELECT:b8e.enc(),V_CHANGEITEM_SELECT:b8e.enc(),RECHARGE_SUCCESS:b8e.enc(),STICK_COMPLETE:b8e.enc()}),b8e.RC("$$game","$$DrawLotEvts",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(339),this.setSize(300,132)},init:function(){var e=this.icon=b8e.Sprite.get();e.addToParent(this.skin.icon),e.setAnchor(.5,.5);var t=this.bg=b8e.Sprite.get();t.addToParent(this.skin.infoBg_2),t.setAnchor(.5,.5)},setData:function(){var e,t=this.data,a=this.skin;if(a.check_select.active=!1,e=game.RechargeCfg.getDataById(t.rechargeId)){var i=game.drawLotData.getUrl("itemBG");i=game.ResCfg.getImgUrl(i),this.bg.loadTexture(i);var n=game.ResCfg.getUrl(98,e.icon);this.icon.loadTexture(n);var s=t.isRecharge;a.cantGetBtn.node.active=!s,a.isLot.node.active=s;var o=t.state,r=o?"1":"0";s?(a.canLot.node.active=!o,a.Got.node.active=o,a.redPoint.node.active=!o,a.canGetLevel.string=game.Lang.get(4103,e.money,r)):(a.canGetLevel.string=game.Lang.get(4103,e.money,"0"),a.redPoint.node.active=!1),this.setSelect()}},setSelect:function(){this.skin.check_select.node.active=this.data.select},cantGetBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)},clickBtn:function(){this.send(game.DrawLotEvts.CHANGEITEM_SELECT,this.data.stickId)}}),b8e.RC("$$game","$$DrawLotsItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(340)},init:function(){var e=this,t=e.skin;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);e.list.itemRender=game.DrawLotsItem,e.list.addToParent(t.scroll),e.list.layout.paddingLeft=0,e.list.layout.paddingRight=0,e.list.layout.paddingTop=0,e.list.layout.spacingX=5,e.list.layout.spacingY=5,e.list.bindEnum=game.ME.DrawLot;var a=e.banner=b8e.Sprite.get();a.setAnchor(.5,.5),a.addToParent(t.bg_0);var i=e.font_1=b8e.Sprite.get();i.setAnchor(.5,.5),i.addToParent(t.font_1);var n=e.title=b8e.Sprite.get();n.setAnchor(.5,.5),n.addToParent(t.title)},notify:function(e,t){switch(e){case game.DrawLotEvts.V_CHANGEITEM_SELECT:this.updateList(),this.setViewData(t),this.updateBaseMoney();break;case game.DrawLotEvts.STICK_COMPLETE:this.updateList(),this.setViewData(t);break;case game.DrawLotEvts.RECHARGE_SUCCESS:this.updateList()}},onShow:function(){this.firstData(),this.setLab(),this.updateList(),this.updateBaseMoney()},firstData:function(){var e=game.drawLotData.getRechargeList();if(0==game.drawLotData.getCurItem()){var t=e[0].stickId;this.send(game.DrawLotEvts.CHANGEITEM_SELECT,t)}},setViewData:function(e){var t=this.skin,a=game.drawLotData.serverStickMap.get(e);if(a){var i=a.state,n=i?0:1;t.count.string=""+n,t.LotsBtn.active=!i,t.noLotsBtn.active=i}else t.LotsBtn.active=!1,t.noLotsBtn.active=!0,t.count.string="0"},updateList:function(){var e=game.drawLotData.getRechargeList();!e||e.length<1||this.list.setData(e)},setLab:function(){this.skin.desc.string=game.Lang.get(50146);var e=game.festivalData.getCExtByType(game.FestivalSubType.FST_STICK,"title"),t=game.festivalData.getCExtByType(game.FestivalSubType.FST_STICK,"banner"),a=game.ResCfg.getUrl(70,e),i=game.ResCfg.getUrl(151,t);this.title.loadTexture(a),this.banner.loadTexture(i)},updateBaseMoney:function(){this.skin.basicMoney.string=game.drawLotData.getBaseMoney()}});b8e.module.registerView(game.ME.DrawLot,e)}(),function(){var e,t=e=game.View.extends({_showModel:!0,_lightEffect:null,ctor:function(){this._super(341)},init:function(){var e=this.model=b8e.Sprite.get();e.setAnchor(.5,0),e.addToParent(this.skin.model),(this.itemIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.SIZE_84)).addToParent(this.skin.item),this._lightEffect=new game.LightEffect},onShow:function(){this.initView(),this.showLight()},initView:function(){var e=this.skin,t=game.drawLotData.multipleId,a=game.StickRateCfg.getData(t);if(a){var i=a.multiple;i=i.toFixed(1),e.multiple.string=i;var n=game.drawLotData.getUrl("stick");n=n+"/"+a.stickType,this.model.loadTexture(game.ResCfg.getUrl(70,n));var s=game.ItemInfoCfg.getData(21),o=i*game.drawLotData.getBaseMoney()>>0;this.itemIcon.setItemInfo(s),this.itemIcon.setNum(o,null,null,!1)}},showLight:function(){this._lightEffect||(this._lightEffect=new game.LightEffect),this._lightEffect.parent||(this._lightEffect.addToParent(this.skin.light),this._lightEffect.setVisible(!0))},onHide:function(){this._lightEffect&&this._lightEffect.removeFromParent()}});b8e.module.registerView(game.ME.LotPrize,t),b8e.RC("$$game","$$LotPrize",e)}(),function(){var e;e=b8e.Enum({GET_TASK_REWARD_REQ:-1,GET_BOX_REWARD_REQ:-1,GET_RANK_REQ:-1,GET_RANK_RESPONSE:-1,UPDATE_YUANBAO_COUNT:-1,CLICK_TASK_BOX:-1}),b8e.RC("$$game","$$YearTaskEvent",e)}(),function(){var e;e=b8e.Object.extends({taskId:0,taskType:0,taskName:null,desc:null,items:null,p1:null,p2:null,score:0,progress:0,state:0,setTaskPro:function(e){var t=this;t.taskId=e.taskId,t.taskType=e.taskType,t.taskName=e.name,t.desc=e.desc,t.items=e.showItem,t.p1=e.conditionParam1,t.p2=e.conditionParam2,t.score=e.score,t.progress=e.progress,t.state=e.state},getSortId:function(){return 1==this.state?0:0==this.state?1:2==this.state?2:0},update:function(e,t){e&&(this.progress=e),t&&(this.state=t)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$YearTaskItemInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,conditionValue:0,sortId:0,awards:null,canGet:!1,isGet:!1,setData:function(e){this.id=e.id,this.conditionValue=e.conditionValue,this.sortId=e.sortId,this.awards=e.awards},setIsGet:function(e){e!=this.isGet&&(this.isGet=e,this.canGet=!e)},getSortId:function(){var e=game.YearTaskData.getConitions(this.id);return e&&0<e?1e6:this.sortId}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$YearPayItemInfo",e)}(),function(){var e=b8e.Object.extends({myRank:0,rankList:null,currentBoxData:null,getTaskBoxDatas:function(){return null},taskList:null,setTaskData:function(e){var t,a;if(this.taskList)for(;0<this.taskList.length;)this.taskPool.push(this.taskList.pop());else this.taskList=[],this.taskPool=[];for(var i=0;i<e.length;i++)a=e[i],(t=0<this.taskPool.length?this.taskPool.pop():new game.YearTaskItemInfo).setTaskPro(a),this.taskList.push(t)},addTaskData:function(e){var t=0<this.taskPool.length?this.taskPool.pop():new game.YearTaskItemInfo;t.setTaskPro(e),this.taskList.push(t)},removeTaskData:function(e){for(var t=0;t<this.taskList.length;t++)if(e==this.taskList[t].taskId){this.taskList.splice(t,1);break}},updateTaskState:function(e,t,a){if(this.taskList)for(var i,n=0;n<this.taskList.length;n++)if((i=this.taskList[n]).taskId==e){i.update(t,a);break}},getTaskState:function(e){for(var t,a=0;a<this.taskList.length;a++)if((t=this.taskList[a]).taskId==e)return t;return null},stateDic:null,updateConditions:function(){var e;this.stateDic={};for(var t=game.festivalData.getModelData("activities"),a=0;a<t.length;a++)(e=t[a])&&(this.stateDic[e.id]=e.count)},getConitions:function(e){return this.stateDic?this.stateDic[e]:0},payCount:0,lastCount:0,getPayCount:function(){return this.payCount},updatePayCount:function(e){var t=0<arguments.length&&void 0!==e&&e,a=game.amount.get(game.AmountType.YUAN_BAO);if(0==this.lastCount||t)this.lastCount=a;else{if(this.lastCount>a){var i=this.lastCount-a;this.payCount+=i}this.lastCount=a}},payDatas:null,payPool:null,getPayDatas:function(e){if(this.payDatas||(this.payDatas=[],this.payPool=[]),e){var t,a;this.payDatas=[];for(var i=0;i<e.length;i++)t=e[i],(a=0<this.payPool.length?this.payPool.pop():new game.YearPayItemInfo).eventData=t,this.payDatas.push(a);return this.payDatas}},recPayDatas:function(){if(!this.payDatas)return this.payDatas=[],void(this.payPool=[]);for(;0<this.payDatas.length;)this.payPool.push(this.payDatas.pop())}});game.YearTaskData=game.YearTaskData||new e}(),function(){var e;e=game.ListItem.extends({_prizeList:null,ctor:function(){this._super(1149),this.setSize(500,177)},init:function(){var e=this;e.bg=b8e.Sprite.get(),e.bg.setAnchor(.5,.5),e.bg.addToParent(e.skin.bgContainer),e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList.itemRender=game.ShowItemListItem,e._prizeList.bindEnum=game.ME.YearTask,e._prizeList.layout.paddingLeft=0,e._prizeList.layout.spacingX=35,e._prizeList.addToParent(e.skin.itemContainer)},onShow:function(){},setData:function(e){var t=e,a=this.skin;a.titleTxt.string=t.taskName,a.activeNumTxt.string=game.Lang.get(4722,t.score);var i=t.progress<t.p1?game.Color.RED:game.Color.GREEN,n=game.HtmlUtil.getText(i,t.progress),s=game.HtmlUtil.getText(game.Color.GREEN,"/"+t.p1);a.conditionTxt.string=t.desc+"("+n+s+")",a.getBtn.setVisible(1==t.state),a.getEnBtn.setVisible(0==t.state),a.getBtnTxt2.string=2==t.state?game.Lang.get(9451):game.Lang.get(9383),a.already_got.setVisible(2==t.state),a.redPoint.active=1==t.state;var o=game.CfgUtil.getPrizeListInfo2(t.items);this._prizeList.setData(o.items)},getBtn:function(){var e=this.data;e&&this.send(game.YearTaskEvent.GET_TASK_REWARD_REQ,e.taskId)},getEnBtn:function(){game.notice.show(9452)}}),b8e.RC("$$game","$$YearTaskItemView",e)}(),function(){var e=game.View.extends({list:null,endTime:0,timeVt:6e3,boxIndex:0,taskIndex:0,currentBox:null,score:0,anims:null,ctor:function(){this._super(1151)},onStageResize:function(){this.setPosition(0,0)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.list.itemRender=game.YearTaskItemView,e.list.bindEnum=game.ME.YearTask,e.list.layout.paddingTop=0,e.list.layout.spacingY=10,e.list.addToParent(e.skin.taskList),e.skin.progress.setVisible(!0);var t=e._banner=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(e.skin.ban)},onShow:function(){var e=game.festivalData.getBannerNameByType(game.FestivalSubType.FST_TASK);if(e&&""!=e){var t=game.ResCfg.getImgUrl(e,!0);this._banner.loadTexture(t)}this.updateView()},notify:function(e){switch(e){case game.FestivalEvts.C2V_SELECT_BTN:this.updateView()}},updateView:function(){var e=this;game.FestivalType.FESTIVAL_TASK;if(p=game.festivalData.getData(game.FestivalSubType.FST_TASK_SCORE)){var t=p.datas,a=game.festivalData.getModelData("activities"),i=game.festivalData.getModelData("conditions"),n=game.YearTaskData.taskList;n.sort(e.onSortTask),e.list.setData(n);var s=e.skin;if(e.currentBox=null,p){if(i)for(var o,r=0;r<i.length;r++)if((o=i[r]).subType==game.FestivalSubType.FST_TASK_SCORE){e.score=o.value;break}var g,l={};for(r=0;r<a.length;r++)(g=a[r])&&(l[g.id]=g.count);var c=t;c.sort(e.onSort);for(var h,m,u=-1,d=c.length,f=0;f<d;f++)if(0==(m=l[(h=c[f]).id])||!m){u=f,e.currentBox=h;break}-1==u&&(u=d-1);var p;d-(e.taskIndex=u)-1<5&&(u=d-5),e.boxIndex=u;for(var _,v=0,E=0;E<5;E++)_=E+1,m=l[(h=c[e.boxIndex+E]).id],e.getComponent("t"+_).string=h.conditionValue,e.getComponent("s"+_).setVisible(0<m),0<m?(v++,e.removeAnima(E)):h.conditionValue<=e.score&&e.playAnima(E);v=1<v?v-1:0,s.progress.width=v/4*380,s.activeNumTxt.string=e.score,e.endTime=p.endTime,s.timeTxt.string=b8e.TimeUtil.formatDayTime(e.endTime-game.SysTime.curTime),(p={}).currentBox=e.currentBox,p.score=e.score,p.startIndex=e.boxIndex,s.redPoint.active=p.currentBox&&p.currentBox.conditionValue<=p.score,e.send(game.YearTaskEvent.GET_BOX_REWARD_REQ,p),e.startTime()}}},playAnima:function(e){this.skin;this.anims||(this.anims=[]);var t=this.anims[e];if(t||(t=this.createAnim(),this.anims[e]=t),!t.parent){var a=e+1,i=this.getComponent("ec"+a);t.addToParent(i)}t.setVisible(!0),t.play()},createAnim:function(){var e=b8e.Animator.get(game.AnimType.UI_EFFECT,1);return e.load(game.ResCfg.getUrl(5019,2006)),e.setScale(1,1),e},removeAnima:function(e){if(this.anims){var t=this.anims[e];t&&(t.setVisible(!1),t.removeFromParent())}},onSort:function(e,t){return e.id-t.id},onSortTask:function(e,t){var a=e.getSortId()-t.getSortId();return 0!=a?a:e.taskId-t.taskId},startTime:function(){this.endTime<game.SysTime.curTime?this.clearTimer():this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,this.timeVt),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){this.skin.timeTxt.string=b8e.TimeUtil.formatDayTime(this.endTime-game.SysTime.curTime),this.endTime<game.SysTime.curTime&&this.clearTimer()},clear:function(){this.clearTimer(),this.list&&this.list.clear();for(var e=0;e<5;)this.removeAnima(e),e++},onHide:function(){}});b8e.module.registerView(game.ME.YearTask,e)}(),function(){var e=game.View.extends({_prizeList:null,_showModel:!0,ctor:function(){this._super(1150)},init:function(){this._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this._prizeList.itemRender=game.ShowItemListItem,this._prizeList.bindEnum=game.ME.YearTaskPrize,this._prizeList.layout.paddingLeft=20,this._prizeList.layout.spacingX=35,this._prizeList.addToParent(this.skin.prizeList)},onShow:function(){this.update()},update:function(){var e=game.YearTaskData.currentBoxData;if(e){var t=game.CfgUtil.getPrizeListInfo2(e.awards);this._prizeList.setData(t.items)}},onHide:function(){this._prizeList&&this._prizeList.clear()}});b8e.module.registerView(game.ME.YearTaskPrize,e)}(),function(){var e=game.FestivalItemCtrl.extends({csArrowAlert:null,ipc:function(){this.gevts={FestivalEvts:{SERV_UPDATE_DATA:this.onDataHandler,GET_ATTEND_ACTIVITY_RESP:this.attendActivityResp,UPDATE_CONDITION_INFO:this.updateConditionResp,GET_COMPLETE_ACTIVE_RESP:this.completeTaskResp}},this.handels={FestivalTaskMsg:this.FestivalTaskMsg}},init:function(){this.regFestival(game.FestivalSubType.FST_TASK,game.ME.YearTask,game.SAE.YEAR_TASK,this.alertCall)},alertCall:function(e){this.csArrowAlert=e},showAlert:function(){this.csArrowAlert&&(this.csArrowAlert.alert=this.checkAlert())},stateDic:null,checkAlert:function(){var e,t,a=game.festivalData.getData(game.FestivalSubType.FST_TASK_SCORE),i=game.festivalData.getModelData("activities"),n=game.festivalData.getModelData("conditions"),s=game.YearTaskData.taskList,o=0;if(this.stateDic||(this.stateDic={}),i)for(var r=0;r<i.length;r++)(t=i[r])&&(this.stateDic[t.id]=t.count);if(a&&n){var g;for(r=0;r<n.length;r++)if((g=n[r]).subType==game.FestivalSubType.FST_TASK_SCORE){o=g.value;break}}if(0<o&&a){var l,c=a.datas;for(r=0;r<c.length;r++)if(o>=(e=c[r]).conditionValue&&(!(l=this.stateDic[e.id])||0==l))return!0}if(s&&0<s.length)for(r=0;r<s.length;r++)if(1==s[r].state)return!0;return!1},onDataHandler:function(){var e=game.festivalData.getTasks();game.YearTaskData.setTaskData(e),this.send(game.FestivalEvts.C2V_SELECT_BTN),this.showAlert()},attendActivityResp:function(e){var t=e.data,a=t.id,i=game.festivalData.getModelData("activities");if(t.subType==game.FestivalSubType.FST_TASK_SCORE){var n={};n.id=a,n.count=1,i.push(n),this.send(game.FestivalEvts.C2V_SELECT_BTN)}this.showAlert()},updateConditionResp:function(e){var t=e.data;if(t.subType==this.fSubType){var a=t.value;game.YearTaskData.updateTaskState(taskId,a,null),this.send(game.FestivalEvts.C2V_SELECT_BTN),this.showAlert()}},completeTaskResp:function(e){var t=e.data,a=t.taskId,i=t.nextTask,n=game.YearTaskData.getTaskState(a),s=null==n?0:n.score;if(i){for(var o=game.festivalData.getTasks(),r=0;r<o.length;r++){if(o[r].taskId==a){o.splice(r,1),o.push(i);break}}game.YearTaskData.removeTaskData(a),game.YearTaskData.addTaskData(i)}else game.YearTaskData.updateTaskState(a,null,2);if(n){var g,l=game.festivalData.getModelData("conditions"),c=!1;for(r=0;r<l.length;r++)if((g=l[r]).subType==game.FestivalSubType.FST_TASK_SCORE){g.value+=s,c=!0;break}c||((g={}).subType=game.FestivalSubType.FST_TASK_SCORE,g.value=s,l.push(g)),this.send(game.FestivalEvts.C2V_SELECT_BTN),this.showAlert()}else this.send(game.FestivalEvts.C2V_SELECT_BTN)},FestivalTaskMsg:function(e){var t=e.readProtobuf(game.pb.FestivalTaskProcessNotify);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.taskId,i=t.progress,n=t.state;game.YearTaskData.updateTaskState(a,i,n),this.send(game.FestivalEvts.C2V_SELECT_BTN),this.showAlert()}},onGetTaskRewardRequest:function(e){this.reqCompleteFestivalTask(e)},onGetBoxRewardRequest:function(e){this.waitSv=!1,this.reqAttendActivity(game.FestivalSubType.FST_TASK_SCORE,e)},bx1Btn:function(){this.clickBox(0)},bx2Btn:function(){this.clickBox(1)},bx3Btn:function(){this.clickBox(2)},bx4Btn:function(){this.clickBox(3)},bx5Btn:function(){this.clickBox(4)},clickBox:function(e){var t=game.festivalData.getData(game.FestivalSubType.FST_TASK_SCORE);if(t){var a=t.datas;if(a&&0!=a.length){var i=this.boxData.startIndex+e;if(!(i>=a.length)){var n=a[i];(game.YearTaskData.currentBoxData=n)&&(b8e.module.isShowView(game.ME.YearTaskPrize)||game.module.show(game.ME.YearTaskPrize))}}}},waitSv:!1,boxData:null,getBoxBtn:function(){this.boxData&&this.boxData.currentBox?this.boxData.currentBox.conditionValue>this.boxData.score?game.notice.show(4406):this.reqAttendActivity(game.FestivalSubType.FST_TASK_SCORE,this.boxData.currentBox.id):game.notice.show(4406)},getUIBoxData:function(e){this.boxData=e},notify:function(e,t){switch(e){case game.YearTaskEvent.GET_TASK_REWARD_REQ:this.onGetTaskRewardRequest(t);break;case game.YearTaskEvent.GET_BOX_REWARD_REQ:this.getUIBoxData(t)}}});b8e.module.registerControl(game.ME.YearTask,e,game.YearTaskEvent)}(),function(){var e=game.Control.extends({returnBtn:function(){game.module.hide(game.ME.YearTaskPrize)}});b8e.module.registerControl(game.ME.YearTaskPrize,e,game.YearTaskEvent)}(),function(){var e;e=b8e.Enum({None:0,C2C_RESET_RECHARGE:-1}),b8e.RC("$$game","$$FstResetRechageEvts",e)}(),function(){var e=game.FestivalItemCtrl.extends({ipc:function(){this.gevts={FestivalEvts:{SERV_UPDATE_DATA:this.updataData}}},updataData:function(){this.getData()&&this.dpt(this.Evts.C2C_RESET_RECHARGE)},init:function(){this.regFestival(game.FestivalSubType.FST_RESET_RECHARGE,game.ME.FstResetRechage)},rechargeBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.RECHARGE)}});b8e.module.registerControl(game.ME.FstResetRechage,e,game.FstResetRechageEvts)}(),function(){var e=game.View.extends({ctor:function(){this._super(433)},init:function(){this.banner=b8e.Sprite.get(),this.banner.addToParent(this.skin.fstRRBg),this.banner.setAnchor(0,1)},onShow:function(){var e=game.festivalData.getBannerNameByType(game.FestivalSubType.FST_RESET_RECHARGE);if(e&&""!=e){var t=game.ResCfg.getImgUrl(e,!0);this.banner.loadTexture(t)}else this.banner.unloadTexture()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.FstResetRechage,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_GET_AWARD:-1,V2C_GET_PRIZE:-1,V2C_TO_GET:-1,C2C_REFRESH_BTNS:-1,C2V_UPDATE_QQ_VIP_LEVEL:-1,V2C_GET_QQ_VIP_LEVEL:-1,V2C_GET_VIP_PRIZE:-1,V2C_GET_XINYUE_PRIZE:-1,V2C_XINYUE_GOTO_URL:-1,V2C_GOTO_EXPLORE:-1,C2C_SET_SUPER_VIP:-1,C2C_SET_BIND_MOBILE:-1,C2V_UPDATE_MSIC_DATA:-1,C2V_UPDATE_SUPER_VIP:-1}),b8e.RC("$$game","$$VerifyAwardEvts",e)}(),function(){var e=b8e.Object.extends({isShortcutSuccess:!1,qqVipLv:0,collectedWanbaFirstPrize:!1,collectedWanbaQzonePrize:!1,collectedWanbaDailyPrize:!1,collectedWanbaPfVipPrize:!1,collectedWanbaGameVipPrize:!1,collectedWanbaQQVipPrize:!0,collectedWanbaXinyuePrize:!1,canShowQQGame:!1,showSVInfo:!1,linkEndTime:0,isAddColorTicket:!1,ctor:function(){this._super(),this.qqVipAward=[],this.wanbaVipList=[],this.wanbaVipMap=b8e.HashMap.get(),this.qqVipDailyAward=[]},setWanModelData:function(e){this.collectedWanbaFirstPrize=e.collectedWanbaFirstPrize,this.collectedWanbaQzonePrize=e.collectedWanbaQzonePrize,this.collectedWanbaDailyPrize=e.collectedWanbaDailyPrize,this.collectedWanbaPfVipPrize=e.collectedWanbaPfVipPrize,this.collectedWanbaGameVipPrize=e.collectedWanbaGameVipPrize,this.collectedWanbaQQVipPrize=e.collectedWanbaQqVipPrize,this.collectedWanbaXinyuePrize=e.collectedWanbaXinyuePrize},addShortcutSuccess:function(){this.isShortcutSuccess=!0},initQQVipList:function(){if(game.IS_WANBA){this.obj||(this.obj={prizeType:0}),this.obj.prizeType=game.WanbaPrizeType.WANBA_GAME_VIP;var e=game.WanbaPrizeCfg.getData(this.obj,!0);if(e&&!(e.length<1))for(var t=e.length,a=0;a<t;a++){var i=e[a],n=new game.WanbaPrizeInfo;n.setData(i),this.wanbaVipMap.set(n.id,n),this.wanbaVipList[a]=n}}},setQQVipAward:function(e){var t=this.getWanbaCfgById(e);if(t){var a=game.WanbaPrizeType;switch(t.prizeType){case a.WANBA_FIRST:this.collectedWanbaFirstPrize=!0;break;case a.WANBA_DAILY:this.collectedWanbaDailyPrize=!0;break;case a.WANBA_QZONE:this.collectedWanbaQzonePrize=!0;break;case a.WANBA_PF_VIP:this.collectedWanbaPfVipPrize=!0;break;case a.WANBA_GAME_VIP:this.collectedWanbaGameVipPrize=!0;break;case a.WANBA_PF_VIP:this.collectedWanbaPfVipPrize=!0;break;case a.WANBA_SCORE:case a.WANBA_FESTIVAL:break;case a.WANBA_QQ_VIP:this.collectedWanbaQQVipPrize=!0;break;case a.WANBA_XINYUE:this.collectedWanbaXinyuePrize=!0}}},setQQvipLv:function(e){if(game.IS_WANBA){var t=this.wanbaVipList;if(t&&!(t.length<1))for(var a=t.length,i=0;i<a;i++){var n=t[i];n.vip==e&&(n.isCanGet=!0,n.isGetAward=this.collectedWanbaGameVipPrize)}}},resetDaily:function(){this.collectedWanbaQQVipPrize=!1,this.collectedWanbaXinyuePrize=!1,this.qqVipReset()},qqVipReset:function(){var e=this.wanbaVipList;if(e&&!(e.length<1))for(var t=e.length,a=0;a<t;a++){e[a].isGetAward=!1}},getWanbaVipList:function(){return this.wanbaVipList},checkQQVipAlert:function(){if(!game.IS_WANBA)return!1;var e=game.LoginConfig.wanBaGameVipLevel,t=(this.qqVipAward,this.wanbaVipList);if(!t||t.length<1)return!1;for(var a=t.length,i=void 0,n=!1,s=0;s<a;s++)(i=t[s]).isCanGet=i.vip==e,i.isGetAward=this.collectedWanbaGameVipPrize,i.isCanGet&&!i.isGetAward&&(n=!0);return n},getWanbaCfgById:function(e){this.obj2||(this.obj2={id:0}),this.obj2.id=e;var t=game.WanbaPrizeCfg.getData(this.obj2);return t||null},getWanbaGiftIsGet:function(e){var t=this.getWanbaCfgById(e);if(!t)return!1;switch(t.prizeType){case wanbaPrizeType.WANBA_FIRST:return this.collectedWanbaFirstPrize;case wanbaPrizeType.WANBA_DAILY:return this.collectedWanbaDailyPrize;case wanbaPrizeType.WANBA_QZONE:return this.collectedWanbaQzonePrize;case wanbaPrizeType.WANBA_PF_VIP:return this.collectedWanbaPfVipPrize;case wanbaPrizeType.WANBA_SCORE:case wanbaPrizeType.WANBA_FESTIVAL:return!0;case wanbaPrizeType.WANBA_QQ_VIP:return this.collectedWanbaQQVipPrize;case wanbaPrizeType.WANBA_XINYUE:return this.collectedWanbaXinyuePrize}},getQQVipDailyAward:function(){if(this.prizeInfo)return this.prizeInfo;this.obj||(this.obj={prizeType:0}),this.obj.prizeType=game.WanbaPrizeType.WANBA_QQ_VIP;var e=game.WanbaPrizeCfg.getData(this.obj,!0);if(e&&!(e.length<1)){var t=game.CfgUtil.getPrizeListInfo(e[0].Award);return this.prizeInfo=t.items,this.prizeInfo}},getQQVipDailyAwardId:function(){var e=this.getWanbaPrizeCfg(game.WanbaPrizeType.WANBA_QQ_VIP);return e?e.id:0},getXinyueAwardId:function(){var e=this.getWanbaPrizeCfg(game.WanbaPrizeType.WANBA_XINYUE);return e?e.id:0},getXinyueCfg:function(){return this.getWanbaPrizeCfg(game.WanbaPrizeType.WANBA_XINYUE)},getWanbaPrizeCfg:function(e){this.obj||(this.obj={prizeType:0}),this.obj.prizeType=e;var t=game.WanbaPrizeCfg.getData(this.obj,!0);return t&&0<t.length?t[0]:null},getHdDRecharge:function(){if(this.hdDRecharge)return this.hdDRecharge;this.hdDRecharge=0;var e=+game.LoginConfig.gameChannelId,t=game.SuperVipCfg.getData(e,!1,!1);return t&&(this.hdDRecharge=t.dailyRecharge),this.hdDRecharge},getHdTRecharge:function(){if(this.hdTRecharge)return this.hdTRecharge;this.hdTRecharge=0;var e=+game.LoginConfig.gameChannelId,t=game.SuperVipCfg.getData(e,!1,!1);return t&&(this.hdTRecharge=t.totalRecharge),this.hdTRecharge},checkSVAlert:function(){var e=game.rechargeData;if(e.isHudieVip)return!0;var t=this.getHdDRecharge(),a=this.getHdTRecharge();return e.isHudieVip=0<t&&e.rechargeMoneyDaily>=t||e.rechargeMoney>=a,e.isHudieVip},initSVActive:function(){if(this.initSuperVip)return this.hasSuperVip;var e=+game.LoginConfig.gameChannelId,t=game.SuperVipCfg.getData(e,!1,!1);return this.initSuperVip=!0,this.hasSuperVip=!!t,this.hasSuperVip},canShowByGCId:function(e){return e=+e,!!game.VerifyCollectionCfg.getData(e,!1,!1)},showQuestLink:function(){if(!this.hasQuestLink())return!1;var e=+game.LoginConfig.gameChannelId,t=game.QuestLinkCfg.getData(e);if(!t)return!1;this.linkEndTime||(this.linkEndTime=b8e.TimeUtil.dateParse(t.endTime,"yyyy-MM-dd hh:mm:ss").getTime()),this.linkStartTime||(this.linkStartTime=b8e.TimeUtil.dateParse(t.startTime,"yyyy-MM-dd hh:mm:ss").getTime());var a=game.SysTime.curTime;return this.linkStartTime<=a&&this.linkEndTime>a},hasQuestLink:function(){if(this._initLink)return this.hasLink;var e=+game.LoginConfig.gameChannelId,t=game.QuestLinkCfg.getData(e,!1,!1);return this._initLink=!0,this.hasLink=!!t,this.hasLink},getLinkCountDown:function(){return this.linkEndTime-game.SysTime.curTime},hasFollowGift:function(){if(this._initFollowGift)return this._hasFollowGift;var e=+game.LoginConfig.gameChannelId,t=game.FollowGiftCfg.getData(e,!1,!1);return this._initFollowGift=!0,this._hasFollowGift=!!t,this._hasFollowGift}});game.verifyAwardData=game.verifyAwardData||new e}(),function(){var e;e=b8e.Enum({VerifyNone:0,VerifyName:1,VerifyVipcn:2,VerifyWeiDuan:3,VerifyCollection:4,VerifyAddShortcut:5,VerifyPhone:6,VerifyColorTicket:7,VerifyHutong:8}),b8e.RC("$$game","$$VerifyAwardType",e)}(),function(){var e;e=b8e.Object.extends({id:0,prizeType:0,vip:0,prizeId:0,isGetAward:!1,isCanGet:!1,ctor:function(){this._super()},setData:function(e){this.id=e.id,this.prizeType=e.prizeType,this.vip=e.vip,this.cfg=e},getPrizeList:function(){if(this.prizeList)return this.prizeList;if(!this.cfg)return null;var e=game.CfgUtil.getPrizeListInfo(this.cfg.Award);return this.prizeInfo=e.items,this.prizeInfo}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$WanbaPrizeInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,WANBA_FIRST:1,WANBA_DAILY:2,WANBA_PF_VIP:3,WANBA_GAME_VIP:4,WANBA_QZONE:5,WANBA_SCORE:6,WANBA_FESTIVAL:7,WANBA_QQ_VIP:8,WANBA_XINYUE:9}),b8e.RC("$$game","$$WanbaPrizeType",e)}(),function(){var e=game.Control.extends({init:function(){var e=this;e.spotAlert1=game.spotAlert.set(game.SAE.VERIFY_NAME_ALERT),e.spotAlert2=game.spotAlert.set(game.SAE.VERIFY_VIPCN_ALERT),e.spotAlert3=game.spotAlert.set(game.SAE.VERIFY_WEIDUAN_ALERT),e.spotAlert4=game.spotAlert.set(game.SAE.VERIFY_COLLECTION_ALERT),e.spotAlert5=game.spotAlert.set(game.SAE.VERIFY_ADD_SHORTCUT_ALERT),e.spotAlert6=game.spotAlert.set(game.SAE.VERIFY_QQ_VIP_DAILY_ALERT,game.SAE.VERIFY_QQ_VIP_PRIVILEGE_ALERT),e.spotAlert7=game.spotAlert.set(game.SAE.QQ_VIP_GIFT),e.spotAlert8=game.spotAlert.set(game.SAE.XINYUE),e.spotAlert9=game.spotAlert.set(game.SAE.SUPER_VIP),e.spotAlert10=game.spotAlert.set(game.SAE.BIND_MOBILE),e.spotAlert11=game.spotAlert.set(game.SAE.VERIFY_COLOR_TICKET_ALERT)},ipc:function(){var e=this;e.evts={MainRole:{C_RESET_DAILY:e.resetDaily,C_INIT_MSIC_DATA:e.initMsicData},Welfare:{C_INIT_MODEL:e.initWelfareModel},Recharge:{C_RECHARGE_SUCCESS:e.rechargeSuccess},MobileBind:{C2C_BIND_SUCCESS:e.VerifyAwardReq}},e.gevts={VerifyAwardGEvts:{UPDATE_WX_ADD_SHORTCUT_BTN_STATE:e.updataVerifyCollection,ADD_SHORTCUT_SUCCESS:e.addShortcutSuccess,FOCUS_SUCCESS:e.focusSuccess,REAL_NAME_SUCCESS:e.realNameSuccess,BIND_MOBILE_SUCCESS:e.bindMobileSuccess,DOWNLOAD_MICRO_CLIENT_SUCCESS:e.downloadMCSuccess,ADD_COLOR_TICKET_SUCCESS:e.addColorTicketSuccess}},e.handels={VerifyAwardResp:e.verifyAwardResp,WanbaPrizeResp:e.wanbaPrizeResp}},VerifyAwardReq:function(e){var t=e.data;t&&this.sender.VerifyAwardReq(t)},triggerOpen:function(e){var t=game.ME;switch(e){case t.VerifyCollection:this.checkAlert4();break;case t.VerifyVipcn:this.checkAlert2();break;case t.VerifyName:this.checkAlert1();break;case t.VerifyWeiduan:game.LoginConfig.canDownloadMicro&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyWeiDuan)&&game.module.show(game.ME.VerifyWeiduan),this.checkAlert3();break;case t.VerifyAddShortcut:this.checkAlert5();break;case t.SuperVip:this.checkAlert9();break;case t.BindMobile:this.checkAlert10();break;case t.VerifyAwardColorTicket:game.IS_QQ_GAME&&b8e.isWeChatGame&&this.checkAlert11()}},verifyAwardResp:function(e){var t=this,a=e.readProtobuf(game.pb.VerifyAwardResponse);if(0<a.code)game.notice.noticeError(a.code);else{game.welfareData.setVerifyAward(a.awardType),t.send(t.Evts.C2V_GET_AWARD),t.dpt(t.Evts.C2C_REFRESH_BTNS);var i=game.VerifyAwardType;switch(a.awardType){case i.VerifyCollection:t.checkAlert4();break;case i.VerifyVipcn:t.checkAlert2();break;case i.VerifyName:t.checkAlert1();break;case i.VerifyWeiduan:t.checkAlert3();break;case i.VerifyAddShortcut:t.checkAlert5();break;case i.VerifyPhone:t.checkAlert10();break;case i.VerifyColorTicket:t.checkAlert11()}}},wanbaPrizeResp:function(e){var t=this,a=e.readProtobuf(game.pb.WanbaPrizeResponse);if(0<a.code){var i=game.ServerCodeCfg.getData(a.code);i&&game.alert.showMsg(i.desc)}else{var n=game.verifyAwardData.getWanbaCfgById(a.id);if(n){game.verifyAwardData.setQQVipAward(a.id);var s=game.WanbaPrizeType;switch(n.prizeType){case s.WANBA_GAME_VIP:t.checkAlert6(),t.send(t.Evts.C2V_GET_AWARD);break;case s.WANBA_QQ_VIP:t.dpt(t.Evts.C2C_REFRESH_BTNS);break;case s.WANBA_XINYUE:t.checkAlert8(),t.send(t.Evts.C2V_UPDATE_BTN),t.dpt(t.Evts.C2C_REFRESH_BTNS);break;default:game.module.show(game.ME.QQVipGiftView)}}else b8e.error("\u73a9\u5427\u798f\u5229\u6ca1\u6709\u914d\u7f6e\uff0cID:"+a.id)}},initWelfareModel:function(){var e=this,t=game.verifyAwardData;t.initQQVipList(),t.checkQQVipAlert(),e.checkAlert2(),e.checkAlert1(),e.checkAlert3(),e.checkAlert4(),e.checkAlert5(),e.checkAlert7(),e.checkAlert8(),e.checkAlert10(),e.checkAlert11(),game.IS_WANBA&&"QQVip"===game.JunHaiSdk.getChannel()&&game.moduleOpen.checkOpen(game.ME.QQVipDailyGift)&&!game.verifyAwardData.collectedWanbaQQVipPrize&&game.module.show(game.ME.QQVipDailyGift);var a=game.LoginConfig.wanbaGiftId;a&&e.sender.WanbaPrizeReq(a)},initMsicData:function(){var e=game.verifyAwardData;e.initSVActive(),e.showSVActive&&(e.showSVInfo=game.settingData.isSuperVip()),game.LoginConfig.isBindMobile=game.settingData.isBindMobile(),this.send(this.Evts.C2V_UPDATE_MSIC_DATA),this.dpt(this.Evts.C2C_REFRESH_BTNS)},rechargeSuccess:function(){game.verifyAwardData.showSVActive&&!game.rechargeData.isHudieVip&&(this.checkAlert9(),this.send(this.Evts.C2V_UPDATE_SUPER_VIP))},notify:function(e,t){var a=this;switch(e){case a.Evts.V2C_GET_PRIZE:a.sender.VerifyAwardReq(t);break;case a.Evts.V2C_TO_GET:a.toGet(t);break;case a.Evts.V2C_GET_QQ_VIP_LEVEL:game.JunHaiSdk.getGameVipLevel(a.updateVipLevel,a);break;case a.Evts.V2C_GET_VIP_PRIZE:a.sender.WanbaPrizeReq(t);break;case a.Evts.V2C_XINYUE_GOTO_URL:game.JunHaiSdk.openXinyueUrl();break;case a.Evts.V2C_GOTO_EXPLORE:game.JunHaiSdk.gotoExploreUrl()}},resetDaily:function(){game.verifyAwardData.resetDaily();this.checkAlert7(),this.checkAlert8(),this.dpt(this.Evts.C2C_REFRESH_BTNS)},updateVipLevel:function(){game.verifyAwardData.checkQQVipAlert(),this.send(this.Evts.C2V_UPDATE_QQ_VIP_LEVEL)},toGet:function(e){var t=game.VerifyAwardType;switch(e){case t.VerifyName:var a=game.VerifyAwardCfg.getData(e);a&&a.isUseFalse?game.module.show(game.ME.FalseRealName):game.sdk.realVerify();break;case t.VerifyVipcn:b8e.isWeChatGame?game.module.show(game.ME.VerifyVipcnWx):game.sdk.focus();break;case t.VerifyWeiDuan:game.sdk.downloadMicroClient();break;case t.VerifyCollection:break;case t.VerifyAddShortcut:game.sdk.addShortcut();break;case t.VerifyInterestTribe:game.sdk.openInterestTribeUrl();break;case t.VerifyPhone:game.sdk.sdkBindPhone();break;case t.VerifyColorTicket:game.sdk.addColorSign()}},updataVerifyCollection:function(){this.send(this.Evts.C2V_UPDATE_BTN),this.dpt(this.Evts.C2C_REFRESH_BTNS)},addShortcutSuccess:function(){game.verifyAwardData.addShortcutSuccess(),this.send(this.Evts.C2V_UPDATE_BTN),this.checkAlert5()},addColorTicketSuccess:function(){this.send(this.Evts.C2V_UPDATE_BTN),this.checkAlert11()},focusSuccess:function(){this.send(this.Evts.C2V_UPDATE_BTN),this.checkAlert2()},getSuperVipInfoBtn:function(){game.rechargeData.isHudieVip?(game.verifyAwardData.showSVInfo=!0,this.checkAlert9(),this.dpt(this.Evts.C2C_SET_SUPER_VIP,1),this.send(this.Evts.C2V_CLICK_SV_BTN)):game.notice.show(7016)},dailyBtn:function(){},realNameSuccess:function(){this.send(this.Evts.C2V_UPDATE_BTN),this.checkAlert1()},bindMobileSuccess:function(){this.dpt(this.Evts.C2C_SET_BIND_MOBILE,1),this.send(this.Evts.C2V_UPDATE_BTN),this.checkAlert10()},downloadMCSuccess:function(){this.send(this.Evts.C2V_UPDATE_BTN),this.checkAlert3()},checkAlert1:function(){this.spotAlert1.alert=game.LoginConfig.hasRealVerify&&game.LoginConfig.realVerifyComplete&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyName)},checkAlert2:function(){this.spotAlert2.alert=game.LoginConfig.canFocus&&game.LoginConfig.isFocus&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyVipcn)},checkAlert3:function(){this.spotAlert3.alert=game.LoginConfig.canDownloadMicro&&game.LoginConfig.isMicroLogin&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyWeiDuan)},checkAlert4:function(){if(game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyCollection))this.spotAlert4.alert=!1;else{var e=!1;if(game.IS_BAIZE&&(e=game.verifyAwardData.canShowByGCId(game.LoginConfig.gameChannelId)),b8e.isWeChatGame){var t=wx.getSystemInfoSync();if(t){var a=wx.getLaunchOptionsSync();if(a){var i=a.scene,n=/iPad|iPhone|iOS|iPod/.test(t.system),s=-1<t.system.indexOf("Android");n&&1104==i?e=!0:s&&(1023!=i&&1104!=i||(e=!0))}}this.spotAlert4.alert=e}else this.spotAlert4.alert=e}},checkAlert5:function(){this.spotAlert5.alert=game.LoginConfig.canAddShortcut&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyAddShortcut)},checkAlert6:function(){this.spotAlert6.alert=game.verifyAwardData.checkQQVipAlert()},checkAlert7:function(){this.spotAlert7.alert=!game.verifyAwardData.collectedWanbaQQVipPrize},checkAlert8:function(){this.spotAlert8.alert=!game.verifyAwardData.collectedWanbaXinyuePrize},checkAlert9:function(){this.spotAlert9.alert=game.verifyAwardData.checkSVAlert()&&!game.verifyAwardData.showSVInfo},checkAlert10:function(){this.spotAlert10.alert=game.LoginConfig.canBindPhone&&game.LoginConfig.isBindMobile&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyPhone)},checkAlert11:function(){this.spotAlert11.alert=game.IS_QQ_GAME&&b8e.isWeChatGame&&!game.welfareData.verifyIsGetByType(game.VerifyAwardType.VerifyColorTicket)}}),t=[game.ME.VerifyCollection,game.ME.VerifyVipcn,game.ME.VerifyName,game.ME.VerifyWeiduan,game.ME.VerifyAddShortcut,game.ME.QQVipDaily,game.ME.QQVipPrivilege,game.ME.VerifyVipcnWx,game.ME.QQVipDiscount,game.ME.VerifyInterestTribe,game.ME.QQVipGiftView,game.ME.FalseRealName,game.ME.QQVipDailyGift,game.ME.XinyueAward,game.ME.MoreExciting,game.ME.BindMobile,game.ME.SuperVip,game.ME.FollowGift,game.ME.FcmOnlineTips,game.ME.VerifyAwardColorTicket],a=game.Sender.extends({ipc:function(){this.msg={VerifyAwardReq:this.verifyAwardReq,WanbaPrizeReq:this.wanbaPrizeReq}},verifyAwardReq:function(e){var t=game.pb.VerifyAwardRequest;t.awardType=e,this.write(t)},wanbaPrizeReq:function(e){var t=game.pb.WanbaPrizeRequest;t.id=e,t.openId=game.JunHaiSdk.getOpenid(),t.openKey=game.JunHaiSdk.getOpenkey(),t.pf=game.JunHaiSdk.getPf(),t.qua=game.JunHaiSdk.getQua(),this.write(t)}});b8e.module.registerControl(game.ME.VerifyAward,e,game.VerifyAwardEvts,a,t)}(),function(){var e;e=game.View.extends({awardType:0,_showModel:!0,space:5,ctor:function(e){var t=0<arguments.length&&void 0!==e?e:"";t=t||1214,this._super(t),this.prizeItemList=[],this.prizePool=[]},notify:function(e){switch(e){case this.Evts.C2V_GET_AWARD:game.module.hide(this.moduleEnum);break;case this.Evts.C2V_UPDATE_BTN:this.updateBtn()}},init:function(){var e=this,t=e.banner=b8e.Sprite.get(),a=e.skin;t.addToParent(e.skin.banner),t.setAnchor(.5,.5);var i,n=game.VerifyAwardCfg.getData(e.awardType);n&&(n.banner?(i=game.ResCfg.getUrl(70,n.banner),t.loadTexture(i)):t.unloadTexture(),e.skin.title.string=n.title,e.updatePrizeList(n.award),n.roleBg?(i=game.ResCfg.getUrl(151,n.roleBg),a.roleBg.loadTexture(i)):a.roleBg.unloadTexture(),a.banner.setPosition(n.bannerX,-n.bannerY));a.cantGetPage.active=!1,a.canGetPage.active=!0,0<n.viewHeight&&(e.height=a.bg.height=n.viewHeight),a.view_getBtn.y=50-e.height,a.view_toGetBtn.y=50-e.height,a.view_toGetBtn_1.y=50-e.height,a.isGetImg.y=10-e.height,a.prizeList.y=168-e.height},updatePrizeList:function(e){if(e&&!(e.length<1)){this.prizeListInfo||(this.prizeListInfo=game.CfgUtil.getPrizeListInfo(e));for(var t=this.prizeListInfo.items,a=t.length,i=0;i<a;i++){var n=t[i],s=game.GridUtil.createPrizeIcon();s.addToParent(this.skin.prizeList),game.GridUtil.setItemIcon(s,n,!1,game.IconLayoutEnum.SHOW_NUM),this.prizePool.push(s)}if(0<(a=this.prizePool.length)){var o=this.space,r=100*a+o*(a-1),g=this.skin.prizeList.width;for(i=0;i<a;i++)this.prizePool[i].x=.5*(g-r)+100*(i+.5)+i*o}}},onShow:function(){this.updateBtn()},updateBtn:function(){},onHide:function(){},view_getBtn:function(){this.send(this.Evts.V2C_GET_PRIZE,this.awardType)},view_toGetBtn:function(){this.send(this.Evts.V2C_TO_GET,this.awardType)},view_toGetBtn_1:function(){this.send(this.Evts.V2C_TO_GET,this.awardType)},view_returnBtn_1:function(){this.returnBtn()},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}}),b8e.RC("$$game","$$VerifyAwardView",e)}(),function(){var e=game.VerifyAwardView.extends({awardType:4,ctor:function(){var e=1228;game.IS_YUNYOU&&(e=1229),this._super(e)},init:function(){if(game.IS_BAIZE){var e=this.skin,t=+game.LoginConfig.gameChannelId,a=game.VerifyCollectionCfg.getData(t);if(!a)return;if(a.contentImg&&""!=a.contentImg){var i=game.ResCfg.getImgUrl(a.contentImg);e.bg1.loadTexture(i)}if(a.bottomLabImg&&""!=a.bottomLabImg){var n=game.ResCfg.getImgUrl(a.bottomLabImg);e.bannerLab.loadTexture(n)}}},updateBtn:function(){if(b8e.isWeChatGame)if(game.LoginConfig.wxScene)this.updateBtnState(game.LoginConfig.wxScene);else{var e=wx.getLaunchOptionsSync();e&&this.updateBtnState(e.scene)}game.IS_BAIZE&&this.updateGetState(!0)},updateBtnState:function(e){var t=!1,a=wx.getSystemInfoSync();if(a){var i=/iPad|iPhone|iOS|iPod/.test(a.system),n=-1<a.system.indexOf("Android");i&&1104==e?t=!0:(n&&1023==e||1104==e)&&(t=!0)}this.updateGetState(t)},updateGetState:function(e){var t=this.skin,a=game.welfareData.verifyIsGetByType(this.awardType);t.isGetImg.active=a,t.view_getBtn.active=!a&&e,t.view_toGetBtn.active=!a&&!e}});b8e.module.registerView(game.ME.VerifyCollection,e)}(),function(){var e=game.VerifyAwardView.extends({awardType:6,ctor:function(){this._super(1093)},init:function(){},updateBtn:function(){this.skin.view_toGetBtn.active=!0}});b8e.module.registerView(game.ME.VerifyInterestTribe,e)}(),function(){var e=game.VerifyAwardView.extends({awardType:2,isFirst:!1,ctor:function(){this._super()},onShow:function(){this.isFirst=!1,this._super()},updateBtn:function(){var e=this,t=e.skin,a=game.welfareData.verifyIsGetByType(e.awardType);if(b8e.isWeChatGame)game.LoginConfig.isFocus||e.isFirst||(e.isFirst=!0,game.sdk.isFocus()),e.skin.view_getBtn.active=!0,e.skin.view_toGetBtn.active=!0,e.skin.cantGetPage.active=!1,e.skin.canGetPage.active=!0;else{var i=game.LoginConfig.isFocus;e.skin.view_getBtn.active=!a&&i,e.skin.view_toGetBtn.active=!a&&!i,e.skin.cantGetPage.active=a,e.skin.canGetPage.active=!a}t.isGetImg.active=a},view_getBtn:function(){!b8e.isWeChatGame||game.LoginConfig.isFocus?this.send(this.Evts.V2C_GET_PRIZE,this.awardType):game.notice.show(9336)}});b8e.module.registerView(game.ME.VerifyVipcn,e)}(),function(){var e=game.VerifyAwardView.extends({awardType:5,space:50,ctor:function(){this._super(1092)},init:function(){var e=game.VerifyAwardCfg.getData(this.awardType);e&&this.updatePrizeList(e.award)},onShow:function(){this._super(),game.IS_QQ_GAME&&b8e.isWeChatGame&&game.verifyAwardGuideMgr.showAnima(120,60)},onHide:function(){game.IS_QQ_GAME&&b8e.isWeChatGame&&game.verifyAwardGuideMgr.hideAnima()},updateBtn:function(){var e=this.skin,t=game.welfareData.verifyIsGetByType(this.awardType),a=void 0;a=game.IS_QQ_GAME&&b8e.isWeChatGame?game.LoginConfig.isDesktopIn:game.verifyAwardData.isShortcutSuccess,e.isGetImg.active=t,e.view_getBtn.active=!t&&a,e.view_toGetBtn.active=t||!a},onStageResize:function(){this._super(),game.IS_QQ_GAME&&b8e.isWeChatGame&&game.verifyAwardGuideMgr.updateAnimaLayout()}});b8e.module.registerView(game.ME.VerifyAddShortcut,e)}(),function(){var e=game.VerifyAwardView.extends({awardType:3,ctor:function(){this._super()},updateBtn:function(){var e=this.skin,t=game.welfareData.verifyIsGetByType(this.awardType),a=game.LoginConfig.isMicroLogin;e.isGetImg.active=t,e.view_getBtn.active=a,e.view_toGetBtn.active=!a,e.toGetBtnLab.string=t?game.Lang.get(9337):game.Lang.get(9338)}});b8e.module.registerView(game.ME.VerifyWeiduan,e)}(),function(){var e=game.View.extends({awardType:5,space:50,ctor:function(){this._super(1090),this.toggles={dailyBtnSelect:game.ME.QQVipDaily},this.spotAlerts={VERIFY_QQ_VIP_DAILY_ALERT:this.spotAlert}},notify:function(e,t){switch(e){case this.Evts.V_SWITCH_PAGE:this.toggleSelect(t)}},spotAlert:function(e){this.skin.red_spot_1.node.active=e.alert},onShow:function(){this.send(this.Evts.V2C_GET_QQ_VIP_LEVEL),this.toggleSelect(0)}});b8e.module.registerView(game.ME.QQVipPrivilege,e)}(),function(){var e=game.View.extends({awardType:5,space:50,ctor:function(){this._super(1088)}});b8e.module.registerView(game.ME.QQVipDiscount,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(1087),this.setSize(90,110)},setData:function(){if(!this._itemGrid){this._itemGrid=game.GridUtil.createEquipIcon(),this._itemGrid.addToParent(this.skin.icon)}game.GridUtil.setItemIcon(this._itemGrid,this.data)}}),b8e.RC("$$game","$$QQVipDiscountItem",e)}(),function(){var e=game.View.extends({awardType:5,space:50,ctor:function(){this._super(1086)},init:function(){var e=this.list=new game.List;e.itemRender=game.QQVipDailyItem,e.bindEnum=game.ME.VerifyAward,e.addToParent(this.skin.list),e.layout.paddingLeft=15},notify:function(e){switch(e){case this.Evts.C2V_GET_AWARD:this.updateList();break;case this.Evts.C2V_UPDATE_QQ_VIP_LEVEL:this.updateVipLevel()}},onShow:function(){this.updateList(),this.updateVipLevel()},updateVipLevel:function(){var e=game.LoginConfig.wanBaGameVipLevel;this.skin.vipLab.string=game.Lang.get(5701,e)},updateList:function(){var e=game.verifyAwardData.getWanbaVipList();this.list.setData(e)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.QQVipDaily,e)}(),function(){var e;e=game.ListItem.extends({_itemGrid:null,ctor:function(){this._super(1085),this.setSize(548,135)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.ShowItemListItem,t.addToParent(e.skin.prizeList),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingY=10},setData:function(){var e=this.skin,t=this.data,a=(this.data.cfg,t.getPrizeList());this.prizeList.setData(a),e.cantGet.active=!t.isCanGet,e.getBtn.active=t.isCanGet&&!t.isGetAward,e.getImg.active=t.isCanGet&&t.isGetAward,e.vipLab.string="VIP"+t.vip},getBtn:function(){this.data&&this.send(game.VerifyAwardEvts.V2C_GET_VIP_PRIZE,this.data.cfg.id)}}),b8e.RC("$$game","$$QQVipDailyItem",e)}(),function(){var e=game.VerifyAwardView.extends({awardType:0,_showModel:!0,space:10,ctor:function(){this._super(1089),this.prizeItemList=[],this.prizePool=[]},init:function(){var e=this.banner=b8e.Sprite.get();e.addToParent(this.skin.banner),e.setAnchor(.5,.5);var t=game.LoginConfig.wanbaGiftId,a=game.verifyAwardData.getWanbaCfgById(t);if(a){if(a.banner){var i=game.ResCfg.getUrl(70,a.banner);e.loadTexture(i)}this.skin.title.string=a.title,this.updatePrizeList(a.Award)}},onShow:function(){},onHide:function(){},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.QQVipGiftView,e)}(),function(){var e=game.VerifyAwardView.extends({awardType:1,ctor:function(){this._super()},updateBtn:function(){var e=game.welfareData.verifyIsGetByType(this.awardType),t=game.LoginConfig.realVerifyComplete;this.skin.isGetImg.active=e,this.skin.view_getBtn.active=!e&&t,this.skin.view_toGetBtn.active=!e&&!t}});b8e.module.registerView(game.ME.VerifyName,e)}(),function(){var e=game.View.extends({awardType:2,ctor:function(){this._super(1094)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.VerifyVipcnWx,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1080)},init:function(){this.nameDefault=this.skin.nameEditBox.string,this.documentDefault=this.skin.documentEditBox.string},onShow:function(){this.skin.nameEditBox.string=this.nameDefault,this.skin.documentEditBox.string=this.documentDefault},onHide:function(){},viewSureBtn:function(){var e=this.skin,t=e.nameEditBox.string;if(this.checkNameLen(t)&&this.isOnlyChinese(t)){var a=e.documentEditBox.string;this.checkIdcard(a)&&this.send(this.Evts.V2C_GET_PRIZE,game.VerifyAwardType.VerifyName)}},isOnlyChinese:function(e){return!!b8e.StringUtil.isChinese(e)||(game.notice.show(9333),!1)},checkNameLen:function(e){return!(e.length<2)||(game.notice.show(9334),!1)},checkIdcard:function(e){return!1!==/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e)||(game.notice.show(9335),!1)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.FalseRealName,e)}(),function(){var e;e=b8e.Enum({None:0,UPDATE_JUYIVIEW:-1,QUICK_JUYI:-1,GET_DANGKOU:-1,GET_JUYI:-1}),b8e.RC("$$game","$$DailyJuyiEvts",e)}(),function(){var e=game.Control.extends({dangkouCost:"dangkouCost",init:function(){this.dangkouAlert=game.spotAlert.set(game.SAE.DANGKOU_ALERT,game.SAE.DAILY_ALERT)},ipc:function(){var e=this;e.evts={DailyFuLi:{C_INIT_MODULE:e.setupDailyData},MainRole:{C_RESET_DAILY:e.resetDaily}},e.handels={QuickTeamNumResp:e.onQuickTeamNumResp,TeamAwardNumMsg:e.onTeamAwardNotify,TeamAwardResp:e.onTeamAwardResp,DangkouAwardResp:e.dangkouAwardResp,QuickDangkouResp:e.quickDangKouResp,DangkouMsg:e.dangkouMsg}},notify:function(e,t){switch(e){case this.Evts.QUICK_JUYI:this.onQuickJuyi();break;case this.Evts.GET_DANGKOU:this.getPrizeBtn(t);break;case this.Evts.GET_JUYI:this.getJuyiBtn()}},resetDaily:function(){game.dailyJuyiData.setupDailyData(),game.dailyJuyiData.updataNum(),this.checkAlert()},setupDailyData:function(e){if(e&&e.data)game.dailyJuyiData.setupDailyData(e.data),this.checkAlert();else;},onQuickTeamNumResp:function(e){var t=e.readProtobuf(game.pb.QuickTeamNumResponse);0<t.code?game.notice.show(game.ServerCodeCfg.get(t.code)):(this.teamAwardChange(),this.send(this.Evts.UPDATE_JUYIVIEW))},onTeamAwardNotify:function(e){var t=e.readProtobuf(game.pb.TeamAwardNumNotify);if(0<t.code){game.notice.show(game.ServerCodeCfg.get(t.code))}else game.dailyJuyiData.jyCount=t.teamWins,game.dailyJuyiData.updataNum(),this.checkAlert(),this.send(this.Evts.UPDATE_JUYIVIEW)},onTeamAwardResp:function(e){var t=e.readProtobuf(game.pb.TeamAwardResponse);if(0<t.code){game.notice.show(game.ServerCodeCfg.get(t.code))}else game.dailyJuyiData.jyAward=!0,game.dailyJuyiData.updataNum(),this.checkAlert(),this.send(this.Evts.UPDATE_JUYIVIEW)},onQuickJuyi:function(){var e=game.DailyDangkouCfg.getTopGradeCfg(),t=game.DailyMiscCfg.getData(this.dangkouCost),a=(e.count-game.dailyJuyiData.dkCount)*(0|t.value),i=(game.DailyMiscCfg.getData("teamAwardNeedNum").value,game.mainRoleData.vipLevel),n=game.VipCfg.getData(i);if(n&&n.questComplete){if(!game.UpgradeUtil.checkEquipTooMuch()){var s=game.dailyJuyiData.getQuickTeamCost();(s+=a)<=game.amount.get(game.AmountType.YUAN_BAO)?game.alert.show({lang:1357,langArgs:s,okcb:this.onClickTeamAlert,thisArg:this}):game.notice.show(game.Lang.get(115,s))}}else game.notice.show(1356)},dangkouAwardResp:function(e){var t=e.readProtobuf(game.pb.DangkouAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.dailyJuyiData.dkAward.push(t.id),game.dailyJuyiData.updataNum(),this.checkAlert(),this.send(this.Evts.UPDATE_JUYIVIEW)},quickDangKouResp:function(e){var t=e.readProtobuf(game.pb.QuickDangkouResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.dangkouAwardChange(),this.checkAlert(),this.send(this.Evts.UPDATE_JUYIVIEW)},dangkouMsg:function(e){var t=e.readProtobuf(game.pb.DangkouNotify);game.dailyJuyiData.dkCount=t.dangkouCount,game.dailyJuyiData.updataNum(),this.checkAlert(),this.send(this.Evts.UPDATE_JUYIVIEW)},teamAwardChange:function(){game.dailyJuyiData.jyCount=game.dailyJuyiData.jyAwardNeedNum,game.dailyJuyiData.updataNum(),game.dailyJuyiData.jyAward||this.sender.TeamAwardReq()},dangkouAwardChange:function(){if(game.dailyJuyiData.dkCount=300,game.dailyJuyiData.updataNum(),game.dailyJuyiData.dkAward.length<3)for(var e=game.dailyJuyiData.getListByLv(game.mainRoleData.lv),t=0;t<e.length;t++){var a=e[t].id;a&&-1==game.dailyJuyiData.dkAward.indexOf(a)&&this.getPrizeBtn(a)}},onClickTeamAlert:function(){var e=0|game.DailyMiscCfg.getData("teamAwardNeedNum").value;game.dailyJuyiData.jyCount<e?this.sender.QuickTeamNumReq():this.teamAwardChange();var t=game.DailyDangkouCfg.getTopGradeCfg();game.dailyJuyiData.dkCount<t.count?this.sender.QuickDangkouReq():this.dangkouAwardChange()},getJuyiBtn:function(){this.sender.TeamAwardReq()},getPrizeBtn:function(e){var t=game.DailyDangkouCfg.getDataById(e);if(t&&!(t.count>game.dailyJuyiData.dkCount))if(game.UpgradeUtil.checkEquipTooMuch());else this.sender.DangkouAwardReq(e)},checkAlert:function(){var e=game.dailyJuyiData.getCanGetAward();this.dangkouAlert.alert=e}}),t=game.Sender.extends({ipc:function(){this.msg={QuickTeamNumReq:null,TeamAwardReq:null,DangkouAwardReq:this.dangkouAwardReq,QuickDangkouReq:null}},dangkouAwardReq:function(e){var t=game.pb.DangkouAwardRequest;t.id=e,b8e.net.getBytes().writeProtobuf(t)}});b8e.module.registerControl(game.ME.DailyJuyi,e,game.DailyJuyiEvts,t)}(),function(){var e,t=e=b8e.Object.extends({index:0,id:0,award:null,curCount:0,teamWins:0,isCanget:!1,isGet:!1,isDouble:!1,ctor:function(){this._super()},setData:function(e){e&&(e.id&&(this.id=e.id),e.giveItems?this.award=e.giveItems:e.items&&(this.award=e.items))},setCanGet:function(e){this.isCanget=e},setGet:function(e){this.isGet=e,this.isCanget=!e},setDouble:function(e){this.isDouble=e},resetState:function(){this.isGet=!1,this.isCanget=!1}});b8e.BindingUtil.bind(e),t.poolCall=!0,b8e.RC("$$game","$$DailyJuyiInfo",e)}(),function(){var e=b8e.Object.extends({dkCount:0,dkAward:null,jyCount:0,jyAward:null,jyAwardNeedNum:0,jyAwardCost:0,ctor:function(){this._super(),this.achieve=b8e.HashMap.get()},initPacification:function(e){var t=this;if(!t.achieve.get(e)){for(var a,i=[],n=0,s=1;s<=3;s++){var o=game.DailyDangkouAwardCfg.getCfgData(e,s),r=game.DailyDangkouCfg.getDataById(s).count;a=new game.DailyJuyiInfo,o.giveItems.push({Id:220001,Num:o.exp}),a.setData(o),t.dkCount>=r?(a.curCount=r,t.dkAward&&(-1==t.dkAward.indexOf(s)?a.setCanGet(!0):a.setGet(!0))):a.curCount=t.dkCount,a.index=n,i.push(a),t.achieve.set(e,i),n++}var g=game.DailyTeamAwardCfg.getItemsBylevel(e);a=new game.DailyJuyiInfo;for(var l={items:[]},c=0;c<g.length;c++)l.items.push(g[c]);a.setData(l),a.teamWins=t.jyCount,t.jyAward?a.setGet(!0):t.jyCount>=t.jyAwardNeedNum&&a.setCanGet(!0),a.index=n,i.push(a),t.achieve.set(e,i)}},setupDailyData:function(e){this.dkCount=e?e.dangkouCount:0,this.dkAward=e?e.dangkouIds:[],this.jyCount=e?e.teamWins:0,this.jyAward=!!e&&e.teamAward,this.jyAwardNeedNum=0|game.DailyMiscCfg.getData("teamAwardNeedNum").value,this.jyAwardCost=0|game.DailyMiscCfg.getData("teamAwardCost").value,this.initPacification(game.mainRoleData.lv)},getListByLv:function(e){var t=this.achieve.get(e);return t||(this.initPacification(e),t=this.achieve.get(e)),t.sort(this.listSort),t},listSort:function(e,t){return e.isGet&&!t.isGet?1:!e.isGet&&t.isGet?-1:e.isCanGet&&!t.isCanGet?-1:!e.isCanGet&&t.isCanGet?1:e.index-t.index},updataDouble:function(e){for(var t=this.getListByLv(game.mainRoleData.lv),a=0;a<t.length;a++){var i=t[a];i.id||i.setDouble(e)}},updataNum:function(){for(var e=this,t=e.getListByLv(game.mainRoleData.lv),a=0;a<t.length;a++){var i=t[a];if(i.id){var n=game.DailyDangkouCfg.getDataById(i.id).count;e.dkCount>=n?(i.curCount=n,e.dkAward&&(-1==e.dkAward.indexOf(i.id)?i.setCanGet(!0):i.setGet(!0))):(i.curCount=e.dkCount,!e.dkAward||e.dkAward.indexOf(i.id)<0?i.resetState():i.setCanGet(!1))}else i.teamWins=e.jyCount,e.jyCount>=e.jyAwardNeedNum?e.jyAward?i.setGet(!0):i.setCanGet(!0):e.jyAward?i.setCanGet(!1):i.resetState()}},getQuickTeamCost:function(){var e=0,t=this.jyAwardNeedNum-this.jyCount;if(0<=t){e=t*this.jyAwardCost}return e},getCanGetAward:function(){for(var e=this.getListByLv(game.mainRoleData.lv),t=0,a=0;a<e.length;a++){e[a].isCanget&&t++}return t},getGetAward:function(){for(var e=this.getListByLv(game.mainRoleData.lv),t=0,a=0;a<e.length;a++){e[a].isGet&&t++}return t}});game.dailyJuyiData=game.dailyJuyiData||new e}(),function(){var e;e=game.ListItem.extends({_gridList:null,_infoList:null,ctor:function(){this._super(635),this.setSize(600,147)},init:function(){this.awardList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.awardList.itemRender=game.PrizeListItem,this.awardList.layout.paddingLeft=0,this.awardList.layout.paddingRight=0,this.awardList.layout.paddingTop=0,this.awardList.layout.spacingX=0,this.awardList.addToParent(this.skin.prizeList),this.taofaData=game.dailyJuyiData},clearData:function(){if(this.awardList){this.awardList.clear()}},setData:function(e){var t=this.skin;if(e.id){var a=game.DailyDangkouCfg.getDataById(e.id).count;t.titleLab.string=game.Lang.get(6541,a,e.curCount,a)}else t.titleLab.string=game.Lang.get(6542,this.taofaData.jyAwardNeedNum,this.taofaData.jyCount,this.taofaData.jyAwardNeedNum);if(t.get.active=!e.isGet,t.isGet.active=e.isGet,t.red_spot.active=e.isCanget&&!e.isGet,t.double.active=e.isDouble&&!e.isGet,!e.isGet){var i="";i=e.isCanget?game.Lang.get(9057):e.id?game.Lang.get(9211):game.Lang.get(9212),t.label_1.node.string=i}var n=e.award,s=game.CfgUtil.getPrizeListInfo(n,null,84);s&&this.awardList.setData(s.items)},get:function(){var e=this.data.id;e?this.data.isCanget&&this.send(game.DailyJuyiEvts.GET_DANGKOU,e):this.data.isCanget?this.send(game.DailyJuyiEvts.GET_JUYI):game.module.show(game.ME.ActivitiesHall)}}),b8e.RC("$$game","$$DailyJuyiItem",e)}(),function(){var e=game.View.extends({taofaMaxNum:0,teamAwardNeedNum:0,barWidth:560,ctor:function(){this._super(636),this.spotAlerts={CS_TEAM_DOUBLE_ALERT:this.csTeamDoubleAlert}},csTeamDoubleAlert:function(e){game.dailyJuyiData.updataDouble(e.alert),this.updateView()},notify:function(e){switch(e){case this.Evts.UPDATE_JUYIVIEW:this.updateView()}},init:function(){this.skin;this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.DailyJuyiItem,this.list.addToParent(this.skin.scrollGrid),this.list.bindEnum=game.ME.DailyJuyi,this.list.layout.spacingY=5},onShow:function(){this.updateView()},onHide:function(){if(this.timer){this.timer.stop()}},updateView:function(){var e=game.dailyJuyiData.getListByLv(game.mainRoleData.lv);this.list.setData(e),this.updataQuick()},viewonekeyBtn:function(){this.send(this.Evts.QUICK_JUYI)},updataQuick:function(){var e=this.skin;4==game.dailyJuyiData.getGetAward()&&(e.delayBtn.active=!0,e.viewonekeyBtn.active=!1)},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.DailyJuyi,e)}(),function(){var e;e=b8e.Enum({NONE:-1,LIST_CHANGE_SELECT:-1,V_PAGE_CHANGE:-1,V_PROGRESS_UPDATE:-1,C_SELECT_LAYER:-1,V_UPDATEDATA:-1,C_VIEW_OPENED:-1,C2C_COMPLETE:-1}),b8e.RC("$$game","$$FestivalBossEvts",e)}(),function(){var e=game.FestivalItemCtrl.extends({init:function(){this._super(),this.regFestival(game.FestivalSubType.FST_BOSS,game.ME.FestivalBoss,game.SAE.FESTIVAL_BOSS,this.redPoint)},ipc:function(){this.gevts={FestivalEvts:{SERV_UPDATE_DATA:this.updateData}},this.handels={FestivalBossResp:this.FBOSSResp,FestivalBossLogResp:this.bossLogs}},notify:function(e,t){switch(e){case this.Evts.C_SELECT_LAYER:this.selectLayer(t);break;case this.Evts.C_VIEW_OPENED:game.festivalBossData.firstOpened||(game.festivalBossData.firstOpened=!0,this.isAlert()),this.autoSelectPage()}},redPoint:function(e){this.spotAlert=e},isAlert:function(){if(this.spotAlert){var e=game.festivalBossData.canChall();this.spotAlert.alert=e&&!game.festivalBossData.firstOpened}},FBOSSResp:function(e){var t=e.readProtobuf(game.pb.FestivalBossResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.festivalBossData.updateLayer(t.layer),game.festivalBossData.setLayerPass(t.layer);var a={type:game.InstanceType.FESTIVALBOSS,rewards:t.userItem};game.festivalBossData.canChall()||this.dpt(this.Evts.C2C_COMPLETE),game.playBack.play(t.battleLog,a),this.send(this.Evts.V_UPDATEDATA)}},bossLogs:function(e){var t=e.readProtobuf(game.pb.FestivalBossLogsResponse);0<t.code?game.notice.noticeError(t.code):(game.festivalBossData.synRank(t.id,t.layer,t.roleData),this.send(this.Evts.V_UPDATEDATA))},selectLayer:function(e){e!=game.festivalBossData.selectInfo.layer&&(7<e&&this.sender.FestivalBossLogReq(game.festivalBossData.bossId,e),game.festivalBossData.setSelectInfo(e),this.send(this.Evts.V_UPDATEDATA))},updateData:function(){var e=this.getData();if(e){var t=e.datas,a=this.getModelData("boss"),i=game.festivalBossData;i.synData(e),i.synModelData(a),i.initData(t),i.firstOpened=!1,this.isAlert(),i.canChall()||this.dpt(this.Evts.C2C_COMPLETE)}},leftBtn:function(){game.festivalBossData.setPage(1),this.send(this.Evts.V_PAGE_CHANGE,1),this.send(this.Evts.V_PROGRESS_UPDATE)},rightBtn:function(){game.festivalBossData.setPage(2),this.send(this.Evts.V_PAGE_CHANGE,2),this.send(this.Evts.V_PROGRESS_UPDATE)},challBtn:function(){var e=game.festivalBossData.getSelectInfo().layer,t=game.festivalBossData.curLayer;if(t+1<e)game.notice.show(4410,e-1);else if(e==t+1){if(game.UpgradeUtil.checkEquipTooMuch())return;this.sender.FestivalBossReq(game.festivalBossData.bossId)}else game.notice.show(9120)},showRankBtn:function(){game.module.show(game.ME.FestivalBossRank)},autoSelectPage:function(){var e=game.festivalBossData.curLayer;e<10?game.festivalBossData.setSelectInfo(e+1):game.festivalBossData.setSelectInfo(e),e<5?(game.festivalBossData.setPage(1),this.send(this.Evts.V_PAGE_CHANGE,1)):(game.festivalBossData.setPage(2),this.send(this.Evts.V_PAGE_CHANGE,2));var t=game.festivalBossData.getSelectInfo();if(t){var a=t.layer;7<a&&this.sender.FestivalBossLogReq(game.festivalBossData.bossId,a)}this.send(this.Evts.V_UPDATEDATA)}}),t=game.Sender.extends({ipc:function(){this.msg={FestivalBossReq:this.FBossChallReq,FestivalBossLogReq:this.FBossLogReq}},FBossLogReq:function(e,t){var a=game.pb.FestivalBossLogsRequest;a.id=e,a.layer=t,this.write(a)},FBossChallReq:function(e){var t=game.pb.FestivalBossRequest;t.id=e,this.write(t)}}),a=[game.ME.FestivalBossRank];b8e.module.registerControl(game.ME.FestivalBoss,e,game.FestivalBossEvts,t,a)}(),function(){var e;e=b8e.Object.extends({name:"",rank:0,power:0,setData:function(e,t){this.name=e.roleName,this.rank=t,this.power=e.power},clear:function(){this.name="",this.rank=0,this.power=0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$FBossItemInfo",e)}(),function(){var e;e=b8e.Object.extends({layer:0,isPass:!1,select:!1,setData:function(e){this.cfg=e,this.layer=e.layer}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$FestivalBossInfo",e)}(),function(){var e=b8e.Object.extends({startTime:0,endTime:0,bossId:1,curLayer:0,instInfoArr:null,instInfoMap:null,rankMap:null,firstOpened:!1,modelData:null,ctor:function(){this.instInfoArr=[],this.instInfoMap=b8e.HashMap.get(),this.rankMap=b8e.HashMap.get()},synData:function(e){this.modelData=e.clientModel,e.clientExt&&(this.endTime=e.endTime,this.curPage=1,this.myRank=new game.FBossItemInfo)},synModelData:function(e){!e||e.length<1||(this.bossId=e[0].id,this.curLayer=e[0].layer)},initData:function(e){var t=this,a=e[0].bossExt;if(a){t.bossId=a.bossId,t.obj||(t.obj={id:0}),t.obj.id=t.bossId;var i=game.FestivalBossCfg.getData(t.obj,!0);if(i){t.rankMap=t.rankMap||b8e.HashMap.get(),t.rankMap.clear();for(var n=null,s=null,o=0,r=t.instInfoArr.length=0;r<i.length;r++)s=i[r],(n=new game.FestivalBossInfo).setData(s),t.curLayer>=n.layer&&(n.isPass=!0),o=t.instInfoArr.length,t.instInfoArr[o]=n,t.instInfoMap.set(n.layer,n),t.rankMap.set(n.layer,[]);var g=t.instInfoArr[0].layer;t.setSelectInfo(g)}}},getListData:function(){return this.instInfoArr},setSelectInfo:function(e){this.selectInfo&&(this.selectInfo.select=!1);var t=this.instInfoMap.get(e);t&&(this.selectInfo=t,this.selectInfo.select=!0)},getSelectInfo:function(){return this.selectInfo},canChall:function(){return this.curLayer<10},getCurLayer:function(){return this.curLayer},getCurLayerRankArr:function(){var e=1;return this.selectInfo&&(e=this.selectInfo.layer),this.getRankArrByLayer(e)},getRankArrByLayer:function(e){return this.rankMap.get(e)},setPage:function(e){2<e||e<1||(this.curPage=e)},updateLayer:function(e){this.curLayer=e},setLayerPass:function(e){var t=this.instInfoMap.get(e);t&&(t.isPass=!0)},synRank:function(e,t,a){e!=this.bossId&&b8e.warn("\u6d3b\u52a8id\u4e0d\u76f8\u540c thisId: ",this.bossId,"rankId: ",e);var i=null;this.myRank.clear();for(var n=a.length,s=0;s<20;s++)s<n?(i=a[s],this.addRank(t,i,s),i.roleId==game.mainRoleData.id&&this.myRank.setData(i,s+1)):this.addRank(t,null,s)},addRank:function(e,t,a){var i=this.rankMap.get(e),n=a+1,s=i[a];s=s||(i[a]=new game.FBossItemInfo),t?s.setData(t,n):(s.rank=n,s.name=game.Lang.get(9106),this.power=0)},getEndTime:function(){return this.endTime},getModel:function(){return this.modelData}});game.festivalBossData=game.festivalBossData||new e}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(366),this.setSize(540,94)},init:function(){},setData:function(){var e=this.skin,t=this.data;e.first_root.active=1==t.rank,e.second_root.active=2==t.rank,e.third_root.active=3==t.rank,e.other_root.active=3<t.rank,e.rank_lab.string=t.rank,e.rank_lab.string=t.rank,e.nameLab.string=t.name,e.powerLab.string=game.CCommonUtil.replaceNum(t.power)}}),b8e.RC("$$game","$$FBoosRankItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(367),this.setSize(100,245)},init:function(){},setData:function(){var e=this,t=this.skin,a=e.data;t.select.active=a.select;var i=a.cfg.itemIconId,n=game.ItemInfoCfg.getData(i);t.yitongguan_1.node.active=a.isPass,e.icon||(e.icon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),e.icon.addToParent(t.iconNode)),e.icon.setItemInfo(n),e.icon.setNum(0),t.itemNameLab.string=game.HtmlUtil.getColorStrByQuality(n.quality,n.name),e.layer||(e.layer=b8e.Sprite.get(),e.layer.setAnchor(.5,.5),e.layer.addToParent(t.lvNode));var s=game.ResCfg.getUrl(107,a.layer);e.layer.loadTexture(s)},selectBtn:function(){var e=this.data.layer;this.send(game.FestivalBossEvts.C_SELECT_LAYER,e)}}),b8e.RC("$$game","$$FestivalBossItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(368)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.FBoosRankItem,e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.spacingY=5,e.bindEnum=game.ME.FestivalBoss,e.addToParent(this.skin.list)},notify:function(e){switch(e){case game.FestivalBossEvts.V_UPDATEDATA:this.updateData()}},onShow:function(){this.list.scrollToTop(),this.updateData()},onHide:function(){},updateData:function(){var e=this.skin,t=game.festivalBossData.selectInfo.layer,a=game.festivalBossData.myRank.rank;e.myRankLab.string=0<a?game.Lang.get(608,a):game.Lang.get(9069);var i=game.CCommonUtil.numConvertToChineseNum(t);e.tipsTitleLab.string=game.Lang.get(2263,i),this.updateList()},updateList:function(){var e=game.festivalBossData.getCurLayerRankArr();this.list.setData(e)}});b8e.module.registerView(game.ME.FestivalBossRank,e)}(),function(){var e=game.View.extends({PB_WIDTH_MAX:534,ctor:function(){this._super(369)},init:function(){var e=this,t=e.bg=b8e.Sprite.get();t.setAnchor(.5,.5),t.addToParent(e.skin.model_bg1);var a=e.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.FestivalBossItem,a.layout.paddingLeft=0,a.layout.paddingRight=0,a.layout.paddingTop=0,a.layout.spacingX=15,a.bindEnum=e.moduleEnum,a.addToParent(e.skin.list),a.touchMovable=!1;var i=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);i.itemRender=game.PrizeListItem,i.layout.paddingLeft=0,i.layout.paddingRight=0,i.layout.paddingTop=0,i.layout.spacingX=25,i.layout.spacingY=0,i.addToParent(e.skin.awardList),i.touchMovable=!1,e.bossModel=new game.SurfaceModel,e.bossModel.addToParent(e.skin.modelNode)},notify:function(e,t){switch(e){case this.Evts.V_UPDATEDATA:this.updateData();break;case this.Evts.V_PAGE_CHANGE:this.changePage(t);break;case this.Evts.V_PROGRESS_UPDATE:this.updateProgressBar()}},onShow:function(){this.send(this.Evts.C_VIEW_OPENED),this.updateData()},updateData:function(){var e=this,t=e.skin,a=game.festivalBossData.getListData();e.list.setData(a);var i=game.festivalBossData.getSelectInfo(),n=i.cfg,s=i.layer;t.instLab.string=game.Lang.get(2261,game.CCommonUtil.numConvertToChineseNum(s));var o=7<s;(t.rankBgSp.active=o)&&(e.onShowRank(s),e.send(game.FestivalBossEvts.C_SELECT_LAYER,s)),e.endTime=game.festivalBossData.getEndTime();var r=n.tips;t.dialogLab.string=r;var g=n.itemId,l=game.ItemInfoCfg.getData(g),c=null;c||(c=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105)).addToParent(t.dialogPrize),c.setItemInfo(l),c.setNum(0),e.timer?(e.timer.reset(),e.timer.start()):e.timer=b8e.Timer.add(e,e.updateTime,1e3);var h=i.isPass;t.killed.node.active=h;var m=game.CfgUtil.getPrizeListInfo(n.award);m&&e.prizeList.setData(m.items),t.challBtn.node.active=!1,t.passLab.node.active=!1;var u=game.festivalBossData.getSelectInfo().layer,d=game.festivalBossData.curLayer;d+1<u?(t.passLab.node.active=!0,t.challBtn.active=!1,t.passLab.string=game.Lang.get(4410,u-1)):u==d+1?(t.challBtn.active=!0,t.passLab.node.active=!1):(t.challBtn.active=!1,t.passLab.node.active=!0,t.passLab.string=game.Lang.get(9121)),e.updateModel(),e.updateProgressBar();var f=game.festivalData.getCExtByType(game.FestivalSubType.FST_BOSS,"banner"),p=game.ResCfg.getImgUrl(f,!0);e.bg.loadTexture(p)},updateTime:function(){var e=this.skin,t=game.festivalBossData.endTime-game.SysTime.curTime,a=game.TimeUtil.formatTimeSpace(t,3);e.timeLab.string=game.Lang.get(2262,a)},onShowRank:function(e){this.skin;for(var t=game.festivalBossData.getRankArrByLayer(e),a=null,i=1;i<4;i++)a=t[i-1],this.getComponent("nameLab"+i).string=a?a.name:game.Lang.get(9106)},changePage:function(e){switch(e){case 1:this.scrollLeft();break;case 2:this.scrollRight();break;default:b8e.warn("changePage\uff0c\u4e0d\u5b58\u5728\u7684\u64cd\u4f5c")}},updateProgressBar:function(){var e,t=this.skin,a=game.festivalBossData.curPage,i=game.festivalBossData.getCurLayer(),n=0;n=a<=1?5<i?5:i:5<i?i-5:0;var s=(e=(n=this.caculateProgress(n))/5)*this.PB_WIDTH_MAX;t.pb1.node.width=s,b8e.Tween.kill(this),b8e.Tween.get(t.pb1.node).to({width:e*this.PB_WIDTH_MAX},150)},caculateProgress:function(e){return e<5&&.5<e?e-.5:e},updateModel:function(){var e=game.festivalBossData.getModel();this.bossModel.showJSONSurface(e)},scrollLeft:function(){this.list.scrollContainerLeft()},scrollRight:function(){this.list.scrollContainerRight()},setViewData:function(){this.loadTexture(url,null,null,{useManiFest:!1})},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.FestivalBoss,e)}(),function(){var e;e=b8e.Enum({None:0,UPDATE_RANK_ACTIVITY_INFO:1,UPDATE_RANK_INFO:2,UPDATE_RECHARGE_NUM:3,GET_RANK_INFO:4}),b8e.RC("$$game","$$RechargeRankEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.activityRankList=[],this.rankList=[],this.endTime=0,this.rechargeNum=0,this.myRank=null},initActivityList:function(e){if(e){var t,a,i=e.datas.length;for(t=this.activityRankList.length=0;t<i;t++)(a=new game.RechargeRankInfo).setData(e.datas[t]),this.activityRankList.push(a);this.activityRankList.sort(this.onActivitySort),this.endTime=e.endTime,this.setTopThreeInfo()}},initRankList:function(e){if(e){var t,a,i=e.list.length;for(this.rankList.length=0,this.myRank||(this.myRank=new game.RankItemInfo),this.myRank.setData(e.userRank),t=0;t<i;t++)(a=new game.RankItemInfo).setData(e.list[t]),a.rankType=game.FestivalSubType.FST_RANK_RECHARGE,this.rankList.push(a);this.rankList.sort(this.onRankSort),this.setTopThreeInfo()}},onRankSort:function(e,t){return e.rank-t.rank},onActivitySort:function(e,t){return e.startRank-t.startRank},setTopThreeInfo:function(){var e,t=3<this.activityRankList.length?3:this.activityRankList.length,a=0;for(a=0;a<t;a++)a<this.rankList.length&&((e=this.activityRankList[a]).rankName=this.rankList[e.startRank-1].name)},getList:function(){var e=this.activityRankList.length,t=1,a=[];for(t=1;t<e;t++)a.push(this.activityRankList[t]);return a},getLastRankInfo:function(){var e,t=this.rankList.length;return this.rankList&&t&&(e=this.rankList[t-1]),e}});game.rechargeRankData=game.rechargeRankData||new e}(),function(){var e;e=b8e.Object.extends({id:0,conditionValue:0,baseAwards:null,extAwards:null,rankName:"",startRank:0,endRank:0,ctor:function(){this._super()},setData:function(e){this.id=e.id,this.baseAwards=e.awards,this.conditionValue=e.rankExt.extraParam,this.extAwards=e.rankExt.extraAwards,this.startRank=e.rankExt.startRank,this.endRank=e.rankExt.endRank,this.basePrizeList=null,this.extPrizeList=null},getBasePrizeList:function(){if(this.basePrizeList)return this.basePrizeList;var e=this.baseAwards.length,t=0,a=this.basePrizeList=[];for(t=0;t<e;t++){var i=game.ItemUtil.createBaseItemInfo(this.baseAwards[t].id,this.baseAwards[t].num);i.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,i.iconSize=game.IconSizeEnum.GRID_SIZE_84,a.push(i)}return a},getExtPrizeList:function(){if(this.extPrizeList)return this.extPrizeList;var e=this.extAwards.length,t=0,a=this.extPrizeList=[];for(t=0;t<e;t++){var i=game.ItemUtil.createBaseItemInfo(this.extAwards[t].id,this.extAwards[t].num);i.iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,i.iconSize=game.IconSizeEnum.GRID_SIZE_84,a.push(i)}return a}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$RechargeRankInfo",e)}(),function(){var e=game.FestivalItemCtrl.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.RECHARGE_RANK),this.regFestival(game.FestivalSubType.FST_RANK_RECHARGE,game.ME.RechargeRank,game.SAE.RECHARGE_RANK)},ipc:function(){this.gevts={FestivalEvts:{SERV_UPDATE_DATA:this.updateDataRankActivity,UPDATE_RANK_INFO:this.updateDataRank}},this.evts={Recharge:{C_RECHARGE_SUCCESS:this.rechargeSuccess}}},notify:function(e){switch(e){case this.Evts.GET_RANK_INFO:this.reqRankList()}},rechargeSuccess:function(e){var t=e.data.money;if(game.festivalData.getFestivalIsOpen(game.FestivalSubType.FST_RANK_RECHARGE)){if(e.data.id)t=game.RechargeCfg.getDataById(e.data.id).money;game.rechargeRankData.rechargeNum+=t,this.send(this.Evts.UPDATE_RECHARGE_NUM)}},updateDataRankActivity:function(){var e=this.getData(),t=this.getModelData("conditions"),a=0,i=t.length;for(game.rechargeRankData.initActivityList(e),a=0;a<i;a++){var n=t[a];n&&n.subType==this.fSubType&&(game.rechargeRankData.rechargeNum=n.value)}this.send(this.Evts.UPDATE_RANK_ACTIVITY_INFO)},updateDataRank:function(e){var t=e.data;this.fSubType==t.subType&&(game.rechargeRankData.initRankList(t),this.send(this.Evts.UPDATE_RANK_INFO))},btnLookRank:function(){game.module.show(game.ME.RechargeRankList,null,!1)}}),t=[game.ME.RechargeRankList];b8e.module.registerControl(game.ME.RechargeRank,e,game.RechargeRankEvts,null,t)}(),function(){var e;e=game.ListItem.extends({langID1:4209,langID2:4203,ctor:function(){this._super(904),this.setSize(600,156)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.ShowItemListItem,t.addToParent(e.skin.prize),t.layout.paddingLeft=6,t.layout.paddingRight=0,t.layout.paddingTop=5,t.layout.spacingX=15;var a=e.extPrizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.ShowItemListItem,a.addToParent(e.skin.extraPrize),a.layout.paddingLeft=6,a.layout.paddingRight=0,a.layout.paddingTop=5,a.layout.spacingX=15},setData:function(){var e=this,t=e.skin,a=e.data,i=a.rankName;if(t.second_root.node.active=2==a.startRank,t.third_root.node.active=3==a.startRank,t.other_root.node.active=3<a.startRank,t.rank4.node.active=4==a.startRank,t.rank20.node.active=4<a.startRank,t.extraTitle.node.active=0<a.conditionValue,t.extraPrize.node.active=0<a.conditionValue,t.name_lab.active=a.startRank<4,t.name_lab.string=""!=i?i:game.Lang.get(9432),e.prizeList.setData(a.getBasePrizeList()),0<a.conditionValue){var n=a.getExtPrizeList();e.extPrizeList.setData(a.getExtPrizeList()),e.extPrizeList.x=n.length<3?240-70*n.length>>1:0,3<a.startRank?(t.extraConditionLabel.string=game.Lang.get(e.langID2,a.startRank,a.endRank,a.conditionValue),e.skin.extraTitle.width=t.extraConditionLabel.width+45,e.skin.extraTitle.x=423-(e.skin.extraTitle.width-250>>1)):t.extraConditionLabel.string=game.Lang.get(e.langID1,a.startRank,a.conditionValue)}}}),b8e.RC("$$game","$$RechargeRankItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(905),this.setSize(540,94)},setData:function(){var e=this.skin,t=this.data;e.rankIcon1.active=1==t.rank,e.rankIcon2.active=2==t.rank,e.rankIcon3.active=3==t.rank,e.rankIcon4.active=3<t.rank,e.powerLab.string="????";var a=t.rankType==game.FestivalSubType.FST_RANK_RECHARGE?game.rechargeRankData:game.consumptionRankData,i=a.myRank,n=a.getLastRankInfo();i&&i.rank?i.rank!=t.rank&&i.rank+1!=t.rank&&i.rank-1!=t.rank||(e.powerLab.string=t.score):n&&n.rank==t.rank&&(e.powerLab.string=t.score),e.rankLab.string=t.rank,e.nameLab.string=t.name}}),b8e.RC("$$game","$$RechargeRankListItem",e)}(),function(){var e=game.View.extends({_showModel:!0,model:null,ctor:function(){this._super(170)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.RechargeRankListItem,e.addToParent(this.skin.list),e.layout.spacingY=5},notify:function(e){switch(e){case this.Evts.UPDATE_RANK_INFO:this.setRankList(),this.setMyRechargeNum();break;case this.Evts.UPDATE_RECHARGE_NUM:this.setMyRechargeNum()}},setMyRechargeNum:function(){this.skin.myRechargeLab.string=game.rechargeRankData.rechargeNum},setRankList:function(){var e=game.rechargeRankData.rankList;this.list.setData(e),game.rechargeRankData.myRank&&0<game.rechargeRankData.myRank.rank?this.skin.myRankLab.string=game.rechargeRankData.myRank.rank:this.skin.myRankLab.string=game.Lang.get(9069)},onShow:function(){this.send(this.Evts.GET_RANK_INFO),this.setRankList(),this.setMyRechargeNum()},onHide:function(){}});b8e.module.registerView(game.ME.RechargeRankList,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(171)},init:function(){var e=this,t=e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.RechargeRankItem,t.bindEnum=game.ME.RechargeRank,t.addToParent(e.skin.list),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingY=5;var a=this.basePrizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.ShowItemListItem,a.addToParent(e.skin.baseAwardsList);var i=this.extPrizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);i.itemRender=game.ShowItemListItem,i.addToParent(e.skin.extraAwardsList),e.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),e.model=game.sceneRoleCreate.createUIRole(e.roleData),e.roleData.setMale(game.mainRoleData.isMale);var n=game.mainRoleData.isMale?1001:1002;e.roleData.heroModel.setBody(game.RoleType.Hero,n),e.model.addToParent(this.skin.model),this.timer=b8e.Timer.add(this,this.updateTime,500),this.skin.descLabel.string=game.Lang.get(4211)},notify:function(e){switch(e){case this.Evts.UPDATE_RANK_ACTIVITY_INFO:this.onShow();break;case this.Evts.UPDATE_RANK_INFO:this.setFirstData();break;case this.Evts.UPDATE_RECHARGE_NUM:this.setMyRechargeNum()}},setMyRechargeNum:function(){this.skin.rechargeNumLabel.string=game.rechargeRankData.rechargeNum},setFirstAwards:function(){var e=this;if(game.rechargeRankData.activityRankList.length){e.firstActivity=game.rechargeRankData.activityRankList[0];var t=e.skin,a=e.firstActivity.getBasePrizeList();if(e.basePrizeList.setData(a),e.basePrizeList.x=a.length<3?240-70*a.length>>1:0,0<e.firstActivity.conditionValue){t.extraAwardsList.node.active=!0,t.extraTitle.node.active=!0;var i=e.firstActivity.getExtPrizeList();e.extPrizeList.setData(i),e.extPrizeList.x=i.length<3?240-70*i.length>>1:0,3<e.firstActivity.startRank?t.extraConditionLabel.string=game.Lang.get(4203,e.firstActivity.startRank,e.firstActivity.endRank,e.firstActivity.conditionValue):t.extraConditionLabel.string=game.Lang.get(4209,e.firstActivity.startRank,e.firstActivity.conditionValue)}else t.extraAwardsList.node.active=!1,t.extraTitle.node.active=!1}},setFirstData:function(){var e=this;if(game.rechargeRankData.rankList.length&&(e.firstRankInfo=game.rechargeRankData.rankList[0]),e.firstRankInfo){e.skin.firstName.string=e.firstRankInfo.name;var t=e.firstRankInfo.info,a=e.firstRankInfo;if(t){var i=e.roleData.heroModel;i.clear();var n=game.mainRoleData.heroModel;followHeroModel.setBody(game.RoleType.Hero,n.body),0<a.fashion&&i.setFashion(a.fashion);var s=game.AvatarUtil;s.updateUIModel(e.model,s.ID_2),e.model.transition(game.RoleStateType.ACTION_IDLE)}}else e.skin.firstName.string=game.Lang.get(9106)},onShow:function(){var e=this;this.setFirstAwards(),this.setFirstData(),this.setMyRechargeNum(),e.infoList=game.rechargeRankData.getList(),e.list.setData(e.infoList),e.endTime=game.rechargeRankData.endTime-3e5,e.endTime&&(e.timer.reset(),e.timer.start()),this.send(this.Evts.GET_RANK_INFO)},onHide:function(){},updateTime:function(){if(!this.endTime){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}var e=this.endTime-game.SysTime.curTime;if(e<=0){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}this.skin.time.string=b8e.TimeUtil.formatDayTime(e)},stopTime:function(){if(this.timer){this.timer.stop()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.RechargeRank,e)}(),function(){var e;e=b8e.Enum({None:0,UPDATE_RANK_ACTIVITY_INFO:1,UPDATE_RANK_INFO:2,UPDATE_CONSUMPTION_NUM:3,GET_RANK_INFO:4,GET_CONSUMPTION_NUM:5}),b8e.RC("$$game","$$ConsumptionRankEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){this._super(),this.activityRankList=[],this.rankList=[],this.endTime=0,this.rechargeNum=0,this.myRank=null},initActivityList:function(e){if(e){var t,a,i=e.datas.length;for(t=this.activityRankList.length=0;t<i;t++)(a=new game.RechargeRankInfo).setData(e.datas[t]),this.activityRankList.push(a);this.activityRankList.sort(this.onActivitySort),this.endTime=e.endTime,this.setTopThreeInfo()}},initRankList:function(e){if(e){var t,a,i=e.list.length;for(this.rankList.length=0,this.myRank||(this.myRank=new game.RankItemInfo),this.myRank.setData(e.userRank),t=0;t<i;t++)(a=new game.RankItemInfo).setData(e.list[t]),a.rankType=game.FestivalSubType.FST_RANK_COST_GOLD,this.rankList.push(a);this.rankList.sort(this.onRankSort),this.setTopThreeInfo()}},onRankSort:function(e,t){return e.rank-t.rank},onActivitySort:function(e,t){return e.startRank-t.startRank},setTopThreeInfo:function(){var e,t=3<this.activityRankList.length?3:this.activityRankList.length,a=0;for(a=0;a<t;a++)a<this.rankList.length&&((e=this.activityRankList[a]).rankName=this.rankList[e.startRank-1].name)},getList:function(){var e=this.activityRankList.length,t=1,a=[];for(t=1;t<e;t++)a.push(this.activityRankList[t]);return a},getLastRankInfo:function(){var e,t=this.rankList.length;return this.rankList&&t&&(e=this.rankList[t-1]),e}});game.consumptionRankData=game.consumptionRankData||new e}(),function(){var e=game.FestivalItemCtrl.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.CONSUMPTION_RANK),this.regFestival(game.FestivalSubType.FST_RANK_COST_GOLD,game.ME.ConsumptionRank)},ipc:function(){this.gevts={FestivalEvts:{SERV_UPDATE_DATA:this.updateDataRankActivity,UPDATE_RANK_INFO:this.updateDataRank,UPDATE_CONDITION_INFO:this.updateDataCondition}}},notify:function(e){switch(e){case this.Evts.GET_RANK_INFO:this.reqRankList();break;case this.Evts.GET_CONSUMPTION_NUM:this.reqConditionInfo()}},updateDataRankActivity:function(){var e=this.getData(),t=this.getModelData("conditions"),a=0,i=t.length;for(game.consumptionRankData.initActivityList(e),a=0;a<i;a++){var n=t[a];n&&n.subType==this.fSubType&&(game.consumptionRankData.rechargeNum=n.value)}this.send(this.Evts.UPDATE_RANK_ACTIVITY_INFO)},updateDataRank:function(e){var t=e.data;this.fSubType==t.subType&&(game.consumptionRankData.initRankList(t),this.send(this.Evts.UPDATE_RANK_INFO))},updateDataCondition:function(e){var t=e.data;this.fSubType==t.subType&&(game.consumptionRankData.rechargeNum=t.value,this.send(this.Evts.UPDATE_CONSUMPTION_NUM))},btnLookRank:function(){game.module.show(game.ME.ConsumptionRankList,null,!1)}}),t=[game.ME.ConsumptionRankList];b8e.module.registerControl(game.ME.ConsumptionRank,e,game.ConsumptionRankEvts,null,t)}(),function(){var e;e=game.RechargeRankItem.extends({langID1:4207,langID2:4208}),b8e.RC("$$game","$$ConsumptionRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,model:null,ctor:function(){this._super(170)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.RechargeRankListItem,e.addToParent(this.skin.list),e.layout.spacingY=-1,this.skin.power.string=game.Lang.get(4205),this.skin.myRecharge.string=game.Lang.get(4204)},notify:function(e){switch(e){case this.Evts.UPDATE_RANK_INFO:this.setRankList(),this.setMyRechargeNum();break;case this.Evts.UPDATE_CONSUMPTION_NUM:this.setMyRechargeNum()}},setMyRechargeNum:function(){this.skin.myRechargeLab.string=game.consumptionRankData.rechargeNum},setRankList:function(){var e=game.consumptionRankData.rankList;this.list.setData(e),game.consumptionRankData.myRank&&0<game.consumptionRankData.myRank.rank?this.skin.myRankLab.string=game.consumptionRankData.myRank.rank:this.skin.myRankLab.string=game.Lang.get(9069)},onShow:function(){this.setRankList(),this.setMyRechargeNum(),this.send(this.Evts.GET_CONSUMPTION_NUM),this.send(this.Evts.GET_RANK_INFO)},onHide:function(){}});b8e.module.registerView(game.ME.ConsumptionRankList,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(171)},init:function(){var e=this,t=e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.ConsumptionRankItem,t.bindEnum=game.ME.ConsumptionRank,t.addToParent(e.skin.list),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.spacingX=0;var a=this.basePrizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);a.itemRender=game.ShowItemListItem,a.layout.spacingX=15,a.layout.paddingLeft=-5,a.layout.paddingTop=5,a.addToParent(e.skin.baseAwardsList);var i=this.extPrizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);i.itemRender=game.ShowItemListItem,i.layout.paddingTop=5,i.addToParent(e.skin.extraAwardsList),e.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),e.model=game.sceneRoleCreate.createUIRole(e.roleData),e.roleData.setMale(game.mainRoleData.isMale);var n=game.mainRoleData.isMale?1001:1002;e.roleData.heroModel.setBody(game.RoleType.Hero,n),e.model.addToParent(this.skin.model),this.timer=b8e.Timer.add(this,this.updateTime,500),this.skin.rechargeTitle.string=game.Lang.get(4206),this.skin.descLabel.string=game.Lang.get(4212)},notify:function(e){switch(e){case this.Evts.UPDATE_RANK_ACTIVITY_INFO:this.onShow();break;case this.Evts.UPDATE_RANK_INFO:this.setFirstData();break;case this.Evts.UPDATE_CONSUMPTION_NUM:this.setMyRechargeNum()}},setMyRechargeNum:function(){this.skin.rechargeNumLabel.string=game.consumptionRankData.rechargeNum},setFirstAwards:function(){var e=this;if(game.consumptionRankData.activityRankList.length){e.firstActivity=game.consumptionRankData.activityRankList[0];var t=e.skin,a=e.firstActivity.getBasePrizeList();if(e.basePrizeList.setData(a),e.basePrizeList.x=a.length<3?240-70*a.length>>1:0,0<e.firstActivity.conditionValue){t.extraAwardsList.node.active=!0,t.extraTitle.node.active=!0;var i=e.firstActivity.getExtPrizeList();e.extPrizeList.setData(i),e.extPrizeList.x=i.length<3?240-70*i.length>>1:0,3<e.firstActivity.startRank?t.extraConditionLabel.string=game.Lang.get(4208,e.firstActivity.startRank,e.firstActivity.endRank,e.firstActivity.conditionValue):t.extraConditionLabel.string=game.Lang.get(4207,e.firstActivity.startRank,e.firstActivity.conditionValue)}else t.extraAwardsList.node.active=!1,t.extraTitle.node.active=!1}},setFirstData:function(){var e=this;if(game.consumptionRankData.rankList.length&&(e.firstRankInfo=game.consumptionRankData.rankList[0]),e.firstRankInfo){e.skin.firstName.string=e.firstRankInfo.name;var t=e.firstRankInfo.info,a=e.firstRankInfo;if(t){var i=e.roleData.heroModel;i.clear();var n=game.mainRoleData.heroModel;i.setBody(game.RoleType.Hero,n.body),0<a.fashion&&i.setFashion(a.fashion);var s=game.AvatarUtil;s.updateUIModel(e.model,s.ID_2),e.model.transition(game.RoleStateType.ACTION_IDLE)}}else e.skin.firstName.string=game.Lang.get(9106)},onShow:function(){var e=this;this.setFirstAwards(),this.setFirstData(),this.setMyRechargeNum(),e.infoList=game.consumptionRankData.getList(),e.list.setData(e.infoList),e.endTime=game.consumptionRankData.endTime-3e5,e.endTime&&(e.timer.reset(),e.timer.start()),this.send(this.Evts.GET_CONSUMPTION_NUM),this.send(this.Evts.GET_RANK_INFO)},onHide:function(){},updateTime:function(){if(!this.endTime){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}var e=this.endTime-game.SysTime.curTime;if(e<=0){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}this.skin.time.string=b8e.TimeUtil.formatDayTime(e)},stopTime:function(){if(this.timer){this.timer.stop()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.ConsumptionRank,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_LIST:-1,C2V_UPDATE_MONEY:-1,V2C_GET_PRIZE:-1,C2C_INIT_DATA:-1,C2C_RESET_DAILY:-1,C2V_SWITCH_PAGE:-1,C2C_UPDATE_LIST:-1,C2C_CHANGE_ACC_CON:-1,V2C_SHOW_MERGE_VIEW:-1,C2V_REFRESH_VIEW:-1,V2C_SELECT_BTN:-1}),b8e.RC("$$game","$$ContinuousRechargeEvts",e)}(),function(){var e=b8e.Object.extends({conRechargeDay:0,needRechargeMoney:0,isPassRecharge:!1,endTime:0,conRechargeFinish:!1,type:1,viewType:0,ctor:function(){this._super(),this.infoList=[],this.awardList=[],this.infoMap=b8e.HashMap.get(),this.dayList=[]},initData:function(){var e=this,t=game.miscData.serverMergeDays,a=game.miscData.mergeVersion,i=game.MergeKeepRechargeCfg.getGroupListByDay(t,a);if(!i||i.length<1)return!1;e.groupListMap?e.groupListMap.clear():e.groupListMap=b8e.HashMap.get(),e.infoMap||(e.infoMap=b8e.HashMap.get()),e.rechargeInfoMap||(e.rechargeInfoMap=b8e.HashMap.get()),e.titleInfoMap||(e.titleInfoMap=b8e.HashMap.get()),e.titleInfoList?e.titleInfoList.length=0:e.titleInfoList=[];for(var n=0,s=void 0,o=void 0,r=void 0,g=void 0,l=void 0,c=void 0,h=i.length;n<h;n++)(r=i[n])&&(g=r.group,(l=e.infoMap.get(r.id))||(l=new game.ContinuousRechargeInfo,e.infoMap.set(l.id,l)),l.setData(r),(s=e.rechargeInfoMap.get(g))&&l.setComplete(s.rechargeDay),(c=e.titleInfoMap.get(g))||(c=new game.MergeConRechargeTitleInfo,e.titleInfoMap.set(g,c)),c.setData(r),e.titleInfoList.indexOf(c)<0&&e.titleInfoList.push(c),(o=e.groupListMap.get(g))||(o=[],e.groupListMap.set(g,o)),o.push(l));return e.titleInfoList&&0<e.titleInfoList.length&&e.titleInfoList.sort(e.onTitleSort),0<e.titleInfoList.length},onTitleSort:function(e,t){return e.group-t.group},resetDaily:function(){var e=this.titleInfoList;if(e&&!(e.length<1))for(var t=void 0,a=void 0,i=void 0,n=e.length,s=0;s<n;s++){if(!(a=e[s]))return;if(!(t=a.group))return;(i=this.rechargeInfoMap.get(t))?i.resetDaily():(i=new game.MergeKeepRechargeInfo).initData(t)}},setKeepRecharges:function(e){if(e&&!(e.length<1)){this.rechargeInfoMap||(this.rechargeInfoMap=b8e.HashMap.get());for(var t=e.length,a=void 0,i=void 0,n=0;n<t;n++)a=e[n],(i=this.rechargeInfoMap.get(a.group))||(i=new game.MergeKeepRechargeInfo,this.rechargeInfoMap.set(a.group,i)),i.setData(a)}},getAwardSuccess:function(e,t){var a=this.rechargeInfoMap.get(t);a&&a.rechargeAwards.push(e)},rechargeSuccess:function(){var e=game.rechargeData.rechargeMoneyDaily;if(this.titleInfoList&&!(this.titleInfoList.length<1))for(var t=void 0,a=void 0,i=this.titleInfoList,n=this.rechargeInfoMap,s=i.length,o=0;o<s;o++)t=i[o].group,n&&((a=n.get(t))||(a=new game.MergeKeepRechargeInfo,n.set(t,a),a.initData(t)),!a.rechargeFinish&&0!=a.needRechargeMoney&&e>=a.needRechargeMoney&&(a.rechargeFinish=!0,a.rechargeDay++))},getInfoListByGroup:function(e){if(!this.groupListMap)return null;var t=this.groupListMap.get(e);return t||null},checkAllAlert:function(){if(!this.groupListMap)return!1;var e=this.groupListMap.keys();if(!e||e.length<1)return!1;for(var t=void 0,a=!1,i=e.length,n=0;n<i;n++)t=+e[n],this.checkAlert(t)&&!a&&(a=!0);return a},checkAlert:function(e){if(!this.groupListMap)return!1;var t=this.groupListMap.get(e);if(!t||t.length<1)return!1;var a=!1,i=this.rechargeInfoMap.get(e),n=void 0;n=i?i.rechargeAwards:[];for(var s=t.length,o=void 0,r=0;r<s;r++)o=t[r],i&&o.setComplete(i.rechargeDay),n&&0<n.length?o.isGet=-1<n.indexOf(o.id):o.isGet=!1,a||!o.canGet||o.isGet||(a=!0);if(this.titleInfoMap){var g=this.titleInfoMap.get(e);g&&(g.alert=a)}return a},selectBtn:function(e){if(this.titleInfoMap){var t=void 0;this.curGroup&&(t=this.titleInfoMap.get(this.curGroup))&&(t.select=!1),(t=this.titleInfoMap.get(e))&&(this.curGroup=e,t.select=!0)}},getCurGroup:function(){return this.curGroup},showView:function(){if(this.titleInfoList&&!(this.titleInfoList.length<1)){var e=this.titleInfoList[0];this.selectBtn(e.group)}},getTitleInfoList:function(){return!this.titleInfoList||this.titleInfoList.length<1?null:this.titleInfoList}});game.mergeConRechargeData=game.mergeConRechargeData||new e}(),function(){var e;e=b8e.Object.extends({ctor:function(){this._super()},setData:function(e){var t=this.group=e.group;this.rechargeDay=e.rechargeDay,this.rechargeAwards=e.rechargeAwards,this.rechargeFinish=e.rechargeFinish;var a=this.rechargeFinish?this.rechargeDay:this.rechargeDay+1,i=game.MergeKeepRechargeCfg.getData(t,a);this.needRechargeMoney=i?i.money:0},resetDaily:function(){this.rechargeFinish=!1;var e=this.rechargeDay+1;this.group&&(this.cfg=game.MergeKeepRechargeCfg.getData(this.group,e),this.cfg?this.needRechargeMoney=this.cfg.money:this.needRechargeMoney=0)},initData:function(e){this.group=e,this.rechargeDay=0,this.rechargeAwards=[],this.rechargeFinish=!1;var t=this.cfg=game.MergeKeepRechargeCfg.getData(e,1);t&&(this.needRechargeMoney=t.money)}}),b8e.RC("$$game","$$MergeKeepRechargeInfo",e)}(),function(){var e;e=b8e.Object.extends({group:0,title:"",select:!1,alert:!1,ctor:function(){this._super()},setData:function(e){this.cfg=e,this.group=e.group,this.title=e.title}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$MergeConRechargeTitleInfo",e)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.MERGE_CON_RECHARGE_ALERT,game.SAE.MERGE_SERVER_ALERT)},ipc:function(){this.evts={Recharge:{C_RECHARGE_SUCCESS:this.recharge,C_INIT_MODEL:this.initRecharge},MainRole:{C_INIT_SERVER_DATA:this.initServerData,C_RESET_DAILY:this.resetDaily}},this.handels={MergeKeepRechargeResp:this.mergeKeepRechargeResp}},recharge:function(){game.mergeConRechargeData.rechargeSuccess(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_MONEY)},triggerOpen:function(){this.delayInit()},resetDaily:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&(this.initConRechargeData=!1,this.initData(),game.mergeConRechargeData.resetDaily(),this.checkAlert(),this.dpt(this.Evts.C2V_REFRESH_VIEW))},initServerData:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&this.delayInit()},delayInit:function(){this.initData(),this.checkAlert()},initData:function(){if(!this.initConRechargeData){this.initConRechargeData=!0;var e=game.mergeConRechargeData;this.obj||(this.obj={openServerType:game.OpenServerType.CON_RECHARGE,isActive:!0,sae:game.SAE.MERGE_CON_RECHARGE_ALERT}),this.obj.isActive=e.initData(),this.dptG(game.MergeServerGEvts.C2C_CHANGE_MERGESERVER,this.obj)}},initRecharge:function(){var e=game.rechargeData;game.mergeConRechargeData.setKeepRecharges(e.mergeKeepRecharges),this.checkAlert()},mergeKeepRechargeResp:function(e){var t=e.readProtobuf(game.pb.MergeKeepRechargeResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.id,i=game.MergeKeepRechargeCfg.getDataById(a);if(i){var n=i.group;game.mergeConRechargeData.getAwardSuccess(a,n),this.checkAlertByGroup(n),this.dpt(this.Evts.C2V_UPDATE_LIST)}}},notify:function(e,t){switch(e){case this.Evts.V2C_GET_PRIZE:this.sender.MergeKeepRechargeReq(t);break;case this.Evts.V2C_SELECT_BTN:game.mergeConRechargeData.selectBtn(t),this.send(this.Evts.C2V_UPDATE_LIST);break;case this.Evts.V2C_SHOW_MERGE_VIEW:game.mergeConRechargeData.showView(),this.send(this.Evts.C2V_REFRESH_VIEW)}},checkAlert:function(){this.spotAlert.alert=game.mergeConRechargeData.checkAllAlert()},checkAlertByGroup:function(e){var t=game.mergeConRechargeData.checkAlert(e);this.spotAlert.alert&&!t&&this.checkAlert()}}),t=game.Sender.extends({ipc:function(){this.msg={MergeKeepRechargeReq:this.mergeKeepRechargeReq}},mergeKeepRechargeReq:function(e){var t=game.pb.MergeKeepRechargeRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.MergeConRecharge,e,game.ContinuousRechargeEvts,t)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(175),this.setSize(115,44)},setData:function(){var e=this.skin,t=this.data;e.titleLab.string=t.title,e.selectBtn.active=t.select,e.red_spot.active=t.alert},clickBtn:function(){this.send(game.ContinuousRechargeEvts.V2C_SELECT_BTN,this.data.group)}}),b8e.RC("$$game","$$MergeConRechargeTitleItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(176)},init:function(){var e=this.list=new game.List;e.itemRender=game.ContinuousRechargeItem,e.bindEnum=this.moduleEnum,e.layout.paddingTop=0,e.addToParent(this.skin.list),(e=this.list2=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal)).itemRender=game.MergeConRechargeTitleItem,e.bindEnum=this.moduleEnum,e.addToParent(this.skin.list2),this.timer=b8e.Timer.add(this,this.updateTime,500)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_MONEY:this.updateMoneyDaily();break;case this.Evts.C2V_UPDATE_LIST:this.refreshPage(),this.updateList();break;case this.Evts.C2V_REFRESH_VIEW:this.refreshPage(),this.updataGroupList()}},onShow:function(){this.updateMoneyDaily(),(this.info=game.mergeServerData.getCurBtnInfo())&&this.send(this.Evts.V2C_SHOW_MERGE_VIEW)},updateList:function(){var e=game.mergeConRechargeData.getCurGroup(),t=game.mergeConRechargeData.getInfoListByGroup(e);this.list.setData(t)},updataGroupList:function(){var e=game.mergeConRechargeData.getTitleInfoList();this.list2.setData(e)},refreshPage:function(){var e=game.mergeConRechargeData.getCurGroup();if(this.updateList(),e){var t=game.MergeKeepRechargeCfg.getOnceDataByGroup(e);if(t){this.endTime=game.miscData.mergeServerTime+(t.mergeEnd-1)*b8e.TimeUtil.DAY_MICRO_SECONDS,this.timer.reset(),this.timer.start();var a=void 0;t.banner&&(a=game.ResCfg.getImgUrl(t.banner,!0)),a&&this.skin.banner.loadTexture(a)}}},onHide:function(){this.stopTime()},updateMoneyDaily:function(){this.skin.rechargeMoneyDaily.string=game.Lang.get(1701,game.rechargeData.rechargeMoneyDaily)},updateTime:function(){if(!this.endTime){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}var e=this.endTime-game.SysTime.curTime;if(e<=0){return this.skin.time.string=game.Lang.get(9053),void this.stopTime()}this.skin.time.string=game.TimeUtil.formatTimeSpace(e)},stopTime:function(){if(this.timer){this.timer.stop()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.MergeConRecharge,e)}(),function(){var e;e=b8e.Enum({None:0,V2C_UPDATE_VIEW:b8e.enc(),C2V_UPDATE_VIEW:b8e.enc(),C2C_RECHARGE:b8e.enc(),C2V_UPDATE_BUTTON:b8e.enc(),C2C_REFRESH_BTNS:b8e.enc(),C2V_CLICK_BUY:b8e.enc()}),b8e.RC("$$game","$$TimeLimitPrizeEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Recharge:{C_INIT_MODEL:this.initNetData,C_RECHARGE_SUCCESS:this.onRechargeSuccess},MainRole:{C_RESET_DAILY:this.checkClose}},this.handels={TimeLimitPrizeBuyResp:this.onTimeLimitPrizeBuyResp}},notify:function(e,t){switch(e){case this.Evts.V2C_UPDATE_VIEW:this.updateView(t);break;case this.Evts.C2V_CLICK_BUY:this.buyBtn()}},initNetData:function(){game.timeLimitPrizeData.initNetData()},onTimeLimitPrizeBuyResp:function(e){var t=e.readProtobuf(game.pb.TimeLimitPrizeBuyResponse);0<t.code?game.notice.noticeError(t.code):(game.timeLimitPrizeData.updateIsBought(t.id),this.checkEnterOpen(),this.send(this.Evts.C2V_UPDATE_BUTTON))},onRechargeSuccess:function(e){if(e&&e.data){var t=e.data.id;game.RechargeCfg.getDataById(t).rechargeType==game.RechargeType.TIMELIMITPRIZE&&(game.timeLimitPrizeData.onRechargeSuccess(t),this.checkEnterOpen(),this.send(this.Evts.C2V_UPDATE_BUTTON),this.dpt(this.Evts.C2V_UPDATE_BUTTON))}},checkEnterOpen:function(){var e=game.timeLimitPrizeData,t=e.actId;e.isBuyAll(t)&&this.dpt(this.Evts.C2C_REFRESH_BTNS)},checkClose:function(){if(b8e.module.isShowView(game.ME.TimeLimitPrize)){var e=game.timeLimitPrizeData.actId;game.timeLimitPrizeData.checkOpenByActId(e)||game.module.hide(game.ME.TimeLimitPrize)}},updateView:function(e){game.timeLimitPrizeData.setId(e),this.send(this.Evts.C2V_UPDATE_VIEW,e)},buyBtn:function(){var e=game.timeLimitPrizeData.getCurInfo().cfg;e.rechargeId?this.dpt(this.Evts.C2C_RECHARGE,e.rechargeId):game.UpgradeUtil.checkEquipTooMuch()||this.sender.TimeLimitPrizeBuyReq(e.id)}}),t=game.Sender.extends({ipc:function(){this.msg={TimeLimitPrizeBuyReq:this.timeLimitPrizeBuyReq}},timeLimitPrizeBuyReq:function(e){var t=game.pb.TimeLimitPrizeBuyRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.TimeLimitPrize,e,game.TimeLimitPrizeEvts,t)}(),function(){var e=b8e.Object.extends({initNetData:function(){this._boughtArr=game.rechargeData.timeLimitPrize},setActId:function(e){this.actId=e,this.setCurInfoArr(e);var t=this._infoArr;if(t&&!(t.length<1)){var a=t[0].cfg.id;this.setId(a)}},getBoughtArr:function(){return this._boughtArr||this.initNetData(),this._boughtArr},setCurInfoArr:function(e){var t,a,i=game.TimeLimitPrizeCfg.getDatasByAcid(e),n=i.length,s=this.getBoughtArr();this._infoArr=[];for(var o=game.miscData.openServerDay,r=game.miscData.serverMergeDays,g=game.miscData.mergeVersion,l=game.CCommonUtil.getGameChannelIdOpen,c=0;c<n;c++){if(t=i[c],0!=g&&0!=t.mergeVer){if(t.mergeVer!=g||t.mergeStart>r||t.mergeEnd<=r)continue}else if(t.serverStart>o||t.serverEnd<=o)continue;if(l(t)){var h=new game.TimeLimitPrizeInfo;h.setData(t),a=-1<s.indexOf(t.id),h.setBought(a),this._infoArr.push(h)}}},checkAllGet:function(e){for(var t=game.TimeLimitPrizeCfg.getDatasByAcid(e),a=this.getBoughtArr(),i=game.miscData.openServerDay,n=game.miscData.serverMergeDays,s=game.miscData.mergeVersion,o=game.CCommonUtil.getGameChannelIdOpen,r=void 0,g=0,l=t.length;g<l;g++){if(r=t[g],0!=s&&0!=r.mergeVer){if(r.mergeVer!=s||r.mergeStart>n||r.mergeEnd<=n)continue}else if(r.serverStart>i||r.serverEnd<=i)continue;if(o(r)&&!(-1<a.indexOf(r.id)))return!1}return!0},setId:function(e){this.id=e},getCurInfo:function(){var e=this._infoArr;if(!e||e.length<1)return null;for(var t,a=e.length,i=this.id,n=0;n<a;n++)if((t=e[n]).id==i)return t},getCurInfoArr:function(){return this._infoArr},updateSelect:function(){for(var e,t=this._infoArr,a=t.length,i=this.id,n=0;n<a;n++)(e=t[n]).isSelected=e.id==i},checkOpenByActId:function(e){var t=game.TimeLimitPrizeCfg.getDatasByAcid(e);if(!t||t.length<1)return!1;for(var a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=void 0,l=void 0,c=game.CCommonUtil.getGameChannelIdOpen,h=0,m=t.length;h<m;h++)if(!(0<(a=t[h]).rechargeId&&game.RECHARGE_PLATFORM==game.RechargePlatformType.IOS_WECHATGAME)&&c(a)){if(i=a.serverStart,n=a.serverEnd,s=game.miscData.openServerDay,o=a.mergeStart,r=a.mergeEnd,g=game.miscData.serverMergeDays,l=game.miscData.mergeVersion,i<=s&&s<n)return this.endDay=n,!0;if(l==a.mergeVer&&o<=g&&g<r)return this.endDay=r,!0}return this.endDay=0,!1},getCheckCfg:function(e){var t=game.TimeLimitPrizeCfg.getDatasByAcid(e);if(t)for(var a,i=t.length,n=0;n<i;n++)if(a=t[n],!(game.RECHARGE_PLATFORM==game.RechargePlatformType.IOS_WECHATGAME&&0<a.rechargeId))return a},checkLv:function(e){return!e||e<=game.mainRoleData.lv},getCountdown:function(){var e=this.endDay;if(0==e)return 0;var t=game.miscData.openServerDay;return b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,e-t)-game.SysTime.curTime},updateIsBought:function(e){this.getBoughtArr().push(e);var t=this.getCurInfo();t&&t.setBought(!0)},onRechargeSuccess:function(e){var t=game.TimeLimitPrizeCfg.getDataByRechargeId(e);t&&this.updateIsBought(t.id)},isBuyAll:function(e){var t=this.getBoughtArr();if(!t)return!1;var a=this.getCfgs(e);if(!a||a.length<1)return!1;for(var i,n=a.length,s=game.CCommonUtil.getGameChannelIdOpen,o=0;o<n;o++)if(s(i=a[o])&&!(-1<t.indexOf(i.id)))return!1;return!0},getCfgs:function(e){return game.TimeLimitPrizeCfg.getDatasByAcid(e)}});game.timeLimitPrizeData=game.timeLimitPrizeData||new e}(),function(){var e;e=b8e.Object.extends({isSelected:!1,isBought:!1,setData:function(e){this.cfg=e,this.id=e.id},setBought:function(e){this.isBought=e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$TimeLimitPrizeInfo",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1039)},init:function(){var e=this;e._super();var t=e.skin;e.words=b8e.Sprite.get(),e.words.setAnchor(0,1),e.words.addToParent(t.wordsNode),e.title=b8e.Sprite.get(),e.title.setAnchor(.5,.5),e.title.addToParent(t.titleNode),e.titleList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e.titleList.itemRender=game.TimeLimitPrizeItem,e.titleList.bindEnum=e.moduleEnum,e.titleList.addToParent(t.titleList),e.titleList.layout.paddingLeft=2,e.titleList.layout.paddingTop=-9,e.titleList.layout.spacingX=4,e.awardsList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e.awardsList.itemRender=game.PrizeListItem,e.awardsList.bindEnum=e.moduleEnum,e.awardsList.addToParent(t.awardsListNode),e.awardsList.layout.paddingLeft=0,e.awardsList.layout.paddingTop=0,e.awardsList.layout.spacingX=16,e.awardsList.layout.spacingY=0,e.model=b8e.SceneEntity.get(),e.model.addToParent(e.skin.modelNode),e.modelPic=b8e.Sprite.get(),e.modelPic.setAnchor(.5,.5),e.modelPic.addToParent(t.picNode)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateShow();break;case this.Evts.C2V_UPDATE_BUTTON:this.updateButton()}},onShow:function(){this.updateShow()},updateShow:function(){var e=game.timeLimitPrizeData,t=this.skin,a=e.getCurInfoArr(),i=e.getCurInfo(),n=i.cfg,s=game.ResCfg.getImgUrl("timeLimitPrize/title/"+n.picTitle);this.title.loadTexture(s),e.updateSelect(),this.titleList.setData(a),t.wordsNode.setPosition(58,-144),t.wordsNode.x+=n.wordsX,t.wordsNode.y+=n.wordsY;var o=game.ResCfg.getImgUrl("timeLimitPrize/words/"+n.propaganda);this.words.loadTexture(o);var r=game.CfgUtil.getPrizeListInfo(n.award);if(r&&this.awardsList.setData(r.items),this.createModel(),n.rechargeId){var g=game.RechargeCfg.getDataById(n.rechargeId);t.moneyLabel.string=game.Lang.get(51288,g.money)}else{var l=n.cost[0];22==l.Id?t.moneyLabel.string=game.Lang.get(51289,l.Num):21==l.Id&&(t.moneyLabel.string=game.Lang.get(51290,l.Num))}t.buyBtn.node.active=!i.isBought,t.grayBtn.node.active=i.isBought},createModel:function(){var e=this.skin,t=game.timeLimitPrizeData.getCurInfo().cfg,a=this.model.getAnimator(game.AnimType.FOSTER,1);if(this.modelPic.unloadTexture(),t.model){var i=game.AvatarUtil.getUIModel(t),n=game.ResCfg.getUrl(5020,i);a=a||this.model.addAnimator(game.AnimType.FOSTER,1),e.modelNode.setPosition(494,-557),e.modelNode.x+=t.modelX,e.modelNode.y+=t.modelY,a.load(n),a.play()}else{a&&a.clear(),e.picNode.setPosition(147,-593),e.picNode.x+=t.modelX,e.picNode.y+=t.modelY;var s=t.disseminate;n=game.ResCfg.getImgUrl("timeLimitPrize/picture/"+s);this.modelPic.loadTexture(n)}},updateButton:function(){var e=game.timeLimitPrizeData,t=this.skin,a=e.getCurInfo();t.buyBtn.node.active=!a.isBought,t.grayBtn.node.active=a.isBought},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.TimeLimitPrize,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1038),this.setSize(128,60)},setData:function(e){var t=this.skin;t.title_label.string=e.cfg.titleName,t.title_light.node.active=!e.isSelected,t.title_dark.node.active=e.isSelected},onClick:function(){game.timeLimitPrizeData.id!=this.data.id&&this.send(game.TimeLimitPrizeEvts.V2C_UPDATE_VIEW,this.data.id)}}),b8e.RC("$$game","$$TimeLimitPrizeItem",e)}(),function(){var e;e=b8e.Enum({None:0,SHOWNEXTPRIZELIST:-1,UPDATE_PRIZETIPS:-1,GET_PRIZE:-1,V_REQ_RANKINFO:-1,C_REQ_RANKINFO:-1,C2C_SYS_DATA_SUCCEED:-1,C2C_CHALLENGE_SUCCEED:-1,V_AUTO_FIGHT_CHANGE:-1,V_START_FIGHT:-1,CLOSE_PRIZETIPS:-1,DAILY_UPDATE:-1,SWEEP_UPDATEVIEW:-1,C2C_UPDATE_AUTOFIGHT:-1,C2V_UPDATE_VIEW:-1,C2C_CHALLENGE_WIN:-1}),b8e.RC("$$game","$$HuntingEvts",e)}(),function(){var e=game.Control.extends({isAssist:!1,init:function(){this.huntingAlert=game.spotAlert.set(game.SAE.HUNTING_ALERT),this.fightAlert=game.spotAlert.set(game.SAE.HUNTING_FIGHT)},ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.syncHunting},Rank:{C_UPDATE_DATA:this.updateRankInfo},InstanceFunc:{UPDATE_AUTOFIGHT:this.updateAutoFight},DifficultSelect:{C2C_SELECT_DIFFICULT:this.selectDifficult}},this.handels={WanshouChallengeResp:this.onRespWanshouChallenge,WanshouSweepResp:this.onRespWanshouSweep,WanshouCollectAwardResp:this.onRespWanshouCollectAward}},notify:function(e){switch(e){case this.Evts.GET_PRIZE:this.sender.WanshouCollectAwardReq(game.huntingData.showPrizeLayer);break;case this.Evts.V_REQ_RANKINFO:this.reqRankInfo();break;case this.Evts.V_START_FIGHT:this.startFight()}},startFight:function(){if(game.playBack.isInstanceFighting())return game.huntingData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE);var e=game.huntingData.currentLayer+1,t=game.WanShouCfg.getData(e);return t?t.lastRound?(game.notice.show(9066),void this.autoBg_1()):t.type!=game.huntingData.curDifficulty?(game.huntingData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),game.difficultSelectData.curInstType=game.DifficultSelectType.WANSHOU,void game.module.show(game.ME.DifficultSelect)):void(game.UpgradeUtil.checkEquipTooMuch()?this.autoBg_1():game.playBack.isInstanceFighting()?this.autoBg_1():this.sender.WanshouChallengeReq(0)):(game.notice.show(9066),void this.autoBg_1())},autoBg_1:function(){game.huntingData.autoFight=!game.huntingData.autoFight,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,game.huntingData.autoFight)},updateAutoFight:function(){this.send(this.Evts.V_AUTO_FIGHT_CHANGE)},syncHunting:function(e){if(game.moduleOpen.checkOpen(game.ME.Hunting)){var t=e.data;if(t){var a=t.wanshou;if(a)game.huntingData.setup(a),this.checkAllAlert(),this.dpt(this.Evts.C2C_SYS_DATA_SUCCEED),this.send(this.Evts.DAILY_UPDATE);else;}}},onRespWanshouChallenge:function(e){var t=e.readProtobuf(game.pb.WanshouChallengeResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.WanShouCfg.getData(t.layer);a&&game.huntingData.curDifficulty!=a.type&&this.send(this.Evts.C2V_UPDATE_VIEW,game.huntingData.curDifficulty),game.huntingData.currentLayer=t.layer,game.huntingData.maxLayer<t.layer&&(game.huntingData.maxLayer=t.layer),game.GameViewMgr.inst().hideUnStrongViews();var i={type:game.InstanceType.HUNTING,rewards:t.useritem,exp:t.exp};if(1==t.type&&game.teamLeagueAssistData.updateAssistCount(),game.playBack.play(t.battlelog,i),this.checkAllAlert(),this.dpt(this.Evts.C2C_CHALLENGE_SUCCEED),i.win)this.dpt(this.Evts.C2C_CHALLENGE_WIN);else{game.huntingData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}this.dpt(this.Evts.C2C_UPDATE_AUTOFIGHT,!0)}},onRespWanshouSweep:function(e){var t=e.readProtobuf(game.pb.WanshouSweepResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=t.layer,i=a<game.huntingData.getWanshouMaxLayer()?a+1:a,n=game.WanShouCfg.getData(i);n&&(game.huntingData.maxDifficulty=n.type,game.huntingData.curDifficulty=n.type,game.huntingData.currentLayer=a,game.huntingData.curShowBox=game.huntingData.getMinPrice(game.huntingData.curDifficulty));var s={win:!0,type:game.InstanceType.HUNTING,rewards:t.useritem};this.checkAllAlert(),b8e.evt.dptG(game.InstanceEvts.G_STOP_PLAY,s),this.send(this.Evts.SHOWNEXTPRIZELIST),this.send(this.Evts.SWEEP_UPDATEVIEW,game.huntingData.currentLayer)}},onRespWanshouCollectAward:function(e){var t=e.readProtobuf(game.pb.WanshouCollectAwardResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.huntingData.addPrize(t.layer),game.huntingData.curShowBox=game.huntingData.getMinPrice(game.huntingData.curDifficulty),this.checkAllAlert(),this.send(this.Evts.UPDATE_PRIZETIPS),this.send(this.Evts.SHOWNEXTPRIZELIST),this.send(this.Evts.CLOSE_PRIZETIPS)},nextBtnRight:function(){if(game.WanShouCfg.getPrizeList(game.huntingData.curShowBox+1)){++game.huntingData.curShowBox,this.send(this.Evts.SHOWNEXTPRIZELIST)}},nextBtnLeft:function(){var e=game.huntingData.curShowBox-1;if(0<e){game.WanShouCfg.getPrizeList(e);--game.huntingData.curShowBox,this.send(this.Evts.SHOWNEXTPRIZELIST)}},gemBoxB_0:function(){this.setShowPrizeData(0)},gemBoxB_1:function(){this.setShowPrizeData(1)},gemBoxB_2:function(){this.setShowPrizeData(2)},onWanshouCollectAwardReq:function(e){if(e>=game.huntingData.currentLayer){this.sender.WanshouCollectAwardReq(game.huntingData.showPrizeLayer)}else;},setShowPrizeData:function(e){var t=game.WanShouCfg.getPrizeList(game.huntingData.curShowBox),a=0;if(t){a=t.length}if(e<a){game.huntingData.showPrizeLayer=t[e].layer}game.module.show(game.ME.HuntingPrize)},showRankBtn:function(){game.module.show(game.ME.HuntingRank)},fightBtn:function(){this.isAssist=!1,this.wanshouChallengeReq()},assistBtn:function(){game.teamLeagueAssistData.canChallenge()&&(this.isAssist=!0,this.wanshouChallengeReq())},wanshouChallengeReq:function(){if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap()){return game.huntingData.autoFight=!1,void this.send(this.Evts.V_AUTO_FIGHT_CHANGE)}var e=game.huntingData.currentLayer+1,t=game.ZhaoQinCfg.getData(e);if(t&&!t.lastRound){if(t.type!=game.huntingData.curDifficulty)return game.huntingData.autoFight=!1,this.send(this.Evts.V_AUTO_FIGHT_CHANGE),game.difficultSelectData.curInstType=game.DifficultSelectType.WANSHOU,void game.module.show(game.ME.DifficultSelect);if(!game.UpgradeUtil.checkEquipTooMuch()){if(game.playBack.isInstanceFighting()){return}this.send(this.Evts.V_AUTO_FIGHT_CHANGE),this.sender.WanshouChallengeReq(this.isAssist?1:0)}}},oneKeyBtn:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){this.sender.WanshouSweepReq()}},checkAllAlert:function(){this.checkAlert(),this.checkPassAlert(),this.checkFightAlert(),this.checkTagAlert()},checkAlert:function(){var e=game.huntingData.updataAlert(0);this.huntingAlert.alert=e},checkPassAlert:function(){var e=game.huntingData.updataAlert(1);game.huntingData.setPass(game.huntingData.currentLayer!=game.huntingData.maxLayer),this.huntingAlert.alert=e},checkFightAlert:function(){var e=game.InstanceMiscCfg.getData("WanshouMaxLayer");if(e){var t=e.value;this.fightAlert.alert=t>game.huntingData.maxLayer}},checkTagAlert:function(){},reqRankInfo:function(){this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.InsWanshou)},updateRankInfo:function(){this.send(this.Evts.UPDATE_RANKVIEW)},sureBtn:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){this.sender.WanshouCollectAwardReq(game.huntingData.showPrizeLayer)}},selectDifficult:function(e){if(e&&e.data){var t=e.data;t.instType==game.DifficultSelectType.WANSHOU&&(game.huntingData.curDifficulty=t.difficult,this.send(this.Evts.C2V_UPDATE_VIEW,t.difficult))}}}),t=game.Sender.extends({ipc:function(){this.msg={WanshouChallengeReq:this.WanshouChallengeReq,WanshouSweepReq:null,WanshouCollectAwardReq:this.reqWanshouCollectAward}},reqWanshouCollectAward:function(e){var t=game.pb.WanshouCollectAwardRequest;t.layer=e,this.write(t)},WanshouChallengeReq:function(e){var t=game.pb.WanshouChallengeRequest;t.type=e,this.write(t)}}),a=[game.ME.HuntingPrize,game.ME.HuntingRank];b8e.module.registerControl(game.ME.Hunting,e,game.HuntingEvts,t,a)}(),function(){var e=b8e.Object.extends({maxLayer:0,currentLayer:0,collected:null,layer:0,maxShow:3,curShowBox:1,showPrizeLayer:0,autoFight:!1,passAlert:!1,curDifficulty:1,maxDifficulty:1,fightTag:0,clearTag:1,ctor:function(){this._super()},setup:function(e){var t=this;if(e){t.maxLayer=e.maxLayer,t.currentLayer=e.currentLayer,t.collected=e.collected,t.curShowBox=Math.ceil(e.maxLayer/9);var a=t.currentLayer>=t.maxLayer&&0<t.currentLayer?t.currentLayer-1:t.currentLayer,i=game.WanShouCfg.getData(a+1);t.maxDifficulty=i.type,t.curDifficulty=i.type}},getShowMonsters:function(e){var t=e/this.maxShow|0;e=e<this.getWanshouMaxLayer()?e+1:e;var a=game.WanShouCfg.getData(e);return a&&!a.lastRound&&(t+=1),game.WanShouCfg.getAreaList(t)},addPrize:function(e){this.collected||(this.collected=[]),this.collected.push(e)},getMinPrice:function(e){for(var t,a=game.WanShouCfg.getListByType(e),i=a.length,n=0;n<i;n++){var s=a[n].awardGround;if(s){var o=a[n].layer;if(this.collected||(this.collected=[]),!(-1!=this.collected.indexOf(o)))return s;t=s}}return t},updataAlert:function(e){var t=!1;if(this.currentLayer!=this.maxLayer)return!0;var a,i=game.WanShouCfg.getLayerAwardList(),n=i.length;switch(e){case this.fightTag:a=this.currentLayer;break;case this.clearTag:a=this.maxLayer}for(var s=0;s<n;s++){var o=i[s].layer;if(this.collected&&0<this.collected.length){if(t=-1!=this.collected.indexOf(o),o<=a&&!t)return!0}else if(o<=a)return!0}return!1},setPass:function(e){this.passAlert=e},getLangKey:function(e){if(!this.langKeyArr){var t=game.InstanceMiscCfg.getData("wanshouLangKey");if(!t)return null;this.langKeyArr=t.value.split("|")}return this.langKeyArr[e]},getMaxDifficulty:function(){var e=this.getWanshouMaxLayer(),t=this.maxLayer>=e?e:this.maxLayer+1,a=game.WanShouCfg.getData(t);return a?a.type:1},getWanshouMaxLayer:function(){if(this.wanshouMaxLayer)return this.wanshouMaxLayer;var e=game.InstanceMiscCfg.getData("WanshouMaxLayer");return e?(this.wanshouMaxLayer=+e.value,this.wanshouMaxLayer):void 0}});game.huntingData=game.huntingData||new e}(),function(){var e;e=b8e.Object.extends({cfgId:0,items:null,ctor:function(){this._super(),this.items=[]},setup:function(e){for(var t=this.items.length=0,a=e.length;t<a;t++){var i=game.ItemUtil.createBaseItemInfo(e[t].Id,e[t].Num);this.items.push(i)}}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$HuntingInfo",e)}(),function(){var e=game.View.extends({_modelList:null,_barwidthList:null,barWidth:514,ctor:function(){this._super(596),this.spotAlerts={HUNTING_FIGHT:this.fightAlert},this._modelList=[],this._barwidthList=[]},notify:function(e,t){var a=this;switch(e){case a.Evts.SHOWNEXTPRIZELIST:a.updatePrizeBox();break;case a.Evts.V_AUTO_FIGHT_CHANGE:a.autoFightChange();break;case a.Evts.DAILY_UPDATE:a.daily_update();break;case a.Evts.SWEEP_UPDATEVIEW:a.updateView(t);break;case a.Evts.C2V_UPDATE_VIEW:var i=a.difficultyMaxLayer(t)-1;a.updateView(i),a.showDifficultyBtn(),game.huntingData.curShowBox=game.huntingData.getMinPrice(t),a.updatePrizeBox()}},init:function(){var e=this;e.huntingBg=b8e.Sprite.get(),e.huntingBg.setAnchor(.5,.5),e.huntingBg.addToParent(e.skin.huntingBg),e.huntingBg.loadTexture(game.ResCfg.getUrl(45));for(var t=0;t<3;++t){var a;(a=b8e.SceneEntity.get()).addToParent(e.getComponent("monModel_"+t)),e._modelList.push(a)}var i=game.huntingData.getWanshouMaxLayer(),n=game.huntingData.currentLayer;n=n<i?n+1:n;var s=game.WanShouCfg.getData(n);s&&(e.huntingTitle=b8e.Sprite.get(),e.huntingTitle.setAnchor(.5,.5),e.huntingTitle.addToParent(e.skin.title),e.huntingTitle.loadTexture(game.ResCfg.getUrl(114,s.type))),e.insAutoTime=game.CfgUtil.getInsAutoTimeSpace(),e.insAutoTimeDesc=game.CfgUtil.getInsAutoTime()},daily_update:function(){var e=game.huntingData.getWanshouMaxLayer(),t=game.huntingData.currentLayer;t=t<e?t+1:t;var a=game.WanShouCfg.getData(t);a&&this.huntingTitle.loadTexture(game.ResCfg.getUrl(114,a.type))},fightAlert:function(e){this.skin.redFight.node.active=e.alert},onShow:function(){var e=game.huntingData.currentLayer,t=e<game.huntingData.getWanshouMaxLayer()?e+1:e,a=game.WanShouCfg.getData(t),i=game.huntingData.maxDifficulty,n=game.huntingData.curDifficulty,s=this.difficultyMaxLayer(n)-1;0<e&&a?a.type==i&&a.type==n?this.updateView(e):a.type>i&&a.type!=n?this.updateView(e-1):n<i?this.updateView(s):this.updateView(e):this.updateView(e),game.huntingData.curShowBox=game.huntingData.getMinPrice(game.huntingData.curDifficulty),this.updatePrizeBox(),this.autoFightChange()},updateView:function(e){var i=this,t=i.skin,a=game.huntingData.getShowMonsters(e),n=e+1;t.arrow.node.active=!1;for(var s=0;s<a.length;++s)a[s]?(i.getComponent("cengjiBg"+s).active=!0,i.getComponent("finish_"+s).active=game.huntingData.currentLayer>=a[s].layer,i.getComponent("instanceName"+s).string=game.Lang.get(9524,a[s].layer),s<i._modelList.length&&game.CfgUtil.getMonsterCfgByMonGroup(a[s].monGroup,1,function(a){return function(e){var t=game.AvatarUtil.getUIModel(e,0,!1);i.setAnim(game.ResCfg.getUrl(5e3,t),i._modelList[a]),i.setElementBtn(e,a)}}(s),i),a[s].layer==n&&(t.arrow.node.x=i.getComponent("finish_"+s).x,t.arrow.node.active=!0)):(i.getComponent("finish_"+s).active=!1,i.getComponent("instanceName"+s).string="",i.getComponent("cengjiBg"+s).active=!1,i.setAnim(null,i._modelList[s]));i.showDifficultyBtn();var o=game.huntingData.curDifficulty;120==n&&(o=4),i.huntingTitle.loadTexture(game.ResCfg.getUrl(114,o));var r=game.WanShouCfg.getMonsterText();if(r&&0<r.length){var g,l;i.matCostIcon||(i.matCostIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),i.matCostIcon.setPosition(0,0),i.matCostIcon.addToParent(t.award_node));for(var c=0;c<r.length;c++)if(l=r[c],game.huntingData.maxLayer<l.layer){g=game.ItemInfoCfg.getData(l.showAward);break}if(g){i.matCostIcon.setItemInfo(g,!1,!1);var h=game.HtmlUtil.getColorByQuality(g.quality,!1);i.matCostIcon.setName(g.name,h)}var m=game.huntingData.getWanshouMaxLayer();if(game.huntingData.maxLayer>r[r.length-1].layer||game.huntingData.maxLayer>=m)return t.monsterTIps.string="",void(t.talkBox.node.active=!1);for(s=0;s<r.length;++s)if(game.huntingData.maxLayer<=r[s].layer)return void(t.monsterTIps.string=r[s].text)}else t.monsterTIps.string="",t.talkBox.node.active=!1},difficultyMaxLayer:function(e){var t=game.WanShouCfg.getListByType(e),a=t[t.length-1].layer;return a<=game.huntingData.maxLayer?a:t[0].layer},autoFightChange:function(){var e=this,t=game.huntingData.autoFight;e.skin.autoBg_2.node.active=t;game.InstanceMiscCfg.getData("instanceAutoTime").value;t?(e.autoFightEndTime=game.SysTime.curTime+this.insAutoTime,e.autoFightTimer||(e.autoFightTimer=b8e.Timer.add(e,e.updateFightTime,500)),e.autoFightTimer.reset(),e.autoFightTimer.start(),e.skin.autoTips.string=game.Lang.get(5305,this.insAutoTimeDesc)):(e.autoFightTimer&&e.autoFightTimer.stop(),e.skin.autoTips.string=game.Lang.get(5306))},updateFightTime:function(){var e=this,t=e.autoFightEndTime-game.SysTime.curTime;0<t?e.skin.autoTips.string=game.Lang.get(5305,t/1e3>>0):(e.autoFightTimer.stop(),e.skin.autoTips.string=game.Lang.get(5307),e.send(e.Evts.V_START_FIGHT))},updatePrizeBox:function(){var e=this,t=e.skin,a=game.WanShouCfg.getPrizeList(game.huntingData.curShowBox),i=0;a&&(i=a.length);for(var n,s=!1,o=0;o<3;++o)e.getComponent("iconBG"+o).node.active=o<i,e.getComponent("redPoint_"+o).node.active=!1,o<i?(e.getComponent("progressLab"+o).string=game.Lang.get(9524,a[o].layer),game.huntingData.collected&&0<game.huntingData.collected.length?(s=-1!=game.huntingData.collected.indexOf(a[o].layer),e.getComponent("geted"+o).node.active=s,e.getComponent("redPoint_"+o).node.active=game.huntingData.currentLayer>=a[o].layer&&!s):(e.getComponent("geted"+o).node.active=!1,e.getComponent("redPoint_"+o).node.active=game.huntingData.currentLayer>=a[o].layer),e.getComponent("progressIcon_"+o).node.active=game.huntingData.currentLayer>=a[o].layer):e.getComponent("progressLab"+o).string="";t.curInstanceName.string=game.Lang.get(9524,game.huntingData.maxLayer);var r,g=game.huntingData.curShowBox-1;if(g){var l=game.WanShouCfg.getPrizeList(g);r=l[l.length-1].layer}else r=0;var c,h,m,u,d=a[i-1].layer;if(game.huntingData.maxLayer>d&&(n=514),!n)for(var f=0;f<i;f++){if(h=a[f].layer,f<i-1&&a[f+1].layer,0<f&&(c=a[f-1].layer),game.huntingData.maxLayer<=h)switch(f){case 0:n=60/(m=h-r)*(u=m-(h-game.huntingData.maxLayer));break;case 1:u=(m=h-c)-(h-game.huntingData.maxLayer),n=Math.floor(200/m)*u+60;break;case 2:u=(m=h-c)-(h-game.huntingData.maxLayer),n=Math.floor(200/m)*u+260}if(n){450<n&&(n=514),n<0&&(n=0);break}}if(t.bar_0.node.width=n,0<game.huntingData.currentLayer){var p=game.WanShouCfg.getPrizeList(game.huntingData.curShowBox-1);p&&p[0].type!=game.huntingData.curDifficulty&&(p=!1),t.nextBtnLeft.node.active=!!p}else t.nextBtnLeft.node.active=!1;if(0<game.huntingData.currentLayer){var _=game.WanShouCfg.getPrizeList(game.huntingData.curShowBox+1);_&&_[0].type!=game.huntingData.curDifficulty&&(_=!1),t.nextBtnRight.node.active=!!_}else t.nextBtnRight.node.active=!1;e.updataPassAlert()},setAnim:function(e,t){var a;if(t&&(a=t.getAnimator(game.AnimType.BODY,1)),e){if(!a){a=t.addAnimator(game.AnimType.BODY,1)}a.load(e),a.play()}else if(a){a.clear()}},onHide:function(){for(var e,t,a=this._modelList.length,i=0;i<a;++i){if((t=this._modelList[i])&&(e=t.getAnimator(game.AnimType.BODY,1))){e.clear()}}var n=this;if(n.autoFightTimer){n.autoFightTimer.stop()}n.skin.autoTips.string=game.Lang.get(5306)},onStageResize:function(){this.setPosition(0,-0)},updataPassAlert:function(){this.skin.redPass.active=game.huntingData.passAlert},updataClickAnim:function(){var e=this.skin;if(!this.proAnim){this.proAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1);this.proAnim.addToParent(e.nextNode),this.proAnim.load(game.ResCfg.getUrl(5019,1001)),this.proAnim.setPosition(545,-45)}this.proAnim.play()},showDifficultyBtn:function(){var e=game.huntingData.curDifficulty,t=game.ResCfg.getUrl(5033,e);this.skin.viewLevelBtn.loadTexture(t)},viewLevelBtn:function(){game.difficultSelectData.curInstType=game.DifficultSelectType.WANSHOU,game.module.show(game.ME.DifficultSelect)},setElementBtn:function(e,t){var a=this.getComponent("view_elementBtn_"+t);e&&e.element?(this.element||(this.element=[]),this.element[t]=e.element,a.active=!0,a.loadTexture(game.ResCfg.getUrl(10050,e.element))):a.active=!1},view_elementBtn_0:function(){this.clickElementBtn(0)},view_elementBtn_1:function(){this.clickElementBtn(1)},view_elementBtn_2:function(){this.clickElementBtn(2)},clickElementBtn:function(e){if(this.element||!(this.element.length<1)){var t=this.getComponent("view_elementBtn_"+e),a=this.element[e];game.elementData.setElementInfo(a,50369,t.localToGlobal(),!1),game.module.show(game.ME.ElementAttr)}}});b8e.module.registerView(game.ME.Hunting,e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(599),this.spotAlerts={}},init:function(){this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Grid),this.list.itemRender=game.PrizeListItem,this.list.layout.paddingLeft=20,this.list.layout.paddingRight=0,this.list.layout.paddingTop=0,this.list.layout.spacingX=58,this.list.addToParent(this.skin.prizeNode)},notify:function(e){switch(e){case this.Evts.UPDATE_PRIZETIPS:this.updateView();break;case this.Evts.CLOSE_PRIZETIPS:this.closeBtn()}},onShow:function(){this.updateView(),game.TweenUtil.rotationEffect(this.skin.light)},updateView:function(){var e=game.huntingData.showPrizeLayer,t=game.WanShouCfg.getData(e);if(t){this.skin.prizetips.string=game.Lang.get(6615,t.layer);var a=game.CfgUtil.getPrizeListInfo(t.layerAward,3);this.list.setData(a.items)}var i=game.huntingData.currentLayer>=e,n=!1;if(game.huntingData.collected){n=-1!=game.huntingData.collected.indexOf(e)}this.skin.sureBtn.node.active=i&&!n},onHide:function(){b8e.Tween.kill(this.skin.light)},closeBtn:function(){game.module.hide(this.moduleEnum)},onStageResize:function(){this.setPosition(b8e.stageWidth/2,b8e.stageHeight/2+106)}});b8e.module.registerView(game.ME.HuntingPrize,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(597),this.setSize(540,94)},setData:function(){this.onClear();var e=this.data;if(e){var t=this.skin;t.rank.node.active=3<e.rank,t.rank.string=e.rank+"",t.name.string=e.name,t.power.string=e.power+"",t.instancenum.string=e.score+"";var a=e.rank;if(3<a){t.rank4.node.active=!0}else this.getComponent("rank"+a).node.active=!0}else;},onClear:function(){this.skin;for(var e=1;e<5;e++){this.getComponent("rank"+e).node.active=!1}}}),b8e.RC("$$game","$$HuntingRankItem",e)}(),function(){var e=game.View.extends({_showModel:!0,barWidth:0,ctor:function(){this._super(598),this.spotAlerts={}},init:function(){var e=this;e.rankList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.rankList.itemRender=game.HuntingRankItem,e.rankList.bindEnum=game.ME.HuntingRank,e.rankList.layout.paddingLeft=0,e.rankList.layout.paddingRight=0,e.rankList.layout.paddingTop=0,e.rankList.layout.spacingX=15,e.rankList.layout.spacingY=5,e.rankList.addToParent(e.skin.listNode)},notify:function(e){switch(e){case this.Evts.UPDATE_RANKVIEW:this.updateView()}},onShow:function(){this.send(this.Evts.V_REQ_RANKINFO)},updateView:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.InsWanshou);this.rankList.setData(e);var t=game.rankData.getSelfRankInfo(game.RankType.InsWanshou);if(t){this.skin.rankNum.string=0==t.rank?game.Lang.get(9069):t.rank,this.skin.instanceNum.string=t.score}}});b8e.module.registerView(game.ME.HuntingRank,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_COST:b8e.enc(),V2C_GET_PRIZE:b8e.enc(),C2V_UPDATE_VIEW:b8e.enc(),C2C_CHANGE_ACC_COST2:b8e.enc()}),b8e.RC("$$game","$$AccCostEvts",e)}(),function(){var e=game.Control.extends({isInited:!1,init:function(){this.accCostAlert=game.spotAlert.set(game.SAE.ACC_COST_ALERT,game.SAE.OPEN_SERVER_ALERT)},ipc:function(){this.evts={OpenServer:{C2C_INIT_OPENSERVER:this.onSysData},Back:{C2C_REMOVE_AMOUNT:this.removeAmount},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={AccumulativeCostAwardResp:this.onAccumulativeCostAwardResp}},notify:function(e,t){switch(e){case this.Evts.V2C_GET_PRIZE:this.getPrize(t)}},resetDaily:function(){game.accCostData.checkOpen()?(this.isInited=!0,game.accCostData.initNetData(),this.send(this.Evts.C2V_UPDATE_VIEW)):this.checkOpen()},onSysData:function(e){var t=e?e.data:null;if(t&&(this.checkOpen(),game.accCostData.checkOpen())){if(!this.isInited)game.accCostData.group==t.accCostGroup?game.accCostData.initNetData(t):game.accCostData.initNetData(),this.isInited=!0;this.checkAlert()}},checkOpen:function(){var e=game.accCostData.checkOpen(),t={openServerType:game.OpenServerType.ACC_COST,isActive:e,sae:game.SAE.ACC_COST_ALERT};this.dptG(game.OpenServerGEvts.C2C_CHANGE_OPENSERVER,t)},checkAlert:function(){var e=game.accCostData.checkAlert();this.accCostAlert.alert=e},updateAmount:function(e){var t=!!e.data,a=game.accCostData;a.checkOpen()&&(a.updatePayCount(t),this.isInited&&(a.updateIsCanGet(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_COST)))},removeAmount:function(e){if(e&&e.data){var t=game.accCostData;t.checkOpen()&&(t.payCount+=e.data,this.isInited&&(t.updateIsCanGet(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_COST)))}},getPrize:function(e){game.UpgradeUtil.checkEquipTooMuch()||this.sender.AccumulativeCostAwardReq(e)},onAccumulativeCostAwardResp:function(e){var t=e.readProtobuf(game.pb.AccumulativeCostAwardResponse);0<t.code?game.notice.noticeError(t.code):(game.accCostData.updateIsJoined(t.id),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_VIEW),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeReceive))},enterNode:function(){var e=game.ME.Turnplate;game.moduleOpen.checkOpenWithTips(e)&&game.module.showToggle(e,1)}}),t=game.Sender.extends({ipc:function(){this.msg={AccumulativeCostAwardReq:this.accumulativeCostAwardReq}},accumulativeCostAwardReq:function(e){var t=game.pb.AccumulativeCostAwardRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.AccCost,e,game.AccCostEvts,t)}(),function(){var e=b8e.Object.extends({payCount:0,lastCount:0,initNetData:function(e){var t=0<arguments.length&&void 0!==e?e:1;1==t?(this._joinedArr=[],this.payCount=0):(this._joinedArr=t.accCostAwards,this.payCount=t.accCostGold),0<this.group&&this.createInfoArr()},createInfoArr:function(){var e=this.group,t=game.AccumulativeCostCfg.getDatas();if(t){var a,i=t.length,n=this._joinedArr;this._infoArr=[];for(var s=0;s<i;s++){var o;if((a=t[s]).group==e)(o=new game.AccCostInfo).setData(a),-1<n.indexOf(a.id)&&o.setIsJoin(),this._infoArr.push(o)}}},clearData:function(){this._joinedArr=[],this.payCount=0,this._infoArr=[]},getInfoArr:function(){for(var e,t=this._infoArr,a=t.length,i=[],n=[],s=[],o=0;o<a;o++)(e=t[o]).isJoined?s.push(e):e.canGet?i.push(e):n.push(e);return(i=(i=i.concat(n)).concat(s)).sort(this._sort)},checkOpen:function(){var e=game.AccumulativeCostCfg.getDatas();if(e){for(var t,a,i,n=game.miscData.openServerDay,s=e.length,o=0;o<s;o++)if(a=(t=e[o]).serverStart,i=t.serverEnd,a<=n&&n<i)return this.group=t.group,this.openDay=a,this.endDay=i,!0;return this.group=0,!1}},_sort:function(e,t){return e.canGet&&!t.canGet?-1:!e.canGet&&t.canGet?1:void 0},checkOpenByGroup:function(e){var t=this.getGroupFirstCfg(e);if(!t)return!1;var a=game.miscData.openServerDay,i=t.serverStart,n=t.serverEnd;return i<=a&&a<n},getGroupFirstCfg:function(e){var t=game.AccumulativeCostCfg.getDatas();if(t){for(var a,i=t.length,n=0;n<i;n++)if((a=t[n]).group==e)return a;return null}},getCurBannerUrl:function(){var e=this.group,t=this.getGroupFirstCfg(e).banner;return game.ResCfg.getImgUrl(t)},getCurTitleUrl:function(){var e=this.group,t=this.getGroupFirstCfg(e).title;return game.ResCfg.getImgUrl(t)},getPayCount:function(){return this.payCount},updatePayCount:function(e){var t=0<arguments.length&&void 0!==e&&e,a=game.amount.get(game.AmountType.YUAN_BAO);if(0==this.lastCount||t)this.lastCount=a;else{if(this.lastCount>a){var i=this.lastCount-a;this.payCount+=i}this.lastCount=a}},getCountdown:function(){var e=this.endDay,t=game.miscData.openServerDay;return b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,e-t)-game.SysTime.curTime},updateIsCanGet:function(){for(var e=this._infoArr,t=e.length,a=0;a<t;a++)e[a].updateInfo()},updateIsJoined:function(e){for(var t,a=this._infoArr,i=a.length,n=0;n<i;n++)if((t=a[n]).id==e)return void t.setIsJoin()},checkAlert:function(){for(var e=this._infoArr,t=e.length,a=0;a<t;a++)if(e[a].canGet)return!0;return!1}});game.accCostData=game.accCostData||new e}(),function(){var e;e=b8e.Object.extends({isEnough:!1,isJoined:!1,canGet:!1,isGray:!1,setData:function(e){this.cfg=e,this.id=e.id,this.costGold=e.costGold,this.updateInfo(),this.setAwardList()},setAwardList:function(){var e,t,a=this.cfg.award,i=a.length;this.prizeList=[];for(var n=0;n<i;n++)e=a[n],(t=game.ItemUtil.createBaseItemInfo(e.Id,e.Num)).iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,this.prizeList.push(t)},getAwardList:function(){return this.prizeList},setIsJoin:function(){this.isJoined=!0,this.updateInfo()},updateInfo:function(){var e=this.cfg.costGold,t=game.accCostData.getPayCount();this.isEnough=e<=t,this.canGet=this.isEnough&&!this.isJoined,this.isGray=!this.isEnough&&!this.isJoined}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$AccCostInfo",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(6)},init:function(){var e=this.skin,t=this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.AccCostItem,t.bindEnum=this.moduleEnum,t.layout.spacingY=5,t.addToParent(e.listNode)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_COST:this.updateCost();break;case this.Evts.C2V_UPDATE_VIEW:this.updateView()}},onShow:function(){this.updateView(),this.createTimer(),this._list.scrollToTop()},updateView:function(){var e=game.accCostData,t=e.getInfoArr();if(t&&!(t.length<1)){this._list.setData(t);var a=e.getPayCount();this.skin.labMoney.string=game.Lang.get(9599,a);var i=e.getCountdown(),n=game.TimeUtil.formatTimeSpace(i,3);this.skin.labTime.string=n,this.updateCost()}},updateCost:function(){var e=game.accCostData.getPayCount();this.skin.labMoney.string=game.Lang.get(9599,e)},createTimer:function(){this.timer?(this.timer.reset(),this.timer.start()):this.timer=b8e.Timer.add(this,this.updateTime,1e3)},updateTime:function(){this.skin;var e=game.accCostData.getCountdown();if(e<0)this.clearTimer();else{var t=game.TimeUtil.formatTimeSpace(e,3);this.skin.labTime.string=t}},clearTimer:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},onHide:function(){this.clearTimer()},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.AccCost,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(4),this.setSize(600,177)},init:function(){this.skin;var e=this.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.PrizeListItem,e.addToParent(this.skin.prizeList),e.layout.paddingLeft=6,e.layout.paddingRight=0,e.layout.paddingTop=-5,e.layout.spacingX=15,e.layout.paddingTop=-5,e.layout.spacingX=15},setData:function(){var e=this.skin,t=this.data,a=t.getAwardList();this.prizeList.setData(a);var i=game.Lang.get(4803,t.cfg.costGold);e.lab.string=i,e.getPrize.active=t.canGet,e.grayBtn.active=t.isGray,e.isGetImg.active=t.isJoined},getPrizeBtn:function(){this.send(game.AccCostEvts.V2C_GET_PRIZE,this.data.id)}}),b8e.RC("$$game","$$AccCostItem",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.maxTopLv={},this.obj={id:1}},_maxLv:0,maxLv:{get:function(){return this._maxLv||(this._maxLv=Number(game.CfgUtil.getMiscValue(game.GodArmyMiscCfg,"godArmyTalentMaxLv"))),this._maxLv}}}),b8e.RC("$$game","$$GodArmyTalentCfg",e)}(),function(){var e=game.View.extends({_showModel:!0,_addNodeTouch:!0,ctor:function(){this._super(900)},init:function(){},onShow:function(){this.showQrcode()},showQrcode:function(){var e=this,t="data:image/png;base64,"+game.rechargeData.qrcode,a=new Image;a.src=t,a.onload=function(){e.texture=b8e.Texture2D.get(),e.texture.initWithElement(a),e.texture.handleLoadedTexture(),e.sprite||(e.sprite=b8e.Sprite.get(),e.sprite.addToParent(e.skin.btnwords),e.sprite.setAnchor(.5,.5),e.sprite.setScale(2,2)),e.sprite.setTexture(e.texture)}},onHide:function(){this.texture&&(this.texture.release(),this.texture=null),this.sprite&&(this.sprite.removeFromParent(),this.sprite=null)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.QrcodeView,e)}(),function(){var e;e=b8e.Enum({None:0,C_SELECT_ROLE:b8e.enc(),V_TOGGLECHANGE:b8e.enc(),C_UPDATE_DATA:b8e.enc(),V_SETTEAM_UPDATE_DATA:b8e.enc(),C_SETTEAM_UPDATE_DATA:b8e.enc(),C_SELECT_TEAM:b8e.enc(),C_UPDATE_CHALLENGE:b8e.enc(),C_RENASCENCE_UPDATE:b8e.enc(),C_REST_UPDATE:b8e.enc(),C_BUY_UPDATE:b8e.enc(),C_BUFF_UPDATE:b8e.enc(),V_BUFF_UPDATE:b8e.enc(),V_MAP_UPDATE:b8e.enc(),C_CLICK_MAP_ITEM:b8e.enc(),C_CLICK_MAP_BOX:b8e.enc(),C_CLICK_MAP_BUFF:b8e.enc(),C_CLICK_MAP_SHOP:b8e.enc(),C_GET_MYTEAM:b8e.enc()}),b8e.RC("$$game","$$ChallengeCbpEvts",e)}(),function(){var e,t,a;a=b8e.Enum({ROLE:1}),t=b8e.Enum({NONE:0,BOX:1,SHOP:2,BUFF:3}),e=b8e.Enum({NONE:0,ATK:1,DEF:2,HP:3}),b8e.RC("$$game","$$ChallengeCbpRoleType",a),b8e.RC("$$game","$$ChallengeCbpMapEventType",t),b8e.RC("$$game","$$ChallengeCbpBuffType",e)}(),function(){var t=void 0;t=b8e.PoolObject.extends({id:0,type:0,lv:0,power:0,isBattle:!1,isWaitBattle:!1,hp:0,hpMax:0,name:"",isMale:!1,recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.id=0,e.type=0,e.lv=0,e.power=0,e.isBattle=!1,e.isWaitBattle=!1,e.hp=0,e.hpMax=0,e.name="",e.isMale=!1}}),b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,512),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$ChallengeCbpRoleInfo",t)}(),function(){var e;e=b8e.Object.extends({maxPos:0,maxBattle:0,teamList:null,type:null,alert:!1,getBattleCount:function(){var e=0;if(!this.teamList)return 0;for(var t=0,a=this.teamList.length;t<a;t++)0!=this.teamList[t].id&&e++;return e}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ChallengeCbpMyTeamInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,type:0,state:0,value:"",cfg:null}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ChallengeCbpMapEvent",e)}(),function(){var e;e=b8e.Object.extends({teamList:null,power:0,name:"",lv:0,isMale:0}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ChallengeCbpLevelTeamInfo",e)}(),function(){var e;e=b8e.Object.extends({id:0,state:0,teamInfo:null,eventInfo:null,value:"",cfg:null}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ChallengeCbpLevelInfo",e)}(),function(){var e;e=b8e.Object.extends({hp:0,atk:0,def:0}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$ChallengeCbpBuffInfo",e)}(),function(){var e=b8e.Object.extends({levelList:null,levelMap:null,myTeamList:null,buffInfo:null,curLevelId:1,curSelectSetTeam:null,cloneSetTeam:null,resetCount:0,reviveCount:0,maxLevel:0,curSelectEvent:null,lastId:0,selectList:null,winCount:0,ctor:function(){this._super(),this.selectList=[],this.buffInfo=new game.ChallengeCbpBuffInfo},initMyTeam:function(){this.myTeamList||(this.myTeamList=[],this.myTeamList.push(this.createMyTeamInfo(game.ChallengeCbpRoleType.ROLE,1,1)))},createMyTeamInfo:function(e,t,a){var i=new game.ChallengeCbpMyTeamInfo;i.type=e,i.teamList=[],i.maxPos=t,i.maxBattle=a;for(var n=0,s=i.maxPos;n<s;n++){var o=game.ChallengeCbpRoleInfo.get();o.isBattle=this.isBattlePos(e,n+1,i.maxBattle),o.isWaitBattle=this.isWaitBattlePos(e,n+1,i.maxBattle),i.teamList.push(o)}return i},isBattlePos:function(e){switch(e){case game.ChallengeCbpRoleType.ROLE:return!0;default:return!1}},isWaitBattlePos:function(e){switch(e){case game.ChallengeCbpRoleType.ROLE:default:return!1}},initAllLevel:function(){this.levelList=[],this.levelMap=b8e.HashMap.get();for(var e,t,a,i=game.ChangbanpoCfg.getDatas(),n=0,s=i.length;n<s;n++)a=i[n],this.maxLevel=a.id,(e=new game.ChallengeCbpLevelInfo).id=a.id,e.cfg=a,(t=new game.ChallengeCbpMapEvent).id=a.id,t.type=a.eventType,t.cfg=a,e.eventInfo=t,this.levelMap.set(a.id,e),this.levelList.push(e)},updateAllLevelData:function(e){var t,a,i,n=this;n.buffInfo.hp=0,n.buffInfo.atk=0,n.buffInfo.def=0,n.initAllLevel(),!e.resetCount&&0!=e.resetCount||(n.resetCount=e.resetCount),n.winCount=e.winCount,n.reviveCount=e.reviveCount||0,n.lastId=e.lastId,e.stages.sort(n.levelSort);for(var s=0,o=e.stages.length;s<o;s++){if(i=e.stages[s],(t=n.levelMap.get(i.id)).state=i.state,(a=t.eventInfo).value=i.event.value,a.state=i.event.state,0<a.state&&a.type==game.ChallengeCbpMapEventType.BUFF){var r=game.ChangbanpoBuffCfg.getData(a.state);r.type==game.ChallengeCbpBuffType.ATK&&(n.buffInfo.atk+=r.value/100),r.type==game.ChallengeCbpBuffType.DEF&&(n.buffInfo.def+=r.value/100),r.type==game.ChallengeCbpBuffType.HP&&(n.buffInfo.hp+=r.value/100)}n.updateLevelTeam(t,i.enemy)}n.setCurSelectLevel()},levelSort:function(e,t){return e.id-t.id},setCurSelectLevel:function(){if(this.levelList){for(var e=-1,t=0,a=this.levelList.length;t<a;t++)this.levelList[t].state||-1!=e||(e=this.levelList[t].id);-1==e&&(e=this.levelList[this.levelList.length-1].id),this.curLevelId=e}},updateLevelTeam:function(e,t){var a=e.teamInfo;a||((a=new game.ChallengeCbpLevelTeamInfo).teamList=[]);for(var i=0,n=a.teamList.length;i<n;i++)a.teamList[i].release();a.teamList.length=0;var s,o,r=a.teamList;for(i=0,n=t.members.length;i<n;i++)(o=t.members[i]).type!=game.ChallengeCbpRoleType.ROLE?((s=game.ChallengeCbpRoleInfo.get()).id=o.id,s.type=o.type,s.lv=o.level,s.power=o.power,s.isBattle=!o.isReserve,s.isWaitBattle=o.isReserve,s.hp=o.hp,s.hpMax=o.maxHp,s.name=o.name,r.push(s)):(a.power=o.power,a.name=o.name,a.lv=o.level,a.isMale=o.isMale);a.teamList=r,e.teamInfo=a},updateMyTeam:function(e){this.restAllMyTeamInfo();for(var t=this.getMyTeamInfoByType(game.ChallengeCbpRoleType.PET),a=t.teamList.length,i=0,n=t.maxPos;i<n;i++)if(i<a){var s=t.teamList[i];s.isBattle=this.isBattlePos(t.type,i+1,t.maxBattle),s.isWaitBattle=this.isWaitBattlePos(t.type,i+1,t.maxBattle)}else{var o=game.ChallengeCbpRoleInfo.get();o.isBattle=this.isBattlePos(t.type,i+1,t.maxBattle),o.isWaitBattle=this.isWaitBattlePos(t.type,i+1,t.maxBattle),t.teamList.push(o)}for(i=0,n=e.members.length;i<n;i++){var r=e.members[i];this.addMyTeamRoleInfo(r)}},addMyTeamRoleInfo:function(e){var t,a=e.type,i=this.getMyTeamInfoByType(a),n=game.ChallengeCbpRoleType;if(i&&i.teamList)for(var s=0,o=i.teamList.length;s<o;s++)if((t=i.teamList[s])&&0==t.id){switch(t.id=e.id,t.type=e.type,t.power=e.power,t.isBattle=!e.isReserve,t.isWaitBattle=e.isReserve,t.hp=e.hp,t.hpMax=e.maxHp,t.name=e.name,e.type){case n.ROLE:t.id=game.mainRoleData.roleId,t.lv=game.mainRoleData.lv,t.name=game.mainRoleData.name,t.isMale=game.mainRoleData.isMale}return}},restAllMyTeamInfo:function(){for(var e=0,t=this.myTeamList.length;e<t;e++)this.restTeamInfo(this.myTeamList[e])},restTeamInfo:function(e){for(var t=0,a=e.teamList.length;t<a;t++)this.restRoleInfo(e.teamList[t])},restRoleInfo:function(e){e.id=0,e.type=0,e.lv=0,e.power=0,e.hp=0,e.hpMax=0,e.name=""},getMyTeamInfoByType:function(e){if(!this.myTeamList)return null;for(var t=0,a=this.myTeamList.length;t<a;t++)if(this.myTeamList[t].type==e)return this.myTeamList[t];return null},setCloneSetTeam:function(e){var t=this;if(t.cloneSetTeam){t.cloneSetTeam.type=e.type,t.cloneSetTeam.maxPos=e.maxPos,t.cloneSetTeam.maxBattle=e.maxBattle;for(var a,i=t.cloneSetTeam.teamList.length,n=0,s=e.maxPos;n<s;n++)n<i?a=t.cloneSetTeam.teamList[n]:(a=game.ChallengeCbpRoleInfo.get(),t.cloneSetTeam.teamList.push(a)),a.isBattle=t.isBattlePos(e.type,n+1,e.maxBattle),a.isWaitBattle=t.isWaitBattlePos(e.type,n+1,e.maxBattle);if(e.maxPos<i){var o=t.cloneSetTeam.teamList.splice(e.maxPos,i-e.maxPos);for(n=0,s=o.length;n<s;n++)o[n].release();o=null}}else t.cloneSetTeam=t.createMyTeamInfo(e.type,e.maxPos,e.maxBattle);for(n=0,s=e.teamList.length;n<s;n++){var r=t.cloneSetTeam.teamList[n],g=e.teamList[n];r&&g&&(r.id=g.id,r.type=g.type,r.lv=g.lv,r.power=g.power,r.isBattle=g.isBattle,r.isWaitBattle=g.isWaitBattle,r.hp=g.hp,r.hpMax=g.hpMax,r.name=g.name)}},getIsExist:function(e,t){for(var a=0,i=t.length;a<i;a++){if(t[a].id==e)return!0}return!1},delRoleInfo:function(e,t){for(var a=-1,i=0,n=e.teamList.length;i<n;i++){var s=e.teamList[i];s.id==t&&(a=i),0<=a&&(i+1<n?this.replaceRoleInfo(s,e.teamList[i+1]):this.restRoleInfo(s))}},addRoleInfo:function(e,t){t.type;for(var a,i=0,n=e.teamList.length;i<n;i++)if((a=e.teamList[i])&&!a.id)return a.id=t.id,a.type=t.type,a.lv=t.lv,a.power=t.power,a.hp=t.hp,a.hpMax=t.hpMax,a.name=t.name,!0;return!1},replaceRoleInfo:function(e,t){e.id=t.id,e.type=t.type,e.lv=t.lv,e.power=t.power,e.hp=t.hp,e.hpMax=t.hpMax,e.name=t.name},getCurLevel:function(){return this.levelMap.get(this.curLevelId)},getIsAllDie:function(){var e,t,a,i;for(e=0,a=this.myTeamList.length;e<a;e++){var n=this.myTeamList[e];for(t=0,i=n.teamList.length;t<i;t++){var s=n.teamList[t];if(0<s.id&&0<s.hp)return!1}}return!0},getCurMaxRestCount:function(){for(var e=0,t=game.ChangbanpoResetCfg.getDatas(),a=0,i=t.length;a<i;a++)t[a].vipLv<=game.mainRoleData.vipLevel&&(e=t[a].num);return e},getNextRestVip:function(){for(var e=0,t=game.ChangbanpoResetCfg.getDatas(),a=0,i=t.length;a<i;a++)if(t[a].vipLv>game.mainRoleData.vipLevel)return e=t[a].vipLv;return e},getCurRoleLvBoxAward:function(){for(var e,t,a=game.mainRoleData.lv,i=game.challengeCbpData.curSelectEvent.id,n=game.ChangbanpoBoxCfg.getDatas(),s=0,o=n.length;s<o;s++)if(i==(e=n[s]).id&&a<=e.level)return t=e;return t},getAllBoxCanReceive:function(){for(var e,t=0,a=this.levelList.length;t<a;t++)if((e=this.levelList[t]).state&&e.eventInfo.type==game.ChallengeCbpMapEventType.BOX&&!e.eventInfo.state)return!0;return!1},getAllTeamCanBattle:function(){for(var e=b8e.Enum.getList(game.ChallengeCbpRoleType),t=e.length,a=void 0,i=0;i<t;i++)if(a=e[i],this.canBattle(a.value))return!0;return!1},canBattle:function(e){var t,a,i,n,s=null,o=!1,r=game.ChallengeCbpRoleType;switch(e){case r.ROLE:o=!0;break;case r.Partner:}if(o)return!1;for(t=0,i=this.myTeamList.length;t<i;t++)if(e==(s=this.myTeamList[t]).type)for(a=0,n=s.teamList.length;a<n;a++)if(0==s.teamList[a].id)return!0;return!1},checkMyTeamAlert:function(){for(var e=0,t=this.myTeamList.length;e<t;e++)this.myTeamList[e].alert=this.canBattle(this.myTeamList[e].type)},setSweeping:function(e){for(var t,a=0,i=this.levelList.length;a<i;a++)(t=this.levelList[a]).id<=e&&(t.state=1)},addWinCount:function(){this.winCount++}});game.challengeCbpData=game.challengeCbpData||new e}(),function(){var e=game.Control.extends({init:function(){this.alertOptions={lang:5924,langArgs:null,okcb:this.onClickGameAlert,thisArg:this,args:null}},ipc:function(){this.evts={},this.handels={ChangbanpoBuffResp:this.changbanpoBuffResp,ChangbanpoRefreshBuffResp:this.changbanpoRefreshBuffResp}},changbanpoRefreshBuffResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoRefreshBuffResponse);if(0<t.code){game.notice.noticeError(t.code)}else{game.challengeCbpData.levelMap.get(t.id).eventInfo.value=t.buff,this.send(this.Evts.V_BUFF_UPDATE)}},changbanpoBuffResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoBuffResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.challengeCbpData.levelMap.get(t.id);if(a){a.eventInfo.state=t.buffId;var i=game.ChangbanpoBuffCfg.getData(t.buffId);i.type==game.ChallengeCbpBuffType.ATK&&(game.challengeCbpData.buffInfo.atk+=i.value/100),i.type==game.ChallengeCbpBuffType.DEF&&(game.challengeCbpData.buffInfo.def+=i.value/100),i.type==game.ChallengeCbpBuffType.HP&&(game.challengeCbpData.buffInfo.hp+=i.value/100),this.dpt(this.Evts.C_BUFF_UPDATE),this.send(this.Evts.V_BUFF_UPDATE)}}},hpNode:function(){var e=game.challengeCbpData.curSelectEvent;if(0<game.challengeCbpData.curSelectEvent.state)game.notice.show(game.Lang.get(5908));else{var t=e.value.split("|");this.alertOptions.langArgs=[game.Lang.get(9398)],this.alertOptions.args=[e.id,parseInt(t[2])],game.alert.showTwo(this.alertOptions)}},atkNode:function(){var e=game.challengeCbpData.curSelectEvent;if(0<game.challengeCbpData.curSelectEvent.state)game.notice.show(game.Lang.get(5908));else{var t=e.value.split("|");this.alertOptions.langArgs=[game.Lang.get(9399)],this.alertOptions.args=[e.id,parseInt(t[0])],game.alert.showTwo(this.alertOptions)}},defNode:function(){var e=game.challengeCbpData.curSelectEvent;if(0<game.challengeCbpData.curSelectEvent.state)game.notice.show(game.Lang.get(5908));else{var t=e.value.split("|");this.alertOptions.langArgs=[game.Lang.get(9400)],this.alertOptions.args=[e.id,parseInt(t[1])],game.alert.showTwo(this.alertOptions)}},refreshBtn:function(){var e=game.challengeCbpData.curSelectEvent.id;this.sender.ChangbanpoRefreshBuffReq(e)},notify:function(){},onClickGameAlert:function(e,t){this.sender.ChangbanpoBuffReq(e,t)}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoBuffReq:this.changbanpoBuffReq,ChangbanpoRefreshBuffReq:this.changbanpoRefreshBuffReq}},changbanpoRefreshBuffReq:function(e){var t=game.pb.ChangbanpoRefreshBuffRequest;t.id=e,this.write(t)},changbanpoBuffReq:function(e,t){if(e&&t){var a=game.pb.ChangbanpoBuffRequest;a.id=e,a.buffId=t,this.write(a)}}});b8e.module.registerControl(game.ME.ChallengeCbpBuff,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){},touch:function(){game.module.hide(game.ME.ChallengeCbpBuffTips)}});b8e.module.registerControl(game.ME.ChallengeCbpBuffTips,e,game.ChallengeCbpEvts)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.CHALLENGE,game.SAE.HOME),this.spotCbpTabAlert=game.spotAlert.set(game.SAE.CHALLENGE_CBP,game.SAE.CHALLENGE)},triggerOpen:function(e){e==this.moduleEnum&&game.challengeCbpData.initMyTeam()},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={ChangbanpoDataResp:this.changbanpoDataResp}},resetDaily:function(){game.moduleOpen.checkOpen(game.ME.ChallengeCbp)},changbanpoDataResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoDataResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.challengeCbpData.updateAllLevelData(t),this.dpt(this.Evts.C_UPDATE_DATA)},btn_1:function(){this.selectToggle(0)},btn_2:function(){this.selectToggle(1)},btn_3:function(){this.selectToggle(2)},selectToggle:function(e){this.send(this.Evts.V_TOGGLECHANGE,e)},notify:function(){}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.ChallengeCbp,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.spotCbpBoxAlert=game.spotAlert.set(game.SAE.CHALLENGE_CBP_BOX,game.SAE.CHALLENGE_CBP)},ipc:function(){var e=this;e.evts={ChallengeCbp:{C_UPDATE_DATA:e.cpbMapUpdate},EnemyTeam:{C_UPDATE_CHALLENGE:e.cpbMapUpdate},RestLevelAlert:{C_REST_UPDATE:e.cpbMapUpdate},MysticShop:{C_BUY_UPDATE:e.cpbMapUpdate},ChallengeCbpBuff:{C_BUFF_UPDATE:e.cpbMapUpdate}},e.gevts={InstanceEvts:{G_STOP_PLAY:e.stopPlay}},e.handels={ChangbanpoCollectResp:e.changbanpoCollectResp,ChangbanpoQuickResp:e.changbanpoQuickResp}},stopPlay:function(e){var t=this.data=e.data;if(t&&t.type==game.InstanceType.CBP&&t.isWin){var a=game.challengeCbpData.levelMap.get(t.levelId);if(a){var i=a.eventInfo;switch(i.type){case game.ChallengeCbpMapEventType.SHOP:game.challengeCbpData.curSelectEvent=i,game.module.show(game.ME.MysticShop);break;case game.ChallengeCbpMapEventType.BUFF:game.challengeCbpData.curSelectEvent=i,game.module.show(game.ME.ChallengeCbpBuff)}}}},checkBoxAlert:function(){this.spotCbpBoxAlert.alert=game.challengeCbpData.getAllBoxCanReceive()},cpbMapUpdate:function(){this.checkBoxAlert(),this.send(this.Evts.V_MAP_UPDATE)},changbanpoQuickResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoQuickResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.challengeCbpData.lastId=0,game.challengeCbpData.setSweeping(t.id),game.challengeCbpData.setCurSelectLevel(),this.checkBoxAlert(),this.send(this.Evts.V_MAP_UPDATE)},changbanpoCollectResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoCollectResponse);if(0<t.code){game.notice.noticeError(t.code)}else if(t.ids&&t.ids.length){for(var a=0,i=t.ids.length;a<i;a++){var n=game.challengeCbpData.levelMap.get(t.ids[a]);n&&(n.eventInfo.state=1)}this.checkBoxAlert(),this.send(this.Evts.V_MAP_UPDATE)}},clickMapItem:function(e){var t=game.challengeCbpData.getCurLevel();e.state?game.notice.show(game.Lang.get(5909)):e.id==t.id?game.module.show(game.ME.EnemyTeam):game.notice.show(game.Lang.get(5910))},clickMapBox:function(e){if(game.challengeCbpData.curSelectEvent=e.eventInfo,e.state)if(e.eventInfo.state)game.notice.show(game.Lang.get(5911));else{var t=[e.id];this.sender.ChangbanpoCollectReq(t)}else game.module.show(game.ME.PreviewAward)},clickMapBuff:function(e){game.challengeCbpData.curSelectEvent=e.eventInfo,e.state?e.eventInfo.state?game.notice.show(game.Lang.get(5912)):game.module.show(game.ME.ChallengeCbpBuff):game.notice.show(game.Lang.get(5910))},clickMapShop:function(e){game.challengeCbpData.curSelectEvent=e.eventInfo,e.state?e.eventInfo.state?game.notice.show(game.Lang.get(5913)):game.module.show(game.ME.MysticShop):game.notice.show(game.Lang.get(5914))},buffBtn:function(){game.module.show(game.ME.ChallengeCbpBuffTips)},autoGet:function(){for(var e,t=game.challengeCbpData.levelList,a=[],i=0,n=t.length;i<n;i++)(e=t[i]).state&&(e.eventInfo.state||e.eventInfo.type!=game.ChallengeCbpMapEventType.BOX||a.push(e.eventInfo.id));a.length?this.sender.ChangbanpoCollectReq(a):game.notice.show(game.Lang.get(5915))},autoChallenge:function(){var e=game.challengeCbpData.getCurLevel();game.challengeCbpData.lastId>=e.id?this.sender.ChangbanpoQuickReq():game.notice.show(game.Lang.get(5916))},exchangeBtn:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.XUEZHAN_SHOP)},lookTeamBtn:function(){game.module.show(game.ME.ChallengeTeam)},restBtn:function(){for(var e,t=game.challengeCbpData.levelList,a=!1,i=(game.challengeCbpData.getCurLevel(),0),n=t.length;i<n;i++)(e=t[i]).state&&(e.eventInfo.state||e.eventInfo.type!=game.ChallengeCbpMapEventType.BOX||(a=!0));a?game.notice.show(game.Lang.get(5918)):game.module.show(game.ME.RestLevelAlert)},notify:function(e,t){switch(e){case this.Evts.C_CLICK_MAP_ITEM:this.clickMapItem(t);break;case this.Evts.C_CLICK_MAP_BOX:this.clickMapBox(t);break;case this.Evts.C_CLICK_MAP_BUFF:this.clickMapBuff(t);break;case this.Evts.C_CLICK_MAP_SHOP:this.clickMapShop(t)}}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoCollectReq:this.changbanpoCollectReq,ChangbanpoQuickReq:null}},changbanpoCollectReq:function(e){var t=game.pb.ChangbanpoCollectRequest;t.ids=e,this.write(t)}});b8e.module.registerControl(game.ME.ChallengeCbpMap,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={ChangbanpoReviveResp:this.changbanpoReviveResp}},changbanpoReviveResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoReviveResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.challengeCbpData.reviveCount++,game.module.hide(game.ME.ChallengeCbpRenascence),this.dpt(this.Evts.C_RENASCENCE_UPDATE)},notify:function(){},leftBtn:function(){game.module.show(game.ME.ChallengeTeam),game.module.hide(game.ME.ChallengeCbpRenascence)},rightBtn:function(){game.ChangbanpoMiscCfg.getData("cbpReviveCost").value.split("|").length>game.challengeCbpData.reviveCount?this.sender.ChangbanpoReviveReq():game.notice.show(game.Lang.get(5919))}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoReviveReq:null}}});b8e.module.registerControl(game.ME.ChallengeCbpRenascence,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={ChangbanpoTeamSettingResp:this.changbanpoTeamSettingResp}},changbanpoTeamSettingResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoTeamSettingResponse);if(0<t.code){game.notice.noticeError(t.code)}else this.dpt(this.Evts.C_SETTEAM_UPDATE_DATA)},notify:function(e,t){switch(e){case this.Evts.C_SELECT_ROLE:this.selectRoleInfo(t)}},selectRoleInfo:function(e){var t=game.challengeCbpData.cloneSetTeam;0<e.id&&e.hp==e.hpMax?game.challengeCbpData.getIsExist(e.id,t.teamList)?(game.challengeCbpData.delRoleInfo(t,e.id),this.send(this.Evts.V_SETTEAM_UPDATE_DATA)):t.getBattleCount()<t.maxPos?(game.challengeCbpData.addRoleInfo(t,e),this.send(this.Evts.V_SETTEAM_UPDATE_DATA)):game.notice.show(game.Lang.get(5920)):game.notice.show(game.Lang.get(5921))},saveBtn:function(){for(var e=[],t=game.challengeCbpData.cloneSetTeam,a=void 0,i=0,n=t.teamList.length;i<n;i++)(a=t.teamList[i])&&a.id&&e.push(a.id);this.sender.ChangbanpoTeamSettingReq(t.type,e),game.module.hide(game.ME.ChallengeSetTeam)}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoTeamSettingReq:this.changbanpoTeamSettingReq}},changbanpoTeamSettingReq:function(e,t){var a=game.pb.ChangbanpoTeamSettingRequest;a.type=e,a.ids=t,this.write(a)}});b8e.module.registerControl(game.ME.ChallengeSetTeam,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){this.spotCbpTeamAlert=game.spotAlert.set(game.SAE.CHALLENGE_CBP_TEAM,game.SAE.CHALLENGE_CBP)},ipc:function(){this.evts={ChallengeCbp:{C_UPDATE_DATA:this.cpbTeamUpdate},ChallengeSetTeam:{C_SETTEAM_UPDATE_DATA:this.cpbTeamUpdate},EnemyTeam:{C_UPDATE_CHALLENGE:this.cpbTeamUpdate},ChallengeCbpRenascence:{C_RENASCENCE_UPDATE:this.cpbTeamUpdate},RestLevelAlert:{C_REST_UPDATE:this.cpbTeamUpdate}},this.handels={ChangbanpoTeamResp:this.changbanpoTeamResp}},cpbTeamUpdate:function(){},changbanpoTeamResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoTeamResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.challengeCbpData.updateMyTeam(t.team),game.challengeCbpData.checkMyTeamAlert(),this.checkTeamAlert(),this.send(this.Evts.V_SETTEAM_UPDATE_DATA)},checkTeamAlert:function(){this.spotCbpTeamAlert.alert=game.challengeCbpData.getAllTeamCanBattle()},notify:function(e,t){switch(e){case this.Evts.C_SELECT_TEAM:game.challengeCbpData.curSelectSetTeam=t,game.challengeCbpData.setCloneSetTeam(game.challengeCbpData.curSelectSetTeam),game.module.show(game.ME.ChallengeSetTeam);break;case this.Evts.C_GET_MYTEAM:}}}),t=game.Sender.extends({ipc:function(){this.msg={}}});b8e.module.registerControl(game.ME.ChallengeTeam,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={ChallengeCbpRenascence:{C_RENASCENCE_UPDATE:this.renascenceUpdate}},this.handels={ChangbanpoChallengeResp:this.changbanpoChallengeResp}},renascenceUpdate:function(){if(game.playBack.isInstanceFighting(!0));else game.sceneData.isGuildMap()||this.sender.ChangbanpoChallengeReq()},changbanpoChallengeResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoChallengeResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.challengeCbpData.getCurLevel(),i={type:game.InstanceType.CBP,rewards:t.useritem,exp:0,isWin:t.battlelog.win,levelId:a.id};game.playBack.play(t.battlelog,i),t.enemy&&game.challengeCbpData.updateLevelTeam(a,t.enemy),t.battlelog.win&&(a.state=1,game.challengeCbpData.setCurSelectLevel(),game.challengeCbpData.addWinCount()),this.dpt(this.Evts.C_UPDATE_CHALLENGE)}},notify:function(e){e},challengeBtn:function(){if(game.challengeCbpData.getIsAllDie())game.module.show(game.ME.ChallengeCbpRenascence);else{if(game.playBack.isInstanceFighting(!0)){return}if(game.sceneData.isGuildMap())return;this.sender.ChangbanpoChallengeReq()}game.module.hide(game.ME.EnemyTeam)}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoChallengeReq:null}}});b8e.module.registerControl(game.ME.EnemyTeam,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={ChangbanpoBuyResp:this.changbanpoBuyResp}},changbanpoBuyResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoBuyResponse);if(0<t.code){game.notice.noticeError(t.code)}else{var a=game.challengeCbpData.levelMap.get(t.id);a&&(a.eventInfo.state=1,this.dpt(this.Evts.C_BUY_UPDATE)),game.module.hide(game.ME.MysticShop),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeConsume)}},notify:function(){},closeBtn:function(){game.module.hide(game.ME.MysticShop)},buyBtn:function(){game.challengeCbpData.curSelectEvent&&this.sender.ChangbanpoBuyReq(game.challengeCbpData.curSelectEvent.id)}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoBuyReq:this.changbanpoBuyReq}},changbanpoBuyReq:function(e){var t=game.pb.ChangbanpoBuyRequest;t.id=e,this.write(t)}});b8e.module.registerControl(game.ME.MysticShop,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.Control.extends({});b8e.module.registerControl(game.ME.PreviewAward,e,game.ChallengeCbpEvts)}(),function(){var e=game.Control.extends({init:function(){},ipc:function(){this.evts={},this.handels={ChangbanpoResetResp:this.changbanpoResetResp}},changbanpoResetResp:function(e){var t=e.readProtobuf(game.pb.ChangbanpoResetResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.challengeCbpData.resetCount++,game.challengeCbpData.updateAllLevelData(t),game.module.hide(game.ME.RestLevelAlert),this.dpt(this.Evts.C_REST_UPDATE)},notify:function(){},leftBtn:function(){game.module.showToggle(game.ME.RechargeHall,game.RechargeHallType.VIP),game.module.hide(game.ME.RestLevelAlert)},rightBtn:function(){game.challengeCbpData.getCurMaxRestCount()<=game.challengeCbpData.resetCount?game.notice.show(game.Lang.get(5922)):this.sender.ChangbanpoResetReq()}}),t=game.Sender.extends({ipc:function(){this.msg={ChangbanpoResetReq:null}}});b8e.module.registerControl(game.ME.RestLevelAlert,e,game.ChallengeCbpEvts,t)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(138)},init:function(){},onShow:function(){this.updateData()},onHide:function(){},updateData:function(){var e=this.skin,t=game.challengeCbpData.buffInfo,a=10<t.hp?10:t.hp,i=10<t.atk?10:t.atk,n=10<t.def?10:t.def;e.spriteNumLab_1.string="+"+a+"%",e.spriteNumLab_2.string="+"+i+"%",e.spriteNumLab_3.string="+"+n+"%"},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.ChallengeCbpBuffTips,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(139)},init:function(){},notify:function(e){switch(e){case this.Evts.V_BUFF_UPDATE:this.updateView()}},onShow:function(){this.updateView()},onHide:function(){},updateView:function(){var e,t=this.skin,a=game.ChangbanpoMiscCfg.getData("cbpBuffRefreshCost"),i=game.challengeCbpData.curSelectEvent,n=0<i.state,s=i.value.split("|"),o=i.state+"";switch(t.discountNum.string=a.value,e=game.ChangbanpoBuffCfg.getData(parseInt(s[2])),t.hpAddLab.string="+"+e.value/100+"%",t.hpAddLab_1.string="+"+e.value/100+"%",e=game.ChangbanpoBuffCfg.getData(parseInt(s[0])),t.atkAddLab.string="+"+e.value/100+"%",t.atkAddLab_1.string="+"+e.value/100+"%",e=game.ChangbanpoBuffCfg.getData(parseInt(s[1])),t.defAddLab.string="+"+e.value/100+"%",t.defAddLab_1.string="+"+e.value/100+"%",t.refreshBtn.node.active=!n,t.refreshGrayBtn.node.active=n,t.hpNode.node.active=o!=s[2],t.hpGrayNode.node.active=o==s[2],t.atkAddLab.node.active=o!=s[0],t.atkGrayNode.node.active=o==s[0],t.defAddLab.node.active=o!=s[1],t.defGrayNode.node.active=o==s[1],t.toSelect.node.active=n,o){case s[2]:t.toSelect.x=t.hpNode.x;break;case s[0]:t.toSelect.x=t.atkNode.x;break;case s[1]:t.toSelect.x=t.defNode.x}},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.ChallengeCbpBuff,e)}(),function(){var e;e=game.Widget.extends({_showModel:!1,isInit:!1,levelInfo:null,ctor:function(){this._super(140)},init:function(){this.isInit=!0},onShow:function(){this.levelInfo&&this.updateData()},setData:function(e){this.levelInfo=e,this.isInit&&this.updateData()},updateData:function(){var e=this.skin,t=this.levelInfo,a=0<t.state,i=0<t.eventInfo.state;e.box.node.active=!i,e.boxOpen.node.active=i,e.redPoint1.node.active=a&&!i},box:function(){this.send(game.ChallengeCbpEvts.C_CLICK_MAP_BOX,this.levelInfo)},hide:function(){game.viewModule.removeModule(this),this._super()}}),b8e.RC("$$game","$$ChallengeCbpMapBox",e)}(),function(){var e;e=game.Widget.extends({_showModel:!1,isInit:!1,levelInfo:null,mapItem:null,ctor:function(){this._super(141)},init:function(){var e=this.skin;this.mapItem=b8e.Sprite.get(),this.mapItem.setAnchor(.5,0),this.mapItem.addToParent(e.mapNode),this.isInit=!0},onShow:function(){this.levelInfo&&this.updateData()},setData:function(e){this.levelInfo=e,this.isInit&&this.updateData()},updateData:function(){var e=this.skin,t=game.challengeCbpData.getCurLevel(),a=this.levelInfo,i="",n=!1;a.id==t.id&&(i=game.ResCfg.getUrl(118,a.id)),a.state&&(n=!0,i=game.ResCfg.getUrl(117,a.id)),a.id>t.id&&(i=game.ResCfg.getUrl(116,a.id)),this.mapItem.loadTexture(i),e.toPass.node.active=n,e.titleBgGray.node.active=n,e.titleLab.string=this.levelInfo.cfg.name},mapNode:function(){this.send(game.ChallengeCbpEvts.C_CLICK_MAP_ITEM,this.levelInfo)},hide:function(){game.viewModule.removeModule(this),this._super()}}),b8e.RC("$$game","$$ChallengeCbpMapItem",e)}(),function(){var e;e=game.Widget.extends({_showModel:!1,isInit:!1,levelInfo:null,model:null,ctor:function(){this._super(142)},init:function(){var e=this.skin;this.model=new game.SurfaceModel,this.model.addToParent(e.modelBtn),this.model.initModel(),this.isInit=!0},onShow:function(){this.levelInfo&&this.updateData()},setData:function(e){this.levelInfo=e,this.isInit&&this.updateData()},updateData:function(){var e=this.levelInfo.cfg;e&&game.AvatarUtil.updateModel(e,this.model,e.modelType)},modelBtn:function(){this.levelInfo.eventInfo.type==game.ChallengeCbpMapEventType.BUFF?this.send(game.ChallengeCbpEvts.C_CLICK_MAP_BUFF,this.levelInfo):this.levelInfo.eventInfo.type==game.ChallengeCbpMapEventType.SHOP&&this.send(game.ChallengeCbpEvts.C_CLICK_MAP_SHOP,this.levelInfo)},hide:function(){game.viewModule.removeModule(this),this._super()}}),b8e.RC("$$game","$$ChallengeCbpMapModel",e)}(),function(){var e;e=game.Widget.extends({_showModel:!1,icon:null,_init:!1,ctor:function(){this._super(143)},init:function(){this._init=!0;var e=this.curLevelAnim=b8e.Animator.get(game.AnimType.UI_EFFECT,1);e.addToParent(this.skin.anim),e.load(game.ResCfg.getUrl(5019,2002)),e.setScale(1,1),e.setVisible(!0)},onShow:function(){this.updateView()},updateView:function(){var e=this;if(e._init){var t=e.skin;e.icon||(e.icon=b8e.Sprite.get(),e.icon.setAnchor(.5,.5),e.icon.addToParent(t.icon),e.icon.setSize(75,75)),game.challengeCbpData.getCurLevel().state?(e.curLevelAnim.active=!1,e.curLevelAnim.stop()):(e.curLevelAnim.active=!0,e.curLevelAnim.play()),e.icon&&e.icon.loadTexture(game.ResCfg.getHead(game.mainRoleData.isMale))}}}),b8e.RC("$$game","$$ChallengeCbpMapRoleIcon",e)}(),function(){var e=game.View.extends({mapItemList:null,mapEventList:null,roleIcon:null,roleEntity:null,ctor:function(){this._super(144),this.spotAlerts={CHALLENGE_CBP_BOX:this.boxAlert,CHALLENGE_CBP_TEAM:this.teamAlert}},boxAlert:function(e){this.skin.boxRedPoint.node.active=e.alert},teamAlert:function(e){this.skin.redPoint2.node.active=e.alert},init:function(){var a=this,e=a.skin,t=a.mapLayer=b8e.BaseDisplay.get();t.addToParent(e.mapNode),a.mapItemList={},a.mapEventList={};var i=a.scene=b8e.SceneMgr.inst().createScene("cbpMap",t);i&&i._viewDisplay&&i._viewDisplay.setMask(cc.Mask.Type.RECT),i.setSize(e.mapNode.width,e.mapNode.height);var n=game.ResCfg.getUrl(10030);i.loadMap(n,function(e,t){if(e){b8e.error(e)}else a.loadMapComplete()},a);var s=i.getViewDisplay();b8e.evt.onTouchStart(s,a._onTouchBegan,a),b8e.evt.onTouchEnd(s,a._onTouchEnd,a),b8e.evt.onTouchCancel(s,a._onTouchCancelled,a),b8e.evt.onTouchMove(s,a._onTouchMove,a)},_onTouchBegan:function(e){var t=e.target,a=e.touch.getLocation();t.hitTest(a)&&(this._startTouch||(this._startTouch=!0,this._lastPos=a))},_onTouchEnd:function(e){var t=e.target,a=e.touch.getLocation();t.hitTest(a)&&(this._lastPos=null,this._touchMoved&&e.stopPropagation(),this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1))},_onTouchCancelled:function(){this._lastPos=null,this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1)},_onTouchMove:function(e){var t=this,a=e.touch.getLocation();if(t._lastPos){t.location=a,t.offsetMapX=t._lastPos.x-a.x,t.offsetMapY=a.y-t._lastPos.y,t._lastPos=t.location,t._endPos=t.location,t._touchMoved=!0;var i=t.scene.getCamera(),n=i.focusX+t.offsetMapX,s=i.focusY+t.offsetMapY;i.setFocus(n,s)}},loadMapComplete:function(){var e=this;e.scene.startRender();var t,a,i,n,s,o=game.challengeCbpData.levelList;if(o){for(var r=0,g=o.length;r<g;r++)s=o[r],(t=new game.ChallengeCbpMapItem).bindEnum=game.ME.ChallengeCbpMap,t.setData(s),(i=b8e.SceneDisplay.get()).clearDisabled=!0,i.addDisplay(t),i.setScenePosition(s.cfg.itemPoint[0],s.cfg.itemPoint[1]),e.scene.addDisplay(i,-1e4,!1,!1,!1),s.eventInfo.type==game.ChallengeCbpMapEventType.BOX&&((a=new game.ChallengeCbpMapBox).bindEnum=game.ME.ChallengeCbpMap,a.setData(s)),s.eventInfo.type!=game.ChallengeCbpMapEventType.SHOP&&s.eventInfo.type!=game.ChallengeCbpMapEventType.BUFF||((a=new game.ChallengeCbpMapModel).bindEnum=game.ME.ChallengeCbpMap,a.setData(s)),(n=b8e.SceneDisplay.get()).clearDisabled=!0,n.addDisplay(a),n.setScenePosition(s.cfg.eventPoint[0],s.cfg.eventPoint[1]),e.scene.addDisplay(n,-1e4,!1,!1,!1),e.mapItemList[s.id]=t,e.mapEventList[s.id]=a;e.roleIcon=new game.ChallengeCbpMapRoleIcon,e.roleEntity=b8e.SceneDisplay.get(),e.roleEntity.clearDisabled=!0,e.roleEntity.addDisplay(e.roleIcon),e.roleEntity.setScenePosition(0,0),e.scene.addDisplay(e.roleEntity,-1e4,!1,!1,!1),e.focusCurMap()}},focusCurMap:function(){var e=game.challengeCbpData.getCurLevel();e&&this.roleEntity&&(this.scene.getCamera().setFocus(e.cfg.itemPoint[0],e.cfg.itemPoint[1]),this.roleEntity.setScenePosition(e.cfg.itemPoint[0],e.cfg.itemPoint[1]-200))},updateMapView:function(){var e=game.challengeCbpData.levelList;if(e){for(var t,a,i,n=0,s=e.length;n<s;n++)i=e[n],(t=this.mapItemList[i.id])&&t.setData(i),(a=this.mapEventList[i.id])&&a.setData(i);var o=this.skin,r=game.challengeCbpData.getCurMaxRestCount(),g=r-game.challengeCbpData.resetCount;o.chongzhi.string=game.Lang.get(5923,g,r),o.autoChallenge.node.active=9<=game.mainRoleData.vipLevel&&10<=game.challengeCbpData.lastId,this.roleIcon&&this.roleIcon.updateView(),this.focusCurMap()}},notify:function(e){switch(e){case game.ChallengeCbpEvts.V_MAP_UPDATE:this.updateMapView()}},onShow:function(){game.challengeCbpData.setCurSelectLevel(),this.updateMapView()},onHide:function(){},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.ChallengeCbpMap,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(145)},init:function(){},onShow:function(){this.updateView()},onHide:function(){},updateView:function(){var e,t=this.skin,a=game.ChangbanpoMiscCfg.getData("cbpReviveCost").value.split("|");e=a.length>game.challengeCbpData.reviveCount?a[game.challengeCbpData.reviveCount]:a[a.length-1],t.str1.string=game.Lang.get(5820,e)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width)-4,.5*(t+this.height))}});b8e.module.registerView(game.ME.ChallengeCbpRenascence,e)}(),function(){var e;e=game.GameItemIcon.extends({battleIcon:null,nameLbl:null,lvLbl:null,data:null,ctor:function(){this._super(game.IconSizeEnum.GRID_SIZE_105),this.battleIcon=b8e.Sprite.get(),this.addChild(this.battleIcon)},setData:function(e){var t=this;(t.data=e)||t.clearData();var a=e.isBattle,i=e.isWaitBattle,n=game.ResCfg.getHead(e.isMale),s=game.HtmlUtil.getColorStrByQuality(1,e.name);t.setName(s),t.setBgImage(game.ResCfg.getQualityBg(1)),t.setIcon(n),t.addIconImage(),t.setLv(e.lv),a?(t.addBattleState(),t.battleIcon.loadTexture(game.ResCfg.getUrl(10008))):i?(t.addBattleState(),t.battleIcon.loadTexture(game.ResCfg.getUrl(10009))):t.removeBattleState()},setName:function(e){this.addNameLbl(),this.nameLbl.setText(e);var t=.5*this.nameLbl.width;this.nameLbl.setPosition(-t,-80)},addNameLbl:function(){this.nameLbl||(this.nameLbl=b8e.RichText.get(),this.nameLbl.setFontSize(20)),this.nameLbl.parent||(this.addChild(this.nameLbl),this.nameLbl.setVisible(!0))},removeNameLbl:function(){this.nameLbl&&this.nameLbl.removeFromParent()},setLv:function(e){this.addLvLbl();var t=game.ChallengeCbpRoleType;switch(this.data.type){case t.ROLE:case t.PET:this.lvLbl.setText("L"+e)}this.lvLbl.setPosition(0,-115)},addLvLbl:function(){var e=this;e.lvLbl||(e.lvLbl=b8e.Label.get(),e.lvLbl.setAnchor(.5,0),e.lvLbl.setSize(90,36),e.lvLbl.setOverflow(b8e.OverflowType.RESIZE_HEIGHT),e.lvLbl.setHorizontalAlign(b8e.HorizontalAlign.CENTER),e.lvLbl.setFontSize(32),e.lvLbl.setLineHeight(36),e.lvLbl.setFontFile(b8e.ResMgr.UI_ROOT+"/app/font/order/order.bbf")),e.lvLbl.parent||(e.addChild(e.lvLbl),e.lvLbl.setVisible(!0))},removeLv:function(){this.lvLbl&&this.lvLbl.removeFromParent()},addBattleState:function(){this.battleIcon||(this.battleIcon=b8e.Sprite.get()),this.battleIcon.parent||this.addChild(this.battleIcon),this.battleIcon.setPosition(-52,-8),this.battleIcon.setLocalZOrder(10)},sortLayer:function(){this.addIconImage(),this.addNameLbl()},removeBattleState:function(){this.battleIcon&&this.battleIcon.removeFromParent()},clearData:function(){this.setIcon(),this.setBgImage(),this.removeBattleState(),this.removeLv(),this.nameLbl&&this.nameLbl.removeFromParent()},calIconSize:function(){return game.IconSizeEnum.SIZE_74}}),b8e.RC("$$game","$$ChallengeCbpRoleIcon",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(146),this.toggles={toggle_btn_1:game.ME.ChallengeCbpMap,toggle_btn_2:game.ME.Occupied,toggle_btn_3:game.ME.FlagWar},this.spotAlerts={CHALLENGE_CBP:this.tabCbpAlert}},tabCbpAlert:function(e){this.skin.red_spot_1.node.active=e.alert},init:function(){},notify:function(e,t){switch(e){case game.ChallengeCbpEvts.V_TOGGLECHANGE:this.toggleSelect(t)}},onShow:function(){this.toggleSelect(1)},onHide:function(){},toggleSelect:function(e){if(2==e){if(!game.moduleOpen.checkOpen(game.ME.FlagWar))return void game.notice.show(8839);if(!game.teamLeagueData.checkTeamById(game.mainRoleData.roleId))return void game.notice.show(8835);if(!game.flagWarData.isOpen())return void game.notice.show(7252)}game.moduleOpen.checkOpenWithTips(this.getToggleIndex(e))&&this._super(e)}});b8e.module.registerView(game.ME.ChallengeCbp,e)}(),function(){var e;e=game.ListItem.extends({icon:null,progressMaxW:56,ctor:function(){this._super(147),this.setSize(100,166)},init:function(){this.icon=new game.ChallengeCbpRoleIcon,this.icon.addToParent(this.skin.icon)},setData:function(){var e=this,t=e.skin,a=0<e.data.id;e.data&&e.data.id?(e.icon.setData(e.data),t.iconBg.node.active=!1):(e.icon.clearData(),t.iconBg.node.active=!0),t.die.node.active=e.data.hp<=0&&a,t.hpMask.node.active=a,t.hpBg.node.active=a,t.hpMask.width=e.data.hp*(e.progressMaxW/e.data.hpMax)},touchIcon:function(){this.send(game.ChallengeCbpEvts.C_SELECT_ROLE,this.data)}}),b8e.RC("$$game","$$ChallengeRoleListitem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(148)},init:function(){var e=this.curTeamList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ChallengeRoleListitem,e.bindEnum=game.ME.ChallengeSetTeam,e.addToParent(this.skin.curTeamList),e.layout.spacingX=10,e.layout.paddingTop=-20,e.layout.paddingLeft=10;var t=this.waitTeamList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid);t.itemRender=game.ChallengeRoleListitem,t.bindEnum=game.ME.ChallengeSetTeam,t.layout.spacingY=20,t.layout.spacingX=15,t.addToParent(this.skin.waitTeamList)},notify:function(e){switch(e){case this.Evts.V_SETTEAM_UPDATE_DATA:this.updateView()}},onShow:function(){this.updateView()},updateView:function(){this.curTeamList.clear(),this.curTeamList.setData(game.challengeCbpData.cloneSetTeam.teamList);var e=game.challengeCbpData.getSelectListByType(game.challengeCbpData.cloneSetTeam.type);this.waitTeamList.clear(),this.waitTeamList.setData(e)},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.ChallengeSetTeam,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(149),this.setSize(540,237)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ChallengeRoleListitem,e.bindEnum=game.ME.ChallengeTeam,e.layout.spacingX=10,e.addToParent(this.skin.headList)},setData:function(){var e=this.skin,t=0,a=this.data,i=!0,n=game.ChallengeCbpRoleType;switch(a.type){case n.ROLE:i=!(t=5805);break;case n.Partner:t=5806}e.teamNameLab.string=game.Lang.get(t,a.getBattleCount(),a.maxPos),e.setBtn.node.active=i,e.setGrayBtn.node.active=!i,e.redPoint1.node.active=a.alert,this.list.setData(a.teamList)},setBtn:function(){this.send(game.ChallengeCbpEvts.C_SELECT_TEAM,this.data)}}),b8e.RC("$$game","$$ChallengeTeamItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(150)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.ChallengeTeamItem,e.bindEnum=game.ME.ChallengeTeam,e.addToParent(this.skin.listNode),e.layout.spacingY=5},notify:function(e){switch(e){case this.Evts.V_SETTEAM_UPDATE_DATA:this.updateView()}},onShow:function(){this.send(this.Evts.C_GET_MYTEAM),this.updateView()},updateView:function(){this.list.setData(game.challengeCbpData.myTeamList)},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.ChallengeTeam,e)}(),function(){var e=game.View.extends({_showModel:!0,iconImg:null,ctor:function(){this._super(151)},init:function(){var e=this.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);e.itemRender=game.ChallengeRoleListitem,e.layout.spacingX=13,e.bindEnum=game.ME.EnemyTeam,e.addToParent(this.skin.listNode),this.iconImg=b8e.Sprite.get(),this.iconImg.setAnchor(.5,.5),this.iconImg.setSize(75,75),this.iconImg.addToParent(this.skin.icon)},onShow:function(){this.updateView()},updateView:function(){var e=this.skin,t=game.challengeCbpData.getCurLevel();e.nameLab.string=t.teamInfo.name,e.powerLab.string=game.Lang.get(50136,t.teamInfo.power),e.lvLab.string=game.Lang.get(1007,t.teamInfo.lv),this.list.setData(t.teamInfo.teamList),this.iconImg.loadTexture(game.ResCfg.getHead(t.teamInfo.isMale))},onHide:function(){},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.EnemyTeam,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(152)},init:function(){var e=this.skin;(this.itemGrid=game.GridUtil.createItemIcon(game.IconSizeEnum.SIZE_84)).addToParent(e.icon)},onShow:function(){this.updateView()},onHide:function(){},updateView:function(){var e=this.skin,t=game.challengeCbpData.curSelectEvent,a=game.ChangbanpoGoodsCfg.getData(t.value);if(a){e.originalNum.string=a.showPrice,e.discountNum.string=a.price;var i=game.ItemUtil.createBaseItemInfo(a.item.Id,a.item.Num);game.GridUtil.setItemIcon(this.itemGrid,i,!1,game.IconLayoutEnum.SHOW_NUM)}},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width)-4,.5*(t+this.height))}});b8e.module.registerView(game.ME.MysticShop,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(153)},init:function(){this.firstList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),this.firstList.itemRender=game.PrizeListItem,this.firstList.layout.paddingLeft=0,this.firstList.layout.paddingRight=0,this.firstList.layout.paddingTop=0,this.firstList.layout.spacingX=10,this.firstList.layout.spacingX=30,this.firstList.addToParent(this.skin.listNode)},onShow:function(){this.updateView()},onHide:function(){},updateView:function(){this.skin;var e=game.challengeCbpData.getCurRoleLvBoxAward(),t=game.CfgUtil.getPrizeListInfo(e.boxAward);this.firstList.setData(t.items)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width)-4,.5*(t+this.height))}});b8e.module.registerView(game.ME.PreviewAward,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(154)},init:function(){},onShow:function(){this.updateView()},onHide:function(){},updateView:function(){var e=this.skin,t=game.ChangbanpoResetCfg.getData(game.challengeCbpData.resetCount+1),a=game.challengeCbpData.getCurMaxRestCount(),i=game.challengeCbpData.getNextRestVip();e.str1.string=game.Lang.get(5821,a-game.challengeCbpData.resetCount),t=t||game.ChangbanpoResetCfg.getData(a),e.str2.string=game.Lang.get(5822,t.goldNum),0<i?e.str3.string=game.Lang.get(5823,i):e.str3.node.active=!1},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width)-4,.5*(t+this.height))}});b8e.module.registerView(game.ME.RestLevelAlert,e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SELECT_ICON:-1,V2C_ACTIVE_CHIP:-1,C2V_SELECT_ICON:-1,C2V_ACTIVE_CHIP:-1,C2V_ACTIVE_POS:-1,C2V_FINISH_POS:-1,C_UPDATE_SPRITESTAT:-1,C_UPDATE_MODULEOPEN:-1,C_NEXT_SELECT:-1,C2C_CREATE_DATA:-1,C2C_TASK_FINISH:-1,C2C_GET_PARTNER:-1,C_SHOW_TIPS:-1}),b8e.RC("$$game","$$WuShengMainEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,LEVEL:1,INTENSIFY:2,STONE:3,TEMPER:4,POWER:5,CONSUME:6,MATERIAL:7,ARENA_FIGHT:8,WILD_BOSS:9,PET_LV:10,ROLE_BREAK:11,PET_BATTLE:12,BAOZANG:13,ZHANJIANG:14,BARBARIAN:15,TANXIAN:16,ZHAOQIN:17,PET_STAR:18,CSARENA:19,REWARDER:20,MYSTERYSHOP:21,REBORN:22,RECRUIT_RED:23,TASK:24,FAST_FIGHT:25,GUILD_DUNGEON:26}),b8e.RC("$$game","$$WuShengTaskType",e)}(),function(){var e;e=b8e.Object.extends({isActive:!1,isSelected:!1,id:0,setData:function(e){this.wsId=e.starMapId,this.pos=e.pos,this.id=e.id},getCfg:function(){return game.WuShengPosActivateCfg.getData(this.wsId,this.pos)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$WushengSlotInfo",e)}(),function(){var e;e=b8e.Object.extends({activeState:-1,canActive:!1,refresh:0,name:null,progress:0,setData:function(e){this.wsId=e.starMapId,this.taskId=e.taskId,this.pos=e.pos,this.cfg=game.WuShengCfg.getData(this.wsId,this.pos,this.taskId),this.refresh++},getCfg:function(){return this.cfg},clearData:function(){this.wsId=0,this.taskId=0,this.pos=0,this.cfg=null,this.refresh=0,this.activeState=-1,this.canActive=!1,this.name=null,this.progress=0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$WuShengTaskInfo",e)}(),function(){var e=b8e.Object.extends({curProgress:0,maxProgress:0,_starId:0,activeId:0,curId:{get:function(){return this.id+1}},init:function(){var e=this;e.id=0,e.slotPool=[],e.taskPool=[],e.chipIds=[],e.selectData={id:1,wsId:1,pos:1},e.maxData=b8e.createMap(),e.isSyscData=!1;var t=game.WuShengBtnCfg.getDatas();if(t){e.slotsIndex=[];for(var a=t.length,i=0;i<a;i++)e.slotsIndex[i]=i+1;e.maxPos=a}},setup:function(e){var t=this;if(e){t.id=e.id,t.chipIds=e.taskIds;var a=game.WuShengPosActivateCfg.getDataById(t.curId);a?t.selectData.id=t.curId:(a=game.WuShengPosActivateCfg.getDataById(t.id),t.selectData.id=t.id),t.selectData.wsId=a.starMapId,t.selectData.pos=a.pos,t.setMaxData(t.selectData),t.createSlots(),t.isSyscData=!0}},getCurStarPosActivate:function(){return game.WuShengPosActivateCfg.getData(this.selectData.wsId,this.selectData.pos)},activeChip:function(e){this.chipIds.push(e.taskId);for(var t=this.tasks,a=void 0,i=0,n=t.length;i<n;i++)if((a=t[i]).taskId==e.taskId){a.activeState=0,this.curProgress++;break}this.tasks.sort(this.taskSort)},checkIsLast:function(){return!game.WuShengPosActivateCfg.getDataById(this.id+1)},activePos:function(e){this.id=e.id;for(var t=void(this.chipIds.length=0),a=0,i=this.slots.length;a<i;a++)if((t=this.slots[a]).id==this.id){t.isActive=!0,t=this.slots[a+1];break}return t||(this.createSlots(),t=this.slots[0]),t},isPosActive:function(e,t){var a=game.WuShengCfg.getDatasByWsIdAndPos(e,t);if(!a||a.length<1)return!1;return this.chipIds.length>=a.length},_getWuShengId:function(e){var t=game.WuShengPosActivateCfg.getDataById(e);return t?t.starMapId:0},getWuShengId:function(){return this._getWuShengId(this.curId)},setMaxData:function(e){this.maxData.id=e.id,this.maxData.wsId=e.wsId,this.maxData.pos=e.pos},createSlots:function(){var e=this.getWuShengId(),t=game.WuShengPosActivateCfg.getDatasByWsId(e);this.slots||(this.slots=[]),this.clearSlots();for(var a=void 0,i=void 0,n=0,s=t.length;n<s;n++)i=t[n],(a=this._getSlotInfo()).setData(i),a.isActive=this.isActive(i.id),this.slots.push(a);this.slots.sort(function(e,t){return e.pos-t.pos})},isActive:function(e){return e<=this.id},_getSlotInfo:function(){return 0<this.slotPool.length?this.slotPool.shift():new game.WushengSlotInfo},_putSlotInfo:function(e){e&&this.slotPool.push(e)},clearSlots:function(){if(this.slots&&!(this.slots.length<1)){for(var e=0,t=this.slots.length;e<t;e++)this._putSlotInfo(this.slots[e]);this.slots.length=0}},selectMaxSlot:function(){this.setSelectSlot(this.maxData)},setSelectSlot:function(e){this.selectData.id=e.id,this.selectData.wsId=e.wsId,this.selectData.pos=e.pos;for(var t=void 0,a=e.pos,i=0,n=this.slots.length;i<n;i++)0<i&&(a=a+1>this.maxPos?1:a+1),this.slotsIndex[i]=a,(t=this.slots[i]).isSelected=t.pos==e.pos;return this.createTasks(e.wsId,e.pos),e},_getTaskInfo:function(){return 0<this.taskPool.length?this.taskPool.shift():new game.WuShengTaskInfo},_putTaskInfo:function(e){e&&this.taskPool.push(e)},clearTasks:function(){if(this.tasks&&!(this.tasks.length<1)){for(var e=0,t=this.tasks.length;e<t;e++)this._putTaskInfo(this.tasks[e]);this.tasks.length=0}},createTasks:function(e,t){var a=this,i=game.WuShengPosActivateCfg.getData(e,t);if(i){if(1<e){if(a.isActive(i.id))return void(a.curProgress=a.maxProgress);if(i.id>a.curId)return}a.tasks||(a.tasks=[]),a.clearTasks();var n=void(a.curProgress=0),s=void 0,o=game.WuShengCfg.getDatasByWsIdAndPos(e,t);a.maxProgress=o.length;for(var r=0;r<4;r++)n=o[r],(s=a._getTaskInfo()).clearData(),n&&(s.setData(n),a.isActive(i.id)||a.curId==i.id&&-1!=a.chipIds.indexOf(s.taskId)?(s.activeState=0,a.curProgress++):a.checkTask(n.starMapId,n.pos,n.taskId)?s.activeState=2:s.activeState=1,s.progress=s.activeState?a.getTaskprogress(s.wsId,s.pos,s.taskId):0),a.tasks.push(s);a.tasks.sort(a.taskSort)}},taskSort:function(e,t){return e.activeState>t.activeState?-1:e.activeState<t.activeState?1:e.taskId-t.taskId},getTask:function(e,t,a){if(!this.tasks||this.tasks.length<1)return null;for(var i=void 0,n=0,s=this.tasks.length;n<s;n++)if((i=this.tasks[n]).wsId==e&&i.pos==t&&i.taskId==a)return i;return null},getPower:function(){var e=0,t=this.selectData,a=void 0;if(this.isActive(t.id)){a=game.WuShengPosActivateCfg.getDataById(t.id);var i=game.WuShengPosActivateCfg.getDataById(t.id-1);e=a.power-(i?i.power:0)}else if(t.id==this.curId)for(var n=0,s=this.chipIds.length;n<s;n++)(a=game.WuShengCfg.getData(t.wsId,t.pos,this.chipIds[n]))&&(e+=a.power);return e},checkTask:function(e,t,a){var i=game.WuShengCfg.getData(e,t,a);if(!i)return!1;var n=game.WuShengPosActivateCfg.getData(e,t);if(!n)return!1;if(this.curId!=n.id)return!1;var s=game.WuShengTaskType,o=i.param,r=0;switch(i.taskTpye){case s.LEVEL:r=game.mainRoleData.lv;break;case s.INTENSIFY:r=game.equipForgeData.getAllLvNumByForgeType(game.EquipForgeType.INTENSIFY);break;case s.STONE:r=game.equipForgeData.getAllLvNumByForgeType(game.EquipForgeType.GEM);break;case s.TEMPER:r=game.equipForgeData.getAllLvNumByForgeType(game.EquipForgeType.REFINE);break;case s.POWER:r=game.mainRoleData.power;break;case s.CONSUME:r=game.itemData.consume;break;case s.MATERIAL:r=game.instFuncData.getCount();break;case s.ARENA_FIGHT:r=game.InsFunCountData.getChallengeCount(game.InsFunCountType.ARENA);break;case s.WILD_BOSS:r=game.InsFunCountData.getChallengeCount(game.InsFunCountType.WILDINS);break;case s.PET_LV:r=game.partnerData.getPartnerMaxLv();break;case s.ROLE_BREAK:var g=game.partnerData.getInfoById(1);g&&(r=g.breakLv);break;case s.PET_BATTLE:r=game.partnerData.getToBattleCount();break;case s.BAOZANG:r=game.zhuanJiData.maxSuccessId;break;case s.ZHANJIANG:r=game.zhanjiangData.getLayer();break;case s.BARBARIAN:r=game.barbarianData.maxLayer;break;case s.TANXIAN:r=game.exploreData.historyTimes;break;case s.ZHAOQIN:r=game.zhaoqinData.maxLayer;break;case s.PET_STAR:r=game.partnerData.getPartnerMaxStar();break;case s.CSARENA:r=game.csArenaData.historyTimes;break;case s.REWARDER:r=game.rewarderData.totalTimes;break;case s.MYSTERYSHOP:r=game.mystery2ShopData.buyTimes;break;case s.REBORN:r=game.partnerData.rebirthTimes;break;case s.RECRUIT_RED:r=game.recruitData.getRedTotalNum();break;case s.TASK:r=game.mainInstanceData.id;break;case s.FAST_FIGHT:r=game.mainInstanceData.quickBattleTotalTimes;break;case s.GUILD_DUNGEON:r=game.InsFunCountData.getChallengeCount(game.InsFunCountType.GUILDINS)}return o<=r},getTaskprogress:function(e,t,a){var i=game.WuShengCfg.getData(e,t,a);if(i){var n=game.WuShengTaskType,s=i.param;switch(i.taskTpye){case n.LEVEL:return s-game.mainRoleData.lv;case n.INTENSIFY:return s-game.equipForgeData.getAllLvNumByForgeType(game.EquipForgeType.INTENSIFY);case n.STONE:return s-game.equipForgeData.getAllLvNumByForgeType(game.EquipForgeType.GEM);case n.TEMPER:return s-game.equipForgeData.getAllLvNumByForgeType(game.EquipForgeType.REFINE);case n.POWER:return s-game.mainRoleData.power;case n.CONSUME:return s-game.itemData.consume;case n.MATERIAL:return s-game.instFuncData.getCount();case n.ARENA_FIGHT:return s-game.InsFunCountData.getChallengeCount(game.InsFunCountType.ARENA);case n.WILD_BOSS:return s-game.InsFunCountData.getChallengeCount(game.InsFunCountType.WILDINS);case n.PET_LV:return s-game.partnerData.getPartnerMaxLv();case n.ROLE_BREAK:var o=game.partnerData.getInfoById(1);return o?s-o.breakLv:0;case n.PET_BATTLE:return s-game.partnerData.getToBattleCount();case n.BAOZANG:return s-game.zhuanJiData.maxSuccessId;case n.ZHANJIANG:return s-game.zhanjiangData.getLayer();case n.BARBARIAN:return s-game.barbarianData.maxLayer;case n.TANXIAN:return s-game.exploreData.historyTimes;case n.ZHAOQIN:return s-game.zhaoqinData.maxLayer;case n.PET_STAR:return s-game.partnerData.getPartnerMaxStar();case n.CSARENA:return s-game.csArenaData.historyTimes;case n.REWARDER:return s-game.rewarderData.totalTimes;case n.MYSTERYSHOP:return s-game.mystery2ShopData.buyTimes;case n.REBORN:return s-game.partnerData.rebirthTimes;case n.RECRUIT_RED:return s-game.recruitData.getRedTotalNum();case n.TASK:return s-game.mainInstanceData.id;case n.FAST_FIGHT:return s-game.mainInstanceData.quickBattleTotalTimes;case n.GUILD_DUNGEON:return s-game.InsFunCountData.getChallengeCount(game.InsFunCountType.GUILDINS);default:return 0}}},checkActive:function(){var e=this;if(!e.isSyscData)return!1;if(e.isActive(e.curId))return!1;var t=game.WuShengPosActivateCfg.getDataById(e.curId);if(!t)return!1;if(e.isPosActive(t.starMapId,t.pos))return game.UpgradeUtil.checkItemList(t.costItem,1,!1);for(var a=!1,i=0,n=e.tasks.length;i<n;i++){var s=e.tasks[i];s.progress=s.activeState?e.getTaskprogress(s.wsId,s.pos,s.taskId):0,-1==e.chipIds.indexOf(s.taskId)&&e.checkTask(t.starMapId,t.pos,s.taskId)&&(s.activeState=2,a=a||!0)}return a},getNextActiveNum:function(){var e=game.WuShengPosActivateCfg.getDataById(this.curId);if(!e)return 0;var t=game.WuShengPosActivateCfg.getDatasByQuality(e.changeQuality);if(!t)return 0;t.sort(function(e,t){return e.id-t.id});for(var a=t.length,i=void 0,n=void 0,s=0;s<a;s++)if((i=t[s])&&this.curId==i.id){n=s;break}return a-n},selPosIsActive:function(){return this.selectData.id<=this.curId}});game.wushengData=game.wushengData||new e}(),function(){var e=game.Control.extends({init:function(){this.wsData=game.wushengData,this.wsData.init(),this.spotAlert=game.spotAlert.set(game.SAE.WUSHEN_MAIN_ALERT)},ipc:function(){var e=this;e.evts={Arena:{C2C_SYS_DATA_SUCCEED:e.checkAlert},MainRole:{C_LEVEL_UP:e.checkAlert,C_INIT_SERVER_DATA:e.checkAlert,C_INIT_MSIC_DATA:e.checkAlert,C_POWER_CHANGE:e.checkAlert},ZhuanJi:{C2C_SYSYN_DATA:e.checkAlert},ZhuanJiBattle:{C2C_CHALLENGE_SUCCEED:e.checkAlert},WildBossInfo:{C2C_UPDATE_CD:e.checkAlert},Partner:{C_INIT_DATA:e.checkAlert},InstanceMaterial:{C2C_UPDATE_FINISH_COUNT:e.checkAlert},Back:{C_UPDATE_AMOUNT:e.checkAlert,C_BACK_UPDATE_ITEMINFO:e.checkAlert},PartnerChange:{C_UPDATE_BATTLE:e.checkAlert},EquipForge:{C2C_FORGE_SUCCEED:e.checkAlert},PartnerBreak:{V_UPDATE_BREAK:e.checkAlert},MainInstance:{C_GET_MAIN_INSTANCE_AWARDS:e.checkAlert},Instance:{SYNC_INSTANCE_DATA:e.checkAlert},ZhanJiang:{C2C_UPDATE_LAYER:e.checkAlert},Barbarian:{C2C_UPDATE_BATTLE:e.checkAlert},Explore:{C2C_USE_THROW:e.checkAlert},ZhaoQin:{C2C_CHALLENGE_SUCCEED:e.checkAlert},PartnerStar:{C2C_UPDATE_STAR_TASK:e.checkAlert},CSArenaChallenge:{C2C_UPDATA_INFO:e.checkAlert},RewarderChoose:{C_UPDATE_VIEW:e.checkAlert},Mystery2Shop:{C2C_UPDATA_INFO:e.checkAlert},Sell:{PARTNER_REBORN_COMPLETE:e.checkAlert},Recruit:{C2C_UPDATE_FANLI_SCORE:e.checkAlert},Guaji:{C2C_UPDATE_QUICK:e.checkAlert},GuildTeam:{C2C_CHALLENGE_COUNT:e.checkAlert}},e.handels={StarMapModelResp:e.onWuShengModelRsp,StarMapFinishTaskResp:e.onWuShengChipActivateRep,StarMapPosActivateResp:e.onWuShengPosActivateRsp}},notify:function(e,t){switch(e){case this.Evts.V2C_SELECT_ICON:this.setSelectSlot(t.info,t.isShow);break;case this.Evts.V2C_ACTIVE_CHIP:this.activeChipBtn()}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.StarMapModelReq()},setSelectSlot:function(e,t){var a=1<arguments.length&&void 0!==t&&t;this.wsData.setSelectSlot(e),this.send(this.Evts.C2V_SELECT_ICON,a)},onWuShengModelRsp:function(e){var t=e.readProtobuf(game.pb.StarMapModel);if(0<t.code)game.notice.noticeError(t.code);else{this.wsData.setup(t),this.setSelectSlot(this.wsData.selectData),this.checkAlert(),this.dpt(this.Evts.C2C_CREATE_DATA,t)}},onWuShengChipActivateRep:function(e){var t=e.readProtobuf(game.pb.StarMapFinishTaskResponse);if(0<t.code)game.notice.noticeError(t.code);else{this.wsData.activeChip(t),this.checkAlert(),this.wsData.taskData&&this.wsData.taskData.cfg&&(game.awardsData.setItemsByArray(this.wsData.taskData.cfg.items),game.module.show(game.ME.AwardShowTip)),this.send(this.Evts.C2V_ACTIVE_CHIP),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeActivation)}},onWuShengPosActivateRsp:function(e){var t=e.readProtobuf(game.pb.StarMapPosActivateResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=this,i=a.wsData.activePos(t);a.wsData.setSelectSlot(i),a.wsData.setMaxData(a.wsData.selectData);var n=game.WuShengPosActivateCfg.getDataById(t.id);n&&(a.wsData.activeId=t.id,n.qualityLv?(game.module.hide(game.ME.ShareMain),game.module.show(game.ME.WushengQulity),a.dpt(a.Evts.C2C_TASK_FINISH)):(game.module.show(game.ME.WuShengActive),a.send(a.Evts.C2V_ACTIVE_POS)),n.moveTag&&a.send(a.Evts.C2V_FINISH_POS),game.FightAmount.inst().showTeamStatPower(),game.SoundEffectMgr.inst().playSoundByType(game.SoundEffectType.SoundTypeActivation))}},activeBtn:function(){var e=game.WuShengPosActivateCfg.getDataById(this.wsData.curId);e&&game.UpgradeUtil.checkItemList(e.costItem)&&this.sender.StarMapPosActivateReq(this.wsData.curId)},activeChipBtn:function(){this.sender.StarMapFinishTaskReq(this.wsData.taskData.taskId)},checkAlert:function(){var e=game.moduleOpen.checkOpen(game.ME.WuShengMain)&&game.wushengData.checkActive();(this.spotAlert.alert=e)&&this.dpt(this.Evts.C_SHOW_TIPS)},buff:function(){game.module.show(game.ME.WushengBuff)}}),t=game.Sender.extends({ipc:function(){this.msg={StarMapModelReq:null,StarMapFinishTaskReq:this.wuShengChipActivateReq,StarMapPosActivateReq:this.wuShengPosActivateReq}},wuShengChipActivateReq:function(e){var t=game.pb.StarMapFinishTaskRequest;t.taskId=e,this.write(t)},wuShengPosActivateReq:function(e){var t=game.pb.StarMapPosActivateRequest;t.id=e,this.write(t)}}),a=[game.ME.WuShengCollect,game.ME.WushengBuff,game.ME.WushengQulity,game.ME.WuShengActive];b8e.module.registerControl(game.ME.WuShengMain,e,game.WuShengMainEvts,t,a)}(),function(){var e=game.CultivateBaseModelView.extends({ctor:function(){this._super(1130)},init:function(){var e=this,t=e.skin;e.data=game.wushengData,e._taskList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e._taskList.itemRender=game.WuShengTaskItem,e._taskList.bindEnum=game.ME.WuShengMain,e._taskList.layout.paddingTop=0,e._taskList.layout.paddingLeft=12,e._taskList.addToParent(t.itemList),e.skin.modelNode.setLocalZOrder(75),e._icon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_84),e._icon.addToParent(t.itemIcon),e.effectInfos=game.WuShengBtnCfg.getDatas(),e.slotsItem=[];var a=game.mainRoleData.getDefaultCfg();a&&e.getComponent("modelNode").loadTexture(game.ResCfg.getUrl(115,a.model));for(var i=1;i<4;i++)e.getComponent("page_"+i).setLocalZOrder(4-i);e._pagePosX=[92,550,928]},notify:function(e,t){var a=this;switch(e){case a.Evts.C2V_SELECT_ICON:a.createSpriteStat(),a.createTask(),a.createSratMap(),a.setActiveBtnState(),a.playEffect(t);break;case a.Evts.C2V_ACTIVE_CHIP:case a.Evts.C2V_ACTIVE_POS:a.createSpriteStat(),a.setActiveBtnState(),a.setPath(),a.createTask(),a.updataSlot(),a.playEffect();break;case a.Evts.C2V_FINISH_POS:a.updataPageFinish(),a.moveStarMap()}},createList:function(){var e=this;if(!e.cloneIndex||e.cloneIndex.length<1){e.cloneIndex=[];for(var t=1,a=e.data.slotsIndex.length;t<=a;t++)e.cloneIndex.push(t)}if(!(1<game.wushengData.selectData.wsId)){var i=game.wushengData.slots;if(i)for(var n=void 0,s=0,o=i.length;s<o;s++)s<e.slotsItem.length?n=e.slotsItem[s]:((n=new game.WuShengSlotView).bindEnum=game.ME.WuShengMain,e.getComponent("slotNode"+(s+1)).addChild(n),e.slotsItem.push(n)),n.setData(i[s]),e.effectInfos[s]&&e.getComponent("slotNode"+(s+1)).setLocalZOrder(e.effectInfos[s].zIndex)}},onShow:function(){this.createList(),this.createSratMap(),this.setPath();var e=game.wushengData.selectData;this.send(this.Evts.V2C_SELECT_ICON,{info:e,isShow:!0})},setActiveBtnState:function(){var e=game.wushengData,t=e.selectData,a=game.WuShengCfg.getDatasByWsIdAndPos(t.wsId,t.pos),i=t.id==e.curId&&e.chipIds.length>=a.length;this.skin.costNode.active=i;var n=game.WuShengPosActivateCfg.getDataById(t.id);if(n){var s=n.costItem[0],o=game.ItemInfoCfg.getData(s.Id),r=game.ResCfg.getUrl(137,o.icon);this.getComponent("matCoinNode").loadTexture(r);var g=game.itemData.getNumById(s.Id);this.getComponent("matCostNumLab").setColor(g>=s.Num?game.Color.GREEN:game.Color.RED),this.getComponent("matCostNumLab").string=game.Lang.get(51308,g,s.Num),this.getComponent("redPoint").active=g>=s.Num}},setPath:function(){var e=game.wushengData,t=game.WuShengPosActivateCfg.getDataById(e.curId);if(t){var a=t.changeQuality;if(this.skin.pathBg.active=a<game.Quality.Q_COLORFUL,!(a>=game.Quality.Q_COLORFUL)){var i=e.getNextActiveNum(),n=void 0;n=a+1==game.Quality.Q_COLORFUL?game.Lang.get(53106):game.HtmlUtil.getText(game.HtmlUtil.getColorByQuality(a+1),game.Lang.get(9375+a)),this.skin.path.string=game.Lang.get(51309,i,n)}}},createSpriteStat:function(){var e=game.wushengData.selectData,t=game.WuShengPosActivateCfg.getData(e.wsId,e.pos);if(t){if(0<t.giveItem.length){var a=b8e.createMap();a.id=t.giveItem[0].Id,a.num=t.giveItem[0].Num;var i=game.ItemInfoCfg.getData(a.id);game.GridUtil.setItemIcon(this._icon,a,!1,game.IconLayoutEnum.SHOW_NONE),this.skin.itemName.string=game.HtmlUtil.getColorStrByQuality(i.quality,i.name)}if(t.showType){var n=game.AttrRulesCfg.getData(t.showType);this.skin.labSprite.string=game.HtmlUtil.getText(game.Color.BLACK,n.name)+game.HtmlUtil.getText(game.Color.GREEN,"+"+t.addSprite)}}},createTask:function(){this._taskList.setData(game.wushengData.tasks)},playEffect:function(e){var t=0<arguments.length&&void 0!==e&&e,a=this,i=game.WuShengMiscCfg.getData("effectSpeed");if(i)for(var n=game.wushengData.selectData,s=t?0:+i.value,o=void 0,r=void 0,g=void 0,l=void 0,c=0,h=void 0,m=0,u=a.cloneIndex.length;m<u;m++){m<a.slotsItem.length&&a.slotsItem[m].setSelectState(),l=m+1;for(var d=0;d<u;d++)a.cloneIndex[m]==a.data.slotsIndex[d]&&(g=d+1);if(l!=g){if(!c){h=a.data.maxPos-Math.abs(l-g);var f=Math.abs(l-h);c=Math.abs(g-h)<f?1:2}if(l=1==c?l+1>a.data.maxPos?1:l+1:l-1<=0?a.data.maxPos:l-1,r=a.effectInfos[l-1],(o=a.getComponent("slotNode"+a.cloneIndex[m])).setLocalZOrder(r.zIndex),b8e.Tween.get(o).to({scaleX:r.scaleX/100,scaleY:r.scaleY/100,x:r.posX,y:r.posY},s).call(a.moveComplete,a,[l,g,o,c,t]),a.cloneIndex[m]=a.data.slotsIndex[m],a.slotsItem[m]){var p=a.slotsItem[m].data;if(p&&n.pos==p.pos){var _=p.getCfg();a.skin.icon_star.loadTexture(game.ResCfg.getUrl(115,_.iconRes)),a.skin.starName.loadTexture(game.ResCfg.getUrl(115,_.nameRes))}}}}},moveComplete:function(e,t,a,i,n){var s=game.WuShengMiscCfg.getData("effectSpeed");if(s){var o=n?0:+s.value,r=void 0;e!=t&&(e=1==i?e+1>this.data.maxPos?1:e+1:e-1<=0?this.data.maxPos:e-1,r=this.effectInfos[e-1],a.setLocalZOrder(r.zIndex),b8e.Tween.get(a).to({scaleX:r.scaleX/100,scaleY:r.scaleY/100,x:r.posX,y:r.posY},o).call(this.moveComplete,this,[e,t,a,i]))}},onHide:function(){for(var e=void 0,t=0;t<this.data.maxPos;t++)(e=this.getComponent("slotNode"+(t+1)))&&b8e.Tween.kill(e);this._pageArray&&(this._pageArray.forEach(function(e,t){t.removeFromParent()}),this._pageArray.clear()),this.cloneIndex.length=0,game.wushengData.selectMaxSlot()},onStageResize:function(){this.setPosition(0,0)},createSratMap:function(){var e=this,t=game.wushengData.selectData;if(t){var a=t.wsId;if(a&&(e.skin.icon_star.active=1==a,e.skin.star_bg.active=1<a,e.getComponent("firstNode").active=1==a,e.getComponent("starNode").active=1<a,e.getComponent("titleBg").active=1<a,1!=a)){var i=game.WuShengCfg.getData(a,t.pos,1);if(i){e.getComponent("name").string=i.name,e.getComponent("firstNode").active=!1,e.getComponent("starNode").active=!0,e._pageArray||(e._pageArray=b8e.HashMap.get());for(var n=void 0,s=1,o=void 0,r=a;r<a+3;r++)(n=game.WuShengStarMapCfg.getData(r))&&((o=e._pageArray.get(r))||((o=new game.wushengStarItem).addToParent(e.getComponent("page_"+s)),e._pageArray.set(r,o)),1<s?e.getComponent("page_"+s).setScale(.9,.9):e.getComponent("page_"+s).setScale(1,1),e.getComponent("page_"+s).setPosition(e._pagePosX[s-1],0),o.setPageCfg(n),o.show(),s++)}}}},moveStarMap:function(){var e=game.WuShengMiscCfg.getData("mapSpeed");if(e){var t=+e.value;b8e.Tween.get(this.getComponent("page_1")).to({scaleX:1.1,scaleY:1.1,x:-560},t),b8e.Tween.get(this.getComponent("page_2")).to({scaleX:1,scaleY:1,x:92},t),b8e.Tween.get(this.getComponent("page_3")).to({x:550},t),b8e.Tween.get(this).wait(100+t).call(function(){this._pageArray&&(this._pageArray.forEach(function(e,t){t.removeFromParent()}),this._pageArray.clear()),this.createSratMap()},this)}},updataSlot:function(){if(1==game.wushengData.selectData.wsId)for(var e=game.wushengData.slots,t=void 0,a=0,i=e.length;a<i;a++)(t=this.slotsItem[a])&&t.setData(e[a]);else{var n=game.wushengData.selectData;if(!n)return;var s=n.wsId;if(!s)return;var o=this._pageArray.get(s);if(!o)return;o.updataPage()}},updataPageFinish:function(){var e=game.wushengData.selectData;if(e){var t=e.wsId;if(t){var a=this._pageArray.get(t-1);a&&a.updataAllFinish()}}},$$getWushengGotoItem:function(e){var t=this.getTaskItem(e);return t&&t.skin?t.skin.gotoBtn:null},$$getWushengActiveItem:function(e){var t=this.getTaskItem(e);return t&&t.skin?t.skin.activeBtn:null},getTaskItem:function(e){var t=game.wushengData.tasks;if(!this._taskList||!t)return null;if(e){var a=e.split(",");if(a.length<3)b8e.error("\u661f\u56fe\u6307\u5f15\u53c2\u6570\u4e0d\u8db3");else{var i=game.wushengData.getTask(+a[0],+a[1],+a[2]);if(i)return this._taskList.getItemRender(i);b8e.error("\u6307\u5f15\u4efb\u52a1\u4e3a\u7a7a")}}else b8e.error("\u661f\u56fe\u6307\u5f15\u53c2\u6570\u4e3a\u7a7a")}});b8e.module.registerView(game.ME.WuShengMain,e)}(),function(){var e;e=game.Widget.extends({isInitView:!1,ctor:function(){this._super(1131),this.setSize(104,104)},init:function(){this.isInitView=!0},onShow:function(){this.data&&this.updateData()},setData:function(e){this.data=e,this.isInitView&&this.updateData()},updateData:function(){var e=this.data;if(e){var t=e.getCfg();t&&(this.setSelectState(),this.getComponent("icon").loadTexture(game.ResCfg.getUrl(115,t.iconRes)),this.getComponent("name").loadTexture(game.ResCfg.getUrl(115,t.nameRes)),this.getComponent("mask").active=!e.isActive&&e.id!=game.wushengData.curId)}},setSelectState:function(){if(this.isInitView){var e=game.wushengData.selectData;this.skin.selectImg.active=e.pos==this.data.pos}},selectBtn:function(){var e=game.wushengData.selectData;e.wsId==this.data.wsId&&e.pos==this.data.pos||this.send(game.WuShengMainEvts.V2C_SELECT_ICON,{info:this.data})}}),b8e.RC("$$game","$$WuShengSlotView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(1132),this.setSize(296,106)},setData:function(e){var t=this,a=e.getCfg();if(t.getComponent("activeNode").active=!!a,t.getComponent("noActive").active=!a,a){t.data=e,t.skin.activeImg.active=0==e.activeState;var i=game.CCommonUtil.replaceNum(e.cfg.param),n=e.progress<=0?e.cfg.param:e.cfg.param-e.progress;n=game.CCommonUtil.replaceNum(n);var s=game.Lang.get(51581,n,i);s=game.HtmlUtil.getText(e.progress<=0?game.Color.GREEN:game.Color.RED,s),i||(s=""),t.skin.taskLab.string=game.HtmlUtil.getText(game.Color.BLACK,a.taskDesc),t.skin.taskDesc.string=s,t.skin.taskDesc.x=t.skin.taskLab.x+t.skin.taskLab.width+2;var o=game.wushengData.selPosIsActive();t.skin.activeBtn.active=e.progress<=0&&0!=e.activeState,t.skin.redPoint.active=t.skin.activeBtn.active&&o,t.skin.gotoBtn.active=0<e.progress,t.list||(t.list=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),t.list.itemRender=game.PrizeListItem,t.list.layout.spacingX=20,t.list.layout.paddingLeft=2,t.list.addToParent(t.skin.itemList)),a.items&&(t.prizeInfo||(t.prizeInfo=new game.ZhaoqinPrizeInfo),t.prizeInfo.setup(a.items),t.list.setData(t.prizeInfo.items))}},activeBtn:function(){game.wushengData.selPosIsActive()&&this.data.progress<=0&&0!=this.data.activeState?(game.wushengData.taskData=this.data,this.send(game.WuShengMainEvts.V2C_ACTIVE_CHIP)):game.notice.show(52251)},gotoBtn:function(){var e=this.data.getCfg();e&&(e.toggleIndex?game.module.showToggle(e.moduleEnum,e.toggleIndex):game.module.show(e.moduleEnum))}}),b8e.RC("$$game","$$WuShengTaskItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1350)},init:function(){this.spriteStat=game.SpriteStat.get()},onShow:function(){this.spriteStat&&this.spriteStat.clear(),this.setAttrPage()},setAttrPage:function(){var a=this,e=game.wushengData.selectData,t=game.WuShengPosActivateCfg.getDataById(e.id-1);if(t){a.spriteStat.addByCfg(t);var i=a.spriteStat.getSpriteStats(),n=void 0,s=1;i.forEach(function(e,t){n=game.AttrRulesCfg.getData(+e),a.getComponent("labSprite"+s).string=game.Lang.get(51577,n.name,t),s++},a),a.getComponent("spriteNode").active=!0}else a.getComponent("spriteNode").active=!1}});b8e.module.registerView(game.ME.WushengBuff,e)}(),function(){var e;e=game.Widget.extends({ctor:function(){this._super(1348)},init:function(){this.bindEnum=game.ME.WuShengMain},onShow:function(){this.updataPage()},setPageCfg:function(e){this._cfg=e},updataPage:function(){var e=this,t=game.wushengData.selectData;if(t){e.getComponent("bg").loadTexture(game.ResCfg.getUrl(115,e._cfg.bgName));for(var a=void 0,i=void 0,n=void 0,s=0,o=0;o<4;o++)(i=e.getComponent("point_"+(o+1)))&&(n=e._cfg.pos,i.setPosition(n[o].X,n[o].Y),(a=game.WuShengPosActivateCfg.getData(e._cfg.id,o+1))&&(e.getComponent("name_"+(o+1)).string=a.name,e.getComponent("name_"+(o+1)).active=a.starMapId==t.wsId,e.getComponent("blue_"+(o+1)).active=a.pos<t.pos&&a.starMapId==t.wsId,e.getComponent("red_"+(o+1)).active=a.pos==t.pos&&a.starMapId==t.wsId,a.pos==t.pos&&a.starMapId==t.wsId&&(s=o+1)));e.updataSelect(s)}},updataAllFinish:function(){for(var e=0;e<4;e++)this.getComponent("blue_"+(e+1)).active=!0,this.getComponent("red_"+(e+1)).active=!1,this.getComponent("name_"+(e+1)).active=!1;this.getComponent("select").active=!1,this.getComponent("maskNode").active=!1},updataSelect:function(e){if(e){var t=this.getComponent("point_"+e).getPosition();this.getComponent("select").setPosition(t.x,t.y),this.getComponent("maskNode").setPosition(t.x,t.y);var a=game.WuShengPosActivateCfg.getData(this._cfg.id,e);if(a){var i=game.AttrRulesCfg.getData(a.showType),n=game.HtmlUtil.getText(game.Color.WHITE,i.name)+game.HtmlUtil.getText(game.Color.GREEN,"+"+a.addSprite);this.getComponent("labSprite").string=n,this.getComponent("mask").setSize(this.getComponent("labSprite").width+10,36)}}},btnSelect:function(e){var t=game.wushengData.selectData;if(t){var a=game.WuShengStarMapCfg.getData(t.wsId);a&&a.type==this._cfg.type&&this.updataSelect(e)}},btn_1:function(){this.btnSelect(1)},btn_2:function(){this.btnSelect(2)},btn_3:function(){this.btnSelect(3)},btn_4:function(){this.btnSelect(4)}}),b8e.RC("$$game","$$wushengStarItem",e)}(),function(){var e=game.View.extends({countDownTime:3,_showModel:!0,ctor:function(){this._super(1349)},init:function(){this._lightEffect=new game.LightEffect,this.spriteStat=game.SpriteStat.get(),this._effect=[]},onShow:function(){var e=this;e._lightEffect||(e._lightEffect=new game.LightEffect),e._lightEffect.parent||(e._lightEffect.addToParent(e.skin.effect),e._lightEffect.setVisible(!0)),e.countDownTime=3,e.createCountDown(),e.updataPage(),e.updateHead()},onHide:function(){this._lightEffect&&this._lightEffect.removeFromParent(),this.clearCountDown(),game.module.show(game.ME.ShareMain),game.module.show(game.ME.WuShengActive)},updataPage:function(){var e=game.wushengData.selectData;this.setAttrLab(e.id-1,this.skin.icon1,this.skin.sprite1,1),this.setAttrLab(e.id,this.skin.icon2,this.skin.sprite2,2)},updateHead:function(){var e=game.ResCfg.getHead(game.mainRoleData.isMale);this.skin.head1.loadTexture(e),this.skin.head2.loadTexture(e)},setAttrLab:function(e,t,a,i){var n=this;n.spriteStat.clear();var s=game.WuShengPosActivateCfg.getDataById(e);if(s){var o=s.qualityLv?s.quality-1:s.quality,r=game.StarMapQualityAttrCfg.getData(o);if(r){n.spriteStat.setupByCfg(r,!1,!0);var g=n.spriteStat.getSpriteStats(),l=void 0,c="";g.forEach(function(e,t){l=game.AttrRulesCfg.getData(+e),c+=game.Lang.get(51579,l.name,t)},n),a.string=c;var h=game.ResCfg.getUrl(60,game.ResCfg.getQualityBg(o));t.loadTexture(h),n._effect[i]||(n._effect[i]=b8e.Animator.get(game.AnimType.ITEM_EFFECT,1),t.addChild(n._effect[i]),n._effect[i].setPosition(0,0));var m=game.CCommonUtil.getqualityEffect(o);m&&(h=game.ResCfg.getUrl(5022,m))&&(n._effect[i].load(h),n._effect[i].play())}}},createCountDown:function(){this.skin.time.string=game.Lang.get(51538,this.countDownTime),this.timer||(this.timer=b8e.Timer.add(this,this.updateTime,1e3)),this.timer.reset(),this.timer.start()},clearCountDown:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},updateTime:function(){this.countDownTime--,this.skin.time.string=game.Lang.get(51538,this.countDownTime),this.countDownTime<1&&game.module.hide(game.ME.WushengQulity)},onStageResize:function(){this._super(),this.skin.gray.setSize(b8e.stageWidth+50,339),this.skin.huawen_3.width=this.skin.huawen_1.width=b8e.stageWidth+50}});b8e.module.registerView(game.ME.WushengQulity,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super("wushengHoming/WuShengActiveView")},init:function(){this._icon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),this._icon.addToParent(this.skin.itemNode)},onShow:function(){game.TweenUtil.rotationEffect(this.skin.light),this.countDownTime=3,this.createCountDown(),this.setAttrPage()},onHide:function(){b8e.Tween.kill(this.skin.light),this.clearCountDown()},onStageResize:function(){this._super(),this.skin.gray.setSize(b8e.stageWidth+50,456),this.skin.huawen_3.width=this.skin.huawen_1.width=b8e.stageWidth+50},setAttrPage:function(){var e=this.skin,t=game.wushengData.activeId,a=game.WuShengPosActivateCfg.getDataById(t);if(a){if(e.activeLab.string=a.name,e.itemNode.active=0<a.giveItem.length,e.labSprite.active=!!a.showType,e.activeLab.setPosition(a.iconRes&&a.nameRes?378:332,-440),e.starBg.active=!!a.iconRes,a.showType){var i=game.AttrRulesCfg.getData(a.showType);e.labSprite.string=game.HtmlUtil.getText(game.Color.WHITE,i.name)+game.HtmlUtil.getText(game.Color.GREEN,"+"+a.addSprite)}if(0<a.giveItem.length){var n=b8e.createMap();n.id=a.giveItem[0].Id,n.num=a.giveItem[0].Num,game.GridUtil.setItemIcon(this._icon,n,!1,game.IconLayoutEnum.SHOW_NUM)}a.iconRes&&a.nameRes&&(e.starBg.loadTexture(game.ResCfg.getUrl(115,a.iconRes)),e.starLab.loadTexture(game.ResCfg.getUrl(115,a.nameRes)))}},createCountDown:function(){this.skin.time.string=game.Lang.get(51538,this.countDownTime),this.timer||(this.timer=b8e.Timer.add(this,this.updateTime,1e3)),this.timer.reset(),this.timer.start()},clearCountDown:function(){this.timer&&(b8e.Timer.remove(this,this.updateTime),this.timer=null)},updateTime:function(){this.countDownTime--,this.skin.time.string=game.Lang.get(51538,this.countDownTime),this.countDownTime<1&&game.module.hide(game.ME.WuShengActive)}});b8e.module.registerView(game.ME.WuShengActive,e)}(),function(){var e;e=b8e.Object.extends({type:0,name:"",rank:0,diffRank:0,time:0,setData:function(e){this.type=e.type,this.name=e.name,this.rank=e.rank,this.diffRank=e.lastRank-e.rank,this.time=e.time},resetData:function(){this.type=0,this.name="",this.rank=0,this.time=0,this.diffRank=0}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CSArenaLogInfo",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_SWITCH_PAGE:-1,C2V_UPDATE_SCORE_INFO:-1,C2V_UPDATE_RANK_INFO:-1,V2C_REQ_GET_AWARD:-1,V2C_REQ_GET_RANK_AWARD:-1,C2C_UPDATE_AWARD_STATE:-1}),b8e.RC("$$game","$$CSArenaAwardEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_REQ_ADVANCE_DATA:-1,V2C_CHALLENGE:-1,C2V_UPDATE_ADVANCE_INFO:-1,C2V_UPDATE_BUY_COUNT:-1,C2C_REQ_BUY:-1,C2C_REQ_CSARENA_DATA:-1,C2C_CHECK_ALERT_COUNT:-1,C2C_SET_FORMATION:-1,C2C_UPDATA_INFO:-1}),b8e.RC("$$game","$$CSArenaChallengeEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPATE_LOGS:-1,V2C_REQ_CSARENA_LOG:-1}),b8e.RC("$$game","$$CSArenaLogEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SYS_DATA:-1,C2V_UPDATE_VIEW:-1,C_REQ_RANKINFO:-1,C2V_UPDATE_PAE_VIEW:-1}),b8e.RC("$$game","$$CSArenaRankEvts",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_CS_ARENA_INFO:-1,C2V_UPDATE_BUY_COUNT:-1,V2C_REQ_CSARENA_DATA:-1,V2C_CHALLENGE:-1,C2C_CHALLENGE:-1,C2C_UPDATE_BUY_COUNT:-1,C2C_UPDATE_SCORE_INFO:-1,C2C_UPDATE_PANEL_INFO:-1,C2V_UPDATE_RESET_DAILY:-1,C2V_UPDATE_PANEL_INFO:-1,C2C_CHECK_ALERT_COUNT:-1}),b8e.RC("$$game","$$CSArenaEvts",e)}(),function(){var e=game.Control.extends({init:function(){this.scoreSpotAlert=game.spotAlert.set(game.SAE.CSARENA_SCORE,game.SAE.CSARENA_AWARD),this.rankSpotAlert=game.spotAlert.set(game.SAE.CSARENA_RANK,game.SAE.CSARENA_AWARD)},ipc:function(){this.evts={CSArena:{C2C_UPDATE_SCORE_INFO:this.onUpdateScoreInfo,C2C_UPDATE_PANEL_INFO:this.updateAwardInfo},MainRole:{C_RESET_DAILY:this.resetDaily,C_RESET_WEEK:this.resetWeek}},this.handels={CrossArenaScoreAwardResp:this.onCrossArenaScoreAwardResp,CrossArenaRankAwardResp:this.onCrossArenaRankAwardResp}},notify:function(e,t){switch(e){case this.Evts.V2C_REQ_GET_AWARD:this.reqCSArenaScoreAward(t);break;case this.Evts.V2C_REQ_GET_RANK_AWARD:this.reqCSArenaRankAward(t)}},updateAwardInfo:function(){this.checkScoreAlert(),this.checkRankAlert()},resetDaily:function(){this.checkScoreAlert()},resetWeek:function(){this.checkRankAlert()},reqCSArenaScoreAward:function(e){this.sender.CrossArenaScoreAwardReq(e)},reqCSArenaRankAward:function(e){this.sender.CrossArenaRankAwardReq(e)},onUpdateScoreInfo:function(){this.send(this.Evts.C2V_UPDATE_SCORE_INFO),this.checkScoreAlert(),this.checkRankAlert()},onCrossArenaScoreAwardResp:function(e){var t=e.readProtobuf(game.pb.CrossArenaScoreAwardResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.score;game.csArenaData.setScore(a),game.csArenaData.updateScoreList(),this.send(this.Evts.C2V_UPDATE_SCORE_INFO),this.checkScoreAlert(),this.dpt(this.Evts.C2C_UPDATE_AWARD_STATE)}},onCrossArenaRankAwardResp:function(e){var t=e.readProtobuf(game.pb.CrossArenaRankAwardResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.rank;game.csArenaData.setRank(a),game.csArenaData.updateRankList(),this.send(this.Evts.C2V_UPDATE_RANK_INFO),this.checkRankAlert(),this.dpt(this.Evts.C2C_UPDATE_AWARD_STATE)}},btn_score:function(){this.send(this.Evts.C2V_SWITCH_PAGE,0)},btn_danGrading:function(){this.send(this.Evts.C2V_SWITCH_PAGE,1)},btn_season:function(){this.send(this.Evts.C2V_SWITCH_PAGE,2)},checkScoreAlert:function(){this.scoreSpotAlert.alert=game.csArenaData.isShowScoreRedDot},checkRankAlert:function(){this.rankSpotAlert.alert=game.csArenaData.isShowRankRedDot}}),t=game.Sender.extends({ipc:function(){this.msg={CrossArenaScoreAwardReq:this.csArenaScoreAwardReq,CrossArenaRankAwardReq:this.csArenaRankAwardReq}},csArenaScoreAwardReq:function(e){var t=game.pb.CrossArenaScoreAwardRequest;t.score=e,this.write(t)},csArenaRankAwardReq:function(e){var t=game.pb.CrossArenaRankAwardRequest;t.rank=e,this.write(t)}}),a=[game.ME.CSArenaAward,game.ME.CSArenaScore,game.ME.CSArenaDanGrading,game.ME.CSArenaSeason];b8e.module.registerControl(game.ME.CSArenaAward,e,game.CSArenaAwardEvts,t,a)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={CSArena:{C2C_CHALLENGE:this.reqChallenge,C2C_UPDATE_BUY_COUNT:this.updateAdvanceBuyCount}},this.gevts={InstanceEvts:{G_STOP_PLAY:this.onStopPlay}},this.handels={CrossArenaAdvanceDataResp:this.onCrossArenaAdvanceDataResp,CrossArenaChallengeResp:this.onCrossArenaChallengeResp}},notify:function(e,t){switch(e){case this.Evts.V2C_REQ_ADVANCE_DATA:this.reqCSArenaAdvance();break;case this.Evts.V2C_CHALLENGE:t&&(game.playBackFormationData.setModule(game.ME.ArenaMain,1),this.dpt(this.Evts.C2C_SET_FORMATION,[game.ME.CSArena,t.roleId,this.reqCSArenaChallenge,[t.type,t.roleId,t.rank],this]))}},updateAdvanceBuyCount:function(){this.send(this.Evts.C2V_UPDATE_BUY_COUNT)},reqChallenge:function(e){if(e&&e.data){var t=e.data;game.playBackFormationData.setModule(game.ME.ArenaMain,1),this.dpt(this.Evts.C2C_SET_FORMATION,[game.ME.CSArena,t.roleId,this.reqCSArenaChallenge,[t.type,t.roleId,t.rank],this])}},reqCSArenaAdvance:function(){this.sender.CrossArenaAdvanceDataReq()},reqCSArenaChallenge:function(e,t,a){if(!game.playBack.isInstanceFighting()&&!game.sceneData.isGuildMap()){if(game.csArenaData.challenges<=0)return void game.notice.show(5622);var i=game.csArenaData.selfRank;this.sender.CrossArenaChallengeReq(e,t,a,i)}},onCrossArenaAdvanceDataResp:function(e){var t=e.readProtobuf(game.pb.CrossArenaAdvanceDataResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csArenaData.buys=t.buys;var a=game.csArenaData.getMaxChallenge();game.csArenaData.challenges=a-t.challenges+game.csArenaData.buys,game.csArenaData.setAdvanceLists(t.list),this.send(this.Evts.C2V_UPDATE_ADVANCE_INFO)}},onCrossArenaChallengeResp:function(e){var t=this,a=e.readProtobuf(game.pb.CrossArenaChallengeResponse);if(0<a.code)game.notice.noticeError(a.code);else{var i={type:game.InstanceType.CS_ARENA};a.battlelog.win=!a.battlelog.win,game.playBack.play(a.battlelog,i),game.mainRole.transition(game.RoleStateType.ACTION_IDLE);var n=a.type,s=a.rank,o=a.lastRank,r=game.csArenaData.getMaxChallenge();game.csArenaData.challenges=r-a.challenges+game.csArenaData.buys,t.dpt(t.Evts.C2C_CHECK_ALERT_COUNT),game.csArenaData.maxRank=a.rank,game.csArenaData.selfRank=a.rank,t._diffScore=a.score-game.csArenaData.score,game.csArenaData.score=a.score,game.csArenaData.historyTimes++,t._noticeKey,0==n?s!=o?(t._noticeKey=a.battlelog.win?5634:5633,game.csArenaData.isCanReqArena=!0):s==o&&(t._noticeKey=a.battlelog.win?5634:5633,t.dpt(t.Evts.C2C_REQ_CSARENA_DATA)):1==n&&(s!=o?(t._noticeKey=a.battlelog.win?5636:5635,game.csArenaData.isCanReqAdvanceArena=!0,game.csArenaData.isCanReqArena=!0):s==o&&(t._noticeKey=a.battlelog.win?5636:5635)),t.dpt(t.Evts.C2C_UPDATA_INFO)}},onStopPlay:function(e){if(e&&e.data&&e.data.type==game.InstanceType.CS_ARENA){this._noticeKey&&game.notice.show(this._noticeKey,this._diffScore)}},btn_refresh:function(){this.reqCSArenaAdvance()},btn_buy:function(){this.dpt(this.Evts.C2C_REQ_BUY)}}),t=game.Sender.extends({ipc:function(){this.msg={CrossArenaAdvanceDataReq:null,CrossArenaChallengeReq:this.csArenaChallengeReq}},csArenaChallengeReq:function(e,t,a,i){var n=game.pb.CrossArenaChallengeRequest;n.type=e,n.roleId=t,n.rank=a,n.ownRank=i,this.write(n)}});b8e.module.registerControl(game.ME.CSArenaChallenge,e,game.CSArenaChallengeEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={},this.handels={CrossArenaLogResp:this.onCrossArenaLogResp}},notify:function(e){switch(e){case this.Evts.V2C_REQ_CSARENA_LOG:this.reqCSArenaLog()}},reqCSArenaLog:function(){this.sender.CrossArenaLogReq()},onCrossArenaLogResp:function(e){var t=this,a=e.readProtobuf(game.pb.CrossArenaLogResponse);if(0<a.code)game.notice.noticeError(a.code);else{t.clearLog();var i,n=a.logs;t._logPool||(t._logPool=[]),t._logs?t._logs.length=0:t._logs=[];for(var s,o=0,r=t._logPool.length,g=n.length;o<g;o++)(i=n[o])&&(o<r?s=t._logPool[o]:(s=new game.CSArenaLogInfo,t._logPool.push(s)),s.setData(i),t._logs.push(s));t.send(t.Evts.C2V_UPATE_LOGS,t._logs)}},clearLog:function(){if(this._logPool&&!(this._logPool.length<1))for(var e,t=0,a=this._logPool.length;t<a;t++)(e=this._logPool[t])&&e.resetData()}}),t=game.Sender.extends({ipc:function(){this.msg={CrossArenaLogReq:null}}});b8e.module.registerControl(game.ME.CSArenaLog,e,game.CSArenaLogEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Rank:{C_UPDATE_DATA:this.onUpdateData}}},notify:function(e){switch(e){case this.Evts.V2C_SYS_DATA:this.dpt(this.Evts.C_REQ_RANKINFO,game.RankType.CrossArena)}},onUpdateData:function(){this.send(this.Evts.C2V_UPDATE_VIEW)},left_btn:function(){game.csArenaData.gotoPerRankPage(),this.send(this.Evts.C2V_UPDATE_PAE_VIEW)},right_btn:function(){game.csArenaData.gotoNextRankPage(),this.send(this.Evts.C2V_UPDATE_PAE_VIEW)}});b8e.module.registerControl(game.ME.CSArenaRank,e,game.CSArenaRankEvts)}(),function(){var e=game.Control.extends({init:function(){this.spotAlert=game.spotAlert.set(game.SAE.CSARENA,game.SAE.ARENA),this.csCountSpotAlert=game.spotAlert.set(game.SAE.CSARENA_COUNT,game.SAE.CSARENA),this.awardSpotAlert=game.spotAlert.set(game.SAE.CSARENA_AWARD,game.SAE.CSARENA),this._alertOptions={lang:0,langArgs:null,okcb:this.onClickGameAlert,thisArg:this}},ipc:function(){var e=this;e.evts={CSArenaChallenge:{C2C_REQ_BUY:e.reqCSArenaBuy,C2C_REQ_CSARENA_DATA:e.reqCSArena,C2C_CHECK_ALERT_COUNT:e.checkAlertCount},CSArenaAward:{C2C_UPDATE_AWARD_STATE:e.onUpdateArardState},MainUIChat:{C2C_REQ_JOIN_CSARENA:e.openCSArenaPanel},MainRole:{C_RESET_DAILY:e.resetDaily,C_RESET_WEEK:e.resetWeek}},e.gevts={SceneGEvts:{FIRST_ENTER_SCENE:e.onFirstEnterScene}},e.handels={CrossArenaDataResp:e.onCrossArenaDataResp,CrossArenaBuyResp:e.onCrossArenaBuyResp}},notify:function(e,t){switch(e){case this.Evts.V2C_REQ_CSARENA_DATA:this.reqCSArena();break;case this.Evts.V2C_CHALLENGE:this.dpt(this.Evts.C2C_CHALLENGE,t)}},onFirstEnterScene:function(){this.checkIsOpen()},onUpdateArardState:function(){this.checkAlertCount(),this.checkAwardAlert(),this.checkAlert()},checkIsOpen:function(){var e=this;if(game.moduleOpen.checkOpen(game.ME.CSArena)){if(game.csArenaData.isSettlementing())return game.csArenaData.resetWeek(),void e.send(e.Evts.C2V_UPDATE_PANEL_INFO);var t=game.SysTime.curTime,a=b8e.TimeUtil.getDay(t),i=0;if(1==a)i=game.csArenaData.getStartTime()-t+1e3,e.delayTimerReq(i);else if(0==a){i=game.csArenaData.getEndTime()-t+1e3,e.delayTimerReq(i)}else game.csArenaData.isOpen()&&(b8e.Tween.kill(e),b8e.Tween.get(e).wait(1e3).call(function(){e.reqCSArena(),b8e.Tween.kill(e)},e))}},delayTimerReq:function(e){this._delayTimer||(this._delayTimer=b8e.Timer.add(this,this.onReqCSArenaData,e),this._delayTimer.start())},onReqCSArenaData:function(){var e=this;e._delayTimer&&(b8e.Timer.remove(e,e.onReqCSArenaData),e._delayTimer=null);var t=game.SysTime.curTime,a=b8e.TimeUtil.getDay(t);1==a?(e.reqCSArena(),game.csArenaData.isCanReqArena=!1):0==a&&(game.csArenaData.resetWeek(),e.checkAwardAlert(),e.checkAlert(),e.checkAlertCount(),e.send(e.Evts.C2V_UPDATE_PANEL_INFO),e.dpt(e.Evts.C2C_UPDATE_PANEL_INFO))},resetDaily:function(){game.moduleOpen.checkOpen(game.ME.CSArena)&&game.csArenaData.resetDaily()},resetWeek:function(){game.moduleOpen.checkOpen(game.ME.CSArena)&&(game.csArenaData.resetWeek(),this.checkIsOpen())},openCSArenaPanel:function(){game.module.showToggle(game.ME.ArenaMain,1)},reqCSArena:function(){this.sender.CrossArenaDataReq()},reqCSArenaBuy:function(){var e=game.CSArenaMiscCfg.getData("csArenaChallengeTimes");e&&(game.csArenaData.challenges>=+e.value?game.notice.show(5603):game.csArenaData.isMaxBuysLimit()?game.notice.show(5604):game.module.show(game.ME.CSArenaBuyView))},onClickGameAlert:function(){this.sender.CrossArenaBuyReq()},onCrossArenaDataResp:function(e){var t=e.readProtobuf(game.pb.CrossArenaDataResponse);0<t.code?game.notice.noticeError(t.code):(game.csArenaData.setData(t),this.send(this.Evts.C2V_UPDATE_CS_ARENA_INFO),this.dpt(this.Evts.C2C_UPDATE_SCORE_INFO),this.checkAlert(),this.checkAwardAlert(),this.checkAlertCount(),(!t.list||t.list.length<1)&&this.reqCSArena())},onCrossArenaBuyResp:function(e){var t=e.readProtobuf(game.pb.CrossArenaBuyResponse);if(0<t.code)game.notice.noticeError(t.code);else{game.csArenaData.buys=t.buys;var a=game.csArenaData.getReadyBuyNum();game.csArenaData.challenges+=a,this.send(this.Evts.C2V_UPDATE_BUY_COUNT),this.dpt(this.Evts.C2C_UPDATE_BUY_COUNT),this.checkAlert(),this.checkAwardAlert(),this.checkAlertCount(),game.module.hide(game.ME.CSArenaBuyView)}},btn_help:function(){game.RuleView.inst().showView(game.ME.CSArena)},btn_buy:function(){this.reqCSArenaBuy()},btn_challenge_log:function(){b8e.module.isShowView(game.ME.CSArenaLog)||game.module.show(game.ME.CSArenaLog)},btn_refresh:function(){this.reqCSArena()},btn_advance:function(){if(game.csArenaData.isInRank())if(game.csArenaData.isKing())game.notice.show(5607);else if(game.csArenaData.challenges<1)game.notice.show(5984);else{var e=game.csArenaData.selfRank,t=game.CSArenaGradeCfg.getGradeByRank(e);if(t)if(e>t.advance1){var a=game.CSArenaGradeCfg.getNextGradeByRank(e);a&&game.notice.show(5623,t.advance1-a.rank)}else b8e.module.isShowView(game.ME.CSArenaChallenge)||game.module.show(game.ME.CSArenaChallenge)}else game.notice.show(9108)},btn_award:function(){b8e.module.isShowView(game.ME.CSArenaAward)||game.module.show(game.ME.CSArenaAward)},btn_rank:function(){b8e.module.isShowView(game.ME.CSArenaRank)||game.module.show(game.ME.CSArenaRank)},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.WANGZHE_SHOP)},checkAwardAlert:function(){this.awardSpotAlert.alert=game.csArenaData.isShowScoreRedDot||game.csArenaData.isShowRankRedDot},checkAlertCount:function(){this.csCountSpotAlert.alert=0<game.csArenaData.challenges},checkAlert:function(){this.spotAlert.alert=this.awardSpotAlert.alert||this.csCountSpotAlert.alert},maxBtn:function(){if(this.isHasNum()){var e=game.csArenaData.getCanBuyNum();this._updateBuyNum(e)}},minBtn:function(){this.isHasNum()&&this._updateBuyNum(1)},addOneBtn:function(){if(this.isHasNum()){var e=game.csArenaData,t=e.getReadyBuyNum(),a=e.getCanBuyNum(),i=t+1;i=a<i?a:i,this._updateBuyNum(i)}},lessOneBtn:function(){if(this.isHasNum()){var e=game.csArenaData.getReadyBuyNum()-1;e=e<2?1:e,this._updateBuyNum(e)}},isHasNum:function(){var e=0<game.csArenaData.getCanBuyNum();return e||game.notice.show(52425),e},_updateBuyNum:function(e){var t=game.csArenaData;t.getReadyBuyNum()!=e&&(t.setReadyBuyNum(e),this.send(this.Evts.C2V_UPDATE_BUY_NUM))},cancelbuyBtn:function(){game.module.hide(game.ME.CSArenaBuyView)},buyTimesBtn:function(){if(this.isHasNum()){var e=game.csArenaData,t=e.getPerTimeCost(),a=e.getReadyBuyNum();game.amount.get(game.AmountType.YUAN_BAO)<t?game.notice.show(52271):this.sender.CrossArenaBuyReq(a)}}}),t=[game.ME.CSArenaBuyView],a=game.Sender.extends({ipc:function(){this.msg={CrossArenaDataReq:null,CrossArenaBuyReq:this.crossArenaBuyReq}},crossArenaBuyReq:function(e){var t=game.pb.CrossArenaBuyRequest;t.times=e,this.write(t)}});b8e.module.registerControl(game.ME.CSArena,e,game.CSArenaEvts,a,t)}(),function(){var e;e=b8e.Object.extends({cfg:null,isGet:!1,isCanGet:!1,score:0,labelId:0,ctor:function(){this._super()},getPrizeList:function(){var e=this;if(e.award){return e.award}e.award=[];for(var t,a,i=e.cfg.award||e.cfg.awards,n=i.length,s=0;s<n;s++){t=i[s],(a=game.ItemUtil.createBaseItemInfo(t.Id,t.Num)).iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,a.iconSize=game.IconSizeEnum.GRID_SIZE_84,e.award.push(a)}return e.award}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CSArenaScoreInfo",e)}(),function(){var e;e=b8e.Object.extends({cfg:null,isGet:!1,isCanGet:!1,ctor:function(){this._super()},getPrizeList:function(){var e=this;if(e.award){return e.award}e.award=[];for(var t,a,i=e.cfg.award1,n=i.length,s=0;s<n;s++){t=i[s],(a=game.ItemUtil.createPrizeInfo(t.Id,t.Num)).iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,e.award.push(a)}return e.award}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CSArenaGradeInfo",e)}(),function(){var e;e=b8e.Object.extends({cfg:null,ctor:function(){this._super()},getPrizeList:function(){var e=this;if(e.award){return e.award}e.award=[];for(var t,a,i=e.cfg.award2,n=i.length,s=0;s<n;s++){t=i[s],(a=game.ItemUtil.createPrizeInfo(t.Id,t.Num)).iconLayoutEnum=game.IconLayoutEnum.SHOW_NUM,e.award.push(a)}return e.award}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$CSArenaSeasonInfo",e)}(),function(){var e=b8e.Object.extends({selfRank:0,firstInfo:null,_lists:null,_advanceLists:null,isCanReqArena:!0,isCanReqAdvanceArena:!0,ctor:function(){var e=this;e._super(),e.selfRank=0,e.buys=0,e.maxRank=0,e.PER_PAGE_COUNT=10,e.pageNum=1,e.score=0,e.challenges=0,e.readyBuyNum=1,e.historyTimes=0},resetDaily:function(){this.score=0,this.buys=0,this.challenges=this.getMaxChallenge(),this._scoreCollecltedArr&&(this._scoreCollecltedArr.length=0),this.updateScoreList()},resetWeek:function(){var e=this;e.resetTime(),e.selfRank=0,e.firstInfo=null,e.score=0,e.buys=0,e.challenges=e.getMaxChallenge(),e.maxRank=0,e._scoreCollecltedArr&&(e._scoreCollecltedArr.length=0),e.updateScoreList(),e._rankCollecltedArr&&(e._rankCollecltedArr.length=0),e.updateRankList(),e._lists&&(e._lists.length=0),e._advanceLists&&(e._advanceLists.length=0)},setData:function(e){var t=this;t.selfRank=e.rank,t.firstInfo=e.info,t.buys=e.buys,t.maxRank=e.maxRank,t.score=e.score,t.historyTimes=e.historyTimes;var a=t.getMaxChallenge();t.challenges=a-e.challenges+t.buys,t.setLists(e.list),t.setScoreCollected(e.scoreCollected),t.setRankCollected(e.rankCollected),t.updateScoreList(),t.updateRankList()},setLists:function(e){!e||e.length<1||(this._lists=e)},getList:function(){return this._lists},setAdvanceLists:function(e){!e||e.length<1||(this._advanceLists=e,this._advanceLists.sort(function(e,t){return e.rank-t.rank}))},getAdvanceList:function(){return this._advanceLists},isKing:function(){if(this.selfRank<1)return!1;var e=game.CSArenaGradeCfg.getGradeByRank(this.selfRank);return e&&e.advance1<1},getCurGrade:function(){var e=game.CSArenaGradeCfg.getGradeByRank(this.selfRank);return e?e.rank:0},isMaxBuysLimit:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e);return!t||!(0<t.csArena-this.buys)},getMaxChallenge:function(){if(this._maxChallenge)return this._maxChallenge;var e=game.CSArenaMiscCfg.getData("csArenaChallengeTimes");return e?(this._maxChallenge=+e.value,this._maxChallenge):8},getGradRank:function(e){var t=game.CSArenaGradeCfg.getNextGradeByRank(e);return t?e-t.rank:e-0},getKingScore:function(){return gama.amount.get(game.AmountType.KING_SCORE)},isInRank:function(){return 0<this.selfRank},isCanAdvance:function(){var e=game.CSArenaGradeCfg.getGradeByRank(this.selfRank);return!!e&&(this.selfRank<=e.advance1&&0<this.challenges)},getMaxRank:function(){return this.maxRank<=0?this._getMaxRank():this.maxRank},_getMaxRank:function(){if(this._maxRank)return this._maxRank;var e=game.CSArenaMiscCfg.getData("csArenaMaxRank");return e?(this._maxRank=+e.value,this._maxRank):8},setScoreCollected:function(e){if(e&&!(e.length<1))for(var t,a=0,i=e.length;a<i;a++)t=e[a],this.setScore(t)},setScore:function(e){var t=this;if(!t._scoreCollecltedArr){t._scoreCollecltedArr=[]}t._scoreCollecltedArr.push(e)},isReceiveScore:function(e){var t=this;if(t._scoreCollecltedArr)return-1<t._scoreCollecltedArr.indexOf(e);return!1},getIsCanGetScore:function(e){return this.score>=e.score},updateScoreList:function(){var e=this;e.isShowScoreRedDot=!1;var t=game.CSArenaScoreAwardCfg.getList();if(!t||t.length<1);else for(var a,i=0,n=t.length;i<n;i++){if(a=t[i])if(a.score=e.score,e.isReceiveScore(a.cfg.score)){a.isGet=!0}else if(a.isGet=!1,e.getIsCanGetScore(a.cfg)){a.isCanGet=!0,e.isShowScoreRedDot=!0}else a.isCanGet=!1;else;}},getScoreList:function(){var e=game.CSArenaScoreAwardCfg.getList();if(e&&0<e.length){e.sort(this.onSortScore)}return e},onSortScore:function(e,t){if(e.isGet==t.isGet){if(e.isCanGet==t.isCanGet){return e.cfg.score-t.cfg.score}if(e.isCanGet){return-1}return 1}if(e.isGet){return 1}if(t.isGet){return-1}},setRankCollected:function(e){if(e&&!(e.length<1))for(var t,a=0,i=e.length;a<i;a++)t=e[a],this.setRank(t)},setRank:function(e){var t=this;if(!t._rankCollecltedArr){t._rankCollecltedArr=[]}t._rankCollecltedArr.push(e)},isReceiveRank:function(e){var t=this;if(t._rankCollecltedArr)return-1<t._rankCollecltedArr.indexOf(e);return!1},getIsCanGetRank:function(e){return!(this.maxRank<=0)&&this.maxRank<=e.rank},updateRankList:function(){var e=this;e.isShowRankRedDot=!1;var t=game.CSArenaGradeCfg.getRankList();if(!t||t.length<1);else for(var a,i=0,n=t.length;i<n;i++){if(a=t[i])if(e.isReceiveRank(a.cfg.rank)){a.isGet=!0}else if(a.isGet=!1,e.getIsCanGetRank(a.cfg)){a.isCanGet=!0,e.isShowRankRedDot=!0}else a.isCanGet=!1;else;}},getRankList:function(){var e=game.CSArenaGradeCfg.getRankList();if(e&&0<e.length){e.sort(this.onSortRank)}return e},onSortRank:function(e,t){if(e.isGet==t.isGet){if(e.isCanGet==t.isCanGet){return t.cfg.rank-e.cfg.rank}if(e.isCanGet){return-1}return 1}if(e.isGet){return 1}if(t.isGet){return-1}},getRankInfoArrByPageByType:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.CrossArena);return!e||e.length<1?null:e},getPageCount:function(){var e=game.rankData.getRankInfoArrByType(game.RankType.CrossArena);if(e&&0<e.length){var t=e.length;return Math.ceil(t/this.PER_PAGE_COUNT)}return 1},gotoNextRankPage:function(){this.pageNum<1&&(this.pageNum=1);var e=this.PER_PAGE_COUNT,t=game.rankData.getRankInfoArrByType(game.RankType.CrossArena);this.pageNum;this.pageNum*e<t.length&&this.pageNum++},gotoPerRankPage:function(){this.pageNum<1&&(this.pageNum=1);var e=this.PER_PAGE_COUNT,t=game.rankData.getRankInfoArrByType(game.RankType.CrossArena),a=(this.pageNum-1)*e;this.pageNum;a<t.length&&1<this.pageNum&&this.pageNum--},isOpen:function(){var e=game.SysTime.curTime,t=this.getStartTime(),a=this.getEndTime();return t<=e&&e<=a},isSettlementing:function(){var e=game.SysTime.curTime,t=this.getEndTime(),a=this.getCurWeekEndTime();return t<e&&t<a},getCurWeekEndTime:function(){if(this._weekEndTime)return this._weekEndTime;var e=game.SysTime.curTime,t=7-(0!=b8e.TimeUtil.getDay(e)?b8e.TimeUtil.getDay(e):7)>>0,a=b8e.TimeUtil.getTodayTime(e);return this._weekEndTime=a+b8e.TimeUtil.DAY_MICRO_SECONDS+t*b8e.TimeUtil.DAY_MICRO_SECONDS,this._weekEndTime},getCountDown:function(){var e=game.SysTime.curTime;return this.getEndTime()-e},getStartTime:function(){if(0<this._startTime)return this._startTime;var e=this.getOpenTimeArr();if(!e||e.length<1)return 0;var t=e[0].split(":");if(!t||t.length<0)return 0;var a=game.SysTime.curTime,i=0!=+t[0]?+t[0]:7,n=(0!=b8e.TimeUtil.getDay(a)?b8e.TimeUtil.getDay(a):7)-i>>0,s=+t[1],o=b8e.TimeUtil.getTodayTime(a);return this._startTime=o+b8e.TimeUtil.HOUR_MICRO_SECONDS*s-n*b8e.TimeUtil.DAY_MICRO_SECONDS,this._startTime},getEndTime:function(){if(0<this._endTime)return this._endTime;var e=this.getOpenTimeArr();if(!e||e.length<0)return 0;var t=e[e.length-1].split(":");if(!t||t.length<0)return 0;var a=game.SysTime.curTime,i=(0!=+t[0]?+t[0]:7)-(0!=b8e.TimeUtil.getDay(a)?b8e.TimeUtil.getDay(a):7)>>0,n=+t[1],s=b8e.TimeUtil.getTodayTime(a);return this._endTime=s+b8e.TimeUtil.HOUR_MICRO_SECONDS*n+i*b8e.TimeUtil.DAY_MICRO_SECONDS,this._endTime},getOpenTimeArr:function(){if(!this._csArenaOpenTimeArr||this._csArenaOpenTimeArr.length<1){var e=game.CSArenaMiscCfg.getData("csArenaOpenTime");if(!e||""==e.value)return!1;this._csArenaOpenTimeArr=e.value.split("-")}return this._csArenaOpenTimeArr},resetTime:function(){this._startTime=null,this._endTime=null,this._weekEndTime=null},getCanBuyNum:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e).csArena-this.buys,a=this.getMaxChallenge();return t>a-this.challenges&&(t=a-this.challenges),t},getReadyBuyNum:function(){return this.readyBuyNum},getPerTimeCost:function(){for(var e=this.getReadyBuyNum(),t=0,a=0;a<e;a++){var i=game.csArenaData.buys+a;t+=this.getCostCfgByCount(i).Num}return t},setReadyBuyNum:function(e){this.readyBuyNum=e},getCostCfgByCount:function(e){var t=game.CostCfg.getCostCfg(game.CostType.CS_ARENA,e+1);if(!t)return null;var a=t.items;return!a||a.length<1?null:a[0]}});game.csArenaData=game.csArenaData||new e}(),function(){var e;e=game.Widget.extends({ctor:function(e){this._super(184),this.bindEnum=e},loadComplete:function(){this.hide(),this.data&&this.show(this.data)},init:function(){this.roleData=game.BaseRoleData.get(game.RoleType.Hero,1)},show:function(e){this.data=e,this._super()},onShow:function(){this.setData(this.data),this.setVisible(!0)},onHide:function(){this.clearModel(),this.setVisible(!1)},setData:function(e){var t=this.skin;if(!e)return t.lab_rank.string="",t.lab_name.string="",void(t.lab_power.string="");t.lab_rank.string=game.csArenaData.getGradRank(e.rank);var a=e.name;0<e.zone&&(a=e.name+"s."+e.zone),t.lab_name.string=a,t.lab_power.string=e.power,this.createModel()},createModel:function(){var e=this,t=e.data;if(t){e.roleData&&e.roleData.reset(),e.roleData.type=game.RoleType.Hero,e.roleData.setMale(t.isMale),e.roleData.heroModel.setSurface(t.surface),e.roleData.heroModel.type=game.RoleType.Hero,e.model=game.sceneRoleCreate.createUIRole(e.roleData),e.model.addToParent(e.skin.model);var a=game.AvatarUtil;a.updateUIModel(e.model,a.ID_2,!1),e.model.transition(game.RoleStateType.ACTION_IDLE)}},clearModel:function(){this.model&&(this.model.removeFromParent(),this.model.release(),this.model=null)},btn_challenge:function(){this.data&&(this.data.type=1,this.send(game.CSArenaChallengeEvts.V2C_CHALLENGE,this.data),b8e.module.isShowView(game.ME.CSArenaChallenge)&&game.module.hide(game.ME.CSArenaChallenge))}}),b8e.RC("$$game","$$CSArenaAdvanceDefier",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(187),this.setSize(600,146)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.list),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=12,t.layout.spacingX=5,t.layout.spacingY=5},setData:function(e){var t=this,a=t.skin,i=(e=t.data,t.data.cfg),n=e.getPrizeList();if(t.prizeList.setData(n),a.btn_no_get.node.active=!1,a.btn_isGet.node.active=!1,a.btn_get.node.active=!1,e.isGet){a.btn_isGet.node.active=!0}else if(e.isCanGet){a.btn_get.node.active=!0}else a.btn_no_get.node.active=!0;if(i){a.lab_content.string=i.awardGradeName;var s=game.CSArenaGradeCfg.getIconUrl(i.rank);a.icon.loadTexture(s)}},btn_get:function(){var e=this;if(e.data&&e.data.cfg){e.send(game.CSArenaAwardEvts.V2C_REQ_GET_RANK_AWARD,e.data.cfg.rank)}}}),b8e.RC("$$game","$$CSArenaDanGradingRewardsItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(190),this.setSize(540,98)},setData:function(e){var t=this.skin,a=e.rank,i=game.CSArenaGradeCfg.getGradeByRank(a);if(i){var n=e.type,s=e.diffRank,o="",r=game.csArenaData.getGradRank(a);switch(n){case 1:o=0<s?game.Lang.get(5613,e.name,i.logGradeName,r):game.Lang.get(5614,e.name);break;case 2:o=s<0?game.Lang.get(5615,e.name,i.logGradeName,r):game.Lang.get(5616,e.name);break;case 3:o=game.Lang.get(5617,e.name);break;case 4:o=game.Lang.get(5618,e.name,i.logGradeName,r)}t.img_win.node.active=1==n||4==n,t.img_lose.node.active=2==n||3==n,t.lab_time.string=b8e.TimeUtil.formatTimestamp(e.time),t.lab_log.string=o}}}),b8e.RC("$$game","$$CSArenaLogItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(192),this.setSize(540,64)},setData:function(e){var t=this.skin,a=e.rank;t.lab_rank.string="",t.rank1.node.active=!1,t.rank2.node.active=!1,t.rank3.node.active=!1,t.rank4.node.active=!1,a<4?this.getComponent("rank"+a).node.active=!0:(t.rank4.node.active=!0,t.lab_rank.string=a),t.lab_name.string=e.name,t.lab_power.string=e.power;var i=game.CSArenaGradeCfg.getGradeByRank(a);if(i){var n=game.csArenaData.getGradRank(a);t.lab_dangrading.string=game.Lang.replaceStr(i.rankGradeName,[n])}else t.lab_dangrading.string=""}}),b8e.RC("$$game","$$CSArenaRankItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(e){var t=0<arguments.length&&void 0!==e?e:"";t=t||1206,this._super(t),this.setSize(600,147)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.list),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=12,t.layout.spacingX=5,t.layout.spacingY=5},setData:function(e){var t=this,a=t.skin,i=(e=e,t.data.cfg),n=e.getPrizeList();if(t.prizeList.setData(n),a.btn_no_get.node.active=!1,a.btn_isGet.node.active=!1,a.btn_get.node.active=!1,e.isGet){a.btn_isGet.node.active=!0}else if(e.isCanGet){a.btn_get.node.active=!0}else a.btn_no_get.node.active=!0;var s="",o=e.score;s=o>=i.score?game.HtmlUtil.getText(game.Color.GREEN,o):game.HtmlUtil.getText(game.Color.RED,o),a.lab_content.string=game.Lang.get(e.labelId,i.score,s,i.score)},btn_get:function(){var e=this;if(e.data&&e.data.cfg){e.send(game.CSArenaAwardEvts.V2C_REQ_GET_AWARD,e.data.cfg.score)}}}),b8e.RC("$$game","$$CSArenaScoreRewardsItem",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(195),this.setSize(600,146)},init:function(){var e=this,t=e.prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.PrizeListItem,t.addToParent(e.skin.list),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=12,t.layout.spacingX=5,t.layout.spacingY=5},setData:function(e){var t=this,a=(e=t.data,t.skin),i=t.data.cfg,n=e.getPrizeList();if(t.prizeList.setData(n),i){a.lab_content.string=i.awardGradeName;var s=game.CSArenaGradeCfg.getIconUrl(i.rank);a.icon.loadTexture(s)}}}),b8e.RC("$$game","$$CSArenaSeasonRewardsItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(185)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_ADVANCE_INFO:this.updateList(),this.updateAdvanceCount();break;case this.Evts.C2V_UPDATE_BUY_COUNT:this.updateAdvanceCount()}},init:function(){var e=this.skin;this.initDefiers(),e.lab_desc.string=game.Lang.get(5608)},initDefiers:function(){var e;this.skin;this._defiers=[];for(var t=0;t<3;t++)(e=new game.CSArenaAdvanceDefier(game.ME.CSArenaChallenge)).addToParent(this.getComponent("defier_"+t)),this._defiers.push(e)},onShow:function(){game.csArenaData.isCanReqAdvanceArena?(game.csArenaData.isCanReqAdvanceArena=!1,this.send(this.Evts.V2C_REQ_ADVANCE_DATA)):(this.updateList(),this.updateAdvanceCount())},onHide:function(){this.hideDefiners()},updateAdvanceCount:function(){this.skin.lab_advance_count.string=game.Lang.get(5609,game.csArenaData.challenges)},updateList:function(){var e=game.csArenaData.getAdvanceList();if(e&&!(e.length<1)){this.hideDefiners();for(var t,a,i=0;i<3;i++)a=e[i],t=this._defiers[i],a?t.show(a):t.hide()}},hideDefiners:function(){this._defiers&&this._defiers.forEach(function(e){e.hide()},this)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+100;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CSArenaChallenge,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(188)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_RANK_INFO:this.updateList()}},init:function(){var e=this,t=e.skin;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.CSArenaDanGradingRewardsItem,e._list.bindEnum=game.ME.CSArenaAward,e._list.layout.paddingLeft=0,e._list.layout.spacingY=10,e._list.addToParent(t.list)},onShow:function(){this.updateList()},onHide:function(){},updateList:function(){var e=this,t=game.csArenaData.getRankList();if(e._list){e._list.setData(t)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CSArenaDanGrading,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(191)},notify:function(e,t){switch(e){case this.Evts.C2V_UPATE_LOGS:this._list&&this._list.setData(t)}},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.CSArenaLogItem,this._list.addToParent(this.skin.list)},onShow:function(){this.send(this.Evts.V2C_REQ_CSARENA_LOG)},onHide:function(){},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CSArenaLog,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(193),this.setLocalZOrder(20)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_VIEW:this.updateView(),this.updateRankInfo(),this.updatePageNum();break;case this.Evts.C2V_UPDATE_PAE_VIEW:this.updateRankInfo(),this.updatePageNum()}},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.CSArenaRankItem,this._list.bindEnum=game.ME.CSArenaRank,this._list.layout.paddingTop=0,this._list.layout.spacingY=6,this._list.addToParent(this.skin.list)},onShow:function(){this.send(this.Evts.V2C_SYS_DATA),this.skin.lab_page.string="1/1",this.skin.lab_self_rank.string="",this.updateView(),this.updateRankInfo(),this.updatePageNum()},updateRankInfo:function(){var e=game.csArenaData.getRankInfoArrByPageByType();e=e||[],this._list.setData(e)},updatePageNum:function(){var e=game.csArenaData.getPageCount(),t=game.csArenaData.pageNum;this.skin.lab_page.string=t+" / "+e},updateView:function(){var e=this.skin,t=game.csArenaData.selfRank,a=game.csArenaData.getGradRank(t);if(game.csArenaData.isInRank()){var i=game.CSArenaGradeCfg.getGradeByRank(t);e.lab_self_rank.string=i?game.Lang.get(5624,i.awardGradeName,a):""}else e.lab_self_rank.string=game.Lang.get(5624,"",a)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+100;this.setPosition(e,t)}});b8e.module.registerView(game.ME.CSArenaRank,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(194)},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_SCORE_INFO:this.updateList()}},init:function(){var e=this,t=e.skin;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.CSArenaScoreRewardsItem,e._list.bindEnum=game.ME.CSArenaAward,e._list.layout.paddingLeft=0,e._list.layout.spacingY=10,e._list.addToParent(t.list)},onShow:function(){this.updateList()},onHide:function(){},updateList:function(){var e=this,t=game.csArenaData.getScoreList();if(e._list){e._list.setData(t)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CSArenaScore,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(196)},init:function(){var e=this,t=e.skin;e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e._list.itemRender=game.CSArenaSeasonRewardsItem,e._list.bindEnum=game.ME.CSArenaAward,e._list.layout.paddingLeft=0,e._list.layout.spacingY=10,e._list.addToParent(t.list),e.updateList()},updateList:function(){var e=this,t=game.CSArenaGradeCfg.getSeasonRewards();if(e._list){e._list.setData(t)}},onShow:function(){},onHide:function(){},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CSArenaSeason,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(186),this.toggles={toggle_btn_1:game.ME.CSArenaScore,toggle_btn_2:game.ME.CSArenaDanGrading,toggle_btn_3:game.ME.CSArenaSeason},this.spotAlerts={CSARENA_SCORE:this.scoreAlert,CSARENA_RANK:this.rankAlert}},notify:function(e,t){switch(e){case this.Evts.C2V_SWITCH_PAGE:this.toggleSelect(t)}},onShow:function(){this.toggleSelect(0)},onHide:function(){},scoreAlert:function(e){this.skin.score_alert.node.active=e.alert},rankAlert:function(e){this.skin.rank_alert.node.active=e.alert},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.CSArenaAward,e)}(),function(){var e;e=game.Widget.extends({ctor:function(e){this._super(189),this.bindEnum=e},init:function(){this.skin;this.roleData=game.BaseRoleData.get(game.RoleType.Hero,1),this.modelConfig={roleType:game.RoleType.Monster,model:1001}},show:function(e){this.data=e,this._super()},onShow:function(){this.setData(this.data)},onHide:function(){this.clearModel()},setData:function(e){var t=this.skin;if(!e)return t.lab_rank.string="",t.lab_name.string=game.Lang.get(9106),t.lab_power.string="",void this.clearModel();t.lab_rank.string=game.csArenaData.getGradRank(e.rank);var a=e.name;0<e.zone&&(a=e.name+"s."+e.zone),t.lab_name.string=a,t.lab_power.string=e.power,this.createModel()},createModel:function(){var e=this,t=e.data;if(t){e.roleData&&e.roleData.reset(),e.roleData.type=game.RoleType.Hero,e.roleData.setMale(t.isMale),e.roleData.heroModel.setSurface(t.surface),e.roleData.heroModel.type=game.RoleType.Hero,e.model=game.sceneRoleCreate.createUIRole(e.roleData),e.model.addToParent(e.skin.model);var a=game.AvatarUtil;a.updateUIModel(e.model,a.ID_16,!1),e.model.transition(game.RoleStateType.ACTION_IDLE)}},clearModel:function(){this.model&&(this.model.removeFromParent(),this.model.release(),this.model=null)},model_btn:function(){this.reqChallenge()},item_btn:function(){this.reqChallenge()},reqChallenge:function(){this.data&&(game.csArenaData.isKing()||1!=this.data.rank?(this.data.type=0,this.send(game.CSArenaEvts.V2C_CHALLENGE,this.data)):game.notice.show(5804))}}),b8e.RC("$$game","$$CSArenaDefier",e)}(),function(){var e=game.View.extends({_isFirst:!1,ctor:function(){this._super(197),this.spotAlerts={CSARENA_AWARD:this.awardAlert}},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_CS_ARENA_INFO:case this.Evts.C2V_UPDATE_PANEL_INFO:this.updatePanelInfo();break;case this.Evts.C2V_UPDATE_BUY_COUNT:this.updateChallengeCount(),this.updateAdvanceInfo()}},init:function(){var e=this.skin;e.bg.loadTexture(game.ResCfg.getImgUrl("csArena/bg",!0)),e.nick_name_img.loadTexture(game.ResCfg.getImgUrl("csArena/zqwz")),e.nick_name_img.node.active=!1,this.initDefiers(),this.showDefaultState(),this.setVisibleState(!1),e.lab_advance_desc.string="",e.lab_dan_grading.string="",e.lab_no.string="",e.lab_challenge_count.string="",e.lab_open_state.string=""},initDefiers:function(){var e,t=this.skin;this._defiers=[];for(var a=0;a<5;a++)(e=new game.CSArenaDefier(game.ME.CSArena)).addToParent(this.getComponent("defier_"+a)),e.setVisible(!1),this._defiers.push(e);this._firstDefier=new game.CSArenaDefier(game.ME.CSArena),this._firstDefier.addToParent(t.first_node),this._firstDefier.setVisible(!1)},onShow:function(){this.skin.advance_alert.node.active=!1,this.updatePanelInfo()},onHide:function(){this.hideDefiners(),this.stopTime()},updatePanelInfo:function(){var e=this,t=e.skin;!game.csArenaData.isOpen()||game.csArenaData.isSettlementing()?(e.showDefaultState(),e.setVisibleState(!1),t.lab_advance_desc.string="",t.lab_dan_grading.string="",t.lab_no.string="",t.lab_challenge_count.string="",game.csArenaData.isSettlementing()?t.lab_open_state.string=game.Lang.get(5638):game.csArenaData.isOpen()||(t.lab_open_state.string=game.Lang.get(5637))):(e.setVisibleState(),t.lab_open_state.string="",game.csArenaData.isCanReqArena?(game.csArenaData.isCanReqArena=!1,e.send(e.Evts.V2C_REQ_CSARENA_DATA)):(e.onUpdateCSArenaInfo(),e.onUpdateFirstInfo(),e.updateChallengeCount(),e.updateAdvanceInfo(),e.updateSelfInfo())),e.checkState()},setVisibleState:function(e){var t=!(0<arguments.length&&void 0!==e)||e,a=this.skin;a.nick_name_img.node.active=t,a.lab_open_state.node.active=!t,a.dan_grading_icon.node.active=t,a.btn_buy.node.active=t,a.btn_refresh.node.active=t,a.btn_advance.node.active=t,a.btn_no_advance.node.active=t},updateEndTime:function(){var e=this,t=game.csArenaData.getCountDown();if(t<=0)e.checkState();else{var a=game.TimeUtil.formatTimeSpace(t,3);e.skin.lab_time.string=game.Lang.get(5629,a)}},checkState:function(){var e=this;game.csArenaData.isSettlementing()?(e.skin.lab_time.string=game.Lang.get(5631),e.stopTime()):game.csArenaData.isOpen()?e.startTime():(e.skin.lab_time.string=game.Lang.get(5630),e.stopTime())},startTime:function(){if(this._timeObj)this._timeObj.reset(),this._timeObj.start();else{this._timeObj=b8e.Timer.add(this,this.updateEndTime,1e3)}},stopTime:function(){if(this._timeObj){this._timeObj.stop()}},updateSelfInfo:function(){var e=this.skin;if(!game.csArenaData.isInRank())return e.lab_dan_grading.string="",e.dan_grading_icon.node.active=!1,void(e.lab_no.string=game.Lang.get(5619));var t=game.csArenaData.selfRank;e.lab_no.node.string="",e.dan_grading_icon.node.active=!0;var a=game.CSArenaGradeCfg.getIconUrl(t);e.dan_grading_icon.loadTexture(a);var i=game.CSArenaGradeCfg.getGradeByRank(t);if(i){var n=game.csArenaData.getGradRank(t);e.lab_dan_grading.string=game.Lang.get(5611,n,i.gradeName)}else e.lab_dan_grading.string=""},updateChallengeCount:function(){this.skin.lab_challenge_count.string=game.Lang.get(5609,game.csArenaData.challenges)},onUpdateFirstInfo:function(){var e=game.csArenaData.firstInfo;e?this._firstDefier&&(this._firstDefier.hide(),this._firstDefier.show(e),this._firstDefier.setVisible(!0)):this._firstDefier&&this._firstDefier.hide()},updateAdvanceInfo:function(){var e=this.skin;if(!game.csArenaData.isInRank())return e.btn_no_advance.node.active=!0,void(e.lab_advance_desc.string=game.Lang.get(5619));if(game.csArenaData.isKing())return e.lab_advance_desc.string=game.Lang.get(5625),void(e.btn_no_advance.node.active=!0);e.advance_alert.node.active=game.csArenaData.isCanAdvance(),e.btn_no_advance.node.active=!game.csArenaData.isCanAdvance();var t=game.csArenaData.selfRank,a=game.CSArenaGradeCfg.getGradeByRank(t),i=game.Lang.get(5619);if(a){var n=game.CSArenaGradeCfg.getNextGradeByRank(t);n&&(i=game.Lang.get(5612,a.advance1-n.rank))}e.lab_advance_desc.string=i},showDefaultState:function(){this.hideDefiners(),this._firstDefier&&(this._firstDefier.hide(),this._firstDefier.setVisible(!1))},onUpdateCSArenaInfo:function(){var e=game.csArenaData.getList();if(e&&!(e.length<1)){this.hideDefiners();for(var t,a,i=0;i<5;i++)a=e[i],t=this._defiers[i],a?(t.show(a),t.setVisible(!0)):t.hide()}},hideDefiners:function(){this._defiers&&0<this._defiers.length&&this._defiers.forEach(function(e){e.hide(),e.setVisible(!1)},this)},awardAlert:function(e){this.skin.award_alert.node.active=e.alert},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.CSArena,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(1698)},init:function(){this.data=game.csArenaData},notify:function(e){switch(e){case this.Evts.C2V_UPDATE_BUY_NUM:this.updateBuyNum()}},onShow:function(){this.resetBuyNum(),this.updateBuyNum(),this.updateDesc()},updateBuyNum:function(){var e=this.data,t=this.skin,a=e.getPerTimeCost(),i=e.getReadyBuyNum();t.buyNum.string=i,t.amountNum.string=a},onHide:function(){this.resetBuyNum()},resetBuyNum:function(){var e=this.data,t=e.getCanBuyNum()<1?0:1;e.setReadyBuyNum(t)},updateDesc:function(){var e=this.skin,t=this.data,a=game.mainRoleData.vipLevel,i=game.VipCfg.getData(a).csArena-game.csArenaData.buys,n=t.getCanBuyNum(),s=t.getMaxChallenge(),o=s-n;e.mainDesc.string=game.Lang.get(5606,[i,o,s])}});b8e.module.registerView(game.ME.CSArenaBuyView,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_SELECT:b8e.enc(),C2V_SCROLL_DOWN:b8e.enc(),C2V_UPDATE_BOTTOM:b8e.enc()}),b8e.RC("$$game","$$StrongerEvts",e)}(),function(){var e=game.Control.extends({init:function(){game.strongerData.initCfg(),this.strongerAlert=game.spotAlert.set(game.SAE.STRONGER_ALERT)},triggerOpen:function(e){e==this.moduleEnum&&this.dptG(game.ActiveBarGEvts.REFRESH_BTNS)},ipc:function(){this.evts={DailyFuLi:{C_INIT_MODULE:this.netInit},MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={StrongerMsg:this.onStrongerNotify,StrongerExpAwardResp:this.onStrongerExpAwardResp}},netInit:function(e){e&&e.data&&(game.strongerData.initNetData(e.data),this.checkAlert())},resetDaily:function(){game.strongerData.dailyReset()},onStrongerNotify:function(e){var t=e.readProtobuf(game.pb.StrongerNotify);0<t.code?game.notice.noticeError(t.code):(game.strongerData.setNotifyData(t),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_BOTTOM))},onStrongerExpAwardResp:function(e){var t=e.readProtobuf(game.pb.StrongerExpAwardResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.strongerData;a.addBox(t.exp),a.checkIsGetAllBox()&&a.reSetBox(),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_BOTTOM)}},checkAlert:function(){for(var e,t=game.strongerData.getCurExp(),a=1;a<5;a++)if(e=25*a,!game.strongerData.isOpenBox(e)&&e<=t)return void(this.strongerAlert.alert=!0);this.strongerAlert.alert=!1},btn_1:function(){this.selectToggle(1)},btn_2:function(){this.selectToggle(2)},btn_3:function(){this.selectToggle(3)},selectToggle:function(e){game.strongerData.setIndexId(e),this.send(this.Evts.C2V_SELECT,e)},down_btn:function(){this.send(this.Evts.C2V_SCROLL_DOWN)},box25:function(){this.onBoxClick(25)},box50:function(){this.onBoxClick(50)},box75:function(){this.onBoxClick(75)},box100:function(){this.onBoxClick(100)},onBoxClick:function(e){var t=game.strongerData.getCurExp();!game.strongerData.isOpenBox(e)&&e<=t&&this.sender.StrongerExpAwardReq(e)}}),t=game.Sender.extends({ipc:function(){this.msg={StrongerExpAwardReq:this.strongerExpAwardReq}},strongerExpAwardReq:function(e){var t=game.pb.StrongerExpAwardRequest;t.exp=e,this.write(t)}});b8e.module.registerControl(game.ME.Stronger,e,game.StrongerEvts,t)}(),function(){var e=game.Control.extends({});b8e.module.registerControl(game.ME.LevelUpWay,e,game.StrongerEvts)}(),function(){var e=game.Control.extends({gotoBtn1:function(){game.module.showToggle(game.ME.MainInstance)},gotoBtn2:function(){game.module.showToggle(game.ME.Boss,2)},gotoBtn3:function(){game.module.showToggle(game.ME.InstanceFunc,0)}});b8e.module.registerControl(game.ME.GetBangYuan,e)}(),function(){var e=game.Control.extends({gotoBtn1:function(){},gotoBtn2:function(){this.goHideTip(),game.module.showToggle(game.ME.Welfare,8)},gotoBtn3:function(){},goHideTip:function(){game.module.hide(game.ME.GetYinLiang)}});b8e.module.registerControl(game.ME.GetYinLiang,e)}(),function(){var e=b8e.Object.extends({initCfg:function(){this.setIndexId(1);var e,t,a=game.StrongerCfg.getDatas(),i=a.length;this.boxArr=[],this.expAll=0,this.expTypeMap=b8e.HashMap.get(),this.infoArr=[];for(var n=0;n<i;n++)e=a[n],(t=new game.StrongerInfo).setCfg(e),this.infoArr.push(t),e.strongerExpType&&this.expTypeMap.set(e.strongerExpType,n)},getIndexInfos:function(e){for(var t,a=this.infoArr,i=a.length,n=[],s=0;s<i;s++)(t=a[s]).indexId==e&&n.push(t);return n},setIndexId:function(e){this.indexId=e},getLevelUpInfos:function(){var e=this.getIndexInfos(3);if(e.length<=3)return e;for(var t,a=[],i=0;i<3;i++)t=e[i],a.push(t);return a},initNetData:function(e){for(var t,a=e.stronger,i=a.length,n=this.expTypeMap,s=this.infoArr,o=0;o<i;o++)t=a[o],s[n.get(t.strongerType)].setNetData(t.times);this.expAll=e.strongerExp,this.boxArr=e.strongerAward},addBox:function(e){this.boxArr.push(e)},setNotifyData:function(e){var t=e.stronger,a=this.expTypeMap.get(t.strongerType);this.infoArr[a].setNetData(t.times),this.expAll=e.strongerExp},checkIsGetAllBox:function(){return 3<this.boxArr.length},reSetBox:function(){this.boxArr=[],this.expAll=0},dailyReset:function(){var a=this;a.expTypeMap.forEach(function(e,t){a.infoArr[t].dailyReset()},a)},getCurExp:function(){return this.expAll},isOpenBox:function(e){return-1<this.boxArr.indexOf(e)}});game.strongerData=game.strongerData||new e}(),function(){var e;e=b8e.Object.extends({curTiems:0,isFinish:!1,setCfg:function(e){var t=this;t.indexId=e.indexId,t.icon=e.icon,t.titleName=e.titleName,t.starNum=e.starNum,t.des=e.des,t.moduleEnum=e.moduleEnum,t.toggle=e.toggle,t.strongerExpType=e.strongerExpType,t.time=e.time,t.exp=e.exp,t.curTiems=0,t.isFinish=!1},setNetData:function(e){var t=this.time;this.isFinish=t<=e,this.curTiems=this.isFinish?t:e},dailyReset:function(){this.curTiems=0,this.isFinish=!1}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$StrongerInfo",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(984)},init:function(){var e=this._title=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.title);var t=this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=game.StrongerItemView,t.bindEnum=this.moduleEnum,t.addToParent(this.skin.listNode),t.layout.paddingLeft=0,t.layout.paddingRight=0,t.layout.paddingTop=0,t.layout.paddingBottom=0,this.initBox()},initBox:function(){this.skin;for(var e,t,a,i,n,s,o=1;o<5;o++){if(e=25*o,!(t=game.StrongerExpAwardCfg.getData(e)))return;i=t.items[0].Id,n=t.items[0].Num,a=new game.ItemIcon(game.IconSizeEnum.SIZE_84),s=game.ItemUtil.createBaseItemInfo(i,n),a.setItemInfo(s,!1,0),a.setNum(n),a.addToParent(this.getComponent("box"+e))}},notify:function(e){switch(e){case this.Evts.C2V_SELECT:this.updateShow();break;case this.Evts.C2V_SCROLL_DOWN:this.scrollNextPage();break;case this.Evts.C2V_UPDATE_BOTTOM:this.updateBottom()}},onShow:function(){this.updateShow()},updateShow:function(){this.updateView(),this.updateBtns()},updateView:function(){var e=game.strongerData,t=e.indexId,a=e.getIndexInfos(t);this.skin;if(a&&!(a.length<1)){var i=game.StrongerIndexCfg.getData(t);if(i){var n=game.ResCfg.getImgUrl(i.title);this._title.loadTexture(n),this.updateBottom()}this._list.setData(a)}},updateBtns:function(){this.skin;for(var e,t=game.strongerData.indexId,a=1;a<4;a++)e=t==a,this.getComponent("light"+a).active=e,this.getComponent("dark"+a).active=!e},updateBottom:function(){var e,t,a,i=this.skin,n=game.strongerData.getCurExp();i.active_num.string=n,i.pro_active.width=Math.min(430,n/100*430);for(var s=1;s<5;s++)e=25*s,t=game.strongerData.isOpenBox(e),a=e<=n,this.getComponent("boxOpen"+e).active=t,this.getComponent("red"+e).active=!t&&a},scrollNextPage:function(){var e=this._list._container.x,t=this._list._container.y+620,a=this._list._mouseTop;t=Math.min(t,a),this._list.scrollToPos({x:e,y:t})},onHide:function(){game.strongerData.setIndexId(1)}});b8e.module.registerView(game.ME.Stronger,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(983),this.setSize(600,170)},init:function(){var e=this._icon=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.icon)},setData:function(){var e=this.data,t=this.skin,a=game.ResCfg.getImgUrl(e.icon);this._icon.loadTexture(a),t.title.string=e.titleName;for(var i=e.starNum,n=1;n<6;n++)this.getComponent("starIcon"+n).active=n<=i;t.desLab.string=e.des,this.moduleEnum=e.moduleEnum,this.toggle=e.toggle,t.jifenNode.active=!!e.strongerExpType,e.strongerExpType&&(t.times.string="("+e.curTiems+"/"+e.time+")",t.jifenCount.string=e.exp,t.times.active=!e.isFinish,t.finish.active=e.isFinish)},gotoBtn:function(){var e=this.moduleEnum,t=this.toggle;e&&t?game.module.showToggle(e,t-1):game.module.show(e)}}),b8e.RC("$$game","$$StrongerItemView",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(982)},init:function(){var e=this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.LevelUpWayItemView,e.bindEnum=this.moduleEnum,e.addToParent(this.skin.listNode),e.layout.paddingLeft=0,e.layout.paddingRight=0,e.layout.paddingTop=0,e.layout.paddingBottom=0},onShow:function(){this.updateView()},updateView:function(){var e=game.strongerData.getLevelUpInfos();!e||e.length<1||this._list.setData(e)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width)-4,.5*(t+this.height)+50)}});b8e.module.registerView(game.ME.LevelUpWay,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(981),this.setSize(540,170)},init:function(){var e=this._icon=b8e.Sprite.get();e.setAnchor(.5,.5),e.addToParent(this.skin.icon)},setData:function(){var e=this.data,t=this.skin,a=game.ResCfg.getImgUrl(e.icon);this._icon.loadTexture(a),t.title.string=e.titleName;for(var i=e.starNum,n=1;n<6;n++)this.getComponent("starIcon"+n).active=n<=i;t.desLab.string=e.des,this.moduleEnum=e.moduleEnum,this.toggle=e.toggle,t.jifenNode.active=!!e.strongerExpType,e.strongerExpType&&(t.times.string="("+e.curTiems+"/"+e.time+")",t.jifenCount.string=e.exp,t.times.active=!e.isFinish,t.finish.active=e.isFinish)},gotoBtn:function(){var e=this.moduleEnum,t=this.toggle;e&&t&&game.module.showToggle(e,t-1)}}),b8e.RC("$$game","$$LevelUpWayItemView",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(980)},init:function(){this._itemGrid=game.GridUtil.createItemIcon(),this._itemGrid.addToParent(this.skin.icon),this.setShowData(22)},setShowData:function(e){var t=game.ItemInfoCfg.getData(e);if(t){var a=this.skin,i=game.ItemUtil.createBaseItemInfo(e,1);game.GridUtil.setItemIcon(this._itemGrid,i,!1,2);var n=game.HtmlUtil,s=n.getColorByQuality(t.quality);a.name.string=n.getText(s,t.name)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GetBangYuan,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(980)},init:function(){this._itemGrid=game.GridUtil.createItemIcon(),this._itemGrid.addToParent(this.skin.icon),this.setShowData(23)},setShowData:function(e){var t=game.ItemInfoCfg.getData(e);if(t){var a=this.skin,i=game.ItemUtil.createBaseItemInfo(e,1);game.GridUtil.setItemIcon(this._itemGrid,i,!1,2);var n=game.HtmlUtil,s=n.getColorByQuality(t.quality);a.name.string=n.getText(s,t.name)}},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)},onShow:function(){this.skin.gotoBtn2.string=game.Lang.get(6322),this.skin.gotoBtn1.active=!1,this.skin.gotoBtn3.active=!1}});b8e.module.registerView(game.ME.GetYinLiang,e)}(),function(){var e=game.View.extends({_selectChannel:game.ChatChannelType.ALL,_showModel:!0,ctor:function(){this._super(1180),this.toggles={btnToggle1:null,btnToggle2:null,btnToggle3:null,btnToggle4:null}},init:function(){var e=this.skin,t=this.chatList=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);t.itemRender=[game.ChatPrivateItemSelfView,game.ChatPrivateItemOtherView,game.ChatItemView2],t.addToParent(e.list),t.bindEnum=game.ME.MainUIChat,this.pos={x:60,y:660},game.LabelUtil.setEditBoxDefault(e.input_editbox,9045,game.Color.BLACK,this)},layoutList:function(){this.chatList.scrollToBottom()},notify:function(e,t){switch(e){case game.ChatEvts.SELECT_CHANNEL2:this.toggleSelect(t);break;case game.ChatEvts.UPDATE_CHANNEL:this.updateChatData();break;case game.ChatEvts.SEND_CHAT2:this.sendInputText();break;case game.ChatEvts.ADD_CHAT_EMOTION2:this.addEmotion(t)}},sendInputText:function(){var e=this.skin,t=this._selectChannel<=0?game.ChatChannelType.WORLD:this._selectChannel,a=game.ChatCfg.getData(t);if(a)if(game.mainRoleData.lv<a.openLv)game.notice.show(9594,a.openLv);else{if(game.mainRoleData.lv<a.limitLv)return null!=this.quickChatId?void this.sendChatContend(""):void 0;var i=e.input_editbox.string;""!==i?i.length>a.wordLimit?game.notice.show(9589,a.wordLimit):this.sendChatContend(i):game.notice.show(9031)}else b8e.warn(this._selectChannel,"\u804a\u5929\u9891\u9053\u6ca1\u6709\u914d\u7f6e\uff1f")},sendChatContend:function(e){var a=this._selectChannel;this._selectChannel===game.ChatChannelType.ALL&&(a=game.ChatChannelType.WORLD);var t=game.sceneData.isGuildConflict();a!==game.ChatChannelType.WORLD||t||game.sceneData.isCsScene(!0)&&(a=game.ChatChannelType.CROSS);var i=game.chatData.getLastSendTimeByChannel(a),n=game.SysTime.curTime;game.chatData.getChannelChatCD(a)<n-i?game.sdk.msgSecCheck(e,function(e,t){this.send(game.ChatEvts.SEND_CHAT,{content:t,channel:a,quickChatContent:this.quickChatId}),this.quickChatId=void 0,this.skin.input_editbox.setEditBoxText(""),this.updateQuickChat(),game.chatData.setLastSendTimeByChannel(a,n)},this,!1):game.notice.show(9032)},addEmotion:function(e){var t=this.skin,a=this._selectChannel<=0?game.ChatChannelType.WORLD:this._selectChannel,i=game.ChatCfg.getData(a);if(i){var n=e;if(4+t.input_editbox.string.length>i.wordLimit){game.notice.show(9589,i.wordLimit)}else{var s=t.input_editbox.string+n;t.input_editbox.setEditBoxText(s)}}else{b8e.warn(this._selectChannel,"\u804a\u5929\u9891\u9053\u6ca1\u6709\u914d\u7f6e\uff1f")}},onShow:function(){this.toggleSelect(0);var e=game.sceneData.isGuildConflict();this.skin.btn4.active=e},onHide:function(){game.ChatEmotionView.inst().isShow&&game.ChatEmotionView.inst().hidePopView(),game.ChatQuickSendView.inst().isShow&&game.ChatQuickSendView.inst().hidePopView()},toggleSelect:function(e){if(this._super(e)){switch(e){case 0:this._selectChannel=game.ChatChannelType.ALL;break;case 1:this._selectChannel=game.ChatChannelType.WORLD;break;case 2:this._selectChannel=game.ChatChannelType.GUILD;break;case 3:this._selectChannel=game.ChatChannelType.Clash}this.updateChatData(),this.updateQuickChat()}},updateQuickChat:function(){var e=this._selectChannel;if(this._selectChannel===game.ChatChannelType.ALL&&(e=game.ChatChannelType.WORLD),e==game.ChatChannelType.WORLD){var t=game.ChatCfg.getData(e);if(!t)return void b8e.warn(e,"\u804a\u5929\u9891\u9053\u6ca1\u6709\u914d\u7f6e\uff1f");if(game.mainRoleData.lv>=t.limitLv)return void this.setClickBtn(!1);var a=game.chatData.getRandomChatCfg(),i=a?a.content:"";this.skin.input_editbox.setEditBoxText(i),this.quickChatId=a&&0|a.id,game.taskData.isChatTask=!1,this.setClickBtn(!0)}else this.skin.input_editbox.setEditBoxText(""),this.quickChatId=void 0,this.setClickBtn(!1)},updateChatData:function(){this.chatInfoList=game.chatData.getChatListByChannelType(this._selectChannel),this.chatList.setData(this.chatInfoList),b8e.hasTimeout(this.layoutList,this)||b8e.setTimeout(this.layoutList,this,100)},setClickBtn:function(e){var t=this.skin.chat_lock_btn;(t.active=e)?t.__hasInputEvent||(t.__hasInputEvent=!0,b8e.evt.onC(t,this.inputBoxTouchStart,this)):t.__hasInputEvent&&(t.__hasInputEvent=!1,b8e.evt.offC(t,this.inputBoxTouchStart,this))},inputBoxTouchStart:function(e){e.isPropagationStopped=!0;var t=this._selectChannel<=0?game.ChatChannelType.WORLD:this._selectChannel,a=game.ChatCfg.getData(t);a?game.mainRoleData.lv<a.openLv?game.notice.show(9594,a.openLv):game.mainRoleData.lv<a.limitLv&&(game.ChatQuickSendView.inst().isShow?game.ChatQuickSendView.inst().hidePopView():game.ChatQuickSendView.inst().showPopView(1)):b8e.warn(this._selectChannel,"\u804a\u5929\u9891\u9053\u4e3a\u5565\u6ca1\u6709\u914d\u7f6e\uff1f")}});b8e.module.registerView(game.ME.ChatView,e)}(),function(){var e;(e=game.ChatItemView.extends({ctor:function(){this._super(1181),this.setSize(420,23)},init:function(){},setMaxWidth:function(){}})).poolCall=!0,b8e.RC("$$game","$$ChatItemView2",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_CLICK_BTN:b8e.enc(),V2C_SEND_MESSAGE:b8e.enc()}),b8e.RC("$$game","$$FeedBackEvts",e)}(),function(){var e=game.Control.extends({notify:function(e,t){switch(e){case this.Evts.V2C_SEND_MESSAGE:this.sendMessage(t)}},sendMessage:function(e){var t=game.mainRoleData,a=game.LoginConfig,i=a.gameChannelId+"",n={$$role_id:t.roleId,$$zone:a.serverId,$$channel_id:i,$$name:t.name,$$level:t.lv,$$vip:t.vipLevel,$$content:e},s=a.suggestUrl;game.sdk.sdkNet.requestData(s,n,function(e,t){if(e)return b8e.error(e),void b8e.Toast.launch("\u53cd\u9988IO\u9519\u8bef",4294901760);t&&0==t.code&&game.notice.show(9125)},this,null,!0,{struct:{$$code:!0},isJson:!0})},sendBtn:function(){this.send(this.Evts.C2V_CLICK_BTN)}});b8e.module.registerControl(game.ME.FeedBack,e,game.FeedBackEvts)}(),function(){var e=game.View.extends({ctor:function(){this._super(363)},init:function(){this.skin.banner.loadTexture(game.ResCfg.getUrl(252))},notify:function(e){switch(e){case this.Evts.C2V_CLICK_BTN:this.getMessage()}},getMessage:function(){var e=this.skin.feedBackEditBox.string;""===e?game.notice.show(2311):(this.skin.feedBackEditBox.string="",this.send(this.Evts.V2C_SEND_MESSAGE,e))},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.FeedBack,e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_SHOW:-1}),b8e.RC("$$game","$$FuncNoticeEvts",e)}(),function(){var e=b8e.Object.extends({ctor:function(){},getNextOpenIcon:function(){var e=game.miscData.openServerDay,t=game.FuncNoticeCfg.getNextOpenDay(e);return t?game.ResCfg.getUrl(85,t.icon):""},getNextOpenImg:function(){var e=game.miscData.openServerDay,t=game.FuncNoticeCfg.getNextOpenDay(e);return t?game.ResCfg.getUrl(84,t.img):""},getNoticeIsOpen:function(){var e=game.miscData.openServerDay,t=game.FuncNoticeCfg.getNextOpenDay(e);if(!t)return!1;var a=game.mainRoleData.lv;return!(e==t.openDay&&a>=t.lv)&&!(e<t.limitShowOpenDay)},getNoticeStr:function(e){var t=game.FuncNoticeCfg.getNextOpenDay(e);if(!t)return"";if(e<t.openDay-1)return game.Lang.get(5905);if(e==t.openDay-1)return game.Lang.get(5904);var a=game.mainRoleData.lv;return e==t.openDay&&a<t.lv?game.Lang.get(5906,t.lv):""},getCurDayIsOpen:function(){var e=this.getCurDayCfg();return!!e&&!(game.mainRoleData.lv<e.lv)},getCurOpenIcon:function(){var e=this.getCurDayCfg();return e?game.ResCfg.getUrl(85,e.icon):""},getCurOpenImg:function(){var e=this.getCurDayCfg();return e?game.ResCfg.getUrl(84,e.img):""},getCurDayCfg:function(){var e=game.miscData.openServerDay;return game.FuncNoticeCfg.getCurDayCfg(e)}});game.funcNoticeData=game.funcNoticeData||new e}(),function(){var e=game.Control.extends({ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily}}},resetDaily:function(){this.send(game.FuncNoticeEvts.C2V_UPDATE_SHOW)}}),t=[game.ME.TodayFuncNotice];b8e.module.registerControl(game.ME.FuncNotice,e,null,null,t)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(441)},init:function(){this.moduleData=game.funcNoticeData},notify:function(e){switch(e){case game.FuncNoticeEvts.C2V_UPDATE_SHOW:this.noticeShow()}},onShow:function(){this.noticeShow()},noticeShow:function(){if(game.funcNoticeData.getNoticeIsOpen()){var e=this.moduleData.getNextOpenImg();this._img||(this._img=b8e.Sprite.get(),this._img.setAnchor(.5,.5),this.skin.content.addChild(this._img)),this._img.loadTexture(e)}else game.module.hide(this.moduleEnum)},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.FuncNotice,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(441)},init:function(){},notify:function(e){switch(e){case game.FuncNoticeEvts.C2V_UPDATE_SHOW:this.noticeShow()}},onShow:function(){this.noticeShow()},noticeShow:function(){var e=game.funcNoticeData;if(e.getCurDayIsOpen()){var t=e.getCurOpenImg();this._img||(this._img=b8e.Sprite.get(),this._img.setAnchor(.5,.5),this.skin.content.addChild(this._img)),this._img.loadTexture(t)}else game.module.hide(this.moduleEnum)},onStageResize:function(){var e=b8e.stageWidth,t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(.5*(e-this.width),t)}});b8e.module.registerView(game.ME.TodayFuncNotice,e)}(),function(){var e;e=game.Widget.extends({ctor:function(e,t,a){this._super(0==e?"formation/cur_formation":"formation/pre_formation"),this.bindEnum=t,this.slotId=a},init:function(){this._model=b8e.SceneEntity.get(),this._model.addToParent(this.skin.modelNode),this.scale=1},show:function(e){this.data=e,this._super()},onShow:function(){this.setData()},setData:function(){var e=this.data;if(e){this.getComponent("num"+this.slotId).active=!0;var t=1==e.openState;this.skin.unactiveBg.active=!t,(this.skin.activeBg.active=t)||0!=e.type||(this.skin.hintLab.string=e.getHintString()),this.skin.viewReplaceBtn.active=t&&0<e.petId,this.skin.viewBattleBtn.active=t&&e.petId<1,this.creatModel()}},addFlag:function(){var e=this;if(e._flag||(e._flag=b8e.Sprite.get(),e._flag.setAnchor(.5,0)),e._flag.parent&&e._flag.removeFromParent(),e._model){var t=e._model.getAnimator(game.AnimType.UI_EFFECT,1);t&&t.addChildToBindNode(e._flag,"HP")}var a=1/e.scale;e._flag.setScale(a,a),e._flag.loadTexture(game.ResCfg.getImgUrl("formation/flag"))},creatModel:function(){if(this._model&&this.data){this.scale=1;var e=this._model.getAnimator(game.AnimType.UI_EFFECT,1);e&&e.clear()}},animaCB:function(){var e=this.data;e&&0==e.type&&1==e.slot&&0<e.petId&&this.addFlag()},onHide:function(){if(this._model){var e=this._model.getAnimator(game.AnimType.UI_EFFECT,1);e&&e.clear()}this._flag&&this._flag.unloadTexture()},viewBattleBtn:function(){this.data&&this.send(game.PetEvts.V2C_BATTLE_CHANGE,this.data.slot)},viewReplaceBtn:function(){this.viewBattleBtn()}}),b8e.RC("$$game","$$PetBattleGrid",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_DAMAGE_INFO:-1,C2V_SKILL_RELEASE:-1,C2V_SKILL_HIT:-1,V_FOLLOW_CHAT:-1}),b8e.RC("$$game","$$GeneralBossBattleEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_ITEM:-1,C2V_UPDATE_VIEW:-1,V2C_SYSNINFO:-1,C2C_BATTLE_RESULT:-1,C2C_KILL_LOG:-1,C2C_DAMAGE_LOG:-1,V2C_BOSS_SELECT:-1,C2V_UPDATA_TIP:-1}),b8e.RC("$$game","$$GeneralBossEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2V_UPDATE_ITEM:-1}),b8e.RC("$$game","$$GeneralBossLogViewEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,V2C_SET_IGNORE:-1,C2V_SET_IGNORE:-1}),b8e.RC("$$game","$$GeneralBossSettingEvts",e)}(),function(){var e;e=b8e.Enum({NONE:0,C2C_BUY_CHALLAGE:-1}),b8e.RC("$$game","$$GeneralBossVipEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GeneralBoss:{C2C_BATTLE_RESULT:this.onBattleResult}},this.gevts={InstanceEvts:{G_STOP_PLAY:this.onBattleOver,G_SKILL_RELEASE:this.onSkillRelease,G_SKILL_HIT:this.onSkillHit}}},onSkillRelease:function(e){if(b8e.module.isShowView(game.ME.GeneralBossBattle))this.send(this.Evts.C2V_SKILL_RELEASE,e.data);else;},onSkillHit:function(e){if(b8e.module.isShowView(game.ME.GeneralBossBattle)){var a=e.data;a&&a.roleData.type==game.RoleType.Monster&&game.MonsterCfg.getDataAsync(a.roleId,function(e){if(e&&1==e.type){var t=game.generalBossData.battleResult.emulator;game.generalBossData.selfDamage.damage+=a.value,this.doRank(t),this.send(this.Evts.C2V_SKILL_HIT,a)}else;},this)}else;},onBattleResult:function(e){var t=e?e.data:null;t&&(this.send(this.Evts.C2V_DAMAGE_INFO,t),game.generalBossData.setBossHp(t))},onBattleOver:function(e){if(e&&e.data&&e.data.type==game.InstanceType.GENERAL_BOSS){var t=game.generalBossData;t.setBossHp(t.battleResult)}},doRank:function(e){if(e){e.sort(function(e,t){return t.damage-e.damage});for(var t=0,a=e.length;t<a;t++){e[t].rank=t+1}}else;},btn_skip:function(){game.playBack.stop()}});b8e.module.registerControl(game.ME.GeneralBossBattle,e,game.GeneralBossBattleEvts,null)}(),function(){var e=game.Control.extends({init:function(){this.bossData=game.generalBossData,this.bossData.init(),this.chat={chatType:game.ChatChannelType.SYSTEM,marqueeKey:"jianghun_relive",funcType:game.ChatFuncType.CHAT_FUNC_JIANGHUN_BOSS}},ipc:function(){this.evts={MainRole:{C_LEVEL_UP:this.onRoleLvUp},Instance:{SYNC_INSTANCE_DATA:this.onSyncInstanceData},GeneralBossVip:{C2C_BUY_CHALLAGE:this.onBuyChallage}},this.handels={JiangHunChallengeResp:this.onJiangHunChallengeRsp,JiangHunInfoResp:this.onJiangHunInfoRsp,JiangHunBuyResp:this.onJiangHunBuyRsp,JiangHunMsg:this.onJiangHunMsg}},triggerOpen:function(e){e==this.moduleEnum&&this.sender.JiangHunInfoReq()},onJiangHunChallengeRsp:function(e){var t=e.readProtobuf(game.pb.JiangHunChallengeResponse);if(0<t.code)game.notice.noticeError(t.code);else{this.bossData.setBattleResult(t),this.bossData.addCount(),game.InsFunCountData.addChallengeCount(game.InsFunCountType.JIANGHUN);var a=this.bossData.battleResult;a.battlelog.win=!0;var i={type:game.InstanceType.GENERAL_BOSS,rewards:a.useritem,exp:a.exp};game.playBack.play(a.battlelog,i),this.dpt(this.Evts.C2C_BATTLE_RESULT,a)}},onJiangHunInfoRsp:function(e){var t=e.readProtobuf(game.pb.JiangHunInfoResponse);0<t.code?game.notice.noticeError(t.code):(this.bossData.setup(t),this.runBossTimer(),this.send(this.Evts.C2V_UPDATE_VIEW),this.checkAlert())},onJiangHunBuyRsp:function(e){var t=e.readProtobuf(game.pb.JiangHunBuyResponse);0<t.code?game.notice.noticeError(t.code):(game.module.hide(game.ME.GeneralBossVip),this.bossData.buyTimes=t.buyTimes,this.send(this.Evts.C2V_UPDATE_VIEW),this.checkAlert())},onJiangHunMsg:function(e){var t=e.readProtobuf(game.pb.JiangHunNotify);0<t.code?game.notice.noticeError(t.code):(!game.generalBossSettingData.isIgnore(t.bossId)&&game.moduleOpen.checkOpen(this.moduleEnum)&&t.reliveTime<1&&this.addChatItem(t.roleName,t.bossId),game.generalBossData.rebirthBoss(t.bossId,t.reliveTime),this.runBossTimer(),this.send(this.Evts.C2V_UPDATE_ITEM),this.checkAlert())},notify:function(e){switch(e){case this.Evts.V2C_SYSNINFO:this.sender.JiangHunInfoReq();break;case this.Evts.V2C_BOSS_SELECT:this.send(this.Evts.C2V_UPDATE_ITEM)}},onBuyChallage:function(){this.sender.JiangHunBuyReq()},onSyncInstanceData:function(e){if(e&&e.data&&this.bossData){var t=e.data;this.bossData.buyTimes=t.jiangHunBuyTimes,this.bossData.setCount(t.jianghunCount)}},onClickKillLog:function(e){var t=this.bossData&&this.bossData.killRecords?this.bossData.killRecords.get(e):null;t?this.dpt(this.Evts.C2C_KILL_LOG,t):b8e.warn("\u5c06\u9b42BOSS\u6b7b\u4e86\uff0c\u5c45\u7136\u6ca1\u6709\u51fb\u6740\u8bb0\u5f55\uff01\uff01\uff01")},onClickDamageLog:function(e){var t=this.bossData&&this.bossData.damageInfos?this.bossData.damageInfos.get(e):null;this.dpt(this.Evts.C2C_DAMAGE_LOG,t)},checkAlert:function(){},btn_setting:function(){game.module.show(game.ME.GeneralBossSetting)},btn_buy:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e),a=t?t.jiangHun:0,i=a-game.generalBossData.buyTimes;i=0<=i?i:0;for(var n,s=game.CostCfg.getDatasByType(game.CostType.GENERAL_BOSS,!0),o=0,r=s.length;o<r&&(n=s[o]).num!=game.generalBossData.buyTimes+1;o++);var g="",l=0;if(n&&n.items&&n.items.length){var c=game.ItemInfoCfg.getData(n.items[0].Id);g=c?c.name:"",l=n.items[0].Num}game.alert.show({lang:519,langArgs:[l,g,3,i,e,a],btn:game.Lang.get(9146),okcb:this.onBuyChallage,thisArg:this})},onRoleLvUp:function(){this.bossData&&(this.bossData.createBossInfos(),this.send(this.Evts.C2V_UPDATE_ITEM))},createBossTimer:function(){this.bossTimer||(this.bossTimer=b8e.Timer.add(this,this.updateBossTime,1e3),this.bossTimer.start())},clearBossTimer:function(){this.bossTimer&&(b8e.Timer.remove(this,this.updateBossTime),this.bossTimer=null)},runBossTimer:function(){this.bossData.isCountdown?this.createBossTimer():this.clearBossTimer()},updateBossTime:function(){if(this.bossData.bossInfos){var a,i=0;this.bossData.bossInfos.forEach(function(e,t){0<t.reliveTime&&(a=t.reliveTime-b8e.TimeUtil.SECOND_MICRO_SECONDS,t.reliveTime=0<=a?a:0,i++)},this),i<1&&this.clearBossTimer()}},addChatItem:function(e,t){this.chat.roleName=e,this.chat.params=""+t,game.chatData.addChat(this.chat),this.dptG(game.ChatEvts.SHOW_CLIENT_CHAT,null)},btn_shop:function(){this.dptG(game.ShopGEvts.SHOW_SHOP,game.ShopIdEnum.GENERAL_SHOP)},btn_enter:function(){if(!game.UpgradeUtil.checkEquipTooMuch()){var e=game.generalBossData.selectBoss;if(e&&e.reliveTime<=0&&!game.playBack.isInstanceFighting()&&!game.sceneData.isGuildMap()){var t=game.InstanceMiscCfg.getData("jiangHunBuy"),a=t?parseInt(t.value):0,i=game.InstanceMiscCfg.getData("jiangHunMax");if(0<(i?parseInt(i.value)+game.generalBossData.buyTimes*a:0)-game.generalBossData.challage)this.sender.JiangHunChallengeReq(e.bossId);else game.UpgradeUtil.checkItemInfo(302006,1,!1)?game.generalBossData.autoFight?this.sender.JiangHunChallengeReq(e.bossId,!0):game.module.show(game.ME.GeneralBossTip):game.notice.show(game.Lang.get(6016))}}},btn_log:function(){var e=game.generalBossData.selectBoss;e&&this.onClickKillLog(e.bossId)},lab_count:function(){var e=game.generalBossData.selectBoss;e&&this.onClickDamageLog(e.bossId)},returnBtn:function(){game.module.hide(game.ME.GeneralBossTip)},challengeBtn:function(){game.module.hide(game.ME.GeneralBossTip);var e=game.generalBossData.selectBoss;this.sender.JiangHunChallengeReq(e.bossId,!0)},auto:function(){game.generalBossData.autoFight?game.generalBossData.autoFight=!1:game.generalBossData.autoFight=!0,this.send(this.Evts.C2V_UPDATA_TIP)}}),t=[game.ME.GeneralBossTip],a=game.Sender.extends({ipc:function(){this.msg={JiangHunInfoReq:null,JiangHunBuyReq:null,JiangHunChallengeReq:this.jiangHunChallengeReq,JiangHunSetNoticeReq:this.jiangHunSetNoticeReq}},jiangHunChallengeReq:function(e,t){var a=1<arguments.length&&void 0!==t&&t,i=game.pb.JiangHunChallengeRequest;i.bossId=e,i.useItem=a,this.write(i)},jiangHunSetNoticeReq:function(e,t){var a=game.pb.JiangHunSetNoticeRequest;a.bossId=e,a.ignore=t,this.write(a)}});b8e.module.registerControl(game.ME.GeneralBoss,e,game.GeneralBossEvts,a,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GeneralBoss:{C2C_DAMAGE_LOG:this.onClickLog}}},onClickLog:function(e){game.module.show(game.ME.GeneralBossDamageView),this.send(game.GeneralBossLogViewEvts.C2V_UPDATE_ITEM,e.data)}});b8e.module.registerControl(game.ME.GeneralBossDamageView,e,game.GeneralBossLogViewEvts,null)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GeneralBoss:{C2C_KILL_LOG:this.onClickLog}}},onClickLog:function(e){game.module.show(game.ME.GeneralBossLog);var t=e.data;if(!t||t.length<=0);else{var a=0;t.forEach(function(e){e.index=a,a++},this),this.send(game.GeneralBossLogViewEvts.C2V_UPDATE_ITEM,t)}}});b8e.module.registerControl(game.ME.GeneralBossLog,e,game.GeneralBossLogViewEvts,null)}(),function(){var e=game.Control.extends({init:function(){game.generalBossSettingData.init()},ipc:function(){this.evts={Instance:{SYNC_INSTANCE_DATA:this.onSyncInstanceData},MainRole:{C_LEVEL_UP:this.onRoleLvUp}},this.handels={JiangHunSetNoticeResp:this.onJiangHunSetNoticeRsp}},notify:function(e,t){switch(e){case game.GeneralBossSettingEvts.V2C_SET_IGNORE:this.sender.JiangHunSetNoticeReq(t.bossId,!t.ignore)}},onRoleLvUp:function(){game.generalBossSettingData.createSettingInfo()},onSyncInstanceData:function(e){var t=e&&e.data?e.data.jiangHunIgnoreList:null;if(!t||t.length<=0);else t.forEach(function(e){game.generalBossSettingData.setIgnoreById(e,!0)},this)},onJiangHunSetNoticeRsp:function(e){var t=e.readProtobuf(game.pb.JiangHunSetNoticeResponse);if(0<t.code){game.notice.noticeError(t.code)}else game.generalBossSettingData.setIgnoreById(t.bossId,t.ignore),this.send(game.GeneralBossSettingEvts.C2V_SET_IGNORE)}}),t=game.Sender.extends({ipc:function(){this.msg={JiangHunSetNoticeReq:this.JiangHunSetNoticeReq}},JiangHunSetNoticeReq:function(e,t){var a=game.pb.JiangHunSetNoticeRequest;a.bossId=e,a.ignore=t,this.write(a)}});b8e.module.registerControl(game.ME.GeneralBossSetting,e,game.GeneralBossSettingEvts,t)}(),function(){var e=game.Control.extends({sureBtn:function(){this.dpt(game.GeneralBossVipEvts.C2C_BUY_CHALLAGE)}});b8e.module.registerControl(game.ME.GeneralBossVip,e,game.GeneralBossVipEvts,null)}(),function(){var e;e=b8e.Object.extends({roleId:0,roleName:0,damage:0,rank:0,setData:function(e){if(e)this.roleId=e.roleId,this.rank=e.rank,this.roleName=e.roleName,this.damage=e.damage;else;}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GeneralBossDamageInfo",e)}(),function(){var e=b8e.Object.extends({victoryCount:0,_bossInfos:null,selectBoss:null,autoFight:null,ctor:function(){this._super(),this.killRecords=b8e.HashMap.get(),this.damageInfos=b8e.HashMap.get(),this.buyTimes=0,this.isCountdown=!1,this.battleResult=null},init:function(){},setup:function(e){e&&(this.bossDatas=e.infos,this.challage=e.challenge,this.updateBossDatas())},updateBossDatas:function(){if(!this.bossDatas||this.bossDatas.length<1);else this.isCountdown=!1,this.bossDatas.forEach(function(e){if(this.checkBossCanShow(e.bossId)){this.updateBossInfo(e.bossId,e)}},this)},bossInfos:{get:function(){if(this._bossInfos){return this._bossInfos}return this._bossInfos=b8e.HashMap.get(),this._initBossInfos(this._bossInfos),this._bossInfos}},_initBossInfos:function(e){if(e){var t=game.GeneralBossCfg.getDatas();if(t)for(var a,i,n=0;n<t.length;n++){if(i=t[n],0<n&&!this.checkBossCanShow(t[n-1].id))return;(a=e.get(i.id))||(a=new game.GeneralBossInfo(i.id),e.set(i.id,a)),a.setData()}else;}else;},createBossInfos:function(){this._initBossInfos(this.bossInfos)},updateBossInfo:function(t,e){var a=this;if(a.bossInfos){var i=a.bossInfos.get(t);i||(i=new game.GeneralBossInfo(t),a.bossInfos.set(t,i)),i.setData(e),0<i.reliveTime&&(a.isCountdown=!0),e.record&&0<e.record.length?e.record.forEach(function(e){a.updateKillRecord(t,e)},a):a.clearKillRecord(t),e.emulator&&0<e.emulator.length?e.emulator.forEach(function(e){a.updateDamageInfo(t,e)},a):a.clearDamageInfo(t)}},updateKillRecord:function(e,t){if(this.killRecords){var a=this.killRecords.get(e);if(!a){a=[],this.killRecords.set(e,a)}for(var i=0,n=a.length;i<n;i++){if((s=a[i]).roleId==t.roleId&&s.time==t.time){break}s=null}if(!s){var s=new game.GeneralBossKillRecord;a.push(s)}s.setData(t)}else;},clearKillRecord:function(e){if(this.killRecords)this.killRecords.del(e);else;},updateDamageInfo:function(e,t){if(this.damageInfos){var a,i=this.damageInfos.get(e);i||(i=[],this.damageInfos.set(e,i));for(var n=0,s=i.length;n<s&&(a=i[n]).roleId!=t.roleId;n++)a=null;a||(a=new game.GeneralBossDamageInfo,i.push(a)),a.setData(t)}},clearDamageInfo:function(e){if(this.damageInfos)this.damageInfos.del(e);else;},checkBossCanShow:function(e){var t=game.GeneralBossCfg.getData(e);return!!t&&game.mainRoleData.lv>=t.showLv},getBossDataById:function(e){if(!this.bossDatas)return null;for(var t,a=this.bossDatas,i=a.length-1;0<i;i--)if((t=a[i]).bossId==e)return t;return null},rebirthBoss:function(e,t){var a=this.getBossDataById(e);a&&(a.reliveTime=t),this.isCountdown=!1;var i=this.bossInfos?this.bossInfos.get(e):null;i&&(t<=0?i.setData():(i.reliveTime=t-game.SysTime.curTime,i.hp=-1,(i.hp=0)<i.reliveTime&&(this.isCountdown=!0)))},setBossHp:function(e){var t=this.bossInfos?this.bossInfos.get(e.bossId):null;t&&(t.hp=-1,t.hp=e.hp<=0?e.hp0:e.hp)},setBattleResult:function(t){if(t){this.battleResult=t,this.challage=t.challenge,this.challageBossHp=t.hp0;var e=t.emulator;if(e&&0<e.length){e.forEach(function(e){this.updateDamageInfo(t.bossId,e)},this);for(var a=game.mainRoleData.id,i=-1,n=0,s=e.length;n<s;n++)if(e[n].roleId==a){i=n;break}i<0?e.push(t.ownDamage):e[i]=t.ownDamage,this.selfDamage=t.ownDamage,this.doRank(e)}else this.clearDamageInfo(t.bossId)}else;},doRank:function(e){if(e){e.sort(function(e,t){return t.damage-e.damage});for(var t=0,a=e.length;t<a;t++){e[t].rank=t+1}}else;},setCount:function(e){this.victoryCount=e},getCount:function(){return this.victoryCount},addCount:function(e){var t=0<arguments.length&&void 0!==e?e:1;this.victoryCount+=t},setSelect:function(e){for(var t,a=game.generalBossData&&game.generalBossData.bossInfos?game.generalBossData.bossInfos.values():null,i=0;i<a.length;i++)(t=a[i]).select=e==t.bossId,e==t.bossId&&(this.selectBoss=t)}});game.generalBossData=game.generalBossData||new e}(),function(){var e;e=b8e.Object.extends({bossId:0,hp:0,isEnterShow:!1,select:!1,ctor:function(e){this._super(),this.bossId=e},setData:function(e){var t=this.getCfg(),a=game.mainRoleData.lv;if(this.challengeLv=t.challengeLv,e&&a>=t.challengeLv){if(this.reliveTime=e.reliveTime-game.SysTime.curTime,e.reliveTime<=0){this.hp=e.hp}else this.hp=this.reliveTime<0?t.hp:e.hp}else this.hp=t.hp,this.reliveTime=0;this.isEnterShow=a>=t.challengeLv},getCfg:function(){return game.GeneralBossCfg.getData(this.bossId)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GeneralBossInfo",e)}(),function(){var e;e=b8e.Object.extends({time:0,roleId:0,roleName:0,power:0,setData:function(e){if(e)this.time=e.time,this.roleId=e.roleId,this.roleName=e.roleName,this.power=e.power;else;}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GeneralBossKillRecord",e)}(),function(){var e=b8e.Object.extends({_settings:null,settings:{get:function(){if(this._settings){return this._settings}return this._settings=b8e.HashMap.get(),this._initSettingInfo(this._settings),this._settings}},_initSettingInfo:function(t){var e=game.GeneralBossCfg.getDatas();if(!e||e.length<1);else{var a,i=0,n=game.mainRoleData.lv;e.forEach(function(e){if(n<e.challengeLv);else{if(!(a=t.get(e.id))){a=new game.GeneralBossSettingInfo(e.id),t.set(e.id,a)}a.setData(e),a.index=i,i++}},this)}},createSettingInfo:function(){this._initSettingInfo(this.settings)},init:function(){},setIgnoreById:function(e,t){var a=this.settings?this.settings.get(e):null;if(a)a.ignore=t;else;},isIgnore:function(e){var t=this.settings?this.settings.get(e):null;if(t)return t.ignore;return!0},getDatas:function(){return this.settings?this.settings.values():null}});game.generalBossSettingData=game.generalBossSettingData||new e}(),function(){var e;e=b8e.Object.extends({bossId:0,ignore:!1,index:0,name:"",lv:0,ctor:function(e){this._super(),this.bossId=e},setData:function(e){if(e)this.name=e.name,this.lv=e.challengeLv;else;},getCfg:function(){return game.GeneralBossCfg.getData(this.bossId)}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GeneralBossSettingInfo",e)}(),function(){var e=game.View.extends({_isMoveUp:!1,_specialLayer:!0,ctor:function(){this._super(444),this.MaxHp=0,this.Hp=0,this.proWidth=435,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.C2V_DAMAGE_INFO:this.updateDamageInfo(t);break;case this.Evts.C2V_SKILL_HIT:this.onSkillHit(t)}},updateDamageInfo:function(e){if(!e){return this.skin.lab_rank.node.active=!1,void(this.skin.lab_mine.node.active=!1)}this.skin.lab_rank.node.active=!0,this.skin.lab_mine.node.active=!0,this.setBossHp(e.bossId),this.skin.lab_rank.string=this.getDamageInfoStr(e.emulator),this.skin.lab_mine.string=this.getSelfDamageInfoStr(e.ownDamage)},setBossHp:function(e){var t=game.GeneralBossCfg.getData(e);if(t)this.MaxHp=t.hp,this.setHp(game.generalBossData.challageBossHp);else;},setHp:function(e){this.Hp=0<=e?e:0,this.setBossHpProgress()},setBossHpProgress:function(){this.skin.lab_progress.string=this.Hp+"/"+this.MaxHp,this.skin.img_progress.node.width=this.proWidth*(this.Hp/this.MaxHp)},getSelfDamageInfoStr:function(e){if(!e||e.damage<1){return""}return game.Lang.get(517,e.rank,e.roleName,Math.min(this.MaxHp,e.damage))},getDamageInfoStr:function(e){if(!e||e.length<1){return""}for(var t,a="",i=0,n=0,s=e.length;n<s;n++){if(0<(t=e[n]).damage){a+=game.Lang.get(517,t.rank,t.roleName,Math.min(this.MaxHp,t.damage)),i++}if(3<i){break}}return a},onShow:function(){this._isMoveUp=game.chatData.isOpenChat,this.updateDamageInfo(game.generalBossData.battleResult),this.onStageResize()},onSkillHit:function(e){this.setHp(this.Hp-e.value);var t=game.generalBossData.battleResult.emulator,a=game.generalBossData.selfDamage;this.skin.lab_rank.string=this.getDamageInfoStr(t),this.skin.lab_mine.string=this.getSelfDamageInfoStr(a)},onStageResize:function(){b8e.stageHeight,b8e.stageWidth;this.setPosition(0,this.height+130)}});b8e.module.registerView(game.ME.GeneralBossBattle,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(445),this.setSize(540,94)},setData:function(){var e=this.data;if(e){var t=e.rank+1;this.skin.lab_name.string=e.roleName,this.skin.lab_power.string=e.damage;for(var a=1;a<4;a++){this.getComponent("rank"+a).node.active=t==a}if(3<t){this.skin.lab_time.string=t,this.skin.rank4.active=!0}else this.skin.lab_time.string="",this.skin.rank4.active=!1}else;}}),b8e.RC("$$game","$$GeneralBossDamageItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(446)},init:function(){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.GeneralBossDamageItem,this._list.bindEnum=game.ME.GeneralBossDamageView,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)},onShow:function(){this.skin.labTitle.string=game.Lang.get(520),this.skin.lab_item_title1.string=game.Lang.get(9147),this.skin.lab_item_title2.string=game.Lang.get(9148),this.skin.lab_item_title3.string=game.Lang.get(9149)},notify:function(e,t){switch(e){case game.GeneralBossLogViewEvts.C2V_UPDATE_ITEM:this.updateItem(t)}},updateItem:function(e){if(e){if(1<e.length){e.sort(function(e,t){return t.damage-e.damage})}for(var t=0;t<e.length;t++){e[t].rank=t}}this._list.setData(e)}});b8e.module.registerView(game.ME.GeneralBossDamageView,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(447),this.setSize(198,300),this.bossId=0},init:function(){this._model=b8e.SceneEntity.get(),this._model.addToParent(this.skin.model_root.node),this.progressWidth=this.skin.img_progress.node.width,this.skin.bossBg.loadTexture(game.ResCfg.getUrl(10072))},choose:function(){this.bossData&&(game.generalBossData.setSelect(this.bossData.bossId),this.send(game.GeneralBossEvts.V2C_BOSS_SELECT))},setData:function(e){var t=this;t.bossData=e,t.bossData&&(t.bossCfg=t.bossData.getCfg(),t.bossCfg&&(game.CfgUtil.getMonsterCfgByMonGroup(t.bossCfg.monGroup,1,function(e){t.setElementBtn(e)},t),t.setBossName(),t.setModel(),t.setSelect(),t.setProgress(),t.setBossStates()))},setBossName:function(){if(this.bossCfg){var e=game.Lang.get(9562,this.bossCfg.name,this.bossCfg.challengeLv);this.skin.lab_boss_name.string=game.HtmlUtil.getColorStrByQuality(this.bossCfg.quality,e)}},setProgress:function(){var e=this;if(e.bossData&&e.bossCfg){var t=e.bossCfg.hp,a=e.bossData.hp<=0?e.bossCfg.hp:e.bossData.hp,i=a/t;e.skin.img_progress.node.width=e.progressWidth*i,e.skin.lab_progress.string=(1<=i?100:(100*i).toFixed(1))+"%";var n=0<a;e.skin.img_progress.node.active=n,e.skin.lab_progress.node.active=n}},setBossStates:function(){var e=this;if(e.bossData&&e.bossData.bossId){var t=game.mainRoleData.lv>=e.bossCfg.challengeLv;e.skin.node_open.node.active=!t,e.skin.node_boss.node.active=t,e.skin.lab_open.node.string=game.Lang.get(514,e.bossCfg.challengeLv);var a=0<e.bossData.reliveTime&&t;e.skin.killBg.active=a,e.skin.progress_bar_bg.node.active=!a,a&&(e.skin.lab_rebirth_time.string=game.Lang.get(513,b8e.TimeUtil.formatTime(e.bossData.reliveTime)),e.setRebirthCost(),e.setRebirthTime())}},setRebirthCost:function(){var e=this.bossCfg.reliveCost;!e||e.length<1||(this.costItemInfo=game.ItemUtil.createBaseItemInfo(e[0].Id,e[0].Num,this.costItemInfo),game.GridUtil.setItemIcon(this._costGrid,this.costItemInfo,!1,0))},setRebirthTime:function(){this.rebirthTimer||(this.rebirthTimer=b8e.Timer.add(this,this.updateTime,1e3)),this.rebirthTimer.reset(),this.rebirthTimer.start()},updateTime:function(){this.bossData&&null!=this.bossData.reliveTime&&(this.skin.lab_rebirth_time.node.string=game.Lang.get(513,b8e.TimeUtil.formatTime(this.bossData.reliveTime)),this.bossData.reliveTime<=0&&(this.rebirthTimer.stop(),this.setBossStates(),this.send(game.GeneralBossEvts.V2C_BOSS_SELECT)))},setModel:function(){var e=this;if(e.bossData&&e.bossId!==e.bossData.bossId){if(e.bossId=e.bossData.bossId,!e.bossId)return void b8e.warn("bossId: ",e.bossId);var t=game.AvatarUtil.getUIModel(e.bossCfg),a=e.bossCfg?game.ResCfg.getUrl(5e3,t):null,i=e._model.getAnimator(game.AnimType.BODY,1);(i=i||e._model.addAnimator(game.AnimType.BODY,1))&&(a?(i.load(a),i.play()):i.clear())}},setSelect:function(){this.bossData&&(this.skin.bossChoose.active=this.bossData.select)},setElementBtn:function(e){var t=this.skin;e&&e.element?(this.elementAttr=e.element,t.view_elementBtn.active=!0,t.view_elementBtn.loadTexture(game.ResCfg.getUrl(10050,e.element))):t.view_elementBtn.active=!1},view_elementBtn:function(){this.elementAttr&&(game.elementData.setElementInfo(this.elementAttr,50369,this.skin.view_elementBtn.localToGlobal(),!1),game.module.show(game.ME.ElementAttr))}}),b8e.RC("$$game","$$GeneralBossItemView",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(448),this.setSize(540,68)},setData:function(){var e=this.data;if(e)this.skin.lab_time.string=b8e.TimeUtil.formatTimestamp(e.time,"h:m:s"),this.skin.lab_name.string=e.roleName,this.skin.lab_power.string=e.power;else;}}),b8e.RC("$$game","$$GeneralBossLogItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(446)},init:function(){if(!this._list){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.GeneralBossLogItem,this._list.bindEnum=game.ME.GeneralBossLog,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)}},notify:function(e,t){switch(e){case game.GeneralBossLogViewEvts.C2V_UPDATE_ITEM:this.updateItem(t)}},updateItem:function(e){if(!this._list||!e||e.length<=0);else this._list.setData(e)}});b8e.module.registerView(game.ME.GeneralBossLog,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(449),this.setSize(540,68)},setData:function(){var e=this.data;if(e)this.skin.lab_name.string=e.name,this.skin.lab_lv.string=e.lv,this.skin.autpBg_2.node.active=!e.ignore;else;},btn_ignore:function(){this.send(game.GeneralBossSettingEvts.V2C_SET_IGNORE,this.data)}}),b8e.RC("$$game","$$GeneralBossSettingItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(450)},init:function(){if(!this._list){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.GeneralBossSettingItem,this._list.bindEnum=game.ME.GeneralBossSetting,this._list.layout.paddingLeft=2,this._list.layout.paddingRight=0,this._list.layout.paddingTop=0,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)}},onShow:function(){this.updateItem()},updateItem:function(){var e=game.generalBossSettingData.getDatas();if(!this._list||!e||e.length<1);else this._list.setData(e)},notify:function(e){switch(e){case game.GeneralBossSettingEvts.C2V_SET_IGNORE:this.updateItem()}}});b8e.module.registerView(game.ME.GeneralBossSetting,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(452),this.spotAlerts={SHOP_GENERAL:this.shopAlert}},shopAlert:function(e){this.skin.shop_spot.active=e.alert},init:function(){var e=this;e._list||(e._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Grid),e._list.itemRender=game.GeneralBossItemView,e._list.bindEnum=game.ME.GeneralBoss,e._list.layout.spacingX=3,e._list.layout.spacingY=5,e._list.addToParent(e.skin.node_scrollview)),e._prizeList||(e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList.itemRender=game.PrizeListItem,e._prizeList.layout.spacingX=20,e._prizeList.layout.paddingTop=-5,e._prizeList.addToParent(e.skin.node_prize)),e.bossData=game.generalBossData},onShow:function(){this.send(this.Evts.V2C_SYSNINFO)},updateChallage:function(){var e=game.InstanceMiscCfg.getData("jiangHunBuy"),t=e?parseInt(e.value):0;e=game.InstanceMiscCfg.getData("jiangHunMax"),this.jiangHunMax=e?parseInt(e.value)+this.bossData.buyTimes*t:0,this.skin.lab_fight.string=game.Lang.get(5941,this.jiangHunMax-this.bossData.challage);var a=game.itemData.getNumById(302006);this.skin.lab_award.string=game.Lang.get(6017,a)},updateTime:function(){this.rebirthTime=this.rebirthTime-1e3,this.skin.lbl_cant.string=game.Lang.get(1348,b8e.TimeUtil.formatTime(this.rebirthTime)),this.rebirthTime<=0&&this.updateChallage(),this.bossData.challage>=this.jiangHunMax&&this.rebirthTimer.stop()},updateBossItem:function(){var e=this;if(e._list){var t=e.bossData&&e.bossData.bossInfos?e.bossData.bossInfos.values():null,a=e.bossData&&e.bossData.selectBoss?e.bossData.selectBoss:null;t.sort(e.onSort),a||(e.bossData.selectBoss=t[0],a=t[0],t[0].select=!0),e._list.setData(t);var i=a.getCfg(),n=i.showItems,s=game.CfgUtil.getPrizeListInfo(n);e._prizeList.setData(s.items);var o="["+i.name+"]";e.skin.lbl_boss.node.string=game.Lang.get(50104,game.HtmlUtil.getColorStrByQuality(i.quality,o));var r=game.mainRoleData.lv>=i.challengeLv,g=0<a.reliveTime&&r;e.skin.lab_count.active=!g,e.skin.btn_log.active=g;var l=game.generalBossData&&game.generalBossData.damageInfos?game.generalBossData.damageInfos.get(a.bossId):null,c=l?l.length:0;e.skin.lab_count.string=game.Lang.get(518,c),e.rebirthTime=a.reliveTime,e.skin.btn_cant.active=0<e.rebirthTime,0<e.rebirthTime&&(e.skin.lbl_cant.string=game.Lang.get(1348,b8e.TimeUtil.formatTime(e.rebirthTime)),e.rebirthTimer||(e.rebirthTimer=b8e.Timer.add(e,e.updateTime,1e3)),e.rebirthTimer.reset(),e.rebirthTimer.start())}},onSort:function(e,t){return e.isEnterShow&&!t.isEnterShow?-1:!e.isEnterShow&&t.isEnterShow?1:0<e.reliveTime&&t.reliveTime<=0?1:e.reliveTime<=0&&0<t.reliveTime?-1:t.challengeLv-e.challengeLv},notify:function(e){switch(e){case game.GeneralBossEvts.C2V_UPDATE_ITEM:this.updateBossItem();break;case game.GeneralBossEvts.C2V_UPDATE_VIEW:this.updateBossItem(),this.updateChallage()}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GeneralBoss,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(453)},onShow:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getData(e),a=t?t.jiangHun:0,i=a-game.generalBossData.buyTimes;i=0<=i?i:0;for(var n,s=game.CostCfg.getDatasByType(game.CostType.GENERAL_BOSS,!0),o=0,r=s.length;o<r;o++){if((n=s[o]).num==game.generalBossData.buyTimes+1){break}}var g="",l=0;if(n&&n.items&&n.items.length){var c=game.ItemInfoCfg.getData(n.items[0].Id);g=c?c.name:"",l=n.items[0].Num}this.skin.lab_tips.string=game.Lang.get(519,l,g,3,i,e,a)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+100;this.setPosition(e,t)}});b8e.module.registerView(game.ME.GeneralBossVip,e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(451)},onShow:function(){this.updateView(),this.updateAuto()},onHide:function(){var e=this.role;e&&e.removeFromParent(),this.selectData=null},updateView:function(){var e=game.itemData.getNumById(302006);this.skin.lbl_cost.string=game.Lang.get(6017,e)},onStageResize:function(){var e=.5*(b8e.stageWidth-this.width),t=.5*(b8e.stageHeight+this.height)+50;this.setPosition(e,t)},notify:function(e){switch(e){case game.GeneralBossEvts.C2V_UPDATA_TIP:this.updateAuto()}},updateAuto:function(){this.skin.autoChallage.active=game.generalBossData.autoFight}});b8e.module.registerView(game.ME.GeneralBossTip,e)}(),function(){var e;e=b8e.Enum({None:0,V_SELECT_CHANGE:-1,V_OPEN_AUTION:-1,UPDATE_PAGE_VIEW:-1,PAGE_DATA_REQ:-1,GET_BUY_REQ:-1,UPDATE_ITEM:-1,UPDATE_TYPE_LIST:-1,SHOW_SELECT_LIST:-1,HIDE_SELECT_LIST:-1,GET_LOGS:-1,UPDATE_LOGS:-1,PAGE_LEFT:-1,PAGE_RIGHT:-1,UPDATE_AUCTION_POINT:-1,PANEL_SHOW:-1,PANEL_HIDE:-1}),b8e.RC("$$game","$$AuctionEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Auction:{UPDATE_PAGE_VIEW:this.updatePage,UPDATE_ITEM:this.updateItem,UPDATE_AUCTION_POINT:this.updatePoint}}},selectBtn_1:function(){this.onBtnSelected(0)},selectBtn_2:function(){this.onBtnSelected(10)},selectBtn_3:function(){this.onBtnSelected(game.Quality.Q_RED)},selectBtn_4:function(){this.onBtnSelected(game.Quality.Q_YELLOW)},selectBtn_5:function(){this.onBtnSelected(game.Quality.Q_PURPLE)},selectBtn_6:function(){this.onBtnSelected(game.Quality.Q_BLUE)},onBtnSelected:function(e){game.AuctionData.pageSeverIndex=e,this.send(game.AuctionEvts.UPDATE_TYPE_LIST,e)},select_down_btn:function(){this.send(game.AuctionEvts.HIDE_SELECT_LIST)},select_up_btn:function(){this.send(game.AuctionEvts.SHOW_SELECT_LIST)},lessenOneBtn:function(){this.send(game.AuctionEvts.PAGE_LEFT)},addOneBtn:function(){this.send(game.AuctionEvts.PAGE_RIGHT)},logBtn:function(){game.module.show(game.ME.AuctionLog),this.dpt(game.AuctionEvts.GET_LOGS)},linkTipBtn:function(){game.module.show(game.ME.AuctionTip)},updatePage:function(){this.send(game.AuctionEvts.UPDATE_PAGE_VIEW)},updateItem:function(e){this.send(game.AuctionEvts.UPDATE_ITEM,e)},updatePoint:function(){this.send(game.AuctionEvts.UPDATE_AUCTION_POINT)},notify:function(e,t){switch(e){case game.AuctionEvts.PAGE_DATA_REQ:this.dpt(game.AuctionEvts.PAGE_DATA_REQ);break;case game.AuctionEvts.GET_BUY_REQ:this.dpt(game.AuctionEvts.GET_BUY_REQ,t)}}});b8e.module.registerControl(game.ME.AuctionServer,e,game.AuctionEvts)}(),function(){var e=game.Control.extends({__buyParams:null,ipc:function(){this.evts={AuctionCorps:{PAGE_DATA_REQ:this.getCorpsPageReq,GET_BUY_REQ:this.getAddAuctionPriceReq},AuctionServer:{PAGE_DATA_REQ:this.getSererPageReq,GET_BUY_REQ:this.getAddAuctionPriceReq}},this.handels={AuctionListResp:this.AuctionListResp,AuctionBidResp:this.AuctionBidResp,AuctionPointMsg:this.AuctionPointMsg}},init:function(){this._alertOptions={lang:6021,btn:game.Lang.get(9059),okcb:this.requestBuy,thisArg:this}},AuctionListResp:function(e){var t=e.readProtobuf(game.pb.AuctionListResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.type,i=t.data,n=t.point;game.AuctionData.auctionPoint=n,game.AuctionData.update(a,i),this.dpt(game.AuctionEvts.UPDATE_PAGE_VIEW)}},AuctionBidResp:function(e){var t=e.readProtobuf(game.pb.AuctionBidResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.idx,i=t.price,n=t.point,s=game.mainRoleData.id,o=game.mainRoleData.name;game.AuctionData.updatePro(a,i,n,s,o),this.dpt(game.AuctionEvts.UPDATE_ITEM,a)}},AuctionPointMsg:function(e){var t=e.readProtobuf(game.pb.AuctionPointNotify);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.point;t.value;game.AuctionData.auctionPoint=a,this.dpt(game.AuctionEvts.UPDATE_AUCTION_POINT)}},notify:function(e){switch(e){case game.AuctionEvts.PAGE_DATA_REQ:this.requestData(game.AuctionData.pageType);break;case game.AuctionEvts.PANEL_SHOW:this.startTimer();break;case game.AuctionEvts.PANEL_HIDE:this.stopTimer()}},btn_1:function(){this.changeTab(0)},btn_2:function(){this.changeTab(1)},htlpBtn:function(){game.RuleView.inst().showView(game.ME.Auction)},changeTab:function(e){game.AuctionData.pageType=e,this.send(this.Evts.V_SELECT_CHANGE,e)},getCorpsPageReq:function(){this.requestData(1)},getSererPageReq:function(){this.requestData(0)},getAddAuctionPriceReq:function(e){this.__buyParams=e.data,this.__buyParams&&4==this.__buyParams.length&&(this._alertOptions.lang=this.__buyParams[3]?6022:6021,this._alertOptions.langArgs=this.__buyParams[2],game.alert.show(this._alertOptions))},requestData:function(e){this._timer&&this._timer.running&&this._timer.reset(),this.sender.AuctionListReq(e)},requestBuy:function(){var e=this.__buyParams;e&&4==e.length&&this.sender.AuctionBidReq(e[0],e[1],e[2])},startTimer:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,2e4)),this._timer.running||this._timer.start()},stopTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){game.AuctionData.isPanelOpen&&this.sender.AuctionListReq(game.AuctionData.pageType)}}),t=game.Sender.extends({ipc:function(){this.msg={AuctionListReq:this.AuctionListReq,AuctionBidReq:this.AuctionBidReq}},AuctionListReq:function(e){var t=game.pb.AuctionListRequest;t.type=e,this.write(t)},AuctionBidReq:function(e,t,a){var i=game.pb.AuctionBidRequest;i.idx=e,i.oldPrice=t,i.price=a,this.write(i)}});b8e.module.registerControl(game.ME.Auction,e,game.AuctionEvts,t)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={Auction:{UPDATE_PAGE_VIEW:this.updatePage,UPDATE_ITEM:this.updateItem,UPDATE_AUCTION_POINT:this.updatePoint}}},selectBtn_1:function(){this.onBtnSelected(0)},selectBtn_2:function(){this.onBtnSelected(10)},selectBtn_3:function(){this.onBtnSelected(game.Quality.Q_RED)},selectBtn_4:function(){this.onBtnSelected(game.Quality.Q_YELLOW)},selectBtn_5:function(){this.onBtnSelected(game.Quality.Q_PURPLE)},selectBtn_6:function(){this.onBtnSelected(game.Quality.Q_BLUE)},onBtnSelected:function(e){game.AuctionData.pageCorpsIndex=e,this.send(game.AuctionEvts.UPDATE_TYPE_LIST,e)},select_down_btn:function(){this.send(game.AuctionEvts.HIDE_SELECT_LIST)},select_up_btn:function(){this.send(game.AuctionEvts.SHOW_SELECT_LIST)},lessenOneBtn:function(){this.send(game.AuctionEvts.PAGE_LEFT)},addOneBtn:function(){this.send(game.AuctionEvts.PAGE_RIGHT)},logBtn:function(){game.module.show(game.ME.AuctionLog),this.dpt(game.AuctionEvts.GET_LOGS)},linkTipBtn:function(){game.module.show(game.ME.AuctionTip)},updatePage:function(){this.send(game.AuctionEvts.UPDATE_PAGE_VIEW)},updateItem:function(e){this.send(game.AuctionEvts.UPDATE_ITEM,e)},updatePoint:function(){this.send(game.AuctionEvts.UPDATE_AUCTION_POINT)},notify:function(e,t){switch(e){case game.AuctionEvts.PAGE_DATA_REQ:this.dpt(game.AuctionEvts.PAGE_DATA_REQ);break;case game.AuctionEvts.GET_BUY_REQ:this.dpt(game.AuctionEvts.GET_BUY_REQ,t)}}});b8e.module.registerControl(game.ME.AuctionCorps,e,game.AuctionEvts)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={AuctionCorps:{GET_LOGS:this.getLogsReq},AuctionServer:{GET_LOGS:this.getLogsReq}},this.handels={AuctionLogResp:this.AuctionLogResp}},AuctionLogResp:function(e){var t=e.readProtobuf(game.pb.AuctionLogResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=t.type,i=t.logs;game.AuctionData.updateLogs(a,i),this.send(game.AuctionEvts.UPDATE_LOGS)}},getLogsReq:function(){this.sender.AuctionLogReq(game.AuctionData.pageType)}}),t=game.Sender.extends({ipc:function(){this.msg={AuctionLogReq:this.AuctionLogReq}},AuctionLogReq:function(e){var t=game.pb.AuctionLogRequest;t.type=e,this.write(t)}});b8e.module.registerControl(game.ME.AuctionLog,e,game.AuctionEvts,t)}(),function(){var e=game.Control.extends({confirmBtn:function(){game.module.hide(game.ME.AuctionTip)}});b8e.module.registerControl(game.ME.AuctionTip,e)}(),function(){var e=b8e.Object.extends({pageType:0,pageSeverIndex:0,pageCorpsIndex:0,__proDatas:null,__logs:null,__runners:null,__runnerPool:null,__selectBtnLabels:null,auctionPoint:0,__date:null,isPanelOpen:!1,update:function(e,t){this.__proDatas||(this.__proDatas={}),this.__proDatas[e]=t},getDatas:function(e){return this.__proDatas?this.__proDatas[e]:null},updatePro:function(e,t,a,i,n){if(this.auctionPoint=a,this.__proDatas){var s=this.__proDatas[this.pageType];if(s)for(var o,r=0;r<s.length;r++)if((o=s[r]).idx==e){var g=game.AuctionData.getAuctionItemCfg(o.id);return g&&g.maxPrice==t?void s.splice(r,1):(o.price=t,o.roleId=i,void(o.roleName=n))}}},updateLogs:function(e,t){this.__logs||(this.__logs={}),this.__logs[e]=t},getLogs:function(e){return this.__logs?this.__logs[e]:null},getAuctionItemCfg:function(e){return game.AuctionCfg.getData(e)},getAuctionCfgValue:function(e){return this.getAuctionCfg(e).value},getAuctionCfg:function(e){return game.AuctionMiscCfg.getData(e)},createTimeRunner:function(e,t){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3)),this._timer.running||this._timer.start(),this.__runners||(this.__runners=[]);var a=this.createRunner();a.f=e,a.p=t,this.__runners.push(a)},createRunner:function(){return this.__runnerPool||(this.__runnerPool=[]),0<this.__runnerPool.length?this.__runnerPool.pop():{}},removeTimeRunner:function(e){if(this.__runners){var t=this.__runners.index(e);-1!=t&&$.putRunner(this.__runners.splice(t,1)[0])}},removeAllRunner:function(){if(this.__runners)for(;0<this.__runners.l;)this.putRunner(this.__runners.pop())},putRunner:function(e){this.__runnerPool||(this.__runnerPool=[]),e&&(e.f=null,e.p=null,this.__runnerPool.push(e))},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateTime:function(){if(this.__runners)for(var e,t,a=0;a<this.__runners.length;a++)"function"==typeof(e=(t=this.__runners[a]).f)&&e(t.p)},getSelectBtnLabel:function(e){return this.__selectBtnLabels||(this.__selectBtnLabels=[game.Lang.get(9391),game.Lang.get(9392),game.Lang.get(9393),game.Lang.get(9394),game.Lang.get(9395),game.Lang.get(9396),"","","","",game.Lang.get(9397)]),this.__selectBtnLabels[e]},getLogShowTime:function(e){var t=b8e.TimeUtil.formatTimestamp(1e3*e,game.Lang.get(9065));return t=game.HtmlUtil.getText(game.Color.GREEN,t)},checkBindItem:function(e,t){return!!e&&(game.AuctionData.getAuctionItemCfg(e.id)?!(this.auctionPoint<t)||(game.notice.show(6032),!1):(game.notice.show(6031),!1))},checkBuyOutItem:function(e,t){return!!e&&(game.AuctionData.getAuctionItemCfg(e.id)?!(this.auctionPoint<t)||(game.notice.show(6032),!1):(game.notice.show(6031),!1))},checkServerAlert:function(){return!0},checkArmyAlert:function(){return!0}});game.AuctionData=game.AuctionData||new e}(),function(){var e;e=b8e.Object.extends({icon:null,commonYuanbao:0,state:0,time:0,onceYuanbao:0,biddingYuanbao:0,ctor:function(){},setData:function(e){this.commonYuanbao=e.commonYuanbao,this.state=e.state,this.time=e.time,this.onceYuanbao=e.onceYuanbao,this.biddingYuanbao=e.biddingYuanbao}}),b8e.RC("$$game","$$AuctionInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({itemPro:null,recycle:function(){this.reset(),this.itemPro=null,this._super()},reset:function(){}});b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,64),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$AcutionItemInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({itemPro:null,recycle:function(){this.itemPro=null,this.reset(),this._super()},reset:function(){}});b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,64),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$AuctionLogItemInfo",e)}(),function(){var e;e=game.ListItem.extends({__itemIcon:null,__itemInfo:null,__cfg:null,__pro:null,ctor:function(){this._super(77),this.setSize(600,190)},init:function(){this.__itemIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),this.__itemIcon.setNum(0),this.__itemIcon.addToParent(this.skin.iconBg)},setData:function(e){if(e&&e.itemPro){var t=this,a=e.itemPro,i=game.AuctionData.getAuctionItemCfg(a.id);if(t.__cfg=i,t.__pro=a,t.skin.infoLab_1.string="",t.skin.infoLab_2.string="",i){var n=i.itemId;t.__itemInfo=game.ItemInfoCfg.getData(n),t.__itemIcon.setItemInfo(t.__itemInfo,!1,!1),t.__itemIcon.setNum(i.itemNum);var s=t.skin,o=game.HtmlUtil.getColorByQuality(t.__itemInfo.quality);s.itemNameLab.color=o,s.itemNameLab.string=t.__itemInfo.name,s.oneBuyGray_moneylbl.string=i.maxPrice,s.oneBuy_moneylbl.string=i.maxPrice,s.roleNametxt.string=a.roleId==game.mainRoleData.id?game.Lang.get(6026):a.roleName,s.coinNumLab.string=a.price;var r=i.addValue+a.price;s.biddingGray_moneylbl.string=r,s.bidding_moneylbl.string=r,game.AuctionData.createTimeRunner(this.updateState,this),this.updateState(this)}}},updateState:function(e){var t=e;if(t.__pro&&t.__cfg){var a=t.__pro,i=(t.__cfg,t.skin),n=a.startTime,s=a.endTime,o=parseInt(game.SysTime.curTime/1e3),r=s-60,g=game.Color.BLUE,l="",c=0,h=0,m="";o<n?(g=game.Color.BLUE,l=game.Lang.get(6027),c=1,h=n-o,m=game.Lang.get(9605,b8e.TimeUtil.formatTime(1e3*Math.abs(h)))):n<o&&o<r?(g=game.Color.GREEN,l=game.Lang.get(6028),c=2,h=a.endTime-o,m=game.Lang.get(9606,b8e.TimeUtil.formatTime(1e3*h))):r<o&&o<s?(g=game.Color.RED,l=game.Lang.get(6029),c=3,h=a.endTime-o,m=game.Lang.get(9606,b8e.TimeUtil.formatTime(1e3*h))):s<o&&(g=game.Color.BLUE,l=game.Lang.get(6030),c=4),i.infoLab_1.color=g,i.infoLab_2.color=g,i.infoLab_1.string=l,i.oneBuy.active=1<c&&c<4,i.oneBuyGray.active=c<=1||4<=c,i.bidding.active=1<c&&c<4,i.biddingGray.active=c<=1||4<=c,i.infoLab_2.string=m}else game.AuctionData.removeTimeRunner(t.updateState)},oneBuy_bg:function(){this.__cfg&&this.__pro&&game.AuctionData.checkBuyOutItem(this.__pro,this.__cfg.maxPrice)&&this.send(game.AuctionEvts.GET_BUY_REQ,[this.__pro.idx,this.__pro.price,this.__cfg.maxPrice,!0])},bidding_bg:function(){if(this.__cfg&&this.__pro){var e=this.__cfg.addValue+this.__pro.price;game.AuctionData.checkBindItem(this.__pro,e)&&this.send(game.AuctionEvts.GET_BUY_REQ,[this.__pro.idx,this.__pro.price,e,!1])}}}),b8e.RC("$$game","$$AuctionItem",e)}(),function(){var e=game.View.extends({__listDatas:null,__currentPage:1,__maxPage:1,__pageCount:4,ctor:function(){this._super(76)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.list.itemRender=game.AuctionItem,e.list.bindEnum=game.ME.AuctionCorps,e.list.layout.paddingLeft=0,e.list.layout.spacingY=5,e.list.addToParent(e.skin.list),e.skin.select_list.active=!1,e.skin.select_down_btn.active=!1,e.__pointLabStr=e.skin.hasMoneyLbl.string},notify:function(e,t){var a=this;switch(e){case a.Evts.UPDATE_PAGE_VIEW:a.updateView();break;case a.Evts.SHOW_SELECT_LIST:a.showSelectList();break;case a.Evts.HIDE_SELECT_LIST:a.hideSelectedList();break;case a.Evts.UPDATE_ITEM:a.updateView();break;case a.Evts.UPDATE_TYPE_LIST:a.updateListType(t);break;case a.Evts.PAGE_LEFT:a.pageLeft();break;case a.Evts.PAGE_RIGHT:a.pageRight();break;case a.Evts.UPDATE_AUCTION_POINT:a.updatePoint()}},updateView:function(){game.AuctionData.removeAllRunner();var e=this,t=game.AuctionData.getDatas(1);for(e.__listDatas||(e.__listDatas=[]);0<e.__listDatas.length;)game.AcutionItemInfo.put(e.__listDatas.pop());var a=[],i=[];if(t){for(var n,s,o,r,g=game.AuctionData.pageCorpsIndex,l=0;l<t.length;l++)n=t[l],r=game.AuctionData.getAuctionItemCfg(n.id),(o=game.ItemInfoCfg.getData(r.itemId))&&(10==g?n.roleId==game.mainRoleData.id&&((s=game.AcutionItemInfo.get()).itemPro=n,a.push(s),e.__listDatas.push(s)):o.quality!=g&&0!=g||((s=game.AcutionItemInfo.get()).itemPro=n,a.push(s),e.__listDatas.push(s)));i=e.getCurrentPageData(a)}e.list.setData(i),e.updatePoint(),e.skin.useNum.string=e.__currentPage+"/"+e.__maxPage,e.skin.noItems.active=!t||0==t.length},updatePoint:function(){var e=game.AuctionData.auctionPoint,t=this.__pointLabStr;t=t.replace("$",e),this.skin.hasMoneyLbl.string=t},onShow:function(){this.send(game.AuctionEvts.PAGE_DATA_REQ),this.__currentPage=1,this.hideSelectedList(),this.updateView()},onHide:function(){},showSelectList:function(){this.skin.select_list.active=!0,this.skin.select_down_btn.active=!0,this.skin.select_up_btn.active=!1},hideSelectedList:function(){this.skin.select_list.active=!1,this.skin.select_down_btn.active=!1,this.skin.select_up_btn.active=!0},updateListType:function(e){var t=game.AuctionData.getSelectBtnLabel(e),a=game.Color.BLACK;a=0==e?game.Color.BLACK:10==e?game.Color.GREEN:game.HtmlUtil.getColorByQuality(e),this.hideSelectedList(),this.skin.curSelectlbl.color=a,this.skin.curSelectlbl.string=t,this.__currentPage=1,this.updateView()},pageLeft:function(){this.__currentPage--,this.__currentPage<1?this.__currentPage=1:this.updateView()},pageRight:function(){this.__currentPage++,this.__currentPage>this.__maxPage?this.__currentPage=this.__maxPage:this.updateView()},getCurrentPageData:function(e){if(e){var t=this,a=e.length;t.__maxPage=Math.ceil(a/t.__pageCount),t.__maxPage=t.__maxPage<1?1:t.__maxPage,t.__currentPage=t.__currentPage>t.__maxPage?t.__maxPage:t.__currentPage;var i=(t.__currentPage-1)*t.__pageCount,n=(i=i<0?0:i)+t.__pageCount;return n=a<n?a:n,e.slice(i,n)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.AuctionCorps,e)}(),function(){var e=game.View.extends({__listDatas:null,__pointLabStr:null,__currentPage:1,__maxPage:1,__pageCount:4,ctor:function(){this._super(80)},init:function(){var e=this;e.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),e.list.itemRender=game.AuctionItem,e.list.bindEnum=game.ME.AuctionServer,e.list.layout.paddingLeft=0,e.list.layout.spacingY=5,e.list.addToParent(e.skin.list),e.skin.select_list.active=!1,e.skin.select_down_btn.active=!1,e.__pointLabStr=e.skin.hasMoneyLbl.string},notify:function(e,t){var a=this;switch(e){case a.Evts.UPDATE_PAGE_VIEW:a.updateView();break;case a.Evts.SHOW_SELECT_LIST:a.showSelectList();break;case a.Evts.HIDE_SELECT_LIST:a.hideSelectedList();break;case a.Evts.UPDATE_ITEM:a.updateView();break;case a.Evts.UPDATE_TYPE_LIST:a.updateListType(t);break;case a.Evts.PAGE_LEFT:a.pageLeft();break;case a.Evts.PAGE_RIGHT:a.pageRight();break;case a.Evts.UPDATE_AUCTION_POINT:a.updatePoint()}},pageLeft:function(){this.__currentPage--,this.__currentPage<1?this.__currentPage=1:this.updateView()},pageRight:function(){this.__currentPage++,this.__currentPage>this.__maxPage?this.__currentPage=this.__maxPage:this.updateView()},updateView:function(){game.AuctionData.removeAllRunner();var e=this,t=game.AuctionData.getDatas(0);for(e.__listDatas||(e.__listDatas=[]);0<e.__listDatas.length;)game.AcutionItemInfo.put(e.__listDatas.pop());var a=[],i=[];if(t){i=e.getCurrentPageData(t);for(var n,s,o,r,g=game.AuctionData.pageSeverIndex,l=0;l<i.length;l++)n=i[l],r=game.AuctionData.getAuctionItemCfg(n.id),(o=game.ItemInfoCfg.getData(r.itemId))&&(10==g?n.roleId==game.mainRoleData.id&&((s=game.AcutionItemInfo.get()).itemPro=n,a.push(s),e.__listDatas.push(s)):o.quality!=g&&0!=g||((s=game.AcutionItemInfo.get()).itemPro=n,a.push(s),e.__listDatas.push(s)));i=e.getCurrentPageData(a)}e.list.setData(i),e.updatePoint(),e.skin.useNum.string=e.__currentPage+"/"+e.__maxPage,e.skin.noItems.active=!t||0==t.length},updatePoint:function(){var e=game.AuctionData.auctionPoint,t=this.__pointLabStr;t=t.replace("$",e),this.skin.hasMoneyLbl.string=t},onShow:function(){this.send(game.AuctionEvts.PAGE_DATA_REQ),this.__currentPage=1,this.hideSelectedList(),this.updateView()},onHide:function(){},showSelectList:function(){this.skin.select_list.active=!0,this.skin.select_down_btn.active=!0,this.skin.select_up_btn.active=!1},hideSelectedList:function(){this.skin.select_list.active=!1,this.skin.select_down_btn.active=!1,this.skin.select_up_btn.active=!0},updateListType:function(e){var t=game.AuctionData.getSelectBtnLabel(e),a=game.Color.BLACK;a=0==e?game.Color.BLACK:10==e?game.Color.GREEN:game.HtmlUtil.getColorByQuality(e),this.hideSelectedList(),this.skin.curSelectlbl.color=a,this.skin.curSelectlbl.string=t,this.__currentPage=1,this.updateView()},getCurrentPageData:function(e){if(e){var t=this,a=e.length;t.__maxPage=Math.ceil(a/t.__pageCount),t.__maxPage=t.__maxPage<1?1:t.__maxPage,t.__currentPage=t.__currentPage>t.__maxPage?t.__maxPage:t.__currentPage;var i=(t.__currentPage-1)*t.__pageCount,n=(i=i<0?0:i)+t.__pageCount;return n=a<n?a:n,e.slice(i,n)}},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.AuctionServer,e)}(),function(){var e=game.View.extends({ctor:function(){this._super(82),this.toggles={toggle_btn_1:game.ME.AuctionServer,toggle_btn_2:game.ME.AuctionCorps},this.spotAlerts={AUCTION_ALLSER:this.auctionAllSerAlert,AUCTION_CORPS:this.auctionCorpsAlert}},auctionAllSerAlert:function(e){this.skin.red_spot_1.active=e.alert},auctionCorpsAlert:function(e){this.skin.red_spot_2.active=e.alert},notify:function(e,t){switch(e){case this.Evts.V_SELECT_CHANGE:this.toggleSelect(t);break;case this.Evts.UPDATE_PAGE_VIEW:this.updateView()}},onShow:function(){game.AuctionData.isPanelOpen=!0,this.toggleSelect(0),this.send(this.Evts.PANEL_SHOW)},onHide:function(){game.AuctionData.isPanelOpen=!1,game.AuctionData.removeAllRunner(),game.AuctionData.clearTimer(),this.send(this.Evts.PANEL_HIDE)},toggleSelect:function(e){this._super(e)},onStageResize:function(){this._super()}});b8e.module.registerView(game.ME.Auction,e)}(),function(){var e;e=game.ListItem.extends({__itemIcon:null,__itemInfo:null,__cfg:null,__pro:null,ctor:function(){this._super(78),this.setSize(600,160)},init:function(){this.__itemIcon=game.GridUtil.createPrizeIcon(game.IconSizeEnum.GRID_SIZE_105),this.__itemIcon.setNum(0),this.__itemIcon.addToParent(this.skin.iconBg)},setData:function(e){if(e&&e.itemPro){var t=e.itemPro,a=game.AuctionData.getAuctionItemCfg(t.auctionId);if(this.__cfg=a,this.__pro=t,a){var i=a.itemId;this.__itemInfo=game.ItemInfoCfg.getData(i),this.__itemIcon.setItemInfo(this.__itemInfo,!1,!1),this.__itemIcon.setNum(a.itemNum);var n=this.skin,s=game.HtmlUtil.getColorByQuality(this.__itemInfo.quality);n.itemNameLab.color=s,n.itemNameLab.string=this.__itemInfo.name,n.roleNametxt.string=t.name,n.coinNumLab.string=t.price;a=game.AuctionData.getAuctionItemCfg(t.auctionId);n.infoLab.string=a.maxPrice==t.price?game.Lang.get(6024):game.Lang.get(6025),n.dayLab.string=game.AuctionData.getLogShowTime(t.ts)}}}}),b8e.RC("$$game","$$AuctionLogItem",e)}(),function(){var e=game.View.extends({__listDatas:null,ctor:function(){this._super(79)},onStageResize:function(){this._super()},init:function(){this.list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this.list.itemRender=game.AuctionLogItem,this.list.bindEnum=game.ME.AuctionLog,this.list.layout.paddingLeft=0,this.list.layout.spacingY=5,this.list.addToParent(this.skin.recordList)},notify:function(e){switch(e){case game.AuctionEvts.UPDATE_LOGS:this.updateView()}},updateView:function(){var e=this;e.skin.titleArmy.active=1==game.AuctionData.pageType,e.skin.titleServer.active=0==game.AuctionData.pageType;var t=game.AuctionData.getLogs(game.AuctionData.pageType);for(e.__listDatas||(e.__listDatas=[]);0<e.__listDatas.length;)game.AuctionLogItemInfo.put(e.__listDatas.pop());var a=[];if(t)for(var i,n,s=0;s<t.length;s++)i=t[s],(n=game.AuctionLogItemInfo.get()).itemPro=i,a[s]=n,e.__listDatas.push(n);e.list.setData(a),e.skin.noRecord.active=!t||0==t.length,e.skin.hasRecord.active=!e.skin.noRecord.active},onShow:function(){this.updateView()}});b8e.module.registerView(game.ME.AuctionLog,e)}(),function(){var e=game.View.extends({_showModel:!0,__msg1:null,__msg2:null,ctor:function(){this._super(81)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this.setPosition(.5*(e-this.width),.5*(t+this.height)+120),this.__msg1=this.skin.infoLab_5.string,this.__msg2=this.skin.infoLab_6.string},onShow:function(){this.skin.point_value1.string=game.AuctionData.auctionPoint;var e=game.AuctionData.getAuctionCfgValue("auctionRechargeScale"),t=game.AuctionData.getAuctionCfgValue("auctionIngotsScale"),a=this.__msg1;a=game.Lang.replaceStr(a,[1,e]),this.skin.infoLab_5.string=a,a=this.__msg2,a=game.Lang.replaceStr(a,[1,t]),this.skin.infoLab_6.string=a}});b8e.module.registerView(game.ME.AuctionTip,e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super()},_maxLv:0,maxLv:{get:function(){return this._maxLv||(this._maxLv=Number(game.CfgUtil.getMiscValue(game.PatriotMiscCfg,"patriotStarMaxLv"))),this._maxLv}}}),b8e.RC("$$game","$$PatriotStarCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({ctor:function(){this._super(),this.obj={id:1}},getMaxUpLvById:function(){if(this.maxUpLv)return this.maxUpLv;var e=game.PatriotMiscCfg.getData("equipMaxLv");return e&&e.value&&(this.maxUpLv=+e.value),this.maxUpLv}}),b8e.RC("$$game","$$PatriotEquipCfg",e)}(),function(){var e;e=b8e.Enum({None:0,C2V_UPDATE_CHALLENGE_COUNT:-1,C2V_UPDATE_INFO:-1,V2C_CHALLAGE:-1,V2C_KILL_LOG:-1,V2C_DAMAGE_LOG:-1,C2V_DAMAGE_INFO:-1,C2V_SKILL_HIT:-1,V_FOLLOW_CHAT:-1,C2C_BATTLE_RESULT:-1,V2C_RESET_BOSS:-1,V2C_SHOW_VIEW:-1,C2V_UPDATE_LIST:-1}),b8e.RC("$$game","$$GuoshiChallengeEvts",e)}(),function(){var e=game.Control.extends({ipc:function(){this.evts={GuoshiChallenge:{C2C_BATTLE_RESULT:this.onBattleResult}},this.gevts={InstanceEvts:{G_STOP_PLAY:this.onBattleOver,G_SKILL_HIT:this.onSkillHit}}},onSkillHit:function(e){if(b8e.module.isShowView(game.ME.GuoshiChallengeBattle)){var a=e.data;a&&a.roleData.type==game.RoleType.Monster&&game.MonsterCfg.getDataAsync(a.roleId,function(e){if(e&&1==e.type){var t=game.guoshiChallengeData.battleResult.emulator;game.guoshiChallengeData.selfDamage.damage+=a.value,this.doRank(t),this.send(this.Evts.C2V_SKILL_HIT,a)}else;},this)}else;},onBattleResult:function(e){var t=e?e.data:null;if(t)if(t.battlelog){t.battlelog.win=!0;var a={type:game.InstanceType.GUOSHI_CHALLENGE,rewards:t.useritem,exp:t.exp};game.playBack.play(t.battlelog,a),this.send(this.Evts.C2V_DAMAGE_INFO,t)}else;else;},onBattleOver:function(){},doRank:function(e){if(e){e.sort(function(e,t){return t.damage-e.damage});for(var t=0,a=e.length;t<a;t++){e[t].rank=t+1}}else;},btn_skip:function(){game.playBack.stop()}});b8e.module.registerControl(game.ME.GuoshiChallengeBattle,e,game.GuoshiChallengeEvts,null)}(),function(){var e=game.Control.extends({onceGuoshi:3,init:function(){},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily}},this.handels={GuoShiInfoResp:this.guoshiInfoResp,GuoShiChallengeResp:this.guoShiChallengeResp,GuoShiBuyResp:this.guoShiBuyResp,GuoShiDiedMsg:this.guoShiDiedMsg,GuoShiRefreshMsg:this.guoShiRefreshMsg}},guoshiInfoResp:function(e){var t=e.readProtobuf(game.pb.GuoShiInfoResponse);if(0<t.code)game.notice.noticeError(t.code);else{var a=game.guoshiChallengeData,i=t.infos,n=1e3*t.nextRefreshTime;a.setInfos(i,n),a.buyTimes=t.buyTimes,a.setCount(t.challenge),this.checkAlert(),this.send(this.Evts.C2V_UPDATE_CHALLENGE_COUNT)}},guoShiChallengeResp:function(e){var t=e.readProtobuf(game.pb.GuoShiChallengeResponse);if(t.code)game.notice.noticeError(t.code);else{var a=game.guoshiChallengeData;a.setBattleResult(t),this.checkAlert(),game.InsFunCountData.addChallengeCount(game.InsFunCountType.GUOSHI),this.dpt(this.Evts.C2C_BATTLE_RESULT,a.battleResult),this.send(this.Evts.C2V_UPDATE_CHALLENGE_COUNT)}},guoShiBuyResp:function(e){var t=e.readProtobuf(game.pb.GuoShiBuyResponse);if(t.code)game.notice.noticeError(t.code);else{game.guoshiChallengeData.guoshiBuy(t),this.send(this.Evts.C2V_UPDATE_CHALLENGE_COUNT)}},guoShiDiedMsg:function(e){var t=e.readProtobuf(game.pb.GuoShiDiedNotify);game.guoshiChallengeData.bossDie(t.bossId),this.send(this.Evts.C2V_UPDATE_LIST)},guoShiRefreshMsg:function(e){var t=1e3*e.readProtobuf(game.pb.GuoShiRefreshNotify).nextRefreshTime;game.guoshiChallengeData.resetAllBoss(t)},triggerOpen:function(e){e==this.moduleEnum&&(game.guoshiChallengeData.initData(),this.sender.GuoShiInfoReq(),this._alertOptions={lang:519,okcb:this.onGameAlert,thisArg:this,btn:game.Lang.get(9146)},this.onceGuoshi=game.guoshiChallengeData.getOnceGuoShiBuy())},notify:function(e,t){var a=this.Evts,i=game.guoshiChallengeData;switch(e){case a.V2C_CHALLAGE:if(game.playBack.isInstanceFighting()||game.sceneData.isGuildMap())return;this.sender.GuoShiChallengeReq(t);break;case a.V2C_KILL_LOG:i.selectBossId=t,game.module.show(game.ME.GuoshiCKillLog);break;case a.V2C_DAMAGE_LOG:i.selectBossId=t,game.module.show(game.ME.GuoshiCDamageLog);break;case a.V2C_SHOW_VIEW:this.sender.GuoShiInfoReq()}},buy_btn:function(){var e=game.mainRoleData.vipLevel,t=game.VipCfg.getGuoShi(e),a=game.guoshiChallengeData.buyTimes+1;a=t<a?t:0;var i=t-game.guoshiChallengeData.buyTimes;i=i<1?0:i;var n=game.CostCfg.getCostCfg(game.CostType.GUOSHI_CHALLENGE,a);if(n){var s="",o=0,r=n.items;if(r&&r.length){var g=game.ItemInfoCfg.getData(r[0].Id);s=g?g.name:"",o=r[0].Num}this._alertOptions.langArgs=[o,s,this.onceGuoshi,i,e,t],game.alert.show(this._alertOptions)}},onGameAlert:function(){this.sender.GuoShiBuyReq()},checkAlert:function(){},resetDaily:function(){game.moduleOpen.checkOpen(this.moduleEnum)&&this.sender.GuoShiInfoReq()}}),t=[game.ME.GuoshiCKillLog,game.ME.GuoshiCDamageLog],a=game.Sender.extends({ipc:function(){this.msg={GuoShiInfoReq:null,GuoShiBuyReq:null,GuoShiChallengeReq:this.guoshiChallengeReq}},guoshiChallengeReq:function(e){var t=game.pb.GuoShiChallengeRequest;t.bossId=e,this.write(t)}});b8e.module.registerControl(game.ME.GuoshiChallenge,e,game.GuoshiChallengeEvts,a,t)}(),function(){var e=b8e.Object.extends({challenge:0,resetTime:0,ctor:function(){this._super(),this.buyTimes=0,this.battleResult=null,this.bossInfoMap=b8e.HashMap.get()},initData:function(){this.bossList=[],this.bossDamageInfoMap=b8e.HashMap.get(),this.bossKillRecordMap=b8e.HashMap.get();var e=game.GuoShiChallengeCfg.getDatas();if(e&&!(e.length<1)){for(var t=void 0,a=void 0,i=e.length,n=0;n<i;n++)t=e[n],(a=new game.GuoshiChallengeInfo(t.id)).hp=t.hp,this.bossList[n]=a,this.bossInfoMap.set(t.id,a);var s=game.InstanceMiscCfg.getData("guoShiResetTime");if(s){var o=+s.value;this.resetTime=6e4*o}}},setInfos:function(e,t){if(e&&!(e.length<1))for(var a=void 0,i=void 0,n=void 0,s=void 0,o=void 0,r=void 0,g=void 0,l=void 0,c=e.length,h=0;h<c;h++)if(l=(i=e[h]).bossId,a=this.bossInfoMap.get(l)){if(a.setData(i,t),(n=i.emulator)&&0<n.length)for(r=n.length,g=0;g<r;g++)o=n[g],this.updateDamageInfo(l,o);else this.clearDamageInfo(l);if((s=i.record)&&0<s.length)for(r=s.length,g=0;g<r;g++)o=s[g],this.updateKillRecord(l,o);else this.clearKillRecord(l)}},setCount:function(e){var t=this.getGuoShiMax(),a=this.getOnceGuoShiBuy();this.challenge=t+this.buyTimes*a-e},setBattleResult:function(t){var a=this;if(t){a.battleResult=t;var e=a.bossInfoMap.get(t.bossId);e&&(e.hp=t.hp),a.setCount(t.challenge),a.challageBossHp=t.hp0;var i=t.emulator;if(i&&0<i.length){i.forEach(function(e){a.updateDamageInfo(t.bossId,e)},a);for(var n=game.mainRoleData.id,s=-1,o=0,r=i.length;o<r;o++)if(i[o].roleId==n){s=o;break}s<0?i.push(t.ownDamage):i[s]=t.ownDamage,a.selfDamage=t.ownDamage,a.doRank(i)}else a.clearDamageInfo(t.bossId)}},doRank:function(e){if(e){e.sort(function(e,t){return t.damage-e.damage});for(var t=0,a=e.length;t<a;t++)e[t].rank=t+1}},updateKillRecord:function(e,t){if(this.bossKillRecordMap){var a=this.bossKillRecordMap.get(e);if(!a){a=[],this.bossKillRecordMap.set(e,a)}for(var i=0,n=a.length;i<n;i++){if((s=a[i]).roleId==t.roleId&&s.time==t.time){break}s=null}if(!s){var s=game.GuoshiKillRecord.get();a.push(s)}s.setData(t)}else;},clearKillRecord:function(e){if(this.bossKillRecordMap){var t=this.bossKillRecordMap.get(e);if(t&&0<t.length)for(var a=t.length,i=void 0,n=0;n<a;n++)i=t[n],game.GuoshiKillRecord.put(i);this.bossKillRecordMap.del(e)}else;},updateDamageInfo:function(e,t){if(this.bossDamageInfoMap){var a,i=this.bossDamageInfoMap.get(e);i||(i=[],this.bossDamageInfoMap.set(e,i));for(var n=0,s=i.length;n<s&&(a=i[n]).roleId!=t.roleId;n++)a=null;a||(a=game.GuoshiDamageInfo.get(),i.push(a)),a.setData(t)}},clearDamageInfo:function(e){if(this.bossDamageInfoMap){var t=this.bossDamageInfoMap.get(e);if(t&&0<t.length)for(var a=t.length,i=void 0,n=0;n<a;n++)i=t[n],game.GuoshiDamageInfo.put(i);this.bossDamageInfoMap.del(e)}},guoshiBuy:function(e){this.buyTimes=e.buyTimes,this.setCount(e.challenge)},bossDie:function(e){var t=this.bossInfoMap.get(e);t&&(t.isKill=!0,t.hp=0)},getGuoShiMax:function(){if(this.guoShiMax)return this.guoShiMax;var e=game.InstanceMiscCfg.getData("guoShiMax");return e&&(this.guoShiMax=+e.value),this.guoShiMax},getOnceGuoShiBuy:function(){if(this.onceGuoshi)return this.onceGuoshi;var e=game.InstanceMiscCfg.getData("guoShiBuy");return e&&(this.onceGuoshi=+e.value),this.onceGuoshi},selectBossId:{get:function(){return this._selectBossId},set:function(e){this._selectBossId=e}},resetBoss:function(){},resetAllBoss:function(a){var i=this;i.bossInfoMap.forEach(function(e,t){t.resetData(a),i.clearDamageInfo(e)},i)},getBossList:function(){return this.bossList?(this.bossList.sort(this.onSort),this.bossList):null},onSort:function(e,t){return e.isKill==t.isKill?e.bossId-t.bossId:e.isKill?1:-1},getDamageList:function(e){return this.bossDamageInfoMap.get(e)},getKillRecordList:function(e){return this.bossKillRecordMap.get(e)}});game.guoshiChallengeData=game.guoshiChallengeData||new e}(),function(){var e;e=b8e.Object.extends({bossId:0,isKill:!1,refreshTime:0,hp:0,ctor:function(e){this._super(),this.bossId=e},setData:function(e,t){this.hp=e.hp,this.isKill=e.hp<=0,this.emulator=e.emulator,this.refreshTime=t},resetData:function(e){this.isKill=!1;var t=this.getCfg();this.hp=t.hp,this.refreshTime=e,this.emulator=null},getCfg:function(){return game.GuoShiChallengeCfg.getData(this.bossId)},getPrizeList:function(){if(this.prizeList)return this.prizeList;var e=this.getCfg();if(!e)return null;var t=e.showItems,a=game.CfgUtil.getPrizeListInfo(t,game.IconLayoutEnum.SHOW_NUM,game.IconSizeEnum.GRID_SIZE_84);return this.prizeList=a.items,this.prizeList}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GuoshiChallengeInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({roleId:0,roleName:0,damage:0,rank:0,setData:function(e){if(e)this.roleId=e.roleId,this.rank=e.rank,this.roleName=e.roleName,this.damage=e.damage;else;},recycle:function(){this.reset(),this._super()},reset:function(){}});b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,1024),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$GuoshiDamageInfo",e)}(),function(){var e,t=e=b8e.PoolObject.extends({time:0,roleId:0,roleName:0,power:0,setData:function(e){if(e)this.time=e.time,this.roleId=e.roleId,this.roleName=e.roleName,this.power=e.power;else;},recycle:function(){this.reset(),this._super()},reset:function(){}});b8e.BindingUtil.bind(t),t.pool=new b8e.Pool(t,1024),t.get=function(){return t.pool.get()},t.put=function(e){t.pool.put(e)},b8e.RC("$$game","$$GuoshiKillRecord",e)}(),function(){var e=game.View.extends({_isMoveUp:!1,ctor:function(){this._super(444),this.MaxHp=0,this.Hp=0,this.proWidth=435,this.setLocalZOrder(game.GameViewMgr.LowLayerViewIndex)},notify:function(e,t){switch(e){case this.Evts.C2V_DAMAGE_INFO:this.updateDamageInfo(t);break;case this.Evts.C2V_SKILL_HIT:this.onSkillHit(t)}},updateDamageInfo:function(e){if(!e){return this.skin.lab_rank.node.active=!1,void(this.skin.lab_mine.node.active=!1)}this.skin.lab_rank.node.active=!0,this.skin.lab_mine.node.active=!0,this.setBossHp(e.bossId),this.skin.lab_rank.string=this.getDamageInfoStr(e.emulator),this.skin.lab_mine.string=this.getSelfDamageInfoStr(e.ownDamage)},setBossHp:function(e){var t=game.GuoShiChallengeCfg.getData(e);if(t)this.MaxHp=t.hp,this.setHp(game.guoshiChallengeData.challageBossHp);else;},setHp:function(e){this.Hp=0<=e?e:0,this.setBossHpProgress()},setBossHpProgress:function(){this.skin.lab_progress.string=this.Hp+"/"+this.MaxHp,this.skin.img_progress.node.width=this.proWidth*(this.Hp/this.MaxHp)},getSelfDamageInfoStr:function(e){if(!e||e.damage<1){return""}return game.Lang.get(517,e.rank,e.roleName,Math.min(this.MaxHp,e.damage))},getDamageInfoStr:function(e){if(!e||e.length<1){return""}for(var t,a="",i=0,n=0,s=e.length;n<s;n++){if(0<(t=e[n]).damage){a+=game.Lang.get(517,t.rank,t.roleName,Math.min(this.MaxHp,t.damage)),i++}if(3<i){break}}return a},onShow:function(){this.updateDamageInfo(game.guoshiChallengeData.battleResult),this.onStageResize()},onSkillHit:function(e){this.setHp(this.Hp-e.value);var t=game.guoshiChallengeData.battleResult.emulator,a=game.guoshiChallengeData.selfDamage;this.skin.lab_rank.string=this.getDamageInfoStr(t),this.skin.lab_mine.string=this.getSelfDamageInfoStr(a)},onStageResize:function(){b8e.stageHeight,b8e.stageWidth;this.setPosition(0,this.height+130)}});b8e.module.registerView(game.ME.GuoshiChallengeBattle,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(571),this.setSize(600,320),this.bossId=0},init:function(){var e=this;e._prizeList=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal),e._prizeList.itemRender=game.ShowItemListItem,e._prizeList.addToParent(e.skin.prizeList),e._prizeList.layout.spacingX=20,e._prizeList.layout.paddingTop=10,e._prizeList.layout.paddingLeft=-9,e._model=b8e.SceneEntity.get(),e._model.addToParent(e.skin.model_root),e.timer=b8e.Timer.add(e,e.updateTime,1e3),e.progressWidth=e.skin.img_progress.node.width;var t=game.InstanceMiscCfg.getData("guoShiDesc");if(t&&(e.skin.right_desc1.string=t.value),t=game.InstanceMiscCfg.getData("guoShiResetTime")){var a=+t.value;e.resetTime=6e4*a}e.skin.check_kill_log.string=game.Lang.get(5982),e.skin.item_bg.loadTexture(game.ResCfg.getUrl(10071))},challenge_btn:function(){if(game.UpgradeUtil.checkEquipTooMuch());else{var e=this.data;if(e)this.send(game.GuoshiChallengeEvts.V2C_CHALLAGE,e.bossId);else;}},check_kill_log:function(){if(this.data)this.send(game.GuoshiChallengeEvts.V2C_KILL_LOG,this.data.bossId);else;},fight_count:function(){if(this.data)this.send(game.GuoshiChallengeEvts.V2C_DAMAGE_LOG,this.data.bossId);else;},setData:function(){var e=this,t=e.data;if(t)if(e.bossCfg=t.getCfg(),e.bossCfg)e.setBossName(),e.setModel(),e.setPrizeList(),e.setProgress(),e.setBossStates(),e.refreshTime=e.data.refreshTime,e.timer.reset(),e.timer.start();else;else;},setBossName:function(){if(this.bossCfg)this.skin.name.string=this.bossCfg.name;else;},setProgress:function(){var e=this;if(e.data)if(e.bossCfg){var t=e.bossCfg.hp,a=e.data.hp,i=a/t;e.skin.img_progress.node.width=e.progressWidth*i,e.skin.lab_progress.string=(1<=i?100:(100*i).toFixed(1))+"%";var n=0<a;e.skin.img_progress.node.active=n,e.skin.progress_bar_bg.node.active=n,e.skin.lab_progress.node.active=n}else;else;},setBossStates:function(){var e=this.skin,t=this.data;if(e.challenge_btn.active=!t.isKill,e.fight_img.active=!t.isKill,e.fight_count.active=!t.isKill,e.gray_btn.active=t.isKill,e.killed_img.active=t.isKill,e.check_kill_log.active=t.isKill,t.emulator){var a=t.emulator.length;e.fight_count.string=game.Lang.get(518,a)}else e.fight_count.string=game.Lang.get(518,0)},updateTime:function(){if(this.refreshTime){var e=this.refreshTime,t=game.SysTime.curTime;e<t&&(this.skin.right_desc2.string=b8e.TimeUtil.formatTime(0),this.timer.stop());var a=e-t;this.skin.right_desc2.string=b8e.TimeUtil.formatTime(a)}else this.timer.stop()},resetBoss:function(){this.send(game.GuoshiChallengeEvts.V2C_RESET_BOSS,this.data.bossId)},clearData:function(){},setModel:function(){var e=this;if(e.data&&e.bossId!==e.data.bossId){if(e.bossId=e.data.bossId,!e.bossId)return void b8e.warn("bossId: ",e.bossId);if(!e.bossCfg)return;var t=game.AvatarUtil.getUIModel(e.bossCfg),a=game.ResCfg.getUrl(5e3,t),i=e._model.getAnimator(game.AnimType.BODY,1);(i=i||e._model.addAnimator(game.AnimType.BODY,1))&&(a?(i.load(a),i.play()):i.clear())}},setPrizeList:function(){var e=this.data.getPrizeList();this._prizeList.setData(e)},onHide:function(){}}),b8e.RC("$$game","$$GuoshiChallengeItem",e)}(),function(){var e=game.View.extends({ctor:function(){this._super(572)},init:function(){var e=this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.GuoshiChallengeItem,e.bindEnum=game.ME.GuoshiChallenge,e.addToParent(this.skin.list),this.skin.time_desc.string=game.Lang.get(5972),this.guoShiMax=game.guoshiChallengeData.getGuoShiMax(),this.onceGuoShiBuy=game.guoshiChallengeData.getOnceGuoShiBuy()},notify:function(e){var t=this.Evts;switch(e){case t.C2V_UPDATE_CHALLENGE_COUNT:this.setChallengeCount();break;case t.C2V_UPDATE_INFO:this.setChallengeCount(),this.updateList();break;case t.C2V_UPDATE_LIST:this.updateList()}},onShow:function(){this.send(this.Evts.V2C_SHOW_VIEW),this.setChallengeCount(),this.updateList()},onHide:function(){},updateList:function(){this.bossInfoList=game.guoshiChallengeData.getBossList(),this._list.setData(this.bossInfoList)},setChallengeCount:function(){var e=game.guoshiChallengeData.challenge;this.skin.challenge_lab_0.string=game.Lang.get(50147,e,this.guoShiMax);this.guoShiMax},onStageResize:function(){this.setPosition(0,0)}});b8e.module.registerView(game.ME.GuoshiChallenge,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(445),this.setSize(540,94)},setData:function(){var e=this.data;if(e){var t=e.rank+1;this.skin.lab_name.string=e.roleName,this.skin.lab_power.string=e.damage;for(var a=1;a<4;a++)this.getComponent("rank"+a).node.active=t==a;3<t?(this.skin.lab_time.string=t,this.skin.rank4.active=!0):(this.skin.lab_time.string="",this.skin.rank4.active=!1)}else;}}),b8e.RC("$$game","$$GuoshiDamageItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(446)},init:function(){var e=this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical);e.itemRender=game.GuoshiDamageItem,e.bindEnum=game.ME.GuoshiChallenge,e.layout.paddingTop=0,e.layout.spacingY=5,e.addToParent(this.skin.node_scrollview)},onShow:function(){this.skin.labTitle.string=game.Lang.get(520),this.skin.lab_item_title1.string=game.Lang.get(9147),this.skin.lab_item_title2.string=game.Lang.get(9148),this.skin.lab_item_title3.string=game.Lang.get(9149);var e=game.guoshiChallengeData,t=e.selectBossId;if(t){var a=e.getDamageList(t);a?this.updateItem(a):this._list.clear()}},notify:function(){},updateItem:function(e){if(e){if(1<e.length){e.sort(function(e,t){return t.damage-e.damage})}for(var t=0;t<e.length;t++){e[t].rank=t}}this._list.setData(e)}});b8e.module.registerView(game.ME.GuoshiCDamageLog,e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(448),this.setSize(540,68)},setData:function(){var e=this.data;if(e)this.skin.lab_time.string=b8e.TimeUtil.formatTimestamp(e.time,"h:m:s"),this.skin.lab_name.string=e.roleName,this.skin.lab_power.string=e.power;else;}}),b8e.RC("$$game","$$GuoshiLogItem",e)}(),function(){var e=game.View.extends({_showModel:!0,ctor:function(){this._super(446)},init:function(){if(!this._list){this._list=new game.List(b8e.ScrollBoxType.Vertical,b8e.LayoutType.Vertical),this._list.itemRender=game.GuoshiLogItem,this._list.bindEnum=game.ME.GuoshiChallenge,this._list.layout.spacingY=5,this._list.addToParent(this.skin.node_scrollview)}},onShow:function(){var e=game.guoshiChallengeData,t=e.selectBossId;if(t){var a=e.getKillRecordList(t);a?this.updateItem(a):this._list.clear()}},notify:function(){},updateItem:function(e){if(!this._list||!e||e.length<=0);else this._list.setData(e)}});b8e.module.registerView(game.ME.GuoshiCKillLog,e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,rechargeList:null,ctor:function(){this._super(),this.groupMap=b8e.HashMap.get(),this.groupList=[]},onInited:function(){this.obj1={id:0},this.obj2={serverStart:0},this.obj3={tab:0}},getListByDay:function(e){return this.obj3.tab=e,this.getData(this.obj3,!0,!1)},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getOneDataByDay:function(){return this.obj3.tab=tab,this.getData(this.obj3,!1,!1,!1)}}),b8e.RC("$$game","$$SalePrizeCfg",e)}(),function(){var e;e=b8e.GameConfig.extends({obj1:null,obj2:null,rechargeList:null,ctor:function(){this._super(),this.groupMap=b8e.HashMap.get(),this.groupList=[]},onInited:function(){this.obj1={id:0},this.obj2={serverStart:0},this.obj3={group:0};var e=this.getKeys("group");if(e&&e.length)for(var t=e.length,a=0;a<t;a++){var i=e[a];this.obj3.group=i;var n=this.getData(this.obj3,!1,!1,!1);this.groupList.push(n)}},getListByDay:function(e){return this.obj3.group=e,this.getData(this.obj3,!0,!1)},getDataById:function(e){return this.obj1.id=e,this.getData(this.obj1)},getOneDataByDay:function(e){return this.obj3.group=e,this.getData(this.obj3,!1,!1,!1)},getCurGroup:function(e){for(var t=this.groupList,a=t.length,i=0;i<a;i++){var n=t[i];if(e>=n.serverStart&&e<n.serverEnd)return n.group}return 0}}),b8e.RC("$$game","$$SingleRechargeCfg",e)}(),function(){var e;e=b8e.Enum({None:0,V_REFRESH_BTN:-1,V_SELECT_BTN:-1,V_SHOW_VIEW:-1,V_HIDE_VIEW:-1,C2C_REFRESH_BTNS:-1,V_AUTO_POP:-1,C_AUTO_POP:-1,C2C_CHANGEBTN:-1}),b8e.RC("$$game","$$GoodGiftEvts",e)}(),function(){var e=game.Control.extends({lastId:-1,lastModuleEnum:-1,mainEntrance:!0,isPop:!1,init:function(){this.spotAlert=game.spotAlert.set(game.SAE.GOOD_GIFT_ALERT,game.SAE.HOME)},ipc:function(){this.evts={MainRole:{C_RESET_DAILY:this.resetDaily,C_INIT_MSIC_DATA:this.initMsicData},MainUIBottom:{C_GO_HOME:this.checkPopGoodGift}}},triggerOpen:function(e){e==this.moduleEnum&&game.goodGiftData.init()},checkPopGoodGift:function(){this.isPop||!game.goodGiftData.isOpen()||game.goodGiftData.banAutoPop||(game.module.show(game.ME.GoodGift),this.isPop=!0)},initMsicData:function(){game.goodGiftData.banAutoPop=game.settingData.isBanAutoPop(),this.send(this.Evts.V_AUTO_POP)},resetDaily:function(){this.send(this.Evts.V_REFRESH_BTN),this.dpt(this.Evts.C2C_REFRESH_BTNS),this.selectFirstBtn()},notify:function(e,t){switch(e){case this.Evts.V_SELECT_BTN:this.selectBtn(t);break;case this.Evts.V_SHOW_VIEW:this.showView();break;case this.Evts.V_HIDE_VIEW:this.hideView()}},showView:function(){if(this.mainEntrance)this.selectFirstBtn();else{this.mainEntrance=!0}},hideView:function(){var e=this;if(0<e.lastModuleEnum){game.module.hide(e.lastModuleEnum)}game.goodGiftData.selectPage(0,this.lastId),e.lastId=-1,e.lastModuleEnum=-1},selectFirstBtn:function(){var e=game.goodGiftData.getBtns();if(!e||e.length<1){game.module.hide(this.moduleEnum)}else this.selectBtn(e[0].id)},selectBtn:function(e){var t=this;if(t.lastId!=e){var a=game.GoodGiftBtnCfg.getData(e);if(a){var i=game.GoodGiftType;if(game.goodGiftData.checkIsOpen(e)){var n=a.goodGiftType;if(n==i.SPECIAL_GIFT_1)game.specialGiftData.setCurGroup(e);else if(n==i.SUPER_DISCOUNTS_1)game.goodGiftRMBData.changeDataByBtn(e);else if(t.lastModuleEnum==a.moduleEnum)return;-1<t.lastModuleEnum&&game.module.hide(t.lastModuleEnum),game.module.showTab(a.moduleEnum,t.moduleEnum);var s=a.id;game.goodGiftData.selectPage(s,t.lastId),t.lastId=s,t.lastModuleEnum=a.moduleEnum,game.goodGiftData.lastBtnId=t.lastId,t.dpt(game.GoodGiftEvts.C2C_CHANGEBTN)}else{if(0<this.lastId){this.selectBtn(this.lastId)}else this.selectFirstBtn()}}}},selectToggle:function(e){if(game.GoodGiftBtnCfg.getData(e)){var t=game.goodGiftData.getBtns();if(!t||t.length<1){game.module.hide(this.moduleEnum)}else this.mainEntrance=!1,this.selectBtn(e)}else;},autoPopBtn:function(){game.goodGiftData.banAutoPop=!game.goodGiftData.banAutoPop,this.send(this.Evts.V_AUTO_POP),this.dpt(this.Evts.C_AUTO_POP,game.goodGiftData.banAutoPop?1:0)}});b8e.module.registerControl(game.ME.GoodGift,e,game.GoodGiftEvts)}(),function(){var e;e=b8e.Enum({NONE:0,SPECIAL_GIFT_1:1,SPECIAL_GIFT_2:2,SPECIAL_GIFT_3:3,SINGLE_RECHARGE:4,TOTAL_RECHARGE:5,TOTAL_COST:6,SUPER_DISCOUNTS_1:7}),b8e.RC("$$game","$$GoodGiftType",e)}(),function(){var e=b8e.Object.extends({banAutoPop:!1,lastBtnId:0,alertList:null,ctor:function(){this._super(),this.goodGiftBtns=[],this.goodGiftBtnsMap=b8e.HashMap.get()},init:function(){this.initBtns()},initBtns:function(){this.goodGiftBtnsMap.clear();var e,t,a=game.GoodGiftBtnCfg.getDatas();if(!a||a.length<1)return null;for(var i=a.length,n=0;n<i;n++)e=a[n],(t=new game.GoodGiftBtnInfo).setData(e),this.goodGiftBtnsMap.set(t.id,t)},getBtns:function(){if(this.goodGiftBtns.length=0,!this.goodGiftBtnsMap)return this.goodGiftBtns;for(var e,t=this.goodGiftBtnsMap.values(),a=t.length,i=0;i<a;i++)e=t[i],this.isShowActive(e.id)&&(this.goodGiftBtns.push(e),e.bindAlert(e.redPoint));return this.goodGiftBtns.sort(this.sortBtn),this.goodGiftBtns},sortBtn:function(e,t){return e.sortId-t.sortId},isShowActive:function(e){return this.checkIsOpen(e)},selectPage:function(e,t){if(this.goodGiftBtns&&!(this.goodGiftBtns.length<1)){for(var a,i=this.goodGiftBtns.length,n=0;n<i;n++)(a=this.goodGiftBtns[n]).id==e&&(a.select=!0),a.id==t&&(a.select=!1);this.curIndex=e}},checkIsOpen:function(e){var t=this.getOpenEnumById(e);if(0==t)return!1;if(!game.moduleOpen.checkOpen(t))return!1;var a=game.GoodGiftBtnCfg.getData(e);if(!a||a.length<1)return!1;var i=a.goodGiftType,n=game.GoodGiftType;switch(i){case n.SPECIAL_GIFT_1:return game.specialGiftData.isOpen(e);case n.SINGLE_RECHARGE:return game.singleRechargeData.isOpen();case n.SUPER_DISCOUNTS_1:return game.goodGiftRMBData.isOpen(e)}return!1},getOpenEnumById:function(e){var t=game.GoodGiftBtnCfg.getData(e);return t?t.moduleEnum:0},isOpen:function(){if(!game.moduleOpen.checkOpen(game.ME.GoodGift))return!1;var e=this.getBtns();return!(!e||e.length<1)}});game.goodGiftData=game.goodGiftData||new e}(),function(){var e;e=b8e.Object.extends({select:!1,alert:!1,id:0,sortId:0,redPoint:!1,setData:function(e){this.id=e.id,this.sortId=e.sortId,this.redPoint=e.redPoint},bindAlert:function(e){if(e&&!this._bindAlert){var t,a=game.GoodGiftType;switch(e){case a.SPECIAL_GIFT_1:t=game.SAE.SPECIAL_GIFT_ALERT_1;break;case a.SPECIAL_GIFT_2:t=game.SAE.SPECIAL_GIFT_ALERT_2;break;case a.SPECIAL_GIFT_3:t=game.SAE.SPECIAL_GIFT_ALERT_3;break;case a.SINGLE_RECHARGE:t=game.SAE.SINGLE_RECHARGE_ALERT;break;case a.TOTAL_RECHARGE:t=game.SAE.TOTAL_RECHARGE_ALERT;break;case a.TOTAL_COST:t=game.SAE.TT_ACC_COST2_ALERT}if(t){game.spotAlert.setCb(t,this.updateAlert,this),this._bindAlert=!0}}},updateAlert:function(e){this.alert=e.alert}}),b8e.BindingUtil.bind(e),b8e.RC("$$game","$$GoodGiftBtnInfo",e)}(),function(){var e;e=game.ListItem.extends({ctor:function(){this._super(492),this.setSize(86,96)},init:function(){var e=this.btn=b8e.Sprite.get();e.addToParent(this.skin.btn),e.setAnchor(.5,.5)},setData:function(){var e=this,t=e.data;e.skin.btnSelect.active=t.select;var a,i=game.GoodGiftBtnCfg.getData(t.id);if(i)if(i.titleBg)a=game.ResCfg.getImgUrl(i.titleBg),e.btn.loadTexture(a),this.skin.alert.node.active=t.alert;else{b8e.error("\u798f\u5229\u6309\u94ae\u914d\u7f6e\u6ca1\u6709\u5bf9\u5e94\u7684\u6807\u9898\u6309\u94ae\u5e95\u56fe,id:",i.id,"\u798f\u5229\u6309\u94ae:",i.desc)}},clickBtn:function(){this.send(game.GoodGiftEvts.V_SELECT_BTN,this.data.id)}}),b8e.RC("$$game","$$GoodGiftBtnItem",e)}(),function(){var e=game.View.extends({last:0,now:0,ctor:function(){this._super(493)},init:function(){var e=this,t=e.goodGiftBtns=new game.List(b8e.ScrollBoxType.Horizontal,b8e.LayoutType.Horizontal);t.itemRender=game.GoodGiftBtnItem,t.addToParent(e.skin.scrollView),t.bindEnum=game.ME.GoodGift,t.layout.spacingX=18},notify:function(e){switch(e){case this.Evts.V_REFRESH_BTN:this.btns=game.goodGiftData.getBtns(),this.goodGiftBtns.setData(this.btns);break;case this.Evts.V_AUTO_POP:this.skin.check.node.active=game.goodGiftData.banAutoPop}},onShow:function(){this.btns=game.goodGiftData.getBtns(),this.goodGiftBtns.setData(this.btns),this.skin.check.node.active=game.goodGiftData.banAutoPop,this.send(this.Evts.V_SHOW_VIEW)},onHide:function(){this.send(this.Evts.V_HIDE_VIEW),this.goodGiftBtns.scrollToLeft(0)},viewLeftBtn:function(){this.goodGiftBtns.scrollContainerLeft()},viewRightBtn:function(){this.goodGiftBtns.scrollContainerRight()}});b8e.module.registerView(game.ME.GoodGift,e)}()},{}]},{},[1]);