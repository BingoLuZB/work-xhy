(function(){return function o(a,s,l){function u(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(f)return f(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return u(a[t][1][e]||e)},i,i.exports,o,a,s,l)}return s[t].exports}for(var f="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}})()({1:[function(e,r,o){(function(p){"use strict";var J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var u=null,f=null,c=null;(u=u||{}).ns="b8e",(f=f||{}).ns="game",(c=c||{}).ns="lib",function(){(function(){var e="undefined",t=("undefined"==typeof window?"undefined":J(window))===e?p:window;("undefined"==typeof window?"undefined":J(window))===e&&(t.window=t),(void 0===p?"undefined":J(p))===e&&(t.global=t),window.engine=u,window.b8e=u,window.game=f,window.lib=c,window.isNaN=function(e){return(e=+e)!=e},b8e.TypeUndefined=e,b8e.TypeFunction="function",b8e.TypeObject="object",b8e.TypeNumber="number",b8e.TypeBoolean="boolean",("undefined"==typeof setTimeout?"undefined":J(setTimeout))!==b8e.TypeFunction&&(window.setTimeout=setTimeout),("undefined"==typeof clearTimeout?"undefined":J(clearTimeout))!==b8e.TypeFunction&&(window.clearTimeout=clearTimeout),("undefined"==typeof document?"undefined":J(document))===b8e.TypeUndefined&&(window.document={}),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||function(e){clearTimeout(e)};var n,r=null;if(J(document.hidden)!==b8e.TypeUndefined?r="hidden":J(document.mozHidden)!==b8e.TypeUndefined?r="mozHidden":J(document.msHidden)!==b8e.TypeUndefined?r="msHidden":J(document.webkitHidden)!==b8e.TypeUndefined&&(r="webkitHidden"),window.hiddenProperty=r,window.performance||(window.performance={}),!window.performance.now){var i=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(i=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-i}}b8e.params||(("undefined"==typeof params?"undefined":J(params))!==b8e.TypeUndefined?b8e.params=params:b8e.params={}),void 0===b8e.params.uncaughtException&&(b8e.params.uncaughtException=!0),b8e.isWeChatGame=!(!b8e.params.isWeChatGame||("undefined"==typeof wx?"undefined":J(wx))===b8e.TypeUndefined||!wx.getSystemInfoSync&&!wx.getSharedCanvas),b8e.isQQMiniGame=!(!b8e.params.isQQMiniGame||("undefined"==typeof wx?"undefined":J(wx))===b8e.TypeUndefined||("undefined"==typeof qq?"undefined":J(qq))===b8e.TypeUndefined),b8e.isWeChatGameSub=!(("undefined"==typeof wx?"undefined":J(wx))===b8e.TypeUndefined||!wx.getSharedCanvas),b8e.isQQPlay=!(!b8e.params.isQQPlay||("undefined"==typeof bk?"undefined":J(bk))===b8e.TypeUndefined),b8e.isNative=!!b8e.params.isNative,b8e.isRuntime=!!b8e.params.isRuntime,b8e.isMiniGame=!(!b8e.isRuntime||("undefined"==typeof loadRuntime?"undefined":J(loadRuntime))!==b8e.TypeFunction),b8e.isOppoGame=!(!b8e.isRuntime||!b8e.params.isOppoGame),b8e.isMeizuGame=!(!b8e.isRuntime||("undefined"==typeof mz_jsb?"undefined":J(mz_jsb))===b8e.TypeUndefined),b8e.getXHR=function(){return b8e.XMLHttpRequest?new b8e.XMLHttpRequest:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},n=function(){return window.performance.now()};var o=(b8e.getNow=n)(),a=0;b8e.getTimer=function(){return a=n()-o,b8e.timeStamp=a},b8e.timeStamp=b8e.getTimer(),b8e.isActivated=!1,b8e.proto={},window.performance.mark||(window.performance.mark=function(){}),window.performance.measure||(window.performance.measure=function(){}),window.performance.memory||(window.performance.memory={usedJSHeapSize:0,totalJSHeapSize:0,jsHeapSizeLimit:0}),b8e.info=function(){var e=Array.prototype.slice.call(arguments).concat();e.unshift("B8E INFO:"),console&&console.info.apply&&console.info.apply(console,e)},b8e.log=function(){var e=Array.prototype.slice.call(arguments).concat();e.unshift("B8E LOG:"),console&&console.log.apply&&console.log.apply(console,e)},b8e.warn=function(){var e=Array.prototype.slice.call(arguments);try{Error.captureStackTrace(b8e,b8e.warn)}catch(e){try{throw Error()}catch(e){b8e.stack=e.stack}}e[e.length]=":"+b8e.stack;var t=e.concat();t.unshift("B8E WARN:"),console&&console.warn.apply&&console.warn.apply(console,t)},b8e.error=function(){var e=Array.prototype.slice.call(arguments);try{Error.captureStackTrace(b8e,b8e.error)}catch(e){try{throw Error()}catch(e){b8e.stack=e.stack}}e[e.length]=":"+b8e.stack;var t=e.concat();t.unshift("B8E ERROR:"),console&&console.error.apply&&console.error.apply(console,t)},b8e.checkGLErrorDebug=function(){if(b8e.macro.IS_DEBUG&&b8e.renderType===b8e.RenderType.WEBGL){var e=b8e.renderer.device._gl.getError();e&&b8e.error("GL\u5f02\u5e38\uff1a",e)}},b8e.createMap=function(){var e=Object.create(null);return delete e.__v8__,b8e.mapCount++,e},Function.prototype.bind||(Function.prototype.bind=function(e){"function"!=typeof this&&b8e.error("Function.prototype.bind - what is trying to be bound is not callable");function t(){}function n(){return i.apply(this instanceof t&&e?this:e,r.concat(Array.prototype.slice.call(arguments)))}var r=Array.prototype.slice.call(arguments,1),i=this;return t.prototype=this.prototype,n.prototype=new t,n}),window.__reflect=window&&window.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},window.__extends=window&&window.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),window.__define=window.__define||function(e,t,n,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n,set:r})}})(),b8e.startup=null,b8e.stage=null,b8e.stageWidth=0,b8e.stageHeight=0,b8e.screenWidth=0,b8e.screenHeight=0,b8e.settings={},b8e.ccSettings={},b8e.protocol="http:",b8e.renderable=!0,("undefined"==typeof extendLib?"undefined":J(extendLib))!==b8e.TypeUndefined&&(lib.extend=extendLib),("undefined"==typeof extendMixin?"undefined":J(extendMixin))!==b8e.TypeUndefined&&(lib.mixin=extendMixin),b8e.version=b8e.params.version,b8e.params.uncaughtException&&(b8e.isWeChatGame?wx.onError(function(e,t){setTimeout(function(){b8e.onUncaughtException(e,t,"")},0)}):window.onerror=function(e,t,n){return setTimeout(function(){b8e.onUncaughtException(e,t,n)},0),!!b8e.macro&&!b8e.macro.IS_DEBUG});var e=0,r=0,i=0,o={},a={},t=0;b8e.clsCount=0,b8e.instCount=0,b8e.funcCount=0,b8e.mapCount=0,b8e.getClsHash=function(){return++e},b8e.getFuncHash=function(e){if(e){var t=e.hashCode;void 0===t&&(t=b8e.AHC(e,++r));var n=a[t];return n=n||(a[t]=0),a[t]=++n}return++i},b8e.getInstHash=function(e){if(e){var t=e.hashCode;void 0===t&&(t=b8e.AHC(e,++r));var n=o[t];return n=n||(o[t]=0),o[t]=++n}return++r},b8e.getHashCode=function(){return++t};var n={enumerable:!(b8e.applyType=function(e){if(!e)return!1;if(e.__InitedType)return!0;var t=void 0===e?"undefined":J(e);if(t===b8e.TypeFunction)e.__TypeFunction=!0;else{if(t!==b8e.TypeObject)return!1;e.__TypeObject=!0}return e.__InitedType=!0}),configurable:!1,writable:!1};b8e.AHC=function(e,t){void 0===e.hashCode&&(n.value=t,Object.defineProperty(e,"hashCode",n))},b8e.SHC=function(e){void 0===e.hashCode&&(b8e.applyType(e),e.__TypeFunction?b8e.AHC(e,b8e.getFuncHash()):e.__TypeObject&&b8e.AHC(e,b8e.getInstHash()))},b8e.SHC(b8e),b8e.SHC(game),b8e.RC=function(e,t,n){e=b8e.getNormDP(e),t=b8e.getNormDP(t);var r=window[e];((r=r||(window[e]={}))[t]=n).__name=e+"."+t};var d=null,h=null;b8e.applyBuiltin=function(e){var t=d,n=h,r=e.alias;if(r)for(var i in t=d=t||{},n=h=n||{},r){var o=r[i];n[t[i]=o]=i}var a=e.proto;if(a)for(var s in a){var l=a[s],u={};u[l.package]=l;var f=b8e.proto[s]={},c=t&&t[s];c&&(b8e.proto[c]=f),b8e.ProtobufUtil.allotProps(u,f)}},b8e.getOriginName=function(e){return h&&h[e]||e},b8e.getAliasName=function(e){return d&&d[e]||e};b8e.getNormP=function(e,t){return 0===e.indexOf("_$")?e=e.substr(2):t&&b8e.warn(6008,e),e},b8e.getNormDP=function(e,t){return 0===e.indexOf("$$")?e=e.substr(2):t&&b8e.warn(6007,e),e},b8e.getFPV=function(e,t){return e[t]},b8e.setFPV=function(e,t,n){e[t]=n},b8e.getDPV=function(e,t){return t=b8e.getAliasName(t)||t,(e.__Object||e.__Enum)&&(e.isDynamicProp(t)||b8e.warn(6007,t)),e[t]},b8e.setDPV=function(e,t,n){t=b8e.getAliasName(t)||t,(e.__Object||e.__Enum)&&(e.isDynamicProp(t)||b8e.warn(6007,t)),e[t]=n};var s={writable:!0,enumerable:!0,configurable:!0};b8e.mixinDP=function(e,t){s.value=function(e){return!!t[e]},Object.defineProperty(e,"isDynamicProp",s),s.value=null},b8e.getLoop=function(){return b8e.loop||(b8e.loop=new b8e.Loop),b8e.loop},b8e.drawCalls=0,b8e.getDrawCalls=function(){return b8e.drawCalls},b8e.onUncaughtException=function(e,t,n){b8e.error(e,t,n)},b8e.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");if(window.location&&window.location.search){var n=window.location.search.substr(1).match(t);if(n)return decodeURIComponent(n[2])}return null},b8e.getProtocol=function(){return!(b8e.isWeChatGame||b8e.isOppoGame||b8e.isMeizuGame)&&window.location&&window.location.protocol?window.location.protocol:b8e.protocol},b8e.getHost=function(){return window.location&&window.location.host?window.location.host:""},b8e.isIPhoneX=function(){if(/iPad|iPhone|iPod/.test(window.navigator.userAgent)&&!window.MSStream){var e=window.devicePixelRatio||1,t=window.screen.width*e,n=window.screen.height*e;if(1125==t&&2436==n)return!0;if(2436==t&&1125==n)return!0}return!1},b8e.getWeChatEnv=function(){if(b8e.isWeChatGame)switch(__wxConfig.envVersion){case"develop":return b8e.WeChatEnv.DEVELOP;case"trial":return b8e.WeChatEnv.TRIAL;case"release":return b8e.WeChatEnv.RELEASE;default:return b8e.WeChatEnv.DEVELOP}return 0};var l=null;b8e.onInit=function(e,t,n){b8e.ready?e.apply(t,n):(l=l||b8e.HashMap.get(),b8e.CallBackUtil.addCallBackData(l,e,t||b8e,n))},b8e._inited=function(){l&&0<l.count()&&(b8e.CallBackUtil.exceteCallBackData(b8e,l),b8e.CallBackUtil.removeAllCallBackData(l))}}()})(),b8e.macro={IS_PREVIEW:!!b8e.params.isPreview,IS_RELEASE:!!b8e.params.isRelease,IS_PRE_RELEASE:!!b8e.params.isPreRelease,IS_DEBUG:!b8e.params.isRelease||!!b8e.params.isDebug,IS_ENGINE_EDITOR:!1,IS_DESKTOP:!1,BENCHMARK:!!b8e.params.benchmark,PROFILER_POSITION:{x:5,y:150},BEFORE_UNLOAD_MSG:null,DIRECTION_COUNT:5,MAX_REQUEST_RELOAD:3,MAX_RES_RELOAD:3,DEFAULT_FONT_FAMILY:"Arial",EDTEXT_ALAWYS_ON_TOP:!1,UI_LOAD_DEPENDS:!1,DEFAULT_CACHE_MODE:2,COLOR_BRIGHTNESS:.4};J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var u=b8e.JsUtil={};u.tmpValueDesc={value:void 0,writable:!0,enumerable:!1,configurable:!1};var a={get:null,set:null,enumerable:!(u.defineValue=function(e,t,n,r,i,o){void 0===r&&(r=!0),t=b8e.getNormP(t);var a=u.tmpValueDesc;a.value=n,a.writable=r,a.enumerable=!!i,a.configurable=!!o,Object.defineProperty(e,t,a),a.value=void 0}),configurable:!1},o={get:null,enumerable:!(u.defineGetSetAccessor=function(e,t,n,r,i,o){(void 0===r?"undefined":J(r))!==b8e.TypeFunction&&(i=r,r=void 0),a.get=n,a.set=r,a.enumerable=!!i,a.configurable=!!o,Object.defineProperty(e,t,a),a.get=null,a.set=null}),configurable:!1},s={set:null,enumerable:!(u.defineGetAccessor=function(e,t,n,r,i){o.get=n,o.enumerable=!!r,o.configurable=!!i,Object.defineProperty(e,t,o),o.get=null}),configurable:!1};function m(e,t){var n=null,r=!1;t&&("object"===(void 0===t?"undefined":J(t))?n=t:r=!0);if(Array.isArray(e)){n&&((n=Array.isArray(n)?n:null)||b8e.error(6005));for(var i=e.length,o=0;o<i;o++){var a=e[o];if(a&&"object"===(void 0===a?"undefined":J(a))){var s=null;n&&((s=n[0])||b8e.warn(6006),t=s||{}),m(a,t)}}}else{n&&((n="object"===(void 0===n?"undefined":J(n))?n:null)||b8e.error(6004));var l=null;if(n)for(var u in l={},e){var f=e[u],c=null;n&&((c=n[u])||b8e.warn(6003,u)),f&&"object"===(void 0===f?"undefined":J(f))&&(n&&(t=c||{}),m(f,t));var d=b8e.getAliasName(u)||u;d!==u&&(l[u]=d)}else for(var h in l={},e){var p=e[h];p&&"object"===(void 0===p?"undefined":J(p))&&m(p,t);var v=void 0;if(r){var g=b8e.getNormDP(h,!0);v=b8e.getOriginName(g)||g}else{v=b8e.getAliasName(h)||h}v!==h&&(l[h]=v)}if(l){for(var b in l){var y=l[b],_=e[b];delete e[b],e[y]=_}l=null}}}u.defineSetAccessor=function(e,t,n,r,i){s.set=n,s.enumerable=!!r,s.configurable=!!i,Object.defineProperty(e,t,s),s.set=null},u.jsonParse=function(e,t,n){if(!e)return b8e.error(3089),null;if("string"!=typeof e)return b8e.error(3090),null;var r=JSON.parse(e);if(t){var i=null;"object"===(void 0===t?"undefined":J(t))&&m(i=t,!0),m(r,i||!!n)}return r},u.applyAlias=m,u.getClassName=function(e){if((void 0===e?"undefined":J(e))!==b8e.TypeFunction)return e&&e.constructor?u.getClassName(e.constructor):"";var t=e.prototype;if(t&&t.hasOwnProperty("__classname__")&&t.__classname__)return t.__classname__;var n="";if(e.name&&(n=e.name),e.toString){var r=void 0,i=e.toString();(r="["===i.charAt(0)?i.match(/\[\w+\s*(\w+)\]/):i.match(/function\s*(\w+)/))&&2===r.length&&(n=r[1])}return"Object"!==n?n:""};var n=4294967296;function e(e,t){void 0===t&&(t=e,e=null),this.get=null,this.count=0,this._pool=new Array(t),this._cleanup=e}u.xyToInt=function(e,t){return(void 0===e?"undefined":J(e))!==b8e.TypeNumber&&(b8e.error(3061),e=0),e<0?(b8e.error(3062),e=0):32767<e&&(b8e.error(3063),e=32767),(void 0===t?"undefined":J(t))!==b8e.TypeNumber&&(b8e.error(3064),e=0),t<0?(b8e.error(3065),t=0):65535<t&&(b8e.error(3066),t=65535),e<<16|t},u.getXFromInt=function(e){return e<0?(b8e.error(3067),e=0):2147418112<e&&(b8e.error(3068),e=2147418112),e>>16},u.getYFromInt=function(e){return e<0?(b8e.error(3069),e=0):2147418112<e&&(b8e.error(3070),e=2147418112),65535&e},u.xyToNumber=function(e,t){return(e>>>0)*n+(t>>>0)},u.getXFromNumber=function(e){return e/n|0},u.getYFromNumber=function(e){return e%n|0},u.mergeHash=function(e,t,n,r){var i=0,o=0;if(void 0===r&&(r=!1),n){var a=void 0;if(void 0===(a=n.hashCode)&&(a=b8e.AHC(n,b8e.getInstHash()),r||b8e.warn(1057)),e&&void 0===(i=e.hashCode)){b8e.applyType(e);var s=e.__hashCodeMap;void 0===(i=(s=s||(e.__hashCodeMap=b8e.createMap()))[a])&&(b8e.applyType(e),i=e.__TypeFunction?s[a]=b8e.getFuncHash(n):s[a]=b8e.getInstHash(n)),r||b8e.warn(1057)}if(t&&void 0===(o=t.hashCode)){b8e.applyType(t);var l=t.__hashCodeMap;void 0===(o=(l=l||(t.__hashCodeMap=b8e.createMap()))[a])&&(b8e.applyType(t),o=t.__TypeFunction?l[a]=b8e.getFuncHash(n):l[a]=b8e.getInstHash(n)),r||b8e.warn(1057)}}else e&&void 0===(i=e.hashCode)&&(b8e.applyType(e),i=e.__TypeFunction?b8e.AHC(e,b8e.getFuncHash()):b8e.AHC(e,b8e.getInstHash()),r||b8e.warn(1057)),t&&void 0===(o=t.hashCode)&&(b8e.applyType(t),o=t.__TypeFunction?b8e.AHC(t,b8e.getFuncHash()):b8e.AHC(t,b8e.getInstHash()),r||b8e.warn(1057));return u.xyToNumber(i,o)},e.prototype._get=function(){if(0<this.count){--this.count;var e=this._pool[this.count];return this._pool[this.count]=null,e}return null},e.prototype.put=function(e){var t=this._pool;if(this.count<t.length){if(this._cleanup&&!1===this._cleanup(e))return;t[this.count]=e,++this.count}},e.prototype.resize=function(e){0<=e&&(this._pool.length=e,this.count>e&&(this.count=e))},u.Pool=e})();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){b8e.__extends=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r},b8e.__define=b8e.__define||function(e,t,n,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n,set:r})},b8e.registerProperty=function(e,t,n,r){var i=e.prototype;i.__meta__=i.__meta__||{},i.__meta__[t]=n,r&&(i.__defaultProperty__=t)},b8e.defineGetterSetter=function(e,t,n,r,i,o){if(e.__defineGetter__)n&&e.__defineGetter__(t,n),r&&e.__defineSetter__(t,r);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var a={enumerable:!1,configurable:!0};n&&(a.get=n),r&&(a.set=r),Object.defineProperty(e,t,a)}if(!i&&!o)for(var s=void 0!==n,l=void 0!==r,u=Object.getOwnPropertyNames(e),f=0,c=u.length;f<c;f++){var d=u[f];if((e.__lookupGetter__?!e.__lookupGetter__(d):!Object.getOwnPropertyDescriptor(e,d))&&J(e[d])===b8e.TypeFunction){var h=e[d];if(s&&h===n&&(i=d,!l||o))break;if(l&&h===r&&(o=d,!s||i))break}}var p=e.constructor;i&&(p.__getters__||(p.__getters__={}),p.__getters__[i]=t),o&&(p.__setters__||(p.__setters__={}),p.__setters__[o]=t)},b8e.clone=function(e){var t=e.constructor?new e.constructor:{};for(var n in e){var r=e[n];r&&(void 0===r?"undefined":J(r))===b8e.TypeObject?t[n]=b8e.clone(r):t[n]=r}return t},b8e.inject=function(e,t){for(var n in e)t[n]=e[n]},b8e.newObject=function(e,t,n,r,i,o){var a=new e(t,n,r,i,o);return 6<arguments.length&&b8e.error("b8e.newObject\u53c2\u6570\u4e0d\u80fd\u5927\u4e8e5\u4e2a\uff01"),a};b8e.ClassMgr={dumpInfo:function(){var e="",t=[];e+="\n\u6d88\u8017\u4fe1\u606f\uff1a",(t=(t=(t=t.concat(this._dumpDefinitionInfo(b8e))).concat(this._dumpDefinitionInfo(game))).concat(this._dumpDefinitionInfo(lib))).sort(this._onSortCostInfo);for(var n=t.length,r=0;r<n;r++)e+=t[r].info;return e},_onSortCostInfo:function(e,t){return 0<e.instCount&&t.instCount<1?-1:e.instCount<1&&0<t.instCount?1:e.cost>t.cost?-1:e.cost<t.cost?1:e.maxCost>t.maxCost?-1:e.maxCost<t.maxCost?1:e.callCount>t.callCount?-1:e.callCount<t.callCount?1:0},_dumpDefinitionInfo:function(e){var t=[];for(var n in e){var r=e[n];if((void 0===r?"undefined":J(r))===b8e.TypeFunction&&r.__clsHash){void 0===r.__instCount&&(r.__instCount=0);var i=r.prototype;for(var o in i){var a=i[o];(void 0===a?"undefined":J(a))===b8e.TypeFunction&&this._dumpPushInfo(t,e,r,a,n,o)}var s=r.__getters__;for(var l in s){var u=s[l];this._dumpPushInfo(t,e,r,u,n,l+"(getter)")}var f=r.__setters__;for(var c in f){var d=f[c];this._dumpPushInfo(t,e,r,d,n,c+"(setter)")}}}return t},_dumpPushInfo:function(e,t,n,r,i,o){var a="\n";void 0===r.__cost&&(r.__cost=0,r.__maxCost=0,r.__callCount=0),a+="Cost:"+r.__cost.toFixed(2)+"ms | ",a+="Max Cost:"+r.__maxCost.toFixed(2)+"ms | ",a+="Call Count:"+r.__callCount+" | ",a+="Inst Count:"+n.__instCount+" | ",a+="@",a+=t.ns+"."+i+":"+o,e[e.length]={cost:r.__cost,maxCost:r.__maxCost,callCount:r.__callCount,instCount:n.__instCount,info:a}}};(function(){var h="_$_super";h=b8e.getNormP(h);var p=new RegExp("\\b"+h.replace("$","\\$")+"\\b"),u="_$ctor";u=b8e.getNormP(u);function f(e,t,n){var s=e.prototype,r=t.prototype,i={};for(var o in n){var u=b8e.getNormDP(o);u!==o&&(i[u]=o);var f=n[o],c=!1,d=null;(void 0===f?"undefined":J(f))===b8e.TypeFunction?(c=J(s[u])===b8e.TypeFunction,d=p.test(f),c&&d?v.value=(b?function(i,o){function a(){var e=this[h];this[h]=s[i];var t=b8e.getTimer(),n=o.apply(this,arguments),r=b8e.getTimer()-t;return a.__cost=r,(void 0===a.__maxCost||a.__maxCost<r)&&(a.__maxCost=r),void 0===a.__callCount&&(a.__callCount=0),a.__callCount++,this[h]=e,n}return b8e.SHC(a),a}:function(n,r){function e(){var e=this[h];this[h]=s[n];var t=r.apply(this,arguments);return this[h]=e,t}return b8e.SHC(e),e})(o,f):b?v.value=function(r){function i(){var e=b8e.getTimer(),t=r.apply(this,arguments),n=b8e.getTimer()-e;return i.__cost=n,(void 0===i.__maxCost||i.__maxCost<n)&&(i.__maxCost=n),void 0===i.__callCount&&(i.__callCount=0),i.__callCount++,t}return b8e.SHC(i),i}(f):(b8e.SHC(f),v.value=f),b8e.funcCount++,Object.defineProperty(r,u,v)):null!=f&&(void 0===f?"undefined":J(f))===b8e.TypeObject?function(){var o=f.get,a=f.set;if((void 0===o?"undefined":J(o))!==b8e.TypeFunction&&(o=null),(void 0===a?"undefined":J(a))!==b8e.TypeFunction&&(a=null),o){t.__getters__||(g.value={},Object.defineProperty(t,"__getters__",g));var s=e.__getters__?e.__getters__[u]:null;c=s&&(void 0===s?"undefined":J(s))===b8e.TypeFunction,d=p.test(o),c&&d?o=(b?function(i){return function(){var e=this[h];this[h]=s;var t=b8e.getTimer(),n=i.apply(this,arguments),r=b8e.getTimer()-t;return o.__cost=r,(void 0===o.__maxCost||r>o.__maxCost)&&(o.__maxCost=r),void 0===o.__callCount&&(o.__callCount=0),o.__callCount++,this[h]=e,n}}:function(n){return function(){var e=this[h];this[h]=s;var t=n.apply(this,arguments);return this[h]=e,t}})(o):b&&(o=function(r){return function(){var e=b8e.getTimer(),t=r.apply(this,arguments),n=b8e.getTimer()-e;return o.__cost=n,(void 0===o.__maxCost||n>o.__maxCost)&&(o.__maxCost=n),void 0===o.__callCount&&(o.__callCount=0),o.__callCount++,t}}(o)),t.__getters__[u]=o,b8e.JsUtil.defineGetAccessor(r,u,o,!1,!0)}if(a){t.__setters__||(g.value={},Object.defineProperty(t,"__setters__",g));var l=e.__setters__?e.__setters__[u]:null;c=l&&(void 0===l?"undefined":J(l))===b8e.TypeFunction,d=p.test(a),c&&d?a=(b?function(i){return function(){var e=this[h];this[h]=l;var t=b8e.getTimer(),n=i.apply(this,arguments),r=b8e.getTimer()-t;return a.__cost=r,(void 0===a.__maxCost||r>a.__maxCost)&&(a.__maxCost=r),void 0===a.__callCount&&(a.__callCount=0),a.__callCount++,this[h]=e,n}}:function(n){return function(){var e=this[h];this[h]=l;var t=n.apply(this,arguments);return this[h]=e,t}})(a):b&&(a=function(r){return function(){var e=b8e.getTimer(),t=r.apply(this,arguments),n=b8e.getTimer()-e;return a.__cost=n,(void 0===a.__maxCost||n>a.__maxCost)&&(a.__maxCost=n),void 0===a.__callCount&&(a.__callCount=0),a.__callCount++,t}}(a)),t.__setters__[u]=a,b8e.JsUtil.defineSetAccessor(r,u,a,!1,!0)}o||a||b8e.error(2001,u)}():(v.value=f,Object.defineProperty(r,u,v))}v.value=null,g.value=null,b8e.mixinDP(r,i)}var c="constructor",v={writable:!0,enumerable:!0,configurable:!0},g={writable:!1,enumerable:!1,configurable:!1},b=b8e.macro.BENCHMARK;b8e.Class=function(){},b8e.Class.e=b8e.Class.extends=function(e){function s(){b8e.SHC(this),b8e.instCount++,b8e.macro.BENCHMARK&&(void 0===s.__instCount&&(s.__instCount=0),s.__instCount++),s.poolCall||s.__freeCountDisabled||(void 0===s.__freeInstCount&&(s.__freeInstCount=0),128<++s.__freeInstCount&&(s.__freeCountDisabled=!0,b8e.warn(3114,s.__name))),s.__disconstruct__||this.ctor.apply(this,arguments)}var l=this,t=l.prototype,a=Object.create(t);return b8e.SHC(s),b8e.clsCount++,s.__name="SClass"+b8e.clsCount,s.__clsHash=b8e.getClsHash(),s.forProps=function(e,t){var n=s.__getters__,r=s.__setters__;for(var i in a)if(i!==u&&i!==c&&0!==i.indexOf("__")&&!(n&&n[i]||r&&r[i])){var o=a[i];e.call(t,i,o)}},v.value=b8e.getHashCode(),Object.defineProperty(a,"__pid",v),s.prototype=a,v.value=s,Object.defineProperty(a,"constructor",v),f(l,s,e),s.e=s.extends=b8e.Class.extends,s.implements=function(e){if((void 0===e?"undefined":J(e))===b8e.TypeFunction){var t=e;e={};var n=t.__getters__,r=t.__setters__,i=t.prototype;for(var o in i)if(o!==u&&o!==c&&0!==o.indexOf("__")&&!(n&&n[o]||r&&r[o])){var a=i[o];e[o]=a}}f(l,s,e)},s}})()})(),function(){var e=void 0;(e=b8e.Class.extends({__Object:!0,ctor:function(){},getClass:function(){return this.constructor},getClassName:function(){return this.getClass().__name},serialization:function(){},deserailization:function(){},destroy:function(){}})).create=function(){return new e},b8e.RC("$$b8e","$$Object",e)}();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};b8e.Enum=function(e){if("__enums__"in e)return e;b8e.JsUtil.defineValue(e,"_$__enums__",null),e.__Enum=!0;for(var t={},n=-1,r=Object.keys(e),i=r.length,o=0;o<i;o++){var a=r[o],s=e[a];(void 0===s?"undefined":J(s))===b8e.TypeNumber&&(-1===s?(s=++n,e[a]=s):n=s);var l=b8e.getNormDP(a);l!==a&&(t[l]=a)}for(var u in t){var f=t[u],c=e[f];delete e[f],e[u]=c}return b8e.mixinDP(e,t),e},b8e.Enum.isEnum=function(e){return e&&e.hasOwnProperty("__enums__")},b8e.Enum.getList=function(e){if(e.__enums__)return e.__enums__;var t=e.__enums__=[];for(var n in e){var r=e[n];Number.isInteger(r)&&(t[t.length]={name:n,value:r})}return t.sort(function(e,t){return e.value-t.value}),t};J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,u=e=b8e.Object.extends({ctor:function(e,t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=0);var o=this;if(o._super(),o._getOverflow=!1,(void 0===t?"undefined":J(t))===b8e.TypeNumber){if(t<n)b8e.error(2004);else if((!b8e.macro.IS_DEBUG||o.assert(e))&&((o._ctor=e).__disconstruct__=!0,o.preCreateSize=n,o.count=0,o._instCount=0,u.CONFINED_SIZE?o._size=t:o._size=0,o._cleanupFunc=r,o._cleanupThis=i,0<n))if(u.isInited)for(var a=0;a<n;a++){var s=o.get();o.put(s)}else{var l=u.preCreates;l[l.length]=o}}else b8e.error(2003)},pool:{get:function(){return this._pool||(this._pool=b8e.LinkedList.get()),this._pool}},get:function(){var e=this;if(0<e.count){--e.count;var t=e.pool.pop();return t.poolHash++,t.restore.apply(t,arguments),t._invalid=!1,t._isRecycled=!1,t}if(e._ctor){e._instCount++,e._ctor.poolCall=!0;var n=new e._ctor;return(n.ctor.apply(n,arguments),n.__PoolObject)?(e._ctor.poolCall=!1,n.poolHash=1,n._invalid=!1,n._isDisposed=!1,n._isRecycled=!1,!(n.__pool=e)._getOverflow&&0<e._size&&e._instCount>e._size&&(e._getOverflow=!0,b8e.warn(3115,e._ctor.__name,e._size)),n):(b8e.error("\u83b7\u53d6"+n.constructor.__name+"\u4e0d\u662fPoolObject\u7c7b\u578b\uff01"),null)}return null},put:function(e){e.__PoolObject?e._invalid?b8e.warn(1092,e.constructor.__name):e._isRecycled?b8e.warn(1091,e.constructor.__name):e._isDisposed?b8e.warn(1090,e.constructor.__name):(e.invalidate(),e._invalid=!0,e.lazyPoolDisabled?this._doPut(e):u.getLazyPut().add(e)):b8e.error("\u56de\u6536"+e.constructor.__name+"\u4e0d\u662fPoolObject\u7c7b\u578b\uff01")},_doPut:function(e){var t=this;if(e.__proto__===t._ctor.prototype){if(!b8e.macro.IS_DEBUG||t.assert(e.constructor)){if(t._size<1||t.count<t._size){if(e._isDisposed)return void b8e.error(2006);if(e._isRecycled)return void b8e.error(2007);if(t._cleanupFunc&&!1===t._cleanupFunc.call(t._cleanupThis,e))return;return e.recycle(),e._isRecycled=!0,t.pool.append(e),void++t.count}e.constructor.poolCall=!0,e.destroy(),e._invalid=!0,e._isRecycled=!1,e._isDisposed=!0,e.__pool=void 0,e.poolHash=0,e.constructor.poolCall=!1,t._putOverflow||(t._putOverflow=!0,b8e.warn(3116,t._ctor.__name,t._size))}}else b8e.error(2005)},assert:function(e){if(!e)return b8e.error(2008),!1;var t=e.prototype;return J(t.restore)!==b8e.TypeFunction?(b8e.error(2009),!1):J(t.recycle)!==b8e.TypeFunction?(b8e.error(2010),!1):J(t.dispose)!==b8e.TypeFunction?(b8e.error(2011),!1):J(t.destroy)!==b8e.TypeFunction?(b8e.error(2012),!1):J(t.release)!==b8e.TypeFunction?(b8e.error(2013),!1):J(t._isDisposed)===b8e.TypeUndefined?(b8e.error(2014),!1):J(t._isRecycled)!==b8e.TypeUndefined||(b8e.error(2015),!1)},resize:function(e){if(u.CONFINED_SIZE){var t=this;if(0<(t._size=e)&&t.count>e){for(var n=t.count-1;e-1<n;){var r=t.pool.pop();r.constructor.poolCall=!0,r.destroy(),r._invalid=!0,r._isRecycled=!1,r._isDisposed=!0,r.__pool=void 0,r.poolHash=0,r.constructor.poolCall=!1,n--}t.count=e,t._instCount=e}}}});u.poolCall=!0,u.CONFINED_SIZE=!1,u.preCreates=[],u.isInited=!1,u.init=function(){u.preCreates.forEach(function(e){for(var t=e.preCreateSize-e.count,n=[],r=void 0,i=0;i<t;i++)r=e.get(),n[n.length]=r;for(var o=n.length,a=0;a<o;a++)r=n[a],e.put(r);n.length=0,n=null},u),u.preCreates.length=0,u.isInited=!0};var t=null;u.BATCH_PUT=1,u.getLazyPut=function(){return t=t||new b8e.CallLater(function(e){return e.__pool._doPut(e),!1},u,u.BATCH_PUT)},u.getLazyCount=function(){return t?t.count():0},b8e.RC("$$b8e","$$Pool",e)})(),function(){var e;e=b8e.Object.extends({lazyPoolDisabled:!1,_isRecycled:!1,_isDisposed:!1,__PoolObject:!0,_invalidateCallbackVec:null,_releaseCallbackVec:null,ctor:function(){var e=this;e.constructor.put&&(e.constructor.poolCall||b8e.warn(3101,e.constructor.__name)),e._super(),e.wakeUp(),e._isRecycled=!1,e._isDisposed=!1},addReleaseCallback:function(e,t,n){var r=this._releaseCallbackVec;r=r||(this._releaseCallbackVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(r,e,t,n)},removeReleaseCallback:function(e,t){var n=this._releaseCallbackVec;n&&0<n.count()&&b8e.CallBackUtil.removeCallBackData(n,e,t)},addInvalidateCallback:function(e,t,n){var r=this._invalidateCallbackVec;r=r||(this._invalidateCallbackVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(r,e,t,n)},removeInvalidateCallback:function(e,t){var n=this._invalidateCallbackVec;n&&0<n.count()&&b8e.CallBackUtil.removeCallBackData(n,e,t)},poolHashUsable:function(e){if(this.poolHash)return this.poolHash===e;b8e.error(2046)},wakeUp:function(){this._invalid=!1},invalidate:function(){var e=this._invalidateCallbackVec;e&&(0<e.count()&&b8e.CallBackUtil.exceteCallBackData(this,e),b8e.CallBackUtil.removeAllCallBackData(e),e.release(),this._invalidateCallbackVec=e=null),this._invalid=!0},restore:function(){this.wakeUp(),this._isRecycled=!1},recycle:function(){var e=this._releaseCallbackVec;e&&(0<e.count()&&b8e.CallBackUtil.exceteCallBackData(this,e),b8e.CallBackUtil.removeAllCallBackData(e),e.release(),this._releaseCallbackVec=e=null),this._isRecycled=!0},dispose:function(){this._isDisposed=!0},usable:{get:function(){return!this._invalid&&!this._isRecycled&&!this._isDisposed}},isInvalid:{get:function(){return this._invalid}},isRecycled:{get:function(){return this._isRecycled}},isDisposed:{get:function(){return this._isDisposed}},release:function(){var e=this;e.constructor.put?e.constructor.put(e):(b8e.warn(3100,e.constructor.__name),e.destroy())},destroy:function(){var e=this;e.constructor.put&&(e.constructor.poolCall||b8e.warn(3102,e.constructor.__name)),e.invalidate(),e.recycle(),e.dispose(),e._super()}});b8e.RC("$$b8e","$$PoolObject",e)}(),function(){var e;e=b8e.Object.extends({ctor:function(e){void 0===e&&(e=0);var t=this;t._super(),t._recycleList=b8e.LinkedList.get(),t._recycleList.safetyTraversal=!1,t._recycleMap=b8e.HashMap.get(),0<e?b8e.Timer.add(t,t.onTimer,1e3,0,-2e3,null,2):e=0,t._recycleDelay=e},onTimer:function(){this._recycleList.forEach(this._onRecycle,this)},count:function(){return this._recycleList.count()},_onRecycle:function(e){var t=this,n=t._isPurge,r=t._isGc,i=b8e.timeStamp;if(r||i>=e.recycleTime||n&&i>=e.purgeTime){var o=!(e.recycleTime=0);t._destroyObjCallback&&void 0===(o=t._destroyObjCallback.call(t._destroyObjThisArg,e.key))&&(o=!0),o&&(t._recycleList.remove(e),t._recycleMap.del(e.key),e.release())}},restore:function(e){var t=this,n=t._recycleMap.get(e);n?(t._recycleList.remove(n),t._recycleMap.del(e),n.release(),t._restoreObjCallback&&t._restoreObjCallback.call(t._restoreObjThisArg,e)):b8e.warn(2103)},remove:function(e){var t=this._recycleMap.get(e);t?(this._recycleList.remove(t),this._recycleMap.del(e),t.release()):b8e.warn(2104)},recycle:function(e,t){void 0===t&&(t=0);var n=this;if(n._recycleMap.get(e))b8e.warn(2018);else{(n._isGc||n._isPurge&&t<=0)&&(t=-1);var r=null,i=0,o=0,a=0,s=0;if(0<t?(i=o=t,!1):t<0||(i=0,o=n._recycleDelay,!1)){var l=!0;n._destroyObjCallback&&void 0===(l=n._destroyObjCallback.call(n._destroyObjThisArg,e))&&(l=!0),l||(r=f.get(),s=a=0)}else{r=f.get();var u=b8e.timeStamp;a=i+u,s=o+u}r&&(r.key=e,r.purgeTime=a,r.recycleTime=s,n._recycleList.append(r),n._recycleMap.set(e,r))}},purge:function(e){var t=this;t._isPurge||(t._isPurge=!0,t._isGc=!!e,t._recycleList.forEach(t._onRecycle,t),t._isPurge=!1,t._isGc=!1)},onRestoreObject:function(e,t){this._restoreObjCallback=e,this._restoreObjThisArg=t},onDestroyObject:function(e,t){this._destroyObjCallback=e,this._destroyObjThisArg=t},dumpInfo:function(){var t=b8e.timeStamp,n="";return this._recycleList.forEach(function(e){n+=e.key+"->recycle:"+(0<e.recycleTime-t?0:1)+"\uff0cpurge\uff1a"+(0<e.purgeTime-t?0:1)+"\n"},this),n}});var f=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.key=null,this.purgeTime=0,this.recycleTime=0}}),t=new b8e.Pool(f,128);f.get=function(){return t.get()},f.put=function(e){return t.put(e)},b8e.RC("$$b8e","$$RecycleBin",e)}(),function(){var e,t,u=b8e.JsUtil.mergeHash,i=t=b8e.PoolObject.extends({ctor:function(){var e=this;e._super(),e._count=0,e._map=b8e.createMap(),e._list=b8e.LinkedList.get(),e._getOverflow=!1,e.localHashable=!1,e.polyfillHash=!1,e.safetyTraversal=!0,e.clear()},resetTraversal:function(){this._list.resetTraversal()},isTraversal:{get:function(){return this._list.isTraversal}},_queueSet:function(e,t,n){this.set(e,t,n)},set:function(e,t,n){if(null!=e){var r=this;if(b8e.applyType(e)){var i=e;e=u(n,i,r.localHashable?r:void 0,r.polyfillHash);var o=r._map,a=o[e];a||(r._count++,o[e]=a=f.get(),r._list.append(a),a.key=e,a.keyObj=i),a.isMapping=!0,a.data===t&&a.thisArg===n||(a.data=t,a.thisArg=n,r._setDirty())}else{var s=r._map,l=s[e];l||(r._count++,l=s[e]=f.get(),r._list.append(l),l.key=e,l.keyObj=e),l.isMapping=!0,l.data!==t&&(l.data=t,r._setDirty())}}else b8e.error(3077,e)},_queueDel:function(e,t,n){this.del(e,n)},del:function(e,t){if(null!=e){var n=this,r=n._map;if(b8e.applyType(e)){var i=r[e=u(t,e,n.localHashable?n:void 0,n.polyfillHash)];i&&(n._list.remove(i),i.isMapping=!1,i.release(),delete r[e],n._count--,n._setDirty())}else{var o=r[e];o&&(n._list.remove(o),o.isMapping=!1,o.release(),delete r[e],n._count--,n._setDirty())}}else b8e.error(3080,e)},get:function(e,t){if(null!=e){var n=this,r=void 0;if(b8e.applyType(e))r=(r=n._map[e=u(t,e,n.localHashable?n:void 0,n.polyfillHash)])&&r.data;else r=(r=n._map[e])&&r.data;return r}b8e.error(3083,e)},has:function(e,t){if(null==e)return b8e.error(3086,e),!1;var n=this;return b8e.applyType(e)?!!n._map[e=u(t,e,n.localHashable?n:void 0,n.polyfillHash)]:!!n._map[e]},count:function(){return this._count},forEach:function(e,t,n){var r=this;r.safetyTraversal&&!r._getOverflow&&r._count>i.MAX_COUNT&&(r._getOverflow=!0,b8e.warn(3374)),r.isTraversal?b8e.error(3382):r._list.forEach(r._doForEach,r,{thisArg:t,callback:e,params:n})},_doForEach:function(e,t){e.isMapping&&t.callback.call(t.thisArg,e.keyObj,e.data,e.thisArg,t.params)},every:function(e,t,n){var r=this;r.safetyTraversal&&!r._getOverflow&&r._count>i.MAX_COUNT&&(r._getOverflow=!0,b8e.warn(3375)),r.isTraversal?b8e.error(3383):r._list.every(r._doEvery,r,{thisArg:t,callback:e,params:n})},_doEvery:function(e,t){return!(e.isMapping&&!t.callback.call(t.thisArg,e.keyObj,e.data,e.thisArg,t.params))},elements:function(){var e=this,t=e._elements;return t||(t=e._elements=[],e._list.forEach(e._onElement,e),t)},_onElement:function(e){var t=this._elements;t[t.length]=e},keys:function(){var e=this,t=e._keys;return t||(t=e._keys=[],e._list.forEach(e._onKey,e),t)},_onKey:function(e){var t=this._keys;t[t.length]=e.keyObj},values:function(){var e=this,t=e._values;return t||(t=e._values=[],e._list.forEach(e._onValue,e),t)},_onValue:function(e){var t=this._values;t[t.length]=e.data},_onClear:function(e){delete this._map[e.key],e.release()},clear:function(){var e=this;e.isTraversal?b8e.error(3370):(e._list.clear(e._onClear,e),e._setDirty(),e._count=0)},_setDirty:function(){this._elements=null,this._keys=null,this._values=null},restore:function(){this._super()},recycle:function(){var e=this;e.clear(),e.localHashable=!1,e.polyfillHash=!1,e.safetyTraversal=!0,e._getOverflow=!1,e._super()},dispose:function(){this._map=null,this._list.release(),this._list=null,this._super()},dump:function(){var e=void 0,t=void 0,n=this._map;for(e in n)t=n[e],b8e.log("key:",t.key,"---\x3e data:",t.data)}});i.MAX_COUNT=200;var n=new b8e.Pool(i,0);i.get=function(){return n.get()},i.put=function(e){return n.put(e)};var f=e=b8e.Object.extends({__MapRef:!0,isMapping:!1,key:null,keyObj:null,data:null,thisArg:null,option:null,usable:!1,release:function(){f.put(this)},recycle:function(){var e=this;e.isMapping=!1,e.key=null,e.keyObj=null,e.data=null,e.thisArg=null,e.option=null,e.usable=!1}}),r=[];f.get=function(){var e=void 0;return(e=0<r.length?r.pop():new f).usable=!0,e},f.put=function(e){if(e.usable)return e.recycle(),r[r.length]=e},f.poolCall=!0,b8e.RC("$$b8e","$$HashMap",t),b8e.RC("$$b8e","$$MapRef",e)}(),function(){var e,t,n,a=n=b8e.PoolObject.extends({__LinkedList:!0,_traversalQueue:null,ctor:function(){var e=this;e._super(),e._head=null,e._tail=null,e._map=b8e.createMap(),e._refMap={},e._count=0,e._byIdx=[],e._idxDirty=!1,e._traversalQueue=[],e._isFTraversal=!1,e._isETraversal=!1,e._getOverflow=!1,e.safetyTraversal=!0},resetTraversal:function(){this._isFTraversal=!1,this._isETraversal=!1,this._processTraversalQueue()},isTraversal:{get:function(){return this._isFTraversal||this._isETraversal}},head:function(){var e=this._head;return e?e.element:null},tail:function(){var e=this._tail;return e?e.element:null},pop:function(){var e=this._tail;if(!e)return null;var t=e.element;return this.remove(t),t},shift:function(){var e=this._head;if(!e)return null;var t=e.element;return this.remove(t),t},getPrev:function(e){var t=e.hashCode;if(t){var n=this._map[t],r=n&&n.isLinked?n.prev:null;return r&&r.isLinked?r.element:null}b8e.error("no has hashCode!")},getNext:function(e){var t=e.hashCode;if(t){var n=this._map[t],r=n&&n.isLinked?n.next:null;return r&&r.isLinked?r.element:null}b8e.error("no has hashCode!")},get:function(e){var t=this;if(t._idxDirty){for(var n=t._byIdx.length=0,r=t._head;r;)r=(t._byIdx[n]=r).next,n++;t._idxDirty=!1}if(t._byIdx){var i=t._byIdx[e];if(i)return i.element}return null},_link:function(e,t){var n=this,r=e.hashCode;if(r)if(!t||t.hashCode){void 0===t&&(t=null);var i=n._map[r];if(i&&(i.isLinked||(n._count++,i.isLinked=!0)),n.isTraversal){i||n._refMap[r]||(n._refMap[r]=!0,n._count++);var o=n._traversalQueue,a=o[o.length]=h.get();return a.option=n._link,a.element=e,void(a.current=t)}if(!i){(i=d.get()).element=e,i.isLinked=!0,n._map[r]=i,n._count++,n._setDirty();var s=t?n._map[t.hashCode]:null;if(s){if(i===s)return;var l=i.next;if(l&&l===s)return;var u=i.prev;u?u.next=l:s===n._head&&(n._head=l||s),l?l.prev=u:s===n._tail&&(n._tail=u||s),u=s.prev,(i.prev=u)&&(u.next=i),(i.next=s).prev=i,s===n._head&&(n._head=i),n._idxDirty=!0}else{if(i===n._tail)return;var f=i.prev,c=i.next;f?f.next=c:i===n._head&&(n._head=c||i),c?c.prev=f:i===n._tail&&(n._tail=f||i),i.next=null,i.prev=n._tail,n._tail?n._tail.next=i:n._head=i,n._tail=i,n._idxDirty=!0}}}else b8e.error("no has hashCode!");else b8e.error("no has hashCode!")},insert:function(e,t){if(e){void 0===t&&(t=null);this._link(e,t)}else b8e.error("\u53c2\u6570\u9519\u8bef\uff01")},append:function(e){if(e){this._link(e)}else b8e.error("\u53c2\u6570\u9519\u8bef\uff01")},remove:function(e){var t=this;if(e){var n=e.hashCode;if(n){var r=t._map[n];if(r&&r.isLinked&&(t._count--,r.isLinked=!1),t.isTraversal){r||t._refMap[n]&&(t._refMap[n]=!1,t._count--);var i=t._traversalQueue,o=i[i.length]=h.get();return o.option=t.remove,void(o.element=e)}if(r){delete t._map[n],t._setDirty();var a=r.prev,s=r.next;a&&(a.next=s),s&&(s.prev=a),r===t._head&&(t._head=s),r===t._tail&&(t._tail=a),r.release(),r=null,t._idxDirty=!0}}else b8e.error("no has hashCode!")}else b8e.error("\u53c2\u6570\u9519\u8bef\uff01")},has:function(e){if(!e)return b8e.error("\u53c2\u6570\u9519\u8bef\uff01"),!1;var t=e.hashCode;if(!t)return b8e.error("no has hashCode!"),!1;var n=this._map[t];return!(!n||!n.isLinked)},count:function(){return this._count},forEach:function(e,t,n){var r=this;if(r.safetyTraversal&&!r._getOverflow&&r._count>a.MAX_COUNT&&(r._getOverflow=!0,b8e.warn(3376)),r.isTraversal)b8e.error(3384);else{r._isFTraversal=!0;for(var i=r._head,o=null;i&&(o=i.next,i.isLinked&&e.call(t,i.element,n),r._isFTraversal);)i=o;r._isFTraversal=!1,r._processTraversalQueue()}},every:function(e,t,n){var r=this;if(r.safetyTraversal&&!r._getOverflow&&r._count>a.MAX_COUNT&&(r._getOverflow=!0,b8e.warn(3377)),r.isTraversal)b8e.error(3385);else{r._isETraversal=!0;for(var i=r._head,o=null;i&&(o=i.next,!i.isLinked||e.call(t,i.element,n))&&r._isETraversal;)i=o;r._isETraversal=!1,r._processTraversalQueue()}},_processTraversalQueue:function(){var e=this._traversalQueue,t=e.length;if(!(t<1)){for(var n=0;n<t;n++){var r=e[n];r.option.call(this,r.element,r.current),r.release()}e.length=0,this._refMap={}}},values:function(){var e=this._values;if(e)return e;e=this._values=[];var t=void 0,n=this._map;for(t in n){var r=n[t];r.isLinked&&(e[e.length]=r.element)}return e},clear:function(e,t){var n=this;if(n.isTraversal)b8e.error(3360);else{for(var r=n._head,i=null;r;){i=r.next;var o=r.element;e&&e.call(t,o);var a=o.hashCode;delete n._map[a],r.release(),r=i}n._refMap={},n._head=null,n._tail=null,n._count=0,n._setDirty(),n._idxDirty=!1,n._byIdx.length=0;for(var s=n._traversalQueue,l=s.length,u=0;u<l;u++){s[u].release()}s.length=0,n._isFTraversal=!1,n._isETraversal=!1}},_setDirty:function(){this._values=null},restore:function(){this._super()},recycle:function(){this.clear(),this.safetyTraversal=!0,this._getOverflow=!1,this._super()},dispose:function(){var e=this;e._map&&(e._map.release(),e._map=null),e._refMap=null,e._traversalQueue=null,e._super()}});a.MAX_COUNT=200;var r=new b8e.Pool(a,0);a.get=function(){return r.get()},a.put=function(e){return r.put(e)};var d=t=b8e.Object.extends({prev:null,next:null,element:null,usable:!1,release:function(){d.put(this)},recycle:function(){this.prev=null,this.next=null,this.element=null,this.usable=!1}}),i=[];d.get=function(){var e=void 0;return(e=0<i.length?i.pop():new d).usable=!0,e},d.put=function(e){if(e.usable)return e.recycle(),i[i.length]=e},d.poolCall=!0;var h=e=b8e.Object.extends({__MapRef:!0,isLinked:!1,element:null,current:null,option:null,usable:!1,release:function(){h.put(this)},recycle:function(){var e=this;e.isLinked=!1,e.element=null,e.current=null,e.option=null,e.usable=!1}}),o=[];h.get=function(){var e=void 0;return(e=0<o.length?o.pop():new h).usable=!0,e},h.put=function(e){if(e.usable)return e.recycle(),o[o.length]=e},h.poolCall=!0,b8e.RC("$$b8e","$$LinkedList",n),b8e.RC("$$b8e","$$LinkedNode",t),b8e.RC("$$b8e","$$LinkedpRef",e)}();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;function l(e){return Boolean(e&&void 0!==e.length)}function r(){}function i(e,t){return function(){e.apply(t,arguments)}}function o(e,t){e(function(e){t.resolve(e)},function(e){t.reject(e)})}var a=e=b8e.Object.extends({done:!1,ctor:function(e){if(this._super(),!(this instanceof a))throw new TypeError("Promises must be constructed via new");if(this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],e){if("function"!=typeof e)throw new TypeError("not a function");o(e,this)}},catch:function(e){return this.then(null,e)},then:function(e,t){var n=new a(r);return s(this,new d(e,t,n)),n},finally:function(t){return this.then(function(e){return a.resolve(t()).then(function(){return e})},function(e){return a.resolve(t()).then(function(){return a.reject(e)})})},resolve:function(e){this.done||(this.done=!0,u(this,e))},reject:function(e){t.done||(t.done=!0,f(t,e))}});function s(e,t){for(;3===e._state;)e=e._value;if(0!==e._state){e._handled=!0;var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r)n=r(e._value),u(t.promise,n);else(1===e._state?u:f)(t.promise,e._value)}else e._deferreds.push(t)}function u(e,t){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===(void 0===t?"undefined":J(t))||"function"==typeof t)){var n=t.then;if(t instanceof a)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void o(i(n,t),e)}e._state=1,e._value=t,c(e)}function f(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&(e._handled||a._unhandledRejectionFn(e._value));for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function d(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}a.all=function(t){return new a(function(r,i){if(!l(t))return i(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(t);if(0===o.length)return r([]);var a=o.length;function s(t,e){if(e&&("object"===(void 0===e?"undefined":J(e))||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){s(t,e)},i)}o[t]=e,0==--a&&r(o)}for(var e=0;e<o.length;e++)s(e,o[e])})},a.resolve=function(t){return t&&"object"===(void 0===t?"undefined":J(t))&&t.constructor===a?t:new a(function(e){e(t)})},a.reject=function(n){return new a(function(e,t){t(n)})},a.race=function(i){return new a(function(e,t){if(!l(i))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=i.length;n<r;n++)a.resolve(i[n]).then(e,t)})},a._unhandledRejectionFn=function(e){b8e.warn("Possible Unhandled Promise Rejection:",e)},b8e.RC("$$b8e","$$Promise",e)})(),function(){var e,t,n=t=b8e.Object.extends({_tickerList:null,_tickerMap:null,isPaused:!1,_isActivated:!1,ctor:function(){var e=this;e._super(),b8e.loop?b8e.error(2002):(e._tickerList=b8e.LinkedList.get(),e._tickerMap=b8e.HashMap.get(),e._lastTime=b8e.getTimer(),e._isActivated=!0,e.now=b8e.getNow(),n.startLoop(e))},addTick:function(e,t){var n=this._tickerMap.get(e,t);n||((n=r.get()).callBack=e,n.thisArg=t,this._tickerMap.set(e,n,t),this._tickerList.append(n))},removeTick:function(e,t){var n=this._tickerMap.get(e,t);n&&(this._tickerMap.del(e,t),this._tickerList.remove(n),n.release())},pause:function(){this.isPaused=!0},resume:function(){this.isPaused=!1},activate:function(){this._isActivated||(this._isActivated=!0,this._lastTime=b8e.getTimer(),this.now=b8e.getNow())},deactivate:function(){this._isActivated&&(this._isActivated=!1)},isActivated:{get:function(){return this._isActivated}},update:function(e){var t=this;t.now=e,t.callLaters();for(var n=b8e.lifecycle.contexts,r=n.length-1;0<=r;r--){var i=n[r];i.onUpdate&&i.onUpdate()}if(!t.isPaused){t.callLaterAsyncs();var o=t._tickerList;o.resetTraversal();var a=b8e.getTimer();t._dt=a-t._lastTime,t._lastTime=a,o.forEach(t._onUpdate,t)}},_onUpdate:function(e){e.callBack.call(e.thisArg,this._dt)},callLaters:function(){for(var e=b8e._callLaterList;0<e.length;){var t=e.pop();t&&t.callBack&&t.callBack.apply(t.thisArg,t.args)}},callLaterAsyncs:function(){for(var e=b8e._callAsyncList;0<e.length;){var t=e.pop();t&&t.callBack&&t.callBack.apply(t.thisArg,t.args)}}});n.startLoop=function(n){b8e.getTimer(),b8e.frameTime=b8e.timeStamp,window.requestAnimFrame(function e(t){t=t||b8e.getNow();window.requestAnimFrame(e);b8e.getTimer();b8e.frameTime=b8e.timeStamp;n.update(t)})};var r=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.callBack=null,this.thisArg=null,this.priority=0}}),i=new b8e.Pool(r,128);r.get=function(){return i.get()},r.put=function(e){return i.put(e)},b8e.LifecyclePlugin=function(e){};var o=b8e.lifecycle={};o.stage=null,o.contexts=[],o.addLifecycleListener=function(e){var t=new a,n=o.contexts;e(n[n.length]=t)};var a=e=b8e.Object.extends({isActivate:!0,pause:function(){this.isActivate&&(this.isActivate=!1,o.stage.dispatchEvent(b8e.Event.create(b8e.Event,b8e.Event.DEACTIVATE)),this.onPause&&this.onPause())},resume:function(){this.isActivate||(this.isActivate=!0,o.stage.dispatchEvent(b8e.Event.create(b8e.Event,b8e.Event.ACTIVATE)),this.onResume&&this.onResume())},onUpdate:function(){}});b8e.RC("$$b8e","$$Loop",t),b8e.RC("$$b8e","$$LifecycleContext",e)}(),function(){var e,t=e=b8e.Object.extends({_playerList:null,invalidateRender:!1,requestRendering:!1,frameDeltaTime:0,lastCount:0,frameInterval:0,costEnterFrame:0,maxFrameRate:60,enterFrameCallBackList:null,renderCallBackList:null,ctor:function(){var e=this;e._super(),e._paused=!1,e._tickerList=b8e.LinkedList.get(),e._tickerMap=b8e.HashMap.get(),e._fpsAverage=1e3,e._playerList=[],e.enterFrameCallBackList=[],e.renderCallBackList=[],e._lastTime=b8e.getTimer(),e._deltaTime=0,e._maxCostFrame=0,e._costFrame=0,e._useCostFrame=!1,b8e.getLoop().addTick(this.update,this)},startTick:function(e,t,n){void 0===n&&(n=0);if(b8e.applyType(e),e.__TypeFunction){var r=this._tickerMap.get(e,t);r?b8e.warn(2021):((r=i.get()).callBack=e,r.thisArg=t,r.priority=n,this._tickerMap.set(e,r,t),this._tickerList.append(r))}else b8e.error(2020)},stopTick:function(e,t){if(b8e.applyType(e),e.__TypeFunction){var n=this._tickerMap.get(e,t);if(n)return this._tickerMap.del(e,t),this._tickerList.remove(n),void n.release();b8e.warn(3117)}else b8e.error(2022)},_priorityIn:function(e,t,n){for(var r=e.length,i=0;i<r;i++)if(n<e[i].priority)return e.splice(i,0,t),i;return e.unshift(t),0},_appendIn:function(e,t){e.unshift(t)},getFrameRate:function(){return this._frameRate},setFrameRate:function(e){var t=this;if(((e=+e||0)<=0||60<e)&&(e=60),t._frameRate==e)return!1;t._frameRate=e,t.frameDeltaTime=1e3/e,t.lastCount=t.frameInterval=Math.round(6e4/e),t._skipFrame=0<e&&e<1+(t.maxFrameRate>>1),t._fps=e,t._renderFps=e,t._fpsTotal=0,t._renderFpsTotal=0;var n=b8e.getTimer();return t._fpsTime=n,t._renderFpsTime=n,t.skip=!0},setMaxFrameRate:function(e){this.maxFrameRate=e},onUpdate:function(){b8e.onBeforeUpdate&&b8e.onBeforeUpdate();var e=this,t=e._tickerList;t.resetTraversal();var n=b8e.getTimer();e._deltaTime=n-e._lastTime,e._lastTime=n,t.forEach(e._updateLayer,e),b8e.macro.IS_DEBUG&&e._onFrame(),e.broadcastEnterFrame(),e._useCostFrame&&(e._costFrame=b8e.getTimer()-n,e._costFrame>e._maxCostFrame&&(e._maxCostFrame=e._costFrame)),b8e.onAfterUpdate&&b8e.onAfterUpdate()},update:function(e){var t=this;b8e.loop.isActivated&&(t._paused||(t._skipFrame?(t.skip=!t.skip,t.skip?t._updateRender():t.onUpdate()):(t.onUpdate(),t._updateRender()),t._isStep&&(t._stepTime+=e,t._stepTime>=t.frameDeltaTime&&(t.setPaused(!0),t._isStep=!1))))},_updateRender:function(){b8e.onBeforeRender&&b8e.onBeforeRender(),this.render(!0,0),b8e.onAfterRender&&b8e.onAfterRender()},_updateLayer:function(e){if(e.callBack){e.callBack.call(e.thisArg,this._deltaTime)&&(this.requestRendering=!0)}},setPaused:function(e){this._paused!=e&&(e||(this._isStep=!1),this._paused=e,this._lastTime=b8e.getTimer())},pause:function(){this.setPaused(!0)},resume:function(){this.setPaused(!1)},step:function(){this._paused&&(this.setPaused(!1),this._isStep=!0,this._stepTime=0)},setTimeScale:function(e){this._timeScale=e},getTimeScale:function(){return this._timeScale},getCount:function(){return this._tickerList.count()},_onRenderFrame:function(){var e=this,t=b8e.getTimer(),n=t-e._renderFpsTime;if(e._renderFpsTotal++,(e._fpsAverage||1e3)<n){var r=1e3*e._renderFpsTotal/n;e._renderFps=r,e._renderFpsTotal=0,e._renderFpsTime=t}},_onFrame:function(){var e=this,t=b8e.getTimer(),n=t-e._fpsTime;if(e._fpsTotal++,(e._fpsAverage||1e3)<n){var r=1e3*e._fpsTotal/n;e._fps=r,e._fpsTotal=0,e._fpsTime=t}},getFps:function(){return Math.round(100*this._fps)/100},getRenderFps:function(){return Math.round(100*this._renderFps)/100},getCostFrame:function(){return this._useCostFrame=!0,Math.round(100*this._costFrame)/100},getMaxCostFrame:function(){return this._useCostFrame=!0,Math.round(100*this._maxCostFrame)/100},debugReset:function(){this._maxCostFrame=0},addPlayer:function(e){if(!(-1<this._playerList.indexOf(e))){var t=this._playerList;t[t.length]=e}},removePlayer:function(e){var t=this._playerList.indexOf(e);-1<t&&this._playerList.splice(t,1)},render:function(e,t){var n=this,r=n._playerList,i=r.length;if(0!=i){n.invalidateRender&&(n.broadcastRender(),n.invalidateRender=!1);for(var o=i-1;0<=o;o--)r[o].render(e,t);n.requestRendering=!1,b8e.macro.IS_DEBUG&&n._onRenderFrame()}},broadcastEnterFrame:function(){var e=this.enterFrameCallBackList,t=e.length;if(0!=t)for(var n=t-1;0<=n;n--)e[n].dispatchEventWith(b8e.Event.ENTER_FRAME)},broadcastRender:function(){var e=this.renderCallBackList,t=e.length;if(0!=t)for(var n=t-1;0<=n;n--)e[n].dispatchEventWith(b8e.Event.RENDER)}});t.getTicker=function(){var e=b8e.ticker;return e=e||(b8e.ticker=new t)},t.add=function(e,t,n){b8e.ticker.startTick(t,e,n)},t.remove=function(e,t){b8e.ticker.stopTick(t,e)},t.getCount=function(){return b8e.ticker.getCount()},t.getRenderFps=function(){return b8e.ticker.getRenderFps()},t.getFps=function(){return b8e.ticker.getFps()},t.getFrameRate=function(){return b8e.ticker.getFrameRate()};var i=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.callBack=null,this.thisArg=null,this.priority=0}}),n=new b8e.Pool(i,128);i.get=function(){return n.get()},i.put=function(e){return n.put(e)},b8e.RC("$$b8e","$$Ticker",e)}(),function(){var u=void 0,f=u=b8e.Object.extends({ctor:function(e,t,n,r,i,o,a){void 0===n&&(n=0),void 0===a&&(a=0);var s=this;s._super(),void 0===t&&(t=0),s._currentCount=0,s._running=!1,s.updateInterval=1e3,s.lastCount=1e3,s.lastTime=0,s.delay=e,s.repeat=0|+t,s.priority=n,s.callBack=r,s.thisArg=i,s.args=o,s.level=a},delay:{get:function(){return this._delay},set:function(e){(e=+e||0)<1&&(e=1);var t=this;t._delay!=e&&(t._delay=e,t.lastCount=t.updateInterval=Math.round(60*t._delay))}},currentCount:{get:function(){return this._currentCount}},running:{get:function(){return this._running}},reset:function(){var e=this;e._running&&(e.lastCount=e.updateInterval,e.lastTime=e._delay,e._currentCount=0)},start:function(){var e=this;e._running||(e.lastCount=e.updateInterval,e.lastTime=e._delay,e._running=!0,e._currentCount=0,b8e.Ticker.getTicker().startTick(e.update,e,0,1),f._count++)},stop:function(){this._running&&(this._running=!1,b8e.Ticker.getTicker().stopTick(this.update,this),f._count--)},update:function(e){var t=this;if(t.lastTime-=e,t.lastTime<=0)t.lastCount=t.updateInterval;else{if(t.lastCount-=1e3,0<t.lastCount)return;t.lastCount+=t.updateInterval}t.lastTime=t._delay,t._currentCount++,t.callBack&&t.callBack.apply(t.thisArg,t.args),0<t.repeat&&t._currentCount>=t.repeat&&t.stop()},dispose:function(){var e=this;e.stop(),e.callBack=null,e.thisArg=null,e.args=null,e.level=0}});f.highMap=b8e.HashMap.get(),f.add=function(e,t,n,r,i,o,a){if(b8e.applyType(t),!t.__TypeFunction)return b8e.error(2023),null;void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0);var s=f.highMap,l=s.get(t,e);return l?b8e.warn(2024):((l=new u(n,r,i,t,e,o,a)).start(),s.set(t,l,e)),l},f.remove=function(e,t){if(b8e.applyType(t),!t.__TypeFunction)return b8e.error(2025),null;var n=f.highMap,r=n.get(t,e);return r?(r.stop(),r.dispose(),n.del(t,e)):b8e.warn(3118),r},f._count=0,f.getCount=function(){return f._count},b8e.RC("$$b8e","$$Timer",u)}(),function(){var e=b8e.Worker=function(){};e.create=function(e,t,n){var r=o.apply(null,arguments);return i[i.length]=r},e.runAll=function(t){var e=i.map(function(e){return e.run(t)});return Promise.all(e)},e.terminateAll=function(){i.forEach(function(e){e._shell.terminate()}),i.length=0},e.list=function(){return i};var i=[];function o(e,t,n){t=t||[];var r=['"use strict";'];for(var i in t){var o=t[i];r[r.length]="self."+i+"="+o.toString()+";"}n&&(r[r.length]=n.toString()),r=r.concat(["self.onmessage=",e.toString(),";"]);var a=new Blob(r,{type:"text/javascript"}),s=URL.createObjectURL(a);return{_shell:function(){var e=new Worker(s);return URL.revokeObjectURL(s),e}(),run:function(e){return l(this._shell,e)},terminate:function(){return u(this)},subscribe:function(e){this._shell.addEventListener("message",e,!1)},unsubscribe:function(e){this._shell.removeEventListener("message",e,!1)}}}function l(n,e){return(e=e||{})instanceof ArrayBuffer?n.postMessage(e,[e]):n.postMessage(e),new Promise(function(e,t){n.onmessage=e,n.onerror=t})}function u(e){return i.splice(i.indexOf(e),1),e._shell.terminate()}}();var e=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(function(){var s=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function l(e){return e<1e5?e<100?e<10?0:1:e<1e4?e<1e3?2:3:4:e<1e7?e<1e6?5:6:e<1e9?e<1e8?7:8:9}function u(e,t){if(e===t)return 0;if(~~e===e&&~~t===t){if(0===e||0===t)return e<t?-1:1;if(e<0||t<0){if(0<=t)return-1;if(0<=e)return 1;e=-e,t=-t}var n=l(e),r=l(t),i=0;return n<r?(e*=s[r-n-1],t/=10,i=-1):r<n&&(t*=s[n-r-1],e/=10,i=1),e===t?i:e<t?-1:1}var o=String(e),a=String(t);return o===a?0:o<a?-1:1}function f(e){for(var t=0;32<=e;)t|=1&e,e>>=1;return e+t}function c(e,t,n,r){var i=t+1;if(i===n)return 1;if(r(e[i++],e[t])<0){for(;i<n&&r(e[i],e[i-1])<0;)i++;o(e,t,i)}else for(;i<n&&0<=r(e[i],e[i-1]);)i++;return i-t}function o(e,t,n){for(n--;t<n;){var r=e[t];e[t++]=e[n],e[n--]=r}}function d(e,t,n,r,i){for(r===t&&r++;r<n;r++){for(var o=e[r],a=t,s=r;a<s;){var l=a+s>>>1;i(o,e[l])<0?s=l:a=1+l}var u=r-a;switch(u){case 3:e[a+3]=e[a+2];case 2:e[a+2]=e[a+1];case 1:e[a+1]=e[a];break;default:for(;0<u;)e[a+u]=e[a+u-1],u--}e[a]=o}}function b(e,t,n,r,i,o){var a=0,s=0,l=1;if(0<o(e,t[n+i])){for(s=r-i;l<s&&0<o(e,t[n+i+l]);)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s),a+=i,l+=i}else{for(s=i+1;l<s&&o(e,t[n+i-l])<=0;)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s);var u=a;a=i-l,l=i-u}for(a++;a<l;){var f=a+(l-a>>>1);0<o(e,t[n+f])?a=f+1:l=f}return l}function y(e,t,n,r,i,o){var a=0,s=0,l=1;if(o(e,t[n+i])<0){for(s=i+1;l<s&&o(e,t[n+i-l])<0;)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s);var u=a;a=i-l,l=i-u}else{for(s=r-i;l<s&&0<=o(e,t[n+i+l]);)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s),a+=i,l+=i}for(a++;a<l;){var f=a+(l-a>>>1);o(e,t[n+f])<0?l=f:a=f+1}return l}var h=function(){function n(e,t){r(this,n),this.array=e,this.compare=t,this.minGallop=7,this.length=e.length,this.tmpStorageLength=256,this.length<512&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength),this.stackSize=0}return e(n,[{key:"pushRun",value:function(e,t){this.runStart[this.stackSize]=e,this.runLength[this.stackSize]=t,this.stackSize+=1}},{key:"mergeRuns",value:function(){for(;1<this.stackSize;){var e=this.stackSize-2;if(1<=e&&this.runLength[e-1]<=this.runLength[e]+this.runLength[e+1]||2<=e&&this.runLength[e-2]<=this.runLength[e]+this.runLength[e-1])this.runLength[e-1]<this.runLength[e+1]&&e--;else if(this.runLength[e]>this.runLength[e+1])break;this.mergeAt(e)}}},{key:"forceMergeRuns",value:function(){for(;1<this.stackSize;){var e=this.stackSize-2;0<e&&this.runLength[e-1]<this.runLength[e+1]&&e--,this.mergeAt(e)}}},{key:"mergeAt",value:function(e){var t=this.compare,n=this.array,r=this.runStart[e],i=this.runLength[e],o=this.runStart[e+1],a=this.runLength[e+1];this.runLength[e]=i+a,e===this.stackSize-3&&(this.runStart[e+1]=this.runStart[e+2],this.runLength[e+1]=this.runLength[e+2]),this.stackSize--;var s=y(n[o],n,r,i,0,t);r+=s,0!==(i-=s)&&0!==(a=b(n[r+i-1],n,o,a,a-1,t))&&(i<=a?this.mergeLow(r,i,o,a):this.mergeHigh(r,i,o,a))}},{key:"mergeLow",value:function(e,t,n,r){var i=this.compare,o=this.array,a=this.tmp,s=0;for(s=0;s<t;s++)a[s]=o[e+s];var l=0,u=n,f=e;if(o[f++]=o[u++],0!=--r)if(1!==t){for(var c=this.minGallop;;){var d=0,h=0,p=!1;do{if(i(o[u],a[l])<0){if(o[f++]=o[u++],h++,(d=0)==--r){p=!0;break}}else if(o[f++]=a[l++],d++,h=0,1==--t){p=!0;break}}while((d|h)<c);if(p)break;do{if(0!==(d=y(o[u],a,l,t,0,i))){for(s=0;s<d;s++)o[f+s]=a[l+s];if(f+=d,l+=d,(t-=d)<=1){p=!0;break}}if(o[f++]=o[u++],0==--r){p=!0;break}if(0!==(h=b(a[l],o,u,r,0,i))){for(s=0;s<h;s++)o[f+s]=o[u+s];if(f+=h,u+=h,0===(r-=h)){p=!0;break}}if(o[f++]=a[l++],1==--t){p=!0;break}c--}while(7<=d||7<=h);if(p)break;c<0&&(c=0),c+=2}if((this.minGallop=c)<1&&(this.minGallop=1),1===t){for(s=0;s<r;s++)o[f+s]=o[u+s];o[f+r]=a[l]}else{if(0===t)throw new Error("mergeLow preconditions were not respected");for(s=0;s<t;s++)o[f+s]=a[l+s]}}else{for(s=0;s<r;s++)o[f+s]=o[u+s];o[f+r]=a[l]}else for(s=0;s<t;s++)o[f+s]=a[l+s]}},{key:"mergeHigh",value:function(e,t,n,r){var i=this.compare,o=this.array,a=this.tmp,s=0;for(s=0;s<r;s++)a[s]=o[n+s];var l=e+t-1,u=r-1,f=n+r-1,c=0,d=0;if(o[f--]=o[l--],0!=--t)if(1!==r){for(var h=this.minGallop;;){var p=0,v=0,g=!1;do{if(i(a[u],o[l])<0){if(o[f--]=o[l--],p++,(v=0)==--t){g=!0;break}}else if(o[f--]=a[u--],v++,p=0,1==--r){g=!0;break}}while((p|v)<h);if(g)break;do{if(0!==(p=t-y(a[u],o,e,t,t-1,i))){for(t-=p,d=(f-=p)+1,c=(l-=p)+1,s=p-1;0<=s;s--)o[d+s]=o[c+s];if(0===t){g=!0;break}}if(o[f--]=a[u--],1==--r){g=!0;break}if(0!==(v=r-b(o[l],a,0,r,r-1,i))){for(r-=v,d=(f-=v)+1,c=(u-=v)+1,s=0;s<v;s++)o[d+s]=a[c+s];if(r<=1){g=!0;break}}if(o[f--]=o[l--],0==--t){g=!0;break}h--}while(7<=p||7<=v);if(g)break;h<0&&(h=0),h+=2}if((this.minGallop=h)<1&&(this.minGallop=1),1===r){for(d=(f-=t)+1,c=(l-=t)+1,s=t-1;0<=s;s--)o[d+s]=o[c+s];o[f]=a[u]}else{if(0===r)throw new Error("mergeHigh preconditions were not respected");for(c=f-(r-1),s=0;s<r;s++)o[c+s]=a[s]}}else{for(d=(f-=t)+1,c=(l-=t)+1,s=t-1;0<=s;s--)o[d+s]=o[c+s];o[f]=a[u]}else for(c=f-(r-1),s=0;s<r;s++)o[c+s]=a[s]}}]),n}();b8e.timsort=function(e,t,n,r){if(!Array.isArray(e))throw new TypeError("Can only sort arrays");void 0===t&&(t=0),void 0===n&&(n=e.length),void 0===r&&(r=u);var i=n-t;if(!(i<2)){var o=0;if(i<32)d(e,t,n,t+(o=c(e,t,n,r)),r);else{var a=new h(e,r),s=f(i);do{if((o=c(e,t,n,r))<s){var l=i;s<l&&(l=s),d(e,t,t+l,t+o,r),o=l}a.pushRun(t,o),a.mergeRuns(),i-=o,t+=o}while(0!==i);a.forceMergeRuns()}}}})(),function(){var e;e=b8e.Object.extends({ctor:function(e,t){var n=this;n._super(),n._fn=e,n._count=0,n._data=new Array(t);for(var r=0;r<t;++r)n._data[r]=e()},length:{get:function(){return this._count}},data:{get:function(){return this._data}},reset:function(){this._count=0},resize:function(e){if(e>this._data.length)for(var t=this._data.length;t<e;++t)this._data[t]=this._fn()},add:function(){return this._count>=this._data.length&&this.resize(2*this._data.length),this._data[this._count++]},remove:function(e){if(!(e>=this._count)){var t=this._count-1,n=this._data[e];this._data[e]=this._data[t],this._data[t]=n,--this._count}},sort:function(e){return b8e.timsort(this._data,0,this._count,e)}});b8e.RC("$$b8e","$$RecyclePool",e)}(),function(){var e,t=b8e.timsort;e=b8e.Object.extends({ctor:function(e){this._super(),this._count=0,this._data=new Array(e)},_resize:function(e){if(e>this._data.length)for(var t=this._data.length;t<e;++t)this._data[t]=void 0},length:{get:function(){return this._count}},data:{get:function(){return this._data}},reset:function(){for(var e=0;e<this._count;++e)this._data[e]=void 0;this._count=0},push:function(e){this._count>=this._data.length&&this._resize(2*this._data.length),this._data[this._count]=e,++this._count},pop:function(){--this._count,this._count<0&&(this._count=0);var e=this._data[this._count];return this._data[this._count]=void 0,e},fastRemove:function(e){if(!(e>=this._count||e<0)){var t=this._count-1;this._data[e]=this._data[t],this._data[t]=void 0,--this._count}},indexOf:function(e){return this._data.indexOf(e)},sort:function(e){return t(this._data,0,this._count,e)}});b8e.RC("$$b8e","$$FixedArray",e)}(),function(){var e,n=Math.PI/180,i=e=b8e.PoolObject.extends({x:0,y:0,ctor:function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);this._super(),this.lazyPoolDisabled=!0,this._setParams(e,t)},restore:function(e,t){this._setParams(e,t)},_setParams:function(e,t){this.x=e,this.y=t},length:{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},setTo:function(e,t){return this.x=e,this.y=t,this},clone:function(){return i.get(this.x,this.y)},equals:function(e){return this.x==e.x&&this.y==e.y},copyFrom:function(e){this.x=e.x,this.y=e.y},add:function(e){return i.get(this.x+e.x,this.y+e.y)},normalize:function(e){if(0!=this.x||0!=this.y){var t=e/this.length;this.x*=t,this.y*=t}},offset:function(e,t){this.x+=e,this.y+=t},subtract:function(e){return i.get(this.x-e.x,this.y-e.y)},toString:function(){return"(x="+this.x+", y="+this.y+")"}}),r=new b8e.Pool(i,512);i.get=function(e,t){return r.get(e,t)},i.put=function(e){return r.put(e)},i.distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},i.interpolate=function(e,t,n){var r=1-n;return i.get(e.x*n+t.x*r,e.y*n+t.y*r)},i.polar=function(e,t){return i.get(e*MathUtil.cos(t/n),e*MathUtil.sin(t/n))},b8e._TempPoint=i.get(),b8e.RC("$$b8e","$$Point",e)}(),function(){var e,t=e=b8e.PoolObject.extends({x:0,y:0,width:0,height:0,ctor:function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0);this._super(),this.lazyPoolDisabled=!0,this._setParams(e,t,n,r)},restore:function(e,t,n,r){this._setParams(e,t,n,r)},_setParams:function(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r},right:{get:function(){return this.x+this.width},set:function(e){this.width=e-this.x}},bottom:{get:function(){return this.y+this.height},set:function(e){this.height=e-this.y}},left:{get:function(){return this.x},set:function(e){this.width+=this.x-e,this.x=e}},top:{get:function(){return this.y},set:function(e){this.height+=this.y-e,this.y=e}},topLeft:{get:function(){return b8e.Point.get(this.left,this.top)},set:function(e){this.top=e.y,this.left=e.x}},bottomRight:{get:function(){return b8e.Point.get(this.right,this.bottom)},set:function(e){this.bottom=e.y,this.right=e.x}},copyFrom:function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},setTo:function(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this},contains:function(e,t){return this.x<=e&&this.x+this.width>=e&&this.y<=t&&this.y+this.height>=t},intersection:function(e){return this.clone()._intersectInPlace(e)},inflate:function(e,t){this.x-=e,this.width+=2*e,this.y-=t,this.height+=2*t},_intersectInPlace:function(e){var t=this.x,n=this.y,r=e.x,i=e.y,o=Math.max(t,r),a=Math.min(t+this.width,r+e.width);if(o<=a){var s=Math.max(n,i),l=Math.min(n+this.height,i+e.height);if(s<=l)return this.setTo(o,s,a-o,l-s),this}return this.setEmpty(),this},intersects:function(e){return Math.max(this.x,e.x)<=Math.min(this.right,e.right)&&Math.max(this.y,e.y)<=Math.min(this.bottom,e.bottom)},isEmpty:function(){return this.width<=0||this.height<=0},setEmpty:function(){this.x=0,this.y=0,this.width=0,this.height=0},clone:function(){return t.get(this.x,this.y,this.width,this.height)},containsPoint:function(e){return this.x<=e.x&&this.x+this.width>e.x&&this.y<=e.y&&this.y+this.height>e.y},containsRect:function(e){var t=e.x+e.width,n=e.y+e.height,r=this.x+this.width,i=this.y+this.height;return e.x>=this.x&&e.x<r&&e.y>=this.y&&e.y<i&&t>this.x&&t<=r&&n>this.y&&n<=i},equals:function(e){return this===e||this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},inflatePoint:function(e){this.inflate(e.x,e.y)},offset:function(e,t){this.x+=e,this.y+=t},offsetPoint:function(e){this.offset(e.x,e.y)},toString:function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},union:function(e){var t=this.clone();if(e.isEmpty())return t;if(t.isEmpty())return t.copyFrom(e),t;var n=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return t.setTo(n,r,Math.max(t.right,e.right)-n,Math.max(t.bottom,e.bottom)-r),t},_getBaseWidth:function(e){var t=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e));return t*this.width+n*this.height},_getBaseHeight:function(e){var t=Math.abs(Math.cos(e));return Math.abs(Math.sin(e))*this.width+t*this.height}}),i=new b8e.Pool(t,512);t.get=function(e,t,n,r){return i.get(e,t,n,r)},t.put=function(e){return i.put(e)},b8e._TempRectangle=t.get(),b8e.RC("$$b8e","$$Rectangle",e)}(),b8e.EventPhase={CAPTURING_PHASE:1,AT_TARGET:2,BUBBLING_PHASE:3},function(){var e,a=e=b8e.PoolObject.extends({__Event:!0,eventPhase:2,currentTarget:null,target:null,isDefaultPrevented:!1,isPropagationStopped:!1,isPropagationImmediateStopped:!1,type:null,bubbles:!1,cancelable:!1,data:null,_isLazy:!1,references:0,maxBatchCall:0,safetyTraversal:!0,ctor:function(e,t,n,r){var i=this;i._super(),i.eventPhase=2,i.currentTarget=null,i.target=null,i.isDefaultPrevented=!1,i.isPropagationStopped=!1,i.isPropagationImmediateStopped=!1,i.type=e,i.bubbles=!!t,i.cancelable=!!n,i.data=r,i.isLazy=!0,i.references=0,i.maxBatchCall=0,i.safetyTraversal=!0},isLazy:{get:function(){return this._isLazy},set:function(e){this._isLazy=e,this.lazyPoolDisabled=!e}},setTarget:function(e){return this.target=e,!0},preventDefault:function(){this.cancelable&&(this.isDefaultPrevented=!0)},stopPropagation:function(){this.bubbles&&(this.isPropagationStopped=!0)},stopImmediatePropagation:function(){this.bubbles&&(this.isPropagationImmediateStopped=!0)},clean:function(){this.data=null,this.currentTarget=null,this.setTarget(null),this.references=0},invalidate:function(){this._super()},restore:function(e,t,n,r){var i=this;i.type=e,i.bubbles=!!t,i.cancelable=!!n,i.data=r,i._super()},recycle:function(){var e=this;e.type=null,e.clean(),e.isLazy=!0,e.maxBatchCall=0,e.safetyTraversal=!0,e._super()},dispose:function(){this.references=0,this._super()}});a.dispatchEvent=function(e,t,n,r){void 0===n&&(n=!1);var i=a.create(a,t,n),o=a._getPropertyData(a);return void 0!==r&&(o.data=r),e.dispatchEvent(i)},a._getPropertyData=function(e){var t=e._props;return t=t||(e._props={})},a.create=function(e,t,n,r){var i=e.eventPool;i||(i=e.eventPool=new b8e.Pool(e,256),e.put=function(e){return i.put(e)});var o=i.get(t,n,r);return o.isLazy=!0,o.safetyTraversal=!0,o.maxBatchCall=a.DEFAULT_MAX_BATCH_CALL,o.isDefaultPrevented=!1,o.isPropagationStopped=!1,o.isPropagationImmediateStopped=!1,o.eventPhase=b8e.EventPhase.AT_TARGET,o},a.DEFAULT_MAX_BATCH_CALL=2,a.release=function(e){e.release()},a.$hashCount=1,a.nextCode=function(){return a.$hashCount++},a.ADDED_TO_STAGE="addedToStage",a.REMOVED_FROM_STAGE="removedFromStage",a.ADDED="added",a.REMOVED="removed",a.ENTER_FRAME="enterFrame",a.RENDER="render",a.STAGE_RESIZE="stageResize",a.RESIZE="resize",a.CHANGE="change",a.CHANGING="changing",a.COMPLETE="complete",a.LOOP_COMPLETE="loopComplete",a.FOCUS_IN="focusIn",a.FOCUS_OUT="focusOut",a.ENDED="ended",a.ACTIVATE="activate",a.DEACTIVATE="deactivate",a.CLOSE="close",a.CONNECT="connect",a.LEAVE_STAGE="leaveStage",a.SOUND_COMPLETE="soundComplete",b8e.RC("$$b8e","$$Event",e)}(),function(){var e,t;t=b8e.Object.extends({ctor:function(e){void 0===e&&(e=null),this._super(),this._eventInfo={target:e||this,events:{},eventMap:{},captureEvents:{},captureEventMap:{}}},getEventMap:function(e){var t=this._eventInfo;return e?t.captureEvents:t.events},addEventListener:function(e,t,n,r,i){this._addListener(e,t,n,r,i)},once:function(e,t,n,r,i){this._addListener(e,t,n,r,i,!0)},_addListener:function(e,t,n,r,i,o){if(t){var a=this._eventInfo,s=r?a.captureEvents:a.events,l=r?a.captureEventMap:a.eventMap,u=s[e];u=u||(s[e]=b8e.LinkedList.get());var f=l[e],c=(f=f||(l[e]=b8e.HashMap.get())).get(t,n);c?b8e.warn(3136,e,t):(c=this._insertEventBin(u,e,t,n,r,i,o),f.set(t,c,n))}},_insertEventBin:function(e,t,n,r,i,o,a){o=0|+o;var s=l.get();return s.type=t,s.listener=n,s.thisObject=r,s.priority=o,s.target=this,s.useCapture=i,s.dispatchOnce=!!a,s.listening=!0,e.append(s),s},removeEventListener:function(e,t,n,r){var i=this._eventInfo,o=r?i.captureEvents:i.events,a=r?i.captureEventMap:i.eventMap,s=o[e],l=a[e];if(s&&l){var u=l.get(t,n);if(u){if(l.del(t,n),s.remove(u),u.release(),s.count()<1){s.release(),l.release(),delete o[e],delete a[e];var f=c[this.hashCode+"_"+e+(r?"1":"2")];f&&f.setFixedList(null)}return}}b8e.warn(3137,e,t)},hasEventListener:function(e,t,n){var r=this._eventInfo;if(t){var i=r.eventMap,o=r.captureEventMap,a=i[e]||o[e];return a?!!a.get(t,n):!1}return!(!r.events[e]&&!r.captureEvents[e])},willTrigger:function(e){return this.hasEventListener(e)},dispatchEvent:function(e,t){e.currentTarget=this._eventInfo.target,e.setTarget(e.currentTarget);var n=this._notifyListener(e,t);return e.usable&&!e.isLazy&&e.references<1&&b8e.Event.release(e),n},_notifyListener:function(e,t){t=!!t;var n=this._eventInfo,r=t?n.captureEvents:n.events,i=e.type,o=r[i];if(!o)return!0;if(o.count()<1)return!0;var a=e.isDefaultPrevented;e.references+=o.count();return e.isLazy?l.getLazyCallByType(this.hashCode+"_"+i+(t?"1":"2"),e.maxBatchCall,e.safetyTraversal,o).addParams(e):(o.resetTraversal(),o.every(this._notifyCall,this,e)),!a},_notifyCall:function(e,t){return t.references--,e.listener.call(e.thisObject,t),e.dispatchOnce&&e.target.removeEventListener(e.type,e.listener,e.thisObject,e.useCapture),!t.isPropagationImmediateStopped},dispatchEventWith:function(e,t,n,r,i,o,a){if(void 0===i&&(i=!0),void 0===o&&(o=0),void 0===a&&(a=!0),n||this.hasEventListener(e)){var s=b8e.Event.create(b8e.Event,e,n,r);return s.data=t,s.isLazy=i,s.safetyTraversal=a,s.maxBatchCall=0<o?o:b8e.Event.DEFAULT_MAX_BATCH_CALL,this.dispatchEvent(s)}return!0},emit:function(e,t,n,r,i,o,a){this.dispatchEventWith(e,t,n,r,i,o,a)}});var l=e=b8e.PoolObject.extends({type:null,listener:null,thisObject:null,priority:0,target:null,useCapture:!1,dispatchOnce:!1,listening:!1,ctor:function(){this._super()},restore:function(){this._super()},invalidate:function(){this.target=null,this.listening=!1,this._super()},recycle:function(){var e=this;e.type=null,e.listener=null,e.thisObject=null,e.priority=0,e.useCapture=!1,e.dispatchOnce=!1,e._super()},dispose:function(){this._super()}}),n=new b8e.Pool(l,4096);l.get=function(){return n.get()},l.put=function(e){return n.put(e)};var c={};l.getLazyCallByType=function(e,t,n,r){var i=c[e];return(i=i||(c[e]=new b8e.CallLater(function(e,t){return!t.usable||(t.references--,e.usable&&(e.listener.call(e.thisObject,t),e.dispatchOnce&&e.target.removeEventListener(e.type,e.listener,e.thisObject,e.useCapture)),t.references<1&&b8e.Event.release(t),!1)},l,t))).setFixedList(r),i.safetyTraversal=n,t>i.batch&&(i.batch=t),i};var r=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.eventBin=null,this.event=null}}),i=new b8e.Pool(r,128);r.get=function(){return i.get()},r.put=function(e){return i.put(e)},b8e.RC("$$b8e","$$EventDispatcher",t),b8e.RC("$$b8e","$$EventBin",e)}(),function(){var u,e=b8e.Point.get(),t=u=b8e.Event.extends({_stageX:0,_stageY:0,_localX:0,_localY:0,targetChanged:!0,touchPointID:0,touchDown:!1,isScrollEnd:!1,ctor:function(e,t,n,r,i,o){this._super(e,t,n),this._initTo(r,i,o)},_initTo:function(e,t,n){this.touchPointID=+n||0,this._stageX=+e||0,this._stageY=+t||0},stageX:{get:function(){return this._stageX}},stageY:{get:function(){return this._stageY}},localX:{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX}},localY:{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY}},getLocalXY:function(){this.targetChanged=!1,this.target._getInvertedConcatenatedMatrix().transformPoint(this._stageX,this._stageY,e),this._localX=e.x,this._localY=e.y},setTarget:function(e){return this.target=e,this.targetChanged=!!e,!0},updateAfterEvent:function(){b8e._requestRenderingFlag=!0}});t.TOUCH_MOVE="touchMove",t.TOUCH_BEGIN="touchBegin",t.TOUCH_END="touchEnd",t.TOUCH_CANCEL="touchCancel",t.TOUCH_TAP="touchTap",t.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",t.dispatchTouchEvent=function(e,t,n,r,i,o,a,s){if(!n&&!e.hasEventListener(t))return!0;var l=b8e.Event.create(u,t,n,r);return l._initTo(i,o,a),l.touchDown=!!s,l.isScrollEnd=!1,e.dispatchEvent(l)},b8e.RC("$$b8e","$$TouchEvent",u)}();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};b8e.long=function(){"use strict";function r(e,t,n){var r=this;r.low=e|0;r.high=t|0;r.unsigned=!!n}function p(e){return(e&&e["__isLong__"])===true}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:true,enumerable:false,configurable:false}),r.isLong=p;var o={},a={};function e(e,t){var n=void 0,r=void 0,i=void 0;if(t){e>>>=0;if(i=0<=e&&e<256){r=a[e];if(r)return r}n=g(e,(e|0)<0?-1:0,true);if(i)a[e]=n;return n}else{e|=0;if(i=-128<=e&&e<128){r=o[e];if(r)return r}n=g(e,e<0?-1:0,false);if(i)o[e]=n;return n}}function v(e,t){if(isNaN(e)||!isFinite(e))return t?u:_;if(t){if(e<0)return u;if(e>=s)return T}else{if(e<=-l)return E;if(e+1>=l)return w}if(e<0)return v(-e,t).neg();return g(e%i|0,e/i|0,t)}function g(e,t,n){return new r(e,t,n)}r.fromInt=e,r.fromNumber=v,r.fromBits=g;var f=Math.pow;function c(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return _;if((typeof t==="undefined"?"undefined":J(t))===b8e.TypeNumber){n=t,t=false}else{t=!!t}n=n||10;if(n<2||36<n)throw RangeError("radix");var r=void 0;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");else if(r===0){return c(e.substring(1),t,n).neg()}var i=v(f(n,8));var o=_;for(var a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),l=parseInt(e.substring(a,a+s),n);if(s<8){var u=v(f(n,s));o=o.mul(u).add(v(l))}else{o=o.mul(i);o=o.add(v(l))}}o.unsigned=t;return o}function b(e){if(e instanceof r)return e;if((typeof e==="undefined"?"undefined":J(e))===b8e.TypeNumber)return v(e);if(typeof e==="string")return c(e);return g(e.low,e.high,e.unsigned)}r.fromString=c,r.fromValue=b;var t=1<<16,n,i=t*t,s=i*i,l=s/2,y=e(1<<24),_=e(0);r.ZERO=_;var u=e(0,true);r.UZERO=u;var d=e(1);r.ONE=d;var h=e(1,true);r.UONE=h;var m=e(-1);r.NEG_ONE=m;var w=g(4294967295|0,2147483647|0,false);r.MAX_VALUE=w;var T=g(4294967295|0,4294967295|0,true);r.MAX_UNSIGNED_VALUE=T;var E=g(0,2147483648|0,false);r.MIN_VALUE=E;var S=r.prototype;return S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){var e=this;return e.unsigned?(e.high>>>0)*i+(e.low>>>0):e.high*i+(e.low>>>0)},S.toString=function(e){var t=this;if((e=e||10)<2||36<e)throw RangeError("radix");if(t.isZero())return"0";if(t.isNegative()){if(t.eq(E)){var n=v(e),r=t.div(n),i=r.mul(n).sub(t);return r.toString(e)+i.toInt().toString(e)}return"-"+t.neg().toString(e)}for(var o=v(f(e,6),t.unsigned),a=t,s="";;){var l=a.div(o),u=(a.sub(l.mul(o)).toInt()>>>0).toString(e);if((a=l).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){var e=this;if(e.isNegative())return e.eq(E)?64:e.neg().getNumBitsAbs();for(var t=0!=e.high?e.high:e.low,n=31;0<n&&0==(t&1<<n);n--);return 0!=e.high?bit+33:bit+1},S.isZero=function(){return 0===this.high&&0===this.low},S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||0<=this.high},S.isOdd=function(){return 1==(1&this.low)},S.isEven=function(){return 0==(1&this.low)},S.equals=function(e){return p(e)||(e=b(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.greaterThan=function(e){return 0<this.comp(e)},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return 0<=this.comp(e)},S.gte=S.greaterThanOrEqual,S.compare=function(e){var t=this;if(p(e)||(e=b(e)),t.eq(e))return 0;var n=t.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:t.unsigned?e.high>>>0>t.high>>>0||e.high===t.high&&e.low>>>0>t.low>>>0?-1:1:t.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(d)},S.neg=S.negate,S.add=function(e){var t=this;p(e)||(e=b(e));var n=t.high>>>16,r=65535&t.high,i=t.low>>>16,o=65535&t.low,a=e.high>>>16,s=65535&e.high,l=e.low>>>16,u=0,f=0,c=0,d=0;return c+=(d+=o+(65535&e.low))>>>16,f+=(c+=i+l)>>>16,u+=(f+=r+s)>>>16,u+=n+a,g((c&=65535)<<16|(d&=65535),(u&=65535)<<16|(f&=65535),t.unsigned)},S.subtract=function(e){return p(e)||(e=b(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){var t=this;if(t.isZero())return _;if(p(e)||(e=b(e)),e.isZero())return _;if(t.eq(E))return e.isOdd()?E:_;if(e.eq(E))return t.isOdd()?E:_;if(t.isNegative())return e.isNegative()?t.neg().mul(e.neg()):t.neg().mul(e).neg();if(e.isNegative())return t.mul(e.neg()).neg();if(t.lt(y)&&e.lt(y))return v(t.toNumber()*e.toNumber(),t.unsigned);var n=t.high>>>16,r=65535&t.high,i=t.low>>>16,o=65535&t.low,a=e.high>>>16,s=65535&e.high,l=e.low>>>16,u=65535&e.low,f=0,c=0,d=0,h=0;return d+=(h+=o*u)>>>16,c+=(d+=i*u)>>>16,d&=65535,c+=(d+=o*l)>>>16,f+=(c+=r*u)>>>16,c&=65535,f+=(c+=i*l)>>>16,c&=65535,f+=(c+=o*s)>>>16,f+=n*u+r*l+i*s+o*a,g((d&=65535)<<16|(h&=65535),(f&=65535)<<16|(c&=65535),t.unsigned)},S.mul=S.multiply,S.divide=function(e){var t=this;if(p(e)||(e=b(e)),e.isZero())throw Error("division by zero");if(t.isZero())return t.unsigned?u:_;var n=void 0,r=void 0,i=void 0;if(t.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(t))return u;if(e.gt(t.shru(1)))return h;i=u}else{if(t.eq(E))return e.eq(d)||e.eq(m)?E:e.eq(E)?d:(n=t.shr(1).div(e).shl(1)).eq(_)?e.isNegative()?d:m:(r=t.sub(e.mul(n)),i=n.add(r.div(e)));else if(e.eq(E))return t.unsigned?u:_;if(t.isNegative())return e.isNegative()?t.neg().div(e.neg()):t.neg().div(e).neg();if(e.isNegative())return t.div(e.neg()).neg();i=_}for(r=t;r.gte(e);){n=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),a=o<=48?1:f(2,o-48),s=v(n),l=s.mul(e);l.isNegative()||l.gt(r);)l=(s=v(n-=a,t.unsigned)).mul(e);s.isZero()&&(s=d),i=i.add(s),r=r.sub(l)}return i},S.div=S.divide,S.modulo=function(e){return p(e)||(e=b(e)),this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.not=function(){return g(~this.low,~this.high,this.unsigned)},S.and=function(e){return p(e)||(e=b(e)),g(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return p(e)||(e=b(e)),g(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return p(e)||(e=b(e)),g(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return p(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?g(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):g(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return p(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?g(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):g(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(p(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?g(this.low>>>e|t<<32-e,t>>>e,this.unsigned):g(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?g(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:g(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},r}();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var t=b8e.long;(function(e){b8e.bytebuffer=e(t)})(function(u){function p(e,t,n){if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=p.DEFAULT_CAPACITY),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=p.DEFAULT_ENDIAN),(void 0===n?"undefined":J(n))===b8e.TypeUndefined&&(n=p.DEFAULT_NOASSERT),!n){if((e|=0)<0)throw RangeError("Illegal capacity");t=!!t,n=!!n}var r=this;r.buffer=0===e?s:new ArrayBuffer(e),r.view=0===e?null:new Uint8Array(r.buffer),r.offset=0,r.markedOffset=-1,r.limit=e,r.littleEndian=t,r.noAssert=n}p.VERSION="5.0.1",p.LITTLE_ENDIAN=!0,p.BIG_ENDIAN=!1,p.DEFAULT_CAPACITY=16,p.DEFAULT_ENDIAN=p.BIG_ENDIAN,p.DEFAULT_NOASSERT=!1,p.Long=u||null;var a=p.prototype;a.__isByteBuffer__,Object.defineProperty(a,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var s=new ArrayBuffer(0),e=String.fromCharCode,t=0,n=null;function l(e){return t=0,n=e,r}function r(){return t<n.length?n.charCodeAt(t++):null}var o=null,f=null;function c(){return o=[],f=[],d}function d(){if(0===arguments.length)return f.join("")+e.apply(String,o);1024<o.length+arguments.length&&(f.push(e.apply(String,o)),o.length=0),Array.prototype.push.apply(o,arguments)}function h(e,t,n,r,i){var o=void 0,a=void 0,s=8*i-r-1,l=(1<<s)-1,u=l>>1,f=-7,c=n?i-1:0,d=n?-1:1,h=e[t+c];for(c+=d,o=h&(1<<-f)-1,h>>=-f,f+=s;0<f;o=256*o+e[t+c],c+=d,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=r;0<f;a=256*a+e[t+c],c+=d,f-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=u}return(h?-1:1)*a*Math.pow(2,o-r)}function v(e,t,n,r,i,o){var a=void 0,s=void 0,l=void 0,u=8*o-i-1,f=(1<<u)-1,c=f>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=f):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(t+=1<=a+c?d/l:d*Math.pow(2,1-c))*l&&(a++,l/=2),f<=a+c?(s=0,a=f):1<=a+c?(s=(t*l-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));8<=i;e[n+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;0<u;e[n+h]=255&a,h+=p,a/=256,u-=8);e[n+h-p]|=128*v}p.accessor=function(){return Uint8Array},p.allocate=function(e,t,n){return new p(e,t,n)},p.concat=function(e,t,n,r){"boolean"!=typeof t&&"string"==typeof t||(r=n,n=t,t=void 0);for(var o,a=0,s=0,l=e.length;s<l;++s)p.isByteBuffer(e[s])||(e[s]=p.wrap(e[s],t)),0<(o=e[s].limit-e[s].offset)&&(a+=o);if(0===a)return new p(0,n,r);var u=new p(a,n,r),f=void 0;for(i=0;i<k;)f=e[i++],length=f.limit-f.offset,length<=0||(u.view.set(f.view.subarray(f.offset,f.limit),u.offset),u.offset+=length);return u.limit=u.offset,u.offset=0,u},p.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},p.type=function(){return ArrayBuffer},p.wrap=function(e,t,n,r){if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch((void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t="utf8"),t){case"base64":return p.fromBase64(e,n);case"hex":return p.fromHex(e,n);case"binary":return p.fromBinary(e,n);case"utf8":return p.fromUTF8(e,n);case"debug":return p.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||(void 0===e?"undefined":J(e))!==b8e.TypeObject)throw TypeError("Illegal buffer");var i=void 0;if(p.isByteBuffer(e))return(i=a.clone.call(e)).markedOffset=-1,i;if(e instanceof Uint8Array)i=new p(0,n,r),0<e.length&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new p(0,n,r),0<e.byteLength&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=0<e.byteLength?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");(i=new p(e.length,n,r)).limit=e.length;for(var o=0;o<e.length;++o)i.view[o]=e[o]}return i},a.writeBitSet=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}var i=t,o=e.length,a=o>>3,s=0,l=void 0;for(t+=n.writeVarint32(o,t);a--;)l=1&!!e[s++]|(1&!!e[s++])<<1|(1&!!e[s++])<<2|(1&!!e[s++])<<3|(1&!!e[s++])<<4|(1&!!e[s++])<<5|(1&!!e[s++])<<6|(1&!!e[s++])<<7,n.writeByte(l,t++);if(s<o){var u=0;for(l=0;s<o;)l|=(1&!!e[s++])<<u++;n.writeByte(l,t++)}return r?(n.offset=t,n):t-i},a.readBitSet=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;n&&(e=t.offset);var r=t.readVarint32(e),i=r.value,o=i>>3,a=0,s=[],l=void 0;for(e+=r.length;o--;)l=t.readByte(e++),s[a++]=!!(1&l),s[a++]=!!(2&l),s[a++]=!!(4&l),s[a++]=!!(8&l),s[a++]=!!(16&l),s[a++]=!!(32&l),s[a++]=!!(64&l),s[a++]=!!(128&l);if(a<i){var u=0;for(l=t.readByte(e++);a<i;)s[a++]=!!(l>>u++&1)}return n&&(t.offset=e),s},a.readBytes=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}var i=n.slice(t,t+e);return r&&(n.offset+=e),i},a.writeBytes=a.append,a.writeInt8=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=1;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),--t,n.view[t]=e,r&&(n.offset+=1),n},a.writeByte=a.writeInt8,a.readInt8=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r=t.view[e];return 128==(128&r)&&(r=-(255-r+1)),n&&(t.offset+=1),r},a.readByte=a.readInt8,a.writeUint8=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=1;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),--t,n.view[t]=e,r&&(n.offset+=1),n},a.writeUInt8=a.writeUint8,a.readUint8=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+t.buffer.byteLength)}var r=t.view[e];return n&&(t.offset+=1),r},a.readUInt8=a.readUint8,a.writeInt16=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=2;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),t-=2,n.littleEndian?(n.view[t+1]=(65280&e)>>>8,n.view[t]=255&e):(n.view[t]=(65280&e)>>>8,n.view[t+1]=255&e),r&&(n.offset+=2),n},a.writeShort=a.writeInt16,a.readInt16=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+t.buffer.byteLength)}var r=0;return t.littleEndian?(r=t.view[e],r|=t.view[e+1]<<8):(r=t.view[e]<<8,r|=t.view[e+1]),32768==(32768&r)&&(r=-(65535-r+1)),n&&(t.offset+=2),r},a.readShort=a.readInt16,a.writeUint16=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=2;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),t-=2,n.littleEndian?(n.view[t+1]=(65280&e)>>>8,n.view[t]=255&e):(n.view[t]=(65280&e)>>>8,n.view[t+1]=255&e),r&&(n.offset+=2),n},a.writeUInt16=a.writeUint16,a.readUint16=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+t.buffer.byteLength)}var r=0;return t.littleEndian?(r=t.view[e],r|=t.view[e+1]<<8):(r=t.view[e]<<8,r|=t.view[e+1]),n&&(t.offset+=2),r},a.readUInt16=a.readUint16,a.writeInt32=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=4;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),t-=4,n.littleEndian?(n.view[t+3]=e>>>24&255,n.view[t+2]=e>>>16&255,n.view[t+1]=e>>>8&255,n.view[t]=255&e):(n.view[t]=e>>>24&255,n.view[t+1]=e>>>16&255,n.view[t+2]=e>>>8&255,n.view[t+3]=255&e),r&&(n.offset+=4),n},a.writeInt=a.writeInt32,a.readInt32=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+t.buffer.byteLength)}var r=0;return t.littleEndian?(r=t.view[e+2]<<16,r|=t.view[e+1]<<8,r|=t.view[e],r+=t.view[e+3]<<24>>>0):(r=t.view[e+1]<<16,r|=t.view[e+2]<<8,r|=t.view[e+3],r+=t.view[e]<<24>>>0),r|=0,n&&(t.offset+=4),r},a.readInt=a.readInt32,a.writeUint32=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=4;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),t-=4,n.littleEndian?(n.view[t+3]=e>>>24&255,n.view[t+2]=e>>>16&255,n.view[t+1]=e>>>8&255,n.view[t]=255&e):(n.view[t]=e>>>24&255,n.view[t+1]=e>>>16&255,n.view[t+2]=e>>>8&255,n.view[t+3]=255&e),r&&(n.offset+=4),n},a.writeUInt32=a.writeUint32,a.readUint32=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+t.buffer.byteLength)}var r=0;return t.littleEndian?(r=t.view[e+2]<<16,r|=t.view[e+1]<<8,r|=t.view[e],r+=t.view[e+3]<<24>>>0):(r=t.view[e+1]<<16,r|=t.view[e+2]<<8,r|=t.view[e+3],r+=t.view[e]<<24>>>0),n&&(t.offset+=4),r},a.readUInt32=a.readUint32,u&&(a.writeInt64=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))===b8e.TypeNumber)e=u.fromNumber(e);else if("string"==typeof e)e=u.fromString(e);else if(!(e&&e instanceof u))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}(void 0===e?"undefined":J(e))===b8e.TypeNumber?e=u.fromNumber(e):"string"==typeof e&&(e=u.fromString(e)),t+=8;var i=n.buffer.byteLength;i<t&&n.resize((i*=2)>t?i:t),t-=8;var o=e.low,a=e.high;return n.littleEndian?(n.view[t+3]=o>>>24&255,n.view[t+2]=o>>>16&255,n.view[t+1]=o>>>8&255,n.view[t]=255&o,t+=4,n.view[t+3]=a>>>24&255,n.view[t+2]=a>>>16&255,n.view[t+1]=a>>>8&255,n.view[t]=255&a):(n.view[t]=a>>>24&255,n.view[t+1]=a>>>16&255,n.view[t+2]=a>>>8&255,n.view[t+3]=255&a,t+=4,n.view[t]=o>>>24&255,n.view[t+1]=o>>>16&255,n.view[t+2]=o>>>8&255,n.view[t+3]=255&o),r&&(n.offset+=8),n},a.writeLong=a.writeInt64,a.readInt64=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+t.buffer.byteLength)}var r=0,i=0;t.littleEndian?(r=t.view[e+2]<<16,r|=t.view[e+1]<<8,r|=t.view[e],r+=t.view[e+3]<<24>>>0,e+=4,i=t.view[e+2]<<16,i|=t.view[e+1]<<8,i|=t.view[e],i+=t.view[e+3]<<24>>>0):(i=t.view[e+1]<<16,i|=t.view[e+2]<<8,i|=t.view[e+3],i+=t.view[e]<<24>>>0,e+=4,r=t.view[e+1]<<16,r|=t.view[e+2]<<8,r|=t.view[e+3],r+=t.view[e]<<24>>>0);var o=new u(r,i,!1);return n&&(t.offset+=8),o},a.readLong=a.readInt64,a.writeUint64=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))===b8e.TypeNumber)e=u.fromNumber(e);else if("string"==typeof e)e=u.fromString(e);else if(!(e&&e instanceof u))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}(void 0===e?"undefined":J(e))===b8e.TypeNumber?e=u.fromNumber(e):"string"==typeof e&&(e=u.fromString(e)),t+=8;var i=n.buffer.byteLength;i<t&&n.resize((i*=2)>t?i:t),t-=8;var o=e.low,a=e.high;return n.littleEndian?(n.view[t+3]=o>>>24&255,n.view[t+2]=o>>>16&255,n.view[t+1]=o>>>8&255,n.view[t]=255&o,t+=4,n.view[t+3]=a>>>24&255,n.view[t+2]=a>>>16&255,n.view[t+1]=a>>>8&255,n.view[t]=255&a):(n.view[t]=a>>>24&255,n.view[t+1]=a>>>16&255,n.view[t+2]=a>>>8&255,n.view[t+3]=255&a,t+=4,n.view[t]=o>>>24&255,n.view[t+1]=o>>>16&255,n.view[t+2]=o>>>8&255,n.view[t+3]=255&o),r&&(n.offset+=8),n},a.writeUInt64=a.writeUint64,a.readUint64=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+t.buffer.byteLength)}var r=0,i=0;t.littleEndian?(r=t.view[e+2]<<16,r|=t.view[e+1]<<8,r|=t.view[e],r+=t.view[e+3]<<24>>>0,e+=4,i=t.view[e+2]<<16,i|=t.view[e+1]<<8,i|=t.view[e],i+=t.view[e+3]<<24>>>0):(i=t.view[e+1]<<16,i|=t.view[e+2]<<8,i|=t.view[e+3],i+=t.view[e]<<24>>>0,e+=4,r=t.view[e+1]<<16,r|=t.view[e+2]<<8,r|=t.view[e+3],r+=t.view[e]<<24>>>0);var o=new u(r,i,!0);return n&&(t.offset+=8),o},a.readUInt64=a.readUint64),a.writeFloat32=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber)throw TypeError("Illegal value: "+e+" (not a number)");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=4;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),t-=4,v(n.view,e,t,n.littleEndian,23,4),r&&(n.offset+=4),n},a.writeFloat=a.writeFloat32,a.readFloat32=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+t.buffer.byteLength)}var r=h(t.view,e,t.littleEndian,23,4);return n&&(t.offset+=4),r},a.readFloat=a.readFloat32,a.writeFloat64=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber)throw TypeError("Illegal value: "+e+" (not a number)");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}t+=8;var i=n.buffer.byteLength;return i<t&&n.resize((i*=2)>t?i:t),t-=8,v(n.view,e,t,n.littleEndian,52,8),r&&(n.offset+=8),n},a.writeDouble=a.writeFloat64,a.readFloat64=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+t.buffer.byteLength)}var r=h(t.view,e,t.littleEndian,52,8);return n&&(t.offset+=8),r},a.readDouble=a.readFloat64,p.MAX_VARINT32_BYTES=5,p.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},p.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},p.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},a.writeVarint32=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}var i=p.calculateVarint32(e),o=void 0;t+=i;var a=n.buffer.byteLength;for(a<t&&n.resize((a*=2)>t?a:t),t-=i,e>>>=0;128<=e;)o=127&e|128,n.view[t++]=o,e>>>=7;return n.view[t++]=e,r?(n.offset=t,n):i},a.writeVarint32ZigZag=function(e,t){return this.writeVarint32(p.zigZagEncode32(e),t)},a.readVarint32=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+t.buffer.byteLength)}var r=0,i=0,o=void 0;do{if(!t.noAssert&&e>t.limit){var a=Error("Truncated");throw a.truncated=!0,a}o=t.view[e++],r<5&&(i|=(127&o)<<7*r),++r}while(0!=(128&o));return i|=0,n?(t.offset=e,i):{value:i,length:r}},a.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return(void 0===t?"undefined":J(t))===b8e.TypeObject?t.value=p.zigZagDecode32(t.value):t=p.zigZagDecode32(t),t},u&&(p.MAX_VARINT64_BYTES=10,p.calculateVarint64=function(e){(void 0===e?"undefined":J(e))===b8e.TypeNumber?e=u.fromNumber(e):"string"==typeof e&&(e=u.fromString(e));var t=e.toInt()>>>0,n=e.shiftRightUnsigned(28).toInt()>>>0,r=e.shiftRightUnsigned(56).toInt()>>>0;return 0==r?0==n?t<16384?t<128?1:2:t<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10},p.zigZagEncode64=function(e){return(void 0===e?"undefined":J(e))===b8e.TypeNumber?e=u.fromNumber(e,!1):"string"==typeof e?e=u.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},p.zigZagDecode64=function(e){return(void 0===e?"undefined":J(e))===b8e.TypeNumber?e=u.fromNumber(e,!1):"string"==typeof e?e=u.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftRightUnsigned(1).xor(e.and(u.ONE).toSigned().negate()).toSigned()},a.writeVarint64=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===e?"undefined":J(e))===b8e.TypeNumber)e=u.fromNumber(e);else if("string"==typeof e)e=u.fromString(e);else if(!(e&&e instanceof u))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}(void 0===e?"undefined":J(e))===b8e.TypeNumber?e=u.fromNumber(e,!1):"string"==typeof e?e=u.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned());var i=p.calculateVarint64(e),o=e.toInt()>>>0,a=e.shiftRightUnsigned(28).toInt()>>>0,s=e.shiftRightUnsigned(56).toInt()>>>0;t+=i;var l=n.buffer.byteLength;switch(l<t&&n.resize((l*=2)>t?l:t),t-=i,i){case 10:n.view[t+9]=s>>>7&1;case 9:n.view[t+8]=9!==i?128|s:127&s;case 8:n.view[t+7]=8!==i?a>>>21|128:a>>>21&127;case 7:n.view[t+6]=7!==i?a>>>14|128:a>>>14&127;case 6:n.view[t+5]=6!==i?a>>>7|128:a>>>7&127;case 5:n.view[t+4]=5!==i?128|a:127&a;case 4:n.view[t+3]=4!==i?o>>>21|128:o>>>21&127;case 3:n.view[t+2]=3!==i?o>>>14|128:o>>>14&127;case 2:n.view[t+1]=2!==i?o>>>7|128:o>>>7&127;case 1:n.view[t]=1!==i?128|o:127&o}return r?(n.offset+=i,n):i},a.writeVarint64ZigZag=function(e,t){return this.writeVarint64(p.zigZagEncode64(e),t)},a.readVarint64=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r=e,i=0,o=0,a=0,s=0;if(i=127&(s=t.view[e++]),128&s&&(i|=(127&(s=t.view[e++]))<<7,(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(i|=(127&(s=t.view[e++]))<<14,(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(i|=(127&(s=t.view[e++]))<<21,(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(o=127&(s=t.view[e++]),(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(o|=(127&(s=t.view[e++]))<<7,(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(o|=(127&(s=t.view[e++]))<<14,(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(o|=(127&(s=t.view[e++]))<<21,(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(a=127&(s=t.view[e++]),(128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined)&&(a|=(127&(s=t.view[e++]))<<7,128&s||t.noAssert&&(void 0===s?"undefined":J(s))===b8e.TypeUndefined))))))))))throw Error("Buffer overrun");var l=u.fromBits(i|o<<28,o>>>4|a<<24,!1);return n?(t.offset=e,l):{value:l,length:e-r}},a.readVarint64ZigZag=function(e){var t=this.readVarint64(e);return t&&t.value instanceof u?t.value=p.zigZagDecode64(t.value):t=p.zigZagDecode64(t),t}),a.writeCString=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;r&&(t=n.offset);var i=void 0,o=e.length;if(!n.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(i=0;i<o;++i)if(0===e.charCodeAt(i))throw RangeError("Illegal str: Contains NULL-characters");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}o=b.calculateUTF16asUTF8(l(e))[1],t+=o+1;var a=n.buffer.byteLength;return a<t&&n.resize((a*=2)>t?a:t),t-=o+1,b.encodeUTF16toUTF8(l(e),function(e){n.view[t++]=e}.bind(n)),n.view[t++]=0,r?(n.offset=t,n):o},a.readCString=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+t.buffer.byteLength)}var r=e,i=void 0,o=-1;return b.decodeUTF8toUTF16(function(){if(0===o)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(o=this.view[e++])?null:o}.bind(t),i=c(),!0),n?(t.offset=e,i()):{string:i(),length:e-r}},a.writeIString=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}var i,o=t;i=b.calculateUTF16asUTF8(l(e),n.noAssert)[1],t+=4+i;var a=this.buffer.byteLength;if(a<t&&n.resize((a*=2)>t?a:t),t-=4+i,n.littleEndian?(n.view[t+3]=i>>>24&255,n.view[t+2]=i>>>16&255,n.view[t+1]=i>>>8&255,n.view[t]=255&i):(n.view[t]=i>>>24&255,n.view[t+1]=i>>>16&255,n.view[t+2]=i>>>8&255,n.view[t+3]=255&i),t+=4,b.encodeUTF16toUTF8(l(e),function(e){this.view[t++]=e}.bind(n)),t!==o+4+i)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+4+i));return r?(n.offset=t,n):t-o},a.readIString=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+t.buffer.byteLength)}var r=e,i=t.readUint32(e),o=t.readUTF8String(i,p.METRICS_BYTES,e+=4);return e+=o.length,n?(t.offset=e,o.string):{string:o.string,length:e-r}},p.METRICS_CHARS="c",p.METRICS_BYTES="b",a.writeUTF8String=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}var i,o=t;i=b.calculateUTF16asUTF8(l(e))[1],t+=i;var a=n.buffer.byteLength;return a<t&&n.resize((a*=2)>t?a:t),t-=i,b.encodeUTF16toUTF8(l(e),function(e){this.view[t++]=e}.bind(n)),r?(n.offset=t,n):t-o},a.writeString=function(e){var t=b8e.BufferUtil.str2Uint8Array(e);this.writeInt(t.length),this.append(t.buffer)},p.calculateUTF8Chars=function(e){return b.calculateUTF16asUTF8(l(e))[0]},p.calculateString=p.calculateUTF8Bytes=function(e){return b.calculateUTF16asUTF8(l(e))[1]},a.readUTF8String=function(e,t,n){var r=this;(void 0===t?"undefined":J(t))===b8e.TypeNumber&&(n=t,t=void 0);var i=(void 0===n?"undefined":J(n))===b8e.TypeUndefined;if(i&&(n=r.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=p.METRICS_CHARS),!r.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,(void 0===n?"undefined":J(n))!==b8e.TypeNumber||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>r.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+r.buffer.byteLength)}var o=0,a=n,s=void 0;if(t===p.METRICS_CHARS){if(s=c(),b.decodeUTF8(function(){return o<e&&n<this.limit?this.view[n++]:null}.bind(r),function(e){++o,b.UTF8toUTF16(e,s)}),o!==e)throw RangeError("Illegal range: Truncated data, "+o+" == "+e);return i?(r.offset=n,s()):{string:s(),length:n-a}}if(t!==p.METRICS_BYTES)throw TypeError("Unsupported metrics: "+t);if(!r.noAssert){if((void 0===n?"undefined":J(n))!==b8e.TypeNumber||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+e>r.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+e+") <= "+r.buffer.byteLength)}var l=n+e;if(b.decodeUTF8toUTF16(function(){return n<l?this.view[n++]:null}.bind(r),s=c(),r.noAssert),n!==l)throw RangeError("Illegal range: Truncated data, "+n+" == "+l);return i?(r.offset=n,s()):{string:s(),length:n-a}},a.readString=function(){var e=this.readInt(),t=this.readBytes(e),n=t.buffer.slice(t.offset,t.limit);return b8e.BufferUtil.uint8Array2Str(new Uint8Array(n))},a.writeVString=function(e,t){var n=this,r=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(r&&(t=n.offset),!n.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if((void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.buffer.byteLength)}var i,o,a=t;i=b.calculateUTF16asUTF8(l(e),n.noAssert)[1],o=p.calculateVarint32(i),t+=o+i;var s=n.buffer.byteLength;if(s<t&&n.resize((s*=2)>t?s:t),t-=o+i,t+=n.writeVarint32(i,t),b.encodeUTF16toUTF8(l(e),function(e){this.view[t++]=e}.bind(n)),t!==a+i+o)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+i+o));return r?(n.offset=t,n):t-a},a.readVString=function(e){var t=this,n=(void 0===e?"undefined":J(e))===b8e.TypeUndefined;if(n&&(e=t.offset),!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+t.buffer.byteLength)}var r=e,i=t.readVarint32(e),o=t.readUTF8String(i.value,p.METRICS_BYTES,e+=i.length);return e+=o.length,n?(t.offset=e,o.string):{string:o.string,length:e-r}},a.append=function(e,t,n){var r=this;(void 0===t?"undefined":J(t))!==b8e.TypeNumber&&"string"==typeof t||(n=t,t=void 0);var i=(void 0===n?"undefined":J(n))===b8e.TypeUndefined;if(i&&(n=r.offset),!r.noAssert){if((void 0===n?"undefined":J(n))!==b8e.TypeNumber||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>r.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+r.buffer.byteLength)}e instanceof p||(e=p.wrap(e,t));var o=e.limit-e.offset;if(o<=0)return r;n+=o;var a=r.buffer.byteLength;return a<n&&r.resize((a*=2)>n?a:n),n-=o,r.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=o,i&&(r.offset+=o),r},a.appendTo=function(e,t){return e.append(this,t),this},a.assert=function(e){return this.noAssert=!e,this},a.capacity=function(){return this.buffer.byteLength},a.clear=function(){var e=this;return e.offset=0,e.limit=e.buffer.byteLength,e.markedOffset=-1,e},a.clone=function(e){var t=this,n=new p(0,t.littleEndian,t.noAssert);return e?(n.buffer=new ArrayBuffer(t.buffer.byteLength),n.view=new Uint8Array(n.buffer)):(n.buffer=t.buffer,n.view=t.view),n.offset=t.offset,n.markedOffset=t.markedOffset,n.limit=t.limit,n},a.compact=function(e,t){var n=this;if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=n.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=n.limit),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>n.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+n.buffer.byteLength)}if(0===e&&t===n.buffer.byteLength)return n;var r=t-e;if(0==r)return n.buffer=s,n.view=null,0<=n.markedOffset&&(n.markedOffset-=e),n.offset=0,n.limit=0,n;var i=new ArrayBuffer(r),o=new Uint8Array(i);return o.set(n.view.subarray(e,t)),n.buffer=i,n.view=o,0<=n.markedOffset&&(n.markedOffset-=e),n.offset=0,n.limit=r,n},a.copy=function(e,t){var n=this;if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=n.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=n.limit),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>n.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+n.buffer.byteLength)}if(e===t)return new p(0,n.littleEndian,n.noAssert);var r=t-e,i=new p(r,n.littleEndian,n.noAssert);return i.offset=0,i.limit=r,0<=i.markedOffset&&(i.markedOffset-=e),n.copyTo(i,0,e,t),i},a.copyTo=function(e,t,n,r){var i,o,a=this;if(!a.noAssert&&!p.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o=(void 0===t?"undefined":J(t))===b8e.TypeUndefined)?e.offset:0|t,n=(i=(void 0===n?"undefined":J(n))===b8e.TypeUndefined)?a.offset:0|n,r=(void 0===r?"undefined":J(r))===b8e.TypeUndefined?a.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>a.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+a.buffer.byteLength);var s=r-n;return 0==s?e:(e.ensureCapacity(t+s),e.view.set(a.view.subarray(n,r),t),i&&(a.offset+=s),o&&(e.offset+=s),a)},a.ensureCapacity=function(e){var t=this.buffer.byteLength;return t<e?this.resize((t*=2)>e?t:e):this},a.fill=function(e,t,n){var r=this,i=(void 0===t?"undefined":J(t))===b8e.TypeUndefined;if(i&&(t=r.offset),"string"==typeof e&&0<e.length&&(e=e.charCodeAt(0)),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=r.offset),(void 0===n?"undefined":J(n))===b8e.TypeUndefined&&(n=r.limit),!r.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,(void 0===n?"undefined":J(n))!==b8e.TypeNumber||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||n<t||n>r.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+r.buffer.byteLength)}if(n<=t)return r;for(;t<n;)r.view[t++]=e;return i&&(r.offset=t),r},a.flip=function(){return this.limit=this.offset,this.offset=0,this},a.mark=function(e){var t=this;if(e=(void 0===e?"undefined":J(e))===b8e.TypeUndefined?t.offset:e,!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>t.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+t.buffer.byteLength)}return t.markedOffset=e,t},a.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},a.LE=function(e){return this.littleEndian=(void 0===e?"undefined":J(e))===b8e.TypeUndefined||!!e,this},a.BE=function(e){return this.littleEndian=(void 0===e?"undefined":J(e))!==b8e.TypeUndefined&&!e,this},a.prepend=function(e,t,n){(void 0===t?"undefined":J(t))!==b8e.TypeNumber&&"string"==typeof t||(n=t,t=void 0);var r=this,i=(void 0===n?"undefined":J(n))===b8e.TypeUndefined;if(i&&(n=r.offset),!r.noAssert){if((void 0===n?"undefined":J(n))!==b8e.TypeNumber||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>r.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+r.buffer.byteLength)}e instanceof p||(e=p.wrap(e,t));var o=e.limit-e.offset;if(o<=0)return r;var a=o-n;if(0<a){var s=new ArrayBuffer(r.buffer.byteLength+a),l=new Uint8Array(s);l.set(r.view.subarray(n,r.buffer.byteLength),o),r.buffer=s,r.view=l,r.offset+=a,0<=r.markedOffset&&(r.markedOffset+=a),r.limit+=a,n+=a}else new Uint8Array(r.buffer);return r.view.set(e.view.subarray(e.offset,e.limit),n-o),e.offset=e.limit,i&&(r.offset-=o),r},a.prependTo=function(e,t){return e.prepend(this,t),this},a.printDebug=function(e){(void 0===e?"undefined":J(e))!==b8e.TypeFunction&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},a.remaining=function(){return this.limit-this.offset},a.reset=function(){var e=this;return 0<=e.markedOffset?(e.offset=e.markedOffset,e.markedOffset=-1):e.offset=0,e},a.resize=function(e){var t=this;if(!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}if(t.buffer.byteLength<e){var n=new ArrayBuffer(e),r=new Uint8Array(n);r.set(t.view),t.buffer=n,t.view=r}return t},a.reverse=function(e,t){var n=this;if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=n.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=n.limit),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>n.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+n.buffer.byteLength)}return e===t||Array.prototype.reverse.call(n.view.subarray(e,t)),n},a.skip=function(e){var t=this;if(!t.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var n=t.offset+e;if(!t.noAssert&&(n<0||n>t.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+t.offset+" + "+e+" <= "+t.buffer.byteLength);return t.offset=n,t},a.slice=function(e,t){var n=this;if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=n.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=n.limit),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>n.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+n.buffer.byteLength)}var r=n.clone();return r.offset=e,r.limit=t,r},a.toBuffer=function(e){var t=this,n=t.offset,r=t.limit;if(!t.noAssert){if((void 0===n?"undefined":J(n))!==b8e.TypeNumber||n%1!=0)throw TypeError("Illegal offset: Not an integer");if(n>>>=0,(void 0===r?"undefined":J(r))!==b8e.TypeNumber||r%1!=0)throw TypeError("Illegal limit: Not an integer");if(r>>>=0,n<0||r<n||r>t.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+n+" <= "+r+" <= "+t.buffer.byteLength)}if(!e&&0===n&&r===t.buffer.byteLength)return t.buffer;if(n===r)return s;var i=new ArrayBuffer(r-n);return new Uint8Array(i).set(new Uint8Array(t.buffer).subarray(n,r),0),i},a.toArrayBuffer=a.toBuffer,a.toString=function(e,t,n){if((void 0===e?"undefined":J(e))===b8e.TypeUndefined)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";(void 0===e?"undefined":J(e))===b8e.TypeNumber&&(n=t=e="utf8");var r=this;switch(e){case"utf8":return r.toUTF8(t,n);case"base64":return r.toBase64(t,n);case"hex":return r.toHex(t,n);case"binary":return r.toBinary(t,n);case"debug":return r.toDebug();case"columns":return r.toColumns();default:throw Error("Unsupported encoding: "+e)}};var g=function(){for(var e={},i=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],a=[],t=0,n=i.length;t<n;++t)a[i[t]]=t;return e.encode=function(e,t){for(var n=void 0,r=void 0;null!==(n=e());)t(i[n>>2&63]),r=(3&n)<<4,null!==(n=e())?(t(i[63&((r|=n>>4&15)|n>>4&15)]),r=(15&n)<<2,null!==(n=e())?(t(i[63&(r|n>>6&3)]),t(i[63&n])):(t(i[63&r]),t(61))):(t(i[63&r]),t(61),t(61))},e.decode=function(e,t){var n=void 0,r=void 0,i=void 0;function o(e){throw Error("Illegal character code: "+e)}for(;null!==(n=e());)if((void 0===(r=a[n])?"undefined":J(r))===b8e.TypeUndefined&&o(n),null!==(n=e())&&((void 0===(i=a[n])?"undefined":J(i))===b8e.TypeUndefined&&o(n),t(r<<2>>>0|(48&i)>>4),null!==(n=e()))){if((void 0===(r=a[n])?"undefined":J(r))===b8e.TypeUndefined){if(61===n)break;o(n)}if(t((15&i)<<4>>>0|(60&r)>>2),null!==(n=e())){if((void 0===(i=a[n])?"undefined":J(i))===b8e.TypeUndefined){if(61===n)break;o(n)}t((3&r)<<6>>>0|i)}}},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)},e}();a.toBase64=function(e,t){var n=this;if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=n.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=n.limit),t|=0,(e|=0)<0||t>n.capacity||t<e)throw RangeError("begin, end");var r=void 0;return g.encode(function(){return e<t?n.view[e++]:null}.bind(n),r=c()),r()},p.fromBase64=function(e,t){if("string"!=typeof e)throw TypeError("str");var n=new p(e.length/4*3,t),r=0;return g.decode(l(e),function(e){n.view[r++]=e}),n.limit=r,n},p.btoa=function(e){return p.fromBinary(e).toBase64()},p.atob=function(e){return p.fromBase64(e).toBinary()},a.toBinary=function(e,t){if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=this.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||t<e)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];e<t;)n.push(this.view[e++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},p.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n=0,r=e.length,i=void 0,o=new p(r,t);n<r;){if(255<(i=e.charCodeAt(n)))throw RangeError("illegal char code: "+i);o.view[n++]=i}return o.limit=r,o},a.toDebug=function(e){for(var t=this,n=-1,r=t.buffer.byteLength,i=void 0,o="",a="",s="";n<r;){if(-1!==n&&(o+=(i=t.view[n])<16?"0"+i.toString(16).toUpperCase():i.toString(16).toUpperCase(),e&&(a+=32<i&&i<127?String.fromCharCode(i):".")),++n,e&&0<n&&n%16==0&&n!==r){for(;o.length<51;)o+=" ";s+=o+a+"\n",o=a=""}n===t.offset&&n===t.limit?o+=n===t.markedOffset?"!":"|":n===t.offset?o+=n===t.markedOffset?"[":"<":n===t.limit?o+=n===t.markedOffset?"]":">":o+=n===t.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==o){for(;o.length<51;)o+=" ";s+=o+a+"\n"}return e?s:o},p.fromDebug=function(e,t,n){for(var r=e.length,i=new p((r+1)/3|0,t,n),o=0,a=0,s=void 0,l=void 0,u=!1,f=!1,c=!1,d=!1,h=!1;o<r;){switch(s=e.charAt(o++)){case"!":if(!n){if(f||c||d){h=!0;break}f=c=d=!0}i.offset=i.markedOffset=i.limit=a,u=!1;break;case"|":if(!n){if(f||d){h=!0;break}f=d=!0}i.offset=i.limit=a,u=!1;break;case"[":if(!n){if(f||c){h=!0;break}f=c=!0}i.offset=i.markedOffset=a,u=!1;break;case"<":if(!n){if(f){h=!0;break}f=!0}i.offset=a,u=!1;break;case"]":if(!n){if(d||c){h=!0;break}d=c=!0}i.limit=i.markedOffset=a,u=!1;break;case">":if(!n){if(d){h=!0;break}d=!0}i.limit=a,u=!1;break;case"'":if(!n){if(c){h=!0;break}c=!0}i.markedOffset=a,u=!1;break;case" ":u=!1;break;default:if(!n&&u){h=!0;break}if(l=parseInt(s+e.charAt(o++),16),!n&&(isNaN(l)||l<0||255<l))throw TypeError("Illegal str: Not a debug encoded string");i.view[a++]=l,u=!0}if(h)throw TypeError("Illegal str: Invalid symbol at "+o)}if(!n){if(!f||!d)throw TypeError("Illegal str: Missing offset or limit");if(a<i.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+a+" < "+r)}return i},a.toHex=function(e,t){var n=this;if(e=(void 0===e?"undefined":J(e))===b8e.TypeUndefined?n.offset:e,t=(void 0===t?"undefined":J(t))===b8e.TypeUndefined?n.limit:t,!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>n.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+n.buffer.byteLength)}for(var r=new Array(t-e),i=void 0;e<t;)(i=n.view[e++])<16?r.push("0",i.toString(16)):r.push(i.toString(16));return r.join("")},p.fromHex=function(e,t,n){if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r=e.length,i=new p(r/2|0,t),o=void 0,a=0,s=0;a<r;a+=2){if(o=parseInt(e.substring(a,a+2),16),!n&&(!isFinite(o)||o<0||255<o))throw TypeError("Illegal str: Contains non-hex characters");i.view[s++]=o}return i.limit=j,i};var b=function(){var r={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for((void 0===e?"undefined":J(e))===b8e.TypeNumber&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):(n<2048?t(n>>6&31|192):(n<65536?t(n>>12&15|224):(t(n>>18&7|240),t(n>>12&63|128)),t(n>>6&63|128)),t(63&n|128)),n=null},decodeUTF8:function(e,t){for(var n=void 0,r=void 0,i=void 0,o=void 0,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&a([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))null!==(r=e())&&null!==(i=e())||a([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=e())&&null!==(i=e())&&null!==(o=e())||a([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var n=void 0,r=null;null!==(n=null!==r?r:e());)55296<=n&&n<=57343&&null!==(r=e())&&56320<=r&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for((void 0===e?"undefined":J(e))===b8e.TypeNumber&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(e,t){r.UTF16toUTF8(e,function(e){r.encodeUTF8(e,t)})},decodeUTF8toUTF16:function(e,t){r.decodeUTF8(e,function(e){r.UTF8toUTF16(e,t)})},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t=void 0,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(e){var t=0,n=0;return r.UTF16toUTF8(e,function(e){++t,n+=e<128?1:e<2048?2:e<65536?3:4}),[t,n]}};return r}();return a.toUTF8=function(e,t){var n=this;if((void 0===e?"undefined":J(e))===b8e.TypeUndefined&&(e=n.offset),(void 0===t?"undefined":J(t))===b8e.TypeUndefined&&(t=n.limit),!n.noAssert){if((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,(void 0===t?"undefined":J(t))!==b8e.TypeNumber||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>n.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+n.buffer.byteLength)}var r=void 0;if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t);return b.decodeUTF8toUTF16(function(){return e<t?this.view[e++]:null}.bind(n),r=c()),r()},p.fromUTF8=function(e,t,n){if(!n&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var r=new p(b.calculateUTF16asUTF8(l(e),!0)[1],t,n),i=0;return b.encodeUTF16toUTF8(l(e),function(e){r.view[i++]=e}),r.limit=i,r},p})})();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e=b8e.bytebuffer;b8e.ProtoByteBuffer=e,b8e.protobuf=function(w){"use strict";var r={};return r.ByteBuffer=w,r.Long=w.Long||null,r.VERSION="5.0.3",r.WIRE_TYPES={},r.WIRE_TYPES.VARINT=0,r.WIRE_TYPES.BITS64=1,r.WIRE_TYPES.LDELIM=2,r.WIRE_TYPES.STARTGROUP=3,r.WIRE_TYPES.ENDGROUP=4,r.WIRE_TYPES.BITS32=5,r.PACKABLE_WIRE_TYPES=[r.WIRE_TYPES.VARINT,r.WIRE_TYPES.BITS64,r.WIRE_TYPES.BITS32],r.TYPES={int32:{name:"int32",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},uint64:{name:"uint64",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},sint64:{name:"sint64",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},bool:{name:"bool",wireType:r.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:r.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:r.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:r.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:r.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:r.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:r.WIRE_TYPES.BITS64,defaultValue:0},sfixed64:{name:"sfixed64",wireType:r.WIRE_TYPES.BITS64,defaultValue:0},float:{name:"float",wireType:r.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:r.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:r.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:r.WIRE_TYPES.STARTGROUP,defaultValue:null}},r.MAP_KEY_TYPES=[r.TYPES.int32,r.TYPES.sint32,r.TYPES.sfixed32,r.TYPES.uint32,r.TYPES.fixed32,r.TYPES.int64,r.TYPES.sint64,r.TYPES.sfixed64,r.TYPES.uint64,r.TYPES.fixed64,r.TYPES.bool,r.TYPES.string,r.TYPES.bytes],r.ID_MIN=1,r.ID_MAX=536870911,r.convertFieldsToCamelCase=!0,r.populateAccessors=!0,r.populateDefaults=!0,r.Util=function(){var e={toCamelCase:function(e){return e.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()})}};return e}(),r.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,FQTYPEREF:/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},r.DotProto=function(o,l){function t(e){var t=this;t.source=e+"",t.index=0,t.line=1,t.stack=[],t._stringOpen=null}var e={},n=t.prototype;n._readString=function(){var e=this,t='"'===e._stringOpen?l.STRING_DQ:l.STRING_SQ;t.lastIndex=e.index-1;var n=t.exec(e.source);if(!n)throw Error("unterminated string");e.index=t.lastIndex;var r=e.stack;return r[r.length]=e._stringOpen,e._stringOpen=null,n[1]},n.next=function(){var e=this;if(0<e.stack.length)return e.stack.shift();if(e.index>=e.source.length)return null;if(null!==e._stringOpen)return e._readString();var t=void 0,n=void 0,r=void 0;do{for(t=!1;l.WHITESPACE.test(r=e.source.charAt(e.index));)if("\n"===r&&++e.line,++e.index===e.source.length)return null;if("/"===e.source.charAt(e.index))if(++e.index,"/"===e.source.charAt(e.index)){for(;"\n"!==e.source.charAt(++e.index);)if(e.index==e.source.length)return null;++e.index,++e.line,t=!0}else{if("*"!==(r=e.source.charAt(e.index)))return"/";do{if("\n"===r&&++e.line,++e.index===e.source.length)return null;n=r,r=e.source.charAt(e.index)}while("*"!==n||"/"!==r);++e.index,t=!0}}while(t);if(e.index===e.source.length)return null;var i=e.index;if(l.DELIM.lastIndex=0,!l.DELIM.test(e.source.charAt(i++)))for(;i<e.source.length&&!l.DELIM.test(e.source.charAt(i));)++i;var o=e.source.substring(e.index,e.index=i);return'"'!==o&&"'"!==o||(e._stringOpen=o),o},n.peek=function(){var e=this.stack;if(0===e.length){var t=this.next();if(null===t)return null;e[e.length]=t}return e[0]},n.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},n.omit=function(e){return this.peek()===e&&(this.next(),!0)},n.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},e.Tokenizer=t;function r(e){this.tn=new t(e),this.proto3=!1}var i=r.prototype;function u(e,t){var n=-1,r=1;if("-"==e.charAt(0)&&(r=-1,e=e.substring(1)),l.NUMBER_DEC.test(e))n=+e;else if(l.NUMBER_HEX.test(e))n=parseInt(e.substring(2),16);else{if(!l.NUMBER_OCT.test(e))throw Error("illegal id value: "+(r<0?"-":"")+e);n=parseInt(e.substring(1),8)}if(n=r*n|0,!t&&n<0)throw Error("illegal id value: "+(r<0?"-":"")+e);return n}function a(e){var t=1;if("-"==e.charAt(0)&&(t=-1,e=e.substring(1)),l.NUMBER_DEC.test(e))return t*e;if(l.NUMBER_HEX.test(e))return t*parseInt(e.substring(2),16);if(l.NUMBER_OCT.test(e))return t*parseInt(e.substring(1),8);if("inf"===e)return t*(1/0);if("nan"===e)return NaN;if(l.NUMBER_FLT.test(e))return t*e;throw Error("illegal number value: "+(t<0?"-":"")+e)}function s(e,t,n){if(J(e[t])===b8e.TypeUndefined)e[t]=n;else{Array.isArray(e[t])||(e[t]=[e[t]]);var r=e[t];r[r.length]=n}}return i.parse=function(){for(var e={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},t=void 0,n=!0,r=void 0,i=this;t=i.tn.next();)switch(t){case"package":if(!n||null!==e.package)throw Error("unexpected 'package'");if(t=i.tn.next(),!l.TYPEREF.test(t))throw Error("illegal package name: "+t);i.tn.skip(";"),e.package=t;break;case"import":if(!n)throw Error("unexpected 'import'");if("public"!==(t=i.tn.peek())&&!(r="weak"===t)||i.tn.next(),t=i._readString(),i.tn.skip(";"),!r){var o=e.imports;o[o.length]=t}break;case"syntax":if(!n)throw Error("unexpected 'syntax'");i.tn.skip("="),"proto3"===(e.syntax=i._readString())&&(i.proto3=!0),i.tn.skip(";");break;case"message":i._parseMessage(e,null),n=!1;break;case"enum":i._parseEnum(e),n=!1;break;case"option":i._parseOption(e);break;case"service":i._parseService(e);break;case"extend":i._parseExtend(e);break;default:throw Error("unexpected "+i.tn.line+": '"+t+"'")}return delete e.name,e},r.parse=function(e){return new r(e).parse()},i._readString=function(){var e="",t=void 0,n=void 0;do{if("'"!==(n=this.tn.next())&&'"'!==n)throw Error("illegal string delimiter: "+n);e+=this.tn.next(),this.tn.skip(n),t=this.tn.peek()}while('"'===t||'"'===t);return e},i._readValue=function(e){var t=this.tn.peek();if('"'===t||"'"===t)return this._readString();if(this.tn.next(),l.NUMBER.test(t))return a(t);if(l.BOOL.test(t))return"true"===t.toLowerCase();if(e&&l.TYPEREF.test(t))return t;throw Error("illegal value: "+t)},i._parseOption=function(e,t){var n=this,r=n.tn.next(),i=!1;if("("===r&&(i=!0,r=n.tn.next()),!l.TYPEREF.test(r))throw Error("illegal option name: "+r);var o=r;i&&(n.tn.skip(")"),o="("+o+")",r=n.tn.peek(),l.FQTYPEREF.test(r)&&(o+=r,n.tn.next())),n.tn.skip("="),n._parseOptionValue(e,o),t||n.tn.skip(";")},i._parseOptionValue=function(e,t){var n=this,r=n.tn.peek();if("{"!==r)s(e.options,t,n._readValue(!0));else for(n.tn.skip("{");"}"!==(r=n.tn.next());){if(!l.NAME.test(r))throw Error("illegal option name: "+t+"."+r);n.tn.omit(":")?s(e.options,t+"."+r,n._readValue(!0)):n._parseOptionValue(e,t+"."+r)}},i._parseService=function(e){var t=this,n=t.tn.next();if(!l.NAME.test(n))throw Error("illegal service name at line "+t.tn.line+": "+n);var r={name:n,rpc:{},options:{}};for(t.tn.skip("{");"}"!==(n=t.tn.next());)if("option"===n)t._parseOption(r);else{if("rpc"!==n)throw Error("illegal service token: "+n);t._parseServiceRPC(r)}t.tn.omit(";");var i=e.services;i[i.length]=r},i._parseServiceRPC=function(e){var t=this,n=t.tn.next();if(!l.NAME.test(n))throw Error("illegal rpc service method name: "+n);var r=n,i={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(t.tn.skip("("),"stream"===(n=t.tn.next()).toLowerCase()&&(i.request_stream=!0,n=t.tn.next()),!l.TYPEREF.test(n))throw Error("illegal rpc service request type: "+n);if(i.request=n,t.tn.skip(")"),"returns"!==(n=t.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+n);if(t.tn.skip("("),"stream"===(n=t.tn.next()).toLowerCase()&&(i.response_stream=!0,n=t.tn.next()),i.response=n,t.tn.skip(")"),"{"===(n=t.tn.peek())){for(t.tn.next();"}"!==(n=t.tn.next());){if("option"!==n)throw Error("illegal rpc service token: "+n);t._parseOption(i)}t.tn.omit(";")}else t.tn.skip(";");J(e.rpc)===b8e.TypeUndefined&&(e.rpc={}),e.rpc[r]=i},i._parseMessage=function(e,t){var n=this,r=!!t,i=n.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!l.NAME.test(i))throw Error("illegal "+(r?"group":"message")+" name: "+i);for(o.name=i,r&&(n.tn.skip("="),t.id=u(n.tn.next()),o.isGroup=!0),"["===(i=n.tn.peek())&&t&&n._parseFieldOptions(t),n.tn.skip("{");"}"!==(i=this.tn.next());)if(l.RULE.test(i))n._parseMessageField(o,i);else if("oneof"===i)n._parseMessageOneOf(o);else if("enum"===i)n._parseEnum(o);else if("message"===i)n._parseMessage(o);else if("option"===i)n._parseOption(o);else if("service"===i)n._parseService(o);else if("extensions"===i)o.hasOwnProperty("extensions")?o.extensions=o.extensions.concat(n._parseExtensionRanges()):o.extensions=n._parseExtensionRanges();else if("reserved"===i)n._parseIgnored();else if("extend"===i)n._parseExtend(o);else{if(!l.TYPEREF.test(i))throw Error("illegal message token: "+i);if(!n.proto3)throw Error("illegal field rule: "+i);n._parseMessageField(o,"optional",i)}n.tn.omit(";");var a=e.messages;return a[a.length]=o},i._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},i._parseMessageField=function(e,t,n){var r=this;if(!l.RULE.test(t))throw Error("illegal message field rule: "+t);var i={rule:t,type:"",name:"",options:{},id:0},o=void 0;if("map"===t){if(n)throw Error("illegal type: "+n);if(r.tn.skip("<"),o=r.tn.next(),!l.TYPE.test(o)&&!l.TYPEREF.test(o))throw Error("illegal message field type: "+o);if(i.keytype=o,r.tn.skip(","),o=r.tn.next(),!l.TYPE.test(o)&&!l.TYPEREF.test(o))throw Error("illegal message field: "+o);if(i.type=o,r.tn.skip(">"),o=r.tn.next(),!l.NAME.test(o))throw Error("illegal message field name: "+o);i.name=o,r.tn.skip("="),i.id=u(r.tn.next()),"["===(o=r.tn.peek())&&r._parseFieldOptions(i),r.tn.skip(";")}else if("group"===(n=(void 0===n?"undefined":J(n))!==b8e.TypeUndefined?n:r.tn.next())){var a=r._parseMessage(e,i);if(!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);i.type=a.name,i.name=a.name.toLowerCase(),r.tn.omit(";")}else{if(!l.TYPE.test(n)&&!l.TYPEREF.test(n))throw Error("illegal message field type: "+n);if(i.type=n,o=r.tn.next(),!l.NAME.test(o))throw Error("illegal message field name: "+o);i.name=o,r.tn.skip("="),i.id=u(r.tn.next()),"["===(o=r.tn.peek())&&r._parseFieldOptions(i),r.tn.skip(";")}var s=e.fields;return s[s.length]=i},i._parseMessageOneOf=function(e){var t=this,n=t.tn.next();if(!l.NAME.test(n))throw Error("illegal oneof name: "+n);var r=n,i=void 0,o=[];for(t.tn.skip("{");"}"!==(n=t.tn.next());)(i=t._parseMessageField(e,"optional",n)).oneof=r,o[o.length]=i.id;t.tn.omit(";"),e.oneofs[r]=o},i._parseFieldOptions=function(e){var t=this;t.tn.skip("[");for(var n=!0;"]"!==t.tn.peek();)n||t.tn.skip(","),t._parseOption(e,!0),n=!1;t.tn.next()},i._parseEnum=function(e){var t={name:"",values:[],options:{}},n=this,r=n.tn.next();if(!l.NAME.test(r))throw Error("illegal name: "+r);for(t.name=r,n.tn.skip("{");"}"!==(r=n.tn.next());)if("option"===r)n._parseOption(t);else{if(!l.NAME.test(r))throw Error("illegal name: "+r);n.tn.skip("=");var i={name:r,id:u(n.tn.next(),!0)};"["===(r=n.tn.peek())&&n._parseFieldOptions({options:{}}),n.tn.skip(";");var o=t.values;o[o.length]=i}n.tn.omit(";");var a=e.enums;a[a.length]=t},i._parseExtensionRanges=function(){var e=this,t=[],n=void 0,r=void 0,i=void 0;do{for(r=[];;){switch(n=e.tn.next()){case"min":i=o.ID_MIN;break;case"max":i=o.ID_MAX;break;default:i=a(n)}if(r[r.length]=i,2===r.length)break;if("to"!==e.tn.peek()){r[r.length]=i;break}e.tn.next()}t[t.length]=r}while(e.tn.omit(","));return e.tn.skip(";"),t},i._parseExtend=function(e){var t=this,n=t.tn.next();if(!l.TYPEREF.test(n))throw Error("illegal extend reference: "+n);var r={ref:n,fields:[]};for(t.tn.skip("{");"}"!==(n=t.tn.next());)if(l.RULE.test(n))t._parseMessageField(r,n);else{if(!l.TYPEREF.test(n))throw Error("illegal extend token: "+n);if(!t.proto3)throw Error("illegal field rule: "+n);t._parseMessageField(r,"optional",n)}t.tn.omit(";");var i=e.messages;return i[i.length]=r},i.toString=function(){return"Parser at line "+this.tn.line},e.Parser=r,e}(r,r.Lang),r.Reflect=function(g){function f(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className}var a={},e=f.prototype;e.fqn=function(){for(var e=this.name,t=this;;){if(null==(t=t.parent))break;e=t.name+"."+e}return e},e.toString=function(e){return(e?this.className+" ":"")+this.fqn()},e.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},a.T=f;function s(e,t,n,r,i){f.call(this,e,t,n);var o=this;o.className="Namespace",o.children=[],o.nsChildren=[],o.childByName={},o.options=r||{},o.syntax=i||"proto2"}var t=s.prototype=Object.create(f.prototype);t.getChildren=function(e){if(null==(e=e||null))return this.children;for(var t=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof e&&(t[t.length]=this.children[n]);return t},t.addChild=function(e){var t=void 0;if(t=this.getChild(e.name))if(t instanceof d.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof d.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}var n=this.children;(n[n.length]=e)instanceof s&&((n=this.nsChildren)[n.length]=e),this.childByName[e.name]=e},t.getChild=function(e){return this.childByName[e]||null},t.resolve=function(e,t){var n="string"==typeof e?e.split("."):e,r=this,i=0;if(""===n[i]){for(;null!==r.parent;)r=r.parent;i++}var o=void 0;do{do{if(!(r instanceof a.Namespace)){r=null;break}if(!(o=r.getChild(n[i]))||!(o instanceof a.T)||t&&!(o instanceof a.Namespace)){r=null;break}r=o,i++}while(i<n.length);if(null!=r)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=r);return r},t.qn=function(e){for(var t=[],n=e;t.unshift(n.name),null!==(n=n.parent););for(var r=1;r<=t.length;r++){var i=t.slice(t.length-r);if(e===this.resolve(i,e instanceof a.Namespace))return i.join(".")}return e.fqn()},t.build=function(){for(var e,t={},n=this.nsChildren,r=0,i=n.length;r<i;++r)t[(e=n[r]).name]=e.build();return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},t.buildOpt=function(){for(var e={},t=Object.keys(this.options),n=0,r=t.length;n<r;++n){var i=t[n],o=this.options[t[n]];e[i]=o}return e},t.getOption=function(e){return(void 0===e?"undefined":J(e))===b8e.TypeUndefined?this.options:J(this.options[e])!==b8e.TypeUndefined?this.options[e]:null},a.Namespace=s;function c(e,t,n,r,i){if(this.type=e,this.resolvedType=t,this.isMapKey=n,this.syntax=r,this.name=i,n&&g.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)}var r=c.prototype;c.defaultFieldValue=function(e){if("string"==typeof e&&(e=g.TYPES[e]),J(e.defaultValue)===b8e.TypeUndefined)throw Error("default value for type "+e.name+" is not supported");return e==g.TYPES.bytes?new w(0):e.defaultValue},r.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},r.verifyValue=function(e){var n=this;function t(e,t){b8e.warn("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}switch(this.type){case g.TYPES.int32:case g.TYPES.sint32:case g.TYPES.sfixed32:return((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e==e&&e%1!=0)&&(t(void 0===e?"undefined":J(e),"not an integer"),e=+e),4294967295<e?0|e:e;case g.TYPES.uint32:case g.TYPES.fixed32:return((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e==e&&e%1!=0)&&(t(void 0===e?"undefined":J(e),"not an integer"),e=+e),e<0?e>>>0:e;case g.TYPES.int64:case g.TYPES.sint64:case g.TYPES.sfixed64:return((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e==e&&e%1!=0)&&(t(void 0===e?"undefined":J(e),"not an integer"),e=+e),e;case g.TYPES.uint64:case g.TYPES.fixed64:return((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e==e&&e%1!=0)&&(t(void 0===e?"undefined":J(e),"not an integer"),e=+e),e;case g.TYPES.bool:return"boolean"!=typeof e&&t(void 0===e?"undefined":J(e),"not a boolean"),e;case g.TYPES.float:case g.TYPES.double:return(void 0===e?"undefined":J(e))!==b8e.TypeNumber&&t(void 0===e?"undefined":J(e),"not a number"),e;case g.TYPES.string:return"string"==typeof e||e&&e instanceof String||t(void 0===e?"undefined":J(e),"not a string"),""+e;case g.TYPES.bytes:return w.isByteBuffer(e)?e:w.wrap(e,"base64");case g.TYPES.enum:for(var r=this.resolvedType.getChildren(g.Reflect.Enum.Value),i=0;i<r.length;i++){if(r[i].name==e)return r[i].id;if(r[i].id==e)return r[i].id}if("proto3"===this.syntax)return((void 0===e?"undefined":J(e))!==b8e.TypeNumber||e==e&&e%1!=0)&&(t(void 0===e?"undefined":J(e),"not an integer"),e=+e),(4294967295<e||e<0)&&t(void 0===e?"undefined":J(e),"not in range for uint32"),e;t(e,"not a valid enum value");case g.TYPES.group:case g.TYPES.message:if(e&&(void 0===e?"undefined":J(e))===b8e.TypeObject||t(void 0===e?"undefined":J(e),"object expected"),e instanceof this.resolvedType.clazz)return e;if(e instanceof g.Builder.Message){var o={};for(var a in e)e.hasOwnProperty(a)&&(o[a]=e[a]);e=o}return new this.resolvedType.clazz(e)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+e+" (undefined type "+this.type+")")},r.calculateLength=function(e,t){if(null===t)return 0;var n=void 0;switch(this.type){case g.TYPES.int32:return t<0?w.calculateVarint64(t):w.calculateVarint32(t);case g.TYPES.uint32:return w.calculateVarint32(t);case g.TYPES.sint32:return w.calculateVarint32(w.zigZagEncode32(t));case g.TYPES.fixed32:case g.TYPES.sfixed32:case g.TYPES.float:return 4;case g.TYPES.int64:case g.TYPES.uint64:return w.calculateVarint64(t);case g.TYPES.sint64:return w.calculateVarint64(w.zigZagEncode64(t));case g.TYPES.fixed64:case g.TYPES.sfixed64:return 8;case g.TYPES.bool:return 1;case g.TYPES.enum:return w.calculateVarint32(t);case g.TYPES.double:return 8;case g.TYPES.string:return n=w.calculateUTF8Bytes(t),w.calculateVarint32(n)+n;case g.TYPES.bytes:if(t.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+t.remaining()+" bytes remaining");return w.calculateVarint32(t.remaining())+t.remaining();case g.TYPES.message:return n=this.resolvedType.calculate(t),w.calculateVarint32(n)+n;case g.TYPES.group:return(n=this.resolvedType.calculate(t))+w.calculateVarint32(e<<3|g.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+t+" (unknown type)")},r.encodeValue=function(e,t,n){if(null===t)return n;switch(this.type){case g.TYPES.int32:t<0?n.writeVarint64(t):n.writeVarint32(t);break;case g.TYPES.uint32:n.writeVarint32(t);break;case g.TYPES.sint32:n.writeVarint32ZigZag(t);break;case g.TYPES.fixed32:n.writeUint32(t);break;case g.TYPES.sfixed32:n.writeInt32(t);break;case g.TYPES.int64:case g.TYPES.uint64:n.writeVarint64(t);break;case g.TYPES.sint64:n.writeVarint64ZigZag(t);break;case g.TYPES.fixed64:n.writeUint64(t);break;case g.TYPES.sfixed64:n.writeInt64(t);break;case g.TYPES.bool:"string"==typeof t?n.writeVarint32("false"===t.toLowerCase()?0:!!t):n.writeVarint32(t?1:0);break;case g.TYPES.enum:n.writeVarint32(t);break;case g.TYPES.float:n.writeFloat32(t);break;case g.TYPES.double:n.writeFloat64(t);break;case g.TYPES.string:n.writeVString(t);break;case g.TYPES.bytes:if(t.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+t.remaining()+" bytes remaining");var r=t.offset;n.writeVarint32(t.remaining()),n.append(t),t.offset=r;break;case g.TYPES.message:var i=(new w).LE();this.resolvedType.encode(t,i),n.writeVarint32(i.offset),n.append(i.flip());break;case g.TYPES.group:this.resolvedType.encode(t,n),n.writeVarint32(e<<3|g.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+t+" (unknown type)")}return n},r.decode=function(e,t,n){if(t!=this.type.wireType)throw Error("Unexpected wire type for element");var r=void 0,i=void 0;switch(this.type){case g.TYPES.int32:return 0|e.readVarint32();case g.TYPES.uint32:return e.readVarint32()>>>0;case g.TYPES.sint32:return 0|e.readVarint32ZigZag();case g.TYPES.fixed32:return e.readUint32()>>>0;case g.TYPES.sfixed32:return 0|e.readInt32();case g.TYPES.int64:return e.readVarint64().toNumber();case g.TYPES.uint64:return e.readVarint64().toUnsigned().toNumber();case g.TYPES.sint64:return e.readVarint64ZigZag().toNumber();case g.TYPES.fixed64:return e.readUint64().toNumber();case g.TYPES.sfixed64:return e.readInt64().toNumber();case g.TYPES.bool:return!!e.readVarint32();case g.TYPES.enum:return e.readVarint32();case g.TYPES.float:return e.readFloat();case g.TYPES.double:return e.readDouble();case g.TYPES.string:return e.readVString();case g.TYPES.bytes:if(i=e.readVarint32(),e.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+e.remaining());return(r=e.clone()).limit=r.offset+i,e.offset+=i,r;case g.TYPES.message:return i=e.readVarint32(),this.resolvedType.decode(e,i);case g.TYPES.group:return this.resolvedType.decode(e,-1,n)}throw Error("[INTERNAL] Illegal decode type")},r.valueFromString=function(e){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case g.TYPES.int32:case g.TYPES.sint32:case g.TYPES.sfixed32:case g.TYPES.uint32:case g.TYPES.fixed32:return this.verifyValue(+e);case g.TYPES.int64:case g.TYPES.sint64:case g.TYPES.sfixed64:case g.TYPES.uint64:case g.TYPES.fixed64:return this.verifyValue(+e);case g.TYPES.bool:return"true"===e;case g.TYPES.string:return this.verifyValue(e);case g.TYPES.bytes:return w.fromBinary(e)}},r.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===g.TYPES.bytes?e.toString("binary"):e.toString()},a.Element=c;var d=function(e,t,n,r,i,o){s.call(this,e,t,n,r,o),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null},i=d.prototype=Object.create(s.prototype);function b(e,t){var n=t.readVarint32(),r=7&n,i=n>>>3;switch(r){case g.WIRE_TYPES.VARINT:for(;128==(128&(n=t.readUint8())););break;case g.WIRE_TYPES.BITS64:t.offset+=8;break;case g.WIRE_TYPES.LDELIM:n=t.readVarint32(),t.offset+=n;break;case g.WIRE_TYPES.STARTGROUP:b(i,t);break;case g.WIRE_TYPES.ENDGROUP:if(i===e)return;throw Error("Illegal GROUPEND after unknown group: "+i+" ("+e+" expected)");case g.WIRE_TYPES.BITS32:t.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+r)}return 1}i.build=function(e){if(this.clazz&&!e)return this.clazz;var t=function(c,d){function h(e,t){c.Builder.Message.call(this);for(var n=0,r=v.length;n<r;++n)this[v[n].name]=null;for(var i=0,o=p.length;i<o;++i){var a=p[i];this[a.name]=a.repeated?[]:a.map?new c.Map(a):null,!a.required&&"proto3"!==d.syntax||null===a.defaultValue||(this[a.name]=a.defaultValue)}var s=arguments.length;if(0<s){var l=void 0;if(1!==s||null===e||(void 0===e?"undefined":J(e))!==b8e.TypeObject||!(J(e.encode)!==b8e.TypeFunction||e instanceof h)||Array.isArray(e)||e instanceof c.Map||w.isByteBuffer(e)||e instanceof ArrayBuffer||c.Long&&e instanceof c.Long)for(var u=0,f=s;u<f;++u)J(l=arguments[u])!==b8e.TypeUndefined&&this.$set(p[u].name,l);else this.$set(e)}}var p=d.getChildren(c.Reflect.Message.Field),v=d.getChildren(c.Reflect.Message.OneOf),u=h.prototype=Object.create(c.Builder.Message.prototype);u.add=function(e,t,n){var r=d._fieldsByName[e];if(!n){if(!r)throw Error(this+"#"+e+" is undefined");if(!(r instanceof c.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+r.toString(!0));if(!r.repeated)throw Error(this+"#"+e+" is not a repeated field");t=r.verifyValue(t,!0)}var i=this[e];return null===i&&(i=this[e]=[]),i[i.length]=t,this},u.$add=u.add,u.set=function(e,t,n){if(e&&(void 0===e?"undefined":J(e))===b8e.TypeObject){for(var r in n=t,e)e.hasOwnProperty(r)&&J(t=e[r])!==b8e.TypeUndefined&&void 0===d._oneofsByName[r]&&this.$set(r,t,n);return this}var i=d._fieldsByName[e];if(n)this[e]=t;else{if(!i)throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof c.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));this[i.name]=t=i.verifyValue(t)}if(i&&i.oneof){var o=this[i.oneof.name];null!==t?(null!==o&&o!==i.name&&(this[o]=null),this[i.oneof.name]=i.name):o===e&&(this[i.oneof.name]=null)}return this},u.$set=u.set,u.get=function(e,t){if(t)return this[e];var n=d._fieldsByName[e];if(!(n&&n instanceof c.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(n instanceof c.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+n.toString(!0));return this[n.name]},u.$get=u.get;for(var e=0;e<p.length;e++){var t=p[e];t instanceof c.Reflect.Message.ExtensionField||d.builder.options.populateAccessors&&function(n){var e=n.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});e=e.substring(0,1).toUpperCase()+e.substring(1);function t(e,t){return this[n.name]=t?e:n.verifyValue(e),this}function r(){return this[n.name]}var i=n.originalName.replace(/([A-Z])/g,function(e){return"_"+e}),o="set"+e;null===d.getChild(o)&&(u[o]=t);var a="set_"+i;null===d.getChild(a)&&(u[a]=t);var s="get"+e;null===d.getChild(s)&&(u[s]=r);var l="get_"+i;null===d.getChild(l)&&(u[l]=r)}(t)}function g(e,n,r,i){if(null===e||(void 0===e?"undefined":J(e))!==b8e.TypeObject){if(i&&i instanceof c.Reflect.Enum){var t=c.Reflect.Enum.getName(i.object,e);if(null!==t)return t}return e}if(w.isByteBuffer(e))return n?e.toBase64():e.toBuffer();if(c.Long.isLong(e))return r?e.toString():c.Long.fromValue(e);var o=void 0;if(Array.isArray(e))return o=[],e.forEach(function(e,t){o[t]=g(e,n,r,i)}),o;if(o={},e instanceof c.Map){for(var a=e.entries(),s=a.next();!s.done;s=a.next())o[e.keyElem.valueToString(s.value[0])]=g(s.value[1],n,r,e.valueElem.resolvedType);return o}var l=e.$type,u=void 0;for(var f in e)e.hasOwnProperty(f)&&(l&&(u=l.getChild(f))?o[f]=g(e[f],n,r,u.resolvedType):o[f]=g(e[f],n,r));return o}u.encode=function(e,t){"boolean"==typeof e&&(t=e,e=void 0);var n=!1;e||(e=new w,n=!0);var r=e.littleEndian;return d.encode(this,e.LE(),t),(n?e.flip():e).LE(r)},h.encode=function(e,t,n){return new h(e).encode(t,n)},u.calculate=function(){return d.calculate(this)},u.encodeDelimited=function(e,t){var n=!1;e||(e=new w,n=!0);var r=(new w).LE();return d.encode(this,r,t).flip(),e.writeVarint32(r.remaining()),e.append(r),n?e.flip():e},u.encodeAB=function(){return this.encode().toArrayBuffer()},u.toArrayBuffer=u.encodeAB,u.encodeNB=function(){return this.encode().toBuffer()},u.toBuffer=u.encodeNB,u.encode64=function(){return this.encode().toBase64()},u.toBase64=u.encode64,u.encodeHex=function(){return this.encode().toHex()},u.toHex=u.encodeHex,u.toRaw=function(e,t){return g(this,!!e,!!t,this.$type)},u.encodeJSON=function(){return JSON.stringify(g(this,!0,!0,this.$type))},h.decode=function(e,t,n){"string"==typeof t&&(n=t,t=-1),"string"==typeof e?e=w.wrap(e,n||"base64"):w.isByteBuffer(e)||(e=w.wrap(e));var r=e.littleEndian,i=d.decode(e.LE(),t);return e.LE(r),i},h.decodeDelimited=function(e,t){if("string"==typeof e?e=w.wrap(e,t||"base64"):w.isByteBuffer(e)||(e=w.wrap(e)),e.remaining()<1)return null;var n=e.offset,r=e.readVarint32();if(e.remaining()<r)return e.offset=n,null;var i=d.decode(e.slice(e.offset,e.offset+r).LE());return e.offset+=r,i},h.decode64=function(e){return h.decode(e,"base64")},h.decodeHex=function(e){return h.decode(e,"hex")},h.decodeJSON=function(e){return new h(b8e.JsUtil.jsonParse(e))},u.toString=function(){return d.toString()};return Object.defineProperty&&(Object.defineProperty(h,"$options",{value:d.buildOpt()}),Object.defineProperty(u,"$options",{value:h.$options}),Object.defineProperty(h,"$type",{value:d}),Object.defineProperty(u,"$type",{value:d})),h}(g,this),n=this._fields=[];this._fieldsById={},this._fieldsByName={},this._oneofsByName={};for(var r,i=0,o=this.children.length;i<o;i++)if((r=this.children[i])instanceof h||r instanceof d||r instanceof y){if(t.hasOwnProperty(r.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+r.toString(!0)+" cannot override static property '"+r.name+"'");t[r.name]=r.build()}else if(r instanceof d.Field)r.build(),n[n.length]=r,this._fieldsById[r.id]=r,this._fieldsByName[r.name]=r;else if(r instanceof d.OneOf)this._oneofsByName[r.name]=r;else if(!(r instanceof d.OneOf||r instanceof v))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[i].toString(!0));return this.clazz=t},i.encode=function(e,t,n){for(var r,i=null,o=void 0,a=0,s=this._fields.length;a<s;++a)r=e[(o=this._fields[a]).name],o.required&&null===r?null===i&&(i=o):o.encode(n?r:o.verifyValue(r),t,e);if(null===i)return t;var l=Error("Missing at least one required field for "+this.toString(!0)+": "+i);throw l.encoded=t,l},i.calculate=function(e){for(var t,r,i=0,o=this._fields.length;i<o;++i){if(r=e[(t=this._fields[i]).name],t.required&&null===r)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);t.calculate(r,e)}return n},i.decode=function(u,e,t){(void 0===e?"undefined":J(e))!==b8e.TypeNumber&&(e=-1);for(var n=u.offset,f=new this.clazz,r=void 0,i=void 0,o=void 0,c=void 0;u.offset<n+e||-1===e&&0<u.remaining();){if(o=(r=u.readVarint32())>>>3,(i=7&r)===g.WIRE_TYPES.ENDGROUP){if(o!==t)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+o+" ("+(t?t+" expected":"not a group")+")");break}if(c=this._fieldsById[o]){if(c.repeated&&!c.options.packed)if(c.type===g.TYPES.string)(function(){c.__isLazyDecode=!0;var e=u.readVarint32(),t=u.offset;u.offset+=e;var s=c.name,l=s+"_",n=f[l]=f[l]||[];n[n.length]={offset:t,length:e},b8e.JsUtil.defineGetSetAccessor(f,s,function(){for(var e=f[l],t=e.length,n=[],r=0;r<t;r++){var i=e[r],o=i.offset,a=i.length;i=u.readUTF8String(a,w.METRICS_BYTES,o).string,n[n.length]=i}return e.length=0,delete c.__isLazyDecode,delete f[l],b8e.JsUtil.defineValue(f,s,n),n},function(e){delete c.__isLazyDecode,delete f[l],b8e.JsUtil.defineValue(f,s,e)},!1,!0)})();else{var a=f[c.name];a[a.length]=c.decode(i,u)}else if(c.map){var s=c.decode(i,u);f[c.name].set(s[0],s[1])}else if(c.type===g.TYPES.string?function(){c.__isLazyDecode=!0;var e=u.readVarint32(),t=u.offset;u.offset+=e;var r=c.name,i=r+"_";f[i]={offset:t,length:e},b8e.JsUtil.defineGetSetAccessor(f,r,function(){var e=f[i],t=e.offset,n=e.length;return e=u.readUTF8String(n,w.METRICS_BYTES,t).string,delete c.__isLazyDecode,delete f[i],b8e.JsUtil.defineValue(f,r,e),e},function(e){delete c.__isLazyDecode,delete f[i],b8e.JsUtil.defineValue(f,r,e)},!1,!0)}():f[c.name]=c.decode(i,u),c.oneof){var l=f[c.oneof.name];null!==l&&l!==c.name&&(f[l]=null),f[c.oneof.name]=c.name}}else switch(i){case g.WIRE_TYPES.VARINT:u.readVarint32();break;case g.WIRE_TYPES.BITS32:u.offset+=4;break;case g.WIRE_TYPES.BITS64:u.offset+=8;break;case g.WIRE_TYPES.LDELIM:var d=u.readVarint32();u.offset+=d;break;case g.WIRE_TYPES.STARTGROUP:for(;b(o,u););break;default:throw Error("Illegal wire type for unknown field "+o+" in "+this.toString(!0)+"#decode: "+i)}}for(var h=0,p=this._fields.length;h<p;++h)if(!(c=this._fields[h]).__isLazyDecode&&null===f[c.name])if("proto3"===this.syntax)f[c.name]=c.defaultValue;else{if(c.required){var v=Error("Missing at least one required field for "+this.toString(!0)+": "+c.name);throw v.decoded=f,v}g.populateDefaults&&null!==c.defaultValue&&(f[c.name]=c.defaultValue)}return f},a.Message=d;function l(e,t,n,r,i,o,a,s,l,u){f.call(this,e,t,o),this.className="Message.Field",this.required="required"===n,this.repeated="repeated"===n,this.map="map"===n,this.keyType=r||null,this.type=i,this.resolvedType=null,this.id=a,this.options=s||{},this.defaultValue=null,this.oneof=l||null,this.syntax=u||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof d.ExtensionField||(this.name=g.Util.toCamelCase(this.name)),this.name=b8e.getAliasName(this.name)}var o=l.prototype=Object.create(f.prototype);o.build=function(){this.element=new c(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new c(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?J(this.options.default)!==b8e.TypeUndefined&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=c.defaultFieldValue(this.type)},o.verifyValue=function(e,t){t=t||!1;var n=this;function r(e,t){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}if(null===e)return this.required&&r(void 0===e?"undefined":J(e),"required"),"proto3"===this.syntax&&this.type!==g.TYPES.message&&r(void 0===e?"undefined":J(e),"proto3 field without field presence cannot be null"),null;if(!this.repeated||t)return this.map&&!t?e instanceof g.Map?e:(e instanceof Object||r(void 0===e?"undefined":J(e),"expected ProtoBuf.Map or raw object for map field"),new g.Map(this,e)):(!this.repeated&&Array.isArray(e)&&r(void 0===e?"undefined":J(e),"no array expected"),this.element.verifyValue(e));Array.isArray(e)||(e=[e]);for(var i=[],o=0;o<e.length;o++)i[i.length]=this.element.verifyValue(e[o]);return i},o.encode=function(e,i,t){if(null===this.type||J(this.type)!==b8e.TypeObject)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return i;if(this.repeated)if(this.options.packed&&0<=g.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){i.writeVarint32(this.id<<3|g.WIRE_TYPES.LDELIM),i.ensureCapacity(i.offset+=1);for(var n=i.offset,r=0;r<e.length;r++)this.element.encodeValue(this.id,e[r],i);var o=i.offset-n,a=w.calculateVarint32(o);if(1<a){var s=i.slice(n,i.offset);n+=a-1,i.offset=n,i.append(s)}i.writeVarint32(o,n-a)}else for(var l=0;l<e.length;l++)i.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e[l],i);else this.map?e.forEach(function(e,t,n){var r=w.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,t)+w.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);i.writeVarint32(this.id<<3|g.WIRE_TYPES.LDELIM),i.writeVarint32(r),i.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,t,i),i.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,e,i)},this):(i.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e,i));return i},o.calculate=function(e,t){if(e=this.verifyValue(e),null===this.type||J(this.type)!==b8e.TypeObject)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return 0;var i=0;if(this.repeated){var n=void 0,r=void 0;if(this.options.packed&&0<=g.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){for(i+=w.calculateVarint32(this.id<<3|g.WIRE_TYPES.LDELIM),n=r=0;n<e.length;n++)r+=this.element.calculateLength(this.id,e[n]);i+=w.calculateVarint32(r),i+=r}else for(n=0;n<e.length;n++)i+=w.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,e[n])}else this.map?e.forEach(function(e,t,n){var r=w.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,t)+w.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);i+=w.calculateVarint32(this.id<<3|g.WIRE_TYPES.LDELIM),i+=w.calculateVarint32(r),i+=r},this):(i+=w.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,e));return i},o.decode=function(e,t,n){var r=void 0,i=void 0;if(!(!this.map&&e==this.type.wireType||!n&&this.repeated&&this.options.packed&&e==g.WIRE_TYPES.LDELIM||this.map&&e==g.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==g.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&0<=g.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)&&!n){i=t.readVarint32(),i=t.offset+i;for(var o=[];t.offset<i;)o[o.length]=this.decode(this.type.wireType,t,!0);return o}if(this.map){var a=c.defaultFieldValue(this.keyType);if(r=c.defaultFieldValue(this.type),i=t.readVarint32(),t.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+t.remaining());var s=t.clone();for(s.limit=s.offset+i,t.offset+=i;0<s.remaining();){var l=s.readVarint32();e=7&l;var u=l>>>3;if(1==u)a=this.keyElement.decode(s,e,u);else{if(2!=u)throw Error("Unexpected tag in map field key/value submessage");r=this.element.decode(s,e,u)}}return[a,r]}return this.element.decode(t,e,this.id)},a.Message.Field=l;function u(e,t,n,r,i,o,a){l.call(this,e,t,n,null,r,i,o,a),this.extension}u.prototype=Object.create(l.prototype),a.Message.ExtensionField=u;a.Message.OneOf=function(e,t,n){f.call(this,e,t,n),this.fields=[]};var h=function(e,t,n,r,i){s.call(this,e,t,n,r,i),this.className="Enum",this.object=null};h.getName=function(e,t){for(var n,r=Object.keys(e),i=0;i<r.length;++i)if(e[n=r[i]]===t)return n;return null},(h.prototype=Object.create(s.prototype)).build=function(e){if(this.object&&!e)return this.object;for(var t=new g.Builder.Enum,n=this.getChildren(h.Value),r=0,i=n.length;r<i;++r)t[n[r].name]=n[r].id;return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=t},a.Enum=h;function p(e,t,n,r){f.call(this,e,t,n),this.className="Enum.Value",this.id=r,this.name=b8e.getAliasName(this.name)}p.prototype=Object.create(f.prototype),a.Enum.Value=p;var v=function(e,t,n,r){f.call(this,e,t,n),this.field=r};v.prototype=Object.create(f.prototype),a.Extension=v;var y=function(e,t,n,r){s.call(this,e,t,n,r),this.className="Service",this.clazz=null};(y.prototype=Object.create(s.prototype)).build=function(e){return this.clazz&&!e?this.clazz:this.clazz=function(t,i){for(var o=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},e=o.prototype=Object.create(t.Builder.Service.prototype),n=i.getChildren(t.Reflect.Service.RPCMethod),r=0;r<n.length;r++)(function(r){e[r.name]=function(e,n){if(null===(e=r.resolvedRequestType.clazz.decode(w.wrap(e)))||(void 0===e?"undefined":J(e))!==b8e.TypeObject)throw Error("Illegal arguments");e instanceof r.resolvedRequestType.clazz||(e=new r.resolvedRequestType.clazz(e)),this.rpcImpl(r.fqn(),e,function(e,t){e?n(e):(null===t&&(t=""),(t=r.resolvedResponseType.clazz.decode(t))&&t instanceof r.resolvedResponseType.clazz?n(null,t):n(Error("Illegal response type received in service method "+i.name+"#"+r.name)))})},o[r.name]=function(e,t,n){new o(e)[r.name](t,n)},Object.defineProperty&&(Object.defineProperty(o[r.name],"$options",{value:r.buildOpt()}),Object.defineProperty(e[r.name],"$options",{value:o[r.name].$options}))})(n[r]);return Object.defineProperty&&(Object.defineProperty(o,"$options",{value:i.buildOpt()}),Object.defineProperty(e,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:i}),Object.defineProperty(e,"$type",{value:i})),o}(g,this)},a.Service=y;function _(e,t,n,r){f.call(this,e,t,n),this.className="Service.Method",this.options=r||{}}(_.prototype=Object.create(f.prototype)).buildOpt=t.buildOpt,a.Service.Method=_;function m(e,t,n,r,i,o,a,s){_.call(this,e,t,n,s),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=a,this.resolvedRequestType=null,this.resolvedResponseType=null}return m.prototype=Object.create(_.prototype),a.Service.RPCMethod=m,a}(r),r.Builder=function(Z,a,Q){function X(e){this.ns=new Q.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}}var e=X.prototype;function v(e){if(e.messages)for(var t=e.messages,n=t.length,r=0;r<n;r++){var i=t[r];i.syntax=e.syntax,v(i)}if(e.enums)for(var o=e.enums,a=o.length,s=0;s<a;s++){o[s].syntax=e.syntax}}return X.isMessage=function(e){return"string"==typeof e.name&&(J(e.values)===b8e.TypeUndefined&&J(e.rpc)===b8e.TypeUndefined)},X.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&J(e.id)!==b8e.TypeUndefined},X.isEnum=function(e){return"string"==typeof e.name&&!(J(e.values)===b8e.TypeUndefined||!Array.isArray(e.values)||0===e.values.length)},X.isService=function(e){return!("string"!=typeof e.name||J(e.rpc)!==b8e.TypeObject||!e.rpc)},X.isExtend=function(e){return"string"==typeof e.ref},e.reset=function(){return this.ptr=this.ns,this},e.define=function(e){if("string"!=typeof e||!a.TYPEREF.test(e))throw Error("illegal namespace: "+e);for(var t=e.split("."),n=t.length,r=0;r<n;r++){var i=t[r],o=this.ptr.getChild(i);null===o&&this.ptr.addChild(o=new Q.Namespace(this,this.ptr,i)),this.ptr=o}return this},e.create=function(e){if(!e)return this;if(Array.isArray(e)){if(0===e.length)return this;e=e.slice()}else e=[e];for(var t=[e];0<t.length;){if(e=t.pop(),!Array.isArray(e))throw Error("not a valid namespace: "+JSON.stringify(e));for(var n=void 0;0<e.length;){var r=e.shift();if(X.isMessage(r)){n=new Q.Message(this,this.ptr,r.name,r.options,r.isGroup,r.syntax);var i={};if(r.oneofs)for(var o=Object.keys(r.oneofs),a=o.length,s=0;s<a;s++){var l=o[s];n.addChild(i[l]=new Q.Message.OneOf(this,n,l))}if(r.fields)for(var u=r.fields,f=u.length,c=0;c<f;c++){var d=u[c];if(null!==n.getChild(0|d.id))throw Error("duplicate or invalid field id in "+n.name+": "+d.id);if(d.options&&J(d.options)!==b8e.TypeObject)throw Error("illegal field options in "+n.name+"#"+d.name);var h=null;if("string"==typeof d.oneof&&!(h=i[d.oneof]))throw Error("illegal oneof in "+n.name+"#"+d.name+": "+d.oneof);if(d=new Q.Message.Field(this,n,d.rule,d.keytype,d.type,d.name,d.id,d.options,h,r.syntax),h){var p=h.fields;p[p.length]=d}n.addChild(d)}var v=[];if(r.enums)for(var g=r.enums,b=g.length,y=0;y<b;y++){var _=g[y];v[v.length]=_}if(r.messages)for(var m=r.messages,w=m.length,T=0;T<w;T++){var E=m[T];v[v.length]=E}if(r.services)for(var S=r.services,C=S.length,I=0;I<C;I++){var k=S[I];v[v.length]=k}if(r.extensions&&(J(r.extensions[0])===b8e.TypeNumber?n.extensions=[r.extensions]:n.extensions=r.extensions),this.ptr.addChild(n),0<v.length){t[t.length]=e,e=v,v=null,this.ptr=n,n=null;continue}v=null}else if(X.isEnum(r)){n=new Q.Enum(this,this.ptr,r.name,r.options,r.syntax);for(var A=r.values,L=A.length,R=0;R<L;R++){var x=A[R];n.addChild(new Q.Enum.Value(this,n,x.name,x.id))}this.ptr.addChild(n)}else if(X.isService(r)){n=new Q.Service(this,this.ptr,r.name,r.options);for(var P=Object.keys(r.rpc),N=P.length,O=0;O<N;O++){var U=P[O],F=r.rpc[U];n.addChild(new Q.Service.RPCMethod(this,n,U,F.request,F.response,!!F.request_stream,!!F.response_stream,F.options))}this.ptr.addChild(n)}else{if(!X.isExtend(r))throw Error("not a valid definition: "+JSON.stringify(r));if(n=this.ptr.resolve(r.ref,!0))for(var M=r.fields,B=M.length,D=0;D<B;D++){var j=M[D];if(null!==n.getChild(0|j.id))throw Error("duplicate extended field id in "+n.name+": "+j.id);if(n.extensions){for(var V=!1,Y=n.extensions,z=Y.length,H=0;H<z;H++){var $=Y[H];if(j.id>=$[0]&&j.id<=$[1]){V=!0;break}}if(!V)throw Error("illegal extended field id in "+n.name+": "+j.id+" (not within valid ranges)")}var q=j.name;this.options.convertFieldsToCamelCase&&(q=Z.Util.toCamelCase(q)),q=b8e.getAliasName(q);var G=new Q.Message.ExtensionField(this,n,j.rule,j.type,this.ptr.fqn()+"."+q,j.id,j.options),W=new Q.Extension(this,this.ptr,j.name,G);G.extension=W,this.ptr.addChild(W),n.addChild(G)}else if(!/\.?google\.protobuf\./.test(r.ref))throw Error("extended message "+r.ref+" is not defined")}n=r=null}e=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},e.import=function(i,o){var a=this,e="/";if("string"==typeof o){if(!0===this.files[o])return this.reset();this.files[o]=!0}else if((void 0===o?"undefined":J(o))===b8e.TypeObject){var t=o.root;(0<=t.indexOf("\\")||0<=o.file.indexOf("\\"))&&(e="\\");var n;if(n=t+e+o.file,!0===this.files[n])return this.reset();this.files[n]=!0}if(i.imports&&0<i.imports.length){var s=void 0,r=!1;(void 0===o?"undefined":J(o))===b8e.TypeObject?(this.importRoot=o.root,r=!0,s=this.importRoot,o=o.file,(0<=s.indexOf("\\")||0<=o.indexOf("\\"))&&(e="\\")):"string"==typeof o?this.importRoot?s=this.importRoot:0<=o.indexOf("/")?""===(s=o.replace(/\/[^\/]*$/,""))&&(s="/"):0<=o.indexOf("\\")?(s=o.replace(/\\[^\\]*$/,""),e="\\"):s=".":s=null;for(var l=function(r){if("string"==typeof i.imports[r]){if(!s)throw Error("cannot determine import root");var e=i.imports[r],t=e.replace(/\.proto$/,""),n=a.datas[t];if(!n)throw Error("failed to import '"+e+"' in '"+o+"': file not found");a.import(n,e)}else o?/\.(\w+)$/.test(o)?a.import(i.imports[r],o.replace(/^(.+)\.(\w+)$/,function(e,t,n){return t+"_import"+r+"."+n})):a.import(i.imports[r],o+"_import"+r):a.import(i.imports[r])},u=0;u<i.imports.length;u++)l(u);r&&(this.importRoot=null)}i.package&&this.define(i.package),i.syntax&&v(i);var f=this.ptr;if(i.options){var c=i.options,d=Object.keys(c),h=d.length;for(u=0;u<h;u++){var p=d[u];f.options[p]=c[p]}}return i.messages&&(this.create(i.messages),this.ptr=f),i.enums&&(this.create(i.enums),this.ptr=f),i.services&&(this.create(i.services),this.ptr=f),i.extends&&this.create(i.extends),this.reset()},e.resolveAll=function(){var e=void 0;if(null==this.ptr||J(this.ptr.type)===b8e.TypeObject)return this;if(this.ptr instanceof Q.Namespace)for(var t=this.ptr.children,n=t.length,r=0;r<n;r++){var i=t[r];this.ptr=i,this.resolveAll()}else if(this.ptr instanceof Q.Message.Field){if(a.TYPE.test(this.ptr.type))this.ptr.type=Z.TYPES[this.ptr.type];else{if(!a.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(e=(this.ptr instanceof Q.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if((this.ptr.resolvedType=e)instanceof Q.Enum){if(this.ptr.type=Z.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==e.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(e instanceof Q.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=e.isGroup?Z.TYPES.group:Z.TYPES.message}}if(this.ptr.map){if(!a.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=Z.TYPES[this.ptr.keyType]}"proto3"===this.ptr.syntax&&this.ptr.repeated&&void 0===this.ptr.options.packed&&-1!==Z.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType)&&(this.ptr.options.packed=!0)}else if(this.ptr instanceof Z.Reflect.Service.Method){if(!(this.ptr instanceof Z.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((e=this.ptr.parent.resolve(this.ptr.requestName,!0))&&e instanceof Z.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=e,!((e=this.ptr.parent.resolve(this.ptr.responseName,!0))&&e instanceof Z.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=e}else if(!(this.ptr instanceof Z.Reflect.Message.OneOf||this.ptr instanceof Z.Reflect.Extension||this.ptr instanceof Z.Reflect.Enum.Value))throw Error("illegal object in namespace: "+J(this.ptr)+": "+this.ptr);return this.reset()},e.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},e.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},e.toString=function(){return"Builder"},X.Message=function(){},X.Enum=function(){},X.Service=function(){},X}(r,r.Lang,r.Reflect),r.Map=function(a){function e(e,t){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new a.Element(e.keyType,null,!0,e.syntax),this.valueElem=new a.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),t)for(var n=Object.keys(t),r=0;r<n.length;r++){var i=this.keyElem.valueFromString(n[r]),o=this.valueElem.verifyValue(t[n[r]]);this.map[this.keyElem.valueToString(i)]={key:i,value:o}}}var t=e.prototype;function i(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}return t.clear=function(){this.map={}},t.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},t.entries=function(){for(var e,t=[],n=Object.keys(this.map),r=0;r<n.length;r++)t[t.length]=[(e=this.map[n[r]]).key,e.value];return i(t)},t.keys=function(){for(var e=[],t=Object.keys(this.map),n=0;n<t.length;n++)e[e.length]=this.map[t[n]].key;return i(e)},t.values=function(){for(var e=[],t=Object.keys(this.map),n=0;n<t.length;n++)e[e.length]=this.map[t[n]].value;return i(e)},t.forEach=function(e,t){for(var n,r=Object.keys(this.map),i=0;i<r.length;i++)e.call(t,(n=this.map[r[i]]).value,n.key,this)},t.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},t.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},t.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},e}(r.Reflect),r.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),r.loadJson(r.DotProto.Parser.parse(e),t,n)},r.protoFromString=r.loadProto,r.protoFromFile=r.loadProtoFile,r.newBuilder=function(e){return J((e=e||{}).convertFieldsToCamelCase)===b8e.TypeUndefined&&(e.convertFieldsToCamelCase=r.convertFieldsToCamelCase),J(e.populateAccessors)===b8e.TypeUndefined&&(e.populateAccessors=r.populateAccessors),new r.Builder(e)},r.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&(void 0===t?"undefined":J(t))===b8e.TypeObject||(t=r.newBuilder()),"string"==typeof e&&(e=b8e.JsUtil.jsonParse(e)),t.import(e,n),t.resolveAll(),t},r}(e)})(),function(){var e,a=b8e._callLaterList=[];b8e.callLater=function(e,t){for(var n=[],r=2,i=arguments.length;r<i;r++)n[r-2]=arguments[r];var o=b8e.createMap();o.callBack=e,o.thisArg=t,o.args=n,a.unshift(o)};var s=b8e._callAsyncList=[];b8e.callAsync=function(e,t){for(var n=[],r=2,i=arguments.length;r<i;r++)n[r-2]=arguments[r];var o=b8e.createMap();o.callBack=e,o.thisArg=t,o.args=n,s.unshift(o)},function(){var s=b8e.HashMap.get(),l=b8e.LinkedList.get(),u=b8e.HashMap.get();u.localHashable=!0,u.polyfillHash=!0;var f=0,c=0,i=0,d=!1;function o(e){var t=s.get(e);t&&(c--,s.del(e),u.del(t.listener,t.thisArg),l.remove(t),t.release())}function h(e){i=e,l.resetTraversal(),l.forEach(t,null)}function t(e){if(e.delay-=i,e.delay<=0){var t=e.listener,n=e.thisArg,r=e.params;o(e.key),t.apply(n,r)}}b8e.SHC(h),b8e.setTimeout=function(e,t,n){var r=u.get(e,t);if(r)return b8e.warn(3378),r.key;n=0|+n;var i=arguments.length,o=void 0;if(3<i){o=[];for(var a=3;a<i;a++)o[a-3]=arguments[a]}return c++,f++,(r=p.get()).key=f,r.listener=e,r.thisArg=t,r.delay=n,r.params=o,u.set(e,r,t),s.set(f,r),l.append(r),d||(d=!0,b8e.getLoop().addTick(h,null)),f},b8e.clearTimeout=o,b8e.hasTimeout=function(e,t){return!!u.get(e,t)},b8e.removeTimeout=function(e,t){var n=u.get(e,t);n&&(c--,s.del(n.key),u.del(e,t),l.remove(n),n.release())},b8e.timeoutCount=function(){return c}}();var p=b8e.PoolObject.extends({ctor:function(){this._super(),this.lazyPoolDisabled=!0,this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.key=void 0,e.listener=null,e.thisArg=null,e.delay=0,e.params=null}}),t=new b8e.Pool(p,128);p.get=function(){return t.get()},p.put=function(e){return t.put(e)};var l=e=b8e.Object.extends({_queue:null,_paramsQueue:null,_currBatch:0,_batch:0,_delay:0,_frameTime:0,_frameCount:0,_reverse:!1,_isProcessing:!1,_traversalQueue:null,isFixedList:!1,ctor:function(e,t,n,r,i){void 0===n&&(n=1),void 0===r&&(r=0);var o=this;o._super(),o._queue=b8e.LinkedList.get(),o._onProcess=e,o._thisArg=t,o._batch=n,o._delay=10<r?r:10,o._reverse=!!i,o._isProcessing=!1,o._queueTraversal=!1,o._traversalQueue=[],o._times=l.MAX_DURATION/o._delay,o._applySecondBatch(),o._applyCurrBatch(),o.isFixedList=!1,o._nextNode=null},setFixedList:function(e){var t=this;t.isFixedList||t._queue.release(),t.isFixedList=!0,t._queue!==e&&(t._queue=e,t._clearStatus(),e&&t._applyCurrBatch())},safetyTraversal:{set:function(e){this._queue.safetyTraversal=e}},_applyCurrBatch:function(){var e=this,t=(e._queue.count()/e._batchCount>>0)*e._batchCount/e._times;return t>e._batch?(e._currBatch=t,!0):(e._currBatch=e._batch,!1)},_applySecondBatch:function(){this._batchCount=this._batch*this._times},batch:{get:function(){return this._batch},set:function(e){this._batch=e,this._applySecondBatch()}},_onAdd:function(e){var t=this;if(t._queueTraversal){var n=t._traversalQueue,r=o.get();r.option=t._onAdd,r.item=e,n[n.length]=r}else{t._queue.append(e),t._applyCurrBatch()}},_onRemove:function(e){var t=this;if(t._queueTraversal){var n=t._traversalQueue,r=o.get();r.option=t._onRemove,r.item=e,n[n.length]=r}else{var i=t._queue;i.remove(e),t._applyCurrBatch(),i.count()<1&&b8e.hasTimeout(t._doQueue,t)&&(b8e.removeTimeout(t._doQueue,t),t._isProcessing=!1,l.processingCount--)}},addParams:function(e){var t=this;t.isFixedList&&(t._paramsQueue||(t._paramsQueue=b8e.LinkedList.get()),t._paramsQueue.append(e),t._call())},add:function(e){this.isFixedList||(this._onAdd(e),this._call())},remove:function(e){this.isFixedList||this._onRemove(e)},_processTraversalQueue:function(){var e=this._traversalQueue,t=e.length;if(!(t<1)){for(var n=0;n<t;n++){var r=e[n];r.option.call(this,r.item),r.release()}e.length=0}},_call:function(){var e=this;if(!b8e.hasTimeout(e._doQueue,e)){var t=e._queue;if(!(t.count()<1)){if(e.isFixedList){e._nextNode=e._reverse?t.tail():t.head();var n=e._paramsQueue;if(!n||n.count()<1)return;e._currParams=n.shift()}e._queueCall()}}},_queueCall:function(){var e=this;b8e.hasTimeout(e._doQueue,e)||(e._isProcessing||(e._isProcessing=!0,l.processingCount++),e._frameCount=0,b8e.setTimeout(e._doQueue,e,e._delay))},has:function(e){return this._queue.has(e)},count:function(){return this._queue.count()},_doQueue:function(){var e=this;e._processTraversalQueue(),e._queueTraversal=!0;for(var t=e._queue;(e.isFixedList&&e._nextNode||!e.isFixedList&&0<t.count())&&e._frameCount<e._currBatch;){var n=void 0;if(e.isFixedList)n=e._nextNode,e._onProcess.call(e._thisArg,n,e._currParams)||e._frameCount++,e._nextNode=e._reverse?t.getPrev(n):t.getNext(n);else n=e._reverse?t.pop():t.shift(),e._onProcess.call(e._thisArg,n)||e._frameCount++}if(e._queueTraversal=!1,e._processTraversalQueue(),e._isProcessing&&(e._isProcessing=!1,l.processingCount--),e.isFixedList)if(e._nextNode)e._queueCall();else{var r=e._paramsQueue;r&&0<r.count()&&(e._currParams=r.shift(),e._nextNode=e._reverse?t.tail():t.head(),e._queueCall())}else 0<t.count()&&e._queueCall()},_clearStatus:function(){var e=this;e._nextNode=null,e._paramsQueue&&e._paramsQueue.clear(),b8e.hasTimeout(e._doQueue,e)&&(b8e.removeTimeout(e._doQueue,e),e._isProcessing=!1,l.processingCount--)},clear:function(){this._queue.clear(),this._clearStatus()}});l.MAX_DURATION=500,l.poolCall=!0,l.processingCount=0;var o=b8e.Object.extends({option:null,item:null,usable:!1,release:function(){o.put(this)},recycle:function(){this.option=null,this.item=null,this.usable=!1}}),n=[];o.get=function(){var e=void 0;return(e=0<n.length?n.pop():new o).usable=!0,e},o.put=function(e){if(e.usable)return e.recycle(),n[n.length]=e},o.poolCall=!0,b8e.RC("$$b8e","$$CallLater",e)}(),function(){var e,t=e=b8e.PoolObject.extends({ctor:function(){this._super()},clear:function(){var e=this;e.callback=null,e.thisArg=null,e.args=null,e.data=null,e.targetHash=0},restore:function(){this._super()},recycle:function(){this.clear(),this._super()}}),n=new b8e.Pool(t,16384);t.get=function(){return n.get()},t.put=function(e){return n.put(e)},b8e.RC("$$b8e","$$CallBackData",e)}(),function(){var a=b8e.CallBackUtil=function(){};a.addCallBackData=function(e,t,n,r,i){if(t)if(b8e.applyType(t),t.__TypeFunction){var o=e.get(t,n);if(o)o.args=r,o.data=i;else{(o=b8e.CallBackData.get()).callback=t,o.thisArg=n,o.args=r,o.data=i,o.targetHash=n&&n.poolHashUsable&&n.poolHash?n.poolHash:0,e.set(t,o,n);var a=e.__cbList;(a=a||(e.__cbList=b8e.LinkedList.get())).append(o)}}else b8e.error(3054);else b8e.error(3054)};var l={};a.exceteCallBackData=function(e,t,n,r,i){var o=t.__cbList;o&&(l.thisArg=e,l.args=n,l.argsGetter=r,l.argsGetterThis=i,o.resetTraversal(),o.forEach(s,a))};var s=function(e){var t=l.thisArg,n=l.args,r=l.argsGetter,i=l.argsGetterThis;if(e.targetHash){var o=e.thisArg;if(o&&o.poolHashUsable){if(!o.poolHashUsable(e.targetHash))return}else b8e.error(3055,o)}if(e&&null!=e.callback){var a=[];t&&(a[a.length]=t),e.args&&(a=a.concat(e.args)),a=n?a.concat(n):a;var s=r?r.call(i,e.data):null;a=s?[s].concat(a):a,e.callback.apply(e.thisArg,a)}};a.removeCallBackData=function(e,t,n){if(t)if(b8e.applyType(t),t.__TypeFunction){var r=e.get(t,n);if(r){if(r.targetHash){var i=r.thisArg;i&&i.poolHashUsable?i.poolHashUsable(r.targetHash)||b8e.error(3057):b8e.error(3058,i)}b8e.CallBackData.put(r),e.del(t,n),e.__cbList.remove(r)}}else b8e.error(3056);else b8e.error(3056)},a._onRemoveList=function(e){b8e.CallBackData.put(e)},a.removeAllCallBackData=function(e){var t=e.__cbList;t&&(t.forEach(a._onRemoveList,a),e.clear(),t.release(),delete e.__cbList)}}();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e=b8e.LocalStorage=function(){};e.setItem=function(t,e){if("string"!=typeof t)return b8e.error(3093),!1;var n=null;n=(void 0===e?"undefined":J(e))===b8e.TypeObject?JSON.stringify(e):e;try{return window.localStorage.setItem(t,n),!0}catch(e){return b8e.warn("\u4fdd\u5b58\u5931\u8d25\uff0ckey="+t+"&value="+n),!1}},e.getItem=function(e,t){if("string"==typeof e){var n=window.localStorage.getItem(e);return t?b8e.JsUtil.jsonParse(n,!0):n}b8e.error(3094)},e.removeItem=function(e){"string"==typeof e?window.localStorage.removeItem(e):b8e.error(3095)},e.clear=function(){window.localStorage.clear()}})();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,o=e=b8e.Enum({None:0,Debug:1,Warn:2,Error:4,Info:8,All:15}),a=b8e.Logger=function(){};a.currLogMode=o.None,a.log=null,a.warn=null,a.error=null,a.info=null,a.benchmark=null,a.ERROR_CAUTION=!0,a.WARN_CAUTION=!0,a.init=function(e,t,n,r,i){e=a.currLogMode=void 0===e?o.All:e,a.log=0!=(e&o.Debug)?t||a.log:function(){},a.warn=0!=(e&o.Warn)?n||a.warn:function(){},a.error=0!=(e&o.Error)?r||a.error:function(){},a.info=0!=(e&o.Info)?i||a.info:function(){},b8e.info=a.info,b8e.log=a.log,b8e.error=a.error,b8e.warn=a.warn,b8e.trace=a.trace,b8e.benchmark=a.benchmark,a.ERROR_CAUTION=a.WARN_CAUTION=null==game.debugType||2!=game.debugType},a.trace=function(){var e=Array.prototype.slice.call(arguments);e.unshift("B8E TRACE:"),console&&console.log.apply&&console.log.apply(console,e)},a.logMsg=[],a.log=function(){if(b8e.macro.IS_DEBUG){var e=Array.prototype.slice.call(arguments);a._applyLocalization(e);var t=a.logMsg,n=e.join(" ");t[t.length]="B8E LOG:"+n,console&&console.log.apply&&(e.unshift("B8E LOG:"),console.log.apply(console,e)),b8e.profiler&&b8e.profiler.isShow()&&b8e.profiler.addLog.apply(b8e.profiler)}},a.infoMsg=[],a.info=function(){if(b8e.macro.IS_DEBUG){var e=Array.prototype.slice.call(arguments);a._applyLocalization(e);var t=a.infoMsg,n=e.join(" ");t[t.length]="B8E INFO:"+n,console&&console.info.apply&&(e.unshift("B8E INFO:"),console.info.apply(console,e)),b8e.profiler&&b8e.profiler.isShow()&&b8e.profiler.addInfo.apply(b8e.profiler)}},a.warnMap={},a.warnMsg=[],a.warn=function(){var e=Array.prototype.slice.call(arguments);a._applyLocalization(e);var t=e.join(" ");200<t.length&&(t=t.substr(0,200)+"...");var n=a.warnMap;if(!n[t]){n[t]=!0;var r=a.warnMsg;if(t="B8E WARN:"+t,r[r.length]=t,b8e.LogReport&&b8e.LogReport.send.call(b8e.LogReport,"WARN",t),b8e.macro.IS_DEBUG&&(b8e.profiler&&b8e.profiler.isShow()&&b8e.profiler.addWarn.apply(b8e.profiler),b8e.ready&&a.WARN_CAUTION&&b8e.Toast.launch("\u8fd0\u884c\u65f6\u8b66\u544a\uff0c\u8bf7\u8c03\u8bd5\u68c0\u67e5\uff01",4294967040,3600,1)),b8e.macro.IS_DEBUG){try{Error.captureStackTrace(a,a.warn)}catch(e){try{throw Error()}catch(e){a.stack=e.stack}}e[e.length]=":"+a.stack,console&&console.warn.apply&&(e.unshift("B8E WARN:"),console.warn.apply(console,e))}}},a.errorMap={},a.errorMsg=[],a.error=function(){var e=Array.prototype.slice.call(arguments);a._applyLocalization(e);var t=e.join(" ");200<t.length&&(t=t.substr(0,200)+"...");var n=a.errorMap;if(!n[t]){n[t]=!0;var r=a.errorMsg;if(t="B8E ERROR:"+t,r[r.length]=t,b8e.LogReport&&b8e.LogReport.send.call(b8e.LogReport,"ERROR",t),b8e.macro.IS_DEBUG&&(b8e.profiler&&b8e.profiler.isShow()&&b8e.profiler.addError.apply(b8e.profiler),b8e.ready&&a.ERROR_CAUTION&&b8e.Toast.launch("\u8fd0\u884c\u65f6\u9519\u8bef\uff0c\u8bf7\u8c03\u8bd5\u68c0\u67e5\uff01",4294901760,3600,1)),b8e.macro.IS_DEBUG){try{Error.captureStackTrace(a,a.error)}catch(e){try{throw Error()}catch(e){a.stack=e.stack}}e[e.length]=":"+a.stack,console&&console.error.apply&&(e.unshift("B8E ERROR:"),console.error.apply(console,e))}}},a._applyLocalization=function(e){var t=e[0];if((void 0===t?"undefined":J(t))===b8e.TypeNumber){if(b8e.localization){var n=b8e.localization[t];if(n){for(;-1<n.indexOf("$");){var r=1<e.length?e.splice(1,1)[0]:"";n=n.replace("$",r)}t=n}else t="#"+t}else t="#"+t;e[0]=t}},a.benchmarkMap={},a.benchmarkMsg=[],a.benchmark=function(){if(b8e.macro.BENCHMARK){var e=Array.prototype.slice.call(arguments);a._applyLocalization(e);var t=a.benchmarkMsg,n=e.join(" "),r=a.benchmarkMap;r[n]||(r[n]=!0,t[t.length]="B8E BENCHMARK:"+n,b8e.profiler&&b8e.profiler.isShow()&&b8e.profiler.addBenchmark.apply(b8e.profiler))}},a.init(),b8e.RC("$$b8e","$$LogMode",e)})();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var o=b8e.LogReport=function(){};o._reportUrl=null,o._reportDataGetter=null,o._msgs=null,o._net=null,o.init=function(e,t){o._reportUrl=e,o._reportDataGetter=t,o._net=b8e.NetMgr.createMgr("LogReport"),o.send("INFO")},o._queue=null,o.send=function(e,t){if(!o._reportUrl)return!1;if(!e)return!1;if(t){200<t.length&&(t=t.substr(0,200)+"...");var n=o._msgs;if((n=n||(o._msgs={}))[t])return!0;n[t]=!0}var r=a.get();r.logType=e,r.renderType=b8e.renderType,r.usedMemory="",r.totalMemory="",r.stageWidth=b8e.stageWidth,r.stageHeight=b8e.stageHeight,r.runTime=b8e.timeStamp,r.localTime=Date.now(),r.serverTime=b8e.ready?b8e.startup.getServerTime():0,r.fps=b8e.ready?b8e.Ticker.getFps():0,r.kernelName=window.navigator.appName,r.kernelVersion=window.navigator.appVersion,r.kernelPlatform=window.navigator.platform,r.href=window.location&&window.location.href?window.location.href:"",r.logMsg=t,o._reportDataGetter&&(r=o._reportDataGetter(r));var i=o._queue;return(i=i||(o._queue=new b8e.CallLater(function(e){return o._net.requestData(o._reportUrl,e,function(e,t){e?b8e.log("\u65e5\u5fd7\u4e0a\u62a5IO\u9519\u8bef\uff1a"+e):t&&(void 0===t?"undefined":J(t))===b8e.TypeObject&&0==t.code?b8e.log("\u65e5\u5fd7\u4e0a\u62a5\u6210\u529f"):b8e.log("\u65e5\u5fd7\u4e0a\u62a5\u9519\u8bef\uff1a"+(t&&(void 0===t?"undefined":J(t))===b8e.TypeObject?t.code+":"+t.msg:"data:"+t))},this,null,!0,{isJson:!0}),e.release(),!1},o,1,100))).add(r),!0};var a=b8e.Object.extends({usable:!1,ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this.usable=!1},reset:function(){this.logType=0},release:function(){a.put(this)}}),t=[];a.get=function(){var e=void 0;return(e=0<t.length?t.pop():new a).usable=!0,e},a.put=function(e){if(e.usable)return e.recycle(),t[t.length]=e},a.poolCall=!0})(),function(){var i=b8e.MathUtil=function(){};i.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},i.sin=function(e){var t=Math.floor(e),n=t+1,r=i.sinInt(t);return t==e?r:(e-t)*i.sinInt(n)+(n-e)*r},i.sinInt=function(e){return(e%=360)<0&&(e+=360),t[e]},i.cos=function(e){var t=Math.floor(e),n=t+1,r=i.cosInt(t);return t==e?r:(e-t)*i.cosInt(n)+(n-e)*r},i.cosInt=function(e){return(e%=360)<0&&(e+=360),n[e]};for(var t={},n={},e=Math.PI/180,r=0;r<360;r++)t[r]=Math.sin(r*e),n[r]=Math.cos(r*e);t[90]=1,n[90]=0,t[180]=0,n[180]=-1,t[270]=-1,n[270]=0,i.isPowerOfTwo=function(e){return 0<e&&!(e&e-1)},i.nearestPowerOfTwo=function(e){var t=e>>0;t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16;var n=++t>>1;return e-n<t-e?n:t},i.random=function(e,t){return Math.random()*(t-e)+e}}();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var n=b8e.BindingUtil={},t={writable:!0,enumerable:!1,configurable:!1};n.bind=function(e){var n=void 0,i=void 0,o=e.prototype;e.forProps(function(e,r){if(r){var t=void 0===r?"undefined":J(r);if(t===b8e.TypeObject||t===b8e.TypeFunction)return}n=function(o){return function(e){var t=this,n=t.__values__;n=n||(t.__values__={});var r=t.__values__[o];if(void 0===r)n[o]=e;else if(r==e)return;if((n[o]=e)&&e.__binding__){var i=t.__observers__;i=i||(t.__observers__=[]),e.__owner__=t,i[i.length]=e}t.dirty()}}(e),i=function(n){return function(){var e=this.__values__,t=e?e[n]:void 0;return void 0!==t?t:r}}(e),b8e.JsUtil.defineGetSetAccessor(o,e,i,n,!1,!0)}),t.value=!0,Object.defineProperty(o,"__binding__",t),t.value=!1,Object.defineProperty(o,"__isDirty",t),t.value=null,Object.defineProperty(o,"__owner__",t),t.value=null,Object.defineProperty(o,"__observers__",t),t.value=function(){var e=this;if(!e.__isDirty){e.__isDirty=!0;var t=a.get(e,null);t&&0<t.count()?e.applyNotify():e.notify();var n=e.__owner__;n&&n.dirty()}},Object.defineProperty(o,"dirty",t),o.notify||(t.value=function(){this.__isDirty&&s(this)},Object.defineProperty(o,"notify",t)),t.value=function(e,t){var n=this;if(e&&t){var r=a.get(n,null);r||(r=b8e.HashMap.get(),a.set(n,r,null)),r.get(e,t)?b8e.error(3013):(r.set(e,n,t),1<r.count()?n.__isDirty&&l.has(n)||e.call(t,n):n.__isDirty?n.applyNotify():e.call(t,n))}else b8e.error(3012)},Object.defineProperty(o,"addNotify",t),o.applyNotify||(t.value=function(){l.add(this)},Object.defineProperty(o,"applyNotify",t)),t.value=function(e,t){if(e&&t){var n=a.get(this,null);n?n.get(e,t)?(n.del(e,t),n.count()<1&&(this.cancelNotify(),n.release(),a.del(this,null))):b8e.error(3016):b8e.error(3015)}else b8e.error(3014)},Object.defineProperty(o,"removeNotify",t),o.cancelNotify||(t.value=function(){l.remove(this)},Object.defineProperty(o,"cancelNotify",t))},n.BATCH_NOTIFY_NUM=20;function r(e,t,n){e.call(n,t)}var a=b8e.HashMap.get(),s=n.notifyCall=function(e){var t=a.get(e,null);t&&0<t.count()&&(t.resetTraversal(),t.forEach(r,n),e.cancelNotify()),e.__isDirty=!1},l=new b8e.CallLater(function(e){return e.notify(),!1},n,n.BATCH_NOTIFY_NUM)})();J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var v=b8e.ProtobufUtil=function(){};v.decodeMessage=function(e,t,n){return n.ctor.decode(t)},v.encodeMessage=function(e){var t=e.encodeAB();return new Uint8Array(t)},v.createMessage=function(e){return new e.ctor},v.buildMessage=function(e,t){var n=v.getBuilder();return b8e.protobuf.loadJson(t,n,e+".proto").build()},v.instantiateMessage=function(e){var t=new e;for(var n in t.ctor=e){var r=e[n];r instanceof b8e.protobuf.Builder.Enum&&(t[n]=r)}return t};var e=null;v.getBuilder=function(){return e||((e=b8e.protobuf.newBuilder()).datas={}),e},v.allotProps=function(e,t){var n=v.getBuilder().datas;for(var r in e){var i=e[r];n[r]=i}for(var o in e){var a=e[o],s=v.buildMessage(o,a);for(var l in s){var u=s[l],f=void 0;if(t)f=t;else{var c=b8e.getAliasName(l);f=game[c]||(game[c]={})}for(var d in u){var h=u[d],p=void 0;p=(void 0===h?"undefined":J(h))===b8e.TypeFunction?v.instantiateMessage(h):h,f[b8e.getAliasName(d)]=p}}}}})(),function(){var c=b8e.BufferUtil=function(){};c.str2Uint8Array=function(e){if(null==e||!e.charCodeAt)return null;for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=255&e.charCodeAt(r);return n},c.uint8Array2Str=function(e){if(!(e instanceof Uint8Array))return null;for(var t="",n=e.length,r=0;r<n;r++)t+=String.fromCharCode(e[r]);return t},c.buffer2Uint8Array=function(e){return e?new Uint8Array(e):null},c.EOF_byte=-1,c.EOF_code_point=-1,c.stringToCodePoints=function(e){for(var t=[],n=0,r=e.length;n<e.length;){var i=e.charCodeAt(n);if(c.inRange(i,55296,57343))if(c.inRange(i,56320,57343))t.push(65533);else if(n==r-1)t.push(65533);else{var o=e.charCodeAt(n+1);if(c.inRange(o,56320,57343)){var a=1023&i,s=1023&o;n+=1,t.push(65536+(a<<10)+s)}else t.push(65533)}else t.push(i);n+=1}return t},c.inRange=function(e,t,n){return t<=e&&e<=n},c.div=function(e,t){return e/t>>0},c.encoderError=function(e){},c.decoderError=function(e,t){return t||65533},c.encodeUTF8=function(e){for(var t=0,n=c.stringToCodePoints(e),r=[];n.length>t;){var i=n[t++];if(c.inRange(i,55296,57343))c.encoderError(i);else if(c.inRange(i,0,127))r.push(i);else{var o=void 0,a=void 0;for(c.inRange(i,128,2047)?(o=1,a=192):c.inRange(i,2048,65535)?(o=2,a=224):c.inRange(i,65536,1114111)&&(o=3,a=240),r.push(c.div(i,Math.pow(64,o))+a);0<o;){var s=c.div(i,Math.pow(64,o-1));r.push(128+s%64),--o}}}return new Uint8Array(r)},c.decodeUTF8=function(e){for(var t=0,n="",r=void 0,i=0,o=0,a=0,s=0;e.length>t;){var l=e[t++];if(l==c.EOF_byte)r=0!=o?c.decoderError(!1):c.EOF_code_point;else if(0==o)r=c.inRange(l,0,127)?l:(c.inRange(l,194,223)?(o=1,s=128,i=l-192):c.inRange(l,224,239)?(o=2,s=2048,i=l-224):c.inRange(l,240,244)?(o=3,s=65536,i=l-240):c.decoderError(!1),i*=Math.pow(64,o),null);else if(c.inRange(l,128,191))if(a+=1,i+=(l-128)*Math.pow(64,o-a),a!==o)r=null;else{var u=i,f=s;s=a=o=i=0,r=c.inRange(u,f,1114111)&&!c.inRange(u,55296,57343)?u:c.decoderError(!1,l)}else s=a=o=i=0,t--,r=c.decoderError(!1,l);null!==r&&r!==c.EOF_code_point&&(r<=65535?0<r&&(n+=String.fromCharCode(r)):(r-=65536,n+=String.fromCharCode(55296+(r>>10&1023)),n+=String.fromCharCode(56320+(1023&r))))}return n}}(),function(){b8e.CORE_VERSION="4.1.5";var e=b8e.EngineCore={};b8e.SHC(e);var t=e.onInit=function(){b8e.CORE_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aCore\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nCore:V"+b8e.CORE_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(t),b8e.onInit(t,e)}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);(function(){return function r(s,a,c){function l(t,e){if(!a[t]){if(!s[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[t]={exports:{}};s[t][0].call(o.exports,function(e){return l(s[t][1][e]||e)},o,o.exports,r,s,a,c)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}})()({1:[function(e,t,i){"use strict";var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){if(("undefined"==typeof cc?"undefined":v(cc))!==b8e.TypeUndefined){b8e.isCocos=!0,b8e.isMobile=cc.sys.isMobile,b8e.isBrowser=cc.sys.isBrowser,b8e.os=cc.sys.os,b8e.createNode=function(){return new cc.Node},b8e.isCocos190="1.9.0"===cc.ENGINE_VERSION,cc.macro.CLEANUP_IMAGE_CACHE=!0,b8e.initRender=function(){},b8e.run=function(e){if(b8e.initRender(),(game.main=new e).init(),b8e.isBrowser){var t=document.getElementById("gameLoading");t&&t.parentNode&&t.parentNode.removeChild(t);var i=document.getElementById("splash");i&&i.parentNode&&i.parentNode.removeChild(i)}},b8e.transformContainer=function(){if(!cc.view)return!1;var e=b8e.availWidth(),t=b8e.availHeight(),i=t<=e,n=!1;(n=!(!cc.sys.isMobile||i&&cc.view._orientation&cc.macro.ORIENTATION_LANDSCAPE||!i&&cc.view._orientation&cc.macro.ORIENTATION_PORTRAIT))||b8e.isMobile&&i&&(b8e.settings.orientation===b8e.OrientationType.PORTRAIT||b8e.settings.orientation===b8e.OrientationType.PORTRAIT_UPSIDE_DOWN?n=!0:b8e.settings.orientation!==b8e.OrientationType.PORTRAIT_UPSIDE_UP||b8e.__isEditingOnMobile||(n=!0));var o=cc.view._frameSize;return n?(o.width=t,o.height=e):(o.width=e,o.height=t),b8e._updateContainer(),n},b8e._updateContainer=function(){var e=(b8e.isCocos190?cc.container:cc.game.container).style;b8e.isMobile&&(e.margin="0",e.display="none");var t=b8e.availWidth(),i=b8e.availHeight(),n=i<=t,o=!1;o=!(!cc.sys.isMobile||n&&cc.view._orientation&cc.macro.ORIENTATION_LANDSCAPE||!n&&cc.view._orientation&cc.macro.ORIENTATION_PORTRAIT),e["-webkit-transform-origin"]="0px 0px 0px",e.transformOrigin="0px 0px 0px";var r=0,s=0,a=0;if(o)e["-webkit-transform"]="rotate(90deg)",e.transform="rotate(90deg)",e.margin="0 0 0 "+i+"px";else if(b8e.isMobile&&n)b8e.settings.orientation===b8e.OrientationType.PORTRAIT||b8e.settings.orientation===b8e.OrientationType.PORTRAIT_UPSIDE_DOWN?(r=i,s=t-0,e["-webkit-transform"]="rotate(90deg)",e.transform="rotate(90deg)",e.margin="0 0px 0 "+(t-0)+"px",o=!0):b8e.settings.orientation!==b8e.OrientationType.PORTRAIT_UPSIDE_UP||b8e.__isEditingOnMobile?(r=t,s=i,e["-webkit-transform"]="rotate(0deg)",e.transform="rotate(0deg)",e.margin="0px"):(r=i,s=t-0,e["-webkit-transform"]="rotate(-90deg)",e.transform="rotate(-90deg)",e.margin=i+"px 0px 0 0px",o=!0);else{s=i-0;var c=b8e.designSize?(b8e.designSize.maxWidth||b8e.designSize.width)*(s/b8e.designSize.height)>>0:0;c<t?a=t-(r=c)>>1:r=t,e["-webkit-transform"]="rotate(0deg)",e.transform="rotate(0deg)",e.margin="0px 0 0px 0"}e.display="block";var l=cc.game.canvas,u=cc.view;l.width=r*u._devicePixelRatio,l.height=s*u._devicePixelRatio,l.style.left=a+"px",l.style.width=r+"px",l.style.height=s+"px",e.left=a+"px",e.width=r+"px",e.height=s+"px"},b8e._resizeEvent=function(){var e=cc.view;b8e.transformContainer();var t=e._frameSize.width,i=e._frameSize.height,n=e._isRotated;if(e._isRotated!==n||e._frameSize.width!==t||e._frameSize.height!==i){var o=e._originalDesignResolutionSize.width,r=e._originalDesignResolutionSize.height;e._resizing=!0,0<o&&e.setDesignResolutionSize(o,r,e._resolutionPolicy),e._resizing=!1,b8e.isCocos190?cc.eventManager.dispatchCustomEvent("canvas-resize"):e.emit("canvas-resize"),e._resizeCallback&&e._resizeCallback.call()}},b8e.convertToLocationInView=function(e,t,i,n){var o=n||cc.v2(),r=cc.view._devicePixelRatio*(e-i.left),s=cc.view._devicePixelRatio*(i.top+i.height-t);return b8e.isMobile&&cc.view._isRotated?b8e.settings.orientation===b8e.OrientationType.PORTRAIT_UPSIDE_UP?(o.x=s,b8e.isCocos190?o.y=cc.view._viewPortRect.height-r:o.y=cc.game.canvas.height-r):(b8e.isCocos190?o.x=cc.view._viewPortRect.width-s:o.x=cc.game.canvas.width-s,o.y=r):(o.x=r,o.y=s),o},b8e._onRichTextTouchEnded=function(r,s){for(var a=r.node.getComponents(cc.Component),e=function(e){var t=r._labelSegments[e],i=t._clickHandler;if(!i)return"continue";var n=i.split(","),o=n[0];o&&r._containsTouchLocation(t,s.touch.getLocation())&&(a.forEach(function(e){e.enabledInHierarchy&&e[o]&&e[o](n)}),s.stopPropagation())},t=0;t<r._labelSegments.length;++t)e(t)},b8e.__isEditingOnMobile=!1;var A=null,N=null;b8e.beginEditingOnMobile=function(e,t){N=t,(A=e)&&A.call(N,!0)},b8e.endEditOnMobile=function(){N=A=null;b8e.hasTimeout(this._kickBack,this)||b8e.setTimeout(this._kickBack,this,200)},b8e._kickBack=function(){window&&window.scrollTo&&document&&document.body&&document.body.scrollTop&&(window.scrollTo(0,document.body.scrollTop+1),1<=document.body.scrollTop&&window.scrollTo(0,document.body.scrollTop-1))},b8e.updateStageSize=function(){if(b8e.isCocos){if(!cc.view)return;if(!b8e.SHOW_ALL){var e=cc.Class({name:"B8eShowAll",extends:cc.ContentStrategy,apply:function(e,t){var i,n,o=cc.game.canvas.width,r=cc.game.canvas.height,s=b8e.designSize.maxWidth||t.width,a=t.height,c=o/s,l=r/a,u=0;return n=c<l?(i=o,a*(u=c)):(i=s*(u=l),r),this._buildResult(o,r,i,n,u,u)}});b8e.SHOW_ALL=new cc.ResolutionPolicy(cc.ContainerStrategy.EQUAL_TO_FRAME,new e)}if(!b8e.FIXED_WIDTH){var t=cc.Class({name:"B8eFixedWidth",extends:cc.ContentStrategy,apply:function(e,t){var i=0,n=b8e.availWidth(),o=b8e.availHeight(),r=o<=n;if(!b8e.__isEditingOnMobile){var s=!1;r?b8e.settings.orientation!==b8e.OrientationType.PORTRAIT_UPSIDE_UP&&b8e.settings.orientation!==b8e.OrientationType.PORTRAIT&&b8e.settings.orientation!==b8e.OrientationType.PORTRAIT_UPSIDE_DOWN||(s=(b8e.isMobile||b8e.isWeChatGame)&&2<n/o,b8e.settings.resolutionPolicy!==b8e.ResolutionPolicy.FIXED_WIDTH&&s&&(i=15)):(s=(b8e.isMobile||b8e.isWeChatGame)&&2<o/n,b8e.settings.resolutionPolicy!==b8e.ResolutionPolicy.FIXED_WIDTH&&s&&(i=15))}i*=cc.view._devicePixelRatio;var a=cc.game.canvas.width,c=cc.game.canvas.height,l=a/t.width,u=a,d=c-(i<<1)*cc.view._devicePixelRatio;return this._buildResult(a,c,u,d,l,l)}});b8e.FIXED_WIDTH=new cc.ResolutionPolicy(cc.ContainerStrategy.EQUAL_TO_FRAME,new t)}if(!b8e.FIXED_HEIGHT){var i=cc.Class({name:"B8eFixedHeight",extends:cc.ContentStrategy,apply:function(e,t){var i=0,n=b8e.availWidth(),o=b8e.availHeight(),r=o<=n;if(!b8e.__isEditingOnMobile){var s=!1;r?b8e.settings.orientation!==b8e.OrientationType.PORTRAIT_UPSIDE_UP&&b8e.settings.orientation!==b8e.OrientationType.PORTRAIT&&b8e.settings.orientation!==b8e.OrientationType.PORTRAIT_UPSIDE_DOWN||(s=(b8e.isMobile||b8e.isWeChatGame)&&2<n/o,b8e.settings.resolutionPolicy!==b8e.ResolutionPolicy.FIXED_WIDTH&&s&&(i=15)):(s=(b8e.isMobile||b8e.isWeChatGame)&&2<o/n,b8e.settings.resolutionPolicy!==b8e.ResolutionPolicy.FIXED_WIDTH&&s&&(i=15))}var a=cc.view._devicePixelRatio;i*=a;var c=cc.game.canvas.width,l=cc.game.canvas.height,u=l/t.height,d=c,_=l-(i<<1)*a;return this._buildResult(c,l,d,_,u,u)}});b8e.FIXED_HEIGHT=new cc.ResolutionPolicy(cc.ContainerStrategy.EQUAL_TO_FRAME,new i)}if(!b8e.FULL_SCREEN){var n=cc.Class({name:"FullScreen",extends:cc.ContentStrategy,apply:function(e,t){var i,n,o=cc.game.canvas.width,r=cc.game.canvas.height,s=o/t.width,a=r/t.height,c=0;return n=(i=(c=s<a?s:a,o),r),this._buildResult(o,r,i,n,c,c)}});b8e.FULL_SCREEN=new cc.ResolutionPolicy(cc.ContainerStrategy.EQUAL_TO_FRAME,new n)}var o=b8e.designSize,r=o.width,s=o.height,a=void 0,c=b8e.settings.resolutionPolicy?b8e.settings.resolutionPolicy:b8e.ResolutionPolicy.AUTO;a=c===b8e.ResolutionPolicy.SHOW_ALL?b8e.SHOW_ALL:c===b8e.ResolutionPolicy.FIXED_WIDTH?b8e.FIXED_WIDTH:c===b8e.ResolutionPolicy.FULL_SCREEN?b8e.FULL_SCREEN:(b8e.ResolutionPolicy.FULL_HEIGHT,cc.ResolutionPolicy.FIXED_HEIGHT),cc.view.setDesignResolutionSize(r,s,a);var l=cc.winSize;if(c===b8e.ResolutionPolicy.AUTO){var u=r/l.width*s,d=o.minHeight?o.minHeight:s,_=o.maxHeight?o.maxHeight:s;l=(a=u<d||_<u?b8e.SHOW_ALL:b8e.FIXED_WIDTH,cc.view.setDesignResolutionSize(r,s,a),cc.winSize)}else if(c===b8e.ResolutionPolicy.FIXED_WIDTH){var h=o.minHeight?o.minHeight:s,f=o.maxHeight?o.maxHeight:s;(l.height<h||l.height>f)&&(a=b8e.SHOW_ALL,cc.view.setDesignResolutionSize(r,s,a),l=cc.winSize)}else if(c===b8e.ResolutionPolicy.FIXED_HEIGHT){var g=o.minWidth?o.minWidth:r,v=o.maxWidth?o.maxWidth:r;(l.width<g||l.width>v)&&(a=b8e.SHOW_ALL,cc.view.setDesignResolutionSize(r,s,a),l=cc.winSize)}else if(c===b8e.ResolutionPolicy.FULL_HEIGHT){var b=o.minWidth?o.minWidth:r,p=o.maxWidth?o.maxWidth:r;l.width<b?(a=b8e.FULL_SCREEN,cc.view.setDesignResolutionSize(r,s,a),l=cc.winSize):l.width>p&&(a=b8e.SHOW_ALL,cc.view.setDesignResolutionSize(r,s,a),l=cc.winSize)}var m=b8e.isCocos&&a==b8e.SHOW_ALL;b8e.scene&&b8e.scene.getViewDisplay().setMask(m?cc.Mask.Type.RECT:null),b8e.stage&&b8e.stage.setMask(m?cc.Mask.Type.RECT:null);var y=l.width,E=l.height,S=0,C=0,T=0,I=0,w=0,P=s/r;b8e.isIPhoneX()?(T=812/375/P,I=44,w=34,E<y?y-=(S=I*=T*P)+(w*=T*P):E-=(I*=T)+(C=w*=T)):b8e.isOpenAndroidAdapter()&&(T=2.4/P,I=50,w=20,E<y?y-=(S=I*=T*P)+(w*=T*P):E-=(I*=T)+(C=w*=T)),I=null!=b8e.notchScreenHeight?b8e.notchScreenHeight:I,b8e.topSpace=I,b8e.bottomSpace=w,b8e.stageWidth=y>>0,b8e.stageHeight=E>>0;var L=cc.view._devicePixelRatio;b8e.screenWidth=b8e.availWidth()*L,b8e.screenHeight=b8e.availHeight()*L,b8e.stage.x=S,b8e.stage.y=C,b8e.stage.setSize(b8e.stageWidth,b8e.stageHeight),b8e.log("\u821e\u53f0\u5c3a\u5bf8",b8e.stageWidth,b8e.stageHeight),b8e.layer.setSize(b8e.stageWidth,b8e.stageHeight);var R=b8e.scene;R&&R.setSize(b8e.stageWidth,b8e.stageHeight),b8e.cameraNode&&b8e.cameraNode.setPosition(y>>1,(E+I+w>>1)-w),A&&A.call(N,!0),b8e.evt.dptG(b8e.Event.STAGE_RESIZE)}},b8e.isIPhoneX=function(){var e=window,t=e.navigator;if(/iPad|iPhone|iPod/.test(t.userAgent)&&!e.MSStream){var i=e.devicePixelRatio||1,n=e.innerWidth*i,o=e.innerHeight*i;if(1125==n&&2436==o)return!0;if(2436==n&&1125==o)return!0;if(1242==n&&2688==o)return!0;if(2688==n&&1242==o)return!0;if(828==n&&1792==o)return!0;if(1792==n&&828==o)return!0}return!1},b8e.isOpenAndroidAdapter=function(){var e=window;if(-1<e.navigator.userAgent.indexOf("Android")&&!e.MSStream){var t=e.devicePixelRatio||1,i=e.innerWidth*t;if(2<=e.innerHeight*t/i)return!0}return!1},b8e.setNotchScreenHeight=function(e){b8e.notchScreenHeight=e||0};var i="gameContainer";b8e.availWidth=function(){if(b8e.params.isVivoGame||b8e.params.isOppoGame)return window.innerWidth;var e=cc.game.frame;if(e&&e.id!==i)return e.clientWidth;var t=document;return window.innerWidth||t.body.clientWidth||t.documentElement.clientWidth||t.documentElement.innerWidth},b8e.availHeight=function(){if(b8e.params.isVivoGame||b8e.params.isOppoGame)return window.innerHeight;var e=cc.game.frame;if(e&&e.id!==i)return e.clientHeight;var t=document;return window.innerHeight||t.body.clientHeight||t.documentElement.clientHeight||t.documentElement.clientHeight},b8e.getDevicePixelRatio=function(){return Math.min(2,window.devicePixelRatio||1)}}})(),function(){var e=b8e.JsUtil,t=b8e.CommonUtil=function(){};t.xyToInt=e.xyToInt,t.getXFromInt=e.getXFromInt,t.getYFromInt=e.getYFromInt,t.xyToNumber=e.xyToNumber,t.getXFromNumber=e.getXFromNumber,t.getYFromNumber=e.getYFromNumber,t.bytesToString=function(e){return e<1024?e+"b":e<10240?(e/1024).toFixed(2)+"kb":e<102400?(e/1024).toFixed(1)+"kb":e<1048576?(e>>10)+"kb":e<10485760?(e/1048576).toFixed(2)+"mb":e<104857600?(e/1048576).toFixed(1)+"mb":String(e>>20)+"mb"};var i=/\?/;t.urlAppendTimestamp=function(e){return"string"==typeof e&&(i.test(e)?e+="&_t="+(new Date-0):e+="?_t="+(new Date-0)),e};var n={x:0,y:0};t.convertToGL=function(e){var t=cc.winSize;return n.x=e.x,n.y=t.height-e.y,n},t.convertToUI=function(e){var t=cc.winSize;return n.x=e.x,n.y=t.height-e.y,n};var o={x:0,y:0},r={x:1,y:0},s={x:1,y:1},a={x:0,y:1},c={x:-1,y:1},l={x:-1,y:0},u={x:-1,y:-1},d={x:0,y:-1},_={x:1,y:-1};t.getDirectionByAngle=function(e){return(e=(e+360)%360)<23||338<=e?r:23<=e&&e<68?s:68<=e&&e<113?a:113<=e&&e<158?c:158<=e&&e<203?l:203<=e&&e<248?u:248<=e&&e<293?d:293<=e&&e<338?_:o},t.getDirectionByRadian=function(e){return e<-Math.PI*(7/8)||e>=Math.PI*(7/8)?l:e>=-Math.PI*(7/8)&&e<-Math.PI*(5/8)?u:e>=-Math.PI*(5/8)&&e<-Math.PI*(3/8)?d:e>=-Math.PI*(3/8)&&e<-Math.PI*(1/8)?_:e>=-Math.PI*(1/8)&&e<Math.PI*(1/8)?r:e>=Math.PI*(1/8)&&e<Math.PI*(3/8)?s:e>=Math.PI*(3/8)&&e<Math.PI*(5/8)?a:e>=Math.PI*(5/8)&&e<Math.PI*(7/8)?c:o},t.getRadianByDirection=function(e){if(!e)return 0;var t=e.x,i=e.y;return-1==t&&0==i?-Math.PI:-1==t&&-1==i?.75*-Math.PI:0==t&&-1==i?.5*-Math.PI:1==t&&-1==i?.25*-Math.PI:1==t&&0==i?0:1==t&&1==i?.25*Math.PI:0==t&&1==i?.5*Math.PI:-1==t&&1==i?.75*Math.PI:0},t.getAngleByDirection=function(e){if(!e)return 0;var t=e.x,i=e.y,n=0;return-1==t&&0==i?n=180:-1==t&&-1==i?n=-135:0==t&&-1==i?n=-90:1==t&&-1==i?n=-45:1==t&&0==i?n=0:1==t&&1==i?n=45:0==t&&1==i?n=90:-1==t&&1==i&&(n=135),n=(n+360)%360},t.convertToGlobalSpace=function(e,t){return e?(e.__BaseDisplay&&(e=e.getNode()),t=t||cc.v2(0,0),e.convertToWorldSpaceAR(t)):cc.v2(0,0)},t.convertToLocalSpace=function(e,t){return e?(e.__BaseDisplay&&(e=e.getNode()),t=t||cc.v2(0,0),e.convertToNodeSpaceAR(t)):cc.v2(0,0)}}(),function(){var g=b8e.SensitiveWords=function(){};g._maxSubStringLen=0,g._states={},g.init=function(e){if(e)for(var t=e.split(","),i=t.length,n=0;n<i;n++){var o=t[n];g._maxSubStringLen=Math.max(o.length,g._maxSubStringLen),g.addWord(o)}else b8e.error(3096)},g.addWord=function(e){for(var t=(e=e.toLowerCase()).length,i=[],n=!0,o=g._states,r="",s=void 0,a=0;a<t;a++){null!=o[s=r+e.charAt(a)]&&n?i=o[s]:(n=!1,o[s]=i),r=s}i[i.length]=e},g.filter=function(e,t,i){void 0===i&&(i=!0);for(var n="",o=(e=e.toLowerCase()).length,r=0;r<o;){var s="",a=0,c=0,l=Math.min(o-r,g._maxSubStringLen),u=r,d=r;for(c=0;c<l;c++){var _=e.charAt(u);if(!i||_){var h=s+_,f=g._states[h];if(!f){d==r&&(n+=e.charAt(r++));break}if(-1<f.indexOf(h)){for(;a<=c;a++)n+=t;r=u+1}s=h,u++}else u++}c==l&&(n+=e.charAt(r++))}return n},g.match=function(e){return!((e=g.filter(e,"*",!0)).indexOf("*")<0)}}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;(e=b8e.Object.extends({__GameConfig:!0,_cfgData:null,_keysList:null,_majorEquals:null,_alias:null,ctor:function(){this._super();var e=this._idName=b8e.getAliasName("id"),t=arguments.length;if(0<t)for(var i=this._keysList=[],n=0;n<t;n++){var o=arguments[n];if(!o)break;var r=[];if(Array.isArray(o)){var s=o.length;s<1&&b8e.error(2026);for(var a=0;a<s;a++)r[a]=b8e.getAliasName(o[a]);i[n]=r}else{r=[b8e.getAliasName(o)],i[n]=r}}else this._keysList=[[e]]},init:function(e,t,i){if(e)if(t)if(i){var n=this,o=!1;n._cfgData?o=!0:(n._cfgData=e,n._alias=t);var r=n._cfgData;if(e.setKeys.apply(r,[n._alias,i,o].concat(n._keysList)),!o){n._majorEquals={};var s=e.getMajorKeysByAlias(n._alias);if(s)for(var a=s.length,c=0;c<a;c++){var l=s[c];void 0===n._majorEquals[l]?n._majorEquals[l]=null:b8e.error(2027,l)}}r.onDataCreate(i,n.onDataCreate,n),n.onInited(i)}else b8e.error(2030);else b8e.error(2029);else b8e.error(2028)},onInited:function(){},onDataCreate:function(){},getUData:function(){return this.getData.apply(this,arguments)},getData:function(e){var t=this,i=arguments.length,n=e,o=void 0,r=null,s=!1;if(n&&(void 0===n?"undefined":v(n))===b8e.TypeObject)o=1,s=!0;else{if(!(r=t._cfgData.getMajorKeysByAlias(t._alias)))return b8e.error(2032,t._alias),null;o=r.length}var a=o<i&&!!arguments[o],c=!(o+1<i)||!!arguments[o+1],l=!(o+2<i)||!!arguments[o+2];if(s)return t._cfgData.getData(t._alias,n,a,c,l);for(var u=0;u<o;u++){var d=r[u];if(void 0===(n=arguments[u]))return b8e.error(2034,t._alias,d,n),null;if(void 0===t._majorEquals[d])return b8e.error(2033,d),null;t._majorEquals[d]=u<i?n:null}return t._cfgData.getData(t._alias,t._majorEquals,a,c,l)},getDataAsync:function(e){var t=this,i=arguments.length,n=e,o=void 0,r=null,s=!1;if(n&&(void 0===n?"undefined":v(n))===b8e.TypeObject)o=1,s=!0;else{if(!(r=t._cfgData.getMajorKeysByAlias(t._alias)))return void b8e.error(2035,t._alias);o=r.length}var a=o<i?arguments[o]:null,c=o+1<i?arguments[o+1]:null,l=o+2<i&&!!arguments[o+2],u=!(o+3<i)||!!arguments[o+3],d=!(o+4<i)||!!arguments[o+4],_=o+5<i?arguments[o+5]:null;if(s)t._cfgData.getDataAsync(t._alias,n,a,c,l,u,d,_);else{for(var h=0;h<o;h++){var f=r[h],g=arguments[h];if(void 0===g)return void b8e.error(2036,t._alias,f,g);if(void 0===t._majorEquals[f])return void b8e.error(2033,f);t._majorEquals[f]=h<i?g:null}t._cfgData.getDataAsync(t._alias,t._majorEquals,a,c,l,u,d,_)}},getDatas:function(e){return e=e||this._alias,this._cfgData.getDatas(e)},getKeys:function(e,t){return t=t||this._alias,this._cfgData.getKeys(t,e)}})).poolCall=!0,b8e.RC("$$b8e","$$GameConfig",e)})(),function(){var e=b8e.Endian=function(){};e.LITTLE_ENDIAN="littleEndian",e.BIG_ENDIAN="bigEndian"}(),function(){var e,s=e=b8e.PoolObject.extends({ctor:function(e){var t=this;t._super(),e=e?e instanceof ArrayBuffer?e:e.buffer:new ArrayBuffer(t.BUFFER_EXT_SIZE),t.BUFFER_EXT_SIZE=0,t._setArrayBuffer(e),t.endian=b8e.Endian.BIG_ENDIAN},_setArrayBuffer:function(e){this.write_position=e.byteLength,this.data=new DataView(e),this._position=0},setArrayBuffer:function(){},buffer:{get:function(){return this.data.buffer},set:function(e){var t=e instanceof ArrayBuffer?e:e.buffer;this.data=new DataView(t)}},dataView:{get:function(){return this.data},set:function(e){this.data=e,this.write_position=e.byteLength}},byteOffset:{get:function(){return this.data.byteOffset}},position:{get:function(){return this._position},set:function(e){this._position=e,this.write_position=e>this.write_position?e:this.write_position}},length:{get:function(){return this.write_position},set:function(e){var t=this;t.write_position=e;var i=new Uint8Array(new ArrayBuffer(e)),n=t.data.buffer.byteLength;e<n&&(t._position=e);var o=Math.min(n,e);i.set(new Uint8Array(t.data.buffer,0,o)),t.buffer=i.buffer}},bytesAvailable:{get:function(){return this.data.byteLength-this._position}},clear:function(){this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE))},readBoolean:function(){if(!this.validate(s.SIZE_OF_BOOLEAN))return null;var e=this._position,t=0!=this.data.getUint8(e);return this.position=e+1,t},readByte:function(){if(!this.validate(s.SIZE_OF_INT8))return null;var e=this._position,t=this.data.getInt8(e);return this.position=e+1,t},readBytes:function(e,t,i){var n=this;if(void 0===t&&(t=0),void 0===i&&(i=0),0==i)i=n.bytesAvailable;else if(!n.validate(i))return null;e?e.validateBuffer(t+i):e=new s(new ArrayBuffer(t+i));for(var o=n._position,r=0;r<i;r++)e.data.setUint8(r+t,n.data.getUint8(o)),o+=1;n.position=o},readDouble:function(){var e=this;if(!e.validate(s.SIZE_OF_FLOAT64))return null;var t=e._position,i=e.data.getFloat64(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_FLOAT6,i},readFloat:function(){var e=this;if(!e.validate(s.SIZE_OF_FLOAT32))return null;var t=e._position,i=e.data.getFloat32(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_FLOAT32,i},readInt:function(){var e=this;if(!e.validate(s.SIZE_OF_INT32))return null;var t=e._position,i=e.data.getInt32(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_INT32,i},readShort:function(){var e=this;if(!e.validate(s.SIZE_OF_INT16))return null;var t=e._position,i=e.data.getInt16(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_INT16,i},readUnsignedByte:function(){if(!this.validate(s.SIZE_OF_UINT8))return null;var e=this._position,t=this.data.getUint8(e);return this.position=e+1,t},readUnsignedInt:function(){var e=this;if(!e.validate(s.SIZE_OF_UINT32))return null;var t=e._position,i=e.data.getUint32(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_UINT32,i},readUnsignedShort:function(){var e=this;if(!e.validate(s.SIZE_OF_UINT16))return null;var t=e._position,i=e.data.getUint16(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_UINT16,i},readUTF:function(){var e=this;if(!e.validate(s.SIZE_OF_UINT16))return null;var t=e._position,i=e.data.getUint16(t,e.endian==b8e.Endian.LITTLE_ENDIAN);return e.position=t+s.SIZE_OF_UINT16,0<i?e.readUTFBytes(i):""},readUTFBytes:function(e){if(!this.validate(e))return null;var t=this._position,i=new Uint8Array(this.buffer,this.byteOffset+t,e);return this.position=t+e,b8e.BufferUtil.decodeUTF8(i)},writeBoolean:function(e){this.validateBuffer(s.SIZE_OF_BOOLEAN);var t=this._position;this.data.setUint8(t,e?1:0),this.position=t+1},writeByte:function(e){this.validateBuffer(s.SIZE_OF_INT8);var t=this._position;this.data.setInt8(t,e),this.position=t+1},writeBytes:function(e,t,i){var n=this;void 0===t&&(t=0),void 0===i&&(i=0);var o=void 0;if(!(t<0)&&!(i<0)&&0<(o=0==i?e.length-t:Math.min(e.length-t,i))){n.validateBuffer(o);for(var r=new DataView(e.buffer),s=o,a=n._position;4<s;s-=4)n.data.setUint32(a,r.getUint32(t)),a+=4,t+=4;for(;0<s;s--)n.data.setUint8(a,r.getUint8(t++)),a+=1;n.position=a}},writeDouble:function(e){var t=this;t.validateBuffer(s.SIZE_OF_FLOAT64);var i=t._position;t.data.setFloat64(i,e,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=i+s.SIZE_OF_FLOAT64},writeFloat:function(e){var t=this;t.validateBuffer(s.SIZE_OF_FLOAT32);var i=t._position;t.data.setFloat32(i,e,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=i+s.SIZE_OF_FLOAT32},writeInt:function(e){var t=this;t.validateBuffer(s.SIZE_OF_INT32);var i=t._position;t.data.setInt32(i,e,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=i+s.SIZE_OF_INT32},writeShort:function(e){var t=this;t.validateBuffer(s.SIZE_OF_INT16);var i=t._position;t.data.setInt16(i,e,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=i+s.SIZE_OF_INT16},writeUnsignedInt:function(e){var t=this;t.validateBuffer(s.SIZE_OF_UINT32);var i=t._position;t.data.setUint32(i,e,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=i+s.SIZE_OF_UINT32},writeUnsignedShort:function(e){var t=this;t.validateBuffer(s.SIZE_OF_UINT16);var i=t._position;t.data.setUint16(i,e,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=i+s.SIZE_OF_UINT16},writeUTF:function(e){var t=this,i=b8e.BufferUtil.encodeUTF8(e),n=i.length;t.validateBuffer(s.SIZE_OF_UINT16+n);var o=t._position;t.data.setUint16(o,n,t.endian==b8e.Endian.LITTLE_ENDIAN),t.position=o+s.SIZE_OF_UINT16,t.writeUint8Array(i,0,0,!1)},writeUTFBytes:function(e){this.writeUint8Array(b8e.BufferUtil.encodeUTF8(e))},toString:function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},writeUint8Array:function(e,t,i,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=!0);var o=void 0;if(!(t<0)&&!(i<0)&&0<(o=0==i?e.length-t:Math.min(e.length-t,i))){var r=this._position;n&&this.validateBuffer(r+o);for(var s=o,a=t;a<s;a++)this.data.setUint8(r,e[a]),r+=1;this.position=r}},toUint8Array:function(){return new Uint8Array(this.data.buffer)},validate:function(e){return 0<this.data.byteLength&&this._position+e<=this.data.byteLength},validateBuffer:function(e,t){var i=this;if(void 0===t&&(t=!1),i.write_position=e>i.write_position?e:i.write_position,e+=i._position,i.data.byteLength<e||t){var n=new Uint8Array(new ArrayBuffer(e+i.BUFFER_EXT_SIZE)),o=Math.min(i.data.buffer.byteLength,e+i.BUFFER_EXT_SIZE);n.set(new Uint8Array(i.data.buffer,0,o)),i.buffer=n.buffer}},recycle:function(){this.clear(),this._super()}});s.SIZE_OF_BOOLEAN=1,s.SIZE_OF_INT8=1,s.SIZE_OF_INT16=2,s.SIZE_OF_INT32=4,s.SIZE_OF_UINT8=1,s.SIZE_OF_UINT16=2,s.SIZE_OF_UINT32=4,s.SIZE_OF_FLOAT32=4,s.SIZE_OF_FLOAT64=8;var t=new b8e.Pool(s,1024);s.get=function(e){return t.get(e)},s.put=function(e){return t.put(e)},b8e.RC("$$b8e","$$ByteArray",e)}(),function(){var e,o=e=b8e.ByteArray.extends({ctor:function(e){this._super(e),this.endian=b8e.Endian.BIG_ENDIAN,o.count++},readBytes:function(e,t,i){void 0===i&&(i=4294967295),0!=i&&(4294967295==i?this._super(e,t,0):this._super(e,t,i))},readLong:function(){var e=this,t=void 0,i=void 0;return"bigEndian"==e.endian?(t=e.readInt(),i=e.readUnsignedInt()):(i=e.readUnsignedInt(),t=e.readInt()),t*o.POW_2_32+i},writeLong:function(e){var t=this,i=e/o.POW_2_32>>0,n=e%o.POW_2_32;"bigEndian"==t.endian?(t.writeInt(i),t.writeUnsignedInt(n)):(t.writeUnsignedInt(n),t.writeInt(i))},writeVarint32:function(e){for(;;){if(0==(-128&e))return void this.writeByte(e);this.writeByte(127&e|128),e>>>=7}},readVarint32:function(){return this.readUint32()},writeVarint64:function(){},readVarint64:function(){},readUint32:function(){var e=void 0,t=void 0,i=void 0;e=0;for(;;){if(t=this.readUnsignedByte(),!(e<32)){do{}while(128<=this.readUnsignedByte());break}if(!(128<=t)){i|=t<<e;break}i|=(127&t)<<e,e+=7}return i},writeUint32:function(e){for(;;){if(e<128)return void this.writeByte(e);this.writeByte(127&e|128),e>>>=7}},readString:function(){var e=this.readVarint32();return this.readUTFBytes(e)},writeString:function(e){var t=null;null==e?this.writeInt(0):((t=b8e.ByteArray.get()).writeUTFBytes(e),this.writeVarint32(t.length),this.writeBytes(t),t.release())},writeProtobuf:function(e){if(e){var t=e.encodeAB();this.writeUint8Array(new Uint8Array(t))}else b8e.error(3050,e)},readProtobuf:function(e,t){if(!e)return b8e.error(3051,e),null;var i=b8e.ByteArray.get();this.readBytes(i,0,t);var n=e.ctor.decode(i.toUint8Array());return i.release(),n},dump:function(e){void 0===e&&(e=16);var t=null,i=0,n="",o=b8e.ByteArray.get();if(o.writeBytes(this),o.position=0,10==e)for(;0<o.bytesAvailable;)15<++i?(n+=o.readUnsignedByte().toString()+"\n",i=0):n+=o.readUnsignedByte().toString()+" ";else{if(16!=e)throw new Error("radix \u53ea\u80fd\u4e3a 10 \u6216 16");for(;0<o.bytesAvailable;)1==(t=o.readUnsignedByte().toString(16)).length&&(t="0"+t),15<++i?(n+=t+"\n",i=0):n+=t+" "}return o.release(),n+"\n"},restore:function(){this.clear(),o.count++},recycle:function(){this.clear(),o.count--},release:function(){this.constructor===o?o.put(this):this.destroy()}});o.POW_2_32=Math.pow(2,32),o.count=0;var t=o.pool=new b8e.Pool(o,1024);o.get=function(e){return t.get(e)},o.put=function(e){return t.put(e)},b8e.RC("$$b8e","$$ByteBuffer",e)}(),function(){var e,i=e=b8e.Event.extends({ctor:function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this._super(e,t,i)}});i.dispatchErrorEvent=function(e){var t=b8e.Event.create(i,i.ERROR);return e.dispatchEvent(t)},i.ERROR="error",b8e.RC("$$b8e","$$ErrorEvent",e)}(),function(){var e,i=e=b8e.Event.extends({ctor:function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this._super(e,t,i)}});i.dispatchIOErrorEvent=function(e){var t=b8e.Event.create(i,i.IO_ERROR);return e.dispatchEvent(t)},i.IO_ERROR="ioError",b8e.RC("$$b8e","$$IOErrorEvent",e)}(),function(){var e,s=e=b8e.Event.extends({bytesLoaded:0,bytesTotal:0,ctor:function(e,t,i,n,o){void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===o&&(o=0);var r=this;r._super(e,t,i),r.bytesLoaded=0,r.bytesTotal=0,r.bytesLoaded=n,r.bytesTotal=o}});s.dispatchProgressEvent=function(e,t,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=!0);var r=b8e.Event.create(s,t);return r.isLazy=o,r.bytesLoaded=i,r.bytesTotal=n,e.dispatchEvent(r)?r:null},s.PROGRESS="progress",s.SOCKET_DATA="socketData",b8e.RC("$$b8e","$$ProgressEvent",e)}(),function(){var e,r=e=b8e.Event.extends({ctor:function(e,t,i){this._super(e,t,i)}});r.dispatchTimerEvent=function(e,t,i,n){var o=b8e.Event.create(r,t,i,n);return e.dispatchEvent(o)},r.TIMER="timer",r.TIMER_COMPLETE="timerComplete",b8e.RC("$$b8e","$$TimerEvent",e)}(),function(){var e;e=b8e.Enum({SCENE_MAP_LOAD_COMPLETE:"scene_map_load_complete",SCENE_MAP_CLICK:"scene_map_click",SCENE_ENTITY_CLICK:"scene_entity_click"}),b8e.RC("$$b8e","$$SceneEvent",e)}(),function(){var e;e=b8e.Enum({CAMERA_DISTANCE_CHANGE:"camera_distance_change"}),b8e.RC("$$b8e","$$CameraEvent",e)}(),function(){var f=b8e.evt=b8e.EventUtil={};b8e.SHC(f);var g=b8e.HashMap.get();f.instances=[],f.KEY=0,f.DISPATHCH=1,f.EVENT=2,f.FUNCTION=3,f.USECAPTURE=4,f.PRIORITY=5,f.USEWEAKREFERENCE=6,f.addEvent=function(e,t,i,n,o,r){t&&e&&i&&n||b8e.error(3071,"Evt.addEvent:dispatch|thisArg|event|func"),t.addEventListener(i,n,e,o,r);var s=f.instances;s[s.length]=[e,t,i,n,o,r]},f.addOnceEvent=function(i,n,o,r,s,e){f.addEvent(i,n,o,r,s,e);f.addEvent(i,n,o,function e(t){f.removeEvent(i,n,o,e,s),f.removeEvent(i,n,o,r,s)},s,e)},f.removeEvent=function(e,t,i,n,o){if(e){var r=void 0,s=void 0,a=0,c=void 0,l=void 0,u=!0;t&&(a|=4),i&&(a|=2),n&&(a|=1);var d=function(){switch(u=!0,a){case 0:r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]);break;case 1:r[f.FUNCTION]==n?r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]):u=!1;break;case 2:r[f.EVENT]==i?r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]):u=!1;break;case 3:r[f.EVENT]==i&&r[f.FUNCTION]==n?r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]):u=!1;break;case 4:r[f.DISPATHCH]==t?r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]):u=!1;break;case 5:r[f.DISPATHCH]==t&&r[f.FUNCTION]==n?r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]):u=!1;break;case 6:r[f.DISPATHCH]==t&&r[f.EVENT]==i?r[f.DISPATHCH].removeEventListener(r[f.EVENT],r[f.FUNCTION],e,r[f.USECAPTURE]):u=!1;break;case 7:r[f.DISPATHCH]==t&&r[f.EVENT]==i&&r[f.FUNCTION]==n?r[f.DISPATHCH].removeEventListener(i,n,e,o):u=!1}},_=void 0,h=void 0;if(s=g.get(e,null)){for(h=(_=s.length)-1;0<=h;h--)r=s[h],d(),u&&s.splice(h,1);s.length||g.del(e,null)}for(_=(s=f.instances).length,s=s.reverse(),h=_-1;0<=h;h--)(r=s[h])[f.KEY]==e?d():u=!1,u?s.pop():c==r[f.KEY]?l[l.length]=s.pop():(c=s[s.length-1][f.KEY],(l=g.get(c,null))?l[l.length]=s.pop():(l=[s.pop()],g.set(r[f.KEY],l,null)))}else b8e.error(3072,"Evt.removeEvent:thisArg")},f.clickInterval=100,f.globalDispatcher=new b8e.EventDispatcher,f.addG=f.addGlobalEvent=function(e,t,i,n,o){f.addEvent(e,f.globalDispatcher,t,i,n,o)},f.addGO=f.addGlobalOnceEvent=function(e,t,i,n,o){f.addOnceEvent(e,f.globalDispatcher,t,i,n,o)},f.rmvG=f.removeGlobalEvent=function(e,t,i,n){f.removeEvent(e,f.globalDispatcher,t,i,n)},f.dptG=f.dispatchGlobalEvent=function(e,t,i,n,o,r,s){f.globalDispatcher.dispatchEventWith(e,t,i,n,o,r,s)},f.touchEventCallback=null,f.setTouchEventCallback=function(e,t){f.touchEventCallback={callback:e,thisArg:t}},f._onTouchEffect=function(e,t){e.isButton&&(e.touchEffectDisabled||("touchstart"==t?(e.lastAnimScaleX||e.lastAnimScaleY||(e.lastAnimScaleX=e.scaleX,e.lastAnimScaleY=e.scaleY,e.lastAnimOffsetX=-(e.anchorX-.5)*e.width*.1,e.lastAnimOffsetY=-(e.anchorY-.5)*e.height*.1),b8e.Tween.kill(e),b8e.Tween.get(e).to({scaleX:.9*e.lastAnimScaleX,scaleY:.9*e.lastAnimScaleY,offsetX:e.lastAnimOffsetX,offsetY:e.lastAnimOffsetY},100)):"touchend"!=t&&"touchcancel"!=t||e.lastAnimScaleX&&e.lastAnimScaleY&&(b8e.Tween.kill(e),b8e.Tween.get(e).to({scaleX:e.lastAnimScaleX,scaleY:e.lastAnimScaleY,offsetX:0,offsetY:0},100))))},f.addButtonHandler=function(e){e.isButton=!0,f.onTouchStart(e,t,f),f.onTouchEnd(e,i,f),f.onTouchCancel(e,n,f)},f.removeButtonHandler=function(e){e.isButton=!1,f.offTouchStart(e,t,f),f.offTouchEnd(e,i,f),f.offTouchCancel(e,n,f)};var t=function(){};b8e.SHC(t);var i=function(){};b8e.SHC(i);var n=function(){};b8e.SHC(n),f.addListHandler=function(e){f.onTouchStart(e,o,f,0,!0),f.onTouchEnd(e,o,f,0,!0)},f.removeListHandler=function(e){f.offTouchStart(e,o,f),f.offTouchEnd(e,o,f)};var o=function(e){var t=e.touch,i=e.target,n=t.getLocation();i.hitTest(n)||(e.isPropagationStopped=!0)};b8e.SHC(o);var c="_$intervalTime";c=b8e.getNormP(c);function h(e){var t=this,i=e.type;if(i){var n=v.get(t,null);if(n){if(!e.isScrollEnd||t.__ScrollView){var o=n.get(i),r=o.interval;if(0<r){var s=b8e.getTimer();if(s-(0|+t[c+i])<r)return;t[c+i]=s}e.target=t,e._isDefaultPrevented=!1,e.isPropagationStopped=!1,e.isPropagationImmediateStopped=!1,e.stageX=e.getLocationX(),e.stageY=e.getLocationY();var a=o.callbacks;a.count()<1?b8e.error(2082,i):(a.every(l,null,e),e.isPropagationStopped&&e.stopPropagation(),e.isPropagationImmediateStopped&&e.stopPropagationImmediate(),b8e.SoundMgr.AUTOPLAY&&!b8e.SoundMgr._emptyPlayed&&(b8e.sound.playEffectSound("assets/resources/empty.mp3"),b8e.SoundMgr._emptyPlayed=!0),f._onTouchEffect(t,i),f.touchEventCallback&&f.touchEventCallback.callback.call(f.touchEventCallback.thisArg,thisArg,t,i))}}else b8e.error(2081,i)}}function l(e,t){return e&&e.callback?(e.callback.call(e.thisArg,t),!t.isPropagationImmediateStopped):(b8e.error(3074),!0)}b8e.SHC(h);var v=b8e.HashMap.get();f.onCCEvent=function(e,t,i,n,o,r,s){if(e&&e.__BaseDisplay){void 0===o&&(o=0),void 0===s&&(s=0);var a=null,c=v.get(e,null);c||(c=b8e.HashMap.get(),v.set(e,c,null));var l=c.get(t);if(l){if((a=l.callbackMap).get(i,n))return void b8e.warn(3154,t,i)}else{var u=h;e.addEventBin(t,u,e,0,!!r),l={type:t,handler:u,callbacks:b8e.LinkedList.get(),callbackMap:b8e.HashMap.get(),interval:s},c.set(t,l)}var d=l.callbacks;a=l.callbackMap;var _=b8e.CallBackData.get();_.callback=i,_.thisArg=n,_.data={priority:o},a.set(i,_,n),d.append(_)}else b8e.error(3073,e)},f.offCCEvent=function(e,t,i,n){if(e&&e.__BaseDisplay){var o=v.get(e,null);if(o){var r=o.get(t);if(r&&r.type===t){var s=r.callbacks,a=r.callbackMap,c=a.get(i,n);c?(b8e.CallBackData.put(c),a.del(i,n),s.remove(c),s.count()<1&&(s.release(),a.release(),o.del(t),e.removeEventBin(t),o.count()<1&&(o.release(),v.del(e,null)))):b8e.warn(3155,t,i)}}else b8e.warn(3156,t,i)}else b8e.error(3075,e)},f._removeEventRef=function(e,t){if(e&&e.__BaseDisplay){var i=v.get(e,null);if(i){var n=i.get(t);if(n&&n.type===t){n.callbacks.release();var o=n.callbackMap;o.forEach(f._onRemoveMap,f),o.release(),i.del(t),i.count()<1&&(i.release(),v.del(e,null))}}}else b8e.error(3076,e)},f._onRemoveMap=function(e,t){b8e.CallBackData.put(t)},f.onC=f.onClickEvent=function(e,t,i,n,o){var r=cc.Node.EventType.TOUCH_END;e.touchEnabled=!0,f.onCCEvent(e,r,t,i,n,o,f.clickInterval)},f.onTouchEnd=function(e,t,i,n,o){var r=cc.Node.EventType.TOUCH_END;e.touchEnabled=!0,f.onCCEvent(e,r,t,i,n,o)},f.offC=f.offClickEvent=f.offTouchEnd=function(e,t,i){var n=cc.Node.EventType.TOUCH_END;f.offCCEvent(e,n,t,i)},f.onTouchStart=function(e,t,i,n,o){var r=cc.Node.EventType.TOUCH_START;e.touchEnabled=!0,f.onCCEvent(e,r,t,i,n,o)},f.offTouchStart=function(e,t,i){var n=cc.Node.EventType.TOUCH_START;f.offCCEvent(e,n,t,i)},f.onTouchMove=function(e,t,i,n,o){var r=cc.Node.EventType.TOUCH_MOVE;e.touchEnabled=!0,f.onCCEvent(e,r,t,i,n,o)},f.offTouchMove=function(e,t,i){var n=cc.Node.EventType.TOUCH_MOVE;f.offCCEvent(e,n,t,i)},f.onTouchCancel=function(e,t,i,n,o){var r=cc.Node.EventType.TOUCH_CANCEL;e.touchEnabled=!0,f.onCCEvent(e,r,t,i,n,o)},f.offTouchCancel=function(e,t,i){var n=cc.Node.EventType.TOUCH_CANCEL;f.offCCEvent(e,n,t,i)},f.onMouseDown=function(e,t,i,n){f.onCCEvent(e,cc.Node.EventType.MOUSE_DOWN,t,i,n)},f.offMouseDown=function(e,t,i){f.offCCEvent(e,cc.Node.EventType.MOUSE_DOWN,t,i)},f.onMouseMove=function(e,t,i,n){f.onCCEvent(e,cc.Node.EventType.MOUSE_MOVE,t,i,n)},f.offMouseMove=function(e,t,i){f.offCCEvent(e,cc.Node.EventType.MOUSE_MOVE,t,i)},f.onMouseEnter=function(e,t,i,n){f.onCCEvent(e,cc.Node.EventType.MOUSE_ENTER,t,i,n)},f.offMouseEnter=function(e,t,i){f.offCCEvent(e,cc.Node.EventType.MOUSE_ENTER,t,i)},f.onMouseLeave=function(e,t,i,n){f.onCCEvent(e,cc.Node.EventType.MOUSE_LEAVE,t,i,n)},f.offMouseLeave=function(e,t,i){f.offCCEvent(e,cc.Node.EventType.MOUSE_LEAVE,t,i)},f.onMouseUp=function(e,t,i,n){f.onCCEvent(e,cc.Node.EventType.MOUSE_UP,t,i,n)},f.offMouseUp=function(e,t,i){f.offCCEvent(e,cc.Node.EventType.MOUSE_UP,t,i)},f.onMouseWheel=function(e,t,i,n,o){f.onCCEvent(e,cc.Node.EventType.MOUSE_WHEEL,t,i,n,o)},f.offMouseWheel=function(e,t,i){f.offCCEvent(e,cc.Node.EventType.MOUSE_WHEEL,t,i)}}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var u=b8e.ColorUtil=function(){};u.RED=16711680,u.GREEN=65280,u.BLUE=255,u.YELLOW=16776960,u.FUCHSIZA=16711935,u.AQUA=65535,u.BLACK=0,u.WHILE=16777215,u.GRAY=8421504,u.ORANGE=16737792,u.getAlpha=function(e){return e>>24&255},u.getRed=function(e){return e>>16&255},u.getGreen=function(e){return e>>8&255},u.getBlue=function(e){return 255&e},u.rgb=function(e,t,i){return e<<16|t<<8|i},u.argb=function(e,t,i,n){return(e<<24|t<<16|i<<8|n)>>>0},u.RYB=function(e,t,i){return 255-i<<16|255-e<<8|255-t},u.getChannel=function(e,t){switch(t){case u.RED:return e>>16&255;case u.GREEN:return e>>8&255;case u.BLUE:return 255&e}return 0},u.getColorTransform=function(e,t){return void 0===t&&(t=1),new ColorTransform((e>>16&255)/255,(e>>8&255)/255,(255&e)/255,t)},u.getColorTransform2=function(e,t){return void 0===t&&(t=1),new ColorTransform(1,1,1,1,e>>16&255*t,e>>8&255*t,e&255*t)},u.adjustColor=function(e,t,i){var n=void 0,o=void 0,r=void 0;return n=(u.RED&e)==e?Math.max(Math.min((t>>16&255)+i,255),0):t>>16&255,o=(u.GREEN&e)==e?Math.max(Math.min((t>>8&255)+i,255),0):t>>8&255,r=(u.BLUE&e)==e?Math.max(Math.min((255&t)+i,255),0):255&t,u.rgb(n,o,r)},u.adjustBrightness=function(e,t){var i=Math.max(Math.min((e>>16&255)+t,255),0),n=Math.max(Math.min((e>>8&255)+t,255),0),o=Math.max(Math.min((255&e)+t,255),0);return u.rgb(i,n,o)},u.adjustBrightness2=function(e,t){var i=void 0,n=void 0,o=void 0;return 0==t?e:(o=t<0?(i=(e>>16&255)*(t=(100+t)/100),n=(e>>8&255)*t,(255&e)*t):(i=e>>16&255,n=e>>8&255,o=255&e,i+=(255-i)*(t/=100),n+=(255-n)*t,o+=(255-o)*t,i=Math.min(i,255),n=Math.min(n,255),Math.min(o,255)),u.rgb(i,n,o))},u.rgbMultiply=function(e,t){return(e>>16&255)*(t>>16&255)/255<<16|(e>>8&255)*(t>>8&255)/255<<8|(255&e)*(255&t)/255},u.getPaletteArray=function(e,t,i){var n=new Matrix;n.createGradientBox(256,1);var o=new Shape;o.graphics.beginGradientFill(GradientType.LINEAR,e,t,i,n),o.graphics.drawRect(0,0,256,1),o.graphics.endFill();var r=new BitmapData(256,1);r.draw(o);for(var s=[],a=0;a<256;a++)s.push(r.getPixel(a,0));return r.dispose(),s},u.getColorBetween=function(e,t,i){var n=e>>16&255,o=e>>8&255,r=255&e;return n+((t>>16&255)-n)*i<<16|o+((t>>8&255)-o)*i<<8|r+((255&t)-r)*i},u.getColorAtPoint=function(e,t,i){var n=new BitmapData(1,1),o=new Matrix;return o.translate(-t,-i),n.draw(e,o),n.getPixel(0,0)},u.fromHEX=function(e){e=0===e.indexOf("#")?e.substring(1):e;var t=parseInt(e.substr(0,2),16)||0,i=parseInt(e.substr(2,2),16)||0,n=parseInt(e.substr(4,2),16)||0;return(parseInt(e.substr(6,2),16)||255)<<24>>>0|t<<16|i<<8|n},u.toHEX=function(e,t){void 0===t&&(t="#rrggbbaa");var i=e>>24&255,n=e>>8&255,o=255&e,r=[(0|e>>16&255).toString(16),(0|n).toString(16),(0|o).toString(16)],s=-1;if("#rgb"===t)for(s=0;s<r.length;++s)1<r[s].length&&(r[s]=r[s][0]);else if("#rrggbb"===t)for(s=0;s<r.length;++s)1===r[s].length&&(r[s]="0"+r[s]);else if("#rrggbbaa"===t)for(b8e.isCocos190?r.unshift((0|i).toString(16)):r.push((0|i).toString(16)),s=0;s<r.length;++s)1===r[s].length&&(r[s]="0"+r[s]);return"#"+r.join("")},u.lightUp=function(e,t){var i=(255&e)+t&16777215,n=(e>>8&255)+t&16777215,o=(e>>16)+t&16777215;return e=(i=255<i?255:i)<<16|(n=255<n?255:n)<<8|(o=255<o?255:o)},u.fromCYM=function(e){return(e>>24&255)<<24|255-(255&e)<<16|255-(e>>16&255)<<8|255-(e>>8&255)},u.toCYM=function(e){return(e>>24&255)<<24|255-(e>>8&255)<<16|255-(255&e)<<8|255-(e>>16&255)},u.fromHSL=function(e){var t=(e>>24&255)/255,i=(e>>16&255)/255,n=(e>>8&255)/255,o=(255&e)/255,r=void 0,s=void 0,a=void 0,c=void 0,l=void 0;return 0==n?r=s=a=o:(c=2*o-(l=o<.5?o*(1+n):o+n-n*o),r=u.Hue2RGB(c,l,i+1/3),s=u.Hue2RGB(c,l,i),a=u.Hue2RGB(c,l,i-1/3)),255*t<<24|255*r<<16|255*s<<8|255*a},u.Hue2RGB=function(e,t,i){return i<0&&(i+=1),1<i&&(i-=1),6*i<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e},u.toHSL=function(e){var t=(e>>24&255)/255,i=(e>>16&255)/255,n=(e>>8&255)/255,o=(255&e)/255,r=Math.min(i,Math.min(n,o)),s=Math.max(i,Math.max(n,o)),a=void 0,c=void 0,l=(s+r)/2,u=s-r;if(0==u)a=c=0;else{c=l<.5?u/(s+r):u/(2-s-r);var d=((s-i)/6+u/2)/u,_=((s-n)/6+u/2)/u,h=((s-o)/6+u/2)/u;i==s?a=h-_:n==s?a=1/3+d-h:o==s&&(a=2/3+_-d),a<0&&(a+=1),1<a&&(a-=1)}return 255*t<<24|255*a<<16|255*c<<8|255*l},u.toRGB=function(e){return[e>>16,e>>8&255,255&e]},u.toDec=function(e){return null==e||3!=e.length||e[0]<0||255<e[0]||e[1]<0||255<e[1]||e[2]<0||255<e[2]?16777215:e[0]<<16|e[1]<<8|e[2]},u.ratioColor=function(e,t,i){i<0?i=0:1<i&&(i=1);var n=u.toRGB(e),o=u.toRGB(t),r=n[0]+(o[0]-n[0])*i,s=n[1]+(o[1]-n[1])*i,a=n[2]+(o[2]-n[2])*i;return u.toDec([r,s,a])},u.ratioColorTransform=function(e,t,i){return[Number(e[0])+(Number(t[0])-Number(e[0]))*i,Number(e[1])+(Number(t[1])-Number(e[1]))*i,Number(e[2])+(Number(t[2])-Number(e[2]))*i,Number(e[3])+(Number(t[3])-Number(e[3]))*i]},u.toCCColor=function(e){if((void 0===e?"undefined":v(e))!==b8e.TypeNumber)return e?e instanceof cc.Color?e:new cc.Color(e):(b8e.error(3060,e),null);var t=e>>24&255,i=e>>16&255,n=e>>8&255,o=255&e;return new cc.Color({r:i,g:n,b:o,a:t})}})(),function(){var e;e=b8e.Enum({AUTO:0,SHOW_ALL:1,FIXED_WIDTH:2,FIXED_HEIGHT:3,FULL_SCREEN:4,FULL_HEIGHT:5}),b8e.RC("$$b8e","$$ResolutionPolicy",e)}(),function(){var e;e=b8e.Enum({AUTO:0,PORTRAIT:1,LANDSCAPE:2,PORTRAIT_UPSIDE_UP:3,PORTRAIT_UPSIDE_DOWN:4}),b8e.RC("$$b8e","$$OrientationType",e)}(),function(){var e;e=b8e.Enum({NONE:0,BITMAP:1,CHAR:2}),b8e.RC("$$b8e","$$CacheMode",e)}(),function(){var e;e=b8e.Enum({CANVAS:1,WEBGL:2,OPENGL:3}),b8e.RC("$$b8e","$$RenderType",e)}(),function(){var e;e=b8e.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3}),b8e.RC("$$b8e","$$OverflowType",e)}(),function(){var e,t=e=b8e.Enum({LEFT:0,CENTER:1,RIGHT:2,JUSTIFY:3,CONTENT_JUSTIFY:4}),i=void 0;t.toCC=function(e){return i||((i={})[t.LEFT]=0,i[t.CENTER]=1,i[t.RIGHT]=2),i[e]},b8e.RC("$$b8e","$$HorizontalAlign",e)}(),function(){var e;e=b8e.Enum({TOP:0,MIDDLE:1,BOTTOM:2}),b8e.RC("$$b8e","$$VerticalAlign",e)}(),function(){var e;e=b8e.Enum({RECT:0,ELLIPSE:1,GRAPH:2,IMAGE:3}),b8e.RC("$$b8e","$$MaskType",e)}(),function(){var e;e=b8e.Enum({NORMAL:0,ADD:-1,DARKEN:-1,DIFFERENCE:-1,ERASE:-1,INVERT:-1,LAYER:-1,LIGHTEN:-1,MULTIPLY:-1,OVERLAY:-1,SCREEN:-1,SUBTRACT:-1}),b8e.RC("$$b8e","$$BlendMode",e)}(),function(){var e;e=b8e.Enum({IOS:"iOS",ANDROID:"Android",WINDOWS:"Windows"}),b8e.RC("$$b8e","$$OS",e)}(),function(){var e;e=b8e.Enum({DEVELOP:1,TRIAL:2,RELEASE:3}),b8e.RC("$$b8e","$$WeChatEnv",e)}(),function(){var e;e=b8e.Enum({TEXT:"text",ARRAY_BUFFER:"arraybuffer"}),b8e.RC("$$b8e","$$HttpResponseType",e)}(),b8e.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},function(){var e,n=e=b8e.Object.extends({_sprite:null,_lastColorTransfrom:null,_colorTransfrom:null,_lastGamma:1,_gamma:1,_lastIsMix:!1,_isMix:!1,_lastIsBtf:!1,_isBtf:!1,_key:null,_glProgram:null,ctor:function(e){this._super(),this._sprite=e,this._lastColorTransfrom=new b8e.ColorTransfrom,this._colorTransfrom=new b8e.ColorTransfrom},reset:function(){this._colorTransfrom.clear(),this._gamma=1,this._isMix=!1,this._isBtf=!1},getColorTransfrom:function(){return this._colorTransfrom},setGamma:function(e){this._gamma=e},setIsMix:function(e){this._isMix=e},setIsBtf:function(e){this._isBtf=e},glProgram:{get:function(){return this._glProgram}},update:function(e){var t=this,i=!1;e&&(i=!0),i||t._lastColorTransfrom.equals(t._colorTransfrom)||(i=!0),i||t._lastGamma==t._gamma||(i=!0),i||t._lastIsMix==t._isMix||(i=!0),i||t._lastIsBtf==t._isBtf||(i=!0),i&&(t._key=t._colorTransfrom.toString()+"_"+t._gamma+"_"+t._isMix+"_"+t._isBtf,b8e.renderType===b8e.RenderType.WEBGL&&(t._glProgram=n.applyGlProgram(t),t._sprite&&t._glProgram&&t._sprite._sgNode.setShaderProgram(t._glProgram)),t._lastGamma=t._gamma,t._lastIsMix=t._isMix,t._lastIsBtf=t._isBtf,t._lastColorTransfrom.setData(t._colorTransfrom.getData()))},dispose:function(){var e=this;e._key=null,e._glProgram=null,e._sprite=null,e._lastColorTransfrom=null,e._colorTransfrom=null,e._lastGamma=0,e._gamma=0,e._lastIsMix=!1,e._isMix=!1,e._lastIsBtf=!1,e._isBtf=!1}});n.U_MULTIPLIER="u_multiplier",n.U_OFFSETCOLOR="u_offsetColor",n.U_GAMMA="u_gamma",n.U_IS_MIX="u_isMix",n.U_IS_BTF="u_isBtf";var t=n.programCache=b8e.HashMap.get();n.applyGlProgram=function(e){return null},n.createProgram=function(e,t){var i=new cc.GLProgram;return cc.sys.isNative?i.initWithString(e,t):(i.initWithVertexShaderByteArray(e,t),i.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),i.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),i.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS)),i.link(),i.updateUniforms(),i},n.createDefaultSpriteProgram=function(){var e=n.DEFAULT_SPRITE_VERT_SHADER,t=n.DEFAULT_SPRITE_FRAG_SHADER;return n.createProgram(e,t)},n.getCount=function(){return t.count()},b8e.RC("$$b8e","$$ShaderProgram",e)}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,a=e=b8e.PoolObject.extends({__BaseDisplay:!0,_needActiveInHierarchyEvent:!1,ctor:function(e){if(b8e.ready){var t=this;t._super(),a.count++,((e=t._node=e||t._createNode())._b8eDisplay=t)._children=b8e.LinkedList.get(),t._removeList=b8e.LinkedList.get(),t._pos={x:NaN,y:NaN,z:NaN},t._offset={x:NaN,y:NaN,z:NaN},t._rot={x:NaN,y:NaN,z:NaN},t._anchor={x:NaN,y:NaN},t._eventMap=b8e.HashMap.get(),t._eventList=b8e.LinkedList.get(),t._hierarchyVisible=!0,a.inHierarchyCount++,t.resetDisplay()}else b8e.error(2037)},_createNode:function(){return b8e.createNode()},needActiveInHierarchyEvent:{set:function(e){this._needActiveInHierarchyEvent!=e&&(this._needActiveInHierarchyEvent=e,this._applyActiveInHierarchyEvent())}},_applyActiveInHierarchyEvent:function(){this._needActiveInHierarchyEvent||0<this._eventMap.count()?this._addActiveInHierarchyEvent():this._removeActiveInHierarchyEvent()},_addActiveInHierarchyEvent:function(){if(!this._hasActiveInHierarchyEvent){this._hasActiveInHierarchyEvent=!0;var e=this._node;e.onActiveInHierarchy||(e.onActiveInHierarchy=i),i.call(this._node)}},_removeActiveInHierarchyEvent:function(){var e=this;if(e._hasActiveInHierarchyEvent){e._hasActiveInHierarchyEvent=!1,e._node.onActiveInHierarchy=null;var t=s(e);t&&t.remove(e),i.call(e._node)}},_addSizeChangedEvent:function(){var e=this;e._hasSizeChangedEvent||(e._hasSizeChangedEvent=!0,e._node.on("size-changed",e._onSizeChanged,e))},_removeSizeChangedEvent:function(){var e=this;e._hasSizeChangedEvent&&(e._hasSizeChangedEvent=!1,e._node.off("size-changed",e._onSizeChanged,e))},_addAnchorChangedEvent:function(){var e=this;e._hasAnchorChangedEvent||(e._hasAnchorChangedEvent=!0,e._node.on("anchor-changed",e._onAnchorChanged,e))},_removeAnchorChangedEvent:function(){var e=this;e._hasAnchorChangedEvent&&(e._hasAnchorChangedEvent=!1,e._node.off("anchor-changed",e._onAnchorChanged,e))},getNode:function(){return this._node},node:{get:function(){return this}},numChildren:{get:function(){return this._children.count()}},getChildren:function(){return this.children},children:{get:function(){return this._children}},_applyOpacity:function(){var e=this._node,t=this._alpha*this._contentAlpha*255>>0;0==t&&(t=1e-4),e.opacity=t},setAlpha:function(e){this._node&&this._alpha!=e&&(this._alpha=e,this._applyOpacity())},opacity:{set:function(e){this.setAlpha(255*e)},get:function(){return this._alpha/255}},alpha:{set:function(e){this.setAlpha(e)},get:function(){return this._alpha}},contentAlpha:{set:function(e){this._node&&this._contentAlpha!=e&&(this._contentAlpha=e,this._applyOpacity())},get:function(){return this._contentAlpha}},setSize:function(e,t){this._fixedWidth=e,this._fixedHeight=t,this._setContentSize(e,t)&&this._applyContentSize(e,t)},_setContentSize:function(e,t){var i=this;return(i._width!=e||i._height!=t)&&(i._width=e,i._height=t,i._updateAnchorOffset(),i.syncPosition(),!0)},_updateAnchor:function(){this._applyAnchor(),this._applyAnchorOffset(),this._updateDebugSurface()},_applyAnchor:function(){this._node.setAnchorPoint(this._anchor.x,this._anchor.y)},_updateAnchorOffset:function(){},_applyAnchorOffset:function(){},setScale:function(e,t){var i=this;i._scaleX==e&&i._scaleY==t||(i._scaleX=e,i._scaleY=t,i._applyScale())},color:{set:function(e){this.setColor(e)},get:function(){return this._color}},setColor:function(e){var t=b8e.ColorUtil.toCCColor(e);t._val!==this._color&&(this._color=t._val,this._node.color=t)},setContentScale:function(e,t){var i=this;i._contentScaleX==e&&i._contentScaleY==t||(i._contentScaleX=e,i._contentScaleY=t,i._applyScale())},contentScaleX:{set:function(e){this.setContentScale(e,this._contentScaleY)},get:function(){return this._contentScaleX}},contentScaleY:{set:function(e){this.setContentScale(this._contentScaleX,e)},get:function(){return this._contentScaleY}},offsetX:{set:function(e){var t=this._offset;t&&t.x!=e&&(t.x=e,this.syncPosition())},get:function(){var e=this._offset;return e?e.x:0}},offsetY:{set:function(e){var t=this._offset;t&&t.y!=e&&(t.y=e,this.syncPosition())},get:function(){var e=this._offset;return e?e.y:0}},offsetZ:{set:function(e){var t=this._offset;t&&t.z!=e&&(t.z=e,this.syncPosition())},get:function(){var e=this._offset;return e?e.z:0}},x:{set:function(e){var t=this._pos;t&&t.x!=e&&(t.x=e,this.syncPosition())},get:function(){var e=this._pos;return e?e.x:0}},y:{set:function(e){var t=this._pos;t&&t.y!=e&&(t.y=e,this.syncPosition())},get:function(){var e=this._pos;return e?e.y:0}},z:{set:function(e){var t=this._pos;t&&t.z!=e&&(t.z=e,this.syncPosition())},get:function(){var e=this._pos;return e?e.z:0}},scaleX:{set:function(e){this._scaleX!=e&&(this._scaleX=e,this._applyScale())},get:function(){return this._scaleX}},scaleY:{set:function(e){this._scaleY!=e&&(this._scaleY=e,this._applyScale())},get:function(){return this._scaleY}},_applyScale:function(){var e=this,t=e._contentScaleX*e._scaleX*(e._flippedX?-1:1),i=e._contentScaleY*e._scaleY;0==t&&(t=1e-4),0==i&&(i=1e-4),e._node.setScale(t,i)},width:{set:function(e){this.setSize(e,this._height)},get:function(){return this.getWidth()}},height:{set:function(e){this.setSize(this._width,e)},get:function(){return this.getHeight()}},rotation:{set:function(e){var t=this._rot;t.z!=e&&(t.z=e,this.syncRotation(this))},get:function(){return this._rot.z}},_onSizeChanged:function(){this._width=this._node.width,this._height=this._node.height},_onAnchorChanged:function(){this._anchor.x=this._node.anchorX,this._anchor.y=this._node.anchorY},getWidth:function(){return this._width},getHeight:function(){return this._height},setAnchor:function(e,t){var i=this;i._anchor.x==e&&i._anchor.y==t||(i._anchor.x=e,i._anchor.y=t,i._updateAnchor(),i._updateAnchorOffset())},anchorX:{set:function(e){this.setAnchor(e,this._anchor.y)},get:function(){return this._anchor.x}},anchorY:{set:function(e){this.setAnchor(this._anchor.x,e)},get:function(){return this._anchor.y}},getAnchor:function(){return this._anchor},setSyncPosition:function(e,t,i,n,o,r){var s=this._pos;if(s){var a=this._offset;s.x==e&&s.y==t&&s.z==i&&a.x==n&&a.y==o&&a.z==r||(s.x=e,s.y=t,s.z=i,a.x=n,a.y=o,a.z=r,this.syncPosition())}},setPosition:function(e,t,i){if(this._node){var n=this._pos;n&&(null==t?n.x==e.x&&n.y==e.y&&n.z==e.z||(n.x=e.x,n.y=e.y,n.z=e.z,this.syncPosition()):n.x==e&&n.y==t&&n.z==i||(n.x=e,n.y=t,n.z=i,this.syncPosition()))}else b8e.error(2038)},setOffset:function(e,t,i){if(this._node){var n=this._offset;null==t?n.x==e.x&&n.y==e.y&&n.z==e.z||(n.x=e.x,n.y=e.y,n.z=e.z,this.syncPosition()):n.x==e&&n.y==t&&n.z==i||(n.x=e,n.y=t,n.z=i,this.syncPosition())}},setRotation:function(e,t,i){var n=this;if(n._node){var o=n._rot;null==t?o.x==e.x&&o.y==e.y&&o.z==e.z||(o.x=e.x,o.y=e.y,o.z=e.z,n.syncRotation(n)):o.x==e&&o.y==t&&o.z==i||(o.x=e,o.y=t,o.z=i,n.syncRotation(n))}else b8e.error(2039)},getPosition:function(){return this._pos},getOffset:function(){return this._offset},getRotation:function(){return this._rot},_applyPosition:function(e,t){this._node.setPosition(e,t),this._updateDebugSurface()},_getNodeOffsetX:function(){return 0},_applyContentSize:function(e,t){this._node.setContentSize(e,t),this._updateDebugSurface()},syncPosition:function(){var e=this;if(e._node){e._disX=e._pos.x+e._offset.x,e._disY=e._pos.y+e._offset.y,e._applyPosition(e._disX,e._disY);var t=e._syncImmedInfos;if(t&&e.syncAllInfoImmed(),t=e._syncInfos)if(e.syncImmed)e.syncAllInfo();else a._lazySync.add(e)}},_setRotation:function(e){this._node.rotation=e},syncRotation:function(){var e=this;e._node&&(e._setRotation(e._rot.z),e.syncAllInfoImmed(),e.syncAllInfo())},syncAllInfo:function(){var e=this._syncList;e&&e.forEach(this._syncObjInfo,this)},syncAllInfoImmed:function(){var e=this._syncImmedList;e&&e.forEach(this._syncObjInfo,this)},_syncObjInfo:function(e){this.onSyncInfo(e)},addSyncInfo:function(e,t){if(e){var i=this,n=e.getObj(),o=void 0,r=void 0;if(t){if(i._syncInfos&&i._syncInfos.get(n,i))return void b8e.error(2040);o=(o=i._syncImmedInfos)||(i._syncImmedInfos=b8e.HashMap.get()),r=(r=i._syncImmedList)||(i._syncImmedList=b8e.LinkedList.get())}else{if(i._syncImmedInfos&&i._syncImmedInfos.get(n,i))return void b8e.error(2041);o=(o=i._syncInfos)||(i._syncInfos=b8e.HashMap.get()),r=(r=i._syncList)||(i._syncList=b8e.LinkedList.get())}var s=o.get(n,i);if(s!==e){if(s)return void b8e.warn(3120);(n=e.getObj())&&(o.set(n,e,i),r.append(e),n.__BaseDisplay&&(n._syncTarget=i,n.addReleaseCallback(i.onSyncObjRelease,i,[i])))}i.onSyncInfo(e)}},onSyncInfo:function(e){e.syncInfo&&e.syncInfo(this._pos,this._rot)},removeSyncInfo:function(e){if(e){var t=this,i=!1,n=null,o=t._syncImmedInfos,r=t._syncImmedList;if(o&&(n=o.get(e,t)),n?i=!0:(r=t._syncList,(o=t._syncInfos)&&(n=o.get(e,t))),n){var s=n.getObj();if(s&&(s.__BaseDisplay&&(s._syncTarget=null,s.removeReleaseCallback(t.onSyncObjRelease,t)),o.del(s,t)),n.dispose(),r.remove(n),o.count()<1)if(o.release(),o=null,r.release(),r=null,i)t._syncImmedInfos=null,t._syncImmedList=null;else t._syncInfos=null,t._syncList=null,a._lazySync.remove(t)}}},removeAllSyncInfo:function(){var e=this,t=e._syncInfos;t&&(t.forEach(e._removeObjSync,e),t.release(),e._syncInfos=t=null,e._syncList.release(),e._syncList=null,a._lazySync.remove(e))},_removeObjSync:function(e,t){e.__BaseDisplay&&(e._syncTarget=null,e.removeReleaseCallback(this.onSyncObjRelease,this)),t.dispose()},onSyncObjRelease:function(e){this.removeSyncInfo(e)},removeAllSyncImmedInfo:function(){var e=this,t=e._syncImmedInfos;t&&(t.forEach(e._removeObjSyncImmed,e),t.release(),e._syncImmedInfos=t=null,e._syncImmedList.release(),e._syncImmedList=null)},_removeObjSyncImmed:function(e,t){e.__BaseDisplay&&(e._syncTarget=null,e.removeReleaseCallback(this.onSyncObjRelease,this)),t.dispose()},syncTo:function(e,t,i,n){var o=new b8e.DisplaySyncInfo(this,!!t,!!i);e.addSyncInfo(o,!!n)},unSyncTarget:function(){var e=this._syncTarget;e&&(e.usable&&e.removeSyncInfo(this),this._syncTarget=e=null)},localToGlobal:function(e){var t=this._offset;return(e=b8e.CommonUtil.convertToGlobalSpace(this,e)).x-=t.x,e.y+=t.y,e},globalToLocal:function(e){var t=this._offset;return(e=b8e.CommonUtil.convertToLocalSpace(this,e)).x-=t.x,e.y+=t.y,e},_applyLocalZOrder:function(){var e=this._node;b8e.isCocos190?e.setLocalZOrder(this._zIndex):e.zIndex=this._zIndex},_setParent:function(e){var t=this;if(t.parent==e)return!1;(t.parent=e)?t.isStage||(b8e.stage.displaySniffEnable&&b8e.stage._addDisplaySniff(t),b8e.stage.displayDebugEnable&&t.displayDebugEnable&&t.showDebugSurface()):(t.isStage||(b8e.stage.displaySniffEnable&&b8e.stage._removeDisplaySniff(t),b8e.stage.displayDebugEnable&&t.displayDebugEnable&&t.hideDebugSurface()),a._lazyChild.remove(t));return t._updateDebugSurface(),t.syncPosition(),!0},addToParent:function(e){if(e){var t=this;e.__BaseDisplay?e.addChild(t):e instanceof cc.Node?t._node&&t._node.parent!=e&&(t.removeFromParent(),t._setParent(e),e.addChild(t._node)):b8e.error(2042,void 0===e?"undefined":v(e))}else b8e.error(2042,void 0===e?"undefined":v(e))},removeFromParent:function(){var e=this;e.parent&&(e.parent.__BaseDisplay?e.parent.removeChild(e):e.parent instanceof cc.Node&&e.parent.removeChild(e._node,!1),e._setParent(null))},removeAllChildren:function(e){var t=this,i=t._children;i&&(i.count()<1||(t._removeAllForce=e,t._allRemoving=!0,i.forEach(t._onRemoveChild,t),t._removeList.forEach(t._onRemoveFromList,t),t._allRemoving=!1))},_onRemoveChild:function(e){!this._removeAllForce&&e.clearDisabled||this.removeChild(e)},_onRemoveFromList:function(e){this._children.remove(e)},setLazy:function(e){var t=this;if(t.isLazy!=e&&!(t.isLazy=e)){var i=t.parent;if(i)if(t._node.parent!==i._node)a._lazyChild.remove(t),i._node.addChild(t._node)}},addChildAt:function(e){this._node&&(e||b8e.error(2043,void 0===e?"undefined":v(e)))},addChild:function(e){var t=this._node;if(t)if(e){if(e.__BaseDisplay){if(e._node)if(e.parent!=this)if(e.removeFromParent(),e._setParent(this),e.isLazy)a._lazyChild.add(e);else t.addChild(e._node)}else{if(!(e instanceof cc.Node))return void b8e.error(2043,void 0===e?"undefined":v(e));e.parent!=t&&(e.removeFromParent(!1),t.addChild(e))}this._children.append(e)}else b8e.error(2043,void 0===e?"undefined":v(e))},removeChild:function(e){var t=this,i=t._node;if(i)if(e){if(e.__BaseDisplay)e._node&&e.parent==t&&(e._setParent(null),i.removeChild(e._node,!1));else{if(!(e instanceof cc.Node))return void b8e.error(2044,void 0===e?"undefined":v(e));e.parent==i&&i.removeChild(e,!1)}t._allRemoving?t._removeList.append(e):t._children.remove(e)}else b8e.error(2044,void 0===e?"undefined":v(e))},hitTest:function(e){var t=this._node,i=t._touchListener;return!(!i||!t._hitTest(e,i))},convertToNodeSpaceAR:function(e){return this._node.convertToNodeSpaceAR(e)},setVisible:function(e){var t=this;t._visible!=e&&((t._visible=e)?t.lazyActive?a._lazyActive.add(t):t._node.active||(t._node.active=!0):(a._lazyActive.remove(t),t._node.active&&(t._node.active=!1)))},getVisible:function(){return this._visible},active:{set:function(e){this.setVisible(e)},get:function(){return this.getVisible()}},_applyProperties:function(){},_setHierarchyVisible:function(e){var t=this;if(t.usable&&(t._node&&t._hierarchyVisible!=e)){t._hierarchyVisible=e;var i=t._eventList;e?(i.forEach(t._onEvent,t),a.inHierarchyCount++):(i.forEach(t._offEvent,t),a.inHierarchyCount--),t._applyProperties(),t.onHierarchyVisible(t._hierarchyVisible),t.usable}},_onEvent:function(e){if(!e.listening){var t=this._node;e.listening=!0,t.on(e.type,e.listener,e.thisObject,e.useCapture),a.nodeEventCount++}},_offEvent:function(e){e.listening&&(e.listening=!1,this._node.off(e.type,e.listener,e.thisObject),a.nodeEventCount--)},_removeEvent:function(e){this._offEvent(e),b8e.evt._removeEventRef(this,e.type),e.release()},onHierarchyVisible:function(){},_onActiveInHierarchy:function(){this.usable&&this._setHierarchyVisible(!this._hasActiveInHierarchyEvent||this._node._activeInHierarchy)},getHierarchyVisible:function(){return this._hierarchyVisible},setLocalZOrder:function(e){this._zIndex!=e&&((this._zIndex=e)>a.MIN_ZINDEX&&e<a.MAX_ZINDEX?this._applyLocalZOrder():b8e.error(2045,e,a.MIN_ZINDEX,a.MAX_ZINDEX))},getLocalZOrder:function(){return this._zIndex},setFlippedX:function(e){this._flippedX!=e&&(this._flippedX=e,this._applyScale())},getFlippedX:function(){return this._flippedX},getBoundingBox:function(){return this._node.getBoundingBox()},setMask:function(e){var t=this;if((void 0===e?"undefined":v(e))===b8e.TypeNumber){var i=void 0;switch(t._useMask?i=t._node.getComponent(cc.Mask):(i=t._node.addComponent(cc.Mask),b8e.isCocos190&&"function"==typeof i.__preload&&i.__preload()),i.isGraphMode=!1,e){case b8e.MaskType.RECT:e=cc.Mask.Type.RECT;break;case b8e.MaskType.ELLIPSE:e=cc.Mask.Type.ELLIPSE;break;case b8e.MaskType.GRAPH:e=cc.Mask.Type.RECT,i.isGraphMode=!0}i.type=e,t._useMask=!0}else t._useMask&&(t._node.removeComponent(cc.Mask),t._useMask=!1)},getMaskGraphics:function(){var e=null;return this._useMask&&(e=this._node.getComponent(cc.Mask)),e&&e.isGraphMode?b8e.isCocos190?e._clippingStencil:e._graphics:null},_updateDebugSurface:function(){var e=this,t=e._debugSurface;if(t&&(t.setSize(e.width,e.height),t.clear(),e.parent?(e.parent.addChild(t),0<e.width&&0<e.height&&(e._isWireframeSurface?(t.lineWidth(1),t.strokeColor(4294901760),t.moveTo(0,0),t.lineTo(e.width,0),t.lineTo(e.width,e.height),t.lineTo(0,e.height),t.lineTo(0,0),t.stroke()):(t.lineWidth(0),t.strokeColor(0),t.fillColor((4278190080|16777215*Math.random()>>>0)>>>0),t.fillRect(0,0,e.width,e.height)),t.setPosition(e.x-e.width*e.anchorX,e.y-e.height*e.anchorY))):t.removeFromParent()),t=e._debugSurfaceTop)if(t.setSize(e.width,e.height),t.clear(),e.parent){if(e.parent.addChild(t),0<e.width&&0<e.height){t.lineWidth(2),t.strokeColor(4294901760);for(var i=0;i<e.width;i+=16)t.moveTo(i,e.height),t.lineTo(i,0),t.stroke();for(var n=0;n<e.height;n+=16)t.moveTo(0,e.height-n),t.lineTo(e.width,e.height-n),t.stroke();t.setPosition(e.x-e.width*e.anchorX,e.y-e.height*e.anchorY)}}else t.removeFromParent()},showDebugSurface:function(e){var t=this;t._isWireframeSurface=!!e;var i=t._debugSurface;i||((i=t._debugSurface=bui.Graphics.get()).displaySniffEnable=!1,i.displayDebugEnable=!1,i.setLocalZOrder(-3e4)),t.renderable&&((i=t._debugSurfaceTop)||((i=t._debugSurfaceTop=bui.Graphics.get()).displaySniffEnable=!1,i.displayDebugEnable=!1,i.setLocalZOrder(3e4))),t._updateDebugSurface()},hideDebugSurface:function(){var e=this;e._isWireframeSurface=!1;var t=e._debugSurface;t&&(t.release(),e._debugSurface=t=null),(t=e._debugSurfaceTop)&&(t.release(),e._debugSurfaceTop=t=null)},hasDebugSurface:function(){return!!this._debugSurface},addEventBin:function(e,t,i,n,o){var r=this,s=r._eventMap;if(!s.has(e)){void 0===n&&(n=0);var a=r._eventList,c=b8e.EventBin.get();c.type=e,c.listener=t,c.thisObject=i,c.priority=n,c.useCapture=!!o,s.set(e,c),a.append(c),r._applyActiveInHierarchyEvent(),r._hierarchyVisible&&r._onEvent(c)}},removeEventBin:function(e){var t=this,i=t._eventMap;if(i.has(e)){var n=t._eventList,o=i.get(e);o&&(t._hierarchyVisible&&t._offEvent(o),i.del(e),n.remove(o),o.release()),t._applyActiveInHierarchyEvent()}},_removeEventList:function(){var e=this._eventMap,t=this._eventList;t.forEach(this._removeEvent,this),e.clear(),t.clear()},simulationEvent:function(e){var t=this._eventMap;if(!t||!t.has(e))return b8e.error(7006,e),!1;var i=t.get(e);if(i.listener&&i.thisObject){var n=new cc.Event.EventTouch(null,!1);n.type=e,i.listener.call(i.thisObject,n)}return!0},setTouchEnabled:function(e){this._node.touchEnabled=e},touchEnabled:{set:function(e){this.setTouchEnabled(e)},get:function(){return this._node.touchEnabled}},resetDisplay:function(){var e=this;e._allRemoving=!1;var t=e._node;e.touchEnabled=!1,e.displaySniffEnable=!0,e.displayDebugEnable=!0,e._isWireframeSurface=!1;var i=e._debugSurface;i&&(i.release(),e._debugSurface=i=null),(i=e._debugSurfaceTop)&&(i.release(),e._debugSurfaceTop=i=null),e._removeEventList();var n=s(e);n&&n.remove(e),e._needActiveInHierarchyEvent||e._hasActiveInHierarchyEvent&&(e._hasActiveInHierarchyEvent=!1,t.onActiveInHierarchy=null),e.removeAllSyncImmedInfo(),e.removeAllSyncInfo(),e.removeAllChildren(),e._visible=!0,t.active||(t.active=!0),e._width=0,e._height=0,e._fixedWidth=0,e._fixedHeight=0,e._applyContentSize(0,0),e.setAnchor(0,0),e.setColor(4294967295),e.setMask(null);var o=e._pos;o.x=0,o.y=0,o.z=0;var r=e._offset;r.x=0,r.y=0,r.z=0,e._disX=0,e._disY=0,e._applyPosition(0,0),e._rot.x=0,e._rot.y=0,e._rot.z=0,e._setRotation(0),e._zIndex=0,e._arrivalIndex=0,e._applyLocalZOrder(),e._childArrival=0,e._flippedX=!1,e._contentScaleX=1,e._contentScaleY=1,e._scaleX=1,e._scaleY=1,e._applyScale(),e._alpha=1,e._contentAlpha=1,e._applyOpacity(),e.clearDisabled=!1,e.name="display."+e.hashCode,e.data=null,e.isButton=!1,e.isLazy=a.LAZY_CHILD,e.lazyActive=a.LAZY_ACTIVE,e.syncImmed=a.SYNC_IMMED,e.lazyActiveInHierarchy=!1,e._tmpInitiator=null},name:{set:function(e){this._name=e,this._node.name=e},get:function(){return this._name}},deserailization:function(e){var t=this,i=e.anchor;i&&t.setAnchor(i[0],i[1]);var n=e.size;n&&t.setSize(n[0],n[1]);var o=e.position;o&&t.setPosition(o[0],o[1]);var r=e.scale;r&&t.setScale(r[0],r[1]);var s=e.color;t.setColor(b8e.ColorUtil.argb(s[3],s[0],s[1],s[2]));var a=0|+e.opacity;t.setAlpha(a/255);var c=e.rotation;c&&t.setRotation(0,0,c[2]);var l=0|+e.localZOrder;t.setLocalZOrder(l);var u=!!e.visible;t.setVisible(u)},invalidate:function(){b8e.Tween.kill(this),this.removeFromParent(),this._super()},restore:function(){a.count++,this._super()},recycle:function(){this.resetDisplay(),a.count--,this._super()},_destroyNode:function(){var e=this._node;e&&(e._b8eDisplay=void 0,e.destroy(),this._node=e=null);var t=this._renderNode;t&&(t.destroy(),this._renderNode=t=null)},dispose:function(){var e=this,t=e._node;t&&e._hasActiveInHierarchyEvent&&(e._hasActiveInHierarchyEvent=!1,t.onActiveInHierarchy=null),e._removeSizeChangedEvent(),e._removeAnchorChangedEvent(),e._hierarchyVisible=!1,e._needActiveInHierarchyEvent=!1,e.removeAllChildren(!0);var i=e._children;i&&(i.release(),e._children=i=null);var n=e._removeList;n&&(n.release(),e._removeList=n=null),e._destroyNode();var o=e._eventList;o&&(o.release(),e._eventList=o=null);var r=e._eventMap;r&&(r.release(),e._eventMap=r=null),e._pos=null,e._offset=null,e._rot=null,e._super()}}),i=function(){var e=this._b8eDisplay,t=s(e);t?t.add(e):e._onActiveInHierarchy()};function s(e){var t=e.getClass();if(!t.LAZY_IN_HIERARCHY||e._node._activeInHierarchy&&!e.lazyActiveInHierarchy)return null;var i=t._lazyInHierarchy;return i=i||(t._lazyInHierarchy=new b8e.CallLater(function(e){return!e.usable||(e._onActiveInHierarchy(),!1)},t,t.BATCH_IN_HIERARCHY_NUM||1,0,!0))}a.count=0,a.inHierarchyCount=0,a.nodeEventCount=0,a.MIN_ZINDEX=-Math.pow(2,15),a.MAX_ZINDEX=Math.pow(2,15)-1,a.LAZY_CHILD=!1,a.BATCH_CHILD_NUM=20,a._lazyChild=new b8e.CallLater(function(e){var t=e.parent;return!(t&&t.usable&&e.usable&&e.parent===t&&e._node.parent!==t._node)||(t._node.addChild(e._node),!1)},a,a.BATCH_CHILD_NUM),a.LAZY_ACTIVE=!1,a.BATCH_ACTIVE_NUM=20,a._lazyActive=new b8e.CallLater(function(e){return!(e.usable&&e._visible&&!e._node.active)||!(e._node.active=!0)},a,a.BATCH_ACTIVE_NUM),a.SYNC_IMMED=!1,a.BATCH_SYNC_NUM=1,a._lazySync=new b8e.CallLater(function(e){return!e.usable||(e.syncAllInfo(),!1)},a,a.BATCH_SYNC_NUM);var t=new b8e.Pool(a,16384);a.get=function(){return t.get()},a.put=function(e){return t.put(e)},b8e.RC("$$b8e","$$BaseDisplay",e)})(),function(){var e,i=e=b8e.PoolObject.extends({ctor:function(){if(this.constructor===i&&(i.poolCall||b8e.warn(3122)),this._super(),b8e.isCocos190){var e=new cc.DrawNode;this._graphics=e}else{var t=new cc.Graphics;this._graphics=t}},setNode:function(e){var t=this._graphics;t.lineWidth=0,t.strokeColor=cc.color(0,0,0,0),t.node=e},fillRect:function(e,t,i,n){var o=this._graphics;if(b8e.isCocos190){var r=cc.color(255,255,255,0),s=[cc.v2(e,t),cc.v2(e+i,t),cc.v2(e+i,t+n),cc.v2(e,t+n)];o.drawPoly(s,r,0,r)}else o.rect(e,t,i,n),o.fill()},fillEllipse:function(e,t,i,n,o){var r=this._graphics;if(void 0===o&&(o=64),b8e.isCocos190){var s=cc.color(255,255,255,0),a=cc.v2(e+i/2,t+n/2),c={x:i/2,y:n/2};r.drawPoly(h(a,c,o),s,0,s)}else{for(var l=h(cc.v2(e+i/2,t+n/2),{x:i/2,y:n/2},o),u=l.length,d=0;d<u;++d){var _=l[d];0===d?r.moveTo(_.x,_.y):r.lineTo(_.x,_.y)}r.fill()}},fillPoly:function(e){var t=this._graphics;if(b8e.isCocos190){for(var i=cc.color(255,255,255,0),n=e.length,o=[],r=0;r<n;r+=2){var s=e[r],a=e[r+1];o[o.length]=cc.v2(s,a)}t.drawPoly(o,i,0,i)}else{for(var c=e.length,l=0;l<c;l+=2){var u=e[l],d=e[l+1];0==l?t.moveTo(u,d):t.lineTo(u,d)}t.fill()}},fill:function(){var e=this._graphics;e.close(),e.fill()},clear:function(){this._graphics&&(b8e.isCocos190?this._graphics.clear():this._graphics.clear(!1))},invalidate:function(){this._graphics.node=null,this._super()},restore:function(){this._super()},recycle:function(){this._graphics&&this._graphics.clear(),this._super()},release:function(){this.constructor===i?i.put(this):this.destroy()},dispose:function(){this._graphics&&(this._graphics=null),this._super()},destroy:function(){this.constructor===i&&(i.poolCall||b8e.warn(3123)),this._super()}}),r=[];function h(e,t,i){r.length=0;for(var n=2*Math.PI/i,o=0;o<i;++o)r[r.length]=cc.v2(t.x*Math.cos(n*o)+e.x,t.y*Math.sin(n*o)+e.y);return r}var t=new b8e.Pool(i,1024);i.get=function(){return t.get()},i.put=function(e){return t.put(e)},b8e.RC("$$b8e","$$GraphicsMask",e)}(),function(){var e;e=b8e.BaseDisplay.extends({isStage:!0,ctor:function(e){var t=this;t._super(e),t.displaySniffEnable=!1,t.displayDebugEnable=!1,b8e.evt.onC(t,t.onClickStage,t)},touchEnabled:{set:function(){}},_applyPosition:function(){},_setRotation:function(){},_setScaleX:function(){},_setScaleY:function(){},_applyOpacity:function(){},stageWidth:{get:function(){return b8e.stageWidth}},stageHeight:{get:function(){return b8e.stageHeight}},onClickStage:function(){},displaySniff:function(e){var t=this;t.displaySniffEnable!=e&&((t.displaySniffEnable=e)?(b8e.__DS__={},t._addChildrenSniff(t)):(b8e.__DS__=void 0,t._removeChildrenSniff(t)))},displayDebug:function(e){var t=this;t.displayDebugEnable!=e&&((t.displayDebugEnable=e)?t._addChildrenDebug(t):t._removeChildrenDebug(t))},_addChildrenDebug:function(e){e._children.forEach(this._onAddDisplayDebug,this)},_onAddDisplayDebug:function(e){e.showDebugSurface(),this._addChildrenDebug(e)},_removeChildrenDebug:function(e){e._children.forEach(this._onRemoveDisplayDebug,this)},_onRemoveDisplayDebug:function(e){e.hideDebugSurface(),this._removeChildrenDebug(e)},_addChildrenSniff:function(e){e._children.forEach(this._onAddDisplaySniff,this)},_onAddDisplaySniff:function(e){this._addDisplaySniff(e),this._addChildrenSniff(e)},_removeChildrenSniff:function(e){e._children.forEach(this._onRemoveDisplaySniff,this)},_onRemoveDisplaySniff:function(e){this._removeDisplaySniff(e),this._removeChildrenSniff(e)},_addDisplaySniff:function(e){if(e.displaySniffEnable){var t=this;b8e.evt.onTouchStart(e,t._onSniffTouchStart,t),b8e.evt.onTouchEnd(e,t._onSniffTouchEnd,t),b8e.evt.onTouchCancel(e,t._onSniffTouchEnd,t)}},_removeDisplaySniff:function(e){if(e.displaySniffEnable){var t=this;t._removeSniffSurface(e),b8e.evt.offTouchStart(e,t._onSniffTouchStart,t),b8e.evt.offTouchEnd(e,t._onSniffTouchEnd,t),b8e.evt.offTouchCancel(e,t._onSniffTouchEnd,t)}},_onSniffTouchStart:function(e){var t=e.target;b8e.__DS__[t.name]=t,this._updateSniffSurface(t)},_onSniffTouchEnd:function(e){var t=e.target;this._removeSniffSurface(t)},_updateSniffSurface:function(e){var t=e._sniffSurface,i=e._sniffLabel;t||((t=e._sniffSurface=bui.Graphics.get()).displaySniffEnable=!1,t.displayDebugEnable=!1,(i=e._sniffLabel=bui.Label.get()).displaySniffEnable=!1,i.displayDebugEnable=!1,i.setFontSize(16),i.setColor(4294967295),t.addChild(i)),e.addChild(t),t.setSize(e.width,e.height),t.clear(),0<e.width&&0<e.height&&(t.lineWidth(0),t.strokeColor(0),t.fillColor(301924352),t.fillRect(0,0,e.width,e.height),t.lineWidth(1),t.strokeColor(4294901760),t.moveTo(0,0),t.lineTo(e.width,0),t.lineTo(e.width,e.height),t.lineTo(0,e.height),t.lineTo(0,0),t.stroke(),t.setPosition(-e.width*e.anchorX,-e.height*e.anchorY),i.setText(e.name),i.setPosition(0,e.height-i.height),t.lineWidth(0),t.strokeColor(0),t.fillColor(2566914048),t.fillRect(i.x,i.y,i.width,i.height))},_removeSniffSurface:function(e){var t=e._sniffSurface;if(t){t.release(),e._sniffSurface=t=void 0;var i=e._sniffLabel;i.release(),e._sniffLabel=i=void 0}}}),b8e.RC("$$b8e","$$Stage",e)}(),function(){var e;e=b8e.BaseDisplay.extends({ctor:function(e){this._super(e),this.displaySniffEnable=!1},_applyPosition:function(e,t){var i=this._node;i.x=e,i.y=-t+this._height}}),b8e.RC("$$b8e","$$Root",e)}(),function(){var e,t;t=b8e.EventDispatcher.extends({ctor:function(e,t,i){if(b8e.ready){void 0===t&&(t=0);var n=this;n._super(),n._container=b8e.BaseDisplay.get(),n._viewDisplay=b8e.BaseDisplay.get(),n._viewDisplay.addChild(n._container),e.addChild(n._viewDisplay),n._viewSize={width:0,height:0},n._viewFilter=i,n._mapLayer=new b8e.SceneMapLayer(n),n._earthSurface=n._mapLayer.getEarthSurface(),n._earthContainer=n._earthSurface.getContainer(),n._entityLayer=new b8e.SceneEntityLayer(n,n._viewFilter),n._camera=new b8e.SceneCamera(n),n._autoCenter=!1,n._tmpPoint={x:0,y:0},n._createQueue=new b8e.CallLater(n._processQueue,n,1),n._taskMap=b8e.HashMap.get()}else b8e.error("\u5f15\u64ce\u672a\u5c31\u7eea\uff0c\u4e0d\u80fd\u5b9e\u4f8b\u5316Scene\uff01")},addCreateTask:function(e){if(this._createQueue.add(e),void 0!==e.type&&void 0!==e.id){var t=b8e.CommonUtil.xyToNumber(e.type,e.id);this._taskMap.set(t,e)}},removeCreateTask:function(e){if(this._createQueue.remove(e),e.usable){if(void 0!==e.type&&void 0!==e.id){var t=b8e.CommonUtil.xyToNumber(e.type,e.id);this._taskMap.del(t)}e.release()}},_processQueue:function(e){if(e.usable){if(void 0!==e.type&&void 0!==e.id){var t=b8e.CommonUtil.xyToNumber(e.type,e.id);this._taskMap.del(t)}return e.targetUsable()&&e.process(),e.release(),!1}return!0},getCountByType:function(e){return this._entityLayer.getCountByType(e)},setViewFilter:function(e){this._viewFilter=e,this._entityLayer.setViewFilter(this._viewFilter)},getCurrOtherRenderNum:function(){return this._entityLayer.getCurrOtherRenderNum()},getMaxOtherRenderNum:function(){return this._entityLayer.getMaxOtherRenderNum()},getCurrRenderNum:function(e){return this._entityLayer.getCurrRenderNum(e)},getMaxRenderNum:function(e){return this._entityLayer.getMaxRenderNum(e)},getMaxAttachNum:function(e,t){return this._entityLayer.getMaxAttachNum(e,t)},setMaxOtherRenderNum:function(e){this._entityLayer.setMaxOtherRenderNum(e)},setMaxRenderNum:function(e,t){this._entityLayer.setMaxRenderNum(e,t)},setMaxAttachNum:function(e,t,i){this._entityLayer.setMaxAttachNum(e,t,i)},isOtherRenderLimit:function(){return this._entityLayer.isOtherRenderLimit()},isRenderLimit:function(e){return this._entityLayer.isRenderLimit(e)},getContainer:function(){return this._container},getViewDisplay:function(){return this._viewDisplay},addDisplay:function(e,t,i,n,o,r){void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===r&&(r=0),this._entityLayer.addDisplay(e,t,i,n,o,r)},removeDisplay:function(e,t){void 0===t&&(t=!0),this._entityLayer.removeDisplay(e,t)},_driveOutDisplay:function(e){if(void 0!==e.type&&void 0!==e.id){var t=b8e.CommonUtil.xyToNumber(e.type,e.id),i=this._taskMap.get(t);i&&this.removeCreateTask(i)}this._entityLayer._driveOutDisplay(e)},getDisplayByType:function(e){return this._entityLayer.getDisplayByType(e)},getDisplayById:function(e){return this._entityLayer.getDisplayById(e)},getDisplayByTypeAndId:function(e,t){return this._entityLayer.getDisplayByTypeAndId(e,t)},removeDisplayByType:function(e){this._entityLayer.removeDisplayByType(e)},removeDisplayById:function(e){this._entityLayer.removeDisplayById(e)},removeDisplayByTypeAndId:function(e,t){return this._entityLayer.removeDisplayByTypeAndId(e,t)},getDisplays:function(){return this._entityLayer.getDisplays()},getVisibleSize:function(){return cc.view.getVisibleSize()},getMapLayer:function(){return this._mapLayer},getEntityLayer:function(){return this._entityLayer},getCamera:function(){return this._camera},getSceneSize:function(){return{width:this._mapLayer.getMapWidth(),height:this._mapLayer.getMapHeight()}},getSceneScale:function(){return this._camera.getSceneScale()},_onStartRender:function(){this._mapLayer.startRender(),this._entityLayer.startRender(),this.updateScene()},startRender:function(){this._isRendering||(this._isRendering=!0,this._isLoaded&&this._onStartRender())},stopRender:function(){this._isRendering&&(this._isRendering=!1,this._mapLayer.stopRender(),this._entityLayer.stopRender())},loadMap:function(e,n,o){return this.clear(),this._mapLayer.loadMap(e,function(e,t){if(!e){var i=t.getConfig();this._setSceneConfig(i),n&&n.call(o,e,this),this.dispatchEventWith(b8e.SceneEvent.SCENE_MAP_LOAD_COMPLETE,{scene:this})}},this),this._mapLayer},setMapConfig:function(e,t){this.clear(),this._mapLayer.setMapConfig(e,t),this._setSceneConfig(t)},getMapUrl:function(){return this._mapLayer.getMapUrl()},_setSceneConfig:function(e){if(e){var t=this,i=parseInt(e.cameraDistance);t._navigateRatio=parseInt(e.navigateRatio),t._panoramaRatio=parseInt(e.panoramaRatio),t._container.setSize(t._mapLayer.getMapWidth(),t._mapLayer.getMapHeight()),t._camera.setDistance(i),t._isLoaded=!0,t._isRendering&&t._onStartRender(),t._entityLayer.onSceneLoaded(),b8e.evt.onC(t._earthContainer,t.onEarthClick,t),t.playMusic()}},playMusic:function(){if(this._isLoaded&&this.soundEffectsEnabled){var e=this._mapLayer.getConfig(),t=this._mapLayer.getMapUrl();if(e.backgroundMusic){var i=b8e.SoundMgr.BACKGROUND_MUSIC_DIR;i=i||(t?t.substring(0,t.lastIndexOf("/")):null),b8e.sound.playBackgroundMusic(i+"/"+e.backgroundMusic,!0)}if(e.environmentAudio){var n=b8e.SoundMgr.ENVIRONMENT_AUDIO_DIR;n=n||(t?t.substring(0,t.lastIndexOf("/")):null),b8e.sound.playEnvironmentAudio(n+"/"+e.environmentAudio)}}},stopMusic:function(){this._isLoaded&&(b8e.sound.stopBackgroundMusic(),b8e.sound.stopEnvironmentAudio(),b8e.sound.stopAllEffectSound())},isLoaded:function(){return this._isLoaded},getNavigateRatio:function(){return this._navigateRatio},getPanoramaRatio:function(){return this._panoramaRatio},clearEntity:function(e){this._entityLayer.clear(e),this._createQueue.clear(),this._taskMap.clear()},clear:function(e){var t=this;t.stopRender(),t._entityLayer.clear(e),t._createQueue.clear(),t._taskMap.clear(),t._mapLayer.clear(),t._navigateRatio=0,t._panoramaRatio=0,t._isLoaded&&(b8e.evt.offC(t._earthContainer,t.onEarthClick,t),t._isLoaded=!1),t.soundEffectsEnabled&&(b8e.sound.stopBackgroundMusic(),b8e.sound.stopEnvironmentAudio(),b8e.sound.stopAllEffectSound())},updateSceneScale:function(){var e=this.getSceneScale();this._container.setScale(e,e),this.updateScene()},setSize:function(e,t){this._viewDisplay.setSize(e,t),this._viewSize.width=e,this._viewSize.height=t,this.updateScene()},updateScene:function(){var e=this,t=e.getSceneScale(),i=e._viewSize.width/t>>0,n=e._viewSize.height/t>>0;e._mapLayer.setViewSize(i,n);var o=e._mapLayer.getMapWidth(),r=e._mapLayer.getMapHeight();e._mapLayer.setViewBounds(0,i-o,n-r,0),e._mapLayer.refreshView(!0);var s=e._mapLayer.getContainerPos(),a=0,c=0;e._autoCenter&&(o<i&&(a=i-o>>1),r<n&&(c=n-r>>1)),e._container.setPosition(s.x*t,s.y*t),e._viewDisplay.setPosition(a,-c),e._camera.syncTargetFocus()},autoCenter:function(e){this._autoCenter=e,this.updateScene()},sceneGLToViewGLPos:function(e,t){var i=this,n=i.getViewGLPos(),o=i.getSceneScale();return i._tmpPoint.x=(e+n.x)*o,i._tmpPoint.y=(t+n.y)*o,i._tmpPoint},viewGLToSceneGLPos:function(e,t){var i=this,n=i.getViewGLPos(),o=i.getSceneScale();return i._tmpPoint.x=e/o-n.x,i._tmpPoint.y=t/o-n.y,i._tmpPoint},sceneUIToGLPos:function(e,t){return this._mapLayer.mapUIToGLPos(e,t)},sceneGLToUIPos:function(e,t){return this._mapLayer.mapGLToUIPos(e,t)},getViewUIPos:function(){var e=this.getViewGLPos();return e=this.viewGLToUIPos(e.x,e.y)},setViewUIPos:function(e,t){var i=this.viewUIToGLPos(e,t);this.setViewGLPos(i.x,i.y)},viewUIToGLPos:function(e,t){var i=this,n=i._mapLayer.getMapHeight();return i._tmpPoint.x=e,i._tmpPoint.y=i._viewSize.height-n-t,i._tmpPoint},viewGLToUIPos:function(e,t){var i=this,n=i._mapLayer.getMapHeight();return i._tmpPoint.x=e,i._tmpPoint.y=i._viewSize.height-n-t,i._tmpPoint},viewToViewportGLPos:function(e,t){return this._tmpPoint.x=-e,this._tmpPoint.y=-t,this._tmpPoint},getViewGLPos:function(){return this._mapLayer.getViewGLPos()},getViewportPos:function(){var e=this.getViewUIPos();return this._tmpPoint.x=-e.x,this._tmpPoint.y=-e.y,this._tmpPoint},setViewportPos:function(e,t){this.setViewUIPos(-e,-t)},setViewGLPos:function(e,t){this._applyViewPos(e,t),this._camera.applyCamera()},setGLViewportPos:function(e,t){this.setViewGLPos(-e,-t)},getViewSize:function(){return this._viewSize},_applyViewPos:function(e,t){this._mapLayer.setViewGLPos(e,t);var i=this.getSceneScale(),n=this._mapLayer.getContainerPos();this._container.setPosition(n.x*i,n.y*i)},modifyDisplayId:function(e,t){this._entityLayer.modifyDisplayId(e,t)},findPath:function(e,t,i,n,o,r){return this._earthSurface.findPath(e,t,i,n,!!o,!!r)},gridIsSolid:function(e,t){return this._earthSurface.gridIsSolid(e,t)},gridIsSpecifyType:function(e,t,i){return this._earthSurface.gridIsSpecifyType(e,t,i)},getSpaceGrids:function(){return this._earthSurface.getSpaceGrids()},getPixelPosByGrid:function(e,t){var i=this;return i._tmpPoint.x=i._mapLayer.getPixelXByGrid(e),i._tmpPoint.y=i._mapLayer.getPixelYByGrid(t),i._tmpPoint},getGridPosByPixel:function(e,t){var i=this;return i._tmpPoint.x=i._mapLayer.getGridXByPixel(e),i._tmpPoint.y=i._mapLayer.getGridYByPixel(t),i._tmpPoint},onEarthClick:function(e){var t=this,i=t._container.convertToNodeSpaceAR(e.getLocation()),n=t.sceneGLToUIPos(i.x,i.y);t._tmpPoint.x=n.x,t._tmpPoint.y=n.y,t.dispatchEventWith(b8e.SceneEvent.SCENE_MAP_CLICK,t._tmpPoint,!1,!1,!1)},entityCount:{get:function(){return this._entityLayer.getDisplayCount()}},entityRenderCount:{get:function(){return this._entityLayer.getRenderCount()}},tileCount:{get:function(){return this._mapLayer.getTileCount()}},tileRenderCount:{get:function(){return this._mapLayer.getRenderCount()}}});var i=e=b8e.PoolObject.extends({type:void 0,id:void 0,ctor:function(e,t,i,n){var o=this;o._super(),o._target=e,o._targetPoolHash=e.poolHash,o._callback=t,o._thisArg=i,o._args=n,o.type=e.type,o.id=e.id},process:function(){this._callback.apply(this._thisArg,this._args)},targetUsable:function(){var e=this._target;return!(!e||void 0!==e.usable&&!e.usable||e.poolHashUsable&&!e.poolHashUsable(this._targetPoolHash))},restore:function(e,t,i,n){var o=this;o._target=e,o._targetPoolHash=e.poolHash,o._callback=t,o._thisArg=i,o._args=n,o.type=e.type,o.id=e.id,o._super()},recycle:function(){var e=this;e._targetPoolHash=void 0,e._target=null,e._callback=null,e._thisArg=null,e._args=null,e.type=void 0,e.id=void 0,e._super()}}),o=new b8e.Pool(i,128);i.get=function(e,t,i,n){return o.get(e,t,i,n)},i.put=function(e){return o.put(e)},b8e.RC("$$b8e","$$Scene",t),b8e.RC("$$b8e","$$SceneTask",e)}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;e=b8e.BaseDisplay.extends({ctor:function(){this._super(),this._propMap=b8e.HashMap.get(),this._isLoading=!1,this._isLoaded=!1},_setPrefab:function(e,t){var i=this;e?i._prefab||(i._prefab=e,i._scriptName=t,i._prefabNode=cc.instantiate(i._prefab),i.addChild(i._prefabNode),i.setSize(i._prefabNode.width,i._prefabNode.height),i._scriptName&&(i._script=i._prefabNode.getComponent(i._scriptName)),i._propMap.forEach(i._applyProp,i),i._onComplete&&i._onComplete.call(i._onCompleteThis)):b8e.error(2047,i._url)},loadPrefab:function(e,t,i,n,o){var r=this;e!=r._url&&(r.unloadPrefab(),r._url=e,r._onComplete=i,r._onCompleteThis=n,r._isLoading=!0,void 0===(o=o||{}).priority&&(o.priority=b8e.ResMgr.UI_PRIOR),b8e.res.loadRes(r._url,b8e.Prefab,r.onLoadComplete,r,[t],o))},onLoadComplete:function(e,t,i){this._isLoading=!1,this._isLoaded=!0,e||this._setPrefab(t.getPrefab(),i)},_applyProp:function(e){if(this._script){var t=this._propMap.get(e);if(t){var i=t.thisArg||this._script;if(i)if(v(i[e])===b8e.TypeFunction)i[e].call(i,t.value);else i[e]=t.value}}},callProp:function(e,t,i){this._propMap.set(e,{value:t,thisArg:i}),this._applyProp(e)},unloadPrefab:function(){var e=this;e._prefabNode&&(e._prefabNode.destroy(),e._prefabNode=null),e._url&&(b8e.res.unloadRes(e._url,e.onLoadComplete,e),e._url=null),e.setSize(0,0),e._onComplete=null,e._onCompleteThis=null,e._scriptName=null,e._script=null,e._prefab=null,e._propMap.clear(),e._isLoading=!1,e._isLoaded=!1},isLoading:function(){return this._isLoading},isLoaded:function(){return this._isLoaded},restore:function(){this._super()},recycle:function(){this.unloadPrefab(),this._propMap&&this._propMap.clear(),this._super()},dispose:function(){this._propMap&&(this._propMap.release(),this._propMap=null),this._super()}}),b8e.RC("$$b8e","$$PrefabDisplay",e)})(),function(){var e;e=b8e.EventDispatcher.extends({init:function(){},ipc:function(){},sendToView:function(){b8e.warn(3150),b8e.module.sendToView(this.moduleEnum,arguments)},send:function(){b8e.module.sendToView(this.moduleEnum,arguments)},notify:function(){},addG:function(e,t,i,n){b8e.evt.addG(this,e,t,i,n)},rmvG:function(e,t,i){b8e.evt.rmvG(this,e,t,i)},addGO:function(e,t,i,n){b8e.evt.addGO(this,e,t,i,n)},dptG:function(e,t,i,n,o,r){b8e.evt.dptG(e,t,i,n,o,r)},dpt:function(e,t,i,n,o,r,s){this.dispatchEventWith(e,t,i,n,o,r,s)},getData:function(){return null}}),b8e.RC("$$b8e","$$BaseControl",e)}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e=b8e.Object.extends({ctor:function(){var e=this;e._viewsClass={},e._controlsClass={},e._views={},e._controls={},e._controlEvts=b8e.HashMap.get(),e._bindVC={},e._waitInit={},e.mgrInited=!1},registerView:function(e,t){e?this._viewsClass[e]?b8e.error(4002,e):(this._viewsClass[e]=t,this.initModule(e)):b8e.error(4001)},registerControl:function(e,t,i,n,o){if(e){this._controlsClass[e]?b8e.error(4004,e):(this._controlsClass[e]={cls:t,evts:i,sender:n,views:o},this.initModule(e))}else b8e.error(4003)},initWait:function(){for(var e in this.mgrInited=!0,this._waitInit)this.initModule(0|+e);this._waitInit={}},initModule:function(e){var t=this;if(b8e.startup&&b8e.startup.isInited()&&t.mgrInited)if(e){t._viewsClass[e];var i=t._controlsClass[e],n=void 0,o=void 0,r=void 0,s=void 0,a=void 0,c=void 0;if(i&&!(n=t._controls[e])){if(!(o=i.cls))return void b8e.error(4006,e);if((n=new o).moduleEnum=e,(t._controls[e]=n).ipc(),n.Evts=i.evts,(r=i.sender)&&(n.sender=new r),t.__bindCEvts(n),t.__bindGEvts(n),t.__bindHandel(n),n.init(),n.__bindViewEnums=[],i.views)for(c=i.views.length,s=0;s<c;s++)(a=i.views[s])?t._bindVC[a]?b8e.error(4008,a):(t._bindVC[a]=e,t.__bindVC(a)):b8e.error(4007,e);t._bindVC[e]||(t._bindVC[e]=e)}t.__bindVC(e)}else b8e.error(4005);else t._waitInit[e]=!0},__bindVC:function(e){var t=this,i=t._bindVC[e];if(i){var n=t._controls[i];if(n&&!(-1<n.__bindViewEnums.indexOf(e))){var o=t._views[e];if(!o){var r=t._viewsClass[e];r&&((o=new r).moduleEnum=e,o.bindEnum=i,n.__bindViewEnums.push(e),o.Evts=n.Evts,t._views[e]=o)}}}},__bindCEvts:function(e){var t=this,i=void 0,n=void 0,o=void 0,r=void 0,s=void 0,a=void 0,c=void 0,l=void 0,u=void 0,d=e.evts;if(d)for(n in d)if(i=t.ME[n])if(r=t._controls[i],l=d[n],r){if(!l){b8e.error(4010,e.moduleEnum,n);continue}if(!(c=r.Evts)){b8e.error(4011,r.moduleEnum);continue}for(o in l)s=c[o],a=l[o],s?a?r.addEventListener(s,a,e):b8e.error(4013,e.moduleEnum,n,o):b8e.error(4012,n,o)}else(u=t._controlEvts.get(i))||(u=[],t._controlEvts.set(i,u)),u.push({rstEvt:l,target:e});else b8e.error(4009,e.moduleEnum,n);if((u=t._controlEvts.get(e.moduleEnum))&&0!=u.length)if(e.Evts){for(var _=void 0,h=0;h<u.length;h++)for(o in l=(_=u[h]).rstEvt)s=e.Evts[o],a=l[o],s?a?e.addEventListener(s,a,_.target):b8e.error(4016,o):b8e.error(4015,e.moduleEnum,n,o);u.length=0}else b8e.error(4014,e.moduleEnum)},__bindGEvts:function(e){var t=e.gevts;if(t){var i=void 0,n=void 0,o=void 0,r=void 0,s=void 0,a=void 0;for(i in t)if(n=t[i],o=game[i])for(r in n)(s=o[r])?(a=n[r],b8e.SHC(a),b8e.evt.addG(e,s,a)):b8e.error(4018,i,r);else b8e.error(4017,i)}},__bindHandel:function(e){if(e.handels){var t=e.handelNS();b8e.net.sub(e.handels,t,e)}},sendToView:function(e,t){if(e)for(var i=void 0,n=void 0,o=this._controls[e],r=0,s=o.__bindViewEnums.length;r<s;r++)i=o.__bindViewEnums[r],(n=this._views[i])&&n.__isShow&&n.waitNotify(t);else b8e.error(4019)},sendToControl:function(e,t){if(e){var i=this._controls[e];i&&i.notify&&i.notify.apply(i,t)}else b8e.error(4020)},showView:function(e,t){if(e){var i,n=void 0;if(i=this._views[e]){if(t&&t.__Event&&(t=t.data),(void 0===t?"undefined":v(t))===b8e.TypeNumber){if(!(n=this._views[t]))return void b8e.error(4022);n.addWidget(i)}else t&&t.__BaseDisplay&&(n=t).addChild(i);n||(n=b8e.LayerMgr.inst().getGuiLayer()).addChild(i)}}else b8e.error(4021)},hideView:function(e){if(e){var t=this._views[e];t&&t.__isShow&&t.removeFromParent()}else b8e.error(4023)},isShowView:function(e){if(e){var t=this._views[e];return!(!t||!t.__isShow)}b8e.error(4024)},bindViewToControl:function(e){if(e){var t=this,i=t._bindVC[e];if(i){var n=t._views[e],o=t._controls[i];if(n&&o)if(n.__bind)b8e.error(4028);else{var r=void 0,s=void 0,a=void 0,c=void 0,l=n.getEvts();if(l&&0<l.length)for(r=0,s=l.length;r<s;r++)if((a=l[r])&&""!==a.name){var u=a.name;if("closeBtn"==u||"returnBtn"==u||-1<u.indexOf("view")){if(!(c=n[b8e.getAliasName(u)])||(void 0===c?"undefined":v(c))!==b8e.TypeFunction){b8e.error(4030,e,u);continue}b8e.evt.onC(a,c,n),(c=t[b8e.getAliasName(u+"_ts")])&&b8e.evt.onTouchStart(a,c,n),(c=t[b8e.getAliasName(u+"_tc")])&&b8e.evt.onTouchCancel(a,c,n),b8e.evt.addButtonHandler(a)}else{if(!(c=o[b8e.getAliasName(u)])||(void 0===c?"undefined":v(c))!==b8e.TypeFunction){b8e.error(4031,e,u);continue}b8e.evt.onC(a,c,o),(c=t[b8e.getAliasName(u+"_ts")])&&b8e.evt.onTouchStart(a,c,o),(c=t[b8e.getAliasName(u+"_tc")])&&b8e.evt.onTouchCancel(a,c,o),b8e.evt.addButtonHandler(a)}}else b8e.error(4029,e);n.__bind=!0}else b8e.error(4027)}else b8e.error(4026)}else b8e.error(4025)},unbindViewToControl:function(e){if(e){var t=this,i=t._bindVC[e];if(i){var n=t._views[e],o=t._controls[i];if(n&&o)if(n.__bind){var r=void 0,s=void 0,a=void 0,c=void 0,l=n.getEvts();if(l&&0<l.length)for(r=0,s=l.length;r<s;r++)if((a=l[r])&&""!==a.name){var u=a.name;if("closeBtn"==u||"returnBtn"==u||-1<u.indexOf("view")){if(!(c=n[u])||(void 0===c?"undefined":v(c))!==b8e.TypeFunction){b8e.error(4037,e,u);continue}b8e.evt.offC(a,c,n),(c=t[u+"_ts"])&&b8e.evt.offTouchStart(a,c,n),(c=t[u+"_tc"])&&b8e.evt.offTouchCancel(a,c,n),b8e.evt.removeButtonHandler(a)}else{if(!(c=o[u])||(void 0===c?"undefined":v(c))!==b8e.TypeFunction){b8e.error(4038,e,u);continue}b8e.evt.offC(a,c,o),(c=t[u+"_ts"])&&b8e.evt.offTouchStart(a,c,o),(c=t[u+"_tc"])&&b8e.evt.offTouchCancel(a,c,o),b8e.evt.removeButtonHandler(a)}}else b8e.error(4036,e);n.__bind=!1}else b8e.error(4035);else b8e.error(4034)}else b8e.error(4033)}else b8e.error(4032)},getView:function(e){return this._views[e]},getControl:function(e){return this._controls[e]},isInited:function(e){return!!this._controls[e]||!!this._views[e]}});e._inst=null,e.inst=function(){return e._inst||(e._inst=new e),e._inst},b8e.module=e.inst()})(),function(){var e,t=void 0;e=b8e.Enum({None:0,Horizontal:1,Vertical:2,Grid:3}),t=b8e.Object.extends({ctor:function(e){this._super(),e&&this.setLayout(e)},type:e.None,spacingX:0,spacingY:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,setLayout:function(e){var t=this;void 0!==e.type&&(t.type=e.type),void 0!==e.spacingX&&(t.spacingX=e.spacingX),void 0!==e.spacingY&&(t.spacingY=e.spacingY),void 0!==e.paddingLeft&&(t.paddingLeft=e.paddingLeft),void 0!==e.paddingRight&&(t.paddingRight=e.paddingRight),void 0!==e.paddingTop&&(t.paddingTop=e.paddingTop),void 0!==e.paddingBottom&&(t.paddingBottom=e.paddingBottom)},clone:function(){var e=new t;return e.setLayout(this),e}}),b8e.BindingUtil.bind(t),t.poolCall=!0,b8e.HorizontalLayoutAtts={type:e.Horizontal,spacingX:5,paddingLeft:10,paddingRight:10},b8e.VerticalLayoutAtts={type:e.Vertical,spacingY:5,paddingTop:5,paddingBottom:5},b8e.GridLayoutAtts={type:e.Grid,spacingX:5,spacingY:5,paddingLeft:10,paddingRight:10,paddingTop:5,paddingBottom:5},b8e.HorizontalLayout=new t(b8e.HorizontalLayoutAtts),b8e.VerticalLayout=new t(b8e.VerticalLayoutAtts),b8e.GridLayout=new t(b8e.GridLayoutAtts),b8e.RC("$$b8e","$$LayoutType",e),b8e.RC("$$b8e","$$Layout",t)}(),function(){var e;e=b8e.Object.extends({ctor:function(){this._super(),this.curIndex=-1},init:function(e){if(e){this.toggles=e;for(var t=0,i=this.toggles.length;t<i;t++)this.toggles[t].t.node.active=!1}},onSelectCheck:function(e,t){this._checkCb=e?{func:e,thisArg:t}:null},onSelectChange:function(e,t){this._selectCb=e?{func:e,thisArg:t}:null},select:function(e){var t=this;if(t.toggles&&0!=t.toggles.length){if(t.curIndex!=e){var i=void 0,n=void 0;if(-1!=t.curIndex&&(n=t.toggles[t.curIndex]),i=t.toggles[e],t._checkCb)if(!t._checkCb.func.call(t._checkCb.thisArg,i,n))return;t.curIndex=e,n&&n.t&&(n.t.node.active=!1),i&&i.t&&(i.t.node.active=!0,t._selectCb&&t._selectCb.func.call(t._selectCb.thisArg,i,n))}}else b8e.error(2069)},onHide:function(e,t){this._hideCb=e?{func:e,thisArg:t}:null},hide:function(){var e=this;if(e.toggles&&0!=e.toggles.length){if(-1!=e.curIndex){var t=e.toggles[e.curIndex];t&&t.t&&(t.t.node.active=!1,e._hideCb&&e._hideCb.func.call(e._hideCb.thisArg,t)),e.curIndex=-1}}else b8e.error(2070)},defaultSelect:function(){this.select(0)}}),b8e.RC("$$b8e","$$Toggle",e)}(),function(){var e,i=e=b8e.BaseDisplay.extends({__ScrollView:!0,ctor:function(){var e=this;e.constructor===i&&(i.poolCall||b8e.warn(3134)),e._super();var t=e._node.addComponent(cc.ScrollView);b8e.isCocos190&&"function"==typeof t.__preload&&t.__preload(),e._scrollView=t,e.resetScrollView()},content:{set:function(e){this._scrollView&&(this._scrollView.content=e)},get:function(){return this._scrollView.content}},setContent:function(e){e?(e.setLazy(!1),this.content=e.getNode()):this.content=null},horizontal:{set:function(e){this._scrollView&&(this._scrollView.horizontal=e)},get:function(){return this._scrollView.horizontal}},setHorizontal:function(e){this.horizontal=e},vertical:{set:function(e){this._scrollView&&(this._scrollView.vertical=e)},get:function(){return this._scrollView.vertical}},setVertical:function(e){this.vertical=e},elastic:{set:function(e){this._scrollView&&(this._scrollView.elastic=e)},get:function(){return this._scrollView.elastic}},setElastic:function(e){this.elastic=e},deserailization:function(e,t){this._super(e);var i=t.horizontal;this.setHorizontal(i);var n=t.vertical;this.setVertical(n);var o=t.elastic;this.setElastic(o)},resetScrollView:function(){this.setContent(null),this.setHorizontal(!0),this.setVertical(!0),this.setElastic(!0)},recycle:function(){this.resetScrollView(),this._super()},release:function(){this.constructor===i?i.put(this):this.destroy()},dispose:function(){var e=this;e._scrollView&&(e._node.removeComponent(e._scrollView),e._scrollView=null),e._super()},destroy:function(){this.constructor===i&&(i.poolCall||b8e.warn(3135)),this._super()}}),t=new b8e.Pool(i,1024);i.get=function(){return t.get()},i.put=function(e){return t.put(e)},b8e.RC("$$b8e","$$ScrollView",e)}(),function(){var e,b=void 0;e=b8e.Object.extends({ctor:function(e,t,i){var n=this;n._super(),n._itemRenders=[],n._itemrenderPool=[],n._clears=[],n.setScrollView(e),n._setItemRender(t,i)},show:function(e,t){var i=this;1!=i._isShow&&(void 0===t&&(t=!0),i._layout.type==b.Type.HORIZONTAL&&!i._viewCb||(i._scrollView.node.on("scroll-ended",i._onScrollEnd,i),i._scrollView.node.on("scrolling",i._onScrolling,i),i._scrollView.node.on("scroll-to-top",i._onScrolling,i),i._scrollView.node.on("scroll-to-bottom",i._onScrolling,i)),t&&i._scrollView.scrollToTop(0),i._isShow=!0,i.setData(i._data),i._clearAllTimer&&i._clearAllTimer.stop())},hide:function(e){var t=this;0!=t._isShow&&(void 0===e&&(e=!0),t._layout.type==b.Type.HORIZONTAL&&!t._viewCb||(t._scrollView.node.off("scroll-ended",t._onScrollEnd,t),t._scrollView.node.off("scrolling",t._onScrolling,t),t._scrollView.node.off("scroll-to-top",t._onScrolling,t),t._scrollView.node.off("scroll-to-bottom",t._onScrolling,t)),t._isShow=!1,b8e.Tween.kill(t),t._startRefreshTimer&&t._startRefreshTimer.stop(),t._updateTimer&&t._updateTimer.stop(),e&&(t._clearAllItemRender(!1),t._clearAllTimer?(t._clearAllTimer.reset(),t._clearAllTimer.start()):t._clearAllTimer=b8e.Timer.add(t,t._clearAllItemRender,6e4,1)))},setViewCb:function(e,t){this._viewCb=e,this._viewThis=t},setScrollView:function(e){e&&(e.__ScrollView?this._scrollView=e._scrollView:e instanceof cc.ScrollView?this._scrollView=e:b8e.error(2050))},_setItemRender:function(e,t){var i=this;void 0===t&&(t=1),i._itemRenderClass=e;var n=new i._itemRenderClass;i._itemWidth=n.getWidth(),i._itemHeight=n.getHeight(),i._layout=new b;var o=i._scrollView.content.getComponent(cc.Layout);i._layout.setupByComponent(o),i._layout.lineMaxCount=t,i._scrollView.content.removeComponent(cc.Layout);var r=i._scrollView.content.parent.getContentSize();i._maskWidth=r.width,i._maskHeight=r.height;var s=r.width-i._layout.paddingLeft-i._layout.paddingRight,a=r.height-i._layout.paddingTop-i._layout.paddingBottom;i._widthCount=1==t?s/(i._itemWidth+i._layout.spacingX)>>0:t,i._heightCount=Math.ceil(a/i._itemHeight),0==i._widthCount&&(i._widthCount=1),0==i._heightCount&&(i._heightCount=1),i._maskViewCount=i._widthCount*i._heightCount},setData:function(e,t){var i=this;i._data=e,i._data||(i._data=[]),0!=i._isShow&&(t&&i._scrollView.scrollToTop(0),i._forceRefresh=!0,0!=i._data.length?i.refreshNext():i._clearAllItemRender())},refreshNext:function(){var e=this;e._startRefreshTimer?(e._startRefreshTimer.reset(),e._startRefreshTimer.start()):e._startRefreshTimer=b8e.Timer.add(e,e._startRefresh,50,1,2)},_startRefresh:function(){var e=this;e._startRefreshTimer.stop(),e._updateIndex=0,e._maxCount=e._data.length>e._itemRenders.length+e._itemrenderPool.length?e._data.length:e._itemRenders.length+e._itemrenderPool.length,e._updateTimer?(e._updateTimer.reset(),e._updateTimer.start()):e._updateTimer=b8e.Timer.add(e,e._updateItemRender,100,0,2),e._updateItemRender()},_updateItemRender:function(){var e=this,t=e._itemRenders,i=e._itemWidth+e._layout.spacingX,n=e._itemHeight+e._layout.spacingY,o=0,r=void 0;r=e._layout.type==b.Type.HORIZONTAL?i*e._data.length+e._layout.paddingLeft+e._layout.paddingRight:e._widthCount*i+e._layout.paddingLeft+e._layout.paddingRight;var s=Math.ceil(e._data.length/e._widthCount)*n+e._layout.paddingTop+e._layout.paddingBottom;if(e._scrollView.content.setContentSize(r,s),e._maxCount>e._updateIndex){var a,c,l,u,d,_=void 0,h=void 0,f=void 0,g=void 0,v=void 0;for(l=e._maxCount-e._updateIndex,u=e._maskViewCount,e._updateCount=u<l?u:l,a=e._itemWidth,c=e._itemHeight+e._layout.spacingY,d=e._updateIndex+e._updateCount,e._updateIndex;e._updateIndex<d;e._updateIndex++)if(e._updateIndex<t.length?_=t[e._updateIndex]:(_=e._getItemRender(),t[t.length]=_),_.setSize(e._itemWidth,e._itemHeight),_.setAnchor(.5,.5),_.itemRenderIndex=e._updateIndex,h=e._data[_.itemRenderIndex],_.itemRenderData=h,e._layout.type==b.Type.HORIZONTAL){v=-1*e._layout.paddingTop;g=e._layout.paddingLeft+a*(e._updateIndex+.5)+e._layout.spacingX*e._updateIndex,_=t[e._updateIndex],h||0===h?(_.parent||_.addToParent(e._scrollView.content),_.setData(h),_.setPosition(g,v),_.setVisible(!0),_.show()):(_.setVisible(!1),_.hide(!1))}else h?(f=e._updateIndex/e._widthCount>>0,g=1==e._widthCount?0:e._layout.paddingLeft+a*(_.itemRenderIndex%e._widthCount+.5)+e._layout.spacingX*(_.itemRenderIndex%e._widthCount)-(e._scrollView.content.width>>1),v=-1*e._layout.paddingTop+f*c*-1+-.5*c,_.y=v,_.x=g,_.setData(h),e.viewTest(_)?(_.parent||_.addToParent(e._scrollView.content),_.setVisible(!0),_.show()):(_.setVisible(!1),_.hide(!1),_.removeFromParent())):(_.setVisible(!1),_.hide(!1),_.removeFromParent());if(e._updateIndex>=e._maxCount){for(o=e._updateIndex;o<t.length;o++)(_=t[o]).setVisible(!1),_.hide(!1),_.itemRenderData=null,_.removeFromParent();e._updateTimer&&e._updateTimer.stop(),e._onScrollEnd()}}else{for(o=e._updateIndex;o<t.length;o++)itemRender=t[o],itemRender.hide(!1),itemRender.itemRenderData=null,itemRender.removeFromParent();e._updateTimer&&e._updateTimer.stop(),e._onScrollEnd()}},viewTest:function(e){var t=this;return t._scrollView.content.y<=-1*(e.y-t._itemHeight-t._layout.spacingY)&&-1*(t._scrollView.content.y+t._maskHeight+(t._itemHeight+t._layout.spacingY<<1))<=e.y},viewTestH:function(e){var t=this;return-1*t._scrollView.content.x-t._itemWidth<e.x-(t._itemWidth>>1)&&-1*t._scrollView.content.x+t._maskWidth+t._itemWidth>e.x+(t._itemWidth>>1)},getItemRender:function(e){var t=void 0,i=void 0;for(i=0;i<this._itemRenders.length;i++)if((t=this._itemRenders[i]).itemRenderIndex==e)return t;return null},getItemRenderLocalToGlobal:function(e){if(!e)return 0;return{x:e.x+this._scrollView.node.x,y:e.y-this._scrollView.content.y+this._scrollView.node.y}},scrollLeft:function(e){void 0===e&&(e=300);var t=this,i=t._scrollView.content.x+t._maskWidth;0<i&&(i=0),t._scrollView.stopAutoScroll(),b8e.Tween.get(t).to({contentX:i,onUpdate:t._onScrolling,onUpdateThis:t},e).call(t._onScrollEnd)},scrollRight:function(e){void 0===e&&(e=300);var t=this,i=t._scrollView.content.x,n=t._maskWidth,o=i-n,r=-1*t._scrollView.content.getContentSize().width+n;o<r&&(o=r),t._scrollView.stopAutoScroll(),b8e.Tween.get(t).to({contentX:o,onUpdate:t._onScrolling,onUpdateThis:t},e).call(t._onScrollEnd)},_onScrollEnd:function(){var e=this;if(Math.ceil(e._data.length/e._widthCount)*(e._itemHeight+e._layout.spacingY)<=e._maskHeight&&e._scrollView.scrollToTop(0),e._onScrolling(),e._viewCb&&e._viewThis){for(var t=[],i=[],n=[],o=void 0,r=0,s=e._itemRenders.length;r<s;r++)o=e._itemRenders[r],e.viewTestH(o)?i[i.length]=e._data[r]:0==i.length?t[t.length]=e._data[r]:n[n.length]=e._data[r];e._viewCb.call(e._viewThis,t,i,n)}},_onScrolling:function(){var e=this,t=(e._scrollView.content.x,e._scrollView.content.y);if(4*Math.abs(e._offsetY)<e._itemHeight&&(e._offsetY=e._offsetY+t-e._lastOffsetY,e._offsetY<e._itemHeight))e._lastOffsetY=t;else{e._offsetY=0,e._lastOffsetY=t;for(var i=e._itemHeight+e._layout.spacingY,n=(e._scrollView.content.getContentSize(),((t+e._layout.paddingTop)/i>>0)*e._widthCount),o=void 0,r=n;r<n+e._maskViewCount;r++)(o=e._itemRenders[r])&&(o.itemRenderData||0===o.itemRenderData)&&e.viewTest(o)&&(o.show(),o.setVisible(!0),o.parent||o.addToParent(e._scrollView.content))}},contentX:{set:function(e){this._scrollView.content.x=e},get:function(){return this._scrollView.content.x}},contentY:{set:function(e){this._scrollView.content.y=e},get:function(){return this._scrollView.content.y}},_clearAllItemRender:function(e){void 0===e&&(e=!0);var t=this,i=void 0,n=void 0;n=e?0:t._maskViewCount+t._widthCount;for(var o=t._itemrenderPool;t._itemRenders.length>n;)(i=t._itemRenders.pop())&&(i.hide(),i.removeFromParent(),i.itemRenderData=null),o[o.length]=i;o.sort(t._sortItemRender),0==t._itemRenders.length&&t._clearAllTimer&&t._clearAllTimer.stop()},_sortItemRender:function(e,t){return e.itemRenderIndex-t.itemRenderIndex},_getItemRender:function(){return 0<this._itemrenderPool.length?this._itemrenderPool.shift():new this._itemRenderClass},dispose:function(){var e=this;e.hide();var t=void 0;if(e._itemRenders){for(t=0;t<e._itemRenders.length;t++)e._itemRenders[t].destroy();e._itemRenders.length=0,e._itemRenders=null}if(e._itemrenderPool){for(t=0;t<e._itemrenderPool.length;t++)e._itemrenderPool[t].destroy();e._itemrenderPool.length=0,e._itemrenderPool=null}e._updateTimer&&(e._updateTimer.dispose(),e._updateTimer=null),e._clearAllTimer&&(e._clearAllTimer.dispose(),e._clearAllTimer=null),e._startRefreshTimer&&(e._startRefreshTimer.dispose(),e._startRefreshTimer=null),e._itemRenderClass=null,e._scrollView=null,e._data=null},release:function(){this.destroy()},destroy:function(){this.dispose()}});var t=b=b8e.Object.extends({lineMaxCount:1,type:2,spacingX:0,spacingY:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,ctor:function(){this._super()},setupByComponent:function(e){if(e){var t=this;t.type=e.type,t.paddingLeft=e.paddingLeft,t.paddingRight=e.paddingRight,t.paddingTop=e.paddingTop,t.paddingBottom=e.paddingBottom,t.spacingX=e.spacingX,t.spacingY=e.spacingY}}}),i=b8e.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3});t.Type=i,b8e.RC("$$b8e","$$List",e),b8e.RC("$$b8e","$$LayoutOld",b)}(),b8e.LayoutUtil={},b8e.LayoutUtil.layout=function(e,t){if(e.layout){void 0===t&&(t=0);var i=e.layout;if(e.layout.type!==b8e.LayoutType.None){var n=e.getLayoutContent();if(n&&!(n.length<=0)){for(var o=void 0,r=void 0,s=(e.getAnchor(),null),a=0,c=0,l=0,u=0,d=e.getWidth(),_=e.getHeight(),h=0,f=n.length;h<f;h++)if(o=n[h],h<t)r=o;else{switch(i.type){case b8e.LayoutType.Horizontal:a=r?r.x+r.width+i.spacingX:i.paddingLeft,c=i.paddingTop,(!s||s.height<o.height)&&(s=o);break;case b8e.LayoutType.Vertical:c=r?r.y-r.height-i.spacingY:-1*i.paddingTop,a=i.paddingLeft,(!s||s.width<o.width)&&(s=o);break;case b8e.LayoutType.Grid:if(r)if((a=r.x+r.width+i.spacingX)+o.width+i.paddingRight>d){if(a=0+i.paddingLeft,!s)return void b8e.error(3092);c=s.y-s.height-i.spacingY,s=null}else(!s||s.height<o.height)&&(s=o),c=r.y;else a=0+i.paddingLeft,c=-1*i.paddingTop}o.setPosition(a,c),r=o}if(o)switch(i.type){case b8e.LayoutType.Horizontal:l=o.x+o.width+i.paddingRight,u=s?s.height:_;break;case b8e.LayoutType.Vertical:l=s?s.width:d,u=-1*(o.y-o.height-i.paddingBottom);break;case b8e.LayoutType.Grid:l=d,u=-1*((s=s||o).y-s.height-i.paddingBottom)}e.setSize(l,u)}}}else b8e.error(3091)},function(){var e=void 0;(e=b8e.Object.extends({ctor:function(){if(e._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6LayerManager\u5b9e\u4f8b\uff01");this._super()},init:function(){return this.createLayers(),this},showBackground:function(e,t,i,n){if(b8e.macro.IS_DESKTOP)i&&n&&i.call(n);else{if(!this._background)if(void 0===e&&(e=4278190080),isNaN(e)){if(t){var o=function(){r.setAnchor(.5,.5),r.setPosition(b8e.stageWidth>>1,b8e.stageHeight>>1)},r=this._background=bui.Sprite.get();r.clearDisabled=!0,r.addToParent(b8e.stage.getNode()._parent),r.setLocalZOrder(-3e4),r.loadTexture(t,function(){i&&n&&i.call(n)},null,{version:b8e.version}),b8e.SHC(o),b8e.evt.addG(r,b8e.Event.STAGE_RESIZE,o),o()}}else{var s=function(){a.setSize(b8e.stageWidth,b8e.stageHeight),a.clear(),a.fillColor(e),a.fillRect(0,0,a.width,a.height)},a=this._background=bui.Graphics.get();a.clearDisabled=!0,b8e.root.addChild(a),a.setLocalZOrder(-3e4),b8e.SHC(s),b8e.evt.addG(a,b8e.Event.STAGE_RESIZE,s),s()}}},clearBackground:function(){this._background&&(this._background.removeFromParent(),this._background=null)},showLoading:function(e){if(b8e.EngineGui){void 0===e&&(e="Initialize...");var t=this,i=t._loadingPanel;if(!i){var n=function(){},o=function(){b8e.startup.reload()},r=function(){i.setSize(b8e.stageWidth,b8e.stageHeight),i.setPosition(b8e.stageWidth-i.width>>1,b8e.stageHeight-i.height>>1),s.setPosition(b8e.stageWidth>>1,b8e.stageHeight>>1);var e=t._loadingLabel;e.setPosition(b8e.stageWidth-e.width>>1,b8e.stageHeight-e.height>>1),(e=t._msgLabel).setPosition(b8e.stageWidth-e.width>>1,(b8e.stageHeight-e.height>>1)-200),(e=t._reloadLabel).setPosition(b8e.stageWidth-e.width>>1,(b8e.stageHeight-e.height>>1)-300)};b8e.SHC(n),(i=t._loadingPanel=b8e.BaseDisplay.get()).setLocalZOrder(2e4),b8e.evt.onC(i,n,i);var s=t._loadingPoint=bui.Sprite.get();s.setAnchor(.5,.5),i.addChild(s),s.loadTexture("assets/resources/loading.png",null,null,{version:b8e.version,format:"bti"});var a=t._loadingLabel=bui.Label.get();a.fontAtlasName="loading",i.addChild(a),(a=t._msgLabel=bui.Label.get()).fontAtlasName="loading",i.addChild(a),b8e.SHC(o),(a=t._reloadLabel=bui.Label.get()).color=4278255360,a.fontAtlasName="loading",a.isUnderline(!0),b8e.evt.onC(a,o,a),b8e.SHC(r),b8e.evt.addG(i,b8e.Event.STAGE_RESIZE,r),r()}b8e.root.addChild(i);var c=t._loadingLabel;c.setText(e),c.setPosition(b8e.stageWidth-c.width>>1,b8e.stageHeight-c.height>>1);var l=t._loadingPoint;l.rotation=0,b8e.Tween.kill(l),b8e.Tween.get(l,{loop:!0}).to({rotation:360},1e3)}},hideLoading:function(){var e=this;if(e._loadingPanel&&e._loadingPanel.parent){e._loadingLabel&&e._loadingLabel.setText(""),e._msgLabel&&e._msgLabel.setText("");var t=e._reloadLabel;t&&(t.setText(""),t.removeFromParent());var i=e._loadingPoint;i&&(b8e.Tween.kill(i),i.rotation=0),e._loadingPanel.removeFromParent()}},showError:function(e){if(this._loadingPanel.parent){void 0===e&&(e="error");var t=this._msgLabel;t&&(t.color=4294901760,t.setText(e),t.setPosition(b8e.stageWidth-t.width>>1,(b8e.stageHeight-t.height>>1)-200))}},showInfo:function(e){if(this._loadingPanel.parent){void 0===e&&(e="info");var t=this._msgLabel;t&&(t.color=4294967040,t.setText(e),t.setPosition(b8e.stageWidth-t.width>>1,(b8e.stageHeight-t.height>>1)-200))}},showReload:function(e){if(this._loadingPanel.parent){void 0===e&&(e="\u5237\u65b0\u6e38\u620f");var t=this._reloadLabel;t&&(t.active=!b8e.isWeChatGame,this._loadingPanel.addChild(t),t.setText(e),t.setPosition(b8e.stageWidth-t.width>>1,(b8e.stageHeight-t.height>>1)-300))}},createLayers:function(){var e=this;e._sceneLayer=b8e.BaseDisplay.get(),e._sceneLayer.displaySniffEnable=!1,e._sceneLayer.setAnchor(0,0),e._sceneLayer.setPosition(0,0),b8e.root.addChild(e._sceneLayer),e._guiLayer=b8e.BaseDisplay.get(),e._guiLayer.displaySniffEnable=!1,e._guiLayer.setAnchor(0,0),e._guiLayer.setPosition(0,0),b8e.root.addChild(e._guiLayer),e._topLayer=b8e.BaseDisplay.get(),e._topLayer.displaySniffEnable=!1,e._topLayer.setAnchor(0,0),e._topLayer.setPosition(0,0),b8e.root.addChild(e._topLayer),e.createGuiLayer()},createGuiLayer:function(){var e=this;e._guiBottomLayer=b8e.BaseDisplay.get(),e._guiBottomLayer.displaySniffEnable=!1,e._guiBottomLayer.setAnchor(0,0),e._guiBottomLayer.setPosition(0,0),e._guiLayer.addChild(e._guiBottomLayer),e._guiMiddleLayer=b8e.BaseDisplay.get(),e._guiMiddleLayer.displaySniffEnable=!1,e._guiMiddleLayer.setAnchor(0,0),e._guiMiddleLayer.setPosition(0,0),e._guiLayer.addChild(e._guiMiddleLayer),e._guiTopLayer=b8e.BaseDisplay.get(),e._guiTopLayer.displaySniffEnable=!1,e._guiTopLayer.setAnchor(0,0),e._guiTopLayer.setPosition(0,0),e._guiLayer.addChild(e._guiTopLayer)},setSize:function(e,t){var i=this;i._sceneLayer.setSize(e,t),i._guiLayer.setSize(e,t),i._topLayer.setSize(e,t),i._guiTopLayer.setSize(e,t),i._guiMiddleLayer.setSize(e,t),i._guiBottomLayer.setSize(e,t)},getTopLayer:function(){return this._topLayer},getSceneLayer:function(){return this._sceneLayer},getGuiLayer:function(){return this._guiLayer},getGuiBottomLayer:function(){return this._guiBottomLayer},getGuiMiddleLayer:function(){return this._guiMiddleLayer},getGuiTopLayer:function(){return this._guiTopLayer}}))._instance=null,e._singleton=!0,e.inst=function(){return e._instance||(e._singleton=!1,e._instance=new e,e._singleton=!0),e._instance},b8e.RC("$$b8e","$$LayerMgr",e)}(),function(){var t=void 0,i=t=b8e.Object.extends({ctor:function(){if(t._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6SoundManager\u5b9e\u4f8b\uff01");var e=this;e._super(),e._currBgmUrl=null,e._currBgmSound=null,e._bgmIsLoad=!1,e._currEaxUrl=null,e._currEaxSound=null,e._eaxIsLoad=!1,e._esIsLoadByUrl={},e._currEsSoundByUrl={},e._bgmVolume=1,e._eaxVolume=1,e._esVolume=1},preload:function(e,t){b8e.res.loadRes(e,b8e.Sound,t,this,null,{useManifest:!1,noCache:!!b8e.params.isBiliGame})},onBgmSoundComplete:function(e,t){t&&t.url==this._currBgmUrl&&(this._currBgmSound=t).play(!0,this._bgmVolume)},onEaxSoundComplete:function(e,t){t&&(this._currEaxSound=t).play(!0,this._eaxVolume)},onEsSoundComplete:function(e,t,i,n){if(t){(this._currEsSoundByUrl[t.url]=t).play(n,this._esVolume,i,this.onEsFinish,this)}},playBackgroundMusic:function(e,t){this._currBgmUrl==e&&!t||(this._stopCurrBgm(),this._currBgmUrl=e,this._resumeBgm())},playEnvironmentAudio:function(e){this._currEaxUrl!=e&&(this._stopCurrEax(),this._currEaxUrl=e,this._resumeEax())},stopBackgroundMusic:function(){this._stopCurrBgm()},stopEnvironmentAudio:function(){this._stopCurrEax()},stopAllEffectSound:function(){this._stopAllEs()},pauseBackgroundMusic:function(){this._isBgmPaused||(this._isBgmPaused=!0,this._pauseCurrBgm())},_pauseCurrBgm:function(){var e=this;e._currBgmSound&&(e._currBgmSound.stop(),e._currBgmSound=null),e._bgmIsLoad&&(b8e.res.unloadRes(e._currBgmUrl,e.onBgmSoundComplete,e),e._bgmIsLoad=!1)},pauseEnvironmentAudio:function(){this._isEaxPaused||(this._isEaxPaused=!0,this._pauseCurrEax())},_pauseCurrEax:function(){var e=this;e._currEaxSound&&(e._currEaxSound.stop(),e._currEaxSound=null),e._eaxIsLoad&&(b8e.res.unloadRes(e._currEaxUrl,e.onEaxSoundComplete,e),e._eaxIsLoad=!1)},_stopAllEs:function(){var e=this;for(var t in e._currEsSoundByUrl){e._currEsSoundByUrl[t].stop(),b8e.res.unloadRes(t,e.onEsSoundComplete,e)}e._currEsSoundByUrl={},e._esIsLoadByUrl={}},resumeBackgroundMusic:function(){this._isBgmPaused&&(this._isBgmPaused=!1,this._resumeBgm())},_resumeBgm:function(){var e=this;e._currBgmSound&&(e._currBgmSound.stop(),e._currBgmSound=null),e._bgmIsLoad&&(b8e.res.unloadRes(e._currBgmUrl,e.onBgmSoundComplete,e),e._bgmIsLoad=!1),e._isActivated&&e._currBgmUrl&&!e._isBgmPaused&&(e._bgmIsLoad=!0,b8e.res.loadRes(e._currBgmUrl,b8e.Sound,e.onBgmSoundComplete,e,null,{useManifest:!1,noCache:!!b8e.params.isBiliGame}))},resumeEnvironmentAudio:function(){this._isEaxPaused&&(this._isEaxPaused=!1,this._resumeEax())},_resumeEax:function(){var e=this;e._currEaxSound&&(e._currEaxSound.stop(),e._currEaxSound=null),e._eaxIsLoad&&(b8e.res.unloadRes(e._currEaxUrl,e.onEaxSoundComplete,e),e._eaxIsLoad=!1),e._isActivated&&e._currEaxUrl&&!e._isEaxPaused&&(e._eaxIsLoad=!0,b8e.res.loadRes(e._currEaxUrl,b8e.Sound,e.onEaxSoundComplete,e,null,{useManifest:!1,noCache:!!b8e.params.isBiliGame}))},backgroundMusicmPaused:function(){return this._isBgmPaused},environmentAudioPaused:function(){return this._isEaxPaused},_stopCurrBgm:function(){var e=this;e._currBgmSound&&(e._currBgmSound.stop(),e._currBgmSound=null),e._bgmIsLoad&&(b8e.res.unloadRes(e._currBgmUrl,e.onBgmSoundComplete,e),e._bgmIsLoad=!1)},_stopCurrEax:function(){var e=this;e._currEaxSound&&(e._currEaxSound.stop(),e._currEaxSound=null),e._eaxIsLoad&&(b8e.res.unloadRes(e._currEaxUrl,e.onEaxSoundComplete,e),e._eaxIsLoad=!1)},setBackgroundMusicVolume:function(e){this._bgmVolume=e,this._currBgmSound&&this._currBgmSound.setVolume(e)},setEnvironmentAudioVolume:function(e){this._eaxVolume=e,this._currEaxSound&&this._currEaxSound.setVolume(e)},getBackgroundMusicVolume:function(){return this._bgmVolume},getEnvironmentAudioVolume:function(){return this._eaxVolume},playEffectSound:function(e,t,i){var n=this;if(n._isActivated&&e&&!n._isEsPaused){var o=n._currEsSoundByUrl[e];o&&(o.stop(t),o.play(!!i,n._esVolume,t,n.onEsFinish,n)),n._esIsLoadByUrl[e]||(n._esIsLoadByUrl[e]=!0,b8e.res.loadRes(e,b8e.Sound,n.onEsSoundComplete,n,[t,!!i],{useManifest:!1,noCache:!!b8e.params.isBiliGame}))}},onEsFinish:function(e){var t=e.url;e.stop(),b8e.res.unloadRes(t,this.onEsSoundComplete,this),delete this._currEsSoundByUrl[t],delete this._esIsLoadByUrl[t]},setEffectSoundVolume:function(e){this._esVolume=e},getEffectSoundVolume:function(){return this._esVolume},pauseEffectSound:function(){this._isEsPaused||(this._stopAllEs(),this._isEsPaused=!0)},resumeEffectSound:function(){this._isEsPaused&&(this._isEsPaused=!1)},effectSoundPaused:function(){return this._isEsPaused},init:function(){i.AUTOPLAY&&!i._emptyPlayed&&this.preload("assets/resources/empty.mp3",this._emptyLoad,this)},_emptyLoad:function(){},activate:function(){this._isActivated||(this._isActivated=!0,b8e.isCocos&&b8e.audioEngine._restore(),this._resumeBgm(),this._resumeEax())},deactivate:function(){var e=this;e._isActivated&&(e._isActivated=!1,e._pauseCurrBgm(),e._pauseCurrEax(),e._stopAllEs(),b8e.isCocos&&b8e.audioEngine._break(),i._emptyPlayed=!1)}});i.BACKGROUND_MUSIC_DIR="sound",i.ENVIRONMENT_AUDIO_DIR="sound",i.EFFECT_SOUND_DIR="sound",i.AUTOPLAY=!1,i._emptyPlayed=!1,i._instance=null,i._singleton=!0,i.inst=function(){return i._instance||(i._singleton=!1,i._instance=new i,i._singleton=!0),i._instance},b8e.RC("$$b8e","$$SoundMgr",t)}(),function(){var e=void 0,n=e=b8e.Object.extends({ctor:function(){if(e._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6SceneManager\u5b9e\u4f8b\uff01");this._super(),this._sceneMap=b8e.HashMap.get()},init:function(){b8e.updateStageSize();var e=cc.view;e.setResizeCallback(function(){b8e.updateStageSize()}),e.resizeWithBrowserSize=this.resizeWithBrowserSize,e.resizeWithBrowserSize(!0),e._resizeEvent()},resizeWithBrowserSize:function(e){var t=cc.view,i=window;b8e.isWeChatGame||b8e.params.isQuickGame||n._resetContainer||b8e.params.isQuickGame||(n._resetContainer=function(){var e=(b8e.isCocos190?cc.container:cc.game.container).style,t=cc.game.canvas;t.width=1,t.height=1,t.style.width="1px",t.style.height="1px",e.margin="0",e.width="1px",e.height="1px"}),n._orientationChange||(n._orientationChange=function(){n._resetContainer&&n._resetContainer(),b8e.hasTimeout(t._resizeEvent,t)||b8e.setTimeout(t._resizeEvent,t,200)}),n._resizeEvent||(n._resizeEvent=function(){n._resetContainer&&n._resetContainer(),b8e.hasTimeout(t._resizeEvent,t)||b8e.setTimeout(t._resizeEvent,t,200)}),e?t.__resizeWithBrowserSize||(t.__resizeWithBrowserSize=!0,i.addEventListener("resize",n._resizeEvent),i.addEventListener("orientationchange",n._orientationChange)):t.__resizeWithBrowserSize&&(t.__resizeWithBrowserSize=!1,i.removeEventListener("resize",n._resizeEvent),i.removeEventListener("orientationchange",n._orientationChange))},setWindowSize:function(e,t){var i=cc.view;i&&(i._resizeEvent(),i.setCanvasSize(e,t),i.setFrameSize(e,t))},setWindowOrientation:function(){var e=cc.view;e&&e._orientationChange()},updateResolution:function(e){e=this.isFullScreen()?document.documentElement.getBoundingClientRect():this.getEmulatedScreenSize(e);var t=document.getElementById("GameDiv");t&&(t.style.width=e.width+"px",t.style.height=e.height+"px"),cc.view.setCanvasSize(e.width,e.height)},isFullScreen:function(){return!1},getEmulatedScreenSize:function(e){return e},setEmulatedScreenSize:function(e){this.updateResolution(e)},createScene:function(e,t,i,n){var o=this._sceneMap.get(e);return o||(o=new b8e.Scene(t,i,n),this._sceneMap.set(e,o)),o},getScene:function(e){return this._sceneMap.get(e)},removeScene:function(e){var t=this._sceneMap.get(e);t&&(t.destroy(),this._sceneMap.del(e))},activateScene:function(e){return this._activeScene=this._sceneMap.get(e),this._activeScene},getActiveScene:function(){return this._activeScene}});n._instance=null,n._singleton=!0,n.inst=function(){return n._instance||(n._singleton=!1,n._instance=new n,n._singleton=!0),n._instance},b8e.RC("$$b8e","$$SceneMgr",e)}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,a=e=b8e.Object.extends({ctor:function(e){this.name=e,this._super()},initSocket:function(e){var t=this;if(!t._socket){b8e.log("\u521b\u5efasocket"),void 0===e&&(e=b8e.Socket.TYPE_STRING),t._lastTimeByMsg={},t._inputTotalbytes=0,t._outputTotalbytes=0,t._currFrameReceiveCount=0,t.maxFrameReceiveCount=0,t._msgHandlerByKey=b8e.HashMap.get();var i=new b8e.Socket;(t._socket=i).type=e,i.addEventListener(b8e.ProgressEvent.SOCKET_DATA,t.onReceiveMessage,t),i.addEventListener(b8e.Event.CONNECT,t.onSocketOpen,t),i.addEventListener(b8e.Event.CLOSE,t.onSocketClose,t),i.addEventListener(b8e.IOErrorEvent.IO_ERROR,t.onSocketError,t)}},_connectTimer:void 0,clear:function(){var e=this;e._host=null,e._port=null,e._onConnect=null,e._onClose=null,e._onError=null,e._onMessage=null,e._onConnectThis=null,e._onTimeOut=null,e._struct=null,e._socket.removeEventListener(b8e.ProgressEvent.SOCKET_DATA,e.onReceiveMessage),e._socket.removeEventListener(b8e.Event.CONNECT,e.onSocketOpen),e._socket.removeEventListener(b8e.Event.CLOSE,e.onSocketClose),e._socket.removeEventListener(b8e.IOErrorEvent.IO_ERROR,e.onSocketError),e._socket.close(),e._socket._connecting=!1,e._socket._connected=!1,e._socket=null,e._connectTimer&&(b8e.clearTimeout(e._connectTimer),e._connectTimer=void 0)},connectServer:function(e,t,i,n,o,r,s,a,c){var l=this;l._host=e,l._port=t,l._onConnect=i,l._onClose=n,l._onError=o,l._onMessage=r,l._onConnectThis=s,l._onTimeOut=a;var u=null;c&&void 0!==c.struct&&(u=c.struct),l._struct=u,l._socket.type!=b8e.Socket.TYPE_JSON||u||b8e.warn(3502),b8e.log("SocketConnect"),b8e.log("_connecting:"+l._socket._connecting+"_connected:"+l._socket._connected),l._connectTimer&&(b8e.clearTimeout(l._connectTimer),l._connectTimer=void 0),l._connectTimer=b8e.setTimeout(l._onConnectTimeout,l,1e4),0<t?l._socket.connect(e,t):l._socket.connectByUrl(e)},_onConnectTimeout:function(){var e=this;e._connectTimer=void 0,b8e.layer.showInfo("\u8fde\u63a5\u670d\u52a1\u5668\u8d85\u65f6\uff0c\u8bf7\u70b9\u51fb\u5237\u65b0\u6e38\u620f\uff01"),e.name===a.MAIN_NAME&&(b8e.layer.showLoading("\u8fde\u63a5\u8d85\u65f6..."),b8e.layer.showReload()),e._onTimeOut&&e._onTimeOut.call(e._onConnectThis)},closeConnection:function(){var e=this;e.name===a.MAIN_NAME&&b8e.layer.hideLoading(),e._connectTimer&&(b8e.clearTimeout(e._connectTimer),e._connectTimer=void 0),e._socket.close()},onReceiveMessage:function(e){var t=this,i=t._socket,n=e.data;if(i.type==b8e.Socket.TYPE_BINARY){var o=n,r=o.length;0<r&&(t._outputTotalbytes+=r,t._currFrameReceiveCount++,t._nextReceive(o))}else if(i.type==b8e.Socket.TYPE_JSON){var s=n;if(s){var a=b8e.JsUtil.jsonParse(s,t._struct||!0);t._onMessage&&t._onMessage.call(t._onConnectThis,a)}}else{var c=n;t._onMessage&&t._onMessage.call(t._onConnectThis,c)}},_nextReceive:function(e){var t=this,i=b8e.getTimer();t._onReceiveHandler(e,i),t._currFrameReceiveCount>t.maxFrameReceiveCount&&(t.maxFrameReceiveCount=t._currFrameReceiveCount),t._currFrameReceiveCount=0},_onReceiveHandler:function(e,t){b8e.macro.IS_DEBUG&&a.IS_DEBUG&&b8e.log("++++++++++++++++++++++++++");if(this._onMessage)this._onMessage.call(this._onConnectThis,e);else if(0<e.bytesAvailable){var i=e.readUnsignedShort();b8e.macro.IS_DEBUG&&a.IS_DEBUG&&b8e.log("receive message id:"+i+",length:"+e.length);var n=this._msgHandlerByKey.get(i);if(n)n.handler.call(n.thisArg,e,t);else b8e.warn(3138,i)}b8e.macro.IS_DEBUG&&a.IS_DEBUG&&(b8e.log(e.dump(a.DUMP_RADIX)),b8e.log("++++++++++++++++++++++++++"))},getBytes:function(){var e=a._byteArray;return e.clear(),e},sendBinary:function(e,t){if(e<1||65535<e)b8e.error(3001);else{var i=this;if(b8e.macro.IS_DEBUG&&a.IS_DEBUG){var n=b8e.getTimer();n-(0|+i._lastTimeByMsg[e])<10&&b8e.warn(3002,e),i._lastTimeByMsg[e]=n}var o=a._byteArray,r=b8e.ByteBuffer.get();r.writeUnsignedShort(e),r.writeBytes(t||o);var s=r.length;0<s&&(i._inputTotalbytes+=s,b8e.macro.IS_DEBUG&&a.IS_DEBUG&&(b8e.log("++++++++++++++++++++++++++"),b8e.log("send message id:"+e+",length:"+r.length),b8e.log(r.dump(a.DUMP_RADIX)),b8e.log("++++++++++++++++++++++++++")),i._socket.writeBytes(r),i._socket.flush()),r.release(),o.clear()}},sendString:function(e){if((void 0===e?"undefined":v(e))===b8e.TypeObject&&(b8e.JsUtil.applyAlias(e,!0),e=JSON.stringify(e)),e){b8e.macro.IS_DEBUG&&a.IS_DEBUG&&b8e.log("send data",e);this._socket.writeUTF(e),this._socket.flush()}},addMsgHandler:function(e,t,i){if(e)if(t){this._msgHandlerByKey.get(e)?b8e.error(3005,e):this._msgHandlerByKey.set(e,{handler:t,thisArg:i})}else b8e.error(3004,t);else b8e.error(3003,e)},removeMsgHandler:function(e){this._msgHandlerByKey&&this._msgHandlerByKey.has(e)&&this._msgHandlerByKey.del(e)},subscribe:function(e,t,i){if(i)for(var n in e){var o=t[n];if(o){var r=e[n];r?this.addMsgHandler(o,r,i):b8e.error(3008,n,r)}else b8e.error(3007,n,o)}else b8e.error(3006,i)},request:function(e,t,i){if(i){var n=this;for(var o in e){var r=t[o];if(r){var s=e[o];i[o]=function(e,t){return function(){t&&t.apply(i,arguments),n.sendBinary(e)}}(r,s)}else b8e.error(3010,o,r)}}else b8e.error(3009,i)},onSocketOpen:function(){var e=this;b8e.log(e.name+":SocketOpen"),e.name===a.MAIN_NAME&&b8e.layer.hideLoading(),e._connectTimer&&(b8e.clearTimeout(e._connectTimer),e._connectTimer=void 0),e._onConnect&&e._onConnect.call(e._onConnectThis)},onSocketClose:function(){b8e.log(this.name+":SocketClose"),this._onClose&&this._onClose.call(this._onConnectThis)},onSocketError:function(){b8e.log(this.name+":SocketError!"),this._onError&&this._onError.call(this._onConnectThis)},requestData:function(e,t,i,n,o,r,s){var a=null;a=r?b8e.URLRequestMethod.POST:b8e.URLRequestMethod.GET;var c=null,l=!0,u=!1,d=null,_=b8e.URLLoaderDataFormat.JSON,h=b8e.macro.MAX_REQUEST_RELOAD;s&&(void 0!==s.stringify&&(l=s.stringify),void 0!==s.isJson&&(u=s.isJson),void 0!==s.dataFormat&&(_=s.dataFormat),void 0!==s.onStatus&&(c=s.onStatus),void 0!==s.struct&&(d=s.struct),void 0!==s.reloadLimit&&(h=s.reloadLimit)),u&&!d&&b8e.warn(3502);var f=new b8e.URLLoader;f.struct=d,f.context=o,f.dataFormat=_,f.reloadLimit=h,f.reloadCount=0,f.addEventListener(b8e.Event.COMPLETE,this.onDataComplete,this),f.addEventListener(b8e.IOErrorEvent.IO_ERROR,this.onDataError,this),i&&f.setCompleteHandler(i,n,c);var g=new b8e.URLRequest(e);g.method=a,t&&(t.charCodeAt?g.data=t:g.data=l?new b8e.URLVariables(t,u):t),f.load(g)},onDataComplete:function(e){var t=e.target,i=t.data,n=t.context;b8e.macro.IS_DEBUG&&a.IS_DEBUG&&b8e.log("receive data:"+i),t._onComplete(i,n)},onDataError:function(e){var t=e.target;if(t){if("ioError"===e.type&&(t.reloadLimit<0||t.reloadCount<t.reloadLimit))return t.reloadCount++,b8e.warn(3139,t._request.url),t._onStatus("reload"),void b8e.setTimeout(t.reload,t,1e3);b8e.error(3011,e.type,t._request.url);var i=t.context;t._onError(e.type,i)}},getInputTotalbytes:function(){return this._inputTotalbytes},getOutputTotalbytes:function(){return this._outputTotalbytes},debugReset:function(){this.maxFrameReceiveCount=0}});a.MAIN_NAME="main";a._instByName=b8e.HashMap.get();a.createMgr=function(e){var t=a._instByName.get(e);return t||(t=new a(e),a._instByName.set(e,t)),t},a.getMgr=function(e){return a._instByName.get(e)},a._byteArray=b8e.ByteBuffer.get(),a.IS_BATCH=!1,a.IS_DEBUG=!1,a.DUMP_RADIX=16,b8e.RC("$$b8e","$$NetMgr",e)})(),function(){var e,t=e=b8e.Object.extends({_runQueue:null,_currRun:null,ctor:function(){if(t._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6WorkerManager\u5b9e\u4f8b\uff01");this._super(),this.init()},init:function(){this._runQueue=[],this._loadScript()},_loadScript:function(){b8e.res.loadRes("module/wk.bgp",null,this._onScriptLoaded,this)},_onScriptLoaded:function(e,t){if(t){var o=this;o.worker=b8e.Worker.create(function(e){var t=e.data;t instanceof ArrayBuffer&&(t=b8e.Inflate.ungzip(new Uint8Array(t)).buffer),t instanceof ArrayBuffer?self.postMessage(t,[t]):self.postMessage(t)},{b8e:"{IS_WORKER:true}"},t),o.worker.subscribe(function(e){var t=e.data,i=o._currRun;if(i){i.callback.call(null,i.type,i.url,null,t),o._currRun=null;var n=o._runQueue;0<n.length&&o.run(n.shift())}},!1);var i=o._runQueue;0<i.length&&o.run(i.shift())}},run:function(e){this._currRun=e,this.worker.run(e.data)},runUnzip:function(e,t,i){var n=this._runQueue;n[n.length]={type:"runUnzip",url:e,data:t,callback:i},this.worker&&(this._currRun||this.run(n.shift()))}});t._instance=null,t._singleton=!0,t.inst=function(){return t._instance||(t._singleton=!1,t._instance=new t,t._singleton=!0),t._instance},b8e.RC("$$b8e","$$WorkerMgr",e)}(),function(){var e,o=e=b8e.BaseDisplay.extends({ctor:function(){this._super(),this.setLocalZOrder(3e4),this._clearHandler=null},launch:function(e,t,i,n){if(e){void 0===t&&(t=4294967295),void 0===i&&(i=3600),void 0===n&&(n=0);var o=this;if(o._msg=e,o._bg||(o._bg=bui.Graphics.get(),b8e.evt.addG(o,b8e.Event.STAGE_RESIZE,o.onResize)),o.addChild(o._bg),o._tx&&o._tx.removeFromParent(),isNaN(t)?(o._richText||(o._richText=bui.RichText.get(),o._richText.fontAtlasName="toast"),o._tx=o._richText,o._tx.setFontSize(32),o._tx.setLineHeight(34),o._tx.setHorizontalAlign(b8e.HorizontalAlign.CENTER),o._tx.setColor(4294967295)):(o._label||(o._label=bui.Label.get(),o._label.fontAtlasName="toast"),o._tx=o._label,o._tx.setFontSize(32),o._tx.setLineHeight(34),o._tx.setOverflow(b8e.OverflowType.RESIZE_HEIGHT),o._tx.setHorizontalAlign(b8e.HorizontalAlign.CENTER),o._tx.setColor(t),o._tx.setFontFamily("Microsoft YaHei")),o._tx.setText(o._msg),o.addChild(o._tx),b8e.root.addChild(o),b8e.Tween.kill(o),0<i)if(1==n)o.alpha=1,b8e.Tween.get(o,{loop:!0}).to({alpha:.1},i>>1).to({alpha:1},i>>1);else{var r=.2*i>>(o.alpha=0),s=.4*i>>0,a=.3*i>>0;b8e.Tween.get(o).to({alpha:1},r,b8e.Ease.quintOut).wait(s).to({alpha:0},a,b8e.Ease.quintIn).call(function(){o.clear()})}else o.alpha=1;o.onResize()}},onResize:function(){var e=this,t=b8e.stageWidth-50,i=b8e.stageHeight-100;e._tx.setSize(t-100,i-20),e._bg.clear(),e._bg.setSize(t,e._tx.height+20),e._bg.fillColor(3423670545),e._bg.fillRoundRect(0,0,e._bg.width,e._bg.height,10),e._bg.setPosition(0,0),e._tx.setPosition(e._bg.width-e._tx.width>>1,e._bg.height-e._tx.height>>1),e.setPosition(b8e.stageWidth-e._bg.width>>1,b8e.stageHeight-e._bg.height>>1)},clear:function(){var e=this;if(e._msg){e._msg=null,b8e.evt.rmvG(e,b8e.Event.STAGE_RESIZE,e.onResize),b8e.Tween.kill(e),e._bg.release(),e._bg=null,e._label&&(e._label.release(),e._label=null),e._richText&&(e._richText.release(),e._richText=null),e._tx=null,e.removeFromParent();var t=e._clearHandler;e._clearHandler=null,t&&t.handler.call(t.thisArg)}},onClear:function(e,t){this._clearHandler={handler:e,thisArg:t}},dispose:function(){this.clear(),this._super()}}),r=null;o.timeoutIdx=void 0;var s=[];function a(){if(o.timeoutIdx&&(b8e.clearTimeout(o.timeoutIdx),o.timeoutIdx=void 0),!(s.length<1)){var e=s.shift();r.onClear(a),r.launch(e.msg,e.color,e.wait,0)}}o.launch=function(e,t,i,n){b8e.EngineGui&&(-1<n&&(s.length=0),s[s.length]={msg:e,color:t,wait:i,type:n},n<0&&r&&r._bg||(o.timeoutIdx&&(b8e.clearTimeout(o.timeoutIdx),o.timeoutIdx=void 0),o.timeoutIdx=b8e.setTimeout(function(){if(r=r||new o,n<0)a();else{if(s.length<1)return;var e=s.shift();r.launch(e.msg,e.color,e.wait,e.type)}})))},o.clear=function(){s.length=0,o.timeoutIdx&&(b8e.clearTimeout(o.timeoutIdx),o.timeoutIdx=void 0),r&&r.clear()},b8e.RC("$$b8e","$$Toast",e)}(),function(){var i=b8e.StringUtil=function(){};i.equalsIgnoreCase=function(e,t){return e.toLowerCase()===t.toLowerCase()},i.equals=function(e,t){return e===t},i.isNumber=function(e){return null!=e&&!isNaN(Number(e))},i.isDouble=function(e){e=i.trim(e);return null!=/^[-\+]?\d+(\.\d+)?$/.exec(e)},i.isInteger=function(e){if(null==e)return!1;e=i.trim(e);return null!=/^[-\+]?\d+$/.exec(e)},i.isEnglish=function(e){if(null==e)return!1;e=i.trim(e);return null!=/^[A-Za-z]+$/.exec(e)},i.isChinese=function(e){if(null==e)return!1;e=i.trim(e);return null!=/^[\u0391-\uFFE5]+$/.exec(e)},i.getStringByteLength=function(e){if(null==e)return 0;for(var t=0,i=e.length,n=0;n<i;n++)t+=128<e.charCodeAt(n)?2:1;return t},i.isDoubleChar=function(e){if(null==e)return!1;e=i.trim(e);return null!=/^[^\x00-\xff]+$/.exec(e)},i.hasChineseChar=function(e){if(null==e)return!1;e=i.trim(e);return null!=/[^\x00-\xff]/.exec(e)},i.isWhitespace=function(e){switch(e){case" ":case"\t":case"\r":case"\n":case"\f":return!0;default:return!1}},i.trim=function(e){return null==e?null:i.rtrim(i.ltrim(e))},i.ltrim=function(e){if(null==e)return null;return e.replace(/^\s*/,"")},i.rtrim=function(e){if(null==e)return null;return e.replace(/\s*$/,"")},i._log1024=Math.log(1024),i._sizes=["Bytes","KB","MB","GB","TB"],i.bytesToSize=function(e){if(!e&&0!==e)return"n/a";var t=Math.log(e)/i._log1024>>0;return Math.round(100*e/Math.pow(1024,t))/100+" "+i._sizes[t]},i.randomString=function(e){for(var t="";0<e--;){t+=String.fromCharCode(Math.round(20901*Math.random())+19968)}return t}}(),function(){var r=b8e.TimeUtil=function(){};r.DAY_MICRO_SECONDS=864e5,r.WEEK_MICRO_SECONDS=7*r.DAY_MICRO_SECONDS,r.MONTH_MICRO_SECONDS=31*r.DAY_MICRO_SECONDS,r.HOUR_MICRO_SECONDS=36e5,r.MINUTE_MICRO_SECONDS=6e4,r.SECOND_MICRO_SECONDS=1e3,r.formatNum=function(e,t){void 0===t&&(t=2);for(var i=String(~~e);i.length<t;)i="0"+i;return i},r.formatTime=function(e,t,i){void 0===t&&(t=":"),void 0===i&&(i=3),e<0&&(e=0),e*=.001;var n="",o=0;return o<i&&(o++,n+=r.formatNum(e/3600)),o<i&&(""!=n&&(n+=t),o++,n+=r.formatNum(e%3600/60)),o<i&&(""!=n&&(n+=t),o++,n+=r.formatNum(e%60)),n},r.formatDayTime=function(e){e<0&&(e=0);var t="",i=void 0;return e>r.DAY_MICRO_SECONDS&&(i=e/r.DAY_MICRO_SECONDS>>0,e%=r.DAY_MICRO_SECONDS,t+=i+"\u5929"),e>r.HOUR_MICRO_SECONDS&&(i=e/r.HOUR_MICRO_SECONDS>>0,e%=r.HOUR_MICRO_SECONDS,t+=i+"\u65f6"),e>r.MINUTE_MICRO_SECONDS&&(t+=(i=e/r.MINUTE_MICRO_SECONDS>>0)+"\u5206"),t},r._date=r._date?r._date:new Date,r.formatTimestamp=function(e,t,i){void 0===t&&(t="Y-M-D h:m:s");var n=r._date;return n.setTime(e),t=(t=(t=(t=(t=(t=t.replace("Y",n.getFullYear())).replace("M",i?r.formatNum(n.getMonth()+1):n.getMonth()+1)).replace("D",i?r.formatNum(n.getDate()):n.getDate())).replace("h",i?r.formatNum(n.getHours()):n.getHours())).replace("m",r.formatNum(n.getMinutes()))).replace("s",r.formatNum(n.getSeconds()))},r.getLogoutTime=function(e){return e>b8e.TimeUtil.DAY_MICRO_SECONDS?(e/b8e.TimeUtil.DAY_MICRO_SECONDS>>0)+"\u5929\u524d":e>b8e.TimeUtil.HOUR_MICRO_SECONDS?(e/b8e.TimeUtil.HOUR_MICRO_SECONDS>>0)+"\u5c0f\u65f6\u524d":e>b8e.TimeUtil.MINUTE_MICRO_SECONDS?(e/b8e.TimeUtil.MINUTE_MICRO_SECONDS>>0)+"\u5206\u949f\u524d":(e/b8e.TimeUtil.SECOND_MICRO_SECONDS>>0)+"\u79d2\u524d"},r.getTodayTime=function(e){return r.getNextDateTime(e,0)},r.getNextDateTime=function(e,t){void 0===t&&(t=1);var i=r._date;return i.setTime(e),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.getTime()+t*r.DAY_MICRO_SECONDS},r.getWeek=function(e){var t=r._date;t.setTime(e);var i=t.getDay();return r.getDayString(i)},r.getDay=function(e){var t=r._date;return t.setTime(e),t.getDay()},r.getDayString=function(e){var t="";switch(e){case 0:t="\u5468\u65e5";break;case 1:t="\u5468\u4e00";break;case 2:t="\u5468\u4e8c";break;case 3:t="\u5468\u4e09";break;case 4:t="\u5468\u56db";break;case 5:t="\u5468\u4e94";break;case 6:t="\u5468\u516d"}return t},r.dateParse=function(s,a){var c=r._date;c.setTime(b8e.startup.getServerTime());var e=[/yyyy|yy/,/MM|M/,/dd|d/,/hh|h/,/mm|m/,/ss|s/].map(function(e,t){var i=e.exec(a);if(!i)switch(t){case 0:return c.getFullYear();case 1:return c.getMonth();case 2:return c.getDate();default:return 0}var n=b8e.getFPV(i,"index"),o=b8e.getFPV(i[0],"length"),r=+s.substring(n,n+o);switch(t){case 0:if(!Math.floor(r/100))return 100*Math.floor(c.getFullYear()/100)+r;break;case 1:return r-1}return r});return c.setFullYear(e[0],e[1],e[2]),c.setHours(e[3],e[4],e[5]),c}}(),function(){var e;e=b8e.Object.extends({ctor:function(){var e=this;e._super(),e._fromPercent=0,e._toPercent=1,e._currPercent=0,e._processPercent=0},parallelism:{get:function(){return this._parallelism},set:function(e){this._parallelism=e}},isPreProcessing:{get:function(){return this._isPreProcessing}},isProcessing:{get:function(){return this._isProcessing}},isProcessed:{get:function(){return this._isProcessed}},fromPercent:{set:function(e){this._fromPercent=e}},toPercent:{set:function(e){this._toPercent=e}},group:{set:function(e){this._group=e},get:function(){return this._group}},getState:function(){return null},processPercent:{set:function(e){this._processPercent=e,this.processHandler(e)},get:function(){return this._processPercent}},processHandler:function(){},setProcessPercent:function(e,t){void 0===t&&(t=0);var i=this;if(e=1<(e=e<0?0:e)?1:e,i._currPercent=e,b8e.Tween.kill(i),!i._group||i._group.isHangUpMaster(i)){var n=i._fromPercent+(i._toPercent-i._fromPercent)*e;0<t?b8e.Tween.get(i).to({processPercent:n},t):i.processPercent=n}},switchMaster:function(){this.setProcessPercent(this._currPercent)},setOnCompleteNotify:function(e,t){this._onCompleteNotify=e,this._onCompleteThis=t},preProcess:function(e,t){this._isProcessing=!1,this._isPreProcessing=!0,this._onPreProcess=e?{onComplete:e,thisArg:t}:null,this.onPreProcess()},onPreProcess:function(){},startProcess:function(){var e=this;e._isPreProcessing=!1,e._isProcessing=!0,e.setProcessPercent(0),b8e.log(e.getState()+"\u5f00\u59cb..."),e._startTime=b8e.getTimer(),e._lostTimeRecorded=!1},stopProcess:function(){if(this._isPreProcessing){this._isPreProcessing=!1;var e=this._onPreProcess;e&&e.onComplete.call(e.thisArg)}else this.completeProcess()},recordLostTime:function(){this._lostTimeRecorded||(this._lostTimeRecorded=!0,b8e.ProcessStateMachine._recordLostTime(b8e.getTimer()-this._startTime))},completeProcess:function(){var e=this;e.setProcessPercent(1),e._onCompleteNotify&&e._onCompleteNotify.call(e._onCompleteThis,e),e._isPreProcessing=!1,e._isProcessing=!1,e._isProcessed=!0,e._parallelism=!1,e.recordLostTime(),b8e.log(e.getState()+"\u7ed3\u675f \u8017\u65f6\uff1a"+(b8e.getTimer()-e._startTime).toFixed(2)+"ms")},holdOnProcess:function(){this._holdOnNotify&&this._holdOnNotify(this)},setHoldOnNotify:function(e){this._holdOnNotify=e},dispose:function(){var e=this;e._currPercent=0,e._processPercent=0,e._group=null,e._onCompleteNotify=null,e._onCompleteThis=null,e._holdOnNotify=null,e._fromPercent=0,e._toPercent=0,e._isPreProcessing=!1,e._isProcessing=!1,e._isProcessed=!1,e._parallelism=!1,e._onPreProcess=null,b8e.Tween.kill(e)}}),b8e.RC("$$b8e","$$BaseProcess",e)}(),function(){var o=void 0;o=b8e.Object.extends({ctor:function(){var e=this;e._super(),e._preSet=[],e._fromPercent=0,e._toPercent=1,e._currPercent=0},parallelism:{get:function(){return this._parallelism},set:function(e){this._parallelism=e}},isProcessing:{get:function(){return this._isProcessing}},isProcessed:{get:function(){return this._isProcessed}},processSet:{get:function(){return this._processSet}},fromPercent:{set:function(e){this._fromPercent=e}},toPercent:{set:function(e){this._toPercent=e}},group:{set:function(e){this._group=e},get:function(){return this._group}},setHoldOnNotify:function(e){this._holdOnNotify=e},setOnCompleteNotify:function(e,t){this._onCompleteNotify=e,this._onCompleteThis=t},getState:function(){var t=[];return this._preSet.forEach(function(e){t.push(e.getState())}),t.join("|")},startProcess:function(){var t=this;if(!t._isProcessing)if(t._isProcessing=!0,t._isProcessed=!1,t.setProcessPercent(0),0<t._preSet.length){t._processSet=t._preSet.slice();var i=!1;t._preSet.slice().every(function(e){if(e.parallelism)i=!0,t._masterProcess||(t._masterProcess=e,t._masterProcess.switchMaster()),e.setOnCompleteNotify(t.onCompleteNotify,t),e.setHoldOnNotify(t.onHoldOnNotify),e.isProcessing||e.startProcess();else if(!i)return t._masterProcess=e,t._masterProcess.switchMaster(),e.setOnCompleteNotify(t.onCompleteNotify,t),e.setHoldOnNotify(t.onHoldOnNotify),e.isProcessing||e.startProcess(),!1;return!0})}else t.free(),t.completeProcess()},completeProcess:function(){var e=this;e.setProcessPercent(1),null!=e._onCompleteNotify&&e._onCompleteNotify.call(e._onCompleteThis,e),e._isProcessing=!1,e._isProcessed=!0,e._parallelism=!1},holdOnProcess:function(){null!=this._holdOnNotify&&this._holdOnNotify(this)},processHandler:function(){},setProcessPercent:function(e){var t=this;e=1<(e=(t._currPercent=e)<0?0:e)?1:e,t.processHandler(t._fromPercent+(t._toPercent-t._fromPercent)*e)},addPreGroup:function(e){-1==this._preSet.indexOf(e)?this._preSet.push(e):b8e.error(3043)},addPreProcess:function(e,t,i,n){void 0===t&&(t=0),void 0===i&&(i=1);var o=this.getProcess(e);o?-1==this._preSet.indexOf(o)?(o.fromPercent=t,o.toPercent=i,o.group=this,o.parallelism=!!n,this._preSet.push(o)):b8e.error(3044,e):b8e.error(3045,e)},onHoldOnNotify:function(e){this._masterProcess==e&&(e.parallelism||this._processSet.slice().forEach(function(e){e.parallelism&&(e.setOnCompleteNotify(this.onCompleteNotify,this),e.setHoldOnNotify(this.onHoldOnNotify),e.isProcessing||e.startProcess())},this))},onCompleteNotify:function(e){var t=this,i=t._masterProcess==e;i&&(t._masterProcess=null);var n=!e.parallelism,o=t._processSet.indexOf(e);if(-1!=o&&t._processSet.splice(o,1),e.dispose(),e=null,0<t._processSet.length){var r=!1,s=t._processSet.slice();n?s.every(function(e){var t=this;if(e.parallelism)r=!0,t._masterProcess||(t._masterProcess=e,t._masterProcess.switchMaster()),e.setOnCompleteNotify(t.onCompleteNotify,t),e.setHoldOnNotify(t.onHoldOnNotify),e.isPreProcessing||e.isProcessing||e.startProcess();else if(!r)return t._masterProcess=e,t._masterProcess.switchMaster(),e.setOnCompleteNotify(t.onCompleteNotify,t),e.setHoldOnNotify(t.onHoldOnNotify),e.isPreProcessing||e.isProcessing||e.startProcess(),!1;return!0},t):i&&(s.every(function(e){return!e.parallelism||(r=!0,this._masterProcess=e,this._masterProcess.switchMaster(),!1)},t),r||((e=s[0]).switchMaster(),e.setOnCompleteNotify(t.onCompleteNotify,t),e.setHoldOnNotify(t.onHoldOnNotify),e.isPreProcessing||e.isProcessing||e.startProcess(),t._masterProcess=e))}else t.free(),t.completeProcess()},free:function(){var e=this;e._masterProcess=null,e._preSet.length=0,e._processSet&&(e._processSet.length=0),e._isProcessing=!1},isHangUpMaster:function(e,t){return t=t||this._processSet,this.getIsHangUpMaster(e,t)},getIsHangUpMaster:function(e,t){var i=!1,n=t&&0<t.length?t[0]:null;return n&&(n==e?i=!0:n instanceof o&&(i=this.getIsHangUpMaster(e,e._processSet))),i},preProcessIsHangUp:function(e){return this.getPreProcessIsHangUp(e,this._processSet)},getPreProcessIsHangUp:function(t,e){var i=null;return e&&e.every(function(e){return e instanceof ProcessGroup?i=this.getPreProcessIsHangUp(t,e._processSet):e.getState()==t&&(i=e),!i},this),i},switchMaster:function(){this.setProcessPercent(this._currPercent)},dispose:function(){var e=this;e.free(),e._currPercent=0,e._group=null,e._onCompleteNotify=null,e._onCompleteThis=null,e._holdOnNotify=null,e._fromPercent=0,e._toPercent=0,e._isProcessing=!1,e._isProcessed=!1,e._parallelism=!1,e._preSet=null,e._processSet=null}}),b8e.RC("$$b8e","$$ProcessGroup",o)}(),function(){var e,t=e=b8e.ProcessGroup.extends({ctor:function(){this._super(),this._processDic={}},currState:{get:function(){return this._currProcess?this._currProcess.getState():null}},currProcess:{get:function(){return this._currProcess}},pushProcess:function(e){this._processDic[e.getState()]&&b8e.error(3046),this._processDic[e.getState()]=e},insertPreProcess:function(e){var t=this,i=t.getProcess(e);if(i)if(-1==t._preSet.indexOf(i)){var n=t._preSet.indexOf(t._currProcess);t._preSet.splice(n+1,0,i)}else b8e.error(3047,e);else b8e.error(3048,e)},getProcess:function(e){return this._processDic[e]},completeHangUpProcess:function(e){this._currProcess&&this._currProcess.getState()==e&&this._currProcess.completeProcess()},run:function(){var e=this;if(e._isProcessing)throw new Error("\u6d41\u7a0b\u72b6\u6001\u673a\u8fd0\u884c\u65f6\u4e0d\u53ef\u518d\u6b21\u8fd0\u884c\uff01");if(!(0<e._preSet.length))throw new Error("\u72b6\u6001\u673a\u6ca1\u6709\u53ef\u8fd0\u884c\u6d41\u7a0b\uff01");e._isProcessing=!0,e._processSet=e._preSet.slice(),e.nextProcess()},free:function(){this._super(),this._currProcess&&(this._currProcess.dispose(),this._currProcess=null)},nextProcess:function(){var e=this,t=e._preSet.indexOf(e._currProcess);e._currProcess&&(e._currProcess.dispose(),e._currProcess=null);var i=e._preSet[t+1];if(!i)throw new Error("\u6d41\u7a0b\u5f02\u5e38\uff01");e._currProcess=i,e._currProcess.setOnCompleteNotify(e.onCompleteNotify,e),e._currProcess.isProcessing||e._currProcess.startProcess()},rollback:function(){var e=this,t=e._preSet.indexOf(e._currProcess);e._currProcess&&(e._currProcess.dispose(),e._currProcess=null);var i=e._preSet[t-1];if(!i)throw new Error("\u6d41\u7a0b\u5f02\u5e38\uff01");e._currProcess=i,e._currProcess.setOnCompleteNotify(e.onCompleteNotify,e),e._currProcess.isProcessing||e._currProcess.startProcess()},gotoProcess:function(e){var t=this;t._currProcess&&(t._currProcess.dispose(),t._currProcess=null);var i=t.getProcess(e);i?(t._currProcess=i,t._currProcess.setOnCompleteNotify(t.onCompleteNotify,t),t._currProcess.isProcessing||t._currProcess.startProcess()):b8e.error(3049,e)},onCompleteNotify:function(e){var t=this;if(t._currProcess){var i=t._processSet.indexOf(e);-1!=i&&t._processSet.splice(i,1),0<t._processSet.length?t.nextProcess():(t.free(),t.completeProcess())}}}),i=0;t._recordLostTime=function(e){i+=e},t.getLostTime=function(){return i},b8e.RC("$$b8e","$$ProcessStateMachine",e)}();v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e;e=b8e.EventDispatcher.extends({ctor:function(){this._super(),b8e.startup=this,b8e.weChatEnv=b8e.getWeChatEnv(),b8e.macro.IS_RELEASE?this._title=void 0!==document.title?document.title:"":this._title="Black8 Game Studio By Sunny - \u8c03\u8bd5\u9884\u89c8"},init:function(e,t,i,n){var o=this;o._initMacro(),b8e.ready=!0,b8e.res=b8e.ResMgr.inst(),b8e.res.init(),b8e.params.localFileRoot&&b8e.res.setLocalFileRootDir(b8e.params.localFileRoot),b8e.params.remoteServerRoot&&b8e.res.setRemoteRootDir(b8e.params.remoteServerRoot),b8e.Pool.init(),b8e.designSize=t,b8e.isCocos190&&cc.director.setDisplayStats(!1),cc.view.enableRetina(!0),b8e.isMobile&&(cc.view.setOrientation(cc.macro.ORIENTATION_AUTO),cc.view.enableAutoFullScreen(!1)),(e=e||cc.Canvas.instance.node).setAnchorPoint(0,0),e.setPosition(0,0);var r=b8e.Ticker.getTicker();b8e.isCocos&&r.addPlayer({render:function(e){b8e.renderable&&e&&cc.director.mainLoop(b8e.loop.now)}}),o.setFrameRate(60),b8e.isCocos&&(b8e.isCocos190?o.setEnableAntiAlias(!0):o.setEnableAntiAlias(!1)),b8e.Texture2DAsset.init(),b8e.TextureCache.infoDetection(),i&&(o._onInited={callback:i,thisArg:n}),b8e._inited(),b8e.sound=b8e.SoundMgr.inst(),b8e.sound.init();var s=b8e.NetMgr.createMgr(b8e.NetMgr.MAIN_NAME);if(s.initSocket(b8e.Socket.TYPE_BINARY),b8e.net=s,b8e.net.sub=s.subscribe,b8e.net.req=s.request,!b8e.isCocos190){var a=new cc.Node("Main Camera"),c=a.addComponent(cc.Camera);e.addChild(a),a.setSiblingIndex(0);var l=cc.Camera.ClearFlags;c.clearFlags=l.COLOR|l.DEPTH|l.STENCIL,c.depth=-1,cc.Camera.main=c,b8e.cameraNode=a}cc.game.addPersistRootNode(e);var u=new b8e.Stage(e);b8e.stage=u;var d=new b8e.Root;b8e.root=d,u.addChild(d),b8e.layer=b8e.LayerMgr.inst(),b8e.layer.init(),b8e.SceneMgr.inst().init();var _=o;if(window.hiddenProperty){for(var h=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],f=window.hiddenProperty,g=function(e){var t=document[f];(t=t||e&&e.hidden)?_.deactivate():_.activate()},v=0;v<h.length;v++)document.addEventListener(h[v],g);g()}else window.addEventListener("blur",function(){_.deactivate()}),window.addEventListener("focus",function(){_.activate()});-1<window.navigator.userAgent.indexOf("MicroMessenger")&&(window.onfocus=function(){_.activate()}),b8e.isWeChatGame&&(wx.onShow&&wx.onShow(function(){_.activate()}),wx.onHide&&wx.onHide(function(){_.deactivate()})),window.onpageshow&&window.onpagehide&&(window.addEventListener("pagehide",function(){_.deactivate()}),window.addEventListener("pageshow",function(){_.activate()}),document.addEventListener("pagehide",function(){_.deactivate()}),document.addEventListener("pageshow",function(){_.activate()})),o.activate(),b8e.layer.showBackground(NaN,"assets/resources/splash.bti",o._checkEngineVersion,o)},_checkEngineVersion:function(){var e="\u6e38\u620f\u521d\u59cb\u5316...";if(b8e.log(e),b8e.layer.showLoading(e),"*"!==game.ENGINE_VERSION&&game.ENGINE_VERSION!==b8e.BUILD_VERSION)return e="\u6ce8\u610f\uff1aGame\u548cBlack8 Game Engine\u6784\u5efa\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nGame:V"+game.ENGINE_VERSION+" & Game Engine:V"+b8e.BUILD_VERSION,void this.inited(new Error(e));if(b8e.isCocos){if(!cc.BLACK8_COCOS_VERSION)return e="\u6ce8\u610f\uff1a\u8bf7\u4f7f\u7528\u5b9a\u5236\u5f15\u64ce\uff1aBlack8 Cocos Engine\uff01\n\u8bbe\u7f6e\uff1aCocos Creator->\u504f\u597d\u8bbe\u7f6e->\u539f\u751f\u5f00\u53d1\u73af\u5883->\u5f15\u64ce\u8def\u5f84",void this.inited(new Error(e));if("*.*.*"!==cc.BLACK8_COCOS_VERSION&&b8e.COCOS_VERSION!==cc.BLACK8_COCOS_VERSION)return e="\u6ce8\u610f\uff1aGame Engine\u548cBlack8 Cocos Engine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nGame Engine:V"+b8e.COCOS_VERSION+" & Cocos Engine:V"+cc.BLACK8_COCOS_VERSION,void this.inited(new Error(e))}!b8e.macro.IS_DESKTOP&&b8e.macro.BEFORE_UNLOAD_MSG&&(window.onbeforeunload=function(){return b8e.macro.BEFORE_UNLOAD_MSG}),this.initSettings()},_initMacro:function(){if(b8e.renderType=0,b8e.isCocos){switch(b8e.isCocos190?cc._renderType:cc.game.renderType){case cc.game.RENDER_TYPE_CANVAS:b8e.renderType=b8e.RenderType.CANVAS;break;case cc.game.RENDER_TYPE_WEBGL:b8e.renderType=b8e.RenderType.WEBGL;break;case cc.game.RENDER_TYPE_OPENGL:b8e.renderType=b8e.RenderType.OPENGL}}},initSettings:function(){if(b8e.version){var e="\u521d\u59cb\u5316\u8bbe\u7f6e...";b8e.log(e),b8e.layer.showLoading(e),b8e.res.loadSettings("assets/resources/settings_"+b8e.version+".bsd",this._onSettingsLoaded,this)}else this._initBuiltin()},_onSettingsLoaded:function(e,t){if(e){var i="\u6ce8\u610f\uff1a\u5f15\u64ce\u521d\u59cb\u5316\u9519\u8bef\uff0c\u8bbe\u7f6e\u521d\u59cb\u5316\u5931\u8d25\uff01Error:"+e.message;this.inited(new Error(i))}else b8e.params.resVersion=t.resVersion,b8e.params.versionName=t.versionName,b8e.params.debugType=t.debugType,game.API_LIST=t.apiList,b8e.params.verData=t,b8e.resVersion=b8e.params.resVersion,game.debugType=b8e.params.debugType,b8e.macro.IS_DEBUG=void 0!==game.debugType?!!game.debugType&&0<game.debugType:b8e.macro.IS_DEBUG,game.VERSION_NAME=b8e.params.versionName,game.PLATFORM_NAME=b8e.params.platformName,this._initBuiltin()},_initBuiltin:function(){var e="\u521d\u59cb\u5316\u5185\u8054...";b8e.log(e),b8e.layer.showLoading(e),b8e.res.loadBuiltin("base",this._onBuiltinLoaded,this)},_onBuiltinLoaded:function(e){if(e){var t="\u6ce8\u610f\uff1a\u5f15\u64ce\u521d\u59cb\u5316\u9519\u8bef\uff0c\u5185\u8054\u521d\u59cb\u5316\u5931\u8d25\uff01Error:"+e.message;this.inited(new Error(t))}else this.initVersion()},initVersion:function(){if(b8e.resVersion){var e="\u521d\u59cb\u5316\u7248\u672c...";b8e.log(e),b8e.layer.showLoading(e),b8e.res.loadVersionMap("version/"+b8e.resVersion+".bvc",this._onVersionLoaded,this)}else this.checkConfig()},_onVersionLoaded:function(e){if(e){var t="\u6ce8\u610f\uff1a\u5f15\u64ce\u521d\u59cb\u5316\u9519\u8bef\uff0c\u7248\u672c\u914d\u7f6e\u521d\u59cb\u5316\u5931\u8d25\uff01Error:"+e.message;this.inited(new Error(t))}else this.checkConfig()},checkConfig:function(){var i=this;if(b8e.macro.IS_PREVIEW&&!b8e.isNative){var n="\u8fdc\u7a0b\u6821\u9a8c...";b8e.log(n),b8e.layer.showLoading(n),b8e.res.checkRemote(function(e,t){if(e)n="\u6ce8\u610f\uff1a\u5f15\u64ce\u521d\u59cb\u5316\u9519\u8bef\uff0c\u8fdc\u7a0b\u6821\u9a8c\u5931\u8d25\uff01Error:"+e.message,i.inited(new Error(n));else{if(!t)return n="\u6ce8\u610f\uff1a\u8bf7\u66f4\u65b0\u7f16\u8f91\u5668\u5e76\u5207\u6362\u5de5\u4f5c\u7a7a\u95f4\u5230\u5f53\u524d\u9879\u76ee\uff01",void i.inited(new Error(n));if(t.engineVersion!==b8e.BUILD_VERSION)return n="\u6ce8\u610f\uff1a\u7f16\u8f91\u5668\u7248\u672c\u548c\u5f15\u64ce\u6784\u5efa\u7248\u672c\u4e0d\u517c\u5bb9\uff0c\u8bf7\u68c0\u67e5\u66f4\u65b0\uff01\nEditor:V"+t.engineVersion+" & Engine:V"+b8e.BUILD_VERSION,void i.inited(new Error(n));i.inited(null)}},this,function(e){n="\u8fdc\u7a0b\u6821\u9a8c\u5931\u8d25\uff01",b8e.warn(n),b8e.layer.showError(n)})}else i.inited(null)},inited:function(e){var t=this;if(b8e.inited=!0,e){var i=e.message;b8e.error(i),b8e.layer.showError(i),t.dispatchEventWith(b8e.ErrorEvent.ERROR)}else{b8e.log("\u5f15\u64ce\u521d\u59cb\u5316\u6210\u529f\uff01"),b8e.layer.hideLoading(),t.dispatchEventWith(b8e.Event.COMPLETE)}t._onInited&&t._onInited.callback.call(t._onInited.thisArg,e),b8e.macro.BENCHMARK&&bui.alert("\u5df2\u5f00\u542f\u57fa\u51c6\u68c0\u6d4b\uff0c\u4f1a\u4e25\u91cd\u5f71\u54cd\u5b9e\u9645\u6027\u80fd\uff0c\u91c7\u6837\u6570\u636e\u4ec5\u4f9b\u53c2\u8003\uff01")},isInited:function(){return!!b8e.inited},setFrameRate:function(e){var t=b8e.Ticker.getTicker(),i=60;b8e.params.isQuickGame?qg&&qg.setPreferredFramesPerSecond&&(qg.setPreferredFramesPerSecond(e),i=e):b8e.isWeChatGame?wx.setPreferredFramesPerSecond&&(wx.setPreferredFramesPerSecond(e),i=e):b8e.isRuntime&&jsb.setPreferredFramesPerSecond&&(jsb.setPreferredFramesPerSecond(e),i=e),t.setMaxFrameRate(i),t.setFrameRate(e)},activate:function(){b8e.isActivated||(b8e.isActivated=!0,b8e.ticker.resume(),b8e.sound.activate(),this._updateTitle(),b8e.isCocos&&(cc.director.startAnimation(),cc.game.emit(cc.game.EVENT_SHOW,cc.game)))},deactivate:function(){b8e.isActivated&&(b8e.isActivated=!1,b8e.ticker.pause(),b8e.sound.deactivate(),this._updateTitle(),b8e.isCocos&&(cc.director.stopAnimation(),cc.game.emit(cc.game.EVENT_HIDE,cc.game)))},_updateTitle:function(){b8e.isActivated?void 0!==document.title&&(document.title=this._title):void 0!==document.title&&(document.title=this._title+"[\u540e\u53f0]")},initMainScene:function(){var e=b8e.SceneMgr.inst().createScene("main",b8e.layer.getSceneLayer());b8e.SceneMgr.inst().activateScene("main"),e.autoCenter(!0),e.setSize(b8e.stageWidth,b8e.stageHeight),e.soundEffectsEnabled=!0,b8e.scene=e},showProfiler:function(e,t){if(!b8e.profiler){if(b8e.EngineProfiler)i();else{b8e.res.loadScript("module/profiler.bgp",function(){i()},this)}}function i(){b8e.EngineProfiler.init(),e&&e.call(t),b8e.profiler.show()}},setEnableAntiAlias:function(e){this._enableAntiAlias!=e&&(this._enableAntiAlias=e,b8e.isCocos&&cc.view.enableAntiAlias(this._enableAntiAlias))},getEnableAntiAlias:function(){return!!this._enableAntiAlias},reload:function(){b8e.isWeChatGame?this.logout():window.location&&v(window.location.reload)===b8e.TypeFunction&&window.location.reload()},logout:function(){b8e.isWeChatGame&&wx.exitMiniProgram({success:function(){},fail:function(){},complete:function(){}})},setTitle:function(e){this._title=e,this._updateTitle()},getTitle:function(){return this._title},addDummyHot:function(e){var t=this;t._dummyHot||(t._dummyPassword=e,t._hotClickCount=0,t._dummyHot=b8e.BaseDisplay.get(),t._dummyHot.setLocalZOrder(3e4),t._dummyHot.setSize(100,100),b8e.root.addChild(t._dummyHot),b8e.evt.onC(t._dummyHot,t.onClickDummyHot,t))},removeDummyHot:function(){var e=this;e._dummyHot&&(e._removeAllHotTouchPoint(),e._hotClickCount=0,b8e.evt.offC(e._dummyHot,e.onClickDummyHot,e),e._dummyHot.release(),e._dummyHot=null)},showHotTouchPoints:function(){var e=this;if(!e._hotTouchPoints){e._drawValues=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],e._drawPassValue="";var t=bui.Graphics.get();(e._touchPointBg=t).lineWidth(10),t.strokeColor(4278255360),t.setLocalZOrder(3e4),b8e.root.addChild(t),e._drawPassPoints=[],e._hotTouchPoints=[];for(var i=0,n=0,o=0;o<16;o++)i=o%4*600/4,n=600-600*(o/4>>0)/4,e._addHotTouchPoint(i,n)}},_addHotTouchPoint:function(e,t){var i=bui.Graphics.get();i.setLocalZOrder(3e4),i.setSize(50,50),i.fillColor(4278190335),i.fillCircle(25,25,25),b8e.root.addChild(i),i.setPosition(e,t);var n=this._hotTouchPoints;n[n.length]=i,b8e.evt.onC(i,this.onClickDummyHot,this)},_removeAllHotTouchPoint:function(){var t=this;t._hotTouchPoints&&(t._hotTouchPoints.forEach(function(e){b8e.evt.offC(e,t.onClickDummyHot,this),e.release()},t),t._hotTouchPoints.length=0,t._hotTouchPoints=null,t._touchPointBg.release(),t._touchPointBg=null)},onClickDummyHot:function(e){var t=this,i=e.target;if(i)if(i===t._dummyHot)t._hotClickCount++,8<=t._hotClickCount&&t.showHotTouchPoints();else if(t._hotTouchPoints){var n=i,o=t._hotTouchPoints.indexOf(n);if(-1<o)if(t._drawPassPoints.indexOf(n)<0){t._drawPassValue+=t._drawValues[o],n.clear(),n.fillColor(4278255360),n.fillCircle(25,25,25);var r=t._drawPassPoints;r[r.length]=n,t._touchPointBg.clear();for(var s=t._drawPassPoints.length,a=0;a<s;a++){var c=t._drawPassPoints[a];0==a?t._touchPointBg.moveTo(c.x+25,c.y+25):t._touchPointBg.lineTo(c.x+25,c.y+25),a==s-1&&t._touchPointBg.stroke()}b8e.log(t._drawPassValue),t._drawPassValue==t._dummyPassword&&(t.removeDummyHot(),b8e.evt.dptG("clickDummyHot"))}}},_lastReqTime:0,_lastSyncTime:0,_lastLocalTime:0,_ping:0,reqServerTime:function(){this._lastReqTime=b8e.getTimer()},fountErrorTime:!1,lastServerTime:0,setServerTime:function(e,t){var i=this;if(0<i._lastReqTime){i._lastLocalTime=b8e.getTimer();var n=i._lastLocalTime-t;i._ping=i._lastLocalTime-i._lastReqTime-n>>1;var o=e+n;!i.fountErrorTime&&e<i.lastServerTime&&(b8e.warn(3111,e,i.lastServerTime,n,t),i.fountErrorTime=!0),i.lastServerTime=e,i._lastSyncTime=o}},getServerTime:function(){var e=0;if(0==this._lastSyncTime)e=Date.now();else{var t=b8e.getTimer()-this._lastLocalTime;e=this._lastSyncTime+t}return e},getPing:function(){return this._ping}}),b8e.RC("$$b8e","$$BaseStartup",e)})(),function(){var e;e=b8e.BaseStartup.extends({ctor:function(){this._super()},init:function(e,i,n,o,t){var r=this;if(void 0===t&&(t="GameCanvas"),i=i||{width:640,height:1136,maxWidth:1e3,maxHeight:2272},e instanceof cc.Component)e=e.node,r._super(e,i,n,o);else{var s=0|+b8e.params.renderMode;b8e.isCocos190&&(s=0),cc.game.run({debugMode:b8e.macro.IS_RELEASE?0:1,noCache:!1,showFPS:!1,frameRate:60,id:t,renderMode:s,jsList:[]},function(){var e=new cc.Node,t=new cc.Scene;t.width=i.width,t.height=i.height,cc.director.runSceneImmediate(t),r.showBackground(t),t.addChild(e),r._super(e,i,n,o)})}},showBackground:function(e){if(b8e.params.isQuickGame){if(!this._background){var t=this._background=new cc.Node;t.addComponent(cc.Graphics);var i=t.getComponent(cc.Graphics);i.clear(),i.rect(0,0,1080,2340),i.fillColor=4278190080,i.fill(),t.y=-500,t.zIndex=-3e4,e.addChild(t)}}}}),b8e.RC("$$b8e","$$Startup",e)}(),b8e.VERSION="4.1.5",b8e.BUILD_VERSION="4.2.1_smart03_rc07_2020031718",b8e.COCOS_VERSION="2.7.5",game.VERSION="0.0.0";v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e=b8e.Object.extends({ctor:function(){this._viewsClass={},this._views={},this._waitInit={},this.mgrInited=!1},registerView:function(e,t){e?this._viewsClass[e]?b8e.error(4002,e):(this._viewsClass[e]=t,this.initModule(e)):b8e.error(4001)},initWait:function(){for(var e in this.mgrInited=!0,this._waitInit)this.initModule(0|+e);this._waitInit={}},initModule:function(e){var t=this;if(b8e.startup&&b8e.startup.isInited()&&t.mgrInited)if(e){var i=t._views[e];if(!i){var n=t._viewsClass[e];n&&((i=new n).moduleEnum=e,t._views[e]=i)}}else b8e.error(4005);else t._waitInit[e]=!0},showView:function(e,t){if(e){var i,n=void 0;if(i=this._views[e]){if((void 0===t?"undefined":v(t))===b8e.TypeNumber){if(!(n=this._views[t]))return void b8e.error(4022);n.addWidget(i)}else t&&t.__BaseDisplay&&(n=t).addChild(i);n||(n=b8e.LayerMgr.inst().getGuiLayer()).addChild(i)}}else b8e.error(4021)},hideView:function(e){if(e){var t=this._views[e];t&&t.__isShow&&t.removeFromParent()}else b8e.error(4023)},isShowView:function(e){if(e){var t=this._views[e];return!(!t||!t.__isShow)}b8e.error(4024)},bindView:function(e){if(e){var t=this._views[e];if(!t.__bind)if(t){var i=void 0,n=void 0,o=void 0,r=void 0,s=t.getEvts();if(s&&0<s.length)for(i=0,n=s.length;i<n;i++)if((o=s[i])&&""!==o.name){var a=o.name;(r=t[b8e.getAliasName(a)])&&(void 0===r?"undefined":v(r))===b8e.TypeFunction?(b8e.evt.onC(o,r,t),(r=this[b8e.getAliasName(a+"_ts")])&&b8e.evt.onTouchStart(o,r,t),(r=this[b8e.getAliasName(a+"_tc")])&&b8e.evt.onTouchCancel(o,r,t),b8e.evt.addButtonHandler(o)):b8e.error(4030,e,a)}else b8e.error(4029,e);t.__bind=!0}else b8e.error(4027)}else b8e.error(4025)},unbindView:function(e){if(e){var t=this._views[e];if(t)if(t.__bind){var i=void 0,n=void 0,o=void 0,r=void 0,s=t.getEvts();if(s&&0<s.length)for(i=0,n=s.length;i<n;i++)if((o=s[i])&&""!==o.name){var a=o.name;(r=t[a])&&(void 0===r?"undefined":v(r))===b8e.TypeFunction?(b8e.evt.offC(o,r,t),(r=this[a+"_ts"])&&b8e.evt.offTouchStart(o,r,t),(r=this[a+"_tc"])&&b8e.evt.offTouchCancel(o,r,t),b8e.evt.removeButtonHandler(o)):b8e.error(4037,e,a)}else b8e.error(4036,e);t.__bind=!1}else b8e.error(4035);else b8e.error(4034)}else b8e.error(4032)},getView:function(e){return this._views[e]},isInited:function(e){return!!this._views[e]}});e._inst=null,e.inst=function(){return e._inst||(e._inst=new e),e._inst},b8e.app=e.inst()})(),function(){var e=void 0;(e=b8e.Object.extends({ctor:function(){if(e._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6MgobeMgr\u5b9e\u4f8b\uff01");this._super()},initMGOBE:function(e,t,i,n){var o=this;o.gameInfo=e,o.config=t,o.initCallBack=i,o.initThisArge=n,b8e.isWeChatGame?o._startInit():b8e.res.loadScript("lib/MGOBE.js",function(e,t){b8e.info("MGOBE\u52a0\u8f7d\u5b8c\u6210"),o._startInit()},o,!0)},_startInit:function(){var t=this;t.MGOBE=b8e.getFPV(window,"MGOBE"),t.Listener=b8e.getFPV(t.MGOBE,"Listener"),t.Room=b8e.getFPV(t.MGOBE,"Room"),b8e.getFPV(t.Listener,"init")(t.gameInfo,t.config,function(e){0===e.code?(b8e.info("MGOBE\u521d\u59cb\u5316\u6210\u529f\uff1a"),t.initComplete()):b8e.error("MGOBE\u521d\u59cb\u5316\u5931\u8d25:"+e.code)})},initComplete:function(){var n=this;n.room=new n.Room,b8e.getFPV(n.Room,"getMyRoom")(function(e){if(0===e.code){var t=b8e.getFPV(e,"data"),i=b8e.getFPV(t,"roomInfo");b8e.getFPV(n.room,"initRoom")(i),b8e.info("\u73a9\u5bb6\u5df2\u5728\u623f\u95f4\u5185\uff1a",b8e.getFPV(i,"name"))}return n.initCallBack(n.initThisArge)})}}))._instance=null,e._singleton=!0,e.inst=function(){return e._instance||(e._singleton=!1,e._instance=new e,e._singleton=!0),e._instance},b8e.RC("$$b8e","$$MgobeMgr",e)}()},{}]},{},[1]);(function(){return function a(o,s,l){function _(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return _(o[t][1][e]||e)},i,i.exports,a,o,s,l)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)_(l[e]);return _}})()({1:[function(o,e,r){"use strict";b8e.RendererEnums={PROJ_PERSPECTIVE:0,PROJ_ORTHO:1,LIGHT_DIRECTIONAL:0,LIGHT_POINT:1,LIGHT_SPOT:2,SHADOW_NONE:0,SHADOW_HARD:1,SHADOW_SOFT:2,PARAM_INT:0,PARAM_INT2:1,PARAM_INT3:2,PARAM_INT4:3,PARAM_FLOAT:4,PARAM_FLOAT2:5,PARAM_FLOAT3:6,PARAM_FLOAT4:7,PARAM_COLOR3:8,PARAM_COLOR4:9,PARAM_MAT2:10,PARAM_MAT3:11,PARAM_MAT4:12,PARAM_TEXTURE_2D:13,PARAM_TEXTURE_CUBE:14,CLEAR_COLOR:1,CLEAR_DEPTH:2,CLEAR_STENCIL:4,CLEAR_SKYBOX:8,BUFFER_VIEW_INT8:0,BUFFER_VIEW_UINT8:1,BUFFER_VIEW_INT16:2,BUFFER_VIEW_UINT16:3,BUFFER_VIEW_INT32:4,BUFFER_VIEW_UINT32:5,BUFFER_VIEW_FLOAT32:6},b8e.RenderTextureEnum={FILTER_NEAREST:0,FILTER_LINEAR:1,WRAP_REPEAT:10497,WRAP_CLAMP:33071,WRAP_MIRROR:33648,TEXTURE_FMT_RGB_DXT1:0,TEXTURE_FMT_RGBA_DXT1:1,TEXTURE_FMT_RGBA_DXT3:2,TEXTURE_FMT_RGBA_DXT5:3,TEXTURE_FMT_RGB_ETC1:4,TEXTURE_FMT_RGB_PVRTC_2BPPV1:5,TEXTURE_FMT_RGBA_PVRTC_2BPPV1:6,TEXTURE_FMT_RGB_PVRTC_4BPPV1:7,TEXTURE_FMT_RGBA_PVRTC_4BPPV1:8,TEXTURE_FMT_A8:9,TEXTURE_FMT_L8:10,TEXTURE_FMT_L8_A8:11,TEXTURE_FMT_R5_G6_B5:12,TEXTURE_FMT_R5_G5_B5_A1:13,TEXTURE_FMT_R4_G4_B4_A4:14,TEXTURE_FMT_RGB8:15,TEXTURE_FMT_RGBA8:16,TEXTURE_FMT_RGB16F:17,TEXTURE_FMT_RGBA16F:18,TEXTURE_FMT_RGB32F:19,TEXTURE_FMT_RGBA32F:20,TEXTURE_FMT_R32F:21,TEXTURE_FMT_111110F:22,TEXTURE_FMT_SRGB:23,TEXTURE_FMT_SRGBA:24,TEXTURE_FMT_D16:25,TEXTURE_FMT_D32:26,TEXTURE_FMT_D24S8:27,TEXTURE_FMT_RGB_ETC2:28,TEXTURE_FMT_RGBA_ETC2:29,TEXTURE_FMT_RGBA_ASTC_4x4:30,TEXTURE_FMT_RGBA_ASTC_6x6:31,TEXTURE_FMT_RGBA_ASTC_8x8:32,TEXTURE_FMT_RGBA_ASTC_10x10:33,TEXTURE_FMT_RGBA_ASTC_12x12:34,TEXTURE_FMT_RGBA_ETC1:1024},function(){var e;e=b8e.Enum({LINEAR:9729,NEAREST:9728}),b8e.FilterIndex={9728:0,9729:1},b8e.RC("$$b8e","$$TextureFilterMode",e)}(),function(){var e;e=b8e.Enum({RGB_DXT1:0,RGBA_DXT1:1,RGBA_DXT3:2,RGBA_DXT5:3,RGB_ETC1:4,RGB_PVRTC_2BPPV1:5,RGBA_PVRTC_2BPPV1:6,RGB_PVRTC_4BPPV1:7,RGBA_PVRTC_4BPPV1:8,A8:9,L8:10,L8_A8:11,R5_G6_B5:12,R5_G5_B5_A1:13,R4_G4_B4_A4:14,RGB8:15,RGBA8:16,RGB16F:17,RGBA16F:18,RGB32F:19,RGBA32F:20,R32F:21,F111110F:22,SRGB:23,SRGBA:24,D16:25,D32:26,D24S8:27,RGB_ETC2:28,RGBA_ETC2:29,RGBA_ASTC_4x4:30,RGBA_ASTC_6x6:31,RGBA_ASTC_8x8:32,RGBA_ASTC_10x10:33,RGBA_ASTC_12x12:34,RGBA_ETC1:1024}),b8e.RC("$$b8e","$$TextureFormat",e)}(),function(){b8e.GLUtil={_infoInited:!1,_infoValueDict:null,_glExtensions:null,gatherGPUInfo:function(){var e=this;if(!e._infoInited&&(e._infoInited=!0,b8e.renderType===b8e.RenderType.WEBGL)){var t=e._infoValueDict={},r=b8e.renderer.device._gl;t.VENDOR=r.getParameter(r.VENDOR),t.RENDERER=r.getParameter(r.RENDERER),t.VERSION=r.getParameter(r.VERSION),e._glExtensions=r.getSupportedExtensions(),e._maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),t.MAX_TEXTURE_SIZE=e._maxTextureSize}},getMaxTextureSize:function(){var e=this;return e._infoInited||e.gatherGPUInfo(),e._maxTextureSize},getValue:function(e,t){var r=this;return r._infoInited||r.gatherGPUInfo(),r._infoValueDict[e]||t},getGLExtensions:function(){var e=this;return e._infoInited||e.gatherGPUInfo(),e._glExtensions},getTextureSupported:function(){for(var e=b8e.renderer.device,t=o.length,r=[],n=0;n<t;n++){var i=e.ext(o[n]);if(i)for(var a in i)r[r.length]=a+":"+i[a]}return r.join(",")}};var o=["WEBGL_compressed_texture_astc","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_etc"]}(),function(){var e=b8e.AssemblerUtils={};e.fillMeshVertices=function(e,t,r,n){for(var i=r.vertexCount,a=t.request(i,r.indiceCount),o=a.indiceOffset,s=a.byteOffset>>2,l=a.vertexOffset,_=t._vData,c=t._uintVData,u=t._iData,f=e._worldMatrix,h=f.m00,d=f.m01,p=f.m04,m=f.m05,v=f.m12,T=f.m13,b=r._data,g=0;g<i;g++){var E=b[g];_[s++]=E.x*h+E.y*p+v,_[s++]=E.x*d+E.y*m+T,_[s++]=E.u,_[s++]=E.v,c[s++]=n}for(var x=0,A=i/4;x<A;x++){var F=l+4*x;u[o++]=F,u[o++]=F+1,u[o++]=F+2,u[o++]=F+1,u[o++]=F+3,u[o++]=F+2}return a},e.fillMeshVertices3D=function(e,t,r,n){for(var i=r.vertexCount,a=t.request(i,r.indiceCount),o=a.indiceOffset,s=a.vertexOffset,l=a.byteOffset>>2,_=t._vData,c=t._uintVData,u=t._iData,f=e._worldMatrix,h=r._data,d=0;d<i;d++){var p=h[d];vec3.set(vec3_temp,p.x,p.y,0),vec3.transformMat4(vec3_temp,vec3_temp,f),_[l++]=vec3_temp.x,_[l++]=vec3_temp.y,_[l++]=vec3_temp.z,_[l++]=p.u,_[l++]=p.v,c[l++]=n}for(var m=0,v=i/4;m<v;m++){var T=s+4*m;u[o++]=T,u[o++]=T+1,u[o++]=T+2,u[o++]=T+1,u[o++]=T+3,u[o++]=T+2}return a}}(),b8e.gfx={},function(){var t=b8e.GFXEnums={USAGE_STATIC:35044,USAGE_DYNAMIC:35048,USAGE_STREAM:35040,INDEX_FMT_UINT8:5121,INDEX_FMT_UINT16:5123,INDEX_FMT_UINT32:5125,ATTR_POSITION:"a_position",ATTR_NORMAL:"a_normal",ATTR_TANGENT:"a_tangent",ATTR_BITANGENT:"a_bitangent",ATTR_WEIGHTS:"a_weights",ATTR_JOINTS:"a_joints",ATTR_COLOR:"a_color",ATTR_COLOR0:"a_color0",ATTR_COLOR1:"a_color1",ATTR_UV:"a_uv",ATTR_UV0:"a_uv0",ATTR_UV1:"a_uv1",ATTR_UV2:"a_uv2",ATTR_UV3:"a_uv3",ATTR_UV4:"a_uv4",ATTR_UV5:"a_uv5",ATTR_UV6:"a_uv6",ATTR_UV7:"a_uv7",ATTR_TYPE_INT8:5120,ATTR_TYPE_UINT8:5121,ATTR_TYPE_INT16:5122,ATTR_TYPE_UINT16:5123,ATTR_TYPE_INT32:5124,ATTR_TYPE_UINT32:5125,ATTR_TYPE_FLOAT32:5126,DS_FUNC_NEVER:512,DS_FUNC_LESS:513,DS_FUNC_EQUAL:514,DS_FUNC_LEQUAL:515,DS_FUNC_GREATER:516,DS_FUNC_NOTEQUAL:517,DS_FUNC_GEQUAL:518,DS_FUNC_ALWAYS:519,RB_FMT_RGBA4:32854,RB_FMT_RGB5_A1:32855,RB_FMT_RGB565:36194,RB_FMT_D16:33189,RB_FMT_S8:36168,RB_FMT_D24S8:34041,BLEND_FUNC_ADD:32774,BLEND_FUNC_SUBTRACT:32778,BLEND_FUNC_REVERSE_SUBTRACT:32779,BLEND_ZERO:0,BLEND_ONE:1,BLEND_SRC_COLOR:768,BLEND_ONE_MINUS_SRC_COLOR:769,BLEND_DST_COLOR:774,BLEND_ONE_MINUS_DST_COLOR:775,BLEND_SRC_ALPHA:770,BLEND_ONE_MINUS_SRC_ALPHA:771,BLEND_DST_ALPHA:772,BLEND_ONE_MINUS_DST_ALPHA:773,BLEND_CONSTANT_COLOR:32769,BLEND_ONE_MINUS_CONSTANT_COLOR:32770,BLEND_CONSTANT_ALPHA:32771,BLEND_ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_SRC_ALPHA_SATURATE:776,STENCIL_DISABLE:0,STENCIL_ENABLE:1,STENCIL_INHERIT:2,STENCIL_OP_KEEP:7680,STENCIL_OP_ZERO:0,STENCIL_OP_REPLACE:7681,STENCIL_OP_INCR:7682,STENCIL_OP_INCR_WRAP:34055,STENCIL_OP_DECR:7683,STENCIL_OP_DECR_WRAP:34056,STENCIL_OP_INVERT:5386,CULL_NONE:0,CULL_FRONT:1028,CULL_BACK:1029,CULL_FRONT_AND_BACK:1032,PT_POINTS:0,PT_LINES:1,PT_LINE_LOOP:2,PT_LINE_STRIP:3,PT_TRIANGLES:4,PT_TRIANGLE_STRIP:5,PT_TRIANGLE_FAN:6};t.attrTypeBytes=function(e){return e===t.ATTR_TYPE_INT8||e===t.ATTR_TYPE_UINT8?1:e===t.ATTR_TYPE_INT16||e===t.ATTR_TYPE_UINT16?2:e===t.ATTR_TYPE_INT32||e===t.ATTR_TYPE_UINT32||e===t.ATTR_TYPE_FLOAT32?4:(b8e.warn("Unknown ATTR_TYPE: "+e),0)},t.glFilter=function(e,t,r){null==r&&(r=-1);var n=_filterGL[t][r+1];return void 0===n?(b8e.warn("Unknown FILTER: "+t),-1===r?e.LINEAR:e.LINEAR_MIPMAP_LINEAR):n}}(),function(){var e,t=b8e.GFXEnums,r={blend:!1,blendSep:!1,blendColor:4294967295,blendEq:t.BLEND_FUNC_ADD,blendAlphaEq:t.BLEND_FUNC_ADD,blendSrc:t.BLEND_ONE,blendDst:t.BLEND_ZERO,blendSrcAlpha:t.BLEND_ONE,blendDstAlpha:t.BLEND_ZERO,depthTest:!1,depthWrite:!1,depthFunc:t.DS_FUNC_LESS,stencilTest:!1,stencilSep:!1,stencilFuncFront:t.DS_FUNC_ALWAYS,stencilRefFront:0,stencilMaskFront:255,stencilFailOpFront:t.STENCIL_OP_KEEP,stencilZFailOpFront:t.STENCIL_OP_KEEP,stencilZPassOpFront:t.STENCIL_OP_KEEP,stencilWriteMaskFront:255,stencilFuncBack:t.DS_FUNC_ALWAYS,stencilRefBack:0,stencilMaskBack:255,stencilFailOpBack:t.STENCIL_OP_KEEP,stencilZFailOpBack:t.STENCIL_OP_KEEP,stencilZPassOpBack:t.STENCIL_OP_KEEP,stencilWriteMaskBack:255,cullMode:t.CULL_BACK,primitiveType:t.PT_TRIANGLES,maxStream:-1,vertexBuffers:[],vertexBufferOffsets:[],indexBuffer:null,maxTextureSlot:-1,textureUnits:[],program:null};(e=b8e.Object.extends({ctor:function(e){var t=this;t._super(),t.vertexBuffers=new Array(e._caps.maxVertexStreams),t.vertexBufferOffsets=new Array(e._caps.maxVertexStreams),t.textureUnits=new Array(e._caps.maxTextureUnits),t.set(r)},reset:function(){this.set(r)},set:function(e){var t=this;t.blend=e.blend,t.blendSep=e.blendSep,t.blendColor=e.blendColor,t.blendEq=e.blendEq,t.blendAlphaEq=e.blendAlphaEq,t.blendSrc=e.blendSrc,t.blendDst=e.blendDst,t.blendSrcAlpha=e.blendSrcAlpha,t.blendDstAlpha=e.blendDstAlpha,t.depthTest=e.depthTest,t.depthWrite=e.depthWrite,t.depthFunc=e.depthFunc,t.stencilTest=e.stencilTest,t.stencilSep=e.stencilSep,t.stencilFuncFront=e.stencilFuncFront,t.stencilRefFront=e.stencilRefFront,t.stencilMaskFront=e.stencilMaskFront,t.stencilFailOpFront=e.stencilFailOpFront,t.stencilZFailOpFront=e.stencilZFailOpFront,t.stencilZPassOpFront=e.stencilZPassOpFront,t.stencilWriteMaskFront=e.stencilWriteMaskFront,t.stencilFuncBack=e.stencilFuncBack,t.stencilRefBack=e.stencilRefBack,t.stencilMaskBack=e.stencilMaskBack,t.stencilFailOpBack=e.stencilFailOpBack,t.stencilZFailOpBack=e.stencilZFailOpBack,t.stencilZPassOpBack=e.stencilZPassOpBack,t.stencilWriteMaskBack=e.stencilWriteMaskBack,t.cullMode=e.cullMode,t.primitiveType=e.primitiveType,t.maxStream=e.maxStream;for(var r=0;r<e.vertexBuffers.length;++r)t.vertexBuffers[r]=e.vertexBuffers[r];for(var n=0;n<e.vertexBufferOffsets.length;++n)t.vertexBufferOffsets[n]=e.vertexBufferOffsets[n];t.indexBuffer=e.indexBuffer,t.maxTextureSlot=e.maxTextureSlot;for(var i=0;i<e.textureUnits.length;++i)t.textureUnits[i]=e.textureUnits[i];t.program=e.program}})).initDefault=function(e){r.vertexBuffers=new Array(e._caps.maxVertexStreams),r.vertexBufferOffsets=new Array(e._caps.maxVertexStreams),r.textureUnits=new Array(e._caps.maxTextureUnits)},b8e.RC("$$b8e","$$GFXState",e)}(),function(){var e,a=b8e.GFXState,i=b8e.GFXEnums,f={5124:function(e,t,r){e.uniform1i(t,r)},5126:function(e,t,r){e.uniform1f(t,r)},35664:function(e,t,r){e.uniform2fv(t,r)},35665:function(e,t,r){e.uniform3fv(t,r)},35666:function(e,t,r){e.uniform4fv(t,r)},35667:function(e,t,r){e.uniform2iv(t,r)},35668:function(e,t,r){e.uniform3iv(t,r)},35669:function(e,t,r){e.uniform4iv(t,r)},35670:function(e,t,r){e.uniform1i(t,r)},35671:function(e,t,r){e.uniform2iv(t,r)},35672:function(e,t,r){e.uniform3iv(t,r)},35673:function(e,t,r){e.uniform4iv(t,r)},35674:function(e,t,r){e.uniformMatrix2fv(t,!1,r)},35675:function(e,t,r){e.uniformMatrix3fv(t,!1,r)},35676:function(e,t,r){e.uniformMatrix4fv(t,!1,r)},35678:function(e,t,r){e.uniform1i(t,r)},35680:function(e,t,r){e.uniform1i(t,r)}},h={5124:function(e,t,r){e.uniform1iv(t,r)},5126:function(e,t,r){e.uniform1fv(t,r)},35664:function(e,t,r){e.uniform2fv(t,r)},35665:function(e,t,r){e.uniform3fv(t,r)},35666:function(e,t,r){e.uniform4fv(t,r)},35667:function(e,t,r){e.uniform2iv(t,r)},35668:function(e,t,r){e.uniform3iv(t,r)},35669:function(e,t,r){e.uniform4iv(t,r)},35670:function(e,t,r){e.uniform1iv(t,r)},35671:function(e,t,r){e.uniform2iv(t,r)},35672:function(e,t,r){e.uniform3iv(t,r)},35673:function(e,t,r){e.uniform4iv(t,r)},35674:function(e,t,r){e.uniformMatrix2fv(t,!1,r)},35675:function(e,t,r){e.uniformMatrix3fv(t,!1,r)},35676:function(e,t,r){e.uniformMatrix4fv(t,!1,r)},35678:function(e,t,r){e.uniform1iv(t,r)},35680:function(e,t,r){e.uniform1iv(t,r)}};function d(e,t,r){if(t.blend!==r.blend)return r.blend?(e.enable(e.BLEND),r.blendSrc!==i.BLEND_CONSTANT_COLOR&&r.blendSrc!==i.BLEND_ONE_MINUS_CONSTANT_COLOR&&r.blendDst!==i.BLEND_CONSTANT_COLOR&&r.blendDst!==i.BLEND_ONE_MINUS_CONSTANT_COLOR||e.blendColor((r.blendColor>>24)/255,(r.blendColor>>16&255)/255,(r.blendColor>>8&255)/255,(255&r.blendColor)/255),void(r.blendSep?(e.blendFuncSeparate(r.blendSrc,r.blendDst,r.blendSrcAlpha,r.blendDstAlpha),e.blendEquationSeparate(r.blendEq,r.blendAlphaEq)):(e.blendFunc(r.blendSrc,r.blendDst),e.blendEquation(r.blendEq)))):void e.disable(e.BLEND);!1!==r.blend&&(t.blendColor!==r.blendColor&&e.blendColor((r.blendColor>>24)/255,(r.blendColor>>16&255)/255,(r.blendColor>>8&255)/255,(255&r.blendColor)/255),t.blendSep===r.blendSep?r.blendSep?(t.blendSrc===r.blendSrc&&t.blendDst===r.blendDst&&t.blendSrcAlpha===r.blendSrcAlpha&&t.blendDstAlpha===r.blendDstAlpha||e.blendFuncSeparate(r.blendSrc,r.blendDst,r.blendSrcAlpha,r.blendDstAlpha),t.blendEq===r.blendEq&&t.blendAlphaEq===r.blendAlphaEq||e.blendEquationSeparate(r.blendEq,r.blendAlphaEq)):(t.blendSrc===r.blendSrc&&t.blendDst===r.blendDst||e.blendFunc(r.blendSrc,r.blendDst),t.blendEq!==r.blendEq&&e.blendEquation(r.blendEq)):r.blendSep?(e.blendFuncSeparate(r.blendSrc,r.blendDst,r.blendSrcAlpha,r.blendDstAlpha),e.blendEquationSeparate(r.blendEq,r.blendAlphaEq)):(e.blendFunc(r.blendSrc,r.blendDst),e.blendEquation(r.blendEq)))}function p(e,t,r){if(t.depthTest!==r.depthTest)return r.depthTest?(e.enable(e.DEPTH_TEST),e.depthFunc(r.depthFunc),void e.depthMask(r.depthWrite)):void e.disable(e.DEPTH_TEST);t.depthWrite!==r.depthWrite&&e.depthMask(r.depthWrite),!1!==r.depthTest?t.depthFunc!==r.depthFunc&&e.depthFunc(r.depthFunc):r.depthWrite&&(r.depthTest=!0,r.depthFunc=i.DS_FUNC_ALWAYS,e.enable(e.DEPTH_TEST),e.depthFunc(r.depthFunc))}function m(e,t,r){return r.stencilTest!==i.STENCIL_INHERIT&&(r.stencilTest!==t.stencilTest?r.stencilTest===i.STENCIL_DISABLE?void e.disable(e.STENCIL_TEST):(e.enable(e.STENCIL_TEST),void(r.stencilSep?(e.stencilFuncSeparate(e.FRONT,r.stencilFuncFront,r.stencilRefFront,r.stencilMaskFront),e.stencilMaskSeparate(e.FRONT,r.stencilWriteMaskFront),e.stencilOpSeparate(e.FRONT,r.stencilFailOpFront,r.stencilZFailOpFront,r.stencilZPassOpFront),e.stencilFuncSeparate(e.BACK,r.stencilFuncBack,r.stencilRefBack,r.stencilMaskBack),e.stencilMaskSeparate(e.BACK,r.stencilWriteMaskBack),e.stencilOpSeparate(e.BACK,r.stencilFailOpBack,r.stencilZFailOpBack,r.stencilZPassOpBack)):(e.stencilFunc(r.stencilFuncFront,r.stencilRefFront,r.stencilMaskFront),e.stencilMask(r.stencilWriteMaskFront),e.stencilOp(r.stencilFailOpFront,r.stencilZFailOpFront,r.stencilZPassOpFront)))):void(r.stencilTest!==i.STENCIL_DISABLE&&(t.stencilSep===r.stencilSep?r.stencilSep?(t.stencilFuncFront===r.stencilFuncFront&&t.stencilRefFront===r.stencilRefFront&&t.stencilMaskFront===r.stencilMaskFront||e.stencilFuncSeparate(e.FRONT,r.stencilFuncFront,r.stencilRefFront,r.stencilMaskFront),t.stencilWriteMaskFront!==r.stencilWriteMaskFront&&e.stencilMaskSeparate(e.FRONT,r.stencilWriteMaskFront),t.stencilFailOpFront===r.stencilFailOpFront&&t.stencilZFailOpFront===r.stencilZFailOpFront&&t.stencilZPassOpFront===r.stencilZPassOpFront||e.stencilOpSeparate(e.FRONT,r.stencilFailOpFront,r.stencilZFailOpFront,r.stencilZPassOpFront),t.stencilFuncBack===r.stencilFuncBack&&t.stencilRefBack===r.stencilRefBack&&t.stencilMaskBack===r.stencilMaskBack||e.stencilFuncSeparate(e.BACK,r.stencilFuncBack,r.stencilRefBack,r.stencilMaskBack),t.stencilWriteMaskBack!==r.stencilWriteMaskBack&&e.stencilMaskSeparate(e.BACK,r.stencilWriteMaskBack),t.stencilFailOpBack===r.stencilFailOpBack&&t.stencilZFailOpBack===r.stencilZFailOpBack&&t.stencilZPassOpBack===r.stencilZPassOpBack||e.stencilOpSeparate(e.BACK,r.stencilFailOpBack,r.stencilZFailOpBack,r.stencilZPassOpBack)):(t.stencilFuncFront===r.stencilFuncFront&&t.stencilRefFront===r.stencilRefFront&&t.stencilMaskFront===r.stencilMaskFront||e.stencilFunc(r.stencilFuncFront,r.stencilRefFront,r.stencilMaskFront),t.stencilWriteMaskFront!==r.stencilWriteMaskFront&&e.stencilMask(r.stencilWriteMaskFront),t.stencilFailOpFront===r.stencilFailOpFront&&t.stencilZFailOpFront===r.stencilZFailOpFront&&t.stencilZPassOpFront===r.stencilZPassOpFront||e.stencilOp(r.stencilFailOpFront,r.stencilZFailOpFront,r.stencilZPassOpFront)):r.stencilSep?(e.stencilFuncSeparate(e.FRONT,r.stencilFuncFront,r.stencilRefFront,r.stencilMaskFront),e.stencilMaskSeparate(e.FRONT,r.stencilWriteMaskFront),e.stencilOpSeparate(e.FRONT,r.stencilFailOpFront,r.stencilZFailOpFront,r.stencilZPassOpFront),e.stencilFuncSeparate(e.BACK,r.stencilFuncBack,r.stencilRefBack,r.stencilMaskBack),e.stencilMaskSeparate(e.BACK,r.stencilWriteMaskBack),e.stencilOpSeparate(e.BACK,r.stencilFailOpBack,r.stencilZFailOpBack,r.stencilZPassOpBack)):(e.stencilFunc(r.stencilFuncFront,r.stencilRefFront,r.stencilMaskFront),e.stencilMask(r.stencilWriteMaskFront),e.stencilOp(r.stencilFailOpFront,r.stencilZFailOpFront,r.stencilZPassOpFront)))))}function v(e,t,r){t.cullMode!==r.cullMode&&(r.cullMode!==i.CULL_NONE?(e.enable(e.CULL_FACE),e.cullFace(r.cullMode)):e.disable(e.CULL_FACE))}function T(e,t,r,n){var i=!1;if(-1!==n.maxStream){if(r.maxStream!==n.maxStream)i=!0;else if(r.program!==n.program)i=!0;else for(var a=0;a<n.maxStream+1;++a)if(r.vertexBuffers[a]!==n.vertexBuffers[a]||r.vertexBufferOffsets[a]!==n.vertexBufferOffsets[a]){i=!0;break}if(i){for(var o=0;o<e._caps.maxVertexAttribs;++o)e._newAttributes[o]=0;for(var s=0;s<n.maxStream+1;++s){var l=n.vertexBuffers[s],_=n.vertexBufferOffsets[s];if(l&&-1!==l._glID){t.bindBuffer(t.ARRAY_BUFFER,l._glID);for(var c=0;c<n.program._attributes.length;++c){var u=n.program._attributes[c],f=l._format.element(u.name);f?(0===e._enabledAttributes[u.location]&&(t.enableVertexAttribArray(u.location),e._enabledAttributes[u.location]=1),e._newAttributes[u.location]=1,t.vertexAttribPointer(u.location,f.num,f.type,f.normalize,f.stride,f.offset+_*f.stride)):b8e.warn("Can not find vertex attribute: "+u.name)}}}for(var h=0;h<e._caps.maxVertexAttribs;++h)e._enabledAttributes[h]!==e._newAttributes[h]&&(t.disableVertexAttribArray(h),e._enabledAttributes[h]=0)}}}function b(e,t,r){for(var n=0;n<r.maxTextureSlot+1;++n)if(t.textureUnits[n]!==r.textureUnits[n]){var i=r.textureUnits[n];i&&-1!==i._glID&&(e.activeTexture(e.TEXTURE0+n),e.bindTexture(i._target,i._glID))}}function o(e,t,r,n){null==n&&(n=0),r instanceof b8e.RenderTexture2D?e.framebufferTexture2D(e.FRAMEBUFFER,t,e.TEXTURE_2D,r._glID,0):e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,r._glID)}e=b8e.Object.extends({ctor:function(e,t){var r=this;r._super(),b8e.gfx.device=r;var n=void 0;void 0===(t=t||{}).alpha&&(t.alpha=!1),void 0===t.stencil&&(t.stencil=!0),void 0===t.depth&&(t.depth=!0),void 0===t.antialias&&(t.antialias=!1),void 0===t.preserveDrawingBuffer&&(t.preserveDrawingBuffer=!1);try{n=e.getContext("webgl",t)}catch(e){return void b8e.error(e)}n||b8e.error("This device does not support webgl"),r._gl=n,r._extensions={},r._caps={},r._stats={texture:0,vb:0,ib:0,drawcalls:0},r._initExtensions(["EXT_texture_filter_anisotropic","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","WEBGL_draw_buffers"]),r._initCaps(),r._initStates(),a.initDefault(r),r._current=new a(r),r._next=new a(r),r._uniforms={},r._vx=r._vy=r._vw=r._vh=0,r._sx=r._sy=r._sw=r._sh=0,r._framebuffer=null,r._enabledAttributes=new Array(r._caps.maxVertexAttribs),r._newAttributes=new Array(r._caps.maxVertexAttribs);for(var i=0;i<r._caps.maxVertexAttribs;++i)r._enabledAttributes[i]=0,r._newAttributes[i]=0},_initExtensions:function(e){for(var t=this._gl,r=0;r<e.length;++r)for(var n=e[r],i=["","WEBKIT_","MOZ_"],a=0;a<i.length;a++)try{var o=t.getExtension(i[a]+n);if(o){this._extensions[n]=o;break}}catch(e){b8e.error(e)}},_initCaps:function(){var e=this,t=e._gl,r=e.ext("WEBGL_draw_buffers");e._caps.maxVertexStreams=4,e._caps.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),e._caps.maxFragUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),e._caps.maxTextureUnits=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),e._caps.maxVertexAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),e._caps.maxDrawBuffers=r?t.getParameter(r.MAX_DRAW_BUFFERS_WEBGL):1,e._caps.maxColorAttachments=r?t.getParameter(r.MAX_COLOR_ATTACHMENTS_WEBGL):1},_initStates:function(){var e=this._gl;e.disable(e.BLEND),e.blendFunc(e.ONE,e.ZERO),e.blendEquation(e.FUNC_ADD),e.blendColor(1,1,1,1),e.colorMask(!0,!0,!0,!0),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.disable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!1),e.disable(e.POLYGON_OFFSET_FILL),e.depthRange(0,1),e.disable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,0,255),e.stencilMask(255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearDepth(1),e.clearColor(0,0,0,0),e.clearStencil(0),e.disable(e.SCISSOR_TEST)},_restoreTexture:function(e){var t=this._gl,r=this._current.textureUnits[e];r&&-1!==r._glID?t.bindTexture(r._target,r._glID):t.bindTexture(t.TEXTURE_2D,null)},_restoreIndexBuffer:function(){var e=this._gl,t=this._current.indexBuffer;t&&-1!==t._glID?e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._glID):e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)},gl:{get:function(){return this._gl}},ext:function(e){return this._extensions[e]},allowFloatTexture:function(){return null!=this.ext("OES_texture_float")},setFrameBuffer:function(e){if(this._framebuffer!==e){this._framebuffer=e;var t=this._gl;if(null!==e){t.bindFramebuffer(t.FRAMEBUFFER,e._glID);for(var r=e._colors.length,n=0;n<r;++n){var i=e._colors[n];o(t,t.COLOR_ATTACHMENT0+n,i)}for(var a=r;a<this._caps.maxColorAttachments;++a)t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+a,t.TEXTURE_2D,null,0);e._depth&&o(t,t.DEPTH_ATTACHMENT,e._depth),e._stencil&&o(t,t.STENCIL_ATTACHMENT,e._stencil),e._depthStencil&&o(t,t.DEPTH_STENCIL_ATTACHMENT,e._depthStencil)}else t.bindFramebuffer(t.FRAMEBUFFER,null)}},setViewport:function(e,t,r,n){var i=this;i._vx===e&&i._vy===t&&i._vw===r&&i._vh===n||(i._gl.viewport(e,t,r,n),i._vx=e,i._vy=t,i._vw=r,i._vh=n)},setScissor:function(e,t,r,n){var i=this;i._sx===e&&i._sy===t&&i._sw===r&&i._sh===n||(i._gl.scissor(e,t,r,n),i._sx=e,i._sy=t,i._sw=r,i._sh=n)},clear:function(e){var t=this;if(void 0!==e.color||void 0!==e.depth||void 0!==e.stencil){var r=t._gl,n=0;void 0!==e.color&&(n|=r.COLOR_BUFFER_BIT,r.clearColor(e.color[0],e.color[1],e.color[2],e.color[3])),void 0!==e.depth&&(n|=r.DEPTH_BUFFER_BIT,r.clearDepth(e.depth),r.enable(r.DEPTH_TEST),r.depthMask(!0),r.depthFunc(r.ALWAYS)),void 0!==e.stencil&&(n|=r.STENCIL_BUFFER_BIT,r.clearStencil(e.stencil)),r.clear(n),void 0!==e.depth&&(!1===t._current.depthTest?r.disable(r.DEPTH_TEST):(!1===t._current.depthWrite&&r.depthMask(!1),t._current.depthFunc!==i.DS_FUNC_ALWAYS&&r.depthFunc(t._current.depthFunc)))}},enableBlend:function(){this._next.blend=!0},enableDepthTest:function(){this._next.depthTest=!0},enableDepthWrite:function(){this._next.depthWrite=!0},setStencilTest:function(e){this._next.stencilTest=e},setStencilFunc:function(e,t,r){var n=this._next;n.stencilSep=!1,n.stencilFuncFront=n.stencilFuncBack=e,n.stencilRefFront=n.stencilRefBack=t,n.stencilMaskFront=n.stencilMaskBack=r},setStencilFuncFront:function(e,t,r){var n=this._next;n.stencilSep=!0,n.stencilFuncFront=e,n.stencilRefFront=t,n.stencilMaskFront=r},setStencilFuncBack:function(e,t,r){var n=this._next;n.stencilSep=!0,n.stencilFuncBack=e,n.stencilRefBack=t,n.stencilMaskBack=r},setStencilOp:function(e,t,r,n){var i=this._next;i.stencilFailOpFront=i.stencilFailOpBack=e,i.stencilZFailOpFront=i.stencilZFailOpBack=t,i.stencilZPassOpFront=i.stencilZPassOpBack=r,i.stencilWriteMaskFront=i.stencilWriteMaskBack=n},setStencilOpFront:function(e,t,r,n){var i=this._next;i.stencilSep=!0,i.stencilFailOpFront=e,i.stencilZFailOpFront=t,i.stencilZPassOpFront=r,i.stencilWriteMaskFront=n},setStencilOpBack:function(e,t,r,n){var i=this._next;i.stencilSep=!0,i.stencilFailOpBack=e,i.stencilZFailOpBack=t,i.stencilZPassOpBack=r,i.stencilWriteMaskBack=n},setDepthFunc:function(e){this._next.depthFunc=e},setBlendColor32:function(e){this._next.blendColor=e},setBlendColor:function(e,t,r,n){this._next.blendColor=(255*e<<24|255*t<<16|255*r<<8|255*n)>>>0},setBlendFunc:function(e,t){var r=this._next;r.blendSep=!1,r.blendSrc=e,r.blendDst=t},setBlendFuncSep:function(e,t,r,n){var i=this._next;i.blendSep=!0,i.blendSrc=e,i.blendDst=t,i.blendSrcAlpha=r,i.blendDstAlpha=n},setBlendEq:function(e){var t=this._next;t.blendSep=!1,t.blendEq=e},setBlendEqSep:function(e,t){var r=this._next;r.blendSep=!0,r.blendEq=e,r.blendAlphaEq=t},setCullMode:function(e){this._next.cullMode=e},setVertexBuffer:function(e,t,r){null==r&&(r=0);var n=this._next;n.vertexBuffers[e]=t,n.vertexBufferOffsets[e]=r,n.maxStream<e&&(n.maxStream=e)},setIndexBuffer:function(e){this._next.indexBuffer=e},setProgram:function(e){this._next.program=e},setTexture:function(e,t,r){if(r>=this._caps.maxTextureUnits)b8e.warn("Can not set texture "+e+" at stage "+r+", max texture exceed: "+this._caps.maxTextureUnits);else{var n=this._next;n.textureUnits[r]=t,this.setUniform(e,r),n.maxTextureSlot<r&&(n.maxTextureSlot=r)}},setTextureArray:function(e,t,r){var n=t.length;if(n>=this._caps.maxTextureUnits)b8e.warn("Can not set "+n+" textures for "+e+", max texture exceed: "+this._caps.maxTextureUnits);else{for(var i=this._next,a=0;a<n;++a){var o=r[a];i.textureUnits[o]=t[a]}this.setUniform(e,r)}},setUniform:function(e,t){var r=this._uniforms[e],n=!1,i=!1,a=!1,o=!1;do{if(!r)break;if(a=Array.isArray(t)||t instanceof Float32Array,o=t instanceof Int32Array,i=a||o,r.isArray!==i)break;if(r.isArray&&r.value.length!==t.length)break;n=!0}while(0);if(n){var s=r.value,l=!1;if(r.isArray)for(var _=0,c=s.length;_<c;_++)s[_]!==t[_]&&(l=!0,s[_]=t[_]);else s!==t&&(l=!0,r.value=t);l&&(r.dirty=!0)}else{var u=t;a?u=new Float32Array(t):o&&(u=new Int32Array(t)),r={dirty:!0,value:u,isArray:i}}this._uniforms[e]=r},setUniformDirectly:function(e,t){var r=this._uniforms[e];r||(this._uniforms[e]=r={}),r.dirty=!0,r.value=t},setPrimitiveType:function(e){this._next.primitiveType=e},draw:function(e,t){var r=this,n=r._gl,i=r._current,a=r._next;d(n,i,a),p(n,i,a),m(n,i,a),v(n,i,a),T(this,n,i,a),i.indexBuffer!==a.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.indexBuffer&&-1!==a.indexBuffer._glID?a.indexBuffer._glID:null);var o=!1;i.program!==a.program&&(a.program._linked?n.useProgram(a.program._glID):b8e.warn("Failed to use program: has not linked yet."),o=!0),b(n,i,a);for(var s=0;s<a.program._uniforms.length;++s){var l=a.program._uniforms[s],_=r._uniforms[l.name];if(_&&(o||_.dirty)){_.dirty=!1;var c=void 0===l.size?f[l.type]:h[l.type];c?c(n,l.location,_.value):b8e.warn("Can not find commit function for uniform "+l.name)}}if(t){var u=r._next;u.indexBuffer?n.drawElements(u.primitiveType,t,u.indexBuffer._format,e*u.indexBuffer._bytesPerIndex):n.drawArrays(u.primitiveType,e,t)}r._stats.drawcalls+=1,i.set(a),a.reset()}});b8e.RC("$$b8e","$$GFXDevice",e)}(),function(){var e;(e=b8e.Object.extends({ctor:function(e,t,r,n){var i=this;i._super(),i._device=e,i._width=t,i._height=r,i._colors=n.colors||[],i._depth=n.depth||null,i._stencil=n.stencil||null,i._depthStencil=n.depthStencil||null,i._glID=e._gl.createFramebuffer()},destroy:function(){null!==this._glID?(this._device._gl.deleteFramebuffer(this._glID),this._glID=null):b8e.error("The frame-buffer already destroyed")}})).poolCall=!0,b8e.RC("$$b8e","$$GFXFrameBuffer",e)}(),function(){var e,o=b8e.GFXEnums;(e=b8e.Object.extends({ctor:function(e,t,r,n,i){var a=this;a._super(),a._device=e,a._format=t,a._usage=r,a._numIndices=i,a._bytesPerIndex=0,t===o.INDEX_FMT_UINT8?a._bytesPerIndex=1:t===o.INDEX_FMT_UINT16?a._bytesPerIndex=2:t===o.INDEX_FMT_UINT32&&(a._bytesPerIndex=4),a._bytes=a._bytesPerIndex*i,a._glID=e._gl.createBuffer(),a.update(0,n),e._stats.ib+=a._bytes},update:function(e,t){var r=this;if(-1!==r._glID)if(t&&t.byteLength+e>r._bytes)b8e.error("Failed to update data, bytes exceed.");else{var n=r._device._gl,i=r._usage;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r._glID),t?e?n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,e,t):n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,i):r._bytes?n.bufferData(n.ELEMENT_ARRAY_BUFFER,r._bytes,i):b8e.warn("bufferData should not submit 0 bytes data"),r._device._restoreIndexBuffer()}else b8e.error("The buffer is destroyed")},count:{get:function(){return this._numIndices}},destroy:function(){var e=this;-1!==e._glID?(e._device._gl.deleteBuffer(e._glID),e._device._stats.ib-=e.bytes,e._glID=-1):b8e.error("The buffer already destroyed")}})).poolCall=!0,b8e.RC("$$b8e","$$GFXIndexBuffer",e)}(),function(){var e,_=b8e.GFXEnums,t=e=b8e.Object.extends({ctor:function(e){var t=this;t._super(),t._attr2el={};for(var r=t._elements=[],n=t._bytes=0,i=e.length;n<i;++n){var a=e[n],o={name:a.name,offset:t._bytes,stride:0,stream:-1,type:a.type,num:a.num,normalize:void 0!==a.normalize&&a.normalize,bytes:a.num*_.attrTypeBytes(a.type)};t._attr2el[o.name]=o,r[r.length]=o,t._bytes+=o.bytes}for(var s=0,l=r.length;s<l;++s){r[s].stride=t._bytes}},element:function(e){return this._attr2el[e]}});t.getVfmt3D=function(){var e=t.XYZ_UV_Color;return e||((e=new t([{name:_.ATTR_POSITION,type:_.ATTR_TYPE_FLOAT32,num:3},{name:_.ATTR_UV0,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_COLOR,type:_.ATTR_TYPE_UINT8,num:4,normalize:!0}])).name="vfmt3D",t.XYZ_UV_Color=e),e},t.getVfmtPosUvColor=function(){var e=t.XY_UV_Color;return e||((e=new t([{name:_.ATTR_POSITION,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_UV0,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_COLOR,type:_.ATTR_TYPE_UINT8,num:4,normalize:!0}])).name="vfmtPosUvColor",t.XY_UV_Color=e),e},t.getVfmtPosUvTwoColor=function(){var e=t.XY_UV_Two_Color;return e||((e=new t([{name:_.ATTR_POSITION,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_UV0,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_COLOR,type:_.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:_.ATTR_COLOR0,type:_.ATTR_TYPE_UINT8,num:4,normalize:!0}])).name="vfmtPosUvTwoColor",t.XY_UV_Two_Color=e),e},t.getVfmtPosUv=function(){var e=t;return e||((e=new t([{name:_.ATTR_POSITION,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_UV0,type:_.ATTR_TYPE_FLOAT32,num:2}])).name="vfmtPosUv",t.XY_UV=e),e},t.getVfmtPosColor=function(){var e=t.XY_Color;return e||((e=new t([{name:_.ATTR_POSITION,type:_.ATTR_TYPE_FLOAT32,num:2},{name:_.ATTR_COLOR,type:_.ATTR_TYPE_UINT8,num:4,normalize:!0}])).name="vfmtPosColor",t.XY_Color=e),e},t.getVfmtPos=function(){var e=t.XY;return e||((e=new t([{name:_.ATTR_POSITION,type:_.ATTR_TYPE_FLOAT32,num:2}])).name="vfmtPos",t.XY=e),e},b8e.RC("$$b8e","$$GFXVertexFormat",e)}(),function(){var e;b8e.GFXEnums;(e=b8e.Object.extends({ctor:function(e,t,r,n,i){var a=this;a._super(),a._device=e,a._format=t,a._usage=r,a._numVertices=i,a._bytes=a._format._bytes*i,a._glID=e._gl.createBuffer(),a.update(0,n),e._stats.vb+=a._bytes},update:function(e,t){var r=this;if(-1!==r._glID)if(t&&t.byteLength+e>r._bytes)b8e.error("Failed to update data, bytes exceed.");else{var n=r._device._gl,i=r._usage;n.bindBuffer(n.ARRAY_BUFFER,r._glID),t?e?n.bufferSubData(n.ARRAY_BUFFER,e,t):n.bufferData(n.ARRAY_BUFFER,t,i):r._bytes?n.bufferData(n.ARRAY_BUFFER,r._bytes,i):b8e.warn("bufferData should not submit 0 bytes data"),n.bindBuffer(n.ARRAY_BUFFER,null)}else b8e.error("The buffer is destroyed")},count:{get:function(){return this._numVertices}},destroy:function(){var e=this;-1!==e._glID?(e._device._gl.deleteBuffer(e._glID),e._device._stats.vb-=e.bytes,e._glID=-1):b8e.error("The buffer already destroyed")}})).poolCall=!0,b8e.RC("$$b8e","$$GFXVertexBuffer",e)}(),function(){var e;(e=b8e.Object.extends({ctor:function(e,t,r,n){var i=this;i._super(),i._device=e,i._format=t,i._glID=e._gl.createRenderbuffer(),i.update(r,n)},update:function(e,t){var r=this;r._width=e,r._height=t;var n=r._device._gl;n.bindRenderbuffer(n.RENDERBUFFER,r._glID),n.renderbufferStorage(n.RENDERBUFFER,r._format,e,t),n.bindRenderbuffer(n.RENDERBUFFER,null)},destroy:function(){if(null!==this._glID){var e=this._device._gl;e.bindRenderbuffer(e.RENDERBUFFER,null),e.deleteRenderbuffer(this._glID),this._glID=null}else b8e.error("The render-buffer already destroyed")}})).poolCall=!0,b8e.RC("$$b8e","$$GFXRenderBuffer",e)}(),function(){var e,n=0;function g(r,n,e){e.split("\n").forEach(function(e){if(!(e.length<5)){var t=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);t?r[r.length]={type:n,fileID:0|t[1],line:0|t[2],message:t[3].trim()}:0<e.length&&(r[r.length]={type:n,fileID:-1,line:0,message:e})}})}e=b8e.Object.extends({ctor:function(e,t){var r=this;r._super(),r._device=e,r._attributes=[],r._uniforms=[],r._samplers=[],r._errors=[],r._linked=!1,r._vertSource=t.vert,r._fragSource=t.frag,r._glID=null,r._id=n++},id:{get:function(){return this._id}},link:function(){var e=this;if(!e._linked){var t=e._device._gl,r=E(t,t.VERTEX_SHADER,e._vertSource),n=E(t,t.FRAGMENT_SHADER,e._fragSource),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n),t.linkProgram(i);var a=!1,o=e._errors;if(t.getShaderParameter(r,t.COMPILE_STATUS)||(g(o,"vs",t.getShaderInfoLog(r)),a=!0),t.getShaderParameter(n,t.COMPILE_STATUS)||(g(o,"fs",t.getShaderInfoLog(n)),a=!0),t.deleteShader(r),t.deleteShader(n),a)return o;if(!t.getProgramParameter(i,t.LINK_STATUS))return o[o.length]={info:"Failed to link shader program: "+t.getProgramInfoLog(i)},o;e._glID=i;for(var s=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES),l=0;l<s;++l){var _=t.getActiveAttrib(i,l),c=t.getAttribLocation(i,_.name),u=e._attributes;u[u.length]={name:_.name,location:c,type:_.type}}for(var f=t.getProgramParameter(i,t.ACTIVE_UNIFORMS),h=0;h<f;++h){var d=t.getActiveUniform(i,h),p=d.name,m=t.getUniformLocation(i,p),v="[0]"===p.substr(p.length-3);v&&(p=p.substr(0,p.length-3));var T={name:p,location:m,type:d.type,size:v?d.size:void 0},b=e._uniforms;b[b.length]=T}e._linked=!0}},destroy:function(){var e=this;e._device._gl.deleteProgram(e._glID),e._linked=!1,e._glID=null,e._attributes=[],e._uniforms=[],e._samplers=[]}});function E(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}b8e.RC("$$b8e","$$GFXProgram",e)}(),function(){var e,r=cc.geomUtils;(e=b8e.Object.extends({ctor:function(){this._super(),this._type="default",this._poolID=-1,this._node=null,this._inputAssembler=null,this._effect=null,this._viewID=-1,this._cameraID=-1,this._userKey=-1,this._castShadow=!1,this._boundingShape=null,this._defines=[],this._uniforms=[]},_updateTransform:function(){this._node._hasChanged&&this._boundingShape&&(this._node.updateWorldTransformFull(),this._bsModelSpace.transform(this._node._mat,this._node._pos,this._node._rot,this._node._scale,this._boundingShape))},createBoundingShape:function(e,t){r&&e&&t&&(this._bsModelSpace=r.Aabb.fromPoints(r.Aabb.create(),e,t),this._boundingShape=r.Aabb.clone(this._bsModelSpace))},setNode:function(e){this._node=e},setInputAssembler:function(e){this._inputAssembler=e},setEffect:function(e,t){this._effect=e;var r=this._defines,n=this._uniforms;r.length=0,n.length=0,e&&(r[r.length]=e._defines,n[n.length]=e._propertyList),t&&(r[r.length]=t._defines,n[n.length]=t._propertyList)},setUserKey:function(e){this._userKey=e},extractDrawItem:function(e){e.model=this,e.node=this._node,e.ia=this._inputAssembler,e.effect=this._effect,e.defines=this._defines,e.dependencies=this._dependencies,e.uniforms=this._uniforms}})).poolCall=!0,b8e.RC("$$b8e","$$RenderModel",e)}(),function(){var e,r=b8e.FixedArray;e=b8e.Object.extends({ctor:function(e){var t=this;t._super(),t._lights=new r(16),t._models=new r(16),t._cameras=new r(16),t._debugCamera=null,t._app=e,t._views=[]},_add:function(e,t){-1===t._poolID&&(e.push(t),t._poolID=e.length-1)},_remove:function(e,t){-1!==t._poolID&&(e.data[e.length-1]._poolID=t._poolID,e.fastRemove(t._poolID),t._poolID=-1)},tick:function(){for(var e=0;e<this._models.length;++e){this._models.data[e]._updateTransform()}},reset:function(){for(var e=0;e<this._models.length;++e){this._models.data[e]._viewID=-1}},setDebugCamera:function(e){this._debugCamera=e},getCameraCount:function(){return this._cameras.length},getCamera:function(e){return this._cameras.data[e]},addCamera:function(e){this._add(this._cameras,e)},removeCamera:function(e){this._remove(this._cameras,e)},getModelCount:function(){return this._models.length},getModel:function(e){return this._models.data[e]},addModel:function(e){this._add(this._models,e)},removeModel:function(e){this._remove(this._models,e)},getLightCount:function(){return this._lights.length},getLight:function(e){return this._lights.data[e]},addLight:function(e){this._add(this._lights,e)},removeLight:function(e){this._remove(this._lights,e)},addView:function(e){-1===this._views.indexOf(e)&&this._views.push(e)},removeView:function(e){var t=this._views.indexOf(e);-1!==t&&this._views.splice(t,1)}});b8e.RC("$$b8e","$$RenderScene",e)}(),function(){var e;(e=b8e.Object.extends({ctor:function(e,t){var r=this;r._super(),r.byteStart=0,r.byteOffset=0,r.indiceStart=0,r.indiceOffset=0,r.vertexStart=0,r.vertexOffset=0,r._vertexFormat=t,r._vertexBytes=r._vertexFormat._bytes,r._arrOffset=0,r._vbArr=[],r._vb=new b8e.GFXVertexBuffer(e._device,t,b8e.GFXEnums.USAGE_DYNAMIC,new ArrayBuffer,0),r._vbArr[0]=r._vb,r._ibArr=[],r._ib=new b8e.GFXIndexBuffer(e._device,b8e.GFXEnums.INDEX_FMT_UINT16,b8e.GFXEnums.USAGE_STATIC,new ArrayBuffer,0),r._ibArr[0]=r._ib,r._vData=null,r._uintVData=null,r._iData=null,r._batcher=e,r._initVDataCount=256*t._bytes,r._initIDataCount=1536,r._offsetInfo={byteOffset:0,vertexOffset:0,indiceOffset:0},r._reallocBuffer()},uploadData:function(){if(0!==this.byteOffset&&this._dirty){var e=new Float32Array(this._vData.buffer,0,this.byteOffset>>2),t=new Uint16Array(this._iData.buffer,0,this.indiceOffset);this._vb.update(0,e),this._ib.update(0,t),this._dirty=!1}},switchBuffer:function(){var e=++this._arrOffset;this.byteStart=0,this.byteOffset=0,this.vertexStart=0,this.vertexOffset=0,this.indiceStart=0,this.indiceOffset=0,e<this._vbArr.length?(this._vb=this._vbArr[e],this._ib=this._ibArr[e]):(this._vb=new b8e.GFXVertexBuffer(this._batcher._device,this._vertexFormat,b8e.GFXEnums.USAGE_DYNAMIC,new ArrayBuffer,0),this._vbArr[e]=this._vb,this._vb._bytes=this._vData.byteLength,this._ib=new b8e.GFXIndexBuffer(this._batcher._device,b8e.GFXEnums.INDEX_FMT_UINT16,b8e.GFXEnums.USAGE_STATIC,new ArrayBuffer,0),this._ibArr[e]=this._ib,this._ib._bytes=this._iData.byteLength)},checkAndSwitchBuffer:function(e){65535<this.vertexOffset+e&&(this.uploadData(),this._batcher._flush(),this.switchBuffer())},requestStatic:function(e,t){this.checkAndSwitchBuffer(e);var r=this.byteOffset+e*this._vertexBytes,n=this.indiceOffset+t,i=this._vData.byteLength,a=this._iData.length;if(i<r||a<n){for(;i<r||a<n;)this._initVDataCount*=2,this._initIDataCount*=2,i=4*this._initVDataCount,a=this._initIDataCount;this._reallocBuffer()}var o=this._offsetInfo;o.vertexOffset=this.vertexOffset,this.vertexOffset+=e,o.indiceOffset=this.indiceOffset,this.indiceOffset+=t,o.byteOffset=this.byteOffset,this.byteOffset=r,this._dirty=!0},request:function(e,t){return this._batcher._buffer!==this&&(this._batcher._flush(),this._batcher._buffer=this),this.requestStatic(e,t),this._offsetInfo},_reallocBuffer:function(){this._reallocVData(!0),this._reallocIData(!0)},_reallocVData:function(e){var t=void 0;this._vData&&(t=new Uint8Array(this._vData.buffer)),this._vData=new Float32Array(this._initVDataCount),this._uintVData=new Uint32Array(this._vData.buffer);var r=new Uint8Array(this._uintVData.buffer);if(t&&e)for(var n=0,i=t.length;n<i;n++)r[n]=t[n];this._vb._bytes=this._vData.byteLength},_reallocIData:function(e){var t=this._iData;if(this._iData=new Uint16Array(this._initIDataCount),t&&e)for(var r=this._iData,n=0,i=t.length;n<i;n++)r[n]=t[n];this._ib._bytes=this._iData.byteLength},reset:function(){this._arrOffset=0,this._vb=this._vbArr[0],this._ib=this._ibArr[0],this.byteStart=0,this.byteOffset=0,this.indiceStart=0,this.indiceOffset=0,this.vertexStart=0,this.vertexOffset=0,this._dirty=!1},destroy:function(){for(var e=0;e<this._vbArr.length;e++){this._vbArr[e].destroy()}this._vbArr=null;for(var t=0;t<this._ibArr.length;t++){this._ibArr[t].destroy()}this._ibArr=null,this._ib=null,this._vb=null}})).poolCall=!0,b8e.RC("$$b8e","$$MeshBuffer",e)}(),function(){var e;e=b8e.MeshBuffer.extends({ctor:function(e,t){this._super(e,t)},_fillQuadBuffer:function(){for(var e=this._initIDataCount/6,t=this._iData,r=0,n=0;r<e;r++){var i=4*r;t[n++]=i,t[n++]=1+i,t[n++]=2+i,t[n++]=1+i,t[n++]=3+i,t[n++]=2+i}var a=new Uint16Array(this._iData.buffer,0,6*e);this._ib.update(0,a)},uploadData:function(){if(0!==this.byteOffset&&this._dirty){var e=new Float32Array(this._vData.buffer,0,this.byteOffset>>2);this._vb.update(0,e),this._dirty=!1}},switchBuffer:function(){if(this._super(),0<this.indiceOffset){var e=new Uint16Array(this._iData.buffer,0,this.indiceOffset);this._ib.update(0,e)}},_reallocBuffer:function(){this._reallocVData(!0),this._reallocIData(),this._fillQuadBuffer()}});b8e.RC("$$b8e","$$QuadBuffer",e)}(),function(){var e;function t(e){this.id=0|998*Math.random(),this.prefix=e?e+".":""}t.prototype.getNewId=function(){return this.prefix+ ++this.id};var i=new t("VertextFormat"),a=b8e.Object.extends({ctor:function(e,t,r){var n=this;n._super(),null==r&&(r=b8e.GFXEnums.PT_TRIANGLES),n._vertexBuffer=e,n._indexBuffer=t,n._primitiveType=r,n._start=0,n._count=-1},count:{get:function(){return-1!==this._count?this._count:this._indexBuffer?this._indexBuffer.count:this._vertexBuffer.count}}});a.poolCall=!0;var o=b8e.RecyclePool,s=b8e.RenderModel,l=null,_=null,r=e=b8e.Object.extends({ctor:function(e,t){var r=this;r._super(),l=l||new b8e.Material,r._renderScene=t,r._device=e,r._buffers=b8e.HashMap.get(),r.walking=!1,r.material=l,r.cullingMask=1,r._iaPool=new o(function(){return new a},16),r._modelPool=new o(function(){return new s},16);var n=b8e.GFXVertexFormat.getVfmtPosUvColor(),i=b8e.GFXVertexFormat.getVfmt3D();r._quadBuffer=r.getBuffer("quad",n),r._meshBuffer=r.getBuffer("mesh",n),r._quadBuffer3D=r.getBuffer("quad",i),r._meshBuffer3D=r.getBuffer("mesh",i),r._buffer=r._quadBuffer,r._batchedModels=[],r._dummyNode=new cc.Node,r._sortKey=0,r.node=r._dummyNode,r.parentOpacity=1,r.parentOpacityDirty=0,r.worldMatDirty=0,r.customProperties=null},reset:function(){var e=this;e._iaPool.reset(),c=0;for(var t=e._renderScene,r=e._batchedModels,n=r.length,i=0;i<n;++i){var a=r[i];a.setInputAssembler(null),a.setEffect(null),t.removeModel(a)}e._modelPool.reset(),r.length=0,e._sortKey=0,e._buffers.forEach(e._onResetBuffer,e),e._buffer=e._quadBuffer,e.node=e._dummyNode,e.material=l,e.cullingMask=1,e.parentOpacity=1,e.parentOpacityDirty=0,e.worldMatDirty=0,e.customProperties=null},_onResetBuffer:function(e,t){t.reset()},_flushMaterial:function(e){c++;var t=(this.material=e).effect;if(t){_||((_=new a)._count=0);var r=this._modelPool.add(),n=this._batchedModels;(n[n.length]=r).sortKey=this._sortKey++,r._cullingMask=this.cullingMask,r.setNode(this.node),r.setEffect(t,null),r.setInputAssembler(_),this._renderScene.addModel(r)}},_flush:function(){var e=this.material,t=this._buffer,r=t.indiceStart,n=t.indiceOffset-r;if(this.walking&&e&&!(n<=0)){var i=e.effect;if(i){var a=this._iaPool.add();a._vertexBuffer=t._vb,a._indexBuffer=t._ib,a._start=r,a._count=n;var o=this._modelPool.add(),s=this._batchedModels;(s[s.length]=o).sortKey=this._sortKey++,o._cullingMask=this.cullingMask,o.setNode(this.node),o.setEffect(i,this.customProperties),o.setInputAssembler(a),this._renderScene.addModel(o),t.byteStart=t.byteOffset,t.indiceStart=t.indiceOffset,t.vertexStart=t.vertexOffset}}},_flushIA:function(e){var t=e.material;if(e.ia&&t){c++;var r=(this.material=t).effect;if(r){var n=this._modelPool.add(),i=this._batchedModels;(i[i.length]=n).sortKey=this._sortKey++,n._cullingMask=this.cullingMask,n.setNode(this.node),n.setEffect(r,this.customProperties),n.setInputAssembler(e.ia),this._renderScene.addModel(n)}}},_commitComp:function(e,t,r){var n=e.sharedMaterials[0];(n&&n.getHash()!==this.material.getHash()||this.cullingMask!==r)&&(this._flush(),this.node=n.useModel?e.node:this._dummyNode,c++,this.material=n,this.cullingMask=r),t.fillBuffers(e,this)},_commitIA:function(e,t,r){this._flush(),this.cullingMask=r,c++,this.material=e.sharedMaterials[0]||l,this.node=this.material.useModel?e.node:this._dummyNode,t.renderIA(e,this)},terminate:function(){cc.dynamicAtlasManager&&cc.dynamicAtlasManager.enabled&&cc.dynamicAtlasManager.update(),this._flush(),this._buffers.forEach(this._onBufferUploadData,this)},_onBufferUploadData:function(e,t){t.uploadData()},getBuffer:function(e,t){t.name||(t.name=i.getNewId());var r=e+t.name,n=this._buffers.get(r);if(!n){if("mesh"===e)n=new b8e.MeshBuffer(this,t);else if("quad"===e)n=new b8e.QuadBuffer(this,t);else{if("spine"!==e)return b8e.error("Not support buffer type ["+e+"]"),null;n=new b8e.SpineBuffer(this,t)}this._buffers.set(r,n)}return n}}),c=0;r.getMaterialSwitchCount=function(){return c},b8e.RC("$$b8e","$$ModelBatcher",e)}(),function(){var e;e=b8e.Object.extends({_redMultiplier:1,_greenMultiplier:1,_blueMultiplier:1,_alphaMultiplier:1,_redOffset:0,_greenOffset:0,_blueOffset:0,_alphaOffset:0,_key:null,isGray:!1,ctor:function(e){this._super(),this.setData(e)},setData:function(e){if(e&&!(e.length<8)){var t=this;t._key=null,t._redMultiplier=e[0],t._greenMultiplier=e[1],t._blueMultiplier=e[2],t._alphaMultiplier=e[3],t._redOffset=e[4],t._greenOffset=e[5],t._blueOffset=e[6],t._alphaOffset=e[7]}},getData:function(){var e=this;return[e._redMultiplier,e._greenMultiplier,e._blueMultiplier,e._alphaMultiplier,e._redOffset,e._greenOffset,e._blueOffset,e._alphaOffset]},setMultiplier:function(e){if(e&&4==e.length){var t=this;t._key=null,t._redMultiplier=e[0],t._greenMultiplier=e[1],t._blueMultiplier=e[2],t._alphaMultiplier=e[3]}},setOffset:function(e){if(e&&4==e.length){this._redOffset=e[0],this._greenOffset=e[1],this._blueOffset=e[2],this._alphaOffset=e[3]}},getMultiplierArray:function(){return[this._redMultiplier,this._greenMultiplier,this._blueMultiplier,this._alphaMultiplier]},getOffsetArray:function(){return[this._redOffset,this._greenOffset,this._blueOffset,this._alphaOffset]},equals:function(e){var t=this;return t._redMultiplier==e._redMultiplier&&t._greenMultiplier==e._greenMultiplier&&t._blueMultiplier==e._blueMultiplier&&t._alphaMultiplier==e._alphaMultiplier&&t._redOffset==e._redOffset&&t._greenOffset==e._greenOffset&&t._blueOffset==e._blueOffset&&t._alphaOffset==e._alphaOffset},toString:function(){var e=this;return e._key||(e._key=e._redMultiplier+"_"+e._greenMultiplier+"_"+e._blueMultiplier+"_"+e._alphaMultiplier+"_"+e._redOffset+"_"+e._greenOffset+"_"+e._blueOffset+"_"+e._alphaOffset),e._key},clear:function(){var e=this;e._key=null,e._redMultiplier=1,e._greenMultiplier=1,e._blueMultiplier=1,e._alphaMultiplier=1,e._redOffset=0,e._greenOffset=0,e._blueOffset=0,e._alphaOffset=0,e.isGray=!1}}),b8e.RC("$$b8e","$$ColorTransfrom",e)}(),function(){function l(){var e=this;e._u=0,e._v=0,e._width=0,e._height=0,e._offsetX=0,e._offsetY=0,e._textureID=0,e._validDefinition=!1,e._xAdvance=0}function e(e){this._letterDefinitions={},this._lineHeight=e.commonHeight,this._fontSize=e.fontSize,this._fntConfig=e}var t;(cc.FontAtlas=e).prototype={constructor:e,addLetterDefinitions:function(e,t){this._letterDefinitions[e]=t},cloneLetterDefinition:function(){var e={};for(var t in this._letterDefinitions){var r=new l;cc.js.mixin(r,this._letterDefinitions[t]),e[t]=r}return e},assignLetterDefinitions:function(e){for(var t in this._letterDefinitions){var r=e[t],n=this._letterDefinitions[t];cc.js.mixin(n,r)}},scaleFontLetterDefinition:function(e){for(var t in this._letterDefinitions){var r=this._letterDefinitions[t];r._width*=e,r._height*=e,r._offsetX*=e,r._offsetY*=e,r._xAdvance*=e}},getLetterDefinitionForChar:function(e){return this._letterDefinitions.hasOwnProperty(e.charCodeAt(0))?this._letterDefinitions[e.charCodeAt(0)]:null}};function o(){var e=this;e._char="",e._valid=!0,e._positionX=0,e._positionY=0,e._lineIndex=0}var F=cc.rect(),y=null,R=[],S=[],D=[],C=[],n=cc.size(),w=null,P=null,B=0,L=0,O=0,M=0,I=0,N=1,U=null,k="",_=0,c=0,G=cc.size(),u=0,f=0,X=0,V=0,W=0,H=!1,Y=0,$=0,z=0;t=b8e.Object.extends({ctor:function(){this._super()},updateRenderData:function(e){e._renderData.vertDirty&&y!==e&&(y=e,this._updateProperties(),this._updateContent(),y._actualFontSize=_,y.node.setContentSize(G),y._renderData.vertDirty=y._renderData.uvDirty=!1,y=null,this._resetProperties())},_updateFontScale:function(){N=_/c},_updateProperties:function(){var e=y.font;if(U=e.spriteFrame,P=e._fntConfig,!(w=y._fontAtlas)){w=new cc.FontAtlas(P);var t=P.fontDefDictionary;for(var r in t){var n=new l,i=t[r],a=i.rect;n._offsetX=i.xOffset,n._offsetY=i.yOffset,n._width=a.width,n._height=a.height,n._u=a.x,n._v=a.y,n._textureID=0,n._validDefinition=!0,n._xAdvance=i.xAdvance;var o=b8e.getOriginName(r);w.addLetterDefinitions(o,n)}y._fontAtlas=w}k=y.string.toString(),_=y.fontSize,c=P.fontSize,G.width=y.node._contentSize.width,G.height=y.node._contentSize.height,u=y.horizontalAlign,f=y.verticalAlign,X=y.spacingX,W=y.overflow,V=y._lineHeight;var s=cc.Label.Overflow;H=W!==s.NONE&&(W===s.RESIZE_HEIGHT||y.enableWrapText),this._setupBMFontOverflowMetrics()},_resetProperties:function(){U=P=w=null},_updateContent:function(){this._updateFontScale(),this._computeHorizontalKerningForText(),this._alignText()},_computeHorizontalKerningForText:function(){for(var e=k,t=e.length,r=P.kerningDict,n=R,i=-1,a=0;a<t;++a){var o=e.charCodeAt(a),s=r[i<<16|65535&o]||0;n[a]=a<t-1?s:0,i=o}},_multilineTextWrap:function(e){var t=this,r=cc.textUtils,n=k.length,i=0,a=0,o=0,s=0,l=0,_=0,c=0,u=null,f=cc.v2(0,0);t._updateFontScale();for(var h=w._letterDefinitions,d=0;d<n;){var p=k.charAt(d);if("\n"!==p){for(var m=e.call(t,k,d,n),v=_,T=c,b=l,g=a,E=!1,x=0;x<m;++x){var A=d+x;if("\r"!==(p=k.charAt(A)))if(u=w.getLetterDefinitionForChar(p)){var F=g+u._offsetX*N;if(H&&0<z&&0<a&&F+u._width*N>z&&!r.isUnicodeSpace(p)){D[D.length]=l,i++,o-=V*N+(a=l=0),E=!0;break}f.x=F,f.y=o-u._offsetY*N,t._recordLetterInfo(h,f,p,A,i),A+1<R.length&&A<n-1&&(g+=R[A+1]),g+=u._xAdvance*N+X,b=f.x+u._width*N,v<f.y&&(v=f.y),T>f.y-u._height*N&&(T=f.y-u._height*N)}else t._recordPlaceholderInfo(A,p),b8e.warn(5002,P.atlasName,p);else t._recordPlaceholderInfo(A,p)}E||(a=g,_<v&&(_=v),T<c&&(c=T),s<(l=b)&&(s=l),d+=m)}else D[D.length]=l,i++,o-=V*N+(a=l=0),t._recordPlaceholderInfo(d,p),d++}return D[D.length]=l,L=(B=i+1)*V*N,1<B&&(L+=0*(B-1)),G.width=Y,G.height=$,Y<=0&&(G.width=parseFloat(s.toFixed(2))),$<=0&&(G.height=parseFloat(L.toFixed(2))),M=G.height,(I=0)<_&&(M=G.height+_),c<-L&&(I=L+c),!0},_getFirstCharLen:function(){return 1},_getFirstWordLen:function(e,t,r){var n=cc.textUtils,i=e.charAt(t);if(n.isUnicodeCJK(i)||"\n"===i||n.isUnicodeSpace(i))return 1;var a=1,o=w.getLetterDefinitionForChar(i);if(!o)return a;for(var s=o._xAdvance*N+X,l=t+1;l<r&&(i=e.charAt(l),o=w.getLetterDefinitionForChar(i));++l){if(s+o._offsetX*N+o._width*N>z&&!n.isUnicodeSpace(i)&&0<z)return a;if(s+=o._xAdvance*N+X,"\n"===i||n.isUnicodeSpace(i)||n.isUnicodeCJK(i))break;a++}return a},_multilineTextWrapByWord:function(){return this._multilineTextWrap(this._getFirstWordLen)},_multilineTextWrapByChar:function(){return this._multilineTextWrap(this._getFirstCharLen)},_recordPlaceholderInfo:function(e,t){if(e>=S.length){var r=new o;S[S.length]=r}S[e]._char=t,S[e]._valid=!1},_recordLetterInfo:function(e,t,r,n,i){if(n>=S.length){var a=new o;S[S.length]=a}r=r.charCodeAt(0),S[n]._lineIndex=i,S[n]._char=r,S[n]._valid=e[r]._validDefinition,S[n]._positionX=t.x,S[n]._positionY=t.y},_alignText:function(){var e=this;L=0,D.length=0,e._multilineTextWrapByWord(),e._computeAlignmentOffset();var t=cc.Label.Overflow;W===t.SHRINK&&0<_&&e._isVerticalClamp()&&e._shrinkLabelToContentSize(e._isVerticalClamp),e._updateQuads()||W===t.SHRINK&&e._shrinkLabelToContentSize(e._isHorizontalClamp)},_scaleFontSizeDown:function(e){var t=!0;e||(t=!(e=.1)),_=e,t&&this._updateContent()},_shrinkLabelToContentSize:function(e){for(var t=_,r=V,n=w,i=0,a=n.cloneLetterDefinition(),o=!0;e();){var s=t-++i;if(o=!1,s<=0)break;var l=s/t;n.assignLetterDefinitions(a),n.scaleFontLetterDefinition(l),V=r*l,this._multilineTextWrapByWord(),this._computeAlignmentOffset()}V=r,n.assignLetterDefinitions(a),o||0<=t-i&&this._scaleFontSizeDown(t-i)},_isVerticalClamp:function(){return L>G.height},_isHorizontalClamp:function(){for(var e=w._letterDefinitions,t=!1,r=0,n=k.length;r<n;++r){var i=S[r];if(i._valid){var a=e[i._char],o=i._positionX+a._width*N,s=i._lineIndex;if(0<Y)if(H){if(D[s]>G.width&&(o>G.width||o<0)){t=!0;break}}else if(o>G.width){t=!0;break}}}return t},_isHorizontalClamped:function(e,t){var r=D[t],n=e>G.width||e<0;return(!H||r>G.width)&&n},_updateQuads:function(){var e=w._letterDefinitions,t=U._texture,r=y.node,n=y._renderData;n.dataLength=n.vertexCount=n.indiceCount=0;for(var i=r._anchorPoint.x*G.width,a=r._anchorPoint.y*G.height,o=cc.Label.Overflow,s=!0,l=0,_=k.length;l<_;++l){var c=S[l];if(c._valid){var u=e[c._char];F.height=u._height,F.width=u._width,F.x=u._u,F.y=u._v;var f=c._positionY+O;if(0<$){if(M<f){var h=f-M;F.y+=h,F.height-=h,f-=h}f-u._height*N<I&&(F.height=f<I?0:f-I)}var d=c._lineIndex,p=c._positionX+u._width/2*N+C[d];if(0<Y&&this._isHorizontalClamped(p,d))if(W===o.CLAMP)F.width=0;else if(W===o.SHRINK){if(G.width>u._width){s=!1;break}F.width=0}if(0<F.height&&0<F.width){var m=U.isRotated(),v=U._originalSize,T=U._rect,b=U._offset,g=b.x+(v.width-T.width)/2,E=b.y-(v.height-T.height)/2;if(m){var x=F.x;F.x=T.x+T.height-F.y-F.height-E,F.y=x+T.y-g,F.y<0&&(F.height=F.height+E)}else F.x+=T.x-g,F.y+=T.y+E;var A=c._positionX+C[c._lineIndex];this.appendQuad(n,t,F,m,A-i,f-a,N)}}}return s},appendQuad:function(){},_computeAlignmentOffset:function(){C.length=0;var e=cc.macro;switch(u){case e.TextAlignment.LEFT:for(var t=0;t<B;++t)C[C.length]=0;break;case e.TextAlignment.CENTER:for(var r=0,n=D.length;r<n;r++)C[C.length]=(G.width-D[r])/2;break;case e.TextAlignment.RIGHT:for(var i=0,a=D.length;i<a;i++)C[C.length]=G.width-D[i]}switch(f){case e.VerticalTextAlignment.TOP:O=G.height;break;case e.VerticalTextAlignment.CENTER:O=(G.height+L)/2;break;case e.VerticalTextAlignment.BOTTOM:O=L}},_setupBMFontOverflowMetrics:function(){var e=cc.Label.Overflow,t=G.width,r=G.height;W===e.RESIZE_HEIGHT&&(r=0),W===e.NONE&&(r=t=0),Y=t,$=r,n.width=t,n.height=r,z=t}}),b8e.RC("$$b8e","$$BaseFontAssembler",t)}(),function(){var n=b8e.AssemblerUtils.fillMeshVertices,e=b8e.BaseFontAssembler.extends({ctor:function(){this._super()},createData:function(e){return e.requestRenderData()},fillBuffers:function(e,t){var r=e.node;n(r,t._meshBuffer,e._renderData,r._color._val)},appendQuad:function(e,t,r,n,i,a,o){var s=e.dataLength;e.dataLength+=4,e.vertexCount=e.dataLength,e.indiceCount=e.dataLength/2*3;var l=e._data,_=t.width,c=t.height,u=r.width,f=r.height,h=void 0,d=void 0,p=void 0,m=void 0;n?(h=r.x/_,p=(r.x+f)/_,d=(r.y+u)/c,m=r.y/c,l[s].u=h,l[s].v=m,l[s+1].u=h,l[s+1].v=d,l[s+2].u=p,l[s+2].v=m,l[s+3].u=p,l[s+3].v=d):(h=r.x/_,p=(r.x+u)/_,d=(r.y+f)/c,m=r.y/c,l[s].u=h,l[s].v=d,l[s+1].u=p,l[s+1].v=d,l[s+2].u=h,l[s+2].v=m,l[s+3].u=p,l[s+3].v=m),l[s].x=i,l[s].y=a-f*o,l[s+1].x=i+u*o,l[s+1].y=a-f*o,l[s+2].x=i,l[s+2].y=a,l[s+3].x=i+u*o,l[s+3].y=a}}),t=b8e.BaseFontAssembler.extends({createData:function(e){return e.requestRenderData()},appendQuad:function(e,t,r,n,i,a,o){var s=e.dataLength;e.dataLength+=2;var l=e._data,_=(t.width,t.height,r.width),c=r.height,u=void 0,f=void 0,h=void 0,d=void 0;n?(u=r.x,h=r.x+c,f=r.y,d=r.y+_,l[s].u=u,l[s].v=d,l[s+1].u=u,l[s+1].v=f):(u=r.x,h=r.x+_,f=r.y,d=r.y+c,l[s].u=u,l[s].v=f,l[s+1].u=h,l[s+1].v=d),l[s].x=i,l[s].y=a-c*o,l[s+1].x=i+_*o,l[s+1].y=a},draw:function(e,t){var r=t.node,n=r._worldMatrix,i=n.m00,a=n.m01,o=n.m04,s=n.m05,l=n.m12,_=n.m13;e.transform(i,a,o,s,l,_),e.scale(1,-1),utils.context.setGlobalAlpha(e,r.opacity/255);for(var c=t._frame._texture,u=t._renderData._data,f=utils.getColorizedImage(c,r._color),h=0,d=u.length;h<d;h+=2){var p=u[h].x,m=u[h].y,v=u[h+1].x-p,T=u[h+1].y-m;m=-m-T;var b=u[h].u,g=u[h].v,E=u[h+1].u-b,x=u[h+1].v-g;e.drawImage(f,b,g,E,x,p,m,v,T)}return 1}});b8e.bmfontAssemblerCanvas=new t,b8e.bmfontAssembler=new e;var r=e.extends({fillBuffers:function(e,t){var r=e.node;b8e.AssemblerUtils.fillMeshVertices3D(r,t._meshBuffer3D,e._renderData,r._color._val)}});b8e.bmfontAssembler3D=new r}(),function(){var e,t=e=b8e.PoolObject.extends({lazyPoolDisabled:!0,x:0,y:0,z:0,u:0,v:0,color:0,reset:function(){var e=this;e.x=0,e.y=0,e.z=0,e.u=0,e.v=0,e.color=0},restore:function(){this.reset(),this._super()},recycle:function(){this.reset(),this._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$RenderDataItem",e)}(),function(){var e;e=b8e.PoolObject.extends({material:null,vertexCount:0,indiceCount:0}),b8e.RC("$$b8e","$$BaseRenderData",e)}(),function(){var e,t=e=b8e.BaseRenderData.extends({ia:null,ctor:function(){this._super()},type:{get:function(){return t.type}}});t.type="IARenderData",t.poolCall=!0,b8e.RC("$$b8e","$$IARenderData",e)}(),function(){var e,t=e=b8e.BaseRenderData.extends({ctor:function(){this._super(),this._data=[],this._indices=[],this.reset()},type:{get:function(){return t.type}},dataLength:{get:function(){return this._data.length},set:function(e){var t=this._data,r=t.length,n=r-e;if(0<n){for(var i=r-n,a=r-1;i<=a;a--){var o=t[a];b8e.RenderDataItem.put(o)}t.length=e}else if(n<0)for(var s=-n-1;0<=s;s--){var l=b8e.RenderDataItem.get();t[t.length]=l}}},updateSizeNPivot:function(e,t,r,n){var i=this;e===i._width&&t===i._height&&r===i._pivotX&&n===i._pivotY||(i._width=e,i._height=t,i._pivotX=r,i._pivotY=n,i.vertDirty=!0)},reset:function(){for(var e=this,t=e._data,r=t.length-1;0<r;r--)b8e.RenderDataItem.put(t[r]);t.length=0,e._indices.length=0,e._pivotX=0,e._pivotY=0,e._width=0,e._height=0,e.vertexCount=0,e.indiceCount=0,e.material=null,e.uvDirty=!0,e.vertDirty=!0},restore:function(){this.reset(),this._super()},recycle:function(){this.reset(),this._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$RenderData",e)}(),function(){var e,n=0,t=0,r=0,i=0,a=e=b8e.PoolObject.extends({ctor:function(e){t++,r++;this._super(),this._target=-1,this.resetParams(e)},resetParams:function(e){i++;var t=this;t._device=e,t._id=++n,t._width=4,t._height=4,t._hasMipmap=!1,t._compressed=!1,t._anisotropy=1;var r=b8e.RenderTextureEnum;t._minFilter=r.FILTER_LINEAR,t._magFilter=r.FILTER_LINEAR,t._mipFilter=r.FILTER_LINEAR,t._wrapS=r.WRAP_REPEAT,t._wrapT=r.WRAP_REPEAT,t._format=r.TEXTURE_FMT_RGBA8},invalidate:function(){i--;this._super()},restore:function(e){this._super(),this.resetParams(e)},_deleteTexture:function(){var e=this;e._glID?(e._device._gl.deleteTexture(e._glID),e._device._stats.tex-=e.bytes,e._glID=null,e._id=0,r--):b8e.error(7001)},recycle:function(){this._super(),this._device=null},dispose:function(){this._deleteTexture(),this._target=-1,this._super()}});a.getCreateCount=function(){return t},a.getPoolCount=function(){return r},a.getActiveCount=function(){return i},b8e.RC("$$b8e","$$GLTexture",e)}(),function(){Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;var e,n=e=b8e.GLTexture.extends({_options:null,_images:null,ctor:function(e,t){var r=this;r._super(e);var n=r._device._gl;r._target=n.TEXTURE_2D,r._glID=n.createTexture(),t&&r.applyUpdate(t)},resetParams:function(e){this._super(e),this.lazyUpdate=n.LAZY_UPDATE},restore:function(e,t){this._super(e),t&&this.applyUpdate(t)},invalidate:function(){n.LAZY_UPDATE&&n._lazyUpdate.remove(this),this._images=[null],this._update(),this._super()},recycle:function(){var e=this;e._options&&(e._options.release(),e._options=null),e._images=null,e._super()},applyUpdate:function(e){var t=this;if(t._options&&(t._options.release(),t._options=null),t._options=b8e.TextureOptions.get(),b8e.TextureOptions.clonePrimitiveType(e,t._options),t._images=e.images||[null],t.lazyUpdate){var r=t._images;t._images=[null],t._update(),t._images=r,n._lazyUpdate.add(t)}else t._update()},_update:function(){var e=this,t=e._device._gl,r=e._hasMipmap,n=e._options,i=e._images;if(n){if(void 0!==n.width&&(e._width=n.width),void 0!==n.height&&(e._height=n.height),void 0!==n.anisotropy&&(e._anisotropy=n.anisotropy),void 0!==n.minFilter&&(e._minFilter=n.minFilter),void 0!==n.magFilter&&(e._magFilter=n.magFilter),void 0!==n.mipFilter&&(e._mipFilter=n.mipFilter),void 0!==n.wrapS&&(e._wrapS=n.wrapS),void 0!==n.wrapT&&(e._wrapT=n.wrapT),void 0!==n.format){var a=b8e.RenderTextureEnum;e._format=n.format,e._compressed=e._format>=a.TEXTURE_FMT_RGB_DXT1&&e._format<=a.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||e._format>=a.TEXTURE_FMT_RGB_ETC2&&e._format<=a.TEXTURE_FMT_RGBA_ASTC_12x12}void 0!==n.mipmap&&(e._hasMipmap=n.mipmap,r=n.mipmap);var o=b8e.GLUtil.getMaxTextureSize(),s=n.width&&n.height?Math.max(n.width,n.height):0;if(o<s&&b8e.warn(7002,s,o),i)if(1<i.length)r=!1,(n.width>n.height?n.width:n.height)>>i.length-1!=1&&b8e.error(7003)}l(e._width)&&l(e._height)||(r=!1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e._glID),i&&0<i.length&&(e._setMipmap(i,n.flipY,n.premultiplyAlpha),1<i.length&&(e._hasMipmap=!0)),r&&(t.hint(t.GENERATE_MIPMAP_HINT,t.NICEST),t.generateMipmap(t.TEXTURE_2D),e._hasMipmap=!0),e._setTexInfo(),e._device._restoreTexture(0)},updateSubImage:function(e){var t=this,r=t._device._gl,n=u(t._format);r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t._glID),t._setSubImage(n,e),t._device._restoreTexture(0)},updateImage:function(e){var t=this,r=t._device._gl,n=u(t._format);r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t._glID),t._setImage(n,e),t._device._restoreTexture(0)},_setSubImage:function(e,t){var r=this._device._gl,n=t.flipY,i=t.premultiplyAlpha,a=t.image;!a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer?(void 0===n?r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1):r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,n),void 0===i?r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this._compressed?r.compressedTexSubImage2D(r.TEXTURE_2D,t.level,t.x,t.y,t.width,t.height,e.format,a):r.texSubImage2D(r.TEXTURE_2D,t.level,t.x,t.y,t.width,t.height,e.format,e.pixelType,a)):(void 0===n?r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0):r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,n),void 0===i?r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),r.texSubImage2D(r.TEXTURE_2D,t.level,t.x,t.y,e.format,e.pixelType,a))},_setImage:function(e,t){var r=this._device._gl,n=t.flipY,i=t.premultiplyAlpha,a=t.image;!a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer?(void 0===n?r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1):r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,n),void 0===i?r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this._compressed?r.compressedTexImage2D(r.TEXTURE_2D,t.level,e.internalFormat,t.width,t.height,0,a):r.texImage2D(r.TEXTURE_2D,t.level,e.internalFormat,t.width,t.height,0,e.format,e.pixelType,a)):(void 0===n?r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0):r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,n),void 0===i?r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),r.texImage2D(r.TEXTURE_2D,t.level,e.internalFormat,e.format,e.pixelType,a))},_setMipmap:function(e,t,r){for(var n=this,i=u(n._format),a={width:n._width,height:n._height,flipY:t,premultiplyAlpha:r,level:0,image:null},o=0;o<e.length;++o)a.level=o,a.width=n._width>>o,a.height=n._height>>o,a.image=e[o],n._setImage(i,a)},_setTexInfo:function(){var e=this,t=e._device._gl,r=l(e._width)&&l(e._height),n=b8e.RenderTextureEnum;r||e._wrapS===n.WRAP_CLAMP&&e._wrapT===n.WRAP_CLAMP||(b8e.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),e._wrapS=n.WRAP_CLAMP,e._wrapT=n.WRAP_CLAMP);var i=e._hasMipmap?e._mipFilter:-1;r||-1===i||(b8e.warn("NPOT textures do not support mipmap filter"),i=-1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o(t,e._minFilter,i)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,o(t,e._magFilter,-1)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,e._wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,e._wrapT);var a=e._device.ext("EXT_texture_filter_anisotropic");a&&t.texParameteri(t.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,e._anisotropy)}});function l(e){return!(e&e-1||!e)}var t=b8e.TextureFilterMode,i=[[t.NEAREST,9984,9986],[t.LINEAR,9985,9987]];function o(e,t,r){void 0===r&&(r=-1);var n=i[t][r+1];return void 0===n?(b8e.warn("Unknown FILTER: "+t),-1===r?e.LINEAR:e.LINEAR_MIPMAP_LINEAR):n}var r=5121,a=6402,s=6407,_=6408,c=[{format:s,internalFormat:33776,pixelType:null},{format:_,internalFormat:33777,pixelType:null},{format:_,internalFormat:33778,pixelType:null},{format:_,internalFormat:33779,pixelType:null},{format:s,internalFormat:36196,pixelType:null},{format:s,internalFormat:35841,pixelType:null},{format:_,internalFormat:35843,pixelType:null},{format:s,internalFormat:35840,pixelType:null},{format:_,internalFormat:35842,pixelType:null},{format:6406,internalFormat:6406,pixelType:r},{format:6409,internalFormat:6409,pixelType:r},{format:6410,internalFormat:6410,pixelType:r},{format:s,internalFormat:s,pixelType:33635},{format:_,internalFormat:_,pixelType:32820},{format:_,internalFormat:_,pixelType:32819},{format:s,internalFormat:s,pixelType:r},{format:_,internalFormat:_,pixelType:r},{format:s,internalFormat:s,pixelType:36193},{format:_,internalFormat:_,pixelType:36193},{format:s,internalFormat:s,pixelType:5126},{format:_,internalFormat:_,pixelType:5126},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:a,internalFormat:a,pixelType:5123},{format:a,internalFormat:a,pixelType:5125},{format:a,internalFormat:a,pixelType:5125},{format:s,internalFormat:37492,pixelType:null},{format:_,internalFormat:37496,pixelType:null},{format:_,internalFormat:37808,pixelType:null},{format:_,internalFormat:37812,pixelType:null},{format:_,internalFormat:37815,pixelType:null},{format:_,internalFormat:37819,pixelType:null},{format:_,internalFormat:37821,pixelType:null}];function u(e){var t=c[e];if(void 0!==t)return t;b8e.warn("Unknown TEXTURE_FMT: "+e);var r=b8e.RenderTextureEnum;return c[r.TEXTURE_FMT_RGBA8]}var f=new b8e.Pool(n,4096);n.get=function(e,t){return f.get(e,t)},n.put=function(e){return f.put(e)},n.LAZY_UPDATE=!0,n.BATCH_UPDATE_NUM=1,n._lazyUpdate=new b8e.CallLater(function(e){return e._update(),!1},n,n.BATCH_UPDATE_NUM),b8e.RC("$$b8e","$$GLTexture2D",e)}(),function(){var e,t=e=b8e.PoolObject.extends({ctor:function(){this._super(),this.resetParams()},resetParams:function(){var e=this;e.width=void 0,e.height=void 0,e.minFilter=void 0,e.magFilter=void 0,e.wrapS=void 0,e.wrapT=void 0,e.format=void 0,e.mipmap=void 0;var t=e.images;t?t.length=0:e.images=[],e.image=void 0,e.flipY=void 0,e.premultiplyAlpha=void 0},recycle:function(){this.resetParams(),this._super()}}),r=new b8e.Pool(t,4096);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},t.clonePrimitiveType=function(e,t){t.width=e.width,t.height=e.height,t.minFilter=e.minFilter,t.magFilter=e.magFilter,t.wrapS=e.wrapS,t.wrapT=e.wrapT,t.format=e.format,t.mipmap=e.mipmap,t.flipY=e.flipY,t.premultiplyAlpha=e.premultiplyAlpha},b8e.RC("$$b8e","$$TextureOptions",e)}(),function(){var e,r=0,b=e=b8e.PoolObject.extends({_hasMipmap:!1,_format:null,_premultiplyAlpha:!1,_flipY:!1,_minFilter:0,_magFilter:0,_mipFilter:0,_wrapS:0,_wrapT:0,ctor:function(){this._super(),this._reset()},_reset:function(){var e=this;e._wrapS=f.CLAMP_TO_EDGE,e._wrapT=f.CLAMP_TO_EDGE,e._id="Tex"+ ++r,e._format=b8e.RenderTextureEnum.TEXTURE_FMT_RGBA8;var t=b8e.TextureFilterMode.LINEAR;e._minFilter=t,e._magFilter=t,e._mipFilter=t,e.url="",e.loaded=!1,e.width=0,e.height=0,e._hashDirty=!0,e._hash=0,e._texture=null,e._image=null,e._pattern="",e._bindMaterialMap=null,e._refMap=null,e._lastIsValidate=!1},recycle:function(){this._reset(),this._super()},invalidate:function(){var e=this;e._isttf||b8e.TextureCache.removeTexture(e),e._clearImage(),e._bindMaterialMap&&(e._bindMaterialMap.release(),e._bindMaterialMap=null),e._refMap&&(e._refMap.release(),e._refMap=null),e._texture&&(e._lastIsValidate||a(e),e._texture.release(),e._texture=null),e.loaded=!1,e._lastIsValidate=!1,e._super()},setTexParameters:function(e,t,r,n){void 0!==t&&(e={minFilter:e,magFilter:t,wrapS:r,wrapT:n}),e.wrapS!==f.REPEAT||e.wrapT!==f.REPEAT?e.wrapS!==f.REPEAT?e.wrapT!==f.REPEAT?this._pattern="":this._pattern="repeat-y":this._pattern="repeat-x":this._pattern="repeat"},_generateColorTexture:function(e,t,r,n,i){if(cc.sys._supportCanvasNewBlendModes){var a=!1;i?a=!0:i=document.createElement("canvas");var o=this._image;if(n=n||cc.rect(0,0,o.width,o.height),i.width=n.width,i.height=n.height,n.width&&n.height){var s=i.getContext("2d");s.globalCompositeOperation="source-over",s.fillStyle="rgb("+(0|e)+","+(0|t)+","+(0|r)+")",s.fillRect(0,0,n.width,n.height),s.globalCompositeOperation="multiply",s.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),s.globalCompositeOperation="destination-atop",s.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height)}if(a)return i;var l=new b;return l.initWithElement(i),l}var _=!1;i?_=!0:i=document.createElement("canvas");var c=this._image;if(n=n||cc.rect(0,0,c.width,c.height),i.width=n.width,i.height=n.height,n.width&&n.height){var u=i.getContext("2d");u.drawImage(c,n.x,n.y,n.width,n.height,0,0,n.width,n.height);var f=u.getImageData(0,0,i.width,i.height),h=f.data;e/=255,t/=255,r/=255;for(var d=0;d<h.length;d+=4)h[d]=h[d]*e,h[d+1]=h[d+1]*t,h[d+2]=h[d+2]*r;u.putImageData(f,0,0)}if(_)return i;var p=new b;return p.initWithElement(i),p},getImpl:function(){return this._texture},getId:function(){return this._id},toString:function(){return this.url||""},_update:function(e){var t=this;if(e){var r=b8e.FilterIndex,n=!1;if(void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.minFilter&&(t._minFilter=e.minFilter,e.minFilter=r[e.minFilter]),void 0!==e.magFilter&&(t._magFilter=e.magFilter,e.magFilter=r[e.magFilter]),void 0!==e.mipFilter&&(t._mipFilter=e.mipFilter,e.mipFilter=r[e.mipFilter]),void 0!==e.wrapS&&(t._wrapS=e.wrapS),void 0!==e.wrapT&&(t._wrapT=e.wrapT),void 0!==e.format&&(t._format=e.format),void 0!==e.flipY&&(t._flipY=e.flipY,n=!0),void 0!==e.premultiplyAlpha&&(t._premultiplyAlpha=e.premultiplyAlpha,n=!0),void 0!==e.mipmap&&(t._hasMipmap=e.mipmap),n&&t._image&&(e.image=t._image),e.images&&0<e.images.length)t._image=e.images[0];else if(void 0!==e.image){t._image=e.image;var i=e.images;i[i.length]=e.image}e.images&&0<e.images.length&&t._texture.applyUpdate(e),t._hashDirty=!0}},initWithElement:function(e,t){if(e){var r=this;r._image=e,t||b8e.TextureCache.addTexture(r),r._isttf=t,r.opts&&(r.opts.release(),r.opts=null);var n=b8e.TextureOptions.get();r.opts=n,r.handleLoadedTexture(t)}},initWithData:function(e,t,r,n,i,a){var o=this,s=b8e.FilterIndex;o.opts&&(o.opts.release(),o.opts=null);var l=b8e.TextureOptions.get();return(o.opts=l).image=e,l.images=[l.image],l.hasMipmap=o._hasMipmap,l.premultiplyAlpha=o._premultiplyAlpha,l.flipY=o._flipY,l.minFilter=s[o._minFilter],l.magFilter=s[o._magFilter],l.wrapS=o._wrapS,l.wrapT=o._wrapT,o._USE_RGBA_ETC1_=!1,o._USE_RGBA_ASTC_=30<=t&&t<=34,1024===t&&(t=4,o._USE_RGBA_ETC1_=!0),l.format=t,l.width=r,l.height=n,o.width=i||r,o.height=a||n,b8e.TextureCache.addTexture(o),b8e.TextureCache.textureLoaded(o),o.loaded=!0},getHtmlElementObj:function(){return this._image},textureValidate:function(e){var t=this;t._refMap||(t._refMap=b8e.HashMap.get());var r=t._refMap.count()<1;if(t._refMap.set(e,!0),r){if(t._BTF_BLOCK_DATA_)for(var n=t._BTF_BLOCK_DATA_.textures,i=n.length,a=0;a<i;a++)n[a].textureValidate(e);t._updateTexture()}},setBtfBlockData:function(e){var t=this;t._BTF_BLOCK_DATA_!=e&&(t._BTF_BLOCK_DATA_=e,t._bindMaterialMap&&t._bindMaterialMap.forEach(t._onTextureBindMaterial,t),t._refMap&&t._refMap.forEach(t._onTextureRef,t))},_onTextureBindMaterial:function(e){for(var t=this._BTF_BLOCK_DATA_.textures,r=t.length,n=0;n<r;n++)t[n].bindMaterial(e)},_onTextureRef:function(e){for(var t=this._BTF_BLOCK_DATA_.textures,r=t.length,n=0;n<r;n++)t[n].textureValidate(e)},_updateTexture:function(){var e=this,t=e.opts;if(t)if(e._isValidate()){if(e._lastIsValidate)return;e._lastIsValidate=!0,e._texture?o(e):e._texture=b8e.GLTexture2D.get(b8e.renderer.device,t),e._bindMaterialMap&&e._bindMaterialMap.forEach(e._updateBindMaterial,e)}else{if(!e._lastIsValidate)return;e._lastIsValidate=!1,e._texture&&i(e)}},_onReleaseTexture:function(){this._texture&&this._texture.release(),this._texture=null},_isValidate:function(){return!(!this._refMap||!this._bindMaterialMap)},_updateBindMaterial:function(e){e._onTextureUpdate()},textureInvalidate:function(e){var t=this;if(t._refMap&&(t._refMap.del(e),t._refMap.count()<1)){if(t._BTF_BLOCK_DATA_)for(var r=t._BTF_BLOCK_DATA_.textures,n=r.length,i=0;i<n;i++)r[i].textureInvalidate(e);t._refMap&&(t._refMap.release(),t._refMap=null),t._updateTexture()}},bindMaterial:function(e){var t=this;t._bindMaterialMap||(t._bindMaterialMap=b8e.HashMap.get());var r=t._bindMaterialMap.count()<1;if(t._bindMaterialMap.set(e,!0),t._BTF_BLOCK_DATA_)for(var n=t._BTF_BLOCK_DATA_.textures,i=n.length,a=0;a<i;a++)n[a].bindMaterial(e);r&&t._updateTexture()},unbindMaterial:function(e){var t=this;if(t._bindMaterialMap){if(t._bindMaterialMap.del(e),t._BTF_BLOCK_DATA_)for(var r=t._BTF_BLOCK_DATA_.textures,n=r.length,i=0;i<n;i++)r[i].unbindMaterial(e);t._bindMaterialMap.count()<1&&(t._bindMaterialMap&&(t._bindMaterialMap.release(),t._bindMaterialMap=null),t._updateTexture())}},getPixelFormat:function(){return this._format},hasPremultipliedAlpha:function(){return this._premultiplyAlpha||!1},hasMipmap:function(){return this._hasMipmap||!1},handleLoadedTexture:function(e){var t=this,r=t.opts;if(r&&t._image&&t._image.width&&t._image.height){var n=t._format;if(t.width=t._orgWidth||t._image.width,t.height=t._orgHeight||t._image.height,r.image=t._image,b8e.renderType==b8e.RenderType.WEBGL){var i=b8e.FilterIndex;r.images=[r.image],r.width=t._image.textureWidth||t._image.width,r.height=t._image.textureHeight||t._image.height,r.hasMipmap=t._hasMipmap,(r.format=n)===b8e.RenderTextureEnum.TEXTURE_FMT_RGBA_ETC1&&(r.format=b8e.RenderTextureEnum.TEXTURE_FMT_RGB_ETC1),r.premultiplyAlpha=t._premultiplyAlpha,r.flipY=t._flipY,r.minFilter=i[t._minFilter],r.magFilter=i[t._magFilter],r.wrapS=t._wrapS,r.wrapT=t._wrapT}e||b8e.TextureCache.textureLoaded(t),t.loaded=!0}},description:function(){return"<cc.Texture2D | Name = "+this.url+" | Dimensions = "+this.width+" x "+this.height+">"},setWrapMode:function(e,t){if(this._wrapS!==e||this._wrapT!==t){var r=this.opts;if(!r)return;r.wrapS=e,r.wrapT=t,this._update(r)}},setFilters:function(e,t){var r=this;if(r._minFilter!==e||r._magFilter!==t){var n=r.opts;if(!n)return;r._minFilter=e,r._magFilter=t;var i=b8e.FilterIndex;n.minFilter=i[e],n.magFilter=i[t]}},setFlipY:function(e){if(this._flipY!==e){var t=this.opts;if(!t)return;t.flipY=e,this._update(t)}},setPremultiplyAlpha:function(e){if(this._premultiplyAlpha!==e){var t=this.opts;if(!t)return;t.premultiplyAlpha=e,this._update(t)}},setMipmap:function(e){if(this._hasMipmap!==e){var t=this.opts;if(!t)return;t.mipmap=e,this._update(t)}},_deserialize:function(e,t){var r=this,n=b8e.renderer.device,i=e.split(","),a=i[0];if(a){for(var o=a.split("_"),s=999,l="",_=r._format,c=cc.macro.SUPPORT_TEXTURE_FORMATS,u=0;u<o.length;u++){var f=o[u].split("@"),h=f[0];h=h.charCodeAt(0)-g,h=b.extnames[h]||f;var d=c.indexOf(h);if(-1!==d&&d<s){var p=f[1]?parseInt(f[1]):r._format;if(".pvr"===h&&!n.ext("WEBGL_compressed_texture_pvrtc"))continue;if(!(p!==b8e.RenderTextureEnum.TEXTURE_FMT_RGB_ETC1&&p!==b8e.RenderTextureEnum.TEXTURE_FMT_RGBA_ETC1||n.ext("WEBGL_compressed_texture_etc1")))continue;if((p===b8e.RenderTextureEnum.TEXTURE_FMT_RGB_ETC1||p===b8e.RenderTextureEnum.TEXTURE_FMT_RGBA_ETC1)&&!n.ext("WEBGL_compressed_texture_etc"))continue;s=d,l=h,_=p}}l&&(r._setRawAsset(l),r._format=_);var m=t.customEnv,v=m&&m.uuid;if(v){r._uuid=v;var T=r.nativeUrl;r.url=T}}6===i.length&&(r._minFilter=parseInt(i[1]),r._magFilter=parseInt(i[2]),r._wrapS=parseInt(i[3]),r._wrapT=parseInt(i[4]),r._premultiplyAlpha=i[5].charCodeAt(0)===E)},_getHash:function(){var e=this;if(!e._hashDirty)return e._hash;var t=e._hasMipmap?1:0,r=e._premultiplyAlpha?1:0,n=e._flipY?1:0,i=b8e.TextureFilterMode,a=e._minFilter===i.LINEAR?1:2,o=e._magFilter===i.LINEAR?1:2,s=e._wrapS===f.REPEAT?1:e._wrapS===f.CLAMP_TO_EDGE?2:3,l=e._wrapT===f.REPEAT?1:e._wrapT===f.CLAMP_TO_EDGE?2:3,_=e._format,c=e._image;return CC_JSB&&c&&(c._glFormat!==u&&(_=0),r=c._premultiplyAlpha),e._hash=Number(""+a+o+_+s+l+t+r+n),e._hashDirty=!1,e._hash},_isCompressed:function(){return this._texture&&this._texture._compressed},_clearImage:function(){var e=this;e._image&&(e._image.src="",e._image=null),e.opts&&(e.opts.release(),e.opts=null),e._BTF_BLOCK_DATA_=null,e._ENABLE_BLOCK_COMPACT_=!1}}),u=6408,g=48,E=49,f=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648}),t=new b8e.Pool(b,4096);b.get=function(){return t.get()},b.put=function(e){return t.put(e)},b.ENABLE_BLOCK_COMPACT=!1;var n=null;function i(e){n||(n=new b8e.RecycleBin).onDestroyObject(s),n.recycle(e)}function a(e){n&&n.remove(e)}function o(e){n&&n.restore(e)}function s(e){return e._onReleaseTexture(),!0}b.purge=function(){n&&n.purge()},b.getFreeCount=function(){return n?n.count():0},b8e.RC("$$b8e","$$Texture2D",e)}(),function(){var e;e=b8e.Texture2D.extends({ctor:function(){this._super(),this._framebuffer=null},initWithSize:function(e,t,r){var n=this;n.width=Math.floor(e||cc.visibleRect.width),n.height=Math.floor(t||cc.visibleRect.height),n._resetUnderlyingMipmaps();var i={colors:[n._texture]},a=b8e.GFXEnums;n._depthStencilBuffer&&n._depthStencilBuffer.destroy();var o=void 0;r&&(o=new b8e.GFXRenderBuffer(b8e.renderer.device,r,e,t),r===a.RB_FMT_D24S8?i.depthStencil=o:r===a.RB_FMT_S8?i.stencil=o:r===a.RB_FMT_D16&&(i.depth=o)),n._depthStencilBuffer=o,n._framebuffer&&n._framebuffer.destroy(),n._framebuffer=new b8e.GFXFrameBuffer(b8e.renderer.device,e,t,i),n.loaded=!0},updateSize:function(e,t){var r=this;r.width=Math.floor(e||cc.visibleRect.width),r.height=Math.floor(t||cc.visibleRect.height),r._resetUnderlyingMipmaps();var n=r._depthStencilBuffer;n&&n.update(r.width,r.height),r._framebuffer._width=e,r._framebuffer._height=t},drawTextureAt:function(e,t,r){e._image&&this._texture.updateSubImage({x:t,y:r,image:e._image,width:e.width,height:e.height,level:0,flipY:!1,premultiplyAlpha:e._premultiplyAlpha})},readPixels:function(e,t,r,n,i){var a=this;if(!a._framebuffer||!a._texture)return e;t=t||0,r=r||0;var o=n||a.width,s=i||a.height;e=e||new Uint8Array(o*s*4);var l=b8e.renderer._forward._device._gl,_=l.getParameter(l.FRAMEBUFFER_BINDING);return l.bindFramebuffer(l.FRAMEBUFFER,a._framebuffer._glID),l.readPixels(t,r,o,s,l.RGBA,l.UNSIGNED_BYTE,e),l.bindFramebuffer(l.FRAMEBUFFER,_),e},_resetUnderlyingMipmaps:function(e){var t=this,r=t._getOpts();r.images=e||[null],t._texture||(t._texture=b8e.GLTexture2D.get(b8e.renderer.device)),t._texture.lazyUpdate=!1,t._texture.applyUpdate(r)},_getOpts:function(){var e=this;e.opts&&(e.opts.release(),e.opts=null);var t=b8e.FilterIndex,r=b8e.TextureOptions.get();return(e.opts=r).width=e.width,r.height=e.height,r.mipmap=e._genMipmap,r.format=e._format,r.premultiplyAlpha=e._premultiplyAlpha,r.anisotropy=e._anisotropy,r.flipY=e._flipY,r.minFilter=t[e._minFilter],r.magFilter=t[e._magFilter],r.mipFilter=t[e._mipFilter],r.wrapS=e._wrapS,r.wrapT=e._wrapT,r},destroy:function(){this._super(),this._framebuffer&&this._framebuffer.destroy()}}),b8e.RC("$$b8e","$$RenderTexture2D",e)}(),function(){var e,b=e=b8e.PoolObject.extends({_btfData:null,_bundleData:null,_texture:null,_btfTextures:null,_enabelBlockCompact:!1,ctor:function(){this._super()},setData:function(e,t,r,n){var i=this;if(!i._texture){var a=b8e.proto.texture_format.TextureFormatMessage;i._btfData=b8e.ProtobufUtil.decodeMessage(e,t,a);var o=i._btfData.version;if(1===o||49===o){var s=i._btfData.bundleData;i._bundleData=s?b8e.JsUtil.jsonParse(s):null,i._onCompleteCb={func:r,thisArg:n},i._enabelBlockCompact=!1;var l=e.lastIndexOf("."),_="bti",c=i.options.textureFormat;c?_=c:b8e.btfbc&&b8e.Texture2D.ENABLE_BLOCK_COMPACT&&(_="btc"),"btc"===_&&(i._enabelBlockCompact=!0),i._btcUrl=e.substring(0,l)+"."+_;var u=i.options.recycleDelay;b8e.res.loadRes(i._btcUrl,b8e.Texture2DAsset,i._onBtcComplete,i,null,{recycleDelay:u,ownerUrl:e,format:c})}else b8e.error(1304,e)}},_onBtcComplete:function(e,t){var r=this;if(t){r._texture=t;var n=r._btfData,i=t.getTexture();if(i._ENABLE_BLOCK_COMPACT_=r._enabelBlockCompact&&n.format===b.BLOCK_COMPACT_PNG,i._ENABLE_BLOCK_COMPACT_){var a=t._texture,o=a.opts;if(o){var s=n.width,l=n.height,_=n.blockSize,c=n.blockSpace,u=r._btfTextures=[],f=r._getDescTex(n,"x","y","width"),h=(u[0]=f).width,d=f.height;f=r._getDescTex(n,"offsetX","offsetY","height"),u[1]=f;var p=a.width/o.width,m=a.height/o.height,v=new cc.Vec4(s,l,p,m),T=new cc.Vec4(h,d,_,c);i.setBtfBlockData({textureSize:v,descSize:T,textures:u})}}}r._loadComplete()},_getDescTex:function(e,t,r,n){var i=this._getDescBlocks(e,t,r,n),a=i.datas,o=a.length,s=new Uint8Array(o);s.set(a),a.length=0;var l=i.width,_=i.height,c=b8e.Texture2D.get(),u=b8e.TextureFilterMode.NEAREST;return c._minFilter=u,c._magFilter=u,c.initWithData(s,b8e.TextureFormat.RGB8,l,_),c},_getDescBlocks:function(e,t,r,n){for(var i=e.blocks,a={},o=i.length,s=0;s<o;s++){var l=i[s];a[l.idx]=l}var _=[],c=e.col,u=b8e.MathUtil.nearestPowerOfTwo(c),f=0;f=u<e.col?(u<<1)-e.col:u-e.col;var h=e.row,d=b8e.MathUtil.nearestPowerOfTwo(h),p=0;p=d<e.row?(d<<1)-e.row:d-e.row;for(var m=0;m<h;m++){for(var v=m,T=0;T<c;T++){var b=a[v*c+T];b?(_[_.length]=b[t],_[_.length]=b[r],_[_.length]=b[n]):(_[_.length]=0,_[_.length]=0,_[_.length]=0)}for(var g=0;g<f;g++)_[_.length]=0,_[_.length]=0,_[_.length]=0}for(var E=0;E<p;E++){for(var x=0;x<c;x++)_[_.length]=0,_[_.length]=0,_[_.length]=0;for(var A=0;A<f;A++)_[_.length]=0,_[_.length]=0,_[_.length]=0}return{width:c+f,height:h+p,datas:_}},_loadComplete:function(e){var t=this;t._onCompleteCb&&t._onCompleteCb.func&&t._onCompleteCb.func.call(t._onCompleteCb.thisArg,t,e)},_getBtfData:function(){return this._btfData},_getBundleData:function(){return this._bundleData},getTexture:function(){return this._texture},invalidate:function(){var e=this,t=e._btfTextures;if(t){for(var r=t.length,n=0;n<r;n++){t[n].release()}t.length=0,e._btfTextures=t=null}e._btcUrl&&(b8e.res.unloadRes(e._btcUrl,e._onBtcComplete,e),e._btcUrl=null),e.options=null,e._bundleData=null,e._texture=null,e._btfData=null,e._onCompleteCb=null,e._enabelBlockCompact=!1,e._super()},recycle:function(){this._super()}}),t=new b8e.Pool(b,4096);b.get=function(){return t.get()},b.put=function(e){return t.put(e)},b.NORMAL_PNG=1,b.BLOCK_COMPACT_PNG=2,b8e.RC("$$b8e","$$BTFTexture",e)}(),function(){var e,n=0,i=1,c=2,t=i|c,a=4,u=8,o=16,s=32,l=64,_=128,f=256,h=512,d=void 0,p=0,m=cc.eventManager,v=e=b8e.Object.extends({ctor:function(){this._super(),this._func=E,this._next=null},_doNothing:function(){},_localTransform:function(e){e._updateLocalMatrix(),e._renderFlag&=~i,this._next._func(e)},_worldTransform:function(e){d.worldMatDirty++;var t=e._matrix,r=e._position;t.m12=r.x,t.m13=r.y,e._mulMat(e._worldMatrix,e._parent._worldMatrix,t),e._renderFlag&=~c,this._next._func(e),d.worldMatDirty--},_opacity:function(e){d.parentOpacityDirty++;var t=e._renderComponent;t&&t._updateColor&&t._updateColor(),e._renderFlag&=~u,this._next._func(e),d.parentOpacityDirty--},_updateRenderData:function(e){var t=e._renderComponent;t._assembler.updateRenderData(t),e._renderFlag&=~a,this._next._func(e)},_render:function(e){var t=e._renderComponent;d._commitComp(t,t._assembler,e._cullingMask),this._next._func(e)},_customIARender:function(e){var t=e._renderComponent;d._commitIA(t,t._assembler,e._cullingMask),this._next._func(e)},_children:function(e){for(var t=d,r=t.parentOpacity,n=t.parentOpacity*=e._opacity/255,i=(t.worldMatDirty?c:0)|(t.parentOpacityDirty?u:0),a=e._children,o=0,s=a.length;o<s;o++){var l=a[o];if(m._updateRenderOrder(l,++p),l._renderFlag|=i,l._activeInHierarchy&&0!==l._opacity){var _=l._color._val;l._color._fastSetA(l._opacity*n),b[l._renderFlag]._func(l),l._color._val=_}}t.parentOpacity=r,this._next._func(e)},_postUpdateRenderData:function(e){var t=e._renderComponent;t._postAssembler&&t._postAssembler.updateRenderData(t),e._renderFlag&=~_,this._next._func(e)},_postRender:function(e){var t=e._renderComponent;d._commitComp(t,t._postAssembler,e._cullingMask),this._next._func(e)}}),T=new v;T._func=T._doNothing,T._next=T;var b={};function g(e,t){var r=new v;switch(r._next=t||T,e){case n:r._func=r._doNothing;break;case i:r._func=r._localTransform;break;case c:r._func=r._worldTransform;break;case u:r._func=r._opacity;break;case a:r._func=r._updateRenderData;break;case o:r._func=r._render;break;case s:r._func=r._customIARender;break;case l:r._func=r._children;break;case _:r._func=r._postUpdateRenderData;break;case f:r._func=r._postRender}return r}function r(e){for(var t=null,r=h;0<r;)r&e&&(t=g(r,t)),r>>=1;return t}function E(e){var t=e._renderFlag;(b[t]=r(t))._func(e)}v.flows=b,v.createFlow=g,v.visit=function(e){d.reset(),d.walking=!0,e.groupIndex,p=0,e._renderFlag&c?(d.worldMatDirty++,e._calculWorldMatrix(),e._renderFlag&=~c,b[e._renderFlag]._func(e),d.worldMatDirty--):b[e._renderFlag]._func(e),d.terminate(),d.walking=!1},v.init=function(e){d=e,b[0]=T;for(var t=1;t<h;t++)b[t]=new v},v.FLAG_DONOTHING=n,v.FLAG_LOCAL_TRANSFORM=i,v.FLAG_WORLD_TRANSFORM=c,v.FLAG_TRANSFORM=t,v.FLAG_OPACITY=u,v.FLAG_UPDATE_RENDER_DATA=a,v.FLAG_RENDER=o,v.FLAG_CUSTOM_IA_RENDER=s,v.FLAG_CHILDREN=l,v.FLAG_POST_UPDATE_RENDER_DATA=_,v.FLAG_POST_RENDER=f,v.FLAG_FINAL=h,v.poolCall=!0,b8e.RC("$$b8e","$$RenderFlow",e)}(),function(){var e,u=0;function h(e){for(var t=[],r={},n=e.length-1;0<=n;n--){var i=e[n];for(var a in i)if(void 0===r[a]){var o=i[a];"number"!=typeof o&&(o=o?1:0),r[a]=o,t[t.length]="#define "+a+" "+o}}return t.join("\n")+"\n"}function d(e,t){for(var r={},n=e,i=t.length-1;0<=i;i--){var a=t[i];for(var o in a)void 0===r[o]&&Number.isInteger(a[o])&&(r[o]=a[o])}for(var s in r){var l=new RegExp(s,"g");n=n.replace(l,r[s])}return n}function p(e){return e.replace(/#pragma for (\w+) in range\(\s*(\d+)\s*,\s*(\d+)\s*\)([\s\S]+?)#pragma endFor/g,function(e,t,r,n,i){var a="",o=parseInt(r),s=parseInt(n);(o.isNaN||s.isNaN)&&console.error("Unroll For Loops Error: begin and end of range must be an int num.");for(var l=o;l<s;++l)a+=i.replace(new RegExp("{"+t+"}","g"),l);return a})}e=b8e.Object.extends({ctor:function(e,t,r){var n=1<arguments.length&&void 0!==t?t:[],i=2<arguments.length&&void 0!==r?r:{},a=this;a._super(),a._precision="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n",a._device=e,a._templates={};for(var o=0;o<n.length;++o)a.define(n[o]);a._chunks={},Object.assign(a._chunks,i),a._cache={}},define:function(e){var t=e.name,r=e.vert,n=e.frag,i=e.defines;e.extensions;if(this._templates[t])console.warn("Failed to define shader "+t+": already exists.");else{for(var a=++u,o=0,s=0;s<i.length;++s){var l=i[s],_=1;if("number"===l.type){var c=l.range||[];l.min=c[0]||0,l.max=c[1]||4,_=Math.ceil(Math.log2(l.max-l.min)),l._map=function(e){return e-this.min<<this._offset}.bind(l)}else l._map=function(e){return e?1<<this._offset:0}.bind(l);o+=_,l._offset=o}this._templates[t]={id:a,name:t,vert:r,frag:n,defines:i,attributes:e.attributes,uniforms:e.uniforms,extensions:e.extensions}}},getTemplate:function(e){return this._templates[e]},hasProgram:function(e){return void 0!==this._templates[e]},getKey:function(e,t){for(var r=this._templates[e],n=0,i=0;i<r.defines.length;++i){var a=r.defines[i],o=this._getValueFromDefineList(a.name,t);void 0!==o&&(n|=a._map(o))}return r.id+":"+n},getProgram:function(e,t,a){var r=this.getKey(e,t),n=this._cache[r];if(n)return n;var i=this._templates[e],o=h(t),s=d(i.vert,t);s=o+p(s);var l=d(i.frag,t);l=o+p(l),s=this._precision+s,l=this._precision+l;var _=(n=new b8e.GFXProgram(this._device,{vert:s,frag:l})).link();if(_){var c=s.split("\n"),u=l.split("\n"),f=Object.keys(t).length;_.forEach(function(e){var t=e.line-1,r=e.line-f,n=("vs"===e.type?c:u)[t],i=e.info||"Failed to compile "+e.type+" "+e.fileID+" (ln "+r+"): \n "+e.message+": \n  "+n;b8e.error(a+" : "+i)})}return this._cache[r]=n},_getValueFromDefineList:function(e,t){for(var r=void 0,n=t.length-1;0<=n;n--)if(void 0!==(r=t[n][e]))return r}});b8e.RC("$$b8e","$$ProgramLib",e)}(),function(){var e;if(cc.vmath){var t=cc.vmath,r=t.vec3,n=t.color4,i=t.mat4,a=i.create(),o=0;e=b8e.Object.extends({ctor:function(){var e=this;e._super();var t=b8e.RendererEnums;e._id=o++,e._priority=0,e._rect={x:0,y:0,w:1,h:1},e._color=n.create(.3,.3,.3,1),e._depth=1,e._stencil=0,e._clearFlags=t.CLEAR_COLOR|t.CLEAR_DEPTH,e._clearModel=null,e._matView=i.create(),e._matProj=i.create(),e._matViewProj=i.create(),e._matInvViewProj=i.create(),e._stages=[],e._cullingByID=!1,e._framebuffer=null,e._shadowLight=null,e._cullingMask=4294967295},getForward:function(e){return r.set(e,-this._matView.m02,-this._matView.m06,-this._matView.m10)},getPosition:function(e){return i.invert(a,this._matView),i.getTranslation(e,a)}});b8e.RC("$$b8e","$$RenderView",e)}}(),function(){var e;if(cc.vmath){var n=b8e.RecyclePool,t=cc.vmath,i=t.vec2,a=t.vec3,o=t.vec4,s=t.mat2,E=t.mat3,x=t.mat4,l=t.color3,_=t.color4,c=b8e.ProgramLib,u=b8e.RenderView,A=E.create(),F=x.create(),T=new n(function(){return{stage:null,items:null}},8),y=new n(function(){return new Float32Array(2)},8),R=new n(function(){return new Float32Array(3)},8),S=new n(function(){return new Float32Array(4)},8),D=new n(function(){return new Float32Array(9)},8),C=new n(function(){return new Float32Array(16)},8),w=new n(function(){return new Float32Array(64)},8),P=new n(function(){return new Int32Array(2)},8),B=new n(function(){return new Int32Array(3)},8),L=new n(function(){return new Int32Array(4)},8),O=new n(function(){return new Int32Array(64)},8),f={0:function(e){return e},1:function(e){return i.array(P.add(),e)},2:function(e){return a.array(B.add(),e)},3:function(e){return o.array(L.add(),e)},4:function(e){return e},5:function(e){return i.array(y.add(),e)},6:function(e){return a.array(R.add(),e)},7:function(e){return o.array(S.add(),e)},8:function(e){return l.array(R.add(),e)},9:function(e){return _.array(S.add(),e)},10:function(e){return s.array(S.add(),e)},11:function(e){return E.array(D.add(),e)},12:function(e){return x.array(C.add(),e)}},h={0:{func:function(e){for(var t=O.add(),r=0;r<e.length;++r)t[r]=e[r];return t},size:1},1:{func:function(e){for(var t=O.add(),r=0;r<e.length;++r)t[2*r]=e[r].x,t[2*r+1]=e[r].y;return t},size:2},2:{func:void 0,size:3},3:{func:function(e){for(var t=O.add(),r=0;r<e.length;++r){var n=e[r];t[4*r]=n.x,t[4*r+1]=n.y,t[4*r+2]=n.z,t[4*r+3]=n.w}return t},size:4},4:{func:function(e){for(var t=w.add(),r=0;r<e.length;++r)t[r]=e[r];return t},size:1},5:{func:function(e){for(var t=w.add(),r=0;r<e.length;++r)t[2*r]=e[r].x,t[2*r+1]=e[r].y;return t},size:2},6:{func:void 0,size:3},7:{func:function(e){for(var t=w.add(),r=0;r<e.length;++r){var n=e[r];t[4*r]=n.x,t[4*r+1]=n.y,t[4*r+2]=n.z,t[4*r+3]=n.w}return t},size:4},8:{func:void 0,size:3},9:{func:function(e){for(var t=w.add(),r=0;r<e.length;++r){var n=e[r];t[4*r]=n.r,t[4*r+1]=n.g,t[4*r+2]=n.b,t[4*r+3]=n.a}return t},size:4},10:{func:function(e){for(var t=w.add(),r=0;r<e.length;++r){var n=e[r];t[4*r]=n.m00,t[4*r+1]=n.m01,t[4*r+2]=n.m02,t[4*r+3]=n.m03}return t},size:4},11:{func:void 0,size:9},12:{func:function(e){for(var t=w.add(),r=0;r<e.length;++r){var n=e[r];t[16*r]=n.m00,t[16*r+1]=n.m01,t[16*r+2]=n.m02,t[16*r+3]=n.m03,t[16*r+4]=n.m04,t[16*r+5]=n.m05,t[16*r+6]=n.m06,t[16*r+7]=n.m07,t[16*r+8]=n.m08,t[16*r+9]=n.m09,t[16*r+10]=n.m10,t[16*r+11]=n.m11,t[16*r+12]=n.m12,t[16*r+13]=n.m13,t[16*r+14]=n.m14,t[16*r+15]=n.m15}return t},size:16}};e=b8e.Object.extends({ctor:function(e,t){var r=this;r._super(),r._device=e,r._programLib=new c(e,t.programTemplates,t.programChunks),r._opts=t,r._type2defaultValue={0:0,1:i.create(0,0),2:a.create(0,0,0),3:o.create(0,0,0,0),4:0,5:i.create(0,0),6:a.create(0,0,0),7:o.create(0,0,0,0),8:l.create(0,0,0),9:_.create(0,0,0,1),10:s.create(),11:E.create(),12:x.create(),13:t.defaultTexture,14:t.defaultTextureCube},r._stage2fn={},r._usedTextureUnits=0,r._viewPools=new n(function(){return new u},8),r._drawItemsPools=new n(function(){return{model:null,node:null,ia:null,effect:null,defines:null,uniforms:null}},100),r._stageItemsPools=new n(function(){return new n(function(){return{model:null,node:null,ia:null,effect:null,defines:null,technique:null,sortKey:-1,uniforms:null}},100)},16)},_resetTextuerUnit:function(){this._usedTextureUnits=0},_allocTextureUnit:function(){var e=this._device,t=this._usedTextureUnits;return t>=e._caps.maxTextureUnits&&console.warn("Trying to use "+t+" texture units while this GPU supports only "+e._caps.maxTextureUnits),this._usedTextureUnits+=1,t},_registerStage:function(e,t){this._stage2fn[e]=t},_reset:function(){this._viewPools.reset(),this._stageItemsPools.reset()},_requestView:function(){return this._viewPools.add()},_render:function(e,t){var r=b8e.RendererEnums,n=this._device;n.setFrameBuffer(e._framebuffer),n.setViewport(e._rect.x,e._rect.y,e._rect.w,e._rect.h);var i={};e._clearFlags&r.CLEAR_COLOR&&(i.color=[e._color.r,e._color.g,e._color.b,e._color.a]),e._clearFlags&r.CLEAR_DEPTH&&(i.depth=e._depth),e._clearFlags&r.CLEAR_STENCIL&&(i.stencil=e._stencil),n.clear(i),this._drawItemsPools.reset();for(var a=0;a<t._models.length;++a){var o=t._models.data[a];if(0!=(o._cullingMask&e._cullingMask)){var s=this._drawItemsPools.add();o.extractDrawItem(s)}}T.reset();for(var l=0;l<e._stages.length;++l){var _=e._stages[l],c=this._stageItemsPools.add();c.reset();for(var u=0;u<this._drawItemsPools.length;++u){var f=this._drawItemsPools.data[u],h=f.effect.getTechnique(_);if(h){var d=c.add();d.model=f.model,d.node=f.node,d.ia=f.ia,d.effect=f.effect,d.defines=f.defines,d.technique=h,d.sortKey=-1,d.uniforms=f.uniforms}}var p=T.add();p.stage=_,p.items=c}for(var m=0;m<T.length;++m){var v=T.data[m];(0,this._stage2fn[v.stage])(e,v.items)}},_setProperty:function(e){var t=b8e.RendererEnums,r=this._device,n=e.value;if(void 0===n&&(n=e.val),void 0===n&&(n=this._type2defaultValue[e.type]),void 0!==n)if(e.type===t.PARAM_TEXTURE_2D||e.type===t.PARAM_TEXTURE_CUBE)if(void 0!==e.size){if(e.size!==n.length)return void console.error("The length of texture array ("+n.length+") is not corrent(expect "+e.size+").");for(var i=O.add(),a=0;a<n.length;++a)i[a]=this._allocTextureUnit();r.setTextureArray(e.name,n,i)}else r.setTexture(e.name,n,this._allocTextureUnit());else{var o=void 0;if(n instanceof Float32Array||n instanceof Int32Array)return void r.setUniformDirectly(e.name,n);if(void 0!==e.size){var s=h[e.type];if(void 0===s.func)return void console.error("Uniform array of color3/int3/float3/mat3 can not be supportted!");if(64<e.size*s.size)return void console.error("Uniform array is too long!");o=s.func(n)}else{o=(0,f[e.type])(n)}r.setUniform(e.name,o)}else console.warn("Failed to set technique property "+e.name+", value not found.")},_draw:function(e){var t=this._device,r=this._programLib,n=e.node,i=e.ia,a=e.uniforms,o=e.technique,s=e.defines,l=e.effect;0<y._count&&y.reset(),0<R._count&&R.reset(),0<S._count&&S.reset(),0<D._count&&D.reset(),0<C._count&&C.reset(),0<w._count&&w.reset(),0<P._count&&P.reset(),0<B._count&&B.reset(),0<L._count&&L.reset(),0<O._count&&O.reset(),n.getWorldMatrix(F),t.setUniform("b8e_matWorld",x.array(C.add(),F));var _=E.invert(A,E.fromMat4(A,F));_&&(E.transpose(A,_),t.setUniform("b8e_matWorldIT",E.array(D.add(),A)));for(var c=a.length,u=0;u<c;u++)for(var f=a[u],h=f.length,d=0;d<h;d++){var p=f[d];this._setProperty(p)}for(var m=o._passes.length,v=0;v<m;++v){var T=o._passes[v],b=i.count;i._vertexBuffer&&t.setVertexBuffer(0,i._vertexBuffer),i._indexBuffer&&t.setIndexBuffer(i._indexBuffer),t.setPrimitiveType(i._primitiveType);var g=r.getProgram(T._programName,s,l._name);t.setProgram(g),t.setCullMode(T._cullMode),T._blend&&(t.enableBlend(),t.setBlendFuncSep(T._blendSrc,T._blendDst,T._blendSrcAlpha,T._blendDstAlpha),t.setBlendEqSep(T._blendEq,T._blendAlphaEq),t.setBlendColor32(T._blendColor)),T._depthTest&&(t.enableDepthTest(),t.setDepthFunc(T._depthFunc)),T._depthWrite&&t.enableDepthWrite(),t.setStencilTest(T._stencilTest),T._stencilTest===b8e.GFXEnums.STENCIL_ENABLE&&(t.setStencilFuncFront(T._stencilFuncFront,T._stencilRefFront,T._stencilMaskFront),t.setStencilOpFront(T._stencilFailOpFront,T._stencilZFailOpFront,T._stencilZPassOpFront,T._stencilWriteMaskFront),t.setStencilFuncBack(T._stencilFuncBack,T._stencilRefBack,T._stencilMaskBack),t.setStencilOpBack(T._stencilFailOpBack,T._stencilZFailOpBack,T._stencilZPassOpBack,T._stencilWriteMaskBack)),t.draw(i._start,b),this._resetTextuerUnit()}}});b8e.RC("$$b8e","$$BaseRenderer",e)}}(),function(){var e;if(cc.vmath){var t=cc.vmath,i=t.vec3,a=t.mat4,r=(b8e.BaseRenderer,b8e.RecyclePool),o=new Float32Array(16),s=new Float32Array(16),l=new Float32Array(16),_=new Float32Array(3),n=new Float32Array(16),c=i.create(0,0,0),u=i.create(0,0,0),f=i.create(0,0,0),v=new r(function(){return new Float32Array(16)},8);e=b8e.BaseRenderer.extends({ctor:function(e,t){var r=this;r._super(e,t),r._directionalLights=[],r._pointLights=[],r._spotLights=[],r._shadowLights=[],r._sceneAmbient=new Float32Array([0,0,0]),r._numLights=0,r._defines={},r._registerStage("shadowcast",r._shadowStage.bind(r)),r._registerStage("opaque",r._opaqueStage.bind(r)),r._registerStage("transparent",r._transparentStage.bind(r))},sceneAmbient:{get:function(){var e=this._sceneAmbient;return cc.color(255*e.r,255*e.g,255*e.b,255)},set:function(e){this._sceneAmbient[0]=e.r/255,this._sceneAmbient[1]=e.g/255,this._sceneAmbient[2]=e.b/255}},reset:function(){this._reset()},render:function(e){this._reset(),this._updateLights(e);for(var t=this._device._gl.canvas,r=0;r<e._cameras.length;++r){var n=this._requestView(),i=t.width,a=t.height;e._cameras.data[r].extractView(n,i,a)}this._viewPools.sort(function(e,t){return e._priority-t._priority});for(var o=0;o<this._viewPools.length;++o){var s=this._viewPools.data[o];this._render(s,e)}},renderCamera:function(e,t){this._reset();var r=this._device._gl.canvas,n=r.width,i=r.height,a=this._requestView();e.extractView(a,n,i),this._render(a,t)},_updateLights:function(e){var t=b8e.RendererEnums;this._directionalLights.length=0,this._pointLights.length=0,this._spotLights.length=0,this._shadowLights.length=0;for(var r=e._lights,n=0;n<r.length;++n){var i=r.data[n];if(i.update(this._device),i.shadowType!==t.SHADOW_NONE){this._shadowLights.push(i);var a=this._requestView();i.extractView(a,["shadowcast"])}i._type===t.LIGHT_DIRECTIONAL?this._directionalLights.push(i):i._type===t.LIGHT_POINT?this._pointLights.push(i):this._spotLights.push(i)}this._updateDefines(),this._numLights=r._count},_updateDefines:function(){var e=this._defines;e._NUM_DIR_LIGHTS=Math.min(4,this._directionalLights.length),e._NUM_POINT_LIGHTS=Math.min(4,this._pointLights.length),e._NUM_SPOT_LIGHTS=Math.min(4,this._spotLights.length),e._NUM_SHADOW_LIGHTS=Math.min(4,this._shadowLights.length)},_submitLightsUniforms:function(){var e=this._device;if(e.setUniform("b8e_sceneAmbient",this._sceneAmbient),v.reset(),0<this._directionalLights.length){for(var t=v.add(),r=v.add(),n=0;n<this._directionalLights.length;++n){var i=this._directionalLights[n],a=4*n;t.set(i._directionUniform,a),r.set(i._colorUniform,a)}e.setUniform("b8e_dirLightDirection",t),e.setUniform("b8e_dirLightColor",r)}if(0<this._pointLights.length){for(var o=v.add(),s=v.add(),l=0;l<this._pointLights.length;++l){var _=this._pointLights[l],c=4*l;o.set(_._positionUniform,c),o[3+c]=_._range,s.set(_._colorUniform,c)}e.setUniform("b8e_pointLightPositionAndRange",o),e.setUniform("b8e_pointLightColor",s)}if(0<this._spotLights.length){for(var u=v.add(),f=v.add(),h=v.add(),d=0;d<this._spotLights.length;++d){var p=this._spotLights[d],m=4*d;u.set(p._positionUniform,m),u[3+m]=p._range,f.set(p._directionUniform,m),f[3+m]=p._spotUniform[0],h.set(p._colorUniform,m),h[3+m]=p._spotUniform[1]}e.setUniform("b8e_spotLightPositionAndRange",u),e.setUniform("b8e_spotLightDirection",f),e.setUniform("b8e_spotLightColor",h)}},_submitShadowStageUniforms:function(e){var t=e._shadowLight;this._device.setUniform("b8e_minDepth",t.shadowMinDepth),this._device.setUniform("b8e_maxDepth",t.shadowMaxDepth),this._device.setUniform("b8e_bias",t.shadowBias),this._device.setUniform("b8e_depthScale",t.shadowDepthScale)},_submitOtherStagesUniforms:function(){for(var e=0;e<this._shadowLights.length;++e){var t=this._shadowLights[e];this._device.setUniform("b8e_lightViewProjMatrix_"+e,a.array(n,t.viewProjMatrix)),this._device.setUniform("b8e_minDepth_"+e,t.shadowMinDepth),this._device.setUniform("b8e_maxDepth_"+e,t.shadowMaxDepth),this._device.setUniform("b8e_bias_"+e,t.shadowBias),this._device.setUniform("b8e_depthScale_"+e,t.shadowDepthScale),this._device.setUniform("b8e_darkness_"+e,t.shadowDarkness),this._device.setUniform("b8e_frustumEdgeFalloff_"+e,t.frustumEdgeFalloff)}},_updateShaderDefines:function(e){var t=e.defines;t[t.length]=this._defines},_sortItems:function(e){e.sort(function(e,t){var r=e.technique,n=t.technique;return r._layer!==n._layer?r._layer-n._layer:r._passes.length!==n._passes.length?r._passes.length-n._passes.length:e.sortKey-t.sortKey})},_shadowStage:function(e,t){this._device.setUniform("b8e_lightViewProjMatrix",a.array(l,e._matViewProj)),this._submitShadowStageUniforms(e);for(var r=0;r<t.length;++r){var n=t.data[r];this._programLib._getValueFromDefineList("_SHADOW_CASTING",n.defines)&&(this._updateShaderDefines(n),this._draw(n))}},_drawItems:function(e,t){var r=this._shadowLights;if(0===r.length&&0===this._numLights)for(var n=0;n<t.length;++n){var i=t.data[n];this._draw(i)}else for(var a=0;a<t.length;++a){for(var o=t.data[a],s=0;s<r.length;++s){var l=r[s];this._device.setTexture("_shadowMap_"+s,l.shadowMap,this._allocTextureUnit())}this._updateShaderDefines(o),this._draw(o)}},_opaqueStage:function(e,t){e.getPosition(c),this._device.setUniform("b8e_matView",a.array(o,e._matView)),this._device.setUniform("b8e_matpProj",a.array(s,e._matProj)),this._device.setUniform("b8e_matViewProj",a.array(l,e._matViewProj)),this._device.setUniform("b8e_cameraPos",i.array(_,c)),this._submitLightsUniforms(),this._submitOtherStagesUniforms(),this._drawItems(e,t)},_transparentStage:function(e,t){e.getPosition(c),e.getForward(u),this._device.setUniform("b8e_matView",a.array(o,e._matView)),this._device.setUniform("b8e_matpProj",a.array(s,e._matProj)),this._device.setUniform("b8e_matViewProj",a.array(l,e._matViewProj)),this._device.setUniform("b8e_cameraPos",i.array(_,c)),this._submitLightsUniforms(),this._submitOtherStagesUniforms();for(var r=0;r<t.length;++r){var n=t.data[r];n.node.getWorldPosition(f),i.sub(f,f,c),n.sortKey=-i.dot(f,u)}this._sortItems(t),this._drawItems(e,t)}});b8e.RC("$$b8e","$$ForwardRenderer",e)}}(),function(){function e(e,t){var r=this;r._texture=null,r._labelInfo=t,r._char=e,r._hash=null,r._data=null,r._canvas=null,r._context=null,r._width=0,r._height=0,r._hash=e.charCodeAt(0)+t.hash}e.prototype={constructor:e,updateRenderData:function(){this._updateProperties(),this._updateTexture()},_updateProperties:function(){var e=this;e._texture=b8e.Texture2D.get(),e._data=cc.Label._canvasPool.get(),e._canvas=e._data.canvas,e._context=e._data.context;var t=e._labelInfo;e._context.font=t.fontDesc;var r=cc.textUtils.safeMeasureText(e._context,e._char);if(e._width=r>>0,e._height=t.fontSize+2,t.isOutlined){var n=t.margin;e._width+=2*n,e._height+=2*n}e._canvas.width!==e._width&&(e._canvas.width=e._width),e._canvas.height!==e._height&&(e._canvas.height=e._height),e._texture.initWithElement(e._canvas,!0)},_updateTexture:function(){var e=this,t=e._context,r=e._labelInfo,n=e._canvas.width,i=e._canvas.height,a=r.color;t.textAlign="center",t.textBaseline="middle",t.clearRect(0,0,n,i),t.fillStyle="rgba("+a.r+", "+a.g+", "+a.b+", 0.005)",t.fillRect(0,0,n,i),t.font=r.fontDesc;var o=.5*n,s=.5*i+(b8e.isRuntime?-4:1);if(t.lineJoin="round",t.fillStyle="rgba("+a.r+", "+a.g+", "+a.b+", 1)",r.isOutlined){var l=r.margin;s+=l;var _=r.out||cc.Color.WHITE;t.strokeStyle="rgba("+_.r+", "+_.g+", "+_.b+", "+_.a/255+")",t.lineWidth=2*l,t.strokeText(e._char,o,s)}t.fillText(e._char,o,s),e._texture.handleLoadedTexture()},destroy:function(){this._texture.release(),this._texture=null,cc.Label._canvasPool.put(this._data),this._data=null}},b8e.FontLetter=e;b8e.LetterInfo=function(){var e=this;e.char="",e.valid=!0,e.x=0,e.y=0,e.line=0,e.hash=""};b8e.FontLetterDefinition=function(){var e=this;e.u=0,e.v=0,e.w=0,e.h=0,e.texture=null,e.offsetX=0,e.offsetY=0,e.valid=!1,e.xAdvance=0}}(),function(){function e(e,t){var r=this;b8e.SHC(r);var n=new b8e.RenderTexture2D;n._id="FontAtlas_"+e,n._format=b8e.TextureFormat.RGBA8,n.initWithSize(t,t),n.textureValidate(r),r._texture=n,r._x=2,r._y=2,r._nexty=2,r._width=t,r._height=t,r._letterDefinitions={},r._lettersInfo=[]}e.prototype={constructor:e,insertLetterTexture:function(e){var t=this,r=e._texture,n=r.width,i=r.height;if(t._x+n+2>t._width&&(t._x=2,t._y=t._nexty),t._y+i>t._nexty&&(t._nexty=t._y+i+2),t._nexty>t._height)return null;t._texture.drawTextureAt(r,t._x,t._y),t._dirty=!0;var a=new b8e.FontLetterDefinition;return a.u=t._x,a.v=t._y,a.texture=t._texture,a.valid=!0,a.w=e._width,a.h=e._height,a.xAdvance=e._width,t._x+=n+2,t._letterDefinitions[e._hash]=a},reset:function(){var e=this;e._x=2,e._y=2,e._nexty=2;for(var t=e._letterDefinitions,r=0,n=t.length;r<n;r++){var i=t[r];i.valid&&i.destroy()}e._letterDefinitions={}},destroy:function(){this.reset(),this._texture.release(),this._texture=null},getLetter:function(e){return this._letterDefinitions[e]},addLetterDefinitions:function(e,t){this._letterDefinitions[e]=t},cloneLetterDefinition:function(){var e={};for(var t in this._letterDefinitions){var r=new b8e.FontLetterDefinition;cc.js.mixin(r,this._letterDefinitions[t]),e[t]=r}return e},assignLetterDefinitions:function(e){for(var t in this._letterDefinitions){var r=e[t],n=this._letterDefinitions[t];cc.js.mixin(n,r)}},scaleFontLetterDefinition:function(e){for(var t in this._letterDefinitions){var r=this._letterDefinitions[t];r.w*=e,r.h*=e,r.offsetX*=e,r.offsetY*=e,r.xAdvance*=e}},getLetterDefinitionForChar:function(e,t){var r=e.charCodeAt(0)+t.hash,n=this._letterDefinitions[r];if(!n){var i=new b8e.FontLetter(e,t);i.updateRenderData(),n=this.insertLetterTexture(i),i.destroy()}return n}},b8e.FontAtlas=e}(),function(){var e,T=cc.rect(),F=[],b=[],i=cc.size(),y=cc.size(),n=b8e.AssemblerUtils.fillMeshVertices,a=e=b8e.BaseFontAssembler.extends({_fontAtlas:null,_fontAtlasMap:null,_atlasSize:2048,_comp:null,_numberOfLines:0,_textDesiredHeight:0,_letterOffsetY:0,_tailoredTopY:0,_tailoredBottomY:0,_bmfontScale:1,_lineBreakWithoutSpaces:!1,_lineSpacing:0,_string:"",_fontSize:0,_originFontSize:0,_hAlign:0,_vAlign:0,_spacingX:0,_lineHeight:0,_overflow:0,_isWrapText:!1,_labelWidth:0,_labelHeight:0,_maxLineWidth:0,_fontFamily:"",_isBold:!1,_labelInfo:null,_defaultName:null,ctor:function(){this._super(),this._fontAtlasMap={},this._labelInfo={fontSize:0,lineHeight:0,hash:"",fontFamily:"",fontDesc:"",hAlign:0,vAlign:0,color:null,isOutlined:!1,out:null,margin:0,isBold:!1},this._defaultName="default"},_getAssemblerData:function(e){var t=this,r=e._fontAtlasName;if(r||(e._fontAtlasName=r=t._defaultName),t._fontAtlas=t._fontAtlasMap[r],!t._fontAtlas){var n=t._atlasSize||a.ATLAS_SIZE,i=b8e.GLUtil.getMaxTextureSize();i<n&&(n=i),t._fontAtlas=t._fontAtlasMap[r]=new b8e.FontAtlas(r,n)}return t._fontAtlas._texture},updateRenderData:function(e){var t=this;if(e._renderData.vertDirty&&t._comp!==e&&t._fontAtlas){(t._comp=e)._atlasOverflow=!1,t._updateFontFamily(e),t._labelInfo.fontFamily=t._fontFamily,t._updateProperties(),t._labelInfo.fontDesc=t._getFontDesc(),t._updateContent(),t._comp._actualFontSize=t._fontSize,t._comp.node.setContentSize(y),t._comp._renderData.vertDirty=t._comp._renderData.uvDirty=!1;var r=t._comp._atlasOverflow;if(t._comp=null,t._fontAtlas=null,r){var n=e._fontAtlasName;n+="+",e._fontAtlasName=n,e._updateRenderData(!0,!0)}}},_updateFontScale:function(){this._bmfontScale=this._fontSize/this._originFontSize},_updateProperties:function(){var e=this,t=e._comp,r=cc.Label.Overflow;e._string=t.string,e._fontSize=t.fontSize,e._originFontSize=e._fontSize,y.width=t.node._contentSize.width,y.height=t.node._contentSize.height,e._hAlign=t.horizontalAlign,e._vAlign=t.verticalAlign,e._spacingX=t.spacingX,e._overflow=t.overflow,e._lineHeight=t._lineHeight,e._isBold=t._isBold,e._overflow===r.NONE?e._isWrapText=!1:e._overflow===r.RESIZE_HEIGHT?e._isWrapText=!0:e._isWrapText=t.enableWrapText;var n=t.getComponent(cc.LabelOutline);n&&n.enabled?(e._labelInfo.isOutlined=!0,e._labelInfo.margin=n.width,e._labelInfo.out=n.color,e._labelInfo.out.a=n.color.a*t.node.color.a/255):(e._labelInfo.isOutlined=!1,e._labelInfo.margin=0),e._labelInfo.lineHeight=e._lineHeight,e._labelInfo.fontSize=e._fontSize,e._labelInfo.fontFamily=e._fontFamily,e._labelInfo.color=t.node.color,e._labelInfo.isBold=e._isBold,e._labelInfo.hash=e._computeHash(e._labelInfo),e._setupBMFontOverflowMetrics()},_updateFontFamily:function(e){e.useSystemFont?this._fontFamily=e.fontFamily:e.font?e.font._nativeAsset&&(this._fontFamily=e.font._nativeAsset):this._fontFamily=b8e.macro.DEFAULT_FONT_FAMILY},_computeHash:function(e){var t=e.color.toHEX("#rrggbb"),r="";return e.isOutlined&&(r=e.out.toHEX("#rrggbb")),""+e.fontSize+e.fontFamily+t+r+(e.isBold?1:0)},_getFontDesc:function(){var e=this._fontSize+"px ";return e+=this._fontFamily,this._isBold&&(e="bold "+e),e},_updateContent:function(){this._updateFontScale(),this._alignText()},_multilineTextWrap:function(e){var t=this,r=t._string.length,n=0,i=0,a=0,o=0,s=0,l=0,_=0,c=null,u=cc.v2(0,0);t._updateFontScale();for(var f=cc.textUtils,h=0;h<r;){var d=t._string.charAt(h);if("\n"!==d){for(var p=e.call(t,t._string,h,r),m=l,v=_,T=s,b=i,g=!1,E=0;E<p;++E){var x=h+E;if("\r"!==(d=t._string.charAt(x)))if(c=t._fontAtlas.getLetterDefinitionForChar(d,t._labelInfo)){var A=b+c.offsetX*t._bmfontScale;if(t._isWrapText&&0<t._maxLineWidth&&0<i&&A+c.w*t._bmfontScale>t._maxLineWidth&&!f.isUnicodeSpace(d)){F[F.length]=s,n++,i=s=0,a-=t._lineHeight*t._bmfontScale+t._lineSpacing,g=!0;break}u.x=A,u.y=a-c.offsetY*t._bmfontScale,t._recordLetterInfo(u,d,x,n),b+=c.xAdvance*t._bmfontScale+t._spacingX,T=u.x+c.w*t._bmfontScale,m<u.y&&(m=u.y),v>u.y-c.h*t._bmfontScale&&(v=u.y-c.h*t._bmfontScale)}else t._recordPlaceholderInfo(x,d),t._comp._atlasOverflow=!0;else t._recordPlaceholderInfo(x,d)}g||(i=b,l<m&&(l=m),v<_&&(_=v),o<(s=T)&&(o=s),h+=p)}else F[F.length]=s,n++,i=s=0,a-=t._lineHeight*t._bmfontScale+t._lineSpacing,t._recordPlaceholderInfo(h,d),h++}return F[F.length]=s,t._numberOfLines=n+1,t._textDesiredHeight=t._numberOfLines*t._lineHeight*t._bmfontScale,1<t._numberOfLines&&(t._textDesiredHeight+=(t._numberOfLines-1)*t._lineSpacing),y.width=t._labelWidth,y.height=t._labelHeight,t._labelWidth<=0&&(y.width=parseFloat(o.toFixed(2))),t._labelHeight<=0&&(y.height=parseFloat(t._textDesiredHeight.toFixed(2))),t._tailoredTopY=y.height,(t._tailoredBottomY=0)<l&&(t._tailoredTopY=y.height+l),_<-t._textDesiredHeight&&(t._tailoredBottomY=t._textDesiredHeight+_),!0},_getFirstWordLen:function(e,t,r){var n=this,i=cc.textUtils,a=e.charAt(t);if(i.isUnicodeCJK(a)||"\n"===a||i.isUnicodeSpace(a))return 1;var o=1,s=n._fontAtlas.getLetterDefinitionForChar(a,n._labelInfo);if(!s)return o;for(var l=s.xAdvance*n._bmfontScale+n._spacingX,_=t+1;_<r&&(a=e.charAt(_),s=n._fontAtlas.getLetterDefinitionForChar(a,n._labelInfo));++_){if(l+s.offsetX*n._bmfontScale+s.w*n._bmfontScale>n._maxLineWidth&&!i.isUnicodeSpace(a)&&0<n._maxLineWidth)return o;if(l+=s.xAdvance*n._bmfontScale+n._spacingX,"\n"===a||i.isUnicodeSpace(a)||i.isUnicodeCJK(a))break;o++}return o},_multilineTextWrapByWord:function(){return this._multilineTextWrap(this._getFirstWordLen)},_multilineTextWrapByChar:function(){return this._multilineTextWrap(this._getFirstCharLen)},_recordPlaceholderInfo:function(e,t){var r=this._fontAtlas._lettersInfo;if(e>=r.length){var n=new b8e.LetterInfo;r[r.length]=n}var i=r[e];i.char=t,i.hash=t.charCodeAt(0)+this._labelInfo.hash,i.valid=!1},_recordLetterInfo:function(e,t,r,n){var i=this._fontAtlas._lettersInfo;if(r>=i.length){var a=new b8e.LetterInfo;i[i.length]=a}var o=(t=t.charCodeAt(0))+this._labelInfo.hash,s=i[r],l=this._fontAtlas.getLetter(o);s.line=n,s.char=t,s.hash=o,s.valid=l&&l.valid,s.x=e.x,s.y=e.y},_alignText:function(){var e=this;e._textDesiredHeight=0,F.length=0,e._lineBreakWithoutSpaces?e._multilineTextWrapByChar():e._multilineTextWrapByWord(),e._computeAlignmentOffset(),e._updateQuads()},_scaleFontSizeDown:function(e){var r=!0;e||(r=!(e=.1)),t._fontSize=e,r&&this._updateContent()},_isVerticalClamp:function(){return t._textDesiredHeight>y.height},_isHorizontalClamp:function(){return!1},_isHorizontalClamped:function(e,t){var r=F[t],n=e>y.width||e<0;return(!this._isWrapText||r>y.width)&&n},_updateQuads:function(){var e=this,t=e._fontAtlas,r=cc.Label.Overflow,n=e._fontAtlas._texture,i=e._comp.node,a=e._comp._renderData;a.dataLength=a.vertexCount=a.indiceCount=0;for(var o=i._anchorPoint.x*y.width,s=i._anchorPoint.y*y.height,l=!0,_=0,c=e._string.length;_<c;++_){var u=t._lettersInfo[_];if(u.valid){var f=t.getLetter(u.hash);if(f){T.height=f.h,T.width=f.w,T.x=f.u,T.y=f.v;var h=u.y+e._letterOffsetY;if(0<e._labelHeight){if(h>e._tailoredTopY){var d=h-e._tailoredTopY;T.y+=d,T.height-=d,h-=d}h-f.h*e._bmfontScale<e._tailoredBottomY&&(T.height=h<e._tailoredBottomY?0:h-e._tailoredBottomY)}var p=u.line,m=u.x+f.w/2*e._bmfontScale+b[p];if(0<e._labelWidth&&e._isHorizontalClamped(m,p))if(e._overflow===r.CLAMP)T.width=0;else if(e._overflow===r.SHRINK){if(y.width>f.w){l=!1;break}T.width=0}if(0<T.height&&0<T.width){var v=u.x+b[u.line];e.appendQuad(a,n,T,!1,v-o,h-s,e._bmfontScale)}}}}return l},_computeAlignmentOffset:function(){var e=this;b.length=0;var t=cc.macro;switch(e._hAlign){case t.TextAlignment.LEFT:for(var r=0;r<e._numberOfLines;++r)b[b.length]=0;break;case t.TextAlignment.CENTER:for(var n=0,i=F.length;n<i;n++)b[b.length]=(y.width-F[n])/2;break;case t.TextAlignment.RIGHT:for(var a=0,o=F.length;a<o;a++)b[b.length]=y.width-F[a]}switch(e._vAlign){case t.VerticalTextAlignment.TOP:e._letterOffsetY=y.height;break;case t.VerticalTextAlignment.CENTER:e._letterOffsetY=(y.height+e._textDesiredHeight)/2-(e._lineHeight-e._fontSize)/2;break;case t.VerticalTextAlignment.BOTTOM:e._letterOffsetY=(y.height+e._textDesiredHeight)/2-(e._lineHeight-e._fontSize)}},_setupBMFontOverflowMetrics:function(){var e=this,t=cc.Label.Overflow,r=y.width,n=y.height;e._overflow===t.RESIZE_HEIGHT&&(n=0),e._overflow===t.NONE&&(n=r=0),e._labelWidth=r,e._labelHeight=n,i.width=r,i.height=n,e._maxLineWidth=r},createData:function(e){return e.requestRenderData()},fillBuffers:function(e,t){var r=e.node;n(r,t._meshBuffer,e._renderData,r._color._val)},appendQuad:function(e,t,r,n,i,a,o){var s=e.dataLength;e.dataLength+=4,e.vertexCount=e.dataLength,e.indiceCount=e.dataLength/2*3;var l=e._data,_=t.width,c=t.height,u=r.width,f=r.height,h=void 0,d=void 0,p=void 0,m=void 0;n?(h=r.x/_,p=(r.x+f)/_,d=(r.y+u)/c,m=r.y/c,l[s].u=h,l[s].v=m,l[s+1].u=h,l[s+1].v=d,l[s+2].u=p,l[s+2].v=m,l[s+3].u=p,l[s+3].v=d):(h=r.x/_,p=(r.x+u)/_,d=(r.y+f)/c,m=r.y/c,l[s].u=h,l[s].v=d,l[s+1].u=p,l[s+1].v=d,l[s+2].u=h,l[s+2].v=m,l[s+3].u=p,l[s+3].v=m),l[s].x=i,l[s].y=a-f*o,l[s+1].x=i+u*o,l[s+1].y=a-f*o,l[s+2].x=i,l[s+2].y=a,l[s+3].x=i+u*o,l[s+3].y=a},dumpInfo:function(){var e="";for(var t in this._fontAtlasMap)e+="\n"+t;return e}});a.ATLAS_SIZE=2048,b8e.letterAssembler=new a,b8e.RC("$$b8e","$$FontAssembler",e)}(),function(){var r=0,i={};b8e.RendererConfig={addStage:function(e){if(void 0===i[e]){var t=1<<r;i[e]=t,r+=1}},stageID:function(e){var t=i[e];return void 0===t?-1:t},stageIDs:function(e){for(var t=0,r=0;r<e.length;++r){var n=i[e[r]];void 0!==n&&(t|=n)}return t}}}(),function(){var e;(e=b8e.Object.extends({ctor:function(e){var t=this;t._super(),t.program=t._programName=e,t._cullMode=b8e.GFXEnums.CULL_BACK,t._blend=!1,t._blendEq=b8e.GFXEnums.BLEND_FUNC_ADD,t._blendAlphaEq=b8e.GFXEnums.BLEND_FUNC_ADD,t._blendSrc=b8e.GFXEnums.BLEND_SRC_ALPHA,t._blendDst=b8e.GFXEnums.BLEND_ONE_MINUS_SRC_ALPHA,t._blendSrcAlpha=b8e.GFXEnums.BLEND_SRC_ALPHA,t._blendDstAlpha=b8e.GFXEnums.BLEND_ONE_MINUS_SRC_ALPHA,t._blendColor=4294967295,t._depthTest=!1,t._depthWrite=!1,t._depthFunc=b8e.GFXEnums.DS_FUNC_LESS,t._stencilTest=b8e.GFXEnums.STENCIL_INHERIT,t._stencilFuncFront=b8e.GFXEnums.DS_FUNC_ALWAYS,t._stencilRefFront=0,t._stencilMaskFront=255,t._stencilFailOpFront=b8e.GFXEnums.STENCIL_OP_KEEP,t._stencilZFailOpFront=b8e.GFXEnums.STENCIL_OP_KEEP,t._stencilZPassOpFront=b8e.GFXEnums.STENCIL_OP_KEEP,t._stencilWriteMaskFront=255,t._stencilFuncBack=b8e.GFXEnums.DS_FUNC_ALWAYS,t._stencilRefBack=0,t._stencilMaskBack=255,t._stencilFailOpBack=b8e.GFXEnums.STENCIL_OP_KEEP,t._stencilZFailOpBack=b8e.GFXEnums.STENCIL_OP_KEEP,t._stencilZPassOpBack=b8e.GFXEnums.STENCIL_OP_KEEP,t._stencilWriteMaskBack=255},setCullMode:function(e){var t=0<arguments.length&&void 0!==e?e:b8e.GFXEnums.CULL_BACK;this._cullMode=t},setBlend:function(e,t,r,n,i,a,o,s){var l=0<arguments.length&&void 0!==e&&e,_=1<arguments.length&&void 0!==t?t:b8e.GFXEnums.BLEND_FUNC_ADD,c=2<arguments.length&&void 0!==r?r:b8e.GFXEnums.BLEND_SRC_ALPHA,u=3<arguments.length&&void 0!==n?n:b8e.GFXEnums.BLEND_ONE_MINUS_SRC_ALPHA,f=4<arguments.length&&void 0!==i?i:b8e.GFXEnums.BLEND_FUNC_ADD,h=5<arguments.length&&void 0!==a?a:b8e.GFXEnums.BLEND_SRC_ALPHA,d=6<arguments.length&&void 0!==o?o:b8e.GFXEnums.BLEND_ONE_MINUS_SRC_ALPHA,p=7<arguments.length&&void 0!==s?s:4294967295,m=this;m._blend=l,m._blendEq=_,m._blendSrc=c,m._blendDst=u,m._blendAlphaEq=f,m._blendSrcAlpha=h,m._blendDstAlpha=d,m._blendColor=p},setDepth:function(e,t,r){var n=0<arguments.length&&void 0!==e&&e,i=1<arguments.length&&void 0!==t&&t,a=2<arguments.length&&void 0!==r?r:b8e.GFXEnums.DS_FUNC_LESS;this._depthTest=n,this._depthWrite=i,this._depthFunc=a},setStencilFront:function(e,t,r,n,i,a,o,s){var l=0<arguments.length&&void 0!==e?e:b8e.GFXEnums.STENCIL_INHERIT,_=1<arguments.length&&void 0!==t?t:b8e.GFXEnums.DS_FUNC_ALWAYS,c=2<arguments.length&&void 0!==r?r:0,u=3<arguments.length&&void 0!==n?n:255,f=4<arguments.length&&void 0!==i?i:b8e.GFXEnums.STENCIL_OP_KEEP,h=5<arguments.length&&void 0!==a?a:b8e.GFXEnums.STENCIL_OP_KEEP,d=6<arguments.length&&void 0!==o?o:b8e.GFXEnums.STENCIL_OP_KEEP,p=7<arguments.length&&void 0!==s?s:255,m=this;m._stencilTest=l,m._stencilFuncFront=_,m._stencilRefFront=c,m._stencilMaskFront=u,m._stencilFailOpFront=f,m._stencilZFailOpFront=h,m._stencilZPassOpFront=d,m._stencilWriteMaskFront=p},setStencilEnabled:function(e){null==e&&(e=b8e.GFXEnums.STENCIL_INHERIT),this._stencilTest=e},setStencilBack:function(e,t,r,n,i,a,o,s){var l=0<arguments.length&&void 0!==e?e:b8e.GFXEnums.STENCIL_INHERIT,_=1<arguments.length&&void 0!==t?t:b8e.GFXEnums.DS_FUNC_ALWAYS,c=2<arguments.length&&void 0!==r?r:0,u=3<arguments.length&&void 0!==n?n:255,f=4<arguments.length&&void 0!==i?i:b8e.GFXEnums.STENCIL_OP_KEEP,h=5<arguments.length&&void 0!==a?a:b8e.GFXEnums.STENCIL_OP_KEEP,d=6<arguments.length&&void 0!==o?o:b8e.GFXEnums.STENCIL_OP_KEEP,p=7<arguments.length&&void 0!==s?s:255,m=this;m._stencilTest=l,m._stencilFuncBack=_,m._stencilRefBack=c,m._stencilMaskBack=u,m._stencilFailOpBack=f,m._stencilZFailOpBack=h,m._stencilZPassOpBack=d,m._stencilWriteMaskBack=p}})).poolCall=!0,b8e.RC("$$b8e","$$RenderPass",e)}(),function(){var e,a=b8e.RendererConfig,o=0;(e=b8e.Object.extends({ctor:function(e,t,r){var n=2<arguments.length&&void 0!==r?r:0,i=this;i._super(),i._id=o++,i.stages=e,i._stageIDs=a.stageIDs(e),i._passes=t,i._layer=n},setStages:function(e){this._stageIDs=a.stageIDs(e)},passes:{get:function(){return this._passes}},stageIDs:{get:function(){return this._stageIDs}}})).poolCall=!0,b8e.RC("$$b8e","$$RenderTechnique",e)}();(function(){var e,i=b8e.RendererConfig,d=b8e.RenderPass,p=b8e.RenderTechnique;if(cc.valueTypes){var t=cc.valueTypes,r=t.Vec2,n=t.Vec3,a=t.Vec4,o=t.Color,s=t.Mat4,l=cc.Object,_={};_[Number]=function(e){return e||0},_[Boolean]=function(e){return e||!1},_[r]=function(e){return e?cc.v2(e[0],e[1]):cc.v2()},_[n]=function(e){return e?cc.v3(e[0],e[1],e[2]):cc.v3()},_[a]=function(e){return e?cc.v4(e[0],e[1],e[2],e[3]):cc.v4()},_[o]=function(e){return e?cc.color(255*e[0],255*e[1],255*e[2],255*(e[3]||1)):cc.color()},_[s]=function(e){return e?cc.mat4(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]):cc.mat4()},_[l]=function(){return null};var c={0:Number,1:r,2:n,3:a,4:Number,5:r,6:n,7:a,8:o,9:o,12:s,number:Number,boolean:Boolean,default:l},u={};u[Number]=4,u[r]=5,u[n]=6,u[a]=7,u[o]=9,u[s]=12;var f=function(e){return c[e]||c.default},m=e=b8e.Object.extends({ctor:function(e,t){var r=this;r._super(),r._name=e,r.techniques=r._techniques=t,r._properties={},r._propertyList=[],r._defines={},r._dependencies=[]},addProperty:function(e,t){if(!this._properties[e]){this._properties[e]=t;var r=this._propertyList;r[r.length]=t}},clear:function(){this._techniques.length=0,this._propertyList.length=0,this._properties={},this._defines={}},getDefaultTechnique:function(){return this._techniques[0]},getTechnique:function(e){var t=i.stageID(e);if(-1===t)return null;for(var r=0;r<this._techniques.length;++r){var n=this._techniques[r];if(n.stageIDs&t)return n}return null},getProperty:function(e){return this._properties[e]?this._properties[e].value:(b8e.warn(this._name+" : Failed to get property "+e+", property not found."),null)},setProperty:function(e,t){this._properties[e]?this._properties[e].value=t:b8e.warn(this._name+" : Failed to set property "+e+", property not found.")},getDefine:function(e){var t=this._defines[e];return void 0===t&&b8e.warn(this._name+" : Failed to get define "+e+", define not found."),t},define:function(e,t){void 0!==this._defines[e]?this._defines[e]=t:b8e.warn(this._name+" : Failed to set define "+e+", define not found.")},extractProperties:function(e){var t=0<arguments.length&&void 0!==e?e:{};return Object.assign(t,this._properties),t},extractDefines:function(e){var t=0<arguments.length&&void 0!==e?e:{};return Object.assign(t,this._defines),t},extractDependencies:function(e){for(var t=0<arguments.length&&void 0!==e?e:{},r=0;r<this._dependencies.length;++r){var n=this._dependencies[r];t[n.define]=n.extension}return t}});m.poolCall=!0;var v=function(e){return e.map(function(e){return Object.assign({},e)})},T=function(e){return _[f(e)]},b=function(e){var t=[],r=b8e.renderer._forward._programLib;return e.techniques.forEach(function(e){e.passes.forEach(function(e){t.push(r.getTemplate(e.program))})}),t},g=function(){function l(e,t,r){return{type:t,displayName:e,instanceType:f(t),value:T(t)(r)}}return function(a,o){var s={};o.forEach(function(e){e.uniforms.forEach(function(e){e.property&&(s[e.name]=l(e.displayName,e.type,e.value))})});function e(t){var e=a.properties[t],r=void 0;if(void 0!==e.tech&&void 0!==e.pass){var n=a.techniques[e.tech].passes[e.pass].program;r=o.find(function(e){return e.name===n}).uniforms.find(function(e){return e.name===t})}else for(var i=0;i<o.length&&!(r=o[i].uniforms.find(function(e){return e.name===t}));i++);if(!r)return b8e.warn(a.name+" : illegal property: "+t),"continue";s[t]=l(e.displayName||r.displayName,e.type||r.type,e.value||r.value)}for(var t in a.properties)e(t);return s}}();m.parseEffect=function(e){for(var t=e.techniques.length,r=new Array(t),n=0;n<t;++n){for(var i=e.techniques[n],a=i.passes.length,o=new Array(a),s=0;s<a;++s){var l=i.passes[s];o[s]=new d(l.program),o[s].setDepth(l.depthTest,l.depthWrite,l.depthFunc),o[s].setCullMode(l.cullMode),o[s].setBlend(l.blend,l.blendEq,l.blendSrc,l.blendDst,l.blendAlphaEq,l.blendSrcAlpha,l.blendDstAlpha,l.blendColor),o[s].setStencilFront(l.stencilTest,l.stencilFuncFront,l.stencilRefFront,l.stencilMaskFront,l.stencilFailOpFront,l.stencilZFailOpFront,l.stencilZPassOpFront,l.stencilWriteMaskFront),o[s].setStencilBack(l.stencilTest,l.stencilFuncBack,l.stencilRefBack,l.stencilMaskBack,l.stencilFailOpBack,l.stencilZFailOpBack,l.stencilZPassOpBack,l.stencilWriteMaskBack)}r[n]=new p(i.stages,o,i.layer)}var _=b(e),c=g(e,_),u={},f={};_.forEach(function(e){e.uniforms.forEach(function(e){var t=e.name,r=u[t]=Object.assign({},e);r.value=T(e.type)(e.value),c[t]&&(r.type=c[t].type,r.value=c[t].value)}),e.defines.forEach(function(e){f[e.name]=T(e.type)()})});var h=_.reduce(function(e,t){return e.concat(t.extensions)},[]);return h=v(h),new m(e.name,r,u,f,h)},b8e.RC("$$b8e","$$RenderEffect",e)}})(),function(){var e;(e=b8e.Object.extends({ctor:function(e,t,r){var n=this;n._super(),null==r&&(r=b8e.GFXEnums.PT_TRIANGLES),n._vertexBuffer=e,n._indexBuffer=t,n._primitiveType=r,n._start=0,n._count=-1},count:{get:function(){return-1!==this._count?this._count:this._indexBuffer?this._indexBuffer.count:this._vertexBuffer.count}}})).poolCall=!0,b8e.RC("$$b8e","$$InputAssembler",e)}(),function(){var i=b8e.RendererConfig,a=b8e.RenderScene,e=b8e.InputAssembler,t=b8e.RenderPass,r=b8e.RenderTechnique,n=b8e.RenderEffect;b8e.renderer={Texture2D:null,InputAssembler:e,Pass:t,Technique:r,Effect:n,renderEngine:null,canvas:null,device:null,scene:null,drawCalls:0,_handle:null,_cameraNode:null,_camera:null,_forward:null,initWebGL:function(e,t){this.Texture2D=b8e.RenderTexture2D,this.canvas=e;var r=void 0;IS_RUNTIME&&"undefined"!=typeof CC_NATIVERENDERER?this.device=r=window.device:this.device=r=new b8e.GFXDevice(e,t),b8e.renderType===b8e.RenderType.WEBGL&&(b8e.btfbc=b8e.isMobile&&!0),r.ext("WEBGL_compressed_texture_astc")&&(b8e.astc=!0),r.ext("WEBGL_compressed_texture_pvrtc")&&(b8e.pvrtc=!0),r.ext("WEBGL_compressed_texture_etc1")&&(b8e.etc1=!0),r.ext("WEBGL_compressed_texture_etc")&&(b8e.etc2=!0),b8e.isWeChatGame&&b8e.isMobile&&(b8e.os===b8e.OS.ANDROID&&(b8e.astc=!0),b8e.os===b8e.OS.IOS&&(b8e.astc=!0)),this.scene=new a,this._handle=new b8e.ModelBatcher(r,this.scene),b8e.RenderFlow.init(this._handle);var n={programTemplates:b8e.ShaderLib.templates,programChunks:b8e.ShaderLib.chunks};this._forward=new b8e.ForwardRenderer(r,n),i.addStage("shadowcast"),i.addStage("opaque"),i.addStage("transparent")},initCanvas:function(e){var t=o("./canvas"),r=o("./canvas/Texture2D"),n=o("./canvas/Device");this.Device=n,this.Texture2D=r,this.canvas=e,this.device=new n(e),this._camera={a:1,b:0,c:0,d:1,tx:0,ty:0},this._handle=new t.RenderComponentHandle(this.device,this._camera),b8e.RenderFlow.init(this._handle),this._forward=new t.ForwardRenderer},updateCameraViewport:function(){cc.director&&cc.director.getScene().setScale(1,1,1);if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS){var e=cc.view.getViewportRect();this.device.setViewport(e.x,e.y,e.width,e.height),this._camera.a=cc.view.getScaleX(),this._camera.d=cc.view.getScaleY(),this._camera.tx=e.x,this._camera.ty=e.y+e.height}},render:function(e){this.device._stats.drawcalls=0,e&&(b8e.RenderFlow.visit(e),this._forward.render(this.scene),this.drawCalls=this.device._stats.drawcalls)},clear:function(){this._handle.reset(),this._forward._reset()}}}(),b8e.SpriteShader={name:"sprite",vert:"\n            attribute vec3 a_position;\n            attribute lowp vec4 a_color;\n            uniform mat4 b8e_matViewProj;\n            uniform mat4 b8e_matWorld;\n            attribute lowp vec2 a_uv0;\n            varying lowp vec2 v_uv0;\n            varying lowp vec4 v_color;\n            void main () {\n                mat4 mvp = b8e_matViewProj;\n                v_uv0 = a_uv0;\n                v_color = a_color;\n                gl_Position = mvp * vec4(a_position, 1);\n            }\n        ",frag:"\n            uniform vec4 colorTransfrom;\n            uniform int isGray;\n            uniform int useColorTransfrom;\n            uniform sampler2D texture;\n            varying lowp vec2 v_uv0;\n            varying lowp vec4 v_color;\n            void main () {\n                vec4 color = v_color;\n                vec2 uv0 = v_uv0;\n                color *= texture2D(texture, uv0);\n                if(useColorTransfrom > 0) {\n                    if(isGray > 0) {\n                        float gray = colorTransfrom.x * color.r + colorTransfrom.y * color.g + colorTransfrom.z * color.b;\n                        color = vec4(gray, gray, gray, color.a);\n                    }\n                }\n                gl_FragColor = color;\n            }\n        ",defines:[]},b8e.SpineShader={name:"spine",vert:"\n            attribute vec3 a_position;\n            attribute lowp vec4 a_color;\n            uniform int useModel;\n            uniform mat4 b8e_matViewProj;\n            uniform mat4 b8e_matWorld;\n            // uniform int useTexture;\n            // #ifdef GL_FRAGMENT_PRECISION_HIGH\n            //     attribute highp vec2 a_uv0;\n            //     varying highp vec2 v_uv0;\n            // #else\n                attribute lowp vec2 a_uv0;\n                varying lowp vec2 v_uv0;\n            // #endif\n            varying lowp vec4 v_color;\n            void main () {\n                mat4 mvp;\n                if(useModel > 0) {\n                    mvp = b8e_matViewProj * b8e_matWorld;\n                }\n                else {\n                    mvp = b8e_matViewProj;\n                }\n                // if(useTexture > 0) {\n                    v_uv0 = a_uv0;\n                // }\n                v_color = a_color;\n                gl_Position = mvp * vec4(a_position, 1);\n            }\n        ",frag:"\n            // uniform int useTexture;\n            uniform vec4 colorTransfrom;\n            uniform int useAlphaTest;\n            uniform int isGray;\n            uniform int useColorTransfrom;\n            uniform sampler2D texture;\n            uniform float alphaThreshold;\n            // #ifdef GL_FRAGMENT_PRECISION_HIGH\n            //     varying highp vec2 v_uv0;\n            // #else\n                varying lowp vec2 v_uv0;\n            // #endif\n            void alphaTest (in vec4 color) {\n                if(useAlphaTest > 0) {\n                    if (color.a < alphaThreshold) discard;\n                }\n            }\n            void alphaTest (in float alpha) {\n                if(useAlphaTest > 0) {\n                    if (alpha < alphaThreshold) discard;\n                }\n            }\n            varying lowp vec4 v_color;\n            void main () {\n                vec4 color = v_color;\n                // if(useTexture > 0) {\n                    vec2 uv0 = v_uv0;\n                    color *= texture2D(texture, uv0);\n                // }\n                alphaTest(color);\n                if(useColorTransfrom > 0) {\n                    if(isGray > 0) {\n                        float gray = colorTransfrom.x * color.r + colorTransfrom.y * color.g + colorTransfrom.z * color.b;\n                        color = vec4(gray, gray, gray, color.a);\n                    }\n                }\n                gl_FragColor = color;\n            }\n        ",defines:[]},b8e.BCSpriteShader={name:"bc-sprite",vert:"\n            attribute vec3 a_position;\n            attribute lowp vec4 a_color;\n            uniform int useModel;\n            uniform mat4 b8e_matViewProj;\n            uniform mat4 b8e_matWorld;\n            // uniform int useTexture;\n            // #ifdef GL_FRAGMENT_PRECISION_HIGH\n            //     attribute highp vec2 a_uv0;\n            //     varying highp vec2 v_uv0;\n            // #else\n                attribute lowp vec2 a_uv0;\n                varying lowp vec2 v_uv0;\n            // #endif\n            varying lowp vec4 v_color;\n            void main () {\n                mat4 mvp;\n                if(useModel > 0) {\n                    mvp = b8e_matViewProj * b8e_matWorld;\n                }\n                else {\n                    mvp = b8e_matViewProj;\n                }\n                // if(useTexture > 0) {\n                    v_uv0 = a_uv0;\n                // }\n                v_color = a_color;\n                gl_Position = mvp * vec4(a_position, 1);\n            }\n        ",frag:"\n            // uniform int useTexture;\n            uniform vec4 colorTransfrom;\n            uniform int useAlphaTest;\n            uniform int isGray;\n            uniform int useColorTransfrom;\n            uniform int enableBlockCompact;\n            uniform int etc1Format;\n            uniform sampler2D texture;\n            uniform vec4 textureSize;\n            uniform vec4 btfDescSize;\n            uniform sampler2D btfDescTexture0;\n            uniform sampler2D btfDescTexture1;\n            uniform float alphaThreshold;\n            // #ifdef GL_FRAGMENT_PRECISION_HIGH\n            //     varying highp vec2 v_uv0;\n            // #else\n                varying lowp vec2 v_uv0;\n            // #endif\n            int mod(int a, int b) {\n                int c = a / b;\n                int r = a - c * b;\n                return r;\n            }\n            vec2 getBlockUV(const in float x, const in float y) {\n                float texWidth = textureSize.x;\n                float texHeight = textureSize.y;\n                float texScaleX = textureSize.z;\n                float texScaleY = textureSize.w;\n                float descWidth = btfDescSize.x;\n                float descHeight = btfDescSize.y;\n                float blockSize = btfDescSize.z;\n                //\u539f\u56fe\u6bd4\u4f8b\u7cfb\u6570\n                float orgX = x * texScaleX;\n                float orgY = y * texScaleY;\n                float blockX = orgX * descWidth;\n                float blockY = orgY * descHeight;\n                //\u83b7\u53d6\u5185\u90e8\u533a\u57df\u503c\uff0c\u907f\u514d\u5dee\u503c\u540e\u503c\u504f\u5dee\uff0c\u8be6\u8be2@Sunny3D\uff01\n                float descX = (float(int(blockX)) + 0.5) / descWidth;\n                float descY = (float(int(blockY)) + 0.5) / descHeight;\n                //\u5757\u8d34\u56fe\u91c7\u6837\u504f\u79fb\n                float texOffsetX = (blockX - float(int(blockX))) * blockSize;\n                float texOffsetY = (blockY - float(int(blockY))) * blockSize;\n                vec4 color0 = texture2D(btfDescTexture0, vec2(descX, descY));\n                //\u504f\u79fb\u5bbd\u9ad8\u4ece0\u5f00\u59cb\uff0c\u53ea\u4fdd\u75590-15\u537316\u4e2a\u6b63\u6574\u6570\n                float offsetW = color0.b * 256.0 + 1.0;\n                if(offsetW < 2.0) {//\u900f\u660e\u533a\u5757\n                    return vec2(-1.0, -1.0);\n                }\n                vec4 color1 = texture2D(btfDescTexture1, vec2(descX, descY));\n                int offsetXVal = int(color1.r * 256.0);\n                int offsetYVal = int(color1.g * 256.0);\n                float offsetH = color1.b * 256.0 + 1.0;\n                //\u5757\u8d34\u56fe\u504f\u79fb\n                float offsetX = float(int(offsetXVal / 16));\n                float offsetY = float(int(offsetYVal / 16));\n                //\u8fb9\u754c\u6df7\u5408\uff0c\u5728\u6ca1\u8bbe\u7f6eblockSpace\u65f6\uff0c\u907f\u514d\u4ea4\u754c\u5904\u7ebf\u6761\uff0c\u8be6\u8be2@Sunny3D\uff01\n                if(texOffsetX >= 0.0 && texOffsetX < 1.0) {\n                    texOffsetX = 0.5;\n                }\n                if(texOffsetY >= 0.0 && texOffsetY < 1.0) {\n                    texOffsetY = 0.5;\n                }\n                if(texOffsetX >= blockSize - 1.0 && texOffsetX < blockSize) {\n                    texOffsetX = blockSize - 0.5;\n                }\n                if(texOffsetY >= blockSize - 1.0 && texOffsetY < blockSize) {\n                    texOffsetY = blockSize - 0.5;\n                }\n                //\u975e\u533a\u95f4\uff0c\u5728\u6ca1\u8bbe\u7f6eblockSpace\u65f6\uff0c\u9700\u8981\u589e\u52a00.5\uff0c\u8be6\u8be2@Sunny3D\uff01\n                if(texOffsetX < offsetX + 0.5 || texOffsetY < offsetY + 0.5 || texOffsetX >= offsetX + offsetW - 0.5 || texOffsetY >= offsetY + offsetH - 0.5) {//\u533a\u5757\u5185\u900f\u660e\n                    return vec2(-1.0, -1.0);\n                }\n                //\u5757\u504f\u79fb\n                float blockOffsetX = float(mod(offsetXVal, 16));\n                float blockOffsetY = float(mod(offsetYVal, 16));\n                //\u6e32\u67d3\u56fe\u5750\u6807\n                float texBlockX = float(int(color0.r * 256.0)) * blockSize;\n                float texBlockY = float(int(color0.g * 256.0)) * blockSize;\n                float texX = texBlockX + blockOffsetX - offsetX + texOffsetX;\n                float texY = texBlockY + blockOffsetY - offsetY + texOffsetY;\n                float tx = texX / texWidth;\n                float ty = texY / texHeight;\n                return vec2(tx, ty);\n            }\n            void alphaTest (in vec4 color) {\n                if(useAlphaTest > 0) {\n                    if (color.a < alphaThreshold) discard;\n                }\n            }\n            void alphaTest (in float alpha) {\n                if(useAlphaTest > 0) {\n                    if (alpha < alphaThreshold) discard;\n                }\n            }\n            varying lowp vec4 v_color;\n            void main () {\n                vec4 color = v_color;\n                // if(useTexture > 0) {\n                    vec2 uv0 = v_uv0;\n                    if(enableBlockCompact > 0) {\n                        uv0 = getBlockUV(uv0.x, uv0.y);\n                    }\n                    if (uv0.x > -1.0) {\n                        color *= texture2D(texture, uv0);\n                        if(etc1Format > 0) {\n                            color.a *= texture2D(texture, uv0 + vec2(0, 0.5)).r;\n                        }\n                    }\n                    else {\n                        color = vec4(0, 0, 0, 0);\n                    }\n                // }\n                alphaTest(color);\n                if(useColorTransfrom > 0) {\n                    if(isGray > 0) {\n                        float gray = colorTransfrom.x * color.r + colorTransfrom.y * color.g + colorTransfrom.z * color.b;\n                        color = vec4(gray, gray, gray, color.a);\n                    }\n                }\n                gl_FragColor = color;\n            }\n        ",defines:[]},b8e.LabelShader={name:"label",vert:"\n            attribute vec3 a_position;\n            attribute lowp vec4 a_color;\n            uniform mat4 b8e_matViewProj;\n            uniform mat4 b8e_matWorld;\n            attribute lowp vec2 a_uv0;\n            varying lowp vec2 v_uv0;\n            varying lowp vec4 v_color;\n            void main () {\n                mat4 mvp;\n                mvp = b8e_matViewProj;\n                v_uv0 = a_uv0;\n                v_color = a_color;\n                gl_Position = mvp * vec4(a_position, 1);\n            }\n        ",frag:"\n            uniform int useColorTransfrom;\n            uniform int isGray;\n            uniform vec4 colorTransfrom;\n            uniform sampler2D texture;\n            varying lowp vec2 v_uv0;\n            varying lowp vec4 v_color;\n            void main () {\n                vec4 color = v_color;\n                vec2 uv0 = v_uv0;\n                //color *= texture2D(texture, uv0);//\u8fb9\u7f18\u53d1\u865a\uff0c\u6682\u4e0d\u91c7\u7528\uff0c\u8be6\u8be2@Sunny\uff01\n                color = texture2D(texture, uv0);\n                color.a *= v_color.a;\n                if(useColorTransfrom > 0) {\n                    if(isGray > 0) {\n                        float gray = colorTransfrom.x * color.r + colorTransfrom.y * color.g + colorTransfrom.z * color.b;\n                        color = vec4(gray, gray, gray, color.a);\n                    }\n                }\n                gl_FragColor = color;\n            }\n        ",defines:[]},b8e.GraphicsShader={name:"graphics",vert:"\n            attribute vec3 a_position;\n            attribute lowp vec4 a_color;\n            uniform mat4 b8e_matViewProj;\n            uniform mat4 b8e_matWorld;\n            varying lowp vec4 v_color;\n            void main () {\n                mat4 mvp = b8e_matViewProj * b8e_matWorld;\n                v_color = a_color;\n                gl_Position = mvp * vec4(a_position, 1);\n            }\n        ",frag:"\n            uniform int useAlphaTest;\n            uniform float alphaThreshold;\n            void alphaTest (in vec4 color) {\n                if (color.a < alphaThreshold) discard;\n            }\n            void alphaTest (in float alpha) {\n                if (alpha < alphaThreshold) discard;\n            }\n            varying lowp vec4 v_color;\n            void main () {\n                vec4 color = v_color;\n                if(useAlphaTest > 0) {\n                    alphaTest(color);\n                }\n                gl_FragColor = color;\n            }\n        ",defines:[]},b8e.ClearStencilShader={name:"clear-stencil",vert:"\n            attribute vec3 a_position;\n            void main () {\n                gl_Position = vec4(a_position, 1);\n            }\n        ",frag:"\n            void main () {\n                gl_FragColor = vec4(1.0);\n            }\n        ",defines:[]},function(){var e={chunks:{},templates:[b8e.SpriteShader,b8e.BCSpriteShader,b8e.LabelShader,b8e.GraphicsShader,b8e.ClearStencilShader,b8e.SpineShader]};b8e.ShaderLib=e}(),function(){var e;function n(e){var t="";for(var r in e)t+=r+e[r];return t}function i(e){for(var t=b8e.RendererEnums,r="",n=e.length,i=0;i<n;i++){var a=e[i],o=a.value;if(o)switch(a.type){case t.PARAM_INT:case t.PARAM_FLOAT:r+=o+";";break;case t.PARAM_INT2:case t.PARAM_FLOAT2:r+=o.x+","+o.y+";";break;case t.PARAM_INT4:case t.PARAM_FLOAT4:r+=o.x+","+o.y+","+o.z+","+o.w+";";break;case t.PARAM_COLOR4:r+=o.r+","+o.g+","+o.b+","+o.a+";";break;case t.PARAM_MAT2:r+=o.m00+","+o.m01+","+o.m02+","+o.m03+";";break;case t.PARAM_TEXTURE_2D:case t.PARAM_TEXTURE_CUBE:r+=o._id+";";break;case t.PARAM_INT3:case t.PARAM_FLOAT3:case t.PARAM_COLOR3:case t.PARAM_MAT3:case t.PARAM_MAT4:r+=JSON.stringify(o)+";"}}return r}function a(e,t){for(var r,n=e.length,i=t^n,a=0;4<=n;)r=1540483477*(65535&(r=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:i^=(255&e.charCodeAt(a+2))<<16;case 2:i^=(255&e.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}(e=b8e.PoolObject.extends({_effectAsset:null,_defines:null,_props:null,effectName:void 0,_pass:null,_mainTech:null,_effect:null,ctor:function(){this._super(),this.resetProps()},resetProps:function(){var e=this;e._dirty=!0,e._owner=null,e._defines={},e._definesDirty=!0,e._props={},e._propsDirty=!0,e._pass&&e._pass.setStencilEnabled(b8e.GFXEnums.STENCIL_INHERIT)},recycle:function(){this.resetProps(),this._super()},dispose:function(){this._pass=null,this._mainTech=null,this._effect=null,this._super()},effectAsset:{get:function(){return this._effectAsset},set:function(e){(this._effectAsset=e)||b8e.error("Can not set an empty effect asset.")}},effect:{get:function(){return this._effect}},owner:{get:function(){return this._owner}},copy:function(){},addProperty:function(e,t){this._props[e]=t.value,this._effect.addProperty(e,t)},setProperty:function(e,t,r){var n=this;n._props[e]===t&&!r||(n._props[e]=t,n._dirty=!0,n._propsDirty=!0,n._effect&&(t instanceof b8e.Texture2D?(n._effect.setProperty(e,t.getImpl()),t.getPixelFormat()===b8e.RenderTextureEnum.TEXTURE_FMT_RGBA_ETC1&&n.define("_USE_ETC1_"+e.toUpperCase(),!0)):n._effect.setProperty(e,t)))},getProperty:function(e){return this._props[e]},define:function(e,t,r){var n=this;n._defines[e]===t&&!r||(n._defines[e]=t,n._dirty=!0,n._definesDirty=!0,n._effect&&n._effect.define(e,t))},getDefine:function(e){return this._defines[e]},setDirty:function(e){this._dirty=e},updateHash:function(e){this._dirty=!1,this._definesDirty=!1,this._propsDirty=!1,this._hash=e},getHash:function(){var e=this;if(!e._dirty)return e._hash;e._dirty=!1;var t=e._effect,r="";return t&&(e._definesDirty&&(e._definesHash=n(t._defines),e._definesDirty=!1),e._propsDirty&&(e._propsHash=i(t._propertyList),e._propsDirty=!1),r+=e._definesHash,r+=e._propsHash),e._hash=a(r,666)}})).poolCall=!0,b8e.RC("$$b8e","$$Material",e)}(),function(){var e,t=e=b8e.Material.extends({ctor:function(){var e=this;e._super();var t=b8e.GFXEnums,r=e._pass=new b8e.RenderPass("sprite");r.setDepth(!1,!1),r.setCullMode(t.CULL_NONE),r.setBlend(!0,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA);var n=e._mainTech=new b8e.RenderTechnique(["opaque"],[r]);e._effect=new b8e.RenderEffect("sprite-effect",[n]),e.addProperty("texture",{name:"texture",type:13,value:null}),e.addProperty("colorTransfrom",{name:"colorTransfrom",type:7,value:new cc.Vec4}),e.addProperty("useColorTransfrom",{name:"useColorTransfrom",type:0,value:0}),e.addProperty("isGray",{name:"isGray",type:0,value:0})},resetProps:function(){var e=this;e._super(),e._texture=null,e.setProperty("texture",null),e.setProperty("colorTransfrom",new cc.Vec4),e.setProperty("useColorTransfrom",0),e.setProperty("isGray",0)},setTexture:function(e){var t=this;t._texture!=e&&(t._texture&&(t._texture.unbindMaterial(t),t._texture=null),(t._texture=e)&&e.bindMaterial(t),t._updateTexture())},setColorTransfrom:function(e){if(this._colorTransfrom!=e){var t=!1;(this._colorTransfrom=e)&&(t=e.isGray);var r=this._effect;r.setProperty("useColorTransfrom",!!e),r.setProperty("isGray",t);var n=new cc.Vec4;if(e)if(t){var i=e.getMultiplierArray();n.x=i[0],n.y=i[1],n.z=i[2],n.w=i[3]}else{var a=e.getOffsetArray();n.x=a[0],n.y=a[1],n.z=a[2],n.w=a[3]}r.setProperty("colorTransfrom",n)}},_updateTexture:function(){var e=this._texture;e&&e.getImpl()?this._effect.setProperty("texture",e.getImpl()):this._effect.setProperty("texture",null)},color:{get:function(){return this._color},set:function(e){var t=this._color;t.r=e.r/255,t.g=e.g/255,t.b=e.b/255,t.a=e.a/255,this._effect.setProperty("__color",t)}},_onTextureUpdate:function(){this._updateTexture()},invalidate:function(){this.setTexture(null),this._colorTransfrom=null,this._super()}}),r=new b8e.Pool(t,2048);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$SpriteMaterial",e)}(),function(){var e,t=e=b8e.Material.extends({ctor:function(){var e=this;e._super();var t=b8e.GFXEnums,r=e._pass=new b8e.RenderPass("bc-sprite");r.setDepth(!1,!1),r.setCullMode(t.CULL_NONE),r.setBlend(!0,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA);var n=e._mainTech=new b8e.RenderTechnique(["opaque"],[r]);e._color={r:1,g:1,b:1,a:1};var i={};function a(e,t){i[e]=t}a("alphaThreshold",{name:"alphaThreshold",type:4,value:.5}),a("texture",{name:"texture",type:13,value:null}),a("btfDescSize",{name:"btfDescSize",type:7,value:new cc.Vec4}),a("colorTransfrom",{name:"colorTransfrom",type:7,value:new cc.Vec4}),a("textureSize",{name:"textureSize",type:7,value:new cc.Vec4}),a("btfDescTexture0",{name:"btfDescTexture0",type:13,value:null}),a("btfDescTexture1",{name:"btfDescTexture1",type:13,value:null}),a("useTexture",{name:"useTexture",type:0,value:1}),a("useModel",{name:"useModel",type:0,value:0}),a("useAlphaTest",{name:"useAlphaTest",type:0,value:0}),a("useColorTransfrom",{name:"useColorTransfrom",type:0,value:0}),a("isGray",{name:"isGray",type:0,value:0}),a("use2DPos",{name:"use2DPos",type:0,value:1}),a("enableBlockCompact",{name:"enableBlockCompact",type:0,value:0}),a("etc1Format",{name:"etc1Format",type:0,value:0}),a("astcFormat",{name:"astcFormat",type:0,value:0}),a("useColor",{name:"useColor",type:0,value:0});var o={};e._effect=new b8e.RenderEffect("bc-sprite-effect",[n],i,o)},resetProps:function(){this._super(),this._texture=null;var e=this._effect;e&&(e.setProperty("alphaThreshold",.5),e.setProperty("texture",null),e.setProperty("btfDescSize",new cc.Vec4),e.setProperty("colorTransfrom",new cc.Vec4),e.setProperty("textureSize",new cc.Vec4),e.setProperty("btfDescTexture0",null),e.setProperty("btfDescTexture1",null),e.setProperty("useTexture",1),e.setProperty("useModel",0),e.setProperty("useAlphaTest",0),e.setProperty("useColorTransfrom",0),e.setProperty("isGray",0),e.setProperty("use2DPos",1),e.setProperty("enableBlockCompact",0),e.setProperty("etc1Format",0),e.setProperty("astcFormat",0),e.setProperty("useColor",0))},effect:{get:function(){return this._effect}},useTexture:{get:function(){return this._effect.getProperty("useTexture")},set:function(e){this._effect.setProperty("useTexture",e)}},useModel:{get:function(){return this._effect.getProperty("useModel")},set:function(e){this._effect.setProperty("useModel",e)}},use2DPos:{get:function(){return this._effect.getProperty("use2DPos")},set:function(e){this._effect.setProperty("use2DPos",e)}},useColor:{get:function(){return this._effect.getProperty("useColor")},set:function(e){this._effect.setProperty("useColor",e)}},astcFormat:{get:function(){return this._effect.getProperty("astcFormat")},set:function(e){this._effect.setProperty("astcFormat",!!e)}},etc1Format:{get:function(){return this._effect.getProperty("etc1Format")},set:function(e){this._effect.setProperty("etc1Format",!!e)}},setTexture:function(e){var t=this;t._texture!=e&&(t._texture?b8e.warn(7004):(t._texture=e)&&(t._updateTexture(),e.bindMaterial(t)))},setColorTransfrom:function(e){if(this._colorTransfrom!=e){var t=!1;(this._colorTransfrom=e)&&(t=e.isGray);var r=this._effect;r.setProperty("useColorTransfrom",!!e),r.setProperty("isGray",t);var n=new cc.Vec4;if(e)if(t){var i=e.getMultiplierArray();n.x=i[0],n.y=i[1],n.z=i[2],n.w=i[3]}else{var a=e.getOffsetArray();n.x=a[0],n.y=a[1],n.z=a[2],n.w=a[3]}r.setProperty("colorTransfrom",n)}},_updateTexture:function(){var e=this,t=e._texture;if(t&&t.getImpl()){e.setProperty("useTexture",!0),e._effect.setProperty("texture",t.getImpl()),e.etc1Format=t._USE_RGBA_ETC1_,e.astcFormat=t._USE_RGBA_ASTC_;var r=t._ENABLE_BLOCK_COMPACT_;e.setBtfBlockData(r?t._BTF_BLOCK_DATA_:null)}else e.setProperty("useTexture",!1)},color:{get:function(){return this._color},set:function(e){var t=this._color;t.r=e.r/255,t.g=e.g/255,t.b=e.b/255,t.a=e.a/255,this._effect.setProperty("__color",t)}},setBtfBlockData:function(e){var t=this._effect,r=!1;if(e){var n=e.textures;if(n[0].getImpl()&&n[1].getImpl()){var i=e.textureSize,a=e.descSize;t.setProperty("btfDescSize",a),t.setProperty("textureSize",i),t.setProperty("btfDescTexture0",n[0].getImpl()),t.setProperty("btfDescTexture1",n[1].getImpl()),r=!0}}r||(t.setProperty("btfDescSize",new cc.Vec4),t.setProperty("textureSize",new cc.Vec4),t.setProperty("btfDescTexture0",null),t.setProperty("btfDescTexture1",null)),this._effect.setProperty("enableBlockCompact",r)},_onTextureUpdate:function(){this._updateTexture()},invalidate:function(){var e=this;e._texture&&(e._texture.unbindMaterial(e),e._texture=null),e._colorTransfrom=null,e._super()}}),r=new b8e.Pool(t,2048);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$BCSpriteMaterial",e)}(),function(){var e,t=e=b8e.Material.extends({ctor:function(){var e=this;e._super();var t=b8e.GFXEnums,r=e._pass=new b8e.RenderPass("label");r.setDepth(!1,!1),r.setCullMode(t.CULL_NONE),r.setBlend(!0,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA);var n=e._mainTech=new b8e.RenderTechnique(["opaque"],[r]);e._effect=new b8e.RenderEffect("label-effect",[n]),e.addProperty("texture",{name:"texture",type:13,value:null}),e.addProperty("colorTransfrom",{name:"colorTransfrom",type:7,value:new cc.Vec4}),e.addProperty("useColorTransfrom",{name:"useColorTransfrom",type:0,value:0}),e.addProperty("isGray",{name:"isGray",type:0,value:0})},resetProps:function(){var e=this;e._super(),e._texture=null,e.setProperty("texture",null),e.setProperty("colorTransfrom",new cc.Vec4),e.setProperty("useColorTransfrom",0),e.setProperty("isGray",0)},setTexture:function(e){var t=this;t._texture!=e&&(t._texture&&(t._texture.unbindMaterial(t),t._texture=null),(t._texture=e)&&e.bindMaterial(t),t._updateTexture())},setColorTransfrom:function(e){if(this._colorTransfrom!=e){var t=!1;(this._colorTransfrom=e)&&(t=e.isGray);var r=this._effect;r.setProperty("useColorTransfrom",!!e),r.setProperty("isGray",t);var n=new cc.Vec4;if(e)if(t){var i=e.getMultiplierArray();n.x=i[0],n.y=i[1],n.z=i[2],n.w=i[3]}else{var a=e.getOffsetArray();n.x=a[0],n.y=a[1],n.z=a[2],n.w=a[3]}r.setProperty("colorTransfrom",n)}},_updateTexture:function(){var e=this._texture;e&&e.getImpl()?this._effect.setProperty("texture",e.getImpl()):this._effect.setProperty("texture",null)},color:{get:function(){return this._color},set:function(e){var t=this._color;t.r=e.r/255,t.g=e.g/255,t.b=e.b/255,t.a=e.a/255,this._effect.setProperty("__color",t)}},_onTextureUpdate:function(){this._updateTexture()},invalidate:function(){this.setTexture(null),this._colorTransfrom=null,this._super()}}),r=new b8e.Pool(t,2048);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$LabelMaterial",e)}(),function(){if("undefined"!=typeof cc){var e=cc.renderEngine;if(e){var t=e.Material,i=e.renderer,r=function(n){function t(){n.call(this,!1);var e=b8e.GFXEnums,t=new i.Pass("gray_sprite");t.setDepth(!1,!1),t.setCullMode(e.CULL_NONE),t.setBlend(e.BLEND_FUNC_ADD,e.BLEND_SRC_ALPHA,e.BLEND_ONE_MINUS_SRC_ALPHA,e.BLEND_FUNC_ADD,e.BLEND_SRC_ALPHA,e.BLEND_ONE_MINUS_SRC_ALPHA);var r=new i.Technique(["transparent"],[{name:"texture",type:i.PARAM_TEXTURE_2D},{name:"color",type:i.PARAM_COLOR4}],[t]);this._color={r:1,g:1,b:1,a:1},this._effect=new i.Effect([r],{__color:this._color},[{name:"useColor",value:!1}]),this._mainTech=r,this._texture=null}n&&(t.__proto__=n),(t.prototype=Object.create(n&&n.prototype)).constructor=t;var e={effect:{configurable:!0},texture:{configurable:!0},color:{configurable:!0}};return e.effect.get=function(){return this._effect},e.texture.get=function(){return this._texture},e.texture.set=function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},e.color.get=function(){return this._color},e.color.set=function(e){var t=this._color;t.r=e.r/255,t.g=e.g/255,t.b=e.b/255,t.a=e.a/255,this._effect.setProperty("__color",t)},t.prototype.clone=function(){var e=new t;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.color=this.color,e.updateHash(),e},Object.defineProperties(t.prototype,e),t}(t);b8e.GraySpriteMaterial=r}}}(),function(){var e,t=e=b8e.Material.extends({ctor:function(){this._super();var e=b8e.GFXEnums,t=this._pass=new b8e.RenderPass("clear-stencil");t.setDepth(!1,!1),t.setCullMode(e.CULL_NONE),t.setBlend(!0,e.BLEND_FUNC_ADD,e.BLEND_SRC_ALPHA,e.BLEND_ONE_MINUS_SRC_ALPHA,e.BLEND_FUNC_ADD,e.BLEND_SRC_ALPHA,e.BLEND_ONE_MINUS_SRC_ALPHA);var r=this._mainTech=new b8e.RenderTechnique(["opaque"],[t]);this._effect=new b8e.RenderEffect("clear-stencil-effect",[r],{},{})},resetProps:function(){this._super()},effect:{get:function(){return this._effect}}}),r=new b8e.Pool(t,2048);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$ClearStencilMaterial",e)}(),function(){var e,t=e=b8e.Material.extends({ctor:function(){var e=this;e._super();var t=b8e.GFXEnums,r=e._pass=new b8e.RenderPass("graphics");r.setDepth(!1,!1),r.setCullMode(t.CULL_NONE),r.setBlend(!0,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA,t.BLEND_FUNC_ADD,t.BLEND_SRC_ALPHA,t.BLEND_ONE_MINUS_SRC_ALPHA);var n=e._mainTech=new b8e.RenderTechnique(["opaque"],[r]);e._effect=new b8e.RenderEffect("graphics-effect",[n]),e.addProperty("alphaThreshold",{name:"alphaThreshold",type:4,value:.5}),e.addProperty("useAlphaTest",{name:"useAlphaTest",type:0,value:0})},resetProps:function(){this._super(),this.setProperty("alphaThreshold",.5),this.setProperty("useAlphaTest",0)},useModel:!0}),r=new b8e.Pool(t,2048);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$GraphicsMaterial",e)}(),function(){b8e.RENDER_VERSION="4.1.5";var e=b8e.EngineRender={};b8e.SHC(e);var t=e.onInit=function(){b8e.RENDER_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aRender\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nTween:V"+b8e.RENDER_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(t),b8e.onInit(t,e)}()},{}]},{},[1]);(function(){return function i(o,f,s){function l(t,e){if(!f[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(d)return d(t,!0);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}var n=f[t]={exports:{}};o[t][0].call(n.exports,function(e){return l(o[t][1][e]||e)},n,n.exports,i,o,f,s)}return f[t].exports}for(var d="function"==typeof require&&require,e=0;e<s.length;e++)l(s[e]);return l}})()({1:[function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var t={assign:function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==(void 0===r?"undefined":i(r)))throw new TypeError(r+"must be non-object");for(var a in r)n(r,a)&&(e[a]=r[a])}}return e},shrinkBuf:function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}},r={arraySet:function(e,t,r,a,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+a),n);else for(var i=0;i<a;i++)e[n+i]=t[r+i]},flattenChunks:function(e){var t,r,a,n,i,o;for(t=a=0,r=e.length;t<r;t++)a+=e[t].length;for(o=new Uint8Array(a),t=n=0,r=e.length;t<r;t++)i=e[t],o.set(i,n),n+=i.length;return o}},a={arraySet:function(e,t,r,a,n){for(var i=0;i<a;i++)e[n+i]=t[r+i]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(e),b8e.zipCommon=t})(),function(){var s=b8e.zipCommon,n=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var l=new s.Buf8(256),e=0;e<256;e++)l[e]=252<=e?6:248<=e?5:240<=e?4:224<=e?3:192<=e?2:1;l[254]=l[254]=1;var t={};function d(e,t){if(t<65537&&(e.subarray&&i||!e.subarray&&n))return String.fromCharCode.apply(null,s.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}t.string2buf=function(e){var t,r,a,n,i,o=e.length,f=0;for(n=0;n<o;n++)55296==(64512&(r=e.charCodeAt(n)))&&n+1<o&&56320==(64512&(a=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(a-56320),n++),f+=r<128?1:r<2048?2:r<65536?3:4;for(t=new s.Buf8(f),n=i=0;i<f;n++)55296==(64512&(r=e.charCodeAt(n)))&&n+1<o&&56320==(64512&(a=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(a-56320),n++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t},t.buf2binstring=function(e){return d(e,e.length)},t.binstring2buf=function(e){for(var t=new s.Buf8(e.length),r=0,a=t.length;r<a;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,a,n,i,o=t||e.length,f=new Array(2*o);for(r=a=0;r<o;)if((n=e[r++])<128)f[a++]=n;else if(4<(i=l[n]))f[a++]=65533,r+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&r<o;)n=n<<6|63&e[r++],i--;1<i?f[a++]=65533:n<65536?f[a++]=n:(n-=65536,f[a++]=55296|n>>10&1023,f[a++]=56320|1023&n)}return d(f,a)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+l[e[r]]>t?r:t},b8e.zipString=t}(),function(){b8e.adler32=function(e,t,r,a){for(var n=65535&e|0,i=e>>>16&65535|0,o=0;0!==r;){for(r-=o=2e3<r?2e3:r;i=i+(n=n+t[a++]|0)|0,--o;);n%=65521,i%=65521}return n|i<<16|0}}(),function(){var f=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();b8e.crc32=function(e,t,r,a){var n=f,i=a+r;e^=-1;for(var o=a;o<i;o++)e=e>>>8^n[255&(e^t[o])];return-1^e}}(),b8e.inffast=function(e,t){var r,a,n,i,o,f,s,l,d,c,h,u,v,b,m,w,g,p,_,k,y,A,x,S,U;r=e.state,a=e.next_in,S=e.input,n=a+(e.avail_in-5),i=e.next_out,U=e.output,o=i-(t-e.avail_out),f=i+(e.avail_out-257),s=r.dmax,l=r.wsize,d=r.whave,c=r.wnext,h=r.window,u=r.hold,v=r.bits,b=r.lencode,m=r.distcode,w=(1<<r.lenbits)-1,g=(1<<r.distbits)-1;e:do{v<15&&(u+=S[a++]<<v,v+=8,u+=S[a++]<<v,v+=8),p=b[u&w];t:for(;;){if(u>>>=_=p>>>24,v-=_,0===(_=p>>>16&255))U[i++]=65535&p;else{if(!(16&_)){if(0==(64&_)){p=b[(65535&p)+(u&(1<<_)-1)];continue t}if(32&_){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}k=65535&p,(_&=15)&&(v<_&&(u+=S[a++]<<v,v+=8),k+=u&(1<<_)-1,u>>>=_,v-=_),v<15&&(u+=S[a++]<<v,v+=8,u+=S[a++]<<v,v+=8),p=m[u&g];r:for(;;){if(u>>>=_=p>>>24,v-=_,!(16&(_=p>>>16&255))){if(0==(64&_)){p=m[(65535&p)+(u&(1<<_)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(y=65535&p,v<(_&=15)&&(u+=S[a++]<<v,(v+=8)<_&&(u+=S[a++]<<v,v+=8)),s<(y+=u&(1<<_)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(u>>>=_,v-=_,(_=i-o)<y){if(d<(_=y-_)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(x=h,(A=0)===c){if(A+=l-_,_<k){for(k-=_;U[i++]=h[A++],--_;);A=i-y,x=U}}else if(c<_){if(A+=l+c-_,(_-=c)<k){for(k-=_;U[i++]=h[A++],--_;);if(A=0,c<k){for(k-=_=c;U[i++]=h[A++],--_;);A=i-y,x=U}}}else if(A+=c-_,_<k){for(k-=_;U[i++]=h[A++],--_;);A=i-y,x=U}for(;2<k;)U[i++]=x[A++],U[i++]=x[A++],U[i++]=x[A++],k-=3;k&&(U[i++]=x[A++],1<k&&(U[i++]=x[A++]))}else{for(A=i-y;U[i++]=U[A++],U[i++]=U[A++],U[i++]=U[A++],2<(k-=3););k&&(U[i++]=U[A++],1<k&&(U[i++]=U[A++]))}break}}break}}while(a<n&&i<f);a-=k=v>>3,u&=(1<<(v-=k<<3))-1,e.next_in=a,e.next_out=i,e.avail_in=a<n?n-a+5:5-(a-n),e.avail_out=i<f?f-i+257:257-(i-f),r.hold=u,r.bits=v},function(){var N=b8e.zipCommon,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],M=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];b8e.inftrees=function(e,t,r,a,n,i,o,f){var s,l,d,c,h,u,v,b,m,w=f.bits,g=0,p=0,_=0,k=0,y=0,A=0,x=0,S=0,U=0,I=0,E=null,R=0,B=new N.Buf16(16),Z=new N.Buf16(16),T=null,C=0;for(g=0;g<=15;g++)B[g]=0;for(p=0;p<a;p++)B[t[r+p]]++;for(y=w,k=15;1<=k&&0===B[k];k--);if(k<y&&(y=k),0===k)return n[i++]=20971520,n[i++]=20971520,f.bits=1,0;for(_=1;_<k&&0===B[_];_++);for(y<_&&(y=_),g=S=1;g<=15;g++)if(S<<=1,(S-=B[g])<0)return-1;if(0<S&&(0===e||1!==k))return-1;for(Z[1]=0,g=1;g<15;g++)Z[g+1]=Z[g]+B[g];for(p=0;p<a;p++)0!==t[r+p]&&(o[Z[t[r+p]]++]=p);if(u=0===e?(E=T=o,19):1===e?(E=z,R-=257,T=M,C-=257,256):(E=O,T=D,-1),g=_,h=i,x=p=I=0,d=-1,c=(U=1<<(A=y))-1,1===e&&852<U||2===e&&592<U)return 1;for(;;){for(v=g-x,m=o[p]<u?(b=0,o[p]):o[p]>u?(b=T[C+o[p]],E[R+o[p]]):(b=96,0),s=1<<g-x,_=l=1<<A;n[h+(I>>x)+(l-=s)]=v<<24|b<<16|m|0,0!==l;);for(s=1<<g-1;I&s;)s>>=1;if(0!==s?(I&=s-1,I+=s):I=0,p++,0==--B[g]){if(g===k)break;g=t[r+o[p]]}if(y<g&&(I&c)!==d){for(0===x&&(x=y),h+=_,S=1<<(A=g-x);A+x<k&&!((S-=B[A+x])<=0);)A++,S<<=1;if(U+=1<<A,1===e&&852<U||2===e&&592<U)return 1;n[d=I&c]=y<<24|A<<16|h-i|0}}return 0!==I&&(n[h+I]=g-x<<24|64<<16|0),f.bits=y,0}}(),function(){var R=b8e.zipCommon,B=b8e.adler32;b8e.ZAdler32=B;var Z=b8e.crc32;b8e.ZCrc32=Z;var T=b8e.inffast,C=b8e.inftrees,N=1,z=2,M=0,O=-2,D=1,r=852,a=592;function L(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new R.Buf16(320),this.work=new R.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function i(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=D,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new R.Buf32(r),t.distcode=t.distdyn=new R.Buf32(a),t.sane=1,t.back=-1,M):O}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,i(e)):O}function f(e,t){var r,a;return e&&e.state?(a=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?O:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,o(e))):O}function t(e,t){var r,a;return e?(a=new n,(e.state=a).window=null,(r=f(e,t))!==M&&(e.state=null),r):O}var s,l,d=!0;function F(e){if(d){var t;for(s=new R.Buf32(512),l=new R.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(C(N,e.lens,0,288,s,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;C(z,e.lens,0,32,l,0,e.work,{bits:5}),d=!1}e.lencode=s,e.lenbits=9,e.distcode=l,e.distbits=5}function H(e,t,r,a){var n,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new R.Buf8(i.wsize)),a>=i.wsize?(R.arraySet(i.window,t,r-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(a<(n=i.wsize-i.wnext)&&(n=a),R.arraySet(i.window,t,r-a,n,i.wnext),(a-=n)?(R.arraySet(i.window,t,r-a,a,0),i.wnext=a,i.whave=i.wsize):(i.wnext+=n,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=n))),0}var e={};e.inflateReset=o,e.inflateReset2=f,e.inflateResetKeep=i,e.inflateInit=function(e){return t(e,15)},e.inflateInit2=t,e.inflate=function(e,t){var r,a,n,i,o,f,s,l,d,c,h,u,v,b,m,w,g,p,_,k,y,A,x,S,U=0,I=new R.Buf8(4),E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return O;12===(r=e.state).mode&&(r.mode=13),o=e.next_out,n=e.output,s=e.avail_out,i=e.next_in,a=e.input,f=e.avail_in,l=r.hold,d=r.bits,c=f,h=s,A=M;e:for(;;)switch(r.mode){case D:if(0===r.wrap){r.mode=13;break}for(;d<16;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(2&r.wrap&&35615===l){I[r.check=0]=255&l,I[1]=l>>>8&255,r.check=Z(r.check,I,2,0),d=l=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&l)){e.msg="unknown compression method",r.mode=30;break}if(d-=4,y=8+(15&(l>>>=4)),0===r.wbits)r.wbits=y;else if(y>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<y,e.adler=r.check=1,r.mode=512&l?10:12,d=l=0;break;case 2:for(;d<16;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(r.flags=l,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&(I[0]=255&l,I[1]=l>>>8&255,r.check=Z(r.check,I,2,0)),d=l=0,r.mode=3;case 3:for(;d<32;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}r.head&&(r.head.time=l),512&r.flags&&(I[0]=255&l,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,r.check=Z(r.check,I,4,0)),d=l=0,r.mode=4;case 4:for(;d<16;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&(I[0]=255&l,I[1]=l>>>8&255,r.check=Z(r.check,I,2,0)),d=l=0,r.mode=5;case 5:if(1024&r.flags){for(;d<16;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&(I[0]=255&l,I[1]=l>>>8&255,r.check=Z(r.check,I,2,0)),d=l=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(f<(u=r.length)&&(u=f),u&&(r.head&&(y=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),R.arraySet(r.head.extra,a,i,u,y)),512&r.flags&&(r.check=Z(r.check,a,u,i)),f-=u,i+=u,r.length-=u),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===f)break e;for(u=0;y=a[i+u++],r.head&&y&&r.length<65536&&(r.head.name+=String.fromCharCode(y)),y&&u<f;);if(512&r.flags&&(r.check=Z(r.check,a,u,i)),f-=u,i+=u,y)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===f)break e;for(u=0;y=a[i+u++],r.head&&y&&r.length<65536&&(r.head.comment+=String.fromCharCode(y)),y&&u<f;);if(512&r.flags&&(r.check=Z(r.check,a,u,i)),f-=u,i+=u,y)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;d<16;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}d=l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;d<32;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}e.adler=r.check=L(l),d=l=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=o,e.avail_out=s,e.next_in=i,e.avail_in=f,r.hold=l,r.bits=d,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){l>>>=7&d,d-=7&d,r.mode=27;break}for(;d<3;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}switch(r.last=1&l,--d,3&(l>>>=1)){case 0:r.mode=14;break;case 1:if(F(r),r.mode=20,6!==t)break;l>>>=2,d-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}l>>>=2,d-=2;break;case 14:for(l>>>=7&d,d-=7&d;d<32;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&l,d=l=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(u=r.length){if(f<u&&(u=f),s<u&&(u=s),0===u)break e;R.arraySet(n,a,i,u,o),f-=u,i+=u,s-=u,o+=u,r.length-=u;break}r.mode=12;break;case 17:for(;d<14;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(r.nlen=257+(31&l),l>>>=5,d-=5,r.ndist=1+(31&l),l>>>=5,d-=5,r.ncode=4+(15&l),l>>>=4,d-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;d<3;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}r.lens[E[r.have++]]=7&l,l>>>=3,d-=3}for(;r.have<19;)r.lens[E[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,x={bits:r.lenbits},A=C(0,r.lens,0,19,r.lencode,0,r.work,x),r.lenbits=x.bits,A){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;w=(U=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,g=65535&U,!((m=U>>>24)<=d);){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(g<16)l>>>=m,d-=m,r.lens[r.have++]=g;else{if(16===g){for(S=m+2;d<S;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(l>>>=m,d-=m,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}y=r.lens[r.have-1],u=3+(3&l),l>>>=2,d-=2}else if(17===g){for(S=m+3;d<S;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}d-=m,y=0,u=3+(7&(l>>>=m)),l>>>=3,d-=3}else{for(S=m+7;d<S;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}d-=m,y=0,u=11+(127&(l>>>=m)),l>>>=7,d-=7}if(r.have+u>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;u--;)r.lens[r.have++]=y}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,x={bits:r.lenbits},A=C(N,r.lens,0,r.nlen,r.lencode,0,r.work,x),r.lenbits=x.bits,A){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,x={bits:r.distbits},A=C(z,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,x),r.distbits=x.bits,A){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=f&&258<=s){e.next_out=o,e.avail_out=s,e.next_in=i,e.avail_in=f,r.hold=l,r.bits=d,T(e,h),o=e.next_out,n=e.output,s=e.avail_out,i=e.next_in,a=e.input,f=e.avail_in,l=r.hold,d=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;w=(U=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,g=65535&U,!((m=U>>>24)<=d);){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(w&&0==(240&w)){for(p=m,_=w,k=g;w=(U=r.lencode[k+((l&(1<<p+_)-1)>>p)])>>>16&255,g=65535&U,!(p+(m=U>>>24)<=d);){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}l>>>=p,d-=p,r.back+=p}if(l>>>=m,d-=m,r.back+=m,r.length=g,0===w){r.mode=26;break}if(32&w){r.back=-1,r.mode=12;break}if(64&w){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&w,r.mode=22;case 22:if(r.extra){for(S=r.extra;d<S;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;w=(U=r.distcode[l&(1<<r.distbits)-1])>>>16&255,g=65535&U,!((m=U>>>24)<=d);){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(0==(240&w)){for(p=m,_=w,k=g;w=(U=r.distcode[k+((l&(1<<p+_)-1)>>p)])>>>16&255,g=65535&U,!(p+(m=U>>>24)<=d);){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}l>>>=p,d-=p,r.back+=p}if(l>>>=m,d-=m,r.back+=m,64&w){e.msg="invalid distance code",r.mode=30;break}r.offset=g,r.extra=15&w,r.mode=24;case 24:if(r.extra){for(S=r.extra;d<S;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===s)break e;if(u=h-s,r.offset>u){if((u=r.offset-u)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}v=u>r.wnext?(u-=r.wnext,r.wsize-u):r.wnext-u,u>r.length&&(u=r.length),b=r.window}else b=n,v=o-r.offset,u=r.length;for(s<u&&(u=s),s-=u,r.length-=u;n[o++]=b[v++],--u;);0===r.length&&(r.mode=21);break;case 26:if(0===s)break e;n[o++]=r.length,s--,r.mode=21;break;case 27:if(r.wrap){for(;d<32;){if(0===f)break e;f--,l|=a[i++]<<d,d+=8}if(h-=s,e.total_out+=h,r.total+=h,h&&(e.adler=r.check=(r.flags?Z:B)(r.check,n,h,o-h)),h=s,(r.flags?l:L(l))!==r.check){e.msg="incorrect data check",r.mode=30;break}d=l=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;d<32;){if(0===f)break e;f--,l+=a[i++]<<d,d+=8}if(l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}d=l=0}r.mode=29;case 29:A=1;break e;case 30:A=-3;break e;case 31:return-4;case 32:default:return O}return e.next_out=o,e.avail_out=s,e.next_in=i,e.avail_in=f,r.hold=l,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&H(e,e.output,e.next_out,h-e.avail_out)?(r.mode=31,-4):(c-=e.avail_in,h-=e.avail_out,e.total_in+=c,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=(r.flags?Z:B)(r.check,n,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==c&&0===h||4===t)&&A===M&&(A=-5),A)},e.inflateEnd=function(e){if(!e||!e.state)return O;var t=e.state;return t.window&&(t.window=null),e.state=null,M},e.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?O:((r.head=t).done=!1,M):O},e.inflateSetDictionary=function(e,t){var r,a=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?O:11===r.mode&&B(1,t,a,0)!==r.check?-3:H(e,t,a,a)?(r.mode=31,-4):(r.havedict=1,M):O},e.inflateInfo="pako inflate (from Nodeca project)",b8e.inflate=e}(),b8e.zipConstants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},b8e.zipMessages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},function(){b8e.zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}(),function(){b8e.gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}(),function(){var h=b8e.inflate,u=b8e.zipCommon;b8e.ZUtils=u;var v=b8e.zipString;b8e.ZStrings=v;var b=b8e.zipConstants,a=b8e.zipMessages;b8e.ZMessages=a;var n=b8e.zstream;b8e.ZStream=n;var i=b8e.gzheader,m=Object.prototype.toString;function o(e){if(!(this instanceof o))return new o(e);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;var r=h.inflateInit2(this.strm,t.windowBits);if(r!==b.Z_OK)throw new Error(a[r]);this.header=new i,h.inflateGetHeader(this.strm,this.header)}function r(e,t){var r=new o(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}o.prototype.push=function(e,t){var r,a,n,i,o,f,s=this.strm,l=this.options.chunkSize,d=this.options.dictionary,c=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?b.Z_FINISH:b.Z_NO_FLUSH,"string"==typeof e?s.input=v.binstring2buf(e):"[object ArrayBuffer]"===m.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new u.Buf8(l),s.next_out=0,s.avail_out=l),(r=h.inflate(s,b.Z_NO_FLUSH))===b.Z_NEED_DICT&&d&&(f="string"==typeof d?v.string2buf(d):"[object ArrayBuffer]"===m.call(d)?new Uint8Array(d):d,r=h.inflateSetDictionary(this.strm,f)),r===b.Z_BUF_ERROR&&!0===c&&(r=b.Z_OK,c=!1),r!==b.Z_STREAM_END&&r!==b.Z_OK)return this.onEnd(r),!(this.ended=!0);s.next_out&&(0!==s.avail_out&&r!==b.Z_STREAM_END&&(0!==s.avail_in||a!==b.Z_FINISH&&a!==b.Z_SYNC_FLUSH)||("string"===this.options.to?(n=v.utf8border(s.output,s.next_out),i=s.next_out-n,o=v.buf2string(s.output,n),s.next_out=i,s.avail_out=l-i,i&&u.arraySet(s.output,s.output,n,i,0),this.onData(o)):this.onData(u.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(c=!0)}while((0<s.avail_in||0===s.avail_out)&&r!==b.Z_STREAM_END);return r===b.Z_STREAM_END&&(a=b.Z_FINISH),a===b.Z_FINISH?(r=h.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===b.Z_OK):a!==b.Z_SYNC_FLUSH||(this.onEnd(b.Z_OK),!(s.avail_out=0))},o.prototype.onData=function(e){this.chunks.push(e)},o.prototype.onEnd=function(e){e===b.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var e={};e.Inflate=o,e.inflate=r,e.inflateRaw=function(e,t){return(t=t||{}).raw=!0,r(e,t)},e.ungzip=r,b8e.Inflate=e}(),function(){var Ae=b8e.UPNG={};Ae.log=function(){},Ae.toRGBA8=function(e){var t=e.width,r=e.height;if(null==e.tabs.acTL)return[Ae.toRGBA8.decodeImage(e.data,t,r,e).buffer];var a=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var n=void 0,i=new Uint8Array(t*r*4),o=0;o<e.frames.length;o++){var f=e.frames[o],s=f.rect.x,l=f.rect.y,d=f.rect.width,c=f.rect.height,h=Ae.toRGBA8.decodeImage(f.data,d,c,e);if(0==o?n=h:0==f.blend?Ae._copyTile(h,d,c,n,t,r,s,l,0):1==f.blend&&Ae._copyTile(h,d,c,n,t,r,s,l,1),a.push(n.buffer),n=n.slice(0),0!=f.dispose)if(1==f.dispose)Ae._copyTile(i,d,c,n,t,r,s,l,0);else if(2==f.dispose){for(var u=o-1;2==e.frames[u].dispose;)u--;n=new Uint8Array(a[u]).slice(0)}}return a},Ae.toRGBA8.decodeImage=function(e,t,r,a){var n=t*r,i=Ae.decode._getBPP(a),o=Math.ceil(t*i/8),f=new Uint8Array(4*n),s=new Uint32Array(f.buffer),l=a.ctype,d=a.depth,c=Ae._bin.readUshort;if(6==l){var h=n<<2;if(8==d)for(var u=0;u<h;u++)f[u]=e[u];if(16==d)for(var v=0;v<h;v++)f[v]=e[v<<1]}else if(2==l){var b=a.tabs.tRNS,m=-1,w=-1,g=-1;if(b&&(m=b[0],w=b[1],g=b[2]),8==d)for(var p=0;p<n;p++){var _=p<<2,k=3*p;f[_]=e[k],f[1+_]=e[1+k],f[2+_]=e[2+k],f[3+_]=255,-1!=m&&e[k]==m&&e[1+k]==w&&e[2+k]==g&&(f[3+_]=0)}if(16==d)for(var y=0;y<n;y++){var A=y<<2,x=6*y;f[A]=e[x],f[1+A]=e[2+x],f[2+A]=e[4+x],f[3+A]=255,-1!=m&&c(e,x)==m&&c(e,2+x)==w&&c(e,4+x)==g&&(f[3+A]=0)}}else if(3==l){var S=a.tabs.PLTE,U=a.tabs.tRNS,I=U?U.length:0;if(1==d)for(var E=0;E<r;E++)for(var R=E*o,B=E*t,Z=0;Z<t;Z++){var T=B+Z<<2,C=e[R+(Z>>3)]>>7-((7&Z)<<0)&1,N=3*C;f[T]=S[N],f[1+T]=S[1+N],f[2+T]=S[2+N],f[3+T]=C<I?U[C]:255}if(2==d)for(var z=0;z<r;z++)for(var M=z*o,O=z*t,D=0;D<t;D++){var L=O+D<<2,F=e[M+(D>>2)]>>6-((3&D)<<1)&3,H=3*F;f[L]=S[H],f[1+L]=S[1+H],f[2+L]=S[2+H],f[3+L]=F<I?U[F]:255}if(4==d)for(var P=0;P<r;P++)for(var G=P*o,q=P*t,K=0;K<t;K++){var j=q+K<<2,V=e[G+(K>>1)]>>4-((1&K)<<2)&15,Y=3*V;f[j]=S[Y],f[1+j]=S[1+Y],f[2+j]=S[2+Y],f[3+j]=V<I?U[V]:255}if(8==d)for(var X=0;X<n;X++){var W=X<<2,J=e[X],Q=3*J;f[W]=S[Q],f[1+W]=S[1+Q],f[2+W]=S[2+Q],f[3+W]=J<I?U[J]:255}}else if(4==l){if(8==d)for(var $=0;$<n;$++){var ee=$<<2,te=$<<1,re=e[te];f[ee]=re,f[1+ee]=re,f[2+ee]=re,f[3+ee]=e[1+te]}if(16==d)for(var ae=0;ae<n;ae++){var ne=ae<<2,ie=ae<<2,oe=e[ie];f[ne]=oe,f[1+ne]=oe,f[2+ne]=oe,f[3+ne]=e[2+ie]}}else if(0==l){var fe=a.tabs.tRNS?a.tabs.tRNS:-1;if(1==d)for(var se=0;se<n;se++){var le=255*(e[se>>3]>>7-(7&se)&1),de=le==255*fe?0:255;s[se]=de<<24|le<<16|le<<8|le}if(2==d)for(var ce=0;ce<n;ce++){var he=85*(e[ce>>2]>>6-((3&ce)<<1)&3),ue=he==85*fe?0:255;s[ce]=ue<<24|he<<16|he<<8|he}if(4==d)for(var ve=0;ve<n;ve++){var be=17*(e[ve>>1]>>4-((1&ve)<<2)&15),me=be==17*fe?0:255;s[ve]=me<<24|be<<16|be<<8|be}if(8==d)for(var we=0;we<n;we++){var ge=e[we],pe=ge==fe?0:255;s[we]=pe<<24|ge<<16|ge<<8|ge}if(16==d)for(var _e=0;_e<n;_e++){var ke=e[_e<<1],ye=c(e,_e<<1)==fe?0:255;s[_e]=ye<<24|ke<<16|ke<<8|ke}}return f},Ae.encode=function(e,t,r,a,n){null==a&&(a=0);for(var i=new Uint8Array(e[0].byteLength*e.length+100),o=[137,80,78,71,13,10,26,10],f=0;f<8;f++)i[f]=o[f];var s=8,l=Ae._bin,d=Ae.crc.crc,c=l.writeUint,h=l.writeUshort,u=l.writeASCII,v=Ae.encode.compressPNG(e,t,r,a);c(i,s,13),u(i,s+=4,"IHDR"),c(i,s+=4,t),c(i,s+=4,r),i[s+=4]=v.depth,i[++s]=v.ctype,i[++s]=0,i[++s]=0,i[++s]=0,c(i,++s,d(i,s-17,17)),c(i,s+=4,1),u(i,s+=4,"sRGB"),i[s+=4]=1,c(i,++s,d(i,s-5,5)),s+=4;var b=1<e.length;if(b&&(c(i,s,8),u(i,s+=4,"acTL"),c(i,s+=4,e.length),c(i,s+=4,0),c(i,s+=4,d(i,s-12,12)),s+=4),3==v.ctype){var m=v.plte.length;c(i,s,3*m),u(i,s+=4,"PLTE"),s+=4;for(var w=0;w<m;w++){var g=3*w,p=v.plte[w],_=255&p,k=p>>8&255,y=p>>16&255;i[s+g+0]=_,i[s+g+1]=k,i[s+g+2]=y}if(c(i,s+=3*m,d(i,s-3*m-4,3*m+4)),s+=4,v.gotAlpha){c(i,s,m),u(i,s+=4,"tRNS"),s+=4;for(var A=0;A<m;A++)i[s+A]=v.plte[A]>>24&255;c(i,s+=m,d(i,s-m-4,m+4)),s+=4}}for(var x=0,S=0;S<v.frames.length;S++){var U=v.frames[S];b&&(c(i,s,26),u(i,s+=4,"fcTL"),c(i,s+=4,x++),c(i,s+=4,U.rect.width),c(i,s+=4,U.rect.height),c(i,s+=4,U.rect.x),c(i,s+=4,U.rect.y),h(i,s+=4,n[S]),h(i,s+=2,1e3),i[s+=2]=U.dispose,i[++s]=U.blend,c(i,++s,d(i,s-30,30)),s+=4);var I=U.cimg,E=I.length;c(i,s,E+(0==S?0:4));var R=s+=4;u(i,s,0==S?"IDAT":"fdAT"),s+=4,0!=S&&(c(i,s,x++),s+=4);for(var B=0;B<E;B++)i[s+B]=I[B];c(i,s+=E,d(i,R,s-R)),s+=4}return c(i,s,0),u(i,s+=4,"IEND"),c(i,s+=4,d(i,s-4,4)),s+=4,i.buffer.slice(0,s)},Ae.encode.compressPNG=function(e,t,r,a){for(var n=Ae.encode.compress(e,t,r,a,!1),i=0;i<e.length;i++){var o=n.frames[i],f=(o.rect.width,o.rect.height),s=o.bpl,l=o.bpp,d=new Uint8Array(f*s+f);o.cimg=Ae.encode._filterZero(o.img,f,l,s,d)}return n},Ae.encode.compress=function(e,t,r,a,n){0!=a&&(e=Ae.quantize(e,a-1,n));for(var i=6,o=8,f=[0],s=4,l=!1,d={0:0},c=0;c<e.length;c++)for(var h=new Uint8Array(e[c]),u=new Uint32Array(h.buffer),v=0==c?null:new Uint32Array(e[c-1]),b=0;b<h.length;b+=4){var m=u[b>>2];(0==c||m!=v[b>>2])&&f.length<600&&null==d[m]&&(d[m]=f.length,f.push(m)),l=l||255!=h[b+3]}var w=n;l||(w=!1);var g=f.length;g<=256&&(o=g<=2?1:g<=4?2:g<=16?4:8,n&&(o=8),l=!0);for(var p=[],_=0;_<e.length;_++){var k=new Uint8Array(e[_]),y=new Uint32Array(k.buffer),A=0,x=0,S=t,U=r,I=0;if(0!=_&&!w){for(var E=n||1==_||2==p[p.length-2].dispose?1:2,R=0,B=1e9,Z=0;Z<E;Z++){new Uint8Array(e[_-1-Z]);for(var T=new Uint32Array(e[_-1-Z]),C=t,N=r,z=-1,M=-1,O=0;O<r;O++)for(var D=0;D<t;D++){var L=O*t+D;y[L]!=T[L]&&(D<C&&(C=D),z<D&&(z=D),O<N&&(N=O),M<O&&(M=O))}var F=-1==z?1:(z-C+1)*(M-N+1);F<B&&(B=F,R=Z,-1==z?(A=x=0,S=U=1):(S=z-(A=C)+1,U=M-(x=N)+1))}var H=new Uint8Array(e[_-1-R]);1==R&&(p[p.length-1].dispose=2);var P=new Uint8Array(S*U*4);new Uint32Array(P.buffer);Ae._copyTile(H,t,r,P,S,U,-A,-x,0),I=Ae._copyTile(k,t,r,P,S,U,-A,-x,3)?(Ae._copyTile(k,t,r,P,S,U,-A,-x,2),1):(Ae._copyTile(k,t,r,P,S,U,-A,-x,0),0),k=P,y=new Uint32Array(k.buffer)}var G=4*S;if(g<=256){G=Math.ceil(o*S/8);for(var q=new Uint8Array(G*U),K=0;K<U;K++){var j=K*G,V=K*S;if(1==o)for(var Y=0;Y<S;Y++)q[j+(Y>>3)]|=d[y[V+Y]]<<7-(7&Y);if(2==o)for(var X=0;X<S;X++)q[j+(X>>2)]|=d[y[V+X]]<<6-2*(3&X);if(4==o)for(var W=0;W<S;W++)q[j+(W>>1)]|=d[y[V+W]]<<4-4*(1&W);if(8==o)for(var J=0;J<S;J++)q[j+J]=d[y[V+J]]}k=q,i=3,s=1}else if(0==l&&1==e.length){for(var Q=new Uint8Array(S*U*3),$=S*U,ee=0;ee<$;ee++){var te=3*ee,re=4*ee;Q[te]=k[re],Q[1+te]=k[1+re],Q[2+te]=k[2+re]}k=Q,i=2,G=(s=3)*S}p.push({rect:{x:A,y:x,width:S,height:U},img:k,bpl:G,bpp:s,blend:I,dispose:w?1:0})}return{ctype:i,depth:o,plte:f,gotAlpha:l,frames:p}},Ae.encode._filterZero=function(e,t,r,a,n){for(var i=[],o=0;o<5;o++)if(!(5e5<t*a)||2!=o&&3!=o&&4!=o){for(var f=0;f<t;f++)Ae.encode._filterLine(n,e,f,a,r,o);if(i.push(b8e.Deflate.deflate(n)),1==r)break}for(var s=void 0,l=1e9,d=0;d<i.length;d++)i[d].length<l&&(l=i[s=d].length);return i[s]},Ae.encode._filterLine=function(e,t,r,a,n,i){var o=r*a,f=o+r,s=Ae.decode._paeth;if(e[f]=i,f++,0==i)for(var l=0;l<a;l++)e[f+l]=t[o+l];else if(1==i){for(var d=0;d<n;d++)e[f+d]=t[o+d];for(var c=n;c<a;c++)e[f+c]=t[o+c]-t[o+c-n]+256&255}else if(0==r){for(var h=0;h<n;h++)e[f+h]=t[o+h];if(2==i)for(var u=n;u<a;u++)e[f+u]=t[o+u];if(3==i)for(var v=n;v<a;v++)e[f+v]=t[o+v]-(t[o+v-n]>>1)+256&255;if(4==i)for(var b=n;b<a;b++)e[f+b]=t[o+b]-s(t[o+b-n],0,0)+256&255}else{if(2==i)for(var m=0;m<a;m++)e[f+m]=t[o+m]+256-t[o+m-a]&255;if(3==i){for(var w=0;w<n;w++)e[f+w]=t[o+w]+256-(t[o+w-a]>>1)&255;for(var g=n;g<a;g++)e[f+g]=t[o+g]+256-(t[o+g-a]+t[o+g-n]>>1)&255}if(4==i){for(var p=0;p<n;p++)e[f+p]=t[o+p]+256-s(0,t[o+p-a],0)&255;for(var _=n;_<a;_++)e[f+_]=t[o+_]+256-s(t[o+_-n],t[o+_-a],t[o+_-n-a])&255}}},Ae.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var r=t,a=0;a<8;a++)1&r?r=3988292384^r>>>1:r>>>=1;e[t]=r}return e}(),update:function(e,t,r,a){for(var n=0;n<a;n++)e=Ae.crc.table[255&(e^t[r+n])]^e>>>8;return e},crc:function(e,t,r){return 4294967295^Ae.crc.update(4294967295,e,t,r)}},Ae.quantize=function(e,t,r){for(var a=[],n=0;n<e.length;n++)a.push(Ae.quantize.alphaMul(new Uint8Array(e[n]),r));for(var i=a[0],o=i.length>>2,f=[],s=[],l=0,d=Math.max(100,10*t);;){s=[],f=[];for(var c=255-((1<<l)-1),h=1<<l>>1,u=0;u<o;u++){var v=u<<2,b=(i[v]&c)+h,m=(i[1+v]&c)+h,w=(i[2+v]&c)+h,g=(i[3+v]&c)+h,p=g<<24|w<<16|m<<8|b;if(s[p])f[s[p]].occ++;else s[p]=f.length,f.push({occ:1,r:b,g:m,b:w,a:g});if(f.length>d)break}if(!(f.length>d))break;l++}if(0==l&&f.length<=t)return e;f.sort(function(e,t){return t.occ-e.occ}),t=Math.min(t,f.length);for(var _=new Uint8Array(4*t),k=0;k<t;k++){var y=k<<2,A=f[k];_[y]=A.r,_[1+y]=A.g,_[2+y]=A.b,_[3+y]=A.a}f=_;for(var x=Math.max(1,Math.min(10,Math.floor(1024/t))),S=new Uint16Array(o),U=0;U<x;U++)Ae.quantize.kMeans(i,f,S,t,!0);Ae.quantize.applyPalette(i,f,S);for(var I=1;I<a.length;I++)Ae.quantize.kMeans(a[I],f,S,t,!1),Ae.quantize.applyPalette(a[I],f,S);for(var E=0;E<e.length;E++)a[E]=a[E].buffer;return a},Ae.quantize.alphaMul=function(e,t){for(var r=new Uint8Array(e.length),a=e.length>>2,n=0;n<a;n++){var i=n<<2,o=e[3+i];t&&(o=o<128?0:255);var f=o*(1/255);r[0+i]=e[0+i]*f,r[1+i]=e[1+i]*f,r[2+i]=e[2+i]*f,r[3+i]=o}return r},Ae.quantize.applyPalette=function(e,t,r){for(var a=r.length,n=Math.round,i=0;i<a;i++){var o=i<<2,f=r[i]<<2,s=0==t[3+f]?0:255/t[3+f];e[0+o]=n(t[0+f]*s),e[1+o]=n(t[1+f]*s),e[2+o]=n(t[2+f]*s),e[3+o]=t[3+f]}},Ae.quantize.kMeans=function(e,t,r,a,n){for(var i=r.length,o=Math.round,f=Ae.quantize.dist,s=new Uint32Array(a),l=new Uint32Array(a),d=0;d<a;d++){var c=d<<2,h=t[c],u=t[1+c],v=t[2+c],b=t[3+c],m=0;cd=1e9;for(var w=0;w<a;w++)if(w!=d){var g=f(h,u,v,b,t,w<<2);g<cd&&(m=w,cd=g)}s[d]=cd,l[d]=m}for(var p=new Uint32Array(a),_=new Uint32Array(4*a),k=0;k<i;k++){var y=k<<2,A=e[y],x=e[1+y],S=e[2+y],U=e[3+y],I=0,E=1e9;if(!((E=f(A,x,S,U,t,(I=r[k])<<2))<=s[I]>>1))for(var R=0;R<a;R++){if(f(A,x,S,U,t,R<<2)<E){if((E=B)<=s[I=R]>>1)break;var B=f(A,x,S,U,t,l[R]<<2);if(B<=s[I]>>1){I=l[R];break}}}p[r[k]=I]++;var Z=I<<2;_[Z]+=A,_[1+Z]+=x,_[2+Z]+=S,_[3+Z]+=U}if(n)for(var T=0;T<a;T++){var C=T<<2,N=1/p[T];t[C]=o(_[C]*N),t[1+C]=o(_[1+C]*N),t[2+C]=o(_[2+C]*N),t[3+C]=o(_[3+C]*N)}},Ae.quantize.dist=function(e,t,r,a,n,i){var o=n[i],f=n[i+1],s=n[i+2],l=n[i+3];return(o-e)*(o-e)+(f-t)*(f-t)+(s-r)*(s-r)+(l-a)*(l-a)},Ae.quantize.dither=function(e,t,r,a,n,i){for(var o=new Float32Array(t*r*4),f=1/16,s=Ae.quantize.dist,l=Math.round,d=t<<2,c=0;c<r;c++)for(var h=0;h<t;h++){for(var u=c*t+h,v=u<<2,b=0;b<4;b++)o[v+b]=Math.max(-8,Math.min(8,o[v+b]));for(var m=l(e[v]+o[v]),w=l(e[1+v]+o[1+v]),g=l(e[2+v]+o[2+v]),p=l(e[3+v]+o[3+v]),_=0,k=1e9,y=0;y<i;y++){var A=s(m,w,g,p,n,y<<2);A<k&&(_=y,k=A)}var x=(a[u]=_)<<2,S=m-n[x],U=w-n[1+x],I=g-n[2+x],E=p-n[3+x];o[4+v]+=7*S*f,o[4+v+1]+=7*U*f,o[4+v+2]+=7*I*f,o[4+v+3]+=7*E*f,o[v+d-4+0]+=3*S*f,o[v+d-4+1]+=3*U*f,o[v+d-4+2]+=3*I*f,o[v+d-4+3]+=3*E*f,o[v+d]+=5*S*f,o[v+d+1]+=5*U*f,o[v+d+2]+=5*I*f,o[v+d+3]+=5*E*f,o[v+d+4]+=S*f,o[v+d+4+1]+=U*f,o[v+d+4+2]+=I*f,o[v+d+4+3]+=E*f}},Ae.decode=function(e){for(var t=new Uint8Array(e),r=8,a=Ae._bin,n=a.readUshort,i=a.readUint,o={tabs:{},frames:[]},f=new Uint8Array(t.length),s=0,l=void 0,d=0;;){var c=a.readUint(t,r);r+=4;var h=a.readASCII(t,r,4);if(r+=4,"IHDR"==h)Ae.decode._IHDR(t,r,o);else if("IDAT"==h){for(var u=0;u<c;u++)f[s+u]=t[r+u];s+=c}else if("acTL"==h)o.tabs[h]={num_frames:i(t,r),num_plays:i(t,r+4)},l=new Uint8Array(t.length);else if("fcTL"==h){if(0!=d){var v=o.frames[o.frames.length-1];v.data=Ae.decode._decompress(o,l.slice(0,d),v.rect.width,v.rect.height),d=0}var b={x:i(t,r+12),y:i(t,r+16),width:i(t,r+4),height:i(t,r+8)},m=n(t,r+22);m=n(t,r+20)/(0==m?100:m);var w={rect:b,delay:Math.round(1e3*m),dispose:t[r+24],blend:t[r+25]};o.frames.push(w)}else if("fdAT"==h){for(var g=0;g<c-4;g++)l[d+g]=t[r+g+4];d+=c-4}else if("pHYs"==h)o.tabs[h]=[a.readUint(t,r),a.readUint(t,r+4),t[r+8]];else if("cHRM"==h){o.tabs[h]=[];for(var p=0;p<8;p++)o.tabs[h].push(a.readUint(t,r+4*p))}else if("tEXt"==h){null==o.tabs[h]&&(o.tabs[h]={});var _=a.nextZero(t,r),k=a.readASCII(t,r,_-r),y=a.readASCII(t,_+1,r+c-_-1);o.tabs[h][k]=y}else if("iTXt"==h){null==o.tabs[h]&&(o.tabs[h]={});var A=0,x=r;A=a.nextZero(t,x);var S=a.readASCII(t,x,A-x);t[x=A+1],t[x+1];x+=2,A=a.nextZero(t,x);a.readASCII(t,x,A-x);x=A+1,A=a.nextZero(t,x);a.readUTF8(t,x,A-x);x=A+1;var U=a.readUTF8(t,x,c-(x-r));o.tabs[h][S]=U}else if("PLTE"==h)o.tabs[h]=a.readBytes(t,r,c);else if("hIST"==h){var I=o.tabs.PLTE.length/3;o.tabs[h]=[];for(var E=0;E<I;E++)o.tabs[h].push(n(t,r+2*E))}else if("tRNS"==h)3==o.ctype?o.tabs[h]=a.readBytes(t,r,c):0==o.ctype?o.tabs[h]=n(t,r):2==o.ctype&&(o.tabs[h]=[n(t,r),n(t,r+2),n(t,r+4)]);else if("gAMA"==h)o.tabs[h]=a.readUint(t,r)/1e5;else if("sRGB"==h)o.tabs[h]=t[r];else if("bKGD"==h)0==o.ctype||4==o.ctype?o.tabs[h]=[n(t,r)]:2==o.ctype||6==o.ctype?o.tabs[h]=[n(t,r),n(t,r+2),n(t,r+4)]:3==o.ctype&&(o.tabs[h]=t[r]);else{if("IEND"==h){if(0!=d){var R=o.frames[o.frames.length-1];R.data=Ae.decode._decompress(o,l.slice(0,d),R.rect.width,R.rect.height),d=0}o.data=Ae.decode._decompress(o,f,o.width,o.height);break}Ae.log("unknown chunk type",h,c)}r+=c;a.readUint(t,r);r+=4}return delete o.compress,delete o.interlace,delete o.filter,o},Ae.decode._decompress=function(e,t,r,a){return 0==e.compress&&(t=Ae.decode._inflate(t)),0==e.interlace?t=Ae.decode._filterZero(t,e,0,r,a):1==e.interlace&&(t=Ae.decode._readInterlace(t,e)),t},Ae.decode._inflate=function(e){return b8e.Inflate.inflate(e)},Ae.decode._readInterlace=function(e,t){for(var r=t.width,a=t.height,n=Ae.decode._getBPP(t),i=n>>3,o=Math.ceil(r*n/8),f=new Uint8Array(a*o),s=0,l=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],c=[8,8,8,4,4,2,2],h=[8,8,4,4,2,2,1],u=0;u<7;){for(var v=c[u],b=h[u],m=0,w=0,g=l[u];g<a;)g+=v,w++;for(var p=d[u];p<r;)p+=b,m++;var _=Math.ceil(m*n/8);Ae.decode._filterZero(e,t,s,m,w);for(var k=0,y=l[u];y<a;){for(var A=d[u],x=s+k*_<<3;A<r;){if(1==n){var S=e[x>>3];S=S>>7-(7&x)&1,f[y*o+(A>>3)]|=S<<7-((3&A)<<0)}if(2==n){var U=e[x>>3];U=U>>6-(7&x)&3,f[y*o+(A>>2)]|=U<<6-((3&A)<<1)}if(4==n){var I=e[x>>3];I=I>>4-(7&x)&15,f[y*o+(A>>1)]|=I<<4-((1&A)<<2)}if(8<=n)for(var E=y*o+A*i,R=0;R<i;R++)f[E+R]=e[(x>>3)+R];x+=n,A+=b}k++,y+=v}m*w!=0&&(s+=w*(1+_)),u+=1}return f},Ae.decode._getBPP=function(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth},Ae.decode._filterZero=function(e,t,r,a,n){var i=Ae.decode._getBPP(t),o=Math.ceil(a*i/8),f=Ae.decode._paeth;i=Math.ceil(i/8);for(var s=0;s<n;s++){var l=r+s*o,d=l+s+1,c=e[d-1];if(0==c)for(var h=0;h<o;h++)e[l+h]=e[d+h];else if(1==c){for(var u=0;u<i;u++)e[l+u]=e[d+u];for(var v=i;v<o;v++)e[l+v]=e[d+v]+e[l+v-i]&255}else if(0==s){for(var b=0;b<i;b++)e[l+b]=e[d+b];if(2==c)for(var m=i;m<o;m++)e[l+m]=255&e[d+m];if(3==c)for(var w=i;w<o;w++)e[l+w]=e[d+w]+(e[l+w-i]>>1)&255;if(4==c)for(var g=i;g<o;g++)e[l+g]=e[d+g]+f(e[l+g-i],0,0)&255}else{if(2==c)for(var p=0;p<o;p++)e[l+p]=e[d+p]+e[l+p-o]&255;if(3==c){for(var _=0;_<i;_++)e[l+_]=e[d+_]+(e[l+_-o]>>1)&255;for(var k=i;k<o;k++)e[l+k]=e[d+k]+(e[l+k-o]+e[l+k-i]>>1)&255}if(4==c){for(var y=0;y<i;y++)e[l+y]=e[d+y]+f(0,e[l+y-o],0)&255;for(var A=i;A<o;A++)e[l+A]=e[d+A]+f(e[l+A-i],e[l+A-o],e[l+A-i-o])&255}}}return e},Ae.decode._paeth=function(e,t,r){var a=e+t-r,n=Math.abs(a-e),i=Math.abs(a-t),o=Math.abs(a-r);return n<=i&&n<=o?e:i<=o?t:r},Ae.decode._IHDR=function(e,t,r){var a=Ae._bin;r.width=a.readUint(e,t),t+=4,r.height=a.readUint(e,t),t+=4,r.depth=e[t],t++,r.ctype=e[t],t++,r.compress=e[t],t++,r.filter=e[t],t++,r.interlace=e[t],t++},Ae._bin={nextZero:function(e,t){for(;0!=e[t];)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},readUint:function(e,t){return 16777216*e[t]+(e[t+1]<<16|e[t+2]<<8|e[t+3])},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},readASCII:function(e,t,r){for(var a="",n=0;n<r;n++)a+=String.fromCharCode(e[t+n]);return a},writeASCII:function(e,t,r){for(var a=0;a<r.length;a++)e[t+a]=r.charCodeAt(a)},readBytes:function(e,t,r){for(var a=[],n=0;n<r;n++)a.push(e[t+n]);return a},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(t,r,a){for(var e="",n=void 0,i=0;i<a;i++)e+="%"+Ae._bin.pad(t[r+i].toString(16));try{n=decodeURIComponent(e)}catch(e){return Ae._bin.readASCII(t,r,a)}return n}},Ae._copyTile=function(e,t,r,a,n,i,o,f,s){for(var l=Math.min(t,n),d=Math.min(r,i),c=0,h=0,u=0;u<d;u++)for(var v=0;v<l;v++)if(h=0<=o&&0<=f?(c=u*t+v<<2,(f+u)*n+o+v<<2):(c=(-f+u)*t-o+v<<2,u*n+v<<2),0==s)a[h]=e[c],a[h+1]=e[c+1],a[h+2]=e[c+2],a[h+3]=e[c+3];else if(1==s){var b=e[c+3]*(1/255),m=e[c]*b,w=e[c+1]*b,g=e[c+2]*b,p=a[h+3]*(1/255),_=a[h]*p,k=a[h+1]*p,y=a[h+2]*p,A=1-b,x=b+p*A,S=0==x?0:1/x;a[h+3]=255*x,a[h+0]=(m+_*A)*S,a[h+1]=(w+k*A)*S,a[h+2]=(g+y*A)*S}else if(2==s){var U=e[c+3],I=e[c],E=e[c+1],R=e[c+2],B=a[h+3],Z=a[h],T=a[h+1],C=a[h+2];U==B&&I==Z&&E==T&&R==C?(a[h]=0,a[h+1]=0,a[h+2]=0,a[h+3]=0):(a[h]=I,a[h+1]=E,a[h+2]=R,a[h+3]=U)}else if(3==s){var N=e[c+3],z=e[c],M=e[c+1],O=e[c+2],D=a[h+3],L=a[h],F=a[h+1],H=a[h+2];if(N==D&&z==L&&M==F&&O==H)continue;if(N<220&&20<D)return!1}return!0}}(),function(){var e=b8e.UPNG,n=b8e.PNG={};n.decode=e.decode,n.toRGBA8=e.toRGBA8,n.encode=e.encode,n.encodePng8=function(e){var t={cnum:1<arguments.length&&void 0!==arguments[1]?arguments[1]:256},r=n.decode(e),a=n.encode(n.toRGBA8(r),r.width,r.height,t.cnum,r.frames.map(function(e){return e.delay}));return new Uint8Array(a)}}(),function(){if(!b8e.IS_WORKER){b8e.ALGORITHM_VERSION="4.1.5";var e=b8e.EngineAlgorithm={};b8e.SHC(e);var t=e.onInit=function(){b8e.ALGORITHM_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aAlgorithm\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nAlgorithm:V"+b8e.ALGORITHM_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(t),b8e.onInit(t,e)}}()},{}]},{},[1]);(function(){return function a(s,i,c){function d(t,e){if(!i[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=i[t]={exports:{}};s[t][0].call(o.exports,function(e){return d(s[t][1][e]||e)},o,o.exports,a,s,i,c)}return i[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)d(c[e]);return d}})()({1:[function(e,n,r){"use strict";(function(){var e=b8e.URLLoaderDataFormat=function(){};e.BINARY="binary",e.TEXT="text",e.JSON="json",e.VARIABLES="variables",e.TEXTURE="texture",e.SOUND="sound"})(),function(){var e=b8e.URLRequestMethod=function(){};e.GET="get",e.POST="post"}(),function(){var e;e=b8e.Object.extends({ctor:function(e){void 0===e&&(e=null);var t=this;t._super(t),t.data=null,t.method=b8e.URLRequestMethod.GET,t.requestHeaders=[],t.url=e}}),b8e.RC("$$b8e","$$URLRequest",e)}(),function(){var e=b8e.EventDispatcher.extends({ctor:function(){var e=this;e._super(),e._url="",e._method="",e.responseType="",e.withCredentials=null,e.loader=null},response:{get:function(){var e=this;return e._xhr?void 0!==e._xhr.response?e._xhr.response:"text"==e.responseType?e._xhr.responseText:"arraybuffer"==e.responseType&&/msie 9.0/i.test(window.navigator.userAgent)?window.convertResponseBodyToText(e._xhr.responseBody):"document"==e.responseType?e._xhr.responseXML:null:null}},open:function(e,t){void 0===t&&(t="GET");var n=this;n._url=e,n._method=t,n._xhr&&(n._xhr.abort(),n._xhr=null),n._xhr=b8e.getXHR(),n._xhr.onreadystatechange=n.onReadyStateChange.bind(n),n._xhr.onprogress=n.updateProgress.bind(n),n._xhr.open(n._method,n._url,!0)},send:function(e){e=e||null;var t=this;if(t._xhr.responseType=t.responseType,null!=t.withCredentials&&(t._xhr.withCredentials=!!t.withCredentials),t.headerObj)for(var n in t.headerObj)t._xhr.setRequestHeader(n,t.headerObj[n]);t._xhr.send(e)},abort:function(){this._xhr&&this._xhr.abort()},getAllResponseHeaders:function(){if(!this._xhr)return null;var e=this._xhr.getAllResponseHeaders();return e||""},setRequestHeader:function(e,t){var n=this;n.headerObj||(n.headerObj={}),n.headerObj[e]=t},getResponseHeader:function(e){if(!this._xhr)return null;var t=this._xhr.getResponseHeader(e);return t||""},onReadyStateChange:function(){var e=this,t=e._xhr,n=e._url;if(4===t.readyState){var r=400<=t.status||0==t.status;b8e.setTimeout(function(){r?(e.hasEventListener(b8e.IOErrorEvent.IO_ERROR)||b8e.error(3041,n),e.dispatchEventWith(b8e.IOErrorEvent.IO_ERROR)):e.dispatchEventWith(b8e.Event.COMPLETE)},e,0)}},updateProgress:function(e){e.lengthComputable&&b8e.ProgressEvent.dispatchProgressEvent(this,b8e.ProgressEvent.PROGRESS,e.loaded,e.total)}});b8e.HttpRequest=e}(),function(){var e;e=b8e.Object.extends({ctor:function(e,t){void 0===e&&(e=null);var n=this;n._super(n),n._isJson=!!t,n.variables=null,e&&n.decode(e)},decode:function(e){if(e.charCodeAt){this.variables||(this.variables={});var t=this.variables;e=e.split("+").join(" ");for(var n=void 0,r=/[?&]?([^=]+)=([^&]*)/g;n=r.exec(e);){var o=decodeURIComponent(n[1]),a=decodeURIComponent(n[2]);if(o in t!=0){var s=t[o];s instanceof Array?s[s.length]=a:t[o]=[s,a]}else t[o]=a}}else b8e.JsUtil.applyAlias(e,!0),this.variables=e},toGetMethodString:function(){if(!this.variables)return"";var e=this.variables,t=[];for(var n in e)t[t.length]=this.encodeValue(n,e[n]);return t.join("&")},toString:function(){if(!this.variables)return"";var e=this.variables;if(this._isJson)return JSON.stringify(e);var t=[];for(var n in e)t[t.length]=this.encodeValue(n,e[n]);return t.join("&")},encodeValue:function(e,t){return t instanceof Array?this.encodeArray(e,t):encodeURIComponent(e)+"="+encodeURIComponent(t)},encodeArray:function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""}}),b8e.RC("$$b8e","$$URLVariables",e)}(),function(){var e=void 0;b8e.$getUrl=function(e){var t=e.url;return-1==t.indexOf("?")&&e.method==b8e.URLRequestMethod.GET&&e.data&&e.data instanceof b8e.URLVariables&&(t=t+"?"+e.data.toGetMethodString()),t};var n=e=b8e.Object.extends({ctor:function(){if(e._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6WebNetContext\u5b9e\u4f8b\uff01");this._super()},proceed:function(e){var t=this;if(e.dataFormat!=b8e.URLLoaderDataFormat.TEXTURE)if(e.dataFormat!=b8e.URLLoaderDataFormat.SOUND){var n=e._request,r=t.getVirtualUrl(b8e.$getUrl(n)),o=new b8e.HttpRequest;if(o.loader=e,o.addEventListener(b8e.Event.COMPLETE,t.onLoadComplete,t),o.addEventListener(b8e.IOErrorEvent.IO_ERROR,t.onError,t),o.addEventListener(b8e.ProgressEvent.PROGRESS,t.onPostProgress,t),o.open(r,n.method),o.responseType=t.getResponseType(e.dataFormat),n.method!=b8e.URLRequestMethod.GET&&n.data)if(n.data instanceof b8e.URLVariables){o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=n.data;o.send(a.toString())}else o.setRequestHeader("Content-Type","multipart/form-data"),o.send(n.data);else o.send()}else t.loadSound(e);else t.loadTexture(e)},onPostProgress:function(e){e.target.loader.dispatchEvent(e)},onError:function(e){var t=e.target,n=t.loader;this.removeListeners(t),n.dispatchEvent(e)},onLoadComplete:function(e){var t=e.target,n=t.loader;if(this.removeListeners(t),t.response){switch(n.dataFormat){case b8e.URLLoaderDataFormat.VARIABLES:n.data=new b8e.URLVariables(t.response);break;case b8e.URLLoaderDataFormat.TEXT:n.data=t.response.toString();break;case b8e.URLLoaderDataFormat.JSON:var r=t.response.toString();n.data=r?b8e.JsUtil.jsonParse(r,n.struct||!0):null;break;case b8e.URLLoaderDataFormat.BINARY:default:n.data=t.response}b8e.setTimeout(function(){b8e.Event.dispatchEvent(n,b8e.Event.COMPLETE)},this,0)}},removeListeners:function(e){var t=this;e.removeEventListener(b8e.Event.COMPLETE,t.onLoadComplete,t),e.removeEventListener(b8e.IOErrorEvent.IO_ERROR,t.onError,t),e.removeEventListener(b8e.ProgressEvent.PROGRESS,t.onPostProgress,t)},getResponseType:function(e){switch(e){case b8e.URLLoaderDataFormat.TEXT:case b8e.URLLoaderDataFormat.JSON:case b8e.URLLoaderDataFormat.VARIABLES:return b8e.URLLoaderDataFormat.TEXT;case b8e.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},loadSound:function(n){var e=this,r=this.getVirtualUrl(n._request.url),o=new b8e.Sound;function a(e){n.dispatchEvent(e)}function s(e){c(),n.dispatchEvent(e)}function i(e){c(),n.data=o,b8e.setTimeout(function(){n.dispatchEventWith(b8e.Event.COMPLETE)},t,0)}function c(){o.removeEventListener(b8e.Event.COMPLETE,i,e),o.removeEventListener(b8e.IOErrorEvent.IO_ERROR,s,e),o.removeEventListener(b8e.ProgressEvent.PROGRESS,a,e)}o.addEventListener(b8e.Event.COMPLETE,i,e),o.addEventListener(b8e.IOErrorEvent.IO_ERROR,s,e),o.addEventListener(b8e.ProgressEvent.PROGRESS,a,e),o.load(r)},loadTexture:function(o){var e=this,a=this.getVirtualUrl(o._request.url),s=new b8e.ImageLoader;function n(e){o.dispatchEvent(e)}function r(e){c(),o.dispatchEvent(e)}function i(e){c();var n=s.data;n.source.setAttribute("bitmapSrc",a);var r=new b8e.Texture;r._setBitmapData(n),o.data=r,b8e.setTimeout(function(){o.dispatchEventWith(b8e.Event.COMPLETE)},t,0)}function c(){s.removeEventListener(b8e.Event.COMPLETE,i,e),s.removeEventListener(b8e.IOErrorEvent.IO_ERROR,r,e),s.removeEventListener(b8e.ProgressEvent.PROGRESS,n,e)}s.addEventListener(b8e.Event.COMPLETE,i,e),s.addEventListener(b8e.IOErrorEvent.IO_ERROR,r,e),s.addEventListener(b8e.ProgressEvent.PROGRESS,n,e),s.load(a)},getChangeList:function(){return[]},getVirtualUrl:function(e){return e}});n._instance=null,n._singleton=!0,n.inst=function(){return n._instance||(n._singleton=!1,n._instance=new n,n._singleton=!0),n._instance},b8e.NetContext=n,b8e.RC("$$b8e","$$WebNetContext",e)}(),function(){var e;e=b8e.EventDispatcher.extends({ctor:function(e){void 0===e&&(e=null);var t=this;t._super(),t.dataFormat=b8e.URLLoaderDataFormat.TEXT,t.data=null,t.context=null,t.struct=null,t._request=null,t._status=-1,e&&t.load(e)},setCompleteHandler:function(e,t,n){this._onDataCallback={callback:e,thisArg:t,onStatus:n}},_onComplete:function(e,t){var n=this._onDataCallback;n&&n.callback.call(n.thisArg,null,e,t)},_onStatus:function(e){var t=this._onDataCallback;t&&t.onStatus&&t.onStatus.call(t.thisArg,e)},_onError:function(e,t){var n=this._onDataCallback;n&&n.callback.call(n.thisArg,new Error(e),null,t)},load:function(e){this._request=e,this.data=null,b8e.NetContext.inst().proceed(this)},reload:function(){this._request&&this.load(this._request)},__recycle:function(){var e=this;e._request=null,e.context=null,e.struct=null,e.data=null,e._onDataCallback=null}}),b8e.RC("$$b8e","$$URLLoader",e)}(),function(){var e;e=b8e.Object.extends({ctor:function(){this.host="",this.port=0,window.WebSocket||b8e.error(3042)},addCallBacks:function(e,t,n,r,o){var a=this;a.onConnect=e,a.onClose=t,a.onSocketData=n,a.onError=r,a.thisObject=o},connect:function(e,t,n){var r=this;r.host=e,r.port=t;var o=(n?"wss://":"ws://")+r.host+":"+r.port;r.socket=new window.WebSocket(o),r.socket.binaryType="arraybuffer",r._bindEvent()},connectByUrl:function(e){this.socket=new window.WebSocket(e),this.socket.binaryType="arraybuffer",this._bindEvent()},_bindEvent:function(){var t=this,e=this.socket;e.onopen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onclose=function(e){t.onClose&&t.onClose.call(t.thisObject)},e.onerror=function(e){t.onError&&t.onError.call(t.thisObject)},e.onmessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e.data)}},send:function(e){this.socket.send(e)},close:function(){this.socket.close()}}),b8e.RC("$$b8e","$$WebSocket",e)}(),function(){var r=void 0;b8e.ISocket=b8e.WebSocket,(r=b8e.EventDispatcher.extends({ctor:function(e,t){void 0===e&&(e=""),void 0===t&&(t=0);var n=this;n._super(n),n._writeMessage="",n._readMessage="",n._connected=!1,n._connecting=!1,n._bytesWrite=!1,n._type=r.TYPE_STRING,n.socket=new b8e.ISocket,n.socket.addCallBacks(n.onConnect,n.onClose,n.onSocketData,n.onError,n)},connect:function(e,t){var n=this;b8e.log("_connecting: "+n._connecting+"_connected\uff1a"+n._connected),n._connecting||n._connected||(n._connecting=!0,n.socket.connect(e,t))},connectByUrl:function(e){this._connecting||this._connected||(this._connecting=!0,this.socket.connectByUrl(e))},close:function(){this._connected&&this.socket.close()},onConnect:function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(b8e.Event.CONNECT)},onClose:function(){this._connected=!1,this.dispatchEventWith(b8e.Event.CLOSE)},onError:function(){this._connecting&&(this._connecting=!1),b8e.isWeChatGame&&(this._connected=!1),this.dispatchEventWith(b8e.IOErrorEvent.IO_ERROR)},onSocketData:function(e){var t=b8e.ProgressEvent.dispatchProgressEvent(this,b8e.ProgressEvent.SOCKET_DATA);if(e.charCodeAt)t.data=e;else{var n=b8e.ByteBuffer.get();n.writeUint8Array(new Uint8Array(e)),n.position=0,t.data=n,t.addInvalidateCallback(this._onBytesEventComplete,this,n)}},_onBytesEventComplete:function(e,t){t.release()},flush:function(){var e=this;e._connected&&(e._writeMessage&&(e.socket.send(e._writeMessage),e._writeMessage=""),e._bytesWrite&&(e.socket.send(e._writeByte.buffer),e._bytesWrite=!1,e._writeByte.clear()))},writeUTF:function(e){var t=this;t._connected&&(t._type==r.TYPE_BINARY?(t._bytesWrite=!0,t._writeByte.writeUTF(e)):t._writeMessage+=e)},readUTF:function(){var e=this,t=void 0;return e._type==r.TYPE_BINARY?(e._readByte.position=0,t=e._readByte.readUTF(),e._readByte.clear()):(t=e._readMessage,e._readMessage=""),t},writeBytes:function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this._connected&&this._writeByte&&(this._bytesWrite=!0,this._writeByte.writeBytes(e,t,n))},readBytes:function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this._readByte&&(this._readByte.position=0,this._readByte.readBytes(e,t,n),this._readByte.clear())},connected:{get:function(){return this._connected}},type:{get:function(){return this._type},set:function(e){(this._type=e)!=r.TYPE_BINARY||this._writeByte||(this._writeByte=b8e.ByteArray.get())}}})).TYPE_STRING="SocketTypeString",r.TYPE_BINARY="SocketTypeBinary",r.TYPE_JSON="SocketTypeJson",b8e.RC("$$b8e","$$Socket",r)}(),function(){var e=b8e.NetSender=function(){};b8e.sendN=e.send=function(e,t){void 0===t&&(t="main"),b8e.NetMgr.getMgr(t).sendBinary(e)},e.getBytes=function(e){return void 0===e&&(e="main"),b8e.NetMgr.getMgr(e).getBytes()}}(),function(){var e=b8e.NetHandler=function(){};b8e.addNH=e.addHandler=function(e,t,n,r){void 0===r&&(r="main"),b8e.NetMgr.getMgr(r).addMsgHandler(e,t,n)}}(),function(){b8e.NET_VERSION="4.1.5";var e=b8e.EngineNet={};b8e.SHC(e);var t=e.onInit=function(){b8e.NET_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aNet\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nNet:V"+b8e.NET_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(t),b8e.onInit(t,e)}()},{}]},{},[1]);(function(){return function s(i,o,l){function u(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(d)return d(t,!0);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}var n=o[t]={exports:{}};i[t][0].call(n.exports,function(e){return u(i[t][1][e]||e)},n,n.exports,s,i,o,l)}return o[t].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}})()({1:[function(m,e,r){"use strict";(function(){function l(){var e=void 0;return(e=b8e.isWeChatGame?wx.createImage():b8e.params.isQuickGame&&qg&&qg.createImage?qg.createImage():new Image).__Image=!0,e._isDisposed=!1,e.destroy=t,b8e.Texture2DAsset.imageCount++,e}function t(){var e=this;e._isDisposed?b8e.warn("\u975e\u6cd5\u9500\u6bc1Image!"):(e.src="",e._isDisposed=!0,b8e.Texture2DAsset.imageCount--)}b8e.ImageLoader={downloadImage:function(t,r,a,e,n){var s=this;if(void 0===e&&(e=!0),(n=n||l()).id=t,b8e.isWeChatGame||b8e.params.isQuickGame)n._b8eCompleted=!1,n.onload=function(){n._b8eCompleted=!0,a(t,null,n)},n.onerror=function(e){n._b8eCompleted||a(t,new Error("Load image ( "+r+" ) failed"))},n.src=r;else if(b8e.isRuntime)n.onload=function(e){a(t,null,n)},n.src=r;else if(e&&"file:"!==window.location.protocol?n.crossOrigin="anonymous":n.crossOrigin=null,n.complete&&0<n.naturalWidth&&n.src===r)a(t,null,n);else{var i=function e(){n.removeEventListener("load",e),n.removeEventListener("error",o),a(t,null,n)},o=function e(){n.removeEventListener("load",i),n.removeEventListener("error",e),"https:"!==window.location.protocol&&n.crossOrigin&&"anonymous"===n.crossOrigin.toLowerCase()?s.downloadImage(t,r,a,!1,n):a(t,new Error("Load image ( "+r+" ) failed"))};n.addEventListener("load",i),n.addEventListener("error",o),n.src=r}},load:function(e,a){var n=this,s=e.url,i=e.resUrl;if(b8e.isWeChatGame||b8e.params.isQuickGame)b8e.FileSystem.loadFile(s,i,a,"image");else if(b8e.isRuntime){var t=b8e.ResMgr.getLocalPath(i);jsb.fileUtils.isFileExist(t)?n.downloadImage(s,t,a):b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download image file failed: "+s)):n.downloadImage(s,t,a)})}else if(b8e.ResMgr.allowRemoteRes)b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download image file failed: "+s)):n.downloadImage(s,t,a)});else{var r=b8e.ResMgr.getLocalPath(i);n.downloadImage(s,r,function(r,e,t){e?b8e.ResMgr.getRemotePath(i,function(e,t){e?a(r,new Error("Download image file failed: "+s)):n.downloadImage(s,t,a)}):a(r,null,t)})}}}})(),b8e.BinaryLoader={initIEFilter:function(){if(!this._initedIEFilter){var e=window.navigator,t=/msie/i.test(e.userAgent)&&!/opera/i.test(e.userAgent);if(window.Uint8Array=window.Uint8Array||window.Array,t){var r=document.createElement("script");r.type="text/vbscript",r.textContent='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',document.body.appendChild(r);this._convertResponseBodyToText=function(e){for(var t={},r=0;r<256;r++)for(var a=0;a<256;a++)t[String.fromCharCode(r+256*a)]=String.fromCharCode(r,a);var n=IEBinaryToArray_ByteStr(e),s=IEBinaryToArray_ByteStr_Last(e);return n.replace(/[\s\S]/g,function(e){return t[e]})+s}}this._initedIEFilter=!0}},load:function(e,a){var n=this;n.initIEFilter();var s=e.url,i=e.resUrl;if(b8e.isWeChatGame||b8e.params.isQuickGame)b8e.FileSystem.loadFile(s,i,a,"binary");else if(b8e.isRuntime){var t=b8e.ResMgr.getLocalPath(i);if(jsb.fileUtils.isFileExist(t)){var r=jsb.fileUtils.getDataFromFile(t);r instanceof Uint8Array?a(s,null,r):a(id,new Error("Load binary file failed: "+s))}else b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download binary file failed: "+s)):n.downloadBinary(s,t,a)})}else if(b8e.ResMgr.allowRemoteRes)b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download binary file failed: "+s)):n.downloadBinary(s,t,a)});else{var o=b8e.ResMgr.getLocalPath(i);n.downloadBinary(s,o,function(r,e,t){e?b8e.ResMgr.getRemotePath(i,function(e,t){e?a(r,new Error("Download binary file failed: "+s)):n.downloadBinary(s,t,a)}):a(r,null,t)})}},downloadBinary:function(r,e,a){var n=window.navigator,s=/msie/i.test(n.userAgent)&&!/opera/i.test(n.userAgent),i=b8e.getXHR(),o="Load binary data failed: "+e;i.open("GET",e,!0),s?(i.setRequestHeader("Accept-Charset","x-user-defined"),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status||0===i.status||void 0===i.status){var e=t._convertResponseBodyToText(i.responseBody);a(r,null,b8e.BufferUtil.str2Uint8Array(e))}else a(r,{xhrErr:!0,readyState:i.readyState,status:i.status,errorMessage:o+"(wrong status)"});else a(r,{xhrErr:!0,readyState:i.readyState,status:i.status,errorMessage:o+"(wrong readyState)"})}):(i.responseType="arraybuffer",i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.onload=function(){4===i.readyState?200===i.status||0===i.status||void 0===i.status?i.response?a(r,null,new Uint8Array(i.response)):a(r,null,b8e.BufferUtil.str2Uint8Array(i.responseText)):a(r,{xhrErr:!0,readyState:i.readyState,status:i.status,errorMessage:o+"(wrong status)"}):a(r,{xhrErr:!0,readyState:i.readyState,status:i.status,errorMessage:o+"(wrong readyState)"})},i.onerror=function(){a(r,{xhrErr:!0,readyState:i.readyState,status:i.status,errorMessage:o+"(error)"})},i.ontimeout=function(){a(r,{xhrErr:!0,readyState:i.readyState,status:i.status,errorMessage:o+"(time out)"})}),i.send(null)}},b8e.TextLoader={load:function(e,a){var n=this,s=e.url,i=e.resUrl;if(b8e.isWeChatGame||b8e.params.isQuickGame)b8e.FileSystem.loadFile(s,i,a,"utf8");else if(b8e.isRuntime){var t=b8e.ResMgr.getLocalPath(i);if(jsb.fileUtils.isFileExist(t)){var r=jsb.fileUtils.getStringFromFile(t);r&&r.charCodeAt?a(s,null,r):a(id,new Error("Load text file failed: "+s))}else b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download text file failed: "+s)):n.downloadText(s,t,a)})}else if(b8e.ResMgr.allowRemoteRes)b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download text file failed: "+s)):n.downloadText(s,t,a)});else{var o=b8e.ResMgr.getLocalPath(i);n.downloadText(s,o,function(r,e,t){e?b8e.ResMgr.getRemotePath(i,function(e,t){e?a(r,new Error("Download text file failed: "+s)):n.downloadText(s,t,a)}):a(r,null,t)})}},downloadText:function(e,t,r){var a=b8e.getXHR(),n="Load text data failed: "+t,s=window.navigator;a.open("GET",t,!0),/msie/i.test(s.userAgent)&&!/opera/i.test(s.userAgent)?(a.setRequestHeader("Accept-Charset","utf-8"),a.onreadystatechange=function(){4===a.readyState?200===a.status||0===a.status||void 0===a.status?r(e,null,a.responseText):r(e,{xhrErr:!0,readyState:a.readyState,status:a.status,errorMessage:n+"(wrong status)"}):r(e,{xhrErr:!0,readyState:a.readyState,status:a.status,errorMessage:n+"(wrong readyState)"})}):(a.responseType="text",a.overrideMimeType&&a.overrideMimeType("text/plain; charset=utf-8"),a.onload=function(){4===a.readyState?200===a.status||0===a.status||void 0===a.status?r(e,null,a.responseText):r(e,{xhrErr:!0,readyState:a.readyState,status:a.status,errorMessage:n+"(wrong status)"}):r(e,{xhrErr:!0,readyState:a.readyState,status:a.status,errorMessage:n+"(wrong readyState)"})},a.onerror=function(){r(e,{xhrErr:!0,readyState:a.readyState,status:a.status,errorMessage:n+"(error)"})},a.ontimeout=function(){r(e,{xhrErr:!0,readyState:a.readyState,status:a.status,errorMessage:n+"(time out)"})}),a.send(null)}},b8e.SoundLoader={downloadAudio:function(i,e,t){var r=this;if(b8e.params.isQuickGame)t(i,null,e);else if(b8e.isRuntime){var a=r.audioDownloader,o=r.audioUrlMap;a||(a=r.audioDownloader=new jsb.Downloader,o=r.audioUrlMap={},a.setOnFileTaskSuccess(function(e){var t=e.requestURL,r=o[t];if(r){var a=e.storagePath,n=r.callback,s=jsb.fileUtils.getDataFromFile(a);s instanceof Uint8Array?n(i,null,s):n(i,new Error("Download sound file failed: "+i)),delete o[t]}}),a.setOnTaskError(function(e,t,r,a){var n=e.requestURL,s=o[n];s&&((0,s.callback)(i,new Error("Download sound file failed: "+i+":"+a),null),delete o[n])}));var n=e;o[n]={callback:t},a.createDownloadFileTask(n,storagePath)}else{var s=cc.sys.__audioSupport,l=s.format;s.context;if(0===l.length)return void b8e.warn("Audio Downloader: audio not supported on this browser!");(s.WEB_AUDIO?r.loadWebAudio:r.loadDomAudio)(i,e,t)}},loadDomAudio:function(t,e,r){var a=cc.sys.__audioSupport,n=document.createElement("audio");if(n.src=e,b8e.isWeChatGame)r(t,null,n);else{var s=function(){clearTimeout(i),n.removeEventListener("canplaythrough",o,!1),n.removeEventListener("error",l,!1),a.USE_LOADER_EVENT&&n.removeEventListener(a.USE_LOADER_EVENT,o,!1)},i=setTimeout(function(){0===n.readyState?l():o()},8e3),o=function(){s(),r(t,null,n)},l=function(){s();var e="load audio failure - "+t;b8e.error(e),r(t,new Error(e))};n.addEventListener("canplaythrough",o,!1),n.addEventListener("error",l,!1),a.USE_LOADER_EVENT&&n.addEventListener(a.USE_LOADER_EVENT,o,!1)}},loadWebAudio:function(t,e,r){var a=cc.sys.__audioSupport.context;a||r(t,new Error("Audio Downloader: no web audio context."));var n=b8e.getXHR();n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){a.decodeAudioData(n.response,function(e){r(t,null,e)},function(){r(t,new Error("decode error - "+t))})},n.onerror=function(){r(t,new Error("request error - "+t))},n.send()},load:function(e,a){var n=this,s=e.url,i=e.resUrl;if(b8e.isWeChatGame||b8e.params.isQuickGame)b8e.FileSystem.loadFile(s,i,a,"sound");else if(b8e.isRuntime){var t=b8e.ResMgr.getLocalPath(i);if(jsb.fileUtils.isFileExist(t)){var r=jsb.fileUtils.getDataFromFile(t);r instanceof Uint8Array?a(s,null,r):a(id,new Error("Load sound file failed: "+s))}else{var o=jsb.fileUtils.getWritablePath()+s;if(jsb.fileUtils.isFileExist(o)){var l=jsb.fileUtils.getDataFromFile(o);l instanceof Uint8Array?a(s,null,l):a(id,new Error("Load sound file failed: "+s))}else b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download sound file failed: "+s)):n.downloadAudio(s,t,a)})}}else if(b8e.ResMgr.allowRemoteRes)b8e.ResMgr.getRemotePath(i,function(e,t){e?a(id,new Error("Download sound file failed: "+s)):n.downloadAudio(s,t,a)});else{var u=b8e.ResMgr.getLocalPath(i);n.downloadAudio(s,u,function(r,e,t){e?b8e.ResMgr.getRemotePath(i,function(e,t){e?a(r,new Error("Download sound file failed: "+s)):n.downloadAudio(s,t,a)}):a(r,null,t)})}}},b8e.FileSystem={init:function(){this.noCache=!0;var e=void 0;b8e.isWeChatGame?e=wx.getFileSystemManager?wx.getFileSystemManager():null:b8e.params.isQuickGame&&(e=qg&&qg.getFileSystemManager?qg.getFileSystemManager():null),this.fs=e},loadFile:function(e,t,r,a){var n=this,s=n.fs,i=n.noCache,o=t,l=o.indexOf("?");-1<l&&(o=o.substring(0,l),i=!0),i?n.downloadRemoteFile(e,o,r,a):s.access({path:o,success:function(){n.readFile(e,o,r,a)},fail:function(){n.readFromLocal(e,o,r,a)}})},readFromLocal:function(e,t,r,a){var n=this,s=void 0;b8e.isWeChatGame?s=wx.env.USER_DATA_PATH+"/"+t:b8e.params.isQuickGame&&(s=qg&&qg.env&&qg.env.USER_DATA_PATH+"/"+t),n.fs.access({path:s,success:function(){n.readFile(e,s,r,a)},fail:function(){b8e.ResMgr.remoteRootDir?n.downloadRemoteFile(e,t,r,a):r(e,new Error("Load file ( "+s+" ) failed"))}})},downloadRemoteFile:function(e,t,r,a){var n=b8e.ResMgr.remoteRootDir+"/"+t;"image"===a?b8e.ImageLoader.downloadImage(e,n,r):"sound"===a?b8e.SoundLoader.downloadAudio(e,n,r):"utf8"===a?b8e.TextLoader.downloadText(e,n,r):"binary"===a&&b8e.BinaryLoader.downloadBinary(e,n,r)},readFile:function(t,r,a,e){var n=this.fs;n.readFile({filePath:r,encoding:e,success:function(e){e.data?a(t,null,e.data):a(t,{status:0,errorMessage:"Empty file: "+r})},fail:function(e){b8e.warn("Read file failed: "+r),n.unlink({filePath:r,success:function(){}}),a(t,{status:0,errorMessage:e&&e.errMsg?e.errMsg:"Read text file failed: "+r})}})}},function(){var e;e=b8e.PoolObject.extends({__Asset:!0,request:null,_unused:!1,_dependUrls:null,ctor:function(){this._super(),this.lazyPoolDisabled=!0,this._unused=!0,this._dependUrls=[]},preloadDepends:function(){return!1},loadDepends:function(e,t){e&&e.call(t,this)},addDependUrl:function(e){var t=this._dependUrls;t[t.length]=e},setUnused:function(e){var t=this;if(t._unused!=e){t._unused=!!e;for(var r=t._dependUrls,a=r.length,n=0;n<a;n++){var s=r[n],i=b8e.res._requestCache.get(s),o=i?i.asset:null;o&&o.__Asset&&i.isLoaded&&o.setUnused(t._unused)}t._unused?t.unuse():t.use()}},use:function(){},unuse:function(){},cancelLoad:function(){},wakeUp:function(){this._super()},invalidate:function(){var e=this;e.request=null,e.cancelLoad(),e._unused=!0,e._dependUrls.length=0,e._super()},recycle:function(){this._super()},dispose:function(){this._dependUrls=null,this._super()}}),b8e.RC("$$b8e","$$Asset",e)}(),function(){var e,t=e=b8e.Asset.extends({ctor:function(){this._super()},preloadDepends:function(){return!0},parseWithAtlas:function(e,t,r,a){var n=this;n._atlas=e,n._spriteFrames=n._atlas._spriteFrames,n._onCompleteCb={func:t,thisArg:r,args:a},n._atlasComplete()},parsePlist:function(e,t,r,a,n){this._plist=t,this.parse(e,t,r,a,n)},parse:function(e,t,r,a,n){var s=this;s._spriteFrames={},s._textureScale=1,s._dataUrl=e?e.replace(/\\/g,"/"):null,s._dirUrl=s._dataUrl?s._dataUrl.substring(0,s._dataUrl.lastIndexOf("/")):null,s._onCompleteCb={func:r,thisArg:a,args:n};var i=s._btfTexture=b8e.BTFTexture.get(),o=i.options={recycleDelay:s.request.recycleDelay};s.request.options&&(o.textureFormat=s.request.options.textureFormat),i.setData(e,t,s._onBtfComplete,s)},_onBtfComplete:function(e,t){if(!t){var r=this._btfTexture;this._bundleData=r._getBundleData(),this.textureParser(r.getTexture())}this._atlasComplete(t)},_getBtfData:function(){return this._btfTexture._getBtfData()},parseBtb:function(e,t,r,a,n,s){var i=this;i._spriteFrames={},i._dataUrl=e?e.replace(/\\/g,"/"):null,i._dirUrl=i._dataUrl?i._dataUrl.substring(0,i._dataUrl.lastIndexOf("/")):null,i._onCompleteCb={func:r,thisArg:a,args:n},i._bundleData=t;var o=i._bundleData.textureFileName||i._bundleData.metadata.textureFileName;i._loadMeta=!1,i._textureScale=1,i._highDefinition=b8e.ResMgr.HIGH_DEFINITION_ENABLED,i._options=s;var l=i.request.recycleDelay;s&&(void 0!==s.loadMeta&&(i._loadMeta=s.loadMeta),void 0!==s.highDefinition&&(i._highDefinition=s.highDefinition),i._highDefinition||void 0!==s.textureScale&&(i._textureScale=s.textureScale,i._textureScale=0<i._textureScale?i._textureScale:1));var u="png",d=i.request.options.textureFormat;d&&(u=d);var c=o.lastIndexOf(".");if(o=(o=o.substring(0,c))+"."+u,i._textureScale<1){var f=o.indexOf(".");o=o.substring(0,f)+"_min"+o.substr(f)}i._imgUrl=i._dirUrl+"/"+o,b8e.res.loadRes(i._imgUrl,b8e.Texture2DAsset,i.onTextureComplete,i,null,{recycleDelay:l,ownerUrl:i._dataUrl})},onTextureComplete:function(e,t){var r=this;t?(r.textureParser(t),r._loadMeta?r.loadMeta():r._atlasComplete()):r._atlasComplete(e)},_atlasComplete:function(e){var t=this;if(t._onCompleteCb&&t._onCompleteCb.func){var r=t._onCompleteCb.args?[t,e].concat(t._onCompleteCb.args):[t,e];t._onCompleteCb.func.apply(t._onCompleteCb.thisArg,r)}},textureParser:function(e){var t=this;if(t._spriteFrames&&(t._texture=e,t._bundleData)){var r=e.getTexture(),a=t._bundleData.frames;for(var n in a){var s=a[n],i=new cc.SpriteFrame,o=void 0,l=void 0;if(t._plist){var u=t.getDataArr(s.frame);o=new cc.Rect((0|+u[0])*t._textureScale>>0,(0|+u[1])*t._textureScale>>0,(0|+u[2])*t._textureScale>>0,(0|+u[3])*t._textureScale>>0);var d=t.getDataArr(s.offset);l=new cc.Vec2((0|+d[0])*t._textureScale,(0|+d[1])*t._textureScale)}else{var c=s.scale9Inset;i.insetTop=c.top,i.insetBottom=c.bottom,i.insetLeft=c.left,i.insetRight=c.right;var f=s.frame,_=t._textureScale;o=new cc.Rect(f[0]*_>>0,f[1]*_>>0,f[2]*_>>0,f[3]*_>>0);var h=s.offset;l=new cc.Vec2(h[0]*_>>0,h[1]*_>>0)}var p=!!s.rotated,b=o.size;i.setTexture(r,o,p,l,b),t._spriteFrames[n]=i}}},getDataArr:function(e){return e?(e=(e=e.replace(/\{/g,"")).replace(/\}/g,"")).split(","):[]},getTexture:function(){if(!this._spriteFrames)return null;var e=Object.keys(this._spriteFrames);if(0<e.length){var t=this._spriteFrames[e[0]];return t?t.getTexture():null}return null},getSpriteFrame:function(e){if(!this._spriteFrames)return b8e.warn(3105,this._dataUrl),null;var t=this._spriteFrames[e];return t||b8e.warn(3106,e,this._dataUrl),t},getSpriteFrames:function(e){if(!this._spriteFrames)return b8e.warn(3107,this._dataUrl),null;for(var t=[],r=e.length,a=0;a<r;a++){var n=e[a];if(n){var s=this._spriteFrames[n];s?t[t.length]=s:(b8e.warn(3108,n,this._dataUrl),t[t.length]=null)}else t[t.length]=null}return 0==t.length&&b8e.warn(3109),t},getAtlas:function(){var e=this;return e._spriteFrames?(e._atlas||(e._atlas=new cc.SpriteAtlas,e._atlas._spriteFrames=e._spriteFrames),e._atlas):null},getDirUrl:function(){return this._dirUrl},loadMeta:function(){var e=this;if(e._dataUrl){var t=e._dataUrl+".meta";e._metaUrl!=t&&(e._metaUrl&&(b8e.res.unloadRes(e._metaUrl,e.onMetaComplete,e),e._metaUrl=null),e._metaData=null,e._metaUrl=t,b8e.res.loadRes(e._metaUrl,b8e.MetaConfig,e.onMetaComplete,e))}},onMetaComplete:function(e,t){e?this._atlasComplete(e):(this._metaData=t,this._atlasComplete())},getMetaData:function(){return this._metaData},getFrameNamesByUuid:function(e){if(!this._metaData)return null;for(var t=[],r=e.length,a=0;a<r;a++){var n=e[a],s=this._metaData.getFileNameByUuid(n,this._dirUrl);s?t[t.length]=s:(b8e.warn(3110,this._metaUrl,n),t[t.length]="")}return t},cancelLoad:function(){var e=this;e._imgUrl&&(b8e.res.unloadRes(e._imgUrl,e.onTextureComplete,e),e._imgUrl=null),e._metaUrl&&(b8e.res.unloadRes(e._metaUrl,e.onMetaComplete,e),e._metaUrl=null),e._btfTexture&&(e._btfTexture.release(),e._btfTexture=null),e._onCompleteCb=null,e._super()},recycle:function(){var e=this;e._options=null,e._loadMeta=!1,e._highDefinition=!1,e._textureScale=0,e._metaData=null,e._dataUrl=null,e._dirUrl=null,e._bundleData=null,e._plist=null,e._texture=null,e._atlas=null,e._spriteFrames=null,e._super()}}),r=new b8e.Pool(t,4096);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$FrameAtlas",e)}(),function(){var e,t=e=b8e.Asset.extends({__SpriteFrame:!0,ctor:function(){this._super()},preloadDepends:function(){return!0},setTexture:function(e,t,r,a){this._texture||(this._onCompleteCb={func:r,thisArg:a},this._texture=t,this._loadComplete())},_getBtfData:function(){return this._btfTexture._getBtfData()},setBtfData:function(e,t,r,a){var n=this;if(!n._texture){n._onCompleteCb={func:r,thisArg:a};var s=n._btfTexture=b8e.BTFTexture.get(),i=s.options={recycleDelay:n.request.recycleDelay};n.request.options&&(i.textureFormat=n.request.options.textureFormat),s.setData(e,t,n._onBtfComplete,n)}},_loadComplete:function(){var e=this;e._onCompleteCb&&e._onCompleteCb.func&&e._onCompleteCb.func.call(e._onCompleteCb.thisArg,e)},cancelLoad:function(){var e=this;e._btfTexture&&(e._btfTexture.release(),e._btfTexture=null),e._onCompleteCb=null,e._super()},_onBtfComplete:function(){this._texture=this._btfTexture.getTexture(),this._loadComplete()},scale9Inset:{set:function(e){this._scale9Inset=e}},setImageData:function(e,t,r,a){var n=this,s=new b8e.Texture2DAsset;t&&("jpg"==t.format?(s.initWithJpegData(e),n.setTexture(s.getTexture()),r&&r.call(null,n)):"png"==t.format?(s.initWithPngData(e),n.setTexture(s.getTexture()),r&&r.call(null,n)):"btf"==t.format&&s.initWithBtfData(e,function(e){n.setTexture(e.getTexture()),r&&r.call(a,n)}))},getFrame:function(){var e=this;if(!e._spriteFrame){var t=e._texture,r=e._scale9Inset;if(t){t.__Texture2DAsset&&(t=t.getTexture());var a=e._spriteFrame=new cc.SpriteFrame;a.insetTop=r?r.top:0,a.insetBottom=r?r.bottom:0,a.insetLeft=r?r.left:0,a.insetRight=r?r.right:0;var n=t.width,s=t.height;t._orgWidth&&(n=t._orgWidth),t._orgHeight&&(s=t._orgHeight);var i=new cc.Rect(0,0,n,s),o=new cc.Vec2(0,0),l=new cc.Size(t.width,t.height);a.setTexture(t,i,!1,o,l)}}return e._spriteFrame},getTexture:function(){return this._texture&&this._texture.__Texture2DAsset?this._texture.getTexture():this._texture},use:function(){var e=this;e._super(),e._texture&&(e._texture.__Texture2DAsset||e._texture.textureValidate(e))},unuse:function(){var e=this;e._super(),e._texture&&(e._texture.__Texture2DAsset||e._texture.textureInvalidate(e))},recycle:function(){var e=this;e._texture&&(e._texture.__Texture2DAsset||e._texture.release(),e._texture=null),e._scale9Inset=null;var t=e._spriteFrame;t&&(t.clearTexture(),t.destroy(),e._spriteFrame=null),e._super()}}),r=new b8e.Pool(t,4096);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$SpriteFrame",e)}(),function(){var e,u=e=b8e.Asset.extends({__Texture2DAsset:!0,ctor:function(){this._super()},preloadDepends:function(){return!0},setTexture:function(e){this._texture||(this._texture=e)},getTexture:function(){return this._texture},initWithImageData:function(e,t,r,a){if(t)if("jpg"==t.format)this.initWithJpegData(e,r,a);else if("png"==t.format){var n="argb";void 0!==t.channel&&(n=t.channel),this.initWithPngData(e,n,r,a)}else"btf"==t.format&&this.initWithBtfData(e,r,a)},use:function(){this._super(),this._texture&&this._texture.textureValidate(this)},unuse:function(){this._super(),this._texture&&this._texture.textureInvalidate(this)},recycle:function(){this._texture&&(this._texture.release(),this._texture=null),this._super()}}),t=new b8e.Pool(u,4096);u.get=function(){return t.get()},u.put=function(e){return t.put(e)},u._designatedFormatMap=b8e.HashMap.get(),u.setDesignatedFormat=function(e,t){var r=(e=e.replace(/\\/g,"/")).indexOf(".");-1<r&&(e=e.substring(0,r)),u._designatedFormatMap.set(e,t)};var n=b8e.HashMap.get();u.__setResDesignatedFormat=function(e,t){var r=(e=e.replace(/\\/g,"/")).indexOf(".");-1<r&&(e=e.substring(0,r)),n.set(e,t)},u.getPixelFormat=function(e,t){var r=e.url?e.url:"",a=r.lastIndexOf("."),n=!1;"jpg"==r.substr(a+1,3)&&(n=!0);return n?b8e.TextureFormat.RGB8:b8e.TextureFormat.RGBA8},u.getTextureUrl=function(e){e=e.replace(/\\/g,"/");var t=b8e.ResMgr.resDir;0==e.indexOf(t)&&(e=e.substr(t.length+1));var r=e.indexOf(".");return-1<r&&(e=e.substring(0,r)),e},u.__getResDesignatedFormat=function(e){e=u.getTextureUrl(e);var t=n.get(e);if(!t)for(var r=e,a=r.lastIndexOf("/");!t&&-1<a;)a=(r=r.substring(0,a)).lastIndexOf("/"),t=n.get(r);return t},u.isDebug=function(e){cc.dynamicAtlasManager.showDebug(!!e)},u.imageCount=0,u.ENABLE_FORMAT_ASTC=!1,u.ENABLE_FORMAT_PVR=!1,u.ENABLE_FORMAT_ETC=!1,u.ENABLE_UNZIP=!1;function o(e,t,r){var a=t instanceof ArrayBuffer?t:t.buffer,n=new Int32Array(a,0,15);if(55727696!=n[0])return b8e.error(e+":Invalid magic number in PVR header"),void callback.call(thisArg,null);var s=n[7],i=n[6],o=n[12]+52,l=n[13],u=n[14],d=new Uint8Array(a,o),c=b8e.Texture2D.get();return c._orgWidth=l,c._orgHeight=u,r?c.initWithData(d,b8e.TextureFormat.RGBA_PVRTC_4BPPV1,s,i):c.initWithData(d,b8e.TextureFormat.RGB_PVRTC_4BPPV1,s,i),c}u.loadPVRTex=function(e,t,r,a,n){if(u.LAZY_PARSE){var s=g.get();s.func=o,s.id=e,s.content=t,s.hasAlpha=r,s.callback=a,s.thisArg=n,m(e,s)}else{var i=o(e,t,r);a.call(n,i)}},u.glExtensions=["EXT_texture_filter_anisotropic","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","WEBGL_draw_buffers"],u.init=function(){};function d(e,t){return e[t]<<8|e[t+1]}function l(e,t,r){var a=t instanceof ArrayBuffer?t:t.buffer,n=new Uint8Array(a),s=d(n,6);if(0!==s&&1!==s&&3!==s)return b8e.error(e+":Invalid magic number in ETC header"),void callback.call(thisArg,null);var i=d(n,12),o=d(n,14),l=(d(n,8),d(n,10),new Uint8Array(a,16)),u=b8e.Texture2D.get();return r?(u._orgWidth=i,u._orgHeight=.5*o>>0,u.initWithData(l,b8e.TextureFormat.RGBA_ETC1,i,o)):u.initWithData(l,b8e.TextureFormat.RGB_ETC1,i,o),u}function f(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function _(e,t){return e[t+2]<<16|e[t+1]<<8|e[t]}u.loadPKMTex=function(e,t,r,a,n){if(u.LAZY_PARSE){var s=g.get();s.func=l,s.id=e,s.content=t,s.hasAlpha=r,s.callback=a,s.thisArg=n,m(e,s)}else{var i=l(e,t,r);a.call(n,i)}};var r=null;function h(e){if(!r){r={};var t=b8e.TextureFormat;r[1]=t.RGBA_ASTC_4x4,r[2]=t.RGBA_ASTC_6x6,r[3]=t.RGBA_ASTC_8x8,r[4]=t.RGBA_ASTC_10x10,r[5]=t.RGBA_ASTC_12x12}return r[e]}function c(e,t,r){var a=t instanceof ArrayBuffer?t:t.buffer,n=new Uint8Array(a),s=f(n,0);if(s>>8!=6070699)return b8e.error(e+":Invalid format in header!"),void callback.call(thisArg,null);var i=255&s;if(i<1||5<i)return b8e.error(e+":Invalid type in header!"),void callback.call(thisArg,null);var o=_(n,7),l=_(n,10),u=new Uint8Array(a,16),d=new cc.Texture2D,c=h(i);return d.initWithData(u,c,o,l),d}function p(e,t,r,a,n){var s=NaN,i=NaN;if(a&&n&&((s=b8e.MathUtil.nearestPowerOfTwo(a))<a&&(s<<=1),(i=b8e.MathUtil.nearestPowerOfTwo(n))<n&&(i<<=1)),t.__Image){s&&i&&(t.textureWidth=s,t.textureHeight=i);var o=b8e.Texture2D.get();return o.url=e,a&&n&&(o._orgWidth=a,o._orgHeight=n),o.initWithElement(t),o}var l=b8e.Texture2D.get();l.url=e;var u=b8e.PNG.toRGBA8(t),d=new Uint8Array(u[0]),c=t.width,f=t.height,_=c,h=f;return a&&n&&(_=l._orgWidth=a,h=l._orgHeight=n),l.initWithData(d,b8e.TextureFormat.RGBA8,c,f,_,h),l}u.loadASTCTex=function(e,t,r,a,n){if(u.LAZY_PARSE){var s=g.get();s.func=c,s.id=e,s.content=t,s.hasAlpha=r,s.callback=a,s.thisArg=n,m(e,s)}else{var i=c(e,t,r);a.call(n,i)}},u.loadImage=function(e,t,r,a,n,s,i){if(u.LAZY_PARSE){var o=g.get();o.func=p,o.id=e,o.content=t,o.pixelsWidth=s,o.pixelsHeight=i,o.hasAlpha=r,o.callback=a,o.thisArg=n,m(e,o)}else{var l=p(e,t,r,s,i);a.call(n,l)}},u.getFileFormat=function(e,t){return b8e.astc&&u.ENABLE_FORMAT_ASTC?e?u.ENABLE_UNZIP?"bpaz":"bpa":u.ENABLE_UNZIP?"bjaz":"bja":b8e.pvrtc&&u.ENABLE_FORMAT_PVR?e?u.ENABLE_UNZIP?"bprz":"bpr":u.ENABLE_UNZIP?"bjrz":"bjr":b8e.etc1&&u.ENABLE_FORMAT_ETC?e?u.ENABLE_UNZIP?"bppz":"bpp":u.ENABLE_UNZIP?"bjpz":"bjp":b8e.btfbc&&b8e.Texture2D.ENABLE_BLOCK_COMPACT?e?"btf":"bti":e?u.DEFAULT_FORMAT_RGBA:u.DEFAULT_FORMAT_RGB},u.cancelParse=function(e){s(e)},u.DEFAULT_FORMAT_RGBA="btf",u.DEFAULT_FORMAT_RGB="bti",u.PARSE_CONCURRENT=1,u.LAZY_PARSE=!0;var b={},a=new b8e.CallLater(function(e){var t=e.func,r=e.id,a=e.content,n=e.hasAlpha,s=e.pixelsWidth,i=e.pixelsHeight,o=e.callback,l=e.thisArg;e.release(),delete b[r];var u=t(r,a,n,s,i);return o.call(l,u),!1},u,u.PARSE_CONCURRENT);function m(e,t){b[e]=t,a.add(t)}function s(e){var t=b[e];t&&(a.remove(t),t.release(),delete b[e])}u.parseQueueCount=function(){return a.count()};var g=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.func=null,e.id=null,e.pixelsWidth=void 0,e.pixelsHeight=void 0,e.content=null,e.hasAlpha=!1,e.callback=null,e.thisArg=null}}),i=new b8e.Pool(g,128);g.get=function(){return i.get()},g.put=function(e){return i.put(e)},b8e.RC("$$b8e","$$Texture2DAsset",e)}(),function(){var a=b8e.TextureCache={};b8e.SHC(a),a.MAX_MEMORY=128e6,a._totalBytes=0,a._detectionStated=!1,a._needGc=!1;var t=0,e=a.textures=b8e.HashMap.get();e.localHashable=!0,e.polyfillHash=!0,a.infoDetection=function(){a._detectionStated||(b8e.Timer.add(a,r,1e3,0,-1e3,null,2),a._detectionStated=!0)};var r=a._onDetection=function(){a.memoryOverflow()?(b8e.res.purge(a._needGc),a._needGc=!0):a._needGc=!1};b8e.SHC(r),a.memoryOverflow=function(){return a._totalBytes>a.MAX_MEMORY},a.getCounter=function(){return t},a.getTotalBytes=function(){return a._totalBytes},function(){a.addTexture=function(e){},a.removeTexture=function(e){e.loaded&&(t--,a._removeTotalBytes(e))},a.textureLoaded=function(e){e.loaded||(t++,a._addTotalBytes(e))};var r=null;a.bitsPerPixelForFormat=function(e){if(b8e.isCocos190)return 32;if(!r){r={};var t=b8e.TextureFormat;r[t.RGB_PVRTC_2BPPV1]=2,r[t.RGBA_PVRTC_2BPPV1]=2,r[t.RGB_ETC1]=4,r[t.RGB_PVRTC_4BPPV1]=4,r[t.RGBA_PVRTC_4BPPV1]=4,r[t.RGBA_ASTC_4x4]=8,r[t.RGBA_ASTC_6x6]=3.56,r[t.RGBA_ASTC_8x8]=2,r[t.RGBA_ASTC_10x10]=1.28,r[t.RGBA_ASTC_12x12]=.89,r[t.R5_G6_B5]=16,r[t.R5_G5_B5_A1]=16,r[t.R4_G4_B4_A4]=16,r[t.RGB8]=24,r[t.RGBA8]=32}return 0|+r[e._format]},a._addTotalBytes=function(e){var t=a.bitsPerPixelForFormat(e),r=(e._orgWidth||e.width)*(e._orgHeight||e.height)*t/8;a._totalBytes+=r},a._removeTotalBytes=function(e){var t=a.bitsPerPixelForFormat(e),r=(e._orgWidth||e.width)*(e._orgHeight||e.height)*t/8;a._totalBytes-=r},a._clearTotalBytes=function(){a._totalBytes=0},a.dumpInfo=function(){var e=a.textures,n=[];e.forEach(function(e,t){var r=t._orgWidth||t.width,a=t._orgHeight||t.height;n[n.length]={key:e,width:r,height:a,size:r*a}},a),n.sort(a._onSortInfo);var t="\n";return n.forEach(function(e){t+=e.key+":"+e.width+"*"+e.height+"\n"},a),t},a._onSortInfo=function(e,t){return e.size>t.size?-1:e.size<t.size?1:0}}()}(),function(){var e,t=e=b8e.Asset.extends({ctor:function(){this._super()},buildMessage:function(e,t,r){this._url=e;var a=r.proto;a=b8e.ProtobufUtil.decodeMessage(this._url,t,a),this._protoData=a},getProtoData:function(){return this._protoData},recycle:function(){this._url=null,this._protoData=null,this._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$ProtobufConfig",e)}();var R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var e,o=0,u=0,P=e=b8e.Asset.extends({ctor:function(){this._super(),this.resetParams();var e=P.insts;e[e.length]=this},resetParams:function(){var e=this;e._url=null,e._partPath=null,e._ctorByNs={},e._bufferByNs={},e._keysGroupByNs={},e._keyValusMapByAlias={},e._isAsyncByNs={},e._isLoadingByNs={},e._isLoadedByNs={},e._dotDatasByNs={},e._dotDatasByAlias={},e._partCallbackByNs={},e._keysListByAlias={},e._indexEqualsByAlias={},e._equalsIndexByAlias={},e._onDataCreateByNs={},e._namesByAlias={},e._aliasByName={},e._idName=b8e.getAliasName("id"),e._uidName=b8e.getAliasName("uid"),e._allotQueue=[],e._allotIdx=0},preloadDepends:function(){return!0},parseConfig:function(e,t,r,a,n,s){var i=this;if(i._url=e,i._partPath=e.substring(0,e.lastIndexOf("/")),a&&a.ns){var o=b8e.ProtoByteBuffer.wrap(r),l=o.readByte();if(39!==l)return void b8e.error(1201,l,39);var u=o.readString(),d=b8e.JsUtil.jsonParse(u),c={};c[t]=d;var f=i.request.benchmarkInfo;f&&(f.papst=b8e.getTimer()),b8e.ProtobufUtil.allotProps(c),f&&(f.papet=b8e.getTimer(),f.pdcst=b8e.getTimer()),b8e.setTimeout(i._nextParse,i,0,o,n,s,a),i._bytesListByNs={},i._uidListKeyByNs={},i._bytesUidByNs={},i._datasUidByNs={},i._dataUuidByNs={},i._countByNs={},i._root=game[b8e.getAliasName(a.ns)]}else i._bytesListByNs=null,i._uidListKeyByNs=null,i._bytesUidByNs=null,i._datasUidByNs=null,i._dataUuidByNs=null,i._countByNs=null,i._config=null,b8e.error(1001)},_nextParse:function(e,t,r,a){var n=this;if(e.offset<e.limit){for(var s=0,i=n._root,o=n._bytesListByNs,l=n._uidListKeyByNs,u=n._bytesUidByNs,d=n._datasUidByNs,c=n._dataUuidByNs,f=n._countByNs,_=b8e.macro.BENCHMARK,h=_?b8e.getTimer():0,p=P.CONFIG_IMMED_DECODE;e.offset<e.limit;){var b=e.readString(),m=null,g=e.readByte();0<g&&(m=[]);for(var v=0;v<g;v++){var y=m[v]=[];y.__isUKeys=!0;for(var A=e.readByte(),x=0;x<A;x++){var C=e.readString();C=b8e.getAliasName(C),y[x]=C}}var D=e.readByte(),E=i[b8e.getAliasName(b+"Define")],B=E?E.ctor:null,R=0;if(!D){R=e.readInt(),P.tabelCount++,P.totalCount+=R;var T=e.readInt();n._bufferByNs[b]={buffer:e,offset:e.offset,length:T},e.offset+=T}if(E){if(d[b]={},c[b]={},!p){u[b]={};var w=[];w.__index=0,o[b]=w,l[b]={}}f[b]=R,n._ctorByNs[b]=B,n._keysGroupByNs[b]=m,n._dotDatasByNs[b]={},n._isLoadedByNs[b]={},n._isLoadingByNs[b]={},n._isAsyncByNs[b]=D}else b8e.error(1002,b);if(s+=R,P.CONFIG_IMMED_DECODE&&s>=P.BATCH_DECODE)break}_&&b8e.benchmark("batch parse cost:"+(b8e.getTimer()-h));var L=a.onParseProgress;if(L){var S=a.onParseProgressThis,N=e.offset,U=e.limit;L.call(S,n,N,U)}b8e.setTimeout(n._nextParse,n,0,e,t,r,a)}else{var I=n.request.benchmarkInfo;I&&(I.pdcet=b8e.getTimer()),t.call(r,n)}},_readDatasBodyAsync:function(e,t,r,a,n){if(e){var s=t.readInt(),i=t.readInt(),o=r[s];if(o)t.offset+=i;else{var l=t.readBytes(i);r[(o=e.decode(l)).__uuid=s]=o}var u=a[n];(u=u||(a[n]=[]))[u.length]=o}},_readDatasBody:function(e,t,r,a,n,s){if(e){for(var i=[],o=t.readByte(),l=0;l<o;l++){for(var u=[l],d=l+"",c=t.readByte(),f=t.readByte(),_=0;_<f;_++){var h=c?t.readString():t.readInt();d+="_"+(u[u.length]=h)}u.uid=d,i[l]=u}var p=t.readInt();if(r)for(var b=t.readBytes(p),m=e.decode(b),g=i.length,v=0;v<g;v++){var y=i[v].uid,A=r[y];(A=A||(r[y]=[]))[A.length]=m}else{var x={__isBytesInfo:!0,buffer:t,offset:t.offset,length:p,data:null};t.offset+=p,b8e.SHC(x),n[n.length]=x;for(var C=i.length,D=0;D<C;D++){var E=i[D],B=E.uid,R=a[B];if(R||((R=a[B]=[]).__index=0),R[R.length]=x,2==E.length){var T=E[0],w=s[T];w||((w=s[T]=[]).__map={});var L=w.__map,S=E[1];L[S]||(L[S]=!0,w[w.length]=+S||S)}}}}},setKeys:function(e,t,r){if(e){var a=this;if(!r&&a._keysListByAlias[e])return void b8e.error(1003,e);var n=a._keysGroupByNs[t];if(!n){n=a._keysGroupByNs[t]=[];for(var s=r?null:a._keysListByAlias[e]=[],i=arguments.length,o=3;o<i;o++){var l=arguments[o];if(l){var u=void 0;if(Array.isArray(l)){var d=l.length;d<1&&b8e.error(1004,o),u=[];for(var c=0;c<d;c++)u[u.length]=b8e.getAliasName(l[c])}else{u=[b8e.getAliasName(l)]}s&&a._hasKeys(s,u)?b8e.warn(1101,e,u.join(",")):(r||(s[s.length]=u),a._hasKeys(n,u)?b8e.warn(1102,e,t,u.join(",")):n[n.length]=u)}else b8e.error(1005,l)}}}else b8e.error(1006)},_hasKeys:function(e,t){for(var r=!1,a=t.length,n=e.length,s=0;s<n;s++){var i=e[s],o=i.length;if(o===a){r=!0;for(var l=0;l<o;l++){var u=i[l];if(t.indexOf(u)<0){r=!1;break}}}}return r},_parseDatasByUid:function(e,t){var r=this;r._parseTabelBody(e);var a=!1,n=r._datasUidByNs[e];if(n){a=!0;var s=n[t];if(s){for(var i=s.length,o=0;o<i;o++){var l=s[o];r._parseData(e,l)}return s.length=0,delete n[t],b8e.macro.BENCHMARK&&100<i&&b8e.warn(1108,e,t,i),!0}}var u=r._bytesUidByNs[e];if(u){a=!0;var d=u[t];if(d){for(var c=d.length,f=0;f<c;f++){var _=d[f];r._parseData(e,_)}return d.length=0,delete u[t],!0}}return a||b8e.error(1007,e),!1},_nextData:function(e){var t=!1,r=this._aliasByName[e];r||(t=!0,r=e);var a=null,n=this._namesByAlias[r];if(n)if(t)for(var s=n.length,i=0;i<s;i++){var o=n[i];if(a=this._parseNextData(o))break}else a=this._parseNextData(e);else b8e.error(1009,r);return a},_parseNextData:function(e){var t=this;t._parseTabelBody(e);var r=!1,a=t._bytesListByNs[e];if(a){r=!0;var n=null,s=a.length;if(0<s){var i=a[a.__index++];a.__index>=s&&(a.length=0),n=t._parseData(e,i)}else{var o=t._dotDatasByNs[e];o&&(o.__datas__||(o.__datas__=[]));var l=t._aliasByName[e];if(l){var u=t._dotDatasByAlias[l];u&&(u.__datas__||(u.__datas__=[]))}}return n}return r||b8e.error(1010,e),null},_addTypeData:function(e,t,r){var a=e[this._typeDatasValue];a=a||(e[this._typeDatasValue]={});var n=!1,s=r.__uuid;if(s){var i=a.__map__;(i=i||(a.__map__={}))[s]||(n=!0,i[s]=!0)}else n=!0;if(n){var o=a.__datas__;o=o||(a.__datas__=[]),a[t]||(a[t]=r,o[o.length]=r)}},_addKeysData:function(e,t,r){var a=e[t],n=(a=a||(e[t]={})).__key_datas__;n=n||(a.__key_datas__={});var s=a.__keys__;s=s||(a.__keys__=[]),n[r]||(n[r]=!0,s[s.length]=r)},_addData:function(e,t){var r=!1,a=t.__uuid;if(a){var n=e.__map__;(n=n||(e.__map__={}))[a]||(r=!0,n[a]=!0)}else r=!0;if(r){var s=e.__datas__;s?(Array.isArray(s)||(s=[s],e.__datas__=s),s[s.length]=t):e.__datas__=t}},_parseTabelBody:function(e){var t=this,r=t._bufferByNs[e];if(r){delete t._bufferByNs[e];var a=t._ctorByNs[e],n=r.buffer,s=r.offset,i=s+r.length,o=t._bytesUidByNs[e],l=t._bytesListByNs[e],u=t._uidListKeyByNs[e];for(n.offset=s;n.offset<i;)t._readDatasBody(a,n,null,o,l,u);P.parseBodyCount++}},_parseData:function(e,t){var r=this,a=r._ctorByNs[e];if(!a)return b8e.error(1012,e),null;var n=void 0;if(t.__isBytesInfo){var s=t;if(n=s.data)return n;var i=s.buffer.readBytes(s.length,s.offset);n=a.decode(i),s.data=n}else n=t;var o=n.__uuid,l=r._aliasByName[e],u=r._dotDatasByAlias[l],d=r._dotDatasByNs[e],c=!1;if(o){var f=d.__map__;(f=f||(d.__map__={}))[o]||(c=!0,f[o]=!0)}else c=!0;if(c){var _=d.__datas__;(_=_||(d.__datas__=[]))[_.length]=n,(_=(_=u.__datas__)||(u.__datas__=[]))[_.length]=n}var h=r._keysGroupByNs[e];if(h){for(var p=h.length,b=0;b<p;b++)for(var m=d,g=u,v=h[b],y=v.length,A=y-1,x=0;x<y;x++){var C=v[x],D=n[C];if(D||(void 0===D?"undefined":R(D))===b8e.TypeNumber){var E=m[C];m=(m=(E=E||(m[C]={}))[D])||(E[D]={}),g=(g=(E=(E=g[C])||(g[C]={}))[D])||(E[D]={}),x==A&&(r._addData(m,n),r._addData(g,n))}else void 0===D&&b8e.error(1013,e,C)}var B=r._onDataCreateByNs[e];B&&B.callback.call(B.thisArg,n,e),P.parseCount++}else b8e.error(1014,e);return n},_getAllDatas:function(e){var t=b8e.macro.BENCHMARK,r=t?b8e.getTimer():0;for(o=0;;){if(!this._nextData(e))break;o++}if(t){var a=b8e.getTimer()-r;3<a&&b8e.benchmark(3503,e,a,o)}},_getNextMatched:function(e,t,r,a,n){for(var s=b8e.macro.BENCHMARK,i=s?b8e.getTimer():0,o=void(u=0);;){if(!this._nextData(e))break;if(u++,o=(o=t[r])?o[a]:void 0,!n&&o)break}if(s){var l=b8e.getTimer()-i;3<l&&b8e.benchmark(3506,e,l,u)}return o},_getUidMatched:function(e,t,r,a,n){for(var s=this._namesByAlias[e],i=s.length,o=void 0,l=0;l<i;l++){var u=s[l];if(this._parseDatasByUid(u,r)){if(Array.isArray(a))for(var d=a.length,c=0;c<d;c++){var f=a[c],_=n[f];if(void 0===(t=o=(o=t[f])?o[_]:void 0))break}else o=(o=t[a])?o[n]:void 0;break}}return o},getMajorKeysByAlias:function(e,t){void 0===t&&(t=0);var r=this._namesByAlias[e];if(!r)return b8e.error(1018,e),null;var a=r[0];return this.getMajorKeys(a,t)},getMajorKeys:function(e,t){void 0===t&&(t=0);var r=this._keysGroupByNs[e];if(!r)return b8e.error(1019,e),null;var a=r[t];return a||(b8e.error(1020,e,t),null)},getDataAsync:function(e,t,r,a,n,s,i,o){var l=this,u=l._namesByAlias[e];if(u){var d=u[0];if(l._isAsyncByNs[d]){var c=l._keysGroupByNs[d];if(c){var f=l._getKeysIndex(e,t),_=-1<f?c[f]:null;if(_){for(var h=""+f,p=_.length,b=0;b<p;b++){h+="_"+t[_[b]]}var m=l._partPath+"/"+d+"/"+h+".bcdp",g=l._isLoadedByNs[d];if(g)if(n=!!n,void 0===s&&(s=!0),void 0===i&&(i=!0),g[m]){var v=l._equalsData(e,null,n,s,i,t,_,f);if(o){var y=[v];y=y.concat(o),r.apply(a,y)}else r.call(a,v)}else{var A=l._isLoadingByNs[d];if(A){var x=l._partCallbackByNs[d],C=(x=x||(l._partCallbackByNs[d]={}))[h];if(C||((C=x[h]=b8e.HashMap.get()).localHashable=!0,C.polyfillHash=!0),b8e.CallBackUtil.addCallBackData(C,r,a,o,{alias:e,keys:_,equals:t,uid:h,index:f,isArray:n,strict:s,unique:i}),!A[m]){A[m]=!0,++E>P.MAX_ASYNC_QUEUE&&b8e.warn(4040,P.MAX_ASYNC_QUEUE,E);var D={useManifest:!1};D.priority=b8e.ResMgr.CFG_PRIOR,b8e.res.loadRes(m,null,l._dataPartComplete,l,[d,m,h],D)}}}}}else b8e.error(1023,e)}else b8e.error(1022,d)}else b8e.error(1021,e)},_dataPartComplete:function(e,t,r,a,n){var s=this,i=s._isLoadedByNs[r];if(i){if(i[a]=!0,!e){var o=b8e.ProtoByteBuffer.wrap(t),l=o.readByte();if(39!==l)return void b8e.error(1202,n,l,39);for(var u=s._ctorByNs[r],d=s._datasUidByNs[r],c=s._dataUuidByNs[r],f=s._countByNs,_=0,h=f[r];o.offset<o.limit;)h++,s._readDatasBodyAsync(u,o,c,d,n),P.asyncParseCount++,_++;f[r]=h,P.loadPartCount++,b8e.macro.BENCHMARK&&100<_&&b8e.warn(1107,r,n,_)}var p=null,b=s._partCallbackByNs[r];b&&(p=b[n]),p&&0<p.count()&&(b8e.CallBackUtil.exceteCallBackData(null,p,null,s._excetePartGetter,s),b8e.CallBackUtil.removeAllCallBackData(p)),E--}},_excetePartGetter:function(e){for(var t=e.alias,r=e.isArray,a=e.strict,n=e.unique,s=e.uid,i=e.keys,o=e.index,l=e.equals,u=s.split("_"),d=i.length,c=0;c<d;c++)l[i[c]]=u[c+1];return this._equalsData(t,null,r,a,n,l,i,o)},getData:function(e,t,r,a,n){var s=this,i=s._namesByAlias[e];if(!i)return b8e.error(1027,e),null;var o=i[0];if(s._isAsyncByNs[o])return b8e.error(1028,o),null;var l=s._keysGroupByNs[o];if(!l)return b8e.error(1026,e),null;var u=s._getKeysIndex(e,t),d=-1<u?l[u]:null;return d?(r=!!r,void 0===a&&(a=!0),void 0===n&&(n=!0),d.__isUKeys?s._equalsData(e,null,r,a,n,t,d,u):s._equalsData(e,t,r,a,n)):null},_getKeysIndex:function(e,t,r){var a=this._namesByAlias[e];if(!a)return b8e.error(1015,e),null;var n=a[0],s=this._keysGroupByNs[n];if(!s)return b8e.error(1031,e),null;var i=this._indexEqualsByAlias[e],o=i.get(t,this),l=0,u=0;if(void 0===o){if(o=-1,!t.charCodeAt)for(var d in t)0!==d.indexOf("__")&&u++;for(var c=s.length,f=0;f<c;f++){for(var _=null,h=s[f],p=h.length,b=l=0;b<p;b++){var m=h[b];if(t.charCodeAt){if(t!==m){_=null;break}_=h}else{if(void 0===t[m]){_=null;break}l++,_=h}}if(_&&(!u||l==u)){o=f;break}}var g=t.charCodeAt?100:0,v=this._equalsIndexByAlias[e],y=o+g;if(v[y])if(t.charCodeAt)b8e.error(1029,e,t);else{var A=[],x=r||t;for(var C in x)0!==C.indexOf("__")&&(A[A.length]=C);b8e.error(1029,e,A.join(","))}else i.set(t,o,this),v[y]=t;if(o<0)if(t.charCodeAt)b8e.error(1017,e,t);else{var D=[],E=r||t;for(var B in E)0!==B.indexOf("__")&&(D[D.length]=B);b8e.error(1017,e,D.join(","))}}return o},_equalsData:function(e,t,r,a,n,s,i,o){if(!e)return b8e.error(1030),null;r=!!r,void 0===a&&(a=!0),void 0===n&&(n=!0),void 0===o&&(o=0);var l=this,u=l._dotDatasByAlias[e],d=null;if(t){var c=l._keysListByAlias[e];if(!c)return b8e.error(1031,e),null;var f=l._getKeysIndex(e,t);if(f<0)return null;for(var _=(d=c[f]).length,h=0;h<_;h++){var p=d[h],b=t[p];if(b||(void 0===b?"undefined":R(b))===b8e.TypeNumber){var m=u[p];if(void 0===(m=m?m[b]:void 0)){var g=!1;if(void 0===(m=p===l._idName?l._getUidMatched(e,u,"0_"+b,p,b):(g=!0,l._getNextMatched(e,u,p,b,r)))){var v=u[p];(v=v||(u[p]={}))[b]=null,u[b]=v,m=null}g&&b8e.warn(1103,e,d.join(","))}else r&&p!==l._idName&&(l._getAllDatas(e),b8e.warn(1106,e,p));if(!(u=m))break}else b8e.error(1033,e,p,b)}}else{for(var y=""+o,A=i.length,x=0;x<A;x++){y+="_"+s[i[x]]}var C=l._uidName,D=u[C];if(void 0===(D=D?D[y]:void 0)){void 0===(D=l._getUidMatched(e,u,y,i,s))&&(D=null);var E=u[C];(E=E||(u[C]={}))[y]=D}u=D}return l._getDotDataResult(e,u,s||t,r,a,n)},_getDotDataResult:function(e,t,r,a,n,s){var i=null;if(void 0===n&&(n=!0),void 0===s&&(s=!0),t){var o=t.__datas__;if(o)if(a)i=Array.isArray(o)?o:[o];else if(Array.isArray(o)){if(s&&1<o.length){var l=[],u=r;for(var d in u)0!==d.indexOf("__")&&(l[l.length]=d+"="+u[d]);b8e.warn(3103,e,l.join(","))}i=o[0]}else i=o}if(n&&!i){var c=this._namesByAlias[e],f=[],_=r;for(var h in _)0!==h.indexOf("__")&&(f[f.length]=h+"="+_[h]);b8e.warn(3104,c.join(","),f.join(","))}return i},getDatas:function(e){if(!e)return b8e.error(1034),null;var t=this,r=void 0,a=t._aliasByName[e];if(a){if(t._isAsyncByNs[e])return b8e.error(1035,e),null;if(!(r=t._dotDatasByNs[e]))return b8e.error(1036,e),null}else{a=e;var n=t._namesByAlias[a];if(!n)return b8e.error(1037,a),null;var s=n[0];if(t._isAsyncByNs[s])return b8e.error(1038,s),null;if(!(r=t._dotDatasByAlias[a]))return b8e.error(1039,a),null}t._getAllDatas(e),b8e.macro.BENCHMARK&&100<o&&b8e.warn(1104,e,o);var i=r.__datas__;return i||(b8e.warn(1040,e),null)},getKeys:function(e,t){if(!e)return b8e.error(1041),null;var r=this,a=e,n=r._aliasByName[e];if(n){if(r._isAsyncByNs[e])return b8e.error(1042,e),null}else{n=e;var s=r._namesByAlias[n];if(!s)return b8e.error(1044,n),null;if(a=s[0],r._isAsyncByNs[a])return b8e.error(1045,a),null}if(t)t=b8e.getAliasName(t);else{var i=r._keysGroupByNs[a];if(!i)return b8e.error(1047,a),null;var o=i[0];o||b8e.error(1048,a),t=o[0]}var l=r._getKeysIndex(n,t);if(-1<l){var u=r._keyValusMapByAlias,d=u[n],c=(d=d||(u[n]={}))[t];if(!c){c=d[t]=[];for(var f=0,_=r._namesByAlias[n],h=_.length,p=0;p<h;p++){var b=_[p];r._parseTabelBody(b);var m=r._uidListKeyByNs[b],g=m[l];if(g){for(var v=g.length,y=0;y<v;y++)c[f]=g[y],f++;g.length=0,delete m[l]}else b8e.warn(3507,b,t)}}return c}return null},onDataCreate:function(e,t,r){e?this._onDataCreateByNs[e]={callback:t,thisArg:r}:b8e.error(1050)},allot:function(e,t,r){var a=this._allotQueue;r&&r.charCodeAt&&(r=b8e.getNormP(r,!0)),a[a.length]={alias:b8e.getNormP(e,!0),name:t,clsRef:r,args:arguments}},runAllot:function(e,t,r){b8e.setTimeout(this._nextAllot,this,0,e,t,r)},_nextAllot:function(e,t,r){var a=this,n=a._allotQueue.length;if(a._allotIdx<n){for(var s=0;a._allotIdx<n;){var i=a._allotQueue[a._allotIdx],o=i.alias,l=i.name,u=i.clsRef,d=i.args,c=[],f=d.length;if(3<f)for(var _=0,h=3;h<f;h++){var p=d[h];c[_]=p,_++,p?p.length<1&&b8e.error(1051,+(h-2)):b8e.error(1052,+(h-2))}else c[0]=a._idName;if(5<c.length)return void b8e.error(1053,5);var b=c[0],m=c[1],g=c[2],v=c[3],y=c[4];if(!a._aliasByName[l]){var A=a._namesByAlias[o];(A=A||(a._namesByAlias[o]=[]))[A.length]=l,a._aliasByName[l]=o}var x=a._dotDatasByAlias[o];x=x||(a._dotDatasByAlias[o]={});var C=a._indexEqualsByAlias[o];C||((C=a._indexEqualsByAlias[o]=b8e.HashMap.get()).localHashable=!0,C.polyfillHash=!0);var D=a._equalsIndexByAlias[o];D=D||(a._equalsIndexByAlias[o]={}),a._allotIdx++;var E=game[o];if(E&&E.__GameConfig)E.init(a,o,l);else{if(u)if(b8e.applyType(u),u.__TypeFunction)E=new u(b,m,g,v,y);else if(u.charCodeAt){var B=game[u];if(!B){b8e.error(1054,u);continue}if(b8e.applyType(B),!B.__TypeFunction){b8e.error(1055,u);continue}E=new B(b,m,g,v,y)}else E=u;else E=new b8e.GameConfig(b,m,g,v,y);(game[o]=E).init(a,o,l)}if(++s>=P.BATCH_ALLOT)break}if(r){var R=r.onProgress;if(R){var T=r.onProgressThis,w=a._allotIdx,L=n;R.call(T,a,w,L)}}b8e.setTimeout(a._nextAllot,a,0,e,t,r)}else e.call(t,this)},getCtorMap:function(){return this._ctorByNs},cancelLoad:function(){this._super()},restore:function(){this._super(),this.resetParams()},recycle:function(){var e=this;if(e._url=null,e._partPath=null,e._root=null,e._config=null,e._datasUidByNs=null,e._dataUuidByNs=null,e._bytesListByNs=null,e._bytesUidByNs=null,e._isLoadingByNs=null,e._isLoadedByNs=null,e._countByNs=null,e._ctorByNs=null,e._bufferByNs=null,e._keysListByAlias=null,e._indexEqualsByAlias){for(var t in e._indexEqualsByAlias){e._indexEqualsByAlias[t].release(),delete e._indexEqualsByAlias[t]}e._indexEqualsByAlias=null}if(e._equalsIndexByAlias=null,e._dotDatasByNs=null,e._dotDatasByAlias=null,e._onDataCreateByNs=null,e._namesByAlias=null,e._aliasByName=null,e._partCallbackByNs){for(var r in e._partCallbackByNs){var a=e._partCallbackByNs[r];for(var n in a){a[n].release(),delete a[n]}delete e._partCallbackByNs[r]}e._partCallbackByNs=null}e._super()}});P.tabelCount=0,P.parseBodyCount=0,P.totalCount=0,P.parseCount=0,P.asyncParseCount=0,P.loadPartCount=0,P.insts=[],P.dumpInfo=function(){var e="";e+="\n\u540c\u6b65\u8868\uff1a"+P.parseBodyCount+"/"+P.tabelCount,e+="\n\u540c\u6b65\u6570\u636e\uff1a"+P.parseCount+"/"+P.totalCount,e+="\n\u5f02\u6b65\u6587\u4ef6\uff1a"+P.loadPartCount,e+="\n\u5f02\u6b65\u89e3\u6790\uff1a"+P.asyncParseCount,e+="\n\u89e3\u6790\u4fe1\u606f\uff1a";for(var t=[],r=P.insts,a=r.length,n=0;n<a;n++){var s=r[n];t=t.concat(P._dumpConfigInfo(s))}t.sort(P._onSortParseInfo);for(var i=t.length,o=0;o<i;o++)e+="\n"+t[o].info;e+="\n==============================",e+="\n\u914d\u7f6e\u4fe1\u606f\uff1a",t.sort(P._onSortCfgInfo),i=t.length;for(var l=0;l<i;l++)e+="\n"+t[l].info;return e},P._dumpConfigInfo=function(e){var t=[],r=e._dotDatasByNs,a=e._isAsyncByNs,n=e._countByNs;for(var s in n){var i={},o=r[s].__datas__;i.parseCount=o?o.length:0;var l=n[s];i.totalCount=l,i.async=a[s],i.info=s+":"+i.parseCount+"/"+i.totalCount+(i.async?"(async)":""),t[t.length]=i}return t},P._onSortParseInfo=function(e,t){return e.async&&!t.async?-1:!e.async&&t.async?1:e.parseCount>t.parseCount?-1:e.parseCount<t.parseCount?1:e.totalCount>t.totalCount?-1:e.totalCount<t.totalCount?1:0},P._onSortCfgInfo=function(e,t){return e.async&&!t.async?-1:!e.async&&t.async?1:e.totalCount>t.totalCount?-1:e.totalCount<t.totalCount?1:e.parseCount>t.parseCount?-1:e.parseCount<t.parseCount?1:0},P.CONFIG_IMMED_DECODE=!1,P.BATCH_DECODE=100,P.BATCH_ALLOT=100;var t=new b8e.Pool(P,1024);P.get=function(){return t.get()},P.put=function(e){return t.put(e)};var E=0;P.MAX_ASYNC_QUEUE=10,b8e.RC("$$b8e","$$ConfigData",e)})(),function(){var e,t=e=b8e.Asset.extends({ctor:function(){this._super()},setPrefab:function(e,t){this._prefab=e,this._depends=t,this.loadRawAssets()},getPrefab:function(){return this._prefab},loadRawAssets:function(){this._rawAssetsLoad||(this._rawAssetsLoad=!0)},unloadRawAssets:function(){this._rawAssetsLoad&&(this._rawAssetsLoad=!1)},onRawAssetLoaded:function(){},recycle:function(){this.unloadRawAssets(),this._prefab=null,this._depends=null,this._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$Prefab",e)}(),function(){var e,t=e=b8e.Asset.extends({_url:null,_audioClip:null,_audioIds:null,_idsByName:null,_nameById:null,ctor:function(){var e=this;e._super(),e._url=null,e._audioIds=[],e._idsByName={},e._nameById={}},setAudioClip:function(e,t){this._url=e,this._audioClip=t},url:{get:function(){return this._url}},play:function(e,t,r,a,n){var s=this;if(!s._audioClip)return-1;e=!!e,void 0===t&&(t=1);var i=b8e.audioEngine.play(s._audioClip,e,t),o=s._audioIds;if(o[o.length]=i,r){var l=s._idsByName[r];l=l||(s._idsByName[r]=[]),s._nameById[i]=r,l[l.length]=i}var u=s;return b8e.audioEngine.setFinishCallback(i,function(){b8e.audioEngine.setFinishCallback(i,null);var e=u._audioIds.indexOf(i);-1<e&&u._audioIds.splice(e,1);var t=u._nameById[i];if(t){var r=u._idsByName[t];-1<(e=r.indexOf(i))&&r.splice(e,1),r.length<1&&delete u._idsByName[t],delete u._nameById[i]}u._audioIds.length<1&&a&&a.call(n,u)}),i},stop:function(e){var t=this;if(e){var r=-1,a=void 0,n=void 0,s=void 0;e.charCodeAt?(a=e,(s=t._idsByName[a])&&(s.forEach(function(e){e=parseInt(e),-1<(n=this._audioIds.indexOf(e))&&this._audioIds.splice(n,1),b8e.audioEngine.setFinishCallback(e,null),b8e.audioEngine.stop(e),delete this._nameById[e]},t),s.length=0,delete t._idsByName[a])):(r=e,-1<(n=t._audioIds.indexOf(r))&&t._audioIds.splice(n,1),b8e.audioEngine.setFinishCallback(r,null),b8e.audioEngine.stop(r),(a=t._nameById[r])&&(s=t._idsByName[a],-1<(n=s.indexOf(r))&&s.splice(n,1),s.length<1&&delete t._idsByName[a],delete t._nameById[r]))}else t._audioIds.forEach(function(e){b8e.audioEngine.setFinishCallback(e,null),b8e.audioEngine.stop(e)},t),t._audioIds.length=0,t._idsByName={},t._nameById={}},setVolume:function(t){this._audioIds.forEach(function(e){b8e.audioEngine.setVolume(e,t)},this)},recycle:function(){var e=this;e.stop(),e._url=null,e._audioClip&&(b8e.audioEngine.uncache(e._audioClip),e._audioClip.destroy(),e._audioClip=null),e._super()},dispose:function(){this._audioIds=null,this._idsByName=null,this._nameById=null,this._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$Sound",e)}(),function(){var e,t=e=b8e.Asset.extends({__UIAsset:!0,ctor:function(){this._super()},setUIData:function(e,t){this._url=e;var r=b8e.proto.ui_desc.UIDescMessage,a=b8e.ProtobufUtil.decodeMessage(e,t,r);3===a.version?this._data=a:b8e.warn(1301,e)},getData:function(){return this._data},_initDependReses:function(){var e=this;if(!e._dependList){e._dependList=[],e._dependMap={};for(var t=e._data.nodes,r=t.length,a=0;a<r;a++){var n=t[a];if(n){var s=null;switch(n.type){case 1:s=n.sprite,e._addSpriteRes(s);break;case 2:s=n.label,e._addLabelRes(s);break;case 3:s=n.richText,e._addRichTextRes(s)}}}}},preloadDepends:function(){this._initDependReses();for(var e=[],t=this._dependList,r=t.length,a=0;a<r;a++){var n=t[a];e[a]=n}return b8e.res.preloadReses(e),!0},loadDepends:function(e,t){var r=this,a=r._dependLoadList=r._dependLoadList||[];a.length=0;var n=r._dependLoadMap=r._dependLoadMap||b8e.HashMap.get();n.clear(),r._onDependsComplete=e,r._onDependsCompleteThis=t,r._initDependReses();for(var s=r._dependList,i=s.length,o=0;o<i;o++){var l=s[o],u=l.url;n.set(u,!0),a[o]=l}if(0<i)for(var d=0;d<i;d++){var c=a[d],f=c.url,_=c.type,h=c.options;b8e.res.loadRes(f,_,r._onDependResComplete,r,[f],h)}else r._onDependsComplete&&r._onDependsComplete.call(r._onDependsCompleteThis,r)},_addLabelRes:function(e){var t=b8e.ResMgr.UI_DEPEND_PRIOR,r=this.request.recycleDelay,a=e.fontFile;if(a){var n=b8e.ResMgr.UI_ROOT+"/"+a,s=this._dependMap;if(!s[n]){var i=this._dependList,o={priority:t,recycleDelay:r},l=void 0;if(b8e.bfBundle){var u=n.indexOf("ui/");if(-1<u){var d=n.substring(u+3,n.indexOf(".bbf"));l=b8e.bfBundle[d]}}o.rawData=l,i[i.length]={url:n,type:b8e.BitmapFont,options:o},s[n]=!0}}},_onDependResComplete:function(e,t,r){this._processQueue(r)},_addSpriteRes:function(e){var t=this,r=b8e.ResMgr.UI_DEPEND_PRIOR,a=t.request.recycleDelay,n=e.atlas,s=e.frame;if(n){if(s){var i=b8e.ResMgr.UI_ROOT+"/"+n,o=t._dependMap;if(!o[i]){var l=t._dependList,u={priority:r,recycleDelay:a},d=void 0;if(b8e.tbBundle){var c=i.indexOf("ui/");if(-1<c){var f=i.substring(c+3,i.indexOf(".btf"));d=b8e.tbBundle[f]}}u.rawData=d,l[l.length]={url:i,type:b8e.FrameAtlas,options:u},o[i]=!0}}}else if(s){var _=b8e.ResMgr.UI_ROOT+"/"+s,h=t._dependMap;if(!h[_]){var p=t._dependList,b={priority:r,recycleDelay:a};p[p.length]={url:_,type:b8e.SpriteFrame,options:b},h[_]=!0}}},_addRichTextRes:function(e){var t=e.imageAtlas;if(t){var r=b8e.ResMgr.UI_ROOT+"/"+t,a=this._dependMap;if(!a[r]){var n=this._dependList;n[n.length]={url:r,type:b8e.FrameAtlas},a[r]=!0}}},_processQueue:function(e){var t=this,r=t._dependLoadMap;r.del(e),r.count()<1&&(t._onDependsComplete&&t._onDependsComplete.call(t._onDependsCompleteThis,t),t.unloadDepends())},unloadDepends:function(){var e=this._dependLoadList;if(e){for(var t=e.length,r=0;r<t;r++){var a=e[r].url;b8e.res.unloadRes(a,this._onDependResComplete,this)}e.length=0}var n=this._dependLoadMap;n&&n.clear()},cancelLoad:function(){this.unloadDepends(),this._onDependsComplete=null,this._onDependsCompleteThis=null},restore:function(){this._super()},recycle:function(){var e=this;e._url=null,e._data=null;var t=e._dependList;t&&(t.length=0,e._dependList=t=null),e._dependMap=null,e._super()},dispose:function(){var e=this,t=e._dependLoadList;t&&(t.length=0,e._dependLoadList=t=null);var r=e._dependLoadMap;r&&(r.release(),e._dependLoadMap=r=null),e._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)};var u=null;t.parseBundle=function(e,t){u=u||{};var r=e.url,a=b8e.ProtoByteBuffer.wrap(t);if(3===a.readByte()){for(var n=[],s=a.readInt(),i=0;i<s;i++){var o=a.readString(),l=a.readInt();u[o]={__isBytesInfo:!0,buffer:a,offset:a.offset,length:l},a.offset+=l,n[n.length]=o+".bui"}e.preloadDepends&&b8e.res.preloadReses(n),n.length=0}else b8e.error(1303,r)},t.getUIData=function(e){var t=void 0;if(u){var r=e.substring(0,e.indexOf("."));if((t=u[r])&&t.__isBytesInfo)t=t.buffer.readBytes(t.length,t.offset)}return t},b8e.RC("$$b8e","$$UIAsset",e)}(),function(){var e,t=e=b8e.Asset.extends({__BitmapFont:!0,ctor:function(){this._super()},preloadDepends:function(){return!0},setFontData:function(e,t,r,a){var n=this;n._url=e?e.replace(/\\/g,"/"):null,n._dirUrl=n._url?n._url.substring(0,n._url.lastIndexOf("/")):null,n._data=t,n._imgUrl=n._dirUrl+"/"+t.atlasName,n._onCompleteCb={func:r,thisArg:a},b8e.res.loadRes(n._imgUrl,b8e.SpriteFrame,n.onFrameComplete,n,null,{format:"bti"})},onFrameComplete:function(e,t){var r=this;if(e)r._font=null;else{var a=new cc.BitmapFont;a.spriteFrame=t.getFrame(),a.fontSize=0|+r._data.fontSize,a._fntConfig=r._data,r._font=a}r._atlasComplete()},getFont:function(){return this._font},_atlasComplete:function(){var e=this;e._onCompleteCb&&e._onCompleteCb.func&&e._onCompleteCb.func.call(e._onCompleteCb.thisArg,e)},cancelLoad:function(){var e=this;e._imgUrl&&(b8e.res.unloadRes(e._imgUrl,e.onFrameComplete,e),e._imgUrl=null),e._onCompleteCb=null,e._super()},recycle:function(){var e=this;e._url=null,e._dirUrl=null,e._data=null,e._font=null,e._super()}}),r=new b8e.Pool(t,1024);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$BitmapFont",e)}(),function(){if("undefined"!=typeof cc)if(b8e.isRuntime){var a=b8e.audioEngine=jsb.AudioEngine,r={id:-1,clip:"",loop:!(a.setMaxWebAudioSize=function(){}),volume:1},n={volume:1};a.play=function(e,t,r){if("number"!=typeof r&&(r=1),e)return e.loaded?a.play2d(e._nativeAsset,t,r):void 0},a.playMusic=function(e,t){return a.stop(r.id),r.id=a.play(e,t,r.volume),r.loop=t,r.clip=e,r.id},a.stopMusic=function(){a.stop(r.id)},a.pauseMusic=function(){return a.pause(r.id),r.id},a.resumeMusic=function(){return a.resume(r.id),r.id},a.getMusicVolume=function(){return r.volume},a.setMusicVolume=function(e){return r.volume=handleVolume(e),a.setVolume(r.id,r.volume),e},a.isMusicPlaying=function(){return a.getState(r.id)===a.AudioState.PLAYING},a.playEffect=function(e,t){return a.play(e,t||!1,n.volume)},a.setEffectsVolume=function(e){n.volume=handleVolume(e)},a.getEffectsVolume=function(){return n.volume},a.pauseEffect=function(e){return a.pause(e)},a.pauseAllEffects=function(){var e=a.getState(r.id)===a.AudioState.PLAYING;a.pauseAll(),e&&a.resume(r.id)},a.resumeEffect=function(e){a.resume(e)},a.resumeAllEffects=function(){var e=a.getState(r.id)===a.AudioState.PAUSED;a.resumeAll(),e&&a.getState(r.id)===a.AudioState.PLAYING&&a.pause(r.id)},a.stopEffect=function(e){return a.stop(e)},a.stopAllEffects=function(){var e=a.getState(r.id)===a.AudioState.PLAYING,t=a.getCurrentTime(r.id);a.stopAll(),e&&(r.id=a.play(r.clip,r.loop),a.setCurrentTime(r.id,t))},a._break=a.pauseAll,a._restore=a.resumeAll,a._uncache=a.uncache,a.uncache=function(e){if(e){var t=e._nativeAsset;a._uncache(t)}}}else{var s=cc.js,i=0,o=s.createMap(!0),l={},u=[],d=function(e){e._finishCallback=null,u.length<32?(e.off("ended"),e.off("stop"),e.src=null,u.push(e)):e.destroy()},c=function(e){var t=i++,r=l[e];if(r=r||(l[e]=[]),b8e.params.isBiliGame&&null!=b8e.params.isBiliGame&&r&&r.length)return r[0];if(h._maxAudioInstance<=r.length){var a=r.shift();f(a).stop()}function n(){if(f(this.id)){delete o[this.id];var e=r.indexOf(this.id);cc.js.array.fastRemoveAt(r,e)}d(this)}var s=u.pop()||new b8e.Audio;return s.on("ended",function(){this._finishCallback&&this._finishCallback(),n.call(this)},s),s.on("stop",n,s),s.id=t,o[t]=s,r.push(t),s},f=function(e){return o[e]},_=function(e){return void 0===e?e=1:"string"==typeof e&&(e=Number.parseFloat(e)),e},h={_maxWebAudioSize:2097152,_maxAudioInstance:24,_id2audio:o,play:function(e,t,r){var a,n;if(e)return a=e.url,(n=c(a)).src=e,n.setLoop(t||!1),r=_(r),n.setVolume(r),n.play(),n.id},setLoop:function(e,t){var r=f(e);r&&r.setLoop&&r.setLoop(t)},isLoop:function(e){var t=f(e);return!(!t||!t.getLoop)&&t.getLoop()},setVolume:function(e,t){var r=f(e);r&&r.setVolume(t)},getVolume:function(e){var t=f(e);return t?t.getVolume():1},setCurrentTime:function(e,t){var r=f(e);return!!r&&(r.setCurrentTime(t),!0)},getCurrentTime:function(e){var t=f(e);return t?t.getCurrentTime():0},getDuration:function(e){var t=f(e);return t?t.getDuration():0},getState:function(e){var t=f(e);return t?t.getState():this.AudioState.ERROR},setFinishCallback:function(e,t){var r=f(e);r&&(r._finishCallback=t)},pause:function(e){var t=f(e);return!!t&&(t.pause(),!0)},_pauseIDCache:[],pauseAll:function(){for(var e in o){var t=o[e];t.getState()===b8e.Audio.State.PLAYING&&(this._pauseIDCache.push(e),t.pause())}},resume:function(e){var t=f(e);t&&t.resume()},resumeAll:function(){for(var e=0;e<this._pauseIDCache.length;++e){var t=this._pauseIDCache[e],r=f(t);r&&r.resume()}this._pauseIDCache.length=0},stop:function(e){var t=f(e);return!!t&&(t.stop(),!0)},stopAll:function(){for(var e in o){var t=o[e];t&&t.stop()}},setMaxAudioInstance:function(e){this._maxAudioInstance=e},getMaxAudioInstance:function(){return this._maxAudioInstance},uncache:function(e){var t;if(e){t=e.url;var r=l[t];if(r)for(;0<r.length;){var a=r.pop(),n=o[a];n&&(n.stop(),delete o[a])}}},uncacheAll:function(){this.stopAll();var e=void 0;for(var t in o)(e=o[t])&&e.destroy();for(;e=u.pop();)e.destroy();o=s.createMap(!0),l={}},getProfile:function(){},setMaxWebAudioSize:function(e){this._maxWebAudioSize=1024*e},_breakCache:null,_break:function(){for(var e in this._breakCache=[],o){var t=o[e];t.getState()===b8e.Audio.State.PLAYING&&(this._breakCache.push(e),t.pause())}},_restore:function(){if(this._breakCache){for(;0<this._breakCache.length;){var e=this._breakCache.pop(),t=f(e);t&&t.resume&&t.resume()}this._breakCache=null}},_music:{id:-1,loop:!1,volume:1},_effect:{volume:1,pauseCache:[]},playMusic:function(e,t){var r=this._music;return this.stop(r.id),r.id=this.play(e,t,r.volume),r.loop=t,r.id},stopMusic:function(){this.stop(this._music.id)},pauseMusic:function(){return this.pause(this._music.id),this._music.id},resumeMusic:function(){return this.resume(this._music.id),this._music.id},getMusicVolume:function(){return this._music.volume},setMusicVolume:function(e){e=_(e);var t=this._music;return t.volume=e,this.setVolume(t.id,t.volume),t.volume},isMusicPlaying:function(){return this.getState(this._music.id)===this.AudioState.PLAYING},playEffect:function(e,t){return this.play(e,t||!1,this._effect.volume)},setEffectsVolume:function(e){e=_(e);var t=this._music.id;for(var r in this._effect.volume=e,o){var a=o[r];a&&a.id!==t&&h.setVolume(r,e)}},getEffectsVolume:function(){return this._effect.volume},pauseEffect:function(e){return this.pause(e)},pauseAllEffects:function(){var e=this._music.id,t=this._effect;for(var r in t.pauseCache.length=0,o){var a=o[r];if(a&&a.id!==e)a.getState()===this.AudioState.PLAYING&&(t.pauseCache.push(r),a.pause())}},resumeEffect:function(e){this.resume(e)},resumeAllEffects:function(){for(var e=this._effect.pauseCache,t=0;t<e.length;++t){var r=e[t],a=o[r];a&&a.resume()}},stopEffect:function(e){return this.stop(e)},stopAllEffects:function(){var e=this._music.id;for(var t in o){var r=o[t];if(r&&r.id!==e)r.getState()===h.AudioState.PLAYING&&r.stop()}}};b8e.audioEngine=h}}(),function(){if("undefined"!=typeof cc){var r=cc.sys,i=[],t=void 0;if(b8e.isRuntime){t=function(e){this.src=e,this.volume=1,this.loop=!1,this.id=-1};var a=jsb.AudioEngine;t.State=a.AudioState;var n=function(e){return void 0===e?e=1:"string"==typeof e&&(e=Number.parseFloat(e)),e};(function(e){e.play=function(){a.stop(this.id);var e=this.src;e.loaded&&(this.id=a.play2d(e._nativeAsset,this.loop,this.volume))},e.pause=function(){a.pause(this.id)},e.resume=function(){a.resume(this.id)},e.stop=function(){a.stop(this.id)},e.destroy=function(){},e.setLoop=function(e){this.loop=e,a.setLoop(this.id,e)},e.getLoop=function(){return this.loop},e.setVolume=function(e){return e=n(e),this.volume=e,a.setVolume(this.id,e)},e.getVolume=function(){return this.volume},e.setCurrentTime=function(e){a.setCurrentTime(this.id,e)},e.getCurrentTime=function(){return a.getCurrentTime(this.id)},e.getDuration=function(){return a.getDuration(this.id)},e.getState=function(){return a.getState(this.id)}})(t.prototype)}else{t=function(e){cc.EventTarget.call(this),this._src=e,this._element=null,this.id=0,this._volume=1,this._loop=!1,this._nextTime=0,this._state=t.State.INITIALZING,this._onended=function(){this._state=t.State.STOPPED,this.emit("ended")}.bind(this)},cc.js.extend(t,cc.EventTarget),function(e){e._bindEnded=function(e){e=e||this._onended;var t=this._element;params.isXiaomiGame?t&&t.onEnded&&t.onEnded(e):this._src&&t instanceof HTMLAudioElement?t.addEventListener("ended",e):t.onended=e},e._unbindEnded=function(){var e=this._element;params.isXiaomiGame?e&&e.offEnded&&e.offEnded():e instanceof HTMLAudioElement?e.removeEventListener("ended",this._onended):e&&(e.onended=null)},e._onLoaded=function(){var e=this._src._nativeAsset;params.isXiaomiGame?(this._element||(this._element=qg.createInnerAudioContext()),this._element.src=e):e instanceof HTMLAudioElement?(this._element||(this._element=document.createElement("audio")),this._element.src=e.src):this._element=new s(e,this),this.setVolume(this._volume),this.setLoop(this._loop),0!==this._nextTime&&this.setCurrentTime(this._nextTime),this._state===t.State.PLAYING?this.play():this._state=t.State.INITIALZING},e.play=function(){this._state=t.State.PLAYING,this._element&&(this._bindEnded(),this._element.play())},e.destroy=function(){params.isXiaomiGame?this._element.src="":(b8e.isWeChatGame&&this._element&&this._element.destroy(),this._element=null)},e.pause=function(){this._element&&this._state===t.State.PLAYING&&(this._unbindEnded(),this._element.pause(),this._state=t.State.PAUSED)},e.resume=function(){this._element&&this._state===t.State.PAUSED&&(this._bindEnded(),this._element.play(),this._state=t.State.PLAYING)},e.stop=function(){if(this._element){params.isXiaomiGame?(this._element.seek(0),this._element.stop()):this._element.pause();try{this._element.currentTime=0}catch(e){}for(var e=0;e<i.length;e++)if(i[e].instance===this){i.splice(e,1);break}this._unbindEnded(),this.emit("stop"),this._state=t.State.STOPPED}},e.setLoop=function(e){this._loop=e,this._element&&(this._element.loop=e)},e.getLoop=function(){return this._loop},e.setVolume=function(e){this._volume=e,this._element&&(this._element.volume=e)},e.getVolume=function(){return this._volume},e.setCurrentTime=function(t){if(this._element){this._nextTime=0,b8e.isWeChatGame?params.isXiaomiGame&&this._element.seek(t):(this._unbindEnded(),this._bindEnded(function(){this._bindEnded()}.bind(this)));try{this._element.currentTime=t}catch(e){var r=this._element;if(r.addEventListener){var a=function e(){r.removeEventListener("loadedmetadata",e),r.currentTime=t};r.addEventListener("loadedmetadata",a)}}}else this._nextTime=t},e.getCurrentTime=function(){return this._element?this._element.currentTime:0},e.getDuration=function(){return this._element?this._element.duration:0},e.getState=function(){var e=this._element;return!b8e.isWeChatGame&&e&&(t.State.PLAYING===this._state&&e.paused?this._state=t.State.STOPPED:t.State.STOPPED!==this._state||e.paused||(this._state=t.State.PLAYING)),this._state},Object.defineProperty(e,"src",{get:function(){return this._src},set:function(e){return this._unbindEnded(),e?(this._src=e).loaded&&this._onLoaded():(this._src=null,params.isXiaomiGame?this._element.src="":this._element instanceof HTMLAudioElement?this._element.src="":this._element=null,this._state=t.State.INITIALZING),e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"paused",{get:function(){return!this._element||this._element.paused},enumerable:!0,configurable:!0})}(t.prototype),t.State={ERROR:-1,INITIALZING:0,PLAYING:1,PAUSED:2,STOPPED:3},b8e.audioEngine.AudioState=t.State;var s=function(e,t){this._audio=t,this._context=r.__audioSupport.context,this._buffer=e,this._gainObj=this._context.createGain(),this._volume=1,this._gainObj.gain.setTargetAtTime?this._gainObj.gain.setTargetAtTime(this._volume,this._context.currentTime,.01):this._gainObj.gain.value=1,this._gainObj.connect(this._context.destination),this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currentTimer=null,this._endCallback=function(){this.onended&&this.onended(this)}.bind(this)};(function(e){e.play=function(e){this._currentSource&&!this.paused&&(this._currentSource.onended=null,this._currentSource.stop(0),this.playedLength=0);var t=this._context.createBufferSource();t.buffer=this._buffer,t.connect(this._gainObj),t.loop=this._loop,this._startTime=this._context.currentTime,(e=e||this.playedLength)&&(this._startTime-=e);var r=this._buffer.duration,a=e,n=void 0;if(this._loop?t.start?t.start(0,a):t.notoGrainOn?t.noteGrainOn(0,a):t.noteOn(0,a):(n=r-e,t.start?t.start(0,a,n):t.noteGrainOn?t.noteGrainOn(0,a,n):t.noteOn(0,a,n)),(this._currentSource=t).onended=this._endCallback,(!t.context.state||"suspended"===t.context.state)&&0===this._context.currentTime){var s=this;clearTimeout(this._currentTimer),this._currentTimer=setTimeout(function(){b8e.isWeChatGame||0!==s._context.currentTime||i.push({instance:s._audio,offset:e,audio:s})},10)}},e.pause=function(){if(clearTimeout(this._currentTimer),!this.paused){this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration;var e=this._currentSource;this._currentSource=null,this._startTime=-1,e&&e.stop(0)}},Object.defineProperty(e,"paused",{get:function(){return(!this._currentSource||!this._currentSource.loop)&&(-1===this._startTime||this._context.currentTime-this._startTime>this._buffer.duration)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loop",{get:function(){return this._loop},set:function(e){return this._currentSource&&(this._currentSource.loop=e),this._loop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"volume",{get:function(){return this._volume},set:function(e){return this._volume=e,this._gainObj.gain.setTargetAtTime?this._gainObj.gain.setTargetAtTime(this._volume,this._context.currentTime,.01):this._volume.gain.value=e,r.os===r.OS_IOS&&!this.paused&&this._currentSource&&(this._currentSource.onended=null,this.pause(),this.play()),e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"currentTime",{get:function(){return this.paused||(this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration),this.playedLength},set:function(e){return this.paused?this.playedLength=e:(this.pause(),this.playedLength=e,this.play()),e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"duration",{get:function(){return this._buffer.duration},enumerable:!0,configurable:!0})})(s.prototype)}b8e.Audio=t}}(),function(){if("undefined"!=typeof cc){var e=cc.Enum({WEB_AUDIO:0,DOM_AUDIO:1}),t=cc.Class({name:"b8e.AudioClip",extends:cc.Asset,mixins:[cc.EventTarget],ctor:function(){this.loaded=!1,this._audio=null},properties:{loadMode:{default:e.WEB_AUDIO,type:e},_nativeAsset:{get:function(){return this._audio},set:function(e){this._audio=e,this._audio&&(this.loaded=!0,this.emit("load"))},override:!0}},destroy:function(){this._audio=null,this._super()}});b8e.AudioClip=t}}(),function(){var e,t=e=b8e.PoolObject.extends({rawData:null,_isUnused:!1,ctor:function(){this._super(),this.callbacks=b8e.HashMap.get(),this.references=b8e.HashMap.get(),this.clear()},clear:function(){var e=this;e.url=null,e.name=null,e.ext=null,e.resUrl=null,e.ownerUrl=null,e.type=null,e.priority=0,e.arrivalOrder=0,e.recycleDelay=NaN,e.options=null,e.useManifest=!1,e.noCache=!1,e.version=null,e.preloadDepends=!1,e.isLoading=!1,e.isLoaded=!1,e.isUnused=!1,e.lazyParse=!1,e.compressFormat=!1,e.loadDepends=!1,e.dependsLoaded=!1,e.callbacks.clear(),e.references.clear(),e.err=null,e.asset=null,e.format=null,e.rawFormat=null,e.reloadCount=0,e.reloadLimit=0,e.asyncProcessed=!1,e.onParseProgress=null,e.onParseProgressThis=null,e.benchmarkInfo=null},isUnused:{set:function(e){this._isUnused!=e&&(this._isUnused=e)},get:function(){return this._isUnused}},destroyRawData:function(){this.rawData&&this.rawData.destroy&&this.rawData.destroy(),this.rawData=null},invalidate:function(){this.destroyRawData()},recycle:function(){this.clear(),this._super()},dispose:function(){var e=this;e.callbacks.release(),e.callbacks=null,e.references.release(),e.references=null,e._super()}}),r=new b8e.Pool(t,4096);t.get=function(){return r.get()},t.put=function(e){return r.put(e)},b8e.RC("$$b8e","$$ResRequest",e)}(),function(){var o=b8e.resParser={},e=o.setParser=function(e,t){e&&e.__name?o[e.__name]=t:b8e.error("setParser error!")};o.getParser=function(e){return e&&e.__name?o[e.__name]:(b8e.error("getParser error!"),null)};var l={};function t(e,t){l[e]=t}(o.setExtParser=t)("jpg",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadImage(n,e,!1,function(e){r.call(a,t,e)},a)}),t("png",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadImage(n,e,!0,function(e){r.call(a,t,e)},a)}),t("bti",function(t,e,r,a){var n=t.url,s=t.ownerUrl;(s?b8e.res.getRes(s):null)?b8e.Texture2DAsset.loadImage(n,e,!0,function(e){r.call(a,t,e)},a):b8e.Texture2DAsset.loadImage(n,e,!1,function(e){r.call(a,t,e)},a)}),t("btc",function(t,e,r,a){var n=t.url,s=t.ownerUrl,i=s?b8e.res.getRes(s):null;if(i){var o=i._getBtfData();b8e.Texture2DAsset.loadImage(n,e,!0,function(e){r.call(a,t,e)},a,o.textureWidth,o.textureHeight,!0)}else b8e.error("\u975e\u6cd5btc\u89e3\u6790\uff01")}),t("bjr",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadPVRTex(n,e,!1,function(e){r.call(a,t,e)},a)}),t("bjrz",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadPVRTex(n,e,!1,function(e){r.call(a,t,e)},a)}),t("bpr",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadPVRTex(n,e,!0,function(e){r.call(a,t,e)},a)}),t("bprz",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadPVRTex(n,e,!0,function(e){r.call(a,t,e)},a)}),t("bjp",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadPKMTex(n,e,!1,function(e){r.call(a,t,e)},a)}),t("bjpz",function(e,t,r,a){var n=e.url;b8e.Texture2DAsset.loadPKMTex(n,t,!1,r,a)}),t("bpp",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadPKMTex(n,e,!0,function(e){r.call(a,t,e)},a)}),t("bppz",function(e,t,r,a){var n=e.url;b8e.Texture2DAsset.loadPKMTex(n,t,!0,r,a)}),t("bja",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadASTCTex(n,e,!1,function(e){r.call(a,t,e)},a)}),t("bjaz",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadASTCTex(n,e,!1,function(e){r.call(a,t,e)},a)}),t("bpa",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadASTCTex(n,e,!0,function(e){r.call(a,t,e)},a)}),t("bpaz",function(t,e,r,a){var n=t.url;b8e.Texture2DAsset.loadASTCTex(n,e,!0,function(e){r.call(a,t,e)},a)}),e(b8e.Prefab,null),e(b8e.FrameAtlas,function(r,a,n){var e=r.url,t=b8e.FrameAtlas.get(),s=(t.request=r).rawData;r.asset=t,"btf"===r.ext?t.parse(e,s,function(e,t){r.isUnused||(r.destroyRawData(),a.call(n,r))},o,null,r.options):t.parsePlist(e,s,function(e){r.destroyRawData(),a.call(n,r)},o,null,r.options)}),e(b8e.UIAsset,function(e,t,r){var a=e.url,n=e.rawData,s=b8e.UIAsset.get();s.request=e,s.setUIData(a,n),e.asset=s,e.destroyRawData(),t.call(r,e)}),e(b8e.BitmapFont,function(t,r,a){var e=t.url,n=t.rawData,s=b8e.BitmapFont.get();(t.asset=s).setFontData(e,n,function(e){t.isUnused||(t.destroyRawData(),r.call(a,t))},o)}),e(b8e.Sound,function(e,t,r){var a=e.url,n=e.rawData,s=new b8e.AudioClip;s._nativeAsset=n,s.url=a;var i=b8e.Sound.get();i.setAudioClip(a,s),e.asset=i,e.destroyRawData(),t.call(r,e)}),e(b8e.Texture2DAsset,function(e,r,a){var t=e.rawData,n=b8e.Texture2DAsset.get();(n.request=e).asset=n;var s=l[e.ext];if(!s)return void b8e.error("\u672a\u5b9a\u4e49\u7c7b\u578b"+e.ext+"\u7684Image Parser\uff01");s(e,t,function(e,t){e.isUnused||(e.asset.setTexture(t),r.call(a,e))},o)}),e(b8e.SpriteFrame,function(t,r,a){var n=t.url,e=t.rawData,s=b8e.SpriteFrame.get();if((s.request=t).asset=s,"btf"===t.ext)s.setBtfData(n,e,function(e){t.isUnused||(t.destroyRawData(),r.call(a,t))},o);else{var i=l[t.ext];if(!i)return void b8e.error("\u672a\u5b9a\u4e49\u7c7b\u578b"+t.ext+"\u7684Image Parser\uff01");i(t,e,function(t,e){t.isUnused||t.asset.setTexture(n,e,function(e){t.isUnused||r.call(a,t)},o)},o)}}),e(b8e.ProtobufConfig,function(e,t,r){var a=e.url,n=e.rawData,s=b8e.ProtobufConfig.get();s.buildMessage(a,n,e.options),e.asset=s,e.destroyRawData(),t.call(r,e)}),e(b8e.ConfigData,function(t,r,a){var e=t.url,n=t.rawData,s=b8e.ConfigData.get();((s.request=t).asset=s).parseConfig(e,t.name,n,t.options,function(e){t.isUnused||(t.destroyRawData(),r.call(a,t))},o)})}();R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var V=void 0,H=V=b8e.Object.extends({ctor:function(){if(H._singleton)throw new Error("\u53ea\u80fd\u901a\u8fc7getInstance()\u6765\u83b7\u53d6ResourceManager\u5b9e\u4f8b\uff01");var e=this;e._super(),e._assetByExt={},e.setExtAsset("bcd","$$ConfigData"),e.setExtAsset("bac","$$AnimatorResource"),e.setExtAsset("jpg","$$SpriteFrame"),e.setExtAsset("png","$$SpriteFrame"),e.setExtAsset("bti","$$SpriteFrame"),e.setExtAsset("btf","$$FrameAtlas"),e.setExtAsset("bui","$$UIAsset"),e._formatByExt={},e.setExtFormat("proto","text"),e.setExtFormat("bgp","text"),e.setExtFormat("data","binary"),e.setExtFormat("bbd","binary"),e.setExtFormat("bcd","binary"),e.setExtFormat("bcdp","binary"),e.setExtFormat("bpd","binary"),e.setExtFormat("bac","binary"),e.setExtFormat("bmc","binary"),e.setExtFormat("bvc","binary"),e.setExtFormat("bfm","binary"),e.setExtFormat("btf","binary"),e.setExtFormat("bui","binary"),e.setExtFormat("buib","binary"),e.setExtFormat("bsd","json"),e.setExtFormat("bbf","json"),e.setExtFormat("bti",c.image),e.setExtFormat("btc",c.image),e.setExtFormat("json","json"),e.setExtFormat("jpg",c.image),e.setExtFormat("png",c.image),e.setExtFormat("pkm","tc"),e.setExtFormat("pvr","tc"),e.setExtFormat("bjr","tc"),e.setExtFormat("bjrz","tc"),e.setExtFormat("bpr","tc"),e.setExtFormat("bprz","tc"),e.setExtFormat("bjp","tc"),e.setExtFormat("bjpz","tc"),e.setExtFormat("bpp","tc"),e.setExtFormat("bppz","tc"),e.setExtFormat("bja","tc"),e.setExtFormat("bjaz","tc"),e.setExtFormat("bpa","tc"),e.setExtFormat("bpaz","tc"),e.setExtFormat("mp3","sound"),e._compressFormatByExt={},e.setExtCompressFormat("bcd","zip"),e.setExtCompressFormat("bpd","zip"),e.setExtCompressFormat("bvc","zip"),e.setExtCompressFormat("bjrz","zip"),e.setExtCompressFormat("bprz","zip"),e.setExtCompressFormat("bjpz","zip"),e.setExtCompressFormat("bppz","zip"),e.setExtCompressFormat("bjaz","zip"),e.setExtCompressFormat("bpaz","zip"),e.setExtCompressFormat("bfm","zip"),e.setExtCompressFormat("bbd","zip"),e._requestCache=b8e.HashMap.get(),e._requestQueue=[],e._loadingQueue=b8e.HashMap.get(),e._retryList=b8e.LinkedList.get(),e._cacheResUrls=b8e.HashMap.get(),e._sharedResources=[],e._recycleRes=new b8e.RecycleBin,e._recycleRes.onDestroyObject(e.onDestroyRes,e),e._info={url:null,raw:!1},e._initVersion=0,e._version=0,e._resVersion=0,e._arrivalIndex=0,e._isOnline=!0,e._requestFlag=void 0,e._needSort=!1},setExtAsset:function(e,t){this._assetByExt[e]=t},setExtFormat:function(e,t){this._formatByExt[e]=t},setExtCompressFormat:function(e,t){this._compressFormatByExt[e]=t},init:function(){var t=this;if(t._initLoader(),t._noCache){var e="\u6b63\u5728\u6e05\u9664\u7f13\u5b58...";b8e.log(e),b8e.Toast.launch(e,4278255360,0),t.clearCache(function(e){b8e.log("\u6e05\u9664\u7f13\u5b58\u5b8c\u6210"),b8e.Toast.launch("\u6e05\u9664\u7f13\u5b58\u5b8c\u6210",4278255360)})}if(b8e.isWeChatGame&&R(wx.getUpdateManager)===b8e.TypeFunction){var r=wx.getUpdateManager();r.onCheckForUpdate(function(e){e.hasUpdate&&(b8e.log("\u68c0\u67e5\u5230\u65b0\u7248\u672c\uff01"),t.clearCache(function(e){r.onUpdateReady(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",success:function(e){e.confirm&&r.applyUpdate()}})}),r.onUpdateFailed(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u4e0b\u8f7d\u5931\u8d25",showCancel:!1})})}))})}},_initLoader:function(){b8e.FileSystem.init();b8e.isBrowser&&(b8e.os,b8e.OS.ANDROID),cc.macro.DOWNLOAD_MAX_CONCURRENT=H.MAX_CONCURRENT,this.imageLoader=b8e.ImageLoader,this.textLoader=b8e.TextLoader,this.binaryLoader=b8e.BinaryLoader,this.soundLoader=b8e.SoundLoader},hasReference:function(e,t,r){var a=this._requestCache.get(e);return!!a&&!!a.references.get(t,r)},loadRes:function(e,t,r,a,n,s){if(e)if(r)if(b8e.applyType(r),r.__TypeFunction){this._addRequest(e,t,r,a,n,s)}else b8e.error(3020);else b8e.error(3020);else b8e.error(3019)},unloadRes:function(e,t,r){if(e)if(t)if(b8e.applyType(t),t.__TypeFunction){var a=this,n=void 0,s=this._requestCache.get(e);if(s&&(s.callbacks.del(t,r),n=s.references.get(t,r))){var i=b8e.JsUtil.mergeHash(s,n),o=h[i];if(o&&(p.remove(o),delete h[i],o.release()),n.release(),s.references.del(t,r),s.references.count()<1){var l=a._requestQueue.indexOf(s);-1<l&&a._requestQueue.splice(l,1),m.rawFormat!==c.image&&"tc"!==m.rawFormat||b8e.Texture2DAsset.cancelParse(e),_.remove(s),s.isUnused=!0,s.isLoading=!1,a._loadingQueue.del(e),a._retryList.remove(s);var u=s.asset;if(u){u.__Asset&&u.setUnused(!0),s.isLoaded||(u.__Asset&&u.release(),s.asset=null);var d=s.recycleDelay||H.DEFAULT_RECYCLE_DELAY;a._recycleRes.recycle(e,d)}else a._recycleRes.recycle(e,-1)}}s&&n||b8e.warn(3140,e)}else b8e.error(3022);else b8e.error(3022);else b8e.error(3021)},_applyOwnerUse:function(e){var t=e.ownerUrl;if(t){var r=this._requestCache.get(t);if(r&&!r.isUnused){var a=e.asset;a&&a.__Asset&&a.setUnused(!1)}}else{var n=e.asset;n&&n.__Asset&&n.setUnused(!1)}},isLoading:function(){return 0<this._loadingQueue.count()},onDestroyRes:function(e){return this._releaseRes(e)},_releaseRes:function(e){b8e.macro.IS_DEBUG&&H.IS_DEBUG&&b8e.log("===========\u5378\u8f7d\u8d44\u6e90\uff1a"+e);var t=this._requestCache.get(e);if(t){if(!t.isUnused)return!1;if(0<t.callbacks.count())return b8e.warn(3141,e),!1;if(0<t.references.count())return b8e.warn(3142,e),!1;this._requestCache.del(e),this._destroyAsset(t),t.release(),this._preNextReqs()}else b8e.warn(3143,e);return!0},_destroyAsset:function(e){if(b8e.macro.IS_DEBUG&&H.IS_DEBUG){var t=e.url;b8e.log("===========\u9500\u6bc1\u8d44\u6e90\uff1a"+t)}var r=e.asset;r&&r.__Asset&&r.release()},getRequest:function(e){var t=this._requestCache.get(e);return t||null},getRes:function(e){var t=this.getRequest(e);return t?t.asset:null},_addRequest:function(e,t,r,a,n,s){var i=this,o=i._requestCache.get(e);o&&o.isUnused&&i._recycleRes.restore(e);var l=o?o.asset:null,u=o?o.err:null,d=!1;if(!o||!l&&!u)if(o&&i._loadingQueue.get(e)){var c=!1,f=!1;s&&(void 0!==s.loadDepends&&(c=s.loadDepends),void 0!==s.preloadDepends&&(f=s.preloadDepends)),c=!!c,o.loadDepends||(o.loadDepends=c),f=!!f,o.preloadDepends||(o.preloadDepends=f)}else{var _=!0,h=!1,p=!1,b=!1,m=0,g=null,v=null,y=null;if(s&&(void 0!==s.useManifest&&(_=s.useManifest),void 0!==s.noCache&&(h=s.noCache),void 0!==s.priority&&(m=s.priority),void 0!==s.preloadDepends&&(p=s.preloadDepends),void 0!==s.loadDepends&&(b=s.loadDepends),void 0!==s.onParseProgress&&(g=s.onParseProgress),void 0!==s.onParseProgressThis&&(v=s.onParseProgressThis),void 0!==s.benchmarkInfo&&(y=s.benchmarkInfo)),_=!!_,h=!!h,p=!!p,b=!!b,!o){var A=e.substring(e.lastIndexOf("/")+1),x=A.lastIndexOf("."),C=A.substring(0,x),D=A.substring(x+1);if(!t){var E=i._assetByExt[D];if(E){E=b8e.getNormDP(E,!0);var B=b8e.getAliasName(E);(t=b8e[B]||null)||b8e.warn(4039,B)}}var R=null;s&&void 0!==s.format&&(R=s.format),(o=b8e.ResRequest.get()).url=e,o.name=C,o.type=t,o.format=R,o.isLoading=!1,o.isLoaded=!1;var T=i.getFileUrl(o);x=(A=T.substring(T.lastIndexOf("/")+1)).lastIndexOf("."),D=A.substring(x+1);var w=i._formatByExt[D]||null,L=i._compressFormatByExt[D]||!1,S=null,N=!1,U=null,I=null;s&&(void 0!==s.ownerUrl&&(S=s.ownerUrl),void 0!==s.lazyParse&&(N=s.lazyParse),void 0!==s.version&&(U=s.version),void 0!==s.compressFormat&&(L=s.compressFormat),void 0!==s.rawFormat&&(w=s.rawFormat),void 0!==s.rawData&&(I=s.rawData));var P=i._arrivalIndex;i._arrivalIndex++;var F=i.getResUrl(T,h,U);if(o.ext=D,o.priority=m,o.arrivalOrder=P,o.useManifest=_,o.noCache=h,o.resUrl=F,o.ownerUrl=S,o.compressFormat=L,o.lazyParse=N,o.rawFormat=w,o.onParseProgress=g,o.onParseProgressThis=v,o.benchmarkInfo=y,o.rawData=I,o.reloadLimit=b8e.macro.MAX_RES_RELOAD,i._requestCache.set(e,o),S){var M=i._requestCache.get(S),O=M?M.asset:null;O?O.addDependUrl(e):b8e.error("\u4f9d\u8d56\u8d44\u6e90"+e+"\u7684\u4e3b\u8d44\u6e90"+S+"\u4e0d\u5b58\u5728!")}}m>o.priority&&(o.priority=m,d=!0),o.loadDepends||(o.loadDepends=b),o.preloadDepends||(o.preloadDepends=p),o.options=s}var k=NaN;s&&void 0!==s.recycleDelay&&(k=s.recycleDelay),isNaN(o.recycleDelay)?(isNaN(k)&&t&&(t===b8e.UIAsset?k=V.UI_RECYCLE_DELAY:t===b8e.AnimatorResource&&(k=V.ANIMAT_RECYCLE_DELAY)),isNaN(k)||(o.recycleDelay=k)):isNaN(k)||k>o.recycleDelay&&(o.recycleDelay=k);var G=o.references.get(r,a);if(G)b8e.warn(3145,e);else{(G=b8e.CallBackData.get()).callback=r,G.thisArg=a,G.args=n,o.references.set(r,G,a),l||u?l&&(!o.isLoaded||l.__Asset&&o.loadDepends&&!o.dependsLoaded)&&o.callbacks.set(r,G,a):o.callbacks.set(r,G,a);var q=o.rawData;if(o.isUnused=!1,l&&o.isLoaded)b8e.macro.IS_DEBUG&&H.IS_DEBUG&&b8e.log("===========\u52a0\u8f7d\u7f13\u5b58\uff1a"+e),i._applyOwnerUse(o),l.__Asset&&o.loadDepends&&!o.dependsLoaded?l.loadDepends(function(e){o.dependsLoaded=!0,i._invokeCallbacks(o)},i):i._invokeCallbacks(o,G);else if(u)i._invokeCallbacks(o,G);else if(q)i._parseAsset(e);else if(!i._loadingQueue.get(e))if(o.isLoading)d&&(i._needSort=!0,i._preNextReqs());else{o.isLoading=!0;var j=i._requestQueue;j[j.length]=o,i._needSort=!0,i._preNextReqs()}}},_queueSort:function(){this._requestQueue.sort(this.onQueueSort)},onQueueSort:function(e,t){return e.reloadCount<t.reloadCount?-1:e.reloadCount>t.reloadCount?1:e.priority>t.priority?-1:e.priority<t.priority?1:e.arrivalOrder>t.arrivalOrder?1:e.arrivalOrder<t.arrivalOrder?-1:0},getFileUrl:function(e){var t=e.url,r=t.lastIndexOf(".");if(-1<r){var a=t.substring(0,r),n=e.format;if(n)t=a+"."+n;else switch(t.substr(r+1)){case"png":t=a+"."+(n=b8e.Texture2DAsset.getFileFormat(!0,t));break;case"jpg":t=a+"."+(n=b8e.Texture2DAsset.getFileFormat(!1,t))}}return t},getResUrl:function(e,t,r){var a=null;return engine.macro.IS_DESKTOP?a="file:///"+e:e.indexOf("://")<0?(0==e.indexOf("./")&&(e=e.substr(2)),a=0==e.indexOf(H.srcDir)?e:0==e.indexOf(H.resourcesDir)?e:H.resDir+"/"+this.versionGetter(e),this._noCache||t?a+="?_v="+(new Date-0):r&&(a+="?_v="+r)):a=e,a},_nextRequests:function(){for(this._requestFlag=void 0;this._onRequest(););},_onRequest:function(){var e=this._requestQueue,t=this._loadingQueue;if(e.length<1)return!1;if(t.count()>=H.MAX_CONCURRENT)return!1;var r=e.shift(),a=r.url;return b8e.macro.IS_DEBUG&&H.IS_DEBUG&&b8e.log("===========\u52a0\u8f7d\u8d44\u6e90\uff1a"+a+"(priority:"+r.priority+",arrivalOrder:"+r.arrivalOrder+")"),t.set(a,a),this._load(r),!0},_load:function(e){var t=e.url,r=e.type;if(r&&b&&b[r.__name]){b8e.macro.IS_DEBUG&&H.IS_DEBUG&&b8e.log("===========\u963b\u6b62\u52a0\u8f7d\uff1a"+t);var a=new Error("\u963b\u6b62\u52a0\u8f7d\u8d44\u6e90\uff01");a.url=t,e.err=a,this._loadingQueue.del(t),this._preNextReqs(),this._parseAsset(t,a)}else H.LAZY_LOAD?_.add(e):this._onLoad(e)},_parseRawData:function(e,t,r){var a=this;a._loadingQueue.del(e),a._preNextReqs();var n=a._requestCache.get(e);if(!n)return r&&r.destroy&&r.destroy(),void(b8e.macro.IS_DEBUG&&H.IS_DEBUG&&b8e.log(2101,e));if(n.rawData||n.isLoaded)r&&r.destroy&&r.destroy();else if(n.rawData=r,!n.isUnused){if(t){var s=!1;if(t instanceof Error||(t=t.xhrErr?(s=!0,new Error("readyState:"+t.readyState+",status:"+t.status+",message:"+t.errorMessage)):new Error(t)),t.url=e,n.isLoading=!1,s&&(n.reloadLimit<0||n.reloadCount<n.reloadLimit))return n.reloadCount++,b8e.warn(3146,e,t.message),a._retryList.append(n),void a._doRetry()}a._parseAsset(e,t)}},_onLoad:function(e){var a=this,t=e.url,r=e.resUrl,n=(a._getResWithUrl(t,r),null);switch(e.rawFormat){case c.image:n=!H.USE_PNG_DECODER||"btc"!=e.ext&&"png"!=e.ext?a.imageLoader:a.binaryLoader;break;case"text":case"json":n=a.textLoader;break;case"binary":case"tc":n=a.binaryLoader;break;case"sound":n=a.soundLoader;break;default:b8e.warn(3501,t,e.ext)}n&&n.load(e,function(e,t,r){a._parseRawData(e,t,r)})},_onReload:function(e){var t=this._requestQueue;t[t.length]=e,this._needSort=!0,this._preNextReqs()},_doRetry:function(){this._retryDoing||(this._retryDoing=!0,b8e.setTimeout(this._onCheckOnline,this,1e3))},_onCheckOnline:function(){var r=this;r._isOnline=!1,r.checkRemote(function(e,t){e||(r._isOnline=!0,b8e.setTimeout(r._onRetry,r,10))},r,function(e){b8e.warn(3300)})},_onRetry:function(){var e=this;if(0<e._retryList.count()){var t=e._retryList.shift();e._onReload(t)}0<e._retryList.count()?b8e.setTimeout(e._onRetry,e,10):e._retryDoing=!1},loadPrefabBundleData:function(a,n,s){this.loadRes(a,null,function e(t,r){t||(r=b8e.JsUtil.jsonParse(r),this._prefabBundleData=r),n&&n.call(s,t,r),this.unloadRes(a,e,this)},this,null,{rawFormat:"ucs2"})},_getResWithUrl:function(e,t){var r={};return r.url=t,r.key=e,r.isRawAsset=!0,r},_preNextReqs:function(){this._onPreNextReqs()},_onPreNextReqs:function(){this._needSort&&(this._queueSort(),this._needSort=!1),this._nextRequests()},_parseAsset:function(e,t){var n=this,s=n._requestCache.get(e);if(s&&!s.asset&&!s.isUnused){var r=s.type,a=s.rawData;if(a){var i=s.compressFormat;if(i)if(H.ASYNC_UNZIP){if(!s.asyncProcessed)return s.asyncProcessed=!0,void b8e.WorkerMgr.inst().runUnzip(e,a.buffer,function(e,t,r,a){s.rawData=a?new Uint8Array(a):null,n._parseAsset(t,r)})}else{var o=s.benchmarkInfo;switch(o&&(o.bucbl=a.length,o.cst=b8e.getTimer()),i){case"zip":a=b8e.Inflate.ungzip(a);break;case"raw":a=b8e.Inflate.inflateRaw(a)}o&&(o.cet=b8e.getTimer(),o.aucbl=a.length)}if(s.rawFormat)if("utf8"===s.rawFormat)a=b8e.BufferUtil.decodeUTF8(a);else if("ucs2"===s.rawFormat)a=b8e.StringInflate.decompressFromUint8Array(a);else if("binary"===s.rawFormat)a.charCodeAt&&(a=b8e.BufferUtil.str2Uint8Array(a));else if("json"===s.rawFormat)a instanceof Uint8Array&&(a=b8e.BufferUtil.decodeUTF8(a)),a.charCodeAt&&(a=b8e.JsUtil.jsonParse(a,!0));else if(H.USE_PNG_DECODER&&("btc"==s.ext||"png"==s.ext))if(H.ASYNC_DECODE){if(!s.asyncProcessed)return s.asyncProcessed=!0,void b8e.WorkerMgr.inst().runPngDecode(e,a.buffer,function(e,t,r,a){s.rawData=a?new Uint8Array(a):null,n._parseAsset(t,r)})}else a=b8e.PNG.decode(a)}if(a)switch(s.ext){case"bfm":case"bbd":a=b8e.BufferUtil.decodeUTF8(a),a=b8e.JsUtil.jsonParse(a);break;case"bpd":var l=b8e.ProtoByteBuffer.wrap(a).readString(),u=b8e.JsUtil.jsonParse(l);b8e.ProtobufUtil.allotProps(u);break;case"buib":b8e.UIAsset.parseBundle(s,a)}if(a){s.rawData=a;var d=r&&b8e.resParser.getParser(r);d?d(s,n._onLoadComplete,n):(s.asset=a,n._onLoadComplete(s))}if(t)s.err=t,r&&b&&b[r.__name]||b8e.error(3034,e,t.message),n._onLoadComplete(s);else if(!a){s.destroyRawData();var c=new Error("\u65e0\u6548\u8d44\u6e90\uff01");c.url=e,s.err=c,b8e.error(3035,e),n._onLoadComplete(s)}}},_onLoadComplete:function(t){var r=this,e=t.url;if(t.isLoading=!1,t.isLoaded=!0,r._cacheResUrls.set(e,e),b8e.macro.IS_DEBUG&&H.IS_DEBUG){var a=t.asset,n=t.err;a?b8e.log("===========\u52a0\u8f7d\u5b8c\u6210\uff1a"+e):n&&b8e.log("===========\u52a0\u8f7d\u5931\u8d25\uff1a"+e)}var s=t.asset;s?(r._applyOwnerUse(t),s.__Asset&&t.loadDepends&&!t.dependsLoaded?s.loadDepends(function(e){t.dependsLoaded=!0,r._invokeCallbacks(t)},r):r._invokeCallbacks(t)):r._invokeCallbacks(t)},_invokeCallbacks:function(i,e){var o=i.err,l=i.asset;l&&l.__Asset&&i.preloadDepends&&(l.preloadDepends()||b8e.warn(2201,l.getClassName()));if(e)if(H.LAZY_INVOKE){var t=b8e.JsUtil.mergeHash(i,e),r=u.get();r.request=i,r.cbd=e,h[t]=r,p.add(r)}else{var a=e.args?[o,l].concat(e.args):[o,l];e.callback.apply(e.thisArg,a)}else i.callbacks.every(function(e,t,r){if(H.LAZY_INVOKE){var a=b8e.JsUtil.mergeHash(i,t),n=u.get();n.request=i,n.cbd=t,h[a]=n,p.add(n)}else{var s=t.args?[o,l].concat(t.args):[o,l];if(t.callback.apply(t.thisArg,s),i.isUnused)return!1}return!0},this),i.callbacks&&i.callbacks.clear()},loadBatchRes:function(e,a,n,s,i,o){if(a&&(void 0===a?"undefined":R(a))!==b8e.TypeFunction)b8e.error(3036);else{void 0===i&&(i=2),void 0===o&&(o=!0);for(var l=this,t={},u=[],d=void 0,c=0,f=0,r=e.length,_=0;_<r;_++){var h=e[_],p=h.url;if(!t[p]){var b=x.get(),m=h.type;b.data=h,b.url=p,b.type=m,b.onProgress=a,b.onComplete=v,b.onFinish=y,b.thisArg=n,u[u.length]=b,t[p]=!0}}if(0<u.length)A();else if(a){var g=[null,null,0,0,null];s&&(g=g.concat(s)),a.apply(n,g)}}function v(e){var t=u.length;void 0===d&&c<t&&A(),f++;var r=[e.err,e.asset,f,t,e.url];s&&(r=r.concat(s)),a&&a.apply(n,r),f==t&&o&&e.onFinish()}function y(){for(var e=u.length,t=0;t<e;t++){var r=u[t],a=r.url;l.unloadRes(a,r.onCallback,r),r.release()}u.length=0}function A(){d=void 0;for(var e=0,t=u.length;c<t&&e<i;){e++;var r=u[c];c++;var a=r.url,n=r.type;l.loadRes(a,n,r.onCallback,r,[a],r.data)}}},unloadBatchRes:function(e,i,o){(void 0===i?"undefined":R(i))===b8e.TypeFunction?e.forEach(function(e){var t=e.url,r=null,a=this._batchLoadInfos.get(t);if(a){for(var n=a.length-1;0<=n;n--){var s=a[n];if(s.thisArg==o&&s.onProgress==i){r=s,a.splice(n,1);break}}a.length<1&&this._batchLoadInfos.del(t)}r?this.unloadRes(t,r.callback,r):b8e.warn(3148,t)},this):b8e.error(3037)},preloadReses:function(e){var t=this,r=t._preloadDataByUrl;r=r||(t._preloadDataByUrl={});var a=t._preloadDataList;a=a||(t._preloadDataList=b8e.LinkedList.get());for(var n=e.length,s=0;s<n;s++){var i=e[s],o=null,l=null,u=null;if(i.charCodeAt?o=i:(o=i.url,l=i.type,u=i.options),!r[o]){var d=f.get();d.url=o,d.type=l,d.options=u,a.append(d),r[o]=d}}t._preloadProcessed||b8e.setTimeout(t._nextPreload,t,0)},_nextPreload:function(){var e=this,t=e._preloadDataList;if(0<t.count()){e._preloadProcessed=!0;var r=t.shift(),a=r.url,n=r.type,s=r.options||{};s.preloadDepends=!0,e.loadRes(a,n,e._onPreloadComplete,e,[a],s)}else e._preloadProcessed=!1},_onPreloadComplete:function(e,t,r){var a=this;delete a._preloadDataByUrl[r],a.unloadRes(r,a._onPreloadComplete,a),b8e.setTimeout(a._nextPreload,a,0)},versionGetter:function(e){if(this._versionMap){var t=this._versionMap[e];t=t||this._initVersion;var r=e.indexOf(".");return-1<r?e.slice(0,r)+"."+t+e.slice(r):e+"."+t}return e},_setVersionMap:function(e,t,r,a){this._version=e,this._resVersion=t,this._versionMap=r,this._initVersion=a},getVersionMap:function(){return this._versionMap},getVersion:function(){return this._version},getResVersion:function(){return this._resVersion},getInitVersion:function(){return this._initVersion},loadBuiltin:function(e,t,r){var a=b8e.params.partName;a=a?"_"+a:"";var n="";b8e.version&&(n="_"+b8e.version);var s="assets/resources/"+e+a+n+".bbd";this.loadRes(s,null,this._onBuiltinLoaded,this,[e,s,t,r],{noCache:!0})},_onBuiltinLoaded:function(e,t,r,a,n,s){e?(b8e.error(e),n&&n.call(s,e,null)):(b8e.log("load builtin "+r+" finish!"),b8e.applyBuiltin(t),n&&n.call(s,null,t)),this.unloadRes(a,this._onBuiltinLoaded,this)},loadSettings:function(e,t,r){this.loadRes(e,null,this._onSettingsLoaded,this,[e,t,r],{noCache:!0})},_onSettingsLoaded:function(e,t,r,a,n){e?(b8e.error(e),a&&a.call(n,e,null)):(b8e.log("load settings finish!"),a&&a.call(n,null,t)),this.unloadRes(r,this._onSettingsLoaded,this)},loadVersionMap:function(e,t,r){var a=b8e.proto.version.VersionConfigMessage;this.loadRes(e,b8e.ProtobufConfig,this._onVersionLoaded,this,[e,t,r],{proto:a})},_onVersionLoaded:function(e,t,r,a,n){if(e)b8e.error(e),a&&a.call(n,e,null);else{b8e.log("load version map finish!");var u={},s=t.getProtoData(),i=s.version,o=s.resVersion,l=s.initVersion;(function e(t,r){for(var a=t.length,n=0;n<a;n++){var s=t[n],i=r+s.source,o=s.version;0<o&&(u[i]=o);var l=s.infos;0<l.length&&e(l,i+"/")}})(s.infos,""),this._setVersionMap(i,o,u,l),a&&a.call(n,null,u)}this.unloadRes(r,this._onVersionLoaded,this)},setLocalFileRootDir:function(e){H.localRootDir=e||"",H.allowRemoteRes=!1},setRemoteRootDir:function(e){if(e){var t=b8e.getHost();-1<e.indexOf("://localhost")?e=e.replace("localhost",t):-1<e.indexOf("://127.0.0.1")&&(e=e.replace("127.0.0.1",t))}H.remoteRootDir=e=e||"",-1<e.indexOf("https:")?b8e.protocol="https:":b8e.protocol="http:"},checkRemote:function(r,a,e){H.allowRemoteRes&&b8e.NetMgr.createMgr("resRemote").requestData(H.remoteRootDir+"/check.remote",null,function(e,t){e&&b8e.error(e),r.call(a,e,t)},this,null,!1,{onStatus:e,reloadLimit:-1})},loadAppBuiltin:function(e,t){this.loadBuiltin("app",e,t)},loadAppModules:function(e,t){if(b8e.isNative)e&&e.call(t);else{var r=b8e.params.appModules;this.loadBatchScript(r,e,t)}},loadBatchScript:function(r,a,n,s,i){var o=this;void 0===i&&(i=!0),function e(){if(0<r.length){var t=r.shift();o.loadScript(t,e,o,s,i)}else a&&a.call(n)}()},loadScript:function(s,i,o,e,l){void 0===l&&(l=!0);var u=this,t=s;if(b8e.isWeChatGame)if(wx.loadSubpackage)wx.loadSubpackage({name:t,success:function(e){i&&i.call(o,s,e)},fail:function(e){b8e.error(3038,s,e?e.errMsg:"unknown"),i&&i.call(o,s,null)}});else b8e.error(3039);else{if(b8e.isRuntime){b8e.getFPV(window,"require");return m(t),void(i&&i.call(o,s,null))}(t=u.getResUrl(t,e)).indexOf("://")<0?V.getRemotePath(t,r):r(null,t)}function r(e,t){var r=document.createElement("script");r.language="javascript",r.type="text/javascript",r.async=l,r.src=t;function a(){r.parentNode&&r.parentNode.removeChild(r),r.removeEventListener("load",a,!1),r.removeEventListener("error",n,!1),i&&i.call(o,s,r)}var n=function e(){r.parentNode&&r.parentNode.removeChild(r),r.removeEventListener("load",a,!1),r.removeEventListener("error",e,!1),b8e.warn(3149,s),b8e.setTimeout(u.loadScript,u,1e3,s,i,o)};r.addEventListener("load",a,!1),r.addEventListener("error",n,!1),document.getElementsByTagName("head")[0].appendChild(r)}},parseScript:function(e,t){if(b8e.isWeChatGame)return b8e.error(3040),null;if(!t||document.getElementById(e))return null;var r=document.getElementsByTagName("head")[0],a=document.createElement("script");return a.language="javascript",a.type="text/javascript",a.id=e,a.async=!0,a.text=t,r.appendChild(a),a},resCount:{get:function(){return this._requestCache.count()}},cacheCount:{get:function(){return this._cacheResUrls.count()}},recycleCount:{get:function(){return this._recycleRes.count()}},setUseCache:function(e){this._noCache=!e},purge:function(e){b8e.Texture2D.purge(),this._recycleRes.purge(!!e)},clearCache:function(e){b8e.setTimeout(function(){("undefined"==typeof wxDownloader?"undefined":R(wxDownloader))!==b8e.TypeUndefined?wxDownloader.cleanAllAssets(e):e&&e(null)},this,100)},dumpInfo:function(){var l="\u8d44\u6e90\u56de\u6536\u4fe1\u606f\uff1a\n";return l+=this._recycleRes.dumpInfo(),l+="\n",l+="\u52a0\u8f7d\u5217\u8868\u4fe1\u606f\uff1a\n",this._requestCache.forEach(function(e,t){for(var r=[],a=t.references.elements(),n=a.length,s=0;s<n;s++){var i=a[s].thisArg,o=i?i.constructor.__name:void 0;r[r.length]=o||"unknown"}l+=e+"->recycle:"+t.recycleDelay+" ref:"+t.references.count()+"|"+r.join(",")+"\n"},this),l}}),c={image:"image"},u=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.request=null,this.cbd=null}}),t=new b8e.Pool(u,128);u.get=function(){return t.get()},u.put=function(e){return t.put(e)};var x=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},onCallback:function(e,t){this.err=e,this.asset=t,this.onComplete(this)},recycle:function(){this.reset(),this._super()},reset:function(){var e=this;e.url=null,e.type=null,e.thisArg=null,e.onProgress=null,e.onComplete=null,e.onFinish=null,e.err=null,e.asset=null,e.data=null}}),r=new b8e.Pool(x,128);x.get=function(){return r.get()},x.put=function(e){return r.put(e)};var f=b8e.PoolObject.extends({ctor:function(){this._super(),this.reset()},recycle:function(){this.reset(),this._super()},reset:function(){this.url=null,this.type=null,this.options=null}}),a=new b8e.Pool(f,1024);f.get=function(){return a.get()},f.put=function(e){return a.put(e)},H.srcDir="src",H.resourcesDir="assets/resources",H.resDir="res",H.allowRemoteRes=!0,H.localRootDir="",H.getLocalPath=function(e){var t=V.localRootDir,r=e.indexOf("?");return-1<r&&(e=e.substring(0,r)),e=t+"/"+e},H.remoteRootDir="",H.getRemotePath=function(t,r){var e=V.remoteRootDir;e&&(t=e+"/"+t),H.allowRemoteRes?r(null,t):(b8e.warn("\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\uff1a"+t+"\uff1f"),b8e.inited?bui.alert("\u5141\u8bb8\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\uff1f",{groupName:"ResMgr.getRemotePath",onResponse:function(e){0==e.response&&(H.allowRemoteRes=!0,r(null,t))}}):r(null,t))},H.downloadFile=function(e,t){V.getLocalPath(e);t()},H.UI_ROOT="ui",H.HIGH_DEFINITION_ENABLED=!1,H.IS_DEBUG=!1,H.MAX_CONCURRENT=8,H.USE_BACB=!1,H.CFG_PRIOR=1e8,H.UI_PRIOR=1e6,H.UI_DEPEND_PRIOR=1e6,H.FONT_PRIOR=1e6,H.SPRITE_PRIOR=1e5,H.PRELOAD_PRIOR=-1e8,H.MAP_CFG_PRIOR=1e7,H.MAP_THUMB_PRIOR=1e7,H.MAP_TILE_PRIOR=-1e3,H.DEFAULT_RECYCLE_DELAY=0,H.UI_RECYCLE_DELAY=NaN,H.SPRITE_RECYCLE_DELAY=NaN,H.ANIMAT_RECYCLE_DELAY=NaN,H.ANIMAT_SPRITE_RECYCLE_DELAY=NaN,H.ASYNC_UNZIP=!1,H.USE_PNG_DECODER=!1,H.ASYNC_DECODE=!1,H._instance=null,H._singleton=!0,H.inst=function(){return H._instance||(H._singleton=!1,H._instance=new H,H._singleton=!0),H._instance},H.LAZY_LOAD=!1,H.BATCH_LOAD_NUM=2;var _=new b8e.CallLater(function(e){return!!e.isUnused||(b8e.res._onLoad(e),!1)},H,H.BATCH_LOAD_NUM);H.LAZY_INVOKE=!1,H.BATCH_INVOKE_NUM=100;var h={},p=new b8e.CallLater(function(e){var t=e.request,r=e.cbd;e.release();var a=b8e.JsUtil.mergeHash(t,r);if(delete h[a],t.isUnused)return!0;var n=t.err,s=t.asset,i=r.args?[n,s].concat(r.args):[n,s];return r.callback.apply(r.thisArg,i),!1},H,H.BATCH_INVOKE_NUM),b=void 0;H.setForbidRes=function(e,t){(b=b||{})[e]=!!t},b8e.RC("$$b8e","$$ResMgr",V)})(),function(){b8e.ASSET_VERSION="4.1.5";var e=b8e.EngineAsset={};b8e.SHC(e);var t=e.onInit=function(){b8e.ASSET_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aAsset\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nAsset:V"+b8e.ASSET_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(t),b8e.onInit(t,e)}()},{}]},{},[1]);(function(){return function o(r,u,a){function c(e,t){if(!u[e]){if(!r[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(p)return p(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var s=u[e]={exports:{}};r[e][0].call(s.exports,function(t){return c(r[e][1][t]||t)},s,s.exports,o,r,u,a)}return u[e].exports}for(var p="function"==typeof require&&require,t=0;t<a.length;t++)c(a[t]);return c}})()({1:[function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){var n=b8e.Ease=function(){};n.convertEase=function(t){if((void 0===t?"undefined":i(t))===b8e.TypeFunction)return t;var e=n[t];return(void 0===e?"undefined":i(e))===b8e.TypeFunction?e:null},n.get=function(e){return e<-1&&(e=-1),1<e&&(e=1),function(t){return 0==e?t:e<0?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},n.getPowIn=function(e){return function(t){return Math.pow(t,e)}},n.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}},n.getPowInOut=function(e){return function(t){return(t*=2)<1?Math.pow(t,e)>>1:1-(Math.abs(Math.pow(2-t,e))>>1)}},n.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},n.sineOut=function(t){return Math.sin(t*Math.PI/2)},n.sineInOut=function(t){return-(Math.cos(Math.PI*t)-1>>1)},n.getBackIn=function(e){return function(t){return t*t*((e+1)*t-e)}},n.getBackOut=function(e){return function(t){return--t*t*((e+1)*t+e)+1}},n.getBackInOut=function(e){return e*=1.525,function(t){return(t*=2)<1?t*t*((e+1)*t-e)>>1:(t-=2)*t*((e+1)*t+e)+2>>1}},n.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},n.circOut=function(t){return Math.sqrt(1- --t*t)},n.circInOut=function(t){return(t*=2)<1?-(Math.sqrt(1-t*t)-1>>1):Math.sqrt(1-(t-=2)*t)+1>>1},n.bounceIn=function(t){return 1-n.bounceOut(1-t)},n.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},n.bounceInOut=function(t){return t<.5?n.bounceIn(t<<1)>>1:.5+(n.bounceOut((t<<1)-1)>>1)},n.getElasticIn=function(n,i){var s=Math.PI<<1;return function(t){if(0==t||1==t)return t;var e=i/s*Math.asin(1/n);return-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*s/i)}},n.getElasticOut=function(n,i){var s=Math.PI<<1;return function(t){if(0==t||1==t)return t;var e=i/s*Math.asin(1/n);return n*Math.pow(2,-10*t)*Math.sin((t-e)*s/i)+1}},n.getElasticInOut=function(n,i){var s=Math.PI<<1;return function(t){var e=i/s*Math.asin(1/n);return(t*=2)<1?-(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*s/i)>>1):1+(n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*s/i)>>1)}},n.quadIn=n.getPowIn(2),n.quadOut=n.getPowOut(2),n.quadInOut=n.getPowInOut(2),n.cubicIn=n.getPowIn(3),n.cubicOut=n.getPowOut(3),n.cubicInOut=n.getPowInOut(3),n.quartIn=n.getPowIn(4),n.quartOut=n.getPowOut(4),n.quartInOut=n.getPowInOut(4),n.quintIn=n.getPowIn(5),n.quintOut=n.getPowOut(5),n.quintInOut=n.getPowInOut(5),n.backIn=n.getBackIn(1.7),n.backOut=n.getBackOut(1.7),n.backInOut=n.getBackInOut(1.7),n.elasticIn=n.getElasticIn(1,.3),n.elasticOut=n.getElasticOut(1,.3),n.elasticInOut=n.getElasticInOut(1,.3*1.5)})(),function(){var t,o=b8e.HashMap.get(),r=b8e.HashMap.get(),m=t=b8e.PoolObject.extends({ctor:function(t,e,n){if(b8e.ready){var i=this;i._super(),i._steps=[],i._actions=[],i._initProps=[],i.resetProps(),i.initialize(t,e,n)}else b8e.error(3052)},resetProps:function(){var t=this;t._target=null,t._props=null,t._useFrame=!1,t.ignoreGlobalPause=!1,t.loop=!1,t.pluginData=null,t._curQueueProps=null,t._initQueueProps=null,t._initProps&&(t._initProps.length=0),t._steps&&(t._steps.length=0),t._actions&&(t._actions.length=0),t._paused=!0,t.duration=0,t._prevPos=-1,t.position=null,t._prevPosition=0,t._stepPosition=0,t.passive=!1,t.canRelease=!1},invalidate:function(){this.pause(),m._unregister(this),this._super()},restore:function(t,e,n){this._super(),this.initialize(t,e,n)},recycle:function(){this.resetProps(),this._super()},dispose:function(){var t=this;t._paused=!1,t._steps&&(t._steps.length=0,t._steps=null),t._actions&&(t._actions.length=0,t._actions=null),t._initProps&&(t._initProps.length=0,t._initProps=null),t._super()},initialize:function(t,e,n){var i=this;i._target=t,m._register(i),(i._props=e)&&(i._useFrame=e.useFrame,i.ignoreGlobalPause=e.ignoreGlobalPause,i.loop=e.loop,e.override&&m.kill(t)),i.pluginData=n||{},i._curQueueProps={},i._initQueueProps={},e&&e.paused||i.play(),e&&null!=e.position&&i.setPosition(e.position,m.NONE)},setPosition:function(t,e){var n=this;void 0===e&&(e=1),t<0&&(t=0);var i=t,s=!1;if(i>=n.duration&&(n.loop?i%=n.duration:(i=n.duration,s=!0)),i==n._prevPos)return s;var o=n._prevPos;n.position=n._prevPos=i,n._prevPosition=t;var r=n._target;if(r.__BaseDisplay&&!r.usable)return n.release(),!0;if(s)n._updateTargetProps(null,1);else{var u=n._steps,a=u.length;if(0<a){var c=void 0;for(c=0;c<a&&!(u[c].t>i);c++);var p=u[c-1];n._updateTargetProps(p,(n._stepPosition=i-p.t)/p.d)}}if(!n.usable)return!0;if(s&&(n.canRelease=!0),0!=e&&0<n._actions.length&&(n._useFrame?n._runActions(i,i):1==e&&i<o?(o!=n.duration&&n._runActions(o,n.duration),n._runActions(0,i,!0)):n._runActions(o,i)),!n.usable)return!0;var l=n._props;return l&&l.onUpdate&&l.onUpdate.call(l.onUpdateThis),n.canRelease&&n.release(),s},_runActions:function(t,e,n){if(this.usable){void 0===n&&(n=!1);var i=t,s=e,o=-1,r=this._actions.length,u=1;for(e<t&&(i=e,s=t,o=r,r=u=-1);(o+=u)!=r&&this.usable;){var a=this._actions[o],c=a.t;(c==s||i<c&&c<s||n&&c==t)&&a.f.apply(a.o,a.p)}}},_updateTargetProps:function(t,e){var n=this,i=void 0,s=void 0,o=void 0,r=void 0,u=void 0,a=void 0;if(t||1!=e){if(n.passive=!!t.v,n.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,s=t.p1}else n.passive=!1,i=s=n._curQueueProps;var c=m._plugins,p=n._initProps.length;if(0<p)for(var l=0;l<p;l++){if(!n.usable)return;var h=n._initProps[l];null==(r=i[h])&&(i[h]=r=n._initQueueProps[h]),null==(u=s[h])&&(s[h]=u=r),o=r==u||0==e||1==e||isNaN(r)?1==e?u:r:r+(u-r)*e;var _=!1;if(a=c[h])for(var f=0,v=a.length;f<v;f++){if(!n.usable)return;var d=a[f].tween(n,h,o,i,s,e,!!t&&i==s,!t);d==m.IGNORE?_=!0:o=d}_||(n._target[h]=o)}else for(var g in n._initQueueProps){if(!n.usable)return;null==(r=i[n._initProps[n._initProps.length]=g])&&(i[g]=r=n._initQueueProps[g]),null==(u=s[g])&&(s[g]=u=r),o=r==u||0==e||1==e||isNaN(r)?1==e?u:r:r+(u-r)*e;var P=!1;if(a=c[g])for(var b=0,w=a.length;b<w;b++){if(!n.usable)return;var O=a[b].tween(n,g,o,i,s,e,!!t&&i==s,!t);O==m.IGNORE?P=!0:o=O}P||(n._target[g]=o)}},_cloneProps:function(t){var e={};for(var n in t)e[n]=t[n];return e},_addStep:function(t){if(0<t.d){var e=this._steps;(e[e.length]=t).t=this.duration,this.duration+=t.d}return this},_appendQueueProps:function(t){var e=this,n=void 0,i=void 0,s=void 0,o=void 0,r=void 0,u=m._plugins;for(var a in t)if(void 0===e._initQueueProps[a]){if(i=e._target[a],n=u[a])for(s=0,o=n.length;s<o;s++)i=n[s].init(e,a,i);e._initQueueProps[a]=e._curQueueProps[a]=void 0===i?null:i}else i=e._curQueueProps[a];for(var c in t){if(i=e._curQueueProps[c],n=u[c])for(r=r||{},s=0,o=n.length;s<o;s++)n[s].step&&n[s].step(e,c,i,t[c],r);e._curQueueProps[c]=t[c]}return r&&e._appendQueueProps(r),e._curQueueProps},_addAction:function(t){t.t=this.duration;var e=this._actions;return e[e.length]=t,this},_set:function(t,e){for(var n in t)e[n]=t[n]},wait:function(t,e){if(null==t||t<=0)return this;var n=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:n,p1:n,v:e})},to:function(t,e,n){void 0===n&&(n=void 0),(isNaN(e)||e<0)&&(e=0);var i=this;return i._addStep({d:e||0,p0:i._cloneProps(i._curQueueProps),e:n,p1:i._cloneProps(i._appendQueueProps(t))})},call:function(t,e,n){if(t){void 0===e&&(e=void 0),void 0===n&&(n=void 0);return this._addAction({f:t,p:n||[],o:e||this._target})}b8e.error(3053)},set:function(t,e){void 0===e&&(e=null);var n=this;return n._appendQueueProps(t),n._addAction({f:n._set,o:n,p:[t,e||n._target]})},kill:function(t){this._target===t?this.usable&&this.release():b8e.warn(3153,t)},play:function(){this.resume()},pause:function(){this._paused||(this._paused=!0,b8e.ticker.stopTick(this._onTick,this),m._count--)},resume:function(){this._paused&&(this._paused=!1,b8e.ticker.startTick(this._onTick,this,0,1),m._count++)},_onTick:function(t){m.tickPaused||m.paused&&!this.ignoreGlobalPause||this._paused||this.tick(this._useFrame?1:t)},tick:function(t){this._paused||this.setPosition(this._prevPosition+t)}}),i=new b8e.Pool(m,128);m.poolGet=function(t,e,n){return i.get(t,e,n)},m.put=function(t){return i.put(t)},m.poolCount=function(){return i.count},m.get=function(t,e,n,i){if(t)return void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=!1),i&&m.kill(t),m.poolGet(t,e,n)},m.killing=!1,m.kill=function(t){if(t&&0<t.tween_count){var e=o,n=e.get(t,m);n&&(m.killing=!0,n.forEach(m._onKill,m),n.release(),e.del(t,m),m.killing=!1)}},m._onKill=function(t){t.usable&&t.kill(t._target)},m.pause=function(t){if(0<t.tween_count){var e=o.get(t,m);e&&e.forEach(m._onPause,m)}},m._onPause=function(t){t.usable&&t.pause()},m.resume=function(t){if(0<t.tween_count){var e=o.get(t,m);e&&e.forEach(m._onResume,m)}},m._onResume=function(t){t.usable&&t.resume()},m.paused=!1,m.tickPaused=!1,m._register=function(t){var e=r,n=o,i=t._target;e.set(t,i,m);var s=n.get(i,m);s||(s=b8e.LinkedList.get(),n.set(i,s,m)),s.has(t)||(s.append(t),i.tween_count=0<i.tween_count?i.tween_count+1:1)},m._unregister=function(t){var e=r,n=o,i=t._target,s=n.get(i,m);s&&(s.has(t)&&(m.killing||s.remove(t),i.tween_count--,e.del(t,m)),!m.killing&&s.count()<1&&(s.release(),n.del(i,m)))},m.killAll=function(){r.forEach(m._onKillTarget,m)},m._onKillTarget=function(t,e){t&&e&&t.usable&&t.kill(e)},m._count=0,m.getCount=function(){return m._count},m.NONE=0,m.LOOP=1,m.REVERSE=2,m.IGNORE={},m._plugins={},b8e.RC("$$b8e","$$Tween",t)}(),function(){var t;t=b8e.Object.extends({name:null,ctor:function(){this._super(),this.name=""}}),b8e.RC("$$b8e","$$TweenBasePath",t)}(),function(){var t;t=b8e.TweenBasePath.extends({ctor:function(){this._super(),this.props=void 0,this.duration=500,this.ease=void 0}}),b8e.RC("$$b8e","$$TweenTo",t)}(),function(){var t;t=b8e.TweenBasePath.extends({ctor:function(){this._super(),this.duration=500,this.passive=void 0}}),b8e.RC("$$b8e","$$TweenWait",t)}(),function(){var t;t=b8e.TweenBasePath.extends({ctor:function(){this._super(),this.props=void 0}}),b8e.RC("$$b8e","$$TweenSet",t)}(),function(){var t;t=b8e.TweenBasePath.extends({ctor:function(){this._super(),this.delta=0}}),b8e.RC("$$b8e","$$TweenTick",t)}(),function(){var t;t=b8e.Object.extends({ctor:function(){this._super()},props:{get:function(){return this._props},set:function(t){this._props=t}},target:{get:function(){return this._target},set:function(t){this._target=t}},paths:{get:function(){return this._paths},set:function(t){this._paths=t||[]}},play:function(){this.tween?this.tween.setPaused(!1):this.createTween()},pause:function(){this.tween&&this.tween.setPaused(!0)},createTween:function(){var t=this;t.tween=b8e.Tween.get(t._target,t._props),t._paths&&t.applyPaths()},applyPaths:function(){for(var t=0,e=this._paths.length;t<e;t++){var n=this._paths[t];this.applyPath(n)}},applyPath:function(t){var e=this,n=this;t instanceof To?e.tween.to(t.props,t.duration,b8e.Ease.convertEase(t.ease)):t instanceof Wait?e.tween.wait(t.duration,t.passive):t instanceof Set?e.tween.set(t.props):t instanceof Tick&&e.tween.tick(t.delta),e.tween.call(function(){return n.pathComplete(t)})},pathComplete:function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",t);var e=this._paths.indexOf(t);0<=e&&e===this._paths.length-1&&this.dispatchEventWith("complete")}}),b8e.RC("$$b8e","$$TweenItem",t)}(),function(){var t;t=b8e.EventDispatcher.extends({ctor:function(){this._super(),this.completeCount=0},items:{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)}},registerEvent:function(e){var n=this;this._items&&this._items.forEach(function(t){e?t.addEventListener("complete",n.itemComplete,n):t.removeEventListener("complete",n.itemComplete,n)})},play:function(){if(this._items)for(var t=0,e=this._items.length;t<e;t++){this._items[t].play()}},pause:function(){if(this._items)for(var t=0,e=this._items.length;t<e;t++){this._items[t].pause()}},itemComplete:function(t){var e=this,n=t.currentTarget;e.completeCount++,e.dispatchEventWith("itemComplete",n),e.completeCount===e.items.length&&(e.dispatchEventWith("complete"),e.completeCount=0)}}),b8e.RC("$$b8e","$$TweenGroup",t)}(),function(){var t,_=t=b8e.PoolObject.extends({_target:null,_useTicks:!1,ignoreGlobalPause:!1,loop:!1,pluginData:null,_steps:null,_actions:null,paused:!1,duration:0,_prevPos:-1,position:null,_prevPosition:0,_stepPosition:0,passive:!1,_curQueueProps:null,_initQueueProps:null,ctor:function(t,e,n){this._super(),this.resetProps(),this.initialize(t,e,n)},resetProps:function(){var t=this;t._target=null,t._useTicks=!1,t.ignoreGlobalPause=!1,t.loop=!1,t.pluginData=null,t._steps=null,t._actions=null,t.paused=!1,t.duration=0,t._prevPos=-1,t.position=null,t._prevPosition=0,t._stepPosition=0,t.passive=!1,t.canRelease=!1,t._curQueueProps=null,t._initQueueProps=null},initialize:function(t,e,n){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&_.removeTweens(t)),this.pluginData=n||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:_._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},setPosition:function(t,e){t<0&&(t=0),void 0===e&&(e=1);var n=t,i=!1;if(n>=this.duration&&(this.loop?n%=this.duration:(n=this.duration,i=!0)),n==this._prevPos)return i;var s=this._prevPos;if(this.position=this._prevPos=n,this._prevPosition=t,this._target)if(i)this._updateTargetProps(null,1);else if(0<this._steps.length){var o=void 0,r=this._steps.length;for(o=0;o<r&&!(this._steps[o].t>n);o++);var u=this._steps[o-1];this._updateTargetProps(u,(this._stepPosition=n-u.t)/u.d)}return!n.usable||(i&&(n.canRelease=!0),0!=e&&0<this._actions.length&&(this._useTicks?this._runActions(n,n):1==e&&n<s?(s!=this.duration&&this._runActions(s,this.duration),this._runActions(0,n,!0)):this._runActions(s,n)),n.canRelease&&(n.setPaused(!0),n.release()),i)},_runActions:function(t,e,n){var i=t,s=e,o=-1,r=this._actions.length,u=1;for(e<t&&(i=e,s=t,o=r,r=u=-1);(o+=u)!=r;){var a=this._actions[o],c=a.t;(c==s||i<c&&c<s||n&&c==t)&&a.f.apply(a.o,a.p)}},_updateTargetProps:function(t,e){var n=void 0,i=void 0,s=void 0,o=void 0,r=void 0,u=void 0;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),n=t.p0,i=t.p1}else this.passive=!1,n=i=this._curQueueProps;for(var a in this._initQueueProps){null==(o=n[a])&&(n[a]=o=this._initQueueProps[a]),null==(r=i[a])&&(i[a]=r=o),s=o==r||0==e||1==e||"number"!=typeof o?1==e?r:o:o+(r-o)*e;var c=!1;if(u=_._plugins[a])for(var p=0,l=u.length;p<l;p++){var h=u[p].tween(this,a,s,n,i,e,!!t&&n==i,!t);h==_.IGNORE?c=!0:s=h}c||(this._target[a]=s)}},setPaused:function(t){return this.paused=t,_._register(this,!t),this},_cloneProps:function(t){var e={};for(var n in t)e[n]=t[n];return e},_addStep:function(t){return 0<t.d&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},_appendQueueProps:function(t){var e=void 0,n=void 0,i=void 0,s=void 0,o=void 0;for(var r in t)if(void 0===this._initQueueProps[r]){if(n=this._target[r],e=_._plugins[r])for(i=0,s=e.length;i<s;i++)n=e[i].init(this,r,n);this._initQueueProps[r]=this._curQueueProps[r]=void 0===n?null:n}else n=this._curQueueProps[r];for(var u in t){if(n=this._curQueueProps[u],e=_._plugins[u])for(o=o||{},i=0,s=e.length;i<s;i++)e[i].step&&e[i].step(this,u,n,t[u],o);this._curQueueProps[u]=t[u]}return o&&this._appendQueueProps(o),this._curQueueProps},_addAction:function(t){return t.t=this.duration,this._actions.push(t),this},to:function(t,e,n){return(isNaN(e)||e<0)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:n,p1:this._cloneProps(this._appendQueueProps(t))})},call:function(t,e,n){return this._addAction({f:t,p:n||[],o:e||this._target})},tick:function(t){this.paused||this.setPosition(this._prevPosition+t)},restore:function(t,e,n){this._super(),this.initialize(t,e,n)},recycle:function(){this.resetProps(),this._super()},dispose:function(){this._super()}}),i=new b8e.Pool(_,128);_.poolGet=function(t,e,n){return i.get(t,e,n)},_.put=function(t){return i.put(t)},_._tweens=[],_.IGNORE={},_._plugins={},_._inited=!1,_.get=function(t,e,n,i){return i&&_.removeTweens(t),_.poolGet(t,e,n)},_.removeTweens=function(t){if(t.tween_count){for(var e=_._tweens,n=e.length-1;0<=n;n--){var i=e[n];i._target==t&&(i.paused=!0,e.splice(n,1),i.release())}t.tween_count=0}};var e=_.tick=function(t,e){for(var n=_._tweens.concat(),i=n.length-1;0<=i;i--){var s=n[i];e&&!s.ignoreGlobalPause||s.paused||s.tick(s._useTicks?1:t)}return!1};b8e.SHC(e),_._register=function(t,e){var n=t._target,i=_._tweens;if(e)n&&(n.tween_count=0<n.tween_count?n.tween_count+1:1),i.push(t),_._inited||(b8e.ticker.startTick(_.tick,null),_._inited=!0);else{n&&n.tween_count--;for(var s=i.length;s--;)if(i[s]==t)return i.splice(s,1),void t.release()}};var n=b8e.ScrollEase={};n.get=function(e){return e<-1&&(e=-1),1<e&&(e=1),function(t){return 0==e?t:e<0?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},n.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}},n.quintOut=n.getPowOut(5),n.quartOut=n.getPowOut(4),b8e.RC("$$b8e","$$ScrollTween",t)}(),function(){b8e.TWEEN_VERSION="4.1.5";var t=b8e.EngineTween={};b8e.SHC(t);var e=t.onInit=function(){b8e.TWEEN_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aTween\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nTween:V"+b8e.TWEEN_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(e),b8e.onInit(e,t)}()},{}]},{},[1]);(function(){return function s(r,a,l){function _(e,t){if(!a[e]){if(!r[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[e]={exports:{}};r[e][0].call(o.exports,function(t){return _(r[e][1][t]||t)},o,o.exports,s,r,a,l)}return a[e].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)_(l[t]);return _}})()({1:[function(t,e,i){"use strict";window.bui={},function(){var t;t=b8e.Enum({CUSTOM:0,RAW:1,TRIMMED:2});b8e.RC("$$bui","$$SizeMode",t)}(),function(){var t,i=t=b8e.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3}),n=void 0;i.toFillMode=function(t){if(!n){n={};var e=b8e.BitmapFillMode;n[i.SIMPLE]=e.SCALE,n[i.SLICED]=e.SCALE_9_GRID,n[i.TILED]=e.REPEAT}return n[t]},b8e.RC("$$bui","$$SpriteStyle",t)}();var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){var t,x=t=b8e.BaseDisplay.extends({ctor:function(){var t=this;t.constructor===x&&(x.poolCall||b8e.warn(3357)),t._super(),t.needActiveInHierarchyEvent=!0,t._propMap=b8e.HashMap.get(),t._isLoading=!1,t._isLoaded=!1,t._displayById={},t._componentByName={},t._buttonDisplays=[],t._waitParentById={},t._waitContentById={}},_setUI:function(t){var e=this;if(t){if(!e._ui){var i=(e._ui=t).getData();e._uiData=i,e._nextIdx=0,e._timeoutIdx=b8e.setTimeout(e._parseUI,e,0)}}else b8e.error(2049,e._url)},_parseUI:function(){var t=this;if(t._timeoutIdx){t._timeoutIdx=void 0;var e=t._uiData;if(e){for(var i=t._componentByName,n=0,o=e.nodes,s=o.length;t._nextIdx<s;){var r=o[t._nextIdx],a=r.id,l=r.type,_=r.name,c=null,h=r.mask,u=r.button,d=r.langKey,f=null;switch(l){case 1:c=r.sprite,f=t._createSprite(r,c);break;case 2:c=r.label,d&&(c.langKey=d),f=t._createLabel(r,c);break;case 3:c=r.richText,d&&(c.langKey=d),f=t._createRichText(r,c);break;case 4:c=r.editBox,f=t._createEditBox(r,c);break;case 5:c=r.scrollView,f=t._createScrollView(r,c)}if(f=f||t._createElement(r),t.hasDebugSurface()&&f.showDebugSurface(!0),h&&t._parseMask(h,f),u){t._parseButton(u,f);var p=t._buttonDisplays;p[p.length]=f}if(t._root){var g=r.parent;if(0<g){var v=t._displayById[g];v?v.addChild(f):t._waitParentById[g]=a}}else t._root=f,i.node=f,t.addChild(f),t.setAnchor(f.anchorX,f.anchorY),t.setSize(f.width,f.height);if(_){f.name=_;var b=b8e.getAliasName(_);i[_]&&b8e.warn(3390,t._url,_),i[b]=i[_]=f}t._displayById[a]=f;var y=t._waitParentById[a];if(void 0!==y){var m=t._displayById[y];f.addChild(m),delete t._waitParentById[a];var T=t._waitContentById[y];if(void 0!==T){var L=t._displayById[T];m.parent&&(L.setContent(m),delete t._waitContentById[a])}}var C=t._waitContentById[a];if(void 0!==C){var S=t._displayById[C];f.parent&&(S.setContent(f),delete t._waitContentById[a])}if(t._nextIdx++,++n>x.BATCH_PARSE)return void(t._timeoutIdx=b8e.setTimeout(t._parseUI,t,0))}t._propMap.forEach(t._applyProp,t),t._onComplete&&t._onComplete.call(t._onCompleteThis)}}},componentByName:{get:function(){return this._componentByName}},buttonDisplays:{get:function(){return this._buttonDisplays}},_parseMask:function(t,e){var i=t.maskType;e.setMask(i)},_parseButton:function(t,e){e.isButton=!0},_createElement:function(t){var e=b8e.BaseDisplay.get();return e.deserailization(t),e},_createLabel:function(t,e){var i=bui.Label.get();return i.deserailization(t,e),i},_createRichText:function(t,e){var i=bui.RichText.get();return i.deserailization(t,e),i},_createEditBox:function(t,e){var i=bui.EditBox.get();return i.deserailization(t,e),i},_createSprite:function(t,e){var i={recycleDelay:this._ui.request.recycleDelay},n=bui.Sprite.get();return n.deserailization(t,e,i),n},_createScrollView:function(t,e){var i=b8e.ScrollView.get();i.deserailization(t,e);var n=e.content;if(0<n){var o=this._displayById[n];if(o&&o.parent)i.setContent(o);else{var s=t.id;this._waitContentById[n]=s}}return i},loadUI:function(t,e,i,n){var o=this;t!=o._url&&(!x.allowUseAppRes&&-1<t.indexOf("app/")?b8e.error(1302,t):(o.unloadUI(),o._url=t,o._onComplete=e,o._onCompleteThis=i,o._isLoading=!0,(n=n||{}).useManifest=!1,void 0===n.priority&&(n.priority=b8e.ResMgr.UI_PRIOR),void 0===n.recycleDelay&&(n.recycleDelay=b8e.ResMgr.UI_RECYCLE_DELAY),o._options=n,o._startLoad()))},_startLoad:function(){var t=this;t._hierarchyVisible&&(t._ui||t._loadStarted||t._url&&(t._loadStarted=!0,b8e.res.loadRes(b8e.ResMgr.UI_ROOT+"/"+t._url,b8e.UIAsset,t.onLoadComplete,t,null,t._options)))},onLoadComplete:function(t,e){this._isLoading=!1,this._isLoaded=!0,e&&this._setUI(e)},_applyProp:function(t){var e=this._propMap.get(t);if(e){var i=e.thisArg;if(i)if(r(i[t])===b8e.TypeFunction)i[t].call(i,e.value);else i[t]=e.value}},callProp:function(t,e,i){this._propMap.set(t,{value:e,thisArg:i}),this._applyProp(t)},unloadUI:function(){var t=this;for(var e in t._displayById)t._displayById[e].release();t._displayById={},t._componentByName={},t._buttonDisplays.length=0,t._waitParentById={},t._waitContentById={},t._url&&(b8e.res.unloadRes(b8e.ResMgr.UI_ROOT+"/"+t._url,t.onLoadComplete,t),t._url=null),t._ui=null,t._uiData=null,t._loadStarted=!1,t._options=null,t.setAnchor(0,0),t.setSize(0,0),t._onComplete=null,t._onCompleteThis=null,t._root=null,t._propMap.clear(),t._isLoading=!1,t._isLoaded=!1,t._nextIdx=0,t._timeoutIdx&&(b8e.clearTimeout(t._timeoutIdx),t._timeoutIdx=void 0)},invalidate:function(){this._timeoutIdx&&(b8e.clearTimeout(this._timeoutIdx),this._timeoutIdx=void 0),this._super()},onHierarchyVisible:function(t){this._super(),t&&this._startLoad()},resetDisplay:function(){this._super()},isLoading:function(){return this._isLoading},isLoaded:function(){return this._isLoaded},restore:function(){this._super()},recycle:function(){this.unloadUI(),this._super()},release:function(){this.constructor===x?x.put(this):this.destroy()},dispose:function(){var t=this;t._displayById=null,t._componentByName=null,t._buttonDisplays=null,t._waitParentById=null,t._waitContentById=null,t._propMap&&(t._propMap.release(),t._propMap=null),t._super()},destroy:function(){this.constructor===x&&(x.poolCall||b8e.warn(3358)),this._super()}}),e=new b8e.Pool(x,2048);x.get=function(){return e.get()},x.put=function(t){return e.put(t)},x.BATCH_PARSE=50,x.allowUseAppRes=!1,b8e.RC("$$b8e","$$UIDisplay",t)})(),function(){var t,e=t=b8e.BaseDisplay.extends({ctor:function(){var t=this;t.constructor===e&&(e.poolCall||b8e.warn(3128)),t._super(),t._isDirty=!1,t.resetLabel(),t._addSizeChangedEvent(),t._addAnchorChangedEvent()},_createNode:function(){var t=b8e.TextField.get();this._label=this._renderNode=t,t.type=b8e.TextFieldType.DYNAMIC;var e=b8e.createNode();return e.addChild(t),e},onHierarchyVisible:function(){this._super()},setStroke:function(t,e){var i=this;if(0<t){if(i._label){var n=i._outline=i._node.addComponent(cc.LabelOutline);n&&(e=(4278190080|16777215&e)>>>0,n.color=b8e.ColorUtil.toCCColor(e),n.width=t)}}else i.removeOutline();i._isDirty=!0},setColor:function(t){t!==this._color&&(this._color=t,this._label.textColor=16777215&t)},string:{set:function(t){t+="";var e=this;if(e._text!==t){e._text=t;var i=e._label;i&&(e._isFontLoading||(i.string=e._text)),e._isDirty=!0,e._updateTextSize()}},get:function(){return this._text}},setText:function(t){this.string=t},_updateTextSize:function(){var t=this._label,e=this._width;e<=0&&(e=t.textWidth),e=0<e?e:0;var i=this._height;i<=0&&(i=t.textHeight),i=0<i?i:0,this._setContentSize(e,i)},_updateAnchorOffset:function(){this._applyAnchorOffset()},_setContentSize:function(t,e){var i=this._super(t,e);return i&&(this._isDirty=!0),i},_applyContentSize:function(t,e){t<=0&&(t=NaN),e<=0&&(e=NaN),this._super(t,e)},enableWrapText:{set:function(t){this._label&&(this._label.enableWrapText=t),this._isDirty=!0},get:function(){return this._label.enableWrapText}},isWordWrap:function(t){this.enableWrapText=t},isMultiline:function(t){t?this.setOverflow(b8e.OverflowType.RESIZE_HEIGHT):this.setOverflow(b8e.OverflowType.NONE)},lineHeight:{set:function(t){this.setLineHeight(t)},get:function(){return this._lineHeight}},setLineHeight:function(t){var e=this;e._lineHeight!=t&&(e._lineHeight=t,e._applyLineHeight(0<e._lineHeight?e._lineHeight:e._fontSize+2),e._isDirty=!0)},_applyLineHeight:function(t){this._label&&(this._label.lineSpacing=t)},spacingX:{set:function(t){this._label&&(this._label.spacingX=t),this._isDirty=!0},get:function(){return this._label.spacingX}},setLetterSpacing:function(t){this.spacingX=t},isBold:function(t){var e=this._label;b8e.isCocos?e&&e._enableBold&&e._enableBold(t):(b8e.isEgret,e.bold=t),this._isDirty=!0},isUnderline:function(t){var e=this._label;if(e){e._enableUnderline&&e._enableUnderline(t);var i=e._underlineGraphics;i&&(i.setParent(null),i.destroy(),i=e._underlineGraphics=void 0)}this._isDirty=!0},isItalics:function(t){var e=this._label;e&&e._enableItalics&&e._enableItalics(t),this._isDirty=!0},fontSize:{set:function(t){this.setFontSize(t)},get:function(){return this._fontSize}},_applyFontSize:function(t){this._label.size=t},setFontSize:function(t){var e=this;e._fontSize!=t&&(e._fontSize=t,e._applyFontSize(e._fontSize),e._lineHeight<=0&&e._applyLineHeight(e._fontSize+2),e._isDirty=!0)},setFontFile:function(t){var e=this;e._isDirty=!0,e._isFontLoading=!1;var i=e._label;if(i&&(i.string=e._text||"",e._fontUrl&&(b8e.res.unloadRes(e._fontUrl,e.onFontComplete,e),e._fontUrl=null,i.font=null),t)){e._fontUrl=t,e._isFontLoading=!0,i.string="";var n={};if(n.priority=b8e.ResMgr.FONT_PRIOR,-1<e._fontUrl.lastIndexOf(".bbf")){n.useManifest=!1;var o=void 0;if(b8e.bfBundle){var s=e._fontUrl.indexOf("ui/");if(-1<s){var r=e._fontUrl.substring(s+3,e._fontUrl.indexOf(".bbf"));o=b8e.bfBundle[r]}}n.rawData=o,b8e.res.loadRes(e._fontUrl,b8e.BitmapFont,e.onFontComplete,e,null,n)}else n.useManifest=!0,b8e.res.loadRes(e._fontUrl,null,e.onFontComplete,e)}},onFontComplete:function(t,e){if(t)b8e.error(t);else{var i=this._label,n=void 0;n=e.__BitmapFont?e.getFont():e,i.font=n,i.string=this._text||"",this._isFontLoading=!1,this._isDirty=!0}},fontFamily:{set:function(t){this._label&&(this._label.fontFamily=t),this._isDirty=!0},get:function(){return this._label.fontFamily}},setFontFamily:function(t){this.fontFamily=t},useSystemFont:{set:function(t){this._label&&(this._label.useSystemFont=t),this._isDirty=!0},get:function(){return this._label.useSystemFont}},setUseSystemFont:function(t){this.useSystemFont=t},horizontalAlign:{set:function(t){this.setHorizontalAlign(t)},get:function(){return this._horizontalAlign}},setHorizontalAlign:function(t){var e=this;if(e._horizontalAlign!=t){e._horizontalAlign=t,e._overflow==b8e.OverflowType.NONE&&t!=b8e.HorizontalAlign.LEFT&&b8e.warn(5001);var i=e._label;i&&(i.textAlign=t),e._isDirty=!0}},verticalAlign:{set:function(t){this.setVerticalAlign(t)},get:function(){return this._verticalAlign}},setVerticalAlign:function(t){var e=this;e._verticalAlign!=t&&(e._verticalAlign=t,e._label&&(e._label.verticalAlign=t),e._isDirty=!0)},overflow:{set:function(t){this.setOverflow(t)},get:function(){return this._overflow}},setOverflow:function(t){var e=this;e._overflow=t,e._label&&(t===b8e.OverflowType.RESIZE_HEIGHT?e._label.multiline=!0:e._label.multiline=!1,e._isDirty=!0)},setFontAtlasName:function(t){this._fontAtlasName!=t&&(this._fontAtlasName=t)},removeOutline:function(){var t=this;t._label&&t._outline&&(t._node.removeComponent(t._outline),t._outline=null),t._isDirty=!0},getWidth:function(){return this._updateRenderData(),this._super()},getHeight:function(){return this._updateRenderData(),this._super()},setCacheMode:function(t){if(!b8e.isCocos190){var e=this._label;e&&(e.cacheMode=t)}},_updateRenderData:function(){if(this._isDirty){if(b8e.isCocos&&!b8e.isCocos190){var t=this._label;t&&t._updateRenderData(!0,!0)}this._isDirty=!1}},deserailization:function(t,e){var i=this;i._super(t);var n=t.size;n&&i.setSize(n[0]+2,n[1]+2);var o=e.fontSize;i.setFontSize(o);var s=e.lineHeight;i.setLineHeight(s);var r=e.overflow;i.setOverflow(r);var a=e.horizontalAlign;r==b8e.OverflowType.NONE&&(a=b8e.HorizontalAlign.LEFT),i.setHorizontalAlign(a);var l=e.verticalAlign;i.setVerticalAlign(l);var _=e.isWordWrap;i.isWordWrap(_);var c=e.letterSpacing;i.setLetterSpacing(c);var h=e.fontFile;h&&i.setFontFile(b8e.ResMgr.UI_ROOT+"/"+h);var u=i.getDefaultText(e);i.setText(u)},setColorTransfrom:function(t){b8e.isCocos190||this._label.setColorTransfrom(t)},getDefaultText:function(t){return t.text},resetLabel:function(){var t=this;t.setCacheMode(b8e.macro.DEFAULT_CACHE_MODE),t.setFontSize(24),t.setLineHeight(0),t.setLetterSpacing(0),t.setOverflow(b8e.OverflowType.NONE),t.setHorizontalAlign(b8e.HorizontalAlign.LEFT),t.setVerticalAlign(b8e.VerticalAlign.TOP),t.setFontFile(null),t.setFontFamily(b8e.macro.DEFAULT_FONT_FAMILY),t.setUseSystemFont(!0),t.isWordWrap(!0),t.isBold(!1),t.isUnderline(!1),t.removeOutline(),t.setText(""),t.setFontAtlasName("default"),t.setColorTransfrom(null),t._isFontLoading=!1,t._isDirty=!1},recycle:function(){this.resetLabel(),this._super()},release:function(){this.constructor===e?e.put(this):this.destroy()},dispose:function(){var t=this;t._label&&(t._node.removeComponent(t._label),t._label=null),t._super()},destroy:function(){this.constructor===e&&(e.poolCall||b8e.warn(3129)),this._super()}}),i=new b8e.Pool(e,4096);e.get=function(){return i.get()},e.put=function(t){return i.put(t)},b8e.RC("$$bui","$$Label",t)}(),function(){var t,e=t=b8e.BaseDisplay.extends({ctor:function(){this.constructor===e&&(e.poolCall||b8e.warn(3122)),this._super()},_createNode:function(){var t=new b8e.DisplayShape;this._renderNode=t,this._graphics=t.graphics;var e=b8e.createNode();return e.addChild(t),e},_updateAnchorOffset:function(){this._applyAnchorOffset()},getGraphics:function(){return this._graphics},fillColor:function(t){this._graphics.beginFill(16777215&t,(t>>>24)/255)},stroke:function(){this._graphics.endFill()},fill:function(){},fillRect:function(t,e,i,n){if(0!=this._height){var o=this._graphics;o.drawRect(t,this._height-n-e,i,n),o.endFill()}else b8e.warn(1061)},fillCircle:function(){},fillRoundRect:function(t,e,i,n,o){if(0!=this._height){var s=this._graphics;s.drawRoundRect(t,this._height-n-e,i,n,o),s.endFill()}else b8e.warn(1061)},moveTo:function(t,e){0!=this._height?this._graphics.moveTo(t,this._height-e):b8e.warn(1061)},lineTo:function(t,e){0!=this._height?this._graphics.lineTo(t,this._height-e):b8e.warn(1061)},lineWidth:function(t){this._lineWidth!=t&&(this._lineWidth=t,this._applyLineStyle())},strokeColor:function(t){var e=this,i=16777215&t,n=(t>>>24)/255;e._strokeColor==i&&e._strokeAlpha==n||(e._strokeColor=i,e._strokeAlpha=n,e._applyLineStyle())},_applyLineStyle:function(){this._graphics.lineStyle(this._lineWidth,this._strokeColor,this._strokeAlpha)},clear:function(){var t=this;t._lineWidth=0,t._strokeColor=0,t._strokeAlpha=0,t._applyLineStyle(),t._graphics&&t._graphics.clear()},restore:function(){this.clear(),this._super()},recycle:function(){this.clear(),this._super()},release:function(){this.constructor===e?e.put(this):this.destroy()},dispose:function(){this._graphics&&(this._graphics=null),this._super()},destroy:function(){this.constructor===e&&(e.poolCall||b8e.warn(3123)),this._super()}}),i=new b8e.Pool(e,1024);e.get=function(){return i.get()},e.put=function(t){return i.put(t)},b8e.RC("$$bui","$$Graphics",t)}(),function(){var t,e=t=b8e.BaseDisplay.extends({ctor:function(){var t=this;t.constructor===e&&(e.poolCall||b8e.warn(3124)),t._super(),t.needActiveInHierarchyEvent=!0,t.renderable=!0,t._isLoaded=!1,t._isLoading=!1,t._frameAtlas=null,t._frame=null,t._addSizeChangedEvent(),t._addAnchorChangedEvent()},_createNode:function(){var t=new b8e.Bitmap;this._sprite=this._renderNode=t;var e=b8e.createNode();return e.addChild(t),e},sizeMode:{set:function(t){this.setSizeMode(t)},get:function(){return this._sizeMode}},setSizeMode:function(t){this._sizeMode!=t&&(this._sizeMode=t)},customSizeMode:function(){this.setSizeMode(bui.SizeMode.CUSTOM)},rawSizeMode:function(){this.setSizeMode(bui.SizeMode.RAW)},type:{set:function(t){this.setStyle(t)},get:function(){return this._style}},setStyle:function(t){if(this._style!=t){this._style=t;var e=bui.SpriteStyle.toFillMode(t);this._sprite.fillMode=e}},loadAtlasFrame:function(t,e,i,n,o){var s=this;if(s._atlasUrl==t)return s._frameName=e,s._onComplete=i,s._onCompleteThis=n,void(s._isLoaded&&(s.setFrame(s._frameAtlas.getSpriteFrame(e)),s._onComplete&&s._onComplete.call(s._onCompleteThis,s,s._frame),s._onComplete=null,s._onCompleteThis=null));s.unloadTexture(),s.lazyActiveInHierarchy=!0,s._atlasUrl=t,s._frameName=e,s._onComplete=i,s._onCompleteThis=n,void 0===(o=o||{}).priority&&(o.priority=b8e.ResMgr.SPRITE_PRIOR),void 0===o.recycleDelay&&(o.recycleDelay=b8e.ResMgr.SPRITE_RECYCLE_DELAY),s._options=o,s._startLoad()},loadTexture:function(t,e,i,n){var o=this;if(o._url==t)return o._onComplete=e,o._onCompleteThis=i,void(o._isLoaded&&(o._onComplete&&o._onComplete.call(o._onCompleteThis,o,o._frame),o._onComplete=null,o._onCompleteThis=null));o.unloadTexture(),o.lazyActiveInHierarchy=!0,o._url=t,o._onComplete=e,o._onCompleteThis=i,void 0===(n=n||{}).priority&&(n.priority=b8e.ResMgr.SPRITE_PRIOR),void 0===n.recycleDelay&&(n.recycleDelay=b8e.ResMgr.SPRITE_RECYCLE_DELAY),o._options=n,o._startLoad()},onHierarchyVisible:function(t){this._super(),t?this._startLoad():this.unload()},_onActiveInHierarchy:function(){this._super(),this.lazyActiveInHierarchy=!1},setColorTransfrom:function(t){b8e.isCocos190||this._sprite.setColorTransfrom(t)},_startLoad:function(){var t=this;if(t._hierarchyVisible&&!t._loadStarted&&(t._url||t._atlasUrl))if(t._loadStarted=!0,t._isLoading=!0,t._url)b8e.res.loadRes(t._url,b8e.SpriteFrame,t.onFrameComplete,t,null,t._options);else{var e=void 0;if(b8e.tbBundle){var i=t._atlasUrl.indexOf("ui/");if(-1<i){var n=t._atlasUrl.substring(i+3,t._atlasUrl.indexOf(".btf"));e=b8e.tbBundle[n]}}t._options.rawData=e,b8e.res.loadRes(t._atlasUrl,b8e.FrameAtlas,t.onAtlasComplete,t,null,t._options)}},onFrameComplete:function(t,e){var i=this;i._isLoaded=!0,i._isLoading=!1,e?(e.scale9Inset=i._scale9Inset,i.setFrame(e)):i.setFrame(null),i._onComplete&&i._onComplete.call(i._onCompleteThis,i,i._frame),i._onComplete=null,i._onCompleteThis=null},onAtlasComplete:function(t,e){var i=this;i._isLoaded=!0,i._isLoading=!1,e?(i._frameAtlas=e,i.setFrame(e.getSpriteFrame(i._frameName))):(i._frameAtlas=null,i.setFrame(null)),i._onComplete&&i._onComplete.call(i._onCompleteThis,i,i._frame),i._onComplete=null,i._onCompleteThis=null},unload:function(){var t=this;t.setFrame(null),t._loadStarted&&(t._url?b8e.res.unloadRes(t._url,t.onFrameComplete,t):t._atlasUrl&&b8e.res.unloadRes(t._atlasUrl,t.onAtlasComplete,t)),t._loadStarted=!1,t._isLoaded=!1,t._isLoading=!1},unloadTexture:function(){var t=this;(t._url||t._atlasUrl)&&(t.unload(),t._onComplete=null,t._onCompleteThis=null,t._url=null,t._atlasUrl=null,t._frameName=null,t._frameAtlas=null,t._options=null)},setTexture:function(t){var e=this;if(e._spriteFrame&&(e._spriteFrame.destroy(),e._spriteFrame=null),e._texture=t){var i=new b8e.SpriteFrame;(e._spriteFrame=i).scale9Inset=e._scale9Inset,i.setTexture(t),e.setFrame(i)}else e.setFrame(null)},scale9Inset:{set:function(t){this._scale9Inset=t}},spriteFrame:{set:function(t){b8e.isCocos&&(this._sprite.spriteFrame=t)},get:function(){return this._sprite.spriteFrame}},setFrame:function(t){var e=this;if(e._sprite){var i=null;if(t){if(t.__SpriteFrame){if(i=t.getTexture(),e._sprite.texture==i)return;e._sprite.texture=i}}else e._sprite.texture&&(e._sprite.texture=null);if(e._sizeMode===bui.SizeMode.CUSTOM)e._sprite.width=e._width,e._sprite.height=e._height;else{var n=0,o=0;i&&(n=i.textureWidth,o=i.textureHeight),e._sprite.width=n,e._sprite.height=o,e._setContentSize(n,o)&&e._applyContentSize(n,o)}e._frame=t}},dynamicAtlas:function(){this._dynamicAtlas=!0},getShader:function(){},setSize:function(t,e){this.customSizeMode(),this._super(t,e)},setBlendMode:function(t){if(this._sprite){var e=void 0,i=void 0;switch(t){case b8e.BlendMode.NORMAL:e=cc.macro.SRC_ALPHA,i=cc.macro.ONE_MINUS_SRC_ALPHA;break;case b8e.BlendMode.ADD:e=cc.macro.SRC_ALPHA,i=cc.macro.ONE;break;case b8e.BlendMode.LIGHTEN:e=cc.macro.SRC_ALPHA,i=cc.macro.DST_ALPHA;break;default:e=cc.macro.SRC_ALPHA,i=cc.macro.ONE_MINUS_SRC_ALPHA}this._sprite.srcBlendFactor=e,this._sprite.dstBlendFactor=i}},_updateAnchorOffset:function(){this._applyAnchorOffset()},isLoaded:{get:function(){return this._isLoaded}},isLoading:{get:function(){return this._isLoading}},resetSprite:function(){var t=this;t._isLoaded=!1,t._isLoading=!1,t._dynamicAtlas=!1,t._scale9Inset=null,t._materialType=null,b8e.isCocos&&(t._sprite.trim=!1),t.setSizeMode(bui.SizeMode.TRIMMED),t.setStyle(bui.SpriteStyle.SIMPLE),t.setColorTransfrom(null),t.resetShader()},resetShader:function(){},clear:function(){this.unloadTexture(),this.setTexture(null),this.setFrame(null)},deserailization:function(t,e,i){var n=this;n._super(t);var o=e.style;n.setStyle(o);var s=e.sizeMode;n.setSizeMode(s);var r=e.atlas,a=e.frame;r?a&&n.loadAtlasFrame(b8e.ResMgr.UI_ROOT+"/"+r,a,null,null,i):a&&n.loadTexture(b8e.ResMgr.UI_ROOT+"/"+a,null,null,i)},resetDisplay:function(){this._super(),this.lazyActiveInHierarchy=!0,this.resetSprite()},invalidate:function(){this.clear(),this._super()},recycle:function(){this._super()},release:function(){this.constructor===e?e.put(this):this.destroy()},dispose:function(){var t=this;t._sprite&&(t._node.removeComponent(t._sprite),t._sprite.destroy(),t._sprite=null),t._super()},destroy:function(){this.constructor===e&&(e.poolCall||b8e.warn(3125)),this._super()}});e.LAZY_IN_HIERARCHY=!0,e.BATCH_IN_HIERARCHY_NUM=10;var i=new b8e.Pool(e,16384);e.get=function(){return i.get()},e.put=function(t){return i.put(t)},b8e.RC("$$bui","$$Sprite",t)}(),function(){var t,e=t=b8e.BaseDisplay.extends({ctor:function(){this.constructor===e&&(e.poolCall||b8e.warn(3126)),this._super(),this.resetEditBox()},_createNode:function(){var t=b8e.TextField.get();this._editBox=this._renderNode=t,t.type=b8e.TextFieldType.INPUT;var e=b8e.createNode();return e.addChild(t),e},string:{set:function(t){t+="";this._editBox.string!==t&&this._editBox&&(this._editBox.string=t)},get:function(){return this._editBox.string}},setText:function(t){this.string=t},getText:function(){return this.string},setColor:function(t){t!==this._color&&(this._color=t,this._editBox.textColor=16777215&t)},fontSize:{set:function(t){this.setFontSize(t)},get:function(){return this._fontSize}},setFontSize:function(t){var e=this;e._fontSize!=t&&(e._fontSize=t,e._applyFontSize(e._fontSize),e._lineHeight<=0&&e._applyLineHeight(e._fontSize+2))},_updateAnchorOffset:function(){this._applyAnchorOffset()},_applyFontSize:function(t){this._editBox.size=t},lineHeight:{set:function(t){this.setLineHeight(t)},get:function(){return this._lineHeight}},setLineHeight:function(t){var e=this;e._lineHeight!=t&&(e._lineHeight=t,e._applyLineHeight(0<e._lineHeight?e._lineHeight:e._fontSize+2))},_applyLineHeight:function(t){this._editBox&&(this._editBox.lineSpacing=t)},setCacheMode:function(t){if(!b8e.isCocos190){var e=this._editBox;e&&(e.cacheMode=t)}},placeholder:{set:function(t){this._editBox&&(this._editBox.placeholder=t)},get:function(){return this._editBox.placeholder}},setPlaceholder:function(t){this.placeholder=t},placeholderFontSize:{set:function(t){this._editBox&&(this._editBox.placeholderFontSize=t)},get:function(){return this._editBox.placeholderFontSize}},setPlaceholderFontSize:function(t){this.placeholderFontSize=t},placeholderFontColor:{set:function(t){this._editBox&&(this._editBox.placeholderFontColor=t)},get:function(){return this._editBox.placeholderFontColor}},setPlaceholderFontColor:function(t){this.placeholderFontColor=t},maxLength:{set:function(t){this._editBox&&(this._editBox.maxLength=t)},get:function(){return this._editBox.maxLength}},setMaxLength:function(t){this.maxLength=t},inputMode:{set:function(t){this._editBox&&(this._editBox.inputMode=t)},get:function(){return this._editBox.inputMode}},setInputMode:function(t){this.inputMode=t},inputFlag:{set:function(t){this._editBox&&(this._editBox.inputFlag=t)},get:function(){return this._editBox.inputFlag}},setTouchEnabled:function(){},setInputFlag:function(t){this.inputFlag=t},horizontalAlign:{set:function(t){var e=this._editBox;e&&(e.textAlign=t),this._isDirty=!0},get:function(){return this._editBox.textAlign}},setHorizontalAlign:function(t){this.horizontalAlign=t},verticalAlign:{set:function(t){this._editBox&&(this._editBox.verticalAlign=t),this._isDirty=!0},get:function(){return this._editBox.verticalAlign}},setVerticalAlign:function(t){this.verticalAlign=t},setFontAtlasName:function(t){this._fontAtlasName!=t&&(this._fontAtlasName=t)},resetEditBox:function(){var t=this;t.setCacheMode(b8e.macro.DEFAULT_CACHE_MODE),t.setPlaceholder(""),t.setFontSize(24),t.setLineHeight(0),t.setHorizontalAlign(b8e.HorizontalAlign.LEFT),t.setVerticalAlign(b8e.VerticalAlign.TOP),t.setText(""),t.setFontAtlasName("default")},deserailization:function(t,e){var i=this;i._super(t);var n=e.fontColor;i.setColor(b8e.ColorUtil.argb(n[3],n[0],n[1],n[2]));var o=e.fontSize;i.setFontSize(o);var s=e.lineHeight;i.setLineHeight(s);var r=e.maxLength;i.setMaxLength(r);var a=e.inputMode;i.setInputMode(a);var l=e.inputFlag;i.setInputFlag(l),i.setHorizontalAlign(b8e.HorizontalAlign.LEFT),i.setVerticalAlign(b8e.VerticalAlign.MIDDLE);var _=e.text;i.setText(_)},recycle:function(){this.resetEditBox(),this._super()},release:function(){this.constructor===e?e.put(this):this.destroy()},dispose:function(){var t=this;t._editBox&&(t._node.removeComponent(t._editBox),t._editBox=null),t._super()},destroy:function(){this.constructor===e&&(e.poolCall||b8e.warn(3127)),this._super()}}),i=new b8e.Pool(e,1024);e.get=function(){return i.get()},e.put=function(t){return i.put(t)},b8e.RC("$$bui","$$EditBox",t)}(),function(){var t;t=b8e.BaseDisplay.extends({show:function(){},hide:function(){},_setParent:function(t){var e=this._super(t);return e&&(t?this.show():this.hide()),e}}),b8e.RC("$$bui","$$Widget",t)}();r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){var t;t=bui.Widget.extends({ctor:function(t){var e=this;t&&(+t&&(e._urlId=t),e._buiUrl=t),e._resInited=!1,e.loadDepends=b8e.macro.UI_LOAD_DEPENDS,e.isSubWidget=!1,e.fadeEnabel=!1,e._super()},_callOnShow:function(){var t=b8e.macro.BENCHMARK,e=t?b8e.getTimer():0;if(this.onShow(),t){var i=b8e.getTimer()-e;3<i&&b8e.benchmark(3505,this.getClassName(),i)}},show:function(){var t=this;t.__isShow||(t.__isShow=!0,t._resInited?t.__isInit__&&(t._initCompleted?(t._preShow(),t._callOnShow(),t.playFade(),t.notifyWaits()):t._onResComplete()):(t._initPrefab(),t._resInited=!0),t._onShowVec&&0<t._onShowVec.count()&&b8e.CallBackUtil.exceteCallBackData(t,t._onShowVec),t._super())},hide:function(){var t=this;t.__isShow&&(t.__isShow=!1,t._onHideVec&&0<t._onHideVec.count()&&b8e.CallBackUtil.exceteCallBackData(t,t._onHideVec),t._super(),t.__isInit__&&(b8e.Tween.kill(t._container),t.onHide()))},_initPrefab:function(){var t=this;if(t._buiUrl){var e=t._uiDisplay;e||(e=t._container=t._uiDisplay=b8e.UIDisplay.get(),t.hasDebugSurface()&&e.showDebugSurface(),t.addChild(e));var i=e.isLoaded(),n=e.isLoading();if(i)t._onComplete();else if(!n){var o=b8e.UIAsset.getUIData(t._buiUrl);e.loadUI(t._buiUrl,t._onComplete,t,{loadDepends:t.loadDepends,rawData:o})}}else t._container||(t._container=b8e.BaseDisplay.get(),t.addChild(t._container)),t._onComplete()},_onComplete:function(){var t=this;if(!t.__isInit__){if(t._buiUrl){var e=t._uiDisplay;e&&!t.skin&&(t.skin=e.componentByName,t._evts=e.buttonDisplays,t.moduleEnum?(b8e.module.isInited(t.moduleEnum)&&b8e.module.bindViewToControl(t.moduleEnum),b8e.app.isInited(t.moduleEnum)&&b8e.app.bindView(t.moduleEnum)):t._bindEvts(),t.setAnchor(e.anchorX,e.anchorY),t.setSize(e.width,e.height))}var i=t._waitWidgets;if(i){if(t.skin)for(var n=t.skin.subWidget||t._container,o=i.length,s=0;s<o;s++){var r=i[s];n.addChild(r)}i.length=0,t._waitWidgets=null}var a=b8e.macro.BENCHMARK,l=a?b8e.getTimer():0;if(t.init(),a){var _=b8e.getTimer()-l;3<_&&b8e.benchmark(3504,t.getClassName(),_)}t.__isInit__=!0}t.__isShow&&t._onResComplete()},_onResComplete:function(){var t=this;t._initCompleted=!0,t._initShow(),t._preShow(),t._callOnShow(),t.playFade(),t.notifyWaits(),t.loadComplete(),t._onLoadedVec&&0<t._onLoadedVec.count()&&b8e.CallBackUtil.exceteCallBackData(t,t._onLoadedVec)},addOnLoaded:function(t,e,i){this._onLoadedVec||(this._onLoadedVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._onLoadedVec,t,e,i)},removeOnLoaded:function(t,e){this._onLoadedVec&&0<this._onLoadedVec.count()&&b8e.CallBackUtil.removeCallBackData(this._onLoadedVec,t,e)},addOnHide:function(t,e,i){this._onHideVec||(this._onHideVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._onHideVec,t,e,i)},removeOnHide:function(t,e){this._onHideVec&&0<this._onHideVec.count()&&b8e.CallBackUtil.removeCallBackData(this._onHideVec,t,e)},addOnShow:function(t,e,i){this._onShowVec||(this._onShowVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._onShowVec,t,e,i)},removeOnShow:function(t,e){this._onShowVec&&0<this._onShowVec.count()&&b8e.CallBackUtil.removeCallBackData(this._onShowVec,t,e)},getComponent:function(t){return this.skin&&this.skin[b8e.getAliasName(t)]||null},setComponent:function(t,e){this.skin&&(this.skin[b8e.getAliasName(t)]=e)},_initSkin:function(){},_bindEvts:function(){var t=this;if(t.__bind)b8e.error(2064);else{var e=void 0,i=void 0,n=void 0,o=void 0,s=t._evts;if(s&&0<s.length)for(e=0,i=s.length;e<i;e++)(n=s[e])&&""!==n.name?(o=t[b8e.getAliasName(n.name)])&&(void 0===o?"undefined":r(o))===b8e.TypeFunction?(b8e.evt.onC(n,o,t),(o=t[b8e.getAliasName(n.name+"_ts")])&&b8e.evt.onTouchStart(n,o,t),(o=t[b8e.getAliasName(n.name+"_tc")])&&b8e.evt.onTouchCancel(n,o,t),b8e.evt.addButtonHandler(n)):b8e.error(2066,n.name):b8e.error(2065);t.__bind=!0}},_unbindEvts:function(){var t=this;if(t.__bind){var e=void 0,i=void 0,n=void 0,o=void 0,s=t._evts;if(s&&0<s.length)for(e=0,i=s.length;e<i;e++)(n=s[e])&&""!==n.name?(o=t[b8e.getAliasName(n.name)])&&(void 0===o?"undefined":r(o))===b8e.TypeFunction?(b8e.evt.offC(n,o,t),(o=t[b8e.getAliasName(n.name+"_ts")])&&b8e.evt.offTouchStart(n,o,t),(o=t[b8e.getAliasName(n.name+"_tc")])&&b8e.evt.offTouchCancel(n,o,t),b8e.evt.removeButtonHandler(n)):b8e.error(2068,n.name):b8e.error(2067);t.__bind=!1}},_initShow:function(){},_preShow:function(){},addWidget:function(t){var e=this;if(t.isSubWidget=!0,t.setLocalZOrder(1e4),e._buiUrl){var i=e.skin;if(i){var n=i.subWidget;e._prefab?(n||e._prefab).addChild(t):e._uiDisplay&&(n||e._uiDisplay).addChild(t)}else{var o=e._waitWidgets;(o=o||(e._waitWidgets=[])).indexOf(t)<0&&(o[o.length]=t)}}else e._container.addChild(t)},dptG:function(t,e,i,n){b8e.evt.dptG(t,e,i,n)},getEvts:function(){return this._evts},isInit:{get:function(){return this.__isInit__}},urlId:{get:function(){return this._urlId}},setBuiUrl:function(t){this._buiUrl=t},setPreUrl:function(t){this._preUrl=t},waitNotify:function(t){var e=this;if(e.__isInit__)e.notify.apply(e,t);else{var i=e.__waitNotifys;(i=i||(e.__waitNotifys=[]))[i.length]=t}},notifyWaits:function(){var t=this.__waitNotifys;if(t&&0<t.length){for(var e=0,i=t.length;e<i;e++)this.notify.apply(this,t[e]);t.length=0,this.__waitNotifys=t=null}},send:function(){b8e.module.sendToControl(this.bindEnum,arguments)},loadComplete:function(){},init:function(){},onShow:function(){},onHide:function(){},playFade:function(){},notify:function(){},setSize:function(t,e){this._super(t,e);var i=this._uiDisplay;i&&i.setSize(t,e);var n=this._container;n&&n.setSize(t,e);var o=this._prefab;o&&o.setSize(t,e)},resetDisplay:function(){var t=this;t._super(),t._onLoadedVec&&b8e.CallBackUtil.removeAllCallBackData(t._onLoadedVec),t._onHideVec&&b8e.CallBackUtil.removeAllCallBackData(t._onHideVec),t._onShowVec&&b8e.CallBackUtil.removeAllCallBackData(t._onShowVec)},dispose:function(){var t=this;t.moduleEnum?(b8e.module.isInited(t.moduleEnum)&&b8e.module.unbindViewToControl(t.moduleEnum),b8e.app.isInited(t.moduleEnum)&&b8e.app.unbindView(t.moduleEnum)):t._unbindEvts(),t._evts=null,t._prefab?(t._prefab.release(),t._container=t._prefab=null):t._uiDisplay?(t._uiDisplay.release(),t._container=t._uiDisplay=null):t._container&&(t._container.release(),t._container=null),t._preUrl=null,t._buiUrl=null,t._urlId=null,t.skin=null,t._resInited=!1,t.__isInit__=!1,t.__bind=!1,t.__waitNotifys=null,t._waitWidgets=null,t.moduleEnum=0,t.bindEnum=0,t._onLoadedVec&&(t._onLoadedVec.release(),t._onLoadedVec=null),t._onHideVec&&(t._onHideVec.release(),t._onHideVec=null),t._onShowVec&&(t._onShowVec.release(),t._onShowVec=null),t._super()}});b8e.RC("$$bui","$$SkinWidget",t)})(),function(){var e=void 0,i=void 0;i=b8e.Object.extends({type:0,spacingX:0,spacingY:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,ctor:function(t){this._super(),this.type=e.None,t&&this.setLayout(t)},setLayout:function(t){var e=this;void 0!==t.type&&(e.type=t.type),void 0!==t.spacingX&&(e.spacingX=t.spacingX),void 0!==t.spacingY&&(e.spacingY=t.spacingY),void 0!==t.paddingLeft&&(e.paddingLeft=t.paddingLeft),void 0!==t.paddingRight&&(e.paddingRight=t.paddingRight),void 0!==t.paddingTop&&(e.paddingTop=t.paddingTop),void 0!==t.paddingBottom&&(e.paddingBottom=t.paddingBottom)},clone:function(){var t=new i;return t.setLayout(this),t}}),b8e.BindingUtil.bind(i),e=b8e.Enum({None:0,Horizontal:1,Vertical:2,Grid:3}),bui.HorizontalLayoutAtts={type:e.Horizontal,spacingX:5,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5},bui.VerticalLayoutAtts={type:e.Vertical,spacingY:5,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5},bui.GridLayoutAtts={type:e.Grid,spacingX:5,spacingY:5,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5},bui.HorizontalLayout=new i(bui.HorizontalLayoutAtts),bui.VerticalLayout=new i(bui.VerticalLayoutAtts),bui.GridLayout=new i(bui.GridLayoutAtts),b8e.RC("$$bui","$$Layout",i),b8e.RC("$$bui","$$LayoutType",e)}(),function(){var t;t=bui.Widget.extends({ctor:function(){this._super(),this.needActiveInHierarchyEvent=!0,this.setAnchor(0,1),this.setLayoutType(bui.LayoutType.Vertical)},dispose:function(){var t=this;t._layout&&(t._notifyAdded&&(t._layout.removeNotify(t.updateLayout,t),t._notifyAdded=!1),t._layout=null)},_checkBind:function(){var t=this;t._layout&&(t._hierarchyVisible?t._notifyAdded||(t._layout.addNotify(t.updateLayout,t),t._notifyAdded=!0):t._notifyAdded&&(t._layout.removeNotify(t.updateLayout,t),t._notifyAdded=!1))},onHierarchyVisible:function(){this._checkBind()},setLayoutType:function(t){switch(t){case bui.LayoutType.Horizontal:this.layout=bui.HorizontalLayout;break;case bui.LayoutType.Vertical:this.layout=bui.VerticalLayout;break;case bui.LayoutType.Grid:this.layout=bui.GridLayout;break;default:b8e.error(2055)}},layout:{set:function(t){this._layout=t,this.updateLayout()},get:function(){return this._layout}},updateLayout:function(){bui.LayoutUtil.layout(this)},applyLayout:function(t,e){this.view=t,this.viewChildren=e,this.updateLayout()}}),bui.LayoutUtil={},bui.LayoutUtil.layout=function(t){var e=t.layout;if(e){if(e.type!==bui.LayoutType.None){var i=t.view;if(i){var n=t.viewChildren;if(n&&!(n.length<=0)){for(var o=void 0,s=(t.getAnchor(),0),r=0,a=0,l=0,_=0,c=0,h=0,u=0,d=i.width,f=(i.height,0),p=n.length;f<p;f++){switch(o=n[f],e.type){case bui.LayoutType.Horizontal:s=(a=0<s?s:e.paddingLeft)+o.width+e.spacingX,r=l=-e.paddingTop,_<(h=a+o.width+e.paddingRight)&&(_=h),c<(u=-l+o.height+e.paddingBottom)&&(c=u);break;case bui.LayoutType.Vertical:s=a=e.paddingLeft,r=(l=r<0?r:-e.paddingTop)-o.height-e.spacingY,_<(h=a+o.width+e.paddingRight)&&(_=h),c<(u=-l+o.height+e.paddingBottom)&&(c=u);break;case bui.LayoutType.Grid:d<(s=(a=0<s?s:e.paddingLeft)+o.width+e.paddingRight)?(s=(a=e.paddingLeft)+o.width+e.spacingX,r=l-o.height-e.spacingY):s=a+o.width+e.spacingX,r<0?l=r:r=l=-e.paddingTop,_<(h=a+o.width+e.paddingRight)&&(_=h),c<(u=-l+o.height+e.paddingBottom)&&(c=u)}o.setPosition(a+o.anchorX*o.width,l-o.height*(1-o.anchorY))}_<i.width&&(_=i.width),c<i.height&&(c=i.height),t.setSize(_,c)}}}}else b8e.error(3091)},b8e.RC("$$bui","$$LayoutContainer",t)}(),function(){var t,e=void 0,i=t=bui.Widget.extends({__ScrollView:!0,_props:null,scrollBeginThreshold:10,scrollSpeed:1,_content:null,touchBeginTimer:0,ctor:function(){var t=this;t.constructor===i&&(i.poolCall||b8e.warn(3134)),t._super(),t.setMask(b8e.MaskType.RECT),t._props=new e,t.resetScrollView()},bounces:{get:function(){return this._props._bounces},set:function(t){this._props._bounces=!!t}},setContent:function(t){var e=this;e._content!==t&&(e.removeContent(),t&&((e._content=t).setAnchor(0,1),e.addChild(t),e._addEvents(),e._onScroll()))},getContainer:function(){return this._content},content:{set:function(t){this.setContent(t)},get:function(){return this.getContainer()}},removeContent:function(){var t=this._content;t&&(this._removeEvents(),t.removeFromParent(),this._content=t=null)},_setParent:function(t){var e=this,i=e._super(t);return i&&e.parent&&0==e._width&&0==e._height&&e.setSize(e.parent.width,e.parent.height),i},verticalScrollPolicy:{get:function(){return this._props._verticalScrollPolicy},set:function(t){t!=this._props._verticalScrollPolicy&&(this._props._verticalScrollPolicy=t)}},vertical:{set:function(t){this.verticalScrollPolicy=t?"on":"off"},get:function(){return"on"==this.verticalScrollPolicy}},setVertical:function(t){this.vertical=t},horizontalScrollPolicy:{get:function(){return this._props._horizontalScrollPolicy},set:function(t){t!=this._props._horizontalScrollPolicy&&(this._props._horizontalScrollPolicy=t)}},horizontal:{set:function(t){this.horizontalScrollPolicy=t?"on":"off"},get:function(){return"on"==this.horizontalScrollPolicy}},setHorizontal:function(t){this.horizontal=t},scrollLeft:{get:function(){return this._props._scrollLeft},set:function(t){t!=this._props._scrollLeft&&(this._props._scrollLeft=t,this._validatePosition(!1,!0),this._onScroll())}},scrollTop:{get:function(){return this._props._scrollTop},set:function(t){t!=this._props._scrollTop&&(this._props._scrollTop=t,this._validatePosition(!0,!1),this._onScroll())}},setScrollPosition:function(t,e,i){if((!i||0!=t||0!=e)&&(i||this._props._scrollTop!=t||this._props._scrollLeft!=e)){var n=this._props._scrollTop,o=this._props._scrollLeft;if(i){var s=this.getMaxScrollLeft(),r=this.getMaxScrollTop();(n<=0||r<=n)&&(t/=2),(o<=0||s<=o)&&(e/=2);var a=n+t,l=o+e;this._props._bounces||((a<=0||r<=a)&&(a=Math.max(0,Math.min(a,r))),(l<=0||s<=l)&&(l=Math.max(0,Math.min(l,s)))),this._props._scrollTop=a,this._props._scrollLeft=l}else this._props._scrollTop=t,this._props._scrollLeft=e;this._validatePosition(!0,!0),this._onScroll()}},_validatePosition:function(t,e){if(t){var i=this._height,n=this._getContentHeight();this._props._scrollTop=Math.max(this._props._scrollTop,(0-i)/2),this._props._scrollTop=Math.min(this._props._scrollTop,i<n?n-i/2:i/2)}if(e){var o=this._width,s=this._getContentWidth();this._props._scrollLeft=Math.max(this._props._scrollLeft,(0-o)/2),this._props._scrollLeft=Math.min(this._props._scrollLeft,o<s?s-o/2:o/2)}},_setContentSize:function(t,e){var i=this._super(t,e);return i&&this._onScroll(),i},_updateAnchor:function(){this._super(),this._onScroll()},_onScroll:function(){var t=this,e=t._content;if(e){var i=t._width,n=t._height,o=Math.round(t._props._scrollLeft),s=Math.round(t._props._scrollTop);e.setPosition(-o-i*t.anchorX,s+n*(1-t.anchorY))}},_checkScrollPolicy:function(){var t=this._props._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this._width);this._props._hCanScroll=e;var i=this._props._verticalScrollPolicy,n=this.__checkScrollPolicy(i,this._getContentHeight(),this._height);return this._props._vCanScroll=n,e||n},__checkScrollPolicy:function(t,e,i){return"on"==t||"off"!=t&&i<e},_addEvents:function(){var t=this;b8e.evt.onTouchStart(t,t._onTouchBegin,t),b8e.evt.onTouchStart(t,t._onTouchBeginCapture,t,0,!0),b8e.evt.onTouchEnd(t,t._onTouchEndCapture,t,0,!0)},_removeEvents:function(){var t=this;b8e.evt.offTouchStart(t,t._onTouchBegin,t),b8e.evt.offTouchStart(t,t._onTouchBeginCapture,t),b8e.evt.offTouchEnd(t,t._onTouchEndCapture,t)},_onTouchBegin:function(t){var e=this;if(!t._isDefaultPrevented&&e._checkScrollPolicy()){if(e._props._touchStartPosition.x=t.stageX,e._props._touchStartPosition.y=t.stageY,(e._props._isHTweenPlaying||e._props._isVTweenPlaying)&&e._onScrollFinished(),!e._isTouchEventAdded){e._isTouchEventAdded=!0;var i=b8e.root;b8e.evt.onTouchMove(i,e._onTouchMove,e),b8e.evt.onTouchEnd(i,e._onTouchEnd,e),b8e.evt.onTouchCancel(i,e._onTouchEnd,e),b8e.Ticker.add(e,e._onEnterFrame)}this._logTouchEvent(t)}},_onTouchBeginCapture:function(t){this._checkScrollPolicy()&&this._onTouchBegin(t)},_onTouchEndCapture:function(t){this._props._scrollStarted&&(this._onTouchEnd(),t.isScrollEnd=!0)},dispatchPropagationEvent:function(t){for(var e=t.target,i=this._getPropagationList(e),n=i.length,o=.5*i.length,s=-1,r=0;r<n;r++)if(i[r]===this._content){s=r;break}i.splice(0,s+1),o-=s+1,this._dispatchPropagationEvent(t,i,o),b8e.Event.release(t)},_onTouchMove:function(t){var e=this;if(e._props._lastTouchPosition.x!=t.stageX||e._props._lastTouchPosition.y!=t.stageY){if(!e._props._scrollStarted){var i=t.stageX-e._props._touchStartPosition.x,n=t.stageY-e._props._touchStartPosition.y;if(Math.sqrt(i*i+n*n)<e.scrollBeginThreshold)return void e._logTouchEvent(t)}e._props._scrollStarted=!0,e.touchChildren=!1;var o=e._getPointChange(t);e.setScrollPosition(o.y,o.x,!0),e._calcVelocitys(t),e._logTouchEvent(t)}},_onTouchEnd:function(){var t=this;if(t.touchChildren=!0,t._props._scrollStarted=!1,t._isTouchEventAdded){t._isTouchEventAdded=!1;var e=b8e.root;b8e.evt.offTouchMove(e,t._onTouchMove,t),b8e.evt.offTouchEnd(e,t._onTouchEnd,t),b8e.evt.offTouchCancel(e,t._onTouchEnd,t),b8e.Ticker.remove(t,t._onEnterFrame)}t._moveAfterTouchEnd()},_onEnterFrame:function(){var t=this._props,e=t._lastTouchEvent;if(e){var i=b8e.getTimer();100<i-t._lastTouchTime&&i-t._lastTouchTime<300&&this._calcVelocitys(e),e.release(),t._lastTouchEvent=e=null}},_logTouchEvent:function(t){var e=this._props,i=e._lastTouchEvent;i&&(i.release(),e._lastTouchEvent=i=null),e._lastTouchPosition.x=t.stageX,e._lastTouchPosition.y=t.stageY,e._lastTouchEvent=this.cloneTouchEvent(t),e._lastTouchTime=b8e.getTimer()},_getPointChange:function(t){return{x:!1===this._props._hCanScroll?0:this._props._lastTouchPosition.x-t.stageX,y:!1===this._props._vCanScroll?0:this._props._lastTouchPosition.y-t.stageY}},_calcVelocitys:function(t){var e=b8e.getTimer();if(0!=this._props._lastTouchTime){var i=this._getPointChange(t),n=e-this._props._lastTouchTime;i.x/=n,i.y/=n,this._props._velocitys.push(i),5<this._props._velocitys.length&&this._props._velocitys.shift(),this._props._lastTouchPosition.x=t.stageX,this._props._lastTouchPosition.y=t.stageY}else this._props._lastTouchTime=e},_getContentWidth:function(){return this._content._explicitWidth||this._content._width},_getContentHeight:function(){return this._content._explicitHeight||this._content._height},getMaxScrollLeft:function(){var t=this._getContentWidth()-this._width;return Math.max(0,t)},getMaxScrollTop:function(){var t=this._getContentHeight()-this._height;return Math.max(0,t)},scrollToTop:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=t;i<0&&(i=0),this.setScrollTop(i,e)},scrollToBottom:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=this.getMaxScrollTop()-t;i<0&&(i=0),this.setScrollTop(i,e)},scrollToLeft:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=t;i<0&&(i=0),this.setScrollLeft(i,e)},scrollToRight:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=this.getMaxScrollLeft()-t;i<0&&(i=0),this.setScrollLeft(i,e)},scrollToPos:function(t,e){t&&(void 0===e&&(e=0),this.setScrollLeft(t.x,e),this.setScrollTop(t.y,e))},scrollToLeftPage:function(t){var e=-this._container.x-this._width;e<0&&(e=0),void 0===t&&(t=0),this.scrollToLeft(e,t)},scrollToRightPage:function(t){var e=this,i=-e._container.x+e._width;i>e.getMaxScrollLeft()&&(i=e.getMaxScrollLeft()),void 0===t&&(t=0),e.scrollToLeft(i,t)},_moveAfterTouchEnd:function(){if(0!=this._props._velocitys.length){for(var t={x:0,y:0},e=0,i=0;i<this._props._velocitys.length;i++){var n=this._props._velocitys[i],o=d[i];t.x+=n.x*o,t.y+=n.y*o,e+=o}this._props._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var s=t.x/e*this.scrollSpeed,r=t.y/e*this.scrollSpeed,a=Math.abs(s),l=Math.abs(r),_=this.getMaxScrollLeft(),c=this.getMaxScrollTop(),h=.02<a?this.getAnimationDatas(s,this._props._scrollLeft,_):{position:this._props._scrollLeft,duration:1},u=.02<l?this.getAnimationDatas(r,this._props._scrollTop,c):{position:this._props._scrollTop,duration:1};this.setScrollLeft(h.position,h.duration),this.setScrollTop(u.position,u.duration)}},onTweenFinished:function(t){t==this._props._vScrollTween&&(this._props._isVTweenPlaying=!1),t==this._props._hScrollTween&&(this._props._isHTweenPlaying=!1),0==this._props._isHTweenPlaying&&0==this._props._isVTweenPlaying&&this._onScrollFinished()},_onScrollStarted:function(){},_onScrollFinished:function(){b8e.ScrollTween.removeTweens(this),this._props._hScrollTween=null,this._props._vScrollTween=null,this._props._isHTweenPlaying=!1,this._props._isVTweenPlaying=!1},setScrollTop:function(t,e){void 0===e&&(e=0);var i=Math.min(this.getMaxScrollTop(),Math.max(t,0));if(0!=e){0==this._props._bounces&&(t=i);var n=b8e.ScrollTween.get(this).to({scrollTop:t},e,b8e.ScrollEase.quartOut);i!=t&&n.to({scrollTop:i},300,b8e.ScrollEase.quintOut),this._props._isVTweenPlaying=!0,(this._props._vScrollTween=n).call(this.onTweenFinished,this,[n]),this._props._isHTweenPlaying||this._onScrollStarted()}else this.scrollTop=i},setScrollLeft:function(t,e){void 0===e&&(e=0);var i=Math.min(this.getMaxScrollLeft(),Math.max(t,0));if(0!=e){0==this._props._bounces&&(t=i);var n=b8e.ScrollTween.get(this).to({scrollLeft:t},e,b8e.ScrollEase.quartOut);i!=t&&n.to({scrollLeft:i},300,b8e.ScrollEase.quintOut),this._props._isHTweenPlaying=!0,(this._props._hScrollTween=n).call(this.onTweenFinished,this,[n]),this._props._isVTweenPlaying||this._onScrollStarted()}else this.scrollLeft=i},getAnimationDatas:function(t,e,i){var n=Math.abs(t),o=0,s=e+500*t;if(s<0||i<s)for(s=e;Math.abs(t)!=1/0&&.02<Math.abs(t);)t*=(s+=t)<0||i<s?.998*.95:.998,o++;else o=500*-Math.log(.02/n);return{position:Math.min(i+50,Math.max(s,-50)),duration:o}},cloneTouchEvent:function(t){var e=b8e.Event.create(b8e.TouchEvent,t.type,t.bubbles,t.cancelable);return e.touchPointID=t.touchPointID,e._stageX=t.stageX,e._stageY=t.stageY,e.touchDown=t.touchDown,e._isDefaultPrevented=!1,e._target=t.target,e},deserailization:function(t,e){this._super(t);var i=e.horizontal;this.setHorizontal(i);var n=e.vertical;this.setVertical(n)},resetScrollView:function(){this.setContent(null),this.setHorizontal(!0),this.setVertical(!0);var t=this._props,e=t._lastTouchEvent;e&&(e.release(),t._lastTouchEvent=e=null),t.reset()},recycle:function(){this.resetScrollView(),this._super()},release:function(){this.constructor===i?i.put(this):this.destroy()},dispose:function(){var t=this;t._scrollView&&(t._node.removeComponent(t._scrollView),t._scrollView=null),t._super()},destroy:function(){this.constructor===i&&(i.poolCall||b8e.warn(3135)),this._super()}}),d=[1,1.33,1.66,2,2.33],n=new b8e.Pool(i,512);i.get=function(){return n.get()},i.put=function(t){return n.put(t)};e=b8e.Object.extends({ctor:function(){var t=this;t._super(),t._lastTouchPosition=b8e.Point.get(0,0),t._touchStartPosition=b8e.Point.get(0,0),t._velocitys=[],t.reset()},reset:function(){var t=this;t._verticalScrollPolicy="auto",t._horizontalScrollPolicy="auto",t._scrollLeft=0,t._scrollTop=0,t._hCanScroll=!1,t._vCanScroll=!1,t._lastTouchPosition.setTo(0,0),t._touchStartPosition.setTo(0,0),t._scrollStarted=!1,t._lastTouchTime=0,t._lastTouchEvent=null,t._velocitys.length=0,t._isHTweenPlaying=!1,t._isVTweenPlaying=!1,t._hScrollTween=null,t._vScrollTween=null,t._bounces=!0}});b8e.RC("$$bui","$$ScrollView",t),b8e.RC("$$bui","$$ScrollViewProperties",e)}(),function(){var t,e=t=bui.SkinWidget.extends({ctor:function(t){this._super(t),this.needActiveInHierarchyEvent=!0},_checkBind:function(){var t=this;t.data&&(t.__isInit__&&t._hierarchyVisible?t._notifyAdded||(t.data.addNotify(t.notifyData,t),t._notifyAdded=!0):(e._lazyData.remove(t),t._notifyAdded&&(t.data.removeNotify(t.notifyData,t),t._notifyAdded=!1)))},loadComplete:function(){this._checkBind()},_bind:function(t){this.data||(this.data=t,this._checkBind())},_unbind:function(){var t=this;t.data&&(t._notifyAdded&&(t.data.removeNotify(t.notifyData,t),t._notifyAdded=!1),t.data=null),e._lazyData.remove(t)},notifyData:function(){e._lazyData.add(this)},onHierarchyVisible:function(){this._checkBind()},setData:function(){},clearData:function(){},send:function(){this.bindList.send.apply(this.bindList,arguments)},_clear:function(){e._lazyData.remove(this),this.clearData()},layout:function(){this.bindList&&this.bindList.callLayout()},resetDisplay:function(){this._super()}});e.BATCH_DATA_NUM=20,e._lazyData=new b8e.CallLater(function(t){return!(t.usable&&t.__isInit__&&t._hierarchyVisible&&t.data)||(t.setData(t.data),!1)},e,e.BATCH_DATA_NUM),b8e.RC("$$bui","$$ListItem",t)}(),function(){var t,e;e=bui.ListItem.extends({ctor:function(){this._super();var t=this._lab=bui.Label.get();t.fontAtlasName="listItem",this.addChild(t),this.setSize(400,40)},setData:function(t){this._lab.setText(t.text)},clearData:function(){this._lab.setText("")}});var i=t=b8e.Object.extends({text:"",ctor:function(){this._super()}});b8e.BindingUtil.bind(i),b8e.RC("$$bui","$$DefaultListItem",e),b8e.RC("$$bui","$$DefaultListItemData",t)}(),function(){var t,c=t=bui.ScrollView.extends({ctor:function(){var t=this;t._super(),t._renderMap=b8e.HashMap.get(),t._renderMap.safetyTraversal=!1,t._renderList=null,t._renderList1=b8e.LinkedList.get(),t._renderList1.safetyTraversal=!1,t._renderList2=b8e.LinkedList.get(),t._renderList2.safetyTraversal=!1,t._lastList=null,t._renderPool=b8e.HashMap.get(),t._renderPool.safetyTraversal=!1,t.autoRefresh=!0,t.spliceRefresh=!1,t.usableViewTest=!0,t.resetContainer=!0,t.cacheData=!1,t._container=new bui.LayoutContainer,t.setContent(t._container),t.setVertical(!0),t.setHorizontal(!1)},dispose:function(){this._container&&(this._container.release(),this._container=null),this._super()},refreshLen:{set:function(t){this._refreshLen=t,this._refreshEndIndex=t}},setLayoutType:function(t){this._container.setLayoutType(t)},clear:function(){var t=this;b8e.Tween.kill(t),t._lastList=null,t._renderList&&(t._renderList.forEach(t._clearRender,t),t._renderList=null),t._renderList1.clear(),t._renderList2.clear(),t._renderMap.forEach(function(t){t.length=0},t),t._renderMap.clear(),t._container.setSize(0,0),t._container&&t._container.removeAllChildren(),t.setScrollLeft(0),t.setScrollTop(0)},layout:{get:function(){return this._container?this._container.layout:null},set:function(t){this._container&&(this._container.layout=t)}},getLayoutContent:function(){if(this._layoutContent)return this._layoutContent;var t=this.getChildren();return t?t.values():null},itemRender:{set:function(t){if(t)if(this._renderClsArr)b8e.error(2057);else{t instanceof Array?this._renderClsArr=t:this._renderClsArr=[t];for(var e=this._renderClsArr.length,i=0;i<e;i++)this._renderPool.set(i,[])}else b8e.error(2056)}},setData:function(t){var e=this;!e._renderClsArr||e._renderClsArr.length<1?b8e.error(2058):(e._datas=t,b8e.Tween.kill(e),e._updateData())},_updateData:function(){var e=this;e._lastList=null;var i=e._renderList;(i=i&&(e._lastList=i)===e._renderList1?e._renderList=e._renderList2:e._renderList=e._renderList1).clear();var n=void 0,o=[],s=0,t=e._container;if(e._datas)if(e._datas.__LinkedList)0<e._datas.count()&&(e._datas.forEach(function(t){t.__binding__?(n=e._getRender(t),i.append(n),n.__renderIdx=s,s++,o[o.length]=n):b8e.error(2060)},e),t.applyLayout(e,o));else if(0<e._datas.length){for(var r=void 0,a=e._datas.length,l=0;l<a;l++)(r=e._datas[l])?r.__binding__?(n=e._getRender(r),i.append(n),n.__renderIdx=s,s++,o[o.length]=n):b8e.error(2060):b8e.warn(2059);t.applyLayout(e,o)}var _=e.getMaxScrollLeft();e.scrollLeft>_&&e.setScrollLeft(_);var c=e.getMaxScrollTop();e.scrollTop>c&&e.setScrollTop(c),e._onViewTest();var h=e._lastList;if(h){for(;0<h.count();){var u=h.shift();e._putRender(u)}e._lastList=h=null}},callLayout:function(){this._callLayout()},_callLayout:function(){var e=this,t=e._datas;if(t){var i=[],n=void 0;if(t.__LinkedList)t.forEach(function(t){(n=e._renderMap.get(t,e))&&(i=i.concat(n))},e);else for(var o=void 0,s=0;s<t.length;s++)o=t[s],(n=e._renderMap.get(o,e))&&(i=i.concat(n));0<i.length&&(i.sort(r),this._container.applyLayout(e,i),this._onViewTest())}},_onScroll:function(){this._super(),this._onScrollList()},_onScrollList:function(){this._onViewTest()},_onViewTest:function(){var t=this;t.usableViewTest&&t._renderList&&t._renderList.forEach(t._renderTest,t)},_renderTest:function(t){var e,i,n=this,o=n.width,s=n.height,r=n._container.x,a=n._container.y,l=o*c.drawOtherCount,_=s*c.drawOtherCount;e=t.x+t.width+r,i=t.y-t.height+a,-1*l<e&&e<=o+l&&i<_&&-1*(s+_)<=i?t.parent||n._container.addChild(t):t.parent&&t.removeFromParent()},_reshowList:function(){this.resetContainer&&this._scroll(0,0),this.setData(this._datas)},_onScrollFinished:function(){this._super(),this._onViewTest()},getListAreaInfo:function(){var t=this;if(!t._container)return null;var e=[],i=[],n=[],o=void 0,s=t.width,r=(t.height,t._container.x);t._container.y;return t._renderList&&t._renderList.forEach(function(t){(o=t.x+(t.width>>1))+r<0?e[e.length]=t.data:s<o+r?n[n.length]=t.data:i[i.length]=t.data},t),{left:e,curr:i,right:n}},_putRender:function(t,e){var i=this;if(e||!i._renderList.has(t,i)){var n=t.__renderType,o=this._renderPool.get(n);o||(o=[],this._renderPool.set(n,o));var s=t.data,r=i._renderMap.get(s,i);if(r){var a=r.indexOf(t);-1<a&&(r.splice(a,1),r.length<1&&i._renderMap.del(s,i))}t._unbind(),t.parent&&t.removeFromParent(),t._clear(),o[o.length]=t}},_clearRender:function(t){this._putRender(t,!0)},_getRender:function(t){var e=this,i=e._renderMap,n=t.__renderType?t.__renderType:0,o=void 0,s=i.get(t,e);if(s){for(var r=s.length,a=0;a<r;a++)if(o=s[a],!e._renderList.has(o,e)&&o.__renderType===n)return e._lastList&&e._lastList.remove(o),o}else s=[],i.set(t,s,e);var l=e._renderPool.get(n);if(l&&0<l.length)o=l.pop();else{var _=n,c=e._renderClsArr[_];if(!c)return b8e.error(2062,_),null;o=new c}return o.bindList=e,o.__renderType=n,o._bind(t),s[s.length]=o},send:function(){this.bindEnum?b8e.module.sendToControl(this.bindEnum,arguments):b8e.error(2063)},getItemRender:function(t){var e=this._renderMap.get(t,this);return e?e[0]:null}}),r=function(t,e){return t.__renderIdx-e.__renderIdx};c.drawOtherCount=1,b8e.RC("$$bui","$$ScrollList",t)}(),function(){var t,e=t=b8e.BaseDisplay.extends({__RichText:!0,ctor:function(){var t=this;t.constructor===e&&(e.poolCall||b8e.warn(3131)),t._super(),t._isDirty=!1,t.resetRichText(),t._addSizeChangedEvent(),t._addAnchorChangedEvent()},_createNode:function(){return b8e.createNode()},onHierarchyVisible:function(){this._super()},setColor:function(t){t!==this._color&&(this._color=t,this._richText.textColor=16777215&t)},string:{set:function(t){t+="";var e=this;e._text!==t&&(e._text=t,e._richText&&(e._richText.string=e._text),e._updateLayout())},get:function(){return this._text}},setText:function(t){this.string=t},fontSize:{set:function(t){this.setFontSize(t)},get:function(){return this._fontSize}},setFontSize:function(t){this._fontSize!=t&&(this._fontSize=t,this._richText&&(this._richText.fontSize=t))},lineHeight:{set:function(t){this.setLineHeight(t)},get:function(){return this._lineHeight}},setLineHeight:function(t){this._lineHeight!=t&&(this._lineHeight=t,this._richText&&(this._richText.lineHeight=t))},setCacheMode:function(t){if(!b8e.isCocos190){var e=this._richText;e&&(e.cacheMode=t)}},setFontAtlasName:function(t){this._fontAtlasName!=t&&(this._fontAtlasName=t)},getTextWidth:function(){return this.getWidth()},getTextHeight:function(){return this.getHeight()},horizontalAlign:{set:function(t){this.setHorizontalAlign(t)},get:function(){return this._horizontalAlign}},setHorizontalAlign:function(t){var e=this;e._horizontalAlign!=t&&(e._horizontalAlign=t,e._richText&&(e._richText.horizontalAlign=t,e._updateLayout()))},setImageAtlas:function(t){var e=this;e._atlasUrl&&(b8e.res.unloadRes(e._atlasUrl,e.onAtlasComplete,e),e._atlasUrl=null),e._richText&&(e._richText.imageAtlas=t)},handleTouchEvent:{set:function(t){this._richText&&(this._richText.handleTouchEvent=t)},get:function(){return this._richText.handleTouchEvent}},setTouchable:function(t){this.handleTouchEvent=t},loadImageAtlas:function(t){var e=this;e._atlasUrl&&(b8e.res.unloadRes(e._atlasUrl,e.onAtlasComplete,e),e._atlasUrl=null),e._atlasUrl=t;var i=void 0;if(b8e.tbBundle){var n=t.indexOf("ui/");if(-1<n){var o=t.substring(n+3,t.indexOf(".btf"));i=b8e.tbBundle[o]}}b8e.res.loadRes(e._atlasUrl,b8e.FrameAtlas,e.onAtlasComplete,e,null,{useManifest:!1,rawData:i})},onAtlasComplete:function(t,e){e&&this._richText&&(this._richText.imageAtlas=e.getAtlas())},addLinkHandler:function(t,e){var i=e[t];i?(this._onLinkByName||(this._onLinkByName={}),this._onLinkByName[t]=!0,this._richText[t]=function(t){i.apply(e,t)}):b8e.error(2053,t)},removeLinkHandler:function(t){this._onLinkByName&&(delete this._richText[t],delete this._onLinkByName[t])},resetRichText:function(){var t=this;if(t._onLinkByName){var e=t._richText;for(var i in t._onLinkByName)delete e[i];t._onLinkByName=null}t.setCacheMode(b8e.macro.DEFAULT_CACHE_MODE),t.setTouchable(!1),t.setImageAtlas(null),t.setFontSize(24),t.setLineHeight(28),t.setHorizontalAlign(b8e.HorizontalAlign.LEFT),t.setText(""),t.setFontAtlasName("default"),t.setColorTransfrom(null)},_onSizeChanged:function(){this._super(),this._updateLayout()},setColorTransfrom:function(t){b8e.isCocos190||this._richText.setColorTransfrom(t)},_updateLayout:function(){},deserailization:function(t,e){var i=this;i._super(t);var n=e.fontSize;i.setFontSize(n);var o=e.lineHeight;i.setLineHeight(o);var s=e.maxWidth;i._richText&&(i._richText.maxWidth=s);var r=e.horizontalAlign;i.setHorizontalAlign(r);var a=e.touchable;i.setTouchable(a);var l=e.imageAtlas;l&&i.loadImageAtlas(b8e.ResMgr.UI_ROOT+"/"+l);var _=i.getDefaultText(e);i.setText(_)},getDefaultText:function(t){return t.text},recycle:function(){this.resetRichText(),this._super()},release:function(){this.constructor===e?e.put(this):this.destroy()},dispose:function(){var t=this;t._richText&&(t._node.removeComponent(t._richText),t._richText=null),t._super()},destroy:function(){this.constructor===e&&(e.poolCall||b8e.warn(3132)),this._super()}}),i=new b8e.Pool(e,4096);e.get=function(){return i.get()},e.put=function(t){return i.put(t)},b8e.RC("$$bui","$$RichText",t)}(),function(){var t,o=t=b8e.BaseDisplay.extends({onResponseList:null,ctor:function(){var t=this;t._super();t._bg=bui.Graphics.get(),t.addChild(t._bg),t.panel=b8e.BaseDisplay.get(),t.panel.setSize(400,300),t.addChild(t.panel),t._titleBg=bui.Graphics.get(),t.panel.addChild(t._titleBg),t._titleBg.clear(),t._titleBg.setSize(400,50),t._titleBg.fillColor(4278190250),t._titleBg.fillRect(0,0,t._titleBg.width,t._titleBg.height),t._titleBg.setPosition(0,300-t._titleBg.height),t._titleTx=bui.Label.get(),t._titleTx.fontAtlasName="alert",t.panel.addChild(t._titleTx),t._titleTx.setFontSize(32),t._titleTx.setLineHeight(34),t._titleTx.setColor(4294967295),t._titleTx.setFontFamily("Microsoft YaHei"),t._titleTx.setText("\u63d0  \u793a"),t._titleTx.setPosition(t._titleBg.width-t._titleTx.width>>1,t._titleBg.y+(t._titleBg.height-t._titleTx.height>>1)-2),t._msgBg=bui.Graphics.get(),t.panel.addChild(t._msgBg),t._msgBg.clear(),t._msgBg.setSize(400,300-t._titleBg.height),t._msgBg.fillColor(4284900966),t._msgBg.fillRect(0,0,t._msgBg.width,t._msgBg.height),t._msgBg.setPosition(0,0),t._tx=bui.Label.get(),t._tx.fontAtlasName="alert",t.panel.addChild(t._tx),b8e.evt.addG(t,b8e.Event.STAGE_RESIZE,t.onResize),b8e.evt.onC(t._bg,t.onClick,t)},onClick:function(){this.hide();var t=this.onResponseList;if(t){for(var e={response:0},i=t.length,n=0;n<i;n++){(0,t[n])(e)}t.length=0}},show:function(t,e){var i=e&&e.color,n=e&&e.onResponse;void 0===i&&(i=4294967295);var o=this;if(n){var s=o.onResponseList;(s=s||(o.onResponseList=[]))[s.length]=n}o.setLocalZOrder(31e3),b8e.root.addChild(o),o._tx.setFontSize(32),o._tx.setLineHeight(34),o._tx.setColor(i),o._tx.setFontFamily("Microsoft YaHei"),o._tx.setOverflow(b8e.OverflowType.RESIZE_HEIGHT),o._tx.setHorizontalAlign(b8e.HorizontalAlign.CENTER);var r=o._msgBg.width,a=o._msgBg.height;o._tx.setSize(r-100,a-20),o._tx.setText(t),o._tx.setPosition(o._msgBg.width-o._tx.width>>1,o._msgBg.height-o._tx.height>>1),o.onResize()},onResize:function(){var t=this;t.setSize(b8e.stageWidth,b8e.stageHeight),t.panel.setPosition(b8e.stageWidth-t.panel.width>>1,b8e.stageHeight-t.panel.height>>1),t._bg.clear(),t._bg.setSize(b8e.stageWidth,b8e.stageHeight),t._bg.fillColor(2566914048),t._bg.fillRect(0,0,t._bg.width,t._bg.height)},hide:function(){this._tx.setText(""),this.removeFromParent()}}),s={};bui.alert=function(t,e){var i=e&&e.groupName||"default",n=s[i];n||((n=s[i]=new o).groupName=i),n.show(t,e)},b8e.RC("$$bui","$$Alert",t)}(),function(){var I=null,R=null,D=null;if(!b8e.isCocos190){var t=cc.vmath;I=t.mat4.create(),R=t.mat4.create(),D=cc.v3()}var P={zoomInvalid:!1};function o(t,e,i){var n=!1,o=!1,s=e.__eventListeners=e.__eventListeners||{};s.compositionstart=function(){n=!0},t.addEventListener("compositionstart",s.compositionstart),s.compositionend=function(){n=!1,o&&(this.value=e._text,o=!1),r(this,e)},t.addEventListener("compositionend",s.compositionend),s.input=function(){n||r(this,e)},t.addEventListener("input",s.input),s.focus=function(){this.style.fontSize=e._edFontSize+"px",this.style.color=e._node.color.toCSS("rgba"),e._alwaysOnTop&&(e._editing=!0),e._beginEditingOnMobile(),e._delegate&&(e._delegate._hideLabels(),e._delegate.editBoxEditingDidBegan&&e._delegate.editBoxEditingDidBegan())},t.addEventListener("focus",s.focus),s.keypress=function(t){t.keyCode===b8e.KEY.enter&&(t.stopPropagation(),e._delegate&&e._delegate.editBoxEditingReturn&&e._delegate.editBoxEditingReturn(),i||(e._text=this.value,e._endEditing(),cc.game.canvas.focus()))},t.addEventListener("keypress",s.keypress),s.blur=function(){n?o=!0:e._text=this.value,e._endEditing()},t.addEventListener("blur",s.blur)}function r(t,e){t.value.length>e._maxLength&&(t.value=t.value.slice(0,e._maxLength)),e._delegate&&e._delegate.editBoxTextChanged&&e._text!==t.value&&(e._text=t.value,e._delegate.editBoxTextChanged(e._text))}cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(P.zoomInvalid=!0),b8e.EditBoxUtil={LEFT_PADDING:2,DELAY_TIME:400,FOCUS_DELAY_UC:400,FOCUS_DELAY_FIREFOX:0,createDomInput:function(t,e){var i=document.createElement("input");i.type="text";var n=i.style;return n.fontSize=e+"px",n.color="#000000",n.border=0,n.background="transparent",n.width="100%",n.height="100%",n.active=0,n.outline="medium",n.padding="0",n.textTransform="uppercase",n.display="none",n.position="absolute",n.bottom="0px",n.left=this.LEFT_PADDING+"px",n["-moz-appearance"]="textfield",n.fontFamily=b8e.macro.DEFAULT_FONT_FAMILY||"Arial",n.className="b8eEditTxt",o(i,t),t._addDomToGameContainer(i),i},createDomTextArea:function(t,e){var i=document.createElement("textarea"),n=i.style;return n.fontSize=e+"px",n.color="#000000",n.border=0,n.background="transparent",n.width="100%",n.height="100%",n.active=0,n.outline="medium",n.padding="0",n.resize="none",n.textTransform="uppercase",n.overflow_y="scroll",n.display="none",n.position="absolute",n.bottom="0px",n.left=this.LEFT_PADDING+"px",n.fontFamily=b8e.macro.DEFAULT_FONT_FAMILY||"Arial",n.className="b8eEditTxt",o(i,t,!0),t._addDomToGameContainer(i),i},removeDomText:function(t,e){var i=t.__eventListeners;i&&(e.removeEventListener("compositionstart",i.compositionstart),e.removeEventListener("compositionend",i.compositionend),e.removeEventListener("input",i.input),e.removeEventListener("focus",i.focus),e.removeEventListener("keypress",i.keypress),e.removeEventListener("blur",i.blur),i.compositionstart=null,i.compositionend=null,i.input=null,i.focus=null,i.keypress=null,i.blur=null,i=t.__eventListeners=void 0),e.parentNode&&e.parentNode.removeChild(e)},updateMatrix:function(t,e){if(b8e.isCocos190){var i=t._node,n=cc.view._scaleX,o=cc.view._scaleY,s=cc.view._devicePixelRatio,r=t._worldTransform,a=cc.view._viewPortRect;n/=s,o/=s;var l=cc.game.container,_=r.a*n,c=r.b,h=r.c,u=r.d*o,d=parseInt(l&&l.style.paddingLeft||0),f=parseInt(l&&l.style.paddingBottom||0);d+=a.x/s,f+=a.y/s;var p=r.tx*n+d,g=r.ty*o+f;P.zoomInvalid&&(t.updateSize(i._contentSize.width*_,i._contentSize.height*u),u=_=1);var v="matrix("+_+","+-c+","+-h+","+u+","+p+","+-g+")";t._edTxt.style.transform=v,t._edTxt.style["-webkit-transform"]=v,t._edTxt.style["transform-origin"]="0px 100% 0px",t._edTxt.style["-webkit-transform-origin"]="0px 100% 0px"}else{e.getWorldMatrix(I);var b=cc.view._scaleX,y=cc.view._scaleY,m=cc.view._viewportRect,T=cc.view._devicePixelRatio,L=cc.game.container,C=parseInt(L&&L.style.left||0);C+=m.x/T;var S=parseInt(L&&L.style.bottom||0);if(S+=m.y/T,t._offsetX===C&&t._offsetY===S&&t._m00===I.m00&&t._m01===I.m01&&t._m04===I.m04&&t._m05===I.m05&&t._m12===I.m12&&t._m13===I.m13&&t._viewX===m.x&&t._viewY===m.y&&t._viewScaleX===b&&t._viewScaleY===y&&t._w===e._contentSize.width&&t._h===e._contentSize.height)return;t._m00=I.m00,t._m01=I.m01,t._m04=I.m04,t._m05=I.m05,t._m12=I.m12,t._m13=I.m13,t._w=e._contentSize.width,t._h=e._contentSize.height,t._viewX=m.x,t._viewY=m.y,t._viewScaleX=b,t._viewScaleY=y,D.x=-e._anchorPoint.x*t._w,D.y=-e._anchorPoint.y*t._h,cc.vmath.mat4.translate(I,I,D),cc.Camera.findCamera(e).getWorldToCameraMatrix(R),cc.vmath.mat4.mul(R,R,I),b/=T,y/=T;var x=R.m00*b,w=R.m01,A=R.m04,E=R.m05*y,B=R.m12*b+C,M=R.m13*y+S;P.zoomInvalid&&(t._updateSize(t._size.width*x,t._size.height*E),E=x=1);var z="matrix("+x+","+-w+","+-A+","+E+","+B+","+-M+")";t._edTxt.style.transform=z,t._edTxt.style["-webkit-transform"]=z,t._edTxt.style["transform-origin"]="0px 100% 0px",t._edTxt.style["-webkit-transform-origin"]="0px 100% 0px",t._offsetX=C,t._offsetY=S}},_beginEditing:function(t){if(cc.sys.platform===cc.sys.WECHAT_GAME)t._edTxt.focus();else if(!t._alwaysOnTop&&"none"===t._edTxt.style.display){var e=function(){t._edTxt.focus()};t._edTxt.style.display="block",cc.sys.browserType===cc.sys.BROWSER_TYPE_UC?setTimeout(e,b8e.EditBoxUtil.FOCUS_DELAY_UC):cc.sys.browserType===cc.sys.BROWSER_TYPE_FIREFOX?setTimeout(e,b8e.EditBoxUtil.FOCUS_DELAY_FIREFOX):e()}},_endEditing:function(t){!t._alwaysOnTop&&t._edTxt&&(t._edTxt.style.display="none",t._showLabels())}}}(),function(){var t=void 0;(t=bui.Widget.extends({ctor:function(){this._layout=new b8e.Layout,this._super(),this.needActiveInHierarchyEvent=!0},dispose:function(){var t=this;t._layout&&(t._notifyAdded&&(t._layout.removeNotify(t.updateLayout,t),t._notifyAdded=!1),t._layout=null)},_checkBind:function(){var t=this;t._layout&&(t._hierarchyVisible?t._notifyAdded||(t._layout.addNotify(t.updateLayout,t),t._notifyAdded=!0):t._notifyAdded&&(t._layout.removeNotify(t.updateLayout,t),t._notifyAdded=!1))},onHierarchyVisible:function(){this._checkBind()},layout:{set:function(t){this._layout.setLayout(t),this.setAnchor(0,1),this.updateLayout()},get:function(){return this._layout}},updateLayout:function(t){void 0===t&&(t=0);b8e.LayoutUtil.layout(this,t)},setLayoutContent:function(t){this._layoutContent=t,this.updateLayout()},getLayoutContent:function(){if(this._layoutContent)return this._layoutContent;var t=this.getChildren();return t?t.values():null}})).poolCall=!0,b8e.RC("$$b8e","$$LayoutContainer",t)}(),function(){var o,s=void 0;o=b8e.Enum({None:0,Horizontal:1,Vertical:2}),s=bui.Widget.extends({ctor:function(){this._super(),this._inertia=!0,this.setAnchor(0,1),this.setMask(cc.Mask.Type.RECT),this.initContainer();var t=b8e.stage.width;this.moveThreshold=(t<<1)/960,this.touchMovable=!0},dispose:function(){this._container&&(this._container.dispose(),this._container=null)},initContainer:function(){},addListener:function(){var t=this;b8e.evt.onTouchStart(t,t._onTouchBegan,t,0,!0),b8e.evt.onTouchEnd(t,t._onTouchEnd,t,0,!0),b8e.evt.onTouchCancel(t,t._onTouchCancelled,t,0,!0),b8e.evt.onTouchMove(t,t._onTouchMove,t,0,!0),b8e.evt.onMouseWheel(t,t._onMouseWheel,t,0,!0),t._startTouch=!1,t._touchMoved=!1},removeListener:function(){var t=this;b8e.evt.offTouchStart(t,t._onTouchBegan,t),b8e.evt.offTouchEnd(t,t._onTouchEnd,t),b8e.evt.offTouchCancel(t,t._onTouchCancelled,t),b8e.evt.offTouchMove(t,t._onTouchMove,t),b8e.evt.offMouseWheel(t,t._onMouseWheel,t),t._startTouch=!1,t._touchMoved=!1},show:function(){this.setSize(this.parent.width,this.parent.height),this.addListener()},hide:function(){},setContainerSize:function(t,e){this._container&&this._container.setSize(t,e)},setScrollType:function(t){this._scrollType=t,this._container&&this.autoScrollContainer()},getScrollType:function(){return this._scrollType},_onMouseWheel:function(t){this.touchMovable&&this._container&&this._scrollType!==o.Horizontal&&this._setMouseRect()&&(this._touchMoved=!0,this.nextPosY=this._container.y+.3*t.getScrollY(),this._scroll(this._container.x,this.nextPosY,300))},_onTouchBegan:function(t){var e=t.target,i=t.touch.getLocation();e.hitTest(i)&&(this._startTouch||this._setMouseRect()&&(this._startTouch=!0,b8e.Tween.kill(this._container),this._lastPos=this._startPos=i,this.onScrollBegin(),this._stopPropagationIfTargetIsMe(t)))},nextPosX:0,nextPosY:0,offsetX:0,offsetY:0,location:null,moveThreshold:3,_onTouchMove:function(t){if(this.touchMovable){var e=t.touch.getLocation();if(this._container&&this._lastPos&&(this.location=e,this.offsetX=this.location.x-this._lastPos.x,this.offsetY=this.location.y-this._lastPos.y,!(Math.abs(this.offsetX)<this.moveThreshold||Math.abs(this.offsetY)<this.moveThreshold)||this._touchMoved)){switch(this._scrollType){case o.None:this.nextPosX=this._container.x+this.offsetX,this.nextPosY=this._container.y+this.offsetY;break;case o.Horizontal:this.nextPosX=this._container.x+this.offsetX,this.nextPosY=this._container.y;break;case o.Vertical:this.nextPosX=this._container.x,this.nextPosY=this._container.y+this.offsetY;break;default:b8e.error(2054)}this._scroll(this.nextPosX,this.nextPosY),this._lastPos=this.location,this._endPos=this.location,this._touchMoved=!0,this._stopPropagationIfTargetIsMe(t)}}},_onTouchCancelled:function(t){this._lastPos=null,this._stopPropagationIfTargetIsMe(t),this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1,this._scrollEnd())},_onTouchEnd:function(t){var e=t.target,i=t.touch.getLocation();e.hitTest(i)&&(this._lastPos=null,this._touchMoved?t.stopPropagation():this._stopPropagationIfTargetIsMe(t),this._startTouch=!1,this._touchMoved&&(this._touchMoved=!1,this._scrollEnd()))},_stopPropagationIfTargetIsMe:function(t){t.target===this.parent&&t.stopPropagation()},scrollToTop:function(t,e){if(this._scrollType!=s.Horizontal&&this._container){void 0===t&&(t=0),void 0===e&&(e=0),this._setMouseRect();var i=this._container.x,n=this._mouseBottom-t;this._scroll(i,n,e)}},scrollToBottom:function(t,e){if(this._scrollType!=o.Horizontal&&this._container){void 0===t&&(t=0),void 0===e&&(e=0),this._setMouseRect();var i=this._container.x,n=this._mouseTop+t;this._scroll(i,n,e)}},scrollToRight:function(t,e){if(this._scrollType!=o.Vertical&&this._container){void 0===e&&(e=0),this._setMouseRect();var i=-t,n=this._container.y;this._scroll(i,n,e)}},scrollToLeft:function(t,e){if(this._scrollType!=o.Vertical&&this._container){void 0===e&&(e=0),this._setMouseRect();var i=this._mouseRight+t,n=this._container.y;this._scroll(i,n,e)}},scrollContainerLeft:function(t){if(this._scrollType!=o.Vertical&&this._container){void 0===t&&(t=200);var e=this._container.x+this.width+this.layout.spacingX;0<e&&(e=0),this.scrollToLeft(e,t)}},scrollContainerRight:function(t){if(this._scrollType!=o.Vertical&&this._container){void 0===t&&(t=200);var e=this._container.x-this.width-this.layout.spacingX;e<this._mouseLeft&&(e=this._mouseLeft),this.scrollToLeft(e,t)}},scrollContainerTop:function(t){var e=this;if(e._scrollType!=o.Horizontal&&e._container){void 0===t&&(t=200);var i=e._container.y-e.height+e.layout.spacingY;i<0&&(i=0),e._scroll(0,i,t)}},scrollContainerBottom:function(t){var e=this;if(e._scrollType!=o.Horizontal&&e._container){void 0===t&&(t=200);var i=e._container.y+e.height+e.layout.spacingY;i>e._mouseTop&&(i=e._mouseTop),e._scroll(0,i,t)}},scrollToPos:function(t,e){t&&(void 0===e&&(e=0),this._scroll(t.x,t.y,e))},_scroll:function(t,e,i){this._container&&(t===this._container.x&&e===this._container.y||(void 0===i&&(i=0),b8e.Tween.kill(this._container),0<i?b8e.Tween.get(this._container).to({x:t,y:e},i,b8e.Ease.quadOut).call(this._scrollEnd,this):(this._container.setPosition(t,e),this.onScrolling())))},_scrollEnd:function(){this._scrollReset(),this.onScrollEnd()},_scrollReset:function(t){if(this._container){void 0===t&&(t=200);var e=this._container.getPosition(),i=void 0,n=void 0,o=!1;i=0===this._mouseRight&&0===this._mouseLeft?0:e.x>=this._mouseRight?this._mouseRight:e.x<=this._mouseLeft?this._mouseLeft:e.x,0===this._mouseTop&&0===this._mouseBottom?n=0:e.y>=this._mouseTop?n=this._mouseTop:e.y<=this._mouseBottom?(n=this._mouseBottom,o=!0):n=e.y,this._scroll(i,n,t),o&&this.onScrollBottomReset()}},_setMouseRect:function(){if(!this._container)return!1;var t=this.width-this._container.width,e=this.height-this._container.height;if(this._mouseLeft=0,this._mouseRight=0,this._mouseTop=0,(this._mouseBottom=0)<=t&&0<=e)return!1;var i=this._container.width,n=this._container.height;switch(this._scrollType){case o.None:t<0&&(this._mouseLeft=this.width-i),e<0&&(this._mouseTop=this.height-n);break;case o.Horizontal:if(!(t<0))return!1;this._mouseLeft=this.width-i;break;case o.Vertical:if(!(e<0))return!1;this._mouseTop=n-this.height}return!0},autoScrollContainer:function(){this._setMouseRect(),this._scrollReset(0)},onScrollBegin:function(){},onScrolling:function(){},onScrollEnd:function(){},onScrollBottomReset:function(){},addBoxChild:function(t){this._container&&this._container.addChild(t)},removeBoxChild:function(t){this._container&&this._container.removeChild(t)},setContainer:function(t){var e=this;e._container&&(b8e.warn(3133),e._container.removeFromParent()),e._container=t,e.addChild(e._container),e.autoScrollContainer()},getContainer:function(){return this._container}}),b8e.RC("$$b8e","$$ScrollBoxType",o),b8e.RC("$$b8e","$$ScrollBox",s)}(),function(){var c=void 0;c=b8e.ScrollBox.extends({ctor:function(t,e){var i=this;void 0===t&&(t=b8e.ScrollBoxType.Vertical),void 0===e&&(e=b8e.LayoutType.Vertical),i._layoutType=e,i._scrollType=t,i._renderMap=b8e.HashMap.get(),i._renderMap.safetyTraversal=!1,i._renderList=null,i._renderList1=b8e.LinkedList.get(),i._renderList1.safetyTraversal=!1,i._renderList2=b8e.LinkedList.get(),i._renderList2.safetyTraversal=!1,i._lastList=null,i._renderPool=b8e.HashMap.get(),i._renderPool.safetyTraversal=!1,i.autoRefresh=!0,i.spliceRefresh=!1,i._lastContainerX=0,i._lastContainerY=0,i.usableViewTest=!0,i.resetContainer=!0,i.cacheData=!1,i._super(),b8e.evt.addListHandler(i)},dispose:function(){var t=this;b8e.evt.removeListHandler(t),t._container&&(t._container.release(),t._container=null),t._super()},refreshLen:{set:function(t){this._refreshLen=t,this._refreshEndIndex=t}},initContainer:function(){var t=this;switch(t._container=new b8e.LayoutContainer,t._layoutType){case b8e.LayoutType.Horizontal:t._container.layout=b8e.HorizontalLayout;break;case b8e.LayoutType.Vertical:t._container.layout=b8e.VerticalLayout;break;case b8e.LayoutType.Grid:t._container.layout=b8e.GridLayout;break;default:b8e.error(2055)}t.addChild(t._container)},show:function(){this._super(),this._container.setSize(this.width,this.height)},clear:function(){var t=this;b8e.Tween.kill(t),t._lastList=null,t._renderList&&(t._renderList.forEach(t._clearRender,t),t._renderList=null),t._renderList1.clear(),t._renderList2.clear(),t._renderMap.forEach(function(t){t.length=0},t),t._renderMap.clear()},container:{get:function(){return this._container}},layout:{get:function(){return this._container?this._container.layout:null},set:function(t){this._container&&(this._container.layout=t)}},getLayoutContent:function(){if(this._layoutContent)return this._layoutContent;var t=this.getChildren();return t?t.values():null},itemRender:{set:function(t){if(t)if(this._renderClsArr)b8e.error(2057);else{t instanceof Array?this._renderClsArr=t:this._renderClsArr=[t];for(var e=this._renderClsArr.length,i=0;i<e;i++)this._renderPool.set(i,[])}else b8e.error(2056)}},setData:function(t){this._datas=t,b8e.Tween.kill(this),this._updateData()},_updateData:function(){var e=this;e._lastList=null;var i=e._renderList;(i=i&&(e._lastList=i)===e._renderList1?e._renderList=e._renderList2:e._renderList=e._renderList1).clear();var n=void 0,o=[],s=0;e._container;if(e._datas)if(e._datas.__LinkedList)0<e._datas.count()&&(e._datas.forEach(function(t){t.__binding__?(n=e._getRender(t),i.append(n),n.__renderIdx=s,s++,o[o.length]=n):b8e.error(2060)},e),e._container.setLayoutContent(o),e.height>e._container.height&&(e._container.height=e.height),e.autoScrollContainer(),e.onScrollEnd());else if(0<e._datas.length){for(var t=void 0,r=e._datas.length,a=0;a<r;a++)(t=e._datas[a])?t.__binding__?(n=e._getRender(t),i.append(n),n.__renderIdx=s,s++,o[o.length]=n):b8e.error(2060):b8e.warn(2059);e._container.setLayoutContent(o),e.height>e._container.height&&(e._container.height=e.height),e.autoScrollContainer(),e.onScrollEnd()}var l=e._lastList;if(l){for(;0<l.count();){var _=l.shift();e._putRender(_)}e._lastList=l=null}},callLayout:function(){this._callLayout()},_callLayout:function(){var e=this,t=e._datas;if(t){var i=[],n=void 0;if(t.__LinkedList)t.forEach(function(t){(n=e._renderMap.get(t,e))&&(i=i.concat(n))},e);else for(var o=void 0,s=0;s<t.length;s++)o=t[s],(n=e._renderMap.get(o,e))&&(i=i.concat(n));0<i.length&&(i.sort(r),this._container.setLayoutContent(i),this._setViewTest())}},onScrolling:function(){var t=Math.abs(this._lastContainerX-this._container.x),e=Math.abs(this._lastContainerY-this._container.y);Math.sqrt(t*t+e*e);this._lastContainerX=this._container.x,this._lastContainerY=this._container.y,this._setViewTest()},_setViewTest:function(){var t=this;t.usableViewTest&&t._renderList&&t._renderList.forEach(t._viewTest,t)},_viewTest:function(t){var e,i,n=this,o=n.width,s=n.height,r=n._container.x,a=n._container.y,l=o*c.drawOtherCount,_=s*c.drawOtherCount;e=t.x+t.width+r,i=t.y+a,-1*l<e&&e<=o+l&&i<_+t.height&&-1*(s+_)<=i?t.parent||n._container.addChild(t):t.parent&&t.removeFromParent()},_reshowList:function(){this.resetContainer&&this._scroll(0,0),this.setData(this._datas)},setScrollViewCb:function(t,e){this._scrollType!=b8e.ScrollBox.Vertical&&this._container?this._scrollViewCb=t?{func:t,thisArg:e}:null:b8e.error(2061)},onScrollEnd:function(){var e=this;if(e._setViewTest(),e._scrollViewCb&&e._container){var i=[],n=[],o=[],s=void 0,r=void 0,a=e.width,l=e.height,_=e._container.x,c=e._container.y+e.height;e._renderList&&(e._scrollType==b8e.ScrollBoxType.Horizontal?e._renderList.forEach(function(t){(s=t.x+(t.width>>1))+_<0?i[i.length]=t.data:a<s+_?o[o.length]=t.data:n[n.length]=t.data},e):e._scrollType==b8e.ScrollBoxType.Vertical&&e._renderList.forEach(function(t){(r=t.y-t.height)+c<0&&!e._isViewingArea(t)?o[o.length]=t.data:l<r+c&&!e._isViewingArea(t)?i[i.length]=t.data:n[n.length]=t.data},e)),e._scrollViewCb.func.call(e._scrollViewCb.thisArg,i,n,o)}},_isViewingArea:function(t){var e=this._container.x,i=this._container.y,n=t.x+t.width+e,o=t.y+i;return!!(-1<n&&n<=this.width&&o<t.height&&o>=-1*this.height&&t.parent)},_putRender:function(t,e){var i=this;if(e||!i._renderList.has(t,i)){var n=t.__renderType,o=t.__renderClass,s=o||n,r=this._renderPool.get(s);r||(r=[],this._renderPool.set(s,r));var a=t.data,l=i._renderMap.get(a,i);if(l){var _=l.indexOf(t);-1<_&&(l.splice(_,1),l.length<1&&i._renderMap.del(a,i))}t._unbind(),t.parent&&t.removeFromParent(),t._clear(),r[r.length]=t}},_clearRender:function(t){this._putRender(t,!0)},_getRender:function(t){var e=this,i=e._renderMap,n=t.__renderType?t.__renderType:0,o=t.__renderClass,s=void 0,r=i.get(t,e);if(r){for(var a=r.length,l=0;l<a;l++)if(s=r[l],!e._renderList.has(s,e)&&(s.__renderClass===o||s.__renderType===n))return e._lastList&&e._lastList.remove(s),s}else r=[],i.set(t,r,e);var _=o||n,c=e._renderPool.get(_);if(c&&0<c.length)s=c.pop();else{var h=void 0;if(o){if(!(h=game[b8e.getNormP(o,!0)]))return b8e.error("game\u4e0b\u4e0d\u5b58\u5728",o),null}else{var u=n;if(!(h=e._renderClsArr[u]))return b8e.error(2062,u),null}s=new h}return s.bindList=e,s.__renderType=n,s.__renderClass=o,s._bind(t),r[r.length]=s},send:function(){this.bindEnum?b8e.module.sendToControl(this.bindEnum,arguments):b8e.error(2063)},getItemRender:function(t){var e=this._renderMap.get(t,this);return e?e[0]:null}});var r=function(t,e){return t.__renderIdx-e.__renderIdx};c.drawOtherCount=1,b8e.RC("$$b8e","$$ScrollList",c)}(),function(){var t,e=t=bui.SkinWidget.extends({ctor:function(t){this._super(t),this.needActiveInHierarchyEvent=!0},_checkBind:function(){var t=this;t.data&&(t.__isInit__&&t._hierarchyVisible?t._notifyAdded||(t.data.addNotify(t.notifyData,t),t._notifyAdded=!0):(e._lazyData.remove(t),t._notifyAdded&&(t.data.removeNotify(t.notifyData,t),t._notifyAdded=!1)))},loadComplete:function(){this._checkBind()},_bind:function(t){this.data||(this.data=t,this._checkBind())},_unbind:function(){var t=this;t.data&&(t._notifyAdded&&(t.data.removeNotify(t.notifyData,t),t._notifyAdded=!1),t.data=null),e._lazyData.remove(t)},notifyData:function(){e._lazyData.add(this)},onHierarchyVisible:function(){this._checkBind()},setData:function(){},clearData:function(){},send:function(){this.bindList.send.apply(this.bindList,arguments)},_clear:function(){e._lazyData.remove(this),this.clearData()},layout:function(){this.bindList&&this.bindList.callLayout()},resetDisplay:function(){this._super()}});e.BATCH_DATA_NUM=20,e._lazyData=new b8e.CallLater(function(t){return!(t.usable&&t.__isInit__&&t._hierarchyVisible&&t.data)||(t.setData(t.data),!1)},e,e.BATCH_DATA_NUM),b8e.RC("$$b8e","$$ListItem",t)}(),function(){b8e.GUI_VERSION="4.1.5";var t=b8e.EngineGui={};b8e.SHC(t);var e=t.onInit=function(){b8e.GUI_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aGui\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nCore:V"+b8e.GUI_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(e),b8e.onInit(e,t)}()},{}]},{},[1]);(function(){return function s(a,r,l){function h(e,t){if(!r[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(d)return d(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=r[e]={exports:{}};a[e][0].call(o.exports,function(t){return h(a[e][1][t]||t)},o,o.exports,s,a,r,l)}return r[e].exports}for(var d="function"==typeof require&&require,t=0;t<l.length;t++)h(l[t]);return h}})()({1:[function(t,e,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){b8e.initRender=function(){("undefined"==typeof wxDownloader?"undefined":o(wxDownloader))!==b8e.TypeUndefined&&(cc.view._maxPixelRatio=3,wxDownloader.REMOTE_SERVER_ROOT=b8e.params.remoteServerRoot,wxDownloader.SUBCONTEXT_ROOT=b8e.params.subcontextRoot,cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT_GAME_SUB&&cc.director.once(cc.Director.EVENT_BEFORE_SCENE_LOADING,function(){cc.Pipeline.Downloader.PackDownloader._doPreload("WECHAT_SUBDOMAIN",settings.WECHAT_SUBDOMAIN_DATA)})),cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT&&window.frameElement&&(window.frameElement.style.position="absolute")},b8e.getDrawCalls=function(){return b8e.renderer.drawCalls};b8e.ttfUpdateRenderData=function(t,e){e.node&&(t._updateFontFamily(e),t._updateProperties(e),t._calculateLabelFont(),t._calculateSplitedStrings(),t._updateLabelDimensions(),t._calculateTextBaseline(),t._updateTexture(e),t._calDynamicAtlas(e))};var n=void 0;b8e._updateLabelRenderData=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];!t._material||e||i?b8e._onUpdateLabelRenderData(t,e):(n=n||new b8e.CallLater(function(t){return b8e._onUpdateLabelRenderData(t,!0),!1},null,1),b8e.SHC(t),n.add(t))},b8e._labelDestroy=function(t){t._fontAtlasName=void 0,t.font=null;var e=t._underlineGraphics;e&&(e.setParent(null),e.destroy(),e=t._underlineGraphics=void 0)},b8e._onUpdateLabelRenderData=function(t,e){if(t.enabled){var i=t._renderData;if(i&&(i.vertDirty=!0,i.uvDirty=!0,t.markForUpdateRenderData(!0)),e)if(t._updateAssembler(),t._applyFontTexture(e),t._isUnderline){var n=t._underlineGraphics;n||((n=t._underlineGraphics=new cc.Node).setAnchorPoint(0,0),n.addComponent(cc.Graphics),n.setParent(t.node));var o=t.node,s=n.getComponent(cc.Graphics);s.clear(),s.lineWidth=t._fontSize/10,s.strokeColor=t.node.color,s.moveTo(0,0),s.lineTo(o.width,0),s.stroke()}else{var a=t._underlineGraphics;a&&(a.setParent(null),a.destroy(),a=t._underlineGraphics=void 0)}}};var e=void 0;b8e._updateRichText=function(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1]?b8e._onUpdateRichText(t):(e||((e=new b8e.CallLater(function(t){return b8e._onUpdateRichText(t),!1},null,1)).localHashable=!0,e.polyfillHash=!0),e.add(t))};b8e._onUpdateRichText=function(t){if(t.enabled){var e=b8e._htmlTextParser,i=(e=e||(b8e._htmlTextParser=new cc.HtmlTextParser)).parse(t.string);t._textArray=i,t._resetState();for(var n=!1,o=void 0,s=i.length,a=0;a<s;++a){var r=i[a],l=r.text;if(""===l){if(r.style&&r.style.newline){t._updateLineInfo();continue}if(r.style&&r.style.isImage&&t.imageAtlas){t._addRichTextImageElement(r);continue}}for(var h=l.split("\n"),d=0;d<h.length;++d){var c=h[d];if(""!==c)if(n=!1,0<t.maxWidth){var _=t._measureText(a,c);t._updateRichTextWithMaxWidth(c,_,a),1<h.length&&d<h.length-1&&t._updateLineInfo()}else o=t._addLabelSegment(c,a).getContentSize(),t._lineOffsetX+=o.width,t._lineOffsetX>t._labelWidth&&(t._labelWidth=t._lineOffsetX),1<h.length&&d<h.length-1&&t._updateLineInfo();else{if(t._isLastComponentCR(l)&&d===h.length-1)continue;t._updateLineInfo(),n=!0}}}n||t._linesWidth.push(t._lineOffsetX),0<t.maxWidth&&(t._labelWidth=t.maxWidth),t._labelHeight=t._lineCount*t.lineHeight,t.node.setContentSize(t._labelWidth,t._labelHeight),t._updateRichTextPosition(),t._layoutDirty=!1}},b8e._applyTextAttribute=function(t,e){}})(),b8e.BaseDisplay.implements({_setRotation:function(t){var e=this._node;b8e.isCocos190?e.rotation=t:e.angle=360-t}}),function(){var i=bui.SizeMode,n=void 0;i.toCC=function(t){if(!n){n={};var e=cc.Sprite.SizeMode;n[i.CUSTOM]=e.CUSTOM,n[i.RAW]=e.RAW,n[i.TRIMMED]=e.TRIMMED}return n[t]}}(),function(){var i=bui.SpriteStyle,n=void 0;i.toCC=function(t){if(!n){n={};var e=cc.Sprite.Type;n[i.SIMPLE]=e.SIMPLE,n[i.SLICED]=e.SLICED,n[i.TILED]=e.TILED,n[i.FILLED]=e.FILLED}return n[t]}}(),bui.Sprite.implements({_createNode:function(){var t=new b8e.createNode,e=t.addComponent(cc.Sprite);return this._sprite=e,b8e.isCocos190&&"function"==typeof e.__preload&&e.__preload(),t},setFrame:function(t){var e=this;if(e._sprite){var i=null;if(t){if(t.__SpriteFrame){if(i=t.getFrame(),e.spriteFrame==i)return}else if(t instanceof cc.SpriteFrame&&(i=t,e.spriteFrame==i))return}else if(i=null,e.spriteFrame==i)return;e.spriteFrame=i,e._dynamicAtlas&&i&&cc.dynamicAtlasManager.insertSpriteFrame(i),e._frame=t}},setSizeMode:function(t){this._sizeMode!=t&&(this._sizeMode=t,this._sprite.sizeMode=bui.SizeMode.toCC(t))},setStyle:function(t){if(this._style!=t){this._style=t;var e=bui.SpriteStyle.toCC(t);this._sprite.type=e}}}),bui.Label.implements({_createNode:function(){var t=b8e.createNode(),e=t.addComponent(cc.Label);return this._label=e,b8e.SHC(e),e._fontAtlasName="default",b8e.isCocos190&&"function"==typeof e.__preload&&e.__preload(),t},_updateTextSize:function(){},setColor:function(t){t=(4278190080|16777215&t)>>>0,this._super(t)},setHorizontalAlign:function(t){var e=this;if(e._horizontalAlign!=t){e._horizontalAlign=t,e._overflow==b8e.OverflowType.NONE&&t!=b8e.HorizontalAlign.LEFT&&b8e.warn(5001);var i=e._label;i&&(i.horizontalAlign=b8e.HorizontalAlign.toCC(t)),e._isDirty=!0}},setVerticalAlign:function(t){var e=this;e._verticalAlign!=t&&(e._verticalAlign=t,e._label&&(e._label.verticalAlign=t),e._isDirty=!0)},_applyLineHeight:function(t){this._label&&(this._label.lineHeight=t)},_applyFontSize:function(t){this._label.fontSize=t},setOverflow:function(t){var e=this;e._overflow=t,e._label&&(e._label.overflow=t),t!==b8e.OverflowType.NONE&&e._applyContentSize(e._fixedWidth,e._fixedHeight),e._isDirty=!0}}),bui.Graphics.implements({_createNode:function(){var t=b8e.createNode(),e=t.addComponent(cc.Graphics);return this._graphics=e,b8e.isCocos190&&"function"==typeof e.__preload&&e.__preload(),t},strokeColor:function(t){this._graphics.strokeColor=b8e.ColorUtil.toCCColor(t)},fillColor:function(t){this._graphics.fillColor=b8e.ColorUtil.toCCColor(t)},stroke:function(){this._graphics.stroke()},fill:function(){var t=this._graphics;t.close(),t.fill()},fillRect:function(t,e,i,n){var o=this._graphics;o.rect(t,e,i,n),o.fill(),0<this._lineWidth&&o.stroke()},fillCircle:function(t,e,i){var n=this._graphics;n.circle(t,e,i),n.fill(),0<this._lineWidth&&n.stroke()},fillRoundRect:function(t,e,i,n,o){var s=this._graphics;s.roundRect(t,e,i,n,o),s.fill(),0<this._lineWidth&&s.stroke()},moveTo:function(t,e){this._graphics.moveTo(t,e)},lineTo:function(t,e){this._graphics.lineTo(t,e)},lineWidth:function(t){this._lineWidth!=t&&(this._lineWidth=t,this._graphics.lineWidth=t)},clear:function(){var t=this;t.lineWidth(0),t.strokeColor(0),t.fillColor(0),t._graphics&&t._graphics.clear()},dispose:function(){var t=this;t._graphics&&(t._node.removeComponent(t._graphics),t._graphics.destroy(),t._graphics=null),t._super()}}),bui.EditBox.implements({_createNode:function(){var t=b8e.createNode(),e=t.addComponent(cc.EditBox);return(this._editBox=e)._fontAtlasName="default",b8e.isCocos190&&"function"==typeof e.__preload&&e.__preload(),t},onEditingBegan:function(t,e){var i=this;t?(i._onEditingBegan={handler:t,thisArg:e},i._node.on("editing-did-began",i._doEditingBegan,i,!0)):(i._onEditingBegan=null,i._node.off("editing-did-began",i._doEditingBegan,i))},_doEditingBegan:function(){var t=this;t._onEditingBegan&&t._onEditingBegan.handler&&t._onEditingBegan.thisArg&&t._onEditingBegan.handler.call(t._onEditingBegan.thisArg)},onTextChanged:function(t,e){var i=this;t?(i._onTextChanged={handler:t,thisArg:e},i._node.on("text-changed",i._doTextChanged,i)):(i._onTextChanged=null,i._node.off("text-changed",i._doTextChanged,i))},onEditingEnded:function(t,e){var i=this;t?(i._onEditingEnded={handler:t,thisArg:e},i._node.on("editing-did-ended",i._doEditingEnded,i)):(i._onEditingEnded=null,i._node.off("editing-did-ended",i._doEditingEnded,i))},_doEditingEnded:function(){var t=this;t._onEditingEnded&&t._onEditingEnded.handler&&t._onEditingEnded.thisArg&&t._onEditingEnded.handler.call(t._onEditingEnded.thisArg)},_applyLineHeight:function(t){this._editBox&&(this._editBox.lineHeight=t)},_applyFontSize:function(t){this._editBox.fontSize=t},setColor:function(t){t=(4278190080|16777215&t)>>>0,this._super(t),this._editBox&&(this._editBox.fontColor=this._node.color)}}),bui.RichText.implements({_createNode:function(){var t=b8e.createNode(),e=t.addComponent(cc.RichText);return b8e.SHC(e),this._richText=e,b8e.isCocos190&&"function"==typeof e.__preload&&e.__preload(),t},_applyContentSize:function(t,e){this._super(t,e),this._richText&&(this._richText.maxWidth=t)},setHorizontalAlign:function(t){var e=this;e._horizontalAlign!=t&&(e._horizontalAlign=t,e._richText&&(e._richText.horizontalAlign=b8e.HorizontalAlign.toCC(t),e._updateLayout()))},setColor:function(t){t=(4278190080|16777215&t)>>>0,this._super(t)},_updateLayout:function(){var t=this;if(t._richText)switch(t._richText.horizontalAlign){case b8e.HorizontalAlign.CENTER:t.setOffset(t._richText.maxWidth-t._width>>1,0);break;case b8e.HorizontalAlign.RIGHT:t.setOffset(t._richText.maxWidth-t._width,0);break;default:t.setOffset(0,0)}}}),bui.ScrollView.implements({_getPointChange:function(t){return{x:!1===this._props._hCanScroll?0:this._props._lastTouchPosition.x-t.stageX,y:!1===this._props._vCanScroll?0:t.stageY-this._props._lastTouchPosition.y}}}),function(){var t=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4,NEXT:5}),e=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),i=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5});b8e.EditBoxType={KeyboardReturnType:t,InputMode:e,InputFlag:i}}(),function(){if(!b8e.isCocos190){cc.macro;var t=b8e.EditBoxType,r=t.InputMode,l=t.InputFlag,n=t.KeyboardReturnType,h=cc.vmath.mat4.create(),a=null,e=cc.Class({ctor:function(){this._delegate=null,this._inputMode=-1,this._inputFlag=-1,this._returnType=n.DEFAULT,this._maxLength=50,this._text="",this._alwaysOnTop=!1,this._size=cc.size(),this._node=null,this._editing=!1,this.__fullscreen=!1,this.__autoResize=!1,this.__rotateScreen=!1,this.__orientationChanged=null,this._m00=0,this._m01=0,this._m04=0,this._m05=0,this._m12=0,this._m13=0,this._w=0,this._h=0},onEnable:function(){this._edTxt&&(this._alwaysOnTop?this._edTxt.style.display="":this._edTxt.style.display="none")},onDisable:function(){this._edTxt&&(this._edTxt.style.display="none")},setTabIndex:function(t){this._edTxt&&(this._edTxt.tabIndex=t)},setFocus:function(){this._beginEditing()},isFocused:function(){return b8e.isWeChatGame||b8e.isRuntime||b8e.params.isQuickGame?this._editing:!!this._edTxt&&document.activeElement===this._edTxt},stayOnTop:function(t){this._alwaysOnTop!==t&&this._edTxt&&(this._alwaysOnTop=t,this._edTxt.style.display=t?"":"none")},setMaxLength:function(t){isNaN(t)||(t<0&&(t=65535),this._maxLength=t,this._edTxt&&(this._edTxt.maxLength=t))},setString:function(t){this._text=t,b8e.isRuntime&&this._updateInput(),this._edTxt&&(this._edTxt.value=t)},getString:function(){return this._text},setDelegate:function(t){this._delegate=t},setInputMode:function(t){if(b8e.isWeChatGame||b8e.isRuntime||b8e.params.isQuickGame)this._inputMode=t;else{if(this._inputMode===t)return;this._inputMode=t,this.createInput(),this._updateDomInputType(),this._updateSize(this._size.width,this._size.height)}},setInputFlag:function(t){if(this._inputFlag!==t&&(this._inputFlag=t,!(b8e.isWeChatGame||b8e.isRuntime||b8e.params.isQuickGame))){this._updateDomInputType();var e="none";t===l.INITIAL_CAPS_ALL_CHARACTERS?e="uppercase":t===l.INITIAL_CAPS_WORD&&(e="capitalize"),this._edTxt&&(this._edTxt.style.textTransform=e,this._edTxt.value=this._text)}},setReturnType:function(t){this._returnType=t,b8e.isWeChatGame||b8e.isRuntime||b8e.params.isQuickGame||this._updateDomInputType()},setFontSize:function(t){this._edFontSize=t||this._edFontSize,this._delegate._textLabel.fontSize=this._edFontSize,this._edTxt&&(this._edTxt.style.fontSize=this._edFontSize+"px")},setFontColor:function(t){this._textColor=t,this._delegate._textLabel.fontColor=this._textColor},setSize:function(t,e){this._size.width=t,this._size.height=e,this._updateSize(t,e)},setNode:function(t){this._node=t},update:function(){this._updateMatrix()},clear:function(){this._node=null,this.setDelegate(null),b8e.isWeChatGame||b8e.isRuntime||b8e.params.isQuickGame||(this.removeDom(),this.removeOrientationchangeEvent())},_onTouchBegan:function(){},_onTouchEnded:function(){this._beginEditing()},_beginEditing:function(){b8e.isWeChatGame||b8e.isRuntime||b8e.params.isQuickGame?this.createInput():(cc.sys.isMobile&&!this._editing&&this.addOrientationchangeEvent(),b8e.EditBoxUtil._beginEditing(this),this._editing=!0)},_endEditing:function(){var t=this,e=t._delegate;if(b8e.isWeChatGame)e&&e.editBoxEditingDidEnded(),t._editing=!1;else if(b8e.params.isQuickGame)qg&&qg.hideKeyboard({success:function(){},fail:function(t){b8e.warn(t.errMsg)}}),t._editing=!1,e&&e.editBoxEditingDidEnded&&e.editBoxEditingDidEnded();else if(b8e.isRuntime)t._editing&&(t._endEditingOnMobile(),e&&e.editBoxEditingDidEnded&&e.editBoxEditingDidEnded()),t._editing=!1;else{var i=this;b8e.EditBoxUtil._endEditing(i);this._editing&&setTimeout(function(){i._endEditingOnMobile(),i._delegate&&i._delegate.editBoxEditingDidEnded&&i._delegate.editBoxEditingDidEnded()},b8e.EditBoxUtil.DELAY_TIME),this._editing=!1}},_updateDomInputType:function(){var t=this._inputMode,e=this._edTxt;if(e&&t!==r.ANY)if(this._inputFlag!==l.PASSWORD){var i=e.type;t===r.EMAIL_ADDR?i="email":t===r.NUMERIC||t===r.DECIMAL?i="number":t===r.PHONE_NUMBER?(i="number",e.pattern="[0-9]*"):t===r.URL?i="url":(i="text",this._returnType===n.SEARCH&&(i="search")),e.type=i}else e.type="password"},_updateSize:function(t,e){var i=this._edTxt;i&&(i.style.width=t+"px",i.style.height=e+"px")},_updateMatrix:function(){this._edTxt&&b8e.EditBoxUtil.updateMatrix(this,this._node,this._edTxt)},_adjustEditBoxPosition:function(){if(b8e.isCocos190){var e=this._node.convertToWorldSpace(cc.p(0,0)),i=cc.visibleRect.height,t=cc.visibleRect.width,n=.5;i<t&&(n=.7),setTimeout(function(){if(window.scrollY<40&&e.y<i*n){var t=i*n-e.y-window.scrollY;t<35&&(t=35),320<t&&(t=320),window.scrollTo(t,t)}},b8e.EditBoxUtil.DELAY_TIME)}else{this._node.getWorldMatrix(h);var o=h.m13,s=cc.visibleRect.height,a=cc.visibleRect.width,r=.5;s<a&&(r=.7),setTimeout(function(){if(window.scrollY<40&&o<s*r){var t=s*r-o-window.scrollY;t<35&&(t=35),320<t&&(t=320),window.scrollTo(0,t)}},b8e.EditBoxUtil.DELAY_TIME)}}}),i=e.prototype;i._hideLabels=function(){this._delegate._textLabel.node.active=!1},i._showLabels=function(){this._delegate._textLabel.node.active=!0},i.createInput=function(){if(b8e.isWeChatGame)this._showKeyboard(wx);else if(b8e.params.isQuickGame)this._showKeyboard(qg);else if(b8e.isRuntime){var i=function(){o._delegate&&o._delegate.editBoxEditingReturn&&o._delegate.editBoxEditingReturn()},n=function(t){t.value.length>o._maxLength&&(t.value=t.value.slice(0,o._maxLength)),o._delegate&&o._delegate.editBoxTextChanged&&o._text!==t.value&&(o._text=t.value,o._delegate.editBoxTextChanged(o._text))},o=this;o._editing=!0;var t=this._inputMode===r.ANY,e=c(o._inputMode);o._inputFlag===l.PASSWORD&&(e="password");var s=this._getRect();if(jsb.inputBox.show({defaultValue:o._text,maxLength:o._maxLength,multiple:t,confirmHold:!1,confirmType:d(o._returnType),inputType:e,originX:s.x,originY:s.y,width:s.width,height:s.height}),this._delegate){var a=this._delegate;cc.Component.EventHandler.emitEvents(a.editingDidBegan,a),a.node.emit("editing-did-began",a)}jsb.inputBox.onConfirm(i),jsb.inputBox.onInput(n),jsb.inputBox.onComplete(function t(e){o._endEditing(),jsb.inputBox.offConfirm(i),jsb.inputBox.offInput(n),jsb.inputBox.offComplete(t)})}else this._inputMode===r.ANY?this._createDomTextArea():this._createDomInput()},i._showKeyboard=function(e){a!==this&&(a&&(a._endEditing(),e&&e.offKeyboardConfirm&&e.offKeyboardConfirm(a.onKeyboardConfirmCallback),e&&e.offKeyboardInput&&e.offKeyboardInput(a.onKeyboardInputCallback),e&&e.offKeyboardComplete&&e.offKeyboardComplete(a.onKeyboardCompleteCallback)),a=this);var t=this._inputMode===cc.EditBox.InputMode.ANY,i=this;this._editing=!0;var n=i._delegate;function o(t){i._text=t.value,n&&n.editBoxEditingReturn&&n.editBoxEditingReturn(),e&&e.hideKeyboard({success:function(){},fail:function(t){cc.warn(t.errMsg)}})}function s(t){t.value.length>i._maxLength&&(t.value=t.value.slice(0,i._maxLength)),n&&n.editBoxTextChanged&&i._text!==t.value&&(i._text=t.value,n.editBoxTextChanged(i._text),_(n))}e&&e.showKeyboard({defaultValue:i._text,maxLength:i._maxLength,multiple:t,confirmHold:!1,confirmType:d(i._returnType),success:function(){n&&n.editBoxEditingDidBegan&&n.editBoxEditingDidBegan()},fail:function(t){cc.warn(t.errMsg),i._endEditing()}}),e&&e.onKeyboardConfirm&&e.onKeyboardConfirm(o),e&&e.onKeyboardInput&&e.onKeyboardInput(s),e&&e.onKeyboardComplete&&e.onKeyboardComplete(function t(){i._endEditing(),e&&e.offKeyboardConfirm&&e.offKeyboardConfirm(o),e&&e.offKeyboardInput&&e.offKeyboardInput(s),e&&e.offKeyboardComplete&&e.offKeyboardComplete(t),a=null})},i._getRect=function(){var t=this._node,e=cc.view._scaleX,i=cc.view._scaleY,n=cc.view._devicePixelRatio,o=cc.vmath,s=o.mat4.create();t.getWorldMatrix(s);var a=t._contentSize,r=cc.v3();r.x=-t._anchorPoint.x*a.width,r.y=-t._anchorPoint.y*a.height,o.mat4.translate(s,s,r),e/=n,i/=n;var l=s.m00*e,h=s.m05*i;return{x:s.m12*l,y:s.m13*h,width:a.width*l,height:a.height*h}},i._updateInput=function(){var t=this._text;this._inputFlag===l.PASSWORD&&(t=t.replace(/./g,"*")),this._delegate._textLabel.string=t},i._beginEditingOnMobile=function(){"undefined"!=typeof b8e&&b8e.beginEditingOnMobile&&b8e.beginEditingOnMobile(this._updateMatrix,this),a=this},i._endEditingOnMobile=function(){"undefined"!=typeof b8e&&b8e.endEditOnMobile&&b8e.endEditOnMobile()},i._createDomInput=function(){return this.removeDom(),this._edTxt=b8e.EditBoxUtil.createDomInput(this,this._edFontSize,this)},i._createDomTextArea=function(){return this.removeDom(),this._edTxt=b8e.EditBoxUtil.createDomTextArea(this,this._edFontSize)},i._addDomToGameContainer=function(t){cc.game.container.appendChild(t)},i.removeDom=function(){var t=this._edTxt;t&&b8e.EditBoxUtil.removeDomText(this,t),this._edTxt=null},i.addOrientationchangeEvent=function(){var t=this;t.__orientationChanged||(t.__orientationChanged=function(){t._adjustEditBoxPosition()}),window.addEventListener("orientationchange",t.__orientationChanged)},i.removeOrientationchangeEvent=function(){this.__orientationChanged&&(window.removeEventListener("orientationchange",this.__orientationChanged),this.__orientationChanged=null)},cc.EditBoxImpl=e}function d(t){switch(t){case n.DEFAULT:case n.DONE:return"done";case n.SEND:return"send";case n.SEARCH:return"search";case n.GO:return"go";case n.NEXT:return"next"}return"done"}function c(t){switch(t){case r.EMAIL_ADDR:return"email";case r.NUMERIC:case r.DECIMAL:return"number";case r.PHONE_NUMBER:return"phone";case r.URL:return"url";case r.SINGLE_LINE:case r.ANY:default:return"text"}}function _(t){var e=t._textLabel,i=t._impl._text;e.node.active=""!==i}}(),function(){if(!b8e.isCocos190){var s=cc.macro,e=cc.EditBoxImpl,i=cc.Label,t=b8e.EditBoxType,a=t.InputMode,r=t.InputFlag,n=t.KeyboardReturnType,l=b8e.EditBoxUtil.LEFT_PADDING,o=cc.Class({name:"cc.EditBox",extends:cc.Component,properties:{_useOriginalSize:!0,_string:"",string:{get:function(){return this._string},set:function(t){0<=this.maxLength&&t.length>=this.maxLength&&(t=t.slice(0,this.maxLength)),this._string=t,this._impl&&this._updateString(t)}},backgroundImage:{default:null,type:cc.SpriteFrame,notify:function(){this._createBackgroundSprite()}},returnType:{default:n.DEFAULT,displayName:"KeyboardReturnType",type:n,notify:function(){this._impl&&(this._impl.returnType=this.returnType)}},inputFlag:{default:r.DEFAULT,type:r,notify:function(){this._impl&&(this._impl.setInputFlag(this.inputFlag),this._updateString(this._string))}},inputMode:{default:a.ANY,type:a,notify:function(){this._impl&&this._impl.setInputMode(this.inputMode)}},fontSize:{default:24,notify:function(){this._textLabel&&(this._textLabel.fontSize=this.fontSize),this._impl&&this._impl.setFontSize(this.fontSize)}},lineHeight:{default:28,notify:function(){this._textLabel&&(this._textLabel.lineHeight=this.lineHeight)}},fontColor:{default:cc.Color.WHITE,notify:function(){this._textLabel&&(this._textLabel.node.opacity=this.fontColor.a,this._textLabel.node.color=this.fontColor),this._impl&&this._impl.setFontColor(this.fontColor)}},maxLength:{default:20,notify:function(){this._impl&&this._impl.setMaxLength(this.maxLength)}},stayOnTop:{default:!1,notify:function(){this._impl&&this._updateStayOnTop()}},_tabIndex:0,tabIndex:{get:function(){return this._tabIndex},set:function(t){this._tabIndex=t,this._impl&&this._impl.setTabIndex(t)}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{_EditBoxImpl:e,KeyboardReturnType:n,InputFlag:r,InputMode:a},_init:function(){this._createBackgroundSprite(),this._createLabels(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._resizeChildNodes,this);var t=this._impl=new e;t.setDelegate(this),t.setNode(this.node),t.setInputMode(this.inputMode),t.setMaxLength(this.maxLength),t.setInputFlag(this.inputFlag),t.setReturnType(this.returnType),t.setTabIndex(this.tabIndex),t.setFontColor(this.fontColor),t.setFontSize(this.fontSize),"undefined"!=typeof b8e&&b8e.macro&&(cc.sys.platform!==cc.sys.WECHAT_GAME&&cc.sys.platform!==cc.sys.QQ_PLAY?this.stayOnTop=!!b8e.macro.EDTEXT_ALAWYS_ON_TOP:this.stayOnTop=!1),this._updateStayOnTop(),this._updateString(this.string),this._syncSize()},_updateStayOnTop:function(){b8e.isWeChatGame||b8e.isRuntime||(this.stayOnTop?this._hideLabels():this._showLabels(),this._impl.stayOnTop(this.stayOnTop))},_syncSize:function(){var t=this.node.getContentSize();this._background.node.setAnchorPoint(this.node.getAnchorPoint()),this._background.node.setContentSize(t),this._updateLabelPosition(t),this._impl.setSize(t.width,t.height)},_updateLabelPosition:function(t){var e=this.node,i=-e.anchorX*e.width,n=-e.anchorY*e.height,o=this._textLabel;o.node.setContentSize(t.width-l,t.height),o.node.setPosition(i+l,n+t.height),this.inputMode===a.ANY?(o.verticalAlign=s.VerticalTextAlignment.TOP,o.enableWrapText=!0):(o.verticalAlign=s.VerticalTextAlignment.CENTER,o.enableWrapText=!1)},_createBackgroundSprite:function(){var t=this._background;if(!t){var e=this.node.getChildByName("BACKGROUND_SPRITE");(t=(t=(e=e||new cc.Node("BACKGROUND_SPRITE")).getComponent(cc.Sprite))||e.addComponent(cc.Sprite)).type=cc.Sprite.Type.SLICED,e.setParent(this.node),this._background=t}t.spriteFrame=this.backgroundImage},_createLabels:function(){if(!this._textLabel){var t=this.node.getChildByName("TEXT_LABEL"),e=(t=t||new cc.Node("TEXT_LABEL")).getComponent(i);e=e||t.addComponent(i),b8e._applyTextAttribute(this,e),t.color=this.fontColor,t.setParent(this.node),t.setAnchorPoint(0,1),e.overflow=i.Overflow.CLAMP,e.fontSize=this.fontSize,e.lineHeight=this.lineHeight,this._textLabel=e}},_resizeChildNodes:function(){var t=this._textLabel.node,e=this._background.node;t.x=-this.node.width/2,t.y=this.node.height/2,t.width=this.node.width,t.height=this.node.height,e.width=this.node.width,e.height=this.node.height},_showLabels:function(){this._impl._showLabels()},_hideLabels:function(){this._impl._hideLabels()},_updateString:function(t){var e=this._textLabel;if(e){var i=t;i=i&&this._updateLabelStringStyle(i),e.string=i,this._impl.setString(t),this._impl._editing||this.stayOnTop||this._showLabels()}},_updateLabelStringStyle:function(t,e){var i=this.inputFlag;if(e||i!==r.PASSWORD)i===r.INITIAL_CAPS_ALL_CHARACTERS?t=t.toUpperCase():i===r.INITIAL_CAPS_WORD?t=h(t):i===r.INITIAL_CAPS_SENTENCE&&(t=d(t));else{for(var n="",o=t.length,s=0;s<o;++s)n+="\u25cf";t=n}return t},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this),this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this),this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(t){t=this._updateLabelStringStyle(t,!0),this.string=t,cc.Component.EventHandler.emitEvents(this.textChanged,t,this),this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this),this.node.emit("editing-return",this)},onDestroy:function(){this._impl.clear()},onEnable:function(){this._impl&&this._impl.onEnable()},onDisable:function(){this._impl&&this._impl.onDisable()},__preload:function(){this._registerEvent(),this._init()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_onTouchBegan:function(t){this._impl&&this._impl._onTouchBegan(t.touch),t.stopPropagation()},_onTouchCancel:function(t){this._impl&&this._impl._onTouchCancel(),t.stopPropagation()},_onTouchEnded:function(t){this._impl&&this._impl._onTouchEnded(),t.stopPropagation()},setFocus:function(){this._impl&&this._impl.setFocus()},isFocused:function(){var t=!1;return this._impl&&(t=this._impl.isFocused()),t},update:function(){this._impl&&this._impl.update()}});cc.EditBox=o}function h(t){return t.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})}function d(t){return t.charAt(0).toUpperCase()+t.slice(1)}}(),function(){if(!b8e.isCocos190){var t=cc.macro,u=cc.textUtils,l=t.TextAlignment,s=t.VerticalTextAlignment,o="RICHTEXT_CHILD",c="RICHTEXT_Image_CHILD",n=new b8e.JsUtil.Pool(function(t){return!!cc.isValid(t)&&!t.getComponent(cc.LabelOutline)},1024);n.get=function(t,e){var i=this._get(),n=(i=i||new cc.PrivateNode(o)).getComponent(cc.Label);return n=n||i.addComponent(cc.Label),i};var e=cc.Class({name:"cc.RichText",extends:cc.Component,ctor:function(){this._textArray=null,this._labelSegments=[],this._labelSegmentsCache=[],this._linesWidth=[],this._updateRichTextStatus=this._updateRichText},properties:{string:{default:"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,notify:function(){this._updateRichTextStatus(!0)}},horizontalAlign:{default:l.LEFT,type:l,animatable:!1,notify:function(t){this.horizontalAlign!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:24,notify:function(t){this.fontSize!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},_fontFamily:"Arial",fontFamily:{get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1},font:{default:null,type:cc.TTFFont,notify:function(t){this.font!==t&&(this._layoutDirty=!0,this.font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(t){(t||this.font)&&this._isSystemFontUsed!==t&&(this._isSystemFontUsed=t,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1},maxWidth:{default:0,notify:function(t){this.maxWidth!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:28,notify:function(t){this.lineHeight!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,notify:function(t){this.imageAtlas!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},handleTouchEvent:{default:!0,notify:function(t){this.handleTouchEvent!==t&&this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners())}}},statics:{HorizontalAlign:l,VerticalAlign:s},onEnable:function(){this.handleTouchEvent&&this._addEventListeners(),this._updateRichText(!0)},onDisable:function(){this.handleTouchEvent&&this._removeEventListeners()},start:function(){this._onTTFLoaded()},_onColorChanged:function(e){this.node.children.forEach(function(t){t.color=e})},_addEventListeners:function(){this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_removeEventListeners:function(){this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(t){this._applyTextAttribute(t)}.bind(this))},_createFontLabel:function(t){return n.get(t,this)},_onTTFLoaded:function(){if(this.font instanceof cc.TTFFont)if(this.font._nativeAsset)this._layoutDirty=!0,this._updateRichText();else;else this._layoutDirty=!0,this._updateRichText()},_measureText:function(i,t){function e(t){var e=void 0;return 0===n._labelSegmentsCache.length?(e=n._createFontLabel(t),n._labelSegmentsCache.push(e)):e=n._labelSegmentsCache[0],e._styleIndex=i,n._applyTextAttribute(e),e.getComponent(cc.Label).string=t,e.getContentSize().width}var n=this;return t?e(t):e},_onTouchEnded:function(o){var s=this;if("undefined"!=typeof b8e&&b8e._onRichTextTouchEnded)b8e._onRichTextTouchEnded(this,o);else for(var a=this.node.getComponents(cc.Component),t=function(t){var e=s._labelSegments[t],i=e._clickHandler,n=e._clickParam;i&&s._containsTouchLocation(e,o.touch.getLocation())&&(a.forEach(function(t){t.enabledInHierarchy&&t[i]&&t[i](o,n)}),o.stopPropagation())},e=0;e<this._labelSegments.length;++e)t(e)},_containsTouchLocation:function(t,e){return t.getBoundingBoxToWorld().contains(e)},_resetState:function(){for(var t=this.node.children,e=t.length-1;0<=e;e--){var i=t[e];i.name!==o&&i.name!==c||(i.parent===this.node?i.setParent(null):t.splice(e,1),i.name===o&&n.put(i))}this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},_activateChildren:function(t){for(var e=this.node.children.length-1;0<=e;e--){var i=this.node.children[e];i.name!==o&&i.name!==c||(i.active=t)}},_addLabelSegment:function(t,e){var i=void 0,n=(i=0===this._labelSegmentsCache.length?this._createFontLabel(t):this._labelSegmentsCache.pop()).getComponent(cc.Label);return b8e._applyTextAttribute(this,n),i._styleIndex=e,i._lineCount=this._lineCount,i.setAnchorPoint(0,0),this._applyTextAttribute(i),this.node.addChild(i),this._labelSegments.push(i),i.getComponent(cc.Label).string=t,i},_updateRichTextWithMaxWidth:function(t,e,i){var n=e;if(0<this._lineOffsetX&&n+this._lineOffsetX>this.maxWidth)for(var o=0;this._lineOffsetX<=this.maxWidth;){var s=this._getFirstWordLen(t,o,t.length),a=t.substr(o,s),r=this._measureText(i,a);if(!(this._lineOffsetX+r<=this.maxWidth)){if(0<o){var l=t.substr(0,o);this._addLabelSegment(l,i),t=t.substr(o,t.length),n=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=r,o+=s}if(n>this.maxWidth)for(var h=u.fragmentText(t,n,this.maxWidth,this._measureText(i)),d=0;d<h.length;++d){var c=h[d],_=this._addLabelSegment(c,i).getContentSize();this._lineOffsetX+=_.width,1<h.length&&d<h.length-1&&this._updateLineInfo()}else this._lineOffsetX+=n,this._addLabelSegment(t,i)},_isLastComponentCR:function(t){return t.length-1===t.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;++e){var i=this._textArray[e],n=t[e];if(i.text!==n.text)return!0;if(i.style){if(n.style){if(!!n.style.outline!=!!i.style.outline)return!0;if(i.style.size!==n.style.size||i.style.italic!==n.style.italic||i.style.isImage!==n.style.isImage)return!0;if(i.style.isImage===n.style.isImage&&i.style.src!==n.style.src)return!0}else if(i.style.size||i.style.italic||i.style.isImage||i.style.outline)return!0}else if(n.style&&(n.style.size||n.style.italic||n.style.isImage||n.style.outline))return!0}return!1},_addRichTextImageElement:function(t){var e=t.style.src,i=this.imageAtlas.getSpriteFrame(e);if(i){var n=new cc.PrivateNode(c),o=n.addComponent(cc.Sprite);n.setAnchorPoint(0,0),o.type=cc.Sprite.Type.SLICED,o.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node.addChild(n),this._labelSegments.push(n);var s=i.getRect(),a=1,r=s.width,l=s.height,h=t.style.imageWidth,d=t.style.imageHeight;0<d&&d<this.lineHeight?r*=a=d/l:r*=a=this.lineHeight/l,l*=a,0<h&&(r=h),0<this.maxWidth?(this._lineOffsetX+r>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=r):(this._lineOffsetX+=r,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),o.spriteFrame=i,n.setContentSize(r,l),n._lineCount=this._lineCount,t.style.event?(t.style.event.click&&(n._clickHandler=t.style.event.click),t.style.event.param?n._clickParam=t.style.event.param:n._clickParam=""):n._clickHandler=null}},_updateRichText:function(t){b8e._updateRichText(this,t)},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(u.isUnicodeCJK(n)||u.isUnicodeSpace(n))return 1;for(var o=1,s=e+1;s<i&&(n=t.charAt(s),!u.isUnicodeSpace(n)&&!u.isUnicodeCJK(n));++s)o++;return o},_updateRichTextPosition:function(){for(var t=0,e=1,i=this._lineCount,n=0;n<this._labelSegments.length;++n){var o=this._labelSegments[n],s=o._lineCount;e<s&&(t=0,e=s);var a=0;switch(this.horizontalAlign){case l.LEFT:a=-this._labelWidth/2;break;case l.CENTER:a=-this._linesWidth[s-1]/2;break;case l.RIGHT:a=this._labelWidth/2-this._linesWidth[s-1]}o.x=t+a;var r=o.getContentSize();o.y=this.lineHeight*(i-s)-this._labelHeight/2,s===e&&(t+=r.width)}},_convertLiteralColorValue:function(t){var e=t.toUpperCase();return cc.Color[e]?cc.Color[e]:cc.color().fromHEX(t)},_applyTextAttribute:function(t){var e=t.getComponent(cc.Label);if(e){var i=t._styleIndex;this._isSystemFontUsed&&(e.fontFamily=this._fontFamily),e.setColorTransfrom(this._colorTransfrom),e.useSystemFont=this._isSystemFontUsed,e.lineHeight=this.lineHeight,e.horizontalAlign=l.LEFT,e.verticalAlign=s.CENTER;var n=null;if(this._textArray&&this._textArray[i]&&(n=this._textArray[i].style),n&&n.color?t.color=this._convertLiteralColorValue(n.color):t.color=this.node.color,e._enableBold(n&&n.bold),e._enableItalics(n&&n.italic),n&&n.italic?t.skewX=12:t.skewX=0,e._enableUnderline(n&&n.underline),n&&n.outline){var o=t.getComponent(cc.LabelOutline);(o=o||t.addComponent(cc.LabelOutline)).color=this._convertLiteralColorValue(n.outline.color),o.width=n.outline.width}n&&n.size?e.fontSize=n.size:e.fontSize=this.fontSize,n&&n.event?(n.event.click&&(t._clickHandler=n.event.click),n.event.param?t._clickParam=n.event.param:t._clickParam=""):t._clickHandler=null}},setColorTransfrom:function(t){this._colorTransfrom=t;for(var e=this._labelSegments.length,i=0;i<e;++i){var n=this._labelSegments[i].getComponent(cc.Label);n&&n.setColorTransfrom(t)}},onDestroy:function(){for(var t=this._labelSegments.length,e=0;e<t;++e){var i=this._labelSegments[e];i.removeFromParent(),n.put(i)}this._colorTransfrom=null}});cc.RichText=e}}(),function(){b8e.ADPATER_COCOS_VERSION="4.1.5";var t=b8e.EngineAdapterCocos={};b8e.SHC(t);var e=t.onInit=function(){b8e.ADPATER_COCOS_VERSION!==b8e.VERSION&&b8e.error("\u6ce8\u610f\uff1aAdapterCocos\u548cEngine\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01\nAdapterCocos:V"+b8e.ADPATER_COCOS_VERSION+" & Engine:V"+b8e.VERSION)};b8e.SHC(e),b8e.onInit(e,t)}()},{}]},{},[1]);