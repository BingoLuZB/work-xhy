var pako=require("./pako.min.js");window.pako=pako;var repeatArray=["com","avatar","chapter","item","Shenbing"],egret=window.egret;window.mountObj=function(e,t){if(window[e]){if(-1!=repeatArray.indexOf(e)){var o=window[e];for(var n in t)o[n]=t[n]}}else window[e]=t};var __reflect=this&&this.__reflect||function(e,t,o){var n=t.split(".");if(1==n.length)window[t]=e.constructor;else{for(var r=window,i=0;i<n.length-1;i++){var a=n[i];if(1==n.length||r[a])r=r[a];else{var l={};r[a]=l,r=l}}r[n[i]]=e.constructor}e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o};window.__reflect=__reflect;var __awaiter=this&&this.__awaiter||function(i,a,l,s){return new(l||(l=Promise))(function(e,t){function o(e){try{r(s.next(e))}catch(e){t(e)}}function n(e){try{r(s.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new l(function(e){e(t.value)}).then(o,n)}r((s=s.apply(i,a||[])).next())})};window.__awaiter=__awaiter;var __generator=this&&this.__generator||function(o,n){var r,i,a,e,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,i&&(a=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,i=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){l.label=t[1];break}if(6===t[0]&&l.label<a[1]){l.label=a[1],a=t;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(t);break}a[2]&&l.ops.pop(),l.trys.pop();continue}t=n.call(o,l)}catch(e){t=[6,e],i=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};window.__generator=__generator;var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o};window.__extends=__extends;var __decorate=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(a=(i<3?r(a):3<i?r(t,o,a):r(t,o))||a);return 3<i&&a&&Object.defineProperty(t,o,a),a};window.__decorate=__decorate;var LoginUtil=function(){function a(){}return a.startFullscreenAdaptation=function(e,t,o,n){var r=this;r._stage=e,r.designWidth=t,r.designHeight=o,r.resizeCallback=n,r.stageOnResize()},a.setFrame=function(e){if(void 0===e&&(e=""),-1!=e.search("vivo X7")||-1!=e.search("OPPO R9s")||-1!=e.search("vivo X6S")||-1!=e.search("vivo Y66L")){this._stage.frameRate=60}},a.stageOnResize=function(){var e=this;e._stage.removeEventListener(egret.Event.RESIZE,e.stageOnResize,e);var t=e.designWidth,o=e.designHeight,n=window.innerWidth,r=window.innerHeight;if(platform.enableFunc(FunctionID.PC_ADAPTER)){var i=n/r,a=t/o;e._stage.scaleMode=i<a?egret.StageScaleMode.FIXED_HEIGHT:egret.StageScaleMode.EXACT_FIT}else if(.8*r<n)e._stage.scaleMode=egret.StageScaleMode.SHOW_ALL;else{var l=(i=n/r)/(a=t/o);if(a<i){var s=l,c=l;t=Math.floor(t*s),o=Math.floor(o*c)}e._stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH}e._stage.setContentSize(t,o),e.LoginUI&&e.LoginUI.resetUI(),e.LoginError&&e.LoginError.resetUI(),e.resizeCallback&&e.resizeCallback(),e._stage.addEventListener(egret.Event.RESIZE,e.stageOnResize,e)},a.createBitmapByName=function(e){var t=new egret.Bitmap,o=RES.getRes(e);return t.texture=o,t},a.minifyBtn=function(e){var t=e.currentTarget;t.scaleX=.9,t.scaleY=.9},a.restoreBtn=function(e){var t=e.currentTarget;t.scaleX=1,t.scaleY=1},a.getLabelTag=function(e){return-1!=e.indexOf("4")?"dl_img_xin_png":-1!=e.indexOf("3")?"dl_img_wei_png":"dl_img_huo_png"},a.getLastServer=function(){var t=this.accountData.newServer,o=this.accountData.preSid;return o&&this.accountData.gsl.forEach(function(e){if(e.id==o)return t=e}),t},a.getRoleByServerId=function(e){var t=this.accountData.rl;for(var o in t){if(e==t[o].sid)return t[o]}},a.setGameProcess=function(e,t,o,n){var r=this;r.LoginUI&&r.LoginUI.loadProcess&&r.LoginUI.loadLabel&&(r.LoginUI.loadProcess.width=e*o/n,r.LoginUI.child4Inner2.mask=r.LoginUI.loadProcess,r.LoginUI.loadLabel.text=Math.floor(o/n*t)+"%")},a.removeLoginUI=function(){this.LoginUI&&this.LoginUI.parent&&this.LoginUI.parent.removeChild(this.LoginUI)},a.httpEncryptRequest=function(e,t,o,n){var r=new HTTP1;r.post(e,r.encrypParams(t),o,n)},a.httpNormalRequest=function(e,t,o,n){(new HTTP1).post(e,t,o,n)},a.encryptStrToByte=function(e,t){if(0==e.length)return null;var o=new egret.ByteArray;o.writeUTFBytes(e);var n=new egret.ByteArray;n.writeUTFBytes(t);var r=this.toIntArray(o.bytes,!0),i=this.toIntArray(n.bytes,!1),a=this.encryptInner(r,i);return this.toByteArray(a,!1)},a.encryptInner=function(e,t){var o=e.length-1;if(o<1)return e;if(t.length<4){for(var n=new Array(4),r=0;r<4;r++)n[r]=0;for(r=0;r<t.length;r++)n[r]=Number(t[r]);t=n}for(var i,a,l=e[o],s=e[0],c=0,d=Math.floor(6+52/(o+1));0<d--;){for(i=(c=c+this.delta&4294967295)>>>2&3,a=0;a<o;a++)s=e[a+1],e[a]=e[a]+this.MX(c,s,l,a,i,t)&4294967295,l=e[a];s=e[0],e[o]=e[o]+this.MX(c,s,l,a,i,t)&4294967295,l=e[o]}return e},a.toIntArray=function(e,t){var o,n=0==(3&e.length)?e.length>>>2:1+(e.length>>>2);t?(o=new Array(n+1))[n]=e.length:o=new Array(n),n=e.length;for(var r=0;r<n;r++)o[r>>>2]|=(255&e[r])<<((3&r)<<3);return o},a.toByteArray=function(e,t){var o=e.length<<2;if(t){var n=e[e.length-1];if(o<n)return null;o=n}for(var r=new egret.ByteArray,i=0;i<o;i++)r.writeByte(e[i>>>2]>>>((3&i)<<3)&255);return r},a.MX=function(e,t,o,n,r,i){return(o>>>5^t<<2)+(t>>>3^o<<4)^(e^t)+(i[3&n^r]^o)},a.recordData=function(e){var t="cid="+a.gameCfg.channel+"&idfa="+a.gameCfg.uuid+"&step="+e;a.httpNormalRequest(a.gameCfg.accURL+"/action/user/deviceStep",t)},a.dataPlacement=function(e){window.ShSdk&&window.ShSdk.dataPlacement&&window.ShSdk.dataPlacement({action:e})},a.getLoginJson=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=a.loginJson[e];if(!n)return"{"+e+"}";n=n.content;for(var r=t.length,i=0;i<r;i++)n=n.replace("{"+i+"}",t[i]);return n},a.refresh=function(){if(App&&App.GameMain){var e=App.ViewManager.getOpenView(ViewConst.Battle);e instanceof FightBattleView&&(App.ControllerManager.applyFunc(CtrlConst.Fight,FightConst.FIGHT_PLAYEND_REQ),e.endPlay());var t=App.ViewManager.getOpenView(ViewConst.Fight);t instanceof FightHandUpView&&t.resetMapName(),a.accountData.reconnect=!1,GameUtils.adapterDelete(),App.ViewManager.adapterFix=!1,App.Socket.getSocket()&&App.Socket.close();var o=App.SceneManager.getCurrScene(),n=App.SceneManager.getScene(o);n&&n.onExit()}a.LoginMain.start()},a.delta=2654435769,a}();__reflect(LoginUtil.prototype,"LoginUtil");var GuildRecoordIndex2=function(){function e(){}return e.record1=10,e.record2=20,e.record3=30,e.record4=40,e.record5=50,e.record6=60,e.record7=70,e.record8=80,e.record9=90,e.record10=100,e.record11=110,e.record12=120,e.record13=130,e.record14=140,e.record15=150,e.record18=180,e}();__reflect(GuildRecoordIndex2.prototype,"GuildRecoordIndex2");var BuriedPoint=function(){function e(){}return e.point1=1e4,e.point2=2e4,e.point3=25e3,e.point4=3e4,e.point5=30001,e.point6=4e4,e.point7=5e4,e.point8=6e4,e.point9=7e4,e.point11=75e3,e.point12=8e4,e.point13=9e4,e.point14=90100,e.point15=90200,e.point16=90300,e.point17=90400,e.point18=90500,e}();__reflect(BuriedPoint.prototype,"BuriedPoint");var HTTP1=function(){function e(e){this.errorNum=0,this.domain=e||LoginUtil.gameCfg.accURL,this.http=new egret.HttpRequest}return e.prototype.post=function(e,t,o,n,r){this.caller=n,this.callback=o,this.params=r,this.data=t;var i=this.http;return i.responseType=egret.HttpResponseType.TEXT,i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),-1<e.indexOf("http://")||-1<e.indexOf("https://")?this.url=e:this.url=this.domain+e,i.open(this.url,egret.HttpMethod.POST),i.send(t),i.addEventListener(egret.Event.COMPLETE,this.onRequestComplete,this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onRequestIOError,this),this},e.prototype.onRequestIOError=function(e){this.errorNum++;var t=this.http;if(2<this.errorNum)this.callback&&this.callback.apply(this.caller,[{state:500,msg:e}]);else{var o=this.url;LoginUtil.gameCfg.accURLBak&&(o=o.replace(LoginUtil.gameCfg.accURL,LoginUtil.gameCfg.accURLBak)),console.log("Http1 try again "+o),t.open(o,egret.HttpMethod.POST),t.send(this.data)}},e.prototype.onRequestComplete=function(e){var t=e.currentTarget;this.http.removeEventListener(egret.Event.COMPLETE,this.onRequestComplete,this),this.http.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onRequestIOError,this);var o=t.response;if(o&&""!=o){var n=JSON.parse(o);this.callback&&this.callback.apply(this.caller,[n,this.params])}else console.log("Http1 response null")},e.prototype.encrypParams=function(e){var t="";for(var o in e){var n=e[o],r=encodeURIComponent(n);0<t.length&&(t+="&"),t+=o+"="+r}var i=LoginUtil.encryptStrToByte(t,"d2FtYWklMjZ5YW93ZW5oYW8"),a=egret.Base64Util.encode(i.buffer);return"p="+encodeURIComponent(a)},e}();__reflect(HTTP1.prototype,"HTTP1");var ServerTab=function(n){function e(e){var t=n.call(this)||this,o=t;return o.data=e,o.w=194,o.h=74,o.width=194,o.height=74,o.unSelectBg=LoginUtil.createBitmapByName("st_dl_btn_fwlban1_png"),o.unSelectBg.anchorOffsetX=.5*o.unSelectBg.width,o.unSelectBg.anchorOffsetY=.5*o.unSelectBg.height,o.unSelectBg.x=.5*o.w,o.unSelectBg.y=.5*o.h,o.selectBg=LoginUtil.createBitmapByName("st_dl_btn_fwlban_png"),o.selectBg.anchorOffsetX=.5*o.selectBg.width,o.selectBg.anchorOffsetY=.5*o.selectBg.height,o.selectBg.x=.5*o.w,o.selectBg.y=.5*o.h,o.unSelectTab(),o.setLabelText(o.data.name),t}return __extends(e,n),e.prototype.setLabelText=function(e){var t=this;t.label||(t.label=new egret.TextField,t.addChild(t.label)),t.label.text=e,t.label.size=24,t.label.textColor=9195307,t.label.anchorOffsetX=t.label.text.length*t.label.size*.5,t.label.anchorOffsetY=.5*t.label.size,t.label.x=.5*t.w,t.label.y=.5*t.h},e.prototype.selectTab=function(){var e=this;e.unSelectBg.parent&&e.removeChild(e.unSelectBg),e.addChildAt(e.selectBg,0)},e.prototype.unSelectTab=function(){var e=this;e.selectBg.parent&&e.removeChild(e.selectBg),e.addChildAt(e.unSelectBg,0)},e}(eui.Group);__reflect(ServerTab.prototype,"ServerTab");var ServerLabel=function(i){function e(e){var t=i.call(this)||this,o=t;o.data=e,o.width=421,o.height=84,o.bg=LoginUtil.createBitmapByName("st_jgg_img_fwlb_png"),o.bg.scale9Grid=new egret.Rectangle(34,32,1,2),o.bg.width=421,o.bg.height=84,o.addChildAt(o.bg,0);var n=LoginUtil.getLabelTag(o.data.label);o.hoticon=LoginUtil.createBitmapByName(n),o.hoticon.x=25,o.hoticon.y=0,o.addChildAt(o.hoticon,1),o.sname=new eui.Label,o.sname.text=o.data.ne,o.sname.size=20,o.sname.textColor=10315030,o.sname.horizontalCenter=0,o.sname.y=17,o.addChildAt(o.sname,2);var r=LoginUtil.getRoleByServerId(o.data.id);return r?(o.rname=new eui.Label,o.rname.text=r.name+" lv."+r.lv,o.rname.size=20,o.rname.textColor=7035205,o.rname.horizontalCenter=0,o.rname.y=50,o.addChildAt(o.rname,3)):(o.sname.size=26,o.sname.y=29),t}return __extends(e,i),e}(eui.Group);__reflect(ServerLabel.prototype,"ServerLabel");var LoginError=function(l){function e(e,t,o,n,r){var i=l.call(this)||this,a=i;return(LoginUtil.LoginError=a).name="LoginError",a.width=e,a.height=t,a.tips=o,a.callback=n,a.calltarget=r,a.once(egret.Event.ADDED_TO_STAGE,a.onAddToStage,a),a.once(egret.Event.REMOVED_FROM_STAGE,a.onRemoveFromStage,a),i}return __extends(e,l),e.prototype.onAddToStage=function(){var e=this;LoginUtil.LoginErrorOnStage=!0,window.removeLoading&&window.removeLoading(),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseTips,e);var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,e.width,e.height),t.graphics.endFill(),e.commonBg=t,e.addChild(t);var o=LoginUtil.createBitmapByName("wlyc_img_yichtc_png");o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=.5*e.width,o.y=.5*e.height,e.imgbg=o,e.addChild(o);var n=new eui.Label;n.size=24,n.width=320,n.textColor=7035205,n.text=e.tips,n.horizontalCenter=0,n.verticalCenter=60,n.verticalAlign="top",n.textAlign="center",n.lineSpacing=5,e.addChild(n)},e.prototype.doCloseTips=function(){var e=this;e.parent.removeChild(e),e.callback&&e.callback.call(e.calltarget)},e.prototype.onRemoveFromStage=function(){LoginUtil.LoginErrorOnStage=!1,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.doCloseTips,this)},e.prototype.resetUI=function(){var e=this;e.width=e.stage.stageWidth,e.height=e.stage.stageHeight,e.commonBg&&(e.commonBg.graphics.clear(),e.commonBg.graphics.beginFill(0,.5),e.commonBg.graphics.drawRect(0,0,e.width,e.height),e.commonBg.graphics.endFill()),e.imgbg&&(e.imgbg.x=.5*e.width)},e}(eui.Group);__reflect(LoginError.prototype,"LoginError");var LoginUI=function(r){function e(e,t){var o=r.call(this)||this;o.checkBool=!0;var n=o;return LoginUtil.recordData(GuildRecoordIndex2.record6),LoginUtil.dataPlacement(BuriedPoint.point11),(LoginUtil.LoginUI=n).name="LoginUI",n.width=e,n.height=t,n.serverTabs=[],n.serverList=[],n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.once(egret.Event.REMOVED_FROM_STAGE,n.onRemoveFromStage,n),o}return __extends(e,r),e.prototype.onAddToStage=function(){var e=this;e.initNoticeBtn(),e.initBottom(),e.initProtocolGrp(),e.initLoginGrp(),e.initCurSerGrp(),e.initNewSerGrp(),e.initRewardGrp(),e.initKefuBtn(),e.showVerion();var t=LoginUtil.accountData.rl;!t||t.length<=0?e.doLogin():e.autoPopupReq()},e.prototype.showVerion=function(){var e=new egret.TextField;e.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(25,LoginUtil.gameCfg.version)),e.textColor=0,e.size=22,e.x=10,e.y=10,this.addChild(e)},e.prototype.autoPopupReq=function(){var e={configId:LoginUtil.gameCfg.noticeId};LoginUtil.httpEncryptRequest(LoginUtil.gameCfg.accURL+"/action/user/getGameConfigStatus",e,this.autoPopupRes,this)},e.prototype.autoPopupRes=function(e){0===e.s?1==e.r&&1==LoginUtil.accountData.isFirst&&this.doOpenNotice():console.log("自动弹出公告标识获取不到!")},e.prototype.initLoadGp=function(){var e=this;if(!e.loadGp){e.loadGp=new eui.Group,e.loadGp.width=720,e.loadGp.height=299,e.loadGp.anchorOffsetX=360,e.loadGp.x=.5*e.width,e.loadGp.y=e.aptImgY-(e.loadGp.height+15),e.addChild(e.loadGp);var t=LoginUtil.createBitmapByName("dl_img_dqdk_png");e.loadGp.addChild(t);var o=new eui.Label;o.size=26,o.textColor=16777215,o.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(6)),o.y=30,o.horizontalCenter=0,e.loadGp.addChild(o),e.clearCacheLb=o,e.clearCacheLb.touchEnabled=!0,e.clearCacheLb.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doClearCache,e);var n=new eui.Label;n.size=26,n.textColor=16777215,n.text=LoginUtil.getLoginJson(7),n.y=86,n.horizontalCenter=0,e.loadGp.addChild(n);var r=new eui.Group;r.width=708,r.height=28,r.y=142,r.horizontalCenter=0,e.loadGp.addChild(r);var i=LoginUtil.createBitmapByName("dl_bar_dqjd_di_png");i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,i.x=.5*r.width,i.y=.5*r.height,r.addChild(i);var a=LoginUtil.createBitmapByName("dl_bar_dqjd_png");(e.child4Inner2=a).anchorOffsetX=.5*a.width+5,a.anchorOffsetY=.5*a.height,a.x=.5*r.width,a.y=.5*r.height,r.addChild(a),a.mask=new egret.Rectangle(0,0,0,20),e.loadProcess=a.mask;var l=new eui.Label;l.size=30,l.textColor=16777215,l.text="0%",l.y=180,l.horizontalCenter=0,e.loadGp.addChild(l),e.loadLabel=l;var s=new eui.Label;s.size=30,s.textColor=16777215,s.text=LoginUtil.getLoginJson(8),s.y=240,s.horizontalCenter=0,e.loadGp.addChild(s),e.loadGp.visible=!1}},e.prototype.initKefuBtn=function(){var e=this,t=new eui.Image;e.kefuBtn=t,e.addChild(e.kefuBtn),e.kefuBtn.touchEnabled=!0,e.kefuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenKefu,e),platform.loginKefuBtn(e.kefuBtn,e.loginGrp)},e.prototype.doClearCache=function(){console.log("执行清理缓存..."),window.doClearCache&&window.doClearCache()},e.prototype.initRewardGrp=function(){var e=this;if(!e.rewardGrp){e.rewardGrp=new egret.DisplayObjectContainer,e.rewardGrp.width=720,e.rewardGrp.height=250,e.addChild(e.rewardGrp);var t=LoginUtil.createBitmapByName("cjjl_font_cjjl_png");t.anchorOffsetX=.5*t.width,t.x=360,t.y=0,e.rewardGrp.addChild(t);var o=LoginUtil.createBitmapByName("cjjl_img_jb_png");o.x=84,o.y=120,e.rewardGrp.addChild(o);var n=LoginUtil.createBitmapByName("cjjl_img_zhmuj_png");n.anchorOffsetX=.5*n.width,n.x=.5*e.rewardGrp.width,n.y=120,e.rewardGrp.addChild(n);var r=LoginUtil.createBitmapByName("cjjl_img_vip_png");r.x=e.rewardGrp.width-r.width-84,r.y=120,e.rewardGrp.addChild(r),e.rewardGrp.anchorOffsetX=360,e.rewardGrp.x=.5*e.width,e.rewardGrp.y=e.newSerGrp.y-(e.rewardGrp.height+60),e.rewardGrp.visible=!1}},e.prototype.initNewSerGrp=function(){var e=this;if(!e.newSerGrp){e.newSerGrp=new egret.DisplayObjectContainer,e.newSerGrp.width=400,e.newSerGrp.height=65,e.addChild(e.newSerGrp),e.newSerGrp.touchEnabled=!0,e.newSerGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenServerView,e);var t=LoginUtil.createBitmapByName("dl_img_xzk_png");t.anchorOffsetX=.5*t.width,t.x=200,t.y=0,e.newSerGrp.addChild(t);var o=LoginUtil.accountData.newServer,n=new egret.TextField;n.text=o.ne,n.textColor=4925700,n.size=26,n.x=40,n.anchorOffsetY=13,n.y=.5*e.newSerGrp.height,e.newSerGrp.addChild(n);var r=LoginUtil.getLabelTag(o.label),i=LoginUtil.createBitmapByName(r);i.x=220,e.newSerGrp.addChild(i);var a=new egret.TextField;a.text=LoginUtil.getLoginJson(9),a.textColor=4925700,a.size=26,a.x=e.newSerGrp.width-78-40,a.anchorOffsetY=13,a.y=.5*e.newSerGrp.height,e.newSerGrp.addChild(a),e.newSerGrp.anchorOffsetX=200,e.newSerGrp.x=.5*e.width,e.newSerGrp.y=e.curSerGrp.y-(e.newSerGrp.height+15)}},e.prototype.initCurSerGrp=function(){var e=this;if(!e.curSerGrp){e.curSerGrp=new egret.DisplayObjectContainer,e.curSerGrp.width=400,e.curSerGrp.height=65,e.addChild(e.curSerGrp),e.curSerGrp.touchEnabled=!0,e.curSerGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenServerView,e);var t=LoginUtil.createBitmapByName("dl_img_xzk_png");t.anchorOffsetX=.5*t.width,t.x=200,t.y=0,e.curSerGrp.addChild(t);var o=LoginUtil.getLastServer();LoginUtil.accountData.lastServer=o;var n=new egret.TextField;n.text=o.ne,n.textColor=4925700,n.size=26,n.x=40,n.anchorOffsetY=13,n.y=.5*e.curSerGrp.height,e.curSerGrp.addChild(n),e.myServerText=n;var r=LoginUtil.getLabelTag(o.label),i=LoginUtil.createBitmapByName(r);i.x=220,e.curSerGrp.addChild(i),e.myServerTag=i;var a=new egret.TextField;a.text=LoginUtil.getLoginJson(10),a.textColor=4925700,a.size=26,a.x=e.curSerGrp.width-78-40,a.anchorOffsetY=13,a.y=.5*e.curSerGrp.height,e.curSerGrp.addChild(a),e.curSerGrp.anchorOffsetX=200,e.curSerGrp.x=.5*e.width,e.curSerGrp.y=e.loginGrp.y-(e.curSerGrp.height+15)}},e.prototype.initLoginGrp=function(){var e=this;if(!e.loginGrp){e.loginGrp=new egret.DisplayObjectContainer,e.loginGrp.width=327,e.loginGrp.height=105,e.addChild(e.loginGrp),e.loginGrp.touchEnabled=!0,e.loginGrp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.loginGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doLogin,e),e.loginGrp.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);var t=LoginUtil.createBitmapByName("cjjs_btn_cji_png");t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=163.5,t.y=52.5,e.loginGrp.addChild(t);var o=new egret.TextField;o.text=LoginUtil.getLoginJson(11),o.size=40,o.textColor=15590877,o.stroke=2,o.strokeColor=8605725,o.anchorOffsetX=80,o.anchorOffsetY=20,o.x=163.5,o.y=52.5,e.loginGrp.addChild(o),e.loginGrp.anchorOffsetX=163.5,e.loginGrp.x=.5*e.width,e.protocolGp?e.loginGrp.y=e.protocolGp.y-(e.loginGrp.height+15):e.loginGrp.y=e.aptImgY-(e.loginGrp.height+15)}},e.prototype.initProtocolGrp=function(){var e=this;if(!e.protocolGp){e.protocolGp=new egret.DisplayObjectContainer,e.protocolGp.height=44,e.addChild(e.protocolGp);var t=LoginUtil.createBitmapByName("com_img_gxdx2_png");t.anchorOffsetY=.5*t.height,t.y=22,t.x=0,e.protocolGp.addChild(t);var o=LoginUtil.createBitmapByName("com_img_gxddx2_png");o.anchorOffsetY=.5*o.height,o.y=22,o.x=0,o.visible=!1,e.protocolGp.addChild(o),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){o.visible=!0,t.visible=e.checkBool=!1},e),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){o.visible=!1,t.visible=e.checkBool=!0},e);var n=new egret.TextField;n.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(1)),n.size=22,n.textColor=3683118,n.anchorOffsetY=.5*n.height,n.y=22,n.x=t.width+5,e.protocolGp.addChild(n);var r=new egret.TextField;r.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(3)),r.size=22,r.textColor=6131223,r.anchorOffsetY=.5*r.height,r.y=22,r.x=n.width+n.x+5,e.protocolGp.addChild(r),e.protoText=r,e.protoText.touchEnabled=!0,e.protoText.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenDeal,e),e.protocolGp.x=(e.width-(t.width+n.width+r.width+10))/2,e.protocolGp.y=e.aptImgY-(e.protocolGp.height+5)}},e.prototype.doOpenDeal=function(){this.doProtoText();var e=LoginUtil.gameCfg.agreement?LoginUtil.gameCfg.agreement:"1";LoginUtil.httpEncryptRequest(LoginUtil.gameCfg.accURL+"/action/user/getValueBykey",{key:e},this.dealRes,this)},e.prototype.dealRes=function(e){if(0===e.s){for(var t=5,o=0,n=e.r.value.split("#@#@");o<n.length;o++){var r=n[o],i=new eui.Label;i.size=24,i.textColor=16771021,i.y=t,i.width=this.gpList.width,i.textFlow=(new egret.HtmlTextParser).parser(r),this.gpList.addChild(i),t+=i.height+5}this.protocolView&&(this.protocolView.visible=!0)}else console.error("账号服获取用户协议出错!")},e.prototype.doProtoText=function(){var e=this;if(e.protocolView)e.protocolView.visible=!0;else{e.protocolView=new egret.DisplayObjectContainer,e.protocolView.width=e.width,e.protocolView.height=e.height,e.addChild(e.protocolView);var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,e.protocolView.width,e.protocolView.height),t.graphics.endFill(),e.protocolView.addChild(t),e.protocolBg=t,e.protocolBg.touchEnabled=!0,e.protocolBg.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseProtocol,e);var o=new egret.DisplayObjectContainer,n=LoginUtil.createBitmapByName("com_img_tc2_png");o.width=n.width=588,o.height=n.height=800,n.scale9Grid=new egret.Rectangle(10,10,10,10),o.addChild(n);var r=new egret.TextField;r.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(5)),r.size=30,r.textColor=15848284,r.anchorOffsetX=.5*r.width,r.anchorOffsetY=.5*r.height,r.y=50,r.x=.5*n.width,o.addChild(r);var i=new eui.Scroller;i.width=560,i.height=690,i.anchorOffsetX=280,i.x=.5*o.width,i.y=n.height-i.height-10,i.scrollPolicyV=eui.ScrollPolicy.AUTO,i.scrollPolicyH=eui.ScrollPolicy.AUTO,e.gpList=new eui.Group,e.gpList.width=i.width,e.gpList.height=i.height,i.viewport=e.gpList,o.addChild(i),o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=.5*e.protocolView.width,o.y=.5*e.protocolView.height,e.gp=o,e.protocolView.addChild(o)}},e.prototype.doCloseProtocol=function(){this.gpList.removeChildren(),this.protocolView.visible=!1},e.prototype.initServerView=function(){var e=this;if(e.serverView)e.updateServerList();else{e.serverView=new egret.DisplayObjectContainer,e.serverView.width=e.width,e.serverView.height=e.height,e.addChild(e.serverView);var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,e.serverView.width,e.serverView.height),t.graphics.endFill(),e.serverView.addChild(t),e.serverBg=t,e.serverBg.touchEnabled=!0,e.serverBg.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseServerView,e);var o=new egret.DisplayObjectContainer;o.width=700,o.height=900,o.anchorOffsetX=350,o.anchorOffsetY=450,o.x=.5*e.serverView.width,o.y=.5*e.serverView.height,e.serverView.addChild(o);var n=LoginUtil.createBitmapByName("st_com_img_tckls_png");n.scale9Grid=new egret.Rectangle(42,25,2,2),n.width=660,n.height=836,n.anchorOffsetX=330,n.x=.5*o.width,n.y=40,o.addChild(n);var r=LoginUtil.createBitmapByName("dl_img_hw_png");r.anchorOffsetX=.5*r.width,r.x=.5*o.width,r.y=55,o.addChild(r);var i=LoginUtil.createBitmapByName("st_com_img_tcpt_png");i.anchorOffsetX=.5*i.width,i.x=.5*o.width,i.y=0,o.addChild(i);var a=new egret.TextField;a.text=LoginUtil.getLoginJson(12),a.size=30,a.textColor=4991236,a.anchorOffsetX=75,a.x=.5*o.width,a.y=15,o.addChild(a);var l=LoginUtil.createBitmapByName("st_com_btn_guanbi_png");l.anchorOffsetX=.5*l.width,l.anchorOffsetY=.5*l.height,l.x=o.width-.5*l.width,l.y=0+.5*l.height,o.addChild(l),e.closeServer=l,e.closeServer.touchEnabled=!0,e.closeServer.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.closeServer.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseServerView,e),e.closeServer.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);var s=new egret.DisplayObjectContainer;s.width=202,s.height=740,s.x=30,s.y=80,o.addChild(s);var c=LoginUtil.createBitmapByName("dl_img_yqd_png");s.addChild(c);for(var d=new eui.Scroller,g=new eui.Group,p={id:-1,name:LoginUtil.getLoginJson(13)},h=LoginUtil.accountData.pl,u=[p].concat(h),f=0,w=u.length;f<w;f++){var v=new ServerTab(u[f]);0==f?(v.selectTab(),e.curServerTab=v):v.unSelectTab(),g.addChild(v),v.touchEnabled=!0,v.addEventListener(egret.TouchEvent.TOUCH_TAP,e.clickServerTab,e),e.serverTabs.push(v)}var m=new eui.VerticalLayout;m.gap=10,m.verticalAlign=egret.VerticalAlign.TOP,m.horizontalAlign=egret.HorizontalAlign.CENTER,g.layout=m,d.viewport=g,d.width=196,d.height=740,d.x=3,d.y=0,s.addChild(d);var E=new egret.DisplayObjectContainer;E.width=422,E.height=734,E.x=240,E.y=85,o.addChild(E);var y=new eui.Scroller;e.serverScroller=y;var S=new eui.Group;e.serverScrollerGp=S;var L=new eui.VerticalLayout;L.gap=10,L.verticalAlign=egret.VerticalAlign.TOP,L.horizontalAlign=egret.HorizontalAlign.CENTER,S.layout=L,y.viewport=S,y.width=422,y.height=734,y.x=0,y.y=0,E.addChild(y);var _=new egret.DisplayObjectContainer;_.width=360,_.height=40,_.x=31,_.y=0,E.addChild(_),e.myServerLbGp=_;var A=LoginUtil.createBitmapByName("st_phb_img_fengexian1_png");A.anchorOffsetX=.5*A.width,A.anchorOffsetY=.5*A.height,A.scaleX=-1,A.width=100,A.x=-10,A.y=.5*_.height,_.addChild(A);var T=new egret.TextField;T.text=LoginUtil.getLoginJson(13),T.size=26,T.textColor=6574405,T.anchorOffsetX=65,T.anchorOffsetY=13,T.x=.5*_.width,T.y=.5*_.height,_.addChild(T);var C=LoginUtil.createBitmapByName("st_phb_img_fengexian1_png");C.anchorOffsetX=.5*C.width,C.anchorOffsetY=.5*C.height,C.width=100,C.x=370,C.y=.5*_.height,_.addChild(C),e.updateServerList(),e.serverView.visible=!1}},e.prototype.initNoticeView=function(){var e=this;if(!e.noticeView){e.noticeView=new egret.DisplayObjectContainer,e.noticeView.width=e.width,e.noticeView.height=e.height,e.addChild(e.noticeView);var t=new egret.Shape;platform.enableFunc(FunctionID.PC_ADAPTER)?t.graphics.beginFill(0,0):t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,e.noticeView.width,e.noticeView.height),t.graphics.endFill(),e.noticeView.addChild(t),e.noticeBg=t,e.noticeBg.touchEnabled=!0,e.noticeBg.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseNotice,e);var o=new egret.DisplayObjectContainer,n=LoginUtil.createBitmapByName("dl_img_ggt_png");o.width=n.width,o.height=n.height,o.addChild(n);var r=LoginUtil.createBitmapByName("st_com_btn_guanbi_png");r.anchorOffsetX=.5*r.width,r.anchorOffsetY=.5*r.height,r.x=o.width-.5*r.width,r.y=0+.5*r.height,o.addChild(r),e.closeNotice=r,e.closeNotice.touchEnabled=!0,e.closeNotice.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.closeNotice.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseNotice,e),e.closeNotice.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);var i=new eui.Scroller;i.width=560,i.height=480,i.anchorOffsetX=280,i.x=.5*o.width+10,i.y=370;var a=new eui.Group;i.viewport=a,o.addChild(i);var l=LoginUtil.createBitmapByName("st_dl_img_fbtd_png");l.anchorOffsetX=.5*l.width,l.x=.5*i.width,l.y=0,a.addChild(l);var s=new eui.Label;s.size=30,s.y=20,s.width=520,s.anchorOffsetX=260,s.x=.5*i.width,s.text="",a.addChild(s),e.noticeLb=s,o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=.5*e.noticeView.width,o.y=.5*e.noticeView.height,e.noticeView.addChild(o),e.noticeView.visible=!1}},e.prototype.initNoticeBtn=function(){var e=this,t=LoginUtil.createBitmapByName("dl_btn_gg_png");t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=80,t.y=80,e.noticeBtn=t,e.addChild(e.noticeBtn),e.noticeBtn.touchEnabled=!0,e.noticeBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.noticeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenNotice,e),e.noticeBtn.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e)},e.prototype.initBottom=function(){var e=this,t=LoginUtil.createBitmapByName("dl_fonts_dlwe_png");e.addChild(t),platform.enableFunc(FunctionID.PC_ADAPTER)?(t.width=720,t.x=(e.width-t.width)/2):(t.width=e.width,t.x=0),t.y=e.height-t.height,e.aptImg=t,e.aptImgY=t.y},e.prototype.doOpenKefu=function(){platform.fireEvent(FireEventType.CONVERSATION)},e.prototype.doOpenNotice=function(){this.initNoticeView();var e="id="+LoginUtil.gameCfg.noticeId;LoginUtil.httpNormalRequest(LoginUtil.gameCfg.accURL+LoginUtil.gameCfg.noticeURI,e,this.noticeRes,this)},e.prototype.noticeRes=function(e){0===e.s?(this.noticeLb.textFlow=(new egret.HtmlTextParser).parser(e.r),this.noticeView.visible=!0):console.error("账号服获取公告出错!")},e.prototype.doCloseNotice=function(){this.noticeView.visible=!1},e.prototype.doOpenServerView=function(){this.initServerView(),this.serverView.visible=!0},e.prototype.doCloseServerView=function(){this.serverView.visible=!1},e.prototype.clickServerTab=function(e){var t=this,o=e.currentTarget;if(o!==t.curServerTab){for(var n=0;n<t.serverTabs.length;n++){var r=t.serverTabs[n];o===r?(r.selectTab(),t.curServerTab=r):r.unSelectTab()}t.updateServerList()}},e.prototype.updateServerList=function(){var e=this;for(e.serverScroller.viewport.scrollV=0,e.serverScrollerGp.removeChildren();0<e.serverList.length;){e.serverList.pop().removeEventListener(egret.TouchEvent.TOUCH_TAP,e.selectServerLabel,e)}if(e.curServerTab){var t=e.curServerTab.data.id;e.serverScroller.height=-1==t?(e.myServerLbGp.visible=!0,e.serverScroller.y=50,685):(e.myServerLbGp.visible=!1,e.serverScroller.y=0,734);var o={uid:LoginUtil.accountData.uid,partitionId:e.curServerTab.data.id,channel:LoginUtil.gameCfg.channel,version:LoginUtil.gameCfg.version,idfa:LoginUtil.gameCfg.uuid};LoginUtil.httpEncryptRequest(LoginUtil.gameCfg.accURL+LoginUtil.gameCfg.serverGroupURI,o,e.zoneRes,e)}},e.prototype.zoneRes=function(e){if(0===e.s)for(var t=e.r,o=0,n=t.length;o<n;o++){var r=t[o],i=new ServerLabel(r);this.serverScrollerGp.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectServerLabel,this),this.serverList.push(i)}else console.error("分区服务器列表获取出错!")},e.prototype.selectServerLabel=function(e){var t=this,o=e.currentTarget;if(t.mySelectServer=o.data,t.myServerText.text=t.mySelectServer.ne,t.myServerTag&&t.myServerTag.parent){var n=t.myServerTag.parent,r=n.getChildIndex(t.myServerTag);n.removeChildAt(r);var i=LoginUtil.getLabelTag(t.mySelectServer.label);t.myServerTag=LoginUtil.createBitmapByName(i),t.myServerTag.x=220,n.addChildAt(t.myServerTag,r)}LoginUtil.accountData.lastServer=t.mySelectServer,t.doCloseServerView()},e.prototype.resetView=function(){var e=this;e.noticeView&&(e.noticeView.visible=!1),e.serverView&&(e.serverView.visible=!1),e.newSerGrp.visible=!0,e.curSerGrp.visible=!0,e.loginGrp.visible=!0,e.loadGp.visible=!1,e.kefuBtn.visible=!0,e.protocolGp&&(e.protocolGp.visible=!0),e.loadProcess.width=0,e.loadLabel.text="0%"},e.prototype.doLogin=function(){var o=this;if(o.checkBool){LoginUtil.recordData(GuildRecoordIndex2.record7),LoginUtil.dataPlacement(BuriedPoint.point12);var e=LoginUtil.accountData;e.reconnect=!1;var t=e.lastServer.label,n=e.isWhite;if(-1<t.indexOf("3")&&!n){!1;var r=e.lastServer.tips||e.serverNullTip;i=new LoginError(o.stage.stageWidth,o.stage.stageHeight,r);o.stage.addChild(i)}else o.initLoadGp(),o.newSerGrp.visible=!1,o.curSerGrp.visible=!1,o.loginGrp.visible=!1,o.loadGp.visible=!0,o.kefuBtn.visible=!1,o.protocolGp&&(o.protocolGp.visible=!1),LoginUtil.GameMain?(LoginUtil.setGameProcess(286,45,1,1),LoginUtil.GameMain.loadResConfig()):window.gameStar&&window.gameStar(function(e,t){LoginUtil.setGameProcess(286,45,e,t)},o,function(){var e=o.stage,t=new Main;e.addChild(t),LoginUtil.GameMain=t},o)}else{var i=new LoginError(o.stage.stageWidth,o.stage.stageHeight,LoginUtil.getLoginJson(2));o.stage.addChild(i)}},e.prototype.resetUI=function(){var e=this;e.width=e.stage.stageWidth,e.height=e.stage.stageHeight,e.loginGrp.x=.5*e.width,e.curSerGrp.x=.5*e.width,e.newSerGrp.x=.5*e.width,e.protocolGp.x=(e.width-e.protocolGp.width)/2,e.aptImg&&(e.aptImg.x=(e.width-e.aptImg.width)/2),e.loadGp&&(e.loadGp.x=.5*e.width),e.gp&&(e.gp.x=.5*e.width),e.protocolBg&&(e.protocolBg.graphics.clear(),e.protocolBg.graphics.beginFill(0,.5),e.protocolBg.graphics.drawRect(0,0,e.width,e.height),e.protocolBg.graphics.endFill())},e.prototype.onRemoveFromStage=function(){var e=this;for(e.kefuBtn&&e.kefuBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenKefu,e),e.noticeBtn&&e.noticeBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.noticeBtn&&e.noticeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenNotice,e),e.noticeBtn&&e.noticeBtn.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.closeNotice&&e.closeNotice.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.closeNotice&&e.closeNotice.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseNotice,e),e.closeNotice&&e.closeNotice.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.noticeBg&&e.noticeBg.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseNotice,e),e.newSerGrp&&e.newSerGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenServerView,e),e.curSerGrp&&e.curSerGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doOpenServerView,e),e.closeServer&&e.closeServer.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.closeServer&&e.closeServer.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseServerView,e),e.closeServer&&e.closeServer.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);0<e.serverTabs.length;){e.serverTabs.pop().removeEventListener(egret.TouchEvent.TOUCH_TAP,e.clickServerTab,e)}for(;0<e.serverList.length;){e.serverList.pop().removeEventListener(egret.TouchEvent.TOUCH_TAP,e.selectServerLabel,e)}e.serverBg&&e.serverBg.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doCloseServerView,e),e.loginGrp&&e.loginGrp.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.loginGrp&&e.loginGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doLogin,e),e.loginGrp&&e.loginGrp.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.clearCacheLb&&e.clearCacheLb.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doClearCache,e),e.protoText&&e.protoText.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doProtoText,e),e.kefuBtn=null,e.noticeBtn=null,e.noticeView=null,e.closeNotice=null,e.noticeBg=null,e.noticeLb=null,e.rewardGrp=null,e.newSerGrp=null,e.curSerGrp=null,e.myServerText=null,e.myServerTag=null,e.serverView=null,e.myServerLbGp=null,e.serverScroller=null,e.serverScrollerGp=null,e.closeServer=null,e.serverTabs=null,e.serverList=null,e.serverBg=null,e.curServerTab=null,e.mySelectServer=null,e.loadGp=null,e.loadProcess=null,e.loadLabel=null,e.clearCacheLb=null,LoginUtil.LoginUI=null,e.protocolGp=null,e.protocolView=null,e.protocolBg=null,e.protoText=null,e.gp=null,e.aptImg=null},e}(eui.Group);__reflect(LoginUI.prototype,"LoginUI");var LoginMain=function(o){function e(){var e=o.call(this)||this,t=e;return LoginUtil.LoginMain=t,LoginUtil.gameCfg=window._gameCfg_,t.initPlatform(),LoginUtil.recordData(GuildRecoordIndex2.record1),LoginUtil.dataPlacement(BuriedPoint.point2),t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.once(egret.Event.REMOVED_FROM_STAGE,t.onRemoveFromStage,t),e}return __extends(e,o),e.prototype.initPlatform=function(){if(!window.platform){var e=LoginUtil.gameCfg.platform;switch(console.log("platform:"+e),e){case PlatformAdapter.h5:window.platform=new H5Platform;break;case PlatformAdapter.wx:window.platform=new WxPlatform;break;case PlatformAdapter.ios:window.platform=new IosSHPlatform;break;case PlatformAdapter.vivo:window.platform=new VivoPlatform;break;case PlatformAdapter.android:window.platform=new AndroidNativePlatform;break;case PlatformAdapter.cx:window.platform=new CXPlatform;break;case PlatformAdapter.zj:window.platform=new ZJPlatform;break;case PlatformAdapter.bh:window.platform=new BHPlatform;break;case PlatformAdapter.qq:window.platform=new QQPlatform;break;case PlatformAdapter.awy:window.platform=new AwyPlatform;break;case PlatformAdapter.oppo:window.platform=new OppoPlatform;break;case PlatformAdapter.xiaomi:window.platform=new XiaomiPlatform;break;case PlatformAdapter.meizu:window.platform=new MeizuPlatform;break;case PlatformAdapter.baidu:window.platform=new BaiduPlatform;break;case PlatformAdapter.uc:window.platform=new UcPlatform;break;case PlatformAdapter.douyin:window.platform=new DouYinPlatform;break;case PlatformAdapter.fk:window.platform=new FkPlatform;break;default:window.platform=new DebugPlatform}platform.init()}},e.prototype.onAddToStage=function(){RES.registerVersionController(new StartVersionManager),eui.Label.default_fontFamily=window.family||"方正简体",egret.TextField.default_fontFamily=window.family||"方正简体",egret.ImageLoader.crossOrigin="anonymous",platform.enableFunc(FunctionID.PC_ADAPTER)?LoginUtil.startFullscreenAdaptation(this.stage,2276,1280,function(){}):LoginUtil.startFullscreenAdaptation(this.stage,720,1280,function(){}),this.start()},e.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var t,o;return __generator(this,function(e){switch(e.label){case 0:t=this,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,t.resPromise()];case 2:return e.sent(),[4,t.sdkPromise()];case 3:return e.sent(),platform.fireEvent(FireEventType.ANDROID_BGIMG,this.stage),t.loadSchedule(1,!0),t.accountReq(),[3,5];case 4:return o=e.sent(),console.error(o),[3,5];case 5:return[2]}})})},e.prototype.sdkPromise=function(){return new Promise(function(e,t){LoginUtil.recordData(GuildRecoordIndex2.record3),window.setloadtxt&&window.setloadtxt(LoginUtil.getLoginJson(17));var o=window.setInterval(function(){window.loginData&&(window.clearInterval(o),LoginUtil.sdkData=window.loginData,e(window.loginData))},10)})},e.prototype.resPromise=function(){return new Promise(function(t,e){LoginUtil.recordData(GuildRecoordIndex2.record2);var o="start.res.json?t="+LoginUtil.gameCfg.version;platform.enableFunc(FunctionID.RESOURCE_VER)&&(o=LoginUtil.gameCfg.version+o),RES.loadConfig(o,LoginUtil.gameCfg.resURL+"resource/").then(function(){RES.loadGroup("start").then(function(){var e=RES.getRes("login_json");LoginUtil.loginJson=e.login_local,console.log("登录资源加载完成"),t()})})})},e.prototype.accountReq=function(){window.setloadtxt&&window.setloadtxt(LoginUtil.getLoginJson(15)),null!=LoginUtil.LoginUI&&(this.stage.removeChild(LoginUtil.LoginUI),LoginUtil.LoginUI=null);var e={uid:LoginUtil.sdkData.uid,timestamp:LoginUtil.sdkData.timestamp,gameId:LoginUtil.gameCfg.gameId,channel:LoginUtil.gameCfg.channel,cid:LoginUtil.gameCfg.channel,version:LoginUtil.gameCfg.version,acc:LoginUtil.sdkData.acc,pwd:LoginUtil.sdkData.pwd,tokenid:LoginUtil.sdkData.tokenid,idfa:LoginUtil.gameCfg.uuid,noticeId:LoginUtil.gameCfg.noticeId};LoginUtil.dataPlacement(BuriedPoint.point7),LoginUtil.httpEncryptRequest(LoginUtil.gameCfg.accURL+LoginUtil.gameCfg.loginURI,e,this.accountRes,this)},e.prototype.accountRes=function(e){var t=this;if(LoginUtil.recordData(GuildRecoordIndex2.record4),0===e.s)if(LoginUtil.dataPlacement(BuriedPoint.point8),LoginUtil.recordData(GuildRecoordIndex2.record5),LoginUtil.accountData=e.r,LoginUtil.accountData.newServer)LoginUtil.accountData.channel=LoginUtil.gameCfg.channel,LoginUtil.accountData.token=e.r.key,LoginUtil.accountData.reconnect=!1,LoginUtil.accountData.reconnectNum=0,LoginUtil.accountData.reconnectMax=3,console.log("服务器服列表:",LoginUtil.accountData),LoginUtil.setFrame(LoginUtil.accountData.ua),t.createLoginUI();else{o=new LoginError(t.stage.stageWidth,t.stage.stageHeight,LoginUtil.accountData.serverNullTip,t.accountReq,t);t.stage.addChild(o)}else{console.error("获取服务器列表出错!",e);var o=new LoginError(t.stage.stageWidth,t.stage.stageHeight,LoginUtil.getLoginJson(16),t.accountReq,t);t.stage.addChild(o)}},e.prototype.createLoginUI=function(){var t=this;if(LoginUtil.accountData)if(window.removeLoading&&window.removeLoading(),LoginUtil.LoginUI)LoginUtil.LoginUI.resetView();else{var e=new LoginUI(t.stage.stageWidth,t.stage.stageHeight);if(e.horizontalCenter=0,e.verticalCenter=0,t.stage.addChild(e),"RealName"==LoginUtil.sdkData.ret){LoginUtil.sdkData.ret="";var o=new RealNameUI(t.stage.stageWidth,t.stage.stageHeight);o.horizontalCenter=0,o.verticalCenter=0,t.stage.addChild(o)}else if(LoginUtil.sdkData.delayTime&&0<LoginUtil.sdkData.delayTime)var n=window.setTimeout(function(){window.clearTimeout(n);var e=new RealNameUI(t.stage.stageWidth,t.stage.stageHeight);e.horizontalCenter=0,e.verticalCenter=0,t.stage.addChild(e)},6e4*LoginUtil.sdkData.delayTime)}else console.warn("accountData: ",LoginUtil.accountData)},e.prototype.onRemoveFromStage=function(){LoginUtil.LoginMain=null},e.prototype.loadSchedule=function(e,t){void 0===t&&(t=!1),window.FirstLoading&&window.FirstLoading.instance.schedule&&window.FirstLoading.instance.schedule(e,t)},e}(egret.DisplayObjectContainer);__reflect(LoginMain.prototype,"LoginMain");var StartVersionManager=function(){function e(){}return e.prototype.init=function(){return Promise.resolve()},e.prototype.getVirtualUrl=function(e){return-1!=e.indexOf("resource/start.res.json")?e:-1!=e.indexOf("resource/default.res.json")?e:e+"?t="+LoginUtil.gameCfg.version},e}();__reflect(StartVersionManager.prototype,"StartVersionManager",["RES.IVersionController"]);var RealNameUI=function(r){function e(e,t){var o=r.call(this)||this,n=o;return n.name="RealNameUI",n.width=e,n.height=t,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.once(egret.Event.REMOVED_FROM_STAGE,n.onRemoveFromStage,n),o}return __extends(e,r),e.prototype.onAddToStage=function(){var e=this,t=new egret.DisplayObjectContainer;t.width=e.width,t.height=e.height,e.addChild(t);var o=new egret.Shape;o.graphics.beginFill(0,.5),o.graphics.drawRect(0,0,t.width,t.height),o.graphics.endFill(),t.addChild(o),(e.bg=o).touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e);var n=new eui.Group;n.width=640,n.height=500,n.x=(t.width-n.width)/2,n.y=(t.height-n.height)/2,t.addChild(n);var r=LoginUtil.createBitmapByName("st_com_img_tckls_png");r.scale9Grid=new egret.Rectangle(42,25,2,2),r.width=n.width-20,r.height=n.height,r.y=10,r.x=10,n.addChild(r);var i=LoginUtil.createBitmapByName("st_com_img_tcpt_png");i.width=n.width,n.addChild(i);var a=new egret.TextField;a.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(18)),a.size=30,a.textColor=4991236,a.anchorOffsetX=.5*a.width,a.x=.5*n.width,a.y=15,n.addChild(a);var l=LoginUtil.createBitmapByName("st_com_btn_guanbi_png");l.anchorOffsetX=.5*l.width,l.anchorOffsetY=.5*l.height,l.x=n.width-.5*l.width,l.y=.5*l.height,n.addChild(l),e.closeBtn=l,e.closeBtn.touchEnabled=!0,e.closeBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.closeBtn.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);var s=new egret.TextField;s.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(19)),s.size=26,s.textColor=4991236,s.x=50,s.y=i.height-20,n.addChild(s);var c=e.teInput(n.width-100,60,50,s.y+s.height+10,LoginUtil.getLoginJson(20),0);n.addChild(c);var d=new egret.TextField;d.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(22)),d.size=26,d.textColor=4991236,d.x=50,d.y=c.y+c.height+30,n.addChild(d);var g=e.teInput(n.width-100,60,50,d.y+d.height+10,LoginUtil.getLoginJson(23),1);n.addChild(g),e.cancelGp=new eui.Group,n.addChild(e.cancelGp),e.height=0,e.width=0,e.cancelGp.touchEnabled=!0,e.cancelGp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.cancelGp.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.cancelGp.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);var p=LoginUtil.createBitmapByName("com_btn_red_1_png");e.cancelGp.addChild(p);var h=new egret.TextField;h.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(24)),h.size=26,h.textColor=15590877,h.stroke=2,h.strokeColor=8605725,h.x=(p.width-h.width)/2,h.y=(p.height-h.height)/2,e.cancelGp.addChild(h),e.cancelGp.x=(n.width-p.width)/4,e.cancelGp.y=g.y+g.height+50,e.confirmGp=new eui.Group,n.addChild(e.confirmGp),e.height=0,e.width=0,e.confirmGp.touchEnabled=!0,e.confirmGp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.confirmGp.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doconfirmGp,e),e.confirmGp.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e);var u=LoginUtil.createBitmapByName("com_btn_yellow_1_png");e.confirmGp.addChild(u);var f=new egret.TextField;f.textFlow=(new egret.HtmlTextParser).parser(LoginUtil.getLoginJson(21)),f.size=26,f.textColor=15590877,f.stroke=2,f.strokeColor=8605725,f.x=(p.width-f.width)/2,f.y=(p.height-f.height)/2,e.confirmGp.addChild(f);var w=(n.width-u.width)/2;e.confirmGp.x=w+w/2,e.confirmGp.y=g.y+g.height+50;var v=LoginUtil.createBitmapByName("com_btn_fanhui_png");n.addChild(v),v.x=n.width-v.width-10,v.y=n.height-v.height+10,e.retBtn=v,e.retBtn.touchEnabled=!0,e.retBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.retBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.retBtn.addEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e)},e.prototype.doconfirmGp=function(){if(window.ShSdk&&window.ShSdk.realName){var e=this.nameInput.text.trim(),t=this.cardInput.text.trim();window.ShSdk.realName(e,t,function(e){console.log("实名认证返回",e)})}},e.prototype.teInput=function(e,t,o,n,r,i){var a=new eui.Group;a.width=e,a.height=t,a.x=o,a.y=n;var l=LoginUtil.createBitmapByName("jgg_img_shurukuang_png");l.scale9Grid=new egret.Rectangle(9,9,30,31),l.width=a.width,l.height=a.height,a.addChild(l);var s=new egret.TextField;a.addChild(s),s.textFlow=(new egret.HtmlTextParser).parser(r),s.size=20,s.textColor=16777215,s.x=(a.width-s.width)/2,s.y=(a.height-s.height)/2;var c=new egret.TextField;return a.addChild(c),c.type=egret.TextFieldType.INPUT,c.size=20,c.verticalAlign="middle",c.width=a.width-30,c.height=a.height,c.x=15,c.textColor=6710886,0==i?this.nameInput=c:this.cardInput=c,c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.FOCUS_IN,function(){s.visible=!1},this),c.addEventListener(egret.TouchEvent.FOCUS_OUT,function(){""==c.text&&(s.visible=!0)},this),a},e.prototype.doClose=function(){this.parent.removeChild(this)},e.prototype.onRemoveFromStage=function(){var e=this;e.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.bg.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.cancelGp.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.cancelGp.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.cancelGp.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.confirmGp.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.confirmGp.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doconfirmGp,e),e.confirmGp.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.retBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,LoginUtil.minifyBtn,e),e.retBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.doClose,e),e.retBtn.removeEventListener(egret.TouchEvent.TOUCH_END,LoginUtil.restoreBtn,e),e.closeBtn=null,e.bg=null,e.cancelGp=null,e.confirmGp=null,e.retBtn=null,e.nameInput=null,e.cardInput=null},e}(eui.Group);__reflect(RealNameUI.prototype,"RealNameUI");var FunctionID=function(){function e(){}return e.DISABLE_FIGHT_TEST=1e4,e.LOGIN_LOADING=10001,e.LOGIN_RANDOM_IMG=10002,e.SHIELD_RECHARGE=10003,e.SHIELD_SHARE=10004,e.SHIELD_FOLLOW=10005,e.AUTHORIZATION=10006,e.ADDMINI=10007,e.FOLLOW_WIN=10008,e.SUBMITTED_LINKS=10009,e.SUBSCRIBE_MESSAGE=10011,e.ANDORID_NATIVE=10012,e.ANDORID_NATIVE_3K=10013,e.KEFU_VIEW=10014,e.MICRO_PACKAGE_3K=10015,e.REAL_NAME=10016,e.BIND_PHONE=10017,e.SHIELD_RANKBTN=10018,e.SHIELD_KEFUBTN=10019,e.MINI_GAMES=10020,e.OFFLINE_WINDOW=10021,e.RESOURCE_VER=10022,e.SHIELD_INVITE=10023,e.AWY_ATTENTION=10024,e.AWY_REALNAME=10025,e.WAR_PASS=10026,e.AWY_CHAT=10027,e.PC_ADAPTER=10028,e.CLOSE_ATTENTION_BTN=10029,e.CLOSE_KEFU_BTN=10030,e.CLOSE_KEFUBTN_OPEN_COPY=10031,e.WX_SILANG_REWARD=10032,e.OPEN_SHIELD_FOLLOW_BTN=10033,e.CHECKWORD=10034,e.TIKTOK_BTN=10035,e.ADD_DESKTOP=10036,e.ATTENTION_TIPLB=10037,e.ATTENTION_REWARD=10038,e}();__reflect(FunctionID.prototype,"FunctionID");var PlatformAdapter=function(){function t(){this.sdkuser=void 0,this.disableArray=[]}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){e({nickName:"username"})})]})})},t.prototype.showLoading=function(e){},t.prototype.hideLoading=function(){},t.prototype.init=function(){var e=this;return e.disableArray.push(FunctionID.DISABLE_FIGHT_TEST),e.disableArray.push(FunctionID.AUTHORIZATION),e.disableArray.push(FunctionID.SHIELD_FOLLOW),e.disableArray.push(FunctionID.ADDMINI),e.disableArray.push(FunctionID.SUBSCRIBE_MESSAGE),e.disableArrayPash(FunctionID.REAL_NAME),e.disableArrayPash(FunctionID.BIND_PHONE),e.disableArrayPash(FunctionID.AWY_ATTENTION),e.disableArrayPash(FunctionID.PC_ADAPTER),e.disableArrayPash(FunctionID.OPEN_SHIELD_FOLLOW_BTN),e.disableArrayPash(FunctionID.CHECKWORD),e.disableArrayPash(FunctionID.TIKTOK_BTN),e.disableArrayPash(FunctionID.ADD_DESKTOP),e.disableArrayPash(FunctionID.ATTENTION_REWARD),!0},t.prototype.idfaGenerate=function(){return window._gameCfg_.uuid},t.prototype.loginSdk=function(){return null},t.prototype.getOs=function(){var e=egret.Capabilities.os;return-1===(e=e.toLowerCase()).indexOf("ios")?t.SYS_ANDROID:t.SYS_IOS},t.prototype.pay=function(e,t){},t.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return Promise.resolve()},t.prototype.copyToClipboard=function(e){var t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("Copy"),document.body.removeChild(t)},t.prototype.playEffect=function(e,t){t.play(e)},t.prototype.playBg=function(e,t){t.play(e)},t.prototype.stopBg=function(e,t){t.stop()},t.prototype.disableArrayPash=function(e){-1==this.disableArray.indexOf(e)&&this.disableArray.push(e)},t.prototype.enableFunc=function(e){return-1==this.disableArray.indexOf(e)},t.prototype.getInitQuery=function(){},t.prototype.clearCache=function(){},t.prototype.adapterFix=function(e){if(e){var t=App.StageUtils.getWidth(),o=App.StageUtils.getHeight();if(!(.5<=t/o)){var n=e;n.y=50,n.percentHeight=Math.floor((o-50)/o*1e4)/100}}},t.prototype.saveLocalData=function(e,t){egret.localStorage.setItem(e,t)},t.prototype.getLocalDataByKey=function(e){return egret.localStorage.getItem(e)},t.prototype.removeLocalData=function(e){egret.localStorage.removeItem(e)},t.prototype.spliceArr=function(e){for(var t=0;t<this.disableArray.length;t++)e==this.disableArray[t]&&(this.disableArray.splice(t,1),console.log("删除",e))},t.prototype.clickRefresh=function(){LoginUtil.refresh(),platform.fireEvent(FireEventType.LOGOUT)},t.prototype.refreshBtnRename=function(e){},t.prototype.loginKefuBtn=function(e,t){},t.prototype.sVipBtn=function(){},t.prototype.subscribeConnectGrp2=function(e){},t.prototype.initMv=function(){},t.prototype.triggerEnterGame=function(){return!1},t.wx="wxgame",t.qq="qqgame",t.cx="cx",t.zj="zj",t.bh="bh",t.android="android",t.h5="h5",t.fanti="fanti",t.debug="debug",t.ios="ios",t.vivo="vivo",t.awy="awy",t.oppo="oppo",t.xiaomi="xiaomi",t.meizu="meizu",t.baidu="baidu",t.uc="uc",t.douyin="douyin",t.fk="fk",t.SYS_ANDROID=1,t.SYS_IOS=2,t}();__reflect(PlatformAdapter.prototype,"PlatformAdapter",["Platform"]);var DebugPlatform=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){return e.prototype.init.call(this),this.spliceArr(FunctionID.DISABLE_FIGHT_TEST),this.disableArrayPash(FunctionID.SHIELD_SHARE),this.spliceArr(FunctionID.SHIELD_FOLLOW),this.spliceArr(FunctionID.ADDMINI),this.spliceArr(FunctionID.REAL_NAME),this.spliceArr(FunctionID.BIND_PHONE),egret.Capabilities.isMobile||this.spliceArr(FunctionID.PC_ADAPTER),!0},t.prototype.showLoading=function(e){window.setloadtxt(e)},t.prototype.hideLoading=function(){window.removeLoading()},t.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];switch(e){case FireEventType.REALNAME:this.realname(t[0],t[1]);break;case FireEventType.BINDPHONE:this.bindphone(t[0],t[1]);break;case FireEventType.LOGINERROR:var n=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},this);App.StageUtils.getStage().addChild(n)}return Promise.resolve()},t.prototype.bindphone=function(e,t){e.call(t)},t.prototype.realname=function(e,t){e.call(t)},t}(PlatformAdapter);__reflect(DebugPlatform.prototype,"DebugPlatform");var AndroidNativePlatform=function(o){function e(){var e=null!==o&&o.apply(this,arguments)||this;return e.androidBg=!1,e}return __extends(e,o),e.prototype.init=function(){o.prototype.init.call(this);var t=this;switch(LoginUtil.gameCfg.gameId){case"PM001495":t.disableArrayPash(FunctionID.ANDORID_NATIVE);break;case"PM001510":t.disableArrayPash(FunctionID.KEFU_VIEW),t.disableArrayPash(FunctionID.ANDORID_NATIVE_3K);break;case"PM001796":t.disableArrayPash(FunctionID.KEFU_VIEW)}return egret.ExternalInterface.addCallback("loginSdkSuccess",function(e){window.loginData=JSON.parse(e)}),egret.ExternalInterface.addCallback("onRefresh",function(e){t.refresh(e)}),egret.ExternalInterface.addCallback("payResult",function(e){switch(e){case"0":console.log("支付完成"),Toast.showTipsDownToUp("充值成功!");break;default:console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0)}}),egret.ExternalInterface.call("sdkLogin",""),!0},e.prototype.refresh=function(e){window.loginData=void 0,LoginUtil.GameMain&&LoginUtil.refresh(),"true"!=e&&egret.ExternalInterface.call("sdkLogin","")},e.prototype.pay=function(e,t){var o=e.r,n=o+"|"+100*Number(t.money)+"|"+t.orderName+"|"+t.roleName+"|"+t.roleLevel+"|"+t.aid+"|"+t.serName+"|"+t.serid+"|"+t.orderName+"|"+t.orderName+"|"+o+"|"+t.uid.split("_")[1];egret.ExternalInterface.call("pay",n)},e.prototype.copyToClipboard=function(e){egret.ExternalInterface.call("copyToClipboard",e)},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.LOGOUT:r.logout();break;case FireEventType.ANDROID_BGIMG:r.androidBgImg(t[0]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.androidBgImg=function(r){var i=this,a=this;if(!a.androidBg){var e=a.androidBgPath();a.androidBg=!0,RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/"+e[0]+"?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e);t.height=r.stageHeight,t.width=r.stageWidth,r.addChildAt(t,0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){a.sdkLogin()},i)},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/"+e[1]+"?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e),o=r.stageHeight,n=r.stageWidth;t.height=1280<o?1280:o,t.width=720<n?720:n,t.x=(n-t.width)/2,t.y=(o-t.height)/2,r.addChildAt(t,1),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){a.sdkLogin()},i),egret.ExternalInterface.call("hideLoadPage","")},this,RES.ResourceItem.TYPE_IMAGE)}},e.prototype.androidBgPath=function(){var e=[];if(!LoginUtil.sdkData.ext||!LoginUtil.sdkData.ext.kkkchannelid)return e[0]="dl_bg_dqdt.jpg",e[1]="dl_bg_dqrw.png",e;switch(LoginUtil.sdkData.ext.kkkchannelid){case"29752":e[0]="dl_bg_dqdt29604.jpg",e[1]="dl_bg_dqrw29604.png";break;default:e[0]="dl_bg_dqdt.jpg",e[1]="dl_bg_dqrw.png"}return e},e.prototype.sdkLogin=function(){null==window.loginData&&(console.log("重新调起登录弹窗"),egret.ExternalInterface.call("sdkLogin",""))},e.prototype.conversation=function(){egret.ExternalInterface.call("showCustomerService","")},e.prototype.logout=function(){},e.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();if(o){var n=App.ControllerManager.getControllerModel(CtrlConst.Legion),r=(n.info,""),i="";n.info&&(r=n.info.n,i=n.info.id);var a={LegionName:r,LegionId:i,power:o.role_power},l=o.role_id+"|"+o.role_name+"|"+o.role_level+"|"+o.server_id+"|"+o.server_name+"|"+o.has_gold+"|"+o.vip_level+"|"+o.create_time+"|"+JSON.stringify(a);switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),this.shieldKefubtn(),egret.ExternalInterface.call("uploadRole","101|"+l));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),this.shieldKefubtn(),egret.ExternalInterface.call("uploadRole","102|"+l);break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),egret.ExternalInterface.call("uploadRole","103|"+l)}}else console.error("角色数据为空，角色上报失败")},e.prototype.shieldKefubtn=function(){LoginUtil.sdkData.ext&&LoginUtil.sdkData.ext.kkkchannelid&&"30403"==LoginUtil.sdkData.ext.kkkchannelid&&this.disableArrayPash(FunctionID.SHIELD_KEFUBTN)},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),"BargainGiftView"==n?(egret.ExternalInterface.call("originalShareImage","https://premixsdk.921.com/h5plat/play/package_code/P0007461?yqm_code="+e.toString(16)),App.TimerManager.doTimer(5e3,1,function(){t.call(o)},this)):t.call(o)},e.prototype.clickRefresh=function(){if(LoginUtil.sdkData.ext&&LoginUtil.sdkData.ext.guid){var e=LoginUtil.sdkData.ext.guid;platform.copyToClipboard(e),Toast.showTipsDownToUp(App.tr(20419,e))}else console.log("绑定ID为空")},e.prototype.refreshBtnRename=function(e){e.label=App.tr(23330),e.size="22"},e.prototype.triggerEnterGame=function(){return"PM001796"==LoginUtil.gameCfg.gameId},e}(PlatformAdapter);__reflect(AndroidNativePlatform.prototype,"AndroidNativePlatform");var WxPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e.showRealnameIcon=!1,e.attention=0,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.wx.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);var e=this;return window.ShSdk.share(function(){}),e.spliceArr(FunctionID.ADDMINI),e.spliceArr(FunctionID.SUBSCRIBE_MESSAGE),e.disableArrayPash(FunctionID.FOLLOW_WIN),e.disableArrayPash(FunctionID.KEFU_VIEW),e.disableArrayPash(FunctionID.MINI_GAMES),e.disableArrayPash(FunctionID.OFFLINE_WINDOW),e.disableArrayPash(FunctionID.RESOURCE_VER),e.constSid(),console.log("wx platform init success"),!0},e.prototype.getRealnameInfo=function(){var t=this;window.ShSdk.getRealnameInfo&&window.ShSdk.getRealnameInfo(function(e){if(e.data&&e.data.msg){if(t.realNameVal=e.data.msg.realname,t.showRealnameIcon=!t.realNameVal,!t.showRealnameIcon)App.ControllerManager.getControllerModel(CtrlConst.WeiXinAct).notify();App.ControllerManager.applyFunc(CtrlConst.Login,LoginConst.AVATAR_REAL_NAME_REWARD_REQ)}})},e.prototype.constSid=function(){switch(LoginUtil.gameCfg.gameId){case"P0007005":case"P0007006":this.disableArrayPash(FunctionID.SHIELD_SHARE);break;case"P0008471":case"P0008472":this.spliceArr(FunctionID.KEFU_VIEW),this.disableArrayPash(FunctionID.ADDMINI)}this.sid=LoginUtil.gameCfg.sid},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o};window.ShSdk.pay(n,function(e){if("RealName"==e.ret){var t=App.StageUtils.getStage(),o=new RealNameUI(t.stageWidth,t.stageHeight);o.horizontalCenter=0,o.verticalCenter=0,t.addChild(o)}"SUCCESS"==e.ret?(console.log("支付完成"),window.wx.showModal({title:"支付成功",content:"支付成功"})):"YD_TIPS"==e.ret?window.wx.showModal({title:"温馨提示",content:e.msg}):"NOT_ALLOW"==e.ret?window.wx.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.SUBSCRIBE_MSG:r.subscribeMsg(t[0]);break;case FireEventType.BIND_BARGAIN:n=r.bindBargain();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.SUBSCRIBE:r.subscribe(t[0],t[1]);break;case FireEventType.CREATEAUTHBUTTON:r.createAuthButton(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.GOREALNAME:r.goRealname();break;case FireEventType.SVIPBUTTONEVENT:r.svipButtonEvent();break;case FireEventType.SUBSCRIBECOPY:r.subscribeCopy();break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.goRealname=function(){window.ShSdk.goRealname(function(e){console.log("实名认证",e)})},e.prototype.bindBargain=function(){return new Promise(function(e,t){var o=window.wx.getLaunchOptionsSync().query;console.log("启动参数:",o),e(o.aid)})},e.prototype.subscribeMsg=function(e){console.log("订阅参数：",e),window.ShSdk.requestSubscribeMessage(e,function(e){console.log("订阅回调",e)})},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var e=Math.random();console.log("开始更新背景图");var t=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+e,o=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+e,n=LoginUtil.gameCfg.logoPath+"?v="+e;if(LoginUtil.gameCfg.bgPath&&LoginUtil.gameCfg.modelPath&&(t=LoginUtil.gameCfg.bgPath+"?v="+e,o=LoginUtil.gameCfg.modelPath+"?v="+e),LoginUtil.gameCfg.logoPath){var r=window.wx.env.USER_DATA_PATH+"/special/logo.png";this.downLoadBg(n,r)}var i=window.wx.env.USER_DATA_PATH+"/special/dl_bg_dqdt.jpg";this.downLoadBg(t,i);var a=window.wx.env.USER_DATA_PATH+"/special/dl_bg_dqrw.png";this.downLoadBg(o,a)},e.prototype.downLoadBg=function(t,o){var n=window.wx.getFileSystemManager();window.wx.downloadFile({url:t,success:function(e){e.tempFilePath?n.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){}}):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.subscribe=function(t,o){var e=LoginUtil.gameCfg.gameId;"P0007947"==e||"P0007946"==e?this.attention&&1==this.attention&&t.call(o):window.ShSdk.subscribe&&window.ShSdk.subscribe(function(e){console.log("公众号关注状态获取结果",e),1==e.subscribe&&t.call(o)})},e.prototype.createAuthButton=function(t,o,e,n,r,i,a,l){void 0===l&&(l=!1);var s=this;s.authButton&&s.authButton.destroy();var c=App.StageUtils.getWidth(),d=App.StageUtils.getHeight(),g=s.converGameWidthToWx(c,r),p=s.converGameHeightToWx(d,i),h=s.converGameWidthToWx(c,e),u=s.converGameHeightToWx(d,n),f=window.wx.createUserInfoButton({type:"image",image:LoginUtil.gameCfg.resURL+"resource/special/"+a,style:{left:h,top:u,width:g,height:p,lineHeight:0,backgroundColor:"",color:"",textAlign:"center",fontSize:0,borderRadius:0},withCredentials:!0});(s.authButton=f).onTap(function(e){e&&e.userInfo?(window.ShSdk.unionId&&window.ShSdk.unionId(e),platform.getUserInfo().then(function(){console.log("玩家已授权，关闭授权按钮"),s.disableArrayPash(FunctionID.AUTHORIZATION),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),t.call(o)})):l&&(console.log("用户取消授权",e),t.call(o))})},e.prototype.converGameWidthToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowWidth/e},e.prototype.converGameHeightToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowHeight/e},e.prototype.updateRole=function(e){var t=Promise.resolve(),o=this,n=App.ControllerManager.getControllerModel(CtrlConst.Avatar),r=n.getRoleInfo();switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(t,e){window.ShSdk.createRole(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.disableArrayPash(FunctionID.SHIELD_RECHARGE):e.data.msg.sp||o.disableArrayPash(FunctionID.SHIELD_RECHARGE),e.data.msg.follow||o.spliceArr(FunctionID.SHIELD_FOLLOW),o.showRealnameIcon=e.data.msg.show_realname,o.AuthState(),o.realnameInfo(),o.shieldFollw(r),t()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(t,e){window.ShSdk.enterGame(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.disableArrayPash(FunctionID.SHIELD_RECHARGE):e.data.msg.sp||o.disableArrayPash(FunctionID.SHIELD_RECHARGE),e.data.msg.follow||o.spliceArr(FunctionID.SHIELD_FOLLOW),o.showRealnameIcon=e.data.msg.show_realname,o.AuthState(),o.realnameInfo(),o.shieldFollw(r),t()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.disableArrayPash(FunctionID.SHIELD_RECHARGE):e.data.msg.sp?o.spliceArr(FunctionID.SHIELD_RECHARGE):o.disableArrayPash(FunctionID.SHIELD_RECHARGE)}),o.shieldFollw(r)}return t},e.prototype.realnameInfo=function(){var o=this;this.getRealnameInfo(),window.wx.onShow(function(e){console.log("获取实名验证信息：",e);var t=LoginUtil.gameCfg.gameId;if("P0007947"==t||"P0007946"==t){if(e.query&&e.query.attention){if(o.attention=e.query&&e.query.attention,o.realNameVal=o.attention&&1==o.attention,o.showRealnameIcon=!o.realNameVal,!o.showRealnameIcon)App.ControllerManager.getControllerModel(CtrlConst.WeiXinAct).notify();App.ControllerManager.applyFunc(CtrlConst.Login,LoginConst.AVATAR_REAL_NAME_REWARD_REQ)}}else o.getRealnameInfo()})},e.prototype.AuthState=function(){var t=this;window.wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(console.log("玩家已经授权，关闭授权按钮"),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ)):(console.log("玩家未授权，开启授权按钮"),t.spliceArr(FunctionID.AUTHORIZATION))}})},e.prototype.share=function(e,t,o,n){var r=(new Date).getTime();"ShareView"==n&&(r-=3e3),window.wx.setStorage({key:"share_time",data:r});var i="";if("BargainGiftView"==n){var a=LoginUtil.gameCfg.resURL+"resource/special/fxt_kjlb.jpg?v="+Math.random();i="aid="+e+"&share_title="+App.tr(23086)+"&share_img="+a+"'"}window.ShSdk.goShare(i),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.conversation=function(){var e=LoginUtil.gameCfg.gameId;"P0007947"==e||"P0007946"==e?window.ShSdk.customerService():window.wx.openCustomerServiceConversation()},e.prototype.clearCache=function(){window.wx.showLoading({title:"缓存清理中..."}),window.wx.getFileSystemManager().rmdir({dirPath:window.wx.env.USER_DATA_PATH+"/resource",recursive:!0,success:function(){console.log("删除本地缓存成功~"),window.wx.hideLoading(),window.wx.showModal({title:"提示",content:"缓存清理成功,请重新进入小程序!",showCancel:!1,success:function(e){e.confirm&&window.wx.exitMiniProgram({})}})},fail:function(){console.log("删除本地缓存失败~")}})},e.prototype.loginKefuBtn=function(t,o){var e=LoginUtil.gameCfg.gameId;if("P0007947"==e||"P0007946"==e){var n=LoginUtil.gameCfg.resURL+"resource/special/kefu.png";RES.getResByUrl(n,function(e){t&&o&&(t.source=e,t.scaleX=.6,t.scaleY=.6,t.x=o.x+o.width/2,t.y=o.y-31)},this,RES.ResourceItem.TYPE_IMAGE)}},e.prototype.sVipBtn=function(){var e=LoginUtil.gameCfg.gameId;"P0007947"!=e&&"P0007946"!=e||window.ShSdk.checkSvip(function(o){console.log("checkSvip",o),window.ShSdk.isSvipUser(function(e){if(console.log("isSvipUser",e),o.data.isOpen&&e.data.isExist){if(GameUtils.svip)GameUtils.svip.visible=!0;else{GameUtils.initSvip();var t=LoginUtil.gameCfg.resURL+"resource/special/svip.png";GameUtils.svip.source=t}GameUtils.svip&&!LayerManager.UI_Tips.contains(GameUtils.svip)&&LayerManager.UI_Tips.addChild(GameUtils.svip)}else GameUtils.svip&&LayerManager.UI_Tips.contains(GameUtils.svip)&&(GameUtils.svip.visible=!1)})})},e.prototype.svipButtonEvent=function(){var e=LoginUtil.gameCfg.gameId;"P0007947"!=e&&"P0007946"!=e||window.ShSdk.isSvipUser(function(e){console.log("检测当前SVIP状态返回数据",e),e.data.isExist&&window.wx.previewImage({urls:[e.data.wxurl]})})},e.prototype.subscribeConnectGrp2=function(e){var t=LoginUtil.gameCfg.gameId;"P0007947"!=t&&"P0007946"!=t||(e.width=274,this.spliceArr(FunctionID.OPEN_SHIELD_FOLLOW_BTN))},e.prototype.subscribeCopy=function(){var e=LoginUtil.gameCfg.gameId;"P0007947"!=e&&"P0007946"!=e||platform.copyToClipboard(App.tr(50121))},e.prototype.shieldFollw=function(e){var t=LoginUtil.gameCfg.gameId,o=this;"P0007947"==t||"P0007946"==t?10<=e.role_level?(o.disableArrayPash(FunctionID.CLOSE_KEFU_BTN),o.disableArrayPash(FunctionID.CLOSE_KEFUBTN_OPEN_COPY),o.spliceArr(FunctionID.SHIELD_FOLLOW)):o.disableArrayPash(FunctionID.SHIELD_FOLLOW):"P0008471"!=t&&"P0008472"!=t||o.disableArrayPash(FunctionID.SHIELD_FOLLOW)},e}(PlatformAdapter);__reflect(WxPlatform.prototype,"WxPlatform");var BHPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.wx.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);var e=this;return window.ShSdk.share(function(){}),e.spliceArr(FunctionID.ADDMINI),e.spliceArr(FunctionID.SUBSCRIBE_MESSAGE),e.disableArrayPash(FunctionID.FOLLOW_WIN),e.disableArrayPash(FunctionID.MINI_GAMES),e.disableArrayPash(FunctionID.OFFLINE_WINDOW),e.disableArrayPash(FunctionID.RESOURCE_VER),e.constSid(),console.log("wx platform init success"),!0},e.prototype.constSid=function(){switch(LoginUtil.gameCfg.gameId){case"P0007429":case"P0007430":case"P0007804":case"P0007803":this.spliceArr(FunctionID.SHIELD_FOLLOW),this.disableArrayPash(FunctionID.ATTENTION_TIPLB),this.disableArrayPash(FunctionID.CLOSE_ATTENTION_BTN)}this.sid=LoginUtil.gameCfg.sid},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,has_gold:t.hasGold,vip_level:t.vipLevel,ext:""+o};window.ShSdk.pay(n,function(e){var t=LoginUtil.gameCfg.gameId;if(("P0007801"==t||"P0007802"==t||"P0007803"==t||"P0007804"==t)&&"RealName"==e.ret){var o=LoginUtil.LoginMain,n=new RealNameUI(o.stage.stageWidth,o.stage.stageHeight);return n.horizontalCenter=0,n.verticalCenter=0,o.stage.addChild(n),void console.log("未实名-调起实名")}"SUCCESS"==e.ret?(console.log("支付完成"),window.wx.showModal({title:"支付成功",content:"支付成功"})):"NOT_ALLOW"==e.ret?window.wx.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.BIND_BARGAIN:r.bindBargain();break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.CREATEAUTHBUTTON:r.createAuthButton(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.SUBSCRIBE_MSG:r.subscribeMsg(t[0]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.subscribeMsg=function(e){console.log("订阅参数：",e),window.ShSdk.requestSubscribeMessage(e[0],function(e){console.log("订阅回调",e)})},e.prototype.bindBargain=function(){return new Promise(function(e,t){var o=window.wx.getLaunchOptionsSync().query;console.log("启动参数:",o),e(o.aid)})},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var r=this,e=window.wx.getStorageSync("pt_ver"),i=GameUtils.resVersion();i!=e?App.TimerManager.doTimer(6e4,1,function(){console.log("开始更新背景图");var e=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+i,t=window.wx.env.USER_DATA_PATH+"/special/dl_bg_dqdt.jpg";r.downLoadBg(e,t,i);var o=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+i,n=window.wx.env.USER_DATA_PATH+"/special/dl_bg_dqrw.png";r.downLoadBg(o,n,i)},r):console.log("版本号没有变化")},e.prototype.downLoadBg=function(t,o,n){var r=window.wx.getFileSystemManager();window.wx.downloadFile({url:t,success:function(e){e.tempFilePath?(console.log(t+"下载成功"),r.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){console.log(t+"成功复制到"+o),window.wx.setStorageSync("pt_ver",n)}})):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.createAuthButton=function(t,o,e,n,r,i,a,l){void 0===l&&(l=!1);var s=this;s.authButton&&s.authButton.destroy();var c=App.StageUtils.getWidth(),d=App.StageUtils.getHeight(),g=s.converGameWidthToWx(c,r),p=s.converGameHeightToWx(d,i),h=s.converGameWidthToWx(c,e),u=s.converGameHeightToWx(d,n),f=window.wx.createUserInfoButton({type:"image",image:LoginUtil.gameCfg.resURL+"resource/special/"+a,style:{left:h,top:u,width:g,height:p,lineHeight:0,backgroundColor:"",color:"",textAlign:"center",fontSize:0,borderRadius:0},withCredentials:!0});(s.authButton=f).onTap(function(e){e&&e.userInfo?(window.ShSdk.unionId(e,function(){}),platform.getUserInfo().then(function(){console.log("玩家已授权，关闭授权按钮"),s.disableArrayPash(FunctionID.AUTHORIZATION),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),t.call(o)})):l&&(console.log("用户取消授权",e),t.call(o))})},e.prototype.converGameWidthToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowWidth/e},e.prototype.converGameHeightToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowHeight/e},e.prototype.updateRole=function(e){var t=Promise.resolve(),o=this,n=App.ControllerManager.getControllerModel(CtrlConst.Avatar),r=n.getRoleInfo();switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(t,e){window.ShSdk.createRole(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.topupState(!0):e.data.msg.sp?o.topupState(!1):o.disableArrayPash(FunctionID.SHIELD_RECHARGE),o.AuthState(),t()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(t,e){window.ShSdk.enterGame(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.topupState(!0):e.data.msg.sp?o.topupState(!1):o.disableArrayPash(FunctionID.SHIELD_RECHARGE),o.AuthState(),t()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.topupState(!0):e.data.msg.sp?o.topupState(!1):o.disableArrayPash(FunctionID.SHIELD_RECHARGE)})}return t},e.prototype.topupState=function(e){e?this.disableArrayPash(FunctionID.SHIELD_RECHARGE):this.spliceArr(FunctionID.SHIELD_RECHARGE)},e.prototype.AuthState=function(){var t=this;window.wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(console.log("玩家已经授权，关闭授权按钮"),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ)):(console.log("玩家未授权，开启授权按钮"),t.spliceArr(FunctionID.AUTHORIZATION))}})},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();if("ShareView"==n)return r-=3e3,void t.call(o);window.wx.setStorage({key:"share_time",data:r}),window.ShSdk.goShare("aid="+e),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.conversation=function(){},e.prototype.clearCache=function(){window.wx.showLoading({title:"缓存清理中..."}),window.wx.getFileSystemManager().rmdir({dirPath:window.wx.env.USER_DATA_PATH+"/resource",recursive:!0,success:function(){console.log("删除本地缓存成功~"),window.wx.hideLoading(),window.wx.showModal({title:"提示",content:"缓存清理成功,请重新进入小程序!",showCancel:!1,success:function(e){e.confirm&&window.wx.exitMiniProgram({})}})},fail:function(){console.log("删除本地缓存失败~")}})},e}(PlatformAdapter);__reflect(BHPlatform.prototype,"BHPlatform");var CXPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.wx.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);var e=this;return window.ShSdk.share(function(){}),e.spliceArr(FunctionID.ADDMINI),e.spliceArr(FunctionID.SUBSCRIBE_MESSAGE),e.disableArrayPash(FunctionID.FOLLOW_WIN),e.disableArrayPash(FunctionID.KEFU_VIEW),e.disableArrayPash(FunctionID.MINI_GAMES),e.disableArrayPash(FunctionID.OFFLINE_WINDOW),e.disableArrayPash(FunctionID.RESOURCE_VER),e.constSid(),console.log("wx platform init success"),!0},e.prototype.constSid=function(){this.sid=LoginUtil.gameCfg.sid},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),window.wx.showModal({title:"支付成功",content:"支付成功"})):"NOT_ALLOW"==e.ret?window.wx.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.BIND_BARGAIN:n=r.bindBargain();break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.CREATEAUTHBUTTON:r.createAuthButton(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.bindBargain=function(){return new Promise(function(e,t){var o=window.wx.getLaunchOptionsSync().query;console.log("启动参数:",o),e(o.aid)})},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var o=this,e=window.wx.getStorageSync("pt_ver"),n=GameUtils.resVersion();n!=e?App.TimerManager.doTimer(6e4,1,function(){console.log("开始更新背景图");var e=LoginUtil.gameCfg.resURL+"resource/special/v1_loading.jpg?v="+n,t=window.wx.env.USER_DATA_PATH+"/special/v1_loading.jpg";o.downLoadBg(e,t,n)},o):console.log("版本号没有变化")},e.prototype.downLoadBg=function(t,o,n){var r=window.wx.getFileSystemManager();window.wx.downloadFile({url:t,success:function(e){e.tempFilePath?(console.log(t+"下载成功"),r.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){console.log(t+"成功复制到"+o),window.wx.setStorageSync("pt_ver",n)}})):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.createAuthButton=function(t,o,e,n,r,i,a,l){void 0===l&&(l=!1);var s=this;s.authButton&&s.authButton.destroy();var c=App.StageUtils.getWidth(),d=App.StageUtils.getHeight(),g=s.converGameWidthToWx(c,r),p=s.converGameHeightToWx(d,i),h=s.converGameWidthToWx(c,e),u=s.converGameHeightToWx(d,n),f=window.wx.createUserInfoButton({type:"image",image:LoginUtil.gameCfg.resURL+"resource/special/"+a,style:{left:h,top:u,width:g,height:p,lineHeight:0,backgroundColor:"",color:"",textAlign:"center",fontSize:0,borderRadius:0},withCredentials:!0});(s.authButton=f).onTap(function(e){e&&e.userInfo?(window.ShSdk.unionId(e),platform.getUserInfo().then(function(){console.log("玩家已授权，关闭授权按钮"),s.disableArrayPash(FunctionID.AUTHORIZATION),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),t.call(o)})):l&&(console.log("用户取消授权",e),t.call(o))})},e.prototype.converGameWidthToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowWidth/e},e.prototype.converGameHeightToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowHeight/e},e.prototype.updateRole=function(e){var t=Promise.resolve(),o=this,n=App.ControllerManager.getControllerModel(CtrlConst.Avatar),r=n.getRoleInfo();switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(t,e){window.ShSdk.createRole(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid!=o.sid&&e.data.msg.sp?o.topupState(!1):o.topupState(!0),t()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(t,e){window.ShSdk.enterGame(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid!=o.sid&&e.data.msg.sp?o.topupState(!1):o.topupState(!0),t()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid!=o.sid&&e.data.msg.sp?o.topupState(!1):o.topupState(!0)})}return t},e.prototype.topupState=function(e){e?this.disableArrayPash(FunctionID.SHIELD_RECHARGE):this.spliceArr(FunctionID.SHIELD_RECHARGE)},e.prototype.AuthState=function(){var t=this;window.wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(console.log("玩家已经授权，关闭授权按钮"),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ)):(console.log("玩家未授权，开启授权按钮"),t.spliceArr(FunctionID.AUTHORIZATION))}})},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();if("ShareView"==n)return r-=3e3,void t.call(o);window.wx.setStorage({key:"share_time",data:r}),window.ShSdk.goShare("aid="+e),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.conversation=function(){window.ShSdk.goCustomerService()},e.prototype.clearCache=function(){window.wx.showLoading({title:"缓存清理中..."}),window.wx.getFileSystemManager().rmdir({dirPath:window.wx.env.USER_DATA_PATH+"/resource",recursive:!0,success:function(){console.log("删除本地缓存成功~"),window.wx.hideLoading(),window.wx.showModal({title:"提示",content:"缓存清理成功,请重新进入小程序!",showCancel:!1,success:function(e){e.confirm&&window.wx.exitMiniProgram({})}})},fail:function(){console.log("删除本地缓存失败~")}})},e.prototype.triggerEnterGame=function(){return!0},e}(PlatformAdapter);__reflect(CXPlatform.prototype,"CXPlatform");var FireEventType=function(){function e(){}return e.UPDATEROLE="updateRole",e.CREATEROLE="createRole",e.ENTERGAME="enterGame",e.LEVELUP="levelUp",e.CONVERSATION="conversation",e.SHARE="share",e.CLEARCACHE="clearCache",e.SUBSCRIBE="subscribe",e.CREATEAUTHBUTTON="createAuthButton",e.LOGINERROR="loginError",e.UPDATE_LOADING_BG="updateLoadingBg",e.SUBPAGE_LOAD="subPageLoad",e.SUBSCRIBE_MSG="subscribeMsg",e.LOGOUT="logOut",e.REALNAME="realname",e.BINDPHONE="bindphone",e.BIND_BARGAIN="bindBargain",e.ANDROID_BGIMG="androidBgImg",e.SAVEAPPTODESKTOP="saveAppToDesktop",e.CHATMONITOR="chatMonitor",e.GOREALNAME="goRealname",e.ANEWLOGIN="anewLogin",e.SVIPBUTTONEVENT="svipButtonEvent",e.SUBSCRIBECOPY="subscribeCopy",e.CHECKWORD="checkWord",e.DOUYINGKEFU="douyinKefu",e.UPDOUYINGKEFU="upDouyinKefu",e.ADDSHORTCUT="addShortcut",e}();__reflect(FireEventType.prototype,"FireEventType");var H5Platform=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return __extends(e,n),e.prototype.showLoading=function(e){window.setloadtxt(e)},e.prototype.hideLoading=function(){window.removeLoading()},e.prototype.init=function(){n.prototype.init.call(this);var e=this,t=LoginUtil.gameCfg.gameId,o=LoginUtil.gameCfg.channel;switch(t){case"PM001189":e.disableArrayPash(FunctionID.SHIELD_RECHARGE),e.disableArrayPash(FunctionID.SUBMITTED_LINKS),e.disableArrayPash(FunctionID.SHIELD_SHARE),e.disableArrayPash(FunctionID.LOGIN_LOADING);break;case"PM001190":e.disableArrayPash(FunctionID.SUBMITTED_LINKS),e.disableArrayPash(FunctionID.SHIELD_SHARE),e.disableArrayPash(FunctionID.LOGIN_LOADING);break;case"PM001525":case"PM001516":e.disableArrayPash(FunctionID.SHIELD_SHARE),e.disableArrayPash(FunctionID.KEFU_VIEW),e.disableArrayPash(FunctionID.MICRO_PACKAGE_3K);break;case"P0006963":case"PM001424":e.disableArrayPash(FunctionID.SHIELD_KEFUBTN);break;case"PM001710":case"PM001511":case"PM001726":egret.Capabilities.isMobile||e.spliceArr(FunctionID.PC_ADAPTER);break;case"PM001653":e.disableArrayPash(FunctionID.SHIELD_INVITE),e.disableArrayPash(FunctionID.SHIELD_KEFUBTN);break;case"PM001872":e.disableArrayPash(FunctionID.SHIELD_INVITE);break;case"PM001634":e.spliceArr(FunctionID.SHIELD_FOLLOW),e.spliceArr(FunctionID.ATTENTION_REWARD)}return"PM001726"==t&&"107"==o&&e.spliceArr(FunctionID.CHECKWORD),"PM001726"==t&&"137"==o&&e.disableArrayPash(FunctionID.SHIELD_KEFUBTN),!0},e.prototype.realBinding=function(){var t=this,e=LoginUtil.gameCfg.gameId,o={apiType:"enabled"};"PM001759"!=e&&"PM001831"!=e||window.ShSdk.subscribe(o,function(e){1==e.cpStatus&&t.spliceArr(FunctionID.AWY_ATTENTION)}),"PM001525"!=e&&"PM001516"!=e&&"PM001726"!=e||(window.ShSdk.realname(o,function(e){"SUCCESS"==e.ret&&t.spliceArr(FunctionID.REAL_NAME)}),window.ShSdk.bindphone(o,function(e){"SUCCESS"==e.ret&&t.spliceArr(FunctionID.BIND_PHONE)}))},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o,has_gold:t.hasGold,vip_level:t.vipLevel};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值成功!")):(console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0))})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.ANEWLOGIN:r.anewLogin();break;case FireEventType.UPDATEROLE:r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.SUBSCRIBE:r.subscribe(t[0],t[1]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.REALNAME:r.realname(t[0],t[1]);break;case FireEventType.BINDPHONE:r.bindphone(t[0],t[1]);break;case FireEventType.CHECKWORD:r.checkWord(t[0],t[1]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.anewLogin=function(){var e=LoginUtil.gameCfg.gameId,t=LoginUtil.gameCfg.channel;("PM001690"==e||"PM001689"==e||"PM001726"==e&&"107"==t)&&(window.ShSdk.logout(),window.loginData=void 0,window.ShSdk.login(function(e){window.loginData=e}))},e.prototype.bindphone=function(t,o){window.ShSdk.bindphone({apiType:"askShow"},function(e){"SUCCESS"==e.ret?(console.log("手机绑定成功!"),Toast.showTipsDownToUp("手机绑定成功!"),t.call(o)):(console.log("手机绑定失败!"),Toast.showTipsDownToUp("手机绑定失败!",!0))})},e.prototype.realname=function(t,o){window.ShSdk.realname({apiType:"setCallback"},function(e){"SUCCESS"==e.ret&&(console.log("实名成功，回调发放奖励"),t.call(o))}),window.ShSdk.realname({apiType:"askShow"},function(e){"SUCCESS"==e.ret&&(console.log("实名成功，发放奖励"),t.call(o))})},e.prototype.conversation=function(){window.ShSdk.gotoGM()},e.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(o),this.realBinding(),this.ShieldTopUp3kIOS(t),t.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_INVITE),this.disableArrayPash(FunctionID.WAR_PASS)));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(o),this.realBinding(),this.ShieldTopUp3kIOS(t),t.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_INVITE),this.disableArrayPash(FunctionID.WAR_PASS));break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(o)}},e.prototype.ShieldTopUp3kIOS=function(e){"PM001591"==LoginUtil.gameCfg.gameId&&e.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_RECHARGE),this.disableArrayPash(FunctionID.SHIELD_RANKBTN),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN))},e.prototype.share=function(e,t,o,n,r){var i;if(App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),window.ShSdk.setShareCallback(function(e){"success"===e.msg?(this.isShare()&&t.call(o),console.log("分享成功")):console.log("分享失败")}),i="BargainGiftView"==n?{apiType:"setShare",shareParam:{ext:"yqm_code="+e.toString(16)}}:{apiType:"setShare",shareParam:""},window.ShSdk.shareSdk(i,function(e){1==e.cpStatus&&console.error("成功发起分享请求")}),!this.isShare())if("ShareView"!=n)var a=setTimeout(function(){clearTimeout(a),t.call(o)},3e3);else t.call(o)},e.prototype.isShare=function(){return!1},e.prototype.subscribe=function(t,o){window.ShSdk.subscribe({apiType:"isSubscribe"},function(e){1==e.cpStatus?(console.log("已经关注!"),t.call(o,!0)):window.ShSdk.subscribe({apiType:"askShow"},function(e){1==e.cpStatus?console.log("打开关注弹窗成功!"):2==e.cpStatus?(t.call(o,!0),console.log("完成关注!")):console.error("打开关注弹窗失败!")})})},e.prototype.checkWord=function(t,e){var o={cnt:e};window.ShSdk.checkWord(o,function(e){1==e.ret?t():2==e.ret?Toast.showTipsDownToUp(App.tr(50209)):Toast.showTipsDownToUp(App.tr(50210))})},e.prototype.clickRefresh=function(){var e=LoginUtil.gameCfg.gameId;if("PM001516"==e||"PM001525"==e)if(LoginUtil.sdkData.ext&&LoginUtil.sdkData.ext.guid){var t=LoginUtil.sdkData.ext.guid;platform.copyToClipboard(t),Toast.showTipsDownToUp(App.tr(20419,t))}else console.log("绑定ID为空");else"PM001690"==e||"PM001689"==e||"PM001737"==e?(window.ShSdk.logout(),window.loginData=void 0,window.ShSdk.login(function(e){window.loginData=e}),LoginUtil.refresh()):(LoginUtil.refresh(),platform.fireEvent(FireEventType.LOGOUT))},e.prototype.refreshBtnRename=function(e){var t=LoginUtil.gameCfg.gameId;"PM001516"==t||"PM001525"==t?(e.label=App.tr(23330),e.size="22"):"PM001690"!=t&&"PM001689"!=t&&"PM001737"!=t||(e.label=App.tr(23423),e.size="22")},e.prototype.triggerEnterGame=function(){var e=LoginUtil.gameCfg.gameId;return"PM001808"==e||"PM001856"==e||"PM001809"==e||"PM001742"==e||"PM001530"==e||"PM001732"==e||"PM001726"==e||"PM001737"==e},e}(PlatformAdapter);__reflect(H5Platform.prototype,"H5Platform");var IosNativePlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.androidBg=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);return this.disableArrayPash(FunctionID.KEFU_VIEW),this.disableArrayPash(FunctionID.SHIELD_INVITE),this.spliceArr(FunctionID.REAL_NAME),this.spliceArr(FunctionID.BIND_PHONE),egret.ExternalInterface.addCallback("loginFinished",function(e){window.loginData=JSON.parse(e)}),egret.ExternalInterface.addCallback("paymentFinished",function(e){switch(e){case"0":console.log("支付完成"),Toast.showTipsDownToUp("充值成功!");break;default:console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0)}}),egret.ExternalInterface.addCallback("logout",function(e){console.log("refresh"),window.loginData=void 0,LoginUtil.GameMain&&LoginUtil.refresh(),console.log("externall call: logout ==> doSdkLogin"),egret.ExternalInterface.call("doSdkLogin","")}),console.log("externall call: doSdkLogin"),egret.ExternalInterface.call("doSdkLogin",""),!0},e.prototype.pay=function(e,t){var o=e.r,n={money:100*Number(t.money),roleId:t.aid,roleLevel:t.roleLevel,roleName:t.roleName,serverId:t.serid,serverName:t.serName,gameNo:o,orderName:t.orderName,orderDesc:t.orderName,productName:t.orderName,balance:t.hasGold,fighting:t.rolePower,vipLevel:t.vipLevel,ext:o};console.log("externall call: QSMixPay"),egret.ExternalInterface.call("QSMixPay",JSON.stringify(n))},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:r.updateRole(t[0]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.LOGOUT:r.logout();break;case FireEventType.ANDROID_BGIMG:r.androidBgImg(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.REALNAME:r.realname(t[0],t[1]);break;case FireEventType.BINDPHONE:r.bindphone(t[0],t[1]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.bindphone=function(t,o){console.log("externall call: openBindPhoneView"),egret.ExternalInterface.call("openBindPhoneView",""),egret.ExternalInterface.addCallback("bindPhoneFinished",function(e){switch(e){case"1":console.log("绑定手机成功"),Toast.showTipsDownToUp("绑定手机成功!"),t.call(o);break;default:console.log("绑定手机失败"),Toast.showTipsDownToUp("绑定手机失败!",!0)}})},e.prototype.realname=function(t,o){console.log("externall call: realNameAuthentication"),egret.ExternalInterface.call("realNameAuthentication",""),egret.ExternalInterface.addCallback("realNameFinished",function(e){switch(e){case"1":console.log("实名验证成功"),Toast.showTipsDownToUp("实名验证成功!"),t.call(o);break;default:console.log("实名验证失败"),Toast.showTipsDownToUp("实名验证失败!",!0)}})},e.prototype.androidBgImg=function(r){this.androidBg||(this.androidBg=!0,RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e);t.height=r.stageHeight,t.width=r.stageWidth,r.addChildAt(t,0)},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e),o=r.stageHeight,n=r.stageWidth;t.height=1280<o?1280:o,t.width=720<n?720:n,t.x=(n-t.width)/2,t.y=(o-t.height)/2,r.addChildAt(t,1)},this,RES.ResourceItem.TYPE_IMAGE))},e.prototype.conversation=function(){var e=App.ControllerManager.getControllerModel(CtrlConst.Avatar).getRoleInfo();if(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Legion),o=(t.info,""),n="",r="";t.info&&(o=t.info.n,n=t.info.id,r=t.info.lv);var i={balance:e.has_gold,fighting:e.role_power,guildId:n,guildLevel:r,guildName:o,roleId:e.role_id,roleLevel:e.role_level,roleName:e.role_name,serverId:e.server_id,serverName:e.server_name,vipLevel:e.vip_level};console.log("externall call: enterServiceCenter"),egret.ExternalInterface.call("enterServiceCenter",JSON.stringify(i))}else console.error("角色数据为空，角色上报失败")},e.prototype.logout=function(){console.log("externall call: logout"),egret.ExternalInterface.call("logout","")},e.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();if(o){var n=App.ControllerManager.getControllerModel(CtrlConst.Legion),r=(n.info,""),i="",a="";n.info&&(r=n.info.n,i=n.info.id,a=n.info.lv);var l={balance:o.has_gold,fighting:o.role_power,guildId:i,guildLevel:a,guildName:r,roleId:o.role_id,roleLevel:o.role_level,roleName:o.role_name,serverId:o.server_id,serverName:o.server_name,vipLevel:o.vip_level};switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("externall call: QSMixUploadRoleInfo...createRole"),l.type=1,egret.ExternalInterface.call("QSMixUploadRoleInfo",JSON.stringify(l)),t.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_RECHARGE),this.disableArrayPash(FunctionID.SHIELD_RANKBTN),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN)));break;case FireEventType.ENTERGAME:console.log("externall call: QSMixUploadRoleInfo...enterGame"),l.type=0,egret.ExternalInterface.call("QSMixUploadRoleInfo",JSON.stringify(l)),t.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_RECHARGE),this.disableArrayPash(FunctionID.SHIELD_RANKBTN),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN));break;case FireEventType.LEVELUP:console.log("externall call: QSMixUploadRoleInfo...levelUp"),l.type=2,egret.ExternalInterface.call("QSMixUploadRoleInfo",JSON.stringify(l))}}else console.error("角色数据为空，角色上报失败")},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),"BargainGiftView"==n?(console.log("externall call: originalShareImage"),egret.ExternalInterface.call("originalShareImage","https://premixsdk.921.com/h5plat/play/package_code/P0007461?yqm_code="+e.toString(16)),App.TimerManager.doTimer(5e3,1,function(){t.call(o)},this)):t.call(o)},e.prototype.clickRefresh=function(){if(LoginUtil.sdkData.guid){var e=LoginUtil.sdkData.guid;platform.copyToClipboard(e),Toast.showTipsDownToUp(App.tr(20419,e))}else console.log("绑定ID为空")},e.prototype.refreshBtnRename=function(e){e.label=App.tr(23330),e.size="22"},e}(PlatformAdapter);__reflect(IosNativePlatform.prototype,"IosNativePlatform");var VivoPlatform=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showLoading=function(e){window.qg.showLoading({title:e})},t.prototype.hideLoading=function(){window.qg.hideLoading()},t.prototype.init=function(){e.prototype.init.call(this),console.log("Vivo更新-3");return this.disableArrayPash(FunctionID.RESOURCE_VER),this.disableArrayPash(FunctionID.SHIELD_SHARE),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),!0},t.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,server_id:t.serid,server_name:t.serName,role_id:t.aid,role_name:t.roleName,role_level:t.roleLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值成功!")):(console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0))})},t.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve();switch(e){case FireEventType.UPDATEROLE:this.updateRole(t[0]);break;case FireEventType.SHARE:this.share(t[0],t[1],t[2],t[3])}return n},t.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(o));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(o);break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(o)}},t.prototype.share=function(e,t,o,n){t.call(o)},t}(PlatformAdapter);__reflect(VivoPlatform.prototype,"VivoPlatform");var ZJPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.wx.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);var e=this;return window.ShSdk.share(function(){}),e.spliceArr(FunctionID.ADDMINI),e.spliceArr(FunctionID.SUBSCRIBE_MESSAGE),e.disableArrayPash(FunctionID.FOLLOW_WIN),e.disableArrayPash(FunctionID.MINI_GAMES),e.disableArrayPash(FunctionID.OFFLINE_WINDOW),e.disableArrayPash(FunctionID.RESOURCE_VER),e.spliceArr(FunctionID.SHIELD_FOLLOW),e.disableArrayPash(FunctionID.CLOSE_ATTENTION_BTN),e.disableArrayPash(FunctionID.CLOSE_KEFU_BTN),e.disableArrayPash(FunctionID.CLOSE_KEFUBTN_OPEN_COPY),e.disableArrayPash(FunctionID.WX_SILANG_REWARD),e.constSid(),console.log("wx platform init success"),!0},e.prototype.constSid=function(){this.sid=LoginUtil.gameCfg.sid},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,has_gold:t.hasGold,vip_level:t.vipLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),window.wx.showModal({title:"支付成功",content:"支付成功"})):"NOT_ALLOW"==e.ret?window.wx.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.BIND_BARGAIN:r.bindBargain();break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.CREATEAUTHBUTTON:r.createAuthButton(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.SUBSCRIBE_MSG:r.subscribeMsg(t[0]);break;case FireEventType.SUBSCRIBECOPY:r.subscribeCopy();break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.subscribeCopy=function(){platform.copyToClipboard(App.tr(23507))},e.prototype.subscribeMsg=function(e){console.log("订阅参数：",e),window.ShSdk.requestSubscribeMessage(e,function(e){console.log("订阅回调",e)})},e.prototype.bindBargain=function(){return new Promise(function(e,t){var o=window.wx.getLaunchOptionsSync().query;console.log("启动参数:",o),e(o.aid)})},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var r=this,e=window.wx.getStorageSync("pt_ver"),i=GameUtils.resVersion();i!=e?App.TimerManager.doTimer(6e4,1,function(){console.log("开始更新背景图");var e=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+i,t=window.wx.env.USER_DATA_PATH+"/special/dl_bg_dqdt.jpg";r.downLoadBg(e,t,i);var o=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+i,n=window.wx.env.USER_DATA_PATH+"/special/dl_bg_dqrw.png";r.downLoadBg(o,n,i)},r):console.log("版本号没有变化")},e.prototype.downLoadBg=function(t,o,n){var r=window.wx.getFileSystemManager();window.wx.downloadFile({url:t,success:function(e){e.tempFilePath?(console.log(t+"下载成功"),r.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){console.log(t+"成功复制到"+o),window.wx.setStorageSync("pt_ver",n)}})):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.createAuthButton=function(t,o,e,n,r,i,a,l){void 0===l&&(l=!1);var s=this;s.authButton&&s.authButton.destroy();var c=App.StageUtils.getWidth(),d=App.StageUtils.getHeight(),g=s.converGameWidthToWx(c,r),p=s.converGameHeightToWx(d,i),h=s.converGameWidthToWx(c,e),u=s.converGameHeightToWx(d,n),f=window.wx.createUserInfoButton({type:"image",image:LoginUtil.gameCfg.resURL+"resource/special/"+a,style:{left:h,top:u,width:g,height:p,lineHeight:0,backgroundColor:"",color:"",textAlign:"center",fontSize:0,borderRadius:0},withCredentials:!0});(s.authButton=f).onTap(function(e){e&&e.userInfo?(window.ShSdk.unionId(e),platform.getUserInfo().then(function(){console.log("玩家已授权，关闭授权按钮"),s.disableArrayPash(FunctionID.AUTHORIZATION),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),t.call(o)})):l&&(console.log("用户取消授权",e),t.call(o))})},e.prototype.converGameWidthToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowWidth/e},e.prototype.converGameHeightToWx=function(e,t){return t*window.wx.getSystemInfoSync().windowHeight/e},e.prototype.updateRole=function(e){var t=Promise.resolve(),o=this,n=App.ControllerManager.getControllerModel(CtrlConst.Avatar),r=n.getRoleInfo(),i=LoginUtil.gameCfg.gameId;switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(t,e){window.ShSdk.createRole(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.topupState(!0):e.data.msg.sp||"P0007587"==i||"P0007588"==i?o.topupState(!1):o.topupState(!0),t()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(t,e){window.ShSdk.enterGame(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.topupState(!0):e.data.msg.sp||"P0007587"==i||"P0007588"==i?o.topupState(!1):o.topupState(!0),t()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(r,function(e){console.log("角色上报，返回支付情况",e),n.avatarInfo.sid==o.sid?o.topupState(!0):e.data.msg.sp||"P0007587"==i||"P0007588"==i?o.topupState(!1):o.topupState(!0)})}return t},e.prototype.topupState=function(e){e?this.disableArrayPash(FunctionID.SHIELD_RECHARGE):this.spliceArr(FunctionID.SHIELD_RECHARGE)},e.prototype.AuthState=function(){var t=this;window.wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(console.log("玩家已经授权，关闭授权按钮"),App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ)):(console.log("玩家未授权，开启授权按钮"),t.spliceArr(FunctionID.AUTHORIZATION))}})},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();if("ShareView"==n)return r-=3e3,void t.call(o);window.wx.setStorage({key:"share_time",data:r}),window.ShSdk.goShare("aid="+e),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.conversation=function(){},e.prototype.clearCache=function(){window.wx.showLoading({title:"缓存清理中..."}),window.wx.getFileSystemManager().rmdir({dirPath:window.wx.env.USER_DATA_PATH+"/resource",recursive:!0,success:function(){console.log("删除本地缓存成功~"),window.wx.hideLoading(),window.wx.showModal({title:"提示",content:"缓存清理成功,请重新进入小程序!",showCancel:!1,success:function(e){e.confirm&&window.wx.exitMiniProgram({})}})},fail:function(){console.log("删除本地缓存失败~")}})},e}(PlatformAdapter);__reflect(ZJPlatform.prototype,"ZJPlatform");var QQPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.qq.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.qq.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.qq.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);var e=this;return window.ShSdk.share(function(){}),e.spliceArr(FunctionID.SUBSCRIBE_MESSAGE),e.disableArrayPash(FunctionID.FOLLOW_WIN),e.disableArrayPash(FunctionID.KEFU_VIEW),e.disableArrayPash(FunctionID.MINI_GAMES),e.disableArrayPash(FunctionID.OFFLINE_WINDOW),e.disableArrayPash(FunctionID.RESOURCE_VER),console.log("qq platform init success"),!0},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),window.qq.showModal({title:"支付成功",content:"支付成功"})):"YD_TIPS"==e.ret?window.qq.showModal({title:"温馨提示",content:e.msg}):"NOT_ALLOW"==e.ret?window.qq.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.BIND_BARGAIN:n=r.bindBargain();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.SAVEAPPTODESKTOP:r.saveAppToDesktop(t[0],t[1]);break;case FireEventType.SUBSCRIBE_MSG:r.subscribeMsg(t[0]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.subscribeMsg=function(e){console.log("订阅参数：",e),window.qq.subscribeAppMsg({subscribe:!0,success:function(e){console.log("----subscribeAppMsg----success",e)},fail:function(e){console.log("----subscribeAppMsg----fail",e)}})},e.prototype.saveAppToDesktop=function(e,t){window.qq.saveAppToDesktop({success:function(){e.call(t),console.log("添加桌面成功")},fail:function(){console.log("添加桌面失败")},complete:function(){}})},e.prototype.bindBargain=function(){return new Promise(function(e,t){var o=window.qq.getLaunchOptionsSync().query;console.log("启动参数:",o),e(o.aid)})},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var e=Math.random();console.log("开始更新背景图");var t=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+e,o=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+e,n=LoginUtil.gameCfg.logoPath+"?v="+e;if(LoginUtil.gameCfg.bgPath&&LoginUtil.gameCfg.modelPath&&(t=LoginUtil.gameCfg.bgPath+"?v="+e,o=LoginUtil.gameCfg.modelPath+"?v="+e),LoginUtil.gameCfg.logoPath){var r=window.qq.env.USER_DATA_PATH+"/special/logo.png";this.downLoadBg(n,r)}var i=window.qq.env.USER_DATA_PATH+"/special/dl_bg_dqdt.jpg";this.downLoadBg(t,i);var a=window.qq.env.USER_DATA_PATH+"/special/dl_bg_dqrw.png";this.downLoadBg(o,a)},e.prototype.downLoadBg=function(t,o){var n=window.qq.getFileSystemManager();window.qq.downloadFile({url:t,success:function(e){e.tempFilePath?n.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){}}):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.updateRole=function(e){var t=Promise.resolve(),o=this,n=App.ControllerManager.getControllerModel(CtrlConst.Avatar).getRoleInfo();switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(t,e){window.ShSdk.createRole(n,function(e){console.log("角色上报，返回支付情况",e),e.data.msg.sp||o.disableArrayPash(FunctionID.SHIELD_RECHARGE),t()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(t,e){window.ShSdk.enterGame(n,function(e){console.log("角色上报，返回支付情况",e),e.data.msg.sp||o.disableArrayPash(FunctionID.SHIELD_RECHARGE),t()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(n,function(e){console.log("角色上报，返回支付情况",e)})}return t},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();"ShareView"==n&&(r-=3e3),window.qq.setStorage({key:"share_time",data:r});var i="";if("BargainGiftView"==n){var a=LoginUtil.gameCfg.resURL+"resource/special/fxt_kjlb.jpg?v="+Math.random();i="aid="+e+"&share_title="+App.tr(23086)+"&share_img="+a+"'"}window.ShSdk.goShare(i),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.conversation=function(){window.qq.openCustomerServiceConversation()},e.prototype.clearCache=function(){window.qq.showLoading({title:"缓存清理中..."}),window.qq.getFileSystemManager().rmdir({dirPath:window.qq.env.USER_DATA_PATH+"/resource",recursive:!0,success:function(){console.log("删除本地缓存成功~"),window.qq.hideLoading(),window.qq.showModal({title:"提示",content:"缓存清理成功,请重新进入小程序!",showCancel:!1,success:function(e){e.confirm&&window.qq.exitMiniProgram({})}})},fail:function(){console.log("删除本地缓存失败~")}})},e}(PlatformAdapter);__reflect(QQPlatform.prototype,"QQPlatform");var AwyPlatform=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showLoading=function(e){window.setloadtxt(e)},t.prototype.hideLoading=function(){window.removeLoading()},t.prototype.init=function(){e.prototype.init.call(this);switch(LoginUtil.gameCfg.gameId){case"PM001637":this.disableArrayPash(FunctionID.AWY_REALNAME),this.disableArrayPash(FunctionID.AWY_CHAT)}return this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),!0},t.prototype.realBinding=function(){var t=this,e=(LoginUtil.gameCfg.gameId,{apiType:"enabled"});window.ShSdk.realname(e,function(e){"SUCCESS"==e.ret&&t.spliceArr(FunctionID.REAL_NAME)}),window.ShSdk.bindphone(e,function(e){"SUCCESS"==e.ret&&t.spliceArr(FunctionID.BIND_PHONE)}),window.ShSdk.subscribe(e,function(e){1==e.cpStatus&&t.spliceArr(FunctionID.AWY_ATTENTION)})},t.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o,has_gold:t.hasGold,vip_level:t.vipLevel};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值成功!")):(console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0))})},t.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.SUBSCRIBE:r.subscribe(t[0],t[1]);break;case FireEventType.REALNAME:r.realname(t[0],t[1]);break;case FireEventType.BINDPHONE:r.bindphone(t[0],t[1]);break;case FireEventType.CHATMONITOR:r.chatMonitor(t[0]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},t.prototype.chatMonitor=function(e){window.ShSdk.chatMonitor({type:e.tyep,server_id:e.server_id,role_name:e.role_name,touid:e.touid,tonick:e.tonick,toch:e.toch,msg:e.msg})},t.prototype.bindphone=function(t,o){window.ShSdk.bindphone({apiType:"askShow"},function(e){"SUCCESS"==e.ret?(console.log("手机绑定成功!"),Toast.showTipsDownToUp("手机绑定成功!"),t.call(o)):(console.log("手机绑定失败!"),Toast.showTipsDownToUp("手机绑定失败!",!0))})},t.prototype.realname=function(t,o){window.ShSdk.realname({apiType:"setCallback"},function(e){"SUCCESS"==e.ret&&(console.log("实名成功，回调发放奖励"),t.call(o))}),window.ShSdk.realname({apiType:"askShow"},function(e){"SUCCESS"==e.ret&&(console.log("实名成功，发放奖励"),t.call(o))})},t.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(o),this.realBinding());break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(o),this.realBinding();break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(o)}},t.prototype.share=function(e,t,o,n,r){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),window.ShSdk.setShareCallback(function(e){"success"===e.msg?(this.isShare()&&t.call(o),console.log("分享成功")):console.log("分享失败")});var i={apiType:"setShare",shareParam:{ext:"yqm_code="+e.toString(16)}};if(window.ShSdk.shareSdk(i,function(e){1==e.cpStatus&&console.error("成功发起分享请求")}),!this.isShare())if("ShareView"!=n)var a=setTimeout(function(){clearTimeout(a),t.call(o)},3e3);else t.call(o)},t.prototype.isShare=function(){return!1},t.prototype.subscribe=function(t,o){window.ShSdk.subscribe({apiType:"isSubscribe"},function(e){1==e.cpStatus?(console.log("已经关注!"),t.call(o,!0)):window.ShSdk.subscribe({apiType:"askShow"},function(e){console.log("调起关注二维码!")})})},t}(PlatformAdapter);__reflect(AwyPlatform.prototype,"AwyPlatform");var OppoPlatform=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showLoading=function(e){window.qg.setLoadingProgress({progress:100})},t.prototype.hideLoading=function(){window.qg.loadingComplete({complete:function(e){}})},t.prototype.init=function(){e.prototype.init.call(this);return this.disableArrayPash(FunctionID.RESOURCE_VER),this.disableArrayPash(FunctionID.SHIELD_SHARE),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),!0},t.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,server_id:t.serid,server_name:t.serName,role_id:t.aid,role_name:t.roleName,role_level:t.roleLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值成功!")):(console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0))})},t.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve();switch(e){case FireEventType.UPDATEROLE:this.updateRole(t[0]);break;case FireEventType.SHARE:this.share(t[0],t[1],t[2],t[3])}return n},t.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(o));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(o);break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(o)}},t.prototype.share=function(e,t,o,n){t.call(o)},t}(PlatformAdapter);__reflect(OppoPlatform.prototype,"OppoPlatform");var XiaomiPlatform=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showLoading=function(e){window.qg.showLoading({title:e})},t.prototype.hideLoading=function(){window.qg.hideLoading()},t.prototype.init=function(){e.prototype.init.call(this),console.log("小米初始化");return this.disableArrayPash(FunctionID.RESOURCE_VER),this.disableArrayPash(FunctionID.SHIELD_SHARE),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),!0},t.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,server_id:t.serid,server_name:t.serName,role_id:t.aid,role_name:t.roleName,role_level:t.roleLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值成功!")):(console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0))})},t.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve();switch(e){case FireEventType.UPDATEROLE:this.updateRole(t[0]);break;case FireEventType.SHARE:this.share(t[0],t[1],t[2],t[3])}return n},t.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(o));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(o);break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(o)}},t.prototype.share=function(e,t,o,n){t.call(o)},t}(PlatformAdapter);__reflect(XiaomiPlatform.prototype,"XiaomiPlatform");var MeizuPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.androidBg=!1,e}return __extends(e,t),e.prototype.showLoading=function(e){window.setloadtxt(e)},e.prototype.hideLoading=function(){window.removeLoading()},e.prototype.init=function(){t.prototype.init.call(this),console.log("魅族初始化");return this.disableArrayPash(FunctionID.RESOURCE_VER),this.disableArrayPash(FunctionID.SHIELD_SHARE),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),!0},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,server_id:t.serid,server_name:t.serName,role_id:t.aid,role_name:t.roleName,role_level:t.roleLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值成功!")):(console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0))})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve();switch(e){case FireEventType.UPDATEROLE:this.updateRole(t[0]);break;case FireEventType.ANDROID_BGIMG:this.androidBgImg(t[0]);break;case FireEventType.SHARE:this.share(t[0],t[1],t[2],t[3])}return n},e.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(o));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(o);break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(o)}},e.prototype.androidBgImg=function(r){this.androidBg||(this.androidBg=!0,RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e);t.height=r.stageHeight,t.width=r.stageWidth,r.addChildAt(t,0)},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e),o=r.stageHeight,n=r.stageWidth;t.height=1280<o?1280:o,t.width=720<n?720:n,t.x=(n-t.width)/2,t.y=(o-t.height)/2,r.addChildAt(t,1)},this,RES.ResourceItem.TYPE_IMAGE))},e.prototype.share=function(e,t,o,n){t.call(o)},e}(PlatformAdapter);__reflect(MeizuPlatform.prototype,"MeizuPlatform");var BaiduPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e.showRealnameIcon=!1,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.swan.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.swan.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.swan.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);return window.ShSdk.share(function(){}),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),this.disableArrayPash(FunctionID.RESOURCE_VER),console.log("swan platform init success"),!0},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o};window.ShSdk.pay(n,function(e){if("RealName"==e.ret){var t=App.StageUtils.getStage(),o=new RealNameUI(t.stageWidth,t.stageHeight);o.horizontalCenter=0,o.verticalCenter=0,t.addChild(o)}"SUCCESS"==e.ret?(console.log("支付完成"),window.swan.showModal({title:"支付成功",content:"支付成功"})):"YD_TIPS"==e.ret?window.swan.showModal({title:"温馨提示",content:e.msg}):"NOT_ALLOW"==e.ret?window.swan.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var e=Math.random();console.log("开始更新背景图");var t=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+e,o=LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+e,n=LoginUtil.gameCfg.logoPath+"?v="+e;if(LoginUtil.gameCfg.bgPath&&LoginUtil.gameCfg.modelPath&&(t=LoginUtil.gameCfg.bgPath+"?v="+e,o=LoginUtil.gameCfg.modelPath+"?v="+e),LoginUtil.gameCfg.logoPath){var r=window.swan.env.USER_DATA_PATH+"/special/logo.png";this.downLoadBg(n,r)}var i=window.swan.env.USER_DATA_PATH+"/special/dl_bg_dqdt.jpg";this.downLoadBg(t,i);var a=window.swan.env.USER_DATA_PATH+"/special/dl_bg_dqrw.png";this.downLoadBg(o,a)},e.prototype.downLoadBg=function(t,o){var n=window.swan.getFileSystemManager();window.swan.downloadFile({url:t,success:function(e){e.tempFilePath?n.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){}}):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.updateRole=function(e){var t=Promise.resolve(),n=this,r=App.ControllerManager.getControllerModel(CtrlConst.Avatar),i=r.getRoleInfo();switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(o,e){window.ShSdk.createRole(i,function(e){console.log("角色上报，返回支付情况",e),r.avatarInfo.sid==n.sid&&n.disableArrayPash(FunctionID.SHIELD_INVITE);var t=window.swan.getSystemInfoSync().system;-1!=(t=t.toLowerCase()).indexOf("ios")&&n.disableArrayPash(FunctionID.SHIELD_RECHARGE),o()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(o,e){window.ShSdk.enterGame(i,function(e){console.log("角色上报，返回支付情况",e),r.avatarInfo.sid==n.sid&&n.disableArrayPash(FunctionID.SHIELD_INVITE);var t=window.swan.getSystemInfoSync().system;-1!=(t=t.toLowerCase()).indexOf("ios")&&n.disableArrayPash(FunctionID.SHIELD_RECHARGE),o()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(i,function(e){console.log("角色上报，返回支付情况",e)})}return t},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();"ShareView"==n&&(r-=3e3),window.swan.setStorage({key:"share_time",data:r});var i="";if("BargainGiftView"==n){var a=LoginUtil.gameCfg.resURL+"resource/special/fxt_kjlb.jpg?v="+Math.random();i="aid="+e+"&share_title="+App.tr(23086)+"&share_img="+a+"'"}window.ShSdk.goShare(i),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.conversation=function(){},e.prototype.clearCache=function(){},e}(PlatformAdapter);__reflect(BaiduPlatform.prototype,"BaiduPlatform");var IosSHPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.androidBg=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);return this.disableArrayPash(FunctionID.KEFU_VIEW),this.disableArrayPash(FunctionID.SHIELD_INVITE),this.disableArrayPash(FunctionID.RESOURCE_VER),egret.ExternalInterface.addCallback("loginFinished",function(e){var t={tokenid:JSON.parse(e).tokenid};window.loginData=t}),egret.ExternalInterface.addCallback("paymentFinished",function(e){switch(e){case"0":console.log("支付完成"),Toast.showTipsDownToUp("充值成功!");break;default:console.log("支付失败"),Toast.showTipsDownToUp("充值失败!",!0)}}),egret.ExternalInterface.addCallback("logout",function(e){console.log("refresh"),window.loginData=void 0,LoginUtil.GameMain&&LoginUtil.refresh(),console.log("externall call: logout ==> doSdkLogin"),egret.ExternalInterface.call("doSdkLogin","")}),console.log("externall call: doSdkLogin"),egret.ExternalInterface.call("doSdkLogin",""),!0},e.prototype.pay=function(e,t){var o=e.r,n={money:100*Number(t.money),roleId:t.aid,roleLevel:t.roleLevel,roleName:t.roleName,serverId:t.serid,serverName:t.serName,gameNo:o,orderName:t.orderName,orderDesc:t.orderName,productName:t.orderName,balance:t.hasGold,fighting:t.rolePower,vipLevel:t.vipLevel,ext:o};console.log("externall call: QSMixPay"),egret.ExternalInterface.call("QSMixPay",JSON.stringify(n))},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:r.updateRole(t[0]);break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.LOGOUT:r.logout();break;case FireEventType.ANDROID_BGIMG:r.androidBgImg(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.REALNAME:r.realname(t[0],t[1]);break;case FireEventType.BINDPHONE:r.bindphone(t[0],t[1]);break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.bindphone=function(t,o){console.log("externall call: openBindPhoneView"),egret.ExternalInterface.call("openBindPhoneView",""),egret.ExternalInterface.addCallback("bindPhoneFinished",function(e){switch(e){case"1":console.log("绑定手机成功"),Toast.showTipsDownToUp("绑定手机成功!"),t.call(o);break;default:console.log("绑定手机失败"),Toast.showTipsDownToUp("绑定手机失败!",!0)}})},e.prototype.realname=function(t,o){console.log("externall call: realNameAuthentication"),egret.ExternalInterface.call("realNameAuthentication",""),egret.ExternalInterface.addCallback("realNameFinished",function(e){switch(e){case"1":console.log("实名验证成功"),Toast.showTipsDownToUp("实名验证成功!"),t.call(o);break;default:console.log("实名验证失败"),Toast.showTipsDownToUp("实名验证失败!",!0)}})},e.prototype.androidBgImg=function(r){this.androidBg||(this.androidBg=!0,RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e);t.height=r.stageHeight,t.width=r.stageWidth,r.addChildAt(t,0)},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e),o=r.stageHeight,n=r.stageWidth;t.height=1280<o?1280:o,t.width=720<n?720:n,t.x=(n-t.width)/2,t.y=(o-t.height)/2,r.addChildAt(t,1)},this,RES.ResourceItem.TYPE_IMAGE))},e.prototype.conversation=function(){var e=App.ControllerManager.getControllerModel(CtrlConst.Avatar).getRoleInfo();if(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Legion),o=(t.info,""),n="",r="";t.info&&(o=t.info.n,n=t.info.id,r=t.info.lv);var i={balance:e.has_gold,fighting:e.role_power,guildId:n,guildLevel:r,guildName:o,roleId:e.role_id,roleLevel:e.role_level,roleName:e.role_name,serverId:e.server_id,serverName:e.server_name,vipLevel:e.vip_level};console.log("externall call: enterServiceCenter"),egret.ExternalInterface.call("enterServiceCenter",JSON.stringify(i))}else console.error("角色数据为空，角色上报失败")},e.prototype.logout=function(){console.log("externall call: logout"),egret.ExternalInterface.call("logout","")},e.prototype.updateRole=function(e){var t=App.ControllerManager.getControllerModel(CtrlConst.Avatar),o=t.getRoleInfo();if(o){var n=App.ControllerManager.getControllerModel(CtrlConst.Legion),r=(n.info,""),i="",a="";n.info&&(r=n.info.n,i=n.info.id,a=n.info.lv);var l={balance:o.has_gold,fighting:o.role_power,guildId:i,guildLevel:a,guildName:r,roleId:o.role_id,roleLevel:o.role_level,roleName:o.role_name,serverId:o.server_id,serverName:o.server_name,vipLevel:o.vip_level};switch(e){case FireEventType.CREATEROLE:t.avatarInfo.cr&&(console.log("externall call: QSMixUploadRoleInfo...createRole"),l.type=1,egret.ExternalInterface.call("QSMixUploadRoleInfo",JSON.stringify(l)),t.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_RECHARGE),this.disableArrayPash(FunctionID.SHIELD_RANKBTN),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN)));break;case FireEventType.ENTERGAME:console.log("externall call: QSMixUploadRoleInfo...enterGame"),l.type=0,egret.ExternalInterface.call("QSMixUploadRoleInfo",JSON.stringify(l)),t.avatarInfo.sid==LoginUtil.gameCfg.sid&&(this.disableArrayPash(FunctionID.SHIELD_RECHARGE),this.disableArrayPash(FunctionID.SHIELD_RANKBTN),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN));break;case FireEventType.LEVELUP:console.log("externall call: QSMixUploadRoleInfo...levelUp"),l.type=2,egret.ExternalInterface.call("QSMixUploadRoleInfo",JSON.stringify(l))}}else console.error("角色数据为空，角色上报失败")},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ),"BargainGiftView"==n?(console.log("externall call: originalShareImage"),egret.ExternalInterface.call("originalShareImage","https://premixsdk.921.com/h5plat/play/package_code/P0007461?yqm_code="+e.toString(16)),App.TimerManager.doTimer(5e3,1,function(){t.call(o)},this)):t.call(o)},e}(PlatformAdapter);__reflect(IosSHPlatform.prototype,"IosSHPlatform");var UcPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.androidBg=!1,e}return __extends(e,t),e.prototype.showLoading=function(e){window.setloadtxt(e)},e.prototype.hideLoading=function(){window.removeLoading()},e.prototype.init=function(){t.prototype.init.call(this),console.log("UC初始化");var e=LoginUtil.gameCfg.gameId;return this.disableArrayPash(FunctionID.RESOURCE_VER),this.disableArrayPash(FunctionID.SHIELD_KEFUBTN),"P0008358"!=e&&"P0008359"!=e||this.disableArrayPash(FunctionID.SHIELD_SHARE),!0},e.prototype.getSystemInfo=function(){var e=egret.Capabilities.os;return e=e.toLowerCase()},e.prototype.pay=function(e,t){if(-1==this.getSystemInfo().indexOf("ios")){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,server_id:t.serid,server_name:t.serName,role_id:t.aid,role_name:t.roleName,role_level:t.roleLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),Toast.showTipsDownToUp("充值完成!")):"NOT_ALLOW"==e.ret?(console.log("下单失败"),Toast.showTipsDownToUp("下单失败!")):(console.log("支付取消或失败"),Toast.showTipsDownToUp("支付取消或失败!",!0))})}else Toast.showTipsDownToUp("iOS暂不支持内购噢~")},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve();switch(e){case FireEventType.UPDATEROLE:this.updateRole(t[0]);break;case FireEventType.ANDROID_BGIMG:this.androidBgImg(t[0]);break;case FireEventType.SHARE:this.share(t[0],t[1],t[2],t[3])}return n},e.prototype.updateRole=function(e){var t=LoginUtil.gameCfg.gameId,o=App.ControllerManager.getControllerModel(CtrlConst.Avatar),n=o.getRoleInfo();switch(e){case FireEventType.CREATEROLE:o.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(n),"PM001750"==t&&this.disableArrayPash(FunctionID.SHIELD_RECHARGE));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(n),"PM001750"==t&&this.disableArrayPash(FunctionID.SHIELD_RECHARGE);break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(n)}},e.prototype.androidBgImg=function(r){this.androidBg||(this.androidBg=!0,RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e);t.height=r.stageHeight,t.width=r.stageWidth,r.addChildAt(t,0)},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e),o=r.stageHeight,n=r.stageWidth;t.height=1280<o?1280:o,t.width=720<n?720:n,t.x=(n-t.width)/2,t.y=(o-t.height)/2,r.addChildAt(t,1)},this,RES.ResourceItem.TYPE_IMAGE))},e.prototype.share=function(e,t,o,n){if(platform.enableFunc(FunctionID.SHIELD_SHARE)){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);(new Date).getTime();"ShareView"==n&&3e3;var r="";if("BargainGiftView"==n){var i=LoginUtil.gameCfg.resURL+"resource/special/fxt_kjlb.jpg?v="+Math.random();r="aid="+e+"&share_title="+App.tr(23086)+"&share_img="+i+"'"}if(window.ShSdk.goShare(r),"ShareView"!=n)var a=setTimeout(function(){clearTimeout(a),t.call(o)},3e3);else t.call(o)}else t.call(o)},e}(PlatformAdapter);__reflect(UcPlatform.prototype,"UcPlatform");var DouYinPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.androidBg=!1,e.measuredX=null,e.measuredY=null,e}return __extends(e,t),e.prototype.showLoading=function(e){window.setloadtxt(e)},e.prototype.hideLoading=function(){window.removeLoading()},e.prototype.init=function(){t.prototype.init.call(this);return window.ShSdk.share(function(){}),this.spliceArr(FunctionID.TIKTOK_BTN),this.spliceArr(FunctionID.ADD_DESKTOP),this.disableArrayPash(FunctionID.RESOURCE_VER),!0},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,server_id:t.serid,server_name:t.serName,role_id:t.aid,role_name:t.roleName,role_level:t.roleLevel,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),window.tt.showModal({title:"支付成功",content:"支付成功"})):"NOT_ALLOW"==e.ret?window.tt.showModal({title:"支付失败",content:"暂不支持ios支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve();switch(e){case FireEventType.UPDATEROLE:this.updateRole(t[0]);break;case FireEventType.ANDROID_BGIMG:this.androidBgImg(t[0]);break;case FireEventType.SHARE:this.share(t[0],t[1],t[2],t[3]);break;case FireEventType.DOUYINGKEFU:this.douyinKefu(t[0],t[1],t[2],t[3]);break;case FireEventType.UPDOUYINGKEFU:this.upDouyinKefu();break;case FireEventType.ADDSHORTCUT:this.addShortcut(t[0],t[1]);break;case"loginError":App.ViewManager.open(ViewConst.LoginTip,login.LabelValue.VALUE4,!1)}return n},e.prototype.addShortcut=function(t,o){window.ShSdk.addShortcut(function(e){"SUCCESS"==e.ret&&t.call(o)})},e.prototype.getSystemInfo=function(){var e=egret.Capabilities.os;return e=e.toLowerCase()},e.prototype.updateRole=function(e){var t=this,o=(LoginUtil.gameCfg.gameId,App.ControllerManager.getControllerModel(CtrlConst.Avatar)),n=o.getRoleInfo(),r=LoginUtil.gameCfg.sid,i=t.getSystemInfo();switch(e){case FireEventType.CREATEROLE:o.avatarInfo.cr&&(console.log("uploadRole...createRole"),window.ShSdk.createRole(n,function(e){console.log("角色上报，返回支付情况",e),o.avatarInfo.sid==r?(-1!=i.indexOf("ios")&&t.disableArrayPash(FunctionID.SHIELD_RECHARGE),t.disableArrayPash(FunctionID.SHIELD_INVITE)):e.data.msg.sp||t.disableArrayPash(FunctionID.SHIELD_RECHARGE),e.data.msg.login_token?console.log("显示引导按钮"):console.log("不显示引导按钮")}));break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),window.ShSdk.enterGame(n,function(e){console.log("角色上报，返回支付情况",e),o.avatarInfo.sid==r?(-1!=i.indexOf("ios")&&t.disableArrayPash(FunctionID.SHIELD_RECHARGE),t.disableArrayPash(FunctionID.SHIELD_INVITE)):e.data.msg.sp||t.disableArrayPash(FunctionID.SHIELD_RECHARGE),e.data.msg.login_token?console.log("显示引导按钮"):console.log("不显示引导按钮")});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(n,function(e){console.log("角色上报，返回支付情况",e),o.avatarInfo.sid==r?(-1!=i.indexOf("ios")&&t.disableArrayPash(FunctionID.SHIELD_RECHARGE),t.disableArrayPash(FunctionID.SHIELD_INVITE)):e.data.msg.sp?t.spliceArr(FunctionID.SHIELD_RECHARGE):t.disableArrayPash(FunctionID.SHIELD_RECHARGE),e.data.msg.login_token?console.log("显示引导按钮"):console.log("不显示引导按钮")})}},e.prototype.androidBgImg=function(r){this.androidBg||(this.androidBg=!0,RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqdt.jpg?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e);t.height=r.stageHeight,t.width=r.stageWidth,r.addChildAt(t,0)},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(LoginUtil.gameCfg.resURL+"resource/special/dl_bg_dqrw.png?v="+LoginUtil.gameCfg.version,function(e){var t=new eui.Image(e),o=r.stageHeight,n=r.stageWidth;t.height=1280<o?1280:o,t.width=720<n?720:n,t.x=(n-t.width)/2,t.y=(o-t.height)/2,r.addChildAt(t,1)},this,RES.ResourceItem.TYPE_IMAGE))},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();"ShareView"==n&&(r-=3e3),window.wx.setStorage({key:"share_time",data:r});var i="";if("BargainGiftView"==n){var a=LoginUtil.gameCfg.resURL+"resource/special/fxt_kjlb.jpg?v="+Math.random();i="aid="+e+"&share_title="+App.tr(23086)+"&share_img="+a+"'"}window.ShSdk.goShare(i),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback.call(this.target)},e.prototype.douyinKefu=function(e,t,o,n){this.measuredX=e,this.measuredY=t;var r=App.StageUtils.getWidth(),i=App.StageUtils.getHeight();window.createContactButton&&window.createContactButton(r,i,e,t,o,n)},e.prototype.upDouyinKefu=function(){(this.measuredX||this.measuredY)&&platform.fireEvent(FireEventType.DOUYINGKEFU,this.measuredX,this.measuredY,136,56)},e.prototype.initMv=function(){GameUtils.mv||GameUtils.initMv(),GameUtils.mv.source=GameUtils.mving?GameUtils.mvsp:GameUtils.mvst,GameUtils.mv&&!LayerManager.UI_Tips.contains(GameUtils.mv)&&(LayerManager.UI_Tips.addChild(GameUtils.mv),LayerManager.UI_Tips.addChild(GameUtils.bj))},e}(PlatformAdapter);__reflect(DouYinPlatform.prototype,"DouYinPlatform");var FkPlatform=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectAudio={},e.bgAudio={},e.sid=0,e.realNameVal=!1,e}return __extends(e,t),e.prototype.copyToClipboard=function(e){window.wx.setClipboardData({data:e})},e.prototype.playEffect=function(e,t){var o=this.effectAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,this.effectAudio[e]=o}o.play()},e.prototype.playBg=function(e,t){this.stopBg(this.curBg,null),this.curBg=e;var o=this.bgAudio[e];if(!o){o=window.wx.createInnerAudioContext();var n=e.replace("_mp3",".mp3"),r=LoginUtil.gameCfg.resURL+"resource/sounds/"+this.rechristen(n);o.src=r,o.loop=!0,this.bgAudio[e]=o}o.play()},e.prototype.rechristen=function(e){return ResVersionManager.resVersionData["sounds/"+e]},e.prototype.stopBg=function(e,t){if(e){var o=this.bgAudio[e];o&&o.stop()}},e.prototype.init=function(){t.prototype.init.call(this);return window.ShSdk.share(function(){console.log("ShSdk.share success callback")},"test=1"),this.disableArrayPash(FunctionID.RESOURCE_VER),!0},e.prototype.pay=function(e,t){var o=e.r,n={game_no:o,order_money:100*Number(t.money),order_name:t.orderName,role_name:t.roleName,role_level:t.roleLevel,role_id:t.aid,server_name:t.serName,server_id:t.serid,ext:""+o};window.ShSdk.pay(n,function(e){"SUCCESS"==e.ret?(console.log("支付完成"),window.wx.showModal({title:"支付成功",content:"支付成功"})):"NOT_ALLOW"==e.ret?window.wx.showModal({title:"支付失败",content:"暂不支持支付"}):console.log("支付取消或失败")})},e.prototype.fireEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=Promise.resolve(),r=this;switch(e){case FireEventType.UPDATEROLE:n=r.updateRole(t[0]);break;case FireEventType.SHARE:r.share(t[0],t[1],t[2],t[3]);break;case FireEventType.BIND_BARGAIN:n=r.bindBargain();break;case FireEventType.CONVERSATION:r.conversation();break;case FireEventType.CLEARCACHE:r.clearCache();break;case FireEventType.UPDATE_LOADING_BG:r.updateLoadingBg();break;case FireEventType.LOGINERROR:var i=new LoginError(App.StageUtils.getWidth(),App.StageUtils.getHeight(),"登录游戏服异常!\n请重新登录...",function(){LoginUtil.refresh()},r);App.StageUtils.getStage().addChild(i)}return n},e.prototype.bindBargain=function(){return new Promise(function(e,t){var o=window.wx.getLaunchOptionsSync().query;console.log("启动参数:",o),e(o.aid)})},e.prototype.updateLoadingBg=function(){console.log("updateLoadingBg");var o=this,e=window.wx.getStorageSync("pt_ver"),n=GameUtils.resVersion();n!=e?App.TimerManager.doTimer(6e4,1,function(){console.log("开始更新背景图");var e=LoginUtil.gameCfg.resURL+"resource/special/v1_loading.jpg?v="+n,t=window.wx.env.USER_DATA_PATH+"/special/v1_loading.jpg";o.downLoadBg(e,t,n)},o):console.log("版本号没有变化")},e.prototype.downLoadBg=function(t,o,n){var r=window.wx.getFileSystemManager();window.wx.downloadFile({url:t,success:function(e){e.tempFilePath?(console.log(t+"下载成功"),r.copyFile({srcPath:e.tempFilePath,destPath:o,success:function(){console.log(t+"成功复制到"+o),window.wx.setStorageSync("pt_ver",n)}})):console.log(t+"下载失败")},fail:function(e){console.error(e)}})},e.prototype.updateRole=function(e){var o=this,t=Promise.resolve(),n=this,r=App.ControllerManager.getControllerModel(CtrlConst.Avatar),i=r.getRoleInfo();switch(e){case FireEventType.CREATEROLE:console.log("uploadRole...createRole"),t=new Promise(function(t,e){window.ShSdk.createRole(i,function(e){console.log("角色上报，返回支付情况",e),r.avatarInfo.sid!=n.sid&&e.data.msg.sp?n.topupState(!1):n.topupState(!0),e.data.msg.open_share||o.disableArrayPash(FunctionID.SHIELD_INVITE),t()})});break;case FireEventType.ENTERGAME:console.log("uploadRole...enterGame"),t=new Promise(function(t,e){window.ShSdk.enterGame(i,function(e){console.log("角色上报，返回支付情况",e),r.avatarInfo.sid!=n.sid&&e.data.msg.sp?n.topupState(!1):n.topupState(!0),e.data.msg.open_share||o.disableArrayPash(FunctionID.SHIELD_INVITE),t()})});break;case FireEventType.LEVELUP:console.log("uploadRole...levelUp"),window.ShSdk.roleUpLevel(i,function(e){console.log("角色上报，返回支付情况",e),r.avatarInfo.sid!=n.sid&&e.data.msg.sp?n.topupState(!1):n.topupState(!0),e.data.msg.open_share?o.spliceArr(FunctionID.SHIELD_INVITE):o.disableArrayPash(FunctionID.SHIELD_INVITE)})}return t},e.prototype.topupState=function(e){e?this.disableArrayPash(FunctionID.SHIELD_RECHARGE):this.spliceArr(FunctionID.SHIELD_RECHARGE)},e.prototype.share=function(e,t,o,n){App.ControllerManager.applyFunc(CtrlConst.WeiXinAct,WeiXinActConst.WEI_XIN_AUTH_REQ);var r=(new Date).getTime();if("ShareView"==n)return r-=3e3,void t.call(o);window.wx.setStorage({key:"share_time",data:r}),window.ShSdk.goShare(),this.callback=t,this.target=o},e.prototype.shareCallback=function(){this.callback&&this.callback.call(this.target)},e.prototype.conversation=function(){},e.prototype.clearCache=function(){window.wx.showLoading({title:"缓存清理中..."}),window.wx.getFileSystemManager().rmdir({dirPath:window.wx.env.USER_DATA_PATH+"/resource",recursive:!0,success:function(){console.log("删除本地缓存成功~"),window.wx.hideLoading(),window.wx.showModal({title:"提示",content:"缓存清理成功,请重新进入小程序!",showCancel:!1,success:function(e){e.confirm&&window.wx.exitMiniProgram({})}})},fail:function(){console.log("删除本地缓存失败~")}})},e}(PlatformAdapter);__reflect(FkPlatform.prototype,"FkPlatform"),window.LoginUtil=LoginUtil,window.GuildRecoordIndex2=GuildRecoordIndex2,window.BuriedPoint=BuriedPoint,window.HTTP1=HTTP1,window.ServerTab=ServerTab,window.ServerLabel=ServerLabel,window.LoginError=LoginError,window.LoginUI=LoginUI,window.LoginMain=LoginMain,window.StartVersionManager=StartVersionManager,window.RealNameUI=RealNameUI,window.FunctionID=FunctionID,window.PlatformAdapter=PlatformAdapter,window.DebugPlatform=DebugPlatform,window.AndroidNativePlatform=AndroidNativePlatform,window.WxPlatform=WxPlatform,window.BHPlatform=BHPlatform,window.CXPlatform=CXPlatform,window.FireEventType=FireEventType,window.H5Platform=H5Platform,window.IosNativePlatform=IosNativePlatform,window.VivoPlatform=VivoPlatform,window.ZJPlatform=ZJPlatform,window.QQPlatform=QQPlatform,window.AwyPlatform=AwyPlatform,window.OppoPlatform=OppoPlatform,window.XiaomiPlatform=XiaomiPlatform,window.MeizuPlatform=MeizuPlatform,window.BaiduPlatform=BaiduPlatform,window.IosSHPlatform=IosSHPlatform,window.UcPlatform=UcPlatform,window.DouYinPlatform=DouYinPlatform,window.FkPlatform=FkPlatform;