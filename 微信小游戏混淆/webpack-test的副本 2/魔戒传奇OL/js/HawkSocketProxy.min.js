var egret = window.egret;function HawkSocketProxy(){this.url="",this.socket=null,this.open_cb=null,this.close_cb=null,this.error_cb=null}HawkSocketProxy.prototype.getUrl=function(){return this.url},HawkSocketProxy.prototype.isAlive=function(){return this.socket.readyState==WebSocketProxy.OPEN},HawkSocketProxy.prototype.connect=function(o,t,e,c,r){var n=this;this.url=o,this.open_cb=t,this.close_cb=e,this.error_cb=c,this.socket=new WebSocketProxy(o,function(o){console.log("session opened: "+n.url),n.open_cb&&n.open_cb.apply(r)},function(o){try{console.log("data.length="+o.data.length);var t=dcodeIO.ByteBuffer.fromBase64(o.data);console.log("byteBuffer.limit="+t.limit);var e=new HawkProtocol;e.decode(t)?HawkProtocolManager.handlerProtocol(e):console.log("protocol decode failed")}catch(c){console.log("exception: "+c.toString())}},function(o){console.log("session closed: "+n.url),n.close_cb&&n.close_cb.apply(r)},function(o){console.log("session error: "+n.url),n.error_cb&&n.error_cb.apply(r)}),this.socket.connect()},HawkSocketProxy.prototype.reconnect=function(){(null==this.socket||this.socket.readyState!=WebSocketProxy.OPEN)&&this.connect(this.url)},HawkSocketProxy.prototype.sendProtocol=function(o,t){if(this.socket.readyState==WebSocketProxy.OPEN)try{var e=new HawkProtocol(o,t),c=e.encode();if(null!=c)return this.socket.send(c.toBase64()),!0}catch(r){console.log("exception: "+r.toString())}return!1},HawkSocketProxy.prototype.close=function(){this.socket&&this.socket.readyState==WebSocketProxy.OPEN&&this.socket.close()};