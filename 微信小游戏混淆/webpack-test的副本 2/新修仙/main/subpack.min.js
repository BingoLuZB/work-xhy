var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__decorate=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,s=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(3>o?a(s):o>3?a(e,i,s):a(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function r(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(s,r)}u((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(a)throw new TypeError("Generator is already executing.");for(;u;)try{if(a=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){u.label=i[1];break}if(6===i[0]&&u.label<s[1]){u.label=s[1],s=i;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(i);break}s[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(n){i=[6,n],o=0}finally{a=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,o,s,r,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},AI=function(){function t(){this.state=AIState.Stand,this.prevState=AIState.None,this.aiTime=200,this.params=new AIParam,this._isRunning=!1,this.friendType=[],this.enemyType=[]}return t.prototype.getEntity=function(){return this.entity},t.prototype.setEntity=function(t){this.entity=t},t.prototype.start=function(){this._isRunning||(this._isRunning=!0),Timer.ins()["do"](0,this.aiTime,0,this.update,this,TimerType.LAST)},t.prototype.stop=function(){this._isRunning=!1,Timer.ins().remove(this.update,this)},Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),t.prototype.Stand=function(){},t.prototype.Atk=function(){},t.prototype.Atked=function(){},t.prototype.Follow=function(){return!0},t.prototype.ReturnPatrol=function(){},t.prototype.None=function(){},t.prototype.update=function(){var t=this[AIState[this.state]];return t?t.call(this)||!1:!1},t.prototype.setAIState=function(t){if(this.state!=t){if(this.state==AIState.Die)return;this.prevState=this.state,this.state=t}},t.prototype.getAIState=function(){return this.state},t.prototype.isAIState=function(t){return this.state==t},t.prototype.updateAIAndResetNextTick=function(){return Timer.ins()["do"](this.aiTime,this.aiTime,0,this.update,this,TimerType.LAST),this.update()},t.prototype.startAttack=function(t){void 0===t&&(t=null),this.resetTargetHandle(t?t.handle:0),this.setAIState(AIState.Atk)},t.prototype.startStand=function(){this.setAIState(AIState.Stand)},t.prototype.startNone=function(){this.setAIState(AIState.None)},t.prototype.startfindNpc=function(t,e){},t.prototype.startTask=function(t,e,i,n){this.params.taskId=t,this.params.taskMaxId=e,this.params.taskValue=0,this.params.taskTotal=i,this.params.taskTager=n},t.prototype.startMoveToXY=function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=null),this.params.fbId=e,this.params.moveP.x=t.x,this.params.moveP.y=t.y,this.params.moveToXYCallback=i,this.params.movePrevAIState=this.state,this.setAIState(AIState.MoveToXY)},t.prototype.stopMoveToXy=function(){this.startNone(),this.params.fbId=-1,this.params.moveP.x=0,this.params.moveP.y=0,this.params.moveToXYCallback=null,this.params.movePrevAIState=0},t.prototype.MoveToXY=function(){},t.prototype.startPatrol=function(t,e){this.setAIState(AIState.Patrol),this.params.homeX=t?t:0,this.params.homeY=e?e:0},t.prototype.startDie=function(t,e){void 0===t&&(t=0),this.setAIState(AIState.Die),this.params.dieTime=t},t.prototype.Die=function(){},t.prototype.startAtked=function(t){this.params.targetHandle||this.resetTargetHandle(t)},t.prototype.startFollow=function(t,e){void 0===e&&(e=0),this.setAIState(AIState.Follow),this.params.followHandle=t,this.params.followMasterHandle=e},t.prototype.startAlive=function(){this.state=AIState.Stand},t.prototype.startPickItem=function(t){void 0===t&&(t=null),this.setAIState(AIState.PickItem),t&&this.params.pickItems.push(t)},t.prototype.addPickItem=function(t){this.params.pickItems.push(t)},t.prototype.PickItem=function(){},t.prototype.startCaiJi=function(t,e){void 0===e&&(e=0),this.setAIState(AIState.CaiJi),this.params.caiJihandle=t,this.params.caijiType=e},t.prototype.CaiJi=function(){},t.prototype.resetCaiji=function(){},t.prototype.startShunyi=function(t){},t.prototype.shunyi=function(){},t.prototype.resetTargetALL=function(){this.params.firstMonsterId=0,this.params.firstAtkHandle=0,this.params.firstAtkMasterHandle=0,this.resetTargetHandle()},t.prototype.resetTargetHandle=function(t){void 0===t&&(t=0),this.params.targetHandle=t},t.prototype.addAtkMonsterId=function(t){this.params.firstMonsterId!=t&&(this.params.firstMonsterId=t)},t.prototype.addAtkHandle=function(t){this.params.firstAtkHandle!=t&&(this.params.firstAtkHandle=t)},t.prototype.addAtkMasterHandle=function(t){this.params.firstAtkMasterHandle!=t&&(this.params.firstAtkMasterHandle=t)},t.prototype.addChouhen=function(t,e){if(void 0===e&&(e=0),t){for(var i=new Chouhen(t,e),n=this.params.chouhenList.length,a=0;n>a;a++)if(this.params.chouhenList[a].masterHandle==t)return void(this.params.chouhenList[a]=i);this.params.chouhenList.push(i),SortUtil.sortOn(this.params.chouhenList,["damage"],[SortType.down])}else this.params.chouhenList.length=0},t.prototype.delChouhen=function(t){for(var e=this.params.chouhenList.length,i=0;e>i;i++)if(this.params.chouhenList[i].masterHandle==t)return void this.params.chouhenList.splice(i,1)},t.prototype.getChouhenList=function(){return this.params.chouhenList},t.prototype.getChouhenHandleList=function(){for(var t=[],e=this.params.chouhenList.length,i=0;e>i;i++)this.params.chouhenList[i].masterHandle&&t.push(this.params.chouhenList[i].masterHandle);return t},t.prototype.getTaskId=function(){return this.params.taskId},t.prototype.getTaskMaxId=function(){return this.params.taskMaxId},t.prototype.getTaskValue=function(){return this.params.taskValue},t.prototype.getTaskTotal=function(){return this.params.taskTotal},t.prototype.getTaskTager=function(){return this.params.taskTager},t.prototype.isCompleteTask=function(){return this.params.taskValue>0?this.params.taskValue>=this.params.taskTotal:!1},t.prototype.isFriend=function(t){return-1!=this.friendType.indexOf(t.entityType)},t.prototype.isEnemy=function(t){return-1!=this.enemyType.indexOf(t.entityType)},t.prototype.destruct=function(){this.stop(),this.entity=null,this.params.reset()},t}();__reflect(AI.prototype,"AI"),window.AI=AI;var AIState;!function(t){t[t.Stand=0]="Stand",t[t.Atk=1]="Atk",t[t.Atked=2]="Atked",t[t.Patrol=3]="Patrol",t[t.Die=4]="Die",t[t.Follow=5]="Follow",t[t.ReturnPatrol=6]="ReturnPatrol",t[t.None=7]="None",t[t.MoveToXY=8]="MoveToXY",t[t.Guaji=9]="Guaji",t[t.PickItem=10]="PickItem",t[t.CaiJi=11]="CaiJi"}(AIState||(AIState={})),window.AIState=AIState;var AIParam=function(){function t(){this.targetHandle=0,this.followHandle=0,this.followMasterHandle=0,this.followRadius=150,this.followDis=50,this.x=0,this.y=0,this.homeX=0,this.homeY=0,this.fbId=-1,this.moveP=new XY,this.pickItems=[],this.pickRadio=0,this.firstMonsterId=0,this.firstAtkHandle=0,this.firstAtkMasterHandle=0,this.chouhenList=[],this.aiTargetList=[],this.caiJihandle=0,this.caijiType=0,this.taskId=0,this.taskMaxId=0,this.taskValue=0,this.taskTotal=0,this.taskTager=0,this.dieTime=0}return t.prototype.setTargetList=function(t){this.aiTargetList.length=0;for(var e=0;e<t.length;e++){var i=void 0,n=t[e];switch(n){case AITargetType.targetHandle:this.aiTargetList.push(new AITargetHandle);break;case AITargetType.masterHandle:this.aiTargetList.push(new AITargetMasterHandle);break;case AITargetType.chouhen:this.aiTargetList.push(new AITargetChouhen);break;case AITargetType.targetHandle:this.aiTargetList.push(new AICurTargetHandle);break;case AITargetType.monsterId:this.aiTargetList.push(new AITargetMonsterId);break;case AITargetType.nearest:this.aiTargetList.push(new AITargetNearest);break;case AITargetType.job:this.aiTargetList.push(new AITargetJob)}i.type=n}},t.prototype.setAiTarget=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0,a=this.aiTargetList;n<a.length;n++){var o=a[n];o.type==t&&o.setParam(e)}},t.prototype.getAiTarget=function(t){for(var e=0,i=this.aiTargetList;e<i.length;e++){var n=i[e];if(n.type==t)return n}},t.prototype.resetAll=function(){this.reset(),this.moveToXYCallback=null,this.moveP.x=this.moveP.y=0,this.movePrevAIState=AIState.None},t.prototype.reset=function(){this.targetHandle=0,this.followHandle=0,this.followMasterHandle=0,this.x=0,this.y=0,this.pickItems.length=0,this.firstMonsterId=0,this.firstAtkHandle=0,this.firstAtkMasterHandle=0,this.chouhenList.length=0,this.homeX=0,this.homeY=0,this.caiJihandle=0,this.taskId=0,this.taskMaxId=0,this.taskValue=0,this.taskTotal=0,this.taskTager=0,this.dieTime=0},t}();__reflect(AIParam.prototype,"AIParam"),window.AIParam=AIParam;var ItemPick=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(XY);__reflect(ItemPick.prototype,"ItemPick"),window.ItemPick=ItemPick;var Chouhen=function(){function t(t,e){this.damage=0,this.masterHandle=0,this.masterHandle=t,this.damage=e}return t}();__reflect(Chouhen.prototype,"Chouhen"),window.Chouhen=Chouhen;var DaZaoTabSubDataBase=function(){function t(){this.parentTabName="",this.daZaoTabEqupPosData=[]}return t.prototype.iniData=function(){},Object.defineProperty(t.prototype,"zslevel",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.getPanelName=function(){return egret.getQualifiedClassName(DaZaoEquipPanel)},Object.defineProperty(t.prototype,"redTabName",{get:function(){return this.tabName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabName",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"job",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.isTuiJian=function(){return!1},t.prototype.getTuiJianSubTabIndex=function(){return 0},t.prototype.getRedPoint=function(){return!1},t}();__reflect(DaZaoTabSubDataBase.prototype,"DaZaoTabSubDataBase");var AIBase=function(t){function e(){var e=t.call(this)||this;return e.nextActionTick=0,e.skillDatas=[],e.prevTargetHandle=0,e.prevSkillId=0,e.mover=null,e.tar=new XY(-1,-1),e.isGuaji=!1,e.nextActionTick=Timer.ins().getTimer(),e}return __extends(e,t),e.prototype.setEntity=function(e){t.prototype.setEntity.call(this,e),this.mover=new MoverLine(this.entity)},e.prototype.start=function(){t.prototype.start.call(this),this.nextActionTick=0},e.prototype.stop=function(){t.prototype.stop.call(this),this.stopAndStand(),this.nextActionTick=0},e.prototype.setGuaji=function(t){this.isGuaji=t},e.prototype.getGuaji=function(){return this.isGuaji},e.prototype.update=function(){return Timer.ins().getEgretTimer()>=this.nextActionTick?t.prototype.update.call(this):!1},e.prototype.updateSkillCd=function(t){for(var e=0;e<this.skillDatas.length;e++){var i=this.skillDatas[e];i.skillId==t&&(i.skillCDTick=Timer.ins().getEgretTimer()+i.skillConfig.cd)}},e.prototype.sendMoveEntity=function(t){},e.prototype.startFollow=function(e,i){var n=this;void 0===i&&(i=0),t.prototype.startFollow.call(this,e,i);var a=this.getFollowTarget();if(a)if(this.isFaraway(a)){var o=this.getFollowXY(a);this.startMove(o,function(){n.entity.setDir(GFunc.getDirBy2Point(n.entity,a))}),this.params.x=o.x,this.params.y=o.y}else this.entity.setDir(GFunc.getDirBy2Point(this.entity,a))},e.prototype.getFollowXY=function(t){var e=DirUtil.get8Dir(this.entity,t),i=DirUtil.getGridByDir(e,this.params.followDis/MapBase.CELL_SIZE,t);return i},e.prototype.Follow=function(){return this.isMoveing()?!0:this.isFaraway()?(this.startFollow(this.params.followHandle,this.params.followMasterHandle),!0):void 0},e.prototype.getFollowTarget=function(){var t;return this.params.followHandle&&(t=LogicSys.ins().getEntityByHandle(this.params.followHandle)),!t&&this.params.followMasterHandle&&(t=LogicSys.ins().getMainRoleByMasterHandle(this.params.followMasterHandle)),t},e.prototype.startAlive=function(e){void 0===e&&(e=0),t.prototype.startAlive.call(this),this.entity.alive(e),this.startAttack()},e.prototype.startDie=function(e,i){void 0===e&&(e=0),t.prototype.startDie.call(this,e,i),this.entity.closeChatBubble(),this.playAction(EntityAction.DIE),this.resetTarget()},e.prototype.useSkillComplete=function(t,e,i,n,a){var o=LogicSys.ins().getEntityByHandle(e);o&&!o.isDead()&&SkillSys.ins().sendUseSkill(t,e,i,n,Timer.ins().getEgretTimer()-a)},e.prototype.useSkillComplete1=function(t,e,i,n,a){SkillSys.ins().sendUseSkill(t,e,i,n,Timer.ins().getEgretTimer()-a)},e.prototype.playMyEntityAction=function(t,e,i){void 0===i&&(i=0),this.stopMove(),t.commoncd&&(this.nextActionTick=Timer.ins().getEgretTimer()+1e3*this.entity.getAtkTime());var n=t.actionParam[i].actionType;n&&(this.setDir(e),this.playAction(n,!1),this.prevTargetHandle=e.handle),this.updateSkillCd(t.id)},e.prototype.playOtherEntityAction=function(t,e,i){void 0===i&&(i=0);var n=t.actionParam[i].actionType;n&&(this.setDir(e),this.entity.playAction(n,!1))},e.prototype.setDir=function(t){t!=this.entity&&this.entity.setDir(GFunc.getDirBy2Point(this.entity,t))},e.prototype.playActionMovie=function(t,e,i,n,a,o,s){void 0===n&&(n=null),void 0===a&&(a=null),void 0===o&&(o=!0),void 0===s&&(s=!1);var r=new SkillEditorData,u=t.actionParam[e].effectId;switch(r.effectId=u,r.configs=Cfg.getSkillEditorConfig(u),r.isShow=o,r.canPlaySound=s,r.sender.copy(this.entity),r.hitFun=n,a&&r.setLayerByLayer(a),t.targetType){case TargetType.Friend:n(),u&&(r.target.x=this.entity.x,r.target.y=this.entity.y,SkillEditor.ins().play(r));break;case TargetType.Enemy:if(u){r.target.x=i.x,r.target.y=i.y,SkillEditor.ins().play(r);var h=t.id;SkillSys.ins().monsterSkillIds[h]=t}else n()}},e.prototype.isFaraway=function(t){if(void 0===t&&(t=null),t=t||this.getFollowTarget()){var e=this.params.followRadius*this.params.followRadius,i=MathUtil.getDistanceX2ByObject(this.entity,t);return i>e}return!1},e.prototype.setEnemy=function(t){this.enemyType=t},e.prototype.getCastTargetHandle=function(t){var e=0;switch(t.castType){case CastType.None:case CastType.Friend:case CastType.Self:case CastType.SelfByHp:e=this.entity.handle;break;case CastType.Enemy:e=this.params.targetHandle}return e},e.prototype.isNeedCastTarget=function(t){return t.castType!=CastType.None},e.prototype.isSameGrid=function(t,e){return t.x/MapBase.CELL_SIZE>>0==e.x/MapBase.CELL_SIZE>>0&&t.y/MapBase.CELL_SIZE>>0==e.y/MapBase.CELL_SIZE>>0},e.prototype.isSamePoint=function(t){return Math.abs(t.x-this.entity.x)>>0<1&&Math.abs(t.y-this.entity.y)>>0<1},e.prototype.startPickItem=function(e){void 0===e&&(e=null),t.prototype.startPickItem.call(this,e),this.sortItem(),this.update()},e.prototype.PickItem=function(){var t=this,e=this.params.pickItems.length;if(!(e>0))return this.setAIState(this.prevState),this.update();for(var i=void 0,n=e-1;n>=0;n--){var a=this.params.pickItems[n].handle,o=LogicSys.ins().getItemByHandle(a);if(o){if(LogicSys.ins().canItemPick(o)){i=o;break}}else this.params.pickItems.splice(n,1)}if(!i)return this.setAIState(this.prevState),this.update();if(!this.entity.isBianShenStatus()){var s=i.item.handle;return this.startMove(i,function(){var e=LogicSys.ins().getItemByHandle(s);e&&(t.sendPickItem(t.getPickXYItems(e,t.params.pickRadio)),t.sortItem())}),!0}this.sendPickItem(this.getPickXYItems(this.entity,99999))},e.prototype.getPickXYItems=function(t,e){void 0===e&&(e=0);var i=[],n=new egret.Rectangle;n.x=t.x-e,n.y=t.y-e,n.width=2*e,n.height=2*e;for(var a=[],o=BagSys.ins().getSurplusCount(),s=0,r=this.params.pickItems;s<r.length;s++){var u=r[s],h=LogicSys.ins().getItemByHandle(u.handle);if(h){var p=LogicSys.ins().getNeedBagCount(h);n.contains(h.x,h.y)?0==p?i.push(h):p>0&&o>0?(i.push(h),o--):a.push(u):a.push(u)}}return this.params.pickItems=a,i},e.prototype.sendPickItem=function(t){for(var e=t instanceof Array?t:[t],i=0;i<e.length;i++){var n=e[i];this.removePickItem(n),this.sendPickUpItem(n)}},e.prototype.sendPickUpItem=function(t){t.hasPicked=!0,LogicSys.ins().sendPickUpItem(t)},e.prototype.removePickItem=function(t){for(var e=this.params.pickItems.length,i=0;e>i;i++)if(t.item.handle==this.params.pickItems[i].handle){this.params.pickItems.splice(i,1);break}},e.prototype.removePickItems=function(){this.params.pickItems.length=0},e.prototype.sortItem=function(){for(var t=0,e=this.params.pickItems;t<e.length;t++){var i=e[t];i.dis=MathUtil.getDistanceX2ByObject(this.entity,i)}SortUtil.sortOn(this.params.pickItems,["dis"],[SortType.down])},e.prototype.canPickItem=function(){var t=!1;if(this.getPickItemCount()>0)if(BagSys.ins().getSurplusCount()>0)t=!0;else for(var e=0,i=this.params.pickItems;e<i.length;e++){var n=i[e];if(n.itemId<CurType.max||0!=n.type){t=!0;break}}else t=!1;return t},e.prototype.getNewTarget=function(){return this.getCurTarget()},e.prototype.getCurTarget=function(){return this.params.targetHandle?LogicSys.ins().getEntityByHandle(this.params.targetHandle):null},e.prototype.getNextTarget=function(){var t,e=LogicSys.ins().getEntityByHandle(this.params.targetHandle);return t=!e||e.isDead()?this.getNewTarget():e},e.prototype.getPickItem=function(){return this.params.pickItems.pop()},e.prototype.getPickItemCount=function(){return this.params.pickItems.length},e.prototype.setSkillData=function(t){this.skillDatas=t.concat()},e.prototype.getNextSkill=function(){for(var t,e=this.skillDatas,i=0,n=e;i<n.length;i++){var a=n[i];a.skillConfig.actionParam[0].actionType&&a.isAct&&(t?t.skillCDTick<=this.nextActionTick&&a.skillCDTick<=this.nextActionTick?a.skillConfig.priority<t.skillConfig.priority&&(t=a):t.skillCDTick>this.nextActionTick&&a.skillCDTick<=this.nextActionTick&&(t=a):t=a)}return t},e.prototype.hasSkill=function(){return this.skillDatas.length>0},e.prototype.playAtk=function(){this.nextActionTick=0,this.entity.resetAtking(),this.Atk()},e.prototype.isMoveing=function(){return this.mover&&this.mover.moving},e.prototype.updateTick=function(t){this.mover.updateTick(t)},e.prototype.startAttack=function(e){void 0===e&&(e=null),this.stopMove(),t.prototype.startAttack.call(this,e),e&&this.update()},e.prototype.startAtked=function(e){var i=LogicSys.ins().getEntityByHandle(e);i&&!EntityType.isYongbing(i.entityType)&&t.prototype.startAtked.call(this,e)},e.prototype.startStand=function(){this.playAction(EntityAction.STAND),t.prototype.startStand.call(this)},e.prototype.startShunyi=function(e){t.prototype.startShunyi.call(this,e),this.stopAndStand(),this.resetCaiji(),this.entity.x=e.x,this.entity.y=e.y,(this.params.followHandle||this.params.followMasterHandle)&&this.startFollow(this.params.followHandle,this.params.followMasterHandle)},e.prototype.startMoveToXY=function(e,i,n){void 0===i&&(i=-1),void 0===n&&(n=null),-1==i&&(i=FbSys.ins().fbId),t.prototype.startMoveToXY.call(this,e,i,n),-1!=this.params.fbId&&FbSys.ins().fbId!=i?LogicSys.ins().sendEnterFb(i):this.update()},e.prototype.MoveToXY=function(){var t=this;if(FbSys.ins().fbId==this.params.fbId&&this.entity){this.params.fbId=-1;var e=this.params.moveToXYCallback;if(Math.abs(this.params.moveP.x-this.entity.x)<1&&Math.abs(this.params.moveP.y-this.entity.y)<1&&e)return void e();var i=new XY;if(MapContainer.ins().checkWalkableByPixel(this.params.moveP.x,this.params.moveP.y))i.x=this.params.moveP.x,i.y=this.params.moveP.y;else{var n=MapContainer.ins().getNearestAroundXY(this.params.moveP,this.entity);i.x=n.x,i.y=n.y}this.entity==LogicSys.ins().centerEntity&&LogicSys.ins().setOnClickMovie(!0,i),this.startNone(),this.mustMove(i,function(){t.entity==LogicSys.ins().centerEntity&&LogicSys.ins().setOnClickMovie(!1,i),t.stopMoveToXy(),e&&e()})}},e.prototype.startMove=function(t,e){void 0===e&&(e=null),this.entity.isAtking()||this.entity.isDead()||this.mustMove(t,e)},e.prototype.mustMove=function(t,e){if(void 0===e&&(e=null),this.isSamePoint(t))return void(e&&e());var i=this.getPath(t,this.entity);!this.entity.isDead()&&this.entity.canMove()&&i&&i.length&&(this.mover.reset(),this.path=i,this.playAction(EntityAction.RUN,!0),this.resetTarget(),this.tar.x=this.path[this.path.length-2],this.tar.y=this.path[this.path.length-1],MapContainer.ins().capture(this.tar.x,this.tar.y,this.entity.handle),this.movoNext(),this.mover.setCompleteFunc(this.movoNext,this),this.onMoveComplete=e)},e.prototype.movoNext=function(){if(this.path&&this.path.length){var t=new XY;t.x=this.path.shift(),t.y=this.path.shift(),this.entity.setDir(GFunc.getDirBy2Point(this.entity,t));var e=MathUtil.getTimeFromSpeed(this.entity,t,this.entity.getProp(AttrType.atMvSpeed));this.mover.moveTo(Timer.ins().getEgretTimer(),t,e),this.sendMoveEntity(t)}else{this.path=null,this.onMoveComplete&&this.onMoveComplete();var i=this.updateAIAndResetNextTick();i||this.playAction(EntityAction.STAND)}},e.prototype.resetMove=function(){this.isMoveing()&&(this.path&&this.path.length?this.mustMove(new XY(this.path[this.path.length-2],this.path[this.path.length-1]),this.onMoveComplete):this.mustMove(this.mover.getToXY(),this.onMoveComplete))},e.prototype.resetTarget=function(){-1!=this.tar.x&&-1!=this.tar.y&&(MapContainer.ins().capture(this.tar.x,this.tar.y),this.tar.x=-1,this.tar.y=-1)},e.prototype.stopMove=function(){this.mover.moving&&(this.mover.reset(),this.sendMoveEntity(this.entity))},e.prototype.stopAndStand=function(){this.stopMove(),this.playAction(EntityAction.STAND)},e.prototype.getPath=function(t,e){return MapContainer.ins().getPath(t,e)},e.prototype.playAction=function(t,e){void 0===e&&(e=!1);var i=this.entity.getAction(),n=e;return i!=EntityAction.DIE&&(t==EntityAction.DIE?(n=!0,this.stopMove()):EntityAction.isAtkAction(t)?(this.stopMove(),n=!0):t==EntityAction.ATKED?this.entity.isAtking()||(n=!0):t==EntityAction.RUN?this.entity.isAtking()||(n=!0):t==EntityAction.STAND&&(this.entity.isAtking()||(this.stopMove(),n=!0))),n&&this.entity.playAction(t,e),n},e.prototype.onAtkedEnd=function(t){if(t!=EntityAction.DIE&&t!=EntityAction.DIE){var e=!1;EntityAction.isAtkAction(t)&&(e=this.updateAIAndResetNextTick()),e||(this.isMoveing()?this.playAction(EntityAction.RUN):this.playAction(EntityAction.STAND))}},e.prototype.getGuaJi=function(){return this.isGuaji},e.prototype.CaiJi=function(){if(!this.entity.isCaiJiing()&&!this.isMoveing()){var t=LogicSys.ins().getEntityByHandle(this.params.caiJihandle),e=MapBase.CELL_SIZE;if(t&&t.isBeCaiJi()){var i=1.5*(e*e+e*e);if(MathUtil.getDistanceX2ByObject(this.entity,t)>i){var n=MapContainer.ins().getNearestAroundXY(t,this.entity);this.startMove(n)}else this.entity.setDir(DirUtil.get8Dir(this.entity,t)),this.entity.setCaiJiing(!0),this.entity.masterHandle==Actor.ins().handle&&LogicSys.ins().sendCollectionEntity(t.handle)}else{var a=this.params.caijiType;t=LogicSys.ins().getNearestCaijiById(this.entity,a),t&&(this.params.caiJihandle=t.handle,this.update())}}},e.prototype.removeSKillBySkillId=function(t){for(var e=0;e<this.skillDatas.length;e++){var i=this.skillDatas[e];i.skillId==t&&this.skillDatas.splice(e,1)}},e.prototype.addSkillData=function(t){this.skillDatas.push(t)},e.prototype.checkAttrCondition=function(t){var e=!0,i=t.skillConfig.attrCondition;return i.length>0&&this.entity.getProp(i[0])>this.entity.getProp(i[1])?!1:e},e.prototype.resetCaiji=function(){Actor.ins().handle==this.entity.masterHandle&&0!=this.params.caiJihandle&&(this.entity.setCaiJiing(!1),LogicSys.ins().sendCollectionEntity(0)),t.prototype.resetCaiji.call(this)},e.prototype.setAIState=function(e){t.prototype.setAIState.call(this,e),this.isAIState(AIState.CaiJi)&&this.entity.isCaiJiing()&&this.resetCaiji()},e.prototype.destruct=function(){this.mover.reset(),this.onMoveComplete=null,this.tar.x=this.tar.y=-1,this.nextActionTick=0,this.prevTargetHandle=0,this.prevSkillId=0,this.skillDatas=[],t.prototype.destruct.call(this)},e}(AI);__reflect(AIBase.prototype,"AIBase"),window.AIBase=AIBase;var Entity=function(t){function e(){var e=t.call(this)||this;e.index=0,e._entityType=-1,e.job=0,e.teamId=0,e.AI=null,e.defaultHeight=136,e.myHeight=136,e._mountHeight=0,e.action="",e.effs=[],e.titleArr=[],e.bubbleTimer=-1,e.bianShenEndTick=0,e.bianShenCDTick=0,e._isShowBody=!0,e._isShowWing=!0,e.bodystrengthen=0,e.weaponstrengthen=0,e.juhunType=0,e.bianshenId=0,e._isAtking=!1,e._isCaiJiing=!1,e._isBeCaiJi=!1,e.scale=1,e._isShowHunduBar=!1,e._isShowHudun=!0,e.cfState=!1,e.btmList=[],e.syncFrameMC=[],e.AI=new AIBase,e.AI.setEntity(e),e.touchChildren=!1,e.action=EntityAction.STAND,e._dir=5,e._shadow=new eui.Image,e._shadow.source=ResMgr.getYingziRes(),e._shadow.touchEnabled=!1,e._shadow.once(egret.Event.COMPLETE,function(){e._shadow.anchorOffsetX=e._shadow.width>>1,e._shadow.anchorOffsetY=e._shadow.height>>1},e),e._effContainerDown=new egret.DisplayObjectContainer,e.addChild(e._effContainerDown),e._bodyContainer=new egret.DisplayObjectContainer,e.addChild(e._bodyContainer),e._effContainerUp=new egret.DisplayObjectContainer,e.addChild(e._effContainerUp),e.iniHpBar(),e._nameGroup=new eui.Group;var i=new eui.HorizontalLayout;return i.horizontalAlign="center",i.verticalAlign="middle",e._nameGroup.layout=i,e.addChild(e._nameGroup),e.groupTouXian=new eui.Group,e.mcTouXian=e.getMovieClip(),e.mcTouXian.y=9,e.mcTouXian.x=20,e.mcTouXian.scaleX=e.mcTouXian.scaleY=.8,e.groupTouXian.addChild(e.mcTouXian),e._nameGroup.addChild(e.groupTouXian),e._nameTxt=new eui.Label,e._nameTxt.fontFamily="黑体",e._nameTxt.textAlign="center",e._nameTxt.size=16,e._nameTxt.width=240,e._nameTxt.height=e._nameTxt.size,e._nameTxt.stroke=1,e._nameTxt.strokeColor=0,e._nameTxt.visible=!0,e._nameTxt.verticalAlign="bottom",e._nameTxt.touchEnabled=!1,e._nameGroup.addChild(e._nameTxt),e.updateNameGroupSize(),e.titleArr.push(e._hpBar),e.titleArr.push(e._nameGroup),e.setProp(AttrType.atHp,1),e.setProp(AttrType.atHpMax,1),e._body=e.getMovieClip(),e._bodyContainer.addChild(e._body),e._disOrder=[],e._disOrder[McOrder.BODY]=e._body,e.mcOrder=GConst.mcOrderJob[e.job],e}return __extends(e,t),e.prototype.initWeapon=function(){this._weapon=this.getMovieClip(),this._bodyContainer.addChild(this._weapon),this._disOrder[McOrder.WEAPON]=this._weapon},e.prototype.initGuanghuan=function(){this._guanghuan=this.getMovieClip(),this._guanghuan.x=this.x,this._guanghuan.y=this.y,MapContainer.ins().addEffectToDown2(this._guanghuan)},e.prototype.initWing=function(){this._wing=this.getMovieClip(),this._bodyContainer.addChild(this._wing),this._disOrder[McOrder.WING]=this._wing},e.prototype.initShengLing=function(){this._shengLing=this.getMovieClip(),this._bodyContainer.addChild(this._shengLing),this._disOrder[McOrder.SHENGLING]=this._shengLing},e.prototype.initJuhun=function(){this._juhun=this.getMovieClip(),this._bodyContainer.addChild(this._juhun),this._disOrder[McOrder.JUHUN]=this._juhun},e.prototype.initMount=function(){this._mount=this.getMovieClip(),this._bodyContainer.addChild(this._mount),this._mount2=this.getMovieClip(),this._bodyContainer.addChild(this._mount2),this._disOrder[McOrder.MOUNT]=this._mount,this._disOrder[McOrder.MOUNT2]=this._mount2},e.prototype.initFoot=function(){this._foot=this.getMovieClip(),this._bodyContainer.addChild(this._foot),this._disOrder[McOrder.FOOT]=this._foot},e.prototype.initHudun=function(){this._hudun=this.getMovieClip(),this._effContainerUp.addChild(this._hudun)},e.prototype.iniHpBar=function(){this._hpBar=new eui.ProgressBar,this._hpBar.touchEnabled=!1,this._hpBar.touchChildren=!1,this._hpBar.skinName="bloodBarSkin",this._hpBar.anchorOffsetX=this._hpBar.width>>1,this._hpBar.direction=eui.Direction.LTR,this._hpBar.slideDuration=1200,this.addChild(this._hpBar)},e.prototype.setWingVisible=function(t){this._isShowWing=t,this._wing&&this._wing.visible!=t&&(this._wing.visible=t,this.readyUpdateMC())},Object.defineProperty(e.prototype,"isShowWing",{get:function(){return this._isShowWing&&this.hasWing},enumerable:!0,configurable:!0}),e.prototype.getEntityHeight=function(){var t=this.hasMount?this._mountHeight:0;return this.defaultHeight-t},Object.defineProperty(e.prototype,"hasWing",{get:function(){return""!=this.data.wingFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasMount",{get:function(){return this.data&&""!=this.data.mountFileName},enumerable:!0,configurable:!0}),e.prototype.setAI=function(t){this.AI.destruct(),t.setEntity(this),this.AI=t},e.prototype.setName=function(t,e){void 0===e&&(e=16777215),this.entityName=t,this.entityNameColor=e,this.updateName(),this.updatePos()},e.prototype.updateName=function(){this._nameTxt.textFlow=this.getTotleNaemTF()},e.prototype.getName=function(){return this.entityName},e.prototype.getTotleNaemTF=function(){return addColorTF(this.entityName,this.entityNameColor)},e.prototype.updateNameGroupSize=function(){this._nameGroup.anchorOffsetX=this._nameGroup.width>>1},e.prototype.setTeam=function(t){this.teamId=t},e.prototype.setHp=function(t,e){e&&(this._hpBar.maximum=Math.floor(e)),0>t&&(t=0),t>e&&(t=e),this._hpBar.value=Math.floor(t)},e.prototype.setHPBarVisible=function(t){this._hpBar.visible=t},e.prototype.setHpAndNameVisible=function(t){(this._hpBar.visible!=t||this._nameGroup.visible!=t)&&(this.setHPBarVisible(t),this._nameGroup.visible=t,this.updatePos())},e.prototype.getHP=function(){return this.getProp(AttrType.atHp)},e.prototype.getHpMax=function(){return this.getProp(AttrType.atHpMax)},e.prototype.setEntityScale=function(t){this.scale=this._bodyContainer.scaleX=this._bodyContainer.scaleY=t},e.prototype.setAction=function(t){this.action=t},e.prototype.playAction=function(t,e){void 0===e&&(e=!1);var i=EntityAction.isAtkAction(t),n=this.action;if(e||this.action!=t||i){if(this.action=t,this._isAtking=i,this._body.clearComFun(),Timer.ins().remove(this.onAtkEnd,this),n==t&&t==EntityAction.RUN)return;this.readyUpdateMC()}},e.prototype.getAtkTime=function(){return Math.max(.75,500/(500+.25*this.getProp(AttrType.atAtkSpeed)))},e.prototype.getAction=function(){return this.action},e.prototype.isDead=function(){return this.action==EntityAction.DIE||0==this.getProp(AttrType.atHp)},e.prototype.isAlive=function(){return this.action!=EntityAction.DIE&&this.getProp(AttrType.atHp)>0},e.prototype.isAtking=function(){return this._isAtking},e.prototype.resetAtking=function(){this._isAtking=!1},e.prototype.setCfState=function(t){this.cfState=t},e.prototype.startSpeedShadow=function(){EntityType.isMainRole(this.entityType)&&Timer.ins()["do"](0,105,0,this.updateSpeedShadow,this)},e.prototype.stopSpeedShadow=function(){Timer.ins().remove(this.updateSpeedShadow,this),this.AI.isMoveing()&&this.playMC()},e.prototype.updateSpeedShadow=function(){var t=this;if(this.parent){this.stopMC();var e=this.getBounds(),i=new egret.RenderTexture;i.drawToTexture(this._bodyContainer,e);var n=this.btmList.pop()||new egret.Bitmap;n.texture=i,n.x=this.x+e.x,n.y=this.y+e.y,this.parent.addChild(n);var a=egret.Tween.get(n);n.alpha=.7,a.wait(200).to({alpha:0},150).call(function(){DisUtil.remove(n),n.$bitmapData&&n.$bitmapData.$dispose(),t.btmList.length<10&&t.btmList.push(n)},this)}},e.prototype.readyUpdateMC=function(){this.data&&this.data.bodyFileName&&-1!=this._entityType&&Timer.ins().doLast(this.updateMC,this)
},e.prototype.stopMC=function(){this._body.stop(),this._wing&&this._wing.stop(),this._weapon&&this._weapon.stop(),this._mount&&(this._mount.stop(),this._mount2.stop())},e.prototype.playMC=function(){if(this.AI.isMoveing()){var t=this.rate;this._body.rate=t,this._mount&&(this._mount.rate=t,this._mount2.rate=t)}this._body.play(),this._wing&&this._wing.play(),this._weapon&&this._weapon.play(),this._mount&&(this._mount.play(),this._mount2.play())},e.prototype.updateMC=function(){this._body.stop(),this._body.setDir(this._dir),this._body.rate=this.rate;var t=-1,e=null;if(EntityAction.isOnceAction(this.action))if(t=1,EntityAction.isAtkAction(this.action)){var i=1e3*this.getAtkTime();Timer.ins()["do"](i,0,1,this.onAtkEnd,this,TimerType.LAST)}else e=this.onAtkEnd.bind(this);this._isShowBody&&(this._body.playFile(this.getBodyFileName(this.data.bodyFileName),t,e,!1),this._body.hasEventListener(egret.Event.RENDER)||this._body.addEventListener(egret.Event.RENDER,this.onBodyEnterFrame,this)),this.updateBiansheBody(t,e),this.updateWingMC(),this.updateWeaponMC(),this.updateJuhunTypeMC(),this.updateMountMC(),this.updateGuanghuanMC(),this.updateShenglingMC(),this.updateFootMC(),this.syncFrameMC=[this._weapon,this._wing];var n=this.mcOrder[this.dir];if(n)for(var a=n.length,o=0;a>o;o++){var s=n[o],r=this._disOrder[s];r&&this._bodyContainer.addChild(r)}},e.prototype.onBodyEnterFrame=function(){var t=this._body.currentFrame;this._body.removeEventListener(egret.Event.RENDER,this.onBodyEnterFrame,this);for(var e=0,i=this.syncFrameMC;e<i.length;e++){var n=i[e];n&&n.visible&&n.totalFrames>0&&n.currentFrame!=t&&n.gotoAndPlay(t,0)}},e.prototype.updateBiansheBody=function(t,e){},e.prototype.updateWingMC=function(){this.isShowWing&&this._isShowBody?(this._wing||this.initWing(),this._wing.playFile(this.getWingFileName(),-1,null,!1),this._wing.setDir(this._dir)):this._wing&&(this._wing.visible=!1)},e.prototype.updateWeaponMC=function(){var t=this.data.weaponFileName,e=!!t&&!this.isDead()&&this._isShowBody;e?(this._weapon||this.initWeapon(),this._weapon.playFile(this.getWeaponFileName(t),-1,null,!1),this._weapon.setDir(this._dir)):this._weapon&&(this._weapon.visible=!1)},e.prototype.updateJuhunTypeMC=function(){this.juhunType&&this._isShowBody?(this._juhun||this.initJuhun(),this._juhun.playFile(this.getJuhunFileName(),-1,null,!1),this._juhun.setDir(this._dir)):this._juhun&&(this._juhun.visible=!1)},e.prototype.updateMountMC=function(){this.hasMount&&this._isShowBody?(this._mount||this.initMount(),this._mount.rate=this.rate,this._mount2.rate=this._mount.rate,this._mount.playFile(ResMgr.getMountSource(this.data.mountFileName,this.dir,this.action),-1,null,!1),this._mount.setDir(this._dir),this._mount2.playFile(ResMgr.getMount2Source(this.data.mountFileName,this.dir,this.action),-1,null,!1),this._mount2.setDir(this._dir)):this._mount&&(this._mount2.visible=this._mount.visible=!1)},e.prototype.updateGuanghuanMC=function(){var t=this.data.guanghuanFileName;t&&this._isShowBody?(this._guanghuan||this.initGuanghuan(),this._guanghuan&&(this._guanghuan.visible=!0),~this._guanghuan.name.indexOf(t)||this._guanghuan.playFile(ResMgr.getFootSource(t),-1)):this._guanghuan&&(this._guanghuan.visible=!1)},e.prototype.updateShenglingMC=function(){var t=this.data.shengLingFileName,e=t&&!this.isDead()&&this._isShowBody;e?(this._shengLing||this.initShengLing(),this._shengLing.playFile(this.getShengLingFileName(t),-1,null,!1),this._shengLing.setDir(this._dir)):this._shengLing&&(this._shengLing.visible=!1)},e.prototype.updateFootMC=function(){var t=this.data.footFileName;t&&this._isShowBody?(this._foot||this.initFoot(),this._foot.playFile(ResMgr.getFootSource(t),-1,null,!1),this._foot.setDir(this._dir)):this._foot&&(this._foot.visible=!1)},e.prototype.getBodyFileName=function(t){return ResMgr.getEntityBodyRes(this.entityType,t,this.getDir(),this.action)},e.prototype.getWeaponFileName=function(t){return ResMgr.getEntityWeaponRes(this.entityType,t,this.getDir(),this.action,this.hasWing,this.weaponstrengthen)},e.prototype.getShengLingFileName=function(t){return ResMgr.getEntityShengLingRes(this.entityType,t,this.getDir(),this.action,this.hasWing)},e.prototype.getHundunFileName=function(){return ResMgr.getEntityHuDunRes(this.entityType,this.data.hudunFileName)},e.prototype.getWingFileName=function(){return ResMgr.getEntityWingRes(this.entityType,this.data.wingFileName,this.getDir(),this.action)},e.prototype.getJuhunFileName=function(){return ResMgr.getEntityJuhunRes(this.entityType,this.getDir(),this.action,this.hasWing,this.job,this.juhunType,this.data.weaponFileName)},e.prototype.onAtkEnd=function(){this._isAtking=!1,this.AI.onAtkedEnd(this.action)},e.prototype.canMove=function(){return!this.isDead()&&!this.hasCantMoveBuff()&&!this.cfState},e.prototype.canAtk=function(){return!this.isDead()&&!this.hasCantAtkBuff()&&!this.cfState},e.prototype.canBeAtk=function(){return!this.isDead()&&!this.hasCantAtkBuff()},e.prototype.canBeAtked=function(){return!this.isDead()&&!this.hasCantBeAtkedBuff()},e.prototype.canBianShen=function(){return!(this.isDead()||this.hasCantBianShenBuff()||EntityType.isBianshen(this.entityType)||this.cfState)},e.prototype.updateTick=function(t){if(this.AI.updateTick(t),!this.isDead()){var e=Math.floor(this.x/MapBase.CELL_SIZE),i=Math.floor(this.y/MapBase.CELL_SIZE),n=this.alpha;MapContainer.ins().checkAlpha(e,i)?1==n&&(this.alpha=.6):.6==n&&(this.alpha=1)}this.updateChatBubble()},e.prototype.updateBuffPos=function(){for(var t=0,e=this.effs;t<e.length;t++){var i=e[t],n=i.buffId,a=Cfg.getConfig(EffectsConfig,n);a.pos?i.y=-this.myHeight*this.scale:i.y=0}},e.prototype.updatePos=function(){for(var t=0-this.myHeight,e=0,i=this.titleArr;e<i.length;e++){var n=i[e];n.parent&&n.visible&&(t-=n.height+3,n.y=t)}this.updateBuffPos(),this.chatBubble&&(this.chatBubble.y=-this.myHeight-20),this._hunduBar&&(this._hunduBar.y=this._hunduBar.y-4)},e.prototype.setBubble=function(t,e){void 0===e&&(e=10),this.chatBubble||(this.chatBubble=new ChatBubble,this.addChild(this.chatBubble)),this.chatBubble.visible=!0,this.chatBubble.setChatContent(t),e>0?this.bubbleTimer=Timer.ins().getTimer()+1e3*e:this.bubbleTimer=e,this.updatePos()},e.prototype.closeChatBubble=function(){this.chatBubble&&(this.chatBubble.visible=!1,this.chatBubble.setChatContent("")),this.bubbleTimer=0},e.prototype.updateChatBubble=function(){0!=this.bubbleTimer&&(-1==this.bubbleTimer?this.closeChatBubble():this.bubbleTimer<Timer.ins().getTimer()&&this.closeChatBubble())},e.prototype.setClickEnable=function(t){t?(this.hasEventListener(egret.TouchEvent.TOUCH_BEGIN)||this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTap,this),this.touchChildren=this.touchEnabled=!0):(this.touchChildren=this.touchEnabled=!1,this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTap,this))},e.prototype.onTap=function(t){this._body.hitTestPoint(t.stageX,t.stageY)&&(this.canBeAtk()&&LogicSys.ins().atkTargetByHandle(this.handle),t.stopImmediatePropagation(),LogicSys.ins().patchEntityClick(this))},e.prototype.addAtkedEffect=function(t){var e=Cfg.getConfig(SkillsConfig,t).atkedEffectName;if(""!=e){var i=ObjPool.pop(MC);i.y=0-this.myHeight/2,i.visible=!1,i.playFile(ResMgr.getAtkedResource(e),1,function(){ObjPool.push(i)}),this.addChild(i)}},e.prototype.addEffect=function(t){var e=ObjPool.pop(MC);e.visible=!1,e.playFile(t,1,function(){ObjPool.push(e)}),this.addChild(e)},e.prototype.isHaveBuff=function(t){for(var e=0;e<this.effs.length;e++){var i=this.effs[e];if(i.buffId==t)return!0}return!1},e.prototype.addBuff=function(t){var e=Cfg.getConfig(EffectsConfig,t),i=new MCBuff;if(i.buffId=t,e.show){var n=e.effName;i.playFile(ResMgr.getBuffResource(n),-1),e.layer?this._effContainerUp.addChild(i):this._effContainerDown.addChild(i)}this.effs.push(i),this.updateBuffPos()},e.prototype.removeBuff=function(t){for(var e=0;e<this.effs.length;e++){var i=this.effs[e];if(i.buffId==t){this.removeABuff(i),this.effs.splice(e,1);break}}},e.prototype.removeABuff=function(t){DisUtil.remove(t),t.stop()},e.prototype.removeBuffs=function(){for(var t=0;t<this.effs.length;t++)this.removeABuff(this.effs[t]);this.effs.length=0},e.prototype.hasCantMoveBuff=function(){for(var t=0,e=this.effs;t<e.length;t++){var i=e[t],n=Cfg.getConfig(EffectsConfig,i.buffId),a=n.args;if(n.type==BuffType.AdditionalState&&(a.i==BuffEffectType.DING_SHEN||a.i==BuffEffectType.HUN_MI))return!0}return!1},e.prototype.hasCantAtkBuff=function(){for(var t=0,e=this.effs;t<e.length;t++){var i=e[t],n=Cfg.getConfig(EffectsConfig,i.buffId),a=n.args;if(n.type==BuffType.AdditionalState&&a.i==BuffEffectType.HUN_MI)return!0}return!1},e.prototype.hasCantBeAtkedBuff=function(){for(var t=0,e=this.effs;t<e.length;t++){var i=e[t],n=Cfg.getConfig(EffectsConfig,i.buffId),a=n.args;if(n.type==BuffType.AdditionalState&&a.i==BuffEffectType.BA_TI)return!0}return!1},e.prototype.hasCantBianShenBuff=function(){for(var t=0,e=this.effs;t<e.length;t++){var i=e[t],n=Cfg.getConfig(EffectsConfig,i.buffId),a=n.args;if(n.type==BuffType.AdditionalState&&a.i==BuffEffectType.HUN_MI)return!0}return!1},e.prototype.setProps=function(e){t.prototype.setProps.call(this,e),this.setHp(this.getProp(AttrType.atHp),this.getProp(AttrType.atHpMax)),this.setHuDunBar(this.getProp(AttrType.atShenYouShield),this.getProp(AttrType.atShenYouShieldMax))},e.prototype.setProp=function(e,i){t.prototype.setProp.call(this,e,i),e==AttrType.atHp?this.setHp(i):e==AttrType.atHpMax?this.setHp(this.getHP(),i):e==AttrType.atShenYouShieldTagNum?this.setYinJiComponent(this.getProp(AttrType.atShenYouShieldTag),i):e==AttrType.atShenYouShieldTag?this.setYinJiComponent(i,this.getProp(AttrType.atShenYouShieldTagNum)):e==AttrType.atShenYouShieldMax?this.setHuDunBar(this.getProp(AttrType.atShenYouShield),i):e==AttrType.atShenYouShield&&this.setHuDunBar(i,this.getProp(AttrType.atShenYouShieldMax))},e.prototype.setHuDunBar=function(t,e){if(this._isShowHunduBar){if(!this._hunduBar){this._hunduBar=new eui.ProgressBar,this._hunduBar.touchEnabled=!1,this._hunduBar.touchChildren=!1,this._hunduBar.skinName="bloodBarSkin6",this._hunduBar.anchorOffsetX=this._hunduBar.width>>1,this._hunduBar.direction=eui.Direction.LTR,this._hunduBar.slideDuration=1200,this.addChild(this._hunduBar);var i=this.yinJiComponent?1:0;this.titleArr.splice(i,0,this._hunduBar),this.updatePos()}this._hunduBar.maximum=Math.floor(e),this._hunduBar.value=Math.floor(t)}},e.prototype.setShowHuDunBar=function(t){this._isShowHunduBar=t,this.setHuDunBar(this.getProp(AttrType.atShenYouShield),this.getProp(AttrType.atShenYouShieldMax)),this.setYinJiComponent(this.getProp(AttrType.atShenYouShieldTag),this.getProp(AttrType.atShenYouShieldTagNum))},e.prototype.setYinJiComponent=function(t,e){this._isShowHunduBar&&(this.yinJiComponent||(this.yinJiComponent=new ShouYouYinJiComponent,this.yinJiComponent.anchorOffsetX=this.yinJiComponent.width>>1,this.addChild(this.yinJiComponent),this.titleArr.splice(0,0,this.yinJiComponent),this.updatePos()),this.yinJiComponent.setValue(t,e))},e.prototype.getMyHeight=function(){return this.myHeight},Object.defineProperty(e.prototype,"rate",{get:function(){var t=1;return EntityAction.isAtkAction(this.action)?t=1/this.getAtkTime():this.action==EntityAction.RUN&&(t=this.getProp(AttrType.atMvSpeed)/250),t},enumerable:!0,configurable:!0}),e.prototype.getDir=function(){return this._dir},e.prototype.setDir=function(t){this._dir!=t&&(this.dir=t,this.readyUpdateMC())},e.prototype.getBodyScale=function(){return this._bodyContainer.scaleY},e.prototype.getJob=function(){return this.job},e.prototype.setJob=function(t){this.job=t,this.mcOrder=GConst.mcOrderJob[this.job]},e.prototype.getCfgId=function(){return 0},Object.defineProperty(e.prototype,"entityType",{get:function(){return this._entityType},set:function(t){this._entityType=t,this.action=EntityAction.STAND,this.removeBuffs()},enumerable:!0,configurable:!0}),e.prototype.setBianShen=function(t,e,i){this.bianshenId=t,this.bianShenEndTick=e,this.bianShenCDTick=i},e.prototype.isBianShenStatus=function(){return this.bianShenEndTick>Timer.ins().getTimer()},e.prototype.getBianshenId=function(){return this.bianshenId},Object.defineProperty(e.prototype,"mapX",{get:function(){return this.x/MapBase.CELL_SIZE>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapY",{get:function(){return this.y/MapBase.CELL_SIZE>>0},enumerable:!0,configurable:!0}),e.prototype.$setX=function(e){return this._shadow.x=e,this._guanghuan&&(this._guanghuan.x=e),t.prototype.$setX.call(this,Math.round(e))},e.prototype.$setY=function(e){return this._shadow.y=e,this._guanghuan&&(this._guanghuan.y=e),this.zIndex=e+.1*this.x,t.prototype.$setY.call(this,Math.round(e))},e.prototype.continuePlay=function(){for(var t in this.effs){var e=this.effs[t];e.gotoAndPlay(e.currentFrame,-1)}this._body.continuePlay()},e.prototype.setBodyVisible=function(t){this._isShowBody=this._shadow.visible=this._effContainerUp.visible=this._effContainerDown.visible=this._bodyContainer.visible=t},e.prototype.getMovieClip=function(){var t=new MC;return t},e.prototype.alive=function(t){void 0===t&&(t=0),0==t&&(t=this.getProp(AttrType.atHpMax)),this.setProp(AttrType.atHp,t),this.setHpAndNameVisible(!0),this.setAction(EntityAction.STAND),this.readyUpdateMC()},e.prototype.updateHuDun=function(){getLocation(LocationKey.ISSHOWHUDUN,LocationValue.Boolean)&&""!=this.data.hudunFileName?(this._hudun||this.initHudun(),this._hudun.playFile(this.getHundunFileName(),-1)):this._hudun&&(this._hudun.visible=!1)},e.prototype.reset=function(){t.prototype.reset.call(this),this.syncFrameMC.length=0,this.setCanBeCaiJi(!1),this.setCaiJiing(!1),this.setClickEnable(!1),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTap,this),this._body.removeEventListener(egret.Event.RENDER,this.onBodyEnterFrame,this),DisUtil.remove(this),Timer.ins().removeAll(this),egret.Tween.removeTweens(this),this.filters=null,this.closeChatBubble(),this.action=EntityAction.STAND,this._hpBar.value=this._hpBar.maximum=1e8,this._nameGroup.visible=!1,this.setBodyVisible(!0),this.AI.destruct(),this.AI=new AIBase,this.AI.setEntity(this),this.removeBuffs(),this.visible=!0,this._entityType=-1,this._weapon&&(this._weapon.visible=!1,this._weapon.reset()),this._wing&&(this._wing.visible=!1,this._wing.reset()),this._mount&&(this._mount.visible=!1,this._mount2.visible=!1,this._mount.reset(),this._mount2.reset()),this._juhun&&(this._juhun.visible=!1,this._juhun.reset()),this._foot&&(this._foot.visible=!1,this._foot.reset()),this._guanghuan&&(egret.Tween.removeTweens(this._guanghuan),this._guanghuan.visible=!1,this._guanghuan.reset()),this._shengLing&&(this._shengLing.visible=!1,this._shengLing.reset()),this._hudun&&(DisUtil.remove(this._hudun),this._hudun.visible=!1,this._hudun.reset()),this.juhunType=0,this.bianshenId=0,this._body.reset(),this.mcTouXian.reset(),this._isAtking=!1,this.data=null,this._isShowHunduBar=!1,this.btmList.length=0,this.yinJiComponent&&this.yinJiComponent.reset()},e.prototype.removeDisplay=function(){this._guanghuan&&DisUtil.remove(this._guanghuan),DisUtil.remove(this._shadow)},e.prototype.addDisplay=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._guanghuan&&MapContainer.ins().addEffectToDown2(this._guanghuan),MapContainer.ins().addEffectToDown2(this._shadow),this.readyUpdateMC()},e.prototype.updateMount=function(){},e.prototype.updateGuanghuan=function(){},e.prototype.setCanBeCaiJi=function(t){this._isBeCaiJi=t},e.prototype.setCaiJiing=function(t){this._isCaiJiing=t},e.prototype.isBeCaiJi=function(){return this._isBeCaiJi},e.prototype.isCaiJiing=function(){return this._isCaiJiing},e.prototype.setData=function(t){this.data=t,this.setTeam(t.teamId)},e}(EntityBase);__reflect(Entity.prototype,"Entity"),window.Entity=Entity;var EntityAttrData=function(){function t(){this.attributeData=[],this.attributeDataAdd=[]}return t.prototype.parserAtt=function(t){for(var e=t.readShort(),i=0;e>i;i++)this.writeAttrValue(this.attributeData,i,t.readDouble())},t.prototype.parserAttAdd=function(t){for(var e=t.readShort(),i=0;e>i;i++)this.writeAttrValue(this.attributeDataAdd,i,t.readDouble())},t.prototype.writeAttrValue=function(t,e,i){e==AttrType.atMvSpeed?t[e]=i/1e3*64:t[e]=i},t.prototype.getAtt=function(t){return this.attributeData[t]||0},t.prototype.setAtt=function(t,e){this.attributeData[t]=e},t.prototype.getAttTotles=function(){for(var t=[],e=0;e<AttrType.atCount;e++)t[e]=this.getAtt(e);return t},t.prototype.isAlive=function(){return this.getAtt(AttrType.atHp)>0},t}();__reflect(EntityAttrData.prototype,"EntityAttrData"),window.EntityAttrData=EntityAttrData;var EntityMonster=function(t){function e(){var e=t.call(this)||this;return e.dropItems=[],e}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Cfg.getMonstersConfigNew(e.configID);this.setProp(AttrType.atMvSpeed,64*i.MvSpeed/1e3),this.setProp(AttrType.atAtkSpeed,i.AtkSpeed),this.setProp(AttrType.atHpMax,i.HpMax),this.setProp(AttrType.atHp,i.HpMax),this.setProp(AttrType.atAtkMin,i.AtkMin),this.setProp(AttrType.atAtkMax,i.AtkMax),this.setProp(AttrType.atDef,i.Def),this.setProp(AttrType.atAtkSuc,i.AtkSuc),this.setProp(AttrType.atDefSuc,i.DefSuc);var n=e.avatarIndex?e.avatarIndex:0,a=Cfg.getConfig(MonsterModelConfig,i.avatar[n]);this.myHeight=a.height*a.scale,this.setDir(a.dir),this.setEntityScale(a.scale),""!=a.appearance&&e.setBodyFileName(a.appearance),this.setName(i.name,11184810),this.setHpAndNameVisible(!1),this.readyUpdateMC()},e.prototype.playAction=function(e,i){void 0===i&&(i=!1),t.prototype.playAction.call(this,e,i),e==EntityAction.DIE&&this.removeBuffs()},e.prototype.setDropItem=function(t){this.dropItems.length=0,this.dropItems=this.dropItems.concat(t)},e.prototype.getDropItems=function(){return this.dropItems},e.prototype.reset=function(){this._hpBar.visible=!1,this.dropItems.length=0,this._bodyContainer.filters=null,t.prototype.reset.call(this)},e.prototype.getCfgId=function(){return this.data.configID},e.prototype.isBoss=function(){var t=Cfg.getMonstersConfigNew(this.data.configID);return t.type==MonsterType.Boss||t.type==MonsterType.Boss2},e.prototype.addSlightFilter=function(){Timer.ins()["do"](0,200,1,this.onFilterChange,this),this._bodyContainer.filters&&0!=this._bodyContainer.filters.length||(this._bodyContainer.filters=DisUtil.whiteFilter())},e.prototype.onFilterChange=function(){this._bodyContainer.filters=null},e.prototype.canBeAtk=function(){return t.prototype.canBeAtk.call(this)&&!EntityType.isCaiJi(this.entityType)},e}(Entity);__reflect(EntityMonster.prototype,"EntityMonster"),window.EntityMonster=EntityMonster;var BuyWinBase=function(t){function e(){var e=t.call(this)||this;return e._num=1,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="BuySkin"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg()},e.prototype.open=function(e){e instanceof BuyData&&(this.buyData=e,this._num=e.count),t.prototype.open.call(this),this.addClickE(this.add1Btn,this.onTap),this.addClickE(this.sub1Btn,this.onTap),this.addClickE(this.buyBtn,this.buy),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.add1Btn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.sub1Btn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_END,this,this.onAddend),this.updateView()},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().remove(this.AddNum,this)},e.prototype.updateView=function(){this.iniNum(),this.lbDesc.visible=!1,this.lbDesc.text=Lang.shop_str1+this.buyData.limitCount,this.updatePrice()},e.prototype.iniNum=function(){this.numLabel.text=this.num.toString()},e.prototype.updatePrice=function(){},e.prototype.onAddBegin=function(t){this.isAutoAdd=!0,Timer.ins()["do"](500,Timer.EVERY_FRAME,0,this.AddNum,this,TimerType.FIRST,t.currentTarget)},e.prototype.onAddend=function(t){this.isAutoAdd=!1,Timer.ins().remove(this.AddNum,this)},e.prototype.onTap=function(t){this.AddNum(t.currentTarget)},e.prototype.AddNum=function(t){switch(t){case this.sub1Btn:this.num-=1;break;case this.add1Btn:this.num<this.buyData.limitCount?this.num<this.buyData.maxBuyCount?this.num+=1:(showtipsFail(Lang.shop_str18.replace("$name$",Cfg.getItemCfg(this.buyData.consumeItemId).getName())),this.isAutoAdd=!1,Timer.ins().remove(this.AddNum,this)):(this.isAutoAdd=!1,Timer.ins().remove(this.AddNum,this),showtipsFail(Lang.shop_str2))}this.numLabel.text=this.num.toString(),this.updatePrice()},e.prototype.buy=function(t){var e=GFunc.creatRewardDataById(this.buyData.consumeItemId,this.buyData.getTotalPrice(this.num));GFunc.checkConsumeEnough(e)&&(this.buyData.buyFun.obj=this,this.buyData.buyFun.param=[this.num],this.buyData.buyFun.call(),closeWin(this))},Object.defineProperty(e.prototype,"num",{get:function(){return this._num},set:function(t){if(this._num=t,this._num<=0)this._num=1;else{var e=Math.min(this.buyData.limitCount,this.buyData.maxBuyCount);this._num=this._num>=e?e:this._num,this._num=this._num<=0?1:this._num}},enumerable:!0,configurable:!0}),e}(BaseWinSingle);__reflect(BuyWinBase.prototype,"BuyWinBase"),window.BuyWinBase=BuyWinBase;var AIRole=function(t){function e(){var e=t.call(this)||this;return e.nextBianshenTick=0,e.defaultEnemyType=[EntityType.MONSTER_SERVER,EntityType.ROLE_CLONE,EntityType.CLONEBIANSHEN],e.flag=!1,e.minRange=4,e.maxRange=10,e.cfCd=0,e.enemyType=[EntityType.MONSTER_SERVER,EntityType.ROLE_CLONE,EntityType.CLONEBIANSHEN],e.aiTime=260,e.params.followDis=120,e.params.followRadius=500,e}return __extends(e,t),e.prototype.setGuaji=function(e){t.prototype.setGuaji.call(this,e),this.isGuaji?(this.stopAndStand(),this.enemyType=this.defaultEnemyType,this.entity==LogicSys.ins().centerEntity&&LogicSys.ins().setOnClickMovie(!1,new XY),this.startAttack()):(this.enemyType=[],this.resetTargetHandle())},e.startAtk=function(t){return t},e.prototype.Atk=function(){if(!this.entity.isAtking()&&this.entity.canAtk()){if(this.isFaraway())return this.resetTargetHandle(),void this.startFollow(this.params.followHandle,this.params.followMasterHandle);e.startAtk(this.entity.handle);var t=this.getNextSkill();if(t){var i,n=this.isNeedCastTarget(t.skillConfig),a=this.params.targetHandle;if(i=this.getNextTarget(),i&&i.handle!=a)if(this.onTargetChange(i.handle),a){var o=LogicSys.ins().getEntityByHandle(a);o&&o.masterHandle!=i.masterHandle&&this.onTargetMasterHandleChange(i)}else this.onTargetMasterHandleChange(i);if(this.canPickItem()&&this.entity.canMove()){if(this.entity.isBianShenStatus())return void this.setAIState(AIState.PickItem);if(!i)return void this.setAIState(AIState.PickItem);if(!EntityType.isRole(i.entityType)&&!EntityType.isBianshen(i.entityType))return void this.setAIState(AIState.PickItem)}var s=25e4;if(i){var r=this.getFollowTarget();r&&MathUtil.getDistanceX2ByObject(i,r)>s&&(i=r.AI.getNewTarget())}if(!i&&n)return!1;i&&(this.resetTargetHandle(i.handle),this.params.x=i.x,this.params.y=i.y);var u=void 0;if(u=n?i:this.entity,GFunc.checkSkillDis(this.entity,this.getSkillTargetPoint(t),t.skillConfig.castRange)){var h=Timer.ins().getEgretTimer();if(h>t.skillCDTick){var p=t.skillConfig,l=this.getCastTargetHandle(t.skillConfig),c=this.params.targetHandle,d=this.isShowEff();this.playMyEntityAction(p,u,t.actionIndex),null!=t.skillConfig.actionParam[0].actionType&&(d?this.playActionMovie(p,t.actionIndex,u,this.useSkillComplete.bind(this,this.entity.handle,l,c,t,h),null,MapContainer.ins().isShow(),this.entity.masterHandle==LogicSys.ins().centerEntity.masterHandle):this.useSkillComplete(this.entity.handle,l,c,t,h));for(var g=this.skillDatas,y=0,f=g;y<f.length;y++){var m=f[y];null==m.skillConfig.actionParam[0].actionType&&m.isAct&&this.checkAttrCondition(m)&&h>m.skillCDTick&&m&&(p=m.skillConfig,l=this.getCastTargetHandle(m.skillConfig),this.updateSkillCd(p.id),d?this.playActionMovie(p,m.actionIndex,u,this.useSkillComplete1.bind(this,this.entity.handle,l,c,m,h),null,MapContainer.ins().isShow(),this.entity.masterHandle==LogicSys.ins().centerEntity.masterHandle):this.useSkillComplete1(this.entity.handle,l,c,m,h))}return GFunc.playShenmoHanZhao(t),!0}}else if(!this.isMoveing()&&this.entity.canMove()){var v=this.getPath(i,this.entity);if(v&&v.length){var S=new XY;v.length>2?(S.x=v[v.length-4],S.y=v[v.length-3]):(S.x=this.entity.x,S.y=this.entity.y);var C=MapBase.CELL_SIZE*Math.min(.8*t.skillConfig.castRange,1),b=MathUtil.getPByDistance(S,i,-C);return this.startMove(b),!0}this.resetTargetHandle()}}}},e.prototype.updateTick=function(e){var i=LogicSys.ins();if(this.entity==i.centerEntity&&!this.entity.isBianShenStatus()&&this.cfCd<Timer.ins().getEgretTimer()&&(this.isAIState(AIState.Atk)&&this.nextActionTick<=Timer.ins().getEgretTimer()||this.isAIState(AIState.MoveToXY))){var n=this.getNextTarget();if(n&&EntityType.isMonster(n.entityType)){var a=this.getPath(n,this.entity);if(a&&2==a.length&&GFunc.checkSkillDis(this.entity,n,this.maxRange,this.minRange)){var o=MapContainer.ins().getNearestAroundXY(n,this.entity);i.sendSpecialMove(this.entity.handle,2,o),this.setChongFengCD()}}}t.prototype.updateTick.call(this,e)},e.prototype.setChongFengCD=function(t){void 0===t&&(t=1e3),this.cfCd=t+Timer.ins().getEgretTimer()},e.prototype.isShowEff=function(){return this.entity.masterHandle==Actor.ins().handle||!!getLocation(LocationKey.ISSHOWTHEREFF,LocationValue.Boolean)},e.prototype.getNewTarget=function(){var t=this.getFirstAtkMasterTarget()||this.getFirstAtkTarget()||this.getChouhenTarget()||this.getMonsterIdTarget()||this.getCurTarget()||this.getNearestTarget();return t},e.prototype.getNewTarget1=function(){for(var t,e=0,i=this.params.aiTargetList;e<i.length;e++){var n=i[e];t=n.getTarget(this)}return t},e.prototype.getFirstAtkMasterTarget=function(){var t;if(this.params.firstAtkMasterHandle){var e=LogicSys.ins().getMainRoleByMasterHandle(this.params.firstAtkMasterHandle);e&&!e.isDead()&&(t=e),t||(this.params.firstAtkMasterHandle=0)}return t},e.prototype.getFirstAtkTarget=function(){var t;if(this.params.firstAtkHandle){var e=LogicSys.ins().getEntityByHandle(this.params.firstAtkHandle);e&&!e.isDead()?t=e:this.params.firstAtkHandle=0}return t},e.prototype.getChouhenTarget=function(){var t;if(this.params.chouhenList.length){var e=LogicSys.ins().getMainRoleByMasterHandle(this.params.chouhenList[0].masterHandle);e&&!e.isDead()&&(t=e)}return t},e.prototype.getMonsterIdTarget=function(){var t;return this.params.firstMonsterId&&(t=LogicSys.ins().getNearestMonsterById(this,this.params.firstMonsterId)),t},e.prototype.getCurTarget=function(){var t;if(this.params.targetHandle){var e=LogicSys.ins().getEntityByHandle(this.params.targetHandle);e&&!e.isDead()?t=e:this.resetTargetHandle()}return t},e.prototype.getNearestTarget=function(){var t=LogicSys.ins().getNearestEnemyByAI(this);return t},e.prototype.onTargetChange=function(t){this.entity==LogicSys.ins().centerEntity&&LogicSys.ins().patchMainRoleTargetChange(t?t:-1)},e.prototype.onTargetMasterHandleChange=function(t){this.entity==LogicSys.ins().centerEntity&&LogicSys.ins().patchMainRoleTargetMasterChange(t.masterHandle)},e.prototype.isFaraway=function(){return this.params.followMasterHandle=this.entity.masterHandle,t.prototype.isFaraway.call(this)},e.prototype.Die=function(){t.prototype.Die.call(this),this.params.firstAtkHandle=this.params.firstAtkMasterHandle=0},e.prototype.getSkillTargetPoint=function(t){var e,i=t.skillConfig.castType;return i==CastType.Self||i==CastType.Friend?e=t.skillConfig.targetType==TargetType.Enemy?new XY(this.params.x,this.params.y):this.entity:i==CastType.Enemy?e=new XY(this.params.x,this.params.y):i==CastType.SelfByHp?e=this.entity:i==CastType.None&&(e=this.entity),e},e.prototype.stopMove=function(){t.prototype.stopMove.call(this),this.entity==LogicSys.ins().centerEntity&&LogicSys.ins().setOnClickMovie(!1,null)},e.prototype.sendMoveEntity=function(t){this.isSamePoint(t)?LogicSys.ins().sendStopMoveEntity(this.entity):LogicSys.ins().sendMoveEntity(this.entity,t)},e.prototype.setAutoBianshen=function(t){this.isAutoBianshen=t},e.prototype.checkBianshen=function(){return this.canBianshen()?!0:(showtipsFail("无法变身"),!1)},e.prototype.canAutoBianshen=function(){return(GFunc.isAutoBianShenFuBen(FbSys.ins().fubenConfig.group)||this.isAutoBianshen)&&this.canBianshen()},e.prototype.canBianshen=function(){if(this.entity.isBianShenStatus()||!this.entity.canBianShen()||this.entity.isCaiJiing())return!1;var t=LogicSys.ins().getEntityByHandle(this.params.targetHandle);return!t||EntityType.isCaiJi(t.entityType)?!1:!0},e.prototype.destruct=function(){t.prototype.destruct.call(this),this.flag=!1},__decorate([post()],e,"startAtk",null),e}(AIBase);__reflect(AIRole.prototype,"AIRole"),window.AIRole=AIRole;var AITargetBase=function(){function t(){this.type=0}return t.prototype.getTarget=function(t){var e;return e},t.prototype.setParam=function(t){},t.prototype.addParam=function(t){},t.prototype.delParam=function(t){},t.prototype.reset=function(){},t}();__reflect(AITargetBase.prototype,"AITargetBase"),window.AITargetBase=AITargetBase;var RoleItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RoleEquipItemEUI",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.redPoint.visible=!1,this.imgPlus.visible=!1,this.mcFujia=new MC,this.mcFujia.x=47,this.mcFujia.y=44,this.groupMc.addChild(this.mcFujia),this.mc=new MC,this.groupMc.addChild(this.mc),this.createClickSprite()},e.prototype.createClickSprite=function(){this.clickSpr1=new egret.Sprite,this.clickSpr1.graphics.beginFill(16777215,.001),this.clickSpr1.graphics.drawRect(0,0,80,80),this.clickSpr1.graphics.endFill(),this.clickSpr1.width=85,this.clickSpr1.height=85,this.clickSpr1.x=5,this.clickSpr1.y=5,this.addChild(this.clickSpr1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.updatePlus(),e.hasEquipOn()&&e.cfg.quality>=QualityType.Green?this.showMc(e.cfg.quality):(this.mc.visible=!1,this.mc.stop()),e.hasEquipOn()&&e.zyFuJia>0?this.showFujiaMc(!0):this.showFujiaMc(!1)},e.prototype.updateRedPoint=function(){var t=this.data;if(t){var e=RpSys.ins().getData(RoleWin,RolePanel,"equip",t.equipPos);this.imgPlus.visible=this.redPoint.visible=e,t.hasEquipOn()&&(this.imgPlus.visible=!1)}},e.prototype.updatePlus=function(){var t=this.data;t.hasEquipOn()?(this.bitRank.text=t.cfg.rank+"r",this.showIcon(t.cfg.getIcon()),this.imgPlus.visible=!1,this.bitRank.visible=!0,this.imgEquipBg.source=this.getEquipQualityBg(),this.setStar(t.cfg.star)):(this.setStar(0),this.imgIcon.source="",this.imgEquipBg.source=this.getEquipDefaulBg(),this.bitRank.visible=!1),this.bitlv.text=t.strengthen>0?"+"+t.strengthen:""},e.prototype.hidePlus=function(){this.imgPlus.visible=!1},e.prototype.showIcon=function(t){this.imgIcon.source=ResMgr.getItemIcon(t,IconType.IT_80x80)},e.prototype.showMc=function(t){this.mc.playFile(ResMgr.getEquipEffResource(t),-1)},e.prototype.showFujiaMc=function(t){t?(this.mcFujia.playFile(ResMgr.getEffName("fujia1"),-1),this.mcFujia.play()):(this.mcFujia.visible=!1,this.mcFujia.stop())},e.prototype.onClick=function(t){},e.prototype.getItemData=function(){return this.data},e.prototype.hitTestPoint=function(t,e,i){return this.clickSpr1.hitTestPoint(t,e,i)},e.prototype.setStar=function(t){this.groupStart.removeChildren();for(var e=0;t>e;e++){var i=new eui.Image;i.source="role_zycs_star",i.touchEnabled=!1,this.groupStart.addChild(i)}this.imgStarBg.visible=t>0},e.prototype.getEquipDefaulBg=function(){var t=this.data;return ResMgr.getEquipDefaultIcon(t.equipPos)},e.prototype.getEquipQualityBg=function(){var t=this.data;return ResMgr.getEquipQualityBg(t.cfg.quality)},e}(BaseItemRender);__reflect(RoleItem.prototype,"RoleItem"),window.RoleItem=RoleItem;var DaZaoEquipPanel=function(t){function e(){var e=t.call(this)||this;return e.itemConsumes=[],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="DaZaoEquipPanelEUI"},e.prototype.init=function(){this.itemListPos.itemRenderer=DaZaoEquipPosTab,this.itemListPosArray=new eui.ArrayCollection,this.itemListPos.dataProvider=this.itemListPosArray,this.itemConsumes=[this.itemConsume0,this.itemConsume1,this.itemConsume2,this.itemConsume3,this.itemConsume4]
},e.prototype.open=function(e){t.prototype.open.call(this),this.resetPanel(),this.data=e,this.addClickE(this.itemTarget,this.onClick),this.addClickE(this.btnFangRu,this.onClick),this.addClickE(this.btnDaZao,this.onClick),this.addClickE(this.itemConsume0,this.onClick),this.addClickE(this.itemConsume1,this.onClick),this.addClickE(this.itemConsume2,this.onClick),this.addClickE(this.itemConsume3,this.onClick),this.addClickE(this.itemConsume4,this.onClick),this.addItemTapE(this.itemListPos,this.onPosListClick),this.addLsn(EquipSys.ins().patchDaZaoEquip,this.updateDaZaoSucceed),this.addLsn(EquipSys.ins().patchDaZaoEquipSelect,this.onSelectConsume),this.addLsn(BagSys.ins().patchEquipChange,this.updatePanel),this.addLsn(BagSys.ins().patchEquiChange,this.updateCount),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.updatePanel()},e.prototype.updatePanel=function(){this.lbConsumeDesc.textFlow=addColorTF(this.data.getConsumeDesc()),this.lbEquipDesc.textFlow=addColorTF(this.data.getEquipDaZaoDesc()),this.itemListPosArray.source=this.data.daZaoTabEqupPosData,this.itemListPos.validateNow(),this.validateNow(),this.updatePos(this.data.getTuiJianSubTabIndex()),this.updateCount(),this.updateConsumeName()},e.prototype.updateConsumeName=function(){this.lbConsumeName.textFlow=addColorTF("可放入"+addColor(this.data.stage+"阶红色"+(this.data.star-1)+"星",16773815)+"装备")},e.prototype.updateCount=function(){var t=BagSys.ins().getEquipByStarRank(this.data.star-1,this.data.stage).length;this.lbHaveCount.textFlow=addColorTF("拥有:"+addColor(t,16115290))},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(DaZaoMainPanel))&&this.updatePanel()},e.prototype.updatePos=function(t){this.selectPos(t);var e=this.data.config,i=e.equipid[0][this.curPos],n=GFunc.creatItemDataById(i);this.itemTarget.data=n,this.lbEquipName.text=n.cfg.getName(),this.lbEquipName.textColor=16773815},e.prototype.selectPos=function(t){void 0===t&&(t=0),this.itemListPos.selectedIndex=t},e.prototype.onPosListClick=function(t){var e=t.itemRenderer.data;this.updatePos(e.pos)},e.prototype.showCostTips=function(){openWin(MeNeedLevelWin,2)},e.prototype.onClick=function(t){var e=[];switch(t.currentTarget){case this.itemTarget:var i=this.itemTarget.data;i&&GFunc.openItemTips(i);break;case this.btnFangRu:this.oneFangRu(),e=this.getCurSelectEquiphandle(),e.length<this.itemConsumes.length&&(showtipsFail("材料不足"),this.showCostTips());break;case this.btnDaZao:this.sendDaZao();break;case this.itemConsume0:case this.itemConsume1:case this.itemConsume2:case this.itemConsume3:case this.itemConsume4:var n=this.getEquipList();n.length>0?openWin(DaZaoEquipSelectWin,this.itemConsumes.indexOf(t.currentTarget),this.data.star-1,this.data.stage,n):(showtipsFail("材料不足"),this.showCostTips())}},e.prototype.sendDaZao=function(){for(var t=[],e=[],i=0;i<this.itemConsumes.length;i++){var n=this.itemConsumes[i].data;n&&(n.power>BagSys.ins().getEquipByIndex(n.cfg.subType).power&&e.push(n),t.push(n.handle))}if(t.length==this.itemConsumes.length){var a=this.itemTarget.data;e.length>0?openWin(DaZaoTipsWin,e,function(){EquipSys.ins().sendDaZaoEquip(a.id,t)}):EquipSys.ins().sendDaZaoEquip(a.id,t)}else showtipsFail("当前放入的材料不足"+this.itemConsumes.length+"件"),this.showCostTips()},e.prototype.resetPanel=function(){for(var t=0;t<this.itemConsumes.length;t++)this.itemConsumes[t].data=null},e.prototype.getCurSelectEquiphandle=function(){for(var t=[],e=0;e<this.itemConsumes.length;e++){var i=this.itemConsumes[e].data;i&&t.push(i.handle)}return t},e.prototype.oneFangRu=function(){for(var t=this.getEquipList(),e=0;e<t.length;e++){var i=t[e];if(i)for(var n=0;n<this.itemConsumes.length;n++)if(null==this.itemConsumes[n].data){this.itemConsumes[n].data=i;break}}},e.prototype.getEquipList=function(){for(var t=BagSys.ins().getEquipByStarRank(this.data.star-1,this.data.stage).concat(),e=this.getCurSelectEquiphandle(),i=t.length-1;i>=0;i--){var n=t[i];e.indexOf(n.handle)>-1&&t.splice(i,1)}return t},e.prototype.onSelectConsume=function(t,e){for(var i,n=0;n<this.itemConsumes.length;n++)if(i=this.itemConsumes[n].data,i&&i.handle==e.handle)return void showtipsFail("已经存在列表");this.itemConsumes[t].data=e},e.prototype.updateDaZaoSucceed=function(){this.resetPanel(),this.updateCount()},Object.defineProperty(e.prototype,"curPos",{get:function(){var t=this.itemListPos.selectedItem;return t.pos},enumerable:!0,configurable:!0}),__decorate([callDelay()],e.prototype,"updatePos",null),e}(BasePanel);__reflect(DaZaoEquipPanel.prototype,"DaZaoEquipPanel"),window.DaZaoEquipPanel=DaZaoEquipPanel;var DaZaoTabGodRingStageData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=EquipPos.RING1,e}return __extends(e,t),Object.defineProperty(e.prototype,"star",{get:function(){var t=BagSys.ins().getEquipByIndex(this.pos),e=t.hasEquipOn()?Cfg.getItemCfg(t.id).star:0;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage",{get:function(){var t=BagSys.ins().getEquipByIndex(this.pos),e=t.hasEquipOn()?Cfg.getItemCfg(t.id).rank:0;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){var t,e=BagSys.ins().getEquipByIndex(this.pos);return t=e.hasEquipOn()?Cfg.getConfig(DazaoRingStageConfig,e.id):Cfg.getConfig(DazaoRingStageConfig,this.getMinRingId())},enumerable:!0,configurable:!0}),e.prototype.getPanelName=function(){return egret.getQualifiedClassName(DaZaoRankPanel)},Object.defineProperty(e.prototype,"tabName",{get:function(){return"仙戒升阶"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"consumeDesc",{get:function(){return"升阶消耗"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLevelDesc",{get:function(){return"当前装备已达最高阶,无法再提升"},enumerable:!0,configurable:!0}),e.prototype.getNoEquipRankTips=function(){return"穿戴戒指后才能升阶"},e.prototype.getEquipDaZaoDesc=function(){if(this.isMax())return"当前装备已达最高阶,无法在提升";var t=BagSys.ins().getEquipByIndex(this.pos),e=Cfg.getItemCfg(t.hasEquipOn()?t.id:this.getMinRingId());return"必定获得"+addColor(e.rank+1+"阶"+e.star+"星"+GFunc.getEquipNameByType(e.subType),16711680)+"一件"},e.prototype.getConsumeDesc=function(){return Cfg.getConfig(DazaoCommonConfig).ringConsumeDesc},e.prototype.getMinRingId=function(){return Cfg.getConfig(DazaoCommonConfig).minRankGodRing[this.job]},Object.defineProperty(e.prototype,"job",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.isMax=function(){return this.stage>=Cfg.getConfig(DazaoCommonConfig).ringMaxRank},e.prototype.sendUp=function(){EquipSys.ins().sendDaZaoRingUpRank(this.pos)},e.prototype.getRedPoint=function(){var t=BagSys.ins().getEquipByIndex(this.pos),e=!this.isMax()&&t.hasEquipOn()&&GFunc.isConsumeEnough(this.config.needitem);return e},e}(DaZaoTabSubDataBase);__reflect(DaZaoTabGodRingStageData.prototype,"DaZaoTabGodRingStageData");var EntityData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tx=-1,e.ty=-1,e.buffs=[],e.skillDatas=[],e.avatarIndex=0,e._weaponFileName="",e._bodyFileName="",e._wingFileName="",e._mountFileName="",e._guanghuanFileName="",e._footFileName="",e._shengLingFileName="",e._hudunFileName="",e}return __extends(e,t),e.prototype.parserBase=function(t){this.type=t.readShort(),this.handle=t.readDouble(),this.configID=t.readInt(),this.masterHandle=t.readDouble(),this.appearType=t.readByte(),this.x=t.readInt(),this.y=t.readInt(),this.tx=t.readInt()||-1,this.ty=t.readInt()||-1},e.prototype.parser=function(t){this.parserBase(t),this.parserAtt(t),this.parserBuff(t)},e.prototype.parserBuff=function(t){for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt();this.buffs.push(n)}},e.prototype.parserSkill=function(t){this.skillDatas.length=0;for(var e=t.readByte(),i=0;e>i;i++){var n=new SkillData;n.skillId=t.readInt(),n.level=1,this.skillDatas.push(n)}},e.prototype.hasTargetPlace=function(){return-1!=this.tx&&-1!=this.ty&&this.x!=this.tx&&this.y!=this.ty},e.prototype.writeBaseDataToEntity=function(t){t.handle=this.handle,t.masterHandle=this.masterHandle,t.x=this.x,t.y=this.y},e.prototype.setWeaponFileName=function(t){this._weaponFileName=t},Object.defineProperty(e.prototype,"weaponFileName",{get:function(){return this._weaponFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shengLingFileName",{get:function(){return this._shengLingFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hudunFileName",{get:function(){return this._hudunFileName},enumerable:!0,configurable:!0}),e.prototype.setBodyFileName=function(t){this._bodyFileName=t},Object.defineProperty(e.prototype,"bodyFileName",{get:function(){return this._bodyFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biansheBodyFileName",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.setWingFileName=function(t){this._wingFileName=t},Object.defineProperty(e.prototype,"wingFileName",{get:function(){return this._wingFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mountFileName",{get:function(){return this._mountFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guanghuanFileName",{get:function(){return this._guanghuanFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footFileName",{get:function(){return this._footFileName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footPrintName",{get:function(){return""},enumerable:!0,configurable:!0}),e}(EntityAttrData);__reflect(EntityData.prototype,"EntityData"),window.EntityData=EntityData;var RuleIconBase=function(){function t(t){this.type=RuleIconType.normal,this.isClick=!1,this._isShow=!1,this.redPoint=!1,this.index=0,this.sysId=0,this.effX=2,this.effY=2,t.RuleData=this,this.tar=t,this.index=t.parent.getChildIndex(t),this.tar.name=this.index.toString(),this.tarParent=t.parent,this.tar.addEventListener(eui.UIEvent.MOVE,this.updateMcPoint,this),this.tar.parent.addEventListener(eui.UIEvent.RESIZE,this.updateMcPoint,this),this.tar.parent.addEventListener(eui.UIEvent.MOVE,this.updateMcPoint,this)}return Object.defineProperty(t.prototype,"isShow",{get:function(){return this._isShow},set:function(t){this._isShow!=t&&(this._isShow=t,this.update())},enumerable:!0,configurable:!0}),t.prototype.setIsShow=function(t){},t.prototype.tapExecute=function(){this.isClick=!0,this.update()},t.prototype.update=function(){this.isShow?this.updateAddChiBtn():DisUtil.remove(this.tar),this.updateEff()},t.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(this.sysId)},t.prototype.updateAddChiBtn=function(){for(var t=this.tarParent.numChildren,e=!0,i=t-1;i>=0;i--){var n=this.tarParent.getChildAt(i);if(this.index>Number(n.name)){this.tarParent.addChildAt(this.tar,i+1),e=!1;break}}e&&this.tarParent.addChildAt(this.tar,0)},t.prototype.setRedPoint=function(t){this.tar.redPoint&&(this.tar.redPoint.visible=t),this.updateEff()},t.prototype.updateEff=function(){if(this.isShowEff()&&""!=this.getEffName()){this.mc||(this.mc=new MC,this.mc.touchEnabled=!1),this.mc.name!=this.getEffName()&&this.mc.playFile(getEffName(this.getEffName()),-1);var t=getWin(MainWin);t&&(t.com_ext.groupMcAddChild(this.mc),this.updateMcPoint())}else this.mc&&(this.mc.parent&&(this.mc.stop(),DisUtil.remove(this.mc)),this.mc.visible=!1)},t.prototype.setVisible=function(t){this.tar.visible=t,this.updateEff()},t.prototype.getEffName=function(){return""},t.prototype.isShowEff=function(){var t=getWin(MainWin),e=t?t.com_ext.getParentVisible(this.tar):!1;return!this.isClick&&this.isShow&&e&&this.tar.visible},t.prototype.updateMcPoint=function(){this.setMcPos()},t.prototype.setMcPos=function(){if(this.mc){var t=this.tar.localToGlobal(),e=getWin(MainWin).com_ext.getGroupMc().globalToLocal(t.x,t.y);this.mc.x=e.x+this.tar.width/2+this.effX,this.mc.y=e.y+this.tar.height/2+this.effY,this.mc.scaleX=this.getEffScaleX(),this.mc.scaleY=this.getEffScaleY(),this.mc.aaa=egret.getQualifiedClassName(this)}},t.prototype.getEffScaleX=function(){return 1},t.prototype.getEffScaleY=function(){return 1},t.prototype.setTime=function(t){var e=this.tar;if(e.labelDisplay){var i=e.labelDisplay;i.textFlow=addColorTF(t)}},t.prototype.getOpenTick=function(){return Number.MAX_VALUE},t.prototype.getOpenSysTick=function(){return Number.MAX_VALUE},t.prototype.updateTime=function(){},t.prototype.updateRedPoint=function(t){void 0===t&&(t=null),this.updateEff()},__decorate([callDelay()],t.prototype,"setMcPos",null),t}();__reflect(RuleIconBase.prototype,"RuleIconBase"),window.RuleIconBase=RuleIconBase;var RankData=function(){function t(){this.userId=0,this.rank=0,this.playerName=Lang.act_str11,this.vipLv=0,this.svipLv=0}return t.prototype.parser=function(t){this.rank=t.readShort(),this.userId=t.readInt(),this.playerName=t.readString(),this.vipLv=t.readByte(),this.svipLv=t.readByte()},t.prototype.getRankName=function(){return this.playerName},t.prototype.getRankStr=function(){return""},t}();__reflect(RankData.prototype,"RankData"),window.RankData=RankData;var ShopBaseData=function(){function t(){this.configIndex=1,this.buyCount=0}return t.prototype.getConsumeItem=function(){return null},t.prototype.getItemSell=function(){return null},t.prototype.getItemId=function(){return 0},t.prototype.getPrice=function(){return 0},t.prototype.getLeftBuyCount=function(){return 9999},t.prototype.getBuyData=function(){var t=this,e=new BuyData;return e.setBuyFun(function(e){t.sendBuy(t.configIndex,e)}),e.itemId=this.getItemId(),e.price=this.getPrice(),e.consumeItemId=this.getConsumeItem().id,e.limitCount=this.getLeftBuyCount(),e},t.prototype.sendBuy=function(t,e){},t.prototype.isFastBuy=function(){return!1},t}();__reflect(ShopBaseData.prototype,"ShopBaseData"),window.ShopBaseData=ShopBaseData;var MallItemPanelItemBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){},e.prototype.playSelectMC=function(){this.btnBuyMc=this.btnBuyMc||new MC,this.btnBuyMc.x=this.btnBuy.width/2,this.btnBuyMc.y=this.btnBuy.height/2,this.btnBuyMc.scaleX=this.btnBuyMc.scaleY=.7,this.btnBuy.addChild(this.btnBuyMc),this.btnBuyMc.playFile(ResMgr.getEffName("public_zycs_button01"),-1)},e}(BaseItemRender);__reflect(MallItemPanelItemBase.prototype,"MallItemPanelItemBase"),window.MallItemPanelItemBase=MallItemPanelItemBase;var TaskNavDataBase=function(){function t(t){this.succeedFun=new Caller,this.succeedFrontFun=new Caller,this.loserFun=new Caller,this.controlTarget=t}return t.prototype.setLoserFun=function(t,e){void 0===e&&(e=null),this.loserFun.func=t,this.loserFun.obj=e},t.prototype.setsucceedFrontFun=function(t,e){void 0===e&&(e=null),this.succeedFrontFun.func=t,this.succeedFrontFun.obj=e},t.prototype["goto"]=function(t){void 0===t&&(t=null),this.param=t},Object.defineProperty(t.prototype,"type",{get:function(){return this.controlTarget[0]},enumerable:!0,configurable:!0}),t.prototype.getParam=function(t,e){return t[e]},t}();__reflect(TaskNavDataBase.prototype,"TaskNavDataBase"),window.TaskNavDataBase=TaskNavDataBase;var XunBaoBaseData=function(){function t(){this.tabName="装备寻宝",this.type=0,this._showItemDatas=[],this.xunBaoJiLuOtherDatas=[],this.xunBaoJiLuMyDatas=[],this._xunBaoDuiHuanDatas=[],this.biDe=0,this.score=0,this.mianFei=1}return t.prototype.parser=function(t){var e=t.readByte(),i=t.readByte(),n=t.readShort(),a=t.readInt(),o=t.readInt();this.setScore(a),this.setRemind(o),this.setXingYun(n),this.setBiDe(e),this.setMianFei(i)},Object.defineProperty(t.prototype,"isMianFei",{get:function(){return 0==this.mianFei},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBiDe",{get:function(){return 0==this.biDe},enumerable:!0,configurable:!0}),t.prototype.setMianFei=function(t){this.mianFei=t},t.prototype.setBiDe=function(t){this.biDe=t},t.prototype.setXingYun=function(t){this.xingyun=t},t.prototype.setScore=function(t){this.score=t},t.prototype.setRemind=function(t){var e=this.xunBaoDuiHuanDatas.length,i=[];this.xunBaoDuiHuanDatas;i.length=e,MathUtil.writeIntToArray(t,i);for(var n=0;e>n;n++)this.xunBaoDuiHuanDatas[n].remind=i[n]},t.prototype.getConfig=function(){return null},Object.defineProperty(t.prototype,"maxXingYun",{get:function(){return Cfg.getConfig(XunbaoConstConfig).xunbaolucky[this.type-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gailvdesc",{get:function(){return Cfg.getConfig(XunbaoConstConfig).gailvdesc[this.type-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"equipid",{get:function(){return Cfg.getConfig(XunbaoConstConfig).itemid[this.type-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wanfadesc",{get:function(){return Cfg.getConfig(XunbaoConstConfig).wanfadesc[this.type-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"costitem",{get:function(){return Cfg.getConfig(XunbaoConstConfig).costcount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showItemDatas",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xunBaoDuiHuanDatas",{get:function(){if(0==this._xunBaoDuiHuanDatas.length)for(var t=Cfg.getConfigs(XunbaoExchangeConfig,this.type,CondType.ALL),e=0;e<t.length;e++){var i=t[e],n=new XunBaoDuiHuanData;n.config=i,this._xunBaoDuiHuanDatas.push(n)}return this._xunBaoDuiHuanDatas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bideItemData",{get:function(){var t;return t},enumerable:!0,configurable:!0}),t.prototype.getPanelName=function(){return null},t}();__reflect(XunBaoBaseData.prototype,"XunBaoBaseData"),window.XunBaoBaseData=XunBaoBaseData;var XunBaoBasePanel=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.listJiLuMy.itemRenderer=XunBaoJiLuItem,e.listJiLuMy.dataProvider=e.listJiLuMyArray=new eui.ArrayCollection,e.listJiLu.dataProvider=new eui.ArrayCollection([{labelDisplay:"全服记录"},{labelDisplay:"个人记录"}]),e.lbGaiLv.textFlow=addColorTF(StrUtil.addUnderLine(e.lbGaiLv.text)),e.mcMianFei=new MC,e.mcMianFei.x=e.buyXunBao1.width/2,e.mcMianFei.y=e.buyXunBao1.height/2,e.buyXunBao1.addChild(e.mcMianFei),e.comGunDongOtherJiLu=new ComGunDongBase,e.comGunDongOtherJiLu.width=e.groupJiLu.width,e.comGunDongOtherJiLu.height=e.groupJiLu.height,e.groupJiLu.addChild(e.comGunDongOtherJiLu),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName=""},e.prototype.open=function(){t.prototype.open.call(this),this.xunBaoBiDeTips.name=this.xunBaoBiDeTips.y+"",this.addItemTapE(this.listJiLu,this.onListJiLuClick),this.addClickE(this.btnHelp,this.onClick),this.addClickE(this.lbGaiLv,this.onClick),this.addClickE(this.buyXunBao1,this.onClick),this.addClickE(this.buyXunBao10,this.onClick),this.addClickE(this.buyXunBao50,this.onClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(XunBaoSys.ins().patchXunBaoOtherJiLuUpdate,this.updateOtherJiLu),this.addLsn(XunBaoSys.ins().patchXunBaoJiLu,this.updateJiLu),this.addLsn(XunBaoSys.ins().patchXunBaoChouJiang,this.updateChouJiang),this.addLsn(BagSys.ins().patchItemChange,this.updataItem),this.addLsn(TipsSys.ins().patchSaveRemind,this.updateConsume),this.updatePanel(),this.updateRp(),this.onListJiLuClick(),this.updateState(),this.listJiLu.selectedIndex=0,this.comGunDongOtherJiLu.iniData(this.data.xunBaoJiLuOtherDatas,"XunBaoJiLuItem",6,ArrowDir.dirV),this.comGunDongOtherJiLu.open()},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this),this.xunBaoBiDeTips.y=+this.xunBaoBiDeTips.name,egret.Tween.removeTweens(this.xunBaoBiDeTips),this.comGunDongOtherJiLu.close()},e.prototype.updateTime=function(){var t=XunBaoSys.ins().getDoubleTimer();if(t>0){((new Date).getTime()-Actor.ins().serverOpenTimer)/1e3;this.lbDoubleTimer.text=""+getFormatTime(t,"dd天hh小时mm分钟ss秒")}else this.lbDoubleTimer.text=""},e.prototype.updateState=function(){},e.prototype.updateRp=function(){},e.prototype.updateChouJiang=function(){this.updateBiDe(),this.updateBtn(),this.updateXingYun()},e.prototype.updatePanel=function(){this.updateConsume(),this.updateJiLu(),this.updateBiDe(),this.updateBtn(),this.updateXingYun()},e.prototype.updateXingYun=function(){},e.prototype.updataItem=function(t){this.updateConsume()},e.prototype.updateConsume=function(){this.updateSingleConsume(0,this.imgXunBao1,this.lbXunBao1),this.updateSingleConsume(1,this.imgXunBao10,this.lbXunBao10),this.updateSingleConsume(2,this.imgXunBao50,this.lbXunBao50)},e.prototype.updateSingleConsume=function(t,e,i){var n=this.data.equipid,a=BagSys.ins().getItemCount(n),o=Cfg.getItemCfg(n),s=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.data.equipid),r=s.price,u=ResMgr.getItemIcon(o.getIcon()),h=ResMgr.getItemIcon(Cfg.getItemCfg(CurType.yb).getIcon()),p=(this.data.costitem,this.data.costitem[t][1]),l=p>a&&this.isUseYb,c=(p-a)*r;i.text=l?""+c:a+"/"+p,e.source=l?h:u},e.prototype.updateBtn=function(){this.buyXunBao1.labelDisplay.text=this.data.isMianFei?"免费":"寻宝1次",this.data.isMianFei?this.mcMianFei.playFile(ResMgr.getEffName("button1"),-1):(this.mcMianFei.stop(),this.mcMianFei.visible=!1),this.buyXunBao10.labelDisplay.text="寻宝"+this.data.costitem[1][0]+"次",this.buyXunBao50.labelDisplay.text="寻宝"+this.data.costitem[2][0]+"次"},e.prototype.updateJiLu=function(){this.updateMyJiLu()},e.prototype.updateMyJiLu=function(){this.listJiLuMyArray.source=this.data.xunBaoJiLuMyDatas},e.prototype.updateOtherJiLu=function(t){this.comGunDongOtherJiLu.addData([t])},e.prototype.updateBiDe=function(){var t=this.data.bideItemData;this.xunBaoBiDeTips.data=t,this.xunBaoBiDeTips.visible=null!=t,egret.Tween.removeTweens(this.xunBaoBiDeTips),GFunc.move(this.xunBaoBiDeTips,new XY(this.xunBaoBiDeTips.x,this.xunBaoBiDeTips.y),new XY(this.xunBaoBiDeTips.x,this.xunBaoBiDeTips.y+24))},e.prototype.onListJiLuClick=function(t){void 0===t&&(t=null);var e=t?t.itemIndex:0,i=1==e;this.comGunDongOtherJiLu.visible=!i,this.scrollerJiLuMy.visible=i,XunBaoSys.ins().sendXunBaoJiLu(this.data.type,i?0:1)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnHelp:openWin(HelpWin,this.data.wanfadesc);break;case this.lbGaiLv:openWin(XunBaoGaiLvTipsWin,this.data.gailvdesc);break;case this.buyXunBao1:this.data.isMianFei?XunBaoSys.ins().sendXunBaoChouJiang(this.data.type,1):this.sendChouJiang(0);break;case this.buyXunBao10:this.sendChouJiang(1);break;case this.buyXunBao50:this.sendChouJiang(2)}},e.prototype.sendChouJiang=function(t){var e=this,i=this.data.costitem[t][1],n=new ItemDataReward;n.id=this.data.equipid,n.count=i;var a=BagSys.ins().getItemCount(this.data.equipid),o=i-a;if(GFunc.isConsumeEnough(n))XunBaoSys.ins().sendXunBaoChouJiang(this.data.type,t+1);else if(this.isUseYb){var s=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.data.equipid);GFunc.checkCurrency(CurType.yb,s.price*i)&&XunBaoSys.ins().sendXunBaoChouJiang(this.data.type,t+1,1)}else{var s=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.data.equipid);if(GFunc.checkCurrency(CurType.yb,s.price*o)){var r=new BuyData;r.setBuyFun(function(t){var i=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,e.data.equipid);ShopSys.ins().sendItemShopBuy([[i.index,t]])}),r.price=s.price,r.itemId=this.data.equipid,r.limitCount=0,r.count=o,r.consumeItemId=CurType.yb,r.saveKey=this.data.getPanelName(),openWin(BuyWin1,r)}}},Object.defineProperty(e.prototype,"isUseYb",{get:function(){return 1==TipsSys.ins().saveReminds[this.data.getPanelName()]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return XunBaoSys.ins().getXunBaoDataByType(XunbaoType.Equip)},enumerable:!0,configurable:!0}),e.getTitle=function(){return"btz_zycs_zbxb"},e.getTabTitle=function(){return"装备寻宝"},e.getSysId=function(){return SysId.XunBaoEquip},e.prototype.getMianFeiXunBaoBtn=function(){return this.buyXunBao1},e}(BasePanel);__reflect(XunBaoBasePanel.prototype,"XunBaoBasePanel"),window.XunBaoBasePanel=XunBaoBasePanel;var XunBaoEquipPanelItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.setSkinPart("item",new ItemBase),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XunBaoEquipPanelItemEUI"},e.prototype.dataChanged=function(){var t=this.data;this.item.data=t},e}(BaseItemRender);__reflect(XunBaoEquipPanelItem.prototype,"XunBaoEquipPanelItem"),window.XunBaoEquipPanelItem=XunBaoEquipPanelItem;var AIMonster=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.startDie=function(e,i){void 0===e&&(e=0),t.prototype.startDie.call(this,e),this.entity.setHpAndNameVisible(!1);var n=Cfg.getMonstersModelCfgByMonsterId(this.entity.getCfgId()),a=n.dieDistance*MapBase.CELL_SIZE;if(0!=a){var o;o=i?MathUtil.getPByDistance(i,this.entity,a):DirUtil.getGridByDir(this.entity.dir,3,this.entity),egret.Tween.removeTweens(this.entity),this.mover.reset(),this.mover=new MoverBSE(this.entity),this.mover.setCompleteFunc(this.dieEnd,this),this.mover.moveTo(Timer.ins().getEgretTimer(),o,.5*this.params.dieTime)}},e.prototype.dieEnd=function(){this.mover=new MoverLine(this.entity);var t=egret.Tween.get(this.entity);t.wait(.2*this.params.dieTime).to({alpha:0,scaleY:1},.3*this.params.dieTime)},e.prototype.startAtked=function(e){t.prototype.startAtked.call(this,e),this.entity.isDead()||this.entity.isAtking()||!this.entity.canBeAtked()||this.playAction(EntityAction.ATKED)},e}(AIBase);__reflect(AIMonster.prototype,"AIMonster"),window.AIMonster=AIMonster;var AIRedFort=function(t){function e(){var e=t.call(this)||this;return e.defaultEnemyType=[EntityType.MONSTER_SERVER],e.enemyType=e.defaultEnemyType,e}return __extends(e,t),e.prototype.startMoveToXY=function(e,i,n){var a=this;void 0===i&&(i=-1),void 0===n&&(n=null);var o;this.returnToAtkTick=Timer.ins().getTimer()+1e8,o=n?function(){a.callback(),n()}:n,t.prototype.startMoveToXY.call(this,e,i,o)},e.prototype.startAtked=function(e){t.prototype.startAtked.call(this,e),Timer.ins().getTimer()-this.returnToAtkTick>0&&this.startAttack()},e.prototype.callback=function(){this.returnToAtkTick=Timer.ins().getTimer()+2e3,this.isGuaji&&this.startAttack()},e}(AIRole);__reflect(AIRedFort.prototype,"AIRedFort"),window.AIRedFort=AIRedFort;var XunBaoFuWenPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoFuWenPanelItemEUI",e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source=ResMgr.getElementIconRes(t.cfg.getIcon()),this.lbName.text=t.cfg.getName(),this.lbName.textColor=GConst.PZColor[t.cfg.quality]},e.prototype.onClick=function(t){var e=this.data;GFunc.openItemTips(e)},e}(BaseItemRender);__reflect(XunBaoFuWenPanelItem.prototype,"XunBaoFuWenPanelItem"),window.XunBaoFuWenPanelItem=XunBaoFuWenPanelItem;var AIYongbing=function(t){function e(){var e=t.call(this)||this;return e.defaultEnemyType=[EntityType.MONSTER_SERVER,EntityType.ROLE_CLONE,,EntityType.CLONEBIANSHEN],e.flagTime=0,e.params.followRadius=256,e.params.followDis=200,e.params.pickRadio=64,e.enemyType=e.defaultEnemyType,e}return __extends(e,t),e.prototype.setGuaji=function(e){t.prototype.setGuaji.call(this,e),this.isGuaji!=e&&(this.isGuaji?(this.stopAndStand(),this.enemyType=[EntityType.MONSTER_SERVER,EntityType.ROLE_CLONE,,EntityType.CLONEBIANSHEN],this.startAttack()):(this.stopAndStand(),this.enemyType.length=0,this.resetTargetHandle()))},e.prototype.Follow=function(){if(this.isMoveing())return!0;var e=this.getFollowTarget();if(e&&MathUtil.getDistance(this.entity,e)>=384&&Timer.ins().getTimer()-this.flagTime>1e3)return this.flagTime=Timer.ins().getTimer(),LogicSys.ins().sendSpecialMove(this.entity.handle,0),this.stopAndStand(),!1;var i=t.prototype.Follow.call(this);if(i)return!0;var n=this.getFollowTarget();if(n&&!n.isDead()){var a=LogicSys.ins().getNearestEnemyByAI(n.AI);if(a&&this.hasSkill()){var o=n.AI.getCurTarget();return this.startAttack(o),!0}return!1}return!1},e.prototype.isEnemy=function(t){var e=this.getFollowTarget();return-1!=this.enemyType.indexOf(t.entityType)&&e&&e.AI.isEnemy(t)},e.prototype.getNextTarget=function(){var t,e=this.getFollowTarget();if(e&&!e.isDead()){var i=e.AI.getCurTarget();i&&this.hasSkill()&&(t=e.AI.getCurTarget())}return t},e}(AIRole);__reflect(AIYongbing.prototype,"AIYongbing"),window.AIYongbing=AIYongbing;var DaZaoFootEquipPanel1=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),this.addLsn(FootSys.ins().patchFootMiYuDaZao,this.updateDaZaoSucceed),this.addLsn(FootSys.ins().patchEquiChange,this.updateCount)},e.prototype.updateConsumeName=function(){this.lbConsumeName.textFlow=addColorTF("可放入"+addColor(this.data.star-1+"星",16711680)+"铭文")},e.prototype.updateCount=function(){var t=FootSys.ins().getEquipByStar(this.data.star-1).concat().length;this.lbHaveCount.textFlow=addColorTF("拥有:"+addColor(t,16115290))},e.prototype.getEquipList=function(){for(var t=FootSys.ins().getEquipByStar(this.data.star-1).concat(),e=this.getCurSelectEquiphandle(),i=t.length-1;i>=0;i--){var n=t[i];e.indexOf(n.handle)>-1&&t.splice(i,1)}return t},e.prototype.sendDaZao=function(){for(var t=[],e=0,i=this.itemConsumes;e<i.length;e++){var n=i[e];n.data&&t.push(n.data.id)}if(t.length==this.itemConsumes.length){var a=this.itemTarget.data;FootSys.ins().sendFootMiYuDaZao(a.id,t)}else showtipsFail("当前放入的材料不足"+this.itemConsumes.length+"件"),this.showCostTips()},e.prototype.showCostTips=function(){openWin(MeNeedLevelWin,3)},e}(DaZaoEquipPanel);__reflect(DaZaoFootEquipPanel1.prototype,"DaZaoFootEquipPanel1"),window.DaZaoFootEquipPanel1=DaZaoFootEquipPanel1;var AITargetHandle=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handle=0,e}return __extends(e,t),e.prototype.getTarget=function(){var t;if(this.handle){var e=LogicSys.ins().getEntityByHandle(this.handle);e&&!e.isDead()?t=e:this.reset()}return t},e.prototype.setParam=function(t){this.handle=t},e.prototype.addParam=function(t){this.handle=t},e.prototype.delParam=function(t){this.handle=t},e.prototype.reset=function(){this.handle=0},e}(AITargetBase);__reflect(AITargetHandle.prototype,"AITargetHandle"),window.AITargetHandle=AITargetHandle;var DaZaoTabEqupPosData=function(){function t(){this.pos=0,this.equipId=0,this.tabName=""}return t.prototype.isTuiJian=function(){var t=GFunc.creatItemDataById(this.equipId).power>BagSys.ins().getEquipByIndex(this.pos).power;return t},t}();__reflect(DaZaoTabEqupPosData.prototype,"DaZaoTabEqupPosData");var DaZaoTabFootEqupData1=function(t){function e(){var e=t.call(this)||this;return e.daZaoTabEqupPosData=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"star",{get:function(){return this.config.star},enumerable:!0,configurable:!0}),e.prototype.iniData=function(){for(var t=0;5>t;t++)this.daZaoTabEqupPosData[t]=new DaZaoTabFootEqupPosData,this.daZaoTabEqupPosData[t].pos=t,this.daZaoTabEqupPosData[t].tabName=GFunc.getZuJiNameByType(t),this.daZaoTabEqupPosData[t].equipId=this.config.equipid[0][t]},e.prototype.getPanelName=function(){return"DaZaoFootEquipPanel"+this.config.viewType},Object.defineProperty(e.prototype,"tabName",{get:function(){return this.star+"星"+this.config.name[0]},enumerable:!0,configurable:!0}),e.prototype.getEquipDaZaoDesc=function(){return"必定获得"+addColor(this.star+"星",16711680)+"铭文一件(指定部位)"},e.prototype.getConsumeDesc=function(){return Cfg.getConfig(DazaoCommonConfig).footConsumeDesc},e.prototype.isTuiJian=function(){for(var t=!1,e=0;e<this.daZaoTabEqupPosData.length;e++)if(this.daZaoTabEqupPosData[e].isTuiJian()&&Actor.ins().zsId>=this.zslevel){t=!0;break}return t},e.prototype.getTuiJianSubTabIndex=function(){for(var t=0,e=0;e<this.daZaoTabEqupPosData.length;e++)if(this.daZaoTabEqupPosData[e].isTuiJian()){t=e;break}return t},Object.defineProperty(e.prototype,"zslevel",{get:function(){return this.config.needzslevel},enumerable:!0,configurable:!0}),e.prototype.getRedPoint=function(){var t=FootSys.ins().getEquipByStar(this.star-1).concat(),e=t.length>=5&&Actor.ins().zsId>=this.zslevel;
return e},e}(DaZaoTabSubDataBase);__reflect(DaZaoTabFootEqupData1.prototype,"DaZaoTabFootEqupData1"),window.DaZaoTabFootEqupData1=DaZaoTabFootEqupData1;var EntityOther=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.canBeAtk=function(){return!1},e}(EntityMonster);__reflect(EntityOther.prototype,"EntityOther"),window.EntityOther=EntityOther;var EntityRole=function(t){function e(){var e=t.call(this)||this;return e.fpNextTick=1,e.isFindWay=!1,e._nameTxt.visible=!0,e._nameTxt.textColor=16769375,e._hpBar.skinName="bloodBarSkin1",e._guildNameTxt=new eui.Label,e._guildNameTxt.fontFamily="黑体",e._guildNameTxt.width=240,e._guildNameTxt.textAlign="center",e._guildNameTxt.size=16,e._guildNameTxt.height=e._guildNameTxt.size,e._guildNameTxt.stroke=1,e._guildNameTxt.strokeColor=0,e._guildNameTxt.textColor=2342605,e._guildNameTxt.anchorOffsetX=e._guildNameTxt.width>>1,e._guildNameTxt.visible=!1,e._guildNameTxt.verticalAlign="bottom",e._guildNameTxt.touchEnabled=!1,e.addChild(e._guildNameTxt),e.titleArr.push(e._guildNameTxt),e._titleMC=e.getMovieClip(),e._titleMC.visible=!1,e.addChild(e._titleMC),e.titleArr.push(e._titleMC),e._teamIcon=new eui.Image,e._teamIcon.visible=!1,e.addChild(e._teamIcon),e._nameTxt.width=void 0,e._findWay=e.getMovieClip(),e._findWay.height=42,e._findWay.x=0,e._findWay.y=-110,e._bodyContainer.addChild(e._findWay),e.updatePos(),e}return __extends(e,t),e.prototype.initBiansheBody=function(){this._biansheBody=this.getMovieClip(),this._bodyContainer.addChild(this._biansheBody),this._disOrder[McOrder.BIANSHEBODY]=this._biansheBody},e.prototype.updateMC=function(){t.prototype.updateMC.call(this),this.syncFrameMC.push(this._biansheBody),this.updateMount()},e.prototype.updateBiansheBody=function(t,e){var i=this.data.biansheBodyFileName,n=!!i&&!this.isDead();if(n){this._biansheBody||this.initBiansheBody();var a=this.getBiansheBodyFileName(i);this._biansheBody.playFile(a,t,e,!1),this._biansheBody.setDir(this._dir)}else this._biansheBody&&(this._biansheBody.visible=!1)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),EntityType.isRole(e.type)?this.setBianShen(e.bianshenId,0,e.bianShenCDTick):EntityType.isBianshen(e.type)&&this.setBianShen(e.bianshenId,e.bianShenEndTick,Number.MAX_VALUE),e.masterHandle==Actor.ins().handle?(this.setVIPCom(),this.setShowTeamIcon(e.teamId)):LogicSys.ins().centerEntity.data.teamId==e.teamId?this.setShowTeamIcon(e.teamId):this.setShowTeamIcon2(e.teamId),(GFunc.isInCity()||GFunc.isGuildWar())&&0!=e.guildID?this.setGuildName(e.guildName+"["+GuildSys.ins().getOfficeName(e.guildOffice)+"]",e.guildID):this.setGuildName(),this.setName(e.entityName),this.setJob(e.job),this.setProps(e.getAttTotles()),this.setShowHuDunBar(e.isShowHunduBar),this.setTitle(e.title),e.isAlive()||this.setAction(EntityAction.DIE),this.updateBianshen(),this.updateHuDun(),this.readyUpdateMC()},e.prototype.setVIPCom=function(){if(!this.isBianShenStatus()&&Actor.ins().vipLv<Cfg.getVipMaxLv()){if(!this.vipChuanguanCom&&!urlParam.isShenhe){this.vipChuanguanCom=new VipComponent,this.vipChuanguanCom.open(),this.addChild(this.vipChuanguanCom);var t=this.titleArr.indexOf(this._titleMC);this.titleArr.splice(t,1,this.vipChuanguanCom),this.titleArr.push(this._titleMC),this.updatePos()}}else if(this.vipChuanguanCom){this.vipChuanguanCom.close(),DisUtil.remove(this.vipChuanguanCom);var t=this.titleArr.indexOf(this.vipChuanguanCom);this.titleArr.splice(t,1),this.vipChuanguanCom=null}},e.prototype.setShowFindWay=function(t){this.isFindWay!=t&&(this.isFindWay=t,this._findWay.playFile(getEffName("zdxl"),-1),this._findWay.alpha=t?1:0,this.updatePos())},e.prototype.setName=function(t,e){void 0===e&&(e=16769375),this.entityName=t,this.entityNameColor=e,this._nameTxt.textFlow=addColorTF(this.entityName,this.entityNameColor),this.updateNameGroupSize()},e.prototype.updateTouXian=function(){var t=this.data.touXianFileName;t?(this.groupTouXian.width=45,this.groupTouXian.height=18,this.mcTouXian.playFile(getEffName(""+t),-1),this._nameGroup.addEventListener(eui.UIEvent.RESIZE,this.updateNameGroupSize,this),this.updateNameGroupSize()):(this.groupTouXian.width=0,this.groupTouXian.height=0)},e.prototype.setTeam=function(e,i){void 0===i&&(i=!1),t.prototype.setTeam.call(this,e)},e.prototype.setShowTeamIcon=function(t){this._teamIcon.visible=t>0,this._teamIcon.visible&&(this._teamIcon.source="zhanmeng_zycs_zudui1"),this.updatePos()},e.prototype.setShowTeamIcon2=function(t){this._teamIcon.visible=t>0,this._teamIcon.visible&&(this._teamIcon.source="zhanmeng_zycs_zudui2"),this.updatePos()},e.prototype.setTitle=function(t){if(t&&!this.isBianShenStatus()){var e=Cfg.getConfig(TitleConfig,t);this._titleMC.playFile(getEffName("ch_zycs_"+e.img),-1),this._titleMC.visible=!0,this._titleMC.height=e.height/2}else this._titleMC.stop(),this._titleMC.visible=!1;this.updatePos()},e.prototype.setGuildName=function(t,e){void 0===t&&(t=""),void 0===e&&(e=0),this._guildNameTxt.text=t,this._guildNameTxt.visible=""!=t,this.guildID=e,this.updatePos()},e.prototype.setFootReset=function(){this.fpNextTick=Timer.ins().getTimer()},e.prototype.setHPBarVisible=function(e){t.prototype.setHPBarVisible.call(this,e),this.updatePos()},e.prototype.updatePos=function(){t.prototype.updatePos.call(this),this._teamIcon.x=this._hpBar.x-80,this._teamIcon.y=this._hpBar.y-2,this._biansheBody&&(this._biansheBody.y=this._hpBar.y-90)},e.prototype.updateTick=function(e){if(t.prototype.updateTick.call(this,e),this._isShowBody){var i=this.data.footPrintName;if(i&&0!=this.fpNextTick&&e>this.fpNextTick&&this.AI.isMoveing()){this.fpNextTick=e+500;var n=ObjPool.pop(MC);n.alpha=this.alpha,n.playFile(i,1,function(){n.name="",n.alpha=1,n.x=n.y=0,ObjPool.push(n)},!0),n.x=this.x,n.y=this.y,MapContainer.ins().addDropTo(n)}}},e.prototype.onTap=function(t){this._body.hitTestPoint(t.stageX,t.stageY)&&(LogicSys.ins().atkTargetByMasterHandle(this.masterHandle),t.stopImmediatePropagation(),LogicSys.ins().patchEntityClick(this))},e.prototype.clone=function(){var t=new e;return t.entityType=this.entityType,t.job=this.job,t.alpha=this.alpha,t.setHp(100,100),t.setDir(this._dir),t},e.prototype.bianShenClone=function(){var t=this.clone();return t.data=this.data,t.x=this.x,t.y=this.y,t.bianshenId=this.bianshenId,t.setFootReset(),t.setDir(this._dir),t},e.prototype.reset=function(){if(this.setHPBarVisible(!0),this._findWay.reset(),this._titleMC.reset(),this._nameGroup.removeEventListener(eui.UIEvent.RESIZE,this.updateNameGroupSize,this),this.vipChuanguanCom){this.vipChuanguanCom.close(),DisUtil.remove(this.vipChuanguanCom);var e=this.titleArr.indexOf(this.vipChuanguanCom);this.titleArr.splice(e,1),this.vipChuanguanCom=null}t.prototype.reset.call(this),this._biansheBody&&(this._biansheBody.visible=!1,this._biansheBody.reset())},e.prototype.addDisplay=function(){t.prototype.addDisplay.call(this),MessageMgr.ins().addLsn(LogicSys.ins().patchEntityModelChange,this.updateModel,this),this.updateModel()},e.prototype.removeDisplay=function(){t.prototype.removeDisplay.call(this),this.removeBianShen()},e.prototype.updateModel=function(t){(isNaN(t)||t==this.handle)&&(this.updateTouXian(),this.updateBianshen(),this.readyUpdateMC())},e.prototype.updateMount=function(){var t=this.data;if(t&&!isNaN(t.damonId)){var e=Cfg.getConfig(DamonHuanhuaBaseConfig,t.damonId);this._mountHeight=isNaN(e.high)?0:-e.high,this.myHeight=this.getEntityHeight(),this._juhun&&(this._juhun.y=this._mountHeight),this._wing&&(this._wing.y=this._mountHeight),this._weapon&&(this._weapon.y=this._mountHeight),this._body.y=this._mountHeight,this._shengLing&&(this._shengLing.y=this._mountHeight),this._hudun&&(this._hudun.y=this._mountHeight),this.updatePos()}},e.prototype.updateBianshen=function(){var t=this.data;if(t.type==EntityType.BIANSHEN){var e=this.data.faZhenFileName;if(e){var i=this._disOrder[McOrder.XIANLINGFZ]||new MC;i.playFile(ResMgr.getFootSource(e),-1),i.y=this._body.y,this._disOrder[McOrder.XIANLINGFZ]=i,this._bodyContainer.addChild(i)}this._hpBar.skinName="bloodBarSkin5",this._hpBar.anchorOffsetX=this._hpBar.width>>1}else this.removeBianShen();this.updatePos()},e.prototype.removeBianShen=function(){this._hpBar.skinName="bloodBarSkin1",this._hpBar.anchorOffsetX=this._hpBar.width>>1,DisUtil.remove(this._disOrder[McOrder.XIANLINGFZ]),delete this._disOrder[McOrder.XIANLINGFZ]},e.prototype.getBiansheBodyFileName=function(t){var e=this.action;return EntityAction.RUN==e&&EntityType.isBianshen(this.entityType)&&(e=EntityAction.STAND),ResMgr.getEntityBodyRes(this.entityType,t,this.getDir(),e)},e.prototype.getBodyFileName=function(t){var e=this.action;return EntityAction.isAtkAction(e)&&EntityType.isBianshen(this.entityType)&&(e=EntityAction.STAND),ResMgr.getEntityBodyRes(EntityType.ROLE,t,this.getDir(),e,this.hasWing,this.data.sex)},e.prototype.getWeaponFileName=function(t){var e=this.action;return EntityAction.isAtkAction(e)&&EntityType.isBianshen(this.entityType)&&(e=EntityAction.STAND),ResMgr.getEntityWeaponRes(this.entityType,t,this.getDir(),e,this.hasWing,this.weaponstrengthen)},e.prototype.getWingFileName=function(){var t=this.action;return EntityAction.isAtkAction(t)&&EntityType.isBianshen(this.entityType)&&(t=EntityAction.STAND),ResMgr.getEntityWingRes(this.entityType,this.data.wingFileName,this.getDir(),t)},__decorate([callDelay()],e.prototype,"updatePos",null),e}(Entity);__reflect(EntityRole.prototype,"EntityRole"),window.EntityRole=EntityRole;var RankDataPower=function(t){function e(){var e=t.call(this)||this;return e.power=0,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.power=e.readDouble()},e.prototype.getRankStr=function(){return this.power>=1e8?Lang.common_str113+"："+GFunc.overLength(this.power,2):Lang.common_str113+"："+GFunc.overLength(this.power)},e}(RankData);__reflect(RankDataPower.prototype,"RankDataPower"),window.RankDataPower=RankDataPower;var DaZaoTabGodRingStarData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){var t,e=BagSys.ins().getEquipByIndex(this.pos);return t=e.hasEquipOn()?Cfg.getConfig(DazaoRingStarConfig,e.id):Cfg.getConfig(DazaoRingStarConfig,this.getMinRingId())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabName",{get:function(){return"仙戒升星"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"consumeDesc",{get:function(){return"升星消耗"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLevelDesc",{get:function(){return"当前装备已达最高星,无法再提升"},enumerable:!0,configurable:!0}),e.prototype.getNoEquipRankTips=function(){return"穿戴戒指后才能升星"},e.prototype.sendUp=function(){EquipSys.ins().sendDaZaoRingUpStar(this.pos)},e.prototype.isMax=function(){return this.star>=Cfg.getConfig(DazaoCommonConfig).ringMaxStar},e.prototype.getMinRingId=function(){return Cfg.getConfig(DazaoCommonConfig).minStarGodRing[this.job]},e.prototype.getEquipDaZaoDesc=function(){if(this.isMax())return"当前装备已达最高星,无法在提升";var t=BagSys.ins().getEquipByIndex(this.pos),e=Cfg.getItemCfg(t.hasEquipOn()?t.id:this.getMinRingId());return"必定获得"+addColor(e.rank+"阶"+(e.star+1)+"星"+GFunc.getEquipNameByType(e.subType),16711680)+"一件"},e}(DaZaoTabGodRingStageData);__reflect(DaZaoTabGodRingStarData.prototype,"DaZaoTabGodRingStarData");var EntityGatherMonsterData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.belongName="",e.teamId=0,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.avatarIndex=e.readByte(),this.belongName=e.readString(),this.teamId=e.readInt()},e.prototype.writeBaseDataToEntity=function(t){t.handle=this.handle,t.masterHandle=this.handle,t.x=this.x,t.y=this.y},e}(EntityData);__reflect(EntityGatherMonsterData.prototype,"EntityGatherMonsterData"),window.EntityGatherMonsterData=EntityGatherMonsterData;var EntityRoleData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entityName="",e.lv=0,e.sqId=0,e.szId=0,e.wingId=0,e.title=0,e.guildID=0,e.guildName="",e.footStage=0,e.teamId=0,e.guildOffice=0,e.mozhenId=0,e.touxianStage=0,e.juhunType=0,e.bianshenId=0,e.bianShenCDTick=0,e.damonId=0,e.damonFazhenId=0,e.meilinId=-1,e._huDunId=-1,e.isShowHunduBar=!1,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.parserData(e)},e.prototype.parserData=function(t){this.entityName=t.readString(),this.job=t.readByte(),this.sex=t.readByte(),this.lv=t.readInt(),this.szId=t.readInt(),this.sqId=t.readInt(),this.wingId=t.readInt(),this.touxianStage=t.readInt(),this.title=t.readInt(),this.guildID=t.readInt(),this.guildName=t.readString(),this.teamId=t.readInt(),this.guildOffice=t.readInt(),this.mozhenId=t.readInt(),this.bianshenId=t.readInt();var e=t.readInt();this.bianShenCDTick=e+Timer.ins().getTimer(),this.damonId=t.readInt(),this.damonFazhenId=t.readInt(),this.meilinId=t.readInt(),this.footId=t.readInt(),this.shengLingId=t.readInt();var i=t.readInt();Cfg.hasConfig(ShenYouHuanhuaConfig,i)&&(this.huDunId=i),this.isShowHunduBar=1==t.readByte(),this.parserSkill(t)},Object.defineProperty(e.prototype,"huDunId",{get:function(){return this._huDunId},set:function(t){this._huDunId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.configID},set:function(t){this.configID=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weaponFileName",{get:function(){var t="";if(this.damonId){var e=Cfg.getConfig(ShenqiHuanhuaBaseConfig,this.sqId).weaponIds[this.job-1];t=e?Cfg.getConfig(WeaponAppearanceConfig,e).appearance:""}else t="weapon99";return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bodyFileName",{get:function(){var t="";if(this.damonId){var e=Cfg.getConfig(SzHuanhuaBaseConfig,this.szId).bodyIds[this.job-1];t=e?Cfg.getConfig(BodyAppearanceConfig,e).appearance:""}else t="body99";return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wingFileName",{get:function(){if(this.wingId){var t=Cfg.getConfig(WingHuanhuaBaseConfig,this.wingId).wingIds[this.job-1];return Cfg.getConfig(WingAppearanceConfig,t).appearance}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mountFileName",{get:function(){var t="";if(this.damonId){var e=Cfg.getConfig(DamonHuanhuaBaseConfig,this.damonId);t=e.facade}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"touXianFileName",{get:function(){var t=0==this.touxianStage?"":ResMgr.touxianEntityMCBystage(this.touxianStage);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guanghuanFileName",{get:function(){if(this.damonFazhenId){var t=Cfg.getConfig(DamonMozhenBaseConfig,this.damonFazhenId).appearanceId;return Cfg.getConfig(GuanghuanAppearanceConfig,t).appearance}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footPrintName",{get:function(){if(this.footId){var t=Cfg.getConfig(FootHuanhuaBaseConfig,this.footId);return t.facade}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shengLingFileName",{get:function(){if(this.shengLingId){var t=Cfg.getConfig(ShengLingConfig,this.shengLingId).bodyIds[this.job-1];return Cfg.getConfig(ShengLingAppearanceConfig,t).appearance}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hudunFileName",{get:function(){if(this.huDunId>=0&&this.isShowHunduBar){var t=Cfg.getConfig(ShenYouHuanhuaConfig,this.huDunId).bodyId;return Cfg.getConfig(ShenYouHuDunAppearanceConfig,t).appearance}return""},enumerable:!0,configurable:!0}),e}(EntityData);__reflect(EntityRoleData.prototype,"EntityRoleData"),window.EntityRoleData=EntityRoleData;var RankItemBase=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.initSkinName("RankItemBaseRendererEUI"),e}return __extends(e,t),e.prototype.initSkinName=function(t){this.skinName=t},e.prototype.dataChanged=function(){var t=this.data;2==t.rank||3==t.rank?this.currentState="max":this.currentState="min",this.validateNow(),t.rank<=3?(this.imgRank.source=1==t.rank?"phb_zycs_no1":"jjc_zycs_no"+t.rank,this.imgRank.visible=!0,this.labelRank.visible=!1):(this.imgRank.visible=!1,this.labelRank.visible=!0,this.labelRank.text=t.rank.toString()),this.imgBg.visible=this.imgChunk.visible=1!=t.rank,this.labelName.textColor=1==t.rank?15794098:3821938,this.labelPower.textColor=1==t.rank?16771851:16737792,this.labelName.text=""+t.getRankName(),this.labelPower.text=""+t.getRankStr(),this.labelName.size=1==t.rank?24:20,this.labelPower.size=1==t.rank?24:20,this.imgBg.source=2==t.rank?"phb_zycs_d1":"phb_zycs_d2",this.imgLine.visible=1!=t.rank,this.imgVip.visible=t.vipLv>0||t.svipLv>0,this.imgVip.source=t.svipLv>0?"phb_zycs_V":"phb_zycs_V1"},e}(BaseItemRender);__reflect(RankItemBase.prototype,"RankItemBase"),window.RankItemBase=RankItemBase;var RuleIconBaseHuchi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=RuleIconType.huchi,e.effX=-7,e.effY=-29,e}return __extends(e,t),e.prototype.updateSys=function(){},e.prototype.getOpenTick=function(){var t=0;if(GFunc.isSysOpen(this.sysId)){var e=this.getOpenSysTick();t=e>Actor.ins().serverTime&&DateUtil.isSameDate(Actor.ins().serverTime,e)?e:Number.MAX_VALUE}else t=Number.MAX_VALUE;return t},e.prototype.setIsShow=function(t){this.isShow=t},e}(RuleIconBase);__reflect(RuleIconBaseHuchi.prototype,"RuleIconBaseHuchi"),window.RuleIconBaseHuchi=RuleIconBaseHuchi;var BuyWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addClickE(this.add10Btn,this.onTap),this.addClickE(this.sub10Btn,this.onTap),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.add10Btn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.sub10Btn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_END,this,this.onAddend),this.updateView()},e.prototype.updateView=function(){t.prototype.updateView.call(this);var e=Cfg.getItemCfg(this.buyData.itemId);this.itemIcon.data=GFunc.creatUnknown(e.id,this.buyData.itemCount),this.itemName.text=e.getName(),this.itemName.textColor=GConst.PZColor[e.quality]},e.prototype.updatePrice=function(){t.prototype.updatePrice.call(this),this.unitPrice.setType(this.buyData.consumeItemId),this.unitPrice.setPrice(this.buyData.price),this.allPrice.setType(this.buyData.consumeItemId),this.allPrice.setPrice(this.buyData.getTotalPrice(this.num))},e.prototype.AddNum=function(e){switch(t.prototype.AddNum.call(this,e),e){case this.sub10Btn:this.num-=10;break;case this.add10Btn:this.num<this.buyData.limitCount?this.num<this.buyData.maxBuyCount?this.num+=10:showtipsFail(Lang.shop_str18.replace("$name$",Cfg.getItemCfg(this.buyData.consumeItemId).getName())):(this.isAutoAdd=!1,Timer.ins().remove(this.AddNum,this),showtipsFail(Lang.shop_str2))}this.numLabel.text=this.num.toString(),this.updatePrice()},e}(BuyWinBase);__reflect(BuyWin.prototype,"BuyWin"),window.BuyWin=BuyWin;var SeePlayModel=function(){function t(){this._power=0,this._titleId=0,this._meilinId=-1,this._damonId=0,this._damonMozhenId=0,this._yongbingId=0,this._yongbingMozhenId=0,this._shenmoId=0,this.equipDatas=[],this._vipState=0,this._xianluRingId=0,this._shenglingId=0,this._skillDatas=[];for(var t=0;t<EquipPos.MAX;t++)this.equipDatas[t]=new EquipsData,this.equipDatas[t].equipPos=t}return t.prototype.parser=function(t){this._job=t.readByte(),this._sex=t.readByte(),this._actorID=t.readInt(),this.serverID=t.readInt(),this._myName=t.readString(),this._level=t.readShort(),this._power=t.readDouble(),this._szId=t.readInt(),this._sqId=t.readInt(),this._wingId=t.readInt(),this._meilinId=t.readInt(),this._damonId=t.readInt(),this._shenglingId=t.readInt(),this._xianluRingId=t.readInt();for(var e=t.readByte(),i=0;e>i;i++)this.equipDatas[i].parserEquip(t);this._xianLuName=t.readString(),this._xianLuSex=t.readByte();for(var n=t.readByte(),i=0;n>i;i++){var a=new SkillPassivityData(t.readInt());a.level=t.readShort(),a.level>0?a.isOpen=1:a.isOpen=0,this._skillDatas[a.id]=a}},t.prototype.getSkills=function(){var t=[],e=Cfg.getConfigs(MateRingConfig);for(var i in e)t.push(e[i].skill);var n=this.getSkillPassivityDatasByIds(t);return n},t.prototype.getSkillPassivityDatasByIds=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var a=n[i];e.push(this.getSkillPassivityDataById(a))}return e},t.prototype.getSkillPassivityDataById=function(t){return this.skillDatas[t]||(this.skillDatas[t]=new SkillPassivityData(t))},Object.defineProperty(t.prototype,"actorID",{get:function(){return this._actorID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sex",{get:function(){return this._sex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vip",{get:function(){return this._vip},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"power",{get:function(){return this._power},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myName",{get:function(){return this._myName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"job",{get:function(){return this._job},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vipState",{get:function(){return this._vipState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titleId",{get:function(){return this._titleId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"szId",{get:function(){return this._szId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sqId",{get:function(){return this._sqId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wingId",{get:function(){return this._wingId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"meilinId",{get:function(){return this._meilinId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"damonId",{get:function(){return this._damonId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"damonMozhenId",{get:function(){return this._damonMozhenId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yongbingId",{get:function(){return this._yongbingId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yongbingMozhenId",{get:function(){return this._yongbingMozhenId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shenmoId",{get:function(){return this._shenmoId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xianluRingId",{get:function(){return this._xianluRingId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xianLuName",{get:function(){return this._xianLuName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xianLuSex",{get:function(){return this._xianLuSex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillDatas",{get:function(){return this._skillDatas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shenglingId",{get:function(){return this._shenglingId},enumerable:!0,configurable:!0}),t.prototype.getRoleModel=function(){return Actor.ins().attrData},t.prototype.getEquipByIndex=function(t){return this.equipDatas[t]},t.prototype.getEquipLen=function(){return this.equipDatas.length},t.prototype.getRemindByIndex=function(t){return 1==(this._vipState>>t&1)},t.prototype.getTitleFileName=function(){if(this.titleId>0){var t=Cfg.getConfig(TitleConfig,this.titleId);return getEffName("ch_zycs_"+t.img)}return""},t.prototype.getBodyFileName=function(){var t=Cfg.getConfig(SzHuanhuaBaseConfig,this.szId).uirole;return t[this.sex]},t.prototype.getWeaponFileName=function(){var t=Cfg.getConfig(ShenqiHuanhuaBaseConfig,this.sqId).uirole;return t},t.prototype.getWingFileName=function(){if(this.wingId>0){var t=Cfg.getConfig(WingHuanhuaBaseConfig,this.wingId).uirole;return t}return""},t.prototype.getMeilinFileName=function(){if(this.meilinId>-1){var t=Cfg.getConfig(MeilinHuanhuaBaseConfig,this.meilinId);return Cfg.getConfig(MeilinAppearanceConfig,t.appearanceId).appearance}return""},t.prototype.getDamonFileName=function(){if(this.damonId>0){var t=Cfg.getConfig(DamonHuanhuaBaseConfig,this.damonId);return t.facade}return""},t.prototype.getDamonHeight=function(){if(this.damonId>0){var t=Cfg.getConfig(DamonHuanhuaBaseConfig,this.damonId);return-t.high}return 0},t.prototype.getDamonMozhenFileName=function(){if(this.damonMozhenId>0){var t=Cfg.getConfig(DamonMozhenBaseConfig,this.damonMozhenId);return Cfg.getConfig(GuanghuanAppearanceConfig,t.appearanceId).appearance}return""},t.prototype.getYongbingFileName=function(){return""},t.prototype.getYongbingMozhenFileName=function(){return""},t.prototype.getShenmoBodyFileName=function(){return""},t.prototype.getShenmoWingFileName=function(){if(this.shenmoId>0){var t=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.shenmoId);return t.wingId?Cfg.getConfig(WingAppearanceConfig,t.wingId).appearance:""}return""},t.prototype.getShenmoFootFileName=function(){if(this.shenmoId>0){var t=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.shenmoId);return t.footId?Cfg.getConfig(FootAppearanceConfig,t.footId).appearance:""}return""},t.prototype.getShengLingFileName=function(){if(this.shenglingId>0){var t=Cfg.getConfig(ShengLingConfig,this.shenglingId);return Cfg.getConfig(ShengLingAppearanceConfig,t.bodyIds[this.job-1]).appearance}return""},t}();__reflect(SeePlayModel.prototype,"SeePlayModel");var BuyData=function(){function t(){this.itemId=0,this.itemCount=1,this.buyFun=new Caller,this._limitCount=9999,this.consumeItemId=CurType.gold,this.price=0,this.count=1,this.desc=""}return Object.defineProperty(t.prototype,"limitCount",{get:function(){return this._limitCount},set:function(t){t>0&&(this._limitCount=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxBuyCount",{get:function(){var t=GFunc.getItemCount(this.consumeItemId),e=Math.floor(t/this.price);return e},enumerable:!0,configurable:!0}),t.prototype.getTotalPrice=function(t){return t*this.price},t.prototype.setBuyFun=function(t,e){void 0===e&&(e=null),this.buyFun.func=t,this.buyFun.obj=e},t}();__reflect(BuyData.prototype,"BuyData"),window.BuyData=BuyData;var RankTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankTabItemEUI",e.redPoint.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.consuTxt.text=""+Lang.rank_Type[t],this.redPoint.visible=RankSys.ins().canPraiseByType(t)},e}(BaseItemRender);__reflect(RankTabItem.prototype,"RankTabItem"),window.RankTabItem=RankTabItem;var ShopBossData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(BossStoreConfig,this.configIndex))},enumerable:!0,configurable:!0}),e.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(this.config.needitem,this.config.needcount)},e.prototype.getItemSell=function(){return GFunc.creatRewardDataById(this.config.id,this.config.count)},e.prototype.getItemId=function(){return this.config.id},e.prototype.getPrice=function(){return this.config.needcount},e.prototype.canBuy=function(){return this.buyCount<this.config.daycount.count||0==this.config.daycount.count},e.prototype.getLeftBuyCount=function(){return 0==this.config.daycount.count?9999:this.config.daycount.count-this.buyCount},e.prototype.sendBuy=function(t,e){ShopSys.ins().sendBossBuy(t,e)},e.prototype.isFastBuy=function(){return 1==this.config.faseBuy},e}(ShopBaseData);__reflect(ShopBossData.prototype,"ShopBossData"),window.ShopBossData=ShopBossData;var MallBasePanel=function(t){function e(){var e=t.call(this)||this;return e.ITEM_HEIGHT=205,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setSkinName();var e=this.getListItemClass();e?(this.listItem.itemRenderer=this.getListItemClass(),this.listItem.dataProvider=this.listItemArr=new eui.ArrayCollection([])):console.log("MallBasePanel未设置listItem的渲染项")},e.prototype.getListItemClass=function(){},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this),this.itemId=e},e.prototype.selectItem=function(t){this.listItem.validateNow();for(var e=0,i=this.listItemArr.source,n=0;n<i.length;n++){var a=i[n];if(a.getItemId()==t){e=n;break}}var o=Math.floor(e/2)*this.ITEM_HEIGHT,s=this.scrollItem.viewport.contentHeight-this.scrollItem.height;o>=s&&(o=s),0>o&&(o=0),this.scrollItem.viewport.scrollV=o;var r=this.listItem.getElementAt(e);r&&r.playSelectMC()},e.getSysId=function(){return SysId.Shop},e.getTabTitle=function(){return"未命名"},e}(BasePanel);__reflect(MallBasePanel.prototype,"MallBasePanel"),window.MallBasePanel=MallBasePanel;var RoleItemBig=function(t){function e(){var e=t.call(this)||this;return e.skinName="RoleEquipItemRingEUI",e.init(),e}return __extends(e,t),e.prototype.getEquipDefaulBg=function(){var t=this.data;return ResMgr.getEquipDefaultIcon(t.equipPos,!0)},e.prototype.getEquipQualityBg=function(){var t=this.data;return ResMgr.getEquipQualityBg(t.cfg.quality,!0)},e.prototype.showMc=function(t){this.mc.playFile(ResMgr.getEffName("sjeff"),-1)},e}(RoleItem);__reflect(RoleItemBig.prototype,"RoleItemBig"),window.RoleItemBig=RoleItemBig;var ShopBossPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopBossPanelItemEUI",e.setSkinPart("item",new ItemShop),e.setSkinPart("priceIcon",new PriceIcon),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.btnBuy.name="btnBuy_"+this.itemIndex,this.labelName.textFlow=GFunc.getItemName1(t.config.id);var e=ShopSys.ins().getDayCountName(t.config.daycount.type);this.labelDesc.text=e+"："+t.buyCount+"/"+t.config.daycount.count,this.labelDesc.visible=0!=t.config.daycount.count;var i=t.canBuy();this.btnBuy.visible=i,this.labelMax.visible=!i,this.item.data=t.getItemSell(),this.priceIcon.setData(t.getConsumeItem())},e}(MallItemPanelItemBase);__reflect(ShopBossPanelItem.prototype,"ShopBossPanelItem"),window.ShopBossPanelItem=ShopBossPanelItem;var DamonBaseModel=function(){function t(){this.useId=0,this.moZhenId=0,this.level=0,this.levelExp=0,this.stageLevel=0,this.stageExp=0,this.actZhiZhengItemId=[]}return t.prototype.getHuanHuaDataById=function(t){return null},t.prototype.getHuanHuaDatas=function(){return[]},t.prototype.getYinJuDataById=function(t){return null},t.prototype.getYinJuDatas=function(){return[]},t.prototype.getMoZhenDataById=function(t){return null},t.prototype.getMoZhenDatas=function(){return[]},t.prototype.getMoZhenGroupNames=function(){return[]},t.prototype.getMoZhenDatasByGroupId=function(t){return[]},t.prototype.getLevelAttrDatas=function(){return[]},t.prototype.getStageAttrDatas=function(){return[]},t.prototype.getYinJiAttrDatas=function(t){return[]},t.prototype.getYinJiAttrDatasAll=function(){return[]},t.prototype.getMoZhenAttrDatas=function(t){return[]},t.prototype.getMoZhenDatasAll=function(){return[]},t.prototype.getHuanHuaAttrDatas=function(t){return[]},t.prototype.getHuanHuaAttrDatasAll=function(){return[]},t.prototype.getLevelPower=function(){return 0},t.prototype.getStagePower=function(){return 0},t.prototype.getYinJinPower=function(){return 0},t.prototype.getMoZhenPower=function(){return 0},t.prototype.getHuanHuaPower=function(){return 0},t.prototype.getLevelMaxExp=function(){return 0},t.prototype.getStage=function(){return 0},t.prototype.getStageMaxExp=function(){return 0},t.prototype.getStart=function(t){return 0},t.prototype.getStarPerLevel=function(){return 0},t.prototype.getStageitemid=function(){return 0},t.prototype.getStageitemExp=function(){return 0},t.prototype.getStageskills=function(){return[]},t.prototype.getLevelitemid=function(){return 0},t.prototype.getLevelitemExp=function(){return 0},t.prototype.getLevelskills=function(){return[]
},t.prototype.getApperaenceId=function(){return 0},t.prototype.isMaxLv=function(){return!1},t.prototype.isMaxStage=function(){return!1},t.prototype.getMaxStage=function(){return 0},t.prototype.getZhiShengItemId=function(){return 0},t.prototype.isHuanHua=function(){return this.useId>t.S},t.prototype.actHasItem=function(){for(var t=!1,e=this.getZhiShengItemId(),i=Cfg.getItemCfg(e),n=0;n<this.actZhiZhengItemId.length;n++){var a=this.actZhiZhengItemId[n];if(Cfg.getItemCfg(a).type==i.type){t=!0;break}}return t},t.prototype.getCanUseZhiShengItemIds=function(){var t=[];return t},t.prototype.getActCanUseZhiShengItemIds=function(){for(var t=this.getCanUseZhiShengItemIds(),e=[],i=0;i<t.length;i++)this.actZhiZhengItemId.indexOf(t[i])>=0&&e.push(t[i]);return e},t.S=100,t}();__reflect(DamonBaseModel.prototype,"DamonBaseModel"),window.DamonBaseModel=DamonBaseModel;var DamonHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.datas=[],e.skinName="DamonHuanHuaPanelEUI",e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listIcon.itemRenderer=HuanHuaItem,e.listIcon.dataProvider=e.listIconData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),1176860),e.imgBg.source="jl_zycs_bg1_jpg",e.groupSkill.visible=!1,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnHuanHua,this.onClick),this.addClickE(this.btnAttr,this.onClick),this.addClickE(this.helpBtn,this.onClick),this.addItemTapE(this.listIcon,this.onListIcon),this.addLsn(ShouHuNewSys.ins().patchDamonHuanHuaUp,this.updateUp),this.addLsn(ShouHuNewSys.ins().patchDamonHuanHua,this.updateHuanHua),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.item.setSelect(!1)},e.prototype.infoPanel=function(){this.dataModel=ShouHuNewSys.ins().getModelBySysId(this.getSysId()),this.updateListIcon(),this.listIcon.validateNow(),this.updateDefSelect(),this.updatePanel(),this.updateSelectIcon()},e.prototype.updateDefSelect=function(){this.item&&(this.item.setSelect(!1),this.item.dataChanged());var t=0;if(this.data&&this.datas&&this.datas.length>0&&(t=this.datas.indexOf(this.data)),t=t>-1?t:0,!this.item||!GFunc.isConsumeEnough(GFunc.getItemDataRewardByJob(this.data.getConsume()))){for(var e=0;e<this.datas.length;e++){var i=this.datas[e];if(!i.isMax()){var n=GFunc.isConsumeEnough(GFunc.getItemDataRewardByJob(i.getConsume()));if(n){t=e;break}}}this.listIcon.selectedIndex=t,this.item=this.listIcon.getChildAt(t)}this.data=this.datas[t]},e.prototype.updateUp=function(){this.updateDefSelect(),this.updatePanel(),this.updateSelectIcon()},e.prototype.updatePanel=function(){this.power.text=""+this.dataModel.getHuanHuaPower(),this.bmpLv.text=""+this.data.level,this.imgName.text=this.data.getName(),this.groupLv.visible=this.data.level>0,this.imgWjh.visible=0==this.data.level;var t=addColor(this.data.getActDec(),16751375);t+=Lang.common_str117+addColor("+"+this.data.getActPower(),16751375),this.lbActDec.textFlow=addColorTF(0==this.data.level?t:""),this.attrData.source=this.dataModel.getHuanHuaAttrDatas(this.data),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth;var e=GFunc.getItemDataRewardByJob(this.data.getConsume());this.listConsumeData.source=e,this.btnSend.redPoint.visible=GFunc.isConsumeEnough(e),this.btnSend.label=this.data.isAct()?Lang.btn_sj:Lang.btn_jh,this.item.dataChanged(),this.updataMC(),this.updateHuanHua(),this.updateMax()},e.prototype.updateMax=function(){this.data.isMax()?(this.imgYml.visible=!0,this.listConsume.visible=!1,this.btnSend.visible=!1):(this.imgYml.visible=!1,this.listConsume.visible=!0,this.btnSend.visible=!0),this.consumeBg.visible=!this.imgYml.visible},e.prototype.updataMC=function(){this.groupMc.removeChildren();for(var t=this.getModel(),e=0,i=t;e<i.length;e++){var n=i[e];this.groupMc.addChild(MC.createCenterGruop(n,-1))}},e.prototype.getModel=function(){var t=Cfg.getConfig(DamonHuanhuaBaseConfig,this.data.id).uibody;return[t]},e.prototype.updateHuanHua=function(){this.imgSyz.visible=this.data.id==this.dataModel.useId,this.btnHuanHua.visible=this.data.level>0?!this.imgSyz.visible:!1,this.updateListIcon()},e.prototype.updateListIcon=function(){this.datas=this.dataModel.getHuanHuaDatas(),this.listIconData.replaceAll(this.datas)},e.prototype.updateSelectIcon=function(){-1==this.datas.indexOf(this.data)?this.item.setSelect(!1):this.item.setSelect(!0)},e.prototype.onListIcon=function(t){this.item.setSelect(!1),this.item=t.itemRenderer,this.data=t.item,this.updatePanel(),this.updateSelectIcon()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(e)&&ShouHuNewSys.ins().sendDamonHuanHuaUp(this.data.id);break;case this.btnHuanHua:ShouHuNewSys.ins().sendDamonHuanHua(this.data.id);break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getHuanHuaAttrDatasAll());break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,53).text)}},e.getTitle=function(){return"btz_zycs_jingling"},e.getTabTitle=function(){return"bqz_zycs_jlhh"},e.getSysId=function(){return SysId.damon},e}(BasePanel);__reflect(DamonHuanHuaPanel.prototype,"DamonHuanHuaPanel"),window.DamonHuanHuaPanel=DamonHuanHuaPanel;var DamonLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=51,e.longPressBtnUp=new LongPress,e.skillDatas=[],e.isChangLv=!1,e.isChanging=!1,e.dValue=0,e.num=0,e.skinName="DamonLevelPanelEUI",e.list.itemRenderer=SkillPassivityItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.imgExp.mask=e.imgExpMask,e.imgBg.source="jl_zycs_bg2_jpg",e.expMC1=GFunc.playUIMovie("jypoor2",0,0,e.groupExpMc,-1),e.maskMC1=new MaskRect,e.maskMC1.x=-47,e.maskMC1.y=-46,e.maskMC1.setParam(94,92,MoveDir.D_To_U),e.groupExpMc.addChild(e.maskMC1),e.expMC1.mask=e.maskMC1,e.expMC2=GFunc.playUIMovie("jypoor1",0,0,e.groupExpMc,-1),e.maskMC2=new MaskCircle,e.maskMC2.setParam(46,MoveDir.D_To_U),e.maskMC2.setPercent(1),e.groupExpMc.addChild(e.maskMC2),e.expMC2.mask=e.maskMC2,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.helpBtn,this.onClick),this.addItemTapE(this.list,this.onSkillItem),this.addLsn(ShouHuNewSys.ins().patchDamonLevelUp,this.updateLevelUp),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this,500,200),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close()},e.prototype.updateRp=function(t){(!t||t.check(this))&&(this.btnSend.redPoint.visible=RpSys.ins().getData(ShouHuWin,this.getParentClassName(),this,"levelUp"))},e.prototype.infoPanel=function(){this.isChangLv=!1,this.dataModel=ShouHuNewSys.ins().getModelBySysId(this.getSysId()),this.updatePanel(),this.updateRp()},e.prototype.updatePanel=function(){this.bmpLv.text="l"+this.dataModel.level,this.attrData.source=this.dataModel.getLevelAttrDatas(),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth;var t=[GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1)];this.listConsumeData.source=t,this.isChangLv&&this.playEff("pubsjeff"),this.dataModel.isMaxLv()?(this.btnSend.visible=!1,this.listConsume.visible=!1,this.imgYml.visible=!0):(this.btnSend.visible=!0,this.listConsume.visible=!0,this.imgYml.visible=!1),this.updateEXP(this.dataModel.levelExp,this.dataModel.getLevelMaxExp()),this.updateSkill(),this.updataMC()},e.prototype.updateLevelUp=function(t){this.isChangLv=t,t?this.dValue=this.maskMC1.max-this.maskMC1.value:this.dValue=this.dataModel.levelExp-this.maskMC1.value,this.num=this.dValue/10,Timer.ins()["do"](0,20,0,this.playExpEff,this),this.isChanging=!0},e.prototype.playExpEff=function(){this.dValue>0?(this.dValue=Math.max(this.dValue-this.num>>0,0),this.isChangLv?this.updateEXP(this.maskMC1.max-this.dValue,this.maskMC1.max):this.updateEXP(this.dataModel.levelExp-this.dValue,this.maskMC1.max)):(Timer.ins().remove(this.playExpEff,this),this.updatePanel(),this.isChanging=!1)},e.prototype.updateEXP=function(t,e){t=Math.min(t,e),this.lbExp.text=t+"/"+e,this.imgExpMask.scaleY=-t/e,this.maskMC1.setValue(t,e),this.expMC2.y=46-t/e*92},e.prototype.updataMC=function(){this.groupMc.removeChildren();for(var t=this.getModel(),e=0,i=t;e<i.length;e++){var n=i[e];this.groupMc.addChild(MC.createCenterGruop(n,-1))}},e.prototype.getModel=function(){var t=Cfg.getConfig(DamonHuanhuaBaseConfig,this.dataModel.useId).uibody;return[t]},e.prototype.updateSkill=function(){this.skillDatas=SkillSys.ins().getSkillPassivityDatasByIds(this.dataModel.getLevelskills()),this.listData.source=this.skillDatas,this.lbSkillLv.textFlow=addColorTF(SkillSys.ins().getSkillPassivityUpDec(this.skillDatas)),this.updatePower()},e.prototype.updatePower=function(){for(var t=0,e=0,i=this.skillDatas;e<i.length;e++){var n=i[e];t+=n.getPower()}this.power.text=""+(this.dataModel.getLevelPower()+t)},e.prototype.playEff=function(t){GFunc.playUIMovie(t,0,-100,this.groupMc,1)},e.prototype.onSkillItem=function(t){var e=t.item;openWin(SkillPassivityUpWin,e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:!this.isChanging&&GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1))&&ShouHuNewSys.ins().sendDamonLevelUp();break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1))?ShouHuNewSys.ins().sendDamonLevelUp():this.longPressBtnUp.stop()},e.prototype.getParentClassName=function(){for(var t=ShouHuWin.getPanelNames(),e=0,i=t;e<i.length;e++){var n=i[e];if(n.getSysId()==this.getSysId())return n}return null},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_py},e.getSysId=function(){return SysId.damon},e.prototype.getBtnSend=function(){return this.btnSend},e}(BasePanel);__reflect(DamonLevelPanel.prototype,"DamonLevelPanel"),window.DamonLevelPanel=DamonLevelPanel;var DamonMoZhenPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=55,e.datas=[],e.tempUrl="",e.skinName="ShenQiHuanHuaPanelEUI",e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listBar.dataProvider=e.listBarData=new eui.ArrayCollection,e.listIcon.itemRenderer=HuanHuaItem,e.listIcon.dataProvider=e.listIconData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),1176860),e.groupMc.y=336,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnHuanHua,this.onClick),this.addClickE(this.btnAttr,this.onClick),this.addClickE(this.helpBtn,this.onClick),this.addItemTapE(this.listBar,this.onListBar),this.addItemTapE(this.listIcon,this.onListIcon),this.addLsn(ShouHuNewSys.ins().patchDamonMoZhenUp,this.updateHuanHuaUp),this.addLsn(ShouHuNewSys.ins().patchDamonMoZhenHuanHua,this.updateHuanHua),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.item.setSelect(!1),this.mc&&this.mc.reset()},e.prototype.updateRp=function(t){if(!t||t.check(this))for(var e=0;e<this.listBar.numChildren;e++){var i=this.listBar.getChildAt(e);i.redPoint.visible=RpSys.ins().getData(ShouHuWin,this.getParentClassName(),this,e+1)}},e.prototype.infoPanel=function(){this.dataModel=ShouHuNewSys.ins().getModelBySysId(this.getSysId()),this.listBarData.source=this.dataModel.getMoZhenGroupNames(),this.listBar.selectedIndex=-1,this.listBar.validateNow(),this.updateDefBarSelect(),this.updateDefSelect(),this.updatePanel(),this.updateRp()},e.prototype.updateDefBarSelect=function(){this.listBar.validateNow();var t=this.listBar.selectedIndex,e=this.getParentClassName();if(0>t||!RpSys.ins().getData(ShouHuWin,e,this,t+1)){for(var i=0;i<this.listBar.numChildren;i++)if(RpSys.ins().getData(ShouHuWin,e,this,i+1)){t=i;break}this.listBar.selectedIndex=0>t?0:t}},e.prototype.updateDefSelect=function(){var t=this.getParentClassName();this.updateListIcon();var e=0;if(this.data&&this.datas&&this.datas.length>0&&(e=this.datas.indexOf(this.data)),e=e>-1?e:0,this.item&&RpSys.ins().getData(ShouHuWin,t,this,this.listBar.selectedIndex+1,this.item.data.id))this.data&&~this.listIcon.selectedIndex&&(this.listIcon.selectedIndex=this.datas.indexOf(this.data));else{for(var i=-1,n=0;n<this.listIcon.numChildren;n++){var a=this.listIcon.getChildAt(n).data,o=RpSys.ins().getData(ShouHuWin,t,this,this.listBar.selectedIndex+1,a.id);if(o){e=n,i=-1;break}a.isUse()&&(i=n)}i>-1&&(e=i),this.listIcon.selectedIndex=e,this.item=this.listIcon.getChildAt(this.listIcon.selectedIndex),this.data=this.datas[this.listIcon.selectedIndex]}this.updateSelectIcon()},e.prototype.updateHuanHuaUp=function(){this.resetItemData(),this.updateDefBarSelect(),this.updateDefSelect(),this.updatePanel()},e.prototype.updatePanel=function(){this.power.text=""+this.dataModel.getMoZhenPower(),this.bmpLv.text=""+this.data.level,this.groupLv.visible=!!this.data.level,this.imgName=addColorTF(this.data.getName()),this.imgWjh.visible=0==this.data.level;var t=addColor(this.data.getActDec(),16751375);t+=Lang.common_str117+addColor("+"+this.data.getActPower(),16751375),this.lbActDec.textFlow=addColorTF(0==this.data.level?t:""),this.decBg.visible=0==this.data.level,this.attrData.source=this.dataModel.getMoZhenAttrDatas(this.data),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth;var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));this.listConsumeData.source=e,this.btnSend.redPoint.visible=GFunc.isConsumeEnough(e),this.btnSend.label=this.data.level?Lang.btn_sj:Lang.btn_jh,this.data.isMax()?(this.btnSend.visible=!1,this.listConsume.visible=!1,this.imgYml.visible=!0):(this.btnSend.visible=!0,this.listConsume.visible=!0,this.imgYml.visible=!1),this.item.dataChanged(),this.updateHuanHua()},e.prototype.updateHuanHua=function(){this.imgSyz.visible=this.data.id==this.dataModel.moZhenId,this.btnHuanHua.visible=this.data.level>0?!this.imgSyz.visible:!1,this.updataMC(),this.updateListIcon()},e.prototype.updataMC=function(){this.mc||(this.mc=new MC,this.groupMc.addChild(this.mc)),this.tempUrl!=this.getApperaence()&&(this.mc.playFile(this.getApperaence(),-1),this.tempUrl=this.getApperaence())},e.prototype.updateListIcon=function(){this.datas=this.dataModel.getMoZhenDatasByGroupId(this.listBar.selectedIndex+1),this.listIconData.source=this.datas,this.listIcon.validateNow()},e.prototype.updateSelectIcon=function(){-1==this.datas.indexOf(this.data)?this.item.setSelect(!1):this.item.setSelect(!0)},e.prototype.getNameRes=function(){return"jl_zycs_mz"+this.data.id},e.prototype.getApperaence=function(){var t=Cfg.getConfig(GuanghuanAppearanceConfig,this.data.getApperaenceId()).appearance;return ResMgr.getUIFootSource(t)},e.prototype.resetItemData=function(){this.item.setSelect(!1),this.item=null,this.data=null},e.prototype.onListBar=function(t){this.resetItemData(),this.updateDefSelect(),this.updatePanel()},e.prototype.onListIcon=function(t){this.item.setSelect(!1),this.item=t.itemRenderer,this.data=t.item,this.updatePanel(),this.updateSelectIcon()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:if(this.data.isMax())return void showtipsFail(Lang.common_str38);var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));GFunc.checkConsumeEnough(e)&&ShouHuNewSys.ins().sendDamonMoZhenUp(this.data.id);break;case this.btnHuanHua:ShouHuNewSys.ins().sendDamonMoZhenHuanHua(this.data.id);break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getMoZhenDatasAll(),ComAttrTitleEnum.DamonMoZhen);break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.getParentClassName=function(){var t;switch(this.getSysId()){case SysId.DamonMozhen:t=DamonPanel;break;case SysId.YongbingMozhen:t=YongbingPanel;break;case SysId.ShenmoMozhen:t=ShenmoPanel}return t},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_mz},e.getSysId=function(){return SysId.DamonMozhen},e}(BasePanel);__reflect(DamonMoZhenPanel.prototype,"DamonMoZhenPanel"),window.DamonMoZhenPanel=DamonMoZhenPanel;var DamonStagePanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=52,e.longPressBtnUp=new LongPress,e.skillDatas=[],e.curStage=0,e.skinName="DamonStagePanelEUI",e.setSkinPart("itemZhiSheng",new ItemBaseReward),e.list.itemRenderer=SkillPassivityItem2,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.imgBg.source="jl_zycs_bg2_jpg",e.groupSkill.visible=!1,e.starExp=new Star(StarData.F_5()),e.starExp.x=30,e.groupStar.addChild(e.starExp),e.btnSendMC=MC.createCenterGruop(getEffName("button1"),-1),e.btnSend.addChildAt(e.btnSendMC,e.btnSend.numChildren-1),e.btnHuanHuaMC=MC.createCenterGruop(getEffName("hheff"),-1),e.btnHuanHua.addChildAt(e.btnHuanHuaMC,e.btnHuanHua.numChildren-1),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnGengHuan,this.onClick),this.addClickE(this.btnHuanHua,this.onClick),this.addClickE(this.btnUseZhiSheng,this.onClick),this.addClickE(this.helpBtn,this.onClickCommon),this.addClickE(this.leftBtn,this.onClickCommon),this.addClickE(this.rightBtn,this.onClickCommon),this.addClickE(this.btnGet,this.onClickCommon),this.addItemTapE(this.list,this.onSkillItem),this.addLsn(ShouHuNewSys.ins().patchDamonStageUp,this.updatePanelUp),this.addLsn(ShouHuNewSys.ins().patchDamonUseZhiSheng,this.updatePanelUp),this.addLsn(ShouHuNewSys.ins().patchDamonHuanHua,this.updateHuanhua),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill),this.addLsn(BagSys.ins().patchItemChange,this.updateConsume),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeZhiSheng),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close()},e.prototype.updateRp=function(t){if(!t||t.check(this)){var e=RpSys.ins().getData(ShouHuWin,this.getParentClassName(),this,"stageUp");this.btnSend.redPoint.visible=e,this.btnSendMC.visible=e,e=RpSys.ins().getData(ShouHuWin,this.getParentClassName(),this,ShouHuHuanHuaWin),this.btnHuanHua.redPoint.visible=e,this.btnHuanHuaMC.visible=e,e=RpSys.ins().getData(ShouHuWin,this.getParentClassName(),this,"zhiSheng"),this.btnUseZhiSheng.redPoint.visible=e}},e.prototype.infoPanel=function(){this.dataModel=ShouHuNewSys.ins().getModelBySysId(this.getSysId()),this.tempStage=this.dataModel.stageLevel,this.starExp.setMaxStar(this.dataModel.getStarPerLevel()),this.starExp.reset(),this.updatePanel(),this.updateRp()},e.prototype.updatePanelUp=function(t){t&&this.longPressBtnUp.stop(),this.updatePanel(),this.updateZhiSheng()},e.prototype.updatePanel=function(){if(this.curStage=this.dataModel.getStage(),this.attrData.source=this.dataModel.getStageAttrDatas(),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth,this.barExp.slideDuration=500,this.dataModel.stageLevel>this.tempStage){this.tempStage=this.dataModel.stageLevel;var t=this.barExp.maximum;this.barExp.value=t,this.updateExp()}else this.barExp.maximum=this.dataModel.getStageMaxExp(),this.barExp.value=this.dataModel.stageExp;this.updateConsume(),this.updateSkill(),this.selectPanel(),this.updateMax(),this.updateZhiSheng()},e.prototype.updateExp=function(){this.barExp.slideDuration=0,this.barExp.maximum=this.dataModel.getStageMaxExp(),this.barExp.value=this.dataModel.stageExp},e.prototype.updateConsume=function(){var t=[GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1)];this.listConsumeData.source=t},e.prototype.updateConsumeZhiSheng=function(t){t.cfg.type==ItemType.JLSJS&&this.updateZhiSheng()},e.prototype.updateMax=function(){this.dataModel.isMaxStage()?(this.imgYml.visible=!0,this.groupUp.visible=!1,this.barExp.maximum=100,this.barExp.value=100,this.btnSend.visible=!1):(this.imgYml.visible=!1,this.groupUp.visible=!0,this.btnSend.visible=!0)},e.prototype.updateHuanhua=function(){this.selectPanel()},e.prototype.selectPanel=function(){this.starExp.setCurStar(this.dataModel.getStart(this.curStage)),this.imgSyz.visible=this.curStage==this.dataModel.useId,this.btnGengHuan.visible=!this.imgSyz.visible&&this.curStage<=this.dataModel.getStage(),this.leftBtn.visible=this.curStage>1;var t=this.dataModel.getStage();t=t<this.dataModel.getMaxStage()?t+1:t,this.rightBtn.visible=this.curStage<t,this.updataMC()},e.prototype.updataMC=function(){this.groupMc.removeChildren();for(var t=this.getModel(),e=0,i=t;e<i.length;e++){var n=i[e];this.groupMc.addChild(MC.createCenterGruop(n,-1))}},e.prototype.getModel=function(){var t=Cfg.getConfig(DamonHuanhuaBaseConfig,this.curStage),e=t.uibody,i=t.name;return this.imgStage=i,[e]},e.prototype.updateSkill=function(){this.skillDatas=SkillSys.ins().getSkillPassivityDatasByIds(this.dataModel.getStageskills()),this.listData.source=this.skillDatas,this.updatePower()},e.prototype.updatePower=function(){for(var t=0,e=0,i=this.skillDatas;e<i.length;e++){var n=i[e];t+=n.getPower()}this.power.text=""+(this.dataModel.getStagePower()+t)},e.prototype.getNameRes=function(){return"jl_zycs_m"+this.curStage},e.prototype.onSkillItem=function(t){var e=t.item;openWin(SkillPassivityUpWin2,e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1))&&ShouHuNewSys.ins().sendDamonStageUp();break;case this.btnGengHuan:ShouHuNewSys.ins().sendDamonHuanHua(this.curStage);break;case this.btnHuanHua:openWin(ShouHuHuanHuaWin,ShouHuHuanHuaWin.getTabIndexbyPanel(DamonHuanHuaPanel));break;case this.btnUseZhiSheng:var e=this.itemZhiSheng.data;ShouHuNewSys.ins().sendDamonUseZhiSheng(Cfg.getConfig(DamonHuanhuaBaseConfig,CondType.Equal,DamonHuanhuaBaseConfig.stoneid,e.id).id)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1))?ShouHuNewSys.ins().sendDamonStageUp():this.longPressBtnUp.stop()},e.prototype.onClickCommon=function(t){switch(t.currentTarget){case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text);break;case this.leftBtn:this.curStage=Math.max(this.curStage-1,1),this.starExp.reset(),this.selectPanel();break;case this.rightBtn:this.curStage=Math.min(this.curStage+1,this.dataModel.getStage()+1),this.starExp.reset(),this.selectPanel();break;case this.btnGet:var e=this.itemZhiSheng.data;openWin(FirstRechargeVeryDayWin,RechargeActSys.ins().firstRechargeEveryDay.getFormItemIndexByItemId(e.id))}},e.prototype.getParentClassName=function(){for(var t=ShouHuWin.getPanelNames(),e=0,i=t;e<i.length;e++){var n=i[e];if(n.getSysId()==this.getSysId())return n}return null},e.prototype.updateZhiSheng=function(){var t=this.dataModel.getActCanUseZhiShengItemIds(),e=BagSys.ins().getItemsById(this.dataModel.getCanUseZhiShengItemIds());SortUtil.sortOn(e,["id"],[SortType.down]);var i=null;if(e.length>0?i=e[0]:t.length>0&&(i=GFunc.creatItemDataById(t[0])),i){var n=GFunc.getItemCount(i.id)>0;this.groupZhiSheng.visible=!this.dataModel.isMaxStage()&&(n||this.dataModel.actHasItem()),this.itemZhiSheng.data=i,this.lbName.text=i.cfg.getName(),this.lbName.textColor=GConst.PZColor[i.cfg.quality],this.btnGet.visible=!n,this.btnUseZhiSheng.visible=n}else this.groupZhiSheng.visible=!1},e.prototype.getBtnSend=function(){return this.btnSend},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_hh},e.getSysId=function(){return SysId.damon},__decorate([callDelay(400)],e.prototype,"updateExp",null),e}(BasePanel);__reflect(DamonStagePanel.prototype,"DamonStagePanel"),window.DamonStagePanel=DamonStagePanel;var DamonYinJiPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=54,e.longPressBtnUp=new LongPress,e.datas=[],e.skinName="DamonYinJiPanelEUI",e.setSkinPart("item0",new FuHunItem),e.setSkinPart("item1",new FuHunItem),e.setSkinPart("item2",new FuHunItem),e.setSkinPart("item3",new FuHunItem),e.items=[e.item0,e.item1,e.item2,e.item3],e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),1176860),e.imgBg.source="jl_zycs_bg3_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnAttr,this.onClick),this.addClickE(this.helpBtn,this.onClick);for(var e=0,i=this.items;e<i.length;e++){var n=i[e];this.addClickE(n,this.onItemClick)}this.addLsn(ShouHuNewSys.ins().patchDamonYinJiUp,this.updatePanel),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close()},e.prototype.updateRp=function(t){(!t||t.check(this))&&(this.btnSend.redPoint.visible=this.data.isMaxCur()?!1:GFunc.isConsumeEnough(this.data.getConsume()))},e.prototype.infoPanel=function(){this.dataModel=ShouHuNewSys.ins().getModelBySysId(this.getSysId()),this.datas=this.dataModel.getYinJuDatas(),this.curItem&&(this.curItem.selected=!1),this.curItem=this.items[0],this.curItem.selected=!0,this.data=this.datas[0],this.updateDefSelect(),this.updatePanel(),this.updateRp()},e.prototype.updateDefSelect=function(){for(var t=this.datas.length-1;t>=0;t--)if(!this.datas[t].isMaxCur()){var e=GFunc.isConsumeEnough(this.datas[t].getConsume());if(e){this.curItem&&(this.curItem.selected=!1),this.curItem=this.items[t],this.curItem.selected=!0,this.data=this.datas[t];break}}},e.prototype.updatePanel=function(){this.updateDefSelect(),this.power.text=""+this.dataModel.getYinJinPower();for(var t in this.items)this.items[t].data=this.datas[t];this.updateSelect()},e.prototype.updateSelect=function(){this.attrData.source=this.dataModel.getYinJiAttrDatas(this.data),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth;var t=this.data.isMax();this.currentState=this.data.isMax()?"max":"normal",this.validateNow(),!t&&(this.listConsumeData.source=this.data.getConsume())},e.prototype.onItemClick=function(t){this.curItem&&(this.curItem.selected=!1),this.curItem=t.currentTarget,this.curItem.selected=!0,this.data=this.curItem.data,this.updateSelect(),this.updateRp()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:this.onBtnUp();break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getYinJiAttrDatasAll(),this.getComAttrTitleEnum());break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){this.onBtnUp()||this.longPressBtnUp.stop()},e.prototype.onBtnUp=function(){return this.data.isMax()?(showtipsFail(Lang.common_str38),!1):this.data.isMaxCur()?(showtipsFail(Lang.damon_str59),!1):GFunc.checkConsumeEnough(this.data.getConsume())?(this.sendPack(),this.curItem.playEff(),!0):!1},e.prototype.sendPack=function(){ShouHuNewSys.ins().sendDamonYinJiUp(this.data.id)},e.prototype.getComAttrTitleEnum=function(){return ComAttrTitleEnum.DamonYinJi},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_yj},e.getSysId=function(){return SysId.DamonYinji},e}(BasePanel);__reflect(DamonYinJiPanel.prototype,"DamonYinJiPanel"),window.DamonYinJiPanel=DamonYinJiPanel;var EntityPlayWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.winType=WinType.NormalWin,e.skillConfig=new SkillsConfig,e.entityXYs=[new XY(-300,-300),new XY(0,0),new XY(-300,100)],e.monsterXYs=[new XY(-290,-290),new XY(0,10),new XY(-290,90)],e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShenMoEntityPlayWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg(),this.target=new EntityBase,this.groupMiddle.addChild(this.target),this.entity=GFunc.createEntityUI(),this.groupMiddle.addChild(this.entity)},e.prototype.open=function(e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=-1),t.prototype.open.call(this),this.skillConfig=e,this.data=i,this.updateView(),this.updatePos(),this.currentState=n==EntityType.BIANSHEN?"shenmo":"role"},e.prototype.close=function(){t.prototype.close.call(this),this.entity.reset(),Timer.ins().removeAll(this)},e.prototype.updatePos=function(){var t=1,e=this.entityXYs[t];this.entity.x=e.x,this.entity.y=e.y;var i=this.monsterXYs[t];this.target.x=i.x,this.target.y=i.y},e.prototype.updateView=function(){this.updateEntity(),this.updateData()},e.prototype.updateEntity=function(){},e.prototype.updateData=function(){this.lbName.text=this.skillConfig.name,this.lbDesc.textFlow=StrUtil.toTF(this.getDesc(this.skillConfig))},e.prototype.getDesc=function(t){var e=t.desc,i="",n=t.args,a=t.monargs,o=1;if(t.tarEff.length>0){var s=Cfg.getConfig(EffectsConfig,t.tarEff[0]);s.args.c>0&&(e=e.replace("{c}",(.01*s.args.c*o).toFixed(1)+"%"+i))}else n.a>=0&&(e=e.replace("{a1}",(n.a/100*o).toFixed(1)+"%"+i)),n.b>=0&&(e=e.replace("{b1}",n.b*o+""+i)),a.a>=0&&(e=e.replace("{a2}",(a.a/100*o).toFixed(1)+"%"+i)),a.b>=0&&(e=e.replace("{b2}",a.b*o+""+i));return ComUtil.IsPC?e:e.replace("          ","                   ")},e}(BaseWinSingle);__reflect(EntityPlayWin.prototype,"EntityPlayWin"),window.EntityPlayWin=EntityPlayWin;var BuffResidentData=function(){function t(){this.type=0,this.vipLevel=0,this.sort=0}return t.prototype.getDesc=function(){var t=addColor("%k",15129784)+"+"+addColor("%v",32047),e=AttrData.parse(this.config.levelAttr,{fm:t}).join("\n");return e},t.prototype.getName=function(){return"VIP"+this.config.lv},t.prototype.getIcon=function(){return ResMgr.getBuffIcon(this.isAct?"buff_zcsy_iconv"+this.vipLevel:"buff_zcsy_iconv"+this.vipLevel+"a")},t.prototype.getTime=function(){return Lang.common_str87},Object.defineProperty(t.prototype,"isAct",{get:function(){return Actor.ins().sVipLv>=this.vipLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(SVipConfig,this.vipLevel))},enumerable:!0,configurable:!0}),t.prototype.tiaozhuan=function(){openWin(VipWin)},t}();__reflect(BuffResidentData.prototype,"BuffResidentData"),window.BuffResidentData=BuffResidentData;var SkillPassivityItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillPassivityItemEUI",e.touchEnabled=!1,e.imgKjh.visible=!1,e.imgKsj.visible=!1,e.upMc=GFunc.playUIMovie("jljn",0,0,e.groupMc,-1,function(){e.upMc.touchEnabled=!1}),e.showRedPoint(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof SkillPassivityData){this.imgIcon.source=ResMgr.getSkillPassivityItemName(this.data.id,this.data.level>0),this.lbLv.text=this.data.isMax()?Lang.common_man:""+this.data.level;var t=(e=RpSys.ins()).getData.apply(e,SkillSys.ins().getSkillPassivityRedPointKey(this.data));this.showRedPoint(t),t?(this.imgKjh.visible=0==this.data.level,this.imgKsj.visible=this.data.level>0):(this.imgKjh.visible=!1,this.imgKsj.visible=!1)
}var e},e.prototype.showRedPoint=function(t){this.redPoint.visible=t,this.upMc.visible=t},e}(BaseItemRender);__reflect(SkillPassivityItem.prototype,"SkillPassivityItem"),window.SkillPassivityItem=SkillPassivityItem;var SkillPassivityUpWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="SkillPassivityUpWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.setSkinPart("item",new SkillPassivityItem)},e.prototype.open=function(e){t.prototype.open.call(this),this.data=e,this.addClickE(this.btnSend,this.onTap),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.upatePanel),this.upatePanel()},e.prototype.upatePanel=function(){this.item.data=this.data,this.lbName.text=this.data.getConfig().name+" Lv."+this.data.level,this.power=Lang.replaceEnum(LangEnum.power,this.data.getPower()),this.groupUp.visible=!this.data.isMax(),this.lbCur.text=this.data.getConfig().skinname,this.lbCur.textColor=8593920,this.lbNext.text=this.data.getNextConfig().skinname;var t=SkillSys.ins().isSkillPassivityUp(this.data);if(this.btnSend.enabled=t,this.btnSend.label=this.data.level>0?Lang.btn_sjie:Lang.btn_jh,this.needGroup.visible=!1,15!=this.data.getConfig().typeUp){var e=this.data.level>0?Lang.skill_str27:Lang.skill_str26;e+=Lang.skill_str28[this.data.getConfig().typeUp]+SkillSys.ins().getSkillPassivityLevelStr(this.data),this.lbAct.text=t?"":e}else{this.lbAct.text="",this.needGroup.visible=!0;var i=t?1834881:15733780,n=this.data.getConfig().item.id,a=this.data.getConfig().item.count,o=Cfg.getItemCfg(n),s=BagSys.ins().getItemCount(o.id);this.lbNum.textFlow=addColorTF(addColor(s+"/"+a,i)),this.consumeIcon.source=ResMgr.getItemIcon(o.getIcon())}},e.prototype.onTap=function(t){if(15==this.data.getConfig().typeUp&&this.data.level<=0){var e=this.data.getConfig().item.id;XianLuSys.ins().sendUseRing(e)}else SkillSys.ins().sendSkillPassivityUp(this.data.id);GFunc.playUIMovie("public_qxt",108,103,this.group,1)},e}(BaseWinSingle);__reflect(SkillPassivityUpWin.prototype,"SkillPassivityUpWin"),window.SkillPassivityUpWin=SkillPassivityUpWin;var SqXyActTipsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="SqXyActTipsWinEUI",e}return __extends(e,t),e.prototype.open=function(e,i,n){t.prototype.open.call(this),this.closeFun=n,this.updatePanel(e,i),this.addClickE(this,this.onTap)},e.prototype.close=function(){t.prototype.close.call(this),this.mc&&this.mc.reset()},e.prototype.onTap=function(t){this.closeFun&&this.closeFun(),closeWin(this)},e.prototype.updatePanel=function(t,e){var i="",n=Actor.ins().job,a=t.id>9?""+t.id:"0"+t.id;if(this.imgTitle.source="shenqi_zycs_xwg",this.groupEntity.removeChildren(),e==SysId.damon){this.imgTitle.source="public_zycs_x1";var o=Cfg.getConfig(DamonHuanhuaBaseConfig,t.id).uibody,s=MC.createCenterGruop(o,-1);this.groupEntity.addChild(s)}else if(e==SysId.Yongbing){this.imgTitle.source="public_zycs_x3";var o=Cfg.getConfig(YongbingHuanhuaBaseConfig,t.id).uibody,s=MC.createCenterGruop(o,-1);this.groupEntity.addChild(s)}else if(e==SysId.Shenmo){this.imgTitle.source="public_zycs_x2";var o=Cfg.getConfig(ShenmoHuanhuaBaseConfig,t.id).uibody,s=MC.createCenterGruop(o,-1);this.addChild(s)}else if(e==SysId.Sz){var r=Cfg.getConfig(SzHuanhuaBaseConfig,t.id).uibody[Actor.ins().sex],s=MC.createCenterGruop(r,-1);this.addChild(s)}else{this.mc=this.mc||new MC,this.groupEntity.addChild(this.mc);var u="";switch(e){case SysId.ShenQi:u=Cfg.getConfig(WeaponAppearanceConfig,t.getApperaenceId(n)).appearance,u=ResMgr.getWeaponUIEFFResource(u),i="shenqi_zycs_"+n+a;break;case SysId.Wing:u=Cfg.getConfig(WingAppearanceConfig,t.getApperaenceId(n)).appearance,u=ResMgr.getWingUIEFFResource(u),i="chibang_zycs_"+n+a,this.groupEntity.y=544;break;case SysId.Meilin:var h=Cfg.getConfig(MeilinAppearanceConfig,t.getApperaenceId()).appearance;u=ResMgr.getUIMeilinRes(h),i="ml_zycs_"+t.id}this.mc.playFile(u,-1)}this.imgName.textFlow=(new egret.HtmlTextParser).parse(t.getName()),this.totalPower.text=""+t.getActPower()},e}(BaseWinSingle);__reflect(SqXyActTipsWin.prototype,"SqXyActTipsWin"),window.SqXyActTipsWin=SqXyActTipsWin;var SqXyBaseModel=function(){function t(){this.huanHuaId=0,this.level=0}return t.prototype.getHuanHuaDataById=function(t){return null},t.prototype.getHuanHuaGroupNames=function(){return[]},t.prototype.getHuanHuaDatasByGroupId=function(t){return[]},t.prototype.getHuanHuaDatas=function(){return[]},t.prototype.getFuHunDataById=function(t){return null},t.prototype.getFuHunDatas=function(){return[]},t.prototype.getLevelConsume=function(){return[]},t.prototype.getLevelAttrDatas=function(){return[]},t.prototype.getLevelHuanHuaDatas=function(t){return[]},t.prototype.getLevelHuanHuaDatasAll=function(){return[]},t.prototype.getLevelFuHunDatas=function(t){return[]},t.prototype.getLevelFuHunDatasAll=function(){return[]},t.prototype.getLevelPower=function(){return 0},t.prototype.getHuanHuaPower=function(){return 0},t.prototype.getFuHunPower=function(){return 0},t.prototype.getApperaenceId=function(){return 0},t.prototype.getSkillIds=function(){return[]},t.prototype.isMaxLv=function(){return!1},t}();__reflect(SqXyBaseModel.prototype,"SqXyBaseModel"),window.SqXyBaseModel=SqXyBaseModel;var BaseFuHunData=function(){function t(t){this.id=0,this.attrs=[],this._level=0,this.id=t}return t.prototype.getLv=function(){return this._level},t.prototype.setLv=function(t){this._level=t,this.attrs.length=0;for(var e=this.getBaseAttr(),i=0,n=e;i<n.length;i++){var a=n[i];this.attrs.push(new AttrData(a.type,a.value*t))}},t.prototype.getIcon=function(){return""},t.prototype.getMaxLv=function(){return 0},t.prototype.getName=function(){return""},t.prototype.getConsume=function(){return[]},t.prototype.isAct=function(){return!1},t.prototype.getBaseAttr=function(){return[]},t.prototype.isMax=function(){return!1},t.prototype.isMaxCur=function(){return!1},t}();__reflect(BaseFuHunData.prototype,"BaseFuHunData"),window.BaseFuHunData=BaseFuHunData;var BaseHuanHuaData=function(){function t(t){this.id=0,this.level=0,this.id=t}return t.prototype.getIcon=function(){var t=GFunc.getItemDataRewardByJob(this.getConsume()),e=Cfg.getItemCfg(t[0].id);return ResMgr.getItemIcon(e.getIcon())},t.prototype.getName=function(){return""},t.prototype.getQuality=function(){return 0},t.prototype.getSrQuality=function(){return 0},t.prototype.getActDec=function(){return""},t.prototype.getActPower=function(){return 0},t.prototype.getConsume=function(){return[]},t.prototype.getApperaenceId=function(t){return 0},t.prototype.getGroupId=function(){return 0},t.prototype.isAct=function(){return!1},t.prototype.isMax=function(){return!1},t.prototype.isUse=function(){return!1},t}();__reflect(BaseHuanHuaData.prototype,"BaseHuanHuaData"),window.BaseHuanHuaData=BaseHuanHuaData;var ShenQiFuHunPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=50,e.longPressBtnUp=new LongPress,e.datas=[],e.skinName="ShenQiFuHunPanelEUI",e.items=[e.item0,e.item1,e.item2,e.item3],e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),1176860),e.imgBg.source="shenqi_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClickCommon),this.addClickE(this.btnAttr,this.onClickCommon),this.addClickE(this.helpBtn,this.onClickCommon);for(var e=0,i=this.items;e<i.length;e++){var n=i[e];this.addClickE(n,this.onListClick)}this.addLsn(SqXySys.ins().patchShenQiFuHunUp,this.updatePanel),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close()},e.prototype.updateRp=function(t){(!t||t.check(this))&&(this.btnSend.redPoint.visible=this.data.isMaxCur()?!1:GFunc.isConsumeEnough(this.data.getConsume()))},e.prototype.infoPanel=function(){this.dataModel=SqXySys.ins().getModelBySysId(this.getSysId()),this.datas=this.dataModel.getFuHunDatas(),this.curItem&&(this.curItem.selected=!1),this.curItem=this.items[0],this.curItem.selected=!0,this.data=this.datas[0],this.updateDefSelect(),this.updatePanel(),this.updateRp()},e.prototype.updateDefSelect=function(){for(var t=this.datas.length-1;t>=0;t--)if(!this.datas[t].isMaxCur()){var e=GFunc.isConsumeEnough(this.datas[t].getConsume());if(e){this.curItem&&(this.curItem.selected=!1),this.curItem=this.items[t],this.curItem.selected=!0,this.data=this.datas[t];break}}},e.prototype.updatePanel=function(){this.updateDefSelect(),this.power.text=""+this.dataModel.getFuHunPower();for(var t in this.items)this.items[t].data=this.datas[t];this.updateSelect()},e.prototype.updateSelect=function(){this.attrData.source=this.dataModel.getLevelFuHunDatas(this.data),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth,this.listConsumeData.source=this.data.getConsume()},e.prototype.playEff=function(t){this.curItem.playEff()},e.prototype.onListClick=function(t){this.curItem&&(this.curItem.selected=!1),this.curItem=t.currentTarget,this.curItem.selected=!0,this.data=this.curItem.data,this.updateSelect(),this.updateRp()},e.prototype.onClickCommon=function(t){switch(t.currentTarget){case this.btnSend:this.onBtnUp();break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getLevelFuHunDatasAll(),ComAttrTitleEnum.FuHun);break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){this.onBtnUp()||this.longPressBtnUp.stop()},e.prototype.onBtnUp=function(){return this.data.isMax()?(showtipsFail(Lang.common_str38),!1):this.data.isMaxCur()?(showtipsFail(Lang.chat_str17+Lang.common_str38),!1):GFunc.checkConsumeEnough(this.data.getConsume())?(this.sendPack(),this.playEff(this.data.id),!0):!1},e.prototype.sendPack=function(){SqXySys.ins().sendShenQiFuHunUp(this.data.id)},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_fh},e.getSysId=function(){return SysId.ShenQi},e}(BasePanel);__reflect(ShenQiFuHunPanel.prototype,"ShenQiFuHunPanel"),window.ShenQiFuHunPanel=ShenQiFuHunPanel;var ShenQiHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=49,e.longPressBtnUp=new LongPress,e.datas=[],e.skinName="ShenQiHuanHuaPanelEUI",e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listBar.dataProvider=e.listBarData=new eui.ArrayCollection,e.listIcon.itemRenderer=HuanHuaItem,e.listIcon.dataProvider=e.listIconData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),1176860),e.imgBg.source="shenqi_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnHuanHua,this.onClick),this.addClickE(this.btnAttr,this.onClickCommon),this.addClickE(this.helpBtn,this.onClickCommon),this.addItemTapE(this.listBar,this.onListBar),this.addItemTapE(this.listIcon,this.onListIcon),this.addLsn(SqXySys.ins().patchShenQiHuanHuaUp,this.updateHuanHuaUp),this.addLsn(SqXySys.ins().patchShenQiHuanHua,this.updateHuanHua),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close(),this.item.setSelect(!1)},e.prototype.updateRp=function(t){if(!t||t.check(this))for(var e=0;e<this.listBar.numChildren;e++){var i=this.listBar.getChildAt(e);i.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,SqXyWin,this.getParentClassName(),this,e+1)}},e.prototype.infoPanel=function(){this.dataModel=SqXySys.ins().getModelBySysId(this.getSysId()),this.listBarData.source=this.dataModel.getHuanHuaGroupNames(),this.listBar.selectedIndex=-1,this.listBar.validateNow(),this.updateDefBarSelect(),this.updateDefSelect(),this.updatePanel(),this.updateRp()},e.prototype.updateDefBarSelect=function(){this.listBar.validateNow();var t=this.listBar.selectedIndex,e=this.getParentClassName();if(0>t||!RpSys.ins().getData(RoleWin,RolePanel,SqXyWin,e,this,t+1)){for(var i=0;i<this.listBar.numChildren;i++)if(RpSys.ins().getData(RoleWin,RolePanel,SqXyWin,e,this,i+1)){t=i;break}this.listBar.selectedIndex=0>t?0:t}},e.prototype.updateDefSelect=function(){this.updateListIcon();var t=0;this.data&&this.datas&&this.datas.length>0&&(t=this.datas.indexOf(this.data)),t=t>-1?t:0;var e=this.getParentClassName();if(this.item&&RpSys.ins().getData(RoleWin,RolePanel,SqXyWin,e,this,this.listBar.selectedIndex+1,this.item.data.id))this.data&&~this.listIcon.selectedIndex&&(this.listIcon.selectedIndex=this.datas.indexOf(this.data));else{for(var i=-1,n=0;n<this.datas.length;n++){var a=this.datas[n],o=RpSys.ins().getData(RoleWin,RolePanel,SqXyWin,e,this,this.listBar.selectedIndex+1,a.id);if(o){t=n,i=-1;break}a.isUse()&&(i=n)}i>-1&&(t=i),this.listIcon.selectedIndex=t,this.item=this.listIcon.getChildAt(this.listIcon.selectedIndex),this.data=this.item.data}this.updateSelectIcon()},e.prototype.updateHuanHuaUp=function(){this.resetItemData(),this.updateDefBarSelect(),this.updateDefSelect(),this.updatePanel()},e.prototype.resetItemData=function(){this.item.setSelect(!1),this.item=null,this.data=null},e.prototype.updatePanel=function(){this.power.text=""+this.dataModel.getHuanHuaPower(),this.bmpLv.text=""+this.data.level,this.imgName=addColorTF(this.data.getName()),this.groupLv.visible=this.data.level>0,this.imgWjh.visible=0==this.data.level;var t=addColor(this.data.getActDec(),16751375);t+=Lang.common_str117+addColor("+"+this.data.getActPower(),16751375),this.lbActDec.textFlow=addColorTF(0==this.data.level?t:""),this.decBg.visible=0==this.data.level,this.attrData.source=this.dataModel.getLevelHuanHuaDatas(this.data),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth;var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));this.listConsumeData.source=e,this.btnSend.redPoint.visible=GFunc.isConsumeEnough(e),this.btnSend.label=this.data.isAct()?Lang.btn_sj:Lang.btn_jh,this.data.isMax()?(this.btnSend.visible=!1,this.listConsume.visible=!1,this.imgYml.visible=!0):(this.btnSend.visible=!0,this.listConsume.visible=!0,this.imgYml.visible=!1),this.item.dataChanged(),this.updateHuanHua()},e.prototype.updateHuanHua=function(){this.imgSyz.visible=this.data.id==this.dataModel.huanHuaId,this.btnHuanHua.visible=this.data.level>0?!this.imgSyz.visible:!1,this.updataMC(),this.listIconData.refresh()},e.prototype.updataMC=function(){this.groupMc.removeChildren();var t=this.getModel(),e=this.getModelHight();for(var i in t){var n=MC.createCenterGruop(t[i],-1);n.verticalCenter=e[i]||0,this.groupMc.addChild(n)}},e.prototype.getModelHight=function(){return[]},e.prototype.getModel=function(){var t=Cfg.getConfig(WeaponAppearanceConfig,this.data.getApperaenceId(Actor.ins().job)).appearance;return[ResMgr.getWeaponUIEFFResource(t)]},e.prototype.getNameRes=function(t){return"shenqi_zycs_"+Actor.ins().job+t},e.prototype.getApperaence=function(){var t=Cfg.getConfig(WeaponAppearanceConfig,this.data.getApperaenceId(Actor.ins().job)).appearance;return ResMgr.getWeaponUIEFFResource(t)},e.prototype.updateListIcon=function(){this.datas=this.dataModel.getHuanHuaDatasByGroupId(this.listBar.selectedIndex+1),this.listIconData.source=this.datas,this.listIcon.validateNow()},e.prototype.updateSelectIcon=function(){-1==this.datas.indexOf(this.data)?this.item.setSelect(!1):this.item.setSelect(!0)},e.prototype.onListBar=function(t){this.resetItemData(),this.updateDefSelect(),this.updatePanel()},e.prototype.onListIcon=function(t){this.item.setSelect(!1),this.item=t.itemRenderer,this.data=t.item,this.updatePanel(),this.updateSelectIcon()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(e)&&SqXySys.ins().snedShenQiHuanHuaUp(this.data.id);break;case this.btnHuanHua:SqXySys.ins().sendShenQiHuanHua(this.data.id)}},e.prototype.onClickCommon=function(t){switch(t.currentTarget){case this.btnAttr:openWin(ComAttrWin,this.dataModel.getLevelHuanHuaDatasAll(),ComAttrTitleEnum.HuanHua);break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){var t=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(t)?SqXySys.ins().snedShenQiHuanHuaUp(this.data.id):this.longPressBtnUp.stop()},e.prototype.getParentClassName=function(){for(var t=SqXyWin.getPanelNames(),e=0,i=t;e<i.length;e++){var n=i[e];if(n.getSysId()==this.getSysId())return n}return null},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return"幻化"},e.getSysId=function(){return SysId.ShenQi},e}(BasePanel);__reflect(ShenQiHuanHuaPanel.prototype,"ShenQiHuanHuaPanel"),window.ShenQiHuanHuaPanel=ShenQiHuanHuaPanel;var ShenQiLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=48,e.longPressBtnUp=new LongPress,e.skillDatas=[],e.skinName="ShenQiLevelPanelEUI",e.list.itemRenderer=SkillPassivityItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.imgBg.source="shenqi_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.helpBtn,this.onClick),this.addItemTapE(this.list,this.onSkillItem),this.addLsn(SqXySys.ins().patchShenQiUp,this.updatePanel),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close()},e.prototype.updateRp=function(t){(!t||t.check(this))&&(this.btnSend.redPoint.visible=GFunc.isConsumeEnough(this.dataModel.getLevelConsume()))},e.prototype.infoPanel=function(){this.dataModel=SqXySys.ins().getModelBySysId(this.getSysId()),this.updatePanel(),this.updataMC(),this.updateRp()},e.prototype.updatePanel=function(){this.bmpLv.text="l"+this.dataModel.level,this.attrData.source=this.dataModel.getLevelAttrDatas(),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth,this.listConsumeData.source=this.dataModel.getLevelConsume(),this.dataModel.isMaxLv()?(this.btnSend.visible=!1,this.listConsume.visible=!1,this.imgYml.visible=!0):(this.btnSend.visible=!0,this.listConsume.visible=!0,this.imgYml.visible=!1),this.updateSkill()},e.prototype.updataMC=function(){this.groupMc.removeChildren();var t=this.getModel(),e=this.getModelHight();for(var i in t){var n=MC.createCenterGruop(t[i],-1);n.verticalCenter=e[i]||0,this.groupMc.addChild(n)}},e.prototype.getModelHight=function(){return[]},e.prototype.getModel=function(){var t=Cfg.getConfig(WeaponAppearanceConfig,this.dataModel.getApperaenceId()).appearance;return[ResMgr.getWeaponUIEFFResource(t)]},e.prototype.updateSkill=function(){this.skillDatas=SkillSys.ins().getSkillPassivityDatasByIds(this.dataModel.getSkillIds()),this.listData.source=this.skillDatas,this.lbSkillLv.textFlow=addColorTF(SkillSys.ins().getSkillPassivityUpDec(this.skillDatas)),this.updatePower()},e.prototype.updatePower=function(){for(var t=0,e=0,i=this.skillDatas;e<i.length;e++){var n=i[e];t+=n.getPower()}this.power.text=""+(this.dataModel.getLevelPower()+t)},e.prototype.playEff=function(t,e){void 0===e&&(e=0);GFunc.playUIMovie(t,0,e,this.groupMc,1)},e.prototype.onSkillItem=function(t){var e=t.item;openWin(SkillPassivityUpWin,e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())&&(SqXySys.ins().sendShenQiUp(),this.playEff("pubsjeff"));break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())?(SqXySys.ins().sendShenQiUp(),this.playEff("pubsjeff")):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_sjie},e.getSysId=function(){return SysId.ShenQi},e}(BasePanel);__reflect(ShenQiLevelPanel.prototype,"ShenQiLevelPanel"),window.ShenQiLevelPanel=ShenQiLevelPanel;var SuitDataBase=function(){function t(){this.xlId=1,this.id=1}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(SuitConfig,this.id))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xlConfig",{get:function(){return this._xlConfig||(this._xlConfig=Cfg.getSuitXLConfigById(this.id))},enumerable:!0,configurable:!0}),t.prototype.isInCondition=function(t,e,i){var n=this.config.condition;return t>=n.rank&&e>=n.star&&i>=n.quality},t}();__reflect(SuitDataBase.prototype,"SuitDataBase"),window.SuitDataBase=SuitDataBase;var QiYueInfo=function(){function t(){this.id=0,this.type=0,this.value=0,this.state=0}return t.prototype.setType=function(t){this.type=t},t.prototype.setvalue=function(t){this.value=t},t.prototype.setstate=function(t){this.state=t},t.prototype.parser=function(t){this.id=t.readShort(),this.value=t.readDouble(),this.state=t.readByte()},t.prototype.isSuccess=function(){return this.state==RewardStatus.YiLinQu},t.prototype.chekReceive=function(){return this.state==RewardStatus.KeLinQu},t.prototype.getConfig=function(){return this.config||(this.config=Cfg.getConfig(AgreementConfig,this.type,this.id)),this.config},t.prototype.getShowProg=function(){if(5==this.getConfig().type){var t=this.value>=this.getConfig().target;return StrUtil.addColor(t?"（1/1）":"（0/1）",t?3821938:11870240)}return StrUtil.addColor("（"+this.value+"/"+this.getConfig().target+"）",this.value<this.getConfig().target?11870240:3821938)},t}();__reflect(QiYueInfo.prototype,"QiYueInfo"),window.QiYueInfo=QiYueInfo;var TaskData=function(){function t(){this.id=1,this.value=0,this.state=0}return t.prototype.canGetAward=function(){return 1==this.state},t.prototype.hasGetAward=function(){return 2==this.state},t.prototype.isDoing=function(){return 0==this.state},t}();__reflect(TaskData.prototype,"TaskData"),window.TaskData=TaskData;var RolePanel=function(t){function e(){var e=t.call(this)||this;return e.mcbtnOneKeyEquip=new MC,e.init(),e.mcbtnOneKeyEquip.x=e.btnOneKeyEquip.width/2,e.mcbtnOneKeyEquip.y=e.btnOneKeyEquip.height/2,e.btnOneKeyEquip.addChild(e.mcbtnOneKeyEquip),urlParam.isShenhe&&(e.btnZLXZ.visible=e.btnShengbei.visible=e.btnZhaoCaiLong.visible=e.btnXLRing.visible=!1),e}return __extends(e,t),e.prototype.init=function(){this.skinName="RolePanelEUI",this.currentState="own",this.equips=[];for(var t=0;t<EquipPos.MAX;t++)this.equips[t]=this["item"+t],this.equips[t].touchEnabled=!0;this.setRedPointHead(RoleWin)},e.prototype.open=function(e){this.seePlayModel=e,t.prototype.open.call(this),this.addClickE(this,this.onClick),this.addClickE(this.item0,this.onClickItem),this.addClickE(this.item1,this.onClickItem),this.addClickE(this.item2,this.onClickItem),this.addClickE(this.item3,this.onClickItem),this.addClickE(this.item4,this.onClickItem),this.addClickE(this.item5,this.onClickItem),this.addClickE(this.item6,this.onClickItem),this.addClickE(this.item7,this.onClickItem),this.addClickE(this.item8,this.onClickItem),this.addClickE(this.item9,this.onClickItem),this.addLsn(LogicSys.ins().patchLevelChange,this.roleLevelChange),this.addLsn(BagSys.ins().patchEquipChange,this.updataEquip),this.addLsn(SqXySys.ins().patchShenQiHuanHua,this.updateEntity),this.addLsn(SqXySys.ins().patchWingHuanHua,this.updateEntity),this.addLsn(SqXySys.ins().patchSzHuanHua,this.updateEntity),this.addLsn(RechargePowerSys.ins().patchhaoCaiLongBuy,this.updateBtnState),this.addLsn(RechargePowerSys.ins().patchXunZhangBuy,this.updateBtnState),this.addLsn(RechargePowerSys.ins().patchShengbeiXiangqian,this.updateBtnState),this.addLsn(XianLuSys.ins().updateXianyuanInfo,this.updateBtnState),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.updatePanel(),this.roleLevelChange(),this.updateRp(),this.updateEntity(),this.updateBtnState()},e.prototype.updateEntity=function(){this.groupEntity.removeChildren();var t,e=0;if(this.seePlayModel.damonId){var i=Cfg.getConfig(DamonHuanhuaBaseConfig,this.seePlayModel.damonId),n=i.uirole,a=i.uihigh;this.groupEntity.addChild(MC.createCenterGruop(n,-1)),e=a,t=n}var o,s=this.seePlayModel.getWingFileName();s&&(o=MC.createCenterGruop(this.seePlayModel.getWingFileName(),-1),o.verticalCenter=-e,this.groupEntity.addChild(o)),o=MC.createCenterGruop(this.seePlayModel.getBodyFileName(),-1),o.verticalCenter=-e,this.groupEntity.addChild(o),t&&this.groupEntity.addChild(MC.createCenterGruop("up_"+t,-1)),o=MC.createCenterGruop(this.seePlayModel.getWeaponFileName(),-1),o.verticalCenter=-e,this.groupEntity.addChild(o);var r=this.seePlayModel.getShengLingFileName();""!=r&&(o=MC.createCenterGruop(r,-1),o.verticalCenter=-e,this.groupEntity.addChild(o))},e.prototype.updatePanel=function(){this.updataEquip(),this.updateRoleRedPoint()},e.prototype.roleLevelChange=function(){},e.prototype.updataEquip=function(){var t=Actor.ins().attrData;this.setEquip(t)},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(ShengLingWin))&&(this.btnFruit.redPoint.visible=RpSys.ins().getData(RoleWin,e,ShengLingWin)),(!t||t.check(FuwenSysWin))&&(this.btnElement.redPoint.visible=RpSys.ins().getData(RoleWin,e,FuwenSysWin)),(!t||t.check(SuitWin))&&(this.btnTaoZhuang.redPoint.visible=RpSys.ins().getData(RoleWin,e,SuitWin)),(!t||t.check(ZhuangBanWin))&&(this.btnZhuangBan.redPoint.visible=RpSys.ins().getData(RoleWin,e,ZhuangBanWin)),(!t||t.check(ShenQiPanel))&&(this.btnShenQi.redPoint.visible=RpSys.ins().getData(RoleWin,e,SqXyWin,ShenQiPanel)),(!t||t.check(WingPanel))&&(this.btnWing.redPoint.visible=RpSys.ins().getData(RoleWin,e,SqXyWin,WingPanel)),(!t||t.check(SzPanel))&&(this.btnSz.redPoint.visible=RpSys.ins().getData(RoleWin,e,SqXyWin,SzPanel)),(!t||t.check(MeilinPanel))&&(this.btnMeiLin.redPoint.visible=RpSys.ins().getData(RoleWin,e,SqXyWin,MeilinPanel)),(!t||t.check(ZhaoCaiLongWin))&&(this.btnZhaoCaiLong.redPoint.visible=RpSys.ins().getData(RoleWin,e,ZhaoCaiLongWin)),(!t||t.check(XunZhangWin))&&(this.btnZLXZ.redPoint.visible=RpSys.ins().getData(RoleWin,e,XunZhangWin)),(!t||t.check(ShengbeiWin))&&(this.btnShengbei.redPoint.visible=RpSys.ins().getData(RoleWin,e,ShengbeiWin)),(!t||t.check(MoJieWin))&&(this.btnShenJie.redPoint.visible=RpSys.ins().getData(RoleWin,e,MoJieWin)),(!t||t.check(e))&&this.updateRoleRedPoint()},e.prototype.updateBtnState=function(){this.btnZhaoCaiLong.iconDisplay.source=RechargePowerSys.ins().zhaoCaiLongData.isAct()?"role_zycs_hjsl":"role_zycs_hjsl1",this.btnZLXZ.iconDisplay.source=RechargePowerSys.ins().xunZhangData.isAct()?"role_zycs_zlxz":"role_zycs_zlxz1",this.btnShengbei.iconDisplay.source=RechargePowerSys.ins().shengbeiData.isGet()?"role_zycs_bxsb":"role_zycs_bxsb1";var t=XianLuSys.ins().ringId;this.btnXLRing.iconDisplay.source=t>0?"role_zycs_jyjz"+t:"role_zycs_jyjz"},e.prototype.updateRoleRedPoint=function(){for(var t=this.seePlayModel.getEquipLen(),i=0;t>i;i++)this.equips[i].updateRedPoint();var n=RpSys.ins().getData(RoleWin,e,"equip");this.btnOneKeyEquip.redPoint.visible=n,n?this.mcbtnOneKeyEquip.playFile(ResMgr.getEffName("public_zycs_button01"),-1):(this.mcbtnOneKeyEquip.stop(),this.mcbtnOneKeyEquip.visible=!1)},e.prototype.setEquip=function(t){if(t){for(var e=this.seePlayModel.getEquipLen(),i=0;e>i;i++)this.equips[i].data=this.seePlayModel.getEquipByIndex(i);this.totalPower.text=this.seePlayModel.power.toFixed(0),this.updateEntity()}},e.prototype.onClickItem=function(t){var e=t.currentTarget;if(e.hitTestPoint(t.stageX,t.stageY)&&e instanceof RoleItem){var i=e;i.getItemData().hasEquipOn()?openWin(RoleEquipTipsWin,i.getItemData(),null,this.onShowSelectEquipWin,this):BagSys.ins().hasEquip(i.getItemData().equipPos)?this.onShowSelectEquipWin(i.getItemData()):GFunc.isRing(i.getItemData().equipPos)?openWin(XunBaoWin,0):(openWin(MeNeedLevelWin),showtipsFail(Lang.role_str15))}},e.prototype.onShowSelectEquipWin=function(t){openWin(RoleEquipSelectWin,t)},e.prototype.onClick=function(t){switch(t.target){case this.btnOneKeyEquip:var e=BagSys.ins().getZuiHaoEquipId();e.length>0?EquipSys.ins().sendOneKeyEquip(e):showtipsFail("没有可替换的装备");break;case this.btnShenJie:openWin(MoJieWin);break;case this.btnXLRing:if(XianLuSys.ins().ringId>0)openWin(XianluRingTipsWin,!1);else{var i=GFunc.creatRewardDataById(830102,1);GFunc.checkConsumeEnough(i)}break;case this.btnZLXZ:openWin(XunZhangWin);break;case this.btnZhaoCaiLong:openWin(ZhaoCaiLongWin);break;case this.btnDamon:openWin(ShouHuWin);break;case this.btnTaoZhuang:openWin(SuitWin);break;case this.btnAttr:openWin(RoleAttrWin1);break;case this.btnElement:openWin(FuwenSysWin);break;case this.btnFruit:openWin(ShengLingWin);break;case this.btnZhuangBan:openWin(ZhuangBanWin);break;case this.btnShenQi:openWin(SqXyWin,0);break;case this.btnWing:openWin(SqXyWin,1);break;case this.btnSz:openWin(SqXyWin,2);break;case this.btnMeiLin:openWin(SqXyWin,3);break;case this.btnShengbei:openWin(ShengbeiWin)}},e.prototype.getEquipItem=function(t){return this.equips[t]},e.prototype.getEquipItemCanPutOn=function(){for(var t=0,e=this.equips;t<e.length;t++){var i=e[t],n=i.data,a=n.equipPos;if(a>EquipPos.WEAPON&&a<EquipPos.EMBLEM&&!n.hasEquipOn()&&BagSys.ins().getEquipBySubType(a))return i}return null},e.prototype.getHuFuItem=function(){return null},e.prototype.getkillBtn=function(){return null},e.prototype.getFruitBtn=function(){return this.btnFruit},e.prototype.getElementBtn=function(){return this.btnElement},e.prototype.getSHengJie=function(){return this.btnShenJie},e.prototype.getDamonItem=function(){return null},e.prototype.getTujianBtn=function(){return null},e.prototype.getBtnOneKeyEquip=function(){return this.btnOneKeyEquip},e.getSysId=function(){return SysId["default"]},e.getTitle=function(){return"btz_zycs_js"},e.getTabTitle=function(){return"bqz_zycs_js"},e}(BasePanel);__reflect(RolePanel.prototype,"RolePanel"),window.RolePanel=RolePanel;var TaskNavDataType1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){t.prototype["goto"].call(this);var e=checkOpenWin(this.winName,this.winPage,this.winParam);if(e?this.succeedFrontFun.call():this.loserFun.call(),e){var i=openWin(this.winName,this.winPage,this.winParam),n=null!=i;n&&this.succeedFun.call()}},Object.defineProperty(e.prototype,"winName",{get:function(){return Cfg.getWinClassById(this.winSysId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winSysId",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winPage",{get:function(){return this.controlTarget[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winParam",{get:function(){return this.controlTarget[3]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType1.prototype,"TaskNavDataType1"),window.TaskNavDataType1=TaskNavDataType1;var TianMoEquipItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="TianMoEquipUpLevelItemEUI"},e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getItemCfg(parseInt(t.getConfig().id[Actor.ins().job-1]));this.imgIcon.source=ResMgr.getItemIcon(e.getIcon(),IconType.IT_80x80),this.imgIcon.filters=t.isAct?[]:DisUtil.grayFilter(),this.lbLevel.text=t.showLevel()+"级",this.lbLevel.visible=this.imgLvBg.visible=t.getIsAct(),this.updateRedPoint()
},e.prototype.updateRedPoint=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,TianMoMainPanel,TianMoEquipUpLevelPanel,t.pos))},e.prototype.setSelectBG=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(TianMoEquipItem.prototype,"TianMoEquipItem"),window.TianMoEquipItem=TianMoEquipItem;var SVipTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="SVipTipsWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.setSkinPart("price",new PriceIcon),this.price.setType(CurType.yb),this.groupBuy.visible=!1},e.prototype.open=function(e){t.prototype.open.call(this),this.addClickE(this.btnOk,this.onTap),this.updatePanel(e)},e.openCheck=function(t){var e=!0,i=VipSys.ins().getCurSVipConfig(),n=Cfg.getNextVipExpBySysId(t),a=Cfg.getConfig(SVipConfig,n);if(Cfg.getVipCount(i,t)>=Cfg.getVipCount(a,t)){var o="";switch(t){case SysId.KFCB:o=Lang.act_str83;break;case SysId.richangfb:o=Lang.fb_str352;break;case SysId.JJC:o=Lang.fb_str85;break;case SysId.TianTi:o=Lang.fb_str140;case SysId.kfbosssd:o=Lang.kfboss_str4;break;default:o=Lang.fruit_str7}showtipsFail(o),e=!1}return e},e.prototype.updatePanel=function(t){var e=VipSys.ins().getCurSVipConfig(),i=Cfg.getNextVipExpBySysId(t),n=Cfg.getConfig(SVipConfig,i),a=addColor("SVIP"+n.lv,65280);switch(a=Lang.fruit_str3.replace("$count$",a),this.lbTips.textFlow=addColorTF(a),this.curVip.text=""+e.lv,this.nextVip.text=""+n.lv,a="",t){case SysId.JJC:case SysId.TianTi:a=Lang.vip_str5+"\n";break;default:a=Lang.vip_str4+"\n"}this.lbCountL.textFlow=addColorTF(a+addColor(""+Cfg.getVipCount(e,t),65280)+Lang.common_ci),this.lbCountR.textFlow=addColorTF(a+addColor(""+Cfg.getVipCount(n,t),65280)+Lang.common_ci)},e.prototype.onTap=function(t){openWin(RechargeWin),closeWin(e)},e}(BaseWinSingle);__reflect(SVipTipsWin.prototype,"SVipTipsWin"),window.SVipTipsWin=SVipTipsWin;var FirstRechargeEveryDayPanel1=function(t){function e(){var e=t.call(this)||this;return e.index=1,e.setSkinName(),e.btnGetAward.redPoint.visible=!0,e.list.itemRenderer=ItemBaseRewardActivity,e.list.dataProvider=e.listAwardCollection=new eui.ArrayCollection,e.imgIcons=[e.imgIcon0,e.imgIcon1,e.imgIcon2],e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="FirstreChargeeVeryDayEUI1",this.index=1},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RechargeActSys.ins().patchUpdateRecharge,this.update),this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.btnGetAward,this.onClick),this.update()},e.prototype.update=function(){var t,e=(Actor.ins().job,RechargeActSys.ins().firstRechargeEveryDay.states[this.index-1]);0==e?(this.btnGetAward.visible=!0,this.btnRecharge.visible=!1,this.btnHasGet.visible=!1):1==e?(this.btnGetAward.visible=!1,this.btnRecharge.visible=!1,this.btnHasGet.visible=!0):-1==e&&(this.btnGetAward.visible=!1,this.btnRecharge.visible=!0,this.btnHasGet.visible=!1);var i=RechargeActSys.ins().firstRechargeEveryDay,n=i.configs[this.index];t=GFunc.getItemDataRewardByJob(n.awardList),this.listAwardCollection.replaceAll(t),this.labelRechargeOne.textFlow=addColorTF(Lang.recharge_str2.replace("$yuan$",""+StrUtil.addColor(n.pay/10+Lang.common_yuan,16751375)));for(var a=0;a<this.imgIcons.length;a++);},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnRecharge:openWin(RechargeWin);break;case this.btnGetAward:BagSys.ins().checkBagFreeCount(5)&&RechargeActSys.ins().sendRechargeEveryday(this.index)}},e.getTitle=function(){return"btz_zycs_mrsc"},e}(BasePanel);__reflect(FirstRechargeEveryDayPanel1.prototype,"FirstRechargeEveryDayPanel1"),window.FirstRechargeEveryDayPanel1=FirstRechargeEveryDayPanel1;var XunBaoEquipData=function(t){function e(){var e=t.call(this)||this;return e.tabName="装备寻宝",e.type=XunbaoType.Equip,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e)},Object.defineProperty(e.prototype,"gailvdesc",{get:function(){for(var t=XunBaoSys.ins().getDoubleTimer()>0,e=Cfg.getConfig(XunbaoConstConfig).gailvdesc[this.type-1],i=this.getXunbaoEquipByPondid(),n=0;n<i.length;n++){var a=i[n],o=i[n].item,s=Cfg.getItemCfg(o.id),r=t?a.probability2:a.probability1,u=addColor(s.getName()+"  "+Math.ceil(r/100)+"%",GConst.PZColor[s.quality]);e+="\n"+u}return e},enumerable:!0,configurable:!0}),e.prototype.getXunbaoEquipByPondid=function(){return Cfg.getConfigs(XunbaoEquipConfig,0,CondType.ALL)},Object.defineProperty(e.prototype,"showItemDatas",{get:function(){if(0==this._showItemDatas.length){var t=this.getConfig();SortUtil.sortOn(t,["show"],[SortType.up]);for(var e=0;e<t.length;e++){var i=t[e],n=i.item,a=GFunc.creatItemDataById(n.id);this._showItemDatas.push(a)}}return this._showItemDatas},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){return Cfg.getConfigs(XunbaoEquipConfig,0,CondType.MoreEqual,"show",1)},Object.defineProperty(e.prototype,"bideItemData",{get:function(){var t;if(this.isBiDe){var e=Cfg.getConfig(XunbaoConstConfig).costcount[2][0],i=this.getXunbaoEquipConfigById(e,1);if(1==i.status){var n=i.item.id;t=GFunc.creatItemDataById(n)}}return t},enumerable:!0,configurable:!0}),e.prototype.getXunbaoEquipConfigById=function(t,e){return Cfg.getConfig(XunbaoEquipConfig,t,1)},e.prototype.getPanelName=function(){return egret.getQualifiedClassName(XunBaoEquipPanel)},e}(XunBaoBaseData);__reflect(XunBaoEquipData.prototype,"XunBaoEquipData"),window.XunBaoEquipData=XunBaoEquipData;var XunBaoBagPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoBagPanelItemEUI",e.setSkinPart("item",new ItemBase),e.item.touchEnabled=!1,e.item.touchChildren=!1,e.setSelect(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=GFunc.creatItemDataById(t.id);e.count=t.count,this.item.data=e},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e.prototype.isSelect=function(){return this.imgSelect.visible},e}(BaseItemRender);__reflect(XunBaoBagPanelItem.prototype,"XunBaoBagPanelItem"),window.XunBaoBagPanelItem=XunBaoBagPanelItem;var RechargeOtherItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RechargeOtherItemEUI",e}return __extends(e,t),e.prototype.open=function(){},e}(BaseEUI);__reflect(RechargeOtherItem.prototype,"RechargeOtherItem"),window.RechargeOtherItem=RechargeOtherItem;var XunBaoEquipPanel=function(t){function e(){var e=t.call(this)||this;return e.items=[],e.setSkinPart("xunBaoBiDeTips",new XunBaoBiDeTips),e.lbGuangGao.source="xb_zycs_zbmsz",e.setSkinPart("item0",new XunBaoEquipPanelItem),e.setSkinPart("item1",new XunBaoEquipPanelItem),e.setSkinPart("item2",new XunBaoEquipPanelItem),e.setSkinPart("item3",new XunBaoEquipPanelItem),e.setSkinPart("item4",new XunBaoEquipPanelItem),e.setSkinPart("item5",new XunBaoEquipPanelItem1),e.setSkinPart("item6",new XunBaoEquipPanelItem2),e.setSkinPart("item7",new XunBaoEquipPanelItem2),e.setSkinPart("item8",new XunBaoEquipPanelItem1),e.setSkinPart("item9",new XunBaoEquipPanelItem),e.setSkinPart("item10",new XunBaoEquipPanelItem),e.setSkinPart("item11",new XunBaoEquipPanelItem),e.setSkinPart("item12",new XunBaoEquipPanelItem),e.setSkinPart("item13",new XunBaoEquipPanelItem),e.items=[e.item0,e.item1,e.item2,e.item3,e.item4,e.item5,e.item6,e.item7,e.item8,e.item9,e.item10,e.item11,e.item12,e.item13],e.lbGuangGao.source="xb_zycs_zbmsz",e.imgTitle.source="xb_zycs_zbxb",e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XunBaoEquipPanelEUI"},e.prototype.open=function(){t.prototype.open.call(this)},e.prototype.updateRp=function(){},e.prototype.updateChouJiang=function(){t.prototype.updateChouJiang.call(this)},e.prototype.updatePanel=function(){t.prototype.updatePanel.call(this);for(var e=this.data.showItemDatas,i=0;i<this.items.length;i++){var n=this.items[i],a=e[i];n&&a&&(n.data=a)}},e.prototype.updateXingYun=function(){this.progressExp.maximum=this.data.maxXingYun,this.progressExp.value=this.data.xingyun},e.prototype.updateState=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts1);t&&t.isOpenActivity()?this.currentState="act":this.currentState=XunBaoSys.ins().isDoubleTimer()?"7day":"none",this.validateNow()},e.prototype.updateTime=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts1);if(t&&t.isOpenActivity())this.lbDoubleTimer.text=t.getformatTime();else{var e=XunBaoSys.ins().getDoubleTimer();e>0?this.lbDoubleTimer.text=""+getFormatTime(e,"dd天hh小时mm分钟ss秒"):this.lbDoubleTimer.text=""}},Object.defineProperty(e.prototype,"data",{get:function(){return XunBaoSys.ins().getXunBaoDataByType(XunbaoType.Equip)},enumerable:!0,configurable:!0}),e.getTitle=function(){return"btz_zycs_zbxb"},e.getTabTitle=function(){return"装备寻宝"},e.getSysId=function(){return SysId.XunBaoEquip},e}(XunBaoBasePanel);__reflect(XunBaoEquipPanel.prototype,"XunBaoEquipPanel"),window.XunBaoEquipPanel=XunBaoEquipPanel;var AIDamon=function(t){function e(){var e=t.call(this)||this;return e.aiTime=400,e.params.pickRadio=MapBase.CELL_SIZE,e.params.followDis=100,e}return __extends(e,t),e.prototype.getPath=function(t){return MapContainer.ins().getPath(t,this.entity,function(t,e){return!0})},e.prototype.getFollowXY=function(t){var e=DirUtil.get8Dir(this.entity,t),i=DirUtil.getGridByDir((e+1)%8,this.params.followDis/MapBase.CELL_SIZE,t);return i},e.prototype.Follow=function(){if(this.isMoveing())return!1;this.canPickItem()&&this.startPickItem();var t=this.getFollowTarget();return t&&this.isFaraway(t)&&!this.isSameGrid(new XY(this.params.x,this.params.y),t)?(this.startFollow(this.params.followHandle,this.params.followMasterHandle),!0):!1},e.prototype.PickItem=function(){return this.getPickItemCount()>0?t.prototype.PickItem.call(this):void this.startFollow(this.params.followHandle,this.params.followMasterHandle)},e.prototype.Stand=function(){this.isFaraway()&&this.startFollow(this.params.followHandle,this.params.followMasterHandle)},e}(AIBase);__reflect(AIDamon.prototype,"AIDamon"),window.AIDamon=AIDamon;var XunBaoEquipPanelItem1=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XunBaoEquipPanelItem1EUI"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.lbName.text=e.cfg.getName(),this.lbName.textColor=GConst.PZColor[e.cfg.quality],this.item.setItemKuangEffect(!0,"eff5")},e}(XunBaoEquipPanelItem);__reflect(XunBaoEquipPanelItem1.prototype,"XunBaoEquipPanelItem1"),window.XunBaoEquipPanelItem1=XunBaoEquipPanelItem1;var ShouYouYinJiComponent=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShouYouYinJiComponentEUI",e}return __extends(e,t),e.prototype.setValue=function(t,e){if(e!=this.groupItem.numChildren){this.groupItem.removeChildren(),this.groupStar.removeChildren();for(var i=0;e>i;i++){var n=new eui.Image("zz");n.width=n.height=16,this.groupStar.addChild(n);var a=new ShouYouYinJiComponentItem;this.groupItem.addChild(a)}}for(var i=0;e>i;i++){var a=this.groupItem.getElementAt(i);a&&(a.data=t>i)}},e.prototype.reset=function(){this.groupItem.removeChildren(),this.groupStar.removeChildren()},e}(eui.Component);__reflect(ShouYouYinJiComponent.prototype,"ShouYouYinJiComponent"),window.ShouYouYinJiComponent=ShouYouYinJiComponent;var SVIPMSPanel=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SVIPMSPanelEUI",t.prototype.initUI.call(this),this.listTab.itemRenderer=SVIPMSTabItem,this.listTab.dataProvider=this.listTabArr=new eui.ArrayCollection,this.listTabArr.source=[Cfg.getConfig(SVIPMSConfig,1),Cfg.getConfig(SVIPMSConfig,2),Cfg.getConfig(SVIPMSConfig,3)],this.listAward.itemRenderer=ItemBaseRewardName,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.btnRecharges=[this.btnRecharge0,this.btnRecharge1,this.btnRecharge2,this.btnRechargeAll],this.mcBox=GFunc.playUIMovie("yyms1",0,0,this.groupBoxEff,-1),GFunc.playUIMovie("yyms2",89,35,this.btnRechargeAll,-1),GFunc.playUIMovie("yyms2",89,35,this.btnGet,-1)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnLeft,this.onClick),this.addClickE(this.btnRight,this.onClick),this.addClickE(this.btnRecharge0,this.onClick),this.addClickE(this.btnRecharge1,this.onClick),this.addClickE(this.btnRecharge2,this.onClick),this.addClickE(this.btnRechargeAll,this.onClick),this.addClickE(this.btnGet,this.onClick),this.addItemTapE(this.listTab,this.onItemClick),this.addLsn(RechargeActSys.ins().patchSVIPMS,this.update),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.listTab.validateNow(),this.listTab.selectedIndex=this.selectIndex=this.getAutoIndex(),this.update(),this.updateRp();var e=Cfg.getConfig(SVIPMSConfig,this.getIdByIndex(3));this.btnRechargeAll.label=Cfg.getPayMoneyRMBByYb(e.cash)+"元秒杀"},e.prototype.getAutoIndex=function(){for(var t=0,e=RechargeActSys.ins().svipmsRechargeStates,i=0;i<e.length;i++)if(1==RechargeActSys.ins().getSVIPMSState(i)){t=i;break}return t},e.prototype.updateRp=function(t){if(!t||t.check(this.getThisDef()))for(var e=0;e<this.listTab.numElements;e++){var i=this.listTab.getElementAt(e);i&&i.updateRp()}},e.prototype.onItemClick=function(t){this.selectIndex=t.itemIndex,this.update()},e.prototype.update=function(){var t=this.getIdByIndex(this.selectIndex),e=Cfg.getConfig(SVIPMSConfig,t);this.imgBox.source="yyms_zycs_box"+t,this.listAwardArr.source=GFunc.getItemDataRewardByJob(e.rewards),this.labelYuanjia.text="原价"+Cfg.getConfig(PayMoneyConfig,e.cash).yuanjia+"元",this.imgBoxName.source="svipms_zycs_s"+t;var i=this.btnRecharges[this.selectIndex];i.label=Cfg.getPayMoneyRMBByYb(e.cash)+"元秒杀",this.updateBtnState()},e.prototype.updateBtnState=function(){this.btnLeft.visible=this.selectIndex>0,this.btnRight.visible=this.selectIndex<this.listTabArr.length-1,this.btnRecharge0.visible=0==this.selectIndex,this.btnRecharge1.visible=1==this.selectIndex,this.btnRecharge2.visible=2==this.selectIndex;var t=RechargeActSys.ins().getSVIPMSState(this.selectIndex);this.groupRechargeBtn.visible=0==t,this.btnGet.visible=1==t,this.imgYLQ.visible=2==t;var e=RechargeActSys.ins().isSVIPMSBuyAll();this.btnRechargeAll.visible=!e,this.labelYGMAll.visible=e},e.prototype.getIdByIndex=function(t){return t+1},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLeft:this.selectIndex>0&&this.selectIndex--,this.listTab.selectedIndex=this.selectIndex,this.update();break;case this.btnRight:this.selectIndex<this.listTabArr.length-1&&this.selectIndex++,this.listTab.selectedIndex=this.selectIndex,this.update();break;case this.btnRecharge0:case this.btnRecharge1:case this.btnRecharge2:case this.btnRechargeAll:var e=this.btnRecharges.indexOf(t.currentTarget),i=this.getIdByIndex(e),n=Cfg.getConfig(SVIPMSConfig,i);if(Actor.ins().sVipLv>=n.sviplv)VipSys.ins().showReCharge(n.cash);else{var a=new PopupData("购买礼包需要SVIP"+n.sviplv+",是否前往提升SVIP？");a.setFunction(this,function(){openWin(VipWin,1)}),openWin(CommonTipsWin2,a)}break;case this.btnGet:var o=this.getIdByIndex(this.selectIndex);RechargeActSys.ins().sendSVIPMS(o)}},e.getTitle=function(){return"btz_zycs_svipms"},e.getTabTitle=function(){return"bqz_zycs_svipms"},e}(BasePanel);__reflect(SVIPMSPanel.prototype,"SVIPMSPanel"),window.SVIPMSPanel=SVIPMSPanel;var SVIPMSTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SVIPMSTabItemEUI",e.mcSelect=new MC,e.mcSelect.playFile(ResMgr.getEffName("yyms1"),-1),e.mcSelect.scaleX=e.mcSelect.scaleY=.4,e.groupSelect.addChild(e.mcSelect),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source="yyms_zycs_box"+t.id,this.imgYB.source="svipms_zycs_b"+t.id,this.updateRp()},e.prototype.updateRp=function(){this.redPoint.visible=RpSys.ins().getData(SVIPMSWin,SVIPMSPanel,this.itemIndex)},e}(BaseItemRender);__reflect(SVIPMSTabItem.prototype,"SVIPMSTabItem"),window.SVIPMSTabItem=SVIPMSTabItem;var SVIPMSWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[SVIPMSPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(SVIPMSWin.prototype,"SVIPMSWin"),window.SVIPMSWin=SVIPMSWin;var XunZhangActTipsWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="ZhaoCaiLongActTipsWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.mc=new MC,this.groupEntity.addChild(this.mc),this.imgTitle.source="zlxz_zycs_msz2"},e.prototype.open=function(){t.prototype.open.call(this),this.mc.playFile(ResMgr.getEffName("zlxz_zycs_xz"),-1)},e}(BaseWin);__reflect(XunZhangActTipsWin.prototype,"XunZhangActTipsWin"),window.XunZhangActTipsWin=XunZhangActTipsWin;var XunZhangBuyWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="XunZhangBuyWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.btnReceive.redPoint.visible=!0,this.listArray=new eui.ArrayCollection,this.list.itemRenderer=ItemBaseRewardEvent,this.list.dataProvider=this.listArray,this.mc=new MC,this.entityGroup.addChild(this.mc)},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RechargePowerSys.ins().patchXunZhangBuy,this.updatePanel),this.addClickE(this.btnBuy,this.onClick),this.addClickE(this.btnReceive,this.onClick),this.addItemTapE(this.list,this.onlistItemClick),this.mc.playFile(ResMgr.getEffName("zlxz_zycs_xz"),-1),this.updatePanel()},e.prototype.updatePanel=function(){var t=RechargePowerSys.ins().xunZhangData,e=Cfg.getConfig(RechagePowerConstConfig);this.listArray.source=e.zlxzreward;var i=Cfg.getPayMoneyRMBByYb(Cfg.getConfig(RechagePowerConstConfig).zlxzbuycount);this.btnBuy.label="投资"+i+"元",this.lbDesc.text=""+e.zlxzmoshi,this.currentState=0==t.buyState?"buy":"receive"},e.prototype.onlistItemClick=function(t){var e=t.itemRenderer,i=e.data;i.id==GConst.ZLXZID?(openWin(XunZhangWin),t.stopImmediatePropagation()):GFunc.openItemTips(i)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnBuy:VipSys.ins().showReCharge(Cfg.getConfig(RechagePowerConstConfig).zlxzbuycount);break;case this.btnReceive:RechargePowerSys.ins().sendXunZhangBuy(),closeWin(this)}},e}(BaseWin);__reflect(XunZhangBuyWin.prototype,"XunZhangBuyWin"),window.XunZhangBuyWin=XunZhangBuyWin;var XunZhangWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="XunZhangWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.setSkinPart("itemIcon",new ItemBaseReward),this.listArray=new eui.ArrayCollection,this.list.itemRenderer=XunZhangWinItem,this.list.dataProvider=this.listArray,this.lbTuJin.textFlow=addColorTF(StrUtil.addUnderLine("获取途径"))},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(RechargePowerSys.ins().patchXunZhangReceive,this.updatePanel),this.addLsn(RechargePowerSys.ins().patchXunZhangBuy,this.updatePanel),this.addClickE(this.btnOneKey,this.onClick),this.addClickE(this.lbTuJin,this.onClick);var e=Cfg.getConfig(RechagePowerConstConfig),i=Cfg.getItemCfg(e.zlxzItem.id);this.itemIcon.data=e.zlxzItem,this.lbName.text=i.getName(),this.lbName.textColor=GConst.PZColor[i.quality],this.updatePanel(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(null==t||t.check(e))&&(this.btnOneKey.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,e))},e.prototype.updatePanel=function(){var t=RechargePowerSys.ins().xunZhangData,e=t.xunZhangItemData.concat();this.listArray.replaceAll(e),this.list.validateNow(),this.lbdescAct.textFlow=addColorTF(""+(t.isAct()?"已激活":"未激活")),this.lbPower.text=""+t.getPower(),this.lbTuJin.visible=!RechargePowerSys.ins().xunZhangData.isAct(),this.currentState=t.isReceivaAll()?"max":"normal",this.AotuSelect()},e.prototype.AotuSelect=function(){var t=RechargePowerSys.ins().xunZhangData,e=t.getReceiveIndex();if(e>3){var i=this.list.getChildAt(e-3);i.y>this.scrollBar.viewport.contentHeight-444?this.scrollBar.viewport.scrollV=this.scrollBar.viewport.contentHeight-444:this.scrollBar.viewport.scrollV=i.y}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOneKey:var e=RechargePowerSys.ins().xunZhangData;RechargePowerSys.ins().xunZhangData.isAct()?e.canReceiva()?RechargePowerSys.ins().sendXunZhangReceive():showtipsFail("未达到转生条件"):RechargeActSys.ins().firstRechargeData.isRecharge()?(openWin(XunZhangBuyWin),0==RechargePowerSys.ins().xunZhangData.buyState&&VipSys.ins().showReCharge(Cfg.getConfig(RechagePowerConstConfig).zlxzbuycount)):openWin(FirstRechargeBuyWin);break;case this.lbTuJin:RechargeActSys.ins().firstRechargeData.isRecharge()?openWin(XunZhangBuyWin):openWin(FirstRechargeBuyWin)}},e.openCheck=function(){return GFunc.checkSysOpen(SysId.XunZhang)},e}(BaseWinSingle);__reflect(XunZhangWin.prototype,"XunZhangWin"),window.XunZhangWin=XunZhangWin;var XunZhangWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunZhangWinItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lbPower.text="",this.lbDesc.textFlow=addColorTF(t.config.desc),t.isReceive?this.currentState="get":t.canGet()?this.currentState="act":this.currentState="noact"},e}(BaseItemRender);__reflect(XunZhangWinItem.prototype,"XunZhangWinItem"),window.XunZhangWinItem=XunZhangWinItem;var XunZhangData=function(){function t(){this.buyState=0,this.xunZhangItemData=[]}return t.prototype.iniData=function(){var t=Cfg.getConfigs(ZLXZConfig,CondType.NONE);for(var e in t){var i=t[e],n=new XunZhangItemData;n.id=i.id,this.xunZhangItemData.push(n)}},t.prototype.isAct=function(){return 2==this.buyState&&!urlParam.isShenhe},t.prototype.canGet=function(){return 1==this.buyState},t.prototype.isPayMoney=function(){return this.buyState>0},t.prototype.parser=function(t){var e=t.readByte(),i=t.readShort();this.setReceiveId(i),this.setBuyState(e)},t.prototype.setBuyState=function(t){this.buyState=t;for(var e=0;e<this.xunZhangItemData.length;e++){var i=this.xunZhangItemData[e];i.buyState=t}},t.prototype.setReceiveId=function(t){for(var e=0;e<this.xunZhangItemData.length;e++){var i=this.xunZhangItemData[e];i.isReceive=t>=i.id?!0:!1}},t.prototype.canReceiva=function(){if(this.buyState>0)for(var t=0;t<this.xunZhangItemData.length;t++){var e=this.xunZhangItemData[t];if(e.canGet())return!0}return!1},t.prototype.isReceivaAll=function(){for(var t=0;t<this.xunZhangItemData.length;t++){var e=this.xunZhangItemData[t];if(0==e.isReceive)return!1}return!0},t.prototype.getPower=function(){for(var t=0,e=0;e<this.xunZhangItemData.length;e++){var i=this.xunZhangItemData[e];i.isReceive&&(t=i.config.power)}return this.xunZhangItemData[this.xunZhangItemData.length-1].config.power-t},t.prototype.getReceiveIndex=function(){for(var t=0,e=0;e<this.xunZhangItemData.length;e++){var i=this.xunZhangItemData[e];if(0==i.isReceive){t=e;break}}return t},t}();__reflect(XunZhangData.prototype,"XunZhangData");var XunZhangItemData=function(){function t(){this.id=0,this.isReceive=!1,this.buyState=0}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(ZLXZConfig,this.id))},enumerable:!0,configurable:!0}),t.prototype.canGet=function(){return this.config.buyAct?0==this.isReceive&&2==this.buyState:0==this.isReceive&&Actor.ins().zsId>=this.config.zhuansheng},t.prototype.setBuyState=function(t){this.buyState=t},Object.defineProperty(t.prototype,"sort",{get:function(){return this.isReceive?0:this.canGet()?2:1},enumerable:!0,configurable:!0}),t}();__reflect(XunZhangItemData.prototype,"XunZhangItemData");var RechargeYiYuanData=function(){function t(){this.state=0,this.firstRechargeTimer=0}return t.prototype.patch=function(t){this.state=t.readByte();var e=t.readInt();this.firstRechargeTimer=Timer.ins().getTimer()+1e3*e},t.prototype.getFirstRechargeTimer=function(){return Math.max(0,this.firstRechargeTimer-Timer.ins().getTimer())},t.prototype.canReceived=function(){return 1==this.state},t.prototype.isOpen=function(){return this.getFirstRechargeTimer()>0&&2!=this.state},t}();__reflect(RechargeYiYuanData.prototype,"RechargeYiYuanData");var RechargeYiYuanWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listAward.itemRenderer=ItemBaseReward,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.listAwardArr.source=Cfg.getConfig(RechargeConstConfig).yyqgrewards,this.addBg()},e.prototype.setSkinName=function(){this.skinName="RechargeYiYuanWinEUI"},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnBuy,this.onClick),this.addClickE(this.btnReceived,this.onClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(RechargeActSys.ins().patchYiYuanData,this.update),this.addLsn(RechargeActSys.ins().patchYiYuanReceived,this.update),this.update(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(e))&&(this.btnReceived.redPoint.visible=RpSys.ins().getData(ExtCom,e))},e.prototype.update=function(){var t=RechargeActSys.ins().rechargeYiYuanData;this.btnBuy.label=Cfg.getPayMoneyRMBByYb(Cfg.getConfig(RechargeConstConfig).yyqgyuanbao)+"元抢购",0==t.state?this.currentState="buy":1==t.state?this.currentState="received":this.currentState="yiReceived"},e.prototype.updateTime=function(){var t=RechargeActSys.ins().rechargeYiYuanData,e=t.getFirstRechargeTimer()/1e3,i=DateUtil.isDayTime(1e3*e)?"dd天hh小时mm分钟":"hh小时mm分钟ss秒";this.lbTimer.textFlow=addColorTF("活动倒计时:"+addColor(getFormatTime(e,i),5373822))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnBuy:Actor.ins().sVipLv>=Cfg.getConfig(RechargeConstConfig).yyqgvip?VipSys.ins().showReCharge(Cfg.getConfig(RechargeConstConfig).yyqgyuanbao):(showtipsFail("SVIP等级不足，无法购买"),openWin(FirstRechargeBuyWin));break;case this.btnReceived:RechargeActSys.ins().sendYiYuanReceived()}},e.getSysId=function(){return SysId.YYQG},e}(BaseWinSingle);__reflect(RechargeYiYuanWin.prototype,"RechargeYiYuanWin"),window.RechargeYiYuanWin=RechargeYiYuanWin;var ZeroBuyData=function(){function t(){this.id=1,this.state=0,this.endTick=0}return t.prototype.parser=function(t){this.state=t.readByte();var e=t.readInt();this.endTick=Timer.ins().getEgretTimer()+1e3*e},Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(ZeroBuyConfig,this.id))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftTime",{get:function(){return Math.max((this.endTick-Timer.ins().getEgretTimer())/1e3,0)},enumerable:!0,configurable:!0}),t.prototype.isBuy=function(){return 1==this.state},t.prototype.hasGetAward=function(){return 2==this.state},t.prototype.isNotBuy=function(){return 0==this.state},t.prototype.isConsumeEnough=function(){return Actor.ins().getCurrency(CurType.JinZuan)>=this.config.need},t.prototype.canGetAward=function(){return this.isBuy()&&0==this.leftTime},t}();__reflect(ZeroBuyData.prototype,"ZeroBuyData");var ZeroBuyWin=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ZeroBuyWinEUI",this.layer=LayerMgr.Popup,t.prototype.initUI.call(this),this.tabType.dataProvider=new eui.ArrayCollection([{source:"lyg_zycs_yjlb"},{source:"lyg_zycs_fhlb"},{source:"lyg_zycs_jbsz"}]),this.listAward.itemRenderer=ItemBaseReward,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.setSkinPart("item",new ItemBaseReward),this.addBg()},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnBuy,this.onClick),this.addClickE(this.btnGet,this.onClick),this.addItemTapE(this.tabType,this.onItemClick),this.addLsn(RechargeActSys.ins().patchsendZeroBuyBuy,this.updateBtnState),this.addLsn(RechargeActSys.ins().patchZeroBuyGetAward,this.updateBtnState),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.tabType.selectedIndex=this.selectIndex=this.getAutoIndex(),this.update(),this.updateRp()},e.prototype.getAutoIndex=function(){for(var t=0,e=RechargeActSys.ins().zeroBuyDatas,i=0;i<e.length;i++)if(e[i].canGetAward()){t=i;break}return t},e.prototype.updateTime=function(t){void 0===t&&(t=0);var e=RechargeActSys.ins().getZeroBuyData(this.curId),i=e.leftTime;i&&(this.labelDesc.text=DateUtil.formatTime(1e3*i,"dd天hh小时mm分钟ss秒")+"后可领取仙券")},e.prototype.updateRp=function(t){if(!t||t.check(this.getThisDef())){this.tabType.validateNow();for(var i=0;i<this.tabType.numElements;i++){var n=this.tabType.getElementAt(i);n&&(n.redPoint.visible=RpSys.ins().getData(ExtCom,e,RechargeActSys.ins().zeroBuyDatas[i].id))}this.updateBtnRp(t)}},e.prototype.updateBtnRp=function(t){(!t||t.check(this.getThisDef()))&&(this.btnBuy.redPoint.visible=RpSys.ins().getData(ExtCom,e,this.curId,"buy"))},e.prototype.onItemClick=function(t){this.selectIndex!=t.itemIndex&&(this.selectIndex=t.itemIndex,this.update())},e.prototype.update=function(){var t=Cfg.getConfig(ZeroBuyConfig,this.curId);this.listAwardArr.source=t.item,this.item.data=GFunc.creatRewardDataById(CurType.JinZuan,t.need),this.imgJZ.source="lyg_zycs_"+(this.curId+3),this.imgName.source="lyg_zycs_msz"+this.curId,this.imgDay.source="lyg_zycs_"+this.curId,this.labelPrice.text=t.need.toString(),this.labelPrice.textColor=Actor.ins().getCurrency(CurType.JinZuan)>=t.need?5767068:16773538,this.bitPower.text=t.power.toString(),this.updateBtnState()},e.prototype.updateBtnState=function(){var t=RechargeActSys.ins().getZeroBuyData(this.curId);this.groupDesc.visible=this.btnBuy.visible=t.isNotBuy(),this.labelTips.text="第"+t.config.returnday+"天登录可以领取",this.imgYGM.visible=!t.isNotBuy(),this.labelDesc.visible=!t.isNotBuy()&&t.leftTime>0,this.btnGet.visible=t.canGetAward(),this.imgYLQ.visible=t.hasGetAward(),this.updateBtnRp(),this.updateTime()},Object.defineProperty(e.prototype,"curId",{get:function(){return this.selectIndex+1},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnGet:var e=RechargeActSys.ins().getZeroBuyData(this.curId);e.isBuy()&&RechargeActSys.ins().sendZeroBuyGetAward(this.curId);break;case this.btnBuy:var e=RechargeActSys.ins().getZeroBuyData(this.curId);e.isNotBuy()&&GFunc.checkCurrency(CurType.JinZuan,e.config.need)&&RechargeActSys.ins().sendZeroBuyBuy(this.curId)}},e}(BaseWinSingle);__reflect(ZeroBuyWin.prototype,"ZeroBuyWin"),window.ZeroBuyWin=ZeroBuyWin;var ZhaoCaiLongActTipsWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="ZhaoCaiLongActTipsWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.mc=new MC,this.groupEntity.addChild(this.mc),this.imgTitle.source="hjsl_zycs_msz3"},e.prototype.open=function(){t.prototype.open.call(this),this.mc.playFile(ResMgr.getEffName("hjyl"),-1)},e}(BaseWin);__reflect(ZhaoCaiLongActTipsWin.prototype,"ZhaoCaiLongActTipsWin"),window.ZhaoCaiLongActTipsWin=ZhaoCaiLongActTipsWin;var ZhaoCaiLongBuyWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="ZhaoCaiLongBuyWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.btnReceive.redPoint.visible=!0,this.listArray=new eui.ArrayCollection,this.list.itemRenderer=ItemBaseRewardEvent,this.list.dataProvider=this.listArray,this.mc=new MC,this.entityGroup.addChild(this.mc)},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RechargePowerSys.ins().patchhaoCaiLongBuy,this.updatePanel),this.addClickE(this.btnBuy,this.onClick),this.addClickE(this.btnReceive,this.onClick),this.addItemTapE(this.list,this.onlistItemClick),this.mc.playFile(ResMgr.getEffName("hjyl"),-1),this.updatePanel()},e.prototype.updatePanel=function(){var t=RechargePowerSys.ins().zhaoCaiLongData,e=Cfg.getConfig(RechagePowerConstConfig);
this.listArray.source=e.zclreward,this.btnBuy.label="投资"+Cfg.getPayMoneyRMBByYb(e.zclbuycount)+"元",this.lbDesc.text=""+e.zclmoshi,this.currentState=0==t.buyState?"buy":"receive"},e.prototype.onlistItemClick=function(t){var e=t.itemRenderer,i=e.data;i.id==GConst.ZCMID?(openWin(ZhaoCaiLongWin),t.stopImmediatePropagation()):GFunc.openItemTips(i)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnBuy:VipSys.ins().showReCharge(Cfg.getConfig(RechagePowerConstConfig).zclbuycount);break;case this.btnReceive:RechargePowerSys.ins().sendhaoCaiLongBuy(),closeWin(this)}},e}(BaseWin);__reflect(ZhaoCaiLongBuyWin.prototype,"ZhaoCaiLongBuyWin"),window.ZhaoCaiLongBuyWin=ZhaoCaiLongBuyWin;var ZhaoCaiLongWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="ZhaoCaiLongWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.setSkinPart("itemIcon",new ItemBaseReward),this.listArray=new eui.ArrayCollection,this.list.itemRenderer=ZhaoCaiLongWinItem,this.list.dataProvider=this.listArray,this.lbTuJin.textFlow=addColorTF(StrUtil.addUnderLine("获取途径"))},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(RechargePowerSys.ins().patchhaoCaiLongReceive,this.updatePanel),this.addLsn(RechargePowerSys.ins().patchhaoCaiLongBuy,this.updatePanel),this.addClickE(this.btnOneKey,this.onClick),this.addClickE(this.lbTuJin,this.onClick);var e=Cfg.getConfig(RechagePowerConstConfig),i=Cfg.getItemCfg(e.zclItem.id);this.itemIcon.data=e.zclItem,this.lbName.text=i.getName(),this.lbName.textColor=GConst.PZColor[i.quality],this.lbDesc.textFlow=addColorTF("购买招财猫可获得"+e.zclpower+"战斗力"),this.updatePanel(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(null==t||t.check(e))&&(this.btnOneKey.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,e))},e.prototype.updatePanel=function(){var t=RechargePowerSys.ins().zhaoCaiLongData,e=t.zhaoCaiLongItemDatas.concat();t.getReceiveIndex();this.listArray.replaceAll(e),this.list.validateNow(),this.lbdescAct.textFlow=addColorTF(""+(t.isAct()?"已激活":"未激活")),this.lbyb.text=""+t.getYb(),this.lbTuJin.visible=!RechargePowerSys.ins().zhaoCaiLongData.isAct(),this.currentState=t.isReceivaAll()?"max":"normal",this.AotuSelect()},e.prototype.AotuSelect=function(){var t=RechargePowerSys.ins().zhaoCaiLongData,e=t.getReceiveIndex();if(e>3){var i=this.list.getChildAt(e-3);i.y>this.scrollBar.viewport.contentHeight-444?this.scrollBar.viewport.scrollV=this.scrollBar.viewport.contentHeight-444:this.scrollBar.viewport.scrollV=i.y}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOneKey:var e=RechargePowerSys.ins().zhaoCaiLongData;RechargePowerSys.ins().zhaoCaiLongData.isAct()?e.canReceiva()?RechargePowerSys.ins().sendhaoCaiLongReceive():showtipsFail("未达到转生条件"):RechargeActSys.ins().firstRechargeData.isRecharge()?(openWin(ZhaoCaiLongBuyWin),0==RechargePowerSys.ins().zhaoCaiLongData.buyState&&VipSys.ins().showReCharge(Cfg.getConfig(RechagePowerConstConfig).zclbuycount)):openWin(FirstRechargeBuyWin);break;case this.lbTuJin:RechargeActSys.ins().firstRechargeData.isRecharge()?openWin(ZhaoCaiLongBuyWin):openWin(FirstRechargeBuyWin)}},e.openCheck=function(){return GFunc.checkSysOpen(SysId.ZhaoCaiLong)},e}(BaseWinSingle);__reflect(ZhaoCaiLongWin.prototype,"ZhaoCaiLongWin"),window.ZhaoCaiLongWin=ZhaoCaiLongWin;var ZhaoCaiLongWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhaoCaiLongWinItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lbYb.text=t.config.yuanbao.toString(),this.lbDesc.textFlow=addColorTF("转生达到"+GFunc.getZSNameBydb(t.config.zhuansheng)+"可获得"),t.isReceive?this.currentState="get":t.canGet()?this.currentState="act":this.currentState="noact"},e}(BaseItemRender);__reflect(ZhaoCaiLongWinItem.prototype,"ZhaoCaiLongWinItem"),window.ZhaoCaiLongWinItem=ZhaoCaiLongWinItem;var ZhaoCaiLongData=function(){function t(){this.buyState=0,this.zhaoCaiLongItemDatas=[]}return t.prototype.iniData=function(){var t=Cfg.getConfigs(ZCLConfig,CondType.NONE);for(var e in t){var i=t[e],n=new ZhaoCaiLongItemData;n.id=i.id,this.zhaoCaiLongItemDatas.push(n)}},t.prototype.noBuy=function(){return 0==this.buyState},t.prototype.isBuy=function(){return this.buyState>0},t.prototype.isAct=function(){return 2==this.buyState},t.prototype.canGet=function(){return 1==this.buyState},t.prototype.parser=function(t){this.buyState=t.readByte();var e=t.readShort();this.setReceiveId(e)},t.prototype.setBuyState=function(t){this.buyState=t},t.prototype.setReceiveId=function(t){for(var e=0;e<this.zhaoCaiLongItemDatas.length;e++){var i=this.zhaoCaiLongItemDatas[e];i.isReceive=t>=i.id?!0:!1}},t.prototype.canReceiva=function(){if(this.buyState>0)for(var t=0;t<this.zhaoCaiLongItemDatas.length;t++){var e=this.zhaoCaiLongItemDatas[t];if(e.canGet())return!0}return!1},t.prototype.isReceivaAll=function(){for(var t=0;t<this.zhaoCaiLongItemDatas.length;t++){var e=this.zhaoCaiLongItemDatas[t];if(0==e.isReceive)return!1}return!0},t.prototype.getYb=function(){for(var t=0,e=0;e<this.zhaoCaiLongItemDatas.length;e++){var i=this.zhaoCaiLongItemDatas[e];0==i.isReceive&&(t+=i.config.yuanbao)}return t},t.prototype.getReceiveIndex=function(){for(var t=0,e=0;e<this.zhaoCaiLongItemDatas.length;e++){var i=this.zhaoCaiLongItemDatas[e];if(0==i.isReceive){t=e;break}}return t},t}();__reflect(ZhaoCaiLongData.prototype,"ZhaoCaiLongData");var ZhaoCaiLongItemData=function(){function t(){this.id=0,this.isReceive=!1}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(ZCLConfig,this.id))},enumerable:!0,configurable:!0}),t.prototype.canGet=function(){return 0==this.isReceive&&Actor.ins().zsId>=this.config.zhuansheng},Object.defineProperty(t.prototype,"sort",{get:function(){return this.isReceive?0:this.canGet()?2:1},enumerable:!0,configurable:!0}),t}();__reflect(ZhaoCaiLongItemData.prototype,"ZhaoCaiLongItemData");var ErrorWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Top,e.winType=WinType.NormalWin,e.index=0,e.errorAtrList=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isLog=!1,this.skinName="ErrorWinSkin"},e.prototype.open=function(e,i){void 0===e&&(e=""),void 0===i&&(i=0),t.prototype.open.call(this),this.addClickE(this,this.onClick);var n=new ErrorStrData;n.errorstr=e,n.type=i,this.errorAtrList.push(n),this.updateDesc()},e.prototype.close=function(){t.prototype.close.call(this),this.index=0,this.errorAtrList.length=0},e.prototype.updateDesc=function(){var t=this.errorAtrList[this.index];0==t.type?this.labelTitle.text="客户端异常":1==t.type&&(this.labelTitle.text="服务器异常"),this.labelContent.textFlow=addColorTF(t.errorstr),this.lbCount.text=this.index+1+"/"+this.errorAtrList.length},e.prototype.onClick=function(t){switch(t.target){case this.btnLeft:0==this.index?showtipsFail("当前在第一页"):(this.index--,this.updateDesc());break;case this.btnRight:this.index==this.errorAtrList.length-1?showtipsFail("当前在最后一页"):(this.index++,this.updateDesc());break;case this.btnCopy:ComUtil.copyResult(this.labelContent.text),showtipsSuc("复制成功")}},e}(BaseWinSingle);__reflect(ErrorWin.prototype,"ErrorWin"),window.ErrorWin=ErrorWin;var ErrorStrData=function(){function t(){this.type=0}return t}();__reflect(ErrorStrData.prototype,"ErrorStrData");var DaZaoSys=function(t){function e(){var e=t.call(this)||this;return e.sysId=PackId.Equip,e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,EquipSys)},e}(BaseSys);__reflect(DaZaoSys.prototype,"DaZaoSys"),SystemMap.DaZaoSys=DaZaoSys.ins.bind(DaZaoSys),window.DaZaoSys=DaZaoSys;var EquipSys=function(t){function e(){var e=t.call(this)||this;e.hufudata=[],e.roleZhuoYueCounts=[],e.daZaoTabDatas=[],e.sysId=PackId.Equip,e.reg(1,e.doUpDataEquip),e.reg(2,e.patchSmeltEquipComplete),e.reg(3,e.patchHuFuUpdate),e.reg(4,e.patchEquipList),e.reg(5,e.patchRongLianData),e.reg(6,e.patchOneKeyEquip),e.reg(10,e.patchDaZaoEquip),e.reg(11,e.patchDaZaoRingUpStar),e.reg(12,e.patchDaZaoRingUpRank),e.reg(13,e.patchDaZaoFenJie);for(var i=0;3>i;i++)e.hufudata[i]=new EquipsData,e.hufudata[i].equipPos=EquipPos.Hufu;var n=Cfg.getConfigs(DazaoEquipConfig,CondType.NONE);for(var a in n){var o=n[a],s=new DaZaoTabData;s.tabName=GFunc.getChineseNum(Number(a))+"星装备";for(var r in o){var u=o[r],h=new DaZaoTabEqupData;h.config=u,h.parentTabName=s.tabName,h.iniData(),s.daZaoTabSubDatas.push(h)}e.daZaoTabDatas.push(s)}var p=new DaZaoTabData;p.tabName="仙戒魔戒";var l=new DaZaoTabGodRingStageData;l.pos=EquipPos.RING1,l.parentTabName=p.tabName,p.daZaoTabSubDatas.push(l);var c=new DaZaoTabMoRingStageData;c.pos=EquipPos.RING2,c.parentTabName=p.tabName,p.daZaoTabSubDatas.push(c);var d=new DaZaoTabGodRingStarData;d.pos=EquipPos.RING1,d.parentTabName=p.tabName,p.daZaoTabSubDatas.push(d);var g=new DaZaoTabMoRingStarData;g.pos=EquipPos.RING2,g.parentTabName=p.tabName,p.daZaoTabSubDatas.push(g),e.daZaoTabDatas.push(p);var y=Cfg.getConfigs(DazaoFootEquipConfig),f=new DaZaoTabData;f.tabName="足迹铭文";for(var i=0;i<y.length;i++){var o=y[i],m=y[i],v=getDefinitionByName("DaZaoTabFootEqupData"+o.viewType),h=new v;h.config=m,h.parentTabName=f.tabName,h.iniData(),f.daZaoTabSubDatas.push(h)}e.daZaoTabDatas.push(f);var S=new DaZaoTabData;S.tabName="分解";for(var i=1;5>i;i++){var C=new DaZaoFenJieEquipData;C.star=i,C.parentTabName=S.tabName,S.daZaoTabSubDatas.push(C)}return e.daZaoTabDatas.push(S),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},Object.defineProperty(e.prototype,"rongLianData",{get:function(){return null==this._rongLianData&&(this._rongLianData=new RongLianData),this._rongLianData},enumerable:!0,configurable:!0}),e.prototype.sendWearEquipment=function(t){var i=e.ins().getBytes(1);i.writeInt(t),this.send(i)},e.prototype.doUpDataEquip=function(t){BagSys.ins().doUpDataEquip(t)},e.prototype.sendSmeltEquip=function(t){for(var i=e.ins().getBytes(2),n=0,a=0;a<t.length;a++)null!=t[a]&&n++;i.writeShort(n);for(var a=0;a<t.length;a++)null!=t[a]&&i.writeDouble(t[a].handle);this.send(i)},e.prototype.patchSmeltEquipComplete=function(t){for(var e=t.readByte(),i=[],n=0;e>n;n++){var a=new ItemDataReward;a.parser2(t),i.push(a)}this.rongLianData.level=t.readInt(),this.rongLianData.exp=t.readInt();var o=new RongLianRewearData;return o.itemRewear=i,0==e&&showtipsSuc("已自动熔炼多余装备"),o},e.prototype.sendHuFuOpen=function(t){var e=this.getBytes(3);e.writeShort(t),this.send(e)},e.prototype.patchHuFuUpdate=function(t){BagSys.ins().doUpDataEquip(t)},e.prototype.patchEquipList=function(t){BagSys.ins().patchEquipList(t),RpFun.showDaZaoEquipRedPoint()},e.prototype.patchRongLianData=function(t){this.rongLianData.level=t.readInt(),this.rongLianData.exp=t.readInt()},e.prototype.sendOneKeyEquip=function(t){var e=this.getBytes(6);e.writeByte(t.length);for(var i=0;i<t.length;i++)e.writeInt(t[i]);this.send(e)},e.prototype.patchOneKeyEquip=function(t){BagSys.ins().patchOneKeyEquip(t)},e.prototype.gethufu=function(t){return this.hufudata[t]},e.prototype.sendDaZaoEquip=function(t,e){void 0===e&&(e=[]);var i=this.getBytes(10);i.writeInt(t),i.writeByte(e.length);for(var n=0;n<e.length;n++)i.writeDouble(e[n]);this.send(i)},e.prototype.patchDaZaoEquip=function(t){var e=t.readInt();openWin(DaZaoSuccessTipsWin,e)},e.prototype.sendDaZaoRingUpStar=function(t){var e=this.getBytes(11);e.writeByte(t),this.send(e)},e.prototype.patchDaZaoRingUpStar=function(t){var e=t.readInt();BagSys.ins().getEquipByIndex(Cfg.getItemCfg(e).subType).updateEquipId(e),openWin(DaZaoSuccessTipsWin,e),RpFun.showDaZaoEquipRedPoint()},e.prototype.sendDaZaoRingUpRank=function(t){var e=this.getBytes(12);e.writeByte(t),this.send(e)},e.prototype.patchDaZaoRingUpRank=function(t){var e=t.readInt();BagSys.ins().getEquipByIndex(Cfg.getItemCfg(e).subType).updateEquipId(e),openWin(DaZaoSuccessTipsWin,e),RpFun.showDaZaoEquipRedPoint()},e.prototype.sendDaZaoFenJie=function(t){var e=this.getBytes(13),i=t.length;e.writeByte(i);for(var n=0;i>n;n++)e.writeDouble(t[n]);this.send(e)},e.prototype.patchDaZaoFenJie=function(t){for(var e=t.readByte(),i=[],n=0;e>n;n++){var a=new ItemDataReward;a.parser2(t),i.push(a)}openWin(DaZaoFenJieSuccessTips,i)},e.prototype.patchDaZaoEquipSelect=function(t,e){return[t,e]},e.prototype.getTuiJianTabIndex=function(){for(var t=0,e=0;e<this.daZaoTabDatas.length;e++)if(this.daZaoTabDatas[e].getTuiJianSubTabIndex()>0){t=e;break}return t},e.prototype.getEquipCount=function(){for(var t=0,e=BagSys.ins().equipDatas,i=0;i<e.length;i++){var n=e[i];n.hasEquipOn()&&t++}return t},e.prototype.getEquipAddLevelCouontByLevel=function(t){for(var e=0,i=BagSys.ins().equipDatas,n=0;n<i.length;n++){var a=i[n];a.addlv>=t&&e++}return e},e.prototype.getMinAddLevelPos=function(){for(var t=BagSys.ins().getStrengthenEquipsByRoleIndex(),e=0,i=t[0].strengthen,n=0;n<t.length;n++){var a=t[n];a&&a.hasEquipOn()&&i>a.addlv&&(i=a.addlv,e=n)}return e},e}(BaseSys);__reflect(EquipSys.prototype,"EquipSys"),SystemMap.EquipSys=EquipSys.ins.bind(EquipSys),window.EquipSys=EquipSys;var RoleEditorNameWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.skinName="RoleEditorNameWinEUI",this.addBg(),this.textInput.textDisplay.textAlign=egret.HorizontalAlign.LEFT},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnOk,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOk:var e=this.textInput.text;""==e?showtipsFail(Lang.gmk_str3):e.length>7?showtipsFail(Lang.gmk_str8):LogicSys.ins().sendRename(e)}},e}(BaseWinSingle);__reflect(RoleEditorNameWin.prototype,"RoleEditorNameWin"),window.RoleEditorNameWin=RoleEditorNameWin;var DaZaoEquipConsumeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoEquipConsumeItemEUI",e.setSkinPart("itemTarget",new ItemBase),e.itemTarget.touchEnabled=!1,e.itemTarget.touchChildren=!1,e.imgPlus.visible=!0,e.itemTarget.visible=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.createClickSprite()},e.prototype.createClickSprite=function(){},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;e?(this.itemTarget.data=e,this.itemTarget.visible=!0,this.imgPlus.visible=!1):(this.imgPlus.visible=!0,this.itemTarget.visible=!1)},e}(BaseItemRender);__reflect(DaZaoEquipConsumeItem.prototype,"DaZaoEquipConsumeItem"),window.DaZaoEquipConsumeItem=DaZaoEquipConsumeItem;var DaZaoEquipItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoEquipItemEUI",e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){var e=t.cfg;e?(this.imgPlus.visible=!1,this.imgIcon.source=ResMgr.getItemIcon(e.getIcon(),IconType.IT_80x80),this.setStar(e.star),this.setRank(ItemType.isShowRank(e.type)?e.rank:0),this.imgEquipBg.source=ResMgr.getEquipQualityBg(e.quality),e.quality>=QualityType.Green?this.mc.playFile(ResMgr.getEquipEffResource(e.quality),-1):(this.mc.visible=!1,this.mc.stop())):(this.imgEquipBg.source=ResMgr.getEquipDefaultIcon(t.equipPos),this.clear())}else this.clear()},e.prototype.clear=function(){this.setStar(0),this.setRank(0),this.imgIcon.source="",this.imgPlus.visible=!0,this.mc.visible=!1,this.mc.stop()},e.prototype.setRank=function(t){this.bitlbRank.text=t>0?t+"r":""},e.prototype.setStar=function(t){this.groupStart.removeChildren();for(var e=0;t>e;e++){var i=new eui.Image;i.source="role_zycs_star",i.touchEnabled=!1,this.groupStart.addChild(i)}this.imgStarBg.visible=t>0},e}(BaseItemRender);__reflect(DaZaoEquipItem.prototype,"DaZaoEquipItem"),window.DaZaoEquipItem=DaZaoEquipItem;var RankDataJJC=function(t){function e(){var e=t.call(this)||this;return e.power=0,e.guildName="",e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.power=e.readDouble(),this.guildName=e.readString()},e}(RankData);__reflect(RankDataJJC.prototype,"RankDataJJC"),window.RankDataJJC=RankDataJJC;var DaZaoEquipPosTab=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoEquipPosTabEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lbName.text=t.tabName,this.imgTuiJian.visible=t.isTuiJian()},e}(BaseItemRender);__reflect(DaZaoEquipPosTab.prototype,"DaZaoEquipPosTab"),window.DaZaoEquipPosTab=DaZaoEquipPosTab;var DaZaoEquipSelectItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoEquipSelectPanelItemEUI",e.setSkinPart("itemTarget",new ItemBase),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.itemTarget.data=t,this.lbName.text=t.cfg.getName()},e}(BaseItemRender);__reflect(DaZaoEquipSelectItem.prototype,"DaZaoEquipSelectItem"),window.DaZaoEquipSelectItem=DaZaoEquipSelectItem;var DaZaoEquipSelectWin=function(t){function e(){var e=t.call(this)||this;return e.curIndex=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="DaZaoEquipSelectPanelEUI",this.addBg(),this.list.itemRenderer=DaZaoEquipSelectItem,this.listArray=new eui.ArrayCollection,this.list.dataProvider=this.listArray},e.prototype.open=function(e,i,n,a){void 0===a&&(a=[]),t.prototype.open.call(this),this.curIndex=e,this.addItemTapE(this.list,this.onPosListClick),this.listArray.source=a},e.prototype.onPosListClick=function(t){var e=t.itemRenderer.data;EquipSys.ins().patchDaZaoEquipSelect(this.curIndex,e),closeWin(this)},e}(BaseWin);__reflect(DaZaoEquipSelectWin.prototype,"DaZaoEquipSelectWin"),window.DaZaoEquipSelectWin=DaZaoEquipSelectWin;var DaZaoFenJiePanel=function(t){function e(){var e=t.call(this)||this;return e.selectItemDatas=[],e.maxCount=8,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="DaZaoFenJiePanelEUI",this.listBagItem.itemRenderer=DaZaoFenJieSelectItem,this.listBagItemArray=new eui.ArrayCollection,this.listBagItem.dataProvider=this.listBagItemArray,this.listSelectItem.itemRenderer=ItemBase,this.listSelectItemArray=new eui.ArrayCollection,this.listSelectItem.dataProvider=this.listSelectItemArray,this.listFenJieItem.itemRenderer=ItemBaseReward,this.listFenJieItemArray=new eui.ArrayCollection,this.listFenJieItem.dataProvider=this.listFenJieItemArray},e.prototype.open=function(t){this.data=t,this.addLsn(EquipSys.ins().patchDaZaoFenJie,this.updateFenJie),this.addClickE(this.btnSelect,this.onClick),this.addClickE(this.btnFenJie,this.onClick),this.addItemTapE(this.listBagItem,this.onlistBagItemClick),this.resetPanel(),this.updatePanel()},e.prototype.updateFenJie=function(){this.resetPanel(),this.updatePanel()},e.prototype.updatePanel=function(){var t=BagSys.ins().getEquipByQualityStar(QualityType.Red,this.data.star).concat();SortUtil.sortOn(t,["rank"],[SortType.up]),this.listBagItemArray.source=t},e.prototype.updateRp=function(t){void 0===t&&(t=null)},e.prototype.onlistBagItemClick=function(t){var e=t.itemRenderer,i=e.data;-1==this.selectItemDatas.indexOf(i)?this.selectItemDatas.length>=this.maxCount?showtipsFail("最多选择"+this.maxCount+"件装备"):(this.selectItemDatas.push(i),e.setSelect(!0)):(e.setSelect(!1),this.selectItemDatas.splice(this.selectItemDatas.indexOf(i),1)),this.updateFenJieSelect(this.selectItemDatas)},e.prototype.updateFenJieSelect=function(t){this.listSelectItemArray.source=t,this.lbSelectCount.textFlow=addColorTF("已选择的装备("+t.length+"/"+this.maxCount+")"),this.updateFenJieGetItem(t)},e.prototype.updateFenJieGetItem=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a=Cfg.getConfig(DazaoFenjieConfig,n.cfg.rank,n.cfg.star);GFunc.mergeItemDataReward(e,a.additem)}this.listFenJieItemArray.source=e},e.prototype.resetPanel=function(){this.listBagItemArray.removeAll(),this.listBagItemArray=new eui.ArrayCollection,this.listBagItem.dataProvider=this.listBagItemArray,this.selectItemDatas.length=0,this.updateFenJieSelect(this.selectItemDatas)},e.prototype.onClick=function(t){switch(t.target){case this.btnSelect:var e=this.listBagItemArray.source;if(e.length>0){for(var i=0;i<e.length;i++){var n=e[i];if(BagSys.ins().getEquipByIndex(n.cfg.subType).power>=n.power&&-1==this.selectItemDatas.indexOf(n)&&this.selectItemDatas.length<this.maxCount){this.selectItemDatas.push(n);var a=this.listBagItem.getChildAt(i);a.setSelect(!0)}}this.updateFenJieSelect(this.selectItemDatas)}else showtipsFail("无可分解装备");break;case this.btnFenJie:if(this.selectItemDatas.length>0){for(var o=[],i=0;i<this.selectItemDatas.length;i++){var n=this.selectItemDatas[i];n&&o.push(n.handle)}EquipSys.ins().sendDaZaoFenJie(o)}else showtipsFail("请选择你要分解的装备")}},e}(BasePanel);__reflect(DaZaoFenJiePanel.prototype,"DaZaoFenJiePanel"),window.DaZaoFenJiePanel=DaZaoFenJiePanel;var DaZaoFenJieSelectItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoFenJieSelectItemEUI",e.setSkinPart("itemTarget",new ItemBase),e.itemTarget.touchEnabled=!1,e.itemTarget.touchChildren=!1,e.setSelect(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.itemTarget.data=t},e.prototype.setSelect=function(t){this.imgPlus.visible=t},e}(BaseItemRender);__reflect(DaZaoFenJieSelectItem.prototype,"DaZaoFenJieSelectItem"),window.DaZaoFenJieSelectItem=DaZaoFenJieSelectItem;var DaZaoFenJieSuccessTips=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="DaZaoFenJieSuccessTipsEUI",this.addBg(),this.list.itemRenderer=ItemBaseRewardName},e.prototype.open=function(e){t.prototype.open.call(this),this.list.dataProvider=new eui.ArrayCollection(e)},e}(BaseWin);__reflect(DaZaoFenJieSuccessTips.prototype,"DaZaoFenJieSuccessTips"),window.DaZaoFenJieSuccessTips=DaZaoFenJieSuccessTips;var RankDataJLZL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getRankStr=function(){return this.power>=1e8?Lang.rank_str11+"："+GFunc.overLength(this.power,2):Lang.rank_str11+"："+GFunc.overLength(this.power)},e}(RankDataPower);__reflect(RankDataJLZL.prototype,"RankDataJLZL"),window.RankDataJLZL=RankDataJLZL;var DaZaoFootEquipPanel2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="DaZaoFootEquipPanelEUI"},e.prototype.init=function(){t.prototype.init.call(this),this.itemConsumes=[this.itemConsume0,this.itemConsume1,this.itemConsume2]},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addLsn(FootSys.ins().patchFootMiYuDaZao,this.updateDaZaoSucceed),this.addLsn(BagSys.ins().patchItemChange,this.updateItemConsume),this.updateItemConsume()},e.prototype.updatePanel=function(){t.prototype.updatePanel.call(this),this.itemConsumeCaiLiao.data=GFunc.creatRewardDataById(Cfg.getConfig(FootConstConfig).dazaoneeditem.id,0)},e.prototype.updateItemConsume=function(t){if(void 0===t&&(t=null),null==t||t.id==Cfg.getConfig(FootConstConfig).dazaoneeditem.id){var e=Cfg.getConfig(FootConstConfig).dazaoneeditem,i=BagSys.ins().getItemCount(e.id),n=i>=e.count?5767068:15733780;this.lbConsumeCaiLiao.textFlow=addColorTF(i+"/"+e.count,n)}},e.prototype.sendDaZao=function(){GFunc.checkConsumeEnough(Cfg.getConfig(FootConstConfig).dazaoneeditem)&&t.prototype.sendDaZao.call(this)},e}(DaZaoFootEquipPanel1);__reflect(DaZaoFootEquipPanel2.prototype,"DaZaoFootEquipPanel2"),window.DaZaoFootEquipPanel2=DaZaoFootEquipPanel2;var DaZaoMainPanel=function(t){function e(){var e=t.call(this)||this;return e.panels=[],e.curPanelName="",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="DaZaoMainPanelEUI",this.itemList.itemRenderer=DaZaoTabItem,this.itemListArray=new eui.ArrayCollection,this.itemList.dataProvider=this.itemListArray},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(EquipSys.ins().patchDaZaoFenJie,this.updateItem),this.addLsn(EquipSys.ins().patchDaZaoEquip,this.updateItem),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addClickE(this.itemList,this.onMenuClick),this.iniPanle()},e.prototype.close=function(){t.prototype.close.call(this),this.curItem.select(!1)},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e))for(var i=this.itemList.numElements,n=0;i>n;n++){var a=this.itemList.getElementAt(n);a&&a.updateRedPoint()}},e.prototype.updateItem=function(){for(var t=this.itemList.numElements,e=0;t>e;e++){var i=this.itemList.getElementAt(e);i&&i.updateItem()}},e.prototype.updatePanel=function(){this.itemListArray.source=EquipSys.ins().daZaoTabDatas,this.itemList.validateNow()},e.prototype.iniPanle=function(){this.updatePanel();var t=this.getDefaultTabIndex();this.curItem=this.itemList.getElementAt(t),this.curItem.select(!0);var e=this.curItem.data,i=e.getRedPointSubTabIndex(),n=-1==i?e.getTuiJianSubTabIndex():i;this.curItem.selectSubTabIndex(n,!0),this.curItemSub=this.curItem.getItemIndex(n);var a=this.curItemSub.data;this.openPanel(a.getPanelName(),a)},e.prototype.getDefaultTabIndex=function(){for(var t=-1,i=this.itemList.numElements,n=0;i>n;n++){var a=this.itemList.getElementAt(n);if(a){var o=a.data,s=RpSys.ins().getData(ForgeWin,e,o.tabName);if(s){t=n;break}}}return t=-1==t?EquipSys.ins().getTuiJianTabIndex():t},e.prototype.onMenuClick=function(t){if("DaZaoTabItem"==t.target.name){var e=t.target,i=e.data;if(Actor.ins().zsId>=i.zslevel){this.curItem.select(!1),this.curItemSub.select(!1),e.select(!0);var n=i.getRedPointSubTabIndex(),a=-1==n?i.getTuiJianSubTabIndex():n;e.selectSubTabIndex(a,!0),this.curItem=e,this.curItemSub=e.getItemIndex(a);var o=this.curItemSub.data;this.openPanel(o.getPanelName(),o),this.itemScroller.validateNow()}else showtipsFail(GFunc.getZSNameBydb(i.zslevel)+"开启")}else if("DaZaoTabItemSub"==t.target.name){var e=t.target,i=e.data;Actor.ins().zsId>=i.zslevel?(this.curItemSub.select(!1),e.select(!0),this.curItemSub=e,this.openPanel(i.getPanelName(),i)):showtipsFail(GFunc.getZSNameBydb(i.zslevel)+"开启")}},e.prototype.openPanel=function(t,e){if(this.curPanelName!=t){var i=getDefinitionByName(t);this.curPanel&&this.curPanel.close(),this.curPanel=new i,this.curPanel.open(e),this.groupPanel.removeChildren(),this.groupPanel.addChild(this.curPanel),this.curPanelName=t}this.curData!=e&&(this.curData=e,this.curPanel.open(e))},e.prototype.onClick=function(t){t.target},e.getSysId=function(){return SysId.DaZao},e.getTitle=function(){return"btz_zycs_dz"},e.getTabTitle=function(){return"bqz_zycs_dz"},e}(BasePanel);__reflect(DaZaoMainPanel.prototype,"DaZaoMainPanel"),window.DaZaoMainPanel=DaZaoMainPanel;var DaZaoRankPanel=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="DaZaoRankPanelEUI",this.setSkinPart("itemCur",new DaZaoEquipItem),this.setSkinPart("itemNext",new DaZaoEquipItem),this.listConsumeArray=new eui.ArrayCollection,this.listConsume.itemRenderer=ItemBaseConsume,this.listConsume.dataProvider=this.listConsumeArray},e.prototype.open=function(e){this.data=e,t.prototype.open.call(this),this.addLsn(BagSys.ins().patchItemChange,this.updateItem),this.addLsn(EquipSys.ins().patchDaZaoRingUpRank,this.updatePanel),this.addLsn(EquipSys.ins().patchDaZaoRingUpStar,this.updatePanel),this.addClickE(this.btnDaZao,this.onClick),this.addClickE(this.itemCur,this.onClick),this.addClickE(this.itemNext,this.onClick),this.updatePanel()},e.prototype.updateItem=function(t){void 0===t&&(t=null),(t.cfg.type==ItemType.GodRing||t.cfg.type==ItemType.MoRing)&&this.selectEquip(this.equipData)},e.prototype.updatePanel=function(){this.lbConsumeDesc.textFlow=addColorTF(this.data.getConsumeDesc()),this.lbEquipDesc.textFlow=addColorTF(this.data.getEquipDaZaoDesc()),this.lbConsumeType.text=this.data.consumeDesc,this.lbMaxDesc.text=this.data.maxLevelDesc,this.equipData=BagSys.ins().getEquipByIndex(this.data.pos),this.selectEquip(this.equipData),this.currentState=this.data.isMax()?"max":"normal"},e.prototype.selectEquip=function(t){t.hasEquipOn()?(this.itemCur.data=t,this.itemNext.data=this.data.isMax()?null:GFunc.creatItemDataById(this.data.config.tarid),this.listConsumeArray.source=this.data.isMax()?[]:this.data.config.needitem):(this.itemCur.data=t,this.itemNext.data=t,this.listConsumeArray.source=this.data.config.needitem)},e.prototype.updateRp=function(t){void 0===t&&(t=null)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnDaZao:this.equipData.hasEquipOn()?GFunc.checkConsumeEnough(this.data.config.needitem)&&this.data.sendUp():showtipsFail(this.data.getNoEquipRankTips());break;case this.itemCur:var e=this.itemCur.data;null==e.cfg?openWin(XunBaoWin):GFunc.openItemTips(this.itemCur.data);break;case this.itemNext:e=this.itemNext.data,null==e.cfg?openWin(XunBaoWin):GFunc.openItemTips(this.itemNext.data)}},e.prototype.resetPanel=function(){this.updatePanel(),this.listConsumeArray.source=null},e}(BasePanel);__reflect(DaZaoRankPanel.prototype,"DaZaoRankPanel"),window.DaZaoRankPanel=DaZaoRankPanel;var DaZaoSuccessTipsWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="DaZaoSuccessTipsEUI",this.addBg(),this.setSkinPart("itemTarget",new ItemBase)},e.prototype.open=function(e){t.prototype.open.call(this),this.itemTarget.data=GFunc.creatItemDataById(e)},e}(BaseWin);__reflect(DaZaoSuccessTipsWin.prototype,"DaZaoSuccessTipsWin"),window.DaZaoSuccessTipsWin=DaZaoSuccessTipsWin;var DaZaoTabItem=function(t){function e(){var e=t.call(this)||this;return e.itemListArray=new eui.ArrayCollection,e.skinName="DaZaoTabItemEUI",e.name="DaZaoTabItem",e.itemList.itemRenderer=DaZaoTabItemSub,e.itemList.dataProvider=e.itemListArray,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lbName.text=t.tabName,this.itemListArray.source=t.daZaoTabSubDatas,this.itemList.validateNow(),this.updateRedPoint()},e.prototype.updateItem=function(){for(var t=this.itemList.numElements,e=0;t>e;e++){var i=this.itemList.getElementAt(e);i&&i.updateItem()}this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this.data;if(t){this.redPoint.visible=RpSys.ins().getData(ForgeWin,DaZaoMainPanel,t.tabName);for(var e=this.itemList.numElements,i=0;e>i;i++){var n=this.itemList.getElementAt(i);n&&n.updateRedPoint()}}},e.prototype.select=function(t){this.currentState=t?"select":"none"},e.prototype.selectSubTabIndex=function(t,e){var i=this.getItemIndex(t);i.select(e)},e.prototype.getItemIndex=function(t){return this.itemList.getChildAt(t)},e}(BaseItemRender);__reflect(DaZaoTabItem.prototype,"DaZaoTabItem"),window.DaZaoTabItem=DaZaoTabItem;var DaZaoTabItemSub=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoTabItemSubEUI",e.name="DaZaoTabItemSub",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.currentState=t.zslevel>Actor.ins().zsId?"noOpen":"none",this.updateItem()},e.prototype.updateItem=function(){var t=this.data;this.lbName.textFlow=addColorTF(t.tabName),this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(ForgeWin,DaZaoMainPanel,t.parentTabName,t.redTabName))},e.prototype.select=function(t){this.currentState=t?"select":"none"},e}(BaseItemRender);__reflect(DaZaoTabItemSub.prototype,"DaZaoTabItemSub"),window.DaZaoTabItemSub=DaZaoTabItemSub;var DaZaoTipsWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaZaoTipsWinEUI",e.list.itemRenderer=ItemBase,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(e,i){var n=this;t.prototype.open.call(this),this.listArr.source=e,this.callFun=i,this.addClickE(this.btnDaZao,function(){i&&i(),closeWin(n)})},e}(BaseWinSingle);__reflect(DaZaoTipsWin.prototype,"DaZaoTipsWin"),window.DaZaoTipsWin=DaZaoTipsWin;var DaZaoFenJieEquipData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.star=1,e}return __extends(e,t),e.prototype.getPanelName=function(){return egret.getQualifiedClassName(DaZaoFenJiePanel)
},Object.defineProperty(e.prototype,"tabName",{get:function(){var t=BagSys.ins().getEquipByQualityStar(QualityType.Red,this.star).length,e=t>0?addColor("("+t+")",5949490):"";return GFunc.getChineseNum(this.star)+"星红装"+e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redTabName",{get:function(){return GFunc.getChineseNum(this.star)+"星红装"},enumerable:!0,configurable:!0}),e.prototype.getRedPoint=function(){var t=BagSys.ins().getEquipByQualityStar(QualityType.Red,this.star).length;return t>0},e}(DaZaoTabSubDataBase);__reflect(DaZaoFenJieEquipData.prototype,"DaZaoFenJieEquipData");var DaZaoTabData=function(){function t(){this.daZaoTabSubDatas=[]}return Object.defineProperty(t.prototype,"zslevel",{get:function(){for(var t=999999,e=0;e<this.daZaoTabSubDatas.length;e++){var i=this.daZaoTabSubDatas[e].zslevel;t>i&&(t=i)}return t},enumerable:!0,configurable:!0}),t.prototype.getTuiJianSubTabIndex=function(){for(var t=0,e=0;e<this.daZaoTabSubDatas.length;e++)if(this.daZaoTabSubDatas[e].isTuiJian()){t=e;break}return t},t.prototype.getRedPointSubTabIndex=function(){for(var t=-1,e=0;e<this.daZaoTabSubDatas.length;e++){var i=this.daZaoTabSubDatas[e],n=RpSys.ins().getData(ForgeWin,DaZaoMainPanel,i.parentTabName,i.tabName);if(n){t=e;break}}return t},t.prototype.getRedPoint=function(){return!1},t}();__reflect(DaZaoTabData.prototype,"DaZaoTabData");var DaZaoTabEqupData=function(t){function e(){var e=t.call(this)||this;return e.daZaoTabEqupPosData=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"star",{get:function(){return this.config.star},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage",{get:function(){return this.config.stage},enumerable:!0,configurable:!0}),e.prototype.iniData=function(){for(var t=0;t<EquipPos.RING1;t++)this.daZaoTabEqupPosData[t]=new DaZaoTabEqupPosData,this.daZaoTabEqupPosData[t].pos=t,this.daZaoTabEqupPosData[t].tabName=GFunc.getEquipNameByType(t),this.daZaoTabEqupPosData[t].equipId=this.config.equipid[0][t]},e.prototype.getPanelName=function(){return egret.getQualifiedClassName(DaZaoEquipPanel)},Object.defineProperty(e.prototype,"tabName",{get:function(){return this.stage+"阶"+this.config.name[this.job]},enumerable:!0,configurable:!0}),e.prototype.getEquipDaZaoDesc=function(){return"必定获得"+addColor(this.stage+"阶红色"+this.star+"星",16711680)+"装备一件(指定部位)"},e.prototype.getConsumeDesc=function(){return Cfg.getConfig(DazaoCommonConfig).equipConsumeDesc},e.prototype.isTuiJian=function(){for(var t=!1,e=0;e<this.daZaoTabEqupPosData.length;e++)if(this.daZaoTabEqupPosData[e].isTuiJian()&&Actor.ins().zsId>=this.zslevel){t=!0;break}return t},e.prototype.getTuiJianSubTabIndex=function(){for(var t=0,e=0;e<this.daZaoTabEqupPosData.length;e++)if(this.daZaoTabEqupPosData[e].isTuiJian()){t=e;break}return t},Object.defineProperty(e.prototype,"zslevel",{get:function(){return this.config.needzslevel},enumerable:!0,configurable:!0}),e.prototype.getRedPoint=function(){var t=BagSys.ins().getEquipByStarRank(this.star-1,this.stage).concat(),e=t.length>=5&&Actor.ins().zsId>=this.zslevel;return e},e}(DaZaoTabSubDataBase);__reflect(DaZaoTabEqupData.prototype,"DaZaoTabEqupData");var RankDataJob=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankData);__reflect(RankDataJob.prototype,"RankDataJob"),window.RankDataJob=RankDataJob;var RankDataLadder=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ladderLevel=1,e.id=0,e.count=0,e.conf=null,e}return __extends(e,t),e.prototype.parser=function(t){this.rank=t.readShort(),this.playerName=t.readString(),this.ladderLevel=t.readInt(),this.id=t.readInt(),this.count=t.readInt()},e.prototype.getRankStr=function(){var t="";return t=this.ladderLevel==LadderSys.ins().MAX_LEVEL?""+this.getConfig().showLevel:""+this.getConfig().showLevel+this.getConfig().showDan+Lang.fb_str135},e.prototype.getConfig=function(){return this.conf||(this.conf=Cfg.getConfig(TianTiDanConfig,this.ladderLevel,this.id))},e}(RankData);__reflect(RankDataLadder.prototype,"RankDataLadder"),window.RankDataLadder=RankDataLadder;var DaZaoTabFootEqupData2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getRedPoint=function(){var t=FootSys.ins().getEquipByStar(this.star-1).concat(),e=t.length>=5&&Actor.ins().zsId>=this.zslevel&&GFunc.isConsumeEnough(Cfg.getConfig(FootConstConfig).dazaoneeditem);return e},e}(DaZaoTabFootEqupData1);__reflect(DaZaoTabFootEqupData2.prototype,"DaZaoTabFootEqupData2"),window.DaZaoTabFootEqupData2=DaZaoTabFootEqupData2;var DaZaoTabFootEqupPosData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=0,e.equipId=0,e}return __extends(e,t),e.prototype.isTuiJian=function(){var t=FootSys.ins().isChuanDaiEquipByEquipId(this.pos+1,this.equipId);return t},e.prototype.posName=function(){return GFunc.getFootEquipNameByType(this.pos)},e}(DaZaoTabEqupPosData);__reflect(DaZaoTabFootEqupPosData.prototype,"DaZaoTabFootEqupPosData");var RankDataLevel=function(t){function e(){var e=t.call(this)||this;return e.level=0,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.level=e.readDouble()},e.prototype.getRankStr=function(){return Lang.common_str30+"："+GFunc.GetLvStrByLv(this.level)},e}(RankData);__reflect(RankDataLevel.prototype,"RankDataLevel"),window.RankDataLevel=RankDataLevel;var RankDataLLDJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=1,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.id=e.readDouble()},e.prototype.getRankStr=function(){var t=Cfg.getConfig(JunxianLevelConfig,this.id);return Lang.rank_str16+"："+Lang.junxianName[t.junxian]+GFunc.getChineseNum(t.level)+Lang.common_jie},e}(RankData);__reflect(RankDataLLDJ.prototype,"RankDataLLDJ"),window.RankDataLLDJ=RankDataLLDJ;var DaZaoTabMoRingStageData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"tabName",{get:function(){return"魔戒升阶"},enumerable:!0,configurable:!0}),e.prototype.sendUp=function(){EquipSys.ins().sendDaZaoRingUpRank(this.pos)},e.prototype.getMinRingId=function(){return Cfg.getConfig(DazaoCommonConfig).minRankModRing[this.job]},e}(DaZaoTabGodRingStageData);__reflect(DaZaoTabMoRingStageData.prototype,"DaZaoTabMoRingStageData");var DaZaoTabMoRingStarData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"tabName",{get:function(){return"魔戒升星"},enumerable:!0,configurable:!0}),e.prototype.sendUp=function(){EquipSys.ins().sendDaZaoRingUpStar(this.pos)},e.prototype.getMinRingId=function(){return Cfg.getConfig(DazaoCommonConfig).minStarMoRing[this.job]},e}(DaZaoTabGodRingStarData);__reflect(DaZaoTabMoRingStarData.prototype,"DaZaoTabMoRingStarData");var RankDataMZZL=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankData);__reflect(RankDataMZZL.prototype,"RankDataMZZL"),window.RankDataMZZL=RankDataMZZL;var OtherRoleInfoPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.currentState="otherPlay"},e.prototype.open=function(t){this.seePlayModel=t,this.setEquip(new EntityAttrData);var e=this.seePlayModel.xianluRingId;this.btnXLRing.iconDisplay.source=this.seePlayModel.xianluRingId>0?"role_zycs_jyjz"+e:"role_zycs_jyjz",this.addClickE(this.btnXLRing,this.onClickRing)},e.prototype.onClickRing=function(){this.seePlayModel.xianluRingId>0?openWin(XianluRingTipsWin,!0):showtipsFail("对方尚未结缘")},e.prototype.updateRoleRedPoint=function(){},e.getTitle=function(){return"btz_zycs_js"},e.getTabTitle=function(){return"bqz_zycs_zb"},e}(RolePanel);__reflect(OtherRoleInfoPanel.prototype,"OtherRoleInfoPanel"),window.OtherRoleInfoPanel=OtherRoleInfoPanel;var OtherRoleWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.winType=WinType.NormalWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[OtherRoleInfoPanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg()},e.prototype.getParam=function(){return[Actor.ins().getOther()]},e}(BaseWinAutoTab);__reflect(OtherRoleWin.prototype,"OtherRoleWin"),window.OtherRoleWin=OtherRoleWin;var RankSys=function(t){function e(){var e=t.call(this)||this;return e.rankTypeData=[],e.showRankType=[],e.indexToType=[RankType.JSZL,RankType.JSDJ,RankType.SMZL,RankType.YBZL,RankType.JLZL,RankType.SQZL,RankType.CBZL,RankType.SZZL,RankType.MLZL,RankType.HQZL,RankType.LLDJ,RankType.TXDJ,RankType.ZBZL],e.sysId=PackId.Rank,e.reg(1,e.patchRankData),e.reg(2,e.patchPraiseData),e.reg(3,e.patchPraiseResult),e.reg(4,e.patchAllPraiseData),e.reg(7,e.patchShowRankType),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.sendGetRankData=function(t){var e=this.getBytes(1);e.writeShort(t),this.send(e)},e.prototype.patchRankData=function(t){var e=t.readShort(),i=this.getRankData(e);return t.position-=2,i.parser(t),i},e.prototype.sendGetPraise=function(t){var e=this.getBytes(2);e.writeShort(t),this.send(e)},e.prototype.patchPraiseData=function(t){var e=t.readByte(),i=this.getRankData(e);return i.praise.parser(t,e),i},e.prototype.sendPraise=function(t){var e=this.getBytes(3);e.writeShort(t),this.send(e)},e.prototype.patchPraiseResult=function(t){var e=this.getRankData(t.readShort());return e.praise.praiseCount=t.readShort(),RpFun.showRankRedpoint(),e},e.prototype.patchAllPraiseData=function(t){for(var e=t.readShort(),i=0;e>i;i++){var n=t.readShort(),a=this.getRankData(n);a.type=n,a.praise.praiseCount=t.readShort()}RpFun.showRankRedpoint()},e.prototype.sendShowRankType=function(){this.sendBase(7)},e.prototype.patchShowRankType=function(t){for(var e=[],i=t.readByte(),n=0;i>n;n++){var a=t.readByte();this.indexToType.indexOf(a)>-1&&e.push(a)}this.showRankType.length=0;for(var o=0;o<this.indexToType.length;o++){var a=this.indexToType[o];e.indexOf(a)>-1&&this.showRankType.push(a)}RpFun.showRankRedpoint()},e.prototype.getRankData=function(t){return this.rankTypeData[t]||(this.rankTypeData[t]=new RankTypeData)},e.prototype.canPraiseByType=function(t){return this.rankTypeData[t]&&this.rankTypeData[t].praise.canPraise()&&this.indexToType.indexOf(t)>-1&&(this.showRankType.indexOf(t)>-1||this.rankTypeData[t].isShowPraise())},e.prototype.canPraiseInAll=function(){for(var t=0,e=this.rankTypeData;t<e.length;t++){var i=e[t];if(i&&i.praise.canPraise())return!0}return!1},e.prototype.getCanPraiseIndex=function(){for(var t,e=0;e<this.indexToType.length;e++)if(this.canPraiseByType(this.indexToType[e])){t=this.indexToType.indexOf(this.indexToType[e]);break}return t},e.prototype.getPraiseCount=function(){for(var t=0,e=this.showRankType,i=!1,n=0,a=e;n<a.length;n++){var o=a[n];i=this.canPraiseByType(o),i&&t++}return t},e.prototype.canRankWinPraise=function(){for(var t=this.showRankType,e=!1,i=0,n=t;i<n.length;i++){var a=n[i];if(e=this.canPraiseByType(a))break}return e},e.prototype.getTSSZLeftTime=function(){var t=new Date(Actor.ins().serverOpenTimer);t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=t.getTime()+Cfg.getConfig(RankCommonConfig).endtime*DateUtil.MS_PER_DAY,i=Math.max(e-Actor.ins().serverTime,0)/1e3;return i},e.prototype.getJobByRankType=function(t){var e=0;return t==RankType.JOB_ZS?e=JobConst.ZhanShi:t==RankType.JOB_FS?e=JobConst.FaShi:t==RankType.JOB_GJS&&(e=JobConst.GongJianShou),e},e.prototype.getRankTypeByJob=function(t){var e;return e=t==JobConst.ZhanShi?RankType.JOB_ZS:t==JobConst.FaShi?RankType.JOB_FS:t==JobConst.GongJianShou?RankType.JOB_GJS:RankType.JOB_ZS},e.prototype.getRankNumber=function(t,e){var i=0;switch(e){case RankType.JSZL:i=t.power;break;case RankType.CBZL:i=t.power;break;case RankType.JOB_ZS:case RankType.JOB_FS:case RankType.JOB_GJS:case RankType.GuaJi:i=t.power;break;case RankType.JSDJ:i=t.power;break;case RankType.WanMo:case RankType.HeiAn:i=t.rank;break;case RankType.JJC:i=t.rank;break;case RankType.Fort:i=t.score;break;case RankType.QHDJ:case RankType.PYZL:case RankType.JLZL:case RankType.YSZL:case RankType.HFDJ:case RankType.gem:case RankType.MLZL:case RankType.juhun:case RankType.emoisle:case RankType.FieldPk:case RankType.Qizhi:case RankType.CBZL:i=t.dabiaoValue}return i},e}(BaseSys);__reflect(RankSys.prototype,"RankSys"),SystemMap.RankSys=RankSys.ins.bind(RankSys),window.RankSys=RankSys;var SeePlayModelMy=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"sex",{get:function(){return Actor.ins().sex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actorID",{get:function(){return Actor.ins().actorID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return Actor.ins().level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vip",{get:function(){return VipSys.ins().getCurSVipConfig().lv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"power",{get:function(){return Actor.ins().power},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"job",{get:function(){return Actor.ins().job},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleId",{get:function(){return ChengHaoSys.ins().showID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"szId",{get:function(){return SqXySys.ins().szModel.huanHuaId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sqId",{get:function(){return SqXySys.ins().shenQiModel.huanHuaId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wingId",{get:function(){return SqXySys.ins().wingModel.huanHuaId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"meilinId",{get:function(){return SqXySys.ins().meilinModel.huanHuaId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damonId",{get:function(){return ShouHuNewSys.ins().damonModel.useId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damonMozhenId",{get:function(){return ShouHuNewSys.ins().damonModel.moZhenId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yongbingId",{get:function(){return ShouHuNewSys.ins().yongbingModel.useId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yongbingMozhenId",{get:function(){return ShouHuNewSys.ins().yongbingModel.moZhenId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shenmoId",{get:function(){return ShouHuNewSys.ins().shenmoModel.useId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shenglingId",{get:function(){return QiyuSys.ins().shengLingModel.huanHuaId},enumerable:!0,configurable:!0}),e.prototype.getEquipByIndex=function(t){return BagSys.ins().equipDatas[t]},e.prototype.getEquipLen=function(){return BagSys.ins().equipDatas.length},e.prototype.gethufu=function(t){return EquipSys.ins().gethufu(t)},e.prototype.getRoleModel=function(){return Actor.ins().attrData},e}(SeePlayModel);__reflect(SeePlayModelMy.prototype,"SeePlayModelMy");var RankDataQHZL=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankData);__reflect(RankDataQHZL.prototype,"RankDataQHZL"),window.RankDataQHZL=RankDataQHZL;var RankDataRedFort=function(t){function e(){var e=t.call(this)||this;return e.floor=0,e.score=0,e}return __extends(e,t),e.prototype.parser=function(t){this.rank=t.readShort(),this.userId=t.readInt(),this.playerName=t.readString(),this.floor=t.readShort(),this.score=t.readInt()},e}(RankData);__reflect(RankDataRedFort.prototype,"RankDataRedFort"),window.RankDataRedFort=RankDataRedFort;var RoleItemBig1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.showMc=function(t){this.mc.playFile(ResMgr.getEffName("mjeff"),-1)},e}(RoleItemBig);__reflect(RoleItemBig1.prototype,"RoleItemBig1"),window.RoleItemBig1=RoleItemBig1;var RankDataSMZL=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankDataPower);__reflect(RankDataSMZL.prototype,"RankDataSMZL"),window.RankDataSMZL=RankDataSMZL;var RoleUpLevelTipsWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="RoleUpLevelTipsWinEUI",e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.open=function(t){this.bitLevel.text="e"+t+"c",GFunc.playUIMovie("ls",0,0,this.groupMC)},e}(BaseItemRender);__reflect(RoleUpLevelTipsWin.prototype,"RoleUpLevelTipsWin"),window.RoleUpLevelTipsWin=RoleUpLevelTipsWin;var RoleWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[RolePanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.destroyTime=10},e.prototype.open=function(e){t.prototype.open.call(this,e)},e.prototype.getParam=function(){return[Actor.ins().getMyData()]},e.prototype.getEquipGrid=function(t){return this.validateNow(),this.getPanel(RolePanel).getEquipItem(t)},e.prototype.getEquipItemCanPutOn=function(){return this.validateNow(),this.getPanel(RolePanel).getEquipItemCanPutOn()},e.prototype.getHuFuGrid=function(){return this.validateNow(),this.getPanel(RolePanel).getHuFuItem()},e.prototype.getCloseBtn=function(){return this.closeBtn},e.prototype.getkillBtn=function(){return this.validateNow(),this.getPanel(RolePanel).getkillBtn()},e.prototype.getElementBtn=function(){return this.validateNow(),this.getPanel(RolePanel).getElementBtn()},e.prototype.getDamonItem=function(){return this.getPanel(RolePanel).getDamonItem()},e.prototype.getSHengJie=function(){return this.getPanel(RolePanel).getSHengJie()},e.prototype.getStarsoulUpBtn=function(){return null},e.prototype.getFruitBtn=function(){return this.validateNow(),this.getPanel(RolePanel).getFruitBtn()},e.prototype.getTujianBtn=function(){return this.getPanel(RolePanel).getTujianBtn()},e.prototype.getBtnOneKeyEquip=function(){return this.getPanel(RolePanel).getBtnOneKeyEquip()},e}(BaseWinAutoTab);__reflect(RoleWin.prototype,"RoleWin"),window.RoleWin=RoleWin;var KeyboardWin=function(t){function e(){var e=t.call(this)||this;return e.popupData=null,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="KeyboardWinEUI"},e.prototype.open=function(e){t.prototype.open.call(this),this.popupData=e,this.addClickE(this.groupKey,this.onChange)},e.prototype.onChange=function(t){var e=t.target;if(e&&e instanceof eui.Button){var i=e;this.setNum(i.name)}},e.prototype.setXY=function(t,e){this.x=t-10,this.y=e},e.prototype.setNum=function(t){var e=this.popupData.curNum+"";switch(t){case"c":e=this.popupData.minNum+"";break;case"ok":return void(this.visible=!1);default:if(0==this.popupData.maxNum)return;e==this.popupData.minNum+""&&t==this.popupData.minNum+""?e=this.popupData.minNum+"":e+=t}this.popupData.curNum=Number(e),this.popupData.curNum>this.popupData.maxNum&&(this.popupData.curNum=this.popupData.maxNum),this.popupData.sureFun(this.popupData.curNum)},e}(BasePanel);__reflect(KeyboardWin.prototype,"KeyboardWin"),window.KeyboardWin=KeyboardWin;var RoleAttrWin1=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.layer=LayerMgr.Popup,this.skinName="RoleAttrWinEUI",this.addBg(),t.prototype.initUI.call(this),this.attrs1.itemRenderer=RoleAttrWinItem,this.attrs2.itemRenderer=RoleAttrWinItem},e.prototype.open=function(){t.prototype.open.call(this),this.iniPanel()},e.prototype.iniPanel=function(){this.lbLevel.textFlow=addColorTF("等级:"+GFunc.GetLvStrByLv(Actor.ins().level));var t=this.getDatas(1);this.attrs1.dataProvider=new eui.ArrayCollection(t);var e=this.getDatas(2);this.attrs2.dataProvider=new eui.ArrayCollection(e),this.updataExp()},e.prototype.updataExp=function(){this.proExp.maximum=Actor.ins().totalexp,this.proExp.value=Actor.ins().exp},e.prototype.getDatas=function(t){for(var e=[],i=Cfg.getConfigs(AttrViewConfig,t,CondType.ALL),n=Actor.ins().attrData,a=0;a<i.length;a++){var o=i[a],s=new RoleAttrViewData;s.attrViewConfig=o,s.attrData.type=o.type,s.attrData.value=Math.ceil(n.getAtt(o.type)),e.push(s)}return e},e}(BaseWinSingle);__reflect(RoleAttrWin1.prototype,"RoleAttrWin1"),window.RoleAttrWin1=RoleAttrWin1;var RoleAttrWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ComAttrItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(-1==t.attrViewConfig.type)this.lbCurAttr.visible=!1;else{this.lbCurAttr.visible=!0;var e=AttrData.getFm(3821938,5767068,"：");this.lbCurAttr.textFlow=addColorTF(AttrData.parse([t.attrData],{fm:e}).join("\n"))}this.lbNextAttr.text=""},e}(BaseItemRender);__reflect(RoleAttrWinItem.prototype,"RoleAttrWinItem"),window.RoleAttrWinItem=RoleAttrWinItem;var RoleEquipSelectWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.layer=LayerMgr.Popup,this.skinName="equipchangskin_1",this.addBg(),this.itemList.itemRenderer=RoleEquiSelectItem,this.itemScroller.viewport=this.itemList,t.prototype.initUI.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.equipsData=e,this.setListData()},e.prototype.setListData=function(){var t=BagSys.ins().getEquipBySubType(GFunc.getEquipTypeByPos(this.equipsData.equipPos)),e=[];void 0!=this.equipsData&&void 0!=this.equipsData.cfg&&t.unshift(this.equipsData);for(var i=0;i<t.length;i++){var n=new RoleEquiSelectItemData;n.itemData=t[i],n.selectEquipData=this.equipsData,this.equipsData?1==i&&(n.isTj=!0):0==i&&(n.isTj=!0),e.push(n)}this.itemList.dataProvider=new eui.ArrayCollection(e)},e.prototype.getListItem=function(t){return this.itemList.validateNow(),this.itemList.getElementAt(t)},e}(BaseWinSingle);__reflect(RoleEquipSelectWin.prototype,"RoleEquipSelectWin"),window.RoleEquipSelectWin=RoleEquipSelectWin;var RoleEquiSelectItemData=function(){function t(){this.isTj=!1}return t}();__reflect(RoleEquiSelectItemData.prototype,"RoleEquiSelectItemData");var RoleEquiSelectItem=function(t){function e(){var e=t.call(this)||this;return e.greedmc=new MC,e.skinName="equipchangskin_3",e.setSkinPart("itemIcon",new ItemIcon),e.init(),e.greedmc.x=400,e.greedmc.y=70,e.addChild(e.greedmc),e}return __extends(e,t),e.prototype.init=function(){this.lbArrt1.lineSpacing=3,this.lbArrt2.lineSpacing=3,this.btnEquip.touchEnabled=!0,this.imgline1.visible=!1,this.addClickE(this.btnEquip,this.onClick)},e.prototype.onClick=function(t){EquipSys.ins().sendWearEquipment(this.equiSelect.itemData.id),closeWin(RoleEquipSelectWin)},e.prototype.dataChanged=function(){this.equiSelect=this.data,this.setItemData(this.equiSelect.itemData)},e.prototype.setItemData=function(t){var e=430,i=-28;if(null!=t){this.itemIcon.setDataByItemConfig(t.cfg),this.lbName.text=t.equipName,this.lbScore.text=Lang.common_str66+Math.floor(BagSys.ins().getPowerOfItem(t)),this.lbNeed.text=1e4==t.cfg.zslevel?GFunc.GetLvStrByLv(t.cfg.level).trim():GFunc.getZSNameBydb(t.cfg.zslevel),this.lbrank.text=t.cfg.rank+Lang.common_jie,this.lbtype.text=GFunc.getEquipNameByType(t.cfg.subType),this.lbjob.text=GFunc.getJobNameByJob(Actor.ins().job);for(var n="",a=t.cfg.pattr,o=AttrData.getFm(2508416,2508416,"","："),s=0;s<a.length;s++){var r=a[s].value;r>0&&(n+=AttrData.parse([a[s]],{fm:o}).join("\n")+"\n",i+=28)}this.lbArrt1.textFlow=addColorTF(n,2508416),this.imgline2.y=155+i,this.imgline2.visible=!1,n="";for(var s=0;s<t.cfg.exattr.length;s++)if(0!=t.cfg.exattr[s].type){var u=GConst.ZhuoYueColor[0],h=GFunc.getEquipAttrNoColor(AttrType.ZY,t.cfg.exattr[s],u,u);h=StrUtil.addColor(h,u),n+=h+"\n",i+=28,0==s&&(i+=10),this.imgline2.visible=!0}if(this.lbArrt2.textFlow=addColorTF(n),n="",this.btnEquip.redPoint.visible=!1,this.equiSelect.selectEquipData.handle==this.equiSelect.itemData.handle)this.isShowDressUI(!0),this.imgTipIcon.source="";else{this.isShowDressUI(!1);var p=this.equiSelect.selectEquipData;void 0!=p.cfg?(t.power>p.power&&(this.btnEquip.redPoint.visible=this.equiSelect.isTj),this.imgTipIcon.source=ResMgr.getEquipAttrContrastIcon1(t.power,p.power)):this.imgTipIcon.source=ResMgr.getEquipAttrContrastIcon1(t.power,0)}e=165+i}else this.imgIcon.source="",this.imgBg.source=ResMgr.getItemqualityResource(1);this.imgbg.height=250>=e?250:e,this.height=250>=e?250:e},e.prototype.isShowDressUI=function(t){this.imgDress.visible=t,this.btnEquip.visible=!t},e.prototype.getEuipBtn=function(){return this.btnEquip},e}(BaseItemRender);__reflect(RoleEquiSelectItem.prototype,"RoleEquiSelectItem"),window.RoleEquiSelectItem=RoleEquiSelectItem;var RoleOpenTipsItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RoleOpenTipsItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source=ResMgr.getSkillResourceItemName(t.icon,!0,!1)},e}(BaseItemRender);__reflect(RoleOpenTipsItem.prototype,"RoleOpenTipsItem"),window.RoleOpenTipsItem=RoleOpenTipsItem;var RoleUseSelect=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e.roleModels=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="RoleUseSelectSkin",this.btnRoles=[this.role0,this.role1,this.role2],this.roleMovie=[];for(var t=0;3>t;t++){var e=new MC;e.x=45,e.y=45,this.roleMovie.push(e)}},e.prototype.open=function(){this.addClickE(this,this.onClick),this.setCurRole(this._curRole),this.setModel(Actor.ins().attrData)},e.prototype.setModel=function(t){this.roleModels=[t],this.updateRole()},e.prototype.setRedPoint=function(t,e){this.btnRoles[t].redPoint.visible=e},e.prototype.getCurRole=function(){return this._curRole},e.prototype.getCurRoleModel=function(){return this.roleModels[this._curRole]},e.prototype.setCurRole=function(t){this._curRole=t;for(var e=0;e<this.btnRoles.length;e++)this.btnRoles[e].selected=e==t},e.prototype.getCurJob=function(){return Actor.ins().job},e.prototype.setIndex=function(t){this.setCurRole(t),this.dispatchEventWith(egret.Event.CHANGE,!1,this._curRole)},e.prototype.onClick=function(t){var e=this.btnRoles.indexOf(t.target);e>-1&&this.setIndex(e)},e.prototype.updateRole=function(){for(var t,e,i=this.btnRoles.length,n=0;i>n;n++)t=this.btnRoles[n],e=this.roleModels[n],e?(t.visible=!0,t.imgJob.visible=!0,t.imgJob.source=ResMgr.getJobImgBG(Actor.ins().job),t.lbjob.text=Lang.common_jobName[Actor.ins().job],t.icon=ResMgr.getHeadIcon(Actor.ins().sex),this.roleMovie[n]&&DisUtil.remove(this.roleMovie[n])):t.visible=!1},e}(BaseEUI);__reflect(RoleUseSelect.prototype,"RoleUseSelect"),window.RoleUseSelect=RoleUseSelect;var RoleAttrViewData=function(){function t(){this.attrData=new AttrData}return t}();__reflect(RoleAttrViewData.prototype,"RoleAttrViewData");var RongLianEquipItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RongLianPanelItemEUI",e.itemTarget.touchChildren=!1,e.itemTarget.touchEnabled=!1,e.setSkinPart("itemTarget",new ItemBase),e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.itemTarget.visible=e?!0:!1,this.itemTarget.data=e},e.prototype.playEff=function(){this.mc=new MC,this.mc.x=46,this.mc.y=45,this.mc.playFile(getEffName("rl"),1),this.addChild(this.mc)},e}(BaseItemRender);__reflect(RongLianEquipItem.prototype,"RongLianEquipItem"),window.RongLianEquipItem=RongLianEquipItem;var RongLianEquipPanel=function(t){function e(){var e=t.call(this)||this;return e.itemRewear=[],e.rongLlianZhong=!1,e.oldLevel=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RongLianPanelEUI",this.attrs.itemRenderer=ComAttrItem,this.attrs.dataProvider=this.attrData=new eui.ArrayCollection,this.smeltEquips=[],this.itemList.itemRenderer=RongLianEquipItem,this.itemListArray=new eui.ArrayCollection,this.itemList.dataProvider=this.itemListArray,this.lbDesc1.textFlow=addColorTF("已自动为您选择"+addColor("橙品及以下",11887104)+"的"+addColor("低评分",11887104)+"装备，请放心熔炼。"),this.lbDesc2.textFlow=addColorTF("1星及以上装备较为珍贵，请前往"+addColor("[锻造]-[打造]-[装备分解]",11887104)+"\n进行分解。")},e.prototype.open=function(){t.prototype.open.call(this),this.itemRewear=[],this.addClickE(this.buyRongLian,this.onClick),this.addLsn(BagSys.ins().patchEquiChange,this.updateBagEquip),this.addLsn(EquipSys.ins().patchSmeltEquipComplete,this.updateRongLianSucceed),this.updateLevel(),this.oldLevel=EquipSys.ins().rongLianData.level,this.rongLlianZhong=!1,this.updateBagEquip()},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this)},e.prototype.updatePanel=function(t){this.smeltEquips=t;for(var e=this.smeltEquips.length;20>e;e++)this.smeltEquips.push(null);this.itemListArray.source=this.smeltEquips},e.prototype.updateLevel=function(){var t=EquipSys.ins().rongLianData;this.ljLv=Lang.replaceEnum(LangEnum.lianluLevel,t.level),this.progressExp.maximum=t.config.needexp,this.progressExp.value=t.exp,this.totalPower.text=t.power.toString(),this.attrData.source=t.getLevelAttrDatas()},e.prototype.updateBagEquip=function(){if(0==this.rongLlianZhong){var t=BagSys.ins().getEquipByLessStar(0,20);this.updatePanel(t)}},e.prototype.updateRongLianSucceed=function(t){var e=this;if(this.updateLevel(),GFunc.mergeItemDataReward(this.itemRewear,t.itemRewear),t.itemRewear.length>0){for(var i=this.itemList.numElements,n=0,a=function(t){var i=o.itemList.getElementAt(t);n=100*Math.floor(t/5),Timer.ins()["do"](n,1,1,function(){if(i&&i.data){i.data=null;var t=i.localToGlobal(),n=e.groupMC.globalToLocal(t.x,t.y),a=new MC;a.x=n.x+46,a.y=n.y+45,a.playFile(getEffName("rl"),1),e.groupMC.addChild(a),e.playPiaoMc(i.localToGlobal(0,0))}},o,TimerType.NONE)},o=this,s=0;i>s;s++)a(s);Timer.ins()["do"](n+150,1,1,function(){var t=BagSys.ins().getEquipByLessStar(0,20);t.length>0?(e.updatePanel(t),e.sendSmeltEquip()):(e.updatePanel([]),e.rongLlianZhong=!1,e.oldLevel!=EquipSys.ins().rongLianData.level?(openWin(RongLianUpLevelTips,e.oldLevel,EquipSys.ins().rongLianData.level,function(){openWin(RongLianSuccessTips,e.itemRewear.concat()),e.itemRewear.length=0},e),e.oldLevel=EquipSys.ins().rongLianData.level):(openWin(RongLianSuccessTips,e.itemRewear.concat()),e.itemRewear.length=0))},this,TimerType.NONE)}},e.prototype.playPiaoMc=function(t){var e=this;this.globalToLocal(t.x,t.y,t);var i=new MC;i.playFile(getEffName("purplesoul1"),-1),i.x=t.x+50,i.y=t.y+50,this.groupMC1.addChild(i);var n=egret.Tween.get(i);n.to({x:this.progressExp.x+this.progressExp.width/2,y:this.progressExp.y+this.progressExp.height/2},1300,egret.Ease.sineInOut).call(function(){i.reset(),e.groupMC1.removeChild(i)})},e.prototype.onClick=function(t){switch(t.currentTarget){case this.buyRongLian:0==this.rongLlianZhong?this.sendSmeltEquip():showtipsFail("正在熔炼中")}},e.prototype.sendSmeltEquip=function(){this.smeltEquips[0]?(this.rongLlianZhong=!0,EquipSys.ins().sendSmeltEquip(this.smeltEquips)):showtipsFail("当前无装备可分解")},e.getSysId=function(){return SysId.ronglian},e.getTitle=function(){return"btz_zycs_bb"},e.getTabTitle=function(){return"bqz_zycs_rl"},e.prototype.getRongLianBtn=function(){return this.buyRongLian},e}(BasePanel);__reflect(RongLianEquipPanel.prototype,"RongLianEquipPanel"),window.RongLianEquipPanel=RongLianEquipPanel;var RongLianSuccessTips=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="RongLianSuccessTipsEUI",this.addBg(),this.list.itemRenderer=ItemBaseRewardName},e.prototype.open=function(e){t.prototype.open.call(this),this.list.dataProvider=new eui.ArrayCollection(e)},e}(BaseWin);__reflect(RongLianSuccessTips.prototype,"RongLianSuccessTips"),window.RongLianSuccessTips=RongLianSuccessTips;var RongLianTipsWin=function(t){function e(){var e=t.call(this)||this;return e.oldLevel=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="RongLianTipsEUI",this.addBg()},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnOk,this.onClick),this.addLsn(EquipSys.ins().patchSmeltEquipComplete,this.updateRongLianSucceed),this.oldLevel=EquipSys.ins().rongLianData.level
},e.prototype.updateRongLianSucceed=function(t){this.oldLevel!=EquipSys.ins().rongLianData.level&&openWin(RongLianUpLevelTips,this.oldLevel,EquipSys.ins().rongLianData.level,function(){},this),closeWin(e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOk:EquipSys.ins().sendSmeltEquip([])}},e}(BaseWin);__reflect(RongLianTipsWin.prototype,"RongLianTipsWin"),window.RongLianTipsWin=RongLianTipsWin;var RongLianUpLevelTips=function(t){function e(){var e=t.call(this)||this;return e.closeFun=new Caller,e.mc2=new MC,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="RongLianUpLevelTipsEUI",this.addBg(),this.attrs.itemRenderer=ComAttrItem,this.attrs.dataProvider=this.attrData=new eui.ArrayCollection,this.groupMC1.addChild(this.mc2)},e.prototype.open=function(e,i,n,a){t.prototype.open.call(this),this.closeFun.func=n,this.closeFun.obj=a,this.bitLevel.text=""+i,this.attrData.source=this.getLevelAttrDatas(e,i),this.mc2.playFile(ResMgr.getEffName("hjbxbk"),1)},e.prototype.close=function(){t.prototype.close.call(this),this.closeFun.call()},e.prototype.getLevelAttrDatas=function(t,e){for(var i=[],n=Cfg.getConfig(LianjinConfig,t),a=Cfg.getConfig(LianjinConfig,e),o=n.addattr.length,s=0;o>s;s++){var r=n.addattr[s],u=a.addattr[s],h=new ComAttrData(r,u,n.level>=a.level);i.push(h)}return i},e}(BaseWin);__reflect(RongLianUpLevelTips.prototype,"RongLianUpLevelTips"),window.RongLianUpLevelTips=RongLianUpLevelTips;var RongLianData=function(){function t(){this.level=0,this.exp=0}return Object.defineProperty(t.prototype,"config",{get:function(){return null==this._config?this._config=Cfg.getConfig(LianjinConfig,this.level):this._config.level!=this.level&&(this._config=Cfg.getConfig(LianjinConfig,this.level)),this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"power",{get:function(){return GFunc.getPower(this.config.addattr).toFixed()},enumerable:!0,configurable:!0}),t.prototype.isMax=function(){return this.level==Cfg.getMaxConfig(LianjinConfig).level},t.prototype.getLevelAttrDatas=function(){for(var t=[],e=Cfg.getConfig(LianjinConfig,this.level),i=Cfg.getConfig(LianjinConfig,this.isMax()?this.level:this.level+1),n=e.addattr.length,a=0;n>a;a++){var o=e.addattr[a],s=i.addattr[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},t}();__reflect(RongLianData.prototype,"RongLianData");var RongLianRewearData=function(){function t(){this.itemRewear=[]}return t}();__reflect(RongLianRewearData.prototype,"RongLianRewearData");var LogicSys=function(t){function e(){var i=t.call(this)||this;i.entityList=[],i.dropItems=[],i.isFirstEnterCity=!0,i.isFirstCreatRole=!0,i.isFirstRegister=!1,i.nextExpTick=0,i.showMasterHandles={},i.entityListShowTick=0,i.isShowOtherEff=!0,i.isShowHit=!0,i.isShowOtherWing=!0,i.isAutoCamera=!0,i.isInJJCGroup=!1,i.firstCreateMap=!0,i.aotuOpenWin=!0,i.isFubenLose=!1,i.onceReport=!0,i.entityShowCount=2,i.loger={},i.count=0,i.sysId=PackId.Default,i.reg(1,i.patchActorInfo),i.reg(3,i.patchEnterMap),i.reg(4,i.doCreateOtherEntity),i.reg(5,i.doCurrencyChange),i.reg(7,i.doExp),i.reg(8,i.patchSubRoleAtt),i.reg(9,i.doBloodUpdata),i.reg(10,i.doRemoveEntity),i.reg(11,i.doMoveEntity),i.reg(12,i.doStopMoveEntity),i.reg(13,i.doSyncPos),i.reg(14,i.doServerTime),i.reg(16,i.patchOtherActor),i.reg(18,i.doFirstRegister),i.reg(20,i.doDieNotice),i.reg(21,i.doGuildChange),i.reg(22,i.doRename),i.reg(23,i.patchGetOpenServer),i.reg(24,i.patchHefuTimer),i.reg(25,i.patchEntityProp),i.reg(26,i.patchLvExp),i.reg(27,i.doCurrencyInit),i.reg(28,i.doLvAttr),i.reg(30,i.patchFbInfo),i.reg(32,i.doPickUpItem),i.reg(33,i.doCreatDropItem),i.reg(34,i.patchEntityModelChange),i.reg(40,i.doEntityDie),i.reg(41,i.doChatBubble),i.reg(42,i.doBloodMaxUpdate),i.reg(43,i.patchEntityAlive),i.reg(45,i.patchChouhenList),i.reg(46,i.patchChouhenUpdate),i.reg(47,i.patchChouhenClear),i.reg(49,i.doDeBloodUpdata),i.reg(55,i.patchCaijiEntity),i.reg(56,i.patchAllSysInit),i.reg(59,i.patchEntityYongbingChange),i.reg(60,i.patchEntitySkillChange),i.reg(61,i.patchNewDayBegin),i.reg(63,i.onEnterMap),i.reg(64,i.patchEnterKFFail),i.reg(65,i.onTodayFirstLogin),egret.startTick(i.onEnterFrame,i),i.addLsn(MapContainer.ins().patchGridClick,i.onMapGridClick);var n=6e4;return Timer.ins()["do"](n,n,0,function(){i.sendBase(255)},i),i.mcOnClick=new MC,window.checkRoleRes=function(t){var i=e.ins().centerEntity;if(!i||!i.data)return!1;for(var n=i.data,a=[n.bodyFileName,n.weaponFileName,n.mountFileName,n.wingFileName,n.biansheBodyFileName],o=0,s=a;o<s.length;o++){var r=s[o];if(r&&~t.indexOf(r))return!0}return!1},i}return __extends(e,t),Object.defineProperty(e.prototype,"camera",{get:function(){return this.tempCenter||this.centerEntity},enumerable:!0,configurable:!0}),e.ins=function(){return t.getIns.call(this,e)},e.prototype.onEnterFrame=function(t){for(var e=Timer.ins().getTimer(),i=0,n=this.entityList;i<n.length;i++){var a=n[i];a.updateTick(t)}var o=MapContainer.ins();if(this.centerEntity&&(this.isInJJCGroup?o.focusTo(this.camera.x+1.2*MapBase.CELL_SIZE,this.camera.y):o.focusTo(this.camera.x,this.camera.y)),e-this.entityListShowTick>=500){this.entityListShowTick=e;for(var s=0,r=this.entityList;s<r.length;s++){var a=r[s];this.updateEntitySingleShowStatus(a)}}for(var u=0;u<this.dropItems.length;u++){var h=this.dropItems[u];h.item.isMy&&0!=h.item.tick&&e>h.item.tick&&this.canItemPick(h)&&(h.hasPicked=!0,this.sendPickUpItem(h))}return o.updateTick(t),!1},e.prototype.updateEntitySingleShowStatus=function(t){if(this.centerEntity){var e=new egret.Rectangle(-MapContainer.ins().x,-MapContainer.ins().y,LayerMgr.getStage().stageWidth,LayerMgr.getStage().stageHeight),i=e.contains(t.x,t.y);i?t.visible||(t.visible=!0):t.visible&&(t.visible=!1)}},e.prototype.addShowList=function(t){if(!GFunc.isInCity()&&t.masterHandle!=Actor.ins().handle)if(this.showMasterHandles[t.masterHandle])t.setBodyVisible(!0);else{var e=ComUtil.getObjLen(this.showMasterHandles);3>e?(this.showMasterHandles[t.masterHandle]=1,t.setBodyVisible(!0)):t.setBodyVisible(!1)}},e.prototype.delShowList=function(t){var e=this.getMainRoleByMasterHandle(t);e||delete this.showMasterHandles[t]},e.prototype.sendGMCommad=function(t){var e=this.getBytes(0);e.writeString(t),this.send(e)},e.prototype.setClickMapEnable=function(t){MapContainer.ins().touchEnabled=MapContainer.ins().touchChildren=t},e.prototype.onMapGridClick=function(t,e){void 0===e&&(e=null);var i=this.centerEntity.AI;return GuildWarSys.ins().getModel().getIsBaJian()?void openWin(WarnWin,Lang.scene_str33.replace("$str$",""+StrUtil.addColor(Lang.scene_str2,16758826)),function(){i.resetCaiji(),i.startMoveToXY(t,-1,e)},this):(i.resetCaiji(),void i.startMoveToXY(t,-1,e))},e.prototype.patchEntityClick=function(t){return t},e.prototype.setOnClickMovie=function(t,e){t?(this.mcOnClick.x=e.x,this.mcOnClick.y=e.y,this.mcOnClick.alpha=MapContainer.ins().checkAlphaByPixel(this.mcOnClick.x,this.mcOnClick.y)?.6:1,this.mcOnClick.playFile(getEffName("dianji"),-1),MapContainer.ins().addEffectToDown1(this.mcOnClick)):(DisUtil.remove(this.mcOnClick),this.mcOnClick.stop())},e.prototype.addBuff=function(t,e){var i=this.getEntityByHandle(t);if(i){i.addBuff(e);var n=Cfg.getConfig(EffectsConfig,e),a=n.args;n.type==BuffType.AdditionalState&&a.i==BuffEffectType.DING_SHEN&&i.AI.isMoveing()&&i.AI.stopAndStand()}},e.prototype.removeBuff=function(t,e){var i=this.getEntityByHandle(t);i&&i.removeBuff(e)},e.prototype.sendEnterFb=function(t){var e=this.getBytes(30);e.writeInt(t),this.send(e)},e.prototype.patchFbInfo=function(t){return Actor.ins().outboardExp=t.readInt(),Actor.ins().outboardGold=t.readInt(),Actor.ins().outboardExp},e.prototype.sendQuitFb=function(){this.sendBase(31)},e.prototype.patchActorInfo=function(t){var e=Actor.ins(),i=e.level;if(e.handle=t.readDouble(),e.actorID=t.readInt(),e.serverID=t.readInt(),e.serverName=t.readString(),e.serverEnv=t.readByte(),e.myName=t.readString(),e.job=t.readByte(),e.sex=t.readByte(),e.level=t.readInt(),e.exp=t.readDouble(),e.power=t.readDouble(),window.platform.setShareInfo(),this.onceReport){var n="?";for(var a in urlParam)if("last"!=a)if("root"!=a||urlParam[a])n+="&"+a+"="+urlParam[a];else{var o=location.origin,s=location.pathname;if(~s.indexOf(".")){var r=s.split("/");r[r.length-1]="",n+="&"+a+"="+o+r.join("/")}else n+="&"+a+"="+o+s}console.log("登录参数",n),window.platform.report(ReportType.loginOK),this.onceReport=!1}if(e.setCurrency(CurType.gold,t.readDouble()),e.setCurrency(CurType.yb,t.readDouble()),e.setCurrency(CurType.talentValue,t.readDouble()),e.sVipLv=t.readInt(),e.setCurrency(CurType.mojing,t.readDouble()),BagSys.ins().bagNum=t.readInt(),e.setCurrency(CurType.feats,t.readDouble()),e.setCurrency(CurType.JinZuan,t.readDouble()),e.setCurrency(CurType.starsoul,t.readDouble()),t.readInt(),e.attrData.parserAtt(t),Actor.ins().getMyData(),0==i&&urlParam.useKTX){for(var u=navigator.userAgent.toString(),h=u.indexOf("MI ")>-1,p=u.indexOf("Redmi ")>-1,l=u.indexOf("OPPO ")>-1,c=u.indexOf("vivo ")>-1,d=!1,g=["m2 note","PRO 6","PRO 5","MX6","MX5","MX4","metal"],y=0,f=g;y<f.length;y++){var m=f[y];if(u.indexOf(m)>-1){d=!0;break}}var v=u.indexOf("iPhone")>-1||u.indexOf("iPad")>-1,S=h||p||l||c||d||v;S&&Actor.ins().level>400&&ResMgr.initKTX()}},e.prototype.sendCreateSunRole=function(t,e){var i=this.getBytes(2);i.writeShort(t),i.writeShort(e),this.send(i)},e.prototype.patchEnterMap=function(t){this.tempCenter=null,this.loger={},SkillSys.ins().tongji=new SkillDamageTongji;var e=FbSys.ins().fbId,i=t.readInt(),n=FbSys.ins().fubenConfig=Cfg.getConfig(FubenConfig,i),a=Cfg.getConfig(FubenConfig,e),o=FbSys.ins().mapId;FbSys.ins().mapId=t.readInt();var s=t.readShort(),r=t.readShort();if(openWin(GameMapGcEffWin,FbSys.ins().mapId,o),GameBlackCom.ins().hideBlackMapEff(),this.clearAllEntity(),this.showMasterHandles={},MapContainer.ins().changeMap(FbSys.ins().mapId,s,r),Socket.ins().isFenzhen=-1==GConst.fenzhenFubenGroup.indexOf(n.group),this.creatNpc(),ObjPool.clear(5),GFunc.isFb(n.fbid)){var u=getWin(MainWin);u&&u.com_ext_closeRemind()}GFunc.isInCity()?(this.isFirstEnterCity=!1,this.setClickMapEnable(!0),this.addLsn(RpSys.ins().patchRp,this.onNpcState),this.onNpcState(),SkillEditor.ins().clear(0)):(n.group==FbGroup.RedFortress||n.group==FbGroup.GuildWarPVP||n.group==FbGroup.Mine||n.group==FbGroup.MoLong||n.group==FbGroup.ShenDian||n.group==FbGroup.GuildBattle||n.group==FbGroup.Guzhanchang?this.setClickMapEnable(!0):this.setClickMapEnable(!1),this.removeLsn(RpSys.ins().patchRp,this.onNpcState),SkillEditor.ins().clear(1)),closeWin(FirstRechargeTipsWin),closeWin(SevenDayLoginTipsWin),closeWin(BossBloodWin),closeWin(DamageListWin),closeWin(ReliveWin),closeWin(GuWuWin),closeWin(BossWarnWin),closeWin(MoLongZuZuiTimeWin),closeWin(ShenDianZuZuiTimeWin),closeWin(GuildBattleQuickWin),closeWin(GuildBattleMainWin),closeWin(GuildMapWin),this.isFubenLose&&(RechargeActSys.ins().openFirstRechargeTipsWin(),this.isFubenLose=!1),this.aotuOpenWin&&(a.group==FbGroup.TianTi&&openWin(JJCWin,JJCWin.getTabIndexbyPanel(JJCSinglePanel),JJCSinglePanel.getTabIndexbyPanel(LadderMainPanel)),a.group==FbGroup.EQUIP&&FbSys.ins().guajiData.guanId>Cfg.getConfig(ShilianCommonConfig).guanqia&&openWin(BossWin),(n.group==FbGroup.Wanmo||n.group==FbGroup.HeiAn)&&openWin(PaTaTitleWin,n.group,n.fbid),a.group==FbGroup.JJC&&openWin(JJCWin,JJCWin.getTabIndexbyPanel(JJCSinglePanel),JJCSinglePanel.getTabIndexbyPanel(JJCPanelNew)),a.group==FbGroup.ShengDian&&openWin(FuBenWin,FuBenWin.getTabIndexbyPanel(FuBenDanRenPanel),FuBenDanRenPanel.getTabIndexbyPanel(YongZhePanel)),a.group==FbGroup.GuildMonFb&&openWin(GuildMapWin),a.group==FbGroup.GuildBoss&&(openWin(GuildMapWin),openWin(GuildActivityWin2)),a.group==FbGroup.Kalima&&openWin(BossWin,BossWin.getTabIndexbyPanel(ZhuZaiMainPanel),ZhuZaiMainPanel.getTabIndexbyPanel(KlmPanel)),TaskSys.ins().isTaskIsOk(60)&&GFunc.isDailyFb(a.group)&&openWin(FuBenWin,FuBenWin.getTabIndexbyPanel(FuBenDanRenPanel),FuBenDanRenPanel.getTabIndexbyPanel(MeiRiFbPanel))),a.group==FbGroup.GuildWarPVP&&closeWin(WarnWin),this.isInJJCGroup=GFunc.isJJCGroup(FbSys.ins().fubenGroupConfig.group),closeWin(CountDownWin),closeWin(GuildWarLuckDrawWin),ShouHuNewSys.ins().resetTime(),SoundUtil.playBg(Cfg.getConfig(ScenesConfig,FbSys.ins().mapId).sound+"_mp3");var h=Cfg.getConfig(FubenGroupConfig,n.group);GFunc.isShowExtActIcon=1==h.isTopActIcon,this.firstCreateMap&&(openWin(MainUIButton),openWin(MainWin),this.firstCreateMap=!1),this.aotuOpenWin=!0},e.prototype.onNpcState=function(t){void 0===t&&(t=null);var e;(!t||t.check(EmoPanel))&&(e=10004,this.setNpcRedPoint(e,RpSys.ins().getData(EmoWin,EmoPanel))),(!t||t.check(XueSePanel))&&(e=10005,this.setNpcRedPoint(e,RpSys.ins().getData(EmoWin,XueSePanel))),(!t||t.check(WanMoWin))&&(e=10001,this.setNpcRedPoint(e,RpSys.ins().getData(WanMoWin))),(!t||t.check(HeiAnWin))&&(e=10002,this.setNpcRedPoint(e,RpSys.ins().getData(HeiAnWin))),(!t||t.check(JJCWin))&&(e=10008,this.setNpcRedPoint(e,RpSys.ins().getData(JJCWin)))},e.prototype.setNpcRedPoint=function(t,e){if(t){var i=this.getNpcById(t);i?i.showRedPoint(e):console.log("npc:"+t+"不存在")}},e.prototype.doCreateOtherEntity=function(t){var e=t.readShort(),i=t.readDouble();this.loger[i]=1,t.position-=10;var n=this.getEntityDataByType(e);n.parser(t),this.creatEntityByData(n)},e.prototype.getEntityDataByType=function(t){var e;return EntityType.isMonster(t)?e=new EntityMonsterData:EntityType.isRole(t)?e=new EntityRoleData:EntityType.isBianshen(t)?e=new EntityBianshenData:EntityType.isYongbing(t)?e=new EntityYongbingData:EntityType.isCaiJi(t)?e=new EntityCollectionMonsterData:EntityType.isOther(t)?e=new EntityGatherMonsterData:t==EntityType.MEILIN&&(e=new EntityFaBaoData),e.type=t,e},e.prototype.creatEntityByData=function(t){var e=FbSys.ins().fubenConfig.group,i=t.type;if(EntityType.isMonster(i)||EntityType.isOther(i)){var n=t,a=Cfg.getMonstersConfigNew(n.configID);i=a.type==MonsterType.FriendMonster?EntityType.FRIEND_MONSTER:i;var o=this.createEntityByType(i);n.writeBaseDataToEntity(o),o.setData(n),this.addEntity(o),n.isAlive()||o.setAction(EntityAction.DIE);for(var s=0;s<n.buffs.length;s++)this.addBuff(o.handle,n.buffs[s]);var r=!1;a.type==MonsterType.FriendMonster?o.setAI(new AINpc):EntityType.isMonster(i)?(i==EntityType.MONSTER_SERVER?o.setAI(new AIMonsterServer):i==EntityType.MONSTER_CLIENT&&o.setAI(new AIMonsterClient),e==FbGroup.RedFortress||e==FbGroup.GuildWarPVP||e==FbGroup.MoLong||e==FbGroup.ShenDian||e==FbGroup.Guzhanchang?r=!0:e==FbGroup.GuildBattle&&this.centerEntity.teamId!=n.teamId&&(r=!0)):EntityType.isCaiJi(i)&&n instanceof EntityCollectionMonsterData&&(r=!0,this.updateCaijiInfo(o,n.state,n.tick,n.tMasterHandle)),o.setClickEnable(r);var u=egret.Tween.get(o);o.alpha=.1,u.to({alpha:1},800),t.hasTargetPlace()&&o.AI.startMove(new XY(t.tx,t.ty))}else if(EntityType.isRole(i)){var h=t;if(h.meilinId>=0){var p=this.getFollowersByEntityType(h.masterHandle,EntityType.MEILIN),l=Cfg.getConfig(MeilinHuanhuaBaseConfig,h.meilinId);if(p){var c=p.data;c.configID!=h.meilinId&&(c.setConfig(l),p.setData(c))}else{var c=this.getEntityDataByType(EntityType.MEILIN);c.setConfig(l),p=this.createEntityByType(EntityType.MEILIN),p.masterHandle=c.masterHandle=h.masterHandle,p.handle=c.handle=VirtualServer.ins().getHandle();var d=MapContainer.ins().getNearestRandomXY(h);p.x=d.x,p.y=d.y,p.setData(c),p.setFlow(),p.setAI(new AIMeilin),p.AI.start(),p.AI.startFollow(h.handle,h.masterHandle),this.addEntity(p)}}var g,y=h.masterHandle==Actor.ins().handle,f=void 0;y?h.appearType==AppearType.maindAppear?(f=this.centerEntity.bianShenClone(),f.handle=this.centerEntity.handle,f.masterHandle=this.centerEntity.masterHandle,g=this.centerEntity,g.entityType=EntityType.ROLE,g.handle=h.handle,g.masterHandle=h.masterHandle):(g=this.createEntityByType(i),this.centerEntity=g,h.writeBaseDataToEntity(g)):(g=this.createEntityByType(i),h.writeBaseDataToEntity(g)),g.setData(h),this.addEntity(g);for(var s=0;s<h.buffs.length;s++)this.addBuff(g.handle,h.buffs[s]);if(y){switch(h.appearType){case AppearType.maindAppear:Timer.ins()["do"](1e3,1e3,1,function(){var t=new MC,e=h.appearType==AppearType.maindAppear?"juhun_explosion_l":"bsdc";t.playFile(getEffName(e),1),t.x=g.x,t.y=g.y,MapContainer.ins().addEffectToUp1(t)},null)}if(h.appearType==AppearType.maindAppear)g.AI.resetMove();else if(g.setAI(this.getMyAI(e)),g.AI.start(),g.isDead())g.setHpAndNameVisible(!1),g.AI.startDie();else if(GFunc.isInCity())g.AI.startNone();else if(GFunc.isPkFuben(e)){var m=this.centerEntity.AI.getGuaJi();m?(g.AI.setGuaji(m),g.AI.startAttack()):g.AI.startNone()}else g.AI.startAttack();g.AI.setSkillData(SkillSys.ins().skillDatas.concat(h.skillDatas)),g.AI.setAutoBianshen(ShouHuNewSys.ins().autoBianShen),urlParam.isnew&&this.isFirstCreatRole||(this.isFirstCreatRole=!1,g.addEffect(getEffName("dtqh"))),h.appearType==AppearType.common&&this.patchCreateCommEntity()}else g.setHPBarVisible(!GFunc.isInCity()),h.hasTargetPlace()&&g.AI.startMove(new XY(h.tx,h.ty)),e==FbGroup.RedFortress||e==FbGroup.GuildWarPVP?g.setClickEnable(!0):e==FbGroup.GuildBattle&&this.centerEntity.teamId!=h.teamId&&g.setClickEnable(!0);this.addShowList(g),f&&this.addShowList(f)}else if(EntityType.isYongbing(i)){var v=t,o=this.createEntityByType(i);if(v.writeBaseDataToEntity(o),o.setData(v),o.masterHandle==Actor.ins().handle){if(o.setAI(this.getMyYongbingAI(e)),GFunc.isPkFuben(e)){var m=this.centerEntity.AI.getGuaJi();m&&o.AI.setGuaji(m)}o.AI.start(),o.AI.startFollow(this.centerEntity.handle,this.centerEntity.masterHandle)}o.AI.setSkillData(v.skillDatas),this.addEntity(o)}else if(i==EntityType.NPC);else if(EntityType.isBianshen(i)){var S=t;if(S.meilinId>=0){var p=this.getFollowersByEntityType(S.masterHandle,EntityType.MEILIN),l=Cfg.getConfig(MeilinHuanhuaBaseConfig,S.meilinId);if(p){var c=p.data;c.configID!=S.meilinId&&(c.setConfig(l),p.setData(c))}else{var c=this.getEntityDataByType(EntityType.MEILIN);c.setConfig(l),p=this.createEntityByType(EntityType.MEILIN),p.masterHandle=c.masterHandle=S.masterHandle,p.handle=c.handle=VirtualServer.ins().getHandle();var d=MapContainer.ins().getNearestRandomXY(S);p.x=d.x,p.y=d.y,p.setData(c),p.setFlow(),p.setAI(new AIMeilin),p.AI.start(),p.AI.startFollow(S.handle,S.masterHandle),this.addEntity(p)}}var y=S.masterHandle==Actor.ins().handle,C=void 0,b=void 0;y?(C=this.centerEntity.bianShenClone(),C.handle=this.centerEntity.handle,C.masterHandle=this.centerEntity.masterHandle,b=this.centerEntity,b.entityType=EntityType.BIANSHEN,3==S.appearType&&b.AI.setSkillData(S.skillDatas)):b=this.createEntityByType(i),y?(b.handle=S.handle,b.masterHandle=S.masterHandle):S.writeBaseDataToEntity(b),b.setData(S),this.addEntity(b);for(var s=0;s<S.buffs.length;s++)this.addBuff(b.handle,S.buffs[s]);if(y)b.AI.playAtk(),this.patchCreateEntity(AppearType.bianshendAppear);else{var I=this.getMainRoleByMasterHandle(S.masterHandle);I&&b.setDir(I.dir),b.setHPBarVisible(!GFunc.isInCity()),S.hasTargetPlace()&&b.AI.mustMove(new XY(S.tx,S.ty)),e==FbGroup.RedFortress||e==FbGroup.GuildWarPVP?b.setClickEnable(!0):e==FbGroup.GuildBattle&&this.centerEntity.teamId!=S.teamId&&b.setClickEnable(!0)}this.addShowList(b),C&&this.addShowList(C)}else console.log("创建未知类型实体:"+i)},e.prototype.patchCreateCommEntity=function(){},e.prototype.patchCreateEntity=function(t){return void 0===t&&(t=AppearType.common),t},e.prototype.getMyAI=function(t){var e;return e=t==FbGroup.XueSe?new AIXuese:GFunc.isJJCGroup(t)?new AIRoleJJC:t==FbGroup.BossHome?new AIBossHome:t==FbGroup.RedFortress?new AIRedFort:t==FbGroup.GuildWarPVE?new AIGuildWarPVE:t==FbGroup.GuildWarPVP?new AIGuildWarPVP:t==FbGroup.JueWang?new AIRoleJueWang:t==FbGroup.kfbosssd?new AIRoleKfBossSd:t==FbGroup.ShenDian||t==FbGroup.Guzhanchang?new AIRedFort:t==FbGroup.MoLong?new AIRedFort:t==FbGroup.GuildBattle?new AIGuildBattleRole:Actor.ins().MyAI},e.prototype.getMyYongbingAI=function(t){var e;return e=GFunc.isJJCGroup(t)?new AIYongbingJJC:t==FbGroup.kfbosssd?new AIYongbingKfBossSd:t==FbGroup.MoLong||t==FbGroup.ShenDian||t==FbGroup.Guzhanchang?new AIYongbingMoLong:t==FbGroup.GuildBattle?new AIGuildBattleYongbing:new AIYongbing},e.prototype.sendMoveEntity=function(t,e){var i=this.getBytes(11);i.writeDouble(t.handle),i.writeInt(FbSys.ins().fbId),i.writeInt(e.x),i.writeInt(e.y),i.writeInt(t.x),i.writeInt(t.y),this.send(i)},e.prototype.doMoveEntity=function(t){var e=t.readDouble(),i=this.getEntityByHandle(e);if(i&&i.masterHandle!=Actor.ins().handle){var n=new XY(t.readInt(),t.readInt()),a=new XY(t.readInt(),t.readInt()),o=Math.pow(n.x-a.x,2),s=Math.pow(n.y-a.y,2);o+s>3600&&(i.masterHandle!=Actor.ins().handle&&i instanceof EntityMonster,i.AI.stopMove(),i.x=a.x,i.y=a.y),i.AI.mustMove(n)}},e.prototype.sendStopMoveEntity=function(t){var e=this.getBytes(12);e.writeDouble(t.handle),e.writeInt(FbSys.ins().fbId),e.writeInt(t.x),e.writeInt(t.y),this.send(e)},e.prototype.doStopMoveEntity=function(t){var e=t.readDouble(),i=new XY(t.readInt(),t.readInt()),n=this.getEntityByHandle(e);if(n&&n.masterHandle!=Actor.ins().handle){var a=Math.pow(i.x-n.x,2),o=Math.pow(n.y-i.y,2);n.AI.stopAndStand(),3600>a+o||(n.x=i.x,n.y=i.y)}},e.prototype.getXYStr=function(t,e){return void 0===e&&(e=1),"("+(t.x/MapBase.CELL_SIZE).toFixed(e)+","+(t.y/MapBase.CELL_SIZE).toFixed(e)+")"},e.prototype.createEntityByType=function(t){var e;return EntityType.isRole(t)||EntityType.isBianshen(t)?e=new EntityRole:EntityType.isYongbing(t)?e=new EntityYongbing:EntityType.isMonster(t)?e=t==EntityType.FRIEND_MONSTER?new EntityFriendMonster:ObjPool.pop(EntityMonster):t==EntityType.NPC?e=new EntityNPC:EntityType.isOther(t)?e=t==EntityType.OTHER?new EntityOtherName:ObjPool.pop(EntityOther):EntityType.isDamon(t)?e=ObjPool.pop(EntityDamon):EntityType.isMeilin(t)?e=ObjPool.pop(EntityMeilin):t==EntityType.MINER?e=new EntityMiner:t==EntityType.SIEGE&&(e=new EntityMonsterSiege),e.entityType=t,e},e.prototype.creatNpc=function(){var t=Cfg.getConfig(ScenesConfig,FbSys.ins().mapId);for(var e in t.npcPos){var i=t.npcPos[e];this.createSingleNpc(i)}},e.prototype.createSingleNpc=function(t){var e=this.createEntityByType(EntityType.NPC),i=new EntityData;i.configID=t;var n=Cfg.getConfig(NPCConfig,t);e.scaleX=e.scaleY=n.scale/100,e.setData(i),i.handle=e.handle=VirtualServer.ins().getHandle(),n.isShow?e.AI.startStand():e.visible=!1;var a=n.pos;return e.x=(a.mapX+.5)*MapBase.CELL_SIZE,e.y=(a.mapY+.5)*MapBase.CELL_SIZE,this.addEntity(e),e},e.prototype.creatMinePos=function(t){var e=this.createEntityByType(EntityType.MINE_DIAMOND),i=new EntityGatherMonsterData;e.setData(i),e.setHpAndNameVisible(!1),e.setClickEnable(!1),e.x=(t.getMineFBConfig().shuijingXY[0]+.5)*MapBase.CELL_SIZE,e.y=(t.getMineFBConfig().shuijingXY[1]+.5)*MapBase.CELL_SIZE,e.handle=t.posHandle,e.AI.startStand(),this.addEntity(e)},e.prototype.creatMiner=function(t){var e=this.createEntityByType(EntityType.MINER);e.setData(t),e.x=(t.getMineFBConfig().kuanggongXY[0]+.5)*MapBase.CELL_SIZE,e.y=(t.getMineFBConfig().kuanggongXY[1]+.5)*MapBase.CELL_SIZE,e.handle=t.minerHandle,e.AI.startStand(),this.addEntity(e)},e.prototype.creatSiege=function(t){var e=this.createEntityByType(EntityType.SIEGE);e.setData(t),e.x=(t.config.pos[0]+.5)*MapBase.CELL_SIZE,e.y=(t.config.pos[1]+.5)*MapBase.CELL_SIZE,e.setClickEnable(!0),e.handle=VirtualServer.ins().getHandle(),t.isDie()?e.setAction(EntityAction.DIE):e.AI.startStand(),this.addEntity(e)},e.prototype.setEntityNPCConfig=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];n instanceof EntityNPC&&n.getCfgId()==t.id&&(n.AI.startStand(),n.visible=!0)}},e.prototype.getEntityByHandle=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.handle==t)return n}return null},e.prototype.removeEntityByHandle=function(t){for(var e=0;e<this.entityList.length;e++)if(this.entityList[e].handle==t){var i=this.entityList.splice(e,1)[0];return ObjPool.push(i),i}return null},e.prototype.getEntitysByMasterHandle=function(t){for(var e=[],i=0,n=this.entityList;i<n.length;i++){var a=n[i];a.masterHandle==t&&e.push(a)}return e},e.prototype.getEntitysByType=function(t){for(var e=[],i=0,n=this.entityList;i<n.length;i++){var a=n[i];a.entityType==t&&e.push(a)}return e},e.prototype.getEntityByType=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.entityType==t)return n}return null},e.prototype.getMainRoleByMasterHandle=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.masterHandle==t&&n.isAlive()&&(EntityType.isRole(n.entityType)||EntityType.isBianshen(n.entityType)))return n}return null},e.prototype.getCanAtkByMasterHandle=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.masterHandle==t&&n.isAlive()&&(EntityType.isRole(n.entityType)||EntityType.isMonster(n.entityType)||EntityType.isBianshen(n.entityType)))return n}return null},e.prototype.getFollowersByMasterHandle=function(t){for(var e=[],i=0,n=this.entityList;i<n.length;i++){var a=n[i];a.masterHandle==t&&(EntityType.isDamon(a.entityType)||EntityType.isMeilin(a.entityType))&&e.push(a)}return e},e.prototype.getFollowersByEntityType=function(t,e){for(var i=0,n=this.entityList;i<n.length;i++){var a=n[i];if(a.masterHandle==t&&e==a.entityType)return a}return null},e.prototype.getYongbingByMasterHandle=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.masterHandle==t&&EntityType.isYongbing(n.entityType))return n}return null},e.prototype.getEntityAliveCountByName=function(t){for(var e=0,i=0,n=this.entityList;i<n.length;i++){var a=n[i];egret.getQualifiedClassName(a)!=t||a.isDead()||e++}return e},e.prototype.getEntityAliveCountByEntityType=function(t){for(var e=0,i=0,n=this.entityList;i<n.length;i++){var a=n[i];a.entityType!=t||a.isDead()||e++}return e},e.prototype.getNpcById=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n instanceof EntityNPC&&n.getCfgId()==t)return n}return null},e.prototype.getAliveEnemysByAI=function(t){for(var e=[],i=0,n=this.entityList;i<n.length;i++){var a=n[i];t.isEnemy(a)&&!a.isDead()&&e.push(a)}return e},e.prototype.clearAllEntity=function(){for(var t=0,e=this.entityList;t<e.length;t++){var i=e[t];ObjPool.push(i)}this.entityList.length=0,this.clearAllDropItems()},e.prototype.getEntityList=function(){return this.entityList},e.prototype.getFirstRolesList=function(){for(var t=[],e=[],i=0,n=this.entityList;i<n.length;i++){var a=n[i];EntityType.isMainRole(a.entityType)&&a.isAlive()&&-1==t.indexOf(a.masterHandle)&&a.masterHandle!=Actor.ins().handle&&(t.push(a.masterHandle),e.push(a))}return e},e.prototype.getEntityMasterHandleList=function(){for(var t=[],e=0,i=this.entityList;e<i.length;e++){var n=i[e];EntityType.isMainRole(n.entityType)&&n.isAlive()&&-1==t.indexOf(n.masterHandle)&&n.masterHandle!=Actor.ins().handle&&t.push(n.masterHandle)}return t},e.prototype.getMyYongbing=function(){for(var t=0,e=this.entityList;t<e.length;t++){var i=e[t];if(EntityType.isYongbing(i.entityType)&&i.masterHandle==Actor.ins().handle)return i}return null},e.prototype.isAliveByMasterHandle=function(t){for(var e=!1,i=0,n=this.entityList;i<n.length;i++){var a=n[i];if(a instanceof EntityRole&&a.masterHandle==t&&a.isAlive()){e=!0;break}}return e},e.prototype.addEntity=function(t){-1==this.entityList.indexOf(t)&&(this.entityList.push(t),MapContainer.ins().addEntity(t),this.updateEntityIsShowWing(t))},e.prototype.addMapEff=function(t){-1==this.entityList.indexOf(t)&&(this.entityList.push(t),MapContainer.ins().addMapEff(t))},e.prototype.doBloodUpdata=function(t){var e=t.readDouble(),i=(t.readByte(),t.readDouble()),n=this.getEntityByHandle(e);if(n){var a=t.readBoolean(),o=(t.readByte(),Math.floor(i-n.getHP()));if(a&&o>0&&n.handle==this.centerEntity.handle){var s=new SkillDamageRange;s.senderPos=n,s.targetPos=n,s.damageType=DamageTypes.HUIXUE,SkillSys.ins().showBlood1(o,s)}n.setProp(AttrType.atHp,i),n.masterHandle==Actor.ins().handle&&EntityType.isRole(n.entityType)&&Actor.ins().attrData.setAtt(AttrType.atHp,i)}},e.prototype.doDeBloodUpdata=function(t){var e=t.readDouble(),i=t.readDouble(),n=this.getEntityByHandle(e),a=t.readByte();if(1==a&&i>=1){var o=new SkillDamageRange;o.senderPos=n,o.targetPos=n,o.damageType=DamageTypes.ZD,o.value=-i,SkillSys.ins().showBlood1(-i,o)}},e.prototype.doBloodMaxUpdate=function(t){var e=t.readDouble(),i=t.readDouble(),n=this.getEntityByHandle(e);n&&(n.setProp(AttrType.atHpMax,i),n.masterHandle==Actor.ins().handle&&n instanceof EntityRole&&Actor.ins().attrData.setAtt(AttrType.atHpMax,i))},e.prototype.patchEntityModelChange=function(t){var e=t.readDouble(),i=this.getEntityByHandle(e);if(i&&EntityType.isRole(i.entityType)){var n=i.data;if(n.entityName=t.readString(),n.job=t.readByte(),n.szId=t.readInt(),n.sqId=t.readInt(),n.wingId=t.readInt(),n.touxianStage=t.readInt(),n.title=t.readInt(),n.guildID=t.readInt(),n.guildName=t.readString(),n.guildOffice=t.readInt(),n.mozhenId=t.readInt(),n.damonId=t.readInt(),n.damonFazhenId=t.readInt(),n.meilinId=t.readInt(),n.footId=t.readInt(),n.shengLingId=t.readInt(),n.huDunId=t.readInt(),n.isShowHunduBar=1==t.readByte(),n.meilinId>=0){var a=this.getFollowersByEntityType(n.masterHandle,EntityType.MEILIN),o=Cfg.getConfig(MeilinHuanhuaBaseConfig,n.meilinId);if(a){var s=a.data;s.configID!=n.meilinId&&(s.setConfig(o),a.setData(s))}else{var s=this.getEntityDataByType(EntityType.MEILIN);s.setConfig(o),a=this.createEntityByType(EntityType.MEILIN),a.masterHandle=s.masterHandle=n.masterHandle,a.handle=s.handle=VirtualServer.ins().getHandle(),a.setData(s),a.setFlow(),a.setAI(new AIMeilin),a.AI.start(),a.AI.startFollow(n.handle,n.masterHandle),this.addEntity(a)}}i.updateHuDun()}else console.log("0-34协议,实体不存在:"+e);return e},e.prototype.patchEntityYongbingChange=function(t){var e=new EntityYongbingData;e.parserChange(t);var i=this.getEntityByHandle(e.handle);EntityType.isYongbing(i.entityType)?i.data=e:console.log("0-59协议,实体不存在:"+e.handle)},e.prototype.patchEntitySkillChange=function(t){var e=t.readDouble(),i=this.getEntityByHandle(e);if(i){for(var n=t.readByte(),a=[],o=i.getCfgId(),s=Cfg.getConfig(YongbingHuanhuaBaseConfig,o),r=0;n>r;r++){var u=a[r]=new SkillData;u.skillId=t.readInt(),u.level=1,u.actionIndex=s.effect-1}i.AI.setSkillData(a)}else console.log("0-60协议,实体不存在:"+e)},e.prototype.patchNewDayBegin=function(t){RpSys.ins().isPatch=!1,RpFun.doAllSysInit(),RpSys.ins().isPatch=!0,RpSys.ins().patchRp(new RpDataUpdateAll)},e.prototype.sendFcm=function(t,e){var i=this.getBytes(62);i.writeByte(t),i.writeInt(e),this.send(i)},e.prototype.onEnterMap=function(t){var e=t.readByte();0==e&&GameBlackCom.ins().hideBlackMapEff()},e.prototype.patchEnterKFFail=function(t){var e=t.readByte();return 0==e&&showtipsFail(Lang.sys_1),e},e.prototype.onTodayFirstLogin=function(t){void 0===t&&(t=null),console.log("下发今日首次登录")},e.prototype.doRemoveEntity=function(t){var e=t.readDouble(),i=t.readUnsignedByte(),n=this.getEntityByHandle(e);if(delete this.loger[e],n)if(2>=i){var a=n.masterHandle,o=n.entityType;if(this.removeEntityByHandle(e),(EntityType.isRole(o)||EntityType.isBianshen(o))&&(this.delShowList(a),1==i))for(var s=this.getFollowersByMasterHandle(a),r=0,u=s;r<u.length;r++){var h=u[r];this.removeEntityByHandle(h.handle)}}else 3==i&&this.removeEntityByHandle(e)},e.prototype.entityAddPickItem=function(t){for(var e=t.length,i=this.getMyYongbing(),n=0;e>n;n++){var a=t[n],o=void 0;o=a.item.id==Cfg.getConfig(EnumConfig).XUESE_DATIANSHI?this.centerEntity:null!=i?i:this.centerEntity;var s=new ItemPick;s.handle=a.item.handle,s.x=a.x,s.y=a.y,s.itemId=a.item.id,s.type=Cfg.getItemCfg(a.item.id).type,o.AI.addPickItem(s)}},e.prototype.setPickItem=function(t){t.masterHandle==Actor.ins().handle&&this.entityAddPickItem(this.dropItems)},e.prototype.doEntityDie=function(t){var e=t.readDouble(),i=t.readDouble(),n=t.readInt(),a=this.getEntityByHandle(e);if(a){this.setPickItem(a);var o=this.getEntityByHandle(i);this.patchEntityDie(a,o,n)}},e.prototype.patchEntityDie=function(t,e,i){var n=this;void 0===e&&(e=null),void 0===i&&(i=0);var a=1e3;t.AI.startDie(a,e);var o=t.handle;if(t.setProp(AttrType.atHp,0),delete this.loger[o],e&&e.masterHandle==Actor.ins().handle){var s=this.getEntityByHandle(o);
if(s){var r=new XY;r.x=s.x,r.y=s.y-s.getMyHeight()/2;var u=ObjPool.pop(FollowComBlue),h=ObjPool.pop(FollowComGreen);MapContainer.ins().addEffectToUp1(u),MapContainer.ins().addEffectToUp1(h),this.addKillEff(r,e,u),this.addKillEff(r,e,h)}if(i){var p=Cfg.getConfig(SkillsConfig,i).isShake;p&&DisUtil.shakeIt(MapContainer.ins(),p,200)}}if(t.handle==this.centerEntity.handle){var l=this.getYongbingByMasterHandle(t.masterHandle);l&&l.AI.startFollow(t.handle,t.masterHandle)}return(EntityType.isMonster(t.entityType)||EntityType.isBianshen(t.entityType))&&Timer.ins()["do"](a,0,1,function(){n.removeEntityByHandle(o)},null),[t,e,i]},e.prototype.addKillEff=function(t,e,i){i.x=t.x+50*(.5-Math.random()),i.y=t.y+50*(.5-Math.random()),i.playMovie();var n=MathUtil.randomInteger(200,300),a=80*(.5-Math.random()),o=80*(.5-Math.random()),s=egret.Tween.get(i);s.to({x:t.x+a,y:t.y+o},n,egret.Ease.sineInOut).call(function(){i.setTrailVisible(!0);var t=new XY;t.x=e.x,t.y=e.y-60;var n=MathUtil.getRadianByP(i,t);MathUtil.getDistance(i,t);i.setDir(n);var a=egret.Tween.get(i,{});a.to({x:t.x,y:t.y,trail:1},250,egret.Ease.backIn).call(function(){ObjPool.push(i),DisUtil.remove(i)})})},e.prototype.sendSpecialMove=function(t,e,i){void 0===e&&(e=1);var n=this.getBytes(13);n.writeDouble(t),n.writeByte(e),i?(n.writeInt(i.x),n.writeInt(i.y)):(n.writeInt(0),n.writeInt(0)),this.send(n)},e.prototype.doSyncPos=function(t){var e=t.readDouble(),i=t.readShort(),n=t.readInt(),a=t.readInt(),o=t.readInt(),s=this.getEntityByHandle(e);if(s)switch(i){case 0:s.handle==this.centerEntity.handle&&MapContainer.ins().focusTo(n,a),s.AI.startShunyi(new XY(n,a));for(var r=this.getFollowersByMasterHandle(s.masterHandle),u=0,h=r;u<h.length;u++){var p=h[u];if(EntityType.isMeilin(p.entityType)||EntityType.isDamon(p.entityType)){var l=MapContainer.ins().getNearestRandomXY(s);s.AI.startShunyi(l)}}break;case 1:s.AI.stopMove(),s.playAction(EntityAction.RUN),s.setCfState(!0),s.setDir(GFunc.getDirBy2Point(s,new XY(n,a))),s.startSpeedShadow();var c=egret.Tween.get(s,{onChange:function(){s.AI.isMoveing()&&s.AI.stopMove()}});c.to({x:n,y:a},o).call(function(){s.stopSpeedShadow(),s.AI.resetMove(),s.setCfState(!1)});break;case 2:this.atkedTarget(e,n,a,o)}},e.prototype.testPos=function(t,e){var i=new XY;i.x=t*MapBase.CELL_SIZE,i.y=e*MapBase.CELL_SIZE,this.centerEntity.AI.stopAndStand(),this.centerEntity.x=i.x,this.centerEntity.y=i.y,MapContainer.ins().focusTo(i.x,i.y);for(var n=this.getFollowersByMasterHandle(this.centerEntity.masterHandle),a=0,o=n;a<o.length;a++){var s=o[a];if(EntityType.isMeilin(s.entityType)||EntityType.isDamon(s.entityType)){s.AI.removePickItems();var r=MapContainer.ins().getNearestRandomXY(i);s.x=r.x,s.y=r.y,s.AI.stopAndStand(),s.AI.startFollow(this.centerEntity.handle,this.centerEntity.masterHandle)}}},e.prototype.atkedTarget=function(t,e,i,n,a){void 0===a&&(a=0);var o=this.getEntityByHandle(t);o&&MapContainer.ins().checkWalkableByPixel(e,i)&&(o.x=e,o.y=i)},e.prototype.patchEntityAlive=function(t){var e=t.readDouble(),i=t.readDouble(),n=this.getEntityByHandle(e);return n?(n.AI.startAlive(i),n.masterHandle!=Actor.ins().handle&&n.setHPBarVisible(!GFunc.isInCity())):console.log("想要复活的实体不存在"+e),n},e.prototype.patchChouhenList=function(t){for(var e=t.readUnsignedShort(),i=0;e>i;i++){var n=t.readDouble(),a=t.readDouble();this.centerEntity.AI.addChouhen(n,a)}},e.prototype.patchChouhenUpdate=function(t){var e=t.readByte(),i=t.readDouble(),n=t.readDouble();if(0==e?this.centerEntity.AI.delChouhen(i):this.centerEntity.AI.addChouhen(i,n),1==e){var a=this.getMainRoleByMasterHandle(i);if(a){var o="",s=FbSys.ins().fubenConfig.group;s==FbGroup.RedFortress||s==FbGroup.GuildWarPVP?o=Lang.scene_str34:s==FbGroup.BossHome&&(o=Lang.scene_str35),showTipsWarn(Lang.scene_str36.replace("$name$",""+a.getName()).replace("$dir$",""+o))}}},e.prototype.patchChouhenClear=function(t){this.centerEntity.AI.addChouhen(0)},e.prototype.sendAtkTarget=function(t){var e=this.getBytes(48);e.writeDouble(t),this.send(e)},e.prototype.sendCollectionEntity=function(t){var e=this.getBytes(55);e.writeDouble(t),this.send(e)},e.prototype.patchCaijiEntity=function(t){var e=t.readDouble(),i=t.readByte(),n=t.readInt();n=DateUtil.formatMiniDateTime(n);var a=t.readDouble(),o=this.getEntityByHandle(e);return this.updateCaijiInfo(o,i,n,a),[e,i,n,a]},e.prototype.updateCaijiInfo=function(t,i,n,a){t&&EntityType.isCaiJi(t.entityType)&&t.setCanBeCaiJi(0==i||1==i),a==Actor.ins().handle&&e.ins().centerEntity.setCaiJiing(2==i)},e.prototype.patchAllSysInit=function(t){if(RpFun.doAllSysInit(),ActSys.ins().openFirstActRankTipsWin(),ActSys.ins().openCZCBTipsWin(),RpSys.ins().isPatch=!0,RpSys.ins().patchRp(new RpDataUpdateAll),ChatSys.ins().sendChatFrame(),GFunc.isInGuaJiFb()&&VipSys.ins().sendVipRedpacketInfo(),this.isFirstRegister&&FbSys.ins().guajiData.challengeGuanId<=Cfg.GuajiFubenBossPosConfigMaxId()){ResMgr.addPreload(ResMgr.getEffFullName("bslx"));for(var e=Cfg.getSkillEditorConfig("10000")||[],i=0;i<e.length;i++){var n=e[i];2!=n.type&&ResMgr.addPreload(ResDir.RES_DIR_SKILLEFF+n.effectId+".png")}}PfActivitySys.ins().getRenZhengReward()},e.prototype.getNearestEnemyByAI=function(t){for(var e=null,i=Number.MAX_VALUE,n=0,a=this.entityList;n<a.length;n++){var o=a[n];if(t.isEnemy(o)&&o.canBeAtk()){var s=MathUtil.getDistanceX2ByObject(t.getEntity(),o);i>s&&(i=s,e=o)}}return e},e.prototype.getNearestMonsterByAI=function(t){for(var e=null,i=Number.MAX_VALUE,n=0,a=this.entityList;n<a.length;n++){var o=a[n];if(t.isEnemy(o)&&o.canBeAtk()&&EntityType.isMonster(o.entityType)){var s=MathUtil.getDistanceX2ByObject(t.getEntity(),o);i>s&&(i=s,e=o)}}return e},e.prototype.getNearestMonsterById=function(t,e){void 0===e&&(e=0);for(var i=null,n=Number.MAX_VALUE,a=0,o=this.entityList;a<o.length;a++){var s=o[a];if(s instanceof EntityMonster&&s.canBeAtk()&&(s.getCfgId()==e||0==e)){var r=MathUtil.getDistanceX2ByObject(t.getEntity(),s);n>r&&(n=r,i=s)}}return i},e.prototype.getNearestCaijiById=function(t,e){void 0===e&&(e=0);for(var i=null,n=Number.MAX_VALUE,a=0,o=this.entityList;a<o.length;a++){var s=o[a];if(EntityType.isCaiJi(s.entityType)&&s.isBeCaiJi()&&(s.getCfgId()==e||0==e)){var r=MathUtil.getDistanceX2ByObject(t,s);n>r&&(n=r,i=s)}}return i},e.prototype.getNearestEntity=function(t){for(var e=null,i=Number.MAX_VALUE,n=0,a=this.entityList;n<a.length;n++){var o=a[n];if(o!=t){var s=MathUtil.getDistanceX2ByObject(t,o);i>s&&(i=s,e=o)}}return e},e.prototype.getBossById=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.getCfgId()==t)return n}},e.prototype.atkTargetByHandle=function(t){var e=this.getEntityByHandle(t);if(e&&e.masterHandle&&this.sendAtkTarget(e.masterHandle),this.centerEntity.isAlive()){this.centerEntity.AI.resetTargetALL(),this.centerEntity.AI.addAtkHandle(t),this.centerEntity.AI.startAttack(e);var i=this.getYongbingByMasterHandle(this.centerEntity.masterHandle);i&&(i.AI.resetTargetALL(),i.AI.addAtkHandle(t),i.AI.startAttack(e))}this.setOnClickMovie(!1,null)},e.prototype.atkTargetByMasterHandle=function(t){if(t&&this.sendAtkTarget(t),this.centerEntity.isAlive()){var e=this.getMainRoleByMasterHandle(t);this.centerEntity.AI.addAtkMasterHandle(t),this.centerEntity.AI.startAttack(e);var i=this.getYongbingByMasterHandle(this.centerEntity.masterHandle);i&&(i.AI.resetTargetALL(),i.AI.addAtkMasterHandle(t),i.AI.startAttack(e))}this.setOnClickMovie(!1,null)},e.prototype.setCenterEntityGuaji=function(t){this.centerEntity.AI.setGuaji(t);var e=this.getYongbingByMasterHandle(this.centerEntity.masterHandle);e&&e.AI.setGuaji(t)},e.prototype.setActorEntitysVisible=function(t,e){for(var i=this.getEntitysByMasterHandle(t),n=0,a=i;n<a.length;n++){var o=a[n];o.visible=e}},e.prototype.sendPickUpItem=function(t){var e=this.getBytes(32);e.writeInt(t.item.handle),this.send(e)},e.prototype.doPickUpItem=function(t){var e=t.readInt(),i=t.readShort();0==i||1==i||3==i?this.pickUpItemHandle(e,i):2==i&&showtipsFail(Lang.scene_str37),this.patchPickUpItem()},e.prototype.pickUpItemHandle=function(t,e){for(var i=this.dropItems.length,n=0;i>n;n++){var a=this.dropItems[n];if(a.item.handle==t){0==e&&a.item.isMy&&GFunc.flyToBag(a.item.id,a,32,32),DisUtil.remove(a),this.dropItems.splice(n,1),ObjPool.push(a);break}}},e.prototype.patchPickUpItem=function(){},e.prototype.doCreatDropItem=function(t){var e=t.readInt(),i=t.readInt(),n=t.readString(),a=t.readInt();if(a){for(var o=[],s=0;a>s;s++){var r=new ItemDataDrop;r.parser(t),r.roleName=n,r.isMy=n==Actor.ins().myName||""==n,n==Actor.ins().myName&&(r.tick=Timer.ins().getTimer()+5e3),o.push(r)}this.doCreatDropItem1(e,i,o)}},e.prototype.doCreatDropItem1=function(t,e,i){for(var n=i.length,a=4*MapBase.CELL_SIZE,o=!1,s={},r=0;n>r;r++){var u=ObjPool.pop(EntityDropItem);if(0==r)u.x=t,u.y=e;else{var h=0;for(u.x=-1,u.y=-1;!MapContainer.ins().checkWalkableByPixel(u.x,u.y);){if(h>20){u.x=t,u.y=e;break}u.x=t+(Math.random()-.5)*a,u.y=e+(Math.random()-.5)*a,h++}}u.setData(i[r]),this.dropItems.push(u),MapContainer.ins().addDropTo(u),u.playDropMovie();var p=this.getMyYongbing();if(i[r].isMy){var l=void 0;l=this.centerEntity.isBianShenStatus()?this.centerEntity:i[r].id==Cfg.getConfig(EnumConfig).XUESE_DATIANSHI?this.centerEntity:null!=p?p:this.centerEntity,s[l.handle]=l;var c=new ItemPick;c.handle=i[r].handle,c.x=u.x,c.y=u.y,c.itemId=i[r].id,c.type=Cfg.getItemCfg(i[r].id).type,l.AI.addPickItem(c),u.pickerHandle=l.handle}o||Cfg.getItemCfg(i[r].id).type!=ItemType.ForgeItem||(o=!0)}for(var d in s){var l=s[d];l.AI.startPickItem()}o&&SoundUtil.play("egem_wav")},e.prototype.getDropItemCount=function(){return this.dropItems.length},e.prototype.getDropIsItem=function(){for(var t=this.dropItems.length,e=0;t>e;e++){if(GFunc.isCur(this.dropItems[e].item.id))return!0;if(!GFunc.isCur(this.dropItems[e].item.id)){var i=Cfg.getItemCfg(this.dropItems[e].item.id);if(!ItemType.isEquip(i.type))return!0}}return!1},e.prototype.clearAllDropItems=function(){for(var t=0;t<this.dropItems.length;t++){var e=this.dropItems[t];DisUtil.remove(e),ObjPool.push(e)}this.dropItems.length=0},e.prototype.canItemPick=function(t){return BagSys.ins().getSurplusCount()>0||GFunc.isCur(t.item.id)||!ItemType.isEquip(Cfg.getItemCfg(t.item.id).type)&&0==t.hasPicked?!0:!1},e.prototype.getNeedBagCount=function(t){return GFunc.isCur(t.item.id)||!ItemType.isEquip(Cfg.getItemCfg(t.item.id).type)?0:1},e.prototype.getItemList=function(){return this.dropItems},e.prototype.getItemByHandle=function(t){for(var e=0,i=this.dropItems;e<i.length;e++){var n=i[e];if(n.item.handle==t)return n}return null},e.prototype.doCurrencyInit=function(t){for(var e=t.readByte(),i=0;e>i;i++){var n=t.readShort(),a=t.readDouble();this.patchCurrency(n,a),RpFun.updateCurrency(n,PCode.UPD)}},e.prototype.doCurrencyChange=function(t){var e=t.readShort(),i=t.readDouble(),n=t.readByte(),a=Actor.ins().getCurrency(e),o=i-a;this.patchCurrency(e,i);var s=o>=0?PCode.ADD:PCode.DEL;if(RpFun.updateCurrency(e,s),s==PCode.ADD&&o>0&&0==n){var r=Cfg.getItemCfg(e);TipsSys.ins().showtipsNew(r.getName()+" +"+GFunc.overLength(o),GConst.PZColor[r.quality])}},e.prototype.patchCurrency=function(t,e){return Actor.ins().setCurrency(t,e),new CurrencyData(t,e)},e.prototype.doExp=function(t){var e=this,i=Actor.ins().level,n=t.readInt();Actor.ins().level=n;var a=Actor.ins().exp,o=t.readDouble();Actor.ins().exp=o;var s=t.readDouble();Actor.ins().totalexp=t.readDouble();var r=(t.readByte(),t.readShort());if(a!=o&&this.patchExpChange(),i!=Actor.ins().level){window.platform.reportLevelup();var u=Actor.ins().level-i;if(u>=2){var h=new RoleUpLevelTipsWin;h.x=LayerMgr.Tips.width/2-h.width/2,h.bottom=350,h.alpha=0,h.open(u);var p=egret.Tween.get(h);p.to({y:320,alpha:1},300).wait(350).to({alpha:0},300).call(function(){DisUtil.remove(h)}),LayerMgr.Tips.addChild(h)}else this.centerEntity&&this.centerEntity.addEffect(getEffName("jssj"));0==i&&Actor.ins().level<=400&&ResUtil.ins().loadGroup("preloadSound",function(){},null,null),this.patchLevelChange(),RpFun.updateLevel(PCode.UPD)}if(GFunc.isCurExpFb()&&this.centerEntity){var l=Timer.ins().getTimer()-this.nextExpTick;l>0?(SkillSys.ins().showExp(s,r,this.centerEntity),this.nextExpTick=Timer.ins().getTimer()+300):(l=-l,1500>l&&(Timer.ins()["do"](l,0,1,function(){SkillSys.ins().showExp(s,r,e.centerEntity)},this),this.nextExpTick+=300))}},e.prototype.patchLvExp=function(t){},e.prototype.patchLevelChange=function(){},e.prototype.patchExpChange=function(){},e.prototype.patchNameChange=function(){},e.prototype.patchPowerChange=function(){},e.prototype.patchSubRoleAtt=function(t){var e=Actor.ins().attrData.getAttTotles();Actor.ins().attrData.parserAtt(t);var i=Actor.ins().power,n=t.readDouble();Actor.ins().attrData.parserAttAdd(t);t.readDouble();Actor.ins().power=n,i!=n&&(openWin(PowerUpWin,i,n),this.patchPowerChange()),n>i&&RpFun.showActRp(SysId.QMKH);var a=Actor.ins().attrData.getAttTotles();this.showRoleAttrChang(a,e);var o=this.getMainRoleByMasterHandle(Actor.ins().handle);o&&(o.setProps(a),o.setProp(AttrType.atShenYouShieldTagNum,o.getProp(AttrType.atShenYouShieldTagNum)))},e.prototype.showRoleAttrChang=function(t,e){var i=[],n=t.length,a=!1;t[AttrType.atAtkLvl]&&(a=e[AttrType.atAtkLvl]?t[AttrType.atAtkLvl]>e[AttrType.atAtkLvl]:!0);for(var o=[],s=0;n>s;s++)if((!a||s!=AttrType.atAtkMin&&s!=AttrType.atAtkMax)&&1==Cfg.getConfig(AttrPowerConfig,s).isShowChang){var r=t[s],u=e[s];if(r>0){var h=new AttrData(s,r);if(u>0){if(!(r-u>=1))continue;h.value=r-u}o.push(h)}}o.length&&TipsSys.ins().showAttrAddTips(o),i.length>0&&(isShowWin(MainUITipsPower2)?getWin(MainUITipsPower2).addAttrData(i):openWin(MainUITipsPower2,i))},e.prototype.patchMainRoleTargetChange=function(t){return t},e.prototype.patchMainRoleTargetMasterChange=function(t){return t},e.prototype.getRangeEnemenys=function(t,e,i,n,a){void 0===i&&(i=0),void 0===a&&(a=Number.MAX_VALUE);for(var o=[],s=MapBase.CELL_SIZE,r=Math.floor(e.x/s),u=Math.floor(e.y/s),h=Math.max(r-i,0)*s,p=Math.max(u-i,0)*s,l=(r+i+1)*s,c=(u+i+1)*s,d=0,g=n;d<g.length;d++){var y=g[d];if(o.length>=a)break;y.x>h&&y.y>p&&y.x<l&&y.y<c&&o.push(y)}return o},e.prototype.getRectEnemenys=function(t,e,i,n,a,o){void 0===o&&(o=Number.MAX_VALUE);for(var s=[],r=i*MapBase.CELL_SIZE,u=e.x-t.x,h=e.y-t.y,p=Math.atan2(h,u),l=n*MapBase.CELL_SIZE/2,c=0,d=a;c<d.length;c++){var g=d[c];if(s.length>=o)break;var y=g.x-t.x,f=g.y-t.y,m=Math.abs(Math.atan2(f,y)-p),v=y*y+f*f,S=Math.cos(m),C=Math.sin(m);(m<=Math.PI/2||m>=3*Math.PI/2)&&r*r>=S*S*v&&l*l>=C*C*v&&s.push(g)}return s},e.prototype.getFanshapedEnemenys=function(t,e,i,n,a,o){void 0===o&&(o=Number.MAX_VALUE);var s,r,u,h,p=[],l=MapBase.CELL_SIZE,c=i*l*i*l,d=n*Math.PI/180/2;s=e.x-t.x,u=e.y-t.y;for(var g=0,y=a;g<y.length;g++){var f=y[g];r=f.x-t.x,h=f.y-t.y;var m=r*r+h*h,v=Math.abs(Math.atan2(u,s)-Math.atan2(h,r));if(c>m&&d>v&&p.push(f),p.length>=o)break}return p},e.prototype.doChatBubble=function(t){var e=t.readDouble(),i=t.readString(),n=this.getEntityByHandle(e);n&&n.setBubble(i)},e.prototype.doLvAttr=function(t){var e=(t.readShort(),t.readByte());JobSys.ins().roleUpLvAttr.length=0;for(var i=0;e>i;i++){var n=new AttrData;n.type=t.readByte(),n.value=t.readInt(),n.value>0&&JobSys.ins().roleUpLvAttr.push(n)}openWin(MainUITipsPower)},e.prototype.patchOtherActor=function(t){var e=t.readByte(),i=t.readInt();t.position-=4,0==i?showTipsWarn(Lang.scene_str38):(Actor.ins().seePlayModel=new SeePlayModel,Actor.ins().seePlayModel.parser(t),e==SeeActorType.See&&openWin(OtherRoleWin))},e.prototype.sentOtherActor=function(t,e){if(void 0===e&&(e=SeeActorType.See),GFunc.isKuaFu())return void showtipsFail(Lang.fb_str260);var i=this.getBytes(16);i.writeInt(t),i.writeByte(e),this.send(i)},e.prototype.doFirstRegister=function(t){this.isFirstRegister=!0,!urlParam.isShenhe&&openWin(VipLoginWin)},e.prototype.doDieNotice=function(t){},e.prototype.doGuildChange=function(t){GuildSys.ins().setGuild(t.readInt(),t.readString()),GuildSys.ins().setOffice(GuildOffice.MEMBER),Actor.ins().setCurrency(CurType.fuildfund,0),RpFun.showGuildSiegeRedPoint(),RpFun.guildUpLvRedPoint(PCode.DEL)},e.prototype.sendRename=function(t){var e=this.getBytes(22);e.writeString(t),this.send(e)},e.prototype.doRename=function(t){var e=t.readByte();0==e?(Socket.ins().close(),closeWin(RoleEditorNameWin),GameLogin.ins().showErrorWin(Lang.gmk_str4)):GameLogin.ins().showServerError(e)},e.prototype.sendChangeAttrPoint=function(t){var e=this.getBytes(25);e.writeDouble(t),this.send(e)},e.prototype.sendSaveGuide=function(t,e){var i=this.getBytes(19);i.writeByte(t),i.writeByte(e),i.writeInt(0),this.send(i)},e.prototype.doServerTime=function(t){var e=t.readUnsignedInt();Actor.ins().setServerTime(e)},e.prototype.patchGetOpenServer=function(t){Actor.ins().serverOpenDay=t.readInt();var e=t.readInt();Actor.ins().serverOpenTimer=DateUtil.formatMiniDateTime(e)},e.prototype.patchHefuTimer=function(t){Actor.ins().serverHefuTimer=DateUtil.formatMiniDateTime(t.readInt())},e.prototype.patchEntityProp=function(t){var e=t.readDouble(),i=t.readShort(),n=t.readDouble(),a=this.getEntityByHandle(e);if(a){var o=a.getProp(i);a.setProp(i,n),o!=n&&i==AttrType.atMvSpeed&&o>n&&a.stopSpeedShadow()}},e.prototype.updateIsShowWing=function(){for(var t=0,e=this.entityList;t<e.length;t++){var i=e[t];this.updateEntityIsShowWing(i)}},e.prototype.updateEntityIsShowWing=function(t){var e=t.masterHandle!=Actor.ins().handle&&EntityType.isRole(t.entityType)&&!getLocation(LocationKey.ISSHOWOTHERWING,LocationValue.Boolean);t.setWingVisible(!e)},e.prototype.onSocketClose=function(){this.firstCreateMap=!0},e.prototype.test=function(t){t==KeyboardUtil.SPACE&&(this.centerEntity&&(this.count%2!=0?(this.centerEntity.isAlive()&&(this.centerEntity.AI.stopAndStand(),this.centerEntity.AI.startAttack()),MapContainer.ins().touchChildren=MapContainer.ins().touchEnabled=!1):(this.centerEntity.isAlive()&&(this.centerEntity.AI.stopAndStand(),this.centerEntity.AI.startNone()),MapContainer.ins().touchChildren=MapContainer.ins().touchEnabled=!0)),this.count++)},e.prototype.updateIsShowHuDun=function(){for(var t=0,e=this.entityList;t<e.length;t++){var i=e[t];EntityType.isMainRole(i.entityType)&&i.updateHuDun()}},e.prototype.getEntityMasterHandleListByTeamId=function(){for(var t=[],e=0,i=this.entityList;e<i.length;e++){var n=i[e];EntityType.isMainRole(n.entityType)&&n.isAlive()&&-1==t.indexOf(n.masterHandle)&&n.teamId!=this.centerEntity.teamId&&t.push(n.masterHandle)}return t},e.prototype.setEntityNPCByRank=function(t,e){for(var i=0,n=this.entityList;i<n.length;i++){var a=n[i];a instanceof EntityNPC&&a.getCfgId()==t&&(e.configID=t,a.setData(e),a.setName(e.entityName,16767075,20))}},e.prototype.resetShowList=function(){for(var t in this.showMasterHandles)for(var e=this.getEntitysByMasterHandle(+t),i=0,n=e;i<n.length;i++){var a=n[i];a.setBodyVisible(!1)}this.showMasterHandles={}},__decorate([callDelay()],e.prototype,"showRoleAttrChang",null),e}(BaseSys);__reflect(LogicSys.prototype,"LogicSys"),SystemMap.LogicSys=LogicSys.ins.bind(LogicSys),window.LogicSys=LogicSys;var RuleIconMgr=function(t){function e(){var e=t.call(this)||this;return e.ruleIcons={},e.funAlls=[],e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.iniRule=function(){var t=LogicSys.ins().patchLevelChange,e=ActSys.ins(),i=e.patchActivityIsGetAwards,n=RechargeActSys.ins(),a=n.patchFirstRecharge,o=VipSys.ins(),s=PfActivitySys.ins(),r=FbSys.ins();this.addFunc(ActivityIconRule,[t]),this.addFunc(Activity12IconRule,[t]),this.addFunc(Activity21IconRule,[t]),this.addFunc(Activity24IconRule,[t]),this.addFunc(FuLiIconRule,[t,FuLiSys.ins().patchSigninInfo]),this.addFunc(ActKFLCIconRule,[i]),this.addFunc(ActCSKRule,[i]),this.addFunc(ActYYHLIconRule,[i]),this.addFunc(ActQMKHIconRule,[i]),this.addFunc(BBFLIconRule,[n.patchBBFLInfo,n.patchBBFLReward,n.patchBBFLBuy]),this.addFunc(FirstRechargeIconRule,[t,a]),this.addFunc(FirstRechargeTimerIconRule,[t,a]),this.addFunc(FirstRechargeEveryDayIconRule,[n.patchInitRechargeEveryday,n.patchUpdateRecharge,o.patchVipInit,t,i,a,o.patchSVipAwardstate]),this.addFunc(RechargeYiYuanIconRule,[n.patchYiYuanReceived,n.patchYiYuanData]),this.addFunc(LoginAwardIconRule,[e.patchLoginAwardData,t]),this.addFunc(KeFuRule,[s.patchKeFuStatus]),this.addFunc(FxylRule,[s.patchFxOpen,s.patchFxInfo]),this.addFunc(GzhlRule,[s.patchGuanZhuState,s.patchGuanZhuGift]),this.addFunc(SmrzRule,[s.patchRenZhengStatus,s.patchRenZhengRewardData]),this.addFunc(SmrzApiRule,[s.updateVerifyApi]),this.addFunc(QiYueRule,[TaskSys.ins().patchAgreementData,TaskSys.ins().patchAgreementUpdate]),this.addFunc(ZhuanZhiRule,[t]),this.addFunc(RedFortRule,[r.patchRedFortInfo]),this.addFunc(ActivityHefuIconRule,[t,i]),this.addFunc(ActivityJueZhanIconRule,[t,i]),this.addFunc(DailyWanFaRule,[TaskSys.ins().patchLiLianTaskUpdate,TaskSys.ins().patchLiLianReceiveTaskReward,TaskSys.ins().patchLiLianReceiveDailyReward]),this.addFunc(ZhaoCaiLongRule,[a,RechargePowerSys.ins().patchZhaoCaiLongDate,RechargePowerSys.ins().patchhaoCaiLongBuy]),this.addFunc(XunZhangRule,[a,RechargePowerSys.ins().patchXunZhangDate,RechargePowerSys.ins().patchXunZhangBuy]),this.addFunc(ShengbeiRule,[a,RechargePowerSys.ins().patchShengbeiState,RechargePowerSys.ins().patchhaoCaiLongBuy,RechargePowerSys.ins().patchXunZhangBuy,t]),this.addFunc(FuBenRule,[t]),this.addFunc(YkRule,[n.patchGetMonthDay]),this.addFunc(ZZTQRule,[n.patchZZTQ]),this.addFunc(YYMSRule,[n.patchYYMS]),this.addFunc(SVIPMSRule,[n.patchSVIPMS,a,o.patchSvipLvChange]),this.addFunc(XunBaoRule,[XunBaoSys.ins().patchAddItem,XunBaoSys.ins().patchDeleteItem,XunBaoSys.ins().patchXunBaoRemind,XunBaoSys.ins().patchXunBaoDuiHuan,XunBaoSys.ins().patchXunBaoChouJiang]),this.addFunc(ZeroBuyRule,[n.patchZeroBuyGetAward]),this.addFunc(YZZHRule,[n.patchYZZHData]),this.addFunc(ZhuzaiRule,[r.patchZhuZaiFubenData]),this.addFunc(YdssRule,[e.patchActivityPanel,e.doRewardResult]),this.addFunc(XJHBRule,[o.vipRedpacketInfoBack]),this.addFunc(CollectionRule,[WxYqhlSys.ins().patchCollectionReward]),this.addFunc(WxYqhlRule,[WxYqhlSys.ins().patchTaskInfo,WxYqhlSys.ins().patchTaskUp,WxYqhlSys.ins().patchTaskGroup]),this.addFunc(QmdbRule,[r.patchQmdbActState,r.patchQmdbInfo]),this.addFunc(HwbzRule,[DartSys.ins().patchInfo,DartSys.ins().patchRefreshCar,DartSys.ins().patchUpdateCar]),this.addFunc(GuildBattleRule,[GuildBattleSys.ins().patchTimeInfo,GuildBattleSys.ins().patchState]),this.addFunc(ShouquanRule,[s.patchuserInfoBtn]),this.addFunc(TaQingFirstRechargeRule,[i,e.patchMeiRi60]),this.addFunc(Activity23IconRule,[i,e.patchMeiRi60]),this.addFunc(ActHFSYRule,[i]),this.addFunc(Activity15IconRule,[i]),this.addFunc(GuZhanRule,[r.patchguZhanModeUpdate]),this.addLsn(RpSys.ins().patchRp,this.updateRedPoint),this.addLsn(JobSys.ins().patchSysOpen,this.showRule),this.addLsn(LogicSys.ins().patchAllSysInit,this.allSysInit),this.addLsn(LogicSys.ins().patchNewDayBegin,this.allSysInit),this.addLsn(r.patchGuaJiChallenge,this.updateAllRuleSys),this.addLsn(LogicSys.ins().patchEnterMap,this.updateAllRuleSys),this.addLsn(r.patchGuaJiHelp,this.updateAllRuleSys),LayerMgr.getStage().addEventListener(eui.UIEvent.RESIZE,this.onUpdateResize,this),Timer.ins()["do"](0,1e3,0,this.updateTimeBtn,this,TimerType.LAST);for(var u in this.ruleIcons){var h=this.ruleIcons[u];h&&h.update()}},e.prototype.addFunc=function(t,e){for(var i=0;i<e.length;i++){var n=e[i],a=n.bindFuncName;if(this.funAlls[a]){var o=this.funAlls[a];o.push(egret.getQualifiedClassName(t))}else this.funAlls[a]=[egret.getQualifiedClassName(t)],this.addLsn(n,this.updateFunAllRule)}},e.prototype.onUpdateResize=function(){for(var t in this.ruleIcons){var e=this.ruleIcons[t];e.updateMcPoint()}},e.prototype.updateFunAllRule=function(){var t=this.funAlls[arguments.callee.callFuncName];for(var e in this.ruleIcons){var i=this.ruleIcons[e];i&&t.indexOf(egret.getQualifiedClassName(i))>=0&&i.updateSys()}},e.prototype.updateAllRuleSys=function(){for(var t in this.ruleIcons){var e=this.ruleIcons[t];e&&e.updateSys()}},e.prototype.updateRedPoint=function(t){void 0===t&&(t=null);for(var e in this.ruleIcons){var i=this.ruleIcons[e];i&&i.updateRedPoint(t)}},e.prototype.updateMC=function(){for(var t in this.ruleIcons){var e=this.ruleIcons[t];e&&e.updateEff()}},e.prototype.allSysInit=function(){this.updateAllRuleSys(),this.updateRedPoint()},e.prototype.push=function(t){this.ruleIcons[t.tar.hashCode]=t},e.prototype.getRule=function(t){return this.ruleIcons[t.hashCode]},e.prototype.getRuleBySysid=function(t){for(var e in this.ruleIcons){var i=this.ruleIcons[e];if(i&&i.sysId==t)return i}return null},e.prototype.showRule=function(t){if(t!=SysId["default"]){var e=this.getRuleBySysid(t);e&&e.updateSys()}else this.updateAllRuleSys()},e.prototype.updateTimeBtn=function(){for(var t in this.ruleIcons){var e=this.ruleIcons[t];e&&e.updateTime()}this.updateTimerBtn()},e.prototype.updateTimerBtn=function(){var t,e=Number.MAX_VALUE;for(var i in this.ruleIcons){var n=this.ruleIcons[i],a=n.getOpenTick();e>a&&(e=a,t=n)}for(var i in this.ruleIcons)this.ruleIcons[i].setIsShow(this.ruleIcons[i]==t)},__decorate([callDelay(50)],e.prototype,"onUpdateResize",null),e}(BaseSys);__reflect(RuleIconMgr.prototype,"RuleIconMgr"),SystemMap.RuleIconMgr=RuleIconMgr.ins.bind(RuleIconMgr),window.RuleIconMgr=RuleIconMgr;var SettingSys=function(t){function e(){var e=t.call(this)||this;return e.addLsn(LogicSys.ins().patchActorInfo,e.initDef),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.initDef=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){return setLocationDef(LocationKey.shake,"true"),setLocationDef(LocationKey.ISSHOWTHEREFF,"false"),setLocationDef(LocationKey.ISSHOWHIT,"true"),setLocationDef(LocationKey.ISSHOWOTHERWING,"false",function(t){LogicSys.ins().updateIsShowWing()}),setLocationDef(LocationKey.SOUND,"true",function(t){SoundUtil.enable="true"===t}),t=Cfg.getConfig(GlobalConfig),e=t.liuhaiPfids.indexOf(+urlParam.apptype)>=0,e||(e=t.liuhaiAppids.indexOf(+urlParam.appid)>=0),setLocationDef(LocationKey.SETLIUHAI,e+"",function(t){LayerMgr.setLiuhai()}),setLocationDef(LocationKey.ISSHOWHUDUN,"true",function(t){LogicSys.ins().updateIsShowHuDun()}),[2]})})},e}(BaseSys);__reflect(SettingSys.prototype,"SettingSys"),SystemMap.SettingSys=SettingSys.ins.bind(SettingSys),window.SettingSys=SettingSys;var VirtualServer=function(t){function e(){var i=t.call(this)||this;return i.handleCounter=0,i.aliveTimes=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],i.buffs=[],i.monsters=[],i.refreshState=e.REFRSH_MONSTER,i.isRefreshBoss=!1,i.prevIndex=[],i.monsterRsfCount=0,i}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.getHandle=function(){return this.handleCounter>e.MAX_HANDLE&&(this.handleCounter=0),++this.handleCounter},e.prototype.sendUseSkill=function(t,e,i,n){var a=LogicSys.ins().getEntityByHandle(t),o=LogicSys.ins().getEntityByHandle(i);if(a&&o&&!o.isDead()){var s=(ObjPool.pop(SkillDamageData),n.skillConfig);if(s.targetType==TargetType.Enemy){var r=s.affectRange,u=[];if(0==r)s.calcType==CalcType.Enemy&&u.push(o);else{var h=LogicSys.ins().getAliveEnemysByAI(a.AI),p=h.indexOf(o);if(-1!=p&&(h=h.splice(p,1).concat(h)),s.wide)u=LogicSys.ins().getRectEnemenys(a,o,r,s.wide,h,s.affectCount);else if(s.angle)u=LogicSys.ins().getFanshapedEnemenys(a,o,r,s.angle,h,s.affectCount);else{var l=LogicSys.ins().getEntityByHandle(e);u=LogicSys.ins().getRangeEnemenys(a,l,r,h,s.affectCount)}}this.doSkill(a,o,u,n)}}},e.prototype.doSkill=function(t,e,i,n){for(var a=[],o=n.skillConfig,s=0;s<i.length;s++){var r=ObjPool.pop(Damage);this.calDamage(t,i[s],n,r),a[s]=r}var u=ObjPool.pop(SkillDamageData);this.writeSkillDamageData(t,e,o,a,u),SkillSys.ins().doSkillResultByData(u);for(var h=!1,s=0;s<i.length;s++){var p=i[s],r=a[s];if(p.setProp(AttrType.atHp,Math.max(p.getHP()+r.value,0)),h=t.isDead(),r.fs&&t.setProp(AttrType.atHp,Math.max(t.getHP()+r.fs,0)),t.isDead()&&!h&&this.doEntityDie(t,p,0),p.isDead())this.doEntityDie(p,t,o.id);else if(p instanceof EntityMonster&&!p.isDead()&&r.damageType!=DamageTypes.MISS&&r.damageType!=DamageTypes.FS&&o.repelDistance){var l=DirUtil.get8Dir(p,t),c=DirUtil.getGridByDir(l,o.repelDistance/MapBase.CELL_SIZE,p),d=100;MapContainer.ins().checkWalkableByPixel(c.x,c.y)&&LogicSys.ins().atkedTarget(p.handle,c.x,c.y,d,t.handle)}ObjPool.push(r)}},e.prototype.doEntityDie=function(t,e,i){t instanceof EntityMonster?(LogicSys.ins().doCreatDropItem1(t.x,t.y,t.getDropItems()),0==LogicSys.ins().getEntityAliveCountByName(egret.getQualifiedClassName(EntityMonster))&&this.creatMonster()):t.masterHandle==Actor.ins().handle&&(this.aliveTimes[t.index]=Timer.ins().getTimer()+3),LogicSys.ins().patchEntityDie(t,e,i)},e.prototype.calDamage=function(t,e,i,n){var a=t.getAttributes(),o=e.getAttributes(),s=0,r=!1,u=0,h=this.getValue(o,AttrType.atDef),p=DamageTypes.HIT,l=!1,c=!1,d=!1,g=!1,y=!1,f=!1;if(a[AttrType.atWSYJ]&&(l=MathUtil.randomInteger(1,1e4)<=a[AttrType.atWSYJ],l&&(h=0,r=!0)),!l){var m=MathUtil.randomInteger(1,1e4),v=this.getValue(a,AttrType.atAtkSuc),S=this.getValue(o,AttrType.atDefSuc),C=Math.max(v-S+9500,2500);r=C>m}if(r=!0){if(c=this.getValue(a,AttrType.atHXYJ)>=MathUtil.randomInteger(1,1e4))u=this.getValue(a,AttrType.atAtkMax);else{var b=this.getValue(a,AttrType.atAtkMin),I=this.getValue(a,AttrType.atAtkMax);u=MathUtil.randomInteger(b,I)}var D=0,w=0;s=u>2*h?u-h:.6*u-.2*h,s=(s*D+w+this.getValue(a,AttrType.atAtkExtra)-this.getValue(o,AttrType.atReduceAtk))*(1+(this.getValue(a,AttrType.atDamagePer)-this.getValue(o,AttrType.atReductionPer))/1e4),d=this.getValue(a,AttrType.atZYYJ)>=MathUtil.randomInteger(1,1e4),d&&(s*=1.2),g=this.getValue(a,AttrType.atSSYJ)>=MathUtil.randomInteger(1,1e4),y=this.getValue(a,AttrType.atTSYJ)>=MathUtil.randomInteger(1,1e4),f=this.getValue(a,AttrType.atZMYJ)>=MathUtil.randomInteger(1,1e4),g?s*=3:y?s*=2.5:f&&(s*=2);var T=this.getValue(o,AttrType.atReflex),_=s*T/1e4;l?p=DamageTypes.WSYJ:f?p=DamageTypes.ZMYJ:d?p=DamageTypes.ZYYJ:c&&(p=DamageTypes.HXYJ),n.value=-Math.max(s>>0,1),T>0?n.fs=-Math.max(Math.floor(_),1):n.fs=0}else p=DamageTypes.MISS;return n.damageType=p,n.senderHandle=t.handle,n.targetHandle=e.handle,n.skillId=i.skillConfig.id,n.selfAtk=u,n},e.prototype.getValue=function(t,e){return t[e]?t[e]:0},e.prototype.writeSkillDamageData=function(t,e,i,n,a){a.senderHandle=t.handle,a.targetHandle=e.handle,a.skillId=i.id,a.isMyDamage=t.masterHandle==Actor.ins().handle;for(var o=0,s=n;o<s.length;o++){var r=s[o],u=ObjPool.pop(SkillDamageRange);u.handle=r.targetHandle,u.damageType=r.damageType,u.senderType=t.isBianShenStatus()?1:0,u.value=r.value,u.senderPos.x=t.x,u.senderPos.y=t.y;var h=LogicSys.ins().getEntityByHandle(r.targetHandle);if(u.targetPos.x=h.x,u.targetPos.y=h.y,a.skillDamageRanges.push(u),r.fs){var p=ObjPool.pop(SkillDamageRange);p.handle=r.senderHandle,p.damageType=DamageTypes.FS,p.value=r.fs,p.senderPos.x=h.x,p.senderPos.y=h.y,p.targetPos.x=t.x,p.targetPos.y=t.y,a.skillDamageRanges.push(p)}}},e.prototype.restart=function(){this.stop(),this.isRefreshBoss?(this.setRefreshState(e.REFRSH_BOSS),this.isRefreshBoss=!1):this.startCheckAlive(),this.startRefreshMonster(),this.startBuff()},e.prototype.stop=function(){Timer.ins().remove(this.creatMonster,this),Timer.ins().remove(this.checkRoleAlive,this),Timer.ins().remove(this.checkBuff,this),this.monsters.length=0,this.setRefreshState(e.REFRSH_MONSTER),this.clearBuff()},e.prototype.setRefreshState=function(t){this.refreshState!=t&&(this.refreshState=t,this.refreshState==e.REFRSH_BOSS?this.addLsn(LogicSys.ins().patchEntityDie,this.onEntityDie):this.removeLsn(LogicSys.ins().patchEntityDie,this.onEntityDie))},e.prototype.setIsrefreshBoss=function(t){this.isRefreshBoss=t},e.prototype.onEntityDie=function(t){t instanceof EntityRole?LogicSys.ins().centerEntity.isDead()&&(LogicSys.ins().removeEntityByHandle(this.boss.handle),this.boss.hasRefresh=!1,this.restart()):t.entityType==EntityType.MONSTER_CLIENT&&this.boss&&t.handle==this.boss.handle&&(this.restart(),this.boss=null)},e.prototype.startCheckAlive=function(){for(var t=0;t<this.aliveTimes.length;t++)this.aliveTimes[t]=Number.MAX_VALUE;
Timer.ins()["do"](5e3,5e3,0,this.checkRoleAlive,this)},e.prototype.checkRoleAlive=function(){},e.prototype.startBuff=function(){},e.prototype.clearBuff=function(){this.buffs.length=0,Timer.ins().remove(this.checkBuff,this)},e.prototype.checkBuff=function(){},e.prototype.startRefreshMonster=function(){var t=FbSys.ins().refreshConfig;Timer.ins()["do"](0,1e3*t.refreshTime,0,this.creatMonster,this)},e.prototype.creatMonster=function(t){if(void 0===t&&(t=0),this.refreshState==e.REFRSH_MONSTER){var i=egret.getQualifiedClassName(EntityMonster),n=LogicSys.ins().getEntityAliveCountByName(i),a=(FbSys.ins().fbId,FbSys.ins().refreshConfig),o=a.minCount,s=a.maxCount;this.hasInsertMonster()&&(o+=5,s+=5);var r=t||s-n;if(r=r>7?7:r,o>=n){var u=this.spliceMonsterData(r);this.refreshMonsters(u)}this.monsters.length<=10&&FbSys.ins().sendCreatMonsters()}else if(this.refreshState==e.REFRSH_BOSS&&this.boss&&!this.boss.hasRefresh){for(var h=LogicSys.ins().getEntityList(),p=!1,l=0,c=h;l<c.length;l++){var d=c[l];if(d instanceof EntityMonster&&!d.isDead()){p=!0;break}}p||(this.refreshMonsters([this.boss]),this.boss.hasRefresh=!0)}},e.prototype.refreshMonsters=function(t){if(this.monsterRsfCount+=t.length,this.monsterRsfCount>20&&(this.monsterRsfCount=0,t.length>0)){var e=Cfg.getMonstersConfigNew(t[0].id),i=Cfg.getConfig(MonsterModelConfig,e.avatar[0]);SoundUtil.play(i.atkedSound)}for(var n=FbSys.ins().fbId,a=Cfg.getConfig(FubenConfig,n),o=FbSys.ins().refreshConfig,s=MapBase.CELL_SIZE,r=[];r.length<1;){var u=MathUtil.randomInteger(0,o.position.length-1);-1==r.indexOf(u)&&-1==this.prevIndex.indexOf(u)&&r.push(u)}this.prevIndex=r;for(var h=[],p=0;p<r.length;p++)h[p]=o.position[r[p]];for(var p=0;p<t.length;p++){var l=Math.floor(p/(t.length/h.length)),c=t[p],d=LogicSys.ins().createEntityByType(EntityType.MONSTER_CLIENT);d.handle=c.handle;var g=new EntityGatherMonsterData;g.configID=c.id,d.setData(g);for(var y=new XY(1e6,1e6),f=0;!MapContainer.ins().checkWalkableByPixel(y.x,y.y);)if(y.x=h[l].x*s+MathUtil.randomInteger(2.5*-s,2.5*s),y.y=h[l].y*s+MathUtil.randomInteger(2.5*-s,2.5*s),f++,f>100){console.log("副本id:"+a.fbid+"配置的刷怪点有误:("+h[l].x/MapBase.CELL_SIZE+","+h[l].y/MapBase.CELL_SIZE+")");break}d.x=y.x,d.y=y.y,d.setDropItem(c.dropItem),d.setAI(new AIMonsterClient),d.AI.start(),d.AI.startPatrol(d.x,d.y);for(var m=Cfg.getAiConfigByMonsterId(d.getCfgId()),v=m.skills,S=[],C=0;C<v.length;C++){var b=new SkillData;b.skillId=v[C].id,b.level=1,S[C]=b}d.AI.setSkillData(S),LogicSys.ins().addEntity(d);var I=egret.Tween.get(d);d.alpha=.1,I.to({alpha:1},800)}},e.prototype.spliceMonsterData=function(t){return void 0===t&&(t=0),this.monsters.length?this.monsters.splice(0,t):[]},e.prototype.addBoss=function(t){this.boss=t},e.prototype.delBoss=function(){this.boss=null},e.prototype.hasBoss=function(){return null!=this.boss},e.prototype.addMonsters=function(t){this.monsters=this.monsters.concat(t)},e.prototype.insertMonsters=function(t){this.monsters=t.concat(this.monsters),this.creatMonster(5)},e.prototype.hasInsertMonster=function(){return this.monsters.length>0?this.monsters[0].isInsert:!1},e.MAX_HANDLE=1e5,e.REFRSH_MONSTER=0,e.REFRSH_BOSS=1,e}(BaseSys);__reflect(VirtualServer.prototype,"VirtualServer");var CalcType;!function(t){t[t.NoDamage=1]="NoDamage",t[t.Enemy=2]="Enemy",t[t.Self=3]="Self"}(CalcType||(CalcType={}));var Damage=function(){function t(){this.damageType=0,this.value=0,this.fs=0,this.senderHandle=0,this.targetHandle=0,this.skillId=0,this.selfAtk=0}return t.prototype.reset=function(){this.damageType=0,this.value=0,this.fs=0,this.senderHandle=0,this.targetHandle=0,this.skillId=0,this.selfAtk=0},t}();__reflect(Damage.prototype,"Damage"),window.VirtualServer=VirtualServer,window.Damage=Damage;var RankDataTXDJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=0,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.id=e.readDouble()},e.prototype.getRankStr=function(){var t=Cfg.getConfig(TouxianConfig,this.id);return Lang.rank_str17+"："+t.name+GFunc.getChineseNum(t.stage)+Lang.common_jie},e}(RankData);__reflect(RankDataTXDJ.prototype,"RankDataTXDJ"),window.RankDataTXDJ=RankDataTXDJ;var RankDataWanmo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.fbCount=e.readDouble()},e}(RankData);__reflect(RankDataWanmo.prototype,"RankDataWanmo"),window.RankDataWanmo=RankDataWanmo;var AIBossHome=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getNewTarget=function(){var t=this.getFirstAtkMasterTarget()||this.getFirstAtkTarget()||this.getMonsterIdTarget()||this.getCurTarget()||this.getNearestTarget();return t},e}(AIRole);__reflect(AIBossHome.prototype,"AIBossHome"),window.AIBossHome=AIBossHome;var AICampWarRole=function(t){function e(){var e=t.call(this)||this;return e.defaultEnemyType=[EntityType.ROLE,EntityType.ROLE_CLONE,EntityType.BIANSHEN,EntityType.CLONEBIANSHEN],e.enemyType=e.defaultEnemyType,e}return __extends(e,t),e.prototype.isEnemy=function(e){var i=t.prototype.isEnemy.call(this,e);return i},e}(AIRedFort);__reflect(AICampWarRole.prototype,"AICampWarRole");var AICampWarYongbing=function(t){function e(){var e=t.call(this)||this;return e.defaultEnemyType=[EntityType.ROLE,EntityType.ROLE_CLONE,EntityType.BIANSHEN,EntityType.CLONEBIANSHEN],e.enemyType=e.defaultEnemyType,e}return __extends(e,t),e}(AIYongbing);__reflect(AICampWarYongbing.prototype,"AICampWarYongbing");var RankDataWeiWang=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankData);__reflect(RankDataWeiWang.prototype,"RankDataWeiWang"),window.RankDataWeiWang=RankDataWeiWang;var AIGuildBattleRole=function(t){function e(){var e=t.call(this)||this;return e.defaultEnemyType=[EntityType.MONSTER_SERVER,EntityType.ROLE,EntityType.BIANSHEN],e.enemyType=e.defaultEnemyType,e}return __extends(e,t),e.prototype.isEnemy=function(e){var i=t.prototype.isEnemy.call(this,e);return i&&(i=this.entity.teamId!=e.teamId),i},e}(AIRedFort);__reflect(AIGuildBattleRole.prototype,"AIGuildBattleRole"),window.AIGuildBattleRole=AIGuildBattleRole;var AIGuildBattleYongbing=function(t){function e(){var e=t.call(this)||this;return e.defaultEnemyType=[EntityType.MONSTER_SERVER,EntityType.ROLE,EntityType.BIANSHEN],e.enemyType=e.defaultEnemyType,e}return __extends(e,t),e}(AIYongbing);__reflect(AIGuildBattleYongbing.prototype,"AIGuildBattleYongbing"),window.AIGuildBattleYongbing=AIGuildBattleYongbing;var AIGuildWarPVE=function(t){function e(){var e=t.call(this)||this;return e.enemyType=[EntityType.MONSTER_SERVER],e}return __extends(e,t),e}(AIRole);__reflect(AIGuildWarPVE.prototype,"AIGuildWarPVE"),window.AIGuildWarPVE=AIGuildWarPVE;var AIGuildWarPVP=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.startCaiJi=function(e){return t.prototype.startCaiJi.call(this,e),0==e?void(LogicSys.ins().centerEntity==this.entity&&LogicSys.ins().sendCollectionEntity(0)):void 0},e.prototype.CaiJi=function(){},e.prototype.startAttack=function(e){return void 0===e&&(e=null),this.params.caiJihandle?void(LogicSys.ins().centerEntity==this.entity&&openWin(WarnWin,Lang.scene_str1.replace("$str$",""+StrUtil.addColor(Lang.scene_str2,16758826)),function(){LogicSys.ins().sendCollectionEntity(0),LogicSys.ins().centerEntity.AI.startCaiJi(0),LogicSys.ins().centerEntity.AI.startAttack()},this)):void t.prototype.startAttack.call(this,e)},e.prototype.startAtked=function(e){GuildWarSys.ins().getModel().checkinAppoint(1)||this.params.caiJihandle>0||t.prototype.startAtked.call(this,e)},e.prototype.checkBianshen=function(){return GuildWarSys.ins().getModel().getIsBaJian()?(showTipsWarn(Lang.scene_str20),!1):t.prototype.checkBianshen.call(this)},e.prototype.canBianshen=function(){return!GuildWarSys.ins().getModel().getIsBaJian()&&t.prototype.canBianshen.call(this)},e}(AIRedFort);__reflect(AIGuildWarPVP.prototype,"AIGuildWarPVP"),window.AIGuildWarPVP=AIGuildWarPVP;var AIMainRole=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.None=function(){this.params.fbId==FbSys.ins().fbId&&this.MoveToXY()},e.prototype.stop=function(){this.nextActionTick=0},e.prototype.startfindNpc=function(t,e){if(t){var i=Cfg.getConfig(NPCConfig,t),n=new XY((i.pos.mapX+.5)*MapBase.CELL_SIZE,(i.pos.mapY+.5)*MapBase.CELL_SIZE),a=void 0;a=i.sceneId==FbSys.ins().mapId?MapContainer.ins().getNearestAroundXY(n,this.entity):n,e?this.startMoveToXY(a,i.fbId,e):this.startMoveToXY(a,i.fbId,function(){var t=Cfg.getWinClassById(i.npcEvent.winId);openWin(t,i.npcEvent.winTab,i.npcEvent.winTab1)})}},e.prototype.update=function(){return null==this.entity?!1:t.prototype.update.call(this)},e.prototype.destruct=function(){t.prototype.destruct.call(this),this.state=AIState.Stand},e}(AIRole);__reflect(AIMainRole.prototype,"AIMainRole"),window.AIMainRole=AIMainRole;var AIMeilin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getFollowXY=function(t){var e=DirUtil.get8Dir(this.entity,t),i=DirUtil.getGridByDir((e+8-1)%8,this.params.followDis/MapBase.CELL_SIZE,t);return i},e}(AIDamon);__reflect(AIMeilin.prototype,"AIMeilin"),window.AIMeilin=AIMeilin;var AIMine=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AIRole);__reflect(AIMine.prototype,"AIMine"),window.AIMine=AIMine;var RankDataWing=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankDataPower);__reflect(RankDataWing.prototype,"RankDataWing"),window.RankDataWing=RankDataWing;var AIMonsterClient=function(t){function e(){var e=t.call(this)||this;return e.nextPatrolTick=0,e.dialogue=[],e.bubbleTimer=0,e.indexs=[],e.aiTime=MathUtil.radom(400,600),e.enemyType=[EntityType.ROLE],e}return __extends(e,t),e.prototype.setBubble=function(t,e){void 0===e&&(e=10),"string"==typeof t?(this.dialogue=[t],this.indexs.length=0,this.entity.setBubble(t[0],e)):t instanceof Array&&(this.dialogue=t,this.indexs=GFunc.randomArr(t.length))},e.prototype.updateBubble=function(){this.dialogue.length>1&&(0==this.indexs.length&&(this.indexs=GFunc.randomArr(this.dialogue.length)),this.bubbleTimer<Timer.ins().getTimer()&&(this.bubbleTimer=Timer.ins().getTimer()+3e3,this.entity.setBubble(this.dialogue[this.indexs.pop()],0)))},e.prototype.update=function(){return this.updateBubble(),t.prototype.update.call(this)},e.prototype.Atk=function(){var t;if(this.params.targetHandle&&(t=LogicSys.ins().getEntityByHandle(this.params.targetHandle)),!t||t.isDead())return void this.Patrol();this.isOutOfRange()&&this.startReturnPatrol(),this.resetTargetHandle(t.handle),this.params.x=t.x,this.params.y=t.y;var e=this.getNextSkill();if(e)if(e&&GFunc.checkSkillDis(this.entity,new XY(this.params.x,this.params.y),e.skillConfig.castRange)){if(Timer.ins().getTimer()>e.skillCDTick){var i=e.skillConfig,n=this.getCastTargetHandle(i),a=Timer.ins().getTimer();this.playMyEntityAction(i,t,e.actionIndex),this.entity.entityType==EntityType.BIANSHEN&&e.skillId<500&&console.log("仙灵实体与仙术不匹配,仙术id:"+e.skillId),this.entity.entityType==EntityType.ROLE&&e.skillId>500&&console.log("角色实体与仙术不匹配,仙术id:"+e.skillId),i.actionParam?this.playActionMovie(i,e.actionIndex,t,this.useSkillComplete.bind(this,this.entity.handle,n,this.params.targetHandle,e,a),null,MapContainer.ins().isShow()):this.useSkillComplete(this.entity.handle,n,this.params.targetHandle,e,a)}}else this.isMoveing()||this.startMove(t)},e.prototype.getSkillCanUse=function(){for(var t=0;t<this.skillDatas.length;t++){var e=this.skillDatas[t];if(Timer.ins().getTimer()>e.skillCDTick)return e}return null},e.prototype.Patrol=function(){this.resetTargetHandle();var t=LogicSys.ins().getNearestEnemyByAI(this);if(t){var e=MathUtil.getDistanceX2ByObject(this.entity,t),i=Cfg.getAiConfigByMonsterId(this.entity.getCfgId());Math.pow(i.vision,2)>e?this.startAttack(t):this.radomMove()}else this.radomMove()},e.prototype.ReturnPatrol=function(){this.isMoveing()||this.startPatrol(this.params.homeX,this.params.homeY)},e.prototype.startReturnPatrol=function(){this.setAIState(AIState.ReturnPatrol),this.startMove(new XY(this.params.homeX,this.params.homeY))},e.prototype.radomMove=function(){if(Timer.ins().getTimer()>this.nextPatrolTick&&!this.isMoveing()){var t=this.getPointCanMove();t?(this.startMove(t),this.nextPatrolTick+=MathUtil.radom(5e3,1e4)):console.log("怪物刷新在错误的区域,请策划查询配置,副本id:"+FbSys.ins().fbId+"--刷怪坐标:"+(this.params.homeX/MapBase.CELL_SIZE).toFixed(1)+","+(this.params.homeY/MapBase.CELL_SIZE).toFixed(1))}},e.prototype.getPointCanMove=function(){for(var t,e=0,i=Cfg.getAiConfigByMonsterId(this.entity.getCfgId()),n=i.patrolRadius;100>e;){var a=MathUtil.radom(this.params.homeX-n>>0,this.params.homeX+n>>0),o=MathUtil.radom(this.params.homeY-n>>0,this.params.homeY+n>>0);if(MapContainer.ins().checkWalkableByPixel(a,o)){t=new XY,t.x=a,t.y=o;break}e++}return t},e.prototype.isOutOfRange=function(){var t=Cfg.getAiConfigByMonsterId(this.entity.getCfgId()),e=t.home_range,i=MathUtil.getDistanceX2ByObject(this.entity,new XY(this.params.homeX,this.params.homeY));return i>e*e},e.prototype.startPatrol=function(e,i){t.prototype.startPatrol.call(this,e,i),this.nextPatrolTick=Timer.ins().getTimer()+MathUtil.randomInteger(0,5e3)},e.prototype.startAtked=function(e){t.prototype.startAtked.call(this,e),this.setAIState(AIState.Atk)},e}(AIMonster);__reflect(AIMonsterClient.prototype,"AIMonsterClient"),window.AIMonsterClient=AIMonsterClient;var AIMonsterServer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getPath=function(t){return MapContainer.ins().getPath(t,this.entity,function(t,e){return!0})},e}(AIMonster);__reflect(AIMonsterServer.prototype,"AIMonsterServer"),window.AIMonsterServer=AIMonsterServer;var AINpc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(AIBase);__reflect(AINpc.prototype,"AINpc"),window.AINpc=AINpc;var AIPoltRobot=function(t){function e(){var e=t.call(this)||this;return e.enemyType=[EntityType.MONSTER_SERVER],e}return __extends(e,t),e.prototype.startTask=function(e,i,n,a){t.prototype.startTask.call(this,e,i,n,a)},e.prototype.startfindNpc=function(t,e){if(t){var i=Cfg.getConfig(NPCConfig,t),n=new XY((i.pos.mapX+.5)*MapBase.CELL_SIZE,(i.pos.mapY+.5)*MapBase.CELL_SIZE),a=MapContainer.ins().getNearestRandomXY(n);this.startMoveToXY(a,i.fbId,e)}},e.prototype.updateTaskValue=function(t){t==this.params.taskTager&&(this.params.taskValue+=1)},e.prototype.getNewTarget=function(){var t=this.getMonsterIdTarget();return t},e.prototype.updateSkillCd=function(t){},e.prototype.sendMoveEntity=function(t){},e}(AIRole);__reflect(AIPoltRobot.prototype,"AIPoltRobot"),window.AIPoltRobot=AIPoltRobot;var RankDataYongZheShiLian=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.ceng=e.readShort(),this.stage=e.readShort()},e}(RankData);__reflect(RankDataYongZheShiLian.prototype,"RankDataYongZheShiLian"),window.RankDataYongZheShiLian=RankDataYongZheShiLian;var RankDataZMZL=function(t){function e(){var e=t.call(this)||this;return e.guildName="",e.guildLv=0,e}return __extends(e,t),e.prototype.parser=function(t){this.rank=t.readShort(),this.guildName=t.readString(),this.guildLv=t.readDouble()},e.prototype.getRankName=function(){return this.guildName},e.prototype.getRankStr=function(){return""+Lang.common_str84+this.guildLv},e}(RankData);__reflect(RankDataZMZL.prototype,"RankDataZMZL"),window.RankDataZMZL=RankDataZMZL;var AIRoleJJC=function(t){function e(){var e=t.call(this)||this;return e.moveCd=0,e.enemyType=[EntityType.ROLE_CLONE,EntityType.CLONEBIANSHEN],e.aiTime=100,e}return __extends(e,t),e.prototype.setEntity=function(e){t.prototype.setEntity.call(this,e),this.entity.setDir(3)},e.prototype.getNewTarget=function(){var e;if(this.params.targetHandle){var i=LogicSys.ins().getEntityByHandle(this.params.targetHandle);i&&!i.isDead()&&(e=i)}if(!e)for(var n=LogicSys.ins().getEntityList(),a=JobConst.JobCount,o=0,s=n;o<s.length;o++){var r=s[o];if(this.isEnemy(r)&&r.canBeAtk()){var u=r.getJob();a>u&&(a=u,e=r)}}return e||(e=t.prototype.getNewTarget.call(this)),e},e.prototype.updateTick=function(e){t.prototype.updateTick.call(this,e),this.isMoveing()&&this.isAIState(AIState.Atk)&&this.moveCd<Timer.ins().getEgretTimer()&&(this.moveCd=1e3+Timer.ins().getEgretTimer(),LogicSys.ins().getEntityByHandle(this.params.targetHandle)||this.stopMove())},e}(AIRole);__reflect(AIRoleJJC.prototype,"AIRoleJJC"),window.AIRoleJJC=AIRoleJJC;var AIRoleJueWang=function(t){function e(){var e=t.call(this)||this;return e.enemyType=[EntityType.MONSTER_SERVER],e}return __extends(e,t),e}(AIRole);__reflect(AIRoleJueWang.prototype,"AIRoleJueWang"),window.AIRoleJueWang=AIRoleJueWang;var AIRoleKfBossSd=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getNewTarget=function(){return this.getFirstAtkMasterTarget()||this.getMonsterIdTarget()},e.prototype.canBianshen=function(){return this.getNewTarget()?t.prototype.canBianshen.call(this):!1},e}(AIRole);__reflect(AIRoleKfBossSd.prototype,"AIRoleKfBossSd"),window.AIRoleKfBossSd=AIRoleKfBossSd;var AIRoleUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setDir=function(t){t!=this.entity&&this.entity.setDir(DirUtil.get8Dir(this.entity,t))},e}(AIBase);__reflect(AIRoleUI.prototype,"AIRoleUI"),window.AIRoleUI=AIRoleUI;var AIXuese=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.startfindNpc=function(t){var e=this;if(t){var i=Cfg.getConfig(NPCConfig,t),n=new XY((i.pos.mapX+.5)*MapBase.CELL_SIZE,(i.pos.mapY+.5)*MapBase.CELL_SIZE),a=MapContainer.ins().getNearestAroundXY(n,this.entity);this.startMoveToXY(a,FbSys.ins().fbId,function(){e.entity==LogicSys.ins().centerEntity&&FbSys.ins().sendXueSeTaskCommit()})}},e.prototype.startPickItem=function(e){if(void 0===e&&(e=null),e){var i=LogicSys.ins().getItemByHandle(e.handle);i.item.id!=Cfg.getConfig(EnumConfig).XUESE_DATIANSHI?t.prototype.startPickItem.call(this,e):this.itemXese=e}else t.prototype.startPickItem.call(this,e)},e.prototype.PickItem=function(){if(this.itemXese&&1==LogicSys.ins().getItemList().length&&(this.params.pickItems.push(this.itemXese),this.itemXese=null),this.params.pickItems.length)return t.prototype.PickItem.call(this);var e=LogicSys.ins().getMyYongbing();if(e){var i=e.AI,n=i.getPickItem();if(n)return this.params.pickItems.push(n),void this.update()}LogicSys.ins().getAliveEnemysByAI(this).length?this.startAttack():this.entity!=LogicSys.ins().centerEntity&&this.startFollow(LogicSys.ins().centerEntity.handle,this.params.followMasterHandle)},e.prototype.Atk=function(){return LogicSys.ins().getAliveEnemysByAI(this).length?t.prototype.Atk.call(this):void this.startPickItem()},e}(AIRole);__reflect(AIXuese.prototype,"AIXuese"),window.AIXuese=AIXuese;var RankType;!function(t){t[t.JSZL=0]="JSZL",t[t.JSDJ=1]="JSDJ",t[t.GuaJi=2]="GuaJi",t[t.WanMo=3]="WanMo",t[t.HeiAn=4]="HeiAn",t[t.JJC=5]="JJC",t[t.ZMZL=6]="ZMZL",t[t.JLZL=7]="JLZL",t[t.YBZL=8]="YBZL",t[t.SQZL=9]="SQZL",t[t.CBZL=10]="CBZL",t[t.SZZL=11]="SZZL",t[t.MLZL=12]="MLZL",t[t.HQZL=13]="HQZL",t[t.LLDJ=14]="LLDJ",t[t.TXDJ=15]="TXDJ",t[t.ZBZL=16]="ZBZL",t[t.SMZL=17]="SMZL",t[t.Ladder=18]="Ladder",t[t.Fort=19]="Fort",t[t.JOB_ZS=20]="JOB_ZS",t[t.JOB_FS=21]="JOB_FS",t[t.JOB_GJS=22]="JOB_GJS",t[t.FieldPk=25]="FieldPk",t[t.Qizhi=26]="Qizhi",t[t.YongZheShiLian=28]="YongZheShiLian",t[t.QHZL=30]="QHZL",t[t.MZZL=31]="MZZL",t[t.weiwang=999]="weiwang",t[t.emoisle=999]="emoisle",t[t.QHDJ=999]="QHDJ",t[t.PYZL=999]="PYZL",t[t.YSZL=999]="YSZL",t[t.HFDJ=999]="HFDJ",t[t.gem=999]="gem",t[t.juhun=999]="juhun"}(RankType||(RankType={})),window.RankType=RankType;var AIYongbingJJC=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setEntity=function(e){t.prototype.setEntity.call(this,e),this.entity.setDir(3)},e}(AIYongbing);__reflect(AIYongbingJJC.prototype,"AIYongbingJJC"),window.AIYongbingJJC=AIYongbingJJC;var AIYongbingKfBossSd=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.Follow=function(){if(this.isMoveing())return!0;if(this.isFaraway())return this.startFollow(this.params.followHandle,this.params.followMasterHandle),!0;var t=this.getFollowTarget();if(t&&!t.isDead()){var e=t.AI.getCurTarget();return e&&this.hasSkill()?(this.startAttack(e),!0):!1}return!1},e.prototype.getNextTarget=function(){var t,e=this.getFollowTarget();if(e&&!e.isDead()){var i=LogicSys.ins().getNearestEnemyByAI(e.AI);i&&i.isAlive()&&this.hasSkill()&&(t=e.AI.getCurTarget())}return t},e}(AIYongbing);__reflect(AIYongbingKfBossSd.prototype,"AIYongbingKfBossSd"),window.AIYongbingKfBossSd=AIYongbingKfBossSd;var AIYongbingMoLong=function(t){function e(){var e=t.call(this)||this;return e.enemyType=[EntityType.MONSTER_SERVER],e}return __extends(e,t),e}(AIYongbing);__reflect(AIYongbingMoLong.prototype,"AIYongbingMoLong"),window.AIYongbingMoLong=AIYongbingMoLong;var AICurTargetHandle=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(AITargetHandle);__reflect(AICurTargetHandle.prototype,"AICurTargetHandle"),window.AICurTargetHandle=AICurTargetHandle;var RankTypeData=function(){function t(){this.praise=new PraiseData,this.dataList=[]}return t.prototype.parser=function(t){this.type=t.readShort();var e=t.readShort();this.dataList.length=0,this.top=null;for(var i=0;e>i;i++){var n=void 0;switch(this.type){case RankType.JSZL:case RankType.YBZL:case RankType.SQZL:case RankType.SZZL:case RankType.MLZL:case RankType.ZBZL:case RankType.JOB_ZS:case RankType.JOB_FS:case RankType.JOB_GJS:n=new RankDataPower;break;case RankType.HQZL:n=new RankDataHQZL;break;case RankType.JSDJ:n=new RankDataLevel;break;case RankType.GuaJi:n=new RankDataGuaJi;break;case RankType.WanMo:case RankType.HeiAn:n=new RankDataWanmo;break;case RankType.JJC:n=new RankDataJJC;break;case RankType.ZMZL:n=new RankDataZMZL;break;case RankType.JLZL:n=new RankDataJLZL;break;case RankType.CBZL:n=new RankDataWing;break;case RankType.LLDJ:n=new RankDataLLDJ;break;case RankType.TXDJ:n=new RankDataTXDJ;break;case RankType.SMZL:n=new RankDataSMZL;break;case RankType.Fort:n=new RankDataRedFort;break;case RankType.Ladder:n=new RankDataLadder;break;case RankType.FieldPk:n=new RankDataFieldPk;break;case RankType.QHZL:n=new RankDataQHZL;break;case RankType.MZZL:n=new RankDataMZZL;break;case RankType.QHDJ:case RankType.PYZL:case RankType.YSZL:case RankType.HFDJ:case RankType.gem:case RankType.juhun:case RankType.emoisle:case RankType.Qizhi:n=new RankDataCommon;break;case RankType.weiwang:n=new RankDataWeiWang;break;case RankType.YongZheShiLian:n=new RankDataYongZheShiLian}n.parser(t),0==i?this.top=n:this.dataList.push(n)}this.myRank=t.readShort()},t.prototype.isShowPraise=function(){return null!=this.top||this.dataList.length>0},t.prototype.getFullDatalist=function(){return this.top?[].concat(this.top).concat(this.dataList):[]},t}();__reflect(RankTypeData.prototype,"RankTypeData"),window.RankTypeData=RankTypeData;var AITargetChouhen=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chouhenList=[],e}return __extends(e,t),e.prototype.getTarget=function(t){for(var e,i=0,n=this.chouhenList;i<n.length;i++){var a=n[i],o=a.masterHandle,s=LogicSys.ins().getMainRoleByMasterHandle(o);s&&!s.isDead()&&(e=s)}return e},e.prototype.setParam=function(t){this.chouhenList=t.concat()},e.prototype.addParam=function(t){},e.prototype.delParam=function(t){},e.prototype.reset=function(){this.chouhenList.length=0},e}(AITargetBase);__reflect(AITargetChouhen.prototype,"AITargetChouhen"),window.AITargetChouhen=AITargetChouhen;var TSSZPanel=function(t){function e(){var e=t.call(this)||this;return e.jobArr=[JobConst.ZhanShi,JobConst.FaShi,JobConst.GongJianShou],e.initUI(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="TSSZPanelEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=TSSZPanelItem,this.list.dataProvider=this.listArr=new eui.ArrayCollection,this.listTab.itemRenderer=TSSZPanelTabItem,this.listTab.dataProvider=this.listTabArr=new eui.ArrayCollection,this.listTabArr.source=this.jobArr,this.mcIcon=new McIcon,this.groupMC.addChild(this.mcIcon)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnHelp,this.onClick),this.addLsn(RankSys.ins().patchRankData,this.updatePanel),this.addItemTapE(this.listTab,this.onTabListClick);var e=RankSys.ins().getTSSZLeftTime();e>0?Timer.ins()["do"](0,1e3,Math.ceil(e),this.formatTime,this):this.formatTime(0),this.listTab.selectedIndex=this.jobArr.indexOf(Actor.ins().job),this.listTab.validateNow(),this.updatePanel(),RankSys.ins().sendGetRankData(RankSys.ins().getRankTypeByJob(Actor.ins().job))},e.prototype.formatTime=function(t){var e="";e=t>0?Lang.rank_str14+StrUtil.addColor(""+getFormatTime(t,"dd天hh小时mm分钟ss秒"),5767068):Lang.fb_str83,this.labelTime.textFlow=addColorTF(e)},e.prototype.updatePanel=function(){var t=this.listTab.selectedItem||JobConst.ZhanShi;this.updateList(t)},e.prototype.onTabListClick=function(t){var e=this.listTab.selectedItem||JobConst.ZhanShi;this.updateList(e),RankSys.ins().sendGetRankData(RankSys.ins().getRankTypeByJob(e))},e.prototype.updateList=function(t){var e=Cfg.getConfig(TSSZConfig,t);this.imgName.source="shenqi_zycs_"+t+"13",this.mcIcon.open(e.mcIcon,t),this.bmpPower.text=e.power.toString();var i=RankSys.ins().getRankTypeByJob(t),n=RankSys.ins().getRankData(i);this.listArr.source=n.getFullDatalist(),this.labelMyRank.visible=this.labelMyPower.visible=t==Actor.ins().job,this.labelMyRank.textFlow=addColorTF("我的排名："+addColor(""+(n.myRank>0?n.myRank:"未上榜"),16115290)),this.labelMyPower.textFlow=addColorTF("我的战力："+addColor(""+Actor.ins().power,16115290)),this.labelDesc.visible=t!=Actor.ins().job},e.prototype.onClick=function(t){switch(t.target){case this.btnHelp:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,94).text)}},e.getSysId=function(){return SysId.TSSZ},e.getTitle=function(){return"btz_zycs_tssz"},e.getTabTitle=function(){return"bqz_zycs_tssz"},e}(BasePanel);__reflect(TSSZPanel.prototype,"TSSZPanel"),window.TSSZPanel=TSSZPanel;var AITargetJob=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getTarget=function(t){var e;return e},e}(AITargetBase);__reflect(AITargetJob.prototype,"AITargetJob"),window.AITargetJob=AITargetJob;var AITargetMasterHandle=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.masterHandle=0,e}return __extends(e,t),e.prototype.getTarget=function(t){var e;if(this.masterHandle){var i=LogicSys.ins().getMainRoleByMasterHandle(this.masterHandle);i&&!i.isDead()&&(e=i),e||this.reset()}return e},e.prototype.setParam=function(t){this.masterHandle=t},e.prototype.reset=function(){this.masterHandle=0},e}(AITargetBase);__reflect(AITargetMasterHandle.prototype,"AITargetMasterHandle"),window.AITargetMasterHandle=AITargetMasterHandle;var AITargetMonsterId=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monsterId=0,e}return __extends(e,t),e.prototype.getTarget=function(t){var e;return!e&&this.monsterId&&(e=LogicSys.ins().getNearestMonsterById(t,this.monsterId)),e},e.prototype.setParam=function(t){this.monsterId=t},e.prototype.reset=function(){this.monsterId=0},e}(AITargetBase);__reflect(AITargetMonsterId.prototype,"AITargetMonsterId"),window.AITargetMonsterId=AITargetMonsterId;var AITargetNearest=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getTarget=function(t){var e=LogicSys.ins().getNearestEnemyByAI(t);return e},e.prototype.setParam=function(t){},e}(AITargetBase);__reflect(AITargetNearest.prototype,"AITargetNearest"),window.AITargetNearest=AITargetNearest;var TSSZPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TSSZPanelItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.rank<=3?this.currentState="s"+t.rank:this.currentState="s4",this.lbRank.text=t.rank.toString(),this.lbName.text=t.playerName,this.lbPower.text=t.power.toString()},e}(BaseItemRender);__reflect(TSSZPanelItem.prototype,"TSSZPanelItem"),window.TSSZPanelItem=TSSZPanelItem;var EntityDamon=function(t){function e(){var e=t.call(this)||this;return e.damonId=0,e._hpBar.visible=!1,e}return __extends(e,t),e.prototype.setConfig=function(t){},e.prototype.getCfgId=function(){return this.damonId},e}(Entity);__reflect(EntityDamon.prototype,"EntityDamon"),window.EntityDamon=EntityDamon;var EntityDropItem=function(t){function e(){var e=t.call(this)||this;return e.pickerHandle=0,e.hasPicked=!1,e.touchEnabled=!1,e.touchChildren=!1,e.movieContainer=new egret.DisplayObjectContainer,e.addChild(e.movieContainer),e.labelName=new eui.Label,e.labelName.fontFamily="黑体",e.labelName.stroke=1,e.labelName.strokeColor=0,e.labelName.size=16,e.labelName.y=16,e.imgItem=new eui.Image,e.imgItem.x=-32,e.imgItem.y=-32,e.mc=new MC,e.imgItem.scaleX=e.imgItem.scaleY=.6,e.movieContainer.addChild(e.mc),e.movieContainer.addChild(e.imgItem),e.movieContainer.addChild(e.labelName),e}return __extends(e,t),e.prototype.setData=function(t){this.item=t;var e=Cfg.getItemCfg(t.id),i=""!=t.roleName?"("+t.roleName+")":"";GFunc.isCur(e.id)?this.labelName.textFlow=addColorTF(StrUtil.addColor(e.getName(),GConst.PZColor[e.quality])+"x"+t.count+i):this.labelName.text=e.getName()+i,this.imgItem.source=ResMgr.getItemIcon(e.getIcon()),this.labelName.textColor=GConst.PZColor[e.quality],this.labelName.x=-this.labelName.textWidth>>1,e.quality>=QualityType.Green&&this.mc.playFile(getEffName(ResMgr.dropmc[e.quality]),-1)},e.prototype.playDropMovie=function(){var t=64,e=this.movieContainer.y-t/2,i=this.movieContainer.y-t,n=this.movieContainer.y,a=egret.Tween.get(this.movieContainer);a.to({y:e},120).to({y:i},120).to({y:n},200)},e.prototype.reset=function(){this.item=null,this.hasPicked=!1,this.labelName.text="",this.imgItem.source=null,this.imgItem.x=-32,this.imgItem.y=-32,this.pickerHandle=0,egret.Tween.removeTweens(this.movieContainer),this.movieContainer.x=this.movieContainer.y=0,this.mc.visible=!1,this.mc.stop()},e}(egret.DisplayObjectContainer);__reflect(EntityDropItem.prototype,"EntityDropItem"),window.EntityDropItem=EntityDropItem;var EntityEff=function(t){function e(){var e=t.call(this)||this;return e.setHpAndNameVisible(!1),e._shadow.visible=!1,e}return __extends(e,t),e.prototype.canBeAtk=function(){return!1},e.prototype.updateMC=function(){this._body.playFile(this.data.bodyFileName,-1,null,!1)},e}(Entity);__reflect(EntityEff.prototype,"EntityEff"),window.EntityEff=EntityEff;var EntityEff1=function(t){function e(){var e=t.call(this)||this;return e.rate=1,e.dir=4,e}return __extends(e,t),e.prototype.copy=function(t){},e}(egret.DisplayObjectContainer);__reflect(EntityEff1.prototype,"EntityEff1"),window.EntityEff1=EntityEff1;var EntityFriendMonster=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Cfg.getMonstersConfigNew(e.configID);this.setHpAndNameVisible(!0),this.setName(i.name,16769375)},e.prototype.iniHpBar=function(){this._hpBar=new eui.ProgressBar,this._hpBar.touchEnabled=!1,this._hpBar.touchChildren=!1,this._hpBar.skinName="bloodBarSkin2",this._hpBar.anchorOffsetX=this._hpBar.width>>1,this._hpBar.direction=eui.Direction.LTR,this._hpBar.slideDuration=1200,this.addChild(this._hpBar)},e.prototype.setHp=function(t,e){e&&(this._hpBar.maximum=Math.floor(e)),0>t&&(t=0),t>e&&(t=e),this._hpBar.value=Math.floor(t),this._hpBar.labelFunction=function(t,e){return Math.floor(100*t/e)+"%"}},e}(EntityMonster);__reflect(EntityFriendMonster.prototype,"EntityFriendMonster"),window.EntityFriendMonster=EntityFriendMonster;var EntityMeilin=function(t){function e(){var e=t.call(this)||this;return e._hpBar.visible=!1,e}return __extends(e,t),e.prototype.setData=function(t){this.data=t;
var e=t.config;this.setProp(AttrType.atMvSpeed,64*e.MvSpeed/1e3),this.setProp(AttrType.atHpMax,1),this.setProp(AttrType.atHp,1),this._body.y=-e.high,this.setHpAndNameVisible(!1),this.readyUpdateMC(),this._shadow.visible=!1},e.prototype.getDir=function(){return 4},e.prototype.setFlow=function(){GFunc.move(this._bodyContainer,new XY,new XY(0,20),1500)},e.prototype.reset=function(){egret.Tween.removeTweens(this._bodyContainer),t.prototype.reset.call(this)},e.prototype.setBodyVisible=function(t){this._isShowBody=this._effContainerUp.visible=this._effContainerDown.visible=this._bodyContainer.visible=t,this._shadow.visible=!1},e}(Entity);__reflect(EntityMeilin.prototype,"EntityMeilin"),window.EntityMeilin=EntityMeilin;var EntityMiner=function(t){function e(){var e=t.call(this)||this;return e.headNameComponent=new MinerNameComponent,e.headNameComponent.x=-e.headNameComponent.width/2,e.addChild(e.headNameComponent),e.titleArr.push(e.headNameComponent),e}return __extends(e,t),e.prototype.addDisplay=function(){},e.prototype.setData=function(t){this.data=t;var e=Cfg.getConfig(MinerConfig,this.data.minerQuality);this.setDir(this.data.getMineFBConfig().dir),this.headNameComponent.updateRoleName(this.data.roleName),this.headNameComponent.updateMinerName(this.data.minerQuality),this.headNameComponent.setRobImgShow(this.data.isRob()&&!this.data.isMyMiner()?!0:!1);var i=Math.floor(t.getTime()/1e3);i>0&&Timer.ins()["do"](0,1e3,i,this.onTimer,this),this.data.setBodyFileName("npc"+e.apperance),this.setHpAndNameVisible(!1),this.setClickEnable(!0),this.updatePos(),this.readyUpdateMC()},e.prototype.onTap=function(t){if(this._body.hitTestPoint(t.stageX,t.stageY)&&this.data){if(this.data.isMyMiner())return void showtipsFail(Lang.scene_str3);if(this.data.isGrab())return void showtipsFail(Lang.scene_str4);if(this.data.isRobing)return void showtipsFail(Lang.scene_str5);if(!this.data.isRob())return void showtipsFail(Lang.scene_str6.replace("$count$",""+Cfg.getConfig(MineCommonConfig).berob));openWin(MineRobWin,this.data)}},e.prototype.onTimer=function(){var t=""+Lang.common_str85+getFormatTime(this.data.getTime()/1e3,"mm:ss");this.headNameComponent.updateTime(t)},e}(EntityRole);__reflect(EntityMiner.prototype,"EntityMiner"),window.EntityMiner=EntityMiner;var TSSZPanelRankItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TSSZPanelRankItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.rank<=3?this.currentState="s"+t.rank:this.currentState="s4",this.lbRank.text=t.rank.toString(),this.lbName.text=t.playerName,this.lbPower.text=t.power.toString()},e}(BaseItemRender);__reflect(TSSZPanelRankItem.prototype,"TSSZPanelRankItem"),window.TSSZPanelRankItem=TSSZPanelRankItem;var EntityMonsterSiege=function(t){function e(){var e=t.call(this)||this;return e.updateHeadNameTick=0,e.headNameComponent=new MonsterSiegeName,e.addChild(e.headNameComponent),e}return __extends(e,t),e.prototype.setData=function(t){this.data=t;var e=Cfg.getMonstersConfigNew(t.monsterId),i=Cfg.getConfig(MonsterModelConfig,e.avatar[0]);this.setProp(AttrType.atHpMax,3),this.setProp(AttrType.atHp,t.hp),this.setDir(i.dir),this.data.setBodyFileName(i.appearance),this.setEntityScale(i.scale),this.myHeight=i.height*i.scale,this._hpBar.currentState="s"+(t.config.type+1),this.setHPBarVisible(t.isLive());var n=t.config.monstrColor;this.headNameComponent.updateName(e.name+n),this.headNameComponent.x=-this.headNameComponent.width/2,this.readyUpdateMC()},e.prototype.iniHpBar=function(){this._hpBar=new eui.ProgressBar,this._hpBar.touchEnabled=!1,this._hpBar.touchChildren=!1,this._hpBar.skinName="bloodBarMSSkin",this._hpBar.direction=eui.Direction.LTR,this._hpBar.slideDuration=1200,this.addChild(this._hpBar),this._hpBar.x=-this._hpBar.width/2;var t=-50-this.myHeight;this._hpBar.y=t-this._hpBar.height},e.prototype.getCfgId=function(){return this.data.id},e.prototype.updateTick=function(e){t.prototype.updateTick.call(this,e),Timer.ins().getTimer()>this.updateHeadNameTick&&(this.updateHeadNameTick=Timer.ins().getTimer()+1e3,this.updateTime())},e.prototype.updateTime=function(){var t="";this.data.hp<=2&&(t=getFormatTime(this.data.getTimer(),"hh小时mm分ss秒")+"后"+(this.data.isDie()?"复活":"整顿")),this.headNameComponent.updateTime(t,this.data.isDie())},e.prototype.onTap=function(t){var e=this;this._body.hitTestPoint(t.stageX,t.stageY)&&(LogicSys.ins().onMapGridClick(MapContainer.ins().getNearestAroundXY(this,LogicSys.ins().centerEntity),function(){MonsterSiegeSys.ins().sendSingleMonsterData(e.data.id)}),t.stopImmediatePropagation())},e.prototype.canBeAtk=function(){return!1},e}(Entity);__reflect(EntityMonsterSiege.prototype,"EntityMonsterSiege"),window.EntityMonsterSiege=EntityMonsterSiege;var EntityNPC=function(t){function e(){var e=t.call(this)||this;return e.isShowRedpoint=!1,e.npcId=0,e._hpBar.visible=!1,e.touchEnabled=!0,e.touchChildren=!0,e.imgTower=new eui.Image,e.imgTower.touchEnabled=!1,e.imgTower.x=-94,e.imgTower.y=-37,e.addChildAt(e.imgTower,0),e.mcRedPoint=new MC,e.addChild(e.mcRedPoint),e.titleArr.push(e.mcRedPoint),e}return __extends(e,t),e.prototype.addDisplay=function(){MapContainer.ins().addEffectToDown2(this._shadow)},e.prototype.setData=function(t){this.data=t;var e=Cfg.getConfig(NPCConfig,t.configID);this.setName(e.name),this.setDir(e.dir),this.myHeight=e.myHeight,this.npcId=e.id,e.bodyAppearanceId&&this.data.setBodyFileName(Cfg.getConfig(BodyAppearanceConfig,e.bodyAppearanceId).appearance),e.weaponAppearanceId&&this.data.setWeaponFileName(Cfg.getConfig(WeaponAppearanceConfig,e.weaponAppearanceId).appearance),e.wingAppearanceId&&this.data.setWingFileName(Cfg.getConfig(WingAppearanceConfig,e.wingAppearanceId).appearance),this.setTitle(e.titleId),this.showImgTower(-1!=GConst.RankNPCId.indexOf(e.id)),this.setHPBarVisible(!1),this.updatePos(),this.readyUpdateMC(),this.setClickEnable(!0)},e.prototype.onTap=function(t){this._body.hitTestPoint(t.stageX,t.stageY)&&(LogicSys.ins().centerEntity.AI.startfindNpc(this.npcId),t.stopImmediatePropagation())},e.prototype.setName=function(e,i,n){void 0===i&&(i=16769375),void 0===n&&(n=16),t.prototype.setName.call(this,e,i),this._nameTxt.size=n,this.updateNameGroupSize()},e.prototype.getCfgId=function(){return this.npcId},e.prototype.setCfgId=function(t){this.npcId=t},e.prototype.reset=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTap,this),this.mcRedPoint.stop(),t.prototype.reset.call(this)},e.prototype.showRedPoint=function(t){this.isShowRedpoint=this.mcRedPoint.visible=t,t?this.mcRedPoint.playFile(getEffName("npctips"),-1,null,!1):this.mcRedPoint.stop()},e.prototype.showImgTower=function(t){this.imgTower.source=t?"single_zycs_dizuo_png":""},e.prototype.continuePlay=function(){t.prototype.continuePlay.call(this),this.showRedPoint(this.isShowRedpoint)},e.prototype.getBodyFileName=function(){return ResMgr.getEntityBodyRes(this.entityType,this.data.bodyFileName,this.getDir(),this.action,this.hasWing,0)},e}(EntityRole);__reflect(EntityNPC.prototype,"EntityNPC"),window.EntityNPC=EntityNPC;var TSSZPanelTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TSSZPanelTabItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;null!=t?(this.iconDisplay1.source=this.getIconDisplay(),this.iconDisplay.source=this.getSelectIcon(),this.labelName.text=Cfg.getConfig(TSSZConfig,t).name,this.updateRp()):this.iconDisplay.source=""},e.prototype.updateRp=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(ExtCom,TSSZWin,TSSZPanel,t))},e.prototype.getIconDisplay=function(){var t=this.data;return null!=t?"tssz_zycs_tap"+t+"a":void 0},e.prototype.getSelectIcon=function(){var t=this.data;return null!=t?"tssz_zycs_tap"+t:void 0},e}(BaseItemRender);__reflect(TSSZPanelTabItem.prototype,"TSSZPanelTabItem"),window.TSSZPanelTabItem=TSSZPanelTabItem;var EntityOtherName=function(t){function e(){var e=t.call(this)||this;return e.lbBelongName=new eui.Label,e.lbBelongName.fontFamily="黑体",e.lbBelongName.width=240,e.lbBelongName.textAlign="center",e.lbBelongName.size=16,e.lbBelongName.height=e.lbBelongName.size,e.lbBelongName.stroke=1,e.lbBelongName.strokeColor=0,e.lbBelongName.textColor=16777215,e.lbBelongName.anchorOffsetX=e.lbBelongName.width>>1,e.lbBelongName.verticalAlign="bottom",e.lbBelongName.touchEnabled=!1,e.addChild(e.lbBelongName),e.titleArr.push(e.lbBelongName),e.updatePos(),e}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Cfg.getMonstersConfigNew(e.configID);if(this.setName(i.name,16777215),this.setHpAndNameVisible(!0),this.setHPBarVisible(!1),e.belongName){var n=addColor(Lang.fb_str1+"：",16115290)+e.belongName;this.lbBelongName.textFlow=addColorTF(n)}else this.lbBelongName.text=""},e}(EntityOther);__reflect(EntityOtherName.prototype,"EntityOtherName"),window.EntityOtherName=EntityOtherName;var TSSZWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[TSSZPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(TSSZWin.prototype,"TSSZWin"),window.TSSZWin=TSSZWin;var EntityRoleUI=function(t){function e(){var e=t.call(this)||this;return e.disOrder=[],e.dir=4,e}return __extends(e,t),e.prototype.setAction=function(t){this.action=t,this.updateMC()},e.prototype.setDir=function(t){this.dir=t,this.updateMC()},e.prototype.setData=function(t,e,i){void 0===i&&(i=EntityAction.STAND),this.data=t,this.dir=e,this.action=i,this.updateMC()},e.prototype.updateMC=function(){var t=this.data,e=0,i=this.dir,n=isNaN(t.type)?EntityType.ROLE:t.type;if(t.damonId){var a=Cfg.getConfig(DamonHuanhuaBaseConfig,t.damonId);e=isNaN(a.high)?0:-a.high;var o=this.getMC(McOrder.MOUNT,i),s=this.getMC(McOrder.MOUNT2,i);o.playFile(ResMgr.getMountSource(t.mountFileName,i,this.action),-1),s.playFile(ResMgr.getMount2Source(t.mountFileName,i,this.action),-1)}var r=this.getMC(McOrder.BODY,i);if(r.playFile(ResMgr.getEntityBodyRes(n,t.bodyFileName,i,this.action,!0,t.sex),-1),r.y=e,t.weaponFileName){var u=this.getMC(McOrder.WEAPON,i);u.playFile(ResMgr.getEntityWeaponRes(n,t.weaponFileName,i,this.action),-1),u.y=e}if(t.wingId){var h=this.getMC(McOrder.WING,i);h.playFile(ResMgr.getEntityWingRes(n,t.wingFileName,i,this.action),-1),h.y=e}if(t.shengLingId>0){var p=this.getMC(McOrder.SHENGLING,i);p.playFile(ResMgr.getEntityShengLingRes(n,t.shengLingFileName,i,this.action,""!=t.wingFileName),-1),p.y=e}var l=GConst.mcOrderJob[t.job],c=l[i];if(c)for(var d=c.length,g=0;d>g;g++){var y=c[g];this.disOrder[y]&&this.addChild(this.disOrder[y])}},e.prototype.getMC=function(t,e){var i=this.disOrder[t];return i||(this.disOrder[t]=i=new MC),i.setDir(e),i},e.prototype.reset=function(){for(var t=0,e=this.disOrder;t<e.length;t++){var i=e[t];i&&i.reset()}},__decorate([callDelay()],e.prototype,"updateMC",null),e}(eui.Component);__reflect(EntityRoleUI.prototype,"EntityRoleUI"),window.EntityRoleUI=EntityRoleUI;var EntityYongbing=function(t){function e(){var e=t.call(this)||this;return e.setHPBarVisible(!1),e}return __extends(e,t),e.prototype.canBeAt=function(){return!1},e.prototype.setData=function(t){this.data=t,this.setName(t.entityName+"的灵宠"),this.setProps(t.attributeData)},e.prototype.getBodyFileName=function(){return ResMgr.getEntityBodyRes(this.entityType,this.data.bodyFileName,this.getDir(),this.action,this.hasWing,0)},e}(EntityRole);__reflect(EntityYongbing.prototype,"EntityYongbing"),window.EntityYongbing=EntityYongbing;var MapContainer=function(t){function e(){var i=t.call(this)||this;return i.imgSize=1024,i.isSmallImgComplete=!0,i.lastUpdateX=0,i.lastUpdateY=0,i.images={},i.mapId=-1,i.mapFileNames=[],i.curMapFileName="",MessageMgr.ins().coverFunc(e),i.container=new egret.DisplayObjectContainer,i.container.touchChildren=!1,i.container.touchEnabled=!0,i.addChild(i.container),i.smallImg=new eui.Image,i.container.addChild(i.smallImg),i.smallImg.addEventListener(egret.Event.COMPLETE,i.onThumbnailComplete,i),i.mapEffLayer=new egret.DisplayObjectContainer,i.addChild(i.mapEffLayer),i.layerDrop=new egret.DisplayObjectContainer,i.addChild(i.layerDrop),i.downLayer1=new egret.DisplayObjectContainer,i.addChild(i.downLayer1),i.downLayer2=new egret.DisplayObjectContainer,i.addChild(i.downLayer2),i.middleLayer=new egret.DisplayObjectContainer,i.middleLayer.sortableChildren=!0,i.addChild(i.middleLayer),i.upLayer1=new egret.DisplayObjectContainer,i.addChild(i.upLayer1),i.upLayer2=new egret.DisplayObjectContainer,i.addChild(i.upLayer2),i.layerBlood=new egret.DisplayObjectContainer,i.addChild(i.layerBlood),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,i.patchGridClick,i),i.checkWalkable=i.checkWalkable.bind(i),i.checkWalkableTemp=i.checkWalkableTemp.bind(i),i}return __extends(e,t),e.ins=function(){return this.instance||(this.instance=new e)},e.prototype.getPath=function(i,n,a){return void 0===a&&(a=e.ins().checkWalkable),t.prototype.getPath.call(this,i,n,a)},e.prototype.getAroundPath=function(i,n,a){return void 0===a&&(a=e.ins().checkWalkableTemp),t.prototype.getAroundPath.call(this,i,n,a)},e.prototype.getNearestAroundXY=function(i,n,a){return void 0===a&&(a=e.ins().checkWalkable),t.prototype.getNearestAroundXY.call(this,i,n,a)},e.prototype.getNearestRandomXY=function(i,n){return void 0===n&&(n=e.ins().checkWalkable),t.prototype.getNearestRandomXY.call(this,i,n)},e.prototype.addToParent=function(t){if(void 0===t&&(t=null),t&&(this.myParent=t),this.myParent&&null==this.parent){this.myParent.addChild(this);for(var e=0;e<this.middleLayer.numChildren;e++){var i=this.middleLayer.getChildAt(e);i instanceof EntityBase&&i.continuePlay()}}},e.prototype.addEffectToDown1=function(t){this.downLayer1.addChild(t)},e.prototype.addEffectToDown2=function(t){this.downLayer2.addChild(t)},e.prototype.addEffectToUp1=function(t){this.upLayer1.addChild(t)},e.prototype.addEntity=function(t){this.middleLayer.addChild(t)},e.prototype.addDropTo=function(t){this.layerDrop.addChild(t)},e.prototype.addMapEff=function(t){this.mapEffLayer.addChild(t)},e.prototype.addBlood=function(t){this.layerBlood.addChild(t)},e.prototype.updateTick=function(t){},e.prototype.patchGridClick=function(t){return this.container.globalToLocal(t.stageX,t.stageY)},e.prototype.focusTo=function(t,e,i){void 0===i&&(i=!1);var n=50,a=LayerMgr.getStage();this.x=-Math.min(Math.max(t-(a.stageWidth>>1),0),this.maxWidth-a.stageWidth),this.y=-Math.min(Math.max(e-n-(a.stageHeight>>1),0),this.maxHeight-a.stageHeight),this.updateImgs(this.x,this.y,i)},e.prototype.changeMap=function(e,i,n){this.clearAll(),this.curMapFileName=Cfg.getConfig(ScenesConfig,e).mapfilename,-1==this.mapFileNames.indexOf(this.curMapFileName)&&(this.mapFileNames.length>=2?(this.mapFileNames.push(this.curMapFileName),this.isSmallImgComplete=!1,this.clearImgs()):this.mapFileNames.push(this.curMapFileName)),this.mapId=e,console.log("地图mapId:"+e),t.prototype.initMap.call(this,Cfg.getConnectConfig(MapInfo,ScenesConfig,this.mapId));var a=ResMgr.getSmallMapName(this.curMapFileName);this.smallImg.width=this.maxWidth,this.smallImg.height=this.maxHeight,this.smallImg.source=a,ResMgr.addResFilter(this.curMapFileName,a),this.maxImagX=Math.ceil(this.maxWidth/this.imgSize),this.maxImagY=Math.ceil(this.maxHeight/this.imgSize),this.container.addChild(this.smallImg),this.focusTo(i,n,!0)},e.prototype.clearAll=function(){this.layerBlood.removeChildren(),this.mapEffLayer.removeChildren(),this.layerDrop.removeChildren(),this.downLayer1.removeChildren(),this.downLayer2.removeChildren(),this.middleLayer.removeChildren(),this.upLayer1.removeChildren(),this.upLayer2.removeChildren(),this.shapesContainer&&this.shapesContainer.parent&&this.removeChild(this.shapesContainer),this.container.removeChildren()},e.prototype.isShow=function(){return 1==this.visible&&null!=this.parent&&void 0!=this.parent},e.prototype.onThumbnailComplete=function(){this.isSmallImgComplete=!0,this.updateImgs(this.lastUpdateX,this.lastUpdateY,!0)},e.prototype.clearImgs=function(){for(var t in this.images){var e=this.images[t];if(e.source=null,e.$getRenderNode){var i=e.$getRenderNode();i.cleanBeforeRender()}e.$getRenderNode().cleanBeforeRender()}},e.prototype.updateImgs=function(t,e,i){void 0===i&&(i=!1);var n=this.imgSize/4;if(!(!i&&Math.abs(this.lastUpdateX-t)<=n&&Math.abs(this.lastUpdateY-e)<=n)&&(this.lastUpdateX=t,this.lastUpdateY=e,this.isSmallImgComplete)){var a=LayerMgr.getStage().stageWidth,o=LayerMgr.getStage().stageHeight,s=Math.max(Math.floor(-t/this.imgSize),0),r=Math.max(Math.floor(-e/this.imgSize),0),u=s+Math.ceil(a/this.imgSize),h=r+Math.ceil(o/this.imgSize),p=new egret.Rectangle(-t,-e,a,o),l=[];for(var c in this.images){var d=this.images[c],g=d.getBounds();g.x=d.x,g.y=d.y,p.intersects(g)||(l.push(d),d.source=null,d.visible=!1,delete this.images[c])}for(var y=s;u>=y&&y<this.maxImagX;y++)for(var f=r;h>=f&&f<this.maxImagY;f++){var m=""+y+f,v=ResMgr.getMapSourceName(Cfg.getConfig(ScenesConfig,this.mapId).mapfilename,f,y),d=this.images[m];d&&d.source==v||(d=d||l.pop()||new eui.Image,d.source=v,d.x=y*this.imgSize,d.y=f*this.imgSize,ResMgr.addResFilter(this.curMapFileName,v),this.images[m]=d,d.visible||(d.alpha=0,egret.Tween.get(d).to({alpha:1},2e3)),d.visible=!0),d.parent||this.container.addChild(d)}for(var S=0,C=l;S<C.length;S++){var b=C[S];DisUtil.remove(b)}}},e}(MapBase);__reflect(MapContainer.prototype,"MapContainer"),SystemMap.MapContainer=MapContainer.ins.bind(MapContainer),window.MapContainer=MapContainer;var Actor=function(t){function e(){var e=t.call(this)||this;return e.zhuanShengLv=80,e._actorID=0,e.level=0,e.exp=0,e.totalexp=0,e.power=0,e.myName="",e.createRoleTime="2020-01-06 00:00:00",e.job=JobConst.ZhanShi,e.outboardExp=0,e.outboardGold=0,e.currencys=[],e.MyAI=new AIMainRole,e.seePlayModel=new SeePlayModel,e.serverName="",e.serverOpenDay=0,e.serverHefuTimer=0,e.serverOpenTimer=0,e._serverTime=0,e.attrData=new EntityAttrData,e.vipLv=1,e.sVipLv=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"actorID",{get:function(){return this._actorID},set:function(t){urlParam.actorid=t,this._actorID=t},enumerable:!0,configurable:!0}),e.ins=function(){return t.getIns.call(this,e)},e.prototype.setCurrency=function(t,e){t<CurType.max&&(this.currencys[t]=e)},e.prototype.getCurrency=function(t){var e=0;return t<CurType.max&&(e=this.currencys[t]||0),e},Object.defineProperty(e.prototype,"serverTime",{get:function(){return this._serverTime+Timer.ins().getEgretTimer()},enumerable:!0,configurable:!0}),e.prototype.setServerTime=function(t){this._serverTime=DateUtil.formatMiniDateTime(t)-Timer.ins().getEgretTimer()},e.prototype.getOther=function(){return this.seePlayModel},e.prototype.getMyData=function(){return this.seePlayModelMy||(this.seePlayModelMy=new SeePlayModelMy),this.seePlayModelMy},e.prototype.getAtt=function(t){return this.attrData.getAtt(t)},Object.defineProperty(e.prototype,"hefuDay",{get:function(){return 0==this.serverHefuTimer?-1:Math.floor((this.serverTime-this.serverHefuTimer)/DateUtil.MS_PER_DAY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zsId",{get:function(){return JobSys.ins().zsData.zsId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"myBaseName",{get:function(){return this.myName.replace(RegUtil.ServerName,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLocation",{get:function(){return 1==e.ins().serverEnv},enumerable:!0,configurable:!0}),e}(BaseSys);__reflect(Actor.prototype,"Actor"),window.Actor=Actor;var CampWarRankItemOld=function(t){function e(){var e=t.call(this)||this;return e.imgVip.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof CampWarRankRoleData){var t=this.data;2==t.rank||3==t.rank?this.currentState="max":this.currentState="min",this.validateNow(),t.rank<=3?(this.imgRank.source=1==t.rank?"phb_zycs_no1":"jjc_zycs_no"+t.rank,this.imgRank.visible=!0,this.labelRank.visible=!1):(this.imgRank.visible=!1,this.labelRank.visible=!0,this.labelRank.text=t.rank.toString()),this.labelName.text=""+t.roleName,this.labelPower.text=Lang.gb_str69+"："+t.score,this.labelName.size=1==t.rank?24:20,this.labelPower.size=1==t.rank?24:20,this.imgBg.source=2==t.rank?"phb_zycs_d1":"phb_zycs_d2",this.imgLine.visible=1!=t.rank}},e}(RankItemBase);__reflect(CampWarRankItemOld.prototype,"CampWarRankItemOld"),window.CampWarRankItemOld=CampWarRankItemOld;var EntityBianshenData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bianShenEndTick=0,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.parserSkill(e)},e.prototype.parserData=function(t){this.entityName=t.readString(),this.job=t.readByte(),this.sex=t.readByte(),this.lv=t.readInt(),this.szId=t.readInt(),this.sqId=t.readInt(),this.wingId=t.readInt(),this.touxianStage=t.readInt(),this.title=t.readInt(),this.guildID=t.readInt(),this.guildName=t.readString(),this.teamId=t.readInt(),this.guildOffice=t.readInt(),this.mozhenId=t.readInt(),this.bianshenId=t.readInt();var e=t.readInt();this.bianShenEndTick=e+Timer.ins().getTimer(),this.damonId=t.readInt(),this.damonFazhenId=t.readInt(),this.meilinId=t.readInt(),this.footId=t.readInt();var i=t.readInt();Cfg.hasConfig(ShenYouHuanhuaConfig,i)&&(this.huDunId=i),this.isShowHunduBar=1==t.readByte()},Object.defineProperty(e.prototype,"leftCdTime",{get:function(){return Math.max(0,this.bianShenEndTick-Timer.ins().getTimer())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footFileName",{get:function(){var t="";if(this.bianshenId){var e=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.bianshenId);t=e.footId?Cfg.getConfig(FootAppearanceConfig,e.footId).appearance:""}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"faZhenFileName",{get:function(){if(this.mozhenId){var t=Cfg.getConfig(ShenmoMozhenBaseConfig,this.mozhenId).appearanceId;return Cfg.getConfig(GuanghuanAppearanceConfig,t).appearance}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biansheBodyFileName",{get:function(){var t=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.bianshenId);return t.facade},enumerable:!0,configurable:!0}),e}(EntityRoleData);__reflect(EntityBianshenData.prototype,"EntityBianshenData"),window.EntityBianshenData=EntityBianshenData;var EntityCollectionMonsterData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.parserBase(t),this.state=t.readByte(),this.tick=t.readInt(),this.tick=DateUtil.formatMiniDateTime(this.tick),this.tMasterHandle=t.readDouble()},e}(EntityData);__reflect(EntityCollectionMonsterData.prototype,"EntityCollectionMonsterData"),window.EntityCollectionMonsterData=EntityCollectionMonsterData;var EntityDamonData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fazhenId=0,e.followHandle=0,e}return __extends(e,t),e.prototype.parser=function(t){this.masterHandle=t.readDouble(),this.followHandle=t.readDouble(),this.configID=t.readInt(),this.fazhenId=t.readInt()},e}(EntityData);__reflect(EntityDamonData.prototype,"EntityDamonData"),window.EntityDamonData=EntityDamonData;var CampWarRankTab=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){"string"==typeof this.data&&(this.consuTxt.text=""+this.data)},e}(RankTabItem);__reflect(CampWarRankTab.prototype,"CampWarRankTab"),window.CampWarRankTab=CampWarRankTab;var EntityFaBaoData=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setConfig=function(t){this.config=t,this.configID=t.id;var e=Cfg.getConfig(MeilinAppearanceConfig,t.appearanceId).appearance;this.setBodyFileName(e)},e}(EntityData);__reflect(EntityFaBaoData.prototype,"EntityFaBaoData"),window.EntityFaBaoData=EntityFaBaoData;var RankDataCommon=function(t){function e(){var e=t.call(this)||this;return e.dabiaoValue=0,e}return __extends(e,t),e.prototype.parser=function(t){this.rank=t.readShort(),this.userId=t.readInt(),this.playerName=t.readString(),this.dabiaoValue=t.readDouble()},e}(RankData);__reflect(RankDataCommon.prototype,"RankDataCommon"),window.RankDataCommon=RankDataCommon;var EntityMonsterData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(EntityGatherMonsterData);__reflect(EntityMonsterData.prototype,"EntityMonsterData"),window.EntityMonsterData=EntityMonsterData;var EntityMonsterSiegeData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=1,e.hp=1,e.tick=0,e}return __extends(e,t),e.prototype.parser=function(t){this.id=t.readByte(),this.hp=t.readByte();var e=t.readInt();this.tick=1e3*e+Timer.ins().getTimer()},Object.defineProperty(e.prototype,"monsterId",{get:function(){return Cfg.getConfig(MSMonsterConfig,this.id).monsterid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return Cfg.getConfig(MSMonsterConfig,this.id)},enumerable:!0,configurable:!0}),e.prototype.getTimer=function(){return Math.max(0,(this.tick-Timer.ins().getEgretTimer())/1e3)},e.prototype.isDie=function(){return 0==this.hp},e.prototype.isLive=function(){return this.hp>0},e}(EntityData);__reflect(EntityMonsterSiegeData.prototype,"EntityMonsterSiegeData"),window.EntityMonsterSiegeData=EntityMonsterSiegeData;var RankItemPower=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e}(RankItemBase);__reflect(RankItemPower.prototype,"RankItemPower"),window.RankItemPower=RankItemPower;var EntityYongbingData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=0,e.fazhenId=0,e.entityName="",e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.entityName=e.readString(),this.id=e.readInt(),this.fazhenId=e.readInt(),this.parserSkill(e)},e.prototype.parserSkill=function(e){t.prototype.parserSkill.call(this,e);for(var i=0,n=this.skillDatas;i<n.length;i++){var a=n[i],o=Cfg.getConfig(YongbingHuanhuaBaseConfig,this.id);a.actionIndex=o.effect-1}},e.prototype.parserChange=function(t){this.handle=t.readDouble(),this.id=t.readInt(),this.fazhenId=t.readInt()},Object.defineProperty(e.prototype,"bodyFileName",{get:function(){var t=Cfg.getConfig(YongbingHuanhuaBaseConfig,this.id).facade;return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guanghuanFileName",{get:function(){var t="";if(this.fazhenId>0){var e=Cfg.getConfig(YongbingMozhenBaseConfig,this.fazhenId).appearanceId;t=Cfg.getConfig(GuanghuanAppearanceConfig,e).appearance}return t},enumerable:!0,configurable:!0}),e}(EntityData);__reflect(EntityYongbingData.prototype,"EntityYongbingData"),window.EntityYongbingData=EntityYongbingData;var MinePosData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=1,e.minerQuality=0,e.time=0,e.roleID=0,e.roleName="",e.roleJob=JobConst.ZhanShi,e.power=0,e.robRoleIds=[],e.isRobing=!1,e.posHandle=0,e.minerHandle=0,e}return __extends(e,t),e.prototype.parser=function(t){this.pos=t.readByte(),this.minerQuality=t.readByte(),this.roleJob=t.readByte(),this.time=1e3*t.readInt()+Timer.ins().getTimer(),this.roleID=t.readInt(),this.roleName=t.readString(),this.power=t.readDouble();var e=t.readByte();this.robRoleIds=[];for(var i=0;e>i;i++)this.robRoleIds.push(t.readInt());this.isRobing=t.readBoolean()},e.prototype.isGrab=function(){return-1!=this.robRoleIds.indexOf(Actor.ins().actorID)},e.prototype.isMyMiner=function(){return this.roleID==Actor.ins().actorID},e.prototype.getBeRobCount=function(){return this.robRoleIds.length},e.prototype.isMining=function(){return 0==this.minerQuality},e.prototype.isRob=function(){return!this.isGrab()&&this.getBeRobCount()<Cfg.getConfig(MineCommonConfig).berob&&this.minerQuality>0},e.prototype.getTime=function(){return Math.max(this.time-Timer.ins().getTimer(),0)},e.prototype.getMineFBConfig=function(){return Cfg.getConfig(MineFBConfig,this.pos)},e}(EntityData);__reflect(MinePosData.prototype,"MinePosData"),window.MinePosData=MinePosData;var SkillEditorData=function(){function t(){this.isEditor=!1,this.append="",this.isShow=!0,this.startTick=0,this.endTick=0,this.configs=[],this.canPlaySound=!1,this.selectIndex=-1,this.setLayerByLayer(MapContainer.ins()),this.sender=new EntityBase,this.target=new XY,this.hitFun=function(){},this.effResDir=ResDir.RES_DIR_SKILLEFF}return Object.defineProperty(t.prototype,"dTick",{get:function(){return this.endTick-this.startTick},enumerable:!0,configurable:!0}),t.prototype.getLayerByIndex=function(t){var e=this.layers;return e[t]||e[e.length-1]},t.prototype.isMiddleLayer=function(t){return t==this.layers.indexOf(this.middleLayer)},t.prototype.setLayerByLayer=function(t){this.setLayer(t.downLayer1,t.downLayer2,t.upLayer1,t.upLayer2,t.middleLayer)},t.prototype.setLayer=function(t,e,i,n,a){this.downLayer1=t,this.downLayer2=e,this.upLayer1=i,this.upLayer2=n,this.middleLayer=a,this.layers=[this.downLayer1,this.downLayer2,this.upLayer1,this.upLayer2,this.middleLayer]},t.prototype.playSound=function(t){this.canPlaySound&&SoundUtil.play(t)},t}();__reflect(SkillEditorData.prototype,"SkillEditorData");var BossRemindWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(e,i,n,a,o){void 0===e&&(e=""),void 0===i&&(i=""),void 0===n&&(n=""),void 0===a&&(a=""),void 0===o&&(o=null),this.skinName="ExtBossRemindWinEUI",t.prototype.open.call(this),this.addClickE(this.btnOk,this.onClick),this.addClickE(this.closeBtn,this.onClick),this.funBack=o,this.lbTitle.text=e,this.lbBossname.text=i,this.lblevel.text=n,this.imgBossHead.source=ResMgr.getMonsterHead(a)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOk:this.funBack&&(this.funBack(),this.visible=!1);break;case this.closeBtn:this.visible=!1}},e.prototype.hideImgArrow=function(){this.imgArrow.visible=!1},e}(BaseWinSingle);__reflect(BossRemindWin.prototype,"BossRemindWin"),window.BossRemindWin=BossRemindWin;var DailyOnlineCom=function(t){function e(){var e=t.call(this)||this;return e.skinName="DailyOnlineComEUI",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.group.visible=!0,this.scaleX=1,this.addClickE(this,this.onClick),this.addLsn(FuLiSys.ins().patchDailyOnlineAward,this.restartTime),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.restartTime(),this.updateRp()},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this),this.group.visible=!1,this.scaleX=0},e.prototype.updateTime=function(t){if(t>0){var e=DateUtil.formatTime(1e3*t,"mm:ss");e=e.replace(":","m"),this.bmpLabelTime.text=e}else this.updateState()},e.prototype.restartTime=function(){var t=FuLiSys.ins().dailyOnlineData.canGetAward();if(!t){var e=FuLiSys.ins().dailyOnlineData.getNextUpdateTime();e>0&&Timer.ins()["do"](0,1e3,Math.ceil(e/1e3),this.updateTime,this,TimerType.LAST)}this.updateState()},e.prototype.updateState=function(){var t=FuLiSys.ins().dailyOnlineData;if(t.hasGetAllAward()){if(t.isBefore1Day()){this.bmpLabelTime.visible=!1,this.labelCanGet.visible=!0,this.labelCanGet.text="明日可领取";var e=Cfg.getDailyOnlineEffId(t.day,Actor.ins().job);this.mcName=Cfg.getConfig(EffAppearanceConfig,e).appearance}}else{t.canGetAward()?(this.labelCanGet.visible=!0,this.bmpLabelTime.visible=!1,this.labelCanGet.text="可领取"):(this.labelCanGet.visible=!1,this.bmpLabelTime.visible=!0);var i=t.getNextData();this.mcName=Cfg.getConfig(EffAppearanceConfig,i.effId).appearance}},e.prototype.updateRp=function(t){(!t||t.check(DailyOnlinePanel))&&(this.redPoint.visible=RpSys.ins().getData(ExtCom,FuliWin,DailyOnlinePanel))},e.prototype.onClick=function(t){openWin(FuliWin,FuliWin.getTabIndexbyPanel(DailyOnlinePanel))},e}(BaseEUI);__reflect(DailyOnlineCom.prototype,"DailyOnlineCom"),window.DailyOnlineCom=DailyOnlineCom;var ExtCom=function(t){function e(){var i=t.call(this)||this;
return i.isShowBtn=!0,i.clonesbtn=[],i.tweenList=[],i.oneKeyCDTick=0,i.reliveType=ReliveType.Boss,i.skinName="ExtcompentEUI",i.touchEnabled=!1,i.addAllRule(),e.ins=i,i.toolbarIconArr=[i.group_toolbar1,i.groupIcon],i.groupAllIconArr=[i.groupAllIcon,i.groupAllIcon1,i.groupAct],i.rightIconArr=[i.rightGroup,i.rightTopGroup],i.rightTopGroup.cacheAsBitmap=!0,i}return __extends(e,t),e.prototype.open=function(){var t="mianui_zycs_xjhb";ComUtil.isXianYuApp&&(t+="30009"),this.btn_xjhb.icon=t,this.addClickE(this.btn_QieHuan,this.onToggleTouchTap),this.addEvent(eui.UIEvent.MOVE,this,this.createChildren),this.addLsn(RpSys.ins().patchRp,this.updateRedPoint),this.addLsn(JobSys.ins().patchQiJizl,this.qiJiOpen),this.addLsn(RpSys.ins().patchRp,this.updateRedPoint),this.addLsn(JobSys.ins().patchNewFunOpen,this.yanshiupdateXY),this.addLsn(TaskSys.ins().patchAgreementData,this.yanshiupdateXY),this.addLsn(TaskSys.ins().patchAgreementUpdate,this.yanshiupdateXY),this.addClickE(this,this.onItemClick),this.updateRedPoint(),this.qiJiOpen(),this.updateBossRemindXY()},e.prototype.addDisplay=function(){this.addLsn(LogicSys.ins().patchEnterMap,this.updateEnterMap),this.checkGuaji()},e.prototype.updateEnterMap=function(){this.qiJiOpen(),this.checkGuaji()},e.prototype.checkGuaji=function(){this.isGJ=FbSys.ins().fbId<=Cfg.getConfig(EnumConfig).GUAJI_FUBEN_MAX_ID&&!FbSys.ins().guajiData.isGuanQia},e.prototype.onItemClick=function(t){var e=t.target;if(e&&e instanceof eui.Button){var i=RuleIconMgr.ins().getRule(e);i&&i.tapExecute()}},e.prototype.qiJiOpen=function(){JobSys.ins().getQijiIsEnd()||!GFunc.isSysOpen(SysId.GNYL)?DisUtil.remove(this.com_qiji):this.com_qiji.show()},e.prototype.showToggleTap=function(t){var i=this;void 0===t&&(t=!1);var n=Timer.ins().getEgretTimer();if(t||!(n<this.oneKeyCDTick)){this.oneKeyCDTick=n+400;for(var a=0;a<this.tweenList.length;a++)this.tweenList[a].alpha=0,egret.Tween.removeTweens(this.tweenList[a]);if(this.tweenList.length=0,this.isShowBtn){var o=this.groupIcon.numChildren;this.groupCloneIcon.removeChildren(),this.clonesbtn=[];for(var s=function(t){var e=r.groupIcon.getChildAt(t);if(e instanceof eui.Button){var i=e,n=RuleIconMgr.ins().getRule(i);if(n){n.setVisible(!1);var a=new eui.Button;a.skinName="Btn0Skin1",a.icon=i.icon,r.groupCloneIcon.addChild(a),r.clonesbtn.push(n);var o=i.localToGlobal(),s=r.groupCloneIcon.globalToLocal(o.x,o.y);a.x=s.x,a.y=s.y;var u=egret.Tween.get(a);r.tweenList.push(a),u.wait(10*(t-1)).to({x:s.x-50,alpha:0},100).call(function(){a.visible=!1})}}},r=this,a=o-1;a>=0;a--)s(a)}else for(var o=this.groupCloneIcon.numChildren,u=function(t){var e=h.groupCloneIcon.getChildAt(t);if(e instanceof eui.Button){var n=e;n.visible=null!=h.clonesbtn[t].tar.parent;var a=n.x,o=egret.Tween.get(n);h.tweenList.push(n);var s=h;o.wait(10*t).to({x:a+50,alpha:1},100).call(function(){i.clonesbtn[t].setVisible(!0),s.groupCloneIcon.removeChild(n)})}},h=this,a=0;o>a;a++)u(a);this.isShowBtn=!this.isShowBtn;var p=egret.Tween.get(this.btn_QieHuan);p.to({scaleX:this.isShowBtn?1:-1},200),this.btn_QieHuan.redPoint.visible=this.getQieHuanRedPoint(),e.showOrHide()}},e.prototype.onToggleTouchTap=function(){this.showToggleTap()},e.showOrHide=function(){return e.ins.isShowBtn},e.prototype.getQieHuanRedPoint=function(){var t=!1;if(!this.isShowBtn)for(var e=this.groupIcon.numChildren,i=0;e>i;i++){var n=this.groupIcon.getChildAt(i);if(n instanceof eui.Button&&!n.visible&&n.redPoint.visible){t=!0;break}}return t},e.prototype.showQieHuan=function(t){this.isShowBtn!=t&&this.showToggleTap(!0)},e.prototype.addAllRule=function(){var t=RuleIconMgr.ins();t.push(new ActivityIconRule(this.btn_activity)),t.push(new Activity12IconRule(this.btn_activity12)),t.push(new FuLiIconRule(this.btn_fuli)),t.push(new ActKFLCIconRule(this.btn_KFLC)),t.push(new ActYYHLIconRule(this.btn_YYHL)),t.push(new FirstRechargeIconRule(this.btn_firstRecharge)),t.push(new FirstRechargeTimerIconRule(this.btn_firstRechargeTimer)),t.push(new FirstRechargeEveryDayIconRule(this.btn_firstRechargeEveryday)),t.push(new RechargeYiYuanIconRule(this.btn_rechargeYiYuan)),t.push(new LoginAwardIconRule(this.btn_LianXu)),t.push(new ChengJiuIconRule(this.btn_Achieve)),t.push(new RankRule(this.btn_datianshi)),t.push(new KeFuRule(this.btn_kefu)),t.push(new SmrzRule(this.btn_smrz)),t.push(new SmrzApiRule(this.btn_smrzApi)),t.push(new FxylRule(this.btn_fxly)),t.push(new YkRule(this.btn_YK)),t.push(new ZZTQRule(this.btn_ZZTQ)),t.push(new GzhlRule(this.btn_gzhl)),t.push(new BossIconRule(this.btn_Boss)),t.push(new QiYueRule(this.btn_QiYue)),t.push(new BtnoolbarRule(this.btn_QieHuan)),t.push(new RedFortRule(this.btn_RedFort)),t.push(new LuoLanRule(this.btn_LuoLan)),t.push(new ActivityHefuIconRule(this.btn_activityHefu)),t.push(new DailyWanFaRule(this.btn_DailyWanFa)),t.push(new ZhaoCaiLongRule(this.btn_ZhaoCaiLong)),t.push(new XunZhangRule(this.btn_XunZhang)),t.push(new ShengbeiRule(this.btn_Shengbei)),t.push(new FuBenRule(this.btn_FuBen)),t.push(new JJCRule(this.btn_JJC)),t.push(new YYMSRule(this.btn_yyms)),t.push(new SVIPMSRule(this.btn_svipms)),t.push(new ActCSKRule(this.btn_CSK)),t.push(new XunBaoRule(this.btn_XunBao)),t.push(new QiYuRule(this.btn_QiYu)),t.push(new SuitIconRule(this.btn_Suit)),t.push(new TSSZIconRule(this.btn_tssz)),t.push(new JinZuanIconRule(this.btn_JinZuan)),t.push(new ActQMKHIconRule(this.btn_QMKH)),t.push(new BBFLIconRule(this.btn_BBFL)),t.push(new ZeroBuyRule(this.btn_ZeroBuy)),t.push(new GuildIconRule(this.btn_Guild)),t.push(new YZZHRule(this.btn_YZZH)),t.push(new ZhuzaiRule(this.btn_ShenYuBoss)),t.push(new TclyRule(this.btn_tcly)),t.push(new YdssRule(this.btn_ydss)),t.push(new XJHBRule(this.btn_xjhb)),t.push(new CollectionRule(this.btn_sc)),t.push(new WxYqhlRule(this.btn_yqhl)),t.push(new QmdbRule(this.btn_qmdb)),t.push(new HwbzRule(this.btn_hwbz)),this.btn_campWar&&t.push(new CampWarRule(this.btn_campWar)),this.btn_GuZhan&&t.push(new GuZhanRule(this.btn_GuZhan)),this.btn_GuildBattle&&t.push(new GuildBattleRule(this.btn_GuildBattle)),this.btn_Shouquan&&t.push(new ShouquanRule(this.btn_Shouquan)),this.btn_TaQingFirstRecharge&&t.push(new TaQingFirstRechargeRule(this.btn_TaQingFirstRecharge)),this.btn_HFSY&&t.push(new ActHFSYRule(this.btn_HFSY)),this.btn_act21&&t.push(new Activity21IconRule(this.btn_act21)),this.btn_act24&&t.push(new Activity24IconRule(this.btn_act24)),this.btn_act15&&t.push(new Activity15IconRule(this.btn_act15)),this.btn_jqsc&&t.push(new Activity23IconRule(this.btn_jqsc)),t.iniRule()},e.prototype.updateRedPoint=function(){this.btn_QieHuan.redPoint.visible=this.getQieHuanRedPoint()},e.prototype.getBtnDailyWanFa=function(){return this.btn_DailyWanFa},e.prototype.getBossBtn=function(){return this.btn_Boss},e.prototype.getBtn_Npc=function(){return this.btn_FuBen},e.prototype.getXunBaoBtn=function(){return this.btn_XunBao},e.prototype.getBtn_JJ=function(){return this.btn_JJC},e.prototype.getBtn_QuYu=function(){return this.btn_QiYu},e.prototype.showBossRemind=function(t,e,i,n,a,o){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=""),void 0===n&&(n=""),void 0===a&&(a=null),this.reliveType=o,this.com_BossRemind.open(t,e,i,n,a),this.com_BossRemind.visible=!0,this.updateBossRemindXY()},e.prototype.yanshiupdateXY=function(){var t=this;Timer.ins()["do"](50,1,1,function(){t.updateBossRemindXY()},this)},e.prototype.updateBossRemindXY=function(){if(FbSys.ins().fbId<=Cfg.getConfig(EnumConfig).GUAJI_FUBEN_MAX_ID){var t=this.btn_Boss.localToGlobal(0,0),e=this.groupRight1.globalToLocal(t.x,t.y);this.com_BossRemind.y=e.y+30}},e.prototype.closeRemind=function(){this.com_BossRemind.visible=!1},e.prototype.getSevenDayLoginBtnPoint=function(){return this.btn_LianXu.localToGlobal()},e.prototype.groupMcAddChild=function(t){this.groupMc.addChild(t)},e.prototype.groupMcRemoveChild=function(t){this.groupMc.removeChild(t)},e.prototype.getGroupMc=function(){return this.groupMc},e.prototype.setMiBtn=function(t){this.groupAllIcon.visible=t,RuleIconMgr.ins().updateMC()},e.prototype.getIsShowBtn=function(){return this.isShowBtn},e.prototype.updateGuanQiaBoss=function(){if(GFunc.isInGuaJiFb()){var t=FbSys.ins().guajiData.isGuanQia;this.rightGroup.visible=!t,this.rightTopGroup.visible=!t,this.setMiBtn(!t),this.checkGuaji()}},e.prototype.getParentVisible=function(t){return t.parent?this.isIncluded(t,this.toolbarIconArr)?this.getObjVisible(t,this.toolbarIconArr):this.isIncluded(t,this.groupAllIconArr)?this.getObjVisible(t,this.groupAllIconArr):this.isIncluded(t,this.rightIconArr)?this.getObjVisible(t,this.rightIconArr):!1:!1},e.prototype.isIncluded=function(t,e){if(!t.parent||t.parent==this)return!1;for(var i=t.parent,n=e.length-1;n>=0;n--){if(i==e[n])return!0;if(!i.parent)return!1;i=i.parent}return!1},e.prototype.getObjVisible=function(t,e){for(var i=t.parent,n=!0,a=0;a<e.length;a++){if(!e[a].visible){n=!1;break}if(i==e[a])break}return n},__decorate([post()],e,"showOrHide",null),e}(BaseTabEUI);__reflect(ExtCom.prototype,"ExtCom"),window.ExtCom=ExtCom;var ExtRemind=function(t){function e(){var e=t.call(this)||this;return e.sysid=0,e.skinName="ExtRemindItemEUI",e}return __extends(e,t),e.prototype.open=function(){},e.prototype.setSysId=function(t){this.sysid=t},e.prototype.getSysId=function(){return this.sysid},e.prototype.setDesc=function(t){this.lbRemindDesc.textFlow=addColorTF(t),this.width=this.groupRemind.width},e}(BaseEUI);__reflect(ExtRemind.prototype,"ExtRemind"),window.ExtRemind=ExtRemind;var KefuWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.NormalWin,e.nextSpeakTick=0,e.skinName="KefuWinEUI",e.checkBoxs=[e.checkBox0,e.checkBox1,e.checkBox2,e.checkBox3],e.addBg(),e.chatInput.promptColor=e.chatInput.textColor,e.chatInput.prompt=e.chatInput.text,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addChangeE(this.checkBox0,this.onCheckBox),this.addChangeE(this.checkBox1,this.onCheckBox),this.addChangeE(this.checkBox2,this.onCheckBox),this.addChangeE(this.checkBox3,this.onCheckBox),this.addClickE(this.btnTijiao,this.onClick),this.addEvent(egret.FocusEvent.FOCUS_IN,this.chatInput,this.onFocusIn),this.labelTime.text=""+Lang.scene_str13+new Date(Actor.ins().serverTime).toLocaleDateString()},e.prototype.onCheckBox=function(t){for(var e=t.currentTarget,i=this.checkBoxs.length,n=0;i>n;n++)this.checkBoxs[n]!=e&&(this.checkBoxs[n].selected=!1)},e.prototype.onClick=function(){if(""==this.chatInput.text.replace(/\s/g,""))return void showtipsFail(Lang.scene_str14);if(this.nextSpeakTick>Timer.ins().getTimer()){var t=Math.ceil((this.nextSpeakTick-Timer.ins().getTimer())/1e3);return void showtipsFail(Lang.scene_str15.replace("$second$",""+t))}return this.chatInput.text==Lang.scene_str16?void showtipsFail(Lang.scene_str14):void(ChatSys.ins().checkRepeatString(this.chatInput.text)&&(this.sendKeFuInfo(this.chatInput.text),ChatSys.ins().lastSpeak=this.chatInput.text,this.nextSpeakTick=Timer.ins().getTimer()+3e5))},e.prototype.sendKeFuInfo=function(t){var e=urlParam.srvid,i=urlParam.appid,n=urlParam.openId,a=urlParam.reportRoot,o=Actor.ins(),s="?game="+e;s+="&appId="+i,s+="&userId="+o.actorID,s+="&userName="+n,s+="&userNameCn="+o.myName,s+="&userLevel="+o.level,s+="&vipLevel="+o.sVipLv,s+="&content="+t,Http.get(a+"back/custom/receive"+s),showtipsSuc("发送成功")},e.prototype.onFocusIn=function(){this.chatInput.text=""},e.openCheck=function(){return GFunc.checkSysOpen(SysId.KeFu)},e}(BaseWinSingle);__reflect(KefuWin.prototype,"KefuWin"),window.KefuWin=KefuWin;var MainChat=function(t){function e(){var e=t.call(this)||this;return e.lastTime=0,e.skinName="ChatMainSkin1",e.itemList.itemRenderer=ChatItemMainChat,e.dataList=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this.itemList,this.onListTap),this.addLsn(ChatSys.ins().patchLogMsg,this.updataList),this.addLsn(ChatSys.ins().patchNewChatMsg,this.updataList),this.addLsn(ChatSys.ins().patchSysChatMsg,this.updataList),this.addLsn(GuildSys.ins().patchGuildMessage,this.updataList),this.addLsn(GuildActSys.ins().patchGuildBossTeamInvitation,this.updataList),this.addLsn(FbSys.ins().patchGuaJiHelpBroadcast,this.updataList),this.addLsn(FbSys.ins().patchGuaJiAssistBroadcast,this.updataList),this.addLsn(FbSys.ins().patchMoLongYaoQing,this.updataList),this.updataList()},e.prototype.updataList=function(){var t=ChatSys.ins().getMsgsByType(ChatType.All);t.chatBaseDatas.length<=0||this.lastTime==t.chatBaseDatas[t.chatBaseDatas.length-1].timer||(this.dataList.source=t.chatBaseDatas,this.lastTime=t.chatBaseDatas[t.chatBaseDatas.length-1].timer)},e.prototype.onListTap=function(t){var e=t.target,i=e.data;i&&e.data.type==ChatType.Camp?GuildActSys.ins().sendGuildBossTeam(i.roleId):(openWin(ChatWin),this.visible=!1)},e}(BaseEUI);__reflect(MainChat.prototype,"MainChat"),window.MainChat=MainChat;var MainMap=function(t){function e(){var e=t.call(this)||this;return e.bottom=0,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(LogicSys.ins().patchCreateCommEntity,this.updataMapName),LogicSys.ins().centerEntity&&this.updataMapName()},e.prototype.updataMapName=function(){this.fbid==FbSys.ins().fbId?this.mainUI_LeftTop&&this.mainUI_LeftTop.open():this.openFubenScoring(FbSys.ins().fubenConfig.group)},e.prototype.updateMap=function(){this.openFubenScoring(FbSys.ins().fubenConfig.group)},e.prototype.openFubenScoring=function(t){if(this.mainUI_LeftTop&&(this.mainUI_LeftTop.close(),DisUtil.remove(this.mainUI_LeftTop),this.mainUI_LeftTop=null),t==FbGroup.City)FbSys.ins().qmdbModel.isOpen()&&(this.mainUI_LeftTop=new QMDBFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0);else if(100>t);else switch(t){case FbGroup.Exp:case FbGroup.Gold:case FbGroup.Mojing:case FbGroup.Qizhi:case FbGroup.TianFu:case FbGroup.Damon:case FbGroup.Yongbing:case FbGroup.Shenmo:case FbGroup.Shenqi:case FbGroup.Wing:case FbGroup.Sz:case FbGroup.Meilin:this.mainUI_LeftTop=new MeiRiMapFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.Emo:this.mainUI_LeftTop=new EmoScoringPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.XueSe:this.mainUI_LeftTop=new XueSeScoringPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.RedFortress:this.mainUI_LeftTop=new RedFortFbPanel,this.mainUI_LeftTop.height=void 0,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.BossHome:this.mainUI_LeftTop=new BossHomeFbPanel,this.mainUI_LeftTop.height=void 0,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.GuildWarPVE:case FbGroup.GuildWarPVP:this.mainUI_LeftTop=new GuildWarFbPanel;break;case FbGroup.Mine:this.mainUI_LeftTop=new MineFBPanel;break;case FbGroup.kfbosssd:this.mainUI_LeftTop=new SmsdFbPanel;break;case FbGroup.KuaFuBoss:this.mainUI_LeftTop=new KfBossFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.QiyuEvent3:this.mainUI_LeftTop=new QiyuFbPanel3,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.MoLong:this.mainUI_LeftTop=new MoLongFBPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.ShiJieBoss:this.mainUI_LeftTop=new ZhuZaiFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.ShenDian:this.mainUI_LeftTop=new ShenDianFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.Siege:this.mainUI_LeftTop=new MonsterSiegeFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.GuildBattle:this.mainUI_LeftTop=new GuildBattleFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.Guzhanchang:this.mainUI_LeftTop=new GuZhanFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.Brave:this.mainUI_LeftTop=new BraveFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.Kalima:this.mainUI_LeftTop=new KlmFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;case FbGroup.CampWar:this.mainUI_LeftTop=new CampWarFbPanel,this.mainUI_LeftTop.top=0,this.mainUI_LeftTop.bottom=0;break;default:this.mainUI_LeftTop=new MainUIMapFuben}this.mainUI_LeftTop&&(this.mainUI_LeftTop.left=0,this.mainUI_LeftTop.right=0,this.mainUI_LeftTop.open(),this.addChild(this.mainUI_LeftTop),this.validateNow(),this.mainUI_LeftTop.validateNow())},e.prototype.updateTime=function(t){void 0===t&&(t=0),this.mainUI_LeftTop&&this.mainUI_LeftTop.updateTime()},e.prototype.getGuildWarEnemyItem=function(){this.validateNow();var t,e=this.mainUI_LeftTop;return e instanceof GuildWarFbPanel&&(t=e.getEnemyItem()),t},e.prototype.getXueseFbGrowBtn=function(){return this.mainUI_LeftTop instanceof XueSeScoringPanel?this.mainUI_LeftTop.getXueseFbGrowBtn():null},e.prototype.getEmoFbGrowBtn=function(){return this.mainUI_LeftTop instanceof EmoScoringPanel?this.mainUI_LeftTop.getEmoFbGrowBtn():null},__decorate([callDelay()],e.prototype,"updataMapName",null),e}(BaseWinSingle);__reflect(MainMap.prototype,"MainMap"),window.MainMap=MainMap;var MainName=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Main,e.winType=WinType.NeverCloseWin,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isLog=!1,this.skinName="MianNameSkin1",this.touchEnabled=!1},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(LogicSys.ins().patchAllSysInit,this.allSysInit),this.addLsn(LogicSys.ins().patchCurrency,this.updateCurrency),this.addClickE(this.imgDiamon,this.onClick),this.addClickE(this.labelMesonry,this.onClick),this.allSysInit()},e.prototype.allSysInit=function(){this.updateCurrency()},e.prototype.updateCurrency=function(t){t?t.type==CurType.JinZuan?this.lbJinZuan.text=GFunc.overLength(Actor.ins().getCurrency(CurType.JinZuan)):t.type==CurType.gold?this.labelGoldTxt.text=GFunc.overLength(Actor.ins().getCurrency(CurType.gold)):t.type==CurType.yb&&(this.labelMesonry.text=GFunc.overLength(Actor.ins().getCurrency(CurType.yb))):(this.lbJinZuan.text=GFunc.overLength(Actor.ins().getCurrency(CurType.JinZuan)),this.labelGoldTxt.text=GFunc.overLength(Actor.ins().getCurrency(CurType.gold)),this.labelMesonry.text=GFunc.overLength(Actor.ins().getCurrency(CurType.yb)))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.labelMesonry:case this.imgDiamon:openWin(RechargeWin)}},e}(BaseWinSingle);__reflect(MainName.prototype,"MainName"),window.MainName=MainName;var MainQiJi=function(t){function e(){var e=t.call(this)||this;return e.id=1,e.skinName="MainQiJiZhiLuSkin",e}return __extends(e,t),e.prototype.show=function(){this.tempParent&&this.tempParent.addChild(this)},e.prototype.addDisplay=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tempParent=this.parent,this.addClickE(this,this.onClick),this.addLsn(JobSys.ins().patchQiJizl,this.updataData),this.addLsn(RpSys.ins().patchRp,this.updateRedPoint),this.addLsn(FbSys.ins().patchGuaJiInfo,this.updataData),this.addLsn(FbSys.ins().patchGuaJiChallenge,this.updataData),this.addLsn(FbSys.ins().patchGuaJiHelp,this.updataData),this.updateRedPoint(),this.updataData()},e.prototype.updateRedPoint=function(t){void 0===t&&(t=null),(!t||t.check(ZhuoYueWin))&&(this.redPoint.visible=RpSys.ins().getData(ZhuoYueWin),this.redPoint.visible&&(this.mcName=DIR.res_eff+"qjzlzjm"))},e.prototype.updataData=function(){this.curConfig=Cfg.getConfig(WayConfig,CondType.More,WayConfig.guanqia,FbSys.ins().guajiData.guanId),JobSys.ins().getAllSysOpen()&&(this.curConfig=JobSys.ins().getQijiReceiveAwardData()),this.curConfig&&(this.imgIcon.source=ResMgr.getQijiIconRes1(this.curConfig.id,!1),this.imgTitle.source=ResMgr.getQijiNameRes1(this.curConfig.id,!0),this.lbGuanqia.text="第"+this.curConfig.guanqia+"层开启")},e.prototype.onClick=function(t){openWin(ZhuoYueWin,0)},e}(BaseEUI);__reflect(MainQiJi.prototype,"MainQiJi"),window.MainQiJi=MainQiJi;var MainTask=function(t){function e(){var e=t.call(this)||this;return e.TaskType=0,e.taskOkStatus=!1,e.skinName="MainTaskSkin",e.touchEnabled=!1,e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.addDisplay=function(){this.addLsn(TaskSys.ins().patchMainTaskReward,this.TaskNav),this.addLsn(TaskSys.ins().patchMainTaskUpdata,this.TaskNav),this.addLsn(TaskSys.ins().patchMainTaskReward,this.descAnimation),this.TaskNav()},e.prototype.TaskNav=function(){if(0!=TaskSys.ins().taskId){this.taskOkStatus=!1;var t=!0;if(TaskSys.ins().taskId>0&&2!=TaskSys.ins().mainTaskStatus&&t){t=!1,this.TaskType=0;var e=TaskSys.ins().mainTaskStatus,i=Cfg.getConfig(MainTaskConfig,TaskSys.ins().taskId);i.awardShow;if(i.isAuto?this.taskShowAuto(i,TaskSys.ins().mainTaskokValue,e):this.taskShow(i.desc,"",TaskSys.ins().mainTaskokValue,i.showTarget,i.name,e,i.awardShow,i.type),i.isAuto&&1==e)return void this.autoCompleteTask(i);if(1==e)return}t&&(this.taskOkStatus=!0)}},e.prototype.autoCompleteTask=function(t){t.controlTarget==TaskNavType.FindNpc?GFunc.createTaskNavData(t.controlTarget)["goto"]():TaskSys.ins().sendMainTaskOK()},e.prototype.taskShowAuto=function(t,e,i){var n="",a="";if(1==i)n=StrUtil.addColor(Lang.common_str76,4718455),a=t.descComele?t.descComele:"";else{var o=e>=t.showTarget?4718455:16729927;a=t.desc?t.desc:""+StrUtil.addColor("("+e+"/"+t.showTarget+")",o)}this.lbTaskName.textFlow=addColorTF(t.name+n),this.lbTaskDesc.textFlow=addColorTF(a)},e.prototype.taskShow=function(t,e,i,n,a,o,s,r){void 0===r&&(r=0);var u=StrUtil.addColor(Lang.common_str76,4718455);if(0==o)if(2==r)u="";else{var h=i>=n?4718455:16729927;u=StrUtil.addColor("("+i+"/"+n+")",h)}this.lbTaskName.textFlow=addColorTF(StrUtil.addColor(e,2407922)+a+u),this.lbTaskDesc.textFlow=addColorTF(t),this.mc=1==o?ResMgr.getEffName("rweff1"):""},e.prototype.onClick=function(t){var e,i=0,n=[];if(0==this.TaskType){if(TaskSys.ins().saveMainTaskId.push(TaskSys.ins().taskId+"_"+TaskSys.ins().mainTaskStatus),1==TaskSys.ins().mainTaskStatus)return void TaskSys.ins().sendMainTaskOK();var a=Cfg.getConfig(MainTaskConfig,TaskSys.ins().taskId);if(2==a.type&&a.showTarget>Actor.ins().level)return void openWin(MeNeedLevelWin,1);n=a.controlTarget,e=GFunc.createTaskNavData(n),i=a.sysid}e["goto"](i)},e.prototype.descAnimation=function(t){var e=this,i=0;if(0!=t){var n=Cfg.getConfig(MainTaskConfig,t);i=n.next}this.mcGroup.addChild(MC.createCenterGruop(getEffName("complete"),1,function(){0!=i&&0!=t&&e.mcGroup.addChild(MC.createCenterGruop(getEffName("receive"),1))}))},e.prototype.getGroup1=function(){return this.eg||(this.eg=new eui.Group,this.eg.right=this.eg.left=this.eg.top=this.eg.bottom=0,this.addChild(this.eg)),this.eg},e.prototype.getGroupdesc=function(){return this},e}(BaseEUI);__reflect(MainTask.prototype,"MainTask"),window.MainTask=MainTask;var MainTianShiTouXianBtn=function(t){function e(){var e=t.call(this)||this;return e.skinName="MainTianShiTouXianBtnEUI",e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.skinComplete=function(){this.addClickE(this,this.onClick)},e.prototype.addDisplay=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addLsn(JobSys.ins().patchZS,this.updatePanel),this.updatePanel()},e.prototype.updatePanel=function(){var t=this,e=JobSys.ins().zsData,i=Cfg.getConfig(ChongshengLevelConfig,e.isMaxChong()?e.config.cslevel:e.config.cslevel+1),n=GFunc.creatItemDataById(i.additem2[0].id),a=Cfg.getConfig(ShenqiHuanhuaBaseConfig,n.cfg.huanhuaId),o=Cfg.getConfig(WeaponAppearanceConfig,a.weaponIds[Actor.ins().job-1]).appearance;this.mc1=ResMgr.getWeaponUIEFFResource(o),Timer.ins()["do"](800,1,1,function(){t.mc2=ResMgr.getEffName("tszl")},this)},e.prototype.onClick=function(){isShowWin(JobWin)?closeWin(JobWin):openWin(JobWin)},e}(BaseEUI);__reflect(MainTianShiTouXianBtn.prototype,"MainTianShiTouXianBtn"),window.MainTianShiTouXianBtn=MainTianShiTouXianBtn;var MainUIButton=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Main_Down,e.winType=WinType.NeverCloseWin,e.tempBoo=!1,e.skinName="MainUIButtonEUI",e.isLog=!1,e.initUI(),e.touchEnabled=!1,e.btns=[e.toggleBtnRole,e.toggleBtnBag,e.btnYB,e.toggleForging,e.btnSkill],e.btn_XLHB.redPoint.visible=!0,e.btn_chat.redPoint.visible=!0,e}return __extends(e,t),e.prototype.addDisplay=function(){this.addClickE(this.bagMaxIcon,this.onClick),this.addClickE(this.toggleBtnRole,this.onClick),this.addClickE(this.toggleBtnBag,this.onClick),this.addClickE(this.toggleForging,this.onClick),this.addClickE(this.btnYB,this.onClick),this.addClickE(this.btnSkill,this.onClick),this.addClickE(this.xlGroup,this.onClick),this.addClickE(this.btn_RedBao,this.onClick),this.addClickE(this.btn_Mail,this.onClick),this.addClickE(this.btn_chat,this.onClick),this.addClickE(this.btn_XLHB,this.onClick),this.addClickE(this,this.onItemClick),this.addLsn(LogicSys.ins().patchLevelChange,this.updataExp),this.addLsn(LogicSys.ins().patchExpChange,this.updataExp),this.addLsn(LogicSys.ins().patchActorInfo,this.updataExp),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(BagSys.ins().patchBagVolChange,this.updateBagMaxIcon),this.addLsn(RechargeActSys.ins().patchRedbaoInfo,this.updateRedBag),this.addLsn(RechargeActSys.ins().patchRedbaoRobResult,this.updateRedBag),this.addLsn(RechargeActSys.ins().patchRedbaoRobInfo,this.updateRedBag),this.addLsn(RechargeActSys.ins().patchRedbaoInfo2,this.updateRedBag),this.addLsn(JobSys.ins().patchQiJizl,this.updateRedBag),this.addLsn(LogicSys.ins().patchEnterMap,this.patchEnterMap),this.addLsn(WinMgr.ins().patchTopWinOpen,this.patchTopWinOpen),this.addLsn(WinMgr.ins().patchTopWinClose,this.patchTopWinClose),this.addLsn(MailSys.ins().patchMailData,this.updateMail),this.addLsn(XianLuSys.ins().updateXianyuanHBInfo,this.updateXLHB),this.addLsn(XianLuSys.ins().openXianyuanHBInfo,this.updateXLHB),this.addLsn(ChatSys.ins().updateXianluChat,this.updateXianluChat),this.addLsn(ShouHuNewSys.ins().patchShenmoHuanHua,this.updateState),this.addLsn(ShouHuNewSys.ins().patchShenmoBianShen,this.tweenBianshen),this.addLsn(JobSys.ins().patchSysOpen,this.onNewSysOpen),this.addLsn(AIRole.startAtk,this.autoBs),this.addLsn(ChatWin.showChatWin,this.updateChatWin),this.updateRp(),this.updateBagMaxIcon(),this.updateRedBag(),this.updateMail(),this.mainTianShiTouXianBtn.open(),GFunc.zoom(this.bagMaxIcon,1,1.2,0,500),this.addDisplayActRp(this.toggleBtnRole,RoleWin),this.addDisplayActRp(this.toggleForging,ForgeWin),this.eAuto.selected=!0,this.updateChatWin(),this.updateXianluChat(!1),this.updateXLHB(),this.updateState()},e.prototype.updateXLHB=function(){WinMgr.ins().hasTopWinNotClose()?this.groupXLHB.visible=!1:this.groupXLHB.visible=XianLuSys.ins().hadHongBao},e.prototype.updateXianluChat=function(t){WinMgr.ins().hasTopWinNotClose()?this.groupChat.visible=!1:(isShowWin(ChatWin)?this.groupChat.visible=!1:this.groupChat.visible=t,this.tempBoo=t)},e.prototype.updateChatWin=function(){this.chatBg.visible=isShowWin(ChatWin)},e.prototype.autoBs=function(t){var e=LogicSys.ins().centerEntity;t==e.handle&&this.canBS&&this.eAuto.selected&&e.AI.canBianshen()&&(this.canBS=!1,ShouHuNewSys.ins().sendShenmoBianShen())},e.prototype.onNewSysOpen=function(t){t==SysId.Shenmo&&this.updateState()},e.prototype.updateState=function(){var t=!ShouHuNewSys.ins().canBianshen();if(t)return void(this.currentState="noXL");this.currentState="normal";var e=ShouHuNewSys.ins().shenmoModel.useId;if(e>0){var i=Cfg.getConfig(ShenmoHuanhuaBaseConfig,e);this.xlHead="res/monhead/smhead"+i.id+".png"}else this.xlHead="";this.tweenBianshen()},e.prototype.tweenBianshen=function(){var t=this,e=ShouHuNewSys.ins(),i=e.shenmoModel.useId,n=e.bianshenDurationTime,a=e.bianshenCdTime;if(i){var o=Cfg.getConfig(ShenmoHuanhuaBaseConfig,i).cd;if(egret.Tween.removeTweens(this.eMc),this.canBS=!1,a)return void egret.Tween.get(this.eMc).to({drawRect:0},a).wait(50).call(this.tweenBianshen,this);o*=1e3;var s=(o-n)/o;0>s||(this.eMc.drawRect=s,egret.Tween.get(this.eMc).to({drawRect:1},o*(1-s)).call(function(){t.canBS=!0}))}},e.prototype.onItemClick=function(t){var e=t.target;if(e&&e instanceof eui.Button){var i=RuleIconMgr.ins().getRule(e);i&&i.tapExecute()}},e.prototype.patchEnterMap=function(){this.updateRedBag(),this.updateMail(),this.updateXianluChat(this.tempBoo),this.updateXLHB()},e.prototype.patchTopWinOpen=function(){this.updateRedBag(),this.updateMail(),this.updateXianluChat(this.tempBoo),this.updateXLHB()},e.prototype.patchTopWinClose=function(){this.updateRedBag(),this.updateMail(),this.updateXianluChat(this.tempBoo),this.updateXLHB()},e.prototype.updateRedBag=function(){this.redBaoGroup.visible=!1,WinMgr.ins().hasTopWinNotClose()?(this.btn_RedBao.visible=!1,Timer.ins().remove(this.onMoveShake,this)):(this.btn_RedBao.visible=!1,Timer.ins()["do"](2e3,2e3,0,this.onMoveShake,this))},e.prototype.onMoveShake=function(){egret.Tween.removeTweens(this.btn_RedBao);var t=egret.Tween.get(this.btn_RedBao);t.to({rotation:-30},100,egret.Ease.cubicIn).to({rotation:30},200,egret.Ease.cubicIn).to({rotation:0},100,egret.Ease.cubicIn)},e.prototype.updateMail=function(){var t=MailSys.ins().getMailByReceive2().length;WinMgr.ins().hasTopWinNotClose()?(this.groupMail.visible=!1,Timer.ins().remove(this.onMailMoveShake,this)):(this.groupMail.visible=t>0&&GFunc.isSysOpen(SysId.Mail),Timer.ins()["do"](2e3,2e3,0,this.onMailMoveShake,this)),this.lbMailCouont.text=t>99?"N":t.toString()},e.prototype.onMailMoveShake=function(){DisUtil.shakeIt(this.groupMail,5,100)},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(RoleWin))&&(this.toggleBtnRole.redPoint.visible=RpSys.ins().getData(RoleWin)),(!t||t.check(ShouHuWin))&&(this.btnYB.redPoint.visible=RpSys.ins().getData(ShouHuWin)),(!t||t.check(BagWin))&&(this.toggleBtnBag.redPoint.visible=RpSys.ins().getData(BagWin)),(!t||t.check(ForgeWin))&&(this.toggleForging.redPoint.visible=RpSys.ins().getData(ForgeWin)),(!t||t.check(JobWin))&&(this.mainTianShiTouXianBtn.redPoint.visible=RpSys.ins().getData(JobWin)),(!t||t.check(SkillWin))&&(this.btnSkill.redPoint.visible=RpSys.ins().getData(SkillWin))},e.prototype.updateNpcRed=function(){},e.prototype.updateBagMaxIcon=function(){var t=0==BagSys.ins().getSurplusCount();this.bagMaxIcon.visible!=t&&(this.bagMaxIcon.visible=t)},e.prototype.updataExp=function(){var t=this;egret.Tween.removeTweens(this.progressBarExp);var e=egret.Tween.get(this.progressBarExp);if(Actor.ins().totalexp>this.progressBarExp.maximum){var i=egret.Tween.get(this.progressBarExp);i.to({value:this.progressBarExp.maximum},250).call(function(){var e=egret.Tween.get(t.progressBarExp);t.progressBarExp.maximum=Actor.ins().totalexp,t.progressBarExp.value=0,e.to({value:Actor.ins().exp},150)})}else this.progressBarExp.maximum=Actor.ins().totalexp,e.to({value:Actor.ins().exp},150);this.updateBagMaxIcon(),this.updateNpcRed()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_XLHB:XianLuSys.ins().sendOpenHongbao();break;case this.btn_chat:this.tempBoo=!1,this.updateXianluChat(this.tempBoo),openWin(ChatWin,4);break;case this.xlGroup:ShouHuNewSys.ins().sendShenmoBianShen();break;case this.btnSkill:openWin(SkillWin);break;case this.btn_Mail:openWin(MailWin);break;case this.btn_RedBao:openWin(RedBaoWin);break;case this.toggleBtnRole:this.openWin(RoleWin);break;case this.bagMaxIcon:case this.toggleBtnBag:this.openWin(BagWin);break;case this.btnYB:openWin(ShouHuWin);break;case this.toggleForging:this.openWin(ForgeWin)}},e.prototype.openWin=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];isShowWin(t)?closeWin(t):openWin.apply(void 0,[t].concat(e))},e.prototype.getToggleBtn=function(t){return this.btns[t]},e.prototype.getBagBtn=function(){return this.toggleBtnBag},e.prototype.getForgeBtn=function(){return this.toggleForging},e.prototype.getRoleBtn=function(){return this.toggleBtnRole},e.prototype.getBtnTianShiTouXian=function(){return this.mainTianShiTouXianBtn},e.prototype.getBtnSkill=function(){return this.btnSkill},e.prototype.getBtnYB=function(){return this.btnYB},e.NAV_ROLE=0,e.NAV_BAG=1,e.NAV_TASK=2,e.NAV_FORGE=3,e.NAV_NPC=4,e.NAV_SHENMO=5,__decorate([callDelay(50)],e.prototype,"updateChatWin",null),e
}(BaseWinSingle);__reflect(MainUIButton.prototype,"MainUIButton"),window.MainUIButton=MainUIButton;var MainUIMapFuben=function(t){function e(){var e=t.call(this)||this;return e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="mainUI_LeftTopSkin1",this.showFbCurrencyStatistics([0,0]),this.groupExp.visible=!1},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(LogicSys.ins().patchEnterMap,this.updataMapName),this.addLsn(FbSys.ins().patchUpdateFbTime,this.updataMapName),this.addLsn(FbSys.ins().patchFbCurrency,this.showFbCurrencyStatistics),this.addLsn(FbSys.ins().patchUpdateFbTime,this.showFbCurrencyStatistics),this.updataMapName()},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this)},e.prototype.updataMapName=function(){FbSys.ins().commonEndTick>0&&Timer.ins()["do"](0,1e3,0,this.SweepCountDown,this,TimerType.LAST)},e.prototype.showFbCurrencyStatistics=function(t){if(FbSys.ins().commonEndTick>0){var e=Cfg.getConfig(FubenConfig,FbSys.ins().fbId).group;if(FbSys.ins().isShowFuBenCurrency(e)){var i=FbSys.ins().fubenCurrency;this.helpTxt.text=Lang.fb_str28+FbSys.ins().getFubenCurrency(e),this.countBmp.text=i.toFixed(0),this.currentState="h1"}else this.currentState="h2"}else this.currentState="h3"},e.prototype.SweepCountDown=function(t){this.bmpTime.text=FbSys.ins().surplusTime+"s"},e}(BasePanel);__reflect(MainUIMapFuben.prototype,"MainUIMapFuben"),window.MainUIMapFuben=MainUIMapFuben;var MainUIMapItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="MainUIMapItemEUI",e.mcCircleMask=new MaskSector,e.mcCircleMask.setParam(32,120,50,0),e.mcCircleMask.x=65,e.mcCircleMask.y=56,e.groupMap.addChild(e.mcCircleMask),e.beimc=new MC,e.beimc.x=19,e.beimc.y=15,e.groupMap.addChild(e.beimc),e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.open=function(){this.addLsn(LogicSys.ins().patchEnterMap,this.updataMapName),this.addLsn(FbSys.ins().patchGuaJiChallenge,this.updataMapName),this.addLsn(FbSys.ins().patchGuaJiHelp,this.updataMapName),this.addLsn(LogicSys.ins().patchEnterMap,this.QieHuanMapIcon),this.addClickE(this.btnCity,this.onClick),this.QieHuanMapIcon(),this.updataMapName(),this.updateState()},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this)},e.prototype.updateState=function(){var t=Cfg.getConfig(FubenConfig,FbSys.ins().fbId),e=Cfg.getConfig(FubenGroupConfig,t.group);e.type==GroupType.xianshi?t.group<100?this.currentState="main":this.currentState="fuben":this.currentState="nonamefuben"},e.prototype.QieHuanMapIcon=function(){GFunc.isInCity()?this.btnCity.icon="mianui_zycs_zhandou":this.btnCity.icon="mianui_zycs_huicheng"},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnCity:GFunc.enterCityOrGuaJi()}},e.prototype.updataMapName=function(){var t=Cfg.getConfig(GuajiFubenConfig,FbSys.ins().guajiData.challengeGuanId);this.labelExp.text=GFunc.overLength(t.exp,t.exp<1e8?1:2)+"/"+Lang.common_xs,this.labelGold.text=GFunc.overLength(t.gold,t.gold<1e8?1:2)+"/"+Lang.common_xs,this.labelMapName1.text=Cfg.getFubenName(FbSys.ins().fbId),this.updateState()},e.prototype.getMapBtn=function(){return this.imgOpenMap},e.prototype.getbtnCity=function(){return this.btnCity},e}(BasePanel);__reflect(MainUIMapItem.prototype,"MainUIMapItem"),window.MainUIMapItem=MainUIMapItem;var MainUITipsPower=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.NeverCloseWin,e.layer=LayerMgr.Popup,e.hig=40,e.attrs=[],e.curIndex=0,e.totalIndex=0,e.isTeenRun=!1,e.skinName="MainUITipsPowerEUI",e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.open=function(e){e&&(t.prototype.open.call(this),this.attrs=this.attrs.length<=1?e:this.attrs.concat(e),this.uodatePanel())},e.prototype.uodatePanel=function(){this.totalIndex=this.attrs.length,1==this.totalIndex&&(this.isTeenRun=!1,this.curIndex=0,this.groupAttr.y=963,this.groupAttr.alpha=1,this.groupAttr.removeChildren(),egret.Tween.removeTweens(this.groupAttr)),this.curIndex<this.totalIndex&&!this.isTeenRun&&(this.isTeenRun=!0,this.itemTween())},e.prototype.itemTween=function(){var t=this;if(this.curIndex<this.totalIndex){var e=this.crateItem(this.curIndex,this.attrs[this.curIndex]),i=0==this.curIndex?200:100;0==this.curIndex?300:150;this.curIndex+=1;var n=egret.Tween.get(e);n.to({alpha:1,x:0},i).call(function(){1==t.totalIndex||t.curIndex==t.totalIndex?t.groupTweenEnd():t.groupTweenUp()},this)}},e.prototype.groupTweenUp=function(){if(this.curIndex>0){var t=egret.Tween.get(this.groupAttr),e=this.groupAttr.y-this.hig,i=0==this.curIndex?300:150;t.wait(i).to({y:e},150).call(this.groupTweenEnd,this)}},e.prototype.groupTweenEnd=function(){if(this.curIndex<this.totalIndex)this.itemTween();else{var t=egret.Tween.get(this.groupAttr),i=this.groupAttr.y-this.hig;t.wait(300).to({y:i,alpha:0},300,egret.Ease.cubicIn).call(function(){closeWin(e)},this)}},e.prototype.crateItem=function(t,e){var i=new MainUITipsPowerItem;return this.groupAttr.addChild(i),i.setData(e),i.alpha=0,i.x=280,i.y=t*this.hig,i},e}(BaseWinSingle);__reflect(MainUITipsPower.prototype,"MainUITipsPower"),window.MainUITipsPower=MainUITipsPower;var MainUITipsPower2=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.NeverCloseWin,e.layer=LayerMgr.Popup,e.itemsAll=[],e.items1=[],e.items2=[],e.attrs=[],e.hig=40,e.curIndex=0,e.totalIndex=0,e.skinName="MainUITipsPowerEUI",e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.attrs=this.attrs.concat(e),this.updatePanel()},e.prototype.addAttrData=function(t){this.attrs.length-this.curIndex-1>4&&this.attrs.splice(this.curIndex+2,6),this.attrs=this.attrs.concat(t),this.totalIndex=this.attrs.length},e.prototype.updatePanel=function(){this.totalIndex=this.attrs.length,Timer.ins()["do"](0,500,0,this.itemTween,this)},e.prototype.itemTween=function(){var t=this;if(this.curIndex<this.totalIndex){var e=this.crateItem(this.curIndex,this.attrs[this.curIndex]),i=egret.Tween.get(e);i.to({alpha:1,x:0},150).call(function(){t.groupAttr.addChild(e),e.y=t.curIndex*t.hig,t.itemTweenEnd2(e),t.items2.push(t.items1.shift()),t.curIndex+=1},this),this.curIndex>0&&this.groupTweenUp()}},e.prototype.groupTweenUp=function(){var t=egret.Tween.get(this.groupAttr),e=this.groupAttr.y-this.hig;t.to({y:e},150)},e.prototype.itemTweenEnd2=function(t){var i=this,n=egret.Tween.get(t),a=t.y-1.5*this.hig;n.wait(900).to({y:a,alpha:0},300,egret.Ease.cubicIn).call(function(){t.index>=i.totalIndex-1?closeWin(e):i.itemsAll.push(i.items2.shift())},this)},e.prototype.crateItem=function(t,e){var i=this.itemsAll.shift()||new MainUITipsPowerItem;return this.group.addChild(i),i.setData(e),i.alpha=0,i.x=280,i.y=963,i.index=t,this.items1.push(i),i},e}(BaseWinSingle);__reflect(MainUITipsPower2.prototype,"MainUITipsPower2"),window.MainUITipsPower2=MainUITipsPower2;var MainUITipsPowerItem=function(t){function e(){var e=t.call(this)||this;return e.data=null,e.index=0,e.skinName="MainUITipsPowerItemEUI",e}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.arr=AttrData.parse([t],{fm:"%k +%v",fix:function(t,e,i){return t.replace(i+"",i.toFixed(0))}}).join().split(" ")},e}(BaseItemRender);__reflect(MainUITipsPowerItem.prototype,"MainUITipsPowerItem"),window.MainUITipsPowerItem=MainUITipsPowerItem;var MainUITipsPowerItem2=function(t){function e(){var e=t.call(this)||this;return e.data=null,e.index=0,e._isRemoveTweening=!1,e._isAddTimer=!1,e.skinName="MainUITipsPowerItemEUI",e._isRemoveTweening=!1,e._isAddTimer=!1,e}return __extends(e,t),e.prototype.setData=function(t){this.group.x=0,this.data=t,this.arr=AttrData.parse([t],{fm:"%k +%v",fix:function(t,e,i){return t.replace(i+"",i.toFixed(0))}}).join().split(" "),this.addTimer()},e.prototype.addTimer=function(){0==this._isAddTimer&&(this._isAddTimer=!0,this._isRemoveTweening=!1,Timer.ins()["do"](739,1,1,this.tweenToDisappear,this))},e.prototype.tweenToDisappear=function(){0==this._isRemoveTweening&&(this._isRemoveTweening=!0,egret.Tween.removeTweens(this.group),egret.Tween.get(this.group).to({x:-this.width},200).call(this.removeFromParent,this))},e.prototype.removeFromParent=function(){Timer.ins().remove(this.tweenToDisappear,this),DisUtil.remove(this)},e.prototype.reset=function(){this._isAddTimer=!1,this._isRemoveTweening=!1,this.group.x=0,this.arr.length=0},e}(BaseItemRender);__reflect(MainUITipsPowerItem2.prototype,"MainUITipsPowerItem2"),window.MainUITipsPowerItem2=MainUITipsPowerItem2;var MainWin=function(t){function e(){var e=t.call(this)||this;return e.isShowVip=!1,e.destroyTime=DateUtil.SECOND_PER_WEEK,e.isLog=!1,e.skinName="MainWinEUI",e.layer=LayerMgr.Main_Down1,e}return __extends(e,t),e.prototype.skinComplete=function(){this.mainMap=new MainMap,this.group.addChild(this.mainMap),this.isShowVip=!LogicSys.ins().isFirstRegister,this.mcVip.visible=this.mcSVip.visible=!1},e.prototype.open=function(){t.prototype.open.call(this),this.isShow()||(this.btnRecharge.visible=this.btnGoldRecharge.visible=this.btnJinZuanRecharge.visible=this.btnRecharge1.visible=!urlParam.isShenhe,this.addClickE(this.btnMail,this.onClick),this.addClickE(this.btnClose,this.onClick),this.addClickE(this.imgVipBg,this.onClick),this.addClickE(this.imgSVipBg,this.onClick),this.addClickE(this.imageRole,this.onClick),this.addClickE(this.btnBuff,this.onClick),this.addClickE(this.imgDiamon,this.onClick),this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.btnRecharge1,this.onClick),this.addClickE(this.groupJinzuan,this.onClick),this.addClickE(this.groupGold,this.onClick),this.addClickE(this.groupYb,this.onClick),this.addClickE(this.btnShop,this.onClick),this.addClickE(this.btnXianlu,this.onClick),this.addLsn(LogicSys.ins().patchAllSysInit,this.onAllSysinit),this.addLsn(LogicSys.ins().patchFbInfo,this.updataPower),this.addLsn(LogicSys.ins().patchPowerChange,this.updataPower),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(VipSys.ins().patchSvipData,this.updateVipData),this.addLsn(VipSys.ins().patchVipUpdate,this.updateVipData),this.addLsn(VipSys.ins().patchVipFlyEnd,this.updateVipFlyEnd),this.addLsn(LogicSys.ins().patchEnterMap,this.updateMap),this.addLsn(FuLiSys.ins().patchDailyOnlineAward,this.updateComDailyOnline),this.addLsn(FuLiSys.ins().patchDailyOnlineData,this.updateComDailyOnline),this.addLsn(JobSys.ins().patchSysOpen,this.updateComDailyOnline),this.addLsn(FbSys.ins().patchGuaJiChallenge,this.updateGuanQia),this.addLsn(FbSys.ins().patchGuaJiBossShow,this.updateGuanQiaBoss),this.addLsn(LogicSys.ins().patchCurrency,this.updateCurrency),this.addLsn(LogicSys.ins().patchLevelChange,this.updateLv),this.addLsn(JobSys.ins().patchZS,this.updateLv),this.setHead(),this.com_ext.open(),this.com_Chat.open(),this.mainMap.open(),this.mainUIMapItem.open(),this.btnGuaji.open(),this.updateRp(),this.updateVipData(),this.onAllSysinit(),this.updateMap())},e.prototype.close=function(){t.prototype.close.call(this),this.btnGuaji.close(),this.com_ext.close(),this.comDailyOnline.close(),GFunc.isShowExtActIcon=this.com_ext.getIsShowBtn()},e.prototype.updateTime=function(e){void 0===e&&(e=0),t.prototype.updateTime.call(this,e),this.mainMap&&this.mainMap.updateTime(e)},e.prototype.onAllSysinit=function(){this.updataPower(),this.updataView(),this.updateVipData(),this.updateLv(),this.updateComDailyOnline()},e.prototype.updateComDailyOnline=function(t){if(void 0===t&&(t=SysId.DailyOnline),t==SysId.DailyOnline){var e=FuLiSys.ins().dailyOnlineData;if(GFunc.isSysOpen(SysId.DailyOnline)&&e.isBefore3Day())if(e.isBefore1Day()||!e.hasGetAllAward()){this.comDailyOnline.open();var i=new eui.HorizontalLayout;i.gap=22,this.groupSingleAct.layout=i}else{this.comDailyOnline.close();var i=new eui.HorizontalLayout;i.gap=0,this.groupSingleAct.layout=i}else{this.comDailyOnline.close();var i=new eui.HorizontalLayout;i.gap=0,this.groupSingleAct.layout=i}}},e.prototype.updateGuanQiaBoss=function(){this.com_ext.updateGuanQiaBoss(),this.updateGuanQia()},e.prototype.updateMap=function(){this.updataMapName(),this.updateGuanQiaBoss()},e.prototype.updataMapName=function(){this.iniMapName(),this.updateActBtn()},e.prototype.iniMapName=function(){var t=FbSys.ins().fbId,e=Cfg.getConfig(FubenConfig,t),i=Cfg.getConfig(FubenGroupConfig,e.group);this.com_Chat.visible=1==i.showchat,this.headGroup.visible=1==i.type;var n=getWin(MainUIButton);n&&(n.visible=1==i.showdownbtn),this.com_Task.visible=1==i.showtask,this.btnClose.visible=1==i.quitfuben,this.com_ext.setMiBtn(1==i.showmiddlebtn),this.groupSingleAct.visible=1==i.singleAct,this.com_ext.visible=1==i.isActIcon;var a=GFunc.isInGuaJiFb();this.comDailyOnline.visible=a||GFunc.isInCity(),RuleIconMgr.ins().updateMC(),this.updateGuanQia()},e.prototype.updateActBtn=function(){this.com_ext.showQieHuan(GFunc.isShowExtActIcon)},e.prototype.updateGuanQia=function(){this.btnGuaji.visible=GFunc.isInGuaJiFb()&&FbSys.ins().guajiData.guanId>=Cfg.getGuajiConstConfig().isShow&&!FbSys.ins().guajiData.isGuanQia},e.prototype.setHead=function(){this.imageRole.source=ResMgr.getHeadIcon(Actor.ins().sex)},e.prototype.updataPower=function(){this.bmpNumberPower.text=Actor.ins().power.toFixed(0)},e.prototype.updateVipFlyEnd=function(){this.isShowVip=!0,this.updateVipData()},e.prototype.updateVipData=function(){this.groupAllVip.visible=this.isShowVip&&!urlParam.isShenhe,this.bitVipLv.text=Actor.ins().vipLv.toString(),this.bitSVipLv.text=Actor.ins().sVipLv.toString();var t=Actor.ins().sVipLv>0;this.groupSVip.visible=t,this.groupVip.visible=!t},e.prototype.updateRp=function(t){(!t||t.check(MailWin))&&(this.btnMail.redPoint.visible=RpSys.ins().getData(MailWin)),(!t||t.check(VipWin))&&(this.imageRedPointSVip.visible=RpSys.ins().getData(VipWin),this.mcVip.visible=RpSys.ins().getData(VipWin),this.mcSVip.visible=RpSys.ins().getData(VipWin)),(!t||t.check(ShopWin))&&(this.btnShop.redPoint.visible=RpSys.ins().getData(ShopWin)),(!t||t.check(SettingAndChatWin))&&(this.imageRedRole.visible=RpSys.ins().getData(SettingAndChatWin)),(!t||t.check(XianLuWin))&&(this.btnXianlu.redPoint.visible=RpSys.ins().getData(XianLuWin))},e.prototype.updataView=function(){this.updateCurrency(),this.updateLv()},e.prototype.updateCurrency=function(t){t?t.type==CurType.JinZuan?this.lbJinZuan.text=GFunc.overLength(Actor.ins().getCurrency(CurType.JinZuan)):t.type==CurType.gold?this.labelGoldTxt.text=GFunc.overLength(Actor.ins().getCurrency(CurType.gold)):t.type==CurType.yb&&(this.labelMesonry.text=GFunc.overLength(Actor.ins().getCurrency(CurType.yb))):(this.lbJinZuan.text=GFunc.overLength(Actor.ins().getCurrency(CurType.JinZuan)),this.labelGoldTxt.text=GFunc.overLength(Actor.ins().getCurrency(CurType.gold)),this.labelMesonry.text=GFunc.overLength(Actor.ins().getCurrency(CurType.yb)))},e.prototype.updateLv=function(){this.lbLevel.textFlow=addColorTF(GFunc.GetLvStrByLv(Actor.ins().level)),this.lbZsLevel.text=GFunc.getZSNameBydb(Actor.ins().zsId)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnShop:openWin(ShopWin);break;case this.groupJinzuan:if(urlParam.isShenhe)return;openWin(JinZuanWin);break;case this.groupGold:if(urlParam.isShenhe)return;GFunc.checkCurrency(CurType.gold,Actor.ins().getCurrency(CurType.gold)+1);break;case this.btnRecharge1:case this.btnRecharge:case this.groupYb:if(urlParam.isShenhe)return;RechargeActSys.ins().firstRechargeData.isRecharge()?RechargePowerSys.ins().zhaoCaiLongData.noBuy()&&GFunc.isSysOpen(SysId.ZhaoCaiLong)?openWin(RechargeTipsWin):openWin(RechargeWin2):openWin(FirstRechargeBuyWin);break;case this.btnClose:var e="",i=Cfg.getConfig(FubenConfig,FbSys.ins().fbId);switch(i.group){case FbGroup.GuildWarPVE:case FbGroup.GuildWarPVP:openWin(GuildWarReliveWin,3);break;default:e=i.group==FbGroup.Mine?Lang.fb_str287:i.group==FbGroup.MoLong&&0!=FbSys.ins().molongData.getState()?"退出副本将扣减次数，是否退出副本？":i.group==FbGroup.Brave?Lang.fb_str26+"\n"+Lang.fb_str360:Lang.fb_str26;var n=new PopupData(e);n.setFunction(this,function(){FbSys.ins().sendExitFb()}),openWin(CommonTipsWin,n)}break;case this.btnXianlu:openWin(XianLuWin);break;case this.btnMail:openWin(MailWin);break;case this.imgVipBg:openWin(VipWin);break;case this.imgSVipBg:openWin(VipWin,1);break;case this.imageRole:openWin(SettingAndChatWin);break;case this.btnBuff:openWin(BuffWin)}},e.prototype.playShenmoHanZhao=function(t){t.skillConfig.hanzhao>0},e.prototype.getMowangBtn=function(){return this.btnGuaji},e.prototype.setShowMainUI=function(t){this.com_Chat.visible=t},e.prototype.getBossBtn=function(){return this.com_ext.getBossBtn()},e.prototype.getBtnDailyWanFa=function(){return this.com_ext.getBtnDailyWanFa()},e.prototype.getFuBenBtn=function(){return this.com_ext.getBtn_Npc()},e.prototype.getXunBaoBtn=function(){return this.com_ext.getXunBaoBtn()},e.prototype.getBtn_JJ=function(){return this.com_ext.getBtn_JJ()},e.prototype.getBtn_QuYu=function(){return this.com_ext.getBtn_QuYu()},e.prototype.com_Name_btnRechargeMesonry=function(){return this.imgDiamon},e.prototype.getXueseFbGrowBtn=function(){return this.mainMap.getXueseFbGrowBtn()},e.prototype.getEmoFbGrowBtn=function(){return this.mainMap.getEmoFbGrowBtn()},e.prototype.updateMianMap=function(){this.mainMap.updateMap()},e.prototype.com_ext_closeRemind=function(){this.com_ext.closeRemind()},e.prototype.getCom_TaskGroupdesc=function(){return this.com_Task.getGroup1()},e.prototype.getExt_getSevenDayLoginBtnPoint=function(){return this.com_ext.getSevenDayLoginBtnPoint()},e.prototype.getGuaJiBtn=function(){return this.btnGuaji},e.prototype.getVipGroup=function(){return this.groupVip},e.prototype.addToParent=function(t){this.addToParentAt(t,0)},e}(BaseWinSingle);__reflect(MainWin.prototype,"MainWin"),window.MainWin=MainWin;var NewFunctionOpen=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Top,e.winType=WinType.NeverCloseWin,e.mc=new MC,e.limitId=0,e.flyFun=new Caller,e.closeTimes=20,e.skinName="NewFunctionOpenWinEUI",e.setSkinPart("comIcon",new NewFunctionOpenItem),e.mc.playFile(getEffName("xgnkq"),-1),e.mc.x=212,e.mc.y=160,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t,e,i){this.limitId=t,this.flyFun.obj=i,this.flyFun.func=e,this.addClickE(this.group,this.onTap);var n=Cfg.getConfig(LimitConfig,this.limitId);this.comIcon.imgOpenIcon.source=ResMgr.getQijiIconRes1(n.idx,!0),this.comIcon.imgOpenName.source=ResMgr.getQijiNameRes1(n.idx,!0)},e.prototype.updateTime=function(e){void 0===e&&(e=0),t.prototype.updateTime.call(this,e),this.closeTimes--,this.closeTimes<=0&&this.onTap()},e.prototype.onTap=function(){this.flyFun.param=[this.comIcon.localToGlobal()],this.flyFun.call(),closeWin(this)},e}(BaseWinSingle);__reflect(NewFunctionOpen.prototype,"NewFunctionOpen"),window.NewFunctionOpen=NewFunctionOpen;var NewFunctionOpenItem=function(t){function e(){var e=t.call(this)||this;return e.imgOpenName=new eui.Image,e.limitId=0,e.skinName="NewFunctionOpenItemEUI",e}return __extends(e,t),e}(BaseEUI);__reflect(NewFunctionOpenItem.prototype,"NewFunctionOpenItem"),window.NewFunctionOpenItem=NewFunctionOpenItem;var SettingsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.winType=WinType.NormalWin,e.skinName="SettingsWinEUI",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addChangeE(this.checkBoxHideSound,this.onHideSound),this.addChangeE(this.checkBoxHideOtherEff,this.onHideOtherEff),this.addChangeE(this.checkBoxHideHit,this.onHideHit),this.addChangeE(this.checkBoxHideOtherWing,this.onHideOtherWing),this.addChangeE(this.checkBoxLiuhai,this.onSetLiuhai),this.checkBoxHideHuDun&&this.addChangeE(this.checkBoxHideHuDun,this.onHideHuDun),this.addChangeE(this.eCheckShake,this.onCheckShake),this.addEvent(egret.Event.CHANGE,this.sliderYinyue,this.sliderYinyueChangeHandler),this.addEvent(egret.Event.CHANGE,this.sliderYinxiao,this.sliderYinxiaoChangeHandler),this.checkBoxHideSound.selected=!!getLocation(LocationKey.SOUND,LocationValue.Boolean),this.checkBoxHideOtherEff.selected=!getLocation(LocationKey.ISSHOWTHEREFF,LocationValue.Boolean),this.checkBoxHideHit.selected=!getLocation(LocationKey.ISSHOWHIT,LocationValue.Boolean),this.checkBoxHideOtherWing.selected=!getLocation(LocationKey.ISSHOWOTHERWING,LocationValue.Boolean),this.checkBoxLiuhai.selected=!!getLocation(LocationKey.SETLIUHAI,LocationValue.Boolean),this.checkBoxHideHuDun&&(this.checkBoxHideHuDun.selected=!getLocation(LocationKey.ISSHOWHUDUN,LocationValue.Boolean)),this.eCheckShake.selected=!!getLocation(LocationKey.shake,LocationValue.Boolean),this.sliderYinyue.value=10*SoundUtil.volumeBG,this.sliderYinyueChangeHandler(),this.sliderYinxiao.value=10*SoundUtil.volume,this.sliderYinxiaoChangeHandler()},e.prototype.skinComplete=function(){var t=window.platform.checkLogout(),e=t.open,i=t.fun;this.btnQHZH.visible=e,this.groupQHZH.scaleX=e?1:0,this.addChangeE(this.btnQHZH,i)},e.prototype.sliderYinyueChangeHandler=function(t){SoundUtil.volumeBG=this.sliderYinyue.value/10},e.prototype.sliderYinxiaoChangeHandler=function(t){SoundUtil.volume=this.sliderYinxiao.value/10},e.prototype.onHideSound=function(t){setLocation(LocationKey.SOUND,this.checkBoxHideSound.selected+"")},e.prototype.onHideOtherEff=function(t){setLocation(LocationKey.ISSHOWTHEREFF,!this.checkBoxHideOtherEff.selected+"")},e.prototype.onHideHit=function(t){setLocation(LocationKey.ISSHOWHIT,!this.checkBoxHideHit.selected+"")},e.prototype.onHideOtherWing=function(t){setLocation(LocationKey.ISSHOWOTHERWING,!this.checkBoxHideOtherWing.selected+"")},e.prototype.onSetLiuhai=function(t){setLocation(LocationKey.SETLIUHAI,this.checkBoxLiuhai.selected+"")},e.prototype.onHideHuDun=function(t){setLocation(LocationKey.ISSHOWHUDUN,!this.checkBoxHideHuDun.selected+"")},e.prototype.onCheckShake=function(){setLocation(LocationKey.shake,this.eCheckShake.selected+"")},e.getTabTitle=function(){return"系统设置"},e}(BasePanel);__reflect(SettingsWin.prototype,"SettingsWin"),window.SettingsWin=SettingsWin;var SvipLimitCom=function(t){function e(){var e=t.call(this)||this;return e.skinName="SvipLimitComEUI",e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.addDisplay=function(){this.addLsn(VipSys.ins().patchSvipLimitGiftData,this.updatePanel),this.addLsn(VipSys.ins().patchSvipLimitGiftUpdate,this.updatePanel),this.updatePanel()},e.prototype.updatePanel=function(){var t=VipSys.ins().sVipLimitGiftData.isOpen();this.scaleX=this.scaleY=t?1:0,this.visible=t},e.prototype.onClick=function(t){openWin(SVipLimitGiftWin)},e}(BaseEUI);__reflect(SvipLimitCom.prototype,"SvipLimitCom"),window.SvipLimitCom=SvipLimitCom;var ActRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redValue=1,e.skinName="ActRedPointEUI",Timer.ins()["do"](6e3,6e3,0,e.shakeIt,e),e}return __extends(e,t),e.prototype.shakeIt=function(){GFunc.zoom(this.redPoint,1,1.2,1,500)},e.prototype.setRedValue=function(t){this.redValue=t},e.prototype.close=function(){egret.Tween.removeTweens(this.redPoint)},e}(BaseEUI);__reflect(ActRedPoint.prototype,"ActRedPoint"),window.ActRedPoint=ActRedPoint;var ActRedPointGoto=function(t){function e(){var e=t.call(this)||this;return e.type=1,e.skinName="ActRedPointGotoEUI",e.lbDesc.textFlow=addColorTF(StrUtil.addUnderLine(Lang.act_str61)),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onclick)},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.setType=function(t){this.type=t,this.visible=this.type==GConst.rankType[Actor.ins().serverOpenDay]&&GFunc.isSysOpen(SysId.oldSysId)},e.prototype.onclick=function(t){openWin(ActOpenServerWin)},e}(BaseEUI);__reflect(ActRedPointGoto.prototype,"ActRedPointGoto"),window.ActRedPointGoto=ActRedPointGoto;var MainRoleItem=function(t){function e(){var e=t.call(this)||this;return e.state=-1,e.isDead=!1,e.job=JobConst.ZhanShi,e.bianshenId=0,e.sex=0,e.skinName="MainRoleItemEUI",e.hpShape=DisUtil.drawCirByAngle(e.hpShape,26,170,0,!0),e.hpShape.x=e.imgHp.x+24,e.hpShape.y=e.imgHp.y+2,e.grouphp.addChild(e.hpShape),e.imgHp.mask=e.hpShape,e.grouphp.visible=!1,e.grouphp.touchEnabled=!1,e.grouphp.touchChildren=!1,e.eff=new MC,e.eff.playFile(getEffName("actIconCircle"),-1),e.eff.touchEnabled=!1,e.eff.scaleX=e.eff.scaleY=.65,e.eff.x=32.5,e.eff.y=35,e.addChild(e.eff),e}return __extends(e,t),e.prototype.setBianshen=function(t){this.bianshenId=t,this.job=0},e.prototype.setJob=function(t){this.job=t,this.bianshenId=0},e.prototype.setSex=function(t){this.sex=t,this.updateHead()},e.prototype.setIsDead=function(t){this.isDead=t,this.updateHead()},e.prototype.updateHead=function(){var t;t=this.isDead?this.bianshenId>0?ResMgr.getMonsterHead("smhead"+this.bianshenId,!1):ResMgr.getHeadIconGray(this.sex):this.bianshenId>0?ResMgr.getMonsterHead("smhead"+this.bianshenId,!0):ResMgr.getHeadIcon(this.sex),this.imgIcon.source!=t&&(this.imgIcon.source=t),this.imgDIe.visible=this.isDead},e.prototype.setState=function(t){this.state!=t&&(t==e.STATE_0?(this.imgIcon.visible=!0,this.grouphp.visible=!0,this.imgHp1.visible=!0,this.imgLock.visible=!1,this.imgPlus.visible=!1,this.imgBg.source="mianui_zycs_touxiangkuang_02",this.eff.alpha=0):t==e.STATE_1?(this.imgIcon.visible=!1,this.imgPlus.visible=!0,this.imgLock.visible=!1,this.imgHp1.visible=!1,this.imgBg.source="mianui_zycs_touxiangkuang_02",this.eff.alpha=1):t==e.STATE_2&&(this.imgIcon.visible=!1,this.imgPlus.visible=!1,this.imgHp1.visible=!1,this.imgLock.visible=!0,this.eff.alpha=1))},e.prototype.updateHP=function(t,e){var i=t/e;this.imgHp.source="mianui_zycs_xuetiao02_02",this.hpShape=DisUtil.drawCirByAngle(this.hpShape,50,170,170-170*i,!0)},e.STATE_0=0,e.STATE_1=1,e.STATE_2=2,e}(BaseItemRender);__reflect(MainRoleItem.prototype,"MainRoleItem"),window.MainRoleItem=MainRoleItem;var ActCSKRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.CSK,i}return __extends(e,t),e.prototype.updateSys=function(){if(t.prototype.updateSys.call(this),this.isShow){var e=ActSys.ins().getActDataById(ActId.ID_335);this.isShow=RechargeActSys.ins().firstRechargeData.isRecharge()&&e&&e.isSeeActivity()&&!e.isRewardALL()}},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActCSKWin)){var i=RpSys.ins().getData(ExtCom,ActCSKWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActCSKWin)},e}(RuleIconBase);__reflect(ActCSKRule.prototype,"ActCSKRule"),window.ActCSKRule=ActCSKRule;var ActHFSYRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.ActHFSY,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.ActHFSY).length>0)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActHFSYWin)){var i=RpSys.ins().getData(ExtCom,ActHFSYWin);this.setRedPoint(i)}},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActHFSYWin)},e}(RuleIconBase);__reflect(ActHFSYRule.prototype,"ActHFSYRule"),window.ActHFSYRule=ActHFSYRule;var Activity12IconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.HDDT,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.ACT12).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(ActPlace12Win)){var e=RpSys.ins().getData(ExtCom,ActPlace12Win);this.setRedPoint(e)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActPlace12Win)},e}(RuleIconBase);__reflect(Activity12IconRule.prototype,"Activity12IconRule"),window.Activity12IconRule=Activity12IconRule;var Activity15IconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.HDDT,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.Actqingming).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(ActPlace15Win)){var e=RpSys.ins().getData(ExtCom,ActPlace15Win);this.setRedPoint(e)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActPlace15Win)},e}(RuleIconBase);__reflect(Activity15IconRule.prototype,"Activity15IconRule"),window.Activity15IconRule=Activity15IconRule;var Activity21IconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.HDDT,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.ACT21).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(ActPlace21Win)){var e=RpSys.ins().getData(ExtCom,ActPlace21Win);this.setRedPoint(e)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActPlace21Win)},e}(RuleIconBase);__reflect(Activity21IconRule.prototype,"Activity21IconRule"),window.Activity21IconRule=Activity21IconRule;var Activity23IconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.zqFisrtRecharge,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=GFunc.isSysOpen(this.sysId)&&0==ActSys.ins().zqFisrtRechargeRewardState()&&ActSys.ins().getBtnConfigs(ActOnPlace.zqFisrtRecharge).length>0)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(Act23_4Win2)){var i=RpSys.ins().getData(ExtCom,Act23_4Win2);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return!1},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(Act23_4Win2)},e}(RuleIconBase);__reflect(Activity23IconRule.prototype,"Activity23IconRule"),window.Activity23IconRule=Activity23IconRule;var Activity24IconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.HDDT,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.ACT24).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(ActPlace24Win)){var e=RpSys.ins().getData(ExtCom,ActPlace24Win);this.setRedPoint(e)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActPlace24Win)},e}(RuleIconBase);__reflect(Activity24IconRule.prototype,"Activity24IconRule"),window.Activity24IconRule=Activity24IconRule;var ActivityHefuIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.ActHefu,i}return __extends(e,t),e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.ActHefu).length>0)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActHeFuWin)){var i=RpSys.ins().getData(ExtCom,ActHeFuWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActHeFuWin)},e}(RuleIconBase);__reflect(ActivityHefuIconRule.prototype,"ActivityHefuIconRule"),window.ActivityHefuIconRule=ActivityHefuIconRule;var ActivityIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.HDDT,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.huodong).length>0)},e.prototype.getEffName=function(){return"actIconCircle"
},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActWin)){var i=RpSys.ins().getData(ExtCom,ActWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActWin)},e}(RuleIconBase);__reflect(ActivityIconRule.prototype,"ActivityIconRule"),window.ActivityIconRule=ActivityIconRule;var ActivityJueZhanIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.oldSysId,i}return __extends(e,t),e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActJueZhanWin)){var i=RpSys.ins().getData(ExtCom,ActJueZhanWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActJueZhanWin)},e}(RuleIconBase);__reflect(ActivityJueZhanIconRule.prototype,"ActivityJueZhanIconRule"),window.ActivityJueZhanIconRule=ActivityJueZhanIconRule;var ActKFLCIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.KFLC,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.KFLC).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),(!e||e.check(ActKFLCWin))&&this.setRedPoint(RpSys.ins().getData(ExtCom,ActKFLCWin))},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActKFLCWin)},e}(RuleIconBase);__reflect(ActKFLCIconRule.prototype,"ActKFLCIconRule"),window.ActKFLCIconRule=ActKFLCIconRule;var ActQMKHIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.QMKH,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.QMKH).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActQMKHWin)){var i=RpSys.ins().getData(ExtCom,ActQMKHWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActQMKHWin)},e}(RuleIconBase);__reflect(ActQMKHIconRule.prototype,"ActQMKHIconRule"),window.ActQMKHIconRule=ActQMKHIconRule;var ActYYHLIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.YiYuanHaoLi,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.YiYuanHaoLi).length>0)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ActYiYuanHaoLiWin)){var i=RpSys.ins().getData(ExtCom,ActYiYuanHaoLiWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ActYiYuanHaoLiWin)},e}(RuleIconBase);__reflect(ActYYHLIconRule.prototype,"ActYYHLIconRule"),window.ActYYHLIconRule=ActYYHLIconRule;var BBFLIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.BBFL,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=!RechargeActSys.ins().bbflModel.isRewardAll)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(BBFLWin)){var i=RpSys.ins().getData(ExtCom,BBFLWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(BBFLWin)},e}(RuleIconBase);__reflect(BBFLIconRule.prototype,"BBFLIconRule"),window.BBFLIconRule=BBFLIconRule;var BtnoolbarRule=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sysId=SysId.QueHuan,e}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(this.sysId)},e}(RuleIconBase);__reflect(BtnoolbarRule.prototype,"BtnoolbarRule"),window.BtnoolbarRule=BtnoolbarRule;var CampWarRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.CampWar,i}return __extends(e,t),e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return GFunc.isSysOpen(this.sysId)&&CampWarSys.ins().isBattle()&&this.isShow&&t.prototype.isShowEff.call(this)},e.prototype.getOpenSysTick=function(){var t=CampWarSys.ins();return t.sjState&&t.bsState?t.bsEndTick:0},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=CampWarSys.ins();if(e.sjState)if(e.isBattle())this.setTime(Lang.fb_str317);else{var i=DateUtil.formatTime(e.bsStartTick,"hh:mm"+Lang.common_str43);this.setTime(i)}},e.prototype.tapExecute=function(){this.update(),openWin(JJCWin,JJCWin.getTabIndexbyPanel(CampWarLinkPanel))},e}(RuleIconBaseHuchi);__reflect(CampWarRule.prototype,"CampWarRule"),window.CampWarRule=CampWarRule;var ChengJiuIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.oldSysId,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ChengJiuWin)){var i=RpSys.ins().getData(ExtCom,ChengJiuWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ChengJiuWin,0)},e}(RuleIconBase);__reflect(ChengJiuIconRule.prototype,"ChengJiuIconRule"),window.ChengJiuIconRule=ChengJiuIconRule;var CollectionRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.SCYL,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.SCYL)&&!WxYqhlSys.ins().isCollect},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this);var e=window.platform.optios();e&&e.isApplets?openWin(CollectionWin):openWin(CollectionWin2)},e}(RuleIconBase);__reflect(CollectionRule.prototype,"CollectionRule"),window.CollectionRule=CollectionRule;var BossIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.BOSS,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(BossWin)){var i=RpSys.ins().getData(BossWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(BossWin)},e}(RuleIconBase);__reflect(BossIconRule.prototype,"BossIconRule"),window.BossIconRule=BossIconRule;var DailyWanFaRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.LiLian,i}return __extends(e,t),e.prototype.isShowEff=function(){return!1},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(LiLianWin)){var i=RpSys.ins().getData(LiLianWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(LiLianWin)},e}(RuleIconBase);__reflect(DailyWanFaRule.prototype,"DailyWanFaRule"),window.DailyWanFaRule=DailyWanFaRule;var FirstRechargeEveryDayIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.MRSC,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=RechargeActSys.ins().isFirstRechargeEveryDay()&&GFunc.isSysOpen(this.sysId);var t=RechargeActSys.ins().firstRechargeEveryDay,e=t.configs[0];this.tar.labelDisplay.text=e?e.name:"",this.setVisible(this.isShow)},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(FirstRechargeVeryDayWin)){var i=RpSys.ins().getData(FirstRechargeVeryDayWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(FirstRechargeVeryDayWin)},e}(RuleIconBase);__reflect(FirstRechargeEveryDayIconRule.prototype,"FirstRechargeEveryDayIconRule"),window.FirstRechargeEveryDayIconRule=FirstRechargeEveryDayIconRule;var FirstRechargeIconRule=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sysId=SysId.SC,e}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.SC)&&(!RechargeActSys.ins().firstRechargeData.isRecharge()||RechargeActSys.ins().firstRechargeData.isReceivedAll())},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(FirstRechargeBuyWin)){var i=RpSys.ins().getData(FirstRechargeBuyWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(FirstRechargeBuyWin)},e}(RuleIconBase);__reflect(FirstRechargeIconRule.prototype,"FirstRechargeIconRule"),window.FirstRechargeIconRule=FirstRechargeIconRule;var FirstRechargeTimerIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.SC,i.effX=38,i.effY=38,i.timer=0,i.timer1=0,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.SC)&&!RechargeActSys.ins().firstRechargeData.isRecharge()&&RechargeActSys.ins().firstRechargeData.getFirstRechargeTimer()>0},e.prototype.getEffName=function(){return""},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=RechargeActSys.ins().firstRechargeData;this.timer=RechargeActSys.ins().firstRechargeData.getFirstRechargeTimer(),this.timer1=99;var i=this.tar;this.timer>0&&!e.isRecharge()?Timer.ins()["do"](0,33,33,this.onTimer,this,TimerType.LAST):(i.labelDisplay.text="",this.updateSys())},e.prototype.onTimer=function(){this.timer1=Math.abs(this.timer1-3);var t=getFormatTime(this.timer/1e3,"mm:ss")+("d"+(this.timer1<=9?"0"+this.timer1:this.timer1));t=t.replace(":","m"),this.tar.labelDisplay.text=t},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(FirstRechargeBuyWin)){var i=RpSys.ins().getData(FirstRechargeBuyWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(FirstRechargeBuyWin)},e}(RuleIconBase);__reflect(FirstRechargeTimerIconRule.prototype,"FirstRechargeTimerIconRule"),window.FirstRechargeTimerIconRule=FirstRechargeTimerIconRule;var FuBenRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.FUBEN,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(FuBenWin)){var i=RpSys.ins().getData(ExtCom,FuBenWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(FuBenWin)},e}(RuleIconBase);__reflect(FuBenRule.prototype,"FuBenRule"),window.FuBenRule=FuBenRule;var FuLiIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.FLDT,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(FuliWin)){var i=RpSys.ins().getData(ExtCom,FuliWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(FuliWin)},e}(RuleIconBase);__reflect(FuLiIconRule.prototype,"FuLiIconRule"),window.FuLiIconRule=FuLiIconRule;var FxylRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.fxly,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ShareWin)){var i=RpSys.ins().getData(ExtCom,ShareWin);this.setRedPoint(i)}},e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.fxly)&&PfActivitySys.ins().shareInfo.isShow&&PfActivitySys.ins().hasShareGetAwardCount()},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),PfActivitySys.ins().shareInfo.showShare(),openWin(ShareWin)},e}(RuleIconBase);__reflect(FxylRule.prototype,"FxylRule"),window.FxylRule=FxylRule;var GuildBattleRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.GuildBattle,i.openWinClass=GuildBattleMainWin,i.paramsRedPoint=[],i.effX=-7,i.effY=-29,i}return __extends(e,t),e.prototype.updateSys=function(){var t=!1;t=t||GuildBattleSys.ins().getGuildBattleState()==GuildBattleState.lottery,t=t||GuildBattleSys.ins().getGuildBattleState()==GuildBattleState.prelimReady,t=t||GuildBattleSys.ins().getGuildBattleState()==GuildBattleState.prelim,t=t||GuildBattleSys.ins().getGuildBattleState()==GuildBattleState.finalsReady,t=t||GuildBattleSys.ins().getGuildBattleState()==GuildBattleState.finals,this.isShow=GFunc.isSysOpen(this.sysId)&&t},e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return t.prototype.isShowEff.call(this)},e.prototype.getOpenSysTick=function(){return GuildBattleSys.ins().lotteryTick},e.prototype.setIsShow=function(t){},e.prototype.updateTime=function(){t.prototype.updateTime.call(this),this.setTime(getFormatTime(GuildBattleSys.ins().getGuildBattleTime(),"mm分ss秒"))},e.prototype.tapExecute=function(){this.isClick=!0,this.updateEff(),GuildSys.ins().isAddGuild()?openWin(GuildBattleMainWin,GuildBattleMainWin.getTabIndexbyPanel(GuildBattleMainPanel)):openWin(GuildApplyWin)},e}(RuleIconBase);__reflect(GuildBattleRule.prototype,"GuildBattleRule"),window.GuildBattleRule=GuildBattleRule;var GuildIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.guild,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(GuildMapWin)){var i=RpSys.ins().getData(GuildMapWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(GuildNavWin)},e}(RuleIconBase);__reflect(GuildIconRule.prototype,"GuildIconRule"),window.GuildIconRule=GuildIconRule;var GuZhanRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.GuZhan,i}return __extends(e,t),e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return t.prototype.isShowEff.call(this)&&FbSys.ins().guZhanMode.isOpen},e.prototype.getOpenSysTick=function(){var t=0,e=FbSys.ins().guZhanMode;return t=FbSys.ins().guZhanMode.isOpen?e.getEndTimer():e.getStarTimer()},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=FbSys.ins().guZhanMode;FbSys.ins().guZhanMode.isOpen?this.setTime(Lang.fb_str317):this.setTime(getFormatTime(e.getStarTimer()/1e3,"hh:mm")+Lang.common_str43)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(JJCWin,JJCWin.getTabIndexbyPanel(JJCManyPanel),JJCManyPanel.getTabIndexbyPanel(GuZhanPanel))},e}(RuleIconBaseHuchi);__reflect(GuZhanRule.prototype,"GuZhanRule"),window.GuZhanRule=GuZhanRule;var GzhlRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.gzhl,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.gzhl)&&PfActivitySys.ins().isShowFocus()&&!PfActivitySys.ins().isGetFocusAward},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(FocusWin)){var i=RpSys.ins().getData(ExtCom,FocusWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(FocusWin)},e}(RuleIconBase);__reflect(GzhlRule.prototype,"GzhlRule"),window.GzhlRule=GzhlRule;var HwbzRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.Dart,i}return __extends(e,t),e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return GFunc.isSysOpen(this.sysId)&&DartSys.ins().openState==DartOpenState.state2&&this.isShow&&t.prototype.isShowEff.call(this)},e.prototype.getOpenSysTick=function(){var t=DartSys.ins();if(t.openState==DartOpenState.state0)return 0;var e=t.openTime;return e[2]?e[2]:0},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=DartSys.ins();if(e.openState!=DartOpenState.state0)if(e.openState==DartOpenState.state2)this.setTime(Lang.fb_str317);else{var i=e.openTime,n=i[0]+":"+i[1]+Lang.common_str43;this.setTime(n)}},e.prototype.tapExecute=function(){this.update(),openWin(JJCWin,JJCWin.getTabIndexbyPanel(DartPanel))},e}(RuleIconBaseHuchi);__reflect(HwbzRule.prototype,"HwbzRule"),window.HwbzRule=HwbzRule;var JinZuanIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.JinZuan,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(JinZuanWin)){var i=RpSys.ins().getData(ExtCom,JinZuanWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(JinZuanWin)},e}(RuleIconBase);__reflect(JinZuanIconRule.prototype,"JinZuanIconRule"),window.JinZuanIconRule=JinZuanIconRule;var JJCRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.JJ,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(JJCWin)){var i=RpSys.ins().getData(JJCWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(JJCWin)},e}(RuleIconBase);__reflect(JJCRule.prototype,"JJCRule"),window.JJCRule=JJCRule;var KeFuRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.KeFu,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.KeFu)&&PfActivitySys.ins().isShowkeFu},e.prototype.tapExecute=function(){openWin(KefuWin)},e}(RuleIconBase);__reflect(KeFuRule.prototype,"KeFuRule"),window.KeFuRule=KeFuRule;var LoginAwardIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.DLJL,i}return __extends(e,t),e.prototype.updateSys=function(){var t=ActSys.ins().getActDataById(ActId.ID_99800),e=t.isSeeActivity();this.isShow=GFunc.isSysOpen(SysId.DLJL)&&e},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(LoginAwardWin)){var i=RpSys.ins().getData(ExtCom,LoginAwardWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(LoginAwardWin)},e}(RuleIconBase);__reflect(LoginAwardIconRule.prototype,"LoginAwardIconRule"),window.LoginAwardIconRule=LoginAwardIconRule;var LuoLanRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.guild,i}return __extends(e,t),e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return GuildWarSys.ins().getModel().isWatStart&&GFunc.isSysOpen(this.sysId)&&this.isShow},e.prototype.getOpenSysTick=function(){var t=0,e=GuildWarSys.ins().getModel();return t=e.isWatStart?e.startTime+e.acEndTime:e.startTime+e.acEndTime},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);GuildWarSys.ins().getStartTimeTick();GuildWarSys.ins().getModel().isWatStart?this.setTime(Lang.fb_str317):this.setTime(GuildWarSys.ins().getModel().getOpenDescHours())},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(GuildWarMainWin)},e}(RuleIconBaseHuchi);__reflect(LuoLanRule.prototype,"LuoLanRule"),window.LuoLanRule=LuoLanRule;var QiYueRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.QiYue,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=!TaskSys.ins().agreementData.isFinish())},e.prototype.isShowEff=function(){return!1},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(QiYuePanel)){var i=RpSys.ins().getData(ExtCom,QiYueWin,QiYuePanel);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(QiYueWin)},e}(RuleIconBase);__reflect(QiYueRule.prototype,"QiYueRule"),window.QiYueRule=QiYueRule;var QiYuRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.QIYU,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(QiyuWin)){var i=RpSys.ins().getData(QiyuWin);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return this.isShow},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(QiyuWin)},e}(RuleIconBase);__reflect(QiYuRule.prototype,"QiYuRule"),window.QiYuRule=QiYuRule;var QmdbRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.Qmdb,i}return __extends(e,t),e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return FbSys.ins().qmdbModel.canCaiji()&&this.isShow&&t.prototype.isShowEff.call(this)},e.prototype.getOpenSysTick=function(){var t=FbSys.ins().qmdbModel,e=t.getNextStartTime();if(!e)return 0;var i=new Date(Actor.ins().serverTime);return t.isOpen()?(i.setHours(e.endHour,e.endMinute,0,0),i.setTime(i.getTime()-1e3)):i.setHours(e.startHour,e.startMinute,0,0),i.getTime()},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=FbSys.ins().qmdbModel,i=e.getNextStartTime();if(i)if(e.isOpen())this.setTime(Lang.fb_str317);else{var n=i.startHour+":"+i.startMinute+Lang.common_str43;this.setTime(n)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(QiyuWin,QiyuWin.getTabIndexbyPanel(QMDBPanel))},e}(RuleIconBaseHuchi);__reflect(QmdbRule.prototype,"QmdbRule"),window.QmdbRule=QmdbRule;var RankRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.rank,i}return __extends(e,t),e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(RankWin)){var i=RpSys.ins().getData(RankWin,RankPanel);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(RankWin,0)},e}(RuleIconBase);__reflect(RankRule.prototype,"RankRule"),window.RankRule=RankRule;var RechargeYiYuanIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.YYQG,i.effX=46,i.effY=50,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(this.sysId)&&RechargeActSys.ins().rechargeYiYuanData.isOpen()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(RechargeYiYuanWin)){var i=RpSys.ins().getData(ExtCom,RechargeYiYuanWin);this.setRedPoint(i)}},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=RechargeActSys.ins().rechargeYiYuanData,i=e.getFirstRechargeTimer()/1e3,n="dd天hh小时mm分钟ss秒";n=i<DateUtil.SECOND_PER_HOUR?"mm分ss秒":i<DateUtil.SECOND_PER_DAY?"hh小时mm分":"dd天hh小时",this.setTime(""+addColor(getFormatTime(i,n),5767068))},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(RechargeYiYuanWin)},e}(RuleIconBase);__reflect(RechargeYiYuanIconRule.prototype,"RechargeYiYuanIconRule"),window.RechargeYiYuanIconRule=RechargeYiYuanIconRule;var RedFortRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.RedFort,i.time=600,i}return __extends(e,t),e.prototype.getEffName=function(){return"circle"},e.prototype.updateRedPoint=function(e){void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),this.setRedPoint(!1)},e.prototype.isShowEff=function(){return!1},e.prototype.getOpenSysTick=function(){var t=0,e=FbSys.ins().redFort;return t=1==FbSys.ins().redFort.fbType?e.getEndTime():e.getStarTime()},e.prototype.updateTime=function(){t.prototype.updateTime.call(this),1==FbSys.ins().redFort.fbType?this.setTime(Lang.fb_str317):this.setTime(DateUtil.formatDayTime(FbSys.ins().redFort.getStarTime(),"hh:mm")+Lang.common_str43)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(JJCWin,JJCWin.getTabIndexbyPanel(JJCManyPanel),JJCManyPanel.getTabIndexbyPanel(RedFortPanel))},e}(RuleIconBaseHuchi);__reflect(RedFortRule.prototype,"RedFortRule"),window.RedFortRule=RedFortRule;var RankPanel=function(t){function e(){var e=t.call(this)||this;return e.stars=[],e.skinName="RankPanelEUI",e.tab.itemRenderer=RankTabItem,e.tab.dataProvider=e.tabDatas=new eui.ArrayCollection,e.list.itemRenderer=RankItemBase,e.list.dataProvider=e.arrayCollection=new eui.ArrayCollection,e.txUIC=new MC,e.groupMc.addChild(e.txUIC),e.stars=[e.star0,e.star1,e.star2,e.star3],e.groupMcXY=new XY(e.groupMc.x,e.groupMc.y),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnPraise,this.onClick),this.addClickE(this.list,this.onListItemTap),this.addClickE(this.list,this.onClick),this.addClickE(this.tab,this.onTabChange),this.addLsn(RankSys.ins().patchRankData,this.updateList),this.addLsn(RankSys.ins().patchPraiseResult,this.updateMoBaiSelect),this.addLsn(RankSys.ins().patchPraiseData,this.updateMoBai),this.addLsn(RankSys.ins().patchShowRankType,this.updateShowRankType),RankSys.ins().sendShowRankType(),this.updateShowRankType(),this.infoMC()},e.prototype.close=function(){t.prototype.close.call(this),this.txUIC.reset()},e.prototype.infoMC=function(){this.txUIC.y=-330},e.prototype.updateShowRankType=function(){this.tabDatas.source=RankSys.ins().indexToType,this.tab.validateNow();var t=RankSys.ins().getCanPraiseIndex();t=isNaN(t)?0:t,this.setSelectedIndex(t),this.AotuSelect(t)},e.prototype.setSelectedIndex=function(t){this.tab.selectedIndex=t;var e=this.getType();this.list.itemRenderer=this.TypeItem,RankSys.ins().sendGetRankData(e),RankSys.ins().sendGetPraise(e)},e.prototype.updateMoBaiSelect=function(){var t=RankSys.ins().getCanPraiseIndex();isNaN(t)?this.setSelectedIndex(this.tab.selectedIndex):(this.setSelectedIndex(t),this.AotuSelect(t))},e.prototype.AotuSelect=function(t){var e=this.tab.getChildAt(t),i=this.scrollerTab.viewport.contentHeight-370,n=this.scrollerTab.viewport.scrollV;n>=i||(this.scrollerTab.viewport.scrollV=e.y)},e.prototype.updateList=function(t){t.type==this.getType()&&(this.firstItem&&(DisUtil.remove(this.firstItem),this.firstItem=null),t.top?(this.none.visible=!1,this.groupBody.visible=!0,this.groupMc.visible=!0,this.firstItem||(this.firstItem=new this.TypeItem,this.firstItem.x=50,this.firstItem.y=475,this.addClickE(this.firstItem,this.onClick),this.groupBody.addChildAt(this.firstItem,1)),this.labelMyRank.textFlow=addColorTF(t.myRank>0&&t.myRank<=1e3?Lang.act_str25+t.myRank:Lang.common_str17),this.firstItem.data=t.top,this.arrayCollection.source=t.dataList,this.list.validateProperties(),this.updateMoBaiBtn()):(this.none.visible=!0,this.groupBody.visible=!1,this.groupMc.visible=!1,this.arrayCollection.source=[],this.labelMyRank.textFlow=addColorTF(Lang.common_str17)))},e.prototype.updateMoBaiBtn=function(){this.btnPraise.enabled=RankSys.ins().canPraiseByType(this.getType()),this.tabDatas.replaceAll(RankSys.ins().indexToType)},e.prototype.onTabChange=function(){this.setSelectedIndex(this.tab.selectedIndex)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnPraise:var e=this.getType();RankSys.ins().getRankData(e).praise.praiseCount<1?RankSys.ins().sendPraise(e):showtipsFail(Lang.rank_str7);break;case this.firstItem:var i=this.firstItem.data;i&&this.getType()!=RankType.ZMZL&&LogicSys.ins().sentOtherActor(i.userId)}},e.prototype.onListItemTap=function(){var t=this.list.selectedItem;t&&this.getType()!=RankType.ZMZL&&LogicSys.ins().sentOtherActor(t.userId)},e.prototype.updateMoBai=function(t){if(t.type==this.getType()){switch(this.groupMc.x=this.groupMcXY.x,this.groupMc.y=this.groupMcXY.y,this.hideMCAll(),t.type){case RankType.SQZL:this.updateSqMC(t);break;case RankType.CBZL:this.updateWingMC(t);break;case RankType.SZZL:this.updateSzMC(t);break;case RankType.MLZL:this.updateMeilinMC(t);break;case RankType.JLZL:this.updateDamonMC(t);break;case RankType.YBZL:this.updateYongbingMC(t);break;case RankType.SMZL:this.updateShenmoMC(t);break;case RankType.HQZL:this.updateHunqiMC(t),this.updateComMC(t);break;case RankType.LLDJ:this.updateLilianMC(t),this.updateComMC(t);break;case RankType.TXDJ:this.updateTxMC(t),this.updateComMC(t);break;default:this.updateComMC(t)}var e=Cfg.getWorshipConfig(t.type,Actor.ins().level).awards;this.labelMoney.text=GFunc.overLength(e[0].count),this.groupPraise.visible=t.isShowPraise(),this.updateMoBaiBtn()}},e.prototype.updateComMC=function(t){var e=t.praise,i=e.szId,n=e.damonId,a=e.wingId,o=e.sqId,s=e.sex;this.groupMc.removeChildren();var r=Cfg.getConfig(SzHuanhuaBaseConfig,i).uirole;n=0>=n?1:n;var u=Cfg.getConfig(DamonHuanhuaBaseConfig,n),h=u.uirole,p=u.uihigh;if(this.groupMc.addChild(MC.createCenterGruop(h,-1)),a){var l=Cfg.getConfig(WingHuanhuaBaseConfig,a).uirole,c=MC.createCenterGruop(l,-1);c.verticalCenter=-p,this.groupMc.addChild(c)}var d=MC.createCenterGruop(r[s],-1);d.verticalCenter=-p,this.groupMc.addChild(d),this.groupMc.addChild(MC.createCenterGruop("up_"+h,-1));var g=Cfg.getConfig(ShenqiHuanhuaBaseConfig,o).uirole;d=MC.createCenterGruop(g,-1),d.verticalCenter=-p,this.groupMc.addChild(d)},e.prototype.updateSqMC=function(t){if(this.groupMc.removeChildren(),t.praise.job){var e=Cfg.getConfig(ShenqiHuanhuaBaseConfig,t.praise.sqId).weaponIds[t.praise.job-1],i=Cfg.getConfig(WeaponAppearanceConfig,e).appearance,n=MC.createCenterGruop(ResMgr.getWeaponUIEFFResource(i),-1);this.groupMc.addChild(n)}},e.prototype.updateWingMC=function(t){if(this.groupMc.removeChildren(),t.praise.wingId){var e=Cfg.getConfig(WingHuanhuaBaseConfig,t.praise.wingId).wingIds[t.praise.job-1],i=Cfg.getConfig(WingAppearanceConfig,e).appearance,n=MC.createCenterGruop(ResMgr.getWingUIEFFResource(i),-1);this.groupMc.addChild(n)}},e.prototype.updateMeilinMC=function(t){if(this.groupMc.removeChildren(),t.praise.meilinId>=0){var e=Cfg.getConfig(MeilinHuanhuaBaseConfig,t.praise.meilinId).appearanceId,i=Cfg.getConfig(MeilinAppearanceConfig,e).appearance,n=MC.createCenterGruop(ResMgr.getUIMeilinRes(i),-1);this.groupMc.addChild(n)}},e.prototype.updateHunqiMC=function(t){t.praise.hqId&&(this.lx="lx"+t.praise.hqId,this.groupHunqi.visible=!0)},e.prototype.updateLilianMC=function(t){if(t.praise.junxianId){var e=Cfg.getConfig(JunxianLevelConfig,t.praise.junxianId);this.groupJunXian.visible=!0,this.imgJunXian.source="lilian_zycs_jx"+e.junxian}},e.prototype.updateTxMC=function(t){if(t.praise.txId){var e=Cfg.getConfig(TouxianConfig,t.praise.txId);this.txUIC.playFile(ResMgr.getEffName(ResMgr.touxianMCBystage(e.stage)),-1),this.txUIC.visible=!0,this.groupTouxian.visible=!0}},e.prototype.updateSzMC=function(t){if(this.groupMc.removeChildren(),t.praise.job){this.groupMc.x=360,this.groupMc.y=300;var e=Cfg.getConfig(SzHuanhuaBaseConfig,t.praise.szId).uibody[t.praise.sex],i=MC.createCenterGruop(e,-1);this.groupMc.addChild(i)}},e.prototype.updateYongbingMC=function(t){if(this.groupMc.removeChildren(),t.praise.yongbingId){var e=Cfg.getConfig(YongbingHuanhuaBaseConfig,t.praise.yongbingId).uibody,i=MC.createCenterGruop(e,-1);this.groupMc.addChild(i)}},e.prototype.updateDamonMC=function(t){if(this.groupMc.removeChildren(),t.praise.damonId){var e=Cfg.getConfig(DamonHuanhuaBaseConfig,t.praise.damonId).uibody,i=MC.createCenterGruop(e,-1);this.groupMc.addChild(i)}},e.prototype.updateShenmoMC=function(t){if(this.groupMc.removeChildren(),t.praise.shenmoId){var e=Cfg.getConfig(ShenmoHuanhuaBaseConfig,t.praise.shenmoId).uibody,i=MC.createCenterGruop(e,-1);this.groupMc.addChild(i)}},e.prototype.hideMCAll=function(){this.txUIC.visible=!1,this.groupTouxian.visible=!1,this.groupJunXian.visible=!1,this.groupHunqi.visible=!1},e.prototype.getType=function(){return this.tab.selectedItem},Object.defineProperty(e.prototype,"TypeItem",{get:function(){return this.getType()==RankType.JSZL?RankItemPower:RankItemBase},enumerable:!0,configurable:!0}),e.getSysId=function(){return SysId.rank},e.getTitle=function(){return"btz_zycs_phb"},e.getTabTitle=function(){return"bqz_zycs_phb"},e}(BasePanel);__reflect(RankPanel.prototype,"RankPanel"),window.RankPanel=RankPanel;var RankDataFieldPk=function(t){function e(){var e=t.call(this)||this;return e.dabiaoValue=0,e
}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.dabiaoValue=e.readDouble(),this.vipLv=e.readShort()},e.prototype.getRankStr=function(){return""+Lang.fb_str253+this.dabiaoValue},e}(RankData);__reflect(RankDataFieldPk.prototype,"RankDataFieldPk"),window.RankDataFieldPk=RankDataFieldPk;var ShengbeiRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.Shengbei,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(this.sysId)&&!RechargePowerSys.ins().shengbeiData.isGet()&&RechargeActSys.ins().firstRechargeData.isRecharge()&&(RechargePowerSys.ins().zhaoCaiLongData.isAct()||RechargePowerSys.ins().xunZhangData.isAct())},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ShengbeiBuyWin)){var i=RpSys.ins().getData(ExtCom,ShengbeiBuyWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ShengbeiBuyWin)},e}(RuleIconBase);__reflect(ShengbeiRule.prototype,"ShengbeiRule"),window.ShengbeiRule=ShengbeiRule;var ShopRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.Shop,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ShopWin)){var i=RpSys.ins().getData(ExtCom,ShopWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ShopWin)},e}(RuleIconBase);__reflect(ShopRule.prototype,"ShopRule"),window.ShopRule=ShopRule;var ShouquanRule=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=PfActivitySys.ins().isUserInfoBtn&&GFunc.isGuaJiFb()},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ShouquanBgTips)},e}(RuleIconBase);__reflect(ShouquanRule.prototype,"ShouquanRule"),window.ShouquanRule=ShouquanRule;var SmrzApiRule=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=PfActivitySys.ins().verifyApiInfo.ishow},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(VerifyApiWin)},e}(RuleIconBase);__reflect(SmrzApiRule.prototype,"SmrzApiRule"),window.SmrzApiRule=SmrzApiRule;var SmrzRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.smrz,i}return __extends(e,t),e.prototype.isVerifyCallback=function(t){t&&(PfActivitySys.ins().sendRenZhengReward(),openWin(SmrzWin)),PfActivitySys.ins().patchRenZhengStatus(t?1:0)},e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.smrz)&&PfActivitySys.ins().isShowRenZheng()&&!PfActivitySys.ins().isRenZhengReward},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),Actor.ins().isLocation?(this.isVerifyCallback(!0),showtipsSuc("认证成功")):PfActivitySys.ins().renZhengData.callback(this.isVerifyCallback.bind(this))},e}(RuleIconBase);__reflect(SmrzRule.prototype,"SmrzRule"),window.SmrzRule=SmrzRule;var SuitIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.Suit,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.Suit)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(SuitWin)){var i=RpSys.ins().getData(ExtCom,SuitWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(SuitWin)},e}(RuleIconBase);__reflect(SuitIconRule.prototype,"SuitIconRule"),window.SuitIconRule=SuitIconRule;var SVIPMSRule=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=Actor.ins().sVipLv>=2&&GFunc.isSysOpen(SysId.SVIPMS)&&!RechargeActSys.ins().isSVIPMSGetAwardAll()&&RechargeActSys.ins().firstRechargeData.isRecharge()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(SVIPMSWin)){var i=RpSys.ins().getData(SVIPMSWin);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return this.isShow&&RpSys.ins().getData(SVIPMSWin)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(SVIPMSWin)},e}(RuleIconBase);__reflect(SVIPMSRule.prototype,"SVIPMSRule"),window.SVIPMSRule=SVIPMSRule;var TaQingFirstRechargeRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.TaQingActFisrtRecharge,i}return __extends(e,t),e.prototype.updateSys=function(){t.prototype.updateSys.call(this),this.isShow&&(this.isShow=GFunc.isSysOpen(this.sysId)&&0==ActSys.ins().taqingFisrtRechargeRewardState()&&ActSys.ins().getBtnConfigs(ActOnPlace.TaQingActFisrtRecharge).length>0)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(Act23_4Win)){var i=RpSys.ins().getData(ExtCom,Act23_4Win);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return!1},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(Act23_4Win)},e}(RuleIconBase);__reflect(TaQingFirstRechargeRule.prototype,"TaQingFirstRechargeRule"),window.TaQingFirstRechargeRule=TaQingFirstRechargeRule;var TclyRule=function(t){function e(e){var i=t.call(this,e)||this;return i.type=RuleIconType.normal,i}return __extends(e,t),e.prototype.updateSys=function(){return GFunc.isSysOpen(SysId.xianlu_tcly)?void(this.isShow=ActSys.ins().getBtnConfigs(ActOnPlace.TCLY).length>0):void(this.isShow=!1)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(TclyWin)){var i=RpSys.ins().getData(ExtCom,TclyWin);this.setRedPoint(i)}},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=ActSys.ins().getActDataById(2001);e&&this.setTime(e.getformatTime2())},e.prototype.isShowEff=function(){return this.isShow},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(TclyWin)},e}(RuleIconBase);__reflect(TclyRule.prototype,"TclyRule"),window.TclyRule=TclyRule;var TSSZIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.TSSZ,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=!1},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(TSSZWin)){var i=RpSys.ins().getData(ExtCom,TSSZWin);this.setRedPoint(i)}},e.prototype.getEffName=function(){return"actIconCircle"},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(TSSZWin)},e}(RuleIconBase);__reflect(TSSZIconRule.prototype,"TSSZIconRule"),window.TSSZIconRule=TSSZIconRule;var WxYqhlRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.WxYqhl,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),(!e||e.check(WxYqhlWin))&&this.setRedPoint(RpSys.ins().getData(WxYqhlWin))},e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.WxYqhl)&&!WxYqhlSys.ins().isWxYqhlRewardAll()},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(WxYqhlWin)},e}(RuleIconBase);__reflect(WxYqhlRule.prototype,"WxYqhlRule"),window.WxYqhlRule=WxYqhlRule;var XJHBRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.XJHB,i.type=RuleIconType.normal,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=VipSys.ins().xjhbData.isShowIcon()&&GFunc.isSysOpen(this.sysId)},e.prototype.getEffName=function(){return ComUtil.isXianYuApp?"xyhbicon":"hbicon"},e.prototype.updateRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(XJHBWin)){var e=RpSys.ins().getData(XJHBWin);this.setRedPoint(e)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(XJHBWin)},e}(RuleIconBase);__reflect(XJHBRule.prototype,"XJHBRule"),window.XJHBRule=XJHBRule;var XunBaoRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.XunBaoEquip,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.XunBaoEquip)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(XunBaoWin)){var i=RpSys.ins().getData(ExtCom,XunBaoWin);this.setRedPoint(i);var n=this.tar.imgFree;n&&(n.visible=XunBaoSys.ins().hasFreeCount())}},e.prototype.isShowEff=function(){return this.isShow&&RpSys.ins().getData(XunBaoWin)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(XunBaoWin)},e}(RuleIconBase);__reflect(XunBaoRule.prototype,"XunBaoRule"),window.XunBaoRule=XunBaoRule;var XunZhangRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.ZhaoCaiLong,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.XunZhang)&&!RechargePowerSys.ins().xunZhangData.isAct()&&RechargeActSys.ins().firstRechargeData.isRecharge()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(XunZhangBuyWin)){var i=RpSys.ins().getData(ExtCom,XunZhangBuyWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(XunZhangBuyWin)},e}(RuleIconBase);__reflect(XunZhangRule.prototype,"XunZhangRule"),window.XunZhangRule=XunZhangRule;var YdssRule=function(t){function e(e){var i=t.call(this,e)||this;return i.type=RuleIconType.normal,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=XianLuSys.ins().ShowYdssRule()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(YdssWin)){var i=RpSys.ins().getData(ExtCom,YdssWin);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return this.isShow},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(YdssWin)},e}(RuleIconBase);__reflect(YdssRule.prototype,"YdssRule"),window.YdssRule=YdssRule;var YkRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.YK,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(YKWin)){var i=RpSys.ins().getData(ExtCom,YKWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(YKWin,YKWin.getTabIndexbyPanel(MonthCardPanel))},e}(RuleIconBase);__reflect(YkRule.prototype,"YkRule"),window.YkRule=YkRule;var YYMSRule=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.YYMS)&&!RechargeActSys.ins().isYYMSGetAwardAll()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(YYMSWin)){var i=RpSys.ins().getData(YYMSWin);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return this.isShow&&RpSys.ins().getData(YYMSWin)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(YYMSWin)},e}(RuleIconBase);__reflect(YYMSRule.prototype,"YYMSRule"),window.YYMSRule=YYMSRule;var YZZHRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.YZZH,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(YZZHWin)){var i=RpSys.ins().getData(YZZHWin);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return this.isShow},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(YZZHWin)},e}(RuleIconBase);__reflect(YZZHRule.prototype,"YZZHRule"),window.YZZHRule=YZZHRule;var ZeroBuyRule=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.ZeroBuy)&&!RechargeActSys.ins().isZeroAllGetAward()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ZeroBuyWin)){var i=RpSys.ins().getData(ExtCom,ZeroBuyWin);this.setRedPoint(i)}},e.prototype.isShowEff=function(){return this.isShow&&RpSys.ins().getData(ExtCom,ZeroBuyWin)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ZeroBuyWin)},e}(RuleIconBase);__reflect(ZeroBuyRule.prototype,"ZeroBuyRule"),window.ZeroBuyRule=ZeroBuyRule;var ZhaoCaiLongRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.ZhaoCaiLong,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.ZhaoCaiLong)&&!RechargePowerSys.ins().zhaoCaiLongData.isAct()&&RechargeActSys.ins().firstRechargeData.isRecharge()},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ZhaoCaiLongBuyWin)){var i=RpSys.ins().getData(ExtCom,ZhaoCaiLongBuyWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ZhaoCaiLongBuyWin)},e}(RuleIconBase);__reflect(ZhaoCaiLongRule.prototype,"ZhaoCaiLongRule"),window.ZhaoCaiLongRule=ZhaoCaiLongRule;var ZhuangShengIconRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.zs,i.lastStatus=!1,i}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=GFunc.isSysOpen(SysId.zs)||GFunc.isSysOpen(SysId.oldSysId)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(JobWin)){var i=RpSys.ins().getData(ExtCom,JobWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(JobWin,0)},e}(RuleIconBase);__reflect(ZhuangShengIconRule.prototype,"ZhuangShengIconRule"),window.ZhuangShengIconRule=ZhuangShengIconRule;var ZhuanZhiRule=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastStatus=!1,e}return __extends(e,t),e.prototype.updateSys=function(){this.isShow=!1},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(JobWin)){var i=RpSys.ins().getData(ExtCom,JobWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(JobWin,2)},e}(RuleIconBase);__reflect(ZhuanZhiRule.prototype,"ZhuanZhiRule"),window.ZhuanZhiRule=ZhuanZhiRule;var ZhuzaiRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.zhuzai,i}return __extends(e,t),e.prototype.updateRedPoint=function(e){void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),this.setRedPoint(!1)},e.prototype.getEffName=function(){return"circle"},e.prototype.isShowEff=function(){return t.prototype.isShowEff.call(this)&&2==FbSys.ins().zhuzaiMode.refreshTickType},e.prototype.getOpenSysTick=function(){var t=0,e=FbSys.ins().zhuzaiMode;return t=1==e.refreshTickType?Actor.ins().serverTime+e.leftRefreshTime:Actor.ins().serverTime+e.leftRefreshTime},e.prototype.updateTime=function(){t.prototype.updateTime.call(this);var e=FbSys.ins().zhuzaiMode,i=e.leftRefreshTime,n=Math.ceil(i/1e3);if(2==e.refreshTickType){var a=Math.abs(Math.ceil(Math.abs(n)));this.setTime(getFormatTime(a,"mm：ss")+Lang.fb_str370)}else this.setTime(DateUtil.formatDayTime(e.getTimer(),"hh:mm")+Lang.common_str43)},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(BossWin,2,0)},e}(RuleIconBaseHuchi);__reflect(ZhuzaiRule.prototype,"ZhuzaiRule"),window.ZhuzaiRule=ZhuzaiRule;var ZZTQRule=function(t){function e(e){var i=t.call(this,e)||this;return i.sysId=SysId.ZZTQ,i}return __extends(e,t),e.prototype.updateSys=function(){var t=!0,e=ActSys.ins().getActDataById(ActId.ID_99500);e&&(t=!e.isAct()),this.isShow=t&&GFunc.isSysOpen(this.sysId)},e.prototype.updateRedPoint=function(e){if(void 0===e&&(e=null),t.prototype.updateRedPoint.call(this,e),!e||e.check(ZZTQWin)){var i=RpSys.ins().getData(ExtCom,ZZTQWin);this.setRedPoint(i)}},e.prototype.tapExecute=function(){t.prototype.tapExecute.call(this),openWin(ZZTQWin,ZZTQWin.getTabIndexbyPanel(ZZTQCardPanel))},e}(RuleIconBase);__reflect(ZZTQRule.prototype,"ZZTQRule"),window.ZZTQRule=ZZTQRule;var ZhuoYueWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhuoYueWinEUI",e.addBg(),e.listRewrd.itemRenderer=ItemBaseReward,e.listItem.itemRenderer=ZhuoYueWinItem,e.listItem.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this),this.addClickE(this.btnOk,this.onClick),this.addItemTapE(this.listItem,this.onMenuClick),this.addLsn(JobSys.ins().patchQiJizl,this.updateItem),this.addLsn(FbSys.ins().patchGuaJiChallenge,this.updateItem),this.iniList(),this.listItem.validateNow();var i=this.getCutIndex();this.listItem.selectedIndex=i,this.updatePanel(),this.upateSccc(i)},e.prototype.updateItemList=function(){for(var t=this.listItem.numChildren,e=0;t>e;e++){var i=this.listItem.getChildAt(e);i&&i.updateState()}},e.prototype.updateItem=function(){var t=this.getCutIndex();this.listItem.selectedIndex=t,this.updatePanel(),this.updateItemList(),this.upateSccc(t)},e.prototype.iniList=function(){this.listData.source=Cfg.getConfigs(WayConfig)},e.prototype.getCutIndex=function(){return JobSys.ins().getQijiReceiveMinAwardData().idx-1},e.prototype.updatePanel=function(){var t=this.data,e=Cfg.getConfig(LimitConfig,t.id);this.image_desc.source="zyzl_zycs_ms"+t.idx,this.listRewrd.dataProvider=new eui.ArrayCollection(GFunc.getItemDataRewardByJob(t.rewards)),this.imgIcon.source=ResMgr.getQijiIconRes1(t.id),this.lbName.text=""+e.sysName;var i=JobSys.ins().QijiReceiveAwardByIdx(t.idx),n=FbSys.ins().guajiData.guanId>=t.guanqia;this.imgYyq.visible=i,this.btnOk.visible=!i&&n,this.lbGuaQia.visible=!n,this.lbGuaQia.textFlow=addColorTF("通过天路第"+t.guanqia+"层开启")},e.prototype.upateSccc=function(t){var e=206*Math.floor(t/3),i=this.scrollerItem.viewport.contentHeight-this.scrollerItem.height;e>=i&&(e=i),0>e&&(e=0),this.scrollerItem.viewport.scrollV=e},e.prototype.onClick=function(t){switch(t.target){case this.btnOk:JobSys.ins().sendQiJizl(this.data.idx)}},e.prototype.onMenuClick=function(t){this.updatePanel()},Object.defineProperty(e.prototype,"data",{get:function(){return this.listItem.selectedItem},enumerable:!0,configurable:!0}),e.getSysId=function(){return SysId["default"]},e.isShow=function(){return t.isShow.call(this)&&!JobSys.ins().getQijiIsEnd()},e.prototype.getCurBtn=function(){return this.btnOk},e}(BaseWinSingle);__reflect(ZhuoYueWin.prototype,"ZhuoYueWin"),window.ZhuoYueWin=ZhuoYueWin;var ZhuoYueWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhuoYueWinItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){this.update()},e.prototype.update=function(){var t=this.data,e=Cfg.getConfig(LimitConfig,t.id);this.lbGuaQia.text="第"+t.guanqia+"层开启",this.lbName.text=""+e.sysName,this.imgIcon.source=ResMgr.getQijiIconRes1(t.id),this.updateState()},e.prototype.updateState=function(){var t=this.data,e=JobSys.ins().QijiReceiveAwardByIdx(t.idx),i=FbSys.ins().guajiData.guanId>=t.guanqia;this.imgYyq.visible=e,this.lbKlq.visible=i&&!e,this.lbWjh.visible=!i,this.imgBg.source=i?"zyzl_zycs_di1":"zyzl_zycs_di2"},e}(BaseItemRender);__reflect(ZhuoYueWinItem.prototype,"ZhuoYueWinItem"),window.ZhuoYueWinItem=ZhuoYueWinItem;var ShengbeiActWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ShengbeiActWinEUI",this.addBg(),this.layer=LayerMgr.Popup,GFunc.playUIMovie("bxsb_zycs_sb1",0,0,this.groupShengbei,-1)},e}(BaseWin);__reflect(ShengbeiActWin.prototype,"ShengbeiActWin"),window.ShengbeiActWin=ShengbeiActWin;var ShengbeiBuyWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="ShengbeiBuyWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.btnReceive.redPoint.visible=!0,this.list.itemRenderer=ItemBaseReward,this.list.dataProvider=this.listArray=new eui.ArrayCollection,GFunc.playUIMovie("bxsb_zycs_sb1",100,170,this.entityGroup,-1)},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RechargePowerSys.ins().patchShengbeiState,this.update),this.addClickE(this.btnBuy,this.onClick),this.addClickE(this.entityGroup,this.onClick),this.addClickE(this.btnReceive,this.onClick),this.addItemTapE(this.list,this.onlistItemClick,!0),this.update()},e.prototype.update=function(){var t=RechargePowerSys.ins().shengbeiData;this.currentState=0==t.state?"buy":"receive";var e=Cfg.getConfig(RechagePowerConstConfig);this.listArray.source=e.grailreward,this.lbDesc.text=e.grailmoshi+"仙券不计入每日获取上限",this.btnBuy.label="投资"+Cfg.getPayMoneyRMBByYb(e.grailbuycount)+"元"},e.prototype.onlistItemClick=function(t){var e=t.itemRenderer,i=e.data;i.id==Cfg.getConfig(RechagePowerConstConfig).grailitemid?(openWin(ShengbeiWin),closeWin(this),t.stopImmediatePropagation()):GFunc.openItemTips(i)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnBuy:VipSys.ins().showReCharge(Cfg.getConfig(RechagePowerConstConfig).grailbuycount);break;case this.btnReceive:RechargePowerSys.ins().sendShengbeiGetAward(),closeWin(this);break;case this.entityGroup:openWin(ShengbeiWin),closeWin(this)}},e}(BaseWin);__reflect(ShengbeiBuyWin.prototype,"ShengbeiBuyWin"),window.ShengbeiBuyWin=ShengbeiBuyWin;var ShengbeiData=function(){function t(){this.state=0,this.stoneDatas=[]}return t.prototype.parser=function(t){this.state=t.readByte();for(var e=t.readByte(),i=0;e>i;i++){var n=this.stoneDatas[i]=new ShengbeiStoneData;n.id=i+1,n.level=t.readShort()}},t.prototype.parserState=function(t){this.state=t.readByte()},t.prototype.parserLv=function(t){var e=t.readByte(),i=t.readShort(),n=this.getStoneDataById(e);return n?n.level=i:console.log("圣杯id:"+e+"不存在"),n},t.prototype.getStoneDataById=function(t){return this.stoneDatas[t-1]},t.prototype.getStoneDataByIndex=function(t){return this.stoneDatas[t]},Object.defineProperty(t.prototype,"power",{get:function(){for(var t=0,e=0,i=0,n=this.stoneDatas;i<n.length;i++){var a=n[i];t+=a.power,e+=a.config.percent/1e4}var o=Cfg.getConfig(RechagePowerConstConfig).grailattr;t+=GFunc.getPower(o)*(1+e);var s=Cfg.getConfig(RechagePowerConstConfig).grailskill;return t+=Cfg.getConfig(SkillPassiveConfig,s,1).power},enumerable:!0,configurable:!0}),t.prototype.isBuy=function(){return this.state>0},t.prototype.isGet=function(){return 2==this.state},t.prototype.canGet=function(){return 1==this.state},t.prototype.getStoneAttrs=function(){for(var t=[],e=0,i=this.stoneDatas;e<i.length;e++){var n=i[e];t.push(n.config.attr[0])}return t},t}();__reflect(ShengbeiData.prototype,"ShengbeiData"),window.ShengbeiData=ShengbeiData;var ShengbeiStoneData=function(){function t(){this.id=1,this.level=0}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config&&this._config.level==this.level&&this.id==this._config.id||(this._config=Cfg.getConfig(GrailStoneConfig,this.id,this.level)),this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idConfig",{get:function(){return this._idConfig&&this.id==this._idConfig.id||(this._idConfig=Cfg.getConfig(GrailStoneIdConfig,this.id)),this._idConfig},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.id-1},enumerable:!0,configurable:!0}),t.prototype.isAct=function(){return this.level>0},Object.defineProperty(t.prototype,"power",{get:function(){return GFunc.getPower(this.config.attr)+this.config.power},enumerable:!0,configurable:!0}),t.prototype.isMax=function(){return this.level>=Cfg.getShengbeiStoneMaxLv(this.id)},Object.defineProperty(t.prototype,"bagItemCount",{get:function(){var t=Cfg.getConfig(RechagePowerConstConfig).grailitems[this.index];return BagSys.ins().getItemCount(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"needCount",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.canUp=function(){return!this.isMax()&&this.bagItemCount>=this.needCount},t}();__reflect(ShengbeiStoneData.prototype,"ShengbeiStoneData"),window.ShengbeiStoneData=ShengbeiStoneData;var ShengbeiTipsWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ShengbeiTipsWinEUI",t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.setSkinPart("itemIcon",new ItemBaseReward),this.listAttrShengbei.itemRenderer=ShengbeiTipsWinItemBei,this.listAttrShengbei.dataProvider=this.listAttrShengbeiArr=new eui.ArrayCollection,this.listAttrStone.dataProvider=this.listAttrStoneArr=new eui.ArrayCollection,this.listAttrStone.itemRenderer=ShengbeiTipsWinItemStone,this.addBg()},e.prototype.open=function(){t.prototype.open.call(this),this.update()},e.prototype.update=function(){var t=RechargePowerSys.ins().shengbeiData;this.labelName.text="六道神镜",this.itemIcon.data=GFunc.creatRewardDataById(Cfg.getConfig(RechagePowerConstConfig).grailitemid),this.bmpLabelPower.text=t.power.toFixed(0),this.listAttrShengbeiArr.source=Cfg.getConfig(RechagePowerConstConfig).grailattr,this.listAttrStoneArr.source=t.stoneDatas;var e=Cfg.getConfig(SkillPassiveConfig,Cfg.getConfig(RechagePowerConstConfig).grailskill,1);this.imgSkillIcon.source=ResMgr.getSkillPassivityItemName(e.id,!0),this.labelSkillName.text=e.name,this.labelSkillDesc.textFlow=StrUtil.toTF(e.skinname)},e}(BaseWinSingle);__reflect(ShengbeiTipsWin.prototype,"ShengbeiTipsWin"),window.ShengbeiTipsWin=ShengbeiTipsWin;var ShengbeiTipsWinItemBei=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengbeiTipsWinItemBeiEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.filters=RechargePowerSys.ins().shengbeiData.isBuy()?null:DisUtil.grayFilter();var e=AttrData.getFm(13486270,5949490,"","  +");this.labelAttr.textFlow=addColorTF(AttrData.parse([t],{fm:e}).join(""))},e}(BaseItemRender);__reflect(ShengbeiTipsWinItemBei.prototype,"ShengbeiTipsWinItemBei"),window.ShengbeiTipsWinItemBei=ShengbeiTipsWinItemBei;var ShengbeiTipsWinItemStone=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengbeiTipsWinItemStoneEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getConfig(RechagePowerConstConfig).grailitems[this.itemIndex];this.imgIcon.source=ResMgr.getItemIconMin(Cfg.getItemCfg(e).getIcon()),this.labelName.textFlow=addColorTF(t.idConfig.name+addColor("Lv."+t.level,5949490));var i=t.idConfig.desc1.replace("{a}",AttrData.getAttrValue(t.config.attr[0]));this.labelAttr.textFlow=StrUtil.toTF(i)},e}(BaseItemRender);__reflect(ShengbeiTipsWinItemStone.prototype,"ShengbeiTipsWinItemStone"),window.ShengbeiTipsWinItemStone=ShengbeiTipsWinItemStone;var ShengbeiWin=function(t){function e(){var e=t.call(this)||this;return e.items=[],e.imgStones=[],e.selectIndex=6,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ShengbeiWinEUI",t.prototype.initUI.call(this),this.layer=LayerMgr.Popup;for(var e=0;6>e;e++){var i=this.items[e]=new ShengbeiWinItem;this.setSkinPart("item"+e,i),this.imgStones[e]=this["imgStone"+e]}this.addBg()},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnUp,this.onClick),this.addClickE(this.btnUp1,this.onClick),this.addClickE(this.btnShuxing,this.onClick),this.addClickE(this.groupBei,this.onItemClick);for(var e=0,i=this.items;e<i.length;e++){var n=i[e];this.addClickE(n,this.onItemClick)}this.addLsn(RechargePowerSys.ins().patchShengbeiXiangqian,this.onXiangqian),this.addLsn(BagSys.ins().patchItemChange,this.updateConsume),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.updateItems(),this.updateGroupState(),this.updatePower(),this.updateRp()},e.prototype.updateRp=function(t){if(!t||t.check(this.getThisDef())){for(var i=0,n=this.items;i<n.length;i++){var a=n[i];a.updateRp()}if(this.selectIndex<this.items.length){var o=RechargePowerSys.ins().shengbeiData.getStoneDataByIndex(this.selectIndex),s=RpSys.ins().getData(RoleWin,RolePanel,e,o.id);this.btnUp.redPoint=this.btnUp1.redPoint=s}}},e.prototype.onXiangqian=function(t){this.items[t.index].data=t,this.imgStones[t.index].visible=t.isAct(),this.updateUpBtnState(),this.updateStoneAttr(),this.updatePower()},e.prototype.updateUpBtnState=function(){if(this.selectIndex<this.items.length){var t=RechargePowerSys.ins().shengbeiData.getStoneDataByIndex(this.selectIndex),e=t.isAct();this.btnUp.visible=!e,this.btnUp1.visible=e}},e.prototype.updateItems=function(){for(var t=0;t<this.items.length;t++){var e=RechargePowerSys.ins().shengbeiData.getStoneDataByIndex(t);this.items[t].data=e,this.imgStones[t].visible=e.isAct()}},e.prototype.updateGroupState=function(){var t=this.selectIndex<this.items.length;this.groupShengbei.visible=!t,this.groupStone.visible=t,t?(this.updateUpBtnState(),this.updateStoneAttr(),this.updateConsume()):(this.updateBeiAttr(),this.updateSkill())},e.prototype.updateBeiAttr=function(){for(var t=Cfg.getConfig(RechagePowerConstConfig).grailattr.concat(),e=t.slice(0,3),i=t.slice(3,6),n=0,a=0,o=this.items;a<o.length;a++){var s=o[a],r=s.data;n+=r.config.percent}var u=function(t,e,i){if(n>0){var a=Math.floor(i*n/1e4);return t+addColor("（+"+a+"）",5949490)}return t},h=AttrData.parse(e,{fm:""+addColor("%k：",12704255)+addColor("%v",12704255),fix:u}),p=AttrData.parse(i,{fm:""+addColor("%k：",12704255)+addColor("%v",12704255),fix:u});this.labelBeiAttr1.textFlow=addColorTF(h.join("\n")),this.labelBeiAttr2.textFlow=addColorTF(p.join("\n"))},e.prototype.updateSkill=function(){var t=Cfg.getConfig(SkillPassiveConfig,Cfg.getConfig(RechagePowerConstConfig).grailskill,1);this.imgSkillIcon.source=ResMgr.getSkillPassivityItemName(t.id,!0),this.labelSkillName.text=t.name,this.labelSkillDesc.textFlow=StrUtil.toTF(t.skinname)},e.prototype.updateStoneAttr=function(){if(this.selectIndex<this.items.length){var t=this.items[this.selectIndex].data,e=t.isMax();this.groupUp.visible=!e,this.imgMax.visible=e,this.labelStoneName.text=t.idConfig.name;var i=t.idConfig.desc1.replace("{a}",AttrData.getAttrValue(t.config.attr[0])),n=t.idConfig.desc2.replace("{a}",(t.config.percent/100).toFixed(0)+"%"),a="",o="";if(!e){var s=new ShengbeiStoneData;s.id=t.id,s.level=t.level+1,a=addColor("（下级效果+"+AttrData.getAttrValue(s.config.attr[0])+"）",5767068),o=addColor("（下级效果+"+(s.config.percent/100).toFixed(0)+"%）",5767068)}this.labelStoneAttr1.textFlow=StrUtil.toTF(i+a),this.labelStoneAttr2.textFlow=StrUtil.toTF(n+o)}},e.prototype.updateConsume=function(t){if(void 0===t&&(t=null),(!t||t.cfg.type==ItemType.Shengbei)&&this.selectIndex<this.items.length){var e=this.items[this.selectIndex],i=e.data,n=Cfg.getConfig(RechagePowerConstConfig).grailitems[i.index],a=BagSys.ins().getItemCount(n),o=1,s=a>=o?13486270:15733780;this.labelComsume.textFlow=addColorTF(a+"/"+o,s),this.imgConsume.source=ResMgr.getItemIconMin(Cfg.getItemCfg(n).getIcon())}},e.prototype.updatePower=function(){this.bmpLabelPower.text=RechargePowerSys.ins().shengbeiData.power.toFixed(0)},e.prototype.onItemClick=function(t){t.currentTarget==this.groupBei?(this.selectIndex<this.items.length&&this.items[this.selectIndex].setSelect(!1),this.selectIndex=this.items.length):(this.selectIndex<this.items.length&&this.items[this.selectIndex].setSelect(!1),this.selectIndex=this.items.indexOf(t.currentTarget),this.items[this.selectIndex].setSelect(!0)),this.updateGroupState()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnUp:case this.btnUp1:if(this.selectIndex>=0&&this.selectIndex<this.items.length)if(RechargePowerSys.ins().shengbeiData.isBuy()){var e=this.items[this.selectIndex].data,i=Cfg.getShengbeiConsumeItemId(e.id);GFunc.checkConsumeEnough(GFunc.creatRewardDatasById(i,1))?RechargePowerSys.ins().sendShengbeiXiangqian(e.id):showtipsFail("购买神石后可镶嵌")}else showtipsFail("请先购买六道神镜");break;case this.btnShuxing:openWin(ShengbeiTipsWin)}},e}(BaseWinSingle);__reflect(ShengbeiWin.prototype,"ShengbeiWin"),window.ShengbeiWin=ShengbeiWin;var ShengbeiWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengbeiWinItemEUI",e}return __extends(e,t),e.prototype.setRedPoint=function(t){this.redPoint.visible=t
},e.prototype.dataChanged=function(){var t=this.data;this.currentState=t.isAct()?"normal":"noStone",this.imgIcon.source="bxsb_zycs_ys"+t.index,this.updateRp()},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e.prototype.updateRp=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengbeiWin,t.id))},e}(BaseItemRender);__reflect(ShengbeiWinItem.prototype,"ShengbeiWinItem"),window.ShengbeiWinItem=ShengbeiWinItem;var FbModelShenDian=function(t){function e(){var e=t.call(this)||this;return e.boshu=0,e.jibaiCount=0,e.subRoleDatas=[],e._shuaguaiTime=0,e.guwuAttrData=new GuwuAttrData,e.guwuCount=0,e.count=0,e.buyCount=0,e.zhuzhanCount=0,e._zuduiTime=0,e.shuohuaId=0,e.rewardType=1,e.yaoqingtimer=0,e.yaoqingtimerGuild=0,e.isfaGuoYoaQing=!1,e.state=0,e.fbId=1,e}return __extends(e,t),e.prototype.parser=function(t){this.boshu=t.readByte(),this.jibaiCount=t.readInt();var e=t.readByte();this.subRoleDatas.length=0;for(var i=0,n=2,a=0;e>a;a++){var o=new SubRoleData;o.parser(t),o.index=o.playName==Actor.ins().myName?1:n++,i+=o.hurt,this.subRoleDatas.push(o)}for(var a=0;a<this.subRoleDatas.length;a++)this.subRoleDatas[a].sumHurt=i;var s=t.readShort();this._shuaguaiTime=Timer.ins().getTimer()+1e3*s},e.prototype.parser1=function(t){this.count=t.readByte(),this.buyCount=t.readByte(),this.zhuzhanCount=t.readByte()},e.prototype.parserGotoFuben=function(t){this.rewardType=t.readByte();var e=t.readShort();this.fbId=t.readInt(),-1!=e?this.SweepEndTick=Timer.ins().getTimer()+1e3*e:this.SweepEndTick=-1},e.prototype.canYaoqing=function(){return 0==this.getYaoqingCD()},e.prototype.getYaoqingCD=function(){return Math.max(0,Math.ceil((this.yaoqingtimer-Timer.ins().getTimer())/1e3))},e.prototype.canYaoqingGuild=function(){return 0==this.getYaoqingCDGuild()},e.prototype.getYaoqingCDGuild=function(){return Math.max(0,Math.ceil((this.yaoqingtimerGuild-Timer.ins().getTimer())/1e3))},Object.defineProperty(e.prototype,"shenghunCommonConfig",{get:function(){return Cfg.getConfig(ShenghunCommonConfig)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shuaguaiTime",{get:function(){return Math.max(0,Math.ceil(this._shuaguaiTime-Timer.ins().getTimer())/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zuduiTime",{get:function(){return Math.max(0,Math.ceil(this._zuduiTime-Timer.ins().getTimer())/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftCdTime",{get:function(){return Math.max(0,Math.ceil(this.SweepEndTick-Timer.ins().getTimer())/1e3)},enumerable:!0,configurable:!0}),e.prototype.isMax=function(){var t=Cfg.getConfig(ShenghunFubenConfig,CondType.LessEqual,ShenghunFubenConfig.zslevel,Actor.ins().zsId);return t.id>=Cfg.getMaxConfig(MolongFubenConfig).id},e.prototype.istixingguwu=function(){return this.count<=3&&this.guwuCount<=4},Object.defineProperty(e.prototype,"leftCount",{get:function(){return Cfg.getConfig(ShenghunCommonConfig).fightcount+this.buyCount-this.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canbuyCount",{get:function(){return Math.max(VipSys.ins().getCurSVipConfig().shenghunbuy-this.buyCount,0)},enumerable:!0,configurable:!0}),e.prototype.updateTimes=function(t,e){Timer.ins()["do"](t,1e3,1,this.openYaoQingWin,e)},e.prototype.openYaoQingWin=function(){var t=FbSys.ins().fubenConfig;if(!this.isfaGuoYoaQing&&t.group==FbGroup.ShenDian){var e=Cfg.getConfig(ShenghunCommonConfig).yaoqingdesc,i=new PopupTimeData(e);i.timer=5,i.setFunction(this,function(){FbSys.ins().sendShenDianYaoQing(1)}),openWin(ShenDianZuDuiWin,i)}},e.prototype.isZhuZhan=function(){return 2==this.rewardType},e.prototype.getState=function(){var t=0;return t=-1!=this.SweepEndTick?2:0==this.state?0:1},e.prototype.resetAll=function(){this.isfaGuoYoaQing=!1,this.subRoleDatas.length=0,this.boshu=0,this.jibaiCount=0,this.guwuCount=0,this.yaoqingtimer=0,this.yaoqingtimerGuild=0,this._shuaguaiTime=0,this._zuduiTime=0,this.guwuAttrData.resetAll(),Timer.ins().removeAll(this)},e}(FbModelBase);__reflect(FbModelShenDian.prototype,"FbModelShenDian"),window.FbModelShenDian=FbModelShenDian;var ShenDianFbPanel=function(t){function e(){var e=t.call(this)||this;return e.isGuaji=!0,e.skinName="ShenDianFBPanelEUI",e.listrole.itemRenderer=ShenDianRoleItem,e.listrole.dataProvider=e.listroleArray=new eui.ArrayCollection,e.mcFingerCenter=new MC,e.mcFingerCenter.playFile(getEffName("csys_finger"),-1),e.mcFingerCenter.x=e.mcFingerCenter.y=45,e.btnGuaji.addChild(e.mcFingerCenter),e.mcFingerCenter.alpha=0,e.list.itemRenderer=ItemBaseReward,e.list.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.fbId=FbSys.ins().fbId,this.addClickE(this,this.onClick),this.addLsn(MapContainer.ins().patchGridClick,this.onMapGridClick),this.addLsn(LogicSys.ins().patchEntityClick,this.onEntityClick),this.addLsn(FbSys.ins().patchMoneyChange,this.onGuwuMoneyChange),this.addLsn(FbSys.ins().patchShenDianZuDuiTime,this.updateGuWuBtn),this.addLsn(FbSys.ins().patchShenDianStarTime,this.fubenStar),this.addLsn(FbSys.ins().patchShenDianGotoFubenData,this.fubenStar),this.addLsn(FbSys.ins().patchShenDianGuWu,this.guwu),this.addLsn(LogicSys.ins().patchCreateCommEntity,this.updateGuaJi),this.shenghunCommonConfig=Cfg.getConfig(ShenghunCommonConfig),this.updateAll(),this.guwu(),this.updateGuWuBtn(),this.updateReward()},e.prototype.updateReward=function(){var t=FbSys.ins().shendianData,e=ActSys.ins().beishu,i=Cfg.getConfig(ShenghunFubenConfig,CondType.Equal,ShenghunFubenConfig.fbId,this.fbId);t.isZhuZhan()?this.listData.source=GFunc.setItemDataRewardValue(i.fubenhelprewards,ItemDataReward["double"],e):this.listData.source=GFunc.setItemDataRewardValue(i.fubenrewards,ItemDataReward["double"],e)},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updateGuaJi=function(){this.setGuaJi(!0)},e.prototype.updateCombatDate=function(){var t=FbSys.ins().shendianData,e="";e=2==t.getState()?Lang.fb_str297.replace("$time$",getFormatTime(t.leftCdTime,"mm:ss")):Lang.fb_str297.replace("$time$"," --:--"),this.lbTime.textFlow=addColorTF(e),this.lbMonsterBar.textFlow=addColorTF(Lang.fb_str298.replace("$count$",t.boshu+"/"+this.shenghunCommonConfig.monstermaxcount)),this.lbMonsterAtkCount.textFlow=addColorTF(Lang.fb_str299.replace("$count$",t.jibaiCount.toString()));var i=Cfg.getConfig(ShenghunFubenConfig,CondType.Equal,ShenghunFubenConfig.fbId,this.fbId);if(i){var n=Cfg.getShenghunCommonByIdCount(i.fbId,t.jibaiCount),a=i.grade.length-1,o=n>=a?a:n+1,s=i.grade[o],r=GConst.fbrate[o],u=addColor(s,5949490),h=addColor(""+(r+Lang.common_ji),5949490);this.lbScore.textFlow=addColorTF(Lang.fb_str375.replace("$count$",u)+":"+h),this.updateCenterBtnEff()}},e.prototype.onMapGridClick=function(){this.setGuaJi(!1)},e.prototype.onEntityClick=function(){this.setGuaJi(!1)},e.prototype.updateGuaJiBtn=function(){this.btnGuaji.visible=!this.isGuaji,this.btnStopGuaji.visible=this.isGuaji},e.prototype.updateGuWuBtn=function(){var t=0!=FbSys.ins().shendianData.getState(),e=this.btnCoinGuWu.visible;this.btnCoinGuWu.visible=t,e!=t&&this.guwu(),this.btnGuild.visible=!t,this.btnWord.visible=!t},e.prototype.updateTime=function(){this.updateAll()},e.prototype.updateAll=function(){this.updateMyself(),this.updateCombatDate()},e.prototype.updateMyself=function(){this.listroleArray.source=FbSys.ins().shendianData.subRoleDatas,this.listroleArray.refresh()},e.prototype.onClick=function(t){switch(t.target){case this.btnGuaji:this.setGuaJi(!0);break;case this.btnStopGuaji:this.setGuaJi(!1);break;case this.btnCoinGuWu:if(0!=FbSys.ins().shendianData.getState()){var e=FbSys.ins().guWuData.getShenDianWuGuDatas();e&&openWin(GuWuWin,e)}else showtipsSuc(Lang.fb_str304);break;case this.btnGuild:GuildSys.ins().isAddGuild()?FbSys.ins().shendianData.canYaoqingGuild()?(FbSys.ins().sendShenDianYaoQing(2),showtipsSuc(Lang.fb_str302)):showTipsWarn(Lang.fb_str303.replace("$miao$",FbSys.ins().shendianData.getYaoqingCDGuild().toString())):showTipsWarn(Lang.guild_str7);break;case this.btnWord:FbSys.ins().shendianData.canYaoqing()?(FbSys.ins().sendShenDianYaoQing(1),showtipsSuc(Lang.fb_str302)):showTipsWarn(Lang.fb_str303.replace("$miao$",FbSys.ins().shendianData.getYaoqingCD().toString()))}},e.prototype.setGuaJi=function(t){this.isGuaji=t,LogicSys.ins().centerEntity.AI.setGuaji(t),this.updateGuaJiBtn()},e.prototype.formatCountDown=function(t){return addColor(""+Lang.common_str11+(t/1e3).toFixed(0)+Lang.common_miao,16115290)},e.prototype.guwu=function(){this.guwuRedPoint(),this.groupJiaCheng.visible=this.btnCoinGuWu.visible&&(FbSys.ins().shendianData.guwuAttrData.atk>0||FbSys.ins().shendianData.guwuAttrData.hp>0),this.lbjiacheng.text=Lang.fb_str23+.01*FbSys.ins().shendianData.guwuAttrData.atk+"%"},e.prototype.onGuwuMoneyChange=function(t,e){var i,n;n=1==t?this.lbMoney1:this.lbMoney2,egret.Tween.removeTweens(n),i=egret.Tween.get(n),n.visible=!0,n.alpha=1,n.textFlow=addColorTF(Lang.common_str49+" "+e.count+" "+Cfg.getItemCfg(e.id).name,GConst.PZColor[0]),i.wait(1e3).to({alpha:0},500).call(function(){n.visible=!1})},e.prototype.fubenStar=function(){0!=FbSys.ins().shendianData.getState()&&this.guwuRedPoint(),this.updateGuWuBtn()},e.prototype.updateCenterBtnEff=function(){this.mcFingerCenter.alpha=2==FbSys.ins().shendianData.getState()?1:0},e.prototype.guwuRedPoint=function(){var t=this.canGuWu(1)||this.canGuWu(2);this.btnCoinGuWu.redPoint.visible=t,t?Timer.ins()["do"](1e3,3e3,0,this.doudong,this,TimerType.FIRST):Timer.ins().remove(this.doudong,this)},e.prototype.doudong=function(){DisUtil.shakeIt(this.btnCoinGuWu,5,100)},e.prototype.canGuWu=function(t){var e=!1,i=Cfg.getConfig(ShenghunFubenConfig,CondType.Equal,ShenghunFubenConfig.fbId,this.fbId),n=Cfg.getConfig(ShenghunInspireConfig,t);return FbSys.ins().shendianData.guwuAttrData.atk>=n.attMax?e=!1:1==t?GFunc.isConsumeEnough(i.goldSp[0])&&(e=!0):GFunc.isConsumeEnough(i.diamondSp[0])&&(e=!0),e},e}(BasePanel);__reflect(ShenDianFbPanel.prototype,"ShenDianFbPanel"),window.ShenDianFbPanel=ShenDianFbPanel;var ShenDianPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=45,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.setSkinName()},e.prototype.setSkinName=function(){this.skinName="ShenDianPanelEUI",this.list.itemRenderer=ItemBaseReward},e.prototype.open=function(){this.addClickE(this,this.onClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(FbSys.ins().patchShenDianData,this.updatePanel),this.addLsn(VipSys.ins().patchSvipLvChange,this.updatePanel),this.updatePanel(),this.updateRp()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updatePanel=function(){var t=FbSys.ins().shendianData,e=Cfg.getConfig(ShenghunFubenConfig,CondType.LessEqual,MolongFubenConfig.zslevel,Actor.ins().zsId),i=Cfg.getConfig(ShenghunCommonConfig);this.labelLv.text=GFunc.getZSNameBydb(e.zslevel),this.indexBmp.text=e.id.toString();var n=ActSys.ins().beishu,a=GFunc.setItemDataRewardValue(e.reward,ItemDataReward["double"],n);this.list.dataProvider=new eui.ArrayCollection(a),this.lbTjPower.textFlow=addColorTF(""+Lang.fb_str30+addColor(e.needpower,13486270)),this.lbCurPower.textFlow=addColorTF(""+Lang.fb_str31+addColor(Actor.ins().power,Actor.ins().power>=e.needpower?5949490:15733780)),this.lbZhuZhan.textFlow=addColorTF(Lang.mol_str23+"："+addColor(t.zhuzhanCount,0==t.zhuzhanCount?15733780:5949490)),this.lbDesc.textFlow=StrUtil.toTF(i.desc);var o=Cfg.getConfig(ShenghunFubenConfig,CondType.More,ShenghunFubenConfig.zslevel,Actor.ins().zsId);if(this.bitCeng.text=o.id.toString(),this.imgLevel.source="mlzc_zycs_"+o.zslevel,this.updateCouont(),this.currentState=t.isMax()?"max":"normal",t.canbuyCount>0)this.lbVip.text=Lang.mol_str22.replace("$count$",""+t.canbuyCount);else if(Actor.ins().sVipLv>=Cfg.getMaxConfig(SVipConfig).lv)this.lbVip.text="";else{var s=Cfg.getNextVipExp(FbGroup.ShenDian);s?this.lbVip.text=Lang.mol_str12.replace("$vip$",""+s):this.lbVip.text=""}},e.prototype.updateCouont=function(){var t=FbSys.ins().shendianData;this.lbSurplus.text=t.leftCount.toString()},e.prototype.updateStatus=function(){},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(this))&&(this.btnintofuben.redPoint.visible=RpSys.ins().getData(ExtCom,FuBenWin,FuBenDuoRenPanel,e))},e.prototype.onClick=function(t){var e=FbSys.ins().shendianData;switch(t.target){case this.btnintofuben:if(0==e.leftCount)return void(0==e.canbuyCount&&e.zhuzhanCount>0?showTipsWarn(Lang.mol_str13):e.canbuyCount>0?showTipsWarn(Lang.fb_str34.replace("$name$",Lang.sm_str1)):showTipsWarn(Lang.mol_str15));FbSys.ins().sendShenDianGoToFuben();break;case this.btnSurplus:if(e.leftCount>0)showTipsWarn(Lang.fb_str36);else if(e.canbuyCount>0){var i=new PopupPriceData(Lang.ml_str4),n=Cfg.getConfig(ShenghunCommonConfig).needdiamond[e.buyCount];i.priceValue=n,i.priceType=CurType.yb,i.setFunction(this,function(){GFunc.checkCurrency(CurType.yb,n)&&FbSys.ins().sendShenDianBuyCount()}),openWin(CommonTipsWinNew,i)}else{var a=Cfg.getNextVipExp(FbGroup.ShenDian);a?(showTipsWarn(Lang.fb_str38.replace("$lv$",""+a)),openWin(RechargeWin)):showTipsWarn(Lang.fb_str39)}}},e.getSysId=function(){return SysId.ShenDian},e.getTitle=function(){return"btz_zycs_fb"},e.getTabTitle=function(){return"fb_zycs_shsh"},e}(BasePanel);__reflect(ShenDianPanel.prototype,"ShenDianPanel"),window.ShenDianPanel=ShenDianPanel;var ShenDianResultWin=function(t){function e(){var e=t.call(this)||this;return e.resultData=new FbResultShenDianData,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.skinName="ShenDianResultEUI",this.addBg(),this.list.itemRenderer=ItemBaseReward,this.list.dataProvider=this.listArray=new eui.ArrayCollection},e.prototype.open=function(t){this.resultData=t,this.addClickE(this.closeBtn,this.onTap),this.addClickE(this.closeBtn0,this.onTap),this.iniData()},e.prototype.iniData=function(){Timer.ins()["do"](0,1e3,5,this.updateLabel,this);var t=this.resultData.rewardItem.concat();SortUtil.sortOn(t,["quality"],[SortType.down]),this.listArray.source=t,this.lbTime.textFlow=addColorTF(""+getFormatTime(this.resultData.leftCdTime,"mm:ss")),this.lbHP.textFlow=addColorTF(this.resultData.hp+"%"),this.lbCount.textFlow=addColorTF(""+this.resultData.count);var e=(Cfg.getConfig(ShenghunFubenConfig,CondType.Equal,ShenghunFubenConfig.fbId,this.resultData.fbId),Cfg.getShenghunCommonByIdCount(this.resultData.fbId,this.resultData.count));this.imgSroce.source=ResMgr.imgScore[e+1]},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this),FbSys.ins().sendExitFb()},e.prototype.updateLabel=function(t){0>=t&&this.onCloseBtn(),this.closeBtn.label=Lang.common_str47.replace("$second$",t.toString())},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:this.onCloseBtn();break;case this.closeBtn0:closeWin(this)}},e.prototype.onCloseBtn=function(){closeWin(this)},e}(BaseWinSingle);__reflect(ShenDianResultWin.prototype,"ShenDianResultWin"),window.ShenDianResultWin=ShenDianResultWin;var ShenDianRoleFaceItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedFortFbFaceItemskin",e.setSkinPart("roleItem",new MainRoleItem),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.roleItem.setState(MainRoleItem.STATE_0),this.roleItem.setJob(t),this.roleItem.setIsDead(!1),this.roleItem.updateHP(100,100)},e}(BaseItemRender);__reflect(ShenDianRoleFaceItem.prototype,"ShenDianRoleFaceItem"),window.ShenDianRoleFaceItem=ShenDianRoleFaceItem;var ShenDianRoleItem=function(t){function e(){var e=t.call(this)||this;return e.MAX_WIDTH=182,e.skinName="MoLongRoleEUI",e.mc1=new MC,e.mc1.y=12,e.groupMC1.addChild(e.mc1),e.mc3=new MC,e.mc3.scaleY=2,e.mc3.x=91,e.groupMC.addChild(e.mc3),e.groupMC.visible=!1,e.maskMC1=new MaskRect,e.maskMC1.setParam(182,40,MoveDir.R_To_L),e.groupMC.addChild(e.maskMC1),e.mc3.mask=e.maskMC1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lbHurt.text=t.hurt>0?GFunc.overLength(t.hurt):"",this.lbPlayName.text=t.playName,this.lbPlayName.textColor=t.isMy?5949490:15129784,this.roleFace.data=t.sex,t.hurt>0?this.lbPercentHurt.text=(t.hurt/t.sumHurt*100).toFixed(0)+"%":this.lbPercentHurt.text="";var e="jdt"+t.index,i="gd"+t.index;~this.mc3.name.indexOf(e)||(this.mc3.playFile(getEffName(e),-1),this.mc1.playFile(getEffName(i),-1));var n=0;t.hurt>0&&(n=t.hurt/t.sumHurt,n>1&&(n=1),this.groupMC.visible=!0),this.maskMC1.setPercent(n);var a=0;1==t.index?a=7:2==t.index?a=4:3==t.index&&(a=8),this.mc1.x=(1-n)*this.MAX_WIDTH-a},e}(BaseItemRender);__reflect(ShenDianRoleItem.prototype,"ShenDianRoleItem"),window.ShenDianRoleItem=ShenDianRoleItem;var ShenDianZuDuiWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="CommonTipsWinEUI1",this.addBg()},e.prototype.open=function(t){this.addClickE(this.btnOk,this.onClick),this.popupBaseData=t,this.lbContent.textFlow=StrUtil.toTF(t.desc),Timer.ins()["do"](0,1e3,t.timer,this.updateLabel,this)},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this)},e.prototype.updateLabel=function(t){0>=t&&this.onCloseBtn(),this.btnOk.label=Lang.mol_str20+"("+t+")"},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOk:this.popupBaseData.sureFun(),closeWin(this)}},e.prototype.onCloseBtn=function(){this.popupBaseData.sureFun(),closeWin(this)},e}(BaseWinSingle);__reflect(ShenDianZuDuiWin.prototype,"ShenDianZuDuiWin"),window.ShenDianZuDuiWin=ShenDianZuDuiWin;var ShenDianZuZuiTimeWin=function(t){function e(){var e=t.call(this)||this;return e.time=0,e.desc="",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.winType=WinType.NeverCloseWin,this.layer=LayerMgr.Main_Down,this.skinName="ShenDianZuZuiTimeWinEUI"},e.prototype.open=function(e,i){void 0===e&&(e=""),void 0===i&&(i=0),t.prototype.open.call(this),this.time=i,this.desc=e,Timer.ins()["do"](0,1e3,0,this.updateDesc,this)},e.prototype.getTime=function(){return Math.max(0,Math.ceil((this.time-Timer.ins().getTimer())/1e3))},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this)},e.prototype.updateDesc=function(){this.getTime()<=0&&this.onCloseBtn(),this.lbTime.text=this.desc.replace("$s$",getFormatTime(this.getTime(),"mm:ss"))},e.prototype.onCloseBtn=function(){closeWin(this)},e}(BaseWinSingle);__reflect(ShenDianZuZuiTimeWin.prototype,"ShenDianZuZuiTimeWin"),window.ShenDianZuZuiTimeWin=ShenDianZuZuiTimeWin;var ShengLingActTipsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="ShengLingActTipsWinEUI",e}return __extends(e,t),e.prototype.open=function(e,i){t.prototype.open.call(this),this.closeFun=i,this.updatePanel(e),this.addClickE(this,this.onTap)},e.prototype.close=function(){t.prototype.close.call(this),this.groupEntity&&this.groupEntity.removeChildren()},e.prototype.onTap=function(t){this.closeFun&&this.closeFun(),closeWin(this)},e.prototype.updatePanel=function(t){var e="",i=Cfg.getConfig(ShengLingConfig,t),n=Actor.ins().job;e=Cfg.getConfig(ShengLingAppearanceConfig,i.bodyIds[n-1]).appearance,this.groupEntity.addChild(MC.createCenterGruop(e,-1)),this.lb_name.text=i.name},e}(BaseWinSingle);__reflect(ShengLingActTipsWin.prototype,"ShengLingActTipsWin"),window.ShengLingActTipsWin=ShengLingActTipsWin;var ShengLingDaShiWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="XingHunAttrWinEUI",this.imgTitle.source="shengling_zycs_slds",this.addBg(),t.prototype.initUI.call(this),this.layer=LayerMgr.Popup},e.prototype.open=function(e){t.prototype.open.call(this),this.daShiData=e,this.addClickE(this.btnUp,this.onClick),this.addLsn(QiyuSys.ins().patchShengLingDaShiUp,this.update),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.update(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(this))&&(this.btnUp.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,ShengLingLevelPanel,this.daShiData.id,e))},e.prototype.update=function(){var t=this.daShiData,e=QiyuSys.ins().shengLingModel.getShengLingDataById(t.id),i=e.getBaseConfig().name;this.totalPower.text=t.genPower().toFixed(),this.bitLevel.text="."+t.level+"r";var n=t.getConfig(),a=Cfg.getConfig(ShengLingDashiConfig,t.id,Math.max(t.level-1,0)).needLevel,o=t.noActRank()?addColor(Lang.xh_str4,3822967):addColor(Lang.xh_str4,3822967)+"  "+addColor(i+Lang.sl_str3+a+Lang.sl_str4,16774296)+addColor(Lang.common_str40,5767068);if(this.lbCurLevel.size=20,this.lbCurLevel.textFlow=addColorTF(o),o=t.noActRank()?addColor(Lang.xh_str9,15066597):addColor(""+i+Lang.sl_str9+" +"+t.getConfig().attrPer/100+"%",3407744),this.lbCurAttr.textFlow=addColorTF(o),!t.isMaxRank()){var s=Cfg.getNextConfig(ShengLingDashiConfig,t.id,t.level),r=e.getChong(),u=addColor("("+r+"/"+n.needLevel+")",r<n.needLevel?16724787:5767068);this.lbNextLevel.size=20,this.lbNextLevel.textFlow=addColorTF(addColor(Lang.foot_str2,3822967)+"  "+addColor(i+Lang.sl_str3+n.needLevel+Lang.sl_str4,16774296)+u),this.lbNextAttr.textFlow=addColorTF(""+i+Lang.sl_str9+" +"+s.attrPer/100+"%",15066597)}var h=t.canRank();t.noActRank()?this.currentState=h?"canAct":"noAct":t.isMaxRank()?this.currentState="max":h?this.currentState="upRank":this.currentState="noRank"},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnUp:this.daShiData.canRank()&&QiyuSys.ins().sendShengLingDaShiUp(this.daShiData.id)}},e}(BaseWinSingle);__reflect(ShengLingDaShiWin.prototype,"ShengLingDaShiWin"),window.ShengLingDaShiWin=ShengLingDaShiWin;var ShengLingModel=function(){function t(){this.yinjiCount=6,this.shengLingDatas=[],this.yinJiDatas=[],this.huanHuaId=0}return t.prototype.parserInfo=function(t){this.shengLingDatas.length=0;for(var e=t.readByte(),i=0;e>i;i++){var n=new ShengLingData;n.parser(t),this.shengLingDatas.push(n)}e=t.readByte();for(var a=0;e>a;a++){var o=new ShengLingYinJiData;o.parser(t),this.yinJiDatas[o.id]=o}this.huanHuaId=t.readByte()},t.prototype.parserLevelUp=function(t){var e=this.getShengLingDataById(t.readByte());e.level=t.readShort()},t.prototype.parserYinJiUp=function(t){var e=t.readInt(),i=this.yinJiDatas[e];return i.level=t.readShort(),i},t.prototype.parserStageUp=function(t){var e=this.getShengLingDataById(t.readByte());e.stage=t.readShort()},t.prototype.parserDaShiUp=function(t){var e=this.getShengLingDataById(t.readByte());e.daShiData.level=t.readShort()},t.prototype.parserTaoZhuangUp=function(t){var e=this.getShengLingDataById(t.readByte());e.tzLevel=t.readShort()},t.prototype.getShengLingDataById=function(t){for(var e=0,i=this.shengLingDatas;e<i.length;e++){var n=i[e];if(n.id==t)return n}return null},t.prototype.getYinJiDatasById=function(t){for(var e=this.getShengLingDataById(t).getBaseConfig().tag,i=[],n=0,a=e;n<a.length;n++){var o=a[n];i.push(this.yinJiDatas[o])}return i},t.prototype.getYinJiActCountById=function(t){for(var e=this.getShengLingDataById(t).getBaseConfig().tag,i=0,n=0,a=e;n<a.length;n++){var o=a[n];this.yinJiDatas[o].isAct()&&(i+=1)}return i},t.prototype.isAct=function(t){var e=!1;if(1==t.id)e=!0;else if(t.level>0)e=!0;else{var i=this.getShengLingDataById(t.getBaseConfig().needId);e=i.level>=t.getBaseConfig().needLevel}return e},t.prototype.getActDec=function(t){var e=this.getShengLingDataById(t.getBaseConfig().needId),i=t.getBaseConfig().needLevel,n=Lang.sl_str1.replace("$name$",e.getBaseConfig().name);return n=n.replace("$chong$",""+e.getChong(i)),n=n.replace("$ji$",""+e.getJi(i))},t.prototype.getTaoZhuangDatas=function(t,e){for(var i=this.getShengLingDataById(t),n=this.getYinJiDatasById(i.id),a=Number.MAX_VALUE,o=0,s=n;o<s.length;o++){var r=s[o];a=Math.min(a,r.level)}var u=[],h=Cfg.getConfigs(ShengLingSuitConfig,i.id);for(var p in h){var l=new ShengLingTaoZhuangData;l.config=h[p],h[p].level>0&&(l.needLevel=h[h[p].level-1].needLevel),i.tzLevel>=h[p].level?l.state=1:1==e&&a>=l.needLevel?l.state=2:l.state=0,l.config.level>0&&u.push(l)}return u},t}();__reflect(ShengLingModel.prototype,"ShengLingModel"),window.ShengLingModel=ShengLingModel;var ShengLingStageItemTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShengLingStageItemTipsWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.setSkinPart("itemIcon",new ItemIcon)},e.prototype.open=function(e){t.prototype.open.call(this),this.updatePanel(e)},e.prototype.updatePanel=function(t){var e=t.cfg;this.imgBg.source="shengling_zycs_d"+e.quality+"_png",this.itemIcon.setDataByItemConfig(e),Actor.ins().isLocation?this.lbName.text=e.getName()+("("+e.id+")"):this.lbName.text=e.getName(),this.lbName.textColor=GConst.PZColor[e.quality],this.lbScore.textFlow=addColorTF(Lang.sl_str10+"："+addColor(t.power,5767068)),this.lbJob.textFlow=addColorTF(""+Lang.itemtips_str1+addColor(Lang.common_jobName1[0],5767068)),this.desc.textFlow=StrUtil.toTF(e.getDesc());var i=AttrData.getFm(null,5767068,"","+");this.lbAttr.textFlow=addColorTF(AttrData.parse(e.pattr,{fm:i}).join("\n"));var n=Cfg.getConfig(ShengLingConfig,e.huanhuaId),a=Cfg.getConfig(SkillPassiveConfig,n.skill,1);this.lbSkillName.text=""+a.name,this.lbSkillDec.textFlow=StrUtil.toTF(a.skinname)},e}(BaseWinSingle);__reflect(ShengLingStageItemTipsWin.prototype,"ShengLingStageItemTipsWin"),window.ShengLingStageItemTipsWin=ShengLingStageItemTipsWin;var ShengLingTaoZhuangWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengLingTaoZhuangWinEUI",e.addBg(),e.layer=LayerMgr.Popup,e.list.itemRenderer=ShengLingTaoZhuangItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.shengLingData=e,this.addClickE(this.btnSend,this.onClick),this.addLsn(QiyuSys.ins().patchShengLingTaoZhuangUp,this.updatePanel),this.updatePanel()},e.prototype.updatePanel=function(){var t=QiyuSys.ins().shengLingModel.getTaoZhuangDatas(this.shengLingData.id,1);this.listData.source=t;for(var e=0,i=t.length-1;i>=0;i--)if(0!=t[i].state&&i>=8){e=i;break}this.list.validateNow(),this.scroller.validateNow(),this.scroller.viewport.scrollV=31*Math.max(e-8,0),this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,ShengLingYinJiPanel,this.shengLingData.id,"taozhuang")},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=QiyuSys.ins().shengLingModel.getTaoZhuangDatas(this.shengLingData.id,1);1==e[e.length-1].state||(this.btnSend.redPoint.visible?QiyuSys.ins().sendShengLingTaoZhuangUp(this.shengLingData.id):showtipsFail("未达到激活条件"))}},e}(BaseWinSingle);__reflect(ShengLingTaoZhuangWin.prototype,"ShengLingTaoZhuangWin"),window.ShengLingTaoZhuangWin=ShengLingTaoZhuangWin;var ShengLingYinJiTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShengLingYinJiTipsWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.setSkinPart("itemIcon",new ItemIcon),this.tzList.itemRenderer=ShengLingTaoZhuangItem,this.tzList.dataProvider=this.tzListData=new eui.ArrayCollection,this.gainList.itemRenderer=GainGoodsItem,this.gainList.dataProvider=this.gainListData=new eui.ArrayCollection,this.groupMc.scaleX=this.groupMc.scaleY=.6,this.entityRole=GFunc.createEntityUI(),this.entityRole.y=100,this.entityRole.scaleX=this.entityRole.scaleY=2,this.groupMc.addChild(this.entityRole)},e.prototype.open=function(e){t.prototype.open.call(this),this.addItemTapE(this.gainList,this.onTouchList),this.updatePanel(e)},e.prototype.close=function(){t.prototype.close.call(this),this.entityRole.reset()},e.prototype.updatePanel=function(t){var e=t.cfg;this.itemIcon.setDataByItemConfig(e),this.imgQuality.source="tips_zycs_"+e.quality,Actor.ins().isLocation?this.lbName.text=e.getName()+("("+e.id+")"):this.lbName.text=e.getName(),this.lbName.textColor=GConst.PZColor[e.quality];var i=Lang.itemtips_str12+addColor(e.level+Lang.common_ji,16777215);this.lbLv.textFlow=addColorTF(i);var n=Lang.itemtips_str26,a=t.count;if(void 0==a){var o=BagSys.ins().getItemByTypeAndId(0,e.id);n+=o?o.count+"":"0"}else n+=a;this.lbCount.text=n,this.lbattr.textFlow=addColorTF(this.getAttrAndPower(t)),this.tzListData.source=QiyuSys.ins().shengLingModel.getTaoZhuangDatas(e.huanhuaId,0);var s=GFunc.getGainItemWayConfig(e.id);if(s.length>0){this.groupGain.scaleY=this.gainList.scaleY=1,this.gainListData.source=s;var r=s.length>4?4:s.length;this.gainList.width=94*r+35*(r-1)}else this.groupGain.scaleY=this.gainList.scaleY=0;this.lbDesc.textFlow=StrUtil.toTF(e.getDesc());var u=Cfg.getConfig(ShengLingConfig,e.huanhuaId),h=Lang.common_str23+addColor("6"+Lang.common_ge,5767068)+Lang.sl_str11+addColor(""+u.name+Lang.sl_str12,5767068)+Lang.sl_str13;this.lbDesc2.textFlow=addColorTF(h),this.updateEntity(u.id)},e.prototype.updateEntity=function(t){var e=Actor.ins().getMyData(),i=new EntityRoleData;i.szId=e.szId,i.damonId=e.damonId,i.job=e.job,i.wingId=e.wingId,i.sex=e.sex,i.shengLingId=t,i.type=EntityType.ROLE,this.entityRole.setData(i,3,EntityAction.STAND)},e.prototype.onTouchList=function(t){var i=t.item;if(null!=t.item){var n=GFunc.createTaskNavData(i.controlTarget);n.setsucceedFrontFun(function(){WinMgr.ins().closeAllWin(),closeWin(e)}),n["goto"](i.sysid)}},e.prototype.getAttrAndPower=function(t){var e=AttrData.getFm(null,1176860,"","+"),i=AttrData.parse(t.cfg.pattr,{fm:e}).join("\n");return i+=addColor("\n"+Lang.common_str113+"+"+t.power,16751375)},e}(BaseWinSingle);__reflect(ShengLingYinJiTipsWin.prototype,"ShengLingYinJiTipsWin"),window.ShengLingYinJiTipsWin=ShengLingYinJiTipsWin;var ShengLingDaShiData=function(){function t(){this.id=1,this.level=0}return t.prototype.getConfig=function(){return this.config&&this.config.level==this.level||(this.config=Cfg.getConfig(ShengLingDashiConfig,this.id,this.level)),this.config},t.prototype.noActRank=function(){return 0==this.level},t.prototype.isMaxRank=function(){return this.level>=Cfg.getMaxConfig(ShengLingDashiConfig,this.id).level},t.prototype.canRank=function(){return this.isMaxRank()?!1:QiyuSys.ins().shengLingModel.getShengLingDataById(this.id).getChong()>=this.getConfig().needLevel},t.prototype.getDaShiPlusAttr=function(){var t=[],e=QiyuSys.ins().shengLingModel.getShengLingDataById(this.id).getLevelConfig().attr,i=this.getConfig().attrPer;for(var n in e){var a=new AttrData;a.type=e[n].type,a.value=e[n].value*i/1e4,t.push(a)}return t},t.prototype.genPower=function(){return GFunc.getPower(this.getDaShiPlusAttr())>>0},t}();__reflect(ShengLingDaShiData.prototype,"ShengLingDaShiData"),window.ShengLingDaShiData=ShengLingDaShiData;var ShengLingData=function(){function t(){this.id=1,this.stage=0,this.level=0,this.tzLevel=0,this.daShiData=new ShengLingDaShiData}return t.prototype.parser=function(t){this.id=t.readByte(),this.stage=t.readShort(),this.level=t.readShort(),this.tzLevel=t.readShort(),this.daShiData.level=t.readShort(),this.daShiData.id=this.id},t.prototype.getBaseConfig=function(){return this.baseConfig||(this.baseConfig=Cfg.getConfig(ShengLingConfig,this.id))},t.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.level==this.level||(this.levelConfig=Cfg.getConfig(ShengLingLevelConfig,this.level)),this.levelConfig},t.prototype.getNextLevelConfig=function(){return(!this.nextLevelConfig||this.nextLevelConfig.level<=this.level)&&(this.nextLevelConfig=Cfg.getNextConfig(ShengLingLevelConfig,this.level)),this.nextLevelConfig},t.prototype.getStageConfig=function(){return this.stageConfig||(this.stageConfig=Cfg.getConfig(ShengLingStageConfig,this.id))},t.prototype.getStageAttrDatas=function(t){return void 0===t&&(t=this.stage),t>this.getBaseConfig().maxStage&&(t=this.getBaseConfig().maxStage),AttrData.attrMultiple(this.getStageConfig().attr,t)
},t.prototype.getChong=function(t){void 0===t&&(t=this.level);var e=Math.ceil(t/10);return 0==t&&(e=1),e},t.prototype.getJi=function(t){void 0===t&&(t=this.level);var e=t%10;return t>0&&(e=0==e?10:e),e},t.prototype.isMaxLevel=function(){return this.level>=this.getBaseConfig().maxLevel},t.prototype.isMaxStage=function(){return this.stage>=this.getBaseConfig().maxStage},t.prototype.getLevelPower=function(){var t=GFunc.getPower(this.getLevelConfig().attr);return t+=this.daShiData.genPower(),t>>0},t.prototype.getStagePower=function(){var t=GFunc.getPower(this.getStageAttrDatas());return t+=SkillSys.ins().getSkillPassivityDataById(this.getBaseConfig().skill).getPower(),t>>0},t}();__reflect(ShengLingData.prototype,"ShengLingData"),window.ShengLingData=ShengLingData;var ShengLingYinJiData=function(){function t(){this.id=1,this.level=0}return t.prototype.parser=function(t){this.id=t.readInt(),this.level=t.readShort()},t.prototype.getItemConfig=function(){return this.itemConfig||(this.itemConfig=Cfg.getItemCfg(this.id))},t.prototype.getConfig=function(){return this.config||(this.config=Cfg.getConfig(ShengLingTagConfig,this.id))},t.prototype.getStageAttrDatas=function(t){return void 0===t&&(t=this.level),t>this.getConfig().maxLevel&&(t=this.getConfig().maxLevel),AttrData.attrMultiple(this.getConfig().attr,t)},t.prototype.getName=function(){return this.getItemConfig().getName()},t.prototype.isAct=function(){return this.level>0},t.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},t.prototype.getPower=function(){var t=GFunc.getPower(this.getStageAttrDatas());return t>>0},t.prototype.getShengLingId=function(){return this.getConfig().shengLingId},t}();__reflect(ShengLingYinJiData.prototype,"ShengLingYinJiData"),window.ShengLingYinJiData=ShengLingYinJiData;var ShengLingItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengLingItemEUI",e.showRedPoint(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof ShengLingData&&(this.imgIcon.source="shengling_zycs_q"+this.data.id)},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e}(BaseItemRender);__reflect(ShengLingItem.prototype,"ShengLingItem"),window.ShengLingItem=ShengLingItem;var ShengLingLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.longPressBtnUp=new LongPress,e.datas=[],e.index=0,e._appearance="",e._mcKeduUrl="",e._mcQuanUrl="",e.skinName="ShengLingLevelPanelEUI",e.setSkinPart("comDaShi",new XingHunBarEff),e.list.itemRenderer=ShengLingItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.mc=new MC,e.groupMc.addChild(e.mc),e.mcQuan=new MC,e.groupMc.addChild(e.mcQuan),e.mcKedu=new MC,e.groupMc.addChild(e.mcKedu),e.quanMask=new MaskSector,e.quanMask.y=11,e.quanMask.setParam(240,-90,270,0),e.groupMc.addChild(e.quanMask),e.mcQuan.mask=e.quanMask,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.comDaShi,this.onClick),this.addClickE(this.btnSend,this.onClick),this.addItemTapE(this.list,this.onItemClick),this.addEvent(egret.Event.CHANGING,this.quanMask,this.maskChanging),this.addLsn(QiyuSys.ins().patchShengLingLevelUp,this.updatePanel),this.addLsn(QiyuSys.ins().patchShengLingDaShiUp,this.updatePanel),this.addLsn(BagSys.ins().patchItemChange,this.updateItem),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this._appearance="",this._mcKeduUrl="",this._mcQuanUrl="",this.longPressBtnUp.close(),this.mc.reset(),this.mcQuan.reset(),this.mcKedu.reset()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(this))for(var i=0;i<this.datas.length;i++){var n=this.list.getChildAt(i);n.showRedPoint(RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[i].id))}},e.prototype.infoPanel=function(){this.dataModel=QiyuSys.ins().shengLingModel,this.listData.source=this.datas=this.dataModel.shengLingDatas,this.index=0;for(var t=0;t<this.datas.length;t++)RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[t].id)&&(this.index=Math.max(this.index,t));this.list.selectedIndex=this.index,this.list.validateNow(),this.updatePanel(),this.updateRp()},e.prototype.updatePanel=function(){var t=this.datas[this.index];this.power.text=""+t.getLevelPower(),this.lb_name.text=t.getBaseConfig().name,this.imgQuan.source="shengling_zycs_jd"+t.id+"_png";var i=t.getJi(),n=t.getChong();this.lb_lv.text=n+"重"+i+"级",this.btnSend.label=10==i?Lang.btn_tp:Lang.btn_fl,this.quanMask.setValue(i,10,200);var a=AttrData.getFm(null,5767068,"","+");this.lbCurAttr.textFlow=addColorTF(AttrData.parse(t.getLevelConfig().attr,{fm:a}).join("\n")),this.lbNextAttr.textFlow=addColorTF(AttrData.parse(t.getNextLevelConfig().attr,{fm:a}).join("\n")),this.lbDaShi.text=Lang.sl_str2+"·"+t.daShiData.level+Lang.common_jie,this.comDaShi.setData(n,t.daShiData.getConfig().needLevel),this.comDaShi.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,t.id,ShengLingDaShiWin);var o=Cfg.getConfig(ShengLingAppearanceConfig,t.getBaseConfig().bodyIds[Actor.ins().job-1]).appearance;this._appearance!=o&&(this.mc.playFile(ResMgr.getShengLingUIEFFResource(o),-1),this._appearance=o);var s="shengling_zycs_d"+t.id;this._mcKeduUrl!=s&&(this.mcKedu.playFile(getEffName(s),-1),this.mcKedu.y=11,this._mcKeduUrl=s),s="shengling_zycs_jd"+t.id,this._mcQuanUrl!=s&&(this.mcQuan.playFile(getEffName(s),-1),this.mcQuan.y=11,this._mcQuanUrl=s),this.updateItem(),this.updateState()},e.prototype.maskChanging=function(t){var e=t.data,i=MathUtil.getAngle(e[1]),n=MathUtil.getRadian(i);this.mcKedu.x=160*Math.cos(n),this.mcKedu.y=160*Math.sin(n)+11,this.mcKedu.rotation=i-90},e.prototype.updateItem=function(){var t=this.datas[this.index];if(!t.isMaxLevel()){var i=GFunc.getItemCount(t.getLevelConfig().cost[0].id),n=t.getLevelConfig().cost[0].count;this.lbConsu.textFlow=addColorTF(i+"/"+n,n>i?15733780:5767068),this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,"level")}},e.prototype.updateState=function(){var t=this.datas[this.index];this.dataModel.isAct(t)?t.isMaxLevel()?this.currentState="max":this.currentState="normal":(this.lbActDec.text=this.dataModel.getActDec(t),this.currentState="nojihuo")},e.prototype.onItemClick=function(t){this.index!=t.itemIndex&&(this.index=t.itemIndex,this.quanMask.setValue(0,10,0),this.updatePanel())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:this.autoUp();break;case this.comDaShi:openWin(ShengLingDaShiWin,this.datas[this.index].daShiData)}},e.prototype.autoUp=function(){var t=this.datas[this.index];GFunc.checkConsumeEnough(t.getLevelConfig().cost)?(10==t.getJi(),QiyuSys.ins().sendShengLingLevelUp(t.id)):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_sl"},e.getTabTitle=function(){return Lang.btn_fl},e.getSysId=function(){return SysId.ShengLing},e}(BasePanel);__reflect(ShengLingLevelPanel.prototype,"ShengLingLevelPanel"),window.ShengLingLevelPanel=ShengLingLevelPanel;var ShengLingPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,ZhuangBanWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShengLingYinJiPanel,ShengLingLevelPanel,ShengLingStagePanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="ShengLingPanelEUI"},e.getTitle=function(){return"btz_zycs_sl"},e.getTabTitle=function(){return"bqz_zycs_sl"},e.getSysId=function(){return SysId.ShengLing},e}(BaseTabPanel);__reflect(ShengLingPanel.prototype,"ShengLingPanel"),window.ShengLingPanel=ShengLingPanel;var ShengLingStagePanel=function(t){function e(){var e=t.call(this)||this;return e.datas=[],e.index=0,e.skinName="ShengLingStagePanelEUI",e.list.itemRenderer=ShengLingItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClick),this.addItemTapE(this.list,this.onItemClick),this.addLsn(QiyuSys.ins().patchShengLingStageUp,this.updatePanelUp),this.addLsn(BagSys.ins().patchItemChange,this.updateItem),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.mc.reset()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(this))for(var i=0;i<this.datas.length;i++){var n=this.list.getChildAt(i);n.showRedPoint(RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[i].id))}},e.prototype.infoPanel=function(){this.dataModel=QiyuSys.ins().shengLingModel,this.listData.source=this.datas=this.dataModel.shengLingDatas,this.index=0;for(var t=0;t<this.datas.length;t++)RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[t].id)&&(this.index=Math.max(this.index,t));this.list.selectedIndex=this.index,this.list.validateNow(),this.updatePanel(),this.updateRp()},e.prototype.updatePanelUp=function(){GFunc.playUIMovie("sl_zycs_jj",360,420,this,1),this.updatePanel()},e.prototype.updatePanel=function(){var t=this.datas[this.index];this.power.text=""+t.getStagePower(),this.lb_name.text=t.getBaseConfig().name,this.lb_lv.text=t.stage+"阶";var e=SkillSys.ins().getSkillPassivityDataById(t.getBaseConfig().skill);this.lbCurSkillName.text=e.getConfig().name+"Lv."+e.level,this.lbCurSkill.textFlow=StrUtil.toTF(e.getConfig().skinname),this.lbNextSkillName.text=e.getNextConfig().name+"Lv."+e.getNextConfig().level,this.lbNextSkill.textFlow=StrUtil.toTF(e.getNextConfig().skinname);var i=AttrData.getFm(null,5767068,"","+");this.lbCurAttr.textFlow=addColorTF(AttrData.parse(t.getStageAttrDatas(),{fm:i}).join("\n")),this.lbNextAttr.textFlow=addColorTF(AttrData.parse(t.getStageAttrDatas(t.stage+1),{fm:i}).join("\n"));var n=Cfg.getConfig(ShengLingAppearanceConfig,t.getBaseConfig().bodyIds[Actor.ins().job-1]).appearance;this.mc.playFile(ResMgr.getShengLingUIEFFResource(n),-1),this.updateItem(),this.updateState()},e.prototype.updateItem=function(){var t=this.datas[this.index];if(!t.isMaxStage()){var i=t.getStageConfig().needItem[0].id,n=t.getStageConfig().needItem[0].count,a=GFunc.getItemCount(i);this.lbConsu.textFlow=addColorTF(a+"/"+n,n>a?15733780:5767068),this.imgConsu.source="zycs_"+i,this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,t.id)}},e.prototype.updateState=function(){var t=this.datas[this.index];t.isMaxStage()?this.currentState="max":this.currentState="normal"},e.prototype.onItemClick=function(t){this.index=t.itemIndex,this.updatePanel()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=this.datas[this.index];GFunc.checkConsumeEnough(e.getStageConfig().needItem)&&(QiyuSys.ins().sendShengLingStageUp(e.id),showtipsFail(Lang.sl_str15))}},e.getTitle=function(){return"btz_zycs_sl"},e.getTabTitle=function(){return Lang.btn_jj},e.getSysId=function(){return SysId.ShengLing},e}(BasePanel);__reflect(ShengLingStagePanel.prototype,"ShengLingStagePanel"),window.ShengLingStagePanel=ShengLingStagePanel;var ShengLingTaoZhuangItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengLingTaoZhuangItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof ShengLingTaoZhuangData){var t=16777215;0==this.data.state?(t=15066597,this.lbState.textFlow=addColorTF(Lang.common_str24,t)):1==this.data.state?(t=3407744,this.lbState.textFlow=addColorTF(Lang.common_str28,t)):2==this.data.state&&(t=3506362,this.lbState.textFlow=addColorTF(Lang.sl_str6,t));var e=""+Lang.sl_str7+this.data.needLevel+Lang.common_jie+"：";e+=this.data.config.addattr.type==AttrType.shengLingYinjiAllPer?""+this.data.config.attrDec:AttrData.getAttrName(this.data.config.addattr.type)+"+"+AttrData.getAttrValue(this.data.config.addattr),this.lbDec.textFlow=addColorTF(e,t)}},e}(BaseItemRender);__reflect(ShengLingTaoZhuangItem.prototype,"ShengLingTaoZhuangItem"),window.ShengLingTaoZhuangItem=ShengLingTaoZhuangItem;var ShengLingTaoZhuangData=function(){function t(){this.state=0,this.needLevel=0}return t}();__reflect(ShengLingTaoZhuangData.prototype,"ShengLingTaoZhuangData");var ShengLingYinJiItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShengLingYinJiItemEUI",e.selectMC=new MC,e.selectMC.playFile(getEffName("sl_zycs_xz"),-1),e.groupSelect.addChild(e.selectMC),e.showRedPoint(!1),e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof ShengLingYinJiData&&(this.imgIcon.source=ResMgr.getItemIcon(this.data.id),this.imgIcon.filters=this.data.isAct()?[]:DisUtil.grayFilter(),this.lbLevel.text=this.data.isAct()?""+this.data.level+Lang.common_jie:this.data.getName())},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e.prototype.playUpMc=function(){GFunc.playUIMovie("sl_zycs_bao",0,0,this.groupMc,1)},e}(BaseItemRender);__reflect(ShengLingYinJiItem.prototype,"ShengLingYinJiItem"),window.ShengLingYinJiItem=ShengLingYinJiItem;var ShengLingYinJiPanel=function(t){function e(){var e=t.call(this)||this;return e.datas=[],e.index=0,e.yinjiDatas=[],e.yinJiIndex=0,e.dir=0,e.currentA=0,e.targetA=0,e.gapA=60,e.isRun=!1,e.posIndex=0,e.gapRad=Math.PI/3,e.rads=[1*e.gapRad,2*e.gapRad,3*e.gapRad,4*e.gapRad,5*e.gapRad,6*e.gapRad],e.isR=!0,e.skinName="ShengLingYinJiPanelEUI",e.yinJiItems=[e.yinJi6,e.yinJi7,e.yinJi8,e.yinJi9,e.yinJi10,e.yinJi11],e.list.itemRenderer=ShengLingItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.entityRole=GFunc.createEntityUI(),e.entityRole.y=80,e.entityRole.scaleX=e.entityRole.scaleY=1.2,e.groupMc.addChild(e.entityRole),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this);for(var e=0,i=this.yinJiItems;e<i.length;e++){var n=i[e];this.addClickE(n,this.onYinJiClick)}this.addClickE(this.btnSend,this.onClick),this.addClickE(this.helpBtn,this.onClick),this.addClickE(this.btnHuanHua,this.onClick),this.addClickE(this.btnTaoZhuang,this.onClick),this.addClickE(this.imgL1,this.onClick),this.addClickE(this.imgL2,this.onClick),this.addClickE(this.imgR1,this.onClick),this.addClickE(this.imgR2,this.onClick),this.addItemTapE(this.list,this.onItemClick),this.addLsn(QiyuSys.ins().patchShengLingHuanHua,this.updateHuanBtn),this.addLsn(QiyuSys.ins().patchShengLingYinJiUp,this.upAutoSelectYinji),this.addLsn(QiyuSys.ins().patchShengLingTaoZhuangUp,this.updateYinJi),this.addLsn(BagSys.ins().patchItemChange,this.updateItem),this.addLsn(RpSys.ins().patchRp,this.updateRp),Timer.ins()["do"](0,Timer.EVERY_FRAME,0,this.updateTick,this,TimerType.FIRST),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.entityRole.reset(),this.yinJiItems[this.yinJiIndex].selected=!1,Timer.ins().remove(this.updateTick,this)},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(this)){for(var i=0;i<this.datas.length;i++){var n=this.list.getChildAt(i);n.showRedPoint(RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[i].id))}for(var i=0;i<this.yinJiItems.length;i++)this.yinJiItems[i].showRedPoint(RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,this.yinjiDatas[i].id));this.btnTaoZhuang.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,"taozhuang")}},e.prototype.infoPanel=function(){this.dataModel=QiyuSys.ins().shengLingModel,this.listData.source=this.datas=this.dataModel.shengLingDatas,this.index=0;for(var t=0;t<this.datas.length;t++)RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[t].id)&&(this.index=Math.max(this.index,t));this.list.selectedIndex=this.index,this.list.validateNow(),this.setYinJi(),this.updataMC(),this.updateRp()},e.prototype.updataMC=function(){var t=this.datas[this.index];this.updateEntity(t.id),this.lb_name.text=t.getBaseConfig().name,this.btnTaoZhuang.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,t.id,"taozhuang")},e.prototype.updateEntity=function(t){var e=Actor.ins().getMyData(),i=new EntityRoleData;i.szId=e.szId,i.damonId=e.damonId,i.job=e.job,i.wingId=e.wingId,i.sex=e.sex,i.shengLingId=t,i.type=EntityType.ROLE,this.entityRole.setData(i,3,EntityAction.STAND)},e.prototype.updateYinJi=function(){var t=this.yinjiDatas[this.yinJiIndex],e=AttrData.getFm(null,5767068,"","+");this.lbCurAttr.textFlow=addColorTF(AttrData.parse(t.getStageAttrDatas(),{fm:e}).join("\n")),this.lbNextAttr.textFlow=addColorTF(AttrData.parse(t.getStageAttrDatas(t.level+1),{fm:e}).join("\n")),this.btnSend.label=t.isAct()?Lang.btn_sj:Lang.btn_jh,this.yinJiItems[this.yinJiIndex].dataChanged(),this.updateHuanBtn(),this.updatePower(),this.updateItem(),this.updateState(),this.updateRp()},e.prototype.upAutoSelectYinji=function(){if(this.yinJiItems[this.yinJiIndex].playUpMc(),this.yinJiItems[this.yinJiIndex].dataChanged(),RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,this.yinjiDatas[this.yinJiIndex].id))this.updateYinJi();else{for(var t=0,i=0;i<this.yinJiItems.length;i++)if(this.yinJiItems[i].data=this.yinjiDatas[i],RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,this.yinjiDatas[i].id)){t=i;break}this.yinJiItems[this.yinJiIndex].selected=!1,this.yinJiIndex=t,this.yinJiItems[this.yinJiIndex].selected=!0,this.updateYinJi()}},e.prototype.upAutoSelectYinji2=function(){if(this.yinJiItems[this.yinJiIndex].playUpMc(),RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,this.yinjiDatas[this.yinJiIndex].id))this.updateYinJi();else{for(var t=-1,i=0;i<this.yinJiItems.length;i++)this.yinJiItems[i].data=this.yinjiDatas[i],RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,this.yinjiDatas[i].id)&&(t=i);var n=this.yinJiIndex-(-1==t?0:t);0==n||-1==t?this.updateYinJi():this.isR?1==n||-5==n?this.setPlay(1,0,this.isR?-1:-2):2==n||-4==n?this.setPlay(2,0,this.isR?-2:-3):3==n||-3==n?(this.setPlay(2,1,this.isR?3:2),this.isR=!1):4==n||-2==n?(this.setPlay(1,1,this.isR?2:1),this.isR=!1):(5==n||-1==n)&&(this.yinJiItems[this.yinJiIndex].selected=!1,this.yinJiIndex=t,this.yinJiItems[this.yinJiIndex].selected=!0,this.isR=!1,this.updateYinJi()):1==n||-5==n?(this.yinJiItems[this.yinJiIndex].selected=!1,this.yinJiIndex=t,this.yinJiItems[this.yinJiIndex].selected=!0,this.isR=!0,this.updateYinJi()):2==n||-4==n?(this.setPlay(1,0,this.isR?-1:-2),this.isR=!0):3==n||-3==n?(this.setPlay(2,0,this.isR?-2:-3),this.isR=!0):4==n||-2==n?this.setPlay(2,1,this.isR?3:2):(5==n||-1==n)&&this.setPlay(1,1,this.isR?2:1)}},e.prototype.updateHuanBtn=function(){var t=this.datas[this.index];if(this.dataModel.huanHuaId==t.id)this.imgSyz.visible=!0,this.btnHuanHua.visible=!1,this.groupBarAll.visible=!1;else{this.imgSyz.visible=!1;var e=this.dataModel.getYinJiActCountById(t.id);e==this.yinjiDatas.length?(this.btnHuanHua.visible=!0,this.groupBarAll.visible=!1):(this.btnHuanHua.visible=!1,this.groupBarAll.visible=!0,this.bar.value=e,this.bar.maximum=this.yinjiDatas.length)}},e.prototype.updatePower=function(){for(var t=0,e=[],i=0,n=this.yinjiDatas;i<n.length;i++){var a=n[i];t+=a.getPower(),e=AttrData.mergeAttr(e,a.getConfig().attr)}var o=this.datas[this.index],s=Cfg.getConfigs(ShengLingSuitConfig,o.id),r=null;for(var u in s)o.tzLevel>=s[u].level&&(t+=GFunc.getPower([s[u].addattr])+s[u].addPower,s[u].addattr.type==AttrType.shengLingYinjiAllPer&&(r=s[u].addattr));if(r){for(var h=0,p=e;h<p.length;h++){var l=p[h];l.value=l.value*r.value/1e4}t+=GFunc.getPower(e)}this.power.text=""+(t>>0)},e.prototype.updateItem=function(){var t=this.yinjiDatas[this.yinJiIndex];if(!t.isMax()){var i=t.getConfig().needItem[0].id,n=t.getConfig().needItem[0].count,a=GFunc.getItemCount(i);this.lbConsu.textFlow=addColorTF(a+"/"+n,n>a?15733780:5767068),this.imgConsu.source="zycs_"+i,this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,this.datas[this.index].id,this.yinjiDatas[this.yinJiIndex].id)}},e.prototype.updateState=function(){var t=this.yinjiDatas[this.yinJiIndex];t.isMax()?this.currentState="max":this.currentState="normal"},e.prototype.setYinJi=function(){var t=this.datas[this.index].id;this.yinjiDatas=this.dataModel.getYinJiDatasById(t),this.yinJiItems[this.yinJiIndex].selected=!1,this.yinJiIndex=0;for(var i=0;i<this.yinJiItems.length;i++)this.yinJiItems[i].data=this.yinjiDatas[i];for(var n=0;n<this.yinJiItems.length;n++)if(RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShengLingPanel,e,t,this.yinjiDatas[n].id)){this.yinJiIndex=n;break}this.yinJiItems[this.yinJiIndex].selected=!0,this.updateYinJi()},e.prototype.onYinJiClick=function(t){var e=this.yinJiItems.indexOf(t.currentTarget);this.isRun||this.yinJiIndex==e||(this.yinJiItems[this.yinJiIndex].selected=!1,this.yinJiIndex=e,this.yinJiItems[this.yinJiIndex].selected=!0,this.isR=!this.isR,this.updateYinJi())},e.prototype.onItemClick=function(t){this.isRun||this.index==t.itemIndex||(this.index=t.itemIndex,this.setYinJi(),this.updataMC())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=this.yinjiDatas[this.yinJiIndex];!this.isRun&&GFunc.checkConsumeEnough(e.getConfig().needItem)&&QiyuSys.ins().sendShengLingYinJiUp(e.id);break;case this.btnHuanHua:QiyuSys.ins().sendShengLingHuanHua(this.datas[this.index].id);break;case this.btnTaoZhuang:openWin(ShengLingTaoZhuangWin,this.datas[this.index]);break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,112).text);break;case this.imgL1:this.setPlay(1,1,this.isR?2:1),this.isR=!1;break;case this.imgL2:this.setPlay(2,1,this.isR?3:2),this.isR=!1;break;case this.imgR1:this.setPlay(1,0,this.isR?-1:-2),this.isR=!0;break;case this.imgR2:this.setPlay(2,0,this.isR?-2:-3),this.isR=!0}},e.prototype.setYinjiInfoPos=function(t){this.isRun=!1,this.posIndex=(6-t)%6+1,this.targetA=this.posIndex*this.gapA,this.currentA=this.targetA,this.isR=!0,this.updateYinJiPos()},e.prototype.setPlay=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),!this.isRun){this.yinJiItems[this.yinJiIndex].selected=!1;var n=(this.yinJiIndex+6+i)%6-this.yinJiIndex;this.yinJiIndex=(this.yinJiIndex+6+n)%6,this.yinJiItems[this.yinJiIndex].selected=!0,this.updateYinJi(),this.targetA=this.currentA+t*this.gapA*(0==e?1:-1),this.dir=e,this.isRun=!0}},e.prototype.updateTick=function(){this.isRun&&(1==this.dir?(this.currentA-=4,this.currentA<=this.targetA&&(this.currentA=this.targetA,this.isRun=!1)):(this.currentA+=4,this.currentA>=this.targetA&&(this.currentA=this.targetA,this.isRun=!1)),this.updateYinJiPos())},e.prototype.updateYinJiPos=function(){for(var t=this.yinJiItems,e=t.length,i=(360+this.currentA%360)%360,n=0;e>n;n++){var a=(i+360*n/e)%360,o=MathUtil.getRadian(a);t[n].x=210*Math.cos(o),t[n].y=90*Math.sin(o)+50,o>Math.PI?this.groupMc.addChildAt(t[n],0):o<Math.PI&&this.groupMc.addChild(t[n]);var s=Math.floor(a/this.gapA),r=(this.gapRad-(this.rads[s]-o))/this.gapRad;0==s?t[n].scaleX=t[n].scaleY=.1*r+.9:1==s?t[n].scaleX=t[n].scaleY=1:2==s?t[n].scaleX=t[n].scaleY=.1-.1*r+.9:3==s?t[n].scaleX=t[n].scaleY=.1-.1*r+.8:4==s?t[n].scaleX=t[n].scaleY=.8:5==s&&(t[n].scaleX=t[n].scaleY=.1*r+.8)}},e.getTitle=function(){return"btz_zycs_sl"},e.getTabTitle=function(){return Lang.btn_yj},e.getSysId=function(){return SysId.ShengLing},e}(BasePanel);__reflect(ShengLingYinJiPanel.prototype,"ShengLingYinJiPanel"),window.ShengLingYinJiPanel=ShengLingYinJiPanel;var FenjieWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="TaoZhuangFenJieWinEUI",e.itemList.itemRenderer=FenjieWinItem,e.listArray=new eui.ArrayCollection,e.itemList.dataProvider=e.listArray,e.gainList.itemRenderer=GainGoodsItem,e.itemList.useVirtualLayout=!0,e.imgTitle.source="taozhuang_zycs_fenjiecailiao1",e.imgTitle1.source="taozhuang_zycs_fenjiecailiao",e.imgTitle2.source="taozhuang_zycs_huoqucailiao",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(BagSys.ins().patchItemChange,this.updateData),this.addItemTapE(this.gainList,this.onTouchList),this.addClickE(this.itemList,this.onListItemTap),this.updateData(),this.updategain()},e.prototype.updateData=function(){var t=ForgeSys.ins().getEnchantSplitItem();this.listArray.replaceAll(t)},e.prototype.updategain=function(){var t=Cfg.getItemCfg(Cfg.getConfig(EnumConfig).Item_Fenjie),e=GFunc.getGainItemWayConfig(t.id);this.gainList.dataProvider=new eui.ArrayCollection(e)},e.prototype.onListItemTap=function(t){if("btnOk"==t.target.name){var e=t.target.parent.data;ForgeSys.ins().sendEnchantSplit(e.id,e.count)}},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=e.controlTarget;GFunc.createTaskNavData(i)["goto"](),closeWin(this)}},e}(BaseWinSingle);__reflect(FenjieWin.prototype,"FenjieWin"),window.FenjieWin=FenjieWin;var FenjieWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TaoZhuangFenJieItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getItemCfg(t.id),i=Cfg.getConfig(EnchantChangeConfig,t.id),n=i.items[0];this.itemIcon.data=t,this.lbName.text=e.getName(),this.lbName.textColor=GConst.PZColor[e.quality];var a=n.count*t.count,o=Cfg.getItemCfg(n.id),s=o.name;this.lbDesc.textFlow=addColorTF(Lang.fumo_str2+addColor(s+" X"+a,GConst.PZColor[o.quality]))},e}(BaseItemRender);__reflect(FenjieWinItem.prototype,"FenjieWinItem"),window.FenjieWinItem=FenjieWinItem;var FumoEquipItem=function(t){function e(){var e=t.call(this)||this;return e.job=1,e.setSkinName(),e.clear(),e.imgStarts=[e.imgStart1,e.imgStart2,e.imgStart3],e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="FumoEquipItemEUI"},e.prototype.setRedPoint=function(t){this.redPoint.visible=t},e.prototype.dataChanged=function(){this.clear();var t=this.data;if(t){this.updateIcon();var e=ForgeSys.ins().shenPanTaoZhuangData.getPosData(t.pos);this.setlv(e.leve),this.setStatus(e.leve)}},e.prototype.setlv=function(t,e){if(void 0===e&&(e="+"),t>=1){var i=Math.ceil(t/4);i=0==i?1:i,this.bitlbLevel.text=i+"r"}this.updateIcon(),this.showStart(t),this.setStatus(t)},e.prototype.updateIcon=function(){var t=this.data;this.job=Actor.ins().job;BagSys.ins().getEquipByIndex(t.pos);this.imgLock.visible=!1;var e=Actor.ins().job,i=ForgeSys.ins().shenPanTaoZhuangData.getPosData(t.pos);this.imgIcon.source=ResMgr.getItemIcon(i.getConfig().id[e-1]),this.imgEquipBg.source="role_zycs_"+t.pos},e.prototype.setStatus=function(t){this.currentState=0==t?"unact":"act"},e.prototype.showStart=function(t){this.imgStart1.visible=!1,this.imgStart2.visible=!1,this.imgStart3.visible=!1;var e=t%4;2==e?this.imgStart1.visible=!0:3==e?(this.imgStart1.visible=!0,this.imgStart2.visible=!0):(4==e||0==e&&t>=2)&&(this.imgStart1.visible=!0,this.imgStart2.visible=!0,this.imgStart3.visible=!0)},e.prototype.clear=function(){this.imgIcon.source=null},e.prototype.setSelectBG=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(FumoEquipItem.prototype,"FumoEquipItem"),window.FumoEquipItem=FumoEquipItem;var FumoItem=function(t){function e(){var e=t.call(this)||this;return e.imgNameStrs=["","fm_zycs_gj01","fm_zycs_fy01","fm_zycs_sm01","fm_zycs_zy01","fm_zycs_zm01","fm_zycs_ts01","fm_zycs_ss01","fm_zycs_js01","fm_zycs_zs01"],e.imgIconStrs=["","fm_zycs_gj","fm_zycs_fy","fm_zycs_sm","fm_zycs_zy","fm_zycs_zm","fm_zycs_ts","fm_zycs_ss","fm_zycs_js","fm_zycs_zs"],e.setSkinName(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="FumoItemEUI",this.setSkinPart("itemIcon",new ItemIcon)},e.prototype.dataChanged=function(){var t=this.data,e=t.getConfig(),i=t.lv;this.imgName.source=this.imgNameStrs[e.type],t.isAct()?this.imgIcon.source=this.imgIconStrs[e.type]:this.imgIcon.source="fm_zycs_hui",this.setlv(i),this.updateState(i),this.validateNow(),this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this.data,e=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,ShenPanTaoZhuangMainPanel,FumoPanel,t.pos,t.point);this.setRedPoint(e)},e.prototype.setRedPoint=function(t){this.redPoint.visible=t},e.prototype.setlv=function(t,e){void 0===e&&(e="+"),0==t?this.lbLv.text="":this.lbLv.text="Lv."+t,this.updateState(t)},e.prototype.updateState=function(t){0==t?this.currentState="unAct":this.currentState="act"},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(FumoItem.prototype,"FumoItem"),window.FumoItem=FumoItem;var FumoPanel=function(t){function e(){var e=t.call(this)||this;return e.itemFumos=[],e.longPressBtnOk=new LongPress,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="FumoPanelEUI",this.item.touchChildren=!1,this.item.touchEnabled=!1,this.equipItems=[this.item0,this.item1,this.item2,this.item3,this.item4,this.item5,this.item6,this.item7,this.item8,this.item9],this.itemFumos=[this.itemFumo1,this.itemFumo2,this.itemFumo3,this.itemFumo4],this.listConsume.itemRenderer=ItemBaseConsume,this.listConsume.dataProvider=this.listConsumedData=new eui.ArrayCollection,this.lbSuiPian.textFlow=addColorTF(this.lbSuiPian.text,this.lbSuiPian.textColor,!0),this.item.setRedPoint(!1)},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this.groupItems,this.onItemClick),this.addClickE(this.groupGem,this.onGemItemClick),this.addClickE(this.btnOk,this.onClick),this.addClickE(this.lbSuiPian,this.onClick),this.addLsn(ForgeSys.ins().patchFumoUpdate,this.onUpdateData),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeItem),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnOk.setDisplay(this.btnOk,this.autoUp,this,500,200),this.updatePanel(),this.updateRp()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnOk.close()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e)){for(var i=ForgeSys.ins().fumoData,n=0;n<this.equipItems.length;n++){var a=i.getPosDataByIndex(n),o=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,ShenPanTaoZhuangMainPanel,e,a.pos);this.equipItems[n].setRedPoint(o)}this.itemFumo1.updateRedPoint(),this.itemFumo2.updateRedPoint(),this.itemFumo3.updateRedPoint(),this.itemFumo4.updateRedPoint(),this.redPointSplit.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,ShenPanTaoZhuangMainPanel,e,FenjieWin)}},e.prototype.updateConsumeItem=function(t){(t.cfg.type==ItemType.fumosuipian||t.cfg.type==ItemType.fumojuanzhou)&&this.updataConsume(this.curPointData)},e.prototype.updatePanel=function(){for(var t=ForgeSys.ins().fumoData,e=0;e<this.equipItems.length;e++){var i=t.getPosDataByIndex(e);this.equipItems[e].data=i}var n=t.getPosDataByPos(EquipPos.WEAPON);this.selectEquipItem(this.equipItems[n.pos]),this.updateGemItem(),this.updatePower()},e.prototype.onUpdateData=function(t,e,i,n){this.updateGemItem(i),this.selectGemItem(this.curPointData),this.updatePower();var a=this.itemFumos[i-1];1==n?GFunc.playUIMovie("fumojs",a.x+78,a.y+45,this.groupGem):t&&GFunc.playUIMovie("fumoxg",a.x+78,a.y+48,this.groupGem);var o="";o=1==n?"fumojh":t?"fumocg":"fumosb";var s=new MC;s.x=350,s.y=170,s.playFile(getEffName(o),1),this.addChild(s)},e.prototype.updateGemItem=function(t){void 0===t&&(t=0);var e=this.getEquipData().pos,i=ForgeSys.ins().fumoData.getPosDataByPos(e);(0==t||1==t)&&(this.itemFumo1.data=i.getDataByPoint(1)),(0==t||2==t)&&(this.itemFumo2.data=i.getDataByPoint(2)),(0==t||3==t)&&(this.itemFumo3.data=i.getDataByPoint(3)),(0==t||4==t)&&(this.itemFumo4.data=i.getDataByPoint(4))},e.prototype.updataConsume=function(t){var e=t.getConfig();this.listConsumedData.source=e.items},e.prototype.updataStatus=function(t){var e=t.getConfig();if(this.lbDesc.text="",t.getSuitLv()<e.suitLv?this.currentState="not":t.isMax()?this.currentState="max":t.isAct()?this.currentState="atc":this.currentState="unAtc",t.getSuitLv()<e.suitLv){var i=Math.ceil(e.suitLv/4);
i=0==i?1:i,this.lbDesc.text=Lang.fumo_str1.replace("$jie$",""+i)}},e.prototype.updataData=function(t){var e=Cfg.getConfig(EnchantAttrConfig,t.pos,t.point,0==t.lv?1:t.lv),i=AttrData.getFm(14931902,16777215," ",":");if(this.lbAttr.textFlow=addColorTF(AttrData.parse(e.attr,{fm:i}).join("\n")),!t.isMax()){var n=Cfg.getConfig(EnchantAttrConfig,t.pos,t.point,t.lv+1);this.lbAttrNext.textFlow=addColorTF(AttrData.parse(n.attr,{fm:"+%v"}).join("\n"))}},e.prototype.onGemItemClick=function(t){var e=t.target;if(e&&e.parent&&e.parent instanceof FumoItem){var i=e.parent,n=i.data;i.setSelect(!0),this.selectGemItem(n)}},e.prototype.selectGemItem=function(t){for(var e=0;4>e;e++)this.itemFumos[e].setSelect(e+1==t.point);var i=t.getConfig();this.bitRate.text=(i.rate/100).toFixed(0)+"%",this.curPointData=t,this.updataData(t),this.updataConsume(t),this.updataStatus(t)},e.prototype.onItemClick=function(t){var e=t.target;if(e&&e.parent&&e.parent instanceof FumoEquipItem){var i=e.parent;this.selectEquipItem(i)}},e.prototype.selectEquipItem=function(t){for(var e=0;e<this.equipItems.length;e++){var i=this.equipItems[e];i.setSelectBG(i==t)}var n=t.data;this.item.data=n,this.lbname.text=n.getName();for(var a=n.fumoPointDatas[0],e=0;e<this.getEquipData().fumoPointDatas.length;e++){var o=n.fumoPointDatas[e];if(o.isUp()){a=o;break}}this.selectGemItem(a),this.updateGemItem()},e.prototype.updatePower=function(){this.bitPower.text=this.getPower().toFixed(0)},e.prototype.getPower=function(){for(var t=0,e=ForgeSys.ins().fumoData,i=0;i<this.equipItems.length;i++){var n=e.getPosDataByIndex(i);t+=n.power}return t},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOk:this.autoUp();break;case this.lbSuiPian:openWin(FenjieWin)}},e.prototype.autoUp=function(){var t=this.curPointData.getConfig();if(this.btnOk.visible&&GFunc.checkConsumeEnough(t.items)){var e=new MC;e.x=350,e.y=200,e.playFile(getEffName("qhby"),1),this.addChild(e),ForgeSys.ins().sendEnchantUp(this.curPointData.pos,this.curPointData.point)}else this.longPressBtnOk.stop()},e.getTitle=function(){return"btz_zycs_sptz"},e.getTabTitle=function(){return Lang.fumo_str3},e.prototype.getEquipData=function(){return this.item.data},e.getSysId=function(){return SysId.ShenPan},e}(BasePanel);__reflect(FumoPanel.prototype,"FumoPanel"),window.FumoPanel=FumoPanel;var FumoEquipData=function(){function t(){this.fumoPosDatas=[],this.init()}return t.prototype.init=function(){var t=EquipPos.MAX;this.fumoPosDatas.length=0;for(var e=0;t>e;e++){var i=new FumoPosData;i.pos=e;var n=4;i.fumoPointDatas.length=0;for(var a=0;n>a;a++){var o=new FumoPointData;o.pos=i.pos,o.point=a+1,o.lv=0,i.fumoPointDatas.push(o)}this.fumoPosDatas.push(i)}},t.prototype.parser=function(t){for(var e=t.readByte(),i=0;e>i;i++)for(var n=t.readByte(),a=this.getPosDataByPos(n),o=t.readByte(),s=0;o>s;s++){var r=t.readByte(),u=a.getDataByPoint(r);u.lv=t.readShort()}},t.prototype.getPosDataByPos=function(t){for(var e=0;e<this.fumoPosDatas.length;e++)if(this.fumoPosDatas[e].pos==t)return this.fumoPosDatas[e];return this.fumoPosDatas[0]},t.prototype.getPosDataByIndex=function(t){return this.fumoPosDatas[t]},t}();__reflect(FumoEquipData.prototype,"FumoEquipData"),window.FumoEquipData=FumoEquipData;var FumoPointData=function(){function t(){this.pos=0,this.point=0,this.lv=1,this.maxLv=0}return t.prototype.isMax=function(){return this.maxLv<=0&&(this.maxLv=Cfg.getMaxConfig(EnchantAttrConfig,this.pos,this.point).level),this.lv>=this.maxLv},t.prototype.isUp=function(){return!this.isMax()&&GFunc.isConsumeEnough(this.getConfig().items)&&this.getSuitLv()>=this.getConfig().suitLv},t.prototype.getSuitLv=function(){return ForgeSys.ins().shenPanTaoZhuangData.getPosData(this.pos).leve},t.prototype.getConfig=function(){return this.config&&this.config.level==this.lv||(this.config=Cfg.getConfig(EnchantAttrConfig,this.pos,this.point,this.lv)),this.config},t.prototype.isAct=function(){return this.lv>0},t}();__reflect(FumoPointData.prototype,"FumoPointData"),window.FumoPointData=FumoPointData;var FumoPosData=function(){function t(){this.pos=0,this.fumoPointDatas=[]}return t.prototype.setLv=function(t,e){for(var i=0;i<this.fumoPointDatas.length;i++)this.fumoPointDatas[i].point==t&&(this.fumoPointDatas[i].lv=e)},t.prototype.getLv=function(t){for(var e=0;e<this.fumoPointDatas.length;e++)if(this.fumoPointDatas[e].point==t)return this.fumoPointDatas[e].lv;return 0},t.prototype.getDataByPoint=function(t){for(var e=0;e<this.fumoPointDatas.length;e++)if(this.fumoPointDatas[e].point==t)return this.fumoPointDatas[e];return new FumoPointData},t.prototype.getDataByIndex=function(t){return this.fumoPointDatas[t]},t.prototype.isUp=function(){for(var t=0;t<this.fumoPointDatas.length;t++)if(this.fumoPointDatas[t].isUp())return!0;return!1},Object.defineProperty(t.prototype,"power",{get:function(){for(var t=0,e=0;e<this.fumoPointDatas.length;e++)this.fumoPointDatas[e].isAct()&&(t+=GFunc.getPower(this.fumoPointDatas[e].getConfig().attr));return t},enumerable:!0,configurable:!0}),t.prototype.getName=function(){var t=ForgeSys.ins().shenPanTaoZhuangData.getPosData(this.pos).getConfig().name[Actor.ins().job-1];return t},t}();__reflect(FumoPosData.prototype,"FumoPosData"),window.FumoPosData=FumoPosData;var ShenPanTaoZhuangItem=function(t){function e(){var e=t.call(this)||this;return e.job=1,e.setSkinName(),e.imgStarts=[e.imgStart1,e.imgStart2,e.imgStart3],e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShenPanTaoZhuangItemEUI"},e.prototype.setRedPoint=function(t){this.redPoint.visible=t},e.prototype.dataChanged=function(){var t=this.data;t&&(this.updateIcon(),this.setlv(t.leve))},e.prototype.setlv=function(t,e){void 0===e&&(e="+");var i=this.data;this.bitlbLevel.text=i.rank+"r",this.showStart(t),this.setStatus(t),this.updateRedPoint()},e.prototype.updateIcon=function(){var t=this.data,e=Actor.ins().job;this.imgLock.visible=!1,this.imgIcon.source=ResMgr.getItemIcon(t.getConfig().id[e-1]),this.imgEquipBg.source="role_zycs_"+t.pos},e.prototype.updateRedPoint=function(){var t=this.data;t&&this.setRedPoint(RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,ShenPanTaoZhuangMainPanel,ShenPanTaoZhuangPanel,t.pos))},e.prototype.setStatus=function(t){this.currentState=0==t?"unact":"act"},e.prototype.showStart=function(t){for(var e=t>0?(t-1)%4:0,i=0;3>i;i++)this.imgStarts[i].visible=e>=i+1},e.prototype.setSelectBG=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(ShenPanTaoZhuangItem.prototype,"ShenPanTaoZhuangItem"),window.ShenPanTaoZhuangItem=ShenPanTaoZhuangItem;var ShenPanTaoZhuangMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,ShengLingWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShenPanTaoZhuangPanel,FumoPanel]},enumerable:!0,configurable:!0}),e.prototype.setSkinName=function(){this.skinName="SkillMainPanelEUI",this.tab.y=960},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.getTitle=function(){return"btz_zycs_sptz"},e.getTabTitle=function(){return"bqz_zycs_sptz"},e.getSysId=function(){return SysId.ShenPan},e}(BaseTabPanel);__reflect(ShenPanTaoZhuangMainPanel.prototype,"ShenPanTaoZhuangMainPanel"),window.ShenPanTaoZhuangMainPanel=ShenPanTaoZhuangMainPanel;var ShenPanTaoZhuangPanel=function(t){function e(){var e=t.call(this)||this;return e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ShenPanTaoZhuangPanelEUI",this.lbattr.lineSpacing=5,this.lbNextAttr.lineSpacing=5,this.shenPanTaoZhuangItem.touchChildren=!1,this.shenPanTaoZhuangItem.touchEnabled=!1,this.shenPanTaoZhuangItems=[this.shenPanTaoZhuangItem0,this.shenPanTaoZhuangItem7,this.shenPanTaoZhuangItem1,this.shenPanTaoZhuangItem2,this.shenPanTaoZhuangItem4,this.shenPanTaoZhuangItem8,this.shenPanTaoZhuangItem9,this.shenPanTaoZhuangItem5,this.shenPanTaoZhuangItem3,this.shenPanTaoZhuangItem6],this.curshenPanTaoZhuangItem=this.shenPanTaoZhuangItem1,this.listConsume.itemRenderer=ItemBaseConsume,this.listConsume.dataProvider=this.listConsumedData=new eui.ArrayCollection},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnOk,this.onclick),this.addClickE(this.groupItems,this.onItemClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(ForgeSys.ins().patchShenPanTaoZhuangUp,this.updataDataUp),this.addLsn(BagSys.ins().patchItemChange,this.updateCurrency),this.addLsn(BagSys.ins().patchEquipChange,this.setAllEquipData),this.iniData(),this.updateRp(),this.updatePower()},e.prototype.iniData=function(){var t=this.getDefaultIndex();this.equipData=ForgeSys.ins().shenPanTaoZhuangData.getSuitposData(t),this.equipData&&(this.curshenPanTaoZhuangItem.setSelectBG(!1),this.shenPanTaoZhuangItems[t].setSelectBG(!0),this.curshenPanTaoZhuangItem=this.shenPanTaoZhuangItems[t],this.shenPanTaoZhuangItem.data=this.equipData,this.setAllEquipData(),this.setEquipData(),this.setSelect(this.curshenPanTaoZhuangItem))},e.prototype.getDefaultIndex=function(){for(var t=ForgeSys.ins().shenPanTaoZhuangData.datas,e=0,i=Number.MAX_VALUE,n=0;n<t.length;n++){var a=GConst.fosterSort[n],o=t[a];o&&i>o.leve&&(i=o.leve,e=a)}return e},e.prototype.updateCurrency=function(t){t.cfg.type==ItemType.ShenPanTaoZhuanItemType&&(this.setEquipData(),this.setAllEquipData())},e.prototype.onItemClick=function(t){var e=t.target;if(e&&e.parent&&e.parent instanceof ShenPanTaoZhuangItem){var i=e.parent;i.data;this.setSelect(i)}},e.prototype.setSelect=function(t){var e=t.data;this.curshenPanTaoZhuangItem.setSelectBG(!1),this.curshenPanTaoZhuangItem=t,t.setSelectBG(!0),this.equipData=e,this.shenPanTaoZhuangItem.data=e,this.selectEquipData(),this.setEquipData()},e.prototype.updataDataUp=function(){this.setAllEquipData(),this.selectEquipData(),this.setEquipData(),this.updatePower();var t=MC.create(getEffName("qhby"));t.x=350,t.y=170,this.addChild(t);for(var e=0;e<this.shenPanTaoZhuangItems.length;e++){var i=this.shenPanTaoZhuangItems[e],n=i.data;if(i&&n.pos==this.equipData.pos){i.updateIcon();break}}},e.prototype.selectEquipData=function(){this.shenPanTaoZhuangItem.data=this.equipData,this.shenPanTaoZhuangItem.setRedPoint(!1),this.lbname.text=this.equipData.getConfig().name[Actor.ins().job-1]},e.prototype.setAllEquipData=function(){for(var t=ForgeSys.ins().shenPanTaoZhuangData,e=0;e<t.datas.length;e++){var i=t.datas[e],n=this.shenPanTaoZhuangItems[e];n.data?n.setlv(i.leve):n.data=i}},e.prototype.onclick=function(t){switch(t.currentTarget){case this.btnOk:GFunc.checkConsumeEnough(this.equipData.getConfig().items)&&ForgeSys.ins().sendShenPanTaoZhuangUp(this.equipData.pos)}},e.prototype.setEquipData=function(){this.strengthenPreview(this.equipData)},e.prototype.strengthenPreview=function(t){var e;e=t.isAct()?t.getConfig():Cfg.getConfig(SuitAttrConfig,t.pos,1);var i=e.attr;this.lbstrengthenlv.text=Lang.common_str66+Math.round(GFunc.getPower(i));var n=AttrData.parse(i,{fm:"%k：%v"}).join("\n");this.equipData.isMax()||(this.strengthenPreviewNext(t),this.listConsumedData.source=t.getConfig().items),this.lbattr.textFlow=addColorTF(n),this.btnOk.redPoint.visible=RpFun.getSuitRedPoint(t),this.updateStatus()},e.prototype.updatePower=function(){this.bitPower.text=this.getPower()+""},e.prototype.updateStatus=function(){0==this.equipData.leve?this.currentState="noact":this.equipData.isMax()?this.currentState="max":this.currentState="act"},e.prototype.strengthenPreviewNext=function(t){var e=Cfg.getConfig(SuitAttrConfig,t.pos,t.leve+1),i=e.attr;this.lbstrengthenlvNext.text=Lang.common_str66+Math.round(GFunc.getPower(i));var n=AttrData.parse(i,{fm:"+%v"}).join("\n");this.lbNextAttr.textFlow=addColorTF(n)},e.prototype.getPower=function(){for(var t=0,e=this.shenPanTaoZhuangItems,i=0;i<e.length;i++){var n=e[i].data;n&&(t+=n.power)}return t>>0},e.getTitle=function(){return"btz_zycs_sptz"},e.getTabTitle=function(){return Lang.fumo_str4},e.getSysId=function(){return SysId.ShenPan},e}(BasePanel);__reflect(ShenPanTaoZhuangPanel.prototype,"ShenPanTaoZhuangPanel"),window.ShenPanTaoZhuangPanel=ShenPanTaoZhuangPanel;var ShenPanTaoZhuangData=function(){function t(){this.datas=[]}return t.prototype.getPosData=function(t){for(var e=0;e<this.datas.length;e++){var i=this.datas[e];if(i.pos==t)return i}return new ShenPanTaoZhuangPosData},t.prototype.parser=function(t){var e=t.readByte();this.datas.length=e;for(var i=this.datas,n=0;e>n;n++){var a=i[n]||(i[n]=new ShenPanTaoZhuangPosData);a.pos=t.readByte(),a.leve=t.readByte(),i[n]=a}},t.prototype.getSuitposData=function(t){return this.datas[t]?this.datas[t]:null},t}();__reflect(ShenPanTaoZhuangData.prototype,"ShenPanTaoZhuangData"),window.ShenPanTaoZhuangData=ShenPanTaoZhuangData;var ShenPanTaoZhuangPosData=function(){function t(){this.pos=1,this.leve=1}return t.prototype.getConfig=function(){return Cfg.getConfig(SuitAttrConfig,this.pos,0==this.leve?1:this.leve)},t.prototype.isAct=function(){return this.leve>0},t.prototype.isMax=function(){return this.leve>=Cfg.getMaxConfig(SuitAttrConfig,this.pos).level},Object.defineProperty(t.prototype,"power",{get:function(){return GFunc.getPower(Cfg.getConfig(SuitAttrConfig,this.pos,this.leve).attr)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rank",{get:function(){var t=0;if(this.leve>=1){var e=Math.ceil(this.leve/4);t=0==e?1:e}return t},enumerable:!0,configurable:!0}),t}();__reflect(ShenPanTaoZhuangPosData.prototype,"ShenPanTaoZhuangPosData"),window.ShenPanTaoZhuangPosData=ShenPanTaoZhuangPosData;var ShenYouHuanHuaActTipsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="ShenYouHuanHuaActTipsWinEUI",e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.updatePanel(e),this.addClickE(this,this.onTap)},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.onTap=function(t){closeWin(this)},e.prototype.updatePanel=function(t){this.lb_name.text=t.getBaseConfig().name,this.totalPower.text=""+t.getHuanHuaPower(),this.mc=this.mc||new MC,this.groupEntity.addChild(this.mc);var e=Cfg.getConfig(ShenYouHuanhuaConfig,t.id),i=Cfg.getConfig(ShenYouHuDunAppearanceConfig,e.bodyId);this.mc.playFile(ResMgr.getHuDunUISource(i.appearance),-1)},e}(BaseWinSingle);__reflect(ShenYouHuanHuaActTipsWin.prototype,"ShenYouHuanHuaActTipsWin"),window.ShenYouHuanHuaActTipsWin=ShenYouHuanHuaActTipsWin;var ShenYouPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,ZhuangBanWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShenYouLevelPanel,ShenYouSkillPanel,ShenYouHuanHuaPanel,ShenYouYinJiPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="ShenQiPanelEUI"},e.getTitle=function(){return"btz_zycs_shenyou"},e.getTabTitle=function(){return"bqz_zycs_sy"},e.getSysId=function(){return SysId.ShenYou},e}(BaseTabPanel);__reflect(ShenYouPanel.prototype,"ShenYouPanel"),window.ShenYouPanel=ShenYouPanel;var ShenYouData=function(){function t(){this.level=0,this.huanHuaDatas=[],this.skillDatas=[],this.yinjiLevel=0,this.yinjiExp=0,this.huanHuaId=0,this.skillCount=1}return t.prototype.parser=function(t){this.level=t.readShort(),this.skillCount=t.readByte(),this.huanHuaId=t.readByte();var e=t.readByte();this.huanHuaDatas.length=0;for(var i=0;e>i;i++){var n=new ShenYouHuanHuaData;n.parser(t),this.huanHuaDatas.push(n)}this.yinjiLevel=t.readShort(),this.yinjiExp=t.readInt();var a=t.readByte();this.skillDatas.length=0;for(var i=0;a>i;i++){var n=new ShenYouSkillData;n.parser(t),this.skillDatas.push(n)}},t.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t-1]},t.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.stage>0&&(t+=GFunc.getPower(i.getBaseConfig().baseAttrs)>>0)}return t},t.prototype.getHuanHuaDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrData(),t)}return t},t.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},t.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.level==this.level||(this.levelConfig=Cfg.getConfig(ShenYouLevelConfig,this.level)),this.levelConfig},t.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.level<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(ShenYouLevelConfig,this.level)),this.levelNextConfig},t.prototype.getNextSkill=function(){return Cfg.getConfig(ShenYouNengLiLevelConfig,CondType.More,ShenYouNengLiLevelConfig.lockRank,this.rank)},t.prototype.isMaxLv=function(){return this.level>=Cfg.getMaxConfig(ShenYouLevelConfig).level},Object.defineProperty(t.prototype,"star",{get:function(){return this.level<=10?this.level%11:this.level%10==0?10:this.level%10},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rank",{get:function(){return this.level<=10?1:Math.ceil(this.level/10)},enumerable:!0,configurable:!0}),t.prototype.getYinJiAttrDatas=function(){for(var t=[],e=this.getYinJiConfig(),i=this.getYinJiNextConfig(),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},t.prototype.getYinJiConfig=function(){return this.curShenYouTagConfig&&this.curShenYouTagConfig.level==this.yinjiLevel||(this.curShenYouTagConfig=Cfg.getConfig(ShenYouTagConfig,this.yinjiLevel)),this.curShenYouTagConfig},t.prototype.getYinJiNextConfig=function(){return(!this.nextShenYouTagConfig||this.nextShenYouTagConfig.level<=this.yinjiLevel)&&(this.nextShenYouTagConfig=Cfg.getNextConfig(ShenYouTagConfig,this.yinjiLevel)),this.nextShenYouTagConfig},t.prototype.yinjiMax=function(){return this.yinjiLevel>=Cfg.getMaxConfig(ShenYouTagConfig).level},t.prototype.getYinJiPower=function(){return GFunc.getPower(this.getYinJiConfig().attr)},t.prototype.actSkillCount=function(){for(var t=this.skillDatas,e=0,i=0;i<t.length;i++){var n=t[i];n.isAct()&&e++}return e},t.prototype.getSkillMaxCount=function(){return Cfg.getConfigLength(ShenYouSkillConfig)},t.prototype.getSkillByIndex=function(t){return this.skillDatas[t-1]},t}();__reflect(ShenYouData.prototype,"ShenYouData"),window.ShenYouData=ShenYouData;var ShenYouHuanHuaData=function(){function t(){this.id=1,this.stage=0}return t.prototype.parser=function(t){this.id=t.readByte(),this.stage=t.readShort()},t.prototype.parserEquip=function(t){},t.prototype.getBaseConfig=function(){return null==this.baseConfig&&(this.baseConfig=Cfg.getConfig(ShenYouHuanhuaConfig,this.id)),this.baseConfig},t.prototype.getAttrData=function(t){return void 0===t&&(t=this.stage),AttrData.attrMultiple(this.getBaseConfig().baseAttrs,t)},t.prototype.isUse=function(){return this.id==QiyuSys.ins().shenYouData.huanHuaId},t.prototype.isMax=function(){return this.stage>=this.getBaseConfig().maxLevel},t.prototype.isAct=function(){return this.stage>0},t.prototype.getHuanHuaPower=function(){var t=GFunc.getPower(this.getAttrData());return t},t.prototype.getHuanHuaAttrDatas=function(){for(var t=[],e=this.getAttrData(),i=AttrData.attrMultiple(this.getBaseConfig().baseAttrs,this.isMax()?this.stage:this.stage+1),n=e.length,a=0;n>a;a++){var o=e[a],s=i[a],r=new ComAttrData(o,s,this.isMax());t.push(r)}return t},t.prototype.getIcon=function(){return"shenyou_zycs_hh"+this.id},t}();__reflect(ShenYouHuanHuaData.prototype,"ShenYouHuanHuaData"),window.ShenYouHuanHuaData=ShenYouHuanHuaData;var ShenYouSkillData=function(){function t(){this.id=1,this.level=0}return t.prototype.parser=function(t){this.id=t.readByte(),this.level=t.readShort()},t.prototype.isAct=function(){return this.level>0},t.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},t.prototype.getConfig=function(){return null==this._config&&(this._config=Cfg.getConfig(ShenYouSkillConfig,this.id)),this._config},t.prototype.getPower=function(){var t=this.getConfig().power*this.level,e=AttrData.attrMultiple(this.getConfig().attr,this.level);return t+=GFunc.getPower(e)},t.prototype.getAttrs=function(){var t=AttrData.attrMultiple(this.getConfig().attr,this.level);return t},t}();__reflect(ShenYouSkillData.prototype,"ShenYouSkillData"),window.ShenYouSkillData=ShenYouSkillData;var ShenYouHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=0,e.huanHuaDatas=[],e.skinName="ShenYouHuanHuaPanelEUI",e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),5767068),e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.listIcon.itemRenderer=ShenYouHuanHuaPanelItem,e.listIcon.dataProvider=e.listIconData=new eui.ArrayCollection,e.pageArrowComponentBase=new PageArrowCom(e.scroller,135,105),e.pageArrowComponentBase.setBtn(e.btnLeft,e.btnRight),e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnGengHuan,this.onClick),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnAttr,this.onClick),this.addItemTapE(this.listIcon,this.onItemClick),this.addLsn(QiyuSys.ins().patchShenYouHuanHua,this.updatePanelUp),this.addLsn(QiyuSys.ins().patchShenYouHuanHuaUpLevel,this.updatePanelUp),this.addLsn(BagSys.ins().patchItemChange,this.updateConsume),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel(),this.pageArrowComponentBase.open()},e.prototype.close=function(){t.prototype.close.call(this),this.pageArrowComponentBase.close()},e.prototype.updateRp=function(t){if(!t||t.check(this))for(var e=0;e<this.listIcon.numChildren;e++){var i=this.listIcon.getChildAt(e);i&&i.dataChanged()}},e.prototype.infoPanel=function(){this.selectIndex=0,this.listIconData.source=this.huanHuaDatas=QiyuSys.ins().shenYouData.huanHuaDatas;for(var t=0;t<this.huanHuaDatas.length;t++)if(RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e,this.huanHuaDatas[t].id)){this.selectIndex=t;break}this.listIcon.selectedIndex=this.selectIndex,this.pageArrowComponentBase.setListIndex(this.selectIndex),this.updatePanel(),this.updateMC(),this.updateRp()},e.prototype.updatePanelUp=function(){this.listIconData.replaceAll(this.huanHuaDatas),this.updatePanel()},e.prototype.updatePanel=function(){var t=this.huanHuaDatas[this.selectIndex],i=t.getBaseConfig();this.power.text=""+t.getHuanHuaPower(),this.lb_name.text=i.name,this.bitHuDun.text=i.shieldPer/100+"%",this.bmpLv.text=""+t.stage,this.imgSyz.visible=t.isUse(),this.btnGengHuan.visible=t.stage>0&&!t.isUse(),this.attrData.source=t.getHuanHuaAttrDatas(),this.btnSend.label=t.stage>0?Lang.btn_sj:Lang.btn_jh,this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e,t.id);var n=this.listIcon.getChildAt(this.selectIndex);n&&n.dataChanged();var a=addColor(""+i.desc,16751375);a+=Lang.common_str117+addColor("+"+i.power,16751375),this.lbActDec.textFlow=addColorTF(t.isAct()?"":a),this.updateConsume(),this.updateMax()},e.prototype.updateMC=function(){var t=this.huanHuaDatas[this.selectIndex],e=t.getBaseConfig(),i=Cfg.getConfig(ShenYouHuDunAppearanceConfig,e.bodyId);this.mc.playFile(ResMgr.getHuDunUISource(i.appearance),-1)},e.prototype.updateConsume=function(t){if(void 0===t&&(t=null),null==t||t.cfg.type==ItemType.ShenYouUpLevel){var e=this.huanHuaDatas[this.selectIndex];this.listConsumeData.source=e.getBaseConfig().needitem}},e.prototype.updateMax=function(){this.huanHuaDatas[this.selectIndex].isMax()?(this.imgYml.visible=!0,this.listConsume.visible=!1,this.btnSend.visible=!1):(this.imgYml.visible=!1,this.listConsume.visible=!0,this.btnSend.visible=!0)},e.prototype.onItemClick=function(t){this.selectIndex=t.itemIndex,this.updatePanel(),this.updateMC()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=this.huanHuaDatas[this.selectIndex];GFunc.checkConsumeEnough(e.getBaseConfig().needitem)&&QiyuSys.ins().sendShenYouHuanHuaUpLevel(e.id);break;case this.btnGengHuan:QiyuSys.ins().sendShenYouHuanHua(this.huanHuaDatas[this.selectIndex].id);break;case this.btnAttr:openWin(ComAttrWin,QiyuSys.ins().shenYouData.getHuanHuaDatasAll(),ComAttrTitleEnum.HuanHua)}},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_hh},e.getSysId=function(){return SysId.ShenYou},e.openCheck=function(){if(GFunc.checkSysOpen(SysId.ShenYou)){var t=Cfg.getConfig(ShenYouBaseConfig).huanhuaOpen;return QiyuSys.ins().shenYouData.rank>=t?!0:(showtipsFail(Lang.sy_str5.replace("$rank$",""+t)),!1)}},e}(BasePanel);__reflect(ShenYouHuanHuaPanel.prototype,"ShenYouHuanHuaPanel"),window.ShenYouHuanHuaPanel=ShenYouHuanHuaPanel;var ShenYouHuanHuaPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShenYouHuanHuaPanelItemEUI",e.showRedPoint(!1),e.setSelect(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof ShenYouHuanHuaData)if(this.imgIcon.source=this.data.getIcon(),this.imgPz.source="zuji_zycs_pz"+Cfg.getConfig(ShenYouHuanhuaConfig,this.data.id).quality,this.imgAn.visible=!this.data.isAct(),this.data.isMax())this.showRedPoint(!1);else{var t=this.data.getBaseConfig().needitem;this.showRedPoint(GFunc.isConsumeEnough(t))}},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(ShenYouHuanHuaPanelItem.prototype,"ShenYouHuanHuaPanelItem"),window.ShenYouHuanHuaPanelItem=ShenYouHuanHuaPanelItem;var ShenYouLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.longPressBtnUp=new LongPress,e.skinName="ShenYouLevelPanelEUI",e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.listConsume.itemRenderer=ItemBaseConsume,e.listConsume.dataProvider=e.listConsumeData=new eui.ArrayCollection,e.starExp=new Star(StarData.F_5()),e.starExp.x=45,e.groupStar.addChild(e.starExp),e.starExp.setMaxStar(10),e.btnSendMC=new MC,e.btnSendMC.x=86,e.btnSendMC.y=35,e.btnSend.addChildAt(e.btnSendMC,e.btnSend.numChildren-1),e.helpBtn.visible=!1,e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(QiyuSys.ins().patchShenYouUplevel,this.updateUpStar),this.addLsn(BagSys.ins().patchItemChange,this.updateConsume),this.longPressBtnUp.setDisplay(this.btnSend,this.sengUpLevel,this),this.updatePanel(),this.updateMC(),this.updateRp()},e.prototype.close=function(){t.prototype.close.call(this),this.starExp.reset(),this.longPressBtnUp.close()},e.prototype.updateRp=function(t){if(null==t||t.check(this)){var i=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e);this.btnSend.redPoint.visible=i,i?this.btnSendMC.playFile(getEffName("button1"),-1):(this.btnSendMC.stop(),this.btnSendMC.visible=!1)}},e.prototype.updateUpStar=function(){this.updatePanel();var t=QiyuSys.ins().shenYouData;1==t.star&&GFunc.playUIMovie("sl_zycs_tp",this.groupLv.width/2,this.groupLv.height/2,this.groupLv,1)},e.prototype.updatePanel=function(){var t=QiyuSys.ins().shenYouData,e=Cfg.getConfig(ShenYouLevelConfig,t.level);this.attrData.source=t.getLevelAttrDatas(),this.attrs.validateNow(),this.attrs.width=this.attrs.contentWidth,this.bitRank.text=t.rank.toString(),this.starExp.setCurStar(t.star),this.power.text=GFunc.getPower(e.attr).toFixed(0),this.updateSkill(),this.updateConsume(),this.currentState=t.isMaxLv()?"max":"normal",this.btnSend.label=10==t.star?Lang.btn_jj:Lang.btn_sx},e.prototype.updateMC=function(){var t=QiyuSys.ins().shenYouData,e=Cfg.getConfig(ShenYouHuanhuaConfig,0==t.huanHuaId?0:t.huanHuaId),i=Cfg.getConfig(ShenYouHuDunAppearanceConfig,e.bodyId);this.mc.playFile(ResMgr.getHuDunUISource(i.appearance),-1)},e.prototype.updateSkill=function(){var t=QiyuSys.ins().shenYouData,e=t.getNextSkill();this.lbSkillName.text=e.name,this.lbSkillDesc.textFlow=StrUtil.toTF(e.desc);var i=t.rank>=e.lockRank;this.lbSkillRank.text=i?Lang.common_str28:""+e.lockRank+Lang.sy_str0+"("+t.rank+"/"+e.lockRank+")",this.lbSkillRank.textColor=i?5767068:15733780,this.imgSkillIcon.source="shenyou_zycs_sk"+e.id},e.prototype.updateConsume=function(t){if(void 0===t&&(t=null),null==t||t.cfg.type==ItemType.ShenYouUpLevel){var e=QiyuSys.ins().shenYouData,i=Cfg.getConfig(ShenYouLevelConfig,e.level);this.listConsumeData.source=i.cost}},e.prototype.onClick=function(t){switch(t.target){case this.btnSend:this.sengUpLevel();break;case this.btnNengLiView:openWin(ShenYouNengLiWin);break;case this.helpBtn:openWin(HelpWin,HelpInfoConfig,this.helpId)}},e.prototype.sengUpLevel=function(){var t=QiyuSys.ins().shenYouData,e=Cfg.getConfig(ShenYouLevelConfig,t.level);0==t.isMaxLv()&&GFunc.checkConsumeEnough(e.cost)?QiyuSys.ins().sendShenYouUplevel():this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.btn_sx},e.getSysId=function(){return SysId.ShenYou},e}(BasePanel);__reflect(ShenYouLevelPanel.prototype,"ShenYouLevelPanel"),window.ShenYouLevelPanel=ShenYouLevelPanel;var ShenYouNengLiWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.layer=LayerMgr.Popup,this.skinName="ShenYouNengLiWinEUI",this.addBg(),this.list.itemRenderer=ShenYouNengLiWinItem,t.prototype.initUI.call(this)},e.prototype.open=function(){t.prototype.open.call(this),this.updatePanel()},e.prototype.updatePanel=function(){this.lbAttr.textFlow=StringUtil.toTF(""+Lang.sy_str12+Actor.ins().getAtt(AttrType.atShenYouShieldMax)),this.list.dataProvider=new eui.ArrayCollection(Cfg.getConfigs(ShenYouNengLiLevelConfig))},e}(BaseWinSingle);__reflect(ShenYouNengLiWin.prototype,"ShenYouNengLiWin"),window.ShenYouNengLiWin=ShenYouNengLiWin;var ShenYouNengLiWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShenYouNengLiWinItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=QiyuSys.ins().shenYouData,e=this.data;this.lbSkillName.text=e.name,this.lbSkillDesc.textFlow=StrUtil.toTF(e.desc);var i=t.rank>=e.lockRank;this.lbSkillRank.text=i?"("+Lang.common_str28+")":"("+e.lockRank+Lang.sy_str0+")",this.lbSkillRank.textColor=i?5767068:15733780,this.imgSkillIcon.source="shenyou_zycs_sk"+e.id},e}(BaseItemRender);__reflect(ShenYouNengLiWinItem.prototype,"ShenYouNengLiWinItem"),window.ShenYouNengLiWinItem=ShenYouNengLiWinItem;var ShenYouNewNengLiOpenWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Top,e.winType=WinType.NeverCloseWin,e.mc=new MC,e.skinName="ShenYouNewNengLiOpenWinEUI",e.mc.playFile(getEffName("xgnkq"),-1),e.mc.x=212,e.mc.y=160,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t){this.addClickE(this.group,this.onTap),this.imgIcon.source="shenyou_zycs_nl"+t,this.imgName.source="shenyou_zycs_nn"+t},e.prototype.onTap=function(t){closeWin(this)},e}(BaseWinSingle);__reflect(ShenYouNewNengLiOpenWin.prototype,"ShenYouNewNengLiOpenWin"),window.ShenYouNewNengLiOpenWin=ShenYouNewNengLiOpenWin;var ShenYouSkillPanel=function(t){function e(){var e=t.call(this)||this;return e.items=[],e.skillDatas=[],e.curIndex=0,e.skinName="ShenYouSkillPanelEUI",e.items=[e.item0,e.item1,e.item2,e.item3,e.item4,e.item5,e.item6,e.item7],e.btnSendMC=new MC,e.btnSendMC.x=86,e.btnSendMC.y=35,e.btnSend.addChildAt(e.btnSendMC,e.btnSend.numChildren-1),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick),this.addClickE(this.groupItems,this.onItemClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(QiyuSys.ins().patchShenYouSkillUplevel,this.updateUpLevel),this.addLsn(QiyuSys.ins().patchShenYouSkillBuy,this.updateBuySkill),this.addLsn(BagSys.ins().patchItemChange,this.updateItem),this.iniPanel(),this.updatePanel(),this.updateRp()
},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updateRp=function(t){if(null==t||t.check(this))for(var i=this.items.length,n=0;i>n;n++){var a=this.items[n],o=a.data;if(a&&o){var s=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e,ShenYouSkillPanelItem,"skillUp",o.id);a.showRedPoint(s)}}},e.prototype.iniPanel=function(){var t=QiyuSys.ins().shenYouData;this.skillDatas=t.skillDatas;for(var e=this.skillDatas.length,i=0;e>i;i++){var n=this.items[i],a=this.skillDatas[i];n&&a&&(n.data=a)}var o=this.getNextLockSkill();this.lbLockDesc.textFlow=null==o||0==o.stage?addColorTF(""):addColorTF(Lang.sy_str13.replace("$stage$",""+o.stage).replace("$count$",""+o.skillSlot)),this.groupBuy.y=null==o||0==o.stage?554:543,this.updatePower(),this.curIndex=this.getAutoSkillIndex();var s=this.skillDatas[this.curIndex];this.updateSkillData(s)},e.prototype.getNextLockSkill=function(){for(var t,e=QiyuSys.ins().shenYouData,i=0,n=Cfg.getConfigs(ShenYouStageConfig),a=0;a<n.length;a++)if(n[a].stage>e.rank&&n[a].skillSlot>0){i=n[a].stage,t=n[a];break}return t},e.prototype.getAutoSkillIndex=function(){for(var t=-1,i=QiyuSys.ins().shenYouData,n=i.skillDatas,a=n.length,o=0;a>o;o++){var s=n[o],r=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e,ShenYouSkillPanelItem,"skillUp",s.id);if(r){t=o;break}}var u=i.actSkillCount();if(-1==t)for(var o=0;a>o;o++){var s=n[o],r=!1;if(r=u==i.skillCount&&u!=i.getSkillMaxCount()?0==s.isMax()&&s.isAct():0==s.isMax()){t=o;break}}return-1==t?0:t},e.prototype.updatePanel=function(){var t=QiyuSys.ins().shenYouData,e=t.actSkillCount(),i=t.skillCount>e?5767068:15733780;this.lbYiXue.textFlow=addColorTF(Lang.sy_str14+":"+addColor(e+"/"+t.skillCount,i));var n=Cfg.getConfig(ShenYouBaseConfig).buyPrice.length;this.btnSkillBuy.visible=t.skillCount>=Cfg.getConfig(ShenYouBaseConfig).buyMin&&t.skillCount<n,this.groupBuy.visible=e<t.getSkillMaxCount()},e.prototype.updateUpLevel=function(){this.items[this.curIndex].updateItem(),this.items[this.curIndex].playUpLeveMc(),this.updateSkillData(this.curSkillData),this.updatePower(),this.updatePanel()},e.prototype.updatePower=function(){for(var t=0,e=0,i=this.skillDatas;e<i.length;e++){var n=i[e];t+=n.getPower()}this.power.text=""+t.toFixed()},e.prototype.updateBuySkill=function(){for(var t=this.items.length,e=0;t>e;e++){var i=this.items[e];i.updateItem()}this.updatePanel()},e.prototype.updateSkillData=function(t){this.curSkillData=t;var i=t.getConfig();this.lbSkillName.text=i.skillname;var n=AttrData.getFm(null,5767068,"",":+"),a=t.getAttrs();this.lbCurAttr.textFlow=addColorTF(AttrData.parse(a,{fm:n}).join("\n")),this.lbDesc.textFlow=StrUtil.toTF(this.replaceAttr(i.desc,a));var o=t.isMax();if(o)this.lbNextAttr.text=Lang.common_str38;else{var s=AttrData.attrMultiple(t.getConfig().attr,t.level+1),r=AttrData.getFm(null,2686876,"",":+");this.lbNextAttr.textFlow=addColorTF(AttrData.parse(s,{fm:r}).join("\n"))}this.updateConsume();var u=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e,ShenYouSkillPanelItem,"skillUp",t.id);this.btnSend.redPoint.visible=u,u?this.btnSendMC.playFile(getEffName("button1"),-1):(this.btnSendMC.stop(),this.btnSendMC.visible=!1),this.items[this.curIndex].setSelect(!0),this.currentState=o?"max":"normal"},e.prototype.replaceAttr=function(t,e){for(var i=0;i<e.length;i++)t=t.replace("{"+e[i].type+"}",""+AttrData.getAttrValue(e[i]));return t},e.prototype.getAttrs=function(t){},e.prototype.updateConsume=function(){var t=this.curSkillData.getConfig();if(t.cost.id){var e=Cfg.getItemCfg(t.cost.id);this.imgConsumeIcon.source=ResMgr.getItemIconMin(e.getIcon());var i=BagSys.ins().getItemCount(t.cost.id);this.lbConsumeCount.text=i+"/1",this.lbConsumeCount.textColor=i>=1?5949490:15733780}},e.prototype.updateItem=function(t){void 0===t&&(t=null),(null==t||t.cfg.type==ItemType.ShenYouSkill)&&this.updateConsume()},e.prototype.onClick=function(t){var e=QiyuSys.ins().shenYouData;switch(t.target){case this.btnSend:if(0==this.curSkillData.isAct()&&e.skillCount==e.actSkillCount())showtipsFail(Lang.sy_str1);else{var i=this.curSkillData.getConfig();GFunc.checkConsumeEnough(i.cost)&&QiyuSys.ins().sendShenYouSkillUplevel(this.curSkillData.id)}break;case this.btnSkillBuy:var n=Cfg.getConfig(ShenYouBaseConfig).buyPrice[QiyuSys.ins().shenYouData.skillCount],a=new PopupPriceData(Lang.sy_str2);a.priceValue=n,a.priceType=CurType.yb,a.setFunction(this,function(){GFunc.checkCurrency(CurType.yb,n)&&QiyuSys.ins().sendShenYouSkillBuy()}),openWin(CommonTipsWinNew,a)}},e.prototype.onItemClick=function(t){var e=t.target;if(e&&e.parent&&e.parent instanceof ShenYouSkillPanelItem){var i=e.parent,n=i.data;QiyuSys.ins().shenYouData;this.items[this.curIndex].setSelect(!1),this.curIndex=this.items.indexOf(i),this.updateSkillData(n)}},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.sy_str3},e.getSysId=function(){return SysId.ShenYou},e.openCheck=function(){if(GFunc.checkSysOpen(SysId.ShenYou)){var t=Cfg.getConfig(ShenYouBaseConfig).skillOpen;return QiyuSys.ins().shenYouData.rank>=t?!0:(showtipsFail(Lang.sy_str11.replace("$rank$",""+t)),!1)}},e}(BasePanel);__reflect(ShenYouSkillPanel.prototype,"ShenYouSkillPanel"),window.ShenYouSkillPanel=ShenYouSkillPanel;var ShenYouSkillPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShenYouSkillPanelItemEUI",e.showRedPoint(!1),e.imgSelect.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.updateItem(),this.imgSelect.visible=!1},e.prototype.updateItem=function(){var t=this.data,e=t.getConfig();this.lbName.text=e.skillname,this.lbName.textColor=GConst.PZColor[e.quality];var i=t.isMax()?Lang.common_man:""+t.level;this.lbLevel.text=t.isAct()?i:"0",this.imgIcon.source="shenyou_zycs_jn"+t.id+(t.isAct()?"":"a")},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e.prototype.playUpLeveMc=function(){GFunc.playMapMovie("bsxq",65,65,this,1)},e}(BaseItemRender);__reflect(ShenYouSkillPanelItem.prototype,"ShenYouSkillPanelItem"),window.ShenYouSkillPanelItem=ShenYouSkillPanelItem;var ShenYouYinJiPanel=function(t){function e(){var e=t.call(this)||this;return e.skillDatas=[],e.skinName="ShenYouYinJiPanelEUI",e.setSkinPart("item",new ShenYouYinJiPanelItem),e.list.itemRenderer=SkillPassivityItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.attrs.itemRenderer=ComAttrItem,e.attrs.dataProvider=e.attrData=new eui.ArrayCollection,e.btnHeCheng.textFlow=addColorTF(StrUtil.addUnderLine(e.btnHeCheng.text)),e.btnSendMC=new MC,e.btnSendMC.x=86,e.btnSendMC.y=35,e.btnSend.addChildAt(e.btnSendMC,e.btnSend.numChildren-1),e.mc=new MC,e.groupMc.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnHeCheng,this.onClick),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.item,this.onClick),this.addItemTapE(this.list,this.onSkillItem),this.addLsn(BagSys.ins().patchItemChange,this.updateConsume),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill),this.addLsn(RpFun.showShenYouYinJiSkillRedPoint,this.updateSkill),this.addLsn(QiyuSys.ins().patchShenYouYinJiUpLevel,this.updateUpLevel),this.iniPanel(),this.updateRp()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updateRp=function(t){if(!t||t.check(this)){var i=RpSys.ins().getData(RoleWin,RolePanel,ZhuangBanWin,ShenYouPanel,e,"uplevel");this.btnSend.redPoint.visible=i,i?this.btnSendMC.playFile(getEffName("button1"),-1):(this.btnSendMC.stop(),this.btnSendMC.visible=!1),this.updateSkill()}},e.prototype.updateUpLevel=function(){this.updateAttr(),this.updateExp(),this.updatePower(),this.updateConsume()},e.prototype.iniPanel=function(){this.updateAttr(),this.updateExp(),this.updateConsume(),this.updatePower(),this.updateSkill(),this.updateMC();QiyuSys.ins().shenYouData;this.item.data=Cfg.getConfig(ShenYouBaseConfig).yinjiskill},e.prototype.updateMC=function(){var t=QiyuSys.ins().shenYouData,e=Cfg.getConfig(ShenYouHuanhuaConfig,0==t.huanHuaId?1:t.huanHuaId),i=Cfg.getConfig(ShenYouHuDunAppearanceConfig,e.bodyId);this.mc.playFile(ResMgr.getHuDunUISource(i.appearance),-1)},e.prototype.updateConsume=function(t){if(!t||t.cfg.type==ItemType.ShenYouYinJi){var e=QiyuSys.ins().shenYouData,i=Cfg.getConfig(ShenYouTagExpConfig,CondType.LessEqual,ShenYouTagExpConfig.minLv,e.yinjiLevel),n=Cfg.getItemCfg(i.itemid);this.imgConsu.source=ResMgr.getItemIconMin(n.getIcon());var a=BagSys.ins().getItemCount(i.itemid);this.lbConsu.text=a+"/1",this.lbConsu.textColor=a>=1?5949490:15733780}},e.prototype.updateSkill=function(){this.skillDatas=SkillSys.ins().getSkillPassivityDatasByIds(Cfg.getConfig(ShenYouBaseConfig).yinjiskills),this.listData.source=this.skillDatas,this.updatePower()},e.prototype.updatePower=function(){for(var t=0,e=0,i=this.skillDatas;e<i.length;e++){var n=i[e];t+=n.getPower()}this.power.text=""+(QiyuSys.ins().shenYouData.getYinJiPower()+t).toFixed()},e.prototype.updateAttr=function(){var t=QiyuSys.ins().shenYouData;this.attrData.source=t.getYinJiAttrDatas(),this.bmpLv.text="l"+t.yinjiLevel,this.currentState=t.yinjiMax()?"max":"normal"},e.prototype.updateExp=function(){var t=QiyuSys.ins().shenYouData;t.yinjiMax()?(this.barExp.value=1,this.barExp.maximum=1):(this.barExp.value=t.yinjiExp,this.barExp.maximum=t.getYinJiConfig().exp)},e.prototype.onSkillItem=function(t){var e=t.item;openWin(ShenYouYinJiSkillShowWin2,e,t.itemIndex)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=QiyuSys.ins().shenYouData,i=Cfg.getConfig(ShenYouTagExpConfig,CondType.LessEqual,ShenYouTagExpConfig.minLv,e.yinjiLevel),n=new ItemDataReward;n.id=i.itemid,n.count=1,GFunc.checkConsumeEnough(n)&&QiyuSys.ins().sendShenYouYinJiUpLevel();break;case this.btnHeCheng:openWin(BagWin,BagWin.getTabIndexbyPanel(HeChengMainPanel),HeChengMainPanel.getTabIndexbyPanel(HeChengPanel));break;case this.item:var a=this.item.data;openWin(ShenYouYinJiSkillShowWin,a)}},e.getTitle=function(){return"btz_zycs_rw"},e.getTabTitle=function(){return Lang.sy_str4},e.getSysId=function(){return SysId.ShenYou},e.openCheck=function(){if(GFunc.checkSysOpen(SysId.ShenYou)){var t=Cfg.getConfig(ShenYouBaseConfig).yinjiOpen;return QiyuSys.ins().shenYouData.rank>=t?!0:(showtipsFail(Lang.sy_str5.replace("$rank$",t.toString())),!1)}},e}(BasePanel);__reflect(ShenYouYinJiPanel.prototype,"ShenYouYinJiPanel"),window.ShenYouYinJiPanel=ShenYouYinJiPanel;var ShenYouYinJiPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShenYouYinJiPanelItemEUI",e.touchChildren=!1,e.redPoint.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getConfig(SkillsConfig,t);this.imgIcon.source=ResMgr.getSkillResourceItemName(e.icon,!0,!1),this.lbName.text=e.name},e}(BaseItemRender);__reflect(ShenYouYinJiPanelItem.prototype,"ShenYouYinJiPanelItem"),window.ShenYouYinJiPanelItem=ShenYouYinJiPanelItem;var ShenYouYinJiSkillShowWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.winType=WinType.NormalWin,e.skillConfig=new SkillsConfig,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShenYouYinJiSkillShowWinEUI",this.groupEntity2.scaleX=this.groupEntity2.scaleY=this.groupEntity1.scaleX=this.groupEntity1.scaleY=.7},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg(),this.mc=new MC,this.groupMC.addChild(this.mc),this.entityRole=GFunc.createEntityUI(),this.entityRole.scaleX=this.entityRole.scaleY=1.2,this.groupEntity1.addChild(this.entityRole),this.entityRole2=GFunc.createEntityUI(),this.entityRole2.scaleX=this.entityRole2.scaleY=1.2,this.groupEntity2.addChild(this.entityRole2)},e.prototype.open=function(e,i){t.prototype.open.call(this),this.skillConfig=Cfg.getConfig(SkillsConfig,e),this.lbSkillName.text=this.skillConfig.name,this.lbSkillCD.text=Lang.sy_str10+":"+this.skillConfig.cd/1e3+Lang.common_miao,this.imgIcon.source=ResMgr.getSkillResourceItemName(this.skillConfig.icon,!0,!1),this.lbSkillDesc.textFlow=StrUtil.toTF(Cfg.getConfig(ShenYouBaseConfig).skillViewDesc),this.lbSkillXiaoGuo1.textFlow=StrUtil.toTF(this.skillConfig.desc),this.updateEntity(),this.updateEntity2(),this.entityPlay()},e.prototype.updateEntity2=function(){var t=new EntityRoleData;t.szId=0,t.damonId=1,t.job=1,t.wingId=1,t.sex=1,t.type=EntityType.ROLE,this.entityRole2.setData(t,7,EntityAction.STAND)},e.prototype.updateEntity=function(){var t=new EntityRoleData;t.szId=0,t.damonId=1,t.job=1,t.wingId=1,t.sex=0,t.type=EntityType.ROLE,this.entityRole.setData(t,3,EntityAction.STAND);var e=Cfg.getConfig(ShenYouHuDunAppearanceConfig,100).appearance,i=ResMgr.getEntityHuDunRes(EntityType.ROLE,e),n=MC.createCenterGruop(i,-1);this.groupEntity1.addChild(n)},e.prototype.close=function(){t.prototype.close.call(this),this.entityRole.reset(),Timer.ins().removeAll(this)},e.prototype.entityPlay=function(){var t=this,e=new MC;e.playFile(getEffName("shenyou_skill0"),1,function(){Timer.ins()["do"](2e3,0,1,t.entityPlay,t)}),this.groupMC.addChild(e)},e}(BaseWinSingle);__reflect(ShenYouYinJiSkillShowWin.prototype,"ShenYouYinJiSkillShowWin"),window.ShenYouYinJiSkillShowWin=ShenYouYinJiSkillShowWin;var ShenYouYinJiSkillShowWin2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entityXYs=[new XY(-200,-260)],e.monsterXYs=[new XY(200,-40)],e.skillConfig=new SkillsConfig,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShenYouYinJiSkillShowWin2EUI",this.groupEntity2.scaleX=this.groupEntity2.scaleY=this.groupEntity1.scaleX=this.groupEntity1.scaleY=.7},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg(),this.entityRole=GFunc.createEntityUI(),this.entityRole.scaleX=this.entityRole.scaleY=1.2,this.groupEntity1.addChild(this.entityRole),this.entityRole2=GFunc.createEntityUI(),this.entityRole2.scaleX=this.entityRole2.scaleY=1.2,this.groupEntity2.addChild(this.entityRole2)},e.prototype.open=function(e,i){t.prototype.open.call(this),this._skillData=e,this.skillMCName="shenyou_skill"+(i+1),this.skillConfig=Cfg.getConfig(SkillsConfig,51004),this.addClickE(this.btnSend,this.onTap),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.upatePanel),this.upatePanel(),this.updateEntity(),this.updateEntity2(),this.entityPlay()},e.prototype.updateEntity2=function(){var t=new EntityRoleData;t.szId=0,t.damonId=1,t.job=1,t.wingId=1,t.sex=1,t.type=EntityType.ROLE,this.entityRole2.setData(t,7,EntityAction.STAND)},e.prototype.updateEntity=function(){var t=new EntityRoleData;t.szId=0,t.damonId=1,t.job=1,t.wingId=1,t.sex=0,t.type=EntityType.ROLE,this.entityRole.setData(t,3,EntityAction.STAND);var e=Cfg.getConfig(ShenYouHuDunAppearanceConfig,100).appearance,i=ResMgr.getEntityHuDunRes(EntityType.ROLE,e),n=MC.createCenterGruop(i,-1);n.y=50,this.groupEntity1.addChild(n)},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().removeAll(this)},e.prototype.upatePanel=function(){var t=QiyuSys.ins().shenYouData;this.nextSkillPassiveConfig=Cfg.getConfig(SkillPassiveConfig,this._skillData.id,this._skillData.isMax()?this._skillData.level:this._skillData.level+1);var e=Cfg.getConfig(SkillPassiveConfig,this._skillData.id,this._skillData.level),i=this._skillData;this.lbSkillName.text=this.nextSkillPassiveConfig.name+" Lv."+i.level;var n=Cfg.getMaxConfig(SkillPassiveConfig,this._skillData.id).level;this.lbSkillLevel.text=Lang.sy_str6+":"+n,this.lbSkillDesc.textFlow=StrUtil.toTF(Cfg.getConfig(ShenYouBaseConfig).skillViewDesc),this.lbSkillXiaoGuo1.textFlow=StrUtil.toTF(this.nextSkillPassiveConfig.skinname),this.imgIcon.source=ResMgr.getSkillPassivityItemName(i.id,i.level>0);var a=SkillSys.ins().isSkillPassivityUp(i);this.btnSend.label=i.level>0?Lang.common_str37:Lang.guild_str47;var o="";i.level>0?Lang.skill_str27:Lang.skill_str26,o+=""+Lang.sy_str7+e.typeLevel+Lang.sy_str8+(0==i.level?Lang.guild_str47:Lang.common_str37)+" ";var s=null==e.item.id;if(s){this.groupAct.visible=!a;var r=addColor(t.yinjiLevel+"/"+e.typeLevel,15733780);this.lbYinJiLevel.textFlow=addColorTF("("+Lang.sy_str9+":"+r+")"),this.lbAct.text=a?"":o,this.groupConsu.visible=!1,this.btnSend.enabled=a,this.btnSend.visible=a}else this.groupAct.visible=!1,this.lbAct.text="",this.groupConsu.visible=!0,this.btnSend.enabled=!0,this.btnSend.visible=!0,this.updateConsume(e.item.id);this.updateState()},e.prototype.updateState=function(){this._skillData.isMax()?(this.groupSend.visible=!1,this.imgYml.visible=!0):this.imgYml.visible=!1},e.prototype.updateConsume=function(t){var e=(QiyuSys.ins().shenYouData,Cfg.getItemCfg(t));this.imgConsu.source=ResMgr.getItemIconMin(e.getIcon());var i=BagSys.ins().getItemCount(t);this.lbConsu.text=i+" /1",this.lbConsu.textColor=i>=1?5949490:15733780},e.prototype.onTap=function(t){var e=null==this._skillData.getConfig().item.id;e?SkillSys.ins().sendSkillPassivityUp(this._skillData.id):GFunc.checkConsumeEnough(this._skillData.getConfig().item)&&SkillSys.ins().sendSkillPassivityUp(this._skillData.id)},e.prototype.entityPlay=function(){var t=this,e=new MC;e.playFile(getEffName(this.skillMCName),1,function(){Timer.ins()["do"](2e3,0,1,t.entityPlay,t)}),this.groupMC.addChild(e)},e}(BaseWinSingle);__reflect(ShenYouYinJiSkillShowWin2.prototype,"ShenYouYinJiSkillShowWin2"),window.ShenYouYinJiSkillShowWin2=ShenYouYinJiSkillShowWin2;var PraiseData=function(){function t(){this.szId=0,this.sqId=0,this.wingId=0,this.hqId=0,this.junxianId=0,this.txId=0,this.titleId=0,this.damonId=0,this.yongbingId=0,this.meilinId=0,this.shenmoId=0,this.mzId=0,this.sex=0}return t.prototype.canPraise=function(){return this.praiseCount<1},t.prototype.parser=function(t,e){this.type=e;var i=t.readByte();if(this.praiseCount=t.readByte(),1==i)switch(this.type){case RankType.JLZL:this.damonId=t.readInt(),this.mzId=t.readInt();break;case RankType.YBZL:this.yongbingId=t.readInt(),this.mzId=t.readInt();break;case RankType.SQZL:this.job=t.readByte(),this.sqId=t.readInt();break;case RankType.CBZL:this.job=t.readByte(),this.wingId=t.readInt();break;case RankType.SZZL:this.job=t.readByte(),this.sex=t.readByte(),this.szId=t.readInt();break;case RankType.MLZL:this.job=t.readByte(),this.meilinId=t.readInt();break;case RankType.SMZL:this.job=t.readByte(),this.shenmoId=t.readInt();break;default:this.job=t.readByte(),this.sex=t.readByte(),this.szId=t.readInt(),this.sqId=t.readInt(),this.wingId=t.readInt(),this.txId=t.readInt(),this.titleId=t.readInt(),this.mzId=t.readInt(),this.damonId=t.readInt(),this.meilinId=t.readInt(),this.junxianId=t.readInt(),this.hqId=t.readInt()}},t}();__reflect(PraiseData.prototype,"PraiseData"),window.PraiseData=PraiseData;var ShouYouYinJiComponentItem=function(t){function e(){var e=t.call(this)||this;return e.mc=new MC,e.b=!1,e.width=e.height=16,e.addChild(e.mc),e.mc.x=e.width/2,e.mc.y=e.height/2,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this,e=this.b;this.b=this.data,0==e&&1==this.b?(this.playMC1(),Timer.ins()["do"](300,1,1,function(){t.playMC2()},this)):1==e&&0==this.b&&(this.mc.stop(),this.mc.visible=!1,this.playMC3())},e.prototype.playMC1=function(){var t=new MC;t.x=this.width/2,t.y=this.height/2,t.playFile(getEffName("syxl"),1),this.addChild(t)},e.prototype.playMC2=function(){this.mc.playFile(getEffName("syhq"),-1)},e.prototype.playMC3=function(){var t=new MC;t.x=this.width/2,t.y=this.height/2,t.playFile(getEffName("syb"),1),this.addChild(t)},e}(eui.ItemRenderer);__reflect(ShouYouYinJiComponentItem.prototype,"ShouYouYinJiComponentItem"),window.ShouYouYinJiComponentItem=ShouYouYinJiComponentItem;var MallPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ShopWin],e.param=null,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[MallXGTHPanel,MallItemPanel,MallSVIPPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e,i){void 0===e&&(e=-1),void 0===i&&(i=null);var n=this.getAotuIndex(e);this.param=i,t.prototype.open.call(this,n),this.observeTabRedPoint()},e.prototype.getParam=function(){return[this.param]},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn5},e.getTitle=function(){return"btz_zycs_sc"},e.getTabTitle=function(){return"bqz_zycs_sc"},e}(BaseTabPanel);__reflect(MallPanel.prototype,"MallPanel"),window.MallPanel=MallPanel;var MizangPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ShopWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[MizangXingshiPanel,MizangHuangguanPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn5},e.getTitle=function(){return"btz_zycs_mz"},e.getTabTitle=function(){return"bqz_zycs_mz"},e}(BaseTabPanel);__reflect(MizangPanel.prototype,"MizangPanel"),window.MizangPanel=MizangPanel;var ShopPanel=function(t){function e(){var e=t.call(this)||this;return e.param=null,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShopBossPanel,ShopRongyuPanel,ShopCampPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e,i){void 0===e&&(e=-1),void 0===i&&(i=null);var n=this.getAotuIndex(e);this.param=i,t.prototype.open.call(this,n),this.observeTabRedPoint()},e.prototype.getParam=function(){return[this.param]},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn5},e.getTitle=function(){return""},e.getTabTitle=function(){return"bqz_zycs_sd"},e}(BaseTabPanel);__reflect(ShopPanel.prototype,"ShopPanel"),window.ShopPanel=ShopPanel;var ShopSys=function(t){function e(){var e=t.call(this)||this;e.mallItemDatas=[],e.mallXGTHDatas=[],e.mallSVIPDatas=[],e.shopYongZheDatas=[],e.shopYongZhefirstRed=1,e.shopBossDatas=[],e.shopRongyuDatas=[],e.shopYunBiaoDatas=[],e.xingshiDatas=[],e.huangguanDatas=[],e.shopDatas=[[]],e.shopCampDatas=[],e.sysId=PackId.Shop,e.reg(2,e.patchMallItemBuy),e.reg(11,e.patchRongyuBuy),e.reg(12,e.patchRongyu),e.reg(16,e.patchBossBuy),e.reg(21,e.patchBoss),e.reg(17,e.patchMallSVIPBuy),e.reg(18,e.patchMallSVIP),e.reg(19,e.patchMallXGTHBuy),e.reg(20,e.patchMallXGTH),e.reg(22,e.patchXingshiBuy),e.reg(23,e.patchXingshi),e.reg(24,e.patchHuangguanBuy),e.reg(25,e.patchHuangguan),e.reg(26,e.patchYunBiaoBuy),e.reg(27,e.patchYunBiao),e.reg(28,e.patchYongZheBuy),e.reg(29,e.patchYongZhe),e.reg(30,e.patchCampBuy),e.reg(31,e.patchCamp);for(var i=Cfg.getConfigs(StoreItemConfig),n=0,a=i;n<a.length;n++){var o=a[n],s=new MallItemData;s.index=o.index,e.mallItemDatas.push(s)}return e.shopDatas=[e.mallItemDatas,e.shopBossDatas],e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.sendMallSVIPBuy=function(t,e){void 0===e&&(e=1);var i=this.getBytes(17);i.writeShort(t),i.writeShort(e),this.send(i)},e.prototype.patchMallSVIPBuy=function(t){var e=t.readShort(),i=t.readShort(),n=this.getMallSVIPByConfigIndex(e);return n?n.buyCount=i:console.log("61-17 数据不存在,index:"+e),n},e.prototype.patchMallSVIP=function(t){var e=t.readShort();this.mallSVIPDatas.length=e;for(var i=0;e>i;i++){var n=this.mallSVIPDatas[i]=new MallSVIPData;n.configIndex=i+1,n.buyCount=t.readShort()}},e.prototype.getMallSVIPByIndex=function(t){return this.mallSVIPDatas[t]},e.prototype.getMallSVIPByConfigIndex=function(t){return this.getMallSVIPByIndex(t-1)},e.prototype.sendMallXGTHBuy=function(t){var e=this.getBytes(19);e.writeShort(t),this.send(e)},e.prototype.patchMallXGTHBuy=function(t){var e=t.readShort(),i=t.readShort(),n=this.getMallXGTHByConfigIndex(e);return n?n.buyCount=i:console.log("61-19 数据不存在,index:"+e),RpFun.showShopXGTHRedPoint(),n},e.prototype.patchMallXGTH=function(t){var e=t.readShort();this.mallXGTHDatas.length=e;for(var i=0;e>i;i++){var n=this.mallXGTHDatas[i]=new MallXGTHData;n.configIndex=i+1,n.buyCount=t.readShort()}},e.prototype.getMallXGTHByIndex=function(t){return this.mallXGTHDatas[t]},e.prototype.getMallXGTHByConfigIndex=function(t){return this.getMallXGTHByIndex(t-1)},e.prototype.sendItemShopBuy=function(t){var e=this.getBytes(2);e.writeInt(t.length);for(var i=0;i<t.length;i++)e.writeInt(t[i][0]),e.writeInt(t[i][1]);this.send(e)},e.prototype.patchMallItemBuy=function(t){var e=t.readByte();e?closeWin(ShopGoodsWarn):showtipsFail(Lang.common_str12)},e.prototype.getMallItemByIndex=function(t){return this.mallItemDatas[t]},e.prototype.sendBossBuy=function(t,e){void 0===e&&(e=1);var i=this.getBytes(16);i.writeShort(t),i.writeShort(e),this.send(i)},e.prototype.patchBossBuy=function(t){var e=t.readShort(),i=t.readShort(),n=this.getBossDataByIndex(e);return n&&(n.buyCount=i),n},e.prototype.patchBoss=function(t){var e=t.readShort();this.shopBossDatas.length=e;for(var i=0;e>i;i++){var n=this.shopBossDatas[i]=new ShopBossData;n.configIndex=i+1,n.buyCount=t.readShort()}},e.prototype.getBossDataByIndex=function(t){return this.shopBossDatas[t-1]},e.prototype.sendRongyuBuy=function(t,e){var i=this.getBytes(11);i.writeInt(t),i.writeInt(e),this.send(i)},e.prototype.patchRongyuBuy=function(t){var e=(t.readBoolean(),t.readInt()),i=t.readInt(),n=this.getRongyuDataByConfigIndex(e);return n&&(n.buyCount=i),n},e.prototype.sendRongyuInfo=function(){this.sendBase(12)},e.prototype.patchRongyu=function(t){var e=t.readInt();this.shopRongyuDatas.length=e;for(var i=0;e>i;i++){var n=this.shopRongyuDatas[i]=new ShopRongyuData;n.configIndex=t.readInt(),n.buyCount=t.readInt()}},e.prototype.getRongyuDataByIndex=function(t){return this.shopRongyuDatas[t]},e.prototype.getRongyuDataByConfigIndex=function(t){return this.getRongyuDataByIndex(t-1)},e.prototype.sendXingshiBuy=function(t,e){void 0===e&&(e=1);var i=this.getBytes(22);i.writeShort(t),i.writeShort(e),this.send(i)},e.prototype.patchXingshiBuy=function(t){var e=t.readShort(),i=t.readShort(),n=this.getXingshiDataByConfigIndex(e);return n&&(n.buyCount=i),n},e.prototype.patchXingshi=function(t){var e=t.readShort();this.xingshiDatas.length=e;for(var i=0;e>i;i++){var n=this.xingshiDatas[i]=new MizangXingshiData;n.configIndex=i+1,n.buyCount=t.readShort()}},e.prototype.getXingshiDataByIndex=function(t){return this.xingshiDatas[t]},e.prototype.getXingshiDataByConfigIndex=function(t){return this.getXingshiDataByIndex(t-1)},e.prototype.sendHuangguanBuy=function(t,e){void 0===e&&(e=1);var i=this.getBytes(24);i.writeShort(t),i.writeShort(e),this.send(i)},e.prototype.patchHuangguanBuy=function(t){var e=t.readShort(),i=t.readShort(),n=this.getHuangguanDataByConfigIndex(e);return n&&(n.buyCount=i),n},e.prototype.patchHuangguan=function(t){var e=t.readShort();this.huangguanDatas.length=e;for(var i=0;e>i;i++){var n=this.huangguanDatas[i]=new MizangHuangguanData;n.configIndex=i+1,n.buyCount=t.readShort()}},e.prototype.getHuangguanDataByIndex=function(t){return this.huangguanDatas[t]},e.prototype.getHuangguanDataByConfigIndex=function(t){return this.getHuangguanDataByIndex(t-1)},e.prototype.getDayCountName=function(t){void 0===t&&(t=1);var e=["","每日限购","每周限购","终身限购"];return e[t]},e.prototype.getShopData=function(t){for(var e=0;e<this.shopDatas.length;e++)for(var i=this.shopDatas[e],n=0;n<i.length;n++){var a=i[n];if(a.getItemId()==t&&a.isFastBuy())return a}return null},e.prototype.sendYunBiaoBuy=function(t,e){void 0===e&&(e=1);var i=this.getBytes(26);i.writeShort(t),i.writeShort(e),this.send(i)},e.prototype.patchYunBiaoBuy=function(t){var e=t.readShort(),i=t.readShort(),n=this.getYunBiaoDataByConfigIndex(e);return n&&(n.buyCount=i),n},e.prototype.patchYunBiao=function(t){var e=t.readShort();this.shopYunBiaoDatas.length=e;for(var i=0;e>i;i++){var n=this.shopYunBiaoDatas[i]=new ShopYunBiaoData;n.configIndex=i+1,n.buyCount=t.readShort()}},e.prototype.getYunBiaoDataByIndex=function(t){return this.shopYunBiaoDatas[t]},e.prototype.getYunBiaoDataByConfigIndex=function(t){return this.getYunBiaoDataByIndex(t-1)},e.prototype.sendYongZheBuy=function(t,e,i){void 0===i&&(i=1);var n=this.getBytes(28);n.writeByte(t),n.writeShort(e),n.writeInt(i),this.send(n)},e.prototype.patchYongZheBuy=function(t){var e=t.readByte(),i=t.readShort(),n=t.readInt(),a=this.getYongZheData(e,i);return a&&(a.buyCount=n),RpFun.showYongZheShopRedPoint(),a},e.prototype.patchYongZhe=function(t){for(var e=t.readByte(),i=t.readShort(),n=0;i>n;n++){var a=this.getYongZheData(e,n+1);a.buyCount=t.readInt()}e=t.readByte(),i=t.readShort();for(var n=0;i>n;n++){var a=this.getYongZheData(e,n+1);a.buyCount=t.readInt()}RpFun.showYongZheShopRedPoint()},e.prototype.getYongZheData=function(t,e){var i=this.shopYongZheDatas[t-1];i||(i=this.shopYongZheDatas[t-1]=[]);var n=i[e-1];return n||(n=i[e-1]=new ShopYongZheData,n.type=t,n.configIndex=e),n},e.prototype.sendCampBuy=function(t,e){var i=this.getBytes(30);i.writeInt(t),i.writeInt(e),this.send(i)},e.prototype.patchCampBuy=function(t){var e=(t.readBoolean(),t.readInt()),i=t.readInt(),n=this.getCampDataByConfigIndex(e);return n&&(n.buyCount=i),n},e.prototype.patchCamp=function(t){var e=t.readInt();this.shopCampDatas.length=e;for(var i=0;e>i;i++){var n=this.shopCampDatas[i]=new ShopCampData;n.configIndex=t.readInt(),n.buyCount=t.readInt()}},e.prototype.getCampDataByIndex=function(t){return this.shopCampDatas[t]},e.prototype.getCampDataByConfigIndex=function(t){return this.getCampDataByIndex(t-1)},e}(BaseSys);__reflect(ShopSys.prototype,"ShopSys"),SystemMap.ShopSys=ShopSys.ins.bind(ShopSys),window.ShopSys=ShopSys;var ShopWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e.addLsn(ShopYongZhePanel.openCheng,e.chengEvent),e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[MallPanel,ShopPanel,MizangPanel,ShopYongZhePanel]},enumerable:!0,configurable:!0}),e.prototype.chengEvent=function(t){var e="public_zycs_quxiao";e=t?"public_zycs_quxiao":"sc_zycs_x",this.closeBtn.icon=e},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.closeBtn.icon="sc_zycs_x",this.eGroup.visible=!1},e}(BaseDuoPanelWin);__reflect(ShopWin.prototype,"ShopWin"),window.ShopWin=ShopWin;var ShopYunBiaoPanel=function(t){function e(){var e=t.call(this)||this;return e.mc=new MC,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopYunBiaoPanelEUI"},e.prototype.getListItemClass=function(){return ShopYunBiaoPanelItem},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItemArr.source=ShopSys.ins().shopYunBiaoDatas,this.mc||(this.mc=new MC),this.mc.playFile(ResMgr.getUIMeilinRes("merlin_014"),-1),this.mc.x=185,this.mc.y=73,this.mc.scaleX=.8,this.mc.scaleY=.8,this.addChild(this.mc)},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeCount),this.addLsn(ShopSys.ins().patchYunBiao,this.onRefresh),this.addLsn(ShopSys.ins().patchYunBiaoBuy,this.onBuy),this.updateConsumeCount(),e&&this.selectItem(this.itemId)},e.prototype.onRefresh=function(){this.listItemArr.replaceAll(ShopSys.ins().shopYunBiaoDatas)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.updateConsumeCount=function(t){this.needitem||(this.needitem=Cfg.getConfig(DartStoreConfig,1).needitem),t&&t.id!=this.needitem||(this.imgIcon.source="zycs_"+this.needitem,this.labelCount.text=Cfg.getItemCfg(this.needitem).getName()+"："+GFunc.getItemCount(this.needitem))},e.prototype.onClick=function(t){var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;if(a.canBuy()){var o=Cfg.getItemCfg(a.config.id);if(o.type==ItemType.FootEquip&&FootSys.ins().isBagMax())return void showtipsFail(Lang.foot_str13);GFunc.checkConsumeEnough(a.getConsumeItem())&&openWin(BuyWin,a.getBuyData())}else showtipsFail(Lang.shop_str10)}},e.getTabTitle=function(){return"宝藏商店"},e.getSysId=function(){return SysId.Dart},e}(MallBasePanel);__reflect(ShopYunBiaoPanel.prototype,"ShopYunBiaoPanel"),window.ShopYunBiaoPanel=ShopYunBiaoPanel;var ShopYunBiaoPanelItem=function(t){function e(){var e=t.call(this)||this;
return e.skinName="ShopYunBiaoPanelItemEUI",e.setSkinPart("item",new ItemShop),e.setSkinPart("priceIcon",new PriceIcon),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.btnBuy.name="btnBuy_"+this.itemIndex,this.labelName.textFlow=GFunc.getItemName1(t.config.id);var e=ShopSys.ins().getDayCountName(t.config.daycount.type);this.labelDesc.text=e+"："+t.buyCount+"/"+t.config.daycount.count,this.labelDesc.visible=0!=t.config.daycount.count;var i=t.canBuy();this.btnBuy.visible=i,this.labelMax.visible=!i,this.item.data=t.getItemSell(),this.priceIcon.setData(t.getConsumeItem())},e}(MallItemPanelItemBase);__reflect(ShopYunBiaoPanelItem.prototype,"ShopYunBiaoPanelItem"),window.ShopYunBiaoPanelItem=ShopYunBiaoPanelItem;var RankWin=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.winType=WinType.MainWin,e.index=0,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[RankPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e,i){void 0===i&&(i=0),this.index=i,t.prototype.open.call(this,e)},e.prototype.getParam=function(){return[this.index]},e}(BaseWinAutoTab);__reflect(RankWin.prototype,"RankWin"),window.RankWin=RankWin;var BuyWin1=function(t){function e(){var e=t.call(this)||this;return e._num=1,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="BuyCountSkinNew3"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg(),this.setSkinPart("itemIcon",new ItemIcon),this.setSkinPart("allPrice",new PriceIcon),this.gainList.itemRenderer=GainGoodsItem,this.gainList.dataProvider=this.gainListData=new eui.ArrayCollection},e.prototype.open=function(e){t.prototype.open.call(this),this.buyData=e,this._num=e.count,this.addItemTapE(this.gainList,this.onTouchList),this.addClickE(this.buyBtn,this.onClick),this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.checkBoxs,this.onClick),this.updateView()},e.prototype.updateView=function(){var t=Cfg.getItemCfg(this.buyData.itemId);this.itemIcon.setDataByItemConfig(t),this.allPrice.setType(this.buyData.consumeItemId),this.allPrice.setPrice(this.buyData.getTotalPrice(this._num)),this.numLabel.text="是否花费仙玉购买"+this._num+"个";var e=GFunc.getGainItemWayConfig(t.id);if(e.length>0){this.groupGain.scaleY=this.gainList.scaleY=1,this.gainListData.source=e;var i=e.length>4?4:e.length;this.gainList.width=94*i+35*(i-1)}else this.groupGain.scaleY=this.gainList.scaleY=0},e.prototype.onClick=function(t){switch(t.target){case this.btnRecharge:openWin(RechargeWin);break;case this.buyBtn:GFunc.checkCurrency(this.buyData.consumeItemId,this.buyData.getTotalPrice(this._num))&&(this.buyData.buyFun.param=[this._num],this.buyData.buyFun.call(),closeWin(this));break;case this.checkBoxs:var e=this.checkBoxs.selected;this.buyData.saveKey&&TipsSys.ins().setSaveRemind(this.buyData.saveKey,e)}},e.prototype.buy=function(t){},e.prototype.onTouchList=function(t){var i=t.item;if(null!=t.item){var n=GFunc.createTaskNavData(i.controlTarget);n.setsucceedFrontFun(function(){WinMgr.ins().closeAllWin(),closeWin(e)}),n["goto"](i.sysid)}},e}(BaseWin);__reflect(BuyWin1.prototype,"BuyWin1"),window.BuyWin1=BuyWin1;var RechargeActSys=function(t){function e(){var e=t.call(this)||this;e.costList=0,e.monthFlag=0,e.firstRechargeData=new FirstRechargeData,e.firstRechargeEveryDay=new RechargeData,e.redbaoNum=0,e.redBaoSendData=[],e.rechargeNum=0,e.redbaoRobDatas=[],e.yymsRechargeStates=[],e.svipmsRechargeStates=[],e.jinZuanBagItemDatas=[],e.firstPower=0,e.zeroBuyDatas=[],e.yzzhData=new YZZHData,e.firstOpen=!0,e.tipsDatas=[],e.sysId=PackId.RechargeActivity,e.reg(1,e.patchInitRechargeEveryday),e.reg(2,e.patchRechargeEveryday),e.reg(3,e.doPayOrder),e.reg(10,e.patchUpDataItem),e.reg(20,e.patchGetMonthDay),e.reg(21,e.patchFirstRecharge),e.reg(22,e.patchZZTQ),e.reg(23,e.patchZZTQBossAutoTZ),e.reg(41,e.patchRedbaoInfo),e.reg(43,e.patchRedbaoRobInfo),e.reg(44,e.patchRedbaoRobResult),e.reg(45,e.doRedbaoLog),e.reg(46,e.patchRedbaoInfo2),e.reg(53,e.patchYYMS),e.reg(54,e.patchSVIPMS),e.reg(60,e.patchJinZuanValueUpdate),e.reg(61,e.patchJinZuanData),e.reg(62,e.patchJinZuanChouJian),e.reg(63,e.patchJinZuanJiLu),e.reg(64,e.patchJinZuanZhuFuReward),e.reg(65,e.patchJinZuanShopData),e.reg(66,e.patchJinZuanShopRefresh),e.reg(67,e.patchJinZuanShopBuy),e.reg(68,e.patchZeroBuyData),e.reg(69,e.patchZeroBuyGetAward),e.reg(74,e.patchsendZeroBuyBuy),e.reg(70,e.patchBBFLInfo),e.reg(71,e.patchBBFLReward),e.reg(72,e.patchBBFLLoginDay),e.reg(73,e.patchBBFLBuy),e.reg(80,e.patchYiYuanData),e.reg(81,e.patchYiYuanReceived),e.reg(90,e.patchYZZHData),e.reg(91,e.patchYZZHBuyUpdate),e.reg(92,e.patchYZZHBuyLevel),e.reg(93,e.patchYZZHJieDuanTaskUpdate),e.reg(94,e.patchYZZHJieDuanTaskGet),e.reg(95,e.patchYZZHGetExp),e.reg(96,e.patchYZZHGetReward);for(var i=0;3>i;i++)e.yymsRechargeStates[i]=0;for(var i=0;3>i;i++)e.svipmsRechargeStates[i]=0;for(var i=0;3>i;i++)e.zeroBuyDatas[i]=new ZeroBuyData;return e.jinZuanData=new JinZuanData,e.jinZuanData.iniData(),e.bbflModel=new BBFLModel,e.rechargeYiYuanData=new RechargeYiYuanData,e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchInitRechargeEveryday=function(t){this.firstRechargeEveryDay.parser(t),this.firstRechargeEveryDay.isEverydayFirst&&isShowWin(RechargeWin)&&openWin(RechargeWin1,2),this.updateShouHuActItemid(),this.patchUpdateRecharge(),RpFun.showFirstRechargeEverydayRedPoint()},e.prototype.sendRechargeEveryday=function(t){void 0===t&&(t=1);var e=this.getBytes(2);e.writeShort(t),this.send(e)},e.prototype.patchRechargeEveryday=function(t){this.firstRechargeEveryDay.change(t),this.updateShouHuActItemid(),RpFun.showFirstRechargeEverydayRedPoint(),this.patchUpdateRecharge()},e.prototype.sendPayOrder=function(t){var e=Cfg.getPayMoneyRMBByYb(t),i=this.getBytes(3);i.writeInt(e),i.writeInt(t),this.send(i)},e.prototype.doPayOrder=function(t){var e=t.readInt(),i=t.readString(),n=t.readInt();200!=e&&console.warn("请求游戏服务器充值订单号失败",e,i,n);var a=VipSys.ins().getPayItem(n);if(a){var o=a.itemName,s=a.desc,r=a.amount;window.platform.pay(n,r,i,0,o,s)}},e.prototype.updateShouHuActItemid=function(){var t=this.firstRechargeEveryDay,e=t.configs;ShouHuNewSys.ins().damonModel.actZhiZhengItemId=[],ShouHuNewSys.ins().yongbingModel.actZhiZhengItemId=[],ShouHuNewSys.ins().shenmoModel.actZhiZhengItemId=[];for(var i=0;i<e.length;i++){var n=e[i],a=t.states[i];1!=a&&(ShouHuNewSys.ins().damonModel.actZhiZhengItemId=ShouHuNewSys.ins().damonModel.actZhiZhengItemId.concat(GFunc.getItemListByReward(n.awardList)),ShouHuNewSys.ins().yongbingModel.actZhiZhengItemId=ShouHuNewSys.ins().yongbingModel.actZhiZhengItemId.concat(GFunc.getItemListByReward(n.awardList)),ShouHuNewSys.ins().shenmoModel.actZhiZhengItemId=ShouHuNewSys.ins().shenmoModel.actZhiZhengItemId.concat(GFunc.getItemListByReward(n.awardList)))}},e.prototype.patchUpdateRecharge=function(){},e.prototype.patchUpDataItem=function(t){this.costList=t.readInt()},e.prototype.patchGetMonthDay=function(t){var e=t.readUnsignedInt();this.monthFlag=t.readInt();var i=ActSys.ins().getActDataById(ActId.ID_99900);i||(i=ActSys.ins().createData(ActId.ID_99900,ActType.TYPE_201)),i.endTime=i.jiesuanTime=Actor.ins().serverTime+1e3*e,RpFun.showMonthCardRedPoint()},e.prototype.senbFirstRecharge=function(t){var e=this.getBytes(21);e.writeByte(t),this.send(e)},e.prototype.patchFirstRecharge=function(t){this.firstRechargeData.patchFirstRecharge(t),RpFun.showFirstRecharge()},e.prototype.openFirstRechargeTipsWin=function(){GFunc.isSysOpen(SysId.SC)&&!e.ins().firstRechargeData.isRecharge()&&(GFunc.isInGuaJiFb()||GFunc.isInCity())&&(this.firstPower=0,openWin(FirstRechargeTipsWin))},e.prototype.patchZZTQ=function(t){var e=ActSys.ins().getActDataById(ActId.ID_99500);e||(e=ActSys.ins().createData(ActId.ID_99500,ActType.TYPE_202)),e.commonData=t.readByte();var i=t.readByte();if(e instanceof ActData202_1){var n=e.isAct();n&&RpFun.showZZTQCardRedPoint(),e.bossDatas.length=0;for(var a=0;i>a;a++){var o=t.readShort(),s=t.readByte(),r=new ActData202_1BossData;r.sysId=o,r.state=s,e.bossDatas.push(r)}}},e.prototype.sendZZTQBossAutoTZ=function(t,e){var i=this.getBytes(23);i.writeShort(t),i.writeByte(e),this.send(i)},e.prototype.patchZZTQBossAutoTZ=function(t){for(var e=t.readShort(),i=t.readByte(),n=ActSys.ins().getActDataById(ActId.ID_99500),a=0;a<n.bossDatas.length;a++){var o=n.bossDatas[a];if(o.sysId==e){o.state=i;break}}},e.prototype.patchRedbaoInfo=function(t){this.redbaoNum=t.readShort(),this.redBaoSendData=[];for(var e=0;e<this.redbaoNum;e++){var i=new RedBaoSendData;i.parser(t),this.redBaoSendData.push(i)}this.rechargeNum=t.readInt();t.readBoolean();RpFun.showSendRedBaoRedPoint()},e.prototype.sendRedbaoRequest=function(){var t=this.getBytes(42);this.send(t)},e.prototype.patchRedbaoRobInfo=function(t){var e=new RedBaoRobData;e.parser(t),this.redbaoRobDatas.unshift(e)},e.prototype.sendRedbaoRob=function(t){var e=this.getBytes(44);e.writeInt(t),this.send(e)},e.prototype.patchRedbaoRobResult=function(t){for(var e=t.readInt(),i=0,n=this.redbaoRobDatas;i<n.length;i++){var a=n[i];if(a.redbaoId==e){a.parser2(t),a.receiveState==RedbaoReceiveState.guoQi?showtipsFail(Lang.recharge_str16):openWin(RedBaoResultWin,a);break}}},e.prototype.sendRedbaoLog=function(t){var e=this.getBytes(45);e.writeInt(t),this.send(e)},e.prototype.doRedbaoLog=function(t){var e=new RedbaoLogData;e.parser(t),openWin(RedBaoLogWin,e)},e.prototype.sendRedbaoInfo=function(){this.sendBase(46)},e.prototype.patchRedbaoInfo2=function(t){},e.prototype.sendYYMS=function(t){var e=this.getBytes(53);e.writeByte(t),this.send(e)},e.prototype.patchYYMS=function(t){for(var e=t.readByte(),i=0;e>i;i++)this.yymsRechargeStates[i]=t.readByte();RpFun.showYYMSRp()},e.prototype.sendSVIPMS=function(t){var e=this.getBytes(54);e.writeByte(t),this.send(e)},e.prototype.patchSVIPMS=function(t){for(var e=t.readByte(),i=0;e>i;i++)this.svipmsRechargeStates[i]=t.readByte();RpFun.showSVIPMSRp()},e.prototype.sendLevelInvest=function(t){var e=this.getBytes(48);e.writeByte(t),this.send(e)},e.prototype.getNextRedbaoByYuanbao=function(){for(var t=Cfg.getConfig(HongbaoConfig).condition,e=0;e<t.length;e++)if(this.rechargeNum<t[e])return t[e]-this.rechargeNum;return-1},e.prototype.getOrderByIndex=function(t){void 0===t&&(t=0);var e=this.costList>>t&1;return e},e.prototype.getAddBagGrid=function(){return 1==this.monthFlag?100:0},e.prototype.getRedbaoReceiveNum=function(){for(var t=0,e=0,i=this.redbaoRobDatas;e<i.length;e++){var n=i[e];n.receiveState==RedbaoReceiveState.weiLing&&(t+=1)}return t},e.prototype.onSocketClose=function(){this.redbaoRobDatas=[]},e.prototype.isFirstRechargeEveryDay=function(){var t=this.firstRechargeEveryDay;return t.isEverydayFirst&&GFunc.isSysOpen(SysId.MRSC)&&!t.hasGetAward()},e.prototype.isRechargeEveryday=function(){var t=!1;if(t=this.firstRechargeEveryDay.isEverydayFirst?!this.isFirstRechargeEveryDay():1==this.firstRechargeData.firstRechargeState){var e=ActSys.ins().getActivityDatasByType(ActType.TYPE_1,ActSubType.TYPE_7);t=e.length>0}return t},e.prototype.isYYMSBuy=function(t){return 1==this.yymsRechargeStates[t]},e.prototype.getYYMSState=function(t){return this.yymsRechargeStates[t]},e.prototype.isYYMSBuyAll=function(){for(var t=!0,e=0,i=this.yymsRechargeStates;e<i.length;e++){var n=i[e];if(0==n){t=!1;break}}return t},e.prototype.isYYMSGetAwardAll=function(){for(var t=!0,e=0,i=this.yymsRechargeStates;e<i.length;e++){var n=i[e];if(2!=n){t=!1;break}}return t},e.prototype.isSVIPMSBuy=function(t){return 1==this.svipmsRechargeStates[t]},e.prototype.getSVIPMSState=function(t){return this.svipmsRechargeStates[t]},e.prototype.isSVIPMSBuyAll=function(){for(var t=!0,e=0,i=this.svipmsRechargeStates;e<i.length;e++){var n=i[e];if(0==n){t=!1;break}}return t},e.prototype.isSVIPMSGetAwardAll=function(){for(var t=!0,e=0,i=this.svipmsRechargeStates;e<i.length;e++){var n=i[e];if(2!=n){t=!1;break}}return t},e.prototype.patchJinZuanValueUpdate=function(t){var e=t.readInt();this.jinZuanData.setjinZuanValue(e)},e.prototype.patchJinZuanData=function(t){this.jinZuanData.parser(t)},e.prototype.sendJinZuanChouJian=function(t){var e=this.getBytes(62);e.writeByte(t),this.send(e)},e.prototype.patchJinZuanChouJian=function(t){for(var e=t.readByte(),i=[],n=0;e>n;n++){var a=new ItemDataReward;a.parser2(t);var o=GFunc.creatItemDataById(a.id);o.count=a.count,i.push(o);var s=1==t.readByte();s&&(this.tipsDatas.push(o),isShowWin(XunBaoJiPingItemTipsWin)||this.showJiPingItem())}if(i.length>=10)openWin(JinZuanRewardListTipsWin,i);else if(i.length>0&&isShowWin(JinZuanWin)){var r=i[0].id,u=new eui.Image;u.source=ResMgr.getItemIcon(Cfg.getItemCfg(r).getIcon(),IconType.IT_80x80),u.anchorOffsetX=37,u.anchorOffsetY=37,u.x=LayerMgr.Popup.width/2+40,u.y=LayerMgr.Popup.height/2-200,LayerMgr.Popup.addChild(u);var h=getWin(JinZuanWin).getJinZuanBag();GFunc.flyToBag1(u,h)}var p=t.readInt();this.jinZuanData.setZhuFuValue(p),RpFun.showJinZuanRedPoint()},e.prototype.showJiPingItem=function(){if(this.tipsDatas.length>0){var t=this.tipsDatas[0];openWin(XunBaoJiPingItemTipsWin,t,this.showJiPingItem,this,XunBaoJiPingItemTipsWin.JIN_ZUAN),this.tipsDatas.splice(0,1)}},e.prototype.sendJinZuanJiLu=function(t){var e=this.getBytes(63);e.writeByte(t),this.send(e)},e.prototype.patchJinZuanJiLu=function(t){var e=t.readByte(),i=t.readByte(),n=[],a=0;n=0==e?this.jinZuanData.xunBaoJiLuMyDatas:this.jinZuanData.xunBaoJiLuOtherDatas,a=n.length;for(var o=0;i>o;o++)if(o>a-1){var s=new JinZuanJiLuData;s.parser(t),n.push(s),1==e&&this.patchJinZuanOtherJiLuUpdate(s)}},e.prototype.patchJinZuanOtherJiLuUpdate=function(t){return t},e.prototype.sendJinZuanZhuFuReward=function(t){var e=this.getBytes(64);e.writeByte(t),this.send(e)},e.prototype.patchJinZuanZhuFuReward=function(t){var e=t.readByte(),i=(t.readByte(),t.readInt()),n=t.readInt();this.jinZuanData.setZhuFuValue(n),this.jinZuanData.setZhuFuType(e),this.jinZuanData.setZhuFuReceive(i),RpFun.showJinZuanRedPoint()},e.prototype.sendJinZuanShopData=function(){var t=this.getBytes(65);this.send(t)},e.prototype.patchJinZuanShopData=function(t){this.jinZuanData.parserShop(t)},e.prototype.sendJinZuanShopRefresh=function(){var t=this.getBytes(66);this.send(t)},e.prototype.patchJinZuanShopRefresh=function(t){this.jinZuanData.parserShop(t),showtipsSuc("刷新成功")},e.prototype.sendJinZuanShopBuy=function(t){var e=this.getBytes(67);e.writeByte(t),this.send(e)},e.prototype.patchJinZuanShopBuy=function(t){var e=t.readByte(),i=t.readByte(),n=this.jinZuanData.getShopDataById(e);n&&(n.setIsBuy(i),showtipsSuc("购买成功"))},e.prototype.patchZeroBuyData=function(t){var e=t.readByte();this.zeroBuyDatas.length=e;for(var i=0;e>i;i++){var n=this.zeroBuyDatas[i]=this.zeroBuyDatas[i]||new ZeroBuyData;n.id=i+1,n.parser(t)}this.startUpdateZeroBuyTime()},e.prototype.sendZeroBuyGetAward=function(t){var e=this.getBytes(69);e.writeByte(t),this.send(e)},e.prototype.patchZeroBuyGetAward=function(t){var e=t.readByte(),i=this.getZeroBuyData(e);return i&&(i.state=2,RpFun.showZeroBuyRpSingle(i)),i},e.prototype.sendZeroBuyBuy=function(t){var e=this.getBytes(74);e.writeByte(t),this.send(e)},e.prototype.patchsendZeroBuyBuy=function(t){var e=t.readByte(),i=t.readInt(),n=this.getZeroBuyData(e);return n&&(n.state=1,n.endTick=Timer.ins().getEgretTimer()+1e3*i,showtipsSuc("购买成功"),this.startUpdateZeroBuyTime()),n},e.prototype.getZeroBuyData=function(t){return this.zeroBuyDatas[t-1]},e.prototype.isZeroBuyCanGetAward=function(){for(var t=!1,e=0,i=this.zeroBuyDatas;e<i.length;e++){var n=i[e];if(t=n.canGetAward())break}return t},e.prototype.isZeroAllGetAward=function(){for(var t=!0,e=0,i=this.zeroBuyDatas;e<i.length;e++){var n=i[e];t=t&&n.hasGetAward()}return t},e.prototype.getZeroNextTime=function(){for(var t=Number.MAX_VALUE,e=0,i=this.zeroBuyDatas;e<i.length;e++){var n=i[e];n.leftTime>0&&(t=Math.min(n.leftTime,t))}return t<Number.MAX_VALUE?t:0},e.prototype.startUpdateZeroBuyTime=function(){var t=this.getZeroNextTime();t>0&&t<DateUtil.SECOND_PER_DAY&&Timer.ins()["do"](t,0,1,this.startUpdateZeroBuyTime,this,TimerType.LAST),RpFun.showZeroBuyRp()},e.prototype.patchBBFLInfo=function(t){this.bbflModel.parserInfo(t)},e.prototype.sendBBFLReward=function(t,e){var i=this.getBytes(71);i.writeByte(t),i.writeByte(e),this.send(i)},e.prototype.patchBBFLReward=function(t){var e=this.bbflModel.parserReward(t);switch(e){case BBFLType.Login:RpFun.showBBFLLoginRp();break;case BBFLType.Custom:RpFun.showBBFLCustomRp();break;case BBFLType.Level:RpFun.showBBFLLevelRp()}},e.prototype.patchBBFLLoginDay=function(t){this.bbflModel.parserLoginDay(t),RpFun.showBBFLLoginRp()},e.prototype.sendBBFLBuy=function(t){var e=this.getBytes(73);e.writeByte(t),this.send(e)},e.prototype.patchBBFLBuy=function(t){var e=this.bbflModel.parserBuy(t);switch(e){case BBFLType.Login:RpFun.showBBFLLoginRp();break;case BBFLType.Custom:RpFun.showBBFLCustomRp();break;case BBFLType.Level:RpFun.showBBFLLevelRp()}showtipsSuc("投资成功")},e.prototype.doBagData=function(t){this.jinZuanBagItemDatas=[];for(var e,i=t.readInt(),n=0;i>n;n++)e=new ItemDataBase,e.parser(t),this.jinZuanBagItemDatas.push(e)},e.prototype.patchDeleteItem=function(t){for(var e=t.readDouble(),i=this.jinZuanBagItemDatas.length-1;i>=0;i--)if(this.jinZuanBagItemDatas[i].handle==e){this.jinZuanBagItemDatas.splice(i,1);break}RpFun.showJinZuanRedPoint()},e.prototype.patchAddItem=function(t){var e=new ItemDataBase;e.parser(t),this.jinZuanBagItemDatas.unshift(e);t.readByte(),t.readByte();RpFun.showJinZuanRedPoint()},e.prototype.patchUpDateItem=function(t){for(var e,i=t.readDouble(),n=t.readInt(),a=(t.readByte(),t.readByte(),0);a<this.jinZuanBagItemDatas.length;a++)if(e=this.jinZuanBagItemDatas[a],e.handle==i){e.count=n;break}},e.prototype.patchYiYuanData=function(t){this.rechargeYiYuanData.patch(t),RpFun.showYiYuanRedPoint()},e.prototype.sendYiYuanReceived=function(){var t=this.getBytes(81);this.send(t)},e.prototype.patchYiYuanReceived=function(t){this.rechargeYiYuanData.patch(t),RpFun.showYiYuanRedPoint()},e.prototype.patchYZZHData=function(t){this.yzzhData.parser(t)},e.prototype.patchYZZHBuyUpdate=function(t){this.yzzhData.buyShengHui=1==t.readByte(),RpFun.showYZZHRedPoint(),RpFun.showYZZHBoxRedPoint()},e.prototype.sendYZZHBuyLevel=function(t){var e=this.getBytes(92);e.writeShort(t),this.send(e)},e.prototype.patchYZZHBuyLevel=function(t){this.yzzhData.level=t.readShort(),RpFun.showYZZHRedPoint()},e.prototype.patchYZZHJieDuanTaskUpdate=function(t){this.yzzhData.parserJieDuanTaskUpdate(t),RpFun.showYZZHTaskRedPoint()},e.prototype.sendYZZHJieDuanTaskGet=function(t,e){var i=this.getBytes(94);i.writeByte(t),i.writeInt(e),this.send(i)},e.prototype.patchYZZHJieDuanTaskGet=function(t){this.yzzhData.parserJieDuanTaskGet(t),RpFun.showYZZHRedPoint(),RpFun.showYZZHTaskRedPoint()},e.prototype.sendYZZHGetExp=function(t){var e=this.getBytes(95);e.writeByte(t),this.send(e)},e.prototype.patchYZZHGetExp=function(t){this.yzzhData.parserGetExp(t),RpFun.showYZZHRedPoint(),RpFun.showYZZHBoxRedPoint();var e=Cfg.getConfig(YongZheSaiJiConfig,this.yzzhData.saiji);if(e){var i=e.exp[this.yzzhData.jieduan-1];showtipsSuc("经验+"+i)}},e.prototype.sendYZZHGetReward=function(t,e){var i=this.getBytes(96);i.writeByte(t),i.writeInt(e),this.send(i)},e.prototype.patchYZZHGetReward=function(t){var e=this.yzzhData.parserGetReward(t);return RpFun.showYZZHRedPoint(),e},e}(BaseSys);__reflect(RechargeActSys.prototype,"RechargeActSys");var RechargeData=function(){function t(){this.day=1,this.isEverydayFirst=!1,this.num=0,this.record=0,this.states=[-1,-1,-1],this.configs=[]}return t.prototype.parser=function(t){this.isEverydayFirst=t.readBoolean(),this.change(t),this.day=t.readShort(),this.configs=Cfg.getConfigs(ChongZhi1Config,RechargeActSys.ins().firstRechargeEveryDay.day,CondType.ALL),this.formState()},t.prototype.change=function(t){this.num=t.readInt(),this.record=t.readInt(),this.formState()},t.prototype.isShowRedPoint=function(){return-1!=this.states.indexOf(0)&&this.isEverydayFirst},t.prototype.hasGetAward=function(){return-1==this.states.indexOf(0)&&-1==this.states.indexOf(-1)},t.prototype.formState=function(){for(var t in this.configs){var e=this.configs[t];this.num>=e.pay?this.states[e.index-1]=this.record>>e.index&1:this.states[e.index-1]=-1}},t.prototype.getFormItemIndexByItemId=function(t){for(var e=this.configs,i=0;i<e.length;i++){var n=e[i],a=this.states[i];if(1!=a)for(var o=n.awardList,s=0;s<o.length;s++)if(o[s].id==t)return i}return 0},t}();__reflect(RechargeData.prototype,"RechargeData"),SystemMap.RechargeActSys=RechargeActSys.ins.bind(RechargeActSys),egret.registerClass(RechargeActSys,"RechargeActSys"),window.RechargeActSys=RechargeActSys;var BuyWinCount=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="BuyCountSkinNew2"},e.prototype.updatePrice=function(){this.allPrice.setType(this.buyData.consumeItemId),this.allPrice.setPrice(this.buyData.getTotalPrice(this.num))},e}(BuyWinBase);__reflect(BuyWinCount.prototype,"BuyWinCount"),window.BuyWinCount=BuyWinCount;var ShopGoodsWarn=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopGoodsWarnEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.gainList.itemRenderer=GainGoodsItem},e.prototype.open=function(e){"number"==typeof e?(this.gainId=e,t.prototype.open.call(this,null)):t.prototype.open.call(this,e),this.addClickE(this.topUpBtn,this.onTap),this.addItemTapE(this.gainList,this.onTouchList)},e.prototype.iniNum=function(){t.prototype.iniNum.call(this),this.num=this.num>=this.buyData.maxBuyCount?this.buyData.maxBuyCount:this.num},e.prototype.updateView=function(){this.buyData&&t.prototype.updateView.call(this),this.buyData?this.currentState="shop":this.currentState="normal",this.validateNow();var e=this.buyData?this.buyData.itemId:this.gainId,i=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,e),n=GFunc.creatItemDataById(e);n.count=i?i.count:0,this.itemIcon.data=n;var a=n.cfg;this.itemName.text=a.getName(),this.itemName.textColor=GConst.PZColor[a.quality];var o=GFunc.getGainItemWayConfig(e);this.gainList.dataProvider=new eui.ArrayCollection(o);var s=o.length>4?4:o.length;this.gainList.width=94*s+35*(s-1),this.topUpBtn.visible&&(this.topUpBtn.visible=!urlParam.isShenhe)},e.prototype.onTap=function(e){t.prototype.onTap.call(this,e),e.currentTarget===this.topUpBtn&&(openWin(RechargeWin),closeWin(this))},e.prototype.onTouchList=function(t){var i=t.item;if(null!=t.item){var n=GFunc.createTaskNavData(i.controlTarget);n.setsucceedFrontFun(function(){WinMgr.ins().closeAllWin(),closeWin(e)}),n["goto"](i.sysid)}},e}(BuyWin);__reflect(ShopGoodsWarn.prototype,"ShopGoodsWarn"),window.ShopGoodsWarn=ShopGoodsWarn;var RechargePowerSys=function(t){function e(){var e=t.call(this)||this;return e.shengbeiData=new ShengbeiData,e.sysId=PackId.RechargePower,e.reg(1,e.patchZhaoCaiLongDate),e.reg(2,e.patchhaoCaiLongBuy),e.reg(3,e.patchhaoCaiLongReceive),e.reg(11,e.patchXunZhangDate),e.reg(12,e.patchXunZhangBuy),e.reg(13,e.patchXunZhangReceive),e.reg(21,e.patchShengbeiInit),e.reg(22,e.patchShengbeiState),e.reg(23,e.patchShengbeiXiangqian),e.zhaoCaiLongData=new ZhaoCaiLongData,e.zhaoCaiLongData.iniData(),e.xunZhangData=new XunZhangData,e.xunZhangData.iniData(),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchZhaoCaiLongDate=function(t){this.zhaoCaiLongData.parser(t)},e.prototype.sendhaoCaiLongBuy=function(){var t=this.getBytes(2);this.send(t)},e.prototype.patchhaoCaiLongBuy=function(t){var e=t.readByte();this.zhaoCaiLongData.setBuyState(e),RpFun.showZhaoCaiLongRedPoint(),RpFun.showZhaoCaiLongBuyRp(),2==e&&openWin(ZhaoCaiLongActTipsWin)},e.prototype.sendhaoCaiLongReceive=function(){var t=this.getBytes(3);this.send(t)},e.prototype.patchhaoCaiLongReceive=function(t){var e=t.readShort();this.zhaoCaiLongData.setReceiveId(e),RpFun.showZhaoCaiLongRedPoint()},e.prototype.patchXunZhangDate=function(t){this.xunZhangData.parser(t)},e.prototype.sendXunZhangBuy=function(){var t=this.getBytes(12);this.send(t)},e.prototype.patchXunZhangBuy=function(t){var e=t.readByte();this.xunZhangData.setBuyState(e),RpFun.showXunZhangRedPoint(),RpFun.showXunZhangBuyRp(),2==e&&openWin(XunZhangActTipsWin)},e.prototype.sendXunZhangReceive=function(){var t=this.getBytes(13);this.send(t)},e.prototype.patchXunZhangReceive=function(t){var e=t.readShort();this.xunZhangData.setReceiveId(e),RpFun.showXunZhangRedPoint(),RpFun.showXunZhangBuyRp()},e.prototype.patchShengbeiInit=function(t){this.shengbeiData.parser(t)},e.prototype.sendShengbeiGetAward=function(){var t=this.getBytes(22);this.send(t)},e.prototype.patchShengbeiState=function(t){var e=this.shengbeiData.state;this.shengbeiData.parserState(t),1==e&&2==this.shengbeiData.state&&openWin(ShengbeiActWin),RpFun.showShengbeiRp(),RpFun.showShengbeiBuyRp()},e.prototype.sendShengbeiXiangqian=function(t){var e=this.getBytes(23);e.writeInt(t),this.send(e)},e.prototype.patchShengbeiXiangqian=function(t){var e=this.shengbeiData.parserLv(t);return RpFun.showShengbeiRpSingle(e),e},e}(BaseSys);__reflect(RechargePowerSys.prototype,"RechargePowerSys"),SystemMap.RechargePowerSys=RechargePowerSys.ins.bind(RechargePowerSys),egret.registerClass(RechargePowerSys,"RechargePowerSys"),window.RechargePowerSys=RechargePowerSys;var BuyDataNoLimit=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"maxBuyCount",{get:function(){return 9999},enumerable:!0,configurable:!0}),e}(BuyData);__reflect(BuyDataNoLimit.prototype,"BuyDataNoLimit"),window.BuyDataNoLimit=BuyDataNoLimit;var BuyDataPrices=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyCount=0,e.prices=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"maxBuyCount",{get:function(){for(var t=0,e=0,i=GFunc.getItemCount(this.consumeItemId),n=this.buyCount;n<this.prices.length;n++)t+=this.prices[n],i>=t&&e++;return e},enumerable:!0,configurable:!0}),e.prototype.getTotalPrice=function(t){for(var e=0,i=this.prices.slice(this.buyCount,this.buyCount+t),n=0;n<i.length;n++)e+=i[n];return e},e}(BuyData);__reflect(BuyDataPrices.prototype,"BuyDataPrices"),window.BuyDataPrices=BuyDataPrices;var MallItemData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.index=1,e}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(StoreItemConfig,this.index))},enumerable:!0,configurable:!0}),e.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(CurType.yb,this.getPrice())},e.prototype.getItemSell=function(){return GFunc.creatRewardDataById(this.getItemId(),this.config.count)},e.prototype.getItemId=function(){return this.config.itemId},e.prototype.getPrice=function(){return this.config.price},e.prototype.canBuy=function(){return!0},e.prototype.getLeftBuyCount=function(){return 9999},Object.defineProperty(e.prototype,"sort",{get:function(){return this.config.sort},enumerable:!0,configurable:!0}),e.prototype.sendBuy=function(t,e){var i=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.config.itemId);ShopSys.ins().sendItemShopBuy([[i.index,e]])},e.prototype.isFastBuy=function(){return 1==this.config.faseBuy},e}(ShopBaseData);__reflect(MallItemData.prototype,"MallItemData"),window.MallItemData=MallItemData;var MallSVIPData=function(){function t(){this.configIndex=1,this.buyCount=0}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(SvipStoreConfig,this.configIndex))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sort",{get:function(){return this.config.sort},enumerable:!0,configurable:!0}),t.prototype.canBuy=function(){return this.config.daycount.count>this.buyCount||0==this.config.daycount.count},t.prototype.getLeftBuyCount=function(){return this.config.daycount.count-this.buyCount},t.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(CurType.yb,this.config.yuanbao)},t.prototype.getItemId=function(){return this.config.id},t.prototype.getPrice=function(){return this.config.yuanbao},t}();__reflect(MallSVIPData.prototype,"MallSVIPData"),window.MallSVIPData=MallSVIPData;var MallXGTHData=function(){function t(){this.configIndex=1,this.buyCount=0}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(LimitStoreConfig,this.configIndex))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sort",{get:function(){return this.config.sort},enumerable:!0,configurable:!0}),t.prototype.canBuy=function(){return this.config.daycount.count>this.buyCount||0==this.config.daycount.count},t.prototype.canFreeBuy=function(){return this.canBuy()&&0==this.config.zhekou},t.prototype.getItemId=function(){return this.config.id},t.prototype.getLeftCount=function(){return this.config.daycount.count-this.buyCount},t}();__reflect(MallXGTHData.prototype,"MallXGTHData"),window.MallXGTHData=MallXGTHData;var MizangHuangguanData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(CrownStoreConfig,this.configIndex))},enumerable:!0,configurable:!0}),e}(ShopBossData);__reflect(MizangHuangguanData.prototype,"MizangHuangguanData"),window.MizangHuangguanData=MizangHuangguanData;var MizangXingshiData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(StarStoreConfig,this.configIndex))},enumerable:!0,configurable:!0}),e}(ShopBossData);__reflect(MizangXingshiData.prototype,"MizangXingshiData"),window.MizangXingshiData=MizangXingshiData;var FirstRechargeData=function(){function t(){this.firstRechargeState=0,this.firstRechargeTimer=0,this.firstRechargeItemDatas=[]}return t.prototype.patchFirstRecharge=function(t){this.firstRechargeState=t.readByte();var e=t.readInt(),i=t.readInt();this.firstRechargeTimer=Timer.ins().getTimer()+1e3*i;var n=Cfg.getConfigs(FirstRechargeConfig),a=[];a.length=n.length,MathUtil.writeIntToArray(e,a),this.firstRechargeItemDatas.length=0;for(var o=0;o<n.length;o++){var s=n[o],r=new FirstRechargeItemData;r.day=s.day,r.state=1==a[o]?2:this.firstRechargeState>=s.day?1:0,this.firstRechargeItemDatas.push(r)}},t.prototype.getCurDay=function(){for(var t=3,e=0;e<this.firstRechargeItemDatas.length;e++){var i=this.firstRechargeItemDatas[e];if(2!=i.state){t=i.day;break}}return t},t.prototype.isReceivedAll=function(){for(var t=0;t<this.firstRechargeItemDatas.length;t++){var e=this.firstRechargeItemDatas[t];if(2!=e.state)return!0}return!1},t.prototype.isRecharge=function(){return this.firstRechargeState>0},t.prototype.getFirstRechargeTimer=function(){return Math.max(0,this.firstRechargeTimer-Timer.ins().getTimer())},t.prototype.canGet=function(){return this.isRecharge()&&2!=this.firstRechargeState},t}();__reflect(FirstRechargeData.prototype,"FirstRechargeData");var FirstRechargeItemData=function(){function t(){this.day=1,this.state=0}return Object.defineProperty(t.prototype,"config",{get:function(){return Cfg.getConfig(FirstRechargeConfig,this.day)},enumerable:!0,configurable:!0}),t}();__reflect(FirstRechargeItemData.prototype,"FirstRechargeItemData");var ShopCampData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(StoreCamp,this.configIndex))},enumerable:!0,configurable:!0}),e.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(CurType.CampWar,this.config.camp)},e.prototype.getItemSell=function(){return GFunc.creatRewardDataById(this.config.id,this.config.count)},e.prototype.getSellCount=function(){return this.config.count
},e.prototype.getItemId=function(){return this.config.id},e.prototype.getPrice=function(){return this.config.camp},e.prototype.canBuy=function(){return this.buyCount<this.config.daycount.count||0==this.config.daycount.count},e.prototype.getLeftBuyCount=function(){return 0==this.config.daycount.count?9999:this.config.daycount.count-this.buyCount},e.prototype.sendBuy=function(t,e){ShopSys.ins().sendCampBuy(t,e)},e}(ShopBaseData);__reflect(ShopCampData.prototype,"ShopCampData"),window.ShopCampData=ShopCampData;var ShopDataBase=function(){function t(){this.index=0,this.curType=CurType.yb,this.curCount=0,this.buyCount=0,this.discount=0,this.isXiyou=!1,this._job=0}return Object.defineProperty(t.prototype,"config",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"job",{get:function(){return JobConst.ZhanShi},enumerable:!0,configurable:!0}),t}();__reflect(ShopDataBase.prototype,"ShopDataBase"),window.ShopDataBase=ShopDataBase;var ShopRongyuData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(StoreHonor,this.configIndex))},enumerable:!0,configurable:!0}),e.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(CurType.JJCHoner,this.config.honor)},e.prototype.getItemSell=function(){return GFunc.creatRewardDataById(this.config.id)},e.prototype.getItemId=function(){return this.config.id},e.prototype.getPrice=function(){return this.config.honor},e.prototype.canBuy=function(){return this.buyCount<this.config.daycount.count||0==this.config.daycount.count},e.prototype.getLeftBuyCount=function(){return 0==this.config.daycount.count?9999:this.config.daycount.count-this.buyCount},e}(ShopBaseData);__reflect(ShopRongyuData.prototype,"ShopRongyuData"),window.ShopRongyuData=ShopRongyuData;var ShopYongZheData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(YongzheStoreConfig,this.type,this.configIndex))},enumerable:!0,configurable:!0}),e.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(this.config.needitem,this.config.needcount)},e.prototype.getItemSell=function(){return GFunc.creatRewardDataById(this.config.id,this.config.count)},e.prototype.getItemId=function(){return this.config.id},e.prototype.getPrice=function(){return this.config.needcount},e.prototype.canBuy=function(){return this.buyCount<this.config.daycount.count||0==this.config.daycount.count},e.prototype.isGuanQin=function(){return FbSys.ins().yongZheModel.floorId-1<this.config.needcustom},e.prototype.getLeftBuyCount=function(){return 0==this.config.daycount.count?9999:this.config.daycount.count-this.buyCount},e.prototype.sendBuy=function(t,e){ShopSys.ins().sendYongZheBuy(this.type,t,e)},e.prototype.getBuyData=function(){var t=this,e=new BuyData;return e.setBuyFun(function(e){t.sendBuy(t.configIndex,e)}),e.itemId=this.getItemId(),e.price=this.getPrice(),e.consumeItemId=this.getConsumeItem().id,e.limitCount=this.getLeftBuyCount(),e.itemCount=this.getItemSell().count,e},e.prototype.isFastBuy=function(){return!1},e}(ShopBaseData);__reflect(ShopYongZheData.prototype,"ShopYongZheData"),window.ShopYongZheData=ShopYongZheData;var ShopYunBiaoData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=Cfg.getConfig(DartStoreConfig,this.configIndex))},enumerable:!0,configurable:!0}),e.prototype.getConsumeItem=function(){return GFunc.creatRewardDataById(this.config.needitem,this.config.needcount)},e.prototype.getItemSell=function(){return GFunc.creatRewardDataById(this.config.id,this.config.count)},e.prototype.getItemId=function(){return this.config.id},e.prototype.getPrice=function(){return this.config.needcount},e.prototype.canBuy=function(){return this.buyCount<this.config.daycount.count||0==this.config.daycount.count},e.prototype.getLeftBuyCount=function(){return 0==this.config.daycount.count?9999:this.config.daycount.count-this.buyCount},e.prototype.sendBuy=function(t,e){ShopSys.ins().sendYunBiaoBuy(t,e)},e.prototype.isFastBuy=function(){return!1},e}(ShopBaseData);__reflect(ShopYunBiaoData.prototype,"ShopYunBiaoData"),window.ShopYunBiaoData=ShopYunBiaoData;var FirstRechargeBtnRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="FirstRechargeBtnRenderEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgTitle.source="sc_zycs_day"+t.day},e.prototype.updateRedPoint=function(){var t=this.data;this.redPoint.visible=RpSys.ins().getData(RechargeWin1,FirstRechargePanel,e,t.day)},e}(BaseItemRender);__reflect(FirstRechargeBtnRender.prototype,"FirstRechargeBtnRender"),egret.registerClass(FirstRechargeBtnRender,"FirstRechargeBtnRender"),window.FirstRechargeBtnRender=FirstRechargeBtnRender;var MallItemPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="MallItemPanelEUI"},e.prototype.getListItemClass=function(){return MallItemPanelItem},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.listItemArr.source=SortUtil.sortOn(ShopSys.ins().mallItemDatas.concat(),["sort"]),e&&this.selectItem(this.itemId)},e.prototype.onClick=function(t){var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data,o=a.config;Cfg.getItemCfg(a.config.itemId);if(GFunc.checkCurrency(CurType.yb,o.price)){var s=new BuyData;s.setBuyFun(function(t){var e=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,a.config.itemId);ShopSys.ins().sendItemShopBuy([[e.index,t]])}),s.price=o.price,s.itemId=a.config.itemId,s.limitCount=9999,s.consumeItemId=CurType.yb,s.itemCount=o.count,openWin(BuyWin,s)}}},e.getTabTitle=function(){return"日常道具"},e}(MallBasePanel);__reflect(MallItemPanel.prototype,"MallItemPanel"),window.MallItemPanel=MallItemPanel;var MallItemPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="MallItemPanelItemEUI",e.setSkinPart("item",new ItemShop),e.setSkinPart("priceIcon",new PriceIcon),e.priceIcon.setType(CurType.yb),e}return __extends(e,t),e.prototype.dataChanged=function(){this.btnBuy.name="btnBuy_"+this.itemIndex;var t=this.data,e=t.config;this.priceIcon.setPrice(e.price),this.labelName.textFlow=GFunc.getItemName1(e.itemId),this.labelDesc.text=e.use,this.item.data=GFunc.creatRewardDataById(e.itemId,e.count),this.btnBuy.redPoint.visible=RpSys.ins().getData(ExtCom,ShopWin,MallItemPanel,e.itemId)},e}(MallItemPanelItemBase);__reflect(MallItemPanelItem.prototype,"MallItemPanelItem"),window.MallItemPanelItem=MallItemPanelItem;var FirstRechargeBuyWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="FirstRechargeBuyWinEUI",this.addBg(),this.layer=LayerMgr.Popup,this.listArray=new eui.ArrayCollection,this.list.itemRenderer=ItemBaseReward,this.list.dataProvider=this.listArray,this.mc=new MC,this.mc.touchEnabled=!1,this.entityGroup.touchEnabled=!1,this.entityGroup.addChild(this.mc),this.menuList.itemRenderer=FirstRechargeBuyWinBtnRender,this.mcIcon=new McIcon,this.groupMcIcon.addChild(this.mcIcon)},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e))for(var i=this.menuList.numElements,n=0;i>n;n++){var a=this.menuList.getElementAt(n);a&&a.updateRedPoint()}},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RechargeActSys.ins().patchFirstRecharge,this.updateReceive),this.addClickE(this.btnBuy,this.onClick),this.addClickE(this.btnReceive,this.onClick),this.addItemTapE(this.menuList,this.onMenuClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.menuList.dataProvider=new eui.ArrayCollection(RechargeActSys.ins().firstRechargeData.firstRechargeItemDatas),this.menuList.selectedIndex=RechargeActSys.ins().firstRechargeData.getCurDay()-1,this.panelIni()},e.prototype.close=function(){t.prototype.close.call(this),this.mcIcon.close()},e.prototype.updateReceive=function(){this.menuList.selectedIndex=RechargeActSys.ins().firstRechargeData.getCurDay()-1,this.updatePanel()},e.prototype.panelIni=function(){var t=this.menuList.selectedItem,e=t.config;this.btnBuy.label="充值"+Cfg.getPayMoneyRMBByYb(e.pay)+"元",this.updatePanel()},e.prototype.updatePanel=function(){var t=this.menuList.selectedItem,e=t.config;this.listArray.source=GFunc.getItemDataRewardByJob(e.awardList),this.imgDay.source="schl_zycs_"+e.day+"day",this.bitPower.text=e.power.toString(),this.imgPowerBg.visible=e.power>0,this.groupPower.visible=e.power>0;var i=Actor.ins().job,n=i-1;this.mc.playFile(ResMgr.getEffName("bigweapon"+e.mc[n]),-1),this.mcIcon.open(t.config.mcIcon),this.entityGroup.visible=1==e.day,this.groupMcIcon.visible=1!=e.day,this.imgRightGG.source="schl_zycs_day"+e.day,RechargeActSys.ins().firstRechargeData.isRecharge()?0==t.state?this.currentState="noreceive":1==t.state?this.currentState="receive":this.currentState="yireceive":this.currentState="buy"},e.prototype.onMenuClick=function(t){this.updatePanel()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnBuy:VipSys.ins().showReCharge(Cfg.getConfig(FirstRechargeConfig,1).pay);break;case this.btnReceive:var e=this.menuList.selectedItem;RechargeActSys.ins().senbFirstRecharge(e.day)}},e.getSysId=function(){return SysId.recharge},e}(BaseWin);__reflect(FirstRechargeBuyWin.prototype,"FirstRechargeBuyWin"),window.FirstRechargeBuyWin=FirstRechargeBuyWin;var MallSVIPPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="MallSVIPPanelEUI"},e.prototype.getListItemClass=function(){return MallSVIPPanelItem},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(ShopSys.ins().patchMallSVIPBuy,this.onBuy),this.addLsn(VipSys.ins().patchSvipLvChange,this.onSvipLvChange);var i=ShopSys.ins().mallSVIPDatas.concat();SortUtil.sortOn(i,["sort"]),this.listItemArr.source=i,this.itemId&&this.selectItem(this.itemId)},e.prototype.onSvipLvChange=function(){this.listItemArr.refresh()},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.onClick=function(t){var e=t.target;if(e&&(e.name.indexOf("btnBuy")>-1||e.name.indexOf("btnFree")>-1)){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data,o=a.getConsumeItem();if(a.canBuy()){if(GFunc.checkConsumeEnough(o)){var s=new BuyData;s.setBuyFun(function(t){ShopSys.ins().sendMallSVIPBuy(a.config.index,t)}),s.itemId=a.getItemId(),s.price=a.getPrice(),s.consumeItemId=o.id,s.limitCount=a.getLeftBuyCount(),openWin(BuyWin,s)}}else showtipsFail(Lang.shop_str10)}},e.getTabTitle=function(){return"SVIP专属"},e.getSysId=function(){return SysId.svip},e}(MallBasePanel);__reflect(MallSVIPPanel.prototype,"MallSVIPPanel"),window.MallSVIPPanel=MallSVIPPanel;var MallSVIPPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="MallXGTHPanelItemEUI",e.priceIconOld.setType(CurType.yb),e.priceIcon.setType(CurType.yb),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.currentState="svip",this.validateNow(),this.btnBuy.name="btnBuy_"+this.itemIndex,this.btnFree.name="btnFree_"+this.itemIndex;var e=t.config;this.priceIconOld.setPrice(e.before),this.priceIcon.setPrice(e.yuanbao),this.labelName.textFlow=GFunc.getItemName1(e.id);var i=ShopSys.ins().getDayCountName(e.daycount.type);this.labelDesc.text=i+"："+t.buyCount+"/"+e.daycount.count,this.item.data=GFunc.creatRewardDataById(e.id),this.bmpLabelDiscount.text=""+e.zhekou/10;var n=t.canBuy();this.groupFree.visible=n&&0==t.config.zhekou,this.groupDiscount.visible=n&&t.config.zhekou>0,this.labelMax.visible=!n;var a=Actor.ins().sVipLv>=e.svip;this.groupSVip.visible=!a,a||(this.imgSVIPLv.source="store_zycs_sv"+e.svip),this.btnBuy.visible=this.btnFree.visible=a},e}(MallItemPanelItemBase);__reflect(MallSVIPPanelItem.prototype,"MallSVIPPanelItem"),window.MallSVIPPanelItem=MallSVIPPanelItem;var MallXGTHPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="MallXGTHPanelEUI"},e.prototype.getListItemClass=function(){return MallXGTHPanelItem},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(ShopSys.ins().patchMallXGTHBuy,this.onBuy),this.addLsn(ShopSys.ins().patchMallXGTH,this.onRefresh),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.onRefresh(),this.itemId&&this.selectItem(this.itemId)},e.prototype.updateRp=function(t){if(!t||t.check(this.getThisDef()))for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);n&&n.updateRp()}},e.prototype.onRefresh=function(){var t=ShopSys.ins().mallXGTHDatas.concat();SortUtil.sortOn(t,["sort"]),this.listItemArr.replaceAll(t)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.onClick=function(t){var e=t.target;if(e&&(e.name.indexOf("btnBuy")>-1||e.name.indexOf("btnFree")>-1)){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;GFunc.checkCurrency(CurType.yb,a.config.yuanbao)&&ShopSys.ins().sendMallXGTHBuy(a.config.index)}},e.getTabTitle=function(){return"限购特惠"},e}(MallBasePanel);__reflect(MallXGTHPanel.prototype,"MallXGTHPanel"),window.MallXGTHPanel=MallXGTHPanel;var MallXGTHPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="MallXGTHPanelItemEUI",e.priceIconOld.setType(CurType.yb),e.priceIcon.setType(CurType.yb),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.currentState="xgth",this.btnBuy.name="btnBuy_"+this.itemIndex,this.btnFree.name="btnFree_"+this.itemIndex;var e=t.config;this.priceIconOld.setPrice(e.before),this.priceIcon.setPrice(e.yuanbao),this.labelName.textFlow=GFunc.getItemName1(e.id);var i=ShopSys.ins().getDayCountName(e.daycount.type);this.labelDesc.text=i+"："+t.buyCount+"/"+e.daycount.count,this.item.data=GFunc.creatRewardDataById(e.id,e.count),this.bmpLabelDiscount.text=""+e.zhekou/10;var n=t.canBuy();this.groupFree.visible=t.canFreeBuy(),this.groupDiscount.visible=n&&t.config.zhekou>0,this.labelMax.visible=!n,this.imgActIcon.visible=e.actday==Actor.ins().serverOpenDay,this.updateRp()},e.prototype.updateRp=function(){var t=this.data;t&&(this.btnFree.redPoint.visible=RpSys.ins().getData(ShopWin,MallPanel,MallXGTHPanel,t.configIndex))},e.prototype.removeDisplay=function(){egret.Tween.removeTweens(this.imgActIcon)},e.prototype.addDisplay=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];GFunc.zoom(this.imgActIcon,1,1.2,0,500)},e}(MallItemPanelItemBase);__reflect(MallXGTHPanelItem.prototype,"MallXGTHPanelItem"),window.MallXGTHPanelItem=MallXGTHPanelItem;var MizangHuangguanPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="MizangHuangguanPanelEUI"},e.prototype.getListItemClass=function(){return MizangHuangguanPanelItem},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItemArr.source=ShopSys.ins().huangguanDatas},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeCount),this.addLsn(ShopSys.ins().patchHuangguan,this.onRefresh),this.addLsn(ShopSys.ins().patchHuangguanBuy,this.onBuy),this.updateConsumeCount()},e.prototype.onRefresh=function(){this.listItemArr.replaceAll(ShopSys.ins().huangguanDatas)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.updateConsumeCount=function(t){var e=Cfg.getConfig(EnumConfig).huangguanId;t&&t.id!=e||(this.imgIcon.source="zycs_"+e,this.labelCount.text=Cfg.getItemCfg(e).getName()+"："+GFunc.getItemCount(e))},e.prototype.onClick=function(t){var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;if(a.canBuy()){var o=a.getConsumeItem();if(GFunc.checkConsumeEnough(o)){var s=new BuyData;s.setBuyFun(function(t){ShopSys.ins().sendHuangguanBuy(a.configIndex,t)}),s.itemId=a.getItemId(),s.price=a.getPrice(),s.consumeItemId=o.id,s.limitCount=a.getLeftBuyCount(),openWin(BuyWin,s)}}else showtipsFail(Lang.shop_str10)}},e.getTabTitle=function(){return"仙宫宝库"},e}(MallBasePanel);__reflect(MizangHuangguanPanel.prototype,"MizangHuangguanPanel"),window.MizangHuangguanPanel=MizangHuangguanPanel;var MizangHuangguanPanelItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(ShopBossPanelItem);__reflect(MizangHuangguanPanelItem.prototype,"MizangHuangguanPanelItem"),window.MizangHuangguanPanelItem=MizangHuangguanPanelItem;var MizangXingshiPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="MizangXingshiPanelEUI"},e.prototype.getListItemClass=function(){return MizangXingshiPanelItem},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItemArr.source=ShopSys.ins().xingshiDatas},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeCount),this.addLsn(ShopSys.ins().patchXingshi,this.onRefresh),this.addLsn(ShopSys.ins().patchXingshiBuy,this.onBuy),this.updateConsumeCount()},e.prototype.onRefresh=function(){this.listItemArr.replaceAll(ShopSys.ins().xingshiDatas)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.updateConsumeCount=function(t){var e=Cfg.getConfig(EnumConfig).xingshiId;t&&t.id!=e||(this.imgIcon.source="zycs_"+e,this.labelCount.text=Cfg.getItemCfg(e).getName()+"："+GFunc.getItemCount(e))},e.prototype.onClick=function(t){var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;if(a.canBuy()){var o=a.getConsumeItem();if(GFunc.checkConsumeEnough(o)){var s=new BuyData;s.setBuyFun(function(t){ShopSys.ins().sendXingshiBuy(a.configIndex,t)}),s.itemId=a.getItemId(),s.price=a.getPrice(),s.consumeItemId=o.id,s.limitCount=a.getLeftBuyCount(),openWin(BuyWin,s)}}else showtipsFail(Lang.shop_str10)}},e.getTabTitle=function(){return"龙宫宝库"},e}(MallBasePanel);__reflect(MizangXingshiPanel.prototype,"MizangXingshiPanel"),window.MizangXingshiPanel=MizangXingshiPanel;var MizangXingshiPanelItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(ShopBossPanelItem);__reflect(MizangXingshiPanelItem.prototype,"MizangXingshiPanelItem"),window.MizangXingshiPanelItem=MizangXingshiPanelItem;var ShopBossPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopBossPanelEUI"},e.prototype.getListItemClass=function(){return ShopBossPanelItem},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItemArr.source=ShopSys.ins().shopBossDatas},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeCount),this.addLsn(ShopSys.ins().patchBoss,this.onRefresh),this.addLsn(ShopSys.ins().patchBossBuy,this.onBuy),this.updateConsumeCount()},e.prototype.onRefresh=function(){this.listItemArr.replaceAll(ShopSys.ins().shopBossDatas)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.updateConsumeCount=function(t){var e=Cfg.getConfig(EnumConfig).bossJingpoId;t&&t.id!=e||(this.imgIcon.source="zycs_"+e,this.labelCount.text=Cfg.getItemCfg(e).getName()+"："+GFunc.getItemCount(e))},e.prototype.onClick=function(t){var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;if(a.canBuy()){var o=a.getConsumeItem();if(GFunc.checkConsumeEnough(o)){var s=new BuyData;s.setBuyFun(function(t){ShopSys.ins().sendBossBuy(a.configIndex,t)}),s.itemId=a.getItemId(),s.price=a.getPrice(),s.consumeItemId=o.id,s.limitCount=a.getLeftBuyCount(),openWin(BuyWin,s)}}else showtipsFail(Lang.shop_str10)}},e.getTabTitle=function(){return"BOSS商店"},e}(MallBasePanel);__reflect(ShopBossPanel.prototype,"ShopBossPanel"),window.ShopBossPanel=ShopBossPanel;var FirstRechargeBuyWinBtnRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="FirstRechargeBuyWinBtnRenderEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){this.lab=Lang.replaceEnum(LangEnum.dijitiankeling,this.data.day),this.updateRedPoint()},e.prototype.updateRedPoint=function(){this.redPoint.visible=RpSys.ins().getData(FirstRechargeBuyWin,e,this.data.day)},e}(BaseItemRender);__reflect(FirstRechargeBuyWinBtnRender.prototype,"FirstRechargeBuyWinBtnRender"),window.FirstRechargeBuyWinBtnRender=FirstRechargeBuyWinBtnRender;var ShopCampPanel=function(t){function e(){var e=t.call(this)||this;return e.initUI(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopCampPanelEUI"},e.prototype.getListItemClass=function(){return ShopCampPanelItem},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItemArr.source=ShopSys.ins().shopCampDatas},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(LogicSys.ins().patchCurrency,this.onCurrency),this.addLsn(ShopSys.ins().patchCampBuy,this.onBuy),this.onCurrency(),this.itemId&&this.selectItem(this.itemId)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.onCurrency=function(t){if(!t||t.type==CurType.CampWar){var e=Cfg.getItemCfg(CurType.CampWar);this.labelCount.text=Lang.shop_str33.replace("$name$",e.getName()).replace("$camp$",""+GFunc.overLength(Actor.ins().getCurrency(CurType.CampWar)))}},e.prototype.onClick=function(t){switch(t.target){case this.btnGoto:openWin(JJCWin);break;default:var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;a.canBuy()?GFunc.checkConsumeEnough(a.getConsumeItem())&&openWin(BuyWin,a.getBuyData()):showtipsFail(Lang.shop_str10)}}},e.getTabTitle=function(){return Lang.shop_str32},e.getSysId=function(){return SysId.ShopCamp},e}(MallBasePanel);__reflect(ShopCampPanel.prototype,"ShopCampPanel"),window.ShopCampPanel=ShopCampPanel;var ShopCampPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopCampPanelItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.btnBuy.name="btnBuy_"+this.itemIndex,this.labelName.textFlow=GFunc.getItemName1(t.config.id);var e=ShopSys.ins().getDayCountName(t.config.daycount.type);this.labelDesc.text=e+"："+t.buyCount+"/"+t.config.daycount.count,this.labelDesc.visible=0!=t.config.daycount.count;var i=t.canBuy();this.btnBuy.visible=i,this.labelMax.visible=!i,this.item.data=t.getItemSell(),this.priceIcon.setData(t.getConsumeItem())},e}(MallItemPanelItemBase);__reflect(ShopCampPanelItem.prototype,"ShopCampPanelItem"),window.ShopCampPanelItem=ShopCampPanelItem;var ShopRongyuPanel=function(t){function e(){var e=t.call(this)||this;return e.initUI(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopRongyuPanelEUI"},e.prototype.getListItemClass=function(){return ShopRongyuPanelItem},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItemArr.source=ShopSys.ins().shopRongyuDatas},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this,this.onClick),this.addLsn(LogicSys.ins().patchCurrency,this.onCurrency),this.addLsn(ShopSys.ins().patchRongyuBuy,this.onBuy),this.onCurrency(),this.itemId&&this.selectItem(this.itemId)},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.configIndex==t.configIndex&&(n.data=t)}}},e.prototype.onCurrency=function(t){if(!t||t.type==CurType.JJCHoner){var e=Cfg.getItemCfg(CurType.JJCHoner);this.labelCount.text=Lang.shop_str9.replace("$name$",e.getName()).replace("$rongyu$",""+GFunc.overLength(Actor.ins().getCurrency(CurType.JJCHoner)))}},e.prototype.onClick=function(t){switch(t.target){case this.btnGoto:openWin(JJCWin);break;default:var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data,o=a.getConsumeItem();if(a.canBuy()){if(GFunc.checkConsumeEnough(o)){var s=new BuyData;s.setBuyFun(function(t){ShopSys.ins().sendRongyuBuy(a.configIndex,t)}),s.itemId=a.getItemId(),s.price=a.getPrice(),s.consumeItemId=o.id,s.limitCount=a.getLeftBuyCount(),openWin(BuyWin,s)}}else showtipsFail(Lang.shop_str10)}}},e.getTabTitle=function(){return"荣誉商店"},e}(MallBasePanel);__reflect(ShopRongyuPanel.prototype,"ShopRongyuPanel"),window.ShopRongyuPanel=ShopRongyuPanel;var ShopRongyuPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopRongyuPanelItemEUI",e.setSkinPart("item",new ItemShop),e.setSkinPart("priceIcon",new PriceIcon),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.btnBuy.name="btnBuy_"+this.itemIndex,this.labelName.textFlow=GFunc.getItemName1(t.config.id);var e=ShopSys.ins().getDayCountName(t.config.daycount.type);this.labelDesc.text=e+"："+t.buyCount+"/"+t.config.daycount.count,this.labelDesc.visible=0!=t.config.daycount.count;var i=t.canBuy();this.btnBuy.visible=i,this.labelMax.visible=!i,this.item.data=t.getItemSell(),this.priceIcon.setData(t.getConsumeItem())},e}(MallItemPanelItemBase);__reflect(ShopRongyuPanelItem.prototype,"ShopRongyuPanelItem"),window.ShopRongyuPanelItem=ShopRongyuPanelItem;var ShopYongZheDailyPanel=function(t){function e(){var e=t.call(this)||this;return e.oldselectedIndex=-1,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopYongZhePanelEUI"},e.prototype.getListItemClass=function(){return ShopYongZheDailyPanelItem},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addClickE(this.listItem,this.onClick),this.addClickE(this.btn,this.onClick),this.addLsn(ShopSys.ins().patchYongZheBuy,this.onBuy),this.updateList(),this.updateGuanQia()},e.prototype.updateList=function(){for(var t=0,e=ShopSys.ins().shopYongZheDatas[t],i=[],n=FbSys.ins().yongZheModel.floorId-1,a=0;a<e.length;a++)e[a].config.showcustom<=n&&i.push(e[a]);t==this.oldselectedIndex?this.listItemArr.replaceAll(i):this.listItemArr.source=i},e.prototype.updateGuanQia=function(){var t=FbSys.ins().yongZheModel.floorId-1,e="";if(t){var i=Cfg.getConfig(YongzheFubenConfig,t);e=""+i.name+i.index+"关"}else{var i=Cfg.getConfig(YongzheFubenConfig,1);e=""+i.name+i.index+"关"}this.labelCount.text="当前关卡："+e},e.prototype.onClick=function(t){if(t.currentTarget==this.btn)return void openWin(FuBenWin,FuBenWin.getTabIndexbyPanel(FuBenDanRenPanel),FuBenDanRenPanel.getTabIndexbyPanel(YongZhePanel));var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;a.canBuy()?GFunc.checkConsumeEnough(a.getConsumeItem())&&openWin(BuyWin,a.getBuyData()):showtipsFail(Lang.shop_str10)}},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.type==t.type&&a.configIndex==t.configIndex&&(n.data=t)}}},e.getTitle=function(){return"btz_zycs_wybk"},e.getTabTitle=function(){return"每日限购"},e.getSysId=function(){return SysId.ShopYongZheTa},e}(MallBasePanel);__reflect(ShopYongZheDailyPanel.prototype,"ShopYongZheDailyPanel"),window.ShopYongZheDailyPanel=ShopYongZheDailyPanel;var ShopYongZheDailyPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopYongZhePanelItemEUI",e.setSkinPart("item",new ItemShop),e.setSkinPart("priceIcon",new PriceIcon),e.btnBuy.redPoint.visible=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t instanceof ShopYongZheData){if(this.btnBuy.name="btnBuy_"+this.itemIndex,this.labelName.textFlow=GFunc.getItemName1(t.config.id),t.isGuanQin()){this.lblimit.visible=!1,this.lbneedcustom.visible=!0;var e=Cfg.getConfig(YongzheFubenConfig,t.config.needcustom);this.lbneedcustom.textFlow=addColorTF(addColor(e.name+e.index+"关",15733780)+"可购买"),this.btnBuy.visible=this.labelMax.visible=!1}else{this.lbneedcustom.visible=!1,this.lblimit.visible=!0;var i=t.canBuy(),n=Lang.shop_str20;this.lblimit.text=n+"："+t.buyCount+"/"+t.config.daycount.count,this.btnBuy.visible=i,this.labelMax.visible=!i}this.item.data=t.getItemSell(),this.priceIcon.setData(t.getConsumeItem())}},e}(MallItemPanelItemBase);__reflect(ShopYongZheDailyPanelItem.prototype,"ShopYongZheDailyPanelItem"),window.ShopYongZheDailyPanelItem=ShopYongZheDailyPanelItem;var ShopYongZheFirstPanel=function(t){function e(){var e=t.call(this)||this;return e.oldselectedIndex=-1,e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShopYongZhePanelEUI"},e.prototype.getListItemClass=function(){return ShopYongZheFirstPanelItem},e.prototype.open=function(e){t.prototype.open.call(this,e),ShopSys.ins().shopYongZhefirstRed=0,RpFun.showYongZheShopRedPoint(),this.addClickE(this.listItem,this.onClick),this.addClickE(this.btn,this.onClick),this.addLsn(ShopSys.ins().patchYongZheBuy,this.onBuy),this.updateList(),this.updateGuanQia()},e.prototype.updateList=function(){for(var t=1,e=ShopSys.ins().shopYongZheDatas[t],i=[],n=FbSys.ins().yongZheModel.floorId-1,a=0;a<e.length;a++)e[a].config.showcustom<=n&&i.push(e[a]);t==this.oldselectedIndex?this.listItemArr.replaceAll(i):this.listItemArr.source=i},e.prototype.updateGuanQia=function(){var t=FbSys.ins().yongZheModel.floorId-1,e="";if(t){var i=Cfg.getConfig(YongzheFubenConfig,t);e=""+i.name+i.index+"关"}else{var i=Cfg.getConfig(YongzheFubenConfig,1);e=""+i.name+i.index+"关"}this.labelCount.text="当前关卡："+e},e.prototype.onClick=function(t){if(t.currentTarget==this.btn)return void openWin(FuBenWin,FuBenWin.getTabIndexbyPanel(FuBenDanRenPanel),FuBenDanRenPanel.getTabIndexbyPanel(YongZhePanel));var e=t.target;if(e&&e.name.indexOf("btnBuy")>-1){var i=parseInt(e.name.split("_")[1]),n=this.listItem.getElementAt(i),a=n.data;a.canBuy()?GFunc.checkConsumeEnough(a.getConsumeItem())&&openWin(BuyWin,a.getBuyData()):showtipsFail(Lang.shop_str10)}},e.prototype.onBuy=function(t){for(var e=this.listItem.numElements,i=0;e>i;i++){var n=this.listItem.getElementAt(i);if(n){var a=n.data;a.type==t.type&&a.configIndex==t.configIndex&&(n.data=t)}}},e.getTitle=function(){return"btz_zycs_wybk"},e.getTabTitle=function(){return"首通奖励"},e.getSysId=function(){return SysId.ShopYongZheTa},e}(MallBasePanel);__reflect(ShopYongZheFirstPanel.prototype,"ShopYongZheFirstPanel"),window.ShopYongZheFirstPanel=ShopYongZheFirstPanel;var ShopYongZheFirstPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopYongZhePanelItemEUI",e.setSkinPart("item",new ItemShop),e.setSkinPart("priceIcon",new PriceIcon),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t instanceof ShopYongZheData){if(this.btnBuy.name="btnBuy_"+this.itemIndex,this.labelName.textFlow=GFunc.getItemName1(t.config.id),t.isGuanQin()){this.lblimit.visible=!1,this.lbneedcustom.visible=!0;
var e=Cfg.getConfig(YongzheFubenConfig,t.config.needcustom);this.lbneedcustom.textFlow=addColorTF(addColor(e.name+e.index+"关",15733780)+"可购买"),this.btnBuy.visible=this.labelMax.visible=!1}else{this.lbneedcustom.visible=!1,this.lblimit.visible=!0;var i=t.canBuy(),n=Lang.shop_str21;this.lblimit.text=n+"："+t.buyCount+"/"+t.config.daycount.count,this.btnBuy.visible=i,this.labelMax.visible=!i}this.item.data=t.getItemSell(),this.priceIcon.setData(t.getConsumeItem())}},e}(MallItemPanelItemBase);__reflect(ShopYongZheFirstPanelItem.prototype,"ShopYongZheFirstPanelItem"),window.ShopYongZheFirstPanelItem=ShopYongZheFirstPanelItem;var ShopYongZhePanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ShopWin],e.param=null,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShopYongZheDailyPanel,ShopYongZheFirstPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(i,n){void 0===i&&(i=-1),void 0===n&&(n=null),e.openCheng(!0);var a=this.getAotuIndex(i);this.param=n,t.prototype.open.call(this,a),this.observeTabRedPoint()},e.openCheng=function(t){return t},e.prototype.close=function(){t.prototype.close.call(this),e.openCheng(!1)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setBg("sc_zycs_di2_jpg")},e.prototype.getParam=function(){return[this.param]},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn5},e.getTitle=function(){return"btz_zycs_wybk"},e.getTabTitle=function(){return"bqz_zycs_yzsc"},e.getSysId=function(){return SysId.ShopYongZheTa},__decorate([post()],e,"openCheng",null),e}(BaseTabPanel);__reflect(ShopYongZhePanel.prototype,"ShopYongZhePanel"),window.ShopYongZhePanel=ShopYongZhePanel;var FirstRechargeEveryDayPanel=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="FirstreChargeeVeryDayEUI",this.setSkinPart("panel1",new FirstRechargeEveryDayPanel1),this.setSkinPart("panel2",new FirstRechargeEveryDayPanel2),this.setSkinPart("panel3",new FirstRechargeEveryDayPanel3),this.panel1.visible=!1,this.panel2.visible=!1,this.panel3.visible=!1,this.tab.dataProvider=new eui.ArrayCollection([Lang.recharge_str1.replace("$yb$","100"),Lang.recharge_str1.replace("$yb$","500"),Lang.recharge_str1.replace("$yb$","1000")])},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.updateRp(),RechargeActSys.ins().firstRechargeEveryDay.hasGetAward()?this.setTabIndex(2):this.setTabIndex(e)},e.prototype.close=function(){t.prototype.close.call(this),this.currPanel&&this.currPanel.close()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(e))&&(this.tab.validateNow(),this.tab.getElementAt(0).redPoint.visible=RpSys.ins().getData(RechargeWin1,e,1),this.tab.getElementAt(1).redPoint.visible=RpSys.ins().getData(RechargeWin1,e,2),this.tab.getElementAt(2).redPoint.visible=RpSys.ins().getData(RechargeWin1,e,3))},e.prototype.onTabClicked=function(t){void 0===t&&(t=null),this.setTabIndex(this.tab.selectedIndex)},e.prototype.setTabIndex=function(t){this.currPanel&&this.currPanel.close(),this.currPanel=this.viewStack.getElementAt(t);var e=egret.getQualifiedClassName(this.currPanel),i=getDefinitionByName(e);i.openCheck()?(this.viewStack.selectedIndex=this.tab.selectedIndex=t,this.currPanel.open()):this.tab.selectedIndex=this.selectIndex},e.getTitle=function(){return"btz_zycs_mrsc"},e.getTabTitle=function(){return"bqz_zycs_mrsc"},e.isShow=function(){RechargeActSys.ins().isFirstRechargeEveryDay();return!0},e}(BasePanel);__reflect(FirstRechargeEveryDayPanel.prototype,"FirstRechargeEveryDayPanel"),window.FirstRechargeEveryDayPanel=FirstRechargeEveryDayPanel;var DamonModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.yinJiDatas=[],e.moZhenDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.level==this.level||(this.levelConfig=Cfg.getConfig(DamonLevelConfig,this.level)),this.levelConfig},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.level<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(DamonLevelConfig,this.level)),this.levelNextConfig},e.prototype.getStageConfig=function(){return this.stageConfig&&this.stageConfig.stagelevel==this.stageLevel||(this.stageConfig=Cfg.getConfig(DamonStageConfig,this.stageLevel)),this.stageConfig},e.prototype.getStageNextConfig=function(){return(!this.stageNextConfig||this.stageNextConfig.stagelevel<=this.stageLevel)&&(this.stageNextConfig=Cfg.getNextConfig(DamonStageConfig,this.stageLevel)),this.stageNextConfig},e.prototype.parserInfo=function(t){this.useId=t.readInt(),this.moZhenId=t.readShort(),this.level=t.readShort(),this.levelExp=t.readInt(),this.stageLevel=t.readShort(),this.stageExp=t.readInt();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var s=0;e>s;s++){var n=t.readByte(),a=t.readShort(),o=this.getYinJuDataById(n);o.setLv(a)}e=t.readByte();for(var r=0;e>r;r++){var n=t.readShort(),a=t.readShort(),o=this.getMoZhenDataById(n);o.level=a}},e.prototype.parserLevelUp=function(t){this.level=t.readShort(),this.levelExp=t.readInt()},e.prototype.parserStageUp=function(t){this.stageLevel=t.readShort(),this.stageExp=t.readInt()},e.prototype.parserHuanHuaUp=function(t){var e=t.readInt(),i=t.readShort(),n=this.getHuanHuaDataById(e);return n.level=i,n},e.prototype.parserYinJiUp=function(t){var e=t.readByte(),i=t.readShort(),n=this.getYinJuDataById(e);n.setLv(i)},e.prototype.parserMoZhenUp=function(t){var e=t.readShort(),i=t.readShort(),n=this.getMoZhenDataById(e);return n.level=i,n},e.prototype.parserHuanHua=function(t){this.useId=t.readInt()},e.prototype.parserMoZhenHuanHua=function(t){this.moZhenId=t.readShort()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new DamonHuanHuaData(t))},e.prototype.getHuanHuaDatas=function(){for(var t=[],e=0,i=Cfg.getConfig(DamonConstConfig).huanhuaIds;e<i.length;e++){var n=i[e];t.push(this.getHuanHuaDataById(n))}return t},e.prototype.getYinJuDataById=function(t){return this.yinJiDatas[t-1]||(this.yinJiDatas[t-1]=new DamonYinJiData(t))},e.prototype.getYinJuDatas=function(){return this.yinJiDatas},e.prototype.getMoZhenDataById=function(t){return this.moZhenDatas[t-1]||(this.moZhenDatas[t-1]=new DamonMoZhenData(t))},e.prototype.getMoZhenDatas=function(){return this.moZhenDatas},e.prototype.getMoZhenGroupNames=function(){return Cfg.getDamonMozhenGroupConfigNames()},e.prototype.getMoZhenDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(DamonMozhenGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getMoZhenDataById(o))}return e},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.baseAttrs.length,a=0;n>a;a++){var o=e.baseAttrs[a],s=i.baseAttrs[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},e.prototype.getStageAttrDatas=function(){for(var t=[],e=this.getStageConfig(),i=this.getStageNextConfig(),n=e.baseAttrs.length,a=0;n>a;a++){var o=e.baseAttrs[a],s=i.baseAttrs[a],r=new ComAttrData(o,s,e.stagelevel>=i.stagelevel);t.push(r)}return t},e.prototype.getYinJiAttrDatas=function(t){for(var e=[],i=t.getConfig(),n=i.baseAttrs.length,a=0;n>a;a++){var o=new AttrData(i.baseAttrs[a].type,i.baseAttrs[a].value*t.getLv()),s=new AttrData(i.baseAttrs[a].type,i.baseAttrs[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getYinJiAttrDatasAll=function(){var t=[];for(var e in this.yinJiDatas){var i=this.yinJiDatas[e],n=AttrData.attrMultiple(i.getConfig().baseAttrs,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getMoZhenAttrDatas=function(t){for(var e=[],i=t.getConfig(),n=t.getAttrsByLv(),a=t.getAttrsByLv(t.level+1),o=t.level>=i.maxLevel,s=n.length,r=0;s>r;r++){var u=new ComAttrData(n[r],a[r],o);e.push(u)}return e},e.prototype.getMoZhenDatasAll=function(){var t=[];for(var e in this.moZhenDatas){var i=this.moZhenDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getHuanHuaAttrDatas=function(t){for(var e=[],i=t.getConfig(),n=t.getAttrsByLv(),a=t.getAttrsByLv(t.level+1),o=t.level>=i.maxLevel,s=n.length,r=0;s>r;r++){var u=new ComAttrData(n[r],a[r],o);e.push(u)}return e},e.prototype.getHuanHuaAttrDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().baseAttrs)>>0},e.prototype.getStagePower=function(){return GFunc.getPower(this.getStageConfig().baseAttrs)>>0},e.prototype.getYinJinPower=function(){var t=0;for(var e in this.yinJiDatas){var i=this.yinJiDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().baseAttrs,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getMoZhenPower=function(){var t=0;for(var e in this.moZhenDatas){var i=this.moZhenDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getLevelMaxExp=function(){return this.getLevelConfig().needexp},e.prototype.getStage=function(){return this.getStageConfig().stage},e.prototype.getStageMaxExp=function(){return this.getStageConfig().needexp},e.prototype.getStart=function(t){var e=0;return t<this.getStageConfig().stage?e=this.getStarPerLevel():t==this.getStageConfig().stage?this.stageLevel>0?(e=this.stageLevel%this.getStarPerLevel(),e=e>0?e:this.getStarPerLevel()):e=0:t>this.getStageConfig().stage&&(e=0),e},e.prototype.getStarPerLevel=function(){return Cfg.getConfig(DamonConstConfig).starPerLevel},e.prototype.getStageitemid=function(){return Cfg.getConfig(DamonConstConfig).stageitemid},e.prototype.getStageitemExp=function(){return Cfg.getConfig(DamonConstConfig).stageaddexp},e.prototype.getStageskills=function(){return Cfg.getConfig(DamonConstConfig).stageskills},e.prototype.getLevelitemid=function(){return Cfg.getConfig(DamonConstConfig).levelitemid},e.prototype.getLevelitemExp=function(){return Cfg.getConfig(DamonConstConfig).leveladdexp},e.prototype.getLevelskills=function(){return Cfg.getConfig(DamonConstConfig).levelskills},e.prototype.getApperaenceId=function(){return 0},e.prototype.isMaxLv=function(){return this.getLevelConfig().level>=this.getLevelNextConfig().level},e.prototype.isMaxStage=function(){return this.getStageConfig().stagelevel>=this.getStageNextConfig().stagelevel},e.prototype.getMaxStage=function(){return Cfg.getMaxConfig(DamonStageConfig).stage},e.prototype.getZhiShengItemId=function(){return Cfg.getConfig(DamonHuanhuaBaseConfig,this.getStage()).stoneid},e.prototype.getCanUseZhiShengItemIds=function(){for(var t=[],e=Cfg.getConfigs(DamonHuanhuaBaseConfig,CondType.LessEqual,DamonHuanhuaBaseConfig.id,this.getStage()),i=0;i<e.length;i++){var n=e[i];t.push(n.stoneid)}return t},e}(DamonBaseModel);__reflect(DamonModel.prototype,"DamonModel"),window.DamonModel=DamonModel;var MoZhenActTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updatePanel=function(t,e){var i="",n="";switch(this.mc=this.mc||new MC,this.groupEntity.addChild(this.mc),e){case SysId.damon:i="jl_zycs_mz"+t.id;break;case SysId.Yongbing:i="yb_zycs_mz"+t.id;break;case SysId.Shenmo:i="shenmo_zycs_mz"+t.id}this.imgName.textFlow=(new egret.HtmlTextParser).parse(t.getName()),n=Cfg.getConfig(GuanghuanAppearanceConfig,t.getApperaenceId()).appearance,n=ResMgr.getUIFootSource(n),this.mc.playFile(n,-1),this.totalPower.text=""+t.getActPower()},e}(SqXyActTipsWin);__reflect(MoZhenActTipsWin.prototype,"MoZhenActTipsWin"),window.MoZhenActTipsWin=MoZhenActTipsWin;var ShenmoModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.yinJiDatas=[],e.moZhenDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.level==this.level||(this.levelConfig=Cfg.getConfig(ShenmoLevelConfig,this.level)),this.levelConfig},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.level<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(ShenmoLevelConfig,this.level)),this.levelNextConfig},e.prototype.getStageConfig=function(){return this.stageConfig&&this.stageConfig.stagelevel==this.stageLevel||(this.stageConfig=Cfg.getConfig(ShenmoStageConfig,this.stageLevel)),this.stageConfig},e.prototype.getStageNextConfig=function(){return(!this.stageNextConfig||this.stageNextConfig.stagelevel<=this.stageLevel)&&(this.stageNextConfig=Cfg.getNextConfig(ShenmoStageConfig,this.stageLevel)),this.stageNextConfig},e.prototype.parserInfo=function(t){this.useId=t.readInt(),this.moZhenId=t.readShort(),this.level=t.readShort(),this.levelExp=t.readInt(),this.stageLevel=t.readShort(),this.stageExp=t.readInt();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var s=0;e>s;s++){var n=t.readByte(),a=t.readShort(),o=this.getYinJuDataById(n);o.setLv(a)}e=t.readByte();for(var r=0;e>r;r++){var n=t.readShort(),a=t.readShort(),o=this.getMoZhenDataById(n);o.level=a}},e.prototype.parserLevelUp=function(t){this.level=t.readShort(),this.levelExp=t.readInt()},e.prototype.parserStageUp=function(t){this.stageLevel=t.readShort(),this.stageExp=t.readInt()},e.prototype.parserHuanHuaUp=function(t){var e=t.readInt(),i=t.readShort(),n=this.getHuanHuaDataById(e);return n.level=i,n},e.prototype.parserYinJiUp=function(t){var e=t.readByte(),i=t.readShort(),n=this.getYinJuDataById(e);n.setLv(i)},e.prototype.parserHuanHua=function(t){this.useId=t.readInt()},e.prototype.parserMoZhenUp=function(t){var e=t.readShort(),i=t.readShort(),n=this.getMoZhenDataById(e);return n.level=i,n},e.prototype.parserMoZhenHuanHua=function(t){this.moZhenId=t.readShort()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new ShenmoHuanHuaData(t))},e.prototype.getHuanHuaDatas=function(){for(var t=[],e=0,i=Cfg.getConfig(ShenmoConstConfig).huanhuaIds;e<i.length;e++){var n=i[e];t.push(this.getHuanHuaDataById(n))}return t},e.prototype.getYinJuDataById=function(t){return this.yinJiDatas[t-1]||(this.yinJiDatas[t-1]=new ShenmoYinJiData(t))},e.prototype.getYinJuDatas=function(){return this.yinJiDatas},e.prototype.getMoZhenDataById=function(t){return this.moZhenDatas[t-1]||(this.moZhenDatas[t-1]=new ShenmoMoZhenData(t))},e.prototype.getMoZhenDatas=function(){return this.moZhenDatas},e.prototype.getMoZhenGroupNames=function(){return Cfg.getShenmoMozhenGroupConfigNames()},e.prototype.getMoZhenDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(ShenmoMozhenGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getMoZhenDataById(o))}return e},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.baseAttrs.length,a=0;n>a;a++){var o=e.baseAttrs[a],s=i.baseAttrs[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},e.prototype.getStageAttrDatas=function(){for(var t=[],e=this.getStageConfig(),i=this.getStageNextConfig(),n=e.baseAttrs.length,a=0;n>a;a++){var o=e.baseAttrs[a],s=i.baseAttrs[a],r=new ComAttrData(o,s,e.stagelevel>=i.stagelevel);t.push(r)}return t},e.prototype.getYinJiAttrDatas=function(t){for(var e=[],i=t.getConfig(),n=i.baseAttrs.length,a=0;n>a;a++){var o=new AttrData(i.baseAttrs[a].type,i.baseAttrs[a].value*t.getLv()),s=new AttrData(i.baseAttrs[a].type,i.baseAttrs[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getYinJiAttrDatasAll=function(){var t=[];for(var e in this.yinJiDatas){var i=this.yinJiDatas[e],n=AttrData.attrMultiple(i.getConfig().baseAttrs,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getMoZhenAttrDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getMoZhenDatasAll=function(){var t=[];for(var e in this.moZhenDatas){var i=this.moZhenDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getHuanHuaAttrDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getHuanHuaAttrDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().baseAttrs)>>0},e.prototype.getStagePower=function(){return GFunc.getPower(this.getStageConfig().baseAttrs)>>0},e.prototype.getYinJinPower=function(){var t=0;for(var e in this.yinJiDatas){var i=this.yinJiDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().baseAttrs,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getMoZhenPower=function(){var t=0;for(var e in this.moZhenDatas){var i=this.moZhenDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getLevelMaxExp=function(){return this.getLevelConfig().needexp},e.prototype.getStage=function(){return this.getStageConfig().stage},e.prototype.getStageMaxExp=function(){return this.getStageConfig().needexp},e.prototype.getStart=function(t){var e=0;return t<this.getStageConfig().stage?e=this.getStarPerLevel():t==this.getStageConfig().stage?this.stageLevel>0?(e=this.stageLevel%this.getStarPerLevel(),e=e>0?e:this.getStarPerLevel()):e=0:t>this.getStageConfig().stage&&(e=0),e},e.prototype.getStarPerLevel=function(){return Cfg.getConfig(ShenmoConstConfig).starPerLevel},e.prototype.getStageitemid=function(){return Cfg.getConfig(ShenmoConstConfig).stageitemid},e.prototype.getStageitemExp=function(){return Cfg.getConfig(ShenmoConstConfig).stageaddexp},e.prototype.getStageskills=function(){return Cfg.getConfig(ShenmoConstConfig).stageskills},e.prototype.getLevelitemid=function(){return Cfg.getConfig(ShenmoConstConfig).levelitemid},e.prototype.getLevelitemExp=function(){return Cfg.getConfig(ShenmoConstConfig).leveladdexp},e.prototype.getLevelskills=function(){return Cfg.getConfig(ShenmoConstConfig).levelskills},e.prototype.isMaxLv=function(){return this.getLevelConfig().level>=this.getLevelNextConfig().level},e.prototype.isMaxStage=function(){return this.getStageConfig().stagelevel>=this.getStageNextConfig().stagelevel},e.prototype.getMaxStage=function(){return Cfg.getMaxConfig(ShenmoStageConfig).stage},e.prototype.getZhiShengItemId=function(){return Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.getStage()).stoneid},e.prototype.getCanUseZhiShengItemIds=function(){for(var t=[],e=Cfg.getConfigs(ShenmoHuanhuaBaseConfig,CondType.LessEqual,ShenmoHuanhuaBaseConfig.id,this.getStage()),i=0;i<e.length;i++){var n=e[i];t.push(n.stoneid)}return t},e}(DamonBaseModel);__reflect(ShenmoModel.prototype,"ShenmoModel"),window.ShenmoModel=ShenmoModel;var ShouHuHuanHuaWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[DamonHuanHuaPanel,YongbingHuanHuaPanel,ShenmoHuanHuaPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(ShouHuHuanHuaWin.prototype,"ShouHuHuanHuaWin"),window.ShouHuHuanHuaWin=ShouHuHuanHuaWin;var ShouHuNewSys=function(t){function e(){var e=t.call(this)||this;return e.damonModel=new DamonModel,e.yongbingModel=new YongbingModel,e.shenmoModel=new ShenmoModel,e.autoBianShen=!1,e.bianShenCDTick=0,e.bianShenDurationTick=0,e.bianShenCount=0,e.sysId=PackId.JingLing,e.reg(1,e.patchDamonInfo),e.reg(2,e.patchDamonLevelUp),e.reg(3,e.patchDamonStageUp),e.reg(4,e.patchDamonHuanHuaUp),e.reg(5,e.patchDamonYinJiUp),e.reg(6,e.patchDamonMoZhenUp),e.reg(7,e.patchDamonHuanHua),e.reg(8,e.patchDamonMoZhenHuanHua),e.reg(11,e.patchYongbingInfo),e.reg(12,e.patchYongbingLevelUp),e.reg(13,e.patchYongbingStageUp),e.reg(14,e.patchYongbingHuanHuaUp),e.reg(15,e.patchYongbingYinJiUp),e.reg(16,e.patchYongbingMoZhenUp),e.reg(17,e.patchYongbingHuanHua),e.reg(18,e.patchYongbingMoZhenHuanHua),e.reg(19,e.patchYongbingUseZhiSheng),e.reg(31,e.patchShenmoInfo),e.reg(32,e.patchShenmoLevelUp),e.reg(33,e.patchShenmoStageUp),e.reg(34,e.patchShenmoHuanHuaUp),e.reg(35,e.patchShenmoYinJiUp),e.reg(36,e.patchShenmoHuanHua),e.reg(37,e.patchShenmoBianShen),e.reg(38,e.patchShenmoMoZhenUp),e.reg(39,e.patchShenmoMoZhenHuanHua),e.reg(40,e.patchAutoBianShen),e.reg(41,e.patchShenmoUseZhiSheng),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchDamonInfo=function(t){this.damonModel.parserInfo(t)},e.prototype.sendDamonLevelUp=function(){this.sendBase(2)},e.prototype.patchDamonLevelUp=function(t){var e=this.damonModel.level;return this.damonModel.parserLevelUp(t),RpFun.showDamonLvRedPoint(SysId.damon),RpFun.showDamonLvSkillRedPoint(SysId.damon),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB),e<this.damonModel.level},e.prototype.sendDamonStageUp=function(){this.sendBase(3)},e.prototype.patchDamonStageUp=function(t){var e=this.damonModel.getStage();this.damonModel.parserStageUp(t);var i=this.damonModel.getStage()>e;return i&&GFunc.OpenSqXyActTipsWin(ShouHuStageActTipsWin,new DamonHuanHuaData(this.damonModel.getStage()),SysId.damon),RpFun.showDamonStageRedPoint(SysId.damon),RpFun.showDamonStageSkillRedPoint(SysId.damon),i},e.prototype.sendDamonHuanHuaUp=function(t){var e=this.getBytes(4);e.writeInt(t),this.send(e)},e.prototype.patchDamonHuanHuaUp=function(t){var e=this.damonModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.damon),RpFun.showHuanHuaRedPoint(SysId.damon)},e.prototype.sendDamonYinJiUp=function(t){var e=this.getBytes(5);e.writeByte(t),this.send(e)},e.prototype.patchDamonYinJiUp=function(t){this.damonModel.parserYinJiUp(t),RpFun.showYinJiRedPoint(SysId.DamonYinji)},e.prototype.sendDamonMoZhenUp=function(t){var e=this.getBytes(6);e.writeShort(t),this.send(e)},e.prototype.patchDamonMoZhenUp=function(t){var e=this.damonModel.parserMoZhenUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(MoZhenActTipsWin,e,SysId.damon),RpFun.showMoZhenRedPoint(SysId.DamonMozhen)},e.prototype.sendDamonHuanHua=function(t){var e=this.getBytes(7);e.writeInt(t),this.send(e)},e.prototype.patchDamonHuanHua=function(t){this.damonModel.parserHuanHua(t)},e.prototype.sendDamonMoZhenHuanHua=function(t){var e=this.getBytes(8);e.writeShort(t),this.send(e)},e.prototype.patchDamonMoZhenHuanHua=function(t){this.damonModel.parserMoZhenHuanHua(t)},e.prototype.sendDamonUseZhiSheng=function(t){var e=this.getBytes(9);e.writeShort(t),this.send(e)},e.prototype.patchDamonUseZhiSheng=function(t){this.damonModel.parserStageUp(t)},e.prototype.patchYongbingInfo=function(t){this.yongbingModel.parserInfo(t)},e.prototype.sendYongbingLevelUp=function(){this.sendBase(12)},e.prototype.patchYongbingLevelUp=function(t){var e=this.yongbingModel.level;return this.yongbingModel.parserLevelUp(t),RpFun.showDamonLvRedPoint(SysId.Yongbing),RpFun.showDamonLvSkillRedPoint(SysId.Yongbing),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB),e<this.yongbingModel.level},e.prototype.sendYongbingStageUp=function(){this.sendBase(13)},e.prototype.patchYongbingStageUp=function(t){var e=this.yongbingModel.getStage();this.yongbingModel.parserStageUp(t);var i=this.yongbingModel.getStage()>e;return i&&GFunc.OpenSqXyActTipsWin(ShouHuStageActTipsWin,new YongbingHuanHuaData(this.yongbingModel.getStage()),SysId.Yongbing),RpFun.showDamonStageRedPoint(SysId.Yongbing),RpFun.showDamonStageSkillRedPoint(SysId.Yongbing),i},e.prototype.sendYongbingHuanHuaUp=function(t){var e=this.getBytes(14);e.writeInt(t),this.send(e)},e.prototype.patchYongbingHuanHuaUp=function(t){var e=this.yongbingModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.Yongbing),RpFun.showHuanHuaRedPoint(SysId.Yongbing)},e.prototype.sendYongbingYinJiUp=function(t){var e=this.getBytes(15);e.writeByte(t),this.send(e)},e.prototype.patchYongbingYinJiUp=function(t){this.yongbingModel.parserYinJiUp(t),RpFun.showYinJiRedPoint(SysId.YongbingYinji)},e.prototype.sendYongbingMoZhenUp=function(t){var e=this.getBytes(16);e.writeShort(t),this.send(e)},e.prototype.patchYongbingMoZhenUp=function(t){var e=this.yongbingModel.parserMoZhenUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(MoZhenActTipsWin,e,SysId.Yongbing),RpFun.showMoZhenRedPoint(SysId.YongbingMozhen)},e.prototype.sendYongbingHuanHua=function(t){var e=this.getBytes(17);e.writeInt(t),this.send(e)},e.prototype.patchYongbingHuanHua=function(t){this.yongbingModel.parserHuanHua(t)},e.prototype.sendYongbingMoZhenHuanHua=function(t){var e=this.getBytes(18);e.writeShort(t),this.send(e)},e.prototype.patchYongbingMoZhenHuanHua=function(t){this.yongbingModel.parserMoZhenHuanHua(t)},e.prototype.sendYongbingUseZhiSheng=function(t){var e=this.getBytes(19);e.writeShort(t),this.send(e)},e.prototype.patchYongbingUseZhiSheng=function(t){this.yongbingModel.parserStageUp(t)},e.prototype.patchShenmoInfo=function(t){this.shenmoModel.parserInfo(t)},e.prototype.sendShenmoLevelUp=function(){this.sendBase(32)},e.prototype.patchShenmoLevelUp=function(t){var e=this.shenmoModel.level;return this.shenmoModel.parserLevelUp(t),RpFun.showDamonLvRedPoint(SysId.Shenmo),RpFun.showDamonLvSkillRedPoint(SysId.Shenmo),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB),e<this.shenmoModel.level},e.prototype.sendShenmoStageUp=function(){this.sendBase(33)},e.prototype.patchShenmoStageUp=function(t){var e=this.shenmoModel.getStage();this.shenmoModel.parserStageUp(t);var i=this.shenmoModel.getStage()>e;return i&&GFunc.OpenSqXyActTipsWin(ShouHuStageActTipsWin,new ShenmoHuanHuaData(this.shenmoModel.getStage()),SysId.Shenmo),RpFun.showDamonStageRedPoint(SysId.Shenmo),RpFun.showDamonStageSkillRedPoint(SysId.Shenmo),i},e.prototype.sendShenmoHuanHuaUp=function(t){var e=this.getBytes(34);e.writeInt(t),this.send(e)},e.prototype.patchShenmoHuanHuaUp=function(t){var e=this.shenmoModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.Shenmo),RpFun.showHuanHuaRedPoint(SysId.Shenmo)},e.prototype.sendShenmoYinJiUp=function(t){var e=this.getBytes(35);e.writeByte(t),this.send(e)},e.prototype.patchShenmoYinJiUp=function(t){this.shenmoModel.parserYinJiUp(t),RpFun.showYinJiRedPoint(SysId.ShenmoYinji)},e.prototype.sendShenmoHuanHua=function(t){var e=this.getBytes(36);e.writeInt(t),this.send(e)},e.prototype.patchShenmoHuanHua=function(t){this.shenmoModel.parserHuanHua(t)},e.prototype.sendShenmoBianShen=function(){if(GFunc.checkSysOpen(SysId.Shenmo)){var t=this.getBytes(37);t.writeShort(this.shenmoModel.useId),this.send(t)}},e.prototype.patchShenmoBianShen=function(t){var e=t.readInt(),i=t.readInt();this.bianShenCDTick=e+Timer.ins().getTimer(),this.bianShenDurationTick=i+Timer.ins().getTimer(),this.bianShenCount=t.readByte(),this.bianShenGuider()},e.prototype.sendShenmoMoZhenUp=function(t){var e=this.getBytes(38);e.writeShort(t),this.send(e)},e.prototype.patchShenmoMoZhenUp=function(t){var e=this.shenmoModel.parserMoZhenUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(MoZhenActTipsWin,e,SysId.Shenmo),RpFun.showMoZhenRedPoint(SysId.ShenmoMozhen)},e.prototype.sendShenmoMoZhenHuanHua=function(t){var e=this.getBytes(39);e.writeShort(t),this.send(e)},e.prototype.patchShenmoMoZhenHuanHua=function(t){this.shenmoModel.parserMoZhenHuanHua(t)},e.prototype.bianShenGuider=function(){this.canBianshen()&&GFunc.isInEquipBossFb()&&!e.ins().autoBianShen&&12==TaskSys.ins().taskId&&0==TaskSys.ins().mainTaskStatus&&Timer.ins()["do"](this.bianshenDurationTime,0,1,this.showGuideBianshen,this,TimerType.NONE)},e.prototype.showGuideBianshen=function(){GuiderBianShen.ins().show(GFunc.creatGuideData(GuideType.Week,GuiderId.Id1036))},e.prototype.resetTime=function(){Timer.ins().remove(this.showGuideBianshen,this),this.bianShenDurationTick=999999,GuiderBianShen.ins().closeById(GuiderId.Id1036)},e.prototype.canBianshen=function(){return this.shenmoModel.useId>0},e.prototype.chekBianshen=function(){return this.bianshenDurationTime<=0&&this.canBianshen()},Object.defineProperty(e.prototype,"bianshenCdTime",{get:function(){return Math.max(0,this.bianShenCDTick-Timer.ins().getTimer())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bianshenDurationTime",{get:function(){return Math.max(0,this.bianShenDurationTick-Timer.ins().getTimer())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowBianShenBtn",{get:function(){return this.canBianshen()?this.bianshenCdTime>0?!0:this.bianshenDurationTime>0?!1:!0:!1},enumerable:!0,configurable:!0}),e.prototype.getModelBySysId=function(t){var e=null;switch(t){case SysId.damon:case SysId.DamonYinji:case SysId.DamonMozhen:e=this.damonModel;break;case SysId.Yongbing:case SysId.YongbingYinji:case SysId.YongbingMozhen:e=this.yongbingModel;break;case SysId.Shenmo:case SysId.ShenmoYinji:case SysId.ShenmoMozhen:e=this.shenmoModel}return e},e.prototype.sendAutoBianShen=function(t){this.autoBianShen=t;var e=this.getBytes(40);e.writeByte(t?1:0),this.send(e)},e.prototype.patchAutoBianShen=function(t){this.autoBianShen=1==t.readByte()},e.prototype.sendShenmoUseZhiSheng=function(t){var e=this.getBytes(41);e.writeShort(t),this.send(e)},e.prototype.patchShenmoUseZhiSheng=function(t){this.shenmoModel.parserStageUp(t)},e}(BaseSys);__reflect(ShouHuNewSys.prototype,"ShouHuNewSys"),SystemMap.ShouHuNewSys=ShouHuNewSys.ins.bind(ShouHuNewSys),window.ShouHuNewSys=ShouHuNewSys;var ShouHuStageActTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updatePanel=function(e,i){t.prototype.updatePanel.call(this,e,i)},e}(SqXyActTipsWin);__reflect(ShouHuStageActTipsWin.prototype,"ShouHuStageActTipsWin"),window.ShouHuStageActTipsWin=ShouHuStageActTipsWin;var ShouHuWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[DamonPanel,YongbingPanel,ShenmoPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e,i){t.prototype.open.call(this,e,i),this.panelTabIndex=-1},e.prototype.getYongbingPanelBtnSend=function(){return this.getPanel(YongbingPanel).getYongbingLevelPanelBtnSend()},e.prototype.getYongbingStagePanelBtnSend=function(){return this.getPanel(YongbingPanel).getYongbingStagePanelBtnSend()},e.prototype.getgetYongbingStagePanel=function(){return this.getPanel(YongbingPanel).getYongbingStagePanel()},e.prototype.getYongbingStagePanelTabBtn=function(){return this.getgetYongbingStagePanel().getTab(YongbingStagePanel)},e.prototype.getDamonLevelPanel_BtnSend=function(){return this.getPanel(DamonPanel).getDamonLevelPanel_BtnSend()},e.prototype.getDamonStagePanel_BtnSend=function(){return this.getPanel(DamonPanel).getDamonStagePanel_BtnSend()},e.prototype.getDamonStagePanel_Tab=function(){return this.getPanel(DamonPanel).getTab(DamonStagePanel)},e.prototype.getShenmoLevelPanel_BtnSend=function(){return this.getPanel(ShenmoPanel).getShenmoLevelPanel_BtnSend()},e.prototype.getShenmoStagePanel_BtnSend=function(){return this.getPanel(ShenmoPanel).getShenmoStagePanel_BtnSend()},e}(BaseDuoPanelWin);__reflect(ShouHuWin.prototype,"ShouHuWin"),window.ShouHuWin=ShouHuWin;var YongbingModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.yinJiDatas=[],e.moZhenDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.level==this.level||(this.levelConfig=Cfg.getConfig(YongbingLevelConfig,this.level)),this.levelConfig
},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.level<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(YongbingLevelConfig,this.level)),this.levelNextConfig},e.prototype.getStageConfig=function(){return this.stageConfig&&this.stageConfig.stagelevel==this.stageLevel||(this.stageConfig=Cfg.getConfig(YongbingStageConfig,this.stageLevel)),this.stageConfig},e.prototype.getStageNextConfig=function(){return(!this.stageNextConfig||this.stageNextConfig.stagelevel<=this.stageLevel)&&(this.stageNextConfig=Cfg.getNextConfig(YongbingStageConfig,this.stageLevel)),this.stageNextConfig},e.prototype.parserInfo=function(t){this.useId=t.readInt(),this.moZhenId=t.readShort(),this.level=t.readShort(),this.levelExp=t.readInt(),this.stageLevel=t.readShort(),this.stageExp=t.readInt();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var s=0;e>s;s++){var n=t.readByte(),a=t.readShort(),o=this.getYinJuDataById(n);o.setLv(a)}e=t.readByte();for(var r=0;e>r;r++){var n=t.readShort(),a=t.readShort(),o=this.getMoZhenDataById(n);o.level=a}},e.prototype.parserLevelUp=function(t){this.level=t.readShort(),this.levelExp=t.readInt()},e.prototype.parserStageUp=function(t){this.stageLevel=t.readShort(),this.stageExp=t.readInt()},e.prototype.parserHuanHuaUp=function(t){var e=t.readInt(),i=t.readShort(),n=this.getHuanHuaDataById(e);return n.level=i,n},e.prototype.parserYinJiUp=function(t){var e=t.readByte(),i=t.readShort(),n=this.getYinJuDataById(e);n.setLv(i)},e.prototype.parserMoZhenUp=function(t){var e=t.readShort(),i=t.readShort(),n=this.getMoZhenDataById(e);return n.level=i,n},e.prototype.parserHuanHua=function(t){this.useId=t.readInt()},e.prototype.parserMoZhenHuanHua=function(t){this.moZhenId=t.readShort()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new YongbingHuanHuaData(t))},e.prototype.getHuanHuaDatas=function(){for(var t=[],e=0,i=Cfg.getConfig(YongbingConstConfig).huanhuaIds;e<i.length;e++){var n=i[e];t.push(this.getHuanHuaDataById(n))}return t},e.prototype.getYinJuDataById=function(t){return this.yinJiDatas[t-1]||(this.yinJiDatas[t-1]=new YongbingYinJiData(t))},e.prototype.getYinJuDatas=function(){return this.yinJiDatas},e.prototype.getMoZhenDataById=function(t){return this.moZhenDatas[t-1]||(this.moZhenDatas[t-1]=new YongbingMoZhenData(t))},e.prototype.getMoZhenDatas=function(){return this.moZhenDatas},e.prototype.getMoZhenGroupNames=function(){return Cfg.getYongbingMozhenGroupConfigNames()},e.prototype.getMoZhenDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(YongbingMozhenGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getMoZhenDataById(o))}return e},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.baseAttrs.length,a=0;n>a;a++){var o=e.baseAttrs[a],s=i.baseAttrs[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},e.prototype.getStageAttrDatas=function(){for(var t=[],e=this.getStageConfig(),i=this.getStageNextConfig(),n=e.baseAttrs.length,a=0;n>a;a++){var o=e.baseAttrs[a],s=i.baseAttrs[a],r=new ComAttrData(o,s,e.stagelevel>=i.stagelevel);t.push(r)}return t},e.prototype.getYinJiAttrDatas=function(t){for(var e=[],i=t.getConfig(),n=i.baseAttrs.length,a=0;n>a;a++){var o=new AttrData(i.baseAttrs[a].type,i.baseAttrs[a].value*t.getLv()),s=new AttrData(i.baseAttrs[a].type,i.baseAttrs[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getYinJiAttrDatasAll=function(){var t=[];for(var e in this.yinJiDatas){var i=this.yinJiDatas[e],n=AttrData.attrMultiple(i.getConfig().baseAttrs,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getMoZhenAttrDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getMoZhenDatasAll=function(){var t=[];for(var e in this.moZhenDatas){var i=this.moZhenDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getHuanHuaAttrDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getHuanHuaAttrDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().baseAttrs)>>0},e.prototype.getStagePower=function(){return GFunc.getPower(this.getStageConfig().baseAttrs)>>0},e.prototype.getYinJinPower=function(){var t=0;for(var e in this.yinJiDatas){var i=this.yinJiDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().baseAttrs,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getMoZhenPower=function(){var t=0;for(var e in this.moZhenDatas){var i=this.moZhenDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getLevelMaxExp=function(){return this.getLevelConfig().needexp},e.prototype.getStage=function(){return this.getStageConfig().stage},e.prototype.getStageMaxExp=function(){return this.getStageConfig().needexp},e.prototype.getStart=function(t){var e=0;return t<this.getStageConfig().stage?e=this.getStarPerLevel():t==this.getStageConfig().stage?this.stageLevel>0?(e=this.stageLevel%this.getStarPerLevel(),e=e>0?e:this.getStarPerLevel()):e=0:t>this.getStageConfig().stage&&(e=0),e},e.prototype.getStarPerLevel=function(){return Cfg.getConfig(YongbingConstConfig).starPerLevel},e.prototype.getStageitemid=function(){return Cfg.getConfig(YongbingConstConfig).stageitemid},e.prototype.getStageitemExp=function(){return Cfg.getConfig(YongbingConstConfig).stageaddexp},e.prototype.getStageskills=function(){return Cfg.getConfig(YongbingConstConfig).stageskills},e.prototype.getLevelitemid=function(){return Cfg.getConfig(YongbingConstConfig).levelitemid},e.prototype.getLevelitemExp=function(){return Cfg.getConfig(YongbingConstConfig).leveladdexp},e.prototype.getLevelskills=function(){return Cfg.getConfig(YongbingConstConfig).levelskills},e.prototype.isMaxLv=function(){return this.getLevelConfig().level>=this.getLevelNextConfig().level},e.prototype.isMaxStage=function(){return this.getStageConfig().stagelevel>=this.getStageNextConfig().stagelevel},e.prototype.getMaxStage=function(){return Cfg.getMaxConfig(YongbingStageConfig).stage},e.prototype.getZhiShengItemId=function(){return Cfg.getConfig(YongbingHuanhuaBaseConfig,this.getStage()).stoneid},e.prototype.getCanUseZhiShengItemIds=function(){for(var t=[],e=Cfg.getConfigs(YongbingHuanhuaBaseConfig,CondType.LessEqual,YongbingHuanhuaBaseConfig.id,this.getStage()),i=0;i<e.length;i++){var n=e[i];t.push(n.stoneid)}return t},e}(DamonBaseModel);__reflect(YongbingModel.prototype,"YongbingModel"),window.YongbingModel=YongbingModel;var DamonHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(DamonHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){isNaN(t)&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return 0},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return this.id==ShouHuNewSys.ins().getModelBySysId(SysId.damon).useId},e}(BaseHuanHuaData);__reflect(DamonHuanHuaData.prototype,"DamonHuanHuaData"),window.DamonHuanHuaData=DamonHuanHuaData;var DamonMoZhenData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(DamonMozhenBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){isNaN(t)&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return this.getConfig().appearanceId},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return this.id==ShouHuNewSys.ins().getModelBySysId(SysId.damon).moZhenId},e}(BaseHuanHuaData);__reflect(DamonMoZhenData.prototype,"DamonMoZhenData"),window.DamonMoZhenData=DamonMoZhenData;var DamonYinJiData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(DamonPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(DamonPillMaxConfig,this.id,CondType.More,DamonPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(DamonPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("jlyj_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"jl_zycs_yj"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().baseAttrs},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(DamonYinJiData.prototype,"DamonYinJiData"),window.DamonYinJiData=DamonYinJiData;var RankDataGuaJi=function(t){function e(){var e=t.call(this)||this;return e.guan=0,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e),this.guan=e.readDouble()},e.prototype.getRankStr=function(){return""+this.guan},e}(RankData);__reflect(RankDataGuaJi.prototype,"RankDataGuaJi"),window.RankDataGuaJi=RankDataGuaJi;var FirstRechargeEveryDayPanel2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="FirstreChargeeVeryDayEUI2",this.index=2},e}(FirstRechargeEveryDayPanel1);__reflect(FirstRechargeEveryDayPanel2.prototype,"FirstRechargeEveryDayPanel2"),window.FirstRechargeEveryDayPanel2=FirstRechargeEveryDayPanel2;var FirstRechargeEveryDayPanel3=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="FirstreChargeeVeryDayEUI3",this.index=3},e}(FirstRechargeEveryDayPanel1);__reflect(FirstRechargeEveryDayPanel3.prototype,"FirstRechargeEveryDayPanel3"),window.FirstRechargeEveryDayPanel3=FirstRechargeEveryDayPanel3;var DamonPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ShouHuWin],e}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=-1);var i=this.getAotuIndex(e);t.prototype.open.call(this,i),this.observeTabRedPoint()},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="DamonPanelEUI"},e.getTitle=function(){return"btz_zycs_jingling"},e.getTabTitle=function(){return"bqz_zycs_fairy"},e.getSysId=function(){return SysId.damon},e.prototype.getDamonLevelPanel_BtnSend=function(){return this.getPanel(DamonLevelPanel).getBtnSend()},e.prototype.getDamonStagePanel_BtnSend=function(){return this.getPanel(DamonStagePanel).getBtnSend()},e.panelNames=[DamonLevelPanel,DamonStagePanel,DamonYinJiPanel,DamonMoZhenPanel],e}(BaseTabPanel);__reflect(DamonPanel.prototype,"DamonPanel"),window.DamonPanel=DamonPanel;var FirstRechargeEveryDayWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[FirstRechargeEveryDayPanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg()},e}(BaseWinAutoTab);__reflect(FirstRechargeEveryDayWin.prototype,"FirstRechargeEveryDayWin"),window.FirstRechargeEveryDayWin=FirstRechargeEveryDayWin;var FirstRechargePanel=function(t){function e(){var e=t.call(this)||this;return e.btnRecharges=[],e.lbRecharges=[],e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="FirstRechargePanelEUI",this.menuList.itemRenderer=FirstRechargeBtnRender,this.list.itemRenderer=ItemBaseRewardActivity,this.list.dataProvider=this.listAwardCollection=new eui.ArrayCollection,this.btnRecharges=[this.btnRecharge1,this.btnRecharge2,this.btnRecharge3,this.btnRecharge4],this.lbRecharges=[this.lbRecharge1,this.lbRecharge2,this.lbRecharge3,this.lbRecharge4],this.mc3=new MC,this.mc3.x=560,this.mc3.y=320,this.mc3.touchEnabled=!1,this.addChild(this.mc3),this.mc2=new MC,this.mc2.x=295,this.mc2.y=295,this.mc2.touchEnabled=!1,this.addChild(this.mc2),this.mc1=new MC,this.mc1.x=150,this.mc1.y=295,this.mc1.touchEnabled=!1,this.addChild(this.mc1)},e.prototype.open=function(){t.prototype.open.call(this),this.addItemTapE(this.menuList,this.onMenuClick),this.addClickE(this.btnOk,this.onClick),this.addClickE(this.btnRecharge1,this.onClick),this.addClickE(this.btnRecharge2,this.onClick),this.addClickE(this.btnRecharge3,this.onClick),this.addClickE(this.btnRecharge4,this.onClick),this.addLsn(RechargeActSys.ins().patchFirstRecharge,this.update),this.addLsn(RpSys.ins().patchRp,this.updateRedPoint),this.menuList.dataProvider=new eui.ArrayCollection(Cfg.getConfigs(FirstRechargeConfig)),this.update()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.onMenuClick=function(t){this.updatePanel()},e.prototype.update=function(){this.menuList.validateNow(),this.updatePanel(),this.updateRedPoint()},e.prototype.updateRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(e))for(var i=this.menuList.numElements,n=0;i>n;n++){var a=this.menuList.getElementAt(n);a&&a.updateRedPoint()}},e.prototype.updatePanel=function(){this.config=Cfg.getConfig(FirstRechargeConfig,this.menuList.selectedIndex+1);var t=Actor.ins().job,i=t-1;this.groupPower.visible=this.config.power>0,this.imgDay.source="sc_zycs_day"+this.config.day,this.mc1.playFile(ResMgr.getEffName("sc"+this.config.mc[0][i%this.config.mc[0].length]),-1),this.mc2.playFile(ResMgr.getEffName("sc"+this.config.mc[1][i%this.config.mc[1].length]),-1),this.mc3.playFile(ResMgr.getEffName("sc"+this.config.mc[2][i%this.config.mc[2].length]),-1),this.imgName1.source=ResMgr.getFirstRechargeRes(this.config.name[0][0]),this.imgName2.source=ResMgr.getFirstRechargeRes(this.config.name[1][0]),this.imgName3.source=ResMgr.getFirstRechargeRes(this.config.name[2][0]),this.bmpPower.text=this.config.power.toString();var n=GFunc.getItemDataRewardByJob(this.config.awardList);this.listAwardCollection.replaceAll(n),this.btnOk.redPoint.visible=RpSys.ins().getData(RechargeWin1,e,FirstRechargeBtnRender,this.config.day),this.updateStatsu()},e.prototype.updateStatsu=function(){var t=RechargeActSys.ins().firstRechargeData;t.isRecharge()?t.firstRechargeState>=this.config.day?t.canGet()?this.currentState="get":this.currentState="yetget":this.currentState="day":this.currentState="nobuy"},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOk:break;default:this.btnRecharges.indexOf(t.currentTarget)}},e.getTitle=function(){return"btz_zycs_schl"},e.getTabTitle=function(){return"bqz_zycs_fbsc"},e.isShow=function(){var t=RechargeActSys.ins().firstRechargeData.canGet();return t},e}(BasePanel);__reflect(FirstRechargePanel.prototype,"FirstRechargePanel"),window.FirstRechargePanel=FirstRechargePanel;var ShenmoHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){void 0===t&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return 0},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return this.id==ShouHuNewSys.ins().getModelBySysId(SysId.Shenmo).useId},e}(BaseHuanHuaData);__reflect(ShenmoHuanHuaData.prototype,"ShenmoHuanHuaData"),window.ShenmoHuanHuaData=ShenmoHuanHuaData;var ShenmoMoZhenData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(ShenmoMozhenBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){void 0===t&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return this.getConfig().appearanceId},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return this.id==ShouHuNewSys.ins().getModelBySysId(SysId.Shenmo).moZhenId},e}(BaseHuanHuaData);__reflect(ShenmoMoZhenData.prototype,"ShenmoMoZhenData"),window.ShenmoMoZhenData=ShenmoMoZhenData;var ShenmoYinJiData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(ShenmoPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(ShenmoPillMaxConfig,this.id,CondType.More,ShenmoPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(ShenmoPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("shenmo_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"shenmo_zycs_yj"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().baseAttrs},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(ShenmoYinJiData.prototype,"ShenmoYinJiData"),window.ShenmoYinJiData=ShenmoYinJiData;var FirstRechargeTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="FirstRechargeTipsWinEUI",t.prototype.initUI.call(this),this.layer=LayerMgr.Main_Down,this.mc=new MC,this.mc.touchEnabled=!1,this.groupEntity.addChild(this.mc)},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.imgBg,this.onClick),Timer.ins()["do"](1e4,1e3,1,this.countDown,this);var e=Cfg.getConfig(FirstRechargeConfig,1);this.mc.playFile(ResMgr.getEffName("bigweapon"+e.mc[Actor.ins().job-1]),-1)},e.prototype.countDown=function(){closeWin(e)},e.prototype.onClick=function(t){closeWin(e),openWin(FirstRechargeBuyWin)},e.prototype.addToParent=function(t){this.addToParentAt(t,0)},e}(BaseWinSingle);__reflect(FirstRechargeTipsWin.prototype,"FirstRechargeTipsWin"),window.FirstRechargeTipsWin=FirstRechargeTipsWin;var ShenMoEntityPlayWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.open.call(this,e,i,EntityType.BIANSHEN),this.currentState="shenmo"},e.prototype.updateView=function(){t.prototype.updateView.call(this);var e=this.getDesc(this.skillConfig);e=e.replace("{c1}",""),e=e.replace("{c2}",""),this.lbDesc.textFlow=StrUtil.toTF(e)},e}(EntityPlayWin);__reflect(ShenMoEntityPlayWin.prototype,"ShenMoEntityPlayWin"),window.ShenMoEntityPlayWin=ShenMoEntityPlayWin;var ShenmoHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.setSkinPart("skillItem0",new ShenMoSkillItem),e.setSkinPart("skillItem1",new ShenMoSkillItem),e.groupSkill.visible=!0,e.imgBg.source="shenmo_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.skillItem0,this.onClick),this.addClickE(this.skillItem1,this.onClick),this.addLsn(ShouHuNewSys.ins().patchShenmoHuanHuaUp,this.updateUp),this.addLsn(ShouHuNewSys.ins().patchShenmoHuanHua,this.updateHuanHua)},e.prototype.updataMC=function(){t.prototype.updataMC.call(this);var e=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.data.id);this.skillItem0.data=Cfg.getConfig(SkillsConfig,e.skillid[0]),this.skillItem1.data=Cfg.getConfig(SkillsConfig,e.skillid[1])},e.prototype.getModel=function(){var t=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.data.id).uibody;return[t]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));GFunc.checkConsumeEnough(e)&&ShouHuNewSys.ins().sendShenmoHuanHuaUp(this.data.id);break;case this.btnHuanHua:ShouHuNewSys.ins().sendShenmoHuanHua(this.data.id);break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getHuanHuaAttrDatasAll());break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,72).text);break;case this.skillItem0:case this.skillItem1:var i=t.currentTarget.data,n=new EntityBianshenData;n.bianshenId=this.data.id,n.type=EntityType.BIANSHEN,openWin(ShenMoEntityPlayWin,i,n)}},e.getTitle=function(){return"btz_zycs_sm"},e.getTabTitle=function(){return"bqz_zycs_smhh"},e.getSysId=function(){return SysId.Shenmo},e}(DamonHuanHuaPanel);__reflect(ShenmoHuanHuaPanel.prototype,"ShenmoHuanHuaPanel"),window.ShenmoHuanHuaPanel=ShenmoHuanHuaPanel;var ShenmoLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=70,e.imgBg.source="shenmo_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchShenmoLevelUp,this.updateLevelUp),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill)},e.prototype.getModel=function(){var t=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.dataModel.useId).uibody;return[t]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1))&&ShouHuNewSys.ins().sendShenmoLevelUp();break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1))?this.isChanging||ShouHuNewSys.ins().sendShenmoLevelUp():this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Shenmo},e}(DamonLevelPanel);__reflect(ShenmoLevelPanel.prototype,"ShenmoLevelPanel"),window.ShenmoLevelPanel=ShenmoLevelPanel;var ShenmoMoZhenPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.helpId=87,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchShenmoMoZhenUp,this.updateHuanHuaUp),this.addLsn(ShouHuNewSys.ins().patchShenmoMoZhenHuanHua,this.updateHuanHua)},e.prototype.getNameRes=function(){return"shenmo_zycs_mz"+this.data.id},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:if(this.data.isMax())return void showtipsFail(Lang.common_str38);var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));GFunc.checkConsumeEnough(e)&&ShouHuNewSys.ins().sendShenmoMoZhenUp(this.data.id);break;case this.btnHuanHua:ShouHuNewSys.ins().sendShenmoMoZhenHuanHua(this.data.id);break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getMoZhenDatasAll(),ComAttrTitleEnum.ShenmoMoZhen);break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.getSysId=function(){return SysId.ShenmoMozhen},e}(DamonMoZhenPanel);__reflect(ShenmoMoZhenPanel.prototype,"ShenmoMoZhenPanel"),window.ShenmoMoZhenPanel=ShenmoMoZhenPanel;var ShenmoPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ShouHuWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShenmoLevelPanel,ShenmoStagePanel,ShenmoYinJiPanel,ShenmoMoZhenPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="DamonPanelEUI"},e.getTitle=function(){return"btz_zycs_sm"},e.getTabTitle=function(){return"bqz_zycs_sm"},e.getSysId=function(){return SysId.Shenmo},e.prototype.getShenmoLevelPanel_BtnSend=function(){return this.getPanel(ShenmoLevelPanel).getBtnSend()},e.prototype.getShenmoStagePanel_BtnSend=function(){return this.getPanel(ShenmoStagePanel).getBtnSend()},e}(BaseTabPanel);__reflect(ShenmoPanel.prototype,"ShenmoPanel"),window.ShenmoPanel=ShenmoPanel;var ShenMoSkillItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShenMoSkillItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source=ResMgr.getSkillResourceItemName1(t.icon),this.lbName.text=t.name},e.prototype.setRedPoint=function(t){this.imgRedPoint.visible=t},e}(BaseItemRender);__reflect(ShenMoSkillItem.prototype,"ShenMoSkillItem"),window.ShenMoSkillItem=ShenMoSkillItem;var ShenmoStagePanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=71,e.setSkinPart("skillItem0",new ShenMoSkillItem),e.setSkinPart("skillItem1",new ShenMoSkillItem),e.imgBg.source="shenmo_zycs_bg2_jpg",e.groupSkill.visible=!0,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.skillItem0,this.onClick),this.addClickE(this.skillItem1,this.onClick),this.addLsn(ShouHuNewSys.ins().patchShenmoStageUp,this.updatePanelUp),this.addLsn(ShouHuNewSys.ins().patchShenmoHuanHua,this.updateHuanhua)},e.prototype.updataMC=function(){t.prototype.updataMC.call(this);var e=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.curStage);this.skillItem0.data=Cfg.getConfig(SkillsConfig,e.skillid[0]),this.skillItem1.data=Cfg.getConfig(SkillsConfig,e.skillid[1])},e.prototype.getModel=function(){var t=Cfg.getConfig(ShenmoHuanhuaBaseConfig,this.curStage),e=t.uibody,i=t.name;return this.imgStage=i,[e]},e.prototype.getNameRes=function(){return"shenmo_zycs__sm"+this.curStage},e.prototype.updateConsumeZhiSheng=function(t){t.cfg.type==ItemType.SMSJS&&this.updateZhiSheng()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1))&&ShouHuNewSys.ins().sendShenmoStageUp();break;case this.btnGengHuan:ShouHuNewSys.ins().sendShenmoHuanHua(this.curStage);break;case this.btnHuanHua:openWin(ShouHuHuanHuaWin,ShouHuHuanHuaWin.getTabIndexbyPanel(ShenmoHuanHuaPanel));break;case this.skillItem0:case this.skillItem1:var e=t.currentTarget.data,i=new EntityBianshenData;i.bianshenId=this.curStage,i.type=EntityType.BIANSHEN,openWin(ShenMoEntityPlayWin,e,i);break;case this.btnUseZhiSheng:var n=this.itemZhiSheng.data;ShouHuNewSys.ins().sendShenmoUseZhiSheng(Cfg.getConfig(ShenmoHuanhuaBaseConfig,CondType.Equal,ShenmoHuanhuaBaseConfig.stoneid,n.id).id)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1))?ShouHuNewSys.ins().sendShenmoStageUp():this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Shenmo},e}(DamonStagePanel);__reflect(ShenmoStagePanel.prototype,"ShenmoStagePanel"),window.ShenmoStagePanel=ShenmoStagePanel;var ShenmoYinJiPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.helpId=73,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchShenmoYinJiUp,this.updatePanel)},e.prototype.sendPack=function(){ShouHuNewSys.ins().sendShenmoYinJiUp(this.data.id)},e.prototype.getComAttrTitleEnum=function(){return ComAttrTitleEnum.ShenmoYinJi},e.getSysId=function(){return SysId.ShenmoYinji},e}(DamonYinJiPanel);__reflect(ShenmoYinJiPanel.prototype,"ShenmoYinJiPanel"),window.ShenmoYinJiPanel=ShenmoYinJiPanel;var YongbingHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(YongbingHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){void 0===t&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name},e.prototype.getQuality=function(){return this.getConfig().quality
},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return 0},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return this.id==ShouHuNewSys.ins().getModelBySysId(SysId.Yongbing).useId},e}(BaseHuanHuaData);__reflect(YongbingHuanHuaData.prototype,"YongbingHuanHuaData"),window.YongbingHuanHuaData=YongbingHuanHuaData;var YongbingMoZhenData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(YongbingMozhenBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){void 0===t&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return this.getConfig().appearanceId},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return this.id==ShouHuNewSys.ins().getModelBySysId(SysId.Yongbing).moZhenId},e}(BaseHuanHuaData);__reflect(YongbingMoZhenData.prototype,"YongbingMoZhenData"),window.YongbingMoZhenData=YongbingMoZhenData;var YongbingYinJiData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(YongbingPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(YongbingPillMaxConfig,this.id,CondType.More,YongbingPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(YongbingPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("ybyj_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"yb_zycs_yj"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().baseAttrs},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(YongbingYinJiData.prototype,"YongbingYinJiData"),window.YongbingYinJiData=YongbingYinJiData;var YongbingHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.imgBg.source="yb_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchYongbingHuanHuaUp,this.updateUp),this.addLsn(ShouHuNewSys.ins().patchYongbingHuanHua,this.updateHuanHua)},e.prototype.getModel=function(){var t=Cfg.getConfig(YongbingHuanhuaBaseConfig,this.data.id).uibody;return[t]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));GFunc.checkConsumeEnough(e)&&ShouHuNewSys.ins().sendYongbingHuanHuaUp(this.data.id);break;case this.btnHuanHua:ShouHuNewSys.ins().sendYongbingHuanHua(this.data.id);break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getHuanHuaAttrDatasAll());break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,61).text)}},e.getTitle=function(){return"btz_zycs_yb"},e.getTabTitle=function(){return"bqz_zycs_ybhh"},e.getSysId=function(){return SysId.Yongbing},e}(DamonHuanHuaPanel);__reflect(YongbingHuanHuaPanel.prototype,"YongbingHuanHuaPanel"),window.YongbingHuanHuaPanel=YongbingHuanHuaPanel;var YongbingLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=59,e.imgBg.source="yb_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchYongbingLevelUp,this.updateLevelUp),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill)},e.prototype.getModel=function(){var t=Cfg.getConfig(YongbingHuanhuaBaseConfig,this.dataModel.useId).uibody;return[t]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1))&&ShouHuNewSys.ins().sendYongbingLevelUp();break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getLevelitemid(),1))?this.isChanging||ShouHuNewSys.ins().sendYongbingLevelUp():this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Yongbing},e}(DamonLevelPanel);__reflect(YongbingLevelPanel.prototype,"YongbingLevelPanel"),window.YongbingLevelPanel=YongbingLevelPanel;var YongbingMoZhenPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=63,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchYongbingMoZhenUp,this.updateHuanHuaUp),this.addLsn(ShouHuNewSys.ins().patchYongbingMoZhenHuanHua,this.updateHuanHua)},e.prototype.getNameRes=function(){return""+this.data.id},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:if(this.data.isMax())return void showtipsFail(Lang.common_str38);var e=(Actor.ins().job,GFunc.getItemDataRewardByJob(this.data.getConsume()));GFunc.checkConsumeEnough(e)&&ShouHuNewSys.ins().sendYongbingMoZhenUp(this.data.id);break;case this.btnHuanHua:ShouHuNewSys.ins().sendYongbingMoZhenHuanHua(this.data.id);break;case this.btnAttr:openWin(ComAttrWin,this.dataModel.getMoZhenDatasAll(),ComAttrTitleEnum.YongbingMoZhen);break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.getSysId=function(){return SysId.YongbingMozhen},e}(DamonMoZhenPanel);__reflect(YongbingMoZhenPanel.prototype,"YongbingMoZhenPanel"),window.YongbingMoZhenPanel=YongbingMoZhenPanel;var YongbingPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ShouHuWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[YongbingLevelPanel,YongbingStagePanel,YongbingYinJiPanel,YongbingMoZhenPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="DamonPanelEUI"},e.getTitle=function(){return"btz_zycs_yb"},e.getTabTitle=function(){return"bqz_zycs_yb"},e.getSysId=function(){return SysId.Yongbing},e.prototype.getYongbingLevelPanelBtnSend=function(){return this.getPanel(YongbingLevelPanel).getBtnSend()},e.prototype.getYongbingStagePanelBtnSend=function(){return this.getPanel(YongbingStagePanel).getBtnSend()},e.prototype.getYongbingStagePanel=function(){return this.getPanel(YongbingStagePanel)},e.prototype.getYongbingLevelPanel=function(){return this.getPanel(YongbingLevelPanel)},e.prototype.getYongbingYinJiPanel=function(){return this.getPanel(YongbingYinJiPanel)},e.prototype.getYongbingMoZhenPanel=function(){return this.getPanel(YongbingMoZhenPanel)},e}(BaseTabPanel);__reflect(YongbingPanel.prototype,"YongbingPanel"),window.YongbingPanel=YongbingPanel;var YongbingStagePanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=60,e.imgBg.source="yb_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchYongbingStageUp,this.updatePanelUp),this.addLsn(ShouHuNewSys.ins().patchYongbingHuanHua,this.updateHuanhua)},e.prototype.getModel=function(){var t=Cfg.getConfig(YongbingHuanhuaBaseConfig,this.curStage),e=t.uibody,i=t.name;return this.imgStage=i,[e]},e.prototype.getNameRes=function(){return"yb_zycs_"+this.curStage},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1))&&ShouHuNewSys.ins().sendYongbingStageUp();break;case this.btnGengHuan:ShouHuNewSys.ins().sendYongbingHuanHua(this.curStage);break;case this.btnHuanHua:openWin(ShouHuHuanHuaWin,ShouHuHuanHuaWin.getTabIndexbyPanel(YongbingHuanHuaPanel));break;case this.btnUseZhiSheng:var e=this.itemZhiSheng.data;ShouHuNewSys.ins().sendYongbingUseZhiSheng(Cfg.getConfig(YongbingHuanhuaBaseConfig,CondType.Equal,YongbingHuanhuaBaseConfig.stoneid,e.id).id)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(GFunc.creatRewardDataById(this.dataModel.getStageitemid(),1))?ShouHuNewSys.ins().sendYongbingStageUp():this.longPressBtnUp.stop()},e.prototype.updateConsumeZhiSheng=function(t){t.cfg.type==ItemType.YBSJS&&this.updateZhiSheng()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Yongbing},e}(DamonStagePanel);__reflect(YongbingStagePanel.prototype,"YongbingStagePanel"),window.YongbingStagePanel=YongbingStagePanel;var YongbingYinJiPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=62,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ShouHuNewSys.ins().patchYongbingYinJiUp,this.updatePanel)},e.prototype.sendPack=function(){ShouHuNewSys.ins().sendYongbingYinJiUp(this.data.id)},e.prototype.getComAttrTitleEnum=function(){return ComAttrTitleEnum.YongbingYinJi},e.getSysId=function(){return SysId.YongbingYinji},e}(DamonYinJiPanel);__reflect(YongbingYinJiPanel.prototype,"YongbingYinJiPanel"),window.YongbingYinJiPanel=YongbingYinJiPanel;var AoyiModel=function(){function t(){this.tabTypes=[],this.aoyiDatas=[],this.aoyiTypeBySkillId={}}return t.prototype.iniData=function(){this.aoyiTypeBySkillId.length=0;var t=Cfg.getConfigs2(AoyiConfig,CondType.NONE);for(var e in t)for(var i in t[e])this.aoyiTypeBySkillId[+i]=+e},t.prototype.getTypeBySkillId=function(t){var e=this.aoyiTypeBySkillId[t];return e},t.prototype.getTabTypes=function(){return this.tabTypes&&0!=this.tabTypes.length||(this.tabTypes=Cfg.getConfigKeys(AoyiConfig)),this.tabTypes},t.prototype.getAoyiDatasByType=function(t){var e=this.aoyiDatas[t];if(!e||0==e.length){e=[];var i=Cfg.getConfigs(AoyiConfig,t,CondType.NONE);for(var n in i){var a=new AoyiData(i[n]);e.push(a)}this.aoyiDatas[t]=e}return e},t}();__reflect(AoyiModel.prototype,"AoyiModel");var SkillSys=function(t){function e(){var e=t.call(this)||this;return e.skillDatas=[],e.skillMaxLv=0,e.skillDataFuzhus=[],e.monsterSkillIds={},e.buffDatas=[],e.skillPassivityDatas=[],e.hunqiDatas=[],e.awakeLevel=1,e.awakeExp=1,e.tongji=new SkillDamageTongji,e.bmpNumbers=[],e.flyingNumbers=[],e.sysId=PackId.Skill,e.reg(1,e.doSkillResult),e.reg(2,e.patchAddBuff),e.reg(3,e.patchRemoveBuff),e.reg(4,e.patchSkillUp),e.reg(5,e.patchSkillUpOneKey),e.reg(6,e.doAddEffect),e.reg(7,e.doRemoveEffect),e.reg(8,e.patchSkillInfo),e.reg(11,e.doClearCD),e.reg(12,e.patchShenYouSkillAdd),e.reg(13,e.patchPlayEff),e.reg(50,e.patchAddBuffUI),e.reg(51,e.patchRemoveBuffUI),e.reg(60,e.patchSkillPassivityInfo),e.reg(61,e.patchSkillPassivityUp),e.reg(70,e.patchHunqiData),e.reg(71,e.patchHunqiUp),e.aoyiModel=new AoyiModel,e.aoyiModel.iniData(),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.sendUseSkill=function(t,e,i,n,a){if(void 0===a&&(a=0),(0==i||i!=i>>0)&&t!=t>>0||n.skillConfig.selfEff.length>0){var o=this.getBytes(1);LogicSys.ins().getEntityByHandle(t),LogicSys.ins().getEntityByHandle(e);o.writeDouble(t),o.writeDouble(e),o.writeInt(n.skillConfig.id),o.writeInt(a),this.send(o)}else VirtualServer.ins().sendUseSkill(t,e,i,n)},e.prototype.doSkillResult=function(t){var e=this,i=new SkillDamageData;i.parser(t);var n=LogicSys.ins().getEntityByHandle(i.senderHandle),a=LogicSys.ins().getEntityByHandle(i.targetHandle);if(n&&a){var o=Cfg.getConfig(SkillsConfig,i.skillId);if(n.masterHandle!=Actor.ins().handle){n.AI.playOtherEntityAction(o,a,0);var s=EntityType.isMonster(n.entityType)||getLocation(LocationKey.ISSHOWTHEREFF,LocationValue.Boolean)&&FbSys.ins().fubenGroupConfig.isShowOtherEff;s?n.AI.playActionMovie(o,0,a,function(){e.doSkillResultByData(i)}):this.doSkillResultByData(i)}else o.actionParam[0].isLight&&n.masterHandle==Actor.ins().handle&&MapContainer.ins().isShow()&&!ShouHuNewSys.ins().autoBianShen&&GFunc.playLight(),this.doSkillResultByData(i);n instanceof EntityRole&&a.masterHandle==Actor.ins().handle&&n.masterHandle!=Actor.ins().handle?openWin(BeAtkedWin):n instanceof EntityFriendMonster&&n.getHP()/n.getHpMax()<=.5&&openWin(BeAtkedWin)}},e.prototype.doSkillResultByData=function(t){var e=this;if(MapContainer.ins().isShow())for(var i=t.skillDamageRanges.length,n=Cfg.getConfig(SkillsConfig,t.skillId),a=function(i){var a=t.skillDamageRanges[i],s=a.handle,r=a.damageType,u=a.value;if(r==DamageTypes.BLANK||r==DamageTypes.FS&&Math.abs(u)<100)return"continue";var h=LogicSys.ins().getEntityByHandle(s);if(!h)return{value:void 0};h instanceof EntityMonster&&h.isBoss()?FbSys.ins().fubenGroupConfig.isShowBossBlood||h.setHpAndNameVisible(!1):(t.isMyDamage||t.isTeamDamage)&&h.setHpAndNameVisible(!0),r!=DamageTypes.MISS&&r!=DamageTypes.FS&&(h instanceof EntityMonster&&(h.addAtkedEffect(t.skillId),t.isMyDamage&&h.addSlightFilter()),h.AI.startAtked(t.senderHandle));for(var p=1,l=n.actionParam,c=r!=DamageTypes.MISS&&r!=DamageTypes.FS?l&&l[0].damagePart||1:1,d=Math.floor(u/c),g=0;c>g;g++)(EntityType.isMonster(h.entityType)||EntityType.isRole(h.entityType)||EntityType.isBianshen(h.entityType))&&t.isMyDamage?Timer.ins()["do"](p,0,1,function(){e.showBlood(d,a)},o):(h.masterHandle==Actor.ins().handle&&Timer.ins()["do"](p,0,1,function(){e.showBlood1(d,a)},o),window.Server&&window.Server.isOpenMyDamage&&Timer.ins()["do"](p,0,1,function(){e.showBlood(d,a)},o)),p+=200},o=this,s=0;i>s;s++){var r=a(s);if("object"==typeof r)return r.value}},e.prototype.clear=function(){this.bmpNumbers.length=0,this.flyingNumbers.length=0},e.prototype.getFlyNumber=function(){var t;return t=this.flyingNumbers.length<=30?this.bmpNumbers.length?this.bmpNumbers.shift():new BitmapNumber:this.flyingNumbers.shift(),t.reset(),this.flyingNumbers.push(t),t},e.prototype.showBlood=function(t,e){var i=this.getFlyNumber();if(MapContainer.ins().addBlood(i),e.damageType==DamageTypes.MISS)i.setWordSource("miss1");else{var n=ResMgr.getDamageWord0Resource(e.senderType);e.damageType!=DamageTypes.ZMYJ&&i.setWord0Source(n);var a=ResMgr.getDamagerWordResource(e.damageType);a&&i.setWordSource(n+a),i.setNumber(t,ResMgr.getEntityDamageNumType(e.senderType,e.damageType),-15)}this.fly(i,e)},e.prototype.showBlood1=function(t,e){var i=e.damageType,n=i==DamageTypes.MISS||i==DamageTypes.ZD||i==DamageTypes.CFYS||i==DamageTypes.CFPJ||i==DamageTypes.CFJS||i==DamageTypes.CFZD||i==DamageTypes.WWSH||i==DamageTypes.HUIXUE,a=i==DamageTypes.ZD||i==DamageTypes.HUIXUE;if(n){var o=this.getFlyNumber();MapContainer.ins().addBlood(o),o.setWord0Source(ResMgr.getDamageWord0Resource(e.senderType)),o.setWordSource(ResMgr.getDamagerWordResource(i)),a&&o.setNumber(t,ResMgr.getDamageNumberType(i),-15),this.fly(o,e)}},e.prototype.showMyBlood=function(t,e){var i=e.damageType,n=i==DamageTypes.MISS||i==DamageTypes.ZD||i==DamageTypes.CFYS||i==DamageTypes.CFPJ||i==DamageTypes.CFJS||i==DamageTypes.CFZD||i==DamageTypes.WWSH||i==DamageTypes.HUIXUE,a=i==DamageTypes.ZD||i==DamageTypes.HUIXUE;if(n){var o=this.getFlyNumber();MapContainer.ins().addBlood(o),o.setWord0Source(ResMgr.getDamageWord0Resource(e.senderType)),o.setWordSource(ResMgr.getDamagerWordResource(i)),a&&o.setNumber(t,ResMgr.getDamageNumberType(i)),this.fly(o,e)}},e.prototype.fly=function(t,e){if(getLocation(LocationKey.ISSHOWHIT,LocationValue.Boolean)||e.damageType!=DamageTypes.HIT){var i=new EntityXY;i.x=e.targetPos.x,i.y=e.targetPos.y,i.dir=DirUtil.get8Dir(e.senderPos,e.targetPos);var n=ResMgr.getDamageTweenB(e);this.playFlyNumber(t,i,n)}},e.prototype.playFlyNumber=function(t,e,i,n){void 0===n&&(n=null);var a=Cfg.getTweenSourceName();if(RES.hasRes(a)){var o=RES.getRes(a);if(o){var s=o[i];null==s&&console.log("缺少飘字轨迹:"+i),SkillEditor.ins().playFlyNumberByCfg(t,e,s,n)}else t.visible=!1,RES.getResAsync(a,function(a){var o=a[i];return o?(t.visible=!0,void SkillEditor.ins().playFlyNumberByCfg(t,e,o,n)):void console.log("没有这个飞行轨迹 -- "+i)},this)}},e.prototype.showExp=function(t,e,i){var n=ObjPool.pop(BitmapNumber);MapContainer.ins().addBlood(n);var a="";e>0&&(a="("+e+"%)"),n.setWordSource(ResMgr.getDamagerWordResource(DamageTypes.EXP)),n.setNumber("+"+t+a,ResMgr.getDamageNumberType(DamageTypes.EXP),-5);var o={damageType:DamageTypes.EXP,senderType:0,senderPos:i,targetPos:i};this.fly(n,o)},e.prototype.patchAddBuff=function(t){var e=t.readDouble(),i=new BuffData;i.parser(t),LogicSys.ins().addBuff(e,i.buffId)},e.prototype.patchAddBuffUI=function(t){t.readByte();var e=new BuffData;e.parser(t),this.buffDatas.push(e)},e.prototype.patchRemoveBuffUI=function(t){t.readByte();for(var e=t.readInt(),i=0;i<this.buffDatas.length;i++)if(this.buffDatas[i].buffId==e){this.buffDatas.splice(i,1);break}},e.prototype.sendRemoveBuff=function(t,e){var i=this.getBytes(3);i.writeDouble(t),i.writeInt(e),this.send(i)},e.prototype.patchRemoveBuff=function(t){var e=t.readDouble(),i=t.readInt();LogicSys.ins().removeBuff(e,i)},e.prototype.doAddEffect=function(t){t.readDouble(),t.readInt()},e.prototype.doRemoveEffect=function(t){t.readDouble(),t.readInt()},e.prototype.patchSkillInfo=function(t){var e=t.readShort();this.skillDatas.length=e;for(var i=0;e>i;i++){var n=new SkillData;n.index=i,n.parser(t),this.skillDatas[i]=n}},e.prototype.sendSkillUp=function(t){var e=this.getBytes(4);e.writeShort(t),this.send(e)},e.prototype.patchSkillUp=function(t){var e=t.readInt(),i=t.readShort(),n=this.getSkillDataById(e);if(n){var a=n.level;if(n.level=i,n.isUp=!0,RpFun.showSkillSingleRp(n),0==a){var o=new DuiLieFlyItemData,s=this.createFlyItem(e);o.setData(s,function(){var t=JobSys.ins().getIconXy(getWin(MainUIButton).getBtnSkill(),s);return t=LayerMgr.Top.globalToLocal(t.x,t.y)},this,SkillActFlyWin,e),o.setOrder(5),DuiLieSys.ins().flyData.addFlyData(o)}}else console.log("2-4仙术id:"+e+",数据不存在");return RpFun.showActRp(SysId.KFCB),n},e.prototype.createFlyItem=function(t){var e=new eui.Image;return e.width=e.height=85,e.source=ResMgr.getSkillResourceItemName(Cfg.getConfig(SkillsConfig,t).icon,!0,!0),e},e.prototype.sendSkillUpOneKey=function(){this.sendBase(5)},e.prototype.patchSkillUpOneKey=function(t){for(var e=t.readShort(),i=0;e>i;i++){var n=t.readShort(),a=t.readShort(),o=this.getSkillDataById(n);o?o.level!=a&&(o.level=a,o.isUp=!0,RpFun.showSkillSingleRp(o)):console.log("2-5仙术id:"+n+",数据不存在")}RpFun.showActRp(SysId.KFCB)},e.prototype.doClearCD=function(t){t.readDouble();var e=t.readByte();if(e)for(var i=0;e>i;i++)for(var n=t.readInt(),a=0,o=this.skillDatas;a<o.length;a++){var s=o[a];if(s.skillId==n){s.skillCDTick=0;break}}else for(var r=0,u=this.skillDatas;r<u.length;r++){var h=u[r];h.skillCDTick=0}},e.prototype.patchShenYouSkillAdd=function(t){var e=t.readDouble(),i=new SkillData;i.parser1(t);var n=t.readInt();this.skillDataFuzhus.push(i),0!=n&&this.removeFuZhuSKillBySkillId(n);var a=LogicSys.ins().getEntityByHandle(e);a&&(0!=n&&a.AI.removeSKillBySkillId(n),a.AI.addSkillData(i)),console.log("神佑辅AI技能添加 2-12 技能ID:"+i.skillId)},e.prototype.patchPlayEff=function(t){var e=t.readDouble(),i=t.readInt(),n=LogicSys.ins().getEntityByHandle(e),a=!1;if(n){var o=new SkillEditorData;o.effectId=i.toString(),o.configs=Cfg.getSkillEditorConfig(i.toString()),o.isShow=!0,o.sender.copy(n),SkillEditor.ins().play(o),a=!0}console.log("2-13 播放特效ID:"+i+" handle:"+e+" 是否成功:"+a)},e.prototype.removeFuZhuSKillBySkillId=function(t){for(var e=0;e<this.skillDataFuzhus.length;e++){var i=this.skillDataFuzhus[e];i.skillId==t&&this.skillDataFuzhus.splice(e,1)}},e.prototype.getSkillDataByIndex=function(t){return this.skillDatas[t]},e.prototype.getSkillDataById=function(t){for(var e=0;e<this.skillDatas.length;e++)if(this.skillDatas[e].skillId==t)return this.skillDatas[e];return null},e.prototype.getSkillTotalLv=function(){for(var t=0,e=0,i=this.skillDatas;e<i.length;e++){var n=i[e];t+=n.level}return t},e.prototype.createSkillData=function(t,e,i){var n=new SkillData;return n.level=i,n.skillId=t,n},e.prototype.sendSkilBuy=function(t,e){var i=this.getBytes(42);i.writeShort(0),i.writeShort(t+1),i.writeShort(e),this.send(i)},e.prototype.patchSkillPassivityInfo=function(t){for(var e=t.readShort(),i=0;e>i;i++){var n=this.getSkillPassivityDataById(t.readInt());n.level=t.readShort(),n.level>0?n.isOpen=1:n.isOpen=0}},e.prototype.sendSkillPassivityUp=function(t){var e=this.getBytes(61);e.writeInt(t),this.send(e)},e.prototype.patchSkillPassivityUp=function(t){var e=this.getSkillPassivityDataById(t.readInt());e.level=t.readShort(),RpFun.showSkillPassivityRedPoint(e)},e.prototype.getSkillPassivityDataById=function(t){return this.skillPassivityDatas[t]||(this.skillPassivityDatas[t]=new SkillPassivityData(t))},e.prototype.getSkillPassivityDatasByIds=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var a=n[i];e.push(this.getSkillPassivityDataById(a))}return e},e.prototype.isSkillPassivityUp=function(t){var e=!1;if(!t.isMax()){var i=t.getConfig().item;e=i&&i.id?GFunc.isConsumeEnough(i):!0,e=e&&this.getSkillPassivityUpValue(t)>=t.getConfig().typeLevel}return e},e.prototype.getSkillPassivityUpValue=function(t){var e=Number.MAX_VALUE;switch(t.getConfig().typeUp){case SkillPassiveType.ShenQi:e=SqXySys.ins().shenQiModel.level;break;case SkillPassiveType.DamonLevel:e=ShouHuNewSys.ins().damonModel.level;break;case SkillPassiveType.DamonStage:e=ShouHuNewSys.ins().damonModel.stageLevel;break;case SkillPassiveType.ChiBang:e=SqXySys.ins().wingModel.level;break;case SkillPassiveType.YongbingLevel:e=ShouHuNewSys.ins().yongbingModel.level;break;case SkillPassiveType.YongbingStage:e=ShouHuNewSys.ins().yongbingModel.stageLevel;break;case SkillPassiveType.Sz:e=SqXySys.ins().szModel.level;break;case SkillPassiveType.Meilin:e=SqXySys.ins().meilinModel.level;break;case SkillPassiveType.ShenmoLevel:e=ShouHuNewSys.ins().shenmoModel.level;break;case SkillPassiveType.ShenmoStage:e=ShouHuNewSys.ins().shenmoModel.stageLevel;break;case SkillPassiveType.Foot:e=FootSys.ins().getHuanHuaDataById(t.param).minEquipLv;break;case SkillPassiveType.Xianlu:e=XianLuSys.ins().isJieYuan()?t.getConfig().typeLevel:-1;break;case SkillPassiveType.ShenYouYinJi:e=QiyuSys.ins().shenYouData.yinjiLevel;break;case SkillPassiveType.ShenYouSkill:e=QiyuSys.ins().shenYouData.rank;break;default:e=0}return e},e.prototype.getSkillPassivityRedPointKey=function(t){var e=[];switch(t.getConfig().typeUp){case SkillPassiveType.ShenQi:e=[RoleWin,RolePanel,SqXyWin,ShenQiPanel,ShenQiLevelPanel];break;case SkillPassiveType.DamonLevel:e=[ShouHuWin,DamonPanel,DamonLevelPanel];break;case SkillPassiveType.DamonStage:e=[ShouHuWin,DamonPanel,DamonStagePanel];break;case SkillPassiveType.ChiBang:e=[RoleWin,RolePanel,SqXyWin,WingPanel,WingLevelPanel];break;case SkillPassiveType.YongbingLevel:e=[ShouHuWin,YongbingPanel,YongbingLevelPanel];break;case SkillPassiveType.YongbingStage:e=[ShouHuWin,YongbingPanel,YongbingStagePanel];break;case SkillPassiveType.Sz:e=[RoleWin,RolePanel,SqXyWin,SzPanel,SzLevelPanel];break;case SkillPassiveType.Meilin:e=[RoleWin,RolePanel,SqXyWin,MeilinPanel,MeilinLevelPanel];break;case SkillPassiveType.ShenmoLevel:e=[ShouHuWin,ShenmoPanel,ShenmoLevelPanel];break;case SkillPassiveType.ShenmoStage:e=[ShouHuWin,ShenmoPanel,ShenmoStagePanel];break;case SkillPassiveType.Aoyi:var i=this.aoyiModel.getTypeBySkillId(t.id);e=[SkillWin,SkillMainPanel,AoyiPanel,i];break;case SkillPassiveType.Foot:e=[RoleWin,RolePanel,ZhuangBanWin,FootPanel,FootMiYuPanel,t.param];break;case SkillPassiveType.Xianlu:e=[XianLuWin,XianluPanel]}return e=e.concat("skillUp",t.id)},e.prototype.getSkillPassivityLevelStr=function(t){var e="",i=t.getConfig().typeLevel,n=0;switch(t.getConfig().typeUp){case SkillPassiveType.DamonStage:n=Cfg.getConfig(DamonConstConfig).starPerLevel;break;case SkillPassiveType.YongbingStage:n=Cfg.getConfig(YongbingConstConfig).starPerLevel;break;case SkillPassiveType.ShenmoStage:n=Cfg.getConfig(ShenmoConstConfig).starPerLevel}return n?(e+=GFunc.getChineseNum(Math.floor(i/n)+1)+Lang.common_jie,e+=GFunc.getChineseNum(i%n)+Lang.common_xing):e+=i,e},e.prototype.getSkillPassivityUpDec=function(t){for(var e=this.getSkillPassivityUpValue(t[0]),i=[],n=0,a=t;n<a.length;n++){var o=a[n];if(!o.isMax()){var s=Cfg.getConfigs(SkillPassiveConfig,o.id,CondType.NONE);for(var r in s)if(s[r].typeLevel>e){i.push(s[r]);break}}}var u="";if(i.length>0){SortUtil.sortOn(i,["typeLevel"],[SortType.up]);var h=i[0],p=h.typeLevel-e;u=Lang.skill_str29+" "+addColor(p+Lang.common_ji,16768297)+" "+Lang.skill_str30,u+=addColor("【"+h.name+"】"+(h.level+1)+Lang.common_ji,16768297)}return u},e.prototype.patchHunqiData=function(t){this.awakeLevel=t.readShort(),this.awakeExp=t.readInt();var e=t.readByte();this.hunqiDatas.length=e;for(var i=0;e>i;i++){var n=new HunqiData;n.parser(t),this.hunqiDatas[i]=n}this.skillMaxLv=Cfg.getConfig(HunqiAwakeConfig,this.awakeLevel).skillmax},e.prototype.sendHunqiUp=function(t){var e=this.getBytes(71);e.writeInt(t),this.send(e)},e.prototype.patchHunqiUp=function(t){var e=this.awakeLevel;this.awakeLevel=t.readShort(),this.awakeExp=t.readInt();var i=t.readShort(),n=this.getHunqiDataById(i),a=n.copy();n.level;return n?n.level=t.readShort():console.log("法器:"+i+"不存在"),n.canUp()||closeWin(HunqiUpWin),this.awakeLevel>e&&openWin(HunqiAwakeWin),n.level>a.level&&0==a.level&&openWin(HunqiActWin,n),RpFun.showHunqiRedPointSingle(n),this.skillMaxLv=Cfg.getConfig(HunqiAwakeConfig,this.awakeLevel).skillmax,n},e.prototype.getDatasByQuality=function(t){for(var e=[],i=0,n=this.hunqiDatas;i<n.length;i++){var a=n[i];a.getQuality()==t&&e.push(a)}return e},e.prototype.getHunqiDataById=function(t){for(var e=0,i=this.hunqiDatas;e<i.length;e++){var n=i[e];if(n.id==t)return n}return null},e.prototype.getHunqiDataByIndex=function(t){return this.hunqiDatas[t]},e.prototype.onSocketClose=function(){this.buffDatas.length=0},e}(BaseSys);__reflect(SkillSys.prototype,"SkillSys"),SystemMap.SkillSys=SkillSys.ins.bind(SkillSys),window.SkillSys=SkillSys;var AoyiData=function(){function t(t){this.type=0,this.skillid=0,this.config=t,this.type=t.type,this.skillid=t.skillid}return t.prototype.getSkillData=function(){return this.skillData||(this.skillData=SkillSys.ins().getSkillPassivityDataById(this.skillid))},t.prototype.getName=function(){return this.getSkillData().getConfig().name},t.prototype.getSkillDes=function(){return this.isAct()?this.getSkillData().getConfig().skinname:this.getSkillData().getNextConfig().skinname},t.prototype.getConsume=function(){return[this.getSkillData().getConfig().item]},t.prototype.isAct=function(){return this.getSkillData().isAct()},t}();__reflect(AoyiData.prototype,"AoyiData"),window.AoyiData=AoyiData;var AoyiItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="AoyiItemEUI",e.imgIcon.name="AoyiItem.imgIcon",e.showRedPoint(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof AoyiData){this.imgIcon.source=ResMgr.getSkillPassivityItemName(this.data.skillid,this.data.isAct()),this.lbName.text=this.data.getName(),this.lbJhsm.text=this.data.config.dec,this.lbDesc.textFlow=StrUtil.toTF(this.data.getSkillDes()),this.lbYjh.visible=this.data.isAct(),this.lbJhsm.visible=!this.data.isAct();var t=(e=RpSys.ins()).getData.apply(e,SkillSys.ins().getSkillPassivityRedPointKey(this.data.getSkillData()));this.showRedPoint(t)}var e},e.prototype.showRedPoint=function(t){this.redPoint.visible=t,this.imgKjh.visible=t},e}(BaseItemRender);__reflect(AoyiItem.prototype,"AoyiItem"),window.AoyiItem=AoyiItem;var AoyiPanel=function(t){function e(){var e=t.call(this)||this;return e.tabTypes=[],e.skinName="AoyiPanelEUI",e.list.itemRenderer=AoyiItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.tab.itemRenderer=BaseTabBtn4,e.tab.dataProvider=e.tabData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addItemTapE(this.tab,this.onTabClick),this.addClickE(this.list,this.onItemClick),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updatePanel),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.updateRp=function(t){if(!t||t.check(this))for(var i=0;i<this.tab.numChildren;i++){var n=this.tab.getChildAt(i);n.showRedPoint(RpSys.ins().getData(SkillWin,SkillMainPanel,e,this.tabTypes[i]))}},e.prototype.infoPanel=function(){var t=[];this.tabTypes=SkillSys.ins().aoyiModel.getTabTypes();for(var i=0,n=!1,a=0;a<this.tabTypes.length;a++)n||(n=RpSys.ins().getData(SkillWin,SkillMainPanel,e,this.tabTypes[a]),n&&(i=a)),t.push("skay_zycs_"+this.tabTypes[a]);this.tabData.source=t,this.tab.selectedIndex=i,this.updatePanel(),this.updateRp()},e.prototype.updatePanel=function(){this.listData.source=SkillSys.ins().aoyiModel.getAoyiDatasByType(this.tabTypes[this.tab.selectedIndex])},e.prototype.onTabClick=function(t){this.scroller.stopAnimation(),this.list.scrollV=0,this.updatePanel()},e.prototype.onItemClick=function(t){if(t.target&&"AoyiItem.imgIcon"==t.target.name){var e=t.target.parent.data;!e.isAct()&&GFunc.checkConsumeEnough(e.getConsume())&&SkillSys.ins().sendSkillPassivityUp(e.skillid)}},e.getTitle=function(){return"btz_zycs_jn"},e.getTabTitle=function(){return Lang.btn_ay},e.getSysId=function(){return SysId.Aoyi},e}(BasePanel);__reflect(AoyiPanel.prototype,"AoyiPanel"),window.AoyiPanel=AoyiPanel;var BuffData=function(){function t(){this.buffId=0,this.addTick=0,this.endTick=0,this.targetHandle=0,this.senderHandle=0,this.buffValue=0}return t.prototype.parser=function(t){this.buffId=t.readInt();var e=t.readInt();this.buffValue=t.readInt(),this.addTick=Timer.ins().getTimer(),this.endTick=this.addTick+1e3*e},Object.defineProperty(t.prototype,"buffConfig",{get:function(){return Cfg.getConfig(EffectsConfig,this.buffId)},enumerable:!0,configurable:!0}),t.prototype.getBuffValue=function(){var t=this.buffConfig.args.d;return AttrData.getAttrValue(new AttrData(t,this.buffValue))},t.prototype.getSecond=function(){if(-1==this.buffConfig.duration)return-1;var t=(this.endTick-Timer.ins().getTimer())/1e3;return Math.max(t,0)},t}();__reflect(BuffData.prototype,"BuffData"),window.BuffData=BuffData;var BuffPanel=function(t){function e(){var e=t.call(this)||this;return e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="BuffPanelEUI",this.listPT.itemRenderer=BuffPanelItemPT,this.listPT.dataProvider=this.listPTArr=new eui.ArrayCollection,this.listCZ.itemRenderer=BuffPanelItemCZ,this.listCZ.dataProvider=this.listCZArr=new eui.ArrayCollection},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.listCZ,this.onListItemClick),this.addLsn(SkillSys.ins().patchAddBuffUI,this.onUpdate),this.addLsn(SkillSys.ins().patchRemoveBuffUI,this.onUpdate),this.onUpdate(),this.updateBuffResidentList()},e.prototype.updateTime=function(){for(var t=0;t<this.listPT.numElements;t++){var e=this.listPT.getElementAt(t);
e&&e.updateTime()}},e.prototype.onUpdate=function(){this.listPTArr.source=SkillSys.ins().buffDatas,this.listPTArr.refresh()},e.prototype.onListItemClick=function(t){var e=t.target.name;if(e&&e.indexOf("btnGoAct")>-1){var i=parseInt(e.split("_")[1]),n=this.listCZArr.getItemAt(i);n.tiaozhuan(),closeWin(BuffWin)}},e.prototype.updateBuffResidentList=function(){var t=this.createBuffList();SortUtil.sortOn(t,["isAct","sort"],[SortType.up,SortType.up]),this.listCZArr.source=t},e.prototype.createBuffList=function(){var t=[];if(!urlParam.isShenhe){var e=new BuffResidentDataMonth;e.sort=0;var i=new BuffResidentDataTSZF;i.sort=1,t.push(e),t.push(i)}var n=new BuffResidentDataWordLevel;return n.sort=5,t.push(n),t},e.getSysId=function(){return SysId.Buff},e.getTitle=function(){return"btz_zycs_buff"},e.getTabTitle=function(){return"bqz_zycs_buff"},e}(BasePanel);__reflect(BuffPanel.prototype,"BuffPanel"),window.BuffPanel=BuffPanel;var BuffPanelItemCZ=function(t){function e(){var e=t.call(this)||this;return e.skinName="BuffPanelItemCZEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.btnGoAct.name="btnGoAct_"+this.itemIndex,this.imgIcon.source=t.getIcon(),this.labelContent.textFlow=addColorTF(t.getDesc()),this.labelName.text=t.getName(),this.labelTime.textFlow=addColorTF(t.getTime()),t.isAct?this.currentState="act":this.currentState="noact"},e}(BaseItemRender);__reflect(BuffPanelItemCZ.prototype,"BuffPanelItemCZ"),window.BuffPanelItemCZ=BuffPanelItemCZ;var BuffPanelItemPT=function(t){function e(){var e=t.call(this)||this;return e.skinName="BuffPanelItemPTEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source=ResMgr.getSkillPassivityItemName(t.buffConfig.icon,!0),this.labelContent.text=t.buffConfig.tip,this.labelName.text=t.buffConfig.name,this.updateTime()},e.prototype.updateTime=function(){var t=this.data;if(t){var e=t.getSecond(),i="";if(e>-1){var n=e>DateUtil.SECOND_PER_DAY?"dd天hh时mm分ss秒":"hh时mm分ss秒";i=getFormatTime(e,n)}else i="永久";this.labelTime.textFlow=addColorTF(i)}},e}(BaseItemRender);__reflect(BuffPanelItemPT.prototype,"BuffPanelItemPT"),window.BuffPanelItemPT=BuffPanelItemPT;var BuffWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[BuffPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(BuffWin.prototype,"BuffWin"),window.BuffWin=BuffWin;var FirstRechargeVeryDayTab=function(t){function e(){var e=t.call(this)||this;return e.skinName="FirstRechargeVeryDayTabEUI",e.redPoint.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.pay){var t=this.data;this.lbYuan.text=""+t.pay/100+Lang.common_yuan,this.lbDec.text=""+t.dec,this.redPoint.visible=RpSys.ins().getData(FirstRechargeVeryDayWin,this.itemIndex+1)}},e}(BaseItemRender);__reflect(FirstRechargeVeryDayTab.prototype,"FirstRechargeVeryDayTab"),window.FirstRechargeVeryDayTab=FirstRechargeVeryDayTab;var BuffResidentDataMonth=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDesc=function(){var t=Lang.skill_str3.replace("$jy$",""+StrUtil.addColor("+10%",32047));return t=t.replace("$jb$",""+StrUtil.addColor("+10%",32047)),t=t.replace("$gj$",""+StrUtil.addColor("+5%",32047))},e.prototype.getName=function(){return Lang.skill_str2},e.prototype.getIcon=function(){return ResMgr.getBuffIcon(this.isAct?"buff_zcsy_iconyk":"buff_zcsy_iconyka")},e.prototype.getTime=function(){var t=ActSys.ins().getActDataById(ActId.ID_99900),e="";return t.isInYueKaTime()&&(e=t.getformatTime()),e},Object.defineProperty(e.prototype,"isAct",{get:function(){var t=ActSys.ins().getActDataById(ActId.ID_99900);return t.isInYueKaTime()?!0:!1},enumerable:!0,configurable:!0}),e.prototype.tiaozhuan=function(){openWin(YKWin)},e}(BuffResidentData);__reflect(BuffResidentDataMonth.prototype,"BuffResidentDataMonth"),window.BuffResidentDataMonth=BuffResidentDataMonth;var BuffResidentDataTSZF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDesc=function(){var t=Lang.skill_str1.replace("$jb$",""+StrUtil.addColor("+10%",32047));return t=t.replace("$sm$",""+StrUtil.addColor("+5%",32047)),t=t.replace("$fy$",""+StrUtil.addColor("+5%",32047))},e.prototype.getName=function(){return Lang.recharge_str26},e.prototype.getIcon=function(){return ResMgr.getBuffIcon(this.isAct?"buff_zycs_icontqk":"buff_zycs_icontqka")},e.prototype.getTime=function(){var t=ActSys.ins().getActDataById(ActId.ID_99500),e=Lang.common_str24;return t.isAct()&&(e=Lang.common_str28),e},Object.defineProperty(e.prototype,"isAct",{get:function(){var t=ActSys.ins().getActDataById(ActId.ID_99500);return t.isAct()},enumerable:!0,configurable:!0}),e.prototype.tiaozhuan=function(){openWin(ZZTQWin)},e}(BuffResidentData);__reflect(BuffResidentDataTSZF.prototype,"BuffResidentDataTSZF"),window.BuffResidentDataTSZF=BuffResidentDataTSZF;var BuffResidentDataV5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDesc=function(){return"装备强化成功率永久增加"+StrUtil.addColor(this.config.addEnhanceSuccess/100+"%",32047)},e.prototype.getName=function(){return"VIP"+this.config.lv},e}(BuffResidentData);__reflect(BuffResidentDataV5.prototype,"BuffResidentDataV5"),window.BuffResidentDataV5=BuffResidentDataV5;var BuffResidentDataWordLevel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDesc=function(){return Lang.common_str104.replace("$level$",StrUtil.addColor(GFunc.GetLvStrByLv(JobSys.ins().wordLevel),32047))},e.prototype.getName=function(){return Lang.common_str103},e.prototype.getTime=function(){return Lang.common_str102+"\n"+StrUtil.addColor(GFunc.GetLvStrByLv(Actor.ins().level),15794098)},Object.defineProperty(e.prototype,"isAct",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getIcon=function(){return ResMgr.getBuffIcon(JobSys.ins().wordLevel>Actor.ins().level?"buff_zycs_iconexp":"buff_zycs_iconexpa")},e}(BuffResidentData);__reflect(BuffResidentDataWordLevel.prototype,"BuffResidentDataWordLevel"),window.BuffResidentDataWordLevel=BuffResidentDataWordLevel;var SkillDamageData=function(){function t(){this.senderHandle=0,this.skillId=0,this.targetHandle=0,this.skillDamageRanges=[],this.isMyDamage=!1,this.isTeamDamage=!1}return t.prototype.parser=function(t){this.senderHandle=t.readDouble(),this.skillId=t.readInt(),this.targetHandle=t.readDouble();var e=t.readShort(),i=LogicSys.ins().getEntityByHandle(this.senderHandle);i&&(this.isMyDamage=i.masterHandle==Actor.ins().handle),i&&i instanceof EntityRole&&(this.isTeamDamage=i.data.teamId==LogicSys.ins().centerEntity.data.teamId);for(var n=0;e>n;n++){var a=new SkillDamageRange;a.handle=t.readDouble(),a.damageType=t.readByte(),a.senderType=t.readByte(),a.value=t.readDouble();var o=LogicSys.ins().getEntityByHandle(a.handle);o&&(a.targetPos.x=o.x,a.targetPos.y=o.y),i&&(a.senderPos.x=i.x,a.senderPos.y=i.y),(a.damageType==DamageTypes.MISS||0!=a.value)&&this.skillDamageRanges.push(a);var s=t.readDouble();if(s){var r=new SkillDamageRange;i&&(r.handle=i.handle),r.damageType=DamageTypes.FS,r.value=s,o&&(r.senderPos.x=o.x,r.senderPos.y=o.y),i&&(r.targetPos.x=i.x,r.targetPos.y=i.y),(a.damageType==DamageTypes.MISS||0!=a.value)&&this.skillDamageRanges.push(r)}}},t.prototype.reset=function(){this.senderHandle=0,this.skillId=0,this.targetHandle=0,this.skillDamageRanges.length=0,this.isMyDamage=!1},t}();__reflect(SkillDamageData.prototype,"SkillDamageData"),window.SkillDamageData=SkillDamageData;var SkillDamageRange=function(){function t(){this.damageType=0,this.value=0,this.handle=0,this.senderType=0,this.senderPos=new XY,this.targetPos=new XY}return t.prototype.reset=function(){this.damageType=0,this.value=0,this.handle=0,this.senderPos=new XY,this.targetPos=new XY},t}();__reflect(SkillDamageRange.prototype,"SkillDamageRange"),window.SkillDamageRange=SkillDamageRange;var SkillDamageTongji=function(){function t(){this.log={}}return t.prototype.setDamage=function(t){this.log[t.senderHandle]||(this.log[t.senderHandle]=new DamageJob);var e=(this.log[t.senderHandle],this.getDamageJobByHandle(t.senderHandle)),i=LogicSys.ins().getEntityByHandle(t.senderHandle);e.isMy=i.AI instanceof AIRoleJJC,e.skillCount++,e.name=i.getName(),e.job=i.getJob();for(var n=0,a=t.skillDamageRanges;n<a.length;n++){var o=a[n],s=this.getDamageJobByHandle(o.handle),r=LogicSys.ins().getEntityByHandle(o.handle);r&&(s.name=r.getName(),s.job=r.getJob(),s.addBeDamage(o.value)),e.addDamage(o.value)}},t.prototype.getDamageJobByHandle=function(t){return this.log[t]||(this.log[t]=new DamageJob),this.log[t]},t}();__reflect(SkillDamageTongji.prototype,"SkillDamageTongji"),window.SkillDamageTongji=SkillDamageTongji;var DamageJob=function(){function t(){this.skillCount=0,this.isMy=!1,this.name="",this.job=0,this.damageTotle=0,this.damageCount=0,this.beDamageTotle=0,this.beDamageCount=0}return t.prototype.addDamage=function(t){this.damageTotle+=t||0,this.damageCount++},t.prototype.addBeDamage=function(t){this.beDamageTotle+=t||0,this.beDamageCount++},Object.defineProperty(t.prototype,"damageAvg",{get:function(){return Math.abs(this.damageTotle/(this.damageCount||1))>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"beDamageAvg",{get:function(){return Math.abs(this.beDamageTotle/(this.beDamageCount||1))>>0},enumerable:!0,configurable:!0}),t}();__reflect(DamageJob.prototype,"DamageJob"),window.DamageJob=DamageJob;var SkillData=function(){function t(){this.index=0,this.skillId=0,this.level=0,this.skillCDTick=0,this.isUp=!1,this.actionIndex=0}return t.prototype.parser=function(t){this.skillId=t.readShort(),this.level=t.readShort()},t.prototype.parser1=function(t){this.skillId=t.readInt(),this.level=t.readShort()},t.prototype.canTisheng=function(){return this.isAct&&!this.isMax},t.prototype.canUp=function(){return this.isAct&&!this.isMax&&this.isConsumeEnough()},Object.defineProperty(t.prototype,"isMax",{get:function(){return this.level>=SkillSys.ins().skillMaxLv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAct",{get:function(){return this.level>0},enumerable:!0,configurable:!0}),t.prototype.isConsumeEnough=function(){return Actor.ins().getCurrency(CurType.talentValue)>=this.skillLevelConfig.talentvalue},Object.defineProperty(t.prototype,"skillConfig",{get:function(){return this._skillConfig||(this._skillConfig=Cfg.getConfig(SkillsConfig,this.skillId))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillLevelConfig",{get:function(){return this._skillsLevelConfig&&this._skillsLevelConfig.level==this.level||(this._skillsLevelConfig=Cfg.getConfig(SkillsLevelConfig,this.index,this.level)),this._skillsLevelConfig},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"power",{get:function(){var t=this.skillLevelConfig;return t.score+GFunc.getPower(t.attr)||0},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=new t;return e.skillId=this.skillId,e.level=this.level,e},t}();__reflect(SkillData.prototype,"SkillData"),window.SkillData=SkillData;var SkillPassivityData=function(){function t(t){this.id=0,this.level=0,this.param=0,this.isOpen=0,this.id=t}return t.prototype.getConfig=function(){return this._config&&this._config.level==this.level||(this._config=Cfg.getConfig(SkillPassiveConfig,this.id,this.level)),this._config},t.prototype.getNextConfig=function(){var t=Cfg.getConfigs(SkillPassiveConfig,this.id,CondType.ALL);return t.length==this.level+1?this._nextConfig=t[this.level]:this._nextConfig=t[this.level+1],this._nextConfig},t.prototype.getPower=function(){return 1==this.getConfig().type?GFunc.getPower(this.getConfig().addattr)+this.getConfig().power>>0:this.getConfig().power},t.prototype.getNextPower=function(){return 1==this.getConfig().type?GFunc.getPower(this.getNextConfig().addattr)+this.getNextConfig().power>>0:this.getNextConfig().power},t.prototype.isAct=function(){return this.level>0},t.prototype.isMax=function(){return this.isAct()?this.getConfig().level>=this.getNextConfig().level:!1},t}();__reflect(SkillPassivityData.prototype,"SkillPassivityData"),window.SkillPassivityData=SkillPassivityData;var SkillPifuData=function(){function t(){this.skillId=0,this.isSelect=!1,this.isAct=!1,this.skillPifuLevel=1}return t}();__reflect(SkillPifuData.prototype,"SkillPifuData"),window.SkillPifuData=SkillPifuData;var SkillPifuRoleData=function(){function t(){this.skillPifuDatas=[]}return t.prototype.iniData=function(){for(var t=0;6>t;t++);},t}();__reflect(SkillPifuRoleData.prototype,"SkillPifuRoleData"),window.SkillPifuRoleData=SkillPifuRoleData;var HunqiActWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="HunqiActWinEUI",this.addBg("public_zycs_greybg3"),t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.mcIcon=new MC,this.groupIcon.addChild(this.mcIcon)},e.prototype.open=function(e){t.prototype.open.call(this),this.mcIcon.playFile(ResMgr.getEffName("hunqi"+e.id),-1),this.labelName.text=e.getIdConfig().name},e}(BaseWinSingle);__reflect(HunqiActWin.prototype,"HunqiActWin"),window.HunqiActWin=HunqiActWin;var HunqiAwakeWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="HunqiAwakeWinEUI",this.addBg("public_zycs_greybg0"),this.group.touchEnabled=!1,t.prototype.initUI.call(this),this.layer=LayerMgr.Popup},e.prototype.open=function(){t.prototype.open.call(this);var e=Cfg.getConfig(HunqiAwakeConfig,SkillSys.ins().awakeLevel-1),i=Cfg.getConfig(HunqiAwakeConfig,SkillSys.ins().awakeLevel),n=addColor("仙术上限：",13486270)+addColor(e.skillmax+" → "+i.skillmax,5949490);this.labelSkillMax.textFlow=addColorTF(n);var a=addColor("仙术伤害：",13486270)+addColor(e.skilladd/100+"% → "+i.skilladd/100+"%",5949490);this.labelSkillDamage.textFlow=addColorTF(a)},e}(BaseWinSingle);__reflect(HunqiAwakeWin.prototype,"HunqiAwakeWin"),window.HunqiAwakeWin=HunqiAwakeWin;var HunqiData=function(){function t(){this.id=1,this.level=0,this._quality=0}return t.prototype.parser=function(t){this.id=t.readShort(),this.level=t.readShort()},t.prototype.getIdConfig=function(){return this._idConfig&&this._idConfig.id==this.id?this._idConfig:this._idConfig=Cfg.getConfig(HunqiIdConfig,this.id)},t.prototype.getQualityConfig=function(){return Cfg.getConfig(HunqiQualityConfig,this.getQuality())},t.prototype.getLevelConfig=function(){return this._levelConfig&&this._levelConfig.level==this.level?this._levelConfig:this._levelConfig=Cfg.getConfig(HunqiLevelConfig,this.getQuality(),this.level)},t.prototype.getConsumeItem=function(){var t=new ItemDataReward;return t.id=this.getIdConfig().itemid,t.count=this.getLevelConfig().itemcount,t},t.prototype.isAct=function(){return this.level>0},t.prototype.isMax=function(){return this.level>=Cfg.getConfigs(HunqiLevelConfig,this.getQuality(),CondType.ALL).length-1},t.prototype.getQuality=function(){return this._quality||(this._quality=Cfg.getConfig(HunqiIdConfig,this.id).quality)},Object.defineProperty(t.prototype,"power",{get:function(){for(var t=GFunc.getPower(this.getLevelConfig().attr),e=Cfg.getHunqiActConfigsByQuality(this.getQuality(),this.level),i=0,n=e;i<n.length;i++){var a=n[i];t+=GFunc.getPower(a.attrlh)}return t},enumerable:!0,configurable:!0}),t.prototype.canUp=function(){return!this.isMax()&&this.getUpItemCount()>=this.getLevelConfig().itemcount},t.prototype.getUpItemCount=function(){var t=BagSys.ins().getItemCount(this.getIdConfig().itemid);return this.isAct()&&(t+=BagSys.ins().getItemCount(this.getQualityConfig().itemid)),t},t.prototype.copy=function(){var e=new t;return e.level=this.level,e.id=this.id,e},Object.defineProperty(t.prototype,"actNumber",{get:function(){var t=0;return t=!this.isAct()&&this.canUp()?1:this.canUp()?0:-1},enumerable:!0,configurable:!0}),t}();__reflect(HunqiData.prototype,"HunqiData");var HunqiPanel=function(t){function e(){var e=t.call(this)||this;return e.oldQuality=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="HunqiPanelEUI",this.listTab.dataProvider=this.listTabArr=new eui.ArrayCollection,this.listTab.itemRenderer=HunqiPanelTabItem,this.listTabArr.source=Cfg.getConfigs(HunqiQualityConfig),this.listHunqi.itemRenderer=HunqiPanelItem,this.listHunqi.dataProvider=this.listHunqiArr=new eui.ArrayCollection,this.progressBar.labelFunction=this.progressLabelFunction.bind(this),this.setRedPointHead(SkillWin)},e.prototype.progressLabelFunction=function(t,e){return t>=e?"MAX":t+"/"+e},e.prototype.open=function(e){void 0===e&&(e=-1),t.prototype.open.call(this),this.addItemTapE(this.listHunqi,this.onListClick),this.addItemTapE(this.listTab,this.onTabListClick),this.addLsn(SkillSys.ins().patchHunqiUp,this.onUp),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(BagSys.ins().patchItemChange,this.onItemChange),this.listTab.selectedIndex=-1!=e?e:0,this.listTab.validateNow(),this.updateRp(),this.updatePanel()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(this.getThisDef())){for(var e=this.listTab.numElements,i=0;e>i;i++){var n=this.listTab.getElementAt(i);n&&n.updateRp()}e=this.listHunqi.numElements;for(var i=0;e>i;i++){var a=this.listHunqi.getElementAt(i);a&&a.updateRp()}}},e.prototype.onItemChange=function(t){if(t&&t.cfg.type==ItemType.Hunqi)for(var e=this.listHunqi.numElements,i=0;e>i;i++){var n=this.listHunqi.getElementAt(i);if(n){var a=n.data;(a.getIdConfig().itemid==t.id||a.getQualityConfig().itemid)&&n.updateItemCount()}}},e.prototype.updatePanel=function(){this.updateList(this.listTab.selectedItem),this.updateValue(),this.updatePower()},e.prototype.onUp=function(t){this.updatePanel();for(var e=this.listHunqi.numElements,i=0;e>i;i++){var n=this.listHunqi.getElementAt(i);n&&n.data.id==t.id&&(n.data=t)}},e.prototype.updateList=function(t){for(var e=SkillSys.ins().getDatasByQuality(t.quality),i=[],n=[],a=[],o=[],s=0,r=e;s<r.length;s++){var u=r[s];!u.isAct()&&u.canUp()?i.push(u):u.canUp()?n.push(u):u.isAct()?a.push(u):o.push(u)}SortUtil.sortOn(n,["level"],[SortType.down]),SortUtil.sortOn(a,["id"],[SortType.up]),SortUtil.sortOn(o,["id"],[SortType.up]),this.listHunqiArr.source=[].concat(i).concat(n).concat(a).concat(o)},e.prototype.updateValue=function(){var t=Cfg.getConfig(HunqiAwakeConfig,SkillSys.ins().awakeLevel);this.lx="lx"+t.level,this.progressBar.maximum=t.exp,this.progressBar.value=SkillSys.ins().awakeExp;var e="仙术上限："+addColor(""+t.skillmax,1176860);this.labelSkillMax.textFlow=addColorTF(e);var i="仙术伤害："+addColor("+"+t.skilladd/100+"%",1176860);this.labelSkillDamage.textFlow=addColorTF(i)},e.prototype.updatePower=function(){for(var t=0,e=SkillSys.ins().hunqiDatas,i=0,n=e;i<n.length;i++){var a=n[i];t+=a.power}this.bmpLabelPower.text=MathUtil.toFixed(t,0).toString()},e.prototype.onTabListClick=function(t){var e=t.item;e.quality!=this.oldQuality&&(this.updateList(e),this.oldQuality=e.quality)},e.prototype.onListClick=function(t){var e=t.item;openWin(HunqiUpWin,e)},e.prototype.getHunqiPanelItem=function(t){return this.listHunqi.validateNow(),this.listHunqi.getElementAt(t)},e.getSysId=function(){return SysId.Hunqi},e.getTitle=function(){return"hq_zycs_hq"},e.getTabTitle=function(){return"bqz_zycs_hq"},e}(BasePanel);__reflect(HunqiPanel.prototype,"HunqiPanel"),window.HunqiPanel=HunqiPanel;var HunqiPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HunqiPanelItemEUI",e.mcIcon=new MC,e.groupIcon.addChild(e.mcIcon),e.progressBar.labelFunction=e.progressLabelFunction.bind(e),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.getUpItemCount(),i=t.getLevelConfig().itemcount;t.isAct()?this.currentState="normal":e>=i?this.currentState="canAct":this.currentState="unAct",this.bg.source="hq_zycs_k"+t.getQuality(),this.labelName.text=t.getIdConfig().name,this.labelLevel.text="Lv."+t.level,this.mcIcon.playFile(ResMgr.getEffName("hunqi"+t.id),-1),this.updateItemCount(),this.updateRp()},e.prototype.updateItemCount=function(){var t=this.data,e=t.getUpItemCount(),i=t.getLevelConfig().itemcount;this.progressBar.maximum=i,this.progressBar.value=e},e.prototype.progressLabelFunction=function(t,e){var i=this.data;return i&&i.isMax()?"MAX":i.getUpItemCount()+"/"+e},e.prototype.updateRp=function(){var t=this.data;this.redPoint.visible=RpSys.ins().getData(SkillWin,HunqiPanel,t.getQuality(),t.id)},e}(BaseItemRender);__reflect(HunqiPanelItem.prototype,"HunqiPanelItem"),window.HunqiPanelItem=HunqiPanelItem;var HunqiPanelTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HunqiPanelTabItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;null!=t?(this.iconDisplay.source=this.getIconDisplay(),this.iconDisplay1.source=this.getSelectIcon(),this.labelName.text=t.name,this.updateRp()):this.iconDisplay.source=""},e.prototype.updateRp=function(){this.redPoint.visible=RpSys.ins().getData(SkillWin,HunqiPanel,this.itemIndex+1)},e.prototype.getIconDisplay=function(){var t=this.data;return null!=t?"hq_zycs_"+t.quality+"1":void 0},e.prototype.getSelectIcon=function(){var t=this.data;return null!=t?"hq_zycs_"+t.quality+"2":void 0},e}(BaseItemRender);__reflect(HunqiPanelTabItem.prototype,"HunqiPanelTabItem"),window.HunqiPanelTabItem=HunqiPanelTabItem;var HunqiUpWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="HunqiUpWinEUI",t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.setSkinPart("itemConsume",new ItemBaseReward),this.listLianhua.dataProvider=this.listLianhuaArr=new eui.ArrayCollection,this.listLianhua.itemRenderer=HunqiUpWinItem,this.labelHowGet.textFlow=addColorTF("获取途径",null,!0),this.progressBar.labelFunction=this.progressLabelFunction.bind(this),this.addBg()},e.prototype.progressLabelFunction=function(t,e){var i=this.hunqiData;return i&&i.isMax()?"MAX":i.getUpItemCount()+"/"+e},e.prototype.open=function(e){t.prototype.open.call(this),this.hunqiData=e,this.addClickE(this.btnAct,this.onClick),this.addClickE(this.btnUp,this.onClick),this.addClickE(this.labelHowGet,this.onClick),this.addLsn(BagSys.ins().patchItemChange,this.onItemChange),this.addLsn(SkillSys.ins().patchHunqiUp,this.onUpdate),this.onUpdate()},e.prototype.onItemChange=function(t){t.cfg.type==ItemType.Hunqi&&(this.progressBar.maximum=this.hunqiData.getLevelConfig().itemcount,this.progressBar.value=this.hunqiData.getUpItemCount())},e.prototype.updateLianhua=function(){for(var t=Cfg.getHunqiLianhuaConfigs(this.hunqiData.getQuality()),e=[],i=0,n=t;i<n.length;i++){var a=n[i],o=new HunqiUpWinItemData;o.id=this.hunqiData.id,o.levelConfig=a,e.push(o)}this.listLianhuaArr.source=e},e.prototype.onUpdate=function(){var t=this.hunqiData.getLevelConfig(),e=new ItemDataReward;e.id=this.hunqiData.getIdConfig().itemid;var i=Cfg.getItemCfg(e.id);if(this.labelName.text=i.getName(),this.labelLv.text="Lv."+t.level,this.itemConsume.data=e,this.progressBar.maximum=t.itemcount,this.progressBar.value=this.hunqiData.getUpItemCount(),this.labelNormalAttrCur.text=AttrData.parse(t.attr).join("\n"),this.hunqiData.isMax())this.currentState="max";else{this.hunqiData.isAct()?this.currentState="up":this.currentState="act";var n=this.hunqiData.copy();n.level+=1;var a=n.getLevelConfig();this.labelNormalAttrNext.text=AttrData.parse(a.attr).join("\n")}this.updateLianhua()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnAct:this.hunqiData.canUp()?SkillSys.ins().sendHunqiUp(this.hunqiData.id):GFunc.checkConsumeEnough(this.hunqiData.getConsumeItem());break;case this.btnUp:this.hunqiData.canUp()?SkillSys.ins().sendHunqiUp(this.hunqiData.id):GFunc.checkConsumeEnough(this.hunqiData.getConsumeItem());break;case this.labelHowGet:GFunc.checkConsumeEnough(this.hunqiData.getConsumeItem())}},e.prototype.getBtnAct=function(){return this.btnAct},e}(BaseWinSingle);__reflect(HunqiUpWin.prototype,"HunqiUpWin"),window.HunqiUpWin=HunqiUpWin;var HunqiUpWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HunqiUpWinItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getConfig(HunqiIdConfig,t.id),i=SkillSys.ins().getHunqiDataById(e.id);this.labelAttr.text=AttrData.parse(t.levelConfig.attrlh).join("\n"),i.level>=t.levelConfig.level?this.labelActLevel.text="":this.labelActLevel.textFlow=addColorTF(t.levelConfig.level+"级激活",15733780)},e}(BaseItemRender);__reflect(HunqiUpWinItem.prototype,"HunqiUpWinItem"),window.HunqiUpWinItem=HunqiUpWinItem;var HunqiUpWinItemData=function(){function t(){this.id=1}return t}();__reflect(HunqiUpWinItemData.prototype,"HunqiUpWinItemData");var FootSkillUpWin=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.footId=1,e.pos=1,e}return __extends(e,t),e.prototype.open=function(e,i,n){void 0===i&&(i=1),void 0===n&&(n=1),t.prototype.open.call(this,e),this.footId=i,this.pos=n,this.addLsn(FootSys.ins().patchFootSkillUp,this.upatePanel)},e.prototype.onTap=function(t){FootSys.ins().sendFootSkillUp(this.footId,this.pos),GFunc.playUIMovie("public_qxt",108,103,this.group,1)},e}(SkillPassivityUpWin);__reflect(FootSkillUpWin.prototype,"FootSkillUpWin"),window.FootSkillUpWin=FootSkillUpWin;var SkillActFlyWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Top,e.winType=WinType.NeverCloseWin,e.mc=new MC,e.skillId=0,e.flyFun=new Caller,e.skinName="SkillActFlyWinEUI",e}return __extends(e,t),e.prototype.open=function(t,e,i){this.skillId=t,this.flyFun.obj=i,this.flyFun.func=e;var n=Cfg.getConfig(SkillsConfig,t);this.imgIcon.source=ResMgr.getSkillResourceItemName(n.icon,!0,!0),this.labelName.text=n.name,Timer.ins()["do"](1e3,0,1,this.end,this)},e.prototype.end=function(){this.flyFun.param=[this.imgIcon.localToGlobal()],this.flyFun.call(),closeWin(this)},e}(BaseWinSingle);__reflect(SkillActFlyWin.prototype,"SkillActFlyWin"),window.SkillActFlyWin=SkillActFlyWin;var SkillIcon=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.imgIcon.source=ResMgr.getSkillResourceItemName(t.skillConfig.icon,t.isAct)},e.prototype.setRedPoint=function(t){this.imgRedPoint.visible=t},e}(BaseItemRender);__reflect(SkillIcon.prototype,"SkillIcon"),window.SkillIcon=SkillIcon;var SkillMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[SkillWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[SkillPanel,AoyiPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="SkillMainPanelEUI"},e.prototype.getSkillIcon=function(t){return this.getPanel(SkillPanel).getSkillIcon(t)},e.prototype.getActBtn=function(){return this.getPanel(SkillPanel).getActBtn()},e.prototype.getBtnOneKey=function(){return this.getPanel(SkillPanel).getBtnOneKey()},e.getTitle=function(){return"btz_zycs_jn"},e.getTabTitle=function(){return"bqz_zycs_jn"},e}(BaseTabPanel);__reflect(SkillMainPanel.prototype,"SkillMainPanel"),window.SkillMainPanel=SkillMainPanel;var SkillPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=75,e.skillItems=[],e.curIndex=0,e.oneKeyCDTick=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SkillPanelEUI";for(var t=0;8>t;t++){var e=new SkillPanelItem;this.setSkinPart("skillItem"+t,e),this.skillItems[t]=e}this.listTab.itemRenderer=BaseTabBtn3,this.setRedPointHead(SkillWin)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnUp,this.onClick),this.addClickE(this.btnOneKey,this.onClick),this.addClickE(this.helpBtn,this.onClick),this.addLsn(SkillSys.ins().patchSkillUp,this.onSkillUp),this.addLsn(SkillSys.ins().patchSkillUpOneKey,this.onOneKey),this.addLsn(LogicSys.ins().patchCurrency,this.onConsume),this.addLsn(RpSys.ins().patchRp,this.updateRp);for(var e=0;e<this.skillItems.length;e++){var i=this.skillItems[e];this.addClickE(i,this.onListItemTap),i.data=SkillSys.ins().skillDatas[e]}this.setNewIndex(this.getDefaultIndex()),this.updateList(),this.onConsume(),this.updateRp(),this.updateDesc(),this.updatePower()},e.prototype.getDefaultIndex=function(){for(var t=0,e=Number.MAX_VALUE,i=SkillSys.ins().skillDatas,n=0;n<i.length;n++){var a=i[n];a.isAct&&a.level<e&&(e=i[n].level,t=n)}return t},e.prototype.updateList=function(){for(var t=0;t<this.skillItems.length;t++){var e=this.skillItems[t];e.data=SkillSys.ins().getSkillDataByIndex(t)}},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e)){for(var i=0;i<this.skillItems.length;i++){var n=this.skillItems[i].data;n&&this.skillItems[i].setRedPoint(RpSys.ins().getData(SkillWin,SkillMainPanel,e,n.skillId))}this.btnOneKey.redPoint.visible=RpSys.ins().getData(SkillWin,SkillMainPanel,e)}},e.prototype.setNewIndex=function(t){this.skillItems[this.curIndex].setSelect(!1),this.curIndex=t,this.skillItems[this.curIndex].setSelect(!0)},e.prototype.onListItemTap=function(t){var e=this.skillItems.indexOf(t.currentTarget);e!=this.curIndex&&(this.setNewIndex(e),this.updateDesc(),this.onConsume())},e.prototype.onSkillUp=function(t){var e=this.skillItems[this.curIndex];t.skillId==e.data.skillId&&(e.data=t,this.updateDesc(),this.updatePower(),this.onConsume())},e.prototype.onOneKey=function(){this.updateList(),this.onConsume(),this.updateRp(),this.updateDesc(),this.updatePower()},e.prototype.updateDesc=function(){var t=this.skillItems[this.curIndex].data;t.isAct||(t=t.clone(),t.level+=1),this.labelSkillName.text=t.skillConfig.name+" Lv."+t.level;var e=t.skillConfig.desc;e=e.replace("{a}",(t.skillLevelConfig.args.a/100).toFixed(0)+"%"),e=e.replace("{b}",""+t.skillLevelConfig.args.b),e=e.replace("{c}",""+t.skillLevelConfig.attr[0].value),this.labelDesc.textFlow=StrUtil.toTF(e)},e.prototype.updatePower=function(){for(var t=SkillSys.ins().skillDatas,e=0,i=0,n=t;i<n.length;i++){var a=n[i];e+=a.power}this.bmpLabelPower.text=e.toFixed(0)},e.prototype.onConsume=function(t){if(void 0===t&&(t=null),!t||t.type==CurType.talentValue){var e=this.skillItems[this.curIndex].data,i=e.isConsumeEnough()?5767068:13967392;this.labelConsume.textFlow=addColorTF(Actor.ins().getCurrency(CurType.talentValue)+"/"+e.skillLevelConfig.talentvalue,i)}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOneKey:var e=Timer.ins().getEgretTimer();if(e>this.oneKeyCDTick){this.oneKeyCDTick=e+200;for(var i=!1,n=!1,a=Number.MAX_VALUE,o=0,s=this.skillItems;o<s.length;o++){var r=s[o],u=r.data,h=u.canTisheng();h&&(n=n||u.isConsumeEnough(),a=Math.min(u.skillLevelConfig.talentvalue,a),i=!0)}i?n?SkillSys.ins().sendSkillUpOneKey():GFunc.checkCurrency(CurType.talentValue,a):showtipsFail("请提升法器觉醒等级！")}break;case this.btnUp:var p=this.skillItems[this.curIndex].data;p.isAct?p.isMax?showtipsFail("请提升法器觉醒等级！"):GFunc.checkCurrency(CurType.talentValue,p.skillLevelConfig.talentvalue)&&SkillSys.ins().sendSkillUp(this.curIndex):showtipsFail("主线任务开启！");break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.getSkillIcon=function(t){return this.skillItems[t].getIcon()},e.prototype.getActBtn=function(){return this.btnUp},e.prototype.getBtnOneKey=function(){return this.btnOneKey},e.getTitle=function(){return"btz_zycs_jn"},e.getTabTitle=function(){return Lang.btn_jn},e.getSysId=function(){return SysId.Skill},e}(BasePanel);__reflect(SkillPanel.prototype,"SkillPanel"),window.SkillPanel=SkillPanel;var SkillPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillPanelItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.isAct?this.currentState="normal":this.currentState="unAct",this.imgIcon.source=ResMgr.getSkillResourceItemName(t.skillConfig.icon,t.isAct,!0),this.labelName.text=t.skillConfig.name,this.labelLevel.text=t.level.toString(),this.progressBar.maximum=SkillSys.ins().skillMaxLv,this.progressBar.value=t.level,this.progressBar.labelFunction=this.labelFunction.bind(this),t.isUp&&(t.isUp=!1,this.mcGroup.addChild(MC.createCenterGruop("res/eff/jneff2",1)))
},e.prototype.labelFunction=function(t,e){var i=this.data;return i.isMax?"MAX":t+"/"+e},e.prototype.setRedPoint=function(t){this.redPoint.visible=t},e.prototype.setSelect=function(t){t?this.selectMC||(this.selectMC=GFunc.playUIMovie("jneff1",73,53,this.groupSelect,-1)):this.selectMC&&(DisUtil.remove(this.selectMC),this.selectMC=null)},e.prototype.getIcon=function(){return this.imgIcon},e}(BaseItemRender);__reflect(SkillPanelItem.prototype,"SkillPanelItem"),window.SkillPanelItem=SkillPanelItem;var FirstRechargeVeryDayWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="FirstRechargeVeryDayWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.tabList.itemRenderer=FirstRechargeVeryDayTab,e.tabList.dataProvider=e.tabData=new eui.ArrayCollection,e.list.itemRenderer=ItemBaseRewardName,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.btnGetAward.redPoint.visible=!0,e.mcIcon=new McIcon,e.groupMc.addChild(e.mcIcon),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.curIndex=e,this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.btnGetAward,this.onClick),this.addItemTapE(this.tabList,this.onItemList),this.addLsn(RechargeActSys.ins().patchUpdateRecharge,this.updateState),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.close=function(){this.mcIcon.close(),t.prototype.close.call(this)},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(e))&&this.tabData.replaceAll(this.data.configs.concat())},e.prototype.infoPanel=function(){this.data=RechargeActSys.ins().firstRechargeEveryDay,this.tabData.source=this.data.configs,isNaN(this.curIndex)?this.updateState():(this.tabList.selectedIndex=this.curIndex,this.updatePanel())},e.prototype.updateState=function(){for(var t=this.data.configs,i=this.tabList.selectedIndex>=0?this.tabList.selectedIndex:0,n=0,a=t;n<a.length;n++){var o=a[n],s=RpSys.ins().getData(e,o.index);if(s){i=o.index-1;break}}this.tabList.selectedIndex=i,this.updatePanel()},e.prototype.updatePanel=function(){var t=this.data.configs[this.tabList.selectedIndex];this.listData.source=t.awardList,this.lbDesc.textFlow=addColorTF(Lang.recharge_str2.replace("$yuan$",""+StrUtil.addColor(t.pay/100+Lang.common_yuan,16751375))),this.imgYlq.visible=!1,this.btnRecharge.visible=!1,this.btnGetAward.visible=!1;var e=this.data.states[this.tabList.selectedIndex];0==e?this.btnGetAward.visible=!0:1==e?this.imgYlq.visible=!0:-1==e&&(this.btnRecharge.visible=!0),this.mcIcon.open(t.mcIcon)},e.prototype.onItemList=function(t){this.updatePanel()},e.prototype.onClick=function(t){switch(t.target){case this.btnRecharge:openWin(RechargeWin),closeWin(e);break;case this.btnGetAward:BagSys.ins().checkBagFreeCount(5)&&RechargeActSys.ins().sendRechargeEveryday(this.tabList.selectedIndex+1)}},__decorate([callDelay(100)],e.prototype,"updateState",null),e}(BaseWinSingle);__reflect(FirstRechargeVeryDayWin.prototype,"FirstRechargeVeryDayWin"),window.FirstRechargeVeryDayWin=FirstRechargeVeryDayWin;var SkillPassivityItem2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data instanceof SkillPassivityData&&(this.lbLv.text=""+this.data.level)},e}(SkillPassivityItem);__reflect(SkillPassivityItem2.prototype,"SkillPassivityItem2"),window.SkillPassivityItem2=SkillPassivityItem2;var YYMSPanel=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="YYMSPanelEUI",t.prototype.initUI.call(this),this.listTab.itemRenderer=YYMSTabItem,this.listTab.dataProvider=this.listTabArr=new eui.ArrayCollection,this.listTabArr.source=[Cfg.getConfig(YYMSConfig,1),Cfg.getConfig(YYMSConfig,2),Cfg.getConfig(YYMSConfig,3)],this.listAward.itemRenderer=ItemBaseRewardColor,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.btnRecharges=[this.btnRecharge0,this.btnRecharge1,this.btnRecharge2],this.mcBox=GFunc.playUIMovie("yyms1",0,0,this.groupBoxEff,-1),GFunc.playUIMovie("yyms2",89,35,this.btnRechargeAll,-1),GFunc.playUIMovie("yyms2",89,35,this.btnGet,-1)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnLeft,this.onClick),this.addClickE(this.btnRight,this.onClick),this.addClickE(this.btnRecharge0,this.onClick),this.addClickE(this.btnRecharge1,this.onClick),this.addClickE(this.btnRecharge2,this.onClick),this.addClickE(this.btnRechargeAll,this.onClick),this.addClickE(this.btnGet,this.onClick),this.addItemTapE(this.listTab,this.onItemClick),this.addLsn(RechargeActSys.ins().patchYYMS,this.update),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.listTab.validateNow(),this.listTab.selectedIndex=this.selectIndex=this.getAutoIndex(),this.update(),this.updateRp()},e.prototype.getAutoIndex=function(){for(var t=0,e=RechargeActSys.ins().yymsRechargeStates,i=0;i<e.length;i++)if(1==RechargeActSys.ins().getYYMSState(i)){t=i;break}return t},e.prototype.updateRp=function(t){if(!t||t.check(this.getThisDef()))for(var e=0;e<this.listTab.numElements;e++){var i=this.listTab.getElementAt(e);i&&i.updateRp()}},e.prototype.onItemClick=function(t){this.selectIndex=t.itemIndex,this.update()},e.prototype.update=function(){var t=this.getIdByIndex(this.selectIndex),e=Cfg.getConfig(YYMSConfig,t);this.imgBox.source="yyms_zycs_box"+t;for(var i=GFunc.getItemDataRewardByJob(e.rewards),n=[],a=0,o=i;a<o.length;a++){var s=o[a];s.tempColor=16759621,n.push(s)}this.listAwardArr.source=n,this.labelYuanjia.text="原价"+Cfg.getConfig(PayMoneyConfig,e.cash).yuanjia+"元",this.imgBoxName.source="yyms_zycs_s"+t,this.updateBtnState()},e.prototype.updateBtnState=function(){this.btnLeft.visible=this.selectIndex>0,this.btnRight.visible=this.selectIndex<this.listTabArr.length-1,this.btnRecharge0.visible=0==this.selectIndex,this.btnRecharge1.visible=1==this.selectIndex,this.btnRecharge2.visible=2==this.selectIndex;var t=RechargeActSys.ins().getYYMSState(this.selectIndex);this.groupRechargeBtn.visible=0==t,this.btnGet.visible=1==t,this.imgYLQ.visible=2==t;var e=RechargeActSys.ins().isYYMSBuyAll();this.btnRechargeAll.visible=!e,this.labelYGMAll.visible=e},e.prototype.getIdByIndex=function(t){return t+1},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLeft:this.selectIndex>0&&this.selectIndex--,this.listTab.selectedIndex=this.selectIndex,this.update();break;case this.btnRight:this.selectIndex<this.listTabArr.length-1&&this.selectIndex++,this.listTab.selectedIndex=this.selectIndex,this.update();break;case this.btnRecharge0:VipSys.ins().showReCharge(Cfg.getConfig(YYMSConfig,1).cash);break;case this.btnRecharge1:VipSys.ins().showReCharge(Cfg.getConfig(YYMSConfig,2).cash);break;case this.btnRecharge2:VipSys.ins().showReCharge(Cfg.getConfig(YYMSConfig,3).cash);break;case this.btnRechargeAll:VipSys.ins().showReCharge(Cfg.getConfig(YYMSConfig,4).cash);break;case this.btnGet:var e=this.getIdByIndex(this.selectIndex);RechargeActSys.ins().sendYYMS(e)}},e.getTitle=function(){return"btz_zycs_1yuanms"},e.getTabTitle=function(){return"bqz_zycs_1yuanms"},e}(BasePanel);__reflect(YYMSPanel.prototype,"YYMSPanel"),window.YYMSPanel=YYMSPanel;var SkillPassivityUpWin2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setSkinPart("item",new SkillPassivityItem2)},e.prototype.upatePanel=function(){t.prototype.upatePanel.call(this),this.power=""+this.data.getNextPower(),this.lbCur.text=this.data.getNextConfig().skinname,this.lbCur.textColor=3821938,this.lbNext.text="",this.lbN.text="",this.lbC.text=""},e}(SkillPassivityUpWin);__reflect(SkillPassivityUpWin2.prototype,"SkillPassivityUpWin2"),window.SkillPassivityUpWin2=SkillPassivityUpWin2;var SkillWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[SkillMainPanel,HunqiPanel]},enumerable:!0,configurable:!0}),e.prototype.getSkillIcon=function(t){return this.getPanel(SkillMainPanel).getSkillIcon(t)},e.prototype.getActBtn=function(){return this.getPanel(SkillMainPanel).getActBtn()},e.prototype.getCloseBtn=function(){return this.closeBtn0},e.prototype.getBtnOneKey=function(){return this.getPanel(SkillMainPanel).getBtnOneKey()},e.prototype.getHunqiPanelItem=function(t){return this.getPanel(HunqiPanel).getHunqiPanelItem(t)},e}(BaseDuoPanelWin);__reflect(SkillWin.prototype,"SkillWin"),window.SkillWin=SkillWin;var MeilinModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.fuHunDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.star==this.level||(this.levelConfig=Cfg.getConfig(MeilinLevelConfig,this.level)),this.levelConfig},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.star<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(MeilinLevelConfig,this.level)),this.levelNextConfig},e.prototype.parserInfo=function(t){this.huanHuaId=t.readInt(),this.level=t.readShort();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var n=1;e>=n;n++){var o=this.getFuHunDataById(n);o.setLv(t.readShort())}},e.prototype.parserUp=function(t){this.level=t.readShort()},e.prototype.parserHuanHuaUp=function(t){var e=this.getHuanHuaDataById(t.readInt());return e.level=t.readShort(),e},e.prototype.parserFuHunUp=function(t){var e=this.getFuHunDataById(t.readByte());e.setLv(t.readShort())},e.prototype.parserHuanHua=function(t){this.huanHuaId=t.readInt()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new MeilinHuanHuaData(t))},e.prototype.getHuanHuaGroupNames=function(){return Cfg.getMeilinHuanhuaGroupConfigNames()},e.prototype.getHuanHuaDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(MeilinHuanhuaGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getHuanHuaDataById(o))}return e},e.prototype.getHuanHuaDatas=function(){var t=[];for(var e in this.huanHuaDatas)t.push(this.huanHuaDatas[e]);return t},e.prototype.getFuHunDataById=function(t){return this.fuHunDatas[t-1]||(this.fuHunDatas[t-1]=new MeilinFuHunData(t))},e.prototype.getFuHunDatas=function(){return this.fuHunDatas},e.prototype.getLevelConsume=function(){return this.getLevelConfig().needitem},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.star>=i.star);t.push(r)}return t},e.prototype.getLevelHuanHuaDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getLevelHuanHuaDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelFuHunDatas=function(t){for(var e=[],i=t.getConfig(),n=i.attr.length,a=0;n>a;a++){var o=new AttrData(i.attr[a].type,i.attr[a].value*t.getLv()),s=new AttrData(i.attr[a].type,i.attr[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getLevelFuHunDatasAll=function(){var t=[];for(var e in this.fuHunDatas){var i=this.fuHunDatas[e],n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().attr)>>0},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getFuHunPower=function(){var t=0;for(var e in this.fuHunDatas){var i=this.fuHunDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getApperaenceId=function(){return this.getHuanHuaDataById(this.huanHuaId).getApperaenceId()},e.prototype.getSkillIds=function(){return Cfg.getConfig(MeilinConstConfig).skills},e.prototype.isMaxLv=function(){return this.getLevelConfig().star>=this.getLevelNextConfig().star},e}(SqXyBaseModel);__reflect(MeilinModel.prototype,"MeilinModel"),window.MeilinModel=MeilinModel;var ShenQiModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.fuHunDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.star==this.level||(this.levelConfig=Cfg.getConfig(ShenqiLevelConfig,this.level)),this.levelConfig},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.star<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(ShenqiLevelConfig,this.level)),this.levelNextConfig},e.prototype.parserInfo=function(t){this.huanHuaId=t.readInt(),this.level=t.readShort();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var n=1;e>=n;n++){var o=this.getFuHunDataById(n);o.setLv(t.readShort())}},e.prototype.parserUp=function(t){this.level=t.readShort()},e.prototype.parserHuanHuaUp=function(t){var e=this.getHuanHuaDataById(t.readInt());return e.level=t.readShort(),e},e.prototype.parserFuHunUp=function(t){var e=this.getFuHunDataById(t.readByte());e.setLv(t.readShort())},e.prototype.parserHuanHua=function(t){this.huanHuaId=t.readInt()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new ShenQiHuanHuaData(t))},e.prototype.getHuanHuaGroupNames=function(){return Cfg.getShenqiHuanhuaGroupConfigNames()},e.prototype.getHuanHuaDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(ShenqiHuanhuaGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getHuanHuaDataById(o))}return e},e.prototype.getHuanHuaDatas=function(){var t=[];for(var e in this.huanHuaDatas)t.push(this.huanHuaDatas[e]);return t},e.prototype.getFuHunDataById=function(t){return this.fuHunDatas[t-1]||(this.fuHunDatas[t-1]=new ShenQiFuHunData(t))},e.prototype.getFuHunDatas=function(){return this.fuHunDatas},e.prototype.getLevelConsume=function(){return this.getLevelConfig().needitem},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.star>=i.star);t.push(r)}return t},e.prototype.getLevelHuanHuaDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getLevelHuanHuaDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelFuHunDatas=function(t){for(var e=[],i=t.getConfig(),n=i.attr.length,a=0;n>a;a++){var o=new AttrData(i.attr[a].type,i.attr[a].value*t.getLv()),s=new AttrData(i.attr[a].type,i.attr[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getLevelFuHunDatasAll=function(){var t=[];for(var e in this.fuHunDatas){var i=this.fuHunDatas[e],n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().attr)>>0},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getFuHunPower=function(){var t=0;for(var e in this.fuHunDatas){var i=this.fuHunDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getApperaenceId=function(){return this.getHuanHuaDataById(this.huanHuaId).getApperaenceId(Actor.ins().job)},e.prototype.getSkillIds=function(){return Cfg.getConfig(ShenqiConstConfig).skills},e.prototype.isMaxLv=function(){return this.getLevelConfig().star>=this.getLevelNextConfig().star},e}(SqXyBaseModel);__reflect(ShenQiModel.prototype,"ShenQiModel"),window.SqXyBaseModel=ShenQiModel;var YYMSTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="YYMSTabItemEUI",e.mcSelect=new MC,e.mcSelect.playFile(ResMgr.getEffName("yyms1"),-1),e.mcSelect.scaleX=e.mcSelect.scaleY=.4,e.groupSelect.addChild(e.mcSelect),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source="yyms_zycs_box"+t.id,this.imgYB.source="yyms_zycs_b"+t.id,this.updateRp()},e.prototype.updateRp=function(){this.redPoint.visible=RpSys.ins().getData(YYMSWin,YYMSPanel,this.itemIndex)},e}(BaseItemRender);__reflect(YYMSTabItem.prototype,"YYMSTabItem"),window.YYMSTabItem=YYMSTabItem;var YYMSWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[YYMSPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(YYMSWin.prototype,"YYMSWin"),window.YYMSWin=YYMSWin;var SqXySys=function(t){function e(){var e=t.call(this)||this;return e.shenQiModel=new ShenQiModel,e.wingModel=new WingModel,e.szModel=new SzModel,e.meilinModel=new MeilinModel,e.sysId=PackId.SQXY,e.reg(1,e.patchShenQiInfo),e.reg(2,e.patchShenQiUp),e.reg(3,e.patchShenQiHuanHuaUp),e.reg(4,e.patchShenQiFuHunUp),e.reg(5,e.patchShenQiHuanHua),e.reg(11,e.patchWingInfo),e.reg(12,e.patchWingUp),e.reg(13,e.patchWingHuanHuaUp),e.reg(14,e.patchWingFuHunUp),e.reg(15,e.patchWingHuanHua),e.reg(21,e.patchSzInfo),e.reg(22,e.patchSzUp),e.reg(23,e.patchSzHuanHuaUp),e.reg(24,e.patchSzFuHunUp),e.reg(25,e.patchSzHuanHua),e.reg(31,e.patchMeilinInfo),e.reg(32,e.patchMeilinUp),e.reg(33,e.patchMeilinHuanHuaUp),e.reg(34,e.patchMeilinFuHunUp),e.reg(35,e.patchMeilinHuanHua),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchShenQiInfo=function(t){this.shenQiModel.parserInfo(t)},e.prototype.sendShenQiUp=function(){this.sendBase(2)},e.prototype.patchShenQiUp=function(t){this.shenQiModel.parserUp(t),RpFun.showShenQiLvRedPoint(SysId.ShenQi),RpFun.showShenQiSkillRedPoint(SysId.ShenQi),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB)},e.prototype.snedShenQiHuanHuaUp=function(t){var e=this.getBytes(3);e.writeInt(t),this.send(e)},e.prototype.patchShenQiHuanHuaUp=function(t){var e=this.shenQiModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.ShenQi),RpFun.showShenQiHuanHuaRedPoint(SysId.ShenQi)},e.prototype.sendShenQiFuHunUp=function(t){var e=this.getBytes(4);e.writeByte(t),this.send(e)},e.prototype.patchShenQiFuHunUp=function(t){this.shenQiModel.parserFuHunUp(t),RpFun.showShenQiFuHunRedPoint(SysId.ShenQi)},e.prototype.sendShenQiHuanHua=function(t){var e=this.getBytes(5);e.writeInt(t),this.send(e)},e.prototype.patchShenQiHuanHua=function(t){this.shenQiModel.parserHuanHua(t)},e.prototype.patchWingInfo=function(t){this.wingModel.parserInfo(t)},e.prototype.sendWingUp=function(){this.sendBase(12)},e.prototype.patchWingUp=function(t){this.wingModel.parserUp(t),RpFun.showShenQiLvRedPoint(SysId.Wing),RpFun.showShenQiSkillRedPoint(SysId.Wing),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB)},e.prototype.snedWingHuanHuaUp=function(t){var e=this.getBytes(13);e.writeInt(t),this.send(e)},e.prototype.patchWingHuanHuaUp=function(t){var e=this.wingModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.Wing),RpFun.showShenQiHuanHuaRedPoint(SysId.Wing)},e.prototype.sendWingFuHunUp=function(t){var e=this.getBytes(14);e.writeByte(t),this.send(e)},e.prototype.patchWingFuHunUp=function(t){this.wingModel.parserFuHunUp(t),RpFun.showShenQiFuHunRedPoint(SysId.Wing)},e.prototype.sendWingHuanHua=function(t){var e=this.getBytes(15);e.writeInt(t),this.send(e)},e.prototype.patchWingHuanHua=function(t){this.wingModel.parserHuanHua(t)},e.prototype.patchSzInfo=function(t){this.szModel.parserInfo(t)},e.prototype.sendSzUp=function(){this.sendBase(22)},e.prototype.patchSzUp=function(t){this.szModel.parserUp(t),RpFun.showShenQiLvRedPoint(SysId.Sz),RpFun.showShenQiSkillRedPoint(SysId.Sz),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB)},e.prototype.snedSzHuanHuaUp=function(t){var e=this.getBytes(23);e.writeInt(t),this.send(e)},e.prototype.patchSzHuanHuaUp=function(t){var e=this.szModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.Sz),RpFun.showShenQiHuanHuaRedPoint(SysId.Sz)},e.prototype.sendSzFuHunUp=function(t){var e=this.getBytes(24);e.writeByte(t),this.send(e)},e.prototype.patchSzFuHunUp=function(t){this.szModel.parserFuHunUp(t),RpFun.showShenQiFuHunRedPoint(SysId.Sz)},e.prototype.sendSzHuanHua=function(t){var e=this.getBytes(25);e.writeInt(t),this.send(e)},e.prototype.patchSzHuanHua=function(t){this.szModel.parserHuanHua(t)},e.prototype.patchMeilinInfo=function(t){this.meilinModel.parserInfo(t)},e.prototype.sendMeilinUp=function(){this.sendBase(32)},e.prototype.patchMeilinUp=function(t){this.meilinModel.parserUp(t),RpFun.showShenQiLvRedPoint(SysId.Meilin),RpFun.showShenQiSkillRedPoint(SysId.Meilin),RpFun.showActRp(SysId.KFCB),RpFun.showActRp(SysId.CZCB)},e.prototype.snedMeilinHuanHuaUp=function(t){var e=this.getBytes(33);e.writeInt(t),this.send(e)},e.prototype.patchMeilinHuanHuaUp=function(t){var e=this.meilinModel.parserHuanHuaUp(t);1==e.level&&GFunc.OpenSqXyActTipsWin(SqXyActTipsWin,e,SysId.Meilin),RpFun.showShenQiHuanHuaRedPoint(SysId.Meilin)},e.prototype.sendMeilinFuHunUp=function(t){var e=this.getBytes(34);e.writeByte(t),this.send(e)},e.prototype.patchMeilinFuHunUp=function(t){this.meilinModel.parserFuHunUp(t),RpFun.showShenQiFuHunRedPoint(SysId.Meilin)},e.prototype.sendMeilinHuanHua=function(t){var e=this.getBytes(35);e.writeInt(t),this.send(e)},e.prototype.patchMeilinHuanHua=function(t){this.meilinModel.parserHuanHua(t)},e.prototype.getModelBySysId=function(t){var e=null;switch(t){case SysId.ShenQi:e=this.shenQiModel;break;case SysId.Wing:e=this.wingModel;break;case SysId.Sz:e=this.szModel;break;case SysId.Meilin:e=this.meilinModel}return e},e}(BaseSys);__reflect(SqXySys.prototype,"SqXySys"),SystemMap.SqXySys=SqXySys.ins.bind(SqXySys),window.SqXySys=SqXySys;var SqXyWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e.redPointHead=[RoleWin,RolePanel],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShenQiPanel,WingPanel,SzPanel,MeilinPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e,i){t.prototype.open.call(this,e,i),this.panelTabIndex=-1},e}(BaseDuoPanelWin);__reflect(SqXyWin.prototype,"SqXyWin"),window.SqXyWin=SqXyWin;var SzModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.fuHunDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.star==this.level||(this.levelConfig=Cfg.getConfig(SzLevelConfig,this.level)),this.levelConfig},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.star<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(SzLevelConfig,this.level)),this.levelNextConfig},e.prototype.parserInfo=function(t){this.huanHuaId=t.readInt(),this.level=t.readShort();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var n=1;e>=n;n++){var o=this.getFuHunDataById(n);o.setLv(t.readShort())}},e.prototype.parserUp=function(t){this.level=t.readShort()},e.prototype.parserHuanHuaUp=function(t){var e=this.getHuanHuaDataById(t.readInt());return e.level=t.readShort(),e},e.prototype.parserFuHunUp=function(t){var e=this.getFuHunDataById(t.readByte());e.setLv(t.readShort())},e.prototype.parserHuanHua=function(t){this.huanHuaId=t.readInt()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new SzHuanHuaData(t))},e.prototype.getHuanHuaGroupNames=function(){return Cfg.getSzHuanhuaGroupConfigNames()},e.prototype.getHuanHuaDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(SzHuanhuaGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getHuanHuaDataById(o))}return e},e.prototype.getHuanHuaDatas=function(){var t=[];for(var e in this.huanHuaDatas)t.push(this.huanHuaDatas[e]);return t},e.prototype.getFuHunDataById=function(t){return this.fuHunDatas[t-1]||(this.fuHunDatas[t-1]=new SzFuHunData(t))},e.prototype.getFuHunDatas=function(){return this.fuHunDatas},e.prototype.getLevelConsume=function(){return this.getLevelConfig().needitem},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.star>=i.star);t.push(r)}return t},e.prototype.getLevelHuanHuaDatas=function(t){for(var e=[],i=t.getAttrsByLv(),n=t.getAttrsByLv(t.level+1),a=t.level>=t.getConfig().maxLevel,o=i.length,s=0;o>s;s++){var r=new ComAttrData(i[s],n[s],a);e.push(r)}return e},e.prototype.getLevelHuanHuaDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelFuHunDatas=function(t){for(var e=[],i=t.getConfig(),n=i.attr.length,a=0;n>a;a++){var o=new AttrData(i.attr[a].type,i.attr[a].value*t.getLv()),s=new AttrData(i.attr[a].type,i.attr[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getLevelFuHunDatasAll=function(){var t=[];for(var e in this.fuHunDatas){var i=this.fuHunDatas[e],n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().attr)>>0},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getFuHunPower=function(){var t=0;for(var e in this.fuHunDatas){var i=this.fuHunDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getApperaenceId=function(){return this.getHuanHuaDataById(this.huanHuaId).getApperaenceId(Actor.ins().job)},e.prototype.getSkillIds=function(){return Cfg.getConfig(SzConstConfig).skills},e.prototype.isMaxLv=function(){return this.getLevelConfig().star>=this.getLevelNextConfig().star},e}(SqXyBaseModel);__reflect(SzModel.prototype,"SzModel"),window.SzModel=SzModel;var WingModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huanHuaDatas=[],e.fuHunDatas=[],e}return __extends(e,t),e.prototype.getLevelConfig=function(){return this.levelConfig&&this.levelConfig.star==this.level||(this.levelConfig=Cfg.getConfig(WingLevelConfig,this.level)),this.levelConfig},e.prototype.getLevelNextConfig=function(){return(!this.levelNextConfig||this.levelNextConfig.star<=this.level)&&(this.levelNextConfig=Cfg.getNextConfig(WingLevelConfig,this.level)),this.levelNextConfig},e.prototype.parserInfo=function(t){this.huanHuaId=t.readInt(),this.level=t.readShort();for(var e=t.readByte(),i=0;e>i;i++){var n=t.readInt(),a=t.readShort(),o=this.getHuanHuaDataById(n);o.level=a}e=t.readByte();for(var n=1;e>=n;n++){var o=this.getFuHunDataById(n);o.setLv(t.readShort())}},e.prototype.parserUp=function(t){this.level=t.readShort()},e.prototype.parserHuanHuaUp=function(t){var e=this.getHuanHuaDataById(t.readInt());return e.level=t.readShort(),e},e.prototype.parserFuHunUp=function(t){var e=this.getFuHunDataById(t.readByte());e.setLv(t.readShort())},e.prototype.parserHuanHua=function(t){this.huanHuaId=t.readInt()},e.prototype.getHuanHuaDataById=function(t){return this.huanHuaDatas[t]||(this.huanHuaDatas[t]=new WingHuanHuaData(t))},e.prototype.getHuanHuaGroupNames=function(){return Cfg.getWingHuanhuaGroupConfigNames()},e.prototype.getHuanHuaDatasByGroupId=function(t){for(var e=[],i=Cfg.getConfig(WingHuanhuaGroupConfig,t),n=0,a=i.huanhuaIds;n<a.length;n++){var o=a[n];e.push(this.getHuanHuaDataById(o))}return e},e.prototype.getHuanHuaDatas=function(){var t=[];for(var e in this.huanHuaDatas)t.push(this.huanHuaDatas[e]);return t},e.prototype.getFuHunDataById=function(t){return this.fuHunDatas[t-1]||(this.fuHunDatas[t-1]=new WingFuHunData(t))},e.prototype.getFuHunDatas=function(){return this.fuHunDatas},e.prototype.getLevelConsume=function(){return this.getLevelConfig().needitem},e.prototype.getLevelAttrDatas=function(){for(var t=[],e=this.getLevelConfig(),i=this.getLevelNextConfig(),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.star>=i.star);t.push(r)}return t},e.prototype.getLevelHuanHuaDatas=function(t){for(var e=[],i=t.getConfig(),n=t.getAttrsByLv(),a=t.getAttrsByLv(t.level+1),o=t.level>=i.maxLevel,s=n.length,r=0;s>r;r++){var u=new ComAttrData(n[r],a[r],o);e.push(u)}return e},e.prototype.getLevelHuanHuaDatasAll=function(){var t=[];for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];t=AttrData.mergeAttr(i.getAttrsByLv(),t)}return t},e.prototype.getLevelFuHunDatas=function(t){for(var e=[],i=t.getConfig(),n=i.attr.length,a=0;n>a;a++){var o=new AttrData(i.attr[a].type,i.attr[a].value*t.getLv()),s=new AttrData(i.attr[a].type,i.attr[a].value*(t.getLv()+1)),r=new ComAttrData(o,s,t.isMax());e.push(r)}return e},e.prototype.getLevelFuHunDatasAll=function(){var t=[];for(var e in this.fuHunDatas){var i=this.fuHunDatas[e],n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t=AttrData.mergeAttr(n,t)}return t},e.prototype.getLevelPower=function(){return GFunc.getPower(this.getLevelConfig().attr)>>0},e.prototype.getHuanHuaPower=function(){var t=0;for(var e in this.huanHuaDatas){var i=this.huanHuaDatas[e];i.level>0&&(t+=GFunc.getPower(i.getAttrsByLv())>>0)}return t},e.prototype.getFuHunPower=function(){var t=0;for(var e in this.fuHunDatas){var i=this.fuHunDatas[e];if(i.getLv()>0){var n=AttrData.attrMultiple(i.getConfig().attr,i.getLv());t+=GFunc.getPower(n)>>0}}return t},e.prototype.getApperaenceId=function(){return this.getHuanHuaDataById(this.huanHuaId||1).getApperaenceId(Actor.ins().job)},e.prototype.getSkillIds=function(){return Cfg.getConfig(WingConstConfig).skills},e.prototype.isMaxLv=function(){return this.getLevelConfig().star>=this.getLevelNextConfig().star},e}(SqXyBaseModel);__reflect(WingModel.prototype,"WingModel"),window.WingModel=WingModel;var MeilinFuHunData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(MeilinPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(MeilinPillMaxConfig,this.id,CondType.More,MeilinPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(MeilinPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("merlin_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"ml_zycs_sh"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().attr},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(MeilinFuHunData.prototype,"MeilinFuHunData"),window.MeilinFuHunData=MeilinFuHunData;
var MeilinHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(MeilinHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){void 0===t&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name[0]},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(){return this.getConfig().appearanceId},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return SqXySys.ins().meilinModel.huanHuaId==this.id},e}(BaseHuanHuaData);__reflect(MeilinHuanHuaData.prototype,"MeilinHuanHuaData"),window.MeilinHuanHuaData=MeilinHuanHuaData;var MeilinFuHunPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=69,e.imgBg.source="ml_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchMeilinFuHunUp,this.updatePanel)},e.prototype.sendPack=function(){SqXySys.ins().sendMeilinFuHunUp(this.data.id)},e.getSysId=function(){return SysId.Meilin},e}(ShenQiFuHunPanel);__reflect(MeilinFuHunPanel.prototype,"MeilinFuHunPanel"),window.MeilinFuHunPanel=MeilinFuHunPanel;var MeilinHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=68,e.imgBg.source="ml_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchMeilinHuanHuaUp,this.updateHuanHuaUp),this.addLsn(SqXySys.ins().patchMeilinHuanHua,this.updateHuanHua)},e.prototype.getNameRes=function(t){return"ml_zycs_"+this.data.id},e.prototype.getModel=function(){var t=Cfg.getConfig(MeilinAppearanceConfig,this.data.getApperaenceId()).appearance;return[ResMgr.getUIMeilinRes(t)]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(e)&&SqXySys.ins().snedMeilinHuanHuaUp(this.data.id);break;case this.btnHuanHua:SqXySys.ins().sendMeilinHuanHua(this.data.id)}},e.prototype.autoUp=function(){var t=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(t)?SqXySys.ins().snedMeilinHuanHuaUp(this.data.id):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Meilin},e}(ShenQiHuanHuaPanel);__reflect(MeilinHuanHuaPanel.prototype,"MeilinHuanHuaPanel"),window.MeilinHuanHuaPanel=MeilinHuanHuaPanel;var MeilinLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=67,e.imgBg.source="ml_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchMeilinUp,this.updatePanel)},e.prototype.getModel=function(){var t=Cfg.getConfig(MeilinAppearanceConfig,this.dataModel.getApperaenceId()).appearance;return[ResMgr.getUIMeilinRes(t)]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())&&(SqXySys.ins().sendMeilinUp(),this.playEff("pubsjeff"));break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())?(SqXySys.ins().sendMeilinUp(),this.playEff("pubsjeff")):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Meilin},e}(ShenQiLevelPanel);__reflect(MeilinLevelPanel.prototype,"MeilinLevelPanel"),window.MeilinLevelPanel=MeilinLevelPanel;var MeilinPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,SqXyWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[MeilinLevelPanel,MeilinHuanHuaPanel,MeilinFuHunPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="ShenQiPanelEUI"},e.getTitle=function(){return"btz_zycs_mlzs"},e.getTabTitle=function(){return"bqz_zycs_mlzs"},e.getSysId=function(){return SysId.Meilin},e}(BaseTabPanel);__reflect(MeilinPanel.prototype,"MeilinPanel"),window.MeilinPanel=MeilinPanel;var RechargeEverydayWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.layer=LayerMgr.Popup,this.skinName="RechargeEverydayWinEUI",this.addBg(),t.prototype.initUI.call(this),this.list.itemRenderer=ItemBaseRewardActivity,this.list.dataProvider=this.listAwardCollection=new eui.ArrayCollection,this.mcBtn=new MC,this.mcBtn.x=85,this.mcBtn.y=28,this.btnGetAward.addChild(this.mcBtn)},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(ActSys.ins().patchRechargeEveryDay,this.update),this.addLsn(ActSys.ins().patchActivityIsGetAwards,this.update),this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.btnGetAward,this.onClick),this.update()},e.prototype.update=function(){var t=ActSys.ins().getActivityDatasByType(ActType.TYPE_1,ActSubType.TYPE_7,SortType.down),e=ActSys.ins().getEveryDayPrice(),i=t[0];if(i){var n=i.getConfigs(),a=(i.dabiao,1),o=ActRewardState.NotReached;for(var s in n){if(o=i.getRewardStateById(a),a++,this.currentConfig=n[s],o==ActRewardState.CanGet)break;if(o==ActRewardState.NotReached)break;o==ActRewardState.Geted}this.btnRecharge.visible=o==ActRewardState.NotReached,this.btnGetAward.visible=o==ActRewardState.CanGet,this.btnGetAward.redPoint.visible=!0,this.btnHasGet.visible=o==ActRewardState.Geted,this.bmpWorth.text=this.currentConfig.worth.toFixed(0),this.listAwardCollection.source=this.currentConfig.rewards;var r=Math.max(this.currentConfig.condition-e,0);this.bmpzc.text=r.toString()}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnRecharge:closeWin(this),openWin(RechargeWin);break;case this.btnGetAward:BagSys.ins().checkBagFreeCount(5)&&ActSys.ins().sendReward(this.currentConfig.id,this.currentConfig.index)}},e}(BaseWinSingle);__reflect(RechargeEverydayWin.prototype,"RechargeEverydayWin"),window.RechargeEverydayWin=RechargeEverydayWin;var RechargeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RechargeItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.updasteState(),this.validateNow(),this.imgYb.source="sc_zycs_bg"+t.icon;var e=Cfg.getPayMoneyVipExpByYb(t.amount);this.lbYb.text=e+"",this.lbDoubleYb.text=e+"",this.lbPrice.text="¥"+Cfg.getPayMoneyRMBByYb(t.amount)+Lang.common_yuan},e.prototype.updasteState=function(){var t=this.data,e=RechargeActSys.ins().getOrderByIndex(t.id);t.isForeverDouble?this.currentState="yongjiu":this.currentState=0==e?"first":"none"},e.prototype.playSelectMC=function(){this.selectMc=this.selectMc||new MC,this.selectMc.playFile(ResMgr.getEffName("sc_zycs_dikuang"),-1),this.selectMc.x=187,this.selectMc.y=118,this.groupMC.addChild(this.selectMc)},e}(BaseItemRender);__reflect(RechargeItem.prototype,"RechargeItem"),window.RechargeItem=RechargeItem;var ShenQiFuHunData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(ShenqiPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(ShenqiPillMaxConfig,this.id,CondType.More,ShenqiPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(ShenqiPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("shenqi_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"shenqi_zycs_qh"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().attr},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(ShenQiFuHunData.prototype,"ShenQiFuHunData"),window.ShenQiFuHunData=ShenQiFuHunData;var ShenQiHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(ShenqiHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){void 0===t&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name[Actor.ins().job-1]},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(t){return this.getConfig().weaponIds[t-1]},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return SqXySys.ins().shenQiModel.huanHuaId==this.id},e}(BaseHuanHuaData);__reflect(ShenQiHuanHuaData.prototype,"ShenQiHuanHuaData"),window.ShenQiHuanHuaData=ShenQiHuanHuaData;var FuHunItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="FuHunItemEUI",e.showRedPoint(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof BaseFuHunData&&(this.imgIcon.source=this.data.getIcon(),this.lbCount.text=this.data.getLv()+"/"+this.data.getMaxLv(),this.imgName.source=this.data.getName(),this.data.isMaxCur()?this.showRedPoint(!1):this.showRedPoint(GFunc.isConsumeEnough(this.data.getConsume())))},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e.prototype.playEff=function(){this.mc||(this.mc=new MC),this.groupMc.addChild(this.mc),this.mc.playFile(ResMgr.getEffName("fhbd"),1)},e}(BaseItemRender);__reflect(FuHunItem.prototype,"FuHunItem"),window.FuHunItem=FuHunItem;var HuanHuaItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HuanHuaItemEUI",e.lbSyz.visible=!1,e.showRedPoint(!1),e.setSelect(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof BaseHuanHuaData)if(this.imgIcon.source=this.data.getIcon(),this.imgIcon.filters=this.data.level>0?[]:DisUtil.grayFilter(),this.imgAn.visible=0==this.data.level,this.lbSyz.visible=this.data.isUse(),this.imgColor.source=ResMgr.getItemqualityResource(this.data.getQuality()),this.imgSR.source="shenqi_zycs_"+this.data.getSrQuality(),this.lbLv.text=this.data.level>0?""+this.data.level+Lang.common_jie:this.data.getActDec(),this.lbName.textFlow=addColorTF(this.data.getName()),this.data.isMax())this.showRedPoint(!1);else{var t=GFunc.getItemDataRewardByJob(this.data.getConsume());this.showRedPoint(GFunc.isConsumeEnough(t))}},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(HuanHuaItem.prototype,"HuanHuaItem"),window.HuanHuaItem=HuanHuaItem;var RankDataHQZL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getRankStr=function(){return this.power>=1e8?Lang.rank_str15+"："+GFunc.overLength(this.power,2):Lang.rank_str15+"："+GFunc.overLength(this.power)},e}(RankDataPower);__reflect(RankDataHQZL.prototype,"RankDataHQZL"),window.RankDataHQZL=RankDataHQZL;var RechargeOtherMonthCardItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){this.imgBg.source="sc_zycs_yueka_jpg";var t=ActSys.ins().getActDataById(ActId.ID_99900),e=t.getConfig(),i=t.isInYueKaTime();this.lbPrice.text="￥"+Cfg.getPayMoneyRMBByYb(e.money)+"元",this.currentState=i?"buy":"nobuy",this.lbName.text="超值月卡",this.lbDesc.text="每日领取"+e.mailAward[0].count+"仙玉"},e}(RechargeOtherItem);__reflect(RechargeOtherMonthCardItem.prototype,"RechargeOtherMonthCardItem"),window.RechargeOtherMonthCardItem=RechargeOtherMonthCardItem;var RechargeOtherTeQuanCardItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){this.imgBg.source="sc_zycs_zztq_jpg";var t=ActSys.ins().getActDataById(ActId.ID_99500),e=t.getConfig(),i=t.isAct();this.lbPrice.text="￥"+Cfg.getPayMoneyRMBByYb(e.money)+"元",this.currentState=i?"buy":"nobuy",this.lbName.text="至尊特权",this.lbDesc.text="立即领取大量仙玉"},e}(RechargeOtherItem);__reflect(RechargeOtherTeQuanCardItem.prototype,"RechargeOtherTeQuanCardItem"),window.RechargeOtherTeQuanCardItem=RechargeOtherTeQuanCardItem;var ShenQiPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,SqXyWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ShenQiLevelPanel,ShenQiHuanHuaPanel,ShenQiFuHunPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="ShenQiPanelEUI"},e.getTitle=function(){return"btz_zycs_sq"},e.getTabTitle=function(){return"bqz_zycs_sq"},e.getSysId=function(){return SysId.ShenQi},e}(BaseTabPanel);__reflect(ShenQiPanel.prototype,"ShenQiPanel"),window.ShenQiPanel=ShenQiPanel;var SzFuHunData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(SzPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(SzPillMaxConfig,this.id,CondType.More,SzPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(SzPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("godequip_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"sz_zycs_kh"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().attr},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(SzFuHunData.prototype,"SzFuHunData");var SzHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(SzHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){isNaN(t)&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name[Actor.ins().job-1]},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(t){return this.getConfig().bodyIds[t-1]},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return 0==this.id||this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return SqXySys.ins().szModel.huanHuaId==this.id},e}(BaseHuanHuaData);__reflect(SzHuanHuaData.prototype,"SzHuanHuaData");var SzFuHunPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=66,e.imgBg.source="sz_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchSzFuHunUp,this.updatePanel)},e.prototype.sendPack=function(){SqXySys.ins().sendSzFuHunUp(this.data.id)},e.getSysId=function(){return SysId.Sz},e}(ShenQiFuHunPanel);__reflect(SzFuHunPanel.prototype,"SzFuHunPanel"),window.SzFuHunPanel=SzFuHunPanel;var SzHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=65,e.imgBg.source="sz_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchSzHuanHuaUp,this.updateHuanHuaUp),this.addLsn(SqXySys.ins().patchSzHuanHua,this.updateHuanHua)},e.prototype.getNameRes=function(t){return"sz_zycs_"+Actor.ins().job+t},e.prototype.getModel=function(){return[Cfg.getConfig(SzHuanhuaBaseConfig,this.data.id).uibody[Actor.ins().sex]]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(e)&&SqXySys.ins().snedSzHuanHuaUp(this.data.id);break;case this.btnHuanHua:SqXySys.ins().sendSzHuanHua(this.data.id)}},e.prototype.autoUp=function(){var t=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(t)?SqXySys.ins().snedSzHuanHuaUp(this.data.id):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Sz},e}(ShenQiHuanHuaPanel);__reflect(SzHuanHuaPanel.prototype,"SzHuanHuaPanel"),window.SzHuanHuaPanel=SzHuanHuaPanel;var SzLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=64,e.imgBg.source="sz_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchSzUp,this.updatePanel)},e.prototype.getModel=function(){return[Cfg.getConfig(SzHuanhuaBaseConfig,this.dataModel.huanHuaId).uibody[Actor.ins().sex]]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())&&(SqXySys.ins().sendSzUp(),this.playEff("pubsjeff"));break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())?(SqXySys.ins().sendSzUp(),this.playEff("pubsjeff")):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Sz},e}(ShenQiLevelPanel);__reflect(SzLevelPanel.prototype,"SzLevelPanel"),window.SzLevelPanel=SzLevelPanel;var SzPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,SqXyWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[SzLevelPanel,SzHuanHuaPanel,SzFuHunPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="ShenQiPanelEUI"},e.getTitle=function(){return"btz_zycs_sz"},e.getTabTitle=function(){return"bqz_zycs_sz"},e.getSysId=function(){return SysId.Sz},e}(BaseTabPanel);__reflect(SzPanel.prototype,"SzPanel"),window.SzPanel=SzPanel;var WingFuHunData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempLvC=0,e._tempLvN=0,e}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(WingPillConfig,this.id))},e.prototype.getCurMaxConfig=function(){return this._curMaxConfig&&this._tempLvC==this._level||(this._curMaxConfig=Cfg.getConfig(WingPillMaxConfig,this.id,CondType.More,WingPillMaxConfig.max,this._level),this._tempLvC=this._level),this._curMaxConfig},e.prototype.getNextMaxConfig=function(){return this._nextMaxConfig&&this._tempLvN==this._level||(this._nextMaxConfig=Cfg.getNextConfig(WingPillMaxConfig,this.id,this.getCurMaxConfig().index),this._tempLvN=this._level),this._nextMaxConfig},e.prototype.getIcon=function(){return ResMgr.getFuHunIcon("wing_"+this.id)},e.prototype.getMaxLv=function(){return this.getCurMaxConfig().max},e.prototype.getName=function(){return"chibang_zycs_yh"+this.id},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.isAct=function(){return this.getLv()>0},e.prototype.getBaseAttr=function(){return this.getConfig().attr},e.prototype.isMax=function(){return this.getCurMaxConfig().index>=this.getNextMaxConfig().index&&this.isMaxCur()},e.prototype.isMaxCur=function(){return this._level>=this.getCurMaxConfig().max},e}(BaseFuHunData);__reflect(WingFuHunData.prototype,"WingFuHunData"),window.WingFuHunData=WingFuHunData;var WingHuanHuaData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getConfig=function(){return this._baseConfig||(this._baseConfig=Cfg.getConfig(WingHuanhuaBaseConfig,this.id))},e.prototype.getBaseAttrs=function(){return this._baseAttrs||(this._baseAttrs=this.getConfig().baseAttrs),this._baseAttrs},e.prototype.getAttrsByLv=function(t){isNaN(t)&&(t=this.level);for(var e=this.getBaseAttrs(),i=[],n=e.length,a=0;n>a;a++){var o=e[a];i.push(new AttrData(o.type,o.value*t))}return i},e.prototype.getName=function(){return this.getConfig().name[Actor.ins().job-1]},e.prototype.getQuality=function(){return this.getConfig().quality},e.prototype.getSrQuality=function(){return this.getConfig().srQuality},e.prototype.getActDec=function(){return this.getConfig().dec},e.prototype.getActPower=function(){return this.getConfig().power},e.prototype.getConsume=function(){return this.getConfig().needitem},e.prototype.getApperaenceId=function(t){return this.getConfig().wingIds[t-1]},e.prototype.getGroupId=function(){return this.getConfig().groupId},e.prototype.isAct=function(){return this.level>0},e.prototype.isMax=function(){return this.level>=this.getConfig().maxLevel},e.prototype.isUse=function(){return SqXySys.ins().wingModel.huanHuaId==this.id},e}(BaseHuanHuaData);__reflect(WingHuanHuaData.prototype,"WingHuanHuaData"),window.WingHuanHuaData=WingHuanHuaData;var WingFuHunPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=58,e.imgBg.source="wing_zycs_bg2_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchWingFuHunUp,this.updatePanel)},e.prototype.sendPack=function(){SqXySys.ins().sendWingFuHunUp(this.data.id)},e.getSysId=function(){return SysId.Wing},e}(ShenQiFuHunPanel);__reflect(WingFuHunPanel.prototype,"WingFuHunPanel"),window.WingFuHunPanel=WingFuHunPanel;var WingHuanHuaPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=57,e.imgBg.source="wing_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchWingHuanHuaUp,this.updateHuanHuaUp),this.addLsn(SqXySys.ins().patchWingHuanHua,this.updateHuanHua)},e.prototype.getNameRes=function(t){return"chibang_zycs_"+Actor.ins().job+t},e.prototype.getModel=function(){var t=Cfg.getConfig(WingAppearanceConfig,this.data.getApperaenceId(Actor.ins().job)).appearance;return[ResMgr.getWingUIEFFResource(t)]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:var e=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(e)&&SqXySys.ins().snedWingHuanHuaUp(this.data.id);break;case this.btnHuanHua:SqXySys.ins().sendWingHuanHua(this.data.id)}},e.prototype.autoUp=function(){var t=GFunc.getItemDataRewardByJob(this.data.getConsume());GFunc.checkConsumeEnough(t)?SqXySys.ins().snedWingHuanHuaUp(this.data.id):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Wing},e}(ShenQiHuanHuaPanel);__reflect(WingHuanHuaPanel.prototype,"WingHuanHuaPanel"),window.WingHuanHuaPanel=WingHuanHuaPanel;var WingLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=56,e.imgBg.source="wing_zycs_bg1_jpg",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(SqXySys.ins().patchWingUp,this.updatePanel)},e.prototype.getModel=function(){var t=Cfg.getConfig(WingAppearanceConfig,this.dataModel.getApperaenceId()).appearance;return[ResMgr.getWingUIEFFResource(t)]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())&&(SqXySys.ins().sendWingUp(),this.playEff("pubsjeff"));break;case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(this.dataModel.getLevelConsume())?(SqXySys.ins().sendWingUp(),this.playEff("pubsjeff")):this.longPressBtnUp.stop()},e.getTitle=function(){return"btz_zycs_rw"},e.getSysId=function(){return SysId.Wing},e}(ShenQiLevelPanel);__reflect(WingLevelPanel.prototype,"WingLevelPanel"),window.WingLevelPanel=WingLevelPanel;var WingPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,SqXyWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[WingLevelPanel,WingHuanHuaPanel,WingFuHunPanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="ShenQiPanelEUI"},e.getTitle=function(){return"btz_zycs_cb"},e.getTabTitle=function(){return"bqz_zycs_cb"},e.getSysId=function(){return SysId.Wing},e}(BaseTabPanel);__reflect(WingPanel.prototype,"WingPanel"),window.WingPanel=WingPanel;var SuitData=function(t){function e(){var e=t.call(this)||this;return e.posDatas=[],e}return __extends(e,t),e.prototype.parser=function(t){this.id=t.readShort();var e=t.readByte();this.xlId=this.xlConfig.xlId;for(var i=0;e>i;i++){var n=this.posDatas[i]=new SuitDataPos;n.pos=i,n.id=this.id,n.xlId=this.xlId,n.state=t.readByte()}},e.prototype.setPosValue=function(t,e){this.posDatas[t].state=e},e.prototype.getPosData=function(t){return this.posDatas[t]},e.prototype.canDianliang=function(){for(var t=!1,e=0,i=this.posDatas;e<i.length;e++){var n=i[e];if(t=n.canDianliang())break}return t},e.prototype.getMinPos=function(){return this.getDianliangCount()<8},e.prototype.getCanDianliangPos=function(){for(var t=0;t<this.posDatas.length;t++)if(this.posDatas[t].canDianliang())return t;return-1},e.prototype.isMax=function(){return this.getDianliangCount()>=8},e.prototype.getDianliangCount=function(){for(var t=0,e=0,i=this.posDatas;e<i.length;e++){var n=i[e];t+=n.state}return t},Object.defineProperty(e.prototype,"power",{get:function(){var t=0,e=Cfg.getSuitAttrConfigByCount(this.id,this.getDianliangCount());t+=GFunc.getPower(e);var i=this.config.skillattrs;return this.isMax()&&(t+=GFunc.getPower([i]),t+=this.config.power),t},enumerable:!0,configurable:!0}),e}(SuitDataBase);__reflect(SuitData.prototype,"SuitData"),window.SuitData=SuitData;var RechargePanel=function(t){function e(){var e=t.call(this)||this;return e.dataArr=[],e.itemIndex=0,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="RechargePanelEUI",this.setSkinPart("rechargeOtherMonthCardItem",new RechargeOtherMonthCardItem),this.setSkinPart("rechargeOtherTeQuanCardItem",new RechargeOtherTeQuanCardItem),this.list.itemRenderer=RechargeItem,this.scrollBar.viewport=this.list;var t=Cfg.getConfigs(PayItemsConfig);this.dataArr=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];n.isShow&&this.dataArr.push(n)}this.list.useVirtualLayout=!1,this.list.dataProvider=this.arrData=new eui.ArrayCollection(this.dataArr)},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this),this.addClickE(this.rechargeOtherMonthCardItem,this.onClick),this.addClickE(this.rechargeOtherTeQuanCardItem,this.onClick),this.addClickE(this.btnVip,this.onClick),this.addClickE(this.list,this.onClick),this.addLsn(RechargeActSys.ins().patchUpDataItem,this.updatePanel),this.addLsn(RechargeActSys.ins().patchUpDataItem,this.updatePanel),this.addLsn(RechargeActSys.ins().patchZZTQ,this.updatePanel),this.addLsn(VipSys.ins().patchSvipData,this.changeExpBar),this.addLsn(RechargeActSys.ins().patchJinZuanValueUpdate,this.updateJinZuanData),this.addLsn(VipSys.ins().patchSvipLvChange,this.updateJinZuanData),this.updatePanel(),this.changeExpBar(),this.updateJinZuanData(),this.list.validateNow(),this.scroller.validateNow();for(var i=this.list.numElements,n=-1,a=0;i>a;a++){var o=this.list.getElementAt(a);if(o&&o.data){var s=o.data;if(s.amount==e){n=a;break}}}if(n>=0){var r=213*Math.floor(n/2),u=this.scroller.viewport.contentHeight-this.scroller.height;r>=u&&(r=u),0>r&&(r=0),this.scroller.viewport.scrollV=r;var o=this.list.getElementAt(n);o&&o.playSelectMC()}},e.prototype.updatePanel=function(){this.rechargeOtherMonthCardItem.open(),this.rechargeOtherTeQuanCardItem.open();for(var t=this.list.numElements,e=0;t>e;e++){var i=this.list.getElementAt(e);i&&i.updasteState()}},e.prototype.updateJinZuanData=function(){var t=RechargeActSys.ins().jinZuanData,e=Cfg.getConfig(SVipConfig,Actor.ins().sVipLv);this.lbDesc.textFlow=addColorTF(addColor("购买仙玉赠送的仙券",5767068)+"会计入每日仙券获取上限,每日仙券上限"+addColor(""+e.jinzhuan,5767068)),this.lbDesc1.textFlow=addColorTF("今日已获取仙券:"+addColor(t.jinzuanValue+"/"+e.jinzhuan+"(提升SVIP等级可以提高每日仙券获取上限)",5767068))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeOtherMonthCardItem:openWin(YKWin),closeWin(RechargeWin2);break;case this.rechargeOtherTeQuanCardItem:openWin(ZZTQWin),closeWin(RechargeWin2);break;case this.btnVip:openWin(SVipTequanTipsWin,Actor.ins().sVipLv);break;default:var e=t.target.parent,i=e.data;this.itemIndex=e.itemIndex,i&&VipSys.ins().showReCharge(i.amount)}},e.prototype.changeExpBar=function(){var t=Cfg.getConfig(SVipConfig,Actor.ins().sVipLv),e=0,i=VipSys.ins().sVipExp;t&&(e=Actor.ins().sVipLv,this.curVip.text=e.toString());var n=e+1;n=n>Cfg.getSVipMaxLv()?Cfg.getSVipMaxLv():n;var a=Cfg.getConfig(SVipConfig,n),o=0,s="";e<Cfg.getSVipMaxLv()?(o=a.needYb-i,s=Lang.vip_str1.replace("$yb$",""+StrUtil.addColor(""+o+Lang.common_zs,16755236)).replace("$vip$",""+(Actor.ins().sVipLv+1)),this.expBar.maximum=a.needYb,this.expBar.value=i):(s=Lang.vip_str2,this.expBar.labelDisplay.visible=!1,this.expBar.maximum=1,this.expBar.value=1),this.titleLabel.textFlow=StrUtil.toTF(s)},e.getSysId=function(){return SysId.recharge},e.getTitle=function(){return"btz_zycs_zscz"},e.getTabTitle=function(){return"bqz_zycs_cz"},e.isShow=function(){return!0},e}(BasePanel);__reflect(RechargePanel.prototype,"RechargePanel"),window.RechargePanel=RechargePanel;var SuitDataPos=function(t){function e(){var e=t.call(this)||this;return e.pos=0,e.state=0,e
}return __extends(e,t),e.prototype.canDianliang=function(){if(0==this.state&&Actor.ins().zsId>=Cfg.getConfig(SuitXLConfig,this.xlId).zsId){var t=BagSys.ins().getEquipByIndex(this.pos);if(t.hasEquipOn())return this.isInCondition(t.rank,t.star,t.quality)}return!1},e}(SuitDataBase);__reflect(SuitDataPos.prototype,"SuitDataPos"),window.SuitDataPos=SuitDataPos;var SuitPanel=function(t){function e(){var e=t.call(this)||this;e.helpId=74,e.lastTabIndex=0,e.curTabIndex=0,e.suitSelectIndex=0,e.skinName="SuitPanelEUI",e.listItem.itemRenderer=SuitPanelItem,e.listItem.dataProvider=e.listItemArray=new eui.ArrayCollection,e.listSuit.itemRenderer=SuitPanelTabItem,e.listSuit.dataProvider=e.listSuitArray=new eui.ArrayCollection,e.listTab.itemRenderer=BaseTabBtn,e.listTab.dataProvider=e.listTabArray=new eui.ArrayCollection;for(var i=Cfg.getConfigs(SuitXLConfig),n=[],a=0,o=i;a<o.length;a++){var s=o[a];n.push("bqz_zycs_"+Actor.ins().job+"_"+s.xlId+"_")}return e.listTabArray.source=n,e.setRedPointHead(RoleWin,RolePanel,SuitWin),e}return __extends(e,t),e.prototype.open=function(e,i){void 0===e&&(e=-1),void 0===i&&(i=0),t.prototype.open.call(this),this.addClickE(this.btnGetEquip,this.onclick),this.addClickE(this.btnDesc,this.onclick),this.addItemTapE(this.listItem,this.onItemClick),this.addItemTapE(this.listSuit,this.onSuitClick),this.addChangeE(this.listTab,this.onTabClick),this.addChangingE(this.listTab,this.checkIsOpen),this.addLsn(ForgeSys.ins().patchSuitUp,this.onSuitUp),this.addLsn(RpSys.ins().patchRp,this.onRedPoint);var n,a;if(-1==e?(s=this.getAutoTabIndex(),n=s[0],a=s[1]):(n=e,a=i),this.listTab.selectedIndex=this.curTabIndex=n,this.listSuit.selectedIndex=this.suitSelectIndex=a,this.updateSuitList(),this.updateItemList(),this.updateCurSuit(),this.updatePower(),this.updateBtnImg(),this.onRedPoint(),this.curTabIndex>3){var o=95*this.curTabIndex;o=o>=600?this.scrollerBase.viewport.contentWidth-490:o,this.scrollerBase.viewport.scrollH=o}var s},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.getAutoTabIndex=function(){for(var t=Cfg.getConfigs(SuitXLConfig),e=0;e<t.length;e++)for(var i=t[e].xlId,n=ForgeSys.ins().getSuitDatasByXLId(i),a=0;a<n.length;a++)if(n[a].canDianliang())return[e,a];var o,s;for(o=0;o<t.length;o++){var i=t[o].xlId,n=ForgeSys.ins().getSuitDatasByXLId(i);for(s=0;s<n.length;s++)if(n[s].getMinPos())return[o,s]}return this.getLastPos()},e.prototype.getLastPos=function(){var t=Cfg.getConfigs(SuitXLConfig),e=t[t.length-1].xlId,i=ForgeSys.ins().getSuitDatasByXLId(e);return[t.length-1,i.length-1]},e.prototype.onSuitUp=function(t){this.listItemArray.itemUpdated(t),this.updateSuitList(),this.updateCurSuit(),this.updateBtnImg(),this.updatePower()},e.prototype.onRedPoint=function(t){if(void 0===t&&(t=null),!t||t.check(this.getThisDef())){this.listTab.validateNow();for(var i=0;i<this.listTab.numElements;i++){var n=this.listTab.getChildAt(i);if(n){var a=this.getXLIdByIndex(i);n.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,SuitWin,e,a)}}this.listSuit.validateNow();for(var o=0;o<this.listSuit.numElements;o++){var s=this.listSuit.getChildAt(o);s&&s.updateRp()}}},e.prototype.getCurXLId=function(){return this.getXLIdByIndex(this.curTabIndex)},e.prototype.getXLIdByIndex=function(t){return t+1},e.prototype.updateSuitList=function(){this.listSuitArray.source=ForgeSys.ins().getSuitDatasByXLId(this.getCurXLId())},e.prototype.updateItemList=function(){for(var t=Cfg.getConfig(SuitXLConfig,this.getCurXLId()).ids[this.suitSelectIndex],i=ForgeSys.ins().getSuitDataById(t),n=[],a=e.orders,o=0;o<a.length;o++)n.push(i.getPosData(a[o]));this.listItemArray.source=n,this.listItemArray.refresh()},e.prototype.updateBtnImg=function(){var t=Cfg.getConfig(SuitXLConfig,this.getCurXLId()).ids[this.suitSelectIndex],e=ForgeSys.ins().getSuitDataById(t),i=e.isMax();this.btnGetEquip.visible=!i,this.imgDianliang.visible=i},e.prototype.updatePower=function(){var t=Cfg.getConfig(SuitXLConfig,this.getCurXLId()).ids[this.suitSelectIndex],e=ForgeSys.ins().getSuitDataById(t);this.bmpLabelPower.text=e.power.toFixed(0)},e.prototype.onItemClick=function(t){var e=t.itemIndex,i=this.listItemArray.getItemAt(e);i.state?showtipsFail("此部位已点亮,不可重复点亮！"):i.canDianliang()?ForgeSys.ins().sendSuitUp(i.id,i.pos):showtipsFail("未达到点亮条件！")},e.prototype.onSuitClick=function(t){this.suitSelectIndex=t.itemIndex,this.updateItemList(),this.updateCurSuit(),this.updatePower(),this.updateBtnImg()},e.prototype.checkIsOpen=function(t){var e=this.listTab.selectedIndex,i=Cfg.getConfig(SuitXLConfig,this.getXLIdByIndex(e)),n=!1;Actor.ins().zsId<i.zsId&&(showtipsFail(Lang.job_str30.replace("$str$",""+GFunc.getZSNameBydb(i.zsId))),n=!0),n&&(t.preventDefault(),this.curTabIndex=this.lastTabIndex,this.updateTabClick())},e.prototype.onTabClick=function(){this.lastTabIndex=this.curTabIndex,this.curTabIndex=this.listTab.selectedIndex,this.updateTabClick()},e.prototype.updateTabClick=function(){this.suitSelectIndex=0,this.listSuit.selectedIndex=0,this.updateSuitList(),this.updateItemList(),this.updateCurSuit(),this.updatePower(),this.updateBtnImg()},e.prototype.updateCurSuit=function(){var t=Cfg.getConfig(SuitXLConfig,this.getCurXLId()).ids[this.suitSelectIndex],e=ForgeSys.ins().getSuitDataById(t),i=e.config.condition,n=12704255,a="点亮条件：穿戴装备阶数≥"+addColor(i.rank+"阶，",n);a+="品质≥"+addColor(Lang.common_quality[i.quality]+"，",GConst.PZColor[i.quality]),a+="星数≥"+addColor(i.star+"星",n),this.labelCondition.textFlow=addColorTF(a);var o=e.getDianliangCount();this.labelDianliangCur.text="当前"+o+"件";var s=Cfg.getSuitAttrConfigByCount(t,o);if(this.labelAttr.text=AttrData.parse(s).join("\n"),!e.isMax()){this.labelDianliangNext.text="点亮"+(o+1)+"件";var r=Cfg.getSuitAttrConfigByCount(t,o+1),u=AttrData.diffAttr(s,r);this.labelAttrNext.textFlow=addColorTF(AttrData.parse(u,{fm:" +%v"}).join("\n"))}this.currentState=e.isMax()?"max":"normal";var h=e.config.skilldesc[Actor.ins().job-1],p="";8>o&&(p="\n"+addColor("(点亮8件后激活)",15733780)),this.labelSkill.textFlow=addColorTF(h+p)},e.prototype.onclick=function(t){switch(t.currentTarget){case this.btnGetEquip:openWin(MeNeedLevelWin,2);break;case this.btnDesc:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId).text)}},e.getTitle=function(){return"btz_zycs_tz"},e.getTabTitle=function(){return"bqz_zycs_sq"},e.getSysId=function(){return SysId.Suit},e.orders=[EquipPos.WEAPON,EquipPos.CLOTHES,EquipPos.HAND,EquipPos.LEG,EquipPos.HEAD,EquipPos.NECKLACE,EquipPos.EMBLEM,EquipPos.CALIGA],e}(BasePanel);__reflect(SuitPanel.prototype,"SuitPanel"),window.SuitPanel=SuitPanel;var SuitPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuitPanelItemEUI",e.setSkinPart("item",new ItemBase),e.item.touchEnabled=!1,e.item.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=BagSys.ins().getEquipByIndex(t.pos),i=e.hasEquipOn();this.mcJia="",this.mc2="",this.imgBg.source="",this.imgDi.source="";var n=SuitPanel.orders.indexOf(t.pos)<4?1:-1;if(i){if(t.state){this.currentState="yidianliang"+n;var a=Cfg.getSuitItemId(t.id,t.pos);this.item.data=GFunc.creatItemDataById(a)}else t.canDianliang()?(this.currentState="kedianliang"+n,this.item.data=GFunc.creatItemDataById(e.id),this.mcJia=ResMgr.getEffName("craft_zycs_jh"),this.mc2=ResMgr.getEffName("tzkdl")):(this.currentState="weidabiao"+n,this.item.data=GFunc.creatItemDataById(e.id));this.imgBg.source=ResMgr.getItemqualityResource(this.item.data.cfg.quality)}else this.currentState="wuzhuangbei"+n,this.imgDi.source="role_zycs_"+t.pos},e}(BaseItemRender);__reflect(SuitPanelItem.prototype,"SuitPanelItem"),window.SuitPanelItem=SuitPanelItem;var SuitPanelTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuitPanelTabItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.imgIcon.source="taozhuang_zycs_tb"+t.config.icon,this.labelName.text=Cfg.getSuitXLName(t.id,Actor.ins().job)+t.config.name;var e=t.isMax()?3821938:15733780;this.labelCount.textFlow=addColorTF("("+t.getDianliangCount().toString()+"/8)",e),this.udpateStasr(),this.updateRp()},e.prototype.updateRp=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,SuitWin,SuitPanel,t.xlConfig.xlId,t.id))},e.prototype.udpateStasr=function(){var t=this.data,e=t.config.star;if(this.groupStar.numChildren!=e){this.groupStar.removeChildren();for(var i=0;e>i;i++){var n=new eui.Image;n.source="taozhuang_zycs_xj",this.groupStar.addChild(n)}}},e}(BaseItemRender);__reflect(SuitPanelTabItem.prototype,"SuitPanelTabItem"),window.SuitPanelTabItem=SuitPanelTabItem;var SuitWin=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel],e.winType=WinType.OverlayWin,e.tabIndex=-1,e.suitIndex=0,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[SuitPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e,i){void 0===e&&(e=-1),void 0===i&&(i=0),this.tabIndex=e,this.suitIndex=i,t.prototype.open.call(this,0)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.groupPage.visible=!1},e.prototype.getParam=function(){return[this.tabIndex,this.suitIndex]},e.openCheck=function(){return t.openCheck.call(this,0)},e}(BaseWinAutoTab);__reflect(SuitWin.prototype,"SuitWin"),window.SuitWin=SuitWin;var TaskSys=function(t){function e(){var e=t.call(this)||this;return e.taskId=1,e.mainTaskType=1,e.mainTaskStatus=-1,e.mainTaskokValue=0,e.achDatas=[],e.saveMainTaskId=[],e.sysId=PackId.Task,e.reg(1,e.patchMainTaskUpdata),e.reg(3,e.patchMainTaskReward),e.reg(31,e.doChengjiuInfo),e.reg(32,e.doChengjiuUpdate),e.reg(50,e.patchLiLianData),e.reg(51,e.patchLiLianReceiveTaskReward),e.reg(52,e.patchLiLianReceiveDailyReward),e.reg(53,e.patchLiLianTaskUpdate),e.reg(54,e.patchLiLianJunXianpdate),e.reg(61,e.patchAgreementData),e.reg(62,e.patchAgreementUpdate),e.agreementData=new QiYue,e.liLianData=new LiLianData,e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchMainTaskReward=function(t){var e=t.readInt();return e},e.prototype.patchMainTaskUpdata=function(t){var e=this.taskId,i=this.mainTaskStatus;this.taskId=t.readInt(),this.mainTaskStatus=t.readInt(),this.mainTaskokValue=t.readInt();var n=t.readBoolean(),a=Cfg.getConfig(MainTaskConfig,this.taskId);this.mainTaskType=a.type,1==this.taskId&&0==this.mainTaskStatus||(n||e!=this.taskId||this.mainTaskStatus!=i)&&a.guiderId>0&&(0==this.mainTaskStatus&&GuiderTrigger.ins().trigger1(a.guiderId,GuiderStepType.JS),1==this.mainTaskStatus&&GuiderTrigger.ins().trigger1(a.guiderId,GuiderStepType.WC,150)),!n&&Cfg.getConfig(RechargeConstConfig).firstTipsTaskId.indexOf(this.taskId)>0&&0==this.mainTaskStatus&&RechargeActSys.ins().openFirstRechargeTipsWin()},e.prototype.sendMainTaskOK=function(){this.sendBase(2)},e.prototype.sendMainReward=function(){this.sendBase(2)},e.prototype.patchMainReward=function(t){for(var e=t.readInt(),i=0;e>i;i++){var n=new ItemDataReward;n.parser(t)}},e.prototype.doChengjiuInfo=function(t){this.achDatas=[];for(var e=t.readInt(),i=0;e>i;i++){var n=new ChengJiuData;n.parser(t),this.achDatas.push(n)}this.patchAchievePanel()},e.prototype.doChengjiuUpdate=function(t){var e=new ChengJiuData;e.parser(t);for(var i in this.achDatas)if(this.achDatas[i].type==e.type){this.achDatas[i]=e;break}this.patchAchievePanel()},e.prototype.patchAchievePanel=function(){},e.prototype.sendChengjiuReward=function(t){var e=this.getBytes(33);e.writeInt(t),this.send(e)},e.prototype.sendChengjiuRewardAll=function(){this.sendBase(34)},e.prototype.getAchieveData=function(t){for(var e=0,i=this.achDatas;e<i.length;e++){var n=i[e];if(t==n.id)return n}return null},e.prototype.getAchieveTabData=function(){if(this.achieveTabData)return this.achieveTabData;this.achieveTabData=[];var t=Cfg.getConfigs(AchievementTaskConfig,CondType.NONE),e=-1;for(var i in t)e!=t[i].page&&(e=t[i].page,this.achieveTabData.push(e));return this.achieveTabData},e.prototype.getChengjiuDataByType=function(t){if(void 0==this.achDatas)return void console.log("通过成就类型获取成就数据  achiEvement = null");for(var e=[],i=0,n=this.achDatas;i<n.length;i++){var a=n[i];a.config.page==t&&e.push(a)}return e},e.prototype.isTaskIsOk=function(t){return e.ins().taskId==t?2==e.ins().mainTaskStatus:e.ins().taskId>t},e.prototype.achieveSort=function(t,e){var i=0;return 1!=t.state&&1==e.state?1:1==t.state&&1!=e.state?-1:0!=t.state&&0==e.state?1:0==t.state&&0!=e.state?-1:(i=SortUtil.sortAsc(t.config.aType,e.config.aType),0!=i?i:i)},e.prototype.showGuide=function(t,e,i){void 0===i&&(i=0);var n=Cfg.getConfig(MainTaskConfig,t),a=n.controlTarget[0],o=n.controlTarget[1],s=n.controlTarget[2];a==TaskNavType.Guide&&e==o&&(0==i||i&&i==s)&&GFunc.createTaskNavData(n.controlTarget)["goto"]()},e.prototype.patchLiLianData=function(t){this.liLianData.parser(t),RpFun.showLiLianRedPoint()},e.prototype.sendLiLianReceiveTaskReward=function(t){var e=this.getBytes(51);e.writeByte(t),this.send(e)},e.prototype.patchLiLianReceiveTaskReward=function(t){this.liLianData.parserUpdateTask(t),RpFun.showLiLianRedPoint()},e.prototype.sendLiLianReceiveDailyReward=function(){var t=this.getBytes(52);this.send(t)},e.prototype.patchLiLianReceiveDailyReward=function(t){this.liLianData.rewardIndex=t.readByte(),RpFun.showLiLianRedPoint()},e.prototype.patchLiLianTaskUpdate=function(t){var e=t.readByte(),i=t.readByte(),n=t.readDouble(),a=this.liLianData.getTaskDataById(e);a&&(a.state=i,a.value=n),RpFun.showLiLianRedPoint()},e.prototype.patchLiLianJunXianpdate=function(t){var e=this.liLianData.id;this.liLianData.id=t.readShort();var i=Cfg.getConfig(JunxianLevelConfig,this.liLianData.id);openWin(LiLianPanelUpLevelTipsWin,e,this.liLianData.id,function(){i.rewards.length>0&&openWin(LiLianRewardTipsWin,i.rewards,Lang.fuli_str36)},this),RpFun.showLiLianRedPoint()},e.prototype.patchAgreementData=function(t){this.agreementData.parser(t),RpFun.showAgreementRedPoint(PCode.UPD)},e.prototype.patchAgreementUpdate=function(t){var e=t.readByte(),i=t.readShort(),n=t.readDouble(),a=t.readByte(),o=this.agreementData.getAgreementTypeByType(e),s=o.getAgreementInfoById(i);s.setvalue(n),s.setstate(a),o.isAct()&&openWin(Act6RewarWin,o.getConfig().items),RpFun.showAgreementRedPoint(PCode.UPD)},e.prototype.sendAgreementReceive=function(t,e){var i=this.getBytes(63);i.writeByte(t),i.writeShort(e),this.send(i)},e}(BaseSys);__reflect(TaskSys.prototype,"TaskSys"),SystemMap.TaskSys=TaskSys.ins.bind(TaskSys),window.TaskSys=TaskSys;var ChengJiuData=function(){function t(){this.id=0,this.type=0,this.state=0,this.value=0}return t.prototype.parser=function(t){this.type=t.readInt(),this.id=t.readInt(),this.state=t.readInt(),this.value=t.readDouble(),this.initConfig()},t.prototype.initConfig=function(){this.config=Cfg.getConfig(AchievementTaskConfig,this.id)},t}();__reflect(ChengJiuData.prototype,"ChengJiuData");var ChengJiuPanel=function(t){function e(){var e=t.call(this)||this;e.btnNum=0,e.isTouch=!1,e.skinName="ChengJiuPanelEUI",e.list.itemRenderer=ChengJiuItem;var i=TaskSys.ins().getAchieveTabData();return e.tabList.itemRenderer=ChengjiuTabItem,e.tabList.dataProvider=e.tabArrColl=new eui.ArrayCollection(i),e.btnNum=i.length,e.leftBtn.visible=e.rightBtn.visible=!1,e}return __extends(e,t),e.prototype.open=function(){this.addClickE(this.list,this.onSendFunc),this.addClickE(this.leftBtn,this.onTouchBtn),this.addClickE(this.rightBtn,this.onTouchBtn),this.addClickE(this.receiveBtn,this.onClick),this.addChangeE(this.tabList,this.onTabChange),this.addLsn(TaskSys.ins().patchAchievePanel,this.updateListPanel),this.addLsn(LogicSys.ins().patchCurrency,this.updateAchScore),this.tabList.selectedIndex=0,this.updateListPanel(),this.updateAchScore()},e.prototype.updateAchScore=function(t){t&&t.type!=CurType.achieve||(this.scoreTxt.text=""+Lang.task_str1+Actor.ins().getCurrency(CurType.achieve),this.isTouch&&(this.isTouch=!1,GFunc.playUIMovie("qjzlxg",190,68,this)))},e.prototype.onClick=function(t){switch(t.target){case this.receiveBtn:var i=RpSys.ins().getData(ExtCom,ChengJiuWin,e);if(!i)return showtipsFail(Lang.task_str2);this.isTouch=!0,TaskSys.ins().sendChengjiuRewardAll()}},e.prototype.onSendFunc=function(t){if("ChengJiuItem.sendBtn"==t.target.name){var e=t.target.parent.data;switch(e.state){case 0:GFunc.createTaskNavData(e.config.controlTarget)["goto"]();break;case 1:this.isTouch=!0,TaskSys.ins().sendChengjiuReward(e.id)}}},e.prototype.updateListPanel=function(){var t=TaskSys.ins().getChengjiuDataByType(this.tabList.selectedItem);t.sort(TaskSys.ins().achieveSort),this.list.dataProvider=new eui.ArrayCollection(t),this.tabArrColl.source=TaskSys.ins().getAchieveTabData()},e.prototype.onTabChange=function(t){var e=TaskSys.ins().getChengjiuDataByType(this.tabList.selectedItem);e.sort(TaskSys.ins().achieveSort),this.list.dataProvider=new eui.ArrayCollection(e)},e.prototype.onTouchBtn=function(t){var e=470;switch(t.target){case this.leftBtn:this.tabList.scrollH<=e?this.tabList.scrollH=0:this.tabList.scrollH-=e;break;case this.rightBtn:this.tabList.scrollH+e>94*(this.tabList.dataProvider.length-5)?this.tabList.scrollH=94*(this.tabList.dataProvider.length-5):this.tabList.scrollH+=e}},e.prototype.onScrollerChange=function(){this.tabList.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.tabList.scrollH>88*(this.tabList.dataProvider.length-5)+2?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.btnNum<=4&&(this.leftBtn.visible=!1,this.rightBtn.visible=!1)},e.getTitle=function(){return"btz_zycs_cj"},e.getTabTitle=function(){return"bqz_zycs_cj"},e.getSysId=function(){return SysId.oldSysId},e}(BasePanel);__reflect(ChengJiuPanel.prototype,"ChengJiuPanel");var ChengjiuTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChengjiuTabItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){"number"==typeof this.data&&(this.iconDisplay.source=ResMgr.getAchieveTabIcon(this.data),this.selectIcon.source=ResMgr.getAchieveTabSelectIcon(this.data),this.redPoint.visible=RpSys.ins().getData(ExtCom,ChengJiuWin,ChengJiuPanel,this.data))},e}(BaseItemRender);__reflect(ChengjiuTabItem.prototype,"ChengjiuTabItem");var ChengJiuItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChengJiuItemEUI",e.sendBtn.name="ChengJiuItem.sendBtn",e.list.itemRenderer=ItemBaseReward,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t&&0!=t.id){this.titleTF.text=t.config.desc;var e="进度：";e+=StrUtil.addColor(""+t.value,1945142),this.progressTF.textFlow=addColorTF(e),this.list.dataProvider=new eui.ArrayCollection(t.config.awardList),this.enabled=!0,0==t.state?this.sendBtn.icon="anz_zycs_qw":1==t.state?this.sendBtn.icon="anz_zycs_lq":2==t.state&&(this.sendBtn.icon="anz_zycs_ylq",this.enabled=!1),this.sendBtn.redPoint.visible=1==t.state}},e}(BaseItemRender);__reflect(ChengJiuItem.prototype,"ChengJiuItem"),window.ChengJiuPanel=ChengJiuPanel;var ChengJiuWin=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.redPointHead=[ExtCom],e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ChengJiuPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(ChengJiuWin.prototype,"ChengJiuWin"),window.ChengJiuWin=ChengJiuWin;var QiYueItem=function(t){function e(){var e=t.call(this)||this;return e.desc=["anz_zycs_qw","anz_zycs_lq","anz_zycs_ylq"],e.skinName="QiYueItemEUI",e.btnGet.redPoint.visible=!0,e.list.itemRenderer=ItemBaseReward,e.list.dataProvider=e.listArray=new eui.ArrayCollection,e.btnUpmc=new MovieEui,e.btnUpmc.verticalCenter=e.btnUpmc.horizontalCenter=0,e.btnGet.addChild(e.btnUpmc),e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;switch(t.target){case this.btnTaget:var i=GFunc.createTaskNavData(e.getConfig().controlTarget);i.setsucceedFrontFun(function(){closeWin(QiYueWin)}),i["goto"]();break;case this.btnGet:TaskSys.ins().sendAgreementReceive(e.type,e.id)}},e.prototype.dataChanged=function(){this.data instanceof QiYueInfo&&(this.titleTF.textFlow=StrUtil.toTF(this.data.getConfig().desc),this.progressTF.textFlow=addColorTF(this.data.getShowProg()),this.listArray.source=this.data.getConfig().rewards,this.btnTaget.visible=this.data.state==RewardStatus.WeiWanCheng,this.btnGet.visible=this.data.state==RewardStatus.KeLinQu,this.imgYlq.visible=this.data.state==RewardStatus.YiLinQu,this.btnUpmc.data=this.data.state==RewardStatus.KeLinQu?getEffName("public_zycs_button01"):"")},e}(BaseItemRender);__reflect(QiYueItem.prototype,"QiYueItem"),window.QiYueItem=QiYueItem;var QiYuePanel=function(t){function e(){var e=t.call(this)||this;return e.selectedIndex=0,e.skinName="QiYuePanelEUI",e.list.itemRenderer=QiYueItem,e.list.dataProvider=e.listArray=new eui.ArrayCollection,e.menuList.itemRenderer=QiYuePanelBtn,e.menuList.dataProvider=e.menuArrColl=new eui.ArrayCollection(TaskSys.ins().agreementData.agreementTypes),e.eff=new MC,e.eff.x=340,e.eff.y=350,e.addChild(e.eff),e}return __extends(e,t),e.prototype.open=function(){this.addClickE(this.menuList,this.onTabChange),this.addLsn(TaskSys.ins().patchAgreementData,this.updateListPanel),this.addLsn(TaskSys.ins().patchAgreementUpdate,this.updateListPanel),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.selectedIndex=TaskSys.ins().agreementData.getSelectTypeIndex(),this.menuList.selectedIndex=this.selectedIndex,this.updateListPanel(),this.updateRp()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e))for(var i=this.menuList.numElements,n=0;i>n;n++){var a=this.menuList.getElementAt(n);a&&a.updateRedPoint()}},e.prototype.updateListPanel=function(){var t=this.menuList.selectedItem,e=TaskSys.ins().agreementData.getAgreementTypeByType(t.type).agreementInfos;e.sort(this.achieveSort),this.listArray.source=e;var i=t.getSuccessCount()==t.getCount()?3473271:11870240,n=StrUtil.addColor(t.getSuccessCount()+"/"+t.getCount(),i);this.lbJinDu.textFlow=addColorTF(""+Lang.task_str3+n),this.sName=t.getConfig().name,this.desc=t.getConfig().desc,this.icon=t.getIcon(),this.eff.playFile(getEffName("jssg"+t.type),-1),this.imgYjh.visible=t.isAct()},e.prototype.onTabChange=function(t){var e=this.menuList.selectedItem;if(TaskSys.ins().agreementData.isOpen(e.type))this.selectedIndex=this.menuList.selectedIndex,this.updateListPanel();else{var i=TaskSys.ins().agreementData.isOpenData(e.type);showTipsWarn(Lang.task_str4.replace("$name$",i.getConfig().name)),this.menuList.selectedIndex=this.selectedIndex}},e.prototype.achieveSort=function(t,e){var i=0;return 1!=t.state&&1==e.state?1:1==t.state&&1!=e.state?-1:0!=t.state&&0==e.state?1:0==t.state&&0!=e.state?-1:0!=i?i:i},e.getTitle=function(){return"btz_zycs_emqy"},e.getTabTitle=function(){return"bqz_zycs_emqy"},e.getSysId=function(){return SysId.QiYue},e}(BasePanel);__reflect(QiYuePanel.prototype,"QiYuePanel"),window.QiYuePanel=QiYuePanel;var QiYuePanelBtn=function(t){function e(){var e=t.call(this)||this;return e.skinName="QiYuePanelBtnEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.updateRedPoint(),this.title="emqy_zycs_text"+(t.type-1||"")},e.prototype.updateRedPoint=function(){var t=this.data;this.redPoint.visible=RpSys.ins().getData(ExtCom,QiYueWin,QiYuePanel,t.type),this.updateIcon()},e.prototype.updateIcon=function(){var t=this.data;this.imgIcon.source="emqy_zycs_0"+t.type,this.imgIcon.filters=TaskSys.ins().agreementData.isOpen(t.type)?[]:DisUtil.grayFilter()},e}(BaseItemRender);__reflect(QiYuePanelBtn.prototype,"QiYuePanelBtn"),window.QiYuePanelBtn=QiYuePanelBtn;var QiYueWin=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.redPointHead=[ExtCom],e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[QiYuePanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(QiYueWin.prototype,"QiYueWin"),window.QiYueWin=QiYueWin;var QiYue=function(){function t(){this.agreementTypes=[]}return t.prototype.parser=function(t){var e=t.readByte();this.agreementTypes.length=0;for(var i=0;e>i;i++){var n=new QiYueType;n.parser(t),this.agreementTypes.push(n)}},t.prototype.getAgreementTypeByType=function(t){for(var e=0;e<this.agreementTypes.length;e++)if(this.agreementTypes[e].type==t)return this.agreementTypes[e];return this.agreementTypes[0]},t.prototype.getAgreementTypeByIndex=function(t){return this.agreementTypes[t]},t.prototype.isFinish=function(){for(var t=!0,e=0;e<this.agreementTypes.length;e++)if(!this.agreementTypes[e].isAct()){t=!1;break}return t},t.prototype.isOpen=function(t){var e=this.getAgreementTypeByType(t).getConfig().last;return 0==e||this.getAgreementTypeByType(e).isAct()},t.prototype.isOpenData=function(t){var e=this.getAgreementTypeByType(t).getConfig().last;return this.getAgreementTypeByType(e)},t.prototype.getSelectTypeIndex=function(){for(var t=1,e=!1,i=0;i<this.agreementTypes.length;i++){var n=this.agreementTypes[i];if(n.chekReceive()){e=!0,t=n.getConfig().tp;break}}if(!e)for(var i=0;i<this.agreementTypes.length;i++){var n=this.agreementTypes[i];if(!n.isAct()&&this.isOpen(n.type)){t=n.getConfig().tp;break}}return t-1},t}();__reflect(QiYue.prototype,"QiYue"),window.QiYue=QiYue;var RechargeTipsWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.setSkinName(),t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg()},e.prototype.setSkinName=function(){this.skinName="RechargeTipsWinEUI"},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick),this.lbContent.textFlow=addColorTF("仙玉不足,以下途径可以获取大量仙玉")},e.prototype.onClick=function(t){switch(t.target){case this.btnBuy:openWin(ZhaoCaiLongBuyWin),closeWin(this);break;case this.btnRecharge:openWin(RechargeWin2),closeWin(this);break;case this.closeBtn0:closeWin(this);break;case this.colorCanvas:this.clickClose&&closeWin(this)}},e}(BaseWinSingle);__reflect(RechargeTipsWin.prototype,"RechargeTipsWin"),window.RechargeTipsWin=RechargeTipsWin;var QiYueInfo1_5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(QiYueInfo);__reflect(QiYueInfo1_5.prototype,"QiYueInfo1_5"),window.QiYueInfo1_5=QiYueInfo1_5;var QiYueType=function(){function t(){this.type=1,this.agreementInfos=[]}return t.prototype.parser=function(t){this.type=t.readByte();for(var e=t.readShort(),i=0;e>i;i++){var n=t.readShort();t.position-=2;var a=this.createQiYueInfo(this.type,n);a.parser(t),this.agreementInfos.push(a)}},t.prototype.getConfig=function(){return this.config||(this.config=Cfg.getConfig(AgreementTypeConfig,this.type)),this.config},t.prototype.getAgreementInfoById=function(t){for(var e=0;e<this.agreementInfos.length;e++)if(this.agreementInfos[e].id==t)return this.agreementInfos[e];return this.agreementInfos[0]},t.prototype.getSuccessCount=function(){for(var t=0,e=0;e<this.agreementInfos.length;e++)this.agreementInfos[e].isSuccess()&&t++;return t},t.prototype.getCount=function(){return this.agreementInfos.length},t.prototype.chekReceive=function(){for(var t=0;t<this.agreementInfos.length;t++)if(this.agreementInfos[t].chekReceive())return!0;return!1},t.prototype.isAct=function(){return this.getCount()==this.getSuccessCount()},t.prototype.getIcon=function(){var t=Cfg.getItemCfg(this.getConfig().items[0].id);return ResMgr.getItemIcon(t.getIcon())},t.prototype.createQiYueInfo=function(t,e){var i,n=getDefinitionByName("QiYueInfo"+t+"_"+e);return i=n?new n:new QiYueInfo,i.setType(this.type),i},t}();__reflect(QiYueType.prototype,"QiYueType"),window.QiYueType=QiYueType;var RechargeWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=-1);for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.prototype.open.call(this,-1)},e.openCheck=function(){return RechargeActSys.ins().firstRechargeData.isRecharge()?openWin(RechargeWin2):openWin(FirstRechargeBuyWin),!1},e}(BaseWinAutoTab);__reflect(RechargeWin.prototype,"RechargeWin"),window.RechargeWin=RechargeWin;var TaskLoopData=function(t){function e(){var e=t.call(this)||this;return e.starValue=1,e.cd=0,e.count=0,e.maxCount=5,e.isLingquMaxReward=0,e.cd=e.cd+Timer.ins().getTimer(),e}return __extends(e,t),e.prototype.parser=function(t){this.id=t.readInt(),this.state=t.readInt(),this.value=t.readInt(),this.starValue=t.readInt(),this.loopIndex=t.readInt();var e=t.readInt();this.cd=1e3*e+Timer.ins().getTimer(),this.count=t.readShort(),this.isLingquMaxReward=t.readByte()},e.prototype.cdTick=function(){return Math.max(0,this.cd-Timer.ins().getTimer())/1e3},e.prototype.chekCount=function(){return this.count>0},e.prototype.isMax=function(){return 10==this.loopIndex&&2==this.state},e.prototype.canLingQu10=function(){return 10==this.loopIndex&&2==this.state&&!this.yiLingQu10()},e.prototype.yiLingQu10=function(){return 1==this.isLingquMaxReward},e}(TaskData);__reflect(TaskLoopData.prototype,"TaskLoopData"),window.TaskLoopData=TaskLoopData;var RechargeWin1=function(t){function e(){var e=t.call(this)||this;return e.panelIndex=0,e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[FirstRechargePanel,FirstRechargeEveryDayPanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg()},e.prototype.open=function(e){void 0===e&&(e=-1);for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.panelIndex=i[0]||0,t.prototype.open.call(this,e)},e.prototype.getParam=function(){return[this.panelIndex]},e}(BaseWinAutoTab);__reflect(RechargeWin1.prototype,"RechargeWin1"),window.RechargeWin1=RechargeWin1;var RechargeWin2=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.NormalWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[RechargePanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg("background_zycs_bg_jpg"),this.layer=LayerMgr.Popup,this.eGroup.visible=!1,this.closeBtn.icon="svip_zycs_close"},e.prototype.open=function(e){void 0===e&&(e=-1);for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.param1=i[0],t.prototype.open.call(this,e)},e.prototype.getParam=function(){return this.param1},e}(BaseWinAutoTab);__reflect(RechargeWin2.prototype,"RechargeWin2"),window.RechargeWin2=RechargeWin2;var TaskNavDataType10=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){var t=this.guideId,e=openWin(ChatWin,0);e.autoSetMsg(),GuiderTrigger.ins().trigger(t,GuiderStepType.HM)},Object.defineProperty(e.prototype,"guideId",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType10.prototype,"TaskNavDataType10"),window.TaskNavDataType10=TaskNavDataType10;var TaskNavDataType11=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){return showtipsFail(this.getMsg),!1},Object.defineProperty(e.prototype,"getMsg",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType11.prototype,"TaskNavDataType11"),window.TaskNavDataType11=TaskNavDataType11;var TaskNavDataType12=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){return GFunc.isInCity()&&LogicSys.ins().sendEnterFb(FbSys.ins().guajiFbId),FbSys.ins().sendGuaJiChallenge(),!0},e}(TaskNavDataBase);__reflect(TaskNavDataType12.prototype,"TaskNavDataType12"),window.TaskNavDataType12=TaskNavDataType12;var TaskNavDataType13=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){return GFunc.isInCity()?LogicSys.ins().sendEnterFb(FbSys.ins().guajiFbId):showtipsFail("正在杀怪中"),!0},Object.defineProperty(e.prototype,"getMsg",{get:function(){return this.controlTarget[1]
},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType13.prototype,"TaskNavDataType13"),window.TaskNavDataType13=TaskNavDataType13;var TaskNavDataType2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(e){void 0===e&&(e=null),t.prototype["goto"].call(this,e);if(FbSys.ins().fbId>Cfg.getConfig(EnumConfig).GUAJI_FUBEN_MAX_ID)return void showtipsFail(Lang.npc_str21);var i=Cfg.getConfig(NPCConfig,this.npcId());if(!this.isSameType(i.controlTarget)){var n=checkOpenWin(Cfg.getWinClassById(i.npcEvent.winId),i.npcEvent.winTab,i.npcEvent.winTab1);n?(this.succeedFrontFun.call(),LogicSys.ins().centerEntity.AI.startfindNpc(this.npcId(),function(){var t=Cfg.getWinClassById(i.npcEvent.winId);openWin(t,i.npcEvent.winTab,i.npcEvent.winTab,i.npcEvent.winTab1)}),this.succeedFun.call()):this.loserFun.call()}},e.prototype.npcId=function(t){return void 0===t&&(t=this.controlTarget),this.getParam(t,1)},e.prototype.isSameType=function(t){return t.type==this.type&&this.npcId(t)==this.npcId()},e}(TaskNavDataBase);__reflect(TaskNavDataType2.prototype,"TaskNavDataType2"),window.TaskNavDataType2=TaskNavDataType2;var TaskNavDataType3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){return t.prototype["goto"].call(this),FbSys.ins().fbId>Cfg.getConfig(EnumConfig).GUAJI_FUBEN_MAX_ID?void showtipsFail(Lang.npc_str21):void LogicSys.ins().sendEnterFb(FbSys.ins().guajiFbId)},Object.defineProperty(e.prototype,"fbId",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType3.prototype,"TaskNavDataType3"),window.TaskNavDataType3=TaskNavDataType3;var TaskNavDataType4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){t.prototype["goto"].call(this);var e=this.guideId;this.guidWin&&openWin(this.winName,this.guidWinTabIndex,this.guidWinSubTabIndex),GuiderTrigger.ins().trigger(e,GuiderStepType.HM)},Object.defineProperty(e.prototype,"guideId",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winName",{get:function(){return Cfg.getWinClassById(this.guidWin)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guidWin",{get:function(){return this.controlTarget[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guidWinTabIndex",{get:function(){return this.controlTarget[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guidWinSubTabIndex",{get:function(){return this.controlTarget[4]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType4.prototype,"TaskNavDataType4"),window.TaskNavDataType4=TaskNavDataType4;var TaskNavDataType5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){var t=checkOpenWin(this.winName,this.winPage,this.winSubPage);if(t?this.succeedFrontFun.call():this.loserFun.call(),t){var e=openWin(this.winName,this.winPage,this.winSubPage,this.winParam),i=null!=e;i&&this.succeedFun.call()}},Object.defineProperty(e.prototype,"winSubPage",{get:function(){return this.controlTarget[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winParam",{get:function(){return this.controlTarget[4]},enumerable:!0,configurable:!0}),e}(TaskNavDataType1);__reflect(TaskNavDataType5.prototype,"TaskNavDataType5"),window.TaskNavDataType5=TaskNavDataType5;var TaskNavDataType7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){t.prototype["goto"].call(this),this.succeedFrontFun.call()},e}(TaskNavDataBase);__reflect(TaskNavDataType7.prototype,"TaskNavDataType7"),window.TaskNavDataType7=TaskNavDataType7;var TaskNavDataType8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){t.prototype["goto"].call(this);var e=checkOpenWin(this.winName,this.actId);if(e?this.succeedFrontFun.call():this.loserFun.call(),e){var i=openWin(this.winName,this.actId),n=null!=i;n&&this.succeedFun.call()}},Object.defineProperty(e.prototype,"winName",{get:function(){var t,e=ActSys.ins().getActDataById(this.actId);return e.isSeeActivity()&&(e.onPlace==ActOnPlace.huodong?GFunc.isSysOpen(SysId.HDDT)?t=ActWin:GFunc.isSysOpen(SysId.oldSysId)&&(t=ActOpenServerWin):e.onPlace==ActOnPlace.hefu?t=ActHeFuWin:e.onPlace==ActOnPlace.juezhan?t=ActJueZhanWin:e.onPlace==ActOnPlace.ACT24&&(t=ActPlace24Win)),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actId",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType8.prototype,"TaskNavDataType8"),window.TaskNavDataType8=TaskNavDataType8;var TaskNavDataType9=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype["goto"]=function(){for(var t=this.guideId,e=0;e<GConst.GuiderId2EquiId.length;e++){var i=BagSys.ins().getItemById(GConst.GuiderId2EquiId[e]);i&&openWin(TipsWin).addNewEquipTips(i)}GuiderTrigger.ins().trigger(t,GuiderStepType.HM)},Object.defineProperty(e.prototype,"guideId",{get:function(){return this.controlTarget[1]},enumerable:!0,configurable:!0}),e}(TaskNavDataBase);__reflect(TaskNavDataType9.prototype,"TaskNavDataType9"),window.TaskNavDataType9=TaskNavDataType9;var TclySys=function(t){function e(){var e=t.call(this)||this;return e.tclyData=new TclyData,e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e}(BaseSys);__reflect(TclySys.prototype,"TclySys"),SystemMap.TclySys=TclySys.ins.bind(TclySys),window.TclySys=TclySys;var TclyData=function(){function t(){}return t}();__reflect(TclyData.prototype,"TclyData");var TclyItemData=function(){function t(){}return t}();__reflect(TclyItemData.prototype,"TclyItemData");var TclyItem=function(t){function e(){var e=t.call(this)||this;return e.mcBtn=new MC,e.skinName="TclyItemEUI",e.list.itemRenderer=ItemBaseRewardActivity,e.list.dataProvider=e.listAwardArr=new eui.ArrayCollection,e.mcBtn.x=e.btnSend.width/2,e.mcBtn.y=e.btnSend.height/2,e.btnSend.addChildAt(e.mcBtn,e.btnSend.numChildren-1),e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){switch(t.target){case this.btnLink:openWin(RechargeWin),closeWin(TclyWin);break;case this.btnSend:var e=this.data.config;ActSys.ins().sendReward(e.id,e.index)}},e.prototype.dataChanged=function(){var t=this.data.config;this.lbDec.textFlow=addColorTF(this.getDec(this.data)),this.lbValue.textFlow=addColorTF(this.getValue(this.data)),this.list.dataProvider=new eui.ArrayCollection(t.rewards),this.btnLink.visible=!1,this.btnSend.visible=!1,this.imgYlq.visible=!1,this.btnSend.redPoint.visible=!1,this.data.status==ActRewardState.CanGet?(this.btnSend.visible=!0,this.btnSend.redPoint.visible=!0,this.mcBtn.playFile(ResMgr.getEffName("public_zycs_button01"),-1)):this.data.status==ActRewardState.Geted?(this.imgYlq.visible=!0,this.mcBtn.stop()):this.data.status==ActRewardState.NotReached&&(this.btnLink.visible=!0,this.mcBtn.stop())},e.prototype.getDec=function(t){var e=MathUtil.toInteger(t.dabiao/100);return Lang.act_str84.replace("$str$",addColor(""+(e+Lang.common_yuan),5767068))},e.prototype.getValue=function(t){var e=MathUtil.toInteger(t.dabiao/100),i=MathUtil.toInteger(t.yidabiao/100);return addColor("("+GFunc.overLength(i)+"/"+GFunc.overLength(e)+")",e>i?15733780:46913)},e}(BaseItemRender);__reflect(TclyItem.prototype,"TclyItem"),window.TclyItem=TclyItem;var TclyPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="TclyPanelEUI",e.list.itemRenderer=TclyItem,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.actData=ActSys.ins().getActDataById(2001),this.addLsn(ActSys.ins().patchActivityPanel,this.updateEvent),this.updateEvent()},e.prototype.updateEvent=function(){var t=this.actData.getItemDatas();SortUtil.sortOn(t,["status","dabiao"],[SortType.up,SortType.up]),this.listArr.source=t},e.prototype.updateTime=function(){this.lbTime.textFlow=addColorTF(this.actData.getformatTime())},e.getTabTitle=function(){return"bqz_zycs_tcly"},e}(BasePanel);__reflect(TclyPanel.prototype,"TclyPanel"),window.TclyPanel=TclyPanel;var TclyWin=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ExtCom],e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[TclyPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e){void 0===e&&(e=-1);for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.prototype.open.apply(this,[e].concat(i)),this.addLsn(ActSys.ins().patchActivityIsGetAwards,this.updateTabRedPoint)},e.getTitle=function(){return"btz_zycs_tcly"},e.prototype.updateTabRedPoint=function(t){void 0===t&&(t=null);for(var e=0;e<this.tab.numElements;e++){var i=this.getTabDatas()[e];(!t||t.check(this.getThisDef())&&t.check(i.id))&&this.updateTabRedPointByIndex(e)}this.updateRp(t)},e.prototype.getTabRedpoint=function(t){var e=egret.getQualifiedClassName(this),i=(this.getTabDatas()[t],[].concat(this.redPointHead).concat(e)),n=callFunc(RpSys.ins(),RpSys.ins().getData,i);return n},e}(BaseWinAutoTab);__reflect(TclyWin.prototype,"TclyWin"),window.TclyWin=TclyWin;var ShengLingWin=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.redPointHead=[RoleWin,RolePanel],e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[TianMoMainPanel,TianShiShengDunPanel,ShenPanTaoZhuangMainPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(ShengLingWin.prototype,"ShengLingWin"),window.ShengLingWin=ShengLingWin;var TianMoData=function(){function t(){this.tianMoUpLevelDatas=[],this.tianMoEquipRankData=[],this.pos=[EquipPos.HEAD,EquipPos.CLOTHES,EquipPos.HAND,EquipPos.CALIGA]}return t.prototype.iniData=function(){for(var t=0;t<this.pos.length;t++){var e=new TianMoEquipData;e.pos=this.pos[t],e.star=-1,e.isAct=!1,this.tianMoUpLevelDatas.push(e);var i=new TianMoEquipRankData;i.star=-1,i.pos=e.pos,this.tianMoEquipRankData.push(i)}},t.prototype.parser=function(t){for(var e=t.readByte(),i=0;e>i;i++){var n=t.readByte(),a=t.readShort(),o=t.readShort(),s=t.readBoolean(),r=this.getTianMoUpLevelDataByPos(n);r&&(r.star=a,r.isAct=s);var u=this.gettianMoEquipRankDataByPos(n);u&&(u.rankLevel=o,u.star=a)}},t.prototype.getTianMoUpLevelDataByPos=function(t){for(var e=0;e<this.tianMoUpLevelDatas.length;e++)if(t==this.tianMoUpLevelDatas[e].pos)return this.tianMoUpLevelDatas[e];return null},t.prototype.getTianMoUpLevelDataByIndex=function(t){return this.tianMoUpLevelDatas[t]},t.prototype.gettianMoEquipRankDataByPos=function(t){for(var e=0;e<this.tianMoEquipRankData.length;e++)if(t==this.tianMoEquipRankData[e].pos)return this.tianMoEquipRankData[e];return null},t}();__reflect(TianMoData.prototype,"TianMoData"),window.TianMoData=TianMoData;var TianMoEquipData=function(){function t(){this.pos=0,this.star=-1,this.startMax=0,this.isAct=!1}return t.prototype.showStart=function(){return this.star%6},t.prototype.showMaxStart=function(){return 5},t.prototype.showLevel=function(){return this.star<=5?1:Math.ceil((this.star+1)/6)},t.prototype.isUpLevel=function(){return 0==this.getConfig().items.length},t.prototype.getIsAct=function(){return this.isAct},t.prototype.getMaxLevel=function(){if(0==this.startMax){var t=Cfg.getConfigs(TianMoAttrConfig,this.pos,CondType.MoreEqual,"level",0);this.startMax=t[t.length-1].level}return this.startMax},t.prototype.getIsMax=function(){return this.star>=this.getMaxLevel()},t.prototype.getConfig=function(){return Cfg.getConfig(TianMoAttrConfig,this.pos,this.star)},t.prototype.getNextConfig=function(){return Cfg.getConfig(TianMoAttrConfig,this.pos,this.star+1)},t.prototype.getActConfig=function(){return Cfg.getConfig(TianMoAttrConfig,this.pos,-1)},t.prototype.chekLevelUpStar=function(t){return t>=this.getConfig().zslevel},t.prototype.chekUp=function(){return!this.getIsMax()&&GFunc.isConsumeEnough(this.getConfig().items)&&this.chekLevelUpStar(Actor.ins().zsId)},t}();__reflect(TianMoEquipData.prototype,"TianMoEquipData"),window.TianMoEquipData=TianMoEquipData;var TianMoEquipRankData=function(){function t(){this.pos=0,this.star=-1,this.rankLevel=0,this.ranktMax=0}return t.prototype.getMaxLevel=function(){return 0==this.ranktMax&&(this.ranktMax=Cfg.getMaxConfig(TianMoRankConfig,this.pos).rank),this.ranktMax},t.prototype.getIsMax=function(){return this.rankLevel>=this.getMaxLevel()},t.prototype.getConfig=function(){return Cfg.getConfig(TianMoRankConfig,this.pos,this.rankLevel)},t.prototype.getNextUpRankLevelDesc=function(){return""+(Math.floor(this.getConfig().starlimit/6)+1)+Lang.common_ji+this.getConfig().starlimit%6+Lang.common_xing},t.prototype.chekLevelUpRank=function(){return this.star>=this.getConfig().starlimit},t.prototype.chekUp=function(){return!this.getIsMax()&&GFunc.isConsumeEnough(this.getConfig().items)&&this.chekLevelUpRank()},t}();__reflect(TianMoEquipRankData.prototype,"TianMoEquipRankData"),window.TianMoEquipRankData=TianMoEquipRankData;var RedbaoLogData=function(){function t(){this.redbaoId=0,this.count=0,this.totalPrice=0,this.totalCount=0,this.infoDatas=[]}return t.prototype.parser=function(t){this.redbaoId=t.readInt(),this.count=t.readByte(),this.infoDatas=[];for(var e=0;e<this.count;e++){var i=new RedbaoLogInfoData;i.parser(t),this.infoDatas.push(i)}this.totalPrice=t.readShort(),this.totalCount=t.readShort()},t}();__reflect(RedbaoLogData.prototype,"RedbaoLogData");var RedbaoLogInfoData=function(){function t(){this.roleName="",this.job=0,this.yuanbao=0,this.time=0}return t.prototype.parser=function(t){this.roleName=t.readString(),this.job=t.readByte(),this.yuanbao=t.readByte(),this.time=Timer.ins().getEgretTimer()-1e3*t.readInt()},t.prototype.getTime=function(){return(Timer.ins().getEgretTimer()-this.time)/1e3},t}();__reflect(RedbaoLogInfoData.prototype,"RedbaoLogInfoData");var TianMoEquipRankItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lbLevel.text=t.rankLevel+"阶",this.lbLevel.visible=this.imgLvBg.visible=t.rankLevel>0;var e=Cfg.getItemCfg(parseInt(t.getConfig().id[Actor.ins().job-1]));this.imgIcon.source=ResMgr.getItemIcon(e.getIcon(),IconType.IT_80x80),this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,TianMoMainPanel,TianMoEquipUpRankPanel,t.pos))},e}(TianMoEquipItem);__reflect(TianMoEquipRankItem.prototype,"TianMoEquipRankItem"),window.TianMoEquipRankItem=TianMoEquipRankItem;var TianMoMaterialItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TaoZhuangFenJieItemEUI",e.addClickE(e.btnOk,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(){BagSys.ins().sendFenJie(this.data.id,this.data.count)},e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getItemCfg(t.id),i=Cfg.getConfig(FenJieConfig,t.id),n=i.item[0];this.itemIcon.data=t,this.lbName.text=e.getName(),this.lbName.textColor=GConst.PZColor[e.quality];var a=n.count*t.count,o=Cfg.getItemCfg(n.id),s=o.name;this.lbDesc.textFlow=addColorTF(Lang.fumo_str2+addColor(s+" X"+a,GConst.PZColor[o.quality]))},e}(BaseItemRender);__reflect(TianMoMaterialItem.prototype,"TianMoMaterialItem"),window.TianMoMaterialItem=TianMoMaterialItem;var TianMoActTipsWin=function(t){function e(){var e=t.call(this)||this;return e.useType=0,e.equipName="",e.equipIcon="",e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="TianMoActTipsEUI",this.addBg(),this.group.touchEnabled=!1,this.group1.touchEnabled=!1,t.prototype.initUI.call(this),this.layer=LayerMgr.Popup;var e=new XY(120,123),i=new XY(120,140);GFunc.move(this.imgIcon,e,i,1500),GFunc.playUIMovie("hqgx",0,0,this.group1,-1)},e.prototype.open=function(e,i){void 0===i&&(i=""),t.prototype.open.call(this),this.addClickE(this,this.onTap),this.equipName=e,this.equipIcon=i,this.setData()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.setData=function(){this.lbName.text=this.equipName,this.imgIcon.source=this.equipIcon},e.prototype.onTap=function(t){closeWin(this)},e}(BaseWinSingle);__reflect(TianMoActTipsWin.prototype,"TianMoActTipsWin"),window.TianMoActTipsWin=TianMoActTipsWin;var TianMoEquipUpLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.equipItems=[],e.attrType1=[AttrType.atdkzy,AttrType.atdkhx,AttrType.atdkzm,AttrType.atdkws],e.initUI(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="TianMoEquipUpLevelPanelEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.equipItems=[this.equipItem0,this.equipItem1,this.equipItem2,this.equipItem3],this.itemMC=new MC,this.itemMC.x=370,this.itemMC.y=400,this.itemMC.playFile(getEffName("szty"),-1),this.addChild(this.itemMC),this.lbMaterial.textFlow=addColorTF(Lang.DuoLuo_str1,this.lbMaterial.textColor,!0),this.starView=new Star(StarData.F_1()),this.starView.setMaxStar(5),this.starView.x=-108,this.starView.y=0,this.groupStar.addChild(this.starView)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onclick),this.addLsn(ForgeSys.ins().patchTianMoUpLevel,this.upLevelUpdate),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeItem),this.updatePanel()},e.prototype.updatePanel=function(){this.reset(),this.iniListDate(),this.updateRp()},e.prototype.iniListDate=function(){for(var t=ForgeSys.ins().tianMoData,e=0;e<t.tianMoUpLevelDatas.length;e++)this.equipItems[e].data=t.tianMoUpLevelDatas[e],this.equipItems[e].setSelectBG(!1);this.equipItems[0].setSelectBG(!0),this.curData=this.equipItems[0].data,this.selectEquip(this.curData)},e.prototype.updateEquipData=function(t){this.imgName.source=ResMgr.TianMoNameIcons(t.pos),this.imgIcon.source=ResMgr.TianMoIcons(t.pos)},e.prototype.updateEquipAttr=function(t){var e=t.getConfig(),i=AttrData.getFm(void 0,void 0,"：");this.lbCurAttr.textFlow=addColorTF(AttrData.parse(e.attr,{fm:i}).join("\n")),this.btnOk.label=t.getIsAct()?t.isUpLevel()?Lang.btn_sjie:Lang.btn_sx:Lang.btn_jh,this.powerBmp.text=GFunc.getPower(e.attr).toFixed(0);var n=t.chekLevelUpStar(Actor.ins().zsId)?5949490:15733780;if(this.lbLevel.textFlow=addColorTF(GFunc.getZSNameBydb(e.zslevel),n),this.bitlbRota.text=Math.floor(e.rate/100)+"%",!t.getIsMax()){var a=Cfg.getConfig(TianMoAttrConfig,t.pos,t.star+1);i=AttrData.getFm(void 0,void 0," ","："),this.lbNextAttr.textFlow=addColorTF(AttrData.parse(a.attr,{fm:i}).join("\n"))}this.imgIcon.filters=t.isAct?[]:DisUtil.grayFilter(),this.starView.setCurStar(t.showStart())},e.prototype.updateConsume=function(t){if(!t.getIsMax()){var e=t.getConfig().items;if(0==e.length)this.lbConsume.textFlow=addColorTF(Lang.DuoLuo_str2);else{var i=e[0].id,n=e[0].count,a=BagSys.ins().getItemById(i),o=Cfg.getItemCfg(i),s=a?a.count:0;this.imgConsume.source=ResMgr.getItemIcon(o.getIcon(),IconType.IT_80x80),s>=n?this.lbConsume.textFlow=addColorTF(s+"/"+n):this.lbConsume.textFlow=addColorTF(s+"/"+n,15732752)}}},e.prototype.selectEquip=function(t){this.reset(),this.updateEquipData(t),this.updateEquipAttr(t),this.updateConsume(t),this.updateStatsu(t)},e.prototype.upLevelUpdate=function(t){this.updateEquipAttr(t),this.updateStatsu(t),this.updateConsume(t);for(var e=0;e<this.equipItems.length;e++){var i=this.equipItems[e],n=i.data;if(i&&n.pos==t.pos){i.data=t;break}}},e.prototype.updateStatsu=function(t){t.getIsAct()?t.getIsMax()?this.currentState="max":this.currentState="normal":this.currentState="noact"},e.prototype.onclick=function(t){switch(t.target){case this.btnOk:this.curData.chekLevelUpStar(Actor.ins().zsId)?GFunc.checkConsumeEnough(this.curData.getConfig().items)&&ForgeSys.ins().sendTianMoUpLevel(this.curData.pos):showTipsWarn(Lang.DuoLuo_str3);break;case this.lbMaterial:openWin(TianMoMaterialWin);break;case this.equipItem0:case this.equipItem1:case this.equipItem2:case this.equipItem3:var e=t.target;this.curData=e.data;for(var i=0;i<this.equipItems.length;i++)this.equipItems[i].setSelectBG(!1);e.setSelectBG(!0),this.selectEquip(this.curData)}},e.prototype.updateConsumeItem=function(t){(t.cfg.type==ItemType.TianMoGodEquipcl||t.cfg.type==ItemType.TianMoGodEquip)&&this.updateConsume(this.curData)},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e)){for(var i=0;i<this.equipItems.length;i++){var n=this.equipItems[i];n&&n.updateRedPoint()}this.redPointMaterial.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,TianMoMainPanel,e,TianMoMaterialWin)}},e.prototype.reset=function(){this.starView.reset()},e.getSysId=function(){return SysId.DuoLuo},e.getTitle=function(){return"btz_zycs_dlsz"},e.getTabTitle=function(){return Lang.btn_sjie},e}(BasePanel);__reflect(TianMoEquipUpLevelPanel.prototype,"TianMoEquipUpLevelPanel"),window.TianMoEquipUpLevelPanel=TianMoEquipUpLevelPanel;var TianMoEquipUpRankPanel=function(t){function e(){var e=t.call(this)||this;return e.equipItems=[],e.initUI(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="TianMoEquipUpRankPanelEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.equipItems=[this.equipItem0,this.equipItem1,this.equipItem2,this.equipItem3],this.itemMC=new MC,this.itemMC.x=370,this.itemMC.y=400,this.itemMC.playFile(getEffName("szty"),-1),this.addChild(this.itemMC)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onclick),this.addLsn(ForgeSys.ins().patchTianMoUpRank,this.upLevelUpdate),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(BagSys.ins().patchItemChange,this.updateConsumeItem),this.iniListDate(),this.updateRp()},e.prototype.iniListDate=function(){for(var t=ForgeSys.ins().tianMoData,e=0;e<t.tianMoEquipRankData.length;e++)this.equipItems[e].data=t.tianMoEquipRankData[e],this.equipItems[e].setSelectBG(!1);this.equipItems[0].setSelectBG(!0),this.curData=this.equipItems[0].data,this.selectEquip(this.curData)},e.prototype.updateEquipData=function(t){this.imgName.source=ResMgr.TianMoNameIcons(t.pos),this.imgIcon.source=ResMgr.TianMoIcons(t.pos)},e.prototype.updateEquipAttr=function(t){var e=AttrData.getFm(void 0,void 0,"：");this.lbCurAttr.textFlow=addColorTF(AttrData.parse(t.getConfig().attr,{fm:e}).join("\n")),this.powerBmp.text=GFunc.getPower(t.getConfig().attr).toFixed(0);var i=t.chekLevelUpRank()?5949490:15733780;if(this.lbLevel.textFlow=addColorTF(t.getNextUpRankLevelDesc(),i),!t.getIsMax()){var n=Cfg.getConfig(TianMoRankConfig,t.pos,t.rankLevel+1);e=AttrData.getFm(void 0,void 0," ","："),this.lbNextAttr.textFlow=addColorTF(AttrData.parse(n.attr,{fm:e}).join("\n"))}},e.prototype.updateConsume=function(t){if(!t.getIsMax()){var e=t.getConfig().items;if(0==e.length)this.lbConsume.textFlow=addColorTF(Lang.DuoLuo_str2);else{var i=e[0].id,n=e[0].count,a=BagSys.ins().getItemById(i),o=Cfg.getItemCfg(i),s=a?a.count:0;this.imgConsume.source=ResMgr.getItemIcon(o.getIcon(),IconType.IT_80x80),s>=n?this.lbConsume.textFlow=addColorTF(s+"/"+n):this.lbConsume.textFlow=addColorTF(s+"/"+n,15732752)}}},e.prototype.selectEquip=function(t){this.updateEquipData(t),this.updateEquipAttr(t),this.updateConsume(t),this.updateStatsu(t)},e.prototype.upLevelUpdate=function(t){this.updateEquipAttr(t),this.updateStatsu(t),this.updateConsume(t);for(var e=0;e<this.equipItems.length;e++){var i=this.equipItems[e],n=i.data;if(i&&n.pos==t.pos){i.data=t;break}}},e.prototype.updateStatsu=function(t){t.getIsMax()?this.currentState="max":this.currentState="normal"},e.prototype.onclick=function(t){switch(t.target){case this.btnOk:this.curData.chekLevelUpRank()?GFunc.checkConsumeEnough(this.curData.getConfig().items)&&ForgeSys.ins().sendTianMoUpRank(this.curData.pos):showtipsFail(Lang.DuoLuo_str4);break;case this.equipItem0:case this.equipItem1:case this.equipItem2:case this.equipItem3:var e=t.target;this.curData=e.data;for(var i=0;i<this.equipItems.length;i++)this.equipItems[i].setSelectBG(!1);e.setSelectBG(!0),this.selectEquip(this.curData)}},e.prototype.updateConsumeItem=function(t){(t.cfg.type==ItemType.TianMoGodEquipcl||t.cfg.type==ItemType.TianMoGodEquip)&&this.updateConsume(this.curData)},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e))for(var i=0;i<this.equipItems.length;i++){var n=this.equipItems[i];n&&n.updateRedPoint()}},e.getSysId=function(){return SysId.DuoLuo},e.getTitle=function(){return"btz_zycs_dlsz"},e.getTabTitle=function(){return Lang.btn_jj},e}(BasePanel);__reflect(TianMoEquipUpRankPanel.prototype,"TianMoEquipUpRankPanel"),window.TianMoEquipUpRankPanel=TianMoEquipUpRankPanel;var TianMoMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,ShengLingWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[TianMoEquipUpLevelPanel,TianMoEquipUpRankPanel]},enumerable:!0,configurable:!0}),e.prototype.setSkinName=function(){this.skinName="SkillMainPanelEUI",this.tab.y=960},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.getSysId=function(){return SysId.DuoLuo},e.getTitle=function(){return"btz_zycs_dlsz"},e.getTabTitle=function(){return"bqz_zycs_dlsz"},e}(BaseTabPanel);__reflect(TianMoMainPanel.prototype,"TianMoMainPanel"),window.TianMoMainPanel=TianMoMainPanel;var TianMoMaterialWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="TaoZhuangFenJieWinEUI",e.itemList.itemRenderer=TianMoMaterialItem,e.listArray=new eui.ArrayCollection,e.itemList.dataProvider=e.listArray,e.gainList.itemRenderer=GainGoodsItem,e.itemList.useVirtualLayout=!0,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(BagSys.ins().patchFenJie,this.updateData),this.addItemTapE(this.gainList,this.onTouchList),this.updateData(),this.updategain()},e.prototype.updateData=function(){this.listArray.replaceAll(BagSys.ins().getTianMoEquipSmes())},e.prototype.updategain=function(){var t=Cfg.getItemCfg(Cfg.getConfig(EnumConfig).Item_TIANMOSUIPIAN),e=GFunc.getGainItemWayConfig(t.id);this.gainList.dataProvider=new eui.ArrayCollection(e)},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=e.controlTarget;GFunc.createTaskNavData(i)["goto"](),closeWin(this)}},e}(BaseWinSingle);__reflect(TianMoMaterialWin.prototype,"TianMoMaterialWin"),window.TianMoMaterialWin=TianMoMaterialWin;var TianShiShengDunAttrDanData=function(){function t(t){this.useCount=0,this.maxUseCount=0,this.maxCount=0,this.id=1,this.config=t}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},set:function(t){this._config=t,this.id=t.id},enumerable:!0,configurable:!0}),t}();__reflect(TianShiShengDunAttrDanData.prototype,"TianShiShengDunAttrDanData"),window.TianShiShengDunAttrDanData=TianShiShengDunAttrDanData;var TianShiShengDunData=function(){function t(){this.isAct=!1,this._level=0,this.exp=0,this.attrDanDatas=[],this.attrDanDatas.length=0;for(var t=Cfg.getConfigs(ShengdundanConfig),e=0,i=t;e<i.length;e++){var n=i[e];this.attrDanDatas.push(new TianShiShengDunAttrDanData(n))}}return t.prototype.parser=function(t){this.isAct=t.readBoolean(),this.level=t.readShort(),this.exp=t.readInt();for(var e=t.readByte(),i=0;e>i;i++){var n=this.attrDanDatas[i];n.useCount=t.readShort(),n.maxUseCount=this.getUseDanYaoMax(n.id),n.maxCount=this.getDanYaoMax()}},Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(t){this._level=t;for(var e=0,i=this.attrDanDatas;e<i.length;e++){var n=i[e];n.maxUseCount=this.getUseDanYaoMax(n.id)}},enumerable:!0,configurable:!0}),t.prototype.isMax=function(){return this.level>=Cfg.getConfig(ShengdunConstConfig).starMax},t.prototype.getStage=function(){var t=(this.level+1)/Cfg.getConfig(ShengdunConstConfig).starPerLevel;return Math.ceil(t)},t.prototype.getLevel=function(){var t=this.level%Cfg.getConfig(ShengdunConstConfig).starPerLevel;return t},t.prototype.getLvCfg=function(){return this.lvCfg&&this.lvCfg.star==this.level||(this.lvCfg=Cfg.getConfig(ShengdunLvConfig,this.level)),this.lvCfg},t.prototype.getNextLevelConfig=function(){return this.isMax()?this.nextLevelConfig=this.getLvCfg():this.nextLevelConfig&&this.nextLevelConfig.star==this.level+1||(this.nextLevelConfig=Cfg.getConfig(ShengdunLvConfig,this.level+1)),this.nextLevelConfig},t.prototype.getSatgeConfig=function(){return this.satgeConfig&&this.satgeConfig.star==this.getStage()||(this.satgeConfig=Cfg.getConfig(ShengdunStageConfig,this.getStage())),this.satgeConfig},t.prototype.getUseDanYaoMax=function(t){return this.getSatgeConfig().maxpill[t-1]||0},t.prototype.getDanYaoMax=function(){var t=Cfg.getMaxConfig(ShengdunStageConfig).maxpill;return t[t.length-1]},t.prototype.getDanYaoPower=function(){for(var t=0,e=(Cfg.getConfigs(ShengdundanConfig),0),i=this.attrDanDatas;e<i.length;e++){var n=i[e];if(n.config.attr&&n.config.attr.length>0){var a=AttrData.attrMultiple(n.config.attr,n.useCount);t+=GFunc.getPower(a)}else t+=n.config.power*n.useCount}return t},t.prototype.getPower=function(){var t=this.getDanYaoPower(),e=this.getLvCfg().attr;t+=GFunc.getPower(e);for(var i=Cfg.getConfigs(ShengdunSkillConfig,CondType.LessEqual,ShengdunSkillConfig.stage,this.getStage()),n=0,a=i;n<a.length;n++){var o=a[n];t+=GFunc.getPower(o.attr),t+=o.power}return t},t}();__reflect(TianShiShengDunData.prototype,"TianShiShengDunData"),window.TianShiShengDunData=TianShiShengDunData;var TianShiShengDunSys=function(t){function e(){var e=t.call(this)||this;return e.shengDunData=new TianShiShengDunData,e.sysId=PackId.TianShiShengDun,e.reg(1,e.patchInfo),e.reg(2,e.patchLevel),e.reg(4,e.patchAct),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchInfo=function(t){this.shengDunData.parser(t),RpFun.showTianShiShengDun(),RpFun.showTianShiShengDunDan()},e.prototype.sendLevel=function(t){var e=this.getBytes(2);e.writeByte(t),this.send(e)},e.prototype.patchLevel=function(t){var e=this.shengDunData.level,i=this.shengDunData.getStage();this.shengDunData.level=t.readShort(),this.shengDunData.exp=t.readInt();var n=this.shengDunData.getStage();return RpFun.showTianShiShengDun(),i!=n&&openWin(TianShiShengDunUpLevelTipsWin,n-1),RpFun.showTianShiShengDunDan(),e<this.shengDunData.level},e.prototype.sendUseDanYao=function(t){var e=this.getBytes(3);e.writeByte(t),this.send(e)},e.prototype.sendAct=function(){var t=this.getBytes(4);this.send(t)},e.prototype.patchAct=function(t){this.shengDunData.isAct=!0},e}(BaseSys);__reflect(TianShiShengDunSys.prototype,"TianShiShengDunSys"),SystemMap.TianShiShengDunSys=TianShiShengDunSys.ins.bind(TianShiShengDunSys),window.TianShiShengDunSys=TianShiShengDunSys;var TianShiShengDunAttrDanItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TianShiShengDunPanelItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t&&(this.imgBg.source="jlyj_zycs_yx3",this.lbshiyong.textFlow=addColorTF(t.useCount+"/"+t.maxUseCount),this.imgIcon.source=this.getIcon(),this.updateRedPoint())},e.prototype.getIcon=function(){var t=this.data;return"tssd_zycs_ys"+t.id},e.prototype.updateRedPoint=function(){var t=this.data;t&&(this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,TianShiShengDunPanel,"dan",t.id))},e}(BaseItemRender);__reflect(TianShiShengDunAttrDanItem.prototype,"TianShiShengDunAttrDanItem"),window.TianShiShengDunAttrDanItem=TianShiShengDunAttrDanItem;var TianShiShengDunAttrDanTipsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="TianShiShengDunAttrDanTipsWinEUI",e.gainList.itemRenderer=GainGoodsItem,e.gainList.dataProvider=e.gainListData=new eui.ArrayCollection,e.addBg(),e
}return __extends(e,t),e.prototype.childrenCreated=function(){this.setSkinPart("itemIcon",new ItemIcon)},e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(e,i){void 0===i&&(i=""),t.prototype.open.call(this),this.addItemTapE(this.gainList,this.onTouchList);e.id,e.count;this.lbMaxDesc.text=i,this.setData(e)},e.prototype.setData=function(t){var e=t.id;t.count;this.itemId=e;var i=Cfg.getItemCfg(this.itemId);this.nameLabel.text=i.getName(),this.nameLabel.textColor=GConst.PZColor[i.quality],this.lbDesc.textFlow=StrUtil.toTF(i.getDesc()),this.itemIcon.setDataByItemConfig(i),this.groupTUjing.scaleY=""==i.output?0:1,this.lbShiYongCount.textFlow=addColorTF(""+Lang.itemtips_str22+t.shiyongCount+"/"+t.maxCount);var n=(Cfg.getItemCfg(this.itemId),GFunc.getGainItemWayConfig(i.id));if(n.length>0){this.groupGain.scaleY=this.gainList.scaleY=1,this.gainListData.source=n;var a=n.length>4?4:n.length;this.gainList.width=94*a+35*(a-1),this.groupTUjing.scaleY=0}else this.groupGain.scaleY=this.gainList.scaleY=0},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=GFunc.createTaskNavData(e.controlTarget);i.setsucceedFrontFun(function(){WinMgr.ins().closeAllWin(),closeWin(ItemTipsWin)}),i.setLoserFun(function(){closeWin(ItemTipsWin)}),i["goto"](e.sysid)}},e}(BaseWinSingle);__reflect(TianShiShengDunAttrDanTipsWin.prototype,"TianShiShengDunAttrDanTipsWin"),window.TianShiShengDunAttrDanTipsWin=TianShiShengDunAttrDanTipsWin;var TianShiShengDunPanel=function(t){function e(){var e=t.call(this)||this;e.imgStars=[],e.mcStars=[],e.radiobtns=[],e.lbitems=[],e.shuxingitems=[],e.upItemConfigs=[],e.selectItemIndex=2,e.longPressBtnUp=new LongPress,e.longPressAttrDan1=new LongPress,e.longPressAttrDan2=new LongPress,e.longPressAttrDan3=new LongPress,e.skinName="TianShiShengDunPanelEUI",e.btnAct.redPoint.visible=!0,e.listSkill.itemRenderer=TianShiShengDunSkillItem,e.listSkill.dataProvider=e.listSkillData=new eui.ArrayCollection,e.radiobtns=[e.radiobtn1,e.radiobtn2,e.radiobtn3],e.lbitems=[e.lbitem1,e.lbitem2,e.lbitem3],e.shuxingitems=[e.shuxingitem1,e.shuxingitem2,e.shuxingitem3],e.imgStars=[e.imgStar0,e.imgStar1,e.imgStar2,e.imgStar3,e.imgStar4,e.imgStar5,e.imgStar6,e.imgStar7,e.imgStar8,e.imgStar9];for(var i=0;i<e.imgStars.length;i++){var n=e.imgStars[i],a=e.mcStars[i]=new MC;a.x=n.x+30,a.y=n.y+30,e.groupStar.addChild(a)}return e.mcBg=new MC,e.mcBg.x=361,e.mcBg.y=403,e.groupMc2.addChild(e.mcBg),e.mcBg.playFile(getEffName("tssd_fz"),-1),e.mcIcon=new MC,e.mcIcon.x=361,e.mcIcon.y=400,e.groupMc2.addChild(e.mcIcon),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnAct,this.onClick),this.addClickE(this.btnUp,this.onClick),this.addItemTapE(this.listSkill,this.listTap),this.addLsn(TianShiShengDunSys.ins().patchInfo,this.updatePanel),this.addLsn(TianShiShengDunSys.ins().patchLevel,this.updatePanel),this.addLsn(TianShiShengDunSys.ins().patchAct,this.updateAct),this.addLsn(BagSys.ins().patchItemChange,this.updateItemChange),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.longPressBtnUp.setDisplay(this.btnUp,this.upLevel,this),this.longPressAttrDan1.setDisplay(this.shuxingitem1,this.attrDan1,this),this.longPressAttrDan2.setDisplay(this.shuxingitem2,this.attrDan2,this),this.longPressAttrDan3.setDisplay(this.shuxingitem3,this.attrDan3,this);for(var e=0,i=this.radiobtns;e<i.length;e++){var n=i[e];this.addClickE(n,this.radiobtnClick)}for(var a=0,o=this.shuxingitems;a<o.length;a++){var s=o[a];this.addClickE(s,this.onArrDanItem)}this.updatePanel(),this.showOpenWing(),this.updateItemChange(),this.updateRp()},e.prototype.close=function(){t.prototype.close.call(this),this.longPressBtnUp.close(),this.longPressAttrDan1.close(),this.longPressAttrDan2.close(),this.longPressAttrDan3.close()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(e))&&(this.btnUp.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,ShengLingWin,e,"up"))},e.prototype.updateAct=function(){this.btnAct.visible=!1,this.openAnimation()},e.prototype.updatePanel=function(t){void 0===t&&(t=!1),this.curData=TianShiShengDunSys.ins().shengDunData,this.currentState=this.curData.isMax()?"max":"normal",e.curStage=this.curData.getStage(),e.skillConfig=Cfg.getConfig(ShengdunSkillConfig,CondType.More,ShengdunSkillConfig.stage,e.curStage),this.imgStage.source="zuji_zycs_"+this.curData.getStage(),this.totalPower0.text=this.curData.isAct?""+this.curData.getPower():"0",this.mcIcon.playFile(getEffName("tssd_zycs_sd"+(this.curData.getStage()-1)),-1);for(var i=this.curData.isMax(),n=this.curData.getLevel(),a=0;a<this.imgStars.length;a++){var o=this.imgStars[a],s=this.mcStars[a];if(s.visible=!0,o.source=n>a?"shenmo_zycs_zhu_02":"shenmo_zycs_zhu_01",n>a){var r=getEffName("sdgz2");s.name!=r&&s.playFile(r,-1),s.y=o.y+20}else if(n==a&&!i&&n<this.imgStars.length){var r=getEffName("sdgz1");s.name!=r&&s.playFile(r,-1),s.y=o.y+30}else s.visible=!1}t&&n>0&&(this.flameMC||(this.flameMC=new MC),this.flameMC.x=this.mcStars[this.curData.getLevel()-1].x,this.flameMC.y=this.mcStars[this.curData.getLevel()-1].y,this.groupStar.addChild(this.flameMC),this.flameMC.playFile(getEffName("sdbz1")));var u="",h=this.curData.getLvCfg().attr,p=AttrData.getFm(null,5767068,"","：");u=this.curData.isMax()?AttrData.parse(h,{fm:p}).join("\n")+addColor(Lang.forge_str12,15733780)+"\n":AttrData.parse(h,{fm:p}).join("\n")+"\n",this.labelAttr.textFlow=addColorTF(u),u="",h=this.curData.getNextLevelConfig().attr;for(var a=0;a<h.length;a++)u+=h[a].value+"\n";if(this.labelAttrNext.text=u,this.listSkillData.source=Cfg.getConfigs(ShengdunSkillConfig),this.curData.isMax())this.groupConsume.visible=!1;else{this.curData.getLvCfg().exp>0?(this.btnUp.label=Lang.btn_ts,this.groupConsume.visible=!0):(this.btnUp.label=Lang.btn_jj,this.groupConsume.visible=!1);var l=this.curData.getLvCfg().exp;this.bar.maximum=l,this.bar.value=this.curData.exp}this.updateItemChange()},e.prototype.updateItemChange=function(t){if(void 0===t&&(t=null),!t||t.cfg.type==ItemType.TianShiShengDunLinShi){this.upItemConfigs&&0!=this.upItemConfigs.length||(this.upItemConfigs=Cfg.getConfigs(UpItemConfig));for(var e=0;this.upItemConfigs.length>e;e++){var i=GFunc.getItemCount(this.upItemConfigs[e].itemid);this.lbitems[e].text=i+"/1",this.lbitems[e].textColor=i>0?GConst.PZColor[0]:15733780}var n=!0;if(GFunc.getItemCount(this.upItemConfigs[this.selectItemIndex].itemid)>0)n=!1,this.radiobtns[this.selectItemIndex].selected=!0;else for(var e=this.upItemConfigs.length-1;e>=0;e--){var i=GFunc.getItemCount(this.upItemConfigs[e].itemid);this.radiobtns[e].selected=!1,!t&&i>0&&n&&(this.radiobtns[e].selected=!0,this.selectItemIndex=e,n=!1)}n&&(this.radiobtns[this.selectItemIndex].selected=!0)}if(this.curData&&this.curData.attrDanDatas)for(var e=0;e<this.shuxingitems.length;e++)this.shuxingitems[e].data=this.curData.attrDanDatas[e]},e.prototype.openAnimation=function(){var t=this,e=new MC;e.x=347,e.y=400,e.playFile(getEffName("sdjh1"),-1),this.groupOpen.addChild(e),Timer.ins()["do"](750,1,1,function(){var e=egret.Tween.get(t.imgbg1,{onChange:function(){t.imgbg2.x=413+(132-t.imgbg1.x)}});e.to({x:-111},500).call(function(){t.showOpenWing()},t)},this)},e.prototype.showOpenWing=function(){var t=this.curData.isAct;this.btnAct.visible=this.groupOpen.visible=!t,t||(this.imgbg2.x=413,this.imgbg1.x=132)},e.prototype.listTap=function(t){var e=t.item;openWin(TianShiShengDunSkillTipsWin,e)},e.prototype.radiobtnClick=function(t){var e=this.radiobtns.indexOf(t.currentTarget);this.selectItemIndex=e},e.prototype.onArrDanItem=function(t){var e=t.currentTarget,i=e.data;this.attrDan(i)},e.prototype.attrDan1=function(){this.attrDan(this.shuxingitem1.data)},e.prototype.attrDan2=function(){this.attrDan(this.shuxingitem2.data)},e.prototype.attrDan3=function(){this.attrDan(this.shuxingitem3.data)},e.prototype.attrDan=function(t){var e=new ItemDataReward;e.id=t.config.itemid,e.count=BagSys.ins().getItemCount(e.id),e.maxCount=t.maxUseCount,e.shiyongCount=t.useCount,e.shiyongCount>=t.maxCount?(showtipsFail(Lang.tssd_str5),openWin(TianShiShengDunAttrDanTipsWin,e,Lang.tssd_str5)):e.count>0?e.shiyongCount>=e.maxCount?openWin(TianShiShengDunAttrDanTipsWin,e,Lang.tssd_str1):TianShiShengDunSys.ins().sendUseDanYao(t.id):openWin(TianShiShengDunAttrDanTipsWin,e,Lang.tssd_str1)},e.prototype.onClick=function(t){switch(t.target){case this.btnAct:TianShiShengDunSys.ins().sendAct();break;case this.btnUp:this.upLevel()}},e.prototype.upLevel=function(){if(this.curData.getLvCfg().exp>0){var t=this.upItemConfigs[this.selectItemIndex].itemid,e=BagSys.ins().getItemCount(t);if(0==e)return TipsSys.ins().setBuyGoodsWarn(t),void this.longPressBtnUp.stop()}TianShiShengDunSys.ins().sendLevel(this.selectItemIndex+1),showtipsSuc(Lang.tssd_str4+this.upItemConfigs[this.selectItemIndex].addexp)},e.getSysId=function(){return SysId.TSSD},e.getTitle=function(){return"btz_zycs_tssd"},e.getTabTitle=function(){return"bqz_zycs_tssd"},e.curStage=0,e.skillConfig=null,e}(BasePanel);__reflect(TianShiShengDunPanel.prototype,"TianShiShengDunPanel"),window.TianShiShengDunPanel=TianShiShengDunPanel;var TianShiShengDunSkillItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TianShiShengDunPanelSkillEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.id){var t=this.data;this.levelImg.source="emzx_zycs_"+t.stage,TianShiShengDunPanel.curStage>=t.stage?(this.imgIcon.source="tssd_zycs_sk"+t.id,this.imgYjh.visible=!0,this.levelImg.visible=!1):TianShiShengDunPanel.skillConfig.stage==t.stage?(this.imgIcon.source="tssd_zycs_sk"+t.id,this.imgYjh.visible=!1,this.levelImg.visible=!0):(this.imgIcon.source="tssd_zycs_sk"+t.id+"a",this.imgYjh.visible=!1,this.levelImg.visible=!0)}},e}(BaseItemRender);__reflect(TianShiShengDunSkillItem.prototype,"TianShiShengDunSkillItem"),window.TianShiShengDunSkillItem=TianShiShengDunSkillItem;var TianShiShengDunSkillTipsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="TianShiShengDunTipsWinEUI",e.addBg(),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.updatePanel(e)},e.prototype.updatePanel=function(t){this.lbName.text=""+t.name,this.imgIcon.source="tssd_zycs_sk"+t.id;var e=AttrData.getFm(GConst.SXColor[0],GConst.SXColor[2],"","+"),i=AttrData.parse(t.attr,{fm:e}).join("\n");this.lbCur.textFlow=addColorTF(i),i=addColor(""+t.stage+Lang.common_jie,15733780),this.lbDesc.textFlow=TianShiShengDunSys.ins().shengDunData.getStage()>=t.stage?addColorTF(Lang.common_str28,5767068):addColorTF(Lang.tssd_str3.replace("$jie$",""+i));for(var n=0;n<t.attr.length;n++)DisUtil.createEuiImage(this.group,"",this.lbCur.x-25,this.lbCur.y+25*n);this.bitPower.text=(t.power+GFunc.getPower(t.attr)).toFixed(0)},e.prototype.updatePanel1=function(t){this.lbName.text=""+t.name,this.imgIcon.source="tssd_zycs_sk"+t.id;var e=AttrData.getFm(GConst.SXColor[0],GConst.SXColor[2],"","+"),i=AttrData.parse(t.attr,{fm:e}).join("\n");this.lbCur.textFlow=addColorTF(i),i=addColor(""+t.stage+Lang.common_jie,15733780),this.lbDesc.textFlow=TianShiShengDunSys.ins().shengDunData.getStage()>=t.stage?addColorTF(Lang.common_str28,5767068):addColorTF(Lang.tssd_str3.replace("$jie$",i));for(var n=0;n<t.attr.length;n++)DisUtil.createEuiImage(this.group,"",this.lbCur.x-25,this.lbCur.y+25*n);this.bitPower.text=(t.power+GFunc.getPower(t.attr)).toFixed(0)},e}(BaseWinSingle);__reflect(TianShiShengDunSkillTipsWin.prototype,"TianShiShengDunSkillTipsWin"),window.TianShiShengDunSkillTipsWin=TianShiShengDunSkillTipsWin;var TianShiShengDunUpLevelTipsWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="TianShiShengDunUpLevelTipsWinEUI",e.mcIcon=new MC,e.mcIcon.x=0,e.mcIcon.y=0,e.groupEntity.addChild(e.mcIcon),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.updatePanel(e)},e.prototype.updatePanel=function(t){this.mcIcon.playFile(getEffName("tssd_zycs_sd"+t),-1)},e}(BaseWinSingle);__reflect(TianShiShengDunUpLevelTipsWin.prototype,"TianShiShengDunUpLevelTipsWin"),window.TianShiShengDunUpLevelTipsWin=TianShiShengDunUpLevelTipsWin;var VipSys=function(t){function e(){var e=t.call(this)||this;e.vipAwardStates=[],e.sVipExp=0,e.sVipAwardStates=[],e.sVipGiftState=[],e.sVipEvervDayAwardState=[],e.payItems=[],e.sysId=PackId.Vip,e.reg(1,e.patchVipInit),e.reg(2,e.patchSvipData),e.reg(3,e.patchSVipAwardstate),e.reg(5,e.patchVipUpdate),e.reg(6,e.patchGetVipAward),e.reg(7,e.patchSvipEveryDayAward),e.reg(10,e.patchSvipLimitGiftData),e.reg(11,e.patchSvipLimitGiftUpdate),e.reg(14,e.vipRedpacketInfoBack);for(var i=Cfg.getConfigs(VipConfig),n=0;n<i.length;n++)e.vipAwardStates[n]=0;for(var a=Cfg.getConfigs(SVipConfig),n=0;n<a.length;n++)e.sVipAwardStates[n]=0,e.sVipEvervDayAwardState[n]=1;for(var o=Cfg.getConfigs(PayMoneyConfig),s=0,r=o;s<r.length;s++){var u=r[s],h=new PayItem;h.readConfig(u),e.payItems.push(h)}return e.sVipLimitGiftData=new SVipLimitGiftData,e.xjhbData=new XJHBData,e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.showReCharge=function(t){PfActivitySys.ins().verifyApiInfo.ishow?showtipsFail("请先完成实名认证后再充值"):RechargeActSys.ins().sendPayOrder(t),Actor.ins().isLocation&&gms("@chongzhi "+t)},e.prototype.getPayItem=function(t){for(var e=0,i=this.payItems;e<i.length;e++){var n=i[e];if(n.yb==t)return n}},e.prototype.sendGetAwards=function(t,e){void 0===e&&(e=1);var i=this.getBytes(1);i.writeShort(t),i.writeByte(e),this.send(i)},e.prototype.patchVipInit=function(t){Actor.ins().sVipLv=t.readByte(),this.sVipExp=t.readInt();var e=t.readInt();MathUtil.writeIntToArray(e,this.sVipAwardStates);var i=t.readInt();MathUtil.writeIntToArray(i,this.sVipGiftState),Actor.ins().vipLv=t.readByte(),this.vipExp=t.readInt();var n=t.readInt();MathUtil.writeIntToArray(n,this.vipAwardStates);var a=t.readInt();MathUtil.writeIntToArray(a,this.sVipEvervDayAwardState)},e.prototype.patchSvipData=function(t){var e=Actor.ins().sVipLv,i=t.readShort();Actor.ins().sVipLv=i,this.sVipExp=t.readInt(),i!=e&&(RpFun.showSVipEveryDayAwardRp(),RpFun.showSVipAwardRp(),RpFun.showBBFLLoginRp(),RpFun.showBBFLCustomRp(),RpFun.showBBFLLevelRp(),RpFun.showActTypeRp(ActType.TYPE_10,ActSubType.TYPE_1),this.patchSvipLvChange(),RpFun.showDLHLRedPoint())},e.prototype.patchSvipLvChange=function(){},e.prototype.sendGetSVipAward=function(t){var e=this.getBytes(3);e.writeByte(t),this.send(e)},e.prototype.patchSVipAwardstate=function(t){var e=t.readInt();MathUtil.writeIntToArray(e,this.sVipAwardStates),RpFun.showSVipAwardRp()},e.prototype.sendGetSVipEveryDayAward=function(){this.sendBase(7)},e.prototype.patchSvipEveryDayAward=function(t){var e=t.readInt();MathUtil.writeIntToArray(e,this.sVipEvervDayAwardState),RpFun.showSVipEveryDayAwardRp()},e.prototype.sendBuyVipGift=function(t){var e=this.getBytes(4);e.writeByte(t),this.send(e)},e.prototype.patchBuyVipGift=function(t){var e=t.readInt();MathUtil.writeIntToArray(e,this.sVipGiftState)},e.prototype.isSvipAwardHasGet=function(t){return 1==this.sVipAwardStates[t]},e.prototype.hasSVipAwardCanGet=function(t){void 0===t&&(t=Actor.ins().sVipLv);for(var e=!1,i=0;t>=i&&!(e=this.canGetSVipAward(i));i++);return e},e.prototype.getSVipAwardState=function(t){var e=ActRewardState.Geted,i=this.sVipAwardStates[t];if(0==i){var n=Actor.ins().sVipLv;e=n>=t&&n>0?ActRewardState.CanGet:ActRewardState.NotReached}else e=ActRewardState.Geted;return e},e.prototype.canGetSVipAward=function(t){return this.getSVipAwardState(t)==ActRewardState.CanGet},e.prototype.canGetSvipEveryDayAward=function(){return Actor.ins().sVipLv>0&&this.hasSvipEveryDayAwarCanGet()},e.prototype.hasSvipEveryDayAwarCanGet=function(){for(var t=!1,e=0;e<this.sVipEvervDayAwardState.length;e++)if(t=0==this.sVipEvervDayAwardState[e])return t;return!1},e.prototype.getSvipEveryDayAwardIndex=function(){for(var t=0;t<this.sVipEvervDayAwardState.length;t++)if(0==this.sVipEvervDayAwardState[t])return t;return 0},e.prototype.getCurSVipConfig=function(){return Cfg.getConfig(SVipConfig,Actor.ins().sVipLv)},e.prototype.patchVipUpdate=function(t){var e=t.readByte(),i=t.readByte();Actor.ins().vipLv=e,2==i&&this.createVipFly(e),this.vipExp=t.readInt(),RpFun.showVipAwardRp()},e.prototype.createVipFly=function(t){if(!urlParam.isShenhe){var e=new DuiLieFlyItemData,i=this.createFlyItem(t),n=(getWin(MainUIButton),new Caller);n.func=this.patchVipFlyEnd,n.obj=this,e.setData(i,function(){var t=JobSys.ins().getIconXy(getWin(MainWin).getVipGroup(),i);return t=LayerMgr.Top.globalToLocal(t.x,t.y)},this,VipFlyWin,t,n),e.setOrder(4),DuiLieSys.ins().flyData.addFlyData(e)}},e.prototype.patchVipFlyEnd=function(){},e.prototype.createFlyItem=function(t){var e=new VipFlyWinItem;return e.open(t),e},e.prototype.sendGetVipAward=function(t){var e=this.getBytes(6);e.writeByte(t),this.send(e)},e.prototype.patchGetVipAward=function(t){var e=t.readInt();MathUtil.writeIntToArray(e,this.vipAwardStates),RpFun.showVipAwardRp()},e.prototype.hasVipAwardCanGet=function(t){for(var e=!1,i=0;t>=i&&!(e=this.canGetVipAward(i));i++);return e},e.prototype.getVipAwardState=function(t){var e=ActRewardState.Geted,i=this.vipAwardStates[t-1];return e=0==i?Actor.ins().vipLv>=t?ActRewardState.CanGet:ActRewardState.NotReached:ActRewardState.Geted},e.prototype.canGetVipAward=function(t){return this.getVipAwardState(t)==ActRewardState.CanGet},e.prototype.patchSvipLimitGiftData=function(t){this.sVipLimitGiftData.parse(t)},e.prototype.patchSvipLimitGiftUpdate=function(t){this.sVipLimitGiftData.parseUpdateSingle(t)},e.prototype.sendSvipLimitGifBuy=function(t){var e=this.getBytes(12);e.writeShort(t),this.send(e)},e.prototype.sendVipRedpacket=function(){var t=this.getBytes(13);this.send(t)},e.prototype.sendVipRedpacketInfo=function(){var t=this.getBytes(14);this.send(t)},e.prototype.vipRedpacketInfoBack=function(t){this.xjhbData.parseUpdate(t),this.xjhbData.xjhbNum>0?openWin(XJHBSubWin):this.xjhbData.redTimes>0&&(isShowWin(XJHBWin)||RES.getResAsync("xjhb_bg",this.openXJHBWin,this)),RpFun.showVipRedPacketRp()},e.prototype.openXJHBWin=function(){if(!urlParam.isShenhe){var t=new DuiLieOpenWinData;t.setData(function(){openWin(XJHBWin,function(){t.call()})},this),t.setOrder(2),t.t=XJHBWin,DuiLieSys.ins().flyData.addFlyData(t)}},__decorate([post()],e.prototype,"vipRedpacketInfoBack",null),e}(BaseSys);__reflect(VipSys.prototype,"VipSys"),SystemMap.VipSys=VipSys.ins.bind(VipSys),window.VipSys=VipSys;var VipWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[VipPanel,SVipPanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addChangeE(this.tab,this.setGroup)},e.prototype.open=function(e){void 0===e&&(e=-1);for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.prototype.open.apply(this,[e].concat(i)),this.setGroup()},e.prototype.setGroup=function(){this.closeBtn.icon=this.tab.selectedIndex<=0?"public_zycs_quxiao":"svip_zycs_close",this.eGroup.visible=this.tab.selectedIndex<=0},e}(BaseWinAutoTab);__reflect(VipWin.prototype,"VipWin"),window.VipWin=VipWin;var SvipBuZuTipsWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SvipBuZuTipsWinEUI",this.addBg()},e.prototype.open=function(e){t.prototype.open.call(this),this.addClickE(this.btnOK,this.onClick),this.lbDesc.textFlow=addColorTF(e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnOK:closeWin(this),openWin(RechargeWin2)}},e}(BaseWinSingle);__reflect(SvipBuZuTipsWin.prototype,"SvipBuZuTipsWin"),window.SvipBuZuTipsWin=SvipBuZuTipsWin;var SVipEveryDayAwardWin=function(t){function e(){var e=t.call(this)||this;return e.curShowSviplv=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SVipEveryDayAwardWinEUI",this.listAward.itemRenderer=ItemBaseRewardName,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.addBg()},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnGet,this.onClick),this.addLsn(VipSys.ins().patchSvipEveryDayAward,this.update),this.update()},e.prototype.update=function(){if(Actor.ins().sVipLv>0){var t=VipSys.ins().hasSvipEveryDayAwarCanGet();t?(this.curShowSviplv=VipSys.ins().getSvipEveryDayAwardIndex(),this.btnGet.visible=!0,this.imgYLQ.visible=!1):(this.curShowSviplv=Actor.ins().sVipLv,this.btnGet.visible=!1,this.imgYLQ.visible=!0)}else this.curShowSviplv=1,this.btnGet.visible=!1,this.imgYLQ.visible=!1;this.imgTitle.source="svip_zycs_mrjl"+this.curShowSviplv;var e=Cfg.getConfig(SVipConfig,this.curShowSviplv);this.listAwardArr.source=e.dailyrewards},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnGet:Actor.ins().sVipLv>=this.curShowSviplv?VipSys.ins().sendGetSVipEveryDayAward():showtipsFail("SVIP"+this.curShowSviplv+"可领取")}},e}(BaseWinSingle);__reflect(SVipEveryDayAwardWin.prototype,"SVipEveryDayAwardWin"),window.SVipEveryDayAwardWin=SVipEveryDayAwardWin;var SVipPanel=function(t){function e(){var e=t.call(this)||this;return e.curShowLv=1,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SVipPanelEUI",this.listAward.itemRenderer=ItemBaseReward,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.listAttr.itemRenderer=SvipPanelAttrItem,this.listAttr.dataProvider=this.listAttrArr=new eui.ArrayCollection,this.labelTequan.textFlow=addColorTF(this.labelTequan.text,5949490,!0),this.progressBarExp.labelFunction=function(t,e){return t+"/"+e},this.mcIcon=new McIcon,this.groupBox.addChild(this.mcIcon)},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.btnRecharge1,this.onClick),this.addClickE(this.btnGet,this.onClick),this.addClickE(this.btnLeft,this.onClick),this.addClickE(this.btnRight,this.onClick),this.addClickE(this.labelTequan,this.onClick),this.addClickE(this.btnMZLB,this.onClick),this.addClickE(this.btnZK,this.onClick),this.addLsn(VipSys.ins().patchSvipData,this.update),this.addLsn(VipSys.ins().patchSVipAwardstate,this.updateGetAward),this.addLsn(VipSys.ins().patchSvipEveryDayAward,this.updateEveryDayAward),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.curShowLv=this.getAwardMinLv(),this.update()},e.prototype.close=function(){t.prototype.close.call(this),this.mcIcon.close()},e.prototype.getAwardMinLv=function(){for(var t=Actor.ins().sVipLv,e=0;t>=e;e++)if(VipSys.ins().canGetSVipAward(e)){t=e;break}return Math.max(t,1)},e.prototype.update=function(){this.updateMyVip(),this.updateCurVip(),this.updateEveryDayAward()},e.prototype.updateGetAward=function(){this.curShowLv=this.getAwardMinLv(),this.updateCurVip()},e.prototype.updateEveryDayAward=function(){this.imgMRLBYLQ.visible=Actor.ins().sVipLv>0&&!VipSys.ins().hasSvipEveryDayAwarCanGet()},e.prototype.updateCurVip=function(){var t=Cfg.getConfig(SVipConfig,this.curShowLv);this.mcIcon.open(t.mcIcon),this.bmpLabelZSGift.text=t.lv.toString(),this.bmpLabelTQGift.text=t.lv.toString(),this.listAwardArr.source=t.awards,this.listAttrArr.source=t.attrdesc;var e=VipSys.ins().getSVipAwardState(this.curShowLv);this.imgYLQ.visible=e==ActRewardState.Geted,this.btnGet.visible=e==ActRewardState.CanGet,this.btnRecharge1.visible=e==ActRewardState.NotReached,this.bmpLabelPower.text=t.power.toString(),this.updateLeftRightBtn()},e.prototype.updateMyVip=function(){var t=Actor.ins().sVipLv,e=0;t<Cfg.getSVipMaxLv()?(e=t+1,this.groupRechargeAgain.visible=!0,this.labelMax.visible=!1):(e=t,this.groupRechargeAgain.visible=!1,this.labelMax.visible=!0);var i=(Cfg.getConfig(SVipConfig,t),Cfg.getConfig(SVipConfig,e));this.bmpLabelLv.text=t.toString(),this.bmpLabelLvNext.text=e.toString(),this.bmpLabelRecharge.text=Math.max(i.needYb-VipSys.ins().sVipExp,0).toString(),this.bmpLabelRechargeLv.text=e.toString(),this.progressBarExp.maximum=i.needYb,this.progressBarExp.value=VipSys.ins().sVipExp},e.prototype.updateLeftRightBtn=function(){this.btnLeft.visible=this.curShowLv>1,this.btnRight.visible=this.curShowLv<Cfg.getSVipMaxLv(),this.updateRp()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(e)){for(var i=!1,n=!1,a=VipSys.ins().sVipAwardStates,o=Actor.ins().sVipLv,s=0;s<a.length;s++)o>=s&&(s<this.curShowLv&&(i=i||VipSys.ins().canGetSVipAward(s)),s>this.curShowLv&&(n=n||VipSys.ins().canGetSVipAward(s)));this.btnLeft.redPoint.visible=i,this.btnRight.redPoint.visible=n,this.btnGet.redPoint.visible=RpSys.ins().getData(VipWin,e,"sviplv",Actor.ins().sVipLv),this.btnMZLB.redPoint.visible=RpSys.ins().getData(VipWin,e,"mrlb")}},e.prototype.onClick=function(t){var e;switch(t.currentTarget){case this.btnRecharge:case this.btnRecharge1:openWin(RechargeWin);break;case this.btnLeft:this.curShowLv>1&&this.curShowLv--,this.updateCurVip();break;case this.btnRight:this.curShowLv<Cfg.getSVipMaxLv()&&this.curShowLv++,this.updateCurVip();break;case this.btnGet:e=Cfg.getConfig(SVipConfig,this.curShowLv),BagSys.ins().checkBagFreeByItems(e.awards)&&VipSys.ins().getSVipAwardState(this.curShowLv)==ActRewardState.CanGet&&VipSys.ins().sendGetSVipAward(this.curShowLv);break;case this.labelTequan:openWin(SVipTequanTipsWin,this.curShowLv);break;case this.btnMZLB:openWin(SVipEveryDayAwardWin);break;case this.btnZK:openWin(ShopWin,ShopWin.getTabIndexbyPanel(MallPanel),MallPanel.getTabIndexbyPanel(MallSVIPPanel))}},e.getSysId=function(){return SysId.svip},e.getTitle=function(){return"btz_zycs_svip"},e.getTabTitle=function(){return"bqz_zycs_svip"},e}(BasePanel);__reflect(SVipPanel.prototype,"SVipPanel"),window.SVipPanel=SVipPanel;var SvipPanelAttrItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SvipPanelAttrItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelName.textFlow=StrUtil.toTF(t)},e}(BaseItemRender);__reflect(SvipPanelAttrItem.prototype,"SvipPanelAttrItem"),window.SvipPanelAttrItem=SvipPanelAttrItem;var SVipTequanTipsWin=function(t){function e(){var e=t.call(this)||this;return e.curShowLv=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SVipTequanTipsWinEUI",this.layer=LayerMgr.Popup,this.listAttr.itemRenderer=SvipPanelAttrItem,this.listAttr.dataProvider=this.listAttrArr=new eui.ArrayCollection,this.addBg()},e.prototype.open=function(e){void 0===e&&(e=1),t.prototype.open.call(this),this.addClickE(this.btnLeft,this.onClick),this.addClickE(this.btnRight,this.onClick),this.curShowLv=Math.max(e,1),this.updateCurVip()},e.prototype.updateCurVip=function(){this.imgVipLv.source="svip_zycs_tq"+this.curShowLv;var t=Cfg.getConfig(SVipConfig,this.curShowLv);this.listAttrArr.source=t.description},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLeft:this.curShowLv>1&&this.curShowLv--,this.updateCurVip();break;case this.btnRight:this.curShowLv<Cfg.getSVipMaxLv()&&this.curShowLv++,this.updateCurVip()}},e}(BaseWinSingle);__reflect(SVipTequanTipsWin.prototype,"SVipTequanTipsWin"),window.SVipTequanTipsWin=SVipTequanTipsWin;var RedBaoRobData=function(){function t(){this.actorId=0,this.redbaoId=0,this.roleName="",this.job=0,this.vipLv=0,this.monthCard=0,this.time=0,this.successState=0,this.receiveState=0,this.yuanbaoNum=0}return t.prototype.parser=function(t){this.actorId=t.readInt(),this.redbaoId=t.readInt(),this.roleName=t.readString(),this.job=t.readByte(),this.vipLv=t.readByte(),this.monthCard=t.readByte(),this.time=DateUtil.formatMiniDateTime(t.readInt()),this.receiveState=0},t.prototype.parser2=function(t){this.successState=t.readByte(),this.receiveState=t.readByte(),this.yuanbaoNum=t.readInt()},t}();__reflect(RedBaoRobData.prototype,"RedBaoRobData");var RedbaoReceiveState;!function(t){t[t.weiLing=0]="weiLing",t[t.yiLing=1]="yiLing",t[t.qiangWan=2]="qiangWan",t[t.guoQi=3]="guoQi"}(RedbaoReceiveState||(RedbaoReceiveState={}));var RedBaoSendData=function(){function t(){this.id=0,this.price=0,this.count=0}return t.prototype.parser=function(t){this.id=t.readInt(),this.price=t.readShort(),this.count=t.readShort()},t}();__reflect(RedBaoSendData.prototype,"RedBaoSendData");var VipComponent=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipComponentEUI",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(VipSys.ins().patchVipUpdate,this.updateChuangguan),this.addLsn(VipSys.ins().patchVipInit,this.updateChuangguan),this.addLsn(VipSys.ins().vipRedpacketInfoBack,this.updateChuangguan),this.addLsn(FbSys.ins().patchGuaJiChallenge,this.updateChuangguan),this.updateChuangguan()},e.prototype.updateChuangguan=function(){ComUtil.isXianYuApp?this.img_tips&&(this.img_tips.source="xjhb_img_tips30009_0"):this.img_tips&&(this.img_tips.source="xjhb_img_tips1");var t=this.visible,e=VipSys.ins().xjhbData.totalNum;e<Cfg.getHongbaoMaxLv()?(this.visible=!0,this.onUpdate()):this.visible=!1,LogicSys.ins().centerEntity&&t!=this.visible&&LogicSys.ins().centerEntity.updatePos()},e.prototype.onUpdate=function(){var t=Cfg.getConfig(VipHongbaoConfig,VipSys.ins().xjhbData.totalNum);this.bmpLabelGuan.text=t.needCustom.toString()},e}(BaseEUI);__reflect(VipComponent.prototype,"VipComponent"),window.VipComponent=VipComponent;var VipFlyWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Top,e.winType=WinType.NeverCloseWin,e.vipLv=0,e.flyFun=new Caller,e.isMax=!1,e.gqNum=0,e.skinName="VipFlyWinEUI",e.addBg(),e}return __extends(e,t),e.prototype.open=function(e,i,n){void 0===e&&(e=0),t.prototype.open.call(this),this.vipLv=e,this.flyFun.obj=n,this.flyFun.func=i,this.bmpLabelLv.text=e.toString(),this.updateView(e),Timer.ins()["do"](3e3,0,1,this.end,this)},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this),Timer.ins().removeAll(this),this.flyFun.param=[this.groupLv],this.flyFun.call()},e.prototype.updateView=function(t){ComUtil.isXianYuApp?this.img_tips&&(this.img_tips.source="xjhb_img_tips30009_1"):this.img_tips&&(this.img_tips.source="xjhb_img_tips2");var e=VipSys.ins().xjhbData.totalNum;if(this.isMax=e>=Cfg.getHongbaoMaxLv(),this.nextGroup.visible=!this.isMax,!this.isMax){var i=Cfg.getConfig(VipHongbaoConfig,VipSys.ins().xjhbData.totalNum);this.gqNum=i.needCustom}},e.prototype.end=function(){closeWin(this)},e}(BaseWinSingle);__reflect(VipFlyWin.prototype,"VipFlyWin"),window.VipFlyWin=VipFlyWin;var VipFlyWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipFlyWinItemEUI",e}return __extends(e,t),e.prototype.open=function(t){void 0===t&&(t=0),this.bmpLabelLv.text=t.toString()},e}(BaseEUI);__reflect(VipFlyWinItem.prototype,"VipFlyWinItem"),window.VipFlyWinItem=VipFlyWinItem;var VipLoginWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="VipLoginWinEUI",this.autoCloseTime=5,this.btnGet.addChild(MC.createCenterGruop("res/eff/vipeff",-1))},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this),this.addClickE(this.btnGet,this.onClick)},e.prototype.onAutoClose=function(e){void 0===e&&(e=0),VipSys.ins().createVipFly(1),t.prototype.onAutoClose.call(this,e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnGet:this.onAutoClose()}},e}(BaseWinSingle);__reflect(VipLoginWin.prototype,"VipLoginWin"),window.VipLoginWin=VipLoginWin;var VipPanel=function(t){function e(){var e=t.call(this)||this;return e.curShowLv=1,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listAward.itemRenderer=ItemBaseReward,this.listAward.dataProvider=this.listAwardArr=new eui.ArrayCollection,this.labelTequan.textFlow=addColorTF(this.labelTequan.text,5949490,!0),this.progressBarExp.labelFunction=function(t,e){return t+"/"+e},this.mcIcon=new McIcon,this.groupMcIcon.addChild(this.mcIcon)},e.prototype.setSkinName=function(){this.skinName="VipPanelEUI"
},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnRecharge,this.onClick),this.addClickE(this.btnGet,this.onClick),this.addClickE(this.btnLeft,this.onClick),this.addClickE(this.btnRight,this.onClick),this.addClickE(this.labelTequan,this.onClick),this.addLsn(VipSys.ins().patchVipUpdate,this.update),this.addLsn(VipSys.ins().patchGetVipAward,this.updateGetVipAward),this.curShowLv=this.getAutoVipLv(),this.update()},e.prototype.close=function(){this.mcIcon.close(),t.prototype.close.call(this)},e.prototype.getAutoVipLv=function(){for(var t=1;t<=Actor.ins().vipLv;t++)if(VipSys.ins().canGetVipAward(t))return t;return Actor.ins().vipLv<Cfg.getVipMaxLv()?Actor.ins().vipLv+1:Actor.ins().vipLv},e.prototype.update=function(){this.updateMyVip(),this.updateCurVip()},e.prototype.updateGetVipAward=function(){this.curShowLv=this.getAutoVipLv(),this.updateCurVip(),GFunc.playUIMovie("vipeff2",360,600,this)},e.prototype.updateCurVip=function(){var t=Cfg.getConfig(VipConfig,this.curShowLv);this.mcIcon.open(t.mcIcon),this.bmpLabelZSGift.text=t.lv.toString(),this.bmpLabelTQGift.text=t.lv.toString(),this.listAwardArr.source=t.awards,this.listAward.dataProvider=new eui.ArrayCollection(t.awards),this.imgBoxName.source=Actor.ins().job+"01vip"+t.lv;var i=VipSys.ins().xjhbData.totalNum;this.labelGuan.visible=!1;var n=VipSys.ins().getVipAwardState(this.curShowLv);if(i<Cfg.getHongbaoMaxLv()&&n==ActRewardState.NotReached){var a=Cfg.getConfig(VipHongbaoConfig,VipSys.ins().xjhbData.totalNum);ComUtil.isXianYuApp?this.labelGuan.text="通过天路第"+a.needCustom+"层送仙玉红包":this.labelGuan.text="通过天路第"+a.needCustom+"层送现金红包",this.labelGuan.visible=!0}this.imgYLQ.visible=n==ActRewardState.Geted,this.btnGet.visible=n==ActRewardState.CanGet,this.btnGet.redPoint.visible=RpSys.ins().getData(VipWin,e,this.curShowLv),this.updateLeftRightBtn()},e.prototype.updateMyVip=function(){var t,e=Actor.ins().vipLv,i=Cfg.getConfig(VipConfig,e),n=0,a=VipSys.ins().vipExp;e<Cfg.getVipMaxLv()?(this.currentState="normal",n=e+1,t=i.needYb):(this.currentState="max",n=e,t=a=2300);var o=t-a;this.bmpLabelLv.text=e.toString(),this.bmpLabelLvNext.text=n.toString(),this.bmpLabelRecharge.text=o.toString(),this.bmpLabelRechargeLv.text=n.toString(),this.progressBarExp.maximum=t,this.progressBarExp.value=a,this.group1.visible&&(this.group1.visible=!urlParam.isShenhe),this.btnRecharge.visible&&(this.btnRecharge.visible=!urlParam.isShenhe)},e.prototype.updateLeftRightBtn=function(){this.btnLeft.visible=this.curShowLv>1,this.btnRight.visible=this.curShowLv<Cfg.getVipMaxLv()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),!t||t.check(this.getThisDef())){for(var e=!1,i=!1,n=VipSys.ins().vipAwardStates,a=Actor.ins().vipLv,o=0;o<n.length;o++)a>=o&&(o<this.curShowLv&&(e=e||1==n[o]),o>this.curShowLv&&(i=i||1==n[o]));this.btnLeft.redPoint.visible=e,this.btnRight.redPoint.visible=i}},e.prototype.onClick=function(t){var e;switch(t.currentTarget){case this.btnRecharge:openWin(RechargeWin);break;case this.btnLeft:this.curShowLv>1&&this.curShowLv--,this.updateCurVip();break;case this.btnRight:this.curShowLv<Cfg.getVipMaxLv()&&this.curShowLv++,this.updateCurVip();break;case this.btnGet:e=Cfg.getConfig(VipConfig,this.curShowLv),BagSys.ins().checkBagFreeByItems(e.awards)&&VipSys.ins().getVipAwardState(this.curShowLv)==ActRewardState.CanGet&&VipSys.ins().sendGetVipAward(this.curShowLv);break;case this.labelTequan:openWin(VipTequanTipsWin,this.curShowLv)}},e.getSysId=function(){return SysId.vip},e.getTitle=function(){return"btz_zycs_vip"},e.getTabTitle=function(){return"bqz_zycs_vip"},e}(BasePanel);__reflect(VipPanel.prototype,"VipPanel"),window.VipPanel=VipPanel;var VipTequanTipsWin=function(t){function e(){var e=t.call(this)||this;return e.curShowLv=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="VipTequanTipsWinEUI",this.listAttr.itemRenderer=SvipPanelAttrItem,this.listAttr.dataProvider=this.listAttrArr=new eui.ArrayCollection,this.addBg()},e.prototype.open=function(e){void 0===e&&(e=1),t.prototype.open.call(this),this.addClickE(this.btnLeft,this.onClick),this.addClickE(this.btnRight,this.onClick),this.curShowLv=e,this.updateCurVip()},e.prototype.updateCurVip=function(){this.imgVipLv.source="vip_zycs_tq"+this.curShowLv;var t=Cfg.getConfig(VipConfig,this.curShowLv);this.listAttrArr.source=t.desc2},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLeft:this.curShowLv>1&&this.curShowLv--,this.updateCurVip();break;case this.btnRight:this.curShowLv<Cfg.getVipMaxLv()&&this.curShowLv++,this.updateCurVip()}},e}(BaseWinSingle);__reflect(VipTequanTipsWin.prototype,"VipTequanTipsWin"),window.VipTequanTipsWin=VipTequanTipsWin;var VipZunxiangWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="VipZunxiangWinEUI"},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this),this.addClickE(this.btnGet,this.onClick),this.labelDesc.text=Cfg.getConfig(VipConfig,e).desc,this.bmpLabelLv.text=e.toString(),Timer.ins()["do"](0,1e3,5,this.onTimer,this)},e.prototype.close=function(){t.prototype.close.call(this),Timer.ins().remove(this.onTimer,this),openWin(VipWin,0)},e.prototype.onTimer=function(t){this.labelAutoGet.text=t+"秒后自动领取",0==t&&closeWin(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnGet:closeWin(this)}},e}(BaseWinSingle);__reflect(VipZunxiangWin.prototype,"VipZunxiangWin"),window.VipZunxiangWin=VipZunxiangWin;var SVipLimitGiftWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="SVipLimitGiftWinEUI",e.addBg(),e.setSkinPart("priceIconOld",new PriceIcon),e.setSkinPart("priceIconNew",new PriceIcon),e.tab1.itemRenderer=SVipLimitGiftWinTabBtn,e.tab1.dataProvider=new eui.ArrayCollection([]),e.list.dataProvider=e.listArray=new eui.ArrayCollection,e.list.itemRenderer=ItemBaseReward,e.priceIconOld.setType(CurType.yb),e.priceIconOld.setIsYuanJia(!0),e.priceIconNew.setType(CurType.yb),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnBuy,this.onClick),this.addItemTapE(this.tab1,this.onMenuClick),this.addLsn(VipSys.ins().patchSvipLimitGiftData,this.updateList),this.addLsn(VipSys.ins().patchSvipLimitGiftUpdate,this.updateList),this.updateList()},e.prototype.updateList=function(){var t=VipSys.ins().sVipLimitGiftData,i=t.sVipLimitGiftItemDatas.concat();i.length>0?(this.tab1.dataProvider.length!=i.length&&(SortUtil.sortOn(i,["id"],[SortType.up]),this.tab1.dataProvider=new eui.ArrayCollection(i),this.tab1.validateNow(),this.tab1.selectedIndex=0),this.updatePanel()):closeWin(e)},e.prototype.updatePanel=function(){var t=this.data,e=t.config;this.lbDesc.text=0==e.svip?"购买后解锁更低折扣":"SVIP"+e.svip+"可购买",this.listArray.source=e.rewards,this.priceIconOld.setPrice(e.price),this.priceIconNew.setPrice(e.needyuanbao),this.bitZhe.text=""+(e.discount/10).toString().replace(".","d")},e.prototype.updateTime=function(){this.data&&(this.lbDate.text=getFormatTime(this.data.leftTime,"hh小时mm分ss秒")+"后永久消失")},Object.defineProperty(e.prototype,"data",{get:function(){return this.tab1.selectedItem},enumerable:!0,configurable:!0}),e.prototype.onMenuClick=function(t){this.updatePanel()},e.prototype.onClick=function(t){switch(t.target){case this.btnBuy:GFunc.checkSVIP(this.data.config.svip)&&GFunc.checkCurrency(CurType.yb,this.data.config.needyuanbao)&&VipSys.ins().sendSvipLimitGifBuy(this.data.id)}},e.getSysId=function(){return SysId.SvipLimit},e}(BaseWinSingle);__reflect(SVipLimitGiftWin.prototype,"SVipLimitGiftWin"),window.SVipLimitGiftWin=SVipLimitGiftWin;var SVipLimitGiftWinTabBtn=function(t){function e(){var e=t.call(this)||this;return e.skinName="BtnTab6ZYCSSkin",e.showRedPoint(!1),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=""+GFunc.GetLvStrByLv(t.config.level,!0)},e.prototype.showRedPoint=function(t){this.redPoint.visible=t},e}(BaseItemRender);__reflect(SVipLimitGiftWinTabBtn.prototype,"SVipLimitGiftWinTabBtn"),window.SVipLimitGiftWinTabBtn=SVipLimitGiftWinTabBtn;var SVipLimitGiftData=function(){function t(){this.sVipLimitGiftItemDatas=[]}return t.prototype.parse=function(t){var e=t.readByte();this.sVipLimitGiftItemDatas.length=0;for(var i=0;e>i;i++){var n=new SVipLimitGiftItemData;n.parse(t),this.sVipLimitGiftItemDatas.push(n)}},t.prototype.parseUpdateSingle=function(t){var e=t.readByte(),i=new SVipLimitGiftItemData;i.parse(t);var n=this.getItemByLevel(i.id);switch(e){case 1:this.sVipLimitGiftItemDatas.push(i);break;case 2:this.removeData(i.id);break;case 3:n.svipLevel=i.svipLevel}},t.prototype.removeData=function(t){for(var e=0;e<this.sVipLimitGiftItemDatas.length;e++){var i=this.sVipLimitGiftItemDatas[e];i.id==t&&this.sVipLimitGiftItemDatas.splice(e,1)}},t.prototype.getItemByLevel=function(t){for(var e=0;e<this.sVipLimitGiftItemDatas.length;e++){var i=this.sVipLimitGiftItemDatas[e];if(i.id==t)return i}return null},t.prototype.isOpen=function(){return this.sVipLimitGiftItemDatas.length>0},t}();__reflect(SVipLimitGiftData.prototype,"SVipLimitGiftData"),window.SVipLimitGiftData=SVipLimitGiftData;var SVipLimitGiftItemData=function(){function t(){this.id=1,this.svipLevel=1,this.time=0}return t.prototype.parse=function(t){this.id=t.readByte(),this.svipLevel=t.readByte();var e=t.readInt();this.time=1e3*e+Timer.ins().getEgretTimer()},Object.defineProperty(t.prototype,"leftTime",{get:function(){return Math.max((this.time-Timer.ins().getEgretTimer())/1e3,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return Cfg.getConfig(SVipLimitGiftConfig,this.id,this.svipLevel)},enumerable:!0,configurable:!0}),t}();__reflect(SVipLimitGiftItemData.prototype,"SVipLimitGiftItemData"),window.SVipLimitGiftItemData=SVipLimitGiftItemData;var WCDashiWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="XingHunAttrWinEUI",this.addBg(),t.prototype.initUI.call(this),this.layer=LayerMgr.Popup},e.prototype.open=function(e){t.prototype.open.call(this),this.daShiData=e,this.addClickE(this.btnUp,this.onClick),this.addLsn(WCSys.ins().patchDashiUp,this.update),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.update(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(this))&&(this.btnUp.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,WCLevelPanel,e))},e.prototype.update=function(){var t=this.daShiData;this.totalPower.text=t.genPower().toFixed(),this.imgTitle.source="msbd_zycs_ms"+t.type,this.bitLevel.text="."+t.level+"r";var e=Cfg.getConfig(WCDashiConfig,this.daShiData.type,Math.max(t.level-1,0)),i=t.noActRank()?addColor(Lang.xh_str4,15129784):Lang.xh_str4+"  "+this.daShiData.getDec(e.neednumber)+e.needlv+addColor(Lang.common_str40,5767068);if(this.lbCurLevel.textFlow=addColorTF(i),i=t.noActRank()?addColor(Lang.xh_str9,15129784):t.getAttrDec()+addColor(" +"+t.getConfig().per/100+"%",5767068),this.lbCurAttr.textFlow=addColorTF(i),!t.isMaxRank()){var n=t.getConfig(),a=Cfg.getNextConfig(WCDashiConfig,this.daShiData.type,t.level),o=WCSys.ins().getLevelCountByType(this.daShiData.type,n.needlv),s=addColor("("+o+"/"+n.neednumber+")",o<n.neednumber?15733780:5767068);this.lbNextLevel.textFlow=addColorTF(Lang.foot_str2+"  "+this.daShiData.getDec()+n.needlv+s),this.lbNextAttr.textFlow=addColorTF(t.getAttrDec()+addColor(" +"+a.per/100+"%",5767068))}var r=t.canRank();t.noActRank()?this.currentState=r?"canAct":"noAct":t.isMaxRank()?this.currentState="max":r?this.currentState="upRank":this.currentState="noRank"},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnUp:this.daShiData.canRank()&&WCSys.ins().sendDashiUp(this.daShiData.type)}},e}(BaseWinSingle);__reflect(WCDashiWin.prototype,"WCDashiWin"),window.WCDashiWin=WCDashiWin;var WCLevelTipsWin=function(t){function e(){var e=t.call(this)||this;return e.longPressBtnUp=new LongPress,e.ids=[],e.index=0,e.skinName="WCLevelTipsWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.btnGet.textFlow=addColorTF("获取途径",e.btnGet.textColor,!0),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.data=e,this.addClickE(this.btnSend,this.onClickCommon),this.addClickE(this.btnGet,this.onClickCommon),this.addClickE(this.btnLeft,this.onClickCommon),this.addClickE(this.btnRight,this.onClickCommon),this.addLsn(WCSys.ins().patchLevelUp,this.updatePanel),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.infoPanel=function(){var t=Cfg.getConfig(WCQualityConfig,this.data.getConfig().type);this.ids=t.haveid,this.index=t.haveid.indexOf(this.data.id),this.updatePanel()},e.prototype.updatePanel=function(){if(this.item.data=this.data,this.power.text=""+this.data.getPower(),AttrData.getFm(null,null,"："),this.lbCurAttr.textFlow=addColorTF(AttrData.parse(this.data.getAttrData(),{fm:AttrData.getFm(null,null,"：")}).join("\n")),this.lbNextAttr.textFlow=addColorTF(AttrData.parse(this.data.getAttrData(this.data.level+1),{fm:AttrData.getFm(null,null,"：")}).join("\n")),this.btnSend.label=0==this.data.level?Lang.btn_jh:Lang.btn_sjie,this.data.isMax())this.currentState="max";else{this.currentState="normal";var t=GFunc.getItemCount(this.data.getConfig().needitem.id),e=this.data.getConfig().needitem.count,i=Cfg.getItemCfg(this.data.getConfig().needitem.id).getName()+"：";i+=addColor(t+"/"+e,e>t?15410212:5767068),this.lbConsumeCount.textFlow=addColorTF(i)}this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,WCLevelPanel,this.data.getConfig().type,this.data.id),this.showBtn()},e.prototype.showBtn=function(){this.btnLeft.visible=!1,this.btnRight.visible=!1},e.prototype.onClickCommon=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(this.data.getConfig().needitem)&&WCSys.ins().sendLevelUp(this.data.id);break;case this.btnGet:TipsSys.ins().setBuyGoodsWarn(this.data.getConfig().needitem.id);break;case this.btnLeft:this.index-=1,this.index<0&&(this.index=0),this.onQieHuan();break;case this.btnRight:this.index+=1,this.index>this.ids.length-1&&(this.index=this.ids.length-1),this.onQieHuan()}},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(this.data.getConfig().needitem)?WCSys.ins().sendLevelUp(this.data.id):this.longPressBtnUp.stop()},e.prototype.onQieHuan=function(){this.data=WCSys.ins().getLevelDataById(this.ids[this.index]),this.updatePanel()},e}(BaseWinSingle);__reflect(WCLevelTipsWin.prototype,"WCLevelTipsWin"),window.WCLevelTipsWin=WCLevelTipsWin;var WCStageActTipsWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="WCStageActTipsWinEUI",this.addBg(),this.mc=new MC,this.groupMC.addChild(this.mc)},e.prototype.open=function(e){t.prototype.open.call(this),this.addClickE(this,this.onTap),this.setPanel(e)},e.prototype.close=function(){t.prototype.close.call(this),this.mc.reset()},e.prototype.setPanel=function(t){var e=t.getShowJ();this.mc.playFile(getEffName("sh"+e+"_zycs"),-1),this.imgName.text=t.getStageName()},e.prototype.onTap=function(t){closeWin(this)},e}(BaseWinSingle);__reflect(WCStageActTipsWin.prototype,"WCStageActTipsWin"),window.WCStageActTipsWin=WCStageActTipsWin;var WCSys=function(t){function e(){var e=t.call(this)||this;return e.levelDatas=[],e.dashiDatas=[],e.stageData=new WCStageData,e.sysId=PackId.WC,e.reg(1,e.patchInfo),e.reg(2,e.patchLevelUp),e.reg(3,e.patchDashiUp),e.reg(4,e.patchStageUp),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchInfo=function(t){for(var e=t.readShort(),i=0;e>i;i++){var n=this.getLevelDataById(i+1);n.level=t.readShort()}e=t.readByte();for(var a=0;e>a;a++){var o=this.getDashiDataByType(a+1);o.level=t.readShort()}this.stageData.level=t.readShort()},e.prototype.sendLevelUp=function(t){var e=this.getBytes(2);e.writeShort(t),this.send(e)},e.prototype.patchLevelUp=function(t){var e=this.getLevelDataById(t.readShort());e.level=t.readShort(),RpFun.showWCLevelRp(),RpFun.showWCDashiRp()},e.prototype.sendDashiUp=function(t){var e=this.getBytes(3);e.writeByte(t),this.send(e)},e.prototype.patchDashiUp=function(t){var e=this.getDashiDataByType(t.readByte());e.level=t.readShort(),RpFun.showWCDashiRp()},e.prototype.sendStageUp=function(){this.sendBase(4)},e.prototype.patchStageUp=function(t){var e=this.stageData.getShowJ();this.stageData.level=t.readShort(),e!=this.stageData.getShowJ()&&openWin(WCStageActTipsWin,this.stageData),RpFun.showWCStageRp()},e.prototype.getLevelDataById=function(t){return this.levelDatas[t]||(this.levelDatas[t]=new WCLevelData(t))},e.prototype.getLevelDatasByType=function(t){for(var e=[],i=Cfg.getConfig(WCQualityConfig,t).haveid,n=0,a=i;n<a.length;n++){var o=a[n];e.push(this.getLevelDataById(o))}return e},e.prototype.getPowerByLevelDatas=function(t){for(var e=0,i=0,n=t;i<n.length;i++){var a=n[i];e+=a.getPower()}return e},e.prototype.getLevelDatasAll=function(t){var e=[];for(var i in t){var n=t[i];e=AttrData.mergeAttr(n.getAttrData(),e)}return e},e.prototype.getDashiDataByType=function(t){return this.dashiDatas[t]||(this.dashiDatas[t]=new WCDashiData(t))},e.prototype.getMinLevelByType=function(t){for(var e=Number.MAX_VALUE,i=Cfg.getConfig(WCQualityConfig,t).haveid,n=0,a=i;n<a.length;n++){var o=a[n];e=Math.min(e,this.getLevelDataById(o).level)}return e},e.prototype.getLevelCountByType=function(t,e){for(var i=0,n=Cfg.getConfig(WCQualityConfig,t).haveid,a=0,o=n;a<o.length;a++){var s=o[a];this.getLevelDataById(s).level>=e&&(i+=1)}return i},e}(BaseSys);__reflect(WCSys.prototype,"WCSys"),SystemMap.WCSys=WCSys.ins.bind(WCSys),window.WCSys=WCSys;var WCDashiData=function(){function t(t){this.type=1,this.level=0,this.type=t}return t.prototype.getConfig=function(){return this.dashiConfig&&this.dashiConfig.level==this.level||(this.dashiConfig=Cfg.getConfig(WCDashiConfig,this.type,this.level)),this.dashiConfig},t.prototype.getBaseConfig=function(){return this.baseConfig||(this.baseConfig=Cfg.getConfig(WCQualityConfig,this.type))},t.prototype.noActRank=function(){return 0==this.level},t.prototype.isMaxRank=function(){return this.level>=Cfg.getMaxConfig(WCDashiConfig,this.type).level},t.prototype.canRank=function(){return this.isMaxRank()?!1:WCSys.ins().getLevelCountByType(this.type,this.getConfig().needlv)>=this.getConfig().neednumber},t.prototype.getDaShiPlusAttr=function(){var t=WCSys.ins().getLevelDatasByType(this.type),e=WCSys.ins().getLevelDatasAll(t),i=[],n=this.getConfig().per;for(var a in e){var o=new AttrData;o.type=e[a].type,o.value=e[a].value*n/1e4,i.push(o)}return i},t.prototype.genPower=function(){return GFunc.getPower(this.getDaShiPlusAttr())>>0},t.prototype.getDec=function(t){void 0===t&&(t=this.getConfig().neednumber);var e=t+"张"+this.getBaseConfig().name+Lang.wc_str5+"Lv.";return e},t.prototype.getAttrDec=function(){var t=""+this.getBaseConfig().name+Lang.wc_str2;return t},t}();__reflect(WCDashiData.prototype,"WCDashiData"),window.WCDashiData=WCDashiData;var WCLevelData=function(){function t(t){this.id=1,this.level=0,this.id=t}return t.prototype.getConfig=function(){return this.config||(this.config=Cfg.getConfig(WCLevelConfig,this.id))},t.prototype.getAttrData=function(t){return void 0===t&&(t=this.level),t>this.getMaxLv()&&(t=this.getMaxLv()),AttrData.attrMultiple(this.getConfig().addattr,t)},t.prototype.getPower=function(){return GFunc.getPower(this.getAttrData())>>0},Object.defineProperty(t.prototype,"canAct",{get:function(){return 0==this.level?GFunc.getItemCount(this.getConfig().needitem.id)>=this.getConfig().needitem.count:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canUp",{get:function(){return this.isMax()?!1:GFunc.getItemCount(this.getConfig().needitem.id)>=this.getConfig().needitem.count},enumerable:!0,configurable:!0}),t.prototype.isMax=function(){return this.level>=this.getMaxLv()},t.prototype.getMaxLv=function(){return this.getConfig().maxLevel},t}();__reflect(WCLevelData.prototype,"WCLevelData"),window.WCLevelData=WCLevelData;var WCStageData=function(){function t(){this.level=0}return t.prototype.getCurConfig=function(){return this.curConfig&&this.curConfig.level==this.level||(this.curConfig=Cfg.getConfig(WCStageConfig,this.level)),this.curConfig},t.prototype.getNextConfig=function(){return(!this.nextConfig||this.nextConfig.level<=this.level)&&(this.nextConfig=Cfg.getNextConfig(WCStageConfig,this.level)),this.nextConfig},t.prototype.getShowJ=function(){return Math.floor(this.level/Cfg.getConfig(WCCommonConfig).starPerLevel)+1},t.prototype.getShowX=function(){return this.level%Cfg.getConfig(WCCommonConfig).starPerLevel},t.prototype.getPower=function(){return GFunc.getPower(this.getCurConfig().addattr)>>0},t.prototype.canUp=function(){return this.isMax()?!1:GFunc.getItemCount(this.getCurConfig().needitem.id)>=this.getCurConfig().needitem.count},t.prototype.isMax=function(){return this.level>=Cfg.getMaxConfig(WCStageConfig).level},t.prototype.getStageName=function(){var t=Cfg.getConfig(WCCommonConfig).stageNames;return t[this.getShowJ()-1]},t}();__reflect(WCStageData.prototype,"WCStageData"),window.WCStageData=WCStageData;var WCLevelItem=function(t){function e(){var e=t.call(this)||this;return e.strokeColors=[0,0,43263,16122111,8465920,16711680],e.skinName="WCLevelItemEUI",e.groupMC.mask=e.imgMask,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof WCLevelData){this.entity||(this.entity=new MC,this.groupMC.addChild(this.entity));var t=this.data.getConfig(),e=Cfg.getConfig(MonsterModelConfig,t.apperence);this.entity.scaleX=this.entity.scaleY=t.scale/100;var i=ResMgr.getEntityBodyRes(EntityType.MONSTER_SERVER,e.appearance,4,EntityAction.STAND);this.entity.playFile(i,-1),this.groupMC.y=191-this.data.getConfig().modelHeight,this.imgBg.source="msbd_zycs_wk"+this.data.getConfig().quality,this.lbName.text=""+this.data.getConfig().name,this.lbName.strokeColor=this.strokeColors[this.data.getConfig().quality],this.lbLevel.text="Lv."+this.data.level,this.lbLevel.strokeColor=this.strokeColors[this.data.getConfig().quality],this.groupWjh.visible=0==this.data.level,this.updateRadPoint()}},e.prototype.updateRadPoint=function(){this.data instanceof WCLevelData&&(this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,WCLevelPanel,this.data.getConfig().type,this.data.id))},e}(BaseItemRender);__reflect(WCLevelItem.prototype,"WCLevelItem"),window.WCLevelItem=WCLevelItem;var WCLevelTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="WCLevelTabItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.type){var t=this.data;this.imgBg.source="msbd_zycs_dt"+t.type,this.imgName.source="msbd_zycs_id"+t.type,this.updateRadPoint()}},e.prototype.updateRadPoint=function(){var t=this.data;this.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,WCLevelPanel,t.type)},e}(BaseItemRender);__reflect(WCLevelTabItem.prototype,"WCLevelTabItem"),window.WCLevelTabItem=WCLevelTabItem;var WCLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.tabIndex=1,e.tabDatas=[],e.datas=[],e.skinName="WCLevelPanelEUI",e.list.itemRenderer=WCLevelItem,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.tab.itemRenderer=WCLevelTabItem,e.tab.dataProvider=e.tabData=new eui.ArrayCollection,e.btnAttr.textFlow=addColorTF(StrUtil.addUnderLine(Lang.common_str116),5767068),e.btnAttr.visible=!1,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addItemTapE(this.list,this.onList),this.addItemTapE(this.tab,this.onTab),this.addClickE(this.btnAttr,this.onClickCommon),this.addClickE(this.comDaShi,this.onClickCommon),this.addLsn(WCSys.ins().patchLevelUp,this.updatePanel),this.addLsn(WCSys.ins().patchDashiUp,this.updatePanel),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updateRp=function(t){if(!t||t.check(this)){this.comDaShi.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,e,this.tabIndex+1,WCDashiWin),this.list.validateNow();for(var i=0;i<this.list.numChildren;i++){var n=this.list.getChildAt(i);n.updateRadPoint()}this.tab.validateNow();for(var a=0;a<this.tab.numChildren;a++){var o=this.tab.getChildAt(a);o.updateRadPoint()}}},e.prototype.infoPanel=function(){this.tabData.source=this.tabDatas=Cfg.getConfigs(WCQualityConfig),this.updateDefSelect(),this.updatePanel(),this.updateRp()},e.prototype.updateDefSelect=function(){this.tabIndex=0;for(var t=0;t<this.tabDatas.length;t++){var i=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,e,this.tabDatas[t].type);if(i){this.tabIndex=t;break}}this.tab.selectedIndex=this.tabIndex},e.prototype.updatePanel=function(){var t=this.tabIndex+1;this.datas=WCSys.ins().getLevelDatasByType(t),this.dashiData=WCSys.ins().getDashiDataByType(t),this.currentState=this.dashiData.isMaxRank()?"max":"normal",this.validateNow();var e=WCSys.ins().getPowerByLevelDatas(this.datas)+this.dashiData.genPower();this.power.text=""+e,SortUtil.sortOn(this.datas,["canAct","canUp","level","id"],[SortType.down,SortType.down,SortType.down,SortType.up]),this.listData.source=this.datas;var i=WCSys.ins().getLevelCountByType(t,this.dashiData.getConfig().needlv);this.dashiData.isMaxRank()?this.comDaShi.setData(i,i):this.comDaShi.setData(i,this.dashiData.getConfig().neednumber);var n=Cfg.getConfig(WCQualityConfig,t);this.lbDaShi.text=n.name+"·"+this.dashiData.level+Lang.common_jie;var a=Lang.wc_str3+":"+this.dashiData.getAttrDec()+addColor(" +"+this.dashiData.getConfig().per/100+"%",5767068);this.dashiData.noActRank()&&(a=Lang.wc_str3+":"+this.dashiData.getAttrDec()+addColor(" "+Lang.xh_str9,5767068)),this.lbCuAttr.textFlow=addColorTF(a);var o=addColor("("+i+"/"+this.dashiData.getConfig().neednumber+")",i<this.dashiData.getConfig().neednumber?16658994:5767068);a=Lang.foot_str2+":"+this.dashiData.getDec()+this.dashiData.getConfig().needlv+" "+o,this.lbNextNeed.textFlow=addColorTF(a);var s=Cfg.getNextConfig(WCDashiConfig,t,this.dashiData.level);a=""+this.dashiData.getAttrDec()+(" +"+s.per/100+"%")+addColor("("+Lang.common_str24+")",16658994),this.lbNextAttr.textFlow=addColorTF(a)},e.prototype.onList=function(t){var e=t.item;openWin(WCLevelTipsWin,e)},e.prototype.onTab=function(t){this.tabIndex!=t.itemIndex&&(this.tabIndex=t.itemIndex,this.list.scrollV=0,this.updatePanel(),this.updateRp())},e.prototype.onClickCommon=function(t){switch(t.currentTarget){case this.btnAttr:openWin(ComAttrWin,WCSys.ins().getLevelDatasAll(this.datas));break;case this.comDaShi:openWin(WCDashiWin,this.dashiData)}},e.getTitle=function(){return"btz_zycs_msbd"},e.getTabTitle=function(){return"宝 典"},e.getSysId=function(){return SysId.WC},e}(BasePanel);__reflect(WCLevelPanel.prototype,"WCLevelPanel"),window.WCLevelPanel=WCLevelPanel;var WCPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel,MoJieWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[WCLevelPanel,WCStagePanel]},enumerable:!0,configurable:!0}),e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.setSkinName=function(){this.skinName="WCPanelEUI"},e.getTitle=function(){return"btz_zycs_msbd"},e.getTabTitle=function(){return"bqz_zycs_msbd"},e.getSysId=function(){return SysId.WC},e}(BaseTabPanel);__reflect(WCPanel.prototype,"WCPanel"),window.WCPanel=WCPanel;var WCStagePanel=function(t){function e(){var e=t.call(this)||this;return e.longPressBtnUp=new LongPress,e.skinName="WCStagePanelEUI",e.starExp=new Star(StarData.F_5()),e.starExp.x=30,e.groupStar.addChild(e.starExp),e.starExp.setMaxStar(10),e.lbAddLv.visible=!1,e.mc=new MC,e.groupMC.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnSend,this.onClickCommon),this.longPressBtnUp.setDisplay(this.btnSend,this.autoUp,this),this.addLsn(WCSys.ins().patchStageUp,this.updatePanel),this.addLsn(BagSys.ins().patchItemChange,this.updateItem),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this),this.starExp.reset()},e.prototype.updateRp=function(t){(!t||t.check(this))&&(this.btnSend.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,WCPanel,e))},e.prototype.autoUp=function(){GFunc.checkConsumeEnough(this.data.getCurConfig().needitem)?WCSys.ins().sendStageUp():this.longPressBtnUp.stop()},e.prototype.infoPanel=function(){this.data=WCSys.ins().stageData,this.updatePanel(),this.updateRp()},e.prototype.updatePanel=function(){this.data.isMax()?this.currentState="max":this.currentState="normal",this.validateNow(),this.power.text=""+this.data.getPower();var t=this.data.getShowJ(),e="sh"+t+"_zycs";if(!~this.mc.name.indexOf(e)){this.mc.playFile(getEffName(e),-1);var i=Cfg.getConfig(WCCommonConfig).offsetX[t-1];this.groupMC.x=360+(i?i:0)}this.imgName.text=this.data.getStageName(),this.starExp.setCurStar(this.data.getShowX()),this.lbAddLv.text=Lang.wc_str1+"：+"+this.data.level;var n=this.data.getCurConfig(),a=AttrData.parse(n.addattr,{fm:AttrData.getFm(null,null,"：")}).join("\n");a=a+"\n"+addColor(Lang.wc_str2+"："+n.per/100+"%",5767068),this.lbCurAttr.textFlow=addColorTF(a);var o=this.data.getNextConfig();a=AttrData.parse(o.addattr,{fm:"%v"}).join("\n"),n.per!=o.per&&(a=a+"\n"+o.per/100+"%"),this.lbNextAttr.textFlow=addColorTF(a),this.updateItem();var s=this.data.getNextConfig().addattr.length+(n.per!=o.per?1:0);if(this.groupAttrUpIcon.numChildren!=s){this.groupAttrUpIcon.removeChildren();for(var r=0;s>r;r++){var u=new eui.Image;u.source="public_zycs_lj",this.groupAttrUpIcon.addChild(u)}}},e.prototype.updateItem=function(){if(!this.data.isMax()){var t=GFunc.getItemCount(this.data.getCurConfig().needitem.id),e=this.data.getCurConfig().needitem.count,i=Cfg.getItemCfg(this.data.getCurConfig().needitem.id).getName()+"：";i+=addColor(t+"/"+e,e>t?16729670:5767068),this.lbConsumeCount.textFlow=addColorTF("消耗"+i)}},e.prototype.onClickCommon=function(t){switch(t.currentTarget){case this.btnSend:GFunc.checkConsumeEnough(this.data.getCurConfig().needitem)&&WCSys.ins().sendStageUp()}},e.getTitle=function(){return"btz_zycs_msbd"},e.getTabTitle=function(){return"兽 魂"},e.getSysId=function(){return SysId.WC},e}(BasePanel);__reflect(WCStagePanel.prototype,"WCStagePanel"),window.WCStagePanel=WCStagePanel;var GuaJiHelpWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="GuaJiHelpWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.updatePanel()},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.lbHelpAll,this.onClick),this.addClickE(this.lbHelpGuild,this.onClick)},e.prototype.updatePanel=function(){this.lbHelpAll.textFlow=addColorTF(StrUtil.addUnderLine(Lang.gj_str5),1176860),this.lbHelpGuild.textFlow=addColorTF(StrUtil.addUnderLine(Lang.gj_str6),1176860);var t=FbSys.ins().guajiData.getHelpCount(),e=Lang.gj_str7+addColor(t+"/"+Cfg.getGuajiConstConfig().dailyreqcount,t?1176860:16711680);this.lbHelp.textFlow=addColorTF(e),t=FbSys.ins().guajiData.getAssistCount(),e=Lang.gj_str8+addColor(t+"/"+Cfg.getGuajiConstConfig().dailyhelpcount,t?1176860:16711680),this.lbAssist.textFlow=addColorTF(e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.lbHelpAll:FbSys.ins().guajiData.getHelpCount()?(FbSys.ins().sendGuaJiHelp(2),showtipsSuc(Lang.gj_str28)):showtipsFail(Lang.gj_str26),FbSys.ins().guajiData.updateHelpCD(),closeWin(e);break;case this.lbHelpGuild:if(!GuildSys.ins().isAddGuild())return void showtipsFail(Lang.guild_str117);FbSys.ins().guajiData.getHelpCount()?(FbSys.ins().sendGuaJiHelp(1),showtipsSuc(Lang.gj_str28)):showtipsFail(Lang.gj_str26),FbSys.ins().guajiData.updateHelpCD(),closeWin(e)
}},e}(BaseWinSingle);__reflect(GuaJiHelpWin.prototype,"GuaJiHelpWin"),window.GuaJiHelpWin=GuaJiHelpWin;var GuaJiKuaiSuWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="GuaJiKuaiSuWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.setSkinPart("price",new PriceIcon),this.price.setType(CurType.yb),this.price.scaleX=0,this.price.visible=!1,this.list.itemRenderer=ItemBaseRewardName,this.list.dataProvider=this.listData=new eui.ArrayCollection,this.group1.visible=!urlParam.isShenhe},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnYueka,this.onClick),this.addClickE(this.btnZhiZun,this.onClick),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnAdd,this.onClick),this.addLsn(FbSys.ins().patchGuaJiKsgjUp,this.updateReward),this.addLsn(FbSys.ins().patchGuaJiKsgjBuy,this.updatePanel),this.addLsn(FbSys.ins().patchGuaJiKsgjBuy,this.updatePanel),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.updatePanel(),this.updateRp(),FbSys.ins().sendGuaJiKsgj(1)},e.prototype.updateRp=function(t){(!t||t.check(GuaJiPanel))&&(this.btnSend.redPoint.visible=RpSys.ins().getData(GuanJiWin,GuaJiPanel,e))},e.prototype.updateReward=function(t,e){1==t&&(this.listData.source=e),this.updatePanel()},e.prototype.updatePanel=function(){this.dataModel=FbSys.ins().guajiData;var t=ActSys.ins().getActDataById(ActId.ID_99900);this.btnYueka.filters=t.isInYueKaTime()?[]:DisUtil.grayFilter(),this.lbYueka.visible=!t.isInYueKaTime();var e=ActSys.ins().getActDataById(ActId.ID_99500);this.btnZhiZun.filters=e.isAct()?[]:DisUtil.grayFilter(),this.lbZhuZun.visible=!e.isAct();var i=this.dataModel.getKsgjSdConsume();i>0?(this.lbPrice.text=Lang.gj_str23,this.lbPrice.textColor=5767068,this.price.scaleX=1,this.price.visible=!0,this.price.setPrice(i)):(this.lbPrice.text=Lang.gj_str22,this.lbPrice.textColor=1176860,this.price.scaleX=0,this.price.visible=!1);var n=this.dataModel.getKsgjSdCount(),a=Cfg.getGuajiConstConfig().quickCount,o=Lang.gj_str9+addColor(n+"/"+a,n>0?1176860:16711680);this.lbCount.textFlow=addColorTF(o)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnYueka:openWin(YKWin),closeWin(e);break;case this.btnZhiZun:openWin(ZZTQWin),closeWin(e);break;case this.btnSend:if(this.dataModel.getKsgjSdCount()<=0)return void showtipsFail(Lang.fb_str61);if(!GFunc.isCurrency(CurType.yb,this.dataModel.getKsgjSdConsume()))return void showtipsFail(Lang.damon_str35);FbSys.ins().sendGuaJiKsgj(2);break;case this.btnAdd:if(0==this.dataModel.getKsgjBuyCount())return void openWin(SVipTipsWin,SysId.GuaJi);var i=GFunc.creatRewardDataById(CurType.yb,this.dataModel.getKsgjBuyConsume()),n=new PopupPriceData(Lang.gj_str25);n.priceValue=i.count,n.priceType=i.id,n.setFunction(this,function(){GFunc.checkConsumeEnough(i)&&FbSys.ins().sendGuaJiKsgjBuy()}),openWin(CommonTipsWinNew,n)}},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return GFunc.checkSysOpen(SysId.KSZD)},e}(BaseWinSingle);__reflect(GuaJiKuaiSuWin.prototype,"GuaJiKuaiSuWin"),window.GuaJiKuaiSuWin=GuaJiKuaiSuWin;var GuaJiRankWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="GuaJiRankWinEUI"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.layer=LayerMgr.Popup,this.addBg(),this.list.itemRenderer=GuaJiRankItem,this.list.dataProvider=this.listData=new eui.ArrayCollection},e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RankSys.ins().patchRankData,this.updatePanel),this.updatePanel()},e.prototype.updatePanel=function(){var t=RankSys.ins().getRankData(RankType.GuaJi);this.listData.source=t.getFullDatalist(),this.lbRank.text=""+(t.myRank>0?t.myRank:Lang.common_str17),this.lbGuan.text=FbSys.ins().guajiData.guanId+Lang.common_ceng},e}(BaseWinSingle);__reflect(GuaJiRankWin.prototype,"GuaJiRankWin"),window.GuaJiRankWin=GuaJiRankWin;var GuanJiWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[GuaJiPanel]},enumerable:!0,configurable:!0}),e.prototype.getBtnSend=function(){return this.getPanel(GuaJiPanel).getBtnSend()},e.prototype.getImgTouch=function(){return this.getPanel(GuaJiPanel).getImgTouch()},e}(BaseWinAutoTab);__reflect(GuanJiWin.prototype,"GuanJiWin"),window.GuanJiWin=GuanJiWin;var VipGuaJiBuyWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.btnOk.label=Lang.ml_str4,this.groupBuy.visible=!0},e.prototype.updatePanel=function(e){t.prototype.updatePanel.call(this,e),this.dataModel=FbSys.ins().guajiData,this.price.setPrice(this.dataModel.getKsgjBuyConsume()),this.lbCount.text=Lang.fb_str125+this.dataModel.ksgjBuyCount+"/"+this.dataModel.getKsgjSdCountAll()},e.prototype.onTap=function(t){GFunc.isCurrency(CurType.yb,this.dataModel.getKsgjBuyConsume())?(FbSys.ins().sendGuaJiKsgjBuy(),closeWin(e)):showtipsFail(Lang.damon_str35)},e}(SVipTipsWin);__reflect(VipGuaJiBuyWin.prototype,"VipGuaJiBuyWin"),window.VipGuaJiBuyWin=VipGuaJiBuyWin;var WorldMapExpEfficiencyWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.NeverCloseWin,e.layer=LayerMgr.Main_Down,e.skinName="WorldMapExpEfficiencyWinEUI",e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.closeFun=e,this.updatePanel()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updatePanel=function(){var t=Cfg.getConfig(GuajiFubenConfig,FbSys.ins().guajiData.challengeGuanId),e=Cfg.getConfig(GuajiFubenConfig,FbSys.ins().guajiData.challengeGuanId-1);this.lastTxt.text=GFunc.overLength(e.exp,e.exp<1e8?1:2)+"/"+Lang.common_xs,this.currTxt.text=GFunc.overLength(t.exp,t.exp<1e8?1:2)+"/"+Lang.common_xs,this.lastTxt0.text=GFunc.overLength(e.gold,e.gold<1e8?1:2)+"/"+Lang.common_xs,this.currTxt0.text=GFunc.overLength(t.gold,t.gold<1e8?1:2)+"/"+Lang.common_xs,this.scaleX=1,this.scaleY=1,this.alpha=0;var i=egret.Tween.get(this);i.wait(200).to({alpha:1},500).wait(2e3).call(this.flyEff,this)},e.prototype.flyEff=function(){closeWin(this),this.closeFun()},e}(BaseWinSingle);__reflect(WorldMapExpEfficiencyWin.prototype,"WorldMapExpEfficiencyWin"),window.WorldMapExpEfficiencyWin=WorldMapExpEfficiencyWin;var GuaJiMaxData=function(){function t(t){this.state=0,this.config=t}return Object.defineProperty(t.prototype,"id",{get:function(){return this.config.group},enumerable:!0,configurable:!0}),t.prototype.getDes=function(){var t="";return 0==this.state?t=addColor(this.config.custom+Lang.gj_str2,15437326):1==this.state?t=addColor(Lang.common_str58,15437326):2==this.state&&(t=addColor(Lang.gj_str3,15794098)),t},t}();__reflect(GuaJiMaxData.prototype,"GuaJiMaxData"),window.GuaJiMaxData=GuaJiMaxData;var WorldMapTabData=function(){function t(){this.mapGroup=1,this.config=null,this.state=0}return t}();__reflect(WorldMapTabData.prototype,"WorldMapTabData"),window.WorldMapTabData=WorldMapTabData;var GuaJiBtnPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuaJiBtnPanelEUI",e}return __extends(e,t),e.prototype.addDisplay=function(){this.mc=this.mc||new MC,this.mc.playFile(getEffName("tzbs"),-1),this.groupMC.addChild(this.mc),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnAuto,this.onClick),this.addLsn(FbSys.ins().patchGuaJiInfo,this.updateBoCount),this.addLsn(FbSys.ins().patchGuaJiChallenge,this.updateGuan),this.addLsn(FbSys.ins().patchGuaJiHelp,this.updateGuan),this.addLsn(FbSys.ins().patchGuaJiBoCount,this.updateBoCount),this.addLsn(FbSys.ins().patchGuaJiAutoChallenge,this.updateBtnAuto),this.addLsn(BagSys.ins().patchBagVolChange,this.updateBagMax),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.infoPanel()},e.prototype.updateRp=function(t){(!t||t.check(GuanJiWin))&&(this.redPoint.visible=RpSys.ins().getData(GuanJiWin,GuaJiPanel))},e.prototype.infoPanel=function(){this.dataModel=FbSys.ins().guajiData,this.updateGuan(),this.updateBoCount(),this.updateBtnAuto(),this.updateBagMax(),this.updateRp()},e.prototype.updateGuan=function(){this.lbAssist.text=Lang.gj_str10.replace("$count$",""+this.dataModel.challengeGuanId),this.btnAuto.visible=this.dataModel.guanId>=Cfg.getGuajiConstConfig().autochallenge},e.prototype.updateBoCount=function(){this.barBo.maximum=this.dataModel.getConfig().waves,this.barBo.value=this.dataModel.boCount,this.groupMC.visible=this.dataModel.boCount>=this.dataModel.getConfig().waves},e.prototype.updateBtnAuto=function(){var t=this.dataModel.isAutoChallenge;this.btnAuto.icon=t?"mianui_zycs_qxzd":"mianui_zycs_zdtz"},e.prototype.updateBagMax=function(){var t=0==BagSys.ins().getSurplusCount();t&&FbSys.ins().sendGuaJiAutoChallenge(!1)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnSend:if(this.dataModel.isTongGuan())return void showtipsFail(Lang.gj_str29);openWin(GuanJiWin);break;case this.btnAuto:if(this.dataModel.isTongGuan())return void showtipsFail(Lang.gj_str29);if(this.dataModel.guanId<Cfg.getGuajiConstConfig().autochallenge)return void showtipsFail(Lang.gj_str19.replace("$count$",""+Cfg.getGuajiConstConfig().autochallenge));var e=this.dataModel.isAutoChallenge;FbSys.ins().sendGuaJiAutoChallenge(!e)}},e}(BasePanel);__reflect(GuaJiBtnPanel.prototype,"GuaJiBtnPanel"),window.GuaJiBtnPanel=GuaJiBtnPanel;var GuaJiPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuaJiPanelEUI",e.listRank.itemRenderer=GuaJiPanelItem,e.listRank.dataProvider=e.listRankData=new eui.ArrayCollection,e.listReward.itemRenderer=ItemBaseReward,e.listReward.dataProvider=e.listRewardData=new eui.ArrayCollection,e.list.itemRenderer=ItemBaseRewardName,e.list.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btnKsgj,this.onClick),this.addClickE(this.imgTouch,this.onClick),this.addClickE(this.btnRank,this.onClick),this.addClickE(this.btnSend,this.onClick),this.addClickE(this.btnHelp,this.onClick),this.addLsn(FbSys.ins().patchGuaJiInfo,this.updatePanel),this.addLsn(FbSys.ins().patchGuaJiReward,this.updateMaxGuan),this.addLsn(FbSys.ins().patchGuaJiBoCount,this.updateBoCount),this.addLsn(RankSys.ins().patchRankData,this.uodateRank),this.addLsn(RpSys.ins().patchRp,this.updateRp),RankSys.ins().sendGetRankData(RankType.GuaJi),this.infoPanel()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.updateRp=function(t){(!t||t.check(e))&&(this.btnSend.redPoint.visible=RpSys.ins().getData(GuanJiWin,e,"tz"),this.redPointReward.visible=RpSys.ins().getData(GuanJiWin,e,"reward"),this.btnKsgj.redPoint.visible=RpSys.ins().getData(GuanJiWin,e,GuaJiKuaiSuWin))},e.prototype.infoPanel=function(){this.dataModel=FbSys.ins().guajiData,this.updatePanel(),this.updateRp()},e.prototype.updatePanel=function(){this.bmpGuan.text=Lang.replaceEnum(LangEnum.guan,this.dataModel.challengeGuanId);var t;t=this.dataModel.isTongGuan()?this.dataModel.getConfig():Cfg.getGuajiFubenConfigById(this.dataModel.challengeGuanId+1),this.lbGold.text=GFunc.overLength(t.gold,t.gold<1e8?1:2)+"/"+Lang.common_xs,this.lbExp.text=GFunc.overLength(t.exp,t.exp<1e8?1:2)+"/"+Lang.common_xs,this.listData.source=t.rewards,this.updateMaxGuan(),this.updateBoCount()},e.prototype.updateMaxGuan=function(){this.guaJiMaxData=this.dataModel.getGuaJiMaxData(),this.imgTouch.visible=2==this.guaJiMaxData.state,this.listRewardData.source=this.guaJiMaxData.config.rewards,this.lbGuan.textFlow=addColorTF(this.guaJiMaxData.getDes())},e.prototype.updateBoCount=function(){var t=this.dataModel.getConfig().waves;this.dataModel.boCount<t?(this.barBo.maximum=t,this.barBo.value=this.dataModel.boCount,this.lbBoCount.text=Lang.gj_str4.replace("$count$",""+Math.max(t-this.dataModel.boCount,0)),this.barBo.visible=this.lbBoCount.visible=!0,this.btnSend.visible=!1):(this.barBo.visible=this.lbBoCount.visible=!1,this.btnSend.visible=!0)},e.prototype.uodateRank=function(){var t=RankSys.ins().getRankData(RankType.GuaJi);this.listRankData.source=t.getFullDatalist().slice(0,3)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnKsgj:openWin(GuaJiKuaiSuWin);break;case this.imgTouch:FbSys.ins().sendGuaJiReward(this.guaJiMaxData.id);break;case this.btnRank:openWin(GuaJiRankWin);break;case this.btnSend:if(!GFunc.checkGotoFuben())return void closeWin(GuanJiWin);BagSys.ins().checkBagVolumn()&&(GFunc.isInCity()&&LogicSys.ins().sendEnterFb(FbSys.ins().guajiFbId),FbSys.ins().sendGuaJiChallenge(),closeWin(GuanJiWin));break;case this.btnHelp:if(!GFunc.checkGotoFuben())return;if(!this.dataModel.isChallenge()){var e=Math.max(this.dataModel.getConfig().waves-this.dataModel.boCount,0);return void showtipsFail(Lang.gj_str27.replace("$count$",""+e))}var i=this.dataModel.getHelpCD();if(i>0)return void showtipsFail(Lang.gj_str20.replace("$count$",""+i));openWin(GuaJiHelpWin)}},e.getTitle=function(){return"btz_zycs_cg"},e.getTabTitle=function(){return"bqz_zycs_cg"},e.getSysId=function(){return SysId.GuaJi},e.prototype.getBtnSend=function(){return this.btnSend},e.prototype.getImgTouch=function(){return this.imgTouch},e}(BasePanel);__reflect(GuaJiPanel.prototype,"GuaJiPanel"),window.GuaJiPanel=GuaJiPanel;var GuaJiPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuaJiPanelItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof RankDataGuaJi){var t=this.data.rank+"."+this.data.playerName+" "+addColor(this.data.guan+Lang.common_ceng,16777215);this.lbName.textFlow=addColorTF(t)}},e}(BaseItemRender);__reflect(GuaJiPanelItem.prototype,"GuaJiPanelItem"),window.GuaJiPanelItem=GuaJiPanelItem;var GuaJiRankItem=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.skinName="GuaJiRankItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.rank<=3?this.currentState="max":this.currentState="min",this.validateNow(),t.rank<=3?(this.imgBg.source="cg_zycs_di"+t.rank,this.imgRank.source="jjc_zycs_no"+t.rank,this.imgRank.visible=!0,this.labelRank.visible=!1):(this.imgRank.visible=!1,this.labelRank.visible=!0,this.labelRank.text=t.rank.toString()),this.labelName.text=t.playerName,this.lbGuan.text=""+t.guan,this.imgVip.visible=t.vipLv>0||t.svipLv>0,this.imgVip.source=t.svipLv>0?"phb_zycs_V":"phb_zycs_V1"},e}(BaseItemRender);__reflect(GuaJiRankItem.prototype,"GuaJiRankItem"),window.GuaJiRankItem=GuaJiRankItem;var XianLuSys=function(t){function e(){var e=t.call(this)||this;return e.qmLv=0,e.qmExp=0,e.jieyuanType=0,e.xianLuName="",e.downTime=0,e.jieyuanTime=0,e.rewardLv=0,e.rangList=[],e.otherSex=1,e.dayTaskList=[],e.longTaskList=[],e.xianYuanList=[],e.isSendJieyuan=!1,e.hadHongBao=!1,e.tempType=0,e.isSearch=!1,e.tabIndex=0,e.sysId=PackId.Xianlu,e.reg(1,e.updateMyXianyuan),e.reg(2,e.updateXianyuanList),e.reg(3,e.updateJieyuanError),e.reg(5,e.updateXianyuanInfo),e.reg(8,e.updateXianyuanTaskInfo),e.reg(30,e.updateXianyuanHBInfo),e.reg(31,e.openXianyuanHBInfo),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},Object.defineProperty(e.prototype,"totalPower",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.isJieYuan=function(){return this.jieyuanType>0},e.prototype.getImgStr=function(){var t="",e=Actor.ins().sex;return 0==e&&0==this.otherSex?t="xianlu_img_yjy3":0==e&&1==this.otherSex?t="xianlu_img_yjy":1==e&&0==this.otherSex?t="xianlu_img_yjy1":1==e&&1==this.otherSex&&(t="xianlu_img_yjy2"),t},e.prototype.QMDIsMax=function(){return this.qmLv>=Cfg.getXianluQMDMaxLv()},e.prototype.isOnline=function(){return this.downTime<=0},e.prototype.sendReleaseXianyuan=function(t,e,i,n){void 0===n&&(n="");var a=this.getBytes(1);a.writeByte(t);var o=e.length;a.writeByte(o);for(var s=0;o>s;s++)a.writeShort(e[s]);a.writeByte(i),a.writeString(n),this.send(a)},e.prototype.updateMyXianyuan=function(t){for(var e=new XianYuanData(t),i=0;i<this.xianYuanList.length;i++)if(this.xianYuanList[i].actorId==e.actorId){this.xianYuanList.splice(i,1);break}this.xianYuanList.unshift(e),showtipsSuc("发布成功")},e.prototype.sendXianyuanList=function(t,e,i){void 0===i&&(i=100);var n=this.getBytes(2);n.writeByte(t);var a=e.length;n.writeByte(a);for(var o=0;a>o;o++)n.writeShort(e[o]);n.writeByte(i),this.send(n),this.tempType=t},e.prototype.updateXianyuanList=function(t){var e=t.readByte();if(this.isSearch){if(e>0){this.xianYuanList=[];for(var i=0;e>i;i++)this.xianYuanList.push(new XianYuanData(t))}else showtipsFail("搜索对象未发布仙缘信息");this.isSearch=!1}else{this.xianYuanList=[];for(var i=0;e>i;i++)this.xianYuanList.push(new XianYuanData(t))}},e.prototype.sendRequestJieyuan=function(t,e){var i=this.getBytes(3);i.writeInt(t),i.writeInt(e),this.send(i),this.isSendJieyuan=!0},e.prototype.updateJieyuanError=function(t){var e=t.readByte();1==e&&(showtipsFail("对方已结缘"),this.sendXianyuanList(this.tempType,[]))},e.prototype.sendDissolutionJieyuan=function(){this.sendBase(4)},e.prototype.sendXianyuanInfo=function(){this.sendBase(5)},e.prototype.updateXianyuanInfo=function(t){this.ringId=t.readInt();var e=t.readByte();this.rangList=[];for(var i=0;e>i;i++)this.rangList.push(t.readInt());if(this.jieyuanType=t.readByte(),this.jieyuanType>0){this.qmLv=t.readShort(),this.qmExp=t.readInt(),this.xianLuName=t.readString(),this.otherSex=t.readByte(),this.downTime=t.readInt();var n=DateUtil.formatMiniDateTime(t.readInt());this.jieyuanTime=Actor.ins().serverTime-n>0?Actor.ins().serverTime-n:0,this.rewardLv=t.readShort()}this.isJieYuan()&&this.isSendJieyuan&&(showtipsSuc("恭喜您结缘成功"),closeWin(XianluJieYuanWin),closeWin(XianLuListWin),openWin(XianLuWin),this.isSendJieyuan=!1),RpFun.showXianluRp(),RpFun.showXianluTaskRp()},e.prototype.sendUpgradeQm=function(){this.sendBase(6)},e.prototype.sendGetReward=function(){this.sendBase(7)},e.prototype.sendTaskInfo=function(){this.sendBase(8)},e.prototype.updateXianyuanTaskInfo=function(t){var e=t.readByte();this.dayTaskList=[];for(var i=0;e>i;i++)this.dayTaskList.push(new XianluTaskData(t));this.longTaskList=[];for(var n=t.readByte(),i=0;n>i;i++)this.longTaskList.push(new XianluTaskData(t));RpFun.showXianluTaskRp()},e.prototype.sendUseRing=function(t){var e=this.getBytes(9);e.writeInt(t),this.send(e)},e.prototype.sendGetTaskReward=function(t,e){var i=this.getBytes(10);i.writeByte(t),i.writeInt(e),this.send(i)},e.prototype.sendSearch=function(t){this.isSearch=!0;var e=this.getBytes(11);e.writeString(t),this.send(e)},e.prototype.updateXianyuanHBInfo=function(t){var e=t.readByte();this.hadHongBao=1==e},e.prototype.sendOpenHongbao=function(){this.sendBase(31)},e.prototype.openXianyuanHBInfo=function(t){var e=t.readByte();if(1==e){var i=t.readByte();this.hadHongBao=1==i;var n=new XianYuanHongBaoData;n.parse(t),this.xyHongBaodata=n,2==this.xyHongBaodata.type&&openWin(XianluHBWin)}else this.hadHongBao=!1,showtipsFail("手慢了，红包派完了")},e.prototype.getSkills=function(){var t=[],e=Cfg.getConfigs(MateRingConfig);for(var i in e)t.push(e[i].skill);var n=SkillSys.ins().getSkillPassivityDatasByIds(t);return n},e.prototype.checkIsEdit=function(t){for(var e=Cfg.getConfigs(MateReqStrConfig),i=0,n=e;i<n.length;i++){var a=n[i];if(a.msg==t)return a.id}return 0},e.prototype.getCurrCg=function(){var t=Cfg.getConfig(MateLevelConfig),i=(e.ins().qmLv,e.ins().rewardLv);for(var n in t)if(t[n].lv>i&&t[n].award.length>0)return t[n];return null},e.prototype.ShowYdssRule=function(){if(!GFunc.isSysOpen(SysId.xianlu_ydss))return!1;if(!ActSys.ins().getBtnConfigs(ActOnPlace.YDSS).length)return!1;var t=ActSys.ins().getActDataById(2003);if(t)for(var e=0,i=t.buyDatas;e<i.length;e++){var n=i[e];if(0==n.count)return!0}var a=ActSys.ins().getActDataById(2002),o=a&&a.getActOpenState()==ActOpenState.Open;return o},__decorate([post()],e.prototype,"updateMyXianyuan",null),__decorate([post()],e.prototype,"updateXianyuanList",null),__decorate([post()],e.prototype,"updateXianyuanInfo",null),__decorate([post()],e.prototype,"updateXianyuanTaskInfo",null),__decorate([post()],e.prototype,"updateXianyuanHBInfo",null),__decorate([post()],e.prototype,"openXianyuanHBInfo",null),e}(BaseSys);__reflect(XianLuSys.prototype,"XianLuSys"),SystemMap.XianLuSys=XianLuSys.ins.bind(XianLuSys),window.XianLuSys=XianLuSys;var XianluTaskData=function(){function t(t){this.taskId=t.readShort();var e=t.readByte();0==e?this.taskState=1:1==e?this.taskState=2:2==e&&(this.taskState=0),this.selfValue=t.readInt(),this.herValue=t.readInt()}return t.prototype.getMateDailyQuestConfig=function(){var t=Cfg.getConfig(MateDailyQuestConfig,this.taskId);return t},t.prototype.getMateQuestConfig=function(){var t=Cfg.getConfig(MateQuestConfig,this.taskId);return t},t}();__reflect(XianluTaskData.prototype,"XianluTaskData"),window.XianluTaskData=XianluTaskData;var XianYuanData=function(){function t(t){this.sex=0,this.headFrameId=1,this.svipLv=t.readByte(),this.vipLv=t.readByte(),this.actorId=t.readInt(),this.sex=t.readByte(),this.headFrameId=t.readInt(),this.actorName=t.readString(),this.giftId=t.readByte();var e=t.readByte();this.labelIds=[];for(var i=0;e>i;i++)this.labelIds.push(t.readShort());this.str=t.readString()}return t.prototype.getGift=function(){var t=Cfg.getConfig(MateGiftConfig,this.giftId);return t.xianyu},t}();__reflect(XianYuanData.prototype,"XianYuanData"),window.XianYuanData=XianYuanData;var XianYuanHongBaoData=function(){function t(){}return t.prototype.parse=function(t){this.type=t.readByte();var e=t.readByte();this.rewards=[];for(var i=0;e>i;i++){var n=new ItemDataReward;n.parser(t),this.rewards.push(n)}2==this.type?(this.bondName1=t.readString(),this.bondName2=t.readString(),this.bondSex1=t.readByte(),this.bondSex2=t.readByte()):this.redPacketName=t.readString()},t}();__reflect(XianYuanHongBaoData.prototype,"XianYuanHongBaoData"),window.XianYuanHongBaoData=XianYuanHongBaoData;var XianluFenliWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluFenliWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btn_sure,this.onClick),this._currCg=Cfg.getConfig(MateCommonConfig),this.updatePanel()},e.prototype.updatePanel=function(){var t=XianLuSys.ins().jieyuanType,e=DateUtil.formatTime(XianLuSys.ins().jieyuanTime,"dd",!1),i=""==e?"1":parseInt(e+1).toString(),n=DateUtil.formatTime(1e3*this._currCg.dismissTime,"dd",!1),a=this._currCg.dismissCost[0].count;if(this.lb_tips.visible=this.group.visible=!1,1==t)this.lb_tips.visible=!0;else if(2==t){this.group.visible=!0;var o="结缘时长超过$1$天   "+addColor("($2$/$3$)",1071616),s=o.replace("$1$",n.toString()).replace("$2$",i.toString()).replace("$3$",n.toString());this.lb_cond.textFlow=addColorTF(s),o="支付$1$仙玉",this.lb_money.textFlow=addColorTF(o.replace("$1$",a.toString()))}},e.prototype.onClick=function(){var t,e=this,i=XianLuSys.ins().jieyuanTime,n="",a=this._currCg.dismissCost[0].count,o=XianLuSys.ins().xianLuName;return 1==XianLuSys.ins().jieyuanType?(XianLuSys.ins().sendDissolutionJieyuan(),closeWin(this),void showtipsFail("您与"+o+"分离成功")):void(i/1e3>=this._currCg.dismissTime?(n="是否确认与$name$分离",t=new PopupData(n.replace("$name$",o)),t.setFunction(this,function(){XianLuSys.ins().sendDissolutionJieyuan(),showtipsFail("您与"+o+"分离成功"),closeWin(e)}),openWin(CommonTipsWin,t)):(n="是否花费$money$仙玉与（$name$）分离？",t=new PopupData(n.replace("$money$",a.toString()).replace("$name$",o)),t.setFunction(this,function(){a>Actor.ins().getCurrency(CurType.yb)?showtipsFail(Lang.damon_str35):(XianLuSys.ins().sendDissolutionJieyuan(),closeWin(e),showtipsFail("您与"+o+"分离成功"))}),openWin(CommonTipsWin,t)))},e}(BaseWinSingle);__reflect(XianluFenliWin.prototype,"XianluFenliWin"),window.XianluFenliWin=XianluFenliWin;var XianluHBWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluHBWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.list.itemRenderer=ItemBaseReward,e.list.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.btn_sure,this.onClick),this.updatePanel()},e.prototype.updatePanel=function(){var t=XianLuSys.ins().xyHongBaodata;this.listData.source=t.rewards,this.headicon1.source=ResMgr.getHeadIcon(t.bondSex1),this.headicon2.source=ResMgr.getHeadIcon(t.bondSex2);var e=addColor(t.bondName1,16777215)+"和"+addColor(t.bondName2,16777215)+"\n互结仙缘激活义戒和信物，战力共同暴涨";this.lb_name.textFlow=addColorTF(e)},e.prototype.onClick=function(){closeWin(this)},e}(BaseWinSingle);__reflect(XianluHBWin.prototype,"XianluHBWin"),window.XianluHBWin=XianluHBWin;var XianluJieYuanWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluJieYuanWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.xyData=e,this.addClickE(this.btnSearch,this.onRequestJY),this.addClickE(this.item0,this.onTapRing),this.addLsn(XianLuRingWin.selectRing,this.updateRing),this.updateView()},e.prototype.onTapRing=function(){var t=this.getRingItem();if(!t.length){var e=GFunc.creatRewardDataById(830102,1);return void GFunc.checkConsumeEnough(e)}openWin(XianLuRingWin,t.reverse())},e.prototype.onRequestJY=function(){var t=this.item0.getData();if(!t)return void showtipsFail("戒指不足，无法结缘");var e=this.item1.data;GFunc.checkConsumeEnough1(e)&&XianLuSys.ins().sendRequestJieyuan(this.xyData.actorId,t.id)},e.prototype.updateRing=function(t){this.item0.setData(t)},e.prototype.updateView=function(){this.imgHead0.source=ResMgr.getHeadIcon(Actor.ins().sex),this.imgHead1.source=ResMgr.getHeadIcon(this.xyData.sex),this.lbName0.text=Actor.ins().myName,this.lbName1.text=this.xyData.actorName;var t=GFunc.creatRewardDataById(CurType.yb,this.xyData.getGift());this.item1.data=t;var e=this.getRingItem();this.item0.setData(e.length?e[e.length-1]:null)},e.prototype.getRingItem=function(){for(var t=Cfg.getConfigs(MateRingConfig),e=[],i=0,n=t;i<n.length;i++){var a=n[i],o=BagSys.ins().getItemById(a.id);o&&e.push(o)}return e},e}(BaseWinSingle);__reflect(XianluJieYuanWin.prototype,"XianluJieYuanWin"),window.XianluJieYuanWin=XianluJieYuanWin;var XianluPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluPanelEUI",e.lbway.textFlow=addColorTF(e.lbway.text,e.lbway.textColor,!0),e.skillList.itemRenderer=SkillPassivityItem,e.skillList.dataProvider=e.skillListdata=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick),this.addItemTapE(this.skillList,this.onSkillItem),this.addLsn(XianLuSys.ins().updateXianyuanInfo,this.updateView),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(BagSys.ins().patchItemChange,this.updateView),this.addLsn(SkillSys.ins().patchSkillPassivityUp,this.updateSkill),this.tempLv=XianLuSys.ins().qmLv,XianLuSys.ins().sendXianyuanInfo(),this.updateView(),this.updateRp()},e.prototype.updateSkill=function(){this.skillListdata.source=XianLuSys.ins().getSkills(),this.updatePower()},e.prototype.updatePower=function(){for(var t=0,e=XianLuSys.ins().getSkills(),i=0,n=e;i<n.length;i++){var a=n[i];t+=a.getPower()}var o=XianLuSys.ins().ringId,s=GFunc.creatRewardDataById(o),r=GFunc.getPower(s.config.pattr);t+=r,this.bmpLabelPower.text=""+t},e.prototype.updateConsume=function(){if(XianLuSys.ins().isJieYuan()){var t=Cfg.getConfig(MateCommonConfig).expItem,e=BagSys.ins().getItemCount(t),i=e?16770953:15733780,n=Cfg.getItemCfg(t);this.consumeIcon.source=ResMgr.getItemIcon(n.getIcon()),this.lbConsume.textFlow=addColorTF(addColor(e,i)+"/1")}},e.prototype.updateRp=function(){this.taskBtn.redPoint.visible=RpSys.ins().getData(XianLuWin,e,XianluTaskWin),this.rewardBtn.redPoint.visible=RpSys.ins().getData(XianLuWin,e,"canGet"),this.btnOnekey.redPoint.visible=RpSys.ins().getData(XianLuWin,e,"canUp")},e.prototype.updateView=function(){var t=XianLuSys.ins();this.validateNow(),this.updateSkill();var e="unmarried";t.isJieYuan()&&(e="married",t.QMDIsMax()&&(e="max"),this.updateMateView()),this.currentState=e},e.prototype.updateMateView=function(){var t=XianLuSys.ins(),e=Actor.ins().myName+addColor("    在线",5767068);this.lbname0.textFlow=addColorTF(e);var i=Math.floor(XianLuSys.ins().jieyuanTime/DateUtil.MS_PER_DAY)+1;this.lbDay.text="结缘"+i+"天";var n=t.xianLuName;if(0==t.downTime)n+=addColor("    在线",5767068);else{var a=(Actor.ins().serverTime-DateUtil.formatMiniDateTime(t.downTime))/1e3;n+=a>=DateUtil.SECOND_PER_DAY?StrUtil.addColor("  ("+getFormatTime(a,"dd天前",!1)+")",15733780):a>=DateUtil.SECOND_PER_HOUR?StrUtil.addColor("  ("+getFormatTime(a,"hh小时前",!1)+")",15733780):a>=DateUtil.SECOND_PER_MUNITE?StrUtil.addColor("  ("+getFormatTime(a,"mm分钟前",!1)+")",15733780):StrUtil.addColor("  (1分钟前)",15733780)}this.lbname1.textFlow=addColorTF(n),this.marriedImg.source=t.getImgStr(),this.lbLv.text="亲密度\nLv."+t.qmLv;var o=Cfg.getConfig(MateLevelConfig,t.qmLv);if(t.QMDIsMax())this.barExp.value=1,this.barExp.maximum=1,this.barExp.labelDisplay.visible=!1;else{if(this.barExp.slideDuration=500,t.qmLv>this.tempLv){this.tempLv=t.qmLv;var s=this.barExp.maximum;this.barExp.value=s,this.updateExp()}else this.barExp.value=t.qmExp,this.barExp.maximum=o.needExp;this.barExp.labelDisplay.visible=!0}this.updateConsume()},e.prototype.updateExp=function(){this.barExp.slideDuration=0;var t=XianLuSys.ins(),e=Cfg.getConfig(MateLevelConfig,t.qmLv);this.barExp.value=t.qmExp,this.barExp.maximum=e.needExp},e.prototype.onSkillItem=function(t){var e=t.item;return XianLuSys.ins().isJieYuan()?void openWin(SkillPassivityUpWin,e):void(e.level>0?showtipsFail("需要结缘后才可升级"):showtipsFail("需要结缘后才可激活"))},e.prototype.onClick=function(t){switch(t.target){case this.fenliBtn:openWin(XianluFenliWin);break;case this.listBtn:case this.btnSearch:openWin(XianLuListWin);break;case this.chatBtn:openWin(ChatWin,4),closeWin(XianLuWin);break;case this.taskBtn:openWin(XianluTaskWin);break;case this.btnOnekey:var e=Cfg.getConfig(MateCommonConfig).expItem,i=BagSys.ins().getItemCount(e);if(1>i)return void this.getGoodsWarn();XianLuSys.ins().sendUpgradeQm();break;case this.rewardBtn:openWin(XianluQmRewardWin);break;case this.lbway:this.getGoodsWarn()}},e.prototype.getGoodsWarn=function(){var t=Cfg.getConfig(MateCommonConfig).expItem;openWin(ShopGoodsWarn,t)},e.getSysId=function(){return SysId.xianlu},e.getTitle=function(){return"xianlu_title_xl"},e.getTabTitle=function(){return"bqz_zycs_xianlu"},__decorate([callDelay(400)],e.prototype,"updateExp",null),e}(BasePanel);__reflect(XianluPanel.prototype,"XianluPanel"),window.XianluPanel=XianluPanel;var XianluQmRewardWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluQmRewardWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.itemList.itemRenderer=ItemBaseRewardName,e.itemList.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.getRewardBtn,this.onClick),this.addLsn(XianLuSys.ins().updateXianyuanInfo,this.updatePanel),this.updatePanel()},e.prototype.updatePanel=function(){var t=XianLuSys.ins().getCurrCg(),e=XianLuSys.ins().qmLv;if(this.lb_tips.visible=this.getRewardBtn.visible=!1,t)this.listData.source=t.award,this.lb_title.text="亲密度Lv."+t.lv+"奖励",t.lv>e?(this.lb_tips.visible=!0,this.lb_tips.text="亲密度达到"+t.lv+"级可领取"):this.getRewardBtn.visible=!0;else{var i=XianLuSys.ins().rewardLv,n=Cfg.getConfig(MateLevelConfig,i);this.listData.source=n.award,this.lb_tips.visible=!0,this.lb_title.text="亲密度奖励",this.lb_tips.text="奖励已领完"}},e.prototype.onClick=function(){var t=XianLuSys.ins().getCurrCg(),e=XianLuSys.ins().qmLv;t.lv>e?closeWin(this):XianLuSys.ins().sendGetReward()},e}(BaseWinSingle);__reflect(XianluQmRewardWin.prototype,"XianluQmRewardWin"),window.XianluQmRewardWin=XianluQmRewardWin;var XianluReleaseWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="XianluReleaseWinEUI",this.addBg(),this.labelList=[this.item0,this.item1,this.item2,this.item3,this.item4,this.item5,this.item6,this.item7],this.pricelList=[this.pricel0,this.pricel1,this.pricel2],this.checkList=[this.check0,this.check1,this.check2]
},e.prototype.addDisplay=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addClickE(this,this.onClick),this.updateView(),this.updateLabelList()},e.prototype.updateLabelList=function(){for(var t=Cfg.getConfig(MateCommonConfig).labelList,e=this.labelList.length,i=0;e>i;i++)t[i]&&(this.labelList[i].data=t[i])},e.prototype.updateView=function(){for(var t=Cfg.getConfigs(MateGiftConfig),e=0;e<t.length;e++){var i=t[e];this.pricelList[e].setType(CurType.yb),this.pricelList[e].setPrice(i.xianyu)}this.checkList[0].selected=!0,this.strConf=MathUtil.randomArray(Cfg.getConfigs(MateReqStrConfig)),this.inputText.text=this.strConf.msg},e.prototype.onClick=function(t){var e=Cfg.getConfig(MateCommonConfig),i=XianLuSys.ins(),n=t.target;if(~this.labelList.indexOf(n))if(n.getSelect())n.setSelect(!1);else{for(var a=0,o=0;o<this.labelList.length;o++)this.labelList[o].getSelect()&&a++;a>=e.labellimit[1]?showtipsFail("最多可选中"+e.labellimit[1]+"个标签"):n.setSelect()}else{if(~this.checkList.indexOf(n)){for(var o=0;o<this.checkList.length;o++)this.checkList[o].selected=!1;n.selected=!0}switch(n){case this.btnOk:if(i.isJieYuan())return void showtipsFail("您已结缘，不可发布");for(var s=0,o=0;o<this.checkList.length;o++)if(this.checkList[o].selected){s=o+1;break}for(var r=[],o=0;o<this.labelList.length;o++)this.labelList[o].getSelect()&&r.push(o+1);var u=XianLuSys.ins().checkIsEdit(this.inputText.text);i.sendReleaseXianyuan(s,r,u,this.inputText.text),closeWin(this);break;case this.btnOk0:for(var o=0;o<this.labelList.length;o++)this.labelList[o].setSelect(!1);break;case this.inputText:var h=e.needSvip;h>Actor.ins().sVipLv?(urlParam.isShenhe||showtipsFail("SVIP"+h+"可编辑信息"),this.inputText.type=egret.TextFieldType.DYNAMIC):(this.inputText.maxChars=120,this.inputText.type=egret.TextFieldType.INPUT,this.inputText.setFocus())}}},e}(BaseWinSingle);__reflect(XianluReleaseWin.prototype,"XianluReleaseWin"),window.XianluReleaseWin=XianluReleaseWin;var XianluRingItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluRingItemEUI",e}return __extends(e,t),e.prototype.setData=function(t){this.currentState=t?"equip":"notEquip",this.item.data=t},e.prototype.getData=function(){return this.item.data},e}(BaseItemRender);__reflect(XianluRingItem.prototype,"XianluRingItem"),window.XianluRingItem=XianluRingItem;var XianluRingTipsItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluRingTipsItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.level>0?(this.lb_skillTips.textFlow=addColorTF(t.getConfig().name+addColor("Lv."+t.level+"："+t.getConfig().skinname,5767068)),this.filters=null):(this.lb_skillTips.text=t.getConfig().name+"Lv.0",this.filters=DisUtil.grayFilter()),this.skillIcon.source=ResMgr.getSkillPassivityItemName(this.data.id,this.data.level>0)},e}(BaseItemRender);__reflect(XianluRingTipsItem.prototype,"XianluRingTipsItem"),window.XianluRingTipsItem=XianluRingTipsItem;var XianluRingTipsWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluRingTipsWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.itemList.itemRenderer=XianluRingTipsItem,e.itemList.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.updatPanel(e)},e.prototype.updatPanel=function(t){var e,i;t?(this.currentState="jieyuan",e=Actor.ins().seePlayModel.xianluRingId,i=Actor.ins().seePlayModel.getSkills(),this.lb_name1.text=Actor.ins().seePlayModel.myName,this.lb_name2.text=Actor.ins().seePlayModel.xianLuName):(XianLuSys.ins().isJieYuan()?this.currentState="jieyuan":this.currentState="weijieyuan",e=XianLuSys.ins().ringId,i=XianLuSys.ins().getSkills(),this.lb_name1.text=Actor.ins().myName,this.lb_name2.text=XianLuSys.ins().xianLuName);var n=GFunc.creatRewardDataById(e);this.item.data=n,this.lb_name.text=n.config.getName();for(var a=n.config.pattr,o=AttrData.getFm(14216959,14216959,"","："),s=-28,r="",u=0;u<a.length;u++){var h=a[u].value;h>0&&(r+=AttrData.parse([a[u]],{fm:o}).join("\n")+"\n",s+=28)}this.lb_attrs.textFlow=addColorTF(r,14216959),SortUtil.sortOn(i,["isOpen","id"],[SortType.down,SortType.up]),this.listData.source=i;for(var p=GFunc.getPower(a),l=0,c=i;l<c.length;l++){var d=c[l];p+=d.getConfig().power}this.bmpLabelPower.text=p.toString()},e}(BaseWinSingle);__reflect(XianluRingTipsWin.prototype,"XianluRingTipsWin"),window.XianluRingTipsWin=XianluRingTipsWin;var XianLuRingWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianLuRingWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.itemList.itemRenderer=XianluRingWinItem,e.itemList.dataProvider=e.listArr=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addItemTapE(this.itemList,this.onListTap),this.addClickE(this.closeBtn1,this.onClose),this.listArr.source=t,this.updateView()},e.selectRing=function(t){return t},e.prototype.onClose=function(){closeWin(this)},e.prototype.onListTap=function(){e.selectRing(this.itemList.selectedItem),this.onClose()},e.prototype.updateView=function(){for(var t=Cfg.getConfigs(MateRingConfig),e=[],i=0,n=t;i<n.length;i++){var a=n[i],o=BagSys.ins().getItemById(a.id);o&&e.push(o)}this.listArr.source=e},__decorate([post()],e,"selectRing",null),e}(BaseWinSingle);__reflect(XianLuRingWin.prototype,"XianLuRingWin"),window.XianLuRingWin=XianLuRingWin;var XianluRingWinItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.item.data=t;var e=t.cfg;this.lbName.text=e.getName(),this.lbName.textColor=GConst.PZColor[e.quality]},e}(BaseItemRender);__reflect(XianluRingWinItem.prototype,"XianluRingWinItem"),window.XianluRingWinItem=XianluRingWinItem;var XianluSearchWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="XianluSearchWinEUI",this.layer=LayerMgr.Popup,this.addBg()},e.prototype.addDisplay=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initInputStr=this.inputText.text,this.addClickE(this.btnOk,this.onClick),this.addEvent(egret.FocusEvent.FOCUS_IN,this.inputText,this.onFocusIn)},e.prototype.onFocusIn=function(){this.initInputStr==this.inputText.text&&(this.inputText.text="")},e.prototype.onClick=function(){if(this.initInputStr!=this.inputText.text){var t=this.inputText.text,i=t.trim();i.length&&(XianLuSys.ins().sendSearch(t),closeWin(e))}},e}(BaseWinSingle);__reflect(XianluSearchWin.prototype,"XianluSearchWin"),window.XianluSearchWin=XianluSearchWin;var XianLuWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.MainWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XianluPanel]},enumerable:!0,configurable:!0}),e.prototype.setSkinName=function(){this.skinName="BaseWinSkin2"},e}(BaseDuoPanelWin);__reflect(XianLuWin.prototype,"XianLuWin"),window.XianLuWin=XianLuWin;var XianluTaskItem=function(t){function e(){var e=t.call(this)||this;return e.mcBtnOk=new MC,e.skinName="XianluTaskItemEUI",e.addClickE(e.btn_reward,e.onClick),e.addClickE(e.btnGoto,e.onClick),e.addClickE(e.btnGet,e.onClick),e.mcBtnOk.x=e.btnGet.width/2,e.mcBtnOk.y=e.btnGet.height/2,e.btnGet.addChild(e.mcBtnOk),e.mcBtnOk.playFile(ResMgr.getEffName("public_zycs_button01"),-1),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;switch(t.target){case this.btnGet:XianLuSys.ins().sendGetTaskReward(1,e.taskId);break;case this.btnGoto:var i=GFunc.createTaskNavData(e.getMateDailyQuestConfig().controlTarget);i.setsucceedFrontFun(function(){closeWin(JobWin)}),i["goto"]();break;case this.btn_reward:var n=e.getMateDailyQuestConfig();openWin(ComRewardTipsWin,n.reward)}},e.prototype.dataChanged=function(){var t=this.data,e=t.getMateDailyQuestConfig();this.lb_task.text=e.desc;var i=t.selfValue;this.lb_myNum.text="我的："+i;var n=i+t.herValue;1==e.mateType?this.proBar.value=n:2==e.mateType&&(this.proBar.value=i),this.proBar.maximum=e.target,this.lb_herNum.text="对方："+t.herValue,this.currentState=t.taskState.toString()},e}(BaseItemRender);__reflect(XianluTaskItem.prototype,"XianluTaskItem"),window.XianluTaskItem=XianluTaskItem;var XianluTaskMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[XianLuWin,XianluPanel,XianluTaskWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XianluTaskPanel,XianluTaskZSPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e){void 0===e&&(e=-1),t.prototype.open.call(this,e)},e.prototype.setSkinName=function(){this.skinName="XianluTaskMainPanelEUI"},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn5},e.getTitle=function(){return"xianlu_title_xyrw"},e.getTabTitle=function(){return"bqz_zycs_xianluTask"},e}(BaseTabPanel);__reflect(XianluTaskMainPanel.prototype,"XianluTaskMainPanel"),window.XianluTaskMainPanel=XianluTaskMainPanel;var XianluTaskPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluTaskPanelEUI",e.itemList.itemRenderer=XianluTaskItem,e.itemList.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){XianLuSys.ins().sendTaskInfo(),this.addLsn(XianLuSys.ins().updateXianyuanTaskInfo,this.updateView),this.addLsn(RpSys.ins().patchRp,this.updateRp)},e.prototype.updateView=function(){var t=XianLuSys.ins().dayTaskList;SortUtil.sortOn(t,["taskState","taskId"],[SortType.down,SortType.down]),this.listData.source=t},e.getSysId=function(){return SysId.xianlu},e.getTitle=function(){return"xianlu_title_xyrw"},e.getTabTitle=function(){return"每日任务"},e}(BasePanel);__reflect(XianluTaskPanel.prototype,"XianluTaskPanel"),window.XianluTaskPanel=XianluTaskPanel;var XianluTaskWin=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[],e.winType=WinType.NeverCloseWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XianluTaskMainPanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg("background_zycs_bg_jpg",null)},e.prototype.setSkinName=function(){this.skinName="BaseWinSkin2"},e}(BaseWinAutoTab);__reflect(XianluTaskWin.prototype,"XianluTaskWin"),window.XianluTaskWin=XianluTaskWin;var XianluTaskZSItem=function(t){function e(){var e=t.call(this)||this;return e.mcBtnOk=new MC,e.skinName="XianluTaskZSItemEUI",e.addClickE(e.btn_reward,e.onClick),e.addClickE(e.btnGoto,e.onClick),e.addClickE(e.btnGet,e.onClick),e.mcBtnOk.x=e.btnGet.width/2,e.mcBtnOk.y=e.btnGet.height/2,e.btnGet.addChild(e.mcBtnOk),e.mcBtnOk.playFile(ResMgr.getEffName("public_zycs_button01"),-1),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;switch(t.target){case this.btnGet:XianLuSys.ins().sendGetTaskReward(2,e.taskId);break;case this.btnGoto:var i=GFunc.createTaskNavData(e.getMateQuestConfig().controlTarget);i.setsucceedFrontFun(function(){closeWin(JobWin)}),i["goto"]();break;case this.btn_reward:var n=e.getMateQuestConfig();openWin(ComRewardTipsWin,n.reward)}},e.prototype.dataChanged=function(){var t=this.data,e=t.getMateQuestConfig();if(this.lb_task.text=e.desc,this.currentState=t.taskState.toString(),2==e.mateType){var i=void 0,n=void 0;3==e.tasktype?(i=this.getZSLevel(t.selfValue),n=this.getZSLevel(t.herValue)):(i=t.selfValue,n=t.herValue),this.myPro.value=i,this.herPro.value=n,this.myPro.maximum=e.target,this.herPro.maximum=e.target}},e.prototype.getZSLevel=function(t){var e=Cfg.getConfig(ZhuanShengLevelConfig,t);return e.cslevel},e}(BaseItemRender);__reflect(XianluTaskZSItem.prototype,"XianluTaskZSItem"),window.XianluTaskZSItem=XianluTaskZSItem;var XianluTaskZSPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluTaskPanelEUI",e.itemList.itemRenderer=XianluTaskZSItem,e.itemList.dataProvider=e.listData=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){XianLuSys.ins().sendTaskInfo(),this.addLsn(XianLuSys.ins().updateXianyuanTaskInfo,this.updateView),this.addLsn(RpSys.ins().patchRp,this.updateRp)},e.prototype.updateView=function(){var t=XianLuSys.ins().longTaskList;SortUtil.sortOn(t,["taskState","taskId"],[SortType.down,SortType.down]);var e=Cfg.getConfig(MateQuestConfig),i={};for(var n in e){var a=e[n],o=this.getTaskData(a.id);if(i[a.tasktype]){var s=i[a.tasktype],r=this.getTaskData(s.taskId);0==r.taskState&&(i[a.tasktype]=o)}else i[a.tasktype]=o}var u=[];for(var n in i)u.push(i[n]);SortUtil.sortOn(u,["taskState","taskId"],[SortType.down,SortType.down]),this.listData.source=u},e.prototype.getTaskData=function(t){for(var e=XianLuSys.ins().longTaskList,i=0,n=e;i<n.length;i++){var a=n[i];if(t==a.taskId)return a}return null},e.getSysId=function(){return SysId.xianlu},e.getTitle=function(){return"xianlu_title_xyrw"},e.getTabTitle=function(){return"终身任务"},e}(BasePanel);__reflect(XianluTaskZSPanel.prototype,"XianluTaskZSPanel"),window.XianluTaskZSPanel=XianluTaskZSPanel;var XianluLabelItem=function(t){function e(){var e=t.call(this)||this;return e.isSelect=!1,e.skinName="XianluListPanelLabelItemEUI",e.touchChildren=!1,e}return __extends(e,t),e.prototype.setSelect=function(t){"undefined"==typeof t&&(t=!this.getSelect()),this.currentState=t?"down":"up",this.isSelect=t},e.prototype.getSelect=function(){return this.isSelect},e}(BaseItemRender);__reflect(XianluLabelItem.prototype,"XianluLabelItem"),window.XianluLabelItem=XianluLabelItem;var XianluLabelItem2=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluListLabeItemEUI",e.touchChildren=!1,e}return __extends(e,t),e}(BaseItemRender);__reflect(XianluLabelItem2.prototype,"XianluLabelItem2"),window.XianluLabelItem2=XianluLabelItem2;var XianLuListPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluListPanelEUI",e.tabType.dataProvider=new eui.ArrayCollection(["跨服仙缘","本服仙缘"]),e.labelList=[e.item0,e.item1,e.item2,e.item3,e.item4,e.item5,e.item6,e.item7],e.list.itemRenderer=XianluListPanelItem,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=XianLuSys.ins();this.addClickE(this,this.onClick),this.addItemTapE(this.tabType,this.onTab),this.addLsn(i.updateXianyuanList,this.updateList),this.addLsn(i.updateMyXianyuan,this.updateList),this.tabType.selectedIndex=i.tabIndex,this.requestXianyuanInfo(),this.updateLabelList()},e.prototype.updateLabelList=function(){for(var t=Cfg.getConfig(MateCommonConfig).labelList,e=this.labelList.length,i=0;e>i;i++)t[i]&&(this.labelList[i].data=t[i])},e.prototype.requestXianyuanInfo=function(){for(var t=[],e=0;e<this.labelList.length;e++)this.labelList[e].getSelect()&&t.push(e+1);var i=this.tabType.selectedIndex?1:2;XianLuSys.ins().sendXianyuanList(i,t)},e.prototype.updateList=function(){var t=XianLuSys.ins().xianYuanList;this.listArr.source=t},e.prototype.onTab=function(){XianLuSys.ins().tabIndex=this.tabType.selectedIndex,this.requestXianyuanInfo()},e.prototype.onClick=function(t){var e=t.target,i=Cfg.getConfig(MateCommonConfig);if(~this.labelList.indexOf(e))if(e.getSelect())e.setSelect(!1),this.requestXianyuanInfo();else{for(var n=0,a=0;a<this.labelList.length;a++)this.labelList[a].getSelect()&&n++;n>=i.labellimit[1]?showtipsFail("最多可选中"+i.labellimit[1]+"个标签"):(e.setSelect(),this.requestXianyuanInfo())}else switch(e){case this.btnClean:for(var a=0;a<this.labelList.length;a++)this.labelList[a].setSelect(!1);this.requestXianyuanInfo();break;case this.btnHelp:var o=Cfg.getConfig(MateCommonConfig).tips;openWin(HelpWin,o);break;case this.btnSearch:openWin(XianluSearchWin);break;case this.btnOK:openWin(XianluReleaseWin)}},e.getTitle=function(){return"xianlu_title_xyq"},e.getTabTitle=function(){return"bqz_zycs_xianluqiang"},e}(BasePanel);__reflect(XianLuListPanel.prototype,"XianLuListPanel"),window.XianLuListPanel=XianLuListPanel;var XianluListPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianluListPanelItemEUI",e.list.itemRenderer=XianluLabelItem2,e.list.touchChildren=!1,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e.addClickE(e.btnOk,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(){var t=this;if(XianLuSys.ins().isJieYuan())return void showtipsFail("您已结缘，不可结缘");if(this.data.actorId==Actor.ins().actorID)return void showtipsFail("无法与自己结缘");if(!GFunc.isInCity()){var e=10001,i=Cfg.getConfig(NPCConfig,e),n=new PopupData;return n.desc="需前往"+i.name+"才可结缘，是否立即前往？",n.setFunction(this,function(){isShowWin(XianLuListWin)&&closeWin(XianLuListWin),isShowWin(XianLuWin)&&closeWin(XianLuWin),LogicSys.ins().centerEntity.AI.startfindNpc(i.id)}),void openWin(CommonTipsWin,n)}isShowWin(XianLuListWin)&&closeWin(XianLuListWin),isShowWin(XianLuWin)&&closeWin(XianLuWin),LogicSys.ins().centerEntity.AI.startfindNpc(10001,function(){isShowWin(XianLuListWin)||openWin(XianLuListWin),openWin(XianluJieYuanWin,t.data)})},e.prototype.dataChanged=function(){var t=this.data;this.imgHead.source=ResMgr.getHeadIcon(t.sex);var e=Cfg.getConfig(ChatFrameConfig,2,t.headFrameId);this.headFrame.source=ResMgr.getFrameIcon(e.icon),this.lbName.text=t.actorName,this.lbDesc.textFlow=addColorTF(t.str),this.item0.setType(CurType.yb),this.item0.setPrice(t.getGift());for(var i=Cfg.getConfig(MateCommonConfig).labelList,n=[],a=0,o=t.labelIds;a<o.length;a++){var s=o[a];n.push(i[s-1])}this.listArr.source=n},e}(BaseItemRender);__reflect(XianluListPanelItem.prototype,"XianluListPanelItem"),window.XianluListPanelItem=XianluListPanelItem;var XianLuListWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.NeverCloseWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XianLuListPanel]},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg("background_zycs_bg_jpg",null)},e.prototype.setSkinName=function(){this.skinName="BaseWinSkin2"},e.prototype.close=function(){t.prototype.close.call(this),isShowWin(XianLuWin)||openWin(XianLuWin)},e}(BaseWinAutoTab);__reflect(XianLuListWin.prototype,"XianLuListWin"),window.XianLuListWin=XianLuListWin;var MoJieWin=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.redPointHead=[RoleWin,RolePanel],e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XingHunPanel,FruitPointPanel,WCPanel]},enumerable:!0,configurable:!0}),e.prototype.getStarsoulUpBtn=function(){return this.getPanel(XingHunPanel).getStarsoulUpBtn()},e.prototype.getUseBtn=function(){return this.getPanel(FruitPointPanel).getUseBtn()},e}(BaseWinAutoTab);__reflect(MoJieWin.prototype,"MoJieWin"),window.MoJieWin=MoJieWin;var XingHunAttrWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="XingHunAttrWinEUI",this.addBg(),t.prototype.initUI.call(this),this.layer=LayerMgr.Popup},e.prototype.open=function(e){t.prototype.open.call(this),this.addClickE(this.btnUp,this.onClick),this.addLsn(XingHunSys.ins().patchUpRank,this.update),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.xingHunData=e,this.update(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(e))&&(this.btnUp.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,XingHunPanel,e))},e.prototype.update=function(){var t=this.xingHunData;this.totalPower.text=t.getMoJiePlusPower().toFixed(0);var e=Math.ceil((t.level+1)/9),i=Cfg.getConfig(StarsoulStageConfig,t.rank),n=Cfg.getConfig(StarsoulStageConfig,t.noActRank()?0:t.rank-1),a=Cfg.getConfig(StarsoulLevelConfig,n.needstar).rank,o=t.canRank(),s=t.rank>=n.stage,r=s?addColor(Lang.common_str40,12704255):addColor("("+e+"/"+a+")",o?9094450:15733780);this.lbCurLevel.textFlow=t.noActRank()?addColorTF(Lang.xh_str4,15129784):addColorTF(Lang.xh_str4+" "+Lang.xh_str6+a+Lang.common_jie+r);var u=""+Lang.xh_str7+addColor("+"+i.atkper/100+"%",12704255)+"\n"+Lang.xh_str8+addColor("+"+i.hpper/100+"%",12704255);if(this.lbCurAttr.textFlow=t.noActRank()?addColorTF(Lang.xh_str9,15129784):addColorTF(u),!t.isMaxRank()){var h=Cfg.getConfig(StarsoulStageConfig,t.rank+1),p=Cfg.getConfig(StarsoulStageConfig,t.noActRank()?0:t.rank),l=""+Lang.xh_str7+addColor("+"+h.atkper/100+"%",12704255)+"\n"+Lang.xh_str8+addColor("+"+h.hpper/100+"%",12704255);this.lbNextAttr.textFlow=addColorTF(l);var c=Cfg.getConfig(StarsoulLevelConfig,p.needstar).rank,d=e>=c,g=addColor("("+e+"/"+c+")",d?5949490:15733780);this.lbNextLevel.textFlow=addColorTF(Lang.xh_str5+" "+Lang.xh_str6+c+Lang.common_jie+g)}t.noActRank()?this.currentState=o?"canAct":"noAct":t.isMaxRank()?this.currentState="max":o?this.currentState="upRank":this.currentState="noRank"},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnUp:this.xingHunData.canRank()&&XingHunSys.ins().sendUpRank()}},e}(BaseWinSingle);__reflect(XingHunAttrWin.prototype,"XingHunAttrWin"),window.XingHunAttrWin=XingHunAttrWin;var XingHunBarEff=function(t){function e(){var e=t.call(this)||this;return e.skinName="XingHuanBarEffEUI",e.mc=new MC,e.mc.x=52,e.mc.y=55,e.mc.touchEnabled=!1,e.groupMc1.addChild(e.mc),e.mc.playFile(getEffName("jypoor2"),-1),e.mcmax=new MC,e.mcmax.x=58,e.mcmax.y=65,e.mcmax.touchEnabled=!1,e.addChild(e.mcmax),e.dimc=new MC,e.dimc.x=72,e.dimc.y=95,e.dimc.touchEnabled=!1,e.groupShuiPing.addChild(e.dimc),e.hpShape=DisUtil.drawCirByAngle(e.hpShape,53.5,0,360,!0),e.hpShape.x=74.5,e.hpShape.y=60.5,e.groupShuiPing.addChild(e.hpShape),e.dimc.touchEnabled=!1,e.dimc.mask=e.hpShape,e.dimc.playFile(getEffName("jypoor1"),-1),e}return __extends(e,t),e.prototype.setData=function(t,e){this.lbValue.text=t+"/"+e;var i=Math.min(107,t/e*107);this.groupMc.height=i,this.dimc.y=107-i+4,t>=e?this.dimc.visible=!1:this.dimc.visible=t>0},e}(BaseItemRender);__reflect(XingHunBarEff.prototype,"XingHunBarEff"),window.XingHunBarEff=XingHunBarEff;var XingHunData=function(){function t(){this.level=0,this.rank=1}return t.prototype.parser=function(t){this.rank=t.readInt(),this.level=t.readInt()},t.prototype.isJinJie=function(){return(this.level+1)%9==0},t.prototype.noActRank=function(){return 0==this.rank},t.prototype.isMaxRank=function(){return this.rank>=Cfg.getMaxConfig(StarsoulStageConfig).stage},t.prototype.isMaxLevel=function(){return this.level>=Cfg.getConfig(StarsoulCommonConfig).max_level},t.prototype.canRank=function(){var t=Cfg.getConfig(StarsoulStageConfig,this.rank);return!this.isMaxRank()&&this.level>=t.needstar},t.prototype.getMoJiePlusAttr=function(){for(var t=Cfg.getConfig(StarsoulStageConfig,this.rank),e=Cfg.getConfig(StarsoulLevelConfig,this.level),i=[],n=0;n<e.attr.length;n++){var a=e.attr[n];if(a.type==AttrType.atAtkMin||a.type==AttrType.atAtkMax){var o=new AttrData;o.type=a.type,o.value=a.value*t.atkper/1e4,i.push(o)}if(a.type==AttrType.atHpMax){var o=new AttrData;o.type=AttrType.atHpMax,o.value=a.value*t.hpper/1e4,i.push(o)}}return i},t.prototype.getMoJiePlusPower=function(){return GFunc.getPower(this.getMoJiePlusAttr())},t.prototype.getLevelAttrDatas=function(){for(var t=[],e=Cfg.getConfig(StarsoulLevelConfig,this.level),i=Cfg.getConfig(StarsoulLevelConfig,this.isMaxLevel()?this.level:this.level+1),n=e.attr.length,a=0;n>a;a++){var o=e.attr[a],s=i.attr[a],r=new ComAttrData(o,s,e.level>=i.level);t.push(r)}return t},t}();__reflect(XingHunData.prototype,"XingHunData");var XingHunPanel=function(t){function e(){var e=t.call(this)||this;return e.imgStars=[],e.mcStars=[],e.flameMC=new MC,e.isAutoAdd=!1,e.isOkClick=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="XingHunPanelEUI",this.setSkinPart("comXingHunBarEff",new XingHunBarEff),this.cursor=new MC,this.cursor.visible=!1,this.imgStars=[this.imgStar0,this.imgStar1,this.imgStar2,this.imgStar3,this.imgStar4,this.imgStar5,this.imgStar6,this.imgStar7];for(var t=0;t<this.imgStars.length;t++)this.mcStars[t]=new MovieEui,this.mcStars[t].verticalCenter=this.mcStars[t].horizontalCenter=0,this.imgStars[t].parent.addChild(this.mcStars[t]);this.setRedPointHead(RoleWin),this.attrs.itemRenderer=ComAttrItem4,this.attrs.dataProvider=this.attrData=new eui.ArrayCollection},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this.comXingHunBarEff,this.onClick),this.addClickE(this.boostBtn,this.onClick),this.addClickE(this.labelStrong,this.onClick),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.boostBtn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_END,this,this.onAddend),this.addLsn(XingHunSys.ins().patchUpRank,this.updateKunDun),this.addLsn(XingHunSys.ins().patchUpLevel,this.updataData),this.addLsn(XingHunSys.ins().patchUpRank,this.updataData),this.addLsn(LogicSys.ins().patchCurrency,this.onStarsoulValueChange),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.updatePanel(),this.updateKunDun(),this.updateRp()},e.prototype.updateRp=function(t){void 0===t&&(t=null),(!t||t.check(e))&&(this.boostBtn.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,e,"upLevel"),this.comXingHunBarEff.redPoint.visible=RpSys.ins().getData(RoleWin,RolePanel,MoJieWin,e,XingHunAttrWin))},e.prototype.onStarsoulValueChange=function(t){if(!t||t.type==CurType.gold){var e=Cfg.getConfig(StarsoulLevelConfig,this.xhData.level),i=Actor.ins().getCurrency(CurType.gold)>=e.count?5767068:16662592,n=StrUtil.addColor(Actor.ins().getCurrency(CurType.gold)+"/",i)+StrUtil.addColor(e.count+"",13171455);this.lbcount.textFlow=addColorTF(n)}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.boostBtn:var e=Cfg.getConfig(StarsoulLevelConfig,this.xhData.level);GFunc.checkCurrency(CurType.gold,e.count)&&(this.isOkClick=!1,XingHunSys.ins().sendUpLevel());break;case this.labelStrong:openWin(MeNeedLevelWin,1);break;case this.comXingHunBarEff:openWin(XingHunAttrWin,XingHunSys.ins().getData(0))}},e.prototype.onAddBegin=function(){this.isAutoAdd=!0,Timer.ins()["do"](500,100,0,this.autoUp,this)},e.prototype.onAddend=function(){this.isAutoAdd=!1,Timer.ins().remove(this.autoUp,this)},e.prototype.autoUp=function(){var t=Cfg.getConfig(StarsoulLevelConfig,this.xhData.level);GFunc.checkCurrency(CurType.gold,t.count)?XingHunSys.ins().sendUpLevel():this.onAddend()},e.prototype.setOkClick=function(){this.isOkClick=!0},e.prototype.updataData=function(){this.setOkClick(),this.updatePanel(),this.updateKunDun(),this.PlayMC()},e.prototype.updatePanel=function(){this.xhData=XingHunSys.ins().getData(0);var t=Cfg.getConfig(StarsoulLevelConfig,this.xhData.level),e=this.xhData.level>=Cfg.getConfig(StarsoulCommonConfig).max_level;this.totalPower.text=(GFunc.getPower(t.attr)+this.xhData.getMoJiePlusPower()).toFixed(0);var i=this.xhData.level%9;this.lbstages.text=""+t.name;var n=this.xhData.isJinJie();this.onStarsoulValueChange(),this.attrData.source=this.xhData.getLevelAttrDatas();for(var a=0;a<this.imgStars.length;a++){var o=this.imgStars[a];i>a?(o.source="mj_zycs_hzl",this.mcStars[a].data=getEffName("xhkq")):(o.source="mj_zycs_hzh",this.mcStars[a].data="")}e||n||(this.mcStars[i].data=getEffName("xhdkq")),e?this.currentState="max":Actor.ins().level<t.needLv?(this.currentState="lock",this.labelLock.text=""+GFunc.GetLvStrByLv(t.needLv)+Lang.xh_str2):n?(this.lbcount.visible=0!=t.count,this.currentState="jinjie"):(this.lbcount.visible=0!=t.count,this.currentState="normal")},e.prototype.PlayMC=function(){this.xhData=XingHunSys.ins().getData(0);var t=this.xhData.level%9,e=this.mcStars[t-1];e&&e.addChild(MC.createCenterGruop(getEffName("xhsj"),1))},e.prototype.updateKunDun=function(){var t=XingHunSys.ins().getData(0),e=Cfg.getConfig(StarsoulLevelConfig,t.level).rank,i=t.rank-1,n=0;if(i>=0){var a=Cfg.getConfig(StarsoulStageConfig,i);n=Cfg.getConfig(StarsoulLevelConfig,a.needstar).rank}var o=Cfg.getConfig(StarsoulStageConfig,t.rank),s=t.isMaxRank()?e:Cfg.getConfig(StarsoulLevelConfig,o.needstar).rank;this.comXingHunBarEff.setData(e-n,s-n),this.lbJie.text="经脉大师"+t.rank+"阶"},e.getSysId=function(){return SysId.mojie},e.prototype.getStarsoulUpBtn=function(){return this.boostBtn},e.getTitle=function(){return"btz_zycs_mj"},e.getTabTitle=function(){return"bqz_zycs_mj"},e}(BasePanel);__reflect(XingHunPanel.prototype,"XingHunPanel"),window.XingHunPanel=XingHunPanel;var XingHunSys=function(t){function e(){var e=t.call(this)||this;return e.sysId=PackId.Starsoul,e.reg(1,e.patchUpdate),e.reg(2,e.patchUpLevel),e.reg(3,e.patchUpRank),e.starsouData=new XingHunData,e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchUpdate=function(t){this.starsouData.parser(t)},e.prototype.sendUpLevel=function(){var t=this.getBytes(2);this.send(t)},e.prototype.patchUpLevel=function(t){var e=t.readInt();this.starsouData.level=e,RpFun.showStarRedPoint()},e.prototype.sendUpRank=function(){var t=this.getBytes(3);this.send(t)},e.prototype.patchUpRank=function(t){var e=t.readInt();this.starsouData.rank=e,RpFun.showStarRedPoint()},e.prototype.getData=function(t){return this.starsouData},e}(BaseSys);__reflect(XingHunSys.prototype,"XingHunSys"),SystemMap.XingHunSys=XingHunSys.ins.bind(XingHunSys),window.XingHunSys=XingHunSys;var XunBaoSys=function(t){function e(){var e=t.call(this)||this;return e.xunbaoDatas=[],e.xunBaoBagItemDatas=[],e.tipsDatas=[],e.sysId=PackId.XunBao,e.reg(1,e.patchXunBaoData),e.reg(2,e.patchXunBaoChouJiang),e.reg(3,e.patchXunBaoJiLu),e.reg(4,e.patchXunBaoDuiHuan),e.reg(5,e.patchXunBaoRemind),e.xunbaoDatas.push(new XunBaoEquipData),e.xunbaoDatas.push(new XunBaoHunQiData),e.xunbaoDatas.push(new XunBaoFuWenData),e.xunbaoDatas.push(new XunBaoDianFengData),e.xunbaoDatas.push(new XunBaoZhiZungData),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.patchXunBaoData=function(t){for(var e=t.readByte(),i=0;e>i;i++){var n=this.xunbaoDatas[i];t.readByte();n.parser(t)}},e.prototype.sendXunBaoChouJiang=function(t,e,i){void 0===i&&(i=0);var n=this.getBytes(2);n.writeByte(t),n.writeByte(e),n.writeByte(i),this.send(n)},e.prototype.showJiPingItem=function(){if(this.tipsDatas.length>0){var t=this.tipsDatas[0];openWin(XunBaoJiPingItemTipsWin,t,this.showJiPingItem,this,XunBaoJiPingItemTipsWin.XUN_BAO),this.tipsDatas.splice(0,1)}},e.prototype.patchXunBaoChouJiang=function(t){for(var e=t.readByte(),i=t.readByte(),n=this.getXunBaoDataByType(e),a=[],o=0;i>o;o++){var s=new ItemDataReward;s.parser2(t);var r=GFunc.creatItemDataById(s.id);r.count=s.count,a.push(r);var u=1==t.readByte();u&&(this.tipsDatas.push(r),isShowWin(XunBaoJiPingItemTipsWin)||this.showJiPingItem())}var h=t.readInt(),p=t.readShort(),l=t.readByte(),c=t.readByte();if(n&&(n.setScore(h),n.setXingYun(p),n.setBiDe(c),n.setMianFei(l)),a.length>=10){var d=getWin(XunBaoRewardListTipsWin);d?d.updateData(a,n):openWin(XunBaoRewardListTipsWin,a,n)}else if(a.length>0){var g=a[0].id,y=new eui.Image;y.source=ResMgr.getItemIcon(Cfg.getItemCfg(g).getIcon(),IconType.IT_80x80),y.anchorOffsetX=37,y.anchorOffsetY=37,y.x=LayerMgr.Popup.width/2+40,y.y=LayerMgr.Popup.height/2-200,LayerMgr.Popup.addChild(y);var d=getWin(XunBaoWin);if(d){var f=d.getBagTab();GFunc.flyToBag1(y,f)}}RpFun.showXunBaoRedPoint(),RpFun.showXunBaoDuiHuanRedPoint()},e.prototype.sendXunBaoJiLu=function(t,e){var i=this.getBytes(3);i.writeByte(t),i.writeByte(e),this.send(i)},e.prototype.patchXunBaoJiLu=function(t){var e=t.readByte(),i=t.readByte(),n=t.readByte(),a=this.getXunBaoDataByType(e),o=[],s=0;o=0==i?a.xunBaoJiLuMyDatas:a.xunBaoJiLuOtherDatas,s=o.length;for(var r=0;n>r;r++)if(r>s-1){var u=new XunBaoJiLuData;u.parser(t),o.push(u),1==i&&this.patchXunBaoOtherJiLuUpdate(u)}},e.prototype.patchXunBaoOtherJiLuUpdate=function(t){return t},e.prototype.sendXunBaoDuiHuan=function(t,e){var i=this.getBytes(4);i.writeByte(t),i.writeByte(e),this.send(i)},e.prototype.patchXunBaoDuiHuan=function(t){var e=t.readByte(),i=(t.readByte(),t.readInt()),n=this.getXunBaoDataByType(e);n&&n.setScore(i),RpFun.showXunBaoDuiHuanRedPoint()},e.prototype.sendXunBaoRemind=function(t,e){var i=this.getBytes(5);
i.writeByte(t),i.writeByte(e),this.send(i)},e.prototype.patchXunBaoRemind=function(t){var e=t.readByte(),i=t.readInt(),n=this.getXunBaoDataByType(e);n&&n.setRemind(i),RpFun.showXunBaoDuiHuanRedPoint()},e.prototype.doBagData=function(t){this.xunBaoBagItemDatas=[];for(var e,i=t.readInt(),n=0;i>n;n++)e=new ItemDataBase,e.parser(t),this.xunBaoBagItemDatas.push(e)},e.prototype.doDeleteItem=function(t){for(var e=t.readDouble(),i=this.xunBaoBagItemDatas.length-1;i>=0;i--)if(this.xunBaoBagItemDatas[i].handle==e){this.xunBaoBagItemDatas.splice(i,1);break}this.patchDeleteItem(),RpFun.showXunBaobagRedPoint()},e.prototype.patchDeleteItem=function(){},e.prototype.patchAddItem=function(t){var e=new ItemDataBase;e.parser(t),this.xunBaoBagItemDatas.unshift(e);t.readByte(),t.readByte();RpFun.showXunBaobagRedPoint()},e.prototype.patchUpDateItem=function(t){for(var e,i=t.readDouble(),n=t.readInt(),a=(t.readByte(),t.readByte(),0);a<this.xunBaoBagItemDatas.length;a++)if(e=this.xunBaoBagItemDatas[a],e.handle==i){e.count=n;break}},e.prototype.getXunBaoDataByType=function(t){for(var e=0;e<this.xunbaoDatas.length;e++){var i=this.xunbaoDatas[e];if(i.type==t)return i}return null},e.prototype.getDoubleTimer=function(){var t=Cfg.getConfig(XunbaoConstConfig).openday[0],e=new Date(Actor.ins().serverOpenTimer);e.setHours(0),e.setMinutes(0),e.setSeconds(0);var i=e.getTime()+t*DateUtil.MS_PER_DAY,n=Actor.ins().serverTime,a=i>n;if(a){var o=(i-n)/1e3;return o}return 0},e.prototype.isDoubleTimer=function(){var t=Cfg.getConfig(XunbaoConstConfig).openday[0],e=new Date(Actor.ins().serverOpenTimer);e.setHours(0),e.setMinutes(0),e.setSeconds(0);var i=e.getTime()+t*DateUtil.MS_PER_DAY,n=Actor.ins().serverTime;return i>n},e.prototype.hasFreeCount=function(){for(var t=!1,e=0;e<this.xunbaoDatas.length;e++){var i=this.xunbaoDatas[e];if(0==i.mianFei){t=!0;break}}return t},__decorate([callDelay(100)],e.prototype,"patchDeleteItem",null),e}(BaseSys);__reflect(XunBaoSys.prototype,"XunBaoSys"),SystemMap.XunBaoSys=XunBaoSys.ins.bind(XunBaoSys),window.XunBaoSys=XunBaoSys;var RedBaoLogItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedBaoLogItemEUI",e.setSkinPart("boostPrice1",new PriceIcon),e.boostPrice1.setType(CurType.yb),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.roleName){var t=this.data;this.head.source=ResMgr.getHeadIcon(t.job),this.nameLabel.text=""+t.roleName,this.boostPrice1.setPrice(t.yuanbao),this.timeTxt.text=""+getFormatTime(t.getTime(),"hh小时mm分ss秒")+Lang.common_qian}},e}(BaseItemRender);__reflect(RedBaoLogItem.prototype,"RedBaoLogItem"),window.RedBaoLogItem=RedBaoLogItem;var XunBaoDianFengData=function(t){function e(){var e=t.call(this)||this;return e.tabName="龙宫寻宝",e.type=XunbaoType.DianFeng,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e)},e.prototype.getConfig=function(){return Cfg.getConfigs(XunbaoDianfengConfig,0,CondType.MoreEqual,"show",1)},e.prototype.getXunbaoEquipConfigById=function(t,e){return Cfg.getConfig(XunbaoDianfengConfig,t,1)},e.prototype.getXunbaoEquipByPondid=function(){return Cfg.getConfigs(XunbaoDianfengConfig,0,CondType.ALL)},e.prototype.getPanelName=function(){return egret.getQualifiedClassName(XunBaoDianFengPanel)},e}(XunBaoEquipData);__reflect(XunBaoDianFengData.prototype,"XunBaoDianFengData"),window.XunBaoDianFengData=XunBaoDianFengData;var XunBaoDuiHuanData=function(){function t(){this._remind=0}return t.prototype.parser=function(t){},Object.defineProperty(t.prototype,"remind",{get:function(){return this._remind},set:function(t){this._remind=t},enumerable:!0,configurable:!0}),t}();__reflect(XunBaoDuiHuanData.prototype,"XunBaoDuiHuanData"),window.XunBaoDuiHuanData=XunBaoDuiHuanData;var RedBaoRobItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedBaoRobItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.actorId){var t=this.data;this.head.source=ResMgr.getHeadIcon(t.job),this.nameLabel.text=""+t.roleName;var e=Actor.ins().serverTime-t.time;e=0>=e?1:e/1e3,this.timeTxt.text=""+getFormatTime(e,"hh小时mm分ss秒")+Lang.common_qian,this.ybTxt.text=""+t.yuanbaoNum,this.setState(t.receiveState),this.setVip(t.vipLv);var i=Cfg.getItemCfg(CurType.yb);this.ybImg.source=ResMgr.getItemIcon(i.getIcon(),IconType.IT_80x80)}},e.prototype.setVip=function(t){t>0?(this.vipBmp.visible=!0,this.vipBmp.text="v"+t.toString()):this.vipBmp.visible=!1},e.prototype.setState=function(t){var e="";this.ybImg.visible=!1,this.ybTxt.visible=!1,t==RedbaoReceiveState.weiLing?(this.titleImg.source="czhb_zycs_hb1",e=StrUtil.addColor(Lang.recharge_str9,13486270)):t==RedbaoReceiveState.yiLing?(this.titleImg.source="czhb_zycs_hb3",e=StrUtil.addUnderLine(StrUtil.addColor(Lang.recharge_str10,13486270)),this.ybImg.visible=!0,this.ybTxt.visible=!0):t==RedbaoReceiveState.qiangWan?(this.titleImg.source="czhb_zycs_hb2",e=StrUtil.addColor(Lang.recharge_str11,11508595)):t==RedbaoReceiveState.guoQi&&(this.titleImg.source="czhb_zycs_hb4",e=StrUtil.addColor(Lang.recharge_str11,6513507)),this.decTxt.textFlow=addColorTF(e)},e}(BaseItemRender);__reflect(RedBaoRobItem.prototype,"RedBaoRobItem"),window.RedBaoRobItem=RedBaoRobItem;var XunBaoFuWenData=function(t){function e(){var e=t.call(this)||this;return e.tabName="符文寻宝",e.type=XunbaoType.FuWen,e}return __extends(e,t),Object.defineProperty(e.prototype,"showItemDatas",{get:function(){if(0==this._showItemDatas.length){var t=this.getConfig();SortUtil.sortOn(t,["show"],[SortType.up]);for(var e=0;e<t.length;e++){var i=t[e],n=i.item,a=GFunc.creatItemDataById(n.id);this._showItemDatas.push(a)}}return this._showItemDatas},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){return Cfg.getConfigs(XunbaoElementConfig,0,CondType.MoreEqual,"show",1)},Object.defineProperty(e.prototype,"costitem",{get:function(){return Cfg.getConfig(XunbaoConstConfig).elementcost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bideItemData",{get:function(){var t;if(this.isBiDe){var e=Cfg.getConfig(XunbaoConstConfig).elementcost[2][0],i=Cfg.getConfig(XunbaoElementConfig,e,1);if(1==i.status){var n=i.item.id;t=GFunc.creatItemDataById(n)}}return t},enumerable:!0,configurable:!0}),e.prototype.getPanelName=function(){return egret.getQualifiedClassName(XunBaoFuWenPanel)},e}(XunBaoBaseData);__reflect(XunBaoFuWenData.prototype,"XunBaoFuWenData"),window.XunBaoFuWenData=XunBaoFuWenData;var XunBaoHunQiData=function(t){function e(){var e=t.call(this)||this;return e.tabName="法器寻宝",e.type=XunbaoType.HunQi,e}return __extends(e,t),Object.defineProperty(e.prototype,"showItemDatas",{get:function(){if(0==this._showItemDatas.length){var t=this.getConfig();SortUtil.sortOn(t,["show"],[SortType.up]);for(var e=0;e<t.length;e++){var i=t[e],n=i.item,a=GFunc.creatItemDataById(n.id);this._showItemDatas.push(a)}}return this._showItemDatas},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){return Cfg.getConfigs(XunbaoHunqiConfig,0,CondType.MoreEqual,"show",1)},Object.defineProperty(e.prototype,"bideItemData",{get:function(){var t;if(this.isBiDe){var e=Cfg.getConfig(XunbaoConstConfig).costcount[2][0],i=Cfg.getConfig(XunbaoHunqiConfig,e,1);if(1==i.status){var n=i.item.id;t=GFunc.creatItemDataById(n)}}return t},enumerable:!0,configurable:!0}),e.prototype.getPanelName=function(){return egret.getQualifiedClassName(XunBaoFaBaoPanel)},e}(XunBaoBaseData);__reflect(XunBaoHunQiData.prototype,"XunBaoHunQiData"),window.XunBaoHunQiData=XunBaoHunQiData;var XunBaoJiLuData=function(){function t(){this.playName="",this.itemId=1,this.count=1}return t.prototype.parser=function(t){this.playName=t.readString(),this.itemId=t.readInt(),this.count=t.readInt()},t}();__reflect(XunBaoJiLuData.prototype,"XunBaoJiLuData"),window.XunBaoJiLuData=XunBaoJiLuData;var XunBaoZhiZungData=function(t){function e(){var e=t.call(this)||this;return e.tabName="仙宫寻宝",e.type=XunbaoType.ZhiZun,e}return __extends(e,t),e.prototype.parser=function(e){t.prototype.parser.call(this,e)},e.prototype.getConfig=function(){return Cfg.getConfigs(XunbaoZhizhunConfig,0,CondType.MoreEqual,"show",1)},e.prototype.getXunbaoEquipConfigById=function(t,e){return Cfg.getConfig(XunbaoZhizhunConfig,t,1)},e.prototype.getXunbaoEquipByPondid=function(){return Cfg.getConfigs(XunbaoZhizhunConfig,0,CondType.ALL)},e.prototype.getPanelName=function(){return egret.getQualifiedClassName(XunBaoZhiZunPanel)},e}(XunBaoEquipData);__reflect(XunBaoZhiZungData.prototype,"XunBaoZhiZungData"),window.XunBaoZhiZungData=XunBaoZhiZungData;var JinZuanBagPanelItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(XunBaoBagPanelItem);__reflect(JinZuanBagPanelItem.prototype,"JinZuanBagPanelItem"),window.JinZuanBagPanelItem=JinZuanBagPanelItem;var XunBaoBagPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoBagPanelEUI",e.listItem.itemRenderer=XunBaoBagPanelItem,e.listItem.dataProvider=e.listItemArray=new eui.ArrayCollection,e.listItem.useVirtualLayout=!0,e}return __extends(e,t),e.prototype.open=function(){this.addClickE(this.buyQuChu,this.onClick),this.addClickE(this.buyAllQuChu,this.onClick),this.addItemTapE(this.listItem,this.onlistBagItemClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(XunBaoSys.ins().patchAddItem,this.updateData),this.addLsn(XunBaoSys.ins().patchDeleteItem,this.updateData),this.addLsn(XunBaoSys.ins().patchUpDateItem,this.updateData),this.updateData(),this.updateRp()},e.prototype.updateRp=function(){},e.prototype.updateData=function(){this.listItemArray.source=XunBaoSys.ins().xunBaoBagItemDatas},e.prototype.onlistBagItemClick=function(t){var e=t.itemRenderer;e.data;e.setSelect(!e.isSelect())},e.prototype.onClick=function(t){var e=0,i=0;switch(t.currentTarget){case this.buyQuChu:for(var n=[],a=this.listItem.numChildren,o=0;a>o;o++){var s=this.listItem.getChildAt(o),r=s.data;if(s.isSelect()){var u=Cfg.getItemCfg(r.id);u.type==ItemType.equip?(e++,n.push(r.handle)):u.type==ItemType.element?(i++,n.push(r.handle)):n.push(r.handle)}}if(!(n.length>0))return void showtipsFail("当前仓库无可取出道具");BagSys.ins().sendBagTo(BagSys.XUNBAO,n),i>FuwenSys.ins().getBagCount()&&showtipsFail("符文背包已满，请分解符文后再取出"),e>BagSys.ins().getSurplusCount()&&showtipsFail("装备背包已满，请熔炼装备后再取出");break;case this.buyAllQuChu:if(0==XunBaoSys.ins().xunBaoBagItemDatas.length)return void showtipsFail("当前仓库无可取出道具");for(var o=0;o<XunBaoSys.ins().xunBaoBagItemDatas.length;o++){var r=XunBaoSys.ins().xunBaoBagItemDatas[o],u=Cfg.getItemCfg(r.id);u.type==ItemType.equip?e++:u.type==ItemType.element&&i++}var h=!1,p=!1;if(i>FuwenSys.ins().getBagCount()&&(showtipsFail("符文背包已满，请分解符文后再取出"),h=!0),e>BagSys.ins().getSurplusCount()&&(showtipsFail("装备背包已满，请熔炼装备后再取出"),p=!0),h&&p)return;BagSys.ins().sendBagTo(BagSys.XUNBAO,[])}},e.prototype.getBuyAllQuChu=function(){return this.buyAllQuChu},e.getTitle=function(){return"btz_zycs_xb"},e.getTabTitle=function(){return"bqz_zycs_ck"},e.getSysId=function(){return SysId["default"]},e}(BasePanel);__reflect(XunBaoBagPanel.prototype,"XunBaoBagPanel"),window.XunBaoBagPanel=XunBaoBagPanel;var RedBaoRobPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedBaoRobEUI",e.scroller.scrollPolicyH=eui.ScrollPolicy.OFF,e.list.itemRenderer=RedBaoRobItem,e.list.dataProvider=e.listDatas=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addLsn(RechargeActSys.ins().patchRedbaoRobInfo,this.updatePanel),this.addLsn(RechargeActSys.ins().patchRedbaoInfo2,this.updatePanel),this.addLsn(RechargeActSys.ins().patchRedbaoRobResult,this.updateResultPanel),this.addItemTapE(this.list,this.onClickList),this.updatePanel()},e.prototype.updatePanel=function(){var t=RechargeActSys.ins().redbaoRobDatas.concat();this.listDatas.source=t},e.prototype.updateResultPanel=function(){var t=RechargeActSys.ins().redbaoRobDatas.concat();SortUtil.sortOn(t,["receiveState","time"],[SortType.up,SortType.down]),this.listDatas.source=t},e.prototype.onClickList=function(t){var e=t.itemRenderer,i=e.data;i&&i.receiveState==RedbaoReceiveState.weiLing?RechargeActSys.ins().sendRedbaoRob(i.redbaoId):openWin(RedBaoResultWin,i)},e.getTitle=function(){return"btz_zycs_hb"},e.getTabTitle=function(){return"bqz_zycs_qhb"},e.getSysId=function(){return SysId.oldSysId},e}(BasePanel);__reflect(RedBaoRobPanel.prototype,"RedBaoRobPanel"),window.RedBaoRobPanel=RedBaoRobPanel;var RedBaoSendPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedBaoSendEUI",e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.sendBtn,this.onClick),this.addLsn(RechargeActSys.ins().patchRedbaoInfo,this.updatePanel),this.updatePanel()},e.prototype.updatePanel=function(){this.bitBaoCountTxt.text=""+RechargeActSys.ins().redbaoNum;var t=RechargeActSys.ins().getNextRedbaoByYuanbao();-1!=t?(this.titleVip.text=(RechargeActSys.ins().getNextRedbaoByYuanbao()/10).toFixed(0),this.titleVip.visible=!0,this.rechargeImg.source="czhb_zycs_zc"):(this.titleVip.visible=!1,this.rechargeImg.source="czhb_zycs_ndlj")},e.prototype.onClick=function(t){RechargeActSys.ins().redbaoNum>0?openWin(RedBaoBuySendWin,RechargeActSys.ins().redbaoNum):showtipsFail(Lang.recharge_str12)},e.getTitle=function(){return"btz_zycs_hb"},e.getTabTitle=function(){return"bqz_zycs_fhb"},e.getSysId=function(){return SysId.oldSysId},e}(BasePanel);__reflect(RedBaoSendPanel.prototype,"RedBaoSendPanel"),window.RedBaoSendPanel=RedBaoSendPanel;var XunBaoBiDeTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoBiDeTipsEUI",e.setSkinPart("item",new ItemBase),e.addClickE(e.btnClose,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t&&(this.item.data=t)},e.prototype.onClick=function(t){this.visible=!1},e}(BaseItemRender);__reflect(XunBaoBiDeTips.prototype,"XunBaoBiDeTips"),window.XunBaoBiDeTips=XunBaoBiDeTips;var XunBaoDianFengPanel=function(t){function e(){var e=t.call(this)||this;return e.lbGuangGao.source="xb_zycs_dfmsz",e.imgTitle.source="xb_zycs_dfxb",e}return __extends(e,t),e.prototype.updateTime=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts4);if(t&&t.isOpenActivity())this.lbDoubleTimer.text=t.getformatTime();else{var e=XunBaoSys.ins().getDoubleTimer();e>0?this.lbDoubleTimer.text=""+getFormatTime(e,"dd天hh小时mm分ss秒"):this.lbDoubleTimer.text=""}},e.prototype.updateState=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts4);t&&t.isOpenActivity()?this.currentState="act":this.currentState=XunBaoSys.ins().isDoubleTimer()?"7day":"none",this.validateNow()},e.getTitle=function(){return"btz_zycs_wmjt"},e.getTabTitle=function(){return"龙宫寻宝"},e.getSysId=function(){return SysId.XunBaoDianFeng},Object.defineProperty(e.prototype,"data",{get:function(){return XunBaoSys.ins().getXunBaoDataByType(XunbaoType.DianFeng)},enumerable:!0,configurable:!0}),e}(XunBaoEquipPanel);__reflect(XunBaoDianFengPanel.prototype,"XunBaoDianFengPanel"),window.XunBaoDianFengPanel=XunBaoDianFengPanel;var XunBaoDuiHuanPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoDuiHuanPanelEUI",e.listItem.itemRenderer=XunBaoDuiHuanPanelItem,e.listItem.dataProvider=e.listItemArray=new eui.ArrayCollection,e.tab.itemRenderer=XunBaoTab,e}return __extends(e,t),e.prototype.setTabItem=function(){},e.prototype.open=function(){this.addItemTapE(this.tab,this.onTabClick),this.addClickE(this.listItem,this.onlistDuiHuantemClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(XunBaoSys.ins().patchXunBaoRemind,this.updateLlist),this.addLsn(XunBaoSys.ins().patchXunBaoDuiHuan,this.updateLlist),this.addLsn(XunBaoSys.ins().patchXunBaoDuiHuan,this.updateScore),this.tab.dataProvider=new eui.ArrayCollection(XunBaoSys.ins().xunbaoDatas),this.tab.validateNow();var t=0;this.tab.selectedIndex=t,this.updateRp(),this.setData(XunBaoSys.ins().xunbaoDatas[t])},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),null==t||t.check(e)){for(var i=this.listItem.numElements,n=0;i>n;n++){var a=this.listItem.getElementAt(n);a&&a.updateRedPoint()}for(var o=this.tab.numElements,n=0;o>n;n++){var a=this.tab.getChildAt(n);if(a){var s=RpSys.ins().getData(ExtCom,XunBaoWin,e,XunBaoDuiHuanPanelItem,n+1);a.updateRedPoint(s)}}}},e.prototype.updateLlist=function(){for(var t=this.listItem.numElements,e=0;t>e;e++){var i=this.listItem.getElementAt(e);i&&i.updateItem()}},e.prototype.updateScore=function(){this.lbJiFen.text=this.curData.tabName+"积分:"+this.curData.score},e.prototype.setData=function(t){this.curData=t,this.listItemArray.source=t.xunBaoDuiHuanDatas,this.updateScore()},e.prototype.onTabClick=function(t){var e=t.item;this.setData(e)},e.prototype.onlistDuiHuantemClick=function(t){if("btnDuiHuan"==t.target.name){var e=t.target.parent.data,i=e.config;this.curData.score>=i.score?XunBaoSys.ins().sendXunBaoDuiHuan(i.type,i.index):showtipsFail("积分不足")}if("checkBoxTiXing"==t.target.name){var e=t.target.parent.data,i=e.config;XunBaoSys.ins().sendXunBaoRemind(i.type,i.index)}},e.getTitle=function(){return"btz_zycs_xb"},e.getTabTitle=function(){return"bqz_zycs_dh"},e.getSysId=function(){return SysId["default"]},e}(BasePanel);__reflect(XunBaoDuiHuanPanel.prototype,"XunBaoDuiHuanPanel"),window.XunBaoDuiHuanPanel=XunBaoDuiHuanPanel;var XunBaoDuiHuanPanelItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoDuiHuanPanelItemEUI",e.setSkinPart("itemIcon",new ItemBase),e.btnDuiHuan.name="btnDuiHuan",e.checkBoxTiXing.name="checkBoxTiXing",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.config,i=GFunc.creatItemDataById(e.item.id);i.count=e.item.count,this.itemIcon.data=i,this.lbName.text=i.cfg.getName(),this.lbName.textColor=GConst.PZColor[i.cfg.quality],this.updateItem()},e.prototype.updateItem=function(){var t=this.data,e=t.config,i=XunBaoSys.ins().getXunBaoDataByType(e.type).score,n=i>=e.score?3821938:15733780;this.lbJiFen.textFlow=addColorTF(""+(e.score+"积分"),n),this.updateRemind(),this.updateRedPoint()},e.prototype.updateRemind=function(){var t=this.data;this.checkBoxTiXing.selected=1==t.remind},e.prototype.updateRedPoint=function(){var t=this.data,i=t.config,n=RpSys.ins().getData(ExtCom,XunBaoWin,XunBaoDuiHuanPanel,e,i.type,i.index);this.btnDuiHuan.redPoint.visible=n},e}(BaseItemRender);__reflect(XunBaoDuiHuanPanelItem.prototype,"XunBaoDuiHuanPanelItem"),window.XunBaoDuiHuanPanelItem=XunBaoDuiHuanPanelItem;var RedBaoBuySendWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="RedBaoBuySendWinEUI",e.addBg(),e.setSkinPart("priceIcon",new PriceIcon),e.priceIcon.setType(CurType.yb),e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.buyBtn,this.buy),this.updateView()},e.prototype.updateView=function(){var t=RechargeActSys.ins().redBaoSendData[0];this.priceIcon.setPrice(t.price),this.countTxt.text=""+t.count},e.prototype.buy=function(t){RechargeActSys.ins().sendRedbaoRequest(),closeWin(e),showtipsFail(Lang.recharge_str13)},e}(BaseWinSingle);__reflect(RedBaoBuySendWin.prototype,"RedBaoBuySendWin"),window.RedBaoBuySendWin=RedBaoBuySendWin;var RedBaoLogWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="RedBaoLogsWinEUI",e.addBg(),e.setSkinPart("boostPrice1",new PriceIcon),e.boostPrice1.setType(CurType.yb),e.list.itemRenderer=RedBaoLogItem,e.scroller.scrollPolicyH=eui.ScrollPolicy.OFF,e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.updatePanel(e)},e.prototype.updatePanel=function(t){this.boostPrice1.setPrice(t.totalPrice);var e=StrUtil.addColor(Lang.recharge_str14,10061155);e+=StrUtil.addColor(t.count+"/"+t.totalCount,1421059),this.receiveCountTxt.textFlow=addColorTF(e),this.list.dataProvider=new eui.ArrayCollection(t.infoDatas)},e}(BaseWinSingle);__reflect(RedBaoLogWin.prototype,"RedBaoLogWin"),window.RedBaoLogWin=RedBaoLogWin;var RedBaoResultWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="RedBaoResultWinEUI",e.addBg(),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.data=e,this.addClickE(this.logBtn,this.onClick),this.updatePanel()},e.prototype.updatePanel=function(){this.head.source=ResMgr.getHeadIcon(this.data.job);var t=StrUtil.addColor(Lang.recharge_str15,12247261);t+=StrUtil.addColor(""+this.data.roleName,15383908),this.nameLabel.textFlow=addColorTF(t),this.data.receiveState==RedbaoReceiveState.yiLing?(this.priceTxt.text=""+this.data.yuanbaoNum,this.currentState="h1"):this.currentState="h2"},e.prototype.onClick=function(t){RechargeActSys.ins().sendRedbaoLog(this.data.redbaoId),closeWin(e)},e}(BaseWinSingle);__reflect(RedBaoResultWin.prototype,"RedBaoResultWin"),window.RedBaoResultWin=RedBaoResultWin;var XunBaoEquipPanelItem2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XunBaoEquipPanelItem1EUI"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.item.setItemKuangEffect(!0,"eff6"),this.item.setItemEffect(!0,"eff7")},e}(XunBaoEquipPanelItem1);__reflect(XunBaoEquipPanelItem2.prototype,"XunBaoEquipPanelItem2"),window.XunBaoEquipPanelItem2=XunBaoEquipPanelItem2;var XunBaoFaBaoPanel=function(t){function e(){var e=t.call(this)||this;return e.lbGuangGao.source="xb_zycs_hqmszz",e.imgTitle.source="xb_zycs_hqxb",e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XunBaoFaBaoPanelEUI"},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this),this.comGunDongBase.close()},e.prototype.open=function(){t.prototype.open.call(this),this.comGunDongBase.iniData(GFunc.creatItemsDataById(Cfg.getConfig(XunbaoConstConfig).hunqiItem),"XunBaoFaBaoPanelGunDongItem",34,ArrowDir.dirH),this.comGunDongBase.open()},e.prototype.updateXingYun=function(){},Object.defineProperty(e.prototype,"data",{get:function(){return XunBaoSys.ins().getXunBaoDataByType(XunbaoType.HunQi)},enumerable:!0,configurable:!0}),e.prototype.updateState=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts2);t&&t.isOpenActivity()?this.currentState="act":this.currentState=XunBaoSys.ins().isDoubleTimer()?"7day":"none",this.validateNow()},e.prototype.updateTime=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts2);if(t&&t.isOpenActivity())this.lbDoubleTimer.text=t.getformatTime();else{var e=XunBaoSys.ins().getDoubleTimer();e>0?this.lbDoubleTimer.text=""+getFormatTime(e,"dd天hh小时mm分钟ss秒"):this.lbDoubleTimer.text=""}},e.getTitle=function(){return"btz_zycs_hqxb"},e.getTabTitle=function(){return"法器寻宝"},e.getSysId=function(){return SysId.XunBaoEquip},e}(XunBaoEquipPanel);__reflect(XunBaoFaBaoPanel.prototype,"XunBaoFaBaoPanel"),window.XunBaoFaBaoPanel=XunBaoFaBaoPanel;var XunBaoFaBaoPanelGunDongItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoFaBaoPanelGunDongItemEUI",e.mc=new MC,e.groupMc.addChild(e.mc),e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.cfg;this.imgIcon.source=ResMgr.getItemIcon(e.getIcon(),IconType.IT_80x80),this.lbName.text=t.cfg.getName(),this.lbName.textColor=GConst.PZColor[t.cfg.quality]},e.prototype.onClick=function(t){var e=this.data;GFunc.openItemTips(e)},e}(BaseItemRender);__reflect(XunBaoFaBaoPanelGunDongItem.prototype,"XunBaoFaBaoPanelGunDongItem"),window.XunBaoFaBaoPanelGunDongItem=XunBaoFaBaoPanelGunDongItem;var XunBaoFuWenPanel=function(t){function e(){var e=t.call(this)||this;return e.isScrol=!1,e.listItem.itemRenderer=XunBaoFuWenPanelItem,e.listItem.dataProvider=e.listItemArray=new eui.ArrayCollection,e.listItemJueBan.itemRenderer=XunBaoFuWenPanelMaxItem,e.listItemJueBan.dataProvider=e.listItemJueBanArray=new eui.ArrayCollection,e.imgTitle.source="xb_zycs_fwxb",e.setSkinPart("xunBaoBiDeTips",new XunBaoBiDeTips),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XunBaoFuWenPanelEUI"},e.prototype.open=function(){t.prototype.open.call(this),this.animation(),this.scrollerItem.addEventListener(eui.UIEvent.CHANGE_START,this.changeStart,this),this.scrollerItem.addEventListener(eui.UIEvent.CHANGE_END,this.changeEnd,this),Timer.ins()["do"](0,33,0,this.animation,this,TimerType.FIRST)},e.prototype.animation=function(){this.scrollerItem.validateNow();var t=this.scrollerItem.viewport.contentHeight-this.scrollerItem.height;this.scrollerItem.viewport.scrollV=this.scrollerItem.viewport.scrollV+1,this.scrollerItem.viewport.scrollV>=t&&(this.scrollerItem.viewport.scrollV=0)},e.prototype.changeStart=function(){this.isScrol=!0,console.log("开始滚动")},e.prototype.changeEnd=function(){this.isScrol=!1,console.log("结束滚动")},e.prototype.updateRp=function(){},e.prototype.updatePanel=function(){t.prototype.updatePanel.call(this);var e=this.data.showItemDatas;this.listItemJueBanArray.source=e.concat().splice(0,4),this.listItemArray.source=e.concat().splice(4,e.length).concat(e.concat().splice(4,8))},e.prototype.updateXingYun=function(){this.progressExp.maximum=this.data.maxXingYun,this.progressExp.value=this.data.xingyun},e.prototype.updateTime=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts3);t&&t.isOpenActivity()?this.lbDoubleTimer.text=t.getformatTime():this.lbDoubleTimer.text=""},e.prototype.updateState=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts3);t&&t.isOpenActivity()?this.currentState="act":this.currentState="none",this.validateNow()},Object.defineProperty(e.prototype,"isUseYb",{get:function(){return 1==TipsSys.ins().saveReminds[this.data.getPanelName()]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return XunBaoSys.ins().getXunBaoDataByType(XunbaoType.FuWen)},enumerable:!0,configurable:!0}),e.getTitle=function(){return"btz_zycs_wmjt"},e.getTabTitle=function(){return"符文寻宝"},e.getSysId=function(){return SysId.XunBaoFuWen},e}(XunBaoBasePanel);__reflect(XunBaoFuWenPanel.prototype,"XunBaoFuWenPanel"),window.XunBaoFuWenPanel=XunBaoFuWenPanel;var RedBaoWin=function(t){function e(){var e=t.call(this)||this;return e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[RedBaoRobPanel,RedBaoSendPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(RedBaoWin.prototype,"RedBaoWin"),window.RedBaoWin=RedBaoWin;var XunBaoFuWenPanelMaxItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(XunBaoFuWenPanelItem);__reflect(XunBaoFuWenPanelMaxItem.prototype,"XunBaoFuWenPanelMaxItem"),window.XunBaoFuWenPanelMaxItem=XunBaoFuWenPanelMaxItem;var XunBaoGaiLvTipsWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoGaiLvTipsWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=""),t.prototype.open.call(this),this.lbContent.textFlow=StrUtil.toTF(e)},e}(BaseWinSingle);__reflect(XunBaoGaiLvTipsWin.prototype,"XunBaoGaiLvTipsWin"),window.XunBaoGaiLvTipsWin=XunBaoGaiLvTipsWin;var XunBaoJiLuItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XunBaoJiLuItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=Cfg.getItemCfg(t.itemId);this.lbDesc.textFlow=addColorTF("运气爆棚,"+addColor(t.playName,10244109)+"获得了"+addColor(e.getName(),GConst.PZColor[e.quality]))},e}(BaseItemRender);__reflect(XunBaoJiLuItem.prototype,"XunBaoJiLuItem"),window.XunBaoJiLuItem=XunBaoJiLuItem;var XunBaoJiPingItemTipsWin=function(t){function e(){var e=t.call(this)||this;return e.mc=new MC,e.type=0,e.closeCaller=new Caller,e.useType=0,e.layer=LayerMgr.Tips,e.skinName="XunBaoJiPingItemTipsEUI",e.addBg(),e.setSkinPart("itemIcon",new ItemBase),e.mc.x=111,e.mc.y=119,e.mc.touchEnabled=!1,e.group.touchEnabled=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(t,e,i,n){this.addClickE(this.closeBtn0,this.onClick),this.addClickE(this.checkBox,this.onClick),this.data=t,this.closeCaller.func=e,this.closeCaller.obj=i,this.type=n,this.mc.playFile(getEffName("jlcq"),-1),this.setData(),Timer.ins()["do"](5e3,1,1,this.countDown1,this)},e.openCheck=function(t,i,n,a){return 1==e.tishiData[a]?!1:!0},e.prototype.countDown1=function(){Timer.ins().remove(this.countDown1,this),closeWin(this),this.closeCaller.call()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.setData=function(){this.itemIcon.data=this.data,this.lbName.text=this.data.cfg.getName(),this.lbName.textColor=GConst.PZColor[this.data.cfg.quality]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn0:this.countDown1();break;case this.checkBox:e.tishiData[this.type]=this.checkBox.selected}},e.JIN_ZUAN=0,e.XUN_BAO=1,e.ACT_6_1=2,e.ACT_DW=3,e.tishiData={},e}(BaseWinSingle);__reflect(XunBaoJiPingItemTipsWin.prototype,"XunBaoJiPingItemTipsWin"),window.XunBaoJiPingItemTipsWin=XunBaoJiPingItemTipsWin;var XunBaoMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ExtCom,XunBaoWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XunBaoEquipPanel,XunBaoFaBaoPanel,XunBaoFuWenPanel,XunBaoDianFengPanel,XunBaoZhiZunPanel]},enumerable:!0,configurable:!0}),e.prototype.setSkinName=function(){this.skinName="XunBaoMainPanelEUI"},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn5},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e)},e.getTitle=function(){return"btz_zycs_xb"},e.getTabTitle=function(){return"bqz_zycs_xb"},e.prototype.getTabBtn=function(t){return this.tab.validateNow(),this.tab.getElementAt(t)},e.prototype.getXunBaoEquipPanel_MianFeiXunBaoBtn=function(){return this.getPanel(XunBaoEquipPanel).getMianFeiXunBaoBtn()},e.prototype.getXunBaoFaBaoPanel_MianFeiXunBaoBtn=function(){return this.getPanel(XunBaoFaBaoPanel).getMianFeiXunBaoBtn()},e}(BaseTabPanel);__reflect(XunBaoMainPanel.prototype,"XunBaoMainPanel"),window.XunBaoMainPanel=XunBaoMainPanel;var XunBaoRewardListTipsWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="XunBaoRewardListTipsWinEUI",this.addBg(),this.list.itemRenderer=ItemBaseColor,this.list.dataProvider=this.listArray=new eui.ArrayCollection,this.list.useVirtualLayout=!0},e.prototype.open=function(e,i){t.prototype.open.call(this),this.addClickE(this.buyXunBao10,this.onClick),this.addClickE(this.buyXunBao50,this.onClick),this.addLsn(BagSys.ins().patchItemChange,this.updateConsume),this.updateData(e,i),this.updateConsume(),this.updateBtn()},e.prototype.updateData=function(t,e){this.data=e;for(var i=[],n=0,a=t;n<a.length;n++){var o=a[n];o.tempColor=16775602,i.push(o)}this.listArray.source=i,Timer.ins()["do"](100,1,1,this.flyItemList,this)},e.prototype.updateBtn=function(){this.buyXunBao10.labelDisplay.text="寻宝"+this.data.costitem[1][0]+"次",this.buyXunBao50.labelDisplay.text="寻宝"+this.data.costitem[2][0]+"次"},e.prototype.flyItemList=function(){for(var t=this.list.numElements,e=0;t>e;e++){var i=this.list.getElementAt(e);if(i&&i.visible){var n=i.data,a=i.getImgIcon().localToGlobal(),o=n.id,s=ObjPool.pop(BaseImage);s.source=ResMgr.getItemIcon(Cfg.getItemCfg(o).getIcon(),IconType.IT_80x80),s.anchorOffsetX=0,s.anchorOffsetY=0,s.x=a.x-10,s.y=a.y,LayerMgr.Popup.addChild(s);var r=getWin(XunBaoWin);if(r){var u=r.getBagTab();GFunc.flyToBag1(s,u)}if(9==e)break}}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.buyXunBao10:this.sendChouJiang(1);break;case this.buyXunBao50:this.sendChouJiang(2)}},e.prototype.updateConsume=function(){this.updateSingleConsume(1,this.imgXunBao10,this.lbXunBao10),this.updateSingleConsume(2,this.imgXunBao50,this.lbXunBao50)},e.prototype.updateSingleConsume=function(t,e,i){var n=this.data.equipid,a=BagSys.ins().getItemCount(n),o=Cfg.getItemCfg(n),s=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.data.equipid),r=s.price,u=ResMgr.getItemIcon(o.getIcon()),h=ResMgr.getItemIcon(Cfg.getItemCfg(CurType.yb).getIcon()),p=(this.data.costitem,this.data.costitem[t][1]),l=p>a&&this.isUseYb,c=(p-a)*r;
i.text=l?""+c:a+"/"+p,e.source=l?h:u},Object.defineProperty(e.prototype,"isUseYb",{get:function(){return 1==TipsSys.ins().saveReminds[this.data.getPanelName()]},enumerable:!0,configurable:!0}),e.prototype.sendChouJiang=function(t){var e=this,i=this.data.costitem[t][1],n=new ItemDataReward;n.id=this.data.equipid,n.count=i;var a=BagSys.ins().getItemCount(this.data.equipid),o=i-a;if(GFunc.isConsumeEnough(n))XunBaoSys.ins().sendXunBaoChouJiang(this.data.type,t+1);else if(this.isUseYb){var s=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.data.equipid);GFunc.checkCurrency(CurType.yb,s.price*i)&&XunBaoSys.ins().sendXunBaoChouJiang(this.data.type,t+1,1)}else{var s=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,this.data.equipid);if(GFunc.checkCurrency(CurType.yb,s.price)){var r=new BuyData;r.setBuyFun(function(t){var i=Cfg.getConfig(StoreItemConfig,CondType.Equal,StoreItemConfig.itemId,e.data.equipid);ShopSys.ins().sendItemShopBuy([[i.index,t]])}),r.price=s.price,r.itemId=this.data.equipid,r.limitCount=0,r.count=o,r.consumeItemId=CurType.yb,r.saveKey=this.data.getPanelName(),openWin(BuyWin1,r)}}},e}(BaseWin);__reflect(XunBaoRewardListTipsWin.prototype,"XunBaoRewardListTipsWin"),window.XunBaoRewardListTipsWin=XunBaoRewardListTipsWin;var XunBaoTab=function(t){function e(){var e=t.call(this)||this;return e.skinName="BtnTab5ZYCSSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=""+t.tabName},e.prototype.updateRedPoint=function(t){this.redPoint.visible=t},e}(BaseItemRender);__reflect(XunBaoTab.prototype,"XunBaoTab"),window.XunBaoTab=XunBaoTab;var XunBaoWin=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[ExtCom],e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[XunBaoMainPanel,XunBaoBagPanel,XunBaoDuiHuanPanel]},enumerable:!0,configurable:!0}),e.prototype.getBagTab=function(){return this.getTab(XunBaoBagPanel)},e.prototype.getXunBaoBagPanel_getBuyAllQuChu=function(){return this.getPanel(XunBaoBagPanel).getBuyAllQuChu()},e.prototype.getXunBaoEquipPanel_MianFeiXunBaoBtn=function(){return this.getPanel(XunBaoMainPanel).getXunBaoEquipPanel_MianFeiXunBaoBtn()},e.prototype.getXunBaoFaBaoPanel_MianFeiXunBaoBtn=function(){return this.getPanel(XunBaoMainPanel).getXunBaoFaBaoPanel_MianFeiXunBaoBtn()},e.prototype.getXunBaoFaBaoPanel_Tab=function(){return this.getPanel(XunBaoMainPanel).getTab(XunBaoFaBaoPanel)},e.prototype.getXunBaoEquipPanel_Tab=function(){return this.getPanel(XunBaoMainPanel).getTab(XunBaoEquipPanel)},e}(BaseDuoPanelWin);__reflect(XunBaoWin.prototype,"XunBaoWin"),window.XunBaoWin=XunBaoWin;var XunBaoZhiZunPanel=function(t){function e(){var e=t.call(this)||this;return e.lbGuangGao.source="xb_zycs_zzmsz",e.imgTitle.source="xb_zycs_zzxb",e}return __extends(e,t),e.prototype.updateTime=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts5);if(t&&t.isOpenActivity())this.lbDoubleTimer.text=t.getformatTime();else{var e=XunBaoSys.ins().getDoubleTimer();e>0?this.lbDoubleTimer.text=""+getFormatTime(e,"dd天hh小时mm分ss秒"):this.lbDoubleTimer.text=""}},e.prototype.updateState=function(){var t=ActSys.ins().getActDataByIds(Cfg.getConfig(XunbaoConstConfig).acts5);t&&t.isOpenActivity()?this.currentState="act":this.currentState=XunBaoSys.ins().isDoubleTimer()?"7day":"none",this.validateNow()},e.getTitle=function(){return"btz_zycs_wmjt"},e.getTabTitle=function(){return"仙宫寻宝"},e.getSysId=function(){return SysId.XunBaoZhiZun},Object.defineProperty(e.prototype,"data",{get:function(){return XunBaoSys.ins().getXunBaoDataByType(XunbaoType.ZhiZun)},enumerable:!0,configurable:!0}),e}(XunBaoEquipPanel);__reflect(XunBaoZhiZunPanel.prototype,"XunBaoZhiZunPanel"),window.XunBaoZhiZunPanel=XunBaoZhiZunPanel;var YdssTabItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="YdssTabEUI",e.redPoint.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.btn_name.source="xianyuanhd_title"+(this.itemIndex+1),this.lbYuan.visible=!1,this.priceNum.visible=!1,2!=this.itemIndex){var t=this.data,e=t.config;this.priceNum.visible=!0,this.priceNum.setType(e.currencyType),this.priceNum.setPrice(e.price),this.priceNum.labelColor=16768995,this.redPoint.visible=t.redPoint()}else{var i=ActSys.ins().getActDataById(2002),n=i.getItemDatas();this.redPoint.visible=n[0].status==ActRewardState.CanGet,this.lbYuan.visible=!0;var a=MathUtil.toInteger(n[0].dabiao/100);this.lbYuan.textFlow=addColorTF("累充"+a+"元")}},e}(BaseItemRender);__reflect(YdssTabItem.prototype,"YdssTabItem"),window.YdssTabItem=YdssTabItem;var YdssWin=function(t){function e(){var e=t.call(this)||this;return e.mcBtn=new MC,e.mcBtn2=new MC,e.skinName="YdssWinEUI",e.layer=LayerMgr.Popup,e.addBg(),e.tabList.itemRenderer=YdssTabItem,e.tabList.dataProvider=e.tabData=new eui.ArrayCollection,e.list.itemRenderer=ItemBaseReward,e.list.dataProvider=e.listData=new eui.ArrayCollection,e.btn_get.redPoint.visible=!0,e.mcBtn.x=e.btn_get.width/2,e.mcBtn.y=e.btn_get.height/2,e.mcBtn.playFile(ResMgr.getEffName("public_zycs_button01"),-1),e.btn_get.addChildAt(e.mcBtn,e.btn_get.numChildren-1),e.mcBtn2.x=e.btn_get1.width/2,e.mcBtn2.y=e.btn_get1.height/2,e.mcBtn2.playFile(ResMgr.getEffName("public_zycs_button01"),-1),e.btn_get.addChildAt(e.mcBtn2,e.btn_get1.numChildren-1),e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.curIndex=e,this.group1.visible=!0,this.group2.visible=!this.group1.visible,this.addLsn(RpSys.ins().patchRp,this.infoPanel),this.addLsn(ActSys.ins().patchActivityPanel,this.infoPanel),this.addLsn(ActSys.ins().doRewardResult,this.infoPanel),this.addClickE(this.btn_go,this.onClick),this.addClickE(this.btn_get,this.onClick),this.addClickE(this.btn_go1,this.onClick),this.addClickE(this.btn_get1,this.onClick),this.addClickE(this.btn_buy,this.onClick),this.addItemTapE(this.tabList,this.onItemList),this.infoPanel()},e.prototype.infoPanel=function(){var t=[];this.actData22_1=ActSys.ins().getActDataById(2003);var e=t.concat(this.actData22_1.buyDatas);this.group.visible=!1,this.actData=ActSys.ins().getActDataById(2002),this.actData.getActOpenState()==ActOpenState.Open&&(this.group.visible=!0,e.push([])),this.tabData.source=e,isNaN(this.curIndex)?this.updateState():(this.tabList.selectedIndex=this.curIndex,this.updatePanel())},e.prototype.updateState=function(){var t=this.tabList.selectedIndex>=0?this.tabList.selectedIndex:0;this.tabList.selectedIndex=t,this.updatePanel()},e.prototype.updatePanel=function(){this.group1.visible=this.group2.visible=!1,this.img_tips.source="xianyuanhd_tips"+(this.tabList.selectedIndex+1),this.lb_name.text=Cfg.getConfig(MateCommonConfig).names[this.tabList.selectedIndex],this.tabList.selectedIndex>1?this.setStateGroup2():this.setStateGroup1()},e.prototype.setStateGroup2=function(){this.group2.visible=!0;var t=this.actData.getItemDatas();this.btn_go1.visible=t[0].status==ActRewardState.NotReached,this.btn_get1.visible=t[0].status==ActRewardState.CanGet,this.btn_get1.redPoint.visible=this.btn_get1.visible,this.imgYlq.visible=t[0].status==ActRewardState.Geted,this.listData.source=t[0].config.rewards;var e=t[0],i=MathUtil.toInteger(e.dabiao/100),n=MathUtil.toInteger(e.yidabiao/100),a="累计充值："+addColor(i+"元",46913)+"可领取\n已充值："+addColor(n+"元",46913);this.lb_tips.textFlow=addColorTF(a)},e.prototype.setStateGroup1=function(){this.group1.visible=!0,this.actData22_1=ActSys.ins().getActDataById(2003);var t=this.actData22_1.buyDatas[this.tabList.selectedIndex],e=t.config;this.listData.source=e.rewards,this.oldPrice.setType(e.currencyType),this.oldPrice.setPrice(e.yuanprice),this.nowPrice.setType(e.currencyType),this.nowPrice.setPrice(e.price);var i=Actor.ins().getCurrency(e.currencyType),n=t.count;this.btn_get.visible=this.btn_buy.visible=this.btn_go.visible=this.imgYgm.visible=!1,1==n?this.imgYgm.visible=!0:0==n?i>=e.price?(this.btn_buy.visible=!0,this.btn_buy.redPoint.visible=!0):i<e.price&&(this.btn_go.visible=!0):this.imgYgm.visible=!0},e.prototype.onClick=function(t){var i=this;switch(t.target){case this.btn_go:case this.btn_go1:openWin(RechargeWin),closeWin(e);break;case this.btn_get:break;case this.btn_get1:if(BagSys.ins().checkBagFreeCount(5)){var n=this.actData.getItemDatas(),a=n[0],o=a.config;ActSys.ins().sendReward(o.id,o.index)}break;case this.btn_buy:var s=this.actData22_1.getConfig(this.tabList.selectedIndex);if(BagSys.ins().checkBagFreeByItems(s.rewards)&&GFunc.checkCurrency(s.currencyType,s.price)){var r=new PopupPriceData("仙侣特惠礼包");r.priceValue=s.price,r.priceType=s.currencyType,r.setFunction(this,function(){ActSys.ins().sendReward(2003,i.tabList.selectedIndex+1)}),openWin(CommonTipsWinNew,r)}}},e.prototype.onItemList=function(t){this.updatePanel()},e.prototype.updateTime=function(){this.actData?this.lb_time.textFlow=addColorTF(this.actData.getformatTime()):this.lb_time.textFlow=addColorTF("")},__decorate([callDelay(100)],e.prototype,"updateState",null),e}(BaseWinSingle);__reflect(YdssWin.prototype,"YdssWin"),window.YdssWin=YdssWin;var YdssData=function(){function t(){}return t}();__reflect(YdssData.prototype,"YdssData");var YongZheFirstData=function(){function t(){this.playname="",this._state=0}return t.prototype.setState=function(t){this._state=t},t.prototype.getState=function(){var t=this._state;return!t&&FbSys.ins().yongZheModel.firstFloor>=this.id?1:1==t?2:0},t}();__reflect(YongZheFirstData.prototype,"YongZheFirstData"),window.YongZheFirstData=YongZheFirstData;var YongZheFirstRewardWinItemData=function(){function t(){this.state=0}return Object.defineProperty(t.prototype,"conf",{get:function(){return Cfg.getConfig(YongzheFubenConfig,this.id)},enumerable:!0,configurable:!0}),t}();__reflect(YongZheFirstRewardWinItemData.prototype,"YongZheFirstRewardWinItemData"),window.YongZheFirstRewardWinItemData=YongZheFirstRewardWinItemData;var YongZheModel=function(){function t(){this.floorId=0,this.firstFloor=0,this.firstDatas=[],this.gqStates=[],this.challengeResult=!0}return t.prototype.parser=function(t){this.floorId=t.readShort(),this.firstFloor=t.readShort();for(var e=Cfg.getConfigLength(YongzheFubenConfig),i=t.readShort(),n=0;e>n;n++){var a=i>n?t.readByte():0;this.gqStates[n]=a}i=t.readShort();for(var n=0;e>n;n++){var a=i>n?t.readByte():0,o=new YongZheFirstData;this.firstDatas[n]=o,o.id=n+1,o.setState(a)}},t.prototype.updateFirstPlayName=function(t){for(var e=t.readShort(),i=0;e>i;i++){var n=this.firstDatas[i];n||(this.firstDatas[i]=n=new YongZheFirstData,n.id=i+1),n.playname=t.readString()}},t.prototype.getGQState=function(t){var e=this.gqStates[t-1];if(e)e=2;else{var i=Cfg.getConfig(YongzheFubenConfig,t);i.customReward&&i.customReward.length&&this.floorId>t&&(e=1)}return isNaN(e)?0:e},t.prototype.isChallenge=function(){var t=Cfg.getConfigLength(YongzheFubenConfig);if(t<this.floorId)return!1;var e=Cfg.getConfig(YongzheFubenConfig,this.floorId);if(e.zslevel>Actor.ins().zsId){Cfg.getConfig(ZhuanShengLevelConfig,e.zslevel);return!1}return!0},t}();__reflect(YongZheModel.prototype,"YongZheModel"),window.YongZheModel=YongZheModel;var YongZheBossInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName="YongZheBossInfoEUI",e.list.itemRenderer=ItemBaseReward,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e.btn.name="bossbtn",e}return __extends(e,t),e.prototype.setData=function(t){this.conf=t,this.udpateView()},e.prototype.getData=function(){return this.conf},e.prototype.udpateView=function(){this.listArr.source=this.conf.bossReward.concat();var t=FbSys.ins().yongZheModel;this.btn.enabled=t.floorId==this.conf.id&&t.isChallenge()},e}(eui.Component);__reflect(YongZheBossInfo.prototype,"YongZheBossInfo"),window.YongZheBossInfo=YongZheBossInfo;var YongZheBossItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="YongZheBossItemEUI",e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t){this.conf=t,this.headIcon.source=ResMgr.getMonsterHead(t.head),this.lbgq.text=Lang.fb_str380.replace("$guan$",""+t.index),this.setActivate()},e.prototype.getData=function(){return this.conf},e.prototype.setActivate=function(){this.headIcon.filters=this.conf.id<=FbSys.ins().yongZheModel.floorId?null:DisUtil.grayFilter(),this.imgytg.visible=this.conf.id<FbSys.ins().yongZheModel.floorId},e.prototype.setSelect=function(t){this.selectImg.visible=t},e.prototype.getSelect=function(){return this.selectImg.visible},e}(eui.Component);__reflect(YongZheBossItem.prototype,"YongZheBossItem"),window.YongZheBossItem=YongZheBossItem;var YongZheBossList=function(t){function e(){var e=t.call(this)||this;e.skinName="YongZheBossListEUI",e.bosslist=[e.boss0,e.boss1,e.boss2];for(var i=0,n=e.bosslist;i<n.length;i++){var a=n[i];e.addClickE(a,e.onClick)}return e}return __extends(e,t),e.prototype.onClick=function(t){e.clickCheng(t.target)},e.clickCheng=function(t){return t},e.prototype.setData=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(this.bosslist[e].setData(i),t[e].customReward&&t[e].customReward.length){var n=FbSys.ins().yongZheModel.getGQState(i.id);this.gqReward.setData([i,n])}}},e.prototype.setSelect=function(t,e){this.bosslist[t].setSelect(e)},e.prototype.getSelectData=function(){for(var t=0,e=this.bosslist;t<e.length;t++){var i=e[t];if(i.getSelect())return i.getData()}},__decorate([post()],e,"clickCheng",null),e}(BaseEUI);__reflect(YongZheBossList.prototype,"YongZheBossList"),window.YongZheBossList=YongZheBossList;var YongZheFirstRewardWin=function(t){function e(){var e=t.call(this)||this;return e.layer=LayerMgr.Popup,e.skinName="YongZheFirstRewardWinEUI",e.addBg(),e.list.itemRenderer=YongZheFirstRewardWinItem,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this);var e=FbSys.ins();this.addClickE(this.list,this.onClickList),this.addLsn(e.patchYongZheFirstPlayInfo,this.updateView),this.addLsn(e.patchYongZheReceiveReward,this.updateView),e.sendYongZheFirstPlayInfo()},e.prototype.udpateReceiveReward=function(t){},e.prototype.updateView=function(){var t=FbSys.ins().yongZheModel,e=Cfg.getConfigs(YongzheFubenConfig),i=[],n=t.firstDatas,a=-1,o=-1;for(var s in e){var r=e[s];if(!(t.firstFloor+2<r.id)){var u=r.id-1,h=n[u],p=new YongZheFirstRewardWinItemData;p.id=r.id,h&&(p.playname=h.playname,p.state=h.getState()),-1==a&&1==p.state&&(a=u),-1==o&&0==p.state&&(o=u),i[u]=p}}-1==a&&(a=-1==o?0:o),this.listArr.source=i,this.list.validateNow(),this.updatescroller(a)},e.prototype.updatescroller=function(t){var e=164,i=3,n=t+1,a=n*e+(n-1)*i,o=a-e;this.scroller.viewport.scrollV=o},e.prototype.onClickList=function(t){if("btn"==t.target.name){var e=this.list.selectedItem;FbSys.ins().sendYongZheReceiveReward(2,e.id)}},e}(BaseWinSingle);__reflect(YongZheFirstRewardWin.prototype,"YongZheFirstRewardWin"),window.YongZheFirstRewardWin=YongZheFirstRewardWin;var YongZheFirstRewardWinItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="YongZheFirstRewardItemEUI",e.list.itemRenderer=ItemBaseReward,e.list.dataProvider=e.listArr=new eui.ArrayCollection,e.btn.name="btn",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof YongZheFirstRewardWinItemData){this.lbName.text=this.data.playname,this.lbName.visible=!!this.data.playname,this.imgxwyd.visible=!this.data.playname;var t=this.data.conf;switch(this.lbFloor.text=""+t.name+t.index+Lang.common_guan,this.listArr.source=t.firstReward.concat(),this.data.state){case 0:this.lbreceive.visible=this.btn.visible=!1;break;case 1:this.btn.visible=!0,this.btn.redPoint.visible=!0,this.lbreceive.visible=!1;break;case 2:this.btn.visible=!1,this.lbreceive.visible=!0}}},e}(BaseItemRender);__reflect(YongZheFirstRewardWinItem.prototype,"YongZheFirstRewardWinItem"),window.YongZheFirstRewardWinItem=YongZheFirstRewardWinItem;var YongZheGQReward=function(t){function e(){var e=t.call(this)||this;return e.skinName="YongZheGQRewardEUI",e.mc=GFunc.playUIMovie("eff7",42,40,e.gqReward2,-1),e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t){this._datas=t,this.updateView()},e.prototype.getData=function(){return this._datas},e.prototype.updateView=function(){var t=this._datas[0],e=t.customReward[0];this.gqReward2.data=e;var i=this._datas[1],n=Cfg.getItemCfg(e.id);this.itemname.text=n.getName(),this.itemname.textColor=16708501;var a=addColor(Lang.fb_str379.replace("$guan$",""+t.index),14969600);this.lbgq2.textFlow=addColorTF(a),this.imgState.visible=0!=i,(2==i||1==i)&&(this.imgState.source=2==i?"lilian_zycs_ylq1":"jzhd_zycs_klq");var o=2!=i;o&&(this.gqReward2.setItemKuangEffect(!0,"eff6"),this.gqReward2.setItemEffect(!1)),this.mc.visible=o,this.red.visible=1==i},e}(BaseEUI);__reflect(YongZheGQReward.prototype,"YongZheGQReward"),window.YongZheGQReward=YongZheGQReward;var YongZhePanel=function(t){function e(){var e=t.call(this)||this;e.selectIndex=-1,e.skinName="YongZhePanelEUI",e.bossListArr=[e.bosslist0,e.bosslist1,e.bosslist2],e.floorTab.itemRenderer=BaseTabBtn5_1;for(var i=Cfg.getConfig(YongzheFubenConfig,FbSys.ins().yongZheModel.floorId),n=Cfg.getConfigs(YongzheFubenConfig,CondType.LessEqual,"floor",i.floor+1),a=n.length,o=Math.ceil(a/9),s=[],r=1;o>=r;r++){var u=Cfg.getConfig(YongzheFubenConfig,CondType.Equal,"floor",r);u&&s.push([u.name])}return e.floorTab.dataProvider=e.tabArr=new eui.ArrayCollection(s),e.floorTab.validateNow(),e}return __extends(e,t),e.prototype.open=function(){var t=FbSys.ins();this.addLsn(t.patchUpdateYongZheInfo,this.updateBossList),this.addLsn(t.patchYongZheReceiveReward,this.receiveReward),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(YongZheBossList.clickCheng,this.onBoosClick),this.addItemTapE(this.floorTab,this.onFloorTab),this.addClickE(this,this.onClick),this.setTab(),this.updateRp()},e.prototype.receiveReward=function(t){1==t&&this.setTab()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),null==t||t.check(e)){var i=RpSys.ins();this.btnReward.redPoint.visible=i.getData(ExtCom,FuBenWin,FuBenDanRenPanel,e,"first"),this.btnShop.redPoint.visible=i.getData(ExtCom,FuBenWin,FuBenDanRenPanel,e,"shop");for(var n=this.tabArr.source,a=n.length,o=0;a>o;o++)n[o][1]=i.getData(ExtCom,FuBenWin,FuBenDanRenPanel,e,o+1);this.tabArr.replaceAll(n)}},e.prototype.setTab=function(){var t=this;this.selectIndex=-1;var e=FbSys.ins().yongZheModel,i=e.floorId;if(0==i)i=1;else{for(var n=Cfg.getConfigs(YongzheFubenConfig,CondType.Less,"floor",i),a=0,o=n;a<o.length;a++){var s=o[a],r=e.getGQState(s.id);if(1==r){i=s.id;break}}var u=Cfg.getConfigLength(YongzheFubenConfig);i>u&&(i=u)}var h=Cfg.getConfig(YongzheFubenConfig,i),p=h.zslevel<=Actor.ins().zsId?h.floor-1:h.floor-2;p=0>p?0:p,this.floorTab.selectedIndex=p,this.updateBossList(),Timer.ins()["do"](50,1,1,function(){t.updateFirstTab(p)},this)},e.prototype.updateFirstTab=function(t){var e=this.floorTab.getVirtualElementAt(0).width,i=0|this.floorTab.layout.gap,n=t+1,a=n*e+(n-1)*i,o=a-e;this.tabScroller.viewport.scrollH=o},e.prototype.updateTabScroller=function(){var t=this.floorTab.getVirtualElementAt(0).width,e=0|this.floorTab.layout.gap,i=this.floorTab.selectedIndex+1,n=i*t+(i-1)*e,a=this.tabScroller.viewport.scrollH+this.tabScroller.width,o=n-t,s=0;n>a?s=n-a:o<this.tabScroller.viewport.scrollH&&(s=o-this.tabScroller.viewport.scrollH),s&&(this.tabScroller.viewport.scrollH+=s)},e.prototype.onGqRewardClick=function(t){var e=t.getData(),i=e[0],n=e[1];1==n?FbSys.ins().sendYongZheReceiveReward(1,i.id):GFunc.showRewardTips(i.customReward[0])},e.prototype.onClick=function(t){var e=(FbSys.ins().yongZheModel,t.target);if("bossbtn"==e.name)return void FbSys.ins().doYongZheChallenge();if(e instanceof YongZheGQReward)return void this.onGqRewardClick(e);switch(e){case this.btnReward:openWin(YongZheFirstRewardWin);break;case this.btnShop:openWin(ShopWin,ShopWin.getTabIndexbyPanel(ShopYongZhePanel))}},e.prototype.onBoosClick=function(t){var e=t.getData().index-1;this.selectIndex!=e&&(this.selectIndex=e,this.setBossSelect(e))},e.prototype.setBossSelect=function(t){for(var e,i=0;9>i;i++){var n=Math.floor(i/3),a=i%3,o=i==t;this.bossListArr[n].setSelect(a,o),o&&(e=this.bossListArr[n].getSelectData())}this.bossinfo.setData(e);var s=Math.floor(t/3)+1;this.bossinfo.parent.addChildAt(this.bossinfo,s)},e.prototype.onFloorTab=function(t){this.selectIndex=-1,this.updateTabScroller(),this.updateBossList()},e.prototype.updateBossList=function(){var t=FbSys.ins().yongZheModel,e=this.floorTab.selectedIndex+1,i=Cfg.getConfigs(YongzheFubenConfig,CondType.Equal,"floor",e);if(this.bosslist0.setData(i.slice(0,3)),this.bosslist1.setData(i.slice(3,6)),this.bosslist2.setData(i.slice(6,9)),-1==this.selectIndex){var n=Cfg.getConfigLength(YongzheFubenConfig),a=t.floorId<=n?t.floorId:n,o=Cfg.getConfig(YongzheFubenConfig,a);o.floor==e?this.selectIndex=o.index-1:this.selectIndex=0,this.setBossSelect(this.selectIndex)}},e.getTitle=function(){return"btz_zycs_fb"},e.getTabTitle=function(){return"fb_zycs_yzzt"},e.getSysId=function(){return SysId.YongZheTa},e}(BasePanel);__reflect(YongZhePanel.prototype,"YongZhePanel"),window.YongZhePanel=YongZhePanel;var YZZHData=function(){function t(){this.saiji=1,this.jieduan=1,this.buyShengHui=!1,this.isGetExp=!1,this.exp=0,this.level=0,this.taskData1=[],this.taskData2=[],this.rewardDatas=[],this.expDatas=[]}return t.prototype.iniData=function(){for(var t=Cfg.getConfigs(YongZheLevelConfig,this.jieduan),e=0;e<t.length;e++){t[e]}},t.prototype.parser=function(t){this.saiji=t.readByte(),this.saiji<=0||(this.jieduan=t.readByte(),this.buyShengHui=1==t.readByte(),this.parserExpReward(t),this.level=t.readShort(),this.exp=t.readInt(),this.parserReward(t),this.parserJieDuanTask(t),this.parserSaiJiTask(t))},t.prototype.parserReward=function(t){this.rewardDatas.length=0;for(var e=Cfg.getConfigs(YongZheRewardConfig,this.saiji),i=0;i<e.length;i++){var n=e[i],a=new YZZHRewardData;a.level=n.level,a.saiji=this.saiji,this.rewardDatas.push(a)}for(var o=t.readShort(),i=0;o>i;i++){var a=this.rewardDatas[i];a.parser(t)}},t.prototype.parserJieDuanTask=function(t){var e=t.readShort();this.taskData1.length=0;for(var i=0;e>i;i++){var n=new YZZHJieDuanTaskData;n.parser(t),n.taskId=i+1,n.saiji=this.saiji,n.jieduan=this.jieduan,this.taskData1.push(n)}},t.prototype.parserSaiJiTask=function(t){var e=t.readShort();this.taskData2.length=0;for(var i=0;e>i;i++){var n=new YZZHSaiJiTaskData;n.parser(t),n.taskId=i+1,n.saiji=this.saiji,this.taskData2.push(n)}},t.prototype.parserExpReward=function(t){var e=t.readByte();this.expDatas.length=0;for(var i=Cfg.getConfig(YongZheSaiJiConfig,this.saiji).exp,n=0;e>n;n++){var a=new YZZHExpData;a.parser(t),a.id=n+1,a.jieduan=this.jieduan,a.saiji=this.saiji,a.exp=i[n],this.expDatas.push(a)}},t.prototype.parserJieDuanTaskUpdate=function(t){var e=t.readByte(),i=t.readInt(),n=t.readInt(),a=t.readInt(),o=t.readByte(),s=1==e?this.getTackJieDuanDataById(i):this.getTackSaiJiDataById(i);s?(s.value=n,s.finishCount=a,s.state=o):console.log("27-93 任务不存在 type:"+e+"  id "+i)},t.prototype.parserJieDuanTaskGet=function(t){var e=t.readByte(),i=t.readInt(),n=t.readByte(),a=t.readShort();this.level=t.readShort(),this.exp=t.readInt();var o=1==e?this.getTackJieDuanDataById(i):this.getTackSaiJiDataById(i);o?(o.state=n,o.finishCount=a,showtipsSuc("经验+"+o.config.exp)):console.log("27-94 任务不存在 type:"+e+"  id "+i)},t.prototype.getTackJieDuanDataById=function(t){for(var e,i=(this.taskData1.length,0);i<this.taskData1.length;i++){var n=this.taskData1[i];if(n.taskId==t){e=n;break}}return e},t.prototype.getTackSaiJiDataById=function(t){for(var e,i=(this.taskData2.length,0);i<this.taskData2.length;i++){var n=this.taskData2[i];if(n.taskId==t){e=n;break}}return e},t.prototype.parserGetExp=function(t){this.level=t.readShort(),this.exp=t.readInt();var e=t.readByte(),i=t.readByte();this.expDatas[e-1].state=i},t.prototype.parserGetReward=function(t){var e=t.readByte(),i=t.readInt(),n=t.readByte(),a=this.rewardDatas[i-1];return a?1==e?a.state1=n:a.state2=n:console.log("27-96 奖励id不存在:"+i),a},Object.defineProperty(t.prototype,"nextExp",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMax",{get:function(){return this.level>=Cfg.getMaxConfig(YongZheLevelConfig).level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openTime",{get:function(){var t=Cfg.getConfig(YongZheConfig),e=t.openTime+this.saiji*GConst.saijiZhouqi;return e-GConst.saijiZhouqi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endTime",{get:function(){var t=Cfg.getConfig(YongZheConfig),e=t.openTime+this.saiji*GConst.saijiZhouqi;return 1e3*e-Actor.ins().serverTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jieduanEndTime",{get:function(){var t=(Cfg.getConfig(YongZheConfig),this.openTime+GConst.jieduanZhouqi*this.jieduan);return 1e3*t-Actor.ins().serverTime},enumerable:!0,configurable:!0}),t.prototype.getExp=function(){for(var t=this.taskData1.length,e=0,i=0;t>i;i++){var n=this.taskData1[i];e+=n.config.exp*n.finishCount}return e},t.prototype.maxExp=function(){for(var t=this.taskData1.length,e=0,i=0;t>i;i++){var n=this.taskData1[i];e+=n.config.exp*n.config.done}return e},t.prototype.saijiTaskExp=function(){for(var t=this.taskData2.length,e=0,i=0;t>i;i++){var n=this.taskData2[i];2==n.state&&(e+=n.config.exp)}return e},t.prototype.saijiTaskMaxExp=function(){for(var t=this.taskData2.length,e=0,i=0;t>i;i++){var n=this.taskData2[i];e+=n.config.exp}return e},t.prototype.getCanGetIndex=function(){var t=this.getCanGetIndexxxx();return-1==t?0==this.level?0:this.level-1:t},t.prototype.getCanGetIndexxxx=function(){for(var t=this.rewardDatas.length,e=-1,i=0;t>i;i++){var n=this.rewardDatas[i];if(n.canGet1||n.canGet2){e=i;break}}return e},t.prototype.getCanGetIndex1=function(){for(var t=this.rewardDatas.length,e=-1,i=0;t>i;i++){var n=this.rewardDatas[i];if(n.canGet1){e=i;break}}return e},t.prototype.getCanGetIndex2=function(){var t=this.rewardDatas.length,e=-1;if(this.buyShengHui)for(var i=0;t>i;i++){var n=this.rewardDatas[i];if(n.canGet2){e=i;break}}return e},t.prototype.getShengHuiExp=function(){for(var t=0,e=0;e<this.expDatas.length;e++){var i=this.expDatas[e];2==i.status&&(t+=i.exp)}return t},t.prototype.getShengHuiSumExp=function(){for(var t=0,e=0;e<this.expDatas.length;e++){var i=this.expDatas[e];t+=i.exp}return t},Object.defineProperty(t.prototype,"nextLevel",{get:function(){var t=Cfg.getMaxConfig(YongZheLevelConfig).level;return this.level>=t?t:this.level+1},enumerable:!0,configurable:!0}),t.prototype.isOpen=function(){return this.saiji>0},t}();__reflect(YZZHData.prototype,"YZZHData"),window.YZZHData=YZZHData;var YZZHExpData=function(){function t(){this.saiji=1,this.jieduan=1,this.id=0,this.exp=0,this.state=0,this.clickRedPint=!0}return t.prototype.parser=function(t){this.state=t.readByte()},t.prototype.getOpenTime=function(){var t=Cfg.getConfig(YongZheConfig),e=t.openTime+this.saiji*GConst.saijiZhouqi-GConst.saijiZhouqi;return e+(this.id-1)*GConst.jieduanZhouqi},t.prototype.isAct=function(){return 1==this.state},t.prototype.canGet=function(){return 0==this.state&&Actor.ins().serverTime/1e3>this.getOpenTime()},t.prototype.noGet=function(){return Actor.ins().serverTime/1e3<this.getOpenTime()},Object.defineProperty(t.prototype,"status",{get:function(){return Actor.ins().serverTime/1e3<this.getOpenTime()?0:1==this.state?2:1},enumerable:!0,configurable:!0}),t}();__reflect(YZZHExpData.prototype,"YZZHExpData"),window.YZZHExpData=YZZHExpData;var YZZHJieDuanTaskData=function(){function t(){this.taskId=1,this.type=1,this.saiji=1,this.jieduan=1,this.state=0,this.value=0,this.finishCount=0}return t.prototype.parser=function(t){this.state=t.readByte(),this.value=t.readInt(),this.finishCount=t.readShort()},Object.defineProperty(t.prototype,"config",{get:function(){return(null==this._config||this._config.id!=this.taskId)&&(this._config=Cfg.getConfig(YongZheTaskConfig,this.jieduan,this.taskId)),this._config},enumerable:!0,configurable:!0}),t.prototype.isAct=function(){return 2==this.state},t.prototype.canAct=function(){return 1==this.state},Object.defineProperty(t.prototype,"sort",{get:function(){return 2==this.state?0:1==this.state?2:1},enumerable:!0,configurable:!0}),t}();__reflect(YZZHJieDuanTaskData.prototype,"YZZHJieDuanTaskData"),window.YZZHJieDuanTaskData=YZZHJieDuanTaskData;var YZZHRewardData=function(){function t(){this.level=1,this.saiji=1,this.jieduan=1,this.state1=0,this.state2=0}return t.prototype.parser=function(t){this.state1=t.readByte(),this.state2=t.readByte()},Object.defineProperty(t.prototype,"configReward",{get:function(){return this._configReward||(this._configReward=Cfg.getConfig(YongZheRewardConfig,this.saiji,this.level))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canGet1",{get:function(){return 0==this.state1&&RechargeActSys.ins().yzzhData.level>=this.configReward.level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canGet2",{get:function(){var t=RechargeActSys.ins().yzzhData;return t.buyShengHui&&0==this.state2&&t.level>=this.configReward.level},enumerable:!0,configurable:!0}),t}();__reflect(YZZHRewardData.prototype,"YZZHRewardData"),window.YZZHRewardData=YZZHRewardData;var YZZHSaiJiTaskData=function(){function t(){this.taskId=1,this.type=2,this.saiji=1,this.state=0,this.value=0,this.finishCount=0}return t.prototype.parser=function(t){this.state=t.readByte(),this.value=t.readInt(),this.finishCount=t.readShort()},Object.defineProperty(t.prototype,"config",{get:function(){return(null==this._config||this._config.id!=this.taskId)&&(this._config=Cfg.getConfig(YongZheSeasonTaskConfig,this.saiji,this.taskId)),this._config},enumerable:!0,configurable:!0}),t.prototype.isAct=function(){return 2==this.state},t.prototype.canAct=function(){return 1==this.state},Object.defineProperty(t.prototype,"sort",{get:function(){return 2==this.state?0:1==this.state?2:1},enumerable:!0,configurable:!0}),t}();__reflect(YZZHSaiJiTaskData.prototype,"YZZHSaiJiTaskData"),window.YZZHSaiJiTaskData=YZZHSaiJiTaskData;var YZZHActWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="YZZHActWinEUI",this.addBg(),this.mcBg=new MC,this.groupMC.addChild(this.mcBg),this.mcIcon=new McIcon,this.mcIcon.touchEnabled=!1,this.mcIcon.touchChildren=!1,this.groupMC.addChild(this.mcIcon),this.list.itemRenderer=ItemBase},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick),this.addLsn(RechargeActSys.ins().patchYZZHBuyUpdate,this.updatePanel),this.updatePanel()},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this),this.mcIcon.close()},e.prototype.updatePanel=function(){var t=RechargeActSys.ins().yzzhData,e=Cfg.getConfig(YongZheConfig),i=Cfg.getConfigs(YongZheRewardConfig,RechargeActSys.ins().yzzhData.saiji,CondType.LessEqual,YongZheRewardConfig.level,80);SortUtil.sortOn(i,["sort"],[SortType.up]);for(var n=[],a=0;a<i.length;a++){var o=i[a];n.push(GFunc.creatItemDataByReward(o.reward2))}this.list.dataProvider=new eui.ArrayCollection(n);var s=Cfg.getConfig(YongZheSaiJiConfig,t.saiji);this.lblRewardName1.textFlow=StrUtil.toTF(s.rewardName),this.lblRewardDesc.textFlow=StrUtil.toTF(s.rewardDesc),this.lbDianQuan.text=e.dianquan.toString(),this.btnBuy.label=Cfg.getPayMoneyRMBByYb(e.vipExp)+"元激活",this.mcIcon.open(s.mcIcon),this.lb_name.text=s.rewardName},e.prototype.onClick=function(t){switch(t.target){case this.btnBuy:var e=Cfg.getConfig(YongZheConfig);VipSys.ins().showReCharge(e.vipExp),closeWin(this)}},e}(BaseWin);__reflect(YZZHActWin.prototype,"YZZHActWin"),window.YZZHActWin=YZZHActWin;var YZZHBuyLevelWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addBg(),this.list1.itemRenderer=ItemBase,this.list1.dataProvider=this.list1Array=new eui.ArrayCollection,this.list2.itemRenderer=ItemBase,this.list2.dataProvider=this.list2Array=new eui.ArrayCollection
},e.prototype.setSkinName=function(){this.skinName="YZZHBuyLevelWinEUI"},e.prototype.open=function(){var e=new BuyDataNoLimit;e.setBuyFun(function(t){RechargeActSys.ins().sendYZZHBuyLevel(RechargeActSys.ins().yzzhData.level+t)}),e.itemId=0,e.price=0,e.consumeItemId=CurType.JinZuan,e.limitCount=80-RechargeActSys.ins().yzzhData.level,t.prototype.open.call(this,e),this.num=this.defaultBuyLevel(),this.updateView(),this.addClickE(this.add10Btn,this.onTap),this.addClickE(this.sub10Btn,this.onTap),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.add10Btn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.sub10Btn,this.onAddBegin),this.addEvent(egret.TouchEvent.TOUCH_END,this,this.onAddend)},e.prototype.defaultBuyLevel=function(){for(var t=1,e=RechargeActSys.ins().yzzhData,i=e.rewardDatas,n=0;n<i.length;n++){var a=i[n];if(a.level>e.level&&a.level%10==0){t=a.level;break}}return t-e.level},e.prototype.updatePanel=function(){var t=RechargeActSys.ins().yzzhData,e=(this.num+t.level,this.getConfigs());SortUtil.sortOn(e,["sort"],[SortType.up]);for(var i=[],n=[],a=0;a<e.length;a++){var o=e[a];i.push(GFunc.creatItemDataByReward(o.reward)),n.push(GFunc.creatItemDataByReward(o.reward2))}this.list1Array.source=i,this.list2Array.source=n},e.prototype.getConfigs=function(){for(var t=RechargeActSys.ins().yzzhData,e=this.num+t.level,i=Cfg.getConfigs(YongZheRewardConfig,RechargeActSys.ins().yzzhData.saiji,CondType.LessEqual,YongZheRewardConfig.level,e).concat(),n=(i.length,t.level-1);n>=0;n--){i[n];i.splice(n,1)}return i},e.prototype.updatePrice=function(){this.allPrice.setType(CurType.JinZuan),this.allPrice.setPrice(this.price),this.updatePanel(),this.lbDesc.visible=!0,this.lbDesc.textFlow=addColorTF("购买"+addColor(this.num.toString(),13967392)+"级升到"+(this.num+RechargeActSys.ins().yzzhData.level)+"级"),this.lbLevelDesc.textFlow=addColorTF("升至"+(this.num+RechargeActSys.ins().yzzhData.level)+"级立即获得以下奖励")},Object.defineProperty(e.prototype,"price",{get:function(){for(var t=RechargeActSys.ins().yzzhData,e=this.num+t.level,i=Cfg.getConfigs(YongZheLevelConfig,CondType.LessEqual,YongZheLevelConfig.level,e),n=0,a=t.level;a<i.length-1;a++){var o=i[a];n+=o.price}return n},enumerable:!0,configurable:!0}),e.prototype.AddNum=function(e){switch(t.prototype.AddNum.call(this,e),e){case this.sub10Btn:this.num-=10;break;case this.add10Btn:this.num<this.buyData.limitCount?this.num<this.buyData.maxBuyCount?this.num+=10:showtipsFail(Lang.shop_str18.replace("$name$",Cfg.getItemCfg(this.buyData.consumeItemId).getName())):(this.isAutoAdd=!1,Timer.ins().remove(this.AddNum,this),showtipsFail(Lang.shop_str2))}this.numLabel.text=this.num.toString(),this.updatePrice()},e.prototype.buy=function(t){var e=GFunc.creatRewardDataById(this.buyData.consumeItemId,this.price);this.buyData.limitCount>0?GFunc.checkConsumeEnough(e)&&(this.buyData.buyFun.obj=this,this.buyData.buyFun.param=[this.num],this.buyData.buyFun.call(),closeWin(this)):showtipsFail(Lang.shop_str2)},e}(BuyWinBase);__reflect(YZZHBuyLevelWin.prototype,"YZZHBuyLevelWin"),window.YZZHBuyLevelWin=YZZHBuyLevelWin;var YZZHMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[YZZHWin],e.helpId1=105,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[YZZHPanel,YZZHTaskPanel]},enumerable:!0,configurable:!0}),e.prototype.setSkinName=function(){this.skinName="YZZHMainPanelEUI"},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn3},e.prototype.open=function(e){void 0===e&&(e=0),t.prototype.open.call(this,e),this.addClickE(this,this.onClick)},e.getTitle=function(){return"btz_zycs_yzsh"},e.getTabTitle=function(){return"bqz_zycs_yzsh"},e.prototype.getJinZuanBagPanelTab=function(){return this.getTab(YZZHPanel)},e.prototype.onClick=function(t){switch(t.target){case this.helpBtn:openWin(HelpWin,Cfg.getConfig(HelpInfoConfig,this.helpId1).text)}},e}(BaseTabPanel);__reflect(YZZHMainPanel.prototype,"YZZHMainPanel"),window.YZZHMainPanel=YZZHMainPanel;var YZZHPanel=function(t){function e(){var e=t.call(this)||this;e.mcBtnAct=new MC,e.mcLiZi=new MC,e.page=1,e.setSkinName(),e.list.dataProvider=e.listArray=new eui.ArrayCollection,e.list.itemRenderer=YZZHPanelRewardItem,e.list.useVirtualLayout=!0,e.mcSH=new MC,e.mcSH.x=120,e.mcSH.y=142,e.groupMC.addChild(e.mcSH),e.mcIcon=new McIcon,e.mcIcon.touchEnabled=!1,e.mcIcon.touchChildren=!1,e.groupEntity.addChild(e.mcIcon),e.mcBtnAct.x=e.btnAct.width/2,e.mcBtnAct.y=e.btnAct.height/2,e.btnAct.addChildAt(e.mcBtnAct,e.btnAct.numChildren),e.groupMC.touchEnabled=!1,e.groupMC.touchChildren=!1;var i=MC.create(ResMgr.getEffName("public_zycs_button02"),-1);return i.x=62,i.y=30.5,e.btnOneKey.addChild(i),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="YZZHPanelEUI"},e.prototype.open=function(){this.addClickE(this,this.onClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(RechargeActSys.ins().patchYZZHBuyLevel,this.updateExpLevel),this.addLsn(RechargeActSys.ins().patchYZZHJieDuanTaskGet,this.updateExpLevel),this.addLsn(RechargeActSys.ins().patchYZZHGetReward,this.updateReward),this.addLsn(RechargeActSys.ins().patchYZZHBuyUpdate,this.updateActUpdate),this.list.dataProvider.addEventListener(eui.CollectionEvent.COLLECTION_CHANGE,this.updateNextReward,this),this.scroller.addEventListener(eui.UIEvent.CHANGE_START,this.updateNextReward,this),this.scroller.addEventListener(eui.UIEvent.CHANGE_END,this.updateNextReward,this),this.list.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onListClick,this),this.updatePanel(),this.updateRp()},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this),this.mcIcon.close(),this.scroller.removeEventListener(eui.UIEvent.CHANGE_START,this.updateNextReward,this),this.scroller.removeEventListener(eui.UIEvent.CHANGE_END,this.updateNextReward,this),this.list.dataProvider.removeEventListener(eui.CollectionEvent.COLLECTION_CHANGE,this.updateNextReward,this),this.list.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onListClick,this)},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),null==t||t.check(e)){for(var i=this.list.numChildren,n=0;i>n;n++){var a=this.list.getChildAt(n);a&&a.updateRedPoint()}this.updatePageBtn()}},e.prototype.updatePanel=function(){var t=RechargeActSys.ins().yzzhData,e=Cfg.getConfig(YongZheSaiJiConfig,t.saiji);this.imgBg.source="yzsh_zycs_bg"+t.saiji+"_jpg",this.bitSaiJi.text=t.saiji.toString(),this.lbUpLevelDesc.textFlow=addColorTF("升至"+addColor("[指定等级]",5767068)+" 领取"+addColor("[全部等级奖励]",5767068)),this.lblRewardName1.textFlow=StrUtil.toTF(e.rewardName),this.lblRewardDesc.textFlow=StrUtil.toTF(e.rewardDesc);var i=addColor(DateUtil.formatTime(t.endTime,"dd天hh小时"),5767068);this.lblActTime.textFlow=addColorTF("剩余时间："+i),this.mcIcon.open(e.mcIcon);var n=t.getCanGetIndex();this.page=n>=80?2:1,this.updateList(),this.setListIndex(n),this.updateExpLevel(),this.updateStatus(),this.updateNextReward(),this.updateBtnState()},e.prototype.updateBtnState=function(){var t=RechargeActSys.ins().yzzhData;this.btnOneKey.visible=!!~t.getCanGetIndexxxx(),this.btnBuyLevel.visible=!this.btnOneKey.visible},e.prototype.updateList=function(){this.listArray.source=this.getDatalist(),this.scroller.validateNow(),this.updatePageBtn()},e.prototype.getDatalist=function(){var t=[],e=RechargeActSys.ins().yzzhData;e.rewardDatas.length;if(1==this.page)for(var i=0;i<e.rewardDatas.length&&(t.push(e.rewardDatas[i]),80!=t.length);i++);else for(var i=80;i<e.rewardDatas.length;i++)t.push(e.rewardDatas[i]);return t},e.prototype.updatePageBtn=function(){if(1==this.page){this.btnLastPage.visible=!1;var t=this.scroller.viewport.scrollV>=this.scroller.viewport.contentHeight-this.scroller.height;if(this.btnNextPage.visible=t,t){var e=RechargeActSys.ins().yzzhData;e.rewardDatas.length;this.btnNextPage.redPoint.visible=!1;for(var i=80;i<e.rewardDatas.length;i++)if(e.rewardDatas[i].canGet1||e.rewardDatas[i].canGet2){this.btnNextPage.redPoint.visible=t;break}}}else{var t=this.scroller.viewport.scrollV<=0;if(t){var e=RechargeActSys.ins().yzzhData;e.rewardDatas.length;this.btnLastPage.redPoint.visible=!1;for(var i=0;80>i;i++){var n=e.rewardDatas[i];if(n&&(n.canGet1||n.canGet2)){this.btnLastPage.redPoint.visible=t;break}}}this.btnLastPage.visible=t,this.btnNextPage.visible=!1}},e.prototype.updateExpLevel=function(){var t=RechargeActSys.ins().yzzhData,e=Cfg.getConfig(YongZheLevelConfig,t.level);this.bitLevel.text=t.nextLevel.toString(),t.isMax?this.progressExp.maximum=this.progressExp.value=t.exp:(this.progressExp.maximum=e.exp,this.progressExp.value=t.exp),this.updateBtnState()},e.prototype.updateReward=function(t){void 0===t&&(t=null);for(var e=RechargeActSys.ins().yzzhData,i=this.list.numChildren,n=0;i>n;n++){var a=this.list.getElementAt(n);if(a){var o=a.data;(null==t||t.level==o.level)&&a.updateData()}}var s=e.getCanGetIndex();this.setListIndex(s),this.updateBtnState()},e.prototype.updateActUpdate=function(t){this.updateReward(),this.updateStatus()},e.prototype.updateStatus=function(){var t=RechargeActSys.ins().yzzhData;this.btnAct.visible=!t.buyShengHui,this.lbAct.visible=t.buyShengHui,t.buyShengHui?(this.mcBtnAct.visible=!1,this.mcBtnAct.stop()):(this.mcSH.visible=!1,this.mcSH.stop())},e.prototype.updateNextReward=function(){var t=(RechargeActSys.ins().yzzhData,null),e=null,i=0,n=this.listArray.source.length,a=99,o=(this.list.layout.gap,this.listArray.source[this.listArray.source.length-1]),s=Math.floor(this.list.scrollV/a);s=s==n?n-1:s;for(var r=s;n>r&&(o=this.listArray.source[r],o.level%5!=0);r++);t=o.configReward.reward,e=o.configReward.reward2,i=o.level,this.lbLevelReward.text=i+"级可领取",this.comItem1.data=t,this.comItem1.visible=t,this.lbLevelReward1.visible=!t,this.comItem2.data=e,this.comItem2.visible=t,this.lbLevelReward2.visible=!t,this.updatePageBtn()},e.prototype.setListIndex=function(t){t=t>=80?t-80:t;var e=this.list.layout.gap,i=99*t+e,n=this.scroller.viewport.contentHeight-this.scroller.height;i>=n&&(i=n),0>i&&(i=0),this.scroller.viewport.scrollV=i},e.prototype.onClick=function(t){var e=RechargeActSys.ins().yzzhData;switch(t.target){case this.imgShengHui:case this.btnAct:0==e.buyShengHui&&openWin(YZZHActWin);break;case this.btnBuyLevel:e.level>=80?showtipsFail("等级已达80级,不可购买!"):openWin(YZZHBuyLevelWin);break;case this.btnRewardView:openWin(YZZHRewardViewWin);break;case this.btnLastPage:this.page=1,this.scroller.viewport.scrollV=0,this.updateList();break;case this.btnNextPage:this.page=2,this.scroller.viewport.scrollV=0,this.updateList();break;case this.btnOneKey:for(var i=e.rewardDatas,n=i.length,a=0;n>a;a++){var o=i[a];o.canGet1&&RechargeActSys.ins().sendYZZHGetReward(1,o.level),o.canGet2&&RechargeActSys.ins().sendYZZHGetReward(2,o.level)}}},e.prototype.onListClick=function(t){var e=t.target.parent,i=e.data;"comItem1"==t.target.name&&(i.canGet1?RechargeActSys.ins().sendYZZHGetReward(1,i.level):GFunc.openItemTips(i.configReward.reward)),"comItem2"==t.target.name&&(i.canGet2?RechargeActSys.ins().sendYZZHGetReward(2,i.level):GFunc.openItemTips(i.configReward.reward2))},e.getTitle=function(){return"btz_zycs_yzsh"},e.getTabTitle=function(){return"奖励"},e.getSysId=function(){return SysId.YZZH},e}(BasePanel);__reflect(YZZHPanel.prototype,"YZZHPanel"),window.YZZHPanel=YZZHPanel;var YZZHPanelRewardItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="YZZHPanelRewardItemEUI",e.comItem1.touchChildren=!1,e.comItem2.touchChildren=!1,e.comItem1.name="comItem1",e.comItem2.name="comItem2",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.configReward;this.bitLevel.text=""+e.level,this.comItem1.data=e.reward,this.comItem1.visible=null!=e.reward,this.comItem2.data=e.reward2,this.comItem2.visible=null!=e.reward2,this.lbNoReward1.visible=null==e.reward,this.lbNoReward2.visible=null==e.reward2,this.updateRedPoint()},e.prototype.updateData=function(){this.dataChanged()},e.prototype.updateRedPoint=function(){var t=this.data;this.imgKlq1.visible=t.canGet1,this.imgYlq1.visible=1==t.state1,this.imgKlq2.visible=t.canGet2,this.imgYlq2.visible=1==t.state2,this.imgLock.visible=!RechargeActSys.ins().yzzhData.buyShengHui,this.imgLevelBg.visible=1==t.state1||t.canGet1,RechargeActSys.ins().yzzhData.level>t.level?(this.imgBg.source="qianglong_bg2",this.imgXian.visible=!1,this.imgLvSeXian.source="yzsh_zycs_jdt3"):RechargeActSys.ins().yzzhData.level==t.level?(this.imgBg.source="qianglong_bg2",this.imgXian.visible=!0,this.imgLvSeXian.source="yzsh_zycs_jdt3"):(this.imgXian.visible=!1,this.imgBg.source="qianlong_bg6",this.imgLvSeXian.source="yzsh_zycs_jdt4")},e}(BaseItemRender);__reflect(YZZHPanelRewardItem.prototype,"YZZHPanelRewardItem"),window.YZZHPanelRewardItem=YZZHPanelRewardItem;var YZZHRewardViewWin=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="YZZHRewardViewWinEUI",this.addBg(),this.list1.itemRenderer=ItemBaseReward,this.list2.itemRenderer=ItemBaseReward},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick);var e=Cfg.getConfig(YongZheSaiJiConfig,RechargeActSys.ins().yzzhData.saiji);this.list2.dataProvider=new eui.ArrayCollection(e.maxReward1),this.list1.dataProvider=new eui.ArrayCollection(e.maxReward2);var i=RechargeActSys.ins().yzzhData;this.btnGotoAct.visible=!i.buyShengHui,this.lbAct.visible=i.buyShengHui},e.prototype.onClick=function(t){switch(t.target){case this.btnGotoAct:openWin(YZZHActWin),closeWin(this)}},e}(BaseWin);__reflect(YZZHRewardViewWin.prototype,"YZZHRewardViewWin"),window.YZZHRewardViewWin=YZZHRewardViewWin;var YZZHTaskPanel=function(t){function e(){var e=t.call(this)||this;e.selectIndex=0,e.skinName="YZZHTaskPanelEUI",e.list1.itemRenderer=YZZHTaskPanelJieDuanItem,e.list1.useVirtualLayout=!0,e.list2.itemRenderer=YZZHTaskPanelSaijiItem,e.list2.useVirtualLayout=!0,e.listExp.itemRenderer=YZZHTaskPanelExpItem,e.listExp.useVirtualLayout=!0,e.lbUpLevelDesc.textFlow=addColorTF("升至"+addColor("[指定等级]",16767625)+" 领取"+addColor("[全部等级奖励]",16767625));var i=[{source:"yzsh_zycs_jdtz",source1:"yzsh_zycs_jdtz_a"},{source:"yzsh_zycs_shjy",source1:"yzsh_zycs_shjy_a"},{source:"yzsh_zycs_sjtz",source1:"yzsh_zycs_sjtz_a"}];return e.tabType.dataProvider=new eui.ArrayCollection(i),e.list1.dataProvider=e.listItemArray1=new eui.ArrayCollection,e.list2.dataProvider=e.listItemArray2=new eui.ArrayCollection,e.listExp.dataProvider=e.listExpArray=new eui.ArrayCollection,e}return __extends(e,t),e.playPiao=function(t){return t},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this,this.onClick),this.addItemTapE(this.tabType,this.onItemClick),this.addLsn(RpSys.ins().patchRp,this.updateRp),this.addLsn(RechargeActSys.ins().patchYZZHBuyLevel,this.updateExpLevel),this.addLsn(RechargeActSys.ins().patchYZZHJieDuanTaskGet,this.updateList),this.addLsn(RechargeActSys.ins().patchYZZHBuyUpdate,this.updateList),this.addLsn(RechargeActSys.ins().patchYZZHJieDuanTaskUpdate,this.updateList),this.addLsn(RechargeActSys.ins().patchYZZHGetExp,this.updateExpList),this.addLsn(e.playPiao,this.playPiaoMc);var i=this.getAutoIndex();this.setState(i),this.tabType.selectedIndex=this.selectIndex=i,this.updateData(),this.updateRp(),this.updateTime()},e.prototype.updateRp=function(t){if(void 0===t&&(t=null),null==t||t.check(e)){this.tabType.validateNow(),this.tabType.numElements>0&&(this.tabType.getElementAt(0).redPoint.visible=RpSys.ins().getData(YZZHWin,YZZHMainPanel,e,YZZHTaskPanelJieDuanItem),this.tabType.getElementAt(1).redPoint.visible=RpSys.ins().getData(YZZHWin,YZZHMainPanel,e,YZZHTaskPanelSaijiItem),this.tabType.getElementAt(2).redPoint.visible=RpSys.ins().getData(YZZHWin,YZZHMainPanel,e,YZZHTaskPanelExpItem));for(var i=this.listExp.numElements,n=0;i>n;n++){var a=this.listExp.getElementAt(n);a&&a.updateRedPoint()}}},e.prototype.updateData=function(){RechargeActSys.ins().yzzhData;this.updateList(),this.updateExpLevel(),this.updateExpList()},e.prototype.updateTime=function(){var t=RechargeActSys.ins().yzzhData,e=t.endTime,i=DateUtil.isDayTime(e)?"dd天hh小时mm分钟":"hh小时mm分钟ss秒";this.lbSaiJiEndTime.textFlow=addColorTF("本赛季任务结束倒计时:"+addColor(DateUtil.formatTime(e,i),16767625)),this.lbExpEndTime.textFlow=addColorTF("神龙令经验领取倒计时:"+addColor(DateUtil.formatTime(e,i),16767625));var n=t.jieduanEndTime;i=DateUtil.isDayTime(n)?"dd天hh小时mm分钟":"hh小时mm分钟ss秒",this.lbJieDuanEndTime.textFlow=addColorTF("本阶段任务结束倒计时:"+addColor(DateUtil.formatTime(n,i),16767625))},e.prototype.updateList=function(){var t=RechargeActSys.ins().yzzhData,e=t.taskData1.concat(),i=t.taskData2.concat();SortUtil.sortOn(e,["sort","taskId"],[SortType.down,SortType.up]),SortUtil.sortOn(i,["sort","taskId"],[SortType.down,SortType.up]),this.listItemArray1.source=e,this.listItemArray2.source=i},e.prototype.updateExpList=function(){var t=RechargeActSys.ins().yzzhData;this.listExpArray.source=t.expDatas},e.prototype.updateExpLevel=function(){var t=RechargeActSys.ins().yzzhData,e=Cfg.getConfig(YongZheLevelConfig,t.level);this.bitLevel.text=t.nextLevel.toString(),this.progressExp.maximum=e.exp,this.progressExp.value=t.exp,this.lbTaskCount.textFlow=addColorTF(t.saijiTaskExp()+"/"+t.saijiTaskMaxExp()),this.lbExp.textFlow=addColorTF(t.getExp()+"/"+t.maxExp()),this.lbExpCouont.textFlow=addColorTF(t.getShengHuiExp()+"/"+t.getShengHuiSumExp()),t.isMax?this.progressExp.maximum=this.progressExp.value=e.exp:(this.progressExp.maximum=e.exp,this.progressExp.value=t.exp),this.updateExpList()},e.prototype.onItemClick=function(t){this.selectIndex!=t.itemIndex&&(this.selectIndex=t.itemIndex,this.setState(this.selectIndex))},e.prototype.setState=function(t){this.currentState="s"+t,this.validateNow()},e.prototype.getAutoIndex=function(){return RpSys.ins().getData(YZZHWin,YZZHMainPanel,e,YZZHTaskPanelJieDuanItem)?0:RpSys.ins().getData(YZZHWin,YZZHMainPanel,e,YZZHTaskPanelSaijiItem)?1:RpSys.ins().getData(YZZHWin,YZZHMainPanel,e,YZZHTaskPanelExpItem)?2:0},e.prototype.onClick=function(t){var e=RechargeActSys.ins().yzzhData;switch(t.target){case this.btnBuyLevel:e.level>=80?showtipsFail("等级已达80级,不可购买!"):openWin(YZZHBuyLevelWin)}},e.prototype.playPiaoMc=function(t){var e=this;this.globalToLocal(t.x,t.y,t);var i=new MC;i.playFile(getEffName("bluesoul1"),-1),i.x=t.x+50,i.y=t.y+50,this.addChild(i);var n=egret.Tween.get(i);n.to({x:this.progressExp.x+this.progressExp.width/2,y:this.progressExp.y+this.progressExp.height/2},1300,egret.Ease.sineInOut).call(function(){e.removeChild(i),e.updateExpLevel()})},e.getTitle=function(){return"btz_zycs_yzsh"},e.getTabTitle=function(){return"任务"},e.getSysId=function(){return SysId.YZZH},__decorate([post()],e,"playPiao",null),e}(BasePanel);__reflect(YZZHTaskPanel.prototype,"YZZHTaskPanel"),window.YZZHTaskPanel=YZZHTaskPanel;var YZZHTaskPanelExpItem=function(t){function e(){var e=t.call(this)||this;return e.mcBtnOk=new MC,e.skinName="YZZHTaskPanelExpItemEUI",e.btnOk.redPoint.visible=!0,e.mcBtnOk.x=e.btnOk.width/2,e.mcBtnOk.y=e.btnOk.height/2,e.mcBtnOk.scaleX=.9,e.mcBtnOk.scaleY=.8,e.btnOk.addChildAt(e.mcBtnOk,e.btnOk.numChildren-1),e.addClickE(e.btnOk,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data,i=RechargeActSys.ins().yzzhData;if(i.buyShengHui)RechargeActSys.ins().sendYZZHGetExp(e.id),YZZHTaskPanel.playPiao(this.btnOk.localToGlobal(0,0));else{var n=Cfg.getConfig(YongZheSaiJiConfig,i.saiji),a=new PopupData,o=n.exp[i.jieduan-1];a.desc="激活"+addColor("[神龙令]",16751375)+"每阶段可以免费领取"+addColor(o.toString(),5767068)+"点"+addColor("额外升级经验",16751375)+",是否前往激活?",a.setFunction(this,function(){openWin(YZZHActWin)}),openWin(CommonTipsWin,a),e.clickRedPint=!1,RpFun.showYZZHBoxRedPoint()}},e.prototype.dataChanged=function(){var t=this.data;this.lbExp.text="+"+t.exp,this.lbName.textFlow=addColorTF("赛季阶段"+GFunc.getChineseNum(t.id)),this.lbDesc.text="购买神龙令可领取"+t.exp+"exp",this.lbTime.text=DateUtil.formatDayTime(1e3*t.getOpenTime(),"yy.mo.dd")+"可领取",this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this.data;this.currentState=t.status.toString();var i=RpSys.ins().getData(YZZHWin,YZZHMainPanel,YZZHTaskPanel,e,t.id);i?(this.mcBtnOk.playFile(ResMgr.getEffName("pubbtn"),-1),this.btnOk.redPoint.visible=!0):(this.btnOk.redPoint.visible=!1,this.mcBtnOk.visible=!1,this.mcBtnOk.stop())},e}(BaseItemRender);__reflect(YZZHTaskPanelExpItem.prototype,"YZZHTaskPanelExpItem"),window.YZZHTaskPanelExpItem=YZZHTaskPanelExpItem;var YZZHTaskPanelJieDuanItem=function(t){function e(){var e=t.call(this)||this;return e.mcBtnOk=new MC,e.skinName="YZZHTaskPaneTaskItemEUI",e.btnOk.redPoint.visible=!0,e.mcBtnOk.x=e.btnOk.width/2,e.mcBtnOk.y=e.btnOk.height/2,e.mcBtnOk.scaleX=.9,e.mcBtnOk.scaleY=.8,e.btnOk.addChildAt(e.mcBtnOk,e.btnOk.numChildren-1),e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;switch(t.target){case this.btnOk:RechargeActSys.ins().sendYZZHJieDuanTaskGet(e.type,e.taskId),YZZHTaskPanel.playPiao(this.btnOk.localToGlobal(0,0));break;case this.btnGoto:var i=e.config,n=GFunc.createTaskNavData(i.controlTarget);n.setsucceedFrontFun(function(){closeWin(YZZHWin)}),n["goto"]()}},e.prototype.dataChanged=function(){var t=this.data,e=t.config;this.lbExp.text="+"+e.exp;var i=addColor("("+t.value+"/"+e.target+")",t.value>=e.target?5767068:16727614);this.lbName.textFlow=addColorTF(""+e.name+i),this.lbDesc.text=e.desc,this.lbCount.textFlow=addColorTF("完成次数:"+addColor("("+t.finishCount+"/"+e.done+")",5767068)),this.currentState=t.state.toString(),1==t.state?this.mcBtnOk.playFile(ResMgr.getEffName("pubbtn"),-1):(this.mcBtnOk.visible=!1,this.mcBtnOk.stop())},e}(BaseItemRender);__reflect(YZZHTaskPanelJieDuanItem.prototype,"YZZHTaskPanelJieDuanItem"),window.YZZHTaskPanelJieDuanItem=YZZHTaskPanelJieDuanItem;var YZZHTaskPanelSaijiItem=function(t){function e(){var e=t.call(this)||this;return e.mcBtnOk=new MC,e.skinName="YZZHTaskPaneTaskSaiJiItemEUI",e.btnOk.redPoint.visible=!0,e.mcBtnOk.x=e.btnOk.width/2,e.mcBtnOk.y=e.btnOk.height/2,e.mcBtnOk.scaleX=.9,e.mcBtnOk.scaleY=.8,e.btnOk.addChildAt(e.mcBtnOk,e.btnOk.numChildren-1),e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;switch(t.target){case this.btnOk:RechargeActSys.ins().sendYZZHJieDuanTaskGet(e.type,e.taskId),YZZHTaskPanel.playPiao(this.btnOk.localToGlobal(0,0));break;case this.btnGoto:var i=e.config,n=GFunc.createTaskNavData(i.controlTarget);n.setsucceedFrontFun(function(){closeWin(YZZHWin)}),n["goto"]()}},e.prototype.dataChanged=function(){var t=this.data,e=t.config;this.lbExp.text="+"+e.exp;var i=addColor("("+t.value+"/"+e.target+")",t.value>=e.target?5767068:15733780);this.lbName.textFlow=addColorTF(""+e.name+i),this.lbDesc.text=e.desc,this.currentState=t.state.toString(),1==t.state?this.mcBtnOk.playFile(ResMgr.getEffName("pubbtn"),-1):(this.mcBtnOk.visible=!1,this.mcBtnOk.stop()),this.lbCount.text=""},e}(BaseItemRender);__reflect(YZZHTaskPanelSaijiItem.prototype,"YZZHTaskPanelSaijiItem"),window.YZZHTaskPanelSaijiItem=YZZHTaskPanelSaijiItem;var YZZHWin=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[],e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[YZZHMainPanel]},enumerable:!0,configurable:!0}),e}(BaseDuoPanelWin);__reflect(YZZHWin.prototype,"YZZHWin"),window.YZZHWin=YZZHWin;var ZhuangBanWin=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[RoleWin,RolePanel],e.winType=WinType.OverlayWin,e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ChengHaoPanel,FootPanel,ShengLingPanel,ShenYouPanel]},enumerable:!0,configurable:!0}),e}(BaseWinAutoTab);__reflect(ZhuangBanWin.prototype,"ZhuangBanWin"),window.ZhuangBanWin=ZhuangBanWin;var ChengHaoInfo=function(){function t(t){this.endTime=0,this.power=0,this.config=t}return t.prototype.getPower=function(){return this.power<=0&&(this.power=GFunc.getPower(this.config.attrs)),this.power},t}();__reflect(ChengHaoInfo.prototype,"ChengHaoInfo"),window.ChengHaoInfo=ChengHaoInfo;var ChengHaoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChengHaoItemEUI",e.attrs.dataProvider=e.attrDatas=new eui.ArrayCollection([]),e.timeTxt.visible=!1,e.addClickE(e,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){switch(t.target){case this.btnSet:case this.btnSet1:var e=this.data;e.config.Id!=ChengHaoSys.ins().showID?ChengHaoSys.ins().sendChangeShow(e.config.Id):ChengHaoSys.ins().sendChangeShow(0)}},e.prototype.dataChanged=function(){if(this.data instanceof ChengHaoInfo){var t=this.data;if(this.imgMC=getEffName("ch_zycs_"+t.config.img),this.labRare.textFlow=addColorTF(""+Lang.zb_str2+StrUtil.addColor(Lang.common_xiyoudu[t.config.rare],GConst.rareColor[t.config.rare])),this.totalPower.text=t.getPower().toFixed(0),this.updateTime(),this.attrDatas.replaceAll(StrUtil.strsToTF(AttrData.parse(t.config.attrs))),t.endTime>=0){t.config.Id==ChengHaoSys.ins().showID?(this.btnSet.label=Lang.fuwen_str1,this.btnSet.visible=!0,this.btnSet1.visible=!1):(ChengHaoSys.ins().showID?this.btnSet1.label=Lang.zb_str3:this.btnSet1.label=Lang.zb_str4,this.btnSet1.visible=!0,this.btnSet.visible=!1),this.lackImg.visible=!1;var e=DateUtil.formatMiniDateTime(t.endTime);this.timeTxt.text=""+Lang.zb_str5+(0==t.endTime?Lang.common_str87:new Date(e).toLocaleDateString())}else this.btnSet.visible=!1,this.btnSet1.visible=!1,this.lackImg.visible=!0}},e.prototype.updateTime=function(){var t=this.data,e=""+t.config.condition;if(t.endTime>0){var i=DateUtil.formatMiniDateTime(t.endTime)-Actor.ins().serverTime;i>0&&(e+="\n"+StrUtil.addColor(Lang.common_str11+getFormatTime(i/1e3,"dd天hh小时mm分钟ss秒"),5949490))}this.frontTxt.textFlow=addColorTF(e)},e}(BaseItemRender);__reflect(ChengHaoItem.prototype,"ChengHaoItem"),window.ChengHaoItem=ChengHaoItem;var ChengHaoPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChengHaoPanelEUI",e.attrsTotal.dataProvider=e.attrsTotalDatas=new eui.ArrayCollection([]),e.list.itemRenderer=ChengHaoItem,e.list.dataProvider=e.arrDatas=new eui.ArrayCollection([]),e.setRedPointHead(ForgeWin),e}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=0),e=0,t.prototype.open.call(this,e),this.addLsn(ChengHaoSys.ins().patchListUpdate,this.updateList),this.addLsn(ChengHaoSys.ins().patchUpdateShow,this.updateList),0==ChengHaoSys.ins().infoList.length?ChengHaoSys.ins().sendGetList():this.updateList()},e.prototype.updateList=function(){this.attrsTotalDatas.replaceAll(StrUtil.strsToTF(AttrData.parse(ChengHaoSys.ins().getTotalAttrs()))),this.arrDatas.replaceAll(ChengHaoSys.ins().infoList.concat())},e.prototype.updateTime=function(){for(var t=this.list.numChildren-1;t>=0;t--){var e=this.list.getElementAt(t);e&&e.updateTime()}},e.getTitle=function(){return"btz_zycs_ch"},e.getTabTitle=function(){return"bqz_zycs_ch"},e}(BasePanel);__reflect(ChengHaoPanel.prototype,"ChengHaoPanel"),window.ChengHaoPanel=ChengHaoPanel;var ChengHaoSys=function(t){function e(){var e=t.call(this)||this;return e.showID=0,e.infoList=[],e.infoDict={},e.timeDict={},e._totalAttrs={},e.sysId=PackId.Title,e.reg(1,e.patchListUpdate),e.reg(2,e.doAdd),e.reg(3,e.doRemove),e.reg(4,e.patchUpdateShow),e}return __extends(e,t),e.ins=function(){return t.getIns.call(this,e)},e.prototype.sendGetList=function(){this.sendBase(1)},e.prototype.patchListUpdate=function(t){for(var e={},i=t.readInt(),n=0;i>n;++n)e[t.readInt()]=t.readUnsignedInt();this.initList(e),this.showID=t.readInt()},e.prototype.doAdd=function(t){this.change(t.readInt(),t.readUnsignedInt())},e.prototype.doRemove=function(t){this.change(t.readInt(),-1)},e.prototype.sendChangeShow=function(t){var e=this.getBytes(4);e.writeInt(t),this.send(e)},e.prototype.patchUpdateShow=function(t){var e=t.readInt();this.showID=e;var i=LogicSys.ins().centerEntity;return i.data.title=e,i.setTitle(e),e},e.prototype.sortFunc=function(t,e){return t.endTime<0==e.endTime<0?t.config.Id>e.config.Id?1:-1:t.endTime<0?1:-1},e.prototype.initList=function(t){this.timeDict=t,this.infoDict={},this._totalAttrs={},this.infoList=[];var e=Cfg.getConfigs(TitleConfig,CondType.NONE);for(var i in e){var n=new ChengHaoInfo(e[i]);if(n.config.Id in t){n.endTime=t[n.config.Id];for(var a in n.config.attrs)this._totalAttrs[n.config.attrs[a].type]=(this._totalAttrs[n.config.attrs[a].type]||0)+n.config.attrs[a].value}else n.endTime=-1;e[i].isShow&&(this.infoList[this.infoList.length]=this.infoDict[n.config.Id]=n)}this.infoList.sort(this.sortFunc)},e.prototype.change=function(t,e){if(this.infoDict&&t in this.infoDict&&t in this.timeDict!=e>=0){var i=this.infoDict[t];i.endTime=e,0>e?delete this.timeDict[t]:this.timeDict[t]=e,this.infoList.sort(this.sortFunc);for(var n=0>e?-1:1,a=0,o=i.config.attrs;a<o.length;a++){var s=o[a];this._totalAttrs[s.type]=(this._totalAttrs[s.type]||0)+n*s.value}}},e.prototype.getTotalAttrs=function(){for(var t=[],e=this.infoDict[1].config.attrs,i=0,n=e;i<n.length;i++){var a=n[i],o=this._totalAttrs[a.type]?this._totalAttrs[a.type]:0;t.push(new AttrData(a.type,o))}return t},e}(BaseSys);__reflect(ChengHaoSys.prototype,"ChengHaoSys"),SystemMap.BagSys=BagSys.ins.bind(ChengHaoSys),window.ChengHaoSys=ChengHaoSys;var ZhuZaiBossItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhuZaiBossItemEUI",e.listArray=new eui.ArrayCollection,e.list.dataProvider=e.listArray,e.list.itemRenderer=ItemBaseReward,e.lbPaiMin.textFlow=addColorTF(Lang.sjbs_str0,5949490,!0),e.lbPaiMin.name="rank",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.listArray.source=t.getConfig().rewards,this.lbLv.text=GFunc.getZSName(t.getConfig().zslvmin)+"-"+GFunc.getZSName(t.getConfig().zslvmax),this.imgState.visible=!t.isLive,this.imgHead.source=ResMgr.getMonsterHead("monhead"+t.getConfig().head),this.lbBossName.text=t.getConfig().name,FbSys.ins().zhuzaiMode.isCurSelect(t.id)?this.bg.source="zz_zycs_k2":this.bg.source="zz_zycs_k1"},e}(BaseItemRender);__reflect(ZhuZaiBossItem.prototype,"ZhuZaiBossItem"),window.ZhuZaiBossItem=ZhuZaiBossItem;var ZhuZaiBossPanel=function(t){function e(){var e=t.call(this)||this;return e.helpId=40,e.zhuZaiBossItems=[],e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ZhuZaiBossPanelEUI",this.zhuZaiBossItems=[this.zhuZaiBossItem0,this.zhuZaiBossItem1,this.zhuZaiBossItem2,this.zhuZaiBossItem3],this.lbReward.textFlow=addColorTF(Lang.fb_str233,5949490,!0),this.lbIntoCD.visible=!1},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.lbReward,this.onClick),this.addClickE(this.btnInTo,this.onClick),this.addClickE(this.groupItem,this.onItemClick),this.addLsn(FbSys.ins().patchZhuZaiFubenData,this.updateData),this.updateData()},e.prototype.updateData=function(){for(var t=FbSys.ins().zhuzaiMode,e=0;e<t.zhuZaiBosss.length;e++)this.zhuZaiBossItems[e].data=t.zhuZaiBosss[e]},e.prototype.updateTime=function(){var t=FbSys.ins().zhuzaiMode,e=t.leftRefreshTime,i="";1==t.refreshTickType?(this.btnInTo.enabled=!1,i=Lang.fb_str234+addColor(getFormatTime(e/1e3,"hh:mm:ss"),12588052)):(this.btnInTo.enabled=!0,i=t.getZhuZaiBossData().isLive?Lang.fb_str235+addColor(getFormatTime(e/1e3,"hh:mm:ss"),5949490):Lang.sjbs_str3),this.lbTime.textFlow=addColorTF(i)},e.prototype.onClick=function(t){switch(t.target){case this.btnInTo:var e=FbSys.ins().zhuzaiMode;if(e.getZhuZaiBossData().isLive){if(e.intoTime>0)return void showtipsFail(Lang.fb_str236.replace("$time$",""+Math.ceil(e.intoTime/1e3)));e.isIntoFuBen()?(FbSys.ins().sendZhuZaiChallenge(),closeWin(BossWin)):e.leftRefreshTime<=0?showtipsFail(Lang.sjbs_str1):showtipsFail(Lang.sjbs_str2)}else showtipsFail(Lang.sjbs_str3);break;case this.lbReward:openWin(ZhuZaiRewardWin)}},e.prototype.onItemClick=function(t){var e=t.target;if(e&&"rank"==e.name&&e.parent instanceof ZhuZaiBossItem){var i=e.parent,n=i.data;FbSys.ins().sendZhuZaiHurtRank(n.id)}},e.getSysId=function(){return SysId.zhuzai},e.getTitle=function(){return"btz_zycs_sjbs"},e.getTabTitle=function(){return"fb_zycs_zzbs"
},e}(BasePanel);__reflect(ZhuZaiBossPanel.prototype,"ZhuZaiBossPanel"),window.ZhuZaiBossPanel=ZhuZaiBossPanel;var ZhuZaiDamageItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhuZaiDamageItemEUI",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.txt0.text=t.ranl.toString(),this.txt1.text=t.name.toString(),this.txt2.text=t.hurt.toString()},e}(BaseItemRender);__reflect(ZhuZaiDamageItem.prototype,"ZhuZaiDamageItem"),window.ZhuZaiDamageItem=ZhuZaiDamageItem;var ZhuZaiDamageWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZhuZaiDamageWinEUI",this.layer=LayerMgr.Popup,this.addBg(),this.list.itemRenderer=ZhuZaiDamageItem,this.arrCollect=new eui.ArrayCollection,this.list.dataProvider=this.arrCollect},e.prototype.open=function(e){t.prototype.open.call(this),this.updateRank(e)},e.prototype.updateRank=function(t){this.arrCollect.source=t,this.lbZanWu.visible=0==t.length},e}(BaseWinSingle);__reflect(ZhuZaiDamageWin.prototype,"ZhuZaiDamageWin"),window.ZhuZaiDamageWin=ZhuZaiDamageWin;var ZhuZaiFbPanel=function(t){function e(){var e=t.call(this)||this;return e.mcBtnOk=new MC,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ZhuZaiFbPanelEUI",this.list.itemRenderer=ItemBaseRewardEvent},e.prototype.open=function(){t.prototype.open.call(this),this.addClickE(this.lbOk,this.onClick),this.addClickE(this.list,this.onClick),this.addLsn(FbSys.ins().patchZhuZaiReward,this.updateData),this.addLsn(FbSys.ins().patchZhuZaiMyHurt,this.updateHurt),this.addLsn(LogicSys.ins().patchEnterMap,this.updataMapName),this.addLsn(FbSys.ins().patchUpdateFbTime,this.updataMapName),this.addItemTapE(this.list,this.onMenuClick),this.updateData(),this.updataMapName()},e.prototype.updateData=function(){var t=FbSys.ins().zhuzaiMode.getCurRewarData(),e=t.config;this.list.dataProvider=new eui.ArrayCollection(e.rewards),this.updateHurt()},e.prototype.updateHurt=function(){var t=FbSys.ins().zhuzaiMode,e=FbSys.ins().zhuzaiMode.getCurRewarData();this.lbDesc.textFlow=addColorTF(Lang.fb_str372+"·"+e.index);var i=e.config,n=t.getZhuZaiBossData().getConfig().bossId,a=Cfg.getConfig(MonstersConfig,n);(t.myHurt/a.HpMax*100).toFixed(2),(i.damage/a.HpMax*100).toFixed(2);this.lbHurt.textFlow=addColorTF(Lang.fb_str373.replace("$damge$",GFunc.overLength(i.damage,2))),1==e.state?this.currentState="get":this.currentState=t.myHurt>=i.damage?"canget":"noget"},e.prototype.updataMapName=function(){FbSys.ins().commonEndTick>0&&Timer.ins()["do"](0,1e3,0,this.SweepCountDown,this,TimerType.LAST)},e.prototype.SweepCountDown=function(t){this.bmpTime.text=FbSys.ins().surplusTime+"s"},e.prototype.onMenuClick=function(t){var e=FbSys.ins().zhuzaiMode,i=FbSys.ins().zhuzaiMode.getCurRewarData(),n=t.itemRenderer,a=n.data;0==i.state&&e.myHurt>=i.config.damage?(FbSys.ins().sendZhuZaiReward(i.zhuzaiid,i.index),t.stopImmediatePropagation()):GFunc.openItemTips(a)},e.prototype.onClick=function(t){switch(t.target){case this.lbOk:var e=FbSys.ins().zhuzaiMode.getCurRewarData();FbSys.ins().sendZhuZaiReward(e.zhuzaiid,e.index)}},e}(BasePanel);__reflect(ZhuZaiFbPanel.prototype,"ZhuZaiFbPanel"),window.ZhuZaiFbPanel=ZhuZaiFbPanel;var ZhuZaiMainPanel=function(t){function e(){var e=t.call(this)||this;return e.redPointHead=[BossWin],e}return __extends(e,t),Object.defineProperty(e,"panelNames",{get:function(){return[ZhuZaiBossPanel,KlmPanel,MonsterSiegeMainPanel]},enumerable:!0,configurable:!0}),e.prototype.open=function(e){void 0===e&&(e=-1);var i=this.getAotuIndex(e);t.prototype.open.call(this,i),this.observeTabRedPoint()},e.prototype.setTabItem=function(){this.tab.itemRenderer=BaseTabBtn4},e.getSysId=function(){return SysId.zhuzai},e.prototype.setSkinName=function(){this.skinName="FuBenPanelEUI"},e.getTitle=function(){return"btz_zycs_sjbs"},e.getTabTitle=function(){return"fb_zycs_shbs"},e}(BaseTabPanel);__reflect(ZhuZaiMainPanel.prototype,"ZhuZaiMainPanel"),window.ZhuZaiMainPanel=ZhuZaiMainPanel;var ZhuZaiRewardItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhuZaiRewardItemEUI",e.listArray=new eui.ArrayCollection,e.list.dataProvider=e.listArray,e.list.itemRenderer=ItemBaseReward,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.listArray.source=t.rewards,this.rankTxt.text=t.rankdesc},e}(BaseItemRender);__reflect(ZhuZaiRewardItem.prototype,"ZhuZaiRewardItem"),window.ZhuZaiRewardItem=ZhuZaiRewardItem;var ZhuZaiRewardWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.winType=WinType.OverlayWin,this.skinName="ZhuZaiRewardWinEUI",this.list.itemRenderer=ZhuZaiRewardItem,this.list.dataProvider=this.listArray=new eui.ArrayCollection,t.prototype.initUI.call(this)},e.prototype.open=function(){t.prototype.open.call(this),this.tab.dataProvider=new eui.ArrayCollection(["bqz_zycs_syml","bqz_zycs_zxz","bqz_zycs_phs","bqz_zycs_ygtm"]),this.updateData(1)},e.prototype.updateData=function(t){var e=Cfg.getConfigs(ZhuZaiRankRewardConfig,t),i=Cfg.getConfig(ZhuZaiFubenConfig,t);this.listArray.source=e,this.itemReward1.data=i.killDropshow[0],this.itemReward2.data=i.lotteryDropshow[0],this.lbName.text=i.name+" "+GFunc.getZSName(i.zslvmin)},e.prototype.onTabClicked=function(t){if(void 0===t&&(t=null),this.tab.selectedIndex>=0){var e=this.tab.selectedIndex+1;this.updateData(e)}},e}(BaseWinSingle);__reflect(ZhuZaiRewardWin.prototype,"ZhuZaiRewardWin"),window.ZhuZaiRewardWin=ZhuZaiRewardWin;var ZhuZaiBossData=function(){function t(){}return t.prototype.parser=function(t){this.isLive=t.readBoolean(),this.id=t.readInt()},t.prototype.getConfig=function(){return this.zhuZaiFubenConfig||(this.zhuZaiFubenConfig=Cfg.getConfig(ZhuZaiFubenConfig,this.id)),this.zhuZaiFubenConfig},t}();__reflect(ZhuZaiBossData.prototype,"ZhuZaiBossData"),window.ZhuZaiBossData=ZhuZaiBossData;var ZhuZaiDiceData=function(){function t(){}return t.prototype.parser=function(t){this.name=t.readString(),this.point=t.readShort()},t}();__reflect(ZhuZaiDiceData.prototype,"ZhuZaiDiceData"),window.ZhuZaiDiceData=ZhuZaiDiceData;var ZhuZaiHurtRankData=function(){function t(){}return t.prototype.parser=function(t){this.ranl=t.readInt(),this.name=t.readString(),this.hurt=t.readDouble()},t}();__reflect(ZhuZaiHurtRankData.prototype,"ZhuZaiHurtRankData"),window.ZhuZaiHurtRankData=ZhuZaiHurtRankData;