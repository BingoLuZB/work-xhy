function _ip2int(t){var e=0,i=t.split(".");return e=256*Number(i[0])*256*256+256*Number(i[1])*256+256*Number(i[2])+Number(i[3]),e>>>=0}function _int2ip(t){var e,i=new Array;return i[0]=t>>>24>>>0,i[1]=t<<8>>>24>>>0,i[2]=t<<16>>>24,i[3]=t<<24>>>24,e=String(i[0])+"."+String(i[1])+"."+String(i[2])+"."+String(i[3])}function bezierAbs(t,e,i,n,o){egret.Tween.removeTweens(t);var s="$factor";t[s]=0;var r=t.x,a=t.y,h=egret.Tween.get(t,{onChange:function(){var n=t[s];0!=n&&(t.x=(1-n)*(1-n)*r+2*n*(1-n)*e.x+n*n*i.x,t.y=(1-n)*(1-n)*a+2*n*(1-n)*e.y+n*n*i.y,o&&o())},onChangeObj:t});return h.to({$factor:1},n),h}function bezier(t,e,i,n,o){var s=t.x,r=t.y;return e.x+=s,e.y+=r,i.x+=s,i.y+=r,bezierAbs(t,e,i,n,o)}function getP1ByP0P2(t,e,i){var n=new egret.Point;return n.x=Math.min(t.x+3*(e.x-t.x)/5),n.y=Math.min(e.y,t.y-i),n}var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},Entity=function(t){function e(){var e=t.call(this)||this;e.handle=0,e.role_id=0,e.server_id=0,e.masterHandle=0,e.AI=null,e.mover=null,e.action="a",e.property={},e.atkSpeed=6e3,e.AI=new AIBase,e.AI.setEntity(e),e.mover=new Mover(e),e.frameTick=new FrameTick,e.touchChildren=!1,e.action=EntityAction.STAND,e.dir=5,e._bodyContainer=new egret.DisplayObjectContainer,e.addChild(e._bodyContainer),e._shadow=new eui.Image,e._shadow.source=RES_DIR+"yingzi.png",e._shadow.once(egret.Event.COMPLETE,function(){e._shadow.anchorOffsetX=e._shadow.width>>1,e._shadow.anchorOffsetY=e._shadow.height>>1},e),e._bodyContainer.addChild(e._shadow),e._body=new MovieClip,e._bodyContainer.addChild(e._body),e._hpBar=new eui.ProgressBar,e._hpBar.touchEnabled=!1,e._hpBar.touchChildren=!1,e._hpBar.skinName="bloodBarSkin",e._hpBar.anchorOffsetY=120,e._hpBar.labelDisplay.size=14,e.addChild(e._hpBar),e.topG=new eui.Group;var i=new eui.VerticalLayout;return i.horizontalAlign=egret.HorizontalAlign.CENTER,i.verticalAlign=egret.VerticalAlign.BOTTOM,i.gap=2,e.topG.layout=i,e.topG.touchEnabled=!1,e.topG.width=400,e.topG.height=600,e.topG.anchorOffsetY=766,e.topG.anchorOffsetX=200,e.addChild(e.topG),e.titleImg=new eui.Image,e.titleImg.horizontalCenter=0,e.titleImg.verticalCenter=0,e.titleImg.visible=!1,e.topG.addChild(e.titleImg),e._blTxt=new eui.Label,e._blTxt.fontFamily="黑体",e._blTxt.width=200,e._blTxt.height=14,e._blTxt.textAlign="center",e._blTxt.size=14,e._blTxt.stroke=1,e._blTxt.strokeColor=0,e._blTxt.visible=!1,e._blTxt.verticalAlign="bottom",e._blTxt.includeInLayout=!1,e.topG.addChild(e._blTxt),e._swTxt=new eui.Label,e._swTxt.fontFamily="黑体",e._swTxt.width=200,e._swTxt.height=14,e._swTxt.textAlign="center",e._swTxt.size=14,e._swTxt.stroke=1,e._swTxt.strokeColor=0,e._swTxt.visible=!1,e._swTxt.verticalAlign="bottom",e._swTxt.includeInLayout=!1,e.topG.addChild(e._swTxt),e._nameTxt=new eui.Label,e._nameTxt.fontFamily="黑体",e._nameTxt.width=200,e._nameTxt.height=14,e._nameTxt.textAlign="center",e._nameTxt.size=14,e._nameTxt.stroke=1,e._nameTxt.strokeColor=0,e._nameTxt.visible=!1,e._nameTxt.verticalAlign="bottom",e._nameTxt.includeInLayout=!1,e.topG.addChild(e._nameTxt),e instanceof EntityRole?e._hpBar.getChildAt(1).source="boolGreen_png":e._hpBar.getChildAt(1).source="boolRed_png",e}return __extends(e,t),e.prototype.isDead=function(){return this.action==EntityAction.DIE||this._hpBar.value<=0},e.prototype.alive=function(){this.action=EntityAction.STAND;var t=this.getProp(FightAttr.HP_MAX);this.setHp(t,t)},e.prototype.getProp=function(t){return this.property[t]||0},e.prototype.setProp=function(t,e){this.property[t]=e},e.prototype.getFight=function(){return this.fight||0},e.prototype.setAI=function(t,e){void 0===e&&(e=!1),this.AI.destruct(),t.setEntity(this),this.AI=t,e&&this.AI.start()},e.prototype.startAI=function(t){void 0===t&&(t=!0),this.AI&&this.AI.start(t)},e.prototype.stopAI=function(){this.AI&&this.AI.stop()},e.prototype.setName=function(t){this.name=t,this._nameTxt.visible=!0,this._nameTxt.includeInLayout=""!=t,this._nameTxt.textFlow=TextFlowMaker.generateTextFlow(t)},e.prototype.setXianWei=function(t){t&&""!=t&&(t=this.name+"|"+t,this._nameTxt.includeInLayout=""!=t,this._nameTxt.textFlow=TextFlowMaker.generateTextFlow(t))},e.prototype.getName=function(){return this._nameTxt.text},e.prototype.setShengwang=function(t){this._swTxt.visible=!0,this._swTxt.includeInLayout=""!=t,this._swTxt.textFlow=UtilProxy.generateTextFlow(t)},e.prototype.setBanglv=function(t){this._blTxt.visible=!0,this._blTxt.includeInLayout=""!=t,this._blTxt.textFlow=UtilProxy.generateTextFlow(t)},e.prototype.getBodyScaleX=function(){return this._body.scaleX},e.prototype.playAction=function(t,e){void 0===e&&(e=null),this.action=t,this.playComplete=e,this._body.clearComFun(),this.readyUpdateMC()},e.prototype.resetHp=function(){this._hpBar.maximum=this.getProp(enPropCreature.PROP_MAXHP),this._hpBar.value=this.getProp(enPropCreature.PROP_HP)},e.prototype.setHp=function(t,e){e&&(this._hpBar.maximum=e),0>t&&(t=0),t>e&&(t=e),this._hpBar.value=t},e.prototype.getHP=function(){return this._hpBar.value},e.prototype.getHPMax=function(){return this._hpBar.maximum},e.prototype.setHPBarVisible=function(t){this._hpBar.visible=t},e.prototype.setTitle=function(t){""!=t?(this.titleImg.visible=!0,this.titleImg.source=TitleProxy.title_icon_path+t+".png"):this.titleImg.visible=!1,this.titleImg.includeInLayout=""!=t},e.prototype.setDir=function(t){this.dir!=t&&(this.dir=t,this.readyUpdateMC())},e.prototype.updateMC=function(){this.loadFile(this._body,RES_DIR_BODY+this.getProp(enPropEntity.PROP_ENTITY_MODELID))},e.prototype.loadFile=function(t,e){var i=this;t.stop();var n=e+"_"+DirUtil.get5DirBy8Dir(this.dir)+this.action;return t.once(egret.Event.CHANGE,function(){i._hpBar.anchorOffsetX=i._hpBar.width>>1,t.scaleX=DirUtil.isScaleX(i.dir)?-1:1},this),this.action==EntityAction.RUN||this.action==EntityAction.STAND||this.action==EntityAction.FLY||this.action==EntityAction.Other4||this.action==EntityAction.Other5?void t.playFile(n,-1,null,!1):void t.playFile(n,1,t==this._body?this.playComplete:null,!1)},e.prototype.readyUpdateMC=function(){this.frameTick.checkAndTick(0)||TimerManager.ins().doNext(this.updateMC,this)},e.prototype.refresh=function(){this.updateMC()},e.prototype.isAtkAction=function(){return!1},e.prototype.update=function(t){this.mover&&this.mover.update(t);var e=GameMap.pix2grid(this.x),i=GameMap.pix2grid(this.y);this.alpha=GameMap.ins().checkAlpha(e,i)?.7:1},e.prototype.isMoveing=function(){return this.mover&&this.mover.moving},e.prototype.assault=function(t,e,i,n,o){this.mover&&(this.setDir(DirUtil.get8DirBy2Point(this,{x:e,y:i})),this.playAction(EntityAction.FLY),this.mover.moveTo(t,e,i,o),this.mover.setCompleteFunc(n,this))},e.prototype.moveTo=function(t,e,i){if(this.mover){this.setDir(DirUtil.get8DirBy2Point(this,{x:e,y:i})),this.action!=EntityAction.RUN&&this.playAction(EntityAction.RUN);this.getProp(enPropCreature.PROP_MOVETIME);this.mover.moveTo(t,e,i,this.getProp(FightAttr.SPEED))}},e.prototype.moveNext=function(){if(this.path&&this.path.length){var t=this.path.shift(),e=this.path.shift();this.moveTo(TimerManager.ins().getCurrTime(),t,e)}else this.stopMove(),this.playAction(EntityAction.ATTACK),this.path=null},e.prototype.startMove=function(t,e,i){void 0===e&&(e=EntityAction.RUN),void 0===i&&(i=204),!this.isAtkAction()&&t&&t.length&&(this.stopMove(),this.path=t,this.moveNext(),this.mover.setCompleteFunc(this.moveNext,this))},Object.defineProperty(e.prototype,"mapX",{get:function(){return this.x/GameMap.CELL_SIZE>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapY",{get:function(){return this.y/GameMap.CELL_SIZE>>0},enumerable:!0,configurable:!0}),e.prototype.stopMove=function(){this.mover.stopMove(),this.mover.setCompleteFunc(null,null)},e.prototype.pauseMove=function(){this.mover.stopMove()},e.prototype.setMoveComplete=function(t){this.mover.onComplete=t},e.prototype.getTargetPoint=function(){return this.path&&this.path.length?{x:this.path[this.path.length-2],y:this.path[this.path.length-1]}:null},e.prototype.reStart=function(t){void 0===t&&(t=!0),this.AI.reStart(t)},e.prototype.setValue=function(t,e){void 0!=this.vo&&(this.vo[t]=e)},e.prototype.getValue=function(t){return void 0!=this.vo?this.vo[t]:0},e}(egret.DisplayObjectContainer);__reflect(Entity.prototype,"Entity");var AIBase=function(){function t(t){void 0===t&&(t=null),this.state=AI_State.Stand,this.aiTime=200,this.params=new AiParams,this.setEntity(t)}return t.prototype.getEntity=function(){return this.entity},t.prototype.setEntity=function(t){this.entity=t,this.entity&&this.entity.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.stop,this)},t.prototype.getTargetId=function(){return this.params.target},t.prototype.setTargetId=function(t){this.params.target!=t&&(this.params.target=t,EventProxy.Broast(EventType.chargeTarget,[]))},t.prototype.start=function(t){void 0===t&&(t=!0),this.runing||(TimerManager.ins().doTimer(this.aiTime,0,this.update,this),this.runing=!0,this.reStart(t))},t.prototype.stop=function(){this.runing&&(TimerManager.ins().remove(this.update,this),this.runing=!1)},t.prototype.reStart=function(t){this.runing&&(this.startStand(),t&&this.update())},t.prototype.continueAI=function(t){void 0===t&&(t=!0),this.runing||(TimerManager.ins().doTimer(this.aiTime,0,this.update,this),this.runing=!0,t&&this.update())},t.prototype.Stand=function(){},t.prototype.Atk=function(){return!1},t.prototype.Atked=function(){},t.prototype.Follow=function(){},t.prototype.ReturnPatrol=function(){},t.prototype.None=function(){},t.prototype.update=function(){this.state>0&&this.entity&&Debug.log("有对象的怪ID",this.entity.handle);var t=this[AI_State[this.state]];t&&t.call(this)},t.prototype.setAIState=function(t){this.state!=t&&(this.state=t)},t.prototype.getAIState=function(){return this.state},t.prototype.startAttack=function(t){void 0===t&&(t=null),this.state=AI_State.Atk,this.params.target=t?t.handle:0},t.prototype.onAttacked=function(t){this.state=AI_State.Atked,this.params.target=t.handle},t.prototype.startStand=function(){this.state=AI_State.Stand},t.prototype.startNone=function(){this.state=AI_State.None},t.prototype.startfindNpc=function(t){this.state=AI_State.Npc,this.params.npc=t,this.params.sceneId=0,this.params.x=0,this.params.y=0},t.prototype.startPatrol=function(t,e){this.params.homeX=t?t:0,this.params.homeY=e?e:0,this.state=AI_State.Patrol},t.prototype.startDie=function(t,e){void 0===t&&(t=0),this.state=AI_State.Die},t.prototype.startAtked=function(t,e,i,n){},t.prototype.startFllow=function(t){this.state=AI_State.Follow,this.params.target=t},t.prototype.startAlive=function(){},t.prototype.moveTo=function(t){var e=GameMap.ins().getPath(t,this.entity);e&&this.entity.startMove(e)},t.prototype.destruct=function(){this.stop(),this.entity=null,this.params=null},t.prototype.atkTest=function(){this.Atk()},t}();__reflect(AIBase.prototype,"AIBase");var AI_State;!function(t){t[t.Stand=0]="Stand",t[t.Atk=1]="Atk",t[t.Atked=2]="Atked",t[t.Patrol=3]="Patrol",t[t.Die=4]="Die",t[t.Follow=5]="Follow",t[t.ReturnPatrol=6]="ReturnPatrol",t[t.None=7]="None",t[t.Npc=8]="Npc",t[t.Guaji=9]="Guaji"}(AI_State||(AI_State={}));var AiParams=function(){function t(){this.target=0,this.npc=0,this.sceneId=0,this.x=0,this.y=0,this.homeX=0,this.homeY=0}return t.prototype.reset=function(){this.target=0,this.npc=0,this.sceneId=0,this.x=0,this.y=0},t}();__reflect(AiParams.prototype,"AiParams");var BaseView=function(t){function e(){var e=t.call(this)||this;return e.eventlist=[],e.event=[],e.eventex=[],e}return __extends(e,t),e.prototype.addToEventProxy=function(t,e,i){this.eventlist.push([t,e,i])},e.prototype.observe=function(t,e,i){void 0===i&&(i=void 0),MessageCenter.addListener(t,e,this,i)},e.prototype.removeObserve=function(){MessageCenter.ins().removeAll(this)},e.prototype.addTouchEvent=function(t,e){this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e)},e.prototype.addTouchEndEvent=function(t,e){this.addEvent(egret.TouchEvent.TOUCH_END,t,e)},e.prototype.addChangeEvent=function(t,e){this.addEvent(egret.TouchEvent.CHANGE,t,e)},e.prototype.addItemTapEvent=function(t,e){this.addEvent(eui.ItemTapEvent.ITEM_TAP,t,e)},e.prototype.removeItemTapEvent=function(t,e){t.removeEventListener(eui.ItemTapEvent.ITEM_TAP,e,this),t.removeEventListener(eui.ItemTapEvent.ITEM_TAP,GuideProxy.ins().onChangeStage,this)},e.prototype.addEvent=function(t,e,i){e.addEventListener(t,GuideProxy.ins().onChangeStage,this),e.addEventListener(t,i,this),this.event.push([t,i,e]),this.eventex.push([t,GuideProxy.ins().onChangeStage,e])},e.prototype.removeTouchEvent=function(t,e){t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,this),t.removeEventListener(egret.TouchEvent.TOUCH_TAP,GuideProxy.ins().onChangeStage,this)},e.prototype.removeEvents=function(){for(var t=0,e=this.event;t<e.length;t++){var i=e[t];i[2].removeEventListener(i[0],i[1],this)}for(var n=0,o=this.eventex;n<o.length;n++){var i=o[n];i[2].removeEventListener(i[0],i[1],this)}for(var s=0;s<this.eventlist.length;s++){var r=this.eventlist[s];EventProxy.RemoveListener(r[0],r[1],r[2])}this.eventlist=[]},e.prototype.getEventFunc=function(t){if(this.event)for(var e=0,i=this.event;e<i.length;e++){var n=i[e];if(n[2]==t)return n[1]}},e.prototype.$onClose=function(){var t=function(t){for(var i=0;i<t.numChildren;i++){var n=t.getChildAt(i);n instanceof e?n.$onClose():n instanceof egret.DisplayObjectContainer&&arguments.callee(n)}};t(this),this.removeEvents(),this.removeObserve()},e.prototype.setSkinPart=function(i,n){if(t.prototype.setSkinPart.call(this,i,n),this.skin[i]&&this.skin[i]!=n&&void 0!=n){var o=this.skin[i].parent,s=o.getChildIndex(this.skin[i]);DisplayUtils.removeFromParent(this.skin[i]);for(var r=0;r<e.replaceKeys.length;r++){var a=e.replaceKeys[r];n[a]=this.skin[i][a]}this.skin[i]=n,o.addChildAt(n,s)}},e.replaceKeys=["x","y","alpha","anchorOffsetX","anchorOffsetY","blendMode","bottom","cacheAsBitmap","currentState","enabled","filters","height","horizontalCenter","hostComponentKey","includeInLayout","left","mask","matrix","maxHeight","maxWidth","minHeight","minWidth","name","percentHeight","percentWidth","right","rotation","scaleX","scaleY","scrollRect","skewX","skewY","skinName","top","touchChildren","touchEnabled","verticalCenter","visible","width"],e}(eui.Component);__reflect(BaseView.prototype,"BaseView");var BaseEuiView=function(t){function e(){var e=t.call(this)||this;return e._resources=null,e.isTopLevel=!1,e.exclusionWins=[],e._isInit=!1,e._isOpen=!1,e.percentHeight=100,e.percentWidth=100,e}return __extends(e,t),e.prototype.addExclusionWin=function(t){-1==this.exclusionWins.indexOf(t)&&this.exclusionWins.push(t)},e.prototype.setResources=function(t){this._resources=t},e.prototype.isInit=function(){return this._isInit},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.isOpen=function(){return this._isOpen},e.prototype.addToParent=function(t){t.addChild(this)},e.prototype.removeFromParent=function(){DisplayUtils.removeFromParent(this),this.destoryView()},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.destroy=function(){},e.prototype.destoryView=function(){TimerManager.ins().removeAll(this),ViewManager.ins().destroy(this.hashCode)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._isOpen=!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?(ResourceUtils.ins().loadResource(this._resources,[],t,null,this),this.addEventListener(eui.UIEvent.CREATION_COMPLETE,e,this)):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e}(BaseView);__reflect(BaseEuiView.prototype,"BaseEuiView",["IBaseView"]);var BaseClass=function(){function t(){}return t.ins=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;return i._instance||(i._instance=new(i.bind.apply(i,[void 0].concat(t)))),i._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var BaseEuiLayer=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e.touchEnabled=!1,e}return __extends(e,t),e}(eui.Group);__reflect(BaseEuiLayer.prototype,"BaseEuiLayer");var BaseSpriteLayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(BaseSpriteLayer.prototype,"BaseSpriteLayer");var BaseItemRender=function(t){function e(){var e=t.call(this)||this;return e._data=null,e._selected=!1,e._itemIndex=-1,e.touchCaptured=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e}return __extends(e,t),e.prototype.onTouchCancle=function(t){this.touchCaptured=!1;var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.invalidateState()},e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},e.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},e.prototype.getCurrentState=function(){var t="up";if(this.touchCaptured&&(t="down"),this._selected){var e=t+"AndSelected",i=this.skin;return i&&i.hasState(e)?e:"disabled"==t?"disabled":"down"}return t},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemIndex",{get:function(){return this._itemIndex},set:function(t){this._itemIndex=t},enumerable:!0,configurable:!0}),e.prototype.dataChanged=function(){},Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.selectChanged(),this.invalidateState())},enumerable:!0,configurable:!0}),e.prototype.selectChanged=function(){},e}(BaseView);__reflect(BaseItemRender.prototype,"BaseItemRender",["eui.IItemRenderer","eui.UIComponent","egret.DisplayObject"]),eui.registerBindable(BaseItemRender.prototype,"data");var AIBaseMU=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nextSkillTime=0,i.friendType=[],i.enemyType=[],i}return __extends(e,t),e.prototype.Die=function(){},e.prototype.Atk=function(){return!1},e.prototype.updateSkillCd=function(t){},e.prototype.startAttack=function(t){void 0===t&&(t=null),this.state=AI_State.Atk,this.params.target=t?t.handle:0},e.prototype.sendMoveEntity=function(t,e){},e.prototype.startFllow=function(e){t.prototype.startFllow.call(this,e);var i=GameLogic.ins().getEntityByHandle(e);if(i){var n=DirUtil.get8DirBy2Point(this.entity,i),o=DirUtil.getGridByDir(n,1,i),s=Math.random()>.49?1:-1,r=Math.random()>.49?1:-1,a=o.x+100*Math.random()*s,h=o.y+100*Math.random()*r,l=this.entity.x-100*Math.random()*s,p=this.entity.y-100*Math.random()*r,c=GameMap.ins().getPath({x:a,y:h},{x:l,y:p});c&&this.entity.startMove(c)}},e.prototype.Follow=function(){this.entity.isMoveing()||(this.isFaraway()&&this.startFllow(this.params.target),this.startAttack())},e.prototype.startDie=function(e,i){void 0===e&&(e=0),t.prototype.startDie.call(this,e,i),void 0!=this.entity&&(this.entity.handle==GameMap.centerEntity.handle?this.startAlive():this.update())},e.prototype.startAlive=function(){this.entity.alive(),this.startAttack()},e.prototype.isFaraway=function(){var t=GameLogic.ins().getEntityByHandle(this.params.target);if(t){var e=122500,i=MathUtils.getDistanceX2ByObject(this.entity,GameLogic.ins().getEntityByHandle(this.params.target));return i>e}return!1},e.prototype.getSkillCanUse=function(t){return null},e.prototype.isFriend=function(t){return-1!=this.friendType.indexOf(EntityType.getEntityType(t))},e.prototype.isEnemy=function(t){if(t.handle==GameMap.centerEntity.handle)return!1;var e=-1!=this.enemyType.indexOf(EntityType.getEntityType(t)),i=CopyProxy.ins().isTopFight(GameLogic.ins().getCurSceneId())&&EntityType.getEntityType(t)==EntityTypes.RoleMU,n=GameMap.centerEntity.team_id>0&&GameMap.centerEntity.team_id==t.team_id;return n?!1:e||i},e.prototype.setEnemyType=function(t){this.enemyType=t},e.prototype.getEntityPos=function(){return new egret.Point(this.entity.x,this.entity.y)},e.prototype.getTargetHandle=function(t){var e=0,i=GlobalConfig.getSkillDescById(Math.floor(t.skillId/1e4));if(!i)return 0;switch(i.cast_type){case CastType.Friend:case CastType.Self:case CastType.SelfByHp:e=this.entity.handle;break;case CastType.Enemy:e=this.params.target}return e},e.prototype.isSameGrid=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=null),t&&e?t.x/GameMap.CELL_SIZE>>0==e.x/GameMap.CELL_SIZE>>0&&t.y/GameMap.CELL_SIZE>>0==e.y/GameMap.CELL_SIZE>>0:!1},e.prototype.destruct=function(){this.stop(),this.entity&&this.entity.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.stop,this),this.entity=null,this.params=null},e.prototype.setEntity=function(t){this.entity=t},e.prototype.start=function(t){void 0===t&&(t=!0),this.stop(),this.runing=!0,TimerManager.ins().doTimer(this.aiTime,0,this.update,this),this.update()},e}(AIBase);__reflect(AIBaseMU.prototype,"AIBaseMU");var EntityMU=function(t){function e(){var e=t.call(this)||this;return e.effs={},e.hideModel=!1,e.tar=new egret.Point(-1,-1),e.setAI(new AIBaseMU),e._hpBar.anchorOffsetX=e._hpBar.width>>1,e._hpBar.direction=eui.Direction.LTR,e._hpBar.slideDuration=1500,e}return __extends(e,t),e.prototype.setProps=function(t){this.property=t,this.setHp(this.property[AttributeType.atHp],this.property[AttributeType.atHpMax])},e.prototype.setProp=function(e,i){switch(t.prototype.setProp.call(this,e,i),e){case FightAttr.SPEED:this.property[FightAttr.SPEED]=64*i/1e3,this.property[FightAttr.SPEED]<=0&&(this.property[FightAttr.SPEED]=208);break;case FightAttr.HP:this.setHp(i);break;case FightAttr.HP_MAX:this.setHp(i,i)}},e.prototype.addProp=function(t,e){this.property[t]?this.property[t]+=e:this.property[t]=e},e.prototype.getCharName=function(){return this._nameTxt.text},e.prototype.playAction=function(t){t==EntityAction.DIE&&this.resetTarget(),(this.action!=t||EntityAction.isAtkAction(t))&&this.action!=EntityAction.DIE&&(t==EntityAction.ATKED&&this.isAtkAction()&&t!=EntityAction.DIE||(this.action=t,t!=EntityAction.RUN&&this.stopMove(),this._body.clearComFun(),this.readyUpdateMC()))},e.prototype.readyUpdateMC=function(){t.prototype.readyUpdateMC.call(this)},e.prototype.updateMC=function(){var t=this;if(this.hideModel)return void this._body.clear();var e=this.dir>=5?-1:1;this._body.stop(),this._body.scaleX=e,this._body.rate=this.getBodyRate();var i=null,n=-1;this.isOnceAction()&&(i=function(){t.onAtkEnd()},n=1);var o=this.getBodyFileName();this._body.playFile(o,n,i,!1)},e.prototype.getBodyFileName=function(){return""},e.prototype.onAtkEnd=function(){this.action!=EntityAction.DIE&&this.playAction(EntityAction.STAND)},e.prototype.addAtkedEffect=function(t){},e.prototype.addBuff=function(t){},e.prototype.removeBuff=function(t){var e=this.effs[t];e&&(e.removeEventListener(egret.Event.CHANGE,this.onBuffChange,this),DisplayUtils.removeFromParent(e),e.stop(),delete this.effs[t])},e.prototype.onBuffChange=function(t){var e=t.target,i=MathUtils.limitInteger(1,e.totalFrames);e.gotoAndPlay(i)},e.prototype.canMove=function(){return!0},e.prototype.canAtk=function(){return!0},e.prototype.canBeAtk=function(){return this.action!=EntityAction.DIE&&0!=this._hpBar.value},e.prototype.getAtkTime=function(){return Math.max(1e3/(this.atkSpeed+1e3),.3)},e.prototype.getAction=function(){return this.action},e.prototype.isAtkAction=function(){return-1!=EntityAction.ATTACK_ACTIONS.indexOf(this.action)},e.prototype.isOnceAction=function(){return-1!=EntityAction.ONCE_ACTIONS.indexOf(this.action)},e.prototype.setHpAndNameVisible=function(t){this._hpBar.visible!=t&&(this._hpBar.visible=t),this._nameTxt.visible!=t&&(this._nameTxt.visible=t)},e.prototype.getAttributes=function(){return this.property},e.prototype.getBodyRate=function(){var t=1;return this.isAtkAction()?t=1:this.action==EntityAction.RUN&&(t=1),t},e.prototype.update=function(t){if(this.mover.update(t),!this.isDead()){var e=Math.floor(this.x/GameMap.CELL_SIZE),i=Math.floor(this.y/GameMap.CELL_SIZE),n=this.alpha;GameMap.ins().checkAlpha(e,i)?1==n&&(this.alpha=.5):.5==n&&(this.alpha=1)}},e.prototype.destruct=function(){this.stopMove(),this.action=EntityAction.STAND,this._hpBar.value=this._hpBar.maximum,this._body.stop(),this._body.filters=[],this._body.clear(),this._nameTxt.visible=!1,DisplayUtils.removeFromParent(this),TimerManager.ins().removeAll(this),this.alpha=1,this.scaleX=this.scaleY=1,this.AI.destruct(),this.AI=new AIBaseMU;for(var t in this.effs)this.removeBuff(parseInt(t));this.effs={},this.vo=null,this.partner_handle=0,this.pet_handle=0,this.is_main=!1,this.hideModel=!1},e.prototype.continuePlay=function(){for(var t in this.effs){var e=this.effs[t];e.play(-1)}this._body.play(-1)},e.prototype.moveTo=function(t,e,i){this.mover&&(this.setDir(DirUtil.get8DirBy2Point(this,{x:e,y:i})),this.playAction(EntityAction.RUN),this.mover.moveTo(t,e,i,this.getProp(FightAttr.SPEED)))},e.prototype.movoNext=function(){if(this.path&&this.path.length){var t=this.path.shift(),e=this.path.shift();this.setDir(DirUtil.get8DirBy2Point(this,{x:t,y:e}));var i=this.getProp(FightAttr.SPEED);this.mover.moveTo(TimerManager.ins().getCurrTime(),t,e,i)}else this instanceof EntityMonster?(this.stopMove(),this.playAction(EntityAction.ATTACK)):(this.stopMove(),this.playAction(EntityAction.STAND))},e.prototype.startMove=function(t,e,i){void 0===e&&(e=EntityAction.RUN),void 0===i&&(i=204),t&&t.length&&(this.stopMove(),this.path=t,this.speed=i,this.playAction(e),this.resetTarget(),this.tar.x=this.path[this.path.length-2],this.tar.y=this.path[this.path.length-1],GameMap.ins().capture(this.tar.x,this.tar.y,this.handle),this.movoNext(),this.mover.onComplete=this.movoNext,this.mover.completeObj=this)},e.prototype.getTargetPoint=function(){return-1!=this.tar.x&&-1!=this.tar.y?this.tar:null},e.prototype.resetTarget=function(){-1!=this.tar.x&&-1!=this.tar.y&&(GameMap.ins().capture(this.tar.x,this.tar.y),this.tar.x=-1,this.tar.y=-1)},e}(Entity);__reflect(EntityMU.prototype,"EntityMU");var BaseScene=function(){function t(){this._layers=new Array}return t.prototype.onEnter=function(){},t.prototype.onExit=function(){ViewManager.ins().closeAll(),this.removeAllLayer()},t.prototype.addLayer=function(t){t instanceof BaseSpriteLayer?(StageUtils.ins().getStage().addChild(t),this._layers.push(t)):t instanceof BaseEuiLayer&&(StageUtils.ins().getUIStage().addChild(t),this._layers.push(t))},t.prototype.addLayerAt=function(t,e){t instanceof BaseSpriteLayer?(StageUtils.ins().getStage().addChildAt(t,e),this._layers.push(t)):t instanceof BaseEuiLayer&&(StageUtils.ins().getUIStage().addChildAt(t,e),this._layers.push(t))},t.prototype.removeLayer=function(t){t instanceof BaseSpriteLayer?(StageUtils.ins().getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)):t instanceof BaseEuiLayer&&(StageUtils.ins().getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},t.prototype.layerRemoveAllChild=function(t){t instanceof BaseSpriteLayer?t.removeChildren():t instanceof BaseEuiLayer&&t.removeChildren()},t.prototype.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();__reflect(BaseScene.prototype,"BaseScene");var MessageCenter=function(t){function e(e){var i=t.call(this)||this;return i.flag=0,i.type=e,i.dict={},i.eVec=[],0==i.type&&egret.startTick(i.run,i),i}return __extends(e,t),e.ins=function(){return t.ins.call(this,0)},e.prototype.clear=function(){this.dict={},this.eVec.splice(0)},e.prototype.addListener=function(t,e,i){var n=this.dict[t];n?0!=this.flag&&(this.dict[t]=n=n.concat()):this.dict[t]=n=[];for(var o=0,s=n;o<s.length;o++){var r=s[o];if(r[0]==e&&r[1]==i)return}n.push([e,i])},e.prototype.removeListener=function(t,e,i){var n=this.dict[t];if(n){0!=this.flag&&(this.dict[t]=n=n.concat());for(var o=n.length,s=0;o>s;s++)if(n[s][0]==e&&n[s][1]==i){n.splice(s,1);break}0==n.length&&(this.dict[t]=null,delete this.dict[t])}},e.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),i=0,n=e;i<n.length;i++){var o=n[i],s=this.dict[o];0!=this.flag&&(this.dict[o]=s=s.concat());for(var r=0;r<s.length;r++)s[r][1]==t&&(s.splice(r,1),r--);0==s.length&&(this.dict[o]=null,delete this.dict[o])}},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=ObjectPool.pop("MessageVo");n.type=t,n.param=e,0==this.type?this.eVec.push(n):1==this.type?this.dealMsg(n):Debug.log("MessageCenter未实现的类型")},e.prototype.run=function(t){for(var e=egret.getTimer();this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-e>5)););return!1},e.prototype.dealMsg=function(t){var e=this.dict[t.type];if(e){var i=e.length;if(0!=i){this.flag++;for(var n=0,o=e;n<o.length;n++){var s=o[n];s[0].apply(s[1],t.param)}this.flag--,t.dispose(),ObjectPool.push(t)}}},e.setFunction=function(t,i,n,o){if(0==n.indexOf(o)&&"function"==typeof i[n]){var s=egret.getQualifiedClassName(i)+e.splite+n,r=i[n],a=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o;i.length;return o=t?r.call.apply(r,[this].concat(i)):r.apply(void 0,i),("boolean"!=typeof o||o)&&e.ins().dispatch(s,o),o};return a.funcallname=s,i[n]=a,!0}return!1},e.compile=function(t,i){void 0===i&&(i="post");for(var n in t)e.setFunction(!1,t,n,i);for(var o=t.prototype,s=Object.keys(o),r=0,a=s;r<a.length;r++){var h=a[r];e.setFunction(!0,o,h,i)}},e.addListener=function(t,i,n,o){return void 0===o&&(o=void 0),t.funcallname?(e.ins().addListener(t.funcallname,i,n),o&&t.call(o),!0):(CommonUtils.log("MessageCenter.addListener error:"+egret.getQualifiedClassName(n)),!1)},e.splite=".",e}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var LayerManager=function(){function t(){}return t.Game_Bg=new BaseSpriteLayer,t.Game_Main=new BaseSpriteLayer,t.UI_PreMain=new BaseEuiLayer,t.UI_Main=new BaseEuiLayer,t.UI_Main2=new BaseEuiLayer,t.UI_Popup=new BaseEuiLayer,t.UI_Message=new BaseEuiLayer,t.UI_Tips=new BaseEuiLayer,t.UI_Guide=new BaseEuiLayer,t.UI_Open=new BaseEuiLayer,t}();__reflect(LayerManager.prototype,"LayerManager");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,TimerManager.ins().doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,n=e.length;n>i;i++){var o=e[i];this.checkCanClear(o)&&t-this._cache[o]>=SoundManager.CLEAR_TIME&&(delete this._cache[o],RES.destroyRes(o))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0
},t}();__reflect(BaseSound.prototype,"BaseSound");var ViewManager=function(t){function e(){var e=t.call(this)||this;return e.back_to_dujie=!1,e.dujie_open_view_id=0,e.dujie_open_view_page=0,e.open_view_page=[],e.filters=["TipsView"],e.view_list={},e.curTime=0,e._regesterInfo={},e._views={},e._hCode2Key={},e._opens=[],e.open_view=[],egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.clear=function(){this.closeAll(),this._views={}},e.prototype.reg=function(t,e){if(null!=t){var i=egret.getQualifiedClassName(t);this._regesterInfo[i]||(this._regesterInfo[i]=[t,e])}},e.prototype.destroy=function(t){var e=this._hCode2Key[t];delete this._views[e]},e.prototype.getKey=function(t){var e="";if("string"==typeof t)e=t;else if("function"==typeof t)e=egret.getQualifiedClassName(t);else if(t instanceof BaseEuiView)for(var i=Object.keys(this._views),n=0,o=i.length;o>n;n++){var s=i[n];if(this._views[s]==t){e=s;break}}else CommonUtils.log("打开界面只支持类名和类名的字符串形式,关闭界面只支持类名和类名的字符串以及类的实例形式,错误编号:"+t);return e},e.prototype.viewOpenCheck=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=!0,o=this._regesterInfo[t];if(null!=o){var s=o[0],r=s.openCheck;null!=r&&(n=r.apply(void 0,e))}return n},e.prototype.toggleWin=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=this.isShow(t);return o?e.ins().close(t):e.ins().open(t),null},e.prototype.open=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getKey(t);if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck||"PrivilegeView"!=n&&"FirstRechargeView"!=n&&"DayFRView"!=n)&&("DayFRView"==n&&LimitActProxy.ins().IsFristRechargeOpen()&&(n="FirstRechargeView"),"ItemTipsView"!=n&&"EquipTipsView"!=n||void 0!=e[0]&&void 0!=e[0].itemConfig&&void 0!=e[0].itemConfig.type)){if("StartGameView"!=n&&"CreateCharView"!=n){if(0==this.viewOpenCheck.apply(this,[n].concat(e)))return null;if(void 0!=e[0]&&"number"==typeof e[0]){if(!this.isOpenView(t,e[0]))return}else if(!this.isOpenView(t))return}"XianFuView"==n&&EventProxy.Broast(EventType.ChangeMainAchorState,[!1]);var o=this.openEasy(n,e);o&&this.checkOpenView(o);var s=this.getMvidByView(n);this.open_view_page[s]=e[0]||0;var r=GlobalConfig.getMisc_dataConfig(1);if(r&&1==r.memory_recovery){var a=GlobalConfig.getViewResByName(n);a&&a.res_list&&a.res_list.length>0&&(this.view_list[n]=null)}return o}},e.prototype.openEasy=function(t,e){void 0===e&&(e=null);var i=this.getKey(t),n=this._views[i],o=this._regesterInfo[i];if(n||(n=new o[0],this._views[i]=n,this._hCode2Key[n.hashCode]=i),null==n)return Debug.log("UI_"+i+"不存在"),null;for(var s=0,r=n.exclusionWins;s<r.length;s++){var a=r[s];this.closeEasy(a)}this.isCloseView(i)&&this.closeNotConst(i),n.isShow()||n.isInit()?(n.visible=!0,n.open.apply(n,e),n.addToParent(o[1])):(this.openWin(),n.loadResource(function(){n.addToParent(o[1]),n.setVisible(!1)}.bind(this),function(){n.initUI(),n.initData(),n.open.apply(n,e),n.setVisible(!0),this.openWinCom()}.bind(this)));var h=this._opens.indexOf(i);if(h>=0&&this._opens.splice(h,1),this._opens.push(i),!this.isConstView(i)&&this.isNotExpectView(i)){var l=this.open_view.indexOf(i);l>=0&&this.open_view.splice(l,1),this.open_view.push(i),this.checkBackState()}return n},e.prototype.checkOpenView=function(t){t.isTopLevel&&(this.openTopWin(),GameMap.ins().removeFromParent())},e.prototype.close=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=this.getKey(t),s=this.closeEasy(o,i);s&&this.checkCloseView(),this.isOpenNotConst()?this.openBackView():GuideProxy.ins().startCheck();var r=this.getMvidByView(o),a=this.open_view_page[r]||0;this.back_to_dujie&&r==this.dujie_open_view_id&&a==this.dujie_open_view_page&&(this.back_to_dujie=!1,this.dujie_open_view_id=0,this.dujie_open_view_page=0,e.ins().open(XiuXianView,0));var h=GlobalConfig.getMisc_dataConfig(1);if(h&&1==h.memory_recovery){var l=GlobalConfig.getViewResByName(o);l&&l.res_list&&l.res_list.length>0&&(this.view_list[o]={time:egret.getTimer()+5e3,res_list:l.res_list})}},e.prototype.checkViewClose=function(){},e.prototype.closeEasy=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this.isShow(t))return null;var n=this.getKey(t),o=this.getView(n);if(o){var s=this._opens.indexOf(n);s>=0&&this._opens.splice(s,1),o.close.apply(o,e),o.$onClose.apply(o);var r=this.open_view.indexOf(n);r>=0&&this.open_view.splice(r,1),"XianFuView"==n&&EventProxy.Broast(EventType.ChangeMainAchorState,[!0]),this.checkBackState(),o.removeFromParent()}return o},e.prototype.checkCloseView=function(){for(var t=!1,e=0,i=this._opens;e<i.length;e++){var n=i[e],o=this.getView(n);if(o&&o.isTopLevel){t=!0;break}}t||(this.closeTopWin(),GameMap.ins().addToParent())},e.prototype.openTopWin=function(){},e.prototype.closeTopWin=function(){},e.prototype.openWin=function(){},e.prototype.openWinCom=function(){},e.prototype.getView=function(t){var e=this.getKey(t);return this._views[e]},e.prototype.getViewClass=function(t){var e=this.getKey(t),i=this._views[e],n=this._regesterInfo[e];return i?this._views[e]:n?new n[0]:void 0},e.prototype.addViewParent=function(t){var e=this.getKey(t),i=this._views[e],n=this._regesterInfo[e];return i?this._views[e]:(i=new n[0],void i.addToParent(n[1]))},e.prototype.closeAll=function(){for(;this._opens.length;)this.closeEasy(this._opens[0],[]);this.checkCloseView()},e.prototype.closeTopLevel=function(){for(var t=this._opens.length-1;t>=0;t--){var e=this._opens[t],i=this.getView(e);i.isTopLevel&&this.closeEasy(e,[])}this.checkCloseView()},e.prototype.closeNotConst=function(t){for(var e=this._opens.length-1;e>=0;e--){var i=this._opens[e];if(!this.isConstView(i)&&t!=i){var n=this.getView(i);n&&(n.visible=!1)}}},e.prototype.closeNotConstAll=function(){for(var t=this._opens.length-1;t>=0;t--){var e=this._opens[t];this.isConstView(e)||this.close(e,[])}},e.prototype.isOpenNotConst=function(){for(var t=0;t<this._opens.length;++t){var e=this._opens[t];if(this.isNotExpectView(e)&&!this.isConstView(e))return!0}return!1},e.prototype.openNum=function(){return this._opens.length},e.prototype.isShow=function(t){return this._opens.indexOf(this.getKey(t))>=0},e.prototype.OpenViewById=function(t,e){void 0===e&&(e=-1);var i=GlobalConfig.getTplViewConfig(t);if(void 0!=i){var n=-1==e?1:2,o=-1==e?t:100*t+e;if(!SystemOpenProxy.ins().isOpen(n,o))return;-1==e?this.open(i.tsScript):this.open(i.tsScript,e)}else CommonUtils.log("----not find tpl_view ,id---->",t)},e.prototype.isCloseView=function(t){var e=this.getKey(t);GlobalConfig.getConfig("tpl_view","tplViewConfig");for(var i in GlobalConfig.ins().tplViewConfig)if(e==GlobalConfig.ins().tplViewConfig[i].tsScript)return 1==GlobalConfig.ins().tplViewConfig[i].isCloseView;return!1},e.prototype.isConstView=function(t){var e=this.getKey(t);GlobalConfig.getConfig("tpl_view","tplViewConfig");for(var i in GlobalConfig.ins().tplViewConfig)if(e==GlobalConfig.ins().tplViewConfig[i].tsScript)return 1==GlobalConfig.ins().tplViewConfig[i].isConst;return!1},e.prototype.isNotExpectView=function(t){var e=this.getKey(t);GlobalConfig.getConfig("tpl_view","tplViewConfig");for(var i in GlobalConfig.ins().tplViewConfig)if(e==GlobalConfig.ins().tplViewConfig[i].tsScript)return!0;return!1},e.prototype.getMvidByView=function(t){GlobalConfig.getConfig("tpl_view","tplViewConfig");for(var e in GlobalConfig.ins().tplViewConfig)if(t==GlobalConfig.ins().tplViewConfig[e].tsScript)return GlobalConfig.ins().tplViewConfig[e].id;return 0},e.prototype.isOpenView=function(t,e){void 0===e&&(e=-1);var i=this.getKey(t);GlobalConfig.getConfig("tpl_view","tplViewConfig");for(var n in GlobalConfig.ins().tplViewConfig){var o=GlobalConfig.ins().tplViewConfig[n];if(i==o.tsScript){var s=-1==e?1:2,r=-1==e?o.id:100*o.id+e;return SystemOpenProxy.ins().isOpen(1,o.id)?SystemOpenProxy.ins().isOpen(s,r):!1}}return!0},e.prototype.getBackView=function(){var t=this.open_view.pop();return t&&this.close(t,[]),this.open_view.length>0?(this.openBackView(),!0):t?!0:!1},e.prototype.openBackView=function(){if(this.open_view.length>0){var t=this.open_view[this.open_view.length-1],e=this.getView(t);e&&!e.visible&&(e.visible=!0)}},e.prototype.checkBackState=function(){EventProxy.Broast(EventType.ChangeXianFuState,[this.isOpenCacheView])},e.prototype.isOpenCacheView=function(){return this.open_view.length>0},e.prototype.onEnterFrame=function(t){if(t-this.curTime>5e3){this.curTime=t;for(var e in this.view_list){var i=this.view_list[e];if(i&&egret.getTimer()-i.time>=5e3){for(var n=0;n<i.res_list.length;n++)RES.destroyRes(i.res_list[n]);this.view_list[e]=null}if(egret.getTimer()-t>5)return!1}}return!1},e}(BaseClass);__reflect(ViewManager.prototype,"ViewManager");var ItemData=function(){function t(){this.handle=0,this.itemId=0,this.count=0,this.att=[],this.att1=[],this.att2=new AttributeData,this.canbeUsed=!1,this.power=0}return t.prototype.parser=function(t){this.handle=t.readDouble(),this.itemId=t.readInt(),this.count=t.readInt();for(var e=0;5>e;e++){var i=new AttributeData(1,1);this.att.push(i)}for(var e=0;e<GlobalConfig.getFineAttrCount();e++){var i=new AttributeData(t.readUnsignedShort(),t.readUnsignedShort());this.att1.push(i)}this.att2.type=t.readUnsignedShort(),this.att2.value=t.readUnsignedShort();t.readBoolean()},t}();__reflect(ItemData.prototype,"ItemData");var GameByteArray=function(t){function e(){var e=t.call(this)||this;return e.endian=egret.Endian.LITTLE_ENDIAN,e}return __extends(e,t),e.prototype.readString=function(){var t=this.readUTF();return this.position++,t},e.prototype.readNumber=function(){var t=new uint64(this),e=t.toString();return+e},e.prototype.writeNumber=function(t){var e=uint64.stringToUint64(t.toString());this.writeInt64(e)},e.prototype.writeInt64=function(t){this.writeUnsignedInt(t._lowUint),this.writeUnsignedInt(t._highUint)},e.prototype.writeString=function(t){this.writeUTF(t),this.writeByte(0)},e.prototype.writeCmd=function(t,e){this.writeByte(t),this.writeByte(e)},e}(egret.ByteArray);__reflect(GameByteArray.prototype,"GameByteArray");var Proto=function(){function t(){this.protoPool=new Array,this.msgClassDict={}}return t.prototype.load=function(){},t.prototype.msgclass=function(t){var e=this.msgClassDict[t];if(!e)for(var i in this.protoPool){var n=this.protoPool[i];if(e=n.build(t)){this.msgClassDict[t]=e;break}}return e?e:void CommonUtils.log("proto not found",t)},t.prototype.msgnew=function(t){var e=this.msgclass(t),i=new e;return i.__fullname=t,i},t}();__reflect(Proto.prototype,"Proto");var AIMonsterServer=function(t){function e(){var e=t.call(this)||this;return e.p=[new egret.Point(0,0),new egret.Point(0,0),new egret.Point(0,0)],e.aiTime=MathUtils.limit(400,600),e.enemyType=[EntityTypes.RoleMU],e}return __extends(e,t),e.prototype.startDie=function(e,i){void 0===e&&(e=0),t.prototype.startDie.call(this,e);var n=0;this.p[0].x=this.entity.x,this.p[0].y=this.entity.y;var o=this.entity.getConfig(),s=o.die_distance*GameMap.CELL_SIZE;if(i){n=DirUtil.get8DirBy2Point(i,this.entity);Math.atan2(this.entity.y-i.y,this.entity.x-i.x);this.p[2]=MathUtils.getPByDistance(i,this.entity,s)}else n=this.entity.dir,this.p[2]=DirUtil.getGridByDir(n,3,this.entity);var r=MathUtils.getDistanceByObject(this.p[0],this.p[2]);this.p[1]=this.getP1ByP0P2(this.p[0],this.p[2],.4*r);var a=.4*e,h=.3*e,l=.3*e;this.entity.alpha=1;var p=egret.Tween.get(this);this.entity.setHpAndNameVisible(!1),p.to({factor:1},a).wait(h).to({alpha:0,scaleY:.5},l)},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){this.entity&&(this.entity.x=(1-t)*(1-t)*this.p[0].x+2*t*(1-t)*this.p[1].x+t*t*this.p[2].x,this.entity.y=(1-t)*(1-t)*this.p[0].y+2*t*(1-t)*this.p[1].y+t*t*this.p[2].y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.entity.alpha},set:function(t){this.entity&&(this.entity.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return 1},set:function(t){this.entity&&0!=t&&(this.entity.scaleY=t)},enumerable:!0,configurable:!0}),e.prototype.getP1ByP0P2=function(t,e,i){var n=new egret.Point;return n.x=Math.min(t.x+3*(e.x-t.x)/5),n.y=Math.min(e.y,t.y-i),n},e.prototype.startAtked=function(t,e,i,n){var o=this;this.params.target=n;var s=!1;this.entity instanceof EntityMonster&&this.entity.getConfig()&&(s=1==this.entity.getConfig().Repelling);var r=null,a=egret.Tween.get(this.entity);this.entity.alpha=3,s?(GameMap.ins().checkWalkableByPixel(t,e)&&(r={x:t,y:e}),a.to(r,i).call(function(){o.state!=AI_State.Atk&&o.setAIState(AI_State.Atk)}).to(null,100).call(function(){o.entity&&(o.entity.alpha=1)})):(this.state!=AI_State.Atk&&this.setAIState(AI_State.Atk),a.to(null,100).call(function(){o.entity&&(o.entity.alpha=1)}))},e}(AIBaseMU);__reflect(AIMonsterServer.prototype,"AIMonsterServer");var AIRoleMU=function(t){function e(){var e=t.call(this)||this;return e.actionTime=0,e.enemyType=[EntityTypes.MonsterMU,EntityTypes.ArenaPlayer,EntityTypes.YezhanPlayer],e.aiTime=250,e}return __extends(e,t),e.prototype.setEntity=function(t){if(t){if(!(t instanceof EntityRole))throw new Error("AIRole只能管理EntityRole类型的实体");this.entity=t}},e.prototype.Stand=function(){this.entity.playAction(EntityAction.STAND)},e.prototype.Atk=function(){var t=this;if((!this.entity.isMoveing()||!GameLogic.ins().isMainScene()&&!GameLogic.ins().isBeastGhostScene())&&this.runing){var e=this.getTarget();if(e&&(e.handle==this.entity.handle||void 0==GameLogic.ins().getEntityByHandle(e.handle)||GameLogic.ins().getEntityByHandle(e.handle).isDead()||this.setTargetId(e.handle),this.params.x=e.x,this.params.y=e.y,TimerManager.ins().getCurrTime()>this.nextSkillTime)){var i=SkillCC.ins().getNextSkill(this.entity.index,this.nextSkillTime);if(void 0==i)return;var n=GlobalConfig.getSkillDescById(Math.floor(i.skillId/1e4));if(!n)return;var o=GlobalConfig.getSkillEffConfig(n.skill_effs[0]);if(!o)return;if(SkillCC.ins().checkSkillDis(this.entity,this.getSkillTargetPoint(i),i)){this.entity.stopMove(),this.entity.setDir(DirUtil.get8DirBy2Point(this.entity,e)),this.entity.playAction(n.action_type);this.entity.getAtkTime();this.nextSkillTime=TimerManager.ins().getCurrTime()+o.play_time,this.updateSkillCd(i.skillId),this.actionTime=TimerManager.ins().getCurrTime();var s=this.getTargetHandle(i);if(this.entity.handle==s);switch(n.target_type){case TargetType.Friend:SkillCC.ins().sendUseSkill(this.entity.handle,s,i,TimerManager.ins().getCurrTime()-this.actionTime);break;case TargetType.Enemy:if(i.skillId){var r="";GameConst.SKILL_ID_PLHXZ==i.skillId&&(r="_"+this.entity.getWeaponFileName()+"_"+AssetMgr.getStrengthenSource(this.entity.getWeaponStrengthen())),SkillEffPlayer.playEff(i,this.entity,[e],function(){t.entity&&GameLogic.ins().getEntityByHandle(s)&&SkillCC.ins().sendUseSkill(t.entity.handle,s,i,TimerManager.ins().getCurrTime()-t.actionTime)},this.entity.getBodyRate(),r)}}}else{var a=GameMap.ins().getAroundPoint(this.entity,e,150),h=GameMap.ins().getPath(a,this.entity);h&&h.length?this.entity.startMove(h):this.Stand()}}return!1}},e.prototype.getTarget=function(){if(null!=this.params.target){var t=GameLogic.ins().getEntityByHandle(this.params.target);if(t&&!t.isDead()&&t.handle!=this.entity.handle&&this.isEnemy(t))return t}var e=GameLogic.ins().getNearestEnemyByAI(this);return e},e.prototype.Die=function(){this.entity.playAction(EntityAction.DIE)},e.prototype.isFaraway=function(){var t=MathUtils.getDistanceX2ByObject(this.entity,GameMap.centerEntity),e=22500;return t>e},e.prototype.updateSkillCd=function(t){SkillCC.ins().updateSkillId(this.entity.index,t)},e.prototype.resetSkillCd=function(t){SkillCC.ins().resetSkillId(this.entity.index,t)},e.prototype.getSkillTargetPoint=function(t){var e,i=GlobalConfig.getSkillDescById(Math.floor(t.skillId/1e4)),n=i.cast_type;if(n==CastType.Self||n==CastType.Friend)e=i.target_type==TargetType.Enemy?{x:this.params.x,y:this.params.y}:this.entity;else if(n==CastType.Enemy)e={x:this.params.x,y:this.params.y};else if(n==CastType.SelfByHp){for(var o=GameLogic.ins().getMyEntitys(),s=void 0,r=0,a=o;r<a.length;r++){var h=a[r];if(s){var l=h.getHP();h.getHP()<l&&(s=h)}else s=h}e=s}return e},e.prototype.getItemCanPickUp=function(){var t=null;return t},e.prototype.sendMoveEntity=function(t,e){},e}(AIBaseMU);__reflect(AIRoleMU.prototype,"AIRoleMU");var ItemCell=function(t){function e(){var e=t.call(this)||this;return e.IsShowTips=!0,e.IsShowName=!1,e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this,this.onClick),this.count.visible=!0,this.nameLab.visible=!1,this.bg0.visible=!1,this.bgjx.visible=!1,this.selectPic.visible=!1,this.red.visible=!1,this.stars.visible=!1,this.effect&&this.effect.removeChildren()},e.prototype.setSkinName=function(){this.skinName="ItemCellSkin"},e.prototype.dataChanged=function(){if(this.bg0.visible=!1,this.bgjx.visible=!1,this.selectPic.visible=!1,this.stars.visible=!1,this.icon.scaleX=1,this.icon.scaleY=1,this.e_icons&&this.e_icons.length>0)for(var t=0;t<this.e_icons.length;t++)this.removeChild(this.e_icons[t]);this.e_icons=[];var e=this.data;if(void 0!=e&&void 0!=e.itemConfig){var i=e.itemConfig;if(i){var n=i.displayid.split("|");if(this.icon.source=AssetMgr.getIconResource(n[0]),n[1])for(var o=this.getChildIndex(this.icon),t=1;t<n.length;t++){var s=new eui.Image;s.x=8,s.y=3,s.scaleX=this.icon.scaleX,s.scaleY=this.icon.scaleY,s.source=AssetMgr.getIconResource(n[t]),this.e_icons.push(s),this.addChildAt(s,o+1)}if(this.bg.source=AssetMgr.getIconQualityResource(i.quality),this.setCount(e.item_count,e.isNumShow),this.nameLab.visible=this.IsShowName,this.effect&&(this.effect.removeChildren(),""!=i.effect_id))for(var r=i.effect_id.split("|"),t=0;t<r.length;t++)UtilProxy.GetMovieClipById(Number(r[t]),this.effect);if(this.nameLab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[i.quality-1],i.name]),1==i.type){i=i,i.part>10&&i.part<41&&(this.bg0.visible=!0),this.stars.visible=i.star>0;for(var t=0;t<this.stars.numChildren;t++)this.stars.getChildAt(t).visible=t<i.star}if(2==i.bag_type){i=i,this.bgjx.visible=""!=i.display_bg_id,this.bgjx.source=i.display_bg_id,i.display_bg_id&&""!=i.display_bg_id,this.stars.visible=i.star>0;for(var t=0;t<this.stars.numChildren;t++)this.stars.getChildAt(t).visible=t<i.star}3==i.bag_type&&(this.icon.scaleX=.51,this.icon.scaleY=.51)}this.SetShowTips(e.isTips)}else this.clear()},e.prototype.onClick=function(t){var e=this.data;void 0!=e&&this.IsShowTips&&e.item_type_id>0&&ViewManager.ins().open(ItemTipsView,e),t.stopImmediatePropagation()},e.prototype.clear=function(){if(this.icon.source="",this.bg.source=AssetMgr.getIconQualityResource(1),this.count.visible=!1,this.nameLab.visible=!1,this.bg0.visible=!1,this.bgjx.visible=!1,this.stars.visible=!1,this.effect&&this.effect.removeChildren(),this.e_icons&&this.e_icons.length>0){for(var t=0;t<this.e_icons.length;t++)this.removeChild(this.e_icons[t]);this.e_icons=[]}},e.prototype.SetShowTips=function(t){this.IsShowTips=t,t||this.removeTouchEvent(this,this.onClick)},e.prototype.ShowName=function(t){this.IsShowName=t,this.nameLab.visible=t},e.prototype.ShowRed=function(t){this.red.visible=t},e.prototype.SetItemStrengthen=function(t){this.count.visible=!0,this.count.text="+"+t},e.prototype.setCount=function(t,e){t>1?(this.count.text=UtilProxy.getNumLab(t),this.count.visible=!0):this.count.visible=!1,e&&(this.count.text=UtilProxy.getNumLab(t),this.count.visible=t>0)},e.prototype.showCount=function(){var t=this.data;this.count.visible=t.item_count>0},e.prototype.ShowOnSelect=function(t){this.selectPic.visible=t},e.prototype.HideBg=function(){this.bg.visible=!1,this.bg0.visible=!1,this.bgjx.visible=!1},e.prototype.HideEff=function(){this.effect&&this.effect.removeChildren()},e}(BaseItemRender);__reflect(ItemCell.prototype,"ItemCell"),window.ItemCell=ItemCell;var SceneCtrl=function(){function t(){}return t.prototype.init=function(t){},t.prototype.update=function(){},t.prototype.destory=function(){},t}();__reflect(SceneCtrl.prototype,"SceneCtrl");var EntityMonster=function(t){function e(){var e=t.call(this)||this;return e._hpBar.visible=e._nameTxt.visible=!1,e}return __extends(e,t),e.prototype.setConfig=function(t){this.config=t,this.setCharName(t.name),this.name=t.name;for(var e=RoleProxy.ins().getFightAttrs(),i="",n=0;n<e.length;n++)i=GameConst.fightAttrStr[n],void 0!=t[i]&&(this.property[n]=t[i],n==FightAttr.SPEED&&(this.property[FightAttr.SPEED]=64*t.speed/1e3));this.atkSpeed=100,this.updateMC()},e.prototype.setCharName=function(t){this._nameTxt.textFlow=TextFlowMaker.generateTextFlow(StringUtils.addColor(t,10724003))},e.prototype.updateMC=function(){t.prototype.updateMC.call(this)},e.prototype.getBodyFileName=function(){var t="",e=GlobalConfig.getCharResConfigById(this.config.res);return e&&(t=AssetMgr.getMonsterSource(e.body_res,this.dir,this.action,1==e.has_dir)),t},e.prototype.destruct=function(){t.prototype.destruct.call(this),this._hpBar.visible=!1},e.prototype.getConfig=function(){return this.config},e}(EntityMU);__reflect(EntityMonster.prototype,"EntityMonster");var BaseSystem=function(t){function e(){var e=t.call(this)||this;return e.observe(GameApp.postLoginInit,e.initLogin),e}return __extends(e,t),e.prototype.regNetMsg=function(t,e){GameSocket.ins().registerSTCFunc(this.sysId,t,e,this)},e.prototype.initLogin=function(){},e.prototype.getGameByteArray=function(){return GameSocket.ins().getBytes()},e.prototype.getBytes=function(t){var e=this.getGameByteArray();return e.writeCmd(this.sysId,t),e},e.prototype.sendBaseProto=function(t){var e=this.getGameByteArray();e.writeCmd(this.sysId,t),this.sendToServer(e)},e.prototype.sendToServer=function(t){GameSocket.ins().sendToServer(t)},e.prototype.sendPbPack=function(t,e,i){GameSocket.ins().sendPbPack(t,e,i)},e.prototype.observe=function(t,e){MessageCenter.addListener(t,e,this)},e.prototype.removeObserveOne=function(t,e){MessageCenter.ins().removeListener(t.funcallname,e,this)},e.prototype.removeObserve=function(){MessageCenter.ins().removeAll(this)},e}(BaseClass);__reflect(BaseSystem.prototype,"BaseSystem");var EntityMcOrder;!function(t){t[t.BODY=0]="BODY",t[t.WEAPON=1]="WEAPON",t[t.WING=2]="WING",t[t.MOUNT=3]="MOUNT",t[t.MOUNT_UP=4]="MOUNT_UP"}(EntityMcOrder||(EntityMcOrder={}));var EntityRole=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.bodystrengthen=0,e.weaponstrengthen=0,e.isRobot=!1,e._nameTxt.anchorOffsetY=206,e._hpBar.anchorOffsetY=160,e._weapon=new MovieClip,e._bodyContainer.addChild(e._weapon),e._wing=new MovieClip,e._wing.visible=!1,e.addChildAt(e._wing,3),e._mount=new MovieClip,e._mountUp=new MovieClip,e._disOrder=[],e._disOrder[EntityMcOrder.BODY]=e._body,e._disOrder[EntityMcOrder.WEAPON]=e._weapon,e._disOrder[EntityMcOrder.WING]=e._wing,e._disOrder[EntityMcOrder.MOUNT]=e._mount,e._disOrder[EntityMcOrder.MOUNT_UP]=e._mountUp,e._wing.visible=e._weapon.visible=!1,e}return __extends(e,t),e.prototype.setBodyFileName=function(t){t!=this._bodyResourceName&&(this._bodyResourceName=t,this.readyUpdateMC())},e.prototype.setBodyStrengthen=function(t){var e=this.bodystrengthen;this.bodystrengthen=t,e!=AssetMgr.getStrengthenSource(t)&&this.readyUpdateMC()},e.prototype.getWeaponStrengthen=function(){return this.bodystrengthen},e.prototype.setJob=function(t){this.job=t},e.prototype.setWeaponFileName=function(t){t!=this._weaponFileName&&(this._weaponFileName=t,this._weapon.visible=!0,this.readyUpdateMC())},e.prototype.getWeaponFileName=function(){return this._weaponFileName},e.prototype.setMountFileName=function(t){t!=this._mountFileName&&(this._mountFileName=t,this._mount.visible=!0,this.readyUpdateMC())},e.prototype.getMountFileName=function(){return this._mountFileName},e.prototype.setWeaponStrengthen=function(t){var e=this.weaponstrengthen;this.weaponstrengthen=t,e!=AssetMgr.getStrengthenSource(t)&&this.readyUpdateMC()},e.prototype.setWingFileName=function(t){t!=this._wingFileName&&(this._wingFileName=t,this._wing.visible=!0,this._shadow.visible=!1,this.readyUpdateMC())},e.prototype.getBodyStrengthen=function(){return this.bodystrengthen},e.prototype.getJob=function(){return this.job},e.prototype.setMountUpDir=function(t){this._mountUpDirList={};for(var e=0,i=t;e<i.length;e++){var n=i[e];this._mountUpDirList[n]=!0}},e.prototype.refresh=function(){this.hasWing&&(this._wing.visible=!0),this._weapon.visible=!0,this._mount.visible=!0,this.updateMC()},e.prototype.updateMC=function(){if(this.hideModel)return this._body.clear(),this._weapon.clear(),this._mount.clear(),this._wing.clear(),void this._mountUp.clear();if(this.vo&&this.vo.xunyou)return this.updateXunyouMC(),this._mount.visible=!1,this._mountUp.visible=!1,this._wing.visible=!1,void(this._weapon.visible=!1);t.prototype.updateMC.call(this);var i=this.dir>=5?-1:1;this._body.hasEventListener(egret.Event.ENTER_FRAME)||this._body.addEventListener(egret.Event.ENTER_FRAME,this.onBodyEnterFrame,this),this.hasWing&&(this._wing.playFile(AssetMgr.getWingResource(this._wingFileName,this.dir,this.action),-1,null,!1),this._wing.scaleX=i);var n=this._weaponFileName&&""!=this._weaponFileName;n&&(this._weapon.playFile(AssetMgr.getWeaponResource(this._weaponFileName,this.weaponstrengthen,this.dir,this.action,this.hasWing),-1,null,!1),this._weapon.scaleX=i);var o=this._mountFileName&&""!=this._mountFileName;if(o){var s=AssetMgr.getMountResource(this._mountFileName,0,this.dir,this.action,this.hasWing);this._mount.playFile(s,-1,null,!1),this._mount.scaleX=i,this._mountUpDirList[this.dir]?(this._mountUp.playFile(s+"_up",-1,null,!1),this._mountUp.scaleX=i,this._mountUp.visible=!0):this._mount.visible&&(this._mountUp.visible=!1,this._mountUp.clear())}else this._mount.visible&&(this._mountUp.visible=!1);for(var r=e.FRAME_ODER[this.dir],a=r.length,h=0;a>h;h++){var l=r[h];this._bodyContainer.addChild(this._disOrder[l])}},e.prototype.updateXunyouMC=function(){var t=this.dir>=5?-1:1;this._body.stop(),this._body.scaleX=t,this._body.rate=this.getBodyRate();var e=null,i=-1,n="horse",o=AssetMgr.getOtherResource(n,this.dir,this.action);this._body.playFile(o,i,e,!1)},e.prototype.getBodyFileName=function(){return AssetMgr.getRoleBodySource(this._bodyResourceName,this.bodystrengthen,this.dir,this.action,this.hasWing)},e.prototype.onBodyEnterFrame=function(t){this.dir>=5?-1:1;this._weapon&&this._weapon.visible&&this._weapon.totalFrames>0&&this._weapon.gotoAndStop(this._body.currentFrame),this._wing&&this._wing.visible&&this._wing.totalFrames>0,this._mount&&this._mount.visible&&this._mount.totalFrames>0,this._mountUp&&this._mountUp.visible&&this._mountUp.totalFrames>0},e.prototype.stopFrame=function(t){this._body.stop(),this._wing.stop(),this._weapon.stop(),this._body.gotoAndStop(t),this._wing.visible&&this._wing.gotoAndStop(t),this._weapon.visible&&this._weapon.gotoAndStop(t),this._mount.visible&&this._mount.gotoAndStop(t),this._mountUp.visible&&this._mountUp.gotoAndStop(t)},Object.defineProperty(e.prototype,"hasWing",{get:function(){return this._wingFileName&&""!=this._wingFileName},enumerable:!0,configurable:!0}),e.prototype.movoNext=function(){if(this.path&&this.path.length){var t=this.path.shift(),e=this.path.shift();this.setDir(DirUtil.get8DirBy2Point(this,{x:t,y:e}));var i=this.getProp(FightAttr.SPEED);this.action!=EntityAction.RUN&&(i=64*this.speed/1e3),this.mover.moveTo(TimerManager.ins().getCurrTime(),t,e,i),this.handle==GameMap.centerEntity.handle&&1==GameLogic.ins().getSendMoveType()&&SceneControl.ins().sendMove(GameLogic.ins().getCurSceneId(),t,e,this.dir)}else this.stopMove(),this.playAction(EntityAction.STAND),this.path=null,this.handle==GameMap.centerEntity.handle&&GameLogic.ins().getSendMoveType()>0&&SceneControl.ins().sendMove(GameLogic.ins().getCurSceneId(),this.x,this.y,this.dir)},e.prototype.destruct=function(){this._body.removeEventListener(egret.Event.ENTER_FRAME,this.onBodyEnterFrame,this),this._wing.clear(),this._weapon.clear(),this._mount.clear(),this._mountUp.clear(),this._wing.visible=!1,this._weapon.visible=!1,this._weaponFileName="",this._wingFileName="",this._shadow.visible=!0,this.vo=null,t.prototype.destruct.call(this)},e.FRAME_ODER=[[EntityMcOrder.MOUNT,EntityMcOrder.WEAPON,EntityMcOrder.BODY,EntityMcOrder.WING],[EntityMcOrder.MOUNT,EntityMcOrder.MOUNT_UP,EntityMcOrder.BODY,EntityMcOrder.WEAPON,EntityMcOrder.WING],[EntityMcOrder.MOUNT,EntityMcOrder.BODY,EntityMcOrder.WING,EntityMcOrder.WEAPON],[EntityMcOrder.MOUNT,EntityMcOrder.WING,EntityMcOrder.WEAPON,EntityMcOrder.BODY,EntityMcOrder.MOUNT_UP],[EntityMcOrder.MOUNT,EntityMcOrder.WING,EntityMcOrder.BODY,EntityMcOrder.WEAPON],[EntityMcOrder.MOUNT,EntityMcOrder.WING,EntityMcOrder.WEAPON,EntityMcOrder.BODY,EntityMcOrder.MOUNT_UP],[EntityMcOrder.MOUNT,EntityMcOrder.BODY,EntityMcOrder.WING,EntityMcOrder.WEAPON],[EntityMcOrder.MOUNT,EntityMcOrder.MOUNT_UP,EntityMcOrder.BODY,EntityMcOrder.WEAPON,EntityMcOrder.WING]],e}(EntityMU);__reflect(EntityRole.prototype,"EntityRole");var ViewBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.setVisible=function(t){},e}(BaseView);__reflect(ViewBase.prototype,"ViewBase"),window.ViewBase=ViewBase;var LoadingViewBase=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.text=new eui.Label,this.text.text="资源加载中...",this.addChild(this.text)},e.prototype.setProgress=function(t,e){this.text.text="资源加载中..."+t+"/"+e},e}(BaseEuiView);__reflect(LoadingViewBase.prototype,"LoadingViewBase"),window.LoadingViewBase=LoadingViewBase;var TesterBasePage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.sendChatMessage=function(t){CommonUtils.log(t)},e}(BaseView);__reflect(TesterBasePage.prototype,"TesterBasePage"),window.TesterBasePage=TesterBasePage;var BossUIView_Single=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=BossItem,this.scroller.viewport=this.list,this.info.visible=!UtilProxy.shield,this.vipBtn.visible=!UtilProxy.shield,BossProxy.ins().getSimpleSweepVIP()>18?this.info.textFlow=UtilProxy.generateTextFlow("C:7&每天0点重置次数，SVIP"+(BossProxy.ins().getSimpleSweepVIP()-18)+"可扫荡"):this.info.textFlow=UtilProxy.generateTextFlow("C:7&每天0点重置次数，VIP"+BossProxy.ins().getSimpleSweepVIP()+"可扫荡"),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.vipBtn,this.onSweepClick),EventProxy.AddListener(this,EventType.S2CRepCopyOnekeySweep,this.S2CRepCopyOnekeySweep),EventProxy.AddListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.vipBtn,this.onSweepClick),EventProxy.AddListener(this,EventType.S2CRepCopyOnekeySweep,this.S2CRepCopyOnekeySweep),EventProxy.AddListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),this.clearData()},e.prototype.setVisible=function(t){this.visible=t,t?this.InitSys():this.clearData()},e.prototype.clearData=function(){},e.prototype.S2CRepCopyOnekeySweep=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.refreshData()},e.prototype.S2CRepCopyBuyTimes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],n=0;n<this.list.numChildren;++n){var o=this.list.getChildAt(n);o.data&&o.data.copy_id==i&&o.refresh()}},e.prototype.onSweepClick=function(t){if(BossProxy.ins().isSimpleEnoughVIP()){for(var e=!1,i=!1,n=!1,o=BossProxy.ins().GetBossConfigByType(1),s=0;s<o.length;++s){var r=GlobalConfig.getCopyConfigById(o[s].copy_id);if(r){var a=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),h=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),l=r.open_zhuan,p=r.open_level;
if(!(l>a||p>h)){var c=CopyProxy.ins().getCopyLeftTimeById(o[s].copy_id);if(c>0){e=!0;var u=BossProxy.ins().SimpleBossNextFreeTime(o[s].copy_id);if(u>0)break;if(n=!0,CopyProxy.ins().isCopyEnter(o[s].copy_id)){i=!0;break}}}}}i?BossProxy.ins().isBagLeftEnough()&&CopyProxy.ins().C2SReqCopyOnekeySweep(CopySpeciallogicType.simple_boss):e?n?TipsControl.ins().showTips("请先通关BOSS再扫荡！"):TipsControl.ins().showTips("CD时间未到！"):TipsControl.ins().showTips("已没挑战次数！")}else NoticeProxy.ins().OpenRecharge()},e.prototype.InitSys=function(){this.refreshData(),this.CheckGuide()},e.prototype.refreshData=function(){var t=BossProxy.ins().GetSingleBossSortConfig(1);this.list.dataProvider=new eui.ArrayCollection(t),this.vipInfo()},e.prototype.vipInfo=function(){this.vipBtn.label=BossProxy.ins().isSimpleEnoughVIP()?"一键扫荡":"激活VIP"},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BossUIView_Single.prototype,"BossUIView_Single"),window.BossUIView_Single=BossUIView_Single;var PropId;!function(t){t[t.PROP_ENTITY_ID=0]="PROP_ENTITY_ID",t[t.PROP_ENTITY_POSX=1]="PROP_ENTITY_POSX",t[t.PROP_ENTITY_POSY=2]="PROP_ENTITY_POSY",t[t.PROP_ENTITY_MODELID=3]="PROP_ENTITY_MODELID",t[t.PROP_ICON=4]="PROP_ICON",t[t.PROP_DIR=5]="PROP_DIR",t[t.PROP_MAX_ENTITY=6]="PROP_MAX_ENTITY",t[t.PROP_LEVEL=6]="PROP_LEVEL",t[t.PROP_HP=7]="PROP_HP",t[t.PROP_MP=8]="PROP_MP",t[t.PROP_MOVETIME=9]="PROP_MOVETIME",t[t.PROP_MAXHP=10]="PROP_MAXHP",t[t.PROP_MAXMP=11]="PROP_MAXMP",t[t.PROP_CREATURE_OUT_ATTACK=12]="PROP_CREATURE_OUT_ATTACK",t[t.PROP_CREATURE_OUT_DEFENCE=13]="PROP_CREATURE_OUT_DEFENCE",t[t.PROP_CREATURE_DEFCRITICALSTRIKES=14]="PROP_CREATURE_DEFCRITICALSTRIKES",t[t.PROP_CREATURE_ALL_ATTACK=15]="PROP_CREATURE_ALL_ATTACK",t[t.PROP_CREATURE_SUB_DEF=16]="PROP_CREATURE_SUB_DEF",t[t.PROP_CREATURE_INNER_ATTACK=17]="PROP_CREATURE_INNER_ATTACK",t[t.PROP_CREATURE_INNER_DEFENCE=18]="PROP_CREATURE_INNER_DEFENCE",t[t.PROP_CREATURE_CRITICALSTRIKES=19]="PROP_CREATURE_CRITICALSTRIKES",t[t.PROP_CREATURE_DODGERATE_VALUE=20]="PROP_CREATURE_DODGERATE_VALUE",t[t.PROP_CREATURE_HITRATE_VALUE=21]="PROP_CREATURE_HITRATE_VALUE",t[t.PROP_CREATURE_ATTACK_APPEND=22]="PROP_CREATURE_ATTACK_APPEND",t[t.PROP_HP_RENEW=23]="PROP_HP_RENEW",t[t.PROP_MP_RENEW=24]="PROP_MP_RENEW",t[t.PROP_ATTACK_SPEED=25]="PROP_ATTACK_SPEED",t[t.PROP_IN_ATTACK_DAMAGE_ADD=26]="PROP_IN_ATTACK_DAMAGE_ADD",t[t.PROP_OUT_ATTACK_DAMAGE_ADD=27]="PROP_OUT_ATTACK_DAMAGE_ADD",t[t.PROP_CREATURE_STATE=28]="PROP_CREATURE_STATE",t[t.PROP_BASE_MAXHP=29]="PROP_BASE_MAXHP",t[t.PROP_BASE_MAXMP=30]="PROP_BASE_MAXMP",t[t.PROP_STAND_POINT=31]="PROP_STAND_POINT",t[t.PROP_CAMP=32]="PROP_CAMP",t[t.PROP_RESEVS1=33]="PROP_RESEVS1",t[t.PROP_MAX_CREATURE=34]="PROP_MAX_CREATURE",t[t.PROP_MONSTER_START=34]="PROP_MONSTER_START",t[t.PROP_MONSTER_BORNPOINT=34]="PROP_MONSTER_BORNPOINT",t[t.PROP_MONSTER_LEVEL_DIFF=35]="PROP_MONSTER_LEVEL_DIFF",t[t.PROP_PET_TITLE=36]="PROP_PET_TITLE",t[t.PROP_PET_COLOR=37]="PROP_PET_COLOR",t[t.PROP_PET_SHOW_TITLE=38]="PROP_PET_SHOW_TITLE",t[t.PROP_MAX_MONSTER=39]="PROP_MAX_MONSTER",t[t.PROP_WEAPONMODEL=34]="PROP_WEAPONMODEL",t[t.PROP_MOUNT=35]="PROP_MOUNT",t[t.PROP_DIZZY_RATE11=36]="PROP_DIZZY_RATE11",t[t.PROP_DIZZY_TIME1=37]="PROP_DIZZY_TIME1",t[t.PROP_HP_STORE=38]="PROP_HP_STORE",t[t.PROP_MP_STORE=39]="PROP_MP_STORE",t[t.PROP_SPIRIT=40]="PROP_SPIRIT",t[t.PROP_ACTOR_PK_MOD=41]="PROP_ACTOR_PK_MOD",t[t.PROP_STONE_EFFECT=42]="PROP_STONE_EFFECT",t[t.PROP_WING_EFFECT=43]="PROP_WING_EFFECT",t[t.PROP_STAGE_EFFECT=44]="PROP_STAGE_EFFECT",t[t.PROP_SERVER_ID=45]="PROP_SERVER_ID",t[t.PROP_SMALL_TEAM_ID=46]="PROP_SMALL_TEAM_ID",t[t.PROP_SEX=47]="PROP_SEX",t[t.PROP_VOCATION=48]="PROP_VOCATION",t[t.PROP_ACTOR_EXP=49]="PROP_ACTOR_EXP",t[t.PROP_ACTOR_PK_VALUE=51]="PROP_ACTOR_PK_VALUE",t[t.PROP_ACTOR_BAG_GRID_COUNT=52]="PROP_ACTOR_BAG_GRID_COUNT",t[t.PROP_WEEK_CHARM=53]="PROP_WEEK_CHARM",t[t.PROP_ACTOR_BIND_COIN=54]="PROP_ACTOR_BIND_COIN",t[t.PROP_ACTOR_NONBIND_COIN=55]="PROP_ACTOR_NONBIND_COIN",t[t.PROP_ACTOR_BIND_YUANBAO=56]="PROP_ACTOR_BIND_YUANBAO",t[t.PROP_ACTOR_NONBIND_YUANBAO=57]="PROP_ACTOR_NONBIND_YUANBAO",t[t.PROP_ACTOR_SHENGWANG=58]="PROP_ACTOR_SHENGWANG",t[t.PROP_ACTOR_CHARM=59]="PROP_ACTOR_CHARM",t[t.PROP_SMALL_TEAM_LEFT_TIIME=60]="PROP_SMALL_TEAM_LEFT_TIIME",t[t.PROP_ACTOR_RENOWN=61]="PROP_ACTOR_RENOWN",t[t.PROP_GUILD_ID=62]="PROP_GUILD_ID",t[t.PROP_TEAM_ID=63]="PROP_TEAM_ID",t[t.PROP_ACTOR_SOCIALMASK=64]="PROP_ACTOR_SOCIALMASK",t[t.PROP_GUILD_EXP=65]="PROP_GUILD_EXP",t[t.PROP_ACTOR_WEEK_ZYCOUNT=66]="PROP_ACTOR_WEEK_ZYCOUNT",t[t.PROP_SYSTEM_OPEN=67]="PROP_SYSTEM_OPEN",t[t.PROP_ROOT_EXP_POWER=69]="PROP_ROOT_EXP_POWER",t[t.PROP_CHANGE_MODEL=70]="PROP_CHANGE_MODEL",t[t.PROP_JUMP_HP=71]="PROP_JUMP_HP",t[t.PROP_ACTOR_MAX_EXP=72]="PROP_ACTOR_MAX_EXP",t[t.PROP_ACTOR_GIVE_YUANBAO=74]="PROP_ACTOR_GIVE_YUANBAO",t[t.PROP_CRITICAL_STRIKE=75]="PROP_CRITICAL_STRIKE",t[t.PROP_ACTOR_EXP_RATE=76]="PROP_ACTOR_EXP_RATE",t[t.PROP_ACTOR_DEPOT_GRID_COUNT=77]="PROP_ACTOR_DEPOT_GRID_COUNT",t[t.PROP_ACTOR_ANGER=78]="PROP_ACTOR_ANGER",t[t.PROP_ROOT_EXP=79]="PROP_ROOT_EXP",t[t.PROP_ACTOR_ACHIEVEPOINT=80]="PROP_ACTOR_ACHIEVEPOINT",t[t.PROP_ACTOR_ZYCOUNT=81]="PROP_ACTOR_ZYCOUNT",t[t.PROP_QQ_VIP=82]="PROP_QQ_VIP",t[t.PROP_WING_ID=83]="PROP_WING_ID",t[t.PROP_WING_SCORE=84]="PROP_WING_SCORE",t[t.PROP_PET_SCORE=85]="PROP_PET_SCORE",t[t.PROP_VIP_FLAG=86]="PROP_VIP_FLAG",t[t.PROP_MOUNT_SCORE=87]="PROP_MOUNT_SCORE",t[t.PROP_SMALL_TEAM_TOTEM=88]="PROP_SMALL_TEAM_TOTEM",t[t.PROP_HONOR=89]="PROP_HONOR",t[t.PROP_CAMP_TITLE=90]="PROP_CAMP_TITLE",t[t.PROP_CAMP_RUNAWAY=91]="PROP_CAMP_RUNAWAY",t[t.PROP_GUILD_TOTAL_EXP=92]="PROP_GUILD_TOTAL_EXP",t[t.PROP_FIGHT_VALUE=93]="PROP_FIGHT_VALUE",t[t.PROP_DEITY_ORDER=94]="PROP_DEITY_ORDER",t[t.PROP_RECHARGE=95]="PROP_RECHARGE",t[t.PROP_VIP_LEVEL=96]="PROP_VIP_LEVEL",t[t.PROP_SHIELD=97]="PROP_SHIELD",t[t.PROP_FOOT_EFFECT=98]="PROP_FOOT_EFFECT",t[t.PROP_EQUIP_SCORE=99]="PROP_EQUIP_SCORE",t[t.PROP_HAIR_MODEL=100]="PROP_HAIR_MODEL",t[t.PROP_BUBBLE=101]="PROP_BUBBLE",t[t.PROP_ACTOR_STATE=102]="PROP_ACTOR_STATE",t[t.PROP_ZHAN_LING=103]="PROP_ZHAN_LING",t[t.PROP_PSYCHE=104]="PROP_PSYCHE",t[t.PROP_SC_SCORE=105]="PROP_SC_SCORE",t[t.PROP_XJ_LEVEL=106]="PROP_XJ_LEVEL",t[t.PROP_ADD_EXP=107]="PROP_ADD_EXP",t[t.PROP_MAX_ACTOR=108]="PROP_MAX_ACTOR"}(PropId||(PropId={}));var BmpNumber=function(t){function e(){var e=t.call(this)||this;return e.bmps=[],e.maxHeight=0,e.maxWidth=0,e}return __extends(e,t),e.prototype.setNumber=function(t,i,n){void 0===n&&(n=0);var o="";o=t>=1e8?(Number(t)/1e8).toFixed(2).toString()+"亿":t.toString(),o=o.replace(RegExpUtil.DOT_NUMBER,"");var s=Math.max(o.length,this.bmps.length),r=0;this.maxHeight=this.maxWidth=0;for(var a=0;s>a;a++){var h=this.bmps[a];if(h||(h=new egret.Bitmap,this.bmps[a]=h,this.addChild(h)),a<o.length){var l=o[a];"."==l&&(l="dian"),"万"==l&&(l="wan"),"亿"==l&&(l="yi");var p=e.parserUrl(i+l),c=RES.getRes(p);if(!c)throw new Error("BmpNumber类使用的数字资源必须提前预加载,在 num.png 中打包成图集"+e.parserUrl(i+o[a]));h.visible=!0,h.texture=c,this.maxHeight=Math.max(h.texture.textureHeight,this.maxHeight),this.maxWidth+=h.texture.textureWidth}else h.texture=null,h.visible=!1;h.x=r+n,r=h.x+h.width}},e.parserUrl=function(t){return t},Object.defineProperty(e.prototype,"height",{get:function(){return this.maxHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.maxWidth},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.alpha=this.scaleX=this.scaleY=1,this.maxHeight=this.maxWidth=0;for(var t=0,e=this.bmps;t<e.length;t++){var i=e[t];i.texture=null}},e}(egret.DisplayObjectContainer);__reflect(BmpNumber.prototype,"BmpNumber");var HotspotBitmap=function(t){function e(){var e=t.call(this)||this;return e._hotspot=[],e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouch,e),e}return __extends(e,t),e.prototype.addHotspotArea=function(t,e,i,n){this._hotspot.push({rect:t,callBack:e,thisObj:i,para:n})},e.prototype.onTouch=function(t){for(var e,i=t.localX,n=t.localY,o=0;o<this._hotspot.length;o++)e=this._hotspot[o],e.rect.contains(i,n)&&(e.para?e.callBack.call(e.thisObj,e.para):e.callBack.call(e.thisObj))},e}(egret.Bitmap);__reflect(HotspotBitmap.prototype,"HotspotBitmap");var MovieClip=function(t){function e(){var e=t.call(this)||this;return e.rate=1,e.touchEnabled=!1,e._mcFactory=new egret.MovieClipDataFactory,e}return __extends(e,t),e.clearData=function(){var t=GlobalConfig.getMisc_dataConfig(1);if(t&&1==t.memory_recovery){for(var e in this.url_list)this.url_list[e]&&"resource/assets/movie/ui_eff/10108"!=e&&(RES.destroyRes(e+".png"),RES.destroyRes(e+".json"));this.url_list={}}},e.setFrameRate=function(t,i){e.originalRate[t]=i},e.setUrl=function(t){e.url_list[t]=1},e.prototype.setFrameRate=function(t,i){e.originalRate[t]=i},e.prototype.playFile=function(t,i,n,o){var s=this;if(void 0===i&&(i=1),void 0===n&&(n=null),void 0===o&&(o=!0),this.time=egret.getTimer(),e.url_list[t]=1,this._compFun=n,this.playCount=i,this.remove=o,""!=t){if(TimerManager.ins().remove(this.playComp,this),this.name==t)return void this.createBody();this.name=t,this.jsonData=null,this.texture=null,RES.getResByUrl(this.name+".json",function(e){s.name==t&&e&&(s.jsonData=e,s.createBody())},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(this.name+".png",function(e){s.name==t&&e&&(s.texture=e,s.createBody())},this,RES.ResourceItem.TYPE_IMAGE)}},e.prototype.createBody=function(){if(this.jsonData&&this.texture){this._mcFactory.mcDataSet=this.jsonData,this._mcFactory.texture=this.texture;var t=this.name.split("/"),i=t.pop();if(this.movieClipData=this._mcFactory.generateMovieClipData(i),this.name in e.originalRate||(e.originalRate[this.name]=this.movieClipData.frameRate),this.frameRate=e.originalRate[this.name]*this.rate>>0,this.gotoAndPlay(1,this.playCount),this.visible=!0,this.playCount>0){var n=egret.getTimer()-this.time;n=this.playTime*this.playCount-n,n>0?TimerManager.ins().doTimer(n,1,this.playComp,this):this.playComp()}this.dispatchEventWith(egret.Event.CHANGE)}},e.prototype.playComp=function(){this.remove&&(this.clear(),DisplayUtils.removeFromParent(this)),this._compFun&&this._compFun()},Object.defineProperty(e.prototype,"playTime",{get:function(){return this.movieClipData?1/this.frameRate*this.totalFrames*1e3:0},enumerable:!0,configurable:!0}),e.prototype.clearComFun=function(){this._compFun=null},e.prototype.clear=function(){this.jsonData=null,this.texture=null,this._mcFactory.clearCache(),this.name="",TimerManager.ins().remove(this.playComp,this)},e.originalRate={},e.url_list={},e}(egret.MovieClip);__reflect(MovieClip.prototype,"MovieClip");var SkillEffPlayer=function(){function t(){}return t.play=function(t,e,i,n,o,s){void 0===i&&(i=[]),void 0===n&&(n=null),void 0===o&&(o=1),void 0===s&&(s="")},t.playConfigs=function(t,e,i,n,o,s){void 0===i&&(i=[]),void 0===n&&(n=null),void 0===o&&(o=1),void 0===s&&(s="")},t.type1=function(t,e,i,n,o){},t.type96=function(t,e,i,n,o){return this.shake?void 0:void console.warn("SkillEffPlayer.shake未设置")},t.type97=function(t,e,i,n,o){},t.type98=function(t,e,i,n,o){},t.type99=function(t,e,i,n,o){},t.type5=function(t,e,i,n,o){o&&o(1)},t.playEff=function(e,i,n,o,s,r){if(void 0===n&&(n=[]),void 0===o&&(o=null),void 0===s&&(s=1),void 0===r&&(r=""),!this.topLayer)return void console.warn("SkillEffPlayer.topLayer未设置");var a=GlobalConfig.getSkillDescById(Math.floor(e.skillId/1e4));if(!a)return void TipsControl.ins().showTips("找不到技能描述配置:"+e.skillId);if(0==a.skill_effs.length)return void this.setTimeout(300/s,function(){o(1)},this);var h=a.skill_effs[0],l=GlobalConfig.getSkillEffConfig(h);if(void 0==l)return void TipsControl.ins().showTips("没有这个技能特效，特效id:"+h);var p=t.urlSkillEff+l.res;MovieClip.setFrameRate(p,l.frame_rate);var c=this["playType"+l.type];c&&c.call(this,l,i,s,p,o)},t.playType1=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);for(var r=t.radius,a=t.num,h=t.time,l=function(o){var l=p.getPoint(r[o],0,0,a[o]);p.setTimeout(h[o]/i,function(){for(var o=function(o){var r=MathUtils.getRandom(1,27);s.setTimeout(r/i,function(){var i=new MovieClip;s.addToLayer(i,t.layer),i.frameRate=t.frame_rate,i.playFile(n,1,function(){},!0),i.x=e.x+l[o].x,i.y=e.y+l[o].y,i.scaleX*=t.scale[0],i.scaleY*=t.scale[1]},s)},r=0;r<l.length;r++)o(r)},p)},p=this,c=0;c<a.length;c++)l(c);this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType2=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);for(var r=t.radius,a=t.num,h=(t.time,(t.angle-90)/2),l=this.angle_list[e.dir][0]-h,p=this.angle_list[e.dir][1]+h,c=function(i){var o=(p-l)/(i+1);u.setTimeout(r[i],function(){for(var h=0;h<a[i];h++){var p=new MovieClip;s.addToLayer(p,t.layer),p.frameRate=t.frame_rate,p.playFile(n,1,function(){},!0);var c=MathUtils.getRadian(l+(h+.5)*o),u=Math.cos(c)*r[i],d=Math.sin(c)*r[i];p.x=e.x+u,p.y=e.y+d,p.scaleX*=t.scale[0],p.scaleY*=t.scale[1]}},u)},u=this,d=0;d<a.length;d++)c(d);this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType3=function(e,i,n,o,s){void 0===s&&(s=null),o=t.urlSkillEff+e.res+"_"+i.action+DirUtil.get5DirBy8Dir(i.dir);var r=new MovieClip;r.scaleX=i.getBodyScaleX(),this.addToLayer(r,e.layer),r.x=i.x,r.y=i.y,r.frameRate=e.frame_rate,r.scaleX*=e.scale[0],r.scaleY*=e.scale[1],r.playFile(o,1,function(){},!0),this.setTimeout(e.damage_delay/n,function(){s(1)},this)},t.playType4=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);var r=new MovieClip;r.scaleX=e.scaleX,this.addToLayer(r,t.layer),r.x=e.x+t.c_pos[0],r.y=e.y+t.c_pos[1],r.frameRate=t.frame_rate,r.playFile(n,1,function(){},!0),this.setTimeout(t.damage_delay/i,function(){o(1)},this),r.rotation=45*e.dir,r.width=r.width*t.scale[0],r.height=r.height*t.scale[1],this.setTimeout(190/i,function(){var i=new MovieClip;i.scaleX=e.scaleX,s.addToLayer(i,t.layer);s.getRealValue(t.c_pos[0],t.c_pos[1],e.dir);i.x=e.x+t.c_pos[0],i.y=e.y+t.c_pos[1],i.frameRate=t.frame_rate,i.playFile(n,1,function(){},!0),i.rotation=45*e.dir,r.scaleX*=t.scale[0],r.scaleY*=t.scale[1]},this)},t.playType5=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);for(var r=t.radius,a=t.num,h=t.time,l=[],p=10,c=0;c<a.length;c++)for(var u=0;u<a[c];u++){var d=this.getPoint(r[c]+MathUtils.getRandom(-p,p),0,0,a[c]);l.push({x:d[u].x,y:d[u].y})}for(var g=function(o){y.setTimeout(h[0]*Math.random()/i,function(){var i=new MovieClip;s.addToLayer(i,t.layer),i.frameRate=t.frame_rate,i.playFile(n,1,function(){},!0),i.x=e.x+l[o].x,i.y=e.y+l[o].y,i.scaleX*=t.scale[0],i.scaleY*=t.scale[1]},y)},y=this,c=0;c<l.length;c++)g(c);this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType6=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);for(var r=t.radius,a=t.num,h=(t.time,(t.angle-90)/2),l=this.angle_list[e.dir][0]-h,p=this.angle_list[e.dir][1]+h,c=[],u=0;u<a.length;u++)for(var d=(p-l)/(u+1),g=0;g<a[u];g++){var y=MathUtils.getRadian(l+(g+.5)*d),f=MathUtils.getRandom(-10,10),_=Math.cos(y)*(r[u]+f),v=Math.sin(y)*(r[u]+f);c.push({x:_,y:v})}for(var m=function(o){C.setTimeout(t.time[0]*Math.random()/i,function(){var i=new MovieClip;s.addToLayer(i,2),i.frameRate=t.frame_rate,i.playFile(n,1,function(){},!0),i.x=e.x+c[o].x,i.y=e.y+c[o].y,i.scaleX*=t.scale[0],i.scaleY*=t.scale[1]},C)},C=this,u=0;u<c.length;u++)m(u);this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType7=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);for(var r=t.num[0],a=t.num[1],h=480,l=800,p=0,c=100,u=480/r,d=600/a,g=function(o){for(var a=function(r){y.setTimeout((150*o+10*r)/i,function(){var i=new MovieClip;s.addToLayer(i,t.layer),i.frameRate=t.frame_rate,i.playFile(n,1,function(){},!0),i.x=e.x+u*(r+.5)+(p-h/2),i.y=e.y+d*(o+.5)+(c-l/2)},y)},g=0;r>g;g++)a(g)},y=this,f=0;a>f;f++)g(f);this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType8=function(t,e,i,n,o){var s=this;void 0===o&&(o=null);var r=t.radius[0]||300,a=t.num[0]||8,h=t.time[0]||600,l=this.getPoint(10,0,0,a),p=this.getPoint(r,0,0,a),c=egret.Ease.sineIn;2==t.ease?c=function(t){return 2*t+t*t}:3==t.ease&&(c=function(t){return 2*t-t*t});for(var u=function(o){var r=MathUtils.getRandom(1,27);d.setTimeout(r/i,function(){var i=new MovieClip;s.addToLayer(i,t.layer),i.frameRate=t.frame_rate,i.playFile(n,1,function(){},!0),i.x=e.x+l[o].x,i.y=e.y+l[o].y,i.scaleX*=t.scale[0],i.scaleY*=t.scale[1];var r=egret.Tween.get(i);r.to({x:e.x+p[o].x,y:e.y+p[o].y},h,c).call(function(){},s)},d)},d=this,g=0;g<l.length;g++)u(g);this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType9=function(t,e,i,n,o){void 0===o&&(o=null);var s=(t.radius[0]||300,t.num[0]||5),r=t.time[0]||600,a=(t.angle-90)/2,h=this.angle_list[e.dir][0]-a,l=this.angle_list[e.dir][1]+a,p=(l-h)/s,c=egret.Ease.sineIn;2==t.ease?c=function(t){return 2*t+t*t}:3==t.ease&&(c=function(t){return 2*t-t*t});for(var u=0;s>u;u++){var d=new MovieClip;this.addToLayer(d,t.layer),d.frameRate=t.frame_rate,d.playFile(n,t.item_times,function(){},!0);var g=MathUtils.getRadian(h+(u+.5)*p),y=10*Math.cos(g),f=10*Math.sin(g),_=500*Math.cos(g),v=500*Math.sin(g);d.x=e.x+y,d.y=e.y+f,d.scaleX*=t.scale[0],d.scaleY*=t.scale[1];var m=egret.Tween.get(d);m.to({x:e.x+_,y:e.y+v},r,c).call(function(){},this)}this.setTimeout(t.damage_delay/i,function(){o(1)},this)},t.playType10=function(t,e,i,n,o){var s=this;void 0===o&&(o=null),this.eff_in_play=!0;for(var r=240,a=400,h=[[{x:-r,y:0}],[{x:-r+200,y:-a+300},{x:-r+370,y:-a+170}],[{x:-r,y:-a+250},{x:-r+100,y:-a+50},{x:-r+280,y:-a-70},{x:-r-10,y:-a+458}]],l=function(i){for(var o=h[i],r=250*i,a=function(i){TimerManager.ins().doTimer(500+r,1,function(){var r=new MovieClip;s.addToLayer(r,t.layer),r.playFile(n,1,function(){},!0),r.x=e.x+o[i].x+200,r.y=e.y+o[i].y+200,r.scaleX=1,r.scaleY=1},p)},l=0;l<o.length;l++)a(l)},p=this,c=0;c<h.length;c++)l(c);this.setTimeout(250*h.length,function(){s.eff_in_play=!1},this),this.setTimeout((500+t.damage_delay)/i,function(){o(1)},this)},t.getPoint=function(t,e,i,n,o){void 0===o&&(o=360);for(var s=[],r=Math.PI/180*Math.round(o/n),a=0;n>a;a++){var h=e+t*Math.sin(r*a),l=i+t*Math.cos(r*a);s.unshift({x:h,y:l})}return s},t.getRealValue=function(t,e,i){switch(i){case 1:return{x:t,y:-e};case 3:return{x:t,y:e};case 5:return{x:-t,y:e};case 7:return{x:-t,y:-e}}return{x:t,y:e}},t.addToLayer=function(t,e){switch(e){case 2:this.bottomLayer.addChild(t);break;case 1:this.topLayer.addChild(t)}},t.urlRoot="",t.urlSkill="res/skill/",t.urlSkillEff="resource/assets/movie/skillEff/",t.eff_in_play=!1,t.angle_list=[[],[270,360],[],[0,90],[],[90,180],[],[180,270],[]],t.tween_pos=[{x:152,y:511},{x:246.05,y:175.75},{x:95.47,y:291.79},{x:-73.81,y:221.97},{x:422.11,y:175.38},{x:232.36,y:380.44},{x:6.66,y:504.53},{x:318.27,y:497.89},{x:517.27,y:409.94},{x:161.64,y:663.13},{x:504.88,y:581.43},{x:334.65,y:722.47}],t}();__reflect(SkillEffPlayer.prototype,"SkillEffPlayer");var skillEff=function(){function t(){}return t}();__reflect(skillEff.prototype,"skillEff");var TT=function(){function t(){this.proto=new Proto}return t}();__reflect(TT.prototype,"TT");var tt=new TT,GuideMaskBackgroud=function(t){function e(){var e=t.call(this)||this;return e._stageWidth=0,e._stageHeight=0,e._bgs=new Array,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.init=function(t,e){this._stageWidth=t,this._stageHeight=e},e.prototype.draw=function(t){this.cacheAsBitmap=!1,this._deductRec=t,this.removeAllChild();var e=Math.max(t.x,0),i=Math.max(t.y,0),n=Math.min(t.x+t.width,this._stageWidth),o=Math.min(t.y+t.height,this._stageHeight);this.addBg(0,0,this._stageWidth,i),this.addBg(0,i,e,t.height),this.addBg(n,i,this._stageWidth-n,t.height),this.addBg(0,o,this._stageWidth,this._stageHeight-o),this.width=this._stageWidth,this.height=this._stageHeight,this.cacheAsBitmap=!0},e.prototype.destroy=function(){this.removeChildren(),this._bgs=[]},e.prototype.removeAllChild=function(){for(;this.numChildren;){var t=this.removeChildAt(0);this._bgs.push(t)}},e.prototype.addBg=function(t,e,i,n){var o;this._bgs.length?(o=this._bgs.pop(),o.graphics.clear()):o=new egret.Shape,o.graphics.beginFill(0,.5),o.graphics.drawRect(t,e,i,n),o.graphics.endFill(),this.addChild(o)},e.prototype.hitTest=function(t,e,i){return this._deductRec&&this._deductRec.contains(t,e)?null:this},e}(egret.Sprite);__reflect(GuideMaskBackgroud.prototype,"GuideMaskBackgroud");var GuideUtils=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.configData={1:{1:{txt:"点击这里，查看人物"},2:{txt:"点击这里\n自动穿上最好的装备"},3:{txt:"点击关闭界面"}},2:{1:{txt:"更多宠物，可以抽取获得哦！",txtdir:1,handDir:2},2:{txt:"点击抽取宠物",txtdir:1,handDir:1}},3:{1:{txt:"点击选择另一个宠物",txtdir:1,handDir:1},2:{txt:"点击宠物出战",txtdir:3,handDir:1}},4:{1:{txt:"点击查看宠物属性",txtdir:4,handDir:1},2:{txt:"点击宠物升级",txtdir:1,handDir:2},3:{txt:"点击选择升级材料",txtdir:3,handDir:1},4:{txt:"选择一个宠物或卡牌作为材料",txtdir:3,handDir:1},5:{txt:"选择材料后点击确定回到升级界面",txtdir:1,handDir:2},6:{txt:"点击完成升级",txtdir:1,handDir:2}},5:{1:{txt:"现在立刻享受\n炫酷的飞行吧",txtdir:1,handDir:2},2:{txt:"每天前3次购买免费",txtdir:1,handDir:1},3:{txt:"开始战斗吧",txtdir:1,handDir:2}},6:{1:{txt:"点击这里查看战机",txtdir:1,handDir:1},2:{txt:"点击升级战机，\n可以提高战力",txtdir:1,handDir:2}},7:{1:{txt:"挑战BOSS增加效率"}},8:{1:{txt:"击败BOSS，掉落装备"}}},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.next=function(t){this.triggered==t&&null!=this.view&&null!=this.view.parent&&this.hide()},e.prototype.show=function(t,e,i){},e.prototype.test=function(t,e,i){this.triggered=t,null==this.view&&(this.view=new GuideView)},e.prototype.hide=function(){DisplayUtils.removeFromParent(this.view),this.triggered=null},e.prototype.isShow=function(){return null!=this.view&&null!=this.view.parent},e}(BaseClass);__reflect(GuideUtils.prototype,"GuideUtils");var GuideView=function(t){function e(){var e=t.call(this)||this;return egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,e.onResize,e),e}return __extends(e,t),e.prototype.AddListenerEvent=function(t){this.addTouchEvent(t,GuideProxy.ins().onChangeStage)},e.prototype.onResize=function(){},e}(BaseEuiView);__reflect(GuideView.prototype,"GuideView");var LoginControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.sendLogin=function(){var t=new net_protocol.C2SLogin;t.plat_name=GameSocket.ins()._user,t.login_time=TimerManager.ins().getCurrTime(),t.login_str="uiop",t.server_id=LocationProperty.srvid,t.anti_wallow=0,t.device_id=this.GetDevice(),t.plat_id=SdkManager.isUseSdk?SdkManager.ins().ChannelID:9001,t.platfrom=DeviceUtils.IsIos?1:2,this.sendPbPack(Msg.C2S_LOGIN,t,net_protocol.C2SLogin),LocationProperty.consoleWrite("请求登陆"),CommonUtils.log("请求登陆")},e.prototype.sendAuthentication=function(){var t=new net_protocol.C2SAuthentication;t.plat_name=GameSocket.ins()._user,t.login_time=TimerManager.ins().getCurrTime(),t.login_str="uiop",t.server_id=LocationProperty.srvid,t.anti_wallow=0,t.device_id=this.GetDevice(),t.plat_id=SdkManager.isUseSdk?SdkManager.ins().ChannelID:9001,t.platfrom=DeviceUtils.IsIos?1:2,this.sendPbPack(Msg.C2S_AUTHENTICATION,t,net_protocol.C2SAuthentication),CommonUtils.log("请求验证登陆")},e.prototype.sendCreaterole=function(t,e,i,n,o,s){var r=new net_protocol.C2SCreateRole;r.plat_name=GameSocket.ins()._user,r.login_time=TimerManager.ins().getCurrTime(),r.login_str="uiop",r.server_id=LocationProperty.srvid,r.anti_wallow=0,r.role_name=t,r.professsinal=i,r.sex=e,r.index=1,this.sendPbPack(Msg.C2S_CREATE_ROLE,r,net_protocol.C2SCreateRole),CommonUtils.log("请求创建角色")},e.prototype.sendEnterGame=function(t,e){var i=new net_protocol.C2SEnterGame;if(i.index=t,i.role_id=e,i.plat_name=GameSocket.ins()._user,SdkManager.ins().sdktype==SdkType.WeiXin){var n=SdkManager.ins().sdk.getSystemInfo();i.ip=0,i.phone_model=n.device_model,i.network_code=0,i.network_type=n.net,i.device_id="",i.resolution=n.wpi+"*"+n.hpi,i.os=n.os_ver,i.plat_id=SdkManager.ins().lyid,i.platfrom=DeviceUtils.IsIos?1:2}else i.ip=1,i.phone_model="",i.network_code=0,i.network_type=1,i.device_id=this.GetDevice(),i.resolution=StageUtils.ins().getWidth()+"*"+StageUtils.ins().getHeight(),i.os="",i.plat_id=SdkManager.ins().ChannelID,i.platfrom=DeviceUtils.IsIos?1:2;this.sendPbPack(Msg.C2S_ENTER_GAME,i,net_protocol.C2SEnterGame),LocationProperty.consoleWrite("请求进入游戏")},e.prototype.sendBeatPack=function(){var t=new net_protocol.C2SHeartBeat;this.sendPbPack(Msg.C2S_HEART_BEAT,t,net_protocol.C2SHeartBeat)},e.prototype.onLoginResult=function(t){CommonUtils.log("onLoginResult called!");var e=t.reulst;if(this.game_info=t,0==e){var i=t.ip,n=t.port;GameSocket.ins().connectgw(_int2ip(i),n)}},e.prototype.onAuthenticationResult=function(t){if(CommonUtils.log("onAuthenticationResult result:"+t.reulst),t.reulst>0){var e=this.game_info.ip,i=this.game_info.port;GameSocket.ins().connectgw(_int2ip(e),i)}},e.prototype.onRoleList=function(t){LoginProxy.ins().setLocalStorage("user_name",GameSocket.ins()._user),LoginProxy.ins().setLocalStorage("last_server",String(LoginProxy.cur_server_data.server_id)),0==t.role_list.length?(ViewManager.ins().open(CreateCharView),ViewManager.ins().close(StartGameView)):this.sendEnterGame(t.role_list[0].index,t.role_list[0].role_id)},e.prototype.onCreateRole=function(t){this.sendEnterGame(t.index,t.role_id)},e.prototype.onRoleDataInfo=function(t){CommonUtils.log("onRoleDataInfo called:"+t.role_id),this.startgame()},e.prototype.sendHeartbeat=function(){this.heartBeatTimer},e.prototype.opencreateroleview=function(){SceneManager.ins().runScene(CreateRoleScene)},e.prototype.startgame=function(){CopyProxy.ins().C2SReqCopyGetData(0),ChatProxy.ins().C2SReqGlobalchatGetInfo(),TitleProxy.ins().C2SReqTitleGetInfo(),SceneManager.ins().runScene(MainScene)},e.prototype.GetDevice=function(){var t="";return(SdkManager.ins().sdktype==SdkType.HUOSDK||SdkManager.ins().sdktype==SdkType.QQ)&&(SdkManager.ins().sdk.launchOption.scene&&SdkManager.ins().sdk.launchOption.query.via?t=SdkManager.ins().sdk.launchOption.scene+"_"+SdkManager.ins().sdk.launchOption.query.via:SdkManager.ins().sdk.launchOption.scene?t=SdkManager.ins().sdk.launchOption.scene:SdkManager.ins().sdk.launchOption.query.via&&(t=SdkManager.ins().sdk.launchOption.query.via)),console.log("GetDevice str = ",t),t},e}(BaseSystem);__reflect(LoginControl.prototype,"LoginControl");var GameSystem;!function(t){t.sLoginControl=LoginControl.ins.bind(LoginControl)}(GameSystem||(GameSystem={}));var SceneControl=function(t){function e(){var e=t.call(this)||this;return e.entityList=[],e.isRecordDamage=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2STransferScene=function(t,e,i){if(YezhanProxy.ins().isRunning())return void TipsControl.ins().showTips("请等待野战结束!");if(CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId))return void TipsControl.ins().showTips("C:4&当前处于副本或活动场景，无法传送");var n=GameLogic.ins().getCurSceneData();if(1!=n.speciallogic_type&&GameLogic.ins().isInXunyou())return void TipsControl.ins().showTips("C:4&当前处于副本或活动场景，无法传送");var o=GlobalConfig.getSceneConfigById(t);if(6==n.scene_type&&6==o.scene_type)return void TipsControl.ins().showTips("C:4&当前处于Boss场景，无法传送");if((2==n.scene_type||3==n.scene_type)&&6==o.scene_type)return void TipsControl.ins().showTips("C:4&当前处于副本场景，无法传送");var s=new net_protocol.C2STransferScene;s.scene_id=t,s.scene_x=parseFloat((e/100).toFixed(2)),s.scene_y=parseFloat((i/100).toFixed(2)),this.sendPbPack(Msg.C2STransferScene,s,net_protocol.C2STransferScene)},e.prototype.C2SReqMiscResurgence=function(t,e,i,n){var o=new net_protocol.C2SReqMiscResurgence;o.type=t,o.scene_type_id=e,o.scene_x=i,o.scene_y=n,this.sendPbPack(Msg.C2SReqMiscResurgence,o,net_protocol.C2SReqMiscResurgence)},e.prototype.sendMove=function(t,e,i,n){if(void 0==GameLogic.ins().getCurSceneData()||1!=GameLogic.ins().getCurSceneData().client_create_monster){var o=new net_protocol.C2SMove;o.dir=n,o.pos_x=e/GameMap.CELL_SIZE,o.pos_y=i/GameMap.CELL_SIZE,o.scene_id=t,this.sendPbPack(Msg.C2S_MOVE,o,net_protocol.C2SMove)}},e.prototype.C2SPerformSkill=function(t,e,i,n,o,s,r){var a=new net_protocol.C2SPerformSkill;a.skill_index=t,a.pos_x=Math.ceil(e/GameMap.CELL_SIZE),a.pos_y=Math.ceil(i/GameMap.CELL_SIZE),a.client_pos_x=Math.ceil(n/GameMap.CELL_SIZE),a.client_pos_y=Math.ceil(o/GameMap.CELL_SIZE),a.only_id=s,a.obj_id=r,this.sendPbPack(Msg.C2SPerformSkill,a,net_protocol.C2SPerformSkill)},e.prototype.C2SSkillAttack=function(t,e,i,n,o,s){var r=new net_protocol.C2SSkillAttack;r.skill_index=t,r.pos_x=Math.ceil(e/GameMap.CELL_SIZE),r.pos_y=Math.ceil(i/GameMap.CELL_SIZE),r.client_pos_x=Math.ceil(n/GameMap.CELL_SIZE),r.client_pos_y=Math.ceil(o/GameMap.CELL_SIZE),r.obj_id=s,this.sendPbPack(Msg.C2SSkillAttack,r,net_protocol.C2SSkillAttack)},e.prototype.onMove=function(t){GameLogic.ins().doEntityMove(t)},e.prototype.onMonsterEnter=function(t){GameLogic.ins().doCreateMonster(t)},e.prototype.onRemoveObj=function(t){GameLogic.ins().doRemoveEntity(t.obj_id)},e.prototype.addEntity=function(t){this.entityList.push(t),GameMap.ins().addEntity(t)},e.prototype.getEntityByHandle=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.handle==t)return n}return null},e.prototype.onBlood=function(t){SkillCC.ins().doSkillResult(t)},e.prototype.onBloods=function(t){SkillCC.ins().doSkillListResult(t)},e.prototype.onPerformSkill=function(t){GameLogic.ins().onPerformSkill(t)},e.prototype.onEntityDie=function(t){},e.prototype.initDamageData=function(){this.hurtList={},SkillCC.ins().isRecordDamage=!0},e.prototype.addHurt=function(t,e){void 0==this.hurtList[t]&&(this.hurtList[t]={},this.hurtList[t].name=e,this.hurtList[t].hurt=0)},e.prototype.endDamageData=function(){SkillCC.ins().isRecordDamage=!1,this.hurtList=void 0},e}(BaseSystem);__reflect(SceneControl.prototype,"SceneControl");var GameSystem;!function(t){t.sSceneControl=SceneControl.ins.bind(SceneControl)}(GameSystem||(GameSystem={}));var GameMap=function(t){function e(){var e=t.call(this)||this;return e.fbId=0,e.prevFbId=0,e.shuntID=0,e.isFind=0,e.extendGetPath=null,e.imgSize=256,e._shape=[],e._hang=[],e.mapName="",e.lastUpdateX=0,e.lastUpdateY=0,e.images={},e.textrues={},e.lastDestroy=0,e}return __extends(e,t),e.ins=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.init=function(){this.grid=this.grid||new MapGrid,this.aStar=this.aStar||new AStar,this.initMap()},e.prototype.dataTest=function(){},e.prototype.changePos=function(t){return Math.floor(e.CELL_SIZE*t/100)},e.prototype.parserBytes=function(){e.CELL_SIZE=64;var t=GlobalConfig.getSceneEditorById(e.ins().mapID);e.edit_data=t,this.MAX_WIDTH=t.pixel_width,this.MAX_HEIGHT=t.pixel_height,this.COL=t.width,this.ROW=t.height,this.grid.initGrid(this.ROW,this.COL,t),this.aStar.initFromMap(this.grid)},e.prototype.getPxPos=function(t){return 64*t/100},e.prototype._getPath=function(t,i,n,o){void 0===i&&(i=null),void 0===n&&(n=e.ins().checkWalkable),void 0===o&&(o=1),i||(i=e.centerEntity);var s=t.x>>0,r=t.y>>0,a=i.x>>0,h=i.y>>0;if(a==s&&h==r)return null;var l,p,c,u,d,g,y=64,f=64,_=a/y>>0,v=h/f>>0,m=s/y>>0,C=r/f>>0,S=0,w=0;if(p=BresenhamLine.isAbleToThrough(_,v,m,C,n),p[0])return l=[],l[0]=s,l[1]=r,l;if(d=egret.getTimer(),c=this.aStar.getPath(_,v,m,C,n),d=egret.getTimer()-d,c){g=egret.getTimer(),l=[];for(var x=c.length,T=x;T>0;T--){T!=x&&(u=c[T],_=u.nX+.5,v=u.nY+.5);var b=0;for(b=0;T>b;b++)if(0!=b?(u=c[b],m=u.nX+.5,C=u.nY+.5):(m=s/y,C=r/f),p=BresenhamLine.isAbleToThrough(_,v,m,C,n),p[0]){l[l.length]=m*y,l[l.length]=C*f,T=b+1;break}b==T&&(T==x||1==T?(m>_?n(_+1>>0,v>>0)?(S=1,w=0):(S=0,w=C>v?1:-1):n(_-1>>0,v>>0)?(S=-1,w=0):(S=0,w=C>v?1:-1),_=m>_?_+1>>0:_>>0,v=C>v?v+1>>0:v>>0,l[l.length]=_*y+S,l[l.length]=v*f+w,1==T?(l[l.length]=s,l[l.length]=r):(_=l[l.length-2]/y,v=l[l.length-1]/f,T++)):(l[l.length]=m*y,l[l.length]=C*f))}g=egret.getTimer()-g}return d+g>=500&&CommonUtils.log("<font color='#ff0000'>寻路耗时",d,"修正耗时",g+"</font>"),l},e.prototype.getPath=function(t,i,n,o){return void 0===i&&(i=null),void 0===n&&(n=e.ins().checkWalkable),void 0===o&&(o=1),this.extendGetPath?this.extendGetPath.call(this.getPathObj,t,i,n,o):this._getPath(t,i,n,o)},e.prototype.getAroundPoint=function(t,e,i){var n=Math.pow(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),.5),o=(e.x-t.x)/n,s=(e.y-t.y)/n,r=i*o,a=i*s;
return{x:e.x-r,y:e.y-a}},e.prototype.getAroundPath=function(t,i,n){void 0===n&&(n=e.ins().checkWalkableTemp);for(var o=e.CELL_SIZE,s=Math.floor(t.x/o),r=Math.floor(t.y/o),a=null,h=Number.MAX_VALUE,l=0,p=0,c=0;8>c;++c){var u=8>c?AStar.NEIGHBORPOS_X_VALUES[c]:AStar.NEIGHBORPOS_X_VALUES2[c-8],d=8>c?AStar.NEIGHBORPOS_Y_VALUES[c]:AStar.NEIGHBORPOS_Y_VALUES2[c-8],g=s+u,y=r+d;if(!(0>g||g>=this.COL||0>y||y>=this.ROW)&&n(g,y)){var f=(g+.5)*o,_=(y+.5)*o,v=Math.pow(f-t.x,2)+Math.pow(_-t.y,2);h>v&&(h=v,l=f,p=_)}}if(l&&p){var m=this.grid.getNode(s,r);m&&(m.handle=Number.MAX_VALUE),a=this.getPath({x:l,y:p},i,n),m&&(m.handle=0)}return a},e.prototype.checkWalkable=function(t,i){var n=!1,o=e.ins().grid.getNode(t,i);return o&&(n=o.walkable),n},e.prototype.checkWalkableTemp=function(t,i){var n=!1,o=e.ins().grid.getNode(t,i);return o&&(n=o.walkable&&0==o.handle),n},e.prototype.checkWalkableByPixel=function(t,i){var n=Math.floor(t/e.CELL_SIZE),o=Math.floor(i/e.CELL_SIZE);return this.checkWalkable(n,o)},e.prototype.checkAlpha=function(t,e){var i=!1,n=this.grid.getNode(t,e);return n&&(i=n.hidden),i},e.prototype.capture=function(t,i,n){void 0===n&&(n=0);var o=Math.floor(t/e.CELL_SIZE),s=Math.floor(i/e.CELL_SIZE),r=this.grid.getNode(o,s);r?r.handle=n:CommonUtils.log("你需要占领的格子不存在:"+o+","+s)},e.prototype.checkInMap=function(t,i){return t/e.CELL_SIZE<=this.COL&&i/e.CELL_SIZE<=this.ROW},e.prototype.getFileName=function(){return this.mapName},e.prototype.addToParent=function(t){void 0===t&&(t=null),t&&(this.myParent=t),this.myParent&&this.myParent.addChild(this)},e.prototype.removeFromParent=function(){for(var t=0;t<this._entityLayer.numChildren;t++){this._entityLayer.getChildAt(t)}},e.prototype.addEffectToGround=function(t){this._effDownLayer.addChild(t)},e.prototype.addEffectToEntityUp=function(t){this._effUpLayer.addChild(t)},e.prototype.initMap=function(){this._stepIndex={},this._mapContainer=new egret.DisplayObjectContainer,this._mapContainer.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.postGridClick,this),this._mapContainer.touchChildren=!1,this._mapContainer.touchEnabled=!0,this.addChild(this._mapContainer),this.initBg(),this._dropLayer=new egret.DisplayObjectContainer,this.addChild(this._dropLayer),this._effDownLayer=new egret.DisplayObjectContainer,this.addChild(this._effDownLayer),this._entityLayer=new egret.DisplayObjectContainer,this.addChild(this._entityLayer),this._effUpLayer=new egret.DisplayObjectContainer,this.addChild(this._effUpLayer),this._bloodLayer=new egret.DisplayObjectContainer,this.addChild(this._bloodLayer),TimerManager.ins().doTimer(500,0,this.sortEntity,this),SkillEffPlayer.bottomLayer=this._effDownLayer,SkillEffPlayer.topLayer=this._effUpLayer,SkillEffPlayer.setTimeout=function(t,e,i){TimerManager.ins().doTimer(t,1,e,i)},SkillEffPlayer.shake=function(t,i,n,o,s){s=s||1,t.handle==e.centerEntity.handle&&Math.random()<s&&DisplayUtils.shakeIt(e.ins(),i,n,o)}},e.prototype.sortEntity=function(){this._entityLayer.$children.sort(e.sortF)},e.sortF=function(t,e){return Algorithm.sortAsc(t.y,e.y)},e.prototype.addEntity=function(t){this._entityLayer.addChild(t)},e.removeEntity=function(t){DisplayUtils.removeFromParent(t)},e.pix2grid=function(t){return Math.floor(t/e.CELL_SIZE)},e.prototype.postGridClick=function(t){return{x:t.localX,y:t.localY}},e.prototype.lookAt=function(t,e,i){void 0===i&&(i=!1);var n=StageUtils.ins().getWidth(),o=StageUtils.ins().getHeight(),s=-Math.min(Math.max(t-(n>>1),0),this.MAX_WIDTH-n),r=-Math.min(Math.max(e-50-(o>>1),0),this.MAX_HEIGHT-o);this.x=s,this.y=r,this.updateHDMap(this.x,this.y,i)},e.prototype.changeMap=function(t){void 0===t&&(t=""),t.length||(t=this.getFileName()),this.parserBytes(),e.DRAW_GRID?this.drawGrid():this._shapeContainer&&this._shapeContainer.parent&&this.removeChild(this._shapeContainer),e.DRAW_HANG?this.drawHangGrid():this._hangContainer&&this._hangContainer.parent&&this.removeChild(this._hangContainer),this.initBgMapImgs(this.MAX_WIDTH,this.MAX_HEIGHT,t),this._mapContainer.removeChildren(),this._mapContainer.addChild(this.thumbnail),this.lookAt(this.mapX,this.mapY,!0)},e.prototype.drawGrid=function(){this.clearDrawGrid(),this._shapeContainer=this._shapeContainer||new egret.DisplayObjectContainer,this._shapeContainer.cacheAsBitmap=!0,this._shapeContainer.touchEnabled=!1,this._shapeContainer.touchChildren=!1;for(var t=this.COL,i=this.ROW,n=0;t>n;n++)for(var o=0;i>o;o++){var s=n*i+o,r=this._shape[s];r||(r=this._shape[s]=new egret.Shape),this.checkAlpha(n,o)?r.graphics.beginFill(16776960,.3):this.checkWalkable(n,o)?r.graphics.beginFill(65280,.3):r.graphics.beginFill(16711680,.3),r.graphics.drawRect(2,2,e.CELL_SIZE-2,e.CELL_SIZE-2),r.graphics.endFill(),r.x=n*e.CELL_SIZE,r.y=o*e.CELL_SIZE;var a=new eui.Label;a.size=12,a.text=n+","+o,a.x=n*e.CELL_SIZE,a.y=o*e.CELL_SIZE,a.name="label"+n+","+o,this._shapeContainer.addChild(a),this._shapeContainer.addChild(r)}this.addChild(this._shapeContainer),this.setChildIndex(this._shapeContainer,1)},e.prototype.drawHangGrid=function(){if(this.clearHangGrid(),!(GameLogic.ins().getCurSceneData()&&GameLogic.ins().getCurSceneData().hang_id<=0)){var t=GlobalConfig.getHangPathById(GameLogic.ins().getCurSceneData().hang_id);this._hangContainer=this._hangContainer||new egret.DisplayObjectContainer,this._hangContainer.cacheAsBitmap=!0,this._hangContainer.touchEnabled=!1,this._hangContainer.touchChildren=!1;var e=0;for(var i in t){var n=t[i],o=this._shape[e];o||(o=this._hang[e]=new egret.Shape),o.graphics.beginFill(8388736,.3),o.graphics.drawRect(0,0,64,64),o.graphics.endFill(),o.x=64*n.target_pos_x/100,o.y=64*n.target_pos_y/100;var s=new eui.Label;s.size=16,s.textColor=16711680,s.text="挂机点"+(e+1),s.x=64*n.target_pos_x/100,s.y=64*n.target_pos_y/100,this._hangContainer.addChild(o),this._hangContainer.addChild(s),e+=1}this.addChild(this._hangContainer)}},e.prototype.clearDrawGrid=function(){if(this._shapeContainer&&this._shape){for(;this._shapeContainer.numChildren>0;)this._shapeContainer.removeChildAt(0);this._shape.length=0}},e.prototype.clearHangGrid=function(){if(this._hangContainer&&this._hang){for(;this._hangContainer.numChildren>0;)this._hangContainer.removeChildAt(0);this._hang.length=0}},e.prototype.clearAll=function(){this._bloodLayer.removeChildren(),this._effDownLayer.removeChildren(),this._effUpLayer.removeChildren(),this._entityLayer.removeChildren(),this._dropLayer.removeChildren()},e.prototype.addDropTo=function(t){this._dropLayer.addChild(t)},e.prototype.isShow=function(){return 1==this.visible&&null!=this.parent&&void 0!=this.parent},e.prototype.initBg=function(){this.thumbnail=new eui.Image,this._mapContainer.addChild(this.thumbnail),this.thumbnail.addEventListener(egret.Event.COMPLETE,this.onThumbnailComplete,this)},e.prototype.destructor=function(){this.thumbnail.removeEventListener(egret.Event.COMPLETE,this.onThumbnailComplete,this),this.removeChildren(),this.images={}},e.prototype.onThumbnailComplete=function(t){this.isThumbnailComplete=!0,this.updateHDMap(this.lastUpdateX,this.lastUpdateY,!0)},e.prototype.initBgMapImgs=function(t,e,i){this.isThumbnailComplete=!1,this.clearHDMap(),this.mapName=i,this.thumbnail.width=t,this.thumbnail.height=e;var n="resource/map/"+this.mapID+"/small.jpg";this.thumbnail.source=null,this.thumbnail.source=n,this.textrues[n]=1,this.maxImagX=Math.floor(t/this.imgSize),this.maxImagY=Math.floor(e/this.imgSize)},e.prototype.clearHDMap=function(){for(var t in this.images){var e=this.images[t];e&&(e.source=null)}for(var i in this.textrues)RES.destroyRes(i);this.textrues={};for(var t in this.images)delete this.images[t];this.images=[]},e.prototype.showImageNum=function(){CommonUtils.log("打印一下地图块数量:",this._mapContainer.$children.length)},e.prototype.updateHDMap=function(t,e,i){void 0===i&&(i=!1);var n=this.imgSize/4;if(!(!i&&Math.abs(this.lastUpdateX-t)<=n&&Math.abs(this.lastUpdateY-e)<=n)&&(this.lastUpdateX=t,this.lastUpdateY=e,this.isThumbnailComplete)){var o=StageUtils.ins().getWidth(),s=StageUtils.ins().getHeight(),r=Math.max(Math.floor(-t/this.imgSize),0),a=Math.max(Math.floor(-e/this.imgSize),0),h=r+Math.ceil(o/this.imgSize),l=a+Math.ceil(s/this.imgSize),p=new egret.Rectangle(-t,-e,o,s),c=[];for(var u in this.images){var d=this.images[u],g=d.getBounds();g.x=d.x,g.y=d.y,p.intersects(g)||(c.push(d),this._mapContainer.removeChild(this.images[u]),delete this.images[u])}for(var y=r;h>=y&&y<=this.maxImagX;y++)for(var f=a;l>=f&&f<=this.maxImagY;f++){var _=""+y+f,v="resource/map/"+this.mapID+"/"+f+"_"+y+".jpg";this.textrues[v]=1;var d=this.images[_];d&&d.source==v||(d=d||c.pop()||new eui.Image,d.source=null,d.source=v,d.x=y*this.imgSize,d.y=f*this.imgSize,this.images[_]=d,this._mapContainer.addChild(this.images[_]))}}},e.prototype.setExFindPath=function(t,e){this.extendGetPath=e,this.getPathObj=t},e.DRAW_GRID=!1,e.DRAW_HANG=!1,e}(BaseEuiView);__reflect(GameMap.prototype,"GameMap"),MessageCenter.compile(GameMap);var Mover=function(){function t(t){this._sx=0,this._sy=0,this._tx=0,this._ty=0,this._vx=0,this._vy=0,this._moveStartTick=0,this._moveEndTick=0,this._moveSubTick=200,this._moveSendTime=0,this.sendmove=!1,this.target=t}return t.prototype.dispose=function(){this.stopMove(),this.target=null,this.onComplete=null,this.completeObj=null},t.prototype.setCompleteFunc=function(t,e){this.onComplete=t,this.completeObj=e},t.prototype.moveTo=function(e,i,n,o){if(i>>0==this.target.x>>0&&n>>0==this.target.y>>0)return this.stopMove(),void(null!=this.onComplete&&this.onComplete.call(this.completeObj));if(this._tx=i,this._ty=n,this._sx=this.target.x,this._sy=this.target.y,this.autoRotation){var s=Math.atan2(n-this._sy,i-this._sx);s*=180/Math.PI,this.target.rotation=0>s?s+360:s}var r=1e3*t.calcMovingTime(o,this._sx,this._sy,i,n);this._vx=(i-this._sx)/r,this._vy=(n-this._sy)/r,this._moveStartTick=e,this._moveEndTick=this._moveStartTick+r},t.prototype.update=function(t){if(0!=this._moveStartTick){if(t>=this._moveEndTick)return this._moveStartTick=0,this.target.x=this._tx,this.target.y=this._ty,void(null!=this.onComplete&&null!=this.completeObj&&(this.onComplete.call(this.completeObj),HangManager.ins().moveEnd(this.completeObj),CopyHangManager.ins().moveEnd(this.completeObj)));var e=t-this._moveStartTick;if(this.target.x=MathUtils.toInteger(this._sx)+MathUtils.toInteger(e*this._vx),this.target.y=MathUtils.toInteger(this._sy)+MathUtils.toInteger(e*this._vy),this.completeObj&&2==GameLogic.ins().getSendMoveType()&&this.completeObj instanceof Entity){if(this.completeObj.handle!=GameMap.centerEntity.handle)return;t-this._moveSendTime>this._moveSubTick&&(this._moveSendTime=t,SceneControl.ins().sendMove(GameLogic.ins().getCurSceneId(),this.target.x,this.target.y,this.completeObj.dir))}}},t.prototype.stopMove=function(){this._moveStartTick=0},t.calcMovingTime=function(t,e,i,n,o){var s=n-e,r=o-i;return Math.sqrt(s*s+r*r)/t},Object.defineProperty(t.prototype,"moving",{get:function(){return this._moveStartTick>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tx",{get:function(){return this._tx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ty",{get:function(){return this._ty},enumerable:!0,configurable:!0}),t}();__reflect(Mover.prototype,"Mover");var MoveSystem=function(t){function e(){var e=t.call(this)||this;return e.sysId=PackageID.Move,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.sendMove=function(t,e,i){var n=this.getBytes(1);n.writeInt(t.x),n.writeInt(t.y),n.writeInt(e),n.writeInt(i),this.sendToServer(n)},e.prototype.sendSprint=function(t,e){var i=this.getBytes(6);i.writeUnsignedInt(t.x),i.writeUnsignedInt(t.y),i.writeNumber(e),this.sendToServer(i)},e.prototype.sendJump=function(t,e){var i=this.getBytes(10);i.writeInt(t),i.writeInt(e),this.sendToServer(i)},e.prototype.sendPetMove=function(t,e,i,n,o){var s=this.getBytes(4);s.writeDouble(t),s.writeInt(e),s.writeInt(i),s.writeInt(n),s.writeInt(o),this.sendToServer(s),CommonUtils.log("pet move >>>>>>>>>>>>>>>1843 >>>  "+n+":"+o)},e}(BaseSystem);__reflect(MoveSystem.prototype,"MoveSystem");var handler_bag=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.S2CRepKnapsackGetInfo=function(t){var e=net_protocol.S2CRepKnapsackGetInfo.decode(t.bytes);CommonUtils.log("()()()()()()()()()()()()---------------------------S2CRepKnapsackGetInfo-----------",e),BagProxy.ins().S2CRepKnapsackGetInfo(e)},e.prototype.S2CRepKnapsackUpdate=function(t){var e=net_protocol.S2CRepKnapsackUpdate.decode(t.bytes);BagProxy.ins().S2CRepKnapsackUpdate(e)},e.prototype.S2CRepKnapsackDelItem=function(t){var e=net_protocol.S2CRepKnapsackDelItem.decode(t.bytes);BagProxy.ins().S2CRepKnapsackDelItem(e)},e.prototype.S2CRepKnapsackOpenSlot=function(t){var e=net_protocol.S2CRepKnapsackOpenSlot.decode(t.bytes);BagProxy.ins().S2CRepKnapsackOpenSlot(e)},e.prototype.S2CRepKnapsackUse=function(t){var e=net_protocol.S2CRepKnapsackUse.decode(t.bytes);BagProxy.ins().S2CRepKnapsackUse(e)},e.prototype.S2CRepKnapsackArm=function(t){var e=net_protocol.S2CRepKnapsackArm.decode(t.bytes);BagProxy.ins().S2CRepKnapsackArm(e)},e.prototype.S2CRepKnapsackDisArm=function(t){var e=net_protocol.S2CRepKnapsackDisArm.decode(t.bytes);BagProxy.ins().S2CRepKnapsackDisArm(e)},e.prototype.S2CRepKnapsackOutput=function(t){var e=net_protocol.S2CRepKnapsackOutput.decode(t.bytes);CommonUtils.log("()()()()()()()()()()()()---------------------------S2CRepKnapsackOutput-----------",e);var i=e.from;if(23!=i&&167!=i){for(var n=[],o=0;o<e.items.length;++o){var s=new ItemExData;s.itemData=UtilProxy.GetItemCellData(e.items[o].item_id,e.items[o].item_num),n.push(s)}ViewManager.ins().open(TreasureView_reward,[!1,n])}},e.prototype.S2CRepKnapsackGetUseCount=function(t){var e=net_protocol.S2CRepKnapsackGetUseCount.decode(t.bytes);BagProxy.ins().S2CRepKnapsackGetUseCount(e)},e.prototype.S2CRepKnapsackPartnerMelt=function(t){var e=net_protocol.S2CRepKnapsackPartnerMelt.decode(t.bytes);BagProxy.ins().S2CRepKnapsackPartnerMelt(e)},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25050,this.S2CRepKnapsackGetInfo,this),MsgHandle.ins().regNetMsg(25051,this.S2CRepKnapsackUpdate,this),MsgHandle.ins().regNetMsg(25052,this.S2CRepKnapsackDelItem,this),MsgHandle.ins().regNetMsg(25053,this.S2CRepKnapsackUse,this),MsgHandle.ins().regNetMsg(25054,this.S2CRepKnapsackOpenSlot,this),MsgHandle.ins().regNetMsg(25055,this.S2CRepKnapsackArm,this),MsgHandle.ins().regNetMsg(25056,this.S2CRepKnapsackDisArm,this),MsgHandle.ins().regNetMsg(25061,this.S2CRepKnapsackOutput,this),MsgHandle.ins().regNetMsg(25058,this.S2CRepKnapsackGetUseCount,this),MsgHandle.ins().regNetMsg(25063,this.S2CRepKnapsackPartnerMelt,this)},e}(BaseClass);__reflect(handler_bag.prototype,"handler_bag");var handler_login=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kick_time=0,e.zip_index=0,e.zip_times=35,e.cfglist=[{key:"resource/cfg/config1_zz6.zip",val:"copy_data.json",ins:"CopyDataConfig",filekey:"config1_zz6_zip"},{key:"resource/cfg/config1_zz1.zip",val:"monster.json",ins:"MonstersConfig",filekey:"config1_zz1_zip"},{key:"resource/cfg/config1_zz2.zip",val:"skill.json",ins:"SkillsConfig",filekey:"config1_zz2_zip"},{key:"resource/cfg/config1_zz3.zip",val:"fuwen_base_data.json",ins:"fuwenBase",filekey:"config1_zz3_zip"},{key:"resource/cfg/config1_zz4.zip",val:"learn_skill.json",ins:"LearnSkill",filekey:"config1_zz4_zip"},{key:"resource/cfg/config1_zz5.zip",val:"tujian_data.json",ins:"Tujian_dataConfig",filekey:"config1_zz5_zip"},{key:"resource/cfg/config1_zz7.zip",val:"equipment.json",ins:"EquipmentConfig",filekey:"config1_zz7_zip"},{key:"resource/cfg/config1_zz11.zip",val:"scene_data.json",ins:"SceneConfig",filekey:"config1_zz11_zip"},{key:"resource/cfg/config1_zz9.zip",val:"activity_data.json",ins:"Activity_dataConfig",filekey:"config1_zz9_zip"},{key:"resource/cfg/config1_zz10.zip",val:"lyh_copy.json",ins:"LyhConfig",filekey:"config1_zz10_zip"},{key:"resource/cfg/config1_zz9.zip",val:"baowu_base_data.json",ins:"baowu_base_dataConfig",filekey:"config1_zz9_zip"},{key:"resource/cfg/config1_zz9.zip",val:"drop.json",ins:"DropConfig",filekey:"config1_zz9_zip"}],e.cfg_index=0,e}return __extends(e,t),e.prototype.on_handle_login=function(t){CommonUtils.log("收到登陆返回");var e=net_protocol.S2CRepLoginResult.decode(t.bytes);switch(e.reulst){case 0:LoginControl.ins().onLoginResult(e);break;case 1:TipsControl.ins().showTips("登陆失败");break;case 2:TipsControl.ins().showTips("该帐号已被封");break;case 3:TipsControl.ins().showTips("该设备已被封");break;case 4:TipsControl.ins().showTips("限制注册")}},e.prototype.on_handle_AuthenticationResult=function(t){var e=net_protocol.S2CAuthenticationResult.decode(t.bytes);LoginControl.ins().onAuthenticationResult(e)},e.prototype.on_handle_RoleList=function(t){CommonUtils.log("收到角色列表");var e=net_protocol.S2CRoleList.decode(t.bytes);if(LoginProxy.ins().setLocalStorage("user_name",GameSocket.ins()._user),LoginProxy.ins().setLocalStorage("last_server",String(LoginProxy.cur_server_data.server_id)),0==e.role_list.length)ViewManager.ins().open(CreateCharView),ViewManager.ins().close(StartGameView),this.initBeatPack();else{if(e.role_list[0].frobid_time>0)return void TipsControl.ins().showTips("账号封禁中");this.initBeatPack(),LoginProxy.ins().role_index=e.role_list[0].index,LoginProxy.ins().role_id=e.role_list[0].role_id,RoleProxy.ins().islogin?LoginControl.ins().sendEnterGame(e.role_list[0].index,e.role_list[0].role_id):this.startLoading()}},e.prototype.initBeatPack=function(){TimerManager.ins().removeAll(this),TimerManager.ins().doTimer(38e3,0,function(){LoginControl.ins().sendBeatPack()},this),LoginControl.ins().sendBeatPack()},e.prototype.on_handle_CreateRole=function(t){CommonUtils.log("收到创建角色");var e=net_protocol.S2CCreateRoleResult.decode(t.bytes);0==e.result?(Main._loadingUI.setVisible(!0),LoginProxy.ins().isCreateRole=!0,LoginProxy.ins().role_index=e.index,LoginProxy.ins().role_id=e.role_id,this.startLoading()):1==e.result?TipsControl.ins().showTips("验证失败"):2==e.result&&TipsControl.ins().showTips("玩家名字重复")},e.prototype.on_handle_KickRole=function(t){net_protocol.S2CKickRole.decode(t.bytes);TimerManager.ins().getCurrTime()-this.kick_time>299&&(this.kick_time=TimerManager.ins().getCurrTime(),TipsControl.ins().ShowTips1("该帐号已从其它客户端登陆",function(){parent.document.location.reload()},function(){parent.document.location.reload()}))},e.prototype.on_handle_RoleDataInfo=function(t){LocationProperty.consoleWrite("收到角色信息返回");var e=net_protocol.S2CRoleInitInfoData.decode(t.bytes);ViewManager.ins().close(StartGameView),RoleProxy.ins().initroledata(e),LocationProperty.consoleEgret("角色信息返回"),RoleProxy.ins().islogin=!0,0==RoleProxy.ins().has_get_info,this.onCheckGetInfo(),SdkManager.ins().SubmitRoleData(LoginProxy.ins().isCreateRole?2:1),SdkManager.isUseSdk&&LoginProxy.ins().isCreateRole&&platform.doPoint("create_role:"+RoleProxy.ins().getRoleName())},e.prototype.onCheckGetInfo=function(){if(RoleProxy.ins().islogin&&handler_scene.ins().is_enter_scene&&0==RoleProxy.ins().has_get_info){RoleProxy.ins().has_get_info=!0;for(var t=[BagProxy.ins().C2SReqKnapsackGetInfo(BagType.BODY_EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.BAG),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.MIJI_BAG),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.GEM_BAG),LimitActProxy.ins().C2SReqMiscGetSaveInfo(),TaskProxy.ins().GetTaskList(),TitleProxy.ins().C2SReqTitleGetInfo(),ActivityProxy.ins().C2SReqActivityInfos(),SkillProxy.ins().C2SReqSkillGetInfo(),LyhProxy.ins().C2SReqLyhGetInfo(),SystemOpenProxy.ins().C2SReqSystemopenGetInfo(),SmeltProxy.ins().C2SReqMeltGetInfo(),GuideProxy.ins().C2SReqGrowupGetGuideInfo(),UpgradeProxy.ins().C2SReqIntensifyGetInfo(),UpStarProxy.ins().C2SReqUpstarGetInfo(),SoulStoneProxy.ins().C2SReqSoulstoneGetInfo(),CopyProxy.ins().C2SReqCopyGetData(0),ChatProxy.ins().C2SReqGlobalchatGetInfo(),TitleProxy.ins().C2SReqTitleGetInfo(),GodEquipProxy.ins().C2SReqGodequipGetInfo(),HuobanProxy.ins().C2SReqBelleGetInfo(),PetProxy.ins().C2SReqPetGetInfo(),HorseProxy.ins().C2SReqHorseGetInfo(),ZhulingProxy.ins().C2SReqInjectsoulGetInfo(),BossProxy.ins().C2SReqBossData(),FacProxy.ins().C2SReqFactionGetInfo(),FabaoProxy.ins().C2SReqFabaoGetInfo(),GrowupProxy.ins().C2SReqGrowupInfo(),WeaponProxy.ins().C2SReqWeaponGetInfo(),LunjianProxy.ins().C2SReqFactionswordGetInfo(),StoreProxy.ins().C2SReqStoreGetInfo(0),MailProxy.ins().C2SReqMailGetMailListInfo(),SetProxy.ins().C2SReqMiscGetSetupInfo(),FacFightProxy.ins().C2SReqFactionGetLeaderBattleInfo(),FwProxy.ins().C2SReqFuwenGetInfo(),WelfareProxy.ins().C2SReqWelfareGetInfo(),RankProxy.ins().getAllRankInfo(),CopyTeamProxy.ins().C2SReqTeamcopyGetInfo(),XyProxy.ins().C2SReqXianyuanGetInfo(),XyProxy.ins().C2SReqXianyuanGetTasklist(1),XyProxy.ins().C2SReqXianyuanGetTasklist(2),TeamProxy.ins().C2SReqTeamGetInfo(),XiuXianProxy.ins().C2SReqAlivepointGetInfo(),XiuXianProxy.ins().C2SReqAchievementGetInfo(),XiuXianProxy.ins().C2SReqGrowupGetDujieInfo(),XiuXianProxy.ins().C2SReqTitleGetXianweiInfo(),YezhanProxy.ins().C2SReqYezhanGetInfo(),TreasureProxy.ins().C2SReqFindtreasureGetInfo(),PrivilegeProxy.ins().C2SReqActivitySpecialRightsData(),VIPProxy.ins().C2SReqVipGiftData(),StoreProxy.ins().C2SReqStoreGetBaokuInfo(),WelfareProxy.ins().C2SReqWelfareInvenstGetInfo(),VIPProxy.ins().C2SReqVipGetTimesList(),LimitActProxy.ins().C2SReqLimitActGetStateInfo(),LocationProperty.consoleWrite("请求游戏getInfo"),LimitActProxy.ins().C2SReqLimitActConsumeRank(1),LimitActProxy.ins().C2SReqLimitActConsumeRank(3),ZhenbaoProxy.ins().C2SReqFabaoGetTreasureInfo(),BossActProxy.ins().C2SReqLimitActTimeActGetInfo(),BaoWuProxy.ins().C2SReqFabaoGetBaowuInfo(),LimitActProxy.ins().C2SReqLimitActLotteryInfo(),RefineProxy.ins().C2SReqIntensifyGetRefineInfo(),TaoZhuangProxy.ins().C2SReqGrowupGetTaozhuangInfo(),ZbTaoZhuangProxy.ins().C2SReqGrowupEquipSuitGetInfo(),EquipSwallowProxy.ins().C2SReqGrowupEquipSwallowGetInfo(),LeitaiProxy.ins().C2SReqLeitaiGetInfo(),ZPZBProxy.ins().C2SReqFactionGetFactionattackInfo(),RelicProxy.ins().C2SReqShengwuGetInfo(),LimitActProxy.ins().C2SReqLimitActGetList(),LimitActProxy.ins().C2SReqLimitActGetInfo()],e=0;e<t.length;e++)t[e];for(var i=[BagProxy.ins().C2SReqKnapsackGetInfo(BagType.HORSE_BODY_EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.HORSE_EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.BELLE_BODY_EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.BELLE_EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.PET_BODY_EQUIP),BagProxy.ins().C2SReqKnapsackGetInfo(BagType.PET_EQUIP)],n=function(e){TimerManager.ins().doTimer(102*e,1,function(){t[e]},o)},o=this,e=0;e<i.length;e++)n(e)}},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(20001,this.on_handle_login,this),MsgHandle.ins().regNetMsg(20002,this.on_handle_AuthenticationResult,this),MsgHandle.ins().regNetMsg(20003,this.on_handle_RoleList,this),MsgHandle.ins().regNetMsg(20004,this.on_handle_CreateRole,this),MsgHandle.ins().regNetMsg(20006,this.on_handle_KickRole,this),MsgHandle.ins().regNetMsg(20020,this.on_handle_RoleDataInfo,this)},e.prototype.startLoading=function(){Main._loadingUI.setVisible(!0),this.zip_index=0,this.zip_times=35,ResourceUtils.ins().loadGroup("loading2",this.onZipCfgComplete,this.onZipCfgProcess,this)},e.prototype.showZipProcess=function(){if(this.zip_index+=1,this.zip_index<this.zip_times){var t=Math.floor(this.zip_index/this.zip_times*30);Main._loadingUI.onProgress(Math.floor(t),100,"正在加载配置...")}},e.prototype.onZipCfgComplete=function(){var t=this;Main._loadingUI.onProgress(20,100,"正在解压配置..."),GameApp.is_zipcfg_loaded=!0;for(var e=function(e){var n=i.cfglist[e];LocationProperty.consoleWrite("开始解压："+n.val);var o=RES.getRes(n.filekey);LocationProperty.consoleWrite("qq："+o),JSZip2.loadAsync(o).then(function(t){return LocationProperty.consoleWrite("开始解压 11111 zip："+t),t.file(n.val).async("text")}).then(function(e){LocationProperty.consoleWrite("开始解压 22222222"+n.val),TimerManager.ins().remove(t.showZipProcess,t);var i=JSON.parse(e);GlobalConfig.ins()[n.ins]=i,t.checkCfgUnzip(),LocationProperty.consoleWrite("解压完成："+n.val)})},i=this,n=0;n<this.cfglist.length;n++)e(n)},e.prototype.onZipCfgProcess=function(t,e,i){var n=Math.floor(t/e*30);Main._loadingUI.onProgress(Math.floor(n),100,"正在加载配置...")},e.prototype.checkCfgUnzip=function(){this.cfg_index+=1,LocationProperty.consoleWrite("checkCfgUnzip");var t=Math.floor(40/this.cfglist.length);Main._loadingUI.onProgress(20+this.cfg_index*t,100,"正在解压配置..."),this.cfg_index>=this.cfglist.length&&(GameApp.is_zipcfg_unzip=!0,LoginControl.ins().sendEnterGame(LoginProxy.ins().role_index,LoginProxy.ins().role_id),ResourceUtils.ins().loadGroup("loading3",this.onResComplete,this.onResProcess,this))},e.prototype.onResComplete=function(){for(var t=20,e=function(t){TimerManager.ins().doTimer(100*(t+1),1,function(){Main._loadingUI.onProgress(Math.floor(80+1*t),100,"正在进入游戏，请稍等...")},i)},i=this,n=0;t>n;n++)e(n);TimerManager.ins().doTimer(100*t,1,function(){GameApp.is_resource_loaded=!0,Main._loadingUI.setVisible(!1),SceneManager.ins().runScene(MainScene),GameApp.is_loading_finish=!0},this)},e.prototype.onResProcess=function(t,e,i){var n="正在加载必要图片..";Main._loadingUI.onProgress(Math.floor(60+t/e*20),100,n)},e}(BaseClass);__reflect(handler_login.prototype,"handler_login");var handle_role=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.on_RoleInfoUpdate=function(t){var e=net_protocol.S2CRoleInfoUpdate.decode(t.bytes);RoleProxy.ins().UpdataRoleAttr(e)},e.prototype.on_RoleFightingAttrUpdate=function(t){var e=net_protocol.S2CRoleFightingAttrUpdate.decode(t.bytes);RoleProxy.ins().UpdataRoleFightAttr(e)},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(20051,this.on_RoleInfoUpdate,this),MsgHandle.ins().regNetMsg(20052,this.on_RoleFightingAttrUpdate,this)},e}(BaseClass);__reflect(handle_role.prototype,"handle_role");var handler_scene=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.is_enter_scene=!1,e}return __extends(e,t),e.prototype.on_move=function(t){var e=net_protocol.S2CObjMove.decode(t.bytes);e.scene_id==GameLogic.ins().getCurSceneId()&&(e.pos_x=e.pos_x*GameMap.CELL_SIZE,e.pos_y=e.pos_y*GameMap.CELL_SIZE,SceneControl.ins().onMove(e))},e.prototype.on_remove_obj=function(t){var e=net_protocol.S2CVisibleObjLeave.decode(t.bytes);if(e.scene_id==GameLogic.ins().getCurSceneId()){var i=GameLogic.ins().getEntityByHandle(e.obj_id),n=!1;(Entity&&i instanceof EntityRole||i instanceof EntityPlayer)&&(n=!0),SceneControl.ins().onRemoveObj(e),ZPZBProxy.ins().IsZPZB(e.scene_id)&&EventProxy.Broast(EventType.UpdateZPZBSceneItem,[]),n&&EventProxy.Broast(EventType.S2CVisibleObjLeave,[])}},e.prototype.on_monster_enter=function(t){var e=net_protocol.S2CVisibleObjEnterMonster.decode(t.bytes);e.scene_id==GameLogic.ins().getCurSceneId()&&(SceneControl.ins().onMonsterEnter(e),BossProxy.ins().setBossObjId(e.monster_id,e.obj_id,e.name,e.drop_ower_obj_id,e.drop_ower_name,e.owner_id,e.free_time),ZPZBProxy.ins().IsBossId(e.monster_id)&&EventProxy.Broast(EventType.UpdateZPZBSceneItem,[]))},e.prototype.on_scene_enter=function(t){CommonUtils.log("收到切换场景");var e=net_protocol.S2CEnterScene.decode(t.bytes);this.enterScene(e)},e.prototype.enterScene=function(t){var e=GameLogic.ins().getCurSceneId(),i=GlobalConfig.getSceneConfigById(e);GameLogic.ins().setLastScene(e),BossProxy.ins().ClearBossData(),TeamProxy.ins().IsInTeam()&&TeamProxy.ins().C2SReqTeamLeave(),void 0!=i&&((9==i.speciallogic_type||18==i.speciallogic_type||41==i.speciallogic_type)&&ViewManager.ins().close(BossSceneView),19==i.speciallogic_type&&ViewManager.ins().close(BGIslandSceneView)),ViewManager.ins().isShow(ReviveView)&&ViewManager.ins().close(ReviveView),GameLogic.ins().onEnterScene(t),this.is_enter_scene=!0,handler_login.ins().onCheckGetInfo(),RoleProxy.ins().setSceneId(t.scene_id),i&&40==i.speciallogic_type&&!ViewManager.ins().isShow(LeitaiView)&&ViewManager.ins().open(LeitaiView);var n=GlobalConfig.getSceneConfigById(t.scene_id);if(void 0!=n){if(2!=n.scene_type&&3!=n.scene_type&&4!=n.scene_type&&SystemOpenProxy.ins().DoOpening(),18==n.speciallogic_type||41==n.speciallogic_type){var o=BossProxy.ins().getBossTypeById(t.scene_id);ViewManager.ins().open(BossSceneView,o)}else if(9==n.speciallogic_type){var s=BossProxy.ins().getBossTypeById(t.scene_id);5!=s&&6!=s&&11!=s&&GameLogic.ins().enterBossScene(t.scene_id),ViewManager.ins().open(BossSceneView,s)}1!=n.scene_type&&GuideProxy.ins().getGuideState()&&GuideProxy.ins().breakCurrentData(),1!=n.scene_type?ViewManager.ins().isShow(XianFuView)&&(UtilProxy.isCloseXianFuView=!0,ViewManager.ins().close(XianFuView)):UtilProxy.isCloseXianFuView&&(UtilProxy.isCloseXianFuView=!1,ViewManager.ins().isShow(XianFuView)||ViewManager.ins().open(XianFuView)),19==n.speciallogic_type&&(ViewManager.ins().open(BGIslandSceneView),ViewManager.ins().isShow(BeastGhostIslandView)&&ViewManager.ins().close(BeastGhostIslandView))}CopyProxy.ins().isZMZD(t.scene_id)?(ViewManager.ins().isShow(PipeiView)&&ViewManager.ins().close(PipeiView),ViewManager.ins().isShow(FacFightView)&&ViewManager.ins().close(FacFightView)):CopyProxy.ins().isZMZD(e)&&(ViewManager.ins().open(FacFightView),(5==FacFightProxy.ins().left_challenge_times||1==FacFightProxy.ins().left_challenge_times)&&EventProxy.Broast(EventType.FacFightPushTips,["还有剩余挑战次数，赶紧来抢夺宗主吧"])),CopyProxy.ins().isTopFight(t.scene_id)?(ViewManager.ins().isShow(TopFightView)&&ViewManager.ins().close(TopFightView),ViewManager.ins().isShow(PipeiView)&&ViewManager.ins().close(PipeiView)):CopyProxy.ins().isTopFight(e)&&PvpProxy.ins().IsInTopfightTime()&&ViewManager.ins().open(TopFightView),CopyProxy.ins().isLunjian(e)&&ViewManager.ins().open(LunjianView),CopyProxy.ins().isShenxian(e)&&ViewManager.ins().open(ShenxianView),CopyProxy.ins().isDujieCopy(e)&&ViewManager.ins().open(XiuXianView,0),ZPZBProxy.ins().IsZPZB(t.scene_id)?(ZPZBProxy.ins().C2SReqFactionGetFactionAttackBattleInfo(),ViewManager.ins().open(ZPZBSceneView),ViewManager.ins().isShow(ZPZBMainView)&&ViewManager.ins().close(ZPZBMainView)):ZPZBProxy.ins().IsZPZB(e)&&(ViewManager.ins().isShow(ZPZBSceneView)&&ViewManager.ins().close(ZPZBSceneView),TitleProxy.ins().ResetTitle()),CopyProxy.ins().DoFubenFailBtn(),EventProxy.Broast(EventType.S2CEnterScene,[t.scene_id])},e.prototype.on_blood=function(t){var e=net_protocol.S2CObjChangeBloods.decode(t.bytes),i=GameLogic.ins().getEntityByHandle(e.target_obj_id);i&&i instanceof EntityMonster&&BossProxy.ins().isBossId(i.getConfig().id)&&BossProxy.ins().setMyHurt(e.target_obj_id,e.perform_obj_id,-e.real_blood),BossProxy.ins().setAtkData(e.target_obj_id,e.perform_obj_id),SceneControl.ins().onBlood(e),ZPZBProxy.ins().IsZPZB(GameLogic.ins().getCurSceneId())&&EventProxy.Broast(EventType.UpdateZPZBSceneItem,[])},e.prototype.on_bloods=function(t){for(var e=net_protocol.S2CObjChangeBloodsList.decode(t.bytes),i=0;i<e.list.length;i++){BossProxy.ins().setAtkData(e.list[i].target_obj_id,e.list[i].perform_obj_id);var n=GameLogic.ins().getEntityByHandle(e.list[i].target_obj_id);n&&n instanceof EntityMonster&&BossProxy.ins().isBossId(n.getConfig().id)&&BossProxy.ins().setMyHurt(e.list[i].target_obj_id,e.list[i].perform_obj_id,-e.list[i].real_blood)}SceneControl.ins().onBloods(e),ZPZBProxy.ins().IsZPZB(GameLogic.ins().getCurSceneId())&&EventProxy.Broast(EventType.UpdateZPZBSceneItem,[])},e.prototype.S2CPerformSkill=function(t){var e=net_protocol.S2CPerformSkill.decode(t.bytes);GameLogic.ins().onPerformSkill(e)},e.prototype.S2CCharacterDead=function(t){var e=net_protocol.S2CCharacterDead.decode(t.bytes),i=GameLogic.ins().getEntityByHandle(e.dead_obj_id);if(i&&(i.stopMove(),i.stopAI()),SceneControl.ins().onEntityDie(e),void 0!=GameMap.centerEntity){if(GameMap.centerEntity.handle==e.dead_obj_id){GameMap.centerEntity.AI.setAIState(AI_State.Stand);var n="",o=GameLogic.ins().getEntityByHandle(e.kill_obj_id);if(void 0!=o&&(n=o.name),ZPZBProxy.ins().IsZPZB(GameLogic.ins().getCurSceneId())){var s=GlobalConfig.getFaction_attack_base_dataConfig(1);
FacProxy.ins().getFacId()==ZPZBProxy.ins().defend_faction_id?(GameMap.centerEntity.x=64*Math.floor(s.scene_x/100),GameMap.centerEntity.y=64*Math.floor(s.scene_y/100)):(GameMap.centerEntity.x=64*Math.floor(s.scene_xx/100),GameMap.centerEntity.y=64*Math.floor(s.scene_yy/100)),GameMap.centerEntity.AI.SetCharacterDead(),EventProxy.Broast(EventType.UpdateZPZBSceneItem,[])}GameLogic.ins().isRevive()&&ViewManager.ins().open(ReviveView,[n])}if(BossProxy.ins().isBossDead(e.dead_obj_id)&&(TipsControl.ins().showTips("BOSS已被击杀！"),EventProxy.Broast(EventType.BossDead,[GameMap.centerEntity.handle==e.kill_obj_id])),GameMap.centerEntity.handle==e.kill_obj_id){var o=GameLogic.ins().getEntityByHandle(e.dead_obj_id);if(o instanceof EntityMonster){CopyTeamProxy.ins().addKillNum();var r=o.getConfig();if(void 0!=r)for(var a=r.currencys,h=a.split(";"),l=0;l<h.length;++l){var p=h[l],c=p.split("#");8==Number(c[0])&&CopyTeamProxy.ins().AddExp(Number(c[1]))}}}}},e.prototype.S2CVisibleObjEnterArenaPlayer=function(t){var e=net_protocol.S2CVisibleObjEnterArenaPlayer.decode(t.bytes);e.scene_id==GameLogic.ins().getCurSceneId()&&GameLogic.ins().createArenaRole(e)},e.prototype.S2CCharacterAvatar=function(t){var e=net_protocol.S2CCharacterAvatar.decode(t.bytes);GameLogic.ins().onChangeAvatar(e)},e.prototype.S2CHeartBeat=function(t){var e=net_protocol.S2CHeartBeat.decode(t.bytes);GameLogic.ins().setServerTime(e.time)},e.prototype.S2CVisibleObjEnterRole=function(t){if(!GameLogic.ins().getCurSceneData()||1!=GameLogic.ins().getCurSceneData().client_create_monster){var e=net_protocol.S2CVisibleObjEnterRole.decode(t.bytes);e.scene_id==GameLogic.ins().getCurSceneId()&&(GameLogic.ins().createRole(e),EventProxy.Broast(EventType.S2CVisibleObjEnterRole,[]))}},e.prototype.S2CVisibleObjEnterRobot=function(t){var e=net_protocol.S2CVisibleObjEnterRobot.decode(t.bytes);e.scene_id==GameLogic.ins().getCurSceneId()&&(GameLogic.ins().createRole(e),SkillCC.ins().isRecordDamage&&void 0!=SceneControl.ins().hurtList[e.obj_id]&&(SceneControl.ins().hurtList[e.obj_id].name=e.role_name))},e.prototype.S2CCharacterRevive=function(t){var e=net_protocol.S2CCharacterRevive.decode(t.bytes),i=GameLogic.ins().getEntityByHandle(e.obj_id);void 0!=i&&(i.x=64*e.pos_x,i.y=64*e.pos_y,i.setProp(FightAttr.HP_MAX,e.hp),i.setProp(FightAttr.HP,e.hp),e.obj_id==GameMap.centerEntity.handle&&(i.AI.setAIState(AI_State.Atk),i.AI.start(),ViewManager.ins().close(ReviveView)))},e.prototype.S2CAttrChange=function(t){var e=net_protocol.S2CAttrChange.decode(t.bytes),i=GameLogic.ins().getEntityByHandle(e.obj_id);if(i)switch(e.type){case 0:var n=i.getHP();if(e.value>n){var o=egret.getQualifiedClassName(SkillDamageData),s=ObjectPool.pop(o);s.parseSuch(e.value-n,e.obj_id),SkillCC.ins().doSkillResultByData(s)}i.setProp(e.type,e.value)}},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(20007,this.S2CHeartBeat,this),MsgHandle.ins().regNetMsg(20021,this.on_scene_enter,this),MsgHandle.ins().regNetMsg(20023,this.on_move,this),MsgHandle.ins().regNetMsg(20024,this.on_remove_obj,this),MsgHandle.ins().regNetMsg(20026,this.on_monster_enter,this),MsgHandle.ins().regNetMsg(20061,this.on_blood,this),MsgHandle.ins().regNetMsg(20072,this.on_bloods,this),MsgHandle.ins().regNetMsg(20060,this.S2CPerformSkill,this),MsgHandle.ins().regNetMsg(20062,this.S2CCharacterDead,this),MsgHandle.ins().regNetMsg(20031,this.S2CVisibleObjEnterArenaPlayer,this),MsgHandle.ins().regNetMsg(20063,this.S2CCharacterAvatar,this),MsgHandle.ins().regNetMsg(20065,this.S2CAttrChange,this),MsgHandle.ins().regNetMsg(20025,this.S2CVisibleObjEnterRole,this),MsgHandle.ins().regNetMsg(20064,this.S2CCharacterRevive,this),MsgHandle.ins().regNetMsg(20030,this.S2CVisibleObjEnterRobot,this)},e}(BaseClass);__reflect(handler_scene.prototype,"handler_scene");var handler_task=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.S2CRepTaskListInfo=function(t){var e=net_protocol.S2CRepTaskListInfo.decode(t.bytes);TaskProxy.ins().S2CRepTaskListInfo(e)},e.prototype.S2CRepTaskInfo=function(t){var e=net_protocol.S2CRepTaskInfo.decode(t.bytes);TaskProxy.ins().S2CRepTaskInfo(e)},e.prototype.S2CRepTaskRecorderListInfo=function(t){var e=net_protocol.S2CRepTaskRecorderListInfo.decode(t.bytes);TaskProxy.ins().S2CRepTaskRecorderListInfo(e)},e.prototype.S2CRepTaskRecorderInfo=function(t){var e=net_protocol.S2CRepTaskRecorderInfo.decode(t.bytes);TaskProxy.ins().S2CRepTaskRecorderInfo(e)},e.prototype.S2CRepTaskStartKillMonster=function(t){var e=net_protocol.S2CRepTaskStartKillMonster.decode(t.bytes);TaskProxy.ins().S2CRepTaskStartKillMonster(e)},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25200,this.S2CRepTaskListInfo,this),MsgHandle.ins().regNetMsg(25201,this.S2CRepTaskInfo,this),MsgHandle.ins().regNetMsg(25202,this.S2CRepTaskRecorderListInfo,this),MsgHandle.ins().regNetMsg(25203,this.S2CRepTaskRecorderInfo,this),MsgHandle.ins().regNetMsg(25204,this.S2CRepTaskStartKillMonster,this)},e}(BaseClass);__reflect(handler_task.prototype,"handler_task");var Msg=function(){function t(){}return t.C2S_LOGIN=2001,t.C2S_AUTHENTICATION=1003,t.C2S_CREATE_ROLE=10002,t.C2S_DESTORY_ROLE=10003,t.C2S_ENTER_GAME=1020,t.C2S_HEART_BEAT=10005,t.C2STransferScene=14e3,t.C2S_MOVE=14001,t.C2SPerformSkill=14002,t.C2SSkillAttack=14003,t.C2SReqMiscResurgence=15150,t.C2S_REQTASKLIST=15200,t.C2S_ACCEPTTASK=15201,t.C2S_COMMITTASK=15202,t.C2S_KILLMONSTER=15203,t.C2SReqTaskStartKillMonster=15203,t.C2SReqTaskEndKillMonster=15204,t.C2SReqCopyGetData=15400,t.C2SReqCopyEnterCopy=15401,t.C2SReqCopyLeave=15402,t.C2SReqCopySweep=15404,t.C2SReqCopyGetClimbReward=15409,t.C2SReqCopyBuyTimes=15414,t.C2SReqCopyOnekeySweep=15415,t.C2SReqKnapsackGetInfo=15050,t.C2SReqKnapsackUse=15054,t.C2SReqKnapsackOpenSlot=15055,t.C2SReqKnapsackArm=15056,t.C2SReqKnapsackDisArm=15057,t.C2SReqKnapsackArmList=15061,t.C2SReqKnapsackGetUseCount=15059,t.C2SReqKnapsackPartnerArmList=15062,t.C2SReqKnapsackPartnerMelt=15063,t.C2SReqSkillGetInfo=15250,t.C2SReqSkillUpgrade=15251,t.C2SReqSkillUse=15252,t.C2SReqSkillUpgradeRune=15253,t.C2SReqMeltGetInfo=15450,t.C2SReqMeltMelt=15451,t.C2SReqGmCmd=15010,t.C2SReqIntensifyGetInfo=15900,t.C2SReqIntensifyUpgrade=15901,t.C2SReqIntensifySuit=15902,t.C2SReqLyhGetInfo=17450,t.C2SReqLyhGetReward=17451,t.C2SReqLyhSweep=17452,t.C2SReqLyhGetLayerAward=17453,t.C2SReqUpstarGetInfo=17800,t.C2SReqUpstarUpgrade=17801,t.C2SReqUpstarUpgradeMaster=17802,t.C2SChannelChat=11001,t.C2SSingleChat=11002,t.C2SChatGetVoice=11003,t.C2SReqGlobalchatGetInfo=15950,t.C2SReqGlobalchatSetBlacklist=15951,t.C2SReqGlobalchatCancelBlacklist=15952,t.C2SReqGlobalchatCross=15953,t.C2SReqSoulstoneGetInfo=17700,t.C2SReqSoulstoneOnekeyInlay=17701,t.C2SReqSoulstoneUnInlay=17702,t.C2SReqSoulstoneCompose=17703,t.C2SReqSoulstoneUpgradeMaster=17704,t.C2SReqSoulstoneInlay=17705,t.C2SReqTitleGetInfo=15750,t.C2SReqTitleActive=15751,t.C2SReqTitleUpgrade=15752,t.C2SReqTitleUse=15753,t.C2SReqTitleUpgradeReputation=15754,t.C2SReqGodequipGetInfo=17850,t.C2SReqGodequipMake=17851,t.C2SReqGodequipSuit=17852,t.C2SReqGodequipForge=17853,t.C2SReqGodequipForgeSuit=17854,t.C2SReqGodequipSoulUpLevel=17855,t.C2SReqInjectsoulGetInfo=17900,t.C2SReqInjectsoulAction=17901,t.C2SReqInjectsoulSwallow=17902,t.C2SReqInjectsoulSoulforgeAction=17903,t.C2SReqInjectsoulSoulforgeSwallow=17904,t.C2SReqBelleGetInfo=16950,t.C2SReqBelleOnekeyUpgrade=16951,t.C2SReqBelleActiveHuaxing=16952,t.C2SReqBelleShenLian=16953,t.C2SReqBelleSkillUpgrade=16954,t.C2SReqBelleChangeShow=16955,t.C2SReqBelleSkinExtendUpgrade=16956,t.C2SReqPetGetInfo=17950,t.C2SReqPetOnekeyUpgrade=17951,t.C2SReqPetActiveHuaxing=17952,t.C2SReqPetShenLian=17953,t.C2SReqPetSkillUpgrade=17954,t.C2SReqPetChangeShow=17955,t.C2SReqPetSkinExtendUpgrade=17956,t.C2SReqArenaGetInfo=17150,t.C2SReqArenaChallenge=17151,t.C2SReqArenaRefreshOpp=17152,t.C2SReqArenaSweep=17153,t.C2SReqArenaBuyChallengeNum=17154,t.C2SReqArenaGetRankAward=17155,t.C2SReqArenaGetRankList=17156,t.C2SReqArenaLoadingFinish=17157,t.C2SReqArenaGetFirstRankAward=17158,t.C2SReqHorseGetInfo=15650,t.C2SReqHorseOnekeyUpgrade=15651,t.C2SReqHorseActiveHuaxing=15652,t.C2SReqHorseShenLian=15653,t.C2SReqHorseSkillUpgrade=15654,t.C2SReqHorseChangeShow=15655,t.C2SReqHorseRide=15656,t.C2SReqHorseSkinExtendUpgrade=15657,t.C2SReqMiscZhuanUpLevel=15156,t.C2SReqAlivepointGet=16353,t.C2SReqAlivepointGetInfo=16350,t.C2SReqAlivepointGetReward=16352,t.C2SReqAchievementGetInfo=16800,t.C2SReqAchievementGet=16801,t.C2SReqAchievementUpgrade=16802,t.C2SReqAlivepointXianfuUpLevel=16354,t.C2SReqAlivepointXianfuFindBack=16355,t.C2SReqBossData=16150,t.C2SReqBossGetRoleNum=16153,t.C2SReqBossKillRecord=16155,t.C2SReqBossDropRecords=16156,t.C2SReqBossSyData=16157,t.C2SReqBossTqData=16158,t.C2SReqBossOwnerLoot=14028,t.C2SReqBossHurtAward=16159,t.C2SReqBossBuyChallengeNum=16160,t.C2SSetAttackTarget=14006,t.C2SReqBossYlsdRandom=16161,t.C2SReqBossBuyTimes=16162,t.C2SReqBossGetBoxAward=16163,t.C2SReqBossShenwenBuyChallengeNum=16164,t.C2SReqFactionGetInfo=15600,t.C2SReqFactionJoin=15601,t.C2SReqFactionContribute=15602,t.C2SReqFactionGetMemberList=15603,t.C2SReqGrowupInfo=17600,t.C2SReqGrowupVenationUpgrade=17601,t.C2SReqGrowupFashionUpgrade=17602,t.C2SReqGrowupFashionSwallow=17603,t.C2SReqGrowupFashionWear=17604,t.C2SReqFabaoGetInfo=15800,t.C2SReqFabaoUpgrade=15801,t.C2SReqFabaoFabaoSuitUpgrade=15815,t.C2SReqGrowupFuyinUpgrade=17605,t.C2SReqGrowupFuyinSuitUpgrade=17631,t.C2SReqWeaponGetInfo=18050,t.C2SReqWeaponSingleUpgrade=18051,t.C2SReqWeaponBookUpgrade=18052,t.C2SReqWeaponSwallow=18053,t.C2SReqWeaponChangeHuaxing=18054,t.C2SReqWeaponSingleUpgradeExtend=18055,t.C2SReqFactionswordGetInfo=18100,t.C2SReqFactionswordRefreshOpp=18101,t.C2SReqFactionswordChallenge=18102,t.C2SReqFactionswordSweep=18103,t.C2SReqFactionswordBuyChallenge=18104,t.C2SReqFactionswordGetRankList=18105,t.C2SReqFactionswordGetScoreAward=18106,t.C2SReqFactionswordLoadingFinish=18107,t.C2SReqStoreGetInfo=15500,t.C2SReqStoreRefresh=15501,t.C2SReqStoreBuy=15502,t.C2SReqStoreBuyRecord=15503,t.C2SReqMiscAutoBuyItem=15154,t.C2SReqStoreGetBaokuInfo=15504,t.C2SReqStoreBaokuExchange=15505,t.C2SReqMailGetMailListInfo=15300,t.C2SReqMailSendMail=15301,t.C2SReqMailReadMailInfo=15302,t.C2SReqMailRetrieveAttachment=15303,t.C2SReqMailDeleteMail=15304,t.C2SReqFactionGetLeaderBattleInfo=15604,t.C2SReqFactionGetBattleRanklist=15605,t.C2SReqFactionSetAutoMatch=15606,t.C2SReqFactionBattleChallenge=15607,t.C2SReqFactionMoBai=15608,t.C2SReqFactionGiveBattleAward=15609,t.C2SReqFactionSetZhenChuan=15610,t.C2SReqFactionBuyChallenge=15611,t.C2SReqMiscRename=15151,t.C2SReqMiscGetSetupInfo=15164,t.C2SReqMiscActiveHead=15165,t.C2SReqMiscActiveHeadFrame=15166,t.C2SReqMiscSetHead=15167,t.C2SReqMiscActiveChatFrame=15168,t.C2SReqMiscSetChatFrame=15169,t.C2SReqFuwenGetInfo=18e3,t.C2SReqFuwenInlayFuwen=18001,t.C2SReqFuwenUpgradeFuwen=18002,t.C2SReqFuwenResolveFuwen=18003,t.C2SReqFuwenHoleStrengthen=18004,t.C2SReqFuwenCompose=18005,t.C2SReqWelfareGetInfo=16550,t.C2SReqWelfareGetLoginAward=16551,t.C2SReqWelfareSignin=16552,t.C2SReqWelfareSigninRedeem=16553,t.C2SReqWelfareGetOnlineAward=16554,t.C2SReqWelfareGetWeekCardAward=16555,t.C2SReqWelfareCdkeyGiftBag=16556,t.C2SReqWelfareGetSystemAward=16557,t.C2SReqWelfareGetMillionAward=16558,t.C2SReqWelfareGetSevenDayAward=16559,t.C2SReqWelfareFreegiftBuy=16563,t.C2SReqWelfareFreegiftGetAward=16564,t.C2SReqWelfareInvenstGetInfo=16560,t.C2SReqWelfareInvenstBuy=16561,t.C2SReqWelfareInvenstGetAward=16562,t.C2SReqWelfareLoginOnlineAward=16565,t.C2SReqWelfareTopShareAward=16566,t.C2SReqMiscOtherInfo=15152,t.C2SReqRankGetRanksRole=16303,t.C2SReqTeamcopyGetInfo=16200,t.C2SReqTeamcopyStartMatching=16201,t.C2SReqTeamcopyCancelMatching=16202,t.C2SReqTeamcopyBuyChallengeCount=16203,t.C2SReqTeamcopyGuwu=16204,t.C2SReqGrowupTujianUpgrade=17606,t.C2SReqGrowupTujianSuitActivate=17620,t.C2SReqMiscMake=15159,t.C2SReqMiscItemSplit=15170,t.C2SReqXianyuanGetInfo=18150,t.C2SReqXianyuanGetPostlist=18151,t.C2SReqXianyuanPostXiangqin=18152,t.C2SReqXianyuanPostZhaoqin=18153,t.C2SReqXianyuanReqMarry=18154,t.C2SReqXianyuanJoinBattleMarry=18155,t.C2SReqXianyuanReplyMarry=18156,t.C2SReqXianyuanUpgradeFlower=18157,t.C2SReqXianyuanGetXianyuanAward=18158,t.C2SReqXianyuanUpgradeRing=18159,t.C2SReqXianyuanUpgradeSkill=18160,t.C2SReqXianyuanGetRanklist=18161,t.C2SReqXianyuanGetTasklist=18162,t.C2SReqXianyuanGetTaskAward=18163,t.C2SReqXianyuanEnterXianyuanCopy=18164,t.C2SReqXianyuanDivorce=18165,t.C2SReqXianyuanChooseBattle=18166,t.C2SReqXianyuanBuyCopyTimes=18167,t.C2SReqXianyuanXunyouEnd=18168,t.C2SReqMiscGetSaveInfo=15153,t.C2SReqLimitActGetInfo=17250,t.C2SReqLimitActGetReward=17251,t.C2SReqLimitActGetList=17252,t.C2SReqLimitActGetGiftPack=17253,t.C2SReqLimitActGetTimes=17255,t.C2SReqLimitActRechargeRecord=17257,t.C2SReqLimitActGetRankData=17258,t.C2SReqLimitActBuySmGift=17259,t.C2SReqLimitActItemExchange=17261,t.C2SReqLimitActGetExchangeData=17265,t.C2SReqLimitActExchangeItem=17266,t.C2SReqLimitActBuyGift=17268,t.C2SReqLimitActConsumeRank=17269,t.C2SReqLimitActLotteryInfo=17270,t.C2SReqLimitActLotteryTake=17271,t.C2SReqLimitActLotteryOpenBox=17272,t.C2SReqLimitActGetStateInfo=17273,t.C2SReqLimitActGetVipAward=17274,t.C2SReqLimitActGetJackpot=17277,t.C2SReqTeamGetInfo=15350,t.C2SReqTeamCreate=15351,t.C2SReqTeamGetFriend=15353,t.C2SReqTeamLeave=15354,t.C2SReqTeamPromote=15355,t.C2SReqTeamRemove=15356,t.C2SReqTeamInvite=15357,t.C2SReqTeamApply=15358,t.C2SReqTeamReplyInvite=15359,t.C2SReqTeamReplyApply=15360,t.C2SReqTeamAutoAccept=15365,t.C2SReqTeamGetSceneTeam=15367,t.C2SReqActivityInfos=16450,t.C2SReqSystemopenGetInfo=15550,t.C2SReqSystemopenOpen=15551,t.C2SReqPvpGetInfo=16050,t.C2SReqPvpStartMatching=16051,t.C2SReqPvpCancelMatching=16052,t.C2SReqPvpGetDailyAward=16053,t.C2SReqPvpBuyTimes=16054,t.C2SReqPvpGetRankList=16055,t.C2SReqPvpGetReport=16056,t.C2SReqPvpGuessVote=16057,t.C2SReqPvpGetGuessInfo=16058,t.C2SReqPvpGetSelfTopReport=16059,t.C2SReqYezhanGetInfo=16250,t.C2SReqYezhanBuyTimes=16251,t.C2SReqYezhanRefreshOpp=16252,t.C2SReqYezhanGuwu=16253,t.C2SReqYezhanChallenge=16254,t.C2SReqYezhanChallengeResult=16255,t.C2SReqFindtreasureGetInfo=15850,t.C2SReqFindtreasureFind=15851,t.C2SReqFindtreasureExchange=15852,t.C2SReqFindtreasureGetExpItem=15853,t.C2SReqFindtreasurePickOutItem=15854,t.C2SReqActivitySpecialRightsData=16451,t.C2SReqActivitySpecialReward=16452,t.C2SReqActivityGetExtraAward=16455,t.C2SReqActivityGetBigAward=16456,t.C2SReqActivityGetExpBead=16457,t.C2SReqVipGiftData=16001,t.C2SReqVipGetFreeGift=16003,t.C2SReqVipGetTimesList=16e3,t.C2SReqVipGetOnlineAward=16006,t.C2SReqVipGetDiscountGift=16004,t.C2SReqMiscNewhandUpdate=15162,t.C2SReqGrowupGetGuideInfo=17607,t.C2SReqGrowupUpdateGuide=17608,t.C2SReqVipGetChargeParam=16007,t.C2SReqFabaoGetTreasureInfo=15802,t.C2SReqFabaoActiveTreasure=15803,t.C2SReqFabaoGetTreasureAward=15804,t.C2SReqLimitActTimeActGetInfo=17275,t.C2SReqLimitActTimeActGetAward=17276,t.C2SReqFabaoGetBaowuInfo=15805,t.C2SReqFabaoBaowuUpgrade=15806,t.C2SReqFabaoBaowuSwallow=15807,t.C2SReqIntensifyGetRefineInfo=15903,t.C2SReqIntensifyUpgradeRefine=15904,t.C2SReqIntensifySuitRefine=15905,t.C2SReqGrowupGetDujieInfo=17616,t.C2SReqGrowupGetDujieTaskAward=17617,t.C2SReqGrowupChallengeDujieCopy=17618,t.C2SReqGrowupDujieUpgrade=17619,t.C2SReqGrowupGetTaozhuangInfo=17610,t.C2SReqGrowupActiveTaozhuang=17611,t.S2CRepGrowupGetTaozhuangInfo=27609,t.S2CRepGrowupUpdateTaozhuang=27610,t.C2SReqGrowupEquipSuitGetInfo=17626,t.C2SReqGrowupEquipSuitLightUp=17627,t.C2SReqGrowupEquipSuitGetAward=17628,t.C2SReqGrowupEquipSwallowGetInfo=17629,t.C2SReqGrowupEquipSwallowOper=17630,t.C2SReqLeitaiGetInfo=18200,t.C2SReqLeitaiGetRankList=18201,t.C2SReqLeitaiBuyTimes=18204,t.C2SReqLeitaiMobai=18206,t.C2SReqLeitaiStartChallenge=18203,t.C2SReqLeitaiGetDailyAward=18205,t.C2SReqShengwuUnlock=18251,t.C2SReqShengwuGetInfo=18250,t.C2SReqShengwuCombine=18252,t.C2SReqShengwuGetSoulTask=18253,t.C2SReqShengwuActiveSoul=18254,t.C2SReqShengwuUpgradeSoul=18255,t.C2SReqShengwuActiveSkill=18256,t.C2SReqFactionGetFactionattackInfo=15620,t.C2SReqFactionGetAttackJoinAward=15621,t.C2SReqFactionEnterFactionAttack=15622,t.C2SReqFactionGetFactionAttackBattleInfo=15623,t.C2SReqTaskGetDailyTaskInfo=15205,t.C2SReqTaskDailyTaskOper=15206,t.C2SReqTitleGetXianweiInfo=15755,t.C2SReqTitleUpgradeXianwei=15756,t}();__reflect(Msg.prototype,"Msg");var MsgHandle=function(){function t(){this.MSG_HANDLER=[]}return t.ins=function(){return t._ins||(t._ins=new t),t._ins},t.prototype.regNetMsg=function(t,e,i){return this.MSG_HANDLER[t]?void console.error("重复注册协议接口"+t):void(this.MSG_HANDLER[t]=[e,i])},t.prototype.handleMsg=function(t,e){if(this.MSG_HANDLER[t]){var i=this.MSG_HANDLER[t];i[0].call(i[1],e)}},t.prototype.regModuleHandler=function(){handler_login.ins().regLoginHandler(),handler_scene.ins().regLoginHandler(),handler_task.ins().regLoginHandler(),handle_role.ins().regLoginHandler(),CopyProxy.ins().regLoginHandler(),handler_bag.ins().regLoginHandler(),SkillProxy.ins().regLoginHandler(),SmeltProxy.ins().regLoginHandler(),UpgradeProxy.ins().regLoginHandler(),LyhProxy.ins().regLoginHandler(),UpStarProxy.ins().regLoginHandler(),ChatProxy.ins().regLoginHandler(),SoulStoneProxy.ins().regLoginHandler(),TitleProxy.ins().regLoginHandler(),GodEquipProxy.ins().regLoginHandler(),HuobanProxy.ins().regLoginHandler(),PetProxy.ins().regLoginHandler(),HorseProxy.ins().regLoginHandler(),ZhulingProxy.ins().regLoginHandler(),ZhuhunProxy.ins().regLoginHandler(),ShenXianProxy.ins().regLoginHandler(),XiuXianProxy.ins().regLoginHandler(),BossProxy.ins().regLoginHandler(),FacProxy.ins().regLoginHandler(),GrowupProxy.ins().regLoginHandler(),FabaoProxy.ins().regLoginHandler(),WeaponProxy.ins().regLoginHandler(),LunjianProxy.ins().regLoginHandler(),StoreProxy.ins().regHandler(),MailProxy.ins().regHandler(),FacFightProxy.ins().regHandler(),SetProxy.ins().regHandler(),FwProxy.ins().regLoginHandler(),WelfareProxy.ins().regHandler(),RankProxy.ins().regHandler(),XyProxy.ins().regLoginHandler(),CopyTeamProxy.ins().regHandler(),MakeProxy.ins().regHandler(),TeamProxy.ins().regHandler(),ActivityProxy.ins().regHandler(),NoticeProxy.ins().regHandler(),SystemOpenProxy.ins().regHandler(),PvpProxy.ins().regHandler(),YezhanProxy.ins().regLoginHandler(),TreasureProxy.ins().regHandler(),LimitActProxy.ins().regHandler(),PrivilegeProxy.ins().regHandler(),VIPProxy.ins().regHandler(),GuideProxy.ins().regHandler(),ZhenbaoProxy.ins().regHandler(),BossActProxy.ins().regHandler(),BaoWuProxy.ins().regHandler(),RefineProxy.ins().regHandler(),TaoZhuangProxy.ins().regLoginHandler(),ZbTaoZhuangProxy.ins().regLoginHandler(),EquipSwallowProxy.ins().regHandler(),LeitaiProxy.ins().regLoginHandler(),ZPZBProxy.ins().regHandler(),RelicProxy.ins().regHandler(),DailyTaskProxy.ins().regLoginHandler()},t}();__reflect(MsgHandle.prototype,"MsgHandle");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(-1!=t.indexOf("resource/"));if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameSocket=function(){function t(){this.msg_list=[],this._socketStatus=0,this._lastReceiveTime=0,this.pid=0,this.CONNECT_STEP=0,this.NOW_STEP=0,this.IS_CLOSE_SELF=!1,this.reloginTime=0,this.PACK_HANDLER=[],this._serverId=0,this._user="",this._pwd="",this.lastPos=-1,egret.startTick(this.update,this),this.newSocket(),this.recvPack=ObjectPool.pop(t.CLASSNAME),this._packets=[],this.msg_list=[]}return t.ins=function(){return t._ins||(t._ins=new t),t._ins},t.prototype.newSocket=function(){this.socket_=new egret.WebSocket,this.socket_.type=egret.WebSocket.TYPE_BINARY,this.socket_.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket_.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket_.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket_.addEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this)},t.prototype.sendToServer=function(e){this.send(e),t.recycleByte(e)},t.prototype.isConnected=function(){return this.socket_&&this.socket_.connected?!0:!1},t.prototype.connectError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.socket_.connected||RoleProxy.ins().islogin&&(ViewManager.ins().isShow(ConnetTipsView)||ViewManager.ins().open(ConnetTipsView))},t.prototype.connect=function(e,i,n){void 0===n&&(n=!1),this.socket_&&this.socket_.close(),this.updateStatus(t.STATUS_CONNECTING),CommonUtils.log("connect服务器id:",LocationProperty.srvid,e,i),DeviceUtils.IsWx?n?SdkManager.ins().IsInCheck?(CommonUtils.log("连接网关：","wss://mtlapi.wulongju.com/gametest"),this.socket_.connectByUrl("wss://mtlapi.wulongju.com/gametest")):(CommonUtils.log("连接网关：","wss://mtlapi.wulongju.com/game"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid)),this.socket_.connectByUrl("wss://mtlapi.wulongju.com/game"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid))):SdkManager.ins().IsInCheck?(CommonUtils.log("连接网关：","wss://mtlapi.wulongju.com/logintest"),this.socket_.connectByUrl("wss://mtlapi.wulongju.com/logintest")):(CommonUtils.log("连接登陆：","wss://mtlapi.wulongju.com/login"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid)),this.socket_.connectByUrl("wss://mtlapi.wulongju.com/login"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid))):DeviceUtils.IsQQ?n?SdkManager.ins().IsInCheck?(CommonUtils.log("连接网关：","wss://mtls.wulongju.com/qqgametest"),this.socket_.connectByUrl("wss://mtls.wulongju.com/qqgametest")):(CommonUtils.log("连接网关：","wss://mtls.wulongju.com/qqgame"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid)),this.socket_.connectByUrl("wss://mtls.wulongju.com/qqgame"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid))):SdkManager.ins().IsInCheck?(CommonUtils.log("连接网关：","wss://mtls.wulongju.com/qqlogintest"),this.socket_.connectByUrl("wss://mtls.wulongju.com/qqlogintest")):(CommonUtils.log("连接登陆：","wss://mtls.wulongju.com/qqlogin"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid)),this.socket_.connectByUrl("wss://mtls.wulongju.com/qqlogin"+(LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid))):this.socket_.connect(e,i)},t.prototype.close=function(){this.socket_&&(CommonUtils.log("close socket！ip:"+this._host+" port:"+this._port),this.IS_CLOSE_SELF=!0,this.socket_.close())},t.prototype.send=function(e){return this._socketStatus==t.STATUS_COMMUNICATION?(this.sendPack(e),CommonUtils.log("send msg ok!"),!0):(CommonUtils.log("发送数据时没和服务连接或者未进入通信状态"),!1)},t.prototype.onSocketConnected=function(e){CommonUtils.log("Socket connected！ip:"+this._host+" port:"+this._port),TimerManager.ins().remove(this.reLogin,this),this.updateStatus(t.STATUS_COMMUNICATION),this.socket_.flush(),this._onConnected&&this._onConnected()},t.prototype.onSocketRead=function(t){this.recvPack.clear(),this.socket_.readBytes(this.recvPack),this.handleMsg()},t.prototype.handleMsg=function(){if(!(this.recvPack.length<=0)){var t=this.recvPack.readShort(),e=(new Date,this.recvPack.length-this.recvPack.position),i=this.getBytes();i.writeBytes(this.recvPack,this.recvPack.position,e),this.msg_list.push({msgid:t,msgData:i})}},t.prototype.update=function(e){for(var i=egret.getTimer();this.msg_list&&this.msg_list.length>0&&egret.getTimer()-i<10;){var n=this.msg_list.shift();MsgHandle.ins().handleMsg(n.msgid,n.msgData),t.recycleByte(n.msgData)}return!1},t.prototype.sendKeyToServer=function(){var t=new GameByteArray;this.socket_.readBytes(t),t.position=0;var e=t.readUnsignedInt();Encrypt.setTargetSalt(e),t.position=0,t.writeShort(Encrypt.getCheckKey()),this.socket_.writeBytes(t,0,2)},t.prototype.onSocketClose=function(e){this.IS_CLOSE_SELF?this.IS_CLOSE_SELF=!1:(this.updateStatus(t.STATUS_DISCONNECT),this._onClosed&&this._onClosed(),RoleProxy.ins().islogin&&!this.socket_.connected&&(ViewManager.ins().isShow(ConnetTipsView)||ViewManager.ins().open(ConnetTipsView)),CommonUtils.log("与服务器的连接断开了！ip:"))},t.prototype.reLogin2=function(){GameApp.is_resource_loaded&&(0==this.reloginTime||TimerManager.ins().getCurrTime()-this.reloginTime>1e3)&&(this.reloginTime=TimerManager.ins().getCurrTime(),RoleProxy.ins().has_get_info=!1,TimerManager.ins().remove(this.reLogin,this),TimerManager.ins().doTimer(100,1,this.reLogin,this))},t.prototype.reLogin=function(){GuideProxy.ins().clearData(),this.close(),this.newSocket(),this.login(this._user,this._pwd,this._serverId,this._host,this._port)},t.prototype.updateStatus=function(t){if(this._socketStatus!=t){var e=this._socketStatus;this._socketStatus=t,this.onFinishCheck(t,e)}},t.prototype.onFinishCheck=function(e,i){e==t.STATUS_COMMUNICATION?this.CONNECT_STEP==t.CONNECT_STEP_LOGIN?(this.NOW_STEP=1,this.sendLoginAccount()):this.CONNECT_STEP==t.CONNECT_STEP_GW&&(this.NOW_STEP=2,this.sendGwCheck()):e==t.STATUS_DISCONNECT},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),t.prototype.sendLoginAccount=function(){LoginControl.ins().sendLogin()},t.prototype.sendGwCheck=function(){LoginControl.ins().sendAuthentication()},t.prototype.login=function(e,i,n,o,s){CommonUtils.log("login:"+o+",port:"+s),this.NOW_STEP=0,this._user=e,this._pwd=i,this._serverId=n,void 0!=o&&(o.split(":")[1]&&o.split(":")[1].length&&(s=parseInt(o.split(":")[1])),this.socket_.connected?this.sendLoginAccount():(this.CONNECT_STEP=t.CONNECT_STEP_LOGIN,this._host=o,this._port=s,this.connect(o,s)))},t.prototype.connectgw=function(e,i){this.CONNECT_STEP=t.CONNECT_STEP_GW,this.close(),this.newSocket(),"127.0.0.1"==e&&(e=this._host),this.connect(e,i,!0)},t.prototype.processRecvPacket=function(t){var e=t.readUnsignedByte(),i=t.readUnsignedByte();this.dispatch(e,i,t)},t.prototype.dispatch=function(t,e,i){if(this.PACK_HANDLER[t]&&this.PACK_HANDLER[t][e]){var n=this.PACK_HANDLER[t][e];n[0].call(n[1],i)}},t.recycleByte=function(t){ObjectPool.push(t)},t.prototype.getBytes=function(){var e=ObjectPool.pop(t.CLASSNAME);return e.clear(),e},t.prototype.registerSTCFunc=function(t,e,i,n){if(this.PACK_HANDLER[t]){if(this.PACK_HANDLER[t][e])return void console.error("重复注册协议接口"+t+"-"+e)}else this.PACK_HANDLER[t]=[];this.PACK_HANDLER[t][e]=[i,n]},t.prototype.setOnClose=function(t,e){this._onClosed=t.bind(e)},t.prototype.setOnConnected=function(t,e){this._onConnected=t.bind(e)},t.prototype.sendPack=function(e){CommonUtils.log("sendPack",e.length);var i=t.HEAD_SIZE;e.position=2,e.writeShort(e.length-i);var n=Encrypt.getCRC16ByPos(e,i);e.position=4,e.writeShort(n);var o=Encrypt.getCRC16(e,i);e.position=6,e.writeShort(o),Encrypt.encode(e,4,4),this.socket_.writeBytes(e)},t.prototype.sendPbPack=function(e,i,n){if(!this.no_game_list){this.no_game_list={};for(var o=[2001,1003,10002,10003,1020,10005],s=0;s<o.length;s++)this.no_game_list[o[s]]=!0}if(!RoleProxy.ins().has_get_info&&!this.no_game_list[e])return void CommonUtils.log("没进连接网关前发了非发协议");var r=n.create(i),a=n.encode(r).finish();if(this._socketStatus==t.STATUS_COMMUNICATION){var h=this.getBytes();h.endian=egret.Endian.LITTLE_ENDIAN,h.writeShort(e),h.writeShort(0),h.writeInt(0);var l=new egret.ByteArray(a);return l.length>0&&h.writeBytes(l,0,l.length),this.socket_.writeBytes(h,0,h.length),t.recycleByte(h),!0}return!1},t.DEFAULT_TAG=52462,t.DEFAULT_CRC_KEY=30301,t.HEAD_SIZE=8,t.STATUS_CONNECTING=1,t.STATUS_COMMUNICATION=2,t.STATUS_DISCONNECT=3,t.CONNECT_STEP_LOGIN=1,t.CONNECT_STEP_GW=2,t.CLASSNAME=egret.getQualifiedClassName(GameByteArray),t}();__reflect(GameSocket.prototype,"GameSocket");var PackageID;!function(t){t.Default=0,t.Move=1,t.Login=255}(PackageID||(PackageID={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var r=this;if("undefined"!=typeof generateEUI)console.log("主题使用_____________________________1"),egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)console.log("主题使用_____________________________2"),RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(console.log("主题使用_____________________________3"),t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},r)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var CRC16=function(){function t(){}return t.update=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=0,s=0;0==n&&(n=e.length),e.position=i;for(var r=i;n>r;++r)s=255&t.CRCBitReflect(e.readByte(),8)^o>>8&16777215,s&=255,o=t.CRCTable[s]^o<<8&4294967040;return 65535&(0^t.CRCBitReflect(o,16))},t.makeCRCTable=function(){for(var e=0,i=new Array(256),n=0;256>n;++n){e=n<<8&4294967040;for(var o=0;8>o;++o)e=32768&e?e<<1&4294967294^t.POLYNOMIAL:e<<1&4294967294;i[n]=e}return i},t.CRCBitReflect=function(e,i){var n=0,o=0;i--;for(var s=0;i>=s;++s)o=i-s,1&e&&(n|=1<<o&t.DropBits[o]),e=e>>1&2147483647;return n},t.POLYNOMIAL=4129,t.CRCTable=t.makeCRCTable(),t.DropBits=[4294967295,4294967294,4294967292,4294967288,4294967280,4294967264,4294967232,4294967168,4294967040,4294966784,4294966272,4294965248,4294963200,4294959104,4294950912,4294934528],t}();__reflect(CRC16.prototype,"CRC16");var Encrypt=function(){function t(){}return t.encode=function(e,i,n){if(void 0===i&&(i=0),void 0===n&&(n=0),i>=e.length)return 0;var o=n?i+n:e.length;o>e.length&&(o=e.length),e.position=i;for(var s=i;o>s;++s){var r=e.readByte();r^=t.sKeyBuff[s%4],e.position--,e.writeByte(r)}return o-i},t.decode=function(e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),t.encode(e,i,n)},t.getCRC16=function(t,e){return void 0===e&&(e=0),CRC16.update(t,0,e)},t.getCRC16ByPos=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),CRC16.update(t,e,i)},t.getCheckKey=function(){var e=new egret.ByteArray;e.endian=egret.Endian.LITTLE_ENDIAN,e.writeUnsignedInt(t.sKey);var i=CRC16.update(e);return i},t.getSelfSalt=function(){return t.sSelfSalt},t.getTargetSalt=function(){return t.sTargetSalt},t.setTargetSalt=function(e){t.sTargetSalt=e,t.makeKey()},t.makeSalt=function(){var t=new Date;return Math.random()*t.getTime()},t.makeKey=function(){t.sKey=(t.sSelfSalt^t.sTargetSalt)+8254;for(var e=0;4>e;++e)t.sKeyBuff[e]=(t.sKey&255<<(e<<3))>>(e<<3)},t.sSelfSalt=t.makeSalt(),t.sKeyBuff=new Array(4),t}();__reflect(Encrypt.prototype,"Encrypt");var ReportData=function(){function t(){this.httpRequest=new egret.HttpRequest}return t.getIns=function(){return this._ins=this._ins||new t,this._ins},t.prototype.report=function(t,e){void 0===e&&(e="load");var i=LocationProperty.roleCount;if("load"!=e||!isNaN(i)&&0==i){var n=navigator.userAgent.toLowerCase();n=/iphone|ipad|ipod/.test(n)?"1":/android/.test(n)?"2":"0";var o="&data=";o+="1",o+="|"+LocationProperty.srvid,o+="|"+LocationProperty.openID,o+="|"+e,o+="|"+t,o+="|"+LocationProperty.isnew,o+="|"+n,o+="|"+LocationProperty.login_ip,o+="|"+DateUtils.getFormatBySecond((new Date).getTime(),2),o+="|"+LocationProperty.appid;DeviceUtils.isLocation?"192.168.201.235:81":"report.jzsc.7yao.top"}},t.prototype.report2=function(t,e){void 0===e&&(e="load");var i=navigator.userAgent.toLowerCase();i=/iphone|ipad|ipod/.test(i)?"1":/android/.test(i)?"2":"0";
var n="&data=";n+="1",n+="|"+LocationProperty.srvid,n+="|"+LocationProperty.openID,n+="|"+e,n+="|"+t,n+="|"+LocationProperty.isnew,n+="|"+i,n+="|"+LocationProperty.login_ip,n+="|"+DateUtils.getFormatBySecond((new Date).getTime(),2),n+="|"+LocationProperty.appid;DeviceUtils.isLocation?"192.168.201.235:81":"report.jzsc.7yao.top"},t.prototype.advice=function(t,e,i){var n=function(t){this.httpRequest.removeEventListener(egret.Event.COMPLETE,n,this);var o=t.currentTarget;"ok"==o.response?(TipsControl.ins().showTips("提交问题成功！"),e.call(i)):TipsControl.ins().showTips("网络出故障，请重新提交问题！")};this.httpRequest.addEventListener(egret.Event.COMPLETE,n,this);for(var o;;){if(o=t.indexOf("@"),0>o)break;t=t.replace("@","")}var s="&serverid="+LocationProperty.srvid,r=DeviceUtils.isLocation?"cq.api.com":"login.jzsc.7yao.top";this.reportUrl("http://"+r+"/api/load?counter=enter_report"+s)},t.prototype.reportUrl=function(t,e){this.httpRequest.open(t,e?e:egret.HttpMethod.GET),this.httpRequest.send()},t.prototype.reportSDK=function(t){},t}();__reflect(ReportData.prototype,"ReportData");var RES_ROOT=["https://mtl.wulongju.com/h5game/wxres/","http://106.75.188.148:8086/","","","https://mtl.wulongju.com/h5game/qqres/"],RES_DIR="resource/assets/movie/",RES_DIR_BLOOD=RES_DIR+"blood/",RES_DIR_BODY=RES_DIR+"body/",RES_DIR_EFF=RES_DIR+"eff/",RES_DIR_ITEM=RES_DIR+"item/",RES_DIR_MONSTER=RES_DIR+"monster/",RES_DIR_NPC=RES_DIR+"npc/",RES_DIR_SKILL=RES_DIR+"skill/",RES_DIR_SKILLEFF=RES_DIR+"skilleff/",RES_DIR_WARSPIRIT=RES_DIR+"warspirit/",RES_DIR_MOUNT=RES_DIR+"mount/",RES_DIR_WEAPON=RES_DIR+"weapon/",RES_DIR_WING=RES_DIR+"wing/",RES_DIR_PARTNER=RES_DIR+"partner/",RES_DIR_PET=RES_DIR+"pet/",RES_DIR_OTHER=RES_DIR+"other/",RES_DIR_UPSTAGE=RES_DIR+"upstage/",RES_DIR_SEAT=RES_DIR+"seat/",RES_DIR_COMMON=RES_DIR+"image/",RES_DIR_ELEMENT=RES_DIR+"element/",RES_DIR_SHIELD=RES_DIR+"shield/",RES_DIR_SPIRIT=RES_DIR+"spirit/",UI_DIR="resource/image/",UI_PARTNER_DIR=UI_DIR+"partner/",UI_WEAPON_DIR=UI_DIR+"weapon/",UI_XUANBING_DIR=UI_DIR+"xuanbing/",UI_WING_DIR=UI_DIR+"wing/",UI_CLOTH_DIR=UI_DIR+"role/",UI_EFF_DIR=RES_DIR+"ui_eff/",UI_ZHENBAO_DIR=UI_DIR+"zhenbao/",UI_XIANFU_DIR=UI_DIR+"xianfu/",UI_ICON_DIR=UI_DIR+"item/",LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.sbg=new eui.Image,this.addChild(this.sbg),this.sbg.fillMode="repeat";var t=StageUtils.ins().getWidth(),e=StageUtils.ins().getHeight();this.sbg.width=t,this.sbg.height=e,this.gp=new eui.Group,this.addChild(this.gp),this.gp.width=t,this.gp.height=e,this.gp.horizontalCenter=0,this.gp.verticalCenter=0,this.bg=new eui.Image,this.bg.horizontalCenter=0,this.bg.verticalCenter=0,this.gp.addChild(this.bg),t/e>.6?(this.bg.height=t/540*900,this.bg.width=t):(this.bg.height=e,this.bg.width=e/900*540),t>=e&&(this.bg.height=e,this.bg.width=e/900*540),this.process_bg=new eui.Image,this.process_bg.horizontalCenter=0,this.gp.addChild(this.process_bg),this.process_bg.x=61,this.process_bg.y=e-200,this.process=new eui.Image,this.gp.addChild(this.process),this.process.width=0,this.process.x=(t-415)/2+19,this.process.y=e-200+9.5;var i=SdkManager.ins().channel_id;DeviceUtils.IsWx||DeviceUtils.IsQQ?(this.bg.source="images/loading_bg.jpg",this.process_bg.source="images/loding_01.png",this.process.source="images/loding_02.png",this.sbg.source="images/sbg.png",this.bg.height=e,this.bg.width=t):SdkManager.ins().sdktype==SdkType.JSSDK?(this.bg.source=UtilProxy.getStr("resource/loading/@0 /bg.jpg",[i]),this.process_bg.source="resource/prog_back_img.png",this.process.source="resource/prog_img.png",this.sbg.source="resource/sbg.png"):SdkManager.ins().sdktype==SdkType.WJSDK?(this.bg.source=window.fsSdkObj.cdnUrl+UtilProxy.getStr("resource/loading/@0 /@1 _loading.jpg?1",[i,window.fsSdkObj.platName]),this.process_bg.source=window.fsSdkObj.cdnUrl+"resource/prog_back_img.png",this.process.source=window.fsSdkObj.cdnUrl+"resource/prog_img.png",this.sbg.source=window.fsSdkObj.cdnUrl+"resource/sbg.png"):(this.bg.source=UtilProxy.getRealUrl(UtilProxy.getStr("resource/loading/@0 /loading_bg.jpg?1",[i])),this.process_bg.source=UtilProxy.getRealUrl("resource/loding_01.png"),this.process.source=UtilProxy.getRealUrl("resource/loding_02.png"),this.sbg.source=UtilProxy.getRealUrl("resource/sbg.png")),this.textField=new eui.Label,this.gp.addChild(this.textField),this.textField.horizontalCenter=0,this.textField.y=e-154,this.textField.width=480,this.textField.size=16,this.textField.textAlign="center",this.textField.text=" ",this.textField.stroke=1,this.textField.textColor=4967640},e.prototype.setVisible=function(t){this&&(this.visible=t),t||(this.process.width=0),t&&this.parent&&this.parent.setChildIndex(this,1e3)},e.prototype.starMovie=function(){this.mv_fly=new MovieClip,this.gp.addChild(this.mv_fly),this.mv_fly.playFile("resource/assets/movie/ui_eff/10108",-1),this.mv_fly.y=this.process.y,this.mv_fly.x=81,this.mv_fly.x=81+this.process.width},e.prototype.onProgress=function(t,e,i){var n=t,o=e,s=n/o*382,r=s>382?382:s;this.process.width=r,this.textField.text=i+n+"/"+o,this.mv_fly&&(this.mv_fly.x=(StageUtils.ins().getWidth()-415)/2+28+r)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var AStar=function(){function t(t){void 0===t&&(t=null),this.m_nMarkTag=0,t&&this.initFromMap(t)}return t.prototype.initFromMap=function(t){var e=0;this.m_ASMapCells?e=this.m_ASMapCells.length:this.m_ASMapCells=[],this.m_nWidth=t.numCols,this.m_nHeight=t.numRows;var i=this.m_nWidth*this.m_nHeight;i>this.m_ASMapCells.length&&(this.m_ASMapCells.length=i);for(var n=e;i>n;++n)this.m_ASMapCells[n]=new ASMapCell;var o,s,r,a;for(r=0,s=0;s<this.m_nHeight;++s)for(o=0;o<this.m_nWidth;++o)a=this.m_ASMapCells[r],a.X=o,a.Y=s,r++},t.prototype.getPath=function(e,i,n,o,s){if(e==n&&i==o)return null;if(!(0>e||e>=this.m_nWidth||0>i||i>=this.m_nHeight||0>n||n>=this.m_nWidth||0>o||o>=this.m_nHeight)){var r=this.m_ASMapCells[o*this.m_nWidth+n];if(Assert(r,"寻路异常，无法获得路径点，请确认服务器地图与前端配置一致"))return null;this.reset(e,i);var a=!1,h=e,l=i,p=this.m_ASMapCells[l*this.m_nWidth+h];p.GCost=0,p.LastX=-1,p.LastY=-1,p.X=h,p.Y=l,p.MarkTag=this.m_nMarkTag,p.HCost=Math.abs(n-e)+10*Math.abs(o-i);for(var c,u,d,g;;){if(h==n&&l==o){a=!0;break}for(p.State!=ASMapCell.CSCLOSE&&this.closeCell(p),c=0;8>c;++c)u=h+t.NEIGHBORPOS_X_VALUES[c],d=l+t.NEIGHBORPOS_Y_VALUES[c],0>u||u>=this.m_nWidth||0>d||d>=this.m_nHeight||(g=this.m_ASMapCells[d*this.m_nWidth+u],s(g.X,g.Y)&&(g.MarkTag!=this.m_nMarkTag||g.State==ASMapCell.CSNONE?(g.MarkTag=this.m_nMarkTag,g.LastX=h,g.LastY=l,g.btDir=c,g.GCost=p.GCost+t.AS_MOVECOST[1&c],g.HCost=Math.abs(n-u)+10*Math.abs(o-d),this.openCell(g)):g.State==ASMapCell.CSOPEN&&g.GCost>p.GCost+t.AS_MOVECOST[1&c]&&(g.LastX=h,g.LastY=l,g.btDir=c,g.GCost=p.GCost+t.AS_MOVECOST[1&c],this.reopenCell(g))));if(p=this.m_LastOpenCell,null==p)break;h=p.X,l=p.Y}if(a){for(var y=[];;)if(y.push(new AStarNode(p.X,p.Y,p.btDir)),p=this.m_ASMapCells[p.LastY*this.m_nWidth+p.LastX],p.LastX<=0&&p.LastY<=0||p.MarkTag!=this.m_nMarkTag)break;return y}return null}},t.prototype.reset=function(t,e){var i=this.m_ASMapCells[e*this.m_nWidth+e];i&&(i.LastX=0,i.LastY=0,i.HCost=0,i.GCost=0,i.FValue=0,i.State=0,i.Prev=null,i.Next=null,i.btDir=0,this.m_LastOpenCell=null,this.m_nMarkTag=this.m_nMarkTag+1)},t.prototype.closeCell=function(t){t.State==ASMapCell.CSOPEN&&(t.Prev&&(t.Prev.Next=t.Next),t.Next&&(t.Next.Prev=t.Prev),t==this.m_LastOpenCell&&(this.m_LastOpenCell=t.Prev)),t.State=ASMapCell.CSCLOSE},t.prototype.openCell=function(t){t.State=ASMapCell.CSOPEN;var e=t.HCost+t.GCost;t.FValue=e;var i=this.m_LastOpenCell;if(i){for(;i.FValue<e;){if(null==i.Prev)return i.Prev=t,t.Prev=null,void(t.Next=i);i=i.Prev}t.Prev=i,i.Next?(t.Next=i.Next,i.Next.Prev=t,i.Next=t):(t.Next=null,i.Next=t,this.m_LastOpenCell=t)}else this.m_LastOpenCell=t,t.Prev=null,t.Next=null},t.prototype.reopenCell=function(t){var e=t.HCost+t.GCost;t.FValue=e;var i=t.Next;if(i&&i.FValue>e){do i=i.Next;while(i&&i.FValue>e);t.Prev&&(t.Prev.Next=t.Next),t.Next&&(t.Next.Prev=t.Prev),i?(t.Next=i,i.Prev?(t.Prev=i.Prev,i.Prev.Next=t):t.Prev=null,i.Prev=t):(t.Prev=this.m_LastOpenCell,t.Next=null,this.m_LastOpenCell.Next=t,this.m_LastOpenCell=t)}},t.RMOVECOST=14,t.DMOVECOST=10,t.AS_MOVECOST=[t.DMOVECOST,t.RMOVECOST],t.NEIGHBORPOS_X_VALUES=[0,1,1,1,0,-1,-1,-1],t.NEIGHBORPOS_Y_VALUES=[-1,-1,0,1,1,1,0,-1],t.NEIGHBORPOS_X_VALUES2=[0,1,2,2,2,2,2,1,0,-1,-2,-2,-2,-2,-2,-1],t.NEIGHBORPOS_Y_VALUES2=[-2,-2,-2,-1,0,1,2,2,2,2,2,1,0,-1,-2,-2],t}();__reflect(AStar.prototype,"AStar");var ASMapCell=function(){function t(){}return t.CSNONE=0,t.CSOPEN=1,t.CSCLOSE=2,t}();__reflect(ASMapCell.prototype,"ASMapCell");var AStarNode=function(){function t(t,e,i){this.nX=t,this.nY=e,this.nDir=i}return t}();__reflect(AStarNode.prototype,"AStarNode");var BresenhamLine=function(){function t(){}return t.isAbleToThrough=function(t,e,i,n,o){var s=0,r=0,a=0,h=0,l=0,p=0,c=0,u=0,d=0,g=0,y=0,f=0,_=0,v=0;for(this.throughCheckResult||(this.throughCheckResult=new Array(4)),this.throughCheckResult[0]=0,this.throughCheckResult[1]=0,f=(n-e)/(i-t),_=n-f*i,l=i>t?1:-1,p=n>e?1:-1,s=t>>0,r=e>>0,a=i>>0,h=n>>0,c=a-s,c=(c^c>>31)-(c>>31),u=s,g=r,this.throughCheckResult[2]=u,this.throughCheckResult[3]=g,v=0;c>v;v++){for(u+=l,y=f*(l>0?u:u+1)+_,d=y>>0;g!=d;){if(g+=p,!o(u-l,g))return this.throughCheckResult;this.throughCheckResult[2]=u-l,this.throughCheckResult[3]=g}if(!o(u,d))return this.throughCheckResult;this.throughCheckResult[2]=u,this.throughCheckResult[3]=d}for(;g!=h;){if(g+=p,!o(u,g))return this.throughCheckResult;this.throughCheckResult[2]=u,this.throughCheckResult[3]=g}return this.throughCheckResult[0]=1,this.throughCheckResult},t.tileLine=function(t,e,i,n){var o=0,s=0,r=0,a=0,h=0,l=0,p=0,c=0,u=0,d=0,g=0,y=0,f=0,_=0;for(this.coords||(this.coords=[]),this.coords.length=0,y=(n-e)/(i-t),f=n-y*i,h=i>t?1:-1,l=n>e?1:-1,o=t>>0,s=e>>0,r=i>>0,a=n>>0,p=r-o,p=(p^p>>31)-(p>>31),this.coords[this.coords.length]=o,this.coords[this.coords.length]=s,c=o,d=s,_=0;p>_;_++){for(c+=h,g=y*(h>0?c:c+1)+f,u=g>>0;d!=u;)d+=l,this.coords[this.coords.length]=c-h,this.coords[this.coords.length]=d;this.coords[this.coords.length]=c,this.coords[this.coords.length]=u}for(;d!=a;)d+=l,this.coords[this.coords.length]=c,this.coords[this.coords.length]=d;return this.coords},t.getPointOnLine=function(t,e,i,n,o){var s=0,r=0,a=0,h=0;return a=i-t,h=n-e,s=Math.sqrt(a*a+h*h),r=s+o,[Math.round(t+a*r/s),Math.round(e+h*r/s)]},t.shortenPath=function(e,i,n,o){var s,r=e,a=i,h=n[n.length-2],l=n[n.length-1],p=0,c=0;n.length>=4&&(r=n[n.length-4],a=n[n.length-3]),p=h-r,c=l-a,p*p+c*c>o*o?(s=t.getPointOnLine(r,a,h,l,-o),n[n.length-2]=s[0],n[n.length-1]=s[1]):n.length-=2},t}();__reflect(BresenhamLine.prototype,"BresenhamLine");var SceneManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.clear=function(){var t=this._currScene;t&&(t.onExit(),this._currScene=void 0)},e.prototype.runScene=function(t){if(null==t)return void Debug.log("runScene:scene is null");var e=this._currScene;e&&(e.onExit(),e=void 0);var i=new t;i.onEnter(),this._currScene=i},e.prototype.getCurrScene=function(){return this._currScene},e}(BaseClass);__reflect(SceneManager.prototype,"SceneManager");var MapGrid=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"numCols",{get:function(){return this._numCols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numRows",{get:function(){return this._numRows},enumerable:!0,configurable:!0}),e.prototype.getNode=function(t,e){return this._nodes[t]?this._nodes[t][e]:void 0},e.prototype.isWalkableTile=function(t,e){return 0>t||t>=this._numCols||0>e||e>=this._numRows?!1:this._nodes[t][e].walkable},e.prototype.destruct=function(){this.clearNodes()},e.prototype.initGrid=function(t,e,i){this._nodes&&this.clearNodes(),this._numRows=t,this._numCols=e,this._nodes=[];for(var n,o=0;e>o;o++){this._nodes[o]=[];for(var s=0;t>s;s++)n=new MapGridNode,n.flags=i.mask[s*e+o],this._nodes[o][s]=n}},e.prototype.clearNodes=function(){for(var t=0;t<this._nodes.length;t++)this._nodes[t].length=0;this._nodes.length=0},e.prototype._trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];null!=this.debugTrace&&this.debugTrace.apply(null,t)},e}(egret.Sprite);__reflect(MapGrid.prototype,"MapGrid");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,0),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},e.prototype.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this,i=LocalStorageProxy.ins().getItem("mtlbgOn"),n=i?"1"==i:!0;LocalStorageProxy.ins().getItem("effectOn");return e.bgOn=n,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.playEffect=function(t){this.effectOn&&this.effect.play(t)},e.prototype.playBg=function(t){""!=t&&(this.currBg=t),this.bgOn&&(""!=t?this.bg.play(t):this.bg.play(this.currBg))},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.setEffectOn=function(t){this.effectOn=t,LocalStorageProxy.ins().SetItem("effectOn",this.effectOn?"1":"0")},e.prototype.setBgOn=function(t){this.bgOn=t,LocalStorageProxy.ins().SetItem("mtlbgOn",this.bgOn?"1":"0"),this.bgOn?this.currBg&&(this.stopBg(),this.playBg(this.currBg)):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.prototype.isBgOn=function(){return this.bgOn},e.prototype.isEffectOn=function(){return this.effectOn},e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var AlgorithmSorting;!function(t){t[t.ascending=0]="ascending",t[t.descending=1]="descending"}(AlgorithmSorting||(AlgorithmSorting={}));var Algorithm=function(){function t(){}return t.sortOn=function(t,e,i){var n=this;void 0===i&&(i=null),t.sort(function(t,o){for(var s=0,r=0,a=e.length,h=0;a>h;h++){var l=e[h];i&&i[h]==AlgorithmSorting.descending?(t[l]>o[l]&&(s|=1<<a-1-h),t[l]<o[l]&&(r|=1<<a-1-h)):(t[l]<o[l]&&(s|=1<<a-1-h),t[l]>o[l]&&(r|=1<<a-1-h))}return n.sortDesc(s,r)})},t.sortAsc=function(t,e){return e>t?-1:t>e?1:0},t.sortDesc=function(t,e){return t>e?-1:e>t?1:0},t.binSearch=function(e,i,n){if(void 0===n&&(n=null),!e||0==e.length)return 0;n||(n=t.sortAsc);for(var o=0,s=e.length-1;s>=o;){var r=s+o>>1,a=e[r];n(a,i)<=0?o=r+1:s=r-1}return o},t.test=function(){for(var e=[],i=10,n=0;i>n;n++){var o=Math.floor(1e5*Math.random()),s=t.binSearch(e,o);e.splice(s,0,o)}e.length!=i&&CommonUtils.log("test fail!count is "+e.length+", except:"+i);for(var r=0,a=e;r<a.length;r++){var h=a[r];CommonUtils.log(h)}for(var n=0;n<e.length-1;n++)if(e[n]>e[n+1]){CommonUtils.log("test fail!index:"+n);break}},t}();__reflect(Algorithm.prototype,"Algorithm");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();__reflect(AverageUtils.prototype,"AverageUtils");var ColorUtil=function(){function t(){}return t.mergeARGB=function(t,e,i,n){return t<<24|e<<16|i<<8|n},t.getChannel=function(t,e){switch(e){case this.ALPHA:return t>>24&255;case this.RED:return t>>16&255;case this.GREEN:return t>>8&255;case this.BLUE:return 255&t}return 0},t.numberToString=function(t,e){return void 0===e&&(e="#"),e+t.toString(16)},t.justColor=function(t,e){return this.getHtmlString(t,e,0)},t.bold=function(t){return"<b>"+t+"</b>"},t.getHtmlString=function(t,e,i,n,o){void 0===e&&(e=""),void 0===i&&(i=22),void 0===n&&(n=""),void 0===o&&(o=!1);var s="<font ";return e&&e.length>0&&(s+="color='"+e+"'"),i>0&&(s+="size='"+i+"'"),n.length>0&&(s+="face='"+n+"'"),s+=">"+t+"</font>",o&&(s=this.bold(s)),s},t.ALPHA=4278190080,t.RED=14432281,t.GREEN=2680104,t.BLUE=2017279,t.ORANGE=16683797,t.PURPLE=14432281,t.HUISE=8421504,t}();__reflect(ColorUtil.prototype,"ColorUtil");var CommonUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.addLableStrokeColor=function(t,e,i){t.strokeColor=e,t.stroke=i},e.getObjectLength=function(t){var e=0;for(var i in t)e++;return e},e.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var i=Object.keys(t),n=0,o=i.length;o>n;n++){var s=i[n];e[s]=this.copyDataHandler(t[s])}return e},e.lock=function(){StageUtils.ins().getStage().touchEnabled=StageUtils.ins().getStage().touchChildren=!1},e.unlock=function(){StageUtils.ins().getStage().touchEnabled=StageUtils.ins().getStage().touchChildren=!0},e.labelIsOverLenght=function(t,e){t.text=this.overLength(e)},e.overLength=function(t){var e=null;return 1e5>t?e=t:t>1e8?(t/=1e8,t=Math.floor(10*t)/10,e=t+"亿"):(t/=1e4,t=Math.floor(10*t)/10,e=t+"万"),e},e.overLengthChange=function(t){var e=null;return 1e4>t?e=t:t>1e8?(t/=1e8,t=Math.floor(10*t)/10,e=t+"亿"):(t/=1e4,t=Math.floor(10*t)/10,e=t+"万"),e},e.cloneObject=function(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var i=new Date;return i.setTime(t.getTime()),i}if(t instanceof Array){for(var i=[],n=t.length,o=0;n>o;++o)i[o]=e.cloneObject(t[o]);return i}if(t instanceof Object){var i={};for(var s in t)t.hasOwnProperty(s)&&(i[s]=e.cloneObject(t[s]));return i}throw new Error("Unable to copy obj! Its type isn't supported.")},e.log=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.showlog&&console.log.apply(console,[t].concat(e))},e.logError=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.showlog&&console.error.apply(console,[t].concat(e))},e.logtrace=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.showlog&&console.trace.apply(console,[t].concat(e))},e.showlog=!1,e}(BaseClass);__reflect(CommonUtils.prototype,"CommonUtils");var DateStyle=function(t){function e(e,i,n,o){var s=t.call(this)||this;return s.format=[],s.from=0,s.to=0,s.isFormatNum=!1,s.format=e,s.from=i,s.to=n,s.isFormatNum=o,s}return __extends(e,t),e}(BaseClass);__reflect(DateStyle.prototype,"DateStyle");var DateUtils=function(){function t(){}return t.getFormatTimeByStyle=function(e,i){if(void 0===i&&(i=t.STYLE_1),0>e&&(e=0,CommonUtils.log("输入参数有误!时间为负数:"+e)),i.from>i.to)return CommonUtils.log("输入参数有误!to参数必须大于等于from参数,请检查style参数的值"),"";e>>=0;for(var n="",o=i.to;o>=i.from;o--){var s=e/this.mul[o],r="";o!=i.to&&(s%=this.mod[o]),r=i.isFormatNum&&10>s?"0"+(s>>0).toString():(s>>0).toString(),n+=r+i.format[o]}return n},t.getFormatTimeByStyle1=function(e,i){return void 0===i&&(i=t.STYLE_1),this.getFormatTimeByStyle(e/this.MS_PER_SECOND)},t.formatMiniDateTime=function(e){return t.MINI_DATE_TIME_BASE+(2147483647&e)*t.MS_PER_SECOND},t.formatServerTime=function(e){return(e-t.MINI_DATE_TIME_BASE)/t.MS_PER_SECOND},t.getFormatBySecond=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=2);var n="",o=1e3*t;switch(e){case this.TIME_FORMAT_1:n=this.format_1(o);break;case this.TIME_FORMAT_2:n=this.format_2(o);break;case this.TIME_FORMAT_3:n=this.format_3(o);break;case this.TIME_FORMAT_4:n=this.format_4(o);break;case this.TIME_FORMAT_5:n=this.format_5(o,i);break;case this.TIME_FORMAT_6:n=this.format_6(o);break;case this.TIME_FORMAT_7:n=this.format_7(o);break;case this.TIME_FORMAT_8:n=this.format_8(o);break;case this.TIME_FORMAT_9:n=this.format_9(o)}return n},t.format_1=function(e){var i=0,n="##:##:##";return i=Math.floor(e/t.MS_PER_HOUR),n=n.replace("##",t.formatTimeNum(i)),i&&(e-=i*t.MS_PER_HOUR),i=Math.floor(e/t.MS_PER_MINUTE),n=n.replace("##",t.formatTimeNum(i)),i&&(e-=i*t.MS_PER_MINUTE),i=Math.floor(e/1e3),n=n.replace("##",t.formatTimeNum(i))},t.format_2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),s=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return i+"-"+n+"-"+o+" "+s+":"+r+":"+a},t.format_3=function(t){var e=this.format_1(t),i=e.split(":");return i[1]+":"+i[2]},t.format_4=function(t){return t<this.MS_PER_HOUR?Math.floor(t/this.MS_PER_MINUTE)+"分钟前":t<this.MS_PER_DAY?Math.floor(t/this.MS_PER_HOUR)+"小时前":Math.floor(t/this.MS_PER_DAY)+"天前"},t.format_5=function(t,e){void 0===e&&(e=2);var i="",n=["天","小时","分","秒"],o=[],s=Math.floor(t/this.MS_PER_DAY);o.push(s),t-=s*this.MS_PER_DAY;var r=Math.floor(t/this.MS_PER_HOUR);o.push(r),t-=r*this.MS_PER_HOUR;var a=Math.floor(t/this.MS_PER_MINUTE);o.push(a),t-=a*this.MS_PER_MINUTE;var h=Math.floor(t/1e3);o.push(h);for(var l in o)if(o[l]>0&&(i+=this.formatTimeNum(o[l])+n[l],e--,0>=e))break;return i},t.format_6=function(t){var e=new Date(t),i=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return this.formatTimeNum(i)+":"+this.formatTimeNum(n)+":"+this.formatTimeNum(o)},t.format_7=function(t){return t<this.MS_PER_HOUR?"<1小时":t<this.MS_PER_DAY?Math.floor(t/this.MS_PER_HOUR)+"小时":Math.floor(t/this.MS_PER_DAY)+"天"},t.format_8=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),s=e.getHours(),r=e.getMinutes();return i+"-"+n+"-"+o+" "+s+":"+r},t.format_9=function(t){var e=Math.floor(t/this.MS_PER_HOUR);t-=e*this.MS_PER_HOUR;var i=Math.floor(t/this.MS_PER_MINUTE);t-=i*this.MS_PER_MINUTE;var n=Math.floor(t/1e3);return e+"小时"+i+"分钟"+n+"秒"},t.format_10=function(t){var e=Math.floor(t/this.MS_PER_HOUR);t-=e*this.MS_PER_HOUR;var i=Math.floor(t/this.MS_PER_MINUTE);t-=i*this.MS_PER_MINUTE;var n=Math.floor(t/1e3);return i+"分钟"+n+"秒"},t.formatTimeNum=function(t){return t>=10?t.toString():"0"+t},t.TIME_FORMAT_1=1,t.TIME_FORMAT_2=2,t.TIME_FORMAT_3=3,t.TIME_FORMAT_4=4,t.TIME_FORMAT_5=5,t.TIME_FORMAT_6=6,t.TIME_FORMAT_7=7,t.TIME_FORMAT_8=8,t.TIME_FORMAT_9=9,t.MS_PER_SECOND=1e3,t.MS_PER_MINUTE=6e4,t.MS_PER_HOUR=36e5,t.MS_PER_DAY=864e5,t.SECOND_PER_MIN=60,t.SECOND_PER_HOUR=3600,t.SECOND_PER_DAY=86400,t.SECOND_PER_MONTH=2592e3,t.SECOND_PER_YEAR=31104e3,t.DAYS_PER_WEEK=7,t.YEAR_PER_YEAR=1,t.MONTH_PER_YEAR=12,t.DAYS_PER_MONTH=30,t.HOURS_PER_DAY=24,t.MUNITE_PER_HOUR=60,t.SECOND_PER_MUNITE=60,t.SECOND_PER_SECOND=1,t.mod=[t.SECOND_PER_MUNITE,t.MUNITE_PER_HOUR,t.HOURS_PER_DAY,t.DAYS_PER_MONTH,t.MONTH_PER_YEAR,t.YEAR_PER_YEAR],t.mul=[t.SECOND_PER_SECOND,t.SECOND_PER_MUNITE,t.SECOND_PER_HOUR,t.SECOND_PER_DAY,t.SECOND_PER_MONTH,t.SECOND_PER_YEAR],t.MINI_DATE_TIME_BASE=Date.UTC(2010,0)+(new Date).getTimezoneOffset()*t.MS_PER_MINUTE,t.TIME_ZONE_OFFSET=8*t.MS_PER_HOUR,t.TO_SECOND=0,t.TO_MINUTE=1,t.TO_HOUR=2,t.TO_DAY=3,t.TO_MONTH=4,t.TO_YEAR=5,t.FORMAT_1=["秒","分","时","天","月","年"],t.FORMAT_2=[":",":",":",":",":",":"],t.STYLE_1=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_HOUR,!1),t.STYLE_2=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_DAY,!1),t.STYLE_3=new DateStyle(t.FORMAT_2,t.TO_SECOND,t.TO_HOUR,!0),t.STYLE_4=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_MINUTE,!0),t}();__reflect(DateUtils.prototype,"DateUtils");var Debug=function(){function t(){}return t.isOpen=function(t){this._isOpen=t},Object.defineProperty(t,"isDebug",{get:function(){return window.isDebug?window.isDebug:!1},enumerable:!0,configurable:!0}),t.log=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.isDebug&&egret.log(e,i)},t.warn=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.isDebug&&egret.warn(e,i)},t.error=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];egret.error(t,e)},t.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},t.stop=function(e){if(!this._isOpen)return 0;if(!this._startTimes[e])return 0;var i=egret.getTimer()-this._startTimes[e];return i>this._threshold&&t.log(e+": "+i),i},t.setThreshold=function(t){this._threshold=t},t.lyl_log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];CommonUtils.log("lyl log: "+t)},t._startTimes={},t._threshold=3,t}();__reflect(Debug.prototype,"Debug");var DebugUtils=function(){function t(){}return t.isOpen=function(t){this._isOpen=t},Object.defineProperty(t,"isDebug",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),t.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},t.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&CommonUtils.log(t+": "+e),e},t.setThreshold=function(t){this._threshold=t},t._startTimes={},t._threshold=3,t}();__reflect(DebugUtils.prototype,"DebugUtils");var DeviceUtils=function(){function t(){}return Object.defineProperty(t,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isLocation",{get:function(){return location.href.indexOf("192.168.201")>=0||location.href.indexOf("127.0.0.1")>=0||location.href.indexOf("localhost")>=0||location.href.indexOf("cq.api.com")>=0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsIos",{get:function(){return t.IsWx?SdkManager.ins().sdk&&SdkManager.ins().sdk.systemInfo&&SdkManager.ins().sdk.systemInfo.system?-1!=SdkManager.ins().sdk.systemInfo.system.toLowerCase().indexOf("ios"):!1:t.IsQQ?SdkManager.ins().sdk&&SdkManager.ins().sdk.systemInfo&&SdkManager.ins().sdk.systemInfo.system?-1!=SdkManager.ins().sdk.systemInfo.system.toLowerCase().indexOf("ios"):!1:SdkManager.ins().sdktype==SdkType.JSSDK?!1:SdkManager.ins().sdktype==SdkType.WJSDK?!1:SdkManager.ins().sdktype==SdkType.Quick||SdkManager.ins().sdktype==SdkType.CSJSDK?!1:-1!=egret.Capabilities.os.toLowerCase().indexOf("ios")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsWx",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQQ",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.QQGAME},enumerable:!0,configurable:!0}),t}();__reflect(DeviceUtils.prototype,"DeviceUtils");var DirUtil=function(){function t(){}return t.get8DirBy2Point=function(t,e){var i=MathUtils.getAngle(MathUtils.getRadian2(t.x,t.y,e.x,e.y));return this.angle2dir(i)},t.dir2angle=function(t){return t*=45,t-=90},t.angle2dir=function(t){var e=1;return t>=0&&90>t?e=3:t>=90&&180>t?e=5:t>=-180&&-90>t&&(e=7),e},t.dirOpposit=function(t){return 4>t?t+4:t-4},t.get5DirBy8Dir=function(t){return t-this.isScaleX(t)},t.isScaleX=function(t){var e=2*(t-4);return 0>e&&(e=0),e},t.getGridByDir=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i={x:0,y:0});var n=this.dir2angle(this.dirOpposit(t));return MathUtils.getDirMove(n,e*GameMap.CELL_SIZE,i.x,i.y)},t}();__reflect(DirUtil.prototype,"DirUtil");var DisplayUtils=function(){function t(){}return t.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createToggleButton=function(t,e){var i=new eui.ToggleButton;return i.skinName=e,t.addChild(i),i},t.createEuiImage=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=new eui.Image;return o.x=i,o.y=n,o.source=e,t.addChild(o),o},t.removeFromParent=function(t){t&&null!=t.parent&&t.parent.removeChild(t)},t.createEuiLabelText=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0);var s=new eui.Label;return s.x=i,s.y=n,s.text=e,s.size=o,s.fontFamily="黑体",t.addChild(s),s},t.createEuiLabelTextFlow=function(t,e,i,n,o,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=22),void 0===s&&(s="黑体");var r=new eui.Label;return r.x=i,r.y=n,r.textFlow=(new egret.HtmlTextParser).parser(e),r.size=o,r.fontFamily=s,t.addChild(r),r},t.createEuiLabelXY=function(t,e,i,n){var o=new eui.Label;return o.text=e,o.x=i,o.y=n,t.addChild(o),o},t.shakeIt=function(e,i,n,o,s){if(void 0===o&&(o=1),void 0===s&&(s=function(){return!0}),!e||0==o||!s())return t.shakingList[e.hashCode]=void 0,void egret.Tween.removeTweens(e);var r=t.shakingList[e.hashCode];if(!r){t.shakingList[e.hashCode]=!0;var a=[{anchorOffsetX:-i,anchorOffsetY:-i},{anchorOffsetX:i,anchorOffsetY:i},{anchorOffsetX:-i,anchorOffsetY:i},{anchorOffsetX:i,anchorOffsetY:-i},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(e);var h=n/5;egret.Tween.get(e).to(a[0],h).to(a[1],h).to(a[2],h).to(a[3],h).to(a[4],h).call(function(){t.shakingList[e.hashCode]=void 0,t.shakeIt(e,i,n,o>0?--o:o)},this)}},t.stopShakeIt=function(e){var i=t.shakingList[e.hashCode];i&&egret.Tween.removeTweens(e)},t.flashingObj=function(t,e,i){void 0===i&&(i=300);var n=function(){if(e){t.visible=!0;var o=1==t.alpha?0:1;egret.Tween.removeTweens(t),egret.Tween.get(t).to({alpha:o},i).call(n)}else egret.Tween.removeTweens(t),t.alpha=1,t.visible=!1};n()},t.showAttribute=function(t,e,i){void 0===i&&(i={});for(var n,o,s=t.length,r=[],a=i.nameStyle||{},h=i.valueStyle||{textColor:16760383},l=0;l<e.length;l++)o=l%s,r[o]=r[o]||[],e[l]&&null!=e[l].value&&(e[l].type&&(n=Lang.itemComAttrName1[e[l].type],r[o].push({text:n+" : ",style:a})),r[o].push({text:e[l].value+"\n",style:h}));for(var l=0;s>l;l++)t[l].textFlow=r[l]},t.shakingList={},t}();__reflect(DisplayUtils.prototype,"DisplayUtils");var ErrorLog=function(){function t(){}return t.ins=function(){return this._ins=this._ins||new t,this._ins},t.prototype.show=function(t){},t.Assert=function(e,i){return e?!1:(DeviceUtils.isLocation&&t.ins().show(i),t.httpLog,!0)
},t.httpLog=!0,t}();__reflect(ErrorLog.prototype,"ErrorLog");var Assert=ErrorLog.Assert;window.onerror=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i="",n="";if(t[4]&&t[4].stack){var o=t[4].stack.split("at ");i=o[1].split(" ")[0];for(var s=2;s<o.length;s++){var r=o[s].split("/");n+=r[r.length-1]}}var a="兼容问题无法获取值",h="错误信息："+t[0]+"\n"+("出错位置："+t[2]+"行"+(t[3]?t[3]+"列":a)+"\n")+("出错函数："+i+"\n")+("函数调用："+n);h.indexOf(a)>=0||alert(h)};var KeyboardUtils=function(t){function e(){var e=t.call(this)||this;if(e.key_ups=new Array,e.key_downs=new Array,DeviceUtils.IsHtml5){var i=e;document.addEventListener("keyup",function(t){for(var e=0,n=i.key_ups.length;n>e;e++){var o=i.key_ups[e][0],s=i.key_ups[e][1];s?o.call(s,t.keyCode):o(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var e=0,n=i.key_downs.length;n>e;e++){var o=i.key_downs[e][0],s=i.key_downs[e][1];s?o.call(s,t.keyCode):o(t.keyCode)}})}return e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addKeyUp=function(t,e){this.key_ups.push([t,e])},e.prototype.addKeyDown=function(t,e){this.key_downs.push([t,e])},e.prototype.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},e.prototype.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},e}(BaseClass);__reflect(KeyboardUtils.prototype,"KeyboardUtils");var KeyCode=function(){function t(){}return t.KC_1=49,t.KC_2=50,t.KC_3=51,t.KC_4=52,t.KC_5=53,t.KC_6=54,t.KC_7=55,t.KC_8=56,t.KC_9=57,t.KC_0=48,t.KC_A=65,t.KC_B=66,t.KC_C=67,t.KC_D=68,t.KC_E=69,t.KC_F=70,t.KC_G=71,t.KC_H=72,t.KC_I=73,t.KC_J=74,t.KC_K=75,t.KC_L=76,t.KC_M=77,t.KC_N=78,t.KC_O=79,t.KC_P=80,t.KC_Q=81,t.KC_R=82,t.KC_S=83,t.KC_T=84,t.KC_U=85,t.KC_V=86,t.KC_W=87,t.KC_X=88,t.KC_Y=89,t.KC_Z=90,t.KC_F1=112,t.KC_F2=113,t.KC_F3=114,t.KC_F4=115,t.KC_F5=116,t.KC_F6=117,t.KC_F7=118,t.KC_F8=119,t.KC_F9=120,t.KC_F10=121,t.KC_F11=122,t.KC_F12=123,t.KC_F13=124,t.KC_F14=125,t.KC_F15=126,t.KC_NUMPAD_0=96,t.KC_NUMPAD_1=97,t.KC_NUMPAD_2=98,t.KC_NUMPAD_3=99,t.KC_NUMPAD_4=100,t.KC_NUMPAD_5=101,t.KC_NUMPAD_6=102,t.KC_NUMPAD_7=103,t.KC_NUMPAD_8=104,t.KC_NUMPAD_9=105,t.KC_NUMPAD_MULTIPLY=106,t.KC_NUMPAD_ADD=107,t.KC_NUMPAD_ENTER=108,t.KC_NUMPAD_SUBTRACT=109,t.KC_NUMPAD_DECIMAL=110,t.KC_NUMPAD_DIVIDE=111,t.KC_BACKSPACE=8,t.KC_TAB=9,t.KC_ENTER=13,t.KC_SHIFT=16,t.KC_CONTROL=17,t.KC_ESCAPE=27,t.KC_SPACE=32,t.KC_WINDOWS=91,t.KC_MENU=93,t.KC_CAPS_LOCK=20,t.KC_NUM_LOCK=144,t.KC_SCROLL_LOCK=145,t.KC_PAUSE=19,t.KC_PAGE_UP=33,t.KC_PAGE_DOWN=34,t.KC_END=35,t.KC_HOME=36,t.KC_INSERT=45,t.KC_DELETE=46,t.KC_LEFT=37,t.KC_UP=38,t.KC_RIGHT=39,t.KC_DOWN=40,t.KC_SEMICOLON_COLON=186,t.KC_EQUAL_PLUS=187,t.KC_MINUS_UNDERLINE=189,t.KC_SLASH_QUESTIONMARK=191,t.KC_SPECIALCOMMA_EARTHWORM=192,t.KC_LEFT_BRACKET_BRACE=219,t.KC_BACKSLASH_VERTICALBAR=220,t.KC_RIGHT_BRACKET_BRACE=221,t.KC_QUOTE=222,t.KC_COMMA=188,t.KC_PERIOD=190,t}();__reflect(KeyCode.prototype,"KeyCode");var LocationProperty=function(){function t(){}return t.init=function(){this.urlParam={};var t=window.paraUrl;if(t){var e=t.indexOf("?");if(-1!=e)for(var i=t.slice(e+1).split("&"),n=void 0,o=0;o<i.length;o++)n=i[o].split("="),this.urlParam[n[0]]=n[1]}},Object.defineProperty(t,"resAdd",{get:function(){return this.urlParam.hosts||""},set:function(t){this.urlParam.hosts=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openID",{get:function(){return this.urlParam.user},set:function(t){this.urlParam.user=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvid",{get:function(){return Number(this.urlParam.srvid)},set:function(t){this.urlParam.srvid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvid2",{get:function(){return Number(this.urlParam.srvid2)},set:function(t){this.urlParam.srvid2=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverIP",{get:function(){return this.urlParam.srvaddr},set:function(t){this.urlParam.srvaddr=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverPort",{get:function(){return this.urlParam.srvport||9001},set:function(t){this.urlParam.srvport=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvdata",{get:function(){return this.urlParam.srvdata},set:function(t){this.urlParam.srvdata=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"password",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openKey",{get:function(){return this.urlParam.openkey},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverID",{get:function(){return this.urlParam.serverid},enumerable:!0,configurable:!0}),Object.defineProperty(t,"appid",{get:function(){return this.urlParam.appid||""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"app_openid",{get:function(){return this.urlParam.app_openid||""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isSubscribe",{get:function(){return this.urlParam.isSubscribe},enumerable:!0,configurable:!0}),Object.defineProperty(t,"nickName",{get:function(){var t=this.urlParam.nickName||"";try{return t.length?decodeURIComponent(t):t}catch(e){return t}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"callUrl",{get:function(){var t=this.urlParam.callUrl||"";return t.length?decodeURIComponent(t):t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gifi",{get:function(){return this.urlParam.gifi},enumerable:!0,configurable:!0}),Object.defineProperty(t,"roleCount",{get:function(){return parseInt(this.urlParam.roleCount)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isnew",{get:function(){return parseInt(this.urlParam.isnew)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"login_ip",{get:function(){return this.urlParam.login_ip},enumerable:!0,configurable:!0}),Object.defineProperty(t,"is_attention",{get:function(){return this.urlParam.is_attention},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isShowShare",{get:function(){return window.isShowShare},enumerable:!0,configurable:!0}),Object.defineProperty(t,"v",{get:function(){return parseInt(this.urlParam.v)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isYelloVip",{get:function(){return parseInt(this.urlParam.isYelloVip)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isYelloYearVip",{get:function(){return parseInt(this.urlParam.isYelloYearVip)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"yelloVipLevel",{get:function(){return parseInt(this.urlParam.yelloVipLevel)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isYelloHighVip",{get:function(){return parseInt(this.urlParam.isYelloHighVip)},enumerable:!0,configurable:!0}),t.isCanLogin=function(){return null!=this.openID&&null!=this.password&&null!=this.srvid&&null!=this.serverIP&&null!=this.serverPort},Object.defineProperty(t,"isWaiWang",{get:function(){return!isNaN(t.roleCount)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isFirstLoad",{get:function(){return t.isWaiWang&&!t.roleCount},enumerable:!0,configurable:!0}),t.setLoadProgress=function(t,e){},Object.defineProperty(t,"isQJ",{get:function(){return window.isQJ},enumerable:!0,configurable:!0}),t.consoleWrite=function(t){var e=new Date,i=t+"  "+e.getHours()+","+e.getMinutes()+","+e.getSeconds()+","+e.getMilliseconds();CommonUtils.log(i)},t.consoleEgret=function(t){var e=new Date,i=t+"  "+e.getHours()+","+e.getMinutes()+","+e.getSeconds()+","+e.getMilliseconds();egret.log(i)},t}();__reflect(LocationProperty.prototype,"LocationProperty");var XY=function(){function t(){}return t}();__reflect(XY.prototype,"XY");var MathUtils=function(){function t(){}return t.getAngle=function(t){return 180*t/Math.PI},t.getRadian=function(t){return t/180*Math.PI},t.getRadian2=function(t,e,i,n){var o=i-t,s=n-e;return Math.atan2(s,o)},t.getDistance=function(t,e,i,n){var o=i-t,s=n-e,r=o*o+s*s;return Math.sqrt(r)},t.getDistanceByObject=function(t,e){return this.getDistance(t.x,t.y,e.x,e.y)},t.getDistanceX2ByObject=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},t.getDirMove=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=this.getRadian(t),s={x:0,y:0};return s.x=Math.cos(o)*e+i,s.y=Math.sin(o)*e+n,s},t.getPByDistance=function(t,e,i){var n=Math.atan2(e.y-t.y,e.x-t.x),o=new egret.Point;return o.x=e.x+i*Math.cos(n),o.y=e.y+i*Math.sin(n),o},t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.round(this.limit(t,e))},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t.toInteger=function(t){return t>>0},t.getRectangle=function(t,e,i,n,o,s){void 0===s&&(s=Number.MAX_VALUE);var r=[];r.push(e);for(var a=i*GameMap.CELL_SIZE,h=e.x-t.x,l=e.y-t.y,p=Math.atan2(l,h),c=n*GameMap.CELL_SIZE/2,u=0,d=o;u<d.length;u++){var g=d[u];if(r.length>=s)break;var y=g.x-t.x,f=g.y-t.y,_=Math.abs(Math.atan2(f,y)-p),v=y*y+f*f,m=Math.cos(_),C=Math.sin(_);(_<=Math.PI/2||_>=3*Math.PI/2)&&a*a>=m*m*v&&c*c>=C*C*v&&e!=g&&r.push(g)}return r},t.getFanshaped=function(t,e,i,n,o,s){void 0===s&&(s=Number.MAX_VALUE);var r=[];r.push(e);var a,h,l,p,c=GameMap.CELL_SIZE,u=Math.pow(i*c,2),d=this.getRadian(n)/2;a=e.x-t.x,l=e.y-t.y;for(var g=0,y=o;g<y.length;g++){var f=y[g];if(r.length>=s)break;h=f.x-t.x,p=f.y-t.y;var _=h*h+p*p,v=Math.abs(Math.atan2(l,a)-Math.atan2(p,h));u>_&&d>v&&e!=f&&r.push(f)}return r},t.getClosest=function(t,e,i){void 0===i&&(i=1);for(var n=[],o="_tDis",s=e.length,r=0;s>r;r++){var a=this.getDistanceByObject(t,e[r]);e[r][o]=a,n.push(e[r])}return n.sort(function(t,e){return Algorithm.sortAsc(t[o],e[o])}),n.length>i&&(n.length=i),n},t.getRangePoint=function(t,e,i){var n=[],o=this.getRandom(i/4,i),s=0,r=0,a=this.getRandom(0,90),h=this.getRadian(a);return s=o*Math.sin(h),r=o*Math.cos(h),n[0]=Math.random()>.45?t+r:t-r,n[1]=Math.random()>.45?e+s:e-s,n},t.getPoint=function(t,e,i,n,o){void 0===o&&(o=360);for(var s=[],r=Math.PI/180*Math.round(o/n),a=0;n>a;a++){var h=e+t*Math.sin(r*a),l=i+t*Math.cos(r*a);s.unshift({x:h,y:l})}return s},t.getRandom=function(t,e){var i=Math.floor(Math.random()*(e-t)+t);return i},t}();__reflect(MathUtils.prototype,"MathUtils");var md5=function(){function t(){}return t.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),o=Array(16),s=0;16>s;s++)n[s]=909522486^i[s],o[s]=1549556828^i[s];var r=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(o.concat(r),640))},t.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",s=0;s<t.length;s++)i=t.charCodeAt(s),o+=n.charAt(i>>>4&15)+n.charAt(15&i);return o},t.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=t.length,s=0;o>s;s+=3)for(var r=t.charCodeAt(s)<<16|(o>s+1?t.charCodeAt(s+1)<<8:0)|(o>s+2?t.charCodeAt(s+2):0),a=0;4>a;a++)n+=8*s+6*a>8*t.length?this.b64pad:i.charAt(r>>>6*(3-a)&63);return n},t.rstr2any=function(t,e){var i,n,o,s,r,a=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),p=Array(l);for(n=0;l>n;n++){for(r=Array(),s=0,i=0;i<h.length;i++)s=(s<<16)+h[i],o=Math.floor(s/a),s-=o*a,(r.length>0||o>0)&&(r[r.length]=o);p[n]=s,h=r}var c="";for(i=p.length-1;i>=0;i--)c+=e.charAt(p[i]);return c},t.str2rstr_utf8=function(t){for(var e,i,n="",o=-1;++o<t.length;)e=t.charCodeAt(o),i=o+1<t.length?t.charCodeAt(o+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),o++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,o=-1732584194,s=271733878,r=0;r<t.length;r+=16){var a=i,h=n,l=o,p=s;i=this.md5_ff(i,n,o,s,t[r+0],7,-680876936),s=this.md5_ff(s,i,n,o,t[r+1],12,-389564586),o=this.md5_ff(o,s,i,n,t[r+2],17,606105819),n=this.md5_ff(n,o,s,i,t[r+3],22,-1044525330),i=this.md5_ff(i,n,o,s,t[r+4],7,-176418897),s=this.md5_ff(s,i,n,o,t[r+5],12,1200080426),o=this.md5_ff(o,s,i,n,t[r+6],17,-1473231341),n=this.md5_ff(n,o,s,i,t[r+7],22,-45705983),i=this.md5_ff(i,n,o,s,t[r+8],7,1770035416),s=this.md5_ff(s,i,n,o,t[r+9],12,-1958414417),o=this.md5_ff(o,s,i,n,t[r+10],17,-42063),n=this.md5_ff(n,o,s,i,t[r+11],22,-1990404162),i=this.md5_ff(i,n,o,s,t[r+12],7,1804603682),s=this.md5_ff(s,i,n,o,t[r+13],12,-40341101),o=this.md5_ff(o,s,i,n,t[r+14],17,-1502002290),n=this.md5_ff(n,o,s,i,t[r+15],22,1236535329),i=this.md5_gg(i,n,o,s,t[r+1],5,-165796510),s=this.md5_gg(s,i,n,o,t[r+6],9,-1069501632),o=this.md5_gg(o,s,i,n,t[r+11],14,643717713),n=this.md5_gg(n,o,s,i,t[r+0],20,-373897302),i=this.md5_gg(i,n,o,s,t[r+5],5,-701558691),s=this.md5_gg(s,i,n,o,t[r+10],9,38016083),o=this.md5_gg(o,s,i,n,t[r+15],14,-660478335),n=this.md5_gg(n,o,s,i,t[r+4],20,-405537848),i=this.md5_gg(i,n,o,s,t[r+9],5,568446438),s=this.md5_gg(s,i,n,o,t[r+14],9,-1019803690),o=this.md5_gg(o,s,i,n,t[r+3],14,-187363961),n=this.md5_gg(n,o,s,i,t[r+8],20,1163531501),i=this.md5_gg(i,n,o,s,t[r+13],5,-1444681467),s=this.md5_gg(s,i,n,o,t[r+2],9,-51403784),o=this.md5_gg(o,s,i,n,t[r+7],14,1735328473),n=this.md5_gg(n,o,s,i,t[r+12],20,-1926607734),i=this.md5_hh(i,n,o,s,t[r+5],4,-378558),s=this.md5_hh(s,i,n,o,t[r+8],11,-2022574463),o=this.md5_hh(o,s,i,n,t[r+11],16,1839030562),n=this.md5_hh(n,o,s,i,t[r+14],23,-35309556),i=this.md5_hh(i,n,o,s,t[r+1],4,-1530992060),s=this.md5_hh(s,i,n,o,t[r+4],11,1272893353),o=this.md5_hh(o,s,i,n,t[r+7],16,-155497632),n=this.md5_hh(n,o,s,i,t[r+10],23,-1094730640),i=this.md5_hh(i,n,o,s,t[r+13],4,681279174),s=this.md5_hh(s,i,n,o,t[r+0],11,-358537222),o=this.md5_hh(o,s,i,n,t[r+3],16,-722521979),n=this.md5_hh(n,o,s,i,t[r+6],23,76029189),i=this.md5_hh(i,n,o,s,t[r+9],4,-640364487),s=this.md5_hh(s,i,n,o,t[r+12],11,-421815835),o=this.md5_hh(o,s,i,n,t[r+15],16,530742520),n=this.md5_hh(n,o,s,i,t[r+2],23,-995338651),i=this.md5_ii(i,n,o,s,t[r+0],6,-198630844),s=this.md5_ii(s,i,n,o,t[r+7],10,1126891415),o=this.md5_ii(o,s,i,n,t[r+14],15,-1416354905),n=this.md5_ii(n,o,s,i,t[r+5],21,-57434055),i=this.md5_ii(i,n,o,s,t[r+12],6,1700485571),s=this.md5_ii(s,i,n,o,t[r+3],10,-1894986606),o=this.md5_ii(o,s,i,n,t[r+10],15,-1051523),n=this.md5_ii(n,o,s,i,t[r+1],21,-2054922799),i=this.md5_ii(i,n,o,s,t[r+8],6,1873313359),s=this.md5_ii(s,i,n,o,t[r+15],10,-30611744),o=this.md5_ii(o,s,i,n,t[r+6],15,-1560198380),n=this.md5_ii(n,o,s,i,t[r+13],21,1309151649),i=this.md5_ii(i,n,o,s,t[r+4],6,-145523070),s=this.md5_ii(s,i,n,o,t[r+11],10,-1120210379),o=this.md5_ii(o,s,i,n,t[r+2],15,718787259),n=this.md5_ii(n,o,s,i,t[r+9],21,-343485551),i=this.safe_add(i,a),n=this.safe_add(n,h),o=this.safe_add(o,l),s=this.safe_add(s,p)}return[i,n,o,s]},t.md5_cmn=function(t,e,i,n,o,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,s)),o),i)},t.md5_ff=function(t,e,i,n,o,s,r){return this.md5_cmn(e&i|~e&n,t,e,o,s,r)},t.md5_gg=function(t,e,i,n,o,s,r){return this.md5_cmn(e&n|i&~n,t,e,o,s,r)},t.md5_hh=function(t,e,i,n,o,s,r){return this.md5_cmn(e^i^n,t,e,o,s,r)},t.md5_ii=function(t,e,i,n,o,s,r){return this.md5_cmn(i^(e|~n),t,e,o,s,r)},t.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.bit_rol=function(t,e){return t<<e|t>>>32-e},t.hexcase=0,t.b64pad="",t}();__reflect(md5.prototype,"md5");var PointUtils=function(){function t(){}return t.getExtendPoint2=function(t,e,i,n,o,s){void 0===s&&(s=!0);var r=t-i,a=e-n,h=Math.sqrt(r*r+a*a),l=new egret.Point;return s?(l.x=i+(i-t)/h*o,l.y=n+(n-e)/h*o):(o>h&&(o=h),l.x=i-(i-t)/h*o,l.y=n-(n-e)/h*o),l},t}();__reflect(PointUtils.prototype,"PointUtils");var RegExpUtil=function(){function t(){}return t.LINE_BREAK=/\r+/g,t.BLANK_REG=/[\s\\]/g,t.ARGB_COLOR=/[a-fA-F0-9]{8}/,t.HTML=/<[^>]+>/g,t.DELETE_SPACE=/\s/g,t.DOT_NUMBER=/\.\d+/,t.NumericExp=/^\d+$/,t.NonNumericExp=/\D/,t.ActorNameExp=/^([\u4e00-\u9fa5]?\w?[^>|!@#$%&*\^\?]){1,48}$/,t}();__reflect(RegExpUtil.prototype,"RegExpUtil");var ResourceUtils=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e.cfg_list={},e.cfg_loaded_num=0,e.error_times={},e._configs=new Array,e._groups={},e._urlResorce={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,i,n){this._groups[t]=[e,i,n],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,i,n,o){RES.createGroup(t,e,!0),this.loadGroup(t,i,n,o)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var i="pilferer_"+t;e||(e=[t]),RES.createGroup(i,e,!0),RES.loadGroup(i,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],n=this._groups[e][2];null!=i&&i.call(n),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],n=this._groups[e][2];if(null!=i){var o=t.resItem.name;-1==o.indexOf("config1_zz")||-1==o.indexOf("_zip")||this.cfg_list[o]||(this.cfg_list[o]=!0,this.cfg_loaded_num+=1),i.call(n,t.itemsLoaded,t.itemsTotal,t)}}},e.prototype.onResourceLoadError=function(t){var e=this.error_times[t.groupName]||0;if(e>3)if(DeviceUtils.IsWx||DeviceUtils.IsQQ)platform.showModalWx("当前网络状态不佳，是否重试? loadGroup event.groupName = "+t.groupName,!1,function(){},function(){RES.loadGroup(t.groupName)});else{var i=confirm("当前网络状态不佳，是否重试?");1==i&&RES.loadGroup(t.groupName)}else null==this.error_times[t.groupName]?this.error_times[t.groupName]=0:this.error_times[t.groupName]+=1,RES.loadGroup(t.groupName);CommonUtils.log(t.groupName+"资源组有资源加载失败")},e.prototype.loadResource=function(t,e,i,n,o){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null);var s=t.concat(e),r="loadGroup"+this._groupIndex++;RES.createGroup(r,s,!0),this._groups[r]=[i,n,o],RES.loadGroup(r)},e.prototype.loadUrlResource=function(t,e,i,n){var o=this;null==this._urlResorce[t]?(this._urlResorce[t]={data:null,compFun:i,thisObj:n},RES.getResByUrl(t,function(e){o._urlResorce[t].data=e,null!=i&&i.apply(o._urlResorce[t].thisObj)},this,e)):null!=i&&i.apply(n)},e.prototype.getUrlResource=function(t){return null==this._urlResorce[t]?(CommonUtils.log("资源未加载"),null):this._urlResorce[t].data},e}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils");var StageUtils=function(t){function e(){var i=t.call(this)||this;return null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.touchEnabled=!1,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,i.getStage().addChild(e._uiStage)),i}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.prototype.setFullSize=function(t){var e=this.getWidth();if(e>480){var i=(e-480)/2;t.left=-i,t.right=-i}},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var StringUtils=function(){function t(){}return t.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},t.getStringLength=function(t){for(var e=t.split(""),i=0,n=0;n<e.length;n++){var o=e[n];i+=this.isChinese(o)?2:1}return i},t.isChinese=function(t){var e=/^[\u4E00-\u9FA5]+$/;return e.test(t)?!1:!0},t.strByteLen=function(t){for(var e=0,i=t.length,n=0;i>n;n++)e+=t.charCodeAt(n)>=127?2:1;return e},t.complementByChar=function(e,i,n,o){void 0===n&&(n=" "),void 0===o&&(o=!0);var s=this.strByteLen(o?e.replace(t.HTML,""):e);return e+this.repeatStr(n,i-s)},t.repeatStr=function(t,e){for(var i="",n=0;e>n;n++)i+=t;return i},t.addColor=function(t,e){var i;return"string"==typeof e?i=String(e):"number"==typeof e&&(i=Number(e).toString(10)),'<font color="'+i+'">'+t+"</font>"},t.addColor1=function(t,e){var i=new Object;return i.style=new Object,i.text=t,i.textColor=Number(e).toString(16),i},t.addBold=function(t){return"<b>"+t+"<\b>"},t.addUnderLine=function(t){return""+t},t.HTML=/<[^>]+>/g,t}();__reflect(StringUtils.prototype,"StringUtils");var TextFlowMaker=function(){function t(){}return t.generateTextFlow=function(t){for(var e=t.split("|"),i="",n=0,o=e.length;o>n;n++)i+=this.getSingleTextFlow1(e[n]);return(new egret.HtmlTextParser).parser(i)},t.generateTextFlow1=function(t){for(var e=t.split("|"),i=[],n=0,o=e.length;o>n;n++)i.push(this.getSingleTextFlow(e[n]));return i},t.generateTextFlow2=function(t){for(var e=new Array,i=t.split("|"),n=0,o=i.length;o>n;n++)e.push(this.getSingleTextFlow(i[n]));return e},t.getSingleTextFlow1=function(t){for(var e,i,n="<font",o=t.split("&"),s=!1,r=0,a=o.length;a>r;r++)if(e=o[r].split(":"),e[0]==this.PROP_TEXT)i=e[1];else if(e[0]==this.STYLE_SIZE)n+=' size="'+parseInt(e[1])+'"';else if(e[0]==this.STYLE_COLOR){var h=GlobalConfig.getColorConfig(parseInt(e[1]));n+=null!=h?' color="'+parseInt(h.c)+'"':' color="'+parseInt(e[1])+'"'}else e[0]==this.STYLE_UNDERLINE?s=!0:i=o[r];return n+=s?"><u>"+i+"</u></font>":">"+i+"</font>"},t.getSingleTextFlow=function(t){for(var e,i=t.split("&"),n={style:{}},o=0,s=i.length;s>o;o++)if(e=i[o].split(":"),e[0]==this.PROP_TEXT)n.text=e[1];else if(e[0]==this.STYLE_SIZE)n.style.size=parseInt(e[1]);else if(e[0]==this.STYLE_COLOR){var r=GlobalConfig.getColorConfig(parseInt(e[1]));n.style.textColor=r.c}else e[0]==this.STYLE_UNDERLINE?(n.style.underline=!0,n.style.href="event:"+e[1]):n.text=e[0];return n},t.STYLE_COLOR="C",t.STYLE_SIZE="S",t.PROP_TEXT="T",t.STYLE_UNDERLINE="U",t}();__reflect(TextFlowMaker.prototype,"TextFlowMaker");var uint64=function(){function t(t){this._lowUint=0,this._highUint=0,this.value=t}return t.prototype.isEqual=function(t){return t?this._lowUint==t._lowUint&&this._highUint==t._highUint:!1},t.prototype.isGreaterThan=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},t.prototype.isGreaterThanOrEqual=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>=e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},Object.defineProperty(t.prototype,"isZero",{get:function(){return 0==this._lowUint&&0==this._highUint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGreaterThanZero",{get:function(){return this._lowUint>0||this._highUint>0},enumerable:!0,configurable:!0}),t.prototype.writeByte=function(t){t.writeUnsignedInt(this._lowUint),t.writeUnsignedInt(this._highUint)},t.prototype.setValue=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._lowUint=t,this._highUint=e},Object.defineProperty(t.prototype,"value",{set:function(e){e instanceof egret.ByteArray?(this._lowUint=e.readUnsignedInt(),this._highUint=e.readUnsignedInt()):"string"==typeof e&&t.stringToUint64(e,10,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueByString",{set:function(t){},enumerable:!0,configurable:!0}),t.prototype.leftMove=function(e,i){void 0===i&&(i=null),i=i||this;var n=t.LeftMoveMask[e],o=n&this._lowUint;o>>>=32-e,i._lowUint=this._lowUint<<e,i._highUint=this._highUint<<e,i._highUint=i._highUint|o},t.prototype.add=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint+e._lowUint;i._highUint=this._highUint+e._highUint,n>=t.MaxLowUint?(i._highUint++,i._lowUint=n-t.MaxLowUint):i._lowUint=n},t.prototype.subtraction=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint-e._lowUint;i._highUint=this._highUint-e._highUint,0>n?(i._highUint--,i._lowUint=n+t.MaxLowUint):i._lowUint=n},t.prototype.scale=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint*e;i._highUint=this._highUint*e,i._highUint+=Math.floor(Math.abs(n/t.MaxLowUint)),i._lowUint=n%t.MaxLowUint},t.prototype.toString=function(e){void 0===e&&(e=10);for(var i,n,o,s="",r=this._lowUint,a=this._highUint;0!=a||0!=r;)i=a%e,o=i*t.MaxLowUint+r,n=o%e,s=n+s,a=(a-i)/e,r=(o-n)/e;return s.length?s:"0"},t.stringToUint64=function(e,i,n){void 0===i&&(i=10),void 0===n&&(n=null),n=n||new t;for(var o,s,r=0,a=0,h=e.length,l=0;h>l;l++)s=parseInt(e.charAt(l)),o=r*i+s,a=a*i+Math.floor(o/t.MaxLowUint),r=o%t.MaxLowUint;return n.setValue(r,a),n},t.LeftMoveMask=[0,2147483648,1073741824,536870912,268435456,134217728,67108864,33554432,16777216,8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],t.MaxLowUint=4294967296,t}();__reflect(uint64.prototype,"uint64");var MapGridNode=function(){function t(){this.handle=0}return Object.defineProperty(t.prototype,"hidden",{get:function(){return(2&this.flags)>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"walkable",{get:function(){return(1&this.flags)>0},enumerable:!0,configurable:!0}),t.FLAG_WALKABLE=32768,t.FLAG_HIDDEN=16384,t}();__reflect(MapGridNode.prototype,"MapGridNode");var enPropEntity;!function(t){t[t.PROP_ENTITY_ID=0]="PROP_ENTITY_ID",t[t.PROP_ENTITY_POSX=1]="PROP_ENTITY_POSX",t[t.PROP_ENTITY_POSY=2]="PROP_ENTITY_POSY",t[t.PROP_ENTITY_MODELID=3]="PROP_ENTITY_MODELID",t[t.PROP_ICON=4]="PROP_ICON",t[t.PROP_DIR=5]="PROP_DIR",t[t.PROP_MAX_ENTITY=6]="PROP_MAX_ENTITY"}(enPropEntity||(enPropEntity={}));var enPropCreature;!function(t){t[t.PROP_LEVEL=6]="PROP_LEVEL",t[t.PROP_HP=7]="PROP_HP",t[t.PROP_MP=8]="PROP_MP",t[t.PROP_MOVETIME=9]="PROP_MOVETIME",t[t.PROP_MAXHP=10]="PROP_MAXHP",t[t.PROP_MAXMP=11]="PROP_MAXMP",t[t.PROP_CREATURE_OUT_ATTACK=12]="PROP_CREATURE_OUT_ATTACK",t[t.PROP_CREATURE_OUT_DEFENCE=13]="PROP_CREATURE_OUT_DEFENCE",t[t.PROP_CREATURE_DEFCRITICALSTRIKES=14]="PROP_CREATURE_DEFCRITICALSTRIKES",t[t.PROP_CREATURE_ALL_ATTACK=15]="PROP_CREATURE_ALL_ATTACK",t[t.PROP_CREATURE_SUB_DEF=16]="PROP_CREATURE_SUB_DEF",t[t.PROP_CREATURE_INNER_ATTACK=17]="PROP_CREATURE_INNER_ATTACK",t[t.PROP_CREATURE_INNER_DEFENCE=18]="PROP_CREATURE_INNER_DEFENCE",t[t.PROP_CREATURE_CRITICALSTRIKES=19]="PROP_CREATURE_CRITICALSTRIKES",t[t.PROP_CREATURE_DODGERATE_VALUE=20]="PROP_CREATURE_DODGERATE_VALUE",t[t.PROP_CREATURE_HITRATE_VALUE=21]="PROP_CREATURE_HITRATE_VALUE",t[t.PROP_CREATURE_ATTACK_APPEND=22]="PROP_CREATURE_ATTACK_APPEND",t[t.PROP_HP_RENEW=23]="PROP_HP_RENEW",t[t.PROP_MP_RENEW=24]="PROP_MP_RENEW",t[t.PROP_ATTACK_SPEED=25]="PROP_ATTACK_SPEED",t[t.PROP_IN_ATTACK_DAMAGE_ADD=26]="PROP_IN_ATTACK_DAMAGE_ADD",t[t.PROP_OUT_ATTACK_DAMAGE_ADD=27]="PROP_OUT_ATTACK_DAMAGE_ADD",t[t.PROP_CREATURE_STATE=28]="PROP_CREATURE_STATE",t[t.PROP_BASE_MAXHP=29]="PROP_BASE_MAXHP",t[t.PROP_BASE_MAXMP=30]="PROP_BASE_MAXMP",t[t.PROP_STAND_POINT=31]="PROP_STAND_POINT",t[t.PROP_CAMP=32]="PROP_CAMP",t[t.PROP_RESEVS1=33]="PROP_RESEVS1",t[t.PROP_MAX_CREATURE=34]="PROP_MAX_CREATURE"}(enPropCreature||(enPropCreature={}));var enPropMonster;!function(t){t[t.PROP_MONSTER_START=34]="PROP_MONSTER_START",t[t.PROP_MONSTER_BORNPOINT=34]="PROP_MONSTER_BORNPOINT",t[t.PROP_MONSTER_LEVEL_DIFF=35]="PROP_MONSTER_LEVEL_DIFF",t[t.PROP_PET_TITLE=36]="PROP_PET_TITLE",t[t.PROP_PET_COLOR=37]="PROP_PET_COLOR",t[t.PROP_PET_SHOW_TITLE=38]="PROP_PET_SHOW_TITLE",t[t.PROP_MAX_MONSTER=39]="PROP_MAX_MONSTER"}(enPropMonster||(enPropMonster={}));var enPropActor;!function(t){t[t.PROP_WEAPONMODEL=34]="PROP_WEAPONMODEL",t[t.PROP_MOUNT=35]="PROP_MOUNT",t[t.PROP_DIZZY_RATE11=36]="PROP_DIZZY_RATE11",t[t.PROP_DIZZY_TIME1=37]="PROP_DIZZY_TIME1",t[t.PROP_HP_STORE=38]="PROP_HP_STORE",t[t.PROP_MP_STORE=39]="PROP_MP_STORE",t[t.PROP_SPIRIT=40]="PROP_SPIRIT",t[t.PROP_ACTOR_PK_MOD=41]="PROP_ACTOR_PK_MOD",t[t.PROP_STONE_EFFECT=42]="PROP_STONE_EFFECT",t[t.PROP_WING_EFFECT=43]="PROP_WING_EFFECT",t[t.PROP_STAGE_EFFECT=44]="PROP_STAGE_EFFECT",t[t.PROP_SERVER_ID=45]="PROP_SERVER_ID",t[t.PROP_SMALL_TEAM_ID=46]="PROP_SMALL_TEAM_ID",t[t.PROP_SEX=47]="PROP_SEX",t[t.PROP_VOCATION=48]="PROP_VOCATION",t[t.PROP_ACTOR_EXP=49]="PROP_ACTOR_EXP",t[t.PROP_ACTOR_PK_VALUE=51]="PROP_ACTOR_PK_VALUE",t[t.PROP_ACTOR_BAG_GRID_COUNT=52]="PROP_ACTOR_BAG_GRID_COUNT",t[t.PROP_WEEK_CHARM=53]="PROP_WEEK_CHARM",t[t.PROP_ACTOR_BIND_COIN=54]="PROP_ACTOR_BIND_COIN",t[t.PROP_ACTOR_NONBIND_COIN=55]="PROP_ACTOR_NONBIND_COIN",t[t.PROP_ACTOR_BIND_YUANBAO=56]="PROP_ACTOR_BIND_YUANBAO",t[t.PROP_ACTOR_NONBIND_YUANBAO=57]="PROP_ACTOR_NONBIND_YUANBAO",t[t.PROP_ACTOR_SHENGWANG=58]="PROP_ACTOR_SHENGWANG",t[t.PROP_ACTOR_CHARM=59]="PROP_ACTOR_CHARM",t[t.PROP_SMALL_TEAM_LEFT_TIIME=60]="PROP_SMALL_TEAM_LEFT_TIIME",t[t.PROP_ACTOR_RENOWN=61]="PROP_ACTOR_RENOWN",t[t.PROP_GUILD_ID=62]="PROP_GUILD_ID",t[t.PROP_TEAM_ID=63]="PROP_TEAM_ID",t[t.PROP_ACTOR_SOCIALMASK=64]="PROP_ACTOR_SOCIALMASK",t[t.PROP_GUILD_EXP=65]="PROP_GUILD_EXP",t[t.PROP_ACTOR_WEEK_ZYCOUNT=66]="PROP_ACTOR_WEEK_ZYCOUNT",t[t.PROP_SYSTEM_OPEN=67]="PROP_SYSTEM_OPEN",t[t.PROP_ROOT_EXP_POWER=69]="PROP_ROOT_EXP_POWER",t[t.PROP_CHANGE_MODEL=70]="PROP_CHANGE_MODEL",t[t.PROP_JUMP_HP=71]="PROP_JUMP_HP",t[t.PROP_ACTOR_MAX_EXP=72]="PROP_ACTOR_MAX_EXP",t[t.PROP_ACTOR_GIVE_YUANBAO=74]="PROP_ACTOR_GIVE_YUANBAO",t[t.PROP_CRITICAL_STRIKE=75]="PROP_CRITICAL_STRIKE",t[t.PROP_ACTOR_EXP_RATE=76]="PROP_ACTOR_EXP_RATE",t[t.PROP_ACTOR_DEPOT_GRID_COUNT=77]="PROP_ACTOR_DEPOT_GRID_COUNT",t[t.PROP_ACTOR_ANGER=78]="PROP_ACTOR_ANGER",t[t.PROP_ROOT_EXP=79]="PROP_ROOT_EXP",t[t.PROP_ACTOR_ACHIEVEPOINT=80]="PROP_ACTOR_ACHIEVEPOINT",t[t.PROP_ACTOR_ZYCOUNT=81]="PROP_ACTOR_ZYCOUNT",t[t.PROP_QQ_VIP=82]="PROP_QQ_VIP",t[t.PROP_WING_ID=83]="PROP_WING_ID",t[t.PROP_WING_SCORE=84]="PROP_WING_SCORE",t[t.PROP_PET_SCORE=85]="PROP_PET_SCORE",t[t.PROP_VIP_FLAG=86]="PROP_VIP_FLAG",t[t.PROP_MOUNT_SCORE=87]="PROP_MOUNT_SCORE",t[t.PROP_SMALL_TEAM_TOTEM=88]="PROP_SMALL_TEAM_TOTEM",t[t.PROP_HONOR=89]="PROP_HONOR",t[t.PROP_CAMP_TITLE=90]="PROP_CAMP_TITLE",t[t.PROP_CAMP_RUNAWAY=91]="PROP_CAMP_RUNAWAY",t[t.PROP_GUILD_TOTAL_EXP=92]="PROP_GUILD_TOTAL_EXP",t[t.PROP_FIGHT_VALUE=93]="PROP_FIGHT_VALUE",t[t.PROP_DEITY_ORDER=94]="PROP_DEITY_ORDER",t[t.PROP_RECHARGE=95]="PROP_RECHARGE",t[t.PROP_VIP_LEVEL=96]="PROP_VIP_LEVEL",t[t.PROP_SHIELD=97]="PROP_SHIELD",t[t.PROP_FOOT_EFFECT=98]="PROP_FOOT_EFFECT",t[t.PROP_EQUIP_SCORE=99]="PROP_EQUIP_SCORE",t[t.PROP_HAIR_MODEL=100]="PROP_HAIR_MODEL",t[t.PROP_BUBBLE=101]="PROP_BUBBLE",t[t.PROP_ACTOR_STATE=102]="PROP_ACTOR_STATE",t[t.PROP_ZHAN_LING=103]="PROP_ZHAN_LING",t[t.PROP_PSYCHE=104]="PROP_PSYCHE",t[t.PROP_SC_SCORE=105]="PROP_SC_SCORE",t[t.PROP_XJ_LEVEL=106]="PROP_XJ_LEVEL",t[t.PROP_ADD_EXP=107]="PROP_ADD_EXP",t[t.PROP_MAX_ACTOR=108]="PROP_MAX_ACTOR"
}(enPropActor||(enPropActor={}));var BaseSpriteView=function(t){function e(e){var i=t.call(this)||this;return i._resources=null,i._myParent=e,i._isInit=!1,StageUtils.ins().getStage().addEventListener(egret.Event.RESIZE,i.onResize,i),i}return __extends(e,t),e.prototype.setResources=function(t){this._resources=t},Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.isInit=function(){return this._isInit},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this._myParent.addChild(this)},e.prototype.removeFromParent=function(){DisplayUtils.removeFromParent(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.destroy=function(){this._myParent=null,this._resources=null},e.prototype.onResize=function(){},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?ResourceUtils.ins().loadResource(this._resources,[],function(){t(),e()},null,this):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e.prototype.openCheck=function(){return!0},e}(egret.DisplayObjectContainer);__reflect(BaseSpriteView.prototype,"BaseSpriteView",["IBaseView"]);var DebugPlatform=function(){function t(){}return t.prototype.keepScreeOnFac=function(t){},t.prototype.isUserGeted=function(t,e){},t.prototype.getWxSdk=function(t){},t.prototype.getWxSdkData=function(){},t.prototype.getWxSdkInitData=function(){},t.prototype.isSdkInitFinish=function(){},t.prototype.doPoint=function(t){},t.prototype.qqPay=function(t,e){},t.prototype.showModalWx=function(t,e,i,n){},t.prototype.QQShareAppMessage=function(t){},t.prototype.QQcheckNewUpdate=function(){},t.prototype.SwitchWxPay=function(t){},t.prototype.updateRole=function(t){},t.prototype.checkScreenchar=function(t){},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var AssetMgr=function(){function t(){}return t.getRoleBodySource=function(t,e,i,n,o){return RES_DIR_BODY+t+"_"+this.getAction(n,o)+this.getResourceDir(i)},t.getStrengthenSource=function(t){return 7>t?t=0:9>t?t=7:11>t?t=9:13>t&&(t=11),t},t.getAction=function(t,e){var i=t;return i==EntityAction.RUN||(i==EntityAction.STAND?e&&(i=EntityAction.STAND):i=t),i},t.getMonsterSource=function(t,e,i,n){return n?RES_DIR_MONSTER+t+"_"+i+this.getResourceDir(e):RES_DIR_MONSTER+t},t.getNpcSource=function(t,e,i){return RES_DIR_NPC+t+"_"+this.getResourceDir(e)+i},t.getPartnerBodySource=function(t,e,i){return RES_DIR_PARTNER+t+"_"+i+this.getResourceDir(e)},t.getPetBodySource=function(t,e,i){return RES_DIR_PET+t+"_"+i+this.getResourceDir(e)},t.getPetIconSource=function(t){return""},t.getResourceDir=function(t){var e=2*(t-4);return 0>e&&(e=0),t-e},t.getWingResource=function(t,e,i){return RES_DIR_WING+t+"_s"+this.getResourceDir(e)},t.getMountResource=function(t,e,i,n,o,s){return void 0===s&&(s=!1),n==EntityAction.ATTACK?RES_DIR_MOUNT+t+"_s"+this.getResourceDir(i):RES_DIR_MOUNT+t+"_"+this.getAction(n,o)+this.getResourceDir(i)},t.getWeaponResource=function(t,e,i,n,o){return RES_DIR_WEAPON+t+"_"+this.getAction(n,o)+this.getResourceDir(i)},t.getOtherResource=function(t,e,i){return RES_DIR_OTHER+t+"_"+this.getAction(i,!1)+this.getResourceDir(e)},t.getSkillResourceName=function(t){GlobalConfig.getSkillConfig(t);return""},t.getSkillResourceItemName=function(t){return RES_DIR_SKILL+""+t.skillId+(t.isActivate()?"":"_a")+".png"},t.getAtkedResource=function(t){return RES_DIR_SKILLEFF},t.getLevelUpResource=function(){return UI_EFF_DIR+"10029"},t.getTaskOkResource=function(){return RES_DIR_EFF+"rwtx"},t.getTaskNOResource=function(){return RES_DIR_EFF+"rwjx"},t.getMapPointResource=function(){return RES_DIR_EFF+"xzhj"},t.getqhbyResource=function(){return RES_DIR_EFF+"qhby"},t.getqhcgResource=function(){return RES_DIR_EFF+"qhcg"},t.getqhsbResource=function(){return RES_DIR_EFF+"qhsb"},t.getzjcgResource=function(){return RES_DIR_EFF+"zjcg"},t.getzjsbResource=function(){return RES_DIR_EFF+"zjsb"},t.getxhdjResource=function(){return RES_DIR_EFF+"xhdj"},t.getxhsjResource=function(){return RES_DIR_EFF+"xhsj"},t.getElementIconRes=function(t){return RES_DIR_ELEMENT+t+".png"},t.getDamagerWordResource=function(t){var e;switch(t){case DamageType.HUIXIN:e="font_huixin";break;case DamageType.BAOJI:case DamageType.SPE_BAOJI:e="font_baoji";break;case DamageType.XL:e="font_xianlv";break;case DamageType.QIANGJI:e="font_qiangji";break;case DamageType.QJHX:e="font_baojihuixin";break;case DamageType.MISS:e="font_shanbi";break;case DamageType.GEDAN:e="font_gedang";break;case DamageType.INNER:e="font_neigong";break;case DamageType.SHUCHU:e="font_shuchu";break;case DamageType.ZHONGJI:e="font_zhongji";break;case DamageType.LIANJI:e="font_lianji";break;case DamageType.BISHA:e="font_bisha";break;default:e="qq"}return e},t.getDamageResource=function(t,e){var i;if(e)switch(t){case DamageType.SUCH:case DamageType.PETSHUCHU:i="font_huifu_";break;default:i="font_diaoxie_"}else switch(t){case DamageType.SUCH:case DamageType.PETSHUCHU:i="font_huifu_";break;case DamageType.HUIXIN:i="font_huixin_";break;case DamageType.INNER:i="font_neigong_";break;case DamageType.LIANJI:i="font_lianji_";break;case DamageType.NORMAL:i="font_shanghai_";break;case DamageType.QIANGJI:i="font_qiangji_";break;case DamageType.QJHX:i="font_qiangji_";break;case DamageType.SHUCHU:i="font_shuchu_";break;case DamageType.SUCH:i="font_huifu_";break;case DamageType.BAOJI:case DamageType.SPE_BAOJI:i="font_baaoji_";break;case DamageType.XL:i="font_xianlv_";break;case DamageType.BISHA:i="font_bisha_";break;default:i="font_shanghai_"}return i},t.getItemqualityResource=function(t){return"tips_MU_iconcolor"+(t+1)},t.getActiveResource=function(t){return 0==t?"task_MU_json.task_mu_chest1":1==t?"task_MU_json.task_mu_chest2":"task_MU_json.task_mu_chest1"},t.getAttrLineResource=function(){return"public_json.public_MU_separation"},t.getAttrPointResource=function(){return"Tips_MU_json.tips_MU_point"},t.getGreenArrowResource=function(){return"public_json.public_MU_greenarrow"},t.getRedArrowResource=function(){return"public_json.public_MU_redarrow"},t.getStarPoint0Resource=function(){return"starsoul_json.starsoul_mu_point0"},t.getStarPoint1Resource=function(){return"starsoul_json.starsoul_mu_point1"},t.getStarPoint2Resource=function(){return"starsoul_json.starsoul_mu_point2"},t.getMapTitleResource=function(t){return"map_MU_name"+t},t.getMapIconResource=function(t,e){return"map_MU_icon"+t+(e?"b":"a")},t.getMapListBgResource0=function(){return"map_MU_smallbg0"},t.getMapListBgResource1=function(){return"map_MU_smallbg1"},t.getMapListBgResource2=function(){return"map_MU_smallbg2"},t.getIconResource=function(t){return UI_ICON_DIR+t+".png"},t.getIconQualityResource=function(t){return"commonAtlas_json.common_Box_0"+t},t.jobIcon=["","equip_json.equip_MU_head1","equip_json.equip_MU_head2","equip_json.equip_MU_head3"],t.jobImgBG=["","public_MU_flag1","public_MU_flag2","public_MU_flag3"],t}();__reflect(AssetMgr.prototype,"AssetMgr");var FlyNumber=function(t){function e(){var e=t.call(this)||this;return e.bmpWord=new egret.Bitmap,e.addChild(e.bmpWord),e.bmpNumber=new BmpNumber,e.addChild(e.bmpNumber),e}return __extends(e,t),e.prototype.setNumber=function(t,e,i){var n=AssetMgr.getDamagerWordResource(e);n&&!i&&(this.bmpWord.texture=RES.getRes(n)),this.bmpNumber.setNumber(t,AssetMgr.getDamageResource(e,i)),this.updatePos()},e.prototype.updatePos=function(){var t=this.bmpWord.texture?this.bmpWord.texture.$bitmapWidth:0,e=this.bmpWord.texture?this.bmpWord.texture.$bitmapHeight:0,i=t+this.bmpNumber.width,n=(Math.max(this.bmpNumber.height,this.bmpWord.texture?this.bmpWord.texture.$bitmapHeight:0),-i/2);this.bmpWord.x=n,this.bmpWord.y=-e/2,this.bmpNumber.x=this.bmpWord.x+t,this.bmpNumber.y=-this.bmpNumber.height/2},e.prototype.setWordSource=function(t){var e=AssetMgr.getDamagerWordResource(t);e&&(this.bmpWord.texture=RES.getRes(e)),this.updatePos()},e.prototype.reset=function(){this.alpha=1,this.bmpWord.texture=null,this.bmpNumber.reset(),DisplayUtils.removeFromParent(this)},e}(egret.DisplayObjectContainer);__reflect(FlyNumber.prototype,"FlyNumber");var GlobalFunc=function(){function t(){}return t.prototype.isInCity=function(){return GameMap.ins().fbId==GameConst.FB_ID_MAIN_CITY},t.GetLvStrByLv=function(t,e){void 0===e&&(e=!1);var i="";return i},t.getZSBackLv=function(){var t=Actor.level;return t},t.checkFbCondition=function(t){return!0},t.getZhuanLevelLstr=function(t,e){if(e>0){var i=GlobalConfig.getZhuanById(e);return i.zhuan+"转"+i.lv+"重"}return t+"级"},t.getZhuanStr=function(t){if(t>0){var e=GlobalConfig.getZhuanById(t);return e.zhuan+"转"}},t.getCountStr=function(t){return 1e5>t?t.toString():Math.floor(t/1e4)+"万"},t.getTimeHMSString=function(t){return 0>=t?"00:00:00":UtilProxy.getStr("@0 :@1 :@2 ",[Math.floor(t/3600),Math.floor(t/60%60),t%60])},t}();__reflect(GlobalFunc.prototype,"GlobalFunc");var PackageID;!function(t){t.Skill=2,t.Bag=3,t.Equip=4,t.Mail=8,t.JingMai=12,t.Vip=19,t.Notice=20,t.Activity=25,t.Recharge=27,t.Chat=59,t.WingNew=50,t.Starsoul=51,t.equipNew=52,t.Fuben=53,t.AttrAdd=55,t.JingLing=57,t.Task=58,t.Friends=47,t.TuJian=54,t.Ranking=18}(PackageID||(PackageID={}));var Server=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.send=function(t,e,i){void 0===i&&(i=-1);var n=GameSocket.ins().getBytes();n.writeCmd(t,e),-1!=i&&n.writeInt(i),GameSocket.ins().sendToServer(n)},e.gms=function(t){GameLogic.ins().sendGMCommad(t)},e.test=function(){},e.addMonster=function(t){var e=GameLogic.ins().createEntityByType(EntityTypes.MonsterClientMU);e.setConfig(GlobalConfig.getMonsterConfigById(t)),e.x=GameMap.centerEntity.x+100,e.y=GameMap.centerEntity.y,GameLogic.ins().addEntity(e)},e.stopAI=function(){for(var t=GameLogic.ins().getEntityList(),e=0,i=t;e<i.length;e++){var n=i[e];n.stopAI()}},e.atkMonster=function(t){},e.atkPlayer=function(t){},e.item=function(t,e){void 0===e&&(e=100),GameLogic.ins().sendGMCommad("@additem "+t+" "+e)},e.map=function(){e.openMap?GameMap.ins().clearDrawGrid():GameMap.ins().drawGrid(),e.openMap=!e.openMap},e.openMap=!1,e}(BaseSystem);__reflect(Server.prototype,"Server");var gms=Server.gms,item=Server.item,map=Server.map,AttributeData=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.type=t,this.value=e}return t.AttrAddition=function(e,i){for(var n=[],o=0;o<e.length;o++){var s=new t;s.type=e[o].type,s.value=e[o].value+i[o].value,n.push(s)}return n},t.transformAttr=function(e){var i=[];for(var n in e){var o=new t;o.type=e[n].type,o.value=e[n].value,i.push(o)}for(var s=0;s<i.length-1;s++)for(var r=0;r<i.length-s-1;r++)if(i[r]<i[r+1]){var a=i[r+1];i[r+1]=i[r],i[r]=a}return i},t.getAttStr=function(e,i,n,o,s,r){void 0===i&&(i=4),void 0===n&&(n=1),void 0===o&&(o="+"),void 0===s&&(s=!1),void 0===r&&(r=!0);var a="";if(e instanceof t)return this.getAttStrByType(e,i,o,s,r);if(!(e instanceof Array)){var h=[];for(var l in this.translate)if(!isNaN(e[l])){var p=new t;p.type=parseInt(this.translate[l]),p.value=e[l],h.push(p)}return this.getAttStr(h,i,n,o,s)}for(var c=e,u=0;u<c.length;u++)if(a+=this.getAttStrByType(c[u],i,o,s,r),u<c.length-1)for(var d=0;n>d;d++)a+="\n";return a},t.getAttStr1=function(t,e){for(var i="",n=0;n<t.length;n++)i+=this.getAttStrByType1(t[n],e),n<t.length-1&&(i+=StringUtils.repeatStr("\n",e.emptyLine+1));return i},t.getAttStr2=function(e,i){var n="",o=new t;for(var s in e)o.type=parseInt(s),o.value=e[o.type],n+=this.getAttStrByType1(o,i),n+=StringUtils.repeatStr("\n",i.emptyLine+1);return n},t.getAttStrByType1=function(t,e){var i=e.attrStr[t.type],n=(t.type,e.sign,""),o=t.value;switch(t.type){case AttributeType.atZYYJ:case AttributeType.atHXYJ:case AttributeType.atZMYJ:case AttributeType.atWSYJ:case AttributeType.atHpPer:case AttributeType.atAtkPer:case AttributeType.atDefPer:case AttributeType.atAtkSucPer:case AttributeType.atDefSucPer:case AttributeType.atDamagePer:case AttributeType.atReductionPer:case AttributeType.atReflex:case AttributeType.atDropPer:o=Math.floor(o/100);break;case AttributeType.atMonRecoverPer:case AttributeType.atAtkLvl:case AttributeType.atDefLvl:o=Math.floor(1e4/o)}n=o.toString();var s=StringUtils.addColor(i.replace("{$value$}",n).replace("{$type$}",e.typeName),e.wordColor),r=s+e.backSign;return r},t.getAttStrByType=function(e,i,n,o,s){void 0===i&&(i=4),void 0===n&&(n="+"),void 0===o&&(o=!1),void 0===s&&(s=!0);var r="";return s&&(r=StringUtils.complementByChar(t.getAttrStrByType1(e.type),8*i)),r+=n+e.value},t.inserteBlank=function(t,e,i){void 0===i&&(i=1);for(var n=t.length,o="";e--;)o+=" ";var s="";switch(i){case 0:s=o+t;break;case 1:s=t.slice(0,n/2)+o+t.slice(n/2);break;case 2:s=t+o}return s},t.getAttrStrByType1=function(t){var e=this.attrStr1[t];return e},t.getAttrStrByType2=function(t){var e=this.attrStr2[t];return e},t.getAttrStarAdd=function(e,i){var n=[];return e.forEach(function(e){var o=new t;o.type=e.type,o.value=e.value*i>>0,n.push(o)}),n},t.translate={},t.attrStr2=["当前血量 +{$value$}","生命 +{$value$}","最小攻击 +{$value$}","最大攻击 +{$value$}","防御力 +{$value$}","{$type$}(攻击成功率 +{$value$})","{$type$}(防御成功率 +{$value$})","{$type$}(移动速度 +{$value$})","{$type$}(攻击速度 +{$value$})","{$type$}(卓越一击 +{$value$}%)","幸运(会心一击 +{$value$}%)","{$type$}(致命一击 +{$value$}%)","{$type$}(无视一击 +{$value$}%)","{$type$}(力量 +{$value$})","{$type$}(敏捷 +{$value$})","{$type$}(体力 +{$value$})","{$type$}(智力 +{$value$})","{$type$}(生命加成 +{$value$}%)","{$type$}(攻击力 +{$value$}%)","{$type$}(防御力 +{$value$}%)","{$type$}(攻击成功率 +{$value$}%)","{$type$}(防御成功率 +{$value$}%)","{$type$}(伤害加成 +{$value$}%)","{$type$}(伤害减少 +{$value$}%)","{$type$}(伤害反射 +{$value$}%)","{$type$}(打怪金钱掉落 +{$value$}%)","{$type$}(附加伤害 +{$value$})","{$type$}(减少伤害 +{$value$})","{$type$}(击杀怪物恢复生命 +{$value$})","{$type$}(击杀怪物恢复生命 +1/{$value$})","{$type$}(攻击力 + 等级 / {$value$})","{$type$}(防御力 + 等级 / {$value$})","{$type$}(攻击力附加 +{$value$})"],t.attrStr1=["当前血量","生命","最小攻击","最大攻击","防御力","攻击成功率","防御成功率","移动速度","攻击速度","卓越一击","会心一击","致命一击","无视一击","力量","敏捷","体力","智力","生命加成","攻击力","防御力","攻击成功率","防御成功率","伤害加成","伤害减少","伤害反射","打怪金钱掉落","附加伤害","减少伤害","击杀怪物恢复","击杀怪物恢复","攻击力 + 等级 / 20","防御力 + 等级 / 20","攻击力附加"],t}();__reflect(AttributeData.prototype,"AttributeData");var AttributeFormat=function(){function t(){this.intervals=4,this.emptyLine=0,this.sign="+",this.backSign="",this.spaceCount=0,this.isShowAttName=1,this.wordColor=t.DEFAULT_COLOR,this.attrColor=t.DEFAULT_COLOR,this.typeName=""}return t.getFormat=function(e,i,n,o,s,r,a){void 0===e&&(e=4),void 0===i&&(i=0),void 0===n&&(n="+"),void 0===o&&(o=0),void 0===s&&(s=1),void 0===r&&(r=this.DEFAULT_COLOR),void 0===a&&(a=this.DEFAULT_COLOR);var h=new t;return h.intervals=e,h.emptyLine=i,h.sign=n,h.spaceCount=o,h.isShowAttName=s,h.wordColor=r,h.attrColor=a,h},t.FORMAT_1=function(){return this.getFormat(0,0,"：")},t.FORMAT_2=function(){var t=this.FORMAT_1();return t.attrColor=65280,t},t.FORMAT_3=function(){var t=this.FORMAT_1();return t.attrStr=AttributeData.attrStr2,t.backSign="\n",t.attrColor=11512480,t.wordColor=11512480,t},t.FORMAT_4=function(){var t=this.FORMAT_1();return t.backSign="\n",t.typeName="卓越",t.attrStr=AttributeData.attrStr2,t.attrColor=GameConst.ATTRIBUTE_COLOR[2],t.wordColor=GameConst.ATTRIBUTE_COLOR[2],t},t.FORMAT_5=function(){var t=this.FORMAT_1();return t.backSign="\n",t.attrStr=AttributeData.attrStr2,t.typeName="卓越",t.attrColor=2665145,t.wordColor=2665145,t},t.FORMAT_6=function(){var t=this.FORMAT_1();return t.backSign="\n",t.attrStr=AttributeData.attrStr2,t.typeName="史诗",t.attrColor=GameConst.ATTRIBUTE_COLOR[4],t.wordColor=GameConst.ATTRIBUTE_COLOR[4],t},t.FORMAT_7=function(){var t=this.FORMAT_1();return t.backSign="\n",t.attrStr=AttributeData.attrStr2,t.typeName="追加",t.attrColor=GameConst.ATTRIBUTE_COLOR[1],t.wordColor=GameConst.ATTRIBUTE_COLOR[1],t},t.FORMAT_8=function(){var t=this.FORMAT_1();return t.backSign="\n",t.attrStr=AttributeData.attrStr2,t.typeName="幸运",t.attrColor=GameConst.ATTRIBUTE_COLOR[3],t.wordColor=GameConst.ATTRIBUTE_COLOR[3],t},t.FORMAT_9=function(t){var e=this.FORMAT_1();return e.backSign="",e.typeName="精灵",e.attrStr=AttributeData.attrStr2,e.attrColor=GameConst.ATTRIBUTE_COLOR[2],e.wordColor=t,e},t.DEFAULT_COLOR=14668213,t}();__reflect(AttributeFormat.prototype,"AttributeFormat");var AttributeType;!function(t){t[t.atHp=0]="atHp",t[t.atHpMax=1]="atHpMax",t[t.atAtkMin=2]="atAtkMin",t[t.atAtkMax=3]="atAtkMax",t[t.atDef=4]="atDef",t[t.atAtkSuc=5]="atAtkSuc",t[t.atDefSuc=6]="atDefSuc",t[t.atMvSpeed=7]="atMvSpeed",t[t.atAtkSpeed=8]="atAtkSpeed",t[t.atZYYJ=9]="atZYYJ",t[t.atHXYJ=10]="atHXYJ",t[t.atZMYJ=11]="atZMYJ",t[t.atWSYJ=12]="atWSYJ",t[t.atPower=13]="atPower",t[t.atAgile=14]="atAgile",t[t.atStrength=15]="atStrength",t[t.atIntellect=16]="atIntellect",t[t.atHpPer=17]="atHpPer",t[t.atAtkPer=18]="atAtkPer",t[t.atDefPer=19]="atDefPer",t[t.atAtkSucPer=20]="atAtkSucPer",t[t.atDefSucPer=21]="atDefSucPer",t[t.atDamagePer=22]="atDamagePer",t[t.atReductionPer=23]="atReductionPer",t[t.atReflex=24]="atReflex",t[t.atDropPer=25]="atDropPer",t[t.atAtkExtra=26]="atAtkExtra",t[t.atReduceAtk=27]="atReduceAtk",t[t.atMonRecover=28]="atMonRecover",t[t.atMonRecoverPer=29]="atMonRecoverPer",t[t.atAtkLvl=30]="atAtkLvl",t[t.atDefLvl=31]="atDefLvl",t[t.Atk=32]="Atk",t[t.atCount=33]="atCount"}(AttributeType||(AttributeType={}));var EntityTypes;!function(t){t[t.ActorMU=0]="ActorMU",t[t.RoleMU=1]="RoleMU",t[t.MonsterMU=2]="MonsterMU",t[t.NPCMU=3]="NPCMU",t[t.CollectionMonsterMU=5]="CollectionMonsterMU",t[t.OtherMU=6]="OtherMU",t[t.MonsterClientMU=7]="MonsterClientMU",t[t.DropItemMU=10]="DropItemMU",t[t.PetMu=11]="PetMu",t[t.PartnerMu=12]="PartnerMu",t[t.ArenaPlayer=13]="ArenaPlayer",t[t.Player=14]="Player",t[t.BossPlayer=15]="BossPlayer",t[t.YezhanPlayer=16]="YezhanPlayer"}(EntityTypes||(EntityTypes={}));var EntityType=function(){function t(){}return t.getEntityType=function(t){return t instanceof EntityArena?EntityTypes.ArenaPlayer:t instanceof EntityYezhan?EntityTypes.YezhanPlayer:t instanceof EntityRole?EntityTypes.RoleMU:t instanceof EntityMonster?EntityTypes.MonsterMU:null},t}();__reflect(EntityType.prototype,"EntityType");var Star=function(t){function e(e,i,n){void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=10);var o=t.call(this)||this;return o.singleWidth=28,o.touchEnabled=!1,o.maxStar=n,o.curStar=i,o.setStarImageType(e),o.createStarImage(i,n),o}return __extends(e,t),e.prototype.setStarImageType=function(t){switch(t){case e.starType1:this.starImgName="tips_MU_star",this.staremptyImgName="tips_MU_starempty",this.height=27,this.singleWidth=28;break;case e.starType2:this.starImgName="public_json.public_MU_normalstar",this.staremptyImgName="public_json.public_MU_normalstarempty",this.height=41,this.singleWidth=43;break;case e.starType3:this.starImgName="task_mu_star",this.staremptyImgName="task_mu_star",this.height=26,this.singleWidth=28}},e.prototype.createStarImage=function(t,e){this.imgStar=DisplayUtils.createEuiImage(this,this.starImgName),this.imgStarempty=DisplayUtils.createEuiImage(this,this.staremptyImgName),this.imgStar.fillMode="repeat",this.imgStar.height=this.height,this.imgStar.width=t*this.singleWidth,this.imgStarempty.fillMode="repeat",this.imgStarempty.height=this.height,this.imgStarempty.width=e*this.singleWidth,this.addChild(this.imgStarempty),this.addChild(this.imgStar)},e.prototype.setCurStar=function(t){t<=this.maxStar&&(this.curStar=t,this.imgStar.width=this.curStar*this.singleWidth)},e.prototype.setMaxStar=function(t){this.maxStar=t,this.imgStarempty.width=this.maxStar*this.singleWidth},e.starType1=1,e.starType2=2,e.starType3=3,e}(egret.DisplayObjectContainer);__reflect(Star.prototype,"Star");var DropDown=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.touchEnabled=!0,this.currentState="up",this.addChangeEvent(this.list,this.listSelect),this.addTouchEvent(this,this.onTap),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this)},e.prototype.listSelect=function(t){this.value.text=this.list.selectedItem.name},e.prototype.removeStage=function(t){this.stage&&this.removeTouchEvent(this.stage,this.onTap)},e.prototype.onTap=function(t){this.currentState="up"==this.currentState?"down":"up",t.stopPropagation(),this.stage&&("down"==this.currentState?this.addTouchEvent(this.stage,this.onTap):this.removeTouchEvent(this.stage,this.onTap))},e.prototype.setData=function(t){this.list.dataProvider=t},e.prototype.setSelectedIndex=function(t){this.list.selectedIndex=t},e.prototype.getSelectedIndex=function(){return this.list.selectedIndex},e.prototype.setLabel=function(t){this.value.text=t},e.prototype.getLabel=function(){return this.value.text},e.prototype.setEnabled=function(t){this.list.touchEnabled=t,this.list.touchChildren=t},e.prototype.getEnabled=function(){return this.list.touchEnabled},e.prototype.destructor=function(){this.list.removeEventListener(egret.Event.CHANGE,this.listSelect,this),this.removeTouchEvent(this,this.onTap),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),this.removeStage()},e}(BaseView);__reflect(DropDown.prototype,"DropDown");var ScrollView=function(t){function e(){var e=t.call(this)||this;return e.curItemCount=0,e.delayScroll=250,e.bScrolling=!1,e.speed=10,e.add_num=0,e.cell_width=0,e.cell_height=0,e.count=0,e.current_index=-1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.validateNow();var t=this.viewport.contentWidth-this.viewport.width;if(t>0?(this.isHScroller=!0,this.itemSize=this.viewport.width,this.itemNum=this.viewport.contentWidth/this.viewport.width):(this.isHScroller=!1,this.itemSize=this.viewport.height,this.itemNum=this.viewport.contentHeight/this.viewport.height),this.throwSpeed=0,this.bounces=!0,this.addEventListener(eui.UIEvent.CHANGE_START,this.onChangeStartHandler,this),this.addEventListener(eui.UIEvent.CHANGE_END,this.onChangeEndHandler,this),this.add_num=0,this.viewport instanceof eui.List){if(this.list=this.viewport,this.viewport.numChildren>0){var e=this.viewport.getChildAt(0);this.cell_width=e.width,this.cell_height=e.height,this.count=this.viewport.numChildren}}else if(this.numChildren>0){var e=this.getChildAt(0);this.cell_width=e.width,this.cell_height=e.height,this.count=this.numChildren}this.itemNum>1&&TimerManager.ins().doTimer(200,0,this.onAutoMove,this)},e.prototype.start=function(){this.touchEnabled=!0,this.touchChildren=!0},e.prototype.stop=function(){this.touchEnabled=!1,this.touchChildren=!1},e.prototype.onChangeStartHandler=function(){CommonUtils.log("ItemScroller >> change start"),this.isHScroller?this.touchStartPos=this.viewport.scrollH:this.touchStartPos=this.viewport.scrollV},e.prototype.onChangeEndHandler=function(){if(CommonUtils.log("ItemScroller >> change end"),-1!=this.touchStartPos){var t;t=this.isHScroller?this.viewport.scrollH-this.touchStartPos:this.viewport.scrollV-this.touchStartPos,t>0?this.scrollToNext():0>t&&this.scrollToLast(),this.touchStartPos=-1}},e.prototype.onAutoMove=function(){if(this.isHScroller){if(this.viewport.scrollH=this.viewport.scrollH+this.speed,this.viewport.scrollH>this.viewport.contentWidth-this.viewport.width){var t=this.viewport.scrollH-this.viewport.contentWidth+this.viewport.width,e=Math.floor(t/this.cell_width);if(this.current_index<e){var i=e%this.count;if(this.list){var n=this.list.getChildAt(i);n.x=this.viewport.contentWidth+(e+1)*this.cell_width,this.current_index=e}else{var n=this.getChildAt(i);n.x=this.viewport.contentWidth+(e+1)*this.cell_width,this.current_index=e}this.validateNow()}}}else this.viewport.scrollV=this.viewport.scrollV+this.speed,this.viewport.scrollV>this.viewport.contentWidth-this.viewport.height&&(this.getChildAt(0),this.addChild(this.getChildAt(0)),this.removeChildAt(0),this.validateNow(),this.add_num++)},e.prototype.scrollToNext=function(){if(!this.bScrolling){var t=this.curItemCount;t<this.itemNum-1&&t++,this.scrollToItem(t)}},e.prototype.scrollToLast=function(){if(!this.bScrolling){var t=this.curItemCount;t>0&&t--,this.scrollToItem(t)}},e.prototype.scrollToItem=function(t){var i=this;this.bScrolling||t>=0&&t<this.itemNum&&(this.bScrolling=!0,this.disableTouch(),this.curItemCount=t,egret.Tween.removeTweens(this.viewport),this.isHScroller?egret.Tween.get(this.viewport).to({scrollH:t*this.itemSize,ease:egret.Ease.quadOut},this.delayScroll):egret.Tween.get(this.viewport).to({scrollV:t*this.itemSize,ease:egret.Ease.quadOut},this.delayScroll),egret.Tween.get(this.viewport).wait(this.delayScroll).call(function(){i.bScrolling=!1,i.enableTouch(),i.dispatchEventWith(e.EVENT_SCROLL_COMPLETE,!1,i.curItemCount)},this))},e.prototype.enableTouch=function(){this.touchEnabled=!0,this.touchChildren=!0},e.prototype.disableTouch=function(){this.touchChildren=!1,this.touchEnabled=!1},e.prototype.destroy=function(){TimerManager.ins().remove(this.onAutoMove,this)},e.EVENT_SCROLL_COMPLETE="EVENT_SCROLL_COMPLETE",e}(eui.Scroller);__reflect(ScrollView.prototype,"ScrollView"),window.ScrollView=ScrollView;var Achievement_dataConfig=function(){function t(){}return t}();__reflect(Achievement_dataConfig.prototype,"Achievement_dataConfig");var Achievement_groupConfig=function(){function t(){}return t}();__reflect(Achievement_groupConfig.prototype,"Achievement_groupConfig");var Achievement_level_dataConfig=function(){function t(){}return t}();__reflect(Achievement_level_dataConfig.prototype,"Achievement_level_dataConfig");var Activity_containerConfig=function(){function t(){}return t}();__reflect(Activity_containerConfig.prototype,"Activity_containerConfig");var Activity_dataConfig=function(){function t(){}return t}();__reflect(Activity_dataConfig.prototype,"Activity_dataConfig");var Activity_exchange_dataConfig=function(){function t(){}return t}();__reflect(Activity_exchange_dataConfig.prototype,"Activity_exchange_dataConfig");var Activity_gift_dataConfig=function(){function t(){}return t}();__reflect(Activity_gift_dataConfig.prototype,"Activity_gift_dataConfig");var Activity_open_dataConfig=function(){function t(){}return t}();__reflect(Activity_open_dataConfig.prototype,"Activity_open_dataConfig");var Activity_redpack_dataConfig=function(){function t(){}return t}();__reflect(Activity_redpack_dataConfig.prototype,"Activity_redpack_dataConfig");var Activity_remarkConfig=function(){function t(){}return t}();__reflect(Activity_remarkConfig.prototype,"Activity_remarkConfig");var AiConfig=function(){function t(){this.skills=[101,102]}return t}();__reflect(AiConfig.prototype,"AiConfig");var Alive_descConfig=function(){function t(){}return t}();__reflect(Alive_descConfig.prototype,"Alive_descConfig");var Alive_level_dataConfig=function(){function t(){}return t}();__reflect(Alive_level_dataConfig.prototype,"Alive_level_dataConfig");var Alive_pointConfig=function(){function t(){}return t}();__reflect(Alive_pointConfig.prototype,"Alive_pointConfig");var Alive_rewardConfig=function(){function t(){}return t}();__reflect(Alive_rewardConfig.prototype,"Alive_rewardConfig");var Alive_week_tipsConfig=function(){function t(){}return t}();__reflect(Alive_week_tipsConfig.prototype,"Alive_week_tipsConfig");var Arena_base_dataConfig=function(){function t(){}return t}();__reflect(Arena_base_dataConfig.prototype,"Arena_base_dataConfig");var Arena_buy_dataConfig=function(){function t(){}return t}();__reflect(Arena_buy_dataConfig.prototype,"Arena_buy_dataConfig");var Arena_first_rank_awardConfig=function(){function t(){}return t}();__reflect(Arena_first_rank_awardConfig.prototype,"Arena_first_rank_awardConfig");var Arena_rank_index_dataConfig=function(){function t(){}return t}();__reflect(Arena_rank_index_dataConfig.prototype,"Arena_rank_index_dataConfig");var Arena_vip_challenge_timesConfig=function(){function t(){}return t}();__reflect(Arena_vip_challenge_timesConfig.prototype,"Arena_vip_challenge_timesConfig");var Baoku_cell_dataConfig=function(){function t(){}return t}();__reflect(Baoku_cell_dataConfig.prototype,"Baoku_cell_dataConfig");var Baoku_dataConfig=function(){function t(){}return t}();__reflect(Baoku_dataConfig.prototype,"Baoku_dataConfig");var Baowu_base_dataConfig=function(){function t(){}return t}();__reflect(Baowu_base_dataConfig.prototype,"Baowu_base_dataConfig");var Baowu_crit_dataConfig=function(){function t(){}return t}();__reflect(Baowu_crit_dataConfig.prototype,"Baowu_crit_dataConfig");var Baowu_exp_item_dataConfig=function(){function t(){}return t}();__reflect(Baowu_exp_item_dataConfig.prototype,"Baowu_exp_item_dataConfig");var Baowu_swallow_item_attrConfig=function(){function t(){}return t}();__reflect(Baowu_swallow_item_attrConfig.prototype,"Baowu_swallow_item_attrConfig");var Be_equipup_dataConfig=function(){function t(){}return t}();__reflect(Be_equipup_dataConfig.prototype,"Be_equipup_dataConfig");var Be_levelup_dataConfig=function(){function t(){}return t}();__reflect(Be_levelup_dataConfig.prototype,"Be_levelup_dataConfig");var Be_stronger_dataConfig=function(){function t(){}return t}();__reflect(Be_stronger_dataConfig.prototype,"Be_stronger_dataConfig");var Boss_cross_scene_dataConfig=function(){function t(){}return t}();__reflect(Boss_cross_scene_dataConfig.prototype,"Boss_cross_scene_dataConfig");var Boss_dabaoConfig=function(){function t(){}return t}();__reflect(Boss_dabaoConfig.prototype,"Boss_dabaoConfig");var Boss_miscConfig=function(){function t(){}return t}();__reflect(Boss_miscConfig.prototype,"Boss_miscConfig");var Boss_robotConfig=function(){function t(){}return t}();__reflect(Boss_robotConfig.prototype,"Boss_robotConfig");var Boss_tianqiConfig=function(){function t(){}return t}();__reflect(Boss_tianqiConfig.prototype,"Boss_tianqiConfig");var Boss_times_dataConfig=function(){function t(){}return t}();__reflect(Boss_times_dataConfig.prototype,"Boss_times_dataConfig");var Boss_ylsd_team_addConfig=function(){function t(){}return t}();__reflect(Boss_ylsd_team_addConfig.prototype,"Boss_ylsd_team_addConfig");var BossConfig=function(){function t(){}return t}();__reflect(BossConfig.prototype,"BossConfig");var Char_resConfig=function(){function t(){}return t}();__reflect(Char_resConfig.prototype,"Char_resConfig");var ClientGlobalConfig=function(){function t(){}return t}();__reflect(ClientGlobalConfig.prototype,"ClientGlobalConfig");var Code_defConfig=function(){function t(){}return t}();__reflect(Code_defConfig.prototype,"Code_defConfig");var ComcolorConfig=function(){function t(){}return t}();__reflect(ComcolorConfig.prototype,"ComcolorConfig");var ContinuousAct_idConfig=function(){function t(){}return t}();__reflect(ContinuousAct_idConfig.prototype,"ContinuousAct_idConfig");var Copy_dataConfig=function(){function t(){}return t}();__reflect(Copy_dataConfig.prototype,"Copy_dataConfig");var Copy_miscConfig=function(){function t(){}return t}();__reflect(Copy_miscConfig.prototype,"Copy_miscConfig");var CreateNameConfig=function(){function t(){}return t}();__reflect(CreateNameConfig.prototype,"CreateNameConfig");var Dailytask_base_dataConfig=function(){function t(){}return t}();__reflect(Dailytask_base_dataConfig.prototype,"Dailytask_base_dataConfig");var Dailytask_hard_dataConfig=function(){function t(){}return t}();__reflect(Dailytask_hard_dataConfig.prototype,"Dailytask_hard_dataConfig");var Dailytask_misc_dataConfig=function(){function t(){}return t}();__reflect(Dailytask_misc_dataConfig.prototype,"Dailytask_misc_dataConfig");var Datatpl_nameConfig=function(){function t(){}return t}();__reflect(Datatpl_nameConfig.prototype,"Datatpl_nameConfig");var DropConfig=function(){function t(){}return t}();__reflect(DropConfig.prototype,"DropConfig");var Dujie_base_dataConfig=function(){function t(){}return t}();__reflect(Dujie_base_dataConfig.prototype,"Dujie_base_dataConfig");var Dujie_copy_dataConfig=function(){function t(){}return t}();__reflect(Dujie_copy_dataConfig.prototype,"Dujie_copy_dataConfig");
var Dujie_descConfig=function(){function t(){}return t}();__reflect(Dujie_descConfig.prototype,"Dujie_descConfig");var Dujie_misc_dataConfig=function(){function t(){}return t}();__reflect(Dujie_misc_dataConfig.prototype,"Dujie_misc_dataConfig");var Dujie_task_dataConfig=function(){function t(){}return t}();__reflect(Dujie_task_dataConfig.prototype,"Dujie_task_dataConfig");var Equip_suit_attr_dataConfig=function(){function t(){}return t}();__reflect(Equip_suit_attr_dataConfig.prototype,"Equip_suit_attr_dataConfig");var Equip_suit_base_dataConfig=function(){function t(){}return t}();__reflect(Equip_suit_base_dataConfig.prototype,"Equip_suit_base_dataConfig");var Equip_swallow_dataConfig=function(){function t(){}return t}();__reflect(Equip_swallow_dataConfig.prototype,"Equip_swallow_dataConfig");var Equip_swallow_item_dataConfig=function(){function t(){}return t}();__reflect(Equip_swallow_item_dataConfig.prototype,"Equip_swallow_item_dataConfig");var EquipmentConfig=function(){function t(){}return t}();__reflect(EquipmentConfig.prototype,"EquipmentConfig");var Err_codeConfig=function(){function t(){}return t}();__reflect(Err_codeConfig.prototype,"Err_codeConfig");var Fabao_base_dataConfig=function(){function t(){}return t}();__reflect(Fabao_base_dataConfig.prototype,"Fabao_base_dataConfig");var Fabao_extend_dataConfig=function(){function t(){}return t}();__reflect(Fabao_extend_dataConfig.prototype,"Fabao_extend_dataConfig");var Fabao_jingjie_dataConfig=function(){function t(){}return t}();__reflect(Fabao_jingjie_dataConfig.prototype,"Fabao_jingjie_dataConfig");var Fabao_melt_attrConfig=function(){function t(){}return t}();__reflect(Fabao_melt_attrConfig.prototype,"Fabao_melt_attrConfig");var Fabao_miscConfig=function(){function t(){}return t}();__reflect(Fabao_miscConfig.prototype,"Fabao_miscConfig");var Fabao_suit_dataConfig=function(){function t(){}return t}();__reflect(Fabao_suit_dataConfig.prototype,"Fabao_suit_dataConfig");var Faction_attack_base_dataConfig=function(){function t(){}return t}();__reflect(Faction_attack_base_dataConfig.prototype,"Faction_attack_base_dataConfig");var Faction_attack_monster_dataConfig=function(){function t(){}return t}();__reflect(Faction_attack_monster_dataConfig.prototype,"Faction_attack_monster_dataConfig");var Faction_attack_path_dataConfig=function(){function t(){}return t}();__reflect(Faction_attack_path_dataConfig.prototype,"Faction_attack_path_dataConfig");var Faction_attack_rank_awardConfig=function(){function t(){}return t}();__reflect(Faction_attack_rank_awardConfig.prototype,"Faction_attack_rank_awardConfig");var Faction_attack_relive_dataConfig=function(){function t(){}return t}();__reflect(Faction_attack_relive_dataConfig.prototype,"Faction_attack_relive_dataConfig");var Faction_attack_score_awardConfig=function(){function t(){}return t}();__reflect(Faction_attack_score_awardConfig.prototype,"Faction_attack_score_awardConfig");var Faction_boss_dataConfig=function(){function t(){}return t}();__reflect(Faction_boss_dataConfig.prototype,"Faction_boss_dataConfig");var Faction_boss_feed_dataConfig=function(){function t(){}return t}();__reflect(Faction_boss_feed_dataConfig.prototype,"Faction_boss_feed_dataConfig");var Faction_boss_rank_awardConfig=function(){function t(){}return t}();__reflect(Faction_boss_rank_awardConfig.prototype,"Faction_boss_rank_awardConfig");var Faction_dataConfig=function(){function t(){}return t}();__reflect(Faction_dataConfig.prototype,"Faction_dataConfig");var Faction_defend_path_dataConfig=function(){function t(){}return t}();__reflect(Faction_defend_path_dataConfig.prototype,"Faction_defend_path_dataConfig");var Faction_level_dataConfig=function(){function t(){}return t}();__reflect(Faction_level_dataConfig.prototype,"Faction_level_dataConfig");var Faction_misc_dataConfig=function(){function t(){}return t}();__reflect(Faction_misc_dataConfig.prototype,"Faction_misc_dataConfig");var Faction_reprotConfig=function(){function t(){}return t}();__reflect(Faction_reprotConfig.prototype,"Faction_reprotConfig");var Faction_skill_dataConfig=function(){function t(){}return t}();__reflect(Faction_skill_dataConfig.prototype,"Faction_skill_dataConfig");var Faction_skill_unlockConfig=function(){function t(){}return t}();__reflect(Faction_skill_unlockConfig.prototype,"Faction_skill_unlockConfig");var Faction_sword_leader_award_dataConfig=function(){function t(){}return t}();__reflect(Faction_sword_leader_award_dataConfig.prototype,"Faction_sword_leader_award_dataConfig");var Faction_sword_opp_dataConfig=function(){function t(){}return t}();__reflect(Faction_sword_opp_dataConfig.prototype,"Faction_sword_opp_dataConfig");var Faction_sword_paramConfig=function(){function t(){}return t}();__reflect(Faction_sword_paramConfig.prototype,"Faction_sword_paramConfig");var Faction_sword_rank_award_dataConfig=function(){function t(){}return t}();__reflect(Faction_sword_rank_award_dataConfig.prototype,"Faction_sword_rank_award_dataConfig");var Faction_sword_score_award_dataConfig=function(){function t(){}return t}();__reflect(Faction_sword_score_award_dataConfig.prototype,"Faction_sword_score_award_dataConfig");var Faction_sword_vip_challengeConfig=function(){function t(){}return t}();__reflect(Faction_sword_vip_challengeConfig.prototype,"Faction_sword_vip_challengeConfig");var Fashion_base_dataConfig=function(){function t(){}return t}();__reflect(Fashion_base_dataConfig.prototype,"Fashion_base_dataConfig");var Fashion_grow_dataConfig=function(){function t(){}return t}();__reflect(Fashion_grow_dataConfig.prototype,"Fashion_grow_dataConfig");var Fashion_id_dataConfig=function(){function t(){}return t}();__reflect(Fashion_id_dataConfig.prototype,"Fashion_id_dataConfig");var Fashion_level_dataConfig=function(){function t(){}return t}();__reflect(Fashion_level_dataConfig.prototype,"Fashion_level_dataConfig");var Fashion_swallow_dataConfig=function(){function t(){}return t}();__reflect(Fashion_swallow_dataConfig.prototype,"Fashion_swallow_dataConfig");var Fashion_swallow_itemConfig=function(){function t(){}return t}();__reflect(Fashion_swallow_itemConfig.prototype,"Fashion_swallow_itemConfig");var Fight_ratioConfig=function(){function t(){}return t}();__reflect(Fight_ratioConfig.prototype,"Fight_ratioConfig");var Fight_up_dataConfig=function(){function t(){}return t}();__reflect(Fight_up_dataConfig.prototype,"Fight_up_dataConfig");var Find_treasure_1Config=function(){function t(){}return t}();__reflect(Find_treasure_1Config.prototype,"Find_treasure_1Config");var Find_treasure_2Config=function(){function t(){}return t}();__reflect(Find_treasure_2Config.prototype,"Find_treasure_2Config");var Find_treasure_3Config=function(){function t(){}return t}();__reflect(Find_treasure_3Config.prototype,"Find_treasure_3Config");var Find_treasure_4Config=function(){function t(){}return t}();__reflect(Find_treasure_4Config.prototype,"Find_treasure_4Config");var Find_treasure_5Config=function(){function t(){}return t}();__reflect(Find_treasure_5Config.prototype,"Find_treasure_5Config");var Find_treasure_6Config=function(){function t(){}return t}();__reflect(Find_treasure_6Config.prototype,"Find_treasure_6Config");var Find_treasure_7Config=function(){function t(){}return t}();__reflect(Find_treasure_7Config.prototype,"Find_treasure_7Config");var Find_treasure_globalConfig=function(){function t(){}return t}();__reflect(Find_treasure_globalConfig.prototype,"Find_treasure_globalConfig");var Find_treasureConfig=function(){function t(){}return t}();__reflect(Find_treasureConfig.prototype,"Find_treasureConfig");var First_rank_index_dataConfig=function(){function t(){}return t}();__reflect(First_rank_index_dataConfig.prototype,"First_rank_index_dataConfig");var Freegift_dataConfig=function(){function t(){}return t}();__reflect(Freegift_dataConfig.prototype,"Freegift_dataConfig");var Fuwen_base_dataConfig=function(){function t(){}return t}();__reflect(Fuwen_base_dataConfig.prototype,"Fuwen_base_dataConfig");var Fuwen_compose_dataConfig=function(){function t(){}return t}();__reflect(Fuwen_compose_dataConfig.prototype,"Fuwen_compose_dataConfig");var Fuwen_hole_dataConfig=function(){function t(){}return t}();__reflect(Fuwen_hole_dataConfig.prototype,"Fuwen_hole_dataConfig");var Fuwen_master_dataConfig=function(){function t(){}return t}();__reflect(Fuwen_master_dataConfig.prototype,"Fuwen_master_dataConfig");var Fuwen_miscConfig=function(){function t(){}return t}();__reflect(Fuwen_miscConfig.prototype,"Fuwen_miscConfig");var Fuwen_nameConfig=function(){function t(){}return t}();__reflect(Fuwen_nameConfig.prototype,"Fuwen_nameConfig");var Fuwen_previewConfig=function(){function t(){}return t}();__reflect(Fuwen_previewConfig.prototype,"Fuwen_previewConfig");var Fuwen_resConfig=function(){function t(){}return t}();__reflect(Fuwen_resConfig.prototype,"Fuwen_resConfig");var Fuwen_unlock_dataConfig=function(){function t(){}return t}();__reflect(Fuwen_unlock_dataConfig.prototype,"Fuwen_unlock_dataConfig");var Fuyin_base_dataConfig=function(){function t(){}return t}();__reflect(Fuyin_base_dataConfig.prototype,"Fuyin_base_dataConfig");var Fuyin_skill_dataConfig=function(){function t(){}return t}();__reflect(Fuyin_skill_dataConfig.prototype,"Fuyin_skill_dataConfig");var Fuyin_suit_dataConfig=function(){function t(){}return t}();__reflect(Fuyin_suit_dataConfig.prototype,"Fuyin_suit_dataConfig");var GiftConfig=function(){function t(){}return t}();__reflect(GiftConfig.prototype,"GiftConfig");var GlobalConfig=function(){function t(){this.screenchar=[]}return t.ins=function(){return null==this._instance&&(this._instance=new t),this._instance},t.init=function(){},t.getConfig=function(e,i,n){var o,s=this.ins();if(o=e+".json",n&&(o=n+"/"+e+".json"),!s[i]){var r=t.unZip(o);s[i]=r}return s[i]},t.unZip=function(t){var e;this.configlist||(this.configlist=[]);var i=this.prelist.indexOf(t.replace(".json",""));if(!e&&i>-1){var n=12;if(!this.configlist[n]){var o=RES.getRes("config1_zz"+n+"_zip");o&&(this.configlist[n]=new JSZip(o))}this.configlist[n]&&(e=this.configlist[n].file(t))}else{if(!this.configlist[0]){var o=RES.getRes("config1_zz_zip");o&&(this.configlist[0]=new JSZip(o))}e=this.configlist[0].file(t)}return e?JSON.parse(e.asText()):void Debug.error("!!!配置解析失败：["+t+"]")},t.getArrayConfigByIndex=function(t,e){var i=e[t];if(i)return i},t.getSceneEditorById=function(t){return this.getConfig("scene_editor","SceneEditor"),this.getArrayConfigByIndex(t,this.ins().SceneEditor)},t.getTowerRewardById=function(t){return this.getConfig("tower_reward","TowerRewardConfig"),this.getArrayConfigByIndex(t,this.ins().TowerRewardConfig)},t.getFabaoList=function(){return this.getConfig("fabao_base_data","FabaoList")},t.getFabaoListById=function(t){return this.getConfig("fabao_base_data","FabaoList"),this.getArrayConfigByIndex(t,this.ins().FabaoList)},t.getFabaoById=function(t,e){var i=this.getFabaoList();return i&&i[t]&&i[t][e]?i[t][e]:void 0},t.getFabaoTypeList=function(){return this.getConfig("fabao_extend_data","FabaoTypeList")},t.getFabaoType=function(t){return this.getConfig("fabao_extend_data","FabaoTypeList"),this.getArrayConfigByIndex(t,this.ins().FabaoTypeList)},t.getFabaoJjById=function(t){return this.getConfig("fabao_jingjie_data","FabaoJj"),this.getArrayConfigByIndex(t,this.ins().FabaoJj)},t.getFabaoMeltById=function(t){return this.getConfig("fabao_melt_attr","FabaoMelt"),this.getArrayConfigByIndex(t,this.ins().FabaoMelt)},t.getVenation=function(t){return this.getConfig("venation_data","VenationList"),this.getArrayConfigByIndex(t,this.ins().VenationList)},t.getFabaoMisc=function(t){return this.getConfig("fabao_misc","FabaoMisc"),this.getArrayConfigByIndex(t,this.ins().FabaoMisc)},t.getTitleById=function(t){return this.getConfig("title_data","TitleConfig"),this.getArrayConfigByIndex(t,this.ins().TitleConfig)},t.getTitleConfigs=function(){return this.getConfig("title_data","TitleConfig")},t.getDropConfig=function(t){return this.getConfig("drop","DropConfig"),this.getArrayConfigByIndex(t,this.ins().DropConfig)},t.getDropItem=function(t){for(var e=[],i=0;i<t.length;i++){var n=[];e.push(n);for(var o=0;o<t[i].length;o++){var s=new DropItem;s.id=t[i][o][0],s.num=t[i][o][1],s.num_limit=t[i][o][2],s.bing=t[i][o][3],s.probability=t[i][o][4],s.type=t[i][o][5],s.intensify=t[i][o][6],n.push(s)}}return e},t.getLearnSkillConfigById=function(t){return this.getConfig("learn_skill","LearnSkill"),this.getArrayConfigByIndex(t,this.ins().LearnSkill)},t.getCharResConfigById=function(t){return this.getConfig("char_res","CharResConfig"),this.getArrayConfigByIndex(t,this.ins().CharResConfig)},t.getMonsterConfigById=function(t){return this.getConfig("monster","MonstersConfig"),this.getArrayConfigByIndex(t,this.ins().MonstersConfig)},t.getSkillConfig=function(t){return this.getConfig("skill","SkillsConfig"),this.getArrayConfigByIndex(t,this.ins().SkillsConfig)},t.getSkillDescById=function(t){return this.getConfig("skill_desc","skilldesc"),this.getArrayConfigByIndex(t,this.ins().skilldesc)},t.getSkillEffConfig=function(t){return this.getConfig("skill_eff","SkillEffsConfig"),this.getArrayConfigByIndex(t,this.ins().SkillEffsConfig)},t.getFsSkillById=function(t){return this.getConfig("skill_rune_data","SkillFsConfig"),this.getArrayConfigByIndex(t,this.ins().SkillFsConfig)},t.getAiConfig=function(t){return this.getConfig("monster_ai","AiConfig"),this.getArrayConfigByIndex(t,this.ins().AiConfig)},t.getCopyConfigById=function(t){return this.getConfig("copy_data","CopyDataConfig"),this.getArrayConfigByIndex(t,this.ins().CopyDataConfig)},t.getCodeConfigById=function(t){return this.getConfig("code_def","codeDefConfig"),this.getArrayConfigByIndex(t,this.ins().codeDefConfig)},t.getSceneConfigById=function(t){return this.getConfig("scene_data","SceneConfig"),this.getArrayConfigByIndex(t,this.ins().SceneConfig)},t.getFacMisc=function(){return this.getConfig("faction_misc_data","FacMiscData"),this.getArrayConfigByIndex(1,this.ins().FacMiscData)},t.getEpicCount=function(){return 4},t.getFineAttrCount=function(){return 6},t.getStrengthenMax=function(){return 15},t.getAddLvMax=function(){return 200},t.getServerConfig=function(t){return this.getConfig("server","ServerConfig"),this.getArrayConfigByIndex(t,this.ins().ServerConfig)},t.getServerDataBySrvip=function(t){var e=this.getConfig("server","ServerConfig");if(e)for(var i in e){var n=e[i];if(n.ip==t)return n}},t.getTaskConfig=function(t){return this.getConfig("task","TaskConfig"),this.getArrayConfigByIndex(t,this.ins().TaskConfig)},t.getSceneMonsterConfig=function(t){return this.getConfig("scene_monster","SceneMonsterConfig"),this.getArrayConfigByIndex(t,this.ins().SceneMonsterConfig)},t.getScene_monster_serverConfig=function(t){return this.getConfig("scene_monster_server","scene_monster_serverConfig"),this.getArrayConfigByIndex(t,this.ins().scene_monster_serverConfig)},t.getItemsConfig=function(t){return this.getConfig("items","ItemsConfig"),this.getArrayConfigByIndex(t,this.ins().ItemsConfig)},t.getEquipmentConfig=function(t){return this.getConfig("equipment","EquipmentConfig"),this.getArrayConfigByIndex(t,this.ins().EquipmentConfig)},t.getGiftConfig=function(t){return this.getConfig("gift","GiftConfig"),this.getArrayConfigByIndex(t,this.ins().GiftConfig)},t.getLimitsConfig=function(t){return this.getConfig("limits","LimitsConfig"),this.getArrayConfigByIndex(t,this.ins().LimitsConfig)},t.getColorConfig=function(t){return this.getConfig("comcolor","ColorConfig"),this.getArrayConfigByIndex(t,this.ins().ColorConfig)},t.getMelt_dataConfig=function(t){return this.getConfig("melt_data","Melt_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Melt_dataConfig)},t.getIntensify_part_dataConfig=function(t){return this.getConfig("intensify_part_data","Intensify_part_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Intensify_part_dataConfig)},t.getIntensify_part_attrConfig=function(t){return this.getConfig("intensify_part_attr","Intensify_part_attrConfig"),this.getArrayConfigByIndex(t,this.ins().Intensify_part_attrConfig)},t.getIntensify_suit_dataConfig=function(t){return this.getConfig("intensify_suit_data","Intensify_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Intensify_suit_dataConfig)},t.getLyhConfigById=function(t){return this.getConfig("lyh_copy","LyhConfig"),this.getArrayConfigByIndex(t,this.ins().LyhConfig)},t.getLyhConfig=function(){return this.getConfig("lyh_copy","LyhConfig")},t.getLyhRewardById=function(t){return this.getConfig("lyh_rewards","LyhRewardConfig"),this.getArrayConfigByIndex(t,this.ins().LyhRewardConfig)},t.getLyhReward=function(){return this.getConfig("lyh_rewards","LyhRewardConfig")},t.getLyhMisc=function(){return this.getConfig("lyh_misc","LyhMiscConfig"),this.getArrayConfigByIndex(1,this.ins().LyhMiscConfig)},t.getLyhVipById=function(t){return this.getConfig("lyh_vip_data","lyhVip"),this.getArrayConfigByIndex(t,this.ins().lyhVip)},t.getLyhSweepList=function(){return this.getConfig("lyh_sweep_data","lyhSweepList")},t.getLyhSweepById=function(t){return this.getConfig("lyh_sweep_data","lyhSweepList"),this.getArrayConfigByIndex(t,this.ins().lyhSweepList)},t.getLyhLayerByID=function(t){return this.getConfig("lyh_layer_data","lyhLayerList"),this.getArrayConfigByIndex(t,this.ins().lyhLayerList)},t.getZhuanById=function(t){return this.getConfig("zhuan_data","ZhuanConfig"),this.getArrayConfigByIndex(t,this.ins().ZhuanConfig)},t.getZhuanMaxStage=function(){var t=this.getConfig("zhuan_data","ZhuanConfig");if(this.zhuanMaxStage>0)return this.zhuanMaxStage;for(var e in t)0==this.zhuanMaxStage?this.zhuanMaxStage=t[e].zhuan:this.zhuanMaxStage<t[e].zhuan&&(this.zhuanMaxStage=t[e].zhuan);return this.zhuanMaxStage},t.getZhuanOpen=function(){var t=this.getConfig("zhuan_open","ZhuanOpenConfig");if(void 0!=this.zhuanOpen)return this.zhuanOpen;this.zhuanOpen={};for(var e in t){var i=t[e].zhuan;void 0==this.zhuanOpen[i]&&(this.zhuanOpen[i]=[]),this.zhuanOpen[i].push(t[e])}return this.zhuanOpen},t.getHangPathById=function(t){return this.getConfig("hang_path","hangPathConfig"),this.getArrayConfigByIndex(t,this.ins().hangPathConfig)},t.getZhuanList=function(){return this.getConfig("zhuan_data","ZhuanConfig")},t.getUpstar_part_dataConfig=function(t){return this.getConfig("upstar_part_data","Upstar_part_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Upstar_part_dataConfig)},t.getUpstar_vip_rateConfig=function(t){return this.getConfig("upstar_vip_rate","Upstar_vip_rateConfig"),this.getArrayConfigByIndex(t,this.ins().Upstar_vip_rateConfig)},t.getUpstar_master_dataConfig=function(t){return this.getConfig("upstar_master_data","Upstar_master_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Upstar_master_dataConfig)},t.getSoulstone_dataConfig=function(t){return this.getConfig("soulstone_data","Soulstone_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Soulstone_dataConfig)},t.getSoulstone_partConfig=function(t){return this.getConfig("soulstone_part","Soulstone_partConfig"),this.getArrayConfigByIndex(t,this.ins().Soulstone_partConfig)},t.getSoulstone_master_dataConfig=function(t){return this.getConfig("soulstone_master_data","Soulstone_master_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Soulstone_master_dataConfig)},t.getSoulstone_misc_dataConfig=function(t){return this.getConfig("soulstone_misc_data","Soulstone_misc_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Soulstone_misc_dataConfig)},t.getReputation_dataConfig=function(t){return this.getConfig("reputation_data","reputationConfig"),this.getArrayConfigByIndex(t,this.ins().reputationConfig)},t.getGod_item_suitConfig=function(t,e){this.getConfig("god_item_suit","God_item_suitConfig");var i=this.getArrayConfigByIndex(t,this.ins().God_item_suitConfig);return i[e.toString()]},t.getGod_make_dataConfig=function(t){return this.getConfig("god_make_data","God_make_dataConfig"),this.getArrayConfigByIndex(t,this.ins().God_make_dataConfig)},t.getGodMakeConfig=function(){return this.getConfig("god_make_data","God_make_dataConfig")},t.getGod_forge_dataConfig=function(t){return this.getConfig("god_forge_data","God_forge_dataConfig"),this.getArrayConfigByIndex(t,this.ins().God_forge_dataConfig)},t.getGod_forge_suit_dataConfig=function(t,e){this.getConfig("god_forge_suit_data","God_forge_suit_dataConfig");var i=this.getArrayConfigByIndex(t,this.ins().God_forge_suit_dataConfig);return i[e.toString()]},t.getGod_soul_dataConfig=function(t){return this.getConfig("god_soul_data","God_soul_dataConfig"),this.getArrayConfigByIndex(t,this.ins().God_soul_dataConfig)},t.getInjectsoul_part_dataConfig=function(t){return this.getConfig("injectsoul_part_data","Injectsoul_part_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Injectsoul_part_dataConfig)},t.getInjectsoul_itemsConfig=function(t){return this.getConfig("injectsoul_items","Injectsoul_itemsConfig"),this.getArrayConfigByIndex(t,this.ins().Injectsoul_itemsConfig)},t.getInjectsoul_swallowConfig=function(t){return this.getConfig("injectsoul_swallow","Injectsoul_swallowConfig"),this.getArrayConfigByIndex(t,this.ins().Injectsoul_swallowConfig)},t.getInjectsoul_swallow_itemsConfig=function(t){return this.getConfig("injectsoul_swallow_items","Injectsoul_swallow_itemsConfig"),this.getArrayConfigByIndex(t,this.ins().Injectsoul_swallow_itemsConfig)},t.getInjectsoul_attr_dataConfig=function(t,e){this.getConfig("injectsoul_attr_data","Injectsoul_attr_dataConfig");var i=this.getArrayConfigByIndex(e,this.ins().Injectsoul_attr_dataConfig);return i[t.toString()]},t.getMateSkillConfig=function(t){return this.getConfig("mate_skill_data","mateSkillConfig"),this.getArrayConfigByIndex(t,this.ins().mateSkillConfig)},t.getMateSkinConfig=function(t){return this.getConfig("mate_skin_data","mateSkinConfig"),this.getArrayConfigByIndex(t,this.ins().mateSkinConfig)},t.getMateSkinConfigByNum=function(t,e){return this.getConfig("mate_skin_data","mateSkinConfig"),this.getArrayConfigByIndex(t,this.ins().mateSkinConfig)[e]},t.getMateSkillUpgradeConfig=function(t){return this.getConfig("mate_skill_upgrade","mateSkillUpgradeConfig"),this.getArrayConfigByIndex(t,this.ins().mateSkillUpgradeConfig)},t.getMateSwallowItemConfig=function(t){return this.getConfig("mate_swallow_item","mateSwallowItemConfig"),this.getArrayConfigByIndex(t,this.ins().mateSwallowItemConfig)},t.getMateBaseDataConfig=function(t){return this.getConfig("mate_base_data","mateBaseDataConfig"),this.getArrayConfigByIndex(t,this.ins().mateBaseDataConfig)},t.getMateBaseDataConfigByNum=function(t,e){this.getConfig("mate_base_data","mateBaseDataConfig");var i=this.getArrayConfigByIndex(t,this.ins().mateBaseDataConfig);return i?i[e]:null},t.getMateGradeMatrialConfig=function(t){return this.getConfig("mate_grade_matrial","mateGradeMatrialConfig"),this.getArrayConfigByIndex(t,this.ins().mateGradeMatrialConfig)},t.getMateGradeShowConfig=function(t){return this.getConfig("mate_grade_show","mateGradeShowConfig"),this.getArrayConfigByIndex(t,this.ins().mateGradeShowConfig)},t.getMateSwallowExtendConfig=function(t){return this.getConfig("mate_swallow_extend","mateSwallowExtendConfig"),this.getArrayConfigByIndex(t,this.ins().mateSwallowExtendConfig)},t.getPetSkillConfig=function(t){return this.getConfig("pet_skill_data","petSkillConfig"),this.getArrayConfigByIndex(t,this.ins().petSkillConfig)},t.getPetSkinConfig=function(t){return this.getConfig("pet_skin_data","petSkinConfig"),this.getArrayConfigByIndex(t,this.ins().petSkinConfig)},t.getHorse_skin_ex_dataConfig=function(t){return this.getConfig("horse_skin_ex_data","horse_skin_ex_dataConfig"),this.getArrayConfigByIndex(t,this.ins().horse_skin_ex_dataConfig)},t.getMate_skin_ex_dataConfig=function(t){return this.getConfig("mate_skin_ex_data","mate_skin_ex_dataConfig"),this.getArrayConfigByIndex(t,this.ins().mate_skin_ex_dataConfig)},t.getPet_skin_ex_dataConfig=function(t){return this.getConfig("pet_skin_ex_data","pet_skin_ex_dataConfig"),this.getArrayConfigByIndex(t,this.ins().pet_skin_ex_dataConfig)},t.getPetSkinConfigByNum=function(t,e){return this.getConfig("pet_skin_data","petSkinConfig"),this.getArrayConfigByIndex(t,this.ins().petSkinConfig)[e]},t.getPetSkillUpgradeConfig=function(t){return this.getConfig("pet_skill_upgrade","petSkillUpgradeConfig"),this.getArrayConfigByIndex(t,this.ins().petSkillUpgradeConfig)},t.getPetSwallowItemConfig=function(t){return this.getConfig("pet_swallow_item","petSwallowItemConfig"),this.getArrayConfigByIndex(t,this.ins().petSwallowItemConfig)},t.getPetBaseDataConfig=function(t){return this.getConfig("pet_base_data","petBaseDataConfig"),this.getArrayConfigByIndex(t,this.ins().petBaseDataConfig)},t.getPetBaseDataConfigByNum=function(t,e){this.getConfig("pet_base_data","petBaseDataConfig");var i=this.getArrayConfigByIndex(t,this.ins().petBaseDataConfig);return i?i[e]:null},t.getPetGradeMatrialConfig=function(t){return this.getConfig("pet_grade_matrial","petGradeMatrialConfig"),this.getArrayConfigByIndex(t,this.ins().petGradeMatrialConfig)},t.getPetGradeShowConfig=function(t){return this.getConfig("pet_grade_show","petGradeShowConfig"),this.getArrayConfigByIndex(t,this.ins().petGradeShowConfig)},t.getPetSwallowExtendConfig=function(t){return this.getConfig("pet_swallow_extend","petSwallowExtendConfig"),this.getArrayConfigByIndex(t,this.ins().petSwallowExtendConfig)},t.getHorse_skin_extend_dataConfig=function(t){return this.getConfig("horse_skin_extend_data","horse_skin_extend_dataConfig"),this.getArrayConfigByIndex(t,this.ins().horse_skin_extend_dataConfig)},t.getMate_skin_extend_dataConfig=function(t){return this.getConfig("mate_skin_extend_data","mate_skin_extend_dataConfig"),this.getArrayConfigByIndex(t,this.ins().mate_skin_extend_dataConfig)},t.getPet_skin_extend_dataConfig=function(t){return this.getConfig("pet_skin_extend_data","pet_skin_extend_dataConfig"),this.getArrayConfigByIndex(t,this.ins().pet_skin_extend_dataConfig)},t.getHorseSkillConfig=function(t){return this.getConfig("horse_skill_data","horseSkillConfig"),this.getArrayConfigByIndex(t,this.ins().horseSkillConfig)},t.getHorseSkinConfig=function(t){return this.getConfig("horse_skin_data","horseSkinConfig"),this.getArrayConfigByIndex(t,this.ins().horseSkinConfig)},t.getHorseSkinConfigByNum=function(t,e){return this.getConfig("horse_skin_data","horseSkinConfig"),this.getArrayConfigByIndex(t,this.ins().horseSkinConfig)[e]},t.getHorseSkillUpgradeConfig=function(t){return this.getConfig("horse_skill_upgrade","horseSkillUpgradeConfig"),this.getArrayConfigByIndex(t,this.ins().horseSkillUpgradeConfig)},t.getHorseSwallowItemConfig=function(t){return this.getConfig("horse_swallow_item","horseSwallowItemConfig"),this.getArrayConfigByIndex(t,this.ins().horseSwallowItemConfig)},t.getHorseBaseDataConfig=function(t){return this.getConfig("horse_base_data","horseBaseDataConfig"),this.getArrayConfigByIndex(t,this.ins().horseBaseDataConfig)},t.getHorseBaseDataConfigByNum=function(t,e){this.getConfig("horse_base_data","horseBaseDataConfig");var i=this.getArrayConfigByIndex(t,this.ins().horseBaseDataConfig);return i?this.getArrayConfigByIndex(t,this.ins().horseBaseDataConfig)[e]:null},t.getHorseGradeMatrialConfig=function(t){return this.getConfig("horse_grade_matrial","horseGradeMatrialConfig"),this.getArrayConfigByIndex(t,this.ins().horseGradeMatrialConfig)},t.getHorseGradeShowConfig=function(t){return this.getConfig("horse_grade_show","horseGradeShowConfig"),this.getArrayConfigByIndex(t,this.ins().horseGradeShowConfig)},t.getHorseSwallowExtendConfig=function(t){return this.getConfig("horse_swallow_extend","horseSwallowExtendConfig"),this.getArrayConfigByIndex(t,this.ins().horseSwallowExtendConfig)},t.getHorse_equip_suit_dataConfig=function(t){return this.getConfig("horse_equip_suit_data","horse_equip_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().horse_equip_suit_dataConfig)},t.getMate_equip_suit_dataConfig=function(t){return this.getConfig("mate_equip_suit_data","mate_equip_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().mate_equip_suit_dataConfig)},t.getPet_equip_suit_dataConfig=function(t){return this.getConfig("pet_equip_suit_data","pet_equip_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().pet_equip_suit_dataConfig)},t.getHorse_equip_suit_dataConfigs=function(){return this.getConfig("horse_equip_suit_data","horse_equip_suit_dataConfig")},t.getMate_equip_suit_dataConfigs=function(){return this.getConfig("mate_equip_suit_data","mate_equip_suit_dataConfig")},t.getPet_equip_suit_dataConfigs=function(){return this.getConfig("pet_equip_suit_data","pet_equip_suit_dataConfig")},t.getTplViewConfig=function(t){return this.getConfig("tpl_view","tplViewConfig"),this.getArrayConfigByIndex(t,this.ins().tplViewConfig)},t.getViewResByName=function(t){var e=this.getConfig("view_destroy_res","view_res");return e[t]},t.getArena_buy_dataConfig=function(t){return this.getConfig("arena_buy_data","arena_buy_dataConfig"),this.getArrayConfigByIndex(t,this.ins().arena_buy_dataConfig)},t.getArena_rank_index_dataConfig=function(t){return this.getConfig("arena_rank_index_data","arena_rank_index_dataConfig"),this.getArrayConfigByIndex(t,this.ins().arena_rank_index_dataConfig)},t.getArena_base_dataConfig=function(t){return this.getConfig("arena_base_data","arena_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().arena_base_dataConfig)},t.getArena_vip_challenge_timesConfig=function(t){return this.getConfig("arena_vip_challenge_times","arena_vip_challenge_timesConfig"),this.getArrayConfigByIndex(t,this.ins().arena_vip_challenge_timesConfig)},t.getSXRewardList=function(){return this.getConfig("arena_rank_index_data","arena_rank_index_dataConfig")},t.getBossConfig=function(t){return this.getConfig("boss","bossConfig"),this.getArrayConfigByIndex(t,this.ins().bossConfig)},t.getBossConfigs=function(){return this.getConfig("boss","bossConfig")},t.getSceneConditionConfig=function(t){return this.getConfig("scene_condition","scene_conditionConfig"),this.getArrayConfigByIndex(t,this.ins().scene_conditionConfig)},t.getNameConfig=function(t){return this.getConfig("datatpl_name","CreateNameConfig"),this.getArrayConfigByIndex(t,this.ins().CreateNameConfig)},t.getPath_dataConfig=function(t){return this.getConfig("path_data","Path_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Path_dataConfig)},t.getFashion_base_dataConfig=function(t){return this.getConfig("fashion_base_data","Fashion_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fashion_base_dataConfig)},t.getFashion_grow_dataConfig=function(t,e){return this.getConfig("fashion_grow_data","Fashion_grow_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fashion_grow_dataConfig)[e]},t.getFashionListConfig=function(){return this.getConfig("fashion_base_data","Fashion_base_dataConfig")},t.getFashion_swallow_dataConfig=function(t){return this.getConfig("fashion_swallow_data","Fashion_swallow_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fashion_swallow_dataConfig)},t.getFashion_swallow_itemConfig=function(t){return this.getConfig("fashion_swallow_item","Fashion_swallow_itemConfig"),this.getArrayConfigByIndex(t,this.ins().Fashion_swallow_itemConfig)},t.getFashion_id_dataConfig=function(t){return this.getConfig("fashion_id_data","Fashion_id_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fashion_id_dataConfig)},t.getFashion_level_dataConfig=function(t){return this.getConfig("fashion_level_data","Fashion_level_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fashion_level_dataConfig)},t.getBoss_robotConfig=function(t){return this.getConfig("boss_robot","boss_robotConfig"),this.getArrayConfigByIndex(t,this.ins().boss_robotConfig)},t.getMisc_dataConfig=function(t){return this.getConfig("misc_data","misc_dataConfig"),this.getArrayConfigByIndex(t,this.ins().misc_dataConfig)},t.getFuyin_base_dataConfig=function(t){return this.getConfig("fuyin_base_data","Fuyin_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fuyin_base_dataConfig)},t.getFuyin_suit_dataConfig=function(t,e){return this.getConfig("fuyin_suit_data","Fuyin_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fuyin_suit_dataConfig)[e]
},t.getFuyin_skill_dataConfig=function(t){return this.getConfig("fuyin_skill_data","Fuyin_skill_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fuyin_skill_dataConfig)},t.getRole_lvl_attrConfig=function(t){return this.getConfig("role_lvl_attr","role_lvl_attrConfig"),this.getArrayConfigByIndex(t,this.ins().role_lvl_attrConfig)},t.getStore_cellConfig=function(t){return this.getConfig("store_cell","store_cellConfig"),this.getArrayConfigByIndex(t,this.ins().store_cellConfig)},t.getStore_cellConfigByItemID=function(t){this.getConfig("store_cell","store_cellConfig");var e=this.ins().store_cellConfig;for(var i in e)if(e[i].item_id==t)return e[i];return null},t.getFaction_sword_paramConfig=function(t){return this.getConfig("faction_sword_param","Faction_sword_paramConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_sword_paramConfig)},t.getFaction_sword_vip_challengeConfig=function(t){return this.getConfig("faction_sword_vip_challenge","Faction_sword_vip_challengeConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_sword_vip_challengeConfig)},t.getFaction_sword_score_award_dataConfig=function(t){return this.getConfig("faction_sword_score_award_data","Faction_sword_score_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_sword_score_award_dataConfig)},t.getFactionScoreList=function(){return this.getConfig("faction_sword_score_award_data","Faction_sword_score_award_dataConfig")},t.getFaction_sword_rank_award_dataConfig=function(t){return this.getConfig("faction_sword_rank_award_data","Faction_sword_rank_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_sword_rank_award_dataConfig)},t.getFaction_sword_opp_dataConfig=function(t){return this.getConfig("faction_sword_opp_data","Faction_sword_opp_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_sword_opp_dataConfig)},t.getFaction_dataConfig=function(t){return this.getConfig("faction_data","FacData"),this.getArrayConfigByIndex(t,this.ins().FacData)},t.getFaction_reprotConfig=function(t){return this.getConfig("faction_reprot","Faction_reprotConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_reprotConfig)},t.getFactionReprotList=function(){return this.getConfig("faction_reprot","Faction_reprotConfig")},t.getFaction_sword_leader_award_dataConfig=function(t){return this.getConfig("faction_sword_leader_award_data","Faction_sword_leader_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_sword_leader_award_dataConfig)},t.getLeitai_rank_awardConfig=function(t){return this.getConfig("leitai_rank_award","Leitai_rank_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Leitai_rank_awardConfig)},t.getLeitai_rank_awardConfigList=function(){return this.getConfig("leitai_rank_award","Leitai_rank_awardConfig")},t.getLeitai_misc_dataConfigConfig=function(t){return this.getConfig("leitai_misc_data","Leitai_misc_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Leitai_misc_dataConfig)},t.getLeitai_tequanConfig=function(t){return this.getConfig("leitai_tequan","Leitai_tequanConfig"),this.getArrayConfigByIndex(t,this.ins().Leitai_tequanConfig)},t.getStoreConfig=function(t){return this.getConfig("store","storeConfig"),this.getArrayConfigByIndex(t,this.ins().storeConfig)},t.getNotice_defConfig=function(t){return this.getConfig("notice_def","notice_defConfig"),this.getArrayConfigByIndex(t,this.ins().notice_defConfig)},t.getSys_notice_defConfig=function(t){return this.getConfig("sys_notice_def","sys_notice_defConfig"),this.getArrayConfigByIndex(t,this.ins().sys_notice_defConfig)},t.getLeader_battle_base_dataConfig=function(t){return this.getConfig("leader_battle_base_data","Leader_battle_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Leader_battle_base_dataConfig)},t.getLeader_battle_title_dataConfig=function(t){return this.getConfig("leader_battle_title_data","Leader_battle_title_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Leader_battle_title_dataConfig)},t.getLeader_battle_vip_buy_dataConfig=function(t){return this.getConfig("leader_battle_vip_buy_data","Leader_battle_vip_buy_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Leader_battle_vip_buy_dataConfig)},t.getWeaponGrowList=function(){return this.getConfig("shenbing_grow_data","WeaponGrowList")},t.getWeaponGrowById=function(t,e){var i=this.getConfig("shenbing_grow_data","WeaponGrowList");return i&&i[t]&&i[t][e]?i[t][e]:void 0},t.getWeaponResList=function(){return this.getConfig("shenbing_res","WeaponResList")},t.getWeaponTypeList=function(){return this.getConfig("shenbing_type","WeaponTypeList")},t.getWeaponBaseById=function(t,e){var i=this.getConfig("shenbing_base_data","WeaponBaseList");return i&&this.getArrayConfigByIndex(t,this.ins().WeaponBaseList)?this.getArrayConfigByIndex(t,this.ins().WeaponBaseList)[e]:void 0},t.getWeaponSwallowById=function(t,e){var i=this.getConfig("shenbing_swallow_data","WeaponSwallowList");if(i){var n=this.getArrayConfigByIndex(t,this.ins().WeaponSwallowList);if(n&&n[e])return n[e]}},t.getWeaponDanById=function(t){return this.getConfig("shenbing_danyao_data","WeaponDanList"),this.getArrayConfigByIndex(t,this.ins().WeaponDanList)},t.getWeaponBookById=function(t,e){return this.getConfig("shenbing_book_data","WeaponBookList"),this.getArrayConfigByIndex(t,this.ins().WeaponBookList)[e]},t.getWeaponResById=function(t){return this.getConfig("shenbing_res","WeaponResList"),this.getArrayConfigByIndex(t,this.ins().WeaponResList)},t.getWeaponTypeById=function(t){return this.getConfig("shenbing_type","WeaponTypeList"),this.getArrayConfigByIndex(t,this.ins().WeaponTypeList)},t.getWeaponMisc=function(){return this.getConfig("shenbing_misc_data","WeaponMisc"),this.getArrayConfigByIndex(1,this.ins().WeaponMisc)},t.getXuanBingGrowList=function(){return this.getConfig("xuanbing_grow_data","XuanBingGrowList")},t.getXuanBingGrowById=function(t,e){var i=this.getConfig("xuanbing_grow_data","XuanBingGrowList");return i&&i[t]&&i[t][e]?i[t][e]:void 0},t.getXuanBingResList=function(){return this.getConfig("xuanbing_res","XuanBingResList")},t.getXuanBingTypeList=function(){return this.getConfig("xuanbing_type","XuanBingTypeList")},t.getXuanBingBaseById=function(t,e){var i=this.getConfig("xuanbing_base_data","XuanBingBaseList");return i&&this.getArrayConfigByIndex(t,this.ins().XuanBingBaseList)?this.getArrayConfigByIndex(t,this.ins().XuanBingBaseList)[e]:null},t.getXuanBingSwallowById=function(t,e){var i=this.getConfig("xuanbing_swallow_data","XuanBingSwallowList");if(i){var n=this.getArrayConfigByIndex(t,this.ins().XuanBingSwallowList);if(n&&n[e])return n[e]}},t.getXuanBingDanById=function(t){return this.getConfig("xuanbing_danyao_data","XuanBingDanList"),this.getArrayConfigByIndex(t,this.ins().XuanBingDanList)},t.getXuanBingBookById=function(t,e){return this.getConfig("xuanbing_book_data","XuanBingBookList"),this.getArrayConfigByIndex(t,this.ins().XuanBingBookList)[e]},t.getXuanBingResById=function(t){return this.getConfig("xuanbing_res","XuanBingResList"),this.getArrayConfigByIndex(t,this.ins().XuanBingResList)},t.getXuanBingTypeById=function(t){return this.getConfig("xuanbing_type","XuanBingTypeList"),this.getArrayConfigByIndex(t,this.ins().XuanBingTypeList)},t.getXuanBingMisc=function(){return this.getConfig("xuanbing_misc_data","XuanBingMisc"),this.getArrayConfigByIndex(1,this.ins().XuanBingMisc)},t.getWingGrowList=function(){return this.getConfig("wing_grow_data","WingGrowList")},t.getWingGrowById=function(t,e){var i=this.getConfig("wing_grow_data","WingGrowList");return i&&i[t]&&i[t][e]?i[t][e]:void 0},t.getWingResList=function(){return this.getConfig("wing_res","WingResList")},t.getWingTypeList=function(){return this.getConfig("wing_type","WingTypeList")},t.getWingBaseById=function(t,e){var i=this.getConfig("wing_base_data","WingBaseList");return i&&this.getArrayConfigByIndex(t,this.ins().WingBaseList)?this.getArrayConfigByIndex(t,this.ins().WingBaseList)[e]:void 0},t.getWingSwallowById=function(t,e){var i=this.getConfig("wing_swallow_data","WingSwallowList");if(i){var n=this.getArrayConfigByIndex(t,this.ins().WingSwallowList);if(n&&n[e])return n[e]}return null},t.getWingDanById=function(t){return this.getConfig("wing_danyao_data","WingDanList"),this.getArrayConfigByIndex(t,this.ins().WingDanList)},t.getWingBookById=function(t,e){return this.getConfig("wing_book_data","WingBookList"),this.getArrayConfigByIndex(t,this.ins().WingBookList)[e]},t.getWingResById=function(t){return this.getConfig("wing_res","WingResList"),this.getArrayConfigByIndex(t,this.ins().WingResList)},t.getWingTypeById=function(t){return this.getConfig("wing_type","WingTypeList"),this.getArrayConfigByIndex(t,this.ins().WingTypeList)},t.getWingMisc=function(){return this.getConfig("wing_misc_data","WingMisc"),this.getArrayConfigByIndex(1,this.ins().WingMisc)},t.getSetup_chat_frame_dataConfig=function(t){return this.getConfig("setup_chat_frame_data","setup_chat_frame_dataConfig"),this.getArrayConfigByIndex(t,this.ins().setup_chat_frame_dataConfig)},t.getSetup_head_dataConfig=function(t){return this.getConfig("setup_head_data","setup_head_dataConfig"),this.getArrayConfigByIndex(t,this.ins().setup_head_dataConfig)},t.getSetup_head_frame_dataConfig=function(t){return this.getConfig("setup_head_frame_data","setup_head_frame_dataConfig"),this.getArrayConfigByIndex(t,this.ins().setup_head_frame_dataConfig)},t.getVip_levelConfig=function(t){return this.getConfig("vip_level","vip_levelConfig"),this.getArrayConfigByIndex(t,this.ins().vip_levelConfig)},t.getRechargeConfig=function(t){return this.getConfig("recharge","rechargeConfig"),this.getArrayConfigByIndex(t,this.ins().rechargeConfig)},t.getRechargeBagConfig=function(t){return this.getConfig("rechargeBag","rechargeBagConfig"),this.getArrayConfigByIndex(t,this.ins().rechargeBagConfig)},t.getRank_typeConfig=function(t){return this.getConfig("rank_type","Rank_typeConfig"),this.getArrayConfigByIndex(t,this.ins().Rank_typeConfig)},t.getRankTypeList=function(){return this.getConfig("rank_type","Rank_typeConfig")},t.getRank_cont_typeConfig=function(t){return this.getConfig("rank_cont_type","Rank_cont_typeConfig"),this.getArrayConfigByIndex(t,this.ins().Rank_cont_typeConfig)},t.getRankContList=function(){return this.getConfig("rank_cont_type","Rank_cont_typeConfig")},t.getRankdailyList=function(t){return this.getConfig("rank_daily_award","rank_daily_award"),this.getArrayConfigByIndex(t,this.ins().rank_daily_award)},t.getLogin_awardConfig=function(t){return this.getConfig("login_award","login_awardConfig"),this.getArrayConfigByIndex(t,this.ins().login_awardConfig)},t.getWelfare_signin_dataConfig=function(t){return this.getConfig("welfare_signin_data","welfare_signin_dataConfig"),this.getArrayConfigByIndex(t,this.ins().welfare_signin_dataConfig)},t.getOnline_awardConfig=function(t){return this.getConfig("online_award","online_awardConfig"),this.getArrayConfigByIndex(t,this.ins().online_awardConfig)},t.getWeek_card_awardConfig=function(t){return this.getConfig("week_card_award","week_card_awardConfig"),this.getArrayConfigByIndex(t,this.ins().week_card_awardConfig)},t.getWelfare_configConfig=function(t){return this.getConfig("welfare_config","welfare_configConfig"),this.getArrayConfigByIndex(t,this.ins().welfare_configConfig)},t.getMillion_award_dataConfig=function(t){return this.getConfig("million_award_data","million_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().million_award_dataConfig)},t.getMillion_award_dataConfigs=function(){return this.ins().million_award_dataConfig||this.getConfig("million_award_data","million_award_dataConfig"),this.ins().million_award_dataConfig},t.getSeven_day_award_dataConfig=function(t){return this.getConfig("seven_day_award_data","seven_day_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().seven_day_award_dataConfig)},t.getSeven_day_award_dataConfigs=function(){return this.ins().seven_day_award_dataConfig||this.getConfig("seven_day_award_data","seven_day_award_dataConfig"),this.ins().seven_day_award_dataConfig},t.getFreeGift_dataConfigs=function(){return this.ins().freeGift_dataConfigs||this.getConfig("freegift_data","freeGift_dataConfigs"),this.ins().freeGift_dataConfigs},t.getXiuDian_dataConfigs=function(){return this.ins().xiudian_dataConfigs||this.getConfig("xiudian_data","xiudian_dataConfigs"),this.ins().xiudian_dataConfigs},t.getStrongMenu=function(){return this.ins().stronger_menuConfigs||this.getConfig("stronger_menu","stronger_menuConfigs"),this.ins().stronger_menuConfigs},t.getStrategybook_dataConfigs=function(){return this.ins().strategybook_dataConfigs||this.getConfig("strategybook_data","strategybook_dataConfigs"),this.ins().strategybook_dataConfigs},t.getBeStronger_dataConfigs=function(){return this.ins().be_stronger_dataConfigs||this.getConfig("be_stronger_data","be_stronger_dataConfigs"),this.ins().be_stronger_dataConfigs},t.getBeLevelup_dataConfigs=function(){return this.ins().be_levelup_dataConfigs||this.getConfig("be_levelup_data","be_levelup_dataConfigs"),this.ins().be_levelup_dataConfigs},t.getBeEquipup_dataConfigs=function(){return this.ins().be_equipup_dataConfigs||this.getConfig("be_equipup_data","be_equipup_dataConfigs"),this.ins().be_equipup_dataConfigs},t.getStronger_remarkConfigs=function(){return this.ins().stronger_remarkConfigs||this.getConfig("stronger_remark","stronger_remarkConfigs"),this.ins().stronger_remarkConfigs},t.getSystem_open_awardConfig=function(t){return this.getConfig("system_open_award","system_open_awardConfig"),this.getArrayConfigByIndex(t,this.ins().system_open_awardConfig)},t.getSystem_open_awardConfigs=function(){return this.getConfig("system_open_award","system_open_awardConfig")},t.getfwNameById=function(t){return this.getConfig("fuwen_name","fuwenName"),this.getArrayConfigByIndex(t,this.ins().fuwenName)},t.getfwResById=function(t,e){return this.getConfig("fuwen_res","fuwenRes"),this.getArrayConfigByIndex(t,this.ins().fuwenRes)[e]},t.getfwPreById=function(t,e){return this.getConfig("fuwen_preview","fuwenPreview"),this.getArrayConfigByIndex(t,this.ins().fuwenPreview)[e]},t.getfwHoleById=function(t,e){return this.getConfig("fuwen_hole_data","fuwenHole"),this.getArrayConfigByIndex(t,this.ins().fuwenHole)[e]},t.getfwLockById=function(t){return this.getConfig("fuwen_unlock_data","fuwenUnlock"),this.getArrayConfigByIndex(t,this.ins().fuwenUnlock)},t.getfwCompById=function(t,e){return this.getConfig("fuwen_compose_data","fuwenComp"),this.getArrayConfigByIndex(t,this.ins().fuwenComp)[e]},t.getfwBaseById=function(t,e,i){var n=this.getConfig("fuwen_base_data","fuwenBase");return n[t]&&n[t][e]&&n[t][e][i]?n[t][e][i]:null},t.getfwLockList=function(){return this.getConfig("fuwen_unlock_data","fuwenUnlock")},t.getfwPreList=function(){return this.getConfig("fuwen_preview","fuwenPreview")},t.getfwCompList=function(){return this.getConfig("fuwen_compose_data","fuwenComp")},t.getfwHoleList=function(){return this.getConfig("fuwen_hole_data","fuwenHole")},t.getTeamcopy_baseConfig=function(t){return this.getConfig("teamcopy_base","teamcopy_baseConfig"),this.getArrayConfigByIndex(t,this.ins().teamcopy_baseConfig)},t.getTujian_dataConfig=function(t){return this.getConfig("tujian_data","Tujian_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Tujian_dataConfig)},t.getTujianList=function(){return this.getConfig("tujian_data","Tujian_dataConfig")},t.getTujian_level_dataConfig=function(t){return this.getConfig("tujian_level_data","Tujian_level_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Tujian_level_dataConfig)},t.getTujian_suit_dataConfig=function(t){return this.getConfig("tujian_suit_data","Tujian_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Tujian_suit_dataConfig)},t.getTujian_suit_dataList=function(){return this.getConfig("tujian_suit_data","Tujian_suit_dataConfig")},t.getMake_dataConfig=function(t){return this.getConfig("make_data","make_dataConfig"),this.getArrayConfigByIndex(t,this.ins().make_dataConfig)},t.getMakeConfig=function(){return this.getConfig("make_data","make_dataConfig")},t.getSplit_dataConfig=function(t){return this.getConfig("split_data","split_dataConfig"),this.getArrayConfigByIndex(t,this.ins().split_dataConfig)},t.getSplitConfig=function(){return this.getConfig("split_data","split_dataConfig")},t.getMake_list_dataConfig=function(t,e){return this.getConfig("make_list_data","make_list_dataConfig"),this.getArrayConfigByIndex(t,this.ins().make_list_dataConfig)[e]},t.getMake_list_dataConfigs=function(){return this.getConfig("make_list_data","make_list_dataConfig")},t.getMake_list_dataConfigById=function(t){return this.getConfig("make_list_data","make_list_dataConfig"),this.getArrayConfigByIndex(t,this.ins().make_list_dataConfig)},t.getMakeConfigByPage=function(t,e){var i=this.getMakeConfig(),n=[];for(var o in i)i[o].page==t&&i[o].sub_page==e&&n.push(i[o]);return n},t.getXyMiscData=function(){return this.getConfig("xianyuan_misc_data","xyMiscData"),this.getArrayConfigByIndex(1,this.ins().xyMiscData)},t.getXyFlowerById=function(t){return this.getConfig("xianyuan_flower_data","xyflowerList"),this.getArrayConfigByIndex(t,this.ins().xyflowerList)},t.getXyRewardById=function(t){return this.getConfig("xianyuan_award_data","xyRewardList"),this.getArrayConfigByIndex(t,this.ins().xyRewardList)},t.getXyRewardList=function(){return this.getConfig("xianyuan_award_data","xyRewardList")},t.getXyRingById=function(t){return this.getConfig("xianyuan_ring_data","xyRingList"),this.getArrayConfigByIndex(t,this.ins().xyRingList)},t.getXyHeightRingById=function(t){return this.getConfig("xianyuan_ring_high_attr_data","xyHeightRingList"),this.getArrayConfigByIndex(t,this.ins().xyHeightRingList)},t.getXySkillById=function(t,e){return this.getConfig("xianyuan_skill_data","xySkillList"),this.getArrayConfigByIndex(t,this.ins().xySkillList)[e]},t.getXyTaskById=function(t){return this.getConfig("xianyuan_task_data","xyTaskList"),this.getArrayConfigByIndex(t,this.ins().xyTaskList)},t.getXyTaskList=function(){return this.getConfig("xianyuan_task_data","xyTaskList")},t.getXyDayTaskById=function(t){return this.getConfig("xianyuan_day_task_data","xyDayTaskList"),this.getArrayConfigByIndex(t,this.ins().xyDayTaskList)},t.getXyDayTaskList=function(){return this.getConfig("xianyuan_day_task_data","xyDayTaskList")},t.getXyCopyDataById=function(t){return this.getConfig("xianyuan_copy_data","xyCopyList"),this.getArrayConfigByIndex(t,this.ins().xyCopyList)},t.getXyRemarkById=function(t){return this.getConfig("xianyuan_xiangqin_desc","xyRemark"),this.getArrayConfigByIndex(t,this.ins().xyRemark)},t.getboss_cross_scene_dataConfig=function(t){return this.getConfig("boss_cross_scene_data","boss_cross_scene_dataConfig"),this.getArrayConfigByIndex(t,this.ins().boss_cross_scene_dataConfig)},t.getBoss_cross_sceneConfig=function(){return this.getConfig("boss_cross_scene_data","boss_cross_scene_dataConfig")},t.getBoss_miscConfigById=function(t){return this.getConfig("boss_misc","boss_miscConfig"),this.getArrayConfigByIndex(t,this.ins().boss_miscConfig)},t.getBoss_miscConfig=function(){return this.getConfig("boss_misc","boss_miscConfig")},t.getTpl_effectConfigById=function(t){return this.getConfig("tpl_effect","Tpl_effectConfig"),this.getArrayConfigByIndex(t,this.ins().Tpl_effectConfig)},t.getErrCode=function(t){return this.getConfig("err_code","errCode"),this.getArrayConfigByIndex(t,this.ins().errCode)},t.getActivity_open_dataConfigById=function(t){return this.getConfig("activity_open_data","activity_open_dataConfig"),this.getArrayConfigByIndex(t,this.ins().activity_open_dataConfig)},t.getPvp_base_dataConfig=function(t){return this.getConfig("pvp_base_data","Pvp_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_base_dataConfig)},t.getPvp_vip_dataConfig=function(t){return this.getConfig("pvp_vip_data","Pvp_vip_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_vip_dataConfig)},t.getPvp_vip_dataList=function(){return this.getConfig("pvp_vip_data","Pvp_vip_dataConfig")},t.getPvp_daily_award_dataConfig=function(t){return this.getConfig("pvp_daily_award_data","Pvp_daily_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_daily_award_dataConfig)},t.getPvp_step_dataConfig=function(t){return this.getConfig("pvp_step_data","Pvp_step_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_step_dataConfig)},t.getPvp_rank_awardConfig=function(t){return this.getConfig("pvp_rank_award","Pvp_rank_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_rank_awardConfig)},t.getPvp_cross_rank_awardConfig=function(t){return this.getConfig("pvp_cross_rank_award","Pvp_cross_rank_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_cross_rank_awardConfig)},t.getPvp_top_awardConfig=function(t){return this.getConfig("pvp_top_award","Pvp_top_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_top_awardConfig)},t.getPvp_guess_dataConfig=function(t){return this.getConfig("pvp_guess_data","Pvp_guess_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Pvp_guess_dataConfig)},t.getSystemopenConfigById=function(t,e){return this.getConfig("systemopen","systemopenConfig"),this.getArrayConfigByIndex(t,this.ins().systemopenConfig)[e]},t.getSystemopenConfig=function(){return this.getConfig("systemopen","systemopenConfig")},t.getApList=function(){return this.getConfig("alive_point","apList")},t.getApRewardList=function(){return this.getConfig("alive_reward","apRewardList")},t.getApById=function(t){return this.getConfig("alive_point","apList"),this.getArrayConfigByIndex(t,this.ins().apList)},t.getApRewardById=function(t){return this.getConfig("alive_reward","apRewardList"),this.getArrayConfigByIndex(t,this.ins().apRewardList)},t.getAliveLvdataById=function(t){return this.getConfig("alive_level_data","aliveLevelData"),this.getArrayConfigByIndex(t,this.ins().aliveLevelData)},t.getAliveDescById=function(t){return this.getConfig("alive_desc","alivedesc"),this.getArrayConfigByIndex(t,this.ins().alivedesc)},t.getAchieList=function(){return this.getConfig("achievement_data","achielist")},t.getAchieById=function(t){return this.getConfig("achievement_data","achielist"),this.getArrayConfigByIndex(t,this.ins().achielist)},t.getAchieGroupList=function(){return this.getConfig("achievement_group","achiegroup")},t.getAchieGroupById=function(t){return this.getConfig("achievement_group","achiegroup"),this.getArrayConfigByIndex(t,this.ins().achiegroup)},t.getAchieLevelList=function(){return this.getConfig("achievement_level_data","achielevelList")},t.getAchieLevelById=function(t){return this.getConfig("achievement_level_data","achielevelList"),this.getArrayConfigByIndex(t,this.ins().achielevelList)},t.getZhuanViewById=function(t){return this.getConfig("zhuan_view","zhuanView"),this.getArrayConfigByIndex(t,this.ins().zhuanView)},t.getTitle_upgrade_dataListById=function(t){return this.getConfig("title_upgrade_data","Title_upgrade_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Title_upgrade_dataConfig)},t.getTitle_upgrade_dataById=function(t,e){return this.getConfig("title_upgrade_data","Title_upgrade_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Title_upgrade_dataConfig)[e]},t.getYezhanMisc=function(){return this.getConfig("yezhan_base_data","yezhan_base_data"),this.getArrayConfigByIndex(1,this.ins().yezhan_base_data)},t.getYezhanVipTimes=function(t){return this.getConfig("yezhan_vip_times","yezhan_vip_times"),this.getArrayConfigByIndex(t,this.ins().yezhan_vip_times)},t.getYezhanVipTimesList=function(){return this.getConfig("yezhan_vip_times","yezhan_vip_times")},t.getYezhanBuyData=function(t){return this.getConfig("yezhan_buy_data","yezhan_buy_data"),this.getArrayConfigByIndex(t,this.ins().yezhan_buy_data)},t.getFind_treasureConfigById=function(t,e){var i=LimitActProxy.ins().GetServerOpenDay(),n=this.getFind_treasure_globalConfigById(i);void 0==n&&(n=this.getFind_treasure_globalConfigById(0));var o=n.tab_name;return this.getConfig(o,"find_treasureConfig"),this.getArrayConfigByIndex(t,this.ins().find_treasureConfig)[e]},t.getFind_treasureConfig=function(){var t=LimitActProxy.ins().GetServerOpenDay(),e=this.getFind_treasure_globalConfigById(t);void 0==e&&(e=this.getFind_treasure_globalConfigById(0));var i=e.tab_name;return this.getConfig(i,"find_treasureConfig")},t.getFind_treasure_globalConfigById=function(t){return this.getConfig("find_treasure_global","find_treasure_globalConfig"),this.getArrayConfigByIndex(t,this.ins().find_treasure_globalConfig)},t.getTreasure_dataConfigById=function(t){return this.getConfig("treasure_data","treasure_dataConfig"),this.getArrayConfigByIndex(t,this.ins().treasure_dataConfig)},t.getTreasure_dataConfigByIndex=function(t){this.ins().treasure_dataConfig||this.getConfig("treasure_data","treasure_dataConfig");for(var e in this.ins().treasure_dataConfig)if(this.ins().treasure_dataConfig[e].index==t)return this.ins().treasure_dataConfig[e]},t.getTreasure_dataConfig=function(){return this.ins().treasure_dataConfig||this.getConfig("treasure_data","treasure_dataConfig"),this.ins().treasure_dataConfig},t.getSpecial_rightsConfig=function(t){return this.getConfig("special_rights","Special_rightsConfig"),this.getArrayConfigByIndex(t,this.ins().Special_rightsConfig)},t.getSpecial_rights_base_dataConfig=function(t){return this.getConfig("special_rights_base_data","Special_rights_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Special_rights_base_dataConfig)},t.getSpecial_rights_skill_dataConfig=function(t){return this.getConfig("special_rights_skill_data","Special_rights_skill_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Special_rights_skill_dataConfig)},t.getBaoku_dataConfig=function(t){return this.getConfig("baoku_data","Baoku_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Baoku_dataConfig)},t.getBaoku_cell_dataConfig=function(t){return this.getConfig("baoku_cell_data","Baoku_cell_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Baoku_cell_dataConfig)},t.getActivity_dataConfig=function(t){return this.getConfig("activity_data","Activity_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Activity_dataConfig)},t.getContinuousAct_idConfig=function(t){return this.getConfig("ContinuousAct_id","ContinuousAct_idConfig"),this.getArrayConfigByIndex(t,this.ins().ContinuousAct_idConfig)},t.getContinuousAct_idConfigList=function(){return this.getConfig("ContinuousAct_id","ContinuousAct_idConfig")},t.getActivitydataList=function(){return this.getConfig("activity_data","Activity_dataConfig")},t.getOpenserver_viewtabConfig=function(t){return this.getConfig("openserver_viewtab","Openserver_viewtabConfig"),this.getArrayConfigByIndex(t,this.ins().Openserver_viewtabConfig)},t.getOpenServerViewTab=function(){return this.getConfig("openserver_viewtab","Openserver_viewtabConfig")},t.getKuafu_viewtabConfig=function(t){return this.getConfig("kuafu_viewtab","Kuafu_viewtabConfig"),this.getArrayConfigByIndex(t,this.ins().Kuafu_viewtabConfig)},t.getKuafuViewTab=function(){return this.getConfig("kuafu_viewtab","Kuafu_viewtabConfig")},t.getJc_actviewtabConfig=function(t){return this.getConfig("jc_actviewtab","Jc_actviewtabConfig"),this.getArrayConfigByIndex(t,this.ins().Jc_actviewtabConfig)},t.getJCViewTab=function(){return this.getConfig("jc_actviewtab","Jc_actviewtabConfig")},t.getJieri_actviewtabConfig=function(t){return this.getConfig("jieri_actviewtab","Jieri_actviewtabConfig"),this.getArrayConfigByIndex(t,this.ins().Jieri_actviewtabConfig)},t.getJieRiViewTab=function(){return this.getConfig("jieri_actviewtab","Jieri_actviewtabConfig")},t.getLimitedGifstabConfig=function(t){return this.getConfig("limited_Gifs_viewtab","Limited_Gifs_viewtabConfig"),this.getArrayConfigByIndex(t,this.ins().Limited_Gifs_viewtabConfig)},t.getLimitedGifsViewTab=function(){return this.getConfig("limited_Gifs_viewtab","Limited_Gifs_viewtabConfig")},t.getRushGifs_dataConfig=function(){var t=LimitActProxy.ins().GetServerOpenDay(),e=this.getConfig("activity_data","Activity_dataConfig"),i=[];for(var n in e)4==e[n].open_type&&98==e[n].sub_type&&e[n].server_open_time[0]==t-1&&i.push(e[n]);var o=function(t,e){var i=3600*t.open_time[0]+60*t.open_time[0]+t.open_time[0],n=3600*e.open_time[0]+60*e.open_time[0]+e.open_time[0];return i>n?1:n>i?-1:void 0};return i.sort(o),i},t.getLimit_act_gift_dataConfig=function(t){return this.getConfig("limit_act_gift_data","Limit_act_gift_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Limit_act_gift_dataConfig)},t.getLimitActGiftList=function(){return this.getConfig("limit_act_gift_data","Limit_act_gift_dataConfig")},t.getTeamcopy_kill_monster_award=function(t){return this.getConfig("teamcopy_kill_monster_award","teamcopy_kill_monster_awardConfig"),this.getArrayConfigByIndex(t,this.ins().teamcopy_kill_monster_awardConfig)},t.getTeamcopy_kill_monster_awards=function(){return this.ins().teamcopy_kill_monster_awardConfig||this.getConfig("teamcopy_kill_monster_award","teamcopy_kill_monster_awardConfig"),this.ins().teamcopy_kill_monster_awardConfig},t.getMail_dataConfig=function(t){return this.getConfig("mail_data","mail_dataConfig"),this.getArrayConfigByIndex(t,this.ins().mail_dataConfig)},t.getXianLimitActList=function(){return this.getConfig("xian_limit_act","Xian_limit_actConfig")},t.getNewhandConfig=function(t){return this.getConfig("newhand","newhandConfig"),this.getArrayConfigByIndex(t,this.ins().newhandConfig)},t.getNewhandConfigs=function(){return this.getConfig("newhand","newhandConfig")},t.getNewhand_stepConfig=function(t){return this.getConfig("newhand_step","newhand_stepConfig"),this.getArrayConfigByIndex(t,this.ins().newhand_stepConfig)},t.getNewhand_stepConfigs=function(){return this.getConfig("newhand_step","newhand_stepConfig")},t.getInvenst_dataConfig=function(t){return this.getConfig("invenst_data","Invenst_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Invenst_dataConfig)},t.getInvenstAwardDataConfigs=function(t){return this.getConfig("invenst_award_data","Invenst_award_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Invenst_award_dataConfig)},t.getVip_online_awardConfig=function(t){return this.getConfig("vip_online_award","Vip_online_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Vip_online_awardConfig)},t.getOnlineAwardConfigs=function(){return this.getConfig("vip_online_award","Vip_online_awardConfig")},t.getMain_systemConfig=function(t){return this.getConfig("main_system","main_systemConfig"),this.getArrayConfigByIndex(t,this.ins().main_systemConfig)},t.getMain_systemConfigs=function(){if(!this.ins().main_systemConfigList){this.getConfig("main_system","main_systemConfig");var t=[];for(var e in this.ins().main_systemConfig)t.push(this.ins().main_systemConfig[e]);var i=function(t,e){return t.direction>e.direction?1:t.direction<e.direction?-1:t.rank>e.rank?1:-1};t.sort(i),this.ins().main_systemConfigList=t}return this.ins().main_systemConfigList},t.getMainsystemByName=function(t){for(var e=this.getMain_systemConfigs(),i=0;i<e.length;++i)if(e[i].name==t)return e[i]},t.getVip_chat_dataConfig=function(t){return this.getConfig("vip_chat_data","vip_chat_dataConfig"),this.getArrayConfigByIndex(t,this.ins().vip_chat_dataConfig)},t.getTpl_ScreencharConfigs=function(){this.ins().tpl_ScreencharConfigConfig||this.getConfig("tpl_Screenchar","tpl_ScreencharConfigConfig"),this.ins().screenchar=[];for(var t in this.ins().tpl_ScreencharConfigConfig){var e=this.ins().tpl_ScreencharConfigConfig[t]._tex,i=e.split("、");if(i)for(var n=0;n<i.length;++n)i[n].length>0&&this.ins().screenchar.push(i[n])}},t.getCopy_miscConfig=function(t){return this.getConfig("copy_misc","copy_miscConfig"),this.getArrayConfigByIndex(t,this.ins().copy_miscConfig)},t.getLimit_bossConfig=function(t){return this.getConfig("limit_boss","limit_bossConfig"),this.getArrayConfigByIndex(t,this.ins().limit_bossConfig)},t.getLimit_bossConfigs=function(){return this.getConfig("limit_boss","limit_bossConfig")},t.getTrial_bossConfig=function(t){return this.getConfig("trial_boss","trial_bossConfig"),this.getArrayConfigByIndex(t,this.ins().trial_bossConfig)},t.getTrial_bossConfigs=function(){return this.getConfig("trial_boss","trial_bossConfig")
},t.getTrial_bossConfigsLength=function(){var t=this.getConfig("trial_boss","trial_bossConfig"),e=[];if(void 0==t)return 0;for(var i in t)e.push(t[i]);return e.length},t.getTreasure_base_dataConfig=function(t){return this.getConfig("treasure_base_data","Treasure_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Treasure_base_dataConfig)},t.getTreasure_base_dataList=function(){return this.getConfig("treasure_base_data","Treasure_base_dataConfig")},t.getTreasure_part_dataConfig=function(t){return this.getConfig("treasure_part_data","Treasure_part_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Treasure_part_dataConfig)},t.getMcRobotList=function(){return this.getConfig("maincity_robot","Maincity_robotConfig")},t.getMcRobotPathList=function(t){return this.getConfig("maincity_robot_path","Maincity_robot_pathConfig"),this.getArrayConfigByIndex(t,this.ins().Maincity_robot_pathConfig)},t.getLimit_time_act_dataConfig=function(t,e){return this.getConfig("limit_time_act_data","limit_time_act_dataConfig"),this.getArrayConfigByIndex(t,this.ins().limit_time_act_dataConfig)?this.getArrayConfigByIndex(t,this.ins().limit_time_act_dataConfig)[e]:void 0},t.getLimit_time_act_dataConfigById=function(t){return this.getConfig("limit_time_act_data","limit_time_act_dataConfig"),this.getArrayConfigByIndex(t,this.ins().limit_time_act_dataConfig)},t.getFight_up_dataConfigList=function(){return this.getConfig("fight_up_data","Fight_up_dataConfig")},t.getFight_up_dataConfigsById=function(t){return this.getConfig("fight_up_data","Fight_up_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Fight_up_dataConfig)},t.getBaowu_exp_item_dataConfigById=function(t){return this.getConfig("baowu_exp_item_data","baowu_exp_item_dataConfig"),this.getArrayConfigByIndex(t,this.ins().baowu_exp_item_dataConfig)},t.getBaowu_exp_item_dataConfigs=function(){return this.getConfig("baowu_exp_item_data","baowu_exp_item_dataConfig")},t.getBaowu_base_dataConfigBylvl=function(t,e){return this.getConfig("baowu_base_data","baowu_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().baowu_base_dataConfig)[e]},t.getBaowu_base_dataConfigsById=function(t){return this.getConfig("baowu_base_data","baowu_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().baowu_base_dataConfig)},t.getBaowu_base_dataConfigs=function(){return this.getConfig("baowu_base_data","baowu_base_dataConfig")},t.getBaowu_swallow_item_attrConfigByid=function(t){return this.getConfig("baowu_swallow_item_attr","baowu_swallow_item_attrConfig"),this.getArrayConfigByIndex(t,this.ins().baowu_swallow_item_attrConfig)},t.getBaowu_swallow_item_attrConfigs=function(){return this.getConfig("baowu_swallow_item_attr","baowu_swallow_item_attrConfig")},t.getLottery_base_dataConfig=function(t){return this.getConfig("lottery_base_data","Lottery_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Lottery_base_dataConfig)},t.getLottery_item_dataList=function(t,e){return this.getConfig("lottery_item_data","Lottery_item_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Lottery_item_dataConfig)[e]},t.getLottery_box_dataConfig=function(t,e){return this.getConfig("lottery_box_data","Lottery_box_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Lottery_box_dataConfig)[e]},t.getLottery_recharge_rank_awardConfig=function(){return this.getConfig("lottery_recharge_rank_award","Lottery_recharge_rank_awardConfig"),this.ins().Lottery_recharge_rank_awardConfig},t.getRefine_suit_dataConfig=function(t){return this.getConfig("refine_suit_data","Refine_suit_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Refine_suit_dataConfig)},t.getRefine_star_dataConfig=function(t){return this.getConfig("refine_star_data","Refine_star_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Refine_star_dataConfig)},t.getRefine_part_attr_dataConfig=function(t){return this.getConfig("refine_part_attr_data","Refine_part_attr_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Refine_part_attr_dataConfig)},t.getRefine_attr_dataConfig=function(t){return this.getConfig("refine_attr_data","Refine_attr_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Refine_attr_dataConfig)},t.getDujieBaseById=function(t,e){var i=this.getConfig("dujie_base_data","dujiedata");return i[t]&&i[t][e]?this.getArrayConfigByIndex(t,this.ins().dujiedata)[e]:void 0},t.getDujieTaskById=function(t){return this.getConfig("dujie_task_data","dujietaskdata"),this.getArrayConfigByIndex(t,this.ins().dujietaskdata)},t.getDujieDescById=function(t){return this.getConfig("dujie_desc","dujiedesc"),this.getArrayConfigByIndex(t,this.ins().dujiedesc)},t.getDujieCopyById=function(t,e){var i=this.getConfig("dujie_copy_data","dujiecopydata");return i[t]&&i[t][e]?this.getArrayConfigByIndex(t,this.ins().dujiecopydata)[e]:void 0},t.getBoss_times_dataConfig=function(){return this.getConfig("boss_times_data","boss_times_dataConfig")},t.getBoss_times_dataConfigById=function(t){return this.ins().boss_times_dataConfig||this.getBoss_times_dataConfig(),this.getArrayConfigByIndex(t,this.ins().boss_times_dataConfig)},t.getFabao_suit_dataList=function(){return this.getConfig("fabao_suit_data","Fabao_suit_dataConfig")},t.getFabao_suit_dataConfigById=function(t,e){return this.ins().Fabao_suit_dataConfig||this.getFabao_suit_dataList(),this.getArrayConfigByIndex(t,this.ins().Fabao_suit_dataConfig)[e]},t.getTzById=function(t){return this.getConfig("taozhuang_base_data","taozhuang_list"),this.getArrayConfigByIndex(t,this.ins().taozhuang_list)},t.getTzList=function(){return this.getConfig("taozhuang_base_data","taozhuang_list")},t.getTzAttrById=function(t,e){var i=this.getConfig("taozhuang_attr_data","taozhuang_attr_list");return i&&i[t]&&i[t][e]?i[t][e]:null},t.getTzAttrList=function(t){return this.getConfig("taozhuang_attr_data","taozhuang_attr_list"),this.getArrayConfigByIndex(t,this.ins().taozhuang_attr_list)},t.getzbTzById=function(t){return this.getConfig("equip_suit_base_data","zbTaozhuang_list"),this.getArrayConfigByIndex(t,this.ins().zbTaozhuang_list)},t.getZbTzList=function(){return this.getConfig("equip_suit_base_data","zbTaozhuang_list")},t.getZbTzAttrById=function(t,e){var i=this.getConfig("equip_suit_attr_data","zbTaozhuang_Attr_data");return i&&i[t]&&i[t][e]?i[t][e]:null},t.getZbTzAttrList=function(t){return this.getConfig("equip_suit_attr_data","zbTaozhuang_Attr_data"),this.getArrayConfigByIndex(t,this.ins().zbTaozhuang_Attr_data)},t.getEquip_swallow_dataConfig=function(t){return this.getConfig("equip_swallow_data","Equip_swallow_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Equip_swallow_dataConfig)},t.getEquip_swallow_item_dataConfig=function(t){return this.getConfig("equip_swallow_item_data","Equip_swallow_item_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Equip_swallow_item_dataConfig)},t.getFirst_rank_index_dataList=function(){return this.getConfig("first_rank_index_data","First_rank_index_dataConfig")},t.getuse_timesConfig=function(t){return this.getConfig("use_times","use_timesConfig"),this.getArrayConfigByIndex(t,this.ins().use_timesConfig)},t.getSmGiftListConfig=function(t){return this.getConfig("shenmi_gift_list","sm_giftListConfigs"),this.getArrayConfigByIndex(t,this.ins().sm_giftListConfigs)},t.getShengwu_items_dataById=function(t){return this.getConfig("shengwu_items_data","shengwu_items_data"),this.getArrayConfigByIndex(t,this.ins().shengwu_items_data)},t.getShengwu_misc_dataById=function(t){return this.getConfig("shengwu_misc_data","shengwu_misc_data"),this.getArrayConfigByIndex(t,this.ins().shengwu_misc_data)},t.getShengwu_items_dataAll=function(){return this.getConfig("shengwu_items_data","shengwu_items_dataAll")},t.getShengwu_soul_dataAll=function(){return this.getConfig("shengwu_soul_data","shengwu_soul_dataAll")},t.getShengwu_soul_dataById=function(t){return this.getConfig("shengwu_soul_data","shengwu_soul_data"),this.getArrayConfigByIndex(t,this.ins().shengwu_soul_data)},t.getShengwu_soul_attr_dataByIdAndnum=function(t,e){var i=this.getConfig("shengwu_soul_attr_data","shengwu_soul_attr_data");return i&&i[t]&&i[t][e]?i[t][e]:null},t.getShengwu_exp_dataById=function(t){return this.getConfig("shengwu_exp_data","shengwu_exp_data"),this.getArrayConfigByIndex(t,this.ins().shengwu_exp_data)},t.getShengwu_suit_dataById=function(t){return this.getConfig("shengwu_suit_data","shengwu_suit_data"),this.getArrayConfigByIndex(t,this.ins().shengwu_suit_data)},t.getShengwu_suit_dataAll=function(){return this.getConfig("shengwu_suit_data","shengwu_suit_dataAll")},t.getShengwu_skill_dataById=function(t){return this.getConfig("shengwu_skill_data","shengwu_skill_data"),this.getArrayConfigByIndex(t,this.ins().shengwu_skill_data)},t.getShengwu_skill_dataAll=function(){return this.getConfig("shengwu_skill_data","shengwu_skill_data")},t.getFaction_attack_base_dataConfig=function(t){return this.getConfig("faction_attack_base_data","Faction_attack_base_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_attack_base_dataConfig)},t.getFaction_attack_rank_awardConfig=function(t){return this.getConfig("faction_attack_rank_award","Faction_attack_rank_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_attack_rank_awardConfig)},t.getFaction_attack_rank_awardList=function(){return this.getConfig("faction_attack_rank_award","Faction_attack_rank_awardConfig")},t.getFaction_attack_score_awardConfig=function(t){return this.getConfig("faction_attack_score_award","Faction_attack_score_awardConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_attack_score_awardConfig)},t.getFaction_attack_score_awardList=function(){return this.getConfig("faction_attack_score_award","Faction_attack_score_awardConfig")},t.getFaction_attack_relive_dataConfig=function(t){return this.getConfig("faction_attack_relive_data","Faction_attack_relive_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_attack_relive_dataConfig)},t.getFaction_attack_relive_dataList=function(){return this.getConfig("faction_attack_relive_data","Faction_attack_relive_dataConfig")},t.getFaction_attack_monster_dataConfig=function(t){return this.getConfig("faction_attack_monster_data","Faction_attack_monster_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_attack_monster_dataConfig)},t.getFaction_attack_monster_dataList=function(){return this.getConfig("faction_attack_monster_data","Faction_attack_monster_dataConfig")},t.getFaction_attack_path_dataConfig=function(t){return this.getConfig("faction_attack_path_data","Faction_attack_path_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_attack_path_dataConfig)},t.getFaction_attack_path_dataList=function(){return this.getConfig("faction_attack_path_data","Faction_attack_path_dataConfig")},t.getFaction_defend_path_dataConfig=function(t){return this.getConfig("faction_defend_path_data","Faction_defend_path_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Faction_defend_path_dataConfig)},t.GetVIPCopyConfig=function(){if(void 0==this.VIPConfig){this.VIPConfig=[];var t=this.getConfig("copy_data","CopyDataConfig");for(var e in t){var i=t[e];void 0!=i.vip_level&&i.vip_level>0&&101==i.show_copy_type&&this.VIPConfig.push(i)}}return this.VIPConfig},t.getscene_drop_ratio_data=function(t,e){return this.getConfig("scene_drop_ratio_data","scene_drop_ratio_dataConfig"),this.getArrayConfigByIndex(t,this.ins().scene_drop_ratio_dataConfig)?this.getArrayConfigByIndex(t,this.ins().scene_drop_ratio_dataConfig)[e]:null},t.getscene_drop_ratio_dataConfigs=function(){return this.getConfig("scene_drop_ratio_data","scene_drop_ratio_dataConfig")},t.getscene_drop_ratio_dataConfigByZhuan=function(t,e){var i=this.getscene_drop_ratio_dataConfigs();for(var n in i)if(t.toString()==n){var o=(RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),i[n]);for(var s in o)if(o[s].zhuan[0]<=e&&o[s].zhuan[1]>=e)return o[s]}return null},t.getDailytask_base_dataConfigs=function(){return this.getConfig("dailytask_base_data","dailytask_base_dataConfigs")},t.getDailytask_base_dataConfig=function(t){return this.getConfig("dailytask_base_data","dailytask_base_dataConfigs"),this.getArrayConfigByIndex(t,this.ins().dailytask_base_dataConfigs)},t.getDailytask_misc_dataConfig=function(t){return this.getConfig("dailytask_misc_data","dailytask_misc_dataConfigs"),this.getArrayConfigByIndex(t,this.ins().dailytask_misc_dataConfigs)},t.getXianwei_base_dataConfig=function(t){return this.getConfig("xianwei_base_data","xianwei_base_dataConfigs"),this.getArrayConfigByIndex(t,this.ins().xianwei_base_dataConfigs)},t.getwelfare_login_online_awardConfigs=function(){return this.getConfig("welfare_login_online_award","welfare_login_online_awardConfigs")},t.getWelfare_login_online_awardConfig=function(t){return this.getConfig("welfare_login_online_award","welfare_login_online_awardConfigs"),this.getArrayConfigByIndex(t,this.ins().welfare_login_online_awardConfigs)},t.getWelfare_share_acc_awardConfigs=function(){return this.getConfig("welfare_share_acc_award","welfare_share_acc_awardConfigs")},t.getWelfare_share_acc_awardConfig=function(t){return this.getConfig("welfare_share_acc_award","welfare_share_acc_awardConfigs"),this.getArrayConfigByIndex(t,this.ins().welfare_share_acc_awardConfigs)},t.getSoulforge_part_dataConfig=function(t){return this.getConfig("soulforge_part_data","Soulforge_part_dataConfig"),this.getArrayConfigByIndex(t,this.ins().Soulforge_part_dataConfig)},t.getSoulforge_itemsConfig=function(t){return this.getConfig("soulforge_items","Soulforge_itemsConfig"),this.getArrayConfigByIndex(t,this.ins().Soulforge_itemsConfig)},t.getSoulforge_swallowConfig=function(t){return this.getConfig("soulforge_swallow","Soulforge_swallowConfig"),this.getArrayConfigByIndex(t,this.ins().Soulforge_swallowConfig)},t.getSoulforge_swallow_itemsConfig=function(t){return this.getConfig("soulforge_swallow_items","Soulforge_swallow_itemsConfig"),this.getArrayConfigByIndex(t,this.ins().Soulforge_swallow_itemsConfig)},t.getSoulforge_attr_dataConfig=function(t,e){this.getConfig("soulforge_attr_data","Soulforge_attr_dataConfig");var i=this.getArrayConfigByIndex(e,this.ins().Soulforge_attr_dataConfig);return i[t.toString()]},t.prelist=["view_destroy_res","misc_data","tpl_view","systemopen","datatpl_name","tpl_Screenchar","server","servergroup","servermark","tpl_Screenchar","comcolor"],t.zhuanMaxStage=0,t}();__reflect(GlobalConfig.prototype,"GlobalConfig");var DropItem=function(){function t(){}return t}();__reflect(DropItem.prototype,"DropItem");var God_forge_dataConfig=function(){function t(){}return t}();__reflect(God_forge_dataConfig.prototype,"God_forge_dataConfig");var God_forge_suit_dataConfig=function(){function t(){}return t}();__reflect(God_forge_suit_dataConfig.prototype,"God_forge_suit_dataConfig");var God_item_suitConfig=function(){function t(){}return t}();__reflect(God_item_suitConfig.prototype,"God_item_suitConfig");var God_make_dataConfig=function(){function t(){}return t}();__reflect(God_make_dataConfig.prototype,"God_make_dataConfig");var God_soul_dataConfig=function(){function t(){}return t}();__reflect(God_soul_dataConfig.prototype,"God_soul_dataConfig");var Guide_defConfig=function(){function t(){}return t}();__reflect(Guide_defConfig.prototype,"Guide_defConfig");var Hang_pathConfig=function(){function t(){}return t}();__reflect(Hang_pathConfig.prototype,"Hang_pathConfig");var Help_defConfig=function(){function t(){}return t}();__reflect(Help_defConfig.prototype,"Help_defConfig");var Horse_base_dataConfig=function(){function t(){}return t}();__reflect(Horse_base_dataConfig.prototype,"Horse_base_dataConfig");var Horse_equip_suit_dataConfig=function(){function t(){}return t}();__reflect(Horse_equip_suit_dataConfig.prototype,"Horse_equip_suit_dataConfig");var Horse_grade_critConfig=function(){function t(){}return t}();__reflect(Horse_grade_critConfig.prototype,"Horse_grade_critConfig");var Horse_grade_matrialConfig=function(){function t(){}return t}();__reflect(Horse_grade_matrialConfig.prototype,"Horse_grade_matrialConfig");var Horse_grade_showConfig=function(){function t(){}return t}();__reflect(Horse_grade_showConfig.prototype,"Horse_grade_showConfig");var Horse_skill_dataConfig=function(){function t(){}return t}();__reflect(Horse_skill_dataConfig.prototype,"Horse_skill_dataConfig");var Horse_skill_upgradeConfig=function(){function t(){}return t}();__reflect(Horse_skill_upgradeConfig.prototype,"Horse_skill_upgradeConfig");var Horse_skin_dataConfig=function(){function t(){}return t}();__reflect(Horse_skin_dataConfig.prototype,"Horse_skin_dataConfig");var Horse_skin_ex_dataConfig=function(){function t(){}return t}();__reflect(Horse_skin_ex_dataConfig.prototype,"Horse_skin_ex_dataConfig");var Horse_skin_extend_dataConfig=function(){function t(){}return t}();__reflect(Horse_skin_extend_dataConfig.prototype,"Horse_skin_extend_dataConfig");var Horse_swallow_extendConfig=function(){function t(){}return t}();__reflect(Horse_swallow_extendConfig.prototype,"Horse_swallow_extendConfig");var Horse_swallow_itemConfig=function(){function t(){}return t}();__reflect(Horse_swallow_itemConfig.prototype,"Horse_swallow_itemConfig");var Horse_vip_critConfig=function(){function t(){}return t}();__reflect(Horse_vip_critConfig.prototype,"Horse_vip_critConfig");var Injectsoul_attr_dataConfig=function(){function t(){}return t}();__reflect(Injectsoul_attr_dataConfig.prototype,"Injectsoul_attr_dataConfig");var Injectsoul_itemsConfig=function(){function t(){}return t}();__reflect(Injectsoul_itemsConfig.prototype,"Injectsoul_itemsConfig");var Injectsoul_part_dataConfig=function(){function t(){}return t}();__reflect(Injectsoul_part_dataConfig.prototype,"Injectsoul_part_dataConfig");var Injectsoul_swallow_itemsConfig=function(){function t(){}return t}();__reflect(Injectsoul_swallow_itemsConfig.prototype,"Injectsoul_swallow_itemsConfig");var Injectsoul_swallowConfig=function(){function t(){}return t}();__reflect(Injectsoul_swallowConfig.prototype,"Injectsoul_swallowConfig");var Inner_dataConfig=function(){function t(){}return t}();__reflect(Inner_dataConfig.prototype,"Inner_dataConfig");var Inner_miscConfig=function(){function t(){}return t}();__reflect(Inner_miscConfig.prototype,"Inner_miscConfig");var Intensify_part_attrConfig=function(){function t(){}return t}();__reflect(Intensify_part_attrConfig.prototype,"Intensify_part_attrConfig");var Intensify_part_dataConfig=function(){function t(){}return t}();__reflect(Intensify_part_dataConfig.prototype,"Intensify_part_dataConfig");var Intensify_suit_dataConfig=function(){function t(){}return t}();__reflect(Intensify_suit_dataConfig.prototype,"Intensify_suit_dataConfig");var Invenst_award_dataConfig=function(){function t(){}return t}();__reflect(Invenst_award_dataConfig.prototype,"Invenst_award_dataConfig");var Invenst_dataConfig=function(){function t(){}return t}();__reflect(Invenst_dataConfig.prototype,"Invenst_dataConfig");var ItemsConfig=function(){function t(){}return t}();__reflect(ItemsConfig.prototype,"ItemsConfig");var Jc_actviewtabConfig=function(){function t(){}return t}();__reflect(Jc_actviewtabConfig.prototype,"Jc_actviewtabConfig");var Jieri_actviewtabConfig=function(){function t(){}return t}();__reflect(Jieri_actviewtabConfig.prototype,"Jieri_actviewtabConfig");var Kuafu_viewtabConfig=function(){function t(){}return t}();__reflect(Kuafu_viewtabConfig.prototype,"Kuafu_viewtabConfig");var Leader_battle_base_dataConfig=function(){function t(){}return t}();__reflect(Leader_battle_base_dataConfig.prototype,"Leader_battle_base_dataConfig");var Leader_battle_title_dataConfig=function(){function t(){}return t}();__reflect(Leader_battle_title_dataConfig.prototype,"Leader_battle_title_dataConfig");var Leader_battle_vip_buy_dataConfig=function(){function t(){}return t}();__reflect(Leader_battle_vip_buy_dataConfig.prototype,"Leader_battle_vip_buy_dataConfig");var Learn_skillConfig=function(){function t(){}return t}();__reflect(Learn_skillConfig.prototype,"Learn_skillConfig");var Leitai_misc_dataConfig=function(){function t(){}return t}();__reflect(Leitai_misc_dataConfig.prototype,"Leitai_misc_dataConfig");var Leitai_mobai_dataConfig=function(){function t(){}return t}();__reflect(Leitai_mobai_dataConfig.prototype,"Leitai_mobai_dataConfig");var Leitai_rank_awardConfig=function(){function t(){}return t}();__reflect(Leitai_rank_awardConfig.prototype,"Leitai_rank_awardConfig");var Leitai_tequanConfig=function(){function t(){}return t}();__reflect(Leitai_tequanConfig.prototype,"Leitai_tequanConfig");var Limit_act_gift_dataConfig=function(){function t(){}return t}();__reflect(Limit_act_gift_dataConfig.prototype,"Limit_act_gift_dataConfig");var Limit_bossConfig=function(){function t(){}return t}();__reflect(Limit_bossConfig.prototype,"Limit_bossConfig");var Limit_time_act_dataConfig=function(){function t(){}return t}();__reflect(Limit_time_act_dataConfig.prototype,"Limit_time_act_dataConfig");var Limited_Gifs_viewtabConfig=function(){function t(){}return t}();__reflect(Limited_Gifs_viewtabConfig.prototype,"Limited_Gifs_viewtabConfig");var LimitsConfig=function(){function t(){}return t}();__reflect(LimitsConfig.prototype,"LimitsConfig");var Login_awardConfig=function(){function t(){}return t}();__reflect(Login_awardConfig.prototype,"Login_awardConfig");var Lottery_base_dataConfig=function(){function t(){}return t}();__reflect(Lottery_base_dataConfig.prototype,"Lottery_base_dataConfig");var Lottery_box_dataConfig=function(){function t(){}return t}();__reflect(Lottery_box_dataConfig.prototype,"Lottery_box_dataConfig");var Lottery_item_dataConfig=function(){function t(){}return t}();__reflect(Lottery_item_dataConfig.prototype,"Lottery_item_dataConfig");var Lottery_recharge_rank_awardConfig=function(){function t(){}return t}();__reflect(Lottery_recharge_rank_awardConfig.prototype,"Lottery_recharge_rank_awardConfig");var Lyh_copyConfig=function(){function t(){}return t}();__reflect(Lyh_copyConfig.prototype,"Lyh_copyConfig");var Lyh_layer_dataConfig=function(){function t(){}return t}();__reflect(Lyh_layer_dataConfig.prototype,"Lyh_layer_dataConfig");var Lyh_miscConfig=function(){function t(){}return t}();__reflect(Lyh_miscConfig.prototype,"Lyh_miscConfig");var Lyh_offline_item_dataConfig=function(){function t(){}return t}();__reflect(Lyh_offline_item_dataConfig.prototype,"Lyh_offline_item_dataConfig");var Lyh_rewardsConfig=function(){function t(){}return t}();__reflect(Lyh_rewardsConfig.prototype,"Lyh_rewardsConfig");var Lyh_sweep_dataConfig=function(){function t(){}return t}();__reflect(Lyh_sweep_dataConfig.prototype,"Lyh_sweep_dataConfig");var Lyh_vip_dataConfig=function(){function t(){}return t}();__reflect(Lyh_vip_dataConfig.prototype,"Lyh_vip_dataConfig");var Mail_dataConfig=function(){function t(){}return t}();__reflect(Mail_dataConfig.prototype,"Mail_dataConfig");var Main_systemConfig=function(){function t(){}return t}();__reflect(Main_systemConfig.prototype,"Main_systemConfig");var Maincity_robot_pathConfig=function(){function t(){}return t}();__reflect(Maincity_robot_pathConfig.prototype,"Maincity_robot_pathConfig");var Maincity_robotConfig=function(){function t(){}return t}();__reflect(Maincity_robotConfig.prototype,"Maincity_robotConfig");var Make_dataConfig=function(){function t(){}return t}();__reflect(Make_dataConfig.prototype,"Make_dataConfig");var Make_list_dataConfig=function(){function t(){}return t}();__reflect(Make_list_dataConfig.prototype,"Make_list_dataConfig");var Mate_base_dataConfig=function(){function t(){}return t}();__reflect(Mate_base_dataConfig.prototype,"Mate_base_dataConfig");var Mate_equip_suit_dataConfig=function(){function t(){}return t}();__reflect(Mate_equip_suit_dataConfig.prototype,"Mate_equip_suit_dataConfig");var Mate_grade_critConfig=function(){function t(){}return t}();__reflect(Mate_grade_critConfig.prototype,"Mate_grade_critConfig");var Mate_grade_matrialConfig=function(){function t(){}return t}();__reflect(Mate_grade_matrialConfig.prototype,"Mate_grade_matrialConfig");var Mate_grade_showConfig=function(){function t(){}return t}();__reflect(Mate_grade_showConfig.prototype,"Mate_grade_showConfig");var Mate_skill_dataConfig=function(){function t(){}return t}();__reflect(Mate_skill_dataConfig.prototype,"Mate_skill_dataConfig");var Mate_skill_upgradeConfig=function(){function t(){}return t}();__reflect(Mate_skill_upgradeConfig.prototype,"Mate_skill_upgradeConfig");var Mate_skin_dataConfig=function(){function t(){}return t}();__reflect(Mate_skin_dataConfig.prototype,"Mate_skin_dataConfig");var Mate_skin_ex_dataConfig=function(){function t(){}return t}();__reflect(Mate_skin_ex_dataConfig.prototype,"Mate_skin_ex_dataConfig");var Mate_skin_extend_dataConfig=function(){function t(){}return t}();__reflect(Mate_skin_extend_dataConfig.prototype,"Mate_skin_extend_dataConfig");var Mate_swallow_extendConfig=function(){function t(){}return t}();__reflect(Mate_swallow_extendConfig.prototype,"Mate_swallow_extendConfig");var Mate_swallow_itemConfig=function(){function t(){}return t}();__reflect(Mate_swallow_itemConfig.prototype,"Mate_swallow_itemConfig");var Mate_vip_critConfig=function(){function t(){}return t}();__reflect(Mate_vip_critConfig.prototype,"Mate_vip_critConfig");var Melt_dataConfig=function(){function t(){}return t}();__reflect(Melt_dataConfig.prototype,"Melt_dataConfig");var Million_award_dataConfig=function(){function t(){}return t}();__reflect(Million_award_dataConfig.prototype,"Million_award_dataConfig");var Misc_dataConfig=function(){function t(){}return t}();__reflect(Misc_dataConfig.prototype,"Misc_dataConfig");var Monster_aiConfig=function(){function t(){}return t}();__reflect(Monster_aiConfig.prototype,"Monster_aiConfig");var MonsterConfig=function(){function t(){}return t}();__reflect(MonsterConfig.prototype,"MonsterConfig");var Newhand_miscConfig=function(){function t(){}return t}();__reflect(Newhand_miscConfig.prototype,"Newhand_miscConfig");var Newhand_stepConfig=function(){function t(){}return t}();__reflect(Newhand_stepConfig.prototype,"Newhand_stepConfig");var NewhandConfig=function(){function t(){}return t}();__reflect(NewhandConfig.prototype,"NewhandConfig");var Notice_defConfig=function(){function t(){}return t}();__reflect(Notice_defConfig.prototype,"Notice_defConfig");var Online_awardConfig=function(){function t(){}return t}();__reflect(Online_awardConfig.prototype,"Online_awardConfig");var Openserver_viewtabConfig=function(){function t(){}return t}();__reflect(Openserver_viewtabConfig.prototype,"Openserver_viewtabConfig");var Path_dataConfig=function(){function t(){}return t}();__reflect(Path_dataConfig.prototype,"Path_dataConfig");var Pet_base_dataConfig=function(){function t(){}return t}();__reflect(Pet_base_dataConfig.prototype,"Pet_base_dataConfig");var Pet_equip_suit_dataConfig=function(){function t(){}return t}();__reflect(Pet_equip_suit_dataConfig.prototype,"Pet_equip_suit_dataConfig");var Pet_grade_critConfig=function(){function t(){}return t}();__reflect(Pet_grade_critConfig.prototype,"Pet_grade_critConfig");var Pet_grade_matrialConfig=function(){function t(){}return t}();__reflect(Pet_grade_matrialConfig.prototype,"Pet_grade_matrialConfig");var Pet_grade_showConfig=function(){function t(){}return t}();__reflect(Pet_grade_showConfig.prototype,"Pet_grade_showConfig");var Pet_skill_dataConfig=function(){function t(){}return t}();__reflect(Pet_skill_dataConfig.prototype,"Pet_skill_dataConfig");var Pet_skill_upgradeConfig=function(){function t(){}return t}();__reflect(Pet_skill_upgradeConfig.prototype,"Pet_skill_upgradeConfig");var Pet_skin_dataConfig=function(){function t(){}return t}();__reflect(Pet_skin_dataConfig.prototype,"Pet_skin_dataConfig");var Pet_skin_ex_dataConfig=function(){function t(){}return t}();__reflect(Pet_skin_ex_dataConfig.prototype,"Pet_skin_ex_dataConfig");var Pet_skin_extend_dataConfig=function(){function t(){}return t}();__reflect(Pet_skin_extend_dataConfig.prototype,"Pet_skin_extend_dataConfig");var Pet_swallow_extendConfig=function(){function t(){}return t}();__reflect(Pet_swallow_extendConfig.prototype,"Pet_swallow_extendConfig");var Pet_swallow_itemConfig=function(){function t(){}return t}();__reflect(Pet_swallow_itemConfig.prototype,"Pet_swallow_itemConfig");var Pet_vip_critConfig=function(){function t(){}return t}();__reflect(Pet_vip_critConfig.prototype,"Pet_vip_critConfig");var Pvp_base_dataConfig=function(){function t(){}return t}();__reflect(Pvp_base_dataConfig.prototype,"Pvp_base_dataConfig");var Pvp_cross_rank_awardConfig=function(){function t(){}return t}();__reflect(Pvp_cross_rank_awardConfig.prototype,"Pvp_cross_rank_awardConfig");var Pvp_daily_award_dataConfig=function(){function t(){}return t}();__reflect(Pvp_daily_award_dataConfig.prototype,"Pvp_daily_award_dataConfig");var Pvp_fight_score_dataConfig=function(){function t(){}return t}();__reflect(Pvp_fight_score_dataConfig.prototype,"Pvp_fight_score_dataConfig");var Pvp_guess_dataConfig=function(){function t(){}return t}();__reflect(Pvp_guess_dataConfig.prototype,"Pvp_guess_dataConfig");var Pvp_rank_awardConfig=function(){function t(){}return t}();__reflect(Pvp_rank_awardConfig.prototype,"Pvp_rank_awardConfig");var Pvp_step_dataConfig=function(){function t(){}return t}();__reflect(Pvp_step_dataConfig.prototype,"Pvp_step_dataConfig");var Pvp_top_awardConfig=function(){function t(){}return t}();__reflect(Pvp_top_awardConfig.prototype,"Pvp_top_awardConfig");var Pvp_vip_dataConfig=function(){function t(){}return t}();__reflect(Pvp_vip_dataConfig.prototype,"Pvp_vip_dataConfig");var Pvp_win_rate_dataConfig=function(){function t(){}return t}();__reflect(Pvp_win_rate_dataConfig.prototype,"Pvp_win_rate_dataConfig");var Rank_cont_typeConfig=function(){function t(){}return t}();__reflect(Rank_cont_typeConfig.prototype,"Rank_cont_typeConfig");var Rank_daily_awardConfig=function(){function t(){}return t}();__reflect(Rank_daily_awardConfig.prototype,"Rank_daily_awardConfig");var Rank_titleConfig=function(){function t(){}return t}();__reflect(Rank_titleConfig.prototype,"Rank_titleConfig");var Rank_typeConfig=function(){function t(){}return t}();__reflect(Rank_typeConfig.prototype,"Rank_typeConfig");var Recharge_rebate_dataConfig=function(){function t(){}return t}();__reflect(Recharge_rebate_dataConfig.prototype,"Recharge_rebate_dataConfig");var RechargeBagConfig=function(){function t(){}return t}();__reflect(RechargeBagConfig.prototype,"RechargeBagConfig");var RechargeBagIOSConfig=function(){function t(){}return t}();__reflect(RechargeBagIOSConfig.prototype,"RechargeBagIOSConfig");var RechargeConfig=function(){function t(){}return t}();__reflect(RechargeConfig.prototype,"RechargeConfig");var Refine_attr_dataConfig=function(){function t(){}return t}();__reflect(Refine_attr_dataConfig.prototype,"Refine_attr_dataConfig");var Refine_part_attr_dataConfig=function(){function t(){}return t}();__reflect(Refine_part_attr_dataConfig.prototype,"Refine_part_attr_dataConfig");var Refine_part_dataConfig=function(){function t(){}return t}();__reflect(Refine_part_dataConfig.prototype,"Refine_part_dataConfig");var Refine_star_dataConfig=function(){function t(){}return t}();__reflect(Refine_star_dataConfig.prototype,"Refine_star_dataConfig");var Refine_suit_dataConfig=function(){function t(){}return t}();__reflect(Refine_suit_dataConfig.prototype,"Refine_suit_dataConfig");var Reputation_dataConfig=function(){function t(){}return t}();__reflect(Reputation_dataConfig.prototype,"Reputation_dataConfig");var RewardItem=function(){function t(){}return t}();__reflect(RewardItem.prototype,"RewardItem");var Role_common_attrConfig=function(){function t(){}return t}();__reflect(Role_common_attrConfig.prototype,"Role_common_attrConfig");var Role_lvl_attrConfig=function(){function t(){}return t}();__reflect(Role_lvl_attrConfig.prototype,"Role_lvl_attrConfig");var Scene_conditionConfig=function(){function t(){}return t}();__reflect(Scene_conditionConfig.prototype,"Scene_conditionConfig");var Scene_dataConfig=function(){function t(){}return t}();__reflect(Scene_dataConfig.prototype,"Scene_dataConfig");var Scene_drop_ratio_dataConfig=function(){function t(){}return t
}();__reflect(Scene_drop_ratio_dataConfig.prototype,"Scene_drop_ratio_dataConfig");var Scene_lighting_detailConfig=function(){function t(){}return t}();__reflect(Scene_lighting_detailConfig.prototype,"Scene_lighting_detailConfig");var Scene_lightingConfig=function(){function t(){}return t}();__reflect(Scene_lightingConfig.prototype,"Scene_lightingConfig");var Scene_mirror_dataConfig=function(){function t(){}return t}();__reflect(Scene_mirror_dataConfig.prototype,"Scene_mirror_dataConfig");var Scene_monster_serverConfig=function(){function t(){}return t}();__reflect(Scene_monster_serverConfig.prototype,"Scene_monster_serverConfig");var Scene_monsterConfig=function(){function t(){}return t}();__reflect(Scene_monsterConfig.prototype,"Scene_monsterConfig");var Scene_pointConfig=function(){function t(){}return t}();__reflect(Scene_pointConfig.prototype,"Scene_pointConfig");var Scene_transferConfig=function(){function t(){}return t}();__reflect(Scene_transferConfig.prototype,"Scene_transferConfig");var ServerConfig=function(){function t(){}return t}();__reflect(ServerConfig.prototype,"ServerConfig");var ServergroupConfig=function(){function t(){}return t}();__reflect(ServergroupConfig.prototype,"ServergroupConfig");var ServermarkConfig=function(){function t(){}return t}();__reflect(ServermarkConfig.prototype,"ServermarkConfig");var Setup_chat_frame_dataConfig=function(){function t(){}return t}();__reflect(Setup_chat_frame_dataConfig.prototype,"Setup_chat_frame_dataConfig");var Setup_head_dataConfig=function(){function t(){}return t}();__reflect(Setup_head_dataConfig.prototype,"Setup_head_dataConfig");var Setup_head_frame_dataConfig=function(){function t(){}return t}();__reflect(Setup_head_frame_dataConfig.prototype,"Setup_head_frame_dataConfig");var Seven_day_award_dataConfig=function(){function t(){}return t}();__reflect(Seven_day_award_dataConfig.prototype,"Seven_day_award_dataConfig");var Shenbing_base_dataConfig=function(){function t(){}return t}();__reflect(Shenbing_base_dataConfig.prototype,"Shenbing_base_dataConfig");var Shenbing_book_dataConfig=function(){function t(){}return t}();__reflect(Shenbing_book_dataConfig.prototype,"Shenbing_book_dataConfig");var Shenbing_danyao_dataConfig=function(){function t(){}return t}();__reflect(Shenbing_danyao_dataConfig.prototype,"Shenbing_danyao_dataConfig");var Shenbing_grow_dataConfig=function(){function t(){}return t}();__reflect(Shenbing_grow_dataConfig.prototype,"Shenbing_grow_dataConfig");var Shenbing_misc_dataConfig=function(){function t(){}return t}();__reflect(Shenbing_misc_dataConfig.prototype,"Shenbing_misc_dataConfig");var Shenbing_resConfig=function(){function t(){}return t}();__reflect(Shenbing_resConfig.prototype,"Shenbing_resConfig");var Shenbing_swallow_dataConfig=function(){function t(){}return t}();__reflect(Shenbing_swallow_dataConfig.prototype,"Shenbing_swallow_dataConfig");var Shenbing_typeConfig=function(){function t(){}return t}();__reflect(Shenbing_typeConfig.prototype,"Shenbing_typeConfig");var Shengwu_exp_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_exp_dataConfig.prototype,"Shengwu_exp_dataConfig");var Shengwu_items_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_items_dataConfig.prototype,"Shengwu_items_dataConfig");var Shengwu_misc_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_misc_dataConfig.prototype,"Shengwu_misc_dataConfig");var Shengwu_skill_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_skill_dataConfig.prototype,"Shengwu_skill_dataConfig");var Shengwu_soul_attr_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_soul_attr_dataConfig.prototype,"Shengwu_soul_attr_dataConfig");var Shengwu_soul_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_soul_dataConfig.prototype,"Shengwu_soul_dataConfig");var Shengwu_suit_dataConfig=function(){function t(){}return t}();__reflect(Shengwu_suit_dataConfig.prototype,"Shengwu_suit_dataConfig");var Shenmi_gift_dataConfig=function(){function t(){}return t}();__reflect(Shenmi_gift_dataConfig.prototype,"Shenmi_gift_dataConfig");var Shenmi_gift_listConfig=function(){function t(){}return t}();__reflect(Shenmi_gift_listConfig.prototype,"Shenmi_gift_listConfig");var Show_treasureConfig=function(){function t(){}return t}();__reflect(Show_treasureConfig.prototype,"Show_treasureConfig");var Skill_descConfig=function(){function t(){}return t}();__reflect(Skill_descConfig.prototype,"Skill_descConfig");var Skill_effConfig=function(){function t(){}return t}();__reflect(Skill_effConfig.prototype,"Skill_effConfig");var Skill_rune_dataConfig=function(){function t(){}return t}();__reflect(Skill_rune_dataConfig.prototype,"Skill_rune_dataConfig");var SkillConfig=function(){function t(){}return t}();__reflect(SkillConfig.prototype,"SkillConfig");var Soulforge_attr_dataConfig=function(){function t(){}return t}();__reflect(Soulforge_attr_dataConfig.prototype,"Soulforge_attr_dataConfig");var Soulforge_itemsConfig=function(){function t(){}return t}();__reflect(Soulforge_itemsConfig.prototype,"Soulforge_itemsConfig");var Soulforge_part_dataConfig=function(){function t(){}return t}();__reflect(Soulforge_part_dataConfig.prototype,"Soulforge_part_dataConfig");var Soulforge_swallow_itemsConfig=function(){function t(){}return t}();__reflect(Soulforge_swallow_itemsConfig.prototype,"Soulforge_swallow_itemsConfig");var Soulforge_swallowConfig=function(){function t(){}return t}();__reflect(Soulforge_swallowConfig.prototype,"Soulforge_swallowConfig");var Soulstone_dataConfig=function(){function t(){}return t}();__reflect(Soulstone_dataConfig.prototype,"Soulstone_dataConfig");var Soulstone_master_dataConfig=function(){function t(){}return t}();__reflect(Soulstone_master_dataConfig.prototype,"Soulstone_master_dataConfig");var Soulstone_misc_dataConfig=function(){function t(){}return t}();__reflect(Soulstone_misc_dataConfig.prototype,"Soulstone_misc_dataConfig");var Soulstone_partConfig=function(){function t(){}return t}();__reflect(Soulstone_partConfig.prototype,"Soulstone_partConfig");var Special_rights_base_dataConfig=function(){function t(){}return t}();__reflect(Special_rights_base_dataConfig.prototype,"Special_rights_base_dataConfig");var Special_rights_skill_dataConfig=function(){function t(){}return t}();__reflect(Special_rights_skill_dataConfig.prototype,"Special_rights_skill_dataConfig");var Special_rightsConfig=function(){function t(){}return t}();__reflect(Special_rightsConfig.prototype,"Special_rightsConfig");var Split_dataConfig=function(){function t(){}return t}();__reflect(Split_dataConfig.prototype,"Split_dataConfig");var Store_cellConfig=function(){function t(){}return t}();__reflect(Store_cellConfig.prototype,"Store_cellConfig");var StoreConfig=function(){function t(){}return t}();__reflect(StoreConfig.prototype,"StoreConfig");var Strategybook_dataConfig=function(){function t(){}return t}();__reflect(Strategybook_dataConfig.prototype,"Strategybook_dataConfig");var Stronger_menuConfig=function(){function t(){}return t}();__reflect(Stronger_menuConfig.prototype,"Stronger_menuConfig");var Stronger_remarkConfig=function(){function t(){}return t}();__reflect(Stronger_remarkConfig.prototype,"Stronger_remarkConfig");var Sword_winstreak_dataConfig=function(){function t(){}return t}();__reflect(Sword_winstreak_dataConfig.prototype,"Sword_winstreak_dataConfig");var Sys_notice_defConfig=function(){function t(){}return t}();__reflect(Sys_notice_defConfig.prototype,"Sys_notice_defConfig");var System_open_awardConfig=function(){function t(){}return t}();__reflect(System_open_awardConfig.prototype,"System_open_awardConfig");var SystemopenConfig=function(){function t(){}return t}();__reflect(SystemopenConfig.prototype,"SystemopenConfig");var Taozhuang_attr_dataConfig=function(){function t(){}return t}();__reflect(Taozhuang_attr_dataConfig.prototype,"Taozhuang_attr_dataConfig");var Taozhuang_base_dataConfig=function(){function t(){}return t}();__reflect(Taozhuang_base_dataConfig.prototype,"Taozhuang_base_dataConfig");var TaskConfig=function(){function t(){}return t}();__reflect(TaskConfig.prototype,"TaskConfig");var Teamcopy_baseConfig=function(){function t(){}return t}();__reflect(Teamcopy_baseConfig.prototype,"Teamcopy_baseConfig");var Teamcopy_fighting_intervalConfig=function(){function t(){}return t}();__reflect(Teamcopy_fighting_intervalConfig.prototype,"Teamcopy_fighting_intervalConfig");var Teamcopy_kill_monster_awardConfig=function(){function t(){}return t}();__reflect(Teamcopy_kill_monster_awardConfig.prototype,"Teamcopy_kill_monster_awardConfig");var Title_dataConfig=function(){function t(){}return t}();__reflect(Title_dataConfig.prototype,"Title_dataConfig");var Title_rank_dataConfig=function(){function t(){}return t}();__reflect(Title_rank_dataConfig.prototype,"Title_rank_dataConfig");var Title_upgrade_dataConfig=function(){function t(){}return t}();__reflect(Title_upgrade_dataConfig.prototype,"Title_upgrade_dataConfig");var Tower_rewardConfig=function(){function t(){}return t}();__reflect(Tower_rewardConfig.prototype,"Tower_rewardConfig");var Tpl_effectConfig=function(){function t(){}return t}();__reflect(Tpl_effectConfig.prototype,"Tpl_effectConfig");var Tpl_ScreencharConfig=function(){function t(){}return t}();__reflect(Tpl_ScreencharConfig.prototype,"Tpl_ScreencharConfig");var Tpl_viewConfig=function(){function t(){}return t}();__reflect(Tpl_viewConfig.prototype,"Tpl_viewConfig");var Treasure_base_dataConfig=function(){function t(){}return t}();__reflect(Treasure_base_dataConfig.prototype,"Treasure_base_dataConfig");var Treasure_dataConfig=function(){function t(){}return t}();__reflect(Treasure_dataConfig.prototype,"Treasure_dataConfig");var Treasure_discConfig=function(){function t(){}return t}();__reflect(Treasure_discConfig.prototype,"Treasure_discConfig");var Treasure_exchangeConfig=function(){function t(){}return t}();__reflect(Treasure_exchangeConfig.prototype,"Treasure_exchangeConfig");var Treasure_part_dataConfig=function(){function t(){}return t}();__reflect(Treasure_part_dataConfig.prototype,"Treasure_part_dataConfig");var Trial_bossConfig=function(){function t(){}return t}();__reflect(Trial_bossConfig.prototype,"Trial_bossConfig");var Tujian_dataConfig=function(){function t(){}return t}();__reflect(Tujian_dataConfig.prototype,"Tujian_dataConfig");var Tujian_level_dataConfig=function(){function t(){}return t}();__reflect(Tujian_level_dataConfig.prototype,"Tujian_level_dataConfig");var Tujian_suit_dataConfig=function(){function t(){}return t}();__reflect(Tujian_suit_dataConfig.prototype,"Tujian_suit_dataConfig");var Upstar_master_dataConfig=function(){function t(){}return t}();__reflect(Upstar_master_dataConfig.prototype,"Upstar_master_dataConfig");var Upstar_part_dataConfig=function(){function t(){}return t}();__reflect(Upstar_part_dataConfig.prototype,"Upstar_part_dataConfig");var Upstar_vip_rateConfig=function(){function t(){}return t}();__reflect(Upstar_vip_rateConfig.prototype,"Upstar_vip_rateConfig");var Use_timesConfig=function(){function t(){}return t}();__reflect(Use_timesConfig.prototype,"Use_timesConfig");var Venation_dataConfig=function(){function t(){}return t}();__reflect(Venation_dataConfig.prototype,"Venation_dataConfig");var View_destroy_resConfig=function(){function t(){}return t}();__reflect(View_destroy_resConfig.prototype,"View_destroy_resConfig");var Vip_attr_dataConfig=function(){function t(){}return t}();__reflect(Vip_attr_dataConfig.prototype,"Vip_attr_dataConfig");var Vip_chat_dataConfig=function(){function t(){}return t}();__reflect(Vip_chat_dataConfig.prototype,"Vip_chat_dataConfig");var Vip_function_openConfig=function(){function t(){}return t}();__reflect(Vip_function_openConfig.prototype,"Vip_function_openConfig");var Vip_levelConfig=function(){function t(){}return t}();__reflect(Vip_levelConfig.prototype,"Vip_levelConfig");var Vip_micConfig=function(){function t(){}return t}();__reflect(Vip_micConfig.prototype,"Vip_micConfig");var Vip_online_awardConfig=function(){function t(){}return t}();__reflect(Vip_online_awardConfig.prototype,"Vip_online_awardConfig");var Vip_priorityConfig=function(){function t(){}return t}();__reflect(Vip_priorityConfig.prototype,"Vip_priorityConfig");var Week_card_awardConfig=function(){function t(){}return t}();__reflect(Week_card_awardConfig.prototype,"Week_card_awardConfig");var Welfare_configConfig=function(){function t(){}return t}();__reflect(Welfare_configConfig.prototype,"Welfare_configConfig");var Welfare_general_giftConfig=function(){function t(){}return t}();__reflect(Welfare_general_giftConfig.prototype,"Welfare_general_giftConfig");var Welfare_giftConfig=function(){function t(){}return t}();__reflect(Welfare_giftConfig.prototype,"Welfare_giftConfig");var Welfare_login_online_awardConfig=function(){function t(){}return t}();__reflect(Welfare_login_online_awardConfig.prototype,"Welfare_login_online_awardConfig");var Welfare_share_acc_awardConfig=function(){function t(){}return t}();__reflect(Welfare_share_acc_awardConfig.prototype,"Welfare_share_acc_awardConfig");var Welfare_signin_dataConfig=function(){function t(){}return t}();__reflect(Welfare_signin_dataConfig.prototype,"Welfare_signin_dataConfig");var Welfare_vip_dataConfig=function(){function t(){}return t}();__reflect(Welfare_vip_dataConfig.prototype,"Welfare_vip_dataConfig");var Wing_base_dataConfig=function(){function t(){}return t}();__reflect(Wing_base_dataConfig.prototype,"Wing_base_dataConfig");var Wing_book_dataConfig=function(){function t(){}return t}();__reflect(Wing_book_dataConfig.prototype,"Wing_book_dataConfig");var Wing_danyao_dataConfig=function(){function t(){}return t}();__reflect(Wing_danyao_dataConfig.prototype,"Wing_danyao_dataConfig");var Wing_grow_dataConfig=function(){function t(){}return t}();__reflect(Wing_grow_dataConfig.prototype,"Wing_grow_dataConfig");var Wing_misc_dataConfig=function(){function t(){}return t}();__reflect(Wing_misc_dataConfig.prototype,"Wing_misc_dataConfig");var Wing_resConfig=function(){function t(){}return t}();__reflect(Wing_resConfig.prototype,"Wing_resConfig");var Wing_swallow_dataConfig=function(){function t(){}return t}();__reflect(Wing_swallow_dataConfig.prototype,"Wing_swallow_dataConfig");var Wing_typeConfig=function(){function t(){}return t}();__reflect(Wing_typeConfig.prototype,"Wing_typeConfig");var World_mapConfig=function(){function t(){}return t}();__reflect(World_mapConfig.prototype,"World_mapConfig");var Xian_limit_actConfig=function(){function t(){}return t}();__reflect(Xian_limit_actConfig.prototype,"Xian_limit_actConfig");var Xianwei_base_dataConfig=function(){function t(){}return t}();__reflect(Xianwei_base_dataConfig.prototype,"Xianwei_base_dataConfig");var Xianyuan_award_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_award_dataConfig.prototype,"Xianyuan_award_dataConfig");var Xianyuan_copy_awardConfig=function(){function t(){}return t}();__reflect(Xianyuan_copy_awardConfig.prototype,"Xianyuan_copy_awardConfig");var Xianyuan_copy_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_copy_dataConfig.prototype,"Xianyuan_copy_dataConfig");var Xianyuan_day_task_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_day_task_dataConfig.prototype,"Xianyuan_day_task_dataConfig");var Xianyuan_flower_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_flower_dataConfig.prototype,"Xianyuan_flower_dataConfig");var Xianyuan_misc_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_misc_dataConfig.prototype,"Xianyuan_misc_dataConfig");var Xianyuan_ring_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_ring_dataConfig.prototype,"Xianyuan_ring_dataConfig");var Xianyuan_ring_high_attr_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_ring_high_attr_dataConfig.prototype,"Xianyuan_ring_high_attr_dataConfig");var Xianyuan_skill_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_skill_dataConfig.prototype,"Xianyuan_skill_dataConfig");var Xianyuan_task_dataConfig=function(){function t(){}return t}();__reflect(Xianyuan_task_dataConfig.prototype,"Xianyuan_task_dataConfig");var Xianyuan_xiangqin_descConfig=function(){function t(){}return t}();__reflect(Xianyuan_xiangqin_descConfig.prototype,"Xianyuan_xiangqin_descConfig");var Xiudian_dataConfig=function(){function t(){}return t}();__reflect(Xiudian_dataConfig.prototype,"Xiudian_dataConfig");var Xuanbing_base_dataConfig=function(){function t(){}return t}();__reflect(Xuanbing_base_dataConfig.prototype,"Xuanbing_base_dataConfig");var Xuanbing_book_dataConfig=function(){function t(){}return t}();__reflect(Xuanbing_book_dataConfig.prototype,"Xuanbing_book_dataConfig");var Xuanbing_danyao_dataConfig=function(){function t(){}return t}();__reflect(Xuanbing_danyao_dataConfig.prototype,"Xuanbing_danyao_dataConfig");var Xuanbing_grow_dataConfig=function(){function t(){}return t}();__reflect(Xuanbing_grow_dataConfig.prototype,"Xuanbing_grow_dataConfig");var Xuanbing_misc_dataConfig=function(){function t(){}return t}();__reflect(Xuanbing_misc_dataConfig.prototype,"Xuanbing_misc_dataConfig");var Xuanbing_resConfig=function(){function t(){}return t}();__reflect(Xuanbing_resConfig.prototype,"Xuanbing_resConfig");var Xuanbing_swallow_dataConfig=function(){function t(){}return t}();__reflect(Xuanbing_swallow_dataConfig.prototype,"Xuanbing_swallow_dataConfig");var Xuanbing_typeConfig=function(){function t(){}return t}();__reflect(Xuanbing_typeConfig.prototype,"Xuanbing_typeConfig");var Yezhan_base_dataConfig=function(){function t(){}return t}();__reflect(Yezhan_base_dataConfig.prototype,"Yezhan_base_dataConfig");var Yezhan_buy_dataConfig=function(){function t(){}return t}();__reflect(Yezhan_buy_dataConfig.prototype,"Yezhan_buy_dataConfig");var Yezhan_vip_timesConfig=function(){function t(){}return t}();__reflect(Yezhan_vip_timesConfig.prototype,"Yezhan_vip_timesConfig");var Zhuan_dataConfig=function(){function t(){}return t}();__reflect(Zhuan_dataConfig.prototype,"Zhuan_dataConfig");var Zhuan_openConfig=function(){function t(){}return t}();__reflect(Zhuan_openConfig.prototype,"Zhuan_openConfig");var Zhuan_viewConfig=function(){function t(){}return t}();__reflect(Zhuan_viewConfig.prototype,"Zhuan_viewConfig");var SceneEditor=function(){function t(){}return t}();__reflect(SceneEditor.prototype,"SceneEditor");var SceneEditorMonsterNode=function(){function t(){}return t}();__reflect(SceneEditorMonsterNode.prototype,"SceneEditorMonsterNode");var EditorRoleItem=function(){function t(){}return t}();__reflect(EditorRoleItem.prototype,"EditorRoleItem");var EditorRolePathItem=function(){function t(){}return t}();__reflect(EditorRolePathItem.prototype,"EditorRolePathItem");var EditorPointItem=function(){function t(){}return t}();__reflect(EditorPointItem.prototype,"EditorPointItem");var DamageProcesser=function(){function t(){}return t.canAttack=function(t,e,i){},t}();__reflect(DamageProcesser.prototype,"DamageProcesser");var AIBossRobot=function(t){function e(){var e=t.call(this)||this;return e.skillDatas=[],e.enemyType=[EntityTypes.MonsterMU],e.friendType=[EntityTypes.Player,EntityTypes.RoleMU],e}return __extends(e,t),e.prototype.setEntity=function(t){if(t){if(!(t instanceof EntityRobot))throw new Error("AIBossRobot只能管理EntityRobot类型的实体");this.entity=t,this.config=t.getConfig();for(var e=this.config.skill,i=0;i<e.length;i++){var n=new SkillData;n.skillId=e[i],n.skillConfig=GlobalConfig.getSkillConfig(n.skillId),this.skillDatas[i]=n}}},e.prototype.Atk=function(){if(!this.entity.isMoveing()&&this.runing){var t=GameLogic.ins().getEntityByHandle(this.params.target);if((!t||t.isDead())&&this.isFaraway())return void this.startFllow(GameMap.centerEntity.handle);var e=this.getTarget();if(e&&(this.params.target=e.handle,this.params.x=e.x,this.params.y=e.y,TimerManager.ins().getCurrTime()>this.nextSkillTime)){var i=this.getNextSkill();if(void 0==i)return;if(SkillCC.ins().checkSkillDis(this.entity,this.getSkillTargetPoint(i),i)){if(TimerManager.ins().getCurrTime()>this.nextSkillTime){var n=this.getSkillCanUse();if(n){this.entity.stopMove(),this.entity.setDir(DirUtil.get8DirBy2Point(this.entity,e));var o=GlobalConfig.getSkillDescById(Math.floor(n.skillId/1e4));o&&this.entity.playAction(o.action_type),this.nextSkillTime=TimerManager.ins().getCurrTime()+o.cd,this.updateSkillCd(n.skillId);var s=this.getTargetHandle(n);SkillCC.ins().sendUseSkill(this.entity.handle,s,n,0,!0)}}}else{var r=GameMap.ins().getPath(e,this.entity);r&&r.length?this.entity.startMove(r):this.Stand()}}return!1}},e.prototype.updateSkillCd=function(t){for(var e,i=0,n=this.skillDatas;i<n.length;i++){var o=n[i];if(o.skillId==t){e=o;var s=GlobalConfig.getSkillDescById(Math.floor(e.skillId/1e4));s&&(e.skillCDTick=TimerManager.ins().getCurrTime()+s.cd);break}}},e.prototype.getSkillCanUse=function(){for(var t=0;t<this.skillDatas.length;t++){var e=this.skillDatas[t];if(TimerManager.ins().getCurrTime()>e.skillCDTick)return e}return null},e.prototype.getNextSkill=function(){for(var t=Number.MAX_VALUE,e=null,i=0;i<this.skillDatas.length;i++)this.skillDatas[i].skillCDTick<t&&(e=this.skillDatas[i],t=e.skillCDTick);return e},e}(AIRoleMU);__reflect(AIBossRobot.prototype,"AIBossRobot");var AIDamonMU=function(t){function e(){var e=t.call(this)||this;return e.actionTime=0,e.enemyType=[EntityTypes.MonsterMU],e.aiTime=250,e}return __extends(e,t),e.prototype.setEntity=function(t){t&&(this.entity=t)},e.prototype.Follow=function(){this.entity.isMoveing()||(this.isFaraway()?this.startFllow(GameMap.centerEntity.handle):(this.startStand(),this.entity.stopMove()))},e.prototype.Stand=function(){this.isFaraway()&&this.startFllow(GameMap.centerEntity.handle)},e.prototype.isFaraway=function(){var t=GameLogic.ins().getEntityByHandle(GameMap.centerEntity.handle);if(t){var e=1e4,i=MathUtils.getDistanceX2ByObject(this.entity,GameLogic.ins().getEntityByHandle(GameMap.centerEntity.handle));return i>e}return!1},e}(AIBaseMU);__reflect(AIDamonMU.prototype,"AIDamonMU");var AIFuben=function(t){function e(){var e=t.call(this)||this;return e.cur_pos={x:0,y:0},e}return __extends(e,t),e.prototype.startfindNpc=function(t){},e.prototype.stopFindNpc=function(){this.params.npc=0},e.prototype.update=function(){if(null!=this.entity){var t=this[AI_State[this.state]];t&&t.call(this)}},e.prototype.destruct=function(){this.entity=null},e.prototype.getTargetHandle=function(){return this.params.target},e}(AIRoleMU);__reflect(AIFuben.prototype,"AIFuben");var AIMainCity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setPathList=function(t){this.hanglist=t,this.xunyou_end=!1,this.is_move=!1;var e=localStorage.getItem("xunyou_step_id");e&&""!=e?this.step_id=parseInt(e):this.step_id=0,this.entity.x=64*t[0][0]/100,this.entity.y=64*t[0][1]/100,SceneControl.ins().sendMove(GameLogic.ins().getCurSceneId(),this.entity.x,this.entity.y,this.entity.dir),EventProxy.Broast(EventType.PlayYanHua,[1])},e.prototype.update=function(){if(null!=this.entity&&this.runing&&!this.xunyou_end){if(this.entity.isMoveing())return void(this.is_move=!0);if(this.is_move&&(this.time=TimerManager.ins().getCurrTime()),this.is_move=!1,!(TimerManager.ins().getCurrTime()-this.time<1e3)&&this.hanglist)if(this.time=TimerManager.ins().getCurrTime(),this.step_id>=this.hanglist.length)this.xunyou_end=!0,XyProxy.ins().C2SReqXianyuanXunyouEnd(),localStorage.setItem("xunyou_step_id","0"),this.entity.setProp(FightAttr.SPEED,RoleProxy.ins().getFightAttr(FightAttr.SPEED)),EventProxy.Broast(EventType.PlayYanHua,[0]),ViewManager.ins().open(XyActiveEndView);else{localStorage.setItem("xunyou_step_id",this.step_id.toString());var t=this.hanglist[this.step_id];this.entity.setProp(FightAttr.SPEED,.72*RoleProxy.ins().getFightAttr(FightAttr.SPEED));var e=GameMap.ins().getPath({x:64*t[0]/100,y:64*t[1]/100},this.entity);e&&e.length>0&&this.entity.startMove(e),this.step_id+=1}}},e.prototype.destruct=function(){this.entity=null},e}(AIRoleMU);__reflect(AIMainCity.prototype,"AIMainCity");var AIMainCityRobot=function(t){function e(){var e=t.call(this)||this;return e.wait_time=0,e}return __extends(e,t),e.prototype.setPathList=function(t){this.hanglist=t,this.is_move=!1,this.step_id=0,this.entity.x=64*t[0][0]/100,this.entity.y=64*t[0][1]/100},e.prototype.update=function(){if(null!=this.entity&&this.runing){if(this.entity.isMoveing())return void(this.is_move=!0);if(this.is_move&&(this.time=TimerManager.ins().getCurrTime()),this.is_move=!1,!(TimerManager.ins().getCurrTime()-this.time<this.wait_time)&&this.hanglist)if(this.time=TimerManager.ins().getCurrTime(),this.step_id>=this.hanglist.length)this.moveEnd&&this.moveEnd.call(this.moveObj,this.entity),this.stop();else{var t=this.hanglist[this.step_id];this.wait_time=1e3*t[2],this.entity.setProp(FightAttr.SPEED,RoleProxy.ins().getFightAttr(FightAttr.SPEED));var e=GameMap.ins().getPath({x:64*t[0]/100,y:64*t[1]/100},this.entity);e&&e.length>0&&this.entity.startMove(e),this.step_id+=1}}},e.prototype.destruct=function(){this.entity=null},e}(AIRoleMU);__reflect(AIMainCityRobot.prototype,"AIMainCityRobot");var AIMainRole=function(t){function e(){var e=t.call(this)||this;return e.cur_pos={x:0,y:0},e.friendType=[EntityTypes.BossPlayer],e}return __extends(e,t),e.prototype.None=function(){this.params.npc&&this.Npc()},e.prototype.setHangList=function(t){this.hanglist=t,this.cur_hang_data=null,this.step_id=0,this.cur_wave_id=0},e.prototype.setTarget=function(t){this.params.target=t,EventProxy.Broast(EventType.chargeTarget,[])},e.prototype.startfindNpc=function(t){},e.prototype.stopFindNpc=function(){this.params.npc=0},e.prototype.Npc=function(){},e.prototype.update=function(){if(null!=this.entity&&this.runing&&!(this.entity.isDead()||this.entity.isMoveing()&&GameLogic.ins().isMainScene()))if(this.cur_hang_data&&1==this.cur_hang_data.portal&&this.cur_wave_id==HangManager.ins().getCurWave()){if(YezhanProxy.ins().isRunning())return YezhanProxy.ins().checkAI(),void this.Atk();for(var t=0,e=GameLogic.ins().getEntityList();t<e.length;t++){var i=e[t];i instanceof EntityMonsterClient&&(this.Atk(),GameLogic.ins().SetMonsterClientAI())}}else if(this.cur_wave_id=HangManager.ins().getCurWave(),this.hanglist)if(this.step_id>0){var n=this.hanglist[this.step_id+1];void 0==n?(n=this.hanglist[1],this.step_id=1):this.step_id+=1;var o=GameMap.ins().getPath({x:64*n.target_pos_x/100,y:64*n.target_pos_y/100},this.entity);o&&o.length>0&&this.entity.startMove(o,this.getActionStr(n.pos_type),this.getActionSpeed(n.pos_type)),this.cur_hang_data=n}else{var n=this.hanglist[1],o=GameMap.ins().getPath({x:64*n.target_pos_x/100,y:64*n.target_pos_y/100},this.entity);o&&o.length>0&&this.entity.startMove(o,this.getActionStr(n.pos_type),this.getActionSpeed(n.pos_type)),this.step_id=1,this.cur_hang_data=n}else this.Atk()},e.prototype.destruct=function(){this.entity=null},e.prototype.getTargetHandle=function(){return this.params.target},e.prototype.getActionStr=function(t){var e="r";return 2==t?e="m":3==t&&(e="j"),e},e.prototype.getActionSpeed=function(t){var e=this.entity.getProp(FightAttr.SPEED);return 2==t?e=18e3:3==t&&(e=12e3),e},e.prototype.getNextAIPosCfg=function(){if(!this.hanglist)return{x:this.entity.x,y:this.entity.y};var t,e;for(var i in this.hanglist){if(e=this.hanglist[i],e.step_id>this.step_id&&e.portal>0)return{x:64*e.target_pos_x/100,y:64*e.target_pos_y/100};!t&&e.portal>0&&(t=this.hanglist[i])}return{x:64*t.target_pos_x/100,y:64*t.target_pos_y/100}},e.prototype.setCurWaveId=function(){},e}(AIRoleMU);__reflect(AIMainRole.prototype,"AIMainRole");var AIMonsterClient=function(t){function e(){var e=t.call(this)||this;return e.skillDatas=[],e.nextPatrolTick=0,e}return __extends(e,t),e.prototype.setEntity=function(t){if(t){if(!(t instanceof EntityMonster))throw new Error("AIMonsterClient只能管理EntityMonster类型的实体");this.entity=t,this.config=t.getConfig(),this.aiConfig=GlobalConfig.getAiConfig(this.config.ai_id);for(var e=this.config.skill,i=0;i<e.length;i++){var n=new SkillData;n.skillId=e[i],n.skillConfig=GlobalConfig.getSkillConfig(n.skillId),this.skillDatas[i]=n}}},e.prototype.Stand=function(){this.entity.playAction(EntityAction.STAND),this.Atk()},e.prototype.Atk=function(){var t;GameMap.centerEntity&&(t=GameMap.centerEntity),this.params.target=t.handle,this.params.x=t.x,this.params.y=t.y;var e=this.getNextSkill();if(SkillCC.ins().checkSkillDis(this.entity,{x:this.params.x,y:this.params.y},e)){if(TimerManager.ins().getCurrTime()>this.nextSkillTime){var i=this.getSkillCanUse();if(i){this.entity.stopMove(),this.entity.setDir(DirUtil.get8DirBy2Point(this.entity,t));var n=GlobalConfig.getSkillDescById(Math.floor(i.skillId/1e4));this.entity.playAction(n.action_type),this.nextSkillTime=TimerManager.ins().getCurrTime()+n.cd,this.updateSkillCd(i.skillId);var o=this.getTargetHandle(i);SkillCC.ins().sendUseSkill(this.entity.handle,o,i)}}}else if(!this.entity.isMoveing()){var s=GameMap.ins().getPath(t,this.entity);s&&this.entity.startMove(s)}return!1},e.prototype.updateSkillCd=function(t){for(var e,i=0,n=this.skillDatas;i<n.length;i++){var o=n[i];if(o.skillId==t){e=o;var s=GlobalConfig.getSkillDescById(Math.floor(e.skillId/1e4));e.skillCDTick=TimerManager.ins().getCurrTime()+s.cd;break}}},e.prototype.getSkillCanUse=function(){for(var t=0;t<this.skillDatas.length;t++){var e=this.skillDatas[t];if(TimerManager.ins().getCurrTime()>e.skillCDTick)return e}return null},e.prototype.getNextSkill=function(){for(var t=Number.MAX_VALUE,e=null,i=0;i<this.skillDatas.length;i++)this.skillDatas[i].skillCDTick<t&&(e=this.skillDatas[i],t=e.skillCDTick);return e},e.prototype.Patrol=function(){this.params.target=null;var t=GameLogic.ins().getNearestEnemyByAI(this,102400);if(t){var e=MathUtils.getDistanceX2ByObject(this.entity,t);Math.pow(this.aiConfig.vision,2)>e&&this.startAttack(t)}},e.prototype.ReturnPatrol=function(){this.entity.isMoveing()||this.startPatrol(this.params.homeX,this.params.homeY)},e.prototype.startReturnPatrol=function(){var t=GameMap.ins().getPath({x:this.params.homeX,y:this.params.homeY},this.entity);t&&t.length&&this.entity.startMove(t),this.setAIState(AI_State.ReturnPatrol)},e.prototype.radomMove=function(){if(TimerManager.ins().getCurrTime()>this.nextPatrolTick&&!this.entity.isMoveing()){var t=this.getPointCanMove();if(t){var e=GameMap.ins().getPath(t,this.entity);e&&e.length&&(this.entity.startMove(e),this.nextPatrolTick+=MathUtils.limit(5e3,1e4))}else Debug.log("怪物刷新在错误的区域,请策划查询配置,副本id:"+GameMap.ins().fbId+"--刷怪坐标:"+this.params.homeX+","+this.params.homeY)}},e.prototype.getPointCanMove=function(){for(var t,e=0,i=this.aiConfig.patrolRadius;100>e;){var n=MathUtils.limit(this.params.homeX-i>>0,this.params.homeX+i>>0),o=MathUtils.limit(this.params.homeY-i>>0,this.params.homeY+i>>0);if(GameMap.ins().checkWalkableByPixel(n,o)){t=new egret.Point,t.x=n,t.y=o;break}e++}return t},e.prototype.isOutOfRange=function(){var t=this.aiConfig.home_range,e=MathUtils.getDistanceX2ByObject(this.entity,{x:this.params.homeX,y:this.params.homeY});return e>t*t},e.prototype.startPatrol=function(e,i){t.prototype.startPatrol.call(this,e,i),this.nextPatrolTick=TimerManager.ins().getCurrTime()+MathUtils.limitInteger(0,5e3)},e}(AIMonsterServer);__reflect(AIMonsterClient.prototype,"AIMonsterClient");var DelayOptManager=function(t){function e(){var e=t.call(this)||this;return e.TIME_THRESHOLD=2,e._delayOpts=[],egret.startTick(e.runCachedFun,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addDelayOptFunction=function(t,e,i,n,o){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callBack:n,para:o})},e.prototype.clear=function(){this._delayOpts.length=0},e.prototype.runCachedFun=function(t){if(0==this._delayOpts.length)return!1;for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-i>this.TIME_THRESHOLD)););return!1},e}(BaseClass);
__reflect(DelayOptManager.prototype,"DelayOptManager");var AIPartner=function(t){function e(){var e=t.call(this)||this;return e.actionTime=0,e.ack_time=0,e.enemyType=[EntityTypes.MonsterMU],e.aiTime=250,e}return __extends(e,t),e.prototype.setEntity=function(t){t&&(this.entity=t)},e.prototype.update=function(){this.entity.isMoveing()||void 0!=this.entity.master&&(this.isFaraway()?MathUtils.getDistanceX2ByObject(this.entity,this.entity.master)>Math.pow(e.FlashDistance,2)?(this.entity.x=this.entity.master.x+50*Math.random(),this.entity.y=this.entity.master.y+50*Math.random()):this.startFllow(this.entity.masterHandle):(this.entity.stopMove(),this.entity.master&&this.entity.master.action==EntityAction.ATTACK&&TimerManager.ins().getCurrTime()-this.ack_time>1200?(this.ack_time=TimerManager.ins().getCurrTime(),this.entity.playAction(EntityAction.ATTACK)):this.startStand()))},e.prototype.Stand=function(){},e.prototype.isFaraway=function(){if(this.entity&&this.entity.master){var t=Math.pow(e.FollowDistance,2),i=MathUtils.getDistanceX2ByObject(this.entity,this.entity.master);return i>t}return!1},e.FollowDistance=180,e.FlashDistance=500,e}(AIBaseMU);__reflect(AIPartner.prototype,"AIPartner");var AIPet=function(t){function e(){var e=t.call(this)||this;return e.actionTime=0,e.time=0,e.aiTime=250,e}return __extends(e,t),e.prototype.setEntity=function(t){t&&(this.entity=t)},e.prototype.update=function(){if(!this.entity.isMoveing())if(this.isFaraway())MathUtils.getDistanceX2ByObject(this.entity,this.entity.master)>Math.pow(e.FlashDistance,2)?(this.entity.x=this.entity.master.x+50*Math.random(),this.entity.y=this.entity.master.y+50*Math.random()):this.startFllow(this.entity.masterHandle);else{if(TimerManager.ins().getCurrTime()<this.time)return this.startStand(),void this.entity.stopMove();var t=MathUtils.getRangePoint(this.entity.master.x,this.entity.master.y,100);if(t&&t.length>0){var i=GameMap.ins().getPath({x:t[0],y:t[1]},this.entity);i&&i.length>0&&(this.time=TimerManager.ins().getCurrTime()+MathUtils.getRandom(2e3,1e4),this.entity.startMove(i))}}},e.prototype.Follow=function(){},e.prototype.Stand=function(){},e.prototype.isFaraway=function(){if(this.entity&&this.entity.master){var t=Math.pow(e.FollowDistance,2),i=MathUtils.getDistanceX2ByObject(this.entity,this.entity.master);return i>t}return!1},e.FollowDistance=100,e.FlashDistance=500,e}(AIBaseMU);__reflect(AIPet.prototype,"AIPet");var AIRoleKuaFu=function(t){function e(){var e=t.call(this)||this;return e.cur_pos={x:0,y:0},e.enemyType=[EntityTypes.MonsterMU,EntityTypes.ArenaPlayer,EntityTypes.YezhanPlayer,EntityTypes.Player,EntityTypes.RoleMU],e}return __extends(e,t),e.prototype.None=function(){this.params.npc&&this.Npc()},e.prototype.setHangList=function(t){this.hanglist=t,this.cur_hang_data=null,this.step_id=0,this.cur_wave_id=0},e.prototype.setTarget=function(t){this.params.target!=t&&(this.params.target=t,EventProxy.Broast(EventType.chargeTarget,[]))},e.prototype.startfindNpc=function(t){},e.prototype.stopFindNpc=function(){this.params.npc=0},e.prototype.Npc=function(){},e.prototype.update=function(){if(null!=this.entity&&this.runing&&!this.entity.isDead()&&!this.entity.isMoveing())if(this.cur_hang_data&&1==this.cur_hang_data.portal&&this.cur_wave_id==HangManager.ins().getCurWave())for(var t=0,e=GameLogic.ins().getEntityList();t<e.length;t++){var i=e[t];i instanceof EntityMonsterClient&&(this.Atk(),GameLogic.ins().SetMonsterClientAI())}else if(this.cur_wave_id=HangManager.ins().getCurWave(),this.hanglist)if(this.step_id>0){var n=this.hanglist[this.step_id+1];void 0==n?(n=this.hanglist[1],this.step_id=1):this.step_id+=1;var o=GameMap.ins().getPath({x:64*n.target_pos_x/100,y:64*n.target_pos_y/100},this.entity);o&&o.length>0&&this.entity.startMove(o,this.getActionStr(n.pos_type),this.getActionSpeed(n.pos_type)),this.cur_hang_data=n}else{var n=this.hanglist[1],o=GameMap.ins().getPath({x:64*n.target_pos_x/100,y:64*n.target_pos_y/100},this.entity);o&&o.length>0&&this.entity.startMove(o,this.getActionStr(n.pos_type),this.getActionSpeed(n.pos_type)),this.step_id=1,this.cur_hang_data=n}else this.Atk()},e.prototype.destruct=function(){this.entity=null},e.prototype.getTargetHandle=function(){return this.params.target},e.prototype.getActionStr=function(t){var e="r";return 2==t?e="m":3==t&&(e="j"),e},e.prototype.getActionSpeed=function(t){var e=this.entity.getProp(FightAttr.SPEED);return 2==t?e=18e3:3==t&&(e=12e3),e},e.prototype.getNextAIPosCfg=function(){if(!this.hanglist)return{x:this.entity.x,y:this.entity.y};var t,e;for(var i in this.hanglist){if(e=this.hanglist[i],e.step_id>this.step_id&&e.portal>0)return{x:64*e.target_pos_x/100,y:64*e.target_pos_y/100};!t&&e.portal>0&&(t=this.hanglist[i])}return{x:64*t.target_pos_x/100,y:64*t.target_pos_y/100}},e.prototype.setCurWaveId=function(){},e}(AIRoleMU);__reflect(AIRoleKuaFu.prototype,"AIRoleKuaFu");var EntityManager=function(t){function e(){var e=t.call(this)||this;return e.poolType=[EntityTypes.MonsterClientMU],e.entityList={},e.entityHandles={},e.handle_index=1e4,e.b=new egret.ByteArray,egret.startTick(e.update,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getHandleId=function(){return this.handle_index=this.handle_index+1,this.handle_index},e.prototype.resetHandle=function(){this.handle_index=1e4},e.prototype.update=function(t){var e=egret.getTimer();for(var i in this.entityList)if(this.entityList[i]){for(var n=0,o=this.entityList[i];n<o.length;n++){var s=o[n];s.update(t)}var r=egret.getTimer();if(r-e>16)break}return!1},e.prototype.getEntityByType=function(t){return this.entityList[t]||[]},e.prototype.createEntitynew=function(t,i){void 0===i&&(i=0);var n=egret.getQualifiedClassName(t),o=EntityTypes[n];this.entityList[o]=this.entityList[o]||[];var s=this.poolType.indexOf(o)<0?new t:ObjectPool.pop(n);return s.handle=i?i:e.getHandle(o,s.hashCode),GameMap.ins().addEntity(s),this.entityList[o].push(s),this.entityHandles[s.handle]=s,s},e.prototype.removeAll=function(t){void 0===t&&(t=!1);for(var e in this.entityList)if(this.entityList[e])for(var i in this.entityList[e])DisplayUtils.removeFromParent(this.entityList[e][i]);this.entityList={},this.entityHandles={}},e.prototype.removeByHandle=function(t,i){void 0===i&&(i=!0);var n=e.getType(t);this.select&&this.select.handle==t&&this.setSelect(null);var o=this.entityList[n];if(!o)return null;delete this.entityHandles[t];for(var s=0;s<o.length;s++){var r=o[s];if(r.handle==t)return o.splice(s,1),i&&(GameMap.removeEntity(r),this.poolType.indexOf(n)>=0&&ObjectPool.push(r)),r}return null},e.prototype.getEntityByHandle=function(t){return this.entityHandles[t]},e.prototype.postClientMonsterDie=function(t,i){var n=this,o=e.getType(t),s=this.removeByHandle(t,!1);s.stopAI(),s.playAction(EntityAction.HIT);var r=DirUtil.get8DirBy2Point(s,i),a=DirUtil.getGridByDir(r,3),h=getP1ByP0P2({x:0,y:0},a,100);return egret.Tween.removeTweens(s),bezier(s,h,a,500).call(function(){var t=DirUtil.getGridByDir(r,1),e=getP1ByP0P2({x:0,y:0},t,20);bezier(s,e,t,300).wait(300).call(function(){GameMap.removeEntity(s),n.poolType.indexOf(o)>=0&&ObjectPool.push(s)})}),s},e.getType=function(t){var i=e.ins().b;return i.clear(),i.writeDouble(t),i.position=0,i.readShort()},e.getHandle=function(t,i){var n=e.ins().b;return n.clear(),n.writeShort(t),n.writeShort(0),n.writeInt(i),n.position=0,n.readDouble()},e.prototype.setSelect=function(t){this.select=t,this.postSelectChange(t)},e.prototype.getSelect=function(){return this.select},e.prototype.postSelectChange=function(t){return t},e}(BaseClass);__reflect(EntityManager.prototype,"EntityManager");var GameSystem;!function(t){t.entitymanager=function(){MessageCenter.compile(EntityManager)}}(GameSystem||(GameSystem={}));var AIRoleZPZB=function(t){function e(){var e=t.call(this)||this;return e.enemyType=[EntityTypes.MonsterMU,EntityTypes.Player,EntityTypes.RoleMU],e}return __extends(e,t),e.prototype.None=function(){this.params.npc&&this.Npc()},e.prototype.setHangList=function(t){this.hanglist=t,this.step_id=0,this.params.target=-1,ZPZBProxy.ins().setAttackType(0),ZPZBProxy.ins().setGoBack(!1)},e.prototype.setTarget=function(t){this.params.target!=t&&(this.params.target=t,EventProxy.Broast(EventType.chargeTarget,[]))},e.prototype.startfindNpc=function(t){},e.prototype.stopFindNpc=function(){this.params.npc=0},e.prototype.Npc=function(){},e.prototype.update=function(){if(null!=this.entity&&!SkillEffPlayer.eff_in_play){if(this.entity.isDead())return this.entity.stopMove(),this.step_id=0,void(this.params.target=-1);if(!this.entity.isMoveing()||!GameLogic.ins().isMainScene()){var t=!1;if(void 0!=this.params.target){var e=GameLogic.ins().getEntityByHandle(this.params.target);if(e&&!e.isDead()&&e.handle!=this.entity.handle&&this.isEnemy(e))return void this.Atk();this.params.target=-1,this.curMonsterhadel&&this.params.target==this.curMonsterhadel&&(this.step_id=this.step_id+1,this.curMonsterhadel=0,t=!0)}if(ZPZBProxy.ins().getGoBack())if(0==this.step_id){var i=ZPZBProxy.ins().getBaseCampXY();if(0!=i.pos_x&&0!=i.pos_y)if(this.IsInPoint(i.pos_x,i.pos_y))ZPZBProxy.ins().setGoBack(!1),ZPZBProxy.ins().setAttackType(2);else{var n=GameMap.ins().getPath({x:64*i.pos_x/100,y:64*i.pos_y/100},this.entity);if(n&&n.length>0)return void this.entity.startMove(n,this.getActionStr(0),this.getActionSpeed(0))}}else if(this.step_id>0){var i=ZPZBProxy.ins().getNeedToPointXY(this.step_id-1);if(0!=i.pos_x&&0!=i.pos_y)if(this.IsInPoint(i.pos_x,i.pos_y))this.step_id=this.step_id-1;else{var n=GameMap.ins().getPath({x:64*i.pos_x/100,y:64*i.pos_y/100},this.entity);if(n&&n.length>0)return void this.entity.startMove(n,this.getActionStr(0),this.getActionSpeed(0))}}if(1==ZPZBProxy.ins().getAttackType()){var i=ZPZBProxy.ins().getNeedToPointXY(this.step_id+1);if(0!=i.pos_x&&0!=i.pos_y)if(this.IsInPoint(i.pos_x,i.pos_y)){var o=this.getTarget();o?this.Atk():t||(this.step_id=this.step_id+1)}else{var n=GameMap.ins().getPath({x:64*i.pos_x/100,y:64*i.pos_y/100},this.entity);n&&n.length>0&&this.entity.startMove(n,this.getActionStr(0),this.getActionSpeed(0))}}else 2==ZPZBProxy.ins().getAttackType()&&this.Atk()}}},e.prototype.IsInPoint=function(t,e){var i=new egret.Point(64*t/100,64*e/100),n=MathUtils.getDistanceX2ByObject(i,GameMap.centerEntity);return 4096>n?!0:!1},e.prototype.isEnemy=function(t){return t.handle!=GameMap.centerEntity.handle&&-1!=this.enemyType.indexOf(EntityType.getEntityType(t))&&ZPZBProxy.ins().IsCanAttackHandle(t.handle)},e.prototype.getTarget=function(){if(void 0!=this.params.target){var t=GameLogic.ins().getEntityByHandle(this.params.target);if(t&&!t.isDead()&&t.handle!=this.entity.handle&&this.isEnemy(t))return t}var e;return 2==ZPZBProxy.ins().getAttackType()?e=GameLogic.ins().getNearestRoleEnemyByAI(this):1==ZPZBProxy.ins().getAttackType()&&(e=ZPZBProxy.ins().GetCurNeedAttackTarget(this),e&&(this.curMonsterhadel=e.handle)),e},e.prototype.SetCharacterDead=function(){this.entity.stopMove(),this.step_id=0,this.params.target=-1},e.prototype.getActionStr=function(t){var e="r";return 2==t?e="m":3==t&&(e="j"),e},e.prototype.getActionSpeed=function(t){var e=this.entity.getProp(FightAttr.SPEED);return 2==t?e=18e3:3==t&&(e=12e3),e},e}(AIRoleMU);__reflect(AIRoleZPZB.prototype,"AIRoleZPZB");var AIYezhanRole=function(t){function e(){var e=t.call(this)||this;return e.skillDatas=[],e.nextPatrolTick=0,e.aiConfig=GlobalConfig.getAiConfig(101),e.enemyType=[EntityTypes.RoleMU],e.aiTime=250,e}return __extends(e,t),e.prototype.setSkill=function(t){for(var e=0;e<t.length;e++){var i=new SkillData;i.skillId=t[e].value,i.skillConfig=GlobalConfig.getSkillConfig(i.skillId),this.skillDatas[e]=i}},e.prototype.updateStartPoint=function(){var t=this.getPointCanMove();this.entity&&(this.entity.x=t.x,this.entity.y=t.y)},e.prototype.Stand=function(){this.entity.playAction(EntityAction.STAND),this.Atk()},e.prototype.Atk=function(){var t;GameMap.centerEntity&&(t=GameMap.centerEntity),this.params.target=t.handle,this.params.x=t.x,this.params.y=t.y;var e=this.getNextSkill();if(SkillCC.ins().checkSkillDis(this.entity,{x:this.params.x,y:this.params.y},e)&&TimerManager.ins().getCurrTime()>this.nextSkillTime){var i=this.getSkillCanUse();if(i){this.entity.stopMove(),this.entity.setDir(DirUtil.get8DirBy2Point(this.entity,t));var n=GlobalConfig.getSkillDescById(Math.floor(i.skillId/1e4)),o=GlobalConfig.getSkillEffConfig(n.skill_effs[0]);if(!o)return;this.entity.playAction(n.action_type),this.nextSkillTime=TimerManager.ins().getCurrTime()+o.play_time,this.updateSkillCd(i.skillId);var s=this.getTargetHandle(i);SkillCC.ins().sendUseSkill(this.entity.handle,s,i)}}return!1},e.prototype.updateSkillCd=function(t){for(var e,i=0,n=this.skillDatas;i<n.length;i++){var o=n[i];if(o.skillId==t){e=o;var s=GlobalConfig.getSkillDescById(Math.floor(e.skillId/1e4));s&&(e.skillCDTick=TimerManager.ins().getCurrTime()+s.cd);break}}},e.prototype.getSkillCanUse=function(){for(var t=0;t<this.skillDatas.length;t++){var e=this.skillDatas[t];if(TimerManager.ins().getCurrTime()>e.skillCDTick)return e}return null},e.prototype.getNextSkill=function(){for(var t=Number.MAX_VALUE,e=null,i=0;i<this.skillDatas.length;i++)this.skillDatas[i].skillCDTick<t&&2e6!=this.skillDatas[i].skillId&&(e=this.skillDatas[i],t=e.skillCDTick);return e},e.prototype.getPointCanMove=function(){for(var t,e=0,i=this.aiConfig.patrolRadius;100>e;){var n=MathUtils.limit(this.entity.x-i>>0,this.entity.x+i>>0),o=MathUtils.limit(this.entity.y-i>>0,this.entity.y+i>>0);if(GameMap.ins().checkWalkableByPixel(n,o)){t=new egret.Point,t.x=n,t.y=o;break}e++}return t},e.prototype.isOutOfRange=function(){var t=this.aiConfig.home_range,e=MathUtils.getDistanceX2ByObject(this.entity,{x:this.params.homeX,y:this.params.homeY});return e>t*t},e.prototype.startDie=function(){},e}(AIMonsterServer);__reflect(AIYezhanRole.prototype,"AIYezhanRole");var EventProxy=function(){function t(){}return t.AddListener=function(e,i,n){void 0==t.event_list[i]&&(t.event_list[i]=[]);for(var o=!1,s=0;s<t.event_list[i].length;s++){var r=t.event_list[i][s];if(r&&r.length>=2&&r[0]==n&&r[1]==e){o=!0;break}}o||(t.event_list[i].push([n,e]),e instanceof BaseView&&e.addToEventProxy(e,i,n))},t.RemoveListener=function(e,i,n){var o=t.event_list[i];if(void 0==o);else{for(var s=-1,r=0;r<o.length;r++)o[r][1]==e&&o[r][0].toString()==n.toString()&&(s=r);s>-1&&o.splice(s,1)}},t.Broast=function(e,i){var n=t.event_list[e];if(void 0==n);else for(var o=0;o<n.length;o++)n[o][0].apply(n[o][1],i)},t.event_list={},t}();__reflect(EventProxy.prototype,"EventProxy");var EventItem=function(){function t(){}return t}();__reflect(EventItem.prototype,"EventItem");var EventType=function(){function t(){}return t.UpdataTask="UpdataTask",t.TaskIsCompleted="TaskIsCompleted",t.S2CRepTaskRecorderInfo="S2CRepTaskRecorderInfo",t.UpdataMoney="UpdataMoney",t.S2CRepCopyGetData="S2CRepCopyGetData",t.S2CRepCopyEnterCopy=" S2CRepCopyEnterCopy",t.S2CRepCopyLeave="S2CRepCopyLeave",t.S2CRepCopyEnd="S2CRepCopyEnd",t.S2CRepCopySweep="S2CRepCopySweep",t.S2CRepCopyBuyTimes="S2CRepCopyBuyTimes",t.RefreshCopyRed="RefreshCopyRed",t.S2CRepCopyOnekeySweep="S2CRepCopyOnekeySweep",t.S2CRepCopyStart="S2CRepCopyStart",t.copyFailUpdate="copyFailUpdate",t.UpdataExpOrLevel="UpdataExpOrLevel",t.S2CCopyRepCopyGetClimbReward="S2CCopyRepCopyGetClimbReward",t.UpdateBagInfo="UpdateBagInfo",t.S2CRepKnapsackArm="S2CRepKnapsackArm",t.S2CRepKnapsackDisArm="S2CRepKnapsackDisArm",t.S2CRepKnapsackPartnerMelt="S2CRepKnapsackPartnerMelt",t.UpdateBodyEquip="UpdateBodyEquip",t.UpdateFight="UpdateFight",t.S2CRepMeltGetInfo="S2CRepMeltGetInfo",t.S2CRepMeltMelt="S2CRepMeltMelt",t.HangMonsterDie="HangMonsterDie",t.UpdateMonsterReward="UpdateMonsterReward",t.S2CRepIntensifyGetInfo="S2CRepIntensifyGetInfo",t.S2CRepIntensifyUpgrade="S2CRepIntensifyUpgrade",t.S2CRepIntensifySuit="S2CRepIntensifySuit",t.S2CRepSkillUpdate="S2CRepSkillUpdate",t.S2CRepSkillUpgradeRune="S2CRepSkillUpgradeRune",t.S2CRepSkillUpdateExtendParam="S2CRepSkillUpdateExtendParam",t.UpdateSkillRed="UpdateSkillRed",t.S2CRepLyhGetInfo="S2CRepLyhGetInfo",t.S2CRepLyhGetReward="S2CRepLyhGetReward",t.S2CRepLyhSweep="S2CRepLyhSweep",t.LyhUpdateMonster="LyhUpdateMonster",t.LyhAutoState="LyhAutoState",t.S2CRepLyhUpdateAwardZhenbao="S2CRepLyhUpdateAwardZhenbao",t.S2CRepLyhUpdateLayerInfo="S2CRepLyhUpdateLayerInfo",t.S2CRepUpstarGetInfo="S2CRepUpstarGetInfo",t.S2CRepUpstarUpgrade="S2CRepUpstarUpgrade",t.S2CRepUpstarUpgradeMaster="S2CRepUpstarUpgradeMaster",t.CS2CChannelChat="CS2CChannelChat",t.CS2CSingleChat="CS2CSingleChat",t.CS2CSysChat="CS2CSysChat",t.S2CRepMiscZhuanUpLevel="S2CRepMiscZhuanUpLevel",t.S2CRepAlivepointGetInfo="S2CRepAlivepointGetInfo",t.S2CRepAlivepointUpdate="S2CRepAlivepointUpdate",t.S2CRepAlivepointGetReward="S2CRepAlivepointGetReward",t.S2CRepAlivepointGet="S2CRepAlivepointGet",t.S2CRepAlivepointXianfuUpLevel="S2CRepAlivepointXianfuUpLevel",t.S2CRepAlivepointXianfuFindBack="S2CRepAlivepointXianfuFindBack",t.S2CRepAchievementGetInfo="S2CRepAchievementGetInfo",t.S2CRepAchievementGet="S2CRepAchievementGet",t.S2CRepAchievementUpdateCollectInfo="S2CRepAchievementUpdateCollectInfo",t.S2CRepAchievementUpgrade="S2CRepAchievementUpgrade",t.S2CRepGlobalchatGetInfo="S2CRepGlobalchatGetInfo",t.S2CRepGlobalchatSetBlacklist="S2CRepGlobalchatSetBlacklist",t.S2CRepGlobalchatCancelBlacklist="S2CRepGlobalchatCancelBlacklist",t.S2CRepGlobalchatCross="S2CRepGlobalchatCross",t.S2CRepSoulstoneGetInfo="S2CRepSoulstoneGetInfo",t.S2CRepSoulstoneUpgradeMaster="S2CRepSoulstoneUpgradeMaster",t.S2CRepSoulstoneInlay="S2CRepSoulstoneInlay",t.UpdateBagStone="UpdateBagStone",t.S2CRepTitleGetInfo="S2CRepTitleGetInfo",t.S2CRepTitleActive="S2CRepTitleActive",t.S2CRepTitleUpgrade="S2CRepTitleUpgrade",t.S2CRepTitleUse="S2CRepTitleUse",t.S2CRepTitleUpgradeReputation="S2CRepTitleUpgradeReputation",t.RefreshTitleRed="RefreshTitleRed",t.S2CRepGodequipGetInfo="S2CRepGodequipGetInfo",t.S2CRepGodequipMake="S2CRepGodequipMake",t.S2CRepGodequipSuit="S2CRepGodequipSuit",t.S2CRepGodequipForge="S2CRepGodequipForge",t.S2CRepGodequipForgeSuit="S2CRepGodequipForgeSuit",t.S2CRepGodequipSoulUpLevel="S2CRepGodequipSoulUpLevel",t.S2CRepInjectsoulGetInfo="S2CRepInjectsoulGetInfo",t.S2CRepInjectsoulAction="S2CRepInjectsoulAction",t.S2CRepInjectsoulSwallow="S2CRepInjectsoulSwallow",t.S2CRepInjectsoulSoulforgeAction="S2CRepInjectsoulSoulforgeAction",t.S2CRepInjectsoulSoulforgeSwallow="S2CRepInjectsoulSoulforgeSwallow",t.S2CRepBelleGetInfo="S2CRepBelleGetInfo",t.S2CRepBelleOnekeyUpgrade="S2CRepBelleOnekeyUpgrade",t.S2CRepBelleActiveHuaxing="S2CRepBelleActiveHuaxing",t.S2CRepBelleShenLian="S2CRepBelleShenLian",t.S2CRepBelleSkillUpgrade="S2CRepBelleSkillUpgrade",t.S2CRepBelleUpdateShow="S2CRepBelleUpdateShow",t.S2CRepBelleFight="S2CRepBelleFight",t.RefreshHuoBanRed="RefreshHuoBanRed",t.S2CRepPetGetInfo="S2CRepPetGetInfo",t.S2CRepPetOnekeyUpgrade="S2CRepPetOnekeyUpgrade",t.S2CRepPetActiveHuaxing="S2CRepPetActiveHuaxing",t.S2CRepPetShenLian="S2CRepPetShenLian",t.S2CRepPetSkillUpgrade="S2CRepPetSkillUpgrade",t.S2CRepPetUpdateShow="S2CRepPetUpdateShow",t.S2CRepPetInfoUpdate="S2CRepPetInfoUpdate",t.S2CRepPetFight="S2CRepPetFight",t.S2CRepArenaGetInfo="S2CRepArenaGetInfo",t.S2CRepArenaChallenge="S2CRepArenaChallenge",t.S2CRepArenaRefreshOpp="S2CRepArenaRefreshOpp",t.S2CRepArenaSweep="S2CRepArenaSweep",t.S2CRepArenaBuyChallengeNum="S2CRepArenaBuyChallengeNum",t.S2CRepArenaGetRankAward="S2CRepArenaGetRankAward",t.S2CRepArenaGetRankList="S2CRepArenaGetRankList",t.S2CRepArenaChallengeResult="S2CRepArenaChallengeResult",t.S2CRepArenaGetFirstRankAward="S2CRepArenaGetFirstRankAward",t.S2CRepHorseGetInfo="S2CRepHorseGetInfo",t.S2CRepHorseOnekeyUpgrade="S2CRepHorseOnekeyUpgrade",t.S2CRepHorseActiveHuaxing="S2CRepHorseActiveHuaxing",t.S2CRepHorseShenLian="S2CRepHorseShenLian",t.S2CRepHorseSkillUpgrade="S2CRepHorseSkillUpgrade",t.S2CRepHorseUpdateShow="S2CRepHorseUpdateShow",t.S2CRepHorseInfoUpdate="S2CRepHorseInfoUpdate",t.S2CRepHorseFight="S2CRepHorseFight",t.S2CRepHorseActiveLimitSkin="S2CRepHorseActiveLimitSkin",t.S2CRepHorseRemoveLimitSkin="S2CRepHorseRemoveLimitSkin",t.S2CEnterScene="S2CEnterScene",t.S2CRepFactionGetInfo="S2CRepFactionGetInfo",t.S2CRepFactionJoin="S2CRepFactionJoin",t.S2CRepFactionContribute="S2CRepFactionContribute",t.S2CRepFactionGetMemberList="S2CRepFactionGetMemberList",t.UpdataForgingRed="UpdataForgingRed",t.S2CBossHurtRank="S2CBossHurtRank",t.BossMyHurt="BossMyHurt",t.S2COnLeaveBoss="S2COnLeaveBoss",t.S2CRepMonsterDropOwerChange="S2CRepMonsterDropOwerChange",t.StrengthRefresh="StrengthRefresh",t.S2CReqBossDataUpdate="S2CReqBossDataUpdate",t.S2CReqBossPartReward="S2CReqBossPartReward",t.S2CRepBossSceneInfoChange="S2CRepBossSceneInfoChange",t.S2CRepBossNextAppear="S2CRepBossNextAppear",t.S2CReqBossHurtAward="S2CReqBossHurtAward",t.S2CReqBossBuyChallengeNum="S2CReqBossBuyChallengeNum",t.S2CRepBossKillRecord="S2CRepBossKillRecord",t.BossDead="BossDead",t.S2CReqBossYlsdTeamBigAward="S2CReqBossYlsdTeamBigAward",t.S2CReqBossYlsdRandom="S2CReqBossYlsdRandom",t.RefreshBossRed="RefreshBossRed",t.RefreshYamaId="RefreshYamaId",t.S2CReqBossBuyTimes="S2CReqBossBuyTimes",t.RefreshBossItemJuan="RefreshBossItemJuan",t.S2CReqBossGetBoxAward="S2CReqBossGetBoxAward",t.S2CReqBossTouchBox="S2CReqBossTouchBox",t.S2CReqBossShenwenBuyChallengeNum="S2CReqBossShenwenBuyChallengeNum",t.S2CRepGrowupInfo="S2CRepGrowupInfo",t.S2CRepGrowupFashionUpdate="S2CRepGrowupFashionUpdate",t.S2CRepGrowupFashionWear="S2CRepGrowupFashionWear",t.S2CRepGrowupVenationUpgrade="S2CRepGrowupVenationUpgrade",t.VenationRedUpdate="VenationRedUpdate",t.S2CRepFabaoGetInfo="S2CRepFabaoGetInfo",t.S2CRepFabaoUpdateFabao="S2CRepFabaoUpdateFabao",t.S2CRepFabaoUpdateJingjie="S2CRepFabaoUpdateJingjie",t.S2CRepFabaoFabaoSuitUpgrade="S2CRepFabaoFabaoSuitUpgrade",t.FbUpdateRed="FbUpdateRed",t.S2CRepGrowupFuyinUpgrade="S2CRepGrowupFuyinUpgrade",t.S2CRepGrowupFuyinSuitUpgrade="S2CRepGrowupFuyinSuitUpgrade",t.S2CRepGrowupTujianUpgrade="S2CRepGrowupTujianUpgrade",t.S2CRepGrowupTujianSuitActivate="S2CRepGrowupTujianSuitActivate",t.UpdateRoleRed="UpdateRoleRed",t.UpdateFashionRed="UpdateFashionRed",t.UpdateFuyinRed="UpdateFuyinRed",t.UpdateTujianRed="UpdateTujianRed",t.UpdateGodEquipRed="UpdateGodEquipRed",t.S2CRepWeaponGetInfo="S2CRepWeaponGetInfo",t.S2CRepWeaponSingleUpgrade="S2CRepWeaponSingleUpgrade",t.S2CRepWeaponBookUpgrade="S2CRepWeaponBookUpgrade",t.S2CRepWeaponSwallow="S2CRepWeaponSwallow",t.S2CRepWeaponChangeHuaxing="S2CRepWeaponChangeHuaxing",t.S2CRepWeaponSingleUpgradeExtend="S2CRepWeaponSingleUpgradeExtend",t.updateWeaponRed="updateWeaponRed",t.S2CRepWeaponAddTimeLimitItem="S2CRepWeaponAddTimeLimitItem",t.S2CRepWeaponDelTimeLimitItem="S2CRepWeaponDelTimeLimitItem",t.S2CRepStoreGetInfo="S2CRepStoreGetInfo",t.S2CRepStoreRefresh="S2CRepStoreRefresh",t.S2CRepStoreBuy="S2CRepStoreBuy",t.S2CRepStoreLimitUpdate="S2CRepStoreLimitUpdate",t.S2CRepStoreBuyRecord="S2CRepStoreBuyRecord",t.S2CRepStoreOpen="S2CRepStoreOpen",t.ShowStoreBuyTips="ShowStoreBuyTips",t.S2CRepStoreGetBaokuInfo="S2CRepStoreGetBaokuInfo",t.S2CRepStoreBaokuExchange="S2CRepStoreBaokuExchange",t.RefreshStoreRed="RefreshStoreRed",t.ShowBossStoreBuyTips="ShowBossStoreBuyTips",t.RefreshBossStoreID="RefreshBossStoreID",t.S2CRepMailListInfo="S2CRepMailListInfo",t.S2CRepMailInfo="S2CRepMailInfo",t.S2CRepMailReadMail="S2CRepMailReadMail",t.S2CRepMailNotifyNewMail="S2CRepMailNotifyNewMail",t.S2CRepMailNotifyDelMail="S2CRepMailNotifyDelMail",t.S2CRepMailNotifyRetrieveAttachment="S2CRepMailNotifyRetrieveAttachment",t.RefreshMailRed="RefreshMailRed",t.S2CRepFactionswordGetInfo="S2CRepFactionswordGetInfo",t.S2CRepFactionswordRefreshOpp="S2CRepFactionswordRefreshOpp",t.S2CRepFactionswordChallenge="S2CRepFactionswordChallenge",t.S2CRepFactionswordSweep="S2CRepFactionswordSweep",t.S2CRepFactionswordUpdateInfo="S2CRepFactionswordUpdateInfo",t.S2CRepFactionswordGetRankList="S2CRepFactionswordGetRankList",t.S2CRepFactionswordGetScoreAward="S2CRepFactionswordGetScoreAward",t.S2CRepFactionswordChallengeResult="S2CRepFactionswordChallengeResult",t.S2CRepFactionswordUpdateReport="S2CRepFactionswordUpdateReport",t.S2CRepFactionGetLeaderBattleInfo="S2CRepFactionGetLeaderBattleInfo",t.S2CRepFactionGetBattleRanklist="S2CRepFactionGetBattleRanklist",t.S2CRepFactionSetAutoMatch="S2CRepFactionSetAutoMatch",t.S2CRepFactionBattleChallenge="S2CRepFactionBattleChallenge",t.S2CRepFactionBattleChallengeResult="S2CRepFactionBattleChallengeResult",t.S2CRepFactionMoBai="S2CRepFactionMoBai",t.S2CRepFactionUpdateTopobjInfo="S2CRepFactionUpdateTopobjInfo",t.S2CRepFactionUpdateBattleAward="S2CRepFactionUpdateBattleAward",t.S2CRepFactionUpdateZhenChuan="S2CRepFactionUpdateZhenChuan",t.S2CRepFactionUpdateChallengeInfo="S2CRepFactionUpdateChallengeInfo",t.S2CRepMiscRename="S2CRepMiscRename",t.S2CRepMiscGetSetupInfo="S2CRepMiscGetSetupInfo",t.S2CRepMiscActiveHead="S2CRepMiscActiveHead",t.S2CRepMiscActiveHeadFrame="S2CRepMiscActiveHeadFrame",t.S2CRepMiscSetHead="S2CRepMiscSetHead",t.S2CRepMiscActiveChatFrame="S2CRepMiscActiveChatFrame",t.S2CRepMiscSetChatFrame="S2CRepMiscSetChatFrame",t.S2CRepFuwenGetInfo="S2CRepFuwenGetInfo",t.S2CRepFuwenUpdateUnlock="S2CRepFuwenUpdateUnlock",t.S2CRepFuwenUpdateGrid="S2CRepFuwenUpdateGrid",t.S2CRepFuwenUpdateBag="S2CRepFuwenUpdateBag",t.S2CRepFuwenUpdateHole="S2CRepFuwenUpdateHole",t.S2CRepFuwenUpdateEssence="S2CRepFuwenUpdateEssence",t.S2CRepFuwenResolveFuwen="S2CRepFuwenResolveFuwen",t.S2CRepFuwenCompose="S2CRepFuwenCompose",t.FwUpdateRed="FwUpdateRed",t.S2CRspWelfareGetInfo="S2CRspWelfareGetInfo",t.S2CRspWelfareGetLoginAward="S2CRspWelfareGetLoginAward",t.S2CRspWelfareSignin="S2CRspWelfareSignin",t.S2CRspWelfareSigninRedeem="S2CRspWelfareSigninRedeem",t.S2CRspWelfareGetOnlineAward="S2CRspWelfareGetOnlineAward",t.S2CRspWelfareGetWeekCardAward="S2CRspWelfareGetWeekCardAward",t.S2CRepWelfareCdkeyGiftBag="S2CRepWelfareCdkeyGiftBag",t.S2CRspWelfareGetSystemAward="S2CRspWelfareGetSystemAward",t.RefreshOnlineAward="RefreshOnlineAward",t.RefreshWelfareRed="RefreshWelfareRed",t.S2CRspWelfareGetMillionAward="S2CRspWelfareGetMillionAward",t.S2CRspWelfareGetSevenDayAward="S2CRspWelfareGetSevenDayAward",t.S2CRspWelfareInvenstGetInfo="S2CRspWelfareInvenstGetInfo",t.S2CRspWelfareInvenstBuy="S2CRspWelfareInvenstBuy",t.S2CRspWelfareInvenstGetAward="S2CRspWelfareInvenstGetAward",t.S2CRspWelfareFreegiftBuy="S2CRspWelfareFreegiftBuy",t.S2CRspWelfareFreegiftGetAward="S2CRspWelfareFreegiftGetAward",t.S2CRepMiscOtherInfo="S2CRepMiscOtherInfo",t.S2CRepRankGetRanksRole="S2CRepRankGetRanksRole",t.S2CRspWelfareLoginOnlineAward="S2CRspWelfareLoginOnlineAward",t.S2CRspWelfareTopShareAward="S2CRspWelfareTopShareAward",t.S2CTeamcopyGetInfo="S2CTeamcopyGetInfo",t.S2CTeamcopyStartMatching="S2CTeamcopyStartMatching",t.S2CTeamcopyCancelMatching="S2CTeamcopyCancelMatching",t.S2CTeamcopyBuyChallengeCount="S2CTeamcopyBuyChallengeCount",t.S2CTeamcopyMemberChange="S2CTeamcopyMemberChange",t.S2CTeamcopyMatchingSuccess="S2CTeamcopyMatchingSuccess",t.S2CTeamcopyEnd="S2CTeamcopyEnd",t.S2CTeamcopyGuwu="S2CTeamcopyGuwu",t.S2CRepMiscMake="S2CRepMiscMake",t.S2CRepMiscItemSplit="S2CRepMiscItemSplit",t.RefreshMakeRed="RefreshMakeRed",t.addMakeGetIt="addMakeGetIt",t.S2CRepXianyuanGetInfo="S2CRepXianyuanGetInfo",t.S2CRepXianyuanGetPostlist="S2CRepXianyuanGetPostlist",t.S2CRepXianyuanPostXiangqin="S2CRepXianyuanPostXiangqin",t.S2CRepXianyuanPostZhaoqin="S2CRepXianyuanPostZhaoqin",t.S2CRepXianyuanReqMarry="S2CRepXianyuanReqMarry",t.S2CRepXianyuanReplyMarry="S2CRepXianyuanReplyMarry",t.S2CRepXianyuanUpdateXianyuanAward="S2CRepXianyuanUpdateXianyuanAward",t.S2CRepXianyuanUpgradeFlower="S2CRepXianyuanUpgradeFlower",t.S2CRepXianyuanUpgradeRing="S2CRepXianyuanUpgradeRing",t.S2CRepXianyuanUpgradeSkill="S2CRepXianyuanUpgradeSkill",t.S2CRepXianyuanGetRanklist="S2CRepXianyuanGetRanklist",t.S2CRepXianyuanGetTasklist="S2CRepXianyuanGetTasklist",t.S2CRepXianyuanUpdateTaskList="S2CRepXianyuanUpdateTaskList",t.S2CRepXianyuanPostState="S2CRepXianyuanPostState",t.S2CRepXianyuanUpdateCopyInfo="S2CRepXianyuanUpdateCopyInfo",t.S2CRepXianyuanZhaoqinOppInfo="S2CRepXianyuanZhaoqinOppInfo",t.S2CRepXianyuanMarryBattleResult="S2CRepXianyuanMarryBattleResult",t.XyUpdateRed="XyUpdateRed",t.chargeTarget="chargeTarget",t.S2CRepTeamGetInfo="S2CRepTeamGetInfo",t.S2CRepTeamCreate="S2CRepTeamCreate",t.S2CRepTeamLeave="S2CRepTeamLeave",t.S2CRepTeamPromote="S2CRepTeamPromote",t.S2CRepTeamRemove="S2CRepTeamRemove",t.S2CRepTeamInvite="S2CRepTeamInvite",t.S2CRepTeamApply="S2CRepTeamApply",t.S2CRepTeamReplyInvite="S2CRepTeamReplyInvite",t.S2CRepTeamReplyApply="S2CRepTeamReplyApply",t.S2CRepTeamAutoAccept="S2CRepTeamAutoAccept",t.S2CRepTeamGetSceneTeam="S2CRepTeamGetSceneTeam",t.S2CTeamInfoChange="S2CTeamInfoChange",t.getOpenInitView="getOpenInitView",t.S2CRepActivityInfos="S2CRepActivityInfos",t.S2CRepActivityFinish="S2CRepActivityFinish",t.S2CRepActivityStart="S2CRepActivityStart",t.ActivityStateChange="ActivityStateChange",t.S2CRepMiscGetSaveInfo="S2CRepMiscGetSaveInfo",t.S2CRepLimitActOpen="S2CRepLimitActOpen",t.S2CRepLimitActClose="S2CRepLimitActClose",t.S2CRepLimitActGetInfo="S2CRepLimitActGetInfo",t.S2CRepLimitActDel="S2CRepLimitActDel",t.S2CRepLimitActUpdate="S2CRepLimitActUpdate",t.S2CRepLimitActGetReward="S2CRepLimitActGetReward",t.S2CRepLimitActGetList="S2CRepLimitActGetList",t.S2CRepLimitActGetGiftPack="S2CRepLimitActGetGiftPack",t.S2CRepLimitActGetTimes="S2CRepLimitActGetTimes",t.S2CRepLimitActRechargeRecord="S2CRepLimitActRechargeRecord",t.S2CRepLimitActGetRankData="S2CRepLimitActGetRankData",t.S2CRepLimitActItemExchange="S2CRepLimitActItemExchange",t.S2CRepLimitActChargeNum="S2CRepLimitActChargeNum",t.S2CRepLimitActGetExchangeData="S2CRepLimitActGetExchangeData",t.S2CRepLimitActExchangeItem="S2CRepLimitActExchangeItem",t.S2CRepLimitActBuyGift="S2CRepLimitActBuyGift",t.S2CRepLimitActRemove="S2CRepLimitActRemove",t.S2CRepLimitActConsumeRank="S2CRepLimitActConsumeRank",t.S2CRepLimitActGetVipAward="S2CRepLimitActGetVipAward",t.S2CRepLimitActLotteryInfo="S2CRepLimitActLotteryInfo",t.S2CRepLimitActLotteryTake="S2CRepLimitActLotteryTake",t.S2CRepLimitActGetJackpot="S2CRepLimitActGetJackpot",t.S2CRepLimitActLotteryOpenBox="S2CRepLimitActLotteryOpenBox",t.S2CRepLimitActGetStateInfo="S2CRepLimitActGetStateInfo",t.S2CRepLimitActUpdateStateInfo="S2CRepLimitActUpdateStateInfo",t.S2CRepLimitActBuySmGift="S2CRepLimitActBuySmGift",t.S2CRepLimitActSmGiftAppear="S2CRepLimitActSmGiftAppear",t.S2CPvpGetInfo="S2CPvpGetInfo",t.S2CPvpStartMatching="S2CPvpStartMatching",t.S2CPvpCancelMatching="S2CPvpCancelMatching",t.S2CPvpMatchingResult="S2CPvpMatchingResult",t.S2CPvpFightResult="S2CPvpFightResult",t.S2CPvpGetDailyAward="S2CPvpGetDailyAward",t.S2CPvpBuyTimes="S2CPvpBuyTimes",t.S2CPvpGetRankList="S2CPvpGetRankList",t.S2CPvpGetReport="S2CPvpGetReport",t.S2CPvpGuessVote="S2CPvpGuessVote",t.S2CPvpGetGuessInfo="S2CPvpGetGuessInfo",t.S2CPvpUpdateReport="S2CPvpUpdateReport",t.S2CPvpGetSelfTopReport="S2CPvpGetSelfTopReport",t.S2CRepSystemopenGetInfo="S2CRepSystemopenGetInfo",t.S2CRepSystemopenOpen="S2CRepSystemopenOpen",t.XiuXianUpdate="XiuXianUpdate",t.ZhuanUpdate="ZhuanUpdate",t.S2CRepYezhanGetInfo="S2CRepYezhanGetInfo",t.S2CRepYezhanBuyTimes="S2CRepYezhanBuyTimes",t.S2CRepYezhanRefreshOpp="S2CRepYezhanRefreshOpp",t.S2CRepYezhanGuwu="S2CRepYezhanGuwu",t.S2CRepYezhanChallenge="S2CRepYezhanChallenge",t.S2CRepYezhanChallengeResult="S2CRepYezhanChallengeResult",t.S2CRepYezhanUpdate="S2CRepYezhanUpdate",t.S2CRepFindtreasureGetInfo="S2CRepFindtreasureGetInfo",t.S2CRepFindtreasureFind="S2CRepFindtreasureFind",t.S2CRepFindtreasureExchange="S2CRepFindtreasureExchange",t.S2CRepFindtreasureGetExpItem="S2CRepFindtreasureGetExpItem",t.S2CRepFindtreasureMsgInfo="S2CRepFindtreasureMsgInfo",t.RefreshFindtreasureRed="RefreshFindtreasureRed",t.S2CRepFindtreasureStoreInfo="S2CRepFindtreasureStoreInfo",t.S2CRepActivitySpecialRightsData="S2CRepActivitySpecialRightsData",t.S2CRepActivitySpecialReward="S2CRepActivitySpecialReward",t.S2CRepActivityGetExtraAward="S2CRepActivityGetExtraAward",t.S2CRepActivityGetBigAward="S2CRepActivityGetBigAward",t.S2CRepActivityGetExpBead="S2CRepActivityGetExpBead",t.S2CRepVipGiftData="S2CRepVipGiftData",t.S2CRepVipGetFreeGift="S2CRepVipGetFreeGift",t.S2CVipGetTimes="S2CVipGetTimes",t.S2CRepVipGetOnlineAward="S2CRepVipGetOnlineAward",t.S2CRepVipGetDiscountGift="S2CRepVipGetDiscountGift",t.RefreshVipRed="RefreshVipRed",t.RecommendItem="RecommendItem",t.GuideDoEvent="GuideDoEvent",t.S2CRepGrowupGetGuideInfo="S2CRepGrowupGetGuideInfo",t.S2CRepFabaoGetTreasureInfo="S2CRepFabaoGetTreasureInfo",t.S2CRepFabaoUpdateTreasure="S2CRepFabaoUpdateTreasure",t.NoticeUpdate="NoticeUpdate",t.UpdateServerList="UpdateServerList",t.IsLoginSdk="IsLoginSdk",t.ShouQuanResult="ShouQuanResult",t.S2CVisibleObjEnterRole="S2CVisibleObjEnterRole",t.S2CCharacterDead="S2CCharacterDead",t.S2CVisibleObjLeave="S2CVisibleObjLeave",t.S2CRepMiscDailyChange="S2CRepMiscDailyChange",t.PlayYanHua="PlayYanHua",t.S2CRepLimitActTimeActGetInfo="S2CRepLimitActTimeActGetInfo",t.S2CRepLimitActTimeActUpdate="S2CRepLimitActTimeActUpdate",t.S2CRepLimitActTimeActGetAward="S2CRepLimitActTimeActGetAward",t.freshLimitActRed="freshLimitActRed",t.S2CRepFabaoGetBaowuInfo="S2CRepFabaoGetBaowuInfo",t.S2CRepFabaoBaowuUpgrade="S2CRepFabaoBaowuUpgrade",t.S2CRepFabaoBaowuSwallow="S2CRepFabaoBaowuSwallow",t.BaowuRedRefresh="BaowuRedRefresh",t.UpdateBossRevive="UpdateBossRevive",t.ChangeMainAchorState="ChangeMainAchorState",t.ChangeXianFuState="ChangeXianFuState",t.ChangeBGIsland="ChangeBGIsland",t.S2CRepGrowupGetDujieInfo="S2CRepGrowupGetDujieInfo",t.S2CRepGrowupUpdateDujieTaskInfo="S2CRepGrowupUpdateDujieTaskInfo",t.S2CRepGrowupDujieCopyResult="S2CRepGrowupDujieCopyResult",t.S2CRepGrowupGetDujieTaskAward="S2CRepGrowupGetDujieTaskAward",t.S2CRepIntensifyGetRefineInfo="S2CRepIntensifyGetRefineInfo",t.S2CRepIntensifyUpgradeRefine="S2CRepIntensifyUpgradeRefine",t.S2CRepIntensifySuitRefine="S2CRepIntensifySuitRefine",t.UpdateTaozhuangRed="UpdateTaozhuangRed",t.S2CRepGrowupGetTaozhuangInfo="S2CRepGrowupGetTaozhuangInfo",t.S2CRepGrowupUpdateTaozhuang="S2CRepGrowupUpdateTaozhuang",t.UpdateSetUp="UpdateSetUp",t.S2CRepGrowupEquipSuitUpdate="S2CRepGrowupEquipSuitUpdate",t.S2CRepGrowupEquipSwallowGetInfo="S2CRepGrowupEquipSwallowGetInfo",t.FacFightPushTips="FacFightPushTips",t.S2CLeitaiBuyTimes="S2CLeitaiBuyTimes",t.S2CLeitaiGetDailyAward="S2CLeitaiGetDailyAward",t.S2CLeitaiFightResult="S2CLeitaiFightResult",t.S2CLeitaiGetInfo="S2CLeitaiGetInfo",t.S2CLeitaiGetRankList="S2CLeitaiGetRankList",t.S2CLeitaiMobai="S2CLeitaiMobai",t.updateLv="updateLv",t.nextModelData="nextModelData",t.openFirst="openFirst",t.RefreshRelicItem="RefreshRelicItem",t.RefreshRelicItemByBag="RefreshRelicItemByBag",t.updateList="updateList",t.updateFight="updateFight",t.S2CRepFactionGetFactionattackInfo="S2CRepFactionGetFactionattackInfo",t.S2CRepFactionGetAttackDailyAward="S2CRepFactionGetAttackDailyAward",t.S2CRepFactionEnterFactionAttack="S2CRepFactionEnterFactionAttack",t.S2CRepFactionUpdateFirstRoleInfo="S2CRepFactionUpdateFirstRoleInfo",t.S2CRepFactionUpdateBattleInfo="S2CRepFactionUpdateBattleInfo",t.S2CRepFactionUpdateScoreAward="S2CRepFactionUpdateScoreAward",t.S2CRepFactionUpdateObjInfo="S2CRepFactionUpdateObjInfo",t.S2CRepFactionUpdateBattleResult="S2CRepFactionUpdateBattleResult",t.S2CRepFactionMultiKillNotice="S2CRepFactionMultiKillNotice",t.UpdateZPZBSceneItem="UpdateZPZBSceneItem",t.S2CRepFactionAddScoreNotice="S2CRepFactionAddScoreNotice",t.UpdateAttackType="UpdateAttackType",t.S2CRepKnapsackGetUseCount="S2CRepKnapsackGetUseCount",t.S2CRepTaskGetDailyTaskInfo="S2CRepTaskGetDailyTaskInfo",t.S2CRepTaskUpdateDailyTask="S2CRepTaskUpdateDailyTask",t.S2CRepTaskDailyTaskCopyResult="S2CRepTaskDailyTaskCopyResult",t.S2CRepTitleGetXianweiInfo="S2CRepTitleGetXianweiInfo",t.S2CRepTitleUpgradeXianwei="S2CRepTitleUpgradeXianwei",t
}();__reflect(EventType.prototype,"EventType");var CommonView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="CommonBgSkin",this.rechargebtn.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rechargebtn,this.OnRechargeClick),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney),this.ShowMoney()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rechargebtn,this.OnRechargeClick),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney)},e.prototype.OnRechargeClick=function(t){NoticeProxy.ins().OpenRecharge()},e.prototype.SetName=function(t){this.titleImg.source=t},e.prototype.UpdataMoney=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];(i==MoneyAttr.COIN||i==MoneyAttr.YUANBAO)&&this.ShowMoney()},e.prototype.ShowMoney=function(){this.jbLab.text=UtilProxy.getNumLab(RoleProxy.ins().getMoneyAttr(MoneyAttr.COIN)),this.ybLab.text=UtilProxy.getNumLab(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO))},e}(BaseEuiView);__reflect(CommonView.prototype,"CommonView"),window.CommonView=CommonView;var GameGuider=function(){function t(){}return t.taskGuidance=function(t,e){switch(e){case 0:break;case 1:}},t.guidance=function(t,e){void 0===e&&(e=-1);var i=-1!=e?e:null;ViewManager.ins().open(t,i)},t}();__reflect(GameGuider.prototype,"GameGuider");var ModelGM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ModelTest"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.OnClick),this.RefeshInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.OnClick)},e.prototype.OnClick=function(t){this.RefeshInfo()},e.prototype.RefeshInfo=function(){this.model.removeChildren(),""!=this.model_x.text&&(this.model.x=Number(this.model_x.text)),""!=this.model_y.text&&(this.model.y=Number(this.model_y.text));var t=0;if(""!=this.model_type.text&&(t=Number(this.model_type.text)),3==t)UtilProxy.GetMovieClipById(Number(this.model_id.text),this.model);else if(2==t){var e=new egret.MovieClip;UtilProxy.GetMovieClip(this.model_id.text,e,-1,void 0),this.model.addChild(e)}else if(1==t){var i=new eui.Image;i.source=this.model_id.text,this.model.addChild(i)}},e}(BaseEuiView);__reflect(ModelGM.prototype,"ModelGM"),ViewManager.ins().reg(ModelGM,LayerManager.UI_Popup),window.ModelGM=ModelGM;var ContinuousActView=function(t){function e(){var e=t.call(this)||this;return e.nowClick=0,e.nextday=1,e.give=!1,e.over=!1,e.clickOk=!1,e.manyDay=0,e.maxday=0,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ContinuousActSkin",this.sc_item.viewport=this.list,this.list.itemRenderer=ItemCell,this.setVisible(!1),this.hasget.visible=!1;for(var t=0;7>t;t++)this["i"+t].visible=!1,this["red"+t].visible=!1;this.ov.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandler,this),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandler,this),this.itemCell.clear(),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.touchTapHandler=function(t){switch(t.target){case this.btn0:NoticeProxy.ins().OpenRecharge();break;case this.btn:if(this.sevenDay.params[1]<this.maxday&&null!=this.dataSource&&this.dataSource.is_completed)LimitActProxy.ins().C2SReqLimitActGetReward(this.currentModel.id),this.btn.visible=!this.dataSource.is_get;else if(LimitActProxy.ins().manyDaybySevnen.length>=this.maxday)for(var e=0;2>e;e++)LimitActProxy.ins().C2SReqLimitActGetReward(this.listdata[e].id);else TipsControl.ins().showTips("第"+this.nextday+"天充值后即可领取大奖!")}for(var e=0;7>e;e++)if(t.target===this["img"+e]){this.clickOk=!0,this.nowClick=e,this.nextday=e+1,this.ShowInfo();break}},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.BtnStage=function(t){1==t?(this.dataSource=null,this.hasget.visible=!1,this.btn.visible=!0,this.btn.getChildAt(2).visible=!1):(this.btn.visible=!this.dataSource.is_get,this.hasget.visible=this.dataSource.is_get,this.btn.getChildAt(2).visible=this.dataSource.is_completed&&!this.dataSource.is_get)},e.prototype.showReward=function(t){for(var e=[],i=LimitActProxy.ins().getLianChong(t[0].id),n=0;n<i.length;n++){var o=GlobalConfig.getActivity_dataConfig(i[n]);e.push(o)}this.currentModel=t[0];var s=i.indexOf(this.currentModel.id);this.clickOk||(this.nowClick=s);var r=0;s>-1&&(r=s+1);for(var n=0;7>n;n++)s>n?this["img"+n].source="lianchong_json.lianchongdali_btn_red":this["img"+n].source="lianchong_json.lianchongdali_btn_blue",this["g"+n].visible=void 0!=e[n];this.dataSource=LimitActProxy.ins().GetActivityData(i[this.nowClick]),this.dataSource?(this.btn.visible=!this.dataSource.is_get,this.hasget.visible=this.dataSource.is_get,this.btn.getChildAt(2).visible=this.dataSource.is_completed&&!this.dataSource.is_get):(this.btn.visible=!0,this.hasget.visible=!1,this.btn.getChildAt(2).visible=!1),this.nowClick<s?(this.over=!0,this.hasget.visible=this.btn.visible=this.btn.getChildAt(2).visible=!1,this.jieshu.visible=!0):(this.jieshu.visible=!1,this.over=!1),LimitActProxy.ins().manyDaybySevnen=[];for(var a,n=0;r>n;n++)a=LimitActProxy.ins().GetActivityData(i[0]+n),a&&a.is_completed&&LimitActProxy.ins().manyDaybySevnen.push(n);this.sevenDay=LimitActProxy.ins().GetActivityData(t[t.length-1].id);var h=LimitActProxy.ins().GetActivityData(this.currentModel.id),l=h.params[0]||0,p=h.params.length;h&&h.is_completed&&h.is_get===!1?this["red"+s].visible=!0:this["red"+s].visible=!1;var c=GlobalConfig.getDropConfig(t[t.length-1].act_award[0]),u=GlobalConfig.getDropItem(c.drop);if(this.itemCell.data=UtilProxy.GetItemCellData(u[0][0].id,u[0][0].num),this.over?(this.ov.visible=!0,this.timelab.visible=this.ycz_lb.visible=this.nextlb.visible=!1):this.dataSource?(this.ov.visible=this.nextlb.visible=!1,this.timelab.visible=this.ycz_lb.visible=!0,this.endtime=LimitActProxy.ins().GetActEndTime(this.listdata[0]),this.ShowColdTime()):(this.ycz_lb.visible=this.timelab.visible=this.ov.visible=!1,this.nextlb.visible=!0,this.nextlb.textFlow=UtilProxy.StrFormart("还差: |C:@0 &@1 |天开启",[7,Math.abs(r-this.nextday)])),this.tips.text=UtilProxy.StrFormartStr("今日单笔充值@0 元，即可领取以下大礼",[t[0].act_params[1]/LimitActProxy.ins().rechargeNun]),this.ycz_lb.textFlow=UtilProxy.StrFormart("今日已充值: |C:@0 &@1 |元",[l>=this.currentModel.act_params[1]?7:4,p>0?l/LimitActProxy.ins().rechargeNun:0]),this.bar.maximum=e.length,this.maxday=e.length,this.pic0.source=7==this.maxday?"lianchong_json.lianchong_font_01":"lianchong_json.lianchong_font_01a",this.pic1.source=7==this.maxday?"lianchong_json.lianchong_font_12":"lianchong_json.lianchong_font_12a",this.bar.value=this.sevenDay.params[1],e&&e.length>0){var d=e[this.nowClick].act_award[0];if(d>0)for(var g=new eui.ArrayCollection,y=GlobalConfig.getDropConfig(d),f=GlobalConfig.getDropItem(y.drop),n=0;n<f.length;n++){var _=UtilProxy.GetItemCellData(f[n][0].id,f[n][0].num);g.addItem(_),this.list.dataProvider=g}}},e.prototype.ShowInfo=function(){this.listdata=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type);var t=this.listdata[0];if(void 0!=t){this.showReward(this.listdata);for(var e=0;7>e;e++)this.nowClick==e?this["i"+e].visible=!0:this["i"+e].visible=!1}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeStr(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(ContinuousActView.prototype,"ContinuousActView"),ViewManager.ins().reg(ContinuousActView,LayerManager.UI_Main2),window.ContinuousActView=ContinuousActView;var CostGiftItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="JcAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.lab1.textFlow=UtilProxy.StrFormart("消费 |C:7&@0 | 元宝,可领取：",[t.act_params[1]]);var e=LimitActProxy.ins().GetActivityData(t.id);this.btn.visible=!e.is_get,this.hasget.visible=e.is_get,this.btn.getChildAt(2).visible=e.is_completed&&!e.is_get;var i=e.params[0]||0;this.lab2.visible=!e.is_completed,this.lab2.textFlow=UtilProxy.StrFormart("还需消费 |C:10&@0 | 元宝",[t.act_params[1]-i]),this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var n=t.act_award[0];if(n>0)for(var o=GlobalConfig.getDropConfig(n),s=GlobalConfig.getDropItem(o.drop),r=0;r<s.length;r++){var a=UtilProxy.GetItemCellData(s[r][0].id,s[r][0].num);this.arry.addItem(a)}},e.prototype.onClick=function(t){var e=this.data,i=LimitActProxy.ins().GetActivityData(e.id);if(i){if(0==i.is_completed)return void TipsControl.ins().showTips("目标尚未达到");i.is_get||LimitActProxy.ins().C2SReqLimitActGetReward(e.id)}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(CostGiftItem.prototype,"CostGiftItem"),window.CostGiftItem=CostGiftItem;var CostGiftView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=CostGiftItem,this.tipslab.textFlow=UtilProxy.generateTextFlow("C:7&在神秘商店消费的元宝不计算在内"),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),t.sort(this.sortValue),this.array.removeAll();for(var i in t)this.array.addItem(t[i])}},e.prototype.sortValue=function(t,e){var i=LimitActProxy.ins().GetActivityData(t.id),n=LimitActProxy.ins().GetActivityData(e.id);if(i.is_get==n.is_get){if(t.id>e.id)return 1;if(t.id<e.id)return-1}else{if(i.is_get)return 1;if(n.is_get)return-1}return 0},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(CostGiftView.prototype,"CostGiftView"),window.CostGiftView=CostGiftView;var CumulatuveRechageItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="CumulatuveRechageItemSkin",this.awardlist.itemRenderer=ItemCell,this.addTouchEvent(this.btn,this.onClick)},e.prototype.dataChanged=function(){var t=this.data.Config;this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.label_1.textFlow=UtilProxy.StrFormart("C:5&累积首充@0 次",[this.data[t.id]]),this.arry.removeAll();var e=LimitActProxy.ins().GetActivityData(t.id),i=t.act_award[0];if(i>0)for(var n=GlobalConfig.getDropConfig(i),o=GlobalConfig.getDropItem(n.drop),s=0;s<o.length;s++){var r=UtilProxy.GetItemCellData(o[s][0].id,o[s][0].num);this.arry.addItem(r)}var a=!0;e.is_completed&&e.is_get?a=!1:(a=!0,this.btn.label=0==e.is_completed?"前往充值":"领取奖励",this.btn.icon=0==e.is_completed?"common_btn_big_blue":"common_btn_big_yellow"),this.btn.visible=a,this.hasget.visible=!a},e.prototype.onClick=function(t){var e=this.data.Config,i=LimitActProxy.ins().GetActivityData(e.id);i.is_completed&&!i.is_get?LimitActProxy.ins().C2SReqLimitActGetReward(e.id):i.is_completed||ViewManager.ins().open(RechargeView)},e}(BaseItemRender);__reflect(CumulatuveRechageItem.prototype,"CumulatuveRechageItem"),window.CumulatuveRechageItem=CumulatuveRechageItem;var CumulatuveRechageView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scroller.viewport=this.list,this.list.itemRenderer=CumulatuveRechageItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),void 0==this.array&&(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll();var i=1,n=0;for(var o in t){var s={};s[t[o].id]=i,s.Config=t[o],this.array.addItem(s),i+=1;var r=LimitActProxy.ins().GetActivityData(t[o].id);r.is_completed&&(n+=1)}this.label_count.textFlow=UtilProxy.StrFormart("累积每日首充次数:@0 ",[n])}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelabel.text=""},e.prototype.SetTimeLab=function(){this.timelabel.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(CumulatuveRechageView.prototype,"CumulatuveRechageView"),window.CumulatuveRechageView=CumulatuveRechageView;var FanliActItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="JcAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.lab1.textFlow=UtilProxy.StrFormart("累计充值 |C:7&@0 | 元,可领取：",[t.act_params[0]/LimitActProxy.ins().rechargeNun]);var e=LimitActProxy.ins().GetActivityData(t.id);this.btn.visible=!e.is_get,this.hasget.visible=e.is_get,this.btn.getChildAt(2).visible=e.is_completed&&!e.is_get;var i=e.params[0]||0;this.lab2.textFlow=UtilProxy.StrFormart("已充值 |C:@0 &@1 |/@2  元",[i>=t.act_params[0]?7:4,i>0?i/LimitActProxy.ins().rechargeNun:0,t.act_params[0]/LimitActProxy.ins().rechargeNun]),this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var n=t.act_award[0];if(n>0)for(var o=GlobalConfig.getDropConfig(n),s=GlobalConfig.getDropItem(o.drop),r=0;r<s.length;r++){var a=UtilProxy.GetItemCellData(s[r][0].id,s[r][0].num);this.arry.addItem(a)}},e.prototype.onClick=function(t){var e=this.data,i=LimitActProxy.ins().GetActivityData(e.id);if(i){if(0==i.is_completed)return void TipsControl.ins().showTips("目标尚未达到");i.is_get||LimitActProxy.ins().C2SReqLimitActGetReward(e.id)}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(FanliActItem.prototype,"FanliActItem"),window.FanliActItem=FanliActItem;var FanliActView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=FanliActItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),t.sort(this.sortValue),this.array.removeAll();var i=!0,n=[];for(var o in t){var s=LimitActProxy.ins().GetActivityData(t[o].id);s.is_completed&&s.params[0]/LimitActProxy.ins().rechargeNun>=1e3&&(i=!0),t[o].act_params[0]/LimitActProxy.ins().rechargeNun<=1e3?this.array.addItem(t[o]):n.push(t[o])}if(i)for(var o in n)this.array.addItem(n[o])}},e.prototype.sortValue=function(t,e){var i=LimitActProxy.ins().GetActivityData(t.id),n=LimitActProxy.ins().GetActivityData(e.id);if(i.is_get==n.is_get){if(t.id>e.id)return 1;if(t.id<e.id)return-1}else{if(i.is_get)return 1;if(n.is_get)return-1}return 0},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeStr(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(FanliActView.prototype,"FanliActView"),window.FanliActView=FanliActView;var JcActivityView=function(t){function e(){var e=t.call(this)||this;return e.viewList={CostGiftView:void 0,FanliActView:void 0,LandingGiftView:void 0,RechargeActView:void 0,ContinuousActView:void 0,CumulatuveRechageView:void 0},e.defaultindex=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="JcActivitySkin",this.CostGiftView.initUI(),this.FanliActView.initUI(),this.LandingGiftView.initUI(),this.RechargeActView.initUI(),this.RechargeTrunView.initUI(),this.ContinuousActView.initUI(),this.CumulatuveRechageView.initUI(),this.viewList.CostGiftView=this.CostGiftView,this.viewList.FanliActView=this.FanliActView,this.viewList.LandingGiftView=this.LandingGiftView,this.viewList.RechargeActView=this.RechargeActView,this.viewList.RechargeTrunView=this.RechargeTrunView,this.viewList.ContinuousActView=this.ContinuousActView,this.viewList.CumulatuveRechageView=this.CumulatuveRechageView,this.IntBtnList()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.titlebg.source="jingcaihuodong_title_font",this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);if(EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActGetVipAward,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.RefreshBtn),this.CostGiftView.open(),this.FanliActView.open(),this.LandingGiftView.open(),this.RechargeActView.open(),this.RechargeTrunView.open(),this.ContinuousActView.open(),this.CumulatuveRechageView.open(),this.RefreshBtn(),void 0==LimitActProxy.ins().GetJCTabCf())return void TimerManager.ins().doTimerDelay(500,500,1,function(){ViewManager.ins().close(this)},this);var n=t[0]||this.defaultindex;this.SetBtnIndex(n)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetVipAward,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.RefreshBtn),this.CostGiftView.close(),this.FanliActView.close(),this.LandingGiftView.close(),this.RechargeActView.close(),this.RechargeTrunView.close(),this.ContinuousActView.close(),this.CumulatuveRechageView.close()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){if(0!=LimitActProxy.ins().CurSelectType)return void TipsControl.ins().showTips("正在抽奖中");var e=this.btns.indexOf(t.currentTarget);this.SetBtnIndex(e)},e.prototype.IntBtnList=function(){var t=GlobalConfig.getJCViewTab();this.btns=[],this.btns_g.removeChildren();for(var e in t){var i=new eui.Button;i.skinName="ActivityBtn",t[e]&&this.viewList[t[e].page_view]&&(this.viewList[t[e].page_view].act_type=t[e].act_type,this.viewList[t[e].page_view].sub_type=t[e].sub_type,i.icon=t[e].btn_icon),this.btns.push(i),this.btns_g.addChild(i)}},e.prototype.RefreshBtn=function(){for(var t=GlobalConfig.getJCViewTab(),e=0;e<this.btns.length;e++)if(this.btns[e].visible=!1,this.btns[e].includeInLayout=!1,t[e+1]&&this.viewList[t[e+1].page_view]){var i=0!=t[e+1].sub_type?t[e+1].sub_type:void 0,n=LimitActProxy.ins().GetActivityCfgs(t[e+1].act_type,i);if(this.btns[e].visible=n.length>0,this.btns[e].includeInLayout=n.length>0,n.length>0&&-1==this.defaultindex&&(this.defaultindex=e),n[0]&&""!=n[0].btn_title){var o=this.btns[e].getChildAt(3);o.visible=!0,o.source=n[0].btn_title}n.length>0&&(this.btns[e].getChildAt(4).visible=LimitActProxy.ins().GetRedByType(t[e+1].act_type,i))}},e.prototype.SetBtnIndex=function(t){if(0!=this.btns[t].visible){this.curbtn&&(this.curbtn.getChildAt(1).visible=!1),this.curbtn=this.btns[t],this.curbtn.getChildAt(1).visible=!0;var e=GlobalConfig.getJc_actviewtabConfig(t+1);e&&this.viewList[e.page_view]&&(this.viewList[e.page_view].act_type=e.act_type,this.viewList[e.page_view].sub_type=e.sub_type,this.curView&&this.curView.setVisible(!1),this.curView=this.viewList[e.page_view],this.curView.setVisible(!0))}},e}(BaseEuiView);__reflect(JcActivityView.prototype,"JcActivityView"),ViewManager.ins().reg(JcActivityView,LayerManager.UI_Main2),window.JcActivityView=JcActivityView;var JieriActivityView=function(t){function e(){var e=t.call(this)||this;return e.viewList={CostGiftView:void 0,FanliActView:void 0,LandingGiftView:void 0,RechargeActView:void 0,ContinuousActView:void 0,CumulatuveRechageView:void 0},e.defaultindex=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="JcActivitySkin",this.CostGiftView.initUI(),this.FanliActView.initUI(),this.LandingGiftView.initUI(),this.RechargeActView.initUI(),this.RechargeTrunView.initUI(),this.ContinuousActView.initUI(),this.CumulatuveRechageView.initUI(),this.viewList.CostGiftView=this.CostGiftView,this.viewList.FanliActView=this.FanliActView,this.viewList.LandingGiftView=this.LandingGiftView,this.viewList.RechargeActView=this.RechargeActView,this.viewList.RechargeTrunView=this.RechargeTrunView,this.viewList.ContinuousActView=this.ContinuousActView,this.viewList.CumulatuveRechageView=this.CumulatuveRechageView,this.IntBtnList()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.titlebg.source="title_jieriqingdian",this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);if(EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActGetVipAward,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.RefreshBtn),this.CostGiftView.open(),this.FanliActView.open(),this.LandingGiftView.open(),this.RechargeActView.open(),this.RechargeTrunView.open(),this.ContinuousActView.open(),this.CumulatuveRechageView.open(),this.RefreshBtn(),void 0==LimitActProxy.ins().GetJieRiTabCf())return void ViewManager.ins().close(this);var n=t[0]||this.defaultindex;this.SetBtnIndex(n)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetVipAward,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.RefreshBtn),this.CostGiftView.close(),this.FanliActView.close(),this.LandingGiftView.close(),this.RechargeActView.close(),this.RechargeTrunView.close(),this.ContinuousActView.close(),this.CumulatuveRechageView.close()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){if(0!=LimitActProxy.ins().CurSelectType)return void TipsControl.ins().showTips("正在抽奖中");var e=this.btns.indexOf(t.currentTarget);this.SetBtnIndex(e)},e.prototype.IntBtnList=function(){var t=GlobalConfig.getJieRiViewTab();this.btns=[],this.btns_g.removeChildren();for(var e in t){var i=new eui.Button;i.skinName="ActivityBtn",t[e]&&this.viewList[t[e].page_view]&&(this.viewList[t[e].page_view].act_type=t[e].act_type,this.viewList[t[e].page_view].sub_type=t[e].sub_type,i.icon=t[e].btn_icon),this.btns.push(i),this.btns_g.addChild(i)}},e.prototype.RefreshBtn=function(){for(var t=GlobalConfig.getJieRiViewTab(),e=0;e<this.btns.length;e++)if(this.btns[e].visible=!1,this.btns[e].includeInLayout=!1,t[e+1]&&this.viewList[t[e+1].page_view]){var i=0!=t[e+1].sub_type?t[e+1].sub_type:void 0,n=LimitActProxy.ins().GetActivityCfgs(t[e+1].act_type,i);if(this.btns[e].visible=n.length>0,this.btns[e].includeInLayout=n.length>0,n.length>0&&-1==this.defaultindex&&(this.defaultindex=e),n[0]&&""!=n[0].btn_title){var o=this.btns[e].getChildAt(3);o.visible=!0,o.source=n[0].btn_title}n.length>0&&(this.btns[e].getChildAt(4).visible=LimitActProxy.ins().GetRedByType(t[e+1].act_type,i))}},e.prototype.SetBtnIndex=function(t){if(0!=this.btns[t].visible){this.curbtn&&(this.curbtn.getChildAt(1).visible=!1),this.curbtn=this.btns[t],this.curbtn.getChildAt(1).visible=!0;var e=GlobalConfig.getJieri_actviewtabConfig(t+1);e&&this.viewList[e.page_view]&&(this.viewList[e.page_view].act_type=e.act_type,this.viewList[e.page_view].sub_type=e.sub_type,this.curView&&this.curView.setVisible(!1),this.curView=this.viewList[e.page_view],this.curView.setVisible(!0))}},e}(BaseEuiView);__reflect(JieriActivityView.prototype,"JieriActivityView"),ViewManager.ins().reg(JieriActivityView,LayerManager.UI_Main2),window.JieriActivityView=JieriActivityView;var LandGiftItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell,this.lab2.visible=!1},e.prototype.setSkinName=function(){this.skinName="JcAwardItemSkin"},e.prototype.dataChanged=function(){var t=GlobalConfig.getActivity_dataConfig(this.data.act_id);if(this.lab1.text=0==this.data.index?"今日可领取":t.vip_award[this.data.index-1][0]>18?UtilProxy.getStr("SVIP@0  可额外领取",[t.vip_award[this.data.index-1][0]-18]):UtilProxy.getStr("VIP@0  可额外领取",[t.vip_award[this.data.index-1][0]]),0==this.data.index){var e=LimitActProxy.ins().GetActivityData(t.id);this.btn.visible=!e.is_get,this.hasget.visible=e.is_get,this.btn.getChildAt(2).visible=e.is_completed&&!e.is_get}else{var i=LimitActProxy.ins().IsVIPAwardHasGet(this.data.act_id,this.data.index);this.btn.visible=!i,this.hasget.visible=i,this.btn.getChildAt(2).visible=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=t.vip_award[this.data.index-1][0]}this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var n=this.data.drop_id;if(n>0)for(var o=GlobalConfig.getDropConfig(n),s=GlobalConfig.getDropItem(o.drop),r=0;r<s.length;r++){var a=UtilProxy.GetItemCellData(s[r][0].id,s[r][0].num);this.arry.addItem(a)}},e.prototype.onClick=function(t){if(0==this.data.index)LimitActProxy.ins().C2SReqLimitActGetReward(this.data.act_id);else{var e=GlobalConfig.getActivity_dataConfig(this.data.act_id);if(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)<e.vip_award[this.data.index-1][0])return void TipsControl.ins().showTips("请提升您的VIP等级");LimitActProxy.ins().IsVIPAwardHasGet(this.data.act_id,this.data.index)||LimitActProxy.ins().C2SReqLimitActGetVipAward(this.data.act_id,this.data.index)}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(LandGiftItem.prototype,"LandGiftItem"),window.LandGiftItem=LandGiftItem;var LandingGiftView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=LandGiftItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetVipAward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetVipAward,this.ShowInfo)
},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array);var i=LimitActProxy.ins().GetLandingActList(this.sub_type);this.array.removeAll();for(var n in i)this.array.addItem(i[n])}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(LandingGiftView.prototype,"LandingGiftView"),window.LandingGiftView=LandingGiftView;var LimitedFlyGifsView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e.max_buy_times=0,e.vip_step={},e.discounted={6:void 0,5:void 0,4:void 0,3:void 0,2:void 0},e.bg_light={6:void 0,5:void 0,4:void 0,3:void 0,2:void 0},e.discount={6:void 0,5:void 0,4:void 0,3:void 0,2:void 0},e.imglist={6:void 0,5:void 0,4:void 0,3:void 0,2:void 0},e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setVisible(!1),this.discounted[6]=this.bg1_black,this.discounted[5]=this.bg2_black,this.discounted[4]=this.bg3_black,this.discounted[3]=this.bg4_black,this.discounted[2]=this.bg5_black,this.bg_light[6]=this.bg1_light,this.bg_light[5]=this.bg2_light,this.bg_light[4]=this.bg3_light,this.bg_light[3]=this.bg4_light,this.bg_light[2]=this.bg5_light,this.discount[6]=this.discount1_label,this.discount[5]=this.discount2_label,this.discount[4]=this.discount3_label,this.discount[3]=this.discount4_label,this.discount[2]=this.discount5_label,this.imglist[6]=this.img_1,this.imglist[5]=this.img_2,this.imglist[4]=this.img_3,this.imglist[3]=this.img_4,this.imglist[2]=this.img_5,this.progressbar.labelDisplay.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_buy_gift,this.ButGifsOnclick),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){void 0==this.configList&&(this.configList=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type));var t=this.configList[0];if(void 0!=t){if(this.endtime=LimitActProxy.ins().GetActEndTime(t),this.ShowColdTime(),void 0==this.giftlist){var e=LimitActProxy.ins().getGiftDataListById(t.id);this.giftlist=e[0],this.consumeList=this.giftlist.consume[1],this.vip_buy_times=this.giftlist.vip_buy_times;for(var i=0;i<this.consumeList.length;i++){var n=MathUtils.toInteger(this.consumeList[i]/this.giftlist.show_consume[1]*10);null!=this.discount[n]&&(this.discount[n].textFlow=UtilProxy.StrFormart("@0 件开启",[i]),this.discount[n]=null,this.max_buy_times=Math.max(i,this.max_buy_times))}for(var o=0,i=0;i<this.vip_buy_times.length;i++)if(this.vip_buy_times[i]<this.vip_buy_times[i+1]){for(var s=o;i+1>s;s++)this.vip_step[s]={},this.vip_step[s].vip=i+1,this.vip_step[s].step=this.vip_buy_times[i+1];o=i+1}this.max_vip_buy=o}this.gif_text.textFlow=UtilProxy.StrFormart("|C:5&@0 |",[this.giftlist.gift_name]);var r=LimitActProxy.ins().getLimitGiftBuyNum(this.giftlist.id);this.progressbar.maximum=this.max_buy_times,this.progressbar.value=r;var a=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),h=this.vip_buy_times[a]||this.vip_buy_times[this.vip_buy_times.length-1];this.buy_times_text.textFlow=UtilProxy.StrFormart("已购买 |C:7&@0 /@1 | 件",[r,h]),this.max_vip_buy<=a?this.vip_step[this.max_vip_buy-1].vip>18?this.vip_buy_text.textFlow=UtilProxy.StrFormart("SVIP@0 可购买 |C:5&@1 | 件",[this.vip_step[this.max_vip_buy-1].vip-18,this.vip_step[this.max_vip_buy-1].step]):this.vip_buy_text.textFlow=UtilProxy.StrFormart("VIP@0 可购买 |C:5&@1 | 件",[this.vip_step[this.max_vip_buy-1].vip,this.vip_step[this.max_vip_buy-1].step]):this.vip_step[a].vip>18?this.vip_buy_text.textFlow=UtilProxy.StrFormart("SVIP@0 可购买 |C:5&@1 | 件",[this.vip_step[a].vip-18,this.vip_step[a].step]):this.vip_buy_text.textFlow=UtilProxy.StrFormart("VIP@0 可购买 |C:5&@1 | 件",[this.vip_step[a].vip,this.vip_step[a].step]),this.pricepic1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(this.giftlist.consume[0]).displayid),this.pricepic2.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(this.giftlist.consume[0]).displayid),this.pricelab1.text=this.giftlist.show_consume[1];var l=0;if(void 0!=this.consumeList[r]){this.price2=this.consumeList[r];var p=this.consumeList[r];this.pricelab2.textFlow=UtilProxy.StrFormart("C:5&@0 ",[p]),l=MathUtils.toInteger(this.consumeList[r]/this.giftlist.show_consume[1]*10)}else{this.price2=this.consumeList[this.consumeList.length-1];var p=this.consumeList[this.consumeList.length-1];this.pricelab2.textFlow=UtilProxy.StrFormart("C:5&@0 ",[p]),l=MathUtils.toInteger(this.consumeList[this.consumeList.length-1]/this.giftlist.show_consume[1]*10)}this.discount_text.visible=10==l?!1:!0,this.discount_img.visible=10==l?!1:!0,this.discount_text.textFlow=UtilProxy.StrFormart("@0 折",[1==l?0:l]);for(var c in this.discounted)this.discounted[c].visible=Number(c)>=l?!1:!0,this.bg_light[c].visible=Number(c)>=l?!0:!1,this.imglist[c].scaleX=Number(c)>=l?1:.7,this.imglist[c].scaleY=Number(c)>=l?1:.7,this.discounted[c].scaleX=Number(c)>=l?1:.7,this.discounted[c].scaleY=Number(c)>=l?1:.7;var u,d=this.giftlist.reward_id;if(d>0)for(var g=GlobalConfig.getDropConfig(d),y=GlobalConfig.getDropItem(g.drop),i=0;i<y.length;i++){var f=UtilProxy.GetItemCellData(y[i][0].id,y[i][0].num);u=f}this.itemCell.data=u}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.time_text.text=""},e.prototype.SetTimeLab=function(){this.time_text.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.ButGifsOnclick=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO);if(this.price2>t)return void TipsControl.ins().showTips("购买元宝不足！");if(void 0==this.btnCD)this.btnCD=GameLogic.ins().getServerTime();else if(GameLogic.ins().getServerTime()-this.btnCD<.5)return;var e=this.giftlist.id,i=this.giftlist.act_id,n=LimitActProxy.ins().getLimitGiftBuyNum(e),o=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),s=this.vip_buy_times[o]||this.vip_buy_times[this.vip_buy_times.length-1];return n>=s?void TipsControl.ins().showTips("购买次数已达到上限"):void LimitActProxy.ins().C2SReqLimitActBuyGift(e,i)},e}(BaseEuiView);__reflect(LimitedFlyGifsView.prototype,"LimitedFlyGifsView"),window.LimitedFlyGifsView=LimitedFlyGifsView;var LimitedGifsRankItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="LimitedGifsRankItemSkin",this.addTouchEvent(this.btn,this.onClick),this.pricelab_text2.textFlow=UtilProxy.generateTextFlow("C:5&现价")},e.prototype.dataChanged=function(){var t=this.data;this.actConfig=GlobalConfig.getActivity_dataConfig(t.act_id);var e=LimitActProxy.ins().getLimitGiftBuyNum(t.id);this.label_1.textFlow=UtilProxy.StrFormart("C:5&本区财富值达到|C:7&@0 |C:5&开启",[t.wealth]),e>=t.limit_num?this.buy_limit_text.textFlow=UtilProxy.StrFormart("C:4&限购: @0 /@1 ",[t.limit_num-e,t.limit_num]):this.buy_limit_text.textFlow=UtilProxy.StrFormart("C:7&限购: @0 /@1 ",[t.limit_num-e,t.limit_num]),this.pricelab1.text=t.show_consume[1],this.pricelab2.textFlow=UtilProxy.StrFormart("C:5&@0 ",[t.consume[1]]),this.price2=t.consume[1],this.pricepic1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t.consume[0]).displayid),this.pricepic2.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t.consume[0]).displayid);var i,n=t.reward_id;if(n>0)for(var o=GlobalConfig.getDropConfig(n),s=GlobalConfig.getDropItem(o.drop),r=0;r<s.length;r++){var a=UtilProxy.GetItemCellData(s[r][0].id,s[r][0].num);i=a}this.itemCell.data=i,this.pic.visible=""!=i.pic,this.pic.source=i.pic;LimitActProxy.ins().getJackpotScore(this.actConfig.act_type);this.red.visible=this.Check(!0)},e.prototype.Check=function(t){var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO);if(this.price2>e)return 0==t&&TipsControl.ins().showTips("购买元宝不足！"),!1;var i=this.data,n=LimitActProxy.ins().getLimitGiftBuyNum(i.id);if(n>=i.limit_num)return 0==t&&TipsControl.ins().showTips("购买次数已达到上限"),!1;var o=LimitActProxy.ins().getJackpotScore(this.actConfig.act_type);return i.wealth>o?(0==t&&TipsControl.ins().showTips("活动未开启"),!1):!0},e.prototype.onClick=function(t){var e=this.data,i=this.Check(!1);i&&LimitActProxy.ins().C2SReqLimitActBuyGift(e.id,e.act_id)},e}(BaseItemRender);__reflect(LimitedGifsRankItem.prototype,"LimitedGifsRankItem"),window.LimitedGifsRankItem=LimitedGifsRankItem;var LimitedGifsRankTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LimitedGifsRankTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick);var i=GlobalConfig.getLimitedGifsViewTab(),n=t[0][0]||0,o=t[0][1]||0;for(var s in i)i[s].act_type==n&&i[s].sub_type==o&&(this.desc.textFlow=UtilProxy.generateTextFlow(i[s].desc))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(LimitedGifsRankTipsView.prototype,"LimitedGifsRankTipsView"),ViewManager.ins().reg(LimitedGifsRankTipsView,LayerManager.UI_Main2),window.LimitedGifsRankTipsView=LimitedGifsRankTipsView;var LimitedGifsRankView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setVisible(!1),this.explan_link.textFlow=TextFlowMaker.generateTextFlow2("C:7&U&玩法说明"),this.scroll.viewport=this.list,this.list.itemRenderer=LimitedGifsRankItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEndEvent(this.rankbtn,this.ShowRank),this.addTouchEndEvent(this.btn_Recharge,this.ShowVip),this.explan_link.addEventListener(egret.TextEvent.LINK,this.ShowTips,this),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowScore),EventProxy.AddListener(this,EventType.S2CRepLimitActGetJackpot,this.ShowScore),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo),LimitActProxy.ins().C2SReqLimitActLotteryInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rankbtn,this.ShowRank),this.removeTouchEvent(this.btn_Recharge,this.ShowVip),this.explan_link.removeEventListener(egret.TextEvent.LINK,this.ShowTips,this),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowScore),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetJackpot,this.ShowScore),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo),egret.Tween.removeTweens(this.rankbtn)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowScore=function(){var t=LimitActProxy.ins().getMyCrossScore(this.act_type),e=LimitActProxy.ins().getJackpotScore(this.act_type);this.rich_value_1.textFlow=UtilProxy.StrFormart("C:5&本区财富值：|C:7&@0 ",[e]),this.rich_value_2.textFlow=UtilProxy.StrFormart("C:5&我的财富值：|C:7&@0 ",[t]),this.value_text.textFlow=UtilProxy.StrFormart("|C:5&1 元 = 1 财富值|",[0])},e.prototype.ShowInfo=function(){void 0==this.configList&&(this.configList=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type));var t=this.configList[0];if(void 0!=t){if(void 0==this.giftlist){var e=LimitActProxy.ins().getGiftDataListById(t.id),i=function(t,e){var i=t.wealth,n=e.wealth;return i>n?1:n>i?-1:void 0};e.sort(i),this.giftlist=e}void 0==this.array&&(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll();for(var n in this.giftlist){var o={};o=this.giftlist[n],this.array.addItem(o)}this.endtime=LimitActProxy.ins().GetActEndTime(t),this.ShowColdTime()}},e.prototype.ShowTips=function(){ViewManager.ins().open(LimitedGifsRankTipsView,[this.act_type,this.sub_type])},e.prototype.ShowRank=function(){var t=this;egret.Tween.removeTweens(this.rankbtn);var e=egret.Tween.get(this.rankbtn);e.to({scaleX:.8,scaleY:.8},80).to({scaleX:1,scaleY:1},80,egret.Ease.sineOut).call(function(){ViewManager.ins().open(LimitedRichRankView,[t.act_type])},this)},e.prototype.ShowVip=function(){ViewManager.ins().open(RechargeView)},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.time_text.text=""},e.prototype.SetTimeLab=function(){this.time_text.textFlow=UtilProxy.StrFormart("|C:7&剩余时间: @0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(LimitedGifsRankView.prototype,"LimitedGifsRankView"),window.LimitedGifsRankView=LimitedGifsRankView;var LimitedGifsView=function(t){function e(){var e=t.call(this)||this;return e.defaultindex=-1,e.btn_index=-1,e.viewList={LimitedFlyGifsView:void 0,LimitedGifsRankView:void 0,LimitedRushView:void 0},e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LimitedGifsViewSkin",this.LimitedFlyGifsView.initUI(),this.LimitedGifsRankView.initUI(),this.LimitedRushView.initUI(),this.viewList.LimitedFlyGifsView=this.LimitedFlyGifsView,this.viewList.LimitedRushView=this.LimitedRushView,this.viewList.LimitedGifsRankView=this.LimitedGifsRankView,this.IntBtnList()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btn_list.length;i++)this.addTouchEvent(this.btn_list[i],this.onbtnClick);if(this.LimitedFlyGifsView.open(),this.LimitedGifsRankView.open(),this.LimitedRushView.open(),this.RefreshBtn(),void 0==LimitActProxy.ins().GetLimitedGifsTabCf())return void ViewManager.ins().close(this);var n=t[0]||this.defaultindex;this.SetBtnIndex(n),this.btn_index=n,EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActConsumeRank,this.RefreshBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActGetTimes,this.RefreshBtn),EventProxy.AddListener(this,EventType.UpdataMoney,this.RefreshBtn)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onbtnClick);this.LimitedFlyGifsView.close(),this.LimitedGifsRankView.close(),this.LimitedRushView.close(),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActConsumeRank,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetTimes,this.RefreshBtn),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.RefreshBtn)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.IntBtnList=function(){var t=GlobalConfig.getLimitedGifsViewTab();this.btn_list=[],this.btn_list_group.removeChildren();for(var e in t){var i=new eui.Button;i.skinName="ActivityBtn",t[e]&&this.viewList[t[e].page_view]&&(this.viewList[t[e].page_view].act_type=t[e].act_type,this.viewList[t[e].page_view].sub_type=t[e].sub_type,i.icon=t[e].btn_icon),this.btn_list.push(i),this.btn_list_group.addChild(i)}},e.prototype.RefreshBtn=function(){for(var t=GlobalConfig.getLimitedGifsViewTab(),e=0;e<this.btn_list.length;e++)if(this.btn_list[e].visible=!1,this.btn_list[e].includeInLayout=!1,t[e+1]&&this.viewList[t[e+1].page_view]){var i=0!=t[e+1].sub_type?t[e+1].sub_type:void 0,n=LimitActProxy.ins().GetActivityCfgs(t[e+1].act_type,i);if(this.btn_list[e].visible=n.length>0,this.btn_list[e].includeInLayout=n.length>0,n.length>0&&-1==this.defaultindex&&(this.defaultindex=e),n[0]&&""!=n[0].btn_title){var o=this.btn_list[e].getChildAt(3);o.visible=!0,o.source=n[0].btn_title}n.length>0&&(this.btn_list[e].getChildAt(4).visible=LimitActProxy.ins().GetRedByType(t[e+1].act_type,i))}},e.prototype.SetBtnIndex=function(t){if(0!=this.btn_list[t].visible){this.curbtn&&(this.curbtn.getChildAt(1).visible=!1),this.curbtn=this.btn_list[t],this.curbtn.getChildAt(1).visible=!0;var e=GlobalConfig.getLimitedGifstabConfig(t+1);e&&this.viewList[e.page_view]&&(this.viewList[e.page_view].act_type=e.act_type,this.viewList[e.page_view].sub_type=e.sub_type,this.curView&&this.curView.setVisible(!1),this.curView=this.viewList[e.page_view],this.curView.setVisible(!0))}},e.prototype.onbtnClick=function(t){var e=this.btn_list.indexOf(t.currentTarget);(-1==this.btn_index||this.btn_index!=e)&&(this.btn_index=e,this.SetBtnIndex(e))},e}(BaseEuiView);__reflect(LimitedGifsView.prototype,"LimitedGifsView"),ViewManager.ins().reg(LimitedGifsView,LayerManager.UI_Main2),window.LimitedGifsView=LimitedGifsView;var LimitedRichRankItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName="LimitedRichRankItemSkin"},e.prototype.dataChanged=function(){},e}(BaseItemRender);__reflect(LimitedRichRankItem.prototype,"LimitedRichRankItem"),window.LimitedRichRankItem=LimitedRichRankItem;var LimitedRichRankView=function(t){function e(){var e=t.call(this)||this;return e.rank_score=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LimitedRichRankSkin",this.title.textFlow=UtilProxy.generateTextFlow("C:10&财富榜")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEndEvent(this.closebtn,this.OnClick),EventProxy.AddListener(this,EventType.S2CRepLimitActConsumeRank,this.ShowInfo),this.act_type=t[0],LimitActProxy.ins().curShowRankType=2,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.OnClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActConsumeRank,this.ShowInfo)},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type);this.rank_score=t[0]?t[0].act_params[0]:0,GameLogic.ins().getServerTime()-LimitActProxy.ins().curGetRankTime>5&&LimitActProxy.ins().C2SReqLimitActConsumeRank(2);var e=LimitActProxy.ins().getMyCrossScore(this.act_type);this.my_score.textFlow=UtilProxy.generateTextFlow("|C:5&我的积分:| |C:7&"+e+"| "+(e<this.rank_score?"("+(this.rank_score-e)+"分可上榜)":"")),this.my_rank.textFlow=UtilProxy.generateTextFlow("|C:5&我的排名:| "+(0==LimitActProxy.ins().myRichRank?"未上榜":LimitActProxy.ins().myRichRank));var i=LimitActProxy.ins().RichRankList,n=0==LimitActProxy.ins().myRichRank?i[i.length]:1!=LimitActProxy.ins().myRichRank?function(){for(var t=0;t<i.length;t++)if(LimitActProxy.ins().myRichRank-1==i[t].index)return i[t]}():void 0;this.next_rank.textFlow=UtilProxy.generateTextFlow(void 0!=n?"|C:5&离第|"+n.index+"|C:5&名还差"+(n.score-e)+"积分|":"");var o=t[0];if(void 0!=o){var s=o.act_award;this.g_item.removeChildren();for(var r=0;r<s.length;r++)if(r<i.length){var a=new LotteryRankItem(s[i[r].index-1],i[r]);this.g_item.addChild(a)}else{var h=new LotteryRankItem(s[r]);this.g_item.addChild(h)}}},e.prototype.OnClick=function(t){switch(t.currentTarget){case this.closebtn:ViewManager.ins().close(this)}},e}(BaseEuiView);__reflect(LimitedRichRankView.prototype,"LimitedRichRankView"),ViewManager.ins().reg(LimitedRichRankView,LayerManager.UI_Main2),window.LimitedRichRankView=LimitedRichRankView;var LimitedRushView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e.nextTime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_get_reward,this.ButGifsOnclick),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetTimes,this.SetServerCount)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_get_reward,this.ButGifsOnclick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetTimes,this.SetServerCount)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.SetServerCount=function(){var t=this.configList[0].total_num-LimitActProxy.ins().GetActivityTimes(this.configList[0].id);t>0?this.limite_serve.textFlow=UtilProxy.StrFormart("全服限购，只剩 |C:7&@0 | 件",[t]):this.limite_serve.textFlow=UtilProxy.StrFormart("全服限购，只剩 |C:4&@0 | 件",[t])},e.prototype.ShowInfo=function(){this.configList=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type);var t=this.configList[0];if(void 0!=t){if(void 0==this.giftlist){var e=LimitActProxy.ins().getGiftDataListById(t.id);this.giftlist=e[0]}var i=MathUtils.toInteger(this.giftlist.consume[1]/this.giftlist.show_consume[1]*10);this.discount_text.textFlow=UtilProxy.StrFormart("@0 折",[10==i?0:i]),this.gif_text.textFlow=UtilProxy.StrFormart("|C:5&@0 |",[this.giftlist.gift_name]);var n,o=this.giftlist.reward_id;if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),a=0;a<r.length;a++){var h=UtilProxy.GetItemCellData(r[a][0].id,r[a][0].num);n=h}this.itemCell.data=n;LimitActProxy.ins().GetActivityData(t.id);LimitActProxy.ins().C2SReqLimitActGetTimes([t.id]),this.pricelab1.text=this.giftlist.show_consume[1],this.pricelab2.textFlow=UtilProxy.StrFormart("C:5&@0 ",[this.giftlist.consume[1]]),this.price2=this.giftlist.consume[1],this.pricepic1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(this.giftlist.consume[0]).displayid),this.pricepic2.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(this.giftlist.consume[0]).displayid);var l=LimitActProxy.ins().getLimitGiftBuyNum(this.giftlist.id);l>=this.giftlist.limit_num?this.limited_person.textFlow=UtilProxy.StrFormart("C:4&(可购买 @0 /@1 )",[this.giftlist.limit_num-l,this.giftlist.limit_num]):this.limited_person.textFlow=UtilProxy.StrFormart("(可购买 @0 /@1 )",[this.giftlist.limit_num-l,this.giftlist.limit_num]),this.endtime=LimitActProxy.ins().GetActEndTime(t),this.ShowColdTime();var p=this.getNextGifsTime(t.id);this.next_time_text.visible=0==p?!1:!0,this.next_time_text.textFlow=UtilProxy.StrFormart("下一轮上架: |C:7&@0 |",[p])}},e.prototype.getNextGifsTime=function(t){for(var e=GameLogic.ins().getServerTime(),i=(new Date(1e3*e),GlobalConfig.getRushGifs_dataConfig()),n=0;n<i.length;n++)if(i[n].id==t&&void 0!=i[n+1]){var o=i[n+1],s=3600*o.open_time[0][0]+60*o.open_time[0][1]+o.open_time[0][2];return UtilProxy.getTimeHMSString(s)}return 0},e.prototype.ButGifsOnclick=function(){var t=this.giftlist.id,e=this.giftlist.act_id,i=LimitActProxy.ins().getLimitGiftBuyNum(t),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO);if(this.price2>n)return void TipsControl.ins().showTips("购买元宝不足！");if(i>=this.giftlist.limit_num)return void TipsControl.ins().showTips("购买次数已达到上限");var o=this.configList[0].total_num-LimitActProxy.ins().GetActivityTimes(this.configList[0].id);return 0>=o?void TipsControl.ins().showTips("礼包已售完"):void LimitActProxy.ins().C2SReqLimitActBuyGift(t,e)},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.time_text.text=""},e.prototype.SetTimeLab=function(){this.time_text.textFlow=UtilProxy.StrFormart("下架倒计时：|C:7&@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.ShowNextTime=function(){this.SetNextTimeLab(),this.nextTime>0?(TimerManager.ins().remove(this.SetNextTimeLab,this),TimerManager.ins().doTimer(1e3,this.nextTime-1,this.SetNextTimeLab,this,this.ShowNextTime,this)):this.next_time_text.text=""},e.prototype.SetNextTimeLab=function(){this.nextTime=this.nextTime-1,this.next_time_text.textFlow=UtilProxy.StrFormart("下一轮上架: |C:7&@0 |",[UtilProxy.getTimeHMSString(this.nextTime)])},e}(BaseEuiView);__reflect(LimitedRushView.prototype,"LimitedRushView"),window.LimitedRushView=LimitedRushView;var LimitRechargeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LimitRechargeSkin",this.list.itemRenderer=ItemCell,this.lab1.textFlow=UtilProxy.generateTextFlow("C:7&仅当天充值有效")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.InitBtn(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.getbtn,this.ongetbtnClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.curindex=0,void 0==this.curbtn&&(this.curbtn=this.btns[this.curindex]),this.curbtn.icon="xianshichongzhi__btn_01",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.getbtn,this.ongetbtnClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.model.removeChildren()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){this.curindex=this.btns.indexOf(t.currentTarget),void 0!=this.curbtn&&(this.curbtn.icon="xianshichongzhi__btn_02"),this.curbtn=this.btns[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",this.ShowInfo()},e.prototype.ongetbtnClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(2,4),i=e[this.curindex];if(void 0!=i){var n=LimitActProxy.ins().GetActivityData(i.id);if(n&&n.is_completed)LimitActProxy.ins().C2SReqLimitActGetReward(i.id);else{var o=i.recharge_list[0],s=GlobalConfig.getRechargeBagConfig(o);if(s){var r={app_subject:s.name,order_amt:100*s.amount,data:s};SdkManager.isUseSdk?SdkManager.ins().commitPay(r):TipsControl.ins().showTips("没有SDK")}}}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(2,4);t.sort(this.sortCfs);for(var e=0;e<this.btns.length;e++)if(this.btns[e].getChildAt(2).visible=!1,t[e]){var i=LimitActProxy.ins().GetActivityData(t[e].id);this.btns[e].getChildAt(2).visible=i&&!i.is_get&&i.is_completed}var n=t[this.curindex];if(void 0!=n){this.zhanpic.visible=n.icon[1]>0,this.zhanValue.visible=n.icon[1]>0,this.zhanValue.text=n.icon[1].toString(),this.level.text=n.icon[2].toString(),this.money.text=n.icon[3].toString(),this.tippics.visible=n.icon[2]>0,this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var o=n.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),e=0;e<r.length;e++){var a=UtilProxy.GetItemCellData(r[e][0].id,r[e][0].num);this.arraylist.addItem(a)}var h=LimitActProxy.ins().GetActivityData(n.id),l=h&&h.params[0]?h.params[0]:0;if(this.getbtn.visible=void 0==h||0==h.is_get,this.getbtn.visible&&(this.getbtn.label=h&&h.is_completed?"领取奖励":"前往充值"),this.hasget.visible=h&&h.is_get,this.lab0.textFlow=h&&h.is_completed?UtilProxy.generateTextFlow("C:7&已达成"):UtilProxy.StrFormart("已充值额度@0 元",[l>0?l/LimitActProxy.ins().rechargeNun:0]),this.model.removeChildren(),this.model.x=n.charRes_wuqi[2],this.model.y=n.charRes_wuqi[3],this.modelpic.visible=1==n.charRes_wuqi[0],2==n.charRes_wuqi[0]){var p=new egret.MovieClip;UtilProxy.GetMovieClip(n.charRes_wuqi[1],p,-1,void 0),this.model.addChild(p)}else 3==n.charRes_wuqi[0]?UtilProxy.GetMovieClipById(Number(n.charRes_wuqi[1]),this.model):1==n.charRes_wuqi[0]&&(this.modelpic.source=n.charRes_wuqi[1])}},e.prototype.sortCfs=function(t,e){return t.act_params[0]<e.act_params[0]?-1:t.act_params[0]>e.act_params[0]?1:0},e.prototype.InitBtn=function(){var t=LimitActProxy.ins().GetActivityCfgs(2,4);t.sort(this.sortCfs),this.btns=[],this.btn_g.removeChildren();for(var e=0;e<t.length;e++){var i=new eui.Button;i.skinName=Btn14Skin,i.width=98,i.height=35,i.icon="xianshichongzhi__btn_02",i.label=UtilProxy.getStr("@0  元",[t[e].act_params[0]/LimitActProxy.ins().rechargeNun]),this.btns.push(i),this.btn_g.addChild(i)}},e}(BaseEuiView);__reflect(LimitRechargeView.prototype,"LimitRechargeView"),ViewManager.ins().reg(LimitRechargeView,LayerManager.UI_Main2),window.LimitRechargeView=LimitRechargeView;var RechargeActItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="JcAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.lab1.textFlow=UtilProxy.StrFormart("指定单笔充值 |C:7&@0 | 元,可领取：",[t.act_params[0]/LimitActProxy.ins().rechargeNun]);var e=LimitActProxy.ins().GetActivityData(t.id),i=e.params[0]||0,n=e.params[1]||0,o=t.act_params[1]-n;this.btn.visible=o>0,this.btn.label=i-n>0?"领取奖励":"￥"+t.act_params[0]/LimitActProxy.ins().rechargeNun,this.hasget.visible=0==o,this.btn.getChildAt(2).visible=i-n>0,this.lab2.text=UtilProxy.getStr("剩余次数：@0 ",[o]),this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var s=t.act_award[0];if(s>0)for(var r=GlobalConfig.getDropConfig(s),a=GlobalConfig.getDropItem(r.drop),h=0;h<a.length;h++){var l=UtilProxy.GetItemCellData(a[h][0].id,a[h][0].num);this.arry.addItem(l)}},e.prototype.onClick=function(t){var e=this.data,i=LimitActProxy.ins().GetActivityData(e.id);if(i){var n=i.params[0]||0,o=i.params[1]||0;if(n-o>0)LimitActProxy.ins().C2SReqLimitActGetReward(e.id);else{var s=e.recharge_list[0];if(s&&s>0){var r=GlobalConfig.getRechargeBagConfig(s);if(r){var a={app_subject:r.name,order_amt:100*r.amount,data:r};SdkManager.isUseSdk?SdkManager.ins().commitPay(a):TipsControl.ins().showTips("没有SDK")}}}}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(RechargeActItem.prototype,"RechargeActItem"),window.RechargeActItem=RechargeActItem;var RechargeActView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e
}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=RechargeActItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&(LimitActProxy.ins().IsShow34ActRed&&(LimitActProxy.ins().IsShow34ActRed=!1,EventProxy.Broast(EventType.S2CRepLimitActUpdate,{})),this.ShowInfo())},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll();for(var i in t)this.array.addItem(t[i])}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(RechargeActView.prototype,"RechargeActView"),window.RechargeActView=RechargeActView;var RechargeTrunView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.title.textFlow=UtilProxy.generateTextFlow("C:10&财富值"),this.mylab.textFlow=UtilProxy.generateTextFlow("C:7&U&抽奖记录"),this.infos=[this.info1,this.info2,this.info3,this.info4],this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.TakeCallBack),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.SetBoxCountInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.ShowInfo),this.addTouchEvent(this.btn_one,this.onClick),this.addTouchEvent(this.btn_ten,this.onClick),this.addTouchEvent(this.mylab,this.onClick),this.addTouchEvent(this.giftbtn,this.onClick),this.addTouchEvent(this.btn_wen,this.onClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.TakeCallBack),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.SetBoxCountInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.ShowInfo),this.removeTouchEvent(this.btn_one,this.onClick),this.removeTouchEvent(this.btn_ten,this.onClick),this.removeTouchEvent(this.mylab,this.onClick),this.removeTouchEvent(this.giftbtn,this.onClick),this.removeTouchEvent(this.btn_wen,this.onClick),this.ResetTween(),LimitActProxy.ins().CurSelectType=0},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.onClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),i=e[0];if(void 0!=i)switch(t.currentTarget){case this.btn_one:this.OnTakeBtn(1);break;case this.btn_ten:this.OnTakeBtn(10);break;case this.giftbtn:var n=GlobalConfig.getLottery_base_dataConfig(1),o=0,s=0,r=void 0,a=LimitActProxy.ins().GetTrunActBoxAward(30==this.act_type?1:2,i.id);if(30==this.act_type?(o=a?a.treasure_need:n.recharge_treasure_need,s=LimitActProxy.ins().recharge_treasure,r=n.recharge_box):33==this.act_type&&(o=a?a.treasure_need:n.consume_treasure_need,s=LimitActProxy.ins().consume_treasure,r=n.consume_box),o>s){var h=new ItemCellData,l=void 0;return l=a?{item_slot_idx:0,item_type_id:a.box_award[0],item_count:a.box_award[1]}:{item_slot_idx:0,item_type_id:r[0],item_count:r[1]},h.setItemCellData(l),void ViewManager.ins().open(ItemTipsView,h)}LimitActProxy.ins().C2SReqLimitActLotteryOpenBox(30==this.act_type?1:2,1);break;case this.mylab:ViewManager.ins().open(TrunStoryTips,30==this.act_type?1:2,i.id);break;case this.btn_wen:ViewManager.ins().open(TrunTipsView,30==this.act_type?1:2,i.id)}},e.prototype.OnTakeBtn=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),i=e[0];if(void 0!=i){var n=GlobalConfig.getLottery_base_dataConfig(1),o=LimitActProxy.ins().GetTrunActBoxAward(30==this.act_type?1:2,i.id),s=0;return 30==this.act_type?s=o?Math.floor(LimitActProxy.ins().recharge_num/o.take_need):Math.floor(LimitActProxy.ins().recharge_num/n.recharge_need):33==this.act_type&&(s=o?Math.floor(LimitActProxy.ins().consume_num/o.take_need):Math.floor(LimitActProxy.ins().consume_num/n.consume_need)),t>s?void TipsControl.ins().showTips("抽奖次数不足"):void LimitActProxy.ins().C2SReqLimitActLotteryTake(30==this.act_type?1:2,t,i.id)}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.SetBoxCountInfo(),this.ShowStoryView(30==this.act_type?1:2,e.id);for(var i=LimitActProxy.ins().GetTrunActItemList(30==this.act_type?1:2,e.id),n=1;n<=this.items.numChildren;n++)i[n]&&this.SetItemInfo(i[n],this.items.getChildAt(n-1))}},e.prototype.SetItemInfo=function(t,e){if(void 0!=t){var i=e.getChildAt(0),n=UtilProxy.GetItemCellData(t.item_id,t.item_num);i.data=n,e.getChildAt(1).visible=t.is_precious>0;var o=e.getChildAt(2);o.visible=t.is_precious>0,t.is_precious>0&&(o.source="jingcaihuodong_bg_jiaobiao0"+t.is_precious)}},e.prototype.ShowStoryView=function(t,e){var i=[],n="";30==this.act_type?(i=LimitActProxy.ins().recharge_list,n="充值转盘"):33==this.act_type&&(i=LimitActProxy.ins().consume_list,n="消费转盘");for(var o=0;o<this.infos.length;o++)if(i[o]){var s=LimitActProxy.ins().GetTrunActItem(t,e,i[o].id);this.infos[o].textFlow=UtilProxy.StrFormart("|C:6&S@0 .@1 |在@2 中获得大奖|C:10&@3 *@4 |",[RoleProxy.ins().getRoleServerId(),i[o].name,n,BagProxy.ins().getItemName(s.item_id),s.item_num])}else this.infos[o].text=""},e.prototype.SetBoxCountInfo=function(){var t=GlobalConfig.getLottery_base_dataConfig(1),e=0,i=0,n=0,o=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),s=o[0];if(void 0!=s){var r=LimitActProxy.ins().GetTrunActBoxAward(30==this.act_type?1:2,s.id);30==this.act_type?(n=LimitActProxy.ins().recharge_treasure,r?(i=r.treasure_need,e=Math.floor(LimitActProxy.ins().recharge_num/r.take_need),this.tipslab.textFlow=UtilProxy.StrFormart("C:7&每充值 @0 元可免费抽奖一次",[r.take_need/LimitActProxy.ins().rechargeNun])):(i=t.recharge_treasure_need,e=Math.floor(LimitActProxy.ins().recharge_num/t.recharge_need),this.tipslab.textFlow=UtilProxy.StrFormart("C:7&每充值 @0 元可免费抽奖一次",[t.recharge_need/LimitActProxy.ins().rechargeNun]))):33==this.act_type&&(n=LimitActProxy.ins().consume_treasure,r?(i=r.treasure_need,e=Math.floor(LimitActProxy.ins().consume_num/r.take_need),this.tipslab.textFlow=UtilProxy.StrFormart("C:7&每消耗 @0 元可免费抽奖一次",[r.take_need/LimitActProxy.ins().rechargeNun])):(i=t.consume_treasure_need,e=Math.floor(LimitActProxy.ins().consume_num/t.consume_need),this.tipslab.textFlow=UtilProxy.StrFormart("C:7&每消耗 @0 元宝可免费抽奖一次",[t.consume_need]))),this.leftLab.textFlow=UtilProxy.StrFormart("剩余抽奖次数 |C:7&@0 |",[e]),this.bar.maximum=i,this.bar.value=n,this.giftbtn.getChildAt(3).visible=n>=i}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.TakeCallBack=function(){this.SetBoxCountInfo(),this.StarRotation()},e.prototype.StarRotation=function(){this.ResetTween();var t=1;for(var e in LimitActProxy.ins().trun_ids)t=Math.max(t,LimitActProxy.ins().trun_ids[e]);var i=720+36*(t-1);egret.Tween.get(this.center).to({rotation:i},2e3,egret.Ease.sineOut),egret.Tween.get(this.center0).to({rotation:i},2e3,egret.Ease.sineOut).call(this.ShowItemList,this)},e.prototype.ShowItemList=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){for(var i=[],n=0;n<LimitActProxy.ins().trun_ids.length;++n){var o=LimitActProxy.ins().GetTrunActItem(30==this.act_type?1:2,e.id,LimitActProxy.ins().trun_ids[n]),s=new ItemExData;s.itemData=UtilProxy.GetItemCellData(o.item_id,o.item_num),i.push(s)}ViewManager.ins().open(TreasureView_reward,[!1,i]),LimitActProxy.ins().CurSelectType=0}},e.prototype.ResetTween=function(){egret.Tween.removeTweens(this.center),this.center.rotation=0,egret.Tween.removeTweens(this.center0),this.center0.rotation=0},e}(BaseEuiView);__reflect(RechargeTrunView.prototype,"RechargeTrunView"),window.RechargeTrunView=RechargeTrunView;var TrunActView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e.itemid=0,e}return __extends(e,t),e.prototype.initUI=function(){this.infos=[this.info1,this.info2,this.info3,this.info4],this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.TakeCallBack),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.SetBoxCountInfo),this.addTouchEvent(this.btn_one,this.onClick),this.addTouchEvent(this.btn_ten,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.addTouchEvent(this.tipslab,this.onClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.TakeCallBack),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.SetBoxCountInfo),this.removeTouchEvent(this.btn_one,this.onClick),this.removeTouchEvent(this.btn_ten,this.onClick),this.removeTouchEvent(this.btn,this.onClick),this.removeTouchEvent(this.tipslab,this.onClick),this.ResetTween(),LimitActProxy.ins().CurSelectType=0},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_one:this.OnTakeBtn(1);break;case this.btn_ten:this.OnTakeBtn(10);break;case this.btn:var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),i=e[0];if(void 0==i)return;ViewManager.ins().open(TrunStoryTips,3,i.id);break;case this.tipslab:TipsControl.ins().ShowPathTips(this.itemid)}},e.prototype.OnTakeBtn=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),i=e[0];if(void 0!=i){var n=GlobalConfig.getLottery_base_dataConfig(1).item_need,o=BagProxy.ins().getItemCountById(n[0]);return n[1]*t>o?void TipsControl.ins().showTips(BagProxy.ins().getItemName(n[0])+"不足"):void LimitActProxy.ins().C2SReqLimitActLotteryTake(3,t,i.id)}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.SetBoxCountInfo(),this.ShowStoryView(3,e.id);for(var i=LimitActProxy.ins().GetTrunActItemList(3,e.id),n=1;n<=this.items.numChildren;n++)i[n]&&this.SetItemInfo(i[n],this.items.getChildAt(n-1))}},e.prototype.SetItemInfo=function(t,e){if(void 0!=t){var i=e.getChildAt(0),n=UtilProxy.GetItemCellData(t.item_id,t.item_num);i.data=n,e.getChildAt(1).visible=t.is_precious>0;var o=e.getChildAt(2);o.visible=t.is_precious>0,t.is_precious>0&&(o.source="jingcaihuodong_bg_jiaobiao0"+t.is_precious)}},e.prototype.ShowStoryView=function(t,e){var i=[],n="道具转盘";i=LimitActProxy.ins().consume_list;for(var o=0;o<this.infos.length;o++)if(i[o]){var s=LimitActProxy.ins().GetTrunActItem(t,e,i[o].id);this.infos[o].textFlow=UtilProxy.StrFormart("|C:6&S@0 .@1 |在@2 中获得大奖|C:10&@3 *@4 |",[RoleProxy.ins().getRoleServerId(),i[o].name,n,BagProxy.ins().getItemName(s.item_id),s.item_num])}else this.infos[o].text=""},e.prototype.SetBoxCountInfo=function(){var t=GlobalConfig.getLottery_base_dataConfig(1).item_need;this.itemid=t[0];var e=BagProxy.ins().getItemData(t[0]);this.icon1.source=AssetMgr.getIconResource(e.displayid),this.icon2.source=AssetMgr.getIconResource(e.displayid);var i=BagProxy.ins().getItemCountById(t[0]);this.countlab1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |/@2 ",[i>=t[1]?7:4,i,t[1]]),this.countlab2.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |/@2 ",[i>=10*t[1]?7:4,i,10*t[1]]),this.tipslab.textFlow=UtilProxy.StrFormart("|C:7&U&获取@0 |",[e.name])},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.TakeCallBack=function(){this.SetBoxCountInfo(),this.StarRotation()},e.prototype.StarRotation=function(){this.ResetTween();var t=1;for(var e in LimitActProxy.ins().trun_ids)t=Math.max(t,LimitActProxy.ins().trun_ids[e]);var i=720+36*(t-1);egret.Tween.get(this.center).to({rotation:i},2e3,egret.Ease.sineOut),egret.Tween.get(this.center0).to({rotation:i},2e3,egret.Ease.sineOut).call(this.ShowItemList,this)},e.prototype.ShowItemList=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){for(var i=[],n=0;n<LimitActProxy.ins().trun_ids.length;++n){var o=LimitActProxy.ins().GetTrunActItem(3,e.id,LimitActProxy.ins().trun_ids[n]),s=new ItemExData;s.itemData=UtilProxy.GetItemCellData(o.item_id,o.item_num),i.push(s)}ViewManager.ins().open(TreasureView_reward,[!1,i]),LimitActProxy.ins().CurSelectType=0}},e.prototype.ResetTween=function(){egret.Tween.removeTweens(this.center),this.center.rotation=0,egret.Tween.removeTweens(this.center0),this.center0.rotation=0},e}(BaseEuiView);__reflect(TrunActView.prototype,"TrunActView"),window.TrunActView=TrunActView;var TrunPushView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TrunPushSkin",this.effect.removeChildren(),UtilProxy.GetMovieClipById(101,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.bg,this.onCloseClick),this.addTouchEvent(this.btn,this.onbtnClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.bg,this.onCloseClick),this.removeTouchEvent(this.btn,this.onbtnClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){ViewManager.ins().open(JcActivityView,5),ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(30),e=t[0];if(void 0!=e)if(e.icon[2]&&(this.zhanValue.text=e.icon[2].toString()),this.title1.source=e.icon[0],this.title2.source=e.icon[1],this.model.removeChildren(),this.model.x=e.charRes_wuqi[2],this.model.y=e.charRes_wuqi[3],this.icon.visible=1==e.charRes_wuqi[0],this.effect.visible=1==e.charRes_wuqi[0],2==e.charRes_wuqi[0]){var i=new egret.MovieClip;UtilProxy.GetMovieClip(e.charRes_wuqi[1],i,-1,void 0),this.model.addChild(i)}else 3==e.charRes_wuqi[0]?UtilProxy.GetMovieClipById(Number(e.charRes_wuqi[1]),this.model):1==e.charRes_wuqi[0]&&(this.icon.x=e.charRes_wuqi[2],this.icon.y=e.charRes_wuqi[3],this.icon.source=e.charRes_wuqi[1])},e}(BaseEuiView);__reflect(TrunPushView.prototype,"TrunPushView"),ViewManager.ins().reg(TrunPushView,LayerManager.UI_Main2),window.TrunPushView=TrunPushView;var TrunStoryTips=function(t){function e(){var e=t.call(this)||this;return e.curtype=0,e.curactid=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TrunStoryTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),LimitActProxy.ins().C2SReqLimitActLotteryInfo(),this.curtype=t[0]||0,this.curactid=t[1]||0,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){for(var t=LimitActProxy.ins().my_records[this.curtype]||[],e="",i=0;i<t.length;i++){var n=LimitActProxy.ins().GetTrunActItem(this.curtype,this.curactid,t[i]);e+=UtilProxy.getStr("|C:6&S@0 .@1 |获得：|C:10&@2 *@3 |\n",[RoleProxy.ins().getRoleServerId(),RoleProxy.ins().getRoleName(),BagProxy.ins().getItemName(n.item_id),n.item_num])}this.infolab.textFlow=UtilProxy.generateTextFlow(e)},e}(BaseEuiView);__reflect(TrunStoryTips.prototype,"TrunStoryTips"),ViewManager.ins().reg(TrunStoryTips,LayerManager.UI_Main2),window.TrunStoryTips=TrunStoryTips;var TrunTipsView=function(t){function e(){var e=t.call(this)||this;return e.curtype=0,e.curactid=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TrunTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.curtype=t[0]||0,this.curactid=t[1]||0,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetTrunActBoxAward(this.curtype,this.curactid);this.desc.textFlow=UtilProxy.generateTextFlow(t.dec_probability)},e}(BaseEuiView);__reflect(TrunTipsView.prototype,"TrunTipsView"),ViewManager.ins().reg(TrunTipsView,LayerManager.UI_Main2),window.TrunTipsView=TrunTipsView;var BagItem=function(t){function e(){var e=t.call(this)||this;return e.IsOnBag=!1,e.init(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="BagItemSkin"},e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowName(!0),this.ShowRed(!1)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.IsOnBag){var e=this.data;e&&e.item_type_id>0?this.ShowRed(!0):this.clear()}},e.prototype.clear=function(){t.prototype.clear.call(this),this.ShowRed(!1)},e}(ItemCell);__reflect(BagItem.prototype,"BagItem"),window.BagItem=BagItem;var BagItemEx=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="BagItemSkin"},e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowName(!0),this.ShowRed(!1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;e&&e.item_type_id>0?this.ShowRed(BagProxy.ins().IsHasRedByItemId(e.item_type_id)):this.clear()},e.prototype.clear=function(){t.prototype.clear.call(this),this.ShowRed(!1)},e}(ItemCell);__reflect(BagItemEx.prototype,"BagItemEx"),window.BagItemEx=BagItemEx;var BagView=function(t){function e(){var e=t.call(this)||this;return e.curType=1,e.typetList=[BagType.BAG,BagType.EQUIP,BagType.MIJI_BAG,BagType.GEM_BAG],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BagSkin",this.comview.initUI(),this.comview.SetName("title_beibao"),this.itemList.itemRenderer=BagItemEx,this.itemListGoods.itemRenderer=BagItemEx,this.itemScroller.viewport=this.itemList,this.itemGoodsScroller.viewport=this.itemListGoods,this.btns=[this.Btn_1,this.Btn_2,this.Btn_3,this.Btn_4,this.Btn_5];for(var e=0;e<this.btns.length;e++)this.btns[e].icon="commonAtlas_json.common_btn_smell_yellow_off"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.itemListGoods.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.setBagData),EventProxy.AddListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.addBtn,this.OnAddBtn),this.addTouchEvent(this.smeltBtn,this.OnSmeltBtn);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onBtnClick);for(var i=0;i<this.typetList.length;i++)this.btns[i].getChildAt(2).visible=BagProxy.ins().GetRedByType(this.typetList[i]);void 0!=t&&void 0!=t[0]?this.ShowBagInfo(this.btns[t[0]]):this.ShowBagInfo(this.btns[0]),this.setRed()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.itemList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.itemListGoods.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.addBtn,this.OnAddBtn),this.removeTouchEvent(this.smeltBtn,this.OnSmeltBtn);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onBtnClick);EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.setBagData),EventProxy.RemoveListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onBtnClick=function(t){this.ShowBagInfo(t.currentTarget)},e.prototype.ShowBagInfo=function(t){switch(this.curbtn&&(this.curbtn.icon="commonAtlas_json.common_btn_smell_yellow_off"),t.icon="commonAtlas_json.common_btn_smell_yellow_on",this.curbtn=t,t){case this.Btn_1:this.curType=BagType.BAG,this.viewStack.selectedIndex=1,this.setBagData();break;case this.Btn_2:this.curType=BagType.EQUIP,this.viewStack.selectedIndex=0,this.setBagData();break;case this.Btn_3:this.curType=BagType.MIJI_BAG,this.viewStack.selectedIndex=1,this.setBagData();break;case this.Btn_4:this.curType=BagType.GEM_BAG,this.viewStack.selectedIndex=1,this.setBagData();break;case this.Btn_5:ViewManager.ins().open(MakeView)}},e.prototype.OnAddBtn=function(t){ViewManager.ins().close(this),ViewManager.ins().open(VIPView)},e.prototype.OnSmeltBtn=function(t){ViewManager.ins().close(this),ViewManager.ins().open(SmeltView)},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&(void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),ViewManager.ins().open(ItemTipsView,e,!0),this.curSelectItem=t.itemRenderer,this.curSelectItem.ShowOnSelect(!0))},e.prototype.setBagData=function(){var t=BagProxy.ins().getBagInfo(this.curType);if(this.curbtn&&(this.curbtn.getChildAt(2).visible=BagProxy.ins().GetRedByType(this.curType)),this.curType==BagType.EQUIP){this.arraylist1||(this.arraylist1=new eui.ArrayCollection,this.itemList.dataProvider=this.arraylist1),this.arraylist1.removeAll();for(var e in t)this.arraylist1.addItem(t[e]);this.SetCount()}else{this.arraylist2||(this.arraylist2=new eui.ArrayCollection,this.itemListGoods.dataProvider=this.arraylist2),this.arraylist2.removeAll();for(var e in t)this.arraylist2.addItem(t[e])}},e.prototype.RefreshMakeRed=function(t){this.setRed()},e.prototype.setRed=function(){this.Btn_5.setRed(MakeProxy.ins().getRed())},e.prototype.SetCount=function(){this.itemCount.text=BagProxy.ins().getBagInfoLenth(this.curType)+"/"+BagProxy.ins().bagcount[this.curType]},e}(BaseEuiView);__reflect(BagView.prototype,"BagView"),ViewManager.ins().reg(BagView,LayerManager.UI_Main),window.BagView=BagView;var EquipItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowRed(!1)},e.prototype.setSkinName=function(){this.skinName="BagItemSkin"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(e&&e.itemConfig){var i=e.itemConfig;i&&this.setLevelLab(i.requiredlevel,i.reborn)}else this.clear()},e.prototype.clear=function(){t.prototype.clear.call(this),this.nameLab.visible=!1},e.prototype.setLevelLab=function(t,e){0!=t||0!=e?(this.nameLab.visible=!0,this.nameLab.text=GlobalFunc.getZhuanLevelLstr(t,e)):this.nameLab.visible=!1},e}(ItemCell);__reflect(EquipItem.prototype,"EquipItem"),window.EquipItem=EquipItem;var FrameTick=function(){function t(){this.list=[]}return t.prototype.tick=function(t){this.list[t]=TimerManager.ins().getFrameId()},t.prototype.isTick=function(t){return this.list[t]==TimerManager.ins().getFrameId()},t.prototype.checkAndTick=function(t){return this.isTick(t)?!0:(this.tick(t),!1)},t}();__reflect(FrameTick.prototype,"FrameTick");var ItemCellData=function(){function t(){this.item_slot_idx=0,this.item_type_id=0,this.item_count=0,this.expire_time=0,this.isNumShow=!1,this.canbeUsed=!1,this.IsInGem=!1,this.isTips=!0,this.item_sub_type=0}return t.prototype.setItemCellData=function(t){this.item_slot_idx=t.item_slot_idx,this.item_type_id=t.item_type_id,this.item_count=t.item_count,void 0!=t.expire_time&&(this.expire_time=t.expire_time),void 0!=GlobalConfig.getItemsConfig(this.item_type_id)?this.itemConfig=GlobalConfig.getItemsConfig(this.item_type_id):void 0!=GlobalConfig.getEquipmentConfig(this.item_type_id)?this.itemConfig=GlobalConfig.getEquipmentConfig(this.item_type_id):void 0!=GlobalConfig.getGiftConfig(this.item_type_id)&&(this.itemConfig=GlobalConfig.getGiftConfig(this.item_type_id)),void 0!=t.is_tips&&(this.isTips=t.is_tips),void 0!=t.isNumShow&&(this.isNumShow=t.isNumShow)},t}();__reflect(ItemCellData.prototype,"ItemCellData"),window.ItemCellData=ItemCellData;var ItemCellEx=function(t){function e(){var e=t.call(this)||this;return e.skinName="ItemCellExSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){var e=this.data[0],i=this.data[1];this.itemTip.visible=i,this.cell.data=e}},e}(BaseItemRender);__reflect(ItemCellEx.prototype,"ItemCellEx"),window.ItemCellEx=ItemCellEx;var ItemSelectAwardTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="ItemSelectAwardTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=ItemSelectItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.OnCloseClick),this.addTouchEvent(this.use,this.OnUseClick),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.itemdata=t[0],this.curSelectItem=void 0,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.OnCloseClick),this.removeTouchEvent(this.use,this.OnUseClick),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.OnUseClick=function(t){if(void 0==this.curSelectItem)return void TipsControl.ins().showTips("请选择装备");var e=[],i=[];i[0]=this.itemdata.item_slot_idx,i[1]=this.curSelectItem.data.id,e[0]=i,BagProxy.ins().C2SReqKnapsackUse(e),ViewManager.ins().close(this)},e.prototype.onListItemTap=function(t){void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),this.curSelectItem=t.itemRenderer,this.curSelectItem.ShowOnSelect(!0)},e.prototype.ShowInfo=function(){var t=this.itemdata.itemConfig;if(void 0!=t){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var e=t.extra_params;this.arraylist.removeAll();for(var i=0;i<e.length;i++){var n={id:i+1,drop_id:e[i]};this.arraylist.addItem(n)}}},e}(BaseEuiView);__reflect(ItemSelectAwardTips.prototype,"ItemSelectAwardTips"),ViewManager.ins().reg(ItemSelectAwardTips,LayerManager.UI_Popup),window.ItemSelectAwardTips=ItemSelectAwardTips;var ItemSelectItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="SelectItemSkin"},e.prototype.dataChanged=function(){var t=this.data.drop_id;if(t>0){var e=GlobalConfig.getDropConfig(t),i=GlobalConfig.getDropItem(e.drop),n=UtilProxy.GetItemCellData(i[0][0].id,i[0][0].num);this.item.data=n,this.item.SetShowTips(!1);var o=n.itemConfig;this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[o.quality-1],o.name])}},e.prototype.ShowOnSelect=function(t){this.item.ShowOnSelect(t)},e}(BaseItemRender);__reflect(ItemSelectItem.prototype,"ItemSelectItem"),window.ItemSelectItem=ItemSelectItem;var LvUpItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="BagItemSkin"},e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowName(!0),this.ShowRed(!1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.lefttime=this.data.expire_time-GameLogic.ins().getServerTime(),this.SetTimeLab(),this.lefttime>0&&(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this))},e.prototype.SetTimeLab=function(){this.lefttime>0?(this.nameLab.textFlow=UtilProxy.StrFormart("|C:4&@0 后失效|",[UtilProxy.getTimeHMSString(this.lefttime)]),this.lefttime=this.lefttime-1):(this.nameLab.textFlow=UtilProxy.generateTextFlow("|C:4&已过期|"),TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.clear=function(){t.prototype.clear.call(this),this.ShowRed(!1),TimerManager.ins().remove(this.SetTimeLab,this)},e}(ItemCell);__reflect(LvUpItem.prototype,"LvUpItem"),window.LvUpItem=LvUpItem;var BaokuItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onBtnClick)},e.prototype.setSkinName=function(){this.skinName="BaokuItemSkin"},e.prototype.dataChanged=function(){var t=GlobalConfig.getBaoku_cell_dataConfig(this.data[1]);this.namelab.textFlow=UtilProxy.generateTextFlow(BagProxy.ins().getItemColorName(t.item_id));var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.item_id,item_count:t.item_count};e.setItemCellData(i),this.item.data=e,this.g1.visible=t.show_price.length>0,this.g2.y=t.show_price.length>0?129:119,t.show_price.length>0&&(this.pricelab1.text=UtilProxy.getStr("原价：@0 ",[t.show_price[1]]),this.pricepic1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t.show_price[0]).displayid)),this.pricelab2.text=UtilProxy.getStr("现价：@0 ",[t.need_items[1]]),this.pricepic2.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t.need_items[0]).displayid),this.countlab.visible=t.max_buy>0,this.zhepic.visible=""!=t.mark,this.zhepic.source=t.mark;
var n=StoreProxy.ins().getBaokuUseTimes(this.data[0],this.data[1]);this.endpic.visible=t.max_buy>0&&n>=t.max_buy,this.countlab.textFlow=UtilProxy.StrFormart("限购：|C:@0 &@1 /@2 |",[this.endpic.visible?4:7,t.max_buy-n,t.max_buy])},e.prototype.onBtnClick=function(t){var e=this,i=GlobalConfig.getBaoku_cell_dataConfig(this.data[1]),n=StoreProxy.ins().getBaokuUseTimes(this.data[0],this.data[1]);if(i.max_buy>0&&n>=i.max_buy)return void TipsControl.ins().showTips("购买次数已满");var o=BagProxy.ins().getItemCountById(i.need_items[0]);if(o<i.need_items[1])return void TipsControl.ins().showTips(BagProxy.ins().getItemName(i.need_items[0])+"不足");var s=UtilProxy.getStr("是否花费|C:7&@0 @1 |兑换该物品?",[i.need_items[1],BagProxy.ins().getItemName(i.need_items[0])]);TipsControl.ins().ShowTips1(s,function(){},function(){StoreProxy.ins().C2SReqStoreBaokuExchange(e.data[0],e.data[1])}),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(BaokuItem.prototype,"BaokuItem"),window.BaokuItem=BaokuItem;var BaoKuView=function(t){function e(){var e=t.call(this)||this;return e.namestr=["title_zhutianmiku","title_jingjimiku","title_fentianmiku","title_shenmomiku"],e.lefttime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BaoKuSkin",this.comview.initUI(),this.sv.viewport=this.list,this.list.itemRenderer=BaokuItem,this.btns=[this.btn1,this.btn2,this.btn3,this.btn4]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onBtnClick);EventProxy.AddListener(this,EventType.S2CRepStoreGetBaokuInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepStoreBaokuExchange,this.ShowInfo),this.curType=t[0]?t[0]+1:1,this.curbtn=this.btns[this.curType-1],this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onBtnClick);EventProxy.RemoveListener(this,EventType.S2CRepStoreGetBaokuInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepStoreBaokuExchange,this.ShowInfo),this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=t.currentTarget,this.curbtn.icon="common_btn_big_yellow",this.curType=this.btns.indexOf(t.currentTarget)+1,this.ShowInfo()},e.prototype.ShowInfo=function(){this.bg.source="resource/skins/Baoku/baoku_banner_0"+this.curType+".jpg";for(var t=0;t<this.btns.length;t++)this.btns[t].getChildAt(2).visible=StoreProxy.ins().getBaokuTypeRed(t+1);this.comview.SetName(this.namestr[this.curType-1]);var e=GlobalConfig.getBaoku_dataConfig(this.curType),i=[];if(this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),e){if(e&&e.open_srv_day>0&&LimitActProxy.ins().GetServerOpenDay()<=e.open_srv_day)for(var t=0;t<e.srv_list.length;t++){var n=[];n[0]=this.curType,n[1]=e.srv_list[t],i.push(n)}else for(var t=0;t<e.cell_list.length;t++){var n=[];n[0]=this.curType,n[1]=e.cell_list[t],i.push(n)}this.arraylist.removeAll();for(var o in i)this.arraylist.addItem(i[o]);e.price_id.length>1?(this.timelab.visible=!1,this.g_1.visible=!0,this.g_2.visible=e.price_id[2],this.ShowPriceInfo(e.price_id[0],this.icon,this.countlab),this.ShowPriceInfo(e.price_id[1],this.icon0,this.countlab0),e.price_id[2]&&this.ShowPriceInfo(e.price_id[2],this.icon1,this.countlab1)):(this.timelab.visible=!0,this.g_1.visible=!1,this.g_2.visible=!1,this.ShowPriceInfo(e.price_id[0],this.icon,this.countlab),this.ShowColdTime())}},e.prototype.ShowPriceInfo=function(t,e,i){var n=BagProxy.ins().getItemCountById(t);i.text=UtilProxy.getNumLab(n),BagProxy.ins().getItemData(t)&&(e.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t).displayid))},e.prototype.ShowColdTime=function(){var t=StoreProxy.ins().getbaokuEndTime(this.curType),e=GameLogic.ins().getServerTime();this.lefttime=t-e,this.SetTimeLab(),this.lefttime>0?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,t-e+1,this.SetTimeLab,this,StoreProxy.ins().C2SReqStoreGetBaokuInfo,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&活动结束：@0 |",[UtilProxy.getTimeStr(this.lefttime)]),this.lefttime=this.lefttime-1},e}(BaseEuiView);__reflect(BaoKuView.prototype,"BaoKuView"),ViewManager.ins().reg(BaoKuView,LayerManager.UI_Main),window.BaoKuView=BaoKuView;var BaoWuAttrTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BaowuAttrTipsSkin",this.tipsname.textFlow=UtilProxy.generateTextFlow("|C:10&宝物总属性|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&常规属性|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.cur_type=t[1],this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){this.CloseView()},e.prototype.CloseView=function(){ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){this.zhanValue.text=BaoWuProxy.ins().getTotleFight(this.cur_type).toString();var t="",e=AttrProxy.getAttrInfo(BaoWuProxy.ins().getTotleProInfo(this.cur_type)),i=BaoWuProxy.ins().getPrePecents(this.cur_type);if(void 0!=e)for(var n=0;n<e.length;n++)""==t?t=UtilProxy.getStr("@0 |C:7&+@1 |",[e[n][0],e[n][1].indexOf("%")<0?Number(e[n][1])+Math.floor(Number(e[n][1])*i/1e4):e[n][1]]):t+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[e[n][0],e[n][1].indexOf("%")<0?Number(e[n][1])+Math.floor(Number(e[n][1])*i/1e4):e[n][1]]);this.prolab.textFlow=UtilProxy.generateTextFlow(t)},e}(BaseEuiView);__reflect(BaoWuAttrTips.prototype,"BaoWuAttrTips"),ViewManager.ins().reg(BaoWuAttrTips,LayerManager.UI_Main2),window.BaoWuAttrTips=BaoWuAttrTips;var BaoWuTipsView=function(t){function e(){var e=t.call(this)||this;return e.subType=0,e.curType=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BaoWuTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepFabaoBaowuSwallow,this.ShowInfo),this.subType=t[0],this.curType=t[1],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepFabaoBaowuSwallow,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=t.currentTarget==this.btn?0:1,i=BaoWuProxy.ins().getCurSwallowByType(this.subType,this.curType),n=BaoWuProxy.ins().getMaxSwallowByType(this.subType,this.curType);if(i>=n)return void TipsControl.ins().showTips("吞噬已达到上限");var o=BaoWuProxy.ins().getDanItemIdByType(this.subType,this.curType);return BagProxy.ins().getItemCountById(o)<=0?void TipsControl.ins().showTips("没有可吞噬道具"):void BaoWuProxy.ins().C2SReqFabaoBaowuSwallow(this.subType,this.curType,e)},e.prototype.ShowInfo=function(){var t=BaoWuProxy.ins().getDanItemIdByType(this.subType,this.curType),e=BagProxy.ins().getItemData(t),i=new ItemCellData;i.item_type_id=t,i.itemConfig=e,this.item.data=i;var n=BaoWuProxy.ins().getMaxSwallowByType(this.subType,this.curType),o=BaoWuProxy.ins().getNextMaxSwallowByType(this.subType,this.curType),s=BaoWuProxy.ins().getCurSwallowByType(this.subType,this.curType);this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[e.quality-1],e.name]),o>0?this.desc.textFlow=UtilProxy.StrFormart("|C:10&下阶可吞噬@0 颗 |",[o]):this.desc.textFlow=UtilProxy.StrFormart("|C:10&当前可吞噬@0 颗 |",[n]),this.btn.visible=n>s,this.onekeybtn.visible=n>s,this.limitInfo.visible=s>=n,this.desc0.textFlow=UtilProxy.StrFormart("|C:10&@0 |",["已永久增加主角属性："]),this.tips.text="";var r=GlobalConfig.getBaowu_swallow_item_attrConfigByid(t),a="",h=AttrProxy.getAttrInfo(r,s);if(void 0!=h)for(var l=0;l<h.length;l++)""==a?a=UtilProxy.getStr("@0 |C:7&+@1 |",[h[l][0],h[l][1]]):a+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[h[l][0],h[l][1]]);r.lianshen_pre>0?(this.add.includeInLayout=!0,this.add0.includeInLayout=!0,this.add.textFlow=UtilProxy.StrFormart("|C:@0 &宝物属性 |",[10]),this.add0.textFlow=UtilProxy.StrFormart("|全属性+|C:7&@0 %|",[r.lianshen_pre/100*s])):(this.add.text="",this.add0.text="",this.add.includeInLayout=!1,this.add0.includeInLayout=!1),this.pro.textFlow=UtilProxy.generateTextFlow(a),this.hascount.textFlow=UtilProxy.StrFormart("已拥有：@0 ",[BagProxy.ins().getItemCountById(t)]),this.count.textFlow=UtilProxy.StrFormart("已吞噬：|C:@0 &@1 /@2 |",[n>s?7:4,s,n])},e}(BaseEuiView);__reflect(BaoWuTipsView.prototype,"BaoWuTipsView"),ViewManager.ins().reg(BaoWuTipsView,LayerManager.UI_Main2),window.BaoWuTipsView=BaoWuTipsView;var BaoWuView=function(t){function e(){var e=t.call(this)||this;return e.isJunior=!0,e.current_page=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BaoWuViewSkin",this.comview.initUI(),this.comview.SetName("title_beibao"),this.star_list=[this.star0,this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9],this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3,this.sbtn4]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.comview.SetName(UtilProxy.getTitleName("宝物")),EventProxy.AddListener(this,EventType.S2CRepFabaoGetBaowuInfo,this.S2CRepFabaoGetBaowuInfo),EventProxy.AddListener(this,EventType.S2CRepFabaoBaowuUpgrade,this.S2CRepFabaoBaowuUpgrade),EventProxy.AddListener(this,EventType.S2CRepFabaoBaowuSwallow,this.S2CRepFabaoBaowuSwallow),EventProxy.AddListener(this,EventType.BaowuRedRefresh,this.BaowuRedRefresh),this.addTouchEvent(this.Dan1Btn,this.onDanClick),this.addTouchEvent(this.Dan2Btn,this.onDanClick),this.addTouchEvent(this.uBtn0,this.OnUpdateBtn),this.addTouchEvent(this.uBtn1,this.OnUpdateBtn),this.addTouchEvent(this.gou0Click,this.onGouClick),this.addTouchEvent(this.gou1Click,this.onGouClick),this.addTouchEvent(this.posBtn0,this.onPosClick),this.addTouchEvent(this.btnHClose,this.onHCloseClick),this.addTouchEvent(this.BtnHandle,this.onHandleClick),this.addTouchEvent(this.attrBtn,this.onAttrClick),this.addTouchEvent(this.btnclose,this.onCloseClick);for(var i=0;i<this.sbtnList.length;++i)this.addTouchEvent(this.sbtnList[i],this.onSystemClick);this.setCurrentView(t[1]||0),this.isJunior=!0,this.SetGouState(),this.setRed(),this.backGTween||(this.backGTween=egret.Tween.get(this.handleG,{loop:!0}).to({y:300},500).to({y:285},500))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.Dan1Btn,this.onDanClick),this.removeTouchEvent(this.Dan2Btn,this.onDanClick),this.removeTouchEvent(this.uBtn0,this.OnUpdateBtn),this.removeTouchEvent(this.uBtn1,this.OnUpdateBtn),this.removeTouchEvent(this.gou0Click,this.onGouClick),this.removeTouchEvent(this.gou1Click,this.onGouClick),this.removeTouchEvent(this.posBtn0,this.onPosClick),this.removeTouchEvent(this.btnHClose,this.onHCloseClick),this.removeTouchEvent(this.BtnHandle,this.onHandleClick),this.removeTouchEvent(this.btnclose,this.onCloseClick),this.removeTouchEvent(this.attrBtn,this.onAttrClick);for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onSystemClick);EventProxy.RemoveListener(this,EventType.S2CRepFabaoGetBaowuInfo,this.S2CRepFabaoGetBaowuInfo),EventProxy.RemoveListener(this,EventType.S2CRepFabaoBaowuUpgrade,this.S2CRepFabaoBaowuUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepFabaoBaowuSwallow,this.S2CRepFabaoBaowuSwallow),EventProxy.RemoveListener(this,EventType.BaowuRedRefresh,this.BaowuRedRefresh),this.effect.removeChildren(),this.effect0.removeChildren()},e.prototype.S2CRepFabaoGetBaowuInfo=function(t){},e.prototype.S2CRepFabaoBaowuUpgrade=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[1];this.showDataInfo(),this.setDataByType(this.current_page+1),this.setRed(),this.effect.removeChildren(),UtilProxy.GetMovieClipById(95,this.effect),i&&(this.effect0.removeChildren(),UtilProxy.GetMovieClipById(20,this.effect0))},e.prototype.S2CRepFabaoBaowuSwallow=function(t){this.showDataInfo(),this.setDataByType(this.current_page+1),this.setRed()},e.prototype.onSystemClick=function(t){var e=this.sbtnList.indexOf(t.currentTarget),i=e>0?2:1,n=e>0?6600+e:66;SystemOpenProxy.ins().isCurOpenItem(i,n);e>0?SystemOpenProxy.ins().isOpen(i,n)&&this.setCurrentView(e):this.setCurrentView(e)},e.prototype.onDanClick=function(t){var e,i;switch(t.currentTarget){case this.Dan1Btn:e=1,i=BaoWuProxy.ins().getDanItemIdByType(this.current_page+1,e);break;case this.Dan2Btn:e=2,i=BaoWuProxy.ins().getDanItemIdByType(this.current_page+1,e)}var n=BaoWuProxy.ins().getDataByType(this.current_page+1);return n&&0!=n.level?void ViewManager.ins().open(BaoWuTipsView,this.current_page+1,e):void TipsControl.ins().showTips("一星后激活！")},e.prototype.onGouClick=function(t){switch(t.currentTarget){case this.gou0Click:this.isJunior||(this.isJunior=!0,this.SetGouState());break;case this.gou1Click:this.isJunior&&(this.isJunior=!1,this.SetGouState())}},e.prototype.onHCloseClick=function(t){this.handleG.visible=!1,egret.Tween.removeTweens(this.backGTween),this.backGTween=void 0},e.prototype.onHandleClick=function(t){var e=GlobalConfig.getBaowu_exp_item_dataConfigById(this.current_page+1);if(e){var i=e.item_id[0],n=e.item_id[1],o=BagProxy.ins().getItemData(n);o&&BaoWuProxy.ins().openStoreView(i,n)}},e.prototype.SetGouState=function(){this.gou0.visible=this.isJunior,this.gou1.visible=!this.isJunior},e.prototype.OnUpdateBtn=function(t){var e;switch(t.currentTarget){case this.uBtn0:e=0;break;case this.uBtn1:e=1}var i=GlobalConfig.getBaowu_exp_item_dataConfigById(this.current_page+1);if(i){var n=i.exp_items;if(n){var o;o=this.isJunior?n[0][0]:n[1][0];var s=BagProxy.ins().getItemCountById(o);return 0>=s?void TipsControl.ins().ShowPathTips(o):void BaoWuProxy.ins().C2SReqFabaoBaowuUpgrade(this.current_page+1,this.isJunior?1:2,e)}}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onAttrClick=function(t){ViewManager.ins().open(BaoWuAttrTips,void 0,this.current_page+1)},e.prototype.setCurrentView=function(t){this.current_page!=t&&(this.current_page=t,this.setDataByType(t+1),this.handleG.visible||(this.handleG.visible=!0,this.backGTween||(this.backGTween=egret.Tween.get(this.handleG,{loop:!0}).to({y:300},500).to({y:285},500))))},e.prototype.setDataByType=function(t){var e,i,n,o=BaoWuProxy.ins().getDataByType(t),s=0;if(o&&o.level>=1){var r=GlobalConfig.getBaowu_base_dataConfigsById(o.id);r&&(e=r[o.level],i=AttrProxy.getAttrInfo(e),r[o.level+1]&&(n=AttrProxy.getAttrInfo(r[o.level+1])),this.levelBar.maximum=e.exp,this.levelBar.value=o.exp),this.jieG.removeChildren(),s=Math.ceil(o.level/10);for(var a=0;a<this.star_list.length;++a)0==o.level?this.star_list[a].source="shengxing_icon_01_01":a<10-10*s+o.level?this.star_list[a].source="shengxing_icon_01_05":this.star_list[a].source="shengxing_icon_01_01";if(s>0){if(10>=s){var h=new eui.Image;h.source=BaoWuProxy.ins().getNumberImg(s),this.jieG.addChild(h)}else if(s%10==0||20>s){var h=new eui.Image,l=new eui.Image;20>s?(h.source=BaoWuProxy.ins().getNumberImg(10),this.jieG.addChild(h),l.source=BaoWuProxy.ins().getNumberImg(s%10),this.jieG.addChild(l)):(h.source=BaoWuProxy.ins().getNumberImg(s/10),this.jieG.addChild(h),l.source=BaoWuProxy.ins().getNumberImg(10),this.jieG.addChild(l))}else{var h=new eui.Image,l=new eui.Image,p=new eui.Image;h.source=BaoWuProxy.ins().getNumberImg(Math.floor(s/10)),this.jieG.addChild(h),l.source=BaoWuProxy.ins().getNumberImg(10),this.jieG.addChild(l),p.source=BaoWuProxy.ins().getNumberImg(s%10),this.jieG.addChild(p)}var c=new eui.Image;c.source="jie",this.jieG.addChild(c)}}else{this.jieG.removeChildren();var h=new eui.Image;h.source=BaoWuProxy.ins().getNumberImg(1),this.jieG.addChild(h);var c=new eui.Image;c.source="jie",this.jieG.addChild(c),e=GlobalConfig.getBaowu_base_dataConfigBylvl(t,1),n=AttrProxy.getAttrInfo(e),this.levelBar.maximum=e.exp,this.levelBar.value=o?o.exp:0;for(var a=0;a<this.star_list.length;++a)this.star_list[a].source="shengxing_icon_01_01"}var u=GlobalConfig.getBaowu_exp_item_dataConfigById(t);if(u){if(this.attrG0.removeChildren(),this.attrG1.removeChildren(),i)for(var a=0;a<i.length;a++)if(i[a][0].indexOf(u.teshu[0])<0){var d=new eui.Label;d.size=14,d.textFlow=UtilProxy.generateTextFlow("C:5&"+i[a][0]+"|C:7&    +"+i[a][1]),this.attrG0.addChild(d)}else this.setSpecialAttr(s,n[a],u.teshu[1]);else for(var a=0;a<n.length;a++)if(n[a][0].indexOf(u.teshu[0])<0){var d=new eui.Label;d.size=14,d.textFlow=UtilProxy.generateTextFlow("C:5&"+n[a][0]+"|C:7& +0"),this.attrG0.addChild(d)}if(n)for(var a=0;a<n.length;a++)if(n[a][0].indexOf(u.teshu[0])<0){var d=new eui.Label;d.size=14,d.textFlow=UtilProxy.generateTextFlow("C:5&"+n[a][0]+"|C:7& +"+n[a][1]),this.attrG1.addChild(d)}var g=BaoWuProxy.ins().getNextGrade(t,s);if(g){var y=AttrProxy.getAttrInfo(g);if(y)for(var a=0;a<y.length;a++)y[a][0].indexOf(u.teshu[0])>=0&&this.setSpecialAttr(s+1,y[a],u.teshu[1])}this.showDataInfo(),void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip;var f=UtilProxy.getShowImgPath()+u.path;UtilProxy.GetMovieClip(f,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,6),this.mc1.x=u.pos[0],this.mc1.y=u.pos[1];var _=StoreProxy.ins().getStoreCellByItemId(u.item_id[0],u.item_id[1]),v=u.item_id[1],m=BagProxy.ins().getItemData(v);m&&(this.baoxingName.text=m.name,this.itemH.data=UtilProxy.GetItemCellData(m.id,1),this.discount.source=_.mark),this.setRed()}},e.prototype.setSpecialAttr=function(t,e,i){10>=t?(this.sNum0.source=BaoWuProxy.ins().getNumberImg(t),this.sNum1.visible=!1,this.sNum1.includeInLayout=!1,this.sNum2.visible=!1,this.sNum2.includeInLayout=!1):t%10==0||20>t?(this.sNum1.visible=!0,this.sNum1.includeInLayout=!0,20>t?(this.sNum0.source=BaoWuProxy.ins().getNumberImg(10),this.sNum1.source=BaoWuProxy.ins().getNumberImg(t%10)):(this.sNum0.source=BaoWuProxy.ins().getNumberImg(t/10),this.sNum1.source=BaoWuProxy.ins().getNumberImg(10))):(this.sNum1.visible=!0,this.sNum1.includeInLayout=!0,this.sNum2.visible=!0,this.sNum2.includeInLayout=!0,this.sNum0.source=BaoWuProxy.ins().getNumberImg(Math.floor(t/10)),this.sNum1.source=BaoWuProxy.ins().getNumberImg(10),this.sNum2.source=BaoWuProxy.ins().getNumberImg(t%10)),e[1].indexOf("%")>-1?(this.sValue.text=e[1].slice(0,e[1].indexOf("%")),this.percImg.visible=!0,this.percImg.includeInLayout=!0):(this.sValue.text=e[1],this.percImg.visible=!1,this.percImg.includeInLayout=!1),this.attImg.source=i},e.prototype.showDataInfo=function(){var t=GlobalConfig.getBaowu_exp_item_dataConfigById(this.current_page+1);if(t){var e=t.exp_items;if(e){var i=e[0][0],n=e[1][0],o=BagProxy.ins().getItemCountById(i),s=BagProxy.ins().getItemCountById(n),r=GlobalConfig.getItemsConfig(i),a=GlobalConfig.getItemsConfig(n);this.payIcon0.source=r?AssetMgr.getIconResource(r.displayid):"",this.payIcon1.source=a?AssetMgr.getIconResource(a.displayid):"",this.payName0.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(r.quality)+"&"+r.name+" |C:"+(o>0?7:4)+"&×"+o),this.payName1.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(a.quality)+"&"+a.name+" |C:"+(s>0?7:4)+"&×"+s),this.fightValue0.text=BaoWuProxy.ins().getTotleFight(this.current_page+1).toString()}}},e.prototype.BaowuRedRefresh=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRed()},e.prototype.setRed=function(){for(var t=0;t<this.sbtnList.length;++t)this.sbtnList[t].setRed(BaoWuProxy.ins().getRedByType(t+1));this.Dan1Btn.setRed(BaoWuProxy.ins().isDanRedByType(this.current_page+1,1)),this.Dan2Btn.setRed(BaoWuProxy.ins().isDanRedByType(this.current_page+1,2))},e.prototype.onPosClick=function(t){var e=Number(this.pos_x.text),i=Number(this.pos_y.text);this.mc1&&e&&i&&(this.mc1.x=e,this.mc1.y=i)},e}(BaseEuiView);__reflect(BaoWuView.prototype,"BaoWuView"),ViewManager.ins().reg(BaoWuView,LayerManager.UI_Main),window.BaoWuView=BaoWuView;var BaowuItemcell=function(t){function e(){var e=t.call(this)||this;return e.num=-1,e.skinName="BaowuStoreItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){var t=this.data;if(void 0!=t){var e=UtilProxy.GetItemCellData(t.item_id,1);e.item_count=0,this.item.data=e}},e.prototype.SetNumInfo=function(t){this.count.text=String(t)},e}(BaseItemRender);__reflect(BaowuItemcell.prototype,"BaowuItemcell"),window.BaowuItemcell=BaowuItemcell;var BaowuStoreItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreBaowuItemSkin",e.addTouchEvent(e.enter,e.onClick),e.finish.visible=!1,e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;if(void 0!=e){var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),o=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),s=RoleProxy.ins().getMoneyAttr(e.type);if(o<e.vip_level)return void TipsControl.ins().showTips("VIP等级不足！");if(e.buy_params.length>0){if(e.buy_params[1]>i)return void TipsControl.ins().showTips("等级不足！");if(e.buy_params[2]>n)return void TipsControl.ins().showTips("转不足！")}if(s<e.price)return void(e.type==MoneyAttr.YUANBAO?TipsControl.ins().showTips("元宝不足！"):TipsControl.ins().ShowPathTips(e.type));if(e.need_items.length>0)for(var r=0;r<e.need_items.length;++r)if(BagProxy.ins().getItemCountById(e.need_items[r][0])<e.need_items[r][1])return void TipsControl.ins().ShowPathTips(e.need_items[r][0]);var a=StoreProxy.ins().getLimitCount(Math.floor(e.id/1e3),e.id);return e.max_buy>0&&a>=e.max_buy?void TipsControl.ins().showTips("兑换次数不足！"):void EventProxy.Broast(EventType.ShowBossStoreBuyTips,[e])}},e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.item_id,item_count:t.item_count};e.setItemCellData(i),this.item.data=e;var n=BagProxy.ins().getItemData(t.item_id);this.titleName.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[n.quality-1],n.name]),this.enter.label=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑 换":"购 买";var o=BagProxy.ins().getItemData(t.type);this.icon.source=AssetMgr.getIconResource(o.displayid),this.price.textFlow=UtilProxy.generateTextFlow(""+UtilProxy.getSimpleNum(t.price)),this.discount.source=t.mark,this.item.SetNumInfo(t.item_count),this.refresh()}},e.prototype.refresh=function(){var t=this.data;if(void 0!=t){var e=StoreProxy.ins().getLimitCount(t.shopType,t.id);if(0==t.pass_copy_id||CopyProxy.ins().isCurrentFloorById(t.pass_copy_id))this.openinfo.text="",this.enter.visible=t.max_buy>e,this.finish.visible=t.max_buy<=e;else{var i=GlobalConfig.getCopyConfigById(t.pass_copy_id);this.openinfo.text=i.noColorName+"解锁",this.enter.visible=!1,this.finish.visible=!1}this.item.data=t,this.restricted.textFlow=UtilProxy.StrFormart("限购:@0 /@1 ",[t.max_buy-e,t.max_buy])}},e}(BaseItemRender);__reflect(BaowuStoreItem.prototype,"BaowuStoreItem"),window.BaowuStoreItem=BaowuStoreItem;var BaowuStoreView=function(t){function e(){var e=t.call(this)||this;return e.currentStoreIndex=-1,e.add_index=6,e.buy_num=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="StoreBaowuViewSkin",this.comview.initUI(),this.list.itemRenderer=BaowuStoreItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3,this.sbtn4],this.icon_list=[this.icon0,this.icon1,this.icon2],this.value_list=[this.value0,this.value1,this.value2],this.name_list=[this.name0,this.name1,this.name2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),GlobalConfig.getConfig("store","storeConfig");var i=0;for(var n in GlobalConfig.ins().storeConfig){var o=GlobalConfig.ins().storeConfig[n];"3"==o.pagetype&&(this.addTouchEvent(this.sbtnList[i],this.onMenuClick),this.sbtnList[i].label=o._name,i++)}this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.enterBtn,this.onBuyClick),this.addTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.addTouchEvent(this.tipsAdd,this.onTipsNumClick),this.addTouchEvent(this.tipsAddten,this.onTipsNumClick),this.addTouchEvent(this.tipsLess,this.onTipsNumClick),this.addTouchEvent(this.tipsLessten,this.onTipsNumClick),EventProxy.AddListener(this,EventType.ShowBossStoreBuyTips,this.ShowBossStoreBuyTips),EventProxy.AddListener(this,EventType.UpdataMoney,this.setRefreshData),EventProxy.AddListener(this,EventType.S2CRepStoreBuy,this.S2CRepStoreBuy),EventProxy.AddListener(this,EventType.S2CRepStoreRefresh,this.S2CRepStoreRefresh),EventProxy.AddListener(this,EventType.S2CRepStoreLimitUpdate,this.S2CRepStoreLimitUpdate),EventProxy.AddListener(this,EventType.RefreshStoreRed,this.getRed),this.initItemId=t[1],this.setCurrentStore(t[0]||1),this.getRed()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onMenuClick);this.initItemId=void 0,this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.enterBtn,this.onBuyClick),this.removeTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.removeTouchEvent(this.tipsAdd,this.onTipsNumClick),this.removeTouchEvent(this.tipsAddten,this.onTipsNumClick),this.removeTouchEvent(this.tipsLess,this.onTipsNumClick),this.removeTouchEvent(this.tipsLessten,this.onTipsNumClick),EventProxy.RemoveListener(this,EventType.ShowBossStoreBuyTips,this.ShowBossStoreBuyTips),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.setRefreshData),EventProxy.RemoveListener(this,EventType.S2CRepStoreBuy,this.S2CRepStoreBuy),EventProxy.RemoveListener(this,EventType.S2CRepStoreRefresh,this.S2CRepStoreRefresh),EventProxy.RemoveListener(this,EventType.S2CRepStoreLimitUpdate,this.S2CRepStoreLimitUpdate),EventProxy.RemoveListener(this,EventType.RefreshStoreRed,this.getRed)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.S2CRepStoreBuy=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.visible=!1;for(var i=t[0],n=t[1],o=0;o<this.list.numChildren;++o){var s=this.list.getChildAt(o);if(void 0!=s&&void 0!=s.data){var r=s.data;(StoreProxy.ins().getStoreId(i,r.id)==n||r.id==n)&&s.setData()}}},e.prototype.S2CRepStoreRefresh=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRefreshData(),this.setCurrentStore(this.currentStoreIndex,!0)},e.prototype.S2CRepStoreLimitUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],n=0;n<this.list.numChildren;++n){var o=this.list.getChildAt(n);if(void 0!=o&&void 0!=o.data){var s=o.data;s.id==i&&o.setData()}}},e.prototype.onBuyClick=function(t){void 0!=this.current_store_data&&(StoreProxy.ins().C2SReqStoreBuy(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id,this.buy_num),this.tips.visible=!1)},e.prototype.onCloseTipsClick=function(t){this.tips.visible=!1},e.prototype.onTipsNumClick=function(t){if(void 0!=this.current_store_data){for(var e=this.current_store_data.max_buy,i=StoreProxy.ins().getLimitCount(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id),n=Math.floor(RoleProxy.ins().getMoneyAttr(this.current_store_data.type)/this.current_store_data.price),o=Number.MAX_VALUE,s=0;s<this.current_store_data.need_items.length;++s){var r=Math.floor(BagProxy.ins().getItemCountById(this.current_store_data.need_items[s][0])/this.current_store_data.need_items[s][1]);o>r&&(o=r)}n=Math.min(n,o),e>0?(e-=i,e=Math.min(e,n)):e=n;var a=this.buy_num;switch(t.currentTarget){case this.tipsAdd:a+1>e?TipsControl.ins().showTips("已达上限！"):a+=1;break;case this.tipsAddten:a+1>e?TipsControl.ins().showTips("已达上限！"):a=Math.min(e,a+10);break;case this.tipsLess:a=Math.max(1,a-1);break;case this.tipsLessten:a=Math.max(1,a-10)}this.buy_num=a,this.tipsNum.text=this.buy_num.toString()}},e.prototype.ShowBossStoreBuyTips=function(t){var e=t;this.current_store_data=e,this.buy_num=1,this.tips.visible=!0,this.tipsNum.text=""+e.max_buy,this.tipsNum.text=this.buy_num.toString();var i=new ItemCellData,n={item_slot_idx:0,item_type_id:e.item_id,item_count:e.item_count};i.setItemCellData(n),this.cell.data=i,this.itemName.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(i.itemConfig.quality)+"&"+i.itemConfig.name),this.tipsInfo.textFlow=UtilProxy.generateTextFlow(i.itemConfig.TIPS)},e.prototype.onMenuClick=function(t){var e=this.sbtnList.lastIndexOf(t.currentTarget);this.setCurrentStore(e+1)},e.prototype.setCurrentStore=function(t,e){if(void 0===e&&(e=!1),this.currentStoreIndex!=t||e){this.currentStoreIndex=t;for(var i=StoreProxy.ins().getStoreConfigByStoreType("3"),n=i[t-1],o=n.id,s=0;s<this.sbtnList.length;++s)this.sbtnList[s].icon="common_btn_smell_yellow_off";this.sbtnList[this.currentStoreIndex-1].icon="common_btn_smell_yellow_on";var r=GlobalConfig.getConfig("store","storeConfig"),a=!1;for(var h in r)r[h].rate_type==o&&(a=1==r[h].time_type);var l=new Array;if(a){var p=GlobalConfig.getConfig("store_cell","store_cellConfig"),c=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);for(var h in p)p[h].shopType==o&&(p[h].zhuan_limit.length>0?p[h].zhuan_limit[0]<=c&&p[h].zhuan_limit[1]>=c&&l.push(p[h]):l.push(p[h]))}else for(var s=0;s<StoreProxy.ins().item_list.length;++s)if(StoreProxy.ins().item_list[s].store_id==o)for(var u=0;u<StoreProxy.ins().item_list[s].items.length;++u){var d=StoreProxy.ins().item_list[s].items[u].item_id;l.push(GlobalConfig.getStore_cellConfig(d))}var g=function(t,e){return t.id>e.id?1:-1},y=GlobalConfig.getStoreConfig(o),f="";switch(void 0!=y&&(f=y._name),l.sort(g),this.list.dataProvider=new eui.ArrayCollection(l),this.initItemId=void 0,this.info.textFlow=UtilProxy.StrFormart("|C:7&当前通关层数：@0 层|",[CopyProxy.ins().getCurrentFloorById(y.enter_copy_id)]),t){case 1:this.comview.SetName(UtilProxy.getTitleName("玲珑宝库"));break;case 2:this.comview.SetName(UtilProxy.getTitleName("混沌宝库"));break;case 3:this.comview.SetName(UtilProxy.getTitleName("弑神宝库"));break;case 4:this.comview.SetName(UtilProxy.getTitleName("神农宝库"));break;case 5:this.comview.SetName("title_zhanhunbaokun")}}},e.prototype.setRefreshData=function(){},e.prototype.getRed=function(){for(var t=0;t<this.sbtnList.length;++t)this.sbtnList[t].setRed(StoreProxy.ins().getStoreRedByType(t+this.add_index+1))},e}(BaseEuiView);__reflect(BaowuStoreView.prototype,"BaowuStoreView"),ViewManager.ins().reg(BaowuStoreView,LayerManager.UI_Main),window.BaowuStoreView=BaowuStoreView;var BeastGhostIslandView=function(t){function e(){var e=t.call(this)||this;return e.max_floor=0,e.isCurZhuan=!1,e.skinName="BeastGhostIslandViewSkin",e.scroll1.viewport=e.list1,e.list1.itemRenderer=ItemCell,e.scroll2.viewport=e.list2,e.list2.itemRenderer=BGBossItem,e.menuBtnList=[e.sbtn0,e.sbtn1,e.sbtn2],e
}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.comview.SetName(UtilProxy.getTitleName("神魔禁地")),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.left_btn,this.onArrowClick),this.addTouchEvent(this.right_btn,this.onArrowClick),this.addTouchEvent(this.enter_btn,this.onEnterClick),this.addTouchEvent(this.dCloseBtn,this.onCloseDesClick),this.addTouchEvent(this.des_btn,this.onDesClick),this.addTouchEvent(this.store_btn,this.onStoreClick);for(var i=0;i<this.menuBtnList.length;++i)this.addTouchEvent(this.menuBtnList[i],this.onMenuClick);this.dropItemList||(this.dropItemList=new eui.ArrayCollection,this.list1.dataProvider=this.dropItemList),this.bossItemList||(this.bossItemList=new eui.ArrayCollection,this.list2.dataProvider=this.bossItemList),this.DesG.visible=!1,this.setCurrentType(1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.left_btn,this.onArrowClick),this.removeTouchEvent(this.right_btn,this.onArrowClick),this.removeTouchEvent(this.enter_btn,this.onEnterClick),this.removeTouchEvent(this.dCloseBtn,this.onCloseDesClick),this.removeTouchEvent(this.des_btn,this.onDesClick),this.removeTouchEvent(this.store_btn,this.onStoreClick);for(var i=0;i<this.menuBtnList.length;++i)this.removeTouchEvent(this.menuBtnList[i],this.onMenuClick);this.dropItemList&&(this.dropItemList.removeAll(),this.dropItemList=null),this.bossItemList&&(this.bossItemList.removeAll(),this.bossItemList=null)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onMenuClick=function(t){var e=this.menuBtnList.indexOf(t.currentTarget);e>0&&!SystemOpenProxy.ins().isOpen(2,8700+e)||this.setCurrentType(e+1)},e.prototype.onArrowClick=function(t){var e=this.cur_floor,i=this.max_floor;switch(t.currentTarget){case this.right_btn:i>=e+1&&(e+=1);break;case this.left_btn:e=Math.max(1,e-1)}this.setFloor(e)},e.prototype.onEnterClick=function(t){if(this.cur_scene){var e=BossProxy.ins().IsConditionEnough(this.cur_scene);e.isTrue?BossProxy.ins().isBagLeftEnough()&&BossProxy.ins().enterBossScene(this.cur_scene):TipsControl.ins().showTips(e.str)}},e.prototype.onCloseDesClick=function(t){this.DesG.visible=!1},e.prototype.onDesClick=function(t){this.DesG.visible=!0},e.prototype.onStoreClick=function(t){ViewManager.ins().open(BaoKuView,3)},e.prototype.setFloor=function(t){if(this.cur_floor!=t){var e,i,n,o,s=[];if(this.bossConfigs)for(var r=0;r<this.bossConfigs.length;++r)if(this.max_floor<this.bossConfigs[r].boss_floor&&(this.max_floor=this.bossConfigs[r].boss_floor),this.bossConfigs[r].boss_floor==t&&(s.push(this.bossConfigs[r]),!e&&this.bossConfigs[r].drop_show&&this.bossConfigs[r].drop_show.length>0)){e=[],n=this.bossConfigs[r].pefect_zhuan;for(var a=0;a<this.bossConfigs[r].drop_show.length;++a)i=this.bossConfigs[r].scene,o=this.bossConfigs[r].show_model,e.push(UtilProxy.GetItemCellData(this.bossConfigs[r].drop_show[a],1))}if(this.bossItemList.replaceAll(s),this.dropItemList.replaceAll(e),this.cur_floor=t,this.cur_scene=i,n){var h=GlobalConfig.getSceneConfigById(this.cur_scene),l=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),p=n[0],c=n[1],u=0;l>=p&&c>=l?u=1:p>l&&(u=2),this.isCurZhuan=1==u;var d=["","推荐本层","转数不足"];this.info1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[7,h.SceneName]),this.info2.textFlow=UtilProxy.StrFormart("|推荐@0 转~@1 转|",[UtilProxy.getZhuanByLevel(p),UtilProxy.getZhuanByLevel(c)]),this.info3.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[1==u?7:4,d[u]])}if(void 0!=this.model_mc&&(this.role_model.removeChild(this.model_mc),this.model_mc=null),o){this.model_mc=new egret.MovieClip;var g=UtilProxy.getShowMoviePath()+o[0];UtilProxy.GetMovieClip(g,this.model_mc,-1,void 0),this.role_model.addChildAt(this.model_mc,6),this.model_mc.x=o[1],this.model_mc.y=o[2]}}},e.prototype.setCurrentType=function(t){this.cur_type=t,this.max_floor=0,this.cur_floor=0;var e=[8,9,10];this.bossConfigs=BossProxy.ins().GetBossConfigByType(e[t-1]);var i=1;i=BossProxy.ins().getBGIslandPefectFloor(e[t-1]),this.setFloor(i);for(var n=0;n<this.menuBtnList.length;++n)this.menuBtnList[n].setSelect(n+1==t)},e}(BaseEuiView);__reflect(BeastGhostIslandView.prototype,"BeastGhostIslandView"),ViewManager.ins().reg(BeastGhostIslandView,LayerManager.UI_Main),window.BeastGhostIslandView=BeastGhostIslandView;var BGBossBoxView=function(t){function e(){var e=t.call(this)||this;return e.left_time=60,e.max_time=60,e.cur_box_time=0,e.skinName="BGSceneBoxSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addTouchEvent(this.pay_btn,this.OnPayClick),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.des_btn,this.onDesClick),EventProxy.AddListener(this,EventType.S2CReqBossGetBoxAward,this.S2CReqBossGetBoxAward),this.left_time=this.max_time,this.cur_box_time=0,void 0!=t&&void 0!=t[0]){this.cur_boss_id=t[0];var i=GlobalConfig.getBossConfig(this.cur_boss_id);i&&(this.itemcell.data=UtilProxy.GetItemCellData(i.box_show_id,1))}this.setData(),TimerManager.ins().doTimer(1e3,0,this.UpdateTime,this),this.setTime()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.pay_btn,this.OnPayClick),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.des_btn,this.onDesClick),EventProxy.RemoveListener(this,EventType.S2CReqBossGetBoxAward,this.S2CReqBossGetBoxAward),BossProxy.ins().DoBossBox()},e.prototype.OnPayClick=function(t){var e=this.cur_box_time,i=GlobalConfig.getBossConfig(this.cur_boss_id);void 0!=i.smjd_box_money[e]?RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)>=i.smjd_box_money[e]?this.cur_boss_id&&BossProxy.ins().C2SReqBossGetBoxAward(this.cur_boss_id):TipsControl.ins().showTips("元宝不足!"):TipsControl.ins().showTips("宝箱已挖空!")},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onDesClick=function(t){var e=GlobalConfig.getBoss_miscConfigById(1);ViewManager.ins().open(TipsTrunView,e.smjd_box_des,"宝箱说明")},e.prototype.S2CReqBossGetBoxAward=function(t){this.cur_box_time=this.cur_box_time+1,this.setData()},e.prototype.setData=function(){var t=this.cur_box_time,e=GlobalConfig.getBossConfig(this.cur_boss_id),i=e.smjd_box_money.length,n=Math.max(0,i-t);if(void 0!=e.smjd_box_money[t]){var o=e.smjd_box_money[t];this.pay_icon.visible=o>0,this.pay_value.visible=o>0,this.pay_free.visible=0==o,this.pay_value.text=o,this.pay_free.visible&&(this.pay_free.text="免 费")}else this.pay_icon.visible=!1,this.pay_value.visible=!1,this.pay_free.visible=!0,this.pay_free.textFlow=UtilProxy.StrFormart("|C:@0 &没次数|",[4]);this.info.textFlow=UtilProxy.StrFormart("|剩余次数：|C:@0 &@1 /@2 |",[n>0?7:4,n,i])},e.prototype.UpdateTime=function(){this.left_time=this.left_time-1,this.setTime(),-1==this.left_time&&ViewManager.ins().close(this)},e.prototype.setTime=function(){this.time.textFlow=UtilProxy.StrFormart("|C:7&(@0 )|",[Math.max(this.left_time,0)])},e}(BaseEuiView);__reflect(BGBossBoxView.prototype,"BGBossBoxView"),ViewManager.ins().reg(BGBossBoxView,LayerManager.UI_Main2),window.BGBossBoxView=BGBossBoxView;var BGBossItem=function(t){function e(){var e=t.call(this)||this;return e.isHpShow=!1,e.hp_bg_width=54,e.skinName="BGBossItemExskin",e.init(),e.hpG&&(e.hpG.visible=!1,e.isHpShow=!1,TimerManager.ins().doTimer(200,0,e.Update,e)),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(e&&e.id){var i=GlobalConfig.getMonsterConfigById(e.id);i?(this.bossName.text=i.name,this.icon.source=i.head_res):(this.bossName.text="",this.icon.source="")}},e.prototype.setHpShow=function(t){this.hpG.visible=!0,this.isHpShow=!0},e.prototype.Update=function(){if(this.isHpShow){var t=this.data;if(void 0!=t&&void 0!=t.id){var e=BossProxy.ins().GetBossNextFreeTime(t.id,t.type);if(e>0){var i=UtilProxy.getTimeHMSString(e);this.time.textFlow=UtilProxy.StrFormart("|C:4&@0 |",[i]),UtilProxy.getComponentState(this.blood,!1),UtilProxy.getComponentState(this.blood_bg,!1)}else{this.time.text="";var n=GameLogic.ins().getEnitityByBossId(t.id);n?(UtilProxy.getComponentState(this.blood,!0),UtilProxy.getComponentState(this.blood_bg,!0),this.blood.width=this.hp_bg_width*n.getHP()/n.getHPMax()):(UtilProxy.getComponentState(this.blood,!1),UtilProxy.getComponentState(this.blood_bg,!1))}}}},e.prototype.onClick=function(t){},e}(BaseItemRender);__reflect(BGBossItem.prototype,"BGBossItem"),window.BGBossItem=BGBossItem;var BGIslandEndView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BGIslandEndSkin",e.moneyIcons=[e.moneyIcon0,e.moneyIcon1,e.moneyIcon2],e.moneys=[e.money0,e.money1,e.money2],e.itemList.itemRenderer=ItemMuti,e.itemScroller.viewport=e.itemList,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.LeaveClick),this.addTouchEvent(this.cancel,this.onCloseClick),this.item_dataProvider||(this.item_dataProvider=new eui.ArrayCollection,this.itemList.dataProvider=this.item_dataProvider),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.LeaveClick),this.removeTouchEvent(this.cancel,this.onCloseClick),this.item_dataProvider&&(this.item_dataProvider.removeAll(),this.item_dataProvider=null)},e.prototype.LeaveClick=function(t){var e=GameLogic.ins().getLastScene(),i=GlobalConfig.getSceneConfigById(e);SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),i.x,i.y),ViewManager.ins().close(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){var t=BossProxy.ins().bossPartReward;this.item_dataProvider.replaceAll(t);for(var e=BossProxy.ins().getBossBGSceneItems(),i=0;i<this.moneyIcons.length;++i)if(this.moneyIcons[i].visible=e[i],this.moneys[i].visible=e[i],e[i]){var n=BagProxy.ins().getItemData(e[i]);this.moneyIcons[i].source=AssetMgr.getIconResource(n.displayid),this.moneys[i].text=BossProxy.ins().getPigNumById(e[i])}},e}(BaseEuiView);__reflect(BGIslandEndView.prototype,"BGIslandEndView"),ViewManager.ins().reg(BGIslandEndView,LayerManager.UI_Main2),window.BGIslandEndView=BGIslandEndView;var BGIslandSceneView=function(t){function e(){var e=t.call(this)||this;return e.minMap_width=133,e.minMap_height=112,e.team_max=4,e.canAtk_max=3,e.cur_boss_id=0,e.isChange=!0,e.isLeftChange=!0,e.skinName="BGIslandSceneSkin",e.memberList=[e.member0,e.member1,e.member2,e.member3],e.moneyIcons=[e.moneyIcon0,e.moneyIcon1,e.moneyIcon2],e.moneys=[e.money0,e.money1,e.money2],e.canAtkList=[e.canAtk0,e.canAtk1,e.canAtk2],e.talks=[e.talk0,e.talk1,e.talk2,e.talk3],e.talkls=[e.talkl0,e.talkl1,e.talkl2,e.talkl3],e.hurtList=[e.hurt0,e.hurt1,e.hurt2],e.dropL.itemRenderer=ItemCell,e.dropS.viewport=e.dropL,e.bossL.itemRenderer=BGBossItem,e.bossS.viewport=e.bossL,e.chatL.itemRenderer=BGSceneChatIt,e.chatS.viewport=e.chatL,e.setMoneyIcon(),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.quick_btn,this.onQuickClick),this.addTouchEvent(this.team_btn,this.onTeamClick),this.addTouchEvent(this.atk_own_btn,this.onatk_own_btnClick),this.addTouchEvent(this.store_btn,this.onstore_btnClick),this.addTouchEvent(this.level_btn,this.onlevel_btnClick),this.addTouchEvent(this.change_btn,this.onChangeClick),this.addTouchEvent(this.btn_exit,this.onExitClick),this.addTouchEvent(this.minMap,this.onMinMapClick),this.addTouchEvent(this.hurt_arrow,this.onhurt_arrowClick),this.addTouchEvent(this.leftAnchorBtn,this.onLeftAnchorClick),this.addItemTapEvent(this.bossL,this.onBossClick),this.addItemTapEvent(this.chatL,this.onChatItClick),DeviceUtils.IsWx||DeviceUtils.IsQQ?this.topAnchor.anchorOffsetY=-35:this.topAnchor.anchorOffsetY=0;for(var i=0;i<this.canAtkList.length;++i)this.addTouchEvent(this.canAtkList[i],this.onAtkRoleClick);for(var i=0;i<this.memberList.length;++i)this.addTouchEvent(this.memberList[i],this.onMemberClick);EventProxy.AddListener(this,EventType.S2CBossHurtRank,this.S2CBossHurtRank),EventProxy.AddListener(this,EventType.S2COnLeaveBoss,this.S2COnLeaveBoss),EventProxy.AddListener(this,EventType.S2CRepMonsterDropOwerChange,this.S2CRepMonsterDropOwerChange),EventProxy.AddListener(this,EventType.BossMyHurt,this.BossMyHurt),EventProxy.AddListener(this,EventType.BossDead,this.BossDead),EventProxy.AddListener(this,EventType.S2CCharacterDead,this.S2CCharacterDead),EventProxy.AddListener(this,EventType.S2CVisibleObjEnterRole,this.S2CVisibleObjEnterRole),EventProxy.AddListener(this,EventType.S2CVisibleObjLeave,this.S2CVisibleObjLeave),EventProxy.AddListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.AddListener(this,EventType.RefreshBossRed,this.RefreshBossRed),EventProxy.AddListener(this,EventType.S2CRepBossNextAppear,this.S2CRepBossNextAppear),EventProxy.AddListener(this,EventType.chargeTarget,this.chargeTarget),EventProxy.AddListener(this,EventType.S2CRepTeamGetSceneTeam,this.S2CRepTeamGetSceneTeam),EventProxy.AddListener(this,EventType.getOpenInitView,this.getOpenInitView),EventProxy.AddListener(this,EventType.S2CRepTeamCreate,this.S2CRepTeamCreate),EventProxy.AddListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),EventProxy.AddListener(this,EventType.S2CRepTeamGetInfo,this.S2CRepTeamGetInfo),EventProxy.AddListener(this,EventType.CS2CChannelChat,this.CS2CChannelChat),EventProxy.AddListener(this,EventType.S2CRepTeamRemove,this.S2CRepTeamRemove),EventProxy.AddListener(this,EventType.S2CTeamInfoChange,this.S2CTeamInfoChange),this.drop_dataProvider||(this.drop_dataProvider=new eui.ArrayCollection,this.dropL.dataProvider=this.drop_dataProvider),this.boss_dataProvider||(this.boss_dataProvider=new eui.ArrayCollection,this.bossL.dataProvider=this.boss_dataProvider),this.bossG.visible=!1,this.hurtG.visible=!1,this.targetRole.visible=!1,this.bG.visible=BossProxy.ins().isCanAtkScene(),this.bossExpBar.initUI(),this.SetMinMap(),this.SetHurtData(),this.setCanAtkList(),this.RefreshBossList(),TimerManager.ins().doTimer(1e3,0,this.SetCurLevel,this),this.SetCurLevel(),this.setMoneyValue(),this.RefreshTeamData(),this.closeTalk()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.quick_btn,this.onQuickClick),this.removeTouchEvent(this.team_btn,this.onTeamClick),this.removeTouchEvent(this.atk_own_btn,this.onatk_own_btnClick),this.removeTouchEvent(this.store_btn,this.onstore_btnClick),this.removeTouchEvent(this.level_btn,this.onlevel_btnClick),this.removeTouchEvent(this.change_btn,this.onChangeClick),this.removeTouchEvent(this.btn_exit,this.onExitClick),this.removeTouchEvent(this.minMap,this.onMinMapClick),this.removeTouchEvent(this.hurt_arrow,this.onhurt_arrowClick),this.removeTouchEvent(this.leftAnchorBtn,this.onLeftAnchorClick);for(var i=0;i<this.canAtkList.length;++i)this.removeTouchEvent(this.canAtkList[i],this.onAtkRoleClick);for(var i=0;i<this.memberList.length;++i)this.removeTouchEvent(this.memberList[i],this.onMemberClick);this.removeItemTapEvent(this.bossL,this.onBossClick),this.removeItemTapEvent(this.chatL,this.onChatItClick),EventProxy.RemoveListener(this,EventType.S2CBossHurtRank,this.S2CBossHurtRank),EventProxy.RemoveListener(this,EventType.S2COnLeaveBoss,this.S2COnLeaveBoss),EventProxy.RemoveListener(this,EventType.S2CRepMonsterDropOwerChange,this.S2CRepMonsterDropOwerChange),EventProxy.RemoveListener(this,EventType.BossMyHurt,this.BossMyHurt),EventProxy.RemoveListener(this,EventType.BossDead,this.BossDead),EventProxy.RemoveListener(this,EventType.S2CCharacterDead,this.S2CCharacterDead),EventProxy.RemoveListener(this,EventType.S2CVisibleObjEnterRole,this.S2CVisibleObjEnterRole),EventProxy.RemoveListener(this,EventType.S2CVisibleObjLeave,this.S2CVisibleObjLeave),EventProxy.RemoveListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.RemoveListener(this,EventType.RefreshBossRed,this.RefreshBossRed),EventProxy.RemoveListener(this,EventType.S2CRepBossNextAppear,this.S2CRepBossNextAppear),EventProxy.RemoveListener(this,EventType.chargeTarget,this.chargeTarget),EventProxy.RemoveListener(this,EventType.S2CRepTeamGetSceneTeam,this.S2CRepTeamGetSceneTeam),EventProxy.RemoveListener(this,EventType.getOpenInitView,this.getOpenInitView),EventProxy.RemoveListener(this,EventType.S2CRepTeamCreate,this.S2CRepTeamCreate),EventProxy.RemoveListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),EventProxy.RemoveListener(this,EventType.S2CRepTeamGetInfo,this.S2CRepTeamGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepTeamRemove,this.S2CRepTeamRemove),EventProxy.RemoveListener(this,EventType.S2CTeamInfoChange,this.S2CTeamInfoChange),EventProxy.RemoveListener(this,EventType.CS2CChannelChat,this.CS2CChannelChat),this.drop_dataProvider&&(this.drop_dataProvider.removeAll(),this.drop_dataProvider=null),TimerManager.ins().remove(this.SetCurLevel,this),this.closeTalk(),this.isChange&&(this.isChange=!1,this.setChangeState()),this.isLeftChange&&(this.isLeftChange=!1,this.setLeftChangeState()),this.hurtG.visible=!1,this.chatShow.visible=!1,this.quick_arrow.rotation=0},e.prototype.setSceneName=function(){var t=GameLogic.ins().getCurSceneData();t?this.sceneName.text=t.SceneName:this.sceneName.text=""},e.prototype.onExitClick=function(t){ViewManager.ins().open(BGIslandEndView)},e.prototype.onMinMapClick=function(t){ViewManager.ins().open(BGSceneExpView)},e.prototype.onhurt_arrowClick=function(t){var e=!this.hurtG.visible;this.hurt_arrow.rotation=e?0:180,this.hurtG.visible=e,this.setHurtList()},e.prototype.onQuickClick=function(t){if(this.chatShow.visible)this.chatShow.visible=!1,this.quick_arrow.rotation=0;else if(void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0){this.chatShow.visible=!0;var e=GlobalConfig.getBoss_miscConfigById(1),i=e.talk_list;this.chatL.dataProvider=new eui.ArrayCollection(i),this.quick_arrow.rotation=180}else TipsControl.ins().showTips("请先加入队伍！")},e.prototype.onTeamClick=function(t){TeamProxy.ins().openTeamView()},e.prototype.onatk_own_btnClick=function(t){BossProxy.ins().drop_ower_obj_id!=GameMap.centerEntity.handle?BossProxy.ins().drop_ower_obj_id>-1&&(GameMap.centerEntity.AI.setTarget(BossProxy.ins().drop_ower_obj_id),BossProxy.ins().C2SSetAttackTarget(BossProxy.ins().drop_ower_obj_id)):TipsControl.ins().showTips("当前归属自己！")},e.prototype.onstore_btnClick=function(t){ViewManager.ins().open(BaoKuView,3)},e.prototype.onlevel_btnClick=function(t){ViewManager.ins().open(BGSceneExpView)},e.prototype.onChangeClick=function(t){this.isChange=!this.isChange,this.setChangeState()},e.prototype.setChangeState=function(){this.topAnchor.visible=this.isChange,this.bossG.visible=this.isChange,EventProxy.Broast(EventType.ChangeBGIsland,[1,!this.isChange])},e.prototype.onLeftAnchorClick=function(t){this.isLeftChange=!this.isLeftChange,this.setLeftChangeState()},e.prototype.setLeftChangeState=function(){this.leftShowAnchor.visible=this.isLeftChange,BossProxy.ins().isCanAtkScene()&&(this.bG.visible=this.isLeftChange),this.isLeftChange?this.leftAnchorBtn.rotation=270:this.leftAnchorBtn.rotation=90,EventProxy.Broast(EventType.ChangeBGIsland,[2,!this.isLeftChange])},e.prototype.onAtkRoleClick=function(t){var e=t.currentTarget,i=e.data;if(i&&(i.role_id||i.handle)){var n=GameLogic.ins().getEntityByHandle(i.handle);void 0!=n&&n.handle!=GameMap.centerEntity.AI.getTargetHandle()&&(GameMap.centerEntity.AI.setTarget(i.handle),BossProxy.ins().C2SSetAttackTarget(i.handle))}},e.prototype.onMemberClick=function(t){var e=t.currentTarget,i=e.data;i&&(i.role_id||i.handle)||(TeamProxy.ins().IsCaptain()?ViewManager.ins().open(MyTeamView):TipsControl.ins().showTips("不是队长不能邀请队员！"))},e.prototype.onBossClick=function(t){for(var e=t.itemRenderer,i=e.data,n=0;n<this.xy_list.length;++n)if(this.xy_list[n].monster_id==i.id){var o=this.xy_list[n].XY,s=GameMap.ins().getPath({x:o.x+64,y:o.y+64},GameMap.centerEntity);s&&s.length&&(GameMap.centerEntity.AI.setTargetId(null),GameMap.centerEntity.startMove(s))}},e.prototype.onChatItClick=function(t){var e=t.itemRenderer,i=e.data;void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0&&ChatProxy.ins().C2SChannelChat(TeamProxy.ins().team_info.team_id+2e5,i),this.chatShow.visible=!1,this.quick_arrow.rotation=0},e.prototype.setMoneyIcon=function(){for(var t=BossProxy.ins().getBossBGSceneItems(),e=0;e<this.moneyIcons.length;++e)if(this.moneyIcons[e].visible=t[e],this.moneys[e].visible=t[e],t[e]){var i=BagProxy.ins().getItemData(t[e]);this.moneyIcons[e].source=AssetMgr.getIconResource(i.displayid)}},e.prototype.setMoneyValue=function(){for(var t=BossProxy.ins().getBossBGSceneItems(),e=0;e<this.moneys.length;++e)t[e]&&(this.moneys[e].text=BossProxy.ins().getPigNumById(t[e]))},e.prototype.S2CBossHurtRank=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetHurtData(!0)},e.prototype.S2COnLeaveBoss=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetHurtData();t[0];TimerManager.ins().removeAll(this.setHideBoss),TimerManager.ins().doTimer(2e3,1,this.setHideBoss,this)},e.prototype.BossMyHurt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetHurtData()},e.prototype.S2CRepMonsterDropOwerChange=function(t){this.SetHurtData()},e.prototype.RefreshBossRed=function(t){this.setMoneyValue()},e.prototype.S2CRepBossNextAppear=function(t){this.RefreshBossList()},e.prototype.chargeTarget=function(t){this.setCanAtkList()},e.prototype.S2CCharacterDead=function(t){},e.prototype.S2CVisibleObjEnterRole=function(t){this.setCanAtkList()},e.prototype.S2CVisibleObjLeave=function(t){this.setCanAtkList()},e.prototype.SetAnchorState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.root.visible=i},e.prototype.BossDead=function(t){this.bossExpBar.SetExp(0,1),this.bossBloodIndex.text="×0"},e.prototype.SetHurtData=function(t){void 0===t&&(t=!1);var e=BossProxy.ins().my_hurt,i=GameLogic.ins().getEntityByHandle(BossProxy.ins().boss_obj_id);if(void 0==i)this.bossExpBar.SetExp(0,1),this.bossBloodIndex.text="";else if(this.isChange){this.bossG.visible||(this.bossG.visible=!0);var n=i.getHP(),o=i.getHPMax();this.bossExpBar.SetExp(n,o,t),this.bossBloodIndex.text="×"+Math.ceil(10*n/o)}var s=BossProxy.ins().monster_id;if(this.cur_boss_id!=s){var r=GlobalConfig.getBossConfig(s);if(r){for(var a=[],h=0;h<r.drop_show.length;++h)a.push(UtilProxy.GetItemCellData(r.drop_show[h],1));this.drop_dataProvider.replaceAll(a)}this.cur_boss_id=s}var l=GlobalConfig.getMonsterConfigById(s);l&&(this.bossName.textFlow=UtilProxy.StrFormart("|@0 @1 ",[l.name,l.tips]),this.bossIcon.source=l.head_res);var p=GameLogic.ins().getEntityByHandle(BossProxy.ins().drop_ower_obj_id);this.bossBloodPec.textFlow=UtilProxy.generateTextFlow("我的伤害： "+UtilProxy.getSimpleNum(e)),p?(!this.targetRole.visible&&BossProxy.ins().isCanAtkScene()&&(this.targetRole.visible=!0),this.ownRole.setRoleName(p.name),this.ownRole.setHpValue(p.getHP(),p.getHPMax())):(this.ownRole.setRoleName(""),this.ownRole.setHpValue(0),this.targetRole.visible=!1),this.setHurtList()},e.prototype.setHideBoss=function(){this.bossG.visible=!1,this.targetRole.visible=!1},e.prototype.setCanAtkList=function(){var t=0,e=BossProxy.ins().getTargetEntity();if(e&&e instanceof EntityRole&&e.team_id!=GameMap.centerEntity.team_id&&(this.canAtkList[t].visible=!0,this.canAtkList[t].setDataByEntity(e),t++),BossProxy.ins().atk_list)for(var i=0;i<BossProxy.ins().atk_list.length;++i){var n=BossProxy.ins().atk_list[i].r_id,o=GameLogic.ins().getEntityByRoleId(n);if(o&&o.server_id==BossProxy.ins().atk_list[i].s_id){if(e&&o.role_id==e.role_id)continue;this.canAtkList[t].visible=!0,this.canAtkList[t].setDataByEntity(o),t++}}for(var s=GameLogic.ins().getRoleEntitys(),r=0,a=s;r<a.length;r++){var h=a[r];if((!e||h.role_id!=e.role_id&&h.team_id!=GameMap.centerEntity.team_id)&&!BossProxy.ins().isAtkRole(h.role_id,h.server_id)){if(t>=this.canAtkList.length)break;this.canAtkList[t].visible=!0,this.canAtkList[t].setDataByEntity(h),t++}}for(var i=t;i<this.canAtkList.length;++i)this.canAtkList[i].visible=!1},e.prototype.RefreshBossList=function(){var t=BossProxy.ins().GetBossConfigBySceneId(GameLogic.ins().getCurSceneId());this.boss_dataProvider.replaceAll(t),this.ShowBossListState()},e.prototype.ShowBossListState=function(){this.bossL.validateNow();for(var t=0;t<this.bossL.numChildren;++t){var e=this.bossL.getChildAt(t);e&&e.setHpShow(!0)}},e.prototype.SetMinMap=function(){this.minMap_point.removeChildren();var t=GlobalConfig.getSceneEditorById(GameMap.ins().mapID),e=(t.pixel_width,t.pixel_height,GlobalConfig.getScene_monster_serverConfig(GameLogic.ins().getCurSceneId()));this.xy_list=[],BossProxy.ins().isCanAtkScene()?this.minMap.source="resource/skins/BeastGhostIsland/smjd_xiaotidi_02.png":this.minMap.source="resource/skins/BeastGhostIsland/smjd_xiaotidi_01.png",this.minMap_children=[];for(var i in e){var n=e[i],o=GameMap.ins().getPxPos(n.monster_x),s=GameMap.ins().getPxPos(n.monster_y);this.xy_list.push({monster_id:n.monster_id,XY:{x:o,y:s}})}this.setSceneName()},e.prototype.onTargetClick=function(t){var e=this.minMap_children.indexOf(t.currentTarget),i=(t.currentTarget,this.xy_list[e]),n=GameMap.ins().getPath(i,GameMap.centerEntity);n&&n.length&&(GameMap.centerEntity.AI.setTargetId(null),GameMap.centerEntity.startMove(n))},e.prototype.RefreshTeamData=function(){var t=0;if(void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0){t=TeamProxy.ins().team_info.member_list.length;for(var e=0;e<TeamProxy.ins().team_info.member_list.length;++e){var i=new MemberItemData;i.role_id=TeamProxy.ins().team_info.member_list[e].role_id,i.type=TeamViewType.my,i.member_item=TeamProxy.ins().team_info.member_list[e],this.memberList[e].visible=!0,this.memberList[e].data=i}}for(var e=0;e<this.memberList.length;++e)e>t?this.memberList[e].visible=!1:e==t&&(this.memberList[e].visible=0!=e,this.memberList[e].data=null)},e.prototype.S2CRepTeamGetSceneTeam=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshTeamData(),this.setCanAtkList()},e.prototype.getOpenInitView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshTeamData(),this.setCanAtkList()},e.prototype.S2CRepTeamCreate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshTeamData()},e.prototype.S2CRepTeamLeave=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshTeamData(),this.setCanAtkList()},e.prototype.S2CRepTeamGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshTeamData(),this.setCanAtkList()},e.prototype.S2CRepTeamRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshTeamData(),this.setCanAtkList()},e.prototype.S2CTeamInfoChange=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCanAtkList()},e.prototype.SetCurLevel=function(){var t=GameLogic.ins().getCurSceneId(),e=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),i=GlobalConfig.getscene_drop_ratio_dataConfigByZhuan(t,e),n=GameLogic.ins().getServerTime()-GameLogic.ins().getEnterSceneTime()+BossProxy.ins().GetBossRatioTime(i.type),o=Math.floor(n),s=0;if(i)for(var r=0;r<i.time_ratio.length;++r){var a=i.time_ratio[r][0],h=i.time_ratio[r][1];o>=a&&h>=o&&(s=i.ratio_level-r)}this.cur_time_level.textFlow=UtilProxy.generateTextFlow(BossProxy.ins().getRatioLevelName(s))},e.prototype.CS2CChannelChat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];if(!(2e5>i)&&TeamProxy.ins().team_info&&TeamProxy.ins().team_info.team_id){var n=i-2e5;if(n==TeamProxy.ins().team_info.team_id){var o=t[1];if(o)for(var s=0;s<this.memberList.length;++s)if(this.memberList[s].data&&this.memberList[s].data.role_id&&this.memberList[s].data.role_id==o.from_uid){this.talks[s].visible=!0,this.talkls[s].text=o.msg_content;break}}}},e.prototype.closeTalk=function(){for(var t=0;t<this.talks.length;++t)this.talks[t].visible=!1},e.prototype.setHurtList=function(){if(this.hurtG.visible){var t=0;if(void 0!=BossProxy.ins().hurt_list&&BossProxy.ins().hurt_list.length>0){for(var e=this.hurtList.length,i=0;i<BossProxy.ins().hurt_list.length;++i){var n=BossProxy.ins().hurt_list[i];e>i&&(this.hurtList[i].text=i+1+"             "+n.role_name+"             "+UtilProxy.getSimpleNum(n.hurt)),n.obj_id==GameMap.centerEntity.handle&&(t=i+1)}for(var i=0;e>i;++i)i>=BossProxy.ins().hurt_list.length&&(this.hurtList[i].text="")}else for(var i=0;i<this.hurtList.length;++i)this.hurtList[i].text="";t>0?this.hurtMy.text="我的排名："+t+"             "+UtilProxy.getSimpleNum(BossProxy.ins().my_hurt):this.hurtMy.text="我的排名：未上榜             "+UtilProxy.getSimpleNum(BossProxy.ins().my_hurt)}},e}(BaseEuiView);__reflect(BGIslandSceneView.prototype,"BGIslandSceneView"),ViewManager.ins().reg(BGIslandSceneView,LayerManager.UI_Main),window.BGIslandSceneView=BGIslandSceneView;var BGSceneChatIt=function(t){function e(){var e=t.call(this)||this;return e.skinName="BGScenechatItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;e&&(this.info.text=e)},e}(BaseItemRender);__reflect(BGSceneChatIt.prototype,"BGSceneChatIt"),window.BGSceneChatIt=BGSceneChatIt;var BGSceneExpView=function(t){function e(){var e=t.call(this)||this;e.topLvl=5,e.minMap_width=426,e.minMap_height=295,e.skinName="BGSceneExpSkin",e.lvlLabs=[e.lvlLab0,e.lvlLab1,e.lvlLab2,e.lvlLab3,e.lvlLab4],e.lvlImgs=[e.lvlImg0,e.lvlImg1,e.lvlImg2,e.lvlImg3,e.lvlImg4],e.moneyIcons=[e.moneyIcon0,e.moneyIcon1,e.moneyIcon2],e.moneys=[e.money0,e.money1,e.money2],e.itemList.itemRenderer=ItemMuti,e.itemScroller.viewport=e.itemList;for(var i=0;i<e.lvlLabs.length;++i)e.lvlLabs[i].textFlow=UtilProxy.generateTextFlow(BossProxy.ins().getRatioLevelName(i+1));return e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.team,this.onTeamClick),this.addTouchEvent(this.reward,this.onRewardClick),this.addTouchEvent(this.autoBtn,this.onAutoClick),this.addTouchEvent(this.rCloseBtn,this.onCloseClick),this.addTouchEvent(this.closebtn,this.onCloseRewardClick),this.item_dataProvider||(this.item_dataProvider=new eui.ArrayCollection,this.itemList.dataProvider=this.item_dataProvider),this.rewardG.visible=!1,this.SetCurLevel(),TimerManager.ins().doTimer(1e3,0,this.SetCurLevel,this),this.setAutoAccept(),this.SetMinMap()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.team,this.onTeamClick),this.removeTouchEvent(this.reward,this.onRewardClick),this.removeTouchEvent(this.autoBtn,this.onAutoClick),this.removeTouchEvent(this.rCloseBtn,this.onCloseClick),this.addTouchEvent(this.closebtn,this.onCloseRewardClick),TimerManager.ins().remove(this.SetCurLevel,this),this.rewardG.visible=!1},e.prototype.onTeamClick=function(t){void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0?ViewManager.ins().open(MyTeamView):TeamProxy.ins().C2SReqTeamCreate(GameLogic.ins().getCurSceneId())
},e.prototype.onRewardClick=function(t){this.setData()},e.prototype.onAutoClick=function(t){TeamProxy.ins().auto_accept=!TeamProxy.ins().auto_accept,this.setAutoAccept()},e.prototype.setAutoAccept=function(){this.gou.visible=TeamProxy.ins().auto_accept},e.prototype.onCloseRewardClick=function(t){this.rewardG.visible=!1},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.SetCurLevel=function(){var t=GameLogic.ins().getCurSceneId(),e=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),i=GlobalConfig.getscene_drop_ratio_dataConfigByZhuan(t,e),n=GameLogic.ins().getServerTime()-GameLogic.ins().getEnterSceneTime()+BossProxy.ins().GetBossRatioTime(i.type),o=Math.floor(n),s=UtilProxy.getTimeHSString_2(o);this.time.text=s;var r=0;if(i)for(var a=0;a<i.time_ratio.length;++a){var h=i.time_ratio[a][0],l=i.time_ratio[a][1];o>=h&&l>=o&&(r=i.ratio_level-a)}this.level.textFlow=UtilProxy.generateTextFlow(BossProxy.ins().getRatioLevelName(r));for(var a=0;a<this.lvlImgs.length;++a)a==r-1?this.lvlImgs[a].source="smjd_bg_xiaolv_on":this.lvlImgs[a].source="smjd_bg_xiaolv"},e.prototype.setData=function(){this.rewardG.visible=!0;var t=BossProxy.ins().bossPartReward;this.item_dataProvider.replaceAll(t);for(var e=BossProxy.ins().getBossBGSceneItems(),i=0;i<this.moneyIcons.length;++i)if(this.moneyIcons[i].visible=e[i],this.moneys[i].visible=e[i],e[i]){var n=BagProxy.ins().getItemData(e[i]);this.moneyIcons[i].source=AssetMgr.getIconResource(n.displayid),this.moneys[i].text=BossProxy.ins().getPigNumById(e[i])}},e.prototype.SetMinMap=function(){this.minMap_point.removeChildren();var t=GlobalConfig.getSceneEditorById(GameMap.ins().mapID),e=t.pixel_width,i=t.pixel_height,n=GlobalConfig.getScene_monster_serverConfig(GameLogic.ins().getCurSceneId());this.xy_list=[],BossProxy.ins().isCanAtkScene()?this.map.source="resource/skins/BeastGhostIsland/smjd_ditu_02.jpg":this.map.source="resource/skins/BeastGhostIsland/smjd_ditu_01.jpg",this.minMap_children=[];for(var o in n){var s=n[o],r=GameMap.ins().getPxPos(s.monster_x),a=GameMap.ins().getPxPos(s.monster_y);this.xy_list.push({monster_id:s.monster_id,XY:{x:r,y:a}});var h=new eui.Image;h.source=BossProxy.ins().isBossId(s.monster_id)?"smjd_btn_dingdian_03":"smjd_btn_dingdian_01",h.verticalCenter=a/i*this.minMap_height,h.horizontalCenter=r/e*this.minMap_width,this.minMap_point.addChild(h),this.minMap_children.push(h),this.addTouchEvent(h,this.onTargetClick)}},e.prototype.onTargetClick=function(t){var e=this.minMap_children.indexOf(t.currentTarget),i=(t.currentTarget,this.xy_list[e].XY),n=GameMap.ins().getPath({x:i.x+64,y:i.y+64},GameMap.centerEntity);n&&n.length&&(GameMap.centerEntity.AI.setTargetId(null),GameMap.centerEntity.startMove(n))},e}(BaseEuiView);__reflect(BGSceneExpView.prototype,"BGSceneExpView"),ViewManager.ins().reg(BGSceneExpView,LayerManager.UI_Main),window.BGSceneExpView=BGSceneExpView;var BeItem=function(t){function e(e,i){var n=t.call(this)||this;return n.starCount=0,n.fightTopNum=1,n.skinName="BeItemSkin",n.cf=i,n.g_beStronger.visible=!1,n.g_beElse.visible=!1,1==e?n.beStrongerItem():n.elseItem(),n.btn_go.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onClick,n),n}return __extends(e,t),Object.defineProperty(e.prototype,"starTopCount",{get:function(){return 5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightTop",{get:function(){return this.fightTopNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jindutiaoTopLimit",{get:function(){return 196},enumerable:!0,configurable:!0}),e.prototype.onClick=function(){void 0!=this.cf.openview&&ViewManager.ins().OpenViewById(this.cf.openview[0],this.cf.openview[1])},e.prototype.beStrongerItem=function(){this.g_beStronger.visible=!0;var t=this.cf;this.iconDisplay.source=t.icon,this.title_stronger.text=t.remark;var e=LyhProxy.ins().getCurId(),i=0;if(!(t.limit_range.length<=0)){for(t.limit_range.sort(this.beStrongerSort),i=0;i<t.limit_range.length;i++)if(t.limit_range[i][0]>e){i>0&&i--;break}i==t.limit_range.length&&i--,this.fightTopNum=t.limit_range[i][1],this.updateJindutiao(t.sys_id[0],t.sys_id[1])}},e.prototype.beStrongerSort=function(t,e){return t[0]-e[0]},e.prototype.updateJindutiao=function(t,e){var i=this.g_jindutiao.getChildAt(1),n=this.g_jindutiao.getChildAt(2),o=BeStrongerProxy.ins().getSysFight(t,e);if(i.width=o/this.fightTop<1?o/this.fightTop*this.jindutiaoTopLimit:this.jindutiaoTopLimit,n.text=o+"/"+this.fightTop,this.starCount=o/this.fightTop<1?Math.ceil((1-o/this.fightTop)*this.starTopCount):0,0==this.starCount){var s=new eui.Label("完美");return s.size=16,s.textColor=65310,void this.g_strongerStar.addChild(s)}for(var r=0;r<this.starTopCount;r++){var a=new eui.Image("shengxing_icon_01_01");r<this.starCount&&(a.source="shengxing_icon_01_05"),this.g_strongerStar.addChild(a)}},e.prototype.elseItem=function(){this.g_beElse.visible=!0,this.iconDisplay.source=this.cf.icon,this.title_else.text=this.cf.remark,this.starCount=this.cf.starNum;for(var t=0;t<this.starTopCount;t++){var e=new eui.Image("shengxing_icon_01_01");t<this.starCount&&(e.source="shengxing_icon_01_05"),this.g_starElse.addChild(e)}},e}(eui.Component);__reflect(BeItem.prototype,"BeItem");var BeStrongerTip=function(t){function e(){var e=t.call(this)||this;e.skinName="BeStrongerSkin";var i=[];for(var n in GlobalConfig.getStronger_remarkConfigs())i.push(GlobalConfig.getStronger_remarkConfigs()[n]);return i.length>0&&(e.labelDisplay.text=MathUtils.randomArray(i).remark),e}return __extends(e,t),e.prototype.startAnim=function(){var t=this.x;egret.Tween.get(this,{loop:!0}).to({x:t+10},500).to({x:t},500)},e}(eui.Component);__reflect(BeStrongerTip.prototype,"BeStrongerTip");var BeStrongerView=function(t){function e(){var e=t.call(this)||this;return e.menuCfs=[],e.childViewInit=[],e.childViewClose=[],e.mainBtnArr=[],e.strategyBtnArr=[],e.curTopStronger=0,e.skinName="BeStrongerViewSkin",e}return __extends(e,t),Object.defineProperty(e.prototype,"titleIcon",{get:function(){return["title_gonglue","title_wybq","title_wysj","title_wyzb"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jingdutiaoTopWidth",{get:function(){return 274},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainBtnOnIndex",{set:function(t){for(var e=0;e<this.mainBtnArr.length;e++)this.mainBtnArr[e].icon="common_btn_big_yellow_off",this.closeInfo(e);this.mainBtnArr[t].icon="common_btn_big_yellow",this.ShowCurInfo(this.menuCfs[t].type)},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI()},e.prototype.initBtn=function(){if(!(this.menuCfs.length<=0)){this.mainBtnArr=[],this.g_mainBtn.removeChildren();for(var t=0;t<this.menuCfs.length;t++){var e=new eui.Button;e.skinName=Btn14Skin,e.icon="common_btn_big_yellow",e.label=this.menuCfs[t].name,this.g_mainBtn.addChild(e),this.mainBtnArr.push(e),this.addTouchEvent(e,this.onClick)}this.mainBtnOnIndex=0}},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.comview.open(),this.menuCfs=[];for(var n in GlobalConfig.getStrongMenu())this.menuCfs.push(GlobalConfig.getStrongMenu()[n]);this.childViewInit=[function(){t.initStrategy()},function(){t.initBeStronger()},function(){t.initBeLeveUp()},function(){t.initBeEquipUp()}],this.childViewClose=[function(){t.closeStrategy()},function(){t.closeBeStronger()},function(){t.closeBeLeveUp()},function(){t.closeBeEquipUp()}],this.initBtn(),this.addTouchEvent(this.btn_close,this.onClickClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.childViewClose.length;i++)this.childViewClose[i]()},e.prototype.onClickClose=function(){ViewManager.ins().close(e)},e.prototype.onClick=function(t){this.mainBtnOnIndex=this.mainBtnArr.indexOf(t.currentTarget)},e.prototype.ShowCurInfo=function(t){0==t?this.view_strategy.visible=!0:this.view_be.visible=!0,this.comview.SetName(this.titleIcon[t]),this.childViewInit[t]()},e.prototype.closeInfo=function(t){this.childViewClose[t]()},e.prototype.initStrategy=function(){this.view_be.visible=!1;var t=[];for(var e in GlobalConfig.getStrategybook_dataConfigs())t.push(GlobalConfig.getStrategybook_dataConfigs()[e]);for(var i=[],n=0;n<t.length;n++){for(var o=!1,s=0;s<i.length;s++)if(i[s][0].type==t[n].type){i[s].push(t[n]),o=!0;break}o||i.push([t[n]])}this.strategyBtnArr=[],this.g_strategyBtn.removeChildren();for(var n=0;n<i.length;n++){var r=new StrategyBtn;r.init(this.lb_strategy,i[n]),this.g_strategyBtn.addChild(r),this.strategyBtnArr.push(r),this.addTouchEvent(r.mainTouch,this.onClickStrategyBtn)}this.strategyBtnArr[0].btnSwitch=!0},e.prototype.onClickStrategyBtn=function(t){for(var e=this.strategyBtnArr.indexOf(t.currentTarget.parent.parent),i=0;i<this.strategyBtnArr.length;i++)i!=e&&this.strategyBtnArr[i].btnSwitch&&(this.strategyBtnArr[i].btnSwitch=!1);this.strategyBtnArr[e].btnSwitch=!this.strategyBtnArr[e].btnSwitch},e.prototype.closeStrategy=function(){this.g_strategyBtn.removeChildren(),this.lb_strategy.text="",this.view_strategy.visible=!1},e.prototype.initBeStronger=function(){function t(t,e){var i=0,n=0;return 0==t.starCount&&(i=-1),0==e.starCount&&(n=-1),n-i}this.ui_stronger.visible=!0,this.g_jingdutiao.visible=!0;var e=[],i=[],n=this.g_jingdutiao.getChildAt(1),o=this.g_jingdutiao.getChildAt(2),s=0,r=0;this.g_beItem.parent.scrollV=0;for(var a in GlobalConfig.getBeStronger_dataConfigs())e.push(GlobalConfig.getBeStronger_dataConfigs()[a]);for(var h=0;h<e.length;h++)if(0==e[h].sys_id.length||SystemOpenProxy.ins().isOpen(e[h].sys_id[0],e[h].sys_id[1],!0)){var l=new BeItem(1,e[h]);i.push(l),s+=l.fightTop,r+=BeStrongerProxy.ins().getSysFight(e[h].sys_id[0],e[h].sys_id[1])}n.width=1>r/s?r/s*this.jingdutiaoTopWidth:this.jingdutiaoTopWidth,o.text=r+"/"+s,i.sort(t);for(var h=0;h<i.length;h++)this.g_beItem.addChild(i[h])},e.prototype.closeBeStronger=function(){this.ui_stronger.visible=!1,this.g_jingdutiao.visible=!1,this.g_beItem.removeChildren()},e.prototype.initBeLeveUp=function(){this.ui_levelup.visible=!0,this.g_jingdutiao.visible=!0;var t=[];this.g_beItem.parent.scrollV=0;for(var e in GlobalConfig.getBeLevelup_dataConfigs())t.push(GlobalConfig.getBeLevelup_dataConfigs()[e]);for(var i=0;i<t.length;i++)if(0==t[i].sys_id.length||SystemOpenProxy.ins().isOpen(t[i].sys_id[0],t[i].sys_id[1],!0)){var n=new BeItem(2,t[i]);this.g_beItem.addChild(n)}this.updateExpJindutiao(MoneyAttr.EXP),EventProxy.AddListener(this,EventType.UpdataMoney,this.updateExpJindutiao)},e.prototype.updateExpJindutiao=function(t){if(t==MoneyAttr.EXP){var e=GlobalConfig.getRole_lvl_attrConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)).exp,i=RoleProxy.ins().getMoneyAttr(MoneyAttr.EXP),n=this.g_jingdutiao.getChildAt(1),o=this.g_jingdutiao.getChildAt(2);n.width=1>i/e?i/e*this.jingdutiaoTopWidth:this.jingdutiaoTopWidth,o.text=i+"/"+e}},e.prototype.closeBeLeveUp=function(){this.ui_levelup.visible=!1,this.g_jingdutiao.visible=!1,this.g_beItem.removeChildren(),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.updateExpJindutiao)},e.prototype.initBeEquipUp=function(){this.ui_equip.visible=!0;var t=[];this.g_beItem.parent.scrollV=0;for(var e in GlobalConfig.getBeEquipup_dataConfigs())t.push(GlobalConfig.getBeEquipup_dataConfigs()[e]);for(var i=0;i<t.length;i++)if(0==t[i].sys_id.length||SystemOpenProxy.ins().isOpen(t[i].sys_id[0],t[i].sys_id[1],!0)){var n=new BeItem(3,t[i]);this.g_beItem.addChild(n)}},e.prototype.closeBeEquipUp=function(){this.ui_equip.visible=!1,this.g_beItem.removeChildren()},e}(BaseEuiView);__reflect(BeStrongerView.prototype,"BeStrongerView"),ViewManager.ins().reg(BeStrongerView,LayerManager.UI_Main),window.BeStrongerView=BeStrongerView;var StrategyBtn=function(t){function e(){var e=t.call(this)||this;return e.childList=[],e.childBtnList=[],e.curChildIndex=0,e.displayTarget=void 0,e.curSwitch=!1,e.skinName="StrategyBtnSkin",e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{set:function(t){this.labelDisplay.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainTouch",{get:function(){return this.mainButton.parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"btnSwitch",{get:function(){return this.curSwitch},set:function(t){t?(this.mainButton.source="common_btn_bluebiaoqing_on_01",this.img_jiantou.rotation=180,this.showChild()):(this.mainButton.source="common_btn_bluebiaoqing_off_01",this.img_jiantou.rotation=0,this.g_childButton.removeChildren(),this.childBtnList=[],this.displayTarget.text=""),this.curSwitch=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childOn",{set:function(t){for(var e=0;e<this.childBtnList.length;e++)e!=t?this.childBtnList[e].icon="common_btn_bluebiaoqing_off_02":this.childBtnList[e].icon="common_btn_bluebiaoqing_on_02";this.showTxt(t)},enumerable:!0,configurable:!0}),e.prototype.init=function(t,e,i){if(void 0===i&&(i=!1),!(e.length<=0)){this.childList=[],this.label=e[0].type;for(var n=0;n<e.length;n++)this.childList.push(e[n]);this.displayTarget=t,this.btnSwitch=i}},e.prototype.onClick=function(t){var e=this.childBtnList.indexOf(t.currentTarget);this.childOn=e,this.showTxt(e)},e.prototype.showChild=function(){this.g_childButton.removeChildren(),this.childBtnList=[];for(var t=0;t<this.childList.length;t++){var e=new eui.Button;e.skinName=Btn14Skin,e.icon="common_btn_bluebiaoqing_off_02",e.label=this.childList[t].type_child,e.width=103,e.height=36,this.g_childButton.addChild(e),this.childBtnList.push(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)}this.childOn=0},e.prototype.showTxt=function(t){this.displayTarget.textFlow=UtilProxy.generateTextFlow(this.childList[t].remark),this.displayTarget.parent.scrollV=0},e}(eui.Component);__reflect(StrategyBtn.prototype,"StrategyBtn");var BookItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.pics=[this.pic0,this.pic1,this.pic2,this.pic3,this.pic4]},e.prototype.setSkinName=function(){this.skinName="BookItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.namelab.text=t.name,this.icon.source="resource/skins/book/pics/"+t.pic+".jpg",this.bg.source="resource/skins/book/pics/"+t.bg+".png";for(var e=GrowupProxy.ins().getTujianLevel(t.id),i=GlobalConfig.getTujian_level_dataConfig(-1==e?0:e),n=0;n<this.pics.length;n++){var o=e%this.pics.length;0==o&&e>0||o>n?this.pics[n].source=i.star_pic:this.pics[n].source=i.star_bg}this.Effect.removeChildren(),t.eff_id>0&&UtilProxy.GetMovieClipById(t.eff_id,this.Effect),this.SetBg(-1==e),this.SetRed(0==GrowupProxy.ins().getTujianState(t.id))},e.prototype.SetBg=function(t){this.bg0.visible=t},e.prototype.SetRed=function(t){this.red.visible=t},e}(BaseItemRender);__reflect(BookItem.prototype,"BookItem"),window.BookItem=BookItem;var BookJbItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="BookJbIemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.namelab.text=t.name;var e="|C:10&属性：|",i=AttrProxy.getAttrInfo(t);if(void 0!=i)for(var n=0;n<i.length;n++)e+=UtilProxy.getStr("@0 |C:7&+@1 |  ",[i[n][2],i[n][1]]);this.prolab.textFlow=UtilProxy.generateTextFlow(e),this.haspic.visible=GrowupProxy.ins().IsTujianSuitActive(t.id),this.btn.visible=!this.haspic.visible,UtilProxy.SetAshColor(this.btn,0!=GrowupProxy.ins().getTujianSuitState(t.id));for(var n=0;n<this.itemlist.numChildren;n++){var o=this.itemlist.getChildAt(n);o.visible=void 0!=t.tujian_list[n],t.tujian_list[n]&&this.SetTujianItem(o,t.tujian_list[n])}},e.prototype.SetTujianItem=function(t,e){var i=GlobalConfig.getTujian_dataConfig(e);if(void 0!=i){var n=t.getChildAt(1),o=t.getChildAt(0);n.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[i.name]),o.data=UtilProxy.GetItemCellData(i.items[0][0],1),UtilProxy.SetAshColor(o,-1==GrowupProxy.ins().getTujianLevel(e))}},e.prototype.onClick=function(t){var e=this.data;return 1==GrowupProxy.ins().getTujianSuitState(e.id)?void TipsControl.ins().showTips("该羁绊中有图鉴尚未激活！"):(GrowupProxy.ins().C2SReqGrowupTujianSuitActivate(e.id),void t.stopImmediatePropagation())},e}(BaseItemRender);__reflect(BookJbItem.prototype,"BookJbItem"),window.BookJbItem=BookJbItem;var BookJbView=function(t){function e(){var e=t.call(this)||this;return e.main_id=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BookJbSkin",this.comview.initUI(),this.comview.SetName("title_tujianjiban"),this.list.itemRenderer=BookJbItem,this.sv.viewport=this.list,this.gs=[this.g1,this.g2,this.g3,this.g4,this.g5]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.gs.length;i++)this.addTouchEvent(this.gs[i],this.ongroupClick);this.addTouchEvent(this.jbbtn,this.onopensuitClick),EventProxy.AddListener(this,EventType.S2CRepGrowupTujianSuitActivate,this.ShowEffect),this.ShowInfo(),this.CheckGuide()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.jbbtn,this.onopensuitClick);for(var i=0;i<this.gs.length;i++)this.removeTouchEvent(this.gs[i],this.ongroupClick);EventProxy.RemoveListener(this,EventType.S2CRepGrowupTujianSuitActivate,this.ShowEffect)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ongroupClick=function(t){this.curg&&(this.curg.getChildAt(1).visible=!1),this.curg=t.currentTarget,this.curg.getChildAt(1).visible=!0,this.main_id=this.gs.indexOf(this.curg)+1,this.ShowListInfo()},e.prototype.onopensuitClick=function(t){ViewManager.ins().close(this),ViewManager.ins().open(BookView)},e.prototype.ShowEffect=function(){UtilProxy.GetMovieClipById(88,this.effect),this.ShowInfo()},e.prototype.ShowInfo=function(){void 0==this.curg&&(this.curg=this.g1,this.curg.getChildAt(1).visible=!0,this.main_id=this.gs.indexOf(this.curg)+1);for(var t=0;t<this.gs.length;t++)this.gs[t].getChildAt(3).visible=GrowupProxy.ins().getTujianSuitRedByType(t+1);this.ShowListInfo(),this.ShowSuitInfo()},e.prototype.ShowListInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=GrowupProxy.ins().getTujianSuitList(this.main_id);t.sort(this.sort),this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e])},e.prototype.sort=function(t,e){var i=GrowupProxy.ins().getTujianSuitState(t.id),n=GrowupProxy.ins().getTujianSuitState(e.id);return 0==i?-1:0==n?1:t.id<e.id?-1:e.id<t.id?1:0},e.prototype.ShowSuitInfo=function(){this.jbred.visible=!1,this.jbnumlab.textFlow=UtilProxy.StrFormart("|C:10&( 已激活羁绊数量：|C:7&@0 | )|",[GrowupProxy.ins().getTujianSuitActiveNum()]);var t="无",e=AttrProxy.getAttrInfo(GrowupProxy.ins().getTujianSuitTotlePro());if(void 0!=e)for(var i=0;i<e.length;i++)"无"==t?t=UtilProxy.getStr("@0 |C:7&+@1 |",[e[i][0],e[i][1]]):t+=i%2==0?UtilProxy.getStr("\n@0 |C:7&+@1 |",[e[i][0],e[i][1]]):UtilProxy.getStr("    @0 |C:7&+@1 |",[e[i][0],e[i][1]]);this.jbprolab.textFlow=UtilProxy.generateTextFlow(t)},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BookJbView.prototype,"BookJbView"),ViewManager.ins().reg(BookJbView,LayerManager.UI_Main),window.BookJbView=BookJbView;var BookTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BookTipsSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&图鉴说明|"),this.title0.textFlow=UtilProxy.generateTextFlow("|C:10&图鉴属性|"),this.title1.textFlow=UtilProxy.generateTextFlow("|C:10&图鉴升星|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepGrowupTujianUpgrade,this.ShowInfo),this.id=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupTujianUpgrade,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=GrowupProxy.ins().getTujianState(this.id);return 2==e?void TipsControl.ins().showTips("已满级"):1==e?void TipsControl.ins().showTips("所需材料不足"):void GrowupProxy.ins().C2SReqGrowupTujianUpgrade(this.id)},e.prototype.ShowInfo=function(){var t=GrowupProxy.ins().getTujianLevel(this.id),e=GlobalConfig.getTujian_dataConfig(this.id);if(this.bookitem.data=e,this.bookitem.SetBg(!1),this.bookitem.SetRed(!1),this.zhanValue.text="0",-1!=t&&(this.zhanValue.text=UtilProxy.getFightNumLab(UtilProxy.GetAttrFight(GrowupProxy.ins().GetTujianAtt(this.id,t)))),this.desc.textFlow=UtilProxy.StrFormart("@0 ",[e.desc]),this.btn.label=-1==t?"激活":"升星",this.btn.visible=e.level>t,this.cost.visible=e.level>t,this.item.visible=e.level>t,this.SetProStr(GrowupProxy.ins().GetTujianAtt(this.id,t),this.curpro,1,-1==t),this.SetProStr(GrowupProxy.ins().GetTujianAtt(this.id,t+1),this.nextpro,7,!1),this.nextpro.y=e.level>t?429:458,e.level<=t&&(this.nextpro.textFlow=UtilProxy.generateTextFlow("|C:7&星级已满|")),-1==t){var i=e.items,n=i[0]?i[0][0]:0,o=i[0]?i[0][1]:0,s=BagProxy.ins().getItemCountById(n),r=s>=o;this.cost.textFlow=UtilProxy.StrFormart("消耗：|C:@0 &@1 X @2 (@3 /@2 )|",[r?7:4,BagProxy.ins().getItemName(n),i[0][1],s]);var a=new ItemCellData,h={item_slot_idx:0,item_type_id:n,item_count:0};a.setItemCellData(h),this.item.data=a}else if(e.level>t){var i=e.level_items,l=e.general_items,n=i[0]?i[0][0]:0,p=l[0]?l[0][0]:0,o=i[0]?i[0][1]:0,c=l[0]?l[0][1]:0,s=BagProxy.ins().getItemCountById(n),u=BagProxy.ins().getItemCountById(p),r=s>=o,d=c>0&&u>=c,g=r||!d?n:p;this.cost.textFlow=UtilProxy.StrFormart("消耗：|C:@0 &@1 X @2 (@3 /@2 )|",[r||d?7:4,BagProxy.ins().getItemName(g),r||!d?i[0][1]:l[0][1],r||!d?s:u]);var y=new ItemCellData,h={item_slot_idx:0,item_type_id:g,item_count:0};y.setItemCellData(h),this.item.data=y}},e.prototype.SetProStr=function(t,e,i,n){var o="",s=AttrProxy.getAttrInfo(t);if(void 0!=s)for(var r=0;r<s.length;r++)""==o?o=UtilProxy.getStr("@0 |C:@2 &+@1 |",[s[r][0],n?0:s[r][1],i]):o+=UtilProxy.getStr("\n@0 |C:@2 &+@1 |",[s[r][0],n?0:s[r][1],i]);e.textFlow=UtilProxy.generateTextFlow(o)},e}(BaseEuiView);__reflect(BookTipsView.prototype,"BookTipsView"),ViewManager.ins().reg(BookTipsView,LayerManager.UI_Main2),window.BookTipsView=BookTipsView;var BookView=function(t){function e(){var e=t.call(this)||this;return e.sub_id=0,e.main_id=0,e.picstrs=["common_qianzhui_02","common_qianzhui_03","common_qianzhui_04"],e.titlestrs=["紫色","橙色","红色"],e._titlestrs=["珍兽","玄兽","圣兽"],e.names=["title_honghuangyishou","title_jueseshennv","title_shangguxianmo","title_tiandaoshengwu","title_zhenxishenchong"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BookSkin",this.comview.initUI(),this.list.itemRenderer=BookItem,this.sv.viewport=this.list,this.btns=[this.btn1,this.btn2,this.btn3],this.gs=[this.g1,this.g2,this.g3,this.g4,this.g5],this.pics=[this.pic1,this.pic2,this.pic3],this.titles=[this.title1,this.title2,this.title3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);for(var i=0;i<this.gs.length;i++)this.addTouchEvent(this.gs[i],this.ongroupClick);this.addItemTapEvent(this.list,this.onItemTap),this.addTouchEvent(this.jbbtn,this.onopensuitClick),EventProxy.AddListener(this,EventType.S2CRepGrowupTujianUpgrade,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepGrowupTujianSuitActivate,this.ShowInfo),this.ShowInfo(),this.CheckGuide()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);for(var i=0;i<this.gs.length;i++)this.removeTouchEvent(this.gs[i],this.ongroupClick);this.removeItemTapEvent(this.jbbtn,this.onopensuitClick),this.removeItemTapEvent(this.list,this.onItemTap),EventProxy.RemoveListener(this,EventType.S2CRepGrowupTujianUpgrade,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepGrowupTujianSuitActivate,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){this.curbtn&&(this.curbtn.icon=""),this.curbtn=t.currentTarget,this.curbtn.icon="common_bg_anniudi_on",this.sub_id=this.btns.indexOf(this.curbtn)+1,this.ShowListInfo()},e.prototype.ongroupClick=function(t){this.curg&&(this.curg.getChildAt(1).visible=!1),this.curg=t.currentTarget,this.curg.getChildAt(1).visible=!0,this.main_id=this.gs.indexOf(this.curg)+1,this.curbtn&&(this.curbtn.icon="",this.curbtn=this.btn1,this.curbtn.icon="common_bg_anniudi_on",this.sub_id=this.btns.indexOf(this.curbtn)+1),this.SetSubRed(),this.ShowListInfo()},e.prototype.onopensuitClick=function(t){ViewManager.ins().close(this),ViewManager.ins().open(BookJbView)},e.prototype.onItemTap=function(t){var e=t.item;e&&ViewManager.ins().open(BookTipsView,e.id)},e.prototype.ShowInfo=function(){void 0==this.curg&&(this.curg=this.g1,this.curg.getChildAt(1).visible=!0,this.main_id=this.gs.indexOf(this.curg)+1),void 0==this.curbtn&&(this.curbtn=this.btn1,this.curbtn.icon="common_bg_anniudi_on",this.sub_id=this.btns.indexOf(this.curbtn)+1);for(var t=0;t<this.gs.length;t++)this.gs[t].getChildAt(3).visible=GrowupProxy.ins().getTujianRedByType(t+1);this.SetSubRed(),this.ShowListInfo(),this.ShowSuitInfo()},e.prototype.SetSubRed=function(){if(this.btnred.visible=this.gs[this.main_id-1].getChildAt(3).visible,this.gs[this.main_id-1].getChildAt(3).visible)for(var t=0;t<this.btnred.numChildren;t++)this.btnred.getChildAt(t).visible=GrowupProxy.ins().getTujianRedByTypeAndSubType(this.main_id,t+1);for(var t=0;t<this.pics.length;t++)this.pics[t].source=this.picstrs[t],this.titles[t].text=this.titlestrs[t],5==this.main_id&&(this.pics[t].source=this.picstrs[2],this.titles[t].text=this._titlestrs[t])},e.prototype.ShowListInfo=function(){this.zhanValue.text=UtilProxy.getFightNumLab(GrowupProxy.ins().GetTujianFight()),this.comview.SetName(this.names[this.main_id-1]),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=GrowupProxy.ins().getTujianList(this.main_id,this.sub_id);this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e])},e.prototype.ShowSuitInfo=function(){this.jbred.visible=GrowupProxy.ins().getTujianSuitRed(),this.jbnumlab.textFlow=UtilProxy.StrFormart("|C:10&( 已激活羁绊数量：|C:7&@0 | )|",[GrowupProxy.ins().getTujianSuitActiveNum()]);var t="无",e=AttrProxy.getAttrInfo(GrowupProxy.ins().getTujianSuitTotlePro());if(void 0!=e)for(var i=0;i<e.length;i++)"无"==t?t=UtilProxy.getStr("@0 |C:7&+@1 |",[e[i][0],e[i][1]]):t+=i%2==0?UtilProxy.getStr("\n@0 |C:7&+@1 |",[e[i][0],e[i][1]]):UtilProxy.getStr("    @0 |C:7&+@1 |",[e[i][0],e[i][1]]);this.jbprolab.textFlow=UtilProxy.generateTextFlow(t)},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BookView.prototype,"BookView"),ViewManager.ins().reg(BookView,LayerManager.UI_Main),window.BookView=BookView;var BossAutoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossMutiInfoItemSkin",e.addTouchEvent(e.autoBtn,e.onAutoClick),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refreshData()},e.prototype.onAutoClick=function(t){var e=this.data;if(e&&void 0!=e.id){var i=this.gou.visible;if(i)BossProxy.ins().removeAutoChallenge(e.type,e.id);else{if(BossProxy.ins().isAutoChallengeLimit(e.type))return void TipsControl.ins().showTips("已达BOSS自动挑战上限！");BossProxy.ins().addAutoChallenge(e.type,e.id)}this.gou.visible=!i}},e.prototype.refreshData=function(){var t=this.data;if(t&&void 0!=t.id){var e=GlobalConfig.getMonsterConfigById(t.id),i=BossProxy.ins().getConditionDataById(t.scene),n="";if(i){var o=i.enter_cond,s=0,r=0;for(var a in o)Number(a)==MoneyAttr.LEVEL?r=o[a].limit:Number(a)==MoneyAttr.ZHUAN&&(s=o[a].limit);n=UtilProxy.getLevelAndZhuanStr(r,s)}i.enter_conf[0][0],i.enter_conf[0][1];this.bossName.textFlow=UtilProxy.generateTextFlow(e.name+"|C:7&"+n),this.gou.visible=BossProxy.ins().isAutoChallengeBoss(t.type,t.id)}},e}(BaseItemRender);__reflect(BossAutoItem.prototype,"BossAutoItem"),window.BossAutoItem=BossAutoItem;var BossAutoListView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="BossList2Skin",this.listM.itemRenderer=BossAutoItem,this.scrollerM.viewport=this.listM},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.addTouchEvent(this.closebtn,this.OnCloseClick),this.setBossList(i)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.OnCloseClick)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setBossList=function(t){for(var e=BossProxy.ins().GetBossConfigByType(t),i=[],n=0;n<e.length;++n)BossProxy.ins().IsConditionEnough(e[n].scene).isTrue&&i.push(e[n]);this.listM.dataProvider=new eui.ArrayCollection(i)},e}(BaseEuiView);__reflect(BossAutoListView.prototype,"BossAutoListView"),ViewManager.ins().reg(BossAutoListView,LayerManager.UI_Main),window.BossAutoListView=BossAutoListView,window.BossAutoListView=BossAutoListView;var BossExpBar=function(t){function e(){var e=t.call(this)||this;return e.blood_length=231,e.step=10,e.min=1,e.isInit=!1,e}return __extends(e,t),e.prototype.init=function(){CommonUtils.log("init-------------------->>?????????????>>>>>>>>>>>>>>>>>>>>>>>>>>>>");for(var t=0;t<this.blood_list.length;++t)this.blood_list[t].width=this.blood_length;for(var t=0;t<this.black_list.length;++t)this.black_list[t].width=this.blood_length},e.prototype.initUI=function(){this.black_list=[this.black0,this.black1,this.black2,this.black3,this.black4,this.black5,this.black6,this.black7,this.black8,this.black9],this.blood_list=[this.blood0,this.blood1,this.blood2,this.blood3,this.blood4,this.blood5,this.blood6,this.blood7,this.blood8,this.blood9]},e.prototype.SetExp=function(t,e,i){if(void 0===i&&(i=!1),t==e&&0!=t)return void this.init();for(var n=0;n<this.blood_list.length;++n)if(Math.floor(10*t/e)+1<=n)this.blood_list[n].width=0;else if(Math.floor(10*t/e)==n){var o=10*t/e-n;this.blood_list[n].width=this.blood_length*o}else this.blood_list[n].width=this.blood_length;this.isInit||(TimerManager.ins().doTimer(200,0,this.update,this),this.isInit=!0)},e.prototype.remove=function(){this.isInit&&(TimerManager.ins().remove(this.update,this),this.isInit=!1),this.init()},e.prototype.update=function(){for(var t=this.black_list.length,e=t-1;e>=0;--e)if((this.blood_list[e].width<=0||this.black_list[e].width<this.blood_list[e].width)&&(this.black_list[e].width=this.blood_list[e].width),0!=this.blood_list[e].width&&this.blood_list[e].width!=this.blood_length){var i=(this.black_list[e].width-this.blood_list[e].width)/this.step;this.black_list[e].width=this.black_list[e].width-i,this.black_list[e].width-this.blood_list[e].width<this.min&&(this.black_list[e].width=this.blood_list[e].width)}},e}(BaseItemRender);__reflect(BossExpBar.prototype,"BossExpBar"),window.BossExpBar=BossExpBar,window.BossExpBar=BossExpBar;
var BossIcon=function(t){function e(){var e=t.call(this)||this;return e.isEnough=!1,e.skinName="BossIconSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this),this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e.prototype.refresh=function(){var t=this.data;if(t.id){var e=GlobalConfig.getMonsterConfigById(t.id);void 0!=e&&(this.info.text=e.name,this.level.text="等级"+e.lvl.toString(),this.icon.source=e.head_res);var i=BossProxy.ins().IsConditionEnough(t.scene);this.isEnough=i.isTrue,this.isEnough?(this.Update(),TimerManager.ins().doTimer(1e3,0,this.Update,this)):this.state.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[4,i.str])}},e.prototype.Update=function(){var t=this.data;if(void 0!=t&&void 0!=t.id){this.isEnough=BossProxy.ins().IsConditionEnough(t.scene).isTrue;var e=0;if(e=1==t.type?BossProxy.ins().SimpleBossNextFreeTime(t.copy_id):BossProxy.ins().GetBossNextFreeTime(t.id,t.type),this.isEnough)if(e>0){var i=UtilProxy.getTimeHMSString(e);this.state.text=i+" "}else this.state.textFlow=UtilProxy.generateTextFlow("C:7&BOSS 已复活");e>0?this.kill.visible||(this.kill.visible=!0):(this.kill.visible&&(this.kill.visible=!1),TimerManager.ins().remove(this.Update,this))}},e.prototype.depose=function(){TimerManager.ins().removeAll(this)},e}(BaseItemRender);__reflect(BossIcon.prototype,"BossIcon"),window.BossIcon=BossIcon;var BossItem=function(t){function e(){var e=t.call(this)||this;return e.isOpen=!1,e.isInit=!1,e.isEnough=!1,e.skinName="BossItemSkin",e.iList.itemRenderer=ItemCell,e.red.visible=!1,e.addTouchEvent(e.enter,e.onclick),e.addTouchEvent(e.buyAdd,e.onclick),TimerManager.ins().doTimer(200,0,e.Update,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){var t=this.data;if(t&&void 0!=t.copy_id){var e=GlobalConfig.getCopyConfigById(t.copy_id),i=new Array;this.time.text="",this.limit.text="",this.isOpen=!0,this.isEnough=!0,e.vip_level>0?(this.vip.visible=!0,this.viplv.text=String(e.vip_level),this.bg.visible=!0,this.bg1.visible=!1):(this.bg1.visible=!0,this.bg.visible=!1,this.vip.visible=!1);for(var n=0;n<t.drop_show.length;++n){var o=UtilProxy.GetItemCellData(t.drop_show[n],1);i.push(o)}if(void 0!=e){var s=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),r=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),a=e.open_zhuan,h=e.open_level,l=UtilProxy.getLevelAndZhuanStr(h,a);a>s?(this.isOpen=!1,this.limit.textFlow=UtilProxy.generateTextFlow("C:4&T:"+l+"开启"),this.isEnough=!1):h>r&&(this.isOpen=!1,this.limit.textFlow=UtilProxy.generateTextFlow("C:4&T:"+l+"开启"),this.isEnough=!1)}this.iList.dataProvider=new eui.ArrayCollection(i);var p=CopyProxy.ins().getCopyLeftTimeById(t.copy_id);this.buyAdd.visible=this.isEnough;var c=p>0?7:4;this.isEnough&&(this.isEnough=p>0),this.times.textFlow=this.isOpen?UtilProxy.generateTextFlow("C:10&T:挑战次数：|C:"+c+"&"+p):UtilProxy.generateTextFlow(""),this.isInit=!0,this.enter.visible=this.isOpen;var u=BossProxy.ins().SimpleBossNextFreeTime(t.copy_id);this.isEnough&&0>=u?this.red.visible=!0:this.red.visible=!1;var d=GlobalConfig.getMonsterConfigById(t.id);d?(this.bossInfo.text=UtilProxy.getLevelAndZhuanStr(d.lvl,d.reborn),this.icon.source=d.head_res):this.bossInfo.text=""}},e.prototype.onclick=function(t){var e=this.data,i=GlobalConfig.getCopyConfigById(e.copy_id);switch(t.currentTarget){case this.enter:var n=(CopyProxy.ins().getCopyLeftTimeById(e.copy_id),GlobalConfig.getSceneConfigById(e.scene),RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)),o=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),s=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),r=i.open_zhuan,a=i.open_level,h=i.vip_level;if(r>n)return void TipsControl.ins().showTips("未开启!");if(a>o)return void TipsControl.ins().showTips("未开启!");if(h>s)return void TipsControl.ins().showTips("VIP等级不足!");BossProxy.ins().SimpleBossNextFreeTime(e.copy_id)<=0?BossProxy.ins().isBagLeftEnough()&&CopyProxy.ins().C2SReqCopyEnterCopy(e.copy_id):TipsControl.ins().showTips("未复活!");break;case this.buyAdd:if(void 0==CopyProxy.ins().GetCopyDataByCopyId(e.copy_id))return void TipsControl.ins().showTips("尚未挑战不能购买！");var l=CopyProxy.ins().getCopyBuyTimeById(e.copy_id);if(l<i.buy_times_cost[0]){if(i.buy_times_cost[1][l])var p=i.buy_times_cost[1][l][0],c=i.buy_times_cost[1][l][1];TipsControl.ins().ShowTips1("是否花费"+c+UtilProxy.ins().getMoneyAttrName(p)+"购买1次挑战次数\n|今天剩余购买次数|C:7&("+(i.buy_times_cost[0]-l)+"/"+i.buy_times_cost[0]+")",function(){},function(){CopyProxy.ins().C2SReqCopyBuyTimes(i.entry_copy_id)})}else TipsControl.ins().showTips("购买次数不足！")}},e.prototype.Update=function(){if(this.isInit&&this.isOpen){var t=this.data;if(void 0!=t&&void 0!=t.id){var e=BossProxy.ins().SimpleBossNextFreeTime(t.copy_id);if(e>0){var i=CopyProxy.ins().getCopyLeftTimeById(t.copy_id);if(i>0){var n=UtilProxy.getTimeHMSString(e);this.time.text="复活时间 "+n}else this.time.text="",this.setRed()}else this.time.text="",this.setRed()}}},e.prototype.setRed=function(){this.isEnough&&(this.red.visible=!0)},e}(BaseItemRender);__reflect(BossItem.prototype,"BossItem"),window.BossItem=BossItem;var BossKuaFuItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BtnNew2ExSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;this.setSelect(!1);var e=t.scene,i=GlobalConfig.getMonsterConfigById(t.id),n=BossProxy.ins().getConditionDataById(e),o="",s=!1;if(n.enter_cond){o=BossProxy.ins().getEnterCondStr(n.enter_conf);var r=n.enter_cond;if(r[MoneyAttr.ZHUAN]){var a=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);a>=r[MoneyAttr.ZHUAN].limit&&a<=r[MoneyAttr.ZHUAN].max&&(s=!0)}RoleProxy.ins().getMoneyAttr(n.enter_cond.moneyType)}void 0!=i?this.labelDisplay.textFlow=UtilProxy.generateTextFlow("C:"+(s?7:4)+"&"+o+"|\n"+i.name):CommonUtils.log("not find monster,boss_id",t.id)},e.prototype.setSelect=function(t){this.iconDisplay.source=t?"kuafuboss_biaoqian_on":"common_bg_dikuang"},e}(BaseItemRender);__reflect(BossKuaFuItem.prototype,"BossKuaFuItem"),window.BossKuaFuItem=BossKuaFuItem;var BossLimitItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="bossLimitItemSkin",e.selectIcon.visible=!1,e.killFlag.visible=!1,e.curFlag.visible=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this),this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e.prototype.setData=function(){if(this.data){var t=GlobalConfig.getMonsterConfigById(this.data.boss_id),e=GlobalConfig.getCopyConfigById(this.data.id);this.floor.textFlow=UtilProxy.generateTextFlow(UtilProxy.getZhuanStr(e.open_zhuan)),this.bossName.text=t.name,this.icon.source=t.head_res,this.killFlag.visible=CopyProxy.ins().getBossLimitFloor()>=this.data.id,e.open_zhuan<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)?this.curFlag.visible=CopyProxy.ins().getBossLimitFloor()+1==this.data.id:this.curFlag.visible=!1}},e}(BaseItemRender);__reflect(BossLimitItem.prototype,"BossLimitItem"),window.BossLimitItem=BossLimitItem;var BossMutisItem=function(t){function e(){var e=t.call(this)||this;return e.isEnough=!1,e.skinName="BossMutisItemSkin",e.listH.itemRenderer=ItemCell,e.scrollerH.viewport=e.listH,e.listH.dataProvider=new eui.ArrayCollection,e.gou.visible=!1,e.tipsInfo.textFlow=UtilProxy.generateTextFlow("C:10&复活提醒"),e.recordBtn.textFlow=UtilProxy.generateTextFlow("C:10&U&T:击杀记录"),e.preson.textFlow=UtilProxy.generateTextFlow("争夺人数：|C:10&T:"+Math.ceil(2*Math.random())),e.addTouchEvent(e.enter,e.OnEnterClick),e.addTouchEvent(e.recordBtn,e.OnRecordClick),e.addTouchEvent(e.gouBtn,e.OnGouClick),e}return __extends(e,t),e.prototype.OnEnterClick=function(t){var e=this.data;if(e.id){var i=e.scene,n=GlobalConfig.getSceneConfigById(i);if(void 0!=n){var o=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);if(o>0)return void TipsControl.ins().showTips("Boss未复活");if(e.type==BOSSTYPE.WORLD){if(e.strength>BossProxy.ins().strength)return void TipsControl.ins().ShowPathTips(BossProxy.ins().getStrenthItemId())}else{var s=BossProxy.ins().getChangeDataByType(e.type);if(s.left_times<=0)return void TipsControl.ins().showTips("挑战次数不足！")}var r=BossProxy.ins().IsConditionEnough(e.scene);r.isTrue?BossProxy.ins().isBagLeftEnough()&&BossProxy.ins().enterBossScene(i):TipsControl.ins().showTips(r.str)}}},e.prototype.OnGouClick=function(t){var e=this.data;if(e.id){var i=this.gou.visible;i?BossProxy.ins().removeBossReviveTips(e.type,e.id):BossProxy.ins().addBossReviveTips(e.type,e.id),this.gou.visible=!i}},e.prototype.OnRecordClick=function(t){var e=this.data;e.id&&BossProxy.ins().C2SReqBossKillRecord(e.id)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){var t=this.data;if(t.id){var e=GlobalConfig.getMonsterConfigById(t.id),i=BossProxy.ins().getConditionDataById(t.scene);void 0!=e&&(this.bossName.text=e.name,this.icon.source=e.head_res);var n=BossProxy.ins().IsConditionEnough(t.scene);if(this.isEnough=n.isTrue,i){var o=i.enter_cond,s=0,r=0;for(var a in o)Number(a)==MoneyAttr.LEVEL?r=o[a].limit:Number(a)==MoneyAttr.ZHUAN&&(s=o[a].limit);this.bossLevel.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[this.isEnough?7:4,UtilProxy.getLevelAndZhuanStr(r,s)])}for(var h=new Array,l=0;l<t.drop_show.length;++l){var p=new ItemCellData,c=t.drop_show[l],u=0,d={item_slot_idx:0,item_type_id:c,item_count:u};p.setItemCellData(d),h.push(p)}this.listH.dataProvider=new eui.ArrayCollection(h),this.refreshData(),TimerManager.ins().remove(this.funcTimer,this);var g=BossProxy.ins().GetBossNextFreeTime(t.id,t.type);if(g>0){var y=UtilProxy.getTimeHMSString(g);this.time.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[4,y]),this.enter.visible=!1,this.preson.textFlow=UtilProxy.generateTextFlow("争夺人数：|C:10&0"),TimerManager.ins().doTimer(400,0,this.funcTimer,this)}else this.enter.visible=!0,this.time.text=""}},e.prototype.funcTimer=function(){var t=this.data;if(t.id){var e=BossProxy.ins().GetBossNextFreeTime(t.id,t.type);if(e>0){var i=UtilProxy.getTimeHMSString(e);this.time.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[4,i])}else this.enter.visible=!0,this.time.text="",TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0}},e.prototype.refreshData=function(){var t=this.data;t.id&&(this.recordInfo.text=BossProxy.ins().getBossLastRecordName(t.id),this.gou.visible=BossProxy.ins().isBossReviveTips(t.type,t.id))},e}(BaseItemRender);__reflect(BossMutisItem.prototype,"BossMutisItem"),window.BossMutisItem=BossMutisItem;var BossProcessItem=function(t){function e(){var e=t.call(this)||this;return e.full_width=111,e}return __extends(e,t),e.prototype.setValue=function(t,e){var i=t/e*this.full_width;this.tumb.width=i>this.full_width?this.full_width:i,this.value.text=UtilProxy.getSimpleNum(t)},e}(BaseEuiView);__reflect(BossProcessItem.prototype,"BossProcessItem"),window.BossProcessItem=BossProcessItem;var BossRecordItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossRecordItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.roleName.text="S"+e.server_id+"."+e.role_name,this.hurt.text=UtilProxy.getSimpleNum(e.hurtValue).toString(),this.time.text=DateUtils.getFormatBySecond(e.kill_time,2)},e}(BaseItemRender);__reflect(BossRecordItem.prototype,"BossRecordItem"),window.BossRecordItem=BossRecordItem;var BossRecordView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossKillRecordSkin",this.listC.itemRenderer=BossRecordItem,this.scrollerC.viewport=this.listC,this.listC.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rCloseBtn,this.CloseClick),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rCloseBtn,this.CloseClick)},e.prototype.CloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){if(void 0!=BossProxy.ins().records&&BossProxy.ins().records.length>0){for(var t=new Array,e=0;e<BossProxy.ins().records.length;++e){var i=BossProxy.ins().records[e],n=new BossKillRecord;n.role_name=i.role_name,n.server_id=i.server_id,n.kill_time=i.time,n.hurtValue=i.hurt,t.push(n)}this.listC.dataProvider=new eui.ArrayCollection(t)}else this.listC.dataProvider=new eui.ArrayCollection},e}(BaseEuiView);__reflect(BossRecordView.prototype,"BossRecordView"),ViewManager.ins().reg(BossRecordView,LayerManager.UI_Main2),window.BossRecordView=BossRecordView;var BossRewardDesView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossRewardDesSkin",this.listD0.itemRenderer=ItemCell,this.scrollerD0.viewport=this.listD0,this.listD0.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.closeClick),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.closeClick)},e.prototype.closeClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){var t=BossProxy.ins().monster_id,e=GlobalConfig.getBossConfig(t);if(void 0!=e){var i=GlobalConfig.getDropConfig(1),n=GlobalConfig.getDropItem(i.drop),o=new Array;if(void 0!=n)for(var s=0;s<n.length;s++){var r=n[s],a=new ItemCellData,h={item_slot_idx:0,item_type_id:r[0].id,item_count:r[0].num};a.setItemCellData(h),o.push(a)}this.listD0.dataProvider=new eui.ArrayCollection(o)}},e}(BaseEuiView);__reflect(BossRewardDesView.prototype,"BossRewardDesView"),ViewManager.ins().reg(BossRewardDesView,LayerManager.UI_Main2),window.BossRewardDesView=BossRewardDesView;var BossRewardItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossRewardItemSkin",e.addTouchEvent(e.rewardBtn,e.onRewardClick),e.listD.itemRenderer=ItemCell,e.scrollerD.viewport=e.listD,e.listD.dataProvider=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.onRewardClick=function(t){var e=this.data;void 0!=e&&(BossProxy.ins().isBossHurtReward(e.id)?TipsControl.ins().showTips("已领取！"):e.hurt<BossProxy.ins().my_hurt?BossProxy.ins().C2SReqBossHurtAward(e.id,BossProxy.ins().boss_obj_id,BossProxy.ins().monster_id):TipsControl.ins().showTips("未达领取条件！"))},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){var t=this.data;if(void 0!=t){var e=BossProxy.ins().isBossHurtReward(t.id);this.rewardBtn.visible=!e,this.finish.visible=e,!e&&t.hurt<BossProxy.ins().my_hurt?this.rewardBtn.setRed(!0):this.rewardBtn.setRed(!1),this.info0.text="造成"+UtilProxy.getSimpleNum(t.hurt)+"伤害可领取",this.info1.text=UtilProxy.getSimpleNum(BossProxy.ins().my_hurt)+"/"+UtilProxy.getSimpleNum(t.hurt);var i=GlobalConfig.getDropConfig(t.drop),n=GlobalConfig.getDropItem(i.drop),o=new Array;if(void 0!=n)for(var s=0;s<n.length;s++){var r=n[s],a=new ItemCellData,h={item_slot_idx:0,item_type_id:r[0].id,item_count:r[0].num};a.setItemCellData(h),o.push(a)}this.listD.dataProvider=new eui.ArrayCollection(o)}},e}(BaseItemRender);__reflect(BossRewardItem.prototype,"BossRewardItem"),window.BossRewardItem=BossRewardItem;var BossRewardTotal=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossRewardTotalSkin",this.listM.itemRenderer=ItemMuti,this.scrollerM.viewport=this.listM},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onClick),this.addTouchEvent(this.rewardBtn,this.onClick),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onClick),this.removeTouchEvent(this.rewardBtn,this.onClick)},e.prototype.onClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){var t=BossProxy.ins().bossPartReward;this.listM.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(BossRewardTotal.prototype,"BossRewardTotal"),ViewManager.ins().reg(BossRewardTotal,LayerManager.UI_Main2),window.BossRewardTotal=BossRewardTotal;var BossRewardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossRewardSkin",this.listD.itemRenderer=BossRewardItem,this.scrollerD.viewport=this.listD,this.listD.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.CloseClick),EventProxy.AddListener(this,EventType.S2CReqBossHurtAward,this.S2CReqBossHurtAward),EventProxy.AddListener(this,EventType.BossMyHurt,this.BossMyHurt),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.CloseClick),EventProxy.RemoveListener(this,EventType.S2CReqBossHurtAward,this.S2CReqBossHurtAward),EventProxy.RemoveListener(this,EventType.BossMyHurt,this.BossMyHurt)},e.prototype.CloseClick=function(t){ViewManager.ins().close(this)},e.prototype.S2CReqBossHurtAward=function(t){for(var e=t,i=0;i<this.listD.numChildren;++i){var n=this.listD.getChildAt(i);if(n){var o=n.data;o&&o.id&&o.id==e&&n.refresh()}}},e.prototype.BossMyHurt=function(t){for(var e=0;e<this.listD.numChildren;++e){var i=this.listD.getChildAt(e);i&&i.refresh()}},e.prototype.setData=function(){var t=BossProxy.ins().monster_id,e=GlobalConfig.getBossConfig(t);if(void 0!=e){for(var i=new Array,n=0;n<e.hurt_award_drop.length;++n){var o=new BossRewardData;o.id=n+1,o.hurt=e.hurt_award_drop[n][0],o.drop=e.hurt_award_drop[n][1],i.push(o)}this.listD.dataProvider=new eui.ArrayCollection(i)}},e}(BaseEuiView);__reflect(BossRewardView.prototype,"BossRewardView"),ViewManager.ins().reg(BossRewardView,LayerManager.UI_Main2),window.BossRewardView=BossRewardView;var BossSceneView=function(t){function e(){var e=t.call(this)||this;return e.show_type=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MainViewBossSkin",this.bossExpBar.initUI(),this.showList.itemRenderer=ItemCell,this.showList.dataProvider=new eui.ArrayCollection,this.ownerBloodBar.setThumb("kuafuboss_wanjiaxuetiao"),this.hurtRoleList=[this.hurtRole0,this.hurtRole1,this.hurtRole2],this.hurtIconList=[this.hurtIcon0,this.hurtIcon1,this.hurtIcon2],this.hurtNameList=[this.hurtName0,this.hurtName1,this.hurtName2],this.hurtselectList=[this.hurtselect0,this.hurtselect1,this.hurtselect2],this.yamaHurtList=[this.yamahurt0,this.yamahurt1,this.yamahurt2],this.yamaRecord.textFlow=UtilProxy.generateTextFlow("C:7&U&累计奖励")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.addTouchEvent(this.killBtn,this.onKillClick),this.addTouchEvent(this.targetBtn0,this.ontargetClick),this.addTouchEvent(this.targetBtn1,this.ontargetClick),this.addTouchEvent(this.hurtRewardBtn,this.onHurtRewardClick),this.addTouchEvent(this.bossRewardBtn,this.onBossRewardClick),this.addTouchEvent(this.lingAdd,this.onLingAddClick),this.addTouchEvent(this.yamaRecord,this.onYamaRecordClick);for(var n=0;n<this.hurtIconList.length;++n)this.addTouchEvent(this.hurtIconList[n],this.onHurtIconClick);this.addTouchEvent(this.yamaTeamBtn,this.onTeamClick),this.addTouchEvent(this.yamaBossBtn,this.onYamaBossListClick),EventProxy.AddListener(this,EventType.S2CBossHurtRank,this.S2CBossHurtRank),EventProxy.AddListener(this,EventType.S2COnLeaveBoss,this.S2COnLeaveBoss),EventProxy.AddListener(this,EventType.S2CRepMonsterDropOwerChange,this.S2CRepMonsterDropOwerChange),EventProxy.AddListener(this,EventType.BossMyHurt,this.BossMyHurt),EventProxy.AddListener(this,EventType.chargeTarget,this.chargeTarget),EventProxy.AddListener(this,EventType.BossDead,this.BossDead),EventProxy.AddListener(this,EventType.RefreshYamaId,this.RefreshYamaId),EventProxy.AddListener(this,EventType.S2CCharacterDead,this.S2CCharacterDead),EventProxy.AddListener(this,EventType.S2CVisibleObjEnterRole,this.S2CVisibleObjEnterRole),EventProxy.AddListener(this,EventType.S2CVisibleObjLeave,this.S2CVisibleObjLeave),EventProxy.AddListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.AddListener(this,EventType.S2CReqBossHurtAward,this.S2CReqBossHurtAward),this.targetSelectIcon.visible=!1,this.targetSelectIcon0.visible=!1;var o=5==i,s=6==i;this.isShenwenBoss=11==i,o||this.isShenwenBoss?this.show_type=1:s?this.show_type=2:this.show_type=0;var r=0==this.show_type;this.rewardG.visible=r,this.targetBtnG.visible=o||this.isShenwenBoss,this.ownerG1.visible=r,this.brG1.visible=o||this.isShenwenBoss,this.ownerG.visible=!1,this.targetG.visible=o||this.isShenwenBoss,this.hurtRankG.visible=o||this.isShenwenBoss,this.yamaInfoG.visible=s,this.brYG.visible=s,this.yamaHurtG.visible=s,o||this.isShenwenBoss?(this.SetHurtData(),this.setHurtList(),this.setTargetData(),this.setCrossBossInfo()):s?(this.setYamaInfo(),this.setHurtList()):(this.setData(),this.SetHurtData())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.killBtn,this.onKillClick),this.removeTouchEvent(this.targetBtn0,this.ontargetClick),this.removeTouchEvent(this.targetBtn1,this.ontargetClick),this.removeTouchEvent(this.hurtRewardBtn,this.onHurtRewardClick),this.removeTouchEvent(this.bossRewardBtn,this.onBossRewardClick),this.removeTouchEvent(this.lingAdd,this.onLingAddClick),this.removeTouchEvent(this.yamaRecord,this.onYamaRecordClick);for(var i=0;i<this.hurtIconList.length;++i)this.removeTouchEvent(this.hurtIconList[i],this.onHurtIconClick);this.removeTouchEvent(this.yamaTeamBtn,this.onTeamClick),this.removeTouchEvent(this.yamaBossBtn,this.onYamaBossListClick),EventProxy.RemoveListener(this,EventType.S2CBossHurtRank,this.S2CBossHurtRank),EventProxy.RemoveListener(this,EventType.S2COnLeaveBoss,this.S2COnLeaveBoss),EventProxy.RemoveListener(this,EventType.S2CRepMonsterDropOwerChange,this.S2CRepMonsterDropOwerChange),EventProxy.RemoveListener(this,EventType.BossMyHurt,this.BossMyHurt),EventProxy.RemoveListener(this,EventType.chargeTarget,this.chargeTarget),EventProxy.RemoveListener(this,EventType.BossDead,this.BossDead),EventProxy.RemoveListener(this,EventType.RefreshYamaId,this.RefreshYamaId),EventProxy.RemoveListener(this,EventType.S2CCharacterDead,this.S2CCharacterDead),EventProxy.RemoveListener(this,EventType.S2CVisibleObjEnterRole,this.S2CVisibleObjEnterRole),EventProxy.RemoveListener(this,EventType.S2CVisibleObjLeave,this.S2CVisibleObjLeave),EventProxy.RemoveListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.RemoveListener(this,EventType.S2CReqBossHurtAward,this.S2CReqBossHurtAward),TimerManager.ins().removeAll(this)},e.prototype.S2CReqBossHurtAward=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setHurtRewardState()},e.prototype.setHurtRewardState=function(){this.hurtRewardBtn.setRed(BossProxy.ins().isBossHurtRed())},e.prototype.onKillClick=function(t){if(BossProxy.ins().drop_ower_name==RoleProxy.ins().getRoleName())return void TipsControl.ins().showTips("不能挑战自己");var e=GameLogic.ins().getEntityByHandle(BossProxy.ins().drop_ower_obj_id);e&&BossProxy.ins().C2SReqBossOwnerLoot(e.role_id,BossProxy.ins().boss_obj_id)},e.prototype.ontargetClick=function(t){var e=GameMap.centerEntity.AI.getTargetHandle();if(void 0!=e)switch(t.currentTarget){case this.targetBtn0:this.targetSelectIcon.visible=!0,this.targetSelectIcon0.visible=!1,e!=BossProxy.ins().boss_obj_id&&(GameMap.centerEntity.AI.setTarget(BossProxy.ins().boss_obj_id),BossProxy.ins().C2SSetAttackTarget(BossProxy.ins().boss_obj_id));break;case this.targetBtn1:BossProxy.ins().drop_ower_obj_id!=GameMap.centerEntity.handle?(this.targetSelectIcon.visible=!1,this.targetSelectIcon0.visible=!0,GameMap.centerEntity.AI.setTarget(BossProxy.ins().drop_ower_obj_id),BossProxy.ins().C2SSetAttackTarget(BossProxy.ins().drop_ower_obj_id)):TipsControl.ins().showTips("当前归属自己！")}},e.prototype.onHurtRewardClick=function(t){ViewManager.ins().open(BossRewardView)},e.prototype.onBossRewardClick=function(t){ViewManager.ins().open(BossRewardDesView)},e.prototype.onHurtIconClick=function(t){var e=this.hurtIconList.lastIndexOf(t.currentTarget),i=this.hurtDataList[e];void 0!=i&&i.obj_id!=GameMap.centerEntity.AI.getTargetHandle()&&(GameMap.centerEntity.AI.setTarget(i.obj_id),BossProxy.ins().C2SSetAttackTarget(i.obj_id))},e.prototype.onTeamClick=function(t){TeamProxy.ins().openTeamView()},e.prototype.onYamaBossListClick=function(t){ViewManager.ins().open(BossYamaList)},e.prototype.setData=function(){var t=GameLogic.ins().getCurSceneId();GlobalConfig.getConfig("boss","bossConfig");for(var e in GlobalConfig.ins().bossConfig)if(t==GlobalConfig.ins().bossConfig[e].scene){for(var i=GlobalConfig.ins().bossConfig[e].drop_show,n=new Array,o=0;o<i.length;++o){var s=new ItemCellData,r=i[o],a=0,h={item_slot_idx:0,item_type_id:r,item_count:a};s.setItemCellData(h),n.push(s)}this.showList.dataProvider=new eui.ArrayCollection(n);break}},e.prototype.setTargetData=function(){if(1==this.show_type){var t=GameMap.centerEntity.AI.getTargetHandle();if(void 0!=t){var e=GameLogic.ins().getEntityByHandle(t);if(void 0!=e&&(this.targetName.text=e.name,e instanceof EntityRole?(this.targetIcon.source=BossProxy.ins().getRoleIconName(e.getJob()),BossProxy.ins().drop_ower_obj_id==e.handle?(this.targetSelectIcon.visible=!1,this.targetSelectIcon0.visible=!0):(this.targetSelectIcon.visible=!1,this.targetSelectIcon0.visible=!1)):e instanceof EntityMonster&&(this.targetIcon.source=e.getConfig().head_res,this.targetSelectIcon.visible=!0,this.targetSelectIcon0.visible=!1,BossProxy.ins().C2SSetAttackTarget(e.handle))),this.hurtDataList)for(var i=0;i<this.hurtselectList.length;++i)if(this.hurtDataList[i]){var n=this.hurtDataList[i];void 0!=n&&n.obj_id==t?this.hurtselectList[i].visible=!0:this.hurtselectList[i].visible=!1}}}},e.prototype.setHurtList=function(){if(1==this.show_type)if(void 0!=BossProxy.ins().hurt_list&&BossProxy.ins().hurt_list.length>0){var t=0;this.hurtDataList=[];for(var e=0;e<BossProxy.ins().hurt_list.length;++e){var i=BossProxy.ins().hurt_list[e];if(t>=3)break;i.obj_id!=GameMap.centerEntity.handle&&(this.hurtRoleList[t].visible=!0,this.hurtNameList[t].text=i.role_name,this.hurtDataList[t]=i,this.hurtIconList[t].source=BossProxy.ins().getRoleIconName(i.prof),t++)}for(var e=0;e<this.hurtRoleList.length;++e)e>=t&&(this.hurtRoleList[e].visible=!1)}else for(var e=0;e<this.hurtRoleList.length;++e)this.hurtRoleList[e].visible=!1;else if(2==this.show_type){var n=0;if(void 0!=BossProxy.ins().hurt_list&&BossProxy.ins().hurt_list.length>0){for(var o=this.yamaHurtList.length,e=0;e<BossProxy.ins().hurt_list.length;++e){var i=BossProxy.ins().hurt_list[e];o>e&&(this.yamaHurtList[e].text=e+1+"             "+i.role_name+"             "+UtilProxy.getSimpleNum(i.hurt)),i.obj_id==GameMap.centerEntity.handle&&(n=e+1)}for(var e=0;e<this.hurtRoleList.length;++e)e>=BossProxy.ins().hurt_list.length&&(this.yamaHurtList[e].text="")}else for(var e=0;e<this.yamaHurtList.length;++e)this.yamaHurtList[e].text="";n>0?this.yamahurtMy.text="我的排名："+n+"             "+UtilProxy.getSimpleNum(BossProxy.ins().my_hurt):this.yamahurtMy.text="我的排名：未上榜             "+UtilProxy.getSimpleNum(BossProxy.ins().my_hurt)}},e.prototype.setDropOwnerRole=function(){},e.prototype.BossDead=function(t){t||1==this.show_type&&ViewManager.ins().open(FbendView,[],!1,EndType.BOSS_KF),this.bossExpBar.SetExp(0,1),this.bossBloodIndex.text="×0"},e.prototype.RefreshYamaId=function(t){this.lingNum.text=BagProxy.ins().getItemCountById(BossProxy.ins().getYamaLingId()).toString()},e.prototype.S2CCharacterDead=function(t){this.yamaNum.text=GameLogic.ins().getEnitityRoleCount().toString()},e.prototype.S2CVisibleObjEnterRole=function(t){this.yamaNum.text=GameLogic.ins().getEnitityRoleCount().toString()},e.prototype.S2CVisibleObjLeave=function(t){this.yamaNum.text=GameLogic.ins().getEnitityRoleCount().toString()},e.prototype.S2CBossHurtRank=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetHurtData(!0),this.setHurtList()},e.prototype.S2COnLeaveBoss=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetHurtData()},e.prototype.BossMyHurt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetHurtData(),this.setHurtRewardState(),this.setTargetData()},e.prototype.chargeTarget=function(t){this.setTargetData()},e.prototype.S2CRepMonsterDropOwerChange=function(t){this.SetHurtData()},e.prototype.SetHurtData=function(t){void 0===t&&(t=!1);var e=BossProxy.ins().my_hurt;this.fightValue.text="",this.bloodPec.text="";var i=GameLogic.ins().getEntityByHandle(BossProxy.ins().boss_obj_id);if(void 0==i)this.bossExpBar.SetExp(0,1),this.bossBloodIndex.text="";else{var n=i.getHP(),o=i.getHPMax();this.bossExpBar.SetExp(n,o,t),this.bossBloodIndex.text="×"+Math.ceil(10*n/o)}var s=GlobalConfig.getMonsterConfigById(BossProxy.ins().monster_id);s&&(this.bossName.textFlow=UtilProxy.StrFormart("|@0 @1 ",[s.name,s.tips]),this.bossIcon.source=s.head_res);var r=GameLogic.ins().getEntityByHandle(BossProxy.ins().drop_ower_obj_id);if(0==this.show_type)if(this.bossBloodPec.textFlow=UtilProxy.generateTextFlow("我的伤害： "+UtilProxy.getSimpleNum(e)),this.roleName.text=BossProxy.ins().drop_ower_name,void 0==r)this.bloodPec.textFlow=UtilProxy.generateTextFlow("剩余血量： 100%");else{var a=Math.floor(100*r.getHP()/r.getHPMax());this.bloodBar.value=r.getHP(),this.bloodBar.maximum=r.getHPMax(),this.roleIcon.source=r.vo&&2==r.vo.sex?"common_morentouxaing_02":"common_morentouxaing_01",this.bloodPec.textFlow=UtilProxy.generateTextFlow("剩余血量："+a+"%"),r==GameMap.centerEntity?(this.fightValue.text=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING).toString(),this.owerLight.visible=!1):(this.owerLight.visible=!0,this.fightValue.text=r.getFight().toString())}else if(1==this.show_type)if(this.ownerInfo0.textFlow=UtilProxy.generateTextFlow("C:7&归属|"+BossProxy.ins().drop_ower_name),this.bossBloodPec.textFlow=UtilProxy.generateTextFlow("我的伤害： "+e),void 0==r)this.ownerG.visible=!1,this.ownerInfo1.text="",this.ownerBloodBar.value=0,this.ownerBloodBar.maximum=100;else{this.ownerG.visible||(this.ownerG.visible=!0),BossProxy.ins().drop_ower_obj_id==GameMap.centerEntity.handle?this.ownerIcon.source=BossProxy.ins().getRoleIconName(RoleProxy.ins().getProf()):r instanceof EntityRole&&(this.ownerIcon.source=BossProxy.ins().getRoleIconName(r.getJob()));var a=Math.floor(100*r.getHP()/r.getHPMax());this.ownerBloodBar.value=r.getHP(),this.ownerBloodBar.maximum=r.getHPMax(),this.ownerInfo1.textFlow=UtilProxy.generateTextFlow(a+"%")}else 2==this.show_type&&(this.bossBloodPec.text="")},e.prototype.onLingAddClick=function(t){var e=GlobalConfig.getBoss_miscConfigById(1),i=e.ylsd_token_id,n=GlobalConfig.getItemsConfig(i),o=n.buyprice[0],s=n.buyprice[1];s<=RoleProxy.ins().getMoneyAttr(o)?TipsControl.ins().ShowTips1("是否花费"+UtilProxy.ins().getMoneyAttrName(o)+" "+s+" 购买 "+n.name+"?",function(){},function(){StoreProxy.ins().C2SReqMiscAutoBuyItem(n.id,1)
}):TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o)+"不足！")},e.prototype.onYamaRecordClick=function(t){ViewManager.ins().open(BossRewardTotal)},e.prototype.setCrossBossInfo=function(){void 0!=this.crossTimer&&(TimerManager.ins().remove(this.crossTimer,this),this.crossTimer=void 0),this.cross_act_data=ActivityProxy.ins().getActivityDataById(ActivityType.KuaFuBoss),(void 0==this.cross_act_data||null==this.cross_act_data||0==this.cross_act_data.act_status)&&(this.cross_act_data=ActivityProxy.ins().getActivityDataById(ActivityType.ShenwenBoss)),this.crossTimer=function(){if(void 0!=this.cross_act_data){var t=this.cross_act_data.act_time-GameLogic.ins().getServerTime();if(1==this.cross_act_data.act_status)this.boss_time.textFlow=UtilProxy.generateTextFlow("C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)));else{var e=GameLogic.ins().getLastScene(),i=GlobalConfig.getSceneConfigById(e);SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),i.x,i.y)}}},TimerManager.ins().doTimer(1e3,0,this.crossTimer,this),this.crossTimer()},e.prototype.setYamaInfo=function(){this.yamaNum.text=GameLogic.ins().getEnitityRoleCount().toString(),this.lingNum.text=BagProxy.ins().getItemCountById(BossProxy.ins().getYamaLingId()).toString();var t=GlobalConfig.getItemsConfig(BossProxy.ins().getYamaLingId());this.lingIcon.source=t?AssetMgr.getIconResource(t.displayid):"",void 0!=this.yamaTimer&&(TimerManager.ins().remove(this.yamaTimer,this),this.yamaTimer=void 0),this.yama_act_data=ActivityProxy.ins().getActivityDataById(ActivityType.Yama),this.yamaTimer=function(){if(void 0!=this.yama_act_data){var t=this.yama_act_data.act_time-GameLogic.ins().getServerTime();if(1==this.yama_act_data.act_status)this.yama_time.textFlow=UtilProxy.generateTextFlow("剩余时间：|C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)));else{var e=GameLogic.ins().getLastScene(),i=GlobalConfig.getSceneConfigById(e);SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),i.x,i.y)}}},TimerManager.ins().doTimer(1e3,0,this.yamaTimer,this),this.yamaTimer()},e.prototype.SetAnchorState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.root.visible=i},e}(BaseEuiView);__reflect(BossSceneView.prototype,"BossSceneView"),ViewManager.ins().reg(BossSceneView,LayerManager.UI_Main),window.BossSceneView=BossSceneView;var BossTrialItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="bossLimitItemSkin",e.selectIcon.visible=!1,e.killFlag.visible=!1,e.curFlag.visible=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this),this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e.prototype.setData=function(){if(this.data){var t=GlobalConfig.getMonsterConfigById(this.data.boss_id),e=GlobalConfig.getCopyConfigById(this.data.id);this.floor.textFlow=UtilProxy.generateTextFlow(e.noColorName),this.bossName.text=t.name,this.icon.source=t.head_res,this.killFlag.visible=CopyProxy.ins().getBossTrialFloor()>=this.data.id,this.server_open_days=LimitActProxy.ins().GetServerOpenDay();this.server_open_days;e.serverday_limit[0]<=this.server_open_days&&e.serverday_limit[1]>=this.server_open_days?0==CopyProxy.ins().getBossTrialFloor()&&0==this.itemIndex?this.curFlag.visible=!0:this.curFlag.visible=CopyProxy.ins().getBossTrialFloor()+1==this.data.id:this.curFlag.visible=!1}},e}(BaseItemRender);__reflect(BossTrialItem.prototype,"BossTrialItem"),window.BossTrialItem=BossTrialItem;var BossTrialView=function(t){function e(){var e=t.call(this)||this;return e.isEndFloor=!1,e.current_floor=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.floorNum=[this.floorNum1,this.floorNum2,this.floorNum3],this.effPlat.removeChildren(),UtilProxy.GetMovieClipById(59,this.effPlat),this.bList.itemRenderer=BossTrialItem,this.bScroller.viewport=this.bList,this.dList.itemRenderer=ItemCell,this.dScroller.viewport=this.dList,this.bList.dataProvider=new eui.ArrayCollection,this.dList.dataProvider=new eui.ArrayCollection,this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.enterClick),this.addItemTapEvent(this.bList,this.SkinBossClick),this.addTouchEvent(this.posBtn0,this.onPosClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.enterClick),this.removeItemTapEvent(this.bList,this.SkinBossClick),this.removeItemTapEvent(this.posBtn0,this.onPosClick)},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData()},e.prototype.enterClick=function(t){if(CopyProxy.ins().isBossTrialScene(GameLogic.ins().getCurSceneId()))return void TipsControl.ins().showTips("已在试炼BOSS副本中！");if(this.server_open_days=LimitActProxy.ins().GetServerOpenDay(),this.lastSkinItem)if(this.lastSkinItem.data.id==this.current_floor){var e=GlobalConfig.getCopyConfigById(this.lastSkinItem.data.id);if(e.open_level>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL))return void TipsControl.ins().showTips(e.open_level+"级可挑战");if(this.server_open_days<e.serverday_limit[0])return void TipsControl.ins().showTips(e.serverday_limit[0]-this.server_open_days+"天后可挑战");e.open_zhuan<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)?CopyProxy.ins().C2SReqCopyEnterCopy(CopyProxy.ins().trial_boss_enter_id):TipsControl.ins().showTips(UtilProxy.getZhuanStr(e.open_zhuan)+"可挑战")}else this.lastSkinItem.data.id<this.current_floor?TipsControl.ins().showTips("已经挑战过"):TipsControl.ins().showTips("请先完成前面的挑战")},e.prototype.SkinBossClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.setData()}t.setData(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){var i=CopyProxy.ins().GetCopycLimbListDataByCopyId(e.id),n="无";void 0!=i&&(n=i.name),this.recordName.text=n;var o=GlobalConfig.getCopyConfigById(e.id),s=GlobalConfig.getDropConfig(o.normal_reward[0]),r=GlobalConfig.getDropItem(s.drop),a=new Array;if(void 0!=r)for(var h=0;h<r.length;h++){var l=r[h],p=new ItemCellData,c={item_slot_idx:0,item_type_id:l[0].id,item_count:l[0].num};p.setItemCellData(c),a.push(p)}this.setFloorRewardFont(e.id-CopyProxy.ins().trial_boss_enter_id+1),this.dList.dataProvider=new eui.ArrayCollection(a);var u=e.path[1];if(void 0!=this.mc&&(this.effG.removeChild(this.mc),this.mc=null),1==u){this.mc=new egret.MovieClip;var d=UtilProxy.getShowImgPath()+e.path[0];UtilProxy.GetMovieClip(d,this.mc,-1,void 0),this.effG.addChild(this.mc),this.mc.x=e.pos[0],this.mc.y=e.pos[1],this.showImg.visible=!1}else 3==u?(this.mc=UtilProxy.GetMovieClipById(Number(e.path[0]),this.effG),this.mc.x=e.pos[0],this.mc.y=e.pos[1],this.showImg.visible=!1):(this.showImg.visible=!0,this.showImg.source="resource/skins/BossView/"+e.path[0]+".png");this.fightValue.textFlow=UtilProxy.generateTextFlow("C:7&"+e.fight+"万")}},e.prototype.onClose=function(){this.close()},e.prototype.setFloorRewardFont=function(t){var e;if(!(t>=100)){10>=t?(e=1,this.floorNum1.source=this.getNumNameByNum(t)):t%10==0||20>t?(e=2,20>t?(this.floorNum1.source=this.getNumNameByNum(10),this.floorNum2.source=this.getNumNameByNum(t%10)):(this.floorNum1.source=this.getNumNameByNum(t/10),this.floorNum2.source=this.getNumNameByNum(10))):(e=3,this.floorNum1.source=this.getNumNameByNum(Math.floor(t/10)),this.floorNum2.source=this.getNumNameByNum(10),this.floorNum3.source=this.getNumNameByNum(t%10));for(var i=0;i<this.floorNum.length;++i)this.floorNum[i].visible=e-1>=i;this.floorImg2.x=this.floorImg1.width+this.floorNum1.width*e;var n=this.floorImg1.width+this.floorNum1.width*e+this.floorImg2.width;this.floorG1.x=(this.floorG.width-n)/2}},e.prototype.getNumNameByNum=function(t){var e=["xianshiboss_yi","xianshiboss_er","xianshiboss_san","xianshiboss_si","xianshiboss_wu","xianshiboss_liu","xianshiboss_qi","xianshiboss_ba","xianshiboss_jiu","xianshiboss_shi"];return e[t-1]||""},e.prototype.setData=function(){var t=GlobalConfig.getTrial_bossConfigs(),e=[];for(var i in t)e.push(t[i]);if(this.bList.dataProvider=new eui.ArrayCollection(e),this.setInfo(),CopyProxy.ins().getTrialBossBigReward()){var n=CopyProxy.ins().getTrialBossBigReward()[0]-CopyProxy.ins().trial_boss_enter_id+1;this.floor.textFlow=UtilProxy.generateTextFlow("第 "+n+" 天"),this.showItem.data=UtilProxy.GetItemCellData(CopyProxy.ins().getTrialBossBigReward()[1][0],CopyProxy.ins().getTrialBossBigReward()[1][1])}else this.showItem.visible=!1,this.floor.text=""},e.prototype.setInfo=function(){var t=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().trial_boss_enter_id),e=new Copy_dataConfig;if(void 0==t)e=GlobalConfig.getCopyConfigById(CopyProxy.ins().trial_boss_enter_id),this.current_floor=CopyProxy.ins().trial_boss_enter_id;else if(void 0!=t.climb_info){void 0!=t.climb_info.limit_record;var i=CopyProxy.ins().trial_boss_enter_id;t.climb_info.last_floor>0?(this.current_floor=t.climb_info.last_floor+1,i=t.climb_info.last_floor):this.current_floor=i,e=GlobalConfig.getCopyConfigById(i+1),void 0==e&&(this.isEndFloor=!0,e=GlobalConfig.getCopyConfigById(i),this.current_floor=i)}else CommonUtils.log("copy_data.climb_info == null,enter_id--->",CopyProxy.ins().trial_boss_enter_id);var n=function(){for(var t=0;t<this.bList.numChildren;++t){var e=this.bList.getChildAt(t);if(e){var i=e.data;i&&i.id&&i.id==this.current_floor&&(this.lastSkinItem=void 0,this.selectSkinItem(e),this.bList.selectedIndex=t,this.bScroller.width<95*t&&(this.bScroller.viewport.contentWidth-this.bScroller.width<95*t?this.bScroller.viewport.scrollH=this.bScroller.viewport.contentWidth-this.bScroller.width:this.bScroller.viewport.scrollH=95*t),TimerManager.ins().remove(n,this))}}};TimerManager.ins().doTimer(100,0,n,this)},e.prototype.onPosClick=function(t){var e=Number(this.pos_x.text),i=Number(this.pos_y.text);this.mc&&(this.mc.x=e,this.mc.y=i)},e}(BaseEuiView);__reflect(BossTrialView.prototype,"BossTrialView"),window.BossTrialView=BossTrialView;var BossUIView_KuaFu=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.listD.itemRenderer=ItemCell,this.scrollerD.viewport=this.listD,this.listB.itemRenderer=BossKuaFuItem,this.scrollerB.viewport=this.listB,this.listC.itemRenderer=BossRecordItem,this.scrollerC.viewport=this.listC,this.listB.dataProvider=new eui.ArrayCollection,this.listC.dataProvider=new eui.ArrayCollection,this.listD.dataProvider=new eui.ArrayCollection,this.info0.textFlow=UtilProxy.generateTextFlow("生命值提升到 |C:7&1000%"),this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.Add,this.onClick),this.addTouchEvent(this.enterBtn,this.onClick),this.addTouchEvent(this.desBtn,this.onClick),this.addTouchEvent(this.record,this.onClick),this.addTouchEvent(this.rCloseBtn,this.onClick),EventProxy.AddListener(this,EventType.S2CReqBossBuyChallengeNum,this.S2CReqBossBuyChallengeNum),EventProxy.AddListener(this,EventType.S2CReqBossShenwenBuyChallengeNum,this.S2CReqBossBuyChallengeNum),EventProxy.AddListener(this,EventType.S2CReqBossDataUpdate,this.S2CReqBossDataUpdate),EventProxy.AddListener(this,EventType.S2CRepBossNextAppear,this.S2CRepBossNextAppear),EventProxy.AddListener(this,EventType.S2CRepBossKillRecord,this.S2CRepBossKillRecord),this.initData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.Add,this.onClick),this.removeTouchEvent(this.enterBtn,this.onClick),this.removeTouchEvent(this.desBtn,this.onClick),this.removeTouchEvent(this.record,this.onClick),this.removeTouchEvent(this.rCloseBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CReqBossBuyChallengeNum,this.S2CReqBossBuyChallengeNum),EventProxy.RemoveListener(this,EventType.S2CReqBossShenwenBuyChallengeNum,this.S2CReqBossBuyChallengeNum),EventProxy.RemoveListener(this,EventType.S2CReqBossDataUpdate,this.S2CReqBossDataUpdate),EventProxy.RemoveListener(this,EventType.S2CRepBossNextAppear,this.S2CRepBossNextAppear),EventProxy.RemoveListener(this,EventType.S2CRepBossKillRecord,this.S2CRepBossKillRecord),this.clearData(),TimerManager.ins().removeAll(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.Add:var e=GlobalConfig.getBoss_miscConfigById(1);this.boss_type==BOSSTYPE.SHENWEN?e.cross_shenwen_num>BossProxy.ins().shenwen_challenge_num?e.buy_cross_shenwen_need[0]>RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)?TipsControl.ins().showTips("元宝不足！"):e.cross_shenwen_buy_limit>BossProxy.ins().buy_shenwen_times?TipsControl.ins().ShowTips1("是否花费"+UtilProxy.ins().getMoneyAttrName(MoneyAttr.YUANBAO)+" "+e.buy_cross_shenwen_need[0]+" 购买 挑战次数?",function(){},function(){BossProxy.ins().C2SReqBossShenwenBuyChallengeNum()}):TipsControl.ins().showTips("已达购买上限！"):TipsControl.ins().showTips("已达次数上限!"):e.cross_num>BossProxy.ins().cross_challenge_num?e.buy_cross_need[0]>RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)?TipsControl.ins().showTips("元宝不足！"):e.buy_limit>BossProxy.ins().buy_challenge_times?TipsControl.ins().ShowTips1("是否花费"+UtilProxy.ins().getMoneyAttrName(MoneyAttr.YUANBAO)+" "+e.buy_cross_need[0]+" 购买 挑战次数?",function(){},function(){BossProxy.ins().C2SReqBossBuyChallengeNum()}):TipsControl.ins().showTips("已达购买上限！"):TipsControl.ins().showTips("已达次数上限!");break;case this.enterBtn:var i=this.boss_type==BOSSTYPE.KUAFU?BossProxy.ins().cross_challenge_num:BossProxy.ins().shenwen_challenge_num;if(i>0){if(void 0!=this.lastSkinItem){var n=ActivityProxy.ins().getActivityDataById(ActivityType.KuaFuBoss);if(this.boss_type==BOSSTYPE.SHENWEN&&(n=ActivityProxy.ins().getActivityDataById(ActivityType.ShenwenBoss)),void 0!=n&&1!=n.act_status)return void TipsControl.ins().showTips("活动时间未到！");var o=this.lastSkinItem.data;if(void 0!=o){var s=o.scene,r=BossProxy.ins().IsConditionEnough(o.scene);if(r.isTrue){var a=BossProxy.ins().GetBossNextFreeTime(o.id,o.type);0>=a?BossProxy.ins().isBagLeftEnough()&&BossProxy.ins().enterBossScene(s):TipsControl.ins().showTips("Boss已死亡")}else TipsControl.ins().showTips(r.str)}}}else TipsControl.ins().showTips("挑战次数不足!");break;case this.desBtn:var e=GlobalConfig.getBoss_miscConfigById(1);TipsControl.ins().ShowDes(this.boss_type==BOSSTYPE.KUAFU?e.kfboss_des:e.SWboss_des);break;case this.record:void 0!=this.lastSkinItem&&BossProxy.ins().C2SReqBossKillRecord(this.lastSkinItem.data.id);break;case this.rCloseBtn:this.recordView.visible=!1}},e.prototype.setVisible=function(t){if(this.visible=t,t){this.initData();var e=GlobalConfig.getBoss_miscConfigById(1);this.times.textFlow=UtilProxy.generateTextFlow("挑战次数： "+(this.boss_type==BOSSTYPE.KUAFU?BossProxy.ins().cross_challenge_num:BossProxy.ins().shenwen_challenge_num||0)+"/ "+(this.boss_type==BOSSTYPE.KUAFU?e.cross_num:e.cross_shenwen_num)),this.CheckGuide()}else this.clearData()},e.prototype.S2CReqBossBuyChallengeNum=function(){var t=GlobalConfig.getBoss_miscConfigById(1);this.times.textFlow=UtilProxy.generateTextFlow("挑战次数： "+(this.boss_type==BOSSTYPE.KUAFU?BossProxy.ins().cross_challenge_num:BossProxy.ins().shenwen_challenge_num||0)+"/ "+(this.boss_type==BOSSTYPE.KUAFU?t.cross_num:t.cross_shenwen_num))},e.prototype.S2CReqBossDataUpdate=function(){var t=GlobalConfig.getBoss_miscConfigById(1);this.times.textFlow=UtilProxy.generateTextFlow("挑战次数： "+(this.boss_type==BOSSTYPE.KUAFU?BossProxy.ins().cross_challenge_num:BossProxy.ins().shenwen_challenge_num||0)+"/ "+(this.boss_type==BOSSTYPE.KUAFU?t.cross_num:t.cross_shenwen_num))},e.prototype.S2CRepBossNextAppear=function(t){},e.prototype.S2CRepBossKillRecord=function(t){this.setRecordView()},e.prototype.clearData=function(){this.lastSkinItem=void 0,this.recordView.visible=!1,this.listB.dataProvider=new eui.ArrayCollection,this.listC.dataProvider=new eui.ArrayCollection,this.listD.dataProvider=new eui.ArrayCollection},e.prototype.initData=function(){var t=BossProxy.ins().GetBossConfigByType(BOSSTYPE.KUAFU);this.boss_type==BOSSTYPE.SHENWEN&&(t=BossProxy.ins().GetBossConfigByType(BOSSTYPE.SHENWEN)),this.bg.source=this.boss_type==BOSSTYPE.KUAFU?"kuaifuboss_bg_jpg":"shenwenbs_bg_jpg",this.listB.dataProvider=new eui.ArrayCollection(t),this.listB.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this);var e=function(){for(var t=0;t<this.listB.numChildren;++t){var i=this.listB.getChildAt(t);if(i){var n=i.data;n&&n.id&&(n.id==BossProxy.ins().getInitBossByType(BOSSTYPE.KUAFU).id||n.id==BossProxy.ins().getInitBossByType(BOSSTYPE.SHENWEN).id)&&(this.selectSkinItem(i),this.listB.selectedIndex=t,TimerManager.ins().remove(e,this))}}};TimerManager.ins().doTimer(100,0,e,this),TimerManager.ins().doTimer(1e3,0,this.Update,this),this.record.textFlow=UtilProxy.generateTextFlow("C:7&U&T:归属记录")},e.prototype.Update=function(){var t=ActivityProxy.ins().getActivityDataById(ActivityType.KuaFuBoss);if(this.boss_type==BOSSTYPE.SHENWEN&&(t=ActivityProxy.ins().getActivityDataById(ActivityType.ShenwenBoss)),t){var e=1==t.act_status,i=t.act_time-GameLogic.ins().getServerTime();if(i>=0){var n=e?"活动时间":"开启时间",o=UtilProxy.getTimeHMSString(i);this.time.text=n+":"+o+" "}}},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.setSelect(!1)}t.setSelect(!0),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){var i=GlobalConfig.getMonsterConfigById(e.id);void 0!=i&&(this.boss_name.text=i.name);for(var n=new Array,o=0;o<e.drop_show.length;++o){var s=new ItemCellData,r=e.drop_show[o],a=0,h={item_slot_idx:0,item_type_id:r,item_count:a};s.setItemCellData(h),n.push(s)}this.listD.dataProvider=new eui.ArrayCollection(n)}},e.prototype.setRecordView=function(){this.recordView.visible=!0;var t=GlobalConfig.getMonsterConfigById(BossProxy.ins().boss_id);if(this.recordBossName.text=t.name,void 0!=BossProxy.ins().records&&BossProxy.ins().records.length>0){for(var e=new Array,i=0;i<BossProxy.ins().records.length;++i){var n=BossProxy.ins().records[i],o=new BossKillRecord;o.role_name=n.role_name,o.server_id=n.server_id,o.kill_time=n.time,o.hurtValue=n.hurt,e.push(o)}this.listC.dataProvider=new eui.ArrayCollection(e)}else this.listC.dataProvider=new eui.ArrayCollection},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BossUIView_KuaFu.prototype,"BossUIView_KuaFu"),window.BossUIView_KuaFu=BossUIView_KuaFu;var BossUIView_Limit=function(t){function e(){var e=t.call(this)||this;return e.isEndFloor=!1,e.current_floor=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.floorNum=[this.floorNum1,this.floorNum2,this.floorNum3],this.bList.itemRenderer=BossLimitItem,this.bScroller.viewport=this.bList,this.dList.itemRenderer=ItemCell,this.dScroller.viewport=this.dList,this.bList.dataProvider=new eui.ArrayCollection,this.dList.dataProvider=new eui.ArrayCollection,this.effPlat.removeChildren(),UtilProxy.GetMovieClipById(59,this.effPlat),this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.enterClick),this.addItemTapEvent(this.bList,this.SkinBossClick),this.addTouchEvent(this.posBtn0,this.onPosClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.enterClick),this.removeItemTapEvent(this.bList,this.SkinBossClick),this.removeItemTapEvent(this.posBtn0,this.onPosClick),TimerManager.ins().remove(this.update,this)},e.prototype.setVisible=function(t){this.visible=t,TimerManager.ins().remove(this.update,this),t&&(TimerManager.ins().doTimer(500,0,this.update,this),this.setData())},e.prototype.update=function(){var t=CopyProxy.ins().getBossLimitLeftTime();this.time.textFlow=UtilProxy.generateTextFlow("C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)))},e.prototype.enterClick=function(t){if(CopyProxy.ins().isBossLimitScene(GameLogic.ins().getCurSceneId()))return void TipsControl.ins().showTips("已在限时BOSS副本中！");if(this.lastSkinItem)if(this.lastSkinItem.data.id==this.current_floor){var e=GlobalConfig.getCopyConfigById(this.lastSkinItem.data.id);e.open_zhuan<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)?CopyProxy.ins().C2SReqCopyEnterCopy(CopyProxy.ins().limit_boss_enter_id):TipsControl.ins().showTips(UtilProxy.getZhuanStr(e.open_zhuan)+"可挑战")}else this.lastSkinItem.data.id<this.current_floor?TipsControl.ins().showTips("已经挑战过"):TipsControl.ins().showTips("未能挑战")},e.prototype.setFloorRewardFont=function(t){var e;if(!(t>=100)){10>=t?(e=1,this.floorNum1.source=this.getNumNameByNum(t)):t%10==0||20>t?(e=2,20>t?(this.floorNum1.source=this.getNumNameByNum(10),this.floorNum2.source=this.getNumNameByNum(t%10)):(this.floorNum1.source=this.getNumNameByNum(t/10),this.floorNum2.source=this.getNumNameByNum(10))):(e=3,this.floorNum1.source=this.getNumNameByNum(Math.floor(t/10)),this.floorNum2.source=this.getNumNameByNum(10),this.floorNum3.source=this.getNumNameByNum(t%10));for(var i=0;i<this.floorNum.length;++i)this.floorNum[i].visible=e-1>=i;this.floorImg2.x=this.floorImg1.width+this.floorNum1.width*e;var n=this.floorImg1.width+this.floorNum1.width*e+this.floorImg2.width;this.floorG1.x=(this.floorG.width-n)/2}},e.prototype.getNumNameByNum=function(t){var e=["xianshiboss_yi","xianshiboss_er","xianshiboss_san","xianshiboss_si","xianshiboss_wu","xianshiboss_liu","xianshiboss_qi","xianshiboss_ba","xianshiboss_jiu","xianshiboss_shi"];return e[t-1]||""},e.prototype.setData=function(){var t=GlobalConfig.getLimit_bossConfigs(),e=[];for(var i in t)e.push(t[i]);if(this.bList.dataProvider=new eui.ArrayCollection(e),this.setInfo(),CopyProxy.ins().getBossLimitBigReward()){var n=CopyProxy.ins().getBossLimitBigReward()[0]-CopyProxy.ins().limit_boss_enter_id+1;this.floor.textFlow=UtilProxy.generateTextFlow("第 "+n+" 关"),this.showItem.data=UtilProxy.GetItemCellData(CopyProxy.ins().getBossLimitBigReward()[1][0],CopyProxy.ins().getBossLimitBigReward()[1][1])}else this.showItem.visible=!1,this.floor.text=""},e.prototype.setInfo=function(){var t=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().limit_boss_enter_id),e="无",i=0,n=new Copy_dataConfig;if(void 0==t)n=GlobalConfig.getCopyConfigById(CopyProxy.ins().limit_boss_enter_id),this.current_floor=CopyProxy.ins().limit_boss_enter_id;else if(void 0!=t.best_record&&RoleProxy.ins().getRoleName()!=t.best_record.name?(e=t.best_record.name,i=t.best_record.time-CopyProxy.ins().limit_boss_enter_id+1):(e="",i=0),void 0!=t.climb_info){void 0!=t.climb_info.limit_record;var o=CopyProxy.ins().limit_boss_enter_id;t.climb_info.last_floor>0?(this.current_floor=t.climb_info.last_floor+1,o=t.climb_info.last_floor):this.current_floor=o,n=GlobalConfig.getCopyConfigById(o+1),void 0==n&&(this.isEndFloor=!0,n=GlobalConfig.getCopyConfigById(o),this.current_floor=o)}else CommonUtils.log("copy_data.climb_info == null,enter_id--->",CopyProxy.ins().limit_boss_enter_id);this.recordName.text=e;var s=function(){for(var t=0;t<this.bList.numChildren;++t){var e=this.bList.getChildAt(t);if(e){var i=e.data;i&&i.id&&i.id==this.current_floor&&(this.lastSkinItem=void 0,this.selectSkinItem(e),this.bList.selectedIndex=t,this.bScroller.width<95*t&&(this.bScroller.viewport.contentWidth-this.bScroller.width<95*t?this.bScroller.viewport.scrollH=this.bScroller.viewport.contentWidth-this.bScroller.width:this.bScroller.viewport.scrollH=95*t),TimerManager.ins().remove(s,this))}}};TimerManager.ins().doTimer(100,0,s,this)},e.prototype.SkinBossClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.setData()}t.setData(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){var i=GlobalConfig.getCopyConfigById(e.id),n=GlobalConfig.getDropConfig(i.normal_reward[0]),o=GlobalConfig.getDropItem(n.drop),s=new Array;if(void 0!=o)for(var r=0;r<o.length;r++){var a=o[r],h=new ItemCellData,l={item_slot_idx:0,item_type_id:a[0].id,item_count:a[0].num};h.setItemCellData(l),s.push(h)}this.setFloorRewardFont(e.id-CopyProxy.ins().limit_boss_enter_id+1),this.dList.dataProvider=new eui.ArrayCollection(s);var p=e.path[1];if(void 0!=this.mc&&(this.effG.removeChild(this.mc),this.mc=null),1==p){this.mc=new egret.MovieClip;var c=UtilProxy.getShowImgPath()+e.path[0];UtilProxy.GetMovieClip(c,this.mc,-1,void 0),this.effG.addChild(this.mc),this.mc.x=e.pos[0],this.mc.y=e.pos[1],this.showImg.visible=!1}else 3==p?(this.mc=UtilProxy.GetMovieClipById(Number(e.path[0]),this.effG),this.mc.x=e.pos[0],this.mc.y=e.pos[1],this.showImg.visible=!1):(this.showImg.visible=!0,this.showImg.source="resource/skins/BossView/"+e.path[0]+".png");this.fightValue.textFlow=UtilProxy.generateTextFlow("C:7&"+e.fight)}},e.prototype.onPosClick=function(t){var e=Number(this.pos_x.text),i=Number(this.pos_y.text);this.mc&&(this.mc.x=e,this.mc.y=i)},e}(BaseEuiView);__reflect(BossUIView_Limit.prototype,"BossUIView_Limit"),window.BossUIView_Limit=BossUIView_Limit;var BossUIView_MJ=function(t){function e(){var e=t.call(this)||this;return e.current_floor=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.listH.itemRenderer=BossIcon,this.scrollerH.viewport=this.listH,this.dList.itemRenderer=ItemCell,this.dScroller.viewport=this.dList,this.dList.dataProvider=new eui.ArrayCollection,this.floorBtn5.visible=!1,this.barLabel.text="",this.time.text="",this.setVisible(!1),this.floorBtnList=[this.floorBtn1,this.floorBtn2,this.floorBtn3,this.floorBtn4,this.floorBtn5]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.onEnterClick),this.addTouchEvent(this.linkBtn,this.onLinkClick);for(var i=0;i<this.floorBtnList.length;++i)this.floorBtnList[i].label="第"+(i+1)+"层",this.addTouchEvent(this.floorBtnList[i],this.onFloorClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.onEnterClick),this.removeTouchEvent(this.linkBtn,this.onLinkClick);for(var i=0;i<this.floorBtnList.length;++i)this.removeTouchEvent(this.floorBtnList[i],this.onFloorClick);this.clearData()},e.prototype.onLinkClick=function(t){ViewManager.ins().OpenViewById(63)},e.prototype.onFloorClick=function(t){for(var e=this.floorBtnList.lastIndexOf(t.currentTarget),i=0;i<this.floorBtnList.length;++i)this.floorBtnList[i].icon="common_bg_anniudi";t.currentTarget.icon="common_bg_anniudi_on",this.SetCurrentFloor(e)},e.prototype.SetCurrentFloor=function(t){if(t!=this.current_floor){for(var e=BossProxy.ins().GetBossConfigByType(BOSSTYPE.MIJING),i=new Array,n=0;n<e.length;++n)e[n].boss_floor==t+1&&i.push(e[n]);if(this.listH.dataProvider=new eui.ArrayCollection(i),i.length>0){this.listH.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this);var o=function(){for(var e=0;e<this.listH.numChildren;++e){var i=this.listH.getChildAt(e);if(i){var n=i.data;n&&n.id&&n.id==BossProxy.ins().getInitBossByTypeAndFloor(BOSSTYPE.MIJING,t+1).id&&(this.lastSkinItem=void 0,this.selectSkinItem(i),this.listH.selectedIndex=e,TimerManager.ins().remove(o,this))}}};TimerManager.ins().doTimer(100,0,o,this),this.current_floor=t}}},e.prototype.onEnterClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data;if(void 0!=e){var i=e.scene,n=GlobalConfig.getSceneConfigById(i);if(void 0!=n){var o=BossProxy.ins().IsConditionEnough(e.scene);if(o.isTrue){var s=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);0>=s?BossProxy.ins().isBagLeftEnough()&&BossProxy.ins().enterBossScene(i):TipsControl.ins().showTips("Boss未复活")}else TipsControl.ins().showTips(o.str)}}}},e.prototype.setVisible=function(t){this.visible=t,t?(this.InitSys(),this.CheckGuide()):this.clearData()},e.prototype.clearData=function(){void 0!=this.funcTimer&&(TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0),this.current_floor=-1;for(var t=0;t<this.listH.numChildren;++t){var e=this.listH.getChildAt(t);e&&e.depose()}this.dList.dataProvider=new eui.ArrayCollection,this.listH.dataProvider=new eui.ArrayCollection},e.prototype.InitSys=function(){for(var t=0;t<this.floorBtnList.length;++t)this.floorBtnList[t].icon="common_bg_anniudi";var e=BossProxy.ins().getInitBossByType(BOSSTYPE.MIJING);this.floorBtnList[e.boss_floor-1].icon="common_bg_anniudi_on",this.SetCurrentFloor(e.boss_floor-1)},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){void 0!=this.funcTimer&&(TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0);var i=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);i>0?(this.funcTimer=function(){var t=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);if(t>0){var i=UtilProxy.getTimeHMSString(t);this.time.text="复活时间 "+i+" "}else TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0},TimerManager.ins().doTimer(400,0,this.funcTimer,this)):this.time.textFlow=UtilProxy.generateTextFlow("C:7&BOSS 已复活");for(var n=new Array,o=0;o<e.drop_show.length;++o){var s=new ItemCellData,r=e.drop_show[o],a=0,h={item_slot_idx:0,item_type_id:r,item_count:a};s.setItemCellData(h),n.push(s)}this.dList.dataProvider=new eui.ArrayCollection(n);var l=BossProxy.ins().getConditionDataById(e.scene),p=GlobalConfig.getSceneConditionConfig(e.scene);if(void 0!=l.enter_cond||void 0!=l.vip_level){var c=0,u=l.enter_cond,d=u[MoneyAttr.VIP_LEVEL];c=void 0!=d?d.limit:l.vip_level;var g=(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),p.replace_item_cond);this.info1.textFlow=UtilProxy.generateTextFlow("VIP"+c+"免费进入或花费"+(g[1]||0)+"元宝进入;"),this.info2.textFlow=UtilProxy.generateTextFlow("")}else this.info1.textFlow=UtilProxy.generateTextFlow(""),this.info2.textFlow=UtilProxy.generateTextFlow("")}},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BossUIView_MJ.prototype,"BossUIView_MJ"),window.BossUIView_MJ=BossUIView_MJ;var BossUIView_Muti=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.listH.itemRenderer=BossIcon,this.scrollerH.viewport=this.listH,this.dList.itemRenderer=ItemCell,this.dScroller.viewport=this.dList,this.barLabel.text="",this.time.text="",this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.onEnterClick),this.addTouchEvent(this.linkBtn,this.onLinkClick),EventProxy.AddListener(this,EventType.S2CReqBossDataUpdate,this.S2CReqBossDataUpdate)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.onEnterClick),this.removeTouchEvent(this.linkBtn,this.onLinkClick),EventProxy.RemoveListener(this,EventType.S2CReqBossDataUpdate,this.S2CReqBossDataUpdate),this.clearData()},e.prototype.S2CReqBossDataUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetStrength()},e.prototype.onLinkClick=function(t){ViewManager.ins().OpenViewById(63)},e.prototype.onEnterClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data;if(void 0!=e){var i=e.scene,n=GlobalConfig.getSceneConfigById(i);if(void 0!=n){var o=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);
if(0>=o)if(e.strength<=BossProxy.ins().strength){var s=BossProxy.ins().IsConditionEnough(e.scene);if(s.isTrue){var r=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);0>=r?BossProxy.ins().isBagLeftEnough()&&BossProxy.ins().enterBossScene(i):TipsControl.ins().showTips("Boss未复活")}else TipsControl.ins().showTips(s.str)}else TipsControl.ins().showTips("体力不足");else TipsControl.ins().showTips("Boss未复活")}}}},e.prototype.setVisible=function(t){this.visible=t,t?(this.InitSys(),this.CheckGuide()):this.clearData()},e.prototype.clearData=function(){void 0!=this.funcTimer&&(TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0);for(var t=0;t<this.listH.numChildren;++t){var e=this.listH.getChildAt(t);e&&e.depose()}this.removeItemTapEvent(this.listH,this.SkinItemClick),this.listH.dataProvider=new eui.ArrayCollection},e.prototype.InitSys=function(){var t=BossProxy.ins().GetBossConfigByType(2);this.listH.dataProvider=new eui.ArrayCollection(t),this.addItemTapEvent(this.listH,this.SkinItemClick);var e=function(){for(var t=!1,i=!1,n=0;n<this.listH.numChildren;++n){var o=this.listH.getChildAt(n);if(o){t=!0;var s=o.data;s&&s.id&&s.id==BossProxy.ins().getInitBossByType(BOSSTYPE.WORLD).id&&(this.selectSkinItem(o),this.listH.selectedIndex=n,TimerManager.ins().remove(e,this),i=!0)}}t&&!i&&(this.scrollerH.viewport.scrollV=this.scrollerH.viewport.height+61+4)};TimerManager.ins().doTimer(100,0,e,this),this.SetStrength()},e.prototype.SetStrength=function(){var t=BossProxy.ins().strength,e=BossProxy.ins().strength_max;this.strength.textFlow=UtilProxy.generateTextFlow("剩余体力： "+t+"/"+e)},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){var i=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);i>0?(this.funcTimer=function(){var t=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);if(t>0){var i=UtilProxy.getTimeHMSString(t);this.time.text="复活时间 "+i+" "}else TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0},TimerManager.ins().doTimer(400,0,this.funcTimer,this)):(void 0!=this.funcTimer&&(TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0),this.time.textFlow=UtilProxy.generateTextFlow("C:7&BOSS 已复活"));for(var n=new Array,o=0;o<e.drop_show.length;++o){var s=new ItemCellData,r=e.drop_show[o],a=0,h={item_slot_idx:0,item_type_id:r,item_count:a};s.setItemCellData(h),n.push(s)}this.dList.dataProvider=new eui.ArrayCollection(n)}},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BossUIView_Muti.prototype,"BossUIView_Muti"),window.BossUIView_Muti=BossUIView_Muti;var BossUIView_Mutis=function(t){function e(){var e=t.call(this)||this;return e.isAuto=!1,e}return __extends(e,t),e.prototype.initUI=function(){this.listH.itemRenderer=BossMutisItem,this.scrollerH.viewport=this.listH,this.listH.dataProvider=new eui.ArrayCollection,this.autoBtn.visible=!UtilProxy.shield,this.autoInfo.visible=!UtilProxy.shield,this.listBtn.visible=!UtilProxy.shield,this.bg_source=["BOSS_bg_mijing","BOSS_bg_shenyuan","BOSS_bg_yewai","BOSS_bg_yiyu"],this.autoInfo.textFlow=UtilProxy.generateTextFlow("C:7&自动挑战|C:5&(激活铂金特权可使用)"),this.listBtn.textFlow=UtilProxy.generateTextFlow("C:10&U&T:挑战列表"),this.strength_info.textFlow=UtilProxy.generateTextFlow("C:7&(每2分钟回复体力1点)"),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.addBtn,this.onAddClick),this.addTouchEvent(this.autoBtn,this.onAutoClick),this.addTouchEvent(this.listBtn,this.onListClick),this.addTouchEvent(this.buyClosebtn,this.onBuyCloseClick),this.addTouchEvent(this.closebtn,this.onUseCloseClick),this.addTouchEvent(this.buyAdd,this.onBuyNumClick),this.addTouchEvent(this.buyLess,this.onBuyNumClick),this.addTouchEvent(this.useBtn,this.onUseClick),this.addTouchEvent(this.buyBtn,this.onBuyClick),this.addTouchEvent(this.viplink,this.onLinkClick),EventProxy.AddListener(this,EventType.S2CReqBossDataUpdate,this.S2CReqBossDataUpdate),EventProxy.AddListener(this,EventType.S2CRepBossKillRecord,this.S2CRepBossKillRecord),EventProxy.AddListener(this,EventType.S2CReqBossBuyTimes,this.S2CReqBossBuyTimes),EventProxy.AddListener(this,EventType.RefreshBossItemJuan,this.RefreshBossItemJuan)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.addBtn,this.onAddClick),this.removeTouchEvent(this.autoBtn,this.onAutoClick),this.removeTouchEvent(this.listBtn,this.onListClick),this.removeTouchEvent(this.buyClosebtn,this.onBuyCloseClick),this.removeTouchEvent(this.closebtn,this.onUseCloseClick),this.removeTouchEvent(this.buyAdd,this.onBuyNumClick),this.removeTouchEvent(this.buyLess,this.onBuyNumClick),this.removeTouchEvent(this.useBtn,this.onUseClick),this.removeTouchEvent(this.buyBtn,this.onBuyClick),this.removeTouchEvent(this.viplink,this.onLinkClick),EventProxy.RemoveListener(this,EventType.S2CReqBossDataUpdate,this.S2CReqBossDataUpdate),EventProxy.RemoveListener(this,EventType.S2CRepBossKillRecord,this.S2CRepBossKillRecord),EventProxy.RemoveListener(this,EventType.S2CReqBossBuyTimes,this.S2CReqBossBuyTimes),EventProxy.RemoveListener(this,EventType.RefreshBossItemJuan,this.RefreshBossItemJuan),this.clearData()},e.prototype.S2CReqBossDataUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetStrength(),this.UseView.visible&&(this.UseView.visible=!1),this.buyTimesView.visible&&(this.buyTimesView.visible=!1)},e.prototype.S2CRepBossKillRecord=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],n=0;n<this.listH.numChildren;++n){var o=this.listH.getChildAt(n);if(o){var s=o.data;s&&s.id==i&&o.refreshData()}}},e.prototype.S2CReqBossBuyTimes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.buyTimesView.visible=!1,this.SetStrength()},e.prototype.RefreshBossItemJuan=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetStrength()},e.prototype.onAddClick=function(t){var e=BossProxy.ins().getChangeDataByType(this.boss_type),i=GlobalConfig.getBoss_times_dataConfigById(this.boss_type),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);if(this.viplink.textFlow=UtilProxy.generateTextFlow("C:7&U&T:提升VIP等级可增加购买次数"),e&&i)if(BagProxy.ins().getItemCountById(i.item_id[0])>0){this.UseView.visible=!0;var o="";o=this.boss_type==BOSSTYPE.MIJING?"秘境":this.boss_type==BOSSTYPE.SHENYUAN?"深渊":"异域",this.useInfo.textFlow=UtilProxy.generateTextFlow("消耗一张"+BagProxy.ins().getItemName(i.item_id[0])+",增加一次"+o+"BOSS挑战次数"),this.cell.data=UtilProxy.GetItemCellData(i.item_id[0],1)}else{this.buy_num=1;var s=GlobalConfig.getBoss_times_dataConfigById(this.boss_type).vip_buy_limit[n],r=e?s-e.buy_times:s;r>0?(this.buyTimesView.visible=!0,this.buyNum.text=this.buy_num+"/"+r,this.buyInfo.textFlow=UtilProxy.generateTextFlow("今日剩余购买 "+r+" 次数"),this.buyPrice.text=(this.buy_num*i.money[1]).toString()):TipsControl.ins().showTips("今日次数已用完！")}},e.prototype.onLinkClick=function(t){ViewManager.ins().open(VIPView)},e.prototype.onAutoClick=function(t){var e=this.gou.visible;e?(this.gou.visible=!e,BossProxy.ins().isAutoChallenge=!e):PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN)>0?(this.gou.visible=!e,BossProxy.ins().isAutoChallenge=!e,BossProxy.ins().isAutoChallenge&&ViewManager.ins().open(BossAutoListView,this.boss_type)):TipsControl.ins().ShowTips1("您未激活铂金卡，不能自动挑战，是否前往激活",null,function(){ViewManager.ins().open(PrivilegeView,1)})},e.prototype.onListClick=function(t){ViewManager.ins().open(BossAutoListView,this.boss_type)},e.prototype.onUseClick=function(t){var e=BossProxy.ins().getChangeDataByType(this.boss_type),i=GlobalConfig.getBoss_times_dataConfigById(this.boss_type);e&&i&&UtilProxy.ins().UseKnapsackByItemID(i.item_id[0])},e.prototype.onBuyClick=function(t){var e=BossProxy.ins().getChangeDataByType(this.boss_type),i=GlobalConfig.getBoss_times_dataConfigById(this.boss_type);e&&i&&(RoleProxy.ins().getMoneyAttr(i.money[0])>=i.money[1]*this.buy_num?BossProxy.ins().C2SReqBossBuyTimes(this.boss_type,this.buy_num):TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(i.money[0])+"不足！"))},e.prototype.setVisible=function(t){this.visible=t,t?this.setDataInfo():this.clearData()},e.prototype.setDataInfo=function(){if(this.boss_type){for(var t=BossProxy.ins().GetBossConfigByType(this.boss_type),e=[],i=[],n=0,o=0;o<t.length;++o){var s=BossProxy.ins().getConditionDataById(t[o].scene);RoleProxy.ins().getMoneyAttr(s.enter_conf[0][0])>=s.enter_conf[0][1]?e.push(t[o]):i.push(t[o]);for(var r in s.enter_conf)s.enter_conf[r][0]==MoneyAttr.VIP_LEVEL&&(n=s.enter_conf[r][1])}e.sort(this.sortByType1),i.sort(this.sortByType2);var a=e.concat(i);this.listH.dataProvider=new eui.ArrayCollection(a),this.SetStrength(),this.setBgImg(),this.boss_type==BOSSTYPE.WORLD?this.strength_info.textFlow=UtilProxy.generateTextFlow("C:7&(每2分钟回复体力1点)"):this.boss_type==BOSSTYPE.EXOTIC||this.boss_type==BOSSTYPE.SHENYUAN?this.strength_info.textFlow=UtilProxy.generateTextFlow("C:7&(需达到VIP"+n+"才能挑战)"):this.strength_info.text="",this.gou.visible=BossProxy.ins().isAutoChallenge}},e.prototype.sortByType1=function(t,e){var i=BossProxy.ins().getConditionDataById(t.scene),n=BossProxy.ins().getConditionDataById(e.scene);return i&&n?i.enter_conf[0][1]>n.enter_conf[0][1]?-1:i.enter_conf[0][1]<n.enter_conf[0][1]?1:0:void 0},e.prototype.sortByType2=function(t,e){var i=BossProxy.ins().getConditionDataById(t.scene),n=BossProxy.ins().getConditionDataById(e.scene);return i&&n?i.enter_conf[0][1]<n.enter_conf[0][1]?-1:i.enter_conf[0][1]>n.enter_conf[0][1]?1:0:void 0},e.prototype.setBgImg=function(){var t=["BOSS_bg_yewai","BOSS_bg_mijing","BOSS_bg_shenyuan","BOSS_bg_yiyu"],e="resource/skins/BossView/",i=".jpg";this.boss_type==BOSSTYPE.WORLD?this.bg.source=e+t[0]+i:this.boss_type==BOSSTYPE.MIJING?this.bg.source=e+t[1]+i:this.boss_type==BOSSTYPE.SHENYUAN?this.bg.source=e+t[2]+i:this.boss_type==BOSSTYPE.EXOTIC&&(this.bg.source=e+t[3]+i)},e.prototype.SetStrength=function(){if(this.boss_type==BOSSTYPE.WORLD){var t=BossProxy.ins().strength,e=BossProxy.ins().strength_max;this.strength.textFlow=UtilProxy.generateTextFlow("剩余体力： "+t+"/"+e),this.timesG.visible=!1}else{var i=BossProxy.ins().getChangeDataByType(this.boss_type),n=GlobalConfig.getBoss_times_dataConfigById(this.boss_type);if(!i||!n)return;var o=i.left_times,s=i.buy_times+n.times;this.strength.textFlow=UtilProxy.generateTextFlow("挑战次数： "+o+"/"+s),this.timesG.visible=!0;var r=n.item_id[0],a=BagProxy.ins().getItemData(r);this.itemImg.source=AssetMgr.getIconResource(a.displayid),this.num.text=BagProxy.ins().getItemCountById(r).toString()}},e.prototype.clearData=function(){this.buyTimesView.visible=!1,this.UseView.visible=!1},e.prototype.onBuyCloseClick=function(t){this.buyTimesView.visible=!1},e.prototype.onUseCloseClick=function(t){this.UseView.visible=!1},e.prototype.onBuyNumClick=function(t){var e=GlobalConfig.getBoss_times_dataConfigById(this.boss_type).limit,i=this.buy_num,n=BossProxy.ins().getChangeDataByType(this.boss_type),o=n?e-n.buy_times:e;switch(t.currentTarget){case this.buyAdd:i+1>o?TipsControl.ins().showTips("已达上限！"):i+=1;break;case this.buyLess:i=Math.max(1,i-1)}this.buy_num=i,this.buyNum.text=this.buy_num+"/"+o;var s=GlobalConfig.getBoss_times_dataConfigById(this.boss_type);this.buyPrice.text=(this.buy_num*s.money[1]).toString()},e}(BaseEuiView);__reflect(BossUIView_Mutis.prototype,"BossUIView_Mutis"),window.BossUIView_Mutis=BossUIView_Mutis;var Main=function(t){function e(){var e=t.call(this)||this;return e.theme_loaded=!1,egret.ImageLoader.crossOrigin="anonymous",SdkManager.ins().init(SdkType.HUOSDK),LocationProperty.consoleWrite("时间打印：添加到main"),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),(void 0==e._loadingUI||null==e._loadingUI)&&(e._loadingUI=new LoadingUI,StageUtils.ins().getStage().addChild(e._loadingUI));var i="玩命加载中";e._loadingUI.setVisible(!0),e._loadingUI.onProgress(0,10,i),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),DeviceUtils.IsPC&&(StageUtils.ins().getStage().orientation=egret.OrientationMode.AUTO),LocationProperty.init(),egret.lifecycle.onPause=function(){console.log("app 进入后台")},egret.lifecycle.onResume=function(){console.log("app 进入前台"),e.onShow();var t=LocalStorageProxy.ins().getItem("mtlbgOn"),i=t?"1"==t:!0;console.log("app setBgOn bgState = ",i),SoundManager.ins().setBgOn(i)},ResVersionManager.ins().loadConfig(this.loadResVersionComplate,this),console.log(egret.Capabilities.renderMode)},e.prototype.loadResVersionComplate=function(){ResourceUtils.ins().addConfig("resource/default.res.json","resource/"),ResourceUtils.ins().loadConfig(this.onConfigComplete,this),e._loadingUI.onProgress(0,100,"正在加载主题皮肤...")},e.prototype.onConfigComplete=function(){var t=new eui.Theme("default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),LocationProperty.consoleWrite("加载主题文件开始"),e._loadingUI.onProgress(20,100,"正在加载主题皮肤..."),e._loadingUI.starMovie(),this.loadTheProcess()},e.prototype.onThemeLoadComplete=function(){RES.setMaxLoadingThread(15),RES.setMaxRetryTimes(10);var t=["loading1"];ResourceUtils.ins().loadGroups("pre1",t,this.onFirstResComplete,this.onFirstResProgress,this),LocationProperty.consoleWrite("加载主题文件结束"),e._loadingUI.onProgress(70,100,"正在加载主题皮肤..."),this.theme_loaded=!0},e.prototype.onFirstResComplete=function(){new GameApp;e._loadingUI.setVisible(!1),e._loadingUI.onProgress(0,100,"")},e.prototype.onFirstResProgress=function(t,i){e._loadingUI.onProgress(70+10*t,100,"正在加载主题皮肤...")},e.prototype.loadTheProcess=function(){var t=this;return e._loadingUI.onProgress(30,100,"正在加载主题皮肤..."),new Promise(function(i,n){var o=0,s=25,r=function(){if(!this.theme_loaded&&s>o){var t=Math.floor(o/s*50);e._loadingUI.onProgress(20+t,100,"正在加载主题皮肤..."),o+=1}else TimerManager.ins().remove(r,this),i()};TimerManager.ins().doTimerDelay(0,200,0,r,t)})},e.closesocket=function(){GameSocket.ins().close()},e.onShow=function(){return RoleProxy.ins().islogin?DeviceUtils.IsIos?(ViewManager.ins().isShow(ConnetTipsView)&&ViewManager.ins().close(ConnetTipsView),TipsControl.ins().showTips("正在自动连接..."),void GameSocket.ins().reLogin2()):(CommonUtils.log("切到前台，判断socket是否链接:",GameSocket.ins().isConnected()),GameSocket.ins().isConnected()?(SdkManager.ins().zhifu_back=!1,void CommonUtils.log("socket没断，不需要重连")):(CommonUtils.log("提示：小游戏切换到了前台，重新连接!"),ViewManager.ins().isShow(ConnetTipsView)&&ViewManager.ins().close(ConnetTipsView),TipsControl.ins().showTips("正在自动连接..."),void GameSocket.ins().reLogin2())):void CommonUtils.log("还没登陆过，不需要重连")},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var BossUIView_sy=function(t){function e(){var e=t.call(this)||this;return e.current_floor=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.listH.itemRenderer=BossIcon,this.scrollerH.viewport=this.listH,this.dList.itemRenderer=ItemCell,this.dScroller.viewport=this.dList,this.dList.dataProvider=new eui.ArrayCollection,this.barLabel.text="",this.time.text="",this.setVisible(!1),this.floorBtnList=[this.floorBtn1,this.floorBtn2,this.floorBtn3,this.floorBtn4,this.floorBtn5]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.onEnterClick),this.addTouchEvent(this.linkBtn,this.onLinkClick);for(var i=0;i<this.floorBtnList.length;++i)this.floorBtnList[i].label="第"+(i+1)+"层",this.addTouchEvent(this.floorBtnList[i],this.onFloorClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.onEnterClick),this.removeTouchEvent(this.linkBtn,this.onLinkClick);for(var i=0;i<this.floorBtnList.length;++i)this.removeTouchEvent(this.floorBtnList[i],this.onFloorClick);this.clearData()},e.prototype.onLinkClick=function(t){ViewManager.ins().OpenViewById(63)},e.prototype.onFloorClick=function(t){for(var e=this.floorBtnList.lastIndexOf(t.currentTarget),i=0;i<this.floorBtnList.length;++i)this.floorBtnList[i].icon="common_bg_anniudi";t.currentTarget.icon="common_bg_anniudi_on",this.SetCurrentFloor(e)},e.prototype.SetCurrentFloor=function(t){if(t!=this.current_floor){for(var e=BossProxy.ins().GetBossConfigByType(BOSSTYPE.SHENYUAN),i=new Array,n=0;n<e.length;++n)e[n].boss_floor==t+1&&i.push(e[n]);this.listH.dataProvider=new eui.ArrayCollection(i),this.listH.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this);var o=function(){for(var e=0;e<this.listH.numChildren;++e){var i=this.listH.getChildAt(e);if(i){var n=i.data;n&&n.id&&n.id==BossProxy.ins().getInitBossByTypeAndFloor(BOSSTYPE.SHENYUAN,t+1).id&&(this.selectSkinItem(i),this.listH.selectedIndex=e,TimerManager.ins().remove(o,this))}}};TimerManager.ins().doTimer(100,0,o,this),this.current_floor=t}},e.prototype.onEnterClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data;if(void 0!=e){var i=e.scene,n=GlobalConfig.getSceneConfigById(i);if(void 0!=n){var o=BossProxy.ins().IsConditionEnough(e.scene);if(o.isTrue){var s=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);0>=s?BossProxy.ins().isBagLeftEnough()&&BossProxy.ins().enterBossScene(i):TipsControl.ins().showTips("Boss未复活")}else TipsControl.ins().showTips(o.str)}}}},e.prototype.setVisible=function(t){this.visible=t,t?(this.InitSys(),this.CheckGuide()):this.clearData()},e.prototype.clearData=function(){void 0!=this.funcTimer&&(TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0),this.current_floor=-1},e.prototype.InitSys=function(){for(var t=0;t<this.floorBtnList.length;++t)this.floorBtnList[t].icon="common_bg_anniudi";var e=BossProxy.ins().getInitBossByType(BOSSTYPE.SHENYUAN);this.floorBtnList[e.boss_floor-1].icon="common_bg_anniudi_on",this.SetCurrentFloor(e.boss_floor-1)},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){var i=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);i>0?(this.funcTimer=function(){var t=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);if(t>0){var i=UtilProxy.getTimeHMSString(t);this.time.text="复活时间 "+i+" "}else TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0},TimerManager.ins().doTimer(400,0,this.funcTimer,this)):(void 0!=this.funcTimer&&(TimerManager.ins().remove(this.funcTimer,this),this.funcTimer=void 0),this.time.textFlow=UtilProxy.generateTextFlow("C:7&BOSS 已复活"));for(var n=new Array,o=0;o<e.drop_show.length;++o){var s=new ItemCellData,r=e.drop_show[o],a=0,h={item_slot_idx:0,item_type_id:r,item_count:a};s.setItemCellData(h),n.push(s)}this.dList.dataProvider=new eui.ArrayCollection(n);var l=BossProxy.ins().getConditionDataById(e.scene);if(void 0!=l.enter_cond||void 0!=l.vip_level){var p=0,c=l.enter_cond,u=c[MoneyAttr.VIP_LEVEL];p=void 0!=u?u.limit:l.vip_level;RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);this.info1.textFlow=UtilProxy.generateTextFlow("VIP"+p+"可免费进入"),this.info2.textFlow=UtilProxy.generateTextFlow("")}else this.info1.textFlow=UtilProxy.generateTextFlow(""),this.info2.textFlow=UtilProxy.generateTextFlow("")}},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(BossUIView_sy.prototype,"BossUIView_sy"),window.BossUIView_sy=BossUIView_sy;var BossUIView_YLSD=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.visible=!1,this.listD.itemRenderer=ItemCell,this.scrollerD.viewport=this.listD,this.listD.dataProvider=new eui.ArrayCollection;var t=GlobalConfig.getBoss_miscConfigById(1);this.des.text=t.ylsd_des,this.record_list=[this.record0,this.record1,this.record2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enterBtn,this.OnClick),this.addTouchEvent(this.Add,this.OnClick),EventProxy.AddListener(this,EventType.RefreshYamaId,this.RefreshYamaId),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enterBtn,this.OnClick),this.removeTouchEvent(this.Add,this.OnClick),EventProxy.RemoveListener(this,EventType.RefreshYamaId,this.RefreshYamaId),TimerManager.ins().removeAll(this)},e.prototype.OnClick=function(t){switch(t.currentTarget){case this.enterBtn:if(void 0!=this.act_data)if(1==this.act_data.act_status){if(BossProxy.ins().isBagLeftEnough()){var e=GlobalConfig.getBoss_miscConfigById(1),i=GlobalConfig.getSceneConfigById(e.ylsd_scene_id);SceneControl.ins().C2STransferScene(i.id,i.x,i.y)}}else TipsControl.ins().showTips("未开启！");break;case this.Add:var n=GlobalConfig.getBoss_miscConfigById(1),o=n.ylsd_token_id,s=GlobalConfig.getItemsConfig(o),r=s.buyprice[0],a=s.buyprice[1];a<=RoleProxy.ins().getMoneyAttr(r)?TipsControl.ins().ShowTips1("是否花费"+UtilProxy.ins().getMoneyAttrName(r)+" "+a+" 购买 "+s.name+"?",function(){},function(){StoreProxy.ins().C2SReqMiscAutoBuyItem(s.id,1)}):TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(r)+"不足！")}},e.prototype.setVisible=function(t){this.visible=t,t?this.setInfo():this.clearData()},e.prototype.clearData=function(){},e.prototype.RefreshYamaId=function(t){this.num.text=BagProxy.ins().getItemCountById(BossProxy.ins().getYamaLingId()).toString()},e.prototype.setData=function(){var t=GlobalConfig.getBoss_miscConfigById(1),e=LimitActProxy.ins().GetServerOpenDay(),i=t.ylsd_big_drop_id[Math.max(e%t.ylsd_big_drop_id.length-1,0)],n=UtilProxy.GetItemCellData(i,1);this.bigReward.data=n;for(var o=new Array,s=0;s<t.ylsd_show_item.length;++s){var r=new ItemCellData,a=t.ylsd_show_item[s],h=0,l={item_slot_idx:0,item_type_id:a,item_count:h};r.setItemCellData(l),o.push(r)}this.listD.dataProvider=new eui.ArrayCollection(o);var p=GlobalConfig.getItemsConfig(BossProxy.ins().getYamaLingId());this.lingIcon.source=p?AssetMgr.getIconResource(p.displayid):""},e.prototype.setInfo=function(){var t=GlobalConfig.getBoss_miscConfigById(1),e=t.ylsd_token_id;if(this.num.text=BagProxy.ins().getItemCountById(e).toString(),this.act_data=ActivityProxy.ins().getActivityDataById(ActivityType.Yama),TimerManager.ins().remove(this.TimeUp,this),TimerManager.ins().doTimer(1e3,0,this.TimeUp,this),void 0==BossProxy.ins().ylsd_big_award||0==BossProxy.ins().ylsd_big_award.length)for(var i=0;i<this.record_list.length;++i)this.record_list[i].text="";else for(var i=0;i<this.record_list.length;++i)this.record_list[i].text=BossProxy.ins().ylsd_big_award[i]?BossProxy.ins().ylsd_big_award[i].name:"";this.TimeUp()},e.prototype.TimeUp=function(){if(void 0!=this.act_data){var t=this.act_data.act_time-GameLogic.ins().getServerTime();1==this.act_data.act_status?this.time.textFlow=UtilProxy.generateTextFlow("阎罗神殿关闭倒计时: |C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0))):0==this.act_data.act_status&&(this.time.textFlow=UtilProxy.generateTextFlow("阎罗神殿开启倒计时: |C:4&"+UtilProxy.getTimeHMSString(Math.max(t,0))))}},e}(BaseEuiView);__reflect(BossUIView_YLSD.prototype,"BossUIView_YLSD"),window.BossUIView_YLSD=BossUIView_YLSD;var BossUIView=function(t){function e(){var e=t.call(this)||this;return e.current_page=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossViewSkin",this.comview.initUI(),this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3,this.sbtn4,this.sbtn5,this.sbtn6,this.sbtn7],this.singleView.initUI(),this.kuaFuView.initUI(),this.yamaView.initUI(),this.mutisView.initUI(),this.setRed()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.singleView.open(),this.kuaFuView.open(),this.yamaView.open(),this.mutisView.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.RefreshBossRed,this.RefreshBossRed);for(var i=0;i<this.sbtnList.length;++i)this.addTouchEvent(this.sbtnList[i],this.onSysClick);if(void 0!=t&&void 0!=t[0]){var n=t[0];this.setCurrentView(n),this.scroll.width<100*(n+1)&&(this.scroll.viewport.scrollH=this.scroll.viewport.width-this.scroll.width)}else SystemOpenProxy.ins().isOpen(2,801)?this.setCurrentView(1):this.setCurrentView(0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.singleView.close(),this.kuaFuView.close(),this.yamaView.close(),this.mutisView.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.RefreshBossRed,this.RefreshBossRed);for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onSysClick);this.current_page=-1},e.prototype.onSysClick=function(t){var e=this.sbtnList.indexOf(t.currentTarget);if(e>0){var i=2,n=800+e;SystemOpenProxy.ins().isOpen(i,n)&&this.setCurrentView(e)}else this.setCurrentView(e)},e.prototype.setCurrentView=function(t){if(this.current_page!=t){this.sbtnList[this.current_page]&&this.sbtnList[this.current_page].setSelect(!1),void 0!=this.current_view&&this.current_view.setVisible(!1);var e;switch(t){case 0:this.comview.SetName(UtilProxy.getTitleName("个人BOSS")),e=this.singleView;break;case 1:this.comview.SetName(UtilProxy.getTitleName("野外BOSS")),this.mutisView.boss_type=BOSSTYPE.WORLD,e=this.mutisView;break;case 2:this.comview.SetName(UtilProxy.getTitleName("秘境BOSS")),this.mutisView.boss_type=BOSSTYPE.MIJING,e=this.mutisView;break;case 3:this.comview.SetName(UtilProxy.getTitleName("深渊BOSS")),this.mutisView.boss_type=BOSSTYPE.SHENYUAN,e=this.mutisView;break;case 4:this.comview.SetName(UtilProxy.getTitleName("异域BOSS")),this.mutisView.boss_type=BOSSTYPE.EXOTIC,e=this.mutisView;break;case 5:this.comview.SetName(UtilProxy.getTitleName("跨服BOSS")),this.kuaFuView.boss_type=BOSSTYPE.KUAFU,e=this.kuaFuView;break;case 6:this.comview.SetName(UtilProxy.getTitleName("阎罗神殿")),e=this.yamaView;break;case 7:this.comview.SetName("title_shenwenBOSS"),this.kuaFuView.boss_type=BOSSTYPE.SHENWEN,e=this.kuaFuView}this.current_view=e,this.sbtnList[t]&&this.sbtnList[t].setSelect(!0),void 0!=this.current_view&&this.current_view.setVisible(!0),this.current_page=t}},e.prototype.RefreshBossRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRed()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setRed=function(){this.sbtn0.setRed(BossProxy.ins().getRedByType(BOSSTYPE.SINGLE)),this.sbtn1.setRed(BossProxy.ins().getRedByType(BOSSTYPE.WORLD)),this.sbtn2.setRed(BossProxy.ins().getRedByType(BOSSTYPE.MIJING)),this.sbtn3.setRed(BossProxy.ins().getRedByType(BOSSTYPE.SHENYUAN)),this.sbtn4.setRed(BossProxy.ins().getRedByType(BOSSTYPE.EXOTIC)),this.sbtn5.setRed(BossProxy.ins().getRedByType(BOSSTYPE.KUAFU)),this.sbtn6.setRed(BossProxy.ins().getRedByType(BOSSTYPE.YAMA)),this.sbtn7.setRed(BossProxy.ins().getRedByType(BOSSTYPE.SHENWEN))},e}(BaseEuiView);__reflect(BossUIView.prototype,"BossUIView"),ViewManager.ins().reg(BossUIView,LayerManager.UI_Main),window.BossUIView=BossUIView;var BossYamaItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossYamaItemSkin",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onClick=function(t){var e=this.data;if(void 0!=e){var i=BossProxy.ins().getBossPosById(e.id,BOSSTYPE.YAMA);if(void 0==i)return void CommonUtils.log("not find monster in scene_monster,monster_id",e.id);var n=GameMap.ins().getPath({x:64*i.x/100,y:64*i.y/100},GameMap.centerEntity);if(n&&n.length>0){var o=GameLogic.ins().getEnitityByBossId(e.id);o&&(GameMap.centerEntity.AI.setTarget(o.handle),GameMap.centerEntity.startMove(n,GameMap.centerEntity.AI.getActionStr(1),GameMap.centerEntity.AI.getActionSpeed(1)))}}},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=GlobalConfig.getMonsterConfigById(t.id);BossProxy.ins().GetBossAppear(t.id,BOSSTYPE.YAMA);this.bossName.text=e.name;var i=GameLogic.ins().getEnitityByBossId(t.id);void 0==i?(this.state.visible=!0,this.btn.visible=!1,this.time.text="",this.bar.visible=!1):(this.state.visible=!1,this.btn.visible=!0,this.time.text="",this.bar.visible=!0,this.bar.setValue(i.getHP(),i.getHPMax()))}},e}(BaseItemRender);__reflect(BossYamaItem.prototype,"BossYamaItem"),window.BossYamaItem=BossYamaItem;var BossYamaList=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossListSkin",this.listM.itemRenderer=BossYamaItem,this.scrollerM.viewport=this.listM},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onClick),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onClick)},e.prototype.onClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){var t=BossProxy.ins().GetBossConfigByType(BOSSTYPE.YAMA);this.listM.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(BossYamaList.prototype,"BossYamaList"),ViewManager.ins().reg(BossYamaList,LayerManager.UI_Main2),window.BossYamaList=BossYamaList;var BossYamaRol=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="YamaRollSkin",this.list.itemRenderer=RumorItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.click),this.addTouchEvent(this.rollIcon,this.click),EventProxy.AddListener(this,EventType.S2CReqBossYlsdRandom,this.S2CReqBossYlsdRandom);var i=GlobalConfig.getBoss_miscConfigById(1),n=LimitActProxy.ins().GetServerOpenDay(),o=i.ylsd_big_drop_id[Math.max(n%i.ylsd_big_drop_id.length-1,0)],s=UtilProxy.GetItemCellData(o,1);this.itemName.textFlow=UtilProxy.generateTextFlow(BagProxy.ins().getItemColorName(o)),this.itemCell.data=s,this.S2CReqBossYlsdRandom()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.click),this.removeTouchEvent(this.rollIcon,this.click),EventProxy.AddListener(this,EventType.S2CReqBossYlsdRandom,this.S2CReqBossYlsdRandom)},e.prototype.click=function(t){switch(t.currentTarget){case this.closebtn:ViewManager.ins().close(this);break;case this.rollIcon:BossProxy.ins().C2SReqBossYlsdRandom()}},e.prototype.S2CReqBossYlsdRandom=function(){for(var t=[],e=0,i="",n=0;n<BossProxy.ins().yama_Random_list.length;++n){var o=(BossProxy.ins().yama_Random_list[n].role_id,BossProxy.ins().yama_Random_list[n].num),s=BossProxy.ins().yama_Random_list[n].name;t.push({name:s,rol_num:o}),o>e&&(e=o,i=s)}this.info0.textFlow=UtilProxy.generateTextFlow("C:10& "+i+" |C:7&"+e+"| 点"),this.list.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(BossYamaRol.prototype,"BossYamaRol"),ViewManager.ins().reg(BossYamaRol,LayerManager.UI_Main2),window.BossYamaRol=BossYamaRol;var BossActItem1=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossActItem1Skin",e.init(),e.list.itemRenderer=ItemCell,e.scroller.viewport=e.list,e.list.dataProvider=new eui.ArrayCollection,e
}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(void 0!=e){this.rankpic.visible=e.index<=3,this.rankpic.visible&&(this.rankpic.source="top_icon_0"+e.index),this.rank.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[e.index>3?e.index:""]),this.tips.visible=0==e.role_id,0==e.role_id?(this.lab1.text="",this.info.text=""):(this.lab1.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[e.name]),this.info.textFlow=UtilProxy.StrFormart("|C:10&@0 层|",[e.value-CopyProxy.ins().simple_climb_enter_id+1])),this.vipLvl.text=e.vip.toString();var i=GlobalConfig.getActivity_dataConfig(1037),n=LimitActProxy.ins().getRankRacAwardInfo(e.index,i),o=GlobalConfig.getDropConfig(n[2]),s=GlobalConfig.getDropItem(o.drop),r=new Array;if(void 0!=s)for(var a=0;a<s.length;a++){var h=s[a],l=new ItemCellData,p={item_slot_idx:0,item_type_id:h[0].id,item_count:h[0].num};l.setItemCellData(p),r.push(l)}this.list.dataProvider=new eui.ArrayCollection(r)}},e.prototype.refreshData=function(){},e.prototype.onClick=function(t){if(void 0!=this.data&&void 0!=this.data.id){var e=this.data.config;1==this.data.state?e.view.length>0&&(e.view[1]?ViewManager.ins().OpenViewById(e.view[0],e.view[1]):ViewManager.ins().OpenViewById(e.view[0])):2==this.data.state&&BossActProxy.ins().C2SReqLimitActTimeActGetAward(e.id,e.act_id)}},e}(BaseItemRender);__reflect(BossActItem1.prototype,"BossActItem1"),window.BossActItem1=BossActItem1;var BossActItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossActItemSkin",e.init(),e.finish.visible=!1,e.info.text="",e.list.itemRenderer=ItemCell,e.scroller.viewport=e.list,e.list.dataProvider=new eui.ArrayCollection,e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),void 0!=this.data&&void 0!=this.data.id){this.btn.visible=0!=this.data.state,this.finish.visible=0==this.data.state,this.btn.icon=2==this.data.state?"common_btn_big_yellow":"common_btn_big_blue",this.btn.label=2==this.data.state?"领 取":"前 往";var e=this.data.config;if(e.limit_num){var i=BossActProxy.ins().getActTimes(e.id,this.data.id);this.info0.textFlow=UtilProxy.StrFormart("剩余:|C:@0 &@1 ",[5,Math.max(e.limit_num-i,0)])}else this.info0.text="";var n=[],o=4==e.id?e.params[0]-CopyProxy.ins().simple_climb_enter_id+1:e.params[0];this.info.textFlow=UtilProxy.StrFormart(e.dec,[7,o]);for(var s=0;s<e.award.length;++s)n.push(UtilProxy.GetItemCellData(e.award[s][0],e.award[s][1]));this.list.dataProvider=new eui.ArrayCollection(n)}},e.prototype.refreshData=function(){},e.prototype.onClick=function(t){if(void 0!=this.data&&void 0!=this.data.id){var e=this.data.config;1==this.data.state?e.view.length>0&&(e.view[1]?ViewManager.ins().OpenViewById(e.view[0],e.view[1]):ViewManager.ins().OpenViewById(e.view[0])):2==this.data.state&&BossActProxy.ins().C2SReqLimitActTimeActGetAward(e.id,e.act_id)}},e}(BaseItemRender);__reflect(BossActItem.prototype,"BossActItem"),window.BossActItem=BossActItem;var BossActRankView=function(t){function e(){var e=t.call(this)||this;return e.end_day=0,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="BossActTips1Skin",this.list.itemRenderer=BossActItem1,this.scroller.viewport=this.list,this.list0.itemRenderer=ItemCell,this.scroller0.viewport=this.list0,this.list.dataProvider=new eui.ArrayCollection,this.list0.dataProvider=new eui.ArrayCollection,this.link.textFlow=UtilProxy.generateTextFlow("C:7&U&T:前往挑战")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.link,this.onLinkClick),this.addTouchEvent(this.rCloseBtn,this.onCloseClick),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.link,this.onLinkClick),this.addTouchEvent(this.rCloseBtn,this.onCloseClick),TimerManager.ins().remove(this.Update,this)},e.prototype.onLinkClick=function(t){ViewManager.ins().open(FubenView,1)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){for(var t=BossActProxy.ins().getBossActDataByType(BossActType.sytower_rank),e=LimitActProxy.ins().GetServerOpenDay(),i=0;i<t.length;++i)if(t[i].start<=e&&t[i].end>=e){this.end_day=t[i].end;break}var n=GlobalConfig.getActivity_dataConfig(1037),o=LimitActProxy.ins().getRankRacAwardInfo(1,n),s=GlobalConfig.getDropConfig(o[2]),r=GlobalConfig.getDropItem(s.drop),a=new Array;if(this.des_info.textFlow=UtilProxy.StrFormart("@0 层以上可以上榜",[n.act_params[1]-CopyProxy.ins().simple_climb_enter_id+1]),void 0!=r)for(var i=0;i<r.length;i++){var h=r[i],l=new ItemCellData,p={item_slot_idx:0,item_type_id:h[0].id,item_count:h[0].num};l.setItemCellData(p),a.push(l)}this.list0.dataProvider=new eui.ArrayCollection(a);var c=RankProxy.ins().getRankTopByType(13);if(c){var u=SetProxy.ins().getHeadDefaultOpenId(),d=SetProxy.ins().getHeadFrameDefaultOpenId(),g=GlobalConfig.getSetup_head_dataConfig(c.use_head_id||u);this.top_head.source=g?g.icon:"common_touxiang_0"+c.prof;var y=GlobalConfig.getSetup_head_frame_dataConfig(c.use_head_frame_id||d);this.head_bg.source=y?y.icon:"common_Box_01",this.info.textFlow=UtilProxy.StrFormart("|C:10&@0 层|",[c.value-CopyProxy.ins().simple_climb_enter_id+1]),this.info0.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[c.name])}else this.info.text="",this.info0.text="";var f=(n.act_award[n.act_award.length-1][1],RankProxy.ins().getRanklistByType(13));this.list.dataProvider=new eui.ArrayCollection(f.slice(0,9)),TimerManager.ins().doTimer(1e3,0,this.Update,this),this.Update()},e.prototype.Update=function(){var t=BossActProxy.ins().getBossActLeftTime(this.end_day);this.time.textFlow=UtilProxy.generateTextFlow("C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)))},e}(BaseEuiView);__reflect(BossActRankView.prototype,"BossActRankView"),ViewManager.ins().reg(BossActRankView,LayerManager.UI_Main),window.BossActRankView=BossActRankView;var BossActView_HappyBoss=function(t){function e(){var e=t.call(this)||this;return e.end_day=0,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=BossActItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActGetInfo,this.S2CRepLimitActTimeActGetInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActUpdate,this.S2CRepLimitActTimeActUpdate),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActGetAward,this.S2CRepLimitActTimeActGetAward),EventProxy.AddListener(this,EventType.S2CRepMiscGetSaveInfo,this.S2CRepMiscGetSaveInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActGetInfo,this.S2CRepLimitActTimeActGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActUpdate,this.S2CRepLimitActTimeActUpdate),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActGetAward,this.S2CRepLimitActTimeActGetAward),EventProxy.RemoveListener(this,EventType.S2CRepMiscGetSaveInfo,this.S2CRepMiscGetSaveInfo)},e.prototype.S2CRepLimitActTimeActGetInfo=function(t){this.visible&&this.setData()},e.prototype.S2CRepLimitActTimeActUpdate=function(t){this.visible&&this.setData()},e.prototype.S2CRepLimitActTimeActGetAward=function(t){this.visible&&this.setData()},e.prototype.S2CRepMiscGetSaveInfo=function(t){this.visible&&this.setData(!0)},e.prototype.setVisible=function(t){this.visible=t,t&&(this.bg.source="resource/skins/BossActView/qmkh_banner_0"+(this.cur_type||1)+".jpg",this.setData(!0))},e.prototype.setData=function(t){void 0===t&&(t=!1);for(var e=BossActProxy.ins().getBossActDataByType(this.cur_type),i=[],n=LimitActProxy.ins().GetServerOpenDay(),o=0,s=0;s<e.length;++s)if(e[s].start<=n&&e[s].end>=n){this.end_day=e[s].end;var r=BossActProxy.ins().getCountByActId(this.cur_type,e[s].id);r>o&&(o=r),i.push(e[s])}i.sort(BossActProxy.ins().sort),this.list.dataProvider=new eui.ArrayCollection(i),1==this.cur_type?this.info.textFlow=UtilProxy.generateTextFlow("当前关卡：|C:7&"+o+"|关"):2==this.cur_type?this.info.textFlow=UtilProxy.generateTextFlow("当前次数：|C:7&"+o+"|次"):3==this.cur_type&&(this.info.textFlow=UtilProxy.generateTextFlow("当前等级：|C:7&"+o+"|级")),t&&(TimerManager.ins().remove(this.Update,this),TimerManager.ins().doTimer(1e3,0,this.Update,this),this.Update())},e.prototype.Update=function(){var t=BossActProxy.ins().getBossActLeftTime(this.end_day);this.time.textFlow=UtilProxy.generateTextFlow("C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)))},e}(BaseEuiView);__reflect(BossActView_HappyBoss.prototype,"BossActView_HappyBoss"),window.BossActView_HappyBoss=BossActView_HappyBoss;var BossActView_SYTRank=function(t){function e(){var e=t.call(this)||this;return e.end_day=0,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=BossActItem,this.scroller.viewport=this.list,this.list0.itemRenderer=ItemCell,this.scroller0.viewport=this.list0,this.list.dataProvider=new eui.ArrayCollection,this.list0.dataProvider=new eui.ArrayCollection,this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rank_btn,this.onRankClick),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActGetInfo,this.S2CRepLimitActTimeActGetInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActUpdate,this.S2CRepLimitActTimeActUpdate),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActGetAward,this.S2CRepLimitActTimeActGetAward),EventProxy.AddListener(this,EventType.S2CRepMiscGetSaveInfo,this.S2CRepMiscGetSaveInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rank_btn,this.onRankClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActGetInfo,this.S2CRepLimitActTimeActGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActUpdate,this.S2CRepLimitActTimeActUpdate),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActGetAward,this.S2CRepLimitActTimeActGetAward),EventProxy.RemoveListener(this,EventType.S2CRepMiscGetSaveInfo,this.S2CRepMiscGetSaveInfo)},e.prototype.onRankClick=function(t){ViewManager.ins().open(BossActRankView)},e.prototype.S2CRepLimitActTimeActGetInfo=function(t){this.setData()},e.prototype.S2CRepLimitActTimeActUpdate=function(t){this.setData()},e.prototype.S2CRepLimitActTimeActGetAward=function(t){this.setData()},e.prototype.S2CRepMiscGetSaveInfo=function(t){this.setData(!0)},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData(!0)},e.prototype.setData=function(t){void 0===t&&(t=!1);for(var e=BossActProxy.ins().getBossActDataByType(BossActType.sytower_rank),i=[],n=LimitActProxy.ins().GetServerOpenDay(),o=0,s=0;s<e.length;++s)if(e[s].start<=n&&e[s].end>=n){this.end_day=e[s].end;var r=BossActProxy.ins().getCountByActId(this.cur_type,e[s].id);r>o&&(o=r),i.push(e[s])}i.sort(BossActProxy.ins().sort),this.list.dataProvider=new eui.ArrayCollection(i);var a=GlobalConfig.getActivity_dataConfig(1037),h=LimitActProxy.ins().getRankRacAwardInfo(1,a),l=GlobalConfig.getDropConfig(h[2]),p=GlobalConfig.getDropItem(l.drop),c=new Array;if(void 0!=p)for(var s=0;s<p.length;s++){var u=p[s],d=new ItemCellData,g={item_slot_idx:0,item_type_id:u[0].id,item_count:u[0].num};d.setItemCellData(g),c.push(d)}this.list0.dataProvider=new eui.ArrayCollection(c);var y=RankProxy.ins().getRankTopByType(13);if(y){var f=SetProxy.ins().getHeadDefaultOpenId(),_=SetProxy.ins().getHeadFrameDefaultOpenId(),v=GlobalConfig.getSetup_head_dataConfig(y.use_head_id||f);this.top_head.source=v?v.icon:"common_touxiang_0"+y.prof;var m=GlobalConfig.getSetup_head_frame_dataConfig(y.use_head_frame_id||_);this.head_bg.source=m?m.icon:"common_Box_01",this.info.textFlow=UtilProxy.StrFormart("|C:10&@0 层|",[y.value-CopyProxy.ins().simple_climb_enter_id+1]),this.info0.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[y.name])}else this.info.text="",this.info0.text="";var C=RankProxy.ins().getMyRankByType(13);this.my_info.textFlow=UtilProxy.StrFormart("|我的排名：|C:@0 &@1 |",[5,C>0?C:"未上榜"]),this.my_info0.textFlow=UtilProxy.StrFormart("|我的进度：|C:@0 &@1 |",[5,RankProxy.ins().getMyFightByType(13)+"层"]),t&&(TimerManager.ins().remove(this.Update,this),TimerManager.ins().doTimer(1e3,0,this.Update,this),this.Update())},e.prototype.Update=function(){var t=BossActProxy.ins().getBossActLeftTime(this.end_day);this.time.textFlow=UtilProxy.generateTextFlow("C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)))},e}(BaseEuiView);__reflect(BossActView_SYTRank.prototype,"BossActView_SYTRank"),window.BossActView_SYTRank=BossActView_SYTRank;var BossActView=function(t){function e(){var e=t.call(this)||this;return e.current_page=-1,e.index_arr=[BossActType.sytower_rank,BossActType.limit_time_guan,BossActType.boss_happy_time,BossActType.level_reward],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossActViewSkin",this.comview.initUI(),this.sbtnList=[this.sbtn0,this.sbtn5,this.sbtn4,this.sbtn1,this.sbtn2,this.sbtn3],this.limitView.initUI(),this.happyView.initUI(),this.sytRankView.initUI(),this.trialView.initUI(),this.setRed()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.limitView.open(t),this.happyView.open(t),this.sytRankView.open(t),this.trialView.open(t),this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActUpdate,this.S2CRepLimitActTimeActUpdate),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActGetAward,this.S2CRepLimitActTimeActGetAward);for(var i=0;i<this.sbtnList.length;++i)this.addTouchEvent(this.sbtnList[i],this.onSysClick),i>1&&(this.sbtnList[i].visible=BossActProxy.ins().getActActiveByType(this.index_arr[i-2]),this.sbtnList[i].includeInLayout=BossActProxy.ins().getActActiveByType(this.index_arr[i-2]));if(t&&t[0]){var n=t[0];this.setCurrentView(n),this.scroll.width<100*(n+1)&&(this.scroll.viewport.scrollH=this.scroll.viewport.width-this.scroll.width)}else this.setCurrentView(0);this.setRed()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.limitView.close(),this.happyView.close(t),this.sytRankView.close(t),this.trialView.close(t),this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActUpdate,this.S2CRepLimitActTimeActUpdate),EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActGetAward,this.S2CRepLimitActTimeActGetAward);for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onSysClick);this.current_page=-1},e.prototype.S2CRepLimitActTimeActUpdate=function(t){this.setRed()},e.prototype.S2CRepLimitActTimeActGetAward=function(t){this.setRed()},e.prototype.onSysClick=function(t){var e=this.sbtnList.indexOf(t.currentTarget);if(e>0){if(e>1&&!BossActProxy.ins().getActActiveByType(this.index_arr[e-2]))return void TipsControl.ins().showTips("当前该活动没有开启！");this.setCurrentView(e)}else this.setCurrentView(e)},e.prototype.setCurrentView=function(t){if(this.current_page!=t){this.sbtnList[this.current_page]&&this.sbtnList[this.current_page].setSelect(!1),void 0!=this.current_view&&this.current_view.setVisible(!1);var e;switch(t){case 0:this.comview.SetName(UtilProxy.getTitleName("限时BOSS")),e=this.limitView;break;case 1:this.comview.SetName(UtilProxy.getTitleName("BOSS试炼")),e=this.trialView;break;case 2:this.comview.SetName(UtilProxy.getTitleName("锁妖天榜")),e=this.sytRankView,BossActProxy.ins().C2SReqLimitActTimeActGetInfo();break;case 3:this.comview.SetName(UtilProxy.getTitleName("限时闯关")),e=this.happyView,this.happyView.cur_type=1;break;case 4:this.comview.SetName(UtilProxy.getTitleName("BOSS狂欢")),e=this.happyView,this.happyView.cur_type=2;break;case 5:this.comview.SetName(UtilProxy.getTitleName("全民冲级")),e=this.happyView,this.happyView.cur_type=3}this.current_view=e,this.sbtnList[t]&&this.sbtnList[t].setSelect(!0),void 0!=this.current_view&&this.current_view.setVisible(!0),this.current_page=t}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setRed=function(){this.sbtn0.setRed(!0),this.sbtn1.setRed(BossActProxy.ins().getRedByType(BossActType.limit_time_guan)),this.sbtn2.setRed(BossActProxy.ins().getRedByType(BossActType.boss_happy_time)),this.sbtn3.setRed(BossActProxy.ins().getRedByType(BossActType.level_reward)),this.sbtn4.setRed(BossActProxy.ins().getRedByType(BossActType.sytower_rank))},e}(BaseEuiView);__reflect(BossActView.prototype,"BossActView"),ViewManager.ins().reg(BossActView,LayerManager.UI_Main),window.BossActView=BossActView;var BossStoreItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossStoreItemSkin",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;if(void 0!=e){var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),o=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),s=RoleProxy.ins().getMoneyAttr(e.type);if(o<e.vip_level)return void TipsControl.ins().showTips("VIP等级不足！");if(e.buy_params.length>0){if(e.buy_params[1]>i)return void TipsControl.ins().showTips("等级不足！");if(e.buy_params[2]>n)return void TipsControl.ins().showTips("转不足！")}if(s<e.price)return void TipsControl.ins().ShowPathTips(e.type);if(e.need_items.length>0)for(var r=0;r<e.need_items.length;++r)if(BagProxy.ins().getItemCountById(e.need_items[r][0])<e.need_items[r][1])return void TipsControl.ins().ShowPathTips(e.need_items[r][0]);var a=StoreProxy.ins().getLimitCount(Math.floor(e.id/1e3),e.id);return e.max_buy>0&&a>=e.max_buy?void TipsControl.ins().showTips("兑换次数不足！"):void EventProxy.Broast(EventType.ShowBossStoreBuyTips,[e])}},e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.item_id,item_count:t.item_count};e.setItemCellData(i),this.cell.data=e;var n=BagProxy.ins().getItemData(t.item_id);this.item_name.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[n.quality-1],n.name]),this.btn.label=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑 换":"购 买";var o=BagProxy.ins().getItemData(t.type);if(this.icon0.source=AssetMgr.getIconResource(o.displayid),this.value0.textFlow=UtilProxy.generateTextFlow(""+UtilProxy.getSimpleNum(t.price)),t.need_items.length>0){this.moneyG2.visible=!0,this.discount.source=t.mark;var s=BagProxy.ins().getItemData(t.need_items[0][0]);this.icon1.source=AssetMgr.getIconResource(s.displayid),this.value1.textFlow=UtilProxy.generateTextFlow("C:11&|"+UtilProxy.getSimpleNum(t.need_items[0][1]))}else this.moneyG2.visible=!1;this.refresh()}},e.prototype.refresh=function(){var t=this.data;if(t.max_buy>0){var e=StoreProxy.ins().getLimitCount(Math.floor(t.id/1e3),t.id);e>=t.max_buy?(this.num.textFlow=UtilProxy.generateTextFlow("限购|C:4&(0/"+t.max_buy+")"),this.btn.setRed(!1)):(this.num.textFlow=UtilProxy.generateTextFlow("限购|C:7&("+(t.max_buy-e)+"/"+t.max_buy+")"),this.btn.setRed(StoreProxy.ins().isEnoughStoreItem(t.id)))}else this.btn.setRed(StoreProxy.ins().isEnoughStoreItem(t.id)),this.num.text=""},e}(BaseItemRender);__reflect(BossStoreItem.prototype,"BossStoreItem"),window.BossStoreItem=BossStoreItem;var BossStoreView=function(t){function e(){var e=t.call(this)||this;return e.currentStoreIndex=-1,e.add_index=3,e.buy_num=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossStoreViewSkin",this.comview.initUI(),this.list1.itemRenderer=BossStoreItem,this.scroller1.viewport=this.list1,this.list1.dataProvider=new eui.ArrayCollection,this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2],this.icon_list=[this.icon0,this.icon1,this.icon2],this.value_list=[this.value0,this.value1,this.value2],this.name_list=[this.name0,this.name1,this.name2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.comview.SetName(UtilProxy.getTitleName("BOSS宝库")),GlobalConfig.getConfig("store","storeConfig");for(var i=0,n=0;n<this.sbtnList.length;++n)this.addTouchEvent(this.sbtnList[n],this.onMenuClick),this.sbtnList[n].visible=!1,this.sbtnList[n].includeInLayout=!1;for(var o in GlobalConfig.ins().storeConfig)"2"==GlobalConfig.ins().storeConfig[o].pagetype&&(this.sbtnList[i].visible=!0,this.sbtnList[i].includeInLayout=!0,this.sbtnList[i].label=GlobalConfig.ins().storeConfig[o]._name,i++);this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.enterBtn,this.onBuyClick),this.addTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.addTouchEvent(this.tipsAdd,this.onTipsNumClick),this.addTouchEvent(this.tipsAddten,this.onTipsNumClick),this.addTouchEvent(this.tipsLess,this.onTipsNumClick),this.addTouchEvent(this.tipsLessten,this.onTipsNumClick),EventProxy.AddListener(this,EventType.ShowBossStoreBuyTips,this.ShowBossStoreBuyTips),EventProxy.AddListener(this,EventType.UpdataMoney,this.setRefreshData),EventProxy.AddListener(this,EventType.S2CRepStoreBuy,this.S2CRepStoreBuy),EventProxy.AddListener(this,EventType.S2CRepStoreRefresh,this.S2CRepStoreRefresh),EventProxy.AddListener(this,EventType.S2CRepStoreLimitUpdate,this.S2CRepStoreLimitUpdate),EventProxy.AddListener(this,EventType.RefreshStoreRed,this.getRed),this.initItemId=t[1],this.setCurrentStore(t[0]?t[0]+1:1),this.getRed()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onMenuClick);this.initItemId=void 0,this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.enterBtn,this.onBuyClick),this.removeTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.removeTouchEvent(this.tipsAdd,this.onTipsNumClick),this.removeTouchEvent(this.tipsAddten,this.onTipsNumClick),this.removeTouchEvent(this.tipsLess,this.onTipsNumClick),this.removeTouchEvent(this.tipsLessten,this.onTipsNumClick),EventProxy.RemoveListener(this,EventType.ShowBossStoreBuyTips,this.ShowBossStoreBuyTips),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.setRefreshData),EventProxy.RemoveListener(this,EventType.S2CRepStoreBuy,this.S2CRepStoreBuy),EventProxy.RemoveListener(this,EventType.S2CRepStoreRefresh,this.S2CRepStoreRefresh),EventProxy.RemoveListener(this,EventType.S2CRepStoreLimitUpdate,this.S2CRepStoreLimitUpdate),EventProxy.RemoveListener(this,EventType.RefreshStoreRed,this.getRed)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.S2CRepStoreBuy=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.visible=!1;for(var i=t[0],n=t[1],o=0;o<this.list1.numChildren;++o){var s=this.list1.getChildAt(o);if(void 0!=s&&void 0!=s.data){var r=s.data;StoreProxy.ins().getStoreId(i,r.id)==n&&s.refresh()}}},e.prototype.S2CRepStoreRefresh=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRefreshData(),this.setCurrentStore(this.currentStoreIndex,!0)},e.prototype.S2CRepStoreLimitUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],n=0;n<this.list1.numChildren;++n){var o=this.list1.getChildAt(n);if(void 0!=o&&void 0!=o.data){var s=o.data;s.id==i&&o.refresh()}}},e.prototype.onBuyClick=function(t){void 0!=this.current_store_data&&(StoreProxy.ins().C2SReqStoreBuy(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id,this.buy_num),this.tips.visible=!1)},e.prototype.onCloseTipsClick=function(t){this.tips.visible=!1},e.prototype.onTipsNumClick=function(t){if(void 0!=this.current_store_data){for(var e=this.current_store_data.max_buy,i=StoreProxy.ins().getLimitCount(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id),n=Math.floor(RoleProxy.ins().getMoneyAttr(this.current_store_data.type)/this.current_store_data.price),o=Number.MAX_VALUE,s=0;s<this.current_store_data.need_items.length;++s){var r=Math.floor(BagProxy.ins().getItemCountById(this.current_store_data.need_items[s][0])/this.current_store_data.need_items[s][1]);o>r&&(o=r)}n=Math.min(n,o),e>0?(e-=i,e=Math.min(e,n)):e=n;var a=this.buy_num;switch(t.currentTarget){case this.tipsAdd:a+1>e?TipsControl.ins().showTips("已达上限！"):a+=1;break;case this.tipsAddten:a+1>e?TipsControl.ins().showTips("已达上限！"):a=Math.min(e,a+10);break;case this.tipsLess:a=Math.max(1,a-1);break;case this.tipsLessten:a=Math.max(1,a-10)}this.buy_num=a,this.tipsNum.text=this.buy_num.toString()}},e.prototype.ShowBossStoreBuyTips=function(t){var e=t;this.current_store_data=e,this.buy_num=1,this.tips.visible=!0,this.tipsNum.text=""+e.max_buy,this.tipsNum.text=this.buy_num.toString();var i=new ItemCellData,n={item_slot_idx:0,item_type_id:e.item_id,item_count:1};i.setItemCellData(n),this.cell.data=i,this.itemName.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(i.itemConfig.quality)+"&"+i.itemConfig.name),this.tipsInfo.textFlow=UtilProxy.generateTextFlow(i.itemConfig.TIPS)},e.prototype.onMenuClick=function(t){var e=this.sbtnList.lastIndexOf(t.currentTarget);this.setCurrentStore(e+1)},e.prototype.setCurrentStore=function(t,e){if(void 0===e&&(e=!1),this.currentStoreIndex!=t||e){this.currentStoreIndex=t;for(var i=StoreProxy.ins().getStoreConfigByStoreType("2"),n=i[t-1],o=n.id,s=0;s<this.sbtnList.length;++s)this.sbtnList[s].icon="common_btn_smell_yellow_off";this.sbtnList[this.currentStoreIndex-1].icon="common_btn_smell_yellow_on";var r=GlobalConfig.getConfig("store","storeConfig"),a=!1;for(var h in r)r[h].rate_type==o&&(a=1==r[h].time_type);var l=new Array;if(a){var p=GlobalConfig.getConfig("store_cell","store_cellConfig"),c=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);for(var h in p)p[h].shopType==o&&(p[h].zhuan_limit.length>0?p[h].zhuan_limit[0]<=c&&p[h].zhuan_limit[1]>=c&&l.push(p[h]):l.push(p[h]))}else for(var s=0;s<StoreProxy.ins().item_list.length;++s)if(StoreProxy.ins().item_list[s].store_id==o)for(var u=0;u<StoreProxy.ins().item_list[s].items.length;++u){var d=StoreProxy.ins().item_list[s].items[u].item_id;l.push(GlobalConfig.getStore_cellConfig(d))}var g=function(t,e){return t.id>e.id?1:-1},y=GlobalConfig.getStoreConfig(o),f="";void 0!=y&&(f=y._name),l.sort(g),this.list1.dataProvider=new eui.ArrayCollection(l),this.setRefreshData(),this.bg.source="resource/skins/BossStoreView/"+y.head_bg+".png",this.initItemId=void 0}},e.prototype.setRefreshData=function(){for(var t=StoreProxy.ins().getBossPayIdList(),e=0;e<this.icon_list.length;++e)if(t[e]){var i=BagProxy.ins().getItemData(t[e]);this.icon_list[e].source=AssetMgr.getIconResource(i.displayid),this.name_list[e].textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[i.quality-1],i.name]),t[e]==MoneyAttr.BOSS_JH?this.value_list[e].text=RoleProxy.ins().getMoneyAttr(MoneyAttr.BOSS_JH).toString():this.value_list[e].text=BagProxy.ins().getItemCountById(t[e]).toString()}},e.prototype.getRed=function(){var t=StoreProxy.ins().getStoreConfigByStoreType("2"),e=0;for(var i in t)this.sbtnList[e].setRed(StoreProxy.ins().getStoreRedByType(t[i].id)),e++},e}(BaseEuiView);__reflect(BossStoreView.prototype,"BossStoreView"),ViewManager.ins().reg(BossStoreView,LayerManager.UI_Main),window.BossStoreView=BossStoreView;var ButtonEx=function(t){function e(){var e=t.call(this)||this;return e.end=0,e.start=0,e.cd=1e3,e.isUpState=!1,e.isFirstClick=!1,e.isRedState=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onClick,e),e.start=egret.getTimer(),e.end=egret.getTimer(),e}return __extends(e,t),e.prototype.setCD=function(t){this.cd=t},e.prototype.onClick=function(t){if(this.start=egret.getTimer(),SoundManager.ins().playEffect("ui_click_wav"),this.start>this.end)this.end=this.start+this.cd;else{this.touchEnabled=!1;var e=function(){this.touchEnabled=!0};TimerManager.ins().doTimer(this.end-this.start,1,e,this)}this.isFirstClick||(this.data&&void 0!=this.data.forever_eff&&0==this.data.forever_eff&&this.setEff(!1),this.data&&this.data.isRedShow&&this.setEff(this.isRedState)),this.isFirstClick=!0},e.prototype.setSkinName=function(t){this.skinName=t},e.prototype.setLabel=function(t){void 0!=this.labelDisplay&&(this.labelDisplay.textFlow=UtilProxy.generateTextFlow(t))},e.prototype.setTopInfo=function(t,e){void 0===e&&(e=12),void 0!=this.topInfo&&(this.topInfo.size=e,this.topInfo.textFlow=UtilProxy.generateTextFlow(t))},e.prototype.setBgDisplay=function(t){void 0!=this.bgDisplay&&(this.bgDisplay.source=t)},e.prototype.setRed=function(t){this.isRedState=t,void 0!=this.red&&(this.data&&this.data.isRedShow?t?this.red.visible=!0:this.isFirstClick?this.red.visible=!1:this.red.visible=t:this.red.visible=t)},e.prototype.setSelect=function(t){this.selectIcon&&(this.selectIcon.visible=t)},e.prototype.dipose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this),TimerManager.ins().removeAll(this)},e.prototype.setUpState=function(t){this.up&&(this.up.visible=t,this.isUpState=t,this.setDownState(!t))},e.prototype.setDownState=function(t){this.down&&(this.down.visible=t)},e.prototype.setTotalNum=function(t,e){this.totalLabel&&(this.totalLabel.text=t+"/"+e)},e.prototype.setFontImg=function(t){this.fontDisplay&&(this.fontDisplay.source=t)},e.prototype.setEff=function(t,e,i,n,o){if(void 0===i&&(i=1),void 0===n&&(n=1),void 0===o&&(o=14),this.effect){if(t){if(this.data&&void 0!=this.data.forever_eff&&0==this.data.forever_eff&&this.isFirstClick)return;this.effect.numChildren>0&&this.effect.removeChildren(),e&&(UtilProxy.GetMovieClipById(e,this.effect),this.effect.scaleX=i,this.effect.scaleY=n,this.effect.y=o)}else{if(this.data&&void 0!=this.data.forever_eff&&1==this.data.forever_eff)return;this.effect.removeChildren()}this.effect.visible=t}},e.prototype.setNameIcon=function(t){this.nameIcon&&(""!=t?(this.nameIcon.visible=!0,this.nameIcon.source=t):this.nameIcon.visible=!1)},e}(eui.Button);__reflect(ButtonEx.prototype,"ButtonEx"),window.ButtonEx=ButtonEx;var BlackRoleItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BlackRoleSkin",e.addTouchEvent(e.btn,e.Click),e}return __extends(e,t),e.prototype.Click=function(t){var e=this.data;ChatProxy.ins().C2SReqGlobalchatCancelBlacklist(e.role_id)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.rname.text=e.name},e}(BaseItemRender);__reflect(BlackRoleItem.prototype,"BlackRoleItem"),window.BlackRoleItem=BlackRoleItem;var ChatBitItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChatBitSkin",e.addTouchEvent(e.icon,e.onIconclick),e}return __extends(e,t),e.prototype.onIconclick=function(t){if(ChatProxy.ins().getMyChatLeftCount()<=0)return void TipsControl.ins().showTips("请提升VIP等级");if(ChatProxy.ins().checkChatPermission())return TipsControl.ins().showTips(ChatProxy.ins().checkChatByLV()),void ChatProxy.ins().showChatPicPanel();var e=UtilProxy.chatBitMark+t.currentTarget.icon;1==ChatProxy.ins().current_channel?ChatProxy.ins().C2SReqGlobalchatCross(e):2==ChatProxy.ins().current_channel&&ChatProxy.ins().C2SSingleChat(XyProxy.ins().right_info.role_id,e,"",0)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.icon.icon="chat_icon_"+UtilProxy.NumberDoubleLength(e)},e}(BaseItemRender);__reflect(ChatBitItem.prototype,"ChatBitItem"),window.ChatBitItem=ChatBitItem;var ChatBitItem1=function(t){function e(){var e=t.call(this)||this;
return e.skinName="ChatBit1Skin",e.addTouchEvent(e.icon,e.onIconclick),e}return __extends(e,t),e.prototype.onIconclick=function(t){if(ChatProxy.ins().getMyChatLeftCount()<=0)return void TipsControl.ins().showTips("请提升VIP等级");var e=GlobalConfig.getLimitsConfig(1),i=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);if(e.vip_chat_level>i)return void TipsControl.ins().showTips("未达到VIP"+e.vip_chat_level);if(this.data){var n=UtilProxy.chatVipBitMark+t.currentTarget.source;1==ChatProxy.ins().current_channel?ChatProxy.ins().C2SReqGlobalchatCross(n):2==ChatProxy.ins().current_channel&&ChatProxy.ins().C2SSingleChat(1049978,n,"",0)}},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.icon.source="chat_VIP_"+UtilProxy.NumberDoubleLength(e)},e}(BaseItemRender);__reflect(ChatBitItem1.prototype,"ChatBitItem1"),window.ChatBitItem1=ChatBitItem1;var ChatItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChatItemSkin",e.addTouchEvent(e.info,e.onClickTips),e.addTouchEvent(e.findBtn,e.onFindclick),e.addTouchEvent(e.blackBtn,e.onBlackclick),e.addTouchEvent(e.icon,e.onRoleclick),e.pro.visible=!1,e}return __extends(e,t),e.prototype.onClickTips=function(t){var e=this.data;if(0===e.fighting){var i=(BagProxy.ins().getItemData(e.itemId),new ItemCellData),n={item_slot_idx:0,item_type_id:e.itemId,item_count:1};i.setItemCellData(n),ViewManager.ins().open(ItemTipsView,i)}},e.prototype.onFindclick=function(t){this.data},e.prototype.onBlackclick=function(t){var e=this.data;ChatProxy.ins().GetBlackState(e.from_uid)?TipsControl.ins().showTips("已在黑名单！"):TipsControl.ins().ShowTips1("屏蔽该玩家信息，并将该玩家加入黑名单，是否确定？",function(){},function(){ChatProxy.ins().C2SReqGlobalchatSetBlacklist(e.from_uid,e.username)})},e.prototype.onRoleclick=function(t){this.data},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;for(var i in this.data)if("null"===i)return;this.SetData(e)},e.prototype.SetData=function(t){this.blackBtn.visible=this.findBtn.visible=this.role_name.visible=!0,this.icon.visible=!0,t.vip_type>0?(t.vip_type>18?(this.vipLvl.text=(t.vip_type-18).toString(),this.vipfont.source="common_icon_VIP02"):(this.vipLvl.text=t.vip_type.toString(),this.vipfont.source="VIP"),this.vipfont.visible=!0):(this.vipLvl.text="",this.vipfont.visible=!1),t.rights_id==PrivilegeType.ZHOUKA&&(this.teImg.source="resource/skins/ChatView/common_icon_zhouka.png"),t.rights_id==PrivilegeType.BOJIN&&(this.teImg.source="resource/skins/ChatView/common_icon_tequan_01.png"),t.rights_id==PrivilegeType.ZHIZUN&&(this.teImg.source="resource/skins/ChatView/common_icon_tequan_02.png"),t.chat_id>0?(this.bg1.visible=1==t.chat_id,this.bg2.visible=2==t.chat_id,this.bg3.visible=3==t.chat_id):(this.bg1.visible=!0,this.bg2.visible=!1,this.bg3.visible=!1),this.bz.visible=t.is_bazhu;var e=t.msg_content;e.indexOf(UtilProxy.chatBitMark)>=0?(this.bit.visible=!0,this.bit.source=e.replace(UtilProxy.chatBitMark,""),this.info.text=""):e.indexOf(UtilProxy.chatVipBitMark)>=0?(this.bit.visible=!0,this.bit.source=e.replace(UtilProxy.chatVipBitMark,""),this.info.text=""):(this.bit.visible=!1,e.indexOf("C:")>=0&&e.indexOf("&:")>=0?this.info.textFlow=UtilProxy.generateTextFlow(t.msg_content):this.info.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",["1",t.msg_content])),t.head_id<=0?this.icon.source="common_touxiang_0"+t.prof:this.icon.source=SetProxy.ins().getHeadIcon(t.head_id),t.headChat_id>0?this.iconBg.source=SetProxy.ins().getHeadFrame(t.headChat_id):this.iconBg.source=SetProxy.ins().getHeadFrame(1);var i=TitleProxy.ins().getTitleNameById(t.title_id,t.zongmen);this.role_name.textFlow=UtilProxy.StrFormart("C:6&S@0 .|C:10&@1 |C:10&@2 |@3 ",[t.server_id,i,t.username,t.xianweiName]),RoleProxy.ins().getRoleId()==t.from_uid?(this.blackBtn.visible=!1,this.sys.visible=!1):0===t.fighting?(this.blackBtn.visible=this.findBtn.visible=this.role_name.visible=!1,this.icon.visible=!1,this.sys.visible=!0,this.addTouchEvent(this.info,this.onClickTips)):(this.sys.visible=!1,this.blackBtn.visible=!ChatProxy.ins().GetBlackState(t.from_uid)),this.findBtn.x=this.role_name.width+this.role_name.x+5},e.prototype.setBlackState=function(t){this.blackBtn.visible=t},e}(BaseItemRender);__reflect(ChatItem.prototype,"ChatItem"),window.ChatItem=ChatItem;var ChatSysItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChatSysItemSkin",e.addTouchEvent(e.info,e.onClickTips),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);for(var e in this.data)if("null"===e)return;var i=this.data;this._dataSouse=i,this.showInfo(i)},e.prototype.showInfo=function(t){t.msg_content.length>0&&(this.info.textFlow=TextFlowMaker.generateTextFlow2(t.msg_content),this.info.touchEnabled=!0,this.info.addEventListener(egret.TextEvent.LINK,this.onClickLinks,this))},e.prototype.onClickLinks=function(t){var e=GlobalConfig.getNotice_defConfig(this._dataSouse.code_id);e&&e.M_view.length>0&&ViewManager.ins().OpenViewById(e.M_view[0],e.M_view[1])},e.prototype.onClickTips=function(t){var e=this.data;if(0===e.fighting){var i=BagProxy.ins().getItemData(e.itemId);if(i){var n=new ItemCellData,o={item_slot_idx:0,item_type_id:e.itemId,item_count:1};n.setItemCellData(o),ViewManager.ins().open(ItemTipsView,n)}}},e}(BaseItemRender);__reflect(ChatSysItem.prototype,"ChatSysItem"),window.ChatSysItem=ChatSysItem;var ChatUIView=function(t){function e(){var e=t.call(this)||this;return e.isLevelLimit=!1,e.isAdsLimit=!1,e.s_name_array=["跨服","私聊","系统"],e.chat_flag=!1,e.move_type=0,e.isCanCountiue=!0,e.isBitPanelShow=!1,e.curBitIndex=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ChatUIViewSkin",this.comview.initUI(),this.comview.SetName(UtilProxy.getTitleName("聊天")),this.listF.itemRenderer=ChatItem,this.scrollerF.viewport=this.listF,this.listsys.itemRenderer=ChatSysItem,this.scrollersys.viewport=this.listsys,this.listB.itemRenderer=ChatBitItem,this.scrollerB.viewport=this.listB,this.listB0.itemRenderer=ChatBitItem1,this.scrollerB0.viewport=this.listB0,this.listB.dataProvider=new eui.ArrayCollection,this.listB0.dataProvider=new eui.ArrayCollection,this.listBlk.itemRenderer=BlackRoleItem,this.scrollerBlk.viewport=this.listBlk,this.BitPanel.visible=!1,this.blackBar.visible=!1,this.blackView.visible=!1,this.sBtn=[this.sbtn0,this.sbtn1,this.sbtn2]},e.prototype.nextRef=function(){var t=ChatProxy.ins().getLastModel();t?t.from_uid>0?this.visibleByIndexBtn(0):this.visibleByIndexBtn(2):this.visibleByIndexBtn(0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.move_type=0,this.arr_chat||(this.arr_chat=new eui.ArrayCollection,this.listF.dataProvider=this.arr_chat),TimerManager.ins().doTimer(1e3,1,this.nextRef,this);for(var i=0;i<this.sBtn.length;++i)this.sBtn[i].label=this.s_name_array[i],this.addTouchEvent(this.sBtn[i],this.onSBtnClick);this.addTouchEvent(this.sys_info,this.onClickTips),this.addTouchEvent(this.bitMapBtn,this.onBitMapClick),this.addTouchEvent(this.msgBtn,this.onMsgClick),this.addTouchEvent(this.bitBtn1,this.onBitBtnClick),this.addTouchEvent(this.bitBtn2,this.onBitBtnClick),this.addTouchEvent(this.bitBlack,this.onBitBlackClick),this.addTouchEvent(this.set,this.onSetClick),this.addTouchEvent(this.blackBtn,this.onBlackBtnClick),this.addChangeEvent(this.checkLevel,this.UpdateCheckLevelState),this.addChangeEvent(this.checkAds,this.UpdateCheckAdsState),this.addTouchEvent(this.blackclose,this.onBlackCloseClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandler,this),EventProxy.AddListener(this,EventType.CS2CChannelChat,this.CS2CChannelChat),EventProxy.AddListener(this,EventType.CS2CSingleChat,this.CS2CSingleChat),EventProxy.AddListener(this,EventType.S2CRepGlobalchatCross,this.S2CRepGlobalchatCross),EventProxy.AddListener(this,EventType.CS2CSysChat,this.onClickTips),EventProxy.AddListener(this,EventType.S2CRepGlobalchatSetBlacklist,this.S2CRepGlobalchatSetBlacklist),EventProxy.AddListener(this,EventType.S2CRepGlobalchatCancelBlacklist,this.S2CRepGlobalchatCancelBlacklist),this.input.prompt="请输入文本...",this.sys_info.text="",this.refreshData()},e.prototype.touchTapHandler=function(t){0==t.target.x&&0==t.target.y&&(this.BitPanel.visible=!1)},e.prototype.onSetClick=function(t){this.blackBar.visible=!this.blackBar.visible},e.prototype.onBlackBtnClick=function(t){this.blackView.visible=!0,this.RefreshBlackData()},e.prototype.RefreshBlackData=function(){var t=0;void 0!=ChatProxy.ins().blackList?(t=ChatProxy.ins().blackList.length,this.listBlk.dataProvider=new eui.ArrayCollection(ChatProxy.ins().blackList)):this.listBlk.dataProvider=new eui.ArrayCollection(new Array);var e=ChatProxy.blackLimitNum;this.blacklimit.textFlow=UtilProxy.generateTextFlow("屏蔽上限：|C:5&"+t+"/"+e)},e.prototype.onBlackCloseClick=function(t){this.blackView.visible=!1},e.prototype.UpdateCheckLevelState=function(){this.isLevelLimit=this.checkLevel.selected,this.selectedLvCleck()},e.prototype.UpdateCheckAdsState=function(){this.isAdsLimit=this.checkLevel.selected},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),EventProxy.RemoveListener(this,EventType.CS2CChannelChat,this.CS2CChannelChat),EventProxy.RemoveListener(this,EventType.CS2CSingleChat,this.CS2CSingleChat),EventProxy.RemoveListener(this,EventType.S2CRepGlobalchatCross,this.S2CRepGlobalchatCross),EventProxy.RemoveListener(this,EventType.CS2CSysChat,this.onClickTips),EventProxy.RemoveListener(this,EventType.S2CRepGlobalchatSetBlacklist,this.S2CRepGlobalchatSetBlacklist),EventProxy.RemoveListener(this,EventType.S2CRepGlobalchatCancelBlacklist,this.S2CRepGlobalchatCancelBlacklist),TimerManager.ins().remove(this.nextRef,this),this.removeTouchEvent(this.bitMapBtn,this.onBitMapClick),this.removeTouchEvent(this.msgBtn,this.onMsgClick),this.removeTouchEvent(this.bitBtn1,this.onBitBtnClick),this.removeTouchEvent(this.bitBtn2,this.onBitBtnClick),this.removeTouchEvent(this.bitBlack,this.onBitBlackClick),this.removeTouchEvent(this.set,this.onSetClick),this.removeTouchEvent(this.blackBtn,this.onBlackBtnClick),this.removeTouchEvent(this.checkLevel,this.UpdateCheckLevelState),this.removeTouchEvent(this.checkAds,this.UpdateCheckAdsState),this.removeTouchEvent(this.blackclose,this.onBlackCloseClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandler,this),this.arr_chat&&(this.arr_chat.removeAll(),this.arr_chat=null)},e.prototype.selectedLvCleck=function(){this.isLevelLimit?this.arr_chat.replaceAll(ChatProxy.ins().selectedShield()):this.arr_chat.replaceAll(ChatProxy.ins().showChatDataList(3))},e.prototype.visibleByIndexBtn=function(t){switch(this.sysShowPic(t),this.line.visible=!0,t){case 0:this.view1.visible=!0,this.view2.visible=!1,this.selectedLvCleck(),this.moveToEnd();break;case 1:this.view1.visible=!0,this.view2.visible=!1,this.arr_chat.replaceAll(ChatProxy.ins().showChatDataList(2)),this.moveToEnd();break;case 2:this.view1.visible=!1,this.view2.visible=!0,this.line.visible=!1,this.setSysChat()}ChatProxy.ins().current_channel=t+1},e.prototype.onSBtnClick=function(t){var e=this.sBtn.indexOf(t.currentTarget);return 1==e?void TipsControl.ins().showTips("该功能暂未开启!"):(this.HideBitPanel(),this.scrollerF.viewport.scrollV=0,void(e+1!=ChatProxy.ins().current_channel&&this.visibleByIndexBtn(e)))},e.prototype.sysShowPic=function(t){2>t?this.img1.visible=this.img2.visible=this.input.visible=this.bitMapBtn.visible=this.msgBtn.visible=this.chatNum.visible=!0:this.img1.visible=this.img2.visible=this.input.visible=this.bitMapBtn.visible=this.msgBtn.visible=this.chatNum.visible=!1},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBitMapClick=function(t){this.ShowBitPanel()},e.prototype.onMsgClick=function(t){if(GlobalConfig.getLimitsConfig(1).chatlimit_yb>RoleProxy.ins().getMoneyAttr(MoneyAttr.RECHARGE_YB))return void TipsControl.ins().showTips("充值"+GlobalConfig.getLimitsConfig(1).chatlimit_yb/LimitActProxy.ins().rechargeNun+"元可发言");if(ChatProxy.ins().checkChatPermission())return TipsControl.ins().showTips(ChatProxy.ins().checkChatByLV()),void(this.input.text="");if(ChatProxy.ins().getMyChatLeftCount()<=0)return void TipsControl.ins().showTips("请提升VIP等级");var e=this.input.text,i=function(t){t?e.length&&(1==ChatProxy.ins().current_channel?ChatProxy.ins().C2SReqGlobalchatCross(e):2==ChatProxy.ins().current_channel&&ChatProxy.ins().C2SSingleChat(XyProxy.ins().right_info.role_id,e,"",0)):TipsControl.ins().showTips("包涵非法字符！"),this.isCanCountiue=!0};this.input.text="",this.isCanCountiue=!1,UtilProxy.CheckScreenchar(e,i)},e.prototype.onBitBtnClick=function(t){var e=1;switch(t.currentTarget){case this.bitBtn1:e=1;break;case this.bitBtn2:e=2}this.curBitIndex!=e&&(this.ShowBit(e),this.curBitIndex=e)},e.prototype.onBitBlackClick=function(t){this.BitPanel.visible=!1},e.prototype.ShowBitPanel=function(){this.BitPanel.visible=!0,this.bitBtn1.icon="common_btn_big_yellow",this.bitBtn2.icon="common_btn_big_yellow_off",this.isBitPanelShow=!0,this.ShowBit(ChatProxy.ins()._typeImg)},e.prototype.HideBitPanel=function(){this.BitPanel.visible=!1,this.isBitPanelShow=!0,this.curBitIndex=0},e.prototype.ShowBit=function(t){if(1==t){this.scrollerB0.visible=!1,this.scrollerB.visible=!0,this.bitBtn1.icon="common_btn_big_yellow",this.bitBtn2.icon="common_btn_big_yellow_off";for(var e=52,i=new Array,n=1;e>=n;++n)i.push(n);this.listB.dataProvider=new eui.ArrayCollection(i)}else{this.bitBtn1.icon="common_btn_big_yellow_off",this.bitBtn2.icon="common_btn_big_yellow",this.scrollerB0.visible=!0,this.scrollerB.visible=!1;for(var e=32,i=new Array,n=1;e>=n;++n)i.push(n);this.listB0.dataProvider=new eui.ArrayCollection(i)}ChatProxy.ins()._typeImg=t},e.prototype.CS2CSingleChat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];2==ChatProxy.ins().current_channel&&(this.arr_chat.replaceAll(ChatProxy.ins().showChatDataList(2)),this.moveToEnd())},e.prototype.CS2CChannelChat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];0==i?1==ChatProxy.ins().current_channel&&(this.arr_chat.replaceAll(ChatProxy.ins().showChatDataList(1)),this.moveToEnd(),this.HideBitPanel(),this.input.text=""):1==i&&3==ChatProxy.ins().current_channel&&this.setSysChat()},e.prototype.setSysChat=function(){this.listsys.dataProvider=new eui.ArrayCollection(ChatProxy.ins().getChatSysList()),TimerManager.ins().doTimer(200,1,this.listToSysterm,this)},e.prototype.onClickTips=function(){},e.prototype.S2CRepGlobalchatCross=function(t){var e=t[0];1==ChatProxy.ins().current_channel&&(this.selectedLvCleck(),this.moveToEnd(),e&&(this.HideBitPanel(),this.input.text="")),this.refreshData()},e.prototype.refreshData=function(){var t=ChatProxy.ins().getChatNum()-ChatProxy.ins().getMyChatCount();this.chatNum.text=Math.max(t,0).toString()},e.prototype.S2CRepGlobalchatSetBlacklist=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.arr_chat.replaceAll(ChatProxy.ins().showChatDataList(1)),this.moveToEnd()},e.prototype.S2CRepGlobalchatCancelBlacklist=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.RefreshBlackData(),this.arr_chat.replaceAll(ChatProxy.ins().showChatDataList(1)),this.moveToEnd()},e.prototype.listToSysterm=function(){this.scrollersys.viewport.contentHeight>this.scrollersys.height&&(this.scrollersys.viewport.scrollV=this.scrollersys.viewport.contentHeight-this.scrollersys.height)},e.prototype.moveToEnd=function(t){void 0===t&&(t=0),this.move_type=t,TimerManager.ins().remove(this.listToBottom,this),TimerManager.ins().doTimer(200,1,this.listToBottom,this)},e.prototype.listToBottom=function(){if(this.scrollerF.viewport.contentHeight>this.scrollerF.height)if(0==this.move_type)this.scrollerF.viewport.scrollV=this.scrollerF.viewport.contentHeight-this.scrollerF.height;else{var t=this.scrollerF.viewport.contentHeight-this.scrollerF.height;t=t>80?this.scrollerF.viewport.scrollV+80:t,this.scrollerF.viewport.scrollV=t}},e}(BaseEuiView);__reflect(ChatUIView.prototype,"ChatUIView"),ViewManager.ins().reg(ChatUIView,LayerManager.UI_Main),window.ChatUIView=ChatUIView;var ContainSystemView=function(t){function e(){var e=t.call(this)||this;return e.btn_list=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ContainSystemViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.target=t[2],this.setData(t[1]),this.target){var i=this.target.localToGlobal(0,0),n=this.target.width/2;this.target.height/2;this.root.y=i.y-5,this.root.x=i.x+n}this.addTouchEvent(this.mask0,this.onMaskClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this.btn_list.length-1;i>=0;--i)this.removeTouchEvent(this.btn_list[i],this.onBtnClick),this.containG.removeChild(this.btn_list[i]),this.btn_list.splice(i,1);this.removeTouchEvent(this.mask0,this.onBtnClick)},e.prototype.setData=function(t){for(var e=GlobalConfig.getMain_systemConfigs(),i=[],n=0;n<e.length;++n)e[n].contain_id==t&&i.push(e[n]);var o=function(t,e){return t.rank>e.rank?1:-1};i.sort(o);for(var n=this.btn_list.length-1;n>=0;--n)this.removeTouchEvent(this.btn_list[n],this.onBtnClick),this.containG.removeChild(this.btn_list[n]),this.btn_list.splice(n,1);for(var n=0;n<i.length;++n){var s=0==i[n].page?1:2,r=0==i[n].page?Number(i[n].view_id):100*Number(i[n].view_id)+i[n].page,a=SystemOpenProxy.ins().isOpen(s,r,!0);if(a){var h=new ButtonEx;h.skinName="Btn0Skin",h.icon=i[n].icon,h.data=i[n],h.setRed(MainProxy.ins().getSystemRedByName(i[n].name)),this.containG.addChild(h),this.addTouchEvent(h,this.onBtnClick),this.btn_list.push(h)}}this.bg.width=60*i.length+28},e.prototype.onBtnClick=function(t){var e=this.btn_list.indexOf(t.currentTarget);if(!(0>e)){var i=this.btn_list[e].data;ViewManager.ins().OpenViewById(Number(i.view_id),0==i.page?void 0:i.page),ViewManager.ins().close(this)}},e.prototype.onMaskClick=function(t){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(ContainSystemView.prototype,"ContainSystemView"),ViewManager.ins().reg(ContainSystemView,LayerManager.UI_Main2),window.ContainSystemView=ContainSystemView,window.ContainSystemView=ContainSystemView;var DailyTaskQuest=function(t){function e(){var e=t.call(this)||this;return e.numStr=["零","一","二","三","四","五","六","七","八","九","十"],e.starList=[],e.starIcons=["shengxing_icon_01_01","shengxing_icon_01_05"],e.copyStar=0,e.skinName="DailyTaskQuestSkin",e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=ItemCell,this.itemDataArrary=new eui.ArrayCollection,this.list.dataProvider=this.itemDataArrary,this.starList=[];for(var t=0;t<this.g_star.numChildren;t++)this.starList.push(this.g_star.getChildAt(t))},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];EventProxy.AddListener(this,EventType.S2CRepTaskGetDailyTaskInfo,this.showInfo),EventProxy.AddListener(this,EventType.S2CRepTaskUpdateDailyTask,this.showStar),EventProxy.AddListener(this,EventType.S2CRepTaskUpdateDailyTask,this.showAwards),EventProxy.AddListener(this,EventType.S2CRepCopyStart,function(){t.visible=!1}),EventProxy.AddListener(this,EventType.S2CRepCopyEnd,function(){t.visible=!0}),this.addTouchEvent(this.btn_add,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.addTouchEvent(this.btn_return,this.onClick),this.addTouchEvent(this.btn_close,this.onClick),this.showInfo()},e.prototype.close=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];EventProxy.RemoveListener(this,EventType.S2CRepTaskGetDailyTaskInfo,this.showInfo),EventProxy.RemoveListener(this,EventType.S2CRepTaskUpdateDailyTask,this.showStar),EventProxy.RemoveListener(this,EventType.S2CRepTaskUpdateDailyTask,this.showAwards),EventProxy.RemoveListener(this,EventType.S2CRepCopyStart,function(){t.visible=!1}),EventProxy.RemoveListener(this,EventType.S2CRepCopyEnd,function(){t.visible=!0})},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_add:var e=GlobalConfig.getDailytask_misc_dataConfig(1);if(DailyTaskProxy.ins().curStar>=e.max_star){TipsControl.ins().showTips("星数已满");break}TipsControl.ins().ShowTips1("是否消耗|C:7&"+e.max_star_cost[1]+"|元宝提升星级？",function(){},function(){return RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<e.max_star_cost[1]?void TipsControl.ins().showTips("元宝不足"):void DailyTaskProxy.ins().C2SReqTaskDailyTaskOper(3)});break;case this.btn:this.copyStar=DailyTaskProxy.ins().curStar,DailyTaskProxy.ins().C2SReqTaskDailyTaskOper(4);case this.btn_return:case this.btn_close:ViewManager.ins().close(this)}},e.prototype.showInfo=function(){var t=GlobalConfig.getDailytask_misc_dataConfig(1);this.lab_target.textFlow=UtilProxy.generateTextFlow("|C:7&60秒内击败妖魔，即可完成任务|"),this.showStar(),this.lab_info.textFlow=UtilProxy.generateTextFlow("消耗|C:7&"+t.max_star_cost[1]+"元宝|，可提高到:|C:10&"+this.numStr[t.max_star]+"星奖励|"),this.showLabInfo1(),this.showAwards()},e.prototype.showStar=function(){for(var t=0;t<this.starList.length;t++)t<DailyTaskProxy.ins().curStar?this.starList[t].source=this.starIcons[1]:this.starList[t].source=this.starIcons[0]},e.prototype.showLabInfo1=function(){var t=["","","",""],e=GlobalConfig.getDailytask_base_dataConfigs();for(var i in e){var n=this.numStr[e[i].id]+"星级奖励:|C:7&"+e[i].award_rate/100+"%奖励|";e[i].id>t.length?t[e[i].id-t.length-1]+="		"+n:t[e[i].id-1]+=n}for(var o="",i=0;i<t.length-1;i++)o+=t[i]+"\n";o+=""+t[t.length-1],this.lab_info1.textFlow=UtilProxy.generateTextFlow(o)},e.prototype.showAwards=function(){var t=GlobalConfig.getDailytask_base_dataConfig(DailyTaskProxy.ins().curStar);if(void 0!=t){this.itemDataArrary.removeAll();for(var e=0;e<t.award_items.length;e++){var i=UtilProxy.GetItemCellData(t.award_items[e][0],t.award_items[e][1]);this.itemDataArrary.addItem(i)}}},e.prototype.copyEnd=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[0]){var i=GlobalConfig.getDailytask_base_dataConfig(t[1]);if(this.copyStar,void 0!=i){for(var n=[],o=0;o<i.award_items.length;o++)n.push(UtilProxy.GetItemCellData(i.award_items[o][0],i.award_items[o][1]));TipsControl.ins().showReward(n)}}},e.prototype.showEff=function(){var t,e=t[0];if(void 0!=e&&(this.effect.removeChildren(),!(e.charRes_wuqi.length<4)))switch(this.effect.x=e.charRes_wuqi[2],this.effect.y=e.charRes_wuqi[3],e.charRes_wuqi[0]){case 1:var i=new eui.Image(e.charRes_wuqi[1]);this.effect.addChild(i);break;case 2:var n=new egret.MovieClip;UtilProxy.GetMovieClip(e.charRes_wuqi[1],n,-1,void 0),this.effect.addChild(n);break;case 3:UtilProxy.GetMovieClipById(Number(e.charRes_wuqi[1]),this.effect)}},e}(BaseEuiView);__reflect(DailyTaskQuest.prototype,"DailyTaskQuest"),ViewManager.ins().reg(DailyTaskQuest,LayerManager.UI_Main2),window.DailyTaskQuest=DailyTaskQuest;var DailyTaskView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.bar.labelFunction=function(t,e){return"完成次数:"+t+"/"+e},this.list.itemRenderer=ItemCell,this.itemDataArray=new eui.ArrayCollection,this.list.dataProvider=this.itemDataArray,EventProxy.AddListener(this,EventType.S2CRepTaskGetDailyTaskInfo,this.showInfo),EventProxy.AddListener(this,EventType.S2CRepTaskDailyTaskCopyResult,this.showTaskStep),EventProxy.AddListener(this,EventType.S2CRepTaskDailyTaskCopyResult,this.showCount),EventProxy.AddListener(this,EventType.S2CRepCopyStart,function(){t.parent.parent.visible=!1}),EventProxy.AddListener(this,EventType.S2CRepCopyEnd,this.copyEnd),this.addTouchEvent(this.btn_getAward,this.onClick),this.addTouchEvent(this.btn_getQuest,this.onClick),this.showInfo(),DailyTaskProxy.ins().C2SReqTaskGetDailyTaskInfo()},e.prototype.close=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];EventProxy.RemoveListener(this,EventType.S2CRepTaskGetDailyTaskInfo,this.showInfo),EventProxy.RemoveListener(this,EventType.S2CRepTaskDailyTaskCopyResult,this.showTaskStep),EventProxy.RemoveListener(this,EventType.S2CRepTaskDailyTaskCopyResult,this.showCount),EventProxy.RemoveListener(this,EventType.S2CRepCopyStart,function(){t.parent.parent.visible=!1}),EventProxy.RemoveListener(this,EventType.S2CRepCopyEnd,this.copyEnd),this.removeTouchEvent(this.btn_getAward,this.onClick),this.removeTouchEvent(this.btn_getQuest,this.onClick),TimerManager.ins().remove(this.labTimerUpdate,this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_getAward:if(this.bar.minimum<this.bar.maximum){var e=GlobalConfig.getDailytask_misc_dataConfig(1);TipsControl.ins().ShowTips1("是否消耗|C:7&"+e.onekey_task_cost[1]+"|元宝完成当前任务？",function(){},function(){return RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<e.onekey_task_cost[1]?void TipsControl.ins().showTips("元宝不足"):void DailyTaskProxy.ins().C2SReqTaskDailyTaskOper(5)});break}if(DailyTaskProxy.ins().isGetLoopAward){TipsControl.ins().showTips("奖励已领取");break}DailyTaskProxy.ins().C2SReqTaskDailyTaskOper(1);break;case this.btn_getQuest:if(this.bar.minimum==this.bar.maximum){TipsControl.ins().showTips("已挑战完今日所有任务");break}if(DailyTaskProxy.ins().leftNum<=0){TipsControl.ins().showTips("挑战次数不足");break}DailyTaskProxy.ins().C2SReqTaskDailyTaskOper(2),ViewManager.ins().open(DailyTaskQuest)}},e.prototype.showInfo=function(){var t=GlobalConfig.getDailytask_misc_dataConfig(1);this.bar.maximum=t.total_step,this.showTaskStep(),this.showCount(),this.bar.minimum<this.bar.maximum?this.btn_getAward.label="一键完成":this.btn_getAward.label="领取奖励",UtilProxy.SetAshColor(this.btn_getAward,DailyTaskProxy.ins().isGetLoopAward),this.itemDataArray.removeAll();for(var e=0;e<t.loop_award.length;e++){var i=UtilProxy.GetItemCellData(t.loop_award[e][0],t.loop_award[e][1]);this.itemDataArray.addItem(i)}},e.prototype.showTaskStep=function(){this.bar.minimum=DailyTaskProxy.ins().todayStep},e.prototype.showCount=function(){var t=GlobalConfig.getDailytask_misc_dataConfig(1);this.lab_count.textFlow=UtilProxy.generateTextFlow("任务挑战次数:|C:"+(0==DailyTaskProxy.ins().leftNum?4:7)+"&"+DailyTaskProxy.ins().leftNum+"|/"+t.max_recover_num),TimerManager.ins().remove(this.labTimerUpdate,this);var e=DailyTaskProxy.ins().nextRecoverTime,i=GameLogic.ins().getServerTime();e>i?(this.labTimerUpdate(),TimerManager.ins().doTimer(1e3,DailyTaskProxy.ins().nextRecoverTime-GameLogic.ins().getServerTime(),this.labTimerUpdate,this)):this.lab_update.text=""},e.prototype.labTimerUpdate=function(){DailyTaskProxy.ins().nextRecoverTime>GameLogic.ins().getServerTime()?this.lab_update.textFlow=UtilProxy.generateTextFlow("次数恢复时间:|C:7&"+UtilProxy.getTimeHMSString(DailyTaskProxy.ins().nextRecoverTime-GameLogic.ins().getServerTime())+"|"):DailyTaskProxy.ins().C2SReqTaskGetDailyTaskInfo()},e.prototype.copyEnd=function(){this.parent.parent.visible=!0,DailyTaskProxy.ins().C2SReqTaskGetDailyTaskInfo()},e}(BaseEuiView);__reflect(DailyTaskView.prototype,"DailyTaskView"),window.DailyTaskView=DailyTaskView;var DayRechargeGift=function(t){function e(){var e=t.call(this)||this;return e.lefttime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="DayRechargeGiftSkin",this.list.itemRenderer=ItemCell,this.effect.removeChildren(),UtilProxy.GetMovieClipById(101,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.maskbg,this.oncloseClick),this.addTouchEvent(this.closebtn,this.oncloseClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.maskbg,this.oncloseClick),this.removeTouchEvent(this.closebtn,this.oncloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),TimerManager.ins().remove(this.SetTimeLab,this)},e.prototype.oncloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=LimitActProxy.ins().GetDayRechargeCf();if(void 0!=e){var i=LimitActProxy.ins().GetActivityData(e.id);if(i&&i.is_completed){if(i.is_get)return void TipsControl.ins().showTips("奖励已领取");LimitActProxy.ins().C2SReqLimitActGetReward(e.id),ViewManager.ins().close(this)}else{var n=e.recharge_list[0]||0,o=GlobalConfig.getRechargeBagConfig(n);if(o){var s={app_subject:o.name,order_amt:100*o.amount,data:o};SdkManager.isUseSdk?SdkManager.ins().commitPay(s):TipsControl.ins().showTips("没有SDK")}}}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetDayRechargeCf();if(void 0!=t){this.lefttime=LimitActProxy.ins().GetActEndTime(t),this.ShowColdTime(),this.lefttime>0&&(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)),this.titlelab.text=(t.act_params[0]/LimitActProxy.ins().rechargeNun).toString(),this.numlab0.text=t.icon[0].toString(),this.numlab1.text=t.icon[1].toString(),this.numlab2.text=t.icon[2].toString(),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var e=t.act_award[0];if(e>0)for(var i=GlobalConfig.getDropConfig(e),n=GlobalConfig.getDropItem(i.drop),o=0;o<n.length;o++){var s=UtilProxy.GetItemCellData(n[o][0].id,n[o][0].num);this.arraylist.addItem(s)}if(this.model.removeChildren(),this.model.x=t.charRes_wuqi[2],this.model.y=t.charRes_wuqi[3],this.effect.visible=1==t.charRes_wuqi[0],2==t.charRes_wuqi[0]){var r=new egret.MovieClip;UtilProxy.GetMovieClip(t.charRes_wuqi[1],r,-1,void 0),this.model.addChild(r)}else if(3==t.charRes_wuqi[0])UtilProxy.GetMovieClipById(Number(t.charRes_wuqi[1]),this.model);else if(1==t.charRes_wuqi[0]){var a=new eui.Image;a.source=t.charRes_wuqi[1],this.model.addChild(a)}var h=LimitActProxy.ins().GetActivityData(t.id);this.red.visible=h&&h.is_completed&&0==h.is_get,this.btn.label=h&&h.is_completed?"领取奖励":"充点小钱"}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.lefttime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.lefttime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.lefttime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(DayRechargeGift.prototype,"DayRechargeGift"),ViewManager.ins().reg(DayRechargeGift,LayerManager.UI_Main2),window.DayRechargeGift=DayRechargeGift;var FabaoActiveView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(t){this.addTouchEvent(this,this.onClick),this.id=t,this.updateInfo()},e.prototype.close=function(){this.removeTouchEvent(this,this.onClick)},e.prototype.updateInfo=function(){var t=GlobalConfig.getFabaoType(this.id);this.icon.source=AssetMgr.getIconResource(t.icon),this.bg.source="common_Box_0"+(2+t.color)},e.prototype.onClick=function(t){this.close(),this.visible=!1},e}(BaseEuiView);__reflect(FabaoActiveView.prototype,"FabaoActiveView"),window.FabaoActiveView=FabaoActiveView;var FabaoItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)
},e.prototype.dataChanged=function(){void 0!=this.data&&this.updateInfo()},e.prototype.updateInfo=function(){var t=FabaoProxy.ins().getFabaoLv(this.data),e=GlobalConfig.getFabaoListById(this.data)[t],i=GlobalConfig.getFabaoListById(this.data)[t+1],n=GlobalConfig.getFabaoType(this.data);if(this.bg.source="lingbao_kapai_0"+n.color,this.icon.source=AssetMgr.getIconResource(n.icon),this.txt_lv.text=t+"级",this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[n.name_color,n.name]),this.sp_lock.visible=0==t,this.red.visible=FabaoProxy.ins().getRedById(this.data),i){var o=i.item[1],s=BagProxy.ins().getItemCountById(i.item[0]),r=i.item_replace>0?BagProxy.ins().getItemCountById(i.item_replace):0;this.process.setValue(s,r,o)}else this.process.setValue(e.item[1],e.item[1],e.item[1])},e}(BaseItemRender);__reflect(FabaoItem.prototype,"FabaoItem"),window.FabaoItem=FabaoItem;var FabaoTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.title_base.textFlow=UtilProxy.StrFormart("C:10&基础属性:",[]),this.title_melt.textFlow=UtilProxy.StrFormart("C:10&炼化属性:",[]),this.list_base.itemRenderer=FbTipsItem1,this.list_melt.itemRenderer=FbTipsItem2},e.prototype.open=function(t){this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_get,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.id=t,this.updateInfo(),this.CheckGuide()},e.prototype.close=function(){this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_get,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick)},e.prototype.updateInfo=function(){var t=FabaoProxy.ins().getFabaoLv(this.id);if(this.btn_lvup.label=0==t?"激活":"升级",this.cur_lv=t,this.cur_data=GlobalConfig.getFabaoListById(this.id)[t],this.next_data=GlobalConfig.getFabaoListById(this.id)[t+1],this.type_data=GlobalConfig.getFabaoType(this.id),this.icon.source=AssetMgr.getIconResource(this.type_data.icon),this.bg.source="common_Box_0"+(2+this.type_data.color),this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 @2  ",[this.type_data.name_color,this.type_data.name,t>0?"+"+t:""]),this.cur_data,this.next_data){this.btn_get.visible=this.btn_lvup.visible=!0,this.txt_remark.text="";var e=this.next_data.item[1],i=BagProxy.ins().getItemCountById(this.next_data.item[0]),n=this.next_data.item_replace>0?BagProxy.ins().getItemCountById(this.next_data.item_replace):0;this.process.setValue(i,n,e)}else this.process.setValue(this.cur_data.item[1],this.cur_data.item[1],this.cur_data.item[1]),this.btn_get.visible=this.btn_lvup.visible=!1,this.txt_remark.textFlow=UtilProxy.StrFormart("C:7&已满级",[]);for(var o=AttrProxy.getContAttrInfo(this.cur_data,this.next_data),s=new eui.ArrayCollection,r=0;r<o.length;r++)s.addItem({index:r,name:o[r][0],value_cur:o[r][1],value_next:o[r][2]});this.list_base.dataProvider=s,this.list_melt.dataProvider=this.getMeltList(),this.list_base.height=this.list_base.contentHeight+10,this.list_melt.height=this.list_melt.contentHeight+10},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:this.close(),this.visible=!1;break;case this.btn_get:UtilProxy.openView(41,0);break;case this.btn_lvup:if(this.next_data){var e=this.next_data.item[1],i=BagProxy.ins().getItemCountById(this.next_data.item[0]),n=this.next_data.item_replace>0?BagProxy.ins().getItemCountById(this.next_data.item_replace):0;i+n>=e?FabaoProxy.ins().C2SReqFabaoUpgrade(this.id):TipsControl.ins().showTips("道具不足!")}else TipsControl.ins().showTips("已经满级")}},e.prototype.getMeltList=function(){var t=GlobalConfig.getFabaoMeltById(this.id),e=new eui.ArrayCollection;for(var i in t)for(var n=AttrProxy.getAttrInfo(t[i]),o=0;o<n.length;o++){var s=this.cur_lv>=t[i].level?!0:!1;e.addItem({name:n[o][2],value:n[o][1],level:t[i].level,active:s})}return e},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FabaoTipsView.prototype,"FabaoTipsView"),window.FabaoTipsView=FabaoTipsView;var FabaoView=function(t){function e(){var e=t.call(this)||this;return e.menu_data_list=[],e.skinName="FabaoViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.panel_tips.initUI(),this.list.itemRenderer=FabaoItem,this.menu_list=[{btn:this.menu0,bg:this.bg0,sp:this.sp0,name:this.name0},{btn:this.menu1,bg:this.bg1,sp:this.sp1,name:this.name1},{btn:this.menu2,bg:this.bg2,sp:this.sp2,name:this.name2},{btn:this.menu3,bg:this.bg3,sp:this.sp3,name:this.name3}],this.obj_list=[this.menu0,this.menu1,this.menu2,this.menu3],this.btn_list=[this.btn0,this.btn1,this.btn2],this.red_menu_list=[];for(var e=0;e<this.menu_list.length;e++)this.red_menu_list[e]=this.obj_list[e].getChildAt(3);this.red_btn0=this.btn0.getChildAt(2),this.red_btn1=this.btn1.getChildAt(2),this.txt_remark.textFlow=UtilProxy.StrFormart("C:4&收集或升级灵宝提升道行值",[]),this.red_fabao=this.btn0.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),this.comview.SetName("title_lingbao");for(var n=0;n<this.menu_list.length;n++)this.addTouchEvent(this.menu_list[n].btn,this.onClick);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onMuBtnClick);this.addItemTapEvent(this.list,this.onListItemTap),this.addTouchEvent(this.btn_close,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFabaoUpdateFabao,this.onFabaoUpdate),EventProxy.AddListener(this,EventType.S2CRepFabaoUpdateJingjie,this.onJjUpdate);var o=e[0]||0;this.updateMenuList(o),this.updateInfo(),this.openMenu(o,0),this.updateMenuRed(o),this.red_fabao.visible=FabaoProxy.ins().getRed(),this.red_btn0.visible=FabaoProxy.ins().getRedByType(1),this.red_btn1.visible=FabaoProxy.ins().getRedByType(2),this.btn2.getChildAt(2).visible=FabaoProxy.ins().getSuitRed(),this.CheckGuide()},e.prototype.updateMenuRed=function(t){for(var e=0;e<this.red_menu_list.length;e++)this.red_menu_list[e].visible=FabaoProxy.ins().getRedByMenuId(t+1,e+1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.menu_list.length;i++)this.removeTouchEvent(this.menu_list[i].btn,this.onClick);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onMuBtnClick);this.removeItemTapEvent(this.list,this.onListItemTap),this.removeTouchEvent(this.btn_close,this.onCloseClick),this.removeTouchEvent(this.btn1,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepFabaoUpdateFabao,this.onFabaoUpdate),EventProxy.RemoveListener(this,EventType.S2CRepFabaoUpdateJingjie,this.onJjUpdate)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onClick=function(t){var e=this.obj_list.indexOf(t.currentTarget);this.openMenu(this.select_type,e)},e.prototype.onMuBtnClick=function(t){var i=this.btn_list.indexOf(t.currentTarget);return 2==i?(ViewManager.ins().close(e),void ViewManager.ins().open(FbSuitView)):void(-1!=i&&(this.updateMenuList(i),this.openMenu(i,0),this.updateMenuRed(i)))},e.prototype.updateMenuList=function(t){for(var e=this.getMenuList(t),i=0;i<e.length;i++){var n=e[i];this.menu_list[i].sp.source=n.img,this.menu_list[i].name.text=n.name,this.menu_list[i].sp.visible=!0,this.menu_list[i].bg.visible=!1}},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;this.cur_item=e,void 0!=e&&(this.panel_tips.visible=!0,this.panel_tips.open(e.data))},e.prototype.updateInfo=function(){this.txt_fight.text=FabaoProxy.ins().getFight().toString();var t=FabaoProxy.ins().getJjLv();this.cur_jj=GlobalConfig.getFabaoJjById(t),this.next_jj=GlobalConfig.getFabaoJjById(t+1),this.cur_jj&&(this.txt_name.text=this.cur_jj.name,this.txt_limit.text="",this.txt_hurt.textFlow=UtilProxy.StrFormart("仙术伤害：|C:7&@0 %",[this.cur_jj.skill_damage_per/100]),this.txt_cd.textFlow=UtilProxy.StrFormart("仙术冷却：|C:7&@0 %",[this.cur_jj.skill_cd_per/100]),this.next_jj?(this.process.maximum=this.next_jj.magic,this.process.value=FabaoProxy.ins().getMagicValue()):(this.process.maximum=this.cur_jj.magic,this.process.value=this.cur_jj.magic))},e.prototype.openMenu=function(t,e){this.select_bg&&(this.select_bg.visible=!1),this.select_bg=this.menu_list[e].bg,this.select_bg.visible=!0,this.select_type=t,this.select_page=e,this.array&&(this.array.removeAll(),this.array=null),this.updateList(),this.btn0.icon=0==this.select_type?"common_btn_big_yellow":"common_btn_big_yellow_off",this.btn1.icon=0!=this.select_type?"common_btn_big_yellow":"common_btn_big_yellow_off"},e.prototype.updateList=function(){if(this.array){var t=FabaoProxy.ins().getList(this.select_type+1,this.select_page+1);this.array.replaceAll(t)}else{this.array=new eui.ArrayCollection,this.list.dataProvider=this.array;for(var t=FabaoProxy.ins().getList(this.select_type+1,this.select_page+1),e=0;e<t.length;e++)this.array.addItem(t[e])}},e.prototype.getMenuList=function(t){var e=GlobalConfig.getFabaoMisc(t+1);if(e){this.menu_data_list=[];for(var i=0;i<e.type_name.length;i++)this.menu_data_list.push({name:e.type_name[i],img:e.type_img[i]})}return this.menu_data_list},e.prototype.onFabaoUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[1]&&1==t[1]){var i=UtilProxy.GetMovieClipById(88,this.gp_main);i.x=240,i.y=400}this.cur_item&&this.updateList(),this.panel_tips.visible&&this.panel_tips.updateInfo(),this.red_fabao.visible=FabaoProxy.ins().getRed(),this.red_btn0.visible=FabaoProxy.ins().getRedByType(1),this.red_btn1.visible=FabaoProxy.ins().getRedByType(2),this.updateMenuRed(this.select_type),this.btn2.getChildAt(2).visible=FabaoProxy.ins().getSuitRed()},e.prototype.onJjUpdate=function(){this.updateInfo()},e.prototype.onMoneyUpdate=function(t){void 0!=t&&(t==MoneyAttr.COIN||t==MoneyAttr.YUANBAO||t==MoneyAttr.ZMXZ)},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FabaoView.prototype,"FabaoView"),ViewManager.ins().reg(FabaoView,LayerManager.UI_Main),window.FabaoView=FabaoView;var FbProcessItem=function(t){function e(){var e=t.call(this)||this;return e.full_width=78,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setValue=function(t,e,i){var n=t/i*this.full_width,o=e/i*this.full_width;this.p_0.width=n>this.full_width?this.full_width:n,this.p_1.width=n+o>this.full_width?this.full_width:n+o,this.p_value.text=t+e+"/"+i},e}(BaseEuiView);__reflect(FbProcessItem.prototype,"FbProcessItem"),window.FbProcessItem=FbProcessItem;var FbSuitItem1=function(t){function e(){var e=t.call(this)||this;return e.colorids=[6,8,9,4],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="FBSuitItem1Skin"},e.prototype.dataChanged=function(){var t=this.data,e="未激活",i=FabaoProxy.ins().GetSuitLevel(t.id);i>0&&(e=i+"阶"),this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 (@2 )：|",[this.colorids[t.type-1],t.name,e]);var n=GlobalConfig.getFabao_suit_dataConfigById(t.id,0==i?1:i);this.prolab1.text=UtilProxy.StrFormartStr("全属性 +@0 %",[n.fabao_attr_per/100]);var o="",s=AttrProxy.getAttrInfo(n);if(void 0!=s)for(var r=0;r<s.length;r++)o+=UtilProxy.getStr("@0  +@1   ",[s[r][2],s[r][1]]);this.prolab2.textFlow=UtilProxy.generateTextFlow(o),UtilProxy.SetAshColor(this.bg,0==i)},e}(BaseItemRender);__reflect(FbSuitItem1.prototype,"FbSuitItem1"),window.FbSuitItem1=FbSuitItem1;var FbSuitItem2=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.haslab.textFlow=UtilProxy.generateTextFlow("|C:7&已满阶|")},e.prototype.setSkinName=function(){this.skinName="FBSuitItem2Skin"},e.prototype.dataChanged=function(){var t=this.data;this.pic1.source="lingbaotaozhaung_biaoqian_0"+t.type,this.pic2.source="lingbao_biaoqian_0"+t.type;var e="未激活",i=FabaoProxy.ins().GetSuitLevel(t.id);i>0&&(e=i+"阶"),this.namelab.textFlow=UtilProxy.StrFormart("@0      |C:10&(@1 )|",[t.name,e]);var n=GlobalConfig.getFabao_suit_dataConfigById(t.id,0==i?1:i);this.prolab1.textFlow=UtilProxy.StrFormart("|C:7&全属性 +@0 %|",[n.fabao_attr_per/100]);var o="",s=AttrProxy.getAttrInfo(n);if(void 0!=s)for(var r=0;r<s.length;r++)o+=UtilProxy.getStr("|C:7&@0 +@1 |  ",[s[r][2],s[r][1]]);this.prolab2.textFlow=UtilProxy.generateTextFlow(o);var a=FabaoProxy.ins().GetSuitState(t.id);this.btn.visible=2!=a,this.haslab.visible=2==a,this.btn.setRed(0==a),this.btn.label=i>0?"套装升级":"套装激活",UtilProxy.SetAshColor(this.pic1,0==i),UtilProxy.SetAshColor(this.pic2,0==i);for(var h=GlobalConfig.getFabao_suit_dataConfigById(t.id,i+1)||n,r=0;r<this.itemlist.numChildren;r++){var l=this.itemlist.getChildAt(r);l.visible=void 0!=h.fabao_list[r],h.fabao_list[r]&&this.SetTujianItem(l,h.fabao_list[r][0],h.fabao_list[r][1])}},e.prototype.SetTujianItem=function(t,e,i){var n=GlobalConfig.getFabaoById(e,1);if(void 0!=n){var o=t.getChildAt(1),s=t.getChildAt(0),r=FabaoProxy.ins().getFabaoLv(e);o.textFlow=UtilProxy.StrFormart("|C:@0 &Lv.@1 /@2 |",[r>=i?7:4,r,i]),s.data=UtilProxy.GetItemCellData(n.item[0],1),UtilProxy.SetAshColor(s,0==r)}},e.prototype.onClick=function(t){var e=this.data,i=FabaoProxy.ins().GetSuitState(e.id),n=FabaoProxy.ins().GetSuitLevel(e.id);return 1==i?void(n>0?TipsControl.ins().showTips("该套装中部分灵宝等级不足，套装无法升阶！"):TipsControl.ins().showTips("该套装中部分灵宝未获得，套装无法激活！")):(FabaoProxy.ins().C2SReqFabaoFabaoSuitUpgrade(e.id),void t.stopImmediatePropagation())},e}(BaseItemRender);__reflect(FbSuitItem2.prototype,"FbSuitItem2"),window.FbSuitItem2=FbSuitItem2;var FbSuitProTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TreasureTips1Skin",this.tipsname.textFlow=UtilProxy.generateTextFlow("|C:10&套装总属性|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&常规属性|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){this.CloseView()},e.prototype.CloseView=function(){ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){this.zhanValue.text=FabaoProxy.ins().GetSuitTotleFight().toString();var t="",e=AttrProxy.getAttrInfo(FabaoProxy.ins().GetSuitTotlePro());if(void 0!=e)for(var i=0;i<e.length;i++)""==t?t=UtilProxy.getStr("@0 |C:7&+@1 |",[e[i][0],e[i][1]]):t+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[e[i][0],e[i][1]]);this.prolab.textFlow=UtilProxy.generateTextFlow(t)},e}(BaseEuiView);__reflect(FbSuitProTips.prototype,"FbSuitProTips"),ViewManager.ins().reg(FbSuitProTips,LayerManager.UI_Main2),window.FbSuitProTips=FbSuitProTips;var FbSuitView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FBSuitViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_lingbaotaozhuang"),this.list1.itemRenderer=FbSuitItem1,this.sv1.viewport=this.list1,this.list2.itemRenderer=FbSuitItem2,this.sv2.viewport=this.list2,this.btn_list=[this.btn0,this.btn1,this.btn2],this.menus=[this.menu1,this.menu2,this.menu3,this.menu4],this.title.textFlow=UtilProxy.generateTextFlow("|C:10&套装预览|")},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),this.addTouchEvent(this.btn_close,this.onCloseClick),this.addTouchEvent(this.infobtn,this.onProClick);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onbtnClick);for(var o=GlobalConfig.getFabaoMisc(3),n=0;n<this.menus.length;n++){this.addTouchEvent(this.menus[n],this.onMenuClick),this.menus[n].getChildAt(0).visible=!1,this.menus[n].getChildAt(2).visible=FabaoProxy.ins().GetSuitRedByType(n+1);var s=this.menus[n].getChildAt(1);o&&o.type_name[n]&&(s.text=o.type_name[n])}EventProxy.AddListener(this,EventType.S2CRepFabaoFabaoSuitUpgrade,this.ShowEffect),this.btn0.getChildAt(2).visible=FabaoProxy.ins().getRedByType(1),this.btn1.getChildAt(2).visible=FabaoProxy.ins().getRedByType(2),void 0==this.curmenu&&(this.curmenu=this.menus[0],this.curmenu.getChildAt(0).visible=!0),this.ShowInfo(),this.CheckGuide()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.btn_close,this.onCloseClick),this.removeTouchEvent(this.infobtn,this.onProClick);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onbtnClick);for(var i=0;i<this.menus.length;i++)this.removeTouchEvent(this.menus[i],this.onMenuClick);EventProxy.RemoveListener(this,EventType.S2CRepFabaoFabaoSuitUpgrade,this.ShowEffect)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onProClick=function(t){ViewManager.ins().open(FbSuitProTips)},e.prototype.onbtnClick=function(t){var e=this.btn_list.indexOf(t.currentTarget);2!=e&&-1!=e&&(ViewManager.ins().close(this),ViewManager.ins().open(FabaoView,e))},e.prototype.onMenuClick=function(t){this.curmenu&&(this.curmenu.getChildAt(0).visible=!1),this.curmenu=t.currentTarget,this.curmenu.getChildAt(0).visible=!0,this.ShowMenuInfo()},e.prototype.ShowEffect=function(t){t?UtilProxy.GetMovieClipById(88,this.effect):UtilProxy.GetMovieClipById(20,this.effect),this.ShowInfo()},e.prototype.ShowInfo=function(){this.txt_fight.text=FabaoProxy.ins().GetSuitTotleFight().toString();var t=this.menus.indexOf(this.curmenu)+1;this.curmenu.getChildAt(2).visible=FabaoProxy.ins().GetSuitRedByType(t),this.btn2.getChildAt(2).visible=FabaoProxy.ins().getSuitRed(),this.ShowMenuInfo()},e.prototype.ShowMenuInfo=function(){var t=this.menus.indexOf(this.curmenu)+1;this.arraylist1||(this.arraylist1=new eui.ArrayCollection,this.list1.dataProvider=this.arraylist1);var e=FabaoProxy.ins().GetSuitList(t);this.arraylist1.removeAll();for(var i in e)this.arraylist1.addItem(e[i]);this.arraylist2||(this.arraylist2=new eui.ArrayCollection,this.list2.dataProvider=this.arraylist2),this.arraylist2.removeAll();for(var i in e)this.arraylist2.addItem(e[i])},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FbSuitView.prototype,"FbSuitView"),ViewManager.ins().reg(FbSuitView,LayerManager.UI_Main),window.FbSuitView=FbSuitView;var FbTipsItem1=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){void 0!=this.data&&(this.cur_name.text=this.data.name,this.cur_value.text="+"+this.data.value_cur,this.next_name.textFlow=UtilProxy.StrFormart("C:7&@0 ",[this.data.name]),this.next_value.textFlow=UtilProxy.StrFormart("C:7&+@0 ",[this.data.value_next]),this.sp.visible=0==this.data.index)},e}(BaseItemRender);__reflect(FbTipsItem1.prototype,"FbTipsItem1"),window.FbTipsItem1=FbTipsItem1;var FbTipsItem2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){void 0!=this.data&&(this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[this.data.active?7:3,this.data.name]),this.txt_value.textFlow=UtilProxy.StrFormart("C:@0 &+@1 ",[this.data.active?7:3,this.data.value]),this.data.active?this.txt_lock.text="":this.txt_lock.textFlow=UtilProxy.StrFormart("C:@0 &@1 级激活",[4,this.data.level]))},e}(BaseItemRender);__reflect(FbTipsItem2.prototype,"FbTipsItem2"),window.FbTipsItem2=FbTipsItem2;var FacJoinView=function(t){function e(){var e=t.call(this)||this;return e.param=[{p0:0,p1:232,p2:322,v0:!0,v1:!1,v2:!1},{p0:0,p1:93,p2:322,v0:!1,v1:!0,v2:!1},{p0:0,p1:93,p2:185,v0:!1,v1:!1,v2:!0}],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this);var e=GlobalConfig.getFacMisc();if(e&&e.recommend_award&&e.recommend_award&&e.recommend_award.length>0){var i=e.recommend_award[0][0],n=e.recommend_award[0][1],o=GlobalConfig.getItemsConfig(i).name;this.txt_cost0.text=this.txt_cost1.text=this.txt_cost2.text=o+":",this.txt_value0.text=this.txt_value1.text=this.txt_value2.text=n.toString()}},e.prototype.open=function(){var t=this;this.addTouchEvent(this.page0,this.onClick),this.addTouchEvent(this.page1,this.onClick),this.addTouchEvent(this.page2,this.onClick),this.addTouchEvent(this.btn_go,this.onClick),this.page_list=[this.page0,this.page1,this.page2],this.sort_list=[[this.page1,this.page2,this.page0],[this.page0,this.page2,this.page1],[this.page0,this.page1,this.page2]],this.updateInfo(),this.CheckGuide(),TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e.prototype.close=function(){this.removeTouchEvent(this.page0,this.onClick),this.removeTouchEvent(this.page1,this.onClick),this.removeTouchEvent(this.page2,this.onClick),this.removeTouchEvent(this.btn_go,this.onClick)},e.prototype.updateInfo=function(){var t=FacProxy.ins().getRecommonedId();this.cur_id=t,this.onSelectPage(t)},e.prototype.onClick=function(t){if(t.currentTarget==this.btn_go)return void FacProxy.ins().C2SReqFactionJoin(this.cur_id);var e=this.page_list.indexOf(t.currentTarget);e>=0&&e==this.cur_id-1?this.onSelectPage(e+1):TipsControl.ins().showTips("该宗派当前人数爆满，请选择其他宗派加入！")},e.prototype.onSelectPage=function(t){var e=this.sort_list,i=this.param[t-1];i&&(this.page0.x=i.p0,this.page1.x=i.p1,this.page2.x=i.p2,this.cost0.visible=this.select0.visible=i.v0,this.cost1.visible=this.select1.visible=i.v1,this.cost2.visible=this.select2.visible=i.v2,this.panelComtainer.setChildIndex(e[t-1][0],99),this.panelComtainer.setChildIndex(e[t-1][1],99),this.panelComtainer.setChildIndex(e[t-1][2],99)),this.txt_own.textFlow=UtilProxy.StrFormart("C:10&现在掌门|C:1&    暂无",[]),this.txt_remark.text=GlobalConfig.getFacMisc().remark[t-1]},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(500,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FacJoinView.prototype,"FacJoinView"),window.FacJoinView=FacJoinView;var FacJxView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){this.btn0_red=this.btn0.getChildAt(2),this.btn1_red=this.btn1.getChildAt(2),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn0,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.addTouchEvent(this.btn_go,this.onClick),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&捐献",[]),this.title_0.textFlow=UtilProxy.StrFormart("C:10&铜钱捐献",[]),this.title_1.textFlow=UtilProxy.StrFormart("C:10&元宝捐献",[]);var t=GlobalConfig.getFacMisc();t&&(this.data=t,this.text0.text="宗派勋章:",this.text1.text="宗派勋章:",this.text2.text="声望:",this.text3.text="声望:",this.text0.text="宗派勋章:",this.value2.text=t.coin_contribute_award[0][1],this.value3.text=t.yb_contribute_award[0][1]),this.updateInfo()},e.prototype.close=function(){this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn0,this.onClick),this.removeTouchEvent(this.btn1,this.onClick),this.removeTouchEvent(this.btn_go,this.onClick)},e.prototype.updateInfo=function(){if(this.data){var t=FacProxy.ins().getCoinTmes(),e=FacProxy.ins().getYuanbaoTimes(),i=RoleProxy.ins().getMoneyAttr(MoneyAttr.COIN),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO),o=(BagProxy.ins().getItemCountById(MoneyAttr.ZMXZ),i>=this.data.coin_contribute_need?7:4),s=n>=this.data.yb_contribute_need?7:4;this.m_value0.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[o,this.data.coin_contribute_need]),this.m_value1.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[s,this.data.yb_contribute_need]),this.value4.text=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG).toString();var r=this.btn0.getChildAt(1),a=this.btn1.getChildAt(1);if(r){var h=t>=this.data.coin_contribute_num?4:7;r.textFlow=UtilProxy.StrFormart("捐献|C:@0 &(@1 /@2 ) ",[h,this.data.coin_contribute_num-t,this.data.coin_contribute_num]),this.btn0_red.visible=this.data.coin_contribute_num>t}if(a){var h=e>=this.data.yb_contribute_num?4:7;a.textFlow=UtilProxy.StrFormart("捐献|C:@0 &(@1 /@2 ) ",[h,this.data.yb_contribute_num-e,this.data.yb_contribute_num]),this.btn1_red.visible=this.data.yb_contribute_num>e}}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:this.close(),this.visible=!1;break;case this.btn0:if(FacProxy.ins().getCoinTmes()>=this.data.coin_contribute_num)return void TipsControl.ins().showTips("捐献次数不足!");if(RoleProxy.ins().getMoneyAttr(MoneyAttr.COIN)<this.data.coin_contribute_need)return void TipsControl.ins().showTips("金币不足");FacProxy.ins().C2SReqFactionContribute(1);break;case this.btn1:if(FacProxy.ins().getYuanbaoTimes()>=this.data.yb_contribute_num)return void TipsControl.ins().showTips("捐献次数不足!");if(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<this.data.yb_contribute_need)return void TipsControl.ins().showTips("元宝不足");FacProxy.ins().C2SReqFactionContribute(2);break;case this.btn_go:UtilProxy.openView(27,0)}},e}(BaseEuiView);__reflect(FacJxView.prototype,"FacJxView"),window.FacJxView=FacJxView;var FacMainView=function(t){function e(){var e=t.call(this)||this;return e.title_list=["zongmen_biaoqian01","zongmen_biaoqian02","zongmen_biaoqian03"],e.name_list=["zhangmen_font_01","zhangmen_font_02","zhangmen_font_03"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){this.addTouchEvent(this.btn0,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.addTouchEvent(this.btn2,this.onClick),this.addTouchEvent(this.btn3,this.onClick),this.addTouchEvent(this.btn4,this.onClick),this.addTouchEvent(this.btn5,this.onClick),EventProxy.AddListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.updateInfo),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.updateInfo),EventProxy.AddListener(this,EventType.S2CRepFactionContribute,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.updateInfo),this.updateInfo(),this.CheckGuide()},e.prototype.close=function(){this.removeTouchEvent(this.btn0,this.onClick),this.removeTouchEvent(this.btn1,this.onClick),this.removeTouchEvent(this.btn2,this.onClick),this.removeTouchEvent(this.btn3,this.onClick),this.removeTouchEvent(this.btn4,this.onClick),this.removeTouchEvent(this.btn5,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.updateInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.updateInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionContribute,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.updateInfo)},e.prototype.SetFacRed=function(){this.jx_red.visible=FacProxy.ins().getJxRed()},e.prototype.updateInfo=function(){var t=FacProxy.ins().getFacId();this.img_sp.source=this.title_list[t-1],this.img_name.source=this.name_list[t-1];FacProxy.ins().getMainRoleId();if(this.btn0.getChildAt(2).visible=FacFightProxy.ins().getRed(),this.btn3.getChildAt(2).visible=LunjianProxy.ins().getRed(),this.btn5.getChildAt(2).visible=1==ZPZBProxy.ins().daily_award,FacProxy.ins().hasLeader()){this.sp_active.visible=!1;var e=FacProxy.ins().leader_info;e&&(e.reputation>0?this.txt_title.textFlow=UtilProxy.StrFormart("C:10&[@0 @1 阶]@2 ",[FacProxy.ins().getFacName(),e.reputation,TitleProxy.ins().getShengwangName(e.reputation,t)]):this.txt_title.textFlow=UtilProxy.StrFormart("C:10&@0 ",[FacProxy.ins().getFacName()]),this.txt_name.text=e.name,this.txt_lv.textFlow=UtilProxy.StrFormart("等级：@0 ",[e.level]),this.txt_fight.textFlow=UtilProxy.StrFormart("战斗力：@0 ",[e.fighting])),this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(e.fashion,void 0,e.shenbing,void 0,e.prof))}else this.sp_active.visible=!0,this.txt_title.text="虚位以待",this.txt_name.text="",this.txt_lv.text="",this.txt_fight.text="";this.jx_red.visible=FacProxy.ins().getJxRed()},e.prototype.onClick=function(t){var e=ViewManager.ins().getView(FacView);if(e)switch(t.currentTarget){case this.btn0:ViewManager.ins().open(FacFightView);break;case this.btn1:e.openWin(1);break;case this.btn2:UtilProxy.openView(42,1);break;case this.btn3:ViewManager.ins().open(LunjianView);break;case this.btn4:e.openWin(2);break;case this.btn5:ViewManager.ins().open(ZPZBMainView)}},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FacMainView.prototype,"FacMainView"),window.FacMainView=FacMainView;var FacMbItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(void 0!=this.data){var t="暂无",e=GlobalConfig.getReputation_dataConfig(this.data.title);this.data.title>0&&e&&(t=e.name[FacProxy.ins().getFacId()]||"暂无"),this.data.role_id==RoleProxy.ins().getRoleId()?(this.title.textFlow=UtilProxy.StrFormart("C:6&@0 ",[t]),this.role_name.textFlow=UtilProxy.StrFormart("C:6&S@0 .@1 ",[this.data.server_id,this.data.name]),this.fight.textFlow=UtilProxy.StrFormart("C:6&@0 ",[this.data.fighting])):(this.title.text=t,this.role_name.text="S"+this.data.server_id+"."+this.data.name,this.fight.text=this.data.fighting)}},e}(BaseItemRender);__reflect(FacMbItem.prototype,"FacMbItem"),window.FacMbItem=FacMbItem;var FacMemberView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){this.list.itemRenderer=FacMbItem,this.addTouchEvent(this.btn_close,this.onClick);for(var t=FacProxy.ins().getMemberList(),e=new eui.ArrayCollection,i=0;i<t.length;i++){var n=t[i],o=new FacMemberItem;o.fighting=n.fighting,o.level=n.level,o.name=n.name,o.prof=n.prof,o.role_id=n.role_id,o.server_id=n.server_id,o.title=n.title,o.vip_level=n.vip_level,e.addItem(o)}this.list.dataProvider=e},e.prototype.close=function(){this.removeTouchEvent(this.btn_close,this.onClick)},e.prototype.onClick=function(t){this.close(),this.visible=!1},e}(BaseEuiView);__reflect(FacMemberView.prototype,"FacMemberView"),window.FacMemberView=FacMemberView;var FacShopView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e}(BaseEuiView);__reflect(FacShopView.prototype,"FacShopView"),window.FacShopView=FacShopView;var FacView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FacViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.panel_join.initUI(),this.panel_main.initUI(),this.panel_member.initUI(),this.panel_jx.initUI()},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),this.addTouchEvent(this.btn_close,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFactionJoin,this.OnJoinCallBack),EventProxy.AddListener(this,EventType.UpdataMoney,this.onMoneyUpdate),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.onBagUpdate),this.updateInfo(),GuideProxy.ins().RemoveFacGuide(),FacProxy.ins().checkSendReqMb()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.btn_close,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionJoin,this.OnJoinCallBack),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.onMoneyUpdate),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.onBagUpdate),this.panel_join.close(),this.panel_member.close(),this.panel_jx.close(),this.panel_main.close()
},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.updateInfo=function(){this.panel_jx.visible=!1,this.panel_member.visible=!1;var t=FacProxy.ins().getFacId()>0;this.panel_join.visible=!t,this.panel_main.visible=t,t?(this.panel_main.open(),this.comview.SetName("title_zongpai")):(this.panel_join.open(),this.comview.SetName("title_zongpai"))},e.prototype.OnJoinCallBack=function(){this.panel_join.visible=!1,this.panel_join.close(),this.panel_main.visible=!0,this.panel_main.open()},e.prototype.onMoneyUpdate=function(t){void 0!=t&&(t==MoneyAttr.COIN||t==MoneyAttr.YUANBAO||t==MoneyAttr.ZMXZ)&&this.panel_jx.visible&&this.panel_jx.updateInfo()},e.prototype.onBagUpdate=function(){this.panel_jx.visible&&this.panel_jx.updateInfo()},e.prototype.openWin=function(t){1==t?(this.panel_member.visible=!0,this.panel_member.open()):2==t&&(this.panel_jx.visible=!0,this.panel_jx.open())},e}(BaseEuiView);__reflect(FacView.prototype,"FacView"),ViewManager.ins().reg(FacView,LayerManager.UI_Main),window.FacView=FacView;var FacFightView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FacFightSkin",this.comview.initUI(),this.comview.SetName("title_zongzhu"),this.btns=[this.mobai1,this.mobai2,this.mobai3];var e=GlobalConfig.getLeader_battle_base_dataConfig(1),i=UtilProxy.StrFormartStr(e.leader_dec,[FacProxy.ins().getFacName()]),n=UtilProxy.StrFormartStr(e.other_dec,[FacProxy.ins().getFacName()]);this.lab1.textFlow=UtilProxy.generateTextFlow(i),this.lab2.textFlow=UtilProxy.generateTextFlow(n)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onbtnClick),this.addTouchEvent(this.addbtn,this.onbtnClick),this.addTouchEvent(this.rankbtn,this.onbtnClick),this.addTouchEvent(this.btn0,this.onbtnClick),this.addTouchEvent(this.btn1,this.onbtnClick),this.addTouchEvent(this.btn2,this.onbtnClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onMobaiClick);this.addChangeEvent(this.aotubtn,this.selectChange),EventProxy.AddListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionGetBattleRanklist,this.ShowInfo1),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionMoBai,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateTopobjInfo,this.ShowInfo),(1==FacFightProxy.ins().is_open||0==FacFightProxy.ins().top_list.length)&&FacFightProxy.ins().C2SReqFactionGetBattleRanklist(),FacFightProxy.ins().C2SReqFactionGetLeaderBattleInfo(),FacFightProxy.ins().left_challenge_times<=0&&(FacFightProxy.ins().IsAotu=!1),this.aotubtn.selected=FacFightProxy.ins().IsAotu,this.ShowInfo(),FacFightProxy.ins().IsAotu&&this.ShowPipei(),FacFightProxy.ins().IsShowRed&&(FacFightProxy.ins().IsShowRed=!1,EventProxy.Broast(EventType.S2CRepFactionGetLeaderBattleInfo,{})),ViewManager.ins().close(FacView)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onbtnClick),this.removeTouchEvent(this.addbtn,this.onbtnClick),this.removeTouchEvent(this.rankbtn,this.onbtnClick),this.removeTouchEvent(this.btn0,this.onbtnClick),this.removeTouchEvent(this.btn1,this.onbtnClick),this.removeTouchEvent(this.btn2,this.onbtnClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onMobaiClick);this.aotubtn.removeEventListener(egret.Event.CHANGE,this.selectChange,this),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){switch(t.currentTarget){case this.btn:if(!UtilProxy.IsCanTranScene())return void TipsControl.ins().showTips("当前场景不能进行挑战");if(FacFightProxy.ins().left_challenge_times<=0)return void TipsControl.ins().showTips("挑战次数不足");LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),ViewManager.ins().open(PipeiView,PvpType.FAC_FIGHT);break;case this.addbtn:this.ShowAddCount();break;case this.rankbtn:ViewManager.ins().open(FFRankView);break;case this.btn0:ViewManager.ins().open(FFAwardView);break;case this.btn1:ViewManager.ins().open(FFAppointView);break;case this.btn2:TipsControl.ins().showTips("功能开发中")}},e.prototype.onMobaiClick=function(t){var e=GlobalConfig.getLeader_battle_base_dataConfig(1).mobai_count;if(FacFightProxy.ins().mobai_count>=e)return void TipsControl.ins().showTips("膜拜次数不足");var i=this.btns.indexOf(t.currentTarget)+1;FacFightProxy.ins().C2SReqFactionMoBai(i)},e.prototype.selectChange=function(t){return UtilProxy.IsCanTranScene()?FacFightProxy.ins().left_challenge_times<=0?(TipsControl.ins().showTips("挑战次数不足"),void(FacFightProxy.ins().IsAotu=this.aotubtn.selected=!1)):(FacFightProxy.ins().IsAotu=this.aotubtn.selected,this.SetBtn(),void(FacFightProxy.ins().IsAotu&&(LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),ViewManager.ins().open(PipeiView,PvpType.FAC_FIGHT)))):(TipsControl.ins().showTips("当前场景不能进行挑战"),void(FacFightProxy.ins().IsAotu=this.aotubtn.selected=!1))},e.prototype.ShowInfo=function(){this.group1.visible=1==FacFightProxy.ins().is_open||0==FacFightProxy.ins().top_list.length,this.group2.visible=0==FacFightProxy.ins().is_open&&FacFightProxy.ins().top_list.length>0,this.grouptz.visible=1==FacFightProxy.ins().is_open,1==FacFightProxy.ins().is_open||0==FacFightProxy.ins().top_list.length?this.ShowInfo1():this.ShowInfo2(),this.ShowModelInfo(),this.ShowColdTime()},e.prototype.ShowInfo1=function(){this.lab.textFlow=UtilProxy.StrFormart("我的排名：|C:7&@0 |",[FacFightProxy.ins().rank>0?FacFightProxy.ins().rank:"未上榜"]);var t=GlobalConfig.getLeader_battle_base_dataConfig(1).challenge_num;this.countlab.textFlow=UtilProxy.StrFormart("|C:10&挑战次数：||C:@0 &@1 /@2 |",[FacFightProxy.ins().left_challenge_times>0?7:4,FacFightProxy.ins().left_challenge_times,t]),FacFightProxy.ins().left_challenge_times<t?(TimerManager.ins().remove(this.SetCountTimeLab,this),this.SetCountTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetCountTimeLab,this)):(this.timelab.text="",TimerManager.ins().remove(this.SetCountTimeLab,this)),this.SetBtn()},e.prototype.SetCountTimeLab=function(){var t=FacFightProxy.ins().next_recover_time,e=GameLogic.ins().getServerTime();t>e?this.timelab.textFlow=UtilProxy.StrFormart("|C:7&@0 后恢复1次|",[UtilProxy.getTimeHMSString_1(t-e)]):(this.timelab.text="",TimerManager.ins().remove(this.SetCountTimeLab,this),FacFightProxy.ins().IsAotu=!1,this.aotubtn.selected=FacFightProxy.ins().IsAotu,this.SetBtn())},e.prototype.SetBtn=function(){this.btn.visible=0==FacFightProxy.ins().IsAotu},e.prototype.ShowInfo2=function(){var t=GlobalConfig.getLeader_battle_base_dataConfig(1).mobai_count;this.lab.textFlow=UtilProxy.StrFormart("膜拜次数：|C:@0 &@1 /@2 |",[FacFightProxy.ins().mobai_count>=t?4:7,t-FacFightProxy.ins().mobai_count,t])},e.prototype.ShowModelInfo=function(){this.SetModelInfo(this.info1,1),this.SetModelInfo(this.info2,2),this.SetModelInfo(this.info3,3)},e.prototype.SetModelInfo=function(t,e){var i=this.chenghaos.getChildAt(e-1),n=GlobalConfig.getLeader_battle_title_dataConfig(e);if(i.visible=n.title[FacProxy.ins().getFacId()-1]>0,n.title[FacProxy.ins().getFacId()-1]>0){var o=GlobalConfig.getTitleById(n.title[FacProxy.ins().getFacId()-1]);i.source=TitleProxy.title_icon_path+o.title_res+".png"}var s=FacFightProxy.ins().getTopDate(e);t.getChildAt(1).visible=1!=FacFightProxy.ins().is_open&&void 0!=s;var r=t.getChildAt(2);r.visible=void 0!=s;var a=t.getChildAt(3),h=t.getChildAt(4);h.visible=void 0!=s;var l=t.getChildAt(5);l.visible=1!=FacFightProxy.ins().is_open&&void 0!=s;var p=this.models.getChildAt(e-1),c=this.pics.getChildAt(e-1);p.visible=void 0!=s,c.visible=void 0==s,s?(r.textFlow=UtilProxy.StrFormart("|C:4&[@0 ]@1 |",[TitleProxy.ins().getShengWanglvlName(s.touxian_level,s.faction),TitleProxy.ins().getShengwangName(s.touxian_level,s.faction)]),1==FacFightProxy.ins().is_open?(a.textFlow=UtilProxy.StrFormart("候选人：|C:5&@0 |",[s.name]),h.textFlow=UtilProxy.StrFormart("净胜场：|C:7&@0 |",[s.win_count])):(a.text=UtilProxy.getStr("@0 ",[s.name]),h.textFlow=UtilProxy.StrFormart("战力：|C:7&@0 |",[s.fight]),l.textFlow=UtilProxy.StrFormart("被膜拜|C:7&@0 |次",[s.mobai_count])),p.removeChildren(),p.addChild(UtilProxy.GetRoleObjectById(s.fashion,0,s.shenbing,void 0,s.prof))):a.text="虚位以待"},e.prototype.ShowColdTime=function(){TimerManager.ins().remove(this.SetTimeLab,this),this.SetTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)},e.prototype.SetTimeLab=function(){var t=FacFightProxy.ins().next_time,e=GameLogic.ins().getServerTime();if(t>e){var i=UtilProxy.getTimeStr(t-e);this.tips.textFlow=0==FacFightProxy.ins().is_open?UtilProxy.StrFormart("|C:7&下一次宗主争夺战@0 后开启|",[i]):UtilProxy.StrFormart("|C:4&宗主争夺战@0 后结束|",[i])}else this.tips.text="",TimerManager.ins().remove(this.SetTimeLab,this)},e.prototype.ShowPipei=function(){TimerManager.ins().doTimer(2e3,1,this.openPipei,this)},e.prototype.openPipei=function(){FacFightProxy.ins().IsAotu&&ViewManager.ins().open(PipeiView,PvpType.FAC_FIGHT)},e.prototype.ShowAddCount=function(){var t=GlobalConfig.getLeader_battle_base_dataConfig(1).currencys,e=t[0],i=GlobalConfig.getLeader_battle_vip_buy_dataConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),n=i?i.num:0,o=UtilProxy.getStr("是否花费|C:7&@0 @1 |购买1次挑战次数?\n今日剩余购买次数|C:7&(@2 /@3 )|",[e[1],BagProxy.ins().getItemName(e[0]),n-FacFightProxy.ins().buy_challenge_times,n]);TipsControl.ins().ShowTips1(o,void 0,this.BuyCount)},e.prototype.BuyCount=function(){var t=GlobalConfig.getLeader_battle_vip_buy_dataConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL));if(void 0==t||FacFightProxy.ins().buy_challenge_times>=t.num)return TipsControl.ins().showTips("购买次数不足"),!1;var e=GlobalConfig.getLeader_battle_base_dataConfig(1).currencys,i=e[0];return RoleProxy.ins().getMoneyAttr(i[0])<i[1]?(TipsControl.ins().showTips("元宝不足"),!1):(FacFightProxy.ins().C2SReqFactionBuyChallenge(1),!0)},e}(BaseEuiView);__reflect(FacFightView.prototype,"FacFightView"),ViewManager.ins().reg(FacFightView,LayerManager.UI_Main),window.FacFightView=FacFightView;var FFAppointItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="FFAppointItemSkin"},e.prototype.dataChanged=function(){this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[this.data.name]);var t=FacFightProxy.ins().getCurIndexByRoleId(this.data.role_id),e=this.data.title||0;this.lab.textFlow=UtilProxy.StrFormart("|C:1&[@0 ]@1 |",[TitleProxy.ins().getShengWanglvlName(e,FacProxy.ins().getFacId()),0!=t?FacFightProxy.ins().getCurIndexName(t):TitleProxy.ins().getShengwangName(e,FacProxy.ins().getFacId())]),this.btn.visible=0==t,this.btn.label=FacFightProxy.ins().IsZhengchuang(this.data.role_id,this.data.server_id)?"撤销":"任命"},e.prototype.onClick=function(t){var e=this;if(!FacFightProxy.ins().IsMonsignor(RoleProxy.ins().getRoleId()))return void TipsControl.ins().showTips("只有宗主才能任命");var i=FacFightProxy.ins().getCurIndexByRoleId(this.data.role_id);if(0!=i)return void TipsControl.ins().showTips("宗主、首座和护法不能任命");var n=FacFightProxy.ins().IsZhengchuang(this.data.role_id,this.data.server_id)?2:1;TipsControl.ins().ShowTips1(UtilProxy.getStr("确定@0 ？",[1==n?"将该玩家设为真传弟子":"撤销该玩家"]),function(){},function(){FacFightProxy.ins().C2SReqFactionSetZhenChuan(n,e.data.role_id)}),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(FFAppointItem.prototype,"FFAppointItem"),window.FFAppointItem=FFAppointItem;var FFAppointView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FacFightAppointSkin",this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&掌门可任命宗派成员为真传弟子|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&真传弟子|"),this.list.itemRenderer=FFAppointItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateZhenChuan,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateZhenChuan,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.countlab.textFlow=UtilProxy.StrFormart("还有|C:7&@0 |个真传弟子名额未任命",[FacFightProxy.ins().remain_zhenchuan]),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=FacProxy.ins().getMemberList();this.arraylist.removeAll();for(var e in t)FacFightProxy.ins().IsMonsignor(t[e].role_id)||this.arraylist.addItem(t[e])},e}(BaseEuiView);__reflect(FFAppointView.prototype,"FFAppointView"),ViewManager.ins().reg(FFAppointView,LayerManager.UI_Main),window.FFAppointView=FFAppointView;var FFAwardItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="FFAwardItemSkin"},e.prototype.dataChanged=function(){this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[this.data.name]);var t=FacFightProxy.ins().getCurIndexByRoleId(this.data.role_id),e=this.data.title||0;this.lab.textFlow=UtilProxy.StrFormart("|C:1&[@0 ]@1 |",[TitleProxy.ins().getShengWanglvlName(e,FacProxy.ins().getFacId()),0!=t?FacFightProxy.ins().getCurIndexName(t):TitleProxy.ins().getShengwangName(e,FacProxy.ins().getFacId())]),this.btn.visible=0==FacFightProxy.ins().HasGetAward(this.data.role_id,this.data.server_id),this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&已分配|"),this.tips.visible=FacFightProxy.ins().HasGetAward(this.data.role_id,this.data.server_id)},e.prototype.onClick=function(t){var e=this;return FacFightProxy.ins().IsMonsignor(RoleProxy.ins().getRoleId())?FacFightProxy.ins().IsMonsignor(this.data.role_id)?void TipsControl.ins().showTips("不能分配给自己"):(TipsControl.ins().ShowTips1("确定分配战利品给该玩家？",function(){},function(){FacFightProxy.ins().C2SReqFactionGiveBattleAward(e.data.role_id)}),void t.stopImmediatePropagation()):void TipsControl.ins().showTips("只有宗主才能分配")},e}(BaseItemRender);__reflect(FFAwardItem.prototype,"FFAwardItem"),window.FFAwardItem=FFAwardItem;var FFAwardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FacFightAwardSkin",this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&三界大战结束后获得战利品，掌门可分配\n完成分配后掌门自动获得一份战利品|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&宗派战利品|"),this.list.itemRenderer=FFAwardItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateBattleAward,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateBattleAward,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=GlobalConfig.getLeader_battle_base_dataConfig(1).award_item;TipsControl.ins().ShowAwardTips(e)},e.prototype.ShowInfo=function(){this.countlab.textFlow=UtilProxy.StrFormart("今日还剩余|C:7&@0 |份战利品未分配",[FacFightProxy.ins().remain_award]),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=FacProxy.ins().getMemberList();this.arraylist.removeAll();for(var e in t)FacFightProxy.ins().IsMonsignor(t[e].role_id)||this.arraylist.addItem(t[e])},e}(BaseEuiView);__reflect(FFAwardView.prototype,"FFAwardView"),ViewManager.ins().reg(FFAwardView,LayerManager.UI_Main),window.FFAwardView=FFAwardView;var FFRankItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="FacFightRankItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.pic.source="top_icon_0"+t.rank,this.pic.visible=t.rank<=3,this.bg.visible=t.rank>3,this.ranklab.visible=t.rank>3,this.ranklab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.rank]),this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.name]),this.lab1.text="",t.rank<=3&&(this.lab1.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[FacFightProxy.ins().getCurIndexName(t.rank)])),this.lab0.text=t.win_count.toString(),this.chenghao.visible=!1;var e=GlobalConfig.getLeader_battle_title_dataConfig(t.rank);if(e&&(this.chenghao.visible=e.title[FacProxy.ins().getFacId()-1]>0,e.title[FacProxy.ins().getFacId()-1]>0)){var i=GlobalConfig.getTitleById(e.title[FacProxy.ins().getFacId()-1]);this.chenghao.source=TitleProxy.title_icon_path+i.title_res+".png"}},e}(BaseItemRender);__reflect(FFRankItem.prototype,"FFRankItem"),window.FFRankItem=FFRankItem;var FFRankView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FacFightRankSkin",this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&宗派争夺战结束后,第一名将获得宗主之位|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&宗主争夺榜|"),this.list.itemRenderer=FFRankItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.lab.text=UtilProxy.getStr("我的净胜场@0 ",[FacFightProxy.ins().win_count]),this.ranklab.text=UtilProxy.getStr("我的排名：@0 ",[0==FacFightProxy.ins().rank?"未上榜":FacFightProxy.ins().rank.toString()]),this.list.dataProvider=new eui.ArrayCollection(FacFightProxy.ins().list)},e}(BaseEuiView);__reflect(FFRankView.prototype,"FFRankView"),ViewManager.ins().reg(FFRankView,LayerManager.UI_Main),window.FFRankView=FFRankView;var PvpType;!function(t){t[t.FAC_FIGHT=0]="FAC_FIGHT",t[t.TOP_FIGHT=1]="TOP_FIGHT"}(PvpType||(PvpType={}));var PipeiView=function(t){function e(){var e=t.call(this)||this;return e.picnames=["jianshi","fashi"],e.senttime=0,e.curtime=0,e.IsSent=!1,e.curtype=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PipeiSkin",this.namelist=GlobalConfig.getLeader_battle_base_dataConfig(1).namelist.split("|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepFactionBattleChallenge,this.ShowEndTimeLab),EventProxy.AddListener(this,EventType.S2CPvpMatchingResult,this.ShowEndTimeLab),this.IsSent=!1,this.curtype=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepFactionBattleChallenge,this.ShowEndTimeLab),EventProxy.RemoveListener(this,EventType.S2CPvpMatchingResult,this.ShowEndTimeLab),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){this.closeview()},e.prototype.ShowInfo=function(){this.pic0.source=this.picnames[RoleProxy.ins().getRoleSex()-1],this.namelab0.text=RoleProxy.ins().getRoleName(),this.ShowColdTime()},e.prototype.ShowColdTime=function(){var t=GlobalConfig.getLeader_battle_base_dataConfig(1).match_show_time;this.senttime=UtilProxy.GetRandomNum(t[0],t[1]),this.curtime=0,this.SetTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)},e.prototype.SetTimeLab=function(){this.curtime=this.curtime+1,this.pic1.source=this.picnames[UtilProxy.GetRandomNum(0,1)],this.namelab1.text=this.namelist[UtilProxy.GetRandomNum(0,this.namelist.length-1)],this.time.text="正在匹配中",this.curtime>=this.senttime&&(this.curtype==PvpType.FAC_FIGHT?FacFightProxy.ins().C2SReqFactionBattleChallenge():this.curtype==PvpType.TOP_FIGHT&&PvpProxy.ins().C2SReqPvpStartMatching(),this.IsSent&&(TipsControl.ins().showTips("请重新匹配"),this.closeview()),this.IsSent=!0,this.curtime=0,this.senttime=this.curtype==PvpType.FAC_FIGHT?GlobalConfig.getLeader_battle_base_dataConfig(1).match_end_time:GlobalConfig.getPvp_base_dataConfig(1).match_end_time)},e.prototype.ShowEndTimeLab=function(){TimerManager.ins().remove(this.SetTimeLab,this);var t=this.curtype==PvpType.FAC_FIGHT?FacFightProxy.ins().prof:PvpProxy.ins().otherprof;this.pic1.source=this.picnames[t-1],this.namelab1.text=this.curtype==PvpType.FAC_FIGHT?FacFightProxy.ins().name:PvpProxy.ins().othername,this.curtime=GlobalConfig.getLeader_battle_base_dataConfig(1).match_delay_time,TimerManager.ins().doTimer(1e3,GlobalConfig.getLeader_battle_base_dataConfig(1).match_delay_time,this.SetEndTimeLab,this,this.closeview,this)},e.prototype.SetEndTimeLab=function(){this.curtime=this.curtime-1,this.time.text=UtilProxy.getStr("@0 秒后进入战斗",[this.curtime])},e.prototype.closeview=function(){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(PipeiView.prototype,"PipeiView"),ViewManager.ins().reg(PipeiView,LayerManager.UI_Main2),window.PipeiView=PipeiView;var FightUpItem=function(t){function e(){var e=t.call(this)||this;return e.NotGetIndex=-1,e.totlefight=0,e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.items=[this.item1,this.item2,this.item3,this.item4],this.tipslist=[this.tips1,this.tips2,this.tips3,this.tips4];for(var t=0;t<this.tipslist.length;t++)this.addTouchEvent(this.tipslist[t],this.ontipsClick)},e.prototype.setSkinName=function(){this.skinName="fightUpItemSkin"},e.prototype.dataChanged=function(){this.NotGetIndex=-1,this.totlefight=0;var t=this.data;this.titlepic.source=t.show_title;for(var e=GlobalConfig.getFight_up_dataConfigsById(t.id),i=0;i<this.items.length;i++)this.items[i].visible=void 0!=e[i+1],e[i+1]&&this.SetItemGroup(e[i+1],this.items[i]);this.zhanValue.text=this.totlefight.toString(),this.hasget.visible=-1==this.NotGetIndex,this.btn.visible=-1!=this.NotGetIndex},e.prototype.SetItemGroup=function(t,e){this.totlefight=this.totlefight+t.show_fight;var i=e.getChildAt(0),n=e.getChildAt(1),o=e.getChildAt(2),s=e.getChildAt(4),r=UtilProxy.GetItemCellData(t.show_id,1);i.data=r,n.visible=""!=t.item_mark,n.source=t.item_mark,o.visible=""!=t.item_str,o.text=t.item_str,s.textFlow=UtilProxy.StrFormart("|C:7&U&@0 |",[t.show_str]),e.getChildAt(3).visible=BagProxy.ins().GetFightUpState(t.type,t.nee_id),e.getChildAt(3).visible||-1!=this.NotGetIndex||(this.NotGetIndex=t.sub_id)},e.prototype.onClick=function(t){var e=GlobalConfig.getFight_up_dataConfigsById(this.data.id),i=e[this.NotGetIndex];if(i&&i.open_view.length>0){if(62==i.open_view[0]&&!LimitActProxy.ins().IsFristRechargeOpen())return;if(54==i.open_view[0]&&!LimitActProxy.ins().getLuxuryFRCf())return;UtilProxy.openView(i.open_view[0],i.open_view[1]);var n=0==i.open_view[1]?1:2,o=0==i.open_view[1]?i.open_view[0]:100*i.open_view[0]+i.open_view[1];SystemOpenProxy.ins().isOpen(1,i.open_view[0],!0)&&SystemOpenProxy.ins().isOpen(n,o,!0)&&ViewManager.ins().close(FightUpView)}t.stopImmediatePropagation()},e.prototype.ontipsClick=function(t){var e=this.tipslist.indexOf(t.currentTarget),i=GlobalConfig.getFight_up_dataConfigsById(this.data.id),n=i[e+1];if(n&&n.open_view.length>0){if(62==n.open_view[0]&&!LimitActProxy.ins().IsFristRechargeOpen())return;if(54==n.open_view[0]&&!LimitActProxy.ins().getLuxuryFRCf())return;UtilProxy.openView(n.open_view[0],n.open_view[1]);var o=0==n.open_view[1]?1:2,s=0==n.open_view[1]?n.open_view[0]:100*n.open_view[0]+n.open_view[1];SystemOpenProxy.ins().isOpen(1,n.open_view[0],!0)&&SystemOpenProxy.ins().isOpen(o,s,!0)&&ViewManager.ins().close(FightUpView)}},e}(BaseItemRender);__reflect(FightUpItem.prototype,"FightUpItem"),window.FightUpItem=FightUpItem;var FightUpView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FightUpSkin",this.list.itemRenderer=FightUpItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.bg,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.bg,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array);var t=GlobalConfig.getFight_up_dataConfigList(),e=[];this.array.removeAll();for(var i in t)e.push(t[i][1]);e.sort(this.sortvalue);for(var i in e)this.array.addItem(e[i])},e.prototype.sortvalue=function(t,e){var i=BagProxy.ins().GetIsAllGetById(t.id),n=BagProxy.ins().GetIsAllGetById(e.id);if(i==n){if(t.id<e.id)return-1;if(t.id>e.id)return 1}else{if(!i&&n)return-1;if(i&&!n)return 1}return 0},e}(BaseEuiView);__reflect(FightUpView.prototype,"FightUpView"),ViewManager.ins().reg(FightUpView,LayerManager.UI_Main2),window.FightUpView=FightUpView;var DayFRView=function(t){function e(){var e=t.call(this)||this;return e.otherclosebtns=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="DayFRSkin",this.list.itemRenderer=ItemCell,this.alist0.itemRenderer=ItemCell,this.title0.textFlow=UtilProxy.generateTextFlow("|C:10&奖 励|"),this.info2.textFlow=UtilProxy.generateTextFlow("|C:4&条件达成后可领取|"),this.awards=[this.award1,this.award2,this.award3,this.award4],this.btnlist=[this.btn0,this.btn1];for(var e=0;e<this.awards.length;e++){var i=this.awards[e].getChildAt(3);this.otherclosebtns[e]=i.getChildAt(3)}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn0,this.onbtnClick),this.addTouchEvent(this.btn1,this.onbtnClick),this.addTouchEvent(this.closebtn0,this.onCloseClick1),this.addTouchEvent(this.getbtn,this.onGetClick);for(var i=0;i<this.awards.length;i++)this.addTouchEvent(this.awards[i],this.onAwardClick);for(var i=0;i<this.otherclosebtns.length;i++)this.addTouchEvent(this.otherclosebtns[i],this.onCloseOtherClick);return EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),LimitActProxy.ins().IsDayFROpen()?(this.curindex=0,void 0==this.curbtn&&(this.curbtn=this.btn0),t[0]&&(this.curindex=t[0],this.btnlist[t[0]]&&(this.curbtn=this.btnlist[t[0]])),this.curbtn.icon="common_btn_big_yellow",void this.ShowInfo()):(ViewManager.ins().close(this),void NoticeProxy.ins().OpenRecharge())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn0,this.onbtnClick),this.removeTouchEvent(this.btn1,this.onbtnClick),this.removeTouchEvent(this.closebtn0,this.onCloseClick1),this.removeTouchEvent(this.getbtn,this.onGetClick);for(var i=0;i<this.awards.length;i++)this.removeTouchEvent(this.awards[i],this.onAwardClick);for(var i=0;i<this.otherclosebtns.length;i++)this.removeTouchEvent(this.otherclosebtns[i],this.onCloseOtherClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),egret.Tween.removeTweens(this),this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=void 0},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onCloseClick1=function(t){this.Awardgroup.visible=!1},e.prototype.onbtnClick=function(t){this.curindex=t.currentTarget==this.btn0?0:1,void 0!=this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=t.currentTarget,this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.onAwardClick=function(t){var e=this.awards.indexOf(t.currentTarget),i=LimitActProxy.ins().GetActivityCfgs(3),n=i[this.curindex];if(void 0!=n){var o=this.GetAwardActList(n.act_params[0]);if(void 0!=o[e]){var s=LimitActProxy.ins().GetActivityData(o[e].id);return s&&s.is_completed&&!s.is_get?void LimitActProxy.ins().C2SReqLimitActGetReward(o[e].id):void this.ShowAwardInfo(o[e].id)}}},e.prototype.onCloseOtherClick=function(t){var e=this.otherclosebtns.indexOf(t.currentTarget),i=this.awards[e].getChildAt(3);i.visible=!1},e.prototype.onGetClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(3),i=e[this.curindex];if(void 0!=i){var n=LimitActProxy.ins().GetActivityData(i.id);n&&n.is_completed?LimitActProxy.ins().C2SReqLimitActGetReward(i.id):NoticeProxy.ins().OpenRecharge()}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(3,1);t[1]&&(this.btn1.label=UtilProxy.getStr("@0  元礼包",[t[1].act_params[0]/LimitActProxy.ins().rechargeNun]));var e=LimitActProxy.ins().GetActivityData(t[0].id);if(this.btn0.getChildAt(2).visible=e&&e.is_completed&&!e.is_get||this.GetLeijiAwardRed(t[0].act_params[0]),this.btn1.visible=void 0!=t[1],t[1]){var i=LimitActProxy.ins().GetActivityData(t[1].id);this.btn1.getChildAt(2).visible=i&&i.is_completed&&!i.is_get||this.GetLeijiAwardRed(t[1].act_params[0])}var n=t[this.curindex];if(void 0!=n){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var o=n.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),a=0;a<r.length;a++){var h=UtilProxy.GetItemCellData(r[a][0].id,r[a][0].num);this.arraylist.addItem(h)}var l=LimitActProxy.ins().GetActivityData(n.id),p=l&&l.params[0]?l.params[0]:0;if(this.getbtn.visible=void 0==l||0==l.is_get,this.getbtn.visible&&(this.getbtn.label=l&&l.is_completed?"领取奖励":"充点小钱"),this.hasget.visible=l&&l.is_get,this.getbtn.getChildAt(2).visible=l&&l.is_completed&&!l.is_get,this.lab0.textFlow=l&&l.is_completed?UtilProxy.generateTextFlow("C:7&已达成"):UtilProxy.StrFormart("今日累计充值@0 元",[p>0?p/LimitActProxy.ins().rechargeNun:0]),this.ShowOtherAward(n.act_params[0]),this.model.removeChildren(),this.model.x=n.charRes_wuqi[2],this.model.y=n.charRes_wuqi[3],2==n.charRes_wuqi[0]){var c=new egret.MovieClip;UtilProxy.GetMovieClip(n.charRes_wuqi[1],c,-1,void 0),this.model.addChild(c)}else if(3==n.charRes_wuqi[0])UtilProxy.GetMovieClipById(Number(n.charRes_wuqi[1]),this.model);else if(1==n.charRes_wuqi[0]){var u=new eui.Image;u.source=n.charRes_wuqi[1],this.model.addChild(u)}}},e.prototype.ShowOtherAward=function(t){var e=this.GetAwardActList(t),i=e[e.length-1],n=LimitActProxy.ins().GetActivityData(i.id),o=n&&n.params[1]?n.params[1]:0;this.bar.maximum=i.act_params[0],this.bar.value=o,egret.Tween.removeTweens(this);for(var s=0;s<this.awards.length;s++){var r=e[s];if(r){var a=this.awards[s].getChildAt(2);a.textFlow=UtilProxy.StrFormart("C:10&累计 @0 天",[r.act_params[0]]);var h=LimitActProxy.ins().GetActivityData(r.id),l=this.awards[s].getChildAt(0);l.source=h&&h.is_completed?"xianjie_btn_1":"xianjie_btn_2",this.awards[s].getChildAt(1).visible=h&&h.is_get;var p=this.awards[s].getChildAt(3),c=LimitActProxy.ins().GetExtraItem(r.id);if(p.visible=void 0!=c,void 0!=c){var u=p.y,d=p.y+10;egret.Tween.get(p,{loop:!0}).to({y:d},500).to({y:u},500);
var g=GlobalConfig.getDropConfig(c),y=GlobalConfig.getDropItem(g.drop),f=UtilProxy.GetItemCellData(y[0][0].id,y[0][0].num),_=p.getChildAt(2);_.data=f}}}},e.prototype.GetAwardActList=function(t){for(var e=LimitActProxy.ins().GetActivityCfgs(17),i=[],n=0;n<e.length;n++)e[n].act_params[1]==t&&i.push(e[n]);return i},e.prototype.GetLeijiAwardRed=function(t){for(var e=this.GetAwardActList(t),i=0;i<e.length;i++){var n=LimitActProxy.ins().GetActivityData(e[i].id);if(n&&n.is_completed&&!n.is_get)return!0}return!1},e.prototype.ShowAwardInfo=function(t){this.Awardgroup.visible=!0;var e=GlobalConfig.getActivity_dataConfig(t),i=LimitActProxy.ins().GetActivityData(t),n=i&&i.params[1]?i.params[1]:0;this.info1.textFlow=UtilProxy.StrFormart("累冲达到@0 天可领取|C:@1 &(@2 /@0 )|",[e.act_params[0],n>=e.act_params[0]?7:4,n]),this.arraylist2||(this.arraylist2=new eui.ArrayCollection,this.alist0.dataProvider=this.arraylist2),this.arraylist2.removeAll();var o=e.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),a=0;a<r.length;a++){var h=UtilProxy.GetItemCellData(r[a][0].id,r[a][0].num);this.arraylist2.addItem(h)}},e}(BaseEuiView);__reflect(DayFRView.prototype,"DayFRView"),ViewManager.ins().reg(DayFRView,LayerManager.UI_Main2),window.DayFRView=DayFRView;var FirstRechargeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FirstRechargeSkin",this.list.itemRenderer=ItemCell,this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.cost_list=[this.txt_money1,this.txt_money2,this.txt_money3,this.txt_money4],this.effect.removeChildren(),UtilProxy.GetMovieClipById(59,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);this.movie&&(this.movie.clear(),this.model.removeChild(this.movie)),LimitActProxy.ins().IsShowFirstRechange&&EventProxy.Broast(EventType.GuideDoEvent,[]),LimitActProxy.ins().IsShowFirstRechange=!1},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){var e=this.btns.indexOf(t.currentTarget);if(-1!=e){var i=this.cfg.recharge_list[e],n=GlobalConfig.getRechargeBagConfig(i);if(n){var o={app_subject:n.name,order_amt:100*n.amount,data:n};SdkManager.isUseSdk?SdkManager.ins().commitPay(o):TipsControl.ins().showTips("没有SDK")}}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(1)[0],e=LimitActProxy.ins().GetActivityData(t.id);e&&e.is_get&&ViewManager.ins().close(this),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.cfg=t,this.arraylist.removeAll();var i=t.icon;if(i.length>0)for(var n=0;n<i.length;n++){var o=UtilProxy.GetItemCellData(i[n][0],i[n][1]);this.arraylist.addItem(o)}this.movie||(this.movie=new MovieClip,this.model.addChild(this.movie));var s=UtilProxy.getShowImgPath()+t.charRes_wuqi[0];UtilProxy.GetMovieClip(s,this.movie,-1,void 0);for(var r=t.recharge_list,n=0;n<r.length;n++){var a=GlobalConfig.getRechargeBagConfig(r[n]);a&&this.cost_list[n]&&(this.cost_list[n].text=UtilProxy.getStr("¥ @0 ",[a.amount]))}},e}(BaseEuiView);__reflect(FirstRechargeView.prototype,"FirstRechargeView"),ViewManager.ins().reg(FirstRechargeView,LayerManager.UI_Main2),window.FirstRechargeView=FirstRechargeView;var LuxuryFRView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LuxuryFRSkin",this.list.itemRenderer=ItemCell,this.effect.removeChildren(),UtilProxy.GetMovieClipById(59,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.InitBtn(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.getbtn,this.ongetbtnClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),t[0]&&this.btns[t[0]]&&(this.curindex=t[0]),void 0==this.curbtn&&this.btns[this.curindex]&&(this.curbtn=this.btns[this.curindex]),this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.getbtn,this.ongetbtnClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.model.removeChildren()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){this.curindex=this.btns.indexOf(t.currentTarget),void 0!=this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=this.btns[this.curindex],this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.ongetbtnClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(2,1),i=e[this.curindex];if(void 0!=i){var n=LimitActProxy.ins().GetActivityData(i.id);n&&n.is_completed?LimitActProxy.ins().C2SReqLimitActGetReward(i.id):NoticeProxy.ins().OpenRecharge()}},e.prototype.InitBtn=function(){var t=LimitActProxy.ins().GetActivityCfgs(2,1);t.sort(this.sortCfs),this.btns=[],this.btn_g.removeChildren(),this.curindex=-1;for(var e=0;e<t.length;e++){var i=new eui.Button;i.skinName=Btn14Skin,i.width=76,i.height=40,i.icon="common_btn_big_yellow_off",i.label=UtilProxy.getStr("@0  元",[t[e].act_params[0]/LimitActProxy.ins().rechargeNun]),this.btns.push(i),this.btn_g.addChild(i);var n=LimitActProxy.ins().GetActivityData(t[e].id);n&&n.is_completed&&!n.is_get&&-1==this.curindex?this.curindex=e:void 0!=n&&n.is_get||-1!=this.curindex||(this.curindex=e)}-1==this.curindex&&(this.curindex=0)},e.prototype.sortCfs=function(t,e){var i=LimitActProxy.ins().GetActivityData(t.id),n=LimitActProxy.ins().GetActivityData(e.id);if(i&&i.is_completed&&i.is_get&&n&&n.is_completed&&n.is_get){if(t.act_params[0]<e.act_params[0])return-1;if(t.act_params[0]>e.act_params[0])return 1}else{if(i&&i.is_completed&&i.is_get)return 1;if(n&&n.is_completed&&n.is_get)return-1;if(t.act_params[0]<e.act_params[0])return-1;if(t.act_params[0]>e.act_params[0])return 1}return 0},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(2,1);t.sort(this.sortCfs);for(var e=0;e<this.btns.length;e++)if(this.btns[e].getChildAt(2).visible=!1,t[e]){var i=LimitActProxy.ins().GetActivityData(t[e].id);this.btns[e].getChildAt(2).visible=i&&!i.is_get&&i.is_completed}var n=t[this.curindex];if(void 0!=n){this.pic0.source=n.icon[0],this.pic1.source=n.icon[1],this.pic2.visible=n.act_params[0]/LimitActProxy.ins().rechargeNun==1e3,this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var o=n.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),e=0;e<r.length;e++){var a=UtilProxy.GetItemCellData(r[e][0].id,r[e][0].num);this.arraylist.addItem(a)}var h=LimitActProxy.ins().GetActivityData(n.id),l=h&&h.params[0]?h.params[0]:0;if(this.getbtn.visible=void 0==h||0==h.is_get,this.getbtn.visible&&(this.getbtn.label=h&&h.is_completed?"领取奖励":"前往充值"),this.hasget.visible=h&&h.is_get,this.lab.textFlow=h&&h.is_completed?UtilProxy.generateTextFlow("C:7&已达成"):UtilProxy.StrFormart("已充值额度@0 元",[l>0?l/LimitActProxy.ins().rechargeNun:0]),this.model.removeChildren(),this.model.x=n.charRes_wuqi[2],this.model.y=n.charRes_wuqi[3],this.tujianpic.visible=1==n.charRes_wuqi[0],3==n.charRes_wuqi[0])UtilProxy.GetMovieClipById(Number(n.charRes_wuqi[1]),this.model);else if(2==n.charRes_wuqi[0]){var p=new egret.MovieClip;UtilProxy.GetMovieClip(n.charRes_wuqi[1],p,-1,void 0),this.model.addChild(p)}else 1==n.charRes_wuqi[0]&&(this.tujianpic.source=n.charRes_wuqi[1])}},e}(BaseEuiView);__reflect(LuxuryFRView.prototype,"LuxuryFRView"),ViewManager.ins().reg(LuxuryFRView,LayerManager.UI_Main2),window.LuxuryFRView=LuxuryFRView;var ForgingView=function(t){function e(){var e=t.call(this)||this;return e.itemlist=[],e.curIndex=0,e.tabbtns=[],e.titlestrs=["title_qianghua","title_lingshi","title_shengxing","title_zhuling","title_jinglian","title_zhuhun"],e.refineEffectList=[79,80,81,82],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ForgingSkin",this.comview.initUI(),this.tabbtns=[this.tabbtn0,this.tabbtn1,this.tabbtn2,this.tabbtn3,this.tabbtn4,this.tabbtn5],this.itemlist=[this.item0,this.item1,this.item2,this.item3,this.item4,this.item5,this.item6,this.item7,this.item8,this.item9],this.stars=[this.star0,this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9],this.stones=[this.stone0,this.stone1,this.stone2,this.stone3,this.stone4],this.icons=[this.icon0,this.icon1,this.icon2,this.icon3,this.icon4],this.adds=[this.add0,this.add1,this.add2,this.add3,this.add4],this.names=[this.name0,this.name1,this.name2,this.name3,this.name4],this.reds=[this.red1,this.red2,this.red3,this.red4,this.red5],this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&更换装备时,装备强化等级不变|"),this.startitle.textFlow=UtilProxy.generateTextFlow("|C:10&升星成功率|"),this.stonetips.textFlow=UtilProxy.generateTextFlow("|C:7&U&获得灵石|"),this.opentips.textFlow=UtilProxy.StrFormart("|C:10&VIP@0 \n开启|",[GlobalConfig.getSoulstone_misc_dataConfig(1).need_vip]),this.tips0.textFlow=UtilProxy.generateTextFlow("|C:7&U&获得途径|"),this.jllab0.textFlow=UtilProxy.generateTextFlow("|C:10&使用暴击|"),this.stone_effect1.removeChildren(),UtilProxy.GetMovieClipById(119,this.stone_effect1),this.roleeff.removeChildren(),UtilProxy.GetMovieClipById(97,this.roleeff),this.zheff0.removeChildren(),UtilProxy.GetMovieClipById(98,this.zheff0),this.zheff1.removeChildren(),UtilProxy.GetMovieClipById(98,this.zheff1),this.zheff2.removeChildren(),UtilProxy.GetMovieClipById(98,this.zheff2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.selectedIndex=this.curIndex=0,t[0]&&SystemOpenProxy.ins().isOpen(2,1e3+t[0],!0)&&(this.viewStack.selectedIndex=this.curIndex=t[0]),this.comview.open(),this.effect0.removeChildren(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.tips0,this.onqhtipsClick);for(var i=0;i<this.itemlist.length;i++)this.itemlist[i].SetShowTips(!1),this.addTouchEvent(this.itemlist[i],this.onItemClick);for(var i=0;i<this.tabbtns.length;i++){var n=this.tabbtns[i].getChildAt(0);i==this.curIndex?n.source="common_btn_smell_yellow_on":n.source="common_btn_smell_yellow_off",this.addTouchEvent(this.tabbtns[i],this.onTabTouch)}this.curtabbtn=this.tabbtns[this.curIndex],this.addTouchEvent(this.upbtn,this.onUpGradeClick),this.addTouchEvent(this.onekeybtn,this.onOneKeyClick),this.addTouchEvent(this.uptipsbtn,this.onUpTipsClick),this.addTouchEvent(this.center,this.onCenterItemClick),this.addTouchEvent(this.upstarbtn,this.onUpStarClick),this.addTouchEvent(this.fullupstar,this.onUpStarClick),this.addTouchEvent(this.starneedIcon,this.onUpStarNeedClick),this.addTouchEvent(this.starneedIcon1,this.onUpStarNeedClick),this.addTouchEvent(this.uptipsbtn0,this.onUpTipsClick),this.addTouchEvent(this.uptipsbtn1,this.onUpTipsClick),this.addTouchEvent(this.giftbtn,this.onGiftClick),this.addTouchEvent(this.onekeystone,this.onOneKeyStone);for(var i=0;i<this.stones.length;i++)this.addTouchEvent(this.stones[i],this.onStoneClick);this.addTouchEvent(this.zhulingbtn,this.onZhulingClick),this.addTouchEvent(this.onekeyzl,this.onZhulingClick),this.addChangeEvent(this.check0,this.selectChange),this.addChangeEvent(this.check1,this.selectChange),this.addChangeEvent(this.check2,this.selectChange),this.addTouchEvent(this.slbtn0,this.onSLClick),this.addTouchEvent(this.slbtn1,this.onSLClick),this.addTouchEvent(this.slbtn2,this.onSLClick),this.addTouchEvent(this.stonetips,this.onTipslick),this.addTouchEvent(this.jlbtn,this.onRefineClick),this.addTouchEvent(this.btn_wen,this.onRefineClick),this.addTouchEvent(this.jlsuitbtn,this.onUpTipsClick),this.addTouchEvent(this.zhuhunbtn,this.onZhuhunClick),this.addTouchEvent(this.onekeyzh,this.onZhuhunClick),this.addChangeEvent(this.zhcheck0,this.selectzhChange),this.addChangeEvent(this.zhcheck1,this.selectzhChange),this.addChangeEvent(this.zhcheck2,this.selectzhChange),this.addTouchEvent(this.zhbtn0,this.onzhSLClick),this.addTouchEvent(this.zhbtn1,this.onzhSLClick),this.addTouchEvent(this.zhbtn2,this.onzhSLClick),EventProxy.AddListener(this,EventType.S2CRepIntensifyGetInfo,this.ShowUpgrade),EventProxy.AddListener(this,EventType.S2CRepIntensifyUpgrade,this.ShowUpEffect),EventProxy.AddListener(this,EventType.S2CRepIntensifySuit,this.ShowUpgrade),EventProxy.AddListener(this,EventType.S2CRepUpstarGetInfo,this.ShowUpStar),EventProxy.AddListener(this,EventType.S2CRepUpstarUpgrade,this.ShowUpStarEffect),EventProxy.AddListener(this,EventType.S2CRepUpstarUpgradeMaster,this.ShowUpStar),EventProxy.AddListener(this,EventType.S2CRepSoulstoneGetInfo,this.ShowStoneEffect),EventProxy.AddListener(this,EventType.S2CRepSoulstoneUpgradeMaster,this.ShowSoulStone),EventProxy.AddListener(this,EventType.S2CRepSoulstoneInlay,this.ShowStoneEffect),EventProxy.AddListener(this,EventType.S2CRepInjectsoulAction,this.ShowZhulingEffect),EventProxy.AddListener(this,EventType.S2CRepInjectsoulSwallow,this.ShowZhulingInfo),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.AddListener(this,EventType.UpdataForgingRed,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepIntensifyUpgradeRefine,this.ShowRefineEffect),EventProxy.AddListener(this,EventType.S2CRepIntensifySuitRefine,this.ShowRefineInfo),EventProxy.AddListener(this,EventType.S2CRepInjectsoulSoulforgeAction,this.ShowZhuhunEffect),EventProxy.AddListener(this,EventType.S2CRepInjectsoulSoulforgeSwallow,this.ShowZhuhunInfo),this.ShowInfo(),this.CheckGuide(),!SystemOpenProxy.ins().isOpen(1,61,!0)||(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?this.giftbtn.visible=!1:this.giftbtn.setEff(!0,45)},e.prototype.ShowInfo=function(){this.ShowRed(),this.setOpenIndex(this.curIndex)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.tips0,this.onqhtipsClick);for(var i=0;i<this.itemlist.length;i++)this.removeTouchEvent(this.itemlist[i],this.onItemClick);for(var i=0;i<this.tabbtns.length;i++)this.removeTouchEvent(this.tabbtns[i],this.onTabTouch);this.removeTouchEvent(this.upbtn,this.onUpGradeClick),this.removeTouchEvent(this.onekeybtn,this.onOneKeyClick),this.removeTouchEvent(this.uptipsbtn,this.onUpTipsClick),this.removeTouchEvent(this.center,this.onCenterItemClick),this.removeTouchEvent(this.upstarbtn,this.onUpStarClick),this.removeTouchEvent(this.fullupstar,this.onUpStarClick),this.removeTouchEvent(this.starneedIcon,this.onUpStarNeedClick),this.removeTouchEvent(this.starneedIcon1,this.onUpStarNeedClick),this.removeTouchEvent(this.uptipsbtn0,this.onUpTipsClick),this.removeTouchEvent(this.uptipsbtn1,this.onUpTipsClick),this.removeTouchEvent(this.giftbtn,this.onGiftClick),this.removeTouchEvent(this.onekeystone,this.onOneKeyStone),this.removeTouchEvent(this.slbtn0,this.onSLClick),this.removeTouchEvent(this.slbtn1,this.onSLClick),this.removeTouchEvent(this.slbtn2,this.onSLClick),this.removeTouchEvent(this.stonetips,this.onTipslick),this.check0.removeEventListener(egret.Event.CHANGE,this.selectChange,this),this.check1.removeEventListener(egret.Event.CHANGE,this.selectChange,this),this.check2.removeEventListener(egret.Event.CHANGE,this.selectChange,this);for(var i=0;i<this.stones.length;i++)this.removeTouchEvent(this.stones[i],this.onStoneClick);this.removeTouchEvent(this.jlbtn,this.onRefineClick),this.removeTouchEvent(this.btn_wen,this.onRefineClick),this.removeTouchEvent(this.jlsuitbtn,this.onUpTipsClick),this.removeTouchEvent(this.zhuhunbtn,this.onZhuhunClick),this.removeTouchEvent(this.onekeyzh,this.onZhuhunClick),this.removeTouchEvent(this.zhbtn0,this.onzhSLClick),this.removeTouchEvent(this.zhbtn1,this.onzhSLClick),this.removeTouchEvent(this.zhbtn2,this.onzhSLClick),this.zhcheck0.removeEventListener(egret.Event.CHANGE,this.selectzhChange,this),this.zhcheck1.removeEventListener(egret.Event.CHANGE,this.selectzhChange,this),this.zhcheck2.removeEventListener(egret.Event.CHANGE,this.selectzhChange,this),EventProxy.RemoveListener(this,EventType.S2CRepIntensifyGetInfo,this.ShowUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepIntensifyUpgrade,this.ShowUpEffect),EventProxy.RemoveListener(this,EventType.S2CRepUpstarGetInfo,this.ShowUpStar),EventProxy.RemoveListener(this,EventType.S2CRepUpstarUpgrade,this.ShowUpStarEffect),EventProxy.RemoveListener(this,EventType.S2CRepSoulstoneGetInfo,this.ShowStoneEffect),EventProxy.RemoveListener(this,EventType.S2CRepSoulstoneInlay,this.ShowStoneEffect),EventProxy.RemoveListener(this,EventType.S2CRepSoulstoneUpgradeMaster,this.ShowSoulStone),EventProxy.RemoveListener(this,EventType.S2CRepUpstarUpgradeMaster,this.ShowUpStar),EventProxy.RemoveListener(this,EventType.S2CRepIntensifySuit,this.ShowUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepInjectsoulAction,this.ShowZhulingEffect),EventProxy.RemoveListener(this,EventType.S2CRepInjectsoulSwallow,this.ShowZhulingInfo),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.RemoveListener(this,EventType.UpdataForgingRed,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepIntensifyUpgradeRefine,this.ShowRefineEffect),EventProxy.RemoveListener(this,EventType.S2CRepIntensifySuitRefine,this.ShowRefineInfo),EventProxy.RemoveListener(this,EventType.S2CRepInjectsoulSoulforgeAction,this.ShowZhuhunEffect),EventProxy.RemoveListener(this,EventType.S2CRepInjectsoulSoulforgeSwallow,this.ShowZhuhunInfo),this.curCheck&&(this.curCheck.selected=!1,this.curCheck=void 0)},e.prototype.UpdataMoney=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];i==MoneyAttr.COIN&&0==this.curIndex&&this.ShowUpgrade()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onqhtipsClick=function(t){TipsControl.ins().ShowPathTips(30001)},e.prototype.onTipslick=function(t){TipsControl.ins().ShowPathTips(31135)},e.prototype.onItemClick=function(t){switch(this.curSelectItem.ShowOnSelect(!1),this.curSelectItem=t.currentTarget,this.curSelectItem.ShowOnSelect(!0),this.curIndex){case 0:this.SetItemUpgradeInfo();break;case 1:this.SetItemStoneInfo();break;case 2:this.SetItemUpStarInfo();break;case 3:this.SetItemZhulingInfo();break;case 4:this.SetItemRefineInfo();break;case 5:this.SetItemZhuhunInfo()}},e.prototype.onCenterItemClick=function(t){var e=this.center.data;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&ViewManager.ins().open(EquipTipsView,e)},e.prototype.onUpTipsClick=function(t){switch(t.currentTarget){case this.uptipsbtn:ViewManager.ins().open(MasterTipsView,MasterType.Intensify);break;case this.uptipsbtn0:ViewManager.ins().open(MasterTipsView,MasterType.Upstar);break;case this.uptipsbtn1:ViewManager.ins().open(MasterTipsView,MasterType.Soulstone);break;case this.jlsuitbtn:ViewManager.ins().open(MasterTipsView,MasterType.Refine)}},e.prototype.onGiftClick=function(){SystemOpenProxy.ins().isOpen(1,61)&&ViewManager.ins().OpenViewById(61,1),this.giftbtn.setEff(!1)},e.prototype.selectChange=function(t){this.curCheck&&(this.curCheck.selected=!1),t.currentTarget.selected=!0,this.curCheck=t.currentTarget},e.prototype.selectzhChange=function(t){this.curzhCheck&&(this.curzhCheck.selected=!1),t.currentTarget.selected=!0,this.curzhCheck=t.currentTarget},e.prototype.onUpStarClick=function(t){var e=this.center.data;if(0==e.item_slot_idx)return void TipsControl.ins().showTips("请选择需要升星的部位");if(0==e.item_type_id)return void TipsControl.ins().showTips("请穿戴装备");var i=t.currentTarget==this.upstarbtn?1:2,n=UpStarProxy.ins().getUpStarByPart(e.item_slot_idx),o=UpStarProxy.ins().getCurUpStarState(e.item_slot_idx,i);if(1==o){var s=GlobalConfig.getUpstar_part_dataConfig(n+1),r=1==i?s.items:s.perfect_items;return TipsControl.ins().showTips(UtilProxy.getStr("@0 不足",[BagProxy.ins().getItemName(r[0][0])])),void TipsControl.ins().ShowPathTips(r[0][0])}return 2==o?void TipsControl.ins().showTips("升星已满级"):void UpStarProxy.ins().C2SReqUpstarUpgrade(e.item_slot_idx,i)},e.prototype.onUpStarNeedClick=function(t){var e=t.currentTarget==this.starneedIcon?1:2,i=this.center.data,n=UpStarProxy.ins().getUpStarByPart(i.item_slot_idx),o=GlobalConfig.getUpstar_part_dataConfig(n+1),s=1==e?o.items:o.perfect_items,r=new ItemCellData,a={item_slot_idx:0,item_type_id:s[0][0],item_count:1};r.setItemCellData(a),ViewManager.ins().open(ItemTipsView,r)},e.prototype.onUpGradeClick=function(t){var e=this.center.data;if(0==e.item_slot_idx)return void TipsControl.ins().showTips("请选择需要强化的部位");if(0==e.item_type_id)return void TipsControl.ins().showTips("请穿戴装备");var i=UpgradeProxy.ins().getCurUpState(e.item_slot_idx);if(1==i[0])return TipsControl.ins().showTips(UtilProxy.getStr("@0 不足",[BagProxy.ins().getItemName(i[1])])),void TipsControl.ins().ShowPathTips(i[1]);if(2==i[0])return void TipsControl.ins().showTips("强化已满级");if(3==i[0])return void TipsControl.ins().showTips("请提升角色等级");var n=[];n.push(e.item_slot_idx),UpgradeProxy.ins().C2SReqIntensifyUpgrade(n)},e.prototype.onOneKeyClick=function(t){for(var e=[],i=-1,n=-1,o=UpgradeProxy.ins().getMaxUpLevel(),s=1;10>=s;s++){var r=UpgradeProxy.ins().getUpgradeLevelByPart(s),a=GlobalConfig.getIntensify_part_dataConfig(r+1);BagProxy.ins().getBodyEquipByPart(s)&&void 0!=a&&a.level<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)&&(-1==o||o>r)&&(a.currencys[0]&&-1==n&&(n=RoleProxy.ins().getMoneyAttr(a.currencys[0])),a.items[0]&&-1==i&&(i=BagProxy.ins().getItemCountByIDtype(a.items[0],BagType.BAG)),(void 0==a.currencys[0]||n>=a.currencys[1])&&(void 0==a.items[0]||i>=a.items[1])&&(void 0!=a.items[0]&&(i-=a.items[1]),void 0!=a.currencys[0]&&(n-=a.currencys[1]),e.push(s)))}return e.length<=0?void TipsControl.ins().showTips("没有可强化的部位"):void UpgradeProxy.ins().C2SReqIntensifyUpgrade(e)},e.prototype.onOneKeyStone=function(t){var e=this.center.data;return 0==e.item_slot_idx?void TipsControl.ins().showTips("请选择需要镶嵌的部位"):0==e.item_type_id?void TipsControl.ins().showTips("请穿戴装备"):SoulStoneProxy.ins().getCurPartCanIn(e.item_slot_idx)?void SoulStoneProxy.ins().C2SReqSoulstoneOnekeyInlay(e.item_slot_idx):void TipsControl.ins().showTips("该部位没有可镶嵌的灵石")},e.prototype.onStoneClick=function(t){var e=this.stones.indexOf(t.currentTarget),i=this.center.data;0!=i.item_slot_idx&&(e+1==5&&GlobalConfig.getSoulstone_misc_dataConfig(1).need_vip>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)||ViewManager.ins().open(StonewinView,i.item_slot_idx,e+1))},e.prototype.onTabTouch=function(t){var e=this.tabbtns.indexOf(t.currentTarget);if(SystemOpenProxy.ins().isOpen(2,1e3+e)){if(this.curtabbtn){var i=this.curtabbtn.getChildAt(0);i.source="common_btn_smell_yellow_off"}this.curIndex=e,this.curtabbtn=this.tabbtns[e];var n=this.curtabbtn.getChildAt(0);n.source="common_btn_smell_yellow_on",this.curSelectItem=void 0}this.viewStack.selectedIndex=this.curIndex,this.setOpenIndex(this.curIndex)},e.prototype.setOpenIndex=function(t){switch(this.curCheck&&(this.curCheck.selected=!1,this.curCheck=void 0),this.comview.SetName(this.titlestrs[t]),this.bg.source=5!=t?"duanzao_bg_jpg":"duanzao_bg_zhuhun_jpg",this.center.visible=5!=t,this.partname.visible=5!=t,t){case 0:this.ShowUpgrade();break;case 1:this.ShowSoulStone();break;case 2:UpStarProxy.ins().IsShowRed&&(UpStarProxy.ins().IsShowRed=!1,EventProxy.Broast(EventType.UpdataForgingRed,{})),this.ShowUpStar();break;case 3:ZhulingProxy.ins().IsShowRed&&(ZhulingProxy.ins().IsShowRed=!1,EventProxy.Broast(EventType.UpdataForgingRed,{})),this.ShowZhulingInfo();break;case 4:this.ShowRefineInfo();break;case 5:ZhuhunProxy.ins().IsShowRed&&(ZhuhunProxy.ins().IsShowRed=!1,EventProxy.Broast(EventType.UpdataForgingRed,{})),this.ShowZhuhunInfo()}},e.prototype.onZhulingClick=function(t){var e=this.center.data;if(0==e.item_slot_idx)return void TipsControl.ins().showTips("请选择需要注灵的部位");if(0==e.item_type_id)return void TipsControl.ins().showTips("请穿戴装备");var i=t.currentTarget==this.zhulingbtn?0:1,n=GlobalConfig.getInjectsoul_itemsConfig(1).items,o=this.check0.selected?n[0]:this.check1.selected?n[1]:this.check2.selected?n[2]:0;if(0==o)return void TipsControl.ins().showTips("请选择注灵的材料");if(BagProxy.ins().getItemCountById(o)<=0)return TipsControl.ins().showTips("注灵材料不足"),void TipsControl.ins().ShowPathTips(o);var s=ZhulingProxy.ins().getZhulingLevelByPart(e.item_slot_idx),r=GlobalConfig.getInjectsoul_part_dataConfig(s);return void 0==r||void 0==r.exp||0==r.exp?void TipsControl.ins().showTips("当前部位注灵已满级"):void ZhulingProxy.ins().C2SReqInjectsoulAction(e.item_slot_idx,i,o)},e.prototype.onZhuhunClick=function(t){var e=this.center.data;if(0==e.item_slot_idx)return void TipsControl.ins().showTips("请选择需要铸魂的部位");if(0==e.item_type_id)return void TipsControl.ins().showTips("请穿戴装备");var i=t.currentTarget==this.zhuhunbtn?0:1,n=GlobalConfig.getSoulforge_itemsConfig(1).items,o=this.zhcheck0.selected?n[0]:this.zhcheck1.selected?n[1]:this.zhcheck2.selected?n[2]:0;if(0==o)return void TipsControl.ins().showTips("请选择铸魂的材料");if(BagProxy.ins().getItemCountById(o)<=0)return TipsControl.ins().showTips("铸魂材料不足"),void TipsControl.ins().ShowPathTips(o);var s=ZhuhunProxy.ins().getZhuhunLevelByPart(e.item_slot_idx),r=GlobalConfig.getSoulforge_part_dataConfig(s);return void 0==r||void 0==r.exp||0==r.exp?void TipsControl.ins().showTips("当前部位铸魂已满级"):void ZhuhunProxy.ins().C2SReqInjectsoulSoulforgeAction(e.item_slot_idx,i,o)},e.prototype.onSLClick=function(t){var e=0;switch(t.currentTarget){case this.slbtn0:e=1;break;case this.slbtn1:e=2;break;case this.slbtn2:e=3}if(0!=e){var i=ZhulingProxy.ins().getZhulingStateByType(e);return 0==i[0]?void TipsControl.ins().showTips(UtilProxy.getStr("注灵总等阶达到@0 阶开启该兽灵吞噬",[i[1]])):void ViewManager.ins().open(ZhulingTipsView,e)}},e.prototype.onzhSLClick=function(t){var e=0;switch(t.currentTarget){case this.zhbtn0:e=1;break;case this.zhbtn1:e=2;break;case this.zhbtn2:e=3}if(0!=e){var i=ZhuhunProxy.ins().getZhuhunStateByType(e);return 0==i[0]?void TipsControl.ins().showTips(UtilProxy.getStr("铸魂总等阶达到@0 阶开启该魂吞噬",[i[1]])):void ViewManager.ins().open(ZhulingTipsView,e,1)}},e.prototype.onRefineClick=function(t){switch(t.currentTarget){case this.jlbtn:var e=this.center.data;if(0==e.item_slot_idx)return void TipsControl.ins().showTips("请选择需要精炼的部位");var i=RefineProxy.ins().getCurUpState(e.item_slot_idx);if(1==i){var n=GlobalConfig.getRefine_part_attr_dataConfig(e.item_slot_idx);return TipsControl.ins().showTips(UtilProxy.getStr("@0 不足",[BagProxy.ins().getItemName(n.item_id)])),void TipsControl.ins().ShowPathTips(n.item_id)}if(2==i)return void TipsControl.ins().showTips("精炼已满级");var o=this.jlcheck.selected;RefineProxy.ins().getPartRefineStar(e.item_slot_idx)<=0&&(o=!1),RefineProxy.ins().C2SReqIntensifyUpgradeRefine(e.item_slot_idx,o?1:0);break;case this.btn_wen:ViewManager.ins().open(RefineTips,1)}},e.prototype.ShowRed=function(){for(var t=[UpgradeProxy.ins().getRed(),SoulStoneProxy.ins().getRed(),UpStarProxy.ins().getRed(),ZhulingProxy.ins().getRed(),RefineProxy.ins().getRed(),ZhuhunProxy.ins().getRed()],e=0;e<this.tabbtns.length;e++)this.tabbtns[e].getChildAt(2).visible=t[e]},e.prototype.ShowUpEffect=function(){this.effect0.removeChildren(),UtilProxy.GetMovieClipById(26,this.effect0),UtilProxy.GetMovieClipById(22,this.effect0),this.ShowUpgrade()},e.prototype.ShowUpgrade=function(){for(var t=0,e=0;e<this.itemlist.length;e++){var i=UpgradeProxy.ins().getUpgradeLevelByPart(e+1);this.SetItemInfo(this.itemlist[e],e+1,i,0==UpgradeProxy.ins().getCurUpState(e+1)[0]);var n=GlobalConfig.getIntensify_part_attrConfig(i);n&&(t+=UtilProxy.GetAttrFight(n[e+1]))}this.ranklab.text=UpgradeProxy.ins().suit_id+"阶",this.zhanValue.text=UtilProxy.getFightNumLab(t+UpgradeProxy.ins().getMasterFight()),void 0==this.curSelectItem&&(this.curSelectItem=this.itemlist[0]),this.curSelectItem.ShowOnSelect(!0),this.SetItemUpgradeInfo(),this.ShowRed(),this.tipsred0.visible=UpgradeProxy.ins().getMasterRed()},e.prototype.SetItemUpgradeInfo=function(){this.center.data=this.curSelectItem.data;var t=this.center.data;if(0!=t.item_slot_idx){this.upbtnred.visible=0==UpgradeProxy.ins().getCurUpState(t.item_slot_idx)[0],this.onekeyred.visible=UpgradeProxy.ins().getListCanUpRed(),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]);var e=UpgradeProxy.ins().getUpgradeLevelByPart(t.item_slot_idx);this.center.SetItemStrengthen(e),this.coinlab.text="0",this.countlab.text="0";var i=GlobalConfig.getIntensify_part_dataConfig(e+1);if(i&&i.currencys[0]&&i.currencys[0]==MoneyAttr.COIN){var n=RoleProxy.ins().getMoneyAttr(i.currencys[0]);this.coinlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[n>=i.currencys[1]?1:4,GlobalFunc.getCountStr(i.currencys[1])])}if(i&&i.items[0]){var o=BagProxy.ins().getItemCountByIDtype(i.items[0],BagType.BAG);this.countlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[o>=i.items[1]?1:4,o,GlobalFunc.getCountStr(i.items[1])])}if(void 0!=GlobalConfig.getIntensify_part_attrConfig(e)){for(var s=GlobalConfig.getIntensify_part_attrConfig(e)[t.item_slot_idx],r=AttrProxy.getAttrInfo(s),a="",h=0;h<r.length;h++)a=UtilProxy.getStr("@0 +@1 ",[r[h][2],r[h][1]]);this.curvlaue.text="当前："+a}else this.curvlaue.text="当前：无";if(void 0!=GlobalConfig.getIntensify_part_attrConfig(e+1)){for(var s=GlobalConfig.getIntensify_part_attrConfig(e+1)[t.item_slot_idx],r=AttrProxy.getAttrInfo(s),a="",h=0;h<r.length;h++)a=UtilProxy.getStr("@0 +@1 ",[r[h][2],r[h][1]]);this.nextvlaue.textFlow=UtilProxy.StrFormart("下级：|C:7&@0 |",[a])}else this.nextvlaue.textFlow=UtilProxy.generateTextFlow("下级：|C:7&已满级|")}},e.prototype.SetItemInfo=function(t,e,i,n){void 0===n&&(n=!1);var o=BagProxy.ins().getBodyEquipByPart(e);void 0==o&&(o=new ItemCellData,o.item_slot_idx=e),t.data=o,t.SetItemStrengthen(i),t.ShowRed(n)},e.prototype.ShowUpStarEffect=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&t[0]&&(UtilProxy.GetMovieClipById(26,this.effect3),UtilProxy.GetMovieClipById(30,this.effect3)),this.ShowUpStar()},e.prototype.ShowUpStar=function(){for(var t=0,e=0;e<this.itemlist.length;e++){var i=UpStarProxy.ins().getUpStarByPart(e+1);this.SetItemInfo(this.itemlist[e],e+1,i,0==UpStarProxy.ins().getCurUpStarState(e+1,1));var n=GlobalConfig.getUpstar_part_dataConfig(i),o=BagProxy.ins().getBodyEquipByPart(e+1);if(n&&o){var s=o.itemConfig;t=t+UtilProxy.GetAttrFight(s,n.attr_per)-UtilProxy.GetAttrFight(s)}}this.ranklab0.text=UpStarProxy.ins().master_level+"阶",this.zhanValue.text=UtilProxy.getFightNumLab(t+UpStarProxy.ins().getMasterFight()),void 0==this.curSelectItem&&(this.curSelectItem=this.itemlist[0]),this.curSelectItem.ShowOnSelect(!0),this.SetItemUpStarInfo(),this.ShowRed(),this.tipsred2.visible=UpStarProxy.ins().getMasterRed()},e.prototype.SetItemUpStarInfo=function(){this.center.data=this.curSelectItem.data;var t=this.center.data;if(0!=t.item_slot_idx){this.UpStarred.visible=0==UpStarProxy.ins().getCurUpStarState(t.item_slot_idx,1),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]);
var e=UpStarProxy.ins().getUpStarByPart(t.item_slot_idx);this.center.SetItemStrengthen(e);for(var i=Math.floor(e/10)+1,n=e%10,o=0;o<this.stars.length;o++)this.stars[o].source=n>o?"shengxing_icon_01_0"+(i+1):"shengxing_icon_01_0"+i;var s=GlobalConfig.getUpstar_part_dataConfig(e),r=GlobalConfig.getUpstar_part_dataConfig(e+1);if(void 0==r)this.uppre.text="0%",this.vipuppre.textFlow=UtilProxy.generateTextFlow("|C:7&0% VIP|"),this.nextvlaue0.textFlow=UtilProxy.generateTextFlow("下级：|C:7&已满级|"),this.upstarcount.text="0/0",this.upstarcount1.text="0/0",this.starneedIcon.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(s.items[0][0]).displayid),this.starneedIcon1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(s.perfect_items[0][0]).displayid);else{this.starneedIcon.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(r.items[0][0]).displayid),this.starneedIcon1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(r.perfect_items[0][0]).displayid),this.uppre.text=r.succ_rate+"%";var a=GlobalConfig.getUpstar_vip_rateConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),h=void 0!=a?a.vip_succ_rate:0;this.vipuppre.textFlow=UtilProxy.StrFormart("|C:7&@0 % VIP|",[h]),this.nextvlaue0.textFlow=UtilProxy.StrFormart("下级：|C:7&装备基础属性 +@0 %|",[r.attr_per]);var l=BagProxy.ins().getItemCountByIDtype(r.items[0][0],BagType.BAG),p=BagProxy.ins().getItemCountByIDtype(r.perfect_items[0][0],BagType.BAG);this.upstarcount.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[l>=r.items[0][1]?1:4,l,r.items[0][1]]),this.upstarcount1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[p>=r.perfect_items[0][1]?1:4,p,r.perfect_items[0][1]])}this.curvlaue0.text=void 0==s?"当前：无":"当前：装备基础属性 +"+s.attr_per+"%"}},e.prototype.ShowStoneEffect=function(){UtilProxy.GetMovieClipById(26,this.effect1),UtilProxy.GetMovieClipById(23,this.effect1),this.ShowSoulStone()},e.prototype.ShowSoulStone=function(){for(var t=0,e=0;e<this.itemlist.length;e++)this.SetItemInfo(this.itemlist[e],e+1,SoulStoneProxy.ins().getStoneLevelByPart(e+1),SoulStoneProxy.ins().getCurPartCanIn(e+1)||SoulStoneProxy.ins().getCurPartInStoneCanUp(e+1)),t+=SoulStoneProxy.ins().getCurPartSoulStoneFight(e+1);this.ranklab1.text=SoulStoneProxy.ins().master_level+"阶",this.zhanValue.text=UtilProxy.getFightNumLab(t+SoulStoneProxy.ins().getMasterFight()),void 0==this.curSelectItem&&(this.curSelectItem=this.itemlist[0]),this.curSelectItem.ShowOnSelect(!0),this.SetItemStoneInfo(),this.ShowRed(),this.tipsred1.visible=SoulStoneProxy.ins().getMasterRed()},e.prototype.SetItemStoneInfo=function(){this.center.data=this.curSelectItem.data;var t=this.center.data;if(0!=t.item_slot_idx){this.stonered.visible=SoulStoneProxy.ins().getCurPartCanIn(t.item_slot_idx),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]);var e=SoulStoneProxy.ins().getStoneLevelByPart(t.item_slot_idx);this.center.SetItemStrengthen(e);var i=GlobalConfig.getSoulstone_partConfig(t.item_slot_idx).stone_type,n=GlobalConfig.getSoulstone_misc_dataConfig(1).need_vip;this.opentips.visible=n>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),this.stone_effect1.visible=!1;for(var o=0;o<i.length;o++){if(5==i[o]&&n>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))this.stones[o].source="lingshi_bg_baoshidi_02",this.names[o].text="混沌灵石",this.icons[o].visible=!1,this.adds[o].visible=!1;else{5==i[o]&&(this.stones[o].source="lingshi_bg_baoshidi_03");var s=SoulStoneProxy.ins().getStoneByPartAndType(t.item_slot_idx,i[o]),r=GlobalConfig.getItemsConfig(s);void 0!=r?(this.icons[o].visible=!0,this.adds[o].visible=!1,this.icons[o].source=AssetMgr.getIconResource(r.displayid),this.names[o].textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[r.quality-1],r.name]),5==i[o]&&(this.stone_effect1.visible=!0)):(this.icons[o].visible=!1,this.adds[o].visible=!0,this.names[o].textFlow=UtilProxy.generateTextFlow("|C:1&未镶嵌|"))}this.reds[o].visible=SoulStoneProxy.ins().getCurPartTypeCanIn(t.item_slot_idx,i[o])||SoulStoneProxy.ins().getCurInStoneCanUp(t.item_slot_idx,i[o])}}},e.prototype.ShowZhulingEffect=function(){UtilProxy.GetMovieClipById(26,this.effect2),UtilProxy.GetMovieClipById(21,this.effect2),this.ShowZhulingInfo()},e.prototype.ShowZhulingInfo=function(){for(var t=0,e=0;e<this.itemlist.length;e++){this.SetItemInfo(this.itemlist[e],e+1,ZhulingProxy.ins().getZhulingLevelByPart(e+1),ZhulingProxy.ins().getCanZhulingUpLevelByPart(e+1));var i=ZhulingProxy.ins().getZhulingLevelByPart(e+1),n=GlobalConfig.getInjectsoul_attr_dataConfig(i,e+1);t+=UtilProxy.GetAttrFight(n)}this.zhanValue.text=UtilProxy.getFightNumLab(t+ZhulingProxy.ins().getTsFight()),void 0==this.curSelectItem&&(this.curSelectItem=this.itemlist[0]),this.curSelectItem.ShowOnSelect(!0),this.SetItemZhulingInfo(),this.ShowRed(),this.slred0.visible=ZhulingProxy.ins().getCurTSstate(1),this.slred1.visible=ZhulingProxy.ins().getCurTSstate(2),this.slred2.visible=ZhulingProxy.ins().getCurTSstate(3)},e.prototype.SetItemZhulingInfo=function(){this.center.data=this.curSelectItem.data;var t=this.center.data;if(0!=t.item_slot_idx){this.zhulingred0.visible=ZhulingProxy.ins().getCanZhulingUpLevelByPart(t.item_slot_idx),this.zhulingred1.visible=ZhulingProxy.ins().getCanZhulingUpLevelByPart(t.item_slot_idx),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]);var e=ZhulingProxy.ins().getZhulingLevelByPart(t.item_slot_idx);this.center.SetItemStrengthen(e),this.zhulinglv.text=e.toString();var i=GlobalConfig.getInjectsoul_part_dataConfig(e),n=GlobalConfig.getInjectsoul_part_dataConfig(e+1);this.zlbar.maximum=i.exp,this.zlbar.value=ZhulingProxy.ins().getZhulingExpByPart(t.item_slot_idx);for(var o=GlobalConfig.getInjectsoul_attr_dataConfig(e,t.item_slot_idx),s=GlobalConfig.getInjectsoul_attr_dataConfig(e+1,t.item_slot_idx),r=AttrProxy.getContAttrInfo(o,s),a="",h="",l=0;l<r.length;l++)""==a?(a=UtilProxy.getStr("@0 +@1 ",[r[l][0],r[l][1]]),h=UtilProxy.getStr("|C:7&@0 +@1 |",[r[l][0],r[l][2]])):(a+=UtilProxy.getStr("\n@0 +@1 ",[r[l][0],r[l][1]]),h+=UtilProxy.getStr("\n|C:7&@0 +@1 |",[r[l][0],r[l][2]]));this.curpro.textFlow=UtilProxy.generateTextFlow(a),this.nextpro.textFlow=UtilProxy.generateTextFlow(h),void 0==n&&(this.nextpro.textFlow=UtilProxy.generateTextFlow("|C:7&已满级|"));var p=GlobalConfig.getInjectsoul_itemsConfig(1).items;this.SetZhulingCost(p[0],this.value0,this.zlicon0,this.check0),this.SetZhulingCost(p[1],this.value1,this.zlicon1,this.check1),this.SetZhulingCost(p[2],this.value2,this.zlicon2,this.check2)}},e.prototype.SetZhulingCost=function(t,e,i,n){void 0==this.curCheck&&BagProxy.ins().getItemCountById(t)>0&&(this.curCheck=n,this.curCheck.selected=!0),e.text=BagProxy.ins().getItemCountById(t).toString();var o=BagProxy.ins().getItemData(t);i.source=AssetMgr.getIconResource(o.displayid)},e.prototype.ShowRefineEffect=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&(UtilProxy.GetMovieClipById(26,this.jleffect),UtilProxy.GetMovieClipById(this.refineEffectList[0==t[0]?t[0]:t[0]-1],this.jleffect)),this.jlcheck.selected&&(this.jlcheck.selected=!1),this.ShowRefineInfo()},e.prototype.ShowRefineInfo=function(){for(var t=0;t<this.itemlist.length;t++)this.SetItemInfo(this.itemlist[t],t+1,RefineProxy.ins().getPartRefineLevel(t+1),0==RefineProxy.ins().getCurUpState(t+1));this.suitlab.text=RefineProxy.ins().suit_level+"阶",this.zhanValue.text=UtilProxy.getFightNumLab(RefineProxy.ins().getAllFightValue()),void 0==this.curSelectItem&&(this.curSelectItem=this.itemlist[0]),this.curSelectItem.ShowOnSelect(!0),this.SetItemRefineInfo(),this.ShowRed()},e.prototype.SetItemRefineInfo=function(){this.center.data=this.curSelectItem.data;var t=this.center.data;if(0!=t.item_slot_idx){this.jlred.visible=0==RefineProxy.ins().getCurUpState(t.item_slot_idx),this.jlsuitred.visible=RefineProxy.ins().getMasterRed(),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]);var e=RefineProxy.ins().getPartRefineLevel(t.item_slot_idx);this.center.SetItemStrengthen(e),this.jlnumlab.text="0";var i=RefineProxy.ins().getRefineAttr(t.item_slot_idx,e),n=RefineProxy.ins().getRefineAttr(t.item_slot_idx,e+1),o=GlobalConfig.getRefine_part_attr_dataConfig(t.item_slot_idx);if(o){this.jlicon.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(o.item_id).displayid);var s=BagProxy.ins().getItemCountByIDtype(o.item_id,BagType.BAG),r=RefineProxy.ins().getRefineCostNum(t.item_slot_idx,e+1);this.jlnumlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[s>=r?1:4,s,GlobalFunc.getCountStr(r)])}for(var a=RefineProxy.ins().getPartRefineStar(t.item_slot_idx),h=a>0?Math.floor(a/10)+1:1,l=a%10,p=0;p<this.jlstar.numChildren;p++){var c=this.jlstar.getChildAt(p);c.source=l>p?"shengxing_icon_01_0"+(h+1):"shengxing_icon_01_0"+h}for(var u=0,d=10*Math.floor((a-1)/10)+1,g=a,p=d;g>=p;p++){var y=GlobalConfig.getRefine_star_dataConfig(p);y&&(u+=y.rate)}if(this.jltipslab.textFlow=UtilProxy.StrFormart("|C:4&@0 倍||C:10&暴击率：||C:7&@1 %|",[0==a?2:Math.floor((a-1)/10)+2,u>0?u/100:0]),void 0!=i){for(var f=AttrProxy.getAttrInfo(i),_="",p=0;p<f.length;p++)_+=UtilProxy.getStr("@0 +@1 \n            ",[f[p][2],f[p][1]]);this.curjlpro.text="当前："+_}else this.curjlpro.text="当前：无";if(void 0!=n){for(var f=AttrProxy.getAttrInfo(n),_="",p=0;p<f.length;p++)_+=UtilProxy.getStr("@0 +@1 \n            ",[f[p][2],f[p][1]]);this.nextjlpro.textFlow=UtilProxy.StrFormart("下级：|C:7&@0 |",[_])}else this.nextjlpro.textFlow=UtilProxy.generateTextFlow("下级：|C:7&已满级|")}},e.prototype.ShowZhuhunEffect=function(){UtilProxy.GetMovieClipById(26,this.zhsuceff),UtilProxy.GetMovieClipById(19,this.zhsuceff),this.ShowZhuhunInfo()},e.prototype.ShowZhuhunInfo=function(){for(var t=0,e=0;e<this.itemlist.length;e++){this.SetItemInfo(this.itemlist[e],e+1,ZhuhunProxy.ins().getZhuhunLevelByPart(e+1),ZhuhunProxy.ins().getCanZhuhunUpLevelByPart(e+1));var i=ZhuhunProxy.ins().getZhuhunLevelByPart(e+1),n=GlobalConfig.getSoulforge_attr_dataConfig(i,e+1);t+=UtilProxy.GetAttrFight(n)}this.zhanValue.text=UtilProxy.getFightNumLab(t+ZhuhunProxy.ins().getTsFight()),void 0==this.curSelectItem&&(this.curSelectItem=this.itemlist[0]),this.curSelectItem.ShowOnSelect(!0),this.SetItemZhuhunInfo(),this.ShowRed(),this.zhred0.visible=ZhuhunProxy.ins().getCurTSstate(1),this.zhred1.visible=ZhuhunProxy.ins().getCurTSstate(2),this.zhred2.visible=ZhuhunProxy.ins().getCurTSstate(3)},e.prototype.SetItemZhuhunInfo=function(){this.center.data=this.curSelectItem.data;var t=this.center.data;if(0!=t.item_slot_idx){this.zhuhunred0.visible=ZhuhunProxy.ins().getCanZhuhunUpLevelByPart(t.item_slot_idx),this.zhuhunred1.visible=ZhuhunProxy.ins().getCanZhuhunUpLevelByPart(t.item_slot_idx),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]);var e=ZhuhunProxy.ins().getZhuhunLevelByPart(t.item_slot_idx);this.center.SetItemStrengthen(e),this.zhuhunlv.text=e.toString();var i=GlobalConfig.getSoulforge_part_dataConfig(e),n=GlobalConfig.getSoulforge_part_dataConfig(e+1);this.zhbar.maximum=i.exp,this.zhbar.value=ZhuhunProxy.ins().getZhuhunExpByPart(t.item_slot_idx);for(var o=GlobalConfig.getSoulforge_attr_dataConfig(e,t.item_slot_idx),s=GlobalConfig.getSoulforge_attr_dataConfig(e+1,t.item_slot_idx),r=AttrProxy.getContAttrInfo(o,s),a="",h="",l=0;l<r.length;l++)""==a?(a=UtilProxy.getStr("@0 +@1 ",[r[l][0],r[l][1]]),h=UtilProxy.getStr("|C:7&@0 +@1 |",[r[l][0],r[l][2]])):(a+=UtilProxy.getStr("\n@0 +@1 ",[r[l][0],r[l][1]]),h+=UtilProxy.getStr("\n|C:7&@0 +@1 |",[r[l][0],r[l][2]]));this.zhcurpro.textFlow=UtilProxy.generateTextFlow(a),this.zhnextpro.textFlow=UtilProxy.generateTextFlow(h),void 0==n&&(this.zhnextpro.textFlow=UtilProxy.generateTextFlow("|C:7&已满级|"));var p=GlobalConfig.getSoulforge_itemsConfig(1).items;this.SetZhuhunCost(p[0],this.zhvalue0,this.zhicon0,this.zhcheck0),this.SetZhuhunCost(p[1],this.zhvalue1,this.zhicon1,this.zhcheck1),this.SetZhuhunCost(p[2],this.zhvalue2,this.zhicon2,this.zhcheck2)}},e.prototype.SetZhuhunCost=function(t,e,i,n){void 0==this.curzhCheck&&BagProxy.ins().getItemCountById(t)>0&&(this.curzhCheck=n,this.curzhCheck.selected=!0),e.text=BagProxy.ins().getItemCountById(t).toString();var o=BagProxy.ins().getItemData(t);i.source=AssetMgr.getIconResource(o.displayid)},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(ForgingView.prototype,"ForgingView"),ViewManager.ins().reg(ForgingView,LayerManager.UI_Main),window.ForgingView=ForgingView;var type;!function(t){t[t.JINGLIAN=1]="JINGLIAN",t[t.LEITAI=2]="LEITAI"}(type||(type={}));var RefineTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TrunTipsSkin",this.title.text="说明"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo(t[0])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(t){var e="";switch(t){case type.JINGLIAN:e=GlobalConfig.getLimitsConfig(1).explain;break;case type.LEITAI:e=GlobalConfig.getLimitsConfig(1).leitaiwen}this.desc.textFlow=UtilProxy.generateTextFlow(e)},e}(BaseEuiView);__reflect(RefineTips.prototype,"RefineTips"),ViewManager.ins().reg(RefineTips,LayerManager.UI_Main2),window.RefineTips=RefineTips;var StoneItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.ShowName(!1),this.ShowStone(!1),this.ShowOnSelect(!1),this.ShowRed(!1)},e.prototype.setSkinName=function(){this.skinName="StoneItemSkin"},e.prototype.ShowStone=function(t){this.stone.visible=t},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(e){var i=GlobalConfig.getSoulstone_dataConfig(e.item_type_id);if(i&&e.IsInGem)this.stone.visible=e.IsInGem,this.ShowRed(i.upgrade_id>0&&BagProxy.ins().getItemCountById(e.item_type_id)>0);else if(i&&e.item_type_id>0){var n=i.need_value;this.ShowRed(i.upgrade_id>0&&n>0&&e.item_count>=n)}}},e.prototype.clear=function(){t.prototype.clear.call(this),this.stone.visible=!1},e}(ItemCell);__reflect(StoneItem.prototype,"StoneItem"),window.StoneItem=StoneItem;var StonewinView=function(t){function e(){var e=t.call(this)||this;return e.part=0,e.type=0,e.curIndex=0,e.IsInlay=!1,e.IsUp=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="StonewinSkin",this.itemList.itemRenderer=StoneItem,this.itemScroller.viewport=this.itemList},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn1,this.onbtn1Click),this.addTouchEvent(this.upbtn,this.onUpClick),this.addTouchEvent(this.onekey,this.onUpClick),EventProxy.AddListener(this,EventType.S2CRepSoulstoneGetInfo,this.ShowEffect1),EventProxy.AddListener(this,EventType.S2CRepSoulstoneInlay,this.ShowEffect1),EventProxy.AddListener(this,EventType.UpdateBagStone,this.ShowEffect2),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.red0.visible=!1,this.red1.visible=!1,this.part=t[0],this.type=t[1],this.ShowStoneList(),this.IsInlay=!1,this.IsUp=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn1,this.onbtn1Click),this.removeTouchEvent(this.upbtn,this.onUpClick),this.removeTouchEvent(this.onekey,this.onUpClick),EventProxy.RemoveListener(this,EventType.S2CRepSoulstoneGetInfo,this.ShowEffect1),EventProxy.RemoveListener(this,EventType.S2CRepSoulstoneInlay,this.ShowEffect1),EventProxy.RemoveListener(this,EventType.UpdateBagStone,this.ShowEffect2),this.itemList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.curStone=void 0},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onbtn1Click=function(t){var e=SoulStoneProxy.ins().getStoneByPartAndType(this.part,this.type);if(e>0&&e==this.curStone.item_type_id&&0==this.curIndex)SoulStoneProxy.ins().C2SReqSoulstoneUnInlay(this.part,this.type);else if(this.curStone.item_type_id>0){if(void 0==BagProxy.ins().getBodyEquipByPart(this.part))return void TipsControl.ins().showTips("请穿戴装备");this.IsInlay=!0,SoulStoneProxy.ins().C2SReqSoulstoneInlay(this.part,this.curStone.item_type_id)}},e.prototype.onUpClick=function(t){var e=t.currentTarget==this.onekey?1:0,i=SoulStoneProxy.ins().getStoneByPartAndType(this.part,this.type),n=i>0&&i==this.curStone.item_type_id&&0==this.curIndex?1:0,o=GlobalConfig.getSoulstone_dataConfig(this.curStone.item_type_id);if(void 0!=o){if(0==o.upgrade_id)return void TipsControl.ins().showTips("当前宝石已满级");if(0==n){if(BagProxy.ins().getItemCountByIDtype(o.id,BagType.GEM_BAG)<o.need_value)return void TipsControl.ins().showTips("所需宝石不足")}else if(BagProxy.ins().getItemCountByIDtype(o.id,BagType.GEM_BAG)<o.need_value-1)return void TipsControl.ins().showTips("所需宝石不足");this.IsUp=!0,SoulStoneProxy.ins().C2SReqSoulstoneCompose(e,n,this.part,o.id)}},e.prototype.onListItemTap=function(t){var e=t.item;this.curIndex=t.itemIndex,this.curStone=e,void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),this.curSelectItem=t.itemRenderer,this.curSelectItem.ShowOnSelect(!0),this.SetStoneInfo()},e.prototype.ShowEffect1=function(){this.IsInlay&&(UtilProxy.GetMovieClipById(26,this.effect),UtilProxy.GetMovieClipById(23,this.effect)),this.IsInlay=!1,this.ShowStoneList()},e.prototype.ShowEffect2=function(){this.IsUp&&(UtilProxy.GetMovieClipById(26,this.effect),UtilProxy.GetMovieClipById(24,this.effect)),this.IsUp=!1,this.ShowStoneList()},e.prototype.ShowStoneList=function(){var t=[],e=SoulStoneProxy.ins().getStoneByPartAndType(this.part,this.type);if(e>0){var i=new ItemCellData;i.item_type_id=e,i.IsInGem=!0,i.itemConfig=BagProxy.ins().getItemData(e),t[0]=i}for(var n=BagProxy.ins().getBagStoneListByType(this.type),o=0;21>o;o++){var s=n[o];void 0==s&&(s=new ItemCellData),e>0?20>o&&(t[o+1]=s):t[o]=s}this.itemList.dataProvider=new eui.ArrayCollection(t),this.curIndex=0,this.curStone=t[0],this.itemList.validateNow(),this.curSelectItem=this.itemList.getVirtualElementAt(0),this.curSelectItem.ShowOnSelect(!0),this.SetStoneInfo()},e.prototype.SetStoneInfo=function(){this.item.data=this.curStone;var t=SoulStoneProxy.ins().getStoneByPartAndType(this.part,this.type);this.item.ShowStone(t>0&&t==this.curStone.item_type_id&&0==this.curIndex),this.item.ShowRed(!1),this.btn1.visible=this.curStone.item_type_id>0,this.btn1.label="镶嵌",t>0&&t==this.curStone.item_type_id&&0==this.curIndex&&(this.btn1.label="拆卸");var e=GlobalConfig.getSoulstone_dataConfig(this.curStone.item_type_id),i=0,n=new ItemCellData;if(void 0!=e&&(i=e.upgrade_id,n.item_type_id=i,n.itemConfig=BagProxy.ins().getItemData(i)),this.upbtn.visible=i>0,this.onekey.visible=i>0,this.curStone.IsInGem)this.red0.visible=i>0&&BagProxy.ins().getItemCountById(this.curStone.item_type_id)>0,this.red1.visible=i>0&&BagProxy.ins().getItemCountById(this.curStone.item_type_id)>0;else if(this.curStone.item_type_id>0){var o=e.need_value;this.red0.visible=i>0&&o>0&&this.curStone.item_count>=o,this.red1.visible=i>0&&o>0&&this.curStone.item_count>=o}this.item0.data=n,this.SetStoneItem(this.curStone.item_type_id,this.namelab,this.zhan,this.pro,!1),this.SetStoneItem(i,this.namelab0,this.zhan0,this.pro0,!0)},e.prototype.SetStoneItem=function(t,e,i,n,o){if(0==t)e.text=o&&this.curStone.item_type_id>0?"已满级":"",i.textFlow=UtilProxy.StrFormart("|C:10&战力：+@0 |",[0]),n.text="";else{var s=GlobalConfig.getItemsConfig(t);e.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[s.quality-1],s.name]);var r=GlobalConfig.getSoulstone_dataConfig(t),a="",h=5==r.type?SoulStoneProxy.ins().getAddPerStoneItemPro(this.part,t):r;i.textFlow=UtilProxy.StrFormart("|C:10&战力：+@0 |",[UtilProxy.GetAttrFight(h)]);var l=AttrProxy.getAttrInfo(r);if(void 0!=l)for(var p=0;p<l.length;p++)""==a?a=UtilProxy.getStr("@0  +@1 ",[l[p][2],l[p][1]]):a+=UtilProxy.getStr("\n@0  +@1 ",[l[p][2],l[p][1]]);n.text=a}},e}(BaseEuiView);__reflect(StonewinView.prototype,"StonewinView"),ViewManager.ins().reg(StonewinView,LayerManager.UI_Main2),window.StonewinView=StonewinView;var UpgradeItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.ShowName(!1),this.ShowOnSelect(!1),this.ShowRed(!1)},e}(ItemCell);__reflect(UpgradeItem.prototype,"UpgradeItem"),window.UpgradeItem=UpgradeItem;var FBBaowuItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="FBBaowuItemSkin",e.list.itemRenderer=ItemCell,e.list.dataProvider=new eui.ArrayCollection,e.addTouchEvent(e.enter,e.onclick),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){if(this.data){var t=this.data,e=CopyProxy.ins().GetCopyDataByCopyId(t),i=new Copy_dataConfig,n=0,o="无",s=0,r=t;void 0==e?i=GlobalConfig.getCopyConfigById(t):(void 0!=e.best_record?(o=e.best_record.name,n=e.best_record.time-t+1):(o="无",n=0),void 0!=e.climb_info&&(e.climb_info.last_floor>0&&(s=e.climb_info.last_floor-t+1,r=e.climb_info.last_floor),i=GlobalConfig.getCopyConfigById(r+1),void 0==i&&(this.isEndFloor=!0,i=GlobalConfig.getCopyConfigById(r)))),this.record.textFlow=UtilProxy.generateTextFlow(n>0?o+"  "+n+"层":""+o),this.recordMy.text=s>0?Math.max(1,s).toString()+"层":"无";var a=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),h=GlobalConfig.getDropConfig(i.normal_reward[0]),l=GlobalConfig.getDropItem(h.drop),p=new Array;if(void 0!=l)for(var c=0;c<l.length;c++){var u=l[c],d=new ItemCellData,g={item_slot_idx:0,item_type_id:u[0].id,item_count:u[0].num};d.setItemCellData(g),p.push(d)}this.bg.source="resource/skins/fuben/baowushilian_bg_0"+(CopyProxy.ins().getBaowuEnterIndex(t)+1)+".png",this.list.dataProvider=new eui.ArrayCollection(p);var y=CopyProxy.ins().getNextBigReward(r);if(y){this.nextG.visible=!0,this.title.textFlow=UtilProxy.generateTextFlow("C:7&"+(y.id-t+1)+"层大奖");var f=UtilProxy.GetItemCellData(y.show_drop[0],y.show_drop[1]);this.item.data=f}else this.nextG.visible=!1;var _=LyhProxy.ins().getCurId()>=i.lock_tower_limit,v=i.serverday_limit[0]?LimitActProxy.ins().GetServerOpenDay()>=i.serverday_limit[0]:!0;if(_&&v)this.enter.visible=!0,this.info.text="";else{this.enter.visible=!1;var m="";_||(m+="通关炼妖壶"+i.lock_tower_limit+"层"),v||(m=""==m?"开服"+(i.serverday_limit[0]||0)+"天":m+("\n开服"+(i.serverday_limit[0]||0)+"天")),this.info.textFlow=UtilProxy.generateTextFlow("C:4&"+m+"可进行挑战")}this.enter.visible=i.open_zhuan<=a,this.tiplabel.visible=i.open_zhuan>a;var C=UtilProxy.getZhuanStr(i.open_zhuan);this.tiplabel.textFlow=UtilProxy.StrFormart("C:4&需要@0 可挑战",[C])}},e.prototype.onclick=function(t){this.isEndFloor?NoticeProxy.ins().ErrCode(54):CopyProxy.ins().C2SReqCopyEnterCopy(this.data)},e}(BaseItemRender);__reflect(FBBaowuItem.prototype,"FBBaowuItem"),window.FBBaowuItem=FBBaowuItem;var EndType;!function(t){t[t.SHENXIAN=1]="SHENXIAN",t[t.BOSS_YW=2]="BOSS_YW",t[t.LUNJIAN=3]="LUNJIAN",t[t.ZMZD=4]="ZMZD",t[t.BOSS_KF=5]="BOSS_KF",t[t.XYQQ=6]="XYQQ",t[t.TOPFIGHT=7]="TOPFIGHT",t[t.YEZHAN=8]="YEZHAN",t[t.BOSS_TYPE=10]="BOSS_TYPE",t[t.DUJIE=11]="DUJIE",t[t.LEITAI=12]="LEITAI"}(EndType||(EndType={}));var FbendView=function(t){function e(){var e=t.call(this)||this;return e.coldtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="FbendSkin",this.itemList.itemRenderer=ItemMuti,this.itemScroller.viewport=this.itemList,this.fList.itemRenderer=ItemMuti,this.fScroller.viewport=this.fList,this.sysList=[this.sys0,this.sys1,this.sys2,this.sys3],this.expInfo0.text="",this.expInfo1.text="",this.fight.visible=!1,this.fwG.visible=!1,this.bossG.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.txt_remark.text="",CommonUtils.log("-------fbendView----------,open",t),this.addTouchEvent(this.enter,this.LeaveClick),this.addTouchEvent(this.enter0,this.LeaveClick),this.addTouchEvent(this.cancel,this.LeaveClick);for(var i=GlobalConfig.getCopy_miscConfig(1),n=0;n<this.sysList.length;n++)this.sysList[n].icon=i.fail_system_path[n][0],this.addTouchEvent(this.sysList[n],this.onSysClick);this.addTouchEvent(this.fightImg,this.onFightClick),this.endtype=t[2]||0,this.bossG.visible=!1,this.expG.visible=!1,this.fwG.visible=!1,CopyProxy.ins().isFightWin=t[1],this.bgLose.visible=!t[1],this.bgW.visible=t[1],this.fight.y=313,this.itemScroller.height=330,this.fScroller.visible=!1;var o=this.endtype&&this.endtype==EndType.BOSS_TYPE;if(TimerManager.ins().remove(this.SetTimelab,this),this.endtype==EndType.SHENXIAN||this.endtype==EndType.LUNJIAN||this.endtype==EndType.ZMZD||this.endtype==EndType.TOPFIGHT){if(t[1]){if(this.fight.visible=!1,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}}else if(this.fight.visible=!0,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}this.coldtime=8,this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this)}else if(CopyProxy.ins().isTeamExp(GameLogic.ins().getCurSceneId())){if(t[1]){if(this.fight.visible=!1,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}this.expG.visible=!0;var r=CopyTeamProxy.ins().getKillAward();r?(this.expItem.visible=!0,this.expItem.data=UtilProxy.GetItemCellData(r[0][0],r[0][1])):this.expItem.visible=!1,this.expInfo0.text="您在本次战斗中击败了"+CopyTeamProxy.ins().getKillCount()+"个敌人",this.expInfo1.textFlow=UtilProxy.generateTextFlow("C:5&获得经验 "+Math.floor(CopyTeamProxy.ins().getExp())+" |C:7&(增益加成+"+Math.floor(CopyTeamProxy.ins().add_exp)+")")}else if(this.fight.visible=!0,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}this.coldtime=8,this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this)}else if(CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId)){if(this.enter.label="确定",CopyProxy.ins().isFightWin=t[1],CopyProxy.ins().isFightWin){if(this.fight.visible=!1,this.itemScroller.visible=!0,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}}else this.fight.visible=!0,this.itemScroller.visible=!1;this.coldtime=8,this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this)}else if(o||this.endtype==EndType.BOSS_KF||this.endtype==EndType.BOSS_YW){if(this.enter.label="确定",this.bossG.visible=!0,this.bossBgL.source=CopyProxy.ins().isFightWin?"fubenjiesuan_fengexian":"fubenjiesuan_fengexian_2",this.bossBgR.source=CopyProxy.ins().isFightWin?"fubenjiesuan_fengexian":"fubenjiesuan_fengexian_2",CopyProxy.ins().isFightWin){if(this.bossG.x=70,this.bossG.y=358,this.itemScroller.visible=!0,this.itemScroller.height=252,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}}else this.bossG.x=70,this.bossG.y=117,this.fight.y=350,this.fight.visible=!0,this.itemScroller.visible=!1;this.coldtime=8,this.ownerName.text=BossProxy.ins().getOwnerName(),this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this)}else if(this.endtype==EndType.XYQQ){this.itemScroller.visible=!1,this.expInfo0.text="",this.expInfo1.text="",this.bossG.visible=!1,this.fight.visible=!1;var a=t[0],h=t[1];this.bgLose.visible=0!=a,this.bgW.visible=0==a;0==a?this.txt_remark.textFlow=UtilProxy.StrFormart("|C:10&增加仙缘值：|C:70& @0  ",[h]):this.txt_remark.textFlow=UtilProxy.StrFormart("|C:10&减少仙缘值：|C:40& @0  ",[h])}else if(this.endtype==EndType.YEZHAN){if(this.enter.label="确定",this.itemScroller.visible=!0,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}this.fight.visible=CopyProxy.ins().isFightWin}else if(this.enter.label="确定",CopyProxy.ins().isFightWin){if(this.fight.visible=!1,this.itemScroller.visible=!0,null!=t[0]){var s=t[0];this.itemList.dataProvider=new eui.ArrayCollection(s),this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)}}else this.fight.visible=!0,this.itemScroller.visible=!1;if(this.SetFightImg(),void 0!=CopyProxy.ins().repCopyEnd){var l=CopyProxy.ins().repCopyEnd.copy_id,p=GlobalConfig.getCopyConfigById(l);if(void 0!=CopyProxy.ins().repCopyEnd.copy_item&&void 0!=CopyProxy.ins().repCopyEnd.copy_item.climb_info){if(CopyProxy.ins().isNextCopy(CopyProxy.ins().copyId)&&(CopyProxy.ins().isFightWin?(this.btn2G.visible=!0,this.enter.visible=!1,this.coldtime=8,this.enter0.label=UtilProxy.getStr("下一层(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this)):(this.coldtime=5,this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,5,this.SetTimelab,this,this.finshtime,this))),p.entry_copy_id==CopyProxy.ins().sword_enter_id){if(!CopyProxy.ins().isFightWin)return;var c=CopyProxy.ins().repCopyEnd.copy_item.climb_info.last_floor,u=GlobalConfig.getfwLockList(),d=GlobalConfig.getfwPreList(),g=5;this.itemScroller.visible=!1,this.fScroller.visible=!0;var s=t[0];this.fwG.visible=!0,this.fwOpen.visible=!1,this.fList.dataProvider=new eui.ArrayCollection(s),this.fList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this);for(var y in u){var f=u[y];if(f.id==c){this.fwOpen.visible=!0,this.fwTypeImg.source="jiesuojianxincao",this.fwIcon.visible=!1,this.fwAdd.visible=!0,this.fwBg.source="jianxin_dikuang_01",this.fw_name.text="第"+f.pos_list[0]+"个剑心槽";break}}for(var y in d){var _=d[y],v=!1;for(var m in _)if(_[m].lv==c-p.entry_copy_id+1){v=!0,this.fwOpen.visible=!0,this.fwTypeImg.source="jiesuoxinjianxin",this.fwIcon.visible=!0,this.fwAdd.visible=!1,this.fwBg.source="jianxin_dikuang_0"+g,this.fwIcon.source=AssetMgr.getIconResource(GlobalConfig.getfwResById(_[m].id,g).icon),this.fw_name.text="解锁新剑心";break}if(v)break}}}else CopyProxy.ins().isLyh(l)&&(this.btn2G.visible=!1,this.enter.visible=!0,this.coldtime=8,this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),TimerManager.ins().remove(this.SetTimelab,this),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this))}},e.prototype.onSysClick=function(t){switch(t.currentTarget){case this.sys0:CopyProxy.ins().setCopyFailType(CopyEndClickType.type1);break;case this.sys1:CopyProxy.ins().setCopyFailType(CopyEndClickType.type2);break;case this.sys2:CopyProxy.ins().setCopyFailType(CopyEndClickType.type3);break;case this.sys3:CopyProxy.ins().setCopyFailType(CopyEndClickType.type4)}this.finshtime(!0)},e.prototype.SetFightImg=function(){var t=["fubenjiesuanditu_bg","fubenjiesuanditu_bg_2","fubenjiesuanditu_bg_3"],e=CopyProxy.ins().getFightState();
this.fightImg.source=t[e]||""},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&ViewManager.ins().open(ItemTipsView,e)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.LeaveClick),this.removeTouchEvent(this.enter0,this.LeaveClick),this.removeTouchEvent(this.cancel,this.LeaveClick);for(var i=0;i<this.sysList.length;i++)this.removeTouchEvent(this.sysList[i],this.onSysClick);this.removeTouchEvent(this.fightImg,this.onFightClick),TimerManager.ins().removeAll(this)},e.prototype.LeaveClick=function(t){switch(t.currentTarget){case this.enter0:this.finshtime();break;case this.enter:this.finshtime();break;case this.cancel:this.finshtime(!0)}},e.prototype.onFightClick=function(t){CopyProxy.ins().setCopyFailType(CopyEndClickType.fight),this.finshtime(!0)},e.prototype.SetTimelab=function(){this.coldtime=this.coldtime-1,this.enter.label=UtilProxy.getStr("确定(@0 )",[this.coldtime]),this.enter0.label=UtilProxy.getStr("下一层(@0 )",[this.coldtime])},e.prototype.finshtime=function(t){if(void 0===t&&(t=!1),ViewManager.ins().close(this),YezhanProxy.ins().isCanYezhan()&&!CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId))return void HangManager.ins().checkNext();if(this.endtype==EndType.LUNJIAN)return void CopyProxy.ins().C2SReqCopyLeave(0);if(CopyProxy.ins().isFightWin&&CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId))return GameLogic.ins().onExitCopy(),void EventProxy.Broast(EventType.S2CRepCopyLeave,[!0]);if(GameLogic.ins().isBossYWScene(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isTeamExp(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isShenxian(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isLunjian(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isZMZD(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isTopFight(GameLogic.ins().getCurSceneId())){var e=GameLogic.ins().getLastScene(),i=GlobalConfig.getSceneConfigById(e);return void SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),i.x,i.y)}if(CopyProxy.ins().isTeamExp(GameLogic.ins().getCurSceneId()))return void CopyProxy.ins().C2SReqCopyLeave(0);if(CopyProxy.ins().isXYQQ())return void CopyProxy.ins().C2SReqCopyLeave(0);if(this.endtype!=EndType.SHENXIAN&&this.endtype!=EndType.LUNJIAN&&this.endtype!=EndType.ZMZD&&this.endtype!=EndType.XYQQ&&this.endtype!=EndType.TOPFIGHT)if(CopyProxy.ins().isFightWin)if(CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId))GameLogic.ins().onExitCopy(),EventProxy.Broast(EventType.S2CRepCopyLeave,[!0]);else if(CopyProxy.ins().isLyh(CopyProxy.ins().copyId)){var n=LyhProxy.ins().getCurData();n&&!t?SceneControl.ins().C2STransferScene(n.scene_id,0,0):CopyProxy.ins().C2SReqCopyLeave(0)}else CopyProxy.ins().isNextCopy(CopyProxy.ins().copyId)&&!t?CopyProxy.ins().repCopyEnd.copy_item.climb_info&&CopyProxy.ins().isEndCopyById(CopyProxy.ins().repCopyEnd.copy_item.climb_info.last_floor)?(TipsControl.ins().showTips("已到达最高层！"),CopyProxy.ins().C2SReqCopyLeave(1)):CopyProxy.ins().C2SReqCopyEnterCopy(CopyProxy.ins().copyId):CopyProxy.ins().C2SReqCopyLeave(1);else CopyProxy.ins().C2SReqCopyLeave(0)},e}(BaseEuiView);__reflect(FbendView.prototype,"FbendView"),ViewManager.ins().reg(FbendView,LayerManager.UI_Main2),window.FbendView=FbendView;var FBMaterialItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="FBMaterialItemSkin",e.init(),e.star_list=new Array,e.fbName.visible=!1,e.addTouchEvent(e.enter,e.onclick),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(e){this.setStar(e.star),this.bgIcon.source="resource/skins/fuben/"+e.config.show_img+".png";var i=UtilProxy.getServerWeek(),n=GlobalConfig.getCopyConfigById(e.copy_id+1);n?this.info2.text="修仙"+n.difficult_state[0]+"阶提升收益星级":this.info2.text="",this.addIcon.visible=6==i||7==i?!0:!1,this.refresh()}},e.prototype.SetData=function(){},e.prototype.setName=function(t){this.fbName.text=t},e.prototype.setStar=function(t){for(var e=0;t>e;e++)if(e>=this.star_list.length){var i=new eui.Image;i.source="xing",this.starG.addChild(i),this.star_list.push(i)}for(var e=0;e<this.star_list.length;e++)e>=t?this.star_list[e].visible=!1:this.star_list[e].visible=!0},e.prototype.setTimes=function(t){if(t>0)this.times.textFlow=UtilProxy.generateTextFlow("挑战次数：|C:7&"+t),this.enter.label="挑战";else{var e=this.data,i=CopyProxy.ins().getCopyBuyInfoById(e.copy_id);this.times.textFlow=UtilProxy.generateTextFlow("扫荡次数：|C:7&"+i.left_time),this.enter.label="扫荡"}},e.prototype.refresh=function(){var t=this.data;if(t){var e=LyhProxy.ins().getCurId()>=t.config.lock_tower_limit,i=t.config.serverday_limit[0]?LimitActProxy.ins().GetServerOpenDay()>=t.config.serverday_limit[0]:!0,n=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),o=t.config.open_zhuan,s=n>=o;if(e&&i&&s)this.enter.visible=!0,this.setTimes(CopyProxy.ins().getCopyLeftTimeById(t.copy_id));else{this.enter.visible=!1;var r="";e||(r+="通关炼妖壶"+t.config.lock_tower_limit+"层"),i||(r=""==r?"开服"+(t.config.serverday_limit[0]||0)+"天":r+("且开服"+(t.config.serverday_limit[0]||0)+"天")),e&&i&&!s&&(r=UtilProxy.getZhuanStr(o)),this.times.textFlow=UtilProxy.generateTextFlow("C:4&"+r+"可进行挑战")}}},e.prototype.onclick=function(t){var e=this.data,i=CopyProxy.ins().getCopyLeftTimeById(e.copy_id);if(i>0){var n=LyhProxy.ins().getCurId()>=e.config.lock_tower_limit,o=e.config.serverday_limit[0]?LimitActProxy.ins().GetServerOpenDay()>=e.config.serverday_limit[0]:!0;if(!n)return void TipsControl.ins().showTips("通关炼妖壶"+e.config.lock_tower_limit+"层可进行挑战");if(!o)return void TipsControl.ins().showTips("开服"+(e.config.serverday_limit[0]||0)+"天可进行挑战");CopyProxy.ins().C2SReqCopyEnterCopy(e.copy_id)}else{var s=CopyProxy.ins().getCopyBuyInfoById(e.copy_id);if(s.left_time>0){var r=s.buy_type,a=s.buy_value;if(a>RoleProxy.ins().getMoneyAttr(r))return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(r)+"不足！");ViewManager.ins().open(FubenBuyTips,[e.copy_id,function(){CopyProxy.ins().C2SReqCopyBuyTimes(e.config.entry_copy_id)}])}else TipsControl.ins().showTips("副本购买次数不足！")}},e}(BaseItemRender);__reflect(FBMaterialItem.prototype,"FBMaterialItem"),window.FBMaterialItem=FBMaterialItem;var FBVIPItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="FBVIPItemSkin",e.addTouchEvent(e.enterbtn,e.onclick),e.reward.itemRenderer=ItemCell,e.setInfo(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setInfo()},e.prototype.setInfo=function(){if(this.data){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e=UtilProxy.StrFormart("v@0 f",[this.data.vip_level]);this.data.vip_level>18&&(e=UtilProxy.StrFormart("s@0 f",[this.data.vip_level-18]));var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);this.num.text=e[0].text,this.bg.source=this.data.show_img;var n=new Array,o=GlobalConfig.getDropConfig(this.data.normal_reward[i]),s=GlobalConfig.getDropItem(o.drop);if(void 0!=s)for(var r=0;r<s.length;r++){var a=s[r],h=new ItemCellData,l={item_slot_idx:0,item_type_id:a[0].id,item_count:a[0].num};h.setItemCellData(l),n.push(h)}var p;if(t>=this.data.vip_level){var c=CopyProxy.ins().getCopyLeftTimeById(this.data.entry_copy_id);p=UtilProxy.StrFormart("C:7&挑战次数：@0 可挑战",[c])}else p=t>18?UtilProxy.StrFormart("C:4&SVIP@0 可挑战",[this.data.vip_level-18]):UtilProxy.StrFormart("C:4&VIP@0 可挑战",[this.data.vip_level]);this.lebel1.textFlow=p,this.reward.dataProvider=new eui.ArrayCollection(n)}},e.prototype.onclick=function(t){var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),i=CopyProxy.ins().getCopyLeftTimeById(this.data.entry_copy_id);return 0>=i?void TipsControl.ins().showTips("今日已挑战过了！"):void(e>=this.data.vip_level?CopyProxy.ins().C2SReqCopyEnterCopy(this.data.entry_copy_id):TipsControl.ins().showTips("VIP等级不足！"))},e}(BaseItemRender);__reflect(FBVIPItem.prototype,"FBVIPItem"),window.FBVIPItem=FBVIPItem;var FubenBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setVisible=function(t){},e}(BaseView);__reflect(FubenBase.prototype,"FubenBase"),window.FubenBase=FubenBase;var FubenBuyTips=function(t){function e(){var e=t.call(this)||this;return e.func=void 0,e.time=10,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FubenBuyTipsSkin",this.btn.setCD(1e3),this.link.textFlow=TextFlowMaker.generateTextFlow2("|C:7&(提升VIP等级增加次数|C:6&U&前往|C:7&)|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onddClick),this.addTouchEvent(this.closebtn,this.CloseClick),this.addTouchEvent(this.black,this.onblackClick),this.link.addEventListener(egret.TextEvent.LINK,this.onClickLinks,this),EventProxy.AddListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),this.copy_id=t[0][0],this.func=t[0][1],this.showInfo(),this.CheckGuide()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onddClick),this.removeTouchEvent(this.closebtn,this.CloseClick),this.removeTouchEvent(this.black,this.onblackClick),this.link.removeEventListener(egret.TextEvent.LINK,this.onClickLinks,this),EventProxy.RemoveListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),this.func=null},e.prototype.S2CRepCopyBuyTimes=function(t){this.showInfo()},e.prototype.onClickLinks=function(t){ViewManager.ins().open(VIPView)},e.prototype.onddClick=function(t){var e=CopyProxy.ins().getCopyBuyInfoById(this.copy_id);if(e.left_time>0){var i=e.buy_type,n=e.buy_value;if(n>RoleProxy.ins().getMoneyAttr(i))return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(i)+"不足！");void 0!=this.func&&this.func()}else TipsControl.ins().showTips("副本购买次数不足！")},e.prototype.onblackClick=function(t){},e.prototype.CloseClick=function(t){ViewManager.ins().close(this)},e.prototype.showInfo=function(){var t=CopyProxy.ins().getCopyBuyInfoById(this.copy_id);this.price.text=t.buy_value.toString(),this.info.textFlow=UtilProxy.generateTextFlow("是否花费"+t.buy_value+UtilProxy.ins().getMoneyAttrName(t.buy_type)+"购买1次挑战次数\n|今天剩余购买次数|C:7&("+t.left_time+"/"+t.max_time+") ？")},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FubenBuyTips.prototype,"FubenBuyTips"),ViewManager.ins().reg(FubenBuyTips,LayerManager.UI_Main2),window.FubenBuyTips=FubenBuyTips;var S2CCopyBestRecord=function(){function t(){}return t}();__reflect(S2CCopyBestRecord.prototype,"S2CCopyBestRecord");var S2CCopyClimbInfo=function(){function t(){}return t}();__reflect(S2CCopyClimbInfo.prototype,"S2CCopyClimbInfo");var FubenItemData=function(){function t(){}return t}();__reflect(FubenItemData.prototype,"FubenItemData");var FubenTeamBuyTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FubenBuyTipsSkin",this.btn.setCD(1e3),this.link.textFlow=TextFlowMaker.generateTextFlow2("|C:7&(提升VIP等级增加次数|C:6&U&前往|C:7&)|"),this.copy_config=GlobalConfig.getTeamcopy_baseConfig(1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onddClick),this.addTouchEvent(this.closebtn,this.CloseClick),this.link.addEventListener(egret.TextEvent.LINK,this.onClickLinks,this),this.buy_times=CopyTeamProxy.ins().buy_times||0,this.vip_level=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),this.buy_max_times=this.copy_config.buy_times[this.vip_level-1]||this.copy_config.buy_times[0],this.buy_value=this.copy_config.buy_count_need[this.buy_times],this.showInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onddClick),this.removeTouchEvent(this.closebtn,this.CloseClick),this.link.removeEventListener(egret.TextEvent.LINK,this.onClickLinks,this),this.buy_times=null,this.vip_level=null,this.buy_max_times=null,this.buy_value=null},e.prototype.onddClick=function(t){switch(t.currentTarget){case this.btn:var e=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑换":"购买";CopyTeamProxy.ins().challenge_count;this.buy_times<this.buy_max_times?this.buy_value<=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)?(CopyTeamProxy.ins().C2SReqTeamcopyBuyChallengeCount(),ViewManager.ins().close(this)):TipsControl.ins().showTips("元宝不足！"):TipsControl.ins().showTips(e+"次数不足")}},e.prototype.showInfo=function(){this.price.text=this.buy_value.toString(),this.info.textFlow=UtilProxy.generateTextFlow("是否花费"+this.buy_value+UtilProxy.ins().getMoneyAttrName(MoneyAttr.YUANBAO)+"购买1次挑战次数\n|今天剩余购买次数|C:7&("+(this.buy_max_times-this.buy_times)+"/"+this.buy_max_times+") ？")},e.prototype.CloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onClickLinks=function(t){ViewManager.ins().open(VIPView)},e}(BaseEuiView);__reflect(FubenTeamBuyTips.prototype,"FubenTeamBuyTips"),ViewManager.ins().reg(FubenTeamBuyTips,LayerManager.UI_Main2),window.FubenTeamBuyTips=FubenTeamBuyTips;var FubenView_Baowu=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=FBBaowuItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.link.textFlow=UtilProxy.generateTextFlow("C:7&U&试炼宝库"),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.link,this.onLinkClick),EventProxy.AddListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),EventProxy.AddListener(this,EventType.S2CRepCopySweep,this.S2CRepCopySweep),EventProxy.AddListener(this,EventType.S2CRepCopyOnekeySweep,this.S2CRepCopyOnekeySweep)},e.prototype.S2CRepCopySweep=function(t){},e.prototype.S2CRepCopyBuyTimes=function(t){},e.prototype.S2CRepCopyOnekeySweep=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.link,this.onLinkClick),EventProxy.RemoveListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),EventProxy.RemoveListener(this,EventType.S2CRepCopyOnekeySweep,this.S2CRepCopyOnekeySweep)},e.prototype.onLinkClick=function(t){ViewManager.ins().open(BaowuStoreView)},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData()},e.prototype.setData=function(){var t=CopyProxy.ins().getBaowuEnterIdList();this.list.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(FubenView_Baowu.prototype,"FubenView_Baowu"),window.FubenView_Baowu=FubenView_Baowu;var FubenView_Material=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.setVisible(!1),this.info1.visible=!UtilProxy.shield,this.enterV.visible=!UtilProxy.shield,CopyProxy.ins().getMatericalSweepVIP()>18?this.info1.textFlow=UtilProxy.generateTextFlow("C:7&T:每日 0 点重置次数  SVIP"+(CopyProxy.ins().getMatericalSweepVIP()-18)+"可一键扫荡"):this.info1.textFlow=UtilProxy.generateTextFlow("C:7&T:每日 0 点重置次数  VIP"+CopyProxy.ins().getMatericalSweepVIP()+"可一键扫荡")},e.prototype.SetData=function(){var t=CopyProxy.ins().GetMatericalData(),e=new Array;for(var i in t){var n=t[i],o=CopyProxy.ins().GetCopyDataByCopyId(n.id),s=new FubenItemData;s.id=n.id,s.s_lvl=n.difficult_state[0],s.star=n.difficult_state[0],s.copy_id=n.id,s.enter_copy_id=n.entry_copy_id,s.times=o?Math.max(0,n.times-o.times):n.times,s.name=n.noColorName,s.info1="副本收益:",s.info2="修仙2阶提升收益星级",s.config=n,e.push(s)}this.list.dataProvider=new eui.ArrayCollection(e),this.list.itemRenderer=FBMaterialItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enterV,this.EnterVipClick),EventProxy.AddListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),EventProxy.AddListener(this,EventType.S2CRepCopySweep,this.S2CRepCopySweep),EventProxy.AddListener(this,EventType.S2CRepCopyOnekeySweep,this.S2CRepCopyOnekeySweep)},e.prototype.S2CRepCopySweep=function(t){var e=t;this.RefreshData(e)},e.prototype.S2CRepCopyBuyTimes=function(t){var e=t;this.RefreshData(e)},e.prototype.S2CRepCopyOnekeySweep=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetData()},e.prototype.RefreshData=function(t){for(var e=0;e<this.list.numChildren;++e){var i=this.list.getChildAt(e);if(i){var n=i.data;n&&n.enter_copy_id==t&&i.refresh()}}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enterV,this.EnterVipClick),EventProxy.RemoveListener(this,EventType.S2CRepCopyBuyTimes,this.S2CRepCopyBuyTimes),EventProxy.RemoveListener(this,EventType.S2CRepCopyOnekeySweep,this.S2CRepCopyOnekeySweep)},e.prototype.setVisible=function(t){this.visible=t,t&&(this.vipInfo(),this.SetData(),this.CheckGuide())},e.prototype.EnterVipClick=function(t){if(CopyProxy.ins().isMatericalEnoughVIP()){for(var e=!1,i=!1,n=CopyProxy.ins().materical_data_list,o=0;o<n.length;++o){var s=n[o];if(s){var r=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),a=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),h=s.open_zhuan,l=s.open_level;if(!(h>r||l>a)){var p=CopyProxy.ins().getCopyLeftTimeById(s.id);if(p>0&&(e=!0,CopyProxy.ins().isCopyEnter(s.id))){i=!0;break}}}}i?CopyProxy.ins().C2SReqCopyOnekeySweep(CopySpeciallogicType.single_copy):e?TipsControl.ins().showTips("请先通关BOSS再扫荡！"):TipsControl.ins().showTips("已没挑战次数！")}else NoticeProxy.ins().OpenRecharge()},e.prototype.vipInfo=function(){this.enterV.label=CopyProxy.ins().isMatericalEnoughVIP()?"一键扫荡":"激活VIP"},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FubenView_Material.prototype,"FubenView_Material"),window.FubenView_Material=FubenView_Material;var FubenView_shtower=function(t){function e(){var e=t.call(this)||this;return e.isEndFloor=!1,e}return __extends(e,t),e.prototype.initUI=function(){this.dropL.itemRenderer=ItemCell,this.dropS.viewport=this.dropL,this.rewardL.itemRenderer=ItemCell,this.rewardS.viewport=this.rewardL,this.visible=!1,this.HideRewardView()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.EnterClick),this.addTouchEvent(this.reward,this.RewardClick),this.addTouchEvent(this.upfight,this.UpfightClick),this.addTouchEvent(this.rank,this.RankClick),this.addTouchEvent(this.rewardBtn,this.rewardBtnClick),this.addTouchEvent(this.rewardClose,this.rewardCloseClick),this.InitData(),EventProxy.AddListener(this,EventType.S2CCopyRepCopyGetClimbReward,this.S2CCopyRepCopyGetClimbReward)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.EnterClick),this.removeTouchEvent(this.reward,this.RewardClick),this.removeTouchEvent(this.upfight,this.UpfightClick),this.removeTouchEvent(this.rank,this.RankClick),this.removeTouchEvent(this.rewardBtn,this.rewardBtnClick),this.removeTouchEvent(this.rewardClose,this.rewardCloseClick),EventProxy.RemoveListener(this,EventType.S2CCopyRepCopyGetClimbReward,this.S2CCopyRepCopyGetClimbReward)},e.prototype.EnterClick=function(t){if(this.isEndFloor)NoticeProxy.ins().ErrCode(54);else{var e=GameLogic.ins().getCurSceneData();1==e.speciallogic_type?CopyProxy.ins().C2SReqCopyEnterCopy(CopyProxy.ins().sht_climb_enter_id):TipsControl.ins().showTips("C:4&当前场景无法挑战！")}},e.prototype.RewardClick=function(t){this.ShowRewardView()},e.prototype.UpfightClick=function(t){TipsControl.ins().showTips("暂未开启")},e.prototype.RankClick=function(t){ViewManager.ins().open(RankView,12)},e.prototype.setVisible=function(t){this.visible=t,t&&this.CheckGuide()},e.prototype.InitData=function(){var t,e=CopyProxy.ins().sht_climb_enter_id,i=CopyProxy.ins().GetCopyDataByCopyId(e),n=new Copy_dataConfig,o=0,s="无",r="",a=0,h=1,l="仙术.妙法",p=1,c=20,u=16,d=0;if(void 0==i)n=GlobalConfig.getCopyConfigById(e),t=CopyProxy.ins().SHTNextBigReward(0),d=1;else if(void 0!=i.best_record?(s=i.best_record.name,o=i.best_record.time-e+1):(s="",o=0),void 0!=i.climb_info){void 0!=i.climb_info.limit_record&&(r=i.climb_info.limit_record.name,a=i.climb_info.limit_record.fighting);var g=Math.max(i.climb_info.last_floor,e);n=GlobalConfig.getCopyConfigById(g+1),void 0==n?(this.isEndFloor=!0,n=GlobalConfig.getCopyConfigById(g),d=g-e+1):d=g-e+1+1,t=CopyProxy.ins().SHTNextBigReward(i.climb_info.last_floor)}else CommonUtils.log("copy_data.climb_info == null,enter_id--->",e);if(void 0!=t&&t.show_drop.length>0){var y=t.show_drop,f=new ItemCellData,_={item_slot_idx:0,item_type_id:y[0],item_count:y[1]};f.setItemCellData(_),this.bigreward.data=f,l=f.itemConfig.name,h=t.id-t.entry_copy_id+1}else{var v=CopyProxy.ins().SHTLastBigReward(),y=v.show_drop,f=new ItemCellData,_={item_slot_idx:0,item_type_id:y[0],item_count:y[1]};f.setItemCellData(_),this.bigreward.data=f,l=f.itemConfig.name,h=v.id-v.entry_copy_id+1}this.endInfo.visible=this.isEndFloor,this.enter.visible=!this.isEndFloor,this.info0.textFlow=UtilProxy.generateTextFlow("最高记录："+o+"层"),this.info1.textFlow=UtilProxy.generateTextFlow("榜首："+s),this.info2.textFlow=UtilProxy.generateTextFlow("C:10&极限通关：| "+r),this.info3.textFlow=UtilProxy.generateTextFlow("C:10&通关战力：| "+a),this.fbreward.textFlow=UtilProxy.generateTextFlow("C:10&"+h+"层大奖"),this.item_name.textFlow=UtilProxy.generateTextFlow("C:9&"+l),this.fightValue.textFlow=UtilProxy.generateTextFlow(""),this.freward.textFlow=UtilProxy.generateTextFlow("C:10&"+p+"层奖励"),this.freward1.textFlow=UtilProxy.generateTextFlow("前|C:7&"+c+"|双倍领取"),this.freward2.textFlow=UtilProxy.generateTextFlow("已通关|C:7&"+u+"|人"),this.floorNum.text=Math.max(1,d).toString();for(var m=GlobalConfig.getDropConfig(n.normal_reward[0]),C=(GlobalConfig.getDropItem(m.drop),new Array),S=0;S<n.show_copy_drop.length;S++){var w=UtilProxy.GetItemCellData(n.show_copy_drop[S][0],n.show_copy_drop[S][1]);C.push(w)}this.RefreshData(),this.dropL.dataProvider=new eui.ArrayCollection(C),this.dropL.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)},e.prototype.RefreshData=function(){var t=CopyProxy.ins().GetSHTNextRewardData(),e=-1,i=20,n=16;null!=t&&(e=t.floor),this.freward.textFlow=UtilProxy.generateTextFlow("C:10&"+e+"层奖励"),this.freward1.textFlow=UtilProxy.generateTextFlow("前|C:7&"+i+"|双倍领取"),this.freward2.textFlow=UtilProxy.generateTextFlow("已通关|C:7&"+n+"|人"),this.reward.setRed(CopyProxy.ins().isSHTowerReward())},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&ViewManager.ins().open(ItemTipsView,e)},e.prototype.S2CCopyRepCopyGetClimbReward=function(){this.RefreshData(),this.setRewardData()},e.prototype.rewardBtnClick=function(t){var e=CopyProxy.ins().GetSHTNextRewardData(),i=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().sht_climb_enter_id);if(void 0!=i&&void 0!=i.climb_info)if(null!=e){var n=i.climb_info.last_floor-CopyProxy.ins().sht_climb_enter_id+1;n>=e.floor?CopyProxy.ins().C2SReqCopyGetClimbReward(CopyProxy.ins().sht_climb_enter_id,0,e.index):TipsControl.ins().showTips("未达到领取条件!")}else TipsControl.ins().showTips("已领完!");else TipsControl.ins().showTips("未达到领取条件!")},e.prototype.rewardCloseClick=function(t){this.HideRewardView()},e.prototype.ShowRewardView=function(){this.rewardG.visible=!0,this.setRewardData()},e.prototype.setRewardData=function(){var t=CopyProxy.ins().GetSHTNextRewardData(),e=t.floor;this.floorInfo.text="锁魂塔达到"+e+"层，可领取：";var i=GlobalConfig.getDropConfig(t.reward),n=GlobalConfig.getDropItem(i.drop),o=new Array;if(void 0!=n)for(var s=0;s<n.length;s++){var r=n[s],a=new ItemCellData,h={item_slot_idx:0,item_type_id:r[0].id,item_count:r[0].num};a.setItemCellData(h),o.push(a)}this.rewardL.dataProvider=new eui.ArrayCollection(o),this.rewardL.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)},e.prototype.HideRewardView=function(){this.rewardG.visible=!1},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FubenView_shtower.prototype,"FubenView_shtower"),window.FubenView_shtower=FubenView_shtower;var FubenView_Sword=function(t){function e(){var e=t.call(this)||this;return e.isEndFloor=!1,e}return __extends(e,t),e.prototype.initUI=function(){this.dropL.itemRenderer=ItemCell,this.dropS.viewport=this.dropL,this.rewardL.itemRenderer=ItemCell,this.rewardS.viewport=this.rewardL,this.HideRewardView(),this.sweepBtn.setLabel(""),this.link.textFlow=UtilProxy.generateTextFlow("C:7&U&前往镶嵌"),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.EnterClick),this.addTouchEvent(this.sweepBtn,this.sweepBtnClick),this.addTouchEvent(this.upfight,this.UpfightClick),this.addTouchEvent(this.rewardBtn,this.rewardBtnClick),this.addTouchEvent(this.rewardClose,this.rewardCloseClick),this.addTouchEvent(this.link,this.onLinkClick),this.InitData(),EventProxy.AddListener(this,EventType.S2CRepCopySweep,this.S2CRepCopySweep)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.EnterClick),this.removeTouchEvent(this.sweepBtn,this.sweepBtnClick),this.removeTouchEvent(this.upfight,this.UpfightClick),this.removeTouchEvent(this.rewardBtn,this.rewardBtnClick),this.removeTouchEvent(this.rewardClose,this.rewardCloseClick),this.removeTouchEvent(this.link,this.onLinkClick),EventProxy.RemoveListener(this,EventType.S2CRepCopySweep,this.S2CRepCopySweep)},e.prototype.EnterClick=function(t){if(this.isEndFloor)NoticeProxy.ins().ErrCode(54);else{var e=GameLogic.ins().getCurSceneData();1==e.speciallogic_type?CopyProxy.ins().C2SReqCopyEnterCopy(CopyProxy.ins().sword_enter_id):TipsControl.ins().showTips("C:4&当前场景无法挑战！")}},e.prototype.sweepBtnClick=function(t){this.ShowRewardView()},e.prototype.UpfightClick=function(t){TipsControl.ins().showTips("暂未开启")},e.prototype.onLinkClick=function(t){ViewManager.ins().open(FuwenView)},e.prototype.setVisible=function(t){this.visible=t,t&&this.CheckGuide()},e.prototype.S2CRepCopySweep=function(t){this.rewardG.visible&&(this.rewardG.visible=!1),this.RefreshData()},e.prototype.InitData=function(){var t=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().sword_enter_id),e=new Copy_dataConfig,i=0,n="无",o="",s=0,r=1;if(void 0==t)e=GlobalConfig.getCopyConfigById(CopyProxy.ins().sword_enter_id);else if(void 0!=t.best_record?(n=t.best_record.name,i=t.best_record.time-CopyProxy.ins().sword_enter_id+1):(n="",i=0),void 0!=t.climb_info){void 0!=t.climb_info.limit_record&&(o=t.climb_info.limit_record.name,s=t.climb_info.limit_record.fighting);var a=Math.max(t.climb_info.last_floor,CopyProxy.ins().sword_enter_id);e=GlobalConfig.getCopyConfigById(a+1),void 0==e?(this.isEndFloor=!0,e=GlobalConfig.getCopyConfigById(a),r=a-CopyProxy.ins().sword_enter_id+1):r=a-CopyProxy.ins().sword_enter_id+1+1}else CommonUtils.log("copy_data.climb_info == null,enter_id--->",CopyProxy.ins().sword_enter_id);this.endInfo.visible=this.isEndFloor,this.enter.visible=!this.isEndFloor,this.info0.textFlow=UtilProxy.generateTextFlow("最高记录："+i+"层"),this.info1.textFlow=UtilProxy.generateTextFlow("榜首："+n),this.info2.textFlow=UtilProxy.generateTextFlow("C:10&极限通关：| "+o),this.info3.textFlow=UtilProxy.generateTextFlow("C:10&通关战力：| "+s),this.floorNum.text=Math.max(1,r).toString();var h=GlobalConfig.getDropConfig(e.normal_reward[0]),l=GlobalConfig.getDropItem(h.drop),p=new Array;if(void 0!=l)for(var c=0;c<l.length;c++){var u=l[c],d=new ItemCellData,g={item_slot_idx:0,item_type_id:u[0].id,item_count:u[0].num};d.setItemCellData(g),p.push(d)}this.RefreshData(),this.dropL.dataProvider=new eui.ArrayCollection(p),this.refreshFuwenData()},e.prototype.refreshFuwenData=function(){var t=CopyProxy.ins().sword_enter_id,e=CopyProxy.ins().GetCopyDataByCopyId(t),i=0;void 0!=e&&void 0!=e.climb_info&&e.climb_info.last_floor>0&&(i=e.climb_info.last_floor);var n=-1,o=GlobalConfig.getfwLockList(),s=GlobalConfig.getfwPreList(),r=!1,a="",h="",l=5,p=0,c=0;for(var u in o){var d=o[u],g=d.id-t+1;if(d.id>i){n=g,p=d.pos_list[0];break}g>c&&(c=g)}for(var u in s){var y=s[u],f=0,_=!1;for(var v in y){if(f>1)break;if(f+=1,y[v].lv>i-t+1&&y[v].lv>0){_=!0,n<y[v].lv?r=!0:(n=y[v].lv,a=AssetMgr.getIconResource(GlobalConfig.getfwResById(y[v].id,l).icon));break}y[v].lv>c&&(c=y[v].lv,h=AssetMgr.getIconResource(GlobalConfig.getfwResById(y[v].id,l).icon))}if(_)break}this.fbreward.text="第"+Math.max(c,n)+"层",r?(this.fwIcon.visible=!1,this.fwAdd.visible=!0,this.fwBg.source="jianxin_dikuang_01",this.item_name.text="第"+p+"个剑心槽"):(this.fwIcon.visible=!0,this.fwAdd.visible=!1,this.fwBg.source="jianxin_dikuang_0"+l,this.fwIcon.source=a,-1==n?this.item_name.text="已解锁所有剑心":this.item_name.text="解锁新剑心")},e.prototype.RefreshData=function(){var t=GlobalConfig.getCopyConfigById(CopyProxy.ins().sword_enter_id),e=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().sword_enter_id);void 0!=e?(this.sweepBtn.setLabel("今日扫荡：|C:7&"+Math.max(t.sweep_times-e.sweep_times,0)+"次"),this.sweepBtn.setRed(t.sweep_times-e.sweep_times>0)):(this.sweepBtn.setLabel("今日扫荡："+t.sweep_times+"次"),this.sweepBtn.setRed(!0))},e.prototype.rewardBtnClick=function(t){var e=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().sword_enter_id);if(void 0!=e&&void 0!=e.climb_info&&e.climb_info.last_floor>0){var i=GlobalConfig.getCopyConfigById(CopyProxy.ins().sword_enter_id);e.sweep_times>=i.sweep_times?TipsControl.ins().showTips("没有扫荡次数!"):CopyProxy.ins().C2SReqCopySweep(i.entry_copy_id)}else TipsControl.ins().showTips("未通关不能扫荡!")},e.prototype.rewardCloseClick=function(t){this.HideRewardView()},e.prototype.ShowRewardView=function(){this.setRewardData()},e.prototype.setRewardData=function(){var t=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().sword_enter_id);if(void 0!=t&&void 0!=t.climb_info&&t.climb_info.last_floor>0){var e=GlobalConfig.getCopyConfigById(CopyProxy.ins().sword_enter_id);if(t.sweep_times>=e.sweep_times)return void TipsControl.ins().showTips("没有扫荡次数!");this.rewardG.visible=!0;for(var i={},n=0;n<CopyProxy.ins().tower_sword_data_list.length;++n){var o=CopyProxy.ins().tower_sword_data_list[n];if(o.id==t.climb_info.last_floor){var s=GlobalConfig.getDropConfig(o.sweep_drop_id[0]),r=GlobalConfig.getDropItem(s.drop);if(void 0!=r)for(var a=0;a<r.length;a++){var h=r[a];void 0==i[h[0].id]?i[h[0].id]=h[0].num:i[h[0].id]=i[h[0].id]+h[0].num}}}var l=new Array;for(var p in i){var c=UtilProxy.GetItemCellData(Number(p),i[p]);l.push(c)}this.rewardL.dataProvider=new eui.ArrayCollection(l)}else TipsControl.ins().showTips("未通关不能扫荡!")},e.prototype.HideRewardView=function(){this.rewardG.visible=!1},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FubenView_Sword.prototype,"FubenView_Sword"),window.FubenView_Sword=FubenView_Sword;var FubenView_Team=function(t){function e(){var e=t.call(this)||this;return e.isUseScr0ll=!1,e.isInitMatch=!1,e.waitTime=-1,e.matchingTime=6,e}return __extends(e,t),e.prototype.initUI=function(){this.matchingG.visible=!1,this.setVisible(!1),this.person_list=[this.person1,this.person2,this.person3],this.roleIcon_list=[this.roleIcon1,this.roleIcon2,this.roleIcon3],this.roleName_list=[this.roleName1,this.roleName2,this.roleName3],this.roleFight_list=[this.roleFight1,this.roleFight2,this.roleFight3],this.dlist.itemRenderer=ItemCell,this.dscroller.viewport=this.dlist,this.scrollID=CopyTeamProxy.ins().teamChallengeScrollID},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];
this.addTouchEvent(this.enterBtn,this.onClick),this.addTouchEvent(this.addBtn,this.onClick),this.addTouchEvent(this.cancelBtn,this.onClick),this.addTouchEndEvent(this.scrolltips,this.onClick),EventProxy.AddListener(this,EventType.S2CTeamcopyStartMatching,this.S2CTeamcopyStartMatching),EventProxy.AddListener(this,EventType.S2CTeamcopyCancelMatching,this.S2CTeamcopyCancelMatching),EventProxy.AddListener(this,EventType.S2CTeamcopyBuyChallengeCount,this.S2CTeamcopyBuyChallengeCount),EventProxy.AddListener(this,EventType.S2CTeamcopyMemberChange,this.S2CTeamcopyMemberChange),EventProxy.AddListener(this,EventType.S2CTeamcopyMatchingSuccess,this.S2CTeamcopyMatchingSuccess),EventProxy.AddListener(this,EventType.S2CRepKnapsackGetUseCount,this.S2CRepKnapsackGetUseCount),EventProxy.AddListener(this,EventType.S2CTeamcopyGetInfo,this.S2CTeamcopyGetInfo),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.UpdateBagInfo),BagProxy.ins().C2SReqKnapsackGetUseCount(),this.isUseScr0ll=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enterBtn,this.onClick),this.removeTouchEvent(this.addBtn,this.onClick),this.removeTouchEvent(this.cancelBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CTeamcopyStartMatching,this.S2CTeamcopyStartMatching),EventProxy.RemoveListener(this,EventType.S2CTeamcopyCancelMatching,this.S2CTeamcopyCancelMatching),EventProxy.RemoveListener(this,EventType.S2CTeamcopyBuyChallengeCount,this.S2CTeamcopyBuyChallengeCount),EventProxy.RemoveListener(this,EventType.S2CTeamcopyMemberChange,this.S2CTeamcopyMemberChange),EventProxy.RemoveListener(this,EventType.S2CTeamcopyMatchingSuccess,this.S2CTeamcopyMatchingSuccess),EventProxy.RemoveListener(this,EventType.S2CRepKnapsackGetUseCount,this.S2CRepKnapsackGetUseCount),EventProxy.RemoveListener(this,EventType.S2CTeamcopyGetInfo,this.S2CTeamcopyGetInfo),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.UpdateBagInfo),TimerManager.ins().removeAll(this),CopyTeamProxy.ins().isStartmatching&&CopyTeamProxy.ins().C2SReqTeamcopyCancelMatching()},e.prototype.S2CTeamcopyStartMatching=function(t){this.refreshMatching()},e.prototype.refreshMatching=function(){this.isInitMatch||(this.matchingG.visible=!0,this.waitTime=-1,this.matchFinish.visible=!1,this.waiting.visible=!0,TimerManager.ins().doTimer(1e3,0,this.UpdateWait,this),this.UpdateWait(),this.isInitMatch=!0),this.setTeamInfo()},e.prototype.UpdateWait=function(){this.waitTime=this.waitTime+1,this.wait.text="等待小伙伴加入("+this.waitTime+")"},e.prototype.S2CTeamcopyCancelMatching=function(t){TimerManager.ins().removeAll(this),this.matchingG.visible=!1,this.isInitMatch=!1},e.prototype.S2CTeamcopyBuyChallengeCount=function(t){this.SetData()},e.prototype.S2CTeamcopyMemberChange=function(t){this.refreshMatching()},e.prototype.S2CTeamcopyMatchingSuccess=function(t){this.matchFinish.visible=!0,this.waiting.visible=!1,this.setTeamInfo(),TimerManager.ins().remove(this.UpdateWait,this),TimerManager.ins().doTimer(1e3,0,this.UpdateMatching,this),this.UpdateMatching()},e.prototype.UpdateMatching=function(){this.matchingTime=this.matchingTime-1,this.matchNum.source="zudui_font_shuzi_0"+(this.matchingTime+1),this.matchingTime<0&&ViewManager.ins().close(FubenView)},e.prototype.setTeamInfo=function(){var t=0;if(void 0!=CopyTeamProxy.ins().list){t=CopyTeamProxy.ins().list.length;for(var e=0;e<CopyTeamProxy.ins().list.length;++e){var i=CopyTeamProxy.ins().list[e];this.roleIcon_list[e].visible=!0,1==i.prof?this.roleIcon_list[e].source="common_morentouxaing_01":this.roleIcon_list[e].source="common_morentouxaing_02",this.roleName_list[e].text=i.name,this.roleFight_list[e].text="战力: "+i.fighting}}for(var e=0;e<this.person_list.length;++e)e>=t&&(this.roleIcon_list[e].visible=!1,this.roleName_list[e].text="",this.roleFight_list[e].text="")},e.prototype.SetData=function(){var t=GlobalConfig.getTeamcopy_baseConfig(1);this.times.text="挑战次数： "+(CopyTeamProxy.ins().challenge_count||0)+"/ "+t.challenge_limit,this.Dec.text=t.dec;var e="",i="",n=0|CopyTeamProxy.ins().top_kill_num;void 0!=CopyTeamProxy.ins().record?(e="S"+CopyTeamProxy.ins().record.server_id+" "+CopyTeamProxy.ins().record.name,i=CopyTeamProxy.ins().record.kill_num.toString()):(e="",i=""),this.info0.text="最高纪录: "+i,this.info1.text="纪录保持\n  "+e,this.info2.text="我的纪录: "+n;for(var o=GlobalConfig.getCopyConfigById(CopyProxy.ins().team_exp_enter_id),s=new Array,r=0;r<o.show_copy_drop.length;r++){var a=UtilProxy.GetItemCellData(o.show_copy_drop[r][0],o.show_copy_drop[r][1]);s.push(a)}this.dlist.dataProvider=new eui.ArrayCollection(s),this.setScrollData()},e.prototype.setScrollData=function(){this.ownScrollCount=BagProxy.ins().getItemCountById(this.scrollID),this.timesCof=GlobalConfig.getuse_timesConfig(this.scrollID),this.scrollcount.textFlow=UtilProxy.StrFormart("@0 / @1 ",[this.ownScrollCount,1])},e.prototype.onClick=function(t){switch(t.currentTarget){case this.scrolltips:var e=void 0;e=this.ownScrollCount<=0?UtilProxy.GetItemCellData(this.scrollID,0):UtilProxy.GetItemCellData(this.scrollID,this.ownScrollCount),ViewManager.ins().open(ItemTipsView,e);break;case this.enterBtn:if(CopyTeamProxy.ins().challenge_count>0)CopyTeamProxy.ins().C2SReqTeamcopyStartMatching();else if(this.ownScrollCount>0&&this.scrollUseCount<this.timesCof.times){this.isUseScr0ll=!1;var i=BagProxy.ins().getItemCellData(this.scrollID);if(void 0!=i){var n=[],o=[];o[0]=i.item_slot_idx,o[1]=i.item_count,n[0]=o,BagProxy.ins().C2SReqKnapsackUse(n),this.isUseScr0ll=!0}else TipsControl.ins().showTips("没有对应的背包数据")}else TipsControl.ins().showTips("挑战次数不足");break;case this.addBtn:var s=GlobalConfig.getTeamcopy_baseConfig(1);if(CopyTeamProxy.ins().challenge_count>=s.challenge_limit)return void TipsControl.ins().showTips("挑战次数上限");ViewManager.ins().open(FubenTeamBuyTips);break;case this.cancelBtn:CopyTeamProxy.ins().C2SReqTeamcopyCancelMatching()}},e.prototype.setVisible=function(t){this.visible=t,t?(this.isInitMatch=!1,this.SetData(),this.CheckGuide()):(this.matchingG.visible=!1,TimerManager.ins().removeAll(this),CopyTeamProxy.ins().isStartmatching&&CopyTeamProxy.ins().C2SReqTeamcopyCancelMatching())},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e.prototype.S2CRepKnapsackGetUseCount=function(t){this.scrollUseCount=BagProxy.ins().getUseCountDataByID(this.scrollID),this.setScrollData()},e.prototype.S2CTeamcopyGetInfo=function(t){if(this.isUseScr0ll){this.isUseScr0ll=!1,CopyTeamProxy.ins().C2SReqTeamcopyStartMatching();var e=GlobalConfig.getTeamcopy_baseConfig(1);this.times.text="挑战次数： "+(CopyTeamProxy.ins().challenge_count||0)+"/ "+e.challenge_limit}},e.prototype.UpdateBagInfo=function(t){this.setScrollData()},e}(BaseEuiView);__reflect(FubenView_Team.prototype,"FubenView_Team"),window.FubenView_Team=FubenView_Team;var FubenView_VIP=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=FBVIPItem,this.scroller.viewport=this.list,this.link.textFlow=UtilProxy.generateTextFlow("C:7&U&提升VIP"),this.setVisible(!1),this.vipConfig=GlobalConfig.GetVIPCopyConfig(),this.list.dataProvider=new eui.ArrayCollection(this.vipConfig)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.vip_level=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),this.addTouchEvent(this.link,this.onLinkClick),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.link,this.onLinkClick),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney)},e.prototype.onLinkClick=function(t){ViewManager.ins().open(VIPView)},e.prototype.UpdataMoney=function(t){void 0!=t&&t==MoneyAttr.VIP_EXP&&this.vip_level!=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)&&(this.vip_level=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),this.list.dataProvider=new eui.ArrayCollection(this.vipConfig))},e}(BaseEuiView);__reflect(FubenView_VIP.prototype,"FubenView_VIP"),window.FubenView_VIP=FubenView_VIP;var FubenView_zytower=function(t){function e(){var e=t.call(this)||this;return e.isEndFloor=!1,e}return __extends(e,t),e.prototype.initUI=function(){this.dropL.itemRenderer=ItemCell,this.dropS.viewport=this.dropL,this.rewardL.itemRenderer=ItemCell,this.rewardS.viewport=this.rewardL,this.visible=!1,this.HideRewardView()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enter,this.EnterClick),this.addTouchEvent(this.reward,this.RewardClick),this.addTouchEvent(this.upfight,this.UpfightClick),this.addTouchEvent(this.rank,this.RankClick),this.addTouchEvent(this.rewardBtn,this.rewardBtnClick),this.addTouchEvent(this.rewardClose,this.rewardCloseClick),this.InitData(),EventProxy.AddListener(this,EventType.S2CCopyRepCopyGetClimbReward,this.S2CCopyRepCopyGetClimbReward)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enter,this.EnterClick),this.removeTouchEvent(this.reward,this.RewardClick),this.removeTouchEvent(this.upfight,this.UpfightClick),this.removeTouchEvent(this.rank,this.RankClick),this.removeTouchEvent(this.rewardBtn,this.rewardBtnClick),this.removeTouchEvent(this.rewardClose,this.rewardCloseClick),EventProxy.RemoveListener(this,EventType.S2CCopyRepCopyGetClimbReward,this.S2CCopyRepCopyGetClimbReward)},e.prototype.EnterClick=function(t){if(this.isEndFloor)NoticeProxy.ins().ErrCode(54);else{var e=GameLogic.ins().getCurSceneData();1==e.speciallogic_type?CopyProxy.ins().C2SReqCopyEnterCopy(CopyProxy.ins().simple_climb_enter_id):TipsControl.ins().showTips("C:4&当前场景无法挑战！")}},e.prototype.RewardClick=function(t){this.ShowRewardView()},e.prototype.UpfightClick=function(t){TipsControl.ins().showTips("暂未开启")},e.prototype.RankClick=function(t){ViewManager.ins().open(RankView,12)},e.prototype.setVisible=function(t){this.visible=t,t&&this.CheckGuide()},e.prototype.InitData=function(){var t,e=CopyProxy.ins().simple_climb_enter_id,i=CopyProxy.ins().GetCopyDataByCopyId(e),n=new Copy_dataConfig,o=0,s="无",r="",a=0,h=1,l="仙术.妙法",p=1,c=20,u=16,d=0;if(void 0==i)n=GlobalConfig.getCopyConfigById(e),t=CopyProxy.ins().NextBigReward(0),d=1;else if(void 0!=i.best_record?(s=i.best_record.name,o=i.best_record.time-e+1):(s="",o=0),void 0!=i.climb_info){void 0!=i.climb_info.limit_record&&(r=i.climb_info.limit_record.name,a=i.climb_info.limit_record.fighting);var g=Math.max(i.climb_info.last_floor,e);n=GlobalConfig.getCopyConfigById(g+1),void 0==n?(this.isEndFloor=!0,n=GlobalConfig.getCopyConfigById(g),d=g-e+1):d=g-e+1+1,t=CopyProxy.ins().NextBigReward(i.climb_info.last_floor)}else CommonUtils.log("copy_data.climb_info == null,enter_id--->",e);if(void 0!=t&&t.show_drop.length>0){var y=t.show_drop,f=new ItemCellData,_={item_slot_idx:0,item_type_id:y[0],item_count:y[1]};f.setItemCellData(_),this.bigreward.data=f,l=f.itemConfig.name,h=t.id-t.entry_copy_id+1}else{var v=CopyProxy.ins().LastBigReward(),y=v.show_drop,f=new ItemCellData,_={item_slot_idx:0,item_type_id:y[0],item_count:y[1]};f.setItemCellData(_),this.bigreward.data=f,l=f.itemConfig.name,h=v.id-v.entry_copy_id+1}this.endInfo.visible=this.isEndFloor,this.enter.visible=!this.isEndFloor,this.info0.textFlow=UtilProxy.generateTextFlow("最高记录："+o+"层"),this.info1.textFlow=UtilProxy.generateTextFlow("榜首："+s),this.info2.textFlow=UtilProxy.generateTextFlow("C:10&极限通关：| "+r),this.info3.textFlow=UtilProxy.generateTextFlow("C:10&通关战力：| "+a),this.fbreward.textFlow=UtilProxy.generateTextFlow("C:10&"+h+"层大奖"),this.item_name.textFlow=UtilProxy.generateTextFlow("C:9&"+l),this.fightValue.textFlow=UtilProxy.generateTextFlow(""),this.freward.textFlow=UtilProxy.generateTextFlow("C:10&"+p+"层奖励"),this.freward1.textFlow=UtilProxy.generateTextFlow("前|C:7&"+c+"|双倍领取"),this.freward2.textFlow=UtilProxy.generateTextFlow("已通关|C:7&"+u+"|人"),this.floorNum.text=Math.max(1,d).toString();for(var m=GlobalConfig.getDropConfig(n.normal_reward[0]),C=(GlobalConfig.getDropItem(m.drop),new Array),S=0;S<n.show_copy_drop.length;S++){var w=UtilProxy.GetItemCellData(n.show_copy_drop[S][0],n.show_copy_drop[S][1]);C.push(w)}this.RefreshData(),this.dropL.dataProvider=new eui.ArrayCollection(C),this.dropL.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)},e.prototype.RefreshData=function(){var t=CopyProxy.ins().GetNextRewardData(),e=-1,i=20,n=16;null!=t&&(e=t.floor),this.freward.textFlow=UtilProxy.generateTextFlow("C:10&"+e+"层奖励"),this.freward1.textFlow=UtilProxy.generateTextFlow("前|C:7&"+i+"|双倍领取"),this.freward2.textFlow=UtilProxy.generateTextFlow("已通关|C:7&"+n+"|人"),this.reward.setRed(CopyProxy.ins().isZYTowerReward())},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&ViewManager.ins().open(ItemTipsView,e)},e.prototype.S2CCopyRepCopyGetClimbReward=function(){this.RefreshData(),this.setRewardData()},e.prototype.rewardBtnClick=function(t){var e=CopyProxy.ins().GetNextRewardData(),i=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().simple_climb_enter_id);if(void 0!=i&&void 0!=i.climb_info)if(null!=e){var n=i.climb_info.last_floor-CopyProxy.ins().simple_climb_enter_id+1;n>=e.floor?CopyProxy.ins().C2SReqCopyGetClimbReward(CopyProxy.ins().simple_climb_enter_id,0,e.index):TipsControl.ins().showTips("未达到领取条件!")}else TipsControl.ins().showTips("已领完!");else TipsControl.ins().showTips("未达到领取条件!")},e.prototype.rewardCloseClick=function(t){this.HideRewardView()},e.prototype.ShowRewardView=function(){this.rewardG.visible=!0,this.setRewardData()},e.prototype.setRewardData=function(){var t=CopyProxy.ins().GetNextRewardData(),e=t.floor;this.floorInfo.text="镇妖塔达到"+e+"层，可领取：";var i=GlobalConfig.getDropConfig(t.reward),n=GlobalConfig.getDropItem(i.drop),o=new Array;if(void 0!=n)for(var s=0;s<n.length;s++){var r=n[s],a=new ItemCellData,h={item_slot_idx:0,item_type_id:r[0].id,item_count:r[0].num};a.setItemCellData(h),o.push(a)}this.rewardL.dataProvider=new eui.ArrayCollection(o),this.rewardL.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)},e.prototype.HideRewardView=function(){this.rewardG.visible=!1},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(FubenView_zytower.prototype,"FubenView_zytower"),window.FubenView_zytower=FubenView_zytower;var FubenView=function(t){function e(){var e=t.call(this)||this;return e.current_index=-1,e.redFunc={0:CopyProxy.ins().GetMatericalCopyRed(),1:CopyProxy.ins().GetZYTowerCopyRed(),2:CopyProxy.ins().getRed(),3:CopyProxy.ins().getSwordRed(),4:!1,5:CopyProxy.ins().GetVIPCopyRed(),6:CopyProxy.ins().GetSHTowerCopyRed()},e.current_view=null,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FubenViewSkin",this.sys_list=[this.sys0,this.sys1,this.sys2,this.sys3,this.sys4,this.sys5,this.sys6],this.comview.initUI(),this.FB_ZYT.initUI(),this.FB_MT.initUI(),this.FB_TM.initUI(),this.FB_SW.initUI(),this.FB_BW.initUI(),this.FB_VIP.initUI(),this.FB_SHT.initUI()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),CopyProxy.ins().InitCopyData();for(var i=0;i<this.sys_list.length;i++)this.addTouchEvent(this.sys_list[i],this.onSysClick);(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?(this.group5.visible=!1,this.group5.includeInLayout=!1):(this.group5.visible=!0,this.group5.includeInLayout=!0),this.addTouchEvent(this.btnclose,this.CloseClick),this.FB_ZYT.open(),this.FB_MT.open(),this.FB_TM.open(),this.FB_SW.open(),this.FB_BW.open(),this.FB_VIP.open(),this.FB_SHT.open(),t&&t[0]?this.setCurrentView(t[0]):this.setCurrentView(0),this.setRed(),this.actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emSYT),this.scrollerbtns.viewport=this.scrollerg,this.scrollerbtns.addEventListener(eui.UIEvent.CHANGE_END,this.onScrollEnd,this),this.onScrollEnd()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.sys_list.length;i++)this.removeTouchEvent(this.sys_list[i],this.onSysClick);this.removeTouchEvent(this.btnclose,this.CloseClick),this.FB_ZYT.close(),this.FB_MT.close(),this.FB_TM.close(),this.FB_SW.close(),this.FB_BW.close(),this.FB_VIP.close(),this.FB_SHT.close(),null!=this.current_view&&(this.current_view.setVisible(!1),this.current_view=null,this.current_index=-1),this.scrollerbtns.removeEventListener(eui.UIEvent.CHANGE_END,this.onScrollEnd,this)},e.prototype.CloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSysClick=function(t){var e=this.sys_list.indexOf(t.currentTarget);if(e>0){var i=2,n=600+e;SystemOpenProxy.ins().isOpen(i,n)&&this.setCurrentView(e)}else this.setCurrentView(e)},e.prototype.setCurrentView=function(t){if(this.current_index!=t){null!=this.current_view&&this.current_view.setVisible(!1);var e;switch(t){case 0:e=this.FB_MT,this.comview.SetName(UtilProxy.getTitleName("材料副本"));break;case 1:e=this.FB_ZYT,this.comview.SetName(UtilProxy.getTitleName("锁妖塔")),CopyProxy.ins().isInitTower=!1;break;case 2:e=this.FB_TM,this.comview.SetName(UtilProxy.getTitleName("经验副本"));break;case 3:e=this.FB_SW,this.comview.SetName(UtilProxy.getTitleName("剑心塔")),CopyProxy.ins().isInitSword=!1;break;case 4:e=this.FB_BW,this.comview.SetName(UtilProxy.getTitleName("宝物"));break;case 5:e=this.FB_VIP,this.comview.SetName(UtilProxy.getTitleName("VIP副本"));break;case 6:e=this.FB_SHT,this.comview.SetName("title_suohunta"),CopyProxy.ins().isInitSHTower=!1}this.current_view=e,this.sys_list[this.current_index]&&this.sys_list[this.current_index].setSelect(!1),this.sys_list[t]&&this.sys_list[t].setSelect(!0),this.current_view.setVisible(!0),this.current_index=t,this.setRed()}},e.prototype.setRed=function(){this.sys_list[0].setRed(CopyProxy.ins().GetMatericalCopyRed()),this.sys_list[1].setRed(CopyProxy.ins().GetZYTowerCopyRed()),this.sys_list[2].setRed(CopyTeamProxy.ins().getRed()),this.sys_list[3].setRed(CopyProxy.ins().getSwordRed()),this.sys_list[4].setRed(!1),this.sys_list[5].setRed(CopyProxy.ins().GetVIPCopyRed()),this.sys_list[6].setRed(CopyProxy.ins().GetSHTowerCopyRed())},e.prototype.onScrollEnd=function(){this.leftred.visible=!1,this.rightred.visible=!1;for(var t=0,e=0,i=this.scrollerg.numChildren,n=this.scrollerg.getChildAt(0).width,o=6,s=0;i>s;s++){var r=n*s+o*s,a=n*(s+1)+o*s,h=this.scrollerbtns.viewport.scrollH,l=this.scrollerbtns.viewport.scrollH+this.scrollerbtns.width;h>r&&h>a?this.redFunc[s]&&(t+=1):r>l&&a>l&&this.redFunc[s]&&(e+=1)}this.leftred.visible=t>0,this.rightred.visible=e>0},e}(BaseEuiView);__reflect(FubenView.prototype,"FubenView"),ViewManager.ins().reg(FubenView,LayerManager.UI_Main),window.FubenView=FubenView;var ItemMuti=function(t){function e(){var e=t.call(this)||this;return e.skinName="ItemExSkin",e.item.visible=!1,e.fw.visible=!1,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;void 0!=e&&(void 0!=e.itemData?(this.item.visible=!0,this.item.data=e.itemData):void 0!=e.fuwenData&&(this.fw.visible=!0,this.fw.data=e.fuwenData))},e}(BaseItemRender);__reflect(ItemMuti.prototype,"ItemMuti"),window.ItemMuti=ItemMuti;var FuwenView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FuwenSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_jingxing"),this.line_list=[],this.item_list=[];for(var e=0;8>e;e++){var i=this.list_go.getChildAt(e);this.line_list.push(i);var n=this.list_go.getChildAt(e+8);this.item_list.push(n)}this.red_resolve=this.btn_fenjie.getChildAt(2),this.red_hole=this.btn_qianghua.getChildAt(2),this.red_compose=this.btn_ronghe.getChildAt(2),this.red_replace=this.btn_replace.getChildAt(2),this.red_lvup=this.btn_lvup.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),EventProxy.AddListener(this,EventType.S2CRepFuwenUpdateGrid,this.onLvupUpdate),EventProxy.AddListener(this,EventType.S2CRepFuwenUpdateHole,this.onUpgradeUpdate),EventProxy.AddListener(this,EventType.S2CRepFuwenResolveFuwen,this.onResolveUpdate),EventProxy.AddListener(this,EventType.S2CRepFuwenCompose,this.onComposeUpdate);for(var n=[this.btn_close,this.btn_xunbao,this.btn_preview,this.btn_fenjie,this.btn_qianghua,this.btn_ronghe,this.btn_lvup,this.btn_replace,this.txt_active],o=0;o<n.length;o++)this.addTouchEvent(n[o],this.onClick);for(var o=0;o<this.item_list.length;o++)this.addTouchEvent(this.item_list[o],this.onClick);this.red_resolve.visible=FwProxy.ins().getResolveRed(),this.red_hole.visible=FwProxy.ins().getUpgradeRed(),this.red_compose.visible=FwProxy.ins().getComposeRed(),this.item_list[0].selected=!0,this.updateList(),this.openMenu(1),this.txt_fight.text=this.getFightNum().toString()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),EventProxy.RemoveListener(this,EventType.S2CRepFuwenUpdateGrid,this.onLvupUpdate),EventProxy.RemoveListener(this,EventType.S2CRepFuwenUpdateHole,this.onUpgradeUpdate),EventProxy.RemoveListener(this,EventType.S2CRepFuwenResolveFuwen,this.onResolveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepFuwenCompose,this.onComposeUpdate);for(var i=[this.btn_xunbao,this.btn_preview,this.btn_fenjie,this.btn_qianghua,this.btn_ronghe,this.btn_lvup,this.btn_replace,this.txt_active],n=0;n<i.length;n++)this.removeTouchEvent(i[n],this.onClick);for(var n=0;n<this.item_list.length;n++)this.removeTouchEvent(this.item_list[n],this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_xunbao:UtilProxy.openView(41,2);break;case this.btn_preview:ViewManager.ins().open(FwPreview);break;case this.btn_fenjie:ViewManager.ins().open(FwResolveView);break;case this.btn_qianghua:ViewManager.ins().open(FwUpgradeView);break;case this.btn_ronghe:ViewManager.ins().open(FwComposeView);break;case this.btn_replace:ViewManager.ins().open(FwBagView,FwBagType.Main,this.id);break;case this.txt_active:if(!GameLogic.ins().isMainScene())return void TipsControl.ins().showTips("当前处于副本或活动中，不能跳转");UtilProxy.openView(6,3);break;case this.btn_lvup:if(this.next_data){var i=FwProxy.ins().cur_exp,n=this.next_data.cost_exp;if(n>i)return void TipsControl.ins().showTips("C:4&经验不足，无法升级");FwProxy.ins().C2SReqFuwenUpgradeFuwen(this.id)}else TipsControl.ins().showTips("C:4&已满级");break;default:var o=this.item_list.indexOf(t.currentTarget);this.item_list[this.id-1].selected=!1,this.item_list[this.id-1].updateInfo(),this.item_list[o].selected=!0,this.item_list[o].updateInfo();var s=o+1,r=FwProxy.ins().inlay_list[s];this.openMenu(s),!r&&FwProxy.ins().isPosActive(s)&&ViewManager.ins().open(FwBagView,FwBagType.Main,s)}},e.prototype.updateList=function(){for(var t=0;8>t;t++)this.item_list[t].data={type:FwUIType.main,index:t+1},this.line_list[t].visible=t<FwProxy.ins().unlock_size-1},e.prototype.openMenu=function(t){this.id=t;var e=FwProxy.ins().inlay_list[t];if(e){this.txt_active.text="";var i=GlobalConfig.getfwBaseById(e.id,e.color,e.level),n=GlobalConfig.getfwBaseById(e.id,e.color,e.level+1);this.next_data=n,this.lvup_go.visible=!0;for(var o=AttrProxy.getContAttrInfo(i,n),s="",r="",a=0;a<o.length;a++)a>0&&(s+="\r\n",r+="\r\n"),s+=o[a][0]+"："+o[a][1],r+="|C:7&"+o[a][0]+"："+(0==o[a][2]?"已满级":o[a][2]);if(this.txt_pro_cur.text=s,this.txt_pro_next.textFlow=UtilProxy.StrFormart(r,[]),this.lvup_go2.visible=!0,n){this.txt_active.text="";var h=FwProxy.ins().cur_exp,l=n.cost_exp,p=h>=l?7:4;this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 |/@2 ",[p,h,l]),this.red_lvup.visible=h>=l}else this.red_lvup.visible=!1,this.txt_active.textFlow=UtilProxy.StrFormart("C:7&已满级",[]),this.txt_cost.textFlow=UtilProxy.StrFormart("C:4&已满级",[]);this.red_replace.visible=this.getReplaceState(e)}else this.red_lvup.visible=!1,this.lvup_go2.visible=!1,this.txt_pro_cur.text=this.txt_pro_next.text="",FwProxy.ins().isPosActive(t)?this.txt_active.textFlow=UtilProxy.StrFormart("C:4&该孔位已激活，请选择剑心",[]):this.txt_active.textFlow=UtilProxy.StrFormart("通关|C:7&<u>@0 </u>|解锁",[this.getCopyName(t)])},e.prototype.getReplaceState=function(t){for(var e=0;e<FwProxy.ins().bag_list.length;e++){var i=FwProxy.ins().bag_list[e],n=GlobalConfig.getfwBaseById(i.id,i.color,i.level);if(i&&n&&n.inlay>0&&t.id==i.id&&i.color>t.color)return!0}return!1},e.prototype.onLvupUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.openMenu(this.id),this.item_list[this.id-1].updateInfo(),this.txt_fight.text=this.getFightNum().toString()},e.prototype.onUpgradeUpdate=function(){this.updateList(),this.openMenu(this.id),this.item_list[this.id-1].updateInfo(),this.txt_fight.text=this.getFightNum().toString(),this.red_hole.visible=FwProxy.ins().getUpgradeRed()},e.prototype.onResolveUpdate=function(){this.red_resolve.visible=FwProxy.ins().getResolveRed(),this.openMenu(this.id)},e.prototype.onComposeUpdate=function(){this.red_compose.visible=FwProxy.ins().getComposeRed()},e.prototype.getCopyName=function(t){var e=FwProxy.ins().getUnlockCopyId(t),i=GlobalConfig.getCopyConfigById(e);return i?i.noColorName:""},e.prototype.getFightNum=function(){return FwProxy.ins().getFightNum()},e}(BaseEuiView);__reflect(FuwenView.prototype,"FuwenView");var FwUIType;!function(t){t[t.main=1]="main",t[t.preview=2]="preview",t[t.bag=3]="bag",t[t.upgrade=4]="upgrade",t[t.resolve=5]="resolve",t[t.compose=6]="compose",t[t.tips=7]="tips"}(FwUIType||(FwUIType={})),ViewManager.ins().reg(FuwenView,LayerManager.UI_Main),window.FuwenView=FuwenView;var FwBagItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(void 0!=this.data){var t=this.data.data,e=this.data.bagType;this.icon.data={type:FwUIType.bag,index:t.index,dress:t.dress},e==FwBagType.Main?(this.btn_dress.visible=1!=t.dress,1==t.dress?(this.btn_dress.visible=!1,this.txt_remark.textFlow=UtilProxy.StrFormart("C:4&已穿戴",[])):t.dress_same&&t.dress_same>0?(this.txt_remark.textFlow=UtilProxy.StrFormart("C:10&已穿戴同类符文",[]),this.btn_dress.visible=!1):(this.txt_remark.text="",this.btn_dress.visible=!0,this.btn_dress.label=1==t.dress?"替换":"穿戴")):(this.btn_dress.label="选择",this.txt_remark.text="");var i=FwProxy.ins().getFwName(t.id),n=BagProxy.QUALITY_COLOR[t.color];this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 |(Lv.@2 )",[n,i,t.level]);for(var o=GlobalConfig.getfwBaseById(t.id,t.color,t.level),s=AttrProxy.getAttrInfo(o),r="",a=0;a<s.length;a++)a>0&&(r+="\r\n"),r=r+"|C:10&"+s[a][2]+"：+"+s[a][1];this.txt_pro.textFlow=UtilProxy.StrFormart(r,[])}},e.prototype.isTypeDress=function(t){var e=FwProxy.ins().inlay_list;for(var i in e){var n=e[i];if(n.id==t)return!0}return!1},e}(BaseItemRender);__reflect(FwBagItem.prototype,"FwBagItem"),window.FwBagItem=FwBagItem;var FwBagView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FwBagSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&剑心背包",[]),this.txt_link.textFlow=UtilProxy.StrFormart("暂无所需剑心，点击前往|C:7&<u>藏剑谷</u>",[])},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.list.itemRenderer=FwBagItem,this.page=e[0],this.id=e[1],this.param=e,this.addTouchEvent(this.btn_close,this.onClick),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.addTouchEvent(this.txt_link,this.onLink),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.txt_link,this.onLink),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this)},e.prototype.updateInfo=function(){if(this.page==FwBagType.Main){for(var t=this.getMainBagList(),e=new eui.ArrayCollection,i=0;i<t.length;i++){var n={};n.data=t[i],n.bagType=FwBagType.Main,e.addItem(n)}this.list.dataProvider=e,this.txt_link.visible=0==e.length}else{for(var t=this.getComposeBagList(parseInt(this.param[2]),parseInt(this.param[3])),e=new eui.ArrayCollection,i=0;i<t.length;i++){var n={};n.data=t[i],n.bagType=FwBagType.Compose,e.addItem(n)}this.list.dataProvider=e,this.txt_link.visible=0==e.length}},e.prototype.onClick=function(t){ViewManager.ins().close(e)},e.prototype.onLink=function(t){return GameLogic.ins().isMainScene()?void UtilProxy.openView(41,2):void TipsControl.ins().showTips("当前处于副本或活动中，不能跳转")},e.prototype.onListItemTap=function(t){var i=t.itemRenderer;if(void 0!=i)if(this.page==FwBagType.Main)0==i.data.data.dress&&0==i.data.data.dress_same&&(FwProxy.ins().C2SReqFuwenInlayFuwen(i.data.data.index,this.id),ViewManager.ins().close(e));else{var n=this.param[4],o=this.param[5],s=this.param[1];n.call(o,s,i.data.data.index),ViewManager.ins().close(e)}},e.prototype.getMainBagList=function(){var t=FwProxy.ins().inlay_list[this.id],e=[],i=[];for(var n in FwProxy.ins().inlay_list)if(n){var o=FwProxy.ins().inlay_list[n];o.dress=1,o.dress_same=1,i[o.id]=!0,e.push(o)}for(var s=FwProxy.ins().bag_list,r=0;r<s.length;r++){var o=s[r],a=GlobalConfig.getfwBaseById(o.id,o.color,o.level);a&&1==a.inlay&&(o.dress=0,o.dress_same=void 0!=i[o.id]?1:0,t&&t.id==o.id&&(o.dress_same=0),e.push(o))}return e.sort(function(t,e){return t.dress_same!=e.dress_same?t.dress_same-e.dress_same:t.dress!=e.dress?t.dress-e.dress:t.color!=e.color?e.color-t.color:t.level!=e.level?e.level-t.level:t.id-e.id}),e},e.prototype.getComposeBagList=function(t,e){for(var i=[],n=FwProxy.ins().bag_list,o=0;o<n.length;o++){var s=n[o];s.id==t&&s.color==e&&i.push(s)}return i},e}(BaseEuiView);__reflect(FwBagView.prototype,"FwBagView");var FwBagType;!function(t){t[t.Main=1]="Main",t[t.Compose=2]="Compose"}(FwBagType||(FwBagType={})),ViewManager.ins().reg(FwBagView,LayerManager.UI_Main2),window.FwBagView=FwBagView;var FwComposeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FwComposeSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.red_lvup=this.btn_lvup.getChildAt(2),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&剑心融合",[]),this.txt_remark.textFlow=UtilProxy.StrFormart("C:4&符文融合产物可以集成材料属性",[])},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.item_left,this.onClick),this.addTouchEvent(this.item_right,this.onClick),EventProxy.AddListener(this,EventType.S2CRepFuwenCompose,this.onLvupUpdate),this.updateMenu();for(var n=0;n<this.menu_list.length;n++)this.addTouchEvent(this.menu_list[n].bg,this.onClick),this.menu_list[n].list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this);this.openMenu(1,1),this.menu_list[this.id-1].selected=!0,this.menu_list[this.id-1].updateState(!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick),this.removeTouchEvent(this.item_left,this.onClick),this.removeTouchEvent(this.item_right,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepFuwenCompose,this.onLvupUpdate);for(var i=0;i<this.menu_list.length;i++)this.removeTouchEvent(this.menu_list[i].bg,this.onClick),this.menu_list[i].list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this);this.id=0,this.sub_id=0},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;
if(void 0!=e&&e.itemIndex+1!=this.sub_id){var i=this.menu_list[this.id-1].array.source[this.sub_id-1];this.menu_list[this.id-1].array.itemUpdated(i),this.menu_list[this.id-1].array.itemUpdated(e.data),this.openMenu(this.id,e.itemIndex+1)}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.item_left:ViewManager.ins().open(FwBagView,FwBagType.Compose,1,this.compose_data.cost_fuwen[0],this.compose_data.color,this.onItemSelect,this);break;case this.item_right:ViewManager.ins().open(FwBagView,FwBagType.Compose,2,this.compose_data.cost_fuwen[1],this.compose_data.color,this.onItemSelect,this);break;case this.btn_lvup:if(void 0==this.compose_data)return;for(var i=0;i<this.compose_data.cost_item.length;i++){var n=this.compose_data.cost_item[i];if(BagProxy.ins().getItemCountById(n[0])<n[1])return TipsControl.ins().showTips("C:4&道具不足"),void TipsControl.ins().ShowPathTips(30547)}void 0!=this.left_data&&void 0!=this.right_data?FwProxy.ins().C2SReqFuwenCompose(this.compose_data.id,this.compose_data.color,[this.left_data.index,this.right_data.index]):TipsControl.ins().showTips("C:4&请先选择俩个满足条件的剑心");break;default:var o=this.menu_btn_list.indexOf(t.currentTarget);o+1!=this.id&&(this.menu_list[this.id-1].updateState(!1),this.menu_list[o].updateState(!0),this.openMenu(o+1,1))}},e.prototype.updateMenu=function(){this.list_go.removeChildren(),this.menu_list=[],this.menu_btn_list=[];for(var t=FwProxy.ins().getMenuList(),e=0;e<t.length;e++){var i=new FwCpItem;i.skinName="FwCpItemSkin",i.selected=!1,i.height=35,i.data=t[e],this.menu_list.push(i),this.list_go.addChild(i),this.menu_btn_list.push(i.bg)}this.list_go.validateNow()},e.prototype.openMenu=function(t,e){this.id=t,this.sub_id=e;var i=FwProxy.ins().getMenuList(),n=FwProxy.ins().getSubMenuList(i[t-1])[e-1];if(n){this.compose_data=n;var o=FwProxy.ins().getFwIcon(n.id,n.color),s=FwProxy.ins().getFwName(n.id);this.item_target.data={type:FwUIType.compose,id:n.id,color:n.color,icon:o},this.item_left.data={type:FwUIType.compose},this.item_right.data={type:FwUIType.compose},this.txt_left.text=this.txt_right.text="",this.txt_has.textFlow=UtilProxy.StrFormart("C:7&已拥有：@0 ",[this.getHasNum(n.id,n.color)]),this.txt_target.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[n.color],s]),this.updatelvupInfo(1),this.left_data=null,this.right_data=null,this.txt_left.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[n.color],FwProxy.ins().getFwName(n.cost_fuwen[0])]),this.txt_right.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[n.color],FwProxy.ins().getFwName(n.cost_fuwen[1])])}},e.prototype.updatelvupInfo=function(t){this.txt_lv.textFlow=UtilProxy.StrFormart("C:10&LV.@0 ",[t]);var e=GlobalConfig.getfwBaseById(this.compose_data.id,this.compose_data.color,t);if(e){for(var i=AttrProxy.getAttrInfo(e),n="",o=0;o<i.length;o++)o>0&&(n+="\r\n"),n+=UtilProxy.getStr("|C:10&@0 +@1 ",[i[o][0],i[o][1]]);this.txt_pro_cur.textFlow=UtilProxy.StrFormart(n,[]);var s=BagProxy.ins().getItemCountById(this.compose_data.cost_item[0][0]),r=this.compose_data.cost_item[0][1],a=r>s?4:7;this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 /@2 ",[a,s,r]),this.red_lvup.visible=FwProxy.ins().getRedByCpId(this.compose_data.id,this.compose_data.color)}},e.prototype.onItemSelect=function(t,e){var i=FwProxy.ins().bag_list2[e];if(i){var n=FwProxy.ins().getFwIcon(i.id,i.color),o=FwProxy.ins().getFwName(i.id),s=BagProxy.QUALITY_COLOR[i.color];1==t?(this.item_left.data={type:FwUIType.compose,id:i.id,color:i.color,icon:n},this.left_data=i,this.txt_left.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[s,o])):(this.item_right.data={type:FwUIType.compose,id:i.id,color:i.color,icon:n},this.right_data=i,this.txt_right.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[s,o]));var r=0;this.left_data&&(r+=this.getExp(this.left_data.id,this.left_data.color,this.left_data.level)),this.right_data&&(r+=this.getExp(this.right_data.id,this.right_data.color,this.right_data.level));var a=FwProxy.ins().getMenuList(),h=FwProxy.ins().getSubMenuList(a[this.id-1])[this.sub_id-1];this.txt_lv.textFlow=UtilProxy.StrFormart("C:10&LV.@0 ",[this.getlv(h.id,h.color,r)])}},e.prototype.getExp=function(t,e,i){for(var n=0,o=i;o>1;o--){var s=GlobalConfig.getfwBaseById(t,e,o);s&&(n+=s.cost_exp)}return n},e.prototype.getlv=function(t,e,i){for(var n=i,o=1,s=null;n>0;)s=GlobalConfig.getfwBaseById(t,e,o+1),s&&n>=s.cost_exp?(o+=1,n-=s.cost_exp):n=-1;return o},e.prototype.getHasNum=function(t,e){for(var i=0,n=FwProxy.ins().bag_list,o=0;o<n.length;o++)n[o].id==t&&n[o].color==e&&(i+=1);return i},e.prototype.onLvupUpdate=function(){this.openMenu(this.id,this.sub_id);for(var t=0;t<this.menu_list.length;t++)this.menu_list[t].updateInfo()},e}(BaseEuiView);__reflect(FwComposeView.prototype,"FwComposeView"),ViewManager.ins().reg(FwComposeView,LayerManager.UI_Main2),window.FwComposeView=FwComposeView;var FwCpItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=FwCpSubItem},e.prototype.dataChanged=function(){this.updateInfo()},e.prototype.updateInfo=function(){if(void 0!=this.data){var t=parseInt(this.data);if(this.array)this.array.refresh();else{this.array=new eui.ArrayCollection;for(var e=FwProxy.ins().getSubMenuList(t),i=0;i<e.length;i++)this.array.addItem(e[i]);this.list.dataProvider=this.array;var n=GlobalConfig.getfwNameById(t);this.txt_name.text=n.name}this.selected&&(this.list.selectedIndex=0),this.selected?(this.height=36+30*this.array.length+this.array.length,this.list.height=this.list.contentHeight):(this.height=35,this.list.height=0),this.bg.source=this.selected?"common_btn_bluebiaoqing_on_01":"common_btn_bluebiaoqing_off_01",this.sp.scaleY=this.selected?-1:1,this.red.visible=this.getRed(t)}},e.prototype.updateState=function(t){this.selected=t,this.updateInfo()},e.prototype.getRed=function(t){for(var e=FwProxy.ins().getSubMenuList(t),i=0;i<e.length;i++){var n=e[i];if(FwProxy.ins().getRedByCpId(n.id,n.color))return!0}return!1},e}(BaseItemRender);__reflect(FwCpItem.prototype,"FwCpItem"),window.FwCpItem=FwCpItem;var FwCpSubItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.updateInfo()},e.prototype.updateInfo=function(){if(void 0!=this.data){var t=GlobalConfig.getfwNameById(this.data.id),e=BagProxy.QUALITY_COLOR[this.data.color];this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[e,t.name]),this.bg.source=this.selected?"common_btn_bluebiaoqing_on_02":"common_btn_bluebiaoqing_off_02",this.red.visible=FwProxy.ins().getRedByCpId(this.data.id,this.data.color)}},e.prototype.updateState=function(t){this.selected=t,this.updateInfo()},e}(BaseItemRender);__reflect(FwCpSubItem.prototype,"FwCpSubItem"),window.FwCpSubItem=FwCpSubItem;var FwIcon=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.icon,this.onClick)},e.prototype.dataChanged=function(){this.updateInfo()},e.prototype.updateInfo=function(){if(void 0!=this.data)if(this.data.type==FwUIType.bag){this.check.visible=!1;FwProxy.ins().getFwName(this.data.id);this.txt_name.text="";var t=FwProxy.ins().bag_list2[this.data.index];if(this.data.dress&&1==this.data.dress&&(t=FwProxy.ins().inlay_list[this.data.index]),t){this.bg.source="common_Box_0"+(1+t.color),this.bd.source="jianxin_dikuang_0"+(1+t.color);var e=GlobalConfig.getfwResById(t.id,t.color);this.icon.source=AssetMgr.getIconResource(e.icon)}}else if(this.data.type==FwUIType.preview){this.check.visible=!1;var i=GlobalConfig.getfwNameById(this.data.id),n=GlobalConfig.getfwResById(this.data.id,this.data.color);this.bg.source="common_Box_0"+(1+this.data.color),this.bd.source="jianxin_dikuang_0"+(1+this.data.color),this.icon.source=AssetMgr.getIconResource(n.icon);var o=BagProxy.QUALITY_COLOR[this.data.color];this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[o,i.name]),this.txt_num.text=this.data.num?this.data.num.toString():""}else if(this.data.type==FwUIType.resolve){this.check.visible=!0,this.check.selected=!1,this.txt_name.text="";var t=FwProxy.ins().bag_list2[this.data.index];if(t){this.bg.source="common_Box_0"+(1+t.color),this.bd.source="jianxin_dikuang_0"+(1+t.color);var e=GlobalConfig.getfwResById(t.id,t.color);this.icon.source=AssetMgr.getIconResource(e.icon)}}else if(this.data.type==FwUIType.tips){this.check.visible=!1,this.txt_name.text="",this.bg.source="common_Box_0"+(1+this.data.color),this.bd.source="jianxin_dikuang_0"+(1+this.data.color);var e=GlobalConfig.getfwResById(this.data.id,this.data.color);this.icon.source=AssetMgr.getIconResource(e.icon)}},e.prototype.onClick=function(){if(this.data&&this.data.type==FwUIType.preview){var t=this.data;ViewManager.ins().open(FwTipsView,t.id,t.color)}},e.prototype.setCheckState=function(t){this.check.selected=t},e}(BaseItemRender);__reflect(FwIcon.prototype,"FwIcon"),window.FwIcon=FwIcon;var FwItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.updateInfo()},e.prototype.updateInfo=function(){if(void 0!=this.data&&void 0!=this.data.type){var t=this.data.type;if(this.black.visible=t==FwUIType.upgrade,t==FwUIType.main){this.select.visible=this.selected;var e=this.data.index;this.setLvupState(e);var i=FwProxy.ins().inlay_list[e];i?(this.lv.textFlow=UtilProxy.StrFormart("C:10&LV.@0 ",[i.level]),this.lv.y=68):this.lv.text="",this.red.visible=FwProxy.ins().getRedByInlayId(this.data.index)}else if(t==FwUIType.compose)this.select.visible=!1,this.suo.visible=!1,this.lv.text="",this.data.icon?(this.add.visible=!1,this.icon.visible=!0,this.bg.source="jianxin_dikuang_0"+(this.data.color+1),this.icon.source=this.data.icon):(this.add.visible=!0,this.icon.visible=!1,this.bg.source="jianxin_dikuang_01");else if(t==FwUIType.upgrade){this.red.visible=FwProxy.ins().getRedByUpgradeId(this.data.index),this.select.visible=this.selected;var e=this.data.index;this.setLvupState(e),this.lv.y=36,this.lv.textFlow=UtilProxy.StrFormart("C:10&LV.@0 ",[FwProxy.ins().getHoleById(e)])}}},e.prototype.setLvupState=function(t){var e=FwProxy.ins().inlay_list[t];if(e){this.add.visible=this.suo.visible=!1,this.icon.visible=!0;var i=GlobalConfig.getfwResById(e.id,e.color);this.icon.source=AssetMgr.getIconResource(i.icon),this.bg.source="jianxin_dikuang_0"+(e.color+1)}else this.bg.source="jianxin_dikuang_01",this.icon.visible=!1,FwProxy.ins().isPosActive(t)?(this.add.visible=!0,this.suo.visible=!1):(this.add.visible=!1,this.suo.visible=!0)},e}(BaseItemRender);__reflect(FwItem.prototype,"FwItem"),window.FwItem=FwItem;var FwPreview=function(t){function e(){var e=t.call(this)||this;return e.skinName="FwPreviewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=FwPreviewItem,this.txt_title.textFlow=UtilProxy.StrFormart("C:10&剑心预览",[])},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_path,this.onClick),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_path,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_path:if(!GameLogic.ins().isMainScene())return void TipsControl.ins().showTips("当前处于副本或活动中，不能跳转");UtilProxy.openView(6,3)}},e.prototype.updateInfo=function(){for(var t=FwProxy.ins().getPreviewList(),e=new eui.ArrayCollection,i=0;i<t.length;i++){var n=t[i];e.addItem(n)}this.list.dataProvider=e},e}(BaseEuiView);__reflect(FwPreview.prototype,"FwPreview"),ViewManager.ins().reg(FwPreview,LayerManager.UI_Main2),window.FwPreview=FwPreview;var FwPreviewItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=FwIcon},e.prototype.dataChanged=function(){if(void 0!=this.data){var t=parseInt(this.data.lv),e=this.data.list;t>0?this.txt_lv.textFlow=UtilProxy.StrFormart("C:10&通关剑心塔@0 层解锁",[t]):this.txt_lv.textFlow=UtilProxy.StrFormart("C:10&默认解锁",[]);for(var i=new eui.ArrayCollection,n=0;n<e.length;n++){var o=e[n];i.addItem({type:FwUIType.preview,id:o.id,color:o.color})}this.list.dataProvider=i}},e}(BaseItemRender);__reflect(FwPreviewItem.prototype,"FwPreviewItem"),window.FwPreviewItem=FwPreviewItem;var FwResolveView=function(t){function e(){var e=t.call(this)||this;return e.remark_list=["绿","蓝","紫","金","红"],e.skinName="FwResolveSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.red_lvup=this.btn_lvup.getChildAt(2),this.list.itemRenderer=FwIcon,this.txt_title.textFlow=UtilProxy.StrFormart("C:10&剑心分解",[]),this.check_list=[this.check0,this.check1,this.check2,this.check3,this.check4],this.check_lblist=[this.check_lb0,this.check_lb1,this.check_lb2,this.check_lb3,this.check_lb4];for(var e=0;e<this.check_list.length;e++)this.check_list[e].selected=!1,this.check_lblist[e].textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[e+1],this.remark_list[e]]);var i=new ItemCellData,n={item_slot_idx:0,item_type_id:30545,item_count:1};i.setItemCellData(n),this.icon.data=i},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick);for(var n=0;n<this.check_list.length;n++)this.addTouchEvent(this.check_list[n],this.onClick);this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.AddListener(this,EventType.S2CRepFuwenResolveFuwen,this.onlvupUpdate),this.updateInfo(),this.updateNum()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick);for(var i=0;i<this.check_list.length;i++)this.removeTouchEvent(this.check_list[i],this.onClick);this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.RemoveListener(this,EventType.S2CRepFuwenResolveFuwen,this.onlvupUpdate)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_lvup:var i=[];for(var n in this.select_list)1==this.select_list[n]&&i.push(parseInt(n));i.length>0?FwProxy.ins().C2SReqFuwenResolveFuwen(i):TipsControl.ins().showTips("C:4&请选择");break;default:for(var o=this.check_list.indexOf(t.currentTarget),s=0;s<this.datalist.length;s++){var r=this.datalist.source[s],a=FwProxy.ins().bag_list2[r.index];if(a.color==o+1&&(void 0==this.no_list[a.id]||this.no_list[a.id].index!=r.index)){var h=this.list.$children[s];h.check.selected=this.check_list[o].selected,this.select_list[r.index]=h.check.selected?1:0}}this.updateNum()}},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;if(void 0!=e){var i=e.data.index,n=FwProxy.ins().bag_list2[i];if(n&&void 0!=this.no_list[n.id]&&this.no_list[n.id].index==i)return void TipsControl.ins().showTips("C:4&最高品质不可被分解!");e.check.selected=!e.check.selected,this.select_list[e.data.index]=e.check.selected?1:0,this.updateNum()}},e.prototype.onlvupUpdate=function(){this.updateInfo(),this.updateNum()},e.prototype.updateInfo=function(){this.select_list=[],this.datalist||(this.datalist=new eui.ArrayCollection),this.datalist.removeAll();for(var t=this.getBagList(),e=0;e<t.length;e++){var i={type:FwUIType.resolve,index:t[e].index};this.datalist.addItem(i)}this.list.dataProvider=this.datalist,this.red_lvup.visible=FwProxy.ins().getResolveRed()},e.prototype.updateNum=function(){var t=0;for(var e in this.select_list)if(1==this.select_list[e]){var i=FwProxy.ins().bag_list2[e];t+=this.getResoleVal(i.id,i.color,i.level)}this.txt_num.textFlow=UtilProxy.StrFormart("C:10&符文精华：@0 ",[t])},e.prototype.getResoleVal=function(t,e,i){var n=0,o=GlobalConfig.getfwBaseById(t,e,i);o&&(n+=o.resolve_exp);for(var s=i;s>1;){var r=GlobalConfig.getfwBaseById(t,e,s);r&&(n+=r.cost_exp),s-=1}return n},e.prototype.getBagList=function(){var t=FwProxy.ins().bag_list;this.no_list=[];for(var e=0;e<t.length;e++){var i=t[e],n=GlobalConfig.getfwBaseById(i.id,i.color,i.level);0!=n.inlay&&(this.no_list[i.id]?this.no_list[i.id].color<i.color&&(this.no_list[i.id]=i):this.no_list[i.id]=i)}var o=FwProxy.ins().inlay_list;for(var s in o){var i=o[s],n=GlobalConfig.getfwBaseById(i.id,i.color,i.level);0!=n.inlay&&(this.no_list[i.id]?this.no_list[i.id].color<i.color&&(this.no_list[i.id]=i):this.no_list[i.id]=i)}return t.sort(function(t,e){return t.color!=e.color?e.color-t.color:t.level!=e.level?t.level-e.level:t.id-e.id}),t},e}(BaseEuiView);__reflect(FwResolveView.prototype,"FwResolveView"),ViewManager.ins().reg(FwResolveView,LayerManager.UI_Main2),window.FwResolveView=FwResolveView;var FwTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FwTipSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.bg,this.onClick);var n=e[0],o=e[1];this.icon.data={type:FwUIType.tips,id:n,color:o};var s=BagProxy.QUALITY_COLOR[o],r=FwProxy.ins().getFwName(n);this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[s,r]),this.title_start.textFlow=UtilProxy.StrFormart("C:10&初始属性",[]),this.title_top.textFlow=UtilProxy.StrFormart("C:10&满级属性",[]);var a=GlobalConfig.getfwBaseById(n,o,1);if(a){var h=this.getTopdata(n,o);if(h){for(var l=AttrProxy.getAttrInfo(a),p=AttrProxy.getAttrInfo(h),c="",u=0;u<l.length;u++)u>0&&(c+="\r\n"),c+="|C:7&"+l[u][2]+"："+l[u][1];this.remark_start.textFlow=UtilProxy.StrFormart(c,[]),c="";for(var u=0;u<p.length;u++)u>0&&(c+="\r\n"),c+="|C:7&"+p[u][2]+"："+p[u][1];this.remark_top.textFlow=UtilProxy.StrFormart(c,[])}}},e.prototype.getTopdata=function(t,e){for(var i=1,n=null;i>0;){var o=GlobalConfig.getfwBaseById(t,e,i);o?(n=o,i+=1):i=0}return n},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.bg,this.onClick)},e.prototype.onClick=function(t){ViewManager.ins().close(e)},e}(BaseEuiView);__reflect(FwTipsView.prototype,"FwTipsView"),ViewManager.ins().reg(FwTipsView,LayerManager.UI_Main2),window.FwTipsView=FwTipsView;var FwUpgradeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FwUpgradeSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&检槽强化",[]),this.txt_path.textFlow=UtilProxy.StrFormart("C:4&<u>获取材料</u>",[]),this.red_lvup=this.btn_lvup.getChildAt(2),this.item_list=[];for(var e=0;8>e;e++){var i=this.list_go.getChildAt(e+8);this.item_list.push(i)}},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.txt_path,this.onClick);for(var n=0;n<this.item_list.length;n++)this.addTouchEvent(this.item_list[n],this.onClick);EventProxy.AddListener(this,EventType.S2CRepFuwenUpdateHole,this.onLvupUpdate),this.item_list[0].selected=!0,this.updateList(),this.openMenu(1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick),this.removeTouchEvent(this.txt_path,this.onClick);for(var i=0;i<this.item_list.length;i++)this.removeTouchEvent(this.item_list[i],this.onClick);EventProxy.RemoveListener(this,EventType.S2CRepFuwenUpdateHole,this.onLvupUpdate)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_lvup:if(this.next_data){var i=BagProxy.ins().getItemCountById(this.next_data.item[0][0]),n=this.next_data.item[0][1];if(n>i)return TipsControl.ins().showTips("C:4&道具不足"),void TipsControl.ins().ShowPathTips(30546);FwProxy.ins().C2SReqFuwenHoleStrengthen(this.id)}else TipsControl.ins().showTips("C:4&已满级");break;case this.txt_path:TipsControl.ins().ShowPathTips(30546);break;default:var o=this.item_list.indexOf(t.currentTarget);if(0>o||o+1==this.id)return;this.item_list[this.id-1].selected=!1,this.item_list[this.id-1].updateInfo(),this.item_list[o].selected=!0,this.item_list[o].updateInfo();var s=o+1;this.openMenu(s)}},e.prototype.updateList=function(){for(var t=0;8>t;t++)this.item_list[t].data={type:FwUIType.upgrade,index:t+1}},e.prototype.openMenu=function(t){this.id=t;var e=FwProxy.ins().inlay_list[t];if(e){var i=FwProxy.ins().getHoleById(t);this.txt_lv.text=i+"阶";var n=GlobalConfig.getfwHoleById(t,i),o=GlobalConfig.getfwHoleById(t,i+1),s=GlobalConfig.getfwBaseById(e.id,e.color,e.level);this.next_data=o,this.lvup_go.visible=!0;for(var r=AttrProxy.getContAttrInfo(s,s),a="",h="",l=void 0!=n?n.attr_per:0,p=void 0!=o?o.attr_per:0,c=0;c<r.length;c++)c>0&&(a+="\r\n",h+="\r\n"),a+="|C:10&该槽"+r[c][0]+"加成：|"+l/100+"%",h+="|C:7&"+(void 0==o?"已满级":p/100+"%");if(this.txt_pro_cur.textFlow=UtilProxy.StrFormart(a,[]),this.txt_pro_next.textFlow=UtilProxy.StrFormart(h,[]),this.lvup_go2.visible=void 0!=o,o){this.txt_active.text="";var u=BagProxy.ins().getItemCountById(o.item[0][0]),d=o.item[0][1],g=u>=d?7:4;this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 |/@2 ",[g,u,d])}else this.txt_active.textFlow=UtilProxy.StrFormart("C:7&已满级",[]);this.red_lvup.visible=FwProxy.ins().getRedByUpgradeId(this.id)}else this.red_lvup.visible=!1,this.txt_lv.text="0阶",this.lvup_go.visible=!1,FwProxy.ins().isPosActive(t)?this.txt_active.textFlow=UtilProxy.StrFormart("C:4&该孔位已激活，请先选择剑心,再来强化",[]):this.txt_active.textFlow=UtilProxy.StrFormart("C:10&孔位激活，方可强化!",[])},e.prototype.onLvupUpdate=function(t){this.item_list[t-1].updateInfo(),this.openMenu(t)},e}(BaseEuiView);__reflect(FwUpgradeView.prototype,"FwUpgradeView"),ViewManager.ins().reg(FwUpgradeView,LayerManager.UI_Main2),window.FwUpgradeView=FwUpgradeView;var FuyinSkillView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FuyinSkillSkin",this.title1.textFlow=UtilProxy.generateTextFlow("|C:6&当前效果|"),this.title2.textFlow=UtilProxy.generateTextFlow("|C:6&下级效果|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepGrowupFuyinSuitUpgrade,this.ShowInfo),this.curid=t[0]||1,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupFuyinSuitUpgrade,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=GrowupProxy.ins().getFuyinSuitCanUp(this.curid);if(2==e)return void TipsControl.ins().showTips("已经提升至满级");var i=GlobalConfig.getFuyin_suit_dataConfig(this.curid,GrowupProxy.ins().getFuyinSuitLevel(this.curid)+1);return 3==e?void TipsControl.ins().showTips(UtilProxy.getStr("全套符文提升到@0 级可提升",[i.need_level])):1==e?(TipsControl.ins().showTips("升级材料不足"),void TipsControl.ins().ShowPathTips(i.item[0])):void GrowupProxy.ins().C2SReqGrowupFuyinSuitUpgrade(this.curid)},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFuyin_skill_dataConfig(this.curid);this.namelab.text=t.name;var e=GrowupProxy.ins().getFuyinSuitLevel(this.curid);this.levellab.textFlow=UtilProxy.StrFormart("当前等级：|C:7&@0 级|",[e]);var i=GlobalConfig.getFuyin_suit_dataConfig(this.curid,e),n=GlobalConfig.getFuyin_suit_dataConfig(this.curid,e+1);this.skillicon.source=t.skill_icon;var o=0;if(i&&(o=1==this.curid?i.zhongji_rate||0:i.lianji_rate||0),this.info1.textFlow=UtilProxy.StrFormart(t.desc,[o/100+"%"]),n){var s=1==this.curid?n.zhongji_rate||0:n.lianji_rate||0;this.info2.textFlow=UtilProxy.StrFormart(t.desc,[s/100+"%"])}else this.info2.text="已满级";if(this.need.visible=void 0!=n,this.btn.label=void 0!=n?"升级":"已满级",n){var r=BagProxy.ins().getItemData(n.item[0]);this.needicon.source=AssetMgr.getIconResource(r.displayid);var a=BagProxy.ins().getItemCountById(n.item[0]);this.needlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[a<n.item[1]?4:7,a,n.item[1]])}this.red.visible=0==GrowupProxy.ins().getFuyinSuitCanUp(this.curid)},e}(BaseEuiView);__reflect(FuyinSkillView.prototype,"FuyinSkillView"),ViewManager.ins().reg(FuyinSkillView,LayerManager.UI_Main),window.FuyinSkillView=FuyinSkillView;var FuyinView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FuyinSkin",this.comview.initUI(),this.comview.SetName("title_fuyin"),this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.qianbtn.icon="common_btn_big_yellow_off",this.kunbtn.icon="common_btn_big_yellow_off",this.effect.removeChildren(),UtilProxy.GetMovieClipById(118,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.qianbtn,this.onMainBtnClick),this.addTouchEvent(this.kunbtn,this.onMainBtnClick),this.addTouchEvent(this.skillbtn,this.onSkillClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onCheckClick);EventProxy.AddListener(this,EventType.S2CRepGrowupFuyinUpgrade,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepGrowupFuyinSuitUpgrade,this.ShowInfo);var n=0;t&&void 0!=t[0]&&(n=t[0]),this.SetOnBtn(n),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.qianbtn,this.onMainBtnClick),this.removeTouchEvent(this.kunbtn,this.onMainBtnClick),this.removeTouchEvent(this.skillbtn,this.onSkillClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onCheckClick);EventProxy.RemoveListener(this,EventType.S2CRepGrowupFuyinUpgrade,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepGrowupFuyinSuitUpgrade,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSkillClick=function(t){ViewManager.ins().open(FuyinSkillView,this.curselect==this.qianbtn?1:2)},e.prototype.onCheckClick=function(t){void 0!=this.curBtn&&(this.curBtn.getChildAt(1).visible=!1),this.curBtn=t.currentTarget,this.curBtn.getChildAt(1).visible=!0,this.ShowInfo()},e.prototype.onMainBtnClick=function(t){var e=0;t.currentTarget==this.kunbtn&&(e=1),this.SetOnBtn(e),this.ShowInfo()},e.prototype.SetOnBtn=function(t){this.qianbtn.icon=0==t?"common_btn_big_yellow":"common_btn_big_yellow_off",this.kunbtn.icon=0==t?"common_btn_big_yellow_off":"common_btn_big_yellow",this.curselect=0==t?this.qianbtn:this.kunbtn},e.prototype.onBtnClick=function(t){var e=this.curselect==this.qianbtn?0:4,i=this.btns.indexOf(this.curBtn)+1+e,n=GrowupProxy.ins().getFuyinCanUp(i);if(2==n)return void TipsControl.ins().showTips("已经提升至满级");if(1==n){TipsControl.ins().showTips("升级材料不足");var o=GlobalConfig.getFuyin_base_dataConfig(i)[GrowupProxy.ins().getFuyinLevel(i)+1];return void TipsControl.ins().ShowPathTips(o.item[0])}GrowupProxy.ins().C2SReqGrowupFuyinUpgrade(i)},e.prototype.ShowInfo=function(){void 0==this.curBtn&&(this.curBtn=this.btn1,this.curBtn.getChildAt(1).visible=!0);var t=this.curselect==this.qianbtn?0:4;this.btnpic.source=this.curselect==this.qianbtn?"fuyin_bg_zhongji":"fuyin_lianji",this.effect.visible=GrowupProxy.ins().getFuyinSuitLevel(this.curselect==this.qianbtn?1:2)>0;for(var e=0;e<this.btns.length;e++){var i=this.btns[e].getChildAt(0);i.source="fuyin_icon_0"+(e+1+t)}var n=this.btns.indexOf(this.curBtn)+1+t;this.red.visible=0==GrowupProxy.ins().getFuyinCanUp(n);var o=GrowupProxy.ins().getFuyinLevel(n),s=GlobalConfig.getFuyin_base_dataConfig(n)[o],r=GlobalConfig.getFuyin_base_dataConfig(n)[o+1];if(this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[s?s.name:r.name]),this.need.visible=void 0!=r,this.nextpro.visible=void 0!=r,this.curpro.x=void 0!=r?86:178,this.btn.label=void 0!=r?"升级":"已满级",this.zhanValue.text=s?UtilProxy.GetAttrFight(s).toString():"0",r){var a=BagProxy.ins().getItemData(r.item[0]);this.needicon.source=AssetMgr.getIconResource(a.displayid);var h=BagProxy.ins().getItemCountById(r.item[0]);this.needlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[h<r.item[1]?4:7,h,r.item[1]])}for(var l=AttrProxy.getContAttrInfo(s,r),p="",c="",e=0;e<l.length;e++)""==p?(p=UtilProxy.getStr("@0 ：@1 ",[l[e][0],l[e][1]]),c=UtilProxy.getStr("|C:7&@0 ：@1 |",[l[e][0],l[e][2]])):(p+=UtilProxy.getStr("\n@0 ：@1 ",[l[e][0],l[e][1]]),c+=UtilProxy.getStr("\n|C:7&@0 ：@1 |",[l[e][0],l[e][2]]));this.curpro.textFlow=UtilProxy.generateTextFlow(p),this.nextpro.textFlow=UtilProxy.generateTextFlow(c);for(var e=0;e<this.reds.numChildren;e++){this.reds.getChildAt(e).visible=0==GrowupProxy.ins().getFuyinCanUp(e+1+t);var u=GrowupProxy.ins().getFuyinLevel(e+1+t),d=GlobalConfig.getFuyin_base_dataConfig(e+1+t)[o],g=GlobalConfig.getFuyin_base_dataConfig(e+1+t)[o+1],y=this.btns[e].getChildAt(2);y.textFlow=UtilProxy.StrFormart("|C:10&@0  Lv.@1 |",[d?d.name:g.name,u])}this.red0.visible=GrowupProxy.ins().getFuyinRedByType(1),this.red1.visible=GrowupProxy.ins().getFuyinRedByType(2),this.skillred.visible=0==GrowupProxy.ins().getFuyinSuitCanUp(this.curselect==this.qianbtn?1:2)},e}(BaseEuiView);__reflect(FuyinView.prototype,"FuyinView"),ViewManager.ins().reg(FuyinView,LayerManager.UI_Main),window.FuyinView=FuyinView;var CopyHangManager=function(t){function e(){var e=t.call(this)||this;return e.monster_list=[],e.cur_wave_id=0,e.cur_monster_num=0,e.isCircle=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getCurMonsterNum=function(){return this.cur_monster_num},e.prototype.initData=function(t){var e=this;EventProxy.AddListener(this,EventType.HangMonsterDie,this.onMonsterDie),this.scene_data=t,this.cur_wave_id=0,this.cur_monster_num=0,this.monster_list=[],this.isCircle=1==t.monster_is_circle?!0:!1,RES.getResByUrl("resource/cfg/scene_monster/"+t.id+".json",function(t){if(t&&GameLogic.ins().isMainScene()&&0==e.cur_wave_id){for(var i=t,n=0;n<i.monster_coordinate.length;n++)e.monster_list[n]=i.monster_coordinate[n];e.checkNext(),GameMap.centerEntity&&(UtilProxy.isOpenWelcome()||GameMap.centerEntity.AI.start())}},this,RES.ResourceItem.TYPE_JSON)},e.prototype.clearData=function(){this.scene_data=void 0,this.cur_wave_id=0,this.cur_monster_num=0,this.monster_list=[],EventProxy.RemoveListener(this,EventType.HangMonsterDie,this.onMonsterDie)},e.prototype.onMonsterDie=function(t,e,i){this.cur_monster_num=this.cur_monster_num-1,0==this.cur_monster_num&&this.checkNext()},e.prototype.checkNext=function(){this.cur_wave_id=this.cur_wave_id+1;var t;if(void 0==this.monster_list[this.cur_wave_id-1]){if(!this.isCircle)return void(2==this.scene_data.scene_type&&CopyProxy.ins().C2SReqCopyLeave(1));t=this.monster_list[0],this.cur_wave_id=1}else t=this.monster_list[this.cur_wave_id-1];this.cur_monster_num=t[4];for(var e=Math.floor(64*t[1]/100),i=Math.floor(64*t[2]/100),n=Math.floor(64*t[3]/100),o=[],s=0;s<t[4];s++){o=MathUtils.getRangePoint(e,i,n);
GameLogic.ins().createMonstersClient(t[0],o[0],o[1])}var r={x:e,y:i},a=MathUtils.getDistanceX2ByObject(GameMap.centerEntity,r);3e4>a&&GameLogic.ins().SetMonsterClientAI()},e.prototype.moveEnd=function(t){void 0!=this.scene_data&&GameLogic.ins().SetMonsterClientAI()},e.prototype.getCurMonsterPos=function(){var t={x:0,y:0};if(0==this.cur_wave_id)return t;var e=this.monster_list[this.cur_wave_id-1];return void 0!=e&&(t.x=Math.floor(64*e[1]/100),t.y=Math.floor(64*e[2]/100)),t},e}(BaseClass);__reflect(CopyHangManager.prototype,"CopyHangManager");var GameConst=function(){function t(){}return t.ROLE_MAX_COUNT=3,t.FB_BAG_COUNT=20,t.FB_ID_MAIN_CITY=0,t.MAP_ID_XUESE=2001,t.SKILL_CD=1e3,t.SKILL_ID_PLHXZ=103,t.QUALITY_COLOR=[16121855,4630307,2665145,12157665,12157665],t.ATTRIBUTE_COLOR=[16777215,13813860,4630307,2665145,14456370],t.BUFF_ID_HUIXUE=20001,t.RENAME_CARD=450001,t.fightAttrStr=["hp","hp_max","hp_pre","attack","defence","speed","pojia","mingzhong","shanbi","baoji_rate","kang_baoji_rate","baoji_hurt","kang_baoji_hurt","kang_baoji_pre","gedang_rate","gedang_hurt_pre","poji_rate","hurt_add_pre","hurt_sub_pre","inner_hurt","inner_sub_hurt","output_hurt","output_sub_hurt","partner_hurt_pre","suck_hp","extra_hurt","mingzhong_pre","shanbi_pre","zhongji_rate","kang_zhongji_rate","huixin_rate","kang_huixin_rate","lianji_rate","qiangji_rate","hurt_rebound_pre","kang_control_rate","coin_drop_pre","item_drop_pre","real_hurt","ft_wushi_define_pre","ft_hurt_add_pre","ft_xiuxian_add_pre","ft_baoji_rate","ft_baoji_hurt_pre","exp_per","equip_hp_per","equip_attack_per","equip_defence_per","equip_pojia_per","equip_baoji_hurt_per","equip_kang_baoji_hurt_per","baoji_hurt_add_per","kang_baoji_hurt_add_per","attack_add_per","defence_add_per"],t}();__reflect(GameConst.prototype,"GameConst");var MoneyConst;!function(t){t[t.exp=0]="exp",t[t.gold=1]="gold",t[t.yuanbao=2]="yuanbao",t[t.crystal=3]="crystal",t[t.essence=4]="essence",t[t.guildContrib=5]="guildContrib",t[t.fuildfund=6]="fuildfund",t[t.feats=7]="feats",t[t.starsoul=8]="starsoul",t[t.integral=9]="integral",t[t.max=10]="max"}(MoneyConst||(MoneyConst={}));var NumberType=function(){function t(){}return t.CommonBig="bignum_",t.CommonSmall="smallnum_",t.DamageFanShe="fanshenum_",t.DamageHuiXin="huixinnum_",t.DamageWuShi="wushinum_",t.DamageZhiMing="zhimingnum_",t.DamageZhuoYue="zhuoyuenum_",t.DamagePuTong="putongnum_",t.Iconnum="iconnum_",t.Forgenum="forgenum_",t}();__reflect(NumberType.prototype,"NumberType");var DamageType;!function(t){t[t.BLANK=0]="BLANK",t[t.MISS=1]="MISS",t[t.NORMAL=2]="NORMAL",t[t.BAOJI=3]="BAOJI",t[t.GEDAN=4]="GEDAN",t[t.QIANGJI=5]="QIANGJI",t[t.LIANJI=6]="LIANJI",t[t.HUIXIN=7]="HUIXIN",t[t.ZHONGJI=8]="ZHONGJI",t[t.INNER=9]="INNER",t[t.SHUCHU=10]="SHUCHU",t[t.SUCH=100]="SUCH",t[t.XL=101]="XL",t[t.QJHX=102]="QJHX",t[t.PETSHUCHU=103]="PETSHUCHU",t[t.BISHA=104]="BISHA",t[t.SPE_BAOJI=105]="SPE_BAOJI"}(DamageType||(DamageType={}));var EffectType;!function(t){t[t.Targer=0]="Targer",t[t.Self=1]="Self",t[t.Ballistic=2]="Ballistic",t[t.AnyAngle=3]="AnyAngle",t[t.Sustain=4]="Sustain",t[t.Ground=5]="Ground"}(EffectType||(EffectType={}));var EntityAction=function(){function t(){}return t.isAtkAction=function(e){return-1!=t.ATTACK_ACTIONS.indexOf(e)},t.getActionOrder=function(e){for(var i=0;i<t.ACTION_ORDER.length;i++){var n=t.ACTION_ORDER[i],o=n.indexOf(e);if(-1!=o)return i}return t.ACTION_ORDER.length},t.ATTACK="a",t.ATTACK3="b",t.ATTACK2="c",t.ATTACK4="x",t.ATTACK5="y",t.STAND="s",t.RUN="r",t.MOVE="m",t.JUMP="j",t.DIE="d",t.ATKED="h",t.ATTACK_ACTIONS=[t.ATTACK,t.ATTACK2,t.ATTACK3,t.ATTACK4,t.ATTACK5],t.ONCE_ACTIONS=[t.ATTACK,t.ATTACK2,t.ATTACK3,t.ATTACK4,t.ATTACK5,t.DIE,t.ATKED],t.RUN_FLY="m",t.STAND_FLY="f",t.FLY="",t.HIT="",t.Other4="",t.Other5="",t.ACTION_ORDER=[[t.DIE],[t.ATKED],[t.ATTACK,t.ATTACK2,t.ATTACK3,t.ATTACK4,t.ATTACK5],[t.RUN,t.RUN_FLY,t.STAND,t.STAND_FLY]],t}();__reflect(EntityAction.prototype,"EntityAction");var CastType;!function(t){t[t.Friend=1]="Friend",t[t.Enemy=2]="Enemy",t[t.Self=3]="Self",t[t.SelfByHp=4]="SelfByHp"}(CastType||(CastType={}));var TargetType;!function(t){t[t.Friend=1]="Friend",t[t.Enemy=2]="Enemy"}(TargetType||(TargetType={}));var BuffType;!function(t){t[t.AdditionalDamage=1]="AdditionalDamage",t[t.AddBlood=2]="AddBlood",t[t.AdditionalAttributes=3]="AdditionalAttributes",t[t.AdditionalState=4]="AdditionalState",t[t.Summon=5]="Summon"}(BuffType||(BuffType={}));var IconType=function(){function t(){}return t.IT_96x96="",t.IT_75x115="_b",t.IT_64x64="_a",t}();__reflect(IconType.prototype,"IconType");var PataType;!function(t){t[t.WanMo=0]="WanMo",t[t.HeiAn=1]="HeiAn"}(PataType||(PataType={}));var ItemType;!function(t){t[t.equip=0]="equip",t[t.mat=1]="mat",t[t.exp=5]="exp"}(ItemType||(ItemType={}));var QualityType;!function(t){t[t.White=0]="White",t[t.Green=1]="Green",t[t.Blue=2]="Blue",t[t.Purple=3]="Purple",t[t.Orange=4]="Orange"}(QualityType||(QualityType={}));var JobConst;!function(t){t[t.ZhanShi=1]="ZhanShi",t[t.FaShi=2]="FaShi",t[t.GongJianShou=3]="GongJianShou",t[t.MoJianShi=4]="MoJianShi",t[t.ShengDaoShi=5]="ShengDaoShi",t[t.ZhaoHuanShi=6]="ZhaoHuanShi",t[t.JobCount=6]="JobCount"}(JobConst||(JobConst={}));var GameLogic=function(t){function e(){var e=t.call(this)||this;return e.entityList=[],e.dropItems=[],e.expDoubleTime=0,e.expRate=0,e.expItemId=0,e.buffs={},e.enter_scene_time=0,KeyboardUtils.ins().addKeyDown(e.test,e),egret.startTick(e.onEnterFrame,e),e.observe(GameMap.ins().postGridClick,e.onMapGridClick),EventProxy.AddListener(e,EventType.S2CRepBelleUpdateShow,e.onPartnerAvatar),EventProxy.AddListener(e,EventType.S2CRepPetUpdateShow,e.onPetAvatar),EventProxy.AddListener(e,EventType.S2CRepHorseUpdateShow,e.onMountAvatar),EventProxy.AddListener(e,EventType.S2CRepBelleGetInfo,e.onPartnerAvatar),EventProxy.AddListener(e,EventType.S2CRepPetGetInfo,e.onPetAvatar),EventProxy.AddListener(e,EventType.S2CRepHorseGetInfo,e.onMountAvatar),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getCurSceneId=function(){return this.scene_id},e.prototype.isRevive=function(){var t=GlobalConfig.getSceneConfigById(this.scene_id);return void 0==t?!1:1==t.revive},e.prototype.isMainScene=function(){var t=GlobalConfig.getSceneConfigById(this.scene_id);return void 0==t?!1:1==t.scene_type},e.prototype.isBeastGhostScene=function(){var t=GlobalConfig.getSceneConfigById(this.scene_id);return void 0==t?!1:19==t.speciallogic_type},e.prototype.setLastScene=function(t){var e=GlobalConfig.getSceneConfigById(t);e&&1==e.scene_type&&(this.last_scene=t)},e.prototype.getLastScene=function(){return this.last_scene},e.prototype.getCurSceneData=function(){return this.scene_data},e.prototype.setEnterSceneTime=function(){this.enter_scene_time=this.getServerTime()},e.prototype.getEnterSceneTime=function(){return this.enter_scene_time},e.prototype.getServerTime=function(){return this.server_time+Math.floor((egret.getTimer()-this.egret_time)/1e3)},e.prototype.setServerTime=function(t){this.server_time=t,this.egret_time=egret.getTimer()},e.prototype.onEnterFrame=function(t){this.scene_ctrl&&this.scene_ctrl.update();for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];n.update(t)}return GameMap.centerEntity&&GameMap.ins().lookAt(GameMap.centerEntity.x,GameMap.centerEntity.y),!1},e.prototype.onMapGridClick=function(t){if(this.isInMainCity()&&!RoleProxy.ins().isInXunyou()){var e=new MovieClip;e.playFile(UI_EFF_DIR+"10068",1,function(){},!0),GameMap.ins().addEffectToGround(e),e.x=t.x,e.y=t.y;var i;i=GameMap.ins().checkWalkable(t.x,t.y)?GameMap.ins().getPath(t):GameMap.ins().getAroundPath(t,GameMap.centerEntity,GameMap.ins().checkWalkable),i&&i.length&&(GameMap.centerEntity.AI.startNone(),GameMap.centerEntity.startMove(i))}},e.prototype.getPath=function(t,e){var i,n=new XY;return n.x=t,n.y=e,i=GameMap.ins().checkWalkable(t,e)?GameMap.ins().getPath(n):GameMap.ins().getAroundPath(n,GameMap.centerEntity,GameMap.ins().checkWalkable)},e.prototype.addBuff=function(t,i){e.ins().getEntityByHandle(t)},e.prototype.removeBuff=function(t,i){var n=e.ins().getEntityByHandle(t),o=this.buffs[t];if(o)for(var s=0;s<o.length;s++)o[s].buffId==i&&o.slice(s,1);n&&n.removeBuff(i)},e.prototype.getBuffByHandle=function(t){return this.buffs[t]},e.prototype.sendEnterFb=function(t){var e=this.getBytes(30);e.writeInt(t),this.sendToServer(e)},e.prototype.doFbInfo=function(t){return Actor.outboardExp=t.readInt(),this.postFbInfo(),Actor.outboardExp},e.prototype.postFbInfo=function(){},e.prototype.sendQuitFb=function(){this.sendBaseProto(31)},e.prototype.sendNewRole=function(t,e){var i=this.getBytes(2);i.writeByte(t),i.writeByte(e),this.sendToServer(i)},e.prototype.sendHeartbeat=function(){this.heartBeatTimer},e.prototype.sendGMCommad=function(t){var e=this.getBytes(0);e.writeString(t),this.sendToServer(e)},e.prototype.enterBossScene=function(t){GlobalConfig.getConfig("boss_robot","boss_robotConfig");var e=new Array;for(var i in GlobalConfig.ins().boss_robotConfig){var n=GlobalConfig.ins().boss_robotConfig[i];if(n.scene_id==t){var o=this.createEntityByType(EntityTypes.BossPlayer);o.handle=EntityManager.ins().getHandleId(),o.setName(n.name),o.setJob(n.sex),o.x=n.scene_x,o.y=n.scene_y,o.setConfig(n),this.addEntity(o);for(var s=100*n.sex+1,r=1001,a=0;a<n.equip_list.length;++a);o.setMountFileName("zuoqi10001"),o.setBodyFileName(GlobalConfig.getCharResConfigById(s).body_res),o.setWeaponFileName(GlobalConfig.getCharResConfigById(r).body_res),o.setMountUpDir([3,5]),o.setProp(FightAttr.SPEED,0),o.setProp(FightAttr.HP,n.hp),o.setProp(FightAttr.HP_MAX,n.max_hp),e.push(o)}}var h=function(){for(var t=0;t<e.length;++t)e[t].AI.setEntity(e[t]),e[t].setAI(new AIBossRobot),e[t].AI.setAIState(AI_State.Atk),e[t].AI.start()};TimerManager.ins().doTimer(3e3,1,h,this)},e.prototype.onEnterScene=function(t){this.handle=t.obj_id,this.scene_id=t.scene_id,this.dir=t.dir,this.scene_x=t.scene_x,this.scene_y=t.scene_y,this.doEnterScene(this.scene_id),CommonUtils.log("当前进入场景:",this.scene_id),1!=this.scene_data.client_create_monster||this.isInMainCity()||HangManager.ins().initData(this.scene_data)},e.prototype.onEnterCopy=function(t){var e=GlobalConfig.getCopyConfigById(t);if(null!=e){var i=e.scene_type_id[0],n=GlobalConfig.getSceneConfigById(i);if(void 0==n)return;this.scene_x=Math.floor(n.x/100),this.scene_y=Math.floor(n.y/100),this.doEnterScene(i),CommonUtils.log("CopyEnterScene-------------->",t,i,RoleProxy.ins().getSceneId())}1==this.scene_data.client_create_monster&&CopyHangManager.ins().initData(this.scene_data)},e.prototype.onExitCopy=function(){var t=GlobalConfig.getSceneConfigById(RoleProxy.ins().getSceneId());this.scene_x=Math.floor(t.x/100),this.scene_y=Math.floor(t.y/100),this.doEnterScene(t.id),1!=this.scene_data.client_create_monster||this.isInMainCity()||HangManager.ins().initData(this.scene_data)},e.prototype.doEnterScene=function(t){var i=this;UtilProxy.ins().CheckCloseView(),ViewManager.ins().isShow(SpeView)&&ViewManager.ins().close(SpeView);var n=GlobalConfig.getSceneConfigById(t);if(void 0!=n){e.ins().setEnterSceneTime(),1==n.scene_type&&CopyProxy.ins().ClearData(),this.scene_data=n,GameMap.ins().mapID=n.map_id,GameMap.ins().mapX=Math.floor(64*this.scene_x),GameMap.ins().mapY=Math.floor(64*this.scene_y),this.scene_ctrl&&this.scene_ctrl.destory(),1==this.scene_data.scene_type&&this.scene_data.is_main&&(this.scene_ctrl=new SceneCtrlMainCity,this.scene_ctrl.init({})),TimerManager.ins().removeAll(this),EntityManager.ins().resetHandle(),HangManager.ins().Destroy(),CopyHangManager.ins().clearData(),GameMap.ins().changeMap(),GameMap.ins().clearAll(),TimerManager.ins().removeAll(SkillEffPlayer),egret.Tween.removeTweens(SkillEffPlayer),egret.Tween.removeTweens(GameMap.ins()),this.clearAllEntity(),MovieClip.clearData(),GameMap.centerEntity=null,3==n.scene_type&&SceneControl.ins().initDamageData(),this.createMainRole();var o=HuobanProxy.ins().getShowData();o&&o.model_id>0&&this.createPartner(GameMap.centerEntity,o);var s=PetProxy.ins().getShowData();s&&s.model_id>0&&this.createPet(GameMap.centerEntity,s);var r=1,a=this.scene_data.copy_id>0&&CopyProxy.ins().isBaowuCopy(this.scene_data.copy_id);a&&(r=5,TipsControl.ins().ShowTips2(r));var h=CopyProxy.ins().isDujieCopy(this.scene_id);if(h&&(r=3,TipsControl.ins().ShowTips2(r)),TimerManager.ins().doTimer(1e3,r,function(){r-=1,(a||h)&&TipsControl.ins().ShowTips2(r)},this,function(){GameMap.centerEntity&&1!=i.scene_data.client_create_monster&&GameMap.centerEntity.AI.start(),CopyProxy.ins().isShenxian(i.scene_id)&&ShenXianProxy.ins().C2SReqArenaLoadingFinish(),CopyProxy.ins().isLunjian(i.scene_id)&&LunjianProxy.ins().C2SReqFactionswordLoadingFinish()},this),SkillProxy.ins().checkActiveOpen(),LyhProxy.ins().show_reward_id>0&&TimerManager.ins().doTimer(600,1,function(){ViewManager.ins().open(LyhRewardTips,LyhProxy.ins().show_reward_id);LyhProxy.ins().show_reward_id=0},this),this.scene_data&&this.scene_data.is_skill_reset>0&&GameMap.centerEntity){var l=GameMap.centerEntity.AI;if(l instanceof AIRoleMU)for(var p=SkillCC.ins().getSkillDatasOfRole(GameMap.centerEntity.index),c=0,u=p;c<u.length;c++){var d=u[c];d&&l.resetSkillCd(d.skillId)}}}},e.prototype.isCopyScene=function(t){var e=GlobalConfig.getSceneConfigById(t);return null!=e?1!=e.scene_type:!1},e.prototype.isBossYWScene=function(t){var e=GlobalConfig.getSceneConfigById(t);return null!=e?9==e.speciallogic_type:!1},e.prototype.isBossYamaScene=function(t){var e=BossProxy.ins().getYamaSceneId();return null!=e?e==t:!1},e.prototype.isClientCreate=function(){return void 0==this.scene_data?!1:1==this.scene_data.client_create_monster?!0:!1},e.prototype.doCreateOtherEntity=function(t){},e.prototype.doEntityMove=function(t){var e=t.obj_id,i=this.getEntityByHandle(e);if(i&&i.handle!=GameMap.centerEntity.handle){var n=t.pos_x,o=t.pos_y,s=GameMap.ins().getPath({x:n,y:o},i);s&&s.length&&(i.setDir(t.dir),i.startMove(s))}},e.prototype.doStopMoveEntity=function(t){var e=t.readDouble(),i=(t.readInt(),t.readInt(),this.getEntityByHandle(e));i&&i.masterHandle!=Actor.handle&&i.AI.startStand()},e.prototype.sendPickUpItem=function(t){},e.prototype.doPickUpItem=function(t){},e.prototype.postPickUpItem=function(){},e.prototype.doCreatDropItem=function(t){},e.prototype.doCreateDropGroup=function(t,e,i){for(var n=i.length,o=GameMap.CELL_SIZE,s=0;n>s;s++){var r=ObjectPool.pop(egret.getQualifiedClassName(EntityDropItem));0==s?(r.x=t,r.y=e):(r.x=t+o+Math.random()*o,r.y=e+o+Math.random()*o),r.setData(i[s]),this.dropItems.push(r),GameMap.ins().addDropTo(r),r.playDropMovie()}},e.prototype.ClearMapPickItem=function(){for(var t=this.dropItems.length-1;t>=0;t--){var e=this.dropItems[t];DisplayUtils.removeFromParent(e),this.dropItems.splice(t,1),e.reset(),ObjectPool.push(e)}},e.prototype.getDropItemCount=function(){return this.dropItems.length},e.prototype.getDropIsItem=function(){return!1},e.prototype.clearAllDropItems=function(){for(var t=0;t<this.dropItems.length;t++){var e=this.dropItems[t];DisplayUtils.removeFromParent(e),e.reset(),ObjectPool.push(e)}this.dropItems.length=0},e.prototype.createEntityByType=function(t){var e;return t==EntityTypes.CollectionMonsterMU||(t==EntityTypes.RoleMU?e=ObjectPool.pop(egret.getQualifiedClassName(EntityRole)):t==EntityTypes.ArenaPlayer?e=ObjectPool.pop(egret.getQualifiedClassName(EntityArena)):t==EntityTypes.MonsterMU?e=ObjectPool.pop(egret.getQualifiedClassName(EntityMonster)):t==EntityTypes.MonsterClientMU?e=ObjectPool.pop(egret.getQualifiedClassName(EntityMonsterClient)):t==EntityTypes.NPCMU?e=ObjectPool.pop(egret.getQualifiedClassName(EntityNPC)):t==EntityTypes.OtherMU?e=ObjectPool.pop(egret.getQualifiedClassName(EntityOther)):t==EntityTypes.PetMu?e=ObjectPool.pop(egret.getQualifiedClassName(EntityPet)):t==EntityTypes.PartnerMu?e=ObjectPool.pop(egret.getQualifiedClassName(EntityPartner)):t==EntityTypes.Player?e=ObjectPool.pop(egret.getQualifiedClassName(EntityPlayer)):t==EntityTypes.BossPlayer?e=ObjectPool.pop(egret.getQualifiedClassName(EntityRobot)):t==EntityTypes.YezhanPlayer&&(e=ObjectPool.pop(egret.getQualifiedClassName(EntityYezhan)))),e},e.prototype.creatNpc=function(){var t=GlobalConfig.getSceneConfigById(GameMap.ins().mapID);for(var e in t.npcPos);},e.prototype.creatMyDamon=function(){},e.prototype.doExp=function(t){var e=Actor.level,i=Actor.level,n=t.readInt();if(Actor.level=n,i!=n&&(i=Actor.exp),n=t.readInt(),Actor.setExp(n),i!=n&&e<Actor.level){var o=GameMap.centerEntity;if(o){var s=new MovieClip;o.addChild(s),s.playFile(AssetMgr.getLevelUpResource(),1)}}GameTips.ins().ShowTips("|C:0x23CA23&T:经验 +"+t.readInt()+"|",1),Actor.totalexp=t.readDouble()},e.prototype.doBloodUpdate=function(t,e){var i=t,n=e,o=this.getEntityByHandle(i);o&&o.setHp(n)},e.prototype.doRemoveEntity=function(t){var e=this.getEntityByHandle(t);e&&(e.pet_handle>0&&this.removeEntityByHandle(e.pet_handle),e.partner_handle>0&&this.removeEntityByHandle(e.partner_handle)),this.removeEntityByHandle(t)},e.prototype.doEntityDie=function(t){var e=t.readDouble(),i=t.readDouble(),n=this.getEntityByHandle(e),o=this.getEntityByHandle(i);n?this.doEntityDie1(n,o):CommonUtils.log("需要死亡的"+e+"的实体不存在")},e.prototype.doEntityDie1=function(t,e){var i=this,n=1e3;return t.AI.startDie(n,e),t instanceof EntityMonster?(TimerManager.ins().doTimer(n,1,function(){t instanceof EntityMonsterClient&&i.removeEntityByHandle(t.handle)},this),void DisplayUtils.shakeIt(GameMap.ins(),10,200)):(t instanceof EntityYezhan&&this.doRemoveEntity(t.handle),void(e instanceof EntityYezhan&&this.doRemoveEntity(e.handle)))},e.prototype.doSyncPos=function(t){var e=t.readDouble(),i=t.readShort(),n=t.readInt(),o=t.readInt(),s=t.readInt(),r=this.getEntityByHandle(e);if(r){switch(i){case 0:r.x=t.readInt(),r.y=t.readInt();break;case 1:break;case 2:this.atkedTarget(e,n,o,s)}}},e.prototype.atkedTarget=function(t,e,i,n,o){void 0===o&&(o=0);var s=this.getEntityByHandle(t);s&&s.AI.startAtked(e,i,n,o)},e.prototype.doFirstRegister=function(t){},e.prototype.doDieNotice=function(t){},e.prototype.sendChangeAttrPoint=function(t){var e=this.getBytes(25);e.writeDouble(t),this.sendToServer(e)},e.prototype.doEntityModelChange=function(t){var e=t.readDouble(),i=(t.readInt(),t.readInt(),t.readByte(),t.readByte(),this.getEntityByHandle(e));if(!(i&&i instanceof EntityRole))throw new Error("实体不存在:"+e)},e.prototype.test=function(t){t==Keyboard.R,t==Keyboard.BRACE_L,t==Keyboard.BACKSLASH&&ErrorLog.ins().show("2134"),t==Keyboard.I,t==Keyboard.O,t==Keyboard.P,t==Keyboard.SPACE,t==Keyboard.BACK_QUOTE,t==Keyboard.ENTER},e.prototype.addEntity=function(t){this.entityList.push(t),GameMap.ins().addEntity(t)},e.prototype.getEnitityByBossId=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n instanceof EntityMonster&&n.getConfig().id==t)return n}return null},e.prototype.getEnitityRoleList=function(){for(var t=[],e=0,i=this.entityList;e<i.length;e++){var n=i[e];n instanceof EntityRole&&t.push(n)}return t},e.prototype.getEnitityRoleCount=function(){for(var t=0,e=0,i=this.entityList;e<i.length;e++){var n=i[e];n instanceof EntityRole&&t++}return t},e.prototype.postHookStateChange=function(t){return this.hookState=t,t},e.prototype.getNearestEnemyByAI=function(t,e){void 0===e&&(e=Number.MAX_VALUE);for(var i=null,n=e,o=0,s=this.entityList;o<s.length;o++){var r=s[o],a=t.isEnemy(r),h=r.canBeAtk();if(a&&h){var l=t.getEntityPos(),p=new egret.Point(r.x,r.y),c=MathUtils.getDistanceX2ByObject(l,p);n>c&&(n=c,i=r)}}return i},e.prototype.getNearestRoleEnemyByAI=function(t,e){void 0===e&&(e=Number.MAX_VALUE);for(var i=null,n=e,o=0,s=this.entityList;o<s.length;o++){var r=s[o];if(r instanceof EntityRole){var a=t.isEnemy(r),h=r.canBeAtk();if(a&&h){var l=t.getEntityPos(),p=new egret.Point(r.x,r.y),c=MathUtils.getDistanceX2ByObject(l,p);n>c&&(n=c,i=r)}}}return i},e.prototype.getNearestEntity=function(t){for(var e=null,i=Number.MAX_VALUE,n=0,o=this.entityList;n<o.length;n++){var s=o[n],r=MathUtils.getDistanceX2ByObject(t,s);i>r&&(i=r,e=s)}return e},e.prototype.getNearestPicker=function(t){for(var e=null,i=Number.MAX_VALUE,n=0,o=this.entityList;n<o.length;n++){var s=o[n];if(s.masterHandle==Actor.handle){var r=MathUtils.getDistanceX2ByObject(t,s);i>r&&(i=r,e=s)}}return e},e.prototype.getItemCanPickUp=function(t,e){void 0===e&&(e=-1);for(var i=null,n=0,o=this.dropItems;n<o.length;n++){var s=o[n];if(!s.hasPicked&&t.handle==s.pickerHandle&&(s.item.type==e||-1==e))if(i){var r=MathUtils.getDistanceX2ByObject(t,s),a=MathUtils.getDistanceX2ByObject(t,i);a>r&&(i=s)}else i=s}return i},e.prototype.getItemCanPickUp1=function(t){var e=null;return e},e.prototype.getEntityByHandle=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.handle==t)return n}return null},e.prototype.getEntityByRoleId=function(t){for(var e=0,i=this.entityList;e<i.length;e++){var n=i[e];if(n.role_id==t)return n}return null},e.prototype.removeEntityByHandle=function(t){for(var e=0;e<this.entityList.length;e++)if(this.entityList[e].handle==t){var i=this.entityList.splice(e,1)[0];i.destruct(),ObjectPool.push(i)}},e.prototype.getMyEntitys=function(){for(var t=[],e=0,i=this.entityList;e<i.length;e++){var n=i[e];n.masterHandle==Actor.handle&&t.push(n)}return t},e.prototype.getRoleEntitys=function(){for(var t=[],e=0,i=this.entityList;e<i.length;e++){var n=i[e];n instanceof EntityRole&&n.handle!=GameMap.centerEntity.handle&&n.masterHandle!=Actor.handle&&t.push(n)}return t},e.prototype.getEntityCountByName=function(t){for(var e=0,i=0,n=this.entityList;i<n.length;i++){var o=n[i];egret.getQualifiedClassName(o)==t&&e++}return e},e.prototype.getNpcById=function(t){return null},e.prototype.getEnemenysInRang=function(t,e,i,n,o){void 0===o&&(o=Number.MAX_VALUE);for(var s=[],r=GameMap.CELL_SIZE,a=i*r/2,h=n*r/2,l=0,p=0,c=0,u=e;c<u.length;c++){var d=u[c];if(s.length>=o)break;l=Math.abs(d.x-t.x),p=Math.abs(d.y-t.y),a>=l&&h>=p&&t.handle!=d.handle&&s.push(d)}return s},e.prototype.getRangeEnemenys=function(t,e,i,n,o){void 0===i&&(i=0),void 0===o&&(o=Number.MAX_VALUE);var s=[];s.push(e);for(var r=GameMap.CELL_SIZE,a=Math.floor(e.x/r),h=Math.floor(e.y/r),l=Math.max(a-i,0)*r,p=Math.max(h-i,0)*r,c=(a+i+1)*r,u=(h+i+1)*r,d=0,g=n;d<g.length;d++){var y=g[d];if(s.length>=o)break;y.x>l&&y.y>p&&y.x<c&&y.y<u&&e.handle!=y.handle&&s.push(y)}return s},e.prototype.getRectEnemenys=function(t,e,i,n,o,s){void 0===s&&(s=Number.MAX_VALUE);var r=[];r.push(e);for(var a=i*GameMap.CELL_SIZE,h=e.x-t.x,l=e.y-t.y,p=Math.atan2(l,h),c=n*GameMap.CELL_SIZE/2,u=0,d=o;u<d.length;u++){var g=d[u];if(r.length>=s)break;var y=g.x-t.x,f=g.y-t.y,_=Math.abs(Math.atan2(f,y)-p),v=y*y+f*f,m=Math.cos(_),C=Math.sin(_);(_<=Math.PI/2||_>=3*Math.PI/2)&&a*a>=m*m*v&&c*c>=C*C*v&&e.handle!=g.handle&&(g.isDead()||r.push(g))}return r},e.prototype.getFanshapedEnemenys=function(t,e,i,n,o,s){void 0===s&&(s=Number.MAX_VALUE);var r=[];r.push(e);var a,h,l,p,c=GameMap.CELL_SIZE,u=i*c*i*c,d=n*Math.PI/180/2;a=e.x-t.x,l=e.y-t.y;for(var g=(new egret.Shape,Math.atan2(l,a),0),y=o;g<y.length;g++){var f=y[g];h=f.x-t.x,p=f.y-t.y;var _=h*h+p*p,v=Math.abs(Math.atan2(l,a)-Math.atan2(p,h));if(u>_&&d>v&&e.handle!=f.handle&&(f.isDead()||r.push(f)),r.length>=s)break}return r},e.prototype.getRoundEnemenys=function(t,i,n){void 0===n&&(n=Number.MAX_VALUE);for(var o=[],s=e.ins().getEnemysByAI(t.AI),r=0,a=s;r<a.length;r++){var h=a[r];if(MathUtils.getDistanceX2ByObject({x:t.x,y:t.y},{x:h.x,y:h.y})<=Math.pow(i*GameMap.CELL_SIZE,2)){if(!(o.length<n))break;h.isDead()||o.push(h)}}return o},e.prototype.getEnemysByAI=function(t,e){for(var i=[],n=0,o=this.entityList;n<o.length;n++){var s=o[n];if(t.isEnemy(s)&&0==s.isDead()){if(e&&i.length>=e)break;i.push(s)}}return i},e.prototype.clearAllEntity=function(){for(var t=0,e=this.entityList;t<e.length;t++){var i=e[t];i.destruct(),ObjectPool.push(i)}this.entityList.length=0,this.clearAllDropItems()},e.prototype.getEntityList=function(){return this.entityList},e.prototype.createMainRole=function(){var t=new EntityVo;t.handle=this.handle,t.sex=RoleProxy.ins().getRoleSex(),t.cloth_id=RoleProxy.ins().getClothId(),t.weapon_id=RoleProxy.ins().getWeaponId(),t.mount_id=RoleProxy.ins().getMountId(),t.wing_id=RoleProxy.ins().getWingId(),t.xunyou=this.isInXunyou(),t.xiuxian_level=XiuXianProxy.ins().achie_level,t.xiuwei=XiuXianProxy.ins().achie_value,t.pet_fight=PetProxy.ins().getFight(),t.partner_fight=HuobanProxy.ins().getFight();var i=ObjectPool.pop(egret.getQualifiedClassName(EntityRole));i.vo=t,i.handle=this.handle,i.masterHandle=1,i.setName("S"+RoleProxy.ins().getRoleServerId()+"."+RoleProxy.ins().getRoleName()),i.setXianWei(XiuXianProxy.ins().getXianweiName()),i.setJob(RoleProxy.ins().getRoleSex()),i.x=GameMap.ins().mapX,i.y=GameMap.ins().mapY,i.index=1,i.role_id=RoleProxy.ins().getRoleId(),i.server_id=RoleProxy.ins().getRoleServerId(),i.is_main=!0,e.ins().addEntity(i),i.setMountFileName(t.getMountRes()),i.setBodyFileName(t.getClothRes()),i.setWeaponFileName(t.getWeaponRes()),""!=t.getWingRes()&&i.setWingFileName(t.getWingRes()),i.setMountUpDir(t.getMountDirList());for(var n=RoleProxy.ins().getFightAttrs(),o=1;o<n.length;o++)i.setProp(o,n[o]);if(GameMap.centerEntity=i,1==this.scene_data.client_create_monster){i.setAI(new AIMainRole);var s=GlobalConfig.getHangPathById(this.scene_data.hang_id);i.AI.setHangList(s)}else if(CopyProxy.ins().isShenxian(this.scene_id)||CopyProxy.ins().isLunjian(this.scene_id)||CopyProxy.ins().isZMZD(this.scene_id))i.setAI(new AIMainRole),i.AI.setHangList(null);else if(9==this.scene_data.speciallogic_type)i.setAI(new AIMainRole),i.AI.setHangList(null);else if(37==this.scene_data.speciallogic_type)i.setAI(new AIMainRole),i.AI.setHangList(null);else if(18==this.scene_data.speciallogic_type||19==this.scene_data.speciallogic_type||41==this.scene_data.speciallogic_type)i.setAI(new AIRoleKuaFu),i.AI.setHangList(null);else if(this.isInMainCity()){i.setAI(new AIMainCity);var r=GlobalConfig.getXyCopyDataById(3);r&&t.xunyou&&i.AI.setPathList(r.path)}else ZPZBProxy.ins().IsZPZB(this.scene_id)?(i.setAI(new AIRoleZPZB),i.AI.setHangList(null),i.startAI(),i.setTitle(ZPZBProxy.ins().getTitleRes(FacProxy.ins().getFacId()))):(i.setAI(new AIMainRole),i.AI.setHangList(null));i.AI.setAIState(AI_State.Atk),i.AI.stop(),SkillCC.ins().isRecordDamage&&SceneControl.ins().addHurt(i.handle,i.name)},e.prototype.createPartner=function(t,e){var i=t.partner_handle;i>0&&this.removeEntityByHandle(i);var n=this.createEntityByType(EntityTypes.PartnerMu);n.handle=EntityManager.ins().getHandleId(),n.masterHandle=t.handle,n.master=t,t.partner_handle=n.handle,n.dir=5,n.x=GameMap.centerEntity.x-50,n.y=GameMap.centerEntity.y-50,n.setConfig(e),n.setHp(100,100),n.setAI(new AIPartner),n.AI.setEntity(n),n.AI.start(),this.addEntity(n),t.vo&&t.vo.xunyou&&(n.visible=!1)},e.prototype.createPet=function(t,e){var i=t.pet_handle;i>0&&this.removeEntityByHandle(i);var n=this.createEntityByType(EntityTypes.PetMu);n.handle=EntityManager.ins().getHandleId(),n.masterHandle=t.handle,n.master=t,t.pet_handle=n.handle,n.dir=5,n.x=GameMap.centerEntity.x-100,n.y=GameMap.centerEntity.y-100,n.setConfig(e),n.setHp(100,100),n.setAI(new AIPet),n.AI.setEntity(n),n.AI.start(),this.addEntity(n),t.vo&&t.vo.xunyou&&(n.visible=!1)},e.prototype.onPartnerAvatar=function(){if(GameMap.centerEntity){var t=GameMap.centerEntity.partner_handle;t>0&&this.removeEntityByHandle(t);var e=HuobanProxy.ins().getShowData();e&&e.model_id>0&&this.createPartner(GameMap.centerEntity,e)}},e.prototype.onPetAvatar=function(){if(GameMap.centerEntity){var t=GameMap.centerEntity.pet_handle;t>0&&this.removeEntityByHandle(t);var e=PetProxy.ins().getShowData();e&&e.model_id>0&&this.createPet(GameMap.centerEntity,e)}},e.prototype.onMountAvatar=function(){!GameMap.centerEntity},e.prototype.createMonstersClient=function(t,e,i){var n=this.createEntityByType(EntityTypes.MonsterClientMU);return n.handle=EntityManager.ins().getHandleId(),n.dir=1,n.x=e,n.y=i,n.setConfig(GlobalConfig.getMonsterConfigById(t)),n.setHp(n.getConfig().hp,n.getConfig().hp),n.setAI(new AIMonsterClient),n.AI.setEntity(n),this.addEntity(n),n},e.prototype.doCreateMonster=function(t){var e=this.createEntityByType(EntityTypes.MonsterMU);if(e.handle=t.obj_id,this.scene_data&&this.scene_data.dir>0)e.dir=this.scene_data.dir;else{var i=[1,3,5,7],n=MathUtils.getRandom(0,i.length-1);e.dir=i[n]}return e.x=t.pos_x*GameMap.CELL_SIZE,e.y=t.pos_y*GameMap.CELL_SIZE,e.setConfig(GlobalConfig.getMonsterConfigById(t.monster_id)),e.setProp(FightAttr.HP,t.hp),e.setProp(FightAttr.HP_MAX,t.max_hp),e.setHp(t.hp,t.max_hp),e.setProp(FightAttr.SPEED,t.speed),BossProxy.ins().isBossId(t.monster_id)||ZPZBProxy.ins().IsBossId(t.monster_id)?e.setTitle("zongpaizhengba_font_BOSS"):e.setTitle(""),this.addEntity(e),e},e.prototype.createArenaRole=function(t){var i=this.createEntityByType(EntityTypes.ArenaPlayer);i.handle=t.obj_id;var n=new EntityVo;n.handle=t.obj_id,n.sex=t.prof,i.vo=n,i.setName("S"+RoleProxy.ins().getRoleServerId()+"."+t.role_name),i.setJob(t.prof),i.x=t.pos_x*GameMap.CELL_SIZE,i.y=t.pos_y*GameMap.CELL_SIZE,e.ins().addEntity(i);for(var o=0;o<t.avatars.length;o++){var s=t.avatars[o].type,r=t.avatars[o].id;switch(s){case AvatarType.ZUOQI:n.mount_id=r;break;case AvatarType.FASHION:n.cloth_id=r;break;case AvatarType.SHENBING:n.weapon_id=r;break;case AvatarType.WING:n.wing_id=r;break;case AvatarType.PET:if(r>0){var a=PetProxy.ins().getShowDataById(r);a&&this.createPet(i,a)}break;case AvatarType.BELLE:if(r>0){var a=HuobanProxy.ins().getShowDataById(r);a&&this.createPartner(i,a)}break;case AvatarType.XUNYOU:n.xunyou=r>0}}i.setBodyFileName(n.getClothRes()),i.setWeaponFileName(n.getWeaponRes()),""!=n.getWingRes()&&i.setWingFileName(n.getWingRes()),i.setMountFileName(n.getMountRes()),i.setMountUpDir(n.getMountDirList()),i.setProp(FightAttr.SPEED,t.speed),i.setProp(FightAttr.HP_MAX,t.max_hp),i.setProp(FightAttr.HP,t.hp)},e.prototype.createRole=function(t){var e=t.scene_id;if(this.scene_id!=e)return void CommonUtils.log("Add Role Wrong Scene ID: "+this.scene_id+" ---- "+e);var i=this.createEntityByType(EntityTypes.Player);i.handle=t.obj_id,i.role_id=t.role_id,i.server_id=t.server_id,i.dir=t.dir||1,i.zhuan=t.zhuan,i.level=t.level,i.team_id=t.team_id,i.faction=t.faction,i.is_leader=t.is_leader,i.setName("S"+t.server_id+"."+t.role_name),i.setJob(t.prof),i.x=t.pos_x*GameMap.CELL_SIZE,i.y=t.pos_y*GameMap.CELL_SIZE;var n=new EntityVo;n.sex=t.prof,i.vo=n,this.addEntity(i);for(var o=0;o<t.avatar_list.length;o++){var s=t.avatar_list[o].type,r=t.avatar_list[o].id;switch(s){case AvatarType.ZUOQI:n.mount_id=r;break;case AvatarType.FASHION:n.cloth_id=r;break;case AvatarType.SHENBING:n.weapon_id=r;break;case AvatarType.WING:n.wing_id=r;break;case AvatarType.PET:if(r>0){var a=PetProxy.ins().getShowDataById(r);a&&this.createPet(i,a)}break;case AvatarType.BELLE:if(r>0){var a=HuobanProxy.ins().getShowDataById(r);a&&this.createPartner(i,a)}break;case AvatarType.XUNYOU:n.xunyou=r>0;break;case AvatarType.FIGHT:i.fight=r;break;case AvatarType.XIANWEI:var h=XiuXianProxy.ins().getXianweiNameById(r);i.setXianWei(h)}}return i.setBodyFileName(n.getClothRes()),i.setWeaponFileName(n.getWeaponRes()),""!=n.getWingRes()&&i.setWingFileName(n.getWingRes()),i.setMountFileName(n.getMountRes()),i.setMountUpDir(n.getMountDirList()),i.setProp(FightAttr.SPEED,t.speed),i.setProp(FightAttr.HP,t.hp),i.setProp(FightAttr.HP_MAX,t.max_hp),ZPZBProxy.ins().IsZPZB(t.scene_id)&&i.setTitle(ZPZBProxy.ins().getTitleRes(i.faction)),SkillCC.ins().isRecordDamage&&SceneControl.ins().addHurt(t.obj_id,t.role_name),i},e.prototype.doCreateYezhanRole=function(t){var i=this.createEntityByType(EntityTypes.YezhanPlayer);i.handle=EntityManager.ins().getHandleId();var n=new EntityVo;n.handle=i.handle,n.sex=t.prof,n.xiuxian_level=t.xiuxian_level,n.xiuwei=t.xiuwei,i.vo=n,i.vo.xiuwei=t.xiuwei,i.vo.xiuxian_level=t.xiuxian_level,i.setName("S"+RoleProxy.ins().getRoleServerId()+"."+t.name),i.setJob(t.prof);var o=GameMap.centerEntity;if(o&&o.AI instanceof AIMainRole){var s=YezhanProxy.ins().pos;i.x=s.x,i.y=s.y}e.ins().addEntity(i);var r=new AIYezhanRole;i.setAI(r);for(var a=0;a<t.avatars.length;a++){var h=t.avatars[a].id,l=t.avatars[a].value;
switch(h){case AvatarType.ZUOQI:n.mount_id=l;break;case AvatarType.FASHION:n.cloth_id=l;break;case AvatarType.SHENBING:n.weapon_id=l;break;case AvatarType.WING:n.wing_id=l;break;case AvatarType.PET:if(l>0){var p=PetProxy.ins().getShowDataById(l);p&&this.createPet(i,p)}break;case AvatarType.BELLE:if(l>0){var p=HuobanProxy.ins().getShowDataById(l);p&&this.createPartner(i,p)}break;case AvatarType.BELLE_FIGHT:o.vo.partner_fight=l;break;case AvatarType.PET_FIGHT:o.vo.pet_fight=l;break;case AvatarType.XUNYOU:n.xunyou=l>0}}i.setBodyFileName(n.getClothRes()),i.setWeaponFileName(n.getWeaponRes()),""!=n.getWingRes()&&i.setWingFileName(n.getWingRes()),i.setMountFileName(n.getMountRes()),i.setMountUpDir(n.getMountDirList());for(var a=0;a<t.attrs.length;a++){var c=t.attrs[a].id,u=t.attrs[a].value;i.setProp(c,u)}return r.setEntity(i),r.setSkill(t.skills),r.updateStartPoint(),i.handle},e.prototype.SetMonsterClientAI=function(){for(var t=0,e=this.entityList;t<e.length;t++){var i=e[t];i instanceof EntityMonsterClient&&(i.AI.setAIState(AI_State.Atk),i.AI.start())}},e.prototype.onPerformSkill=function(t){var e=t.perform_obj_id,i=EntityAction.ATTACK,n=this.getEntityByHandle(e);void 0!=n&&n.playAction(i)},e.prototype.onChangeAvatar=function(t){var e=this.getEntityByHandle(t.obj_id);if(void 0!=e)for(var i=0;i<t.avatar_list.length;i++){var n=t.avatar_list[i].type,o=t.avatar_list[i].id;this.changeAvatar(t.obj_id,o,n)}},e.prototype.changeAvatar=function(t,e,i){var n=this.getEntityByHandle(t);if(void 0!=n&&void 0!=n.vo){var o=n.vo;switch(i){case AvatarType.INVALID:break;case AvatarType.FASHION:o.cloth_id=e,n.setBodyFileName(o.getClothRes());break;case AvatarType.SHENBING:o.weapon_id=e,n.setWeaponFileName(o.getWeaponRes());break;case AvatarType.WING:o.wing_id=e,0!=e&&n.setWingFileName(o.getWingRes());break;case AvatarType.ZUOQI:o.mount_id=e,n.setMountFileName(o.getMountRes()),n.setMountUpDir(o.getMountDirList());break;case AvatarType.REPUTATION:break;case AvatarType.TITLE:break;case AvatarType.VIP:break;case AvatarType.PET:break;case AvatarType.BELLE:break;case AvatarType.BELLE_FIGHT:n.vo&&(n.vo.partner_fight=e);break;case AvatarType.PET_FIGHT:n.vo&&(n.vo.pet_fight=e);break;case AvatarType.XIANWEI:if(n instanceof EntityRole){var s=XiuXianProxy.ins().getXianweiNameById(e);n.setXianWei(s)}break;case AvatarType.XUNYOU:if(this.isInMainCity())if(n.handle==this.handle&&RoleProxy.ins().setXuyou(e),e>0){n.vo.xunyou=!0;var r=GlobalConfig.getXyCopyDataById(3);r&&n.handle==GameMap.centerEntity.handle&&n.AI.setPathList(r.path),this.setEntityVisible(n.pet_handle,!1),this.setEntityVisible(n.partner_handle,!1),n.refresh()}else n.vo.xunyou=!1,this.setEntityVisible(n.pet_handle,!0),this.setEntityVisible(n.partner_handle,!0),n.refresh();break;case AvatarType.PROF:n.vo.sex=e,n.setBodyFileName(o.getClothRes())}}},e.prototype.setEntityVisible=function(t,e){if(t>0){var i=this.getEntityByHandle(t);i&&(i.visible=e,e&&i.refresh())}},e.prototype.isInMainCity=function(){var t=GlobalConfig.getXyCopyDataById(3);return t&&this.scene_id==t.scene_type_id?!0:!1},e.prototype.isInXunyou=function(){return this.isInMainCity()&&RoleProxy.ins().isInXunyou()},e.prototype.getSendMoveType=function(){return this.scene_data?1==this.scene_data.client_create_monster?0:ZPZBProxy.ins().IsZPZB(this.scene_id)?2:1:0},e.HOOK_STATE_FIND_ENMENY=1,e}(BaseSystem);__reflect(GameLogic.prototype,"GameLogic");var GameSystem;!function(t){t.gamelogic=GameLogic.ins.bind(GameLogic)}(GameSystem||(GameSystem={}));var GameTips=function(t){function e(){var e=t.call(this)||this;return e.listTipsStr=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.ShowTips=function(t,e){1==e?(this.listTipsStr.length>=3?(this.listTipsStr.unshift(t),this.listTipsStr.splice(3,1)):this.listTipsStr.unshift(t),this.postTipsUpdate()):TipsControl.ins().showTips(t)},e.prototype.postTipsUpdate=function(){},e}(BaseSystem);__reflect(GameTips.prototype,"GameTips");var GameSystem;!function(t){t.gameTips=GameTips.ins.bind(GameTips)}(GameSystem||(GameSystem={}));var HangManager=function(t){function e(){var e=t.call(this)||this;return e.monster_list=[],e.cur_wave_id=0,e.cur_monster_num=0,e.isCircle=!1,e.pause=!1,e.is_active=!1,e.is_all_monster_die=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getCurMonsterNum=function(){return this.cur_monster_num},e.prototype.initData=function(t){var e=this;this.is_active=!0,EventProxy.AddListener(this,EventType.UpdateMonsterReward,this.UpdateReward),EventProxy.AddListener(this,EventType.HangMonsterDie,this.onMonsterDie),this.scene_data=t,this.cur_wave_id=0,this.cur_monster_num=0,this.monster_list=[],this.isCircle=1==t.monster_is_circle?!0:!1,RES.getResByUrl("resource/cfg/scene_monster/"+t.id+".json",function(t){if(t&&GameLogic.ins().isMainScene()&&0==e.cur_wave_id){var i=t;e.scene_monster=i;for(var n=0;n<i.monster_coordinate.length;n++)e.monster_list[n]=i.monster_coordinate[n];e.checkNext(),GameMap.centerEntity&&(UtilProxy.isOpenWelcome()||GameMap.centerEntity.AI.start())}},this,RES.ResourceItem.TYPE_JSON)},e.prototype.onMonsterDie=function(t,e,i){this.cur_monster_num=this.cur_monster_num-1,this.CreateMonsterDrop(e,i),0==this.cur_monster_num?(this.is_all_monster_die=!0,1==this.scene_data.scene_type&&(GameLogic.ins().ClearMapPickItem(),TaskProxy.ins().C2SReqTaskEndKillMonster(this.scene_data.id,this.cur_wave_id),this.data&&LyhProxy.ins().updateNum(this.data[4]||0,this.scene_monster.Demon_value)),EventProxy.Broast(EventType.LyhUpdateMonster,{}),this.checkNext()):this.is_all_monster_die=!1},e.prototype.checkNext=function(){if(!this.pause){this.is_all_monster_die=!1,this.cur_wave_id=this.cur_wave_id+1;var t;if(void 0==this.monster_list[this.cur_wave_id-1]){if(!this.isCircle)return;t=this.monster_list[0],this.cur_wave_id=1}else t=this.monster_list[this.cur_wave_id-1];this.cur_monster_num=t[4];for(var e=Math.floor(64*t[1]/100),i=Math.floor(64*t[2]/100),n=Math.floor(64*t[3]/100),o=MathUtils.getPoint(n,e,i,t[4]-1),s=0;s<t[4];s++)if(0==s)GameLogic.ins().createMonstersClient(t[0],e,i);else{var r=o[s-1].x,a=o[s-1].y,h=this.getPointCanMove(r,a,30);GameLogic.ins().createMonstersClient(t[0],h.x,h.y)}t.wave_reward>0&&TaskProxy.ins().C2SReqTaskStartKillMonster(this.scene_data.id,this.cur_wave_id),this.data=t}},e.prototype.UpdateReward=function(t){if(this.drop_list=[],0!=t.items.length){var e=this.monster_list[this.cur_wave_id-1];if(e)for(var i=0;i<t.items.length;i++){var n=new DropItem;n.id=t.items[i].item_id,n.num=t.items[i].item_num,i<e[4]?(this.drop_list[i]=[],this.drop_list[i].push(n)):this.drop_list[this.drop_list.length-1].push(n)}}},e.prototype.getPointCanMove=function(t,e,i){var n=0,o=i,s=new egret.Point;for(s.x=t,s.y=e;100>n;){var r=MathUtils.limit(t-o>>0,t+o>>0),a=MathUtils.limit(e-o>>0,e+o>>0);if(GameMap.ins().checkWalkableByPixel(r,a)){s.x=r,s.y=a;break}n++}return s},e.prototype.CreateMonsterDrop=function(t,e){if(1==this.scene_data.scene_type&&this.monster_list[this.cur_wave_id-1]){var i=this.monster_list[this.cur_wave_id-1].monster_num-this.cur_monster_num;this.drop_list&&this.drop_list.length>0&&void 0!=this.drop_list[i-1]&&GameLogic.ins().doCreateDropGroup(t,e,this.drop_list[i-1])}},e.prototype.setPause=function(t){this.pause=t},e.prototype.moveEnd=function(t){},e.prototype.getCurWave=function(){return this.cur_wave_id},e.prototype.setCurWave=function(t){this.cur_wave_id=this.cur_wave_id+t},e.prototype.getNextPosCfg=function(){var t=this.monster_list[this.cur_wave_id];return GameMap.centerEntity.isMoveing()&&(t=this.monster_list[this.cur_wave_id-1]),t||(t=this.monster_list[0]),{x:t[1]/100*64,y:t[2]/100*64}},e.prototype.Destroy=function(){this.is_active=!1,EventProxy.RemoveListener(this,EventType.UpdateMonsterReward,this.UpdateReward),EventProxy.RemoveListener(this,EventType.HangMonsterDie,this.onMonsterDie),this.scene_data=null},e}(BaseClass);__reflect(HangManager.prototype,"HangManager");var MainScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayerAt(LayerManager.Game_Bg,1),this.addLayerAt(LayerManager.Game_Main,2),this.addLayer(LayerManager.UI_PreMain),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Main2),this.addLayer(LayerManager.UI_Popup),this.addLayer(LayerManager.UI_Tips),this.addLayer(LayerManager.UI_Guide),this.addLayer(LayerManager.UI_Open),GameMap.ins().addToParent(LayerManager.Game_Main),ViewManager.ins().open(MainUIView),ViewManager.ins().open(MainUIBottomView),SoundManager.ins().playBg("scene04_mp3")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(MainScene.prototype,"MainScene"),window.MainScene=MainScene;var GameApp=function(){function t(){this.onComplete()}return t.prototype.onComplete=function(){GlobalConfig.init();for(var t in GameSystem)GameSystem[t]();GameMap.ins().init(),SoundManager.ins().setEffectOn(!0),MsgHandle.ins().regModuleHandler(),LocationProperty.setLoadProgress(90,"(登录游戏中)"),SceneManager.ins().runScene(StartGameScene)},t.prototype.onProgress=function(t,e){LocationProperty.setLoadProgress(40+t/e*30,"(加载必要资源)")},t.postPerLoadProgress=function(t,e){return[t,e]},t.doPerLoadComplete=function(){this.postPerLoadComplete()},t.postPerLoadComplete=function(){},t.postLoginInit=function(){},t.is_resource_loaded=!1,t.is_zipcfg_loaded=!1,t.is_zipcfg_unzip=!1,t.is_loading_finish=!1,t.unzip_num=0,t.cfglist=[{key:"resource/cfg/config1_zz1.zip",val:"monster.json",ins:"MonstersConfig"},{key:"resource/cfg/config1_zz2.zip",val:"skill.json",ins:"SkillsConfig"},{key:"resource/cfg/config1_zz3.zip",val:"fuwen_base_data.json",ins:"fuwenBase"},{key:"resource/cfg/config1_zz4.zip",val:"learn_skill.json",ins:"LearnSkill"},{key:"resource/cfg/config1_zz5.zip",val:"tujian_data.json",ins:"Tujian_dataConfig"},{key:"resource/cfg/config1_zz6.zip",val:"copy_data.json",ins:"CopyDataConfig"},{key:"resource/cfg/config1_zz7.zip",val:"equipment.json",ins:"EquipmentConfig"},{key:"resource/cfg/config1_zz10.zip",val:"scene_data.json",ins:"SceneConfig"},{key:"resource/cfg/config1_zz10.zip",val:"lyh_copy.json",ins:"LyhConfig"},{key:"resource/cfg/config1_zz10.zip",val:"role_lvl_attr.json",ins:"role_lvl_attrConfig"}],t}();__reflect(GameApp.prototype,"GameApp"),MessageCenter.compile(GameApp);var SceneCtrlMainCity=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alive_num=0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.has_create_name_list={},TimerManager.ins().doTimer(1e3,0,this.checkInit,this)},e.prototype.update=function(){t.prototype.update.call(this)},e.prototype.destory=function(){t.prototype.destory.call(this),TimerManager.ins().removeAll(this)},e.prototype.getRobotCfg=function(t){var e,i=GlobalConfig.getMcRobotList();for(var n in i)if(e=i[n],e.id==t)break;return e},e.prototype.createRobot=function(){if(this.robot_cfg&&!(this.alive_num>=this.robot_cfg.count)){var t=this.getRank();if(t){this.alive_num+=1,this.updateCreateName(t.name,!0);var e=MathUtils.getRandom(0,this.robot_cfg.path_list.length-1),i=GlobalConfig.getMcRobotPathList(this.robot_cfg.path_list[e]),n=i.path[0],o=GameMap.ins().changePos(n[0]),s=GameMap.ins().changePos(n[1]),r={};r.scene_id=GameLogic.ins().getCurSceneId(),r.obj_id=EntityManager.ins().getHandleId(),r.role_id=t.role_id,r.zhuan=t.zhuan,r.level=t.level,r.team_id=0,r.server_id=RoleProxy.ins().getRoleServerId(),r.role_name=t.name,r.pos_x=o/GameMap.CELL_SIZE,r.pos_y=s/GameMap.CELL_SIZE,r.prof=t.prof,r.dir=Math.random()>.5?3:1;var a=[];a.push({type:AvatarType.ZUOQI,id:t.horse}),a.push({type:AvatarType.FASHION,id:t.fashion}),a.push({type:AvatarType.SHENBING,id:t.shenbing}),a.push({type:AvatarType.WING,id:t.wing}),a.push({type:AvatarType.PET,id:t.pet}),a.push({type:AvatarType.BELLE,id:t.belle}),r.speed=RoleProxy.ins().getFightAttr(FightAttr.SPEED),r.hp=RoleProxy.ins().getFightAttr(FightAttr.HP_MAX),r.max_hp=RoleProxy.ins().getFightAttr(FightAttr.HP_MAX),r.avatar_list=a;var h=GameLogic.ins().createRole(r);h.setAI(new AIMainCityRobot),h.AI instanceof AIMainCityRobot&&(h.AI.setPathList(i.path),h.AI.moveEnd=this.robotEnd,h.AI.moveObj=this),h.AI.start();var l=GlobalConfig.getReputation_dataConfig(t.reputation),p=t.faction,c=l.name[p-1]||l.name[0],u=TitleProxy.ins().getShengWanglvlName(t.reputation,p);void 0!=c&&h.setShengwang("C:6&["+u+"]"+c);var d=GlobalConfig.getTitleById(t.title);if(d&&h.setTitle(d.title_res),""!=t.marry_name){var g=UtilProxy.getStr("|C:8&@0 的伴侣|",[t.marry_name]);h.setBanglv(g)}}}},e.prototype.robotEnd=function(t){if(t){var e=t.name;0==e.indexOf("S"+RoleProxy.ins().getRoleServerId()+".")&&(e=e.replace("S"+RoleProxy.ins().getRoleServerId()+".","")),this.updateCreateName(e,!1),this.alive_num-=1,GameLogic.ins().doRemoveEntity(t.handle)}},e.prototype.getRank=function(){for(var t=MathUtils.getRandom(0,this.rank_list.length-1),e=(this.rank_list[t],0);e<this.rank_list.length;e++){var i=this.rank_list[e];if(!this.has_create_name_list[i.name]&&i.name!=RoleProxy.ins().getRoleName())return i}},e.prototype.checkInit=function(){this.open_server_day=LimitActProxy.ins().GetServerOpenDay(),this.open_server_day<=0||(this.rank_list&&0!=this.rank_list.length||(this.rank_list=RankProxy.ins().getTotleRanklistByType(2)),this.rank_list&&0!=this.rank_list.length&&(this.rank_list.sort(function(t,e){return t.role_id-e.role_id}),TimerManager.ins().remove(this.checkInit,this),this.robot_cfg=this.getRobotCfg(this.open_server_day),this.robot_cfg&&TimerManager.ins().doTimer(1e3*this.robot_cfg.refresh_time,0,this.createRobot,this)))},e.prototype.updateCreateName=function(t,e){this.has_create_name_list||(this.has_create_name_list={}),this.has_create_name_list[t]=e},e}(SceneCtrl);__reflect(SceneCtrlMainCity.prototype,"SceneCtrlMainCity");var VirtualServer=function(t){function e(){var e=t.call(this)||this;return e.handleCounter=0,e.aliveTimes=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],e.buffs=[],e.prevIndex=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getHandle=function(){return this.handleCounter>e.MAX_HANDLE&&(this.handleCounter=0),++this.handleCounter},e.prototype.sendUseSkill=function(t,e,i,n){void 0===n&&(n=!1);var o=i.skillConfig,s=GameLogic.ins().getEntityByHandle(t),r=GameLogic.ins().getEntityByHandle(e);if(s&&r&&!r.isDead()){var a=egret.getQualifiedClassName(SkillDamageData),h=(ObjectPool.pop(a),GlobalConfig.getSkillDescById(Math.floor(o.id/1e4)));if(h.target_type==TargetType.Enemy){var l=[],p=1!=GameLogic.ins().getCurSceneData().client_create_monster;if(2e6==i.skillConfig.id);var c=GameLogic.ins().getEnemysByAI(s.AI),u=GlobalConfig.getSkillDescById(Math.floor(i.skillConfig.id/1e4)),d=u.range_x,g=u.range_y;switch(u.target_way){case 1:l=GameLogic.ins().getEnemenysInRang(s,c,d,g,u.attack_num);break;case 2:l=GameLogic.ins().getRectEnemenys(s,r,g,d,c,u.attack_num);break;case 3:var y=u.range_x,f=u.range_y;l=GameLogic.ins().getFanshapedEnemenys(s,r,y,f,c,u.attack_num);break;case 4:var _=u.range_y;l=GameLogic.ins().getRoundEnemenys(s,_,u.attack_num)}if(p&&!n&&l.length>0){var v=(GameLogic.ins().getEntityByHandle(t),SkillProxy.ins().getSkillIndexById(i.skillId)),m=l[0].x,C=l[0].y,S=s.x,w=s.y,x=1,T=[];if(1==u.target_way)for(var b=0;b<l.length;b++)T.push(l[b].handle);else T.push(l[0].handle);SceneControl.ins().C2SPerformSkill(v,m,C,S,w,x,l[0].handle),SceneControl.ins().C2SSkillAttack(v,m,C,S,w,T)}else this.doSkill(s,r,l,o)}}},e.prototype.doSkill=function(t,e,i,n){for(var o=[],s=0;s<i.length;s++){var r=ObjectPool.pop(egret.getQualifiedClassName(SkillHurtInfo));o[s]=r}var a=egret.getQualifiedClassName(SkillDamageData),h=ObjectPool.pop(a);h.parserClient(t,e,i,n,o),SkillCC.ins().doSkillResultByData(h);for(var s=0;s<i.length;s++){var l=i[s],r=o[s];l.setProp(FightAttr.HP,Math.max(l.getHP()-r.value-r.xlHp,0)),t.setProp(FightAttr.HP,t.getHP()+r.suckHp+r.petSuckHp);var p=l.getHP();if(0>=p){if(l instanceof EntityMonsterClient){var c=l;EventProxy.Broast(EventType.HangMonsterDie,[l.handle,l.x,l.y]),TaskProxy.ins().KillChange(c.getConfig().id)}t instanceof EntityYezhan&&YezhanProxy.ins().checkResult(l.handle),l instanceof EntityYezhan&&YezhanProxy.ins().checkResult(l.handle),l.handle==GameMap.centerEntity.handle&&GameLogic.ins().isClientCreate()&&l.alive(),GameLogic.ins().doEntityDie1(l,t)}else if(l instanceof EntityMonsterClient&&!l.isDead()&&!r.miss&&!r.gedan){var u=DirUtil.get8DirBy2Point(l,t),d=DirUtil.getGridByDir(u,.1,l),g=100;GameLogic.ins().atkedTarget(l.handle,d.x,d.y,g,t.handle)}r.reset(),ObjectPool.push(r)}},e.prototype.getValue=function(t,e){return t[e]?t[e]:0},e.prototype.restart=function(){this.stop(),this.startRefreshMonster(),this.startCheckAlive(),this.startBuff()},e.prototype.stop=function(){TimerManager.ins().remove(this.creatMonster,this),TimerManager.ins().remove(this.checkRoleAlive,this),TimerManager.ins().remove(this.checkBuff,this)},e.prototype.startCheckAlive=function(){for(var t=0;t<this.aliveTimes.length;t++)this.aliveTimes[t]=Number.MAX_VALUE;TimerManager.ins().doTimer(5e3,0,this.checkRoleAlive,this)},e.prototype.checkRoleAlive=function(){for(var t=GameLogic.ins().getMyEntitys(),e=0,i=t;e<i.length;e++){var n=i[e];n.isDead()&&TimerManager.ins().getCurrTime()>this.aliveTimes[n.index]&&(n.AI.startAlive(),this.aliveTimes[n.index]=Number.MAX_VALUE)}},e.prototype.startBuff=function(){},e.prototype.checkBuff=function(){},e.prototype.startRefreshMonster=function(){},e.prototype.creatMonster=function(){},e.MAX_HANDLE=1e5,e}(BaseClass);__reflect(VirtualServer.prototype,"VirtualServer");var CalcType;!function(t){t[t.NoDamage=1]="NoDamage",t[t.Enemy=2]="Enemy",t[t.Self=3]="Self"}(CalcType||(CalcType={}));var Damage=function(){function t(){this.damageType=0,this.value=0,this.suckHp=0,this.xlHp=0,this.senderHandle=0,this.targetHandle=0}return t.prototype.reset=function(){this.damageType=0,this.value=0,this.suckHp=0,this.xlHp=0,this.senderHandle=0,this.targetHandle=0,this.skillId=0},t}();__reflect(Damage.prototype,"Damage");var Actor=function(){function t(){}return t.parser=function(t){this.handle=t.readDouble(),this.actorID=t.readInt(),GameServer.serverID=t.readInt(),this.setName(t.readUTFBytes(33)),this.setLevel(t.readInt()),this.setExp(t.readInt()),this.setPower(t.readDouble()),this.setGold(t.readNumber()),this.setYB(t.readNumber()),this.soul=t.readNumber(),this.setFeats(t.readNumber()),this.setStarsoul(t.readInt()),this.setzslv(t.readInt())},t.setzslv=function(t){this.zslv=t},t.setName=function(e){t.myName!=e&&(t.myName=e)},t.setGold=function(t){var e=0;return this.gold!=t&&(this.gold>0&&(e=t-this.gold),this.gold=1e10),e},t.setYB=function(t){var e=0;return this.yb!=t&&(this.yb>0&&(e=t-this.yb),this.yb=1e10),e},t.setFeats=function(t){if(this.feats!=t){if(this.feats>0){var e=t-this.feats,i=parseInt(e.toString());if(i>0){var n="|C:0xffb02d&T:获得"+i+"功勋|";TipsControl.ins().showTips(n)}}this.feats=t}},t.setStarsoul=function(t){var e=0;if(this.starsoul!=t){if(this.starsoul>0){var i=t-this.starsoul;e=parseInt(i.toString())}this.starsoul=t}return e},t.setLevel=function(t){this.level=t},t.setExp=function(t){this.exp!=t&&(this.exp=t)},t.setPower=function(t){this.power!=t&&(this.power<t&&this.power>0&&TipsControl.ins().showBoostPower(t,this.power),this.power=t)},t.canZhuanSheng=function(){return this.level>=this.zhuanShengLv},t.updateFightAttr=function(t,e){},t.updateMoneyAttr=function(t,e){},t.zhuanShengLv=80,t.power=0,t.gold=0,t.yb=0,t.feats=0,t.starsoul=0,t.zslv=0,t.outboardExp=0,t}();__reflect(Actor.prototype,"Actor");var EntityArena=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(EntityRole);__reflect(EntityArena.prototype,"EntityArena");var EntityBuff=function(){function t(){}return t}();__reflect(EntityBuff.prototype,"EntityBuff");var EntityDropItem=function(t){function e(){var e=t.call(this)||this;return e.pickerHandle=0,e.hasPicked=!1,e.touchEnabled=!1,e.touchChildren=!1,e.movieContainer=new eui.Group,e.addChild(e.movieContainer),e.movieContainer.horizontalCenter=0,e.labelName=new eui.Label,e.labelName.fontFamily="黑体",e.labelName.stroke=1,e.labelName.strokeColor=0,e.labelName.size=16,e.labelName.y=-41,e.labelName.horizontalCenter=0,e.labelName.textAlign="center",e.imgItem=new eui.Image,e.imgItem.x=0,e.imgItem.y=-30,e.imgItem.scaleX=e.imgItem.scaleY=.6,e.imgItem.horizontalCenter=0,e.movieContainer.addChild(e.imgItem),e.movieContainer.addChild(e.labelName),e}return __extends(e,t),e.prototype.parser=function(t){},e.prototype.setData=function(t){this.item=t;var e=t.id.toString().substr(0,1).trim();if(t.id>=1e4&&("1"==e||"2"==e)){var i=GlobalConfig.getEquipmentConfig(t.id);this.labelName.text=i.name,this.labelName.textColor=GameConst.QUALITY_COLOR[i.quality-1],this.imgItem.source=AssetMgr.getIconResource(i.displayid)}else{var i=GlobalConfig.getItemsConfig(t.id);this.labelName.text=i.name,this.labelName.textColor=GameConst.QUALITY_COLOR[i.quality-1],this.imgItem.source=AssetMgr.getIconResource(i.displayid)}this.labelName.x=-this.labelName.textWidth>>1},e.prototype.playDropMovie=function(){var t=16,e=this.movieContainer.y-t/2,i=this.movieContainer.y-t,n=this.movieContainer.y,o=egret.Tween.get(this.movieContainer);o.to({y:e},120).to({y:i},120).to({y:n},200)},e.prototype.reset=function(){this.item=null,this.hasPicked=!1,this.labelName.text="",this.imgItem.source=null,this.imgItem.x=-30,this.imgItem.y=-30,this.pickerHandle=0,egret.Tween.removeTweens(this.movieContainer)},e}(egret.DisplayObjectContainer);__reflect(EntityDropItem.prototype,"EntityDropItem");var ObjectPool=function(){function t(){this._objs=[]}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t._content[e]||(t._content[e]=[]);var o=t._content[e];if(o.length){var s=o.pop();return s}var r=egret.getDefinitionByName(e),a=(i.length,void 0);return a=new(r.bind.apply(r,[void 0].concat(i))),a.ObjectPoolKey=e,a},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var n,o=t._content[e];if(o.length)for(var s=0;s<o.length;s++)if(o[s].extraKey==i){n=o[s],o.splice(s,1);break}if(!n){var r=egret.getDefinitionByName(e);n=new r(i),n.extraKey=i,n.ObjectPoolKey=e}return n},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey;return!i||!t._content[i]||t._content[i].indexOf(e)>-1?!1:t._content[i].length<20?(t._content[i].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var n=t._content[e];n&&n.length;){var o=n.pop();i&&o[i](),o=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var n=t._content[e];if(null!=n){var o=0,s=n.length;for(o;s>o;o++)n[o][i]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var EntityMonsterClient=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(EntityMonster);__reflect(EntityMonsterClient.prototype,"EntityMonsterClient");var RenderTextureManager=function(t){function e(){var e=t.call(this)||this;return e._pool=[],e._useNum=0,e.isLowerQQBrowser()?e._maxNum=18:e._maxNum=-1,e}return __extends(e,t),e.prototype.isLowerQQBrowser=function(){if(DeviceUtils.IsQQBrowser){for(var t=["2013022","Lenovo A630t","SM-G3818","vivo X3t","GT-I9100"],e=!1,i=0,n=t.length;n>i;i++)if(-1!=navigator.userAgent.indexOf(t[i])){e=!0;break}return e}return!1},e.prototype.pop=function(){var t=this._pool.pop();return t||(-1==this._maxNum||this._useNum<this._maxNum)&&(t=new egret.RenderTexture,this._useNum++),t},e.prototype.push=function(t){for(var e=!1,i=0,n=this._pool.length;n>i;i++)if(this._pool[i]==t){e=!0;break}e||this._pool.push(t)},e}(BaseClass);__reflect(RenderTextureManager.prototype,"RenderTextureManager");var EntityNPC=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(EntityMU);__reflect(EntityNPC.prototype,"EntityNPC");var EntityOther=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.canBeAtk=function(){return!1},e}(EntityMonster);__reflect(EntityOther.prototype,"EntityOther");var EntityPartner=function(t){function e(){var e=t.call(this)||this;return e.setHpAndNameVisible(!0),e._hpBar.visible=!1,e._nameTxt.height=64,e.touchEnabled=!0,e.touchChildren=!0,e}return __extends(e,t),e.prototype.setConfig=function(t){this.data=t,this.property[FightAttr.SPEED]=192,this.setName(t.name),this.readyUpdateMC()},e.prototype.getBodyFileName=function(){if(this.data){var t=GlobalConfig.getCharResConfigById(this.data.model_id);if(t){var e=t.body_res;return AssetMgr.getPartnerBodySource(e,this.dir,this.action)}CommonUtils.log("外观表没有id:",this.data.model_id)}return""},e.prototype.destruct=function(){t.prototype.destruct.call(this)},e}(EntityMU);__reflect(EntityPartner.prototype,"EntityPartner");var EntityPet=function(t){function e(){var e=t.call(this)||this;return e.setHpAndNameVisible(!0),e._nameTxt.height=30,e._hpBar.visible=!1,e.touchEnabled=!0,e.touchChildren=!0,e}return __extends(e,t),e.prototype.setConfig=function(t){this.data=t,this.property[FightAttr.SPEED]=192,this.setName(t.name),this.readyUpdateMC()},e.prototype.getBodyFileName=function(){if(this.data){var t=GlobalConfig.getCharResConfigById(this.data.model_id);if(t){var e=t.body_res;return AssetMgr.getPetBodySource(e,this.dir,this.action)}CommonUtils.log("外观表没有id:",this.data.model_id)}return""},e.prototype.destruct=function(){t.prototype.destruct.call(this)},e}(EntityMU);__reflect(EntityPet.prototype,"EntityPet");var EntityPlayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(EntityRole);__reflect(EntityPlayer.prototype,"EntityPlayer");var EntityRobot=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setConfig=function(t){this.config=t},e.prototype.getConfig=function(){return this.config},e}(EntityRole);__reflect(EntityRobot.prototype,"EntityRobot");var ResVersionManager=function(t){function e(){var e=t.call(this)||this;return e.resVersionData=[],e.res_loadByVersion(),e.resVersionData=window.verData,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.has=function(t){return this.resVersionData.hasOwnProperty(t)},e.prototype.getDir=function(t){return 255&this.resVersionData[t]},e.prototype.getVer=function(t){return this.resVersionData[t]||Math.floor(1e7*Math.random())},e.prototype.hasVer=function(){return!0},e.prototype.isInCheck=function(){return!1},e.prototype.res_loadByVersion=function(){RES.getVirtualUrl=function(t){var i=e.ins();if(DeviceUtils.IsWx){var n=t;return-1==t.indexOf(RES_ROOT[SdkType.WeiXin-1])&&(t=RES_ROOT[SdkType.WeiXin-1]+SdkManager.ins().wx_ver+"/"+t),-1!=t.indexOf("resource/default.res.json")||-1!=t.indexOf("resource/resource_version.json")?t+"?v="+Math.floor(1e9*Math.random()):t+"?v="+i.getVer(n)}if(DeviceUtils.IsQQ){var n=t;return-1==t.indexOf(RES_ROOT[SdkType.QQ-1])&&(t=RES_ROOT[SdkType.QQ-1]+SdkManager.ins().wx_ver+"/"+t),-1!=t.indexOf("resource/default.res.json")||-1!=t.indexOf("resource/resource_version.json")?t+"?v="+Math.floor(1e9*Math.random()):t+"?v="+i.getVer(n)}return-1!=t.indexOf("default.thm.json")&&-1==t.indexOf("resource")&&(t="resource/"+t),i.hasVer()?SdkManager.ins().sdktype==SdkType.WJSDK?window.fsSdkObj.cdnUrl+t+"?v="+i.getVer(t):SdkManager.ins().sdktype==SdkType.Quick||SdkManager.ins().sdktype==SdkType.CSJSDK?SdkManager.ins().cdnUrl+t+"?v="+i.getVer(t):t+"?v="+i.getVer(t):SdkManager.ins().sdktype==SdkType.WJSDK?window.fsSdkObj.cdnUrl+t+"?v=2000":SdkManager.ins().sdktype==SdkType.Quick||SdkManager.ins().sdktype==SdkType.CSJSDK?SdkManager.ins().cdnUrl+t+"?v=2000":t+"?v=2000"}},e.prototype.loadConfig=function(t,e){if(this.complateFunc=t,this.complateFuncTarget=e,this.hasVer()){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT;var n=function(t){switch(t.type){case egret.Event.COMPLETE:var e=t.currentTarget,i=e.response,n=JSON.parse(i);this.resVersionData=n,this.complateFunc.call(this.complateFuncTarget);break;case egret.IOErrorEvent.IO_ERROR:CommonUtils.log("respHandler io error")}};i.once(egret.Event.COMPLETE,n,this),i.once(egret.IOErrorEvent.IO_ERROR,n,this);var o="";o=SdkManager.ins().sdktype==SdkType.WeiXin||SdkManager.ins().sdktype==SdkType.QQ?RES_ROOT[SdkManager.ins().sdktype-1]+SdkManager.ins().wx_ver+"/resource/resource_version.json":SdkManager.ins().sdktype==SdkType.HUOSDK?RES_ROOT[SdkType.WeiXin-1]+SdkManager.ins().wx_ver+"/resource/resource_version.json":SdkManager.ins().sdktype==SdkType.None?"resource/resource_version.json":SdkManager.ins().sdktype==SdkType.WJSDK?window.fsSdkObj.cdnUrl+"resource/resource_version.json":SdkManager.ins().sdktype==SdkType.Quick||SdkManager.ins().sdktype==SdkType.CSJSDK?SdkManager.ins().cdnUrl+"resource/resource_version.json":RES_ROOT[SdkManager.ins().sdktype-1]+"/resource/resource_version.json";var s=o+"?"+Math.floor(1e9*Math.random());return i.open(s,egret.HttpMethod.GET),i.send(),void CommonUtils.log("请求版本号信息:",s)}this.complateFunc.call(this.complateFuncTarget)},e}(BaseClass);__reflect(ResVersionManager.prototype,"ResVersionManager");var EntityVo=function(){function t(){this.xiuxian_level=0,this.xiuwei=0}return t.prototype.getClothRes=function(){if(this.cloth_id>0&&!ResVersionManager.ins().isInCheck()){var t=GlobalConfig.getFashion_id_dataConfig(this.cloth_id);if(t){var e=t.model[this.sex-1],i=GlobalConfig.getCharResConfigById(e);if(i)return i.body_res}}else{var e=1==this.sex?101:201,i=GlobalConfig.getCharResConfigById(e);if(i)return i.body_res}return 1==this.sex?"body101":"body201"},t.prototype.getWingRes=function(){if(this.wing_id>0){var t=GlobalConfig.getWingResById(this.wing_id);if(t){var e=t.model_id,i=GlobalConfig.getCharResConfigById(e);if(i)return i.body_res}}return""},t.prototype.getWeaponRes=function(){if(this.weapon_id>0){var t=GlobalConfig.getWeaponResById(this.weapon_id);if(t){var e=t.model_id,i=GlobalConfig.getCharResConfigById(e);if(i)return i.body_res}}return"shenbing10000"},t.prototype.getMountRes=function(){if(this.mount_id>0){var t=GlobalConfig.getHorseGradeShowConfig(this.mount_id);if(t||(t=GlobalConfig.getHorse_skin_ex_dataConfig(this.mount_id)?GlobalConfig.getHorse_skin_ex_dataConfig(this.mount_id):null),t){var e=t.model_id,i=GlobalConfig.getCharResConfigById(e);if(i)return this.mount_char=i,i.body_res}}return"zuoqi10001"},t.prototype.getMountDirList=function(){return this.mount_char?this.mount_char.dir:[]},t}();__reflect(EntityVo.prototype,"EntityVo");var EntityYezhan=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(EntityRole);__reflect(EntityYezhan.prototype,"EntityYezhan");var GodEquipItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowRed(!1),this.ShowAddPic(!1)},e.prototype.setSkinName=function(){this.skinName="GodEquipItemSkin"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.bg1.visible=!0,this.nameLab.visible=!1;var e=this.data;if(e&&(this.bg1.source=BagProxy.GODPART_Pic[(e.item_slot_idx-1)%10]),e&&e.itemConfig){var i=e.itemConfig;i&&(this.bg1.visible=!1,this.nameLab.visible=!0,i.part>=11&&i.part<=40?this.nameLab.text=UtilProxy.getStr("@0 阶",[i.god_order]):this.nameLab.text=GlobalFunc.getZhuanLevelLstr(i.requiredlevel,i.reborn))}},e.prototype.ShowAddPic=function(t){this.addpic.visible=t},e.prototype.SetNameLab=function(t){this.nameLab.visible=t},e}(ItemCell);__reflect(GodEquipItem.prototype,"GodEquipItem"),window.GodEquipItem=GodEquipItem;var GodEquipView=function(t){function e(){var e=t.call(this)||this;return e.needid=30084,e.curidx=0,e.pics=["shenzhuang_icon_hualong","shenzhuang_icon_fentian","shenzhuang_icon_shenzhu","shenzhuang_icon_cuiling"],e.namepics=["shenzhuang_font_hualong","shenzhuang_font_fentian","shenzhuang_font_shenzhu","shenzhuang_font_cuiling"],e.bgpics=["shenzhuang_bg_02","shenzhuang_bg_03","shenzhuang_bg_04","shenzhuang_bg_01"],e
}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodEquipSkin",this.title.textFlow=UtilProxy.generateTextFlow("C:10&神 装"),this.tips0.text="",this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.godlist.itemRenderer=GodEquipItem,this.reds=[this.red1,this.red2,this.red3,this.red4]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.godlist.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.shenzhu,this.onSysClick),this.addTouchEvent(this.taozhuan,this.onSysClick),this.addTouchEvent(this.fenjie,this.onSysClick),this.addTouchEvent(this.tips,this.onSysClick),this.addTouchEvent(this.iconpic,this.onSysClick),this.addTouchEvent(this.btn,this.onMakeClick),this.addTouchEvent(this.shenwen,this.onSysClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnsClick);EventProxy.AddListener(this,EventType.S2CRepGodequipMake,this.ShowEffect),EventProxy.AddListener(this,EventType.S2CRepGodequipForgeSuit,this.ShowGodEquipInfo),EventProxy.AddListener(this,EventType.S2CRepGodequipForge,this.ShowGodEquipInfo),EventProxy.AddListener(this,EventType.UpdateBodyEquip,this.ShowGodEquipInfo),EventProxy.AddListener(this,EventType.S2CRepGodequipSuit,this.ShowGodEquipInfo),EventProxy.AddListener(this,EventType.S2CRepGodequipSoulUpLevel,this.ShowGodEquipInfo),GodEquipProxy.ins().CurType=3,t[0]&&SystemOpenProxy.ins().isOpen(2,3300+t[0],!0)&&(GodEquipProxy.ins().CurType=t[0]),this.SetBtns(),this.ShowGodEquipInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.godlist.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.shenzhu,this.onSysClick),this.removeTouchEvent(this.taozhuan,this.onSysClick),this.removeTouchEvent(this.fenjie,this.onSysClick),this.removeTouchEvent(this.tips,this.onSysClick),this.removeTouchEvent(this.iconpic,this.onSysClick),this.removeTouchEvent(this.btn,this.onMakeClick),this.removeTouchEvent(this.shenwen,this.onSysClick),EventProxy.RemoveListener(this,EventType.S2CRepGodequipMake,this.ShowEffect),EventProxy.RemoveListener(this,EventType.S2CRepGodequipForgeSuit,this.ShowGodEquipInfo),EventProxy.RemoveListener(this,EventType.S2CRepGodequipForge,this.ShowGodEquipInfo),EventProxy.RemoveListener(this,EventType.UpdateBodyEquip,this.ShowGodEquipInfo),EventProxy.RemoveListener(this,EventType.S2CRepGodequipSuit,this.ShowGodEquipInfo),EventProxy.RemoveListener(this,EventType.S2CRepGodequipSoulUpLevel,this.ShowGodEquipInfo),this.curSelectItem=void 0},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnsClick=function(t){SystemOpenProxy.ins().isOpen(2,3300+this.btns.indexOf(t.currentTarget))&&(GodEquipProxy.ins().CurType=this.btns.indexOf(t.currentTarget),this.SetBtns(),this.curSelectItem=void 0,this.ShowGodEquipInfo())},e.prototype.onSysClick=function(t){switch(t.currentTarget){case this.shenzhu:ViewManager.ins().open(ShenzhuView,this.curSelectItem.data.item_slot_idx);break;case this.shenwen:ViewManager.ins().open(GodVeinsView);break;case this.taozhuan:ViewManager.ins().open(MasterTipsView,MasterType.GodEquip);break;case this.fenjie:ViewManager.ins().close(this),ViewManager.ins().open(MakeView,1);break;case this.tips:TipsControl.ins().ShowPathTips(this.needid);break;case this.iconpic:var e=new ItemCellData,i={item_slot_idx:0,item_type_id:this.needid,item_count:1};e.setItemCellData(i),ViewManager.ins().open(ItemTipsView,e)}},e.prototype.onMakeClick=function(t){var e=this.curSelectItem.data;if(void 0!=e){var i=GodEquipProxy.ins().getNextGodEquipId(e.item_type_id,e.item_slot_idx),n=GlobalConfig.getGod_make_dataConfig(i);if(void 0==n)return void TipsControl.ins().showTips("当前神装已达到最高");var o=BagProxy.ins().getItemCountById(n.items[0][0]);if(o<n.items[0][1])return void TipsControl.ins().showTips("合成材料不足");if(n.part>=41&&n.part<=50){var s=GlobalConfig.getEquipmentConfig(i);if(RoleProxy.ins().getRoleLv()<s.requiredlevel||RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)<s.reborn)return void TipsControl.ins().showTips(UtilProxy.getStr("需要达到@0 才能合成",[GlobalFunc.getZhuanLevelLstr(s.requiredlevel,s.reborn)]))}GodEquipProxy.ins().C2SReqGodequipMake(e.item_slot_idx,i)}},e.prototype.onListItemTap=function(t){var e=t.itemRenderer.data,i=BagProxy.ins().getDressIndexByPart(e.item_slot_idx);return i>0?void BagProxy.ins().C2SReqKnapsackArm(i,e.item_slot_idx):(void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),this.curSelectItem=t.itemRenderer,this.curidx=t.itemIndex,this.curSelectItem.ShowOnSelect(!0),void this.SetGodEquipInfo())},e.prototype.SetBtns=function(){GodEquipProxy.ins().IsShowReds[GodEquipProxy.ins().CurType]&&(GodEquipProxy.ins().IsShowReds[GodEquipProxy.ins().CurType]=!1,EventProxy.Broast(EventType.UpdateGodEquipRed,{}));for(var t=0;t<this.btns.length;t++)t!=GodEquipProxy.ins().CurType?this.btns[t].icon="common_btn_smell_yellow_off":this.btns[t].icon="common_btn_smell_yellow_on"},e.prototype.ShowEffect=function(){UtilProxy.GetMovieClipById(26,this.effect),UtilProxy.GetMovieClipById(24,this.effect),this.ShowGodEquipInfo()},e.prototype.ShowGodEquipInfo=function(){this.rank.text=GodEquipProxy.ins().getGodSuitId(GodEquipProxy.ins().CurType+1)+"阶";var t=BagProxy.ins().getGodEquipInfo(GodEquipProxy.ins().CurType);this.shenzhu.icon=this.pics[GodEquipProxy.ins().CurType],this.shezhupic.source=this.namepics[GodEquipProxy.ins().CurType],this.bg.source="resource/skins/GodEquip/"+this.bgpics[GodEquipProxy.ins().CurType]+".jpg",this.arraylist||(this.arraylist=new eui.ArrayCollection,this.godlist.dataProvider=this.arraylist),this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e]);this.godlist.validateNow(),void 0==this.curSelectItem?(this.curSelectItem=this.godlist.getVirtualElementAt(0),this.curidx=0):this.curSelectItem=this.godlist.getVirtualElementAt(this.curidx),this.curSelectItem.ShowOnSelect(!0);for(var i=0;i<t.length;i++){var n=this.godlist.getVirtualElementAt(i),o=n.data;n.ShowRed(GodEquipProxy.ins().getCurCanUp(o.item_slot_idx)||GodEquipProxy.ins().getCurCanShenzhu(o.item_slot_idx)||GodEquipProxy.ins().getCurCanShenwen(o.item_slot_idx));var s=BagProxy.ins().getDressIndexByPart(o.item_slot_idx);n.ShowAddPic(s>0&&o.item_type_id<=0)}for(var r=0,i=0;i<t.length;i++){var o=BagProxy.ins().getItemData(t[i].item_type_id);r=r+UtilProxy.GetAttrFight(o)+GodEquipProxy.ins().getGodForgeFight(t[i].item_slot_idx)+GodEquipProxy.ins().getGodSoulFight(t[i].item_slot_idx)}r=r+GodEquipProxy.ins().getGodSuitFight(GodEquipProxy.ins().CurType+1)+GodEquipProxy.ins().getGodForgeSuitFight(GodEquipProxy.ins().CurType+1),this.zhanValue.text=UtilProxy.getFightNumLab(r);for(var i=0;i<this.reds.length;i++)this.reds[i].visible=GodEquipProxy.ins().getCurTypeRed(i);this.godred.visible=GodEquipProxy.ins().getGodSuitRed(GodEquipProxy.ins().CurType),this.SetGodEquipInfo()},e.prototype.SetGodEquipInfo=function(){var t=this.curSelectItem.data;if(void 0!=t){this.suitred.visible=GodEquipProxy.ins().getCurCanShenzhu(t.item_slot_idx)||GodEquipProxy.ins().getGodForgeSuitRed(GodEquipProxy.ins().CurType),this.btnred.visible=GodEquipProxy.ins().getCurCanUp(t.item_slot_idx),this.shenwenred.visible=GodEquipProxy.ins().getCurCanShenwen(t.item_slot_idx);var e=new ItemCellData;e.item_type_id=GodEquipProxy.ins().getNextGodEquipId(t.item_type_id,t.item_slot_idx),e.itemConfig=BagProxy.ins().getItemData(e.item_type_id),this.partname.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[BagProxy.PART_NAME[t.item_slot_idx-1]]),this.curItem.data=0!=t.item_type_id?t:e,this.nextItem.data=e,this.nextgroup.visible=0!=t.item_type_id&&0!=e.item_type_id,this.curgroup.x=this.nextgroup.visible?120:195,this.curname.text="",this.nextname.text="已满阶",t.item_type_id>0?this.curname.text=t.itemConfig.name:this.curname.text=e.itemConfig.name,e.item_type_id>0&&(this.nextname.text=e.itemConfig.name);var i=GlobalConfig.getGod_make_dataConfig(e.item_type_id);this.needlab.text="0/0",i||(i=GlobalConfig.getGod_make_dataConfig(t.item_type_id)),this.needid=i.items[0][0];var n=BagProxy.ins().getItemCountById(this.needid);this.needlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[n>=i.items[0][1]?1:4,n,GlobalFunc.getCountStr(i.items[0][1])]);var o=BagProxy.ins().getItemData(this.needid);o&&(this.iconpic.source=AssetMgr.getIconResource(o.displayid),this.tips.textFlow=UtilProxy.StrFormart("|C:7&U&获得@0 |",[o.name]),0==e.item_type_id&&(this.needlab.text="已满级"));for(var s=AttrProxy.getContAttrInfo(BagProxy.ins().getItemData(t.item_type_id),BagProxy.ins().getItemData(e.item_type_id)),r="",a="",h=0;h<s.length;h++)""==r?(r=UtilProxy.getStr("@0  +@1 ",[s[h][0],0!=t.item_type_id?s[h][1]:s[h][2]]),a=UtilProxy.getStr("|C:7&+@0 |",[s[h][2]])):(r+=UtilProxy.getStr("\n@0  +@1 ",[s[h][0],0!=t.item_type_id?s[h][1]:s[h][2]]),a+=UtilProxy.getStr("\n|C:7&+@0 |",[s[h][2]]));this.curpro.textFlow=UtilProxy.generateTextFlow(r),this.nextpro.textFlow=UtilProxy.generateTextFlow(a)}},e}(BaseEuiView);__reflect(GodEquipView.prototype,"GodEquipView"),ViewManager.ins().reg(GodEquipView,LayerManager.UI_Main2),window.GodEquipView=GodEquipView;var GodVeinsView=function(t){function e(){var e=t.call(this)||this;return e.needid=0,e.needid0=0,e.curidx=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodVeinsSkin",this.title.textFlow=UtilProxy.generateTextFlow("C:10&神 纹"),this.godlist.itemRenderer=GodEquipItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.godlist.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.tips,this.onSysClick),this.addTouchEvent(this.tips0,this.onSysClick),this.addTouchEvent(this.iconpic,this.onSysClick),this.addTouchEvent(this.iconpic0,this.onSysClick),this.addTouchEvent(this.btn,this.onMakeClick),EventProxy.AddListener(this,EventType.S2CRepGodequipSoulUpLevel,this.ShowEffect),this.ShowGodEquipInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.godlist.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.tips,this.onSysClick),this.removeTouchEvent(this.tips0,this.onSysClick),this.removeTouchEvent(this.iconpic,this.onSysClick),this.removeTouchEvent(this.iconpic0,this.onSysClick),this.removeTouchEvent(this.btn,this.onMakeClick),EventProxy.RemoveListener(this,EventType.S2CRepGodequipSoulUpLevel,this.ShowEffect),this.curSelectItem=void 0},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSysClick=function(t){switch(t.currentTarget){case this.tips:TipsControl.ins().ShowPathTips(this.needid);break;case this.tips0:TipsControl.ins().ShowPathTips(this.needid0);break;case this.iconpic:var e=new ItemCellData,i={item_slot_idx:0,item_type_id:this.needid,item_count:1};e.setItemCellData(i),ViewManager.ins().open(ItemTipsView,e);break;case this.iconpic0:var n=new ItemCellData,o={item_slot_idx:0,item_type_id:this.needid0,item_count:1};n.setItemCellData(o),ViewManager.ins().open(ItemTipsView,n)}},e.prototype.onMakeClick=function(t){var e=this.curSelectItem.data;if(void 0!=e){var i=BagProxy.ins().getBodyEquipByPart(e.item_slot_idx);if(void 0==i||null==i)return void TipsControl.ins().showTips("需要穿戴神装");var n=GodEquipProxy.ins().getGodSoulLevelByPart(e.item_slot_idx)+1,o=GlobalConfig.getGod_soul_dataConfig(e.item_slot_idx)[n];if(void 0==o)return void TipsControl.ins().showTips("当前部位神纹已满级");for(var s=0;s<o.items.length;s++){var r=BagProxy.ins().getItemCountById(o.items[s][0]);if(r<o.items[s][1])return void TipsControl.ins().showTips("材料不足")}GodEquipProxy.ins().C2SReqGodequipSoulUpLevel(e.item_slot_idx)}},e.prototype.onListItemTap=function(t){t.itemRenderer.data;void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),this.curSelectItem=t.itemRenderer,this.curidx=t.itemIndex,this.curSelectItem.ShowOnSelect(!0),this.SetGodEquipInfo()},e.prototype.ShowEffect=function(){UtilProxy.GetMovieClipById(26,this.effect),UtilProxy.GetMovieClipById(24,this.effect),this.ShowGodEquipInfo()},e.prototype.ShowGodEquipInfo=function(){var t=BagProxy.ins().getGodEquipInfo(GodEquipProxy.ins().CurType);this.arraylist||(this.arraylist=new eui.ArrayCollection,this.godlist.dataProvider=this.arraylist),this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e]);this.godlist.validateNow(),void 0==this.curSelectItem?(this.curSelectItem=this.godlist.getVirtualElementAt(0),this.curidx=0):this.curSelectItem=this.godlist.getVirtualElementAt(this.curidx),this.curSelectItem.ShowOnSelect(!0);for(var i=0;i<t.length;i++){var n=this.godlist.getVirtualElementAt(i),o=n.data;n.ShowRed(GodEquipProxy.ins().getCurCanShenwen(o.item_slot_idx))}this.SetGodEquipInfo()},e.prototype.SetGodEquipInfo=function(){var t=this.curSelectItem.data;if(void 0!=t){this.zhanValue.text=UtilProxy.getFightNumLab(GodEquipProxy.ins().getGodSoulFight(t.item_slot_idx)),this.btnred.visible=GodEquipProxy.ins().getCurCanShenwen(t.item_slot_idx),this.curItem.data=t,this.bg1.visible=0==t.item_type_id,this.bg1.source=BagProxy.GODPART_Pic[(t.item_slot_idx-1)%10],this.curname.text="",t.item_type_id>0&&(this.curname.text=t.itemConfig.name);var e=GodEquipProxy.ins().getGodSoulLevelByPart(t.item_slot_idx),i=GlobalConfig.getGod_soul_dataConfig(t.item_slot_idx)[e],n=GlobalConfig.getGod_soul_dataConfig(t.item_slot_idx)[e+1];this.maxlab.visible=void 0==n||null==n,this.btn.visible=!this.maxlab.visible,this.levellab.textFlow=UtilProxy.StrFormart("|C:5&@0 阶神纹|",[e]),void 0==n||null==n?(this.needid=i.items[0][0],this.needid0=i.items[1][0],this.SetNeedLab(this.needlab,this.needid,0),this.SetNeedLab(this.needlab0,this.needid0,0),this.nextprolab.textFlow=UtilProxy.generateTextFlow("下级：|C:7&已满级|")):(this.needid=n.items[0][0],this.needid0=n.items[1][0],this.SetNeedLab(this.needlab,this.needid,n.items[0][1]),this.SetNeedLab(this.needlab0,this.needid0,n.items[1][1]),this.nextprolab.textFlow=UtilProxy.StrFormart("下级：|C:7&装备基础属性 +@0 %|",[n.attr_per])),this.curprolab.text=void 0==i?"当前：无":"当前：装备基础属性 +"+i.attr_per+"%",this.SetIconTips(this.needid,this.iconpic,this.tips),this.SetIconTips(this.needid0,this.iconpic0,this.tips0)}},e.prototype.SetNeedLab=function(t,e,i){var n=BagProxy.ins().getItemCountById(e);t.textFlow=UtilProxy.StrFormart("@0 (|C:@1 &@2 /@3 |)",[BagProxy.ins().getItemColorName(e),n>=i?1:4,n,GlobalFunc.getCountStr(i)]),0==i&&(t.textFlow=UtilProxy.StrFormart("@0 (|C:1&0/0|)",[BagProxy.ins().getItemColorName(e)]))},e.prototype.SetIconTips=function(t,e,i){var n=BagProxy.ins().getItemData(t);n&&(e.source=AssetMgr.getIconResource(n.displayid),i.textFlow=UtilProxy.StrFormart("|C:7&U&获得@0 |",[n.name]))},e}(BaseEuiView);__reflect(GodVeinsView.prototype,"GodVeinsView"),ViewManager.ins().reg(GodVeinsView,LayerManager.UI_Main2),window.GodVeinsView=GodVeinsView;var ShenzhuView=function(t){function e(){var e=t.call(this)||this;return e.needId=0,e.titlename=["化龙","焚天","神铸","淬灵"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShenZhuSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curpart=t[0],this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.suitbtn,this.onSuitBtnClick),this.addTouchEvent(this.icon,this.onIconClick),this.addTouchEvent(this.lastBtn,this.onchangeClick),this.addTouchEvent(this.nextBtn,this.onchangeClick),EventProxy.AddListener(this,EventType.S2CRepGodequipForgeSuit,this.ShowShenzhuInfo),EventProxy.AddListener(this,EventType.S2CRepGodequipForge,this.ShowShenzhuInfo),this.title.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[this.titlename[GodEquipProxy.ins().CurType]]),this.ShowShenzhuInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.suitbtn,this.onSuitBtnClick),this.removeTouchEvent(this.icon,this.onIconClick),this.removeTouchEvent(this.lastBtn,this.onchangeClick),this.removeTouchEvent(this.nextBtn,this.onchangeClick),EventProxy.RemoveListener(this,EventType.S2CRepGodequipForgeSuit,this.ShowShenzhuInfo),EventProxy.RemoveListener(this,EventType.S2CRepGodequipForge,this.ShowShenzhuInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onchangeClick=function(t){t.currentTarget==this.lastBtn?this.curpart>11+10*GodEquipProxy.ins().CurType&&(this.curpart=this.curpart-1):t.currentTarget==this.nextBtn&&this.curpart<20+10*GodEquipProxy.ins().CurType&&(this.curpart=this.curpart+1),this.ShowShenzhuInfo()},e.prototype.onIconClick=function(t){var e=new ItemCellData,i={item_slot_idx:0,item_type_id:this.needId,item_count:1};e.setItemCellData(i),ViewManager.ins().open(ItemTipsView,e)},e.prototype.onSuitBtnClick=function(t){ViewManager.ins().open(MasterTipsView,MasterType.GodForge)},e.prototype.onBtnClick=function(t){if(void 0!=this.curdata){var e=GodEquipProxy.ins().getGodForgeLevelByPart(this.curdata.item_slot_idx)+1,i=GlobalConfig.getGod_forge_dataConfig(this.curdata.item_slot_idx)[e];if(void 0==i)return void TipsControl.ins().showTips("当前"+this.titlename[GodEquipProxy.ins().CurType]+"已达到最高");if(i.god_suit_id>GodEquipProxy.ins().getGodSuitId(GodEquipProxy.ins().CurType+1))return void TipsControl.ins().showTips(UtilProxy.getStr("需要神装套装@0 阶",[i.god_suit_id]));var n=BagProxy.ins().getItemCountById(i.items[0]);return n<i.items[1]?void TipsControl.ins().showTips(this.titlename[GodEquipProxy.ins().CurType]+"材料不足"):void GodEquipProxy.ins().C2SReqGodequipForge(this.curdata.item_slot_idx)}},e.prototype.ShowShenzhuInfo=function(){this.lastBtn.visible=this.curpart!=11+10*GodEquipProxy.ins().CurType,this.nextBtn.visible=this.curpart!=20+10*GodEquipProxy.ins().CurType;var t=BagProxy.ins().getGodEquip(this.curpart);this.curdata=t,this.curitem.data=this.curdata,this.curitem.SetNameLab(!1),this.nameLab.text="",this.btnlv.text=GodEquipProxy.ins().getGodForgeSuitId(GodEquipProxy.ins().CurType+1)+"阶",this.curdata.item_type_id>0&&(this.nameLab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[10,this.curdata.itemConfig.name])),this.btnred.visible=GodEquipProxy.ins().getCurCanShenzhu(this.curdata.item_slot_idx),this.suitred.visible=GodEquipProxy.ins().getGodForgeSuitRed(GodEquipProxy.ins().CurType);var e=GodEquipProxy.ins().getGodForgeLevelByPart(this.curdata.item_slot_idx);this.lv.text=this.titlename[GodEquipProxy.ins().CurType]+"等级："+e;var i=GlobalConfig.getGod_forge_dataConfig(this.curdata.item_slot_idx)[e],n=GlobalConfig.getGod_forge_dataConfig(this.curdata.item_slot_idx)[e+1];if(this.needlab.text="0/0",n){this.needId=n.items[0];var o=BagProxy.ins().getItemData(n.items[0]);o&&(this.icon.source=AssetMgr.getIconResource(o.displayid));var s=BagProxy.ins().getItemCountById(n.items[0]);this.needlab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[s>=n.items[1]?1:4,s,GlobalFunc.getCountStr(n.items[1])])}this.zhanValue.text=UtilProxy.getFightNumLab(UtilProxy.GetAttrFight(i)+GodEquipProxy.ins().getGodForgeSuitFight(GodEquipProxy.ins().CurType+1));for(var r=AttrProxy.getContAttrInfo(i,n),a="",h="",l=0;l<r.length;l++)""==a?(a=UtilProxy.getStr("@0  +@1 ",[r[l][0],r[l][1]]),h=UtilProxy.getStr("|C:7&+@0 |",[r[l][2]])):(a+=UtilProxy.getStr("\n@0  +@1 ",[r[l][0],r[l][1]]),h+=UtilProxy.getStr("\n|C:7&+@0 |",[r[l][2]]));this.curpro.textFlow=UtilProxy.generateTextFlow(a),this.nextpro.textFlow=UtilProxy.generateTextFlow(h)},e}(BaseEuiView);__reflect(ShenzhuView.prototype,"ShenzhuView"),ViewManager.ins().reg(ShenzhuView,LayerManager.UI_Main2),window.ShenzhuView=ShenzhuView;var ZhulingTipsView=function(t){function e(){var e=t.call(this)||this;return e.curType=0,e.curshow=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZhulingTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepInjectsoulSwallow,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepInjectsoulSoulforgeSwallow,this.ShowInfo),this.curType=t[0],this.curshow=t[1]||0,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepInjectsoulSwallow,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepInjectsoulSoulforgeSwallow,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onBtnClick=function(t){var e=t.currentTarget==this.btn?0:1,i=GlobalConfig.getInjectsoul_swallow_itemsConfig(this.curType);if(1==this.curshow&&(i=GlobalConfig.getSoulforge_swallow_itemsConfig(this.curType)),void 0!=i){var n=ZhulingProxy.ins().getTSCountByType(this.curType),o=ZhulingProxy.ins().getCurMaxTSCountByType(this.curType);return 1==this.curshow&&(n=ZhuhunProxy.ins().getTSCountByType(this.curType),o=ZhuhunProxy.ins().getCurMaxTSCountByType(this.curType)),n>=o?void TipsControl.ins().showTips("吞噬已达到上限"):BagProxy.ins().getItemCountById(i.item_id)<=0?void TipsControl.ins().showTips("没有可吞噬的"+BagProxy.ins().getItemName(i.item_id)):void(1==this.curshow?ZhuhunProxy.ins().C2SReqInjectsoulSoulforgeSwallow(e,i.item_id):ZhulingProxy.ins().C2SReqInjectsoulSwallow(e,i.item_id))}},e.prototype.ShowInfo=function(){var t=GlobalConfig.getInjectsoul_swallow_itemsConfig(this.curType);1==this.curshow&&(t=GlobalConfig.getSoulforge_swallow_itemsConfig(this.curType));var e=BagProxy.ins().getItemData(t.item_id),i=new ItemCellData;i.item_type_id=t.item_id,i.itemConfig=e,this.item.data=i,this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[e.quality-1],e.name]),this.desc.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[e.TIPS]);var n=ZhulingProxy.ins().getTSCountByType(this.curType);1==this.curshow&&(n=ZhuhunProxy.ins().getTSCountByType(this.curType));var o="",s=AttrProxy.getAttrInfo(t,n);if(void 0!=s)for(var r=0;r<s.length;r++)""==o?o=UtilProxy.getStr("@0 |C:7&+@1 |",[s[r][0],s[r][1]]):o+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[s[r][0],s[r][1]]);this.pro.textFlow=UtilProxy.generateTextFlow(o),this.hascount.textFlow=UtilProxy.StrFormart("已拥有：@0 ",[BagProxy.ins().getItemCountById(t.item_id)]);var a=ZhulingProxy.ins().getCurMaxTSCountByType(this.curType);1==this.curshow&&(a=ZhuhunProxy.ins().getCurMaxTSCountByType(this.curType)),this.count.textFlow=UtilProxy.StrFormart("已吞噬：|C:@0 &@1 /@2 |",[a>n?7:4,n,a]);var h=ZhulingProxy.ins().getNextMaxTSLevelByType(this.curType);1==this.curshow&&(h=ZhuhunProxy.ins().getNextMaxTSLevelByType(this.curType)),this.tips.visible=this.tips.includeInLayout=0!=h,this.tips.textFlow=UtilProxy.StrFormart("|C:4&全身@0 等阶达到@1 阶可提高吞噬上限|",[1==this.curshow?"铸魂":"注灵",h])},e}(BaseEuiView);__reflect(ZhulingTipsView.prototype,"ZhulingTipsView"),ViewManager.ins().reg(ZhulingTipsView,LayerManager.UI_Main2),window.ZhulingTipsView=ZhulingTipsView;var GuideUIView=function(t){function e(){var e=t.call(this)||this;return e.per_offset=4,e.long_time=5e3,e.isAutoClick=!0,e.hidePos={x:1e6,y:1e6},e.touchEnabled=!1,e.skinName="GuideViewSkin",e.root.touchEnabled=!1,e.root.touchChildren=!1,e.resList=[e.res,e.res0,e.res1,e.res2],e.btn_bgList=[e.btn_bg,e.btn_bg0,e.btn_bg1,e.btn_bg2],e.arrowList=[e.arrow,e.arrow0,e.arrow1,e.arrow2],e.maskList=[e.maskL,e.maskR,e.maskT,e.maskB],StageUtils.ins().getUIStage().addEventListener(egret.Event.COMPLETE,e.onChangeStage,e),e.addTouchEvent(e.btn_jump,e.JumpClick),e.jumpG.visible=!1,e}return __extends(e,t),e.prototype.onChangeStage=function(t){if(this.target){var e=this.target.localToGlobal(0,0);this.root.x=e.x+this.target.width/2,this.root.y=e.y+this.target.height/2,CommonUtils.log("----GuideUIView----show--",e.x,e.y)}},e.prototype.initUI=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.show=function(t,e,i){this.target=t,this.data=e,this.cur_view=i,this.root.visible=!0;for(var n=void 0!=this.data,o=0;o<this.maskList.length;++o)this.maskList[o].visible=n;this.isAutoClick=!GuideProxy.ins().isOpenGuideTip(),this.jumpG.visible=n?!GuideProxy.ins().isOpenGuideTip():!1,TimerManager.ins().doTimer(500,0,this.Update,this),TimerManager.ins().doTimer(this.long_time,1,this.AutoClick,this),this.Update()},e.prototype.Hide=function(){TimerManager.ins().removeAll(this),this.root.visible=!1,StageUtils.ins().getUIStage().removeEventListener(egret.Event.COMPLETE,this.onChangeStage,this),this.effH.numChildren>0&&this.effH.removeChildren(),egret.Tween.removeTweens(this),this.tween=void 0;for(var t=0;t<this.maskList.length;++t)this.maskList[t].visible=!1;this.jumpG.visible=!1},e.prototype.AutoClick=function(){GuideProxy.ins().JumpCurrentData()},e.prototype.Update=function(){if(void 0!=this.target){0==this.effH.numChildren&&UtilProxy.GetMovieClipById(46,this.effH);var t=this.target.localToGlobal(0,0),e=(this.handG.width/2,this.handG.height/2,this.target.width/2),i=this.target.height/2;this.root.y=t.y+i,this.root.x=t.x+e;var n=StageUtils.ins().getStage();this.maskL.width=Math.max(t.x-this.per_offset,0),this.maskR.height=n.stageHeight,this.maskR.width=Math.max(n.stageWidth-(this.root.x+e)+this.per_offset,0),this.maskT.x=this.maskL.width,this.maskB.x=this.maskL.width,this.maskT.width=this.target.width+2*this.per_offset,this.maskB.width=this.target.width+2*this.per_offset,this.maskT.height=Math.max(t.y-this.per_offset,0),this.maskB.height=Math.max(n.stageHeight-(t.y+2*i)-this.per_offset,0);for(var o=this.data?this.data.btn_text:"点击",s=0;s<this.resList.length;++s)this.resList[s].text=o;for(var s=0;s<this.btn_bgList.length;++s)this.btn_bgList[s].width=20*o.length+20;var r=this.data?this.data.dir:1;this.arrowG.visible=4==r,this.arrowGL.visible=3==r,this.arrowGB.visible=2==r,this.arrowGT.visible=1==r,(1==r||2==r)&&(this.btn_bg0.x=this.arrow0.x-(20*o.length+20)/2+this.arrow0.width/2,this.btn_bg1.x=this.arrowGB.x-(20*o.length+20)/2+this.arrowGB.width/2,this.res0.x=this.arrow0.x-20*o.length/2+this.arrow0.width/2,this.res1.x=this.arrowGB.x-20*o.length/2+this.arrowGB.width/2),3==r&&(this.btn_bg2.x=this.arrow2.x-this.arrow.width-20*o.length-20,this.res2.x=this.arrow2.x-this.arrow.width-20*o.length-20+8),this.tween||(1==r?(this.arrowGT.y=-110,egret.Tween.get(this.arrowGT,{loop:!0}).to({y:-90},500).to({y:-110},500)):2==r?(this.arrowGB.y=50,egret.Tween.get(this.arrowGB,{loop:!0}).to({y:69},500).to({y:50},500)):3==r?(this.arrowGL.x=-260,egret.Tween.get(this.arrowGL,{loop:!0}).to({x:-280},500).to({x:-260},500)):4==r&&(this.arrowG.x=88,egret.Tween.get(this.arrowG,{loop:!0}).to({x:70},1e3).to({x:88},500))),CommonUtils.log("----GuideUIView----show--",t.x,t.y)}},e.prototype.JumpClick=function(t){GuideProxy.ins().JumpCurrentData()},e}(BaseEuiView);__reflect(GuideUIView.prototype,"GuideUIView"),ViewManager.ins().reg(GuideUIView,LayerManager.UI_Tips),window.GuideUIView=GuideUIView;var HuanHuaHorseItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HuanIconSkin",e.selectIcon.visible=!1,e.init(),e.red.visible=!1,e.addTouchEvent(e.icon,e.onclick),TimerManager.ins().doTimer(200,0,e.Update,e),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){var t=(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),this.data);if(void 0!=t&&void 0!=t.id){if(2==t.type){var e=t.config,i=GlobalConfig.getHorse_skin_ex_dataConfig(t.config.show_id);this.info.text=i.name,this.icon.source=i.icon}else if(1==t.type){var e=t.config;this.info.text=e.name,this.icon.source=e.icon}var n=HorseProxy.ins().isHuanxingActive(t.id),o=HorseProxy.ins().isHuanxingById(t.id),s=0;s=n?2:0,2==t.type?this.red.visible=HorseProxy.ins().getHuaxingEnoughById(t.id):this.red.visible=HorseProxy.ins().getHuaxingEnoughById(t.id),o&&(s=1),this.state_index=s,this.setState(s)}},e.prototype.onclick=function(t){switch(t.currentTarget){case this.icon:}},e.prototype.setState=function(t){this.state.visible=2!=t,0==t?this.state.source="huoban_icon_weijihuo":1==t?this.state.source="huoban_icon_shiyongzhong":2==t&&(this.state.source="huoban_pic_huanhuazhong")},e.prototype.Update=function(){this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e.prototype.RemoveUpdate=function(){TimerManager.ins().remove(this.Update,this)},e}(BaseItemRender);__reflect(HuanHuaHorseItem.prototype,"HuanHuaHorseItem"),window.HuanHuaHorseItem=HuanHuaHorseItem;var HuanHuaItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HuanIconSkin",e.selectIcon.visible=!1,e.init(),e.addTouchEvent(e.icon,e.onclick),e.red.visible=!1,TimerManager.ins().doTimer(200,0,e.Update,e),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){var t=(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),this.data);if(void 0!=t&&void 0!=t.id){this.info.text=t.config.name,this.icon.source=AssetMgr.getIconResource(t.config.icon);var e=HuobanProxy.ins().isHuanxingActive(t.id),i=HuobanProxy.ins().isHuanxingById(t.id),n=0;n=e?2:0,2==t.type?this.red.visible=HuobanProxy.ins().getHuaxingEnoughById(t.id):this.red.visible=!1,i&&(n=1),this.state_index=n,this.setState(n)}},e.prototype.onclick=function(t){switch(t.currentTarget){case this.icon:}},e.prototype.setState=function(t){this.state.visible=2!=t,0==t?this.state.source="huoban_icon_weijihuo":1==t?this.state.source="huoban_icon_shiyongzhong":2==t&&(this.state.source="huoban_pic_huanhuazhong")},e.prototype.Update=function(){this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e.prototype.RemoveUpdate=function(){TimerManager.ins().remove(this.Update,this)},e}(BaseItemRender);__reflect(HuanHuaItem.prototype,"HuanHuaItem"),window.HuanHuaItem=HuanHuaItem;var HuanHuaPetItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HuanIconSkin",e.selectIcon.visible=!1,e.red.visible=!1,e.init(),e.addTouchEvent(e.icon,e.onclick),TimerManager.ins().doTimer(200,0,e.Update,e),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){var t=(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),this.data);if(void 0!=t&&void 0!=t.id){if(2==t.type){var e=t.config,i=GlobalConfig.getPet_skin_ex_dataConfig(t.config.show_id);this.info.text=i.name,this.icon.source=i.icon}else if(1==t.type){var e=t.config;this.info.text=e.name,this.icon.source=e.icon}var n=PetProxy.ins().isHuanxingActive(t.id),o=PetProxy.ins().isHuanxingById(t.id),s=0;s=n?2:0,2==t.type?this.red.visible=PetProxy.ins().getHuaxingEnoughById(t.id):this.red.visible=HorseProxy.ins().getHuaxingEnoughById(t.id),o&&(s=1),this.state_index=s,this.setState(s)}},e.prototype.onclick=function(t){switch(t.currentTarget){case this.icon:}},e.prototype.setState=function(t){this.state.visible=2!=t,0==t?this.state.source="huoban_icon_weijihuo":1==t?this.state.source="huoban_icon_shiyongzhong":2==t&&(this.state.source="huoban_pic_huanhuazhong")},e.prototype.Update=function(){this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)
},e.prototype.RemoveUpdate=function(){TimerManager.ins().remove(this.Update,this)},e}(BaseItemRender);__reflect(HuanHuaPetItem.prototype,"HuanHuaPetItem"),window.HuanHuaPetItem=HuanHuaPetItem;var HuanxingItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HuanIconSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this),this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e.prototype.refresh=function(){var t=this.data;if(void 0!=t&&void 0!=t.id){RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL);this.info.text=t.configEx?t.configEx.name:t.config.name,this.icon.source=AssetMgr.getIconResource(t.configEx?t.configEx.icon:t.config.icon);var e=!1,i=!1;t.HuobanType==HuobanType.horse?(e=HorseProxy.ins().isHuanxingActive(t.id)||HorseProxy.ins().getHorseLimitLeftTime(t.id)>0,i=HorseProxy.ins().isHuanxingById(t.id)):t.HuobanType==HuobanType.mate?(e=HuobanProxy.ins().isHuanxingActive(t.id),i=HuobanProxy.ins().isHuanxingById(t.id)):t.HuobanType==HuobanType.pet&&(e=PetProxy.ins().isHuanxingActive(t.id),i=PetProxy.ins().isHuanxingById(t.id));var n=0;if(n=e?2:0,2==t.type){var o=!1;t.HuobanType==HuobanType.horse?o=HorseProxy.ins().getHuaxingEnoughById(t.id)||HorseProxy.ins().getHuaxingExtendEnoughById(t.id):t.HuobanType==HuobanType.mate?o=HuobanProxy.ins().getHuaxingEnoughById(t.id)||HuobanProxy.ins().getHuaxingExtendEnoughById(t.id):t.HuobanType==HuobanType.pet&&(o=PetProxy.ins().getHuaxingEnoughById(t.id)||HuobanProxy.ins().getHuaxingExtendEnoughById(t.id)),this.red.visible=o}else this.red.visible=!1;i&&(n=1),this.state_index=n,this.setState(n)}},e.prototype.setState=function(t){this.state.visible=2!=t,0==t?this.state.source="huoban_icon_weijihuo":1==t?this.state.source="huoban_icon_shiyongzhong":2==t&&(this.state.source="")},e}(BaseItemRender);__reflect(HuanxingItem.prototype,"HuanxingItem"),window.HuanxingItem=HuanxingItem;var HuobanBagView=function(t){function e(){var e=t.call(this)||this;return e.curType=1,e.typetList=[BagType.HORSE_EQUIP,BagType.BELLE_EQUIP,BagType.PET_EQUIP],e.curHuobanType=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="HuobanBagSkin",this.comview.initUI(),this.comview.SetName("title_beibao"),this.itemList.itemRenderer=BagItemEx,this.itemScroller.viewport=this.itemList,this.btns=[this.Btn_1,this.Btn_2,this.Btn_3];for(var e=0;e<this.btns.length;e++)this.btns[e].icon="commonAtlas_json.common_btn_smell_yellow_off"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addItemTapEvent(this.itemList,this.onListItemTap),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.setBagData),EventProxy.AddListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.smeltBtn,this.OnSmeltBtn);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onBtnClick);for(var i=0;i<this.typetList.length;i++)this.btns[i].getChildAt(2).visible=BagProxy.ins().GetRedByType(this.typetList[i]);void 0!=t&&void 0!=t[0]?this.ShowBagInfo(this.btns[t[0]]):this.ShowBagInfo(this.btns[0])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeItemTapEvent(this.itemList,this.onListItemTap),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.smeltBtn,this.OnSmeltBtn);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onBtnClick);EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.setBagData),EventProxy.RemoveListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){this.ShowBagInfo(t.currentTarget)},e.prototype.ShowBagInfo=function(t){switch(this.curbtn&&(this.curbtn.icon="commonAtlas_json.common_btn_smell_yellow_off"),t.icon="commonAtlas_json.common_btn_smell_yellow_on",this.curbtn=t,t){case this.Btn_1:this.curType=BagType.HORSE_EQUIP,this.curHuobanType=HuobanType.horse,this.setBagData();break;case this.Btn_2:this.curType=BagType.BELLE_EQUIP,this.curHuobanType=HuobanType.mate,this.setBagData();break;case this.Btn_3:this.curType=BagType.PET_EQUIP,this.curHuobanType=HuobanType.pet,this.setBagData()}},e.prototype.OnAddBtn=function(t){ViewManager.ins().close(this),ViewManager.ins().open(VIPView)},e.prototype.OnSmeltBtn=function(t){ViewManager.ins().close(this),ViewManager.ins().open(HuobanSmeltView,this.curHuobanType)},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&(void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),ViewManager.ins().open(HuobanEquipTipsView,e,!0),this.curSelectItem=t.itemRenderer,this.curSelectItem.ShowOnSelect(!0))},e.prototype.setBagData=function(){var t=BagProxy.ins().getBagInfo(this.curType);this.curbtn&&(this.curbtn.getChildAt(2).visible=BagProxy.ins().GetRedByType(this.curType)),this.arraylist1||(this.arraylist1=new eui.ArrayCollection,this.itemList.dataProvider=this.arraylist1),this.arraylist1.removeAll();for(var e in t)this.arraylist1.addItem(t[e]);this.SetCount()},e.prototype.RefreshMakeRed=function(t){},e.prototype.SetCount=function(){this.itemCount.text=BagProxy.ins().getBagInfoLenth(this.curType)+"/"+BagProxy.ins().bagcount[this.curType]},e}(BaseEuiView);__reflect(HuobanBagView.prototype,"HuobanBagView"),ViewManager.ins().reg(HuobanBagView,LayerManager.UI_Main),window.HuobanBagView=HuobanBagView;var HuobanEquipItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowRed(!1),this.ShowAddPic(!1)},e.prototype.setSkinName=function(){this.skinName="GodEquipItemSkin"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.bg1.visible=!0,this.nameLab.visible=!1;var e=this.data;e&&e.item_sub_type?this.bg1.source=BagProxy.ins().getHuobanEquipBgPic(e.item_sub_type,e.item_slot_idx):this.bg1.visible=!1},e.prototype.ShowAddPic=function(t){this.addpic.visible=t},e.prototype.SetNameLab=function(t){this.nameLab.visible=t},e}(ItemCell);__reflect(HuobanEquipItem.prototype,"HuobanEquipItem"),window.HuobanEquipItem=HuobanEquipItem;var HuoBanHXView=function(t){function e(){var e=t.call(this)||this;return e.HuoBanType=HuobanType.horse,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="HuobanHuanxingSkin",this.comview.initUI(),this.start_list=[this.star0,this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9],this.listH.itemRenderer=HuanxingItem,this.scrollerH.viewport=this.listH,this.listM.itemRenderer=ItemCell,this.scrollerM.viewport=this.listM,this.listH.dataProvider=new eui.ArrayCollection,this.listM.dataProvider=new eui.ArrayCollection,this.JuexingG.visible=!1,this.left_time_lab.text=""},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.lvItem.visible=!1,this.comview.open(),this.HuoBanType=t&&t[0]?t[0]+1:1,this.setHuanXing(),this.addItemTapEvent(this.listH,this.SkinItemClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.uBtn0,this.onUpClick),this.addTouchEvent(this.hBtn0,this.onShowClick),this.addTouchEvent(this.juexingBtn,this.onOpenJuexingClick),this.addTouchEvent(this.activeBtn,this.onActiveHClick),this.addTouchEvent(this.hClose,this.onCloseHClick),this.addTouchEvent(this.hbtn,this.onUpHClick),this.addTouchEvent(this.posBtn0,this.onPosClick),this.addTouchEvent(this.posBtn1,this.onPosClick),this.addTouchEvent(this.lvItem,this.onLvUpClick),EventProxy.AddListener(this,EventType.S2CRepPetActiveHuaxing,this.S2CRepActiveHuaxing),EventProxy.AddListener(this,EventType.S2CRepHorseActiveHuaxing,this.S2CRepActiveHuaxing),EventProxy.AddListener(this,EventType.S2CRepBelleActiveHuaxing,this.S2CRepActiveHuaxing),EventProxy.AddListener(this,EventType.S2CRepPetUpdateShow,this.S2CRepUpdateShow),EventProxy.AddListener(this,EventType.S2CRepHorseUpdateShow,this.S2CRepUpdateShow),EventProxy.AddListener(this,EventType.S2CRepBelleUpdateShow,this.S2CRepUpdateShow),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.setRed),EventProxy.AddListener(this,EventType.S2CRepHorseRemoveLimitSkin,this.S2CRepHorseRemoveLimitSkin)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeItemTapEvent(this.listH,this.SkinItemClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.uBtn0,this.onUpClick),this.removeTouchEvent(this.hBtn0,this.onShowClick),this.removeTouchEvent(this.juexingBtn,this.onOpenJuexingClick),this.removeTouchEvent(this.activeBtn,this.onActiveHClick),this.removeTouchEvent(this.hClose,this.onCloseHClick),this.removeTouchEvent(this.hbtn,this.onUpHClick),this.removeTouchEvent(this.lvItem,this.onLvUpClick),EventProxy.RemoveListener(this,EventType.S2CRepPetActiveHuaxing,this.S2CRepActiveHuaxing),EventProxy.RemoveListener(this,EventType.S2CRepHorseActiveHuaxing,this.S2CRepActiveHuaxing),EventProxy.RemoveListener(this,EventType.S2CRepBelleActiveHuaxing,this.S2CRepActiveHuaxing),EventProxy.RemoveListener(this,EventType.S2CRepPetUpdateShow,this.S2CRepUpdateShow),EventProxy.RemoveListener(this,EventType.S2CRepHorseUpdateShow,this.S2CRepUpdateShow),EventProxy.RemoveListener(this,EventType.S2CRepBelleUpdateShow,this.S2CRepUpdateShow),EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.setRed),EventProxy.RemoveListener(this,EventType.S2CRepHorseRemoveLimitSkin,this.S2CRepHorseRemoveLimitSkin)},e.prototype.S2CRepUpdateShow=function(t){this.refreshData()},e.prototype.S2CRepActiveHuaxing=function(t){this.refreshData(),this.JuexingG.visible&&this.setJuexing(!0)},e.prototype.S2CRepHorseRemoveLimitSkin=function(t){this.huanxing_list&&(this.listH.dataProvider=new eui.ArrayCollection(this.huanxing_list))},e.prototype.setRed=function(t){},e.prototype.refreshData=function(){for(var t=0;t<this.listH.numChildren;++t){var e=this.listH.getChildAt(t);void 0!=e&&e.refresh()}void 0!=this.lastSkinItem&&this.SetSkinData(this.lastSkinItem)},e.prototype.onLvUpClick=function(t){if(void 0!=this.lastSkinItem){var e=[LvUpType.emZuoqi,LvUpType.emXL,LvUpType.emCW];ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[e[this.HuoBanType-1],this.lastSkinItem.data.id])}},e.prototype.onUpClick=function(t){void 0!=this.lastSkinItem&&(this.HuoBanType==HuobanType.pet?PetProxy.ins().C2SReqPetSkinExtendUpgrade(this.lastSkinItem.data.id):this.HuoBanType==HuobanType.mate?HuobanProxy.ins().C2SReqBelleSkinExtendUpgrade(this.lastSkinItem.data.id):this.HuoBanType==HuobanType.horse&&HorseProxy.ins().C2SReqHorseSkinExtendUpgrade(this.lastSkinItem.data.id))},e.prototype.onShowClick=function(t){if(void 0!=this.lastSkinItem){if(this.HuoBanType==HuobanType.pet){if(PetProxy.ins().isHuanxingActive(this.lastSkinItem.data.id))return void PetProxy.ins().C2SReqPetChangeShow(this.lastSkinItem.data.type,this.lastSkinItem.data.id)}else if(this.HuoBanType==HuobanType.mate){if(HuobanProxy.ins().isHuanxingActive(this.lastSkinItem.data.id))return void HuobanProxy.ins().C2SReqBelleChangeShow(this.lastSkinItem.data.type,this.lastSkinItem.data.id)}else if(this.HuoBanType==HuobanType.horse&&HorseProxy.ins().isHuanxingActive(this.lastSkinItem.data.id))return void HorseProxy.ins().C2SReqHorseChangeShow(this.lastSkinItem.data.type,this.lastSkinItem.data.id);if(1==this.lastSkinItem.data.type)TipsControl.ins().showTips("请提升阶级！");else{if(1==this.lastSkinItem.data.config.is_limit&&HorseProxy.ins().getHorseLimitLeftTime(this.lastSkinItem.data.id)>0)return void HorseProxy.ins().C2SReqHorseChangeShow(this.lastSkinItem.data.type,this.lastSkinItem.data.id);TipsControl.ins().showTips("尚未激活！")}}},e.prototype.onUpHClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data.config,i=e.item[0][0],n=e.item[0][1];return BagProxy.ins().getItemCountById(i)<n?void TipsControl.ins().showTips("物品数量不足！"):void(this.HuoBanType==HuobanType.pet?PetProxy.ins().C2SReqPetActiveHuaxing(this.lastSkinItem.data.id):this.HuoBanType==HuobanType.mate?HuobanProxy.ins().C2SReqBelleActiveHuaxing(this.lastSkinItem.data.id):this.HuoBanType==HuobanType.horse&&HorseProxy.ins().C2SReqHorseActiveHuaxing(this.lastSkinItem.data.id))}},e.prototype.onCloseHClick=function(t){this.setJuexing(!1)},e.prototype.onOpenJuexingClick=function(t){this.setJuexing(!0)},e.prototype.onActiveHClick=function(t){if(void 0!=this.lastSkinItem){var e,i=this.lastSkinItem.data;if(i.HuobanType==HuobanType.horse?e=GlobalConfig.getHorse_skin_extend_dataConfig(i.id):i.HuobanType==HuobanType.mate?e=GlobalConfig.getMate_skin_extend_dataConfig(i.id):i.HuobanType==HuobanType.pet&&(e=GlobalConfig.getPet_skin_extend_dataConfig(i.id)),e){var n=e[1].item[0][0],o=e[1].item[0][1];return BagProxy.ins().getItemCountById(n)<o?void TipsControl.ins().showTips("物品数量不足！"):void(this.HuoBanType==HuobanType.pet?PetProxy.ins().C2SReqPetSkinExtendUpgrade(i.id):this.HuoBanType==HuobanType.mate?HuobanProxy.ins().C2SReqBelleSkinExtendUpgrade(i.id):this.HuoBanType==HuobanType.horse&&HorseProxy.ins().C2SReqHorseSkinExtendUpgrade(i.id))}}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setHuanXing=function(){var t,e,i=[];this.HuoBanType==HuobanType.pet?(this.comview.SetName(UtilProxy.getTitleName("灵宠")),t=GlobalConfig.getConfig("pet_grade_show","petGradeShowConfig"),e=GlobalConfig.getConfig("pet_skin_data","petSkinConfig")):this.HuoBanType==HuobanType.mate?(this.comview.SetName(UtilProxy.getTitleName("仙侣")),t=GlobalConfig.getConfig("mate_grade_show","mateGradeShowConfig"),e=GlobalConfig.getConfig("mate_skin_data","mateSkinConfig")):this.HuoBanType==HuobanType.horse&&(this.comview.SetName(UtilProxy.getTitleName("坐骑")),t=GlobalConfig.getConfig("horse_grade_show","horseGradeShowConfig"),e=GlobalConfig.getConfig("horse_skin_data","HorseSkinConfig"));for(var n in t){var o=new HuanxingData;o.setHuanxingData(this.HuoBanType,t[n].show_id,1),i.push(o)}var s=new Array;for(var n in e){var o=new HuanxingData;o.setHuanxingData(this.HuoBanType,Number(n),2),void 0==s[o.id]&&(s[o.id]=o.id,i.push(o))}this.HuoBanType==HuobanType.pet?i.sort(this.sortListByPet):this.HuoBanType==HuobanType.mate?i.sort(this.sortListByMate):this.HuoBanType==HuobanType.horse&&i.sort(this.sortListByHorse),this.huanxing_list=i,this.listH.dataProvider=new eui.ArrayCollection(this.huanxing_list);var r=function(){var t=this.listH.$children[0];if(void 0!=t){var e=t.data;void 0!=e&&void 0!=e.id&&(this.selectSkinItem(t),this.listH.selectedIndex=0,TimerManager.ins().remove(r,this))}};TimerManager.ins().doTimer(100,0,r,this)},e.prototype.sortListByHorse=function(t,e){var i=HorseProxy.ins().getHuaxingEnoughById(t.id)||HorseProxy.ins().getHuaxingExtendEnoughById(t.id),n=HorseProxy.ins().getHuaxingEnoughById(e.id)||HorseProxy.ins().getHuaxingExtendEnoughById(e.id);return i==n?t.id<e.id?-1:1:i?-1:n?1:void 0},e.prototype.sortListByMate=function(t,e){var i=HuobanProxy.ins().getHuaxingEnoughById(t.id)||HuobanProxy.ins().getHuaxingExtendEnoughById(t.id),n=HuobanProxy.ins().getHuaxingEnoughById(e.id)||HuobanProxy.ins().getHuaxingExtendEnoughById(e.id);return i==n?t.id<e.id?-1:1:i?-1:n?1:void 0},e.prototype.sortListByPet=function(t,e){var i=PetProxy.ins().getHuaxingEnoughById(t.id)||PetProxy.ins().getHuaxingExtendEnoughById(t.id),n=PetProxy.ins().getHuaxingEnoughById(e.id)||PetProxy.ins().getHuaxingExtendEnoughById(e.id);return i==n?t.id<e.id?-1:1:i?-1:n?1:void 0},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){this.unUpG.visible=1==e.type;var i,n,o,s=!1,r=!1,a=!1;TimerManager.ins().remove(this.setLeftTime,this),this.left_time_lab.text="",e.HuobanType==HuobanType.horse?(s=HorseProxy.ins().isHuanxingById(e.id),i=HorseProxy.ins().getHuaxingData(e.id),2==e.type&&(o=GlobalConfig.getHorseSkinConfig(e.id),n=GlobalConfig.getHorse_skin_extend_dataConfig(e.id),r=HorseProxy.ins().getHuaxingExtendEnoughById(e.id),a=HorseProxy.ins().getHuaxingEnoughById(e.id))):e.HuobanType==HuobanType.mate?(s=HuobanProxy.ins().isHuanxingById(e.id),i=HuobanProxy.ins().getHuaxingData(e.id),2==e.type&&(o=GlobalConfig.getMateSkinConfig(e.id),n=GlobalConfig.getMate_skin_extend_dataConfig(e.id),r=HuobanProxy.ins().getHuaxingExtendEnoughById(e.id),a=HuobanProxy.ins().getHuaxingEnoughById(e.id))):e.HuobanType==HuobanType.pet&&(s=PetProxy.ins().isHuanxingById(e.id),i=PetProxy.ins().getHuaxingData(e.id),2==e.type&&(o=GlobalConfig.getPetSkinConfig(e.id),n=GlobalConfig.getPet_skin_extend_dataConfig(e.id),r=PetProxy.ins().getHuaxingExtendEnoughById(e.id),a=PetProxy.ins().getHuaxingEnoughById(e.id))),this.hBtn0.visible=!s;var h=e.configEx?e.configEx.name:e.config.name;if(this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+h),2==e.type){this.juexingBtn.visible=i&&i.level>0,this.activeG.visible=!(i&&i.level>0),this.upG.visible=i&&i.level>0,this.uBtn0.setRed(r),this.activeBtn.setRed(r),this.juexingBtn.setRed(a);var l,p;this.currAttrG.visible=!0;var c=i&&i.num>0?UtilProxy.GetAttrFight(o[i.num.toString()]):0,u=0;if(i&&i.level>0)this.level.y=this.showName.y+16*h.length,this.level.text=Math.floor(i.level/10)>0?"+"+Math.floor(i.level/10):"",l=n[i.level.toString()],p=n[(i.level+1).toString()],this.curInfo0.text="当前属性",this.curInfo1.text="下阶属性",this.levelBar.maximum=l.exp,this.levelBar.value=p?i.exp:l.exp,u=UtilProxy.GetAttrFight(l),this.fightValue.text=UtilProxy.GetAttrFight(l).toString(),p?this.upG.visible=!0:this.upG.visible=!1;else if(n){this.level.text="",l=n[1];var d=l.item[0][0],g=l.item[0][1],y=UtilProxy.GetItemCellData(d,g);this.materialItem.data=y,this.curInfo1.text="下阶属性",this.levelBar.maximum=l.exp,this.levelBar.value=0}else this.nextAttrG.visible=!1,this.activeG.visible=!1,this.hBtn0.visible=!1,this.curInfo0.text="当前属性",HorseProxy.ins().getHorseLimitLeftTime(e.id)>0?(this.hBtn0.visible=!s,u=UtilProxy.GetAttrFight(o[1]),TimerManager.ins().doTimer(1e3,0,this.setLeftTime,this),this.setLeftTime()):this.setHorseLimitPath();if(this.fightValue.text=(u+c).toString(),this.upG.visible){var f;e.HuobanType==HuobanType.horse?f=GlobalConfig.getConfig("horse_grade_matrial","horseGradeMatrialConfig"):e.HuobanType==HuobanType.mate?f=GlobalConfig.getConfig("mate_grade_matrial","mateGradeMatrialConfig"):e.HuobanType==HuobanType.pet&&(f=GlobalConfig.getConfig("pet_grade_matrial","petGradeMatrialConfig"));var _=new Array;for(var v in f){var m=new ItemCellData,C=f[v].id,S=BagProxy.ins().getItemCountById(C),w={item_slot_idx:0,item_type_id:f[v].id,item_count:S,isNumShow:!0};m.setItemCellData(w),_.push(m)}this.listM.dataProvider=new eui.ArrayCollection(_)}this.attrG0.numChildren>0&&this.attrG0.removeChildren(),this.attrG1.numChildren>0&&this.attrG1.removeChildren();var x;x=l?AttrProxy.getAttrInfo(l):AttrProxy.getAttrInfo(o[1]||{});for(var T=0;T<x.length;T++){var b=new eui.Label;b.fontFamily="黑体",b.size=14,b.textFlow=UtilProxy.generateTextFlow("C:5&"+x[T][0]+"|C:7& +"+x[T][1]),this.attrG0.addChild(b)}if(p){this.nextAttrG.visible=!0;for(var P=AttrProxy.getAttrInfo(p),T=0;T<P.length;T++){var b=new eui.Label;b.fontFamily="黑体",b.size=14,b.textFlow=UtilProxy.generateTextFlow("C:5&"+P[T][0]+"|C:7& +"+P[T][1]),this.attrG1.addChild(b)}}else this.nextAttrG.visible=!1;for(var T=0;T<this.start_list.length;++T)i&&i.level&&T<i.level%10?this.start_list[T].source="shengxing_icon_01_05":this.start_list[T].source="shengxing_icon_01_01";if(i&&i.level>0){var R=[LvUpType.emZuoqi,LvUpType.emXL,LvUpType.emCW],I=BagProxy.ins().GetLVUpItem(R[e.HuobanType-1],Math.floor(i.level/10));this.lvItem.visible=void 0!=I,void 0!=I&&(this.lvItem.data=I)}else this.lvItem.visible=!1}else if(1==e.type){this.level.text="",this.juexingBtn.visible=!1,this.activeG.visible=!1,this.upG.visible=!1,this.currAttrG.visible=!1,this.nextAttrG.visible=!1;var k;e.HuobanType==HuobanType.horse?k=HorseProxy.ins().getBaseDataConfig(e.config.grade):e.HuobanType==HuobanType.mate?k=HuobanProxy.ins().getBaseDataConfig(e.config.grade):e.HuobanType==HuobanType.pet&&(k=PetProxy.ins().getBaseDataConfig(e.config.grade)),k?this.fightValue.text=UtilProxy.GetAttrFight(k).toString():this.fightValue.text="0"}void 0!=this.mc1&&this.effG0.removeChild(this.mc1),this.mc1=new egret.MovieClip;var E="";E=e.configEx?UtilProxy.getShowImgPath()+e.configEx.source:UtilProxy.getShowImgPath()+e.config.source,UtilProxy.GetMovieClip(E,this.mc1,-1,void 0),this.effG0.addChildAt(this.mc1,6),this.mc1.x=e.configEx?e.configEx.pos[0]:e.config.pos[0],this.mc1.y=e.configEx?e.configEx.pos[0]:e.config.pos[1]}},e.prototype.setLeftTime=function(){if(this.lastSkinItem){var t=Math.floor(HorseProxy.ins().getHorseLimitLeftTime(this.lastSkinItem.data.id));t>0?this.left_time_lab.text=UtilProxy.getHourStrByTime(t):(this.setHorseLimitPath(),this.fightValue.text="0",TimerManager.ins().remove(this.setLeftTime,this))}},e.prototype.setHorseLimitPath=function(){var t=GlobalConfig.getMisc_dataConfig(1);t&&(this.left_time_lab.text=t.limit_horse_path),this.hBtn0.visible=!1},e.prototype.setJuexing=function(t){if(this.JuexingG.visible=t,t){var e,i,n=this.lastSkinItem.data,o=!1;n.HuobanType==HuobanType.horse?(e=HorseProxy.ins().getHuaxingData(n.id),i=GlobalConfig.getHorseSkinConfig(n.id),o=HorseProxy.ins().getHuaxingEnoughById(n.id)):n.HuobanType==HuobanType.mate?(e=HuobanProxy.ins().getHuaxingData(n.id),i=GlobalConfig.getMateSkinConfig(n.id),o=HuobanProxy.ins().getHuaxingEnoughById(n.id)):n.HuobanType==HuobanType.pet&&(e=PetProxy.ins().getHuaxingData(n.id),i=GlobalConfig.getPetSkinConfig(n.id),o=PetProxy.ins().getHuaxingEnoughById(n.id)),this.attrG2.numChildren>0&&this.attrG2.removeChildren(),this.attrG3.numChildren>0&&this.attrG3.removeChildren();var s,r,a=n.configEx?n.configEx.name:n.config.name;if(this.hName1.textFlow=UtilProxy.generateTextFlow("C:10&"+a),e&&e.num>0){this.hName2.y=this.hName1.y+16*a.length,this.hName2.text="+"+e.num,s=i[e.num.toString()],r=i[(e.num+1).toString()];var h=AttrProxy.getAttrInfo(s);this.curInfo2.text="当前属性",this.curInfo3.text="下阶属性";for(var l=0;l<h.length;l++){var p=new eui.Label;p.fontFamily="黑体",p.size=14,p.textFlow=UtilProxy.generateTextFlow("C:5&"+h[l][0]+"|C:7& +"+h[l][1]),this.attrG2.addChild(p)}if(this.hFightValue1.text=UtilProxy.GetAttrFight(s).toString(),r){var c=AttrProxy.getAttrInfo(r);this.Attr2G.visible=!0;for(var l=0;l<c.length;l++){var p=new eui.Label;p.fontFamily="黑体",p.size=14,p.textFlow=UtilProxy.generateTextFlow("C:5&"+c[l][0]+"|C:7& +"+c[l][1]),this.attrG3.addChild(p)}}else this.Attr2G.visible=!1}else{this.hName2.text="",r=i[1],this.hFightValue1.text="0";for(var c=AttrProxy.getAttrInfo(r),l=0;l<c.length;l++){var p=new eui.Label;p.fontFamily="黑体",p.size=14,p.textFlow=UtilProxy.generateTextFlow("C:5&"+c[l][0]+"|C:7& +"+c[l][1]),this.attrG2.addChild(p)}this.Attr2G.visible=!1}var u=n.config.item[0][0],d=r?r.item[0][1]:s.item[0][1],g=UtilProxy.GetItemCellData(u,d);this.hItem.data=g,this.hbtn.setRed(o),void 0!=this.mc2&&this.effG2.removeChild(this.mc2),this.mc2=new egret.MovieClip;var y=UtilProxy.getShowImgPath()+(n.configEx?n.configEx.source:n.config.source);UtilProxy.GetMovieClip(y,this.mc2,-1,void 0),this.effG2.addChildAt(this.mc2,6),this.mc2.x=n.configEx?n.configEx.pos[0]:n.config.pos[0],this.mc2.y=n.configEx?n.configEx.pos[1]:n.config.pos[1]}},e.prototype.onPosClick=function(t){var e=Number(this.pos_x.text),i=Number(this.pos_y.text);switch(t.currentTarget){case this.posBtn0:this.mc1&&(this.mc1.x=e,this.mc1.y=i);break;case this.posBtn1:this.mc2&&(this.mc2.x=e,this.mc2.y=i)}},e}(BaseEuiView);__reflect(HuoBanHXView.prototype,"HuoBanHXView"),ViewManager.ins().reg(HuoBanHXView,LayerManager.UI_Main),window.HuoBanHXView=HuoBanHXView;var HuoBanSkillUseTips=function(t){function e(){var e=t.call(this)||this;return e.usecount=0,e.maxcount=0,e.isShowUse=!1,e.skinName="HuoBanSkillUseTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scrollerview.viewport=this.group_info},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.type=t[1],this.itemdata=t[2],this.addTouchEvent(this.closebtn,this.OnCloseClick),this.addTouchEvent(this.cut_10,this.onclick),this.addTouchEvent(this.add_10,this.onclick),this.addTouchEvent(this.add,this.onclick),this.addTouchEvent(this.cut,this.onclick),this.addTouchEvent(this.use,this.onclick),EventProxy.AddListener(this,EventType.S2CRepBelleSkillUpgrade,this.skillUpgrade),EventProxy.AddListener(this,EventType.S2CRepHorseSkillUpgrade,this.skillUpgrade),EventProxy.AddListener(this,EventType.S2CRepPetSkillUpgrade,this.skillUpgrade),this.initdata()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.OnCloseClick),this.removeTouchEvent(this.cut_10,this.onclick),this.removeTouchEvent(this.add_10,this.onclick),this.removeTouchEvent(this.add,this.onclick),this.removeTouchEvent(this.cut,this.onclick),this.removeTouchEvent(this.use,this.onclick),EventProxy.RemoveListener(this,EventType.S2CRepBelleSkillUpgrade,this.skillUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepHorseSkillUpgrade,this.skillUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepPetSkillUpgrade,this.skillUpgrade)},e.prototype.skillUpgrade=function(t){this.initdata()},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onclick=function(t){switch(t.currentTarget){case this.add:this.usecount=Math.min(this.usecount+1,this.itemdata.item_count);break;case this.add_10:this.usecount=Math.min(this.usecount+10,this.itemdata.item_count);break;case this.cut:this.usecount=Math.max(this.usecount-1,1);break;case this.cut_10:this.usecount=Math.max(this.usecount-10,1);break;case this.use:this.UseItem()}},e.prototype.UseItem=function(){return void 0!=this.itemdata?(this.type!=HuobanProxy.HuobanType_Horse||HorseProxy.ins().isSkillDataOpen(this.itemdata))&&(this.type!=HuobanProxy.HuobanType_Mate||HuobanProxy.ins().isSkillDataOpen(this.itemdata))&&(this.type!=HuobanProxy.HuobanType_Pet||PetProxy.ins().isSkillDataOpen(this.itemdata))?void(this.nextData?BagProxy.ins().getItemCountById(this.nextData.items[0][0])>=this.nextData.items[0][1]?this.type==HuobanProxy.HuobanType_Horse?HorseProxy.ins().C2SReqHorseSkillUpgrade(this.itemdata.id):this.type==HuobanProxy.HuobanType_Mate?HuobanProxy.ins().C2SReqBelleSkillUpgrade(this.itemdata.id):this.type==HuobanProxy.HuobanType_Pet&&PetProxy.ins().C2SReqPetSkillUpgrade(this.itemdata.id):TipsControl.ins().showTips("所需材料不足！"):TipsControl.ins().showTips("已是最高等级！")):void TipsControl.ins().showTips("未达"+this.itemdata.grade+"阶,不能激活！"):void 0},e.prototype.initdata=function(){var t,e=0;this.type==HuobanProxy.HuobanType_Horse?(e=HorseProxy.ins().getSkillLevelById(this.itemdata.id),t=GlobalConfig.getHorseSkillUpgradeConfig(this.itemdata.id),e>0&&(this.currentData=t[e.toString()]),this.nextData=t[(e+1).toString()]):this.type==HuobanProxy.HuobanType_Pet?(e=PetProxy.ins().getSkillLevelById(this.itemdata.id),t=GlobalConfig.getPetSkillUpgradeConfig(this.itemdata.id),e>0&&(this.currentData=t[e.toString()]),this.nextData=t[(e+1).toString()]):this.type==HuobanProxy.HuobanType_Mate&&(e=HuobanProxy.ins().getSkillLevelById(this.itemdata.id),t=GlobalConfig.getMateSkillUpgradeConfig(this.itemdata.id),e>0&&(this.currentData=t[e.toString()]),this.nextData=t[(e+1).toString()]),this.skillItem.data=this.itemdata,this.nameLab.textFlow=UtilProxy.StrFormart("|@0   LV.@1 |",[this.itemdata.name,e]);var i;i=this.currentData?BagProxy.ins().getItemData(this.currentData.items[0][0]):BagProxy.ins().getItemData(this.nextData.items[0][0]);var n=this.nextData?this.nextData.items[0][1]:0;this.icon.source=AssetMgr.getIconResource(i.displayid);var o=BagProxy.ins().getItemCountById(i.id);if(this.num.text=o+"/"+n,this.num.textFlow=UtilProxy.StrFormart("|C:@0 &@1 /@2 |",[o>=n?7:4,o,n]),this.label_1.textFlow=UtilProxy.StrFormart("|战力: @0 |",[this.currentData?UtilProxy.GetAttrFight(this.currentData):0]),this.use.label=this.currentData?"使用":"激活",this.currentData)this.label_1.textFlow=UtilProxy.StrFormart("|战力: @0 |",[UtilProxy.GetAttrFight(this.currentData)]),this.nextData?(this.info_1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[7,this.currentData.skill_describe]),this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&当前效果：|"),this.title_2.textFlow=UtilProxy.generateTextFlow("|C:10&下级效果：|"),this.info_2.textFlow=UtilProxy.generateTextFlow(this.nextData.skill_describe)):(this.info_1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[7,this.currentData.skill_describe]),this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&当前效果：|"),this.title_2.text="",this.info_2.text="");else{var s="";this.type==HuobanProxy.HuobanType_Horse?s="坐骑":this.type==HuobanProxy.HuobanType_Pet?s="灵宠":this.type==HuobanProxy.HuobanType_Mate&&(s="仙侣"),this.label_1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 @2 阶解锁|",[7,s,this.itemdata.grade]),this.info_1.textFlow=UtilProxy.generateTextFlow(this.nextData.skill_describe),this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&下级效果：|"),this.title_2.text="",this.info_2.text=""}this.SetGroup()},e.prototype.SetGroup=function(){this.group_1.height=this.title_1.height+this.info_1.height+10,this.group_2.height=this.title_2.height+this.info_2.height+10},e}(BaseEuiView);__reflect(HuoBanSkillUseTips.prototype,"HuoBanSkillUseTips"),ViewManager.ins().reg(HuoBanSkillUseTips,LayerManager.UI_Main2),window.HuoBanSkillUseTips=HuoBanSkillUseTips;var HuobanSmeltView=function(t){function e(){var e=t.call(this)||this;return e.curIndex=0,e.num=16,e.isInTimer=!1,e.qhsId=30001,e.showlevel=0,e.totleleftcount=0,e.curleftCount=0,e.showexp=0,e.IsOnekey=!0,e.type=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="HuobanSmeltSkin",this.comview.initUI(),this.comview.SetName("title_ronglian"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&熔炼成功|"),this.desc_info.textFlow=UtilProxy.generateTextFlow("|C:7&勾选后，满足保留条件的相同装备只会保留一件分解\n装备可以获得对应的培养丹和金币|"),this.s_list.itemRenderer=SmeltItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.smeltbtn,this.onSmeltClick),this.addTouchEvent(this.closebtn,this.onCloseTipsClick),this.addTouchEvent(this.btn0,this.onCloseTipsClick),this.addTouchEvent(this.closebtn0,this.onCloseClick),this.addTouchEvent(this.autoBtn0,this.onAutoClick),this.addTouchEvent(this.autoBtn1,this.onAutoClick),EventProxy.AddListener(this,EventType.S2CRepKnapsackPartnerMelt,this.StarSmelt),this.showlevel=SmeltProxy.ins().melt_level,this.showexp=SmeltProxy.ins().melt_exp,this.totleleftcount=GlobalConfig.getLimitsConfig(1).melt_limit-SmeltProxy.ins().melt_count,this.curleftCount=this.totleleftcount,this.type=t[0]||1,this.smeltList=[],this.endtips.visible=!1;var i=["座骑","仙侣","灵宠"];this.curInfo1.textFlow=UtilProxy.generateTextFlow("|C:7&(与"+(i[this.type-1]||i[0])+"同阶的高星装备不会被分解)|"),this.topInfo1.textFlow=UtilProxy.generateTextFlow("|C:7&(高于"+(i[this.type-1]||i[0])+"等阶的装备不会被分解)|"),this.setData(),this.setAutoAccept()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.smeltbtn,this.onSmeltClick),this.removeTouchEvent(this.closebtn,this.onCloseTipsClick),this.removeTouchEvent(this.btn0,this.onCloseTipsClick),this.removeTouchEvent(this.closebtn0,this.onCloseClick),this.removeTouchEvent(this.autoBtn0,this.onAutoClick),this.removeTouchEvent(this.autoBtn1,this.onAutoClick),EventProxy.RemoveListener(this,EventType.S2CRepKnapsackPartnerMelt,this.StarSmelt),TimerManager.ins().removeAll(this),this.curIndex=0,SmeltProxy.ins().IsShowEff=!1
},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onCloseTipsClick=function(t){this.endtips.visible=!1},e.prototype.onSmeltClick=function(t){if(!this.isInTimer&&0!=this.smeltList.length){for(var e=[],i=this.IsOnekey?this.smeltList.length:this.num,n=0;n<this.smeltList.length;n++)i>n&&e.push(this.smeltList[n].item_slot_idx);e.length>0&&BagProxy.ins().C2SReqKnapsackPartnerMelt(this.type,e)}},e.prototype.onAutoClick=function(t){switch(t.currentTarget){case this.autoBtn0:var e=!HuobanProxy.ins().getLeftTopState();HuobanProxy.ins().setLeftTopState(e);break;case this.autoBtn1:var i=!HuobanProxy.ins().getLeftCurState();HuobanProxy.ins().setLeftCurState(i)}this.setAutoAccept(),this.curIndex=0,this.setData()},e.prototype.setAutoAccept=function(){this.gou0.visible=HuobanProxy.ins().getLeftTopState(),this.gou1.visible=HuobanProxy.ins().getLeftCurState()},e.prototype.setData=function(){this.smeltList=BagProxy.ins().getHuobanSmeltList(this.type),this.ShowSmeltInfo()},e.prototype.StarSmelt=function(){this.isInTimer=!0;var t=1;this.IsOnekey&&(t=Math.ceil(this.smeltList.length/this.num)+1),this.curIndex=0,SmeltProxy.ins().IsShowEff=!0,TimerManager.ins().doTimer(200,t,this.singleShowSmelt,this,this.finshShow,this)},e.prototype.singleShowSmelt=function(){this.ShowSmeltInfo();for(var t=this.getCurSmeltList(),e=0;e<t.length;e++)if(t[e].item_type_id>0){var i=t[e].itemConfig;this.curleftCount=this.curleftCount-this.getCutNum(i),this.showexp=this.showexp+i.melt;var n=GlobalConfig.getMelt_dataConfig(this.showlevel);void 0!=n&&n.exp>0&&this.showexp>n.exp&&(this.showlevel=this.showlevel+1,this.showexp=this.showexp-n.exp)}this.curIndex=this.curIndex+1},e.prototype.getCutNum=function(t){for(var e=0,i=0;i<t.melt_item.length;i++)t.melt_item[i][0]>100&&(e=t.melt_item[i][1]);return e},e.prototype.finshShow=function(){this.isInTimer=!1,this.smeltbtn.visible=!this.isInTimer,SmeltProxy.ins().IsShowEff=!1,this.IsOnekey=!1},e.prototype.ShowEndTips=function(){this.IsOnekey&&(this.endtips.visible=!0);var t=[],e=[];this.IsOnekey=BagProxy.ins().IsOneKeySmeltOpen();for(var i=this.IsOnekey?this.smeltList.length:this.num,n=0;n<this.smeltList.length;n++)i>n?t.push(this.smeltList[n]):e.push(this.smeltList[n]);var o=this.getSmeltVlaue(t,this.totleleftcount);this.explab.visible=void 0!=o[MoneyAttr.EXP],this.pic_1.visible=void 0!=o[MoneyAttr.EXP],void 0!=o[MoneyAttr.EXP]&&(this.explab.text="经验+"+o[MoneyAttr.EXP].toString()),void 0!=o[MoneyAttr.COIN]&&(this.jblab.text="金币+"+o[MoneyAttr.COIN].toString()),this.qhslab.visible=void 0!=o[this.qhsId],this.pic_3.visible=void 0!=o[this.qhsId],void 0!=o[this.qhsId]&&(this.qhslab.text="强化石+"+o[this.qhsId].toString()),this.smeltList=[],this.smeltList=e,this.ShowSmeltInfo()},e.prototype.ShowSmeltInfo=function(){this.smeltbtn.visible=!this.isInTimer;BagProxy.ins().IsOneKeySmeltOpen();this.smelt_array||(this.smelt_array=new eui.ArrayCollection,this.s_list.dataProvider=this.smelt_array);var t=this.getCurSmeltList();this.smelt_array.removeAll();for(var e in t)this.smelt_array.addItem(t[e]);this.getSmeltVlaue(this.getCurSmeltList(),this.curleftCount)},e.prototype.getSmeltVlaue=function(t,e){for(var i=[],n=0,o=0;o<t.length;o++)if(t[o].item_type_id>0){var s=t[o].itemConfig,r=s.melt_item;n+=this.getCutNum(s),0>=e-n&&(r=s.limit_melt_item);for(var a=0;a<r.length;a++)void 0!=r[a][0]&&(void 0==i[r[a][0]]?i[r[a][0]]=r[a][1]:i[r[a][0]]=i[r[a][0]]+r[a][1])}return i},e.prototype.getCurSmeltList=function(){for(var t=[],e=0;e<this.num;e++){var i=e+this.num*this.curIndex;if(void 0!=this.smeltList[i]){var n=new ItemCellData;n=this.smeltList[i],t[e]=n}else{var n=new ItemCellData;n.item_slot_idx=e+1,t[e]=n}}return t},e}(BaseEuiView);__reflect(HuobanSmeltView.prototype,"HuobanSmeltView"),ViewManager.ins().reg(HuobanSmeltView,LayerManager.UI_Main),window.HuobanSmeltView=HuobanSmeltView;var HuoBanTips=function(t){function e(){var e=t.call(this)||this;return e.type_id=-1,e.visible=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.tip_btn_close,this.onClick),this.type_id=t[0]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.tip_btn_close,this.onClick)},e.prototype.onClick=function(t){this.visible=!1},e.prototype.setInfo=function(){this.visible=!0;var t,e,i=0,n=0;if(this.type_id==HuobanProxy.HuobanType_Pet?(i=PetProxy.ins().grade,n=PetProxy.ins().star,e=GlobalConfig.getPetBaseDataConfig(i)[n],t=i>0?void 0==GlobalConfig.getPetBaseDataConfig(i)[n+1]?void 0!=GlobalConfig.getPetBaseDataConfig(i+1)?GlobalConfig.getPetBaseDataConfig(i+1)[1]:GlobalConfig.getPetBaseDataConfig(i)[n]:GlobalConfig.getPetBaseDataConfig(i)[n+1]:GlobalConfig.getPetBaseDataConfig(1)[1]):this.type_id==HuobanProxy.HuobanType_Horse?(i=HorseProxy.ins().grade,n=HorseProxy.ins().star,e=GlobalConfig.getHorseBaseDataConfig(i)[n],t=i>0?void 0==GlobalConfig.getHorseBaseDataConfig(i)[n+1]?void 0!=GlobalConfig.getHorseBaseDataConfig(i+1)?GlobalConfig.getHorseBaseDataConfig(i+1)[1]:GlobalConfig.getHorseBaseDataConfig(i)[n]:GlobalConfig.getHorseBaseDataConfig(i)[n+1]:GlobalConfig.getHorseBaseDataConfig(1)[1]):this.type_id==HuobanProxy.HuobanType_Mate&&(i=HuobanProxy.ins().grade,n=HuobanProxy.ins().star,e=GlobalConfig.getMateBaseDataConfig(i)[n],t=i>0?void 0==GlobalConfig.getMateBaseDataConfig(i)[n+1]?void 0!=GlobalConfig.getMateBaseDataConfig(i+1)?GlobalConfig.getMateBaseDataConfig(i+1)[1]:GlobalConfig.getMateBaseDataConfig(i)[n]:GlobalConfig.getMateBaseDataConfig(i)[n+1]:GlobalConfig.getMateBaseDataConfig(1)[1]),this.tips_cur_title.textFlow=UtilProxy.generateTextFlow("C:7&当前阶段："),this.tips_next_title.textFlow=UtilProxy.generateTextFlow("C:7&下一阶段："),void 0!=t){for(var o="",s=AttrProxy.getAttrInfo(t),r=0;r<s.length;r++)0==r?o=s[r][0]+"  +"+s[r][1]:o+="\n"+s[r][0]+"  +"+s[r][1];this.tips_next_value.text=o}else this.tips_next_value.text="";if(void 0!=e){for(var a=AttrProxy.getAttrInfo(e),h="",r=0;r<a.length;r++)0==r?h=a[r][0]+"  +"+a[r][1]:h+="\n"+a[r][0]+"  +"+a[r][1];this.tips_cur_value.text=h}else if(void 0!=t){for(var o="",s=AttrProxy.getAttrInfo(t),r=0;r<s.length;r++)0==r?o=s[r][0]+"  +0":o+="\n"+s[r][0]+"  +0";this.tips_cur_value.text=o}else this.tips_cur_value.text=""},e}(BaseEuiView);__reflect(HuoBanTips.prototype,"HuoBanTips"),window.HuoBanTips=HuoBanTips;var HuoBanUseTips=function(t){function e(){var e=t.call(this)||this;return e.usecount=0,e.maxcount=0,e.isShowUse=!1,e.skinName="HuoBanUseTipsExSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.item.SetShowTips(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.itemdata=t[1],this.use_type=t[2],this.addTouchEvent(this.closebtn,this.OnCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepHorseShenLian,this.RefreshShenLian),EventProxy.AddListener(this,EventType.S2CRepPetShenLian,this.RefreshShenLian),EventProxy.AddListener(this,EventType.S2CRepBelleShenLian,this.RefreshShenLian),this.initdata()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.OnCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepHorseShenLian,this.RefreshShenLian),EventProxy.RemoveListener(this,EventType.S2CRepPetShenLian,this.RefreshShenLian),EventProxy.RemoveListener(this,EventType.S2CRepBelleShenLian,this.RefreshShenLian)},e.prototype.RefreshShenLian=function(t){this.initdata()},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=t.currentTarget==this.btn?1:2;this.UseItem(e)},e.prototype.UseItem=function(t){void 0===t&&(t=1);var e=this.itemdata.itemConfig;if(void 0!=e){var i=!0;if(BagProxy.ins().getItemCountById(this.itemdata.item_type_id)<=0)return TipsControl.ins().ShowPathTips(this.itemdata.item_type_id),void(i=!1);if(0==this.maxcount){var n=[];this.type==HuobanProxy.HuobanType_Horse?n=GlobalConfig.getConfig("horse_swallow_extend","horseSwallowExtendConfig"):this.type==HuobanProxy.HuobanType_Pet?n=GlobalConfig.getConfig("pet_swallow_extend","petSwallowExtendConfig"):this.type==HuobanProxy.HuobanType_Mate&&(n=GlobalConfig.getConfig("mate_swallow_extend","mateSwallowExtendConfig"));var o=Number.MAX_VALUE;for(var s in n)n[s].total_grade<o&&(o=n[s].total_grade);return TipsControl.ins().showTips("幻化总等级+"+o+"开启炼神"),void(i=!1)}return this.maxcount<=this.usecount?(TipsControl.ins().showTips("已达使用上限！"),void(i=!1)):void(i&&(this.type==HuobanProxy.HuobanType_Horse?HorseProxy.ins().C2SReqHorseShenLian(t,this.use_type):this.type==HuobanProxy.HuobanType_Mate?HuobanProxy.ins().C2SReqBelleShenLian(t,this.use_type):this.type==HuobanProxy.HuobanType_Pet&&PetProxy.ins().C2SReqPetShenLian(t,this.use_type)))}},e.prototype.initdata=function(){var t=new ItemCellData;t.item_slot_idx=this.itemdata.item_slot_idx,t.item_type_id=this.itemdata.item_type_id,t.itemConfig=this.itemdata.itemConfig,this.item.data=t,this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.itemConfig.quality-1],t.itemConfig.name]);var e="",i=0;this.type==HuobanProxy.HuobanType_Horse?(this.usecount=HorseProxy.ins().UseSwallowCount(this.use_type),this.maxcount=HorseProxy.ins().GetMaxSwallowCount(this.use_type),this.swallow_config=GlobalConfig.getHorseSwallowItemConfig(this.use_type),i=HorseProxy.ins().GetMaxSwallowCountByGrade(this.use_type,HorseProxy.ins().grade+1),e="坐骑"):this.type==HuobanProxy.HuobanType_Pet?(this.usecount=PetProxy.ins().UseSwallowCount(this.use_type),this.maxcount=PetProxy.ins().GetMaxSwallowCount(this.use_type),this.swallow_config=GlobalConfig.getPetSwallowItemConfig(this.use_type),i=PetProxy.ins().GetMaxSwallowCountByGrade(this.use_type,PetProxy.ins().grade+1),e="灵宠"):this.type==HuobanProxy.HuobanType_Mate&&(this.usecount=HuobanProxy.ins().UseSwallowCount(this.use_type),this.maxcount=HuobanProxy.ins().GetMaxSwallowCount(this.use_type),this.swallow_config=GlobalConfig.getMateSwallowItemConfig(this.use_type),i=HuobanProxy.ins().GetMaxSwallowCountByGrade(this.use_type,HuobanProxy.ins().grade+1),e="仙侣"),this.count.text=this.usecount+"/"+this.maxcount;var n=this.itemdata.itemConfig,o=BagProxy.ins().getItemCountById(n.id);this.count.textFlow=UtilProxy.StrFormart("已吞噬：|@0 ",[this.usecount]),this.hascount.textFlow=UtilProxy.StrFormart("|C:10&拥有数量：|@0 ",[o]);var s="",r=AttrProxy.getAttrInfo(this.swallow_config,this.usecount);if(r.length>0){this.desc.textFlow=UtilProxy.StrFormart("|C:@0 &已永久增加主角属性|",[7]);for(var a=0;a<r.length;a++){var h=r[a][1];s=""==s?r[a][0]+h:s+"\n"+r[a][0]+h}this.pro.text=s}else this.desc.text="",this.pro.textFlow=UtilProxy.StrFormart("增加@0 全属性的|C:7&@1 %|",[e,this.swallow_config.lianshen_pre/100*this.usecount]);this.tips.visible=this.tips.includeInLayout=i>0,i>0?this.tips.textFlow=UtilProxy.StrFormart("|C:7&下阶可吞噬@0 颗",[i]):this.tips.text=""},e}(BaseEuiView);__reflect(HuoBanUseTips.prototype,"HuoBanUseTips"),ViewManager.ins().reg(HuoBanUseTips,LayerManager.UI_Main2),window.HuoBanUseTips=HuoBanUseTips;var HuoBanView_Horse=function(t){function e(){var e=t.call(this)||this;return e.isUpAuto=!1,e.current_page=0,e.isOpen=!1,e}return __extends(e,t),e.prototype.initUI=function(t){this.skinName="HuoBanViewXLSkin",t.viewRoot.addChild(this),this.tips.initUI(),this.start_list=[this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9,this.star10],this.listH.itemRenderer=HuanHuaHorseItem,this.scrollerH.viewport=this.listH,this.listM.itemRenderer=ItemCell,this.scrollerM.viewport=this.listM,this.listS.itemRenderer=SkillIconReal,this.scrollerS.viewport=this.listS,this.listSH.itemRenderer=SkillIconReal,this.scrollerSH.viewport=this.listSH,this.setVisible(!1),this.tips.initUI(),this.elist.itemRenderer=HuobanEquipItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.open(HuobanProxy.HuobanType_Horse),this.addTouchEvent(this.uBtn2,this.onUpdateClick),this.addTouchEvent(this.attrBtn,this.onAttrClick),this.addTouchEvent(this.hhBtn,this.onhhBtnClick),this.addTouchEvent(this.hBtn,this.onhBtnClick),this.addTouchEvent(this.hBtn0,this.onhBtnClick),this.addTouchEvent(this.hClose,this.onhCloseClick),this.addTouchEvent(this.zizhiBtn,this.onShenLianClick),this.addTouchEvent(this.lianshengBtn,this.onShenLianClick),this.addTouchEvent(this.lvItem,this.onLvUpClick),this.addTouchEvent(this.equip_btn,this.onEquipOneKeyClick),this.addTouchEvent(this.bag_btn,this.onBagClick),this.addItemTapEvent(this.listH,this.SkinItemClick),this.addItemTapEvent(this.listS,this.SkinSkillClick),this.addItemTapEvent(this.listSH,this.SkinHSkillClick),this.addItemTapEvent(this.elist,this.onElistItemTap),EventProxy.AddListener(this,EventType.S2CRepHorseGetInfo,this.S2CRepHorseGetInfo),EventProxy.AddListener(this,EventType.S2CRepHorseOnekeyUpgrade,this.S2CRepHorseOnekeyUpgrade),EventProxy.AddListener(this,EventType.S2CRepHorseActiveHuaxing,this.S2CRepHorseActiveHuaxing),EventProxy.AddListener(this,EventType.S2CRepHorseShenLian,this.S2CRepHorseShenLian),EventProxy.AddListener(this,EventType.S2CRepHorseSkillUpgrade,this.S2CRepHorseSkillUpgrade),EventProxy.AddListener(this,EventType.S2CRepHorseUpdateShow,this.S2CRepHorseUpdateShow),EventProxy.AddListener(this,EventType.S2CRepHorseFight,this.S2CRepHorseFight),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.setRed),this.isOpen=!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.isOpen){if(this.tips.close(),void 0!=this.mc1&&this.effG.removeChild(this.mc1),void 0!=this.mc2&&this.Huanxing.removeChild(this.mc2),this.mc1=void 0,this.mc2=void 0,this.removeTouchEvent(this.uBtn2,this.onUpdateClick),this.removeTouchEvent(this.attrBtn,this.onAttrClick),this.removeTouchEvent(this.hhBtn,this.onhhBtnClick),this.removeTouchEvent(this.hBtn,this.onhBtnClick),this.removeTouchEvent(this.hBtn0,this.onhBtnClick),this.removeTouchEvent(this.hClose,this.onhCloseClick),this.removeTouchEvent(this.zizhiBtn,this.onShenLianClick),this.removeTouchEvent(this.lianshengBtn,this.onShenLianClick),this.removeTouchEvent(this.lvItem,this.onLvUpClick),this.removeTouchEvent(this.equip_btn,this.onEquipOneKeyClick),this.removeTouchEvent(this.bag_btn,this.onBagClick),this.removeItemTapEvent(this.listH,this.SkinItemClick),this.removeItemTapEvent(this.listS,this.SkinSkillClick),this.removeItemTapEvent(this.listSH,this.SkinHSkillClick),this.removeItemTapEvent(this.elist,this.onElistItemTap),EventProxy.RemoveListener(this,EventType.S2CRepHorseGetInfo,this.S2CRepHorseGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepHorseOnekeyUpgrade,this.S2CRepHorseOnekeyUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepHorseActiveHuaxing,this.S2CRepHorseActiveHuaxing),EventProxy.RemoveListener(this,EventType.S2CRepHorseShenLian,this.S2CRepHorseShenLian),EventProxy.RemoveListener(this,EventType.S2CRepHorseSkillUpgrade,this.S2CRepHorseSkillUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepHorseUpdateShow,this.S2CRepHorseUpdateShow),EventProxy.RemoveListener(this,EventType.S2CRepHorseFight,this.S2CRepHorseFight),EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.setRed),this.listH.numChildren>0)for(var i=0;i<this.listH.numChildren;++i){var n=this.listH.$children[i];void 0!=n&&n.RemoveUpdate()}this.listSH.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinHSkillClick,this),this.listS.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinHSkillClick,this),this.listH.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinHSkillClick,this),this.isOpen=!1}},e.prototype.setVisible=function(t){this.visible=t,t?(this.open(),this.InitSys(),this.setRed(),this.CheckGuide()):this.close()},e.prototype.InitSys=function(){this.InitSkillData(),this.refreshData(),this.SetDanData(),this.setEquipList()},e.prototype.S2CRepHorseGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.S2CRepHorseOnekeyUpgrade=function(t){t&&UtilProxy.GetMovieClipById(32,this.effG0),this.refreshData(),this.RefreshSkillData()},e.prototype.S2CRepHorseActiveHuaxing=function(t){void 0!=this.lastSkinItem&&this.SetSkinData(this.lastSkinItem);for(var e=0;e<this.listH.numChildren;++e){var i=this.listH.getChildAt(e);i&&i.data&&i.data.id==t&&i.refresh()}},e.prototype.S2CRepHorseShenLian=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.refreshData(),this.refreshDanData()},e.prototype.S2CRepHorseSkillUpgrade=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.listS.numChildren;++i){var n=this.listS.getChildAt(i);void 0!=n&&n.data&&n.data.id==t[0]&&n.RefreshData()}for(var i=0;i<this.listSH.numChildren;++i){var o=this.listSH.getChildAt(i);void 0!=o&&o.data&&o.data.id==t[0]&&o.RefreshData()}},e.prototype.S2CRepHorseUpdateShow=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.listH.numChildren;++i){var n=this.listH.getChildAt(i);void 0!=n&&n.refresh()}void 0!=this.lastSkinItem&&(this.lastSkinItem.refresh(),this.SetSkinData(this.lastSkinItem)),this.setShow()},e.prototype.S2CRepHorseFight=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.fightValue.text=HorseProxy.ins().fight.toString()},e.prototype.setEquipList=function(){var t=BagProxy.ins().getHuobanEquipInfo(BagType.HORSE_BODY_EQUIP);this.arrayElist||(this.arrayElist=new eui.ArrayCollection,this.elist.dataProvider=this.arrayElist),this.arrayElist.removeAll();for(var e in t)this.arrayElist.addItem(t[e]);this.elist.validateNow();for(var i=!1,n=0;n<t.length;n++){var o=this.elist.getVirtualElementAt(n);if(t[n]){var s=-1!=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.horse,t[n].item_slot_idx);o.ShowRed(s),s&&(i=s)}}this.equip_btn.setRed(i)},e.prototype.onElistItemTap=function(t){var e=t.item;if(void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type)ViewManager.ins().open(HuobanEquipTipsView,e);else{var i=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.horse,e.item_slot_idx);if(-1==i)return void TipsControl.ins().showTips("没有可穿戴的装备");var n=[],o=new C2SReqKnapsackArm;o.slot_idx=i,o.target_id=t.itemIndex+1,n.push(o),BagProxy.ins().C2SReqKnapsackPartnerArmList(HuobanType.horse,n)}},e.prototype.onEquipOneKeyClick=function(t){for(var e=[],i=0;10>i;i++){var n=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.horse,i+1);if(-1!=n){var o=new C2SReqKnapsackArm;o.slot_idx=n,o.target_id=i+1,e.push(o)}}return 0==e.length?void TipsControl.ins().showTips("没有可穿戴的装备"):void BagProxy.ins().C2SReqKnapsackPartnerArmList(HuobanType.horse,e)},e.prototype.onBagClick=function(t){ViewManager.ins().open(HuobanBagView,HuobanType.horse-1)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onHSkillClick=function(t){var e=t.currentTarget.data,i=GlobalConfig.getHorseSkillUpgradeConfig(e.id),n=HorseProxy.ins().getSkillLevelById(e.id);if(n>=i.length)return void TipsControl.ins().showTips("已是最高等级！");for(var o in i)if(i[o].level==n+1){for(var s=0;s<i[o].items.length;++s)if(BagProxy.ins().getItemCountById(i[o].items[s][0])<i[o].items[s][1])return void TipsControl.ins().showTips("所需材料不足！");HorseProxy.ins().C2SReqHorseSkillUpgrade(e.id)}},e.prototype.onUpdateClick=function(t){switch(t.currentTarget){case this.uBtn2:this.isUpAuto=!this.isUpAuto;var e=Number.MAX_VALUE;for(var i in GlobalConfig.ins().horseGradeMatrialConfig){var n=GlobalConfig.ins().horseGradeMatrialConfig[i].id,o=BagProxy.ins().getItemCountById(n);if(o>0)return void HorseProxy.ins().C2SReqHorseOnekeyUpgrade();e>n&&(e=n)}TipsControl.ins().ShowPathTips(e)}},e.prototype.onAttrClick=function(t){this.tips.setInfo()},e.prototype.onhhBtnClick=function(t){ViewManager.ins().open(HuoBanHXView,HuobanType.horse-1)},e.prototype.onLvUpClick=function(t){ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[LvUpType.emZuoqi,0])},e.prototype.onShenLianClick=function(t){var e=0,i=0;switch(t.currentTarget){case this.zizhiBtn:e=1;break;case this.lianshengBtn:e=2}i=GlobalConfig.getHorseSwallowItemConfig(e).item_id;var n=UtilProxy.GetItemCellData(i,1);ViewManager.ins().open(HuoBanUseTips,HuobanProxy.HuobanType_Horse,n,e)},e.prototype.SetDanData=function(){var t=GlobalConfig.getHorseSwallowItemConfig(1).item_id,e=GlobalConfig.getHorseSwallowItemConfig(2).item_id,i=BagProxy.ins().getItemData(t),n=BagProxy.ins().getItemData(e);this.zizhiBtn.icon=AssetMgr.getIconResource(i.displayid),this.lianshengBtn.icon=AssetMgr.getIconResource(n.displayid),this.refreshDanData()},e.prototype.refreshDanData=function(){var t=(GlobalConfig.getHorseSwallowItemConfig(1).item_id,GlobalConfig.getHorseSwallowItemConfig(2).item_id,HorseProxy.ins().UseSwallowCount(1)),e=HorseProxy.ins().UseSwallowCount(2);this.zizhiBtn.setLabel("C:"+(t==HorseProxy.ins().GetMaxSwallowCount(1)?4:7)+"&"+t+"/"+HorseProxy.ins().GetMaxSwallowCount(1)),this.lianshengBtn.setLabel("C:"+(t==HorseProxy.ins().GetMaxSwallowCount(1)?4:7)+"&"+e+"/"+HorseProxy.ins().GetMaxSwallowCount(2))},e.prototype.refreshData=function(){var t=HorseProxy.ins().grade,e=HorseProxy.ins().star,i=new Horse_base_dataConfig,n=!1;t>0?void 0==GlobalConfig.getHorseBaseDataConfig(t)[e+1]?void 0!=GlobalConfig.getHorseBaseDataConfig(t+1)?i=GlobalConfig.getHorseBaseDataConfig(t+1)[1]:(n=!0,i=GlobalConfig.getHorseBaseDataConfig(t)[e]):i=GlobalConfig.getHorseBaseDataConfig(t)[e+1]:i=GlobalConfig.getHorseBaseDataConfig(1)[1],this.level.textFlow=UtilProxy.generateTextFlow(t+"阶"),this.levelBar.maximum=i.exp,this.levelBar.value=n?i.exp:HorseProxy.ins().GetExp();var o=GlobalConfig.getConfig("horse_grade_matrial","horseGradeMatrialConfig"),s=new Array;for(var r in o){var a=new ItemCellData,h=o[r].id,l=BagProxy.ins().getItemCountById(h),p={item_slot_idx:0,item_type_id:o[r].id,item_count:l,isNumShow:!0};a.setItemCellData(p),s.push(a)}this.listM.dataProvider=new eui.ArrayCollection(s);for(var c=0;c<this.start_list.length;++c)c>=e?this.start_list[c].source="shengxing_icon_01_01":this.start_list[c].source="shengxing_icon_01_05";if(!this.setShow()){var u=GlobalConfig.getHorseGradeShowConfig(i.show_id),d=u.name;this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+d),this.level.y=this.showName.y+16*d.length;var g=UtilProxy.getShowImgPath()+u.source;void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(g,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,1),this.mc1.x=u.pos[0],this.mc1.y=u.pos[1]}var y=BagProxy.ins().GetLVUpItem(LvUpType.emZuoqi,t);this.lvItem.visible=void 0!=y,void 0!=y&&(this.lvItem.data=y),this.fightValue.text=HorseProxy.ins().fight.toString()},e.prototype.setShow=function(){var t=HorseProxy.ins().getShowData();if(t.model_id>0){this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+t.name),this.level.y=this.showName.y+16*t.name.length;var e=UtilProxy.getShowImgPath()+t.ui_model_path;return void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(e,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,1),this.mc1.x=t.pos[0]||0,this.mc1.y=t.pos[1]||0,!0}return!1},e.prototype.onhBtnClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data;switch(t.currentTarget){case this.hBtn0:HorseProxy.ins().isHuanxingActive(e.id)?HorseProxy.ins().C2SReqHorseChangeShow(e.type,e.id):1==e.type?TipsControl.ins().showTips("请提升阶级！"):TipsControl.ins().showTips("尚未激活！");break;case this.hBtn:if(2==e.type){var i=e.config,n=i.item[0][0],o=i.item[0][1];BagProxy.ins().getItemCountById(n)>=o?HorseProxy.ins().C2SReqHorseActiveHuaxing(i.show_id):TipsControl.ins().showTips("物品数量不足！")}}}},e.prototype.onhCloseClick=function(t){this.SetHuanXing(!1)},e.prototype.SetHuanXing=function(t){if(this.Huanxing.visible=t,this.mc1.visible=!t,t){var e=GlobalConfig.getConfig("horse_grade_show","horseGradeShowConfig"),i=GlobalConfig.getConfig("horse_skin_data","horseSkinConfig"),n=new Array;for(var o in e){var s=new HuanxingHorseData;s.setHuanxingData(e[o].show_id,1),n.push(s)}var r=new Array;for(var o in i){var a=i[o],s=new HuanxingHorseData;s.setHuanxingData(a[1].show_id,2),void 0==r[s.id]&&(r[s.id]=s.id,n.push(s))}this.listH.dataProvider=new eui.ArrayCollection(n),this.listH.selectedIndex=0;var h=function(){if(0!=this.listH.numChildren){var t=new egret.Event(eui.ItemTapEvent.ITEM_TAP);t.$currentTarget=this.listH,t.itemRenderer=this.listH.getChildAt(0),this.SkinItemClick(t),TimerManager.ins().remove(h,this)}};TimerManager.ins().doTimer(100,0,h,this),this.InitHuanSkillData()}},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){if(2==e.type){var i=e.config,n=i.attack,o=GlobalConfig.getHorse_skin_ex_dataConfig(e.config.show_id),s=o.name,r=i.hp,a=i.baoji_hurt,h=HorseProxy.ins().getHuaxingNum(i.show_id);this.hInfo0.textFlow=UtilProxy.generateTextFlow("C:10&攻击：|  +"+n),this.hInfo1.textFlow=UtilProxy.generateTextFlow("C:10&生命：|  +"+r),this.hInfo2.textFlow=UtilProxy.generateTextFlow("C:10&伤害：|  +"+a),this.hName.textFlow=UtilProxy.generateTextFlow("C:10&"+s),h>0?(this.hName0.y=this.hName.y+16*s.length,this.hName0.text="+"+h):this.hName0.text="",0==h?this.hBtn.label="激活":this.hBtn.label="进阶",this.hBtn.visible=!0,this.hInfo.visible=!1,HorseProxy.ins().isHuanxingActive(e.id)?this.hBtn0.visible=!HorseProxy.ins().isHuanxingById(e.id):this.hBtn0.visible=!1,this.materialItem.visible=!0;var l=i.item[0][0],p=i.item[0][1],c=UtilProxy.GetItemCellData(l,p);this.materialItem.data=c}else if(1==e.type){this.hInfo0.text="",this.hInfo1.text="",this.hInfo2.text="",this.hInfo.visible=!0;var u=GlobalConfig.getHorse_skin_ex_dataConfig(e.config.show_id),d="";d=e.config instanceof Horse_grade_showConfig?e.config.name:u.name,this.hName.textFlow=UtilProxy.generateTextFlow("C:10&"+d),this.hName0.text="",this.hBtn.visible=!1,this.hBtn0.visible=!HorseProxy.ins().isHuanxingById(e.id),this.materialItem.visible=!1}void 0!=this.mc2&&this.Huanxing.removeChild(this.mc2),this.mc2=new egret.MovieClip;var g="",y=GlobalConfig.getHorse_skin_ex_dataConfig(e.config.show_id);g=e.config instanceof Horse_grade_showConfig?UtilProxy.getShowImgPath()+e.config.source:UtilProxy.getShowImgPath()+y.source,UtilProxy.GetMovieClip(g,this.mc2,-1,void 0),this.Huanxing.addChildAt(this.mc2,6),this.mc2.x=240,this.mc2.y=430}},e.prototype.InitSkillData=function(){GlobalConfig.getConfig("horse_skill_data","horseSkillConfig");var t=[];for(var e in GlobalConfig.ins().horseSkillConfig)t.push(GlobalConfig.ins().horseSkillConfig[e]);this.listS.dataProvider=new eui.ArrayCollection(t)},e.prototype.SkinSkillClick=function(t){var e=t.itemRenderer;e&&e.data&&(e.isCanOpen?HorseProxy.ins().C2SReqHorseSkillUpgrade(e.data.id):e.black.visible||HuobanProxy.ins().enterSkillUseTip(e.data,HuobanProxy.HuobanType_Horse))},e.prototype.RefreshSkillData=function(){for(var t=0;t<this.listS.numChildren;++t){var e=this.listS.getChildAt(t);e&&e.data&&e.RefreshData()}},e.prototype.InitHuanSkillData=function(){GlobalConfig.getConfig("horse_skill_data","horseSkillConfig");var t=[];for(var e in GlobalConfig.ins().horseSkillConfig)t.push(GlobalConfig.ins().horseSkillConfig[e]);this.listS.dataProvider=new eui.ArrayCollection(t)},e.prototype.SkinHSkillClick=function(t){var e=t.itemRenderer;e&&e.data&&HuobanProxy.ins().enterSkillUseTip(e.data,HuobanProxy.HuobanType_Horse)},e.prototype.setRed=function(){this.upFinish.visible=HorseProxy.ins().isMaxGrade(),this.uBtn2.visible=!HorseProxy.ins().isMaxGrade(),this.uBtn2.setRed(HorseProxy.ins().getMatericalRed()),this.hhBtn.setRed(HorseProxy.ins().getHuaxingRed()),this.RefreshSkillData(),this.zizhiBtn.setRed(HorseProxy.ins().getDanRedByType(1)),this.lianshengBtn.setRed(HorseProxy.ins().getDanRedByType(2)),this.setEquipList()},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(ViewBase);__reflect(HuoBanView_Horse.prototype,"HuoBanView_Horse"),window.HuoBanView_Horse=HuoBanView_Horse;var HuoBanView_Mate=function(t){function e(){var e=t.call(this)||this;return e.isUpAuto=!1,e.current_page=0,e.isOpen=!1,e}return __extends(e,t),e.prototype.initUI=function(t){this.skinName="HuoBanViewXLSkin",t.viewRoot.addChild(this),this.start_list=[this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9,this.star10],this.listH.itemRenderer=HuanHuaItem,this.scrollerH.viewport=this.listH,this.listM.itemRenderer=ItemCell,this.scrollerM.viewport=this.listM,this.listS.itemRenderer=SkillIconReal,this.scrollerS.viewport=this.listS,this.listSH.itemRenderer=SkillIconReal,this.scrollerSH.viewport=this.listSH,this.setVisible(!1),this.tips.initUI(),this.elist.itemRenderer=HuobanEquipItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.open(HuobanProxy.HuobanType_Mate),this.addTouchEvent(this.uBtn2,this.onUpdateClick),this.addTouchEvent(this.attrBtn,this.onAttrClick),this.addTouchEvent(this.hhBtn,this.onhhBtnClick),this.addTouchEvent(this.zizhiBtn,this.onShenLianClick),this.addTouchEvent(this.lianshengBtn,this.onShenLianClick),this.addItemTapEvent(this.listS,this.SkinSkillClick),this.addItemTapEvent(this.listSH,this.SkinHSkillClick),this.addItemTapEvent(this.elist,this.onElistItemTap),this.addTouchEvent(this.lvItem,this.onLvUpClick),this.addTouchEvent(this.equip_btn,this.onEquipOneKeyClick),this.addTouchEvent(this.bag_btn,this.onBagClick),EventProxy.AddListener(this,EventType.S2CRepBelleGetInfo,this.S2CRepBelleGetInfo),EventProxy.AddListener(this,EventType.S2CRepBelleOnekeyUpgrade,this.S2CRepBelleOnekeyUpgrade),EventProxy.AddListener(this,EventType.S2CRepBelleActiveHuaxing,this.S2CRepBelleActiveHuaxing),EventProxy.AddListener(this,EventType.S2CRepBelleShenLian,this.S2CRepBelleShenLian),EventProxy.AddListener(this,EventType.S2CRepBelleSkillUpgrade,this.S2CRepBelleSkillUpgrade),EventProxy.AddListener(this,EventType.S2CRepBelleUpdateShow,this.S2CRepBelleUpdateShow),EventProxy.AddListener(this,EventType.S2CRepBelleFight,this.S2CRepBelleFight),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.setRed),this.isOpen=!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.isOpen){if(this.tips.close(),void 0!=this.mc1&&this.effG.removeChild(this.mc1),void 0!=this.mc2&&this.Huanxing.removeChild(this.mc2),this.mc1=void 0,this.mc2=void 0,this.removeTouchEvent(this.uBtn2,this.onUpdateClick),this.removeTouchEvent(this.attrBtn,this.onAttrClick),this.removeTouchEvent(this.hhBtn,this.onhhBtnClick),this.removeTouchEvent(this.zizhiBtn,this.onShenLianClick),this.removeTouchEvent(this.lianshengBtn,this.onShenLianClick),this.removeTouchEvent(this.lvItem,this.onLvUpClick),this.removeTouchEvent(this.equip_btn,this.onEquipOneKeyClick),this.removeTouchEvent(this.bag_btn,this.onBagClick),EventProxy.RemoveListener(this,EventType.S2CRepBelleGetInfo,this.S2CRepBelleGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepBelleOnekeyUpgrade,this.S2CRepBelleOnekeyUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepBelleActiveHuaxing,this.S2CRepBelleActiveHuaxing),EventProxy.RemoveListener(this,EventType.S2CRepBelleShenLian,this.S2CRepBelleShenLian),EventProxy.RemoveListener(this,EventType.S2CRepBelleSkillUpgrade,this.S2CRepBelleSkillUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepBelleUpdateShow,this.S2CRepBelleUpdateShow),EventProxy.RemoveListener(this,EventType.S2CRepBelleFight,this.S2CRepBelleFight),EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.setRed),this.listH.numChildren>0)for(var i=0;i<this.listH.numChildren;++i){var n=this.listH.$children[i];
void 0!=n&&n.RemoveUpdate()}this.removeItemTapEvent(this.listS,this.SkinSkillClick),this.removeItemTapEvent(this.listSH,this.SkinHSkillClick),this.removeItemTapEvent(this.elist,this.onElistItemTap),this.isOpen=!1}},e.prototype.setVisible=function(t){this.visible=t,t?(this.open(),this.InitSys(),this.setRed(),this.CheckGuide()):this.close()},e.prototype.InitSys=function(){this.InitSkillData(),this.refreshData(),this.SetDanData(),this.setEquipList()},e.prototype.S2CRepBelleGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.S2CRepBelleOnekeyUpgrade=function(t){t&&UtilProxy.GetMovieClipById(32,this.effG0),this.refreshData(),this.RefreshSkillData()},e.prototype.S2CRepBelleActiveHuaxing=function(t){for(var e=0;e<this.listH.numChildren;++e){var i=this.listH.getChildAt(e);i&&i.data&&i.data.id==t&&i.refresh()}},e.prototype.S2CRepBelleShenLian=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.refreshData(),this.refreshDanData()},e.prototype.S2CRepBelleSkillUpgrade=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.listS.numChildren;++i){var n=this.listS.getChildAt(i);void 0!=n&&n.data&&n.data.id==t[0]&&n.RefreshData()}for(var i=0;i<this.listSH.numChildren;++i){var o=this.listSH.getChildAt(i);void 0!=o&&o.data&&o.data.id==t[0]&&o.RefreshData()}},e.prototype.S2CRepBelleUpdateShow=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.listH.numChildren;++i){var n=this.listH.getChildAt(i);void 0!=n&&n.refresh()}this.setShow()},e.prototype.S2CRepBelleFight=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.fightValue.text=HuobanProxy.ins().fight.toString()},e.prototype.setEquipList=function(){var t=BagProxy.ins().getHuobanEquipInfo(BagType.BELLE_BODY_EQUIP);this.arrayElist||(this.arrayElist=new eui.ArrayCollection,this.elist.dataProvider=this.arrayElist),this.arrayElist.removeAll();for(var e in t)this.arrayElist.addItem(t[e]);this.elist.validateNow();for(var i=!1,n=0;n<t.length;n++){var o=this.elist.getVirtualElementAt(n);if(t[n]){var s=-1!=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.mate,t[n].item_slot_idx);o.ShowRed(s),s&&(i=s)}}this.equip_btn.setRed(i)},e.prototype.onElistItemTap=function(t){var e=t.item;if(void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type)ViewManager.ins().open(HuobanEquipTipsView,e);else{var i=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.mate,e.item_slot_idx);if(-1==i)return void TipsControl.ins().showTips("没有可穿戴的装备");var n=[],o=new C2SReqKnapsackArm;o.slot_idx=i,o.target_id=t.itemIndex+1,n.push(o),BagProxy.ins().C2SReqKnapsackPartnerArmList(HuobanType.mate,n)}},e.prototype.onEquipOneKeyClick=function(t){for(var e=[],i=0;10>i;i++){var n=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.mate,i+1);if(-1!=n){var o=new C2SReqKnapsackArm;o.slot_idx=n,o.target_id=i+1,e.push(o)}}return 0==e.length?void TipsControl.ins().showTips("没有可穿戴的装备"):void BagProxy.ins().C2SReqKnapsackPartnerArmList(HuobanType.mate,e)},e.prototype.onBagClick=function(t){ViewManager.ins().open(HuobanBagView,HuobanType.mate-1)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onLvUpClick=function(t){ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[LvUpType.emXL,0])},e.prototype.onUpdateClick=function(t){switch(t.currentTarget){case this.uBtn2:this.isUpAuto=!this.isUpAuto;var e=Number.MAX_VALUE;for(var i in GlobalConfig.ins().mateGradeMatrialConfig){var n=GlobalConfig.ins().mateGradeMatrialConfig[i].id,o=BagProxy.ins().getItemCountById(n);if(o>0)return void HuobanProxy.ins().C2SReqBelleOnekeyUpgrade();e>n&&(e=n)}TipsControl.ins().ShowPathTips(e)}},e.prototype.onAttrClick=function(t){this.tips.setInfo()},e.prototype.onhhBtnClick=function(t){ViewManager.ins().open(HuoBanHXView,HuobanType.mate-1)},e.prototype.onShenLianClick=function(t){var e=0,i=0;switch(t.currentTarget){case this.zizhiBtn:e=1;break;case this.lianshengBtn:e=2}i=GlobalConfig.getMateSwallowItemConfig(e).item_id;var n=UtilProxy.GetItemCellData(i,1);ViewManager.ins().open(HuoBanUseTips,HuobanProxy.HuobanType_Mate,n,e)},e.prototype.SetDanData=function(){var t=GlobalConfig.getMateSwallowItemConfig(1).item_id,e=GlobalConfig.getMateSwallowItemConfig(2).item_id,i=BagProxy.ins().getItemData(t),n=BagProxy.ins().getItemData(e);this.zizhiBtn.icon=AssetMgr.getIconResource(i.displayid),this.lianshengBtn.icon=AssetMgr.getIconResource(n.displayid),this.refreshDanData()},e.prototype.refreshDanData=function(){var t=(GlobalConfig.getMateSwallowItemConfig(1).item_id,GlobalConfig.getMateSwallowItemConfig(2).item_id,HuobanProxy.ins().UseSwallowCount(1)),e=HuobanProxy.ins().UseSwallowCount(2);this.zizhiBtn.setLabel("C:"+(t==HuobanProxy.ins().GetMaxSwallowCount(1)?4:7)+"&"+t+"/"+HuobanProxy.ins().GetMaxSwallowCount(1)),this.lianshengBtn.setLabel("C:"+(t==HuobanProxy.ins().GetMaxSwallowCount(1)?4:7)+"&"+e+"/"+HuobanProxy.ins().GetMaxSwallowCount(2))},e.prototype.refreshData=function(){var t=HuobanProxy.ins().grade,e=HuobanProxy.ins().star,i=new Mate_base_dataConfig,n=!1;t>0?void 0==GlobalConfig.getMateBaseDataConfig(t)[e+1]?void 0!=GlobalConfig.getMateBaseDataConfig(t+1)?i=GlobalConfig.getMateBaseDataConfig(t+1)[1]:(n=!0,i=GlobalConfig.getMateBaseDataConfig(t)[e]):i=GlobalConfig.getMateBaseDataConfig(t)[e+1]:i=GlobalConfig.getMateBaseDataConfig(1)[1],this.level.textFlow=UtilProxy.generateTextFlow(t+"阶"),this.levelBar.maximum=i.exp,this.levelBar.value=n?i.exp:HuobanProxy.ins().GetExp();var o=GlobalConfig.getConfig("mate_grade_matrial","mateGradeMatrialConfig"),s=new Array;for(var r in o){var a=new ItemCellData,h=o[r].id,l=BagProxy.ins().getItemCountById(h),p={item_slot_idx:0,item_type_id:o[r].id,item_count:l,isNumShow:!0};a.setItemCellData(p),s.push(a)}this.listM.dataProvider=new eui.ArrayCollection(s);for(var c=0;c<this.start_list.length;++c)c>=e?this.start_list[c].source="shengxing_icon_01_01":this.start_list[c].source="shengxing_icon_01_05";if(!this.setShow()){var u=GlobalConfig.getMateGradeShowConfig(i.show_id),d=u.name;this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+d),this.level.y=this.showName.y+16*d.length;var g=UtilProxy.getShowImgPath()+u.source;void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(g,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,1),this.mc1.x=u.pos[0],this.mc1.y=u.pos[1]}var y=BagProxy.ins().GetLVUpItem(LvUpType.emXL,t);this.lvItem.visible=void 0!=y,void 0!=y&&(this.lvItem.data=y),this.fightValue.text=HuobanProxy.ins().fight.toString()},e.prototype.setShow=function(){var t=HuobanProxy.ins().getShowData();if(t.model_id>0){this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+t.name),this.level.y=this.showName.y+16*t.name.length;var e=UtilProxy.getShowImgPath()+t.ui_model_path;return void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(e,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,1),this.mc1.x=t.pos[0]||0,this.mc1.y=t.pos[1]||0,!0}return!1},e.prototype.InitSkillData=function(){GlobalConfig.getConfig("mate_skill_data","mateSkillConfig");var t=[];for(var e in GlobalConfig.ins().mateSkillConfig)t.push(GlobalConfig.ins().mateSkillConfig[e]);this.listS.dataProvider=new eui.ArrayCollection(t)},e.prototype.SkinSkillClick=function(t){var e=t.itemRenderer;e&&e.data&&(e.isCanOpen?HuobanProxy.ins().C2SReqBelleSkillUpgrade(e.data.id):e.black.visible||HuobanProxy.ins().enterSkillUseTip(e.data,HuobanProxy.HuobanType_Mate))},e.prototype.RefreshSkillData=function(){for(var t=0;t<this.listS.numChildren;++t){var e=this.listS.getChildAt(t);e&&e.data&&e.RefreshData()}},e.prototype.InitHuanSkillData=function(){GlobalConfig.getConfig("mate_skill_data","mateSkillConfig");var t=[];for(var e in GlobalConfig.ins().mateSkillConfig)t.push(GlobalConfig.ins().mateSkillConfig[e]);this.listS.dataProvider=new eui.ArrayCollection(t)},e.prototype.SkinHSkillClick=function(t){var e=t.itemRenderer;e&&e.data&&HuobanProxy.ins().enterSkillUseTip(e.data,HuobanProxy.HuobanType_Mate)},e.prototype.setRed=function(){this.upFinish.visible=HuobanProxy.ins().isMaxGrade(),this.uBtn2.visible=!HuobanProxy.ins().isMaxGrade(),this.uBtn2.setRed(HuobanProxy.ins().getMatericalRed()),this.hhBtn.setRed(HuobanProxy.ins().getHuaxingRed()),this.RefreshSkillData(),this.zizhiBtn.setRed(HuobanProxy.ins().getDanRedByType(1)),this.lianshengBtn.setRed(HuobanProxy.ins().getDanRedByType(2)),this.setEquipList()},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(ViewBase);__reflect(HuoBanView_Mate.prototype,"HuoBanView_Mate"),window.HuoBanView_Mate=HuoBanView_Mate;var HuoBanView_Pet=function(t){function e(){var e=t.call(this)||this;return e.isUpAuto=!1,e.current_page=0,e.isOpen=!1,e}return __extends(e,t),e.prototype.initUI=function(t){this.skinName="HuoBanViewXLSkin",t.viewRoot.addChild(this),this.start_list=[this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9,this.star10],this.skill_list=[this.skill0,this.skill1,this.skill2,this.skill3],this.hskill_list=[this.hskill0,this.hskill1,this.hskill2,this.hskill3],this.listH.itemRenderer=HuanHuaPetItem,this.scrollerH.viewport=this.listH,this.listM.itemRenderer=ItemCell,this.scrollerM.viewport=this.listM,this.listS.itemRenderer=SkillIconReal,this.scrollerS.viewport=this.listS,this.listSH.itemRenderer=SkillIconReal,this.scrollerSH.viewport=this.listSH,this.setVisible(!1),this.tips.initUI(),this.elist.itemRenderer=HuobanEquipItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.open(HuobanProxy.HuobanType_Pet),this.addTouchEvent(this.uBtn2,this.onUpdateClick),this.addTouchEvent(this.attrBtn,this.onAttrClick),this.addTouchEvent(this.hhBtn,this.onhhBtnClick),this.addTouchEvent(this.hBtn,this.onhBtnClick),this.addTouchEvent(this.hBtn0,this.onhBtnClick),this.addTouchEvent(this.hClose,this.onhCloseClick),this.addTouchEvent(this.zizhiBtn,this.onShenLianClick),this.addTouchEvent(this.lianshengBtn,this.onShenLianClick),this.addItemTapEvent(this.listH,this.SkinItemClick),this.addItemTapEvent(this.listS,this.SkinSkillClick),this.addItemTapEvent(this.listSH,this.SkinHSkillClick),this.addItemTapEvent(this.elist,this.onElistItemTap),this.addTouchEvent(this.lvItem,this.onLvUpClick),this.addTouchEvent(this.equip_btn,this.onEquipOneKeyClick),this.addTouchEvent(this.bag_btn,this.onBagClick),EventProxy.AddListener(this,EventType.S2CRepPetGetInfo,this.S2CRepPetGetInfo),EventProxy.AddListener(this,EventType.S2CRepPetOnekeyUpgrade,this.S2CRepPetOnekeyUpgrade),EventProxy.AddListener(this,EventType.S2CRepPetActiveHuaxing,this.S2CRepPetActiveHuaxing),EventProxy.AddListener(this,EventType.S2CRepPetShenLian,this.S2CRepPetShenLian),EventProxy.AddListener(this,EventType.S2CRepPetSkillUpgrade,this.S2CRepPetSkillUpgrade),EventProxy.AddListener(this,EventType.S2CRepPetUpdateShow,this.S2CRepPetUpdateShow),EventProxy.AddListener(this,EventType.S2CRepPetFight,this.S2CRepPetFight),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.setRed),this.isOpen=!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.isOpen){if(this.tips.close(),void 0!=this.mc1&&this.effG.removeChild(this.mc1),void 0!=this.mc2&&this.Huanxing.removeChild(this.mc2),this.mc1=void 0,this.mc2=void 0,this.removeTouchEvent(this.uBtn2,this.onUpdateClick),this.removeTouchEvent(this.attrBtn,this.onAttrClick),this.removeTouchEvent(this.hhBtn,this.onhhBtnClick),this.removeTouchEvent(this.hBtn,this.onhBtnClick),this.removeTouchEvent(this.hBtn0,this.onhBtnClick),this.removeTouchEvent(this.hClose,this.onhCloseClick),this.removeTouchEvent(this.zizhiBtn,this.onShenLianClick),this.removeTouchEvent(this.lianshengBtn,this.onShenLianClick),this.removeItemTapEvent(this.listH,this.SkinItemClick),this.removeItemTapEvent(this.listS,this.SkinSkillClick),this.removeItemTapEvent(this.listSH,this.SkinHSkillClick),this.removeItemTapEvent(this.elist,this.onElistItemTap),this.removeTouchEvent(this.lvItem,this.onLvUpClick),this.removeTouchEvent(this.equip_btn,this.onEquipOneKeyClick),this.removeTouchEvent(this.bag_btn,this.onBagClick),EventProxy.RemoveListener(this,EventType.S2CRepPetGetInfo,this.S2CRepPetGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepPetOnekeyUpgrade,this.S2CRepPetOnekeyUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepPetActiveHuaxing,this.S2CRepPetActiveHuaxing),EventProxy.RemoveListener(this,EventType.S2CRepPetShenLian,this.S2CRepPetShenLian),EventProxy.RemoveListener(this,EventType.S2CRepPetSkillUpgrade,this.S2CRepPetSkillUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepPetUpdateShow,this.S2CRepPetUpdateShow),EventProxy.RemoveListener(this,EventType.S2CRepPetFight,this.S2CRepPetFight),EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.setRed),this.listH.numChildren>0)for(var i=0;i<this.listH.numChildren;++i){var n=this.listH.$children[i];void 0!=n&&n.RemoveUpdate()}this.isOpen=!1}},e.prototype.setVisible=function(t){this.visible=t,t?(this.open(),this.InitSys(),this.setRed(),this.CheckGuide()):this.close()},e.prototype.InitSys=function(){this.InitSkillData(),this.refreshData(),this.SetDanData(),this.setEquipList()},e.prototype.S2CRepPetGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.S2CRepPetOnekeyUpgrade=function(t){t&&UtilProxy.GetMovieClipById(32,this.effG0),this.refreshData(),this.RefreshSkillData()},e.prototype.S2CRepPetActiveHuaxing=function(t){void 0!=this.lastSkinItem&&this.SetSkinData(this.lastSkinItem);for(var e=0;e<this.listH.numChildren;++e){var i=this.listH.getChildAt(e);i&&i.data&&i.data.id==t&&i.refresh()}},e.prototype.S2CRepPetShenLian=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.refreshData(),this.refreshDanData()},e.prototype.S2CRepPetSkillUpgrade=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.listS.numChildren;++i){var n=this.listS.getChildAt(i);void 0!=n&&n.data&&n.data.id==t[0]&&n.RefreshData()}for(var i=0;i<this.listSH.numChildren;++i){var o=this.listSH.getChildAt(i);void 0!=o&&o.data&&o.data.id==t[0]&&o.RefreshData()}},e.prototype.S2CRepPetUpdateShow=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.listH.numChildren;++i){var n=this.listH.getChildAt(i);void 0!=n&&n.refresh()}void 0!=this.lastSkinItem&&(this.lastSkinItem.refresh(),this.SetSkinData(this.lastSkinItem)),this.setShow()},e.prototype.S2CRepPetFight=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.fightValue.text=PetProxy.ins().fight.toString()},e.prototype.setEquipList=function(){var t=BagProxy.ins().getHuobanEquipInfo(BagType.PET_BODY_EQUIP);this.arrayElist||(this.arrayElist=new eui.ArrayCollection,this.elist.dataProvider=this.arrayElist),this.arrayElist.removeAll();for(var e in t)this.arrayElist.addItem(t[e]);this.elist.validateNow();for(var i=!1,n=0;n<t.length;n++){var o=this.elist.getVirtualElementAt(n);if(t[n]){var s=-1!=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.pet,t[n].item_slot_idx);o.ShowRed(s),s&&(i=s)}}this.equip_btn.setRed(i)},e.prototype.onElistItemTap=function(t){var e=t.item;if(void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type)ViewManager.ins().open(HuobanEquipTipsView,e);else{var i=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.pet,e.item_slot_idx);if(-1==i)return void TipsControl.ins().showTips("没有可穿戴的装备");var n=[],o=new C2SReqKnapsackArm;o.slot_idx=i,o.target_id=t.itemIndex+1,n.push(o),BagProxy.ins().C2SReqKnapsackPartnerArmList(HuobanType.pet,n)}},e.prototype.onEquipOneKeyClick=function(t){for(var e=[],i=0;10>i;i++){var n=BagProxy.ins().getHuobanDressIndexByPart(HuobanType.pet,i+1);if(-1!=n){var o=new C2SReqKnapsackArm;o.slot_idx=n,o.target_id=i+1,e.push(o)}}return 0==e.length?void TipsControl.ins().showTips("没有可穿戴的装备"):void BagProxy.ins().C2SReqKnapsackPartnerArmList(HuobanType.pet,e)},e.prototype.onBagClick=function(t){ViewManager.ins().open(HuobanBagView,HuobanType.pet-1)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onLvUpClick=function(t){ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[LvUpType.emCW,0])},e.prototype.onSkillClick=function(t){if(!t.currentTarget.black.visible){var e=(this.skill_list.indexOf(t.currentTarget),t.currentTarget.data),i=GlobalConfig.getPetSkillUpgradeConfig(e.id),n=PetProxy.ins().getSkillLevelById(e.id);if(n>=i.length)return void TipsControl.ins().showTips("已是最高等级！");for(var o in i)if(i[o].level==n+1){for(var s=0;s<i[o].items.length;++s)if(BagProxy.ins().getItemCountById(i[o].items[s][0])<i[o].items[s][1])return void TipsControl.ins().showTips("所需材料不足！");PetProxy.ins().C2SReqPetSkillUpgrade(e.id)}}},e.prototype.onHSkillClick=function(t){if(!t.currentTarget.black.visible){var e=(this.hskill_list.indexOf(t.currentTarget),t.currentTarget.data),i=GlobalConfig.getPetSkillUpgradeConfig(e.id),n=PetProxy.ins().getSkillLevelById(e.id);if(n>=i.length)return void TipsControl.ins().showTips("已是最高等级！");for(var o in i)if(i[o].level==n+1){for(var s=0;s<i[o].items.length;++s)if(BagProxy.ins().getItemCountById(i[o].items[s][0])<i[o].items[s][1])return void TipsControl.ins().showTips("所需材料不足！");PetProxy.ins().C2SReqPetSkillUpgrade(e.id)}}},e.prototype.onUpdateClick=function(t){switch(t.currentTarget){case this.uBtn2:this.isUpAuto=!this.isUpAuto;var e=Number.MAX_VALUE;for(var i in GlobalConfig.ins().petGradeMatrialConfig){var n=GlobalConfig.ins().petGradeMatrialConfig[i].id,o=BagProxy.ins().getItemCountById(n);if(o>0)return void PetProxy.ins().C2SReqPetOnekeyUpgrade();e>n&&(e=n)}TipsControl.ins().ShowPathTips(e)}},e.prototype.onAttrClick=function(t){this.tips.setInfo()},e.prototype.onhhBtnClick=function(t){ViewManager.ins().open(HuoBanHXView,HuobanType.pet-1)},e.prototype.onShenLianClick=function(t){var e=0,i=0;switch(t.currentTarget){case this.zizhiBtn:e=1;break;case this.lianshengBtn:e=2}i=GlobalConfig.getPetSwallowItemConfig(e).item_id;var n=UtilProxy.GetItemCellData(i,1);ViewManager.ins().open(HuoBanUseTips,HuobanProxy.HuobanType_Pet,n,e)},e.prototype.SetDanData=function(){var t=GlobalConfig.getPetSwallowItemConfig(1).item_id,e=GlobalConfig.getPetSwallowItemConfig(2).item_id,i=BagProxy.ins().getItemData(t),n=BagProxy.ins().getItemData(e);this.zizhiBtn.icon=AssetMgr.getIconResource(i.displayid),this.lianshengBtn.icon=AssetMgr.getIconResource(n.displayid),this.refreshDanData()},e.prototype.refreshDanData=function(){var t=(GlobalConfig.getPetSwallowItemConfig(1).item_id,GlobalConfig.getPetSwallowItemConfig(2).item_id,PetProxy.ins().UseSwallowCount(1)),e=PetProxy.ins().UseSwallowCount(2);this.zizhiBtn.setLabel("C:"+(t==PetProxy.ins().GetMaxSwallowCount(1)?4:7)+"&"+t+"/"+PetProxy.ins().GetMaxSwallowCount(1)),this.lianshengBtn.setLabel("C:"+(t==PetProxy.ins().GetMaxSwallowCount(1)?4:7)+"&"+e+"/"+PetProxy.ins().GetMaxSwallowCount(2))},e.prototype.refreshData=function(){var t=PetProxy.ins().grade,e=PetProxy.ins().star,i=new Pet_base_dataConfig,n=!1;t>0?void 0==GlobalConfig.getPetBaseDataConfig(t)[e+1]?void 0!=GlobalConfig.getPetBaseDataConfig(t+1)?i=GlobalConfig.getPetBaseDataConfig(t+1)[1]:(n=!0,i=GlobalConfig.getPetBaseDataConfig(t)[e]):i=GlobalConfig.getPetBaseDataConfig(t)[e+1]:i=GlobalConfig.getPetBaseDataConfig(1)[1],this.level.textFlow=UtilProxy.generateTextFlow(t+"阶"),this.levelBar.maximum=i.exp,this.levelBar.value=n?i.exp:PetProxy.ins().GetExp();var o=GlobalConfig.getConfig("pet_grade_matrial","petGradeMatrialConfig"),s=new Array;for(var r in o){var a=new ItemCellData,h=o[r].id,l=BagProxy.ins().getItemCountById(h),p={item_slot_idx:0,item_type_id:o[r].id,item_count:l,isNumShow:!0};a.setItemCellData(p),s.push(a)}this.listM.dataProvider=new eui.ArrayCollection(s);for(var c=0;c<this.start_list.length;++c)c>=e?this.start_list[c].source="shengxing_icon_01_01":this.start_list[c].source="shengxing_icon_01_05";if(!this.setShow()){var u=GlobalConfig.getPetGradeShowConfig(i.show_id),d=u.name;this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+d),this.level.y=this.showName.y+16*d.length;var g=UtilProxy.getShowImgPath()+u.source;void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(g,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,1),this.mc1.x=u.pos[0],this.mc1.y=u.pos[1]}var y=BagProxy.ins().GetLVUpItem(LvUpType.emCW,t);this.lvItem.visible=void 0!=y,void 0!=y&&(this.lvItem.data=y),this.fightValue.text=PetProxy.ins().fight.toString()},e.prototype.setShow=function(){var t=PetProxy.ins().getShowData();if(t.model_id>0){this.showName.textFlow=UtilProxy.generateTextFlow("C:10&"+t.name);var e=UtilProxy.getShowImgPath()+t.ui_model_path;return this.level.y=this.showName.y+16*t.name.length,void 0!=this.mc1&&this.effG.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(e,this.mc1,-1,void 0),this.effG.addChildAt(this.mc1,1),this.mc1.x=t.pos[0]||0,this.mc1.y=t.pos[1]||0,!0}return!1},e.prototype.onhBtnClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data;switch(t.currentTarget){case this.hBtn0:PetProxy.ins().isHuanxingActive(e.id)?PetProxy.ins().C2SReqPetChangeShow(e.type,e.id):1==e.type?TipsControl.ins().showTips("请提升阶级！"):TipsControl.ins().showTips("尚未激活！");break;case this.hBtn:if(2==e.type){var i=e.config,n=i.item[0][0],o=i.item[0][1];BagProxy.ins().getItemCountById(n)>=o?PetProxy.ins().C2SReqPetActiveHuaxing(i.show_id):TipsControl.ins().showTips("物品数量不足！")}}}},e.prototype.onhCloseClick=function(t){this.SetHuanXing(!1)},e.prototype.SetHuanXing=function(t){if(this.Huanxing.visible=t,this.mc1.visible=!t,t){var e=GlobalConfig.getConfig("pet_grade_show","petGradeShowConfig"),i=GlobalConfig.getConfig("pet_skin_data","petSkinConfig"),n=new Array;for(var o in e){var s=new HuanxingPetData;s.setHuanxingData(e[o].show_id,1),n.push(s)}var r=new Array;for(var o in i){var a=i[o],s=new HuanxingPetData;s.setHuanxingData(a[1].show_id,2),void 0==r[s.id]&&(r[s.id]=s.id,n.push(s))}this.listH.dataProvider=new eui.ArrayCollection(n),this.listH.selectedIndex=0;var h=function(){var t=this.listH.$children[0];if(void 0!=t){var e=t.data;void 0!=e&&void 0!=e.id&&(this.selectSkinItem(t),TimerManager.ins().remove(h,this))}};TimerManager.ins().doTimer(100,0,h,this),this.InitHuanSkillData()}},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){if(2==e.type){var i=e.config,n=i.attack,o=GlobalConfig.getPet_skin_ex_dataConfig(e.id),s=o.name,r=i.hp,a=i.kang_baoji_hurt,h=PetProxy.ins().getHuaxingNum(i.show_id);this.hInfo0.textFlow=UtilProxy.generateTextFlow("C:10&攻击：|  +"+n),this.hInfo1.textFlow=UtilProxy.generateTextFlow("C:10&生命：|  +"+r),this.hInfo2.textFlow=UtilProxy.generateTextFlow("C:10&伤害：|  +"+a),this.hName.textFlow=UtilProxy.generateTextFlow("C:10&"+s),h>0?(this.hName0.y=this.hName.y+16*s.length,this.hName0.text="+"+h):this.hName0.text="",0==h?this.hBtn.label="激活":this.hBtn.label="进阶",this.hBtn.visible=!0,this.hInfo.visible=!1,PetProxy.ins().isHuanxingActive(e.id)?this.hBtn0.visible=!PetProxy.ins().isHuanxingById(e.id):this.hBtn0.visible=!1,this.materialItem.visible=!0;var l=i.item[0][0],p=i.item[0][1],c=UtilProxy.GetItemCellData(l,p);this.materialItem.data=c}else if(1==e.type){this.hInfo0.text="",this.hInfo1.text="",this.hInfo2.text="",this.hInfo.visible=!0;var u=GlobalConfig.getPet_skin_ex_dataConfig(e.config.show_id),d="";d=e.config instanceof Pet_grade_showConfig?e.config.name:u.name,this.hName.textFlow=UtilProxy.generateTextFlow("C:10&"+d),this.hName0.text="",this.hBtn.visible=!1,this.hBtn0.visible=!PetProxy.ins().isHuanxingById(e.id),this.materialItem.visible=!1}void 0!=this.mc2&&this.Huanxing.removeChild(this.mc2),this.mc2=new egret.MovieClip;var g="",y=GlobalConfig.getPet_skin_ex_dataConfig(e.config.show_id);g=e.config instanceof Pet_grade_showConfig?UtilProxy.getShowImgPath()+e.config.source:UtilProxy.getShowImgPath()+y.source,UtilProxy.GetMovieClip(g,this.mc2,-1,void 0),this.Huanxing.addChildAt(this.mc2,6),this.mc2.x=220,this.mc2.y=440}},e.prototype.InitSkillData=function(){GlobalConfig.getConfig("pet_skill_data","petSkillConfig");var t=[];for(var e in GlobalConfig.ins().petSkillConfig)t.push(GlobalConfig.ins().petSkillConfig[e]);this.listS.dataProvider=new eui.ArrayCollection(t)},e.prototype.SkinSkillClick=function(t){var e=t.itemRenderer;e&&e.data&&(e.isCanOpen?PetProxy.ins().C2SReqPetSkillUpgrade(e.data.id):e.black.visible||HuobanProxy.ins().enterSkillUseTip(e.data,HuobanProxy.HuobanType_Pet))},e.prototype.RefreshSkillData=function(){for(var t=0;t<this.listS.numChildren;++t){var e=this.listS.getChildAt(t);e&&e.data&&e.RefreshData()}},e.prototype.InitHuanSkillData=function(){GlobalConfig.getConfig("pet_skill_data","petSkillConfig");var t=[];for(var e in GlobalConfig.ins().petSkillConfig)t.push(GlobalConfig.ins().petSkillConfig[e]);this.listS.dataProvider=new eui.ArrayCollection(t)},e.prototype.SkinHSkillClick=function(t){var e=t.itemRenderer;e&&e.data&&HuobanProxy.ins().enterSkillUseTip(e.data,HuobanProxy.HuobanType_Pet)},e.prototype.setRed=function(){this.upFinish.visible=PetProxy.ins().isMaxGrade(),this.uBtn2.visible=!PetProxy.ins().isMaxGrade(),this.uBtn2.setRed(PetProxy.ins().getMatericalRed()),this.hhBtn.setRed(PetProxy.ins().getHuaxingRed()),this.RefreshSkillData(),this.zizhiBtn.setRed(PetProxy.ins().getDanRedByType(1)),this.lianshengBtn.setRed(PetProxy.ins().getDanRedByType(2)),this.setEquipList()},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(ViewBase);__reflect(HuoBanView_Pet.prototype,"HuoBanView_Pet"),window.HuoBanView_Pet=HuoBanView_Pet;var HuoBanView=function(t){function e(){var e=t.call(this)||this;return e.current_page=-1,e.view_mate=new HuoBanView_Mate,e.view_pet=new HuoBanView_Pet,e.view_horse=new HuoBanView_Horse,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="HuoBanViewSkin",this.comview.initUI(),this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2],this.view_mate.initUI(this),this.view_pet.initUI(this),this.view_horse.initUI(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.view_mate.open(t),this.view_pet.open(t),this.view_horse.open(t),this.addTouchEvent(this.closeBtn,this.onCloseClick);for(var i=0;i<this.sbtnList.length;++i)this.addTouchEvent(this.sbtnList[i],this.onSysClick);var n=-1;n=void 0!=t&&void 0!=t[0]?t[0]:0,this.setCurrentView(n),this.setComName(n);for(var i=0;i<this.sbtnList.length;++i)this.sbtnList[i].icon="common_btn_big_yellow_off";this.sbtnList[n].icon="common_btn_big_yellow",this.setRed(),this.zuoqi_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emZuoqi),this.xl_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emXL),this.cw_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emCW),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.setRed)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.view_mate.close(t),this.view_pet.close(t),this.view_horse.close(t),this.removeTouchEvent(this.closeBtn,this.onCloseClick);for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onSysClick);this.current_page=-1,HuobanProxy.ins().setCurrentPage(-1);for(var i=0;i<this.sbtnList.length;++i)this.sbtnList[i].icon="common_btn_big_yellow_off";EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.setRed)},e.prototype.onSysClick=function(t){var e=this.sbtnList.indexOf(t.currentTarget),i=e>0?2:1,n=e>0?2e3+e:20,o=SystemOpenProxy.ins().isCurOpenItem(i,n);e>0?SystemOpenProxy.ins().isOpen(i,n)&&this.setCurrentView(e):this.setCurrentView(e),o&&(SystemOpenProxy.ins().removeCurOpenItem(i,n),EventProxy.Broast(EventType.RefreshHuoBanRed,[]))},e.prototype.setComName=function(t){switch(t){case 0:this.comview.SetName(UtilProxy.getTitleName("坐骑"));break;case 1:this.comview.SetName(UtilProxy.getTitleName("仙侣"));break;case 2:this.comview.SetName(UtilProxy.getTitleName("灵宠"))}},e.prototype.setCurrentView=function(t){if(this.current_page!=t){void 0!=this.current_view&&this.current_view.setVisible(!1);var e,i=!1;switch(t){case 0:e=this.view_horse;break;case 1:HuobanProxy.ins().isInitView&&(i=!0,HuobanProxy.ins().isInitView=!1),SystemOpenProxy.ins().isCurOpenItem(2,100*M_View_Type.Huoban+1)&&(i=!0,SystemOpenProxy.ins().removeCurOpenItem(2,100*M_View_Type.Huoban+1)),e=this.view_mate;break;case 2:PetProxy.ins().isInitView&&(i=!0,PetProxy.ins().isInitView=!1),SystemOpenProxy.ins().isCurOpenItem(2,100*M_View_Type.Huoban+2)&&(i=!0,SystemOpenProxy.ins().removeCurOpenItem(2,100*M_View_Type.Huoban+2)),e=this.view_pet}i&&EventProxy.Broast(EventType.RefreshHuoBanRed,[]),HuobanProxy.ins().setCurrentPage(t);for(var n=0;n<this.sbtnList.length;++n)n==t?this.sbtnList[n].icon="common_btn_big_yellow":this.sbtnList[n].icon="common_btn_big_yellow_off";this.current_view=e,void 0!=this.current_view&&this.current_view.setVisible(!0),this.setComName(t),this.current_page=t}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setRed=function(){this.sbtnList[0].setRed(HorseProxy.ins().getHorseRed()),this.sbtnList[1].setRed(HuobanProxy.ins().getMateRed()),this.sbtnList[2].setRed(PetProxy.ins().getPetRed())},e}(BaseEuiView);__reflect(HuoBanView.prototype,"HuoBanView"),ViewManager.ins().reg(HuoBanView,LayerManager.UI_Main),window.HuoBanView=HuoBanView;var TimerManager=function(t){function e(){var e=t.call(this)||this;return e.currHandler=null,e._handlers=[],e.nexthandles=null,e._currTime=egret.getTimer(),e._currFrame=0,egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getFrameId=function(){return this._currFrame},e.prototype.getCurrTime=function(){return this._currTime},e.binFunc=function(t,e){return t.exeTime>e.exeTime?-1:t.exeTime<e.exeTime?1:0},e.DeleteHandle=function(t){t.clear(),ObjectPool.push(t)},e.prototype.onEnterFrame=function(t){this._currFrame++,this._currTime=egret.getTimer();var i=this.nexthandles;if(this.nexthandles=null,i&&i.length>0){for(var n=0,o=i;n<o.length;n++){var s=o[n];s.method.call(s.methodObj),e.DeleteHandle(s)}i=null}if(this._handlers.length<=0)return!1;for(var r=this._handlers[this._handlers.length-1];r.exeTime<=this._currTime;){this.currHandler=r=this._handlers.pop(),r.method.call(r.methodObj),r.exeTime=egret.getTimer()+r.delay;var a=r.forever;if(a||(r.repeatCount>1?(r.repeatCount--,a=!0):r.onFinish&&r.onFinish.apply(r.finishObj)),a){var h=Algorithm.binSearch(this._handlers,r,e.binFunc);this._handlers.splice(h,0,r)}else e.DeleteHandle(r);if(this._handlers.length<=0)break;r=this._handlers[this._handlers.length-1]}return this.currHandler=null,!1},e.prototype.create=function(t,i,n,o,s,r,a){if(!(0>i||0>n||null==o)){var h=ObjectPool.pop("TimerHandler");h.forever=0==n,h.repeatCount=n,h.delay=i,h.method=o,h.methodObj=s,h.onFinish=r,h.finishObj=a,h.exeTime=t+this._currTime;var l=Algorithm.binSearch(this._handlers,h,e.binFunc);this._handlers.splice(l,0,h)}},e.prototype.doTimer=function(t,e,i,n,o,s){void 0===o&&(o=null),void 0===s&&(s=null),this.create(t,t,e,i,n,o,s)},e.prototype.doTimerDelay=function(t,e,i,n,o,s,r){void 0===s&&(s=null),void 0===r&&(r=null),this.create(t,e,i,n,o,s,r)},e.prototype.doNext=function(t,e){var i=ObjectPool.pop("TimerHandler");i.method=t,i.methodObj=e,this.nexthandles||(this.nexthandles=[]),this.nexthandles.push(i)},e.prototype.remove=function(t,e){var i=this.currHandler;i&&i.method==t&&i.methodObj==e&&(i.forever=!1,i.repeatCount=0);for(var n=this._handlers.length-1;n>=0;n--){var o=this._handlers[n];
o.method==t&&o.methodObj==e&&this._handlers.splice(n,1)}},e.prototype.removeAll=function(t){var e=this.currHandler;e&&e.methodObj==t&&(e.forever=!1,e.repeatCount=0);for(var i=this._handlers.length-1;i>=0;i--){var n=this._handlers[i];n.methodObj==t&&this._handlers.splice(i,1)}},e.prototype.isExists=function(t,e){for(var i=0,n=this._handlers;i<n.length;i++){var o=n[i];if(o.method==t&&o.methodObj==e)return!0}return!1},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.forever=!1,this.repeatCount=0,this.exeTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.onFinish=null,this.finishObj=null,this.forever=!1},t}();__reflect(TimerHandler.prototype,"TimerHandler");var BuyGiftView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=KaifuGiftItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll();var i=[];for(var n in t){var o=LimitActProxy.ins().getGiftDataListById(t[n].id);for(var s in o)i.push(o[s])}i.sort(this.sort);for(var n in i)this.array.addItem(i[n])}},e.prototype.sort=function(t,e){var i=t.limit_num-LimitActProxy.ins().getLimitGiftBuyNum(t.id),n=e.limit_num-LimitActProxy.ins().getLimitGiftBuyNum(e.id);return 0==i&&n>0?1:i>0&&0==n?-1:t.id<e.id?-1:t.id>e.id?1:0},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(BuyGiftView.prototype,"BuyGiftView"),window.BuyGiftView=BuyGiftView;var ChongbangTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ChongBangSkin",this.list.itemRenderer=ItemCell,this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&(注：冲榜日提升可是最划算的喔)|"),this.effect.removeChildren(),UtilProxy.GetMovieClipById(71,this.effect),this.effect0.removeChildren(),UtilProxy.GetMovieClipById(72,this.effect0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.bg,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.bg,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),LimitActProxy.ins().IsShowRankAct&&EventProxy.Broast(EventType.GuideDoEvent,[]),LimitActProxy.ins().IsShowRankAct=!1,this.model.removeChildren()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){ViewManager.ins().open(KaifuView)},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetKaifuTabCf()||LimitActProxy.ins().GetKuafuTabCf();if(this.title.source="resource/skins/KaiFu/"+t.tips_pics[0]+".png",this.icon.visible=""!=t.tips_pics[1],this.icon.source=t.tips_pics[1],this.title0.source=t.tips_pics[2],this.model.removeChildren(),t.tips_pics[3]&&""!=t.tips_pics[3]){this.model.x=t.tips_pics[4],this.model.y=t.tips_pics[5];var e=new egret.MovieClip;UtilProxy.GetMovieClip(t.tips_pics[3],e,-1,void 0),this.model.addChild(e)}this.awardarray||(this.awardarray=new eui.ArrayCollection,this.list.dataProvider=this.awardarray),this.awardarray.removeAll();var i=this.getAwardId(t);if(i>0){for(var n=GlobalConfig.getDropConfig(i),o=GlobalConfig.getDropItem(n.drop),s=0;s<o.length;s++){var r=UtilProxy.GetItemCellData(o[s][0].id,o[s][0].num);this.awardarray.addItem(r)}if(t.title_reward>0){var a=GlobalConfig.getTitleById(t.title_reward),r=UtilProxy.GetItemCellData(a.tips_id,1);this.awardarray.addItem(r)}}},e.prototype.getAwardId=function(t){for(var e=0;e<t.act_award.length;e++)if(1>=t.act_award[e][0]&&1<=t.act_award[e][1]){if(3==t.reward_type)return t.act_award[e][2];if(8==t.reward_type)return t.act_award[e][2][0][2]}return 0},e}(BaseEuiView);__reflect(ChongbangTips.prototype,"ChongbangTips"),ViewManager.ins().reg(ChongbangTips,LayerManager.UI_Open),window.ChongbangTips=ChongbangTips;var ComTargetItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="KaifuAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data,e=GlobalConfig.getRank_typeConfig(t.act_params[0]),i=LimitActProxy.ins().GetActivityData(t.id);this.btn.visible=!i.is_get,this.hasget.visible=i.is_get,this.red.visible=i.is_completed&&!i.is_get;var n=i.params[0]||0;this.tips.textFlow=UtilProxy.StrFormart("全服有@0 人@1 达到@2 |C:@3 &(@4 /@0 )|",[t.act_params[1],e.labstr,UtilProxy.getNumLab(13==t.act_params[0]?CopyProxy.ins().getSYTFloorBySceneId(t.act_params[2]):t.act_params[2]),n>=t.act_params[1]?7:4,n,t.act_params[1]]),this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var o=t.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),a=0;a<r.length;a++){var h=UtilProxy.GetItemCellData(r[a][0].id,r[a][0].num);this.arry.addItem(h)}},e.prototype.onClick=function(t){var e=this.data,i=LimitActProxy.ins().GetActivityData(e.id);if(i){var n=i.params[0]||0;if(n<e.act_params[1])return void TipsControl.ins().showTips("目标尚未达到");i.is_get||LimitActProxy.ins().C2SReqLimitActGetReward(e.id)}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(ComTargetItem.prototype,"ComTargetItem"),window.ComTargetItem=ComTargetItem;var ComTargetView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=ComTargetItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime();var i=GlobalConfig.getRank_typeConfig(e.act_params[0]);this.lab.text=UtilProxy.getStr("我的@0 ：@1 ",[i.labstr,UtilProxy.getfloorNum(RankProxy.ins().getMyFightByType(e.act_params[0]))]),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll(),t.sort(this.sort);for(var n in t)this.array.addItem(t[n])}},e.prototype.sort=function(t,e){var i=LimitActProxy.ins().GetActivityData(t.id),n=LimitActProxy.ins().GetActivityData(e.id);return i.is_completed&&!i.is_get?-1:n.is_completed&&!n.is_get?1:i.is_get&&!n.is_get?1:!i.is_get&&n.is_get?-1:t.id<e.id?-1:0},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(ComTargetView.prototype,"ComTargetView"),window.ComTargetView=ComTargetView;var GrowUpTargetItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="KaifuAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data,e="积分",i=t.act_params[1];if(16==t.act_type){var n=GlobalConfig.getRank_typeConfig(t.act_params[0]);e=n.labstr,i=13==t.act_params[0]?CopyProxy.ins().getSYTFloorBySceneId(t.act_params[1]):t.act_params[1]}this.tips.textFlow=UtilProxy.StrFormart("@0 达到@1 ",[e,UtilProxy.getNumLab(i)]);var o=LimitActProxy.ins().GetActivityData(t.id);this.btn.visible=!o.is_get,this.hasget.visible=o.is_get,this.red.visible=o.is_completed&&!o.is_get,this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var s=t.act_award[0];if(s>0)for(var r=GlobalConfig.getDropConfig(s),a=GlobalConfig.getDropItem(r.drop),h=0;h<a.length;h++){var l=UtilProxy.GetItemCellData(a[h][0].id,a[h][0].num);this.arry.addItem(l)}},e.prototype.onClick=function(t){var e=this.data,i=LimitActProxy.ins().GetActivityData(e.id);if(i){if(0==i.is_completed)return void TipsControl.ins().showTips("目标尚未达到");i.is_get||LimitActProxy.ins().C2SReqLimitActGetReward(e.id)}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(GrowUpTargetItem.prototype,"GrowUpTargetItem"),window.GrowUpTargetItem=GrowUpTargetItem;var GrowupTargetView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=GrowUpTargetItem,this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.upbtn,this.onbtnClick),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.upbtn,this.onbtnClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo)},e.prototype.onbtnClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type)[0];void 0==e||e.openview.length<=0||UtilProxy.openView(e.openview[0],e.openview[1])},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime();var i="积分",n=LimitActProxy.ins().consume_score,o=e.act_params[1];if(this.pic0.source=16==this.act_type?"kaifuhuodong_font_07":"kaifuhuodong_chongbang_font_02",this.pic1.visible=16==this.act_type,16==this.act_type){var s=GlobalConfig.getRank_typeConfig(e.act_params[0]);i=s.labstr,n=RankProxy.ins().getMyFightByType(e.act_params[0]),13==e.act_params[0]&&(o=CopyProxy.ins().getSYTFloorBySceneId(e.act_params[1]))}this.fightlab.text=UtilProxy.getStr("我的@0 ：@1 ",[i,16==this.act_type?UtilProxy.getfloorNum(n):n]),this.tips.textFlow=UtilProxy.StrFormart("奖励条件：|C:7&@0 达到@1 以上|",[i,UtilProxy.getfloorNum(o)]),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll(),t.sort(this.sort);for(var r in t)this.array.addItem(t[r])}},e.prototype.sort=function(t,e){var i=LimitActProxy.ins().GetActivityData(t.id),n=LimitActProxy.ins().GetActivityData(e.id);return i.is_get&&!n.is_get?1:!i.is_get&&n.is_get?-1:t.id<e.id?-1:0},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(GrowupTargetView.prototype,"GrowupTargetView"),window.GrowupTargetView=GrowupTargetView;var KaifuGiftItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell,this.title.textFlow=UtilProxy.generateTextFlow("|C:10&抢购礼包|"),this.btn.label=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑 换":"购 买"},e.prototype.setSkinName=function(){this.skinName="KaifuGiftItemSkin"},e.prototype.dataChanged=function(){var t=this.data;if(void 0!=t){var e=t.limit_num-LimitActProxy.ins().getLimitGiftBuyNum(t.id);this.limitlab.textFlow=UtilProxy.StrFormart("限购 (|C:@2 &@0 |/@1 )",[e,t.limit_num,e>0?1:4]),this.viplab.visible=t.vip_level>0,this.viplab.textFlow=UtilProxy.StrFormart("|C:5&VIP@0  特权|",[t.vip_level]),UtilProxy.shield&&(this.viplab.visible=!1),this.pic.visible=""!=t.pic,this.pic.source=t.pic,this.showgroup.visible=t.show_consume.length>0,this.showgroup.visible&&(this.price1.text=UtilProxy.getStr("原价：       @0 ",[t.show_consume[1]]),this.pic1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t.show_consume[0]).displayid)),this.price2.text=UtilProxy.getStr("现价：      @0 ",[t.consume[1]]),this.pic2.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(t.consume[0]).displayid),this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();var i=t.reward_id;if(i>0)for(var n=GlobalConfig.getDropConfig(i),o=GlobalConfig.getDropItem(n.drop),s=0;s<o.length;s++){var r=UtilProxy.GetItemCellData(o[s][0].id,o[s][0].num);this.arry.addItem(r)}this.red.visible=LimitActProxy.ins().getGiftCanBuyById(t.id)}},e.prototype.onClick=function(t){var e=this.data;if(void 0!=e){if(e.vip_level>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))return void TipsControl.ins().showTips("VIP等级不足");var i=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑换":"购买";if(e.limit_num<=LimitActProxy.ins().getLimitGiftBuyNum(e.id))return void TipsControl.ins().showTips(i+"次数不足");if(e.consume[1]>BagProxy.ins().getItemCountById(e.consume[0]))return void TipsControl.ins().showTips(UtilProxy.getStr("@0 不足",[BagProxy.ins().getItemName(e.consume[0])]));LimitActProxy.ins().C2SReqLimitActBuyGift(e.id,e.act_id),t.stopImmediatePropagation()}},e}(BaseItemRender);__reflect(KaifuGiftItem.prototype,"KaifuGiftItem"),window.KaifuGiftItem=KaifuGiftItem;var KaifuRankItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="KaifuRankItemSkin"},e.prototype.dataChanged=function(){var t=GlobalConfig.getActivity_dataConfig(LimitActProxy.ins().OpenRankActId);if(void 0!=t){this.rankpic.visible=this.data.index<=3,this.ranklab.visible=this.data.index>3,this.data.index<=3&&(this.rankpic.source="top_icon_0"+this.data.index);var e=LimitActProxy.ins().getRankRacAwardInfo(this.data.index,t);e&&(this.ranklab.textFlow=e[0]==e[1]?UtilProxy.StrFormart("|C:10&@0 |",[e[0]]):UtilProxy.StrFormart("|C:10&@0 -@1 |",[e[0],e[1]]),this.namelab.visible=e[0]==e[1],this.fightlab.visible=8==t.reward_type||e[0]==e[1]);var i="积分",n=0,o="虚位以待";if(13==t.act_type){var s=GlobalConfig.getRank_typeConfig(t.act_params[0]);i=s.labstr,n=13==t.act_params[0]?CopyProxy.ins().getSYTFloorBySceneId(this.data.value):this.data.value,this.data.name&&(o=this.data.name)}else n=this.data.score,this.data.name&&(o=UtilProxy.getStr("S@0 .@1 ",[this.data.server_id,this.data.name]));if(this.namelab.text=UtilProxy.getStr("@0 ",[o]),this.fightlab.textFlow=UtilProxy.StrFormart("|C:10&@0 ：@1 |",[i,13==t.act_type?UtilProxy.getFightNumLab(n||0):n]),8==t.reward_type&&!this.data.name){var r=LimitActProxy.ins().getRankRacAwardInfo(this.data.index,t),a=13==t.act_params[0]?CopyProxy.ins().getSYTFloorBySceneId(r[2][0][0]):r[2][0][0];this.fightlab.textFlow=UtilProxy.StrFormart("|C:10&@0 达到@1 |",[i,UtilProxy.getfloorNum(a)])}if(this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll(),e&&e[2])for(var h=3==t.reward_type?e[2]:e[2][0][2],l=GlobalConfig.getDropConfig(h),p=GlobalConfig.getDropItem(l.drop),c=0;c<p.length;c++){var u=UtilProxy.GetItemCellData(p[c][0].id,p[c][0].num);this.arry.addItem(u)}}},e}(BaseItemRender);__reflect(KaifuRankItem.prototype,"KaifuRankItem"),window.KaifuRankItem=KaifuRankItem;var KaifuView=function(t){function e(){var e=t.call(this)||this;return e.viewList={RankRacView:void 0,GrowupTargetView:void 0,BuyGiftView:void 0,ComTargetView:void 0},e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="KaifuSkin",this.RankRacView.initUI(),this.GrowupTargetView.initUI(),this.BuyGiftView.initUI(),this.ComTargetView.initUI(),this.viewList.RankRacView=this.RankRacView,this.viewList.GrowupTargetView=this.GrowupTargetView,this.viewList.BuyGiftView=this.BuyGiftView,this.viewList.ComTargetView=this.ComTargetView,this.btns=[this.btn0,this.btn1,this.btn2,this.btn3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onbtnClick);EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.IntBtnList),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.IntBtnList),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.IntBtnList),this.RankRacView.open(),this.GrowupTargetView.open(),this.BuyGiftView.open(),this.ComTargetView.open(),this.IntBtnList();var n=t[0]||0;this.SetBtnIndex(n)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.IntBtnList),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.IntBtnList),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.IntBtnList),this.RankRacView.close(),this.GrowupTargetView.close(),this.BuyGiftView.close(),this.ComTargetView.close()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){var e=this.btns.indexOf(t.currentTarget);this.SetBtnIndex(e)},e.prototype.IntBtnList=function(){var t=[];LimitActProxy.ins().GetKaifuTabCf()?(this.title.source="kaifuhuodong_title_font",t=GlobalConfig.getOpenServerViewTab()):LimitActProxy.ins().GetKuafuTabCf()&&(this.title.source="kaifuhuodong_title_font_01",t=GlobalConfig.getKuafuViewTab());for(var e=0;e<this.btns.length;e++)if(this.btns[e].visible=!1,t[e+1]&&this.viewList[t[e+1].page_view]){this.viewList[t[e+1].page_view].act_type=t[e+1].act_type,this.viewList[t[e+1].page_view].sub_type=t[e+1].sub_type;var i=0!=t[e+1].sub_type?t[e+1].sub_type:void 0,n=LimitActProxy.ins().GetActivityCfgs(t[e+1].act_type,i);if(this.btns[e].visible=n.length>0,n[0]&&""!=n[0].btn_title){var o=this.btns[e].getChildAt(3);o.visible=!0,o.source=n[0].btn_title}n.length>0&&(this.btns[e].getChildAt(4).visible=LimitActProxy.ins().GetRedByType(t[e+1].act_type,i),"BuyGiftView"==t[e+1].page_view&&(this.btns[e].getChildAt(4).visible=LimitActProxy.ins().IsShowGiftRed))}},e.prototype.SetBtnIndex=function(t){if(LimitActProxy.ins().IsShowActEffect&&(LimitActProxy.ins().IsShowActEffect=!1,EventProxy.Broast(EventType.S2CRepLimitActGetInfo,{})),0!=this.btns[t].visible){this.curbtn&&(this.curbtn.getChildAt(1).visible=!1),this.curbtn=this.btns[t],this.curbtn.getChildAt(1).visible=!0;var e=void 0;LimitActProxy.ins().GetKaifuTabCf()?e=GlobalConfig.getOpenserver_viewtabConfig(t+1):LimitActProxy.ins().GetKuafuTabCf()&&(e=GlobalConfig.getKuafu_viewtabConfig(t+1)),e&&this.viewList[e.page_view]&&(this.curView&&this.curView.setVisible(!1),this.curView=this.viewList[e.page_view],this.curView.setVisible(!0),LimitActProxy.ins().IsShowGiftRed&&"BuyGiftView"==e.page_view&&(LimitActProxy.ins().IsShowGiftRed=!1,this.curbtn.getChildAt(4).visible=LimitActProxy.ins().IsShowGiftRed))}},e}(BaseEuiView);__reflect(KaifuView.prototype,"KaifuView"),ViewManager.ins().reg(KaifuView,LayerManager.UI_Main2),window.KaifuView=KaifuView;var RankRacView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){this.sv.viewport=this.list,this.list.itemRenderer=KaifuRankItem,this.awradlist.itemRenderer=ItemCell,this.tips0.textFlow=UtilProxy.generateTextFlow("|C:7&数据每隔120秒刷新一次|"),this.upbtn.textFlow=UtilProxy.generateTextFlow("|C:7&U&前往升阶|"),this.setVisible(!1),this.effect.removeChildren(),UtilProxy.GetMovieClipById(45,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rankbtn,this.onbtnClick),this.addTouchEvent(this.upbtn,this.onbtnClick),this.addTouchEvent(this.chenghao,this.onbtnClick),this.addTouchEvent(this.rankbtn0,this.onbtnClick),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepMiscOtherInfo,this.SetTopInfo),EventProxy.AddListener(this,EventType.S2CRepRankGetRanksRole,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActConsumeRank,this.ShowInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rankbtn,this.onbtnClick),this.removeTouchEvent(this.upbtn,this.onbtnClick),this.removeTouchEvent(this.chenghao,this.onbtnClick),this.removeTouchEvent(this.rankbtn0,this.onbtnClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepMiscOtherInfo,this.SetTopInfo),EventProxy.RemoveListener(this,EventType.S2CRepRankGetRanksRole,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActConsumeRank,this.ShowInfo)},e.prototype.onbtnClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type)[0];if(void 0!=e)switch(t.currentTarget){case this.rankbtn:13==e.act_type?ViewManager.ins().open(RankView,e.act_params[0]-1):ViewManager.ins().open(ScoreRankTipView);break;case this.upbtn:e.openview.length>0&&UtilProxy.openView(e.openview[0],e.openview[1]);break;case this.chenghao:if(e.title_reward>0){var i=GlobalConfig.getTitleById(e.title_reward),n=new ItemCellData,o={item_slot_idx:0,item_type_id:i.tips_id,item_count:1};n.setItemCellData(o),ViewManager.ins().open(ItemTipsView,n)}break;case this.rankbtn0:ViewManager.ins().open(SevenDayRankView)}},e.prototype.setVisible=function(t){this.visible=t,t&&this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type)[0];if(void 0!=t){this.rankbtn0.visible=t.server_open_time[0]<7&&LimitActProxy.ins().IsSevenDayRankAct(t.id),this.effect.visible=this.rankbtn0.visible,LimitActProxy.ins().OpenRankActId=t.id,this.endtime=LimitActProxy.ins().GetActEndTime(t),this.ShowColdTime();var e=LimitActProxy.ins().myActRank,i=LimitActProxy.ins().consume_score,n="积分",o=t.act_params[0];this.tips0.visible=13!=this.act_type,this.topinfo.visible=13==this.act_type,this.sv.y=13==this.act_type?322:136,this.sv.height=13==this.act_type?161:345,this.pic0.visible=13==this.act_type,this.pic1.source=13==this.act_type?"kaifuhuodong_font_02":"kaifuhuodong_chongbang_font_01";var s=t.act_params[0],r=t?t.act_params[1]:0;if(r=13==this.act_type&&13==s?CopyProxy.ins().getSYTFloorBySceneId(r):r,13==this.act_type){var a=GameLogic.ins().getServerTime();a-RankProxy.ins().getranktime>60&&(RankProxy.ins().getranktime=a,RankProxy.ins().C2SReqRankGetRanksRole(s));var h=GlobalConfig.getRank_typeConfig(s);n=h.labstr,i=RankProxy.ins().getMyFightByType(s),e=LimitActProxy.ins().GetMyRankIndex(t.id),e>10&&(e=0),o=13==s?CopyProxy.ins().getSYTFloorBySceneId(t.act_params[1]):t.act_params[1],o>i&&(e=0)}else GameLogic.ins().getServerTime()-LimitActProxy.ins().curGetRankTime>5&&LimitActProxy.ins().C2SReqLimitActConsumeRank(1),r=t?t.act_params[0]:0;for(var l=13==this.act_type?LimitActProxy.ins().GetRankDataByAct_id(t.id,!0):LimitActProxy.ins().ActRankList,p=0==e?t.act_award[t.act_award.length-1][1]:e-1,c=0;c<l.length;c++)if(l[c].index==p)if(13==this.act_type){var u=l[c];r=13==s?CopyProxy.ins().getSYTFloorBySceneId(u.value):u.value}else{var u=l[c];r=u.score}var d="";o>i?d=UtilProxy.getStr("|C:7&@1 还差 @0  上榜|",[o-i,n]):p>0&&(d=p==t.act_award.length&&l.length<t.act_award.length?UtilProxy.getStr("|C:7&@1 还差 @0  上榜|",[r-i,n]):UtilProxy.getStr("|C:7&@2 还差 @0  超过第 @1  名|",[r-i,p,n])),this.ranklab.textFlow=UtilProxy.StrFormart("我的排名：@0   @1 ",[0==e?"未上榜":e,d]),this.fightlab.text=UtilProxy.getStr("我的@0 ：@1 ",[n,i]),this.tips.visible=8!=t.reward_type,this.tips.textFlow=UtilProxy.StrFormart("上榜条件：|C:7&@0 达到@1 |",[n,UtilProxy.getfloorNum(o)]),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll();var g=LimitActProxy.ins().GetRankDataByAct_id(t.id);for(var y in g)this.array.addItem(g[y]);this.topinfo.visible&&this.SetTopInfo()}},e.prototype.SetTopInfo=function(){this.model.removeChildren();var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type)[0],e=void 0,i=0,n="积分",o="虚位以待";if(13==this.act_type){var s=GlobalConfig.getRank_typeConfig(t.act_params[0]);e=RankProxy.ins().getRankTopByType(t.act_params[0]),e&&e.value<t.act_params[1]&&(e=void 0);var r=LimitActProxy.ins().getRankRacAwardInfo(1,t);8==t.reward_type&&r&&e&&e.value<r[2][0][0]&&(e=void 0),n=s.labstr,e&&(o=e.name,i=13==t.act_params[0]?CopyProxy.ins().getSYTFloorBySceneId(e.value):e.value)}else e=LimitActProxy.ins().ActRankList[0],e&&(i=e.score,o=UtilProxy.getStr("S@0 .@1 ",[e.server_id,e.name]));if(this.chgroup.visible=t.title_reward>0,t.title_reward>0){var a=GlobalConfig.getTitleById(t.title_reward);this.chenghao.source=TitleProxy.title_icon_path+a.title_res+".png"}if(this.namelab.text=UtilProxy.getStr("@0 ",[o]),e||8!=t.reward_type)this.lab0.textFlow=UtilProxy.StrFormart("|C:10&@0 ：@1 |",[n,UtilProxy.getFightNumLab(i)]);else{var h=LimitActProxy.ins().getRankRacAwardInfo(1,t),l=13==t.act_params[0]?CopyProxy.ins().getSYTFloorBySceneId(h[2][0][0]):h[2][0][0];this.lab0.textFlow=UtilProxy.StrFormart("|C:10&@0 达到@1 |",[n,UtilProxy.getfloorNum(l)])}var p=0,c=0,u=1;if(e){var d=RankProxy.ins().getOtherRoleInfo(e.role_id),g=e.role_id==RoleProxy.ins().getRoleId();if(void 0==d&&!g)return void RankProxy.ins().C2SReqMiscOtherInfo(e.role_id);p=g?GrowupProxy.ins().fashion_wear:d.fashion,c=g?WeaponProxy.ins().getDressId(WeaponType.Weapon):d.shenbing,u=e.prof}this.model.addChild(UtilProxy.GetRoleObjectById(p,0,c,void 0,u)),this.awardarray||(this.awardarray=new eui.ArrayCollection,this.awradlist.dataProvider=this.awardarray),this.awardarray.removeAll();var y=this.getAwardId(1);if(y>0)for(var f=GlobalConfig.getDropConfig(y),_=GlobalConfig.getDropItem(f.drop),v=0;v<_.length;v++){var m=UtilProxy.GetItemCellData(_[v][0].id,_[v][0].num);this.awardarray.addItem(m)}},e.prototype.getAwardId=function(t){for(var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type)[0],i=0;i<e.act_award.length;i++)if(t>=e.act_award[i][0]&&t<=e.act_award[i][1]){if(3==e.reward_type)return e.act_award[i][2];if(8==e.reward_type)return e.act_award[i][2][0][2]}return 0},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(RankRacView.prototype,"RankRacView"),window.RankRacView=RankRacView;var ScoreRankTipItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="ScoreRankItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.rankpic.visible=t.index<4,this.ranklab.visible=t.index>3,this.data.index<=3&&(this.rankpic.source="top_icon_0"+this.data.index),this.ranklab.text=t.index.toString(),this.namelab.text=t?UtilProxy.getStr("S@0 .@1 ",[t.server_id,t.name]):"虚位以待",this.scorelab.textFlow=UtilProxy.StrFormart("积分：|C:10&@0 |",[t?t.score:0])},e}(BaseItemRender);__reflect(ScoreRankTipItem.prototype,"ScoreRankTipItem"),window.ScoreRankTipItem=ScoreRankTipItem;var ScoreRankTipView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ScoreRankTipsSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&活动排名|"),this.list.itemRenderer=ScoreRankTipItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().consume_score,e=LimitActProxy.ins().myActRank;this.lab.text=UtilProxy.getStr("我的积分：@0 ",[t]),this.ranklab.text=UtilProxy.getStr("我的排名：@0 ",[0==e?"未上榜":e.toString()]),this.rank_array||(this.rank_array=new eui.ArrayCollection,this.list.dataProvider=this.rank_array);var i=LimitActProxy.ins().ActRankList,n=GlobalConfig.getActivity_dataConfig(LimitActProxy.ins().OpenRankActId),o=0==e?n.act_award.length:e-1,s=n?n.act_params[0]:0;this.rank_array.removeAll();for(var r=0;r<i.length;r++)this.rank_array.addItem(i[r]),i[r].index==o&&(s=i[r].score);this.tips.visible=o>0,this.tips.textFlow=o==n.act_award.length&&i.length<n.act_award.length?UtilProxy.StrFormart("|C:7&还差 @0  积分上榜|",[s]):UtilProxy.StrFormart("|C:7&还差 @0  积分超过第 @1  名|",[s-t,o])},e}(BaseEuiView);__reflect(ScoreRankTipView.prototype,"ScoreRankTipView"),ViewManager.ins().reg(ScoreRankTipView,LayerManager.UI_Main2),window.ScoreRankTipView=ScoreRankTipView;var SevenDayRankItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="SevenDayRankItemSkin",this.awardlist.itemRenderer=ItemCell},e.prototype.dataChanged=function(){var t=this.data;this.titlepic.source=t.title,this.daylab.text=t.daystr;var e=GlobalConfig.getActivity_dataConfig(t.id);this.bg.visible=e.server_open_time[0]>=LimitActProxy.ins().GetServerOpenDay(),this.statepic.visible=!this.bg.visible,this.statepic.source=e.server_open_time[0]==LimitActProxy.ins().GetServerOpenDay()-1?"qrb_icon_jinxingzhong":"qrb_icon_jiebang",this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry);
var i=LimitActProxy.ins().getRankRacAwardInfo(1,e);if(this.arry.removeAll(),i&&i[2])for(var n=3==e.reward_type?i[2]:i[2][0][2],o=GlobalConfig.getDropConfig(n),s=GlobalConfig.getDropItem(o.drop),r=0;r<s.length;r++){var a=UtilProxy.GetItemCellData(s[r][0].id,s[r][0].num);this.arry.addItem(a)}this.namelab.text=LimitActProxy.ins().GetSevenDayFirstName(t.id),this.timelab.textFlow=UtilProxy.StrFormart("C:7&@0 23：59：59结束",[LimitActProxy.ins().GetOpenSerPassTimeDataStr(e.server_open_time[0])])},e}(BaseItemRender);__reflect(SevenDayRankItem.prototype,"SevenDayRankItem"),window.SevenDayRankItem=SevenDayRankItem;var SevenDayRankView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SevenDayRankSkin",this.list.itemRenderer=SevenDayRankItem,this.timelab.textFlow=UtilProxy.StrFormart("C:7&活动时间：@0 -@1 ",[LimitActProxy.ins().GetOpenSerPassTimeDataStr(0),LimitActProxy.ins().GetOpenSerPassTimeDataStr(6)])},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.closebtn0,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepLimitActGetInfo,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.closebtn0,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetInfo,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFirst_rank_index_dataList(),e=[];for(var i in t)e.push(t[i]);e.sort(this.sortlist),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();for(var i in e)this.arraylist.addItem(e[i])},e.prototype.sortlist=function(t,e){var i=GlobalConfig.getActivity_dataConfig(t.id),n=GlobalConfig.getActivity_dataConfig(e.id);return i.server_open_time[0]<n.server_open_time[0]?-1:i.server_open_time[0]>n.server_open_time[0]?1:0},e}(BaseEuiView);__reflect(SevenDayRankView.prototype,"SevenDayRankView"),ViewManager.ins().reg(SevenDayRankView,LayerManager.UI_Main2),window.SevenDayRankView=SevenDayRankView;var BuyTipsView=function(t){function e(){var e=t.call(this)||this;return e.obj={},e.isTure=!1,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="BuyTips"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.pro,this.onClickPro),this.addTouchEvent(this.closeTips,this.closeView),this.addTouchEvent(this.enterBtn,this.onClick),this.addTouchEvent(this.closeBtn,this.closeView),this.fun=t[1],this.tipsInfo.textFlow=UtilProxy.generateTextFlow(t[0]),this.obj=t[2],t[2]&&t[4]instanceof RelicViewThree&&(this.enterBtnLabel=t[2],this.index=t[3],this.obj=t[4]),this.pro2_select.visible=!1},e.prototype.onClickPro=function(t){this.obj instanceof leizhuViewOne?LeitaiProxy.ins().isTure=this.pro2_select.visible=!this.pro2_select.visible:this.obj instanceof RelicViewThree?RelicProxy.ins().isTuue=this.pro2_select.visible=!this.pro2_select.visible:RelicProxy.ins().isTuueItem=this.pro2_select.visible=!this.pro2_select.visible},Object.defineProperty(e.prototype,"enterBtnLabel",{set:function(t){this.enterBtn.label=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tipsInfoColor",{set:function(t){this.tipsInfo.textColor=t},enumerable:!0,configurable:!0}),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeTips,this.close),this.removeTouchEvent(this.enterBtn,this.onClick),this.removeTouchEvent(this.closeBtn,this.closeView)},e.prototype.closeView=function(t){ViewManager.ins().close(this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClick=function(t){this.fun.call(this.obj,this.index),ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(BuyTipsView.prototype,"BuyTipsView"),ViewManager.ins().reg(BuyTipsView,LayerManager.UI_Popup),window.BuyTipsView=BuyTipsView;var LeitaiEveryDayView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="LeiTaiEveryBagSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_close1,this.closeView),this.addTouchEvent(this.btn_go1,this.onClick),EventProxy.AddListener(this,EventType.S2CLeitaiGetDailyAward,this.stateLibao),this.init()},e.prototype.init=function(){this.initList(),this.stateLibao()},e.prototype.stateLibao=function(){this.hasget.visible=2==LeitaiProxy.ins().daily_award,this.btn_go1.visible=LeitaiProxy.ins().daily_award<2,this.btn_go1.getChildAt(2).visible=1==LeitaiProxy.ins().daily_award},e.prototype.initList=function(){var t=GlobalConfig.getLeitai_misc_dataConfigConfig(1);if(t){this.arr_rank||(this.arr_rank=new eui.ArrayCollection);var e=[];this.list1.itemRenderer=ItemCell;var i=t.daily_award.length;if(i>0)for(var n=0;i>n;n++){var o=Number(t.daily_award[n][0]),s=Number(t.daily_award[n][1]),r=UtilProxy.GetItemCellData(o,s);e.push(r)}this.arr_rank.replaceAll(e),this.list1.dataProvider=this.arr_rank}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close1,this.close),this.removeTouchEvent(this.btn_go1,this.onClick),EventProxy.RemoveListener(this,EventType.S2CLeitaiGetDailyAward,this.stateLibao)},e.prototype.closeView=function(t){ViewManager.ins().close(this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClick=function(t){LeitaiProxy.ins().everyLibaoGetTj()?LeitaiProxy.ins().C2SReqLeitaiGetDailyAward():TipsControl.ins().showTips("领取条件不足!")},e}(BaseEuiView);__reflect(LeitaiEveryDayView.prototype,"LeitaiEveryDayView"),ViewManager.ins().reg(LeitaiEveryDayView,LayerManager.UI_Popup),window.LeitaiEveryDayView=LeitaiEveryDayView;var LeiTaiFuliViewThee=function(){function t(t){this.par=t}return t.prototype.refreshView=function(){if(null!=this.par){var t=GlobalConfig.getLeitai_tequanConfig(1);if(t){this.par.imgIcon.source=TitleProxy.title_icon_path+t.titleid+".png";var e=Number(t.items[0]),i=Number(t.items[1]),n=UtilProxy.GetItemCellData(e,i);this.par.item.data=n,this.showModel(t.zuoqiId),this.showAttr(t.zuoqiId,1),this.showZhanli(t.zhanli)}}},t.prototype.showZhanli=function(t){this.par.txt_fight2.text=t},t.prototype.showModel=function(t){var e=GlobalConfig.getHorse_skin_ex_dataConfig(t);if(e){var i=UtilProxy.getShowImgPath()+e.source;void 0!=this.mov&&this.par.monModel.removeChild(this.mov),this.mov=new egret.MovieClip,UtilProxy.GetMovieClip(i,this.mov,-1,void 0,!0,0,1.5),this.par.monModel.addChildAt(this.mov,1),this.mov.x=e.pos[0],this.mov.y=e.pos[1]}},t.prototype.showAttr=function(t,e){var i=GlobalConfig.getHorseSkinConfig(t);if(i)for(var n=i[e],o=AttrProxy.getAttrInfo(n),s=0;s<o.length;s++)for(var r=0;r<o.length;r++)this.par["name"+r].text=o[r][0],this.par["attr"+r].text="+"+o[r][1]},t}();__reflect(LeiTaiFuliViewThee.prototype,"LeiTaiFuliViewThee"),window.LeiTaiFuliViewThee=LeiTaiFuliViewThee;var LeitaiLastViewTwo=function(){function t(t){this.par=t}return t.prototype.refreshView=function(){null!=this.par&&(this.showList(),this.showName(),this.showRoleModel(),this.btnBlick(LeitaiProxy.ins().mobai_count))},t.prototype.showName=function(){LeitaiProxy.ins().last_guard_info?(this.par.fight0.visible=!0,this.par.laskName.text=LeitaiProxy.ins().last_guard_info.name+"Lv:"+LeitaiProxy.ins().last_guard_info.level,this.par.txt_fight1.text=LeitaiProxy.ins().last_guard_info.fight,this.par.xwld0.visible=this.par.sp_active0.visible=!1):(this.par.laskName.text="",this.par.fight0.visible=!1,this.par.xwld0.visible=this.par.sp_active0.visible=!0)},t.prototype.showList=function(){var t=GlobalConfig.getLeitai_misc_dataConfigConfig(1);if(t){this.arr_rank||(this.arr_rank=new eui.ArrayCollection);var e=[];this.par.itemList.itemRenderer=ItemCell;var i=t.mobai_award.length;if(i>0)for(var n=0;i>n;n++){var o=Number(t.mobai_award[n][0]),s=Number(t.mobai_award[n][1]),r=UtilProxy.GetItemCellData(o,s);e.push(r)}this.arr_rank.replaceAll(e),this.par.itemList.dataProvider=this.arr_rank}},t.prototype.btnBlick=function(t){this.par.mobai.visible=0==t,this.par.ymb.visible=t>0},t.prototype.showRoleModel=function(){if(LeitaiProxy.ins().last_guard_info){this.par.roleModelLask.removeChildren();var t=LeitaiProxy.ins().last_guard_info,e=t.prof,i=t.fashion,n=t.shenbing;this.par.roleModelLask.addChild(UtilProxy.GetRoleObjectById(i,0,n,void 0,e))}},t.prototype.eventClick=function(t){null==LeitaiProxy.ins().last_guard_info?TipsControl.ins().showTips("当前无可膜拜的擂主!"):LeitaiProxy.ins().mobai_count>0?TipsControl.ins().showTips("今日已膜拜,明日再来!"):LeitaiProxy.ins().C2SReqLeitaiMobai()},t}();__reflect(LeitaiLastViewTwo.prototype,"LeitaiLastViewTwo"),window.LeitaiLastViewTwo=LeitaiLastViewTwo;var LeiTaiRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.showInfo()},e.prototype.showInfo=function(){if(this.data){this._dataSouse=this.data,this._dataSouse.rank<=3?(this.rankLb.text="",this.rankImg.source="top_icon_0"+this._dataSouse.rank):(this.rankImg.source="",this.rankLb.text=this._dataSouse.rankname);var t=[];this.list_data||(this.list_data=new eui.ArrayCollection),this.listItem.itemRenderer=ItemCell;var e=this._dataSouse.items.length;if(e>0)for(var i=0;e>i;i++){var n=Number(this._dataSouse.items[i][0]),o=Number(this._dataSouse.items[i][1]),s=UtilProxy.GetItemCellData(n,o);t.push(s)}this.list_data.replaceAll(t),this.listItem.dataProvider=this.list_data}},e}(BaseItemRender);__reflect(LeiTaiRankItem.prototype,"LeiTaiRankItem"),window.LeiTaiRankItem=LeiTaiRankItem;var LeiTaiRankListViewFour=function(){function t(t){this.par=t}return t.prototype.refreshView=function(){if(null!=this.par){var t=GlobalConfig.getLeitai_rank_awardConfigList();if(t){this.par.rankItemList.itemRenderer=LeiTaiRankItem,this.arr_rank||(this.arr_rank=new eui.ArrayCollection),this.arr_rank.removeAll();var e=[];for(var i in t)e.push(t[i]);this.arr_rank.replaceAll(e),this.par.rankItemList.dataProvider=this.arr_rank}}},t}();__reflect(LeiTaiRankListViewFour.prototype,"LeiTaiRankListViewFour");var LeiTaiShouleiItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.showInfo()},e.prototype.showInfo=function(){this.rank.text=this.data.rank,this.nameLb.text=this.data.name,this.time.text=UtilProxy.getHourStrByTime(this.data.time)},e}(BaseItemRender);__reflect(LeiTaiShouleiItem.prototype,"LeiTaiShouleiItem"),window.LeiTaiShouleiItem=LeiTaiShouleiItem;var LeiTaiShouleiRankView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="LeiTaiShouLeiSkin"},e.prototype.showText=function(){this.ShowColdTime(),this.showMyTime(),this.showListItem()},e.prototype.showListItem=function(){if(LeitaiProxy.ins().rankList_cur&&LeitaiProxy.ins().rankList_cur.length>0){this.arr_list||(this.arr_list=new eui.ArrayCollection),this.listRank.itemRenderer=LeiTaiShouleiItem;for(var t=[],e=0;e<LeitaiProxy.ins().rankList_cur.length;e++)t.push(LeitaiProxy.ins().rankList_cur[e]);this.arr_list.replaceAll(t),this.listRank.dataProvider=this.arr_list;for(var i="暂未上榜",n=0,e=0;e<LeitaiProxy.ins().rankList_cur.length;e++)if(LeitaiProxy.ins().rankList_cur[e].role_id===RoleProxy.ins().getRoleId()&&LeitaiProxy.ins().rankList_cur[e].rank<=10){i=LeitaiProxy.ins().rankList_cur[e].rank,n=LeitaiProxy.ins().rankList_cur[e].time;break}this.myrank.text=i,this.myrankTime.text=n>0?UtilProxy.getHourStrByTime(LeitaiProxy.ins().time):"00:00:00"}},e.prototype.showMyTime=function(){this.nameLb.text=""!=LeitaiProxy.ins().name?LeitaiProxy.ins().name:"虚位以待",this.myrankTime.text=LeitaiProxy.ins().time>0?UtilProxy.getHourStrByTime(LeitaiProxy.ins().time):"00:00:00"},e.prototype.ShowColdTime=function(){this.SetTimeLab(),LeitaiProxy.ins().end_time>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this,this.ShowColdTime,this)):(TimerManager.ins().remove(this.SetTimeLab,this),this.actTime.text="暂未开启")},e.prototype.SetTimeLab=function(){this.actTime.text=UtilProxy.getHourStrByTime(LeitaiProxy.ins().end_time-GameLogic.ins().getServerTime())},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closeBtn,this.closleThis),EventProxy.AddListener(this,EventType.S2CLeitaiGetRankList,this.showText),LeitaiProxy.ins().C2SReqLeitaiGetRankList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeBtn,this.closleThis),EventProxy.RemoveListener(this,EventType.S2CLeitaiGetRankList,this.showText),TimerManager.ins().remove(this.SetTimeLab,this)},e.prototype.closleThis=function(){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(LeiTaiShouleiRankView.prototype,"LeiTaiShouleiRankView"),ViewManager.ins().reg(LeiTaiShouleiRankView,LayerManager.UI_Popup),window.LeiTaiShouleiRankView=LeiTaiShouleiRankView;var LeitaiView=function(t){function e(){var e=t.call(this)||this;return e.select=-1,e.selectType=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LeitaiSkin",this.comview.initUI(),this.comview.SetName(UtilProxy.getTitleName("擂台"))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];LeitaiProxy.ins().C2SReqLeitaiGetRankList(),this.comview.open(),this.addTouchEvent(this.sbtns0,this.onClick),this.addTouchEvent(this.sbtns1,this.onClick),this.addTouchEvent(this.sbtns2,this.onClick),this.addTouchEvent(this.sbtns3,this.onClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.addCount,this.onClickOne),this.addTouchEvent(this.tequan,this.onClickOne),this.addTouchEvent(this.rank,this.onClickOne),this.addTouchEvent(this.btn_wen,this.onClickOne),this.addTouchEvent(this.tiaozhan,this.onClickOne),this.addTouchEvent(this.libao,this.onClickOne),this.addTouchEvent(this.mobai,this.onClickTwo),EventProxy.AddListener(this,EventType.S2CLeitaiBuyTimes,this.setBuyTimes),EventProxy.AddListener(this,EventType.S2CLeitaiGetDailyAward,this.stateLibao),EventProxy.AddListener(this,EventType.S2CLeitaiGetInfo,this.changePageAttr),EventProxy.AddListener(this,EventType.S2CLeitaiMobai,this.changeTwoBtn),null==this.leizhuViewOne&&(this.leizhuViewOne=new leizhuViewOne(this)),null==this.LeitaiLastViewTwo&&(this.LeitaiLastViewTwo=new LeitaiLastViewTwo(this)),null==this.LeiTaiFuliViewThee&&(this.LeiTaiFuliViewThee=new LeiTaiFuliViewThee(this)),null==this.LeiTaiRankListViewFour&&(this.LeiTaiRankListViewFour=new LeiTaiRankListViewFour(this)),t&&t.length>0?this.changePageTap(t[0]):(this.selectType=1,this.initPage())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.sbtns0,this.onClick),this.removeTouchEvent(this.sbtns1,this.onClick),this.removeTouchEvent(this.sbtns2,this.onClick),this.removeTouchEvent(this.sbtns3,this.onClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.addCount,this.onClickOne),this.removeTouchEvent(this.tequan,this.onClickOne),this.removeTouchEvent(this.rank,this.onClickOne),this.removeTouchEvent(this.tiaozhan,this.onClickOne),this.removeTouchEvent(this.libao,this.onClickOne),this.removeTouchEvent(this.mobai,this.onClickTwo),this.removeTouchEvent(this.btn_wen,this.onClickOne),EventProxy.RemoveListener(this,EventType.S2CLeitaiBuyTimes,this.setBuyTimes),EventProxy.RemoveListener(this,EventType.S2CLeitaiGetDailyAward,this.stateLibao),EventProxy.RemoveListener(this,EventType.S2CLeitaiGetInfo,this.changePageAttr),EventProxy.RemoveListener(this,EventType.S2CLeitaiMobai,this.changeTwoBtn)},e.prototype.changeTwoBtn=function(){this.LeitaiLastViewTwo&&this.LeitaiLastViewTwo.btnBlick(LeitaiProxy.ins().mobai_count)},e.prototype.onClickOne=function(t){this.leizhuViewOne&&this.leizhuViewOne.eventClick(t)},e.prototype.onClickTwo=function(t){this.LeitaiLastViewTwo&&this.LeitaiLastViewTwo.eventClick(t)},e.prototype.stateLibao=function(){this.leizhuViewOne.redShow()},e.prototype.setBuyTimes=function(){this.leizhuViewOne.showCountTxt()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.updateInfo=function(){null!=this.leizhuViewOne&&this.leizhuViewOne.refreshView()},e.prototype.initPage=function(){this.select>1&&(this.selectType=this.select),this.changePage()},e.prototype.onClick=function(t){var e=-1;switch(t.currentTarget){case this.sbtns0:e=1;break;case this.sbtns1:e=2;break;case this.sbtns2:e=3;break;case this.sbtns3:e=4}this.selectType=e,this.changePage()},e.prototype.changePage=function(){this.ltZbGroup.visible=1==this.selectType,this.laskGroup.visible=2==this.selectType,this.tequanGroup.visible=3==this.selectType,this.rankList.visible=4==this.selectType,this.changePageAttr()},e.prototype.changePageAttr=function(){1==this.selectType&&null!=this.leizhuViewOne?this.leizhuViewOne.refreshView():4==this.selectType&&null!=this.LeiTaiRankListViewFour?this.LeiTaiRankListViewFour.refreshView():3==this.selectType&&null!=this.LeiTaiFuliViewThee?this.LeiTaiFuliViewThee.refreshView():2==this.selectType&&null!=this.LeitaiLastViewTwo&&this.LeitaiLastViewTwo.refreshView()},e.prototype.changePageTap=function(t){this.select=t,this.initPage()},e}(BaseEuiView);__reflect(LeitaiView.prototype,"LeitaiView"),ViewManager.ins().reg(LeitaiView,LayerManager.UI_Main),window.LeitaiView=LeitaiView;var leizhuViewOne=function(){function t(t){this.setTime=0,this.par=t}return t.prototype.refreshView=function(){null!=this.par&&(this.showCountTxt(),this.showKeeper(),this.redShow(),this.showLaskHeadAndName())},t.prototype.redShow=function(){this.par.libaored.visible=1==LeitaiProxy.ins().daily_award},t.prototype.showKeeper=function(){LeitaiProxy.ins().is_guard&&LeitaiProxy.ins().cur_guard_info?(this.par.LzName.text=LeitaiProxy.ins().cur_guard_info.name+" Lv:"+LeitaiProxy.ins().cur_guard_info.level,this.par.txt_fight0.text=LeitaiProxy.ins().cur_guard_info.fight,this.par.xueBar.maximum=LeitaiProxy.ins().cur_guard_info.max_hp,this.par.xueBar.value=LeitaiProxy.ins().cur_guard_info.cur_hp,this.showRoleModel(),this.ShowColdTime(),LeitaiProxy.ins().leizhuNowTime()>LeitaiProxy.ins().guard_time?this.setTime=LeitaiProxy.ins().leizhuNowTime():this.setTime=LeitaiProxy.ins().guard_time,LeitaiProxy.ins().is_rest?this.par.slTime.text="守擂时间: 暂无":(this.SetOtherLbTime(),this.showOtherTime()),this.par.xwld.visible=this.par.sp_active.visible=!1):(this.par.LzName.text=this.par.slTime.text=this.par.syTime.text="",this.par.xwld.visible=this.par.sp_active.visible=!0),LeitaiProxy.ins().is_rest?(TimerManager.ins().remove(this.SetOtherLbTime,this),this.par.xiusai.text="休战期不可挑战,不计算守擂时间"+LeitaiProxy.ins().getXiuSaiTime()):this.par.xiusai.text="",this.par.xueLb.visible=this.par.fight.visible=this.par.lbtitle.visible=this.par.xueBar.visible=LeitaiProxy.ins().is_guard,this.par.tiaozhan.visible=!LeitaiProxy.ins().is_rest,this.par.addCount.visible=this.par.mian.visible=this.par.Tzcount.visible=!LeitaiProxy.ins().is_rest},t.prototype.showLaskHeadAndName=function(){LeitaiProxy.ins().last_guard_info&&LeitaiProxy.ins().last_guard_info.prof>0?(this.par.headImg.source="common_morentouxaing_0"+LeitaiProxy.ins().last_guard_info.prof,this.par.sjLzName.text=LeitaiProxy.ins().last_guard_info.name,this.par.noLei.text=""):(this.par.headImg.source="",this.par.sjLzName.text="",this.par.noLei.text="暂无")},t.prototype.showOtherTime=function(){this.SetOtherLbTime(),LeitaiProxy.ins().end_time>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetOtherLbTime,this),TimerManager.ins().doTimer(1e3,0,this.SetOtherLbTime,this,this.showOtherTime,this)):(TimerManager.ins().remove(this.SetOtherLbTime,this),this.par.slTime.text="")},t.prototype.SetOtherLbTime=function(){this.par.slTime.text="守擂时间:"+UtilProxy.getHourStrByTime(this.setTime),this.setTime+=1},t.prototype.showRoleModel=function(){if(LeitaiProxy.ins().is_guard&&LeitaiProxy.ins().cur_guard_info){this.par.roleModel.removeChildren();var t=LeitaiProxy.ins().cur_guard_info,e=t.prof,i=t.fashion,n=t.shenbing;this.par.roleModel.addChild(UtilProxy.GetRoleObjectById(i,0,n,void 0,e))}},t.prototype.showCountTxt=function(){this.par.Tzcount.text=LeitaiProxy.ins().remain_times+"/"+LeitaiProxy.ins().getDateConfigCount(LeiTaiEmm.MAXMIANFEI)},t.prototype.ShowColdTime=function(){this.SetTimeLab(),LeitaiProxy.ins().end_time>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this,this.ShowColdTime,this)):(TimerManager.ins().remove(this.SetTimeLab,this),this.par.syTime.text="")},t.prototype.SetTimeLab=function(){this.par.syTime.text=UtilProxy.getHourStrByTime(LeitaiProxy.ins().end_time-GameLogic.ins().getServerTime())},t.prototype.buyTips=function(){if(LeitaiProxy.ins().isTure)LeitaiProxy.ins().C2SReqLeitaiBuyTimes(1);else{var t=LeitaiProxy.ins().getDataConfig();if(t){var e=t.cost_money[0],i=t.cost_money[1],n="是否花费|C:7&"+i+LeitaiProxy.ins().getModelType(e)+"|购买1次";ViewManager.ins().open(BuyTipsView,n,this.onEnterBtn,this)}}},t.prototype.onEnterBtn=function(){LeitaiProxy.ins().C2SReqLeitaiBuyTimes(1)},t.prototype.eventClick=function(t){switch(t.target){case this.par.addCount:LeitaiProxy.ins().getBuyCountMax()?TipsControl.ins().showTips("购买次数已达最大，无法继续购买"):LeitaiProxy.ins().getIsCanBuyCount()?this.buyTips():TipsControl.ins().showTips("挑战次数已达最大，无法继续购买");break;case this.par.tiaozhan:LeitaiProxy.ins().getIsSelf()?TipsControl.ins().showTips("不能挑战自己"):LeitaiProxy.ins().getIsCanBuyDareCount()?TipsControl.ins().showTips("挑战次数不足请购买！"):LeitaiProxy.ins().getMaxDareCountState()?TipsControl.ins().showTips("今日已达最大挑战次数！"):LeitaiProxy.ins().getIsOpen()?LeitaiProxy.ins().C2SReqLeitaiStartChallenge():TipsControl.ins().showTips("当前是休赛期！");break;case this.par.rank:ViewManager.ins().open(LeiTaiShouleiRankView);break;case this.par.libao:ViewManager.ins().open(LeitaiEveryDayView);break;case this.par.tequan:this.par.changePageTap(3);break;case this.par.btn_wen:ViewManager.ins().open(RefineTips,2)}},t}();__reflect(leizhuViewOne.prototype,"leizhuViewOne");var LgBtn=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"vip",{set:function(t){this.lb_vip.text=t},enumerable:!0,configurable:!0}),e.prototype.setVipDisplay=function(t){this.g_vip.visible=t},e}(eui.Button);__reflect(LgBtn.prototype,"LgBtn"),window.LgBtn=LgBtn;var LimitGiftView=function(t){function e(){var e=t.call(this)||this;return e.pageBtns=[],e.currPageIndex=0,e.currGiftList=[],e.skinName="LimitGiftViewSkin",e}return __extends(e,t),e.prototype.S2CRepLimitActBuySmGift=function(){for(var t=this.currGiftList[this.currPageIndex],e=GlobalConfig.getDropItem(GlobalConfig.getDropConfig(t.reward_id).drop),i=[],n=0;n<e.length;n++){var o=UtilProxy.GetItemCellData(e[n][0].id,e[n][0].num);i.push(o)}TipsControl.ins().showReward(i),this.refreshList()},e.prototype.S2CRepLimitActSmGiftAppear=function(){this.refreshList()},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=ItemCell,this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.currPageIndex=0,this.refreshList(),this.addTouchEvent(this.btn_close,this.onCloseClick),this.addTouchEvent(this.btn_buy,this.onBuyClick),EventProxy.AddListener(this,EventType.S2CRepLimitActBuySmGift,this.S2CRepLimitActBuySmGift),EventProxy.AddListener(this,EventType.S2CRepLimitActSmGiftAppear,this.S2CRepLimitActSmGiftAppear)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerManager.ins().remove(this.showTimer,this),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuySmGift,this.S2CRepLimitActBuySmGift),EventProxy.RemoveListener(this,EventType.S2CRepLimitActSmGiftAppear,this.S2CRepLimitActSmGiftAppear)},e.prototype.onCloseClick=function(){ViewManager.ins().close(e)},e.prototype.onBuyClick=function(){return RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)<this.currGiftList[this.currPageIndex].limit?(this.currGiftList[this.currPageIndex].limit>18?TipsControl.ins().showTips("SVIP"+(this.currGiftList[this.currPageIndex].limit-18)+"才可以购买"):TipsControl.ins().showTips("VIP"+this.currGiftList[this.currPageIndex].limit+"才可以购买"),void(void 0!=this.currGiftList[this.currPageIndex].promote_tips&&""!=this.currGiftList[this.currPageIndex].promote_tips&&ViewManager.ins().open(ItemVIPTipsView,this.currGiftList[this.currPageIndex].limit,this.currGiftList[this.currPageIndex].promote_tips))):RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<this.currGiftList[this.currPageIndex].buy_cost[1]?void TipsControl.ins().showTips("元宝不足"):void LimitActProxy.ins().C2SReqLimitActBuySmGift(this.currGiftList[this.currPageIndex].id)},e.prototype.onPageClick=function(t){var e=this.pageBtns.indexOf(t.currentTarget);-1!=e&&e!=this.currPageIndex&&(TimerManager.ins().remove(this.showTimer,this),this.currPageIndex=e,this.showInfo())},e.prototype.refreshList=function(){TimerManager.ins().remove(this.showTimer,this);var t=LimitActProxy.ins().getSmGiftList();if(void 0==t||t.length<=0)return void TimerManager.ins().doNext(function(){ViewManager.ins().close(e)},this);this.currGiftList=[];for(var i=0;i<t.length;i++)this.currGiftList.push(GlobalConfig.getSmGiftListConfig(t[i].gift_id));this.currPageIndex>=t.length&&(this.currPageIndex=t.length-1),this.initPageBtn(),this.showInfo()},e.prototype.initPageBtn=function(){this.g_page.removeChildren(),this.pageBtns=[];for(var t=0;t<this.currGiftList.length;t++){var e=new LingYuanButton;e.icon="xianshitehui_yeqian_01",e.label=this.currGiftList[t].title,this.pageBtns.push(e),this.g_page.addChild(e),this.addTouchEvent(e,this.onPageClick)}},e.prototype.showInfo=function(){for(var t=0;t<this.pageBtns.length;t++)this.pageBtns[t].icon=t==this.currPageIndex?"xianshitehui_yeqian_02":"xianshitehui_yeqian_01";var e=this.currGiftList[this.currPageIndex],i=GlobalConfig.getDropItem(GlobalConfig.getDropConfig(e.reward_id).drop);this.arraylist.removeAll();for(var t=0;t<i.length;t++){var n=UtilProxy.GetItemCellData(i[t][0].id,i[t][0].num);this.arraylist.addItem(n)}this.img_title.source=e.title_icon,this.btn_buy.vip="VIP"+e.limit,0==e.limit&&this.btn_buy.setVipDisplay(!1),this.lb_money.textFlow=UtilProxy.generateTextFlow("|C:5&"+e.buy_cost[1]+"|"),this.showTimer(),TimerManager.ins().doTimer(1e3,0,this.showTimer,this)},e.prototype.showTimer=function(){var t=LimitActProxy.ins().getSmGift(this.currGiftList[this.currPageIndex].id);if(void 0==t)return void this.refreshList();var e=t.end_time-GameLogic.ins().getServerTime();if(0>e)return void this.refreshList();var i=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_3);this.lb_time.textFlow=UtilProxy.generateTextFlow("限时: |C:7&"+i.substring(0,i.length-1)+"|")},e}(BaseEuiView);__reflect(LimitGiftView.prototype,"LimitGiftView"),ViewManager.ins().reg(LimitGiftView,LayerManager.UI_Main2),window.LimitGiftView=LimitGiftView;var LingYuanButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/LingYuan/LingYuanBtnSkin.exml",e.setRed(!1),e.setBuy(!1),e}return __extends(e,t),e.prototype.setRed=function(t){this.red.visible=t},e.prototype.setBuy=function(t){this.img_buy.visible=t},e}(eui.Button);__reflect(LingYuanButton.prototype,"LingYuanButton");var LingYuanView=function(t){function e(){var e=t.call(this)||this;return e.btnArray=[],e.limitScrollerWidth=350,e.curindex=0,e.giftState=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LingYuanSkin",this.list.itemRenderer=ItemCell,this.giftList=WelfareProxy.ins().getfreeGiftInfoList()},e.prototype.initBtn=function(){this.cfs=[];var t=WelfareProxy.ins().getHasFreeGift();if(t.length<=0)return ViewManager.ins().getView(MainUIView).setFreeGiftIcon(),void ViewManager.ins().close(this);for(var e=t.length-1;e>=0;e--)this.cfs.push(t[e]);this.cfs.sort(this.sort),this.gifBtns_g.removeChildren(),this.btnArray=[],this.red.visible=!1;for(var e=0;void 0!=this.cfs[e];e++){var i=new LingYuanButton;i.iconDisplay.source="xianshichongzhi__btn_02",i.labelDisplay.text=this.cfs[e].name,this.btnArray.push(i),this.gifBtns_g.addChild(i)}this.r_Scroller.width>this.limitScrollerWidth&&(this.r_Scroller.width=this.limitScrollerWidth),this.btn_close.anchorOffsetX=this.btn_close.width>>1,this.btn_close.anchorOffsetY=this.btn_close.height>>1,this.btn_sure.anchorOffsetY=this.btn_sure.height>>1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.titleImgArr=[],this.titleImgArr.push(this.title_g.getChildAt(0)),this.titleImgArr.push(this.title_g.getChildAt(1).getChildAt(0)),this.initBtn(),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.btnEff,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.btnEff,this),this.addTouchEvent(this.btn_sure,this.onClickSure),this.addTouchEvent(this.btn_close,this.onClickClose),this.addTouchEvent(this.getChildAt(0),this.onClickClose);for(var i=0;i<this.btnArray.length;i++)this.addTouchEvent(this.btnArray[i],this.onClickListBtn);EventProxy.AddListener(this,EventType.S2CRspWelfareFreegiftBuy,this.S2CRspWelfareFreegiftBuy),EventProxy.AddListener(this,EventType.S2CRspWelfareFreegiftGetAward,this.S2CRspWelfareFreegiftGetAward),this.curindex=0,void 0==this.curbtn&&this.btnArray.length>0&&(this.curbtn=this.btnArray[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",this.showGift())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRspWelfareFreegiftBuy,this.S2CRspWelfareFreegiftBuy),EventProxy.RemoveListener(this,EventType.S2CRspWelfareFreegiftGetAward,this.S2CRspWelfareFreegiftGetAward)},e.prototype.onClickClose=function(t){ViewManager.ins().close(this)},e.prototype.onClickSure=function(){switch(this.giftState){case 0:WelfareProxy.ins().C2SReqWelfareFreegiftBuy(this.cfs[this.curindex].id);break;case 2:WelfareProxy.ins().C2SReqWelfareFreegiftGetAward(this.cfs[this.curindex].id)}},e.prototype.onClickListBtn=function(t){t.currentTarget!=this.curbtn&&(this.curindex=this.btnArray.indexOf(t.currentTarget),void 0!=this.curbtn&&(this.curbtn.icon="xianshichongzhi__btn_02"),this.curbtn=this.btnArray[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",TimerManager.ins().removeAll(this),this.showGift())},e.prototype.btnEff=function(t){function e(){i.scaleX=i.scaleY=1}var i=t.currentTarget,n=!0;switch(i){case this.btn_sure:this.red.visible=!1,this.btn_sure.scaleX=this.btn_sure.scaleY=.9;break;case this.btn_close:this.btn_close.scaleX=this.btn_close.scaleY=.9;break;default:n=!1}n&&this.once(egret.TouchEvent.TOUCH_END,e,this)},e.prototype.sort=function(t,e){var i=0,n=0,o=void 0,s=void 0,r=WelfareProxy.ins().getfreeGiftInfoList();if(r.length>0)for(var a=0;a<r.length;a++)r[a].type==t.id&&(o=r[a]),r[a].type==e.id&&(s=r[a]);return void 0!=o&&(i=GameLogic.ins().getServerTime()-o.buy_time>=t.time?1:-1),void 0!=s&&(n=GameLogic.ins().getServerTime()-s.buy_time>=e.time?1:-1),i-n>0?-1:0>i-n?1:0},e.prototype.showGift=function(){function t(){CommonUtils.log(l.giftList),l.lb_timer.text="可领取",l.giftState=2,l.btn_sure.source="lingyuanlibao_btn",l.red.visible=!0,UtilProxy.SetAshColor(l.btn_sure,!1)}function e(t){l.lb_timer.text=t+"后领取",l.giftState=1,l.btn_sure.source="lingyuanlibao_btn",l.red.visible=!1,UtilProxy.SetAshColor(l.btn_sure,!0)
}var i=this;this.cfs=[];var n=WelfareProxy.ins().getHasFreeGift();if(n.length<=0)return ViewManager.ins().getView(MainUIView).setFreeGiftIcon(),void ViewManager.ins().close(this);for(var o=n.length-1;o>=0;o--)this.cfs.push(n[o]);this.cfs.sort(this.sort);for(var o=0;o<this.cfs.length;o++)for(var s=0;s<this.giftList.length;s++)this.giftList[s].type==this.cfs[o].id&&(this.btnArray[o].setBuy(!0),GameLogic.ins().getServerTime()-this.giftList[s].buy_time>this.cfs[o].time&&this.btnArray[o].setRed(!0));this.bl_backtime.text=MathUtils.toInteger(this.cfs[this.curindex].time/DateUtils.MS_PER_DAY*1e3).toString(),this.bl_buy.text=this.bl_buy2.text=this.cfs[this.curindex].money[1].toString(),this.lb_backAward.text=this.cfs[this.curindex].back_award[1].toString();for(var o=0;o<this.titleImgArr.length;o++)this.titleImgArr[o].source=this.cfs[this.curindex].title_res[o];switch(this.effect.removeChildren(),this.effect.x=this.cfs[this.curindex].charRes_wuqi[2],this.effect.y=this.cfs[this.curindex].charRes_wuqi[3],this.cfs[this.curindex].charRes_wuqi[0]){case 1:var r=new eui.Image(this.cfs[this.curindex].charRes_wuqi[1]),a=UtilProxy.GetMovieClipById(101,this.effect);this.effect.addChild(r),a.x=80-this.effect.x,a.y=60-this.effect.y;break;case 2:var h=new egret.MovieClip;UtilProxy.GetMovieClip(this.cfs[this.curindex].charRes_wuqi[1],h,-1,void 0),this.effect.addChild(h);break;case 3:UtilProxy.GetMovieClipById(Number(this.cfs[this.curindex].charRes_wuqi[1]),this.effect)}this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();for(var l=this,o=0;o<this.cfs[this.curindex].award.length;o++){var p=UtilProxy.GetItemCellData(this.cfs[this.curindex].award[o][0],this.cfs[this.curindex].award[o][1]);this.arraylist.addItem(p),0==o&&(this.lb_JackpotName.text=p.itemConfig.name)}for(var c=void 0,s=0;this.giftList[s];s++)if(this.giftList[s].type==this.cfs[this.curindex].id){c=this.giftList[s];break}if(void 0==c)this.giftState=0,this.btn_sure.source="lingyuanlibao_btn_2",l.red.visible=!1,UtilProxy.SetAshColor(this.btn_sure,!1),this.lb_timer.text="";else if(void 0!=this.showTimer(c)){var u=this.showTimer(c);"ok"==u?t():(e(u),TimerManager.ins().doTimer(1e3,0,function(){"ok"==i.showTimer(c)?t():e(i.showTimer(c))},this))}},e.prototype.showTimer=function(t){var e=this.cfs[this.curindex].time-GameLogic.ins().getServerTime()+t.buy_time;if(e>0){var i=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_2);return e>DateUtils.MS_PER_DAY/1e3?i=i.split("时")[0]+"小时":e>DateUtils.SECOND_PER_HOUR?i=i.split("天")[1].split("分")[0]+"分":e>DateUtils.SECOND_PER_MIN?i=i.split("时")[1]:i}return"ok"},e.prototype.S2CRspWelfareFreegiftBuy=function(){this.giftList=WelfareProxy.ins().getfreeGiftInfoList();for(var t=[],e=0;e<this.cfs[this.curindex].award.length;e++){var i=UtilProxy.GetItemCellData(this.cfs[this.curindex].award[e][0],this.cfs[this.curindex].award[e][1]);t.push(i)}TipsControl.ins().showReward(t),this.initBtn();for(var e=0;e<this.btnArray.length;e++)this.addTouchEvent(this.btnArray[e],this.onClickListBtn);this.curindex=0,this.btnArray.length>0&&(this.curbtn=this.btnArray[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",this.showGift())},e.prototype.S2CRspWelfareFreegiftGetAward=function(){this.giftList=WelfareProxy.ins().getfreeGiftInfoList();var t=UtilProxy.GetItemCellData(this.cfs[this.curindex].back_award[0],this.cfs[this.curindex].back_award[1]);TipsControl.ins().showReward([t]),this.initBtn();for(var e=0;e<this.btnArray.length;e++)this.addTouchEvent(this.btnArray[e],this.onClickListBtn);this.curindex=0,this.btnArray.length>0&&(this.curbtn=this.btnArray[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",this.showGift())},e}(BaseEuiView);__reflect(LingYuanView.prototype,"LingYuanView"),ViewManager.ins().reg(LingYuanView,LayerManager.UI_Main2),window.LingYuanView=LingYuanView;var LotteryRankItem=function(t){function e(e,i){void 0===i&&(i=void 0);var n=t.call(this)||this;return n.awardId=0,n.skinName="LotteryRankItemSkin",n.cf=i,n.rankNum=e[0],n.awardId=e[2],n.list.itemRenderer=ItemCell,n.show(),n}return __extends(e,t),Object.defineProperty(e.prototype,"firstToThird",{get:function(){return["top_icon_01","top_icon_02","top_icon_03"]},enumerable:!0,configurable:!0}),e.prototype.show=function(){this.rankNum>3?this.lab_No.textFlow=UtilProxy.generateTextFlow("|C:5&"+this.rankNum+"|"):(this.lab_No.visible=!1,this.icon_No.source="top_icon_0"+this.rankNum,this.icon_No.scaleX=this.icon_No.scaleY=.8),this.cf?(this.lab_score.text=(2==LimitActProxy.ins().curShowRankType?"财富值: ":"转盘积分: ")+this.cf.score,this.lab_name.textFlow=UtilProxy.generateTextFlow("|C:5&S"+this.cf.server_id+"."+this.cf.name+"|")):(this.lab_score.text=2==LimitActProxy.ins().curShowRankType?"财富值: 0":"转盘积分: 0",this.lab_name.textFlow=UtilProxy.generateTextFlow("|C:5&虚位以待|"));var t=new eui.ArrayCollection;this.list.dataProvider=t;var e=GlobalConfig.getDropItem(GlobalConfig.getDropConfig(this.awardId).drop);for(var i in e){var n=UtilProxy.GetItemCellData(e[i][0].id,e[i][0].num);t.addItem(n)}},e}(eui.Component);__reflect(LotteryRankItem.prototype,"LotteryRankItem"),window.LotteryRankItem=LotteryRankItem;var LotteryRankView=function(t){function e(){var e=t.call(this)||this;return e.act_id=0,e.rank_score=0,e.skinName="LotteryRankSkin",e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]&&(this.act_id=t[0]),EventProxy.AddListener(this,EventType.S2CRepLimitActConsumeRank,this.showInfo),this.addTouchEvent(this.btn_close,this.onClickClose),this.title.text="转盘积分榜",LimitActProxy.ins().curShowRankType=3,this.showInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActConsumeRank,this.showInfo),this.removeTouchEvent(this.btn_close,this.onClickClose)},e.prototype.onClickClose=function(){ViewManager.ins().close(this)},e.prototype.showInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(36);this.rank_score=t[0]?t[0].act_params[0]:0,GameLogic.ins().getServerTime()-LimitActProxy.ins().curGetRankTime>5&&LimitActProxy.ins().C2SReqLimitActConsumeRank(3);var e=LimitActProxy.ins().getMyCrossScore(36);this.lb_myScore.textFlow=UtilProxy.generateTextFlow("|C:5&我的积分:| |C:7&"+e+"|"+(e<this.rank_score?"("+(this.rank_score-e)+"分可上榜)":"")),this.lb_myRank.textFlow=UtilProxy.generateTextFlow("|C:5&我的排名:| "+(0==LimitActProxy.ins().myLotteryRank?"未上榜":LimitActProxy.ins().myLotteryRank));var i=LimitActProxy.ins().lotteryRank_list,n=0==LimitActProxy.ins().myLotteryRank?i[i.length]:1!=LimitActProxy.ins().myLotteryRank?function(){for(var t=0;t<i.length;t++)if(LimitActProxy.ins().myLotteryRank-1==i[t].index)return i[t]}():void 0;this.lb_myTip.textFlow=UtilProxy.generateTextFlow(void 0!=n?"|C:5&离第|"+n.index+"|C:5&名还差"+(n.score-e)+"积分|":"");var o=t[0];if(void 0!=o){var s=o.act_award;this.g_item.removeChildren();for(var r=0;r<s.length;r++)if(r<i.length){var a=new LotteryRankItem(s[i[r].index-1],i[r]);this.g_item.addChild(a)}else{var h=new LotteryRankItem(s[r]);this.g_item.addChild(h)}}},e}(BaseEuiView);__reflect(LotteryRankView.prototype,"LotteryRankView"),ViewManager.ins().reg(LotteryRankView,LayerManager.UI_Main2),window.LotteryRankView=LotteryRankView;var LotteryView=function(t){function e(){var e=t.call(this)||this;return e.act_type=30,e.sub_type=1,e.endtime=0,e.skinName="LotteryViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.infos=[this.info0,this.info1,this.info2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length>=2&&(this.act_type=t[0],this.sub_type=t[1]),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetJackpot,this.showScore),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.TakeCallBack),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.SetBoxCountInfo),this.addTouchEvent(this.btn_close,this.onClickClose),this.addTouchEvent(this.btn_one,this.onClick),this.addTouchEvent(this.btn_five,this.onClick),this.addTouchEvent(this.btn_rank,this.onClick),this.ShowInfo(),LimitActProxy.ins().C2SReqLimitActLotteryInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetJackpot,this.showScore),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.TakeCallBack),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.SetBoxCountInfo),this.removeTouchEvent(this.btn_close,this.onClickClose),this.removeTouchEvent(this.btn_one,this.onClick),this.removeTouchEvent(this.btn_five,this.onClick),this.removeTouchEvent(this.btn_rank,this.onClick),TimerManager.ins().remove(this.SetTimeLab,this),this.ResetTween(),LimitActProxy.ins().CurSelectType=0},e.prototype.onClickClose=function(){ViewManager.ins().close(this)},e.prototype.onClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),i=e[0];if(void 0!=i)switch(t.currentTarget){case this.btn_one:this.OnTakeBtn(1);break;case this.btn_five:this.OnTakeBtn(5);break;case this.btn_rank:ViewManager.ins().open(LotteryRankView,this.act_id2)}},e.prototype.OnTakeBtn=function(t){var e=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),i=e[0];if(void 0!=i){var n=GlobalConfig.getLottery_base_dataConfig(1),o=LimitActProxy.ins().GetTrunActBoxAward(1,i.id),s=0;return s=o?Math.floor(LimitActProxy.ins().recharge_num/o.take_need):Math.floor(LimitActProxy.ins().recharge_num/n.recharge_need),t>s?void TipsControl.ins().showTips("抽奖次数不足"):void LimitActProxy.ins().C2SReqLimitActLotteryTake(1,t,i.id)}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){var i=LimitActProxy.ins().GetActivityCfgs(36);if(void 0!=i[0]){this.act_id=e.id,this.act_id2=i[0].id,this.endtime=LimitActProxy.ins().GetActEndTime(e),this.ShowColdTime(),this.showScore(),this.showEff(),this.SetBoxCountInfo(),this.ShowStoryView(1,e.id);for(var n=LimitActProxy.ins().GetTrunActItemList(1,e.id),o=1;o<=this.items.numChildren;o++)n[o]&&this.SetItemInfo(n[o],this.items.getChildAt(o-1))}}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.lab_timer.text=""},e.prototype.SetTimeLab=function(){this.lab_timer.textFlow=UtilProxy.StrFormart("倒计时：\n|C:7&@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.showScore=function(){for(var t=LimitActProxy.ins().getJackpotScore(36).toString(),e=7-t.length;e>=0;e--)t="0"+t;this.blab_score.text=t},e.prototype.showEff=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){if(e.charRes_wuqi.length<4)return void(this.lab_jackpot.parent.visible=!1);switch(this.lab_jackpot.parent.visible=!0,this.lab_jackpot.text=e.btn_title,this.g_effect.removeChildren(),this.g_effect.x=e.charRes_wuqi[2],this.g_effect.y=e.charRes_wuqi[3],e.charRes_wuqi[0]){case 1:var i=new eui.Image(e.charRes_wuqi[1]),n=UtilProxy.GetMovieClipById(101,this.g_effect);this.g_effect.addChild(i),n.x=80-this.g_effect.x,n.y=60-this.g_effect.y;break;case 2:var o=new egret.MovieClip;UtilProxy.GetMovieClip(e.charRes_wuqi[1],o,-1,void 0),this.g_effect.addChild(o);break;case 3:UtilProxy.GetMovieClipById(Number(e.charRes_wuqi[1]),this.g_effect)}}},e.prototype.ShowStoryView=function(t,e){for(var i=LimitActProxy.ins().recharge_list,n=0;n<this.infos.length;n++)if(i[n]){var o=LimitActProxy.ins().GetTrunActItem(t,e,i[n].id);this.infos[n].textFlow=UtilProxy.generateTextFlow("|C:6&S"+RoleProxy.ins().getRoleServerId()+" ."+i[n].name+" |获得|C:10&"+BagProxy.ins().getItemName(o.item_id)+" *"+o.item_num+" |")}else this.infos[n].text=""},e.prototype.SetItemInfo=function(t,e){if(void 0!=t){var i=e.getChildAt(0),n=UtilProxy.GetItemCellData(t.item_id,t.item_num);i.data=n,e.getChildAt(1).visible=t.is_precious>0;var o=e.getChildAt(2);o.visible=t.is_precious>0,t.is_precious>0&&(o.source="jingcaihuodong_bg_jiaobiao0"+t.is_precious)}},e.prototype.TakeCallBack=function(){this.SetBoxCountInfo(),this.StarRotation(),LimitActProxy.ins().C2SReqLimitActLotteryInfo()},e.prototype.SetBoxCountInfo=function(){var t=GlobalConfig.getLottery_base_dataConfig(1),e=0,i=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),n=i[0];if(void 0!=n){var o=LimitActProxy.ins().GetTrunActBoxAward(1,n.id),s=LimitActProxy.ins().GetActivityData(LimitActProxy.ins().GetActivityCfgs(2,2)[0].id),r=s.params[0]||0;o?(e=Math.floor(LimitActProxy.ins().recharge_num/o.take_need),this.lab_countTip.textFlow=UtilProxy.generateTextFlow("再充值|C:5&"+(o.take_need-LimitActProxy.ins().recharge_num%o.take_need)+"|元宝送|C:7&1|次抽奖（已充值:|C:7&"+r+"|元宝）")):(e=Math.floor(LimitActProxy.ins().recharge_num/t.recharge_need),this.lab_countTip.textFlow=UtilProxy.generateTextFlow("再充值|C:5&"+(t.recharge_need-LimitActProxy.ins().recharge_num%t.recharge_need)+"|元宝送|C:7&1|次抽奖（已充值:|C:7&"+r+"|元宝）")),this.lab_count.textFlow=UtilProxy.StrFormart("剩余抽奖次数:|C:7&@0 |",[e])}},e.prototype.StarRotation=function(){this.ResetTween();var t=1;for(var e in LimitActProxy.ins().trun_ids)t=Math.max(t,LimitActProxy.ins().trun_ids[e]);var i=720+36*(t-1),n=2e3;this.cb_anim.selected&&(n=0),egret.Tween.get(this.center).to({rotation:i},n,egret.Ease.sineOut),egret.Tween.get(this.center1).to({rotation:i},n,egret.Ease.sineOut).call(this.ShowItemList,this)},e.prototype.ShowItemList=function(){var t=LimitActProxy.ins().GetActivityCfgs(this.act_type,this.sub_type),e=t[0];if(void 0!=e){for(var i=[],n=0;n<LimitActProxy.ins().trun_ids.length;++n){var o=LimitActProxy.ins().GetTrunActItem(1,e.id,LimitActProxy.ins().trun_ids[n]),s=new ItemExData;s.itemData=UtilProxy.GetItemCellData(o.item_id,o.item_num),i.push(s)}ViewManager.ins().open(TreasureView_reward,[!1,i]),LimitActProxy.ins().CurSelectType=0}},e.prototype.ResetTween=function(){egret.Tween.removeTweens(this.center),this.center.rotation=0,egret.Tween.removeTweens(this.center1),this.center1.rotation=0},e}(BaseEuiView);__reflect(LotteryView.prototype,"LotteryView"),ViewManager.ins().reg(LotteryView,LayerManager.UI_Main2),window.LotteryView=LotteryView;var LjAwardItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="LunjianAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.jifen.textFlow=UtilProxy.StrFormart("积分达到|C:@0 &(@1 /@2 )|",[LunjianProxy.ins().getscore()>=t.score?7:4,LunjianProxy.ins().getscore(),t.score]);for(var e=[],i=0;i<t.item.length;i++){var n=new ItemCellData,o={item_slot_idx:0,item_type_id:t.item[i][0],item_count:t.item[i][1]};n.setItemCellData(o),e.push(n)}this.awardlist.dataProvider=new eui.ArrayCollection(e);var s=LunjianProxy.ins().getScoreAwardState(t.id);this.btn.visible=0==s,this.hasget.visible=2==s},e.prototype.onClick=function(t){LunjianProxy.ins().C2SReqFactionswordGetScoreAward(this.data.id),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(LjAwardItem.prototype,"LjAwardItem"),window.LjAwardItem=LjAwardItem;var LjItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="LunjianItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.namelab.textFlow=UtilProxy.StrFormart("|C:4&[@0 ]|@1 ",[TitleProxy.ins().getShengWanglvlName(t.touxian_level,t.faction),UtilProxy.getStr("S@0 .@1 ",[t.server_id,t.name])]),this.zhanlab.text=UtilProxy.getStr("战力：@0 ",[t.fight]),this.icon.source="common_touxiang_0"+t.prof;var e=GlobalConfig.getFaction_sword_opp_dataConfig(t.score_id);e&&(this.title0.text=UtilProxy.getStr("宗派勋章      +@0 ",[e.win_award[0][1]]),this.title1.text=UtilProxy.getStr("声望      +@0 ",[e.win_award[1][1]]),this.moneyicon0.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(e.win_award[0][0]).displayid),this.moneyicon1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(e.win_award[1][0]).displayid),this.jifen.source=e.pic),this.btn.label=this.CanSweep()?"扫荡":"挑战"},e.prototype.onClick=function(t){if(!UtilProxy.IsCanTranScene())return void TipsControl.ins().showTips("当前场景不能进行挑战");if(LunjianProxy.ins().getleft_challenge_times()<=0)return void TipsControl.ins().showTips("挑战次数不足");var e=this.data;0!=e.id&&(LunjianProxy.ins().oppname=UtilProxy.getStr("S@0 .@1 ",[e.server_id,e.name]),this.CanSweep()?LunjianProxy.ins().C2SReqFactionswordSweep(e.id,e.role_id):(LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),LunjianProxy.ins().C2SReqFactionswordChallenge(e.id,e.role_id)),t.stopImmediatePropagation())},e.prototype.CanSweep=function(){return RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=GlobalConfig.getFaction_sword_paramConfig(1).sweep_need_vip_level&&RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING)>this.data.fight?!0:!1},e}(BaseItemRender);__reflect(LjItem.prototype,"LjItem"),window.LjItem=LjItem;var LjRankItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="LunjianRankItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.pic.source="top_icon_0"+t.rank,this.pic.visible=t.rank<=3,this.bg.visible=t.rank>3,this.ranklab.visible=t.rank>3,this.ranklab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.rank]);var e=GlobalConfig.getFaction_dataConfig(t.faction)?GlobalConfig.getFaction_dataConfig(t.faction).faction_name:"";this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[1==LunjianProxy.ins().CurRankType?t.name:e]),this.lab1.text=2==LunjianProxy.ins().CurRankType?t.name:e,this.lab0.text=t.score.toString()},e.prototype.onClick=function(t){var e=[];1==LunjianProxy.ins().CurRankType?(e=GlobalConfig.getFaction_sword_rank_award_dataConfig(this.data.rank).item,TipsControl.ins().ShowAwardTips(e)):(e=GlobalConfig.getFaction_sword_leader_award_dataConfig(this.data.rank).item,TipsControl.ins().ShowAwardTips(e)),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(LjRankItem.prototype,"LjRankItem"),window.LjRankItem=LjRankItem;var LunjianAwardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LunjianAwardSkin",this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&每周一 0点 重置积分|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&积分奖励|"),this.list.itemRenderer=LjAwardItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetScoreAward,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetScoreAward,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFactionScoreList(),e=[];for(var i in t)e.push(t[i]);this.e_array||(this.e_array=new eui.ArrayCollection,this.list.dataProvider=this.e_array),this.e_array.removeAll();for(var i in t)this.e_array.addItem(t[i])},e}(BaseEuiView);__reflect(LunjianAwardView.prototype,"LunjianAwardView"),ViewManager.ins().reg(LunjianAwardView,LayerManager.UI_Main),window.LunjianAwardView=LunjianAwardView;var LunjianRankView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LunjianRankSkin",this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&每周一 00：00 发放奖励至邮箱，并且重置积分|"),this.list.itemRenderer=LjRankItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn1,this.onBtnClick),this.addTouchEvent(this.btn2,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetRankList,this.ShowInfo),LunjianProxy.ins().CurRankType=1,LunjianProxy.ins().C2SReqFactionswordGetRankList(1),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn1,this.onBtnClick),this.removeTouchEvent(this.btn2,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetRankList,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){t.currentTarget==this.btn1?LunjianProxy.ins().CurRankType=1:LunjianProxy.ins().CurRankType=2,LunjianProxy.ins().C2SReqFactionswordGetRankList(LunjianProxy.ins().CurRankType),this.ShowInfo()},e.prototype.ShowInfo=function(){var t=LunjianProxy.ins().CurRankType;this.title.textFlow=1==t?UtilProxy.generateTextFlow("|C:10&个人排行|"):UtilProxy.generateTextFlow("|C:10&宗派排行|"),this.lab.text=1==t?"宗派":"掌门",this.ranklab.text=1==t?UtilProxy.getStr("我的排名：@0 ",[LunjianProxy.ins().getrank()>10||0==LunjianProxy.ins().getrank()?"10+":LunjianProxy.ins().getrank().toString()]):UtilProxy.getStr("我的宗派：@0 ",[FacProxy.ins().getFacName()]);var e=0==LunjianProxy.ins().getfaction_rank()?3:LunjianProxy.ins().getfaction_rank();this.jifen.textFlow=1==t?UtilProxy.StrFormart("我的积分：@0 ",[LunjianProxy.ins().getscore()]):UtilProxy.StrFormart("|C:7&声望@0 级可领取奖励|",[GlobalConfig.getFaction_sword_leader_award_dataConfig(e).reputation]),this.e_array||(this.e_array=new eui.ArrayCollection,this.list.dataProvider=this.e_array);var i=LunjianProxy.ins().getranklists(t);this.e_array.removeAll();for(var n in i)this.e_array.addItem(i[n])},e}(BaseEuiView);__reflect(LunjianRankView.prototype,"LunjianRankView"),ViewManager.ins().reg(LunjianRankView,LayerManager.UI_Main),window.LunjianRankView=LunjianRankView;var LunjianReportView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LunjianReportSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetRankList,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetRankList,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){for(var t=LunjianProxy.ins().getreports(),e=0;e<this.reports.numChildren;e++){var i=this.reports.getChildAt(e);if(i.visible=void 0!=t[e+1],i.includeInLayout=void 0!=t[e+1],void 0!=t[e+1]){var n=GlobalConfig.getFaction_reprotConfig(t[e+1].reportid);if(n){var o=UtilProxy.getStr(n.report_info,[t[e+1].name,t[e+1].other_name]),s=new Date(1e3*t[e+1].time);i.textFlow=UtilProxy.StrFormart("[@0 -@1 -@2 ]@3 ",[s.getFullYear(),s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,s.getDate(),o])}}}},e}(BaseEuiView);__reflect(LunjianReportView.prototype,"LunjianReportView"),ViewManager.ins().reg(LunjianReportView,LayerManager.UI_Main),window.LunjianReportView=LunjianReportView;var LunjianView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="LunjianSkin",this.comview.initUI(),this.comview.SetName("title_zongpailunjian"),this.tipsbtn.textFlow=UtilProxy.generateTextFlow("|C:7&U&查看战报|"),GlobalConfig.getFaction_sword_paramConfig(1).sweep_need_vip_level>18?this.tips.textFlow=UtilProxy.StrFormart("|C:7&SVIP@0 开启扫荡|",[GlobalConfig.getFaction_sword_paramConfig(1).sweep_need_vip_level-18]):this.tips.textFlow=UtilProxy.StrFormart("|C:7&VIP@0 开启扫荡|",[GlobalConfig.getFaction_sword_paramConfig(1).sweep_need_vip_level]),this.tips.visible=!UtilProxy.shield,this.list.itemRenderer=LjItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.rankbtn,this.onBtnClick),this.addTouchEvent(this.jifenbtn,this.onBtnClick),this.addTouchEvent(this.tipsbtn,this.onBtnClick),this.addTouchEvent(this.addbtn,this.onBtnClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionswordRefreshOpp,this.ShowList),EventProxy.AddListener(this,EventType.S2CRepFactionswordUpdateInfo,this.ShowMyInfo),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetScoreAward,this.ShowMyInfo),LunjianProxy.ins().C2SReqFactionswordRefreshOpp(),this.ShowInfo(),this.CheckGuide(),ViewManager.ins().close(FacView)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.rankbtn,this.onBtnClick),this.removeTouchEvent(this.jifenbtn,this.onBtnClick),this.removeTouchEvent(this.tipsbtn,this.onBtnClick),this.removeTouchEvent(this.addbtn,this.onBtnClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordRefreshOpp,this.ShowList),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordUpdateInfo,this.ShowMyInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetScoreAward,this.ShowMyInfo),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){switch(t.currentTarget){case this.rankbtn:ViewManager.ins().open(LunjianRankView);break;case this.jifenbtn:ViewManager.ins().open(LunjianAwardView);break;case this.tipsbtn:ViewManager.ins().open(LunjianReportView);break;case this.btn:LunjianProxy.ins().C2SReqFactionswordRefreshOpp();break;case this.addbtn:this.ShowBuyTips()}},e.prototype.ShowInfo=function(){this.ShowMyInfo(),this.ShowList()},e.prototype.ShowMyInfo=function(){this.icon.source="common_touxiang_0"+RoleProxy.ins().getRoleSex(),this.namelab.textFlow=UtilProxy.StrFormart("|C:4&[@0 ]|@1 ",[TitleProxy.ins().getShengWanglvlName(TitleProxy.ins().GetCurrentLevel(),FacProxy.ins().getFacId()),RoleProxy.ins().getRoleName()]),this.title1.text=UtilProxy.getStr("宗派勋章   +@0 ",[BagProxy.ins().getItemCountById(MoneyAttr.ZMXZ)]),this.title0.text=UtilProxy.getStr("声望   +@0 ",[RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG)]),this.title2.text=UtilProxy.getStr("战力：@0 ",[RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING)]),this.moneyicon1.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(MoneyAttr.ZMXZ).displayid),this.moneyicon0.source=AssetMgr.getIconResource(BagProxy.ins().getItemData(MoneyAttr.SHENGWANG).displayid),this.myrank.textFlow=UtilProxy.StrFormart("个人排名：|C:7&@0 |",[LunjianProxy.ins().getrank()>10||0==LunjianProxy.ins().getrank()?"10+":LunjianProxy.ins().getrank().toString()]),0==LunjianProxy.ins().getfaction_rank()?this.rank.text="宗派排名：暂无":this.rank.textFlow=UtilProxy.StrFormart("宗派排名：|C:7&@0 |",[LunjianProxy.ins().getfaction_rank()]);var t=GlobalConfig.getFaction_sword_paramConfig(1).challenge_num;this.count.textFlow=UtilProxy.StrFormart("挑战次数：|C:@0 &@1 /@2 |次",[0==LunjianProxy.ins().getleft_challenge_times()?4:7,LunjianProxy.ins().getleft_challenge_times(),t]),this.exp.maximum=LunjianProxy.ins().GetCurMaxScore(),this.exp.value=LunjianProxy.ins().getscore(),this.ShowColdTime(),this.jifenbtn.getChildAt(3).visible=LunjianProxy.ins().getAwardRed()},e.prototype.ShowList=function(){var t=LunjianProxy.ins().getopps();this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e])},e.prototype.ShowColdTime=function(){LunjianProxy.ins().getleft_challenge_times()<GlobalConfig.getFaction_sword_paramConfig(1).challenge_num?(this.SetTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)):(this.time.text="",TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.SetTimeLab=function(){var t=LunjianProxy.ins().getnext_recover_time(),e=GameLogic.ins().getServerTime();t>e?this.time.textFlow=UtilProxy.StrFormart("|C:7&@0 后恢复1次|",[UtilProxy.getTimeHMSString(t-e)]):(this.time.text="",TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.ShowBuyTips=function(){var t=GlobalConfig.getFaction_sword_paramConfig(1);if(LunjianProxy.ins().getleft_challenge_times()>=t.challenge_num)return void TipsControl.ins().showTips("当前挑战次数已满");var e=t.currencys,i=e[0],n=GlobalConfig.getFaction_sword_vip_challengeConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),o=n?n.num:0,s=UtilProxy.getStr("是否花费|C:7&@0 @1 |购买1次挑战次数?\n今日剩余购买次数|C:7&(@2 /@3 )|",[i[1],BagProxy.ins().getItemName(i[0]),o-LunjianProxy.ins().getbuy_challenge_times(),o]);TipsControl.ins().ShowTips1(s,void 0,this.BuyCount)},e.prototype.BuyCount=function(){var t=GlobalConfig.getFaction_sword_vip_challengeConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL));if(void 0==t||LunjianProxy.ins().getbuy_challenge_times()>=t.num)return TipsControl.ins().showTips("购买次数不足"),!1;var e=GlobalConfig.getFaction_sword_paramConfig(1).currencys,i=e[0];return RoleProxy.ins().getMoneyAttr(i[0])<i[1]?(TipsControl.ins().showTips(UtilProxy.getStr("@0 不足",[BagProxy.ins().getItemName(i[0])])),!1):(LunjianProxy.ins().C2SReqFactionswordBuyChallenge(1),!0)},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(200,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(LunjianView.prototype,"LunjianView"),ViewManager.ins().reg(LunjianView,LayerManager.UI_Main),window.LunjianView=LunjianView;var LyhLy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){this.red_lvup=this.btn_go.getChildAt(2),this.addTouchEvent(this.btn_close,this.close),this.addTouchEvent(this.btn_go,this.onClick),this.updateInfo()},e.prototype.close=function(){this.visible=!1,this.removeTouchEvent(this.btn_close,this.close),this.removeTouchEvent(this.btn_go,this.onClick)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ItemCell},e.prototype.onClose=function(){this.close()},e.prototype.updateInfo=function(){var t=LyhProxy.ins().getRewardId();if(this.cur_data=GlobalConfig.getLyhRewardById(t+1),!this.cur_data)return void this.close();var e=[],i=GlobalConfig.getLyhReward(),n=LyhProxy.ins().getCurData().id;for(var o in i){var s=i[o];n>=s.pass_id&&e.push(s)}this.txt_0.textFlow=UtilProxy.StrFormart("今日已领取|C:@0 &(@1 /@2 )|次炼妖壶奖励",[t>=e.length?7:4,t,e.length]);var r=GlobalConfig.getLyhRewardById(e.length+1);void 0!=r?this.txt_1.textFlow=UtilProxy.StrFormart("通关|C:4&@0 |关可永久增加1次炼妖奖励",[r.pass_id]):this.txt_1.text="",t<=e.length?(this.btn_go.visible=!0,this.txt_remark.textFlow=UtilProxy.StrFormart("C:5&击杀怪物可累计炼妖值|C:@0 &(@1 /@2 )|",[LyhProxy.ins().getLianyaoValue()>=this.cur_data.lianyao?7:4,LyhProxy.ins().getLianyaoValue(),this.cur_data.lianyao])):(this.btn_go.visible=!1,this.txt_remark.textFlow=UtilProxy.StrFormart("C:5&本日炼妖已达上限了",[])),this.updateRewardList(),this.red_lvup.visible=LyhProxy.ins().getLianyaoValue()>=this.cur_data.lianyao
},e.prototype.onClick=function(t){return void 0==this.cur_data?void TipsControl.ins().showTips("今日已通关"):LyhProxy.ins().getLianyaoValue()<this.cur_data.lianyao?void TipsControl.ins().showTips("炼妖值不足"):void LyhProxy.ins().C2SReqLyhGetReward(this.cur_data.id)},e.prototype.updateRewardList=function(){if(void 0!=this.cur_data){for(var t=new eui.ArrayCollection,e=this.getRewardList(),i=0;i<e.length;i++){var n=e[i][0],o=e[i][1],s=new ItemCellData,r={item_slot_idx:0,item_type_id:n,item_count:o};s.setItemCellData(r),t.addItem(s)}this.list.dataProvider=t}},e.prototype.getRewardList=function(){for(var t=LyhProxy.ins().getCurData().id-1,e=0;e<this.cur_data.range.length;e++){var i=this.cur_data.range[e];if(t>=i[0]&&t<=i[1])return i[2]}return[]},e}(BaseView);__reflect(LyhLy.prototype,"LyhLy"),window.LyhLy=LyhLy;var LyhOffline=function(t){function e(){var e=t.call(this)||this;return e.skinName="LyhOfflineSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&离线收益",[]),this.path1.textFlow=UtilProxy.StrFormart("C:7&点击开通",[])},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.bg,this.onClick),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_qq,this.onClick),this.addTouchEvent(this.btn_1,this.onClick),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.bg,this.onClick),this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_qq,this.onClick),this.removeTouchEvent(this.btn_1,this.onClick),LimitActProxy.ins().IsShowFirstRechange?ViewManager.ins().open(FirstRechargeView):LimitActProxy.ins().IsShowRankAct?ViewManager.ins().open(ChongbangTips):EventProxy.Broast(EventType.GuideDoEvent,[])},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_qq:ViewManager.ins().close(e);break;case this.bg:case this.btn_close:ViewManager.ins().close(e);break;case this.btn_1:var i=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN);0==i?ViewManager.ins().open(PrivilegeView):TipsControl.ins().showTips("您已开通")}},e.prototype.updateInfo=function(){for(var t=LyhProxy.ins().getCurId(),e=GlobalConfig.getLyhConfigById(Math.max(1,t)),i=0,n=0,o=0;o<e.award_data.length;o++){var s=e.award_data[o];s[0]==MoneyAttr.EXP?i=s[1]:s[0]==MoneyAttr.COIN&&(n=s[1])}var r=(PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN),PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN));this.path1.visible=0==r;var a=LimitActProxy.ins().offline_time,h=GlobalConfig.getLyhMisc(),l=DateUtils.getFormatBySecond(a,DateUtils.TIME_FORMAT_5);this.txt_time.textFlow=UtilProxy.StrFormart("@0 (最多累计收益@1 小时)",[l,h.max_time]),this.txt_sub.textFlow=UtilProxy.StrFormart("离线超过8小时，只能获得80%收益",[]);var p=a/h.time_interval;this.val_normal0.textFlow=UtilProxy.StrFormart("C:7&@0 ",[UtilProxy.getNumLab(p*i,2)]),this.val_pojin0.textFlow=UtilProxy.StrFormart("C:11&铂金卡 +@0 %",[h.bojin_add]),this.val_zhizun0.textFlow=UtilProxy.StrFormart("C:11&至尊卡 +@0 %",[h.zhizun_add]),this.val_normal1.textFlow=UtilProxy.StrFormart("C:7&@0 ",[UtilProxy.getNumLab(p*n,2)]),this.val_pojin1.textFlow=UtilProxy.StrFormart("C:11&铂金卡 +@0 %",[h.bojin_add]),this.val_zhizun1.textFlow=UtilProxy.StrFormart("C:11&至尊卡 +@0 %",[h.zhizun_add]),this.val_normal2.textFlow=UtilProxy.StrFormart("C:7&拾取装备：@0 ",[LimitActProxy.ins().offline_equip_num]),this.val_pojin2.textFlow=UtilProxy.StrFormart("C:7&拾取装备：@0 ",[LimitActProxy.ins().offline_equip_num]),this.val_zhizun2.textFlow=UtilProxy.StrFormart("C:7&拾取装备：@0 ",[LimitActProxy.ins().offline_equip_num])},e}(BaseEuiView);__reflect(LyhOffline.prototype,"LyhOffline"),ViewManager.ins().reg(LyhOffline,LayerManager.UI_Main),window.LyhOffline=LyhOffline;var LyhRewardTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="LyhRewardSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.updateInfo(i)},e.prototype.close=function(){egret.Tween.removeTweens(this.gp)},e.prototype.updateInfo=function(t){egret.Tween.removeTweens(this.gp),this.gp.horizontalCenter=0,this.gp.y=260,this.scaleX=this.scaleY=1;var i=GlobalConfig.getLyhConfigById(t);i||(i=GlobalConfig.getLyhConfigById(1));for(var n=0,o=0,s=(i.show_item,0);s<i.award_data.length;s++){var r=i.award_data[s];r[0]==MoneyAttr.EXP?n=12*r[1]:r[0]==MoneyAttr.COIN&&(o=12*r[1])}this.txt_title.textFlow=UtilProxy.StrFormart("C:10&关卡收益",[]),this.txt_coin.textFlow=UtilProxy.StrFormart("C:7&@0 /|小时",[o]),this.txt_exp.textFlow=UtilProxy.StrFormart("C:7&@0 /|小时",[n]),egret.Tween.get(this.gp).wait(1188).to({y:this.gp.y-200,scaleX:.1,scaleY:.1},500).call(function(){ViewManager.ins().close(e)})},e}(BaseEuiView);__reflect(LyhRewardTips.prototype,"LyhRewardTips"),ViewManager.ins().reg(LyhRewardTips,LayerManager.UI_Main),window.LyhRewardTips=LyhRewardTips;var LyhSort=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(){},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClose=function(){this.visible=!1},e.prototype.onClick=function(t){},e}(BaseView);__reflect(LyhSort.prototype,"LyhSort"),window.LyhSort=LyhSort;var LyhSweep=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="lyhSweepSkin"},e.prototype.open=function(){this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_qq,this.onClick),this.addTouchEvent(this.txt_go,this.onClick),this.addTouchEvent(this.btn_0,this.onClick),this.addTouchEvent(this.btn_1,this.onClick),EventProxy.AddListener(this,EventType.S2CRepLyhSweep,this.onlvupUpdate),this.item4.visible=!1,this.path0.textFlow=UtilProxy.StrFormart("C:7&点击开通",[]),this.path1.textFlow=UtilProxy.StrFormart("C:7&点击开通",[]),this.item_list=[this.item0,this.item1,this.item2,this.item3,this.item4],this.txt_remark.textFlow=UtilProxy.StrFormart("C:7&提升VIP可增加次数",[]),this.get_value4.textFlow=UtilProxy.StrFormart("C:4&暂未开放",[]),this.txt_go.textFlow=UtilProxy.StrFormart("C:7&<u>立即前往</u>",[]),this.updateInfo()},e.prototype.close=function(){this.onClose()},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClose=function(){this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_qq,this.onClick),this.removeTouchEvent(this.txt_go,this.onClick),this.removeTouchEvent(this.btn_0,this.onClick),this.removeTouchEvent(this.btn_1,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepLyhSweep,this.onlvupUpdate)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_qq:if(BagProxy.ins().GetBagLeftCount(BagType.EQUIP)<20)return void TipsControl.ins().ShowTips1("背包格子不够，是否一键熔炼?",function(){},function(){BagProxy.ins().OneKeySmelt()});if(this.use_times>=this.max_times)return void TipsControl.ins().showTips("C:4&今日次数用完");if(this.sweep_data){for(var i=0;i<this.sweep_data.sweep_need.length;i++){var n=this.sweep_data.sweep_need[i];if(RoleProxy.ins().getMoneyAttr(n[0])<n[1])return void TipsControl.ins().showTips("C:4&元宝不足!")}LyhProxy.ins().C2SReqLyhSweep()}break;case this.btn_close:ViewManager.ins().close(e);break;case this.txt_go:ViewManager.ins().open(VIPView);break;case this.btn_0:var o=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN);0==o?ViewManager.ins().open(PrivilegeView):TipsControl.ins().showTips("您已开通");break;case this.btn_1:var s=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN);0==s?ViewManager.ins().open(PrivilegeView):TipsControl.ins().showTips("您已开通")}},e.prototype.updateInfo=function(){this.red_qq=this.btn_qq.getChildAt(2);var t=LyhProxy.ins().getCurId(),e=GlobalConfig.getLyhConfigById(t);e||(e=GlobalConfig.getLyhConfigById(1));for(var i=0,n=0,o=0,s=(e.show_item,0);s<e.award_data.length;s++){var r=e.award_data[s];r[0]==MoneyAttr.EXP?i=96*r[1]:r[0]==MoneyAttr.COIN?n=96*r[1]:r[0]==MoneyAttr.ZHENQI&&(o=96*r[1])}var a=new ItemCellData;a.setItemCellData({item_slot_idx:0,item_type_id:MoneyAttr.EXP,item_count:1}),this.item0.data=a;var h=new ItemCellData;h.setItemCellData({item_slot_idx:0,item_type_id:MoneyAttr.COIN,item_count:1}),this.item1.data=a;var l=new ItemCellData;l.setItemCellData({item_slot_idx:0,item_type_id:MoneyAttr.ZHENQI,item_count:1}),this.item2.data=a;var p=new ItemCellData;p.setItemCellData({item_slot_idx:0,item_type_id:e.show_item,item_count:1}),this.item3.data=p,this.get_value0.textFlow=UtilProxy.StrFormart("经验+|C:7&@0 |",[i]),this.get_value1.textFlow=UtilProxy.StrFormart("金币+|C:7&@0 |",[n]),this.get_value2.textFlow=UtilProxy.StrFormart("真气值+|C:7&@0 |",[o]);var c=BagProxy.ins().getItemData(e.show_item);c&&(this.get_value3.textFlow=UtilProxy.StrFormart("C:@0 & @1 ",[BagProxy.QUALITY_COLOR[c.quality-1],c.name]));var u=GlobalConfig.getLyhMisc();this.value0.text=UtilProxy.getStr("+@0 %",[u.bojin_add]),this.value1.text=UtilProxy.getStr("+@0 %",[u.zhizun_add]);var d=LyhProxy.ins().sweep_times,g=LyhProxy.ins().getSweepMax();this.use_times=d,this.max_times=g;var y=d>=g?4:7;if(this.txt_times.textFlow=UtilProxy.StrFormart("今日使用次数：|C:@0 &(@1 /@2 )",[y,g-d,g]),g>d){var f=GlobalConfig.getLyhSweepById(d+1);if(f){var _=f.sweep_need[0],v=f.sweep_need.length>0?RoleProxy.ins().getMoneyAttr(_[0]):0,m=f.sweep_need.length>0?_[1]:0,C=m>v?4:7;this.cost_val.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[C,m])}this.sweep_data=f}else{var f=GlobalConfig.getLyhSweepById(g);if(f){var S=f.sweep_need[0],v=RoleProxy.ins().getMoneyAttr(S[0]),m=S[1],w=m>v?4:7;this.cost_val.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[w,m])}this.sweep_data=f}var x=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN);this.path0.visible=0==x;var T=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN);this.path1.visible=0==T,this.red_qq.visible=LyhProxy.ins().getLyhSdRed()},e.prototype.onlvupUpdate=function(){this.updateInfo()},e}(BaseEuiView);__reflect(LyhSweep.prototype,"LyhSweep"),ViewManager.ins().reg(LyhSweep,LayerManager.UI_Main),window.LyhSweep=LyhSweep;var LyhView=function(t){function e(){var e=t.call(this)||this;return e.layer_list=[],e.layer_index=0,e.skinName="LyhViewSkin",e.list.itemRenderer=BagItem,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_lianyaohu"),this.txt_list=[this.txt_sort1,this.txt_sort2,this.txt_sort3],this.layer_list=[this.ta_item0,this.ta_item1,this.ta_item2,this.ta_item3,this.ta_item4]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.updateView),EventProxy.AddListener(this,EventType.S2CRepLyhGetReward,this.updateView),EventProxy.AddListener(this,EventType.LyhUpdateMonster,this.updateView),EventProxy.AddListener(this,EventType.S2CRepLyhSweep,this.updateView),EventProxy.AddListener(this,EventType.S2CRepLyhUpdateLayerInfo,this.onLayerUpdate);for(var n=0;n<this.layer_list.length;n++)this.addTouchEvent(this.layer_list[n],this.onLayerClick);this.addTouchEvent(this.btn_close,this.onCloseClick),this.addTouchEvent(this.btn_sweep,this.onClick),this.addTouchEvent(this.btn_ly,this.onClick),this.addTouchEvent(this.btn_go,this.onClick),this.addTouchEvent(this.btn_sort,this.onClick),this.panel_ly.visible=!1,this.panel_sort.visible=!1,this.ly_red.visible=LyhProxy.ins().getLyRed(),this.sd_red.visible=LyhProxy.ins().getLyhSdRed(),this.updateInfo(),this.updateLayer(),this.updateLayerSp()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.panel_ly.close(),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.updateView),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetReward,this.updateView),EventProxy.RemoveListener(this,EventType.LyhUpdateMonster,this.updateView),EventProxy.RemoveListener(this,EventType.S2CRepLyhSweep,this.updateView),EventProxy.RemoveListener(this,EventType.S2CRepLyhUpdateLayerInfo,this.onLayerUpdate),this.removeTouchEvent(this.btn_close,this.onCloseClick),this.removeTouchEvent(this.btn_sweep,this.onClick),this.removeTouchEvent(this.btn_ly,this.onClick),this.removeTouchEvent(this.btn_go,this.onClick),this.removeTouchEvent(this.btn_sort,this.onClick);for(var i=0;i<this.layer_list.length;i++)this.removeTouchEvent(this.layer_list[i],this.onLayerClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.updateInfo=function(){var t=LyhProxy.ins().getCurData();if(this.cur_data=t,t){this.txt_fight.textFlow=UtilProxy.StrFormart("C:7&推荐战斗力：@0 ",[this.cur_data.lv_fight]),this.list.visible=!0,this.txt_lv.text="第"+t.id+"关";for(var e=new eui.ArrayCollection,i=0;i<t.reward_preview.length;i++){var n=t.reward_preview[i][0],o=t.reward_preview[i][1],s=new ItemCellData,r={item_slot_idx:0,item_type_id:n,item_count:o};s.setItemCellData(r),e.addItem(s)}this.list.dataProvider=e;var a=LyhProxy.ins().getCurValue(),h=t.kill_scale,l=TaskProxy.ins().IsTaskInRecorder(t.task_id);if(this.btn_go.visible=a>=t.kill_num&&l,a>=t.kill_num)this.lv_bar.visible=!1,this.txt_process.text="";else{this.lv_bar.visible=!0,this.lv_bar.maximum=h,this.lv_bar.minimum=0;var p=t.kill_num/t.kill_scale,c=Math.floor(a/p);this.lv_bar.value=c,this.txt_process.textFlow=UtilProxy.StrFormart("C:4&再杀@0 波怪物可挑战关卡首领",[t.kill_scale-c])}l?this.txt_task.text="":this.txt_task.textFlow=UtilProxy.StrFormart("C:4&完成@0 关所有主线任务后可继续挑战",[t.id]);var u=LyhProxy.ins().getExtraId(LyhProxy.ins().getCurData().id);if(u>0){var d=GlobalConfig.getLyhConfigById(u),g=d.extra_reward;if(this.txt_lv_title.textFlow=UtilProxy.StrFormart("C:4&第@0 关奖励",[u]),1==g[0]){this.cur_item.visible=!1,this.gp_skill.visible=!0;var y=(GlobalConfig.getSkillConfig(g[1]),GlobalConfig.getSkillDescById(Math.floor(g[1]/1e4)));this.skill_icon.source=y.icon,this.skill_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[y.name])}else{this.gp_skill.visible=!1,this.cur_item.visible=!0;var r={item_slot_idx:0,item_type_id:g[1],item_count:1},f=new ItemCellData;f.setItemCellData(r),this.cur_item.data=f,this.cur_item.ShowName(!0),this.cur_item.ShowRed(!1)}}else this.txt_lv_title.text="",this.gp_skill.visible=!1,this.cur_item.visible=!1}else this.txt_lv.text="",this.list.visible=!1,this.lv_bar.visible=!1,this.txt_process.text="已通关",this.txt_fight.text="";var _=LyhProxy.ins().getRewardId(),v=GlobalConfig.getLyhRewardById(_+1);v?(this.ly_process.visible=!0,this.ly_process.maximum=v.lianyao,this.ly_process.value=LyhProxy.ins().getLianyaoValue(),this.ly_process.labelDisplay.visible=!1,this.txt_ly_process.text=UtilProxy.getStr("@0 /@1 ",[LyhProxy.ins().getLianyaoValue(),v.lianyao])):(this.ly_process.visible=!1,this.txt_ly_process.text="");var m=LyhProxy.ins().getCurId(),C=LyhProxy.ins().getOfflineData(m);this.value1.text=C[1].toString()+"/小时",this.value2.text=C[0].toString()+"/小时";var S=RankProxy.ins().getTotleRanklistByType(15);if(S&&S.length>0)for(var i=0;i<this.txt_list.length;i++)if(i<S.length){var w=S[i];this.txt_list[i].textFlow=UtilProxy.StrFormart("C:1&@0 .@1    @2 关",[i+1,w.name,w.value])}else this.txt_list[i].text="";else this.txt_sort1.text="",this.txt_sort2.text="",this.txt_sort3.text=""},e.prototype.updateLayer=function(){var t=LyhProxy.ins().first_name;t=""==t?"虚位以待":t,this.txt_top_name.textFlow=UtilProxy.StrFormart("C:7&@0 ",[t]);var e=LyhProxy.ins().layer_list;if(e&&0!=e.length)for(var i=0;i<e.length;i++)this.updateLayerItem(this.layer_list[i],e[i]);else for(var i=0;i<this.layer_list.length;i++)this.layer_list[i].visible=!1},e.prototype.updateLayerSp=function(){this.sp_select.y=356-76*this.layer_index},e.prototype.updateLayerItem=function(t,e){if(t&&e){var i=t.getChildAt(0),n=t.getChildAt(1),o=t.getChildAt(2),s=GlobalConfig.getLyhLayerByID(e.pass_id);if(s){var r={item_slot_idx:0,item_type_id:s.award[0][0],item_count:s.award[0][1]},a=new ItemCellData;a.setItemCellData(r),i.data=a,n.text=UtilProxy.getStr("@0 关",[s.id]),o.visible=1==e.state,i.ShowRed(LyhProxy.ins().getCurId()>=s.id&&0==e.state)}}},e.prototype.onLayerUpdate=function(){this.updateLayer()},e.prototype.updateView=function(){this.ly_red.visible=LyhProxy.ins().getLyRed(),this.sd_red.visible=LyhProxy.ins().getLyhSdRed(),this.updateInfo(),this.panel_ly.visible&&this.panel_ly.updateInfo()},e.prototype.onClick=function(t){this.btn_go;switch(t.currentTarget){case this.btn_go:if(!GameLogic.ins().isMainScene())return void TipsControl.ins().showTips("目前处于副本或活动场景，无法挑战心魔");if(ViewManager.ins().close(e),void 0==this.cur_data)return;CopyProxy.ins().C2SReqCopyEnterCopy(this.cur_data.copy_id);break;case this.btn_ly:if(!SystemOpenProxy.ins().isOpen(2,4001))return;var i=LyhProxy.ins().getRewardId(),n=GlobalConfig.getLyhRewardById(i+1);if(!n)return void TipsControl.ins().showTips("炼妖次数已满");this.showPanelLy();break;case this.btn_sweep:if(!SystemOpenProxy.ins().isOpen(2,4002))return;this.showPanelSweep();break;case this.btn_sort:ViewManager.ins().open(RankView,14)}},e.prototype.onLayerClick=function(t){var e=this.layer_list.indexOf(t.currentTarget);if(e>=0){this.layer_index=e,this.updateLayerSp();var i=LyhProxy.ins().layer_list[e];if(!i)return;LyhProxy.ins().getCurId()>=i.pass_id&&0==i.state?LyhProxy.ins().C2SReqLyhGetLayerAward(i.pass_id):TipsControl.ins().showTips("条件不足，无法领取")}},e.prototype.showPanelSort=function(){this.panel_sort.visible=!0},e.prototype.showPanelSweep=function(){ViewManager.ins().open(LyhSweep)},e.prototype.showPanelLy=function(){this.panel_ly.visible=!0,this.panel_ly.open()},e}(BaseEuiView);__reflect(LyhView.prototype,"LyhView"),ViewManager.ins().reg(LyhView,LayerManager.UI_Main),window.LyhView=LyhView;var MailItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="MailItemSkin",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.onClick=function(t){var e=this.data;if(void 0!=e.index){var i=MailProxy.ins().getMailStateByIndex(e.index);if(2==i)return void TipsControl.ins().showTips("已经领取！");var n=[e.index];MailProxy.ins().C2SReqMailRetrieveAttachment(n)}},e.prototype.setData=function(){var t=this.data;this.info0.text=t.title,this.info1.text=DateUtils.getFormatBySecond(t.send_time,2),this.refresh()},e.prototype.refresh=function(){var t=this.data,e=MailProxy.ins().getMailStateByIndex(t.index);0==e?this.state.source="youjian_icon_youjian_02":(1==e||2==e)&&(this.state.source="youjian_icon_youjian"),2==e?(this.btn.visible=!1,this.finish.visible=!0):(t.item_list.length>0?this.btn.visible=!0:this.btn.visible=!1,this.finish.visible=!1)},e}(BaseItemRender);__reflect(MailItem.prototype,"MailItem"),window.MailItem=MailItem;var MailView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MailSkin",this.comview.initUI(),this.list.itemRenderer=MailItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.listTips.itemRenderer=ItemCell,this.scrollerTips.viewport=this.listTips,this.listTips.dataProvider=new eui.ArrayCollection,this.tips.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.comview.SetName(UtilProxy.getTitleName("邮件")),EventProxy.AddListener(this,EventType.S2CRepMailListInfo,this.S2CRepMailListInfo),EventProxy.AddListener(this,EventType.S2CRepMailInfo,this.S2CRepMailInfo),EventProxy.AddListener(this,EventType.S2CRepMailReadMail,this.S2CRepMailReadMail),EventProxy.AddListener(this,EventType.S2CRepMailNotifyNewMail,this.S2CRepMailNotifyNewMail),EventProxy.AddListener(this,EventType.S2CRepMailNotifyDelMail,this.S2CRepMailNotifyDelMail),EventProxy.AddListener(this,EventType.S2CRepMailNotifyRetrieveAttachment,this.S2CRepMailNotifyRetrieveAttachment),this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.tipscloseBtn,this.onClick),this.addTouchEvent(this.enterBtn,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.sbtn0,this.onClick),this.setMailList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),EventProxy.RemoveListener(this,EventType.S2CRepMailListInfo,this.S2CRepMailListInfo),EventProxy.RemoveListener(this,EventType.S2CRepMailInfo,this.S2CRepMailInfo),EventProxy.RemoveListener(this,EventType.S2CRepMailReadMail,this.S2CRepMailReadMail),EventProxy.RemoveListener(this,EventType.S2CRepMailNotifyNewMail,this.S2CRepMailNotifyNewMail),EventProxy.RemoveListener(this,EventType.S2CRepMailNotifyDelMail,this.S2CRepMailNotifyDelMail),EventProxy.RemoveListener(this,EventType.S2CRepMailNotifyRetrieveAttachment,this.S2CRepMailNotifyRetrieveAttachment),this.removeTouchEvent(this.closeBtn,this.onClick),this.removeTouchEvent(this.tipscloseBtn,this.onClick),this.removeTouchEvent(this.enterBtn,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.sbtn0,this.onClick),this.tips.visible=!1},e.prototype.onClick=function(t){switch(t.currentTarget){case this.tipscloseBtn:this.tips.visible=!1;break;case this.enterBtn:if(void 0!=this.currentMailItem){var e=this.currentMailItem.index,i=[e];MailProxy.ins().C2SReqMailRetrieveAttachment(i)}break;case this.sbtn0:MailProxy.ins().getMailRewardIndexList().length>0&&MailProxy.ins().C2SReqMailRetrieveAttachment(MailProxy.ins().getMailRewardIndexList());break;case this.sbtn1:MailProxy.ins().getMailIndexList().length>0&&(MailProxy.ins().getMailRewardState()?TipsControl.ins().showTips("尚有附件未领取，请先领取！"):MailProxy.ins().C2SReqMailDeleteMail(MailProxy.ins().getMailIndexList()));break;case this.closeBtn:ViewManager.ins().close(this)}},e.prototype.setMailList=function(){var t=new Array;if(void 0!=MailProxy.ins().mail_list){var e=MailProxy.ins().mail_list;e.sort(MailProxy.ins().sortMailItem);for(var i=0;i<e.length;++i){var n=new MailData;n.index=e[i].index,n.type=e[i].type,n.content=e[i].content,n.send_time=e[i].send_time,n.title=e[i].title;for(var o=new Array,s=0;s<e[i].item_list.length;++s){var r=e[i].item_list[s],a=UtilProxy.GetItemCellData(r.item_type_id,r.item_count);o.push(a)}if(e[i].cerrencys)for(var s=0;s<e[i].cerrencys.length;++s){var r=e[i].cerrencys[s],a=UtilProxy.GetItemCellData(r.type,r.count);o.push(a)}n.item_list=o,n.mailInfo=e[i],t.push(n)}}this.list.dataProvider=new eui.ArrayCollection(t),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this)},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer,i=e.data;this.currentMailItem=i,this.setMailInfo(i)},e.prototype.setMailInfo=function(t){if(void 0!=t&&void 0!=t.mailInfo){this.tips.visible=!0;var e=GlobalConfig.getMail_dataConfig(t.mailInfo.config_id);if(this.tipName.text="信函",this.itemName0.text="附件",e)if(t.mailInfo.params&&t.mailInfo.params.length>0){for(var i=[],n=0;t.mailInfo.params.length>n;)i.push(t.mailInfo.params[n]),n++;this.tipsInfo0.textFlow=UtilProxy.StrFormart(e.content,i)}else this.tipsInfo0.textFlow=UtilProxy.generateTextFlow(e.content);else this.tipsInfo0.text=t.mailInfo.content;var o=MailProxy.ins().getMailStateByIndex(t.index);2==o?(this.finishTips.visible=t.item_list.length>0,this.enterBtn.visible=!1):(this.finishTips.visible=!1,this.enterBtn.visible=t.item_list.length>0),0==o&&MailProxy.ins().C2SReqMailReadMailInfo(t.index),this.listTips.dataProvider=new eui.ArrayCollection(t.item_list)}},e.prototype.S2CRepMailListInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.S2CRepMailInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.S2CRepMailReadMail=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],n=0;n<this.list.numChildren;++n){var o=this.list.getChildAt(n);if(void 0!=o&&void 0!=o.data){var s=o.data;s.index==i&&o.refresh()}}},e.prototype.S2CRepMailNotifyNewMail=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setMailList()},e.prototype.S2CRepMailNotifyDelMail=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setMailList()},e.prototype.S2CRepMailNotifyRetrieveAttachment=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.visible&&this.setMailInfo(this.currentMailItem),this.setMailList()},e}(BaseEuiView);__reflect(MailView.prototype,"MailView"),ViewManager.ins().reg(MailView,LayerManager.UI_Main),window.MailView=MailView;var Die=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="die"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onClick=function(t){GameMap.centerEntity.AI.getAIState()==AI_State.Atk?GameMap.centerEntity.AI.setAIState(AI_State.Stand):GameMap.centerEntity.AI.setAIState(AI_State.Atk)},e}(BaseEuiView);__reflect(Die.prototype,"Die"),ViewManager.ins().reg(Die,LayerManager.UI_Main),window.Die=Die;var MainFubenExp=function(t){function e(){var e=t.call(this)||this;return e.isShowG=!1,e.isShowReward=!1,e.expPrivilege=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MainViewFubenExpSkin",this.rList.itemRenderer=ItemCell,this.rScroll.viewport=this.rList,this.rList.dataProvider=new eui.ArrayCollection,this.info_list=[this.info0,this.info1,this.info2,this.info3,this.info4,this.info5,this.info6,this.info7,this.info8];var e=GlobalConfig.getConfig("special_rights","Special_rightsConfig");for(var i in e){var n=Number(i),o=e[n].id;e[n].add_exp>0&&this.expPrivilege.push(o)}this.FRPushTips.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.carBtn,this.onClick),this.addTouchEvent(this.addBtn,this.onClick),this.addTouchEvent(this.rankBtn,this.onClick),this.addTouchEvent(this.tipsEnterBtn,this.onClick),this.addTouchEvent(this.tipsClose,this.onClick),this.addTouchEvent(this.rewardBtn,this.onClick),this.addTouchEvent(this.firstrechargeBtn,this.onClick),this.addTouchEvent(this.FRPushTips,this.onFRPushClick),EventProxy.AddListener(this,EventType.S2CTeamcopyGuwu,this.S2CTeamcopyGuwu),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData),EventProxy.AddListener(this,EventType.S2CRepCopyEnterCopy,this.S2CRepCopyEnterCopy),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.isShowFirstrecharge),EventProxy.AddListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),this.isShowReward=!1,this.showRewardG.visible=!1,this.setPrivilegeData(),this.setGuwuData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.carBtn,this.onClick),this.removeTouchEvent(this.addBtn,this.onClick),this.removeTouchEvent(this.rankBtn,this.onClick),this.removeTouchEvent(this.tipsEnterBtn,this.onClick),this.removeTouchEvent(this.tipsClose,this.onClick),this.removeTouchEvent(this.rewardBtn,this.onClick),this.removeTouchEvent(this.firstrechargeBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CTeamcopyGuwu,this.S2CTeamcopyGuwu),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData),EventProxy.RemoveListener(this,EventType.S2CRepCopyEnterCopy,this.S2CRepCopyEnterCopy),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.isShowFirstrecharge),EventProxy.RemoveListener(this,EventType.ChangeMainAchorState,this.SetAnchorState)},e.prototype.S2CRepCopyEnterCopy=function(){TimerManager.ins().remove(this.update,this),TimerManager.ins().doTimer(1e3,0,this.update,this)},e.prototype.update=function(){if(CopyProxy.ins().free_time){var t=CopyProxy.ins().free_time-(GameLogic.ins().getServerTime()-CopyProxy.ins().cur_server_time);this.setLeftTime(t)}},e.prototype.setLeftTime=function(t){this.fuben_time.text=UtilProxy.getTimeHMSString(Math.max(t,0))},e.prototype.S2CTeamcopyGuwu=function(t){this.tips.visible=!1,this.setGuwuData(),this.updateshake(!0)},e.prototype.S2CRepActivitySpecialRightsData=function(t){this.setPrivilegeData(),this.updateshake(!0)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.carBtn:for(var e=0;e<this.expPrivilege.length;e++)if(0!=PrivilegeProxy.ins().getPrivilegeState(this.expPrivilege[e]))return void TipsControl.ins().showTips("已经有特权！");ViewManager.ins().open(PrivilegeView,2);break;case this.addBtn:this.setTipsInfo();break;case this.rankBtn:this.isShowG=!this.isShowG,this.setRankState();break;case this.tipsEnterBtn:if(CopyTeamProxy.ins().isGuWu)TipsControl.ins().showTips("已经有鼓舞！");else{var i=GlobalConfig.getTeamcopy_baseConfig(1);i.guwu_consume[1]<=RoleProxy.ins().getMoneyAttr(i.guwu_consume[0])?TipsControl.ins().ShowTips1("是否消耗"+i.guwu_consume[1]+"元宝进行鼓舞？",function(){},function(){CopyTeamProxy.ins().C2SReqTeamcopyGuwu()}):TipsControl.ins().showTips("元宝不足！")}break;case this.tipsClose:this.tips.visible=!1;break;case this.rewardBtn:this.setRewardData();break;case this.firstrechargeBtn:var n=t.currentTarget.icon;"main_icon_shouchong"==n?ViewManager.ins().open(FirstRechargeView):"main_icon_haohuashouchong"==n&&ViewManager.ins().open(LuxuryFRView)}},e.prototype.setTipsInfo=function(){this.tips.visible=!0;var t=GlobalConfig.getTeamcopy_baseConfig(1);this.tipsInfo.textFlow=UtilProxy.generateTextFlow("C:7&经验 +"+t.guwu_add+"%"),this.tipsInfo0.text=t.guwu_consume[1]+"元宝"},e.prototype.setVisible=function(t){if(this.visible=t,t){this.isShowG=!1,this.tips.visible=!1,this.setRankState(),TimerManager.ins().doTimer(2e3,0,this.setRankInfo,this);var e=GlobalConfig.getTeamcopy_baseConfig(1),i=GlobalConfig.getCopyConfigById(e.copy_id);CopyProxy.ins().free_time=i.time_out,CopyProxy.ins().cur_server_time=GameLogic.ins().getServerTime(),TimerManager.ins().doTimer(1e3,0,this.update,this),this.updateshake(!0),this.setGuwuData(),this.isShowFirstrecharge()}else this.updateshake(!1),TimerManager.ins().removeAll(this)},e.prototype.updateshake=function(t){var e=this;t?(DisplayUtils.shakeIt(this.addBtn,2,500,-1,function(){return!CopyTeamProxy.ins().isGuWu}),DisplayUtils.shakeIt(this.carBtn,2,500,-1,function(){for(var t=0;t<e.expPrivilege.length;t++)if(0!=PrivilegeProxy.ins().getPrivilegeState(e.expPrivilege[t]))return!1;return!0})):(DisplayUtils.shakeIt(this.addBtn,2,500,-1,function(){return!1}),DisplayUtils.shakeIt(this.carBtn,2,500,-1,function(){return!1}))},e.prototype.setRankState=function(){this.isShowG?(this.showG.visible=!0,this.HideG.visible=!1,this.setRankInfo()):(this.showG.visible=!1,this.HideG.visible=!0)},e.prototype.setRewardData=function(){if(this.isShowReward)this.showRewardG.visible=!1,this.isShowReward=!1;else{var t=GlobalConfig.getTeamcopy_kill_monster_awards(),e=CopyTeamProxy.ins().getKillCount();if(0==e)return void TipsControl.ins().showTips("尚未获得奖励！");var i;for(var n in t)t[n].monster_num<=e&&(i=t[n]);if(i){var o=UtilProxy.GetItemCellData(i.awards[0][0],i.awards[0][1]);this.rewardCell.data=o,this.showRewardG.visible=!0,this.isShowReward=!0}else TipsControl.ins().showTips("尚未获得奖励！")}},e.prototype.setPrivilegeData=function(){var t=0;if(0!=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)){var e=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.ZHIZUN);t+=e.add_exp}if(0!=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN)){var i=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.BOJIN);t+=i.add_exp}this.cardInfo.textFlow=UtilProxy.generateTextFlow("C:7&经验 +"+t/100+"%")},e.prototype.setGuwuData=function(){if(CopyTeamProxy.ins().isGuWu){var t=GlobalConfig.getTeamcopy_baseConfig(1);this.addInfo.textFlow=UtilProxy.generateTextFlow("C:7&经验 +"+t.guwu_add+"%")}else this.addInfo.textFlow=UtilProxy.generateTextFlow("C:7&经验 +0%")
},e.prototype.setRankInfo=function(){if(void 0!=SceneControl.ins().hurtList){var t=SceneControl.ins().hurtList,e=[];for(var i in t){var n=t[i];e.push(n)}e=e.sort(this.sortHurt);for(var o=0;o<e.length;++o){var s=(CopyTeamProxy.ins().list[e[o].hurt],0==o?"MVP":(o+1).toString());this.info_list[o].text=""+s,this.info_list[o+3].text=""+e[o].name,this.info_list[o+6].text=""+UtilProxy.getSimpleNum(e[o].hurt||0)}this.roleName.text=e[0].name}else{for(var o=0;o<this.info_list.length;++o)this.info_list[o].text="";this.roleName.text=""}},e.prototype.sortHurt=function(t,e){return t.hurt>e.hurt?-1:t.hurt<e.hurt?1:0},e.prototype.SetAnchorState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.root.visible=i},e.prototype.onFRPushClick=function(t){ViewManager.ins().open(FirstRechargeView),this.FRPushTips.visible=!1,LimitActProxy.ins().IsShowFRPush=!1},e.prototype.CloseFRPush=function(){this.FRPushTips.visible=!1,this.frmodel.numChildren>0&&(this.frmovie.clear(),this.frmodel.removeChildren())},e.prototype.isShowFirstrecharge=function(){if(LimitActProxy.ins().IsFristRechargeOpen()){this.firstrechargeBtn.visible=!0,this.FRPushTips.visible=!0;var t=LimitActProxy.ins().GetActivityCfgs(1)[0];if(0==this.frmodel.numChildren){this.frmovie=new MovieClip;var e=UtilProxy.getShowImgPath()+t.charRes_wuqi[0];UtilProxy.GetMovieClip(e,this.frmovie,-1,void 0),this.frmodel.addChild(this.frmovie)}TimerManager.ins().remove(this.CloseFRPush,this),TimerManager.ins().doTimer(6e4,1,this.CloseFRPush,this)}else this.firstrechargeBtn.visible=!1,this.FRPushTips.visible=!1,this.frmodel.numChildren>0&&(this.frmovie.clear(),this.frmodel.removeChildren()),TimerManager.ins().remove(this.CloseFRPush,this)},e}(BaseEuiView);__reflect(MainFubenExp.prototype,"MainFubenExp"),window.MainFubenExp=MainFubenExp;var MainUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="mainui"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_atk,this.onClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onClick=function(t){GameMap.centerEntity.AI.getAIState()==AI_State.Atk?GameMap.centerEntity.AI.setAIState(AI_State.Stand):GameMap.centerEntity.AI.setAIState(AI_State.Atk)},e}(BaseEuiView);__reflect(MainUI.prototype,"MainUI"),ViewManager.ins().reg(MainUI,LayerManager.UI_Main),window.MainUI=MainUI;var MainUIBottomView=function(t){function e(){var e=t.call(this)||this;return e.skill_can_use=!1,e.exp_width=323,e.isConfigInit=!1,e.currentTargetIndex=-1,e.isXianFuViewOpen=!1,e.isStateOpenOther=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MainbottomSkin",this.sysButtons=[this.b1,this.b2,this.b3,this.b4,this.b5,this.b6,this.b7],this.itemBtnList=[this.itemsBtn,this.equipmentBtn,this.giftBtn],this.b7.setCD(3);for(var e=0;e<this.reds.numChildren;e++)this.reds.getChildAt(e).visible=!1;this.listGm.itemRenderer=BagItem,this.scrollerGm.viewport=this.listGm,this.listGm.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var n=0;n<this.sysButtons.length;n++)this.addTouchEvent(this.sysButtons[n],this.onSysClick);for(var n=0;n<this.itemBtnList.length;n++)this.addTouchEvent(this.itemBtnList[n],this.onItemMenuClick);this.addTouchEvent(this.GM,this.onClick),this.addTouchEvent(this.GM0,this.onClick),this.addTouchEvent(this.smeltbtn,this.onSmeltClick),EventProxy.AddListener(this,EventType.UpdataForgingRed,this.SetForgingRed),EventProxy.AddListener(this,EventType.UpdateBagStone,this.SetForgingRed),EventProxy.AddListener(this,EventType.UpdateRoleRed,this.SetRoleRed),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.AddListener(this,EventType.UpdateGodEquipRed,this.SetRoleRed),EventProxy.AddListener(this,EventType.updateWeaponRed,this.SetRoleRed),EventProxy.AddListener(this,EventType.RefreshTitleRed,this.SetRoleRed),EventProxy.AddListener(this,EventType.UpdateTaozhuangRed,this.SetRoleRed),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.SetRoleRed),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSwallowGetInfo,this.SetRoleRed),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.ShowSmeltBtn),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.RefreshHuoBanRed),EventProxy.AddListener(this,EventType.S2CRepSystemopenGetInfo,this.SystemopenGetInfo),EventProxy.AddListener(this,EventType.S2CRepSystemopenOpen,this.SystemOpen),EventProxy.AddListener(this,EventType.UpdateSkillRed,this.SetSkillRed),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.SetBagRed),EventProxy.AddListener(this,EventType.UpdataExpOrLevel,this.UpdataExpOrLevel),EventProxy.AddListener(this,EventType.XiuXianUpdate,this.onXiuXianUpdate),EventProxy.AddListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.AddListener(this,EventType.RefreshCopyRed,this.setXianFuRed),EventProxy.AddListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.setXianFuRed),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.setXianFuRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetInfo,this.setXianFuRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetScoreAward,this.setXianFuRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordUpdateInfo,this.setXianFuRed),EventProxy.AddListener(this,EventType.S2CRepFactionContribute,this.setXianFuRed),EventProxy.AddListener(this,EventType.VenationRedUpdate,this.SetRoleRed),EventProxy.AddListener(this,EventType.ChangeXianFuState,this.ChangeXianFuState),this.GMgroup.visible=!1,this.lq_actpic.visible=!1,this.ShowRoleData(),this.ShowSmeltBtn(),this.RefreshHuoBanRed(),this.setXianFuRed(),this.onXiuXianUpdate(),this.addTouchEvent(this.posBtn0,this.onPosClick),this.addTouchEvent(this.posBtn1,this.onPosClick),this.GM.visible=!SdkManager.isUseSdk;var o=["SetRoleRed","SetSkillRed","RefreshHuoBanRed","SetBagRed","SetForgingRed"],s=0;TimerManager.ins().doTimer(1e3,o.length,function(){s<o.length&&t[o[s]](),s+=1},this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.sysButtons.length;i++)this.removeTouchEvent(this.sysButtons[i],this.onSysClick);for(var i=0;i<this.itemBtnList.length;i++)this.removeTouchEvent(this.itemBtnList[i],this.onItemMenuClick);this.removeTouchEvent(this.GM,this.onClick),this.removeTouchEvent(this.GM0,this.onClick),this.removeTouchEvent(this.smeltbtn,this.onSmeltClick),EventProxy.RemoveListener(this,EventType.UpdataForgingRed,this.SetForgingRed),EventProxy.RemoveListener(this,EventType.UpdateRoleRed,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.RemoveListener(this,EventType.UpdateBagStone,this.SetForgingRed),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.UpdateGodEquipRed,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.updateWeaponRed,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.RefreshTitleRed,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSwallowGetInfo,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.ShowSmeltBtn),EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.RefreshHuoBanRed),EventProxy.RemoveListener(this,EventType.S2CRepSystemopenGetInfo,this.SystemopenGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepSystemopenOpen,this.SystemOpen),EventProxy.RemoveListener(this,EventType.UpdateSkillRed,this.SetSkillRed),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.SetBagRed),EventProxy.RemoveListener(this,EventType.UpdataExpOrLevel,this.UpdataExpOrLevel),EventProxy.RemoveListener(this,EventType.XiuXianUpdate,this.onXiuXianUpdate),EventProxy.RemoveListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.RemoveListener(this,EventType.RefreshCopyRed,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetInfo,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetScoreAward,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordUpdateInfo,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionContribute,this.setXianFuRed),EventProxy.RemoveListener(this,EventType.VenationRedUpdate,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.UpdateTaozhuangRed,this.SetRoleRed),EventProxy.RemoveListener(this,EventType.ChangeXianFuState,this.ChangeXianFuState),TimerManager.ins().remove(this.updateSkillCD,this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.GM:this.GMgroup.visible=!0;break;case this.GM0:""!=this.code.text&&GMProxy.ins().C2SReqGmCmd(this.code.text),this.GMgroup.visible=!1}},e.prototype.onSkillClick=function(t){this.skill_can_use&&(SkillCC.ins().play_bskill=!0,this.skill_can_use=!1)},e.prototype.updateSkillCD=function(){var t=SkillCC.ins().getBestSkill();if(t){var e=GlobalConfig.getSkillDescById(Math.floor(t.skillId/1e4)),i=71,n=72,o=e.cd-(t.skillCDTick-egret.getTimer()),s=e.cd,r=o/s>1?1:o/s;this.skill_cd.visible=!0,this.skill_can_use=r>=1?!0:!1,this.skill_cd.mask=new egret.Rectangle(0,n-n*r,i,n),o/s>1?(this.skill_cd.visible=!1,this.setSkillEff1(!0)):this.setSkillEff1(!1)}},e.prototype.setSkillEff0=function(t){this.skill_effect0.visible=t,t?(this.skill_effect0.touchEnabled=!1,this.skill_effect0.touchChildren=!1,0==this.skill_effect0.numChildren&&UtilProxy.GetMovieClipById(36,this.skill_effect0)):this.skill_effect0.numChildren>0&&this.skill_effect0.removeChildren()},e.prototype.setSkillEff1=function(t){this.skill_effect1.visible!=t&&(this.skill_effect1.visible=t,this.skill_effect1.touchEnabled=!1,this.skill_effect1.touchChildren=!1,t?0==this.skill_effect1.numChildren&&UtilProxy.GetMovieClipById(37,this.skill_effect1):this.skill_effect1.numChildren>0&&this.skill_effect1.removeChildren())},e.prototype.onItemMenuClick=function(t){for(var e=0;e<this.itemBtnList.length;e++)this.itemBtnList[e].icon="common_bg_anniudi";t.currentTarget.icon="common_bg_anniudi_on";var i=this.itemBtnList.lastIndexOf(t.currentTarget);if(this.isConfigInit||(GlobalConfig.getConfig("items","ItemsConfig"),GlobalConfig.getConfig("equipment","EquipmentConfig"),GlobalConfig.getConfig("gift","GiftConfig"),this.isConfigInit=!0),this.itemBtnList=[this.itemsBtn,this.equipmentBtn,this.giftBtn],this.currentTargetIndex!=i){var n;switch(t.currentTarget){case this.itemsBtn:n=GlobalConfig.ins().ItemsConfig;break;case this.equipmentBtn:n=GlobalConfig.ins().EquipmentConfig;break;case this.giftBtn:n=GlobalConfig.ins().GiftConfig}var o=new Array;for(var s in n){var r=n[s],a=new ItemCellData,h=r.id,l=0,p={item_slot_idx:0,item_type_id:h,item_count:l};a.setItemCellData(p),o.push(a)}this.listGm.dataProvider=new eui.ArrayCollection(o),this.listGm.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this),this.currentTargetIndex=i}},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer,i=e.data;if(void 0!=i){var n=Number(this.code.text)||1,o="item,"+i.item_type_id+",0,"+n;GMProxy.ins().C2SReqGmCmd(o),CommonUtils.log("C2SReqGmCmd",o)}},e.prototype.onSysClick=function(t){var e=this.sysButtons.indexOf(t.currentTarget),i="";switch(e){case 0:ViewManager.ins().open(XiuXianView),i="XiuXianView";break;case 1:ViewManager.ins().open(RoleView),i="RoleView";break;case 2:ViewManager.ins().open(SkillView),i="SkillView";break;case 3:ViewManager.ins().open(HuoBanView),i="HuoBanView";break;case 4:ViewManager.ins().open(BagView),i="BagView";break;case 5:ViewManager.ins().open(ForgingView),i="ForgingView";break;case 6:ViewManager.ins().getBackView()||ViewManager.ins().open(XianFuView)}if(""!=i){GlobalConfig.getConfig("tpl_view","tplViewConfig");for(var n in GlobalConfig.ins().tplViewConfig){var o=GlobalConfig.ins().tplViewConfig[n];i==o.tsScript&&SystemOpenProxy.ins().isCurOpenItem(1,o.id)&&SystemOpenProxy.ins().removeCurOpenItem(1,o.id)}}},e.prototype.onSmeltClick=function(t){BagProxy.ins().OneKeySmelt()},e.prototype.ShowSmeltBtn=function(){if(this.smeltbtn.visible=BagProxy.ins().GetBagLeftCount(BagType.EQUIP)<20,this.smeltbtn.visible){var t=this.smeltbtn.x,e=this.smeltbtn.x+10;egret.Tween.get(this.smeltbtn,{loop:!0}).to({x:e},500).to({x:t},500)}},e.prototype.SystemopenGetInfo=function(){this.SetForgingRed(),this.RefreshHuoBanRed()},e.prototype.SystemOpen=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&1==t[0]&&10==t[1]&&this.SetForgingRed()},e.prototype.SetSkillRed=function(){this.b3.setRed(SkillProxy.ins().getRed())},e.prototype.SetForgingRed=function(){this.lq_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emLQ),this.b6.setRed(SystemOpenProxy.ins().isOpen(1,10,!0)&&(ZhulingProxy.ins().getRed()||UpgradeProxy.ins().getRed()||UpStarProxy.ins().getRed()||SoulStoneProxy.ins().getRed()||RefineProxy.ins().getRed()||ZhuhunProxy.ins().getRed()))},e.prototype.SetRoleRed=function(){this.b2.setRed(VenationProxy.ins().getRed()||TaoZhuangProxy.ins().getRed()||WeaponProxy.ins().getRed()||BagProxy.ins().getHasEquipRed()||GrowupProxy.ins().getFashionRed()||GrowupProxy.ins().getFuyinRed()||GodEquipProxy.ins().getRed()||TitleProxy.ins().getRedByType(TitleUIType.reputation)||TitleProxy.ins().getRedByType(TitleUIType.title)||ZbTaoZhuangProxy.ins().getRedByAll()),this.b2.setRed(VenationProxy.ins().getRed()||TaoZhuangProxy.ins().getRed()||WeaponProxy.ins().getRed()||BagProxy.ins().getHasEquipRed()||GrowupProxy.ins().getFashionRed()||GrowupProxy.ins().getFuyinRed()||GodEquipProxy.ins().getRed()||TitleProxy.ins().getRedByType(TitleUIType.reputation)||TitleProxy.ins().getRedByType(TitleUIType.title))||EquipSwallowProxy.ins().getRed()},e.prototype.SetBagRed=function(){this.b5.setRed(BagProxy.ins().GetRed())},e.prototype.UpdataMoney=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.ShowRoleData()},e.prototype.ShowRoleData=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL);GlobalConfig.getRole_lvl_attrConfig(t)},e.prototype.UpdataExpOrLevel=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=e[0],o=(e[1],e[2]),s=(e[3],e[4]),r=.5,a=n?GlobalConfig.getRole_lvl_attrConfig(o):GlobalConfig.getRole_lvl_attrConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)),h=s/a.exp,l=function(){var e=Math.min(t.thumb.width/t.exp_width+.1*r,h);e>1?t.thumb.width=t.exp_width:t.thumb.width=t.exp_width*e,t.expEff||(t.expEff=UtilProxy.GetMovieClipById(67,t.expEffG,!1)),t.expEff.x=t.thumb.width,e>=h&&(TimerManager.ins().doTimer(1e3,1,function(){t.expEffG.removeChildren(),t.expEff=void 0},t),TimerManager.ins().remove(l,t))},p=function(){var e=Math.min(t.thumb.width/t.exp_width+.1*r,1);e>1?t.thumb.width=t.exp_width:t.thumb.width=t.exp_width*e,t.expEff||(t.expEff=UtilProxy.GetMovieClipById(67,t.expEffG,!1)),t.expEff.x=t.thumb.width,e>=1&&(TimerManager.ins().remove(p,t),TimerManager.ins().doTimer(100,10,l,t))};TimerManager.ins().remove(l,this),TimerManager.ins().remove(p,this),n?TimerManager.ins().doTimer(100,10,p,this):TimerManager.ins().doTimer(100,10,l,this)},e.prototype.RefreshHuoBanRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.b4.setRed(HuobanProxy.ins().getRed())},e.prototype.onPosClick=function(t){var e=Number(this.pos_x.text),i=Number(this.pos_y.text);switch(t.currentTarget){case this.posBtn0:this.skill_effect0.x=e,this.skill_effect0.y=i;break;case this.posBtn1:this.skill_effect1.x=e,this.skill_effect1.y=i}},e.prototype.onXiuXianUpdate=function(){this.b1.setRed(XiuXianProxy.ins().getRed())},e.prototype.SetAnchorState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.isXianFuViewOpen=!i,this.b7.icon=i?"main_icon_xianfu":"main_font_fanhui",this.isStateOpenOther=!i,this.setXianFuRed()},e.prototype.setXianFuRed=function(){this.isStateOpenOther?this.b7.setRed(!1):this.b7.setRed(XianFuProxy.ins().setRed())},e.prototype.ChangeXianFuState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=ViewManager.ins().isOpenCacheView();this.b7.icon=i?"main_font_fanhui":"main_icon_xianfu",this.isStateOpenOther=i,this.setXianFuRed()},e}(BaseEuiView);__reflect(MainUIBottomView.prototype,"MainUIBottomView"),ViewManager.ins().reg(MainUIBottomView,LayerManager.UI_Main2),window.MainUIBottomView=MainUIBottomView;var MainUIView=function(t){function e(){var e=t.call(this)||this;return e.topsysConX=48,e.topSysList=[],e.bottomSysList=[],e.isTopSysShow=!0,e.lyhlines=[],e.blood_x=231,e.limit_acttime=0,e.ReTrun_acttime=0,e.limit_rechargetime=0,e.dayrechargetime=0,e.zhigoutimelist=[0,0,0,0,0],e.IsShowFRView=!1,e.curShowFRid=0,e.backTPoint=new egret.Point(-147,79),e.backOPoint=new egret.Point(-177,109),e.skill_can_use=!1,e.yanhua_list=[],e.yanhua_num=0,e.isCanTopSysClick=!0,e.isCanClickSC=!0,e.isUpdateChallenge=!1,e.limitEndTime=0,e.dressColdTime=0,e.fightup_time=0,e.zhigoubtnlist=["ZhigouGift1","ZhigouGift2","ZhigouGift3","ZhigouGift4","XLQY"],e.minSMGiftTime=0,e.beStrongTip=void 0,e.isInitSevendayTips=!1,e.limiteGifsEndTime=0,e.isgroup_sysShow=!1,e.isBGIslanOpen=!1,e.isXFViewOpen=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.topSysList=new Array,this.skinName="MainViewTopSkin",this.vip_effect.visible=!UtilProxy.shield,this.vip.visible=!UtilProxy.shield,this.vipLvl.text="",this.otherG.visible=!0,this.bossReviveG_initx=this.bossReviveG.x,this.skill_list=[this.skill1,this.skill2,this.skill3,this.skill4,this.skill5,this.skill6],this.setgroup_sysState(!0),this.copyTimeG.visible=!1,this.copyFloorG.visible=!1,this.SetSystemList(),this.ShowTaskInfo(),this.showfighteff(),this.ShowRoleData(),this.UpdateVIP(),this.UpdateLyh(),this.updateOffline(),this.onXiuXianUpdate(),this.right_btn_list=[this.btn_r0,this.btn_r1,this.btn_r2,this.btn_r3,this.btn_r4,this.btn_r5,this.btn_r6],this.boss_tips.visible=!1,this.btn_exit.visible=!1,this.setTopHead(),this.ExpView.initUI(),this.dressTips.visible=!1,this.limitActBtn.visible=!1,this.FRPushTips.visible=!1,this.onlinegift.visible=!1,this.backG.visible=!1,this.guangKaG.visible=!1,this.bossExpBar.initUI(),this.FFPushTips.visible=!1,this.btn_r1.setEff(!0,45)},e.prototype.doYanhua=function(){var t=this;if(!(this.yanhua_num>11)){GameLogic.ins().isInXunyou()||TimerManager.ins().remove(this.doYanhua,this);var e=void 0;this.yanhua_list.length>0?e=this.yanhua_list.pop():(e=new MovieClip,this.gp_yanhua.addChild(e));var i=MathUtils.getRandom(80,StageUtils.ins().getWidth()-80),n=MathUtils.getRandom(100,StageUtils.ins().getWidth()-100);e.x=i,e.y=n,e.playFile("resource/assets/movie/ui_eff/10066",1,function(){t.yanhua_list.push(e),t.yanhua_num-=1},!1),this.yanhua_num+=1}},e.prototype.playYanHua=function(t){1==t?(this.yanhua_list=[],this.yanhua_num=0,TimerManager.ins().doTimer(500,0,this.doYanhua,this)):TimerManager.ins().remove(this.doYanhua,this)},e.prototype.setTopHead=function(){SetProxy.ins().useHead()<=0?this.top_head.source="common_touxiang_0"+RoleProxy.ins().getRoleSex():this.top_head.source=SetProxy.ins().getHeadIcon(SetProxy.ins().useHead()),SetProxy.ins().useHeadFrame()<=0?this.head_bg.source="shezhi_touxiangkuang_01":this.head_bg.source=SetProxy.ins().getHeadFrame(SetProxy.ins().useHeadFrame())},e.prototype.ShowRoleData=function(){this.zhanValue.text=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING).toString(),this.roleName.text=RoleProxy.ins().getRoleName(),this.roleLevel.text=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)+"级",this.money3.text=UtilProxy.getSimpleNum(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)),this.money2.text=UtilProxy.getSimpleNum(RoleProxy.ins().getMoneyAttr(MoneyAttr.COIN));var t=GlobalConfig.getZhuanById(RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN));this.lab_zhuan.text=UtilProxy.getStr("@0 转@1 重",[t.zhuan,t.lv])},e.prototype.UpdateVIP=function(){if(!UtilProxy.shield){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);t>18?(this.vipLvl.text=(t-18).toString(),this.vip.source="main_icon_vip_02",this.setVipEff()):(this.vip.source="main_icon_vip",this.vipLvl.text=t.toString()),this.setVipRed()}},e.prototype.RefreshVipRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setVipRed()},e.prototype.showfighteff=function(){var t,e,i=this,n="resource/skins/fight/fightshowClip";RES.getResByUrl(n+".json",function(o){o&&(t=o,RES.getResByUrl(n+".png",function(n){if(n){e=n;var o=new egret.MovieClipDataFactory(t,e);i.fightshow=new egret.MovieClip(o.generateMovieClipData("mainfight")),i.topAnchor.addChildAt(i.fightshow,2),i.fightshow.x=-428,i.fightshow.y=12,i.fightshow.gotoAndPlay("show",-1)}},i,RES.ResourceItem.TYPE_IMAGE))},this,RES.ResourceItem.TYPE_JSON)},e.prototype.InitSysItem=function(){for(var t=["main_icon_qiankunge","main_icon_tequanka","main_icon_fuli","main_icon_meirishouchong","main_icon_haohuashouchong","main_icon_chaojitouzi","main_btn_qtdl_01"],e=["TreasureBtn","main_icon_tequanka","main_icon_fuli","main_icon_meirishouchong","main_icon_haohuashouchong","main_icon_chaojitouzi","main_btn_qtdl_01"],i=0;9>i;++i){var n="";if(null!=t[i]){n=t[i];var o=new ButtonEx;o.icon=n,o.skinName="Btn0Skin",o.x=50*(i%7),o.y=50*Math.floor(i/7),this.topSysList[i]=o,this.topSysList[i].name=e[i]||"",this.topsysG.addChild(o),"main_icon_meirishouchong"==t[i]&&(this.dayFRBtn=this.topSysList[i]),"main_icon_haohuashouchong"==t[i]&&(this.FRBtn=this.topSysList[i]),"main_icon_chaojitouzi"==t[i]&&(this.cjtzBtn=this.topSysList[i]),"main_btn_qtdl_01"==t[i]&&(this.sevendayBtn=this.topSysList[i]),"main_icon_tequanka"==t[i]&&(this.PrivilegeBtn=this.topSysList[i])}}this.TreasureBtn=this.topSysList[1],this.welfareBtn=this.topSysList[2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DeviceUtils.IsWx||DeviceUtils.IsQQ?(this.gp_top.visible=!0,this.topAnchor.anchorOffsetY=-53,this.topLAnchor.y=137,this.trAnchor.top=243,this.limitActBtn.top=243):(this.gp_top.visible=!1,this.topAnchor.anchorOffsetY=0,this.topLAnchor.y=84,this.trAnchor.top=190,this.limitActBtn.top=190),this.ly_sweep_red=this.btn_r0.getChildAt(1);for(var i=0;i<this.right_btn_list.length;i++)this.addTouchEvent(this.right_btn_list[i],this.onRightBtnClick);this.addTouchEvent(this.skillChange,this.OnSkillChangeClick),this.addTouchEvent(this.topSysBtn,this.OnTopSysClick),this.addTouchEvent(this.music_icon,this.OnMuiscClick),this.addTouchEvent(this.task,this.OnTaskClick),this.addTouchEvent(this.btn_lyh,this.onGuan),this.addTouchEvent(this.chatBtn,this.OnChatClick),this.addTouchEvent(this.chatBtn1,this.OnChatClick),this.addTouchEvent(this.btn_skill,this.onSkillClick),this.addTouchEvent(this.btn_exit,this.onExitClick),this.addTouchEvent(this.MailBtn,this.onRightBtnClick),this.addTouchEvent(this.head_bg,this.onTopHeadClick),this.addTouchEvent(this.vip,this.onVipClick),this.addTouchEvent(this.rank,this.onRankClick),this.addTouchEvent(this.sysPreBtn,this.onOpenPreClick),this.addTouchEvent(this.closebtn,this.onDressClick),this.addTouchEvent(this.dressBtn,this.onDressClick),this.addTouchEvent(this.xiuxianActBtn,this.onXiuxianActClick),this.addTouchEvent(this.MakeBtn,this.onMakeClick),this.addTouchEvent(this.limitActBtn,this.onLimitActClick),this.addTouchEvent(this.firstRechargeBtn,this.onFirstRechargeClick),this.addTouchEvent(this.sys_yjfx,this.onYjFxClick),this.addTouchEvent(this.limitrechargeBtn,this.onLimitRechargeClick),this.addTouchEvent(this.BeStronger,this.onBeStrongClick),this.addTouchEvent(this.FRPushTips,this.onFRPushClick),this.addTouchEvent(this.onlinegift,this.onOnlineClick),this.addTouchEvent(this.btn_back,this.onBackMainClick),this.addTouchEvent(this.moneyImg2,this.onMoneyImgClick),this.addTouchEvent(this.moneyImg3,this.onMoneyImgClick),this.addTouchEvent(this.moneybg,this.onMoneyImgClick),this.addTouchEvent(this.auto_lyh,this.onLyhClick),EventProxy.AddListener(this,EventType.UpdataTask,this.ShowTaskInfo),EventProxy.AddListener(this,EventType.TaskIsCompleted,this.TaskIsCompleted),EventProxy.AddListener(this,EventType.S2CRepTaskRecorderInfo,this.ShowFinshTaskEffect),EventProxy.AddListener(this,EventType.UpdateFight,this.UpdateFightInfo),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.AddListener(this,EventType.S2CLeitaiGetInfo,this.ShowLeiTaiBtn),EventProxy.AddListener(this,EventType.LyhUpdateMonster,this.UpdateLyh),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.UpdateLyh),EventProxy.AddListener(this,EventType.CS2CChannelChat,this.S2CRepGlobalchatCross),EventProxy.AddListener(this,EventType.S2CEnterScene,this.S2CEnterScene),EventProxy.AddListener(this,EventType.S2CRepCopyEnterCopy,this.S2CRepCopyEnterCopy),EventProxy.AddListener(this,EventType.S2CRepCopyLeave,this.S2CRepCopyLeave),EventProxy.AddListener(this,EventType.S2CRepMiscSetHead,this.S2CRepMiscSetHead),EventProxy.AddListener(this,EventType.UpdateTujianRed,this.SetgS3Red),EventProxy.AddListener(this,EventType.S2CRepGrowupTujianUpgrade,this.SetgS3Red),EventProxy.AddListener(this,EventType.S2CRepGrowupTujianSuitActivate,this.SetgS3Red),EventProxy.AddListener(this,EventType.S2CRepMonsterDropOwerChange,this.S2CRepMonsterDropOwerChange),EventProxy.AddListener(this,EventType.BossMyHurt,this.BossMyHurt),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.updateOffline),EventProxy.AddListener(this,EventType.BossDead,this.BossDead),EventProxy.AddListener(this,EventType.XiuXianUpdate,this.onXiuXianUpdate),EventProxy.AddListener(this,EventType.S2CRepLimitActGetStateInfo,this.UpdateBtnR4),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdateStateInfo,this.UpdateBtnR4),EventProxy.AddListener(this,EventType.ActivityStateChange,this.UpdateBtnR4),EventProxy.AddListener(this,EventType.S2CRepActivityStart,this.UpdateBtnR4),EventProxy.AddListener(this,EventType.S2CRepActivityInfos,this.UpdateBtnR4),EventProxy.AddListener(this,EventType.S2CRepActivityFinish,this.UpdateBtnR4),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.UpdateBtnR5),EventProxy.AddListener(this,EventType.S2CRepActivityGetExtraAward,this.UpdateBtnR5),EventProxy.AddListener(this,EventType.S2CRepActivityGetBigAward,this.UpdateBtnR5),EventProxy.AddListener(this,EventType.LyhAutoState,this.onLyhState),EventProxy.AddListener(this,EventType.updateLv,this.ShowLeiTaiBtn),EventProxy.AddListener(this,EventType.RefreshCopyRed,this.RefreshCopyRed),EventProxy.AddListener(this,EventType.RefreshCopyRed,this.RefreshCopyRed),EventProxy.AddListener(this,EventType.RefreshTitleRed,this.RefreshTitleRed),EventProxy.AddListener(this,EventType.RefreshHuoBanRed,this.RefreshHuoBanRed),EventProxy.AddListener(this,EventType.RefreshBossRed,this.RefreshBossRed),EventProxy.AddListener(this,EventType.RefreshStoreRed,this.RefreshStoreRed),EventProxy.AddListener(this,EventType.RefreshMailRed,this.RefreshMailRed),EventProxy.AddListener(this,EventType.RefreshWelfareRed,this.RefreshWelfareRed),EventProxy.AddListener(this,EventType.RefreshFindtreasureRed,this.RefreshFindtreasureRed),EventProxy.AddListener(this,EventType.S2CRspWelfareGetSystemAward,this.S2CRspWelfareGetSystemAward),EventProxy.AddListener(this,EventType.RecommendItem,this.ShowDressTips),EventProxy.AddListener(this,EventType.S2CRepSystemopenGetInfo,this.S2CRepSystemopenGetInfo),EventProxy.AddListener(this,EventType.S2CRepGlobalchatCross,this.S2CRepGlobalchatCross),EventProxy.AddListener(this,EventType.S2CRepMiscGetSaveInfo,this.S2CRepMiscGetSaveInfo),EventProxy.AddListener(this,EventType.XyUpdateRed,this.SetXianyuanRed),EventProxy.AddListener(this,EventType.FwUpdateRed,this.SetFuwenRed),EventProxy.AddListener(this,EventType.FbUpdateRed,this.SetFabaoRed),EventProxy.AddListener(this,EventType.BaowuRedRefresh,this.SetBaowuRed),EventProxy.AddListener(this,EventType.S2CRepLimitActGetInfo,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetList,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActBuyGift,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetVipAward,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepRankGetRanksRole,this.ShowLimitActBtn),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryTake,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.ShowActBtnInfo),EventProxy.AddListener(this,EventType.S2CRepSystemopenOpen,this.SystemOpen),EventProxy.AddListener(this,EventType.S2CRspWelfareInvenstGetInfo,this.ShowCJTZBtn),EventProxy.AddListener(this,EventType.S2CRspWelfareInvenstBuy,this.ShowCJTZBtn),EventProxy.AddListener(this,EventType.S2CRspWelfareInvenstGetAward,this.ShowCJTZBtn),EventProxy.AddListener(this,EventType.S2CRspWelfareGetSevenDayAward,this.S2CRspWelfareGetSevenDayAward),EventProxy.AddListener(this,EventType.S2CRspWelfareGetInfo,this.S2CRspWelfareGetInfo),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.PushActView),EventProxy.AddListener(this,EventType.S2CVipGetTimes,this.ShowOnlineAward),EventProxy.AddListener(this,EventType.S2CRepVipGetOnlineAward,this.ShowOnlineAward),EventProxy.AddListener(this,EventType.S2CRepVipGetFreeGift,this.S2CRepVipGetFreeGift),EventProxy.AddListener(this,EventType.RefreshVipRed,this.RefreshVipRed),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.S2CRepLyhGetInfo),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.ShowTequanBtn),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialReward,this.ShowTequanBtn),EventProxy.AddListener(this,EventType.GuideDoEvent,this.GuideDoEvent),EventProxy.AddListener(this,EventType.S2CRepMiscRename,this.S2CRepMiscRename),EventProxy.AddListener(this,EventType.S2CRspWelfareGetMillionAward,this.S2CRspWelfareGetMillionAward),EventProxy.AddListener(this,EventType.S2CRepMiscDailyChange,this.setFreeGiftIcon),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.setFreeGiftIcon),EventProxy.AddListener(this,EventType.S2CRepMiscDailyChange,this.setXiuDian),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.UpdateBagInfo),EventProxy.AddListener(this,EventType.S2CRepAchievementGetInfo,this.S2CRepAchievementGetInfo),EventProxy.AddListener(this,EventType.S2CRepAchievementUpgrade,this.S2CRepAchievementUpgrade),EventProxy.AddListener(this,EventType.S2CRepMiscDailyChange,this.S2CRepMiscDailyChange),EventProxy.AddListener(this,EventType.PlayYanHua,this.playYanHua),EventProxy.AddListener(this,EventType.freshLimitActRed,this.freshLimitActRed),EventProxy.AddListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetScoreAward,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordUpdateInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionContribute,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepStoreGetBaokuInfo,this.SetBaokuRed),EventProxy.AddListener(this,EventType.S2CRepStoreBaokuExchange,this.SetBaokuRed),EventProxy.AddListener(this,EventType.S2CRepLyhGetInfo,this.lyGetInfoUpdate),EventProxy.AddListener(this,EventType.S2CRepLyhUpdateLayerInfo,this.lyGetInfoUpdate),EventProxy.AddListener(this,EventType.S2CRepLyhGetReward,this.setLyhRed),EventProxy.AddListener(this,EventType.S2CRepLyhSweep,this.lySpUpdate),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.needUpdate),EventProxy.AddListener(this,EventType.UpdateBossRevive,this.UpdateBossRevive),EventProxy.AddListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.AddListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),EventProxy.AddListener(this,EventType.S2CRepMiscGetSetupInfo,this.setTopHead),EventProxy.AddListener(this,EventType.copyFailUpdate,this.setBeStrongerIcon),EventProxy.AddListener(this,EventType.S2CRepMiscActiveHeadFrame,this.setRedIsSet),EventProxy.AddListener(this,EventType.S2CRepMiscActiveChatFrame,this.setRedIsSet),EventProxy.AddListener(this,EventType.S2CRepMiscActiveHead,this.setRedIsSet),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.setRedIsSet),EventProxy.AddListener(this,EventType.UpdateSetUp,this.setRedIsSet),EventProxy.AddListener(this,EventType.FacFightPushTips,this.SetFFPushTips),EventProxy.AddListener(this,EventType.S2CRepLimitActBuySmGift,this.setShenmiGiftIcon),EventProxy.AddListener(this,EventType.S2CRepLimitActSmGiftAppear,this.setShenmiGiftIcon),EventProxy.AddListener(this,EventType.S2CRepMiscDailyChange,this.setLotteryIcon),EventProxy.AddListener(this,EventType.ChangeBGIsland,this.ChangeBGIsland),EventProxy.AddListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.ShowCZQBtn),EventProxy.AddListener(this,EventType.S2CRspWelfareGetInfo,this.ShowCZQBtn),EventProxy.AddListener(this,EventType.S2CRspWelfareTopShareAward,this.ShowSCZDBtn),UtilProxy.isOpenWelcome()&&ViewManager.ins().open(WelcomeView),this.ExpView.open(),this.SetgS3Red(),this.setRedIsSet(),this.SetXianyuanRed(),this.SetFuwenRed(),this.SetBaowuRed(),this.SetFabaoRed(),this.SetFacRed(),this.setLyhRed(),this.setlySpRed(),this.UpdateBtnR4(),this.RefreshCopyRed(),this.SetMusicIconState(),this.RefreshMailRed(),this.setPreBtn(),this.RefreshBossRed(),ActivityProxy.ins().setActTips(),this.S2CRepGlobalchatCross(),this.setXiuxianActTips(),this.ShowActBtnInfo(),this.setFreeGiftIcon(),this.setXiuDian(),this.setShenmiGiftIcon(),this.setLotteryIcon(),this.SetSevendayIcon(),this.SetWelfareIcon(),this.setVipEff(),this.ShowOnlineAward(),this.initBackBtn(),this.ShowTequanBtn(),this.setXiuxianActBtnState(),this.setLimitBossBtn(),this.setSYTRankBossBtn(),this.setPreSysList(),this.UpdateBtnR5(),this.UpdateBtnR6(),this.ShowCJTZBtn(),this.ShowZBTaoBtn(),this.ShowLeiTaiBtn(),this.setBGIslandBtn(),this.ShowlimitedGifsBtn(),this.ShowCZQBtn(),this.setMakeRed(),this.setTrailBossBtn(),TimerManager.ins().remove(this.update,this),TimerManager.ins().doTimer(500,0,this.update,this),this.xiuxianActBtn.setEff(!0,45),this.xiuxianActBtn.setTopInfo(""),LimitActProxy.ins().GetServerOpenDay()<=WelfareProxy.ins().getXiuxianActDay()&&(TimerManager.ins().doTimer(1e3,0,this.updateXiuxianAct,this),this.updateXiuxianAct()),TimerManager.ins().doTimer(1e3,3,this.ShowFightUpBtn,this),this.setSkillEff0(!0),this.skill_effect1.visible=!1,this.setSkillEff1(!0),this.skill_cd.visible=!1,TimerManager.ins().doTimer(1e3,0,this.updateSkillCD,this),GuideProxy.ins().startCheck(),this.setAutoBossTimer(),this.UpdateBtnR4()
},e.prototype.update=function(){},e.prototype.setRedIsSet=function(){this.setRed.visible=SetProxy.ins().isRedByMain()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.topSysList.length;++i)this.removeTouchEvent(this.topSysList[i],this.onSysItemClick);this.removeTouchEvent(this.btn_skill,this.onSkillClick),this.removeTouchEvent(this.skillChange,this.OnSkillChangeClick),this.removeTouchEvent(this.topSysBtn,this.OnTopSysClick),this.removeTouchEvent(this.music_icon,this.OnMuiscClick),this.removeTouchEvent(this.task,this.OnTaskClick),this.removeTouchEvent(this.btn_lyh,this.onGuan),this.removeTouchEvent(this.chatBtn,this.OnChatClick),this.removeTouchEvent(this.chatBtn1,this.OnChatClick),this.removeTouchEvent(this.btn_exit,this.onExitClick),this.removeTouchEvent(this.head_bg,this.onTopHeadClick),this.removeTouchEvent(this.vip,this.onVipClick),this.removeTouchEvent(this.rank,this.onRankClick),this.removeTouchEvent(this.sysPreBtn,this.onOpenPreClick),this.removeTouchEvent(this.closebtn,this.onDressClick),this.removeTouchEvent(this.dressBtn,this.onDressClick),this.removeTouchEvent(this.xiuxianActBtn,this.onXiuxianActClick),this.removeTouchEvent(this.MakeBtn,this.onMakeClick),this.removeTouchEvent(this.limitActBtn,this.onLimitActClick),this.removeTouchEvent(this.firstRechargeBtn,this.onFirstRechargeClick),this.removeTouchEvent(this.sys_yjfx,this.onYjFxClick),this.removeTouchEvent(this.limitrechargeBtn,this.onLimitRechargeClick),this.removeTouchEvent(this.FRPushTips,this.onFRPushClick),this.removeTouchEvent(this.onlinegift,this.onOnlineClick),this.removeTouchEvent(this.BeStronger,this.onBeStrongClick),this.removeTouchEvent(this.btn_back,this.onBackMainClick),this.removeTouchEvent(this.moneyImg2,this.onMoneyImgClick),this.removeTouchEvent(this.moneyImg3,this.onMoneyImgClick),this.removeTouchEvent(this.moneybg,this.onMoneyImgClick),this.removeTouchEvent(this.auto_lyh,this.onLyhClick),EventProxy.RemoveListener(this,EventType.S2CLeitaiGetInfo,this.ShowLeiTaiBtn),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.lyGetInfoUpdate),EventProxy.RemoveListener(this,EventType.LyhUpdateMonster,this.UpdateLyh),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.RemoveListener(this,EventType.CS2CChannelChat,this.S2CRepGlobalchatCross),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.needUpdate),EventProxy.RemoveListener(this,EventType.updateLv,this.ShowLeiTaiBtn),EventProxy.RemoveListener(this,EventType.S2CRepTaskRecorderInfo,this.ShowFinshTaskEffect),EventProxy.RemoveListener(this,EventType.TaskIsCompleted,this.TaskIsCompleted),EventProxy.RemoveListener(this,EventType.UpdataTask,this.ShowTaskInfo),EventProxy.RemoveListener(this,EventType.S2CRepMiscGetSetupInfo,this.setTopHead),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.setRedIsSet),EventProxy.RemoveListener(this,EventType.UpdateSetUp,this.setRedIsSet),EventProxy.RemoveListener(this,EventType.S2CEnterScene,this.S2CEnterScene),EventProxy.RemoveListener(this,EventType.S2CRepCopyEnterCopy,this.S2CRepCopyEnterCopy),EventProxy.RemoveListener(this,EventType.S2CRepCopyLeave,this.S2CRepCopyLeave),EventProxy.RemoveListener(this,EventType.S2CRepMiscSetHead,this.S2CRepMiscSetHead),EventProxy.RemoveListener(this,EventType.UpdateTujianRed,this.SetgS3Red),EventProxy.RemoveListener(this,EventType.S2CRepGrowupTujianUpgrade,this.SetgS3Red),EventProxy.RemoveListener(this,EventType.S2CRepGrowupTujianSuitActivate,this.SetgS3Red),EventProxy.RemoveListener(this,EventType.S2CRepMonsterDropOwerChange,this.S2CRepMonsterDropOwerChange),EventProxy.RemoveListener(this,EventType.BossMyHurt,this.BossMyHurt),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.updateOffline),EventProxy.RemoveListener(this,EventType.BossDead,this.BossDead),EventProxy.RemoveListener(this,EventType.S2CRepLyhUpdateLayerInfo,this.lyGetInfoUpdate),EventProxy.RemoveListener(this,EventType.XiuXianUpdate,this.onXiuXianUpdate),EventProxy.RemoveListener(this,EventType.S2CRepVipGetFreeGift,this.S2CRepVipGetFreeGift),EventProxy.RemoveListener(this,EventType.RefreshVipRed,this.RefreshVipRed),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetStateInfo,this.UpdateBtnR4),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdateStateInfo,this.UpdateBtnR4),EventProxy.RemoveListener(this,EventType.ActivityStateChange,this.UpdateBtnR4),EventProxy.RemoveListener(this,EventType.S2CRepActivityStart,this.UpdateBtnR4),EventProxy.RemoveListener(this,EventType.S2CRepActivityInfos,this.UpdateBtnR4),EventProxy.RemoveListener(this,EventType.S2CRepActivityFinish,this.UpdateBtnR4),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.UpdateBtnR5),EventProxy.RemoveListener(this,EventType.S2CRepActivityGetExtraAward,this.UpdateBtnR5),EventProxy.RemoveListener(this,EventType.S2CRepActivityGetBigAward,this.UpdateBtnR5),EventProxy.RemoveListener(this,EventType.LyhAutoState,this.onLyhState),EventProxy.RemoveListener(this,EventType.RefreshCopyRed,this.RefreshCopyRed),EventProxy.RemoveListener(this,EventType.RefreshTitleRed,this.RefreshTitleRed),EventProxy.RemoveListener(this,EventType.RefreshHuoBanRed,this.RefreshHuoBanRed),EventProxy.RemoveListener(this,EventType.RefreshBossRed,this.RefreshBossRed),EventProxy.RemoveListener(this,EventType.RefreshStoreRed,this.RefreshStoreRed),EventProxy.RemoveListener(this,EventType.RefreshMailRed,this.RefreshMailRed),EventProxy.RemoveListener(this,EventType.RefreshWelfareRed,this.RefreshWelfareRed),EventProxy.RemoveListener(this,EventType.RefreshFindtreasureRed,this.RefreshFindtreasureRed),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetSystemAward,this.S2CRspWelfareGetSystemAward),EventProxy.RemoveListener(this,EventType.RecommendItem,this.ShowDressTips),EventProxy.RemoveListener(this,EventType.S2CRepSystemopenGetInfo,this.S2CRepSystemopenGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepGlobalchatCross,this.S2CRepGlobalchatCross),EventProxy.RemoveListener(this,EventType.S2CRepMiscGetSaveInfo,this.S2CRepMiscGetSaveInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetInfo,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetList,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuyGift,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetVipAward,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepRankGetRanksRole,this.ShowLimitActBtn),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryInfo,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryTake,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActLotteryOpenBox,this.ShowActBtnInfo),EventProxy.RemoveListener(this,EventType.XyUpdateRed,this.SetXianyuanRed),EventProxy.RemoveListener(this,EventType.FwUpdateRed,this.SetFuwenRed),EventProxy.RemoveListener(this,EventType.FbUpdateRed,this.SetFabaoRed),EventProxy.RemoveListener(this,EventType.BaowuRedRefresh,this.SetBaowuRed),EventProxy.RemoveListener(this,EventType.S2CRepSystemopenOpen,this.SystemOpen),EventProxy.RemoveListener(this,EventType.S2CRspWelfareInvenstGetInfo,this.ShowCJTZBtn),EventProxy.RemoveListener(this,EventType.S2CRspWelfareInvenstBuy,this.ShowCJTZBtn),EventProxy.RemoveListener(this,EventType.S2CRspWelfareInvenstGetAward,this.ShowCJTZBtn),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetSevenDayAward,this.S2CRspWelfareGetSevenDayAward),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetInfo,this.S2CRspWelfareGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.PushActView),EventProxy.RemoveListener(this,EventType.S2CVipGetTimes,this.ShowOnlineAward),EventProxy.RemoveListener(this,EventType.S2CRepVipGetOnlineAward,this.ShowOnlineAward),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.S2CRepLyhGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.ShowTequanBtn),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialReward,this.ShowTequanBtn),EventProxy.RemoveListener(this,EventType.GuideDoEvent,this.GuideDoEvent),EventProxy.RemoveListener(this,EventType.S2CRepMiscRename,this.S2CRepMiscRename),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetMillionAward,this.S2CRspWelfareGetMillionAward),EventProxy.RemoveListener(this,EventType.S2CRepMiscDailyChange,this.setFreeGiftIcon),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.setFreeGiftIcon),EventProxy.RemoveListener(this,EventType.S2CRepMiscDailyChange,this.setXiuDian),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.UpdateBagInfo),EventProxy.RemoveListener(this,EventType.S2CRepAchievementGetInfo,this.S2CRepAchievementGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepAchievementUpgrade,this.S2CRepAchievementUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepMiscDailyChange,this.S2CRepMiscDailyChange),EventProxy.RemoveListener(this,EventType.PlayYanHua,this.playYanHua),EventProxy.RemoveListener(this,EventType.freshLimitActRed,this.freshLimitActRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetScoreAward,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordUpdateInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionContribute,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepStoreGetBaokuInfo,this.SetBaokuRed),EventProxy.RemoveListener(this,EventType.S2CRepStoreBaokuExchange,this.SetBaokuRed),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetInfo,this.setLyhRed),EventProxy.RemoveListener(this,EventType.S2CRepLyhGetReward,this.setLyhRed),EventProxy.RemoveListener(this,EventType.S2CRepLyhSweep,this.lySpUpdate),EventProxy.RemoveListener(this,EventType.UpdateBossRevive,this.UpdateBossRevive),EventProxy.RemoveListener(this,EventType.ChangeMainAchorState,this.SetAnchorState),EventProxy.RemoveListener(this,EventType.ChangeBGIsland,this.ChangeBGIsland),EventProxy.RemoveListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),EventProxy.RemoveListener(this,EventType.copyFailUpdate,this.setBeStrongerIcon),EventProxy.RemoveListener(this,EventType.copyFailUpdate,this.setBeStrongerIcon),EventProxy.RemoveListener(this,EventType.S2CRepMiscActiveHeadFrame,this.setRedIsSet),EventProxy.RemoveListener(this,EventType.S2CRepMiscActiveChatFrame,this.setRedIsSet),EventProxy.RemoveListener(this,EventType.S2CRepMiscActiveHead,this.setRedIsSet),EventProxy.RemoveListener(this,EventType.FacFightPushTips,this.SetFFPushTips),EventProxy.RemoveListener(this,EventType.S2CRepLimitActBuySmGift,this.setShenmiGiftIcon),EventProxy.RemoveListener(this,EventType.S2CRepLimitActSmGiftAppear,this.setShenmiGiftIcon),EventProxy.RemoveListener(this,EventType.S2CRepMiscDailyChange,this.setLotteryIcon),EventProxy.RemoveListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.ShowCZQBtn),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetInfo,this.ShowCZQBtn),EventProxy.RemoveListener(this,EventType.S2CRspWelfareTopShareAward,this.ShowSCZDBtn),TimerManager.ins().remove(this.setShenmiGiftTimer,this),TimerManager.ins().remove(this.SetLimitActTimeLab,this),TimerManager.ins().remove(this.update,this),TimerManager.ins().remove(this.LimitedGifsTime,this),this.ExpView.close()},e.prototype.S2CRepMiscRename=function(t){this.ShowRoleData(),this.setTopHead()},e.prototype.onMoneyImgClick=function(t){t.currentTarget==this.moneyImg2?TipsControl.ins().ShowPathTips(MoneyAttr.COIN):(t.currentTarget==this.moneyImg3||t.currentTarget==this.moneybg)&&NoticeProxy.ins().OpenRecharge()},e.prototype.onLyhClick=function(){var t=this;if(LyhProxy.ins().getAutoState()){var e=!LyhProxy.ins().getAutoState();LyhProxy.ins().setAutoState(e),this.auto_lyh.source=LyhProxy.ins().getAutoState()?"main_btn_zidongzhong":"main_btn_zidong"}else{var i=GlobalConfig.getLyhMisc(),n=UtilProxy.getStr("C:10&VIP@0 |或炼妖壶达到|C:10&@1 |关可开启自动挑战，获得以下便捷功能：",[i.vip_lv,i.auto_lv_open]);i.vip_lv>18&&(n=UtilProxy.getStr("C:10&SVIP@0 |或炼妖壶达到|C:10&@1 |关可开启自动挑战，获得以下便捷功能：",[i.vip_lv-18,i.auto_lv_open]));var o="提升Vip";(LyhProxy.ins().getCurId()>=i.auto_lv_open||RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=i.vip_lv)&&(n="开始自动挑战，获得以下功能：",o="确定"),TipsControl.ins().ShowTips1(n+"\r\n    1.自动挑战首领\r\n    2.自动熔炼装备",function(){},function(){return LyhProxy.ins().getCurId()<i.auto_lv_open&&RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)<i.vip_lv?void((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?UtilProxy.openView(53,0):UtilProxy.openView(62,0)):(LyhProxy.ins().setAutoState(!0),void(t.auto_lyh.source="main_btn_zidongzhong"))},!1,"取消",o)}},e.prototype.onBeStrongClick=function(t){TimerManager.ins().remove(this.beStrongerTimerEnd,this),this.beStrongerTimerEnd(),ViewManager.ins().open(BeStrongerView)},e.prototype.onSysItemClick=function(t){var e=this.topSysList.indexOf(t.currentTarget);if(!(0>e)){var i=this.topSysList[e].data,n=i.name,o=this.topSysList[e].icon,s=0==i.page?1:2,r=0==i.page?Number(i.view_id):100*Number(i.view_id)+i.page,a=SystemOpenProxy.ins().isCurOpenItem(s,r);"Sevenday"==n&&this.sevenday_tips&&this.sevenday_tips.visible&&(this.sevenday_tips.visible=!1),"SuperInvest"==n&&(this.super_tips.visible=!1,WelfareProxy.ins().IsShowSuperTips=!1),"main_icon_fuli"==o?ViewManager.ins().open(WelfareView):"main_icon_qiankunge"==o?ViewManager.ins().open(TreasureView):"main_icon_tequanka"==o?ViewManager.ins().open(PrivilegeView):"main_icon_meirishouchong"==o?ViewManager.ins().open(DayFRView):"main_icon_haohuashouchong"==n?ViewManager.ins().open(LuxuryFRView):"main_icon_chaojitouzi"==o?ViewManager.ins().open(SuperInvestView):"main_btn_zhutizhuanpan"==o?ViewManager.ins().open(LotteryView,30,99):"LingYuan"==n?(t.currentTarget.setRed(!1),ViewManager.ins().open(LingYuanView)):"XiuDian"==n?(ViewManager.ins().open(XiuDianView),this.getSysItemByName("XiuDian").setEff(!1)):"lianchong"==n?ViewManager.ins().OpenViewById(Number(i.view_id),i.page):"FR"==n?NoticeProxy.ins().OpenRecharge():"shouji"==n?ViewManager.ins().open(ZbTaoZhuang):"LimitBoss"==n?(CopyProxy.ins().isInitBossLimit&&(CopyProxy.ins().isInitBossLimit=!1,EventProxy.Broast(EventType.freshLimitActRed,[])),ViewManager.ins().OpenViewById(Number(i.view_id),i.page>0?i.page:void 0)):1==i.is_contain?ViewManager.ins().open(ContainSystemView,void 0,i.id,t.currentTarget):ViewManager.ins().OpenViewById(Number(i.view_id),i.page>0?i.page:void 0),a&&(SystemOpenProxy.ins().removeCurOpenItem(s,r),MainProxy.ins().getSystemRedByName(i.name))}},e.prototype.onFirstRechargeClick=function(t){var e=t.currentTarget.icon;"main_icon_shouchong"==e?(ViewManager.ins().open(FirstRechargeView),this.FRPushTips.visible=!1,LimitActProxy.ins().IsShowFRPush=!1):"main_icon_haohuashouchong"==e&&ViewManager.ins().open(LuxuryFRView)},e.prototype.onYjFxClick=function(){ViewManager.ins().open(yjfxView)},e.prototype.onFRPushClick=function(t){ViewManager.ins().open(FirstRechargeView),this.FRPushTips.visible=!1,LimitActProxy.ins().IsShowFRPush=!1},e.prototype.onOnlineClick=function(t){ViewManager.ins().open(OnlineGiftView)},e.prototype.onLimitRechargeClick=function(t){ViewManager.ins().open(LimitRechargeView)},e.prototype.S2CRepMiscSetHead=function(){this.setTopHead()},e.prototype.setLyhRed=function(){this.ly_red.visible=LyhProxy.ins().getRed()},e.prototype.lyGetInfoUpdate=function(){this.setLyhRed()},e.prototype.lySpUpdate=function(){},e.prototype.setlySpRed=function(){this.ly_sweep_red.visible=LyhProxy.ins().getLyhSdRed()},e.prototype.onExitClick=function(t){var e=this;if(CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId))TipsControl.ins().ShowTips1("中途退出视为挑战失败，是否确定退出",function(){},function(){GameLogic.ins().onExitCopy(),e.S2CRepCopyLeave([!0])});else if(CopyProxy.ins().isTopFight(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isZMZD(GameLogic.ins().getCurSceneId()))TipsControl.ins().ShowTips1("中途退出视为挑战失败，是否确定退出",function(){},function(){CopyProxy.ins().C2SReqCopyLeave(0)});else if(ZPZBProxy.ins().IsZPZB(GameLogic.ins().getCurSceneId()))TipsControl.ins().ShowTips1("活动尚未结束，是否确定退出",function(){},function(){CopyProxy.ins().C2SReqCopyLeave(0)});else if(CopyProxy.ins().isTeamExp(GameLogic.ins().getCurSceneId())&&CopyProxy.ins().isBossLimitScene(GameLogic.ins().getCurSceneId()))TipsControl.ins().ShowTips1("副本尚未结束，是否确定退出",function(){},function(){CopyProxy.ins().C2SReqCopyLeave(0)});else{var i=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());if(!i||9!=i.speciallogic_type&&18!=i.speciallogic_type&&41!=i.speciallogic_type)CopyProxy.ins().C2SReqCopyLeave(0);else{var n=GameLogic.ins().getLastScene(),o=GlobalConfig.getSceneConfigById(n);SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),o.x,o.y),9==i.speciallogic_type&&(BossProxy.ins().isAutoChallenge=!1)}}},e.prototype.onTopHeadClick=function(t){ViewManager.ins().open(SetUIView)},e.prototype.OnTaskClick=function(t){TaskProxy.ins().onTaskMain()},e.prototype.OnChatClick=function(t){ViewManager.ins().open(ChatUIView)},e.prototype.onVipClick=function(t){ViewManager.ins().open(VIPView)},e.prototype.onRankClick=function(t){ViewManager.ins().open(RankView)},e.prototype.onDressClick=function(t){this.DressClick(t.currentTarget)},e.prototype.DressClick=function(t){if(this.dressTips.visible=!1,this.ShowDress)if(1==this.ShowDress.itemConfig.type){var e=this.ShowDress.itemConfig;t==this.dressBtn&&BagProxy.ins().C2SReqKnapsackArm(this.ShowDress.item_slot_idx,e.part),BagProxy.ins().PutDressList[e.part]=void 0}else{if(t==this.dressBtn){var i=!0;if(2!=this.ShowDress.itemConfig.type||4!=this.ShowDress.itemConfig.subtype){var e=this.ShowDress.itemConfig;e.openview.length>0&&(i=!1,GuideProxy.ins().getGuideState()||ViewManager.ins().OpenViewById(e.openview[0],e.openview[1]))}if(i){var n=[],o=[];o[0]=this.ShowDress.item_slot_idx,o[1]=this.ShowDress.item_count,n[0]=o,BagProxy.ins().C2SReqKnapsackUse(n)}}BagProxy.ins().recomonItemList[this.ShowDress.item_slot_idx]=void 0}this.dressColdTime=0,TimerManager.ins().remove(this.SetDressTimeLab,this),this.ShowDressTips()},e.prototype.OnTopSysClick=function(t){this.setTopSys()},e.prototype.setTopSys=function(){if(this.isCanTopSysClick){this.isCanTopSysClick=!1,this.topSysBtn.rotation+=this.isTopSysShow?-180:180,this.isTopSysShow=!this.isTopSysShow,this.topsysCon.visible=!0;var t=(this.topsysCon.x,this.isTopSysShow?this.topsysConX:this.topsysConX-400);!this.isTopSysShow&&this.sevenday_tips&&this.sevenday_tips.visible&&(this.sevenday_tips.visible=!1),!this.isTopSysShow&&this.super_tips&&this.super_tips.visible&&(this.super_tips.visible=!1);var e=function(){this.isTopSysShow||(this.topsysCon.visible=!1),this.isCanTopSysClick=!0};egret.Tween.get(this.topsysCon,{onChange:e,onChangeObj:this}).to({x:t},500,egret.Ease.backInOut)}},e.prototype.onOpenPreClick=function(t){ViewManager.ins().open(SystemPreView)},e.prototype.onSystemClick=function(t){var e=this.bottomSysList.indexOf(t.currentTarget);if(!(0>e)){var i=this.bottomSysList[e].data;if(i){if(1==i.is_contain)return void ViewManager.ins().open(ContainSystemView,void 0,i.id,t.currentTarget);var n=Number(i.view_id),o=0==i.page?1:2,s=0==i.page?n:100*n+i.page,r=SystemOpenProxy.ins().isCurOpenItem(o,s);35==n?XyProxy.ins().is_marry?ViewManager.ins().open(XianYuanView):ViewManager.ins().open(XyylView):ViewManager.ins().OpenViewById(n),r&&(MainProxy.ins().getSystemRedByName(i.name),SystemOpenProxy.ins().removeCurOpenItem(o,s))}}},e.prototype.getSysItemByName=function(t){for(var e=0;e<this.bottomSysList.length;++e)if(this.bottomSysList[e].data&&this.bottomSysList[e].data.name==t)return this.bottomSysList[e];for(var e=0;e<this.topSysList.length;++e)if(this.topSysList[e].data&&this.topSysList[e].data.name==t)return this.topSysList[e]},e.prototype.SetgS3Red=function(){var t=this.getSysItemByName("Book");t&&t.setRed(GrowupProxy.ins().getTujianRed())},e.prototype.SetXianyuanRed=function(){var t=this.getSysItemByName("XianYuan");t&&t.setRed(XyProxy.ins().getRed())},e.prototype.SetFuwenRed=function(){var t=this.getSysItemByName("Fuwen");t&&t.setRed(FwProxy.ins().getRed())},e.prototype.SetBaowuRed=function(){var t=this.getSysItemByName("Baowu");t&&t.setRed(BaoWuProxy.ins().getRed())},e.prototype.SetFabaoRed=function(){var t=this.getSysItemByName("Fabao");t&&t.setRed(FabaoProxy.ins().getRed())},e.prototype.SetFacRed=function(){var t=this.getSysItemByName("Fac");t&&t.setRed(LunjianProxy.ins().getRed()||FacFightProxy.ins().getRed()||FacProxy.ins().getRed())},e.prototype.onXiuXianClick=function(t){ViewManager.ins().open(XiuXianView)},e.prototype.OnMuiscClick=function(t){var e=!MainProxy.ins().isMusic;MainProxy.ins().isMusic=e,SoundManager.ins().setBgOn(e),this.SetMusicIconState()},e.prototype.SetMusicIconState=function(){this.music_icon.icon=MainProxy.ins().isMusic?"main_btn_music_on":"main_btn_music_off"},e.prototype.onGuan=function(t){ViewManager.ins().open(LyhView)},e.prototype.onRightBtnClick=function(t){switch(t.currentTarget){case this.btn_r0:ViewManager.ins().open(LyhSweep);break;case this.btn_r1:ViewManager.ins().open(BeastGhostIslandView),this.btn_r1.setEff(!1);break;case this.btn_r2:ViewManager.ins().open(BossUIView),this.bossReviveG.visible=!1,egret.Tween.removeTweens(this.bossReviveG);break;case this.btn_r3:ViewManager.ins().open(FubenView);break;case this.btn_r4:"main_btn_zongpaizhengba"==this.btn_r4.icon?FacProxy.ins().getFacId()>0?ViewManager.ins().open(ZPZBMainView):ViewManager.ins().open(FacView):"main_btn_yanluoshendian"==this.btn_r4.icon?ViewManager.ins().open(BossUIView,BOSSTYPE.YAMA):"main_btn_zongzhuzhengduo"==this.btn_r4.icon?FacProxy.ins().getFacId()>0?ViewManager.ins().open(FacFightView):ViewManager.ins().open(FacView):PvpProxy.ins().OpenTopFight();break;case this.btn_r5:ViewManager.ins().open(PrivilegeGiftView);break;case this.btn_r6:ViewManager.ins().open(ActHallView,2);break;case this.MailBtn:ViewManager.ins().open(MailView)}},e.prototype.OnSkillChangeClick=function(t){var e=this;if(this.isCanClickSC){this.isCanClickSC=!1;var i=MainProxy.ins().isShowSkill;i?(this.setgroup_sysState(!0),egret.Tween.get(this.group_skill,{onChange:function(){e.isCanClickSC=!0},onChangeObj:this}).to({x:0},500,egret.Ease.backInOut)):(this.setgroup_sysState(!0),egret.Tween.get(this.group_skill,{onChange:function(){e.setgroup_sysState(!1),e.isCanClickSC=!0},onChangeObj:this}).to({x:300},500,egret.Ease.backInOut)),MainProxy.ins().isShowSkill=!i}},e.prototype.UpdataMoney=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];i==MoneyAttr.VIP_EXP?this.UpdateVIP():this.ShowRoleData(),i==MoneyAttr.LEVEL&&this.ShowCJTZBtn(),i==MoneyAttr.ZHUAN&&i==MoneyAttr.ZHUAN&&(this.setPreBtn(),this.UpdateBtnR6()),i==MoneyAttr.VIP_LEVEL||i==MoneyAttr.VIP_EXP?this.setYjfxBtn():i==MoneyAttr.LEVEL&&this.setFreeGiftIcon()},e.prototype.UpdateFightInfo=function(){this.ShowRoleData()},e.prototype.ShowTaskInfo=function(){var t=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());if(t&&1!=t.scene_type||void 0==TaskProxy.ins().taskMain||void 0==TaskProxy.ins().taskMain.task_id||CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId))return void(this.task.visible=!1);this.task.visible=!0;var e=GlobalConfig.getTaskConfig(TaskProxy.ins().taskMain.task_id);RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)<e.level?this.task_desc.textFlow=UtilProxy.StrFormart("|C:4&@0 级可接取|",[e.level]):this.task_desc.textFlow=UtilProxy.StrFormart("@0 ",[TaskProxy.ins().GetTaskDesc()]),1==TaskProxy.ins().taskMain.is_completed&&0==this.task_effect.numChildren&&UtilProxy.GetMovieClipById(31,this.task_effect),this.task_lb.textFlow=UtilProxy.generateTextFlow(e.award_desc),1==TaskProxy.ins().taskMain.is_completed&&1==e.is_auto&&TaskProxy.ins().onTaskMain()},e.prototype.TaskIsCompleted=function(){var t=UtilProxy.GetMovieClipById(62,this.task_effect0);t&&(t.y=t.y-100)},e.prototype.ShowFinshTaskEffect=function(){this.task_effect.removeChildren()},e.prototype.UpdateLyh=function(){var t=LyhProxy.ins().getCurData();if(t){this.guanInfo.text="第"+t.id+"关";for(var e=0;e<t.kill_scale;e++){if(void 0==this.lyhlines[e]){var i=new eui.Image;i.y=66,i.width=1,i.height=6,i.source="main_bg_guanqiajindutiao_fenge",this.btn_lyh.addChild(i),this.lyhlines.push(i)}this.lyhlines[e].x=13+this.lyh_bg.width/t.kill_scale*(e+1)}var n=53/t.kill_scale,o=t.kill_num/t.kill_scale,s=Math.floor(LyhProxy.ins().getCurValue()/o);this.lyh_img.width=(s>=t.kill_scale?t.kill_scale:s)*n;var r=GlobalConfig.getLyhMisc();0==t.kill_num&&(this.lyh_img.width=53),r&&(this.auto_lyh.visible=t.id-1>=r.auto_lv),this.auto_lyh.visible&&(this.auto_lyh.source=LyhProxy.ins().getAutoState()?"main_btn_zidongzhong":"main_btn_zidong"),DisplayUtils.shakeIt(this.btn_lyh,2,500,-1,function(){var t=LyhProxy.ins().getCurData();if(!t)return!1;var e=t.kill_num/t.kill_scale,i=Math.floor(LyhProxy.ins().getCurValue()/e);return i>=t.kill_scale}),this.auto_lyh.visible=!UtilProxy.shield}else this.guanInfo.text="已通关",this.auto_lyh.visible=!1;this.setPreSysList()},e.prototype.onLyhState=function(t){this.auto_lyh.source=t?"main_btn_zidongzhong":"main_btn_zidong"},e.prototype.S2CEnterScene=function(t){var e=this,i=GlobalConfig.getSceneConfigById(t);if(void 0!=i){if(this.ExpView.visible&&this.ExpView.setVisible(!1),(2==i.scene_type||3==i.scene_type||4==i.scene_type)&&LyhProxy.ins().getCurId()<3&&TimerManager.ins().doTimer(4e3,1,function(){GuideProxy.ins().DoGuideCopy()},this),this.imgSword.visible=!1,this.bossExpBar.remove(),this.bossG.visible=!1,this.rFuben.visible=!1,this.bNotSKillG.visible=!0,this.setgroup_sysState(!0),this.sevenday_tips&&this.sevenday_tips.visible&&(this.sevenday_tips.visible=!1),this.super_tips.visible=!1,this.setGuanKa(!1),this.btn_back.visible=1==i.scene_type,this.btn_back.icon=i.id!=MainProxy.MainSceneId()?"main_btn_huicheng":"main_btn_yewai",this.SetBackG(!1),this.copyFloorG.visible=!1,1==i.scene_type&&i.id==MainProxy.MainSceneId()){var n=GlobalConfig.getMisc_dataConfig(1).back_world_times;TimerManager.ins().doTimer(n,1,this.setGackGTrue,this)}this.ShowLimitActBtn(),this.ShowActBtnInfo(),this.PushActView(),this.ShowFRPushTips(),this.ShowlimitedGifsBtn(),this.FRPushTips.visible&&1!=i.scene_type&&(this.FRPushTips.visible=!1),this.FFPushTips.visible&&1!=i.scene_type&&(this.FFPushTips.visible=!1),this.ShowOnlineAward(),this.onlinegift.visible&&1!=i.scene_type&&(this.onlinegift.visible=!1),this.setLimitBossTime();var o=!1;if(11==i.speciallogic_type||9==i.speciallogic_type||7==i.speciallogic_type||CopyProxy.ins().isLyh(CopyProxy.ins().copyId)||CopyProxy.ins().isSYT(CopyProxy.ins().copyId)||18==i.speciallogic_type||41==i.speciallogic_type||CopyProxy.ins().isSHT(CopyProxy.ins().copyId)){this.task.visible=!1,this.btn_exit.visible=!0,this.blMain.visible=!1,this.auto_lyh.visible=!1,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.boss_tips.visible=!0,this.boss_tips.alpha=1,this.boss_tips.x=480;var s=1;if(egret.Tween.get(this.boss_tips,{onChange:function(){},onChangeObj:this}).to({x:0},500).call(function(){var t=function(){s-=.1,0>s?(this.boss_tips.visible=!1,TimerManager.ins().remove(t,this)):this.boss_tips.alpha=s};TimerManager.ins().doTimer(100,0,t,e)}),o=!0,this.isTopSysShow&&this.setTopSys(),CopyProxy.ins().isSwordCopy(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isSYT(CopyProxy.ins().copyId)||CopyProxy.ins().isSHT(CopyProxy.ins().copyId)||CopyProxy.ins().isLyh(CopyProxy.ins().copyId)||11==i.speciallogic_type)this.setImgSword(),this.bossG.visible=!0,this.limitActBtn.visible=!1,this.FRPushTips.visible=!1,this.onlinegift.visible=!1,this.bossExpBar.SetExp(1,1),this.setBossHurt();else if(7==i.speciallogic_type){this.rFuben.visible=!0;var r=0==RankProxy.ins().getMyRankByType(13)?"20+":RankProxy.ins().getMyRankByType(13);this.rfubenInfo2.textFlow=UtilProxy.generateTextFlow("个人排名：|C:7&"+r);var a=CopyProxy.ins().isNextBigBaowuCopyByScene(GameLogic.ins().getCurSceneId());if(a){this.bigRewardG.visible=!0,this.nextbigTitle.textFlow=UtilProxy.generateTextFlow("C:7&"+(a.id-a.entry_copy_id+1)+"层大奖");var h=UtilProxy.GetItemCellData(a.show_drop[0],a.show_drop[1]);this.nextBigItem.data=h}else this.bigRewardG.visible=!1;var l=CopyProxy.ins().getCurBaowuCopyFloor(GameLogic.ins().getCurSceneId());l>0&&(this.copyFloorG.visible=!0,this.copyFloorLabel.text=l+"层")}else if(9==i.speciallogic_type||18==i.speciallogic_type||41==i.speciallogic_type){var p=BossProxy.ins().getBossTypeById(GameLogic.ins().getCurSceneId());(p==BOSSTYPE.WORLD||p==BOSSTYPE.MIJING||p==BOSSTYPE.SHENYUAN||p==BOSSTYPE.EXOTIC)&&(this.bNotSKillG.visible=!1,this.setgroup_sysState(!1))}}else CopyProxy.ins().isBossLimitScene(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isBossSevenDayScene(GameLogic.ins().getCurSceneId())?(this.bossG.visible=!0,this.btn_exit.visible=!0,this.blMain.visible=!1,this.auto_lyh.visible=!1,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.boss_tips.visible=!1,this.task.visible=!1,this.setGuanKa(!0),o=!0,this.isTopSysShow&&this.setTopSys()):3==i.scene_type?(this.btn_exit.visible=!0,this.blMain.visible=!1,this.auto_lyh.visible=!1,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.boss_tips.visible=!1,this.task.visible=!1,this.ExpView.setVisible(!0),o=!0,this.isTopSysShow&&this.setTopSys()):3==i.speciallogic_type?(this.btn_exit.visible=!0,this.blMain.visible=!1,this.auto_lyh.visible=!1,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.boss_tips.visible=!1,this.task.visible=!1):4==i.scene_type?(this.btn_exit.visible=!0,this.blMain.visible=!1,this.auto_lyh.visible=!1,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.boss_tips.visible=!1,this.task.visible=!1,this.limitActBtn.visible=!1,this.FRPushTips.visible=!1,this.onlinegift.visible=!1,this.isTopSysShow&&this.setTopSys()):19==i.speciallogic_type?(this.btn_exit.visible=!1,this.blMain.visible=!1,this.auto_lyh.visible=!1,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.boss_tips.visible=!1,this.task.visible=!1,this.limitActBtn.visible=!1,this.FRPushTips.visible=!1,this.onlinegift.visible=!1,this.topAnchor.visible=!1,this.topLAnchor.visible=!1):(this.btn_exit.visible=!1,this.blMain.visible=!0,this.UpdateLyh(),this.btn_lyh.visible=!0,this.rMain.visible=!0,this.ShowTaskInfo(),(this.IsShowFRView||LimitActProxy.ins().IsShowFirstRechange)&&(this.IsShowFRView=!1,ViewManager.ins().open(FirstRechargeView)));if(o||this.isTopSysShow||this.setTopSys(),1==i.scene_type&&!CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId)){var c=LyhProxy.ins().getCurId();c>0&&GuideProxy.ins().CheckGuideCache(2,LyhProxy.ins().getCurId()),GuideProxy.ins().CheckGuideCache(3,LyhProxy.ins().getCurId())}this.sp_dujie.visible=39==i.speciallogic_type,this.setAutoBossTimer(),this.sysImg.visible=this.chatInfo.visible,this.sysImg0.visible=this.chatInfo0.visible}},e.prototype.setAutoBossTimer=function(){var t=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());void 0!=t&&(1==t.scene_type&&0==t.is_main?(this.isUpdateChallenge||TimerManager.ins().doTimer(6e3,0,this.upDateChallengeTime,this),this.isUpdateChallenge=!0):(this.isUpdateChallenge&&TimerManager.ins().removeAll(this.upDateChallengeTime),this.isUpdateChallenge=!1))},e.prototype.upDateChallengeTime=function(){if(void 0!=BossProxy.ins().boss_net_map&&void 0!=BossProxy.ins().boss_net_map[BOSSTYPE.WORLD]&&!ViewManager.ins().isOpenNotConst()){var t=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());if(1==t.scene_type&&0==t.is_main)for(var e in BossProxy.ins().boss_net_map){var i=Number(e);if(i==BOSSTYPE.WORLD||i==BOSSTYPE.SHENYUAN||i==BOSSTYPE.MIJING||i==BOSSTYPE.EXOTIC){var n=BossProxy.ins().boss_net_map[e];for(var o in n)if((0==n[o].next_time||0!=n[o].next_time&&Math.floor(n[o].next_time-GameLogic.ins().getServerTime())<=0)&&BossProxy.ins().isAutoChallengeBoss(i,n[o].boss_id)){var s=GlobalConfig.getBossConfig(n[o].boss_id);
if(i!=BOSSTYPE.WORLD||i==BOSSTYPE.WORLD&&s.strength<=BossProxy.ins().strength){BossProxy.ins().enterBossScene(s.scene);break}}}}}},e.prototype.setImgSword=function(){var t=CopyProxy.ins().getSwordType();this.imgSword.visible=0!=t,1==t?this.imgSword.source="maijianzhon_tishi_2":2==t&&(this.imgSword.source="maijianzhon_tishi")},e.prototype.setBossHurt=function(){var t=BossProxy.ins().my_hurt;this.bossInfo1.textFlow=UtilProxy.generateTextFlow("我的伤害： "+UtilProxy.getSimpleNum(t)),this.bossInfo2.text="",this.bossInfo0.text="";var e=GameLogic.ins().getEntityByHandle(BossProxy.ins().boss_obj_id);if(void 0==e)this.bossExpBar.SetExp(0,1),this.bossInfo2.textFlow=UtilProxy.generateTextFlow("0%");else{var i=GlobalConfig.getMonsterConfigById(BossProxy.ins().monster_id);i&&(this.bossInfo0.textFlow=UtilProxy.StrFormart("|@0 @1 |",[e.name,i.tips]),this.bossIcon.source=i.head_res);var n=e.getHP(),o=e.getHPMax();this.bossExpBar.SetExp(n,o);var s=Math.floor(100*n/o);this.bossInfo2.textFlow=UtilProxy.generateTextFlow(s+"%")}},e.prototype.BossDead=function(){this.bossExpBar.SetExp(0,1),this.bossInfo2.textFlow=UtilProxy.generateTextFlow("0%")},e.prototype.S2CRepCopyEnterCopy=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];i&&(this.btn_exit.visible=!0,this.auto_lyh.visible=!UtilProxy.shield,this.btn_lyh.visible=!1,this.rMain.visible=!1,this.blMain.visible=!1,this.boss_tips.visible=!1,this.task.visible=!1,this.xiuxianActBtn.visible=!1,this.sevenday_tips&&this.sevenday_tips.visible&&(this.sevenday_tips.visible=!1),this.super_tips.visible=!1,GuideProxy.ins().getGuideState()&&GuideProxy.ins().breakCurrentData(),ViewManager.ins().isShow(XianFuView)&&ViewManager.ins().close(XianFuView))},e.prototype.S2CRepCopyLeave=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];i&&(this.btn_exit.visible=!1,this.auto_lyh.visible=!0,this.btn_lyh.visible=!0,this.rMain.visible=!0,this.blMain.visible=!0,this.xiuxianActBtn.visible=!0,this.ShowTaskInfo(),ViewManager.ins().open(FubenView),GuideProxy.ins().checkAllGuide())},e.prototype.updateOffline=function(){var t=LyhProxy.ins().getCurId(),e=LyhProxy.ins().getOfflineData(t+1);e||(e=LyhProxy.ins().getOfflineData(t));var i=LyhProxy.ins().getCurData();i?this.guangNum.textFlow=UtilProxy.StrFormart("C:7&@0 关",[t+1]):this.guangNum.textFlow=UtilProxy.StrFormart("C:7&@0 已满级",[]),this.coinP.textFlow=UtilProxy.StrFormart("C:7&@0 /时",[e[1]]),this.expP.textFlow=UtilProxy.StrFormart("C:7&@0 /时",[e[0]])},e.prototype.S2CRepMonsterDropOwerChange=function(t){if(BossProxy.ins().monster_id>0){var e=GlobalConfig.getBossConfig(BossProxy.ins().monster_id);this.bossG.visible=void 0==e||e.type==BOSSTYPE.SINGLE,this.bossG.visible&&this.setBossHurt()}},e.prototype.BossMyHurt=function(t){if(BossProxy.ins().monster_id>0){var e=GlobalConfig.getBossConfig(BossProxy.ins().monster_id);this.bossG.visible=void 0==e||e.type==BOSSTYPE.SINGLE,this.bossG.visible&&this.setBossHurt()}},e.prototype.S2CRspWelfareGetSystemAward=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setPreBtn()},e.prototype.S2CRepLyhGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setPreBtn(),this.ShowOnlineAward()},e.prototype.setPreBtn=function(){var t=WelfareProxy.ins().getNextNotCanGetSysAward();LyhProxy.ins().getCurId(),new System_open_awardConfig;if(t){this.sysPreBtn.visible=!0;var e="",i=t.system_params[0],n=t.system_params[1];switch(i){case 1:e="等级达"+n;break;case 2:e=UtilProxy.getZhuanStr(n);break;case 3:e="炼妖壶"+n+"关";break;case 4:e="开服"+n+"天"}this.sysPreBtn.label=e,this.sysPreBtn.icon=t.icon,WelfareProxy.ins().isHaveSystemAward()?(this.sysPreBtn.setEff(!0,54),this.sysPreBtn.setRed(!0)):(this.sysPreBtn.setEff(!1),this.sysPreBtn.setRed(!1))}else this.sysPreBtn.visible=!1},e.prototype.onXiuXianUpdate=function(){},e.prototype.UpdateBtnR4=function(){if(this.btn_r4.visible=LimitActProxy.ins().IsZPZBOpen()||LimitActProxy.ins().IsZZZDOpen()||LimitActProxy.ins().IsWXOpen()||LimitActProxy.ins().IsDFDFOpen()||LimitActProxy.ins().IsYLSDOpen(),this.limittime.visible=this.btn_r4.visible,this.limitEndTime=0,LimitActProxy.ins().IsZPZBOpen()){this.btn_r4.icon="main_btn_zongpaizhengba";var t=LimitActProxy.ins().GetXianLimitActData(LimitActProxy.ins().ZPZBType);t&&(this.limitEndTime=t.time)}else if(LimitActProxy.ins().IsWXOpen()){this.btn_r4.icon="main_btn_wanxianzhengba";var t=LimitActProxy.ins().GetXianLimitActData(LimitActProxy.ins().DFDFType);t&&(this.limitEndTime=t.time)}else if(LimitActProxy.ins().IsYLSDOpen()){this.btn_r4.icon="main_btn_yanluoshendian";var e=ActivityProxy.ins().getActivityDataById(ActivityType.Yama);e&&(this.limitEndTime=e.act_time)}else if(LimitActProxy.ins().IsDFDFOpen()){this.btn_r4.icon="main_btn_dianfengdoufa";var t=LimitActProxy.ins().GetXianLimitActData(LimitActProxy.ins().DFDFType);t&&(this.limitEndTime=t.time)}else{this.btn_r4.icon="main_btn_zongzhuzhengduo";var t=LimitActProxy.ins().GetXianLimitActData(LimitActProxy.ins().ZZZDType);t&&(this.limitEndTime=t.time)}this.btn_r4.visible?(this.btn_r4.setEff(!0,45),this.limitEndTime>0&&(this.SetXianLimitEndTimeLab(),TimerManager.ins().remove(this.SetXianLimitEndTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetXianLimitEndTimeLab,this))):(this.btn_r4.setEff(!1),TimerManager.ins().remove(this.SetXianLimitEndTimeLab,this))},e.prototype.SetXianLimitEndTimeLab=function(){var t=this.limitEndTime-GameLogic.ins().getServerTime();t>0?this.limittime.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[UtilProxy.getTimeHMSString(t)]):TimerManager.ins().remove(this.SetXianLimitEndTimeLab,this)},e.prototype.UpdateBtnR5=function(){this.btn_r5.visible=PrivilegeProxy.ins().IsExtraAwardOpen(),this.btn_r5.setEff(!0,45)},e.prototype.UpdateBtnR6=function(){this.btn_r6.visible=SystemOpenProxy.ins().isOpen(2,6902,!0)},e.prototype.S2CRepMiscDailyChange=function(t){this.setLimitBossBtn(),this.setPreSysList(),this.setSYTRankBossBtn(),this.setTrailBossBtn()},e.prototype.S2CRepSystemopenGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetSystemList(),this.RefreshCopyRed(),this.RefreshBossRed(),ActivityProxy.ins().setActTips(),this.ShowLimitActBtn(),this.ShowCJTZBtn(),this.setXiuxianActBtnState(),this.setTreasureState(),this.SetStoreState(),this.setLimitBossBtn(),this.setSYTRankBossBtn(),this.ShowJcActBtn(),this.ShowJieRiActBtn(),this.showSysytemLianChong(),this.ShowFRBtn(),this.setPreSysList(),this.SetBaokuRed(),this.ShowTrunActBtn(),this.ShowZBTaoBtn(),this.setTrailBossBtn(),this.ShowLeiTaiBtn(),this.setBGIslandBtn(),this.ShowlimitedGifsBtn(),this.setLotteryIcon(),this.ShowActBtnInfo()},e.prototype.UpdateBagInfo=function(t){this.setTreasureState(),this.setMakeRed()},e.prototype.S2CRepAchievementGetInfo=function(t){this.setXiuxianActBtnState()},e.prototype.S2CRepAchievementUpgrade=function(t){this.setXiuxianActBtnState()},e.prototype.setTreasureState=function(){this.TreasureBtn&&this.TreasureBtn.setRed(TreasureProxy.ins().getRed())},e.prototype.S2CRepMiscGetSaveInfo=function(t){this.setXiuxianActTips(),this.SetSevendayIcon(),this.SetWelfareIcon(),this.setLimitBossBtn(),this.setSYTRankBossBtn(),this.setTrailBossBtn()},e.prototype.S2CRspWelfareGetMillionAward=function(t){this.setXiuxianActBtnState()},e.prototype.RefreshCopyRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.RefreshTitleRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.RefreshHuoBanRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.RefreshBossRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.btn_r2.setRed(BossProxy.ins().getRed())},e.prototype.RefreshStoreRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetStoreState()},e.prototype.SetBaokuRed=function(){this.gSys5&&this.gSys5.setRed(StoreProxy.ins().getBaokuRed())},e.prototype.SetStoreState=function(){this.gSys6&&this.gSys6.setRed(StoreProxy.ins().getRed())},e.prototype.RefreshMailRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.MailBtn.visible=MailProxy.ins().getRed(),this.MailBtn.setRed(MailProxy.ins().getRed())},e.prototype.RefreshWelfareRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.SetWelfareIcon()},e.prototype.RefreshFindtreasureRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setTreasureState()},e.prototype.ShowDressTips=function(){this.ShowDress=void 0;for(var t in BagProxy.ins().PutDressList)BagProxy.ins().PutDressList[t]&&void 0==this.ShowDress&&(this.ShowDress=BagProxy.ins().PutDressList[t]);if(void 0==this.ShowDress)for(var t in BagProxy.ins().recomonItemList)BagProxy.ins().recomonItemList[t]&&void 0==this.ShowDress&&(this.ShowDress=BagProxy.ins().recomonItemList[t]);this.dressTips.visible=void 0!=this.ShowDress,this.dressitem.data=this.ShowDress,this.ShowDress&&this.dressColdTime<=0?(this.title.textFlow=1==this.ShowDress.itemConfig.type?UtilProxy.generateTextFlow("|C:10&推荐穿戴|"):UtilProxy.generateTextFlow("|C:10&推荐使用|"),this.dressColdTime=10,this.dressBtn.label=UtilProxy.getStr("@0 (@1 s)",[1==this.ShowDress.itemConfig.type?"穿 戴":"使 用",this.dressColdTime]),TimerManager.ins().doTimer(1e3,10,this.SetDressTimeLab,this,this.FinshDress,this)):void 0==this.ShowDress&&(TimerManager.ins().remove(this.SetDressTimeLab,this),this.dressColdTime=0)},e.prototype.FinshDress=function(){this.DressClick(this.dressBtn)},e.prototype.SetDressTimeLab=function(){this.dressColdTime=this.dressColdTime-1,this.dressBtn.label=UtilProxy.getStr("@0 (@1 s)",[1==this.ShowDress.itemConfig.type?"穿 戴":"使 用",this.dressColdTime])},e.prototype.SetSystemList=function(){if(SystemOpenProxy.ins().isGetInfo){var t=GlobalConfig.getMain_systemConfigs();this.topsysG.numChildren>0&&this.topsysG.removeChildren(),this.group_sys.numChildren>0&&this.group_sys.removeChildren(),this.topSysList=[],this.bottomSysList=[];for(var e=0;e<t.length;++e)if(0!=t[e].isRead&&("FR"!=t[e].name||!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&("FightUp"!=t[e].name||(!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&BagProxy.ins().IsFightUpOpen())&&("XiuDian"!=t[e].name||!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&("ShenMiGift"!=t[e].name||!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&("Lottery"!=t[e].name||!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&("SCZD"!=t[e].name||WelfareProxy.ins().IsShowSCZD())&&!(t[e].contain_id>0)){var i=!1,n=0==t[e].page?1:2,o=0==t[e].page?Number(t[e].view_id):100*Number(t[e].view_id)+t[e].page;if(i=SystemOpenProxy.ins().isOpen(n,o,!0),1==t[e].direction||2==t[e].direction){var s=new ButtonEx;s.icon=t[e].icon,s.data=t[e],s.skinName="Btn0Skin",1==t[e].direction?(this.topSysList.push(s),this.topsysG.addChildAt(s,t[e].rank),this.isNeedHideSys(t[e])?(this.setHideSystem(s,i),s.visible=!1,s.includeInLayout=!1):(s.visible=i,s.includeInLayout=i)):2==t[e].direction&&(this.bottomSysList.push(s),this.group_sys.addChildAt(s,t[e].rank)),t[e].isRed>0&&s.setEff(!0,t[e].isRed),t[e].isRedShow&&s.setRed(!0),"Treasure"==t[e].name?this.TreasureBtn=s:"Welfare"==t[e].name?this.welfareBtn==s:"Fac"==t[e].name?this.gSys0=s:"Fabao"==t[e].name?this.gSys1=s:"Fuwen"==t[e].name?this.gSys2=s:"Book"==t[e].name?this.gSys3=s:"XianYuan"==t[e].name?this.gSys4=s:"BaoKu"==t[e].name?this.gSys5=s:"StoreEnter"==t[e].name&&(this.gSys6=s)}else this[t[e].name].visible=i}for(var e=0;e<this.topSysList.length;++e)this.addTouchEvent(this.topSysList[e],this.onSysItemClick);for(var e=0;e<this.bottomSysList.length;++e)this.addTouchEvent(this.bottomSysList[e],this.onSystemClick);this.setTreasureState(),this.SetStoreState()}},e.prototype.showSysytemLianChong=function(){var t=this.getSysItemByName("lianchong");if(t){var e=void 0!=LimitActProxy.ins().GetJCTabCf();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e),t.setRed(LimitActProxy.ins().GetLianChongRed())}},e.prototype.OpenSystemItemByName=function(t){var e=GlobalConfig.getMainsystemByName(t);if(e&&1==e.isRead){var i=this.getSysItemByName(t);if(i)switch(this.isNeedHideSys(e)?this.AddHideListIndex(i):(i.visible=!0,i.includeInLayout=!0),e.name){case"Treasure":break;case"Privilege":this.ShowTequanBtn();break;case"Welfare":i.setRed(WelfareProxy.ins().getRed());break;case"DayFR":this.ShowDayFRBtn();break;case"LuxuryFR":this.ShowFRBtn();break;case"Xianshileichong":case"JcAct":this.ShowJcActBtn();break;case"JieRiAct":this.ShowJieRiActBtn();break;case"ReTrunAct":this.ShowTrunActBtn();break;case"shouji":this.ShowZBTaoBtn();break;case"lianchong":this.showSysytemLianChong();break;case"DayRechargeAct":this.ShowDayRechargeBtn();break;case"ZhigouGift1":this.ShowZhigouBtn();break;case"SuperInvest":this.ShowCJTZBtn();break;case"Sevenday":this.SetSevendayIcon();break;case"LingYuan":this.setFreeGiftIcon();break;case"XiuDian":this.setXiuDian();break;case"Fac":this.SetFacRed();break;case"Fabao":this.SetFabaoRed();break;case"leitai":this.ShowLeiTaiBtn();break;case"Fuwen":this.SetFuwenRed();break;case"Book":this.SetgS3Red();break;case"XianYuan":this.SetXianyuanRed();break;case"BaoKu":this.SetBaokuRed();break;case"StoreEnter":this.SetStoreState();break;case"btn_r1":break;case"btn_r3":i.setRed(WelfareProxy.ins().getRed());break;case"btn_r2":i.setRed(WelfareProxy.ins().getRed());break;case"Baowu":i.setRed(BaoWuProxy.ins().getRed());break;case"XianshiLiBao":this.ShowlimitedGifsBtn();case"LCZQ":this.ShowCZQBtn();break;case"SCZD":this.ShowSCZDBtn()}}},e.prototype.S2CRepGlobalchatCross=function(){var t=ChatProxy.ins().ChatAllList,e="";if(t.length>0){var i=t[t.length-1];if(i.from_uid>0){this.bit.x=this.chatInfo.x,i.msg_content.indexOf(UtilProxy.chatBitMark)>=0?(this.chatInfo.textFlow=UtilProxy.StrFormart("C:@0 &@1 |C:@2 &S@3 .@4 :|",[4,"跨服",7,i.server_id,i.username]),this.bit.source=this.bit.source=i.msg_content.replace(UtilProxy.chatBitMark,"")):i.msg_content.indexOf(UtilProxy.chatVipBitMark)>=0?(this.chatInfo.textFlow=UtilProxy.StrFormart("C:@0 &@1 |C:@2 &S@3 .@4 :|",[4,"跨服",7,i.server_id,i.username]),this.bit.source=this.bit.source=i.msg_content.replace(UtilProxy.chatVipBitMark,"")):(this.bit.source="",this.chatInfo.textFlow=UtilProxy.StrFormart("C:@0 &@1 |C:@2 &S@3 .@4 :|@5 |",[4,"跨服",7,i.server_id,i.username,i.msg_content.length>25?i.msg_content.slice(0,25)+"...":i.msg_content]));var n=StringUtils.strByteLen(this.chatInfo.text);StringUtils.isChinese(this.chatInfo.text)?this.bit.x=8.22*n+this.chatInfo.x-10:this.bit.x=8.22*n+this.chatInfo.x,this.sysImg.source="mainChats_json.main_icon_kuafu"}else{e=i.msg_content,this.bit.source="",this.sysImg.source="mainChats_json.main_icon_xitong";var o=UtilProxy.generateTextFlow(e);o.splice(0,0,{text:"系统",style:{textColor:16718080}}),this.chatInfo.textFlow=o}}else this.chatInfo.text="";if(t.length>1){var s=t[t.length-2];if(s.from_uid>0){this.bit0.x=this.chatInfo0.x,s.msg_content.indexOf(UtilProxy.chatBitMark)>=0?(this.chatInfo0.textFlow=UtilProxy.StrFormart("C:@0 &@1 |C:@2 &S@3 .@4 :|",[4,"跨服",7,s.server_id,s.username]),this.bit0.source=s.msg_content.replace(UtilProxy.chatBitMark,"")):s.msg_content.indexOf(UtilProxy.chatVipBitMark)>=0?(this.chatInfo0.textFlow=UtilProxy.StrFormart("C:@0 &@1 |C:@2 &S@3 .@4 :|",[4,"跨服",7,s.server_id,s.username]),this.bit0.source=s.msg_content.replace(UtilProxy.chatVipBitMark,"")):(this.bit0.source="",this.chatInfo0.textFlow=UtilProxy.StrFormart("C:@0 &@1 |C:@2 &S@3 .@4 :|@5 |",[4,"跨服",7,s.server_id,s.username,s.msg_content.length>25?s.msg_content.slice(0,25)+"...":s.msg_content]));var r=StringUtils.strByteLen(this.chatInfo0.text);StringUtils.isChinese(this.chatInfo0.text)?this.bit0.x=8.22*r+this.chatInfo0.x-10:this.bit0.x=8.22*r+this.chatInfo0.x,this.sysImg0.source="mainChats_json.main_icon_kuafu"}else{e=s.msg_content,this.sysImg0.source="mainChats_json.main_icon_xitong";var a=UtilProxy.generateTextFlow(e);this.bit0.source="",a.splice(0,0,{text:"系统",style:{textColor:16718080}}),this.chatInfo0.textFlow=a}}else this.chatInfo0.text=""},e.prototype.onMakeClick=function(t){ViewManager.ins().open(MakeView)},e.prototype.RefreshMakeRed=function(t){this.setMakeRed()},e.prototype.setMakeRed=function(){this.MakeBtn.setRed(MakeProxy.ins().getRed())},e.prototype.onXiuxianActClick=function(t){this.xiuxianActBtn.setEff(!1),ViewManager.ins().open(XiuxianActView)},e.prototype.setXiuxianActTips=function(){},e.prototype.setXiuxianActBtnState=function(){this.xiuxianActBtn.setRed(WelfareProxy.ins().isYBMillionAwardRed())},e.prototype.updateXiuxianAct=function(){var t=WelfareProxy.ins().getXiuxianActLeftTime();t>=0?this.xiuxianActBtn.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(t)]),12):(this.xiuxianActBtn.setTopInfo(""),TimerManager.ins().remove(this.update,this))},e.prototype.onLimitActClick=function(t){ViewManager.ins().open(KaifuView)},e.prototype.ShowActBtnInfo=function(){this.ShowLimitActBtn(),this.ShowFRBtn(),this.ShowDayFRBtn(),this.ShowJcActBtn(),this.ShowJieRiActBtn(),this.showSysytemLianChong(),this.ShowLimitRechargeBtn(),this.ShowTrunActBtn(),this.ShowDayRechargeBtn(),this.ShowZhigouBtn(),this.ShowlimitedGifsBtn(),this.setLotteryIcon();var t=this.getSysItemByName("Fabao");t&&(t.getChildAt(4).visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emLB))},e.prototype.ShowLimitActBtn=function(){var t=this.getSysItemByName("limitAct");if(t){var e=LimitActProxy.ins().GetKaifuTabCf()||LimitActProxy.ins().GetKuafuTabCf(),i=void 0!=e;this.isNeedHideSys(t.data)?this.setHideSystem(t,i):(t.visible=i,t.includeInLayout=t.visible),void 0!=e&&(this.limit_acttime=LimitActProxy.ins().GetActEndTime(e),e.icon[0]&&""!=e.icon[0]&&(t.icon=e.icon[0]),t.setEff(LimitActProxy.ins().GetKaifuRed()||LimitActProxy.ins().GetKuafuRed()||LimitActProxy.ins().IsShowActEffect,45),t.setRed(LimitActProxy.ins().GetKaifuRed()||LimitActProxy.ins().GetKuafuRed()||LimitActProxy.ins().IsShowActEffect),this.ShowLimitActColdTime())}},e.prototype.setVipEff=function(){if(!UtilProxy.shield){var t=!0;this.vip_effect.visible=t,t?(this.vip_effect.touchEnabled=!1,this.vip_effect.touchChildren=!1,0==this.vip_effect.numChildren?RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>18?UtilProxy.GetMovieClipById(121,this.vip_effect):UtilProxy.GetMovieClipById(43,this.vip_effect):(this.vip_effect.removeChildren(),RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>18?UtilProxy.GetMovieClipById(121,this.vip_effect):UtilProxy.GetMovieClipById(43,this.vip_effect))):this.vip_effect.numChildren>0&&this.vip_effect.removeChildren()}},e.prototype.S2CRepVipGetFreeGift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setVipRed()},e.prototype.setVipRed=function(){UtilProxy.shield||(this.vipRed.visible=VIPProxy.ins().getVipRed())},e.prototype.ShowLimitActColdTime=function(){if(this.SetLimitActTimeLab(),this.limit_acttime>GameLogic.ins().getServerTime())TimerManager.ins().remove(this.SetLimitActTimeLab,this),TimerManager.ins().doTimer(1e3,this.limit_acttime-GameLogic.ins().getServerTime()+1,this.SetLimitActTimeLab,this,this.ShowLimitActColdTime,this);else{var t=this.getSysItemByName("limitAct");if(!t)return;t.setTopInfo("")}},e.prototype.SetLimitActTimeLab=function(){var t=this.getSysItemByName("limitAct");t&&t.setTopInfo(UtilProxy.getStr("|C:7&@0 |",[UtilProxy.getTimeHSString_2(this.limit_acttime-GameLogic.ins().getServerTime())]))},e.prototype.needUpdate=function(){this.ShowZBTaoBtn()},e.prototype.ShowLeiTaiBtn=function(){var t=this.getSysItemByName("leitai");if(t){var e=LeitaiProxy.ins().visibleLv();if(this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=t.visible),LeitaiProxy.ins().visibleLv()){var i=LeitaiProxy.ins().getOpenDay(),n=LimitActProxy.ins().GetServerOpenDay();t.setTopInfo(i>n?"C:4&明天开启 ":""),t.setRed(!LeitaiProxy.ins().is_rest),i>n?t.setTopInfo("C:4&明天开启 "):n>=i&&(LeitaiProxy.ins().is_rest?(TimerManager.ins().remove(this.SetLeiTaiTimeLab,this),t.setTopInfo("C:4&休战期 ")):LeitaiProxy.ins().getIsOpen?this.ShowReLeiTaiTime():t.setTopInfo(LeitaiProxy.ins().getOpenTime()))}else t.setTopInfo("")}},e.prototype.ShowReLeiTaiTime=function(){if(this.SetLeiTaiTimeLab(),LeitaiProxy.ins().getIsOpen())TimerManager.ins().remove(this.SetLeiTaiTimeLab,this),TimerManager.ins().doTimer(1e3,LeitaiProxy.ins().end_time-GameLogic.ins().getServerTime()+1,this.SetLeiTaiTimeLab,this,this.ShowReLeiTaiTime,this);else{var t=this.getSysItemByName("leitai");if(!t)return;t.setTopInfo("")}},e.prototype.SetLeiTaiTimeLab=function(){var t=this.getSysItemByName("leitai");t&&t.setTopInfo(UtilProxy.getStr("|C:7&@0 |",[UtilProxy.getTimeHSString_2(LeitaiProxy.ins().end_time-GameLogic.ins().getServerTime())]))},e.prototype.ShowZBTaoBtn=function(){var t=this.getSysItemByName("shouji");if(t){var e=SystemOpenProxy.ins().isOpen(1,77,!0);this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=t.visible),t.setRed(ZbTaoZhuangProxy.ins().getRedByAll())}},e.prototype.ShowTrunActBtn=function(){var t=this.getSysItemByName("ReTrunAct");if(t){var e=LimitActProxy.ins().GetRechargeTrunCf(),i=void 0!=e;this.isNeedHideSys(t.data)?this.setHideSystem(t,i):(t.visible=i,t.includeInLayout=t.visible),t.setRed(LimitActProxy.ins().GetRechargeTrunRed()),void 0!=e&&(this.ReTrun_acttime=LimitActProxy.ins().GetActEndTime(e),this.ShowReTrunActColdTime())}},e.prototype.ShowReTrunActColdTime=function(){if(this.SetReTrunActTimeLab(),this.ReTrun_acttime>GameLogic.ins().getServerTime())TimerManager.ins().remove(this.SetReTrunActTimeLab,this),TimerManager.ins().doTimer(1e3,this.ReTrun_acttime-GameLogic.ins().getServerTime()+1,this.SetReTrunActTimeLab,this,this.ShowReTrunActColdTime,this);else{var t=this.getSysItemByName("ReTrunAct");if(!t)return;t.setTopInfo("")}},e.prototype.SetReTrunActTimeLab=function(){var t=this.getSysItemByName("ReTrunAct");t&&t.setTopInfo(UtilProxy.getStr("|C:7&@0 |",[UtilProxy.getTimeHSString_2(this.ReTrun_acttime-GameLogic.ins().getServerTime())]))},e.prototype.ShowDayFRBtn=function(){var t=this.getSysItemByName("DayFR");if(t){t.setRed(LimitActProxy.ins().GetRedByType(3));var e=LimitActProxy.ins().IsDayFROpen();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e)}},e.prototype.ShowFRBtn=function(){this.firstRechargeBtn.visible=LimitActProxy.ins().IsFristRechargeOpen(),this.setYjfxBtn();var t=this.getSysItemByName("LuxuryFR");if(t){t.setRed(LimitActProxy.ins().GetRedByType(2,1));var e=LimitActProxy.ins().getLuxuryFRCf();this.isNeedHideSys(t.data)?this.setHideSystem(t,void 0!=e):(t.visible=void 0!=e,t.includeInLayout=void 0!=e),e&&e.icon[2]&&(t.icon=e.icon[2])}},e.prototype.ShowCJTZBtn=function(){var t=this.getSysItemByName("SuperInvest");if(t){t.setRed(WelfareProxy.ins().getInvenstRed());var e=WelfareProxy.ins().getInvenstOpen();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e),WelfareProxy.ins().IsShowSuperTips&&t.visible&&t.parent.visible?(WelfareProxy.ins().IsShowSuperTips=!1,TimerManager.ins().doTimer(2e3,1,function(){this.super_tips.visible=!0;var t=this.getSysItemByName("SuperInvest");if(t){var e=t.localToGlobal(0,0);this.super_tips.x=e.x,this.super_tips.y=e.y+50}},this),TimerManager.ins().doTimer(1e4,1,function(){this.super_tips.visible=!1},this)):this.super_tips.visible=!1}},e.prototype.ShowCZQBtn=function(){var t=this.getSysItemByName("LCZQ");if(t){t.setRed(WelfareProxy.ins().IsShowRechargeRed());var e=WelfareProxy.ins().IsShowRecharge();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e)}},e.prototype.ShowFightUpBtn=function(){var t=this.getSysItemByName("FightUp");if(t){var e=BagProxy.ins().IsFightUpOpen();t.visible&&(this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e)),this.fightup_time=BagProxy.ins().getFightUpEndTime(),this.ShowFightUpTime()}},e.prototype.ShowFightUpTime=function(){if(this.SetFightUpTimeLab(),this.fightup_time>GameLogic.ins().getServerTime())TimerManager.ins().remove(this.SetFightUpTimeLab,this),TimerManager.ins().doTimer(1e3,this.fightup_time-GameLogic.ins().getServerTime()+1,this.SetFightUpTimeLab,this,this.ShowFightUpTime,this);else{var t=this.getSysItemByName("FightUp");if(!t)return;t.setTopInfo("")}},e.prototype.SetFightUpTimeLab=function(){var t=this.getSysItemByName("FightUp");t&&t.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(this.fightup_time-GameLogic.ins().getServerTime())]),12)},e.prototype.ShowJcActBtn=function(){var t=this.getSysItemByName("JcAct");if(t){t.setRed(LimitActProxy.ins().GetJCRed());var e=void 0!=LimitActProxy.ins().GetJCTabCf();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e);var i=this.getSysItemByName("Xianshileichong");if(i){i.setRed(LimitActProxy.ins().GetJCRed());var n=void 0!=LimitActProxy.ins().GetJCTabCf();this.isNeedHideSys(i.data)?this.setHideSystem(i,n):(i.visible=n,i.includeInLayout=n)}}},e.prototype.ShowJieRiActBtn=function(){var t=this.getSysItemByName("JieRiAct");if(t){t.setRed(LimitActProxy.ins().GetJieRiRed());var e=void 0!=LimitActProxy.ins().GetJieRiTabCf();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e)}},e.prototype.ShowSCZDBtn=function(){var t=this.getSysItemByName("SCZD");if(t){var e=WelfareProxy.ins().IsShowSCZD();t.visible&&(this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e))}},e.prototype.ShowLimitRechargeBtn=function(){var t=this.getSysItemByName("XIANSHICHONGZHI");if(t){t.visible=LimitActProxy.ins().IsLimitRechargeOpen(),t.includeInLayout=t.visible,t.setRed(LimitActProxy.ins().GetRedByType(2,4));var e=LimitActProxy.ins().GetActivityCfgs(2,4)[0];e&&(this.limit_rechargetime=LimitActProxy.ins().GetActEndTime(e),t.icon=e.icon[0]),this.ShowLimitRechargeTime()}},e.prototype.ShowLimitRechargeTime=function(){if(this.SetLimitRechargeTimeLab(),this.limit_rechargetime>GameLogic.ins().getServerTime())TimerManager.ins().remove(this.SetLimitRechargeTimeLab,this),TimerManager.ins().doTimer(1e3,this.limit_rechargetime-GameLogic.ins().getServerTime()+1,this.SetLimitRechargeTimeLab,this,this.ShowLimitRechargeTime,this);else{var t=this.getSysItemByName("XIANSHICHONGZHI");if(!t)return;t.setTopInfo("")}},e.prototype.SetLimitRechargeTimeLab=function(){var t=this.getSysItemByName("XIANSHICHONGZHI");t&&t.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(this.limit_rechargetime-GameLogic.ins().getServerTime())]),12)},e.prototype.ShowTequanBtn=function(){var t=this.getSysItemByName("Privilege");if(t){var e=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck))&&SystemOpenProxy.ins().isOpen(1,52,!0);this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e),t.setRed(PrivilegeProxy.ins().getRed())}},e.prototype.ShowDayRechargeBtn=function(){var t=this.getSysItemByName("DayRechargeAct");if(t){var e=LimitActProxy.ins().GetDayRechargeCf(),i=void 0!=e;this.isNeedHideSys(t.data)?this.setHideSystem(t,i):(t.visible=i,t.includeInLayout=i),t.setRed(LimitActProxy.ins().GetRedByType(4,1)),e&&(e.icon[3]&&(t.icon=e.icon[3]),t.setNameIcon(e.btn_title),this.dayrechargetime=LimitActProxy.ins().GetActEndTime(e),this.ShowDayRechargeTime())}},e.prototype.ShowDayRechargeTime=function(){if(this.SetDayRechargeTimeLab(),this.dayrechargetime>GameLogic.ins().getServerTime())TimerManager.ins().remove(this.SetDayRechargeTimeLab,this),TimerManager.ins().doTimer(1e3,this.dayrechargetime-GameLogic.ins().getServerTime()+1,this.SetDayRechargeTimeLab,this,this.ShowDayRechargeTime,this);else{var t=this.getSysItemByName("DayRechargeAct");if(!t)return;t.setTopInfo("")}},e.prototype.SetDayRechargeTimeLab=function(){var t=this.getSysItemByName("DayRechargeAct");t&&t.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(this.dayrechargetime-GameLogic.ins().getServerTime())]),12)},e.prototype.ShowZhigouBtn=function(){for(var t=0;t<this.zhigoubtnlist.length;t++){var e=this.getSysItemByName(this.zhigoubtnlist[t]);if(e){var i=LimitActProxy.ins().GetZhigouGiftCf(t+2),n=void 0!=i;this.isNeedHideSys(e.data)?this.setHideSystem(e,n):(e.visible=n,e.includeInLayout=n),e.setRed(LimitActProxy.ins().GetRedByType(4,t+2)),i&&(this.zhigoutimelist[t]=LimitActProxy.ins().GetActEndTime(i))}}},e.prototype.ShowZhigouTime=function(){this.SetZhigouTimeLab();for(var t=!1,e=0,i=0;i<this.zhigoubtnlist.length;i++)if(this.zhigoutimelist[i]>GameLogic.ins().getServerTime())t=!0,e=Math.max(e,this.zhigoutimelist[i]);else{var n=this.getSysItemByName(this.zhigoubtnlist[i]);n&&n.setTopInfo("")}t&&(TimerManager.ins().remove(this.SetZhigouTimeLab,this),TimerManager.ins().doTimer(1e3,e-GameLogic.ins().getServerTime()+1,this.SetZhigouTimeLab,this,this.ShowZhigouTime,this))},e.prototype.SetZhigouTimeLab=function(){for(var t=0;t<this.zhigoubtnlist.length;t++){var e=this.getSysItemByName(this.zhigoubtnlist[t]);e&&(this.zhigoutimelist[t]>GameLogic.ins().getServerTime()?e.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(this.zhigoutimelist[t]-GameLogic.ins().getServerTime())]),12):e.setTopInfo(""))}},e.prototype.SystemOpen=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],n=t[1],o=GlobalConfig.getMain_systemConfigs(),s=0;s<o.length;++s)if(0!=o[s].isRead){0==o[s].page?1:2;if(""!=o[s].view_id){var r=0==o[s].page?1:2,a=Number(o[s].view_id);if(r==i&&a==n)if(3!=o[s].direction)if(o[s].contain_id>0){var h=GlobalConfig.getMain_systemConfig(o[s].contain_id);this.OpenSystemItemByName(h.name)}else this.OpenSystemItemByName(o[s].name);else this[o[s].name].visible=!0}}1==i&&46==n&&this.ShowLimitActBtn(),1==i&&48==n&&this.ShowCJTZBtn(),1==i&&60==n&&this.setLimitBossBtn(),2==i&&6001==n&&this.setTrailBossBtn(),2==i&&6002==n&&this.setSYTRankBossBtn(),1==i&&61==n&&(this.ShowJcActBtn(),this.showSysytemLianChong(),this.ShowTrunActBtn()),1==i&&102==n&&this.ShowJieRiActBtn(),1==i&&62==n&&this.ShowFRBtn(),1==i&&65==n&&this.UpdateBtnR5(),2==i&&6902==n&&this.UpdateBtnR6(),1==i&&52==n&&this.ShowTequanBtn(),1==i&&67==n&&this.ShowDayRechargeBtn(),(1==i&&(97==n||98==n)||2==i&&97==Math.ceil(n/100))&&this.ShowZhigouBtn(),1==i&&87==n&&this.setBGIslandBtn(),1==i&&92==n&&this.ShowlimitedGifsBtn(),1==i&&94==n&&this.setLotteryIcon(),2==i&&2806==n&&this.ShowCZQBtn(),1==i&&83==n&&this.ShowLimitRechargeBtn(),this.UpdateBtnR4()},e.prototype.S2CRspWelfareGetSevenDayAward=function(t){this.SetSevendayIcon()},e.prototype.S2CRspWelfareGetInfo=function(t){this.SetSevendayIcon(),this.SetWelfareIcon(),this.setPreBtn()},e.prototype.setLotteryIcon=function(){var t=this.getSysItemByName("Lottery");if(t){var e=LimitActProxy.ins().GetActivityCfgs(30,99),i=e[0],n=SystemOpenProxy.ins().isOpen(1,94,!0),o=void 0!=i,s=void 0!=LimitActProxy.ins().GetActivityCfgs(36)[0],r=n&&o&&s;this.isNeedHideSys(t.data)?this.setHideSystem(t,r):(t.visible=r,t.includeInLayout=r),r&&(TimerManager.ins().remove(this.setLotteryTimer,this),this.setLotteryTimer(),TimerManager.ins().doTimer(1e3,LimitActProxy.ins().GetActEndTime(i)-GameLogic.ins().getServerTime()+1,this.setLotteryTimer,this))}},e.prototype.setLotteryTimer=function(){var t=this.getSysItemByName("Lottery");if(t){var e=LimitActProxy.ins().GetActivityCfgs(30,99),i=e[0];if(void 0!=i)return LimitActProxy.ins().GetActEndTime(i)<=GameLogic.ins().getServerTime()?void this.setShenmiGiftIcon():void t.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(LimitActProxy.ins().GetActEndTime(i)-GameLogic.ins().getServerTime())]))}},e.prototype.setShenmiGiftIcon=function(){var t=this.getSysItemByName("ShenMiGift");if(t){TimerManager.ins().remove(this.setShenmiGiftTimer,this);var e=LimitActProxy.ins().getSmGiftList(),i=e.length>0,n=i;if(this.isNeedHideSys(t.data)?this.setHideSystem(t,n):(t.visible=n,t.includeInLayout=n),n){var o=[];for(var s in e)o.push(e[s].end_time);this.minSMGiftTime=Math.min.apply({},o),TimerManager.ins().doTimer(1e3,this.minSMGiftTime-GameLogic.ins().getServerTime(),this.setShenmiGiftTimer,this)}}},e.prototype.setShenmiGiftTimer=function(){var t=this.getSysItemByName("ShenMiGift");
if(t)return this.minSMGiftTime<=GameLogic.ins().getServerTime()?void this.setShenmiGiftIcon():void t.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(this.minSMGiftTime-GameLogic.ins().getServerTime())]),12)},e.prototype.setFreeGiftIcon=function(){var t=this.getSysItemByName("LingYuan");if(t&&SystemOpenProxy.ins().isOpen(1,72,!0)){var e=WelfareProxy.ins().isOpenFreeGiftView();this.isNeedHideSys(t.data)?this.setHideSystem(t,e):(t.visible=e,t.includeInLayout=e),WelfareProxy.ins().isFreeGiftCanGet()&&(t.setRed(!0),t.setEff(!0,45))}},e.prototype.setXiuDian=function(){var t=this.getSysItemByName("XiuDian");if(t){var e=0==t.data.page?1:2,i=Number(t.data.view_id),n=LimitActProxy.ins().GetServerOpenDay(),o=8>n&&!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck))&&SystemOpenProxy.ins().isOpen(e,i,!0);this.isNeedHideSys(t.data)?this.setHideSystem(t,o):(t.visible=o,t.includeInLayout=o),o&&(t.setEff(!0,45),t.setRed(!1))}},e.prototype.setBeStrongerIcon=function(){1==this.BeStronger.visible&&(TimerManager.ins().remove(this.beStrongerTimerEnd,this),void 0!=this.beStrongTip&&"main_btn_tishi_01"==this.BeStronger.icon&&this.BeStronger.parent.removeChild(this.beStrongTip),this.BeStronger.icon="main_btn_tishi_01",this.BeStronger.y=540,this.BeStronger.setEff(!0,46),this.beStrongTip=new BeStrongerTip,this.BeStronger.parent.addChild(this.beStrongTip),this.beStrongTip.x=this.BeStronger.width+this.BeStronger.x,this.beStrongTip.y=this.BeStronger.y-10,this.beStrongTip.startAnim(),TimerManager.ins().doTimer(3e4,1,this.beStrongerTimerEnd,this))},e.prototype.beStrongerTimerEnd=function(){this.BeStronger.icon="main_btn_tishi_02",this.BeStronger.y=536,this.BeStronger.setEff(!1),void 0!=this.beStrongTip&&this.BeStronger.parent.removeChild(this.beStrongTip),this.beStrongTip=void 0},e.prototype.SetWelfareIcon=function(){var t=this.getSysItemByName("Welfare");t&&(t.setRed(WelfareProxy.ins().getRed()),t.setEff(WelfareProxy.ins().getRed(),45))},e.prototype.SetSevendayIcon=function(){var t=this,e=this.getSysItemByName("Sevenday");if(e){var i=0==e.data.page?1:2,n=Number(e.data.view_id);if(SystemOpenProxy.ins().isOpen(i,n,!0)){var o=WelfareProxy.ins().getcurSevendayAward(),s=void 0!=o;if(this.isNeedHideSys(e.data)?this.setHideSystem(e,s):(e.visible=s,e.includeInLayout=s),o){e.icon=o.icon;var r=WelfareProxy.ins().isSevendayCanAward(o.id);e.setRed(r),e.setEff(r,45),e.setTopInfo(r?"C:7&&今日可领":"C:4&&明日可领"),e.visible&&e.parent.visible&&(this.sevenday_tips?this.sevenday_tips.source="resource/skins/Sevenday/main_tisp_qitian_0"+o.id+".png":(TimerManager.ins().doTimer(1500,1,function(){var e=t.getSysItemByName("Sevenday");if(e.visible){t.sevenday_tips=new eui.Image,t.topLAnchor.parent.addChild(t.sevenday_tips);var i=e.localToGlobal(0,0);t.sevenday_tips.x=i.x+5,t.sevenday_tips.y=i.y+e.height,t.sevenday_tips.includeInLayout=!1,t.isInitSevendayTips=!0,t.sevenday_tips.source="resource/skins/Sevenday/main_tisp_qitian_0"+o.id+".png"}},this),TimerManager.ins().doTimer(9e3,1,function(){t.sevenday_tips&&t.sevenday_tips.visible&&(t.sevenday_tips.visible=!1)},this)))}e.visible||this.sevenday_tips&&this.sevenday_tips.visible&&(this.sevenday_tips.visible=!1)}}},e.prototype.PushActView=function(){if(UtilProxy.IsCanTranScene()&&(!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)){var t=LyhProxy.ins().getCurId();if(LimitActProxy.ins().IsFristRechargeOpen()){for(var e=GlobalConfig.getLimitsConfig(1).recharge_show,i=0;i<e.length;i++)if(e[i]==t&&this.curShowFRid!=t)return this.curShowFRid=t,void(this.IsShowFRView=!0);for(var n=GlobalConfig.getLimitsConfig(1).recharge_push,i=0;i<n.length;i++)n[i]==t&&(LimitActProxy.ins().IsShowFRPush=!0,this.ShowFRPushTips())}if(SystemOpenProxy.ins().isOpen(1,48,!0))for(var n=GlobalConfig.getLimitsConfig(1).recharge_push,i=0;i<n.length;i++)n[i]==t}},e.prototype.ShowFRPushTips=function(){if(LimitActProxy.ins().IsFristRechargeOpen()&&LimitActProxy.ins().IsShowFRPush){this.FRPushTips.visible=!0,LimitActProxy.ins().IsShowFRPush=!1;var t=LimitActProxy.ins().GetActivityCfgs(1)[0];if(0==this.frmodel.numChildren){this.frmovie=new MovieClip;var e=UtilProxy.getShowImgPath()+t.charRes_wuqi[0];UtilProxy.GetMovieClip(e,this.frmovie,-1,void 0),this.frmodel.addChild(this.frmovie)}TimerManager.ins().remove(this.CloseFRPush,this),TimerManager.ins().doTimer(6e4,1,this.CloseFRPush,this)}else this.FRPushTips.visible=!1,this.frmodel.numChildren>0&&(this.frmovie.clear(),this.frmodel.removeChildren()),TimerManager.ins().remove(this.CloseFRPush,this)},e.prototype.CloseFRPush=function(){this.FRPushTips.visible=!1,this.frmodel.numChildren>0&&(this.frmovie.clear(),this.frmodel.removeChildren())},e.prototype.ShowOnlineAward=function(){var t=VIPProxy.ins().getCurOnlineAwardData(),e=this.onlinegift.getChildAt(2);if(e.removeChildren(),void 0==t)return void(this.onlinegift.visible=!1);this.onlinegift.visible=!0;var i=this.onlinegift.getChildAt(1);i.source=2==t.id?"main_font_mianfeisong_03":"main_font_mianfeisong_02",e.x=1==t.id?75:198,e.y=1==t.id?15:188,t.effect_id>0&&UtilProxy.GetMovieClipById(t.effect_id,e),t.need_time>0?(this.onlinelefttime=t.need_time-VIPProxy.ins().getOnlineTime(),this.SetOnlineTimeLab(),this.onlinelefttime>0&&(TimerManager.ins().remove(this.SetOnlineTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetOnlineTimeLab,this))):(TimerManager.ins().remove(this.SetOnlineTimeLab,this),t.lyh_id<=LyhProxy.ins().getCurId()?this.onlinetimelab.textFlow=UtilProxy.generateTextFlow("|C:7&可领取|"):this.onlinetimelab.textFlow=UtilProxy.StrFormart("|C:7&当前通关：@0 /@1 |",[LyhProxy.ins().getCurId(),t.lyh_id]))},e.prototype.SetOnlineTimeLab=function(){this.onlinelefttime>0?(this.onlinetimelab.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[UtilProxy.getTimeHMSString(this.onlinelefttime)]),this.onlinelefttime=this.onlinelefttime-1):GuideProxy.ins().getGuideState()||(this.onlinetimelab.textFlow=UtilProxy.generateTextFlow("|C:7&可领取|"),TimerManager.ins().remove(this.SetOnlineTimeLab,this),this.onlinegift.visible&&ViewManager.ins().open(OnlineGiftView))},e.prototype.initBackBtn=function(){},e.prototype.onBackMainClick=function(t){var e=GameLogic.ins().getCurSceneId(),i=GlobalConfig.getSceneConfigById(e);i&&(i.is_main?LyhProxy.ins().goToCurScene():MainProxy.MainSceneId()&&SceneControl.ins().C2STransferScene(MainProxy.MainSceneId(),0,0))},e.prototype.GuideDoEvent=function(){GuideProxy.ins().isCanGuide=!0,GuideProxy.ins().startCheck()},e.prototype.SetBackG=function(t){this.backG.visible=t,this.backGTween&&egret.Tween.removeTweens(this.backGTween),TimerManager.ins().remove(this.setGackGTrue,this),t&&(this.backG.x=this.backTPoint.x,this.backG.y=this.backTPoint.y,this.backGTween=egret.Tween.get(this.backG,{loop:!0}).to({x:this.backOPoint.x,y:this.backOPoint.y},500).to({x:this.backTPoint.x,y:this.backTPoint.y},500))},e.prototype.setGackGTrue=function(){this.SetBackG(!0)},e.prototype.setLimitBossBtn=function(){var t=this.getSysItemByName("LimitBoss");if(t){var e=!1;if(0==CopyProxy.ins().getBossLimitLeftTime())e=!1,t.visible=!1,t.includeInLayout=!1;else{var i=0==t.data.page?1:2,n=0==t.data.page?Number(t.data.view_id):100*Number(t.data.view_id)+t.data.page;if(!SystemOpenProxy.ins().isOpen(i,n,!0))return;e=!0}e?this.isNeedHideSys(t.data)?this.AddHideListIndex(t):(t.visible=!0,t.includeInLayout=!0):this.removeHideListIndex(t)}},e.prototype.setYjfxBtn=function(){if(this.sys_yjfx){var t=GlobalConfig.getMisc_dataConfig(1);if(t){var e=!LimitActProxy.ins().IsFristRechargeOpen()&&RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)<t.yjfx_vip;this.sys_yjfx.visible=e,e&&this.sys_yjfx.setEff(!0,45)}}},e.prototype.setTrailBossBtn=function(){var t=this.getSysItemByName("7DAYBOSS");if(t){var e=!1,i=LimitActProxy.ins().GetServerOpenDay(),n=GlobalConfig.getTrial_bossConfigsLength();if(i>n)e=!1,t.visible=!1,t.includeInLayout=!1;else{var o=0==t.data.page?1:2,s=0==t.data.page?Number(t.data.view_id):100*Number(t.data.view_id)+t.data.page;if(!SystemOpenProxy.ins().isOpen(o,s,!0))return;e=!0}e?this.isNeedHideSys(t.data)?this.AddHideListIndex(t):(t.visible=!0,t.includeInLayout=!0):this.removeHideListIndex(t)}},e.prototype.setSYTRankBossBtn=function(){var t=this.getSysItemByName("SUOYAOTIANBANG");if(t){var e=!1;if(BossActProxy.ins().getActActiveByType(BossActType.sytower_rank)){var i=0==t.data.page?1:2,n=0==t.data.page?Number(t.data.view_id):100*Number(t.data.view_id)+t.data.page;if(!SystemOpenProxy.ins().isOpen(i,n,!0))return;e=!0}else e=!1,t.visible=!1,t.includeInLayout=!1;e?this.isNeedHideSys(t.data)?this.AddHideListIndex(t):(t.visible=!0,t.includeInLayout=!0):this.removeHideListIndex(t)}},e.prototype.setBGIslandBtn=function(){var t=SystemOpenProxy.ins().isOpen(1,87,!0);this.btn_r1.visible=t},e.prototype.ShowlimitedGifsBtn=function(){var t=this.getSysItemByName("XianshiLiBao");if(TimerManager.ins().remove(this.LimitedGifsTime,this),t){var e=LimitActProxy.ins().GetLimitedGifsRed();t.setRed(e);var i=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck))&&SystemOpenProxy.ins().isOpen(1,92,!0);if(this.isNeedHideSys(t.data)?this.setHideSystem(t,i):(t.visible=i,t.includeInLayout=i),i){LimitActProxy.ins().isGifsTabOpen()||(t.visible=!1,t.includeInLayout=!1);var n=LimitActProxy.ins().GetActivityCfgs(35,0),o=n[0];void 0!=o&&(this.limiteGifsEndTime=LimitActProxy.ins().GetActEndTime(o),this.limiteGifsEndTime>GameLogic.ins().getServerTime()?TimerManager.ins().doTimer(1e3,this.limiteGifsEndTime-GameLogic.ins().getServerTime()+1,this.LimitedGifsTime,this):TimerManager.ins().remove(this.LimitedGifsTime,this))}}},e.prototype.LimitedGifsTime=function(){var t=this.getSysItemByName("XianshiLiBao");if(t)return this.limiteGifsEndTime<=GameLogic.ins().getServerTime()?void this.ShowlimitedGifsBtn():void t.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(this.limiteGifsEndTime-GameLogic.ins().getServerTime())]),12)},e.prototype.setLimitBossTime=function(){CopyProxy.ins().isBossLimitScene(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isBossSevenDayScene(GameLogic.ins().getCurSceneId())?(this.copyTimeG.visible||(this.copyTimeG.visible=!0),TimerManager.ins().remove(this.updateCopyTime,this),TimerManager.ins().doTimer(1e3,0,this.updateCopyTime,this)):(this.copyTimeG.visible=!1,TimerManager.ins().remove(this.updateCopyTime,this))},e.prototype.updateCopyTime=function(){var t=CopyProxy.ins().getCopyLeftTime();this.fuben_time.textFlow=UtilProxy.generateTextFlow("C:7&"+UtilProxy.getTimeHMSString(Math.max(t,0)))},e.prototype.setGuanKa=function(t){var e=this;if(this.guangKaG.visible=t,this.guanTween&&egret.Tween.removeTweens(this.guanTween),t){this.guangKaG.alpha=1;var i=CopyProxy.ins().BossLimitSceneFloor(GameLogic.ins().getCurSceneId()).toString();this.guangIndex.text=i,this.endGuangKa.x=this.guangIndex.x+23*i.length+5,this.backGTween=egret.Tween.get(this.guangKaG,{loop:!1}).wait(2e3).to({alpha:.1},500).call(function(){e.guangKaG.visible=!1})}},e.prototype.freshLimitActRed=function(t){this.setLimitBossRed(),this.setSYTRankActRed()},e.prototype.setLimitBossRed=function(){var t=this.getSysItemByName("LimitBoss");t&&t.setRed(BossActProxy.ins().getRed())},e.prototype.setSYTRankActRed=function(){var t=this.getSysItemByName("SUOYAOTIANBANG");t&&t.setRed(BossActProxy.ins().getRedByType(BossActType.sytower_rank))},e.prototype.setPreSysList=function(){},e.prototype.UpdateBossRevive=function(t){if(SystemOpenProxy.ins().isOpen(1,8,!0)){var e=t,i=GlobalConfig.getBossConfig(e),n=GlobalConfig.getMonsterConfigById(e);if(n){this.bossReviveG.visible=!0,this.bossReviveG.x=this.bossReviveG_initx;var o=this.bossReviveG_initx,s=this.bossReviveG_initx-10;egret.Tween.get(this.bossReviveG,{loop:!0}).to({x:s},500).to({x:o},500),this.bossR_res.textFlow=UtilProxy.StrFormart("|C:7&@0 |复活了",[n.name]);var r=["个人","野外","秘境","深渊","跨服","阎罗","异域"];this.bossR_res0.text=r[i.type]||""}}},e.prototype.onSkillClick=function(t){this.showSkill()},e.prototype.showSkill=function(){this.skill_can_use&&(SkillCC.ins().play_bskill=!0,this.skill_can_use=!1)},e.prototype.updateSkillCD=function(){var t=SkillCC.ins().getBestSkill();if(t){var e=GlobalConfig.getSkillDescById(Math.floor(t.skillId/1e4)),i=45,n=43,o=e.cd-(t.skillCDTick-egret.getTimer()),s=e.cd,r=o/s>1?1:o/s;this.skill_cd.visible=!0,this.skill_can_use=r>=1?!0:!1,this.skill_cd.mask=new egret.Rectangle(0,n-n*r,i,n),o/s>1?(SetProxy.ins().clickByBox&&this.showSkill(),this.setSkillEff1(!0)):this.setSkillEff1(!1)}},e.prototype.setSkillEff0=function(t){this.skill_effect0.visible=!1,t?(this.skill_effect0.touchEnabled=!1,this.skill_effect0.touchChildren=!1,0==this.skill_effect0.numChildren&&UtilProxy.GetMovieClipById(36,this.skill_effect0)):this.skill_effect0.numChildren>0&&this.skill_effect0.removeChildren()},e.prototype.setSkillEff1=function(t){this.skill_effect1.visible!=t&&(this.skill_effect1.visible=t,this.skill_effect1.touchEnabled=!1,this.skill_effect1.touchChildren=!1,t?0==this.skill_effect1.numChildren&&UtilProxy.GetMovieClipById(37,this.skill_effect1):this.skill_effect1.numChildren>0&&this.skill_effect1.removeChildren())},e.prototype.setgroup_sysState=function(t){this.isXFViewOpen?this.group_sys.visible=t:(this.group_sys.visible=!1,this.isgroup_sysShow=!1)},e.prototype.ChangeBGIsland=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1];1==i?(this.isBGIslanOpen=!n,this.isXFViewOpen||(this.topAnchor.visible=n),this.topLAnchor.visible=n):this.blMain.visible=n},e.prototype.SetAnchorState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];if(this.isBGIslanOpen||(this.topAnchor.visible=i),this.rAnchor.visible=i,this.blAnchor.visible=i,this.bAnchor.visible=i,this.otherG.visible=i,this.trAnchor.visible=i,this.isXFViewOpen=!i,this.MakeBtn.visible=i,this.chatG.visible=i,this.isXFViewOpen?(this.isTopSysShow||this.setTopSys(),this.setgroup_sysState(!0)):this.setgroup_sysState(this.isgroup_sysShow),i){for(var n=0;n<this.topSysList.length;++n){var o=this.topSysList[n].data;o&&1==o.isShowXF&&this.topSysList[n].visible&&(this.topSysList[n].visible=!1,this.topSysList[n].includeInLayout=!1,this.hideList1||(this.hideList1=[]),this.hideList1.push(this.topSysList[n]))}if(this.hideList)for(var n=0;n<this.hideList.length;++n)this.hideList[n].visible=!0,this.hideList[n].includeInLayout=!0;this.hideList=void 0,this.topLAnchor.y=this.topLAnchor.y+48}else{for(var n=0;n<this.topSysList.length;++n){var o=this.topSysList[n].data;o&&!o.isShowXF&&this.topSysList[n].visible&&(this.topSysList[n].visible=!1,this.topSysList[n].includeInLayout=!1,this.hideList||(this.hideList=[]),this.hideList.push(this.topSysList[n]))}if(this.hideList1)for(var n=0;n<this.hideList1.length;++n)this.hideList1[n].visible=!0,this.hideList1[n].includeInLayout=!0;this.hideList1=void 0,this.topLAnchor.y=this.topLAnchor.y-48,this.sevenday_tips&&this.sevenday_tips.visible&&(this.sevenday_tips.visible=!1)}},e.prototype.getHideListIndex=function(t){if(this.hideList)for(var e=0;e<this.hideList.length;++e)if(t.data.name==this.hideList[e].data.name)return e;return-1},e.prototype.getHideList1Index=function(t){if(this.hideList1)for(var e=0;e<this.hideList1.length;++e)if(t.data.name==this.hideList1[e].data.name)return e;return-1},e.prototype.AddHideListIndex=function(t){this.isXFViewOpen?(this.hideList||(this.hideList=[]),-1==this.getHideListIndex(t)&&this.hideList.push(t)):(this.hideList1||(this.hideList1=[]),-1==this.getHideList1Index(t)&&this.hideList1.push(t))},e.prototype.removeHideListIndex=function(t){this.getHideListIndex(t)>-1&&this.hideList.splice(this.getHideListIndex(t),1),this.getHideList1Index(t)>-1&&this.hideList1.splice(this.getHideList1Index(t),1)},e.prototype.isNeedHideSys=function(t){if(!t)return!1;if(1!=t.direction)return!1;var e=1==t.isShowXF;return this.isXFViewOpen!=e?!0:!1},e.prototype.setHideSystem=function(t,e){e?this.AddHideListIndex(t):this.removeHideListIndex(t)},e.prototype.SetFFPushTips=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());if(this.btn_r4.visible&&"main_btn_zongzhuzhengduo"==this.btn_r4.icon&&(!i||1==i.scene_type)){var n=t[0];this.FFPushTips.visible=!0;var o=this.FFPushTips.getChildAt(1);o.text=n,TimerManager.ins().remove(this.ColseFFpushTips,this),TimerManager.ins().doTimer(1e4,1,this.ColseFFpushTips,this)}},e.prototype.ColseFFpushTips=function(){this.FFPushTips.visible=!1},e}(BaseEuiView);__reflect(MainUIView.prototype,"MainUIView"),ViewManager.ins().reg(MainUIView,LayerManager.UI_Main),window.MainUIView=MainUIView;var MakeGetIt=function(t){function e(){var e=t.call(this)||this;return e.skinName="MakeGetItemSkin",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){EventProxy.Broast(EventType.addMakeGetIt,[1]),ViewManager.ins().close(MakeGetListView)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){var t=this.data;void 0!=t&&void 0!=t.item_type_id&&(this.itName.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[this.data.itemConfig.quality-1],this.data.itemConfig.name]),this.it.data=t,this.fight.textFlow=UtilProxy.StrFormart("|战斗力：|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[this.data.itemConfig.quality-1],UtilProxy.getFightNumLab(UtilProxy.GetAttrFight(this.data.itemConfig))]),this.info.textFlow=UtilProxy.StrFormart("|转数：|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[this.data.itemConfig.quality-1],UtilProxy.getZhuanStr(this.data.itemConfig.reborn)]))},e}(BaseItemRender);__reflect(MakeGetIt.prototype,"MakeGetIt"),window.MakeGetIt=MakeGetIt;var MakeGetListView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="MakeGetListSkin",this.listC.itemRenderer=MakeGetIt,this.scrollerC.viewport=this.listC,this.listC.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rCloseBtn0,this.onCloseClick),this.addTouchEvent(this.onkeyEnterBtn,this.onOnkeyGetEnterClick),this.get_item_id=t[0],this.get_item_count=t[1],this.ShowGetListView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rCloseBtn0,this.onCloseClick),this.removeTouchEvent(this.onkeyEnterBtn,this.onOnkeyGetEnterClick)},e.prototype.onClick=function(t){},e.prototype.onCloseClick=function(t){this.closeView()},e.prototype.closeView=function(){ViewManager.ins().close(this)},e.prototype.ShowGetListView=function(){for(var t=this.get_item_id,e=BagProxy.ins().getItemCountById(t),i=[],n=this.get_item_count;e>n;++n)i.push(UtilProxy.GetItemCellData(t,1));this.listC.dataProvider=new eui.ArrayCollection(i)},e.prototype.onOnkeyGetEnterClick=function(t){EventProxy.Broast(EventType.addMakeGetIt,[2]),this.closeView()},e}(BaseEuiView);__reflect(MakeGetListView.prototype,"MakeGetListView"),ViewManager.ins().reg(MakeGetListView,LayerManager.UI_Main2),window.MakeGetListView=MakeGetListView;var MakeItem=function(t){function e(){var e=t.call(this)||this;return e.num=-1,e.skinName="MakeItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){var t=this.data;if(void 0!=t){this.num=t.item_count;var e=t;e.item_count=0,this.item.data=e;var i=BagProxy.ins().getItemCountById(t.item_type_id);this.count.text=i+"/"+this.num}},e.prototype.setItemShowTips=function(t){this.makeImg&&(this.makeImg.visible=!t)},e.prototype.SetCountState=function(t){this.count.visible=t},e}(BaseItemRender);__reflect(MakeItem.prototype,"MakeItem"),window.MakeItem=MakeItem;var MakeView_Make=function(t){function e(){var e=t.call(this)||this;return e.cur_num=0,e.menuList=[],e.get_item_id=0,e.get_item_count=0,e.addIndex=0,e}return __extends(e,t),e.prototype.initUI=function(){this.show_item=[this.item0,this.item1,this.item2,this.item3,this.item4],this.suo_list=[this.suo0,this.suo1,this.suo2,this.suo3,this.suo4],this.add_list=[this.Add0,this.Add1,this.Add2,this.Add3,this.Add4],this.list0.itemRenderer=MakeIt,this.scroller0.viewport=this.list0,this.list0.dataProvider=new eui.ArrayCollection,this.select_info.textFlow=UtilProxy.StrFormart("|C:@0 &选择您要合成的部位 |",[10]),this.setVisible(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.Add,this.onNumClick),this.addTouchEvent(this.Addten,this.onNumClick),this.addTouchEvent(this.Less,this.onNumClick),this.addTouchEvent(this.Lessten,this.onNumClick),this.addTouchEvent(this.enterBtn,this.onEnterClick),this.addItemTapEvent(this.list0,this.onMakeItClick);for(var i=0;i<this.add_list.length;++i)this.addTouchEvent(this.add_list[i],this.onAddClick);for(var i=0;i<this.show_item.length;++i)this.addTouchEvent(this.show_item[i].makeImg,this.onDischargeClick);this.addTouchEvent(this.des_btn,this.onDesClick),EventProxy.AddListener(this,EventType.S2CRepMiscMake,this.S2CRepMiscMake),EventProxy.AddListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),EventProxy.AddListener(this,EventType.addMakeGetIt,this.addMakeGetIt),this.setMenuData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.Add,this.onNumClick),this.removeTouchEvent(this.Addten,this.onNumClick),this.removeTouchEvent(this.Less,this.onNumClick),this.removeTouchEvent(this.Lessten,this.onNumClick),this.removeTouchEvent(this.enterBtn,this.onEnterClick),this.removeItemTapEvent(this.list0,this.onMakeItClick);for(var i=0;i<this.add_list.length;++i)this.removeTouchEvent(this.add_list[i],this.onAddClick);for(var i=0;i<this.show_item.length;++i)this.removeTouchEvent(this.show_item[i].makeImg,this.onDischargeClick);this.removeTouchEvent(this.des_btn,this.onDesClick),EventProxy.RemoveListener(this,EventType.S2CRepMiscMake,this.S2CRepMiscMake),EventProxy.RemoveListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),EventProxy.RemoveListener(this,EventType.addMakeGetIt,this.addMakeGetIt)},e.prototype.setVisible=function(t){this.visible=t,t&&(this.selectMenu(),this.setRed())},e.prototype.S2CRepMiscMake=function(t){void 0!=this.make_config&&1==this.make_config.type&&this.setDataInfo(),this.cur_make_it&&this.setMakeView(this.cur_make_it)},e.prototype.RefreshMakeRed=function(t){this.visible&&this.setRed()},e.prototype.setMenuData=function(){var t=GlobalConfig.getMake_list_dataConfigs(),e=0;for(var i in t){if(!this.menuList[e]){var n=new eui.Group,o=new eui.VerticalLayout;o.verticalAlign=egret.VerticalAlign.TOP,o.gap=2,n.layout=o;var s=new ButtonEx;s.skinName="Btn5ExSkin",s.setUpState(!0),s.label=t[i][1].name,s.icon="common_btn_bluebiaoqing_off_01",n.addChild(s),this.menuList.push(n),this.sG0.addChild(n),this.addTouchEvent(s,this.onBtnxClick)}e++}this.validateNow()},e.prototype.onDesClick=function(t){this.make_config&&ViewManager.ins().open(TipsTrunView,this.make_config.des,"套装说明")},e.prototype.onBtnxClick=function(t){var e=t.currentTarget;if(this.lastBtnx&&this.lastBtnx==e){for(var i=this.lastBtnx.parent,n=1;n<i.numChildren;++n)i.getChildAt(n).visible=this.lastBtnx.isUpState,i.getChildAt(n).includeInLayout=this.lastBtnx.isUpState;return void(this.lastBtnx.isUpState?(i.getChildAt(0).icon="common_btn_bluebiaoqing_on_01",i.getChildAt(0).setUpState(!1)):(i.getChildAt(0).icon="common_btn_bluebiaoqing_off_01",i.getChildAt(0).setUpState(!0)))}if(this.lastBtnx){for(var i=this.lastBtnx.parent,n=1;n<i.numChildren;++n)i.getChildAt(n).icon="common_btn_bluebiaoqing_off_02",i.getChildAt(n).visible=!1,i.getChildAt(n).includeInLayout=!1;i.getChildAt(0).icon="common_btn_bluebiaoqing_off_01",i.getChildAt(0).setUpState(!0)}this.lastBtnx=e;var o=t.currentTarget.parent,s=this.menuList.indexOf(o);if(o.getChildAt(0).icon="common_btn_bluebiaoqing_on_01",o.getChildAt(0).setUpState(!1),o.numChildren>1)for(var n=1;n<o.numChildren;++n)o.getChildAt(n).visible=!0,o.getChildAt(n).includeInLayout=!0,o.getChildAt(n).icon="common_btn_bluebiaoqing_off_02";else{var r=GlobalConfig.getMake_list_dataConfigById(s+1);for(var a in r){var h=new ButtonEx;h.skinName="BtnMakeSubSkin",h.icon="common_btn_bluebiaoqing_off_02",o.addChild(h),this.addTouchEvent(h,this.onBtnxSubClick),h.label=r[a].sub_name}}},e.prototype.onBtnxSubClick=function(t){var e=t.currentTarget,i=e.parent;e.icon="common_btn_bluebiaoqing_on_02";for(var n=0,o=1;o<i.numChildren;++o)i.getChildAt(o)==t.currentTarget?n=o:i.getChildAt(o).icon="common_btn_bluebiaoqing_off_02";var s=this.menuList.indexOf(i),r=s+1,a=n;this.SetCurrentData(r,a)},e.prototype.SetCurrentData=function(t,e){this.listG.visible=!0,this.makeG.visible&&(this.makeG.visible=!1);var i=GlobalConfig.getMakeConfigByPage(t,e);this.list0.dataProvider=new eui.ArrayCollection(i)},e.prototype.selectMenu=function(){var t,e=MakeProxy.ins().selectMakeConf();t=e?GlobalConfig.getMake_list_dataConfig(e.page,e.sub_page):GlobalConfig.getMake_list_dataConfig(1,1),this.selectMenuByPage(t.main_page,t.sub_page)},e.prototype.selectMenuByPage=function(t,e){var i=t-1;if(this.menuList[i]){var n=this.menuList[i];if(n.getChildAt(0).icon="common_btn_bluebiaoqing_on_01",n.getChildAt(0).setUpState(!1),n.numChildren>1)for(var o=1;o<n.numChildren;++o)n.getChildAt(o).icon="common_btn_bluebiaoqing_off_02",n.getChildAt(o).visible=!0,n.getChildAt(o).includeInLayout=!0;else{var s=GlobalConfig.getMake_list_dataConfigById(i+1),o=0;for(var r in s){var a=new ButtonEx;a.skinName="BtnMakeSubSkin",a.icon="common_btn_bluebiaoqing_off_02",n.addChild(a),this.addTouchEvent(a,this.onBtnxSubClick),a.label=s[r].sub_name}}if(this.lastMenuIt&&this.lastMenuIt==n.getChildAt(e))return;if(this.lastMenuIt){for(var o=1;o<this.lastMenuIt.parent.numChildren;++o)this.lastMenuIt.parent.getChildAt(o).visible=!1,this.lastMenuIt.parent.getChildAt(o).includeInLayout=!1;this.lastMenuIt.parent.getChildAt(0).icon="common_btn_bluebiaoqing_off_01",this.lastMenuIt.parent.getChildAt(0).setUpState(!0)}this.lastBtnx=n.getChildAt(0),n.getChildAt(e).icon="common_btn_bluebiaoqing_on_02",this.SetCurrentData(t,e)}},e.prototype.setDataInfo=function(){if(void 0!=this.make_config){for(var t=Number.MAX_VALUE,e=0;e<this.make_config.src.length;++e){var i=Math.floor(BagProxy.ins().getItemCountById(this.make_config.src[e][0])/this.make_config.src[e][1]);t=Math.min(t,i)}this.make_config.need_money.length>0&&(t=Math.min(t,Math.floor(RoleProxy.ins().getMoneyAttr(this.make_config.need_money[0])/this.make_config.need_money[1]))),t>0?this.cur_num=Math.max(1,this.cur_num):this.cur_num=0,this.value.text=this.make_config.need_money[1]?(this.make_config.need_money[1]*this.cur_num).toString():"",this.make_config.need_money[0]&&(this.icon.source=UtilProxy.getMoneyIcon(this.make_config.need_money[0])),this.num.text=this.cur_num.toString()}},e.prototype.initData=function(){this.targetItem.visible=!1,this.targetItemBg.visible=!0,this.lastSkinItem=void 0,this.make_config=void 0,this.cur_num=0,this.num.text="",this.value.text="";for(var t=0;t<this.show_item.length;++t)this.show_item[t].visible=!1,this.show_itemBg[t].visible=!0;var e=function(){var t=this.list.$children[0];if(void 0!=t){var i=t.data;void 0!=i&&(this.selectSkinItem(t),this.setRed(),TimerManager.ins().remove(e,this))}};TimerManager.ins().doTimer(100,0,e,this)},e.prototype.onAddClick=function(t){this.addIndex=this.add_list.indexOf(t.currentTarget),BagProxy.ins().getItemCountById(this.get_item_id)>this.get_item_count?ViewManager.ins().open(MakeGetListView,this.get_item_id,this.get_item_count):TipsControl.ins().showTips("背包物品不足！")},e.prototype.onDischargeClick=function(t){var e=t.currentTarget.parent,i=this.show_item.indexOf(e);this.add_list[i].visible=!0,this.show_item[i].visible=!1,this.get_item_count=this.get_item_count-1,this.refreshRateInfo()},e.prototype.onNumClick=function(t){if(void 0!=this.make_config){var e=this.cur_num,i=!0,n=0;this.make_config.need_money.length>0&&(n=Math.floor(RoleProxy.ins().getMoneyAttr(this.make_config.need_money[0])/this.make_config.need_money[1]),i=n>0);for(var o=0;o<this.make_config.src.length;++o){var s=Math.floor(BagProxy.ins().getItemCountById(this.make_config.src[o][0])/this.make_config.src[o][1]);n=this.make_config.need_money.length>0?Math.min(n,s):s}switch(t.currentTarget){case this.Add:e+1>n?0==e?i?TipsControl.ins().showTips("材料不足！"):TipsControl.ins().showTips("货币不足！"):TipsControl.ins().showTips("已达上限！"):e+=1;break;case this.Addten:e+1>n?0==e?i?TipsControl.ins().showTips("材料不足！"):TipsControl.ins().showTips("货币不足！"):TipsControl.ins().showTips("已达上限！"):e=Math.min(n,e+10);break;case this.Less:e=Math.max(1,e-1);break;case this.Lessten:e=Math.max(1,e-10)}this.cur_num=e,this.num.text=e.toString(),this.setDataInfo()}},e.prototype.onEnterClick=function(t){if(void 0!=this.make_config){var e=0;if(e=1==this.make_config.type?this.cur_num:this.get_item_count,this.make_config.need_money.length>0){var i=Math.floor(RoleProxy.ins().getMoneyAttr(this.make_config.need_money[0])/this.make_config.need_money[1]);if(0==i)return void TipsControl.ins().showTips("货币不足！")}else if(0>=e)return void TipsControl.ins().showTips("材料不足！");MakeProxy.ins().C2SReqMiscMake(this.make_config.id,e)}},e.prototype.onMakeItClick=function(t){var e=t.itemRenderer;this.cur_make_it=e,this.setMakeView(e)},e.prototype.setMakeView=function(t){this.listG.visible&&(this.listG.visible=!1),this.makeG.visible||(this.makeG.visible=!0);var e=t.data;this.make_config=e;var i=UtilProxy.GetItemCellData(e.tar[0],e.tar[1]);if(this.targetItem.data=i,this.get_item_count=0,1==e.type){this.rateLab.text="",this.rate_info.visible=!1;for(var n=0;n<this.show_item.length;++n)this.add_list[n].visible=!1,this.show_item[n].SetCountState(!0),this.show_item[n].setItemShowTips(!0),n<e.src.length?(this.suo_list[n].visible=!1,this.show_item[n].visible=!0,this.show_item[n].data=UtilProxy.GetItemCellData(e.src[n][0],e.src[n][1])):(this.show_item[n].visible=!1,this.suo_list[n].visible=!0);this.addNumG.visible=!0,this.setDataInfo()}else{this.get_item_id=e.src[0],this.rate_info.visible=!0;var o=BagProxy.ins().getItemCountById(this.get_item_id),s=Math.ceil(100/this.make_config.rate),r=Math.min(s,o);this.get_item_count=r;for(var n=0;n<this.show_item.length;++n)this.show_item[n].SetCountState(!1),this.add_list[n].visible=n+1>this.get_item_count,this.show_item[n].visible=n+1<=this.get_item_count,this.show_item[n].data=UtilProxy.GetItemCellData(this.get_item_id,1),this.show_item[n].setItemShowTips(!1),this.suo_list[n].visible=!1;this.refreshRateInfo(),this.addNumG.visible=!1}this.tarLab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[i.itemConfig.quality-1],i.itemConfig.name])},e.prototype.addMakeGetIt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=0;if(1==i)this.get_item_count++,n=1;else{var o=BagProxy.ins().getItemCountById(this.get_item_id),s=Math.ceil(100/this.make_config.rate);n=1;var r=Math.min(s,o);n=r-this.get_item_count,this.get_item_count=r}this.setEnterData(n)},e.prototype.setEnterData=function(t){if(t>0&&(this.add_list[this.addIndex].visible=!1,this.show_item[this.addIndex].visible=!0,this.show_item[this.addIndex].data=UtilProxy.GetItemCellData(this.get_item_id,1),t-=1),t>0)for(var e=0;e<this.add_list.length;++e)this.add_list[e].visible&&t>0&&(this.add_list[e].visible=!1,this.show_item[e].visible=!0,this.show_item[e].data=UtilProxy.GetItemCellData(this.get_item_id,1),t-=1);this.refreshRateInfo()},e.prototype.refreshRateInfo=function(){this.rateLab.textFlow=UtilProxy.StrFormart("|C:@0 &合成概率:@1 %|",[10,this.get_item_count*(this.make_config.rate||0)])},e.prototype.setRed=function(){for(var t=0;t<this.menuList.length;++t)for(var e=this.menuList[t],i=0;i<e.numChildren;++i){var n=e.getChildAt(i);n&&(0==i?n.setRed(MakeProxy.ins().getMakeRedByType(t+1)):n.setRed(MakeProxy.ins().getMakeRedBySubType(t+1,i)))}},e}(BaseEuiView);__reflect(MakeView_Make.prototype,"MakeView_Make"),window.MakeView_Make=MakeView_Make;var MakeView_Split=function(t){function e(){var e=t.call(this)||this;return e.cur_num=0,e.show_count=0,e}return __extends(e,t),e.prototype.initUI=function(){this.show_item=[this.item0,this.item1,this.item2,this.item3],this.show_itemBg=[this.itemBg0,this.itemBg1,this.itemBg2,this.itemBg3],this.list.itemRenderer=BagItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.setVisible(!1)
},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.Add,this.onNumClick),this.addTouchEvent(this.Addten,this.onNumClick),this.addTouchEvent(this.Less,this.onNumClick),this.addTouchEvent(this.Lessten,this.onNumClick),this.addTouchEvent(this.enterBtn,this.onEnterClick),EventProxy.AddListener(this,EventType.S2CRepMiscItemSplit,this.S2CRepMiscItemSplit),EventProxy.AddListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cur_num=0,this.removeTouchEvent(this.Add,this.onNumClick),this.removeTouchEvent(this.Addten,this.onNumClick),this.removeTouchEvent(this.Less,this.onNumClick),this.removeTouchEvent(this.Lessten,this.onNumClick),this.removeTouchEvent(this.enterBtn,this.onEnterClick),EventProxy.RemoveListener(this,EventType.S2CRepMiscItemSplit,this.S2CRepMiscItemSplit),EventProxy.RemoveListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed)},e.prototype.setVisible=function(t){this.visible=t,t?(this.setData(),this.initData(),this.setRed()):this.cur_num=0},e.prototype.S2CRepMiscItemSplit=function(t){this.setData(),this.initData(),this.setRed()},e.prototype.RefreshMakeRed=function(t){this.setRed()},e.prototype.setRed=function(){this.enterBtn.setRed(MakeProxy.ins().getSplitRed())},e.prototype.setData=function(){var t=GlobalConfig.getSplitConfig(),e=new Array;this.key_list=[],this.show_count=0;var i=[],n=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),o=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL);for(var s in t){var r,a=t[s];BagProxy.ins().getItemCountById(a.id)>=1&&a.reborn<=n&&a.level<=o?(r=UtilProxy.GetItemCellData(a.id,1,!1),e.push(r),this.key_list.push(Number(s)),this.show_count++):i.push(s)}for(var h=0;h<i.length;++h)e.push(void 0),this.key_list.push(Number(i[h])),this.show_count++;this.list.dataProvider=new eui.ArrayCollection(e),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this)},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){var e=t.data;if(void 0!=e){if(this.lastSkinItem==t)return;void 0!=this.lastSkinItem&&this.lastSkinItem.ShowOnSelect(!1),this.lastSkinItem=t,this.lastSkinItem.ShowOnSelect(!0),this.SetSkinData(t),this.setDataInfo()}}},e.prototype.SetSkinData=function(t){for(var e=0;e<this.list.numChildren;++e)if(this.list.getChildAt(e)==t){var i=this.list.getChildAt(e),n=this.key_list[i.itemIndex],o=GlobalConfig.getSplit_dataConfig(n);if(this.split_config=o,void 0!=o)for(var s=0;s<this.show_item.length;++s)s>=o.items.length?(this.show_item[s].visible=!1,this.show_itemBg[s].visible=!0):(this.show_item[s].visible=!0,this.show_itemBg[s].visible=!1)}this.targetItem.visible=!0,this.targetItemBg.visible=!1;var r=t.data;r.isTips=!0,this.targetItem.data=r},e.prototype.setTargetData=function(){if(this.split_config)for(var t=0;t<this.show_item.length;++t)if(t<this.split_config.items.length){this.show_item[t].visible=!0,this.show_itemBg[t].visible=!1;var e=UtilProxy.GetItemCellData(this.split_config.items[t][0],this.split_config.items[t][1]*Math.max(1,this.cur_num));this.show_item[t].data=e}},e.prototype.setDataInfo=function(){if(void 0!=this.split_config){var t=BagProxy.ins().getItemCountById(this.split_config.id);this.split_config.need_money.length>0&&(t=Math.min(t,Math.floor(RoleProxy.ins().getMoneyAttr(this.split_config.need_money[0])/this.split_config.need_money[1]))),t>0?this.cur_num=Math.max(1,this.cur_num):this.cur_num=0,this.value.text=this.split_config.need_money[1]?(this.split_config.need_money[1]*this.cur_num).toString():"",this.split_config.need_money[0]&&(this.icon.source=UtilProxy.getMoneyIcon(this.split_config.need_money[0])),this.num.text=this.cur_num.toString(),this.setTargetData()}},e.prototype.initData=function(){this.targetItem.visible=!1,this.targetItemBg.visible=!0,this.lastSkinItem=void 0,this.split_config=void 0,this.cur_num=0,this.num.text="",this.value.text="";for(var t=0;t<this.show_item.length;++t)this.show_item[t].visible=!1,this.show_itemBg[t].visible=!0;if(this.show_count>0){var e=function(){var t=this.list.$children[0];if(void 0!=t){var i=t.data;void 0!=i&&(this.selectSkinItem(t),TimerManager.ins().remove(e,this))}};TimerManager.ins().doTimer(100,0,e,this)}},e.prototype.onNumClick=function(t){if(void 0!=this.split_config){var e=this.cur_num,i=BagProxy.ins().getItemCountById(this.split_config.id),n=i>0;switch(this.split_config.need_money.length>0&&(i=Math.min(i,Math.floor(RoleProxy.ins().getMoneyAttr(this.split_config.need_money[0])/this.split_config.need_money[1]))),t.currentTarget){case this.Add:e+1>i?0==e?n?TipsControl.ins().showTips("货币不足！"):TipsControl.ins().showTips("物品不足！"):TipsControl.ins().showTips("已达上限！"):e+=1;break;case this.Addten:e+1>i?0==e?n?TipsControl.ins().showTips("货币不足！"):TipsControl.ins().showTips("物品不足！"):TipsControl.ins().showTips("已达上限！"):e=Math.min(i,e+10);break;case this.Less:e=Math.max(1,e-1);break;case this.Lessten:e=Math.max(1,e-10)}this.cur_num=e,this.num.text=e.toString(),this.setDataInfo()}},e.prototype.onEnterClick=function(t){if(void 0!=this.split_config){var e=this.cur_num;if(this.split_config.need_money.length>0){var i=Math.floor(RoleProxy.ins().getMoneyAttr(this.split_config.need_money[0])/this.split_config.need_money[1]);if(0==i)return void TipsControl.ins().showTips("货币不足！")}else if(0>=e)return void TipsControl.ins().showTips("物品不足！");return BagProxy.ins().GetBagLeftCount(BagType.BAG)<this.split_config.items.length?void TipsControl.ins().showTips("背包格子不足！"):void MakeProxy.ins().C2SReqMiscItemSplit(this.split_config.id,e)}},e}(BaseEuiView);__reflect(MakeView_Split.prototype,"MakeView_Split"),window.MakeView_Split=MakeView_Split;var MakeView=function(t){function e(){var e=t.call(this)||this;return e.current_index=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="MakeViewSkin",this.bList=[this.b0,this.b1,this.b2],this.viewList=[this.splitView,this.makeView],this.comview.initUI(),this.makeView.initUI(),this.splitView.initUI()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.comview.open(),this.addTouchEvent(this.b0,this.onClick),this.addTouchEvent(this.b1,this.onClick),this.addTouchEvent(this.b2,this.onClick),this.addTouchEvent(this.closebtn,this.onClick),this.makeView.open(),this.splitView.open(),void 0!=t&&void 0!=t[0]){var i=t[0];this.setCurrentView(this.viewList[i-1],i+1)}else this.setCurrentView(this.makeView,3);EventProxy.AddListener(this,EventType.S2CRepMiscMake,this.S2CRepMiscMake),EventProxy.AddListener(this,EventType.S2CRepMiscItemSplit,this.S2CRepMiscItemSplit),EventProxy.AddListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.ShowSmeltBtn),this.RefreshMakeRed(void 0),this.ShowSmeltBtn()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.b0,this.onClick),this.removeTouchEvent(this.b1,this.onClick),this.removeTouchEvent(this.b2,this.onClick),this.removeTouchEvent(this.closebtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepMiscMake,this.S2CRepMiscMake),EventProxy.RemoveListener(this,EventType.S2CRepMiscItemSplit,this.S2CRepMiscItemSplit),EventProxy.RemoveListener(this,EventType.RefreshMakeRed,this.RefreshMakeRed),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.ShowSmeltBtn),this.makeView.close(),this.splitView.close(),this.current_view=void 0,this.current_index=-1},e.prototype.S2CRepMiscMake=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];i&&(UtilProxy.GetMovieClipById(24,this.eff),UtilProxy.GetMovieClipById(26,this.eff))},e.prototype.S2CRepMiscItemSplit=function(t){UtilProxy.GetMovieClipById(25,this.eff)},e.prototype.ShowSmeltBtn=function(){this.b0.setRed(MakeProxy.ins().getSmeltRed())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.b0:ViewManager.ins().close(this),ViewManager.ins().open(SmeltView);break;case this.b1:this.setCurrentView(this.splitView,2);break;case this.b2:this.setCurrentView(this.makeView,3);break;case this.closebtn:ViewManager.ins().close(this)}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setCurrentView=function(t,e){if(this.current_index!=e){null!=this.current_view&&this.current_view.setVisible(!1);for(var i=0;i<this.bList.length;++i)i+1==e?this.bList[i].icon="common_btn_big_yellow":this.bList[i].icon="common_btn_big_yellow_off";switch(this.current_view=t,this.current_view.setVisible(!0),this.current_index=e,e){case 1:break;case 2:this.comview.SetName(UtilProxy.getTitleName("分解"));break;case 3:this.comview.SetName(UtilProxy.getTitleName("合成"))}}},e.prototype.RefreshMakeRed=function(t){this.b2.setRed(MakeProxy.ins().getMakeRed()),this.b1.setRed(MakeProxy.ins().getSplitRed())},e}(BaseEuiView);__reflect(MakeView.prototype,"MakeView"),ViewManager.ins().reg(MakeView,LayerManager.UI_Main),window.MakeView=MakeView;var MakeIt=function(t){function e(){var e=t.call(this)||this;return e.skinName="MakeItSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){this.refreshData()},e.prototype.refreshData=function(){var t=this.data;if(void 0!=t){var e=UtilProxy.GetItemCellData(t.tar[0],t.tar[1]);this.itemName.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[e.itemConfig.quality-1],e.itemConfig.name]),this.it.data=e,this.red.visible=MakeProxy.ins().getMakeItemRed(t.id),2==t.type?this.itemNum.textFlow=UtilProxy.StrFormart("|C:@0 &数量:@1 |",[7,BagProxy.ins().getItemCountById(t.src[0])]):this.itemNum.text=""}},e}(BaseItemRender);__reflect(MakeIt.prototype,"MakeIt"),window.MakeIt=MakeIt;var OnlineGiftView=function(t){function e(){var e=t.call(this)||this;return e.lefttime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="OnlineGiftSkin",this.gs=[this.g1,this.g2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CVipGetTimes,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepVipGetOnlineAward,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CVipGetTimes,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepVipGetOnlineAward,this.ShowInfo),TimerManager.ins().remove(this.SetTimeLab,this),this.curShowG&&(this.curShowG.visible=!1,this.curShowG=void 0),this.movie&&(this.movie.clear(),this.model.removeChildren())},e.prototype.onBtnClick=function(t){t.currentTarget==this.btn&&this.curdata&&this.lefttime<=0&&!VIPProxy.ins().IsOnlineAwardGet(this.curdata.id)&&this.curdata.lyh_id<=LyhProxy.ins().getCurId()&&VIPProxy.ins().C2SReqVipGetOnlineAward(this.curdata.id),ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){return this.curdata=VIPProxy.ins().getCurOnlineAwardData(),void 0==this.curdata?void ViewManager.ins().close(this):(this.curShowG&&(this.curShowG.visible=!1),this.curShowG=this.gs[this.curdata.id-1],this.curShowG&&(this.curShowG.visible=!0),this.model.visible=""!=this.curdata.ui_model,""!=this.curdata.ui_model&&(this.movie||(this.movie=new MovieClip,this.model.addChild(this.movie)),this.movie.setFrameRate(UI_WING_DIR+this.curdata.ui_model,6),this.movie.playFile(UI_WING_DIR+this.curdata.ui_model,-1)),void(this.curdata.need_time>0?(this.lefttime=this.curdata.need_time-VIPProxy.ins().getOnlineTime(),this.SetTimeLab(),this.lefttime>0&&(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this))):(this.red.visible=this.curdata.lyh_id<=LyhProxy.ins().getCurId(),this.curdata.lyh_id<=LyhProxy.ins().getCurId()?this.btn.label="领取奖励":this.btn.label="稍后领取",this.timelab.textFlow=UtilProxy.StrFormart("|C:7&当前通关：@0 /@1 |",[LyhProxy.ins().getCurId(),this.curdata.lyh_id]))))},e.prototype.SetTimeLab=function(){this.timelab.visible=this.lefttime>0,this.red.visible=this.lefttime<=0&&this.curdata.lyh_id<=LyhProxy.ins().getCurId(),this.lefttime>0?(this.btn.label="稍后领取",this.timelab.textFlow=UtilProxy.StrFormart("|C:7&免费领取倒计时：@0 |",[UtilProxy.getTimeHMSString(this.lefttime)]),this.lefttime=this.lefttime-1):(this.btn.label="领取奖励",TimerManager.ins().remove(this.SetTimeLab,this))},e}(BaseEuiView);__reflect(OnlineGiftView.prototype,"OnlineGiftView"),ViewManager.ins().reg(OnlineGiftView,LayerManager.UI_Open),window.OnlineGiftView=OnlineGiftView;var LoadingScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseScene);__reflect(LoadingScene.prototype,"LoadingScene");var PlatFormID=function(){function t(){}return t.QQ_BROWSER="2000001",t.WAN_BA="2000002",t.ZHI_SHANG="2000003",t.FENG_KUANG="2000004",t.AI_WEI_YOU="2000005",t.GE_TUI="2000006",t.XIN_LANG="2000007",t.$9G="2000012",t.QUN_HEI="2000013",t.$1758="2000014",t}();__reflect(PlatFormID.prototype,"PlatFormID");var RoleCC=function(t){function e(){var e=t.call(this)||this;return e.errorCode=[],e.sysId=PackageID.Login,e.regNetMsg(1,e.doCheckAccount),e.regNetMsg(2,e.doCreateRole),e.regNetMsg(4,e.doRoleList),e.regNetMsg(5,e.doEnterGame),e.regNetMsg(6,e.doRandomName),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.connectServer=function(t){if(LocationProperty.srvdata&&(4==LocationProperty.srvdata.state||5==LocationProperty.srvdata.state)){if(4==LocationProperty.srvdata.state)return void TipsControl.ins().showTips("服务器维护中");if(5==LocationProperty.srvdata.state&&LocationProperty.srvdata.CD>0){var e=Number(LocationProperty.srvdata.CD)-Math.floor((egret.getTimer()-SdkManager.ins().getServerTime)/1e3);if(e>0){var i=Number(SdkManager.ins().server_list.body.server_time)+Number(LocationProperty.srvdata.CD),n=new Date;return n.setTime(1e3*i),void TipsControl.ins().showTips("服务器开启时间："+n.toLocaleString())}SdkManager.ins().SetServrtState(LocationProperty.srvdata.server_id,3)}}return SdkManager.isUseSdk&&!SdkManager.ins().has_get_serverlist?void TipsControl.ins().showTips("服务器列表尚未初始化"):""==t?void TipsControl.ins().showTips("帐号不能为空!"):LocationProperty.srvid<=0?void TipsControl.ins().showTips("选择服务器"):void GameSocket.ins().login(t,LocationProperty.password,LoginProxy.ins().rsid>0?LoginProxy.ins().rsid:LocationProperty.srvid,LocationProperty.serverIP,LocationProperty.serverPort)},e.prototype.doCheckAccount=function(t){var i=t.readUnsignedByte();if(0==i){var n=this.getBytes(4);this.sendToServer(n)}else alert("connect failed:"+e.LONGIN_ERROR_CODE[i])},e.prototype.sendCreateRole=function(t,e,i,n,o,s){var r=this.getBytes(2);r.writeString(t),r.writeByte(e),r.writeByte(i),r.writeByte(n),r.writeByte(o),r.writeString(LocationProperty.appid),this.sendToServer(r)},e.prototype.doCreateRole=function(t){var e=t.readInt(),i=t.readByte();0==i?this.sendEnterGame(e):this.showErrorTips(i)},e.prototype.doRoleList=function(t){var e=(t.readInt(),t.readByte());if(0>e)return void TipsControl.ins().showTips(this.errorCode[Math.abs(e)]);if(0==e)return void SceneManager.ins().runScene(CreateRoleScene);for(var i=[],n=0;e>n;n++){var o=new SelectRoleData;o.parser(t),i.push(o)}return 1==e?void this.sendEnterGame(i[0].id):void 0},e.prototype.sendEnterGame=function(t){var e=this.getBytes(5);e.writeInt(t),e.writeString(LocationProperty.appid),this.sendToServer(e)},e.prototype.doEnterGame=function(t){var e=t.readUnsignedByte();return e?void alert("进入游戏错误码:"+e):(CommonUtils.log("进入游戏成功"),SceneManager.ins().runScene(MainScene),void EntityManager.ins().removeAll(!0))},e.prototype.sendRandomName=function(t){var e=this.getBytes(6);e.writeByte(t),this.sendToServer(e)},e.prototype.doRandomName=function(t){var e=t.readUnsignedByte();if(0==e){var i=(t.readUnsignedByte(),t.readString());this.setName(i)}},e.prototype.setName=function(t){this.createRoleView.setName(t)},Object.defineProperty(e.prototype,"createRoleView",{get:function(){return ViewManager.ins().getView(CreateCharView)},enumerable:!0,configurable:!0}),e.prototype.showErrorTips=function(t){0!=t&&TipsControl.ins().showTips(this.errorCode[Math.abs(t)])},e.LONGIN_ERROR_CODE=[],e}(BaseSystem);__reflect(RoleCC.prototype,"RoleCC");var WanbaLoading=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.bg=new eui.Image,this.bg.source=RES.getRes("wbbg_jpg"),this.addChildAt(this.bg,0),this.progress=new eui.Image,this.progress.width=.1,this.progress.source=RES.getRes("wbProgress_png"),this.progress.scale9Grid=new egret.Rectangle(5,2,3,1),this.progress.x=110,this.progress.y=583,this.addChild(this.progress),this.icon=new eui.Image,this.icon.source=RES.getRes("wbIcon_png"),this.icon.anchorOffsetX=10,this.icon.anchorOffsetY=11,this.icon.x=this.progress.x+this.progress.width,this.icon.y=this.progress.y+(this.progress.height>>1),this.addChild(this.icon)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];egret.startTick(this.iconRotation,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];egret.stopTick(this.iconRotation,this)},e.prototype.iconRotation=function(t){return this.icon.rotation+=5,!1},e.prototype.setProgress=function(t,e){var i=t/e;this.progress.width=257*i,this.icon.x=this.progress.x+this.progress.width,this.icon.y=this.progress.y+(this.progress.height>>1)},e}(LoadingViewBase);__reflect(WanbaLoading.prototype,"WanbaLoading"),window.WanbaLoading=WanbaLoading;var PrivilegeGiftView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PrivilegeGiftSkin";for(var e=GlobalConfig.getSpecial_rights_base_dataConfig(1),i="",n=0;n<e.extra_specaial.length;n++){var o=GlobalConfig.getSpecial_rightsConfig(e.extra_specaial[n]);i=""==i?o.name:i+" + "+o.name}this.titlelab0.textFlow=UtilProxy.StrFormart("|C:7&U&@0 |",[i]),this.titlelab.textFlow=UtilProxy.generateTextFlow("|C:10&特权大礼包|"),this.tipslab.textFlow=UtilProxy.generateTextFlow("|C:10&特权卡充值计算vip经验和充值活动积分|"),this.awradlist.itemRenderer=ItemCell,this.ShowEffect(59,this.effect1),this.ShowEffect(92,this.effect0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onbtnClick),this.addTouchEvent(this.titlelab0,this.onbtnClick),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepActivityGetExtraAward,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepActivityGetBigAward,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onbtnClick),this.removeTouchEvent(this.titlelab0,this.onbtnClick),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepActivityGetExtraAward,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepActivityGetBigAward,this.ShowInfo),egret.Tween.removeTweens(this.model)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){if(t.currentTarget==this.titlelab0)return void ViewManager.ins().open(PrivilegeView);if(0==PrivilegeProxy.ins().special_big_award){var e=GlobalConfig.getMisc_dataConfig(1).special_recharge[3],i=GlobalConfig.getRechargeBagConfig(e);if(i){var n={app_subject:i.name,order_amt:100*i.amount,data:i};SdkManager.isUseSdk?SdkManager.ins().commitPay(n):TipsControl.ins().showTips("没有SDK")}}else{if(PrivilegeProxy.ins().IsExtraAwardGet())return void TipsControl.ins().showTips("奖励已领取");PrivilegeProxy.ins().C2SReqActivityGetBigAward()}},e.prototype.ShowInfo=function(){var t=GlobalConfig.getMisc_dataConfig(1).special_recharge[3],e=GlobalConfig.getRechargeBagConfig(t),i="128元";e&&(i=e.amount+"元"),0==PrivilegeProxy.ins().special_big_award?this.btn.label=i:this.btn.label="可领取";var n=PrivilegeProxy.ins().IsExtraAwardGet();this.hasget.visible=n,this.btn.visible=!n,this.e_lab.visible=this.btn.visible,this.e_pic.visible=this.btn.visible;var o=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.ZHIZUN);this.zhanValue.text=o.show_fight.toString(),this.array||(this.array=new eui.ArrayCollection,this.awradlist.dataProvider=this.array);var s=GlobalConfig.getSpecial_rights_base_dataConfig(1);this.array.removeAll();for(var r=0;r<s.extra_award.length;r++){var a=UtilProxy.GetItemCellData(s.extra_award[r][0],s.extra_award[r][1]);this.array.addItem(a)}if(this.model.visible){var h=this.model.y,l=this.model.y+15;egret.Tween.get(this.model,{loop:!0}).to({y:l},500).to({y:h},500)}this.endtime=PrivilegeProxy.ins().GetExtraAwardEndTime(),this.SetTimeLab(),TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)},e.prototype.SetTimeLab=function(){var t=this.endtime-GameLogic.ins().getServerTime();t>0?this.timelab.textFlow=UtilProxy.StrFormart("|C:7&倒计时：@0 |",[DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5)]):(this.timelab.text="",TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.ShowEffect=function(t,e){e.removeChildren(),UtilProxy.GetMovieClipById(t,e)},e}(BaseEuiView);__reflect(PrivilegeGiftView.prototype,"PrivilegeGiftView"),ViewManager.ins().reg(PrivilegeGiftView,LayerManager.UI_Main2),window.PrivilegeGiftView=PrivilegeGiftView;var PrivilegeSkillTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="HuoBanSkillUseTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scrollerview.viewport=this.group_info,this.group_2.visible=!1,this.use.visible=!1,this.num.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.skillcf=t[0],this.addTouchEvent(this.closebtn,this.onClickClose),this.show()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onClickClose=function(){ViewManager.ins().close(this)},e.prototype.show=function(){this.skillItem.icon.source=this.skillcf.icon,this.skillItem.black.visible=!1,this.skillItem.red.visible=!1,this.skillItem.learn.visible=!1,this.skillItem.touchEnabled=!1,this.nameLab.text=this.skillcf.name,this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&当前效果：|"),this.info_1.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[7,this.skillcf.remark]),this.label_1.textFlow=UtilProxy.StrFormart("|战力: @0 |",[this.skillcf?UtilProxy.GetAttrFight(this.skillcf):0])},e}(BaseEuiView);__reflect(PrivilegeSkillTips.prototype,"PrivilegeSkillTips"),ViewManager.ins().reg(PrivilegeSkillTips,LayerManager.UI_Main2),window.PrivilegeSkillTips=PrivilegeSkillTips;var PrivilegeView=function(t){function e(){var e=t.call(this)||this;return e.typelist=[PrivilegeType.ZHOUKA,PrivilegeType.BOJIN,PrivilegeType.ZHIZUN],e.infopics=["tequanka_zhoukameishuzi.png","tequanka_bojinkameishuzi.png","tequanka_zhizunkameishuzi.png"],e.effectlist=[110,112,111],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PrivilegeSkin",this.btns=[this.btn1,this.btn2,this.btn3];var e=GlobalConfig.getSpecial_rights_base_dataConfig(1),i=GlobalConfig.getSpecial_rightsConfig(e.exp_bead_special_id);this.tipslab.textFlow=UtilProxy.StrFormart("|C:8&激活@0 可激活|",[i.name]),this.tipstitle.textFlow=UtilProxy.generateTextFlow("|C:10&已累计|"),this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&特权卡充值计算vip经验和充值活动积分|"),this.ShowEffect(115,this.expeff0),this.ShowEffect(116,this.expeff1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.closebtn0,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.lastbtn,this.onlastnextClick),this.addTouchEvent(this.nextbtn,this.onlastnextClick),this.addTouchEvent(this.expbtn,this.onExpBtnClick),this.addTouchEvent(this.tipsbtn0,this.onExpBtnClick),this.addTouchEvent(this.tipsbtn1,this.onExpBtnClick),this.addTouchEvent(this.closetips,this.onExpBtnClick),this.addTouchEvent(this.tips,this.ontipsClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onSelectClick),this.btns[i].getChildAt(4).visible=PrivilegeProxy.ins().getTypeRed(this.typelist[i]);EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialReward,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepActivityGetExpBead,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepActivityGetExpBead,this.ShowExpTips),this.exptips.visible=!1,t[0]&&this.btns[t[0]]?this.curbtn=this.btns[t[0]]:this.curbtn=this.btns[0],this.curbtn.getChildAt(3).visible=!0,this.ShowInfo(),PrivilegeProxy.ins().C2SReqActivitySpecialRightsData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.closebtn0,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.lastbtn,this.onlastnextClick),this.removeTouchEvent(this.nextbtn,this.onlastnextClick),this.removeTouchEvent(this.expbtn,this.onExpBtnClick),this.removeTouchEvent(this.tipsbtn0,this.onExpBtnClick),this.removeTouchEvent(this.tipsbtn1,this.onExpBtnClick),this.removeTouchEvent(this.closetips,this.onExpBtnClick),this.removeTouchEvent(this.skillbtn,this.onSkillBtnClick),this.removeTouchEvent(this.tips,this.ontipsClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onSelectClick);EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialReward,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepActivityGetExpBead,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepActivityGetExpBead,this.ShowExpTips),this.curbtn&&(this.curbtn.getChildAt(3).visible=!1)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ontipsClick=function(t){PrivilegeProxy.ins().IsExtraAwardOpen()&&(ViewManager.ins().close(this),ViewManager.ins().open(PrivilegeGiftView))},e.prototype.onlastnextClick=function(t){this.exptips.visible=!1;var e=this.btns.indexOf(this.curbtn);t.currentTarget==this.lastbtn&&e>0?e-=1:t.currentTarget==this.nextbtn&&e<this.btns.length-1&&(e+=1),this.curbtn&&(this.curbtn.getChildAt(3).visible=!1),this.curbtn=this.btns[e],this.curbtn.getChildAt(3).visible=!0,this.ShowInfo()},e.prototype.onSelectClick=function(t){this.exptips.visible=!1,this.curbtn&&(this.curbtn.getChildAt(3).visible=!1),this.curbtn=t.currentTarget,this.curbtn.getChildAt(3).visible=!0,this.ShowInfo()},e.prototype.onBtnClick=function(t){var e=this.btns.indexOf(this.curbtn),i=PrivilegeProxy.ins().getPrivilegeState(this.typelist[e]);if(2==i)TipsControl.ins().showTips("今日奖励已领取");else if(1==i)PrivilegeProxy.ins().C2SReqActivitySpecialReward(this.typelist[e]);else{var n=GlobalConfig.getMisc_dataConfig(1).special_recharge[e],o=GlobalConfig.getRechargeBagConfig(n);if(o){var s={app_subject:o.name,order_amt:100*o.amount,data:o};SdkManager.isUseSdk?SdkManager.ins().commitPay(s):TipsControl.ins().showTips("没有SDK")}}},e.prototype.onSkillBtnClick=function(t){var e=this.btns.indexOf(this.curbtn),i=this,n=function(){var t,n=1;do t=GlobalConfig.getSpecial_rights_skill_dataConfig(n++);while(void 0!=t&&t.special_id!=i.typelist[e]);return t}();ViewManager.ins().open(PrivilegeSkillTips,n)},e.prototype.onExpBtnClick=function(t){switch(t.currentTarget){case this.expbtn:this.exptips.visible=!this.exptips.visible,this.exptips.visible&&this.ShowExpTips();break;case this.tipsbtn0:this.GetExp(1);break;case this.tipsbtn1:this.GetExp(2);break;case this.closetips:this.exptips.visible=!1}},e.prototype.GetExp=function(t){var e=GlobalConfig.getSpecial_rights_base_dataConfig(1);if(PrivilegeProxy.ins().exp_bead<e.exp_bead_limit)return void TipsControl.ins().showTips("储存经验未满");if(PrivilegeProxy.ins().exp_bead_times>=e.exp_bead_times)return void TipsControl.ins().showTips("领取次数已满");if(t>1){var i=BagProxy.ins().getItemCountById(e.mul_exp_money[0]);if(i<e.mul_exp_money[1])return void TipsControl.ins().showTips(BagProxy.ins().getItemName(e.mul_exp_money[0])+"不足")}if(t>1){var n=UtilProxy.getStr("是否花费|C:7&@0 @1 |领取",[e.mul_exp_money[1],BagProxy.ins().getItemName(e.mul_exp_money[0])]);TipsControl.ins().ShowTips1(n,void 0,function(){PrivilegeProxy.ins().C2SReqActivityGetExpBead(t>1)})}else PrivilegeProxy.ins().C2SReqActivityGetExpBead(t>1)},e.prototype.ShowInfo=function(){var t=this.btns.indexOf(this.curbtn);this.curbtn.getChildAt(4).visible=PrivilegeProxy.ins().getTypeRed(this.typelist[t]);var e=GlobalConfig.getSpecial_rightsConfig(this.typelist[t]),i=PrivilegeProxy.ins().getPrivilegeState(this.typelist[t]),n=GlobalConfig.getSpecial_rights_base_dataConfig(1),o=this,s=function(){var e,i=1;do e=GlobalConfig.getSpecial_rights_skill_dataConfig(i++);while(void 0!=e&&e.special_id!=o.typelist[t]);return e}();if(this.namepic.source="tequanka_meizhuzi_0"+(t+1),this.bg.source="resource/skins/Privilege/tequanka_bg_0"+(t+1)+".jpg",this.icon.source="resource/skins/Privilege/tequanka_icon_0"+(t+1)+".png",this.infopic.source="resource/skins/Privilege/"+this.infopics[t],this.lastbtn.visible=0!=t,this.nextbtn.visible=t<this.btns.length-1,this.skillbtn.visible=void 0!=s,this.expbtn.visible=this.typelist[t]==n.exp_bead_special_id,this.expeff0.visible=this.expbtn.visible,this.expeff1.visible=this.expbtn.visible,this.expbtn.visible){var r=PrivilegeProxy.ins().exp_bead>0?Math.floor(PrivilegeProxy.ins().exp_bead/n.exp_bead_limit*100):0;this.explab.textFlow=UtilProxy.StrFormart("|C:7&@0 %|",[r]),this.expmask.height=Math.floor(63*(1-PrivilegeProxy.ins().exp_bead/n.exp_bead_limit))}this.timelab.text=e.days>0?e.days+"天":"永久",this.moneylab.text=e.present_count.toString();var a=GlobalConfig.getMisc_dataConfig(1).special_recharge[t],h=GlobalConfig.getRechargeBagConfig(a),l="";h&&(l=h.amount+"元抢购"),s&&(this.removeTouchEvent(this.skillbtn,this.onSkillBtnClick),this.skillIcon.source=s.icon,UtilProxy.SetAshColor(this.skillIcon,0==i),this.skillTip.visible=0==i,0!=i&&this.addTouchEvent(this.skillbtn,this.onSkillBtnClick)),this.btn.label=0==i?l:1==i?"领取元宝":"已领取",this.red.visible=1==i,0!=i&&(this.SetTimeLab(),TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)),this.ShowEffect(this.effectlist[t],this.effobj),UtilProxy.GetMovieClipById(109,this.effobj)},e.prototype.SetInfos=function(){for(var t=this.btns.indexOf(this.curbtn),e=GlobalConfig.getSpecial_rightsConfig(this.typelist[t]),i=e.desc.split("\n"),n=0;n<this.infos.numChildren;n++){var o=this.infos.getChildAt(n);if(o.visible=i[n]&&""!=i[n],o.includeInLayout=i[n]&&""!=i[n],i[n]&&""!=i[n]){var s=o.getChildAt(1);s.textFlow=UtilProxy.generateTextFlow(i[n])}}},e.prototype.SetTimeLab=function(){},e.prototype.ShowExpTips=function(){var t=GlobalConfig.getSpecial_rights_base_dataConfig(1);this.tipsinfo.textFlow=UtilProxy.StrFormart("|C:7&@0 |点经验\n最多存储|C:7&@1 |经验",[PrivilegeProxy.ins().exp_bead,UtilProxy.getSimpleNum(t.exp_bead_limit)]),this.tipslab.visible=0==PrivilegeProxy.ins().getPrivilegeState(t.exp_bead_special_id),this.tipsbtn0.visible=0!=PrivilegeProxy.ins().getPrivilegeState(t.exp_bead_special_id),this.tipsbtn1.visible=0!=PrivilegeProxy.ins().getPrivilegeState(t.exp_bead_special_id)},e.prototype.ShowEffect=function(t,e){e.removeChildren(),UtilProxy.GetMovieClipById(t,e)},e}(BaseEuiView);__reflect(PrivilegeView.prototype,"PrivilegeView"),ViewManager.ins().reg(PrivilegeView,LayerManager.UI_Main),window.PrivilegeView=PrivilegeView;
var ProgressEx=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setThumb=function(t){void 0!=this.thumb&&(this.thumb.source=t)},e}(eui.ProgressBar);__reflect(ProgressEx.prototype,"ProgressEx"),window.ProgressEx=ProgressEx;var ContItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="ContItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.btn.source=t.pic;var e=GlobalConfig.getRank_typeConfig(t.type_id).type;this.namelab1.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[RoleProxy.ins().getRoleName()]),this.valuelab1.text=RankProxy.ins().getMyFightByType(e).toString();var i=RankProxy.ins().getRankTopByType(e);this.namelab2.textFlow=UtilProxy.StrFormart("@0 第一：|C:10&@1 |",[GlobalConfig.getRank_typeConfig(t.type_id).name,i?i.name:""]);var n=i?i.value:0;this.valuelab2.text=n.toString(),this.bar1.maximum=n,this.bar1.value=RankProxy.ins().getMyFightByType(e),this.bar2.maximum=n,this.bar2.value=n},e.prototype.onClick=function(t){var e=this.data,i=GlobalConfig.getTplViewConfig(e.view_id);i&&ViewManager.ins().open(i.tsScript),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(ContItem.prototype,"ContItem"),window.ContItem=ContItem;var ContView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ContViewSkin",this.list.itemRenderer=ContItem,this.sv.viewport=this.list,this.title.textFlow=UtilProxy.generateTextFlow("|C:10&战力对比|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=[],e=GlobalConfig.getRankContList();for(var i in e)t.push(e[i]);this.list.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(ContView.prototype,"ContView"),ViewManager.ins().reg(ContView,LayerManager.UI_Main),window.ContView=ContView;var RankBtn=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.pic.source="common_btn_big_yellow_off"},e.prototype.setSkinName=function(){this.skinName="RankBtnItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.title.text=t.name},e.prototype.SetBtnState=function(t){this.pic.source=t?"common_btn_big_yellow":"common_btn_big_yellow_off"},e}(BaseItemRender);__reflect(RankBtn.prototype,"RankBtn"),window.RankBtn=RankBtn;var RankItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="RankItemSkin"},e.prototype.dataChanged=function(){if(0!=RankProxy.ins().CurType){this.vippic.visible=!UtilProxy.shield,this.vip.visible=!UtilProxy.shield;var t=this.data;this.rankpic.visible=t.index<=3,this.rankpic.visible&&(this.rankpic.source="top_icon_0"+t.index),this.rank.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.index>3?t.index:""]),this.tips.visible=0==t.role_id,this.myinfo.visible=t.role_id>0,this.lab1.textFlow=UtilProxy.StrFormart("|C:10&昵称：@0 |",[t.name]),t.vip>18?(this.vip.text=(t.vip-18).toString(),this.vippic.source="common_icon_VIP02"):(this.vip.text=t.vip.toString(),this.vippic.source="common_icon_VIP");var e=GlobalConfig.getSetup_head_dataConfig(t.use_head_id);this.icon.source=e?e.icon:"common_touxiang_0"+t.prof;var i=GlobalConfig.getSetup_head_frame_dataConfig(t.use_head_frame_id);this.bg.source=i?i.icon:"shezhi_touxiangkuang_01",this.lab2.text=13==RankProxy.ins().CurType?UtilProxy.getStr("战力：@0 ",[UtilProxy.getFightNumLab(t.fight)]):UtilProxy.getStr("等级：@0 ",[t.level]);var n=GlobalConfig.getRank_typeConfig(RankProxy.ins().CurType).labstr;this.lab3.text=UtilProxy.getStr("@0 ：@1 ",[1!=RankProxy.ins().CurType?n:"战力",1!=RankProxy.ins().CurType?13==RankProxy.ins().CurType?CopyProxy.ins().getSYTFloorBySceneId(t.value):UtilProxy.getFightNumLab(t.value):UtilProxy.getFightNumLab(t.fight)])}},e}(BaseItemRender);__reflect(RankItem.prototype,"RankItem"),window.RankItem=RankItem;var RankView=function(t){function e(){var e=t.call(this)||this;return e.curpage=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RankViewSkin",this.comview.initUI(),this.comview.SetName("title_paihangbang"),this.elist.itemRenderer=ItemCell,this.btnlist.itemRenderer=RankBtn,this.ranklist.itemRenderer=RankItem,this.ranksv.viewport=this.ranklist,this.btnsv.viewport=this.btnlist,this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&每日0点发放称号|"),this.btnlist.dataProvider=new eui.ArrayCollection(RankProxy.ins().getRankTypeList()),this.btnlist.validateNow()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onbtnClick),this.btnlist.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onBtnItemTap,this),EventProxy.AddListener(this,EventType.S2CRepMiscOtherInfo,this.ShowTopInfo),EventProxy.AddListener(this,EventType.S2CRepRankGetRanksRole,this.ShowInfo),RankProxy.ins().getAllRankInfo(),t&&t[0]?this.curpage=t[0]:this.curpage=0,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onbtnClick),this.btnlist.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onBtnItemTap,this),EventProxy.RemoveListener(this,EventType.S2CRepMiscOtherInfo,this.ShowTopInfo),EventProxy.RemoveListener(this,EventType.S2CRepRankGetRanksRole,this.ShowInfo),this.curSelcetBtn&&this.curSelcetBtn.SetBtnState(!1)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){ViewManager.ins().open(ContView)},e.prototype.onBtnItemTap=function(t){this.curSelcetBtn&&this.curSelcetBtn.SetBtnState(!1),this.curSelcetBtn=t.itemRenderer,this.curSelcetBtn.SetBtnState(!0);var e=t.item;e&&(RankProxy.ins().CurType=e.type),this.ShowInfo()},e.prototype.ShowInfo=function(){void 0==this.curSelcetBtn&&(this.curSelcetBtn=this.btnlist.getVirtualElementAt(this.curpage),this.curSelcetBtn.SetBtnState(!0),RankProxy.ins().CurType=this.curSelcetBtn.data.type);var t=RankProxy.ins().getRankTopByType(RankProxy.ins().CurType);this.myinfo.visible=void 0!=t,this.nametips.visible=void 0==t,this.elist.visible=7==RankProxy.ins().CurType,t&&(this.lvlab.text=UtilProxy.getStr("等级：@0   @1 ：@2 ",[t.level,1!=RankProxy.ins().CurType?this.curSelcetBtn.data.labstr:"战力",1!=RankProxy.ins().CurType?13==RankProxy.ins().CurType?CopyProxy.ins().getSYTFloorBySceneId(t.value):UtilProxy.getFightNumLab(t.value):UtilProxy.getFightNumLab(t.fight)])),this.ShowTopInfo(),this.rank_array||(this.rank_array=new eui.ArrayCollection,this.ranklist.dataProvider=this.rank_array);var e=RankProxy.ins().getRanklistByType(RankProxy.ins().CurType);this.rank_array.removeAll();for(var i in e)this.rank_array.addItem(e[i]);this.ranklab.text=UtilProxy.getStr("我的排名：@0 ",[0==RankProxy.ins().getMyRankByType(RankProxy.ins().CurType)?"20+":RankProxy.ins().getMyRankByType(RankProxy.ins().CurType)]),this.lab0.text=UtilProxy.getStr("我的@0 ：@1 ",[this.curSelcetBtn.data.labstr,UtilProxy.getFightNumLab(RankProxy.ins().getMyFightByType(RankProxy.ins().CurType))]);var n=GlobalConfig.getRank_typeConfig(RankProxy.ins().CurType);if(this.chenghao.visible=n.title>0,n.title>0){var o=GlobalConfig.getTitleById(n.title);this.chenghao.source=TitleProxy.title_icon_path+o.title_res+".png"}},e.prototype.ShowTopInfo=function(){this.model.removeChildren();var t=RankProxy.ins().getRankTopByType(RankProxy.ins().CurType);if(this.e_array||(this.e_array=new eui.ArrayCollection,this.elist.dataProvider=this.e_array),void 0!=t){this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.name]),t.vip>18?(this.vip.text=(t.vip-18).toString(),this.vipbg.source="common_icon_VIP02"):(this.vip.text=t.vip.toString(),this.vipbg.source="common_icon_VIP");var e=RankProxy.ins().getOtherRoleInfo(t.role_id),i=t.role_id==RoleProxy.ins().getRoleId();if(void 0==e&&!i)return void RankProxy.ins().C2SReqMiscOtherInfo(t.role_id);var n=i?TitleProxy.ins().reputation_id:e.touxian_level,o=t.faction;if(o&&o>0?this.titlelab.textFlow=UtilProxy.StrFormart("|C:9&【@0 】@1 |",[TitleProxy.ins().getShengWanglvlName(n,o),TitleProxy.ins().getShengwangName(n,o)]):this.titlelab.textFlow=UtilProxy.generateTextFlow("|C:9&暂无宗派|"),this.elist.visible){var s=i?BagProxy.ins().getEquipInfo():this.getEquitList(e.equip_list);this.e_array.removeAll();for(var r in s)this.e_array.addItem(s[r])}var a=t.prof,h=i?GrowupProxy.ins().fashion_wear:e.fashion,l=i?WeaponProxy.ins().getDressId(WeaponType.Weapon):e.shenbing;this.model.addChild(UtilProxy.GetRoleObjectById(h,0,l,void 0,a))}else if(this.elist.visible){var s=this.getEquitList([]);this.e_array.removeAll();for(var r in s)this.e_array.addItem(s[r])}},e.prototype.getEquitList=function(t){for(var e=[],i=0;10>i;i++){var n=new ItemCellData,o={item_slot_idx:t[i]?t[i].item_slot_idx:0,item_type_id:t[i]?t[i].item_type_id:0,item_count:t[i]?t[i].item_count:0};n.setItemCellData(o),e.push(n)}return e},e}(BaseEuiView);__reflect(RankView.prototype,"RankView"),ViewManager.ins().reg(RankView,LayerManager.UI_Main),window.RankView=RankView;var RechargeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RechargeItemSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){void 0!=this.data&&void 0!=this.data.id&&(this.pay_value.text="充值"+this.data.amount+"元",this.yb_value.text=this.data.yuanbao+this.data.present_yb+"元宝",this.icon.source=this.data.pay_icon,this.mutiValue.text=(this.data.yuanbao+this.data.present_yb)/this.data.yuanbao+"倍")},e}(BaseItemRender);__reflect(RechargeItem.prototype,"RechargeItem"),window.RechargeItem=RechargeItem;var RechargeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="RechargeViewSkin",this.list.itemRenderer=RechargeItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData(),this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.privilegeBtn,this.onClick),this.addItemTapEvent(this.list,this.SkinItemClick),EventProxy.Broast(EventType.UpdataMoney,this.UpdataMoney)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeBtn,this.onClick),this.removeTouchEvent(this.privilegeBtn,this.onClick),this.removeItemTapEvent(this.list,this.SkinItemClick),EventProxy.Broast(EventType.UpdataMoney,this.UpdataMoney)},e.prototype.UpdataMoney=function(t){void 0!=t[0]&&t[0]==MoneyAttr.VIP_EXP&&this.setVipInfo()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:ViewManager.ins().close(this);break;case this.privilegeBtn:ViewManager.ins().open(VIPView)}},e.prototype.setData=function(){this.setVipInfo(),GlobalConfig.getConfig("rechargeBag","rechargeBagConfig");var t=[];for(var e in GlobalConfig.ins().rechargeBagConfig)1==GlobalConfig.ins().rechargeBagConfig[e].item_show&&t.push(GlobalConfig.ins().rechargeBagConfig[e]);t.sort(this.sort),this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.sort=function(t,e){return t.amount>e.amount?-1:t.amount<e.amount?1:0},e.prototype.SkinItemClick=function(t){if(t.itemRenderer.data){var e={app_subject:t.itemRenderer.data.name,order_amt:100*t.itemRenderer.data.amount,data:t.itemRenderer.data};SdkManager.isUseSdk?SdkManager.ins().commitPay(e):TipsControl.ins().showTips("没有SDK")}},e.prototype.setVipInfo=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_EXP),i=GlobalConfig.getVip_levelConfig(t+1);if(t>18?(this.vipLvl.text=(t-18).toString(),this.vip.source="main_icon_vip_02"):(this.vipLvl.text=t.toString(),this.vip.source="main_icon_vip"),void 0!=i)this.vipBar.maximum=i.need_yuanbao,this.vipBar.value=e,t+1>18?this.pay_info.textFlow=UtilProxy.generateTextFlow("再充值|C:7&"+(i.need_yuanbao-e)+"元宝|可升级|C:7&SVIP"+(t+1-18)):this.pay_info.textFlow=UtilProxy.generateTextFlow("再充值|C:7&"+(i.need_yuanbao-e)+"元宝|可升级|C:7&VIP"+(t+1));else{var n=GlobalConfig.getVip_levelConfig(t);void 0!=n&&(this.vipBar.maximum=n.need_yuanbao,this.vipBar.value=e),this.pay_info.text=""}},e}(BaseEuiView);__reflect(RechargeView.prototype,"RechargeView"),ViewManager.ins().reg(RechargeView,LayerManager.UI_Main2),window.RechargeView=RechargeView;var RelicItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),eui.Watcher.watch(this,["data"],this.dataChanged,this),eui.Watcher.watch(this,["data","state"],this.dataChanged,this),eui.Binding.bindHandler(this,["selected"],this.selectedV,this)},e.prototype.selectedV=function(){this.sp_select&&(null==this.data?this.sp_select.visible=!1:this.sp_select.visible=this.selected)},e.prototype.dataChanged=function(){this.data&&(this.model=this.data,this.icon.source=this.model.config.zy_sk,this.txt_name.text=this.model.config.sw_name,this.cond.text=this.model.state>0?"":this.model.config.cond_st,this.sp_black.visible=this.model.state<2?!0:!1,this.kjh.visible=1==this.model.state?!0:!1)},e}(BaseItemRender);__reflect(RelicItem.prototype,"RelicItem"),window.RelicItem=RelicItem;var RelicSkillItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),eui.Watcher.watch(this,["data","stateSkill"],this.dataChanged,this)},e.prototype.dataChanged=function(){this.data&&(this.model=this.data,0==this.model.stateSkill?(this.sp_black.visible=!0,this.cond.text=this.model.config.jie_open,this.red.visible=!1):1==this.model.stateSkill?(this.sp_black.visible=this.red.visible=!0,this.cond.text=""):(this.sp_black.visible=this.red.visible=!1,this.cond.text=""),this.icon.source=this.model.config.icon_img,this.namelb.text=this.model.config.name)},e}(BaseItemRender);__reflect(RelicSkillItem.prototype,"RelicSkillItem"),window.RelicSkillItem=RelicSkillItem;var RelicThreeItem=function(t){function e(){var e=t.call(this)||this;return e.nowCount=0,e.pics=[],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this,this.onClick),EventProxy.AddListener(this,EventType.RefreshRelicItem,this.updateBag),this.pics=[this.pic0,this.pic1,this.pic2,this.pic3,this.pic4]},e.prototype.updateBag=function(){this.lbTask.visible&&"接取任务解锁"!=this.lbTask.text&&(this.lbTask.text=RelicProxy.ins().getTaskText(this.model.id))},e.prototype.buyTips=function(){var t=GlobalConfig.getShengwu_soul_dataById(1);if(t){var e=t.money[0],i=t.money[1],n="是否花费|C:7&"+i+LeitaiProxy.ins().getModelType(e)+"|激活器灵";ViewManager.ins().open(BuyTipsView,n,this.onEnterBtn,this)}},e.prototype.onEnterBtn=function(){RelicProxy.ins().C2SReqShengwuActiveSoul(2,this.model.id)},e.prototype.onClick=function(t){switch(t.target){case this.task:RelicProxy.ins().C2SReqShengwuGetSoulTask(this.model.id);break;case this.money:RelicProxy.ins().getCanJh(this.model.id)?this.buyTips():TipsControl.ins().showTips("元宝不足!")}},e.prototype.setSkinName=function(){this.skinName="RelicThreeCell"},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),eui.Watcher.watch(this,["data","SoulState"],this.dataChanged,this),eui.Watcher.watch(this,["data","exp"],this.dataChanged,this),eui.Watcher.watch(this,["data","star"],this.dataChanged,this),eui.Watcher.watch(this,["data"],this.dataChanged,this)},e.prototype.dataChanged=function(){if(this.data)if(this.model=this.data,this.img.source=this.model.soulConfig.icon,1==this.model.stateZt)if(this.qz_lb.visible=!1,this.suo.visible=this.group_com.visible=!0,this.starGroup.visible=this.bar.visible=!1,0==this.model.SoulState){this.lbTask.text="接取任务解锁",this.add_zl.text="激活战力+"+this.model.soulConfig.add_zl;var t=GlobalConfig.getShengwu_soul_dataById(this.model.id);t&&(this.moneyLb.text=t.money[1])}else if(1==this.model.SoulState){this.add_zl.text="激活战力+"+this.model.soulConfig.add_zl;var e=0,i=0,t=GlobalConfig.getShengwu_soul_dataById(this.model.id);t&&(e=RelicProxy.ins().getCountByBagById(t.items[0]),i=Number(t.items[1]),this.lbTask.text="材料："+e+"/"+i,this.moneyLb.text=t.money[1]),e>=i&&RelicProxy.ins().C2SReqShengwuActiveSoul(1,this.model.id)}else{this.suo.visible=this.group_com.visible=!1,this.add_zl.text=this.model.soulConfig.ql_name+RelicProxy.ins().getStarJie(this.model.star)+"阶",this.starGroup.visible=this.bar.visible=!0;var n=GlobalConfig.getShengwu_exp_dataById(this.model.star+1);if(n){this.bar.maximum=n.exp,this.bar.value=this.model.exp;for(var o=0;o<this.pics.length;o++){var e=this.model.star%this.pics.length;0==e&&e>0||e>o?this.pics[o].source=n.pic:this.pics[o].source=n.pic_di}}else this.starGroup.visible=this.bar.visible=!1}else this.starGroup.visible=this.bar.visible=!1,this.add_zl.text="激活战力+"+this.model.soulConfig.add_zl,this.group_com.visible=!1,this.qz_lb.visible=!0},e}(BaseItemRender);__reflect(RelicThreeItem.prototype,"RelicThreeItem"),window.RelicThreeItem=RelicThreeItem;var RelicView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RelicSkinXml",this.comview.initUI(),this.comview.SetName("title_shengqi")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.GroupList=[0,1,2],this.addItemTapEvent(this.itemList,this.onListItemTap),this.addItemTapEvent(this.skillList,this.onskillListTap),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this),EventProxy.AddListener(this,EventType.nextModelData,this.nextModel),EventProxy.AddListener(this,EventType.updateList,this.updateList),EventProxy.AddListener(this,EventType.updateFight,this.updateFightThree),eui.Binding.bindHandler(RelicProxy.ins(),["step"],this.showView,this),eui.Binding.bindHandler(RelicProxy.ins(),["fightNum"],this.updateFight,this),EventProxy.AddListener(this,EventType.RefreshRelicItemByBag,this.updateLbByBag)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeItemTapEvent(this.itemList,this.onListItemTap),this.removeItemTapEvent(this.skillList,this.onskillListTap),EventProxy.RemoveListener(this,EventType.updateFight,this.updateFightThree),EventProxy.RemoveListener(this,EventType.nextModelData,this.nextModel),EventProxy.RemoveListener(this,EventType.updateList,this.updateList),EventProxy.RemoveListener(this,EventType.RefreshRelicItemByBag,this.updateLbByBag)},e.prototype.updateFightThree=function(){this.relicViewThree&&this.relicViewThree.getThisAllFightNum()},e.prototype.updateLbByBag=function(){this.relicViewThree&&this.relicViewThree.updateLbForBag()},e.prototype.onskillListTap=function(t){this.relicViewThree&&this.relicViewThree.onClickItem(t)},e.prototype.updateFight=function(){this.relicViewOne&&this.relicViewOne.fight()},e.prototype.nextModel=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.relicViewThree&&this.relicViewThree.updateView(t)},e.prototype.updateList=function(){this.relicViewThree&&(this.relicViewThree.setAttrAll(),this.relicViewThree.getThisAllFightNum())},e.prototype.onListItemTap=function(t){this.relicViewOne&&this.relicViewOne.eventRelicByView(t)},e.prototype.showView=function(t){switch(t){case 0:null==this.relicViewOne&&(this.relicViewOne=new RelicViewOne(this)),this.relicViewOne.showAll();break;case 1:null==this.relicViewTwo&&(this.relicViewTwo=new RelicViewTwo(this)),this.relicViewTwo.showAll();break;case 2:null==this.relicViewThree&&(this.relicViewThree=new RelicViewThree(this)),this.relicViewThree.showAll()}for(var e=0;e<this.GroupList.length;e++)this["group"+e].visible=e==t},e.prototype.onClickEvent=function(t){switch(t.target){case this.closeBtn:ViewManager.ins().close(this);break;case this.VIPbtn:this.relicViewOne&&this.relicViewOne.onClickEvtone(t);break;case this.rhBtn:RelicProxy.ins().CanCombine()?RelicProxy.ins().C2SReqShengwuCombine():TipsControl.ins().showTips("元宝不足!");case this.upone:case this.upten:this.relicViewThree&&this.relicViewThree.onClickEvt(t)}},e}(BaseEuiView);__reflect(RelicView.prototype,"RelicView"),ViewManager.ins().reg(RelicView,LayerManager.UI_Main),window.RelicView=RelicView;var RelicViewOne=function(){function t(t){this.rel=t}return t.prototype.showAll=function(){this.rel&&(this.dataModel||(this.config=GlobalConfig.getShengwu_items_dataById(1)),this.showList(),this.update())},t.prototype.update=function(){this.showAttr(),this.showNameAndJie(),this.showEffected()},t.prototype.fight=function(){this.rel.txt_fight0.text=RelicProxy.ins().getFightNum()+""},t.prototype.eventRelicByView=function(t){var e=t.itemRenderer;e&&(this.dataModel=e.data,this.arr_Rel.itemUpdated(this.dataModel),this.config=this.dataModel.config,this.update())},t.prototype.showAttr=function(){for(var t=AttrProxy.getAttrInfo(this.config),e=0;e<t.length;e++)for(var i=0;i<t.length;i++)this.rel["name"+i].text=t[i][0],this.rel["atr"+i].text="+"+t[i][1]},t.prototype.showNameAndJie=function(){this.rel.jieName.text=this.config.sw_name},t.prototype.onClickEvtone=function(t){1==this.dataModel.state&&RelicProxy.ins().C2SReqShengwuUnlock(this.dataModel.id)},t.prototype.showList=function(){this.rel.itemList.itemRenderer=RelicItem,this.arr_Rel||(this.arr_Rel=new eui.ArrayCollection,this.rel.itemList.dataProvider=this.arr_Rel),this.arr_Rel.replaceAll(RelicProxy.ins().setState())},t.prototype.showEffected=function(){this.mc&&this.rel.effect.removeChild(this.mc),this.mc=new egret.MovieClip;var t=UtilProxy.getShowImgPath()+"/shengqi/"+this.config.effect_id;UtilProxy.GetMovieClip(t,this.mc,-1,void 0),this.rel.effect.addChild(this.mc)},t}();__reflect(RelicViewOne.prototype,"RelicViewOne");var RelicViewThree=function(){function t(t){this.Max=4,this.rel=t}return t.prototype.updateView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&t[0].length>0&&(this.rel["view"+t[0][0]].data=t[0][1]),this.needUpdate()},t.prototype.showAll=function(){this.rel&&(RelicProxy.ins().setState(),this.update(),this.setAttrAll(),this.showList(),this.updateLbForBag(),this.getThisAllFightNum())},t.prototype.showList=function(){this.rel.skillList.itemRenderer=RelicSkillItem,this.arr_RelT||(this.arr_RelT=new eui.ArrayCollection,this.rel.skillList.dataProvider=this.arr_RelT),this.arr_RelT.replaceAll(RelicProxy.ins().initSkillList())},t.prototype.needUpdate=function(){this.openSuo()},t.prototype.getThisAllFightNum=function(){this.rel.txt_fight1.text=RelicProxy.ins().getThreeAllFight()+""},t.prototype.setAttrAll=function(){if(RelicProxy.ins().getOPenOne()){var t=RelicProxy.ins().getNowRelicAttr(),e=AttrProxy.getAttrInfo(t);if(e&&e.length>0)for(var i=0;i<e.length;i++)this.rel["attr"+i].text="+"+e[i][1],this.rel["attrn"+i].text=e[i][0],this.rel["attr"+i].textColor=ColorUtil.GREEN,this.rel["attrn"+i].textColor=ColorUtil.ORANGE}else{var t=GlobalConfig.getShengwu_soul_attr_dataByIdAndnum(1,0),e=AttrProxy.getAttrInfo(t);if(e&&e.length>0)for(var i=0;i<e.length;i++)this.rel["attr"+i].text="+"+e[i][1],this.rel["attrn"+i].text=e[i][0],this.rel["attr"+i].textColor=ColorUtil.HUISE,this.rel["attrn"+i].textColor=ColorUtil.HUISE}this.rel.man.visible=RelicProxy.ins().maxLv(),this.rel.upone.visible=this.rel.upten.visible=!RelicProxy.ins().maxLv(),this.rel.lbOne.visible=this.rel.lbTen.visible=!RelicProxy.ins().maxLv(),this.rel.imgitem.visible=this.rel.imgitem0.visible=!RelicProxy.ins().maxLv()},t.prototype.openSuo=function(){this.rel.suo.visible=!RelicProxy.ins().isJhAllSoul()},t.prototype.update=function(){for(var t=0;t<this.Max;t++)this.rel["view"+t].data=RelicProxy.ins().soulInit()[t];this.openSuo()},t.prototype.updateLbForBag=function(){var t=GlobalConfig.getShengwu_misc_dataById(1);if(t){var e=RelicProxy.ins().getCountByBagById(t.exp_item[0]),i=e;this.rel.lbOne.textColor=i>=1?ColorUtil.GREEN:ColorUtil.RED,this.rel.lbTen.textColor=i>=10?ColorUtil.GREEN:ColorUtil.RED,this.rel.lbOne.text="1/"+i,this.rel.lbTen.text="10/"+i}},t.prototype.onClickItem=function(t){var e=t.itemRenderer;e&&(this.model=e.data,1==this.model.stateSkill&&RelicProxy.ins().C2SReqShengwuActiveSkill(this.model.id))},t.prototype.buyTips=function(t){if(RelicProxy.ins().isTuue)RelicProxy.ins().C2SReqShengwuUpgradeSoul(t);else{var e="您还有器灵未激活，将无法获得最佳提升效果，是否继续？";ViewManager.ins().open(BuyTipsView,e,this.onEnterBtn,"提升",t,this)}},t.prototype.onEnterBtn=function(t){RelicProxy.ins().C2SReqShengwuUpgradeSoul(t)},t.prototype.clickLv=function(t){RelicProxy.ins().maxLv()?TipsControl.ins().showTips("全部已满级!"):RelicProxy.ins().isNoOne()?TipsControl.ins().showTips("激活圣器可以提升!"):RelicProxy.ins().isFour()||RelicProxy.ins().isTuueItem?RelicProxy.ins().C2SReqShengwuUpgradeSoul(t):this.buyTips(t)},t.prototype.onClickEvt=function(t){switch(t.target){case this.rel.upone:this.clickLv(1);break;case this.rel.upten:this.clickLv(10)}},t}();__reflect(RelicViewThree.prototype,"RelicViewThree");var RelicViewTwo=function(){function t(t){this.rel=t}return t.prototype.showAll=function(){this.rel&&(this.showImg(),this.showMoney())},t.prototype.showMoney=function(){this.rel.many.text=RelicProxy.ins().getNeedMoney()+""},t.prototype.showImg=function(){var t=RelicProxy.ins().getRelicImg();if(t&&t.length>0)for(var e=0;e<t.length;e++)this.rel["img"+e].source=t[e],this.rel["twolb"+e].text=RelicProxy.ins().getRelicName()[e]},t}();__reflect(RelicViewTwo.prototype,"RelicViewTwo");var ReviveView=function(t){function e(){var e=t.call(this)||this;return e.times=0,e.target_name="",e.pay_value=0,e.is_end=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ReviveUISkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onClick),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateScoreAward,this.showinfo),this.is_end=!1,this.target_name=t[0]||"",this.showinfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateScoreAward,this.showinfo),TimerManager.ins().removeAll(this)},e.prototype.onClick=function(t){RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)>this.pay_value?void 0!=GameMap.centerEntity&&(SceneControl.ins().C2SReqMiscResurgence(1,GameLogic.ins().getCurSceneId(),GameMap.centerEntity.x,GameMap.centerEntity.y),TimerManager.ins().remove(this.finshtFun,this)):TipsControl.ins().showTips("元宝不足！")},e.prototype.showinfo=function(){if(TimerManager.ins().remove(this.update,this),ZPZBProxy.ins().IsZPZB(GameLogic.ins().getCurSceneId()))this.btn.visible=!1,this.icon.visible=!1,this.pay.visible=!1,this.times=ZPZBProxy.ins().getReliveTime(),this.setTime(),TimerManager.ins().doTimer(1e3,ZPZBProxy.ins().getReliveTime(),this.update,this,this.finshtFun,this);else{this.btn.visible=!0,this.icon.visible=!0,this.pay.visible=!0;var t=GlobalConfig.getMisc_dataConfig(1);this.pay.textFlow=UtilProxy.generateTextFlow(t.revive_yb+"原地复活"),this.times=t.auto_revive_CD,this.pay_value=t.revive_yb,this.setTime(),TimerManager.ins().doTimer(1e3,t.auto_revive_CD,this.update,this,this.finshtFun,this)}TimerManager.ins().remove(this.checkNeedEnd,this),TimerManager.ins().doTimer(5e3,0,this.checkNeedEnd,this)},e.prototype.update=function(){this.times=this.times-1,this.setTime(),GameMap.centerEntity&&!GameMap.centerEntity.isDead&&ViewManager.ins().close(this)},e.prototype.setTime=function(){this.info.textFlow=UtilProxy.generateTextFlow("你被|C:7&"+this.target_name+"|击败\n|C:4&"+Math.max(this.times,0)+"秒|自动复活")},e.prototype.finshtFun=function(){if(void 0!=GameMap.centerEntity){if(ZPZBProxy.ins().IsZPZB(GameLogic.ins().getCurSceneId())){var t=GlobalConfig.getFaction_attack_base_dataConfig(1);FacProxy.ins().getFacId()==ZPZBProxy.ins().defend_faction_id?SceneControl.ins().C2SReqMiscResurgence(0,GameLogic.ins().getCurSceneId(),t.scene_x,t.scene_y):SceneControl.ins().C2SReqMiscResurgence(0,GameLogic.ins().getCurSceneId(),t.scene_xx,t.scene_yy)}else SceneControl.ins().C2SReqMiscResurgence(0,GameLogic.ins().getCurSceneId(),GameMap.centerEntity.x,GameMap.centerEntity.y);this.is_end=!0}},e.prototype.checkNeedEnd=function(){this.is_end&&this.finshtFun()},e}(BaseEuiView);__reflect(ReviveView.prototype,"ReviveView"),ViewManager.ins().reg(ReviveView,LayerManager.UI_Main2),window.ReviveView=ReviveView;var EquipSwallowView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="EquipSwallowSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&获得的属性：|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSwallowGetInfo,this.ShowInfo),this.type=t[0]||1,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSwallowGetInfo,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=GlobalConfig.getEquip_swallow_item_dataConfig(this.type);if(BagProxy.ins().getItemCountById(e.item_id)<=0)return void TipsControl.ins().showTips("没有可吞噬的"+BagProxy.ins().getItemName(e.item_id));var i=EquipSwallowProxy.ins().GetCurSwallowCount(this.type),n=EquipSwallowProxy.ins().GetCurCanSwallowCount(this.type);return i>=n?void TipsControl.ins().showTips("吞噬已达到上限"):void EquipSwallowProxy.ins().C2SReqGrowupEquipSwallowOper(this.type)},e.prototype.ShowInfo=function(){var t=GlobalConfig.getEquip_swallow_item_dataConfig(this.type),e=UtilProxy.GetItemCellData(t.item_id,1);this.item.data=e,this.namelab.textFlow=UtilProxy.generateTextFlow(BagProxy.ins().getItemColorName(t.item_id));var i=EquipSwallowProxy.ins().GetCurSwallowCount(this.type),n=EquipSwallowProxy.ins().GetCurCanSwallowCount(this.type);this.count.textFlow=UtilProxy.StrFormart("C:7&已吞噬：@0 /@1 ",[i,n]);var o=BagProxy.ins().getItemCountById(t.item_id);this.hascount.text="拥有数量："+o,this.btn.setRed(o>0);var s=EquipSwallowProxy.ins().GetNextSwallowInfo(this.type);s&&s.zhuan>RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)?this.tips.textFlow=UtilProxy.StrFormart("@0 可吞噬：|C:4&@1 |",[UtilProxy.getZhuanStr(s.zhuan),s.count]):this.tips.textFlow=UtilProxy.generateTextFlow("C:4&已满阶");var r="",a=AttrProxy.getAttrInfo(t,i);if(void 0!=a)for(var h=0;h<a.length;h++)""==r?r=UtilProxy.getStr("@0 +@1 ",[a[h][0],a[h][1]]):r+=UtilProxy.getStr("\n@0 +@1 ",[a[h][0],a[h][1]]);this.prolab.textFlow=UtilProxy.generateTextFlow(r)},e}(BaseEuiView);__reflect(EquipSwallowView.prototype,"EquipSwallowView"),ViewManager.ins().reg(EquipSwallowView,LayerManager.UI_Main2),window.EquipSwallowView=EquipSwallowView;var RoleTipsView=function(t){function e(){var e=t.call(this)||this;return e.prolist1=[[FightAttr.HP,1],[FightAttr.ATTACK,1],[FightAttr.DEFENCE,1],[FightAttr.POJIA,1],[FightAttr.MINGZHONG,1],[FightAttr.SHANBI,1]],e.prolist2=[[FightAttr.BAOJI_RATE,2],[FightAttr.KANG_BAOJI_RATE,2],[FightAttr.BAOJI_HURT,1],[FightAttr.KANG_BAOJI_HURT,1],[FightAttr.GEDAND_RATE,2],[FightAttr.GEDAND_HURT_PRE,2],[FightAttr.POJI_RATE,2],[FightAttr.HURT_ADD_PRE,2],[FightAttr.HURT_SUB_PRE,2],[FightAttr.INNER_HURT,1],[FightAttr.INNER_SUB_HURT,1],[FightAttr.OUTPUT_HURT,1],[FightAttr.OUTPUT_SUB_HURT,1],[FightAttr.PARTNER_HURT_PRE,2],[FightAttr.SUCK_HP,1],[FightAttr.EXTRA_HURT,1]],e.prolist3=[[FightAttr.MINGZHONG_PRE,2],[FightAttr.SHANBI_PRE,2],[FightAttr.ZHONGJI_RATE,2],[FightAttr.KANG_ZHONGJI_RATE,2],[FightAttr.HUIXIN_RATE,2],[FightAttr.KANG_HUIXIN_RATE,2],[FightAttr.LIANJI_RATE,2],[FightAttr.QIANGJI_RATE,2],[FightAttr.HURT_REBOUND_PRE,2],[FightAttr.KANG_CONTROL_RATE,2]],e
}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RoleTipsSkin",this.title1.textFlow=UtilProxy.generateTextFlow("|C:10&【基础属性】|"),this.title2.textFlow=UtilProxy.generateTextFlow("|C:10&【高级战斗属性】|"),this.title3.textFlow=UtilProxy.generateTextFlow("|C:10&【特殊属性】|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.SetProInfo(this.pro1,this.prolist1,7),this.SetProInfo(this.pro2,this.prolist2,6),this.SetProInfo(this.pro3,this.prolist3,8)},e.prototype.SetProInfo=function(t,e,i){for(var n="",o=0;o<e.length;o++){var s=e[o][0]==FightAttr.HP?RoleProxy.ins().getFightAttr(FightAttr.HP_MAX):RoleProxy.ins().getFightAttr(e[o][0]),r=1==e[o][1]?s.toString():UtilProxy.getStr("@0 %",[s>0?s/100:0]);""==n?n=UtilProxy.getStr("     @0 ： |C:@1 &@2 |",[RoleProxy.keyName[GameConst.fightAttrStr[e[o][0]]],i,r]):n+=UtilProxy.getStr("\n     @0 ： |C:@1 &@2 |",[RoleProxy.keyName[GameConst.fightAttrStr[e[o][0]]],i,r])}t.textFlow=UtilProxy.generateTextFlow(n)},e}(BaseEuiView);__reflect(RoleTipsView.prototype,"RoleTipsView"),ViewManager.ins().reg(RoleTipsView,LayerManager.UI_Main2),window.RoleTipsView=RoleTipsView;var RoleView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RoleSkin",this.comview.initUI(),this.comview.SetName("title_juese"),this.elist.itemRenderer=EquipItem,this.weapon_fac=[this.setSbRed,this.setXbRed,this.setWingRed]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.elist.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.onekey,this.OnOneKey),this.addTouchEvent(this.godBtn,this.onSysClick),this.addTouchEvent(this.txBtn,this.onSysClick),this.addTouchEvent(this.szBtn,this.onSysClick),this.addTouchEvent(this.hufuBtn,this.onSysClick),this.addTouchEvent(this.jmBtn,this.onSysClick),this.addTouchEvent(this.sbBtn,this.onSysClick),this.addTouchEvent(this.xbBtn,this.onSysClick),this.addTouchEvent(this.wingBtn,this.onSysClick),this.addTouchEvent(this.rankbtn,this.onSysClick),this.addTouchEvent(this.infobtn,this.onSysClick),this.addTouchEvent(this.chBtn,this.onSysClick),this.addTouchEvent(this.ringBtn,this.onSysClick),this.addTouchEvent(this.taozhuang,this.onSysClick),this.addTouchEvent(this.ZbTao,this.onSysClick),this.addTouchEvent(this.longbtn,this.onSysClick),this.addTouchEvent(this.shenbtn,this.onSysClick),EventProxy.AddListener(this,EventType.S2CRepKnapsackDisArm,this.ShowRoleInfo),EventProxy.AddListener(this,EventType.UpdateBodyEquip,this.ShowRoleInfo),EventProxy.AddListener(this,EventType.UpdateFashionRed,this.SetFashionRed),EventProxy.AddListener(this,EventType.UpdateFuyinRed,this.SetFuyinRed),EventProxy.AddListener(this,EventType.UpdateGodEquipRed,this.SetGodEquipRed),EventProxy.AddListener(this,EventType.updateWeaponRed,this.onWeaponRedUpdate),EventProxy.AddListener(this,EventType.RefreshTitleRed,this.RefreshTitleRed),EventProxy.AddListener(this,EventType.UpdateTaozhuangRed,this.setTzRed),EventProxy.AddListener(this,EventType.VenationRedUpdate,this.setVenRed),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.setZbTao),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSwallowGetInfo,this.setEquitSwallowRed),EventProxy.AddListener(this,EventType.UpdateBagInfo,this.setEquitSwallowRed),this.ShowRoleInfo(),this.SetRed(),this.sb_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emSB),this.wing_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emWing),this.xb_actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emXB)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.elist.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.onekey,this.OnOneKey),this.removeTouchEvent(this.godBtn,this.onSysClick),this.removeTouchEvent(this.txBtn,this.onSysClick),this.removeTouchEvent(this.szBtn,this.onSysClick),this.removeTouchEvent(this.hufuBtn,this.onSysClick),this.removeTouchEvent(this.jmBtn,this.onSysClick),this.removeTouchEvent(this.sbBtn,this.onSysClick),this.removeTouchEvent(this.xbBtn,this.onSysClick),this.removeTouchEvent(this.wingBtn,this.onSysClick),this.removeTouchEvent(this.rankbtn,this.onSysClick),this.removeTouchEvent(this.infobtn,this.onSysClick),this.removeTouchEvent(this.chBtn,this.onSysClick),this.removeTouchEvent(this.ringBtn,this.onSysClick),this.removeTouchEvent(this.taozhuang,this.onSysClick),this.removeTouchEvent(this.ZbTao,this.onSysClick),this.removeTouchEvent(this.longbtn,this.onSysClick),this.removeTouchEvent(this.shenbtn,this.onSysClick),EventProxy.RemoveListener(this,EventType.UpdateTaozhuangRed,this.setTzRed),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.setZbTao),EventProxy.RemoveListener(this,EventType.UpdateBodyEquip,this.ShowRoleInfo),EventProxy.RemoveListener(this,EventType.S2CRepKnapsackDisArm,this.ShowRoleInfo),EventProxy.RemoveListener(this,EventType.UpdateFashionRed,this.SetFashionRed),EventProxy.RemoveListener(this,EventType.UpdateFuyinRed,this.SetFuyinRed),EventProxy.RemoveListener(this,EventType.UpdateGodEquipRed,this.SetGodEquipRed),EventProxy.RemoveListener(this,EventType.VenationRedUpdate,this.setVenRed),EventProxy.RemoveListener(this,EventType.updateWeaponRed,this.onWeaponRedUpdate),EventProxy.RemoveListener(this,EventType.RefreshTitleRed,this.RefreshTitleRed),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSwallowGetInfo,this.setEquitSwallowRed),EventProxy.RemoveListener(this,EventType.UpdateBagInfo,this.setEquitSwallowRed)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSysClick=function(t){switch(t.currentTarget){case this.godBtn:ViewManager.ins().open(GodEquipView);break;case this.txBtn:FacProxy.ins().getFacId()>0?ViewManager.ins().open(ReputationUIView):TipsControl.ins().showTips("请先加入宗派");break;case this.szBtn:ViewManager.ins().open(ShizhuangView);break;case this.hufuBtn:ViewManager.ins().open(FuyinView);break;case this.jmBtn:ViewManager.ins().open(VenationView);break;case this.sbBtn:ViewManager.ins().open(WeaponView,1);break;case this.xbBtn:ViewManager.ins().open(WeaponView,2);break;case this.wingBtn:ViewManager.ins().open(WeaponView,0);break;case this.rankbtn:ViewManager.ins().open(RankView);break;case this.infobtn:ViewManager.ins().open(RoleTipsView);break;case this.chBtn:ViewManager.ins().open(TitleUIView);break;case this.ringBtn:XyProxy.ins().is_marry?ViewManager.ins().open(XyRingTipsView):TipsControl.ins().showTips("C:4&结婚后方可打开此界面");break;case this.taozhuang:ViewManager.ins().open(TaoZhuangView);break;case this.ZbTao:ViewManager.ins().open(ZbTaoZhuang);break;case this.longbtn:ViewManager.ins().open(EquipSwallowView,1);break;case this.shenbtn:ViewManager.ins().open(EquipSwallowView,2)}},e.prototype.onListItemTap=function(t){var e=t.item;if(void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type)ViewManager.ins().open(EquipTipsView,e);else{var i=BagProxy.ins().getDressIndexByPart(e.item_slot_idx);if(-1==i)return void TipsControl.ins().showTips("没有可穿戴的装备");BagProxy.ins().C2SReqKnapsackArm(i,e.item_slot_idx)}},e.prototype.OnOneKey=function(t){for(var e=[],i=0;10>i;i++){var n=BagProxy.ins().getDressIndexByPart(i+1);if(-1!=n){var o=new C2SReqKnapsackArm;o.slot_idx=n,o.target_id=i+1,e.push(o)}}return 0==e.length?void TipsControl.ins().showTips("没有可穿戴的装备"):void BagProxy.ins().C2SReqKnapsackArmList(e)},e.prototype.ShowRoleInfo=function(){var t=RoleProxy.ins().getRoleSex(),e=GrowupProxy.ins().fashion_wear,i=WeaponProxy.ins().getDressId(WeaponType.Weapon),n=WeaponProxy.ins().getDressId(WeaponType.Wing);this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(e,n,i,void 0,t)),this.zhanValue.text=UtilProxy.getFightNumLab(RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING));var o=BagProxy.ins().getEquipInfo();this.arraylist||(this.arraylist=new eui.ArrayCollection,this.elist.dataProvider=this.arraylist),this.arraylist.removeAll();for(var s in o)this.arraylist.addItem(o[s]);this.elist.validateNow();for(var r=!1,a=0;a<o.length;a++){var h=this.elist.getVirtualElementAt(a);if(o[a]){var l=-1!=BagProxy.ins().getDressIndexByPart(o[a].item_slot_idx);h.ShowRed(l),l&&(r=l)}}this.onekeyred.visible=r,this.longbtn.visible=SystemOpenProxy.ins().isOpen(2,7601,!0),this.shenbtn.visible=SystemOpenProxy.ins().isOpen(2,7602,!0)},e.prototype.onWeaponRedUpdate=function(t){this.setSbRed(),this.setWingRed(),this.setXbRed()},e.prototype.SetRed=function(){this.SetFashionRed(),this.SetFuyinRed(),this.setSbRed(),this.setWingRed(),this.setXbRed(),this.SetGodEquipRed(),this.setTxRed(),this.setTitleRed(),this.setTzRed(),this.setZbTao(),this.setVenRed(),this.setEquitSwallowRed()},e.prototype.SetFashionRed=function(){this.shizhuangred.visible=GrowupProxy.ins().getFashionRed()},e.prototype.SetGodEquipRed=function(){this.szred.visible=GodEquipProxy.ins().getRed()},e.prototype.SetFuyinRed=function(){this.hfred.visible=GrowupProxy.ins().getFuyinRed()},e.prototype.setSbRed=function(){this.red_sb.visible=WeaponProxy.ins().getRedByPage(WeaponType.Weapon)},e.prototype.setWingRed=function(){this.red_wing.visible=WeaponProxy.ins().getRedByPage(WeaponType.Wing)},e.prototype.setXbRed=function(){this.red_xb.visible=WeaponProxy.ins().getRedByPage(WeaponType.XuanBing)},e.prototype.setVenRed=function(){this.red_ven.visible=VenationProxy.ins().getRed()},e.prototype.setZbTao=function(){this.zbtaoRed.visible=ZbTaoZhuangProxy.ins().getRedByAll()},e.prototype.setTzRed=function(){this.tzred.visible=TaoZhuangProxy.ins().getRed()},e.prototype.RefreshTitleRed=function(){this.setTxRed(),this.setTitleRed()},e.prototype.setTxRed=function(){this.txBtn.setRed(TitleProxy.ins().getRedByType(TitleUIType.reputation))},e.prototype.setTitleRed=function(){this.chBtn.setRed(TitleProxy.ins().getRedByType(TitleUIType.title))},e.prototype.setEquitSwallowRed=function(){this.longred.visible=EquipSwallowProxy.ins().getRedByType(1),this.shenred.visible=EquipSwallowProxy.ins().getRedByType(2)},e}(BaseEuiView);__reflect(RoleView.prototype,"RoleView"),ViewManager.ins().reg(RoleView,LayerManager.UI_Main),window.RoleView=RoleView;var GameServer=function(t){function e(){var e=t.call(this)||this;return e.sysId=PackageID.Default,e.regNetMsg(23,e.doGetOpenServer),e.regNetMsg(14,e.doServerTime),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e,"serverTime",{get:function(){return e._serverTime+egret.getTimer()},enumerable:!0,configurable:!0}),e.setServerTime=function(t){e._serverTime=DateUtils.formatMiniDateTime(t)-egret.getTimer()},e.prototype.doGetOpenServer=function(t){e.serverOpenDay=t.readInt()},e.prototype.doServerTime=function(t){e.setServerTime(t.readUnsignedInt())},e}(BaseSystem);__reflect(GameServer.prototype,"GameServer");var GameSystem;!function(t){t.gameserver=GameServer.ins.bind(GameServer)}(GameSystem||(GameSystem={}));var SetChatItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SetChatSkin",e.kjh.visible=!1,eui.Binding.bindHandler(e,["selected"],e.infoChangeHandler,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.infoChangeHandler=function(){this.selectIcon&&(null==this.data||this.data.id<=0?this.selectIcon.visible=!1:this.selectIcon.visible=this.selected)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){this.data&&(this.chatImg.source=this.data.config.icon,SetProxy.ins().isCharFrameActive(this.data.config.id)||1==this.data.config.open?(this.black.visible=!1,this.suo.visible=!1):(this.black.visible=!0,this.suo.visible=!0),SetProxy.ins().useChatFrame()<1?1===this.data.id?this.ycd.visible=!0:this.ycd.visible=!1:this.data.id===SetProxy.ins().useChatFrame()?this.ycd.visible=!0:this.ycd.visible=!1,1==this.data.state&&-1==SetProxy.ins().chat_fram_list.indexOf(this.data.id)&&1!=this.data.config.open?this.kjh.visible=!0:this.kjh.visible=!1)},e}(BaseItemRender);__reflect(SetChatItem.prototype,"SetChatItem"),window.SetChatItem=SetChatItem;var SetHeadItem=function(t){function e(){var e=t.call(this)||this;return e.isHead=!1,e.skinName="SetUIHeadSkin",e.kjh.visible=!1,eui.Binding.bindHandler(e,["selected"],e.infoChangeHandler,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.infoChangeHandler=function(){this.selectIcon&&(null==this.data||this.data.id<=0?this.selectIcon.visible=!1:this.selectIcon.visible=this.selected)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;void 0!=t&&void 0!=t.id&&(this.state_index=this.data.id,1==t.type?(this.isHead=!0,this.icon.visible=!0,this.bg.visible=!1,this.icon.source=t.config.icon,SetProxy.ins().isHeadActive(t.config.id)||1==t.config.open?(this.black.visible=!1,this.suo.visible=!1):(this.black.visible=!0,this.suo.visible=!0),SetProxy.ins().useHead()<1?1===this.data.id||2===this.data.id?this.ycd.visible=!0:this.ycd.visible=!1:this.data.id===SetProxy.ins().useHead()?this.ycd.visible=!0:this.ycd.visible=!1,1==this.data.state&&-1==SetProxy.ins().head_list.indexOf(this.data.id)&&1!=this.data.config.open?this.kjh.visible=!0:this.kjh.visible=!1):2==t.type&&(this.isHead=!1,this.icon.visible=!1,this.bg.visible=!0,this.bg.source=t.config.icon,SetProxy.ins().isHeadFrameActive(t.config.id)||1==t.config.open?(this.black.visible=!1,this.suo.visible=!1):(this.black.visible=!0,this.suo.visible=!0),SetProxy.ins().useHeadFrame()<1?1===this.data.id?this.ycd.visible=!0:this.ycd.visible=!1:this.data.id===SetProxy.ins().useHeadFrame()?this.ycd.visible=!0:this.ycd.visible=!1,1==this.data.state&&-1==SetProxy.ins().head_frame_list.indexOf(this.data.id)&&1!=this.data.config.open?this.kjh.visible=!0:this.kjh.visible=!1))},e}(BaseItemRender);__reflect(SetHeadItem.prototype,"SetHeadItem"),window.SetHeadItem=SetHeadItem;var SetUIView=function(t){function e(){var e=t.call(this)||this;return e.currentPage=-1,e.current_head=-1,e.current_head_bg=-1,e.current_head_id=-1,e.current_head_frame_id=-1,e.current_Chat_frame_id=-1,e.isCanCountiue=!1,e.current_pro=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SetUISkin",this.pro2_select0.visible=SetProxy.ins().clickByBox,this.listH1.itemRenderer=SetHeadItem,this.scrollerH1.viewport=this.listH1,this.listH1.dataProvider=new eui.ArrayCollection,this.listH2.itemRenderer=SetHeadItem,this.scrollerH2.viewport=this.listH2,this.listH2.dataProvider=new eui.ArrayCollection,this.listH4.itemRenderer=SetChatItem,this.scrollerH4.viewport=this.listH4,this.listH4.dataProvider=new eui.ArrayCollection,this.name.text=RoleProxy.ins().getRoleName()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn0,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.sbtn2,this.onClick),this.addTouchEvent(this.sbtn3,this.onClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.changeHeadBtn0,this.useThis),this.addTouchEvent(this.pro1,this.onProClick),this.addTouchEvent(this.pro2,this.onProClick),this.addTouchEvent(this.pro0,this.onProClick),this.addTouchEvent(this.changeNameBtn,this.onChangeNameClick),EventProxy.AddListener(this,EventType.S2CRepMiscRename,this.S2CRepMiscRename),EventProxy.AddListener(this,EventType.S2CRepMiscActiveHead,this.S2CRepMiscActiveHead),EventProxy.AddListener(this,EventType.S2CRepMiscActiveHeadFrame,this.S2CRepMiscActiveHeadFrame),EventProxy.AddListener(this,EventType.S2CRepMiscSetHead,this.S2CRepMiscSetHead),EventProxy.AddListener(this,EventType.S2CRepMiscActiveChatFrame,this.S2CRepMiscActiveChatFrame),EventProxy.AddListener(this,EventType.S2CRepMiscSetChatFrame,this.S2CRepMiscSetChatFrame),this.setCurrentPage(2),this.setCurrentPage(1),this.aloneRed()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.sbtn0,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.sbtn2,this.onClick),this.removeTouchEvent(this.sbtn3,this.onClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.changeHeadBtn0,this.useThis),this.removeTouchEvent(this.pro1,this.onProClick),this.removeTouchEvent(this.pro2,this.onProClick),this.removeTouchEvent(this.pro0,this.onProClick),this.removeTouchEvent(this.changeNameBtn,this.onChangeNameClick),EventProxy.RemoveListener(this,EventType.S2CRepMiscRename,this.S2CRepMiscRename),EventProxy.RemoveListener(this,EventType.S2CRepMiscActiveHead,this.S2CRepMiscActiveHead),EventProxy.RemoveListener(this,EventType.S2CRepMiscActiveHeadFrame,this.S2CRepMiscActiveHeadFrame),EventProxy.RemoveListener(this,EventType.S2CRepMiscSetHead,this.S2CRepMiscSetHead),EventProxy.RemoveListener(this,EventType.S2CRepMiscActiveChatFrame,this.S2CRepMiscActiveChatFrame),EventProxy.RemoveListener(this,EventType.S2CRepMiscSetChatFrame,this.S2CRepMiscSetChatFrame),this.currentPage=-1,this.current_head_id=-1,this.current_head_frame_id=-1,this.current_Chat_frame_id=-1},e.prototype.S2CRepMiscRename=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.inputName.text=""},e.prototype.S2CRepMiscActiveHead=function(){this.setHeadData(),this.aloneRed()},e.prototype.S2CRepMiscActiveHeadFrame=function(){this.setHeadKuangData(),this.aloneRed()},e.prototype.S2CRepMiscSetHead=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setHeadData(),this.setHeadKuangData()},e.prototype.S2CRepMiscActiveChatFrame=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setChatData(),this.aloneRed()},e.prototype.S2CRepMiscSetChatFrame=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setChatData()},e.prototype.aloneRed=function(){for(var t=0;3>t;t++)this["sbtn"+t].getChildAt(2).visible=SetProxy.ins().aloneRedByIndex(t)},e.prototype.onChangeNameClick=function(t){if(""==this.inputName.text)return void TipsControl.ins().showTips("角色名为空！");if(this.inputName.text.length>6)return void TipsControl.ins().showTips("使用字符过长！");var e=this.inputName.text;if(UtilProxy.isEmojiCharacter(e))return void TipsControl.ins().showTips("字符不合法");if(!UtilProxy.CheckStrIsOk(e))return void TipsControl.ins().showTips("字符不合法");var i=this.current_pro,n=function(t){if(t){var n=GlobalConfig.getMisc_dataConfig(1),o=BagProxy.ins().getItemCountById(n.rename_item);if(0==o)return void(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)>=n.rename_yb?TipsControl.ins().ShowTips1("改名卡不足，是否消耗"+n.rename_yb+"元宝？",function(){},function(){SetProxy.ins().C2SReqMiscRename(2,e,i)}):TipsControl.ins().showTips("改名卡不足!"));SetProxy.ins().C2SReqMiscRename(1,e,i)}else TipsControl.ins().showTips("包涵非法字符！");this.isCanCountiue=!0};this.isCanCountiue=!1,UtilProxy.CheckScreenchar(e,n)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.useThis=function(t){switch(this.getEcorr(),this.currentPage){case 1:SetProxy.ins().C2SReqMiscSetHead(this.target.id,1);break;case 2:SetProxy.ins().C2SReqMiscSetHead(this.target.id,2);break;case 3:SetProxy.ins().C2SReqMiscSetChatFrame(this.target.id)}},e.prototype.getEcorr=function(){return 1==this.currentPage&&this.current_head_id<=0?void TipsControl.ins().showTips("请选择头像!"):void(2==this.currentPage&&this.current_head_frame_id<=0?TipsControl.ins().showTips("请选择头像框!"):3==this.currentPage&&this.current_Chat_frame_id<=0&&TipsControl.ins().showTips("请选择聊天框!"))},e.prototype.onClick=function(t){var e=-1;switch(t.currentTarget){case this.sbtn0:e=1;break;case this.sbtn1:e=2;break;case this.sbtn2:e=3;break;case this.sbtn3:e=4}this.setCurrentPage(e)},e.prototype.setCurrentPage=function(t){if(t!=this.currentPage)switch(this.currentPage=t,this.threeAllG.visible=4>t,this.changNameG.visible=!this.threeAllG.visible,this.titleLb.text=SetProxy.ins().getLabelName(t),t){case 1:this.headGroup.visible=!0,this.headkuangG.visible=!1,this.chatKuangG.visible=!1,this.setHeadData();break;case 2:this.headGroup.visible=!1,this.headkuangG.visible=!0,this.chatKuangG.visible=!1,this.setHeadKuangData();break;case 3:this.headGroup.visible=!1,this.headkuangG.visible=!1,this.chatKuangG.visible=!0,this.setChatData();break;default:this.setNameData()}},e.prototype.setChatData=function(){GlobalConfig.getConfig("setup_chat_frame_data","setup_chat_frame_dataConfig"),this.list4=new Array;for(var t in GlobalConfig.ins().setup_chat_frame_dataConfig){var e=new ChatItemData,i=GlobalConfig.ins().setup_chat_frame_dataConfig[t],n=SetProxy.ins().isCanUse(i)?1:0;e.setChatData(i.id,n),this.list4.push(e)}this.listH4.dataProvider=new eui.ArrayCollection(this.list4),this.listH4.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChatIconClick,this),this.setChatInfo()},e.prototype.setChatInfo=function(){var t=this.current_Chat_frame_id>0?this.current_Chat_frame_id:SetProxy.ins().useChatFrame();0==t&&(t=SetProxy.ins().getCharFrameDefaultOpenId());var e=GlobalConfig.getSetup_chat_frame_dataConfig(t);this.jj.text=e.title},e.prototype.onChatIconClick=function(t){var e=t.itemRenderer;this.target=e.data,void 0!=this.target&&void 0!=this.target.id&&(this.current_Chat_frame_id=this.target.id,SetProxy.ins().isCharFrameActive(this.target.id)||this.isCanActive(this.target.config)&&SetProxy.ins().C2SReqMiscActiveChatFrame(this.target.id),this.setChatInfo())},e.prototype.setNameData=function(){this.current_pro=1,1==this.current_pro?(this.pro1_select.visible=!0,this.pro2_select.visible=!1):(this.pro1_select.visible=!1,this.pro2_select.visible=!0);var t=GlobalConfig.getMisc_dataConfig(1),e=(GlobalConfig.getItemsConfig(t.rename_item),BagProxy.ins().getItemCountById(t.rename_item));e>0?(this.gmk.visible=!0,this.pay_icon.visible=!1,this.pay_value.text="×"+e):(this.gmk.visible=!1,this.pay_icon.visible=!0,this.pay_value.text="×"+t.rename_yb)},e.prototype.autoSkill=function(){var t=ViewManager.ins().getView("MainUIView");this.pro2_select0.visible&&SetProxy.ins().clickByBox&&t instanceof MainUIView&&t.showSkill()},e.prototype.onProClick=function(t){switch(t.currentTarget){case this.pro1:this.pro1_select.visible=!0,this.pro2_select.visible=!1,this.current_pro=1;break;case this.pro2:this.pro1_select.visible=!1,this.pro2_select.visible=!0,this.current_pro=2;break;case this.pro0:this.pro2_select0.visible&&SetProxy.ins().clickByBox?this.pro2_select0.visible=SetProxy.ins().clickByBox=!1:(this.pro2_select0.visible=SetProxy.ins().clickByBox=!0,this.autoSkill())}},e.prototype.setHeadData=function(){GlobalConfig.getConfig("setup_head_data","setup_head_dataConfig"),this.list1=new Array;for(var t in GlobalConfig.ins().setup_head_dataConfig){var e=new HeadItemData,i=GlobalConfig.ins().setup_head_dataConfig[t];if(RoleProxy.ins().getRoleSex()==i.sex){var n=SetProxy.ins().isCanUse(i)?1:0;e.setHeadData(i.id,1,n),this.list1.push(e)}}this.listH1.dataProvider=new eui.ArrayCollection(this.list1),this.listH1.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItem1Click,this),this.setHeadInfo()},e.prototype.setHeadInfo=function(){var t=this.current_head_id>0?this.current_head_id:SetProxy.ins().useHead();0==t&&(t=SetProxy.ins().getHeadDefaultOpenId());var e=GlobalConfig.getSetup_head_dataConfig(t);this.headIcon1.source=e.icon,this.jj.text=e.title,this.setTarget(t,this.list1)},e.prototype.setTarget=function(t,e){for(var i=0;i<e.length;i++)e[i].id===t&&(this.target=e[i])},e.prototype.setHeadKuangData=function(){GlobalConfig.getConfig("setup_head_frame_data","setup_head_frame_dataConfig"),this.list2=new Array;for(var t in GlobalConfig.ins().setup_head_frame_dataConfig){var e=new HeadItemData,i=GlobalConfig.ins().setup_head_frame_dataConfig[t],n=SetProxy.ins().isCanUse(i)?1:0;e.setHeadData(i.id,2,n),this.list2.push(e)}this.listH2.dataProvider=new eui.ArrayCollection(this.list2),this.listH2.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItem2Click,this),this.showHeadKuangInfo()},e.prototype.showHeadKuangInfo=function(){var t=this.current_head_frame_id>0?this.current_head_frame_id:SetProxy.ins().useHeadFrame();0==t&&(t=SetProxy.ins().getHeadFrameDefaultOpenId());var e=GlobalConfig.getSetup_head_frame_dataConfig(t);this.headBg1.source=e.icon,this.jj.text=e.title,this.setTarget(t,this.list2)},e.prototype.SkinItem1Click=function(t){var e=t.itemRenderer;this.target=e.data,void 0!=this.target&&void 0!=this.target.id&&(this.current_head_id=this.target.id,SetProxy.ins().isHeadActive(this.target.id)||this.isCanActive(this.target.config)&&SetProxy.ins().C2SReqMiscActiveHead(this.target.id),this.setHeadInfo())},e.prototype.SkinItem2Click=function(t){var e=t.itemRenderer;this.target=e.data,void 0!=this.target&&void 0!=this.target.id&&(this.current_head_frame_id=this.target.id,SetProxy.ins().isHeadFrameActive(this.target.id)||this.isCanActive(this.target.config)&&SetProxy.ins().C2SReqMiscActiveHeadFrame(this.target.id),this.showHeadKuangInfo())},e.prototype.isCanActive=function(t){return void 0!=t?0!=t.level&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)<t.level?void TipsControl.ins().showTips("等级不足"):0!=t.zhuan&&RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)<t.zhuan?void TipsControl.ins().showTips("转数不够"):0!=t.vip&&RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)<t.vip?void TipsControl.ins().showTips("VIP等级不足"):SetProxy.ins().bagHaveItem(t)?!0:void TipsControl.ins().showTips("道具不足"):!1},e}(BaseEuiView);__reflect(SetUIView.prototype,"SetUIView"),ViewManager.ins().reg(SetUIView,LayerManager.UI_Main),window.SetUIView=SetUIView;var Setting=function(t){function e(){var e=t.call(this)||this;return e.sysId=PackageID.Default,e.regNetMsg(19,e.parser),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.parser=function(t){e.currPart=t.readByte(),e.currStep=t.readByte(),e.setting=t.readInt()},e.prototype.sendSaveGameSetting=function(){var t=this.getBytes(19);t.writeByte(e.currPart),t.writeByte(e.currStep),t.writeInt(e.setting),this.sendToServer(t)},e}(BaseSystem);__reflect(Setting.prototype,"Setting");var GameSystem;!function(t){t.setting=Setting.ins.bind(Setting)}(GameSystem||(GameSystem={}));var SevendayItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SevendayItemSkin",e.touchChildren=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.freshData()},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.freshData()},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this)},e.prototype.freshData=function(){var t=this.data;if(t){var e=t.items[t.items.length-1];this.item.data=UtilProxy.GetItemCellData(e[0],e[1],!1),this.nameIcon.source=t.day_image_2,this.finish.visible=WelfareProxy.ins().isGetSevendayAward(t.id)}},e.prototype.setSelectState=function(t){this.selectIcon.visible=t},e}(BaseItemRender);__reflect(SevendayItem.prototype,"SevendayItem"),window.SevendayItem=SevendayItem;var SevendayView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SevendayViewSkin",this.dayItemList=[this.dayItem0,this.dayItem1,this.dayItem2,this.dayItem3,this.dayItem4,this.dayItem5,this.dayItem6],this.rList.itemRenderer=ItemCell,this.rScroller.viewport=this.rList,this.rList.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.dayItemList.length;++i)this.addTouchEvent(this.dayItemList[i],this.onclick);this.addTouchEvent(this.rewardBtn,this.onRewardclick),this.addTouchEvent(this.closeBtn,this.onCloseclick),this.addTouchEvent(this.posBtn0,this.onPosClick),EventProxy.AddListener(this,EventType.S2CRspWelfareGetSevenDayAward,this.S2CRspWelfareGetSevenDayAward),this.setDataInfo();var n=WelfareProxy.ins().getcurSevendayAward();GlobalConfig.getSeven_day_award_dataConfigs();this.selectCurrentItem(n?this.dayItemList[n.id-1]:this.dayItemList[0])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.dayItemList.length;++i)this.removeTouchEvent(this.dayItemList[i],this.onclick);this.removeTouchEvent(this.rewardBtn,this.onRewardclick),this.removeTouchEvent(this.closeBtn,this.onCloseclick),this.removeItemTapEvent(this.posBtn0,this.onPosClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetSevenDayAward,this.S2CRspWelfareGetSevenDayAward)},e.prototype.S2CRspWelfareGetSevenDayAward=function(t){this.setCurrentData(t+1),this.dayItemList[t-1].freshData()},e.prototype.setRed=function(){this.current_id?this.rewardBtn.setRed(WelfareProxy.ins().isGetSevendayAward(this.current_id)):this.rewardBtn.setRed(!1)},e.prototype.onclick=function(t){var e=t.currentTarget;this.selectCurrentItem(e)},e.prototype.onCloseclick=function(t){ViewManager.ins().close(this)},e.prototype.onRewardclick=function(t){this.current_id&&(WelfareProxy.ins().isGetSevendayAward(this.current_id)?TipsControl.ins().showTips("已经领取！"):this.current_id<=WelfareProxy.ins().getCreateDay()?WelfareProxy.ins().C2SReqWelfareGetSevenDayAward(this.current_id):TipsControl.ins().showTips("登录天数不足"))},e.prototype.selectCurrentItem=function(t){t.data&&t.data.id&&this.setCurrentData(t.data.id)},e.prototype.setDataInfo=function(){var t=GlobalConfig.getSeven_day_award_dataConfigs(),e=0;for(var i in t)this.dayItemList[e].data=t[i],e++},e.prototype.setCurrentData=function(t){var e=GlobalConfig.getSeven_day_award_dataConfig(t);if(e){this.current_id=t,this.rewardBtn.visible=!WelfareProxy.ins().isGetSevendayAward(t),this.finish.visible=WelfareProxy.ins().isGetSevendayAward(t),this.dayIcon.source=e.day_image_1,this.fightValue0.text=e.fighting.toString(),this.nameImg.source=e.show_name;for(var i=[],n=0;n<e.items.length;++n)i.push(UtilProxy.GetItemCellData(e.items[n][0],e.items[n][1]));this.rList.dataProvider=new eui.ArrayCollection(i);var o;if(o=e.show_image.length>1?e.show_image[RoleProxy.ins().getProf()-1]:e.show_image[0],1==o[0])this.showImg.visible=!0,this.effG.visible=!1,this.showImg.source=o[1];else{this.showImg.visible=!1,this.effG.visible=!0;var s=UtilProxy.getShowImgPath()+o[1];void 0!=this.eff&&this.effG.removeChild(this.eff),this.eff=new egret.MovieClip,UtilProxy.GetMovieClip(s,this.eff,-1,void 0),this.effG.addChildAt(this.eff,1),this.eff.x=o[2],this.eff.y=o[3]}for(var n=0;n<this.dayItemList.length;++n)this.dayItemList[n].setSelectState(this.dayItemList[n].data.id==t)}this.setRed()},e.prototype.onPosClick=function(t){var e=Number(this.pos_x.text),i=Number(this.pos_y.text);this.eff&&(this.eff.x=e,this.eff.y=i)},e}(BaseEuiView);__reflect(SevendayView.prototype,"SevendayView"),ViewManager.ins().reg(SevendayView,LayerManager.UI_Main),window.SevendayView=SevendayView;var CollectView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ShareSkin",this.rList.itemRenderer=ItemCell,this.rScroller.viewport=this.rList,this.rList.dataProvider=new eui.ArrayCollection,this.lab.textFlow=UtilProxy.generateTextFlow("1.点击|C:10&右上角三个点|\n2.点击|C:10&下方置顶|或|C:10&添加到桌面|\n3.从|C:10&置顶入口|或|C:10&桌面入口|进入游戏\n4.点击本页下方|C:10&领取按钮|领取礼包")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rewardBtn,this.onRewardclick),this.addTouchEvent(this.closeBtn,this.onCloseclick),EventProxy.AddListener(this,EventType.S2CRspWelfareTopShareAward,this.S2CRspWelfareTopShareAward),0==WelfareProxy.ins().OpenTopTime&&(WelfareProxy.ins().OpenTopTime=GameLogic.ins().getServerTime()),this.setDataInfo(),this.SetBtn(),TimerManager.ins().doTimerDelay(1e4,100,2,this.SetBtn,this)
},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rewardBtn,this.onRewardclick),this.removeTouchEvent(this.closeBtn,this.onCloseclick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareTopShareAward,this.S2CRspWelfareTopShareAward)},e.prototype.S2CRspWelfareTopShareAward=function(t){WelfareProxy.ins().is_top&&ViewManager.ins().close(this)},e.prototype.onCloseclick=function(t){ViewManager.ins().close(this)},e.prototype.onRewardclick=function(t){return WelfareProxy.ins().is_top?void TipsControl.ins().showTips("已经领取！"):void(GameLogic.ins().getServerTime()-WelfareProxy.ins().OpenTopTime>=10?WelfareProxy.ins().C2SReqWelfareTopShareAward(1,0):TipsControl.ins().showTips("条件未达成!"))},e.prototype.setDataInfo=function(){for(var t=GlobalConfig.getWelfare_configConfig(1).top_award,e=[],i=0;i<t.length;++i)e.push(UtilProxy.GetItemCellData(t[i][0],t[i][1]));this.rList.dataProvider=new eui.ArrayCollection(e)},e.prototype.SetBtn=function(){UtilProxy.SetAshColor(this.rewardBtn,GameLogic.ins().getServerTime()-WelfareProxy.ins().OpenTopTime<10)},e}(BaseEuiView);__reflect(CollectView.prototype,"CollectView"),ViewManager.ins().reg(CollectView,LayerManager.UI_Main),window.CollectView=CollectView;var ShareView=function(t){function e(){var e=t.call(this)||this;return e.itemlist=[],e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="Share1Skin",this.rList.itemRenderer=ItemCell,this.rScroller.viewport=this.rList,this.rList.dataProvider=new eui.ArrayCollection,this.itemlist=[this.item0,this.item1,this.item2]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.itemlist.length;i++)this.addTouchEvent(this.itemlist[i],this.onItemClick);this.addTouchEvent(this.rewardBtn,this.onRewardclick),this.addTouchEvent(this.closeBtn,this.onCloseclick),EventProxy.AddListener(this,EventType.S2CRspWelfareTopShareAward,this.S2CRspWelfareTopShareAward),this.setDataInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.itemlist.length;i++)this.removeTouchEvent(this.itemlist[i],this.onItemClick);this.removeTouchEvent(this.rewardBtn,this.onRewardclick),this.removeTouchEvent(this.closeBtn,this.onCloseclick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareTopShareAward,this.S2CRspWelfareTopShareAward)},e.prototype.S2CRspWelfareTopShareAward=function(t){this.SetBtn(),this.SetOtherAward()},e.prototype.onCloseclick=function(t){ViewManager.ins().close(this)},e.prototype.onRewardclick=function(t){var e=this;return WelfareProxy.ins().today_share?void TipsControl.ins().showTips("今日已经领取！"):void(WelfareProxy.ins().IsShare?WelfareProxy.ins().C2SReqWelfareTopShareAward(2,0):SdkManager.ins().sdktype==SdkType.QQ||SdkManager.ins().sdktype==SdkType.HUOSDK?platform.QQShareAppMessage(function(){WelfareProxy.ins().IsShare=!0,e.SetBtn()}):(WelfareProxy.ins().IsShare=!0,this.SetBtn()))},e.prototype.onItemClick=function(t){var e=this.itemlist.indexOf(t.currentTarget),i=WelfareProxy.ins().GetShareState(e+1);if(1==i)return void WelfareProxy.ins().C2SReqWelfareTopShareAward(3,e+1);var n=t.currentTarget.data;void 0!=n&&n.item_type_id>0&&ViewManager.ins().open(ItemTipsView,n)},e.prototype.setDataInfo=function(){for(var t=GlobalConfig.getWelfare_configConfig(1).share_award,e=[],i=0;i<t.length;++i)e.push(UtilProxy.GetItemCellData(t[i][0],t[i][1]));this.rList.dataProvider=new eui.ArrayCollection(e),this.SetBtn(),this.SetOtherAward()},e.prototype.SetBtn=function(){this.rewardBtn.label=0==WelfareProxy.ins().IsShare||WelfareProxy.ins().today_share?"分享游戏":"领取奖励",UtilProxy.SetAshColor(this.rewardBtn,WelfareProxy.ins().today_share)},e.prototype.SetOtherAward=function(){var t=GlobalConfig.getWelfare_share_acc_awardConfig(3).days;this.lab.text=UtilProxy.getStr("(@0 /@1 )",[WelfareProxy.ins().share_days,t]),this.bar.width=this.bg.width*WelfareProxy.ins().share_days/t;for(var e=0;e<this.itemlist.length;e++){var i=GlobalConfig.getWelfare_share_acc_awardConfig(e+1);i&&(this.itemlist[e].data=UtilProxy.GetItemCellData(i.award[0][0],i.award[0][1]),this.itemlist[e].SetShowTips(!1),this["lab"+e].textFlow=UtilProxy.StrFormart("|C:@0 &(@1 /@2 )|",[WelfareProxy.ins().share_days>=i.days?7:4,WelfareProxy.ins().share_days,i.days]))}},e}(BaseEuiView);__reflect(ShareView.prototype,"ShareView"),ViewManager.ins().reg(ShareView,LayerManager.UI_Main),window.ShareView=ShareView;var PvpEndView=function(t){function e(){var e=t.call(this)||this;return e.coldtime=0,e.info="",e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="PvpEndSkin",this.itemlist.itemRenderer=BagItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.LeaveClick),this.itemlist.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.info=t[3]||"",this.endtype=t[2],this.win.visible=t[1],this.lost.visible=!t[1],this.data_list=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.LeaveClick),this.itemlist.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),TimerManager.ins().removeAll(this),this.endtype&&this.endtype==EndType.YEZHAN&&ViewManager.ins().open(ShenxianView,1)},e.prototype.LeaveClick=function(t){this.finshtime()},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&ViewManager.ins().open(ItemTipsView,e)},e.prototype.SetTimelab=function(){this.coldtime=this.coldtime-1,this.time.textFlow=UtilProxy.StrFormart("退出倒计时 |C:7&(@0 s)|",[this.coldtime])},e.prototype.ShowInfo=function(){if(this.arraylist||(this.arraylist=new eui.ArrayCollection,this.itemlist.dataProvider=this.arraylist),this.arraylist.removeAll(),this.data_list)for(var t=0;t<this.data_list.length;t++)this.arraylist.addItem(this.data_list[t]);this.desc.textFlow=UtilProxy.generateTextFlow(this.info),this.coldtime=8,this.time.textFlow=UtilProxy.StrFormart("退出倒计时 |C:7&(@0 s)|",[this.coldtime]),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this);var e=this.endtype==EndType.DUJIE&&1==this.lost.visible;this.itemlist.visible=this.sp_title.visible=this.sp_lost_left.visible=this.sp_lost_right.visible=!e},e.prototype.finshtime=function(){if(ViewManager.ins().close(this),this.endtype==EndType.DUJIE)return void CopyProxy.ins().C2SReqCopyLeave(0);if(this.endtype==EndType.YEZHAN)return void(YezhanProxy.ins().isCanYezhan()&&!CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId)&&HangManager.ins().checkNext());if(CopyProxy.ins().isLeiTai(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isShenxian(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isLunjian(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isZMZD(GameLogic.ins().getCurSceneId())||CopyProxy.ins().isTopFight(GameLogic.ins().getCurSceneId())){var t=GameLogic.ins().getLastScene(),e=GlobalConfig.getSceneConfigById(t);return void SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),e.x,e.y)}},e}(BaseEuiView);__reflect(PvpEndView.prototype,"PvpEndView"),ViewManager.ins().reg(PvpEndView,LayerManager.UI_Main2),window.PvpEndView=PvpEndView;var ShenxianAwardItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="ShenxianAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data;if(void 0!=t.id){t.up_rank==t.down_rank?this.rank.textFlow=UtilProxy.StrFormart("|C:10&第@0 名|",[t.up_rank]):this.rank.textFlow=UtilProxy.StrFormart("|C:10&第@0 -@1 名|",[t.up_rank,t.down_rank]);for(var e=[],i=0;i<t.award.length;i++){var n=new ItemCellData;n.item_type_id=t.award[i][0],n.item_count=t.award[i][1],n.itemConfig=BagProxy.ins().getItemData(t.award[i][0]),e.push(n)}this.awardlist.dataProvider=new eui.ArrayCollection(e)}},e}(BaseItemRender);__reflect(ShenxianAwardItem.prototype,"ShenxianAwardItem"),window.ShenxianAwardItem=ShenxianAwardItem;var ShenxianAwardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShenxianAwardSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&奖励预览|"),this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&每日0点结算奖励|"),this.btn.textFlow=UtilProxy.generateTextFlow("|C:7&U&查看排名|"),this.list.itemRenderer=ShenxianAwardItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onbtnClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onbtnClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onbtnClick=function(t){},e.prototype.ShowInfo=function(){this.ranklab.text=UtilProxy.getStr("我的排名：@0 ",[ShenXianProxy.ins().rank_index>0&&ShenXianProxy.ins().rank_index<=1e3?ShenXianProxy.ins().rank_index:"未上榜"]);var t=GlobalConfig.getSXRewardList(),e=[];for(var i in t){var n=t[i];e.push(n)}this.list.dataProvider=new eui.ArrayCollection(e)},e}(BaseEuiView);__reflect(ShenxianAwardView.prototype,"ShenxianAwardView"),ViewManager.ins().reg(ShenxianAwardView,LayerManager.UI_Main2),window.ShenxianAwardView=ShenxianAwardView;var ShenxianItem=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="ShenxianItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.namelab.text=t.name,this.zhan.textFlow=UtilProxy.StrFormart("|C:10&战力：@0 |",[t.fighting]),this.rankpic.visible=t.rank_index<=3,this.rank.visible=t.rank_index>3,this.pic.visible=t.rank_index>3,t.rank_index>3?this.rank.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.rank_index]):this.rankpic.source="top_icon_0"+t.rank_index,this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(t.cloth,0,t.equip,void 0,t.prof)),this.btn.icon=this.CanSweep()?"xiandaohui_miaosha":"xiandaohui_tiaozhan"},e.prototype.onClick=function(t){if(!UtilProxy.IsCanTranScene())return void TipsControl.ins().showTips("当前场景不能进行挑战");if(ShenXianProxy.ins().left_challenge_times<=0)return TipsControl.ins().showTips("挑战次数不足"),void this.ShowBuyTips();var e=this.data;if(void 0!=e)return e.rank_index<=3&&ShenXianProxy.ins().rank_index>10?void TipsControl.ins().showTips("排名前十的玩家才可以挑战"):void(0!=this.index&&(ShenXianProxy.ins().challengename=e.name,this.CanSweep()?ShenXianProxy.ins().C2SReqArenaSweep(this.index,e.role_id,e.rank_index):(LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),ShenXianProxy.ins().C2SReqArenaChallenge(this.index,e.role_id,e.rank_index)),t.stopImmediatePropagation()))},e.prototype.CanSweep=function(){return RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=GlobalConfig.getArena_base_dataConfig(1).sweep_vip_level&&RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING)>this.data.fighting&&0!=ShenXianProxy.ins().rank_index&&ShenXianProxy.ins().rank_index<this.data.rank_index?!0:!1},e.prototype.ShowBuyTips=function(){var t=GlobalConfig.getArena_buy_dataConfig(ShenXianProxy.ins().buy_challenge_times+1);void 0==t&&(t=GlobalConfig.getArena_buy_dataConfig(10));var e=GlobalConfig.getArena_vip_challenge_timesConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),i=UtilProxy.getStr("是否花费|C:7&@0 @1 |购买1次挑战次数?\n今日剩余购买次数|C:7&(@2 /@3 )|",[t.money[1],BagProxy.ins().getItemName(t.money[0]),e.buy_times-ShenXianProxy.ins().buy_challenge_times,e.buy_times]);TipsControl.ins().ShowTips1(i,void 0,this.BuyCount)},e.prototype.BuyCount=function(){var t=GlobalConfig.getArena_vip_challenge_timesConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL));if(ShenXianProxy.ins().buy_challenge_times>=t.buy_times)return TipsControl.ins().showTips("购买次数不足"),!1;var e=GlobalConfig.getArena_buy_dataConfig(ShenXianProxy.ins().buy_challenge_times+1);return void 0==e&&(e=GlobalConfig.getArena_buy_dataConfig(10)),RoleProxy.ins().getMoneyAttr(e.money[0])<e.money[1]?(TipsControl.ins().showTips("消耗不足"),!1):(ShenXianProxy.ins().C2SReqArenaBuyChallengeNum(1),!0)},e}(BaseItemRender);__reflect(ShenxianItem.prototype,"ShenxianItem"),window.ShenxianItem=ShenxianItem;var ShenxianView=function(t){function e(){var e=t.call(this)||this;return e.cur_page=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShenxianSkin",this.comview.initUI(),this.roles=[this.role3,this.role2,this.role1],this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&每日0点结算|"),this.tips0.textFlow=UtilProxy.StrFormart("|C:7&VIP@0 开启秒杀",[GlobalConfig.getArena_base_dataConfig(1).sweep_vip_level]),this.tips0.visible=!UtilProxy.shield,this.fristaward.visible=!1,this.menu_list=[this.btn_page0,this.btn_page1],this.page1.initUI()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.rankbtn,this.onbtnClick),this.addTouchEvent(this.awardpic,this.onbtnClick),this.addTouchEvent(this.tisheng,this.onbtnClick),this.addTouchEvent(this.add,this.onAddClick),this.addTouchEvent(this.refeshbtn,this.onRefeshClick),this.addTouchEvent(this.btn1,this.onbtnClick),this.addTouchEvent(this.closebtn0,this.onbtnClick),this.addTouchEvent(this.btn_page0,this.onbtnClick),this.addTouchEvent(this.btn_page1,this.onbtnClick),EventProxy.AddListener(this,EventType.S2CRepArenaGetInfo,this.ShowShenXian),EventProxy.AddListener(this,EventType.S2CRepArenaChallenge,this.ShowShenXian),EventProxy.AddListener(this,EventType.S2CRepArenaRefreshOpp,this.ShowRolesInfo),EventProxy.AddListener(this,EventType.S2CRepArenaSweep,this.ShowMyInfo),EventProxy.AddListener(this,EventType.S2CRepArenaBuyChallengeNum,this.ShowMyInfo),ShenXianProxy.ins().C2SReqArenaGetInfo(),this.ShowShenXian(),ShenXianProxy.ins().getYBAward()>0&&this.ShowFristAward();var i=0;t&&t.length>0&&SystemOpenProxy.ins().isOpen(2,1200+t[0])&&(i=t[0]),this.openPage(i)},e.prototype.openPage=function(t){this.cur_page!=t&&this.cur_page>-1&&(this.menu_list[this.cur_page].getChildAt(1).visible=!1),this.cur_page=t,this.menu_list[this.cur_page].getChildAt(1).visible=!0,0==t?(this.comview.SetName("title_xiandaohui"),this.page0.visible=!0,this.page1.visible=!1,this.page1.close()):(this.comview.SetName("title_yezhan"),this.page0.visible=!1,this.page1.visible=!0,this.page1.open())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.page1.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.rankbtn,this.onbtnClick),this.removeTouchEvent(this.awardpic,this.onbtnClick),this.removeTouchEvent(this.tisheng,this.onbtnClick),this.removeTouchEvent(this.add,this.onAddClick),this.removeTouchEvent(this.refeshbtn,this.onRefeshClick),this.removeTouchEvent(this.btn_page0,this.onbtnClick),this.removeTouchEvent(this.btn_page1,this.onbtnClick),EventProxy.RemoveListener(this,EventType.S2CRepArenaGetInfo,this.ShowShenXian),EventProxy.RemoveListener(this,EventType.S2CRepArenaChallenge,this.ShowShenXian),EventProxy.RemoveListener(this,EventType.S2CRepArenaRefreshOpp,this.ShowRolesInfo),EventProxy.RemoveListener(this,EventType.S2CRepArenaSweep,this.ShowMyInfo),EventProxy.RemoveListener(this,EventType.S2CRepArenaBuyChallengeNum,this.ShowMyInfo),this.cur_page=-1,TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onbtnClick=function(t){switch(t.currentTarget){case this.rankbtn:ViewManager.ins().open(RankView);break;case this.tisheng:break;case this.btn1:this.fristaward.visible=!1;break;case this.closebtn0:this.fristaward.visible=!1;break;case this.awardpic:ViewManager.ins().open(ShenxianAwardView);break;case this.btn_page0:SystemOpenProxy.ins().isOpen(2,1200)&&this.openPage(0);break;case this.btn_page1:SystemOpenProxy.ins().isOpen(2,1201)&&this.openPage(1);break;default:var e=this.menu_list.indexOf[t.currentTarget];e>=0&&this.openPage(e)}},e.prototype.onAddClick=function(t){this.ShowBuyTips()},e.prototype.onRefeshClick=function(t){ShenXianProxy.ins().C2SReqArenaRefreshOpp()},e.prototype.ShowShenXian=function(){this.ShowMyInfo(),this.ShowRolesInfo()},e.prototype.ShowMyInfo=function(){this.namelab.text=UtilProxy.getStr("名字：@0 ",[RoleProxy.ins().getRoleName()]),this.fightlab.text=UtilProxy.getStr("战力：@0 ",[RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING)]),this.ranklab.text=UtilProxy.getStr("排名：@0 ",[ShenXianProxy.ins().rank_index>0&&ShenXianProxy.ins().rank_index<=3e3?ShenXianProxy.ins().rank_index:"未上榜"]);var t=GlobalConfig.getArena_vip_challenge_timesConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),e=GlobalConfig.getArena_vip_challenge_timesConfig(0);this.countlab.textFlow=UtilProxy.StrFormart("|C:10&挑战次数：@0 /@1 ||C:7&(VIP+@2 )|",[ShenXianProxy.ins().left_challenge_times,t.limit_times,t.limit_times-e.limit_times]),this.ShowColdTime()},e.prototype.ShowColdTime=function(){var t=GlobalConfig.getArena_vip_challenge_timesConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL));ShenXianProxy.ins().left_challenge_times<t.limit_times?(this.SetTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)):(this.time.text="",TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.SetTimeLab=function(){var t=ShenXianProxy.ins().last_recover_time+GlobalConfig.getArena_base_dataConfig(1).cd_time,e=GameLogic.ins().getServerTime();t>e?this.time.textFlow=UtilProxy.StrFormart("|C:7&@0 后恢复1次|",[UtilProxy.getTimeHMSString(t-e)]):(this.time.text="",TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.ShowRolesInfo=function(){for(var t=0;t<ShenXianProxy.ins().opps.length;t++)this.roles[t]&&(this.roles[t].data=ShenXianProxy.ins().opps[t],this.roles[t].index=t+1)},e.prototype.ShowBuyTips=function(){var t=GlobalConfig.getArena_buy_dataConfig(ShenXianProxy.ins().buy_challenge_times+1);void 0==t&&(t=GlobalConfig.getArena_buy_dataConfig(10));var e=GlobalConfig.getArena_vip_challenge_timesConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),i=UtilProxy.getStr("是否花费|C:7&@0 @1 |购买1次挑战次数?\n今日剩余购买次数|C:7&(@2 /@3 )|",[t.money[1],BagProxy.ins().getItemName(t.money[0]),e.buy_times-ShenXianProxy.ins().buy_challenge_times,e.buy_times]);TipsControl.ins().ShowTips1(i,void 0,this.BuyCount)},e.prototype.BuyCount=function(){var t=GlobalConfig.getArena_vip_challenge_timesConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL));if(ShenXianProxy.ins().buy_challenge_times>=t.buy_times)return TipsControl.ins().showTips("购买次数不足"),!1;var e=GlobalConfig.getArena_buy_dataConfig(ShenXianProxy.ins().buy_challenge_times+1);return void 0==e&&(e=GlobalConfig.getArena_buy_dataConfig(10)),RoleProxy.ins().getMoneyAttr(e.money[0])<e.money[1]?(TipsControl.ins().showTips("消耗不足"),!1):(ShenXianProxy.ins().C2SReqArenaBuyChallengeNum(1),!0)},e.prototype.ShowFristAward=function(){this.fristaward.visible=!0,this.info0.text=UtilProxy.getStr("本次挑战成功，排名从@0 提升到@1 ，获得\n@2 ",[ShenXianProxy.ins().lastrank_index>0?ShenXianProxy.ins().lastrank_index:"未上榜",ShenXianProxy.ins().rank_index,ShenXianProxy.ins().getYBAward()]),ShenXianProxy.ins().clearAward()},e}(BaseEuiView);__reflect(ShenxianView.prototype,"ShenxianView"),ViewManager.ins().reg(ShenxianView,LayerManager.UI_Main),window.ShenxianView=ShenxianView;var YezhanItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.txt_vip.text=t.vip,this.bg.source=XyProxy.ins().getTitleBg(t.head_frame_id),this.icon.source=XyProxy.ins().getTitleIcon(t.head_id,t.prof),this.txt_vip.text=t.vip;var e="";t.faction_id>0&&(e+=UtilProxy.getStr("[@0 @1 阶]",[GlobalConfig.getFaction_dataConfig(t.faction_id).faction_name,t.reputation_id])),this.txt_name.textFlow=UtilProxy.StrFormart("C:4&@0 |C:10&@1 ",[e,t.name]),this.txt_lv.textFlow=UtilProxy.StrFormart("等级：@0 ",[t.level]),this.txt_value.textFlow=UtilProxy.StrFormart("战力：@0 ",[t.fighting])}},e.prototype.onClick=function(){if(YezhanProxy.ins().isRunning())return void TipsControl.ins().showTips("当前的都还没有打完!");if(this.data){var t=this.data;if(!YezhanProxy.ins().isCanYezhan())return void TipsControl.ins().showTips("C:4&当前场景不可进行野战");if(YezhanProxy.ins().challenge_count<=0)return void TipsControl.ins().showTips("C:4&次数不足了");YezhanProxy.ins().C2SReqYezhanChallenge(t.id)}},e}(BaseItemRender);__reflect(YezhanItem.prototype,"YezhanItem"),window.YezhanItem=YezhanItem;var YezhanTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ShenxianAwardSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onClick),this.removeTouchEvent(this.btn,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closebtn:ViewManager.ins().close(e),this.visible=!1;break;case this.btn:ViewManager.ins().close(e),this.visible=!1,ViewManager.ins().open(RankView,13)}},e.prototype.updateInfo=function(){var t=RankProxy.ins().getMyRankByType(14);if(this.tips.textFlow=UtilProxy.StrFormart("C:7&每日0点结算奖励",[]),this.ranklab.textFlow=UtilProxy.StrFormart("C:1&我的排名：@0 ",[t||"未上榜"]),this.btn.textFlow=UtilProxy.generateTextFlow("|C:7&U&查看排名|"),!this.array){this.array=new eui.ArrayCollection,this.list.itemRenderer=ShenxianAwardItem,this.list.dataProvider=this.array;var e=GlobalConfig.getRankdailyList(14);for(var i in e){var n=e[i];this.array.addItem(n)}}},e}(BaseEuiView);__reflect(YezhanTipsView.prototype,"YezhanTipsView"),ViewManager.ins().reg(YezhanTipsView,LayerManager.UI_Main2),window.YezhanTipsView=YezhanTipsView;var YezhanView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.misc_data=GlobalConfig.getYezhanMisc();var t=RankProxy.ins().getMyRankByType(14);this.txt_value.textFlow=UtilProxy.StrFormart("C:10&今日野战点：|@0 ",[YezhanProxy.ins().score]),this.txt_remark.textFlow=UtilProxy.StrFormart("C:10&排名奖励",[]),this.txt_sort.textFlow=UtilProxy.StrFormart("C:10&排名：|@0 ",[t>0?t:"未上榜"]),this.btn_list=[this.btn_sort,this.btn_preview,this.btn_guwu,this.btn_refresh,this.btn_add],this.txt_guwu.textFlow=UtilProxy.StrFormart("每次提升@0 %战斗力",[this.misc_data.guwu_per/100])},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepYezhanBuyTimes,this.onBuyTimes),EventProxy.AddListener(this,EventType.S2CRepYezhanRefreshOpp,this.onFresh),EventProxy.AddListener(this,EventType.S2CRepYezhanGuwu,this.onGuwu),EventProxy.AddListener(this,EventType.S2CRepYezhanUpdate,this.onBuyTimes);for(var i=0;i<this.btn_list.length;i++)this.addTouchEvent(this.btn_list[i],this.onClick);this.txt_times_cd.text="",this.updateInfo(),this.CheckGuide(),TimerManager.ins().doTimer(1,0,this.onTimer,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepYezhanBuyTimes,this.onBuyTimes),EventProxy.RemoveListener(this,EventType.S2CRepYezhanRefreshOpp,this.onFresh),EventProxy.RemoveListener(this,EventType.S2CRepYezhanGuwu,this.onGuwu),EventProxy.RemoveListener(this,EventType.S2CRepYezhanUpdate,this.onBuyTimes),TimerManager.ins().remove(this.onTimer,this);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick);this.tips.close()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_sort:ViewManager.ins().open(RankView,13);break;case this.btn_preview:ViewManager.ins().open(YezhanTipsView);break;case this.btn_add:var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),i=GlobalConfig.getYezhanVipTimes(e);if(i&&i.buy_times>0){var n=YezhanProxy.ins().buy_times;if(n<i.buy_times){if(YezhanProxy.ins().challenge_count>0)return void TipsControl.ins().showTips("C:4&还有挑战次数");var o=GlobalConfig.getYezhanBuyData(n+1).money,s=BagProxy.ins().getItemName(o[0]),r=RoleProxy.ins().getMoneyAttr(o[0])<o[1]?4:7,a=UtilProxy.getStr("当前可购买次数|C:7&(@0 /@1 )|,确定花费|C:@2 &@3 @4 购买?",[i.buy_times-n,i.buy_times,r,o[1],s]);TipsControl.ins().ShowTips1(a,function(){},function(){var t=RoleProxy.ins().getMoneyAttr(o[0]);return t<o[1]?void TipsControl.ins().showTips("C:4&货币不足"):void YezhanProxy.ins().C2SReqYezhanBuyTimes()})}else TipsControl.ins().showTips("C:4&今日次数已用完了")}else TipsControl.ins().showTips("C:4&提升到vip"+this.getMinVip()+"可以获得购买次数");break;case this.btn_guwu:if(YezhanProxy.ins().guwu_count>=this.misc_data.guwu_limit)return void TipsControl.ins().showTips("C:4&今日鼓舞次数都用完了");var h=this.misc_data.guwu_consume,l=BagProxy.ins().getItemName(h[0]),p=RoleProxy.ins().getMoneyAttr(h[0])<h[1]?4:7,c=UtilProxy.getStr("确定花费|C:@0 &@1 |@2 ？",[p,h[1],l]);TipsControl.ins().ShowTips1(c,function(){},function(){var t=RoleProxy.ins().getMoneyAttr(h[0]);return t<h[1]?void TipsControl.ins().showTips("C:4&货币不足"):void YezhanProxy.ins().C2SReqYezhanGuwu()});break;case this.btn_refresh:var u=(this.misc_data.free_refresh,this.misc_data.free_refresh-YezhanProxy.ins().refresh_count),d=this.misc_data.refresh_need[0],g=this.misc_data.refresh_need[1],y=RoleProxy.ins().getMoneyAttr(d);if(0>=u&&g>y)return TipsControl.ins().showTips("C:4&金币不足"),void TipsControl.ins().ShowPathTips(d);YezhanProxy.ins().C2SReqYezhanRefreshOpp()}},e.prototype.updateInfo=function(){var t=RankProxy.ins().getMyRankByType(14),e=YezhanProxy.ins().getRewardByRankId(t);if(e.length>0){this.reward_list.visible=!0,this.txt_remark2.text="",this.array_reward||(this.reward_list.itemRenderer=ItemCell,this.array_reward=new eui.ArrayCollection,this.reward_list.dataProvider=this.array_reward),this.array_reward.removeAll();for(var i=0;i<e.length;i++){var n=e[i],o=new ItemCellData,s={item_slot_idx:0,item_type_id:n[0],item_count:n[1]};o.setItemCellData(s),this.array_reward.addItem(o)}}else this.reward_list.visible=!1,this.txt_remark2.text="暂无排名奖励";this.array_post||(this.list_post.itemRenderer=YezhanItem,this.array_post=new eui.ArrayCollection,this.list_post.dataProvider=this.array_post),this.array_post.removeAll();for(var r=YezhanProxy.ins().getOppList(),i=0;i<r.length;i++){var n=r[i];this.array_post.addItem(n)}this.txt_fight.text=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING).toString(),this.txt_add.text="+"+this.misc_data.guwu_per/100*YezhanProxy.ins().guwu_count+"%";var a=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),h=GlobalConfig.getYezhanVipTimes(a),l=YezhanProxy.ins().challenge_count;this.txt_fight_times.textFlow=UtilProxy.StrFormart("C:10&挑战次数：|C:@0 &@1 /@2 ",[0>=l?4:7,l,h.limit_times]);var p=this.misc_data.free_refresh,c=this.misc_data.free_refresh-YezhanProxy.ins().refresh_count;if(this.gp_cost.visible=0>=c,c>0)this.txt_times.textFlow=UtilProxy.StrFormart("免费次数：|C:@0 &@1 /@2 ",[0>=c?4:7,c,p]);else{this.txt_times.text="";var u=this.misc_data.refresh_need[0],d=this.misc_data.refresh_need[1],g=RoleProxy.ins().getMoneyAttr(u);this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[d>g?4:7,d])}},e.prototype.onTimer=function(){var t=YezhanProxy.ins().recover_time-GameLogic.ins().getServerTime();if(t>0){var e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_1);this.txt_times_cd.text=e}else t>-1&&(this.txt_times_cd.text="")},e.prototype.getMinVip=function(){var t=GlobalConfig.getYezhanVipTimesList();for(var e in t){var i=t[e];if(i.buy_times>0)return e}return 1},e.prototype.onBuyTimes=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e=GlobalConfig.getYezhanVipTimes(t),i=YezhanProxy.ins().challenge_count;this.txt_fight_times.textFlow=UtilProxy.StrFormart("C:10&挑战次数：|C:@0 &@1 /@2 ",[0>=i?4:7,i,e.limit_times])},e.prototype.onFresh=function(){this.array_post.removeAll();for(var t=YezhanProxy.ins().getOppList(),e=0;e<t.length;e++){var i=t[e];this.array_post.addItem(i)}var n=this.misc_data.free_refresh,o=this.misc_data.free_refresh-YezhanProxy.ins().refresh_count;if(this.gp_cost.visible=0>=o,o>0)this.txt_times.textFlow=UtilProxy.StrFormart("免费次数：|C:@0 &@1 /@2 ",[0>=o?4:7,o,n]);else{this.txt_times.text="";var s=this.misc_data.refresh_need[0],r=this.misc_data.refresh_need[1],a=RoleProxy.ins().getMoneyAttr(s);this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[r>a?4:7,r])}},e.prototype.onGuwu=function(){this.txt_add.text="+"+this.misc_data.guwu_per/100*YezhanProxy.ins().guwu_count+"%"},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(YezhanView.prototype,"YezhanView"),window.YezhanView=YezhanView;var ShiZhuangItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="ShizhuangItemSkin"},e.prototype.init=function(){this.ShowOnSelect(!1),this.ShowName(!0),this.ShowRed(!1),this.ShowTips(!1),this.ShowSuo(!1)},e.prototype.ShowTips=function(t){this.tipspic.visible=t},e.prototype.ShowSuo=function(t){this.suo.visible=t},e}(ItemCell);__reflect(ShiZhuangItem.prototype,"ShiZhuangItem"),window.ShiZhuangItem=ShiZhuangItem;var ShiZhuangTipsView=function(t){function e(){var e=t.call(this)||this;return e.curFashion=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZhulingTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepGrowupFashionUpdate,this.ShowInfo),this.curFashion=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupFashionUpdate,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=t.currentTarget==this.btn?0:1,i=GrowupProxy.ins().getFashionSwallowState(this.curFashion);if(3==i)return void TipsControl.ins().showTips("该时装尚未激活");if(2==i)return void TipsControl.ins().showTips("吞噬已达到上限");if(1==i){var n=GrowupProxy.ins().getFashionSwallow(this.curFashion);return void TipsControl.ins().showTips(UtilProxy.getStr("没有可吞噬的@0 ",[BagProxy.ins().getItemName(n[0])]))}GrowupProxy.ins().C2SReqGrowupFashionSwallow(this.curFashion,e)},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFashion_swallow_dataConfig(this.curFashion)[1],e=GrowupProxy.ins().getFashion(this.curFashion);e&&(t=GlobalConfig.getFashion_swallow_dataConfig(this.curFashion)[e.grade]);var i=BagProxy.ins().getItemData(t.swallow[0]),n=new ItemCellData;n.item_type_id=t.swallow[0],n.itemConfig=i,this.item.data=n,this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[i.quality-1],i.name]),this.desc.textFlow=UtilProxy.generateTextFlow("|C:7&已永久增加主角属性：|");var o=e?e.swallow:0,s="",r=GlobalConfig.getFashion_swallow_itemConfig(t.swallow[0]),a=AttrProxy.getAttrInfo(r,o);if(void 0!=a)for(var h=0;h<a.length;h++)""==s?s=UtilProxy.getStr("@0 |C:7&+@1 |",[a[h][0],a[h][1]]):s+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[a[h][0],a[h][1]]);this.pro.textFlow=UtilProxy.generateTextFlow(s),this.hascount.textFlow=UtilProxy.StrFormart("已拥有：@0 ",[BagProxy.ins().getItemCountById(t.swallow[0])]);
var l=t.swallow[1];this.count.textFlow=UtilProxy.StrFormart("已吞噬：|C:@0 &@1 /@2 |",[l>o?7:4,o,l]);var p=GlobalConfig.getFashion_swallow_dataConfig(this.curFashion)[t.grade+1];this.tips.visible=this.tips.includeInLayout=void 0!=p,void 0!=p&&(this.tips.textFlow=UtilProxy.StrFormart("|C:7&下级可吞噬@0 颗|",[p.swallow[1]||0]))},e}(BaseEuiView);__reflect(ShiZhuangTipsView.prototype,"ShiZhuangTipsView"),ViewManager.ins().reg(ShiZhuangTipsView,LayerManager.UI_Main2),window.ShiZhuangTipsView=ShiZhuangTipsView;var ShiZhuangUpStarView=function(t){function e(){var e=t.call(this)||this;return e.fashionId=0,e.needId=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShizhuangUpStarSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&升星|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepGrowupInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepGrowupFashionUpdate,this.ShowUpEffect),this.fashionId=t[0]||0,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepGrowupFashionUpdate,this.ShowUpEffect)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=GrowupProxy.ins().getFashionCanUp(this.fashionId);return 1==e?(TipsControl.ins().showTips("升星材料不足"),void TipsControl.ins().ShowPathTips(this.needId)):2==e?void TipsControl.ins().showTips("已经提升至最高"):void GrowupProxy.ins().C2SReqGrowupFashionUpgrade(this.fashionId,1)},e.prototype.ShowUpEffect=function(){UtilProxy.GetMovieClipById(26,this.effect),UtilProxy.GetMovieClipById(30,this.effect),this.ShowInfo()},e.prototype.ShowInfo=function(){var t=GrowupProxy.ins().getFashion(this.fashionId),e=GlobalConfig.getFashion_base_dataConfig(this.fashionId)[1],i=GlobalConfig.getFashion_base_dataConfig(this.fashionId)[2];if(this.zhanValue.text="0",t){e=GlobalConfig.getFashion_base_dataConfig(this.fashionId)[t.grade],i=GlobalConfig.getFashion_base_dataConfig(this.fashionId)[t.grade+1];var n=UtilProxy.GetAttrFight(e);this.zhanValue.text=UtilProxy.getFightNumLab(n)}this.btnred.visible=0==GrowupProxy.ins().getFashionCanUp(this.fashionId),this.btn.label=i?"升 星":"已满级",this.namelab.text=GlobalConfig.getFashion_id_dataConfig(this.fashionId).name,this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(e.id,0,0,void 0,RoleProxy.ins().getRoleSex())),this.needlab.visible=void 0!=i,this.needId=i?i.item[0]:0,i&&(this.needlab.textFlow=UtilProxy.StrFormart("消耗：|C:@0 &@1 x@2 |",[BagProxy.ins().getItemCountById(i.item[0])<i.item[1]?4:7,BagProxy.ins().getItemName(i.item[0]),i.item[1]]));for(var o=t.grade||0,s=GlobalConfig.getFashion_level_dataConfig(o),r=0;r<this.stars.numChildren;r++){var a=o%this.stars.numChildren,h=this.stars.getChildAt(r);0==a&&o>0||a>r?h.source=s.star:h.source="shengxing_icon_01_01"}for(var l=AttrProxy.getAttrInfo(e),p="",r=0;3>r;r++)p+=""==p?UtilProxy.getStr("@0 : |C:10&+@1 |",[l[r][2],UtilProxy.getNumLab(l[r][1])]):UtilProxy.getStr("\n@0 : |C:10&+@1 |",[l[r][2],UtilProxy.getNumLab(l[r][1])]);for(var c="",r=3;6>r;r++)c+=""==c?UtilProxy.getStr("@0 : |C:10&+@1 |",[l[r][2],UtilProxy.getNumLab(l[r][1])]):UtilProxy.getStr("\n@0 : |C:10&+@1 |",[l[r][2],UtilProxy.getNumLab(l[r][1])]);this.curprolab.textFlow=UtilProxy.generateTextFlow(p),this.curprolab0.textFlow=UtilProxy.generateTextFlow(c)},e}(BaseEuiView);__reflect(ShiZhuangUpStarView.prototype,"ShiZhuangUpStarView"),ViewManager.ins().reg(ShiZhuangUpStarView,LayerManager.UI_Main2),window.ShiZhuangUpStarView=ShiZhuangUpStarView;var ShizhuangView=function(t){function e(){var e=t.call(this)||this;return e.needId=0,e.IsShowEff=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShizhuangSkin",this.comview.initUI(),this.comview.SetName("title_shizhuang"),this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&所有时装属性激活和升级后累加，穿戴可改变角色外观|"),this.getlab.textFlow=UtilProxy.generateTextFlow("|C:7&U&获取材料|"),this.tips1.textFlow=UtilProxy.generateTextFlow("|C:7&已满级|"),this.title0.textFlow=UtilProxy.generateTextFlow("|C:10&下阶属性|"),this.list.itemRenderer=ShiZhuangItem,this.sv.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.dressbtn,this.onBtnClick),this.addTouchEvent(this.jlbtn,this.onBtnClick),this.addTouchEvent(this.upbtn,this.onBtnClick),this.addTouchEvent(this.getlab,this.onBtnClick),this.addTouchEvent(this.lvItem,this.onLvUpClick),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.AddListener(this,EventType.S2CRepGrowupInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepGrowupFashionUpdate,this.ShowUpEffect),EventProxy.AddListener(this,EventType.S2CRepGrowupFashionWear,this.ShowInfo),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.dressbtn,this.onBtnClick),this.removeTouchEvent(this.jlbtn,this.onBtnClick),this.removeTouchEvent(this.upbtn,this.onBtnClick),this.removeTouchEvent(this.getlab,this.onBtnClick),this.removeTouchEvent(this.lvItem,this.onLvUpClick),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.RemoveListener(this,EventType.S2CRepGrowupInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepGrowupFashionUpdate,this.ShowUpEffect),EventProxy.RemoveListener(this,EventType.S2CRepGrowupFashionWear,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onLvUpClick=function(t){var e=this.curSelectItem.data,i=e.item_slot_idx;ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[LvUpType.emSZ,i])},e.prototype.onBtnClick=function(t){var e=this.curSelectItem.data,i=e.item_slot_idx,n=GrowupProxy.ins().getFashion(i);switch(t.currentTarget){case this.btn:if(GrowupProxy.ins().getFashion(i)){if(1==GrowupProxy.ins().getFashionGrowCanUp(i))return TipsControl.ins().showTips("升阶材料不足"),void TipsControl.ins().ShowPathTips(this.needId);if(2==GrowupProxy.ins().getFashionGrowCanUp(i))return void TipsControl.ins().showTips("已经提升至最高");if(3==GrowupProxy.ins().getFashionGrowCanUp(i)){var o=this.curSelectItem.data,s=o.item_slot_idx;return void ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[LvUpType.emSZ,s])}this.IsShowEff=!0}else if(1==GrowupProxy.ins().getFashionGrowCanUp(i))return TipsControl.ins().showTips("激活材料不足"),void TipsControl.ins().ShowPathTips(this.needId);GrowupProxy.ins().C2SReqGrowupFashionUpgrade(i,2);break;case this.upbtn:if(void 0==n)return void TipsControl.ins().showTips("该时装尚未激活");ViewManager.ins().open(ShiZhuangUpStarView,i);break;case this.dressbtn:GrowupProxy.ins().C2SReqGrowupFashionWear(i,i==GrowupProxy.ins().fashion_wear?1:0);break;case this.jlbtn:if(void 0==n)return void TipsControl.ins().showTips("该时装尚未激活");ViewManager.ins().open(ShiZhuangTipsView,i);break;case this.getlab:this.needId>0&&TipsControl.ins().ShowPathTips(this.needId)}},e.prototype.onListItemTap=function(t){t.item;void 0!=this.curSelectItem&&this.curSelectItem.ShowOnSelect(!1),this.curSelectItem=t.itemRenderer,this.curSelectItem.ShowOnSelect(!0),this.Setfashioninfo()},e.prototype.ShowUpEffect=function(){this.IsShowEff&&(UtilProxy.GetMovieClipById(26,this.effect),UtilProxy.GetMovieClipById(20,this.effect),this.IsShowEff=!1),this.ShowInfo()},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFashionListConfig(),e=[];for(var i in t)if(t[i][1]){var n=new ItemCellData,o={item_slot_idx:t[i][1].id,item_type_id:t[i][1].item[0],item_count:1};n.setItemCellData(o),e.push(n)}e.sort(this.sort),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();for(var i in e)this.arraylist.addItem(e[i]);this.list.validateNow(),void 0==this.curSelectItem&&(this.curSelectItem=this.list.getVirtualElementAt(0),this.curSelectItem.ShowOnSelect(!0));for(var s=0;s<e.length;s++){var r=this.list.getVirtualElementAt(s),a=e[s].item_slot_idx;if(r.ShowRed(0==GrowupProxy.ins().getFashionSwallowState(a)||0==GrowupProxy.ins().getFashionCanUp(a)||0==GrowupProxy.ins().getFashionGrowCanUp(a)||3==GrowupProxy.ins().getFashionGrowCanUp(a)),r.ShowSuo(void 0==GrowupProxy.ins().getFashion(a)),r.ShowTips(a==GrowupProxy.ins().fashion_wear),this.curSelectItem){var h=this.curSelectItem.data,l=h.item_slot_idx;a==l&&(r.ShowOnSelect(!0),this.curSelectItem=r)}}this.Setfashioninfo()},e.prototype.sort=function(t,e){var i=void 0!=GrowupProxy.ins().getFashion(t.item_slot_idx),n=void 0!=GrowupProxy.ins().getFashion(e.item_slot_idx),o=GrowupProxy.ins().getFashionGrowCanUp(t.item_slot_idx),s=GrowupProxy.ins().getFashionGrowCanUp(e.item_slot_idx);return i||0!=o?n||0!=s?0==o?-1:0==s?1:t.item_slot_idx==GrowupProxy.ins().fashion_wear?-1:e.item_slot_idx==GrowupProxy.ins().fashion_wear?1:i?-1:n?1:0:1:-1},e.prototype.Setfashioninfo=function(){var t=this.curSelectItem.data,e=t.item_slot_idx;this.curSelectItem.ShowRed(0==GrowupProxy.ins().getFashionSwallowState(e)||0==GrowupProxy.ins().getFashionCanUp(e)||0==GrowupProxy.ins().getFashionGrowCanUp(e)||3==GrowupProxy.ins().getFashionGrowCanUp(e)),this.curSelectItem.ShowSuo(void 0==GrowupProxy.ins().getFashion(e)),this.curSelectItem.ShowTips(e==GrowupProxy.ins().fashion_wear);var i=GrowupProxy.ins().getFashion(e),n=GlobalConfig.getFashion_grow_dataConfig(e,0),o=GlobalConfig.getFashion_base_dataConfig(e)[1],s=GlobalConfig.getFashion_grow_dataConfig(e,1);if(this.btn.label=i?"进阶":"激活",this.title.textFlow=i?UtilProxy.generateTextFlow("|C:10&当前属性|"):UtilProxy.generateTextFlow("|C:10&激活属性|"),this.zhanValue.text="0",i){n=GlobalConfig.getFashion_grow_dataConfig(e,i.level),o=GlobalConfig.getFashion_base_dataConfig(e)[i.grade],s=GlobalConfig.getFashion_grow_dataConfig(e,i.level+1);var r=GrowupProxy.ins().getFashionSwallow(e)[0],a=UtilProxy.GetAttrFight(n)+UtilProxy.GetAttrFight(o)+UtilProxy.GetAttrFight(GlobalConfig.getFashion_swallow_itemConfig(r))*i.swallow;this.zhanValue.text=UtilProxy.getFightNumLab(a)}this.namelab.text=GlobalConfig.getFashion_id_dataConfig(e).name,this.lvlab.text=n.level+"\n阶",this.needId=n.item[0],this.needlab.visible=void 0!=s,this.needlab.textFlow=UtilProxy.StrFormart("需求：|C:@0 &@1 x@2 |",[BagProxy.ins().getItemCountById(n.item[0])<n.item[1]?4:7,BagProxy.ins().getItemName(n.item[0]),n.item[1]]);var h=BagProxy.ins().GetLVUpItem(LvUpType.emSZ,n.level);this.lvItem.visible=void 0!=h,void 0!=h&&(this.lvItem.data=h);var l=RoleProxy.ins().getTableAdd(n,o),p=RoleProxy.ins().getTableAdd(s,o);this.SetProInfo(l,this.curprolab),s?this.SetProInfo(p,this.nextprolab):this.nextprolab.textFlow=UtilProxy.generateTextFlow("|C:7&已满级|"),this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(n.id,0,0,void 0,RoleProxy.ins().getRoleSex()));var c=GrowupProxy.ins().getFashionGrowCanUp(e);this.btn.visible=2!=c,this.tips1.visible=2==c,this.upred.visible=0==GrowupProxy.ins().getFashionCanUp(e),this.red.visible=0==c||3==c,this.dressbtn.visible=void 0!=i,this.dressbtn.icon=n.id==GrowupProxy.ins().fashion_wear?"shenbing_btn_huanhua_02":"shenbing_btn_huanhua",this.jlred.visible=0==GrowupProxy.ins().getFashionSwallowState(e),this.countlab.text=UtilProxy.getStr("@0 /@1 ",[i?i.swallow:0,GrowupProxy.ins().getFashionSwallow(e)[1]])},e.prototype.SetProInfo=function(t,e){var i="",n=e==this.nextprolab?7:1;for(var o in t)i+=""==i?UtilProxy.getStr("@0 ：|C:@2 &+@1 |",[RoleProxy.keyName[o],UtilProxy.getNumLab(t[o]),n]):UtilProxy.getStr("\n@0 ：|C:@2 &+@1 |",[RoleProxy.keyName[o],UtilProxy.getNumLab(t[o]),n]);e.textFlow=UtilProxy.generateTextFlow(i)},e}(BaseEuiView);__reflect(ShizhuangView.prototype,"ShizhuangView"),ViewManager.ins().reg(ShizhuangView,LayerManager.UI_Main),window.ShizhuangView=ShizhuangView;var BuffData=function(){function t(){}return t}();__reflect(BuffData.prototype,"BuffData");var SkillBuff=function(){function t(){}return t}();__reflect(SkillBuff.prototype,"SkillBuff");var SkillCC=function(t){function e(){var e=t.call(this)||this;return e.isRecordDamage=!1,e.normal_skill_id=1e6,e.best_skill_id=2e6,e.play_bskill=!1,e.play_index=0,e.LL_ONE_BIT=1,e.sysId=PackageID.Skill,e.skillsData=[[],[],[]],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.sendUseSkill=function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=!1),VirtualServer.ins().sendUseSkill(t,e,i,o)},e.prototype.doSkillListResult=function(t){for(var e=0;e<t.list.length;e++)this.doSkillResult(t.list[e])},e.prototype.doSkillResult=function(t){var e=ObjectPool.pop(egret.getQualifiedClassName(SkillDamageData));e.parser(t),GameLogic.ins().doBloodUpdate(t.target_obj_id,t.hp);var i=GameLogic.ins().getEntityByHandle(e.senderHandle);if(!Assert(i,"释放技能id:"+e.skillId+"的释放者实体不存在")){var n=GameLogic.ins().getEntityByHandle(e.targetHandle);if(!Assert(n,"释放技能id:"+e.skillId+"的目标实体不存在")){if(e.skillId>0){var o=GlobalConfig.getSkillConfig(e.skillId);if(i.masterHandle!=GameMap.centerEntity.handle){i.stopMove(),i.setDir(DirUtil.get8DirBy2Point(i,n));var s=GlobalConfig.getSkillDescById(Math.floor(o.id/1e4));i.playAction(s.action_type)}}this.isRecordDamage&&t.real_blood<0&&void 0!=SceneControl.ins().hurtList[e.senderHandle]&&(SceneControl.ins().hurtList[e.senderHandle].name=i.name,SceneControl.ins().hurtList[e.senderHandle].hurt=SceneControl.ins().hurtList[e.senderHandle].hurt-t.real_blood),this.doSkillResultByData(e)}}},e.prototype.doSkillResultByData=function(t){for(var e=this,i=t.skillDamageRanges.length,n=function(n){var s=t.skillDamageRanges[n],r=s.handle,a=s.type,h=s.value;if(a==DamageType.BLANK)return"continue";var l=GameLogic.ins().getEntityByHandle(r);if(Assert(l,"释放技能id:"+t.skillId+"的伤害目标实体不存在"))return{value:void 0};l.setHpAndNameVisible(!0),l instanceof EntityMonster&&a!=DamageType.MISS&&l.addAtkedEffect(t.skillId);var p=0,c=null;n==i-1&&(c=function(){t.reset(),ObjectPool.push(t)});for(var u=s.part,d=Math.ceil(h/u),g=0;u>g;g++)l.is_main?TimerManager.ins().doTimer(p,1,function(){e.showBlood1(d,a,s.senderPos,s.targetPos)},o,c):TimerManager.ins().doTimer(p,1,function(){e.showBlood(d,a,s.senderPos,s.targetPos)},o,c),p+=666},o=this,s=0;i>s;s++){var r=n(s);if("object"==typeof r)return r.value}},e.prototype.showBlood=function(t,e,i,n){var o=ObjectPool.pop(egret.getQualifiedClassName(FlyNumber));GameMap.ins()._bloodLayer.addChild(o),e==DamageType.MISS||e==DamageType.GEDAN||e==DamageType.ZHONGJI?(o.setWordSource(e),this.flyDamage(o,e,i,n)):(o.setNumber(Math.abs(t),e,!1),this.flyDamage(o,e,i,n))},e.prototype.showBlood1=function(t,e,i,n){var o=ObjectPool.pop(egret.getQualifiedClassName(FlyNumber));GameMap.ins()._bloodLayer.addChild(o),e==DamageType.MISS||e==DamageType.GEDAN||e==DamageType.ZHONGJI?(o.setWordSource(e),this.flyDamage1(o,e,i,n)):(o.setNumber(Math.abs(t),e,!0),this.flyDamage1(o,e,i,n))},e.prototype.flyDamage=function(t,e,i,n){var o=n.x,s=n.y-90;DirUtil.get8DirBy2Point(i,n),MathUtils.limitInteger(800,1600);t.x=o,t.y=s,t.alpha=0;var r=egret.Tween.get(t);switch(e){case DamageType.HUIXIN:case DamageType.BAOJI:case DamageType.XL:case DamageType.QIANGJI:case DamageType.QJHX:case DamageType.MISS:case DamageType.GEDAN:case DamageType.ZHONGJI:case DamageType.BISHA:case DamageType.SPE_BAOJI:t.x=MathUtils.getRandom(o-100,o+150),t.y=MathUtils.getRandom(s-80,s+150),(e==DamageType.BISHA||e==DamageType.SPE_BAOJI)&&(t.x=MathUtils.getRandom(o-100,o+100),t.y=MathUtils.getRandom(s-80,s+10)),r.to({scaleX:2.1,scaleY:2.1,alpha:1},20,egret.Ease.elasticInOut).wait(98).to({scaleX:1,scaleY:1},13,function(t){return 2*t+t*t}).wait(400).to({alpha:0},100).call(function(){t.reset(),ObjectPool.push(t)},this);break;default:e==DamageType.INNER?s-=42:e==DamageType.INNER&&(s-=102),t.y=s,r.to({scaleX:1,scaleY:1,alpha:1},100).wait(50).to({x:o,y:s-120},500).wait(50).to({alpha:0},200).call(function(){t.reset(),ObjectPool.push(t)},this)}},e.prototype.flyDamage1=function(t,e,i,n){var o=n.x,s=n.y-90;DirUtil.get8DirBy2Point(i,n),MathUtils.limitInteger(800,1600);t.x=o,t.y=s,t.alpha=0;var r=egret.Tween.get(t);switch(e){case DamageType.MISS:case DamageType.GEDAN:case DamageType.ZHONGJI:t.x=MathUtils.getRandom(o-100,o+150),t.y=MathUtils.getRandom(s-80,s+150),r.to({scaleX:1.8,scaleY:1.8,alpha:1},10,egret.Ease.backIn).wait(120).to({scaleX:1,scaleY:1},13,function(t){return 2*t+t*t}).wait(600).to({alpha:0},100).call(function(){t.reset(),ObjectPool.push(t)},this);break;default:t.y=s,r.to({scaleX:1,scaleY:1,alpha:1},100).wait(50).to({x:o,y:s-160},500).wait(50).to({alpha:0},200).call(function(){t.reset(),ObjectPool.push(t)},this)}},e.prototype.doAddBuff=function(t){var e=t.readDouble(),i=t.readInt();GameLogic.ins().addBuff(e,i)},e.prototype.doRemoveBuff=function(t){var e=t.readDouble(),i=t.readInt();GameLogic.ins().removeBuff(e,i)},e.prototype.doAddEffect=function(t){t.readDouble(),t.readInt()},e.prototype.doRemoveEffect=function(t){t.readDouble(),t.readInt()},e.prototype.getSkillDatasOfRole=function(t){return this.skillsData[t]},e.prototype.getSkillDataByid=function(t,e){for(var i=this.skillsData[t],n=0,o=i;n<o.length;n++){var s=o[n];if(s&&s.skillId==e)return s}return null},e.prototype.getSkillDataOfRoleByIndex=function(t,e){return this.skillsData[t][e]},e.prototype.getSkillDataOfRoleById=function(t,e){for(var i=this.skillsData[t],n=0;n<i.length;n++)if(i[n]&&i[n].skillId==e)return i[n];return null},e.prototype.setSkillsByIndex=function(t,e,i,n){var o=this.getSkillDatasOfRole(t),s=o[e],r=!1;s||(s=new SkillData,s.skillLv=i,o[e]=s,s.skillCDTick=0,r=!0),s.skillId=n,s.skillLv=i,s.skillConfig=GlobalConfig.getSkillConfig(s.skillId),r&&n==this.best_skill_id},e.prototype.checkSkillDis=function(t,e,i){if(!e||!t)return!1;var n=MathUtils.getDistanceX2ByObject(t,e),o=GlobalConfig.getSkillDescById(Math.floor(i.skillId/1e4));return n<Math.pow(.001*o.attack_range*GameMap.CELL_SIZE,2)},e.prototype.getSkillCanUse=function(t){for(var e,i=this.getSkillDatasOfRole(t),n=TimerManager.ins().getCurrTime(),o=0,s=i;o<s.length;o++){var r=s[o];r&&r.skillCDTick<=n&&r.isActivate()&&(!e||GlobalConfig.getSkillDescById(Math.floor(r.skillId/1e4)).priority<GlobalConfig.getSkillDescById(Math.floor(e.skillId/1e4)).priority)&&(e=r)}return e},e.prototype.getBestSkill=function(){return this.getSkillDataOfRoleByIndex(1,10)},e.prototype.getNextSkill=function(t,e){var i=SkillProxy.ins().getPlayList(),n=this.getSkillDatasOfRole(t);if(this.play_bskill)for(var o=0,s=n;o<s.length;o++){var r=s[o];if(r&&r.skillId==this.best_skill_id)return ViewManager.ins().open(SpeView),this.play_bskill=!1,r}for(var a=!0;a;)if(this.play_index<i.length){var r=this.getSkillDataByid(t,i[this.play_index]);if(this.play_index+=1,r&&r.skillCDTick<TimerManager.ins().getCurrTime())return r}else a=!1,this.play_index=0;var h=this.getSkillDataByid(t,this.normal_skill_id);return h},e.prototype.getSkillsCanUse=function(t){for(var e=this.getSkillDatasOfRole(t),i=[],n=0,o=e;n<o.length;n++){var s=o[n];s&&s.skillCDTick<TimerManager.ins().getCurrTime()&&i.push(s)}return i},e.prototype.updateSkillId=function(t,e){var i=this.getSkillDataOfRoleById(t,e);if(i){var n=SkillProxy.ins().getFabaoJjLv(),o=GlobalConfig.getFabaoJjById(n),s=GlobalConfig.getSkillDescById(Math.floor(i.skillId/1e4));e!=this.best_skill_id&&n>0&&void 0!=o&&o.skill_cd_per>0?i.skillCDTick=TimerManager.ins().getCurrTime()+s.cd*(1-1e-4*o.skill_cd_per):i.skillCDTick=TimerManager.ins().getCurrTime()+s.cd}},e.prototype.resetSkillId=function(t,e){var i=this.getSkillDataOfRoleById(t,e);i&&(i.skillCDTick=TimerManager.ins().getCurrTime())},e.prototype.userSkill=function(t,e){return!1},e.prototype.getRand=function(t,e){var i=Math.floor(Math.random()*(e-t)+t);return i},e.prototype.getDamageType=function(t,e){var i=this.LL_ONE_BIT,n=t.getProp(FightAttr.MINGZHONG),o=e.getProp(FightAttr.SHANBI),s=0;if(o>n){var r=Math.floor(Math.pow(o,.5)-Math.pow(n,.5)+.01*(e.getProp(FightAttr.SHANBI_PRE)-t.getProp(FightAttr.MINGZHONG_PRE))),a=100*Math.random();if(r>80&&(r=80),r>a)return s=s|=i<<FightType.FIGHT_TYPE_SHANBI}1e4*Math.random()<=t.getProp(FightAttr.ZHONGJI_RATE)-e.getProp(FightAttr.KANG_ZHONGJI_RATE)&&(s=s|=i<<FightType.FIGHT_TYPE_ZHONGJI);var h=1e4*Math.random();t.getProp(FightAttr.QIANGJI_RATE)>h&&(s=s|=i<<FightType.FIGHT_TYPE_QIANGJI);var l=1e4*Math.random();t.getProp(FightAttr.LIANJI_RATE)>l&&(s=s|=i<<FightType.FIGHT_TYPE_LIANJI);var p=1e4*Math.random();t.getProp(FightAttr.HUIXIN_RATE)-e.getProp(FightAttr.KANG_HUIXIN_RATE)>p&&(s=s|=i<<FightType.FIGHT_TYPE_HUIXIN);var c=1e4*Math.random();t.getProp(FightAttr.BAOJI_RATE)-e.getProp(FightAttr.KANG_BAOJI_RATE)>c&&(s=s|=i<<FightType.FIGHT_TYPE_BAOJI);var u=1e4*Math.random();t.getProp(FightAttr.ZHONGJI_RATE)-e.getProp(FightAttr.KANG_ZHONGJI_RATE)>u&&(s=s|=i<<FightType.FIGHT_TYPE_ZHONGJI);var d=1e4*Math.random();return e.getProp(FightAttr.GEDAND_RATE)-t.getProp(FightAttr.POJI_RATE)>d&&(s=s|=i<<FightType.FIGHT_TYPE_GEDAN),s},e.prototype.getDamageValue=function(t,e,i,n){var o=this.LL_ONE_BIT;n.reset();var s=GlobalConfig.getSkillDescById(Math.floor(i.id/1e4));if(n.suckHp=t.getProp(FightAttr.SUCK_HP),t.partner_handle>0&&(n.xlHp=Math.max(1,t.getValue("partner_fight")/25)),t.pet_handle>0&&(n.petSuckHp=t.getValue("pet_fight")/25*(1+t.getProp(FightAttr.PARTNER_HURT_PRE))),i.id==this.best_skill_id){n.flags=o<<FightType.FIGHT_TYPE_NORMAL;var r=0,a=1,h=e.getProp(FightAttr.DEFENCE);t.getValue("xiuxian_level")>e.getValue("xiuxian_level")&&(r=t.getProp(FightAttr.FT_XIUXIAN_ADD_PRE)),1e4*Math.random()<=t.getProp(FightAttr.FT_BAOJI_RATE)&&(n.flags=o<<FightType.FIGHT_TYPE_BAOJI,a=1.5*(1+1e-4*t.getProp(FightAttr.FT_BAOJI_HURT_PRE))),1e4*Math.random()<=t.getProp(FightAttr.FT_WUSHI_DEFINE_PRE)&&(h=0);var l=t.getProp(FightAttr.ATTACK)+t.getProp(FightAttr.POJIA)-h;return l=Math.max(0,l)*(2e-4*s.role_rate)+i.skill_hurt,l+=10*t.getValue("xiuwei")*(1+1e-4*r)*a,n.normal=l,n.value=l,void(n.spe=!0)}var p=this.getDamageType(t,e);if(n.flags=p,p>>FightType.FIGHT_TYPE_SHANBI&o)return void(n.miss=!0);p>>FightType.FIGHT_TYPE_ZHONGJI&o&&(n.zhongji=!0);var c=t.getProp(FightAttr.ATTACK)+t.getProp(FightAttr.POJIA)-e.getProp(FightAttr.DEFENCE),u=0;if(t.is_main){var d=SkillProxy.ins().getFabaoJjLv(),g=GlobalConfig.getFabaoJjById(d);d>0&&g&&(u=g.skill_damage_per)}c=Math.max(0,c)*(1e-4*(s.role_rate+u))+i.skill_hurt,p>>FightType.FIGHT_TYPE_LIANJI&o&&(n.lianji=c);var y=0,f=p>>FightType.FIGHT_TYPE_QIANGJI&o;f&&(n.qiangji=5*c,y+=5);var _=p>>FightType.FIGHT_TYPE_HUIXIN&o;_&&(n.huixin=2*c,y+=2),p>>FightType.FIGHT_TYPE_BAOJI&o&&(n.baoji=Math.floor(1e-4*(t.getProp(FightAttr.BAOJI_HURT)-e.getProp(FightAttr.KANG_BAOJI_HURT))*(1e4-e.getProp(FightAttr.BAOJI_SUB_PRE)))),n.inner=t.getProp(FightAttr.INNER_HURT)-e.getProp(FightAttr.INNER_SUB_HURT),n.shuchu=t.getProp(FightAttr.OUTPUT_HURT)-e.getProp(FightAttr.OUTPUT_SUB_HURT),c=c*Math.max(1,y)+n.lianji+n.baoji+n.lianji+Math.max(0,n.inner)+Math.max(0,n.shuchu),c=Math.floor(c*(1+1e-4*Math.max(0,t.getProp(FightAttr.HURT_ADD_PRE)-e.getProp(FightAttr.HURT_SUB_PRE)))),p>>FightType.FIGHT_TYPE_GEDAN&o&&(n.gedan=!0,c=Math.floor(c*Math.max(0,1-(.3+1e-4*e.getProp(FightAttr.GEDAND_HURT_PRE))))),f||_||(n.normal=c),c=Math.max(1,c),n.value=c},e}(BaseSystem);__reflect(SkillCC.prototype,"SkillCC");var DamageData=function(){function t(){}return t}();__reflect(DamageData.prototype,"DamageData");var SkillHurtInfo=function(){function t(){this.flags=0,this.value=0}return t.prototype.reset=function(){this.flags=0,this.value=0,this.lianji=0,this.huixin=0,this.baoji=0,this.suckHp=0,this.xlHp=0,this.normal=0,this.qiangji=0,this.shuchu=0,this.inner=0,this.miss=!1,this.gedan=!1,this.zhongji=!1,this.petSuckHp=0,this.spe=!1},t}();__reflect(SkillHurtInfo.prototype,"SkillHurtInfo");var GameSystem;!function(t){t.userSkill=SkillCC.ins.bind(SkillCC)}(GameSystem||(GameSystem={}));var FightType;!function(t){t[t.FIGHT_TYPE_SHANBI=1]="FIGHT_TYPE_SHANBI",t[t.FIGHT_TYPE_NORMAL=2]="FIGHT_TYPE_NORMAL",t[t.FIGHT_TYPE_BAOJI=3]="FIGHT_TYPE_BAOJI",t[t.FIGHT_TYPE_GEDAN=4]="FIGHT_TYPE_GEDAN",t[t.FIGHT_TYPE_QIANGJI=5]="FIGHT_TYPE_QIANGJI",t[t.FIGHT_TYPE_LIANJI=6]="FIGHT_TYPE_LIANJI",t[t.FIGHT_TYPE_HUIXIN=7]="FIGHT_TYPE_HUIXIN",t[t.FIGHT_TYPE_ZHONGJI=8]="FIGHT_TYPE_ZHONGJI"}(FightType||(FightType={}));var SkillDamageData=function(){function t(){this.senderHandle=0,this.skillId=0,this.targetHandle=0,this.skillDamageRanges=[]}return t.prototype.parserClient=function(t,e,i,n,o){if(this.senderHandle=t.handle,this.targetHandle=e.handle,this.skillId=n.id,null!=t)for(var s=0;s<o.length;s++){var r=i[s];if(null==r)return;SkillCC.ins().getDamageValue(t,i[s],n,o[s]);var a=[],h=o[s],l=(h.flags,h.miss);if(l)a.push({type:DamageType.MISS,value:0});else{var p=0!=h.huixin,c=0!=h.qiangji;p&&c&&a.push({type:DamageType.QJHX,value:h.huixin+h.qiangji}),!c&&p&&a.push({type:DamageType.HUIXIN,value:h.huixin}),!p&&c&&a.push({type:DamageType.QIANGJI,value:h.qiangji}),p||c||(h.spe?a.push({type:DamageType.BISHA,value:h.normal}):a.push({type:DamageType.NORMAL,value:h.normal})),0!=h.baoji&&(h.spe?a.push({type:DamageType.SPE_BAOJI,value:h.baoji}):a.push({type:DamageType.BAOJI,value:h.baoji})),0!=h.lianji&&a.push({type:DamageType.LIANJI,value:h.lianji}),h.gedan&&a.push({type:DamageType.GEDAN,value:0}),0!=h.inner&&a.push({type:DamageType.INNER,value:h.inner}),0!=h.shuchu&&a.push({type:DamageType.SHUCHU,value:h.shuchu}),h.zhongji&&a.push({type:DamageType.ZHONGJI,value:0}),0!=h.suckHp&&a.push({type:DamageType.SUCH,value:h.suckHp})}0!=h.xlHp&&a.push({type:DamageType.XL,value:h.xlHp}),0!=h.petSuckHp&&a.push({type:DamageType.PETSHUCHU,value:h.petSuckHp});for(var u=0;u<a.length;u++){var d=a[u],g=egret.getQualifiedClassName(SkillDamageRange),y=ObjectPool.pop(g);y.handle=r.handle,y.type=d.type,y.value=d.value,d.type==DamageType.SUCH||d.type==DamageType.PETSHUCHU?(y.targetPos.x=t.x,y.targetPos.y=t.y-22*u,y.senderPos.x=r.x,y.senderPos.y=r.y):(y.senderPos.x=t.x,y.senderPos.y=t.y,y.targetPos.x=r.x,y.targetPos.y=r.y-22*u),y.part=d.type==DamageType.BISHA||d.type==DamageType.SPE_BAOJI?3:1,this.skillDamageRanges.push(y)}}},t.prototype.parseSuch=function(t,e){this.senderHandle=e,this.targetHandle=e;var i=GameLogic.ins().getEntityByHandle(this.senderHandle),n=GameLogic.ins().getEntityByHandle(this.targetHandle);if(null!=i&&null!=n){var o=egret.getQualifiedClassName(SkillDamageRange),s=ObjectPool.pop(o);s.handle=n.handle,s.type=DamageType.SUCH,s.value=t,s.senderPos.x=i.x,s.senderPos.y=i.y,s.targetPos.x=n.x,s.targetPos.y=n.y,this.skillDamageRanges.push(s)}},t.prototype.parser=function(t){this.senderHandle=t.perform_obj_id,this.targetHandle=t.target_obj_id,this.skillId=t.skill_id;var e=[],i=t.flags,n=1,o=i>>FightType.FIGHT_TYPE_SHANBI&n,s=i>>FightType.FIGHT_TYPE_GEDAN&n,r=i>>FightType.FIGHT_TYPE_ZHONGJI&n,a=t.skill_id==SkillCC.ins().best_skill_id;if(o)e.push({type:DamageType.MISS,value:0});else{var h=0!=t.huixin_blood,l=0!=t.qiangji_blood;h&&l&&e.push({type:DamageType.QJHX,value:t.huixin_blood+t.qiangji_blood}),!l&&h&&e.push({type:DamageType.HUIXIN,value:t.huixin_blood}),!h&&l&&e.push({type:DamageType.QIANGJI,value:t.qiangji_blood}),h||l||(a?e.push({type:DamageType.BISHA,value:t.real_blood}):e.push({type:DamageType.NORMAL,value:t.real_blood})),0!=t.baoji_blood&&(t.spe?e.push({type:DamageType.SPE_BAOJI,value:t.baoji_blood}):e.push({type:DamageType.BAOJI,value:t.baoji_blood})),0!=t.lianji_blood&&e.push({type:DamageType.LIANJI,value:t.lianji_blood}),s&&e.push({type:DamageType.GEDAN,value:0}),0!=t.inner_blood&&e.push({type:DamageType.INNER,value:t.inner_blood}),0!=t.shuchu_blood&&e.push({type:DamageType.SHUCHU,value:t.shuchu_blood}),r&&e.push({type:DamageType.ZHONGJI,value:0})}0!=t.belle_blood&&e.push({type:DamageType.XL,value:t.belle_blood});var p=GameLogic.ins().getEntityByHandle(this.senderHandle),c=GameLogic.ins().getEntityByHandle(this.targetHandle);if(null!=p&&null!=c)for(var u=0;u<e.length;u++){var d=e[u],g=egret.getQualifiedClassName(SkillDamageRange),y=ObjectPool.pop(g);y.handle=c.handle,y.type=d.type,y.value=d.value,y.senderPos.x=p.x,y.senderPos.y=p.y,y.targetPos.x=c.x,y.targetPos.y=c.y-22*u,y.part=d.type==DamageType.BISHA||d.type==DamageType.SPE_BAOJI?3:1,this.skillDamageRanges.push(y)}},t.prototype.reset=function(){this.senderHandle=0,this.skillId=0,this.targetHandle=0;for(var t=0;t<this.skillDamageRanges.length;t++)ObjectPool.push(this.skillDamageRanges[t]);this.skillDamageRanges.length=0},t}();__reflect(SkillDamageData.prototype,"SkillDamageData");var SkillDamageRange=function(){function t(){this.type=0,this.value=0,this.handle=0,this.part=1,this.senderPos=new egret.Point,this.targetPos=new egret.Point}return t}();__reflect(SkillDamageRange.prototype,"SkillDamageRange");var SkillData=function(){function t(){this.skillId=0,this.skillCDTick=0,this.skillLv=0}return t.prototype.isActivate=function(){return this.skillLv>0||this.skillId==SkillCC.ins().normal_skill_id||this.skillId==SkillCC.ins().best_skill_id},t}();__reflect(SkillData.prototype,"SkillData");var SkillFsLvup=function(t){function e(){var e=t.call(this)||this;return e.keysName=["ft_wushi_define_pre","ft_hurt_add_pre","ft_xiuxian_add_pre"],e}return __extends(e,t),e.prototype.initUI=function(){this.addTouchEvent(this.btn_close,this.onClose),this.addTouchEvent(this.btn_lvup,this.onClick)},e.prototype.open=function(){},e.prototype.ShowInfo=function(t){this.cur_id=t;var e=SkillProxy.ins().getRunelv(t),i=GlobalConfig.getFsSkillById(t)[e],n=GlobalConfig.getFsSkillById(t)[e+1];if(this.data_cur=i,this.data_next=n,this.title_cur.textFlow=UtilProxy.StrFormart("C:10&当前:",[]),this.title_next.textFlow=UtilProxy.StrFormart("C:10&下级:",[]),i?(this.icon.source=i.icon,this.skill_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[i.name]),this.skill_lv.textFlow=UtilProxy.StrFormart("C:10&@0 级",[e]),this.txt_cur.textFlow=UtilProxy.StrFormart("C:7&@0 + @1 %",[RoleProxy.keyName[this.keysName[t-1]],i[this.keysName[t-1]]/100])):(this.icon.source=n.icon,this.skill_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[n.name]),this.skill_lv.textFlow=UtilProxy.StrFormart("C:10&@0 级",[e]),this.txt_cur.textFlow=UtilProxy.StrFormart("C:4&未激活",[])),n){this.txt_next.text=UtilProxy.getStr("@0 + @1 %",[RoleProxy.keyName[this.keysName[t-1]],n[this.keysName[t-1]]/100]);var o=BagProxy.ins().getItemData(n.items[0][0]);o&&(this.cost_sp.source=AssetMgr.getIconResource(o.displayid));var s=BagProxy.ins().getItemCountByIDtype(n.items[0][0],BagType.BAG),r=n.items[0][1],a=s>=r?7:4;this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 & @1 /@2 ",[a,s,r]),this.btn_lvup.visible=!0,this.cur_value=s,this.need_value=r}else this.btn_lvup.visible=!1,this.txt_next.text="已满级",this.txt_cost.text=""},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),StageUtils.ins().setFullSize(this.bg0)},e.prototype.onClose=function(){this.visible=!1},e.prototype.onClick=function(t){return this.cur_value<this.need_value?void TipsControl.ins().showTips("道具不足"):void SkillProxy.ins().C2SReqSkillUpgradeRune(this.cur_id)},e}(BaseView);__reflect(SkillFsLvup.prototype,"SkillFsLvup"),window.SkillFsLvup=SkillFsLvup;var SkillGetView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillGetedSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var i=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t.prototype.open.call(this),this.addTouchEvent(this.btn_qq,this.onClcik);var s=1;n&&n.length>0&&(s=n[0]);var r=GlobalConfig.getSkillConfig(s);if(r){var a=GlobalConfig.getSkillDescById(Math.floor(s/1e4));if(a){this.txt_name.text=a.name,this.bg.source=AssetMgr.getIconQualityResource(Number(a.skill_quality)),this.icon.source=a.icon;
var h=3;this.txt_timer.textFlow=UtilProxy.StrFormart("C:7&@0 秒后自动关闭",[h]),TimerManager.ins().doTimer(1e3,3,function(){h-=1,i.txt_timer.textFlow=UtilProxy.StrFormart("C:7&@0 秒后自动关闭",[h]),0>=h&&ViewManager.ins().close(e)},this)}}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_qq,this.onClcik)},e.prototype.onClcik=function(t){TimerManager.ins().removeAll(this),ViewManager.ins().close(e),SkillProxy.ins().checkActiveOpen()},e}(BaseEuiView);__reflect(SkillGetView.prototype,"SkillGetView"),ViewManager.ins().reg(SkillGetView,LayerManager.UI_Open),window.SkillGetView=SkillGetView;var SkillIcon=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){this.imgIcon.source=AssetMgr.getSkillResourceItemName(t)},e.prototype.setSelect=function(t){this.imgSelect.visible=t},e}(BaseItemRender);__reflect(SkillIcon.prototype,"SkillIcon"),window.SkillIcon=SkillIcon;var SkillIconReal=function(t){function e(){var e=t.call(this)||this;return e.isCanOpen=!1,e.skinName="SkillIconSkin",e.addTouchEvent(e.black,e.onclick),e}return __extends(e,t),e.prototype.onclick=function(t){this.data&&this.data.id&&TipsControl.ins().showTips("等级达到"+this.data.grade+"阶开启")},e.prototype.RefreshData=function(){this.data&&this.data.id&&this.setState(this.data)},e.prototype.SetIcon=function(){this.data&&this.data.id&&(this.icon.source=this.data.icon)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.RefreshData(),this.SetIcon()},e.prototype.setState=function(t){var e,i=HuobanProxy.ins().getCurrentPage(),n=!1,o=!0;if(i==HuobanProxy.HuobanType_Horse){n=HorseProxy.ins().isSkillDataOpen(t),this.black.visible=!n;var s=HorseProxy.ins().getSkillLevelById(t.id);0==s?t.grade>HorseProxy.ins().getGrade()&&(o=!1):o=!1;var r=GlobalConfig.getHorseSkillUpgradeConfig(t.id);e=r[(s+1).toString()]}else if(i==HuobanProxy.HuobanType_Pet){n=PetProxy.ins().isSkillDataOpen(t),this.black.visible=!n;var s=PetProxy.ins().getSkillLevelById(t.id);0==s?t.grade>PetProxy.ins().getGrade()&&(o=!1):o=!1;var r=GlobalConfig.getPetSkillUpgradeConfig(t.id);e=r[(s+1).toString()]}else if(i==HuobanProxy.HuobanType_Mate){n=HuobanProxy.ins().isSkillDataOpen(t),this.black.visible=!n;var s=HuobanProxy.ins().getSkillLevelById(t.id);0==s?t.grade>HuobanProxy.ins().getGrade()&&(o=!1):o=!1;var r=GlobalConfig.getMateSkillUpgradeConfig(t.id);e=r[(s+1).toString()]}var a=e&&BagProxy.ins().getItemCountById(e.items[0][0])>=e.items[0][1];this.isCanOpen=o,this.red.visible=n&&(o||a),this.learn.visible=o},e}(BaseItemRender);__reflect(SkillIconReal.prototype,"SkillIconReal"),window.SkillIconReal=SkillIconReal;var SkillItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.resetState(!1)},e.prototype.resetState=function(t){t?(this.bg_off.visible=!1,this.bg_on.visible=!0):(this.bg_off.visible=!0,this.bg_on.visible=!1)},e.prototype.dataChanged=function(){if(void 0!=this.data){var t=(GlobalConfig.getSkillConfig(this.data.id),GlobalConfig.getSkillDescById(Math.floor(this.data.id/1e4))),e=SkillProxy.ins().isActive(this.data.id),i=GlobalConfig.getSkillDescById(Math.floor(this.data.id/1e4));if(i){e?this.txt_name.textFlow=UtilProxy.StrFormart("C:9&@0 .@1 级",[t.name,this.data.id%1e4]):isNaN(Number(t.lyh_level))?this.txt_name.textFlow=UtilProxy.StrFormart("C:9&@0 |C:4&(@1 激活)",[t.name,t.lyh_level]):this.txt_name.textFlow=UtilProxy.StrFormart("C:9&@0 |C:4&(@1 关激活)",[t.name,t.lyh_level]),this.red||(this.red=this.btn_lvup.getChildAt(2)),this.red.visible=SkillProxy.ins().getRedById(this.data.id),this.bg.source=AssetMgr.getIconQualityResource(Number(i.skill_quality)),this.sp.visible=SkillProxy.ins().isSkillUse(this.data.id),this.icon.source=i.icon;var n=this.data.need_exp;n.length>0?n[0][0]:0,n.length>0?n[0][1]:0;this.bar.maximum=SkillProxy.ins().getMaxLv(this.data.id),this.bar.value=SkillProxy.ins().isActive(this.data.id)?this.data.id%1e4:0,this.btn_lvup.visible=e}}},e.prototype.onClick=function(t){switch(t.currentTarget){case this:this.bg_on.visible=!0,this.bg_off.visible=!1;break;case this.btn_lvup:this.bg_on.visible=!0,this.bg_off.visible=!1;var e=ViewManager.ins().getView(SkillView);if(e){var i=e;i.showTips(this.data.id)}}},e}(BaseItemRender);__reflect(SkillItem.prototype,"SkillItem"),window.SkillItem=SkillItem;var SkillLvup=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.addTouchEvent(this.btn_close,this.onClose),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.btn_lvup10,this.onClick),this.red_one=this.btn_lvup.getChildAt(2),this.red_ten=this.btn_lvup10.getChildAt(2)},e.prototype.open=function(){},e.prototype.ShowInfo=function(t){this.red_one.visible=SkillProxy.ins().getRedById(t),this.red_ten.visible=SkillProxy.ins().getTenRedById(t),this.cur_id=t;var e,i,n,o=SkillProxy.ins().getSkillLvById(t),s=SkillProxy.ins().getMaxLv(t),r=SkillProxy.ins().isActive(t);if(r){s>o?(e=GlobalConfig.getLearnSkillConfigById(t),i=GlobalConfig.getLearnSkillConfigById(t+1),n=GlobalConfig.getSkillConfig(t),this.cost_one.text=i.need_exp[0][1],this.cost_ten.text=SkillProxy.ins().getTenCostValue(t).toString(),this.btn_lvup.visible=!0,this.btn_lvup10.visible=!0):(e=GlobalConfig.getLearnSkillConfigById(t),i=GlobalConfig.getLearnSkillConfigById(t),n=GlobalConfig.getSkillConfig(t),this.cost_one.text="已满级",this.cost_ten.text="已满级",this.btn_lvup.visible=!1,this.btn_lvup10.visible=!1),this.txt_fight.text=UtilProxy.GetAttrFight(e).toString();var a=GlobalConfig.getSkillDescById(Math.floor(e.id/1e4));this.bg_pic.source="resource/skins/SkillView/tex/"+a.bg_pic+".png"}else{this.txt_fight.text="0",e=GlobalConfig.getLearnSkillConfigById(t),i=GlobalConfig.getLearnSkillConfigById(t),n=GlobalConfig.getSkillConfig(t),this.cost_one.text=e.need_exp[0][1],this.cost_ten.text=SkillProxy.ins().getTenCostValue(t).toString(),this.btn_lvup.visible=!0,this.btn_lvup10.visible=!0;var a=GlobalConfig.getSkillDescById(Math.floor(i.id/1e4));this.bg_pic.source="resource/skins/SkillView/tex/"+a.bg_pic+".png"}this.learn_cur=e,this.learn_next=i,this.skill_data=n;var h=GlobalConfig.getSkillDescById(Math.floor(n.id/1e4));this.icon.source=h.icon,this.txt_name.text=GlobalConfig.getSkillDescById(Math.floor(e.id/1e4)).name,this.txt_lv.text="等级:"+(r?o:0),this.bar.maximum=s,this.bar.value=r?o:0,this.attr_0.textFlow=UtilProxy.StrFormart("被动属性：|C:7&攻击+@0 ",[e.attack]);var l=GlobalConfig.getFabaoJjById(FabaoProxy.ins().getJjLv());l?this.attr_1.textFlow=UtilProxy.StrFormart("冷却时间：|C:7&@0 (-@1 )秒",[h.cd/1e3,h.cd/1e3/1e4*l.skill_cd_per]):this.attr_1.textFlow=UtilProxy.StrFormart("冷却时间：|C:7&@0 秒",[h.cd/1e3]),this.attr_2.textFlow=UtilProxy.StrFormart("攻击范围：|C:7&@0 个",[h.attack_num]),this.attr_3.textFlow=UtilProxy.StrFormart("C:7&@0 %|伤害倍率|C:7&+@1 |额外伤害",[h.role_rate/100,n.skill_hurt])},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClose=function(){this.visible=!1},e.prototype.onClick=function(t){var e=this.cur_id,i=this.learn_cur;SkillProxy.ins().isActive(this.cur_id)&&(e+=1,i=this.learn_next);var n=i.need_exp[0][0],o=i.need_exp[0][1],s=[];switch(t.currentTarget){case this.btn_lvup:RoleProxy.ins().getMoneyAttr(n)>=o?(s.push({skill_id:e,count:1}),SkillProxy.ins().C2SReqSkillUpgrade(s)):TipsControl.ins().showTips("C:3&真气值不足");break;case this.btn_lvup10:RoleProxy.ins().getMoneyAttr(n)>=SkillProxy.ins().getTenCostValue(this.cur_id)?(s.push({skill_id:e,count:10}),SkillProxy.ins().C2SReqSkillUpgrade(s)):TipsControl.ins().showTips("C:3&真气值不足")}},e}(BaseView);__reflect(SkillLvup.prototype,"SkillLvup"),window.SkillLvup=SkillLvup;var SkillMainItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.resetState=function(t){},e.prototype.dataChanged=function(){if(this.data){var t=this.data.id;this.icon.visible=!0;var e=GlobalConfig.getSkillConfig(t);this.cur_data=e;var i=GlobalConfig.getSkillDescById(Math.floor(t/1e4));this.icon.source=i.icon,this.updateCd()}else this.icon.visible=!1,this.text_cd.text=""},e.prototype.updateCd=function(){},e.prototype.onClick=function(t){},e}(BaseItemRender);__reflect(SkillMainItem.prototype,"SkillMainItem"),window.SkillMainItem=SkillMainItem;var SkillUse=function(t){function e(){var e=t.call(this)||this;return e.addTouchEvent(e,e.onClick),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(void 0!=this.data){this.icon.visible=!0,this.bg_lv.visible=!0,this.lv.text=SkillProxy.ins().getSkillLvById(this.data.id).toString()+"级";var t=(GlobalConfig.getSkillConfig(this.data.id),GlobalConfig.getSkillDescById(Math.floor(this.data.id/1e4)));this.icon.source=t.icon,t&&(this.bg.source=AssetMgr.getIconQualityResource(Number(t.skill_quality)))}else this.icon.visible=!1,this.bg_lv.visible=!1,this.lv.text="",this.bg.source=AssetMgr.getIconQualityResource(Number(1))},e.prototype.onClick=function(){},e}(BaseItemRender);__reflect(SkillUse.prototype,"SkillUse"),window.SkillUse=SkillUse;var SkillView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillViewSkin",e.list2.itemRenderer=SkillItem,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.tips.initUI(),this.uselist=[this.skilluse0,this.skilluse1,this.skilluse2,this.skilluse3,this.skilluse4,this.skilluse5],this.red_lvup=this.btn_lvup.getChildAt(2),this.red_dress=this.btn_dress.getChildAt(2),this.red_sk=this.sys0.getChildAt(2),this.red_fs=this.sys1.getChildAt(2),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&佩戴技能",[]),this.fs_finish.textFlow=UtilProxy.StrFormart("C:7&已满级",[]),this.fs_res=this.btn_fs.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open();var n=0;e&&e.length>0&&(n=e[0]),this.list2.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.addTouchEvent(this.btn_fs,this.onClick),this.addTouchEvent(this.sys0,this.onClick),this.addTouchEvent(this.sys1,this.onClick),this.addTouchEvent(this.btn_close,this.onCloseClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.btn_dress,this.onClick);for(var o=0,s=this.uselist;o<s.length;o++){var r=s[o];this.addTouchEvent(r,this.onClick)}this.tips.visible=!1,EventProxy.AddListener(this,EventType.S2CRepSkillUpdate,this.onSkillUpdate),EventProxy.AddListener(this,EventType.S2CRepSkillUpgradeRune,this.onFsSkillUpdate),EventProxy.AddListener(this,EventType.UpdataMoney,this.onMoneyUpdate),this.openPage(n),this.red_sk.visible=SkillProxy.ins().getSkRed(),this.red_fs.visible=SkillProxy.ins().getFsRed()},e.prototype.openPage=function(t){this.cur_page=t,0==t?(this.page1.visible=!1,this.page0.visible=!0,this.sys0.icon="common_btn_smell_yellow_on",this.sys1.icon="common_btn_smell_yellow_off",this.UpdateListInfo(),this.UpdateUseInfo(),this.UpdateCostInfo(),this.red_lvup.visible=SkillProxy.ins().getOneLvupRed(),this.red_dress.visible=SkillProxy.ins().getOneDressRed(),this.comview.SetName("title_xianshu")):(this.sys1.icon="common_btn_smell_yellow_on",this.sys0.icon="common_btn_smell_yellow_off",this.page1.visible=!0,this.page0.visible=!1,this.updateFsInfo(),this.updateFsXiuweiInfo(),this.fs_res.visible=SkillProxy.ins().getFsRed(),this.comview.SetName("title_wudao"))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.btn_fs,this.onClick),this.removeTouchEvent(this.sys0,this.onClick),this.removeTouchEvent(this.sys1,this.onClick),this.removeTouchEvent(this.btn_close,this.onCloseClick),this.removeTouchEvent(this.btn_lvup,this.onClick),this.removeTouchEvent(this.btn_dress,this.onClick);for(var i=0,n=this.uselist;i<n.length;i++){var o=n[i];this.removeTouchEvent(o,this.onClick)}this.list2.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.RemoveListener(this,EventType.S2CRepSkillUpdate,this.onSkillUpdate),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.onMoneyUpdate),this.fs_mv&&this.fs_mv.parent&&this.fs_mv.parent.removeChild(this.fs_mv),this.fs_mv=null},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onSkillUpdate=function(){this.UpdateListInfo(),this.UpdateUseInfo(),this.red_lvup.visible=SkillProxy.ins().getOneLvupRed(),this.red_dress.visible=SkillProxy.ins().getOneDressRed(),this.tips.visible&&this.showTips(SkillProxy.ins().getSkillIdByStartId(this.cur_lvup_id))},e.prototype.onFsSkillUpdate=function(){this.updateFsInfo(),this.fs_res.visible=SkillProxy.ins().getFsRed(),this.red_fs.visible=SkillProxy.ins().getFsRed();var t=UtilProxy.GetMovieClipById(99,this.page1);t.x=this.page1.width/2,t.y=this.page1.height/2},e.prototype.onMoneyUpdate=function(t){void 0!=t&&(t==MoneyAttr.ZHENQI?(this.UpdateListInfo(),this.UpdateCostInfo(),this.red_lvup.visible=SkillProxy.ins().getOneLvupRed(),this.red_dress.visible=SkillProxy.ins().getOneDressRed(),this.red_sk.visible=SkillProxy.ins().getSkRed()):t==MoneyAttr.XIUWEI||t==MoneyAttr.YUANBAO)},e.prototype.getLvupList=function(t,e){for(var i=[],n=[],o=e,s=0;s<t.length;s++)n.push(t[s].skill_id),i[n.length-1]=0;for(;o>0;){for(var r=0,s=0;s<n.length;s++){var a=SkillProxy.ins().getSkillLvById(n[s]),h=SkillProxy.ins().getMaxLv(n[s]);if(h>a){var l=GlobalConfig.getLearnSkillConfigById(n[s]+1);o>=l.need_exp[0][1]?(o-=l.need_exp[0][1],n[s]=n[s]+1,i[s]=i[s]+1):r+=1}else r+=1}(r>=n.length||0==n.length)&&(o=0)}return i},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_lvup:var e=SkillProxy.ins().getlvupUseList();e.sort(function(t,e){return t.skill_id%1e4-e.skill_id%1e4});for(var i=this.getLvupList(e,RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHENQI)),n=[],o=0;o<e.length;o++)i[o]>0&&n.push({skill_id:e[o].skill_id+1,count:i[o]});n.length>0?SkillProxy.ins().C2SReqSkillUpgrade(n):TipsControl.ins().showTips("没有可以升级的技能了啊");break;case this.btn_dress:for(var s=SkillProxy.ins().getIdList(),r=[],a={},o=0;o<s.length;o++){var h=GlobalConfig.getSkillDescById(Math.floor(s[o]/1e4));h&&h.dress_sort>0&&!a[Math.floor(s[o]/1e4)]&&(a[Math.floor(s[o]/1e4)]=!0,r.push({id:s[o],sort:h.dress_sort}))}r.sort(function(t,e){return t.sort-e.sort});for(var l=[],o=0;o<r.length;o++)if(6>o){var p=r[o];l.push({skill_id:p.id,slot:o+1})}l.length>0&&SkillProxy.ins().C2SReqSkillUse(l);break;case this.sys0:this.openPage(0);break;case this.sys1:this.openPage(1);break;case this.skilluse0:case this.skilluse1:case this.skilluse2:case this.skilluse3:case this.skilluse4:case this.skilluse5:void 0!=t.currentTarget.data?this.showTips(t.currentTarget.data.id):TipsControl.ins().showTips("C:10&该栏位没有技能");break;case this.btn_fs:if(!this.fs_nex_data)return void TipsControl.ins().showTips("c:1&焚天技能满级了");var c=BagProxy.ins().getItemCountByIDtype(this.fs_nex_data.items[0][0],BagType.BAG),u=this.fs_nex_data.items[0][1];if(u>c)return void TipsControl.ins().showTips("道具不足");SkillProxy.ins().C2SReqSkillUpgradeRune(2)}},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;void 0!=e&&(void 0!=this.cur_select_skill_item&&this.cur_select_skill_item.resetState(!1),this.cur_select_skill_item=e,e.resetState(!0))},e.prototype.UpdateUseInfo=function(){for(var t=0;t<this.uselist.length;t++){var e=SkillProxy.ins().getSkillIdByIndex(t+1);e>0?this.uselist[t].data=GlobalConfig.getSkillConfig(e):this.uselist[t].data=void 0}},e.prototype.UpdateListInfo=function(){if(this.zhanValue.text=this.getSkillFight().toString(),this.array){for(var t=SkillProxy.ins().getInitSkillList(),e=[],i=void 0,n=0;n<t.length;n++)i=GlobalConfig.getLearnSkillConfigById(SkillProxy.ins().getSkillIdByStartId(t[n])),e.push(i);this.array.replaceAll(e)}else{this.array=new eui.ArrayCollection,this.list2.dataProvider=this.array;for(var t=SkillProxy.ins().getInitSkillList(),i=void 0,n=0;n<t.length;n++)i=GlobalConfig.getLearnSkillConfigById(SkillProxy.ins().getSkillIdByStartId(t[n])),this.array.addItem(i)}},e.prototype.updateFsInfo=function(){this.fs_mv||(this.fs_mv=UtilProxy.GetMovieClipById(86,this.fs_eff),this.fs_mv.x=this.fs_eff.width/2,this.fs_mv.y=this.fs_eff.height/2),this.fs_remark.textFlow=UtilProxy.StrFormart("C:1&每次悟道后可对焚天仙决进行伤害提升",[]);var t=GlobalConfig.getSkillConfig(SkillCC.ins().best_skill_id),e=GlobalConfig.getSkillDescById(Math.floor(t.id/1e4)),i=SkillProxy.ins().getRunelv(2);this.fs_lv.textFlow=UtilProxy.StrFormart("C:10&@0 ",[i]);var n=GlobalConfig.getFsSkillById(2)[i],o=GlobalConfig.getFsSkillById(2)[i+1];this.fs_nex_data=o;var s=AttrProxy.getContAttrInfo(n,o),r="",a="";if(s.length>0&&(r="C:10&"+s[0][0]+"|C:7&+"+s[0][1],a="C:10&"+s[0][0]+"|C:7&+"+(0==s[0][2]?"已满级":s[0][2])),this.fs_cur_pro.textFlow=UtilProxy.StrFormart(r,[]),this.fs_next_pro.textFlow=UtilProxy.StrFormart(a,[]),o){var h=BagProxy.ins().getItemCountByIDtype(o.items[0][0],BagType.BAG),l=o.items[0][1],p=h>=l?7:4;this.fs_cost.textFlow=UtilProxy.StrFormart("C:@0 & @1 /@2 ",[p,h,l]),this.btn_fs.visible=!0,this.fs_finish.visible=!1}else this.fs_cost.text="",this.btn_fs.visible=!1,this.fs_finish.visible=!0;n?this.zhanValue0.text=(10*(n.ft_hurt_add_pre||0)).toString():this.zhanValue0.text="0",this.fs_pro1.textFlow=UtilProxy.StrFormart("C:7&@0 %|攻击伤害 + |@1 %|修为值 (",[e.role_rate/100,e.xiuwei_rate/100]),this.fs_pro3.textFlow=UtilProxy.StrFormart("C:7&满100怒气施放，每次攻击添加1怒气",[])},e.prototype.updateFsXiuweiInfo=function(){this.fs_pro2.textFlow=UtilProxy.StrFormart("C:10&@0 )|伤害",[XiuXianProxy.ins().achie_value])},e.prototype.UpdateCostInfo=function(){this.txt_money_value.text=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHENQI).toString()},e.prototype.showTips=function(t){this.tips&&(this.cur_lvup_id=t,this.tips.visible=!0,this.tips.ShowInfo(t))},e.prototype.getSkillFight=function(){return SkillProxy.ins().getSkillFight()},e}(BaseEuiView);__reflect(SkillView.prototype,"SkillView"),ViewManager.ins().reg(SkillView,LayerManager.UI_Main),window.SkillView=SkillView;var SpeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpeViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.updateInfo()},e.prototype.updateInfo=function(){this.bg.alpha=1,this.gp_top.x=480,this.gp_top.y=-265,this.gp_top.alpha=.78,egret.Tween.get(this.gp_top).to({x:0,y:0,alpha:1},600,egret.Ease.backInOut).call(function(){}).wait(500).to({x:480,y:-300,alpha:0},500,egret.Ease.backOut).wait(200).call(function(){ViewManager.ins().close(e)}),egret.Tween.get(this.bg).wait(1e3).to({alpha:0},200)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];egret.Tween.removeTweens(this.bg),egret.Tween.removeTweens(this.gp_top)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e}(BaseEuiView);__reflect(SpeView.prototype,"SpeView"),ViewManager.ins().reg(SpeView,LayerManager.UI_Tips),window.SpeView=SpeView;var SmeltItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.add.visible=!0,this.ShowRed(!1)},e.prototype.setSkinName=function(){this.skinName="SmeltItemSkin"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(e&&e.itemConfig){var i=e.itemConfig;i&&(this.add.visible=!1,this.smeltvlaue.text="+"+i.melt),this.effect&&SmeltProxy.ins().IsShowEff&&UtilProxy.GetMovieClipById(3,this.effect)}else this.clear()},e.prototype.clear=function(){t.prototype.clear.call(this),this.smeltvlaue.visible=!1,this.add.visible=!0},e}(ItemCell);__reflect(SmeltItem.prototype,"SmeltItem"),window.SmeltItem=SmeltItem;var SmeltView=function(t){function e(){var e=t.call(this)||this;return e.curIndex=0,e.num=12,e.isInTimer=!1,e.qhsId=30001,e.showlevel=0,e.totleleftcount=0,e.curleftCount=0,e.showexp=0,e.IsOnekey=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SmeltSkin",this.comview.initUI(),this.comview.SetName("title_ronglian"),this.btns=[this.b1,this.b2,this.b3],GlobalConfig.getLimitsConfig(1).vip_melt_limit>18?this.tips.textFlow=UtilProxy.StrFormart("|C:10&svip@0 |",[GlobalConfig.getLimitsConfig(1).vip_melt_limit-18]):this.tips.textFlow=UtilProxy.StrFormart("|C:10&vip@0 |",[GlobalConfig.getLimitsConfig(1).vip_melt_limit]),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&熔炼成功|"),this.tipslab.textFlow=UtilProxy.generateTextFlow("|C:4&今日熔炼已达上限,不再获得强化石|"),this.s_list.itemRenderer=SmeltItem,this.exp.value=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open();for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onBtnClick);this.addTouchEvent(this.smeltbtn,this.onSmeltClick),this.addTouchEvent(this.closebtn,this.onCloseTipsClick),this.addTouchEvent(this.btn0,this.onCloseTipsClick),this.addTouchEvent(this.closebtn0,this.onCloseClick),this.addTouchEvent(this.tipsbtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepMeltMelt,this.StarSmelt),this.showlevel=SmeltProxy.ins().melt_level,this.showexp=SmeltProxy.ins().melt_exp,this.totleleftcount=GlobalConfig.getLimitsConfig(1).melt_limit-SmeltProxy.ins().melt_count,this.curleftCount=this.totleleftcount,this.smeltList=[],this.smeltList=BagProxy.ins().getSmeltList(),this.endtips.visible=!1,this.ShowSmeltInfo(),this.SetMeltLevelInfo(this.showlevel,this.showexp)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onBtnClick);this.removeTouchEvent(this.smeltbtn,this.onSmeltClick),this.removeTouchEvent(this.closebtn,this.onCloseTipsClick),this.removeTouchEvent(this.btn0,this.onCloseTipsClick),this.removeTouchEvent(this.closebtn0,this.onCloseClick),this.removeTouchEvent(this.tipsbtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepMeltMelt,this.StarSmelt),TimerManager.ins().removeAll(this),this.curIndex=0,SmeltProxy.ins().IsShowEff=!1},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){switch(t.currentTarget){case this.b2:ViewManager.ins().close(this),ViewManager.ins().open(MakeView,1);break;case this.b3:ViewManager.ins().close(this),ViewManager.ins().open(MakeView,2);break;case this.tipsbtn:ViewManager.ins().close(this),ViewManager.ins().open(FirstRechargeView)}},e.prototype.onCloseTipsClick=function(t){this.endtips.visible=!1},e.prototype.onSmeltClick=function(t){if(!this.isInTimer&&0!=this.smeltList.length){var e=[];this.IsOnekey=BagProxy.ins().IsOneKeySmeltOpen();for(var i=this.IsOnekey?this.smeltList.length:this.num,n=0;n<this.smeltList.length;n++)i>n&&e.push(this.smeltList[n].item_slot_idx);SmeltProxy.ins().C2SReqMeltMelt(e)}},e.prototype.StarSmelt=function(){this.isInTimer=!0;var t=1;this.IsOnekey&&(t=Math.ceil(this.smeltList.length/this.num)+1),this.curIndex=0,SmeltProxy.ins().IsShowEff=!0,TimerManager.ins().doTimer(200,t,this.singleShowSmelt,this,this.finshShow,this)},e.prototype.singleShowSmelt=function(){this.ShowSmeltInfo();for(var t=this.getCurSmeltList(),e=0;e<t.length;e++)if(t[e].item_type_id>0){var i=t[e].itemConfig;this.curleftCount=this.curleftCount-this.getCutNum(i),this.showexp=this.showexp+i.melt;var n=GlobalConfig.getMelt_dataConfig(this.showlevel);void 0!=n&&n.exp>0&&this.showexp>n.exp&&(this.showlevel=this.showlevel+1,this.showexp=this.showexp-n.exp)}this.SetMeltLevelInfo(this.showlevel,this.showexp),this.curIndex=this.curIndex+1},e.prototype.getCutNum=function(t){for(var e=0,i=0;i<t.melt_item.length;i++)t.melt_item[i][0]>100&&(e=t.melt_item[i][1]);return e},e.prototype.finshShow=function(){this.isInTimer=!1,this.money.visible=this.isInTimer,this.smeltbtn.visible=!this.isInTimer,SmeltProxy.ins().IsShowEff=!1,this.SetMeltLevelInfo(SmeltProxy.ins().melt_level,SmeltProxy.ins().melt_exp),this.ShowEndTips(),this.IsOnekey=!1},e.prototype.SetMeltLevelInfo=function(t,e){this.level.textFlow=UtilProxy.StrFormart("|C:10&熔炼等级：@0 |",[t]);var i=GlobalConfig.getMelt_dataConfig(t);if(void 0!=i){this.exp.maximum=i.exp,this.exp.value=e;var n="",o=AttrProxy.getAttrInfo(i);if(void 0!=o)for(var s=0;s<o.length;s++)n+=UtilProxy.getStr("@0  |C:7&+@1 |      ",[o[s][2],o[s][1]]);this.info.textFlow=UtilProxy.generateTextFlow(n),this.zhanValue.text=UtilProxy.GetAttrFight(i).toString()}this.tipslab.visible=this.curleftCount<=0},e.prototype.ShowEndTips=function(){this.IsOnekey&&(this.endtips.visible=!0);var t=[],e=[];this.IsOnekey=BagProxy.ins().IsOneKeySmeltOpen();for(var i=this.IsOnekey?this.smeltList.length:this.num,n=0;n<this.smeltList.length;n++)i>n?t.push(this.smeltList[n]):e.push(this.smeltList[n]);var o=this.getSmeltVlaue(t,this.totleleftcount);this.explab.visible=void 0!=o[MoneyAttr.EXP],this.pic_1.visible=void 0!=o[MoneyAttr.EXP],void 0!=o[MoneyAttr.EXP]&&(this.explab.text="经验+"+o[MoneyAttr.EXP].toString()),void 0!=o[MoneyAttr.COIN]&&(this.jblab.text="金币+"+o[MoneyAttr.COIN].toString()),this.qhslab.visible=void 0!=o[this.qhsId],this.pic_3.visible=void 0!=o[this.qhsId],void 0!=o[this.qhsId]&&(this.qhslab.text="强化石+"+o[this.qhsId].toString()),this.smeltList=[],this.smeltList=e,this.ShowSmeltInfo()},e.prototype.ShowSmeltInfo=function(){this.money.visible=this.isInTimer,this.smeltbtn.visible=!this.isInTimer,this.smeltbtn.label=BagProxy.ins().IsOneKeySmeltOpen()?"一键熔炼":"熔炼",this.smeltbtn.icon=BagProxy.ins().IsOneKeySmeltOpen()?"common_btn_big_yellow":"common_btn_big_blue",this.smeltbtn.x=BagProxy.ins().IsOneKeySmeltOpen()?194:113,this.tipg.visible=!BagProxy.ins().IsOneKeySmeltOpen(),UtilProxy.shield&&(this.tipg.visible=!1),this.smelt_array||(this.smelt_array=new eui.ArrayCollection,this.s_list.dataProvider=this.smelt_array);var t=this.getCurSmeltList();this.smelt_array.removeAll();for(var e in t)this.smelt_array.addItem(t[e]);var i=this.getSmeltVlaue(this.getCurSmeltList(),this.curleftCount);void 0!=i[MoneyAttr.EXP]&&(this.explab0.text="经验+"+i[MoneyAttr.EXP].toString()),void 0!=i[MoneyAttr.COIN]&&(this.jblab0.text="金币+"+i[MoneyAttr.COIN].toString()),this.qhslab0.visible=void 0!=i[this.qhsId],this.pic_5.visible=void 0!=i[this.qhsId],void 0!=i[this.qhsId]&&(this.qhslab0.text="强化石+"+i[this.qhsId].toString())},e.prototype.getSmeltVlaue=function(t,e){for(var i=[],n=0,o=0;o<t.length;o++)if(t[o].item_type_id>0){var s=t[o].itemConfig,r=s.melt_item;n+=this.getCutNum(s),0>=e-n&&(r=s.limit_melt_item);for(var a=0;a<r.length;a++)void 0!=r[a][0]&&(void 0==i[r[a][0]]?i[r[a][0]]=r[a][1]:i[r[a][0]]=i[r[a][0]]+r[a][1])}return i},e.prototype.getCurSmeltList=function(){for(var t=[],e=0;e<this.num;e++){var i=e+this.num*this.curIndex;if(void 0!=this.smeltList[i]){var n=new ItemCellData;n=this.smeltList[i],t[e]=n}else{var n=new ItemCellData;n.item_slot_idx=e+1,t[e]=n}}return t},e}(BaseEuiView);__reflect(SmeltView.prototype,"SmeltView"),ViewManager.ins().reg(SmeltView,LayerManager.UI_Main),window.SmeltView=SmeltView;var StoreItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreItemSkin",e.selectIcon.visible=!1,e.openInfo.text="",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;if(void 0!=e){var i=(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),n=RoleProxy.ins().getMoneyAttr(e.type);if(i<e.vip_level)return void TipsControl.ins().showTips("VIP等级不足！");if(n<e.price)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(e.type)+"不足！");var o=StoreProxy.ins().getLimitCount(Math.floor(e.id/1e3),e.id);return e.max_buy>0&&o>=e.max_buy?void TipsControl.ins().showTips("兑换次数不足！"):void EventProxy.Broast(EventType.ShowStoreBuyTips,[e])}},e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.item_id,item_count:t.item_count};e.setItemCellData(i),this.cell.data=e,this.btn.label=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑 换":"购 买",this.value1.textFlow=UtilProxy.generateTextFlow("现价:"+UtilProxy.getSimpleNum(t.price)),t.show_price>0?(this.discountG.visible=!0,this.discount.source=t.mark,this.icon2.source=UtilProxy.getMoneyIcon(t.type),this.value2.textFlow=UtilProxy.generateTextFlow("C:11&原价:|"+UtilProxy.getSimpleNum(t.show_price))):(this.discountG.visible=!1,this.discount.visible=!1),this.icon1.source=UtilProxy.getMoneyIcon(t.type),this.item_name.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(e.itemConfig.quality)+"&"+e.itemConfig.name),this.refresh()}},e.prototype.refresh=function(){var t=this.data;if(t.max_buy>0){var e=StoreProxy.ins().getLimitCount(Math.floor(t.id/1e3),t.id);e>=t.max_buy?(this.finish.visible=!0,this.num.textFlow=UtilProxy.generateTextFlow("C:4&(0/"+t.max_buy+")")):(this.finish.visible=!1,this.num.textFlow=UtilProxy.generateTextFlow("C:7&("+(t.max_buy-e)+"/"+t.max_buy+")"))}else this.num.text="",this.finish.visible=!1;var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);i<t.vip_level?this.openInfo.text="VIP"+t.vip_level+"开启":this.openInfo.text=""},e.prototype.Update=function(){this.selected!=this.selectIcon.visible&&(this.selectIcon.visible=this.selected)},e}(BaseItemRender);__reflect(StoreItem.prototype,"StoreItem"),window.StoreItem=StoreItem;var StoreItem1=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreItem1Skin",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;if(void 0!=e){var i=(RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)),n=RoleProxy.ins().getMoneyAttr(e.type);if(i<e.vip_level)return void TipsControl.ins().showTips("VIP等级不足！");if(n<e.price)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(e.type)+"不足！");var o=StoreProxy.ins().getLimitCount(Math.floor(e.id/1e3),e.id);return e.max_buy>0&&o>=e.max_buy?void TipsControl.ins().showTips("兑换次数不足！"):void EventProxy.Broast(EventType.ShowStoreBuyTips,[e])}},e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.item_id,item_count:t.item_count};e.setItemCellData(i),this.cell.data=e,this.btn.label=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑 换":"购 买",this.value1.textFlow=UtilProxy.generateTextFlow("现价:"+UtilProxy.getSimpleNum(t.price)),t.shopType==StoreType.vip?(this.vipG.visible=!0,this.vipLabel.text=t.vip_level.toString(),this.item_name.text=""):(this.vipG.visible=!1,this.item_name.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(e.itemConfig.quality)+"&"+e.itemConfig.name)),t.show_price>0?(this.discountG.visible=!0,this.discount.source=t.mark,this.icon0.source=UtilProxy.getMoneyIcon(t.type),this.value0.textFlow=UtilProxy.generateTextFlow("C:11&原价:|"+UtilProxy.getSimpleNum(t.show_price))):(this.discountG.visible=!1,this.discount.visible=!1),this.icon1.source=UtilProxy.getMoneyIcon(t.type),this.refresh()}},e.prototype.refresh=function(){var t=this.data,e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);if(t.max_buy>0){var i=StoreProxy.ins().getLimitCount(Math.floor(t.id/1e3),t.id);i>=t.max_buy?(this.num.textFlow=UtilProxy.generateTextFlow((t.shopType==StoreType.vip?"每周":"")+"|C:4&(0/"+t.max_buy+")"),this.btn.setRed(!1)):(this.num.textFlow=UtilProxy.generateTextFlow((t.shopType==StoreType.vip?"每周":"")+"|C:7&("+(t.max_buy-i)+"/"+t.max_buy+")"),this.btn.setRed(e>=t.vip_level))
}else this.num.text=""},e}(BaseItemRender);__reflect(StoreItem1.prototype,"StoreItem1"),window.StoreItem1=StoreItem1;var StoreView=function(t){function e(){var e=t.call(this)||this;return e.currentStoreIndex=-1,e.buy_num=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="StoreViewSkin",this.comview.initUI(),this.list.itemRenderer=StoreItem,this.scroller.viewport=this.list,this.list0.itemRenderer=StoreItem1,this.scroller0.viewport=this.list0,this.list.dataProvider=new eui.ArrayCollection,this.list0.dataProvider=new eui.ArrayCollection,this.tips.visible=!1,this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),GlobalConfig.getConfig("store","storeConfig");for(var i=StoreProxy.ins().getStoreConfigByStoreType("1"),n=0;n<this.sbtnList.length;++n)2==i[n].id&&UtilProxy.shield&&(this.sbtnList[n].visible=!1,this.sbtnList[n].includeInLayout=!1),this.addTouchEvent(this.sbtnList[n],this.onMenuClick),this.sbtnList[n].label=i[n]._name;this.addTouchEvent(this.refreshBtn,this.onRefreshClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.enterBtn,this.onBuyClick),this.addTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.addTouchEvent(this.tipsAdd,this.onTipsNumClick),this.addTouchEvent(this.tipsAddten,this.onTipsNumClick),this.addTouchEvent(this.tipsLess,this.onTipsNumClick),this.addTouchEvent(this.tipsLessten,this.onTipsNumClick),this.addItemTapEvent(this.list,this.SkinItemClick),EventProxy.AddListener(this,EventType.S2CRepStoreBuy,this.S2CRepStoreBuy),EventProxy.AddListener(this,EventType.ShowStoreBuyTips,this.ShowStoreBuyTips),EventProxy.AddListener(this,EventType.S2CRepStoreRefresh,this.S2CRepStoreRefresh),EventProxy.AddListener(this,EventType.S2CRepStoreGetInfo,this.S2CRepStoreGetInfo),EventProxy.AddListener(this,EventType.RefreshStoreRed,this.RefreshStoreRed),this.initItemId=t[1],this.setCurrentStore(t[0]?t[0]+1:1),this.setRed()},e.prototype.onMenuClick=function(t){var e=this.sbtnList.lastIndexOf(t.currentTarget);this.setCurrentStore(e+1)},e.prototype.onRefreshClick=function(t){var e=this.currentStoreIndex;if(StoreProxy.ins().getRefreshTimesById(e)>0){var i=GlobalConfig.getStoreConfig(e);RoleProxy.ins().getMoneyAttr(i.need_curr[0])>=i.need_curr[1]?StoreProxy.ins().C2SReqStoreRefresh(e):TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(i.need_curr[0])+"不足！")}else TipsControl.ins().showTips("次数不足！")},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.onMenuClick);this.removeTouchEvent(this.refreshBtn,this.onRefreshClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.enterBtn,this.onBuyClick),this.removeTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.removeTouchEvent(this.tipsAdd,this.onTipsNumClick),this.removeTouchEvent(this.tipsAddten,this.onTipsNumClick),this.removeTouchEvent(this.tipsLess,this.onTipsNumClick),this.removeTouchEvent(this.tipsLessten,this.onTipsNumClick),this.removeItemTapEvent(this.list,this.SkinItemClick),EventProxy.RemoveListener(this,EventType.S2CRepStoreBuy,this.S2CRepStoreBuy),EventProxy.RemoveListener(this,EventType.ShowStoreBuyTips,this.ShowStoreBuyTips),EventProxy.RemoveListener(this,EventType.S2CRepStoreRefresh,this.S2CRepStoreRefresh),EventProxy.RemoveListener(this,EventType.S2CRepStoreGetInfo,this.S2CRepStoreGetInfo),EventProxy.RemoveListener(this,EventType.RefreshStoreRed,this.RefreshStoreRed),TimerManager.ins().removeAll(this),this.currentStoreIndex=-1},e.prototype.setCurrentStore=function(t,e){if(void 0===e&&(e=!1),this.currentStoreIndex!=t||e){this.currentStoreIndex=t;for(var i=StoreProxy.ins().getStoreConfigByStoreType("1"),n=i[t-1],o=n.id,s=0;s<this.sbtnList.length;++s)this.sbtnList[s].icon="common_btn_smell_yellow_off";this.sbtnList[this.currentStoreIndex-1].icon="common_btn_smell_yellow_on";for(var r=new Array,s=0;s<StoreProxy.ins().item_list.length;++s)if(StoreProxy.ins().item_list[s].store_id==o)for(var a=0;a<StoreProxy.ins().item_list[s].items.length;++a){var h=StoreProxy.ins().item_list[s].items[a].item_id;r.push(GlobalConfig.getStore_cellConfig(h))}var l=function(t,e){return t.vip_level>e.vip_level?1:-1},p=function(t,e){return t.id>e.id?1:-1},c=n._name;this.scroller.visible=o!=StoreType.vip&&o!=StoreType.week,this.scroller0.visible=!(o!=StoreType.vip&&o!=StoreType.week),o!=StoreType.vip&&o!=StoreType.week?(r.sort(p),this.list.dataProvider=new eui.ArrayCollection(r)):(t==StoreType.vip?r.sort(l):r.sort(p),this.list0.dataProvider=new eui.ArrayCollection(r)),this.setRefreshData(),this.comview.SetName(UtilProxy.getTitleName(c)),this.bg.source="resource/skins/StoreView/"+n.head_bg+".jpg",this.initItemId=void 0}},e.prototype.SkinItemClick=function(t){for(var e=t.itemRenderer,i=0;i<this.list.numChildren;++i){var n=this.list.getChildAt(i);void 0!=n&&(n.selectIcon.visible=!1)}e.selectIcon.visible=!0},e.prototype.S2CRepStoreBuy=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tips.visible=!1;var i=t[0],n=t[1],o=StoreProxy.ins().getStoreConfigByStoreType("1"),s=o[this.currentStoreIndex-1];if(s.id!=StoreType.vip&&s.id!=StoreType.week)for(var r=0;r<this.list.numChildren;++r){var a=this.list.getChildAt(r);if(void 0!=a&&void 0!=a.data){var h=a.data;StoreProxy.ins().getStoreId(i,h.id)==n&&a.refresh()}}else for(var r=0;r<this.list0.numChildren;++r){var l=this.list0.getChildAt(r);if(void 0!=l&&void 0!=l.data){var h=l.data;StoreProxy.ins().getStoreId(i,h.id)==n&&l.refresh()}}},e.prototype.RefreshStoreRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRed()},e.prototype.S2CRepStoreRefresh=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRefreshData(),this.setCurrentStore(this.currentStoreIndex,!0),this.setRed()},e.prototype.setRefreshData=function(){var t=StoreProxy.ins().getStoreConfigByStoreType("1"),e=t[this.currentStoreIndex-1];this.refresh_bg.visible=e.id!=StoreType.vip&&e.id!=StoreType.week,0==e.refresh?this.refreshG.visible=!1:(this.refreshG.visible=!0,this.value.text=e.need_curr[1],this.icon.source=UtilProxy.getMoneyIcon(e.need_curr[0]),TimerManager.ins().doTimer(500,0,this.refreshTime,this),this.refreshTime())},e.prototype.refreshTime=function(){var t=StoreProxy.ins().getStoreConfigByStoreType("1"),e=t[this.currentStoreIndex-1];if(1==e.refresh){var i=StoreProxy.ins().getRefreshTimeById(e.id);i>=0&&(this.time.text="刷新倒计时： "+UtilProxy.getTimeHMSString(Math.max(i,0)))}},e.prototype.S2CRepStoreGetInfo=function(){this.setCurrentStore(this.currentStoreIndex)},e.prototype.onBuyClick=function(t){void 0!=this.current_store_data&&(StoreProxy.ins().C2SReqStoreBuy(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id,this.buy_num),this.tips.visible=!1)},e.prototype.onCloseTipsClick=function(t){this.tips.visible=!1},e.prototype.onTipsNumClick=function(t){if(void 0!=this.current_store_data){var e=this.current_store_data.max_buy,i=StoreProxy.ins().getLimitCount(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id),n=Math.floor(RoleProxy.ins().getMoneyAttr(this.current_store_data.type)/this.current_store_data.price);e>0?(e-=i,e=Math.min(e,n)):e=n;var o=this.buy_num;switch(t.currentTarget){case this.tipsAdd:o+1>e?TipsControl.ins().showTips("已达上限！"):o+=1;break;case this.tipsAddten:o+1>e?TipsControl.ins().showTips("已达上限！"):o=Math.min(e,o+10);break;case this.tipsLess:o=Math.max(1,o-1);break;case this.tipsLessten:o=Math.max(1,o-10)}this.buy_num=o,this.tipsNum.text=this.buy_num.toString()}},e.prototype.ShowStoreBuyTips=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.current_store_data=i,this.buy_num=1,this.tips.visible=!0,this.tipsNum.text=""+i.max_buy,this.tipsNum.text=this.buy_num.toString();var n=new ItemCellData,o={item_slot_idx:0,item_type_id:i.item_id,item_count:1};n.setItemCellData(o),this.cell.data=n,this.itemName.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(n.itemConfig.quality)+"&"+n.itemConfig.name),this.tipsInfo.textFlow=UtilProxy.generateTextFlow(n.itemConfig.TIPS)},e.prototype.setRed=function(){this.sbtn1.setRed(StoreProxy.ins().getStoreRedByType(StoreType.vip))},e}(BaseEuiView);__reflect(StoreView.prototype,"StoreView"),ViewManager.ins().reg(StoreView,LayerManager.UI_Main),window.StoreView=StoreView;var SuperInvestItem=function(t){function e(){var e=t.call(this)||this;return e.strs=["累计登陆@0 天可领取","累计击杀@0 个野外Boss可领取","角色达到@0 级可领取","累计登陆@0 天可领取"],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick),this.awardlist.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="KaifuAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data,e=UtilProxy.getStr(this.strs[t.param_type-1],[t.params]),i=WelfareProxy.ins().getInvenstCurValue(t.id);this.tips.textFlow=UtilProxy.StrFormart("@0 |C:@1 &(@2 /@3 )|",[e,i>=t.params?7:4,i,t.params]);var n=WelfareProxy.ins().getInvenstAwardHasGet(t.id,t.index);this.btn.visible=!n,this.hasget.visible=n,this.red.visible=WelfareProxy.ins().getInvenstHasBuy(t.id)&&i>=t.params&&!n,this.arry||(this.arry=new eui.ArrayCollection,this.awardlist.dataProvider=this.arry),this.arry.removeAll();for(var o=0;o<t.awards.length;o++){var s=UtilProxy.GetItemCellData(t.awards[o][0],t.awards[o][1]);this.arry.addItem(s)}},e.prototype.onClick=function(t){var e=this.data;if(!WelfareProxy.ins().getInvenstHasBuy(e.id))return void TipsControl.ins().showTips("您还未购买投资");if(WelfareProxy.ins().getInvenstAwardHasGet(e.id,e.index))return void TipsControl.ins().showTips("您已经领取奖励");var i=WelfareProxy.ins().getInvenstCurValue(e.id);if(i<e.params){var n=GlobalConfig.getInvenst_dataConfig(e.id);return void(n.open_view.length>0?ViewManager.ins().OpenViewById(n.open_view[0],n.open_view[1]):TipsControl.ins().showTips("目标尚未达成"))}WelfareProxy.ins().C2SReqWelfareInvenstGetAward(e.id,e.index),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(SuperInvestItem.prototype,"SuperInvestItem"),window.SuperInvestItem=SuperInvestItem;var SuperInvestView=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SuperInvestSkin",this.list.itemRenderer=SuperInvestItem,this.btns=[this.btn0,this.btn1,this.btn2,this.btn3],this.buybtn.label=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑 换":"购 买"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=-1,n=0;n<this.btns.length;n++)this.addTouchEvent(this.btns[n],this.onbtnClick),this.btns[n].visible=GlobalConfig.getInvenst_dataConfig(n+1).server_open_day<=LimitActProxy.ins().GetServerOpenDay(),this.btns[n].visible&&-1==i&&(i=n);this.addTouchEvent(this.buybtn,this.onBuyBtnClick),EventProxy.AddListener(this,EventType.S2CRspWelfareInvenstGetInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRspWelfareInvenstBuy,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRspWelfareInvenstGetAward,this.ShowInfo),t[0]&&this.btns[t[0]]&&this.btns[t[0]].visible&&(i=t[0]),this.SetBtnIndex(i)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);this.removeTouchEvent(this.buybtn,this.onBuyBtnClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareInvenstGetInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRspWelfareInvenstBuy,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRspWelfareInvenstGetAward,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){var e=this.btns.indexOf(t.currentTarget);this.SetBtnIndex(e)},e.prototype.onBuyBtnClick=function(t){var e=GlobalConfig.getInvenst_dataConfig(this.curType);if(void 0!=e){if(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)<e.vip_level)return void TipsControl.ins().showTips("请先提升VIP等级");if(RoleProxy.ins().getMoneyAttr(e.money[0])<e.money[1])return TipsControl.ins().showTips("元宝不足"),void NoticeProxy.ins().OpenRecharge();var i=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?"兑换":"购买",n=UtilProxy.getStr("您确定要消耗|C:7&@0 @1 |@3 @2 吗?",[e.money[1],BagProxy.ins().getItemName(e.money[0]),e.name,i]);TipsControl.ins().ShowTips1(n,function(){},function(){WelfareProxy.ins().C2SReqWelfareInvenstBuy(e.id)})}},e.prototype.SetBtnIndex=function(t){0!=this.btns[t].visible&&(this.curbtn&&(this.curbtn.getChildAt(1).visible=!1),this.curbtn=this.btns[t],this.curbtn.getChildAt(1).visible=!0,this.curType=t+1,this.ShowInfo())},e.prototype.ShowInfo=function(){this.bg.source="resource/skins/SuperInvest/chaojitouzi_banner_0"+this.curType+".jpg";var t=GlobalConfig.getInvenst_dataConfig(this.curType);if(void 0!=t){this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.removeAll();var e=GlobalConfig.getInvenstAwardDataConfigs(this.curType),i=[];for(var n in e)i.push(e[n]);i.sort(this.sortlist);for(var n in i)this.array.addItem(i[n]);this.SetBtnRed(),this.endtime=WelfareProxy.ins().getInvenstEndTimeByType(this.curType),-1!=this.endtime?(this.timelab.visible=!0,this.timebg.visible=!0,this.ShowColdTime()):(this.timelab.visible=!1,this.timebg.visible=!1,this.misspic.visible=!1,this.buybtn.visible=!WelfareProxy.ins().getInvenstHasBuy(this.curType)),this.buybtn.setRed(WelfareProxy.ins().getInvenstTypeRed(this.curType)),this.tips.visible=this.buybtn.visible&&t.vip_level>0,this.tips.textFlow=t.vip_level>18?UtilProxy.StrFormart("|C:@0 &SVIP@1  可兑换|",[RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=t.vip_level?7:4,t.vip_level-18]):UtilProxy.StrFormart("|C:@0 &VIP@1  可兑换|",[RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=t.vip_level?7:4,t.vip_level])}},e.prototype.sortlist=function(t,e){var i=WelfareProxy.ins().getInvenstAwardHasGet(t.id,t.index),n=WelfareProxy.ins().getInvenstAwardHasGet(e.id,e.index);return!i&&n?-1:i&&!n?1:t.index<e.index?-1:t.index>e.index?1:0},e.prototype.SetBtnRed=function(){for(var t=0;t<this.btns.length;t++)this.btns[t].getChildAt(4).visible=WelfareProxy.ins().getInvenstTypeRed(t+1)},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(this.buybtn.visible=!WelfareProxy.ins().getInvenstHasBuy(this.curType),this.misspic.visible=!1,TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):(this.buybtn.visible=!1,this.misspic.visible=!WelfareProxy.ins().getInvenstHasBuy(this.curType),this.timelab.visible=!1,this.timebg.visible=!1,this.timelab.textFlow=UtilProxy.generateTextFlow("C:4&活动已结束"))},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&活动倒计时：@0 |",[UtilProxy.getTimeHSString_2(this.endtime-GameLogic.ins().getServerTime())])},e}(BaseEuiView);__reflect(SuperInvestView.prototype,"SuperInvestView"),ViewManager.ins().reg(SuperInvestView,LayerManager.UI_Main2),window.SuperInvestView=SuperInvestView;var SystemOpenView=function(t){function e(){var e=t.call(this)||this;return e.time=0,e.id=0,e.sub_id=0,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SystemOpenViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.time=10,this.addTouchEvent(this.black,this.onClick),void 0!=t&&void 0!=t[1]){CommonUtils.log("SystemOpenView open ---->",t[1][0],t[1][1]),this.id=t[1][0],this.sub_id=t[1][1];var i=GlobalConfig.getSystemopenConfigById(this.id,this.sub_id);i&&(this.icon.source=i.name_icon)}TimerManager.ins().doTimer(1e3,this.time,this.update,this,this.end,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];2==this.id&&804==this.sub_id&&ActivityProxy.ins().setActTips(),this.removeTouchEvent(this.black,this.onClick),TimerManager.ins().removeAll(this)},e.prototype.onClick=function(t){this.closeView()},e.prototype.update=function(){this.time=this.time-1},e.prototype.end=function(){this.closeView()},e.prototype.closeView=function(){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(SystemOpenView.prototype,"SystemOpenView"),ViewManager.ins().reg(SystemOpenView,LayerManager.UI_Open),window.SystemOpenView=SystemOpenView;var SystemPreItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SystemPreItemSkin",e.selectBg.visible=!1,e.red.visible=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;e&&e.id&&(this.icon.source=e.icon,this.refresh())},e.prototype.refresh=function(){var t=this.data;if(t&&t.id){var e=t.system_params[0],i=t.system_params[1],n="";switch(e){case 1:n=i>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)?"等级达"+i:"已激活";break;case 2:n=i>RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)?UtilProxy.getZhuanStr(i):"已激活";break;case 3:n=i>LyhProxy.ins().getCurId()?"炼妖壶"+i+"关":"已激活";break;case 4:n=i>LimitActProxy.ins().GetServerOpenDay()?"开服"+i+"天":"已激活"}this.info.text=n,this.setRed()}},e.prototype.setRed=function(){var t=this.data;t&&t.id&&(this.red.visible=WelfareProxy.ins().GetSystemAwardStateById(t.id))},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this),this.selected!=this.selectBg.visible&&(this.selectBg.visible=this.selected)},e}(BaseItemRender);__reflect(SystemPreItem.prototype,"SystemPreItem"),window.SystemPreItem=SystemPreItem;var SystemPreView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="SystemPreSkin",this.comview.initUI(),this.listH1.itemRenderer=ItemCell,this.scrollerH1.viewport=this.listH1,this.listH1.dataProvider=new eui.ArrayCollection,this.listH0.itemRenderer=SystemPreItem,this.scrollerH0.viewport=this.listH0,this.listH0.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.comview.SetName(UtilProxy.getTitleName("预告")),this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.sbtn,this.onClick),this.addItemTapEvent(this.listH0,this.onItemClick),EventProxy.AddListener(this,EventType.S2CRspWelfareGetSystemAward,this.S2CRspWelfareGetSystemAward),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closeBtn,this.onClick),this.removeTouchEvent(this.sbtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetSystemAward,this.S2CRspWelfareGetSystemAward)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:ViewManager.ins().close(this);break;case this.sbtn:if(this.lastSkinItem&&this.lastSkinItem.data){var e=this.lastSkinItem.data,i=e.system_params[0],n=e.system_params[1];switch(i){case 1:n>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)?TipsControl.ins().showTips("等级达"+n+"可领取奖励"):WelfareProxy.ins().C2SReqWelfareGetSystemAward(e.id);break;case 2:if(n>RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)){GlobalConfig.getZhuanById(n);TipsControl.ins().showTips(UtilProxy.getZhuanStr(n)+"可领取奖励")}else WelfareProxy.ins().C2SReqWelfareGetSystemAward(e.id);break;case 3:n>LyhProxy.ins().getCurId()?TipsControl.ins().showTips("通关炼妖壶"+n+"关可领取奖励"):WelfareProxy.ins().C2SReqWelfareGetSystemAward(e.id);break;case 4:n>LimitActProxy.ins().GetServerOpenDay()?TipsControl.ins().showTips("开服"+n+"天可领取奖励"):WelfareProxy.ins().C2SReqWelfareGetSystemAward(e.id)}}}},e.prototype.setData=function(){var t=[],e=GlobalConfig.getSystem_open_awardConfigs();for(var i in e)t.push(e[i]);this.listH0.dataProvider=new eui.ArrayCollection(t);var n=function(){for(var t=0;t<this.listH0.numChildren;++t){var e=this.listH0.getChildAt(t);if(e){var i=e.data,o=WelfareProxy.ins().getNextSysOpenConfig(!0);if(o&&o.id==i.id)return this.lastSkinItem=void 0,this.selectSkinItem(e),this.listH0.selectedIndex=e.itemIndex,void TimerManager.ins().remove(n,this)}}};TimerManager.ins().doTimer(100,0,n,this)},e.prototype.onItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem){if(this.lastSkinItem==t)return;this.lastSkinItem.refresh()}t.refresh(),this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(null!=e&&void 0!=e.id){this.icon.source=e.icon,this.iconDec.source=e.icon_dec,this.sbtn.visible=!WelfareProxy.ins().isGetSystemAward(e.id),this.finish.visible=WelfareProxy.ins().isGetSystemAward(e.id);for(var i=new Array,n=0;n<e.items.length;++n){var o=UtilProxy.GetItemCellData(e.items[n][0],e.items[n][1]);i.push(o)}this.listH1.dataProvider=new eui.ArrayCollection(i)}},e.prototype.setSelect=function(){var t=void 0!=WelfareProxy.ins().getNextCanAwardSysOpenConfig(!0);if(t)for(var e=0;e<this.listH0.numChildren;++e){var i=this.listH0.getChildAt(e);if(i){var n=i.data,o=WelfareProxy.ins().getNextCanAwardSysOpenConfig(!0);o.id==n.id&&(this.selectSkinItem(i),this.listH0.selectedIndex=i.itemIndex)}}return t},e.prototype.S2CRspWelfareGetSystemAward=function(t){var e=this.setSelect();this.lastSkinItem&&this.lastSkinItem.refresh(),!e&&this.lastSkinItem&&this.SetSkinData(this.lastSkinItem)},e}(BaseEuiView);__reflect(SystemPreView.prototype,"SystemPreView"),ViewManager.ins().reg(SystemPreView,LayerManager.UI_Main),window.SystemPreView=SystemPreView;var TaoZhuangView=function(t){function e(){var e=t.call(this)||this;return e.menu_id=1,e.skinName="TaoZhuangSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_taozhuang")},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.list_menu.itemRenderer=TzMenu,this.list_tz.itemRenderer=TzItem,this.list_eq.itemRenderer=TzIcon,this.comview.open(),this.addTouchEvent(this.btn_close,this.onClick),EventProxy.AddListener(this,EventType.S2CRepGrowupUpdateTaozhuang,this.onUpdate),this.list_menu.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.mv_horse||(this.mv_horse=new MovieClip,this.gp_model.addChild(this.mv_horse),this.mv_horse.x=this.gp_model.width/2,this.mv_horse.y=this.gp_model.height/2),this.mv_wing||(this.mv_wing=new MovieClip,this.gp_model.addChild(this.mv_wing),this.mv_wing.x=this.gp_model.width/2,this.mv_wing.y=this.gp_model.height/2),this.mv_body||(this.mv_body=new MovieClip,this.gp_model.addChild(this.mv_body),this.mv_body.x=this.gp_model.width/2,this.mv_body.y=this.gp_model.height/2),this.mv_weapon||(this.mv_weapon=new MovieClip,this.gp_model.addChild(this.mv_weapon),this.mv_weapon.x=this.gp_model.width/2,this.mv_weapon.y=this.gp_model.height/2),this.mv_horse_up||(this.mv_horse_up=new MovieClip,this.gp_model.addChild(this.mv_horse_up),this.mv_horse_up.x=this.gp_model.width/2,this.mv_horse_up.y=this.gp_model.height/2),this.updateInfo(),this.openMenu(1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.btn_close,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupUpdateTaozhuang,this.onUpdate),this.list_menu.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.Broast(EventType.UpdateTaozhuangRed,{})},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;void 0!=e&&(this.cur_item?this.arr_menu.itemUpdated(this.cur_item.data):this.arr_menu.itemUpdated(this.arr_menu.source[0]),this.cur_item=e,this.arr_menu.itemUpdated(this.cur_item.data),this.openMenu(e.data.id))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(this)}},e.prototype.updateInfo=function(){this.arr_menu||(this.arr_menu=new eui.ArrayCollection,this.list_menu.dataProvider=this.arr_menu);var t=GlobalConfig.getTzList(),e=[];for(var i in t)e.push(t[i]);this.list_menu.selectedIndex=0,this.arr_menu.replaceAll(e)},e.prototype.openMenu=function(t){this.menu_id=t,this.arr_item||(this.arr_item=new eui.ArrayCollection,this.list_tz.dataProvider=this.arr_item),this.arr_icon||(this.arr_icon=new eui.ArrayCollection,this.list_eq.dataProvider=this.arr_icon);var e=GlobalConfig.getTzAttrList(t);if(e){var i=[];for(var n in e)i.push(e[n]);this.arr_item.replaceAll(i);var o=GlobalConfig.getTzById(t);if(o&&o.show_list){for(var s=[],r=0;r<o.show_list.length;r++){var a=o.show_list[r];s.push(a)}this.arr_icon.replaceAll(s),this.sp_name.source="resource/skins/TaoZhuang/tex/taozhuang_font_"+o.name_icon+".png";var h=this.getModelData(s),l=3,p="s",c=AssetMgr.getWingResource(this.getRes(4,h.wing_id),l,p);this.mv_wing.playFile(c,-1,null,!1),c=AssetMgr.getMountResource(this.getRes(1,h.horse_id),0,l,p,!0),this.mv_horse.playFile(c,-1,null,!1),c=AssetMgr.getWeaponResource(this.getRes(3,h.weap_id),0,l,p,!0),this.mv_weapon.playFile(c,-1,null,!1),c=AssetMgr.getRoleBodySource(this.getRes(2,h.choth_id),0,l,p,!0),this.mv_body.playFile(c,-1,null,!1);var u=this.getHorseUpDirList(h.horse_id);u[l]?(this.mv_horse_up.playFile(c+"_up",-1,null,!1),this.mv_horse_up.visible=!0):(this.mv_horse_up.visible=!1,this.mv_horse_up.clear()),this.txt_fight.text=TaoZhuangProxy.ins().getFightNum().toString()}}},e.prototype.onUpdate=function(){this.updateInfo(),this.openMenu(this.menu_id)},e.prototype.getHorseUpDirList=function(t){if(t>0){var e=GlobalConfig.getHorseGradeShowConfig(t);if(e||(e=GlobalConfig.getHorse_skin_ex_dataConfig(t)?GlobalConfig.getHorse_skin_ex_dataConfig(t):null),e){var i=e.model_id,n=GlobalConfig.getCharResConfigById(i);if(n)return n.dir}}return[]},e.prototype.getModelData=function(t){var e={};e.horse_id=0,e.choth_id=0,e.weap_id=0,e.wing_id=0;for(var i=0;i<t.length;i++){var n=t[i];1==n[0]?e.horse_id=n[1]:2==n[0]?e.choth_id=n[1]:3==n[0]?e.weap_id=n[1]:4==n[0]&&(e.wing_id=n[1])}return e},e.prototype.getRes=function(t,e){var i="";switch(t){case 1:if(e>0){var n=GlobalConfig.getHorseGradeShowConfig(e);if(n||(n=GlobalConfig.getHorse_skin_ex_dataConfig(e)?GlobalConfig.getHorse_skin_ex_dataConfig(e):null),n){var o=n.model_id,s=GlobalConfig.getCharResConfigById(o);s&&(i=s.body_res)}}break;case 2:if(e>0){var n=GlobalConfig.getFashion_id_dataConfig(e);if(n){var r=n.model[RoleProxy.ins().getRoleSex()-1],a=GlobalConfig.getCharResConfigById(r);if(a)return a.body_res}}break;case 3:if(e>0){var n=GlobalConfig.getWeaponResById(e);if(n){var r=n.model_id,h=GlobalConfig.getCharResConfigById(r);if(h)return h.body_res}}break;case 4:if(e>0){var n=GlobalConfig.getWingResById(e);if(n){var l=n.model_id,p=GlobalConfig.getCharResConfigById(l);if(p)return p.body_res}}}return i},e}(BaseEuiView);__reflect(TaoZhuangView.prototype,"TaoZhuangView"),ViewManager.ins().reg(TaoZhuangView,LayerManager.UI_Main),window.TaoZhuangView=TaoZhuangView;var TzIcon=function(t){function e(){var e=t.call(this)||this;return e.name_list=["taozhuang_jiaobiao_04","taozhuang_jiaobiao_02","taozhuang_jiaobiao_01","taozhuang_jiaobiao_03"],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addTouchEvent(this.icon,this.onClick)},e.prototype.onClick=function(){if(this.data){var t=this.getItemId(this.data[0],this.data[1]),e=new ItemCellData,i={item_slot_idx:0,item_type_id:t,item_count:1};e.setItemCellData(i),ViewManager.ins().open(ItemTipsView,e)}},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),void 0!=this.data&&"null"!=this.data.qq){var e=this.data;this.sp_tt.source=this.name_list[e[0]-1],this.icon.source=this.getIconSource(this.data[0],this.data[1]);var i=TaoZhuangProxy.ins().isEquipActive(this.data[0],this.data[1]);this.sp_una.visible=!i,this.txt_name.textFlow=UtilProxy.StrFormart("C:7&<u>@0 </u>",[this.getIconName(this.data[0],this.data[1])])}},e.prototype.getIconName=function(t,e){var i,n="";switch(t){case 1:i=HorseProxy.ins().getShowDataById(e),n=i.name;break;case 2:i=GlobalConfig.getFashion_id_dataConfig(e),n=i.name;break;case 3:i=WeaponProxy.ins().getResById(WeaponType.Weapon,e),n=i.name;break;case 4:i=WeaponProxy.ins().getResById(WeaponType.Wing,e),n=i.name}return n},e.prototype.getIconSource=function(t,e){var i,n,o="";switch(t){case 1:i=HorseProxy.ins().getShowDataById(e),o=i.icon;break;case 2:i=GlobalConfig.getFashion_base_dataConfig(e)[1],n=BagProxy.ins().getItemData(i.item[0]),o=n.displayid;break;case 3:i=WeaponProxy.ins().getBaseById(WeaponType.Weapon,e,1),n=BagProxy.ins().getItemData(i.item[0]),o=n.displayid;break;case 4:i=WeaponProxy.ins().getBaseById(WeaponType.Wing,e,1),n=BagProxy.ins().getItemData(i.item[0]),o=n.displayid}var s=AssetMgr.getIconResource(o);return s},e.prototype.getItemId=function(t,e){var i,n=0;switch(t){case 1:i=HorseProxy.ins().getShowDataById(e),i&&(n=i.item_id);break;case 2:i=GlobalConfig.getFashion_base_dataConfig(e)[1],i&&(n=i.item[0]);break;case 3:i=WeaponProxy.ins().getBaseById(WeaponType.Weapon,e,1),i&&(n=i.item[0]);break;case 4:i=WeaponProxy.ins().getBaseById(WeaponType.Wing,e,1),i&&(n=i.item[0])}return n},e}(BaseItemRender);__reflect(TzIcon.prototype,"TzIcon"),window.TzIcon=TzIcon;var TzItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addTouchEvent(this.btn_active,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),void 0!=this.data&&"null"!=this.data.qq){this.red||(this.red=this.btn_active.getChildAt(2));var e=this.data;this.sp_title.source="taozhaung_title_00"+(this.data.num-1);var i=TaoZhuangProxy.ins().getActiveNum(e.id),n=this.data.num;i>n&&(i=n);var o=n>i?4:7;this.num.textFlow=UtilProxy.StrFormart("C:@0 &(@1 /@2 )",[o,i,n]);var s=AttrProxy.getAttrInfo(this.data),r="";if(s.length>0)for(var a=0;a<s.length;a++)a>0&&(r+="\r\n"),r+="|"+s[a][2]+"：|C:7&"+s[a][1];this.pro.textFlow=UtilProxy.StrFormart(r,[]);var h=TaoZhuangProxy.ins().isTzActive(e.id,e.num);this.btn_active.visible=!h,this.sp_finish.visible=h,this.txt_fight.text=UtilProxy.GetAttrFight(this.data).toString(),this.red.visible=TaoZhuangProxy.ins().getRedByIdAnNum(e.id,e.num)}},e.prototype.onClick=function(){if(TaoZhuangProxy.ins().isTzActive(this.data.id,this.data.num))return void TipsControl.ins().showTips("套装已激活");var t=TaoZhuangProxy.ins().getActiveNum(this.data.id),e=this.data.num;return e>t?void TipsControl.ins().showTips("套装数据不足"):void TaoZhuangProxy.ins().C2SReqGrowupActiveTaozhuang(this.data.id,this.data.num)},e}(BaseItemRender);__reflect(TzItem.prototype,"TzItem"),window.TzItem=TzItem;var TzMenu=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),void 0!=this.data&&"null"!=this.data.qq&&(this.icon.source="resource/image/item/"+this.data.icon+".png",this.txt_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[this.data.name]),this.sp_select.visible=this.selected,this.red.visible=TaoZhuangProxy.ins().getRedById(this.data.id))},e}(BaseItemRender);__reflect(TzMenu.prototype,"TzMenu"),window.TzMenu=TzMenu;var MemberItem=function(t){function e(){var e=t.call(this)||this;return e.state_index=-1,e.skinName="MemberItemSkin",e.isAddState=!0,e.Add.visible=!1,e.apply.visible=!1,e.leader.visible=!1,e.blood_bg.visible=!0,e.state.visible=!1,e.targetIcon.visible=!0,e.isAddState=!0,e.setRoleName(""),e.setHpValue(0),e}return __extends(e,t),e.prototype.onClick=function(t){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)
},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(!t||!t.role_id&&!t.handle)return this.Add.visible=!0,this.apply.visible=!0,this.leader.visible=!1,this.blood_bg.visible=!1,this.state.visible=!1,this.targetIcon.visible=!1,this.isAddState=!0,this.setRoleName(""),void this.setHpValue(0);this.Add.visible=!1,this.apply.visible=!1,this.isAddState=!1;var e;t.role_id?(this.blood.source="smjd_xietiao_01",this.leader.visible=TeamProxy.ins().team_info&&t.role_id==TeamProxy.ins().team_info.captain_id,e=GameLogic.ins().getEntityByRoleId(t.role_id),this.state.visible=!1):t.handle&&(this.leader.visible=!1,e=GameLogic.ins().getEntityByHandle(t.handle)),e?(this.blood_bg.visible=!0,this.setHpValue(e.getHP(),e.getHPMax()),this.targetIcon.visible=!0,e instanceof EntityRole&&(this.targetIcon.source=BossProxy.ins().getRoleIconName(e.getJob())),this.setRoleName(e.name),TeamProxy.ins().team_info&&e.team_id==TeamProxy.ins().team_info.team_id?(this.blood.source="smjd_xietiao_01",this.state.visible=!1):(this.blood.source="smjd_xietiao_02",this.state.visible=!0,e.handle==GameMap.centerEntity.AI.getTargetId()?this.setRoleState(0):BossProxy.ins().isAtkRole(e.role_id,e.server_id)?this.setRoleState(1):this.state.visible=!1)):(this.blood_bg.visible=!1,this.setHpValue(0),this.state.visible=!1,this.targetIcon.visible=!1,this.setRoleName(""))},e.prototype.setDataByEntity=function(t){t?this.data=t:(this.blood_bg.visible=!1,this.setHpValue(0),this.state.visible=!1,this.targetIcon.visible=!1,this.setRoleName(""))},e.prototype.setRoleState=function(t){this.state_sources||(this.state_sources=["smjd_font_gongjizhong","smjd_font_diren"]),this.state.source=this.state_sources[t]||"",this.state_index=t},e.prototype.setRoleName=function(t){this.targetName.text=t},e.prototype.setHpValue=function(t,e){void 0===e&&(e=1),this.blood.width=this.blood_bg.width*Math.min(1,t/e)},e}(BaseItemRender);__reflect(MemberItem.prototype,"MemberItem"),window.MemberItem=MemberItem;var MyTeamView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MyTeamViewSkin",this.rs=[this.r0,this.r1,this.r2,this.r3],this.icons=[this.icon0,this.icon1,this.icon2,this.icon3],this.names=[this.name0,this.name1,this.name2,this.name3],this.delects=[this.delect0,this.delect1,this.delect2,this.delect3],this.refresh_btn.setCD(5),this.listM.itemRenderer=TeamItem,this.scrollerM.viewport=this.listM},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.closeClick),this.addTouchEvent(this.refresh_btn,this.onRefreshClick);for(var i=0;i<this.delects.length;++i)this.addTouchEvent(this.delects[i],this.onDelectClick);EventProxy.AddListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),EventProxy.AddListener(this,EventType.S2CRepTeamGetInfo,this.S2CRepTeamGetInfo),EventProxy.AddListener(this,EventType.S2CRepTeamRemove,this.S2CRepTeamRemove),EventProxy.AddListener(this,EventType.S2CTeamInfoChange,this.S2CTeamInfoChange),this.listM_dataProvider||(this.listM_dataProvider=new eui.ArrayCollection,this.listM.dataProvider=this.listM_dataProvider),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.closeClick),this.removeTouchEvent(this.refresh_btn,this.onRefreshClick);for(var i=0;i<this.delects.length;++i)this.removeTouchEvent(this.delects[i],this.onDelectClick);EventProxy.RemoveListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),EventProxy.RemoveListener(this,EventType.S2CRepTeamGetInfo,this.S2CRepTeamGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepTeamRemove,this.S2CRepTeamRemove),EventProxy.RemoveListener(this,EventType.S2CTeamInfoChange,this.S2CTeamInfoChange),this.listM_dataProvider&&(this.listM_dataProvider.removeAll(),this.listM_dataProvider=null)},e.prototype.closeClick=function(t){ViewManager.ins().close(this)},e.prototype.onRefreshClick=function(t){this.setNearData()},e.prototype.onDelectClick=function(t){var e=this.delects.indexOf(t.currentTarget);if(void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list[e]){var i=TeamProxy.ins().team_info.member_list[e],n=i.role_id;n==RoleProxy.ins().getRoleId()?TeamProxy.ins().C2SReqTeamLeave():TeamProxy.ins().IsCaptain()?TeamProxy.ins().C2SReqTeamRemove(n):TipsControl.ins().showTips("不是队长不能将队员踢出队伍！")}},e.prototype.S2CRepTeamRemove=function(){this.setData()},e.prototype.S2CRepTeamLeave=function(){ViewManager.ins().close(this)},e.prototype.S2CTeamInfoChange=function(){this.setNearData()},e.prototype.S2CRepTeamGetInfo=function(){this.setData()},e.prototype.setData=function(){this.visible=!0;var t=0;if(void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0){t=TeamProxy.ins().team_info.member_list.length;for(var e=0,i=0;i<TeamProxy.ins().team_info.member_list.length;++i){var n=new MemberItemData;n.role_id=TeamProxy.ins().team_info.member_list[i].role_id,n.type=TeamViewType.my,n.member_item=TeamProxy.ins().team_info.member_list[i],TeamProxy.ins().team_info.captain_id==n.member_item.role_id?(this.rs[0].visible=!0,this.icons[0].source=BossProxy.ins().getRoleIconName(TeamProxy.ins().team_info.member_list[i].prof),this.names[0].text=TeamProxy.ins().team_info.member_list[i].name):this.rs[e+1]&&(this.rs[e+1].visible=!0,this.icons[e+1].source=BossProxy.ins().getRoleIconName(TeamProxy.ins().team_info.member_list[i].prof),this.names[e+1].text=TeamProxy.ins().team_info.member_list[i].name,e++)}}for(var i=0;i<this.rs.length;++i)i>=t&&(this.rs[i].visible=!1);this.setNearData()},e.prototype.setNearData=function(){for(var t=new Array,e=GameLogic.ins().getEntityList(),i=0;i<e.length;++i){var n=e[i];if(n&&n instanceof EntityRole&&n!=GameMap.centerEntity&&0!=n.role_id&&n.server_id==RoleProxy.ins().getRoleServerId()&&!n.team_id){var o=new MemberItemData;o.role_id=n.role_id,o.handle=n.handle,o.type=TeamViewType.invite,t.push(o)}}this.listM_dataProvider.replaceAll(t)},e}(BaseEuiView);__reflect(MyTeamView.prototype,"MyTeamView"),ViewManager.ins().reg(MyTeamView,LayerManager.UI_Main),window.MyTeamView=MyTeamView;var TeamInfoView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TeamInfoViewSkin",this.info1.text="组队可提高刷怪效率，奖励共享",this.info2.textFlow=UtilProxy.generateTextFlow("C:7&队伍共同获得首领排名奖励")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.auto,this.onClick),this.addTouchEvent(this.auto0,this.onClick),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.inviteBtn,this.onInviteClick),this.addTouchEvent(this.findBtn,this.onFindClick),EventProxy.AddListener(this,EventType.S2CRepTeamAutoAccept,this.S2CRepTeamAutoAccept),EventProxy.AddListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),EventProxy.AddListener(this,EventType.S2CRepTeamGetInfo,this.S2CRepTeamGetInfo),EventProxy.AddListener(this,EventType.S2CRepTeamCreate,this.S2CRepTeamCreate),this.setAutoAccept(),this.setAutoReply()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.auto,this.onClick),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.inviteBtn,this.onInviteClick),this.removeTouchEvent(this.findBtn,this.onFindClick),EventProxy.RemoveListener(this,EventType.S2CRepTeamAutoAccept,this.S2CRepTeamAutoAccept),EventProxy.RemoveListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),EventProxy.RemoveListener(this,EventType.S2CRepTeamGetInfo,this.S2CRepTeamGetInfo),EventProxy.RemoveListener(this,EventType.S2CRepTeamCreate,this.S2CRepTeamCreate)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.gou:TeamProxy.ins().auto_accept=!TeamProxy.ins().auto_accept,this.setAutoAccept();break;case this.gou0:TeamProxy.ins().auto_reply=!TeamProxy.ins().auto_reply,this.setAutoReply()}},e.prototype.setAutoAccept=function(){this.gou.visible=TeamProxy.ins().auto_accept},e.prototype.setAutoReply=function(){this.gou0.visible=TeamProxy.ins().auto_reply},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onInviteClick=function(t){void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0?ViewManager.ins().open(MyTeamView):TeamProxy.ins().C2SReqTeamCreate(GameLogic.ins().getCurSceneId())},e.prototype.onFindClick=function(t){void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0?TipsControl.ins().showTips("你已经有队伍了！"):TeamProxy.ins().C2SReqTeamGetSceneTeam()},e.prototype.S2CRepTeamAutoAccept=function(){this.setTeamInfo()},e.prototype.S2CRepTeamLeave=function(){this.setTeamInfo()},e.prototype.S2CRepTeamGetInfo=function(){this.setTeamInfo()},e.prototype.S2CRepTeamCreate=function(){this.setTeamInfo()},e.prototype.setTeamInfo=function(){void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0?this.info0.text="":this.info0.text="你现在没有队伍！"},e}(BaseEuiView);__reflect(TeamInfoView.prototype,"TeamInfoView"),ViewManager.ins().reg(TeamInfoView,LayerManager.UI_Main),window.TeamInfoView=TeamInfoView;var TeamItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="MyTeamItemSkin",e.addTouchEvent(e.btn,e.onClick),e.addTouchEvent(e.add,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;if(void 0!=e)switch(t.currentTarget){case this.btn:TeamProxy.ins().IsCaptain()?TeamProxy.ins().C2SReqTeamInvite(e.role_id):TipsControl.ins().showTips("不是队长！");break;case this.add:ViewManager.ins().open(TeamListView,void 0,TeamViewType.invite)}},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t&&void 0!=t.role_id&&void 0!=t.handle){this.btn.visible=!0,this.btn.label="邀 请";var e=GameLogic.ins().getEntityByHandle(t.handle);e instanceof EntityRole&&(this.info0.text=e.name,this.info1.text=UtilProxy.getLevelAndZhuanStr(e.level,e.zhuan),this.info2.text="战力："+(e.fight||0),this.icon.source=BossProxy.ins().getRoleIconName(e.getJob()))}},e}(BaseItemRender);__reflect(TeamItem.prototype,"TeamItem"),window.TeamItem=TeamItem;var TeamItemEx=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamItemSkin",e.rs=[e.r0,e.r1,e.r2,e.r3],e.icons=[e.icon0,e.icon1,e.icon2,e.icon3],e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;if(void 0!=e)switch(t.currentTarget){case this.btn:e.type==TeamViewType.team?TeamProxy.ins().C2SReqTeamApply(e.role_id):e.type==TeamViewType.invite?TeamProxy.ins().C2SReqTeamInvite(e.role_id):e.type==TeamViewType.my&&(e.role_id==RoleProxy.ins().getRoleId()?TeamProxy.ins().C2SReqTeamLeave():TeamProxy.ins().C2SReqTeamRemove(e.role_id))}},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=TeamProxy.ins().getTeamInfoData(t.team_item);this.info.textFlow=UtilProxy.StrFormart("|C:7&@0 的队伍",[e.name]);var i=0;if(t.team_item&&t.team_item.member_list){i=t.team_item.member_list.length;for(var n=0;i>n;++n)this.rs[n].visible=!0,this.icons[n].source=BossProxy.ins().getRoleIconName(t.team_item.member_list[n].prof)}for(var n=0;n<this.rs.length;++n)n>=i&&(this.rs[n].visible=!1)}},e}(BaseItemRender);__reflect(TeamItemEx.prototype,"TeamItemEx"),window.TeamItemEx=TeamItemEx;var TeamListView=function(t){function e(){var e=t.call(this)||this;return e.type=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TeamListViewSkin",this.listM.itemRenderer=TeamItemEx,this.scrollerM.viewport=this.listM,this.listM.dataProvider=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[1],this.addTouchEvent(this.rCloseBtn,this.onClick),this.addTouchEvent(this.apply_btn,this.onClick),this.setTeamList()},e.prototype.setTeamList=function(){this.titleName.text="队伍列表";var t=new Array;if(void 0!=TeamProxy.ins().NearTeam&&TeamProxy.ins().NearTeam.length>0)for(var e=0;e<TeamProxy.ins().NearTeam.length;++e)if(TeamProxy.ins().NearTeam[e].captain_id!=RoleProxy.ins().getRoleId()&&TeamProxy.ins().isNotMyTeam(TeamProxy.ins().NearTeam[e].captain_id)){var i=new MemberItemData;i.role_id=TeamProxy.ins().NearTeam[e].captain_id,i.type=this.type,i.team_item=TeamProxy.ins().NearTeam[e],t.push(i)}this.listM.dataProvider=new eui.ArrayCollection(t)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.rCloseBtn,this.onClick),this.addTouchEvent(this.apply_btn,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rCloseBtn:ViewManager.ins().close(this);break;case this.apply_btn:}},e}(BaseEuiView);__reflect(TeamListView.prototype,"TeamListView"),ViewManager.ins().reg(TeamListView,LayerManager.UI_Main),window.TeamListView=TeamListView;var TeamView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TeamViewSkin",this.infoView.initUI(),this.listView.initUI(),this.myView.initUI()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0]||1;this.addTouchEvent(this.infoView.closebtn,this.onCloseClick),this.addTouchEvent(this.infoView.inviteBtn,this.onInviteClick),this.addTouchEvent(this.infoView.findBtn,this.onFindClick),EventProxy.AddListener(this,EventType.S2CRepTeamGetSceneTeam,this.S2CRepTeamGetSceneTeam),EventProxy.AddListener(this,EventType.getOpenInitView,this.getOpenInitView),EventProxy.AddListener(this,EventType.S2CRepTeamCreate,this.S2CRepTeamCreate),EventProxy.AddListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave),this.openView(i)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.infoView.closebtn,this.onCloseClick),this.removeTouchEvent(this.infoView.inviteBtn,this.onInviteClick),this.removeTouchEvent(this.infoView.findBtn,this.onFindClick),EventProxy.RemoveListener(this,EventType.S2CRepTeamGetSceneTeam,this.S2CRepTeamGetSceneTeam),EventProxy.RemoveListener(this,EventType.getOpenInitView,this.getOpenInitView),EventProxy.RemoveListener(this,EventType.S2CRepTeamCreate,this.S2CRepTeamCreate),EventProxy.RemoveListener(this,EventType.S2CRepTeamLeave,this.S2CRepTeamLeave)},e.prototype.S2CRepTeamGetSceneTeam=function(t){this.listView.open(TeamViewType.team)},e.prototype.S2CRepTeamCreate=function(){this.myView.open()},e.prototype.S2CRepTeamLeave=function(){},e.prototype.openView=function(t){switch(t){case 0:break;case 1:break;case 2:break;case 3:}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onInviteClick=function(t){void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0?this.myView.open():TeamProxy.ins().C2SReqTeamCreate()},e.prototype.getOpenInitView=function(){this.listView.open(TeamViewType.invite)},e.prototype.onFindClick=function(t){void 0!=TeamProxy.ins().team_info&&void 0!=TeamProxy.ins().team_info.member_list&&TeamProxy.ins().team_info.member_list.length>0?TipsControl.ins().showTips("你已经有队伍了！"):TeamProxy.ins().C2SReqTeamGetSceneTeam()},e}(BaseEuiView);__reflect(TeamView.prototype,"TeamView"),ViewManager.ins().reg(TeamView,LayerManager.UI_Main),window.TeamView=TeamView;var Keyboard=function(){function t(){}return t.LEFT=37,t.UP=38,t.RIGHT=39,t.DOWN=40,t.KC_1=49,t.KC_2=50,t.KC_3=51,t.KC_4=52,t.KC_5=53,t.KC_6=54,t.KC_7=55,t.KC_8=56,t.KC_9=57,t.KC_0=48,t.A=65,t.B=66,t.C=67,t.D=68,t.E=69,t.F=70,t.G=71,t.H=72,t.I=73,t.J=74,t.K=75,t.L=76,t.M=77,t.N=78,t.O=79,t.P=80,t.Q=81,t.R=82,t.S=83,t.T=84,t.U=85,t.V=86,t.W=87,t.X=88,t.Y=89,t.Z=90,t.SPACE=32,t.SMALL_K_ADD=107,t.SMALL_K_MIN=109,t.BRACE_L=219,t.BACKSLASH=220,t.BRACE_R=221,t.BACK_QUOTE=192,t.ENTER=13,t.KC_BACKSPACE=8,t.KC_TAB=9,t.KC_ENTER=13,t.KC_SHIFT=16,t.KC_CONTROL=17,t.KC_ESCAPE=27,t.KC_SPACE=32,t.KC_WINDOWS=91,t.KC_MENU=93,t}();__reflect(Keyboard.prototype,"Keyboard");var TesterCeHuaPage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onclick=function(t){t.target},e}(TesterBasePage);__reflect(TesterCeHuaPage.prototype,"TesterCeHuaPage");var TesterCeShiPage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(TesterBasePage);__reflect(TesterCeShiPage.prototype,"TesterCeShiPage");var TesterChengXuPage=function(t){function e(){var e=t.call(this)||this;return e.NAMES=["char/byte","short","number","string","double","float","boolean"],e}return __extends(e,t),e.prototype.init=function(){this.list1.itemRenderer=CCLine,this.list2.itemRenderer=CCLine,this.list1.dataProvider=new eui.ArrayCollection(this.NAMES),this.list2.dataProvider=new eui.ArrayCollection(this.NAMES)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list1.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectType,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list1.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectType,this)},e.prototype.onSelectType=function(t){t.currentTarget==this.list1||t.currentTarget==this.list1},e.prototype.onClick=function(t){switch(t.target){case this.btnSend:this.sendMsg()}},e.prototype.writeBytes=function(t,e,i){switch(t){case this.NAMES[0]:e.writeByte(i);break;case this.NAMES[1]:e.writeShort(i);break;case this.NAMES[2]:e.writeNumber(i);break;case this.NAMES[3]:e.writeString(i);break;case this.NAMES[4]:e.writeDouble(i);break;case this.NAMES[5]:e.writeFloat(i);break;case this.NAMES[6]:e.writeBoolean(i);break;default:throw new Error("类型错误:"+t)}},e.prototype.sendMsg=function(){if(""!=this.input1.text&&null!=this.input1.text&&"0"!=this.input1.text&&""!=this.input2.text&&null!=this.input2.text&&"0"!=this.input2.text){var t=new GameByteArray,e=parseInt(this.input1.text),i=parseInt(this.input2.text);t.writeCmd(e,i);GameSocket.ins().send(t);CommonUtils.log("协议"+e+"-"+i+"发送成功!")}else CommonUtils.log("协议号输入有误")},e}(TesterBasePage);__reflect(TesterChengXuPage.prototype,"TesterChengXuPage");var CCLine=function(t){function e(){var e=t.call(this)||this;return e.label=new eui.Label,e.label.x=5,e.label.y=5,e.addChild(e.label),e}return __extends(e,t),e.prototype.dataChanged=function(){this.label.text=this.data},e.prototype.getContent=function(){return this.label.text},e}(BaseItemRender);__reflect(CCLine.prototype,"CCLine");var CCElement=function(){function t(){}return t.prototype.CCElement=function(){},t}();__reflect(CCElement.prototype,"CCElement"),window.TesterChengXuPage=TesterChengXuPage;var TesterCommonPage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onclick=function(t){switch(t.target){case this.btnOpenWin:ViewManager.ins().open(this.inputOpenWin.text);break;case this.btnMakeItem:this.doMakeItem();break;case this.btnClear:this.sendChatMessage("@clearbag")}},e.prototype.doMakeItem=function(){if(null==this.inputItem2.text||""==this.inputItem2.text){var t=parseInt(this.inputItem1.text),e=parseInt(this.inputItem2.text);e=e>0?e:1,this.sendChatMessage("@additem "+t+" "+e)}},e.prototype.doOneKey=function(){},e.prototype.onSelectMakeItem=function(t){},e}(TesterBasePage);__reflect(TesterCommonPage.prototype,"TesterCommonPage");var TesterWin=function(t){function e(){var e=t.call(this)||this;return e.NAMES=["char/byte","short","number","string","double","float","boolean"],e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TesterSkin"},e.prototype.initData=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list1.itemRenderer=CCLine,this.list2.itemRenderer=CCLine,this.list1.dataProvider=new eui.ArrayCollection(this.NAMES),this.list2.dataProvider=new eui.ArrayCollection(this.NAMES),this.viewStack.selectedIndex=0,this.addTouchEvent(this.btnClose,this.onTap),this.addTouchEvent(this.btnClose0,this.onTap),this.addTouchEvent(this.btnOpenWin,this.onTap),this.addTouchEvent(this.btnMakeItem,this.onTap),this.addTouchEvent(this.btnClear,this.onTap),this.addTouchEvent(this.btnSend,this.onTap),this.addTouchEvent(this.input1,this.onTap),this.addTouchEvent(this.input2,this.onTap),this.addTouchEvent(this.inputParam1,this.onTap),this.addTouchEvent(this.inputParam2,this.onTap),this.addTouchEvent(this.inputItemId,this.onTap),this.addTouchEvent(this.inputItemCount,this.onTap),this.addTouchEvent(this.inputOpenWin,this.onTap),this.list1.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectType,this),this.list2.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectType,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list1.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectType,this)},e.prototype.onTap=function(t){switch(t.target){case this.btnClose:case this.btnClose0:ViewManager.ins().close(this);break;case this.btnOpenWin:ViewManager.ins().open(this.inputOpenWin.text);break;case this.btnMakeItem:this.doMakeItem();break;case this.btnClear:break;case this.btnSend:this.sendMsg();break;case this.input1:this.input1.text="";break;case this.input2:this.input2.text="";break;case this.inputParam1:this.inputParam1.text="";break;case this.inputParam2:this.inputParam2.text="";break;case this.inputOpenWin:this.inputOpenWin.text="";break;case this.inputItemId:this.inputItemId.text="";break;case this.inputItemCount:this.inputItemCount.text=""}},e.prototype.doClearBag=function(){for(var t=0;2>t;t++)this.sendChatMessage("@clearbag "+t)},e.prototype.doMakeItem=function(){if((null!=this.inputItemId.text||""!=this.inputItemId.text||void 0!=this.inputItemId)&&RegExpUtil.NumericExp.test(this.inputItemId.text)){var t=parseInt(this.inputItemId.text),e=parseInt(this.inputItemCount.text);e=e>0?e:1,this.sendChatMessage("@additem "+t+" "+e)}},e.prototype.onSelectType=function(t){t.currentTarget==this.list1||t.currentTarget==this.list1},e.prototype.onClick=function(t){switch(t.target){case this.btnSend:this.sendMsg()}},e.prototype.writeBytes=function(t,e,i){switch(t){case this.NAMES[0]:e.writeByte(i);break;case this.NAMES[1]:e.writeShort(i);break;case this.NAMES[2]:e.writeNumber(i);break;case this.NAMES[3]:e.writeString(i);break;case this.NAMES[4]:e.writeDouble(i);break;case this.NAMES[5]:e.writeFloat(i);break;case this.NAMES[6]:e.writeBoolean(i);break;default:throw new Error("类型错误:"+t)}},e.prototype.sendMsg=function(){if(""!=this.input1.text&&null!=this.input1.text&&"0"!=this.input1.text&&""!=this.input2.text&&null!=this.input2.text&&"0"!=this.input2.text){var t=new GameByteArray,e=parseInt(this.input1.text),i=parseInt(this.input2.text);t.writeCmd(e,i),GameSocket.ins().send(t),CommonUtils.log("协议"+e+"-"+i+"发送成功!")}else CommonUtils.log("协议号输入有误")},e.prototype.sendChatMessage=function(t){GameLogic.ins().sendGMCommad(t),CommonUtils.log(t)},e}(BaseEuiView);__reflect(TesterWin.prototype,"TesterWin"),ViewManager.ins().reg(TesterWin,LayerManager.UI_Main),window.TesterWin=TesterWin;var AwardTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="AwardTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.itemlist=t[0],this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.itemlist=[]},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){for(var t=0;t<this.items.numChildren;t++){var e=this.items.getChildAt(t);if(e.visible=void 0!=this.itemlist[t],e.includeInLayout=void 0!=this.itemlist[t],void 0!=this.itemlist[t]){var i=new ItemCellData,n={item_slot_idx:0,item_type_id:this.itemlist[t][0],item_count:this.itemlist[t][1]};i.setItemCellData(n),e.data=i}}},e}(BaseEuiView);__reflect(AwardTipsView.prototype,"AwardTipsView"),ViewManager.ins().reg(AwardTipsView,LayerManager.UI_Main2),window.AwardTipsView=AwardTipsView;var ConnetTipsView=function(t){function e(){var e=t.call(this)||this;return e.func1=void 0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ConnetTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.closebtn,this.onCloseClick),this.info.textFlow=UtilProxy.generateTextFlow("连接已断开，是否重连？")},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){GameSocket.ins().reLogin2(),ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(ConnetTipsView.prototype,"ConnetTipsView"),ViewManager.ins().reg(ConnetTipsView,LayerManager.UI_Main2),window.ConnetTipsView=ConnetTipsView;var EquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.itemcell0=new ItemCell,e.skinName="EquipTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scrollerview.viewport=this.group_info0,this.itemcell0.SetShowTips(!1)},e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return this.itemdata=t[0],void 0==this.itemdata.itemConfig||void 0==this.itemdata.itemConfig.type?void TimerManager.ins().doTimer(1e3,1,function(){ViewManager.ins().close(e)},this):(this.addTouchEvent(this.closebg,this.OnCloseClick),this.addTouchEvent(this.closebtn,this.OnCloseClick),void this.initdata())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebg,this.OnCloseClick),this.removeTouchEvent(this.closebtn,this.OnCloseClick)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.initdata=function(){var t=new ItemCellData;t.item_slot_idx=this.itemdata.item_slot_idx,t.item_type_id=this.itemdata.item_type_id,t.itemConfig=this.itemdata.itemConfig,this.itemcell0.data=t,this.nameLab0.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.itemConfig.quality-1],t.itemConfig.name]),this.SetEquipInfo(),this.SetGemInfo(),this.SetUpStarInfo()},e.prototype.SetEquipInfo=function(){var t=this.itemdata.itemConfig;this.label_0.textFlow=UtilProxy.StrFormart("|C:10&等级：|@0 ",[GlobalFunc.getZhuanLevelLstr(t.requiredlevel,t.reborn)]),this.label_1.textFlow=UtilProxy.StrFormart("|C:10&战力：|@0 ",[UtilProxy.GetAttrFight(t)]),this.title_0.textFlow=UtilProxy.generateTextFlow("|C:10&基础属性|"),this.title2.textFlow=UtilProxy.generateTextFlow("|C:10&宝石属性|"),this.title3.textFlow=UtilProxy.generateTextFlow("|C:10&升星属性|");var e=UpgradeProxy.ins().getUpgradeLevelByPart(t.part);this.title_1.textFlow=0==e?UtilProxy.generateTextFlow("|C:10&强化属性|"):UtilProxy.StrFormart("|C:10&强化属性| |C:7&(+@0 )|",[e]);var i=RefineProxy.ins().getPartRefineLevel(t.part);this.title_2.textFlow=0==e?UtilProxy.generateTextFlow("|C:10&精炼属性|"):UtilProxy.StrFormart("|C:10&精炼属性| |C:7&(+@0 )|",[i]);var n=UpStarProxy.ins().getCurStarPreAdd(t.part),o="",s=AttrProxy.getAttrInfo(t);if(void 0!=s)for(var r=0;r<s.length;r++){var a=0;if(a=Math.floor(s[r][1]*n),""==o)o=0==a?UtilProxy.getStr("@0 +@1 ",[s[r][0],s[r][1]]):UtilProxy.getStr("@0 +@1 |C:7&(升星+@2 )|",[s[r][0],s[r][1],a]);else{var h=0==a?UtilProxy.getStr("\n@0 +@1 ",[s[r][0],s[r][1]]):UtilProxy.getStr("\n@0 +@1 |C:7&(升星+@2 )|",[s[r][0],s[r][1],a]);o+=h}}if(this.info_0.textFlow=UtilProxy.generateTextFlow(o),void 0!=GlobalConfig.getIntensify_part_attrConfig(e)){for(var l=GlobalConfig.getIntensify_part_attrConfig(e)[t.part],p=AttrProxy.getAttrInfo(l),h="",r=0;r<p.length;r++)h=p[r][2]+"+"+p[r][1];this.info_1.text=h}else this.info_1.text="+0";var c=RefineProxy.ins().getRefineAttr(t.part,i);if(void 0!=c){for(var p=AttrProxy.getAttrInfo(c),h="",r=0;r<p.length;r++)h=""==h?p[r][2]+"+"+p[r][1]:h+"\n"+p[r][2]+"+"+p[r][1];this.info_2.text=h}else this.info_2.text="+0";this.SetGroup()},e.prototype.SetGroup=function(){this.group_0.height=this.title_0.height+this.info_0.height+5,this.group_1.height=this.title_1.height+Math.max(this.info_1.height,this.info_2.height)+5},e.prototype.SetGemInfo=function(){this.SetSingleGem(1,this.icon0,this.name0,this.pro0),this.SetSingleGem(2,this.icon1,this.name1,this.pro1),this.SetSingleGem(3,this.icon2,this.name2,this.pro2),this.SetSingleGem(4,this.icon3,this.name3,this.pro3)},e.prototype.SetSingleGem=function(t,e,i,n){var o=this.itemdata.itemConfig,s=SoulStoneProxy.ins().getStoneByPartAndType(o.part,t);if(0==s)return e.source=AssetMgr.getIconResource(SoulStoneProxy.STONE_NAME[t-1]),i.text="[未镶嵌]",void(n.visible=!1);var r=GlobalConfig.getItemsConfig(s);e.source=AssetMgr.getIconResource(r.displayid),i.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[r.quality-1],r.name]),n.visible=!0;var a=GlobalConfig.getSoulstone_dataConfig(s),h="",l=AttrProxy.getAttrInfo(a);if(void 0!=l)for(var p=0;p<l.length;p++)""==h?h=UtilProxy.getStr("@0  +@1 ",[l[p][2],l[p][1]]):h+=UtilProxy.getStr(" @0  +@1 ",[l[p][2],l[p][1]]);n.text=h},e.prototype.SetUpStarInfo=function(){for(var t=this.itemdata.itemConfig,e=UpStarProxy.ins().getUpStarByPart(t.part),i=Math.floor(e/10)+1,n=e%10,o=0;o<this.stars.numChildren;o++){var s=this.stars.getChildAt(o);s.source=n>o?"shengxing_icon_01_0"+(i+1):"shengxing_icon_01_0"+i}},e}(BaseEuiView);__reflect(EquipTipsView.prototype,"EquipTipsView"),ViewManager.ins().reg(EquipTipsView,LayerManager.UI_Popup),window.EquipTipsView=EquipTipsView;var HuobanEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.itemcell0=new ItemCell,e.partNameMap=[["蹄铁","缰绳","马鞍","马镫"],["玉佩","香囊","发簪","耳环"],["铃铛","兽甲","项圈","兽爪"]],e.skinName="HuobanEquipTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scrollerview.viewport=this.group_info0,this.itemcell0.SetShowTips(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.itemdata=t[0],void 0==this.itemdata.itemConfig||void 0==this.itemdata.itemConfig.type?void TimerManager.ins().doTimer(1e3,1,function(){ViewManager.ins().close(this)},this):(this.addTouchEvent(this.closebg,this.OnCloseClick),this.addTouchEvent(this.closebtn,this.OnCloseClick),void this.initdata())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebg,this.OnCloseClick),this.removeTouchEvent(this.closebtn,this.OnCloseClick)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.initdata=function(){var t=new ItemCellData;t.item_slot_idx=this.itemdata.item_slot_idx,t.item_type_id=this.itemdata.item_type_id,t.itemConfig=this.itemdata.itemConfig,this.itemcell0.data=t,this.nameLab0.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.itemConfig.quality-1],t.itemConfig.name]),this.SetEquipInfo()
},e.prototype.SetEquipInfo=function(){var t=this.itemdata.itemConfig;this.label_0.textFlow=UtilProxy.StrFormart("|C:10&等级：|@0 ",[GlobalFunc.getZhuanLevelLstr(t.requiredlevel,t.reborn)]),this.label_1.textFlow=UtilProxy.StrFormart("|C:10&战力：|@0 ",[UtilProxy.GetAttrFight(t)]),this.title_0.textFlow=UtilProxy.generateTextFlow("|C:10&基础属性：|"),this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&套装属性：|"),this.title_2.textFlow=UtilProxy.generateTextFlow("|C:10&物品描述：|"),this.title_3.textFlow=UtilProxy.generateTextFlow("|C:10&物品来源：|"),this.info_2.textFlow=UtilProxy.generateTextFlow(t.TIPS),this.info_3.textFlow=UtilProxy.generateTextFlow(t.tips_source);var e="",i=1;3==t.subtype?i=1:4==t.subtype?i=2:5==t.subtype&&(i=3);for(var n=BagProxy.ins().getHuobanBodyEquipPartGrade(HuobanProxy.ins().getBagBodyEquipType(i)),o=HuobanProxy.ins().getHuobanEquipMaxLevel(i),s=["坐骑","仙侣","灵宠"],r="",a=0,h=HuobanProxy.ins().getHuobanEquipMinGrade(i),l=HuobanProxy.ins().getHuobanEquipMinGradePre(i),p=0;p<n.length;p++){var c=n[p]>=o;c&&a++,r+=UtilProxy.getStr("\n|C:@0 &@1 阶@2 @3 |",[c?1:3,o,this.partNameMap[i-1][p],c?"1/1":"0/1"])}r=UtilProxy.getStr("|C:@0 &@1 阶套装(@2 /@3 ) |",[7,o,a,n.length])+r,r+=UtilProxy.getStr("\n|C:@0 &@1 阶套装效果：@2 装备属性+@3 %|",[7,o,s[i-1],HuobanProxy.ins().getHuobanEquipMaxGradePre(i)]),r+=UtilProxy.getStr("\n|已激活套装效果：@0 |",[0==h?"无":s[i-1]+"装备属性+"+HuobanProxy.ins().getHuobanEquipMinGradePre(i)+"%"]),this.info_1.textFlow=UtilProxy.generateTextFlow(r);var u=AttrProxy.getAttrInfo(t);if(void 0!=u)for(var p=0;p<u.length;p++){var d=0;if(d=Math.floor(u[p][1]*l*.01),""==e)e=0==d?UtilProxy.getStr("@0 +@1 ",[u[p][0],u[p][1]]):UtilProxy.getStr("@0 +@1 |C:7&(+@2 )|",[u[p][0],u[p][1],d]);else{var g=0==d?UtilProxy.getStr("\n@0 +@1 ",[u[p][0],u[p][1]]):UtilProxy.getStr("\n@0 +@1 |C:7&(+@2 )|",[u[p][0],u[p][1],d]);e+=g}}this.info_0.textFlow=UtilProxy.generateTextFlow(e),this.SetGroup()},e.prototype.SetGroup=function(){this.group_0.height=this.title_0.height+this.info_0.height+5,this.group_1.height=this.title_1.height+this.info_1.height+5,this.group_2.height=this.title_2.height+this.info_2.height+5},e}(BaseEuiView);__reflect(HuobanEquipTipsView.prototype,"HuobanEquipTipsView"),ViewManager.ins().reg(HuobanEquipTipsView,LayerManager.UI_Popup),window.HuobanEquipTipsView=HuobanEquipTipsView;var ItemModelTipsView=function(t){function e(){var e=t.call(this)||this;return e.itemcell=new ItemCell,e.skinName="ItemModelTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scrollerview.viewport=this.group_info,this.itemcell.SetShowTips(!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemdata=t[0],this.addTouchEvent(this.closebg,this.OnCloseClick),this.addTouchEvent(this.closebtn,this.OnCloseClick),this.initdata()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebg,this.OnCloseClick),this.removeTouchEvent(this.closebtn,this.OnCloseClick)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.initdata=function(){var t=new ItemCellData;t.item_slot_idx=this.itemdata.item_slot_idx,t.item_type_id=this.itemdata.item_type_id,t.itemConfig=this.itemdata.itemConfig,this.itemcell.data=t,this.nameLab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.itemConfig.quality-1],t.itemConfig.name]),this.SetItemInfo(),this.ShowModel(),this.SetGroup()},e.prototype.SetItemInfo=function(){var t=this.itemdata.itemConfig;if(this.group_0.visible=4==t.bag_type,this.group_0.includeInLayout=4==t.bag_type,4==t.bag_type){this.title_0.textFlow=UtilProxy.generateTextFlow("|C:10&基础属性：|");var e="",i=GlobalConfig.getSoulstone_dataConfig(t.id),n=AttrProxy.getAttrInfo(i);if(void 0!=n)for(var o=0;o<n.length;o++)e=""==e?n[o][0]+n[o][1]:e+"\n"+n[o][0]+n[o][1];this.info_0.text=e}this.label_1.textFlow=UtilProxy.StrFormart("|C:10&使用等级：|@0 ",[GlobalFunc.getZhuanLevelLstr(t.requiredlevel,t.reborn)]),this.label_2.textFlow=UtilProxy.StrFormart("|C:10&物品数量：|@0 ",[this.itemdata.item_count]),this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&物品描述：|"),this.title_2.textFlow=UtilProxy.generateTextFlow("|C:10&物品来源：|"),this.info_1.textFlow=UtilProxy.generateTextFlow(t.TIPS),this.info_2.textFlow=UtilProxy.generateTextFlow(t.tips_source)},e.prototype.ShowModel=function(){var t=this.itemdata.itemConfig,e=t.show_model[1].toString(),i=e.split("|"),n=i.length>1?i[RoleProxy.ins().getRoleSex()-1]:i[0];if(this.model.removeChildren(),this.model.x=t.show_model[2],this.model.y=t.show_model[3],2==t.show_model[0]){var o=new egret.MovieClip;UtilProxy.GetMovieClip(n,o,-1,void 0),this.model.addChild(o)}else if(3==t.show_model[0])UtilProxy.GetMovieClipById(Number(n),this.model);else if(1==t.show_model[0]){var s=new eui.Image;s.source=n,this.model.addChild(s)}},e.prototype.SetGroup=function(){this.group_0.height=this.title_0.height+this.info_0.height+10,this.group_1.height=this.title_1.height+this.info_1.height+10,this.group_2.height=this.title_2.height+this.info_2.height+10},e}(BaseEuiView);__reflect(ItemModelTipsView.prototype,"ItemModelTipsView"),ViewManager.ins().reg(ItemModelTipsView,LayerManager.UI_Popup),window.ItemModelTipsView=ItemModelTipsView;var ItemTipsView=function(t){function e(){var e=t.call(this)||this;return e.itemcell=new ItemCell,e.usecount=0,e.isShowUse=!1,e.LvUpType=-1,e.LvUpId=-1,e.skinName="ItemTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.scrollerview.viewport=this.group_info,this.itemcell.SetShowTips(!1)},e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(this.itemdata=t[0],void 0==this.itemdata.itemConfig||void 0==this.itemdata.itemConfig.type)return void TimerManager.ins().doTimer(1e3,1,function(){ViewManager.ins().close(e)},this);if(this.isShowUse=!1,void 0!=t[1]&&(this.isShowUse=t[1]),this.LvUpType=-1,this.LvUpId=-1,t[2]&&(this.LvUpType=t[2][0]||-1,this.LvUpId=t[2][1]||-1),this.addTouchEvent(this.closebg,this.OnCloseClick),this.addTouchEvent(this.closebtn,this.OnCloseClick),this.addTouchEvent(this.cut_10,this.onclick),this.addTouchEvent(this.add_10,this.onclick),this.addTouchEvent(this.add,this.onclick),this.addTouchEvent(this.cut,this.onclick),this.addTouchEvent(this.use,this.onclick),this.initdata(),1!=this.itemdata.itemConfig.type&&(2!=this.itemdata.itemConfig.type||4!=this.itemdata.itemConfig.subtype)){var n=this.itemdata.itemConfig;if(n.show_model.length>0)return TimerManager.ins().doTimer(500,1,function(){ViewManager.ins().close(e)},this),void ViewManager.ins().open(ItemModelTipsView,this.itemdata)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebg,this.OnCloseClick),this.removeTouchEvent(this.closebtn,this.OnCloseClick),this.removeTouchEvent(this.cut_10,this.onclick),this.removeTouchEvent(this.add_10,this.onclick),this.removeTouchEvent(this.add,this.onclick),this.removeTouchEvent(this.cut,this.onclick),this.removeTouchEvent(this.use,this.onclick),TimerManager.ins().remove(this.SetTimeLab,this)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onclick=function(t){switch(t.currentTarget){case this.add:if(this.itemdata.itemConfig&&2==this.itemdata.itemConfig.type&&20==this.itemdata.itemConfig.subtype)return void TipsControl.ins().showTips("该物品只能单个使用");this.usecount=Math.min(this.usecount+1,this.itemdata.item_count),this.SetCountLab();break;case this.add_10:if(this.itemdata.itemConfig&&2==this.itemdata.itemConfig.type&&20==this.itemdata.itemConfig.subtype)return void TipsControl.ins().showTips("该物品只能单个使用");this.usecount=Math.min(this.usecount+10,this.itemdata.item_count),this.SetCountLab();break;case this.cut:if(this.itemdata.itemConfig&&2==this.itemdata.itemConfig.type&&20==this.itemdata.itemConfig.subtype)return void TipsControl.ins().showTips("该物品只能单个使用");this.usecount=Math.max(this.usecount-1,1),this.SetCountLab();break;case this.cut_10:if(this.itemdata.itemConfig&&2==this.itemdata.itemConfig.type&&20==this.itemdata.itemConfig.subtype)return void TipsControl.ins().showTips("该物品只能单个使用");this.usecount=Math.max(this.usecount-10,1),this.SetCountLab();break;case this.use:this.LvUpType>0?this.OnLvUp():this.UseItem()}},e.prototype.UseItem=function(){var t=this.itemdata.itemConfig;if(void 0!=t){if(t.reborn>RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)||t.requiredlevel>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL))return void TipsControl.ins().showTips("等级不足");if(1==t.type){t=t;var i=BagProxy.ins().getBodyEquipByPart(t.part);if(void 0!=i&&void 0!=i.itemConfig){var n=i.itemConfig;n.itemlevel>t.itemlevel}BagProxy.ins().C2SReqKnapsackArm(this.itemdata.item_slot_idx,t.part)}else{if(2==t.type&&20==t.subtype)return ViewManager.ins().close(e),void ViewManager.ins().open(ItemSelectAwardTips,this.itemdata);if(this.lefttime<=0&&2==t.type&&16==t.subtype)return void TipsControl.ins().showTips("您的直升丹已过期，无法使用，将通过邮件进行转化返还！");if(2==t.type&&4==t.subtype){if(t=t,t.vip_level>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))return void(t.vip_level>18?TipsControl.ins().showTips(UtilProxy.getStr("SVIP@0 才能使用",[t.vip_level-18])):TipsControl.ins().showTips(UtilProxy.getStr("VIP@0 才能使用",[t.vip_level])))}else t=t,t.openview.length>0&&ViewManager.ins().OpenViewById(t.openview[0],t.openview[1]);if(BagProxy.ins().GetBagLeftCount(BagType.EQUIP)<20)return void TipsControl.ins().ShowTips1("背包格子不够，是否一键熔炼?",function(){},function(){BagProxy.ins().OneKeySmelt()});var o=[],s=[];s[0]=this.itemdata.item_slot_idx,s[1]=this.usecount,o[0]=s,BagProxy.ins().C2SReqKnapsackUse(o)}ViewManager.ins().close(e)}},e.prototype.OnLvUp=function(){var t=this.itemdata.itemConfig;if(void 0!=t){var e=BagProxy.ins().GetLVRankByType(this.LvUpType,this.LvUpId);if(t.flags>e)return void TipsControl.ins().showTips("等阶低于直升丹使用要求，无法使用");if(this.lefttime<=0&&2==t.type&&16==t.subtype)return void TipsControl.ins().showTips("您的直升丹已过期，无法使用，将通过邮件进行转化返还！");switch(this.LvUpType){case LvUpType.emZuoqi:this.LvUpId>0?HorseProxy.ins().C2SReqHorseSkinExtendUpgrade(this.LvUpId,1,this.itemdata.item_slot_idx):HorseProxy.ins().C2SReqHorseOnekeyUpgrade(1,this.itemdata.item_slot_idx);break;case LvUpType.emXL:this.LvUpId>0?HuobanProxy.ins().C2SReqBelleSkinExtendUpgrade(this.LvUpId,1,this.itemdata.item_slot_idx):HuobanProxy.ins().C2SReqBelleOnekeyUpgrade(1,this.itemdata.item_slot_idx);break;case LvUpType.emCW:this.LvUpId>0?PetProxy.ins().C2SReqPetSkinExtendUpgrade(this.LvUpId,1,this.itemdata.item_slot_idx):PetProxy.ins().C2SReqPetOnekeyUpgrade(1,this.itemdata.item_slot_idx);break;case LvUpType.emSB:WeaponProxy.ins().C2SReqWeaponSingleUpgradeExtend(1,this.LvUpId,1,this.itemdata.item_slot_idx);break;case LvUpType.emXB:WeaponProxy.ins().C2SReqWeaponSingleUpgradeExtend(2,this.LvUpId,1,this.itemdata.item_slot_idx);break;case LvUpType.emWing:WeaponProxy.ins().C2SReqWeaponSingleUpgradeExtend(3,this.LvUpId,1,this.itemdata.item_slot_idx);break;case LvUpType.emSZ:GrowupProxy.ins().C2SReqGrowupFashionUpgrade(this.LvUpId,3,this.itemdata.item_slot_idx)}ViewManager.ins().close(this)}},e.prototype.initdata=function(){var t=new ItemCellData;t.item_slot_idx=this.itemdata.item_slot_idx,t.item_type_id=this.itemdata.item_type_id,t.itemConfig=this.itemdata.itemConfig,this.itemcell.data=t,this.nameLab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.itemConfig.quality-1],t.itemConfig.name]),1==t.itemConfig.type?(this.SetEquipInfo(),this.use.label="穿戴"):(this.SetItemInfo(),this.use.label="使用"),1!=t.itemConfig.type&&(2!=t.itemConfig.type||4!=t.itemConfig.subtype&&1!=t.itemConfig.subtype&&2!=t.itemConfig.subtype&&3!=t.itemConfig.subtype&&5!=t.itemConfig.subtype&&6!=t.itemConfig.subtype&&7!=t.itemConfig.subtype&&13!=t.itemConfig.subtype&&14!=t.itemConfig.subtype&&16!=t.itemConfig.subtype&&17!=t.itemConfig.subtype&&18!=t.itemConfig.subtype&&20!=t.itemConfig.subtype)||!this.isShowUse?(this.b_group.visible=!1,this.bg.height=445):(this.usecount=this.itemdata.item_count,this.b_group.visible=!0,this.bg.height=547,this.SetCountLab(),this.count_g.visible=0==this.itemdata.expire_time,this.timelab.visible=this.itemdata.expire_time>0,this.itemdata.expire_time>0&&(this.lefttime=this.itemdata.expire_time-GameLogic.ins().getServerTime(),this.SetTimeLab(),this.lefttime>0&&(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this))))},e.prototype.SetTimeLab=function(){this.lefttime>0?(this.timelab.textFlow=UtilProxy.StrFormart("|C:4&@0 后失效|",[UtilProxy.getTimeHMSString(this.lefttime)]),this.lefttime=this.lefttime-1):(this.timelab.textFlow=UtilProxy.generateTextFlow("|C:4&已过期|"),TimerManager.ins().remove(this.SetTimeLab,this))},e.prototype.SetCountLab=function(){this.count.text=this.usecount+"/"+this.itemdata.item_count},e.prototype.SetEquipInfo=function(){this.group_0.visible=!0,this.group_0.includeInLayout=!0;var t=this.itemdata.itemConfig;this.label_1.textFlow=UtilProxy.StrFormart("|C:10&等级：|@0 ",[t.god_order>0&&t.part>=11&&t.part<=40?UtilProxy.getStr("@0 阶",[t.god_order]):GlobalFunc.getZhuanLevelLstr(t.requiredlevel,t.reborn)]),this.label_2.textFlow=UtilProxy.StrFormart("|C:10&战力：|@0 ",[UtilProxy.GetAttrFight(t)]),this.title_0.textFlow=UtilProxy.generateTextFlow("|C:10&基础属性：|"),this.group_1.visible=""!=t.TIPS,this.group_1.includeInLayout=""!=t.TIPS,this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&物品描述：|"),this.title_1.visible=""!=t.TIPS,this.title_2.textFlow=UtilProxy.generateTextFlow("|C:10&物品来源：|"),this.title_2.visible=""!=t.tips_source;var e="",i=AttrProxy.getAttrInfo(t);if(void 0!=i)for(var n=0;n<i.length;n++)e=""==e?i[n][0]+i[n][1]:e+"\n"+i[n][0]+i[n][1];this.info_0.text=e,this.info_1.textFlow=UtilProxy.generateTextFlow(t.TIPS),this.info_1.visible=""!=t.TIPS,this.info_2.textFlow=UtilProxy.generateTextFlow(t.tips_source),this.info_2.visible=""!=t.tips_source,this.SetGroup()},e.prototype.SetItemInfo=function(){var t=this.itemdata.itemConfig;if(this.group_0.visible=4==t.bag_type,this.group_0.includeInLayout=4==t.bag_type,4==t.bag_type){this.title_0.textFlow=UtilProxy.generateTextFlow("|C:10&基础属性：|");var e="",i=GlobalConfig.getSoulstone_dataConfig(t.id),n=AttrProxy.getAttrInfo(i);if(void 0!=n)for(var o=0;o<n.length;o++)e=""==e?n[o][0]+n[o][1]:e+"\n"+n[o][0]+n[o][1];this.info_0.text=e}this.label_1.textFlow=UtilProxy.StrFormart("|C:10&使用等级：|@0 ",[GlobalFunc.getZhuanLevelLstr(t.requiredlevel,t.reborn)]),this.label_2.textFlow=UtilProxy.StrFormart("|C:10&物品数量：|@0 ",[this.itemdata.item_count]),this.title_1.textFlow=UtilProxy.generateTextFlow("|C:10&物品描述：|"),this.title_2.textFlow=UtilProxy.generateTextFlow("|C:10&物品来源：|"),this.info_1.textFlow=UtilProxy.generateTextFlow(t.TIPS),this.info_2.textFlow=UtilProxy.generateTextFlow(t.tips_source),this.SetGroup()},e.prototype.SetGroup=function(){this.group_0.height=this.title_0.height+this.info_0.height+10,this.group_1.height=this.title_1.height+this.info_1.height+10,this.group_2.height=this.title_2.height+this.info_2.height+10},e}(BaseEuiView);__reflect(ItemTipsView.prototype,"ItemTipsView"),ViewManager.ins().reg(ItemTipsView,LayerManager.UI_Popup),window.ItemTipsView=ItemTipsView;var ItemVIPTipsView=function(t){function e(){var e=t.call(this)||this;return e.logData={num:0,str:""},e.vipLimit=0,e.money=100,e.up=10,e.isCanUse=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName=TipsShow1Skin},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.logData.num=t[0],this.logData.str=t[1],this.addTouchEvent(this.black,this.onCloseClick),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn1,this.onCloseClick),this.addTouchEvent(this.btn2,this.onSureClick),this.initdata()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.black,this.onCloseClick),this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.initdata=function(){this.btn2.label="提升VIP",this.logData.num>18?this.info.textFlow=UtilProxy.generateTextFlow("需要SVIP"+(this.logData.num-18)+"才可以购买！\n"+this.logData.str):this.info.textFlow=UtilProxy.generateTextFlow("需要VIP"+this.logData.num+"才可以购买！\n"+this.logData.str)},e.prototype.onCloseClick=function(){ViewManager.ins().close(this)},e.prototype.onSureClick=function(){LimitActProxy.ins().IsFristRechargeOpen()?ViewManager.ins().open(FirstRechargeView):ViewManager.ins().open(VIPView),ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(ItemVIPTipsView.prototype,"ItemVIPTipsView"),ViewManager.ins().reg(ItemVIPTipsView,LayerManager.UI_Popup),window.ItemVIPTipsView=ItemVIPTipsView;var JihuoType;!function(t){t[t.Fashion=1]="Fashion",t[t.Shengbing=2]="Shengbing",t[t.Xuanbing=3]="Xuanbing",t[t.wing=4]="wing",t[t.tujian=5]="tujian",t[t.zhenbao=6]="zhenbao",t[t.xianfu=7]="xianfu",t[t.shengqi=8]="shengqi"}(JihuoType||(JihuoType={}));var JihuoTipsView=function(t){function e(){var e=t.call(this)||this;return e.curtype=0,e.id=0,e.path="",e.coldtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="JihuoTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.bg,this.onCloseClick),this.curtype=t[0]||0,this.id=t[1]||0,this.path=t[2]||"",this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.bg,this.onCloseClick),TimerManager.ins().remove(this.SetTimeLab,this),this.model.removeChildren()},e.prototype.onCloseClick=function(t){this.CloseView()},e.prototype.CloseView=function(){ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){this.model.removeChildren();var t=GlobalConfig.getLimitsConfig(1).activation_pos[this.curtype-1];switch(t&&(this.model.x=t[0],this.model.y=t[1]),this.curtype){case JihuoType.Fashion:this.model.addChild(UtilProxy.GetRoleObjectById(this.id,0,0,void 0,RoleProxy.ins().getRoleSex()));break;case JihuoType.tujian:var e=GlobalConfig.getTujian_dataConfig(this.id),i=new BookItem;i.data=e,i.SetBg(!1),i.SetRed(!1),this.model.addChild(i);break;default:var n=new egret.MovieClip;UtilProxy.GetMovieClip(this.path,n,-1,void 0),this.model.addChild(n),this.curtype==JihuoType.xianfu&&(n.y=100)}this.effect.removeChildren(),UtilProxy.GetMovieClipById(56,this.effect),this.coldtime=5,this.SetTimeLab(),this.coldtime>0&&(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,5,this.SetTimeLab,this,this.CloseView,this))},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&点击空白处关闭 (@0 S)|",[this.coldtime]),this.coldtime=this.coldtime-1},e}(BaseEuiView);__reflect(JihuoTipsView.prototype,"JihuoTipsView"),ViewManager.ins().reg(JihuoTipsView,LayerManager.UI_Main2),window.JihuoTipsView=JihuoTipsView;var MasterType;!function(t){t[t.Intensify=0]="Intensify",t[t.Soulstone=1]="Soulstone",t[t.Upstar=2]="Upstar",t[t.GodEquip=3]="GodEquip",t[t.GodForge=4]="GodForge",t[t.Refine=5]="Refine"}(MasterType||(MasterType={}));var MasterTipsView=function(t){function e(){var e=t.call(this)||this;return e.CurShowType=0,e.effectPics=["dashi_01","dashi_02","dashi_03",["dashi_07","dashi_08","dashi_09","dashi_06"],"dashi_05","dashi_04"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MasterTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.CurShowType=t[0],this.addTouchEvent(this.closeup,this.onUpTipsClick),this.addTouchEvent(this.closeup1,this.onUpTipsClick),EventProxy.AddListener(this,EventType.S2CRepIntensifySuit,this.ShowEffect),EventProxy.AddListener(this,EventType.S2CRepUpstarUpgradeMaster,this.ShowEffect),EventProxy.AddListener(this,EventType.S2CRepSoulstoneUpgradeMaster,this.ShowEffect),EventProxy.AddListener(this,EventType.S2CRepGodequipSuit,this.ShowEffect),EventProxy.AddListener(this,EventType.S2CRepGodequipForgeSuit,this.ShowEffect),EventProxy.AddListener(this,EventType.S2CRepIntensifySuitRefine,this.ShowEffect),this.effectfont.visible=!1,this.ShowUpTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeup,this.onUpTipsClick),this.removeTouchEvent(this.closeup1,this.onUpTipsClick),EventProxy.RemoveListener(this,EventType.S2CRepIntensifySuit,this.ShowEffect),EventProxy.RemoveListener(this,EventType.S2CRepUpstarUpgradeMaster,this.ShowEffect),EventProxy.RemoveListener(this,EventType.S2CRepSoulstoneUpgradeMaster,this.ShowEffect),EventProxy.RemoveListener(this,EventType.S2CRepGodequipSuit,this.ShowEffect),EventProxy.RemoveListener(this,EventType.S2CRepGodequipForgeSuit,this.ShowEffect),EventProxy.RemoveListener(this,EventType.S2CRepIntensifySuitRefine,this.ShowEffect),egret.Tween.removeTweens(this.effectfont),this.effectfont.visible=!1,this.effect.removeChildren(),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onUpTipsClick=function(t){switch(t.currentTarget){case this.closeup:ViewManager.ins().close(e);break;case this.closeup1:if(this.CurShowType==MasterType.Intensify){var i=GlobalConfig.getIntensify_suit_dataConfig(UpgradeProxy.ins().suit_id+1);if(void 0!=i&&UpgradeProxy.ins().getAllUpgradeLevel()>=i.level)return void UpgradeProxy.ins().C2SReqIntensifySuit(i.id)}if(this.CurShowType==MasterType.Upstar){var i=GlobalConfig.getUpstar_master_dataConfig(UpStarProxy.ins().master_level+1);if(void 0!=i){var n=UpStarProxy.ins().getUpStarLevelCount(i.star);if(n>=10)return void UpStarProxy.ins().C2SReqUpstarUpgradeMaster()}}if(this.CurShowType==MasterType.Soulstone){var i=GlobalConfig.getSoulstone_master_dataConfig(SoulStoneProxy.ins().master_level+1);if(void 0!=i){var n=SoulStoneProxy.ins().getTotalStoneLevel();if(n>=i.total_level)return void SoulStoneProxy.ins().C2SReqSoulstoneUpgradeMaster()}}if(this.CurShowType==MasterType.GodEquip){var i=GlobalConfig.getGod_item_suitConfig(GodEquipProxy.ins().CurType+1,GodEquipProxy.ins().getGodSuitId(GodEquipProxy.ins().CurType+1)+1);if(void 0!=i){var n=GodEquipProxy.ins().getGodEquipLevelCount(GodEquipProxy.ins().CurType,i.need_level);if(n>=10)return void GodEquipProxy.ins().C2SReqGodequipSuit(GodEquipProxy.ins().CurType+1,i.suit_id)}}if(this.CurShowType==MasterType.GodForge){var i=GlobalConfig.getGod_forge_suit_dataConfig(GodEquipProxy.ins().CurType+1,GodEquipProxy.ins().getGodForgeSuitId(GodEquipProxy.ins().CurType+1)+1);if(void 0!=i){var n=GodEquipProxy.ins().getGodForgeLevelCount(GodEquipProxy.ins().CurType,i.need_level);if(n>=10)return void GodEquipProxy.ins().C2SReqGodequipForgeSuit(GodEquipProxy.ins().CurType+1,i.suit_id)}}if(this.CurShowType==MasterType.Refine){var i=GlobalConfig.getRefine_suit_dataConfig(RefineProxy.ins().suit_level+1);if(void 0!=i&&RefineProxy.ins().getMinRefineLevel()>=i.level)return void RefineProxy.ins().C2SReqIntensifySuitRefine()}ViewManager.ins().close(e)}},e.prototype.ShowEffect=function(){UtilProxy.GetMovieClipById(105,this.effect),this.ShowUpTipsInfo();var t=this.effectfont.getChildAt(0),e=this.effectPics[this.CurShowType];this.CurShowType==MasterType.GodEquip&&(e=this.effectPics[this.CurShowType][GodEquipProxy.ins().CurType]),t.source=e.toString(),TimerManager.ins().doTimer(500,1,function(){this.effectfont.alpha=1,this.effectfont.visible=!0,egret.Tween.get(this.effectfont).to({alpha:1},1e3).to({alpha:0},100)},this)},e.prototype.ShowUpTipsInfo=function(){var t=void 0,e=void 0,i=0,n=0,o=0,s=["强化大师","灵石大师","升星大师","套装","神铸大师","精炼大师"],r=["qianghua_btn_qianghuadashi","lingshi_btn_lingshidashi","qianghua_btn_shengxingjieshu","qianghua_btn_qianghuadashi","qianghua_btn_qianghuadashi","qianghua_btn_qianghuadashi"];this.iconpic.source=r[this.CurShowType],this.CurShowType==MasterType.Intensify?(i=UpgradeProxy.ins().suit_id,t=GlobalConfig.getIntensify_suit_dataConfig(i),e=GlobalConfig.getIntensify_suit_dataConfig(i+1),t&&(n=t.level),e&&(o=e.level)):this.CurShowType==MasterType.Soulstone?(i=SoulStoneProxy.ins().master_level,t=GlobalConfig.getSoulstone_master_dataConfig(i),e=GlobalConfig.getSoulstone_master_dataConfig(i+1),t&&(n=t.total_level),e&&(o=e.total_level)):this.CurShowType==MasterType.Upstar?(i=UpStarProxy.ins().master_level,t=GlobalConfig.getUpstar_master_dataConfig(i),e=GlobalConfig.getUpstar_master_dataConfig(i+1),t&&(n=t.star),e&&(o=e.star)):this.CurShowType==MasterType.GodEquip?(i=GodEquipProxy.ins().getGodSuitId(GodEquipProxy.ins().CurType+1),t=GlobalConfig.getGod_item_suitConfig(GodEquipProxy.ins().CurType+1,i),e=GlobalConfig.getGod_item_suitConfig(GodEquipProxy.ins().CurType+1,i+1),t&&(n=t.need_level),e&&(o=e.need_level)):this.CurShowType==MasterType.GodForge?(i=GodEquipProxy.ins().getGodForgeSuitId(GodEquipProxy.ins().CurType+1),t=GlobalConfig.getGod_forge_suit_dataConfig(GodEquipProxy.ins().CurType+1,i),e=GlobalConfig.getGod_forge_suit_dataConfig(GodEquipProxy.ins().CurType+1,i+1),t&&(n=t.need_level),e&&(o=e.need_level)):this.CurShowType==MasterType.Refine&&(i=RefineProxy.ins().suit_level,t=GlobalConfig.getRefine_suit_dataConfig(i),e=GlobalConfig.getRefine_suit_dataConfig(i+1),t&&(n=t.level),e&&(o=e.level)),this.tipszhan.textFlow=UtilProxy.StrFormart("|C:10&战力 +@0 |",[UtilProxy.GetAttrFight(t)]),this.tipsname.text=UtilProxy.getStr("@0 @1 阶",[s[this.CurShowType],i]),this.tipslv.text=i+"阶",this.SetUpTips(t,n,this.curlevel,this.curtipspro,!1),this.SetUpTips(e,o,this.nextlevel,this.nexttipspro,!0),this.SetEffectFontLevel(i)},e.prototype.SetEffectFontLevel=function(t){var e=this.effectfont.getChildAt(1);e.text=t.toString()},e.prototype.SetUpTips=function(t,e,i,n,o){var s=["全身强化 @0 ","灵石总等级达到@0 ","全身升星 +@0 ","全身神装达到@0 阶","全身神铸达到@0 级","全身精炼 @0 "],r=[UpgradeProxy.ins().getAllUpgradeLevel(),SoulStoneProxy.ins().getTotalStoneLevel(),UpStarProxy.ins().getUpStarLevelCount(e),GodEquipProxy.ins().getGodEquipLevelCount(GodEquipProxy.ins().CurType,e),GodEquipProxy.ins().getGodForgeLevelCount(GodEquipProxy.ins().CurType,e),RefineProxy.ins().getMinRefineLevel()],a=[e,e,10,10,10,e];if(void 0==t)if(o)i.textFlow=UtilProxy.generateTextFlow("|C:10&已满级|"),n.textFlow=UtilProxy.generateTextFlow("|C:7&已满级|"),this.closeup1.label="已满级",this.red.visible=!1;else{var h=UtilProxy.getStr(s[this.CurShowType],[0]);i.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[h]),n.textFlow=UtilProxy.generateTextFlow("|C:7&无|")}else{if(o){var l=UtilProxy.getStr(s[this.CurShowType],[e]);i.textFlow=UtilProxy.StrFormart("|C:10&@0 |  |C:@1 &(@2 /@3 )|",[l,r[this.CurShowType]>=a[this.CurShowType]?7:4,r[this.CurShowType],a[this.CurShowType]]),this.closeup1.label="升阶",this.red.visible=r[this.CurShowType]>=a[this.CurShowType]}else{var p=UtilProxy.getStr(s[this.CurShowType],[e]);i.textFlow=UtilProxy.StrFormart("|C:10&@0 |  |C:7&(已激活)|",[p])}var h="",c=AttrProxy.getAttrInfo(t);if(void 0!=c)for(var u=0;u<c.length;u++)""==h?h=UtilProxy.getStr("@0  +@1 ",[c[u][2],c[u][1]]):h+=UtilProxy.getStr("\n@0  +@1 ",[c[u][2],c[u][1]]);n.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[h])}},e}(BaseEuiView);__reflect(MasterTipsView.prototype,"MasterTipsView"),ViewManager.ins().reg(MasterTipsView,LayerManager.UI_Main2),window.MasterTipsView=MasterTipsView;var PathBuyTips=function(t){function e(){var e=t.call(this)||this;return e.buynum=1,e.maxcount=999,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PathBuyTipsSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&购买道具|"),this.tips.textFlow=UtilProxy.generateTextFlow("|C:10&获得途径|"),this.btns=[this.i0,this.i1,this.i2,this.i3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn1,this.onCloseClick),this.addTouchEvent(this.add,this.onclick),this.addTouchEvent(this.cut,this.onclick),this.addTouchEvent(this.add_10,this.onclick),this.addTouchEvent(this.cut_10,this.onclick),this.addTouchEvent(this.btn2,this.onclick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onItemClick);this.itemid=t[0],this.buynum=1,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn1,this.onCloseClick),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.add,this.onclick),this.removeTouchEvent(this.cut,this.onclick),this.removeTouchEvent(this.add_10,this.onclick),this.removeTouchEvent(this.cut_10,this.onclick),this.removeTouchEvent(this.btn2,this.onclick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onItemClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onItemClick=function(t){var e=t.currentTarget,i=BagProxy.ins().getItemData(this.itemid),n=i.path[Number(e.name)],o=GlobalConfig.getPath_dataConfig(n);if(RoleProxy.ins().getRoleLv()<o.requiredlevel)return void TipsControl.ins().showTips("等级不足");var s=GlobalConfig.getTplViewConfig(o.view_id);s?ViewManager.ins().open(s.tsScript,o.page_id,o.other_page):TipsControl.ins().showTips("请关注游戏内活动")},e.prototype.onclick=function(t){switch(t.currentTarget){case this.add:this.buynum=Math.min(this.buynum+1,this.maxcount),this.SetCountLab();break;case this.add_10:this.buynum=Math.min(this.buynum+10,this.maxcount),this.SetCountLab();break;case this.cut:this.buynum=Math.max(this.buynum-1,1),this.SetCountLab();break;case this.cut_10:this.buynum=Math.max(this.buynum-10,1),this.SetCountLab();break;case this.btn2:var e=BagProxy.ins().getItemData(this.itemid),i=e.buyprice[1]*this.buynum;if(BagProxy.ins().getItemCountById(e.buyprice[0])<i)return void TipsControl.ins().showTips(BagProxy.ins().getItemName(e.buyprice[0])+"不足");StoreProxy.ins().C2SReqMiscAutoBuyItem(this.itemid,this.buynum),ViewManager.ins().close(this)}},e.prototype.ShowInfo=function(){var t=BagProxy.ins().getItemData(this.itemid);this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.quality-1],t.name]),this.countlab.text=UtilProxy.getStr("拥有：@0 ",[BagProxy.ins().getItemCountById(this.itemid)]);var e=BagProxy.ins().getItemData(t.buyprice[0]);this.icon.source=AssetMgr.getIconResource(e.displayid);var i=new ItemCellData;i.item_type_id=this.itemid,i.itemConfig=t,this.itemcell.data=i;for(var n=0;n<this.btns.length;n++)if(t.path[n]){this.btns[n].visible=!0,this.btns[n].includeInLayout=!0;var o=GlobalConfig.getPath_dataConfig(t.path[n]);this.btns[n].source=o.icon}else this.btns[n].visible=!1,this.btns[n].includeInLayout=!1;this.SetCountLab()},e.prototype.SetCountLab=function(){this.buycount.text=this.buynum.toString();var t=BagProxy.ins().getItemData(this.itemid),e=t.buyprice[1]*this.buynum;this.moneylab.text=e.toString()},e}(BaseEuiView);__reflect(PathBuyTips.prototype,"PathBuyTips"),ViewManager.ins().reg(PathBuyTips,LayerManager.UI_Main2),window.PathBuyTips=PathBuyTips;var PathTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PathTipsSkin",this.tips.textFlow=UtilProxy.generateTextFlow("|C:10&获取途径|"),this.btns=[this.i0,this.i1,this.i2,this.i3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onItemClick);this.itemid=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onItemClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onItemClick=function(t){var e=t.currentTarget,i=BagProxy.ins().getItemData(this.itemid),n=i.path[Number(e.name)],o=GlobalConfig.getPath_dataConfig(n);if(RoleProxy.ins().getRoleLv()<o.requiredlevel)return void TipsControl.ins().showTips("等级不足");var s=GlobalConfig.getTplViewConfig(o.view_id);
s?ViewManager.ins().open(s.tsScript,o.page_id,o.other_page):TipsControl.ins().showTips("请关注游戏内活动")},e.prototype.ShowInfo=function(){var t=BagProxy.ins().getItemData(this.itemid);this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[t.quality-1],t.name]);var e=new ItemCellData;e.item_type_id=this.itemid,e.itemConfig=t,this.itemcell.data=e;for(var i=0;i<this.btns.length;i++)if(t.path[i]){this.btns[i].visible=!0,this.btns[i].includeInLayout=!0;var n=GlobalConfig.getPath_dataConfig(t.path[i]);this.btns[i].source=n.icon}else this.btns[i].visible=!1,this.btns[i].includeInLayout=!1},e}(BaseEuiView);__reflect(PathTipsView.prototype,"PathTipsView"),ViewManager.ins().reg(PathTipsView,LayerManager.UI_Main2),window.PathTipsView=PathTipsView;var RankTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RankTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onCloseClick),this.addTouchEvent(this.closebtn,this.onCloseClick),this.info.textFlow=UtilProxy.generateTextFlow(t[0])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onCloseClick),this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(RankTipsView.prototype,"RankTipsView"),ViewManager.ins().reg(RankTipsView,LayerManager.UI_Main2),window.RankTipsView=RankTipsView;var RewardView=function(t){function e(){var e=t.call(this)||this;return e.isShow=!1,e.show_reward_list=[],e.skinName="RewardItemSkin",e.dropL.itemRenderer=ItemCell,e.dropS.viewport=e.dropL,e}return __extends(e,t),e.prototype.ShowReward=function(t){var e=this,i=600,n=600;if(this.isShow)return void this.show_reward_list.push(t);var o=t;t.length>3?this.show_reward_list.length>0?this.show_reward_list[0]=t.slice(3,t.length):this.show_reward_list.push(t.slice(3,t.length)):this.show_reward_list.splice(0,1),this.isShow=!0,this.tween.anchorOffsetX=i,this.dropL.dataProvider=new eui.ArrayCollection(o.slice(0,3)),this.dropL.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this);var s=[{anchorOffsetX:0},{anchorOffsetX:-i}];egret.Tween.get(this.tween).to(s[0],n,egret.Ease.backIn).wait(1e3).to(s[1],n,egret.Ease.backIn).call(function(){e.isShow=!1,e.show_reward_list.length>0?e.ShowReward(e.show_reward_list[0]):DisplayUtils.removeFromParent(e)},this)},e.prototype.onListItemTap=function(t){var e=t.item;void 0!=e&&e.itemConfig&&void 0!=e.itemConfig.type&&ViewManager.ins().open(ItemTipsView,e)},e}(BaseView);__reflect(RewardView.prototype,"RewardView"),window.RewardView=RewardView;var TipsControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.showTips=function(t){var e=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(e,e.showTips,t)},e.prototype.showGoodEquipTips=function(t){},e.prototype.showBoostPower=function(t,e){ViewManager.ins().open(BoostPowerView).showBoostPower(t,e)},e.prototype.showFuncNotice=function(t){},e.prototype.showlyhReward=function(t){var e=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(e,e.ShowReward,[t])},e.prototype.showAddFight=function(t,e){var i=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(i,i.showFightAdd,[t,e])},e.prototype.showReward=function(t){var e=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(e,e.ShowReward,t)},e.prototype.ShowTips1=function(t,e,i,n,o,s){void 0===n&&(n=!1),void 0===o&&(o="取消"),void 0===s&&(s="确定");var r=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(r,r.ShowTips1,[t,e,i,n,o,s])},e.prototype.ShowPathTips=function(t){0!=t&&(GlobalConfig.getItemsConfig(t).buyprice.length>0?ViewManager.ins().open(PathBuyTips,t):ViewManager.ins().open(PathTipsView,t))},e.prototype.ShowVipBuyTips=function(t,e,i,n){ViewManager.ins().open(VipBuyTipsView,t,e,i,n)},e.prototype.ShowAwardTips=function(t){ViewManager.ins().open(AwardTipsView,t)},e.prototype.ShowFlyMsg=function(t,e){void 0===e&&(e=1);var i=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(i,i.ShowFlyNotice,[t,e])},e.prototype.ShowDes=function(t){var e=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(e,e.ShowDes,[t])},e.prototype.ShowEff=function(t){var e=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(e,e.ShowEff,[t])},e.prototype.showExpTips=function(t,e){var i=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(i,i.showExpTips,[t,e])},e.prototype.ShowTips2=function(t){var e=ViewManager.ins().open(TipsView);DelayOptManager.ins().addDelayOptFunction(e,e.ShowTips2,[t])},e}(BaseSystem);__reflect(TipsControl.prototype,"TipsControl");var GameSystem;!function(t){t.tipscontrol=TipsControl.ins.bind(TipsControl)}(GameSystem||(GameSystem={})),window.TipsControl=TipsControl;var TipsTrunView=function(t){function e(){var e=t.call(this)||this;return e.curtype=0,e.curactid=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TipsTrunSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.info=t[0],this.title.text=t[1]||"概率说明",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.desc.textFlow=UtilProxy.generateTextFlow(this.info)},e}(BaseEuiView);__reflect(TipsTrunView.prototype,"TipsTrunView"),ViewManager.ins().reg(TipsTrunView,LayerManager.UI_Main2),window.TipsTrunView=TipsTrunView;var VipBuyTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="VipBuyTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.buybtn,this.onBuyClick),this.addTouchEvent(this.closebtn,this.onCloseClick),this.msg=t[0],this.curstr=t[1],this.nextstr=t[2],this.func=t[3],this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.buybtn,this.onBuyClick),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.msg="",this.curstr="",this.nextstr="",this.func=void 0},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBuyClick=function(t){this.func&&this.func()&&ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){this.tipsinfo.text=this.msg,this.curvip0.text=UtilProxy.getStr("当前VIP等级为@0 ",[RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)]),this.curvip1.text=this.curstr,this.nextvip0.text=UtilProxy.getStr("VIP@0 ",[""!=this.nextstr?RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)+1:"已满"]),this.nextvip1.text=this.nextstr,this.nextgroup.visible=""!=this.nextstr,this.curgroup.x=""!=this.nextstr?39:138},e}(BaseEuiView);__reflect(VipBuyTipsView.prototype,"VipBuyTipsView"),ViewManager.ins().reg(VipBuyTipsView,LayerManager.UI_Main2),window.VipBuyTipsView=VipBuyTipsView;var BoostPowerView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.verticalCenter=20*this.numChildren,this.horizontalCenter=0,this.img=new eui.Image,this.img.source="zjm_48",this.img.x=77,this.img.y=450,this.addChild(this.img),this.img.alpha=1,this.img.touchEnabled=!1,this.sp=new egret.Sprite,this.sp.x=220,this.sp.y=474,this.addChild(this.sp),this.lastTime=0,this.lastPower=0,this.clearShow()},e.prototype.showBoostPower=function(t,e){0==this.lastPower&&(this.lastPower=e),TimerManager.ins().doTimer(500,1,this.delayPowerUp,this)},e.prototype.clearShow=function(){this.sp.removeChildren(),egret.Tween.removeTweens(this.img),this.img.visible=!1,TimerManager.ins().removeAll(this),egret.clearTimeout(this.ii),this.ii=0},e.prototype.delayPowerUp=function(){var t=this.lastPower,e=Actor.power;this.lastPower=0,e>t&&this.showPowerUp(t,e)},e.prototype.showPowerUp=function(t,e){var i=this;this.clearShow(),this.img.visible=!0,this.img.alpha=1;var n=new BmpNumber;this.sp.addChild(n);var o=e-t;TimerManager.ins().doTimer(20,25,function(){var e=o;e+=Math.round(Math.random()*e);var i=t.toString(),n="";n=e.toString().length==i.length?e.toString().slice(1):e+"",i=i.charAt(0),i+=n},this,function(){n.setNumber(Actor.power,NumberType.CommonBig);var t=new BmpNumber;t.x=n.width-t.width,t.y-=n.height,i.sp.addChild(t);var e=1e3,o=500,s=egret.Tween.get(t);s.to({y:t.y-45},e).to({alpha:0},o).call(function(){DisplayUtils.removeFromParent(t)},i);var r=egret.Tween.get(n);r.wait(e).to({alpha:0},o).call(function(){DisplayUtils.removeFromParent(n)},i);var a=egret.Tween.get(i.img);a.wait(e).to({alpha:0},o).call(function(){i.img.visible=!1},i)},this)},e}(BaseEuiView);__reflect(BoostPowerView.prototype,"BoostPowerView"),ViewManager.ins().reg(BoostPowerView,LayerManager.UI_Tips),window.BoostPowerView=BoostPowerView;var ExpAdd=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExpAddSkin",e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.setExp=function(t,e){var i=this,n=t.toString(),o=e.toString();this.expValue.text=n,e>0?(this.addG.visible=!0,this.addG.x=this.expValue.x+17*n.length,this.addValue.text=o,this.lastG.x=this.addValue.x+17*o.length):this.addG.visible=!1,this.rootG.y=0,this.rootG.alpha=1;var s=egret.Tween.get(this.rootG);s.to({y:-30},500).wait(300).to({alpha:0},200).call(function(){DisplayUtils.removeFromParent(i)},this)},e}(BaseView);__reflect(ExpAdd.prototype,"ExpAdd"),window.ExpAdd=ExpAdd;var FightAddView=function(t){function e(){var e=t.call(this)||this;return e.add_init_y=-11,e.skinName="FightAddSkin",e.touchEnabled=!1,e.touchChildren=!1,e.add_init_y=e.addValue.y,e}return __extends(e,t),e.prototype.showEffect=function(t,e){var i=this,n=t.toString(),o=e.toString(),s=n.length,r=o.length;this.numValue.text=n,this.addValue.text="+"+o,this.addValue.x=this.numValue.x+15*s-19*r/2,this.addValue.y=this.add_init_y,this.addValue.visible=!1,void 0!=this.effect&&(this.effG.removeChild(this.effect),this.effect=void 0),this.effect=new egret.MovieClip,UtilProxy.GetMovieClip(UI_EFF_DIR+"10001",this.effect,1,function(t){void 0!=i.effect&&(i.effG.removeChild(i.effect),i.effect=void 0),i.addValue.visible=!0,egret.Tween.get(i.addValue,{loop:!1}).to({y:i.add_init_y-20},500).wait(1e3).call(function(){i.numValue.text="",i.addValue.text="",DisplayUtils.removeFromParent(i)},i)}),this.effG.addChild(this.effect)},e}(BaseView);__reflect(FightAddView.prototype,"FightAddView"),window.FightAddView=FightAddView;var FlyMsg=function(t){function e(){var e=t.call(this)||this;return e.skinName="FlyMsgSkin",e.touchEnabled=!1,e.touchChildren=!1,e.list=[],e}return __extends(e,t),e.prototype.showNotice=function(t,e){var i=this;this.visible=!0,void 0!=e&&(e>1?TimerManager.ins().doTimer(8e3,e-1,function(){i.list.push(t),1==i.list.length&&i.tweenLab()},this):0==e&&TimerManager.ins().doTimer(8e3,0,function(){i.list.push(t),1==i.list.length&&i.tweenLab()},this)),this.list.push(t),1==this.list.length&&this.tweenLab()},e.prototype.tweenLab=function(){var t=this,e=this.list[0],i=this.flyMsg;i.x=this.scrollerFly.width,i.textFlow=TextFlowMaker.generateTextFlow(e);var n=0-i.width,o=egret.Tween.get(i);o.to({x:n},6e3).call(function(){t.list.shift(),t.list.length<1?t.visible=!1:t.tweenLab()},this)},e}(BaseView);__reflect(FlyMsg.prototype,"FlyMsg"),window.FlyMsg=FlyMsg;var FuncNoticeWin=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseEuiView);__reflect(FuncNoticeWin.prototype,"FuncNoticeWin"),ViewManager.ins().reg(FuncNoticeWin,LayerManager.UI_Tips),window.FuncNoticeWin=FuncNoticeWin;var ShowActOpenView=function(t){function e(){var e=t.call(this)||this;return e._time=60,e.time=0,e.skinName="ActOpenTipsSkin",e}return __extends(e,t),e.prototype.initUI=function(){this.actTips.horizontalCenter=140,this.actTips.bottom=147},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCurrentEvent(),this.Show()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEvent()},e.prototype.addCurrentEvent=function(){this.addTouchEvent(this.closeActBtn,this.onddClick),this.addTouchEvent(this.goActBtn,this.onddClick),EventProxy.AddListener(this,EventType.S2CRepSystemopenGetInfo,this.S2CRepSystemopenGetInfo),EventProxy.AddListener(this,EventType.ActivityStateChange,this.ActivityStateChange),EventProxy.AddListener(this,EventType.S2CRepActivityInfos,this.S2CRepActivityInfos),EventProxy.AddListener(this,EventType.S2CRepActivityStart,this.S2CRepActivityStart)},e.prototype.removeEvent=function(){TimerManager.ins().removeAll(this),this.removeTouchEvent(this.closeActBtn,this.onddClick),this.removeTouchEvent(this.goActBtn,this.onddClick),EventProxy.RemoveListener(this,EventType.S2CRepSystemopenGetInfo,this.S2CRepSystemopenGetInfo),EventProxy.RemoveListener(this,EventType.ActivityStateChange,this.ActivityStateChange),EventProxy.RemoveListener(this,EventType.S2CRepActivityInfos,this.S2CRepActivityInfos),EventProxy.RemoveListener(this,EventType.S2CRepActivityStart,this.S2CRepActivityStart)},e.prototype.onddClick=function(t){switch(t.currentTarget){case this.goActBtn:ViewManager.ins().open(BossUIView,"跨服BOSS"==this.act_title.text?5:7);break;case this.closeActBtn:}this.depose()},e.prototype.depose=function(){ViewManager.ins().close(this)},e.prototype.Show=function(){this.time=this._time,this.showActTips()},e.prototype.showActTips=function(){var t=ActivityProxy.ins().getActivityDataById(ActivityType.KuaFuBoss),e=BossProxy.ins().getCurrentKuaFuBoss();if((void 0==t||null==t||0==t.act_status)&&(t=ActivityProxy.ins().getActivityDataById(ActivityType.ShenwenBoss),e=BossProxy.ins().getCurrentShenwenBoss()),t&&e&&SystemOpenProxy.ins().isOpen(2,804,!0))if(1==t.act_status){var i=BossProxy.ins().GetBossNextFreeTime(e.id,e.type);if(0>=i){this.time=this._time,TimerManager.ins().doTimer(1e3,0,this.TimeUp,this),this.actTips.visible=!0,this.act_title.text=t.act_id==ActivityType.KuaFuBoss?"跨服BOSS":"神纹BOSS";var n=GlobalConfig.getMonsterConfigById(e.id);this.act_icon.source=n.head_res,this.setTime(this.time)}else this.depose()}else this.depose();else this.depose()},e.prototype.TimeUp=function(){this.time=this.time-1,this.setTime(this.time),this.time<0&&this.depose()},e.prototype.setTime=function(t){this.timeLabel.text="("+Math.max(t,0)+")"},e.prototype.S2CRepSystemopenGetInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.showActTips()},e.prototype.ActivityStateChange=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(t[0]==ActivityType.KuaFuBoss||t[0]==ActivityType.ShenwenBoss)&&this.showActTips()},e.prototype.S2CRepActivityInfos=function(){this.showActTips()},e.prototype.S2CRepActivityStart=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(t[0]==ActivityType.KuaFuBoss||t[0]==ActivityType.ShenwenBoss)&&this.showActTips()},e}(BaseEuiView);__reflect(ShowActOpenView.prototype,"ShowActOpenView"),ViewManager.ins().reg(ShowActOpenView,LayerManager.UI_Main),window.ShowActOpenView=ShowActOpenView;var TipsDes=function(t){function e(){var e=t.call(this)||this;return e.skinName="TipsDesSkin",e.addTouchEvent(e.closebtn,e.onddClick),e.addTouchEvent(e.black,e.onblackClick),e}return __extends(e,t),e.prototype.onddClick=function(t){DisplayUtils.removeFromParent(this)},e.prototype.onblackClick=function(t){TipsControl.ins().showTips("blackblackblackblackblackblackblackblackblackblackblackblack")},e.prototype.Show=function(t,e){void 0===e&&(e=""),this.info.textFlow=UtilProxy.generateTextFlow(t),void 0!=e&&""!=e?this.titleName.text=e:this.titleName.text="玩法说明"},e}(BaseView);__reflect(TipsDes.prototype,"TipsDes"),window.TipsDes=TipsDes;var TipsItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TipsSkin",e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"labelText",{get:function(){return this._labelText},set:function(t){var e=this;this._labelText=t,this.lab.textFlow=TextFlowMaker.generateTextFlow(this._labelText),this.bg.width=this.lab.width+80,this.bg.alpha=1,this.lab.alpha=1,this.bg.y=0,this.lab.verticalCenter=-1;var i=egret.Tween.get(this.bg);i.to({y:-30},500).wait(500).to({alpha:0},200).call(function(){DisplayUtils.removeFromParent(e)},this);var n=egret.Tween.get(this.lab);n.to({verticalCenter:-30},500).wait(500).to({alpha:0},200)},enumerable:!0,configurable:!0}),e}(BaseView);__reflect(TipsItem.prototype,"TipsItem"),window.TipsItem=TipsItem;var TipsShow1=function(t){function e(){var e=t.call(this)||this;return e.func1=void 0,e.func2=void 0,e.time=10,e.skinName="TipsShow1Skin",e}return __extends(e,t),e.prototype.addCurrentEvent=function(){this.addTouchEvent(this.btn1,this.onddClick),this.addTouchEvent(this.btn2,this.onddClick),this.addTouchEvent(this.closebtn,this.onddClick),this.addTouchEvent(this.black,this.onblackClick)},e.prototype.removeEvent=function(){this.removeTouchEvent(this.btn1,this.onddClick),this.removeTouchEvent(this.btn2,this.onddClick),this.removeTouchEvent(this.closebtn,this.onddClick),this.removeTouchEvent(this.black,this.onblackClick)},e.prototype.onddClick=function(t){switch(t.currentTarget){case this.btn1:void 0!=this.func1&&this.func1();break;case this.btn2:void 0!=this.func2&&this.func2();break;case this.closebtn:}TimerManager.ins().removeAll(this),this.removeEvent(),DisplayUtils.removeFromParent(this)},e.prototype.onblackClick=function(t){TipsControl.ins().showTips("blackblackblackblackblackblackblackblackblackblackblackblack")},e.prototype.Show=function(t,e,i,n,o,s){if(this.info.textFlow=UtilProxy.generateTextFlow(t),this.func1=e,this.func2=i,this.addCurrentEvent(),n){this.time=10,this.btn1.label="拒绝",this.btn2.label="同意("+this.time+")";var r=function(){this.time=this.time-1,this.btn2.label="同意("+Math.max(this.time,0)+")"},a=function(){void 0!=this.func2&&this.func2(),TimerManager.ins().removeAll(this),this.removeEvent(),DisplayUtils.removeFromParent(this)};TimerManager.ins().doTimer(1e3,10,r,this,a,this)}else this.btn1.label=o,this.btn2.label=s;this.CheckGuide()},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseView);__reflect(TipsShow1.prototype,"TipsShow1"),window.TipsShow1=TipsShow1;var TipsShow2=function(t){function e(){var e=t.call(this)||this;return e.skinName="TipsShow2Skin",e}return __extends(e,t),e.prototype.addCurrentEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.onAddClick=function(t){TimerManager.ins().removeAll(this),this.removeEvent(),DisplayUtils.removeFromParent(this)},e.prototype.Show=function(t){var e=this;0!=t&&(this.time_num.source="suoyaota_meishuzi_"+t),TimerManager.ins().removeAll(this),TimerManager.ins().doTimer(1100,1,function(){DisplayUtils.removeFromParent(e)},this)},e}(BaseView);__reflect(TipsShow2.prototype,"TipsShow2"),window.TipsShow2=TipsShow2;var TipsView=function(t){function e(){var e=t.call(this)||this;return e.labCount=0,e.list=[],e.reward_list=[],e.tips1_list=[],e.lyh_list=[],e.explist=[],e.reward_item_list=new Array,e.des_list=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.touchEnabled=!1},e.prototype.showTips=function(t){var e=ObjectPool.pop("TipsItem");e.verticalCenter=0,e.horizontalCenter=0,e.labelText=t,this.addChild(e),this.list.unshift(e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTip,this);for(var i=this.list.length-1;i>=0;i--){egret.Tween.removeTweens(this.list[i]);var n=egret.Tween.get(this.list[i]);n.to({verticalCenter:-30*i},500)}},e.prototype.removeTip=function(t){var e=this.list.indexOf(t.currentTarget);this.list.splice(e,1),egret.Tween.removeTweens(t.currentTarget),t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTip,this),ObjectPool.push(t.currentTarget)},e.prototype.showFightAdd=function(t){var e=t[0],i=t[1];this.fightAddItem&&DisplayUtils.removeFromParent(this.fightAddItem),this.fightAddItem=ObjectPool.pop("FightAddView"),this.fightAddItem.horizontalCenter=60,this.fightAddItem.bottom=200,this.fightAddItem.showEffect(e,i),this.addChild(this.fightAddItem),this.fightAddItem.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFightAdd,this)},e.prototype.removeFightAdd=function(t){t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFightAdd,this),TimerManager.ins().removeAll(t.currentTarget),egret.Tween.removeTweens(t.currentTarget),this.fightAddItem=null},e.prototype.ShowReward=function(t){this.reward_tip||(this.reward_tip=ObjectPool.pop("RewardView"),this.reward_tip.horizontalCenter=0,this.reward_tip.bottom=180),this.addChild(this.reward_tip),this.reward_tip.ShowReward(t),this.reward_tip.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeReward,this)},e.prototype.removeReward=function(t){this.reward_tip=void 0,egret.Tween.removeTweens(t.currentTarget),t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeReward,this),ObjectPool.push(t.currentTarget)},e.prototype.ShowTips1=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0][0],n=t[0][1],o=t[0][2],s=t[0][3],r=t[0][4],a=t[0][5];if(!(this.tips1_list.length>0)){var h=ObjectPool.pop("TipsShow1");this.addChild(h),h.horizontalCenter=0,h.Show(i,n,o,s,r,a),this.tips1_list.unshift(h),h.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.RemoveTips1,this)}},e.prototype.RemoveTips1=function(t){var e=this.tips1_list.indexOf(t.currentTarget);this.tips1_list.splice(e,1),t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.RemoveTips1,this),ObjectPool.push(t.currentTarget)},e.prototype.ShowFlyNotice=function(t){var e=t[0],i=t[1];null==this.flyMsg&&(this.flyMsg=new FlyMsg,this.flyMsg.horizontalCenter=0,this.flyMsg.y=200,this.addChild(this.flyMsg)),this.flyMsg.showNotice(e,i)},e.prototype.ShowDes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0][0];if(!(this.des_list.length>0)){var n=ObjectPool.pop("TipsDes");this.addChild(n),n.horizontalCenter=0,n.Show(i),this.des_list.unshift(n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.RemoveDes,this)}},e.prototype.RemoveDes=function(t){var e=this.des_list.indexOf(t.currentTarget);this.des_list.splice(e,1),t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.RemoveDes,this),ObjectPool.push(t.currentTarget)},e.prototype.ShowEff=function(t){var e=t[0];this.effG||(this.effG=new eui.Group,this.effG.horizontalCenter=0,this.effG.verticalCenter=0,this.effG.width=200,this.effG.height=200),UtilProxy.GetMovieClipById(e,this.effG)},e.prototype.showExpTips=function(t){var e=ObjectPool.pop("ExpAdd");e.bottom=120,e.horizontalCenter=0,e.setExp(t[0],t[1]),this.addChild(e),this.explist.unshift(e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeExpTip,this);for(var i=this.explist.length-1;i>=0;i--){egret.Tween.removeTweens(this.explist[i]);var n=egret.Tween.get(this.explist[i]);n.to({bottom:120- -30*i},500)}},e.prototype.removeExpTip=function(t){var e=this.explist.indexOf(t.currentTarget);this.explist.splice(e,1),egret.Tween.removeTweens(t.currentTarget),t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeExpTip,this),ObjectPool.push(t.currentTarget)},e.prototype.ShowTips2=function(t){var e=t[0];this.tips2||(this.tips2=ObjectPool.pop("TipsShow2"),this.tips2.horizontalCenter=0,this.addChild(this.tips2)),this.tips2.Show(e),this.tips2.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.RemoveTips2,this)},e.prototype.RemoveTips2=function(t){this.tips2=void 0,t.currentTarget.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.RemoveTips2,this),ObjectPool.push(t.currentTarget)},e}(BaseEuiView);__reflect(TipsView.prototype,"TipsView"),ViewManager.ins().reg(TipsView,LayerManager.UI_Tips),window.TipsView=TipsView;var ReputationUIView=function(t){function e(){var e=t.call(this)||this;return e.current_index=-1,e.current_level=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShengwangViewSkin",this.comview.initUI(),this.listS.itemRenderer=ItemCell,this.cur_attr_name=[this.cur_attr_name0,this.cur_attr_name1,this.cur_attr_name2,this.cur_attr_name3],this.cur_attr=[this.cur_attr0,this.cur_attr1,this.cur_attr2,this.cur_attr3],this.next_attr_name=[this.next_attr_name0,this.next_attr_name1,this.next_attr_name2,this.next_attr_name3],this.next_attr=[this.next_attr0,this.next_attr1,this.next_attr2,this.next_attr3],this.linkValue.textFlow=UtilProxy.generateTextFlow("U&获取声望值")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.comview.SetName(UtilProxy.getTitleName("声望")),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.updateBtn,this.onUpdateClick),this.addTouchEvent(this.linkValue,this.onLinkClick),EventProxy.AddListener(this,EventType.S2CRepTitleUpgradeReputation,this.S2CRepTitleUpgradeReputation),EventProxy.AddListener(this,EventType.UpdataMoney,this.onMoneyUpdate),this.InitData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.updateBtn,this.onUpdateClick),this.removeTouchEvent(this.linkValue,this.onLinkClick),EventProxy.RemoveListener(this,EventType.S2CRepTitleUpgradeReputation,this.S2CRepTitleUpgradeReputation),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.onMoneyUpdate)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onLinkClick=function(t){TipsControl.ins().ShowPathTips(MoneyAttr.SHENGWANG)},e.prototype.S2CRepTitleUpgradeReputation=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UtilProxy.GetMovieClipById(19,this.effect),this.InitData()},e.prototype.onMoneyUpdate=function(t){void 0!=t&&t==MoneyAttr.SHENGWANG&&this.process()},e.prototype.onUpdateClick=function(t){var e=TitleProxy.ins().GetCurrentLevel()+1,i=GlobalConfig.getReputation_dataConfig(e),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);void 0!=i?n>=i.need_value?TitleProxy.ins().C2SReqTitleUpgradeReputation(e):TipsControl.ins().ShowPathTips(MoneyAttr.SHENGWANG):TipsControl.ins().showTips("已是满阶！")},e.prototype.InitData=function(){var t=TitleProxy.ins().GetCurrentLevel();this.SetData(t),this.current_level=t,this.process()},e.prototype.process=function(){var t=GlobalConfig.getReputation_dataConfig(TitleProxy.ins().GetCurrentLevel()+1);void 0==t&&(t=GlobalConfig.getReputation_dataConfig(TitleProxy.ins().GetCurrentLevel()));var e=t.need_value,i=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);this.valueBar.maximum=e,this.valueBar.value=i},e.prototype.SetData=function(t){var e,i=GlobalConfig.getReputation_dataConfig(t),n=GlobalConfig.getReputation_dataConfig(t+1);if(n&&(e=AttrProxy.getAttrInfo(n)),0==t){this.curName.text="无",this.curLvl.text="0阶",this.nextName.text=n.name[FacProxy.ins().getFacId()],this.nextLvl.text=TitleProxy.ins().getShengWanglvlName(n.id,FacProxy.ins().getFacId());for(var o=0;o<e.length&&this.cur_attr_name[o];++o)this.cur_attr_name[o].text=e[o][0],this.cur_attr[o].text="0",this.next_attr_name[o].text=e[o][0],this.next_attr[o].text=e[o][1];this.attrSG.visible=!1}else{this.curName.text=i.name[FacProxy.ins().getFacId()-1],this.curLvl.text=TitleProxy.ins().getShengWanglvlName(i.id,FacProxy.ins().getFacId()),this.nextName.text=n?n.name[FacProxy.ins().getFacId()-1]:"满级",this.nextLvl.text=n?TitleProxy.ins().getShengWanglvlName(n.id,FacProxy.ins().getFacId()):"满级";for(var s=AttrProxy.getAttrInfo(i),o=0;o<s.length&&this.cur_attr_name[o];++o)if(this.cur_attr_name[o].text=s[o][0],this.cur_attr[o].text=s[o][1],e){this.next_attr_name[o].text=e[o][0];var r=e[o][1].indexOf("%"),a=s[o][1].indexOf("%"),h=0;h=r>-1?e[o][1].slice(0,r)-s[o][1].slice(0,a):e[o][1]-s[o][1],this.next_attr[o].textFlow=UtilProxy.generateTextFlow(e[o][1]+"|C:7&(+"+h+")")}else this.next_attr_name[o].text=s[o][0],this.next_attr[o].text="满级";i.ft_wushi_define_pre>0?(this.attrSG.visible=!0,this.sValue.text=(i.ft_wushi_define_pre/100).toString()):this.attrSG.visible=!1}GlobalConfig.getReputation_dataConfig(TitleProxy.ins().GetCurrentLevel());this.fightValue.text=UtilProxy.GetAttrFight(i).toString();for(var l=new Array,p=0==t?n.items:i.items,o=0;o<p.length;++o){var c=new ItemCellData,u=p[o][0],d=p[o][1],g={item_slot_idx:0,item_type_id:u,item_count:d};c.setItemCellData(g),l.push(c)}this.listS.dataProvider=new eui.ArrayCollection(l)},e}(BaseEuiView);__reflect(ReputationUIView.prototype,"ReputationUIView"),ViewManager.ins().reg(ReputationUIView,LayerManager.UI_Main),window.ReputationUIView=ReputationUIView;var TitleActiveView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="TitleActiveViewSkin",this.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closeBtn,this.OnCloseClick),this.addTouchEvent(this.activeBtn,this.OnEnterClick);var i=t[0]||0;this.title_config=GlobalConfig.getTitleById(i),this.title_config&&(this.icon.source=TitleProxy.title_icon_path+this.title_config.title_res+".png")},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeBtn,this.OnCloseClick),this.removeTouchEvent(this.activeBtn,this.OnEnterClick)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.OnEnterClick=function(t){ViewManager.ins().isShow(TitleUIView)||ViewManager.ins().open(TitleUIView,this.title_config?this.title_config.title_type-1:void 0)},e}(BaseEuiView);__reflect(TitleActiveView.prototype,"TitleActiveView"),ViewManager.ins().reg(TitleActiveView,LayerManager.UI_Main2),window.TitleActiveView=TitleActiveView;var TitleItem=function(t){function e(){var e=t.call(this)||this;return e.isUseState=!1,e.skinName="TitleItemSkin",e.addTouchEvent(e.btn,e.onClick),e}return __extends(e,t),e.prototype.onClick=function(t){var e=this.data;void 0!=e&&(0==e.active?TipsControl.ins().showTips("尚未激活!"):TitleProxy.ins().isUseTitle(e.id)?TitleProxy.ins().C2SReqTitleUse(0):TitleProxy.ins().C2SReqTitleUse(e.id))},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(void 0!=e){var i=GlobalConfig.getTitleById(e.id);e.isForever?this.info.text="时间： 永久":e.active?this.info.text="时间： 时效":this.info.text="限时："+UtilProxy.getTimeHSString_2(i.time),this.icon.source=TitleProxy.title_icon_path+e.res+".png",this.refreshData()}},e.prototype.refreshData=function(){var t=this.data;if(void 0!=t){var e,i=1;if(1==t.active&&void 0!=t.titleInfo){var n=UtilProxy.isTimeSpan(t.titleInfo.time);n||(e=t.titleList[t.titleInfo.time],i=t.titleInfo.time+1)}this.btn.label=TitleProxy.ins().isUseTitle(t.id)?"卸下":"穿戴",void 0==e&&(e=t.titleList[1]);AttrProxy.getAttrInfo(e);0==t.active?(this.stateBg.source="common_biaoqian_2",TitleProxy.ins().isEnoughItem(t.id,i)&&t.isUp?this.state.text="可激活":this.state.text="未激活",this.btn.visible=!1):TitleProxy.ins().isUseTitle(t.id)?(this.stateBg.source="huoban_icon_shiyongzhong_2",this.state.text="使用中"):(this.stateBg.source="huoban_icon_shiyongzhong_2",this.state.text="已激活"),this.btn.visible=t.active>0,this.red.visible=t.isUp&&TitleProxy.ins().isEnoughTitleById(t.id),this.isUseState=TitleProxy.ins().isUseTitle(t.id)}},e.prototype.clear=function(){},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this)
},e}(BaseItemRender);__reflect(TitleItem.prototype,"TitleItem"),window.TitleItem=TitleItem;var TitleUIView=function(t){function e(){var e=t.call(this)||this;return e.titleItemList=[],e.current_type=-1,e.font_name=["chenghao_paihang","chenghao_chengjiu","chenghao_teshu","chenghao_zongpai"],e.showAttBtnList=[],e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="TitleViewSkin",this.comview.initUI(),this.comview.SetName(UtilProxy.getTitleName("称号")),this.scroller.viewport=this.groupInfo,this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3],this.cl=[this.cl0,this.cl1,this.cl2,this.cl3,this.cl4,this.cl5],this.nl=[this.nl0,this.nl1,this.nl2,this.nl3,this.nl4,this.nl5],this.tList=[this.t0,this.t1,this.t2,this.t3,this.t4],this.hidePos.addChild(this.attrG);for(var t=0;t<this.sbtnList.length;++t)this.sbtnList[t].setFontImg(this.font_name[t])},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open();for(var i=0;i<this.sbtnList.length;++i)this.addTouchEvent(this.sbtnList[i],this.OnClick);this.addTouchEvent(this.closebtn,this.OnCloseClick),this.addTouchEvent(this.activeBtn,this.onUpdateClick),EventProxy.AddListener(this,EventType.S2CRepTitleActive,this.S2CRepTitleActive),EventProxy.AddListener(this,EventType.S2CRepTitleUpgrade,this.S2CRepTitleUpgrade),EventProxy.AddListener(this,EventType.S2CRepTitleUse,this.S2CRepTitleUse),this.hidePos.addChild(this.attrG),this.attrG.x=0,this.attrG.y=0,this.setRed();var n=t[0]||0;this.setDataByType(n+1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close();for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.OnClick);this.removeTouchEvent(this.closebtn,this.OnCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepTitleActive,this.S2CRepTitleActive),EventProxy.RemoveListener(this,EventType.S2CRepTitleUpgrade,this.S2CRepTitleUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepTitleUse,this.S2CRepTitleUse)},e.prototype.OnCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onUpdateClick=function(t){var e=this.cur_data;if(void 0!=e){var i=TitleProxy.ins().getNextData(e);if(void 0!=i&&i.items.length>0)if(BagProxy.ins().getItemCountById(i.items[0][0])>=i.items[0][1])1==e.active?TitleProxy.ins().C2SReqTitleUpgrade(e.id):TitleProxy.ins().C2SReqTitleActive(e.id);else{var n=GlobalConfig.getItemsConfig(i.items[0][0]);void 0!=n&&TipsControl.ins().showTips(n.name+"不足")}}},e.prototype.S2CRepTitleActive=function(t){this.setFightTotal(this.current_type);for(var e=0;e<this.titleItemList.length;++e){var i=this.titleItemList[e],n=i.data;void 0!=n&&n.id==t&&(i.data=TitleProxy.ins().getTitleDataById(i.data.id))}this.cur_data&&this.cur_data.id==t&&this.setData(TitleProxy.ins().getTitleDataById(t)),this.setRed()},e.prototype.S2CRepTitleUpgrade=function(t){this.setFightTotal(this.current_type);for(var e=0;e<this.titleItemList.length;++e){var i=this.titleItemList[e],n=i.data;void 0!=n&&n.id==t&&(i.data=TitleProxy.ins().getTitleDataById(i.data.id))}this.cur_data&&this.cur_data.id==t&&this.setData(TitleProxy.ins().getTitleDataById(t)),this.setRed()},e.prototype.S2CRepTitleUse=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.titleItemList.length;++i){var n=this.titleItemList[i],o=n.data;o&&(o.id==t[0]&&(n.data=TitleProxy.ins().getTitleDataById(n.data.id)),n.isUseState&&(n.data=TitleProxy.ins().getTitleDataById(n.data.id)))}},e.prototype.OnClick=function(t){var e=this.sbtnList.indexOf(t.currentTarget);this.setDataByType(e+1)},e.prototype.OnEnterClick=function(t){},e.prototype.OnUseClick=function(t){},e.prototype.setDataByType=function(t){var e=TitleProxy.ins().getTitleDataByType(t);if(void 0!=e){this.current_type=t,this.setFightTotal(t),this.showAttBtnList=[],e.sort(TitleProxy.ins().sortTitle);for(var i=0;i<e.length;++i){if(this.titleItemList.length<i+1){var n=new TitleItem;n.showBtn.setUpState(!1),this.groupInfo.addChild(n),this.addTouchEvent(n.bgClick,this.ShowAttrClick),this.titleItemList.push(n)}this.titleItemList[i].data=e[i]}for(var i=this.titleItemList.length-1;i>=0;--i)this.titleItemList[i].showBtn.setUpState(!1),this.showAttBtnList.push(this.titleItemList[i].showBtn),i>=e.length&&(this.groupInfo.removeChild(this.titleItemList[i]),this.titleItemList.splice(i,1));for(var i=0;i<this.sbtnList.length;++i)t-1==i?this.sbtnList[i].setSelect(!0):this.sbtnList[i].setSelect(!1);this.hidePos.addChild(this.attrG),this.attrG.x=0,this.attrG.y=0,this.groupInfo.validateNow(),this.groupInfo.scrollV=0}},e.prototype.ShowAttrClick=function(t){var e=(t.currentTarget,t.currentTarget.parent),i=this.titleItemList.indexOf(e),n=e.showBtn;if(this.lastShowBtn&&this.lastShowBtn==n){var o=!n.isUpState;n.setUpState(o),o?(this.groupInfo.addChildAt(this.attrG,i+1),this.setData(e.data)):(this.hidePos.addChild(this.attrG),this.attrG.x=0,this.attrG.y=0)}else this.lastShowBtn&&this.lastShowBtn.setUpState(!1),n.setUpState(!0),this.groupInfo.addChildAt(this.attrG,i+1),this.setData(e.data),this.lastShowBtn=n},e.prototype.setData=function(t){if(void 0!=t){this.cur_data=t;var e,i,n=TitleProxy.ins().getCurData(t),o=TitleProxy.ins().getNextData(t),s=TitleProxy.ins().getcurLevel(t);n&&(e=AttrProxy.getAttrInfo(n),i=e);var r;o&&(r=AttrProxy.getAttrInfo(o),i=r);var a=t.isItemOpen&&(0==t.active||1==t.active&&t.isUp);if(this.g0.visible=a,this.g1.visible=!a,a){this.activeBtn.label=1==t.active?"升级":"激活",this.cl[0].text=0==s?"当前属性":"当前"+s+"阶属性",this.nl[0].text=o?"下阶"+(s+1)+"阶属性":"";for(var h=2;h<this.cl.length;++h)e&&e[h-2]||r&&r[h-2]?this.cl[h].textFlow=UtilProxy.generateTextFlow((e?e[h-2][0]:r[h-2][0])+"|C:7&"+UtilProxy.getSimpleNum(e?e[h-2][1]:0)):this.cl[h].text="";for(var h=2;h<this.nl.length;++h)e&&e[h-2]||r&&r[h-2]?this.nl[h].textFlow=UtilProxy.generateTextFlow((r?r[h-2][0]:e[h-2][0])+"|C:7&"+(r?UtilProxy.getSimpleNum(r[h-2][1]):"已满级")):this.nl[h].text="";this.cl[1].textFlow=UtilProxy.generateTextFlow("战力："+(n?UtilProxy.getSimpleNum(UtilProxy.GetAttrFight(n)):0)),this.nl[1].textFlow=UtilProxy.generateTextFlow("战力："+(o?UtilProxy.getSimpleNum(UtilProxy.GetAttrFight(o)):"已满级"))}else{for(var h=1;h<this.tList.length;++h)i&&i[h-1]?this.tList[h].textFlow=UtilProxy.generateTextFlow(i[h-1][0]+"|C:7&"+UtilProxy.getSimpleNum(i[h-1][1])):this.tList[h].text="";this.tp.text=t.path,this.tList[0].textFlow=UtilProxy.generateTextFlow("战力："+UtilProxy.getSimpleNum(n?UtilProxy.GetAttrFight(n):UtilProxy.GetAttrFight(o)))}if(void 0!=o){if(o.items.length>0){var l=GlobalConfig.getItemsConfig(o.items[0][0]);void 0!=l&&(this.payValue.text=o.items[0][1],this.payIcon.source=AssetMgr.getIconResource(l.displayid))}}else if(n&&n.items.length>0){var l=GlobalConfig.getItemsConfig(n.items[0][0]);void 0!=l&&(this.payValue.text="0",this.payIcon.source=AssetMgr.getIconResource(l.displayid))}}},e.prototype.setFightTotal=function(t){var e=TitleProxy.ins().getTitleDataByType(t);if(void 0!=e){for(var i=0,n=0;n<e.length;++n)if(e[n].active&&void 0!=e[n].titleInfo){var o=UtilProxy.isTimeSpan(e[n].titleInfo.time);i+=o?UtilProxy.GetAttrFight(e[n].titleList[1]):UtilProxy.GetAttrFight(e[n].titleList[e[n].titleInfo.time])}this.fightValue.text=i.toString()}},e.prototype.setRed=function(){for(var t=0;t<this.sbtnList.length;++t)this.sbtnList[t].setRed(TitleProxy.ins().getTitleNumByType(t+1)>0),this.sbtnList[t].setTotalNum(TitleProxy.ins().getTitleActiveByType(t+1),TitleProxy.ins().getTitleCountByType(t+1))},e}(BaseEuiView);__reflect(TitleUIView.prototype,"TitleUIView"),ViewManager.ins().reg(TitleUIView,LayerManager.UI_Main),window.TitleUIView=TitleUIView;var TitleView_reputation=function(t){function e(){var e=t.call(this)||this;return e.current_level=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listS.itemRenderer=ItemCell},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.leftBtn,this.onArrowClick),this.addTouchEvent(this.rightBtn,this.onArrowClick),this.addTouchEvent(this.updateBtn,this.onUpdateClick),EventProxy.AddListener(this,EventType.S2CRepTitleUpgradeReputation,this.S2CRepTitleUpgradeReputation),EventProxy.AddListener(this,EventType.UpdataMoney,this.onMoneyUpdate),this.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.leftBtn,this.onArrowClick),this.removeTouchEvent(this.rightBtn,this.onArrowClick),this.removeTouchEvent(this.updateBtn,this.onUpdateClick),EventProxy.RemoveListener(this,EventType.S2CRepTitleUpgradeReputation,this.S2CRepTitleUpgradeReputation),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.onMoneyUpdate)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onArrowClick=function(t){switch(t.currentTarget){case this.rightBtn:var e=this.current_level+1;e<=TitleProxy.ins().GetCurrentLevel()+1&&void 0!=GlobalConfig.getReputation_dataConfig(e)&&(this.SetData(e),this.current_level=e);break;case this.leftBtn:var i=this.current_level-1;0!=i&&void 0!=GlobalConfig.getReputation_dataConfig(i)&&(this.SetData(i),this.current_level=i)}},e.prototype.onUpdateClick=function(t){var e=TitleProxy.ins().GetCurrentLevel()+1,i=GlobalConfig.getReputation_dataConfig(e),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);void 0!=i?n>=i.need_value?TitleProxy.ins().C2SReqTitleUpgradeReputation(e):TipsControl.ins().showTips("积分不足！"):TipsControl.ins().showTips("已是满阶！")},e.prototype.S2CRepTitleUpgradeReputation=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.InitData()},e.prototype.InitData=function(){var t=TitleProxy.ins().GetCurrentLevel();t=Math.max(1,t),this.SetData(t),this.current_level=t,this.process()},e.prototype.process=function(){var t=GlobalConfig.getReputation_dataConfig(TitleProxy.ins().GetCurrentLevel()+1);void 0==t&&(t=GlobalConfig.getReputation_dataConfig(TitleProxy.ins().GetCurrentLevel()));var e=t.need_value,i=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);this.valueBar.maximum=e,this.valueBar.value=i},e.prototype.SetData=function(t){var e=GlobalConfig.getReputation_dataConfig(t),i=GlobalConfig.getReputation_dataConfig(TitleProxy.ins().GetCurrentLevel());this.fightValue.text="";var n=e.attack.toString(),o=e.hp.toString();if(e.id>TitleProxy.ins().GetCurrentLevel()){var s=e.attack-i.attack,r=e.hp-i.hp;this.attr0.textFlow=UtilProxy.generateTextFlow("攻击    +"+n+"|C:7&(+"+s+")"),this.attr1.textFlow=UtilProxy.generateTextFlow("生命    +"+o+"|C:7&(+"+r+")")}else this.attr0.textFlow=UtilProxy.generateTextFlow("攻击    +"+n),this.attr1.textFlow=UtilProxy.generateTextFlow("生命    +"+o);this.bossIcon.source="",this.swLevel.text=TitleProxy.ins().getShengWanglvlName(e.id,FacProxy.ins().getFacId());for(var a=new Array,h=0;h<e.items.length;++h){var l=new ItemCellData,p=e.items[h][0],c=e.items[h][1],u={item_slot_idx:0,item_type_id:p,item_count:c};l.setItemCellData(u),a.push(l)}this.listS.dataProvider=new eui.ArrayCollection(a)},e.prototype.onMoneyUpdate=function(t){void 0!=t&&t==MoneyAttr.SHENGWANG&&this.process()},e.prototype.setVisible=function(t){this.visible=t,t&&this.InitData()},e}(BaseEuiView);__reflect(TitleView_reputation.prototype,"TitleView_reputation"),window.TitleView_reputation=TitleView_reputation;var TitleView_title=function(t){function e(){var e=t.call(this)||this;return e.current_type=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=TitleItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.sbtnList=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3],this.attr_list=[this.attr0,this.attr2,this.attr1,this.attr3],this.pics=[this.pic0,this.pic1,this.pic2,this.pic3,this.pic4]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.sbtnList.length;++i)this.addTouchEvent(this.sbtnList[i],this.OnClick);this.addTouchEvent(this.enterBtn0,this.OnEnterClick),this.addTouchEvent(this.enterBtn1,this.OnEnterClick),this.addTouchEvent(this.use,this.OnUseClick),EventProxy.AddListener(this,EventType.S2CRepTitleActive,this.S2CRepTitleActive),EventProxy.AddListener(this,EventType.S2CRepTitleUpgrade,this.S2CRepTitleUpgrade),EventProxy.AddListener(this,EventType.S2CRepTitleUse,this.S2CRepTitleUse),this.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.sbtnList.length;++i)this.removeTouchEvent(this.sbtnList[i],this.OnClick);this.removeTouchEvent(this.enterBtn0,this.OnEnterClick),this.removeTouchEvent(this.enterBtn1,this.OnEnterClick),this.removeTouchEvent(this.use,this.OnUseClick),EventProxy.RemoveListener(this,EventType.S2CRepTitleActive,this.S2CRepTitleActive),EventProxy.RemoveListener(this,EventType.S2CRepTitleUpgrade,this.S2CRepTitleUpgrade),EventProxy.RemoveListener(this,EventType.S2CRepTitleUse,this.S2CRepTitleUse)},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData()},e.prototype.S2CRepTitleActive=function(t){this.setFightTotal();for(var e=0;e<this.list.numChildren;++e){var i=this.list.getChildAt(e),n=i.data;void 0!=n&&n.id==t&&i.refreshData()}void 0!=this.lastSkinItem&&this.SetSkinData(this.lastSkinItem),this.setRed()},e.prototype.S2CRepTitleUpgrade=function(t){this.setFightTotal();for(var e=0;e<this.list.numChildren;++e){var i=this.list.getChildAt(e),n=i.data;void 0!=n&&n.id==t&&i.refreshData()}void 0!=this.lastSkinItem&&this.SetSkinData(this.lastSkinItem),this.setRed()},e.prototype.S2CRepTitleUse=function(){if(void 0!=this.lastSkinItem){var t=this.lastSkinItem.data;void 0!=t&&(this.use_select.visible=TitleProxy.ins().isUseTitle(t.id))}this.setRed()},e.prototype.OnClick=function(t){var e=this.sbtnList.indexOf(t.currentTarget);this.setDataByType(e+1)},e.prototype.OnEnterClick=function(t){if(void 0!=this.lastSkinItem){var e=this.lastSkinItem.data;if(void 0!=e){var i=TitleProxy.ins().getNextData(e);if(void 0!=i&&i.items.length>0)if(BagProxy.ins().getItemCountById(i.items[0][0])>=i.items[0][1])1==e.active?TitleProxy.ins().C2SReqTitleUpgrade(e.id):TitleProxy.ins().C2SReqTitleActive(e.id);else{var n=GlobalConfig.getItemsConfig(i.items[0][0]);void 0!=n&&TipsControl.ins().showTips(n.name+"不足")}}}},e.prototype.OnUseClick=function(t){var e=this.lastSkinItem.data;void 0!=e&&(TitleProxy.ins().isUseTitle(e.id)||TitleProxy.ins().C2SReqTitleUse(e.id))},e.prototype.setData=function(){this.setRed(),this.setDataByType(1),this.setFightTotal()},e.prototype.setDataByType=function(t){var e=TitleProxy.ins().getTitleDataByType(t);if(void 0!=e){this.current_type=t,e.sort(TitleProxy.ins().sortTitle),this.list.dataProvider=new eui.ArrayCollection(e),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.SkinItemClick,this);var i=function(){var t=this.list.$children[0];if(void 0!=t){var e=t.data;void 0!=e&&void 0!=e.id&&(this.selectSkinItem(t),this.list.selectedIndex=0,TimerManager.ins().remove(i,this))}};TimerManager.ins().doTimer(100,0,i,this)}},e.prototype.setFightTotal=function(){this.fightValue.text=TitleProxy.ins().getTitleTotalFight().toString()},e.prototype.SkinItemClick=function(t){var e=t.itemRenderer;this.selectSkinItem(e)},e.prototype.selectSkinItem=function(t){if(void 0!=t){if(void 0!=this.lastSkinItem&&this.lastSkinItem==t)return;this.lastSkinItem=t,this.SetSkinData(t)}},e.prototype.SetSkinData=function(t){var e=t.data;if(void 0!=e){var i=TitleProxy.ins().getCurData(e),n=TitleProxy.ins().getNextData(e),o=AttrProxy.getAttrInfo(n),s=AttrProxy.getAttrInfo(i);this.stateG0.visible=1==e.active,this.payG0.visible=e.isUp,this.stateG1.visible=1!=e.active&&e.isUp,this.payG0.visible=e.isForever,this.enterBtn0.label=1==e.active?"升级":"激活",this.enterBtn1.label=1==e.active?"升级":"激活",this.path0.text=e.path,this.path1.text=e.path,this.use_select.visible=TitleProxy.ins().isUseTitle(e.id);for(var r=0;r<this.attr_list.length;++r)void 0!=s[r]||void 0!=o[r]?void 0!=n&&o.length>0?this.attr_list[r].textFlow=UtilProxy.generateTextFlow("C:1&"+o[r][0]+"|C:7& +"+o[r][1]):this.attr_list[r].textFlow=UtilProxy.generateTextFlow("C:1&"+s[r][0]+"|C:7& +"+s[r][1]):this.attr_list[r].text="";if(void 0!=n){var a=UtilProxy.GetAttrFight(n);this.fightValue0.text=a.toString()}else if(void 0!=i){var h=UtilProxy.GetAttrFight(i);this.fightValue0.text=h.toString()}else this.fightValue0.text="";if(void 0!=n){if(n.items.length>0){var l=GlobalConfig.getItemsConfig(n.items[0][0]);void 0!=l&&(this.payValue.text=n.items[0][1],this.payValue1.text=n.items[0][1],this.payIcon.source=l.displayid,this.payIcon1.source=l.displayid)}}else this.payG0.visible=!1;if(this.icon.source=e.res,this.picG.visible=e.isForever,e.isForever){var p=e.titleInfo?e.titleInfo.time:0,c="",u="";if(i)c=i.star_pic,u=i.star_bg;else{var d=GlobalConfig.getTitle_upgrade_dataById(e.id,1);c=d.star_pic,u=d.star_bg}for(var r=0;r<this.pics.length;r++){var g=p%this.pics.length;0==g&&p>0||g>r?this.pics[r].source=c:this.pics[r].source=u}}}},e.prototype.setRed=function(){for(var t=0;t<this.sbtnList.length;++t)this.sbtnList[t].setRed(TitleProxy.ins().getTitleNumByType(t+1)>0)},e}(BaseEuiView);__reflect(TitleView_title.prototype,"TitleView_title"),window.TitleView_title=TitleView_title;var JcReportItem=function(t){function e(){var e=t.call(this)||this;return e.strlist=["十六进八竞猜","八进四竞猜","半决赛竞猜","决赛竞猜"],e.statestr=["|C:7&进行中|","|C:7&竞猜成功|","|C:4&竞猜失败|"],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="JcReportItemSkin"},e.prototype.dataChanged=function(){var t=this.data.list[0],e=this.data.list[1];this.icon.source="common_touxiang_0"+t.prof,this.icon0.source="common_touxiang_0"+e.prof,this.namelab1.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[t.server_id,t.name]),this.namelab2.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[e.server_id,e.name]),this.pic1.visible=this.data.support_role_id==t.role_id,this.pic2.visible=this.data.support_role_id==e.role_id,this.tips1.visible=this.data.support_role_id==t.role_id,this.tips2.visible=this.data.support_role_id==e.role_id,this.lab1.text=this.strlist[this.data.stage-1],this.lab2.textFlow=UtilProxy.generateTextFlow(this.statestr[this.data.result]),this.lab3.visible=1==this.data.result,this.moneypic.visible=1==this.data.result,this.lab3.text=UtilProxy.getStr("获得：	      @0 ",[this.data.money])},e}(BaseItemRender);__reflect(JcReportItem.prototype,"JcReportItem"),window.JcReportItem=JcReportItem;var JcReportView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="JcReportSkin",this.sv.viewport=this.list,this.list.itemRenderer=JcReportItem,this.tips.textFlow=UtilProxy.generateTextFlow("|C:10&竞猜成功获得的奖励通过邮件发放|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CPvpGetGuessInfo,this.ShowInfo),this.curType=t[0],PvpProxy.ins().C2SReqPvpGetGuessInfo(this.curType),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetGuessInfo,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var t=PvpProxy.ins().guesslist;for(var e in t)this.arraylist.addItem(t[e])},e}(BaseEuiView);__reflect(JcReportView.prototype,"JcReportView"),ViewManager.ins().reg(JcReportView,LayerManager.UI_Main2),window.JcReportView=JcReportView;var JcTipsView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="JcTipsSkin",this.checks=[this.check1,this.check2,this.check3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onJcClick);for(var i=0;i<this.checks.length;i++)this.addChangeEvent(this.checks[i],this.selectChange);this.jcdata=t[0],this.curtype=t[1],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onJcClick);for(var i=0;i<this.checks.length;i++)this.checks[i].removeEventListener(egret.Event.CHANGE,this.selectChange,this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onJcClick=function(t){var e=GlobalConfig.getPvp_guess_dataConfig(this.curindex);return void 0==e?void TipsControl.ins().showTips("未选择竞猜的元宝"):RoleProxy.ins().getMoneyAttr(e.moneys[0])<e.moneys[1]?void TipsControl.ins().showTips("竞猜所需元宝不足，无法竞猜"):(PvpProxy.ins().C2SReqPvpGuessVote(this.curtype,this.jcdata.role_id,this.curindex),void ViewManager.ins().close(this))},e.prototype.selectChange=function(t){this.check1.selected=!1,this.check2.selected=!1,this.check3.selected=!1,t.currentTarget.selected=!0,this.curindex=this.checks.indexOf(t.currentTarget)+1,this.SetMoneyLab()},e.prototype.ShowInfo=function(){if(void 0!=this.jcdata){this.namelab.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[this.jcdata.server_id,this.jcdata.name]),this.lab0.text=UtilProxy.getStr("竞技赔率：@0 ",[Math.floor(100*this.jcdata.back_rate)/100]);var t=GlobalConfig.getSetup_head_dataConfig(this.jcdata.use_head_id);this.icon.source=t?t.icon:"common_touxiang_0"+this.jcdata.prof;var e=GlobalConfig.getSetup_head_frame_dataConfig(this.jcdata.use_head_frame_id);this.bg.source=e?e.icon:"common_Box_01",this.vip.text=UtilProxy.getStr("@0 ",[this.jcdata.vip_level]);for(var i=0;i<this.checks.length;i++){var n=GlobalConfig.getPvp_guess_dataConfig(i+1);this.checks[i].label=UtilProxy.getStr("         @0 ",[n.moneys[1]])}this.SetMoneyLab()}},e.prototype.SetMoneyLab=function(){var t=GlobalConfig.getPvp_guess_dataConfig(this.curindex);if(this.moneypic.visible=void 0!=t,t){var e=Math.floor(100*this.jcdata.back_rate)/100;this.lab1.text="竞猜预测奖励：	      "+Math.floor(t.moneys[1]*e)}else this.lab1.text=""},e}(BaseEuiView);__reflect(JcTipsView.prototype,"JcTipsView"),ViewManager.ins().reg(JcTipsView,LayerManager.UI_Main2),window.JcTipsView=JcTipsView;var MyWxReportView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MyWXReportSkin",this.sv.viewport=this.list,this.list.itemRenderer=WxReportItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CPvpGetSelfTopReport,this.ShowInfo),PvpProxy.ins().C2SReqPvpGetSelfTopReport(),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetSelfTopReport,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var t=PvpProxy.ins().selfTopReports;for(var e in t)this.arraylist.addItem(t[e])},e}(BaseEuiView);__reflect(MyWxReportView.prototype,"MyWxReportView"),ViewManager.ins().reg(MyWxReportView,LayerManager.UI_Main2),window.MyWxReportView=MyWxReportView;var SddjItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="SddjItemSkin"},e.prototype.dataChanged=function(){this.data?this.data.rank:this.itemIndex+1;if(this.tips.visible=void 0==this.data,this.info.visible=void 0!=this.data,this.data){this.vip.text=UtilProxy.getStr("@0 ",[this.data.vip_level]),this.lab0.textFlow=UtilProxy.StrFormart("|C:10&昵称：S@0 .@1 |",[this.data.server_id,this.data.name]),this.lab1.text=UtilProxy.getStr("等级：@0 ",[this.data.level]),this.lab2.text=UtilProxy.getStr("战力：@0 ",[this.data.fighting]);var t=GlobalConfig.getSetup_head_dataConfig(this.data.use_head_id);this.icon.source=t?t.icon:"common_touxiang_0"+this.data.prof;var e=GlobalConfig.getSetup_head_frame_dataConfig(this.data.use_head_frame_id);this.bg.source=e?e.icon:"common_Box_01"}},e}(BaseItemRender);__reflect(SddjItem.prototype,"SddjItem"),window.SddjItem=SddjItem;var SDDJView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SDDJViewSkin",this.comview.initUI(),this.comview.SetName("title_sidadijun"),this.list.itemRenderer=SddjItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.reportbtn,this.onRepoetClick),EventProxy.AddListener(this,EventType.S2CPvpGetRankList,this.ShowInfo),PvpProxy.ins().C2SReqPvpGetRankList(2),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.reportbtn,this.onRepoetClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetRankList,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onRepoetClick=function(t){ViewManager.ins().open(TopReportView,2)},e.prototype.ShowInfo=function(){this.ShowTopInfo(),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();for(var t=PvpProxy.ins().getRankList(2),e=1;4>e;e++){var i=t[e];this.arraylist.addItem(i)}},e.prototype.ShowTopInfo=function(){var t=PvpProxy.ins().getRankList(2)[0];this.namelab.textFlow=UtilProxy.StrFormart("|C:10&昵称：@0 |",[t?UtilProxy.getStr("S@0 .@1 ",[t.server_id,t.name]):"虚位以待"]),this.zhanlab.text=UtilProxy.getStr("战力：@0 ",[t?t.fighting:0]),this.countlab.text=UtilProxy.getStr("登顶次数：@0 ",[t?t.top_count:0]),this.vipg.visible=void 0!=t,this.vip.text=UtilProxy.getStr("@0 ",[t?t.vip_level:0]);var e=void 0;if(t&&(e=GlobalConfig.getPvp_step_dataConfig(t.step_level)),this.lvicon.source=e?e.icon:"wangzhe_2",this.lvlab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[e?e.name:"王者"]),this.model.removeChildren(),t)UtilProxy.GetRoleObjectById(t.fashion_id,0,t.shenbing,this.model,t.prof);else{var i=GlobalConfig.getPvp_base_dataConfig(1);UtilProxy.GetRoleObject(i.ui_model,"",i.ui_weapon,this.model)}},e}(BaseEuiView);__reflect(SDDJView.prototype,"SDDJView"),ViewManager.ins().reg(SDDJView,LayerManager.UI_Main),window.SDDJView=SDDJView;var TopAwardItem=function(t){function e(e,i,n,o){void 0===n&&(n=void 0),void 0===o&&(o="");var s=t.call(this)||this;return s.rankNum=[],s.awardList=[],s.itemName="",s.skinName="TopAwardItemSkin",s.rankNum=e,s.awardList=i,s.icon=n,s.itemName=o,s.list.itemRenderer=ItemCell,s.initData(),s}return __extends(e,t),Object.defineProperty(e.prototype,"firstToThird",{get:function(){return["top_icon_01","top_icon_02","top_icon_03"]},enumerable:!0,configurable:!0}),e.prototype.initData=function(){var t=new eui.ArrayCollection;this.list.dataProvider=t,t.removeAll();for(var e=0;e<this.awardList.length;e++)t.addItem(this.awardList[e]);if(this.g_No.removeChildren(),void 0!=this.icon){this.g_No.addChild(new eui.Image(this.icon));var i=new eui.Label(this.itemName);i.size=20,this.g_No.addChild(i)}else{var n=new eui.BitmapLabel;switch(n.font="paimingFont_fnt",n.text="",this.rankNum.length){case 1:this.rankNum[0]>3?n.text="第"+this.rankNum[0]+"名":this.g_No.addChild(new eui.Image(this.firstToThird[this.rankNum[0]-1]));break;case 2:n.text="第"+this.rankNum[0]+"-"+this.rankNum[1]+"名"}n.text.length>0&&this.g_No.addChild(n)}},e}(eui.Component);__reflect(TopAwardItem.prototype,"TopAwardItem"),window.TopAwardItem=TopAwardItem;var TopAwardView=function(t){function e(){var e=t.call(this)||this;return e.infoTxt=["在段位晋升时通过邮件发放","每周日结算奖励并通过邮件发放","每周日结算奖励并通过邮件发放"],e.btns=[],e.currBtnIndex=0,e.cfs=(i={},i[0]=[],i[1]=[],i[2]=[],i),e;var i}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TopAwardSkin",this.btns=[];for(var e=0;e<this.g_btn.numChildren;e++){var i=this.g_btn.getChildAt(e);this.btns.push(i)}},e.prototype.initBtn=function(){for(var t=0;t<this.btns.length;t++)this.currBtnIndex==t?this.btns[t].icon="common_btn_big_yellow":this.btns[t].icon="common_btn_big_yellow_off"},e.prototype.initCfs=function(t,e){for(var i in e)switch(t){case 0:this.cfs[t].push(e[i]);break;case 1:this.cfs[t].push(e[i]);break;case 2:this.cfs[t].push(e[i])}0==t&&this.cfs[t].reverse()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.currBtnIndex=0,this.initBtn(),this.initCfs(0,GlobalConfig.getConfig("pvp_step_data","Pvp_step_dataConfig")),this.initCfs(1,GlobalConfig.getConfig("pvp_rank_award","Pvp_rank_awardConfig")),this.initCfs(2,GlobalConfig.getConfig("pvp_cross_rank_award","Pvp_cross_rank_awardConfig")),this.addTouchEvent(this.btn_close,this.onCloseClick),this.addTouchEvent(this.btn_ret,this.onCloseClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onClick);this.showInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onCloseClick=function(){ViewManager.ins().close(this)},e.prototype.onClick=function(t){var e=this.btns.indexOf(t.currentTarget);void 0!=e&&e!=this.currBtnIndex&&(this.currBtnIndex=e,this.initBtn(),this.showInfo())},e.prototype.showInfo=function(){this.g_item.parent.scrollV=0,this.g_item.removeChildren();for(var t=0;t<this.cfs[this.currBtnIndex].length;t++){var e=this.cfs[this.currBtnIndex][t].id,i=[];if(0!=this.currBtnIndex){for(var n=this.cfs[this.currBtnIndex][t],o=0;o<n.items.length;o++){var s=UtilProxy.GetItemCellData(n.items[o][0],n.items[o][1]);i.push(s)}this.g_item.addChild(new TopAwardItem([e],i))}else{if(t==this.cfs[this.currBtnIndex].length-1)break;for(var n=this.cfs[this.currBtnIndex][t],o=0;o<n.step_award.length;o++){var s=UtilProxy.GetItemCellData(n.step_award[o][0],n.step_award[o][1]);i.push(s)}this.g_item.addChild(new TopAwardItem([e],i,n.s_icon,n.name))}}this.lb_info.text=this.infoTxt[this.currBtnIndex]},e}(BaseEuiView);__reflect(TopAwardView.prototype,"TopAwardView"),ViewManager.ins().reg(TopAwardView,LayerManager.UI_Main2),window.TopAwardView=TopAwardView;var TopBattlefieldView=function(t){function e(){var e=t.call(this)||this;return e.rankLimit=1e3,e.matchLimit=6,e.isTopMatch=!1,e.btns=[],e.infoLables=[],e.infoTitles=["当前排名：","当前阶段：","巅峰积分：","赛季剩余时间："],e.infoTxts=["","","",""],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TopBattlefieldSkin",this.comview.initUI(),this.comview.SetName("title_dianfengzhanchang");for(var e=0;e<this.g_info.numChildren;e++)this.infoLables.push(this.g_info.getChildAt(e));this.btns=[this.btn_rankAwards,this.btn_ranking,this.btn_treasury,this.btn_lastRanking,this.btn_match,this.btn_topMatch],this.lb_match.text="",this.lb_topMatch.text=""},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),EventProxy.AddListener(this,EventType.S2CPvpGetInfo,this.refreshInfo),EventProxy.AddListener(this,EventType.S2CRepMiscDailyChange,this.refreshMatch),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn_return,this.onCloseClick),this.addTouchEvent(this.wen,this.onClick),this.addTouchEvent(this.closebtn1,this.onClick);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onClick);TimerManager.ins().doTimer(1e4,0,this.dateInit,this),PvpProxy.ins().IsShowTopRed&&(PvpProxy.ins().IsShowTopRed=!1,EventProxy.Broast(EventType.XiuXianUpdate,{})),this.refreshMatch(),this.refreshInfo(),this.dateInit(),PvpProxy.ins().C2SReqPvpGetInfo(),this.tipsgroup.visible=!1
},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),EventProxy.RemoveListener(this,EventType.S2CPvpGetInfo,this.refreshInfo),EventProxy.RemoveListener(this,EventType.S2CRepMiscDailyChange,this.refreshMatch),TimerManager.ins().remove(this.dateInit,this)},e.prototype.showInfo=function(){},e.prototype.infoInit=function(t){this.infoLables[t].textFlow=UtilProxy.generateTextFlow(this.infoTitles[t]+("|C:5&"+this.infoTxts[t]+"|"))},e.prototype.refreshMatch=function(){var t=GlobalConfig.getPvp_base_dataConfig(1);this.removeTouchEvent(this.g_topMatch,this.onClick),this.removeTouchEvent(this.g_match,this.onClick);var e=new Date(1e3*GameLogic.ins().getServerTime()).getDay();this.isTopMatch=e==t.season_week_day?!0:!1,this.infoTxts[1]=this.isTopMatch?"巅峰赛":"积分赛",this.infoInit(1),UtilProxy.SetAshColor(this.g_match,this.isTopMatch),UtilProxy.SetAshColor(this.g_topMatch,!this.isTopMatch),UtilProxy.SetAshColor(this.btn_match,this.isTopMatch),UtilProxy.SetAshColor(this.btn_topMatch,!this.isTopMatch),this.isTopMatch?(this.addTouchEvent(this.g_topMatch,this.onClick),this.lb_match.text="本周已结束"):(this.addTouchEvent(this.g_match,this.onClick),this.lb_topMatch.text="本周未开启");var i=["日","一","二","三","四","五","六"],n=t.season_week_day,o=[t.ladder_stage[0],t.ladder_stage[t.ladder_stage.length-1]];this.infoLables[4].textFlow=UtilProxy.generateTextFlow("|C:7&跨服榜前48名获得周"+i[n]+"巅峰赛资格|"),this.lb_matchInfo.textFlow=UtilProxy.generateTextFlow("|C:7&周"+i[o[0]]+"到周"+i[o[1]]+"|"),this.lb_topMatchInfo.textFlow=UtilProxy.generateTextFlow("|C:7&周"+i[n]+"|")},e.prototype.refreshInfo=function(){this.infoTxts[0]=PvpProxy.ins().rank>this.rankLimit||0==PvpProxy.ins().rank?"未上榜":"第"+PvpProxy.ins().rank+"名",this.infoTxts[2]=""+PvpProxy.ins().score,this.infoInit(0),this.infoInit(2)},e.prototype.dateInit=function(){var t=GlobalConfig.getPvp_base_dataConfig(1),e=(t.season_week_day-new Date(1e3*GameLogic.ins().getServerTime()).getDay()+7)%7,i=3600*(24*(e+1)-8)-GameLogic.ins().getServerTime()%86400;this.infoTxts[3]=DateUtils.getFormatTimeByStyle(i,DateUtils.STYLE_2).split("分")[0]+"分",this.infoInit(3),this.isTopMatch?this.lb_topMatch.text="距离巅峰赛结束：\n"+this.infoTxts[3]:this.lb_match.text="距离积分赛结束：\n"+DateUtils.getFormatTimeByStyle(i-86400,DateUtils.STYLE_2).split("分")[0]+"分"},e.prototype.onCloseClick=function(){ViewManager.ins().close(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.wen:this.tipsgroup.visible=!0,this.ShowWenTips();break;case this.closebtn1:this.tipsgroup.visible=!1;break;case this.btn_rankAwards:ViewManager.ins().open(TopAwardView);break;case this.btn_ranking:ViewManager.ins().open(TopRankView);break;case this.btn_treasury:ViewManager.ins().open(BaoKuView);break;case this.btn_lastRanking:ViewManager.ins().open(SDDJView);break;case this.btn_match:case this.g_match:ViewManager.ins().open(TopFightView),ViewManager.ins().close(this);break;case this.btn_topMatch:case this.g_topMatch:ViewManager.ins().open(WanxianView),ViewManager.ins().close(this);break;default:return}},e.prototype.ShowWenTips=function(){this.desc.textFlow=UtilProxy.generateTextFlow(GlobalConfig.getPvp_base_dataConfig(1).tipsinfo)},e}(BaseEuiView);__reflect(TopBattlefieldView.prototype,"TopBattlefieldView"),ViewManager.ins().reg(TopBattlefieldView,LayerManager.UI_Main),window.TopBattlefieldView=TopBattlefieldView;var TopFightView=function(t){function e(){var e=t.call(this)||this;return e.lefttime=0,e.IsInTopfight=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TopFightSkin",this.comview.initUI(),this.comview.SetName("title_dianfengdoufa"),this.awardlist.itemRenderer=ItemCell,this.alist.itemRenderer=ItemCell,this.title1.textFlow=UtilProxy.generateTextFlow("|C:10&奖励|"),this.info0.textFlow=UtilProxy.generateTextFlow("|C:4&条件达成后可领取|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&每日胜利|"),this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&正在匹配中|"),this.tips.visible=!1,this.btns=[this.btn0,this.btn1,this.btn2,this.btn3],this.labs=[this.lab0,this.lab1,this.lab2,this.lab3],this.hasgetpics=[this.has_get0,this.has_get1,this.has_get2,this.has_get3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.wen,this.onSysClick),this.addTouchEvent(this.closebtn0,this.onSysClick),this.addTouchEvent(this.rankbtn,this.onSysClick),this.addTouchEvent(this.reportbtn,this.onSysClick),this.addTouchEvent(this.fightBtn,this.onSysClick),this.addTouchEvent(this.closebtn1,this.onAwardBtn),this.addTouchEvent(this.add,this.OnAdd);for(var i=0;i<this.btns.length;i++)this.addTouchEvent(this.btns[i],this.onAwardBtn);this.addChangeEvent(this.aotubtn,this.selectChange),EventProxy.AddListener(this,EventType.S2CPvpGetInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CPvpBuyTimes,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CPvpGetDailyAward,this.SetFightCountAward),PvpProxy.ins().IsShowTopRed&&(PvpProxy.ins().IsShowTopRed=!1,EventProxy.Broast(EventType.XiuXianUpdate,{})),PvpProxy.ins().C2SReqPvpGetInfo(),(!PvpProxy.ins().IsInTopfightTime()||PvpProxy.ins().total_fight_num<=0)&&(PvpProxy.ins().IsAotu=!1),this.ShowInfo(),this.aotubtn.selected=PvpProxy.ins().IsAotu,PvpProxy.ins().IsAotu&&this.ShowPipei()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.wen,this.onSysClick),this.removeTouchEvent(this.closebtn0,this.onSysClick),this.removeTouchEvent(this.rankbtn,this.onSysClick),this.removeTouchEvent(this.reportbtn,this.onSysClick),this.removeTouchEvent(this.fightBtn,this.onSysClick),this.removeTouchEvent(this.closebtn1,this.onAwardBtn),this.removeTouchEvent(this.add,this.OnAdd);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onAwardBtn);EventProxy.RemoveListener(this,EventType.S2CPvpGetInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CPvpBuyTimes,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CPvpGetDailyAward,this.SetFightCountAward),this.aotubtn.removeEventListener(egret.Event.CHANGE,this.selectChange,this),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSysClick=function(t){switch(t.currentTarget){case this.wen:this.tipsgroup.visible=!0,this.ShowWenTips();break;case this.closebtn0:this.tipsgroup.visible=!1;break;case this.rankbtn:ViewManager.ins().open(TopRankView);break;case this.reportbtn:ViewManager.ins().open(TopReportView,1);break;case this.fightBtn:if(!PvpProxy.ins().IsInTopfightTime())return void TipsControl.ins().showTips("不在活动时间内");if(!UtilProxy.IsCanTranScene())return void TipsControl.ins().showTips("当前场景不能进行挑战");if(PvpProxy.ins().total_fight_num<=0)return void TipsControl.ins().showTips("挑战次数不足");LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),ViewManager.ins().open(PipeiView,PvpType.TOP_FIGHT)}},e.prototype.OnAdd=function(t){var e=PvpProxy.ins().getCurBuyData();if(void 0==e||PvpProxy.ins().today_buy_num>=e.max_buy_times)return void TipsControl.ins().showTips("购买次数不足");var i=e.items_list[PvpProxy.ins().today_buy_num]?e.items_list[PvpProxy.ins().today_buy_num]:e.items_list[e.items_list.length-1],n=e.max_buy_times,o=UtilProxy.getStr("是否花费|C:7&@0 @1 |购买1次挑战次数?\n今日剩余购买次数|C:7&(@2 /@3 )|",[i[0][1],BagProxy.ins().getItemName(i[0][0]),n-PvpProxy.ins().today_buy_num,n]);TipsControl.ins().ShowTips1(o,void 0,this.BuyCount)},e.prototype.BuyCount=function(){var t=PvpProxy.ins().getCurBuyData(),e=t.items_list[PvpProxy.ins().today_buy_num]?t.items_list[PvpProxy.ins().today_buy_num]:t.items_list[t.items_list.length-1];return RoleProxy.ins().getMoneyAttr(e[0][0])<e[0][1]?(TipsControl.ins().showTips(UtilProxy.getStr("@0 不足",[BagProxy.ins().getItemName(e[0][0])])),!1):(PvpProxy.ins().C2SReqPvpBuyTimes(1),!0)},e.prototype.selectChange=function(t){return PvpProxy.ins().IsInTopfightTime()?UtilProxy.IsCanTranScene()?PvpProxy.ins().total_fight_num<=0?(TipsControl.ins().showTips("挑战次数不足"),void(PvpProxy.ins().IsAotu=this.aotubtn.selected=!1)):(PvpProxy.ins().IsAotu=this.aotubtn.selected,this.SetBtn(),void(PvpProxy.ins().IsAotu&&(LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),ViewManager.ins().open(PipeiView,PvpType.TOP_FIGHT)))):(TipsControl.ins().showTips("当前场景不能进行挑战"),void(PvpProxy.ins().IsAotu=this.aotubtn.selected=!1)):(TipsControl.ins().showTips("不在活动时间内"),void(PvpProxy.ins().IsAotu=this.aotubtn.selected=!1))},e.prototype.SetBtn=function(){this.tips.visible=PvpProxy.ins().IsAotu,this.fightBtn.visible=0==PvpProxy.ins().IsAotu,this.red.visible=this.fightBtn.visible&&this.IsInTopfight&&PvpProxy.ins().total_fight_num>0},e.prototype.ShowPipei=function(){this.SetBtn(),TimerManager.ins().doTimer(2e3,1,this.openPipei,this)},e.prototype.openPipei=function(){PvpProxy.ins().IsAotu&&(LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),ViewManager.ins().open(PipeiView,PvpType.TOP_FIGHT))},e.prototype.onAwardBtn=function(t){if(t.currentTarget==this.closebtn1)return void(this.Awardgroup.visible=!1);var e=this.btns.indexOf(t.currentTarget),i=PvpProxy.ins().getDailyAwardState(e+1);0==i?PvpProxy.ins().C2SReqPvpGetDailyAward(e+1):this.ShowAwardInfo(e+1)},e.prototype.ShowAwardInfo=function(t){this.Awardgroup.visible=!0;var e=GlobalConfig.getPvp_daily_award_dataConfig(t);this.info.textFlow=UtilProxy.StrFormart("累计胜利达到@0 场|C:@1 &(@2 /@0 )|",[e.win_num,PvpProxy.ins().today_win_num>=e.win_num?7:4,PvpProxy.ins().today_win_num]),this.arraylist2||(this.arraylist2=new eui.ArrayCollection,this.alist.dataProvider=this.arraylist2),this.arraylist2.removeAll();for(var i=0;i<e.award_items.length;i++){var n=new ItemCellData,o={item_slot_idx:0,item_type_id:e.award_items[i][0],item_count:e.award_items[i][1]};n.setItemCellData(o),this.arraylist2.addItem(n)}},e.prototype.ShowWenTips=function(){this.desc.textFlow=UtilProxy.generateTextFlow(GlobalConfig.getPvp_base_dataConfig(1).tipsinfo)},e.prototype.ShowInfo=function(){this.rank.textFlow=UtilProxy.StrFormart("|C:10&我的排名：|@0 ",[PvpProxy.ins().rank>0?PvpProxy.ins().rank:"未上榜"]),this.jifen.textFlow=UtilProxy.StrFormart("|C:10&赛季积分：|@0 ",[PvpProxy.ins().score]),this.lab.textFlow=UtilProxy.StrFormart("|C:10&参赛胜率：||C:7&@0 |胜|C:7&@1 |败(|C:7&@2 %|)",[PvpProxy.ins().win_num,PvpProxy.ins().lose_num,0==PvpProxy.ins().win_num?0:Math.floor(PvpProxy.ins().win_num/(PvpProxy.ins().win_num+PvpProxy.ins().lose_num)*100)]);var t=GlobalConfig.getPvp_step_dataConfig(PvpProxy.ins().step_level),e=GlobalConfig.getPvp_step_dataConfig(PvpProxy.ins().step_level+1);if(this.lvicon.source=t.icon,this.lvlab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.name]),this.bar1.maximum=e?e.need_score:t.need_score,this.bar1.value=PvpProxy.ins().score,this.barlab.text=UtilProxy.getStr("@0 /@1 ",[PvpProxy.ins().score,e?e.need_score:"--"]),this.arraylist1||(this.arraylist1=new eui.ArrayCollection,this.awardlist.dataProvider=this.arraylist1),this.arraylist1.removeAll(),this.tipslab.visible=!e,e)for(var i=0;i<e.step_award.length;i++){var n=new ItemCellData,o={item_slot_idx:0,item_type_id:e.step_award[i][0],item_count:e.step_award[i][1]};n.setItemCellData(o),this.arraylist1.addItem(n)}this.count.textFlow=UtilProxy.StrFormart("|C:10&挑战次数：|@0 ",[PvpProxy.ins().total_fight_num]),this.SetFightCountAward(),this.ShowColdTime()},e.prototype.SetFightCountAward=function(){for(var t=0;t<this.btns.length;t++){var e=PvpProxy.ins().getDailyAwardState(t+1);this.btns[t].icon=1==e?"xianjie_btn_2":"xianjie_btn_1",this.labs[t].text=GlobalConfig.getPvp_daily_award_dataConfig(t+1).win_num+"场",this.hasgetpics[t].visible=2==e}this.bar2.maximum=GlobalConfig.getPvp_daily_award_dataConfig(this.btns.length).win_num,this.bar2.value=PvpProxy.ins().today_win_num},e.prototype.ShowColdTime=function(){this.SetTimeLab();var t=PvpProxy.ins().getCurTopFightEndTime(),e=GameLogic.ins().getServerTime();this.lefttime=t[0]-e,this.IsInTopfight=PvpProxy.ins().IsInTopfightTime(),this.red.visible=this.fightBtn.visible&&this.IsInTopfight&&PvpProxy.ins().total_fight_num>0,this.group1.visible=this.IsInTopfight,this.time.x=this.IsInTopfight?196:105,this.time.y=this.IsInTopfight?679:630,t[1]?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,t[0]-e,this.SetTimeLab,this,this.ShowColdTime,this)):(this.time.text="",PvpProxy.ins().IsAotu=!1,this.aotubtn.selected=PvpProxy.ins().IsAotu,this.SetBtn())},e.prototype.SetTimeLab=function(){this.time.textFlow=UtilProxy.StrFormart("|C:7&活动将于@0 后@1 |",[UtilProxy.getTimeHMSString(this.lefttime),this.IsInTopfight?"结束":"开始"]),this.lefttime=this.lefttime-1},e}(BaseEuiView);__reflect(TopFightView.prototype,"TopFightView"),ViewManager.ins().reg(TopFightView,LayerManager.UI_Main),window.TopFightView=TopFightView;var TopRankItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.chenghao,this.onClick)},e.prototype.setSkinName=function(){this.skinName="TopRankItemSkin"},e.prototype.dataChanged=function(){this.rank.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[this.data.rank]),this.namelab.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[this.data.server_id,this.data.name]),this.jifen.text=this.data.score;var t=GlobalConfig.getPvp_step_dataConfig(this.data.step_level);t&&(this.icon.source=t.s_icon);var e=GlobalConfig.getPvp_rank_awardConfig(this.data.rank);if(e){var i=new ItemCellData,n={item_slot_idx:0,item_type_id:e.items[0]?e.items[0][0]:0,item_count:e.items[0]?e.items[0][1]:0};if(i.setItemCellData(n),this.award.data=i,this.chenghao.visible=e.title>0,e.title>0){var o=GlobalConfig.getTitleById(e.title);this.chenghao.source=TitleProxy.title_icon_path+o.title_res+".png"}}},e.prototype.onClick=function(t){var e=GlobalConfig.getPvp_rank_awardConfig(this.data.rank);if(e&&e.title>0){var i=GlobalConfig.getTitleById(e.title),n=new ItemCellData,o={item_slot_idx:0,item_type_id:i.tips_id,item_count:1};n.setItemCellData(o),ViewManager.ins().open(ItemTipsView,n)}t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(TopRankItem.prototype,"TopRankItem"),window.TopRankItem=TopRankItem;var TopRankItem1=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="TopRankItemSkin1"},e.prototype.dataChanged=function(){this.rank.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[this.data.rank]),this.namelab.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[this.data.server_id,this.data.name]),this.jifen.text=this.data.score;var t=GlobalConfig.getPvp_step_dataConfig(this.data.step_level);t&&(this.icon.source=t.s_icon);var e=GlobalConfig.getPvp_cross_rank_awardConfig(this.data.rank);if(e){var i=new ItemCellData,n={item_slot_idx:0,item_type_id:e.items[0]?e.items[0][0]:0,item_count:e.items[0]?e.items[0][1]:0};i.setItemCellData(n),this.award.data=i}},e}(BaseItemRender);__reflect(TopRankItem1.prototype,"TopRankItem1"),window.TopRankItem1=TopRankItem1;var TopRankView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TopRankSkin",this.list.itemRenderer=TopRankItem,this.list0.itemRenderer=TopRankItem1,this.sv.viewport=this.list,this.sv0.viewport=this.list0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn1,this.onBtnClick),this.addTouchEvent(this.btn2,this.onBtnClick),this.addTouchEvent(this.rankbtn0,this.onBtnClick),this.addTouchEvent(this.rankbtn1,this.onBtnClick),this.addTouchEvent(this.rankbtn2,this.onBtnClick),this.addTouchEvent(this.rankbtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CPvpGetRankList,this.ShowInfo),this.curType=1,PvpProxy.ins().C2SReqPvpGetRankList(this.curType),this.currankbtn=this.btn1,this.currankbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn1,this.onBtnClick),this.removeTouchEvent(this.btn2,this.onBtnClick),this.removeTouchEvent(this.rankbtn0,this.onBtnClick),this.removeTouchEvent(this.rankbtn1,this.onBtnClick),this.removeTouchEvent(this.rankbtn2,this.onBtnClick),this.removeTouchEvent(this.rankbtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetRankList,this.ShowInfo),this.currankbtn&&(this.currankbtn.icon="common_btn_big_yellow_off")},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){if(t.currentTarget==this.rankbtn)return ViewManager.ins().open(SDDJView),void ViewManager.ins().close(this);switch(t.currentTarget){case this.btn1:this.curType=1,this.currankbtn&&(this.currankbtn.icon="common_btn_big_yellow_off"),this.currankbtn=this.btn1,this.currankbtn.icon="common_btn_big_yellow";break;case this.btn2:this.currankbtn&&(this.currankbtn.icon="common_btn_big_yellow_off"),this.currankbtn=this.btn2,this.currankbtn.icon="common_btn_big_yellow",this.curType=3,this.SetCurBtn(this.rankbtn0);break;case this.rankbtn0:this.curType=3,this.SetCurBtn(t.currentTarget);break;case this.rankbtn1:this.curType=4,this.SetCurBtn(t.currentTarget);break;case this.rankbtn2:this.curType=5,this.SetCurBtn(t.currentTarget)}PvpProxy.ins().C2SReqPvpGetRankList(this.curType),this.ShowInfo()},e.prototype.SetCurBtn=function(t){this.curbtn&&(this.curbtn.icon=""),this.curbtn=t,this.curbtn.icon="common_bg_anniudi_on"},e.prototype.ShowInfo=function(){this.rank.source=GlobalConfig.getPvp_step_dataConfig(PvpProxy.ins().step_level).s_icon,this.g1.visible=1==this.curType,this.g2.visible=1!=this.curType;var t=PvpProxy.ins().getRankList(this.curType);if(1==this.curType){this.title.textFlow=UtilProxy.generateTextFlow("|C:10&本服排行|"),this.tips.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[GlobalConfig.getPvp_base_dataConfig(1).tips1]),this.ranklab.textFlow=UtilProxy.StrFormart("我的排名：|C:7&@0 |",[0==PvpProxy.ins().rank?"未上榜":PvpProxy.ins().rank]),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e])}else{this.arraylist1||(this.arraylist1=new eui.ArrayCollection,this.list0.dataProvider=this.arraylist1),this.arraylist1.removeAll();for(var e in t)this.arraylist1.addItem(t[e]);this.title.textFlow=UtilProxy.generateTextFlow("|C:10&跨服排行|"),this.tips.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[GlobalConfig.getPvp_base_dataConfig(1).tips2]),this.ranklab.textFlow=UtilProxy.StrFormart("我的排名：|C:7&@0 |",[0==PvpProxy.ins().cross_rank?"未上榜":PvpProxy.ins().cross_rank])}},e}(BaseEuiView);__reflect(TopRankView.prototype,"TopRankView"),ViewManager.ins().reg(TopRankView,LayerManager.UI_Main2),window.TopRankView=TopRankView;var TopReportView=function(t){function e(){var e=t.call(this)||this;return e.selfStr=["您战胜了S@0 .@1 ，获得@2 积分","您奋力反抗，但仙力不足，惜败给S@0 .@1 ，获得@2 积分"],e.multStr=["S@0 .@1 仙力雄厚，与S@2 .@3 大战三百回合后，战胜了他，成为天组八强之一！","S@0 .@1 奋力一搏，击败了S@2 .@3 ，成为三界的四大帝君之一！","","S@0 .@1 不愧为万年不遇的修炼天才，在与S@2 .@3 的最后一战获得胜利，成为天下第一！"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TopFightReportSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&挑战记录|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CPvpGetReport,this.ShowInfo),this.curtype=t[0],PvpProxy.ins().C2SReqPvpGetReport(this.curtype,0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetReport,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=1==this.curtype?PvpProxy.ins().self_list:PvpProxy.ins().multi_list;this.reports.removeChildren();for(var e=0;e<t.length;e++)if(void 0==t[e].stage||3!=t[e].stage){var i=new eui.Label;i.size=14,i.fontFamily="Microsoft JhengHei",i.width=413,i.lineSpacing=3,1==this.curtype?i.textFlow=UtilProxy.StrFormart(this.selfStr[t[e].result],[t[e].server_id,t[e].name,t[e].score]):i.textFlow=UtilProxy.StrFormart(this.multStr[t[e].stage-1],[t[e].server_id,t[e].name,t[e].server_id2,t[e].name2]),this.reports.addChild(i)}},e}(BaseEuiView);__reflect(TopReportView.prototype,"TopReportView"),ViewManager.ins().reg(TopReportView,LayerManager.UI_Main2),window.TopReportView=TopReportView;var WanxianReportView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WanxianReportSkin",this.labs=[this.lab1,this.lab2,this.lab3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CPvpGetReport,this.ShowInfo),PvpProxy.ins().C2SReqPvpGetReport(t[0],t[1],t[2]),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetReport,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=PvpProxy.ins().top_info;if(void 0!=t){this.namelab0.text=UtilProxy.getStr("S@0 .@1 ",[t.server_id,t.name]),this.namelab1.text=UtilProxy.getStr("S@0 .@1 ",[t.server_id2,t.name2]),this.countlab1.text=UtilProxy.getStr("@0 ",[t.win]),this.countlab2.text=UtilProxy.getStr("@0 ",[t.lose]);for(var e=0,i=0;i<this.labs.length;i++)2>i&&0==t.round_list[i]&&(e+=1),this.labs[i].text=0==t.round_list[i]?t.name:t.name2;this.r3.visible=2!=e}},e}(BaseEuiView);__reflect(WanxianReportView.prototype,"WanxianReportView"),ViewManager.ins().reg(WanxianReportView,LayerManager.UI_Main2),window.WanxianReportView=WanxianReportView;var WanxianView=function(t){function e(){var e=t.call(this)||this;return e.lefttime=0,e.IsInWanxian=!1,e.curRankType=0,e.curType=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WanxianViewSkin",this.comview.initUI(),this.comview.SetName("title_dianfengsai"),this.mylab.textFlow=UtilProxy.generateTextFlow("|C:7&U&我的竞猜|"),this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&U&冠军比分|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.infolist.numChildren;i++)this.addTouchEvent(this.infolist.getChildAt(i),this.onJcBtn);for(var i=0;i<this.r1btn.numChildren;i++)this.addTouchEvent(this.r1btn.getChildAt(i),this.onLookR1Btn);for(var i=0;i<this.r2btn.numChildren;i++)this.addTouchEvent(this.r2btn.getChildAt(i),this.onLookR2Btn);for(var i=0;i<this.r3btn.numChildren;i++)this.addTouchEvent(this.r3btn.getChildAt(i),this.onLookR3Btn);this.addTouchEvent(this.tips,this.onLookR4Btn),this.addTouchEvent(this.mylab,this.onSysClick),this.addTouchEvent(this.btn,this.onSysClick),this.addTouchEvent(this.btn1,this.onSysClick),this.addTouchEvent(this.btn2,this.onSysClick),this.addTouchEvent(this.btn3,this.onSysClick),EventProxy.AddListener(this,EventType.S2CPvpGetRankList,this.ShowRankInfo),EventProxy.AddListener(this,EventType.S2CPvpGuessVote,this.RefeshRankInfo),PvpProxy.ins().C2SReqPvpGetRankList(3),this.curRankType=3,this.curType=1,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick);for(var i=0;i<this.infolist.numChildren;i++)this.removeTouchEvent(this.infolist.getChildAt(i),this.onJcBtn);for(var i=0;i<this.r1btn.numChildren;i++)this.removeTouchEvent(this.r1btn.getChildAt(i),this.onLookR1Btn);for(var i=0;i<this.r2btn.numChildren;i++)this.removeTouchEvent(this.r2btn.getChildAt(i),this.onLookR2Btn);for(var i=0;i<this.r3btn.numChildren;i++)this.removeTouchEvent(this.r3btn.getChildAt(i),this.onLookR3Btn);this.removeTouchEvent(this.tips,this.onLookR4Btn),this.removeTouchEvent(this.mylab,this.onSysClick),this.removeTouchEvent(this.btn,this.onSysClick),this.removeTouchEvent(this.btn1,this.onSysClick),this.removeTouchEvent(this.btn2,this.onSysClick),this.removeTouchEvent(this.btn3,this.onSysClick),EventProxy.RemoveListener(this,EventType.S2CPvpGetRankList,this.ShowRankInfo),EventProxy.RemoveListener(this,EventType.S2CPvpGuessVote,this.RefeshRankInfo),TimerManager.ins().removeAll(this)},e.prototype.RefeshRankInfo=function(){PvpProxy.ins().C2SReqPvpGetRankList(this.curRankType)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSysClick=function(t){switch(t.currentTarget){case this.mylab:ViewManager.ins().open(JcReportView,this.curType);break;case this.btn:ViewManager.ins().open(MyWxReportView);break;case this.btn1:PvpProxy.ins().C2SReqPvpGetRankList(3),this.curRankType=3,this.curType=1;break;case this.btn2:PvpProxy.ins().C2SReqPvpGetRankList(4),this.curRankType=4,this.curType=2;break;case this.btn3:PvpProxy.ins().C2SReqPvpGetRankList(5),this.curRankType=5,this.curType=3}this.ShowRankInfo()},e.prototype.onJcBtn=function(t){var e=this.infolist.getChildIndex(t.currentTarget),i=PvpProxy.ins().getRankList(this.curRankType);i[e]&&i[e].back_rate>0&&ViewManager.ins().open(JcTipsView,i[e],this.curType)},e.prototype.onLookR1Btn=function(t){var e=this.r1btn.getChildIndex(t.currentTarget),i=PvpProxy.ins().getRankList(this.curRankType),n=0+2*e,o=1+2*e;i[n]&&i[o]&&ViewManager.ins().open(WanxianReportView,this.curRankType,i[n]?i[n].role_id:0,i[o]?i[o].role_id:0)},e.prototype.onLookR2Btn=function(t){var e=this.r2btn.getChildIndex(t.currentTarget),i=0+4*e,n=1+4*e,o=2+4*e,s=3+4*e,r=this.getLookRoleId(i,n,1),a=this.getLookRoleId(o,s,1);r>0&&a>0&&ViewManager.ins().open(WanxianReportView,this.curRankType,r,a)},e.prototype.onLookR3Btn=function(t){var e=this.r3btn.getChildIndex(t.currentTarget),i=0+8*e,n=3+8*e,o=4+8*e,s=7+8*e,r=this.getLookRoleId(i,n,2),a=this.getLookRoleId(o,s,2);r>0&&a>0&&ViewManager.ins().open(WanxianReportView,this.curRankType,r,a)},e.prototype.onLookR4Btn=function(t){var e=this.getLookRoleId(0,7,3),i=this.getLookRoleId(8,15,3);e>0&&i>0&&ViewManager.ins().open(WanxianReportView,this.curRankType,e,i)},e.prototype.getLookRoleId=function(t,e,i){for(var n=0,o=PvpProxy.ins().getRankList(this.curRankType),s=t;e>=s;s++)o[s]&&o[s].win_num>=i&&(n=o[s].role_id);return n},e.prototype.ShowInfo=function(){this.ShowRankInfo(),this.ShowColdTime()},e.prototype.SetCurEndTime=function(){var t=PvpProxy.ins().getCurEndTime()+3,e=GameLogic.ins().getServerTime();t-e>0&&(TimerManager.ins().remove(this.RefeshRankInfo,this),TimerManager.ins().doTimer(1e3*(t-e),1,this.RefeshRankInfo,this))},e.prototype.ShowColdTime=function(){this.SetTimeLab();var t=PvpProxy.ins().getCurWanxianEndTime(),e=GameLogic.ins().getServerTime();this.lefttime=t-e,this.IsInWanxian=PvpProxy.ins().IsInWanxianTime(),this.lefttime>0?TimerManager.ins().doTimer(1e3,t-e,this.SetTimeLab,this,this.ShowColdTime,this):this.time.textFlow=UtilProxy.generateTextFlow("|C:4&活动已结束|")},e.prototype.SetTimeLab=function(){this.time.textFlow=UtilProxy.StrFormart("|C:7&活动将于@0 后@1 |",[UtilProxy.getTimeHMSString(this.lefttime),this.IsInWanxian?"结束":"开始"]),this.lefttime=this.lefttime-1},e.prototype.ShowRankInfo=function(){this.SetCurEndTime();for(var t=PvpProxy.ins().getRankList(this.curRankType),e=0;e<this.infolist.numChildren;e++)this.SetRoleinfo(this.infolist.getChildAt(e),t[e]),this.r1.getChildAt(e).visible=void 0!=t[e]&&t[e].win_num>0;this.SetWinLine(this.r2,1),this.SetWinLine(this.r3,2),this.SetWinLine(this.r4,3),this.r1btn.visible=PvpProxy.ins().stage>1,this.r2btn.visible=PvpProxy.ins().stage>2,this.r3btn.visible=PvpProxy.ins().stage>3;var i=PvpProxy.ins().top_role;if(this.bg.visible=i&&i.role_id>0,this.icon.visible=i&&i.role_id>0,this.namelab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[i&&i.role_id>0?UtilProxy.getStr("S@0 .@1 ",[i.server_id,i.name]):"虚位以待"]),i&&i.role_id>0){var n=GlobalConfig.getSetup_head_dataConfig(i.use_head_id);this.icon.source=n?n.icon:"common_touxiang_0"+i.prof;var o=GlobalConfig.getSetup_head_frame_dataConfig(i.use_head_frame_id);this.bg.source=o?o.icon:"common_Box_01"}},e.prototype.SetWinLine=function(t,e){for(var i=PvpProxy.ins().getRankList(this.curRankType),n=0;n<t.numChildren;n++){for(var o=!1,s=0+n*Math.pow(2,e),r=2+n*Math.pow(2,e),a=s;r>a;a++)void 0!=i[a]&&i[a].win_num>e&&(o=!0);t.getChildAt(n).visible=o}},e.prototype.SetRoleinfo=function(t,e){var i=t.getChildAt(0);if(i.source=e&&e.win_num>0&&e.win_num>=PvpProxy.ins().stage-1?"wanxianzhengba_huangdi":"wanxianzhengba_landi",t.getChildAt(1).visible=void 0!=e,t.getChildAt(2).visible=void 0!=e,t.getChildAt(3).visible=void 0==e,t.getChildAt(4).visible=e&&(e.back_rate>0||e.is_support),t.getChildAt(5).visible=e&&(e.back_rate>0||e.is_support),e){var n=t.getChildAt(5);n.text=e.is_support?"支持":"竞猜";var o=t.getChildAt(1),s=t.getChildAt(2);o.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[e.server_id,e.name]),s.text=UtilProxy.getStr("赔率：@0 ",[e.back_rate?Math.floor(100*e.back_rate)/100:0])}},e}(BaseEuiView);__reflect(WanxianView.prototype,"WanxianView"),ViewManager.ins().reg(WanxianView,LayerManager.UI_Main),window.WanxianView=WanxianView;var WxReportItem=function(t){function e(){var e=t.call(this)||this;return e.strlist=["十六进八","八进四","半决赛","决赛"],e.statestr=["|C:7&晋级|","|C:4&失败|"],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="WXReportItemSkin"},e.prototype.dataChanged=function(){var t=this.data.list[0],e=this.data.list[1];this.icon.source="common_touxiang_0"+t.prof,this.icon0.source="common_touxiang_0"+e.prof,this.namelab1.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[t.server_id,t.name]),this.namelab2.textFlow=UtilProxy.StrFormart("|C:10&S@0 .@1 |",[e.server_id,e.name]),this.lab1.text=this.strlist[this.data.stage-1],this.lab2.textFlow=UtilProxy.generateTextFlow(this.statestr[this.data.result])},e}(BaseItemRender);__reflect(WxReportItem.prototype,"WxReportItem"),window.WxReportItem=WxReportItem;var RumorItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RumorItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),(this.data||this.data.item_id&&!this.data.rol_num)&&(this.data.item_id?this.data.name?this.info.textFlow=UtilProxy.generateTextFlow("C:7&"+this.data.name+"|获得了|C:9&"+BagProxy.ins().getItemName(this.data.item_id)):this.info.textFlow=UtilProxy.generateTextFlow("C:7&获得了|C:9&"+BagProxy.ins().getItemName(this.data.item_id)):this.data.rol_num&&(this.info.textFlow=UtilProxy.generateTextFlow("C:10&"+this.data.name+"| 对幸运大奖掷出 |C:7&"+this.data.rol_num+" 点")))},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this)},e}(BaseItemRender);__reflect(RumorItem.prototype,"RumorItem"),window.RumorItem=RumorItem;var TreasureBagView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="TreasureBagSkin",this.Llist.itemRenderer=ItemCell,this.Sscroller.viewport=this.Llist},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn,this.onGiveClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFindtreasureStoreInfo,this.S2CRepFindtreasureStoreInfo),this.item_arrays||(this.item_arrays=new eui.ArrayCollection,this.Llist.dataProvider=this.item_arrays,this.item_arrays.removeAll()),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];
this.removeTouchEvent(this.sbtn,this.onGiveClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureStoreInfo,this.S2CRepFindtreasureStoreInfo)},e.prototype.S2CRepFindtreasureStoreInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData()},e.prototype.onGiveClick=function(t){TreasureProxy.ins().isTreasureBagRed()?TreasureProxy.ins().C2SReqFindtreasurePickOutItem(0):TipsControl.ins().showTips("没有物品！")},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setData=function(){var t=TreasureProxy.ins().getTreasureBagList();this.item_arrays.replaceAll(t)},e}(BaseEuiView);__reflect(TreasureBagView.prototype,"TreasureBagView"),ViewManager.ins().reg(TreasureBagView,LayerManager.UI_Main),window.TreasureBagView=TreasureBagView;var TreasureItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TreasureItem0Skin",e.addTouchEvent(e.icon,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),void 0!=this.data){var e=GlobalConfig.getfwNameById(this.data.id);this.bg.source="jianxin_dikuang_0"+(this.data.color+1);var i=BagProxy.QUALITY_COLOR[this.data.color];this.fwName.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[i,e.name]);var n=GlobalConfig.getfwResById(this.data.id,this.data.color);this.icon.source=AssetMgr.getIconResource(n.icon)}},e.prototype.selectChanged=function(){t.prototype.selectChanged.call(this)},e.prototype.onClick=function(){this.data&&ViewManager.ins().open(FwTipsView,this.data.id,this.data.color)},e}(BaseItemRender);__reflect(TreasureItem.prototype,"TreasureItem"),window.TreasureItem=TreasureItem;var TreasureView_Equip=function(t){function e(){var e=t.call(this)||this;return e.isCloseFirst=!1,e.init_y=435,e.target_y=385,e}return __extends(e,t),e.prototype.initUI=function(){this.visible=!1,this.itemCellList=[this.item0,this.item1,this.item2,this.item3,this.item4,this.item5,this.item6,this.item7,this.item8,this.item9],this.showCellList1=[this.item10,this.item11],this.showCellList2=[this.item12,this.item13],this.list.itemRenderer=RumorItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.sbtn0.setCD(2),this.sbtn1.setCD(2),this.sbtn2.setCD(2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn0,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.sbtn2,this.onClick),this.addTouchEvent(this.btnF,this.onCloseFirstClick),this.addTouchEvent(this.bagBtn,this.onBagClick),this.addTouchEvent(this.btn_wen,this.onWenClick),this.setData(),this.ShowData(),egret.Tween.removeTweens(this),TreasureProxy.ins().IsFirstTweenty()?this.isCloseFirst||(this.firstG.visible=!0,this.shakeF()):this.firstG.visible=!1,EventProxy.AddListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind),EventProxy.AddListener(this,EventType.S2CRepFindtreasureMsgInfo,this.S2CRepFindtreasureMsgInfo),EventProxy.AddListener(this,EventType.S2CRepFindtreasureStoreInfo,this.S2CRepFindtreasureStoreInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.sbtn0,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.sbtn2,this.onClick),this.removeTouchEvent(this.btnF,this.onCloseFirstClick),this.removeTouchEvent(this.bagBtn,this.onBagClick),this.removeTouchEvent(this.btn_wen,this.onWenClick),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureMsgInfo,this.S2CRepFindtreasureMsgInfo),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureStoreInfo,this.S2CRepFindtreasureStoreInfo),this.clearData()},e.prototype.setVisible=function(t){this.visible=t,t&&(this.setData(),this.showRumors(),this.CheckGuide(),this.setBagBtnRed())},e.prototype.clearData=function(){this.isCloseFirst=!1},e.prototype.S2CRepFindtreasureFind=function(t){this.setData(),TreasureProxy.ins().IsFirstTweenty()||(egret.Tween.removeTweens(this),this.firstG.visible=!1),this.showRumors()},e.prototype.S2CRepFindtreasureMsgInfo=function(t){this.showRumors()},e.prototype.S2CRepFindtreasureStoreInfo=function(t){this.setBagBtnRed()},e.prototype.setBagBtnRed=function(){this.bagBtn.setRed(TreasureProxy.ins().isTreasureBagRed())},e.prototype.onBagClick=function(t){ViewManager.ins().open(TreasureBagView)},e.prototype.onWenClick=function(t){var e=GlobalConfig.getTreasure_dataConfigById(TreasureType.equip);e&&ViewManager.ins().open(TipsTrunView,e.desc)},e.prototype.onClick=function(t){var e=0;switch(t.currentTarget){case this.sbtn0:e=1;break;case this.sbtn1:e=10;break;case this.sbtn2:e=50}var i=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.equip),n=TreasureProxy.ins().getTreasurePayByType(TreasureType.equip,e);if(n){var o=GlobalConfig.getTreasure_dataConfigById(TreasureType.equip);if(RoleProxy.ins().getMoneyAttr(n.type)<n.pay){if(1==o.ten_must_money&&50==e)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(n.type)+"不足");if(BagProxy.ins().getItemCountById(i)<e)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(n.type)+"不足")}TreasureProxy.ins().C2SReqFindtreasureFind(TreasureType.equip,e)}},e.prototype.onCloseFirstClick=function(t){this.isCloseFirst=!0,this.firstG.visible=!1,egret.Tween.removeTweens(this)},e.prototype.setData=function(){var t,e=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.equip),i=GlobalConfig.getTreasure_dataConfigById(TreasureType.equip),n=BagProxy.ins().getItemCountById(e);if(e>0&&BagProxy.ins().getItemCountById(e)>0)t=BagProxy.ins().getItemData(e),this.payIcon0.visible=!1,this.pay0.text="1/"+n,this.payIcon00.visible=!0,this.payIcon00.source=AssetMgr.getIconResource(t.displayid);else{var o=TreasureProxy.ins().getTreasurePayByType(TreasureType.equip,1);this.payIcon0.visible=!0,this.payIcon0.source="common_icon_yuanvao",this.pay0.text=o.pay,this.payIcon00.visible=!1}if(e>0&&BagProxy.ins().getItemCountById(e)>=10)this.payIcon10.visible=!1,this.payIcon1.visible=!0,this.payIcon1.source=AssetMgr.getIconResource(t.displayid),this.pay1.text="10/"+n,this.discountG.visible=!1;else{var s=TreasureProxy.ins().getTreasurePayByType(TreasureType.equip,10);this.payIcon10.visible=!1,this.payIcon1.visible=!0,this.payIcon1.source="common_icon_yuanvao",this.pay1.text=s.pay,this.discountG.visible=!0}if(e>0&&BagProxy.ins().getItemCountById(e)>=50&&1!=i.ten_must_money)this.payIcon20.visible=!1,this.payIcon2.visible=!0,this.payIcon2.source=AssetMgr.getIconResource(t.displayid),this.pay2.text="10",this.discountG.visible=!1;else{var r=TreasureProxy.ins().getTreasurePayByType(TreasureType.equip,50);this.payIcon20.visible=!1,this.payIcon2.visible=!0,this.payIcon2.source="common_icon_yuanvao",this.pay2.text=r.pay}},e.prototype.ShowData=function(){var t=LimitActProxy.ins().GetServerOpenDay(),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.equip);if(e){var i=void 0;i=e.view_show_item[t-1]?e.view_show_item[t-1]:e.view_show_item[0];for(var n=0;n<i.length;++n){var o=UtilProxy.GetItemCellData(i[n],0);this.itemCellList[n]&&(this.itemCellList[n].data=o)}for(var s=e.special_show_item_1[t-1]||e.special_show_item_1[e.special_show_item_1.length-1],n=0;n<s.length;++n){var r=s[n],o=UtilProxy.GetItemCellData(r,0);this.showCellList1[n]&&(this.showCellList1[n].data=o)}for(var a=e.special_show_item_2[t-1]||e.special_show_item_2[e.special_show_item_2.length-1],n=0;n<a.length;++n){var r=a[n],o=UtilProxy.GetItemCellData(r,0);this.showCellList2[n]&&(this.showCellList2[n].data=o)}var h=e.extra_reward[0][2],l=GlobalConfig.getDropConfig(h),p=GlobalConfig.getDropItem(l.drop),c=p[0],u=UtilProxy.GetItemCellData(c[0].id,c[0].num);this.itemF.data=u}},e.prototype.shakeF=function(){this.firstG.y=435,this.firstGTween(this.target_y)},e.prototype.firstGTween=function(t){var e=this;this.tween=egret.Tween.get(this.firstG,{loop:!1,onChange:function(){e.firstG.y==e.target_y?e.firstGTween(e.init_y):e.firstG.y==e.init_y&&e.firstGTween(e.target_y)},onChangeObj:this}).to({y:t},1e3)},e.prototype.showRumors=function(){this.list.dataProvider=new eui.ArrayCollection(TreasureProxy.ins().getRumorsByType(TreasureType.equip)),this.list.validateNow(),this.list.scrollV=this.list.contentHeight-this.list.height},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(TreasureView_Equip.prototype,"TreasureView_Equip"),window.TreasureView_Equip=TreasureView_Equip;var TreasureView_LingBao=function(t){function e(){var e=t.call(this)||this;return e.msg_list=[],e.isCanClick=!0,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=ItemCell,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.list0.itemRenderer=RumorItem,this.scroller0.viewport=this.list0,this.list0.dataProvider=new eui.ArrayCollection,this.visible=!1,this.sbtn0.setCD(2),this.sbtn1.setCD(2),UtilProxy.GetMovieClipById(38,this.effect)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn0,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.fbBtn,this.onfbClick),this.addTouchEvent(this.btn_wen,this.onWenClick),this.setData(),this.refresh(),EventProxy.AddListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.sbtn0,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.fbBtn,this.onfbClick),this.removeTouchEvent(this.btn_wen,this.onWenClick),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind),TimerManager.ins().remove(this.showTween,this)},e.prototype.onWenClick=function(t){var e=GlobalConfig.getTreasure_dataConfigById(TreasureType.LingBao);e&&ViewManager.ins().open(TipsTrunView,e.desc)},e.prototype.setVisible=function(t){this.visible=t,t?(this.grou.touchEnabled=!1,this.scroller.scrollPolicyH="OFF",this.listData=new Array,this.showData(),this.showRumors(),this.scroller.viewport.scrollH=0,TimerManager.ins().doTimer(10,0,this.showTween,this),this.CheckGuide(),this.isCanClick=!0):TimerManager.ins().remove(this.showTween,this)},e.prototype.showTween=function(){this.scroller.viewport.scrollH+=.5,this.scroller.viewport.scrollH>this.scroller.viewport.contentWidth-650&&this.showData()},e.prototype.S2CRepFindtreasureFind=function(t){this.setData(),this.refresh(),this.showRumors()},e.prototype.onClick=function(t){var e=this,i=0;switch(t.currentTarget){case this.sbtn0:i=1;break;case this.sbtn1:i=10}var n=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.LingBao),o=TreasureProxy.ins().getTreasurePayByType(TreasureType.LingBao,i);if(o){var s=GlobalConfig.getTreasure_dataConfigById(TreasureType.LingBao);if(RoleProxy.ins().getMoneyAttr(o.type)<o.pay){if(1==s.ten_must_money&&10==i)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o.type)+"不足");if(BagProxy.ins().getItemCountById(n)<i)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o.type)+"不足")}if(BagProxy.ins().GetBagLeftCount(BagType.BAG)<i)return void TipsControl.ins().showTips("背包格子不足！");this.isCanClick=!1,UtilProxy.GetMovieClipById(39,this.effect,!1,function(){TreasureProxy.ins().C2SReqFindtreasureFind(TreasureType.LingBao,i),e.isCanClick=!0})}},e.prototype.onfbClick=function(t){ViewManager.ins().open(FabaoView)},e.prototype.setData=function(){var t,e=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.LingBao),i=BagProxy.ins().getItemCountById(e);if(e>0&&i>0)t=BagProxy.ins().getItemData(e),this.payIcon0.visible=!1,this.pay0.text="1/"+i,this.payIcon00.visible=!0,this.payIcon00.source=AssetMgr.getIconResource(t.displayid);else{var n=TreasureProxy.ins().getTreasurePayByType(TreasureType.LingBao,1);this.payIcon0.visible=!0,this.payIcon0.source="common_icon_yuanvao",this.pay0.text=n.pay,this.payIcon00.visible=!1}if(e>0&&i>=10)this.payIcon10.visible=!0,this.payIcon1.visible=!1,this.payIcon10.source=AssetMgr.getIconResource(t.displayid),this.pay1.text="10/"+i,this.discountG.visible=!1;else{var o=TreasureProxy.ins().getTreasurePayByType(TreasureType.LingBao,10);this.payIcon10.visible=!1,this.payIcon1.visible=!0,this.payIcon1.source="common_icon_yuanvao",this.pay1.text=o.pay,this.discountG.visible=!0}},e.prototype.showData=function(){var t=LimitActProxy.ins().GetServerOpenDay(),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.LingBao);if(e){var i=void 0;i=e.view_show_item[t]?e.view_show_item[t]:e.view_show_item[0];for(var n=0;n<i.length;++n){var o=UtilProxy.GetItemCellData(i[n],0);this.listData.push(o)}}this.list.dataProvider=new eui.ArrayCollection(this.listData)},e.prototype.refresh=function(){var t=TreasureProxy.ins().getFindCountByType(TreasureType.LingBao),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.LingBao);e&&(this.times.textFlow=UtilProxy.StrFormart(e.special_tips,[10-t%10]))},e.prototype.showRumors=function(){this.list0.dataProvider=new eui.ArrayCollection(TreasureProxy.ins().getRumorsByType(TreasureType.LingBao)),this.list0.validateNow(),this.list0.scrollV=this.list0.contentHeight-this.list0.height},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(TreasureView_LingBao.prototype,"TreasureView_LingBao"),window.TreasureView_LingBao=TreasureView_LingBao;var TreasureView_reward=function(t){function e(){var e=t.call(this)||this;return e.isTreasure=!1,e.step=0,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="TreasureRewardSkin",this.list.itemRenderer=ItemMuti,this.scroller.viewport=this.list,this.sbtn0.setCD(2),this.sbtn1.setCD(2),this.sbtn2.setCD(2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn,this.onClick),this.addTouchEvent(this.sbtn0,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.sbtn2,this.onClick),this.addTouchEvent(this.black0,this.onBlackClick),this.addTouchEvent(this.black1,this.onBlackClick),t&&t[0]&&(this.isTreasure=t[0][0]),t&&t[1]?this.info0.textFlow=UtilProxy.generateTextFlow(t[1]):this.info0.text="",this.setData(t[0])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.sbtn,this.onClick),this.removeTouchEvent(this.sbtn0,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.sbtn2,this.onClick),this.removeTouchEvent(this.black0,this.onBlackClick),this.removeTouchEvent(this.black1,this.onBlackClick),this.isTreasure=!1,egret.Tween.removeTweens(this)},e.prototype.onClick=function(t){var e=0;switch(t.currentTarget){case this.sbtn:1==this.step&&(TimerManager.ins().removeAll(this),this.end());break;case this.sbtn0:e=1;break;case this.sbtn1:e=10;break;case this.sbtn2:e=50}if(0!=e){var i=TreasureProxy.ins().getTreasurePayByType(this.treasure_type,e),n=TreasureProxy.ins().getTreasureUseItemByType(this.treasure_type),o=GlobalConfig.getTreasure_dataConfigById(this.treasure_type);if(RoleProxy.ins().getMoneyAttr(i.type)<i.pay){if(1==o.ten_must_money&&50==e)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(i.type)+"不足");if(BagProxy.ins().getItemCountById(n)<e)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(i.type)+"不足")}if(this.treasure_type==TreasureType.equip);else if(this.treasure_type==TreasureType.LingBao||this.treasure_type==TreasureType.ZhenBao){if(BagProxy.ins().GetBagLeftCount(BagType.BAG)<e)return void TipsControl.ins().showTips("背包格子不足！")}else if(this.treasure_type==TreasureType.sword&&FwProxy.ins().getSubBagCount()<e)return void TipsControl.ins().showTips("背包格子不足！");TreasureProxy.ins().C2SReqFindtreasureFind(this.treasure_type,e),this.end()}},e.prototype.onBlackClick=function(t){var e=!1;switch(t.currentTarget){case this.black0:2==this.step&&(TimerManager.ins().removeAll(this),e=!0);break;case this.black1:1==this.step&&(TimerManager.ins().removeAll(this),e=!0)}e&&this.end()},e.prototype.setData=function(t){var e=this;if(t[0]){this.treasure_type=t[1],this.data_list=t[2];var i=t[3];if(this.count=this.data_list.length,i&&i.length>0){this.specialG.visible=!0,this.specialG.scaleX=3,this.specialG.scaleY=3,this.sCell.visible=!1,this.sinfo0.text="";var n=egret.Tween.get(this.specialG);n.to({scaleX:1,scaleY:1},500,egret.Ease.backIn).call(function(){e.sCell.visible=!0;var t=i[0];e.sCell.data=t,e.step=1,e.sinfo0.text=BagProxy.ins().getItemName(i[0].item_type_id)},this)}else this.specialG.visible=!1,this.step=2;this.btnG0.visible=!0,this.btnG1.visible=!0,this.btnG2.visible=!1,this.btnG.x=0;var o,s=TreasureProxy.ins().getTreasureUseItemByType(this.treasure_type),r=BagProxy.ins().getItemCountById(s);if(s>0&&r>0)o=BagProxy.ins().getItemData(s),this.payIcon0.visible=!1,this.pay0.text="1/"+r,this.payIcon00.visible=!0,this.payIcon00.source=AssetMgr.getIconResource(o.displayid);else{var a=TreasureProxy.ins().getTreasurePayByType(this.treasure_type,1);this.payIcon0.visible=!0,this.payIcon0.source="common_icon_yuanvao",this.pay0.text=a.pay,this.payIcon00.visible=!1}if(s>0&&r>10)this.payIcon10.visible=!0,this.payIcon1.visible=!1,this.payIcon10.source=AssetMgr.getIconResource(o.displayid),this.pay1.text="10/"+r;else{var h=TreasureProxy.ins().getTreasurePayByType(this.treasure_type,10);this.payIcon10.visible=!1,this.payIcon1.visible=!0,this.payIcon1.source="common_icon_yuanvao",this.pay1.text=h.pay}if(this.treasure_type==TreasureType.equip){this.btnG2.visible=!0;var l=TreasureProxy.ins().getTreasurePayByType(this.treasure_type,50);this.payIcon20.visible=!1,this.payIcon2.visible=!0,this.payIcon2.source="common_icon_yuanvao",this.pay2.text=l.pay,this.btnG.x=-70}}else this.data_list=t[1],this.step=2,this.specialG.visible=!1,this.btnG0.visible=!1,this.btnG1.visible=!1,this.btnG2.visible=!1;this.list.dataProvider=new eui.ArrayCollection(this.data_list),this.time=10,this.info.textFlow=UtilProxy.generateTextFlow("点击空白处关闭|C:7&("+this.time+")"),this.sinfo1.textFlow=UtilProxy.generateTextFlow("点击空白处关闭|C:7&("+this.time+")"),TimerManager.ins().doTimer(1e3,10,this.update,this,this.end,this)},e.prototype.update=function(t){this.time=this.time-1,2==this.step?this.info.textFlow=UtilProxy.generateTextFlow("点击空白处关闭|C:7&("+Math.max(this.time,0)+")"):1==this.step&&(this.sinfo1.textFlow=UtilProxy.generateTextFlow("点击空白处关闭|C:7&("+Math.max(this.time,0)+")"))},e.prototype.end=function(){2==this.step?(ViewManager.ins().close(this),this.clearData()):1==this.step&&(this.specialG.visible=!1,this.step=2,this.time=10,this.info.textFlow=UtilProxy.generateTextFlow("点击空白处关闭|C:7&("+this.time+")"),TimerManager.ins().doTimer(1e3,10,this.update,this,this.end,this))},e.prototype.clearData=function(){this.step=-1},e}(BaseEuiView);__reflect(TreasureView_reward.prototype,"TreasureView_reward"),ViewManager.ins().reg(TreasureView_reward,LayerManager.UI_Main2),window.TreasureView_reward=TreasureView_reward;var TreasureView_Sword=function(t){function e(){var e=t.call(this)||this;return e.isCanClick=!0,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=TreasureItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.list0.itemRenderer=RumorItem,this.scroller0.viewport=this.list0,this.list0.dataProvider=new eui.ArrayCollection,this.link.textFlow=UtilProxy.generateTextFlow("C:7&U&立即前往"),UtilProxy.GetMovieClipById(40,this.effect),this.sbtn0.setCD(2),this.sbtn1.setCD(2),this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn0,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.link,this.onLinkClick),this.addTouchEvent(this.btn_wen,this.onWenClick),this.setData(),EventProxy.AddListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.sbtn0,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.link,this.onLinkClick),this.removeTouchEvent(this.btn_wen,this.onWenClick),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind),TimerManager.ins().remove(this.showTween,this)},e.prototype.onWenClick=function(t){var e=GlobalConfig.getTreasure_dataConfigById(TreasureType.sword);e&&ViewManager.ins().open(TipsTrunView,e.desc)},e.prototype.setVisible=function(t){this.visible=t,t?(this.listData=[],this.scroller.scrollPolicyH="OFF",this.scroller.viewport.scrollH=0,TimerManager.ins().doTimer(10,0,this.showTween,this),this.showData(),this.refresh(),this.showRumors(),this.CheckGuide(),this.isCanClick=!0):TimerManager.ins().remove(this.showTween,this)},e.prototype.showTween=function(){this.scroller.viewport.scrollH+=.5,this.scroller.viewport.scrollH>this.scroller.viewport.contentWidth-650&&this.showData()},e.prototype.S2CRepFindtreasureFind=function(t){this.setData(),this.refresh(),this.showRumors()},e.prototype.onClick=function(t){var e=this,i=0;switch(t.currentTarget){case this.sbtn0:i=1;break;case this.sbtn1:i=10}var n=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.sword),o=TreasureProxy.ins().getTreasurePayByType(TreasureType.sword,i);if(o){var s=GlobalConfig.getTreasure_dataConfigById(TreasureType.sword);if(RoleProxy.ins().getMoneyAttr(o.type)<o.pay){if(1==s.ten_must_money&&10==i)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o.type)+"不足");if(BagProxy.ins().getItemCountById(n)<i)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o.type)+"不足")}if(FwProxy.ins().getSubBagCount()<i)return void TipsControl.ins().showTips("背包格子不足！");this.isCanClick=!1,UtilProxy.GetMovieClipById(41,this.effect,!1,function(){TreasureProxy.ins().C2SReqFindtreasureFind(TreasureType.sword,i),e.isCanClick=!0})}},e.prototype.onLinkClick=function(t){var e=GameLogic.ins().getCurSceneData();return 1!=e.scene_type?void TipsControl.ins().showTips("C:4&当前处于副本或活动场景"):void ViewManager.ins().open(FubenView,3)},e.prototype.setData=function(){var t,e=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.sword),i=BagProxy.ins().getItemCountById(e);if(e>0&&i>0)t=BagProxy.ins().getItemData(e),this.payIcon0.visible=!1,this.pay0.text="1/"+i,this.payIcon00.visible=!0,this.payIcon00.source=AssetMgr.getIconResource(t.displayid);else{var n=TreasureProxy.ins().getTreasurePayByType(TreasureType.sword,1);this.payIcon0.visible=!0,this.payIcon0.source="common_icon_yuanvao",this.pay0.text=n.pay,this.payIcon00.visible=!1}if(e>0&&BagProxy.ins().getItemCountById(e)>=10)this.payIcon10.visible=!0,this.payIcon1.visible=!1,this.payIcon10.source=AssetMgr.getIconResource(t.displayid),this.pay1.text="10/"+i,this.discountG.visible=!1;else{var o=TreasureProxy.ins().getTreasurePayByType(TreasureType.sword,10);this.payIcon10.visible=!1,this.payIcon1.visible=!0,this.payIcon1.source="common_icon_yuanvao",this.pay1.text=o.pay,this.discountG.visible=!0}},e.prototype.showData=function(){var t=LimitActProxy.ins().GetServerOpenDay(),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.sword);if(e)for(var i=e.view_show_item[t]?e.view_show_item[t]:e.view_show_item[0],n=0;n<i.length;++n)this.listData.push({id:i[n][0],color:i[n][1],type:FwUIType.preview});this.list.dataProvider=new eui.ArrayCollection(this.listData)},e.prototype.refresh=function(){var t=TreasureProxy.ins().getFindCountByType(TreasureType.sword),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.sword);e&&(this.times.textFlow=UtilProxy.StrFormart(e.special_tips,[10-t%10]))},e.prototype.showRumors=function(){this.list0.dataProvider=new eui.ArrayCollection(TreasureProxy.ins().getRumorsByType(TreasureType.sword)),this.list0.validateNow(),this.list0.scrollV=this.list0.contentHeight-this.list0.height},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(TreasureView_Sword.prototype,"TreasureView_Sword"),window.TreasureView_Sword=TreasureView_Sword;var TreasureView_ZhenBao=function(t){function e(){var e=t.call(this)||this;return e.msg_list=[],e.isCanClick=!0,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=ItemCell,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.list0.itemRenderer=RumorItem,this.scroller0.viewport=this.list0,this.list0.dataProvider=new eui.ArrayCollection,this.visible=!1,this.sbtn0.setCD(2),this.sbtn1.setCD(2),this.curmc=new egret.MovieClip,UtilProxy.GetMovieClip("resource/image/weapon/ui_shenbing10011",this.curmc,-1,void 0),this.effect.addChild(this.curmc),this.curmc.x=100},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.sbtn0,this.onClick),this.addTouchEvent(this.sbtn1,this.onClick),this.addTouchEvent(this.fbBtn,this.onfbClick),this.addTouchEvent(this.btn_wen,this.onWenClick),this.setData(),this.refresh(),EventProxy.AddListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.sbtn0,this.onClick),this.removeTouchEvent(this.sbtn1,this.onClick),this.removeTouchEvent(this.fbBtn,this.onfbClick),this.removeTouchEvent(this.btn_wen,this.onWenClick),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind),TimerManager.ins().remove(this.showTween,this),this.effect.removeChildren()},e.prototype.onWenClick=function(t){var e=GlobalConfig.getTreasure_dataConfigById(TreasureType.ZhenBao);e&&ViewManager.ins().open(TipsTrunView,e.desc)},e.prototype.setVisible=function(t){this.visible=t,t?(this.grou.touchEnabled=!1,this.scroller.scrollPolicyH="OFF",this.listData=new Array,this.showData(),this.showRumors(),this.scroller.viewport.scrollH=0,TimerManager.ins().doTimer(10,0,this.showTween,this),this.CheckGuide(),this.isCanClick=!0):TimerManager.ins().remove(this.showTween,this)},e.prototype.showTween=function(){this.scroller.viewport.scrollH+=.5,this.scroller.viewport.scrollH>this.scroller.viewport.contentWidth-650&&this.showData()},e.prototype.S2CRepFindtreasureFind=function(t){this.setData(),this.refresh(),this.showRumors()},e.prototype.onClick=function(t){var e=this,i=0;switch(t.currentTarget){case this.sbtn0:i=1;break;case this.sbtn1:i=10}var n=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.ZhenBao),o=TreasureProxy.ins().getTreasurePayByType(TreasureType.ZhenBao,i);if(o){var s=GlobalConfig.getTreasure_dataConfigById(TreasureType.ZhenBao);if(RoleProxy.ins().getMoneyAttr(o.type)<o.pay){if(1==s.ten_must_money&&10==i)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o.type)+"不足");if(BagProxy.ins().getItemCountById(n)<i)return void TipsControl.ins().showTips(UtilProxy.ins().getMoneyAttrName(o.type)+"不足")}if(BagProxy.ins().GetBagLeftCount(BagType.BAG)<i)return void TipsControl.ins().showTips("背包格子不足！");this.isCanClick=!1,UtilProxy.GetMovieClipById(39,this.effect,!1,function(){TreasureProxy.ins().C2SReqFindtreasureFind(TreasureType.ZhenBao,i),e.isCanClick=!0})}},e.prototype.onfbClick=function(t){ViewManager.ins().open(FabaoView)},e.prototype.setData=function(){var t,e=TreasureProxy.ins().getTreasureUseItemByType(TreasureType.ZhenBao),i=BagProxy.ins().getItemCountById(e);if(e>0&&i>0)t=BagProxy.ins().getItemData(e),this.payIcon0.visible=!1,this.pay0.text="1/"+i,this.payIcon00.visible=!0,this.payIcon00.source=AssetMgr.getIconResource(t.displayid);else{var n=TreasureProxy.ins().getTreasurePayByType(TreasureType.ZhenBao,1);this.payIcon0.visible=!0,this.payIcon0.source="common_icon_yuanvao",this.pay0.text=n.pay,this.payIcon00.visible=!1}if(e>0&&i>=10)this.payIcon10.visible=!0,this.payIcon1.visible=!1,this.payIcon10.source=AssetMgr.getIconResource(t.displayid),this.pay1.text="10/"+i,this.discountG.visible=!1;else{var o=TreasureProxy.ins().getTreasurePayByType(TreasureType.ZhenBao,10);this.payIcon10.visible=!1,this.payIcon1.visible=!0,this.payIcon1.source="common_icon_yuanvao",this.pay1.text=o.pay,this.discountG.visible=!0}},e.prototype.showData=function(){var t=LimitActProxy.ins().GetServerOpenDay(),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.ZhenBao);if(e){var i=void 0;i=e.view_show_item[t]?e.view_show_item[t]:e.view_show_item[0];for(var n=0;n<i.length;++n){var o=UtilProxy.GetItemCellData(i[n],0);this.listData.push(o)}}this.list.dataProvider=new eui.ArrayCollection(this.listData)},e.prototype.refresh=function(){var t=TreasureProxy.ins().getFindCountByType(TreasureType.ZhenBao),e=GlobalConfig.getTreasure_dataConfigById(TreasureType.ZhenBao);e&&(this.times.textFlow=UtilProxy.StrFormart(e.special_tips,[10-t%10]))},e.prototype.showRumors=function(){this.list0.dataProvider=new eui.ArrayCollection(TreasureProxy.ins().getRumorsByType(TreasureType.ZhenBao)),this.list0.validateNow(),this.list0.scrollV=this.list0.contentHeight-this.list0.height},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(TreasureView_ZhenBao.prototype,"TreasureView_ZhenBao"),window.TreasureView_ZhenBao=TreasureView_ZhenBao;var TreasureView=function(t){function e(){var e=t.call(this)||this;return e.current_index=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="TreasureViewSkin",this.comview.initUI(),this.equipView.initUI(),this.lingBaoView.initUI(),this.swordView.initUI(),this.zhenBaoView.initUI(),this.sbtn_list=[this.sbtn0,this.sbtn1,this.sbtn2,this.sbtn3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.equipView.open(t),this.lingBaoView.open(t),this.swordView.open(t),this.zhenBaoView.open(t);for(var i=0;i<this.sbtn_list.length;++i){var n=(this.getTreasuretype(i+1),GlobalConfig.getTreasure_dataConfigByIndex(i+1));this.sbtn_list[i].setLabel(n.name),this.addTouchEvent(this.sbtn_list[i],this.onClick)}this.addTouchEvent(this.closeBtn,this.onCloseClick),EventProxy.AddListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind),EventProxy.AddListener(this,EventType.RefreshFindtreasureRed,this.RefreshFindtreasureRed),t&&t[0]?this.setCurrentView(t[0]):this.setCurrentView(0),this.setRed(),this.actpic.visible=LimitActProxy.ins().IsOnActRankSys(ActRankType.emLBG)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.equipView.close(t),this.lingBaoView.close(t),this.swordView.close(t),this.zhenBaoView.close(t);for(var i=0;i<this.sbtn_list.length;++i)this.removeTouchEvent(this.sbtn_list[i],this.onClick);this.removeTouchEvent(this.closeBtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRepFindtreasureFind,this.S2CRepFindtreasureFind)},e.prototype.onClick=function(t){var e=this.sbtn_list.indexOf(t.currentTarget);if(e>0){var i=2,n=4100+e;SystemOpenProxy.ins().isOpen(i,n)&&this.setCurrentView(e)}else this.setCurrentView(e)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.setCurrentView=function(t){if(this.current_index!=t){null!=this.current_view&&this.current_view.setVisible(!1);var e,i=GlobalConfig.getTreasure_dataConfigByIndex(t+1),n=i.id;switch(n){case 1:e=this.lingBaoView,this.comview.SetName(UtilProxy.getTitleName("灵宝阁"));break;case 2:e=this.swordView,TreasureProxy.ins().isInitSwordView=!1,this.comview.SetName(UtilProxy.getTitleName("藏剑谷")),EventProxy.Broast(EventType.RefreshFindtreasureRed,[]);break;case 3:e=this.equipView,this.comview.SetName(UtilProxy.getTitleName("天灵地宝"));break;case 4:e=this.zhenBaoView,this.comview.SetName("title_zhebaoge")
}this.current_view=e,this.current_view.setVisible(!0),this.current_index=t;for(var o=0;o<this.sbtn_list.length;++o)t==o?this.sbtn_list[o].icon="common_btn_big_yellow":this.sbtn_list[o].icon="common_btn_big_yellow_off"}},e.prototype.S2CRepFindtreasureFind=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRed()},e.prototype.RefreshFindtreasureRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRed()},e.prototype.setRed=function(){for(var t=0;t<this.sbtn_list.length;++t)this.sbtn_list[t].setRed(TreasureProxy.ins().getRedByType(t+1))},e.prototype.getTreasuretype=function(t){var e=GlobalConfig.getTreasure_dataConfig();for(var i in e)if(e[i].index==t)return e[i].id;return 0},e}(BaseEuiView);__reflect(TreasureView.prototype,"TreasureView"),ViewManager.ins().reg(TreasureView,LayerManager.UI_Main),window.TreasureView=TreasureView;var VenationItem=function(t){function e(){var e=t.call(this)||this;return e.id=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){void 0!=this.data&&(this.id=this.data.id,this.updateInfo())},e.prototype.updateInfo=function(){var t=GrowupProxy.ins().getVenationlv(this.id);if(t>0){var e=GlobalConfig.getVenation(this.id)[t];this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[e.name_color,e.name]),this.bg.source="jingmai_btn_bg",this.icon.source="jingmai_btn_0"+this.id}else{var e=GlobalConfig.getVenation(this.id)[1];this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[3,e.name]),this.bg.source="jingmai_btn_bg_hui",this.icon.source="jingmai_btn_hui_0"+this.id}this.red.visible=VenationProxy.ins().getRedByID(this.id)},e.prototype.select=function(t){this.sp_select.visible=t},e}(BaseItemRender);__reflect(VenationItem.prototype,"VenationItem"),window.VenationItem=VenationItem;var VenationView=function(t){function e(){var e=t.call(this)||this;return e.cur_id=1,e.pro_name=["baoji_rate","shanbi_pre","mingzhong_pre","kang_baoji_rate","hurt_add_pre","hurt_sub_pre","gedang_rate","poji_rate"],e.skinName="VenationSkin",e.list.itemRenderer=VenationItem,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_jingmai"),this.page_list=[];for(var e=0;e<this.mian_list.numChildren;e++){var i=this.mian_list.getChildAt(e),n={root:i,id:e,bg:void 0,line_list:[],point_list:[]};n.bg=i.getChildAt(0),n.bg.source="jingmai_jianying_0"+(e+1);for(var o=1;10>o;o++)n.line_list.push(i.getChildAt(o));for(var s=11;21>s;s++)n.point_list.push(i.getChildAt(s));this.page_list.push(n)}this.tips_title.textFlow=UtilProxy.StrFormart("C:10&奇经八脉",[]),this.movie_list=[];for(var e=0;10>e;e++){var r=new MovieClip;this.mian_list.addChildAt(r,-1),this.movie_list.push(r)}},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),this.addTouchEvent(this.btn_tips,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.tip_btn_close,this.onClick),this.addTouchEvent(this.btn_close,this.onCloseClick),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.AddListener(this,EventType.S2CRepGrowupVenationUpgrade,this.onLvUpdate),EventProxy.AddListener(this,EventType.UpdataMoney,this.onUpdateMoney),this.openMenu(1),this.updateInfo(),this.list.validateNow();var n=this.list.$children[0];n.select(!0),this.list.selectedIndex=0,this.txt_fight.text=this.getFightNum().toString()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.btn_tips,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick),this.removeTouchEvent(this.tip_btn_close,this.onClick),this.removeTouchEvent(this.btn_close,this.onCloseClick),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.RemoveListener(this,EventType.S2CRepGrowupVenationUpgrade,this.onLvUpdate),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.onUpdateMoney),EventProxy.Broast(EventType.VenationRedUpdate,[])},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_lvup:if(this.next_data){var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);if(e<this.next_data.need_zhuan)return void TipsControl.ins().showTips("转数不足");var i=RoleProxy.ins().getRoleLv();if(i<this.next_data.need_level)return void TipsControl.ins().showTips("等级不足");for(var n=0;n<this.next_data.currencys.length;n++){var o=this.next_data.currencys[n][0],s=this.next_data.currencys[n][1];if(RoleProxy.ins().getMoneyAttr(o)<s)return void TipsControl.ins().showTips("金币不足")}GrowupProxy.ins().C2SReqGrowupVenationUpgrade(this.cur_id)}else TipsControl.ins().showTips("已满级");break;case this.btn_tips:this.panel_tips.visible=!0,this.updateTips();break;case this.tip_btn_close:this.panel_tips.visible=!1}},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;if(void 0!=e){var i=this.list.$children[this.cur_id-1];i&&i.select(!1),e.select(!0),this.openMenu(t.itemIndex+1)}},e.prototype.updateInfo=function(){for(var t=new eui.ArrayCollection,e=1;9>e;e++)t.addItem({id:e,page:this.cur_id});this.list.dataProvider=t},e.prototype.openMenu=function(t){this.page_list[this.cur_id-1].root.visible=!1,this.cur_id=t,this.page_list[t-1].root.visible||(this.page_list[t-1].root.visible=!0);var e=GrowupProxy.ins().getVenationlv(t);this.cur_lv=e;var i=e%10;if(this.cur_data=GlobalConfig.getVenation(t)[e],this.next_data=GlobalConfig.getVenation(t)[e+1],this.go_show.visible=void 0!=this.next_data,e>0){var n=RoleProxy.ins().getRoleLv();if(this.next_data){var o=n>=this.next_data.level?7:4;this.txt_lv.textFlow=UtilProxy.StrFormart("需求等级：|C:@0 &@1 ",[o,this.next_data.need_level]);var s=RoleProxy.ins().getMoneyAttr(this.next_data.currencys[0][0]),r=this.next_data.currencys[0][1],a=s>=r?7:4;this.txt_coin.textFlow=UtilProxy.StrFormart("需要金币：|C:@0 &@1 ",[a,r]),this.btn_lvup.visible=!0,this.txt_zhuan.text=""}else this.txt_lv.text="",this.txt_coin.text="",this.txt_zhuan.text="已满级",this.btn_lvup.visible=!1}else{this.txt_lv.text="",this.txt_coin.text="";var h=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),l=h>=this.next_data.need_zhuan?7:4,p=GlobalConfig.getZhuanById(this.next_data.need_zhuan);this.txt_zhuan.textFlow=UtilProxy.StrFormart("C:@0 &@1 转@2 重开启",[l,p.zhuan,p.lv]),this.btn_lvup.visible=h>=this.next_data.need_zhuan?!0:!1}if(this.next_data){var c=i+1,u=this.page_list[t-1].point_list[i];this.go_show.x=59,this.go_show.y=93,this.go_show.x+=u.x+10,this.go_show.y+=u.y+10,this.show_lv.textFlow=UtilProxy.StrFormart("C:10&@0 重",[c]),this.show_pro1.textFlow=UtilProxy.StrFormart("C:7&生命：+@0 ",[this.next_data.hp]),this.show_pro2.textFlow=UtilProxy.StrFormart("C:7&攻击：+@0 ",[this.next_data.attack])}var d=this.page_list[t-1];if(d){for(var g=0;g<d.point_list.length;g++){var y=this.movie_list[g];i>g||!this.next_data?(y.visible=!0,y.x=59+d.point_list[g].x+7,y.y=67+d.point_list[g].y+7,y.playFile(UI_EFF_DIR+this.cur_data.ui_eff,-1)):y.visible=!1}for(var g=0;g<d.line_list.length;g++)d.line_list[g].source=i-1>g||!this.next_data?"jingmai_lianjiexian_on":"jingmai_lianjiexian";for(var g=0;g<d.point_list.length;g++)d.point_list[g].source="jingmai_yuandian_01";d.point_list[i].source="jingmai_yuandian_02"}},e.prototype.onLvUpdate=function(t){var e,i=this,n=200,o=t%10;0==o?(n=1e3,this.page_list[this.cur_id-1].line_list[8].source="jingmai_lianjiexian_on",e=this.page_list[this.cur_id-1].point_list[9]):e=this.page_list[this.cur_id-1].point_list[o-1];var s=new MovieClip;this.mian_list.addChild(s),s.x=59+e.x+7,s.y=67+e.y+7,s.playFile(UI_EFF_DIR+"10008"),TimerManager.ins().doTimer(n,1,function(){i.openMenu(i.cur_id),i.updateInfo()},this),this.txt_fight.text=this.getFightNum().toString()},e.prototype.onUpdateMoney=function(t){t==MoneyAttr.COIN&&this.updateInfo()},e.prototype.updateTips=function(){var t=Math.floor((this.cur_lv-1)/10);t=0>t?0:t;var e=t+1,i=void 0!=GlobalConfig.getVenation(this.cur_id)[this.cur_lv+1],n=this.pro_name[this.cur_id-1];if(t>0){var o=GlobalConfig.getVenation(this.cur_id)[10*t+1];if(o){this.tips_cur_title.textFlow=UtilProxy.StrFormart("C:10&当前阶段：|C:@0 &@1 |C:7&(已激活)",[o.name_color,o.name]);var s=o[n]||0;this.tips_cur_value.text=UtilProxy.getStr("@0 ：+@1 %",[RoleProxy.keyName[n],s/100])}else this.tips_cur_title.text="",this.tips_cur_value.text=""}else this.tips_cur_title.textFlow=UtilProxy.StrFormart("C:10&当前阶段：|C:4&(未激活)",[]),this.tips_cur_value.text="";if(i){var r=GlobalConfig.getVenation(this.cur_id)[10*e+1];if(r){var a=this.cur_lv-10*(e-1),s=r[n]||0;this.tips_next_title.textFlow=UtilProxy.StrFormart("C:10&下一阶段：|C:@0 &@1 |C:4&(@2 /10)",[r.name_color,r.name,a]),this.tips_next_value.text=UtilProxy.getStr("@0 ：+@1 %",[RoleProxy.keyName[n],s/100])}else this.tips_next_title.text="",this.tips_next_value.text=""}else this.tips_next_title.textFlow=UtilProxy.StrFormart("C:10&下一阶段：已满级",[]),this.tips_next_value.text=""},e.prototype.getFightNum=function(){return VenationProxy.ins().getFightNum()},e}(BaseEuiView);__reflect(VenationView.prototype,"VenationView"),ViewManager.ins().reg(VenationView,LayerManager.UI_Main),window.VenationView=VenationView;var VIPView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="VIPViewSkin",this.list.itemRenderer=ItemCell,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.info0.textFlow=UtilProxy.generateTextFlow("C:7&U&查看所有特权"),this.Btn0.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addTouchEvent(this.info0,this.ShowPrivige),this.addTouchEvent(this.Btn0,this.onClick),this.addTouchEvent(this.Btn1,this.onClick),this.addTouchEvent(this.ArrowR,this.onArrowClick),this.addTouchEvent(this.ArrowL,this.onArrowClick),this.addTouchEvent(this.closeBtn,this.onCloseClick),this.addTouchEvent(this.closebtn1,this.onCloseTipsClick),EventProxy.AddListener(this,EventType.S2CRepVipGetFreeGift,this.S2CRepVipGetFreeGift),EventProxy.AddListener(this,EventType.S2CRepVipGetDiscountGift,this.S2CRepVipGetDiscountGift),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney),this.tipsgroup.visible=!1,this.refreshData(),t[0]){var i=t[0];this.setVipLevel(Math.max(i,1))}else{var n=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);this.setVipLevel(Math.max(n,1))}VIPProxy.ins().isOpenedView||(VIPProxy.ins().isOpenedView=!0,EventProxy.Broast(EventType.RefreshVipRed,[]))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.info0,this.ShowPrivige),this.removeTouchEvent(this.Btn0,this.onClick),this.removeTouchEvent(this.Btn1,this.onClick),this.removeTouchEvent(this.closeBtn,this.onCloseClick),this.removeTouchEvent(this.ArrowR,this.onArrowClick),this.removeTouchEvent(this.ArrowL,this.onArrowClick),this.removeTouchEvent(this.closebtn1,this.onCloseTipsClick),EventProxy.RemoveListener(this,EventType.S2CRepVipGetFreeGift,this.S2CRepVipGetFreeGift),EventProxy.RemoveListener(this,EventType.S2CRepVipGetDiscountGift,this.S2CRepVipGetDiscountGift),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney),void 0!=this.mc&&this.effG.removeChild(this.mc),this.mc=void 0},e.prototype.S2CRepVipGetFreeGift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=VIPProxy.ins().GetFirstFreeGift();this.setVipLevel(n>0?n:i)},e.prototype.S2CRepVipGetDiscountGift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.setVipLevel(i)},e.prototype.UpdataMoney=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];(i==MoneyAttr.VIP_EXP||i==MoneyAttr.VIP_LEVEL)&&this.refreshData()},e.prototype.ShowPrivige=function(t){this.setPriviage()},e.prototype.onClick=function(t){var e=this;switch(t.currentTarget){case this.Btn0:NoticeProxy.ins().OpenRecharge();break;case this.Btn1:if(VIPProxy.ins().isGetFreeGift(this.current_vip))if(VIPProxy.ins().isGetDiscountGift(this.current_vip))TipsControl.ins().showTips("已领取");else{var i=GlobalConfig.getVip_levelConfig(this.current_vip);i?i.discount_yuanbao<=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)?TipsControl.ins().ShowTips1("是否花费"+i.discount_yuanbao+UtilProxy.ins().getMoneyAttrName(MoneyAttr.YUANBAO)+"购买特惠礼包 ？",function(){},function(){VIPProxy.ins().C2SReqVipGetDiscountGift(e.current_vip)}):TipsControl.ins().showTips("元宝不足！"):CommonUtils.log("----vip_level json not finded,level-->",this.current_vip)}else{var n=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);Number(n)>=this.current_vip?VIPProxy.ins().C2SReqVipGetFreeGift(this.current_vip):TipsControl.ins().showTips("VIP等级不足！")}}},e.prototype.onArrowClick=function(t){switch(t.currentTarget){case this.ArrowR:this.current_vip<VIPProxy.ins().getMaxLevel()&&this.setVipLevel(this.current_vip+1);break;case this.ArrowL:this.current_vip>1&&this.setVipLevel(this.current_vip-1)}},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onCloseTipsClick=function(t){this.tipsgroup.visible=!1},e.prototype.setPriviage=function(){var t=GlobalConfig.getVip_levelConfig(this.current_vip);if(t){for(var e="",i=0;i<t.priority.length;++i)0==i?e=t.priority[i]:e+="|\n"+t.priority[i];this.tipsgroup.visible=!0,this.title1.text="特权",this.desc0.textFlow=UtilProxy.generateTextFlow(e)}},e.prototype.setVipLevel=function(t){var e=GlobalConfig.getVip_levelConfig(t);if(e){this.current_vip=t;var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);t>18?this.info.text="SVIP"+(t-18)+"尊享特权：":this.info.text="VIP"+t+"尊享特权：",this.des0.textFlow=UtilProxy.generateTextFlow(e.priority[0]||""),this.des1.textFlow=UtilProxy.generateTextFlow(e.priority[1]||"");var n=VIPProxy.ins().isGetFreeGift(t),o=VIPProxy.ins().isGetDiscountGift(t);this.fightG.visible=e.add_fight>0,this.fightValue.text=e.add_fight.toString(),this.priImg.source="resource/skins/Vip/"+e.show_privilege_pic+".png";var s=new Array;if(n){var r=GlobalConfig.getDropConfig(e.discount_reward),a=GlobalConfig.getDropItem(r.drop);if(void 0!=a)for(var h=0;h<a.length;h++){var l=a[h],p=new ItemCellData,c={item_slot_idx:0,item_type_id:l[0].id,item_count:l[0].num};p.setItemCellData(c),s.push(p)}}else for(var h=0;h<e.show_icon.length;h++){var l=e.show_icon[h],p=UtilProxy.GetItemCellData(l[0],l[1]);s.push(p)}this.list.dataProvider=new eui.ArrayCollection(s),this.Btn1.visible=!n||!o,this.finish.visible=n&&o,this.Btn1.setRed(!n&&this.current_vip<=i),this.buy_info.text=n&&!o?"购买需要"+e.discount_yuanbao+"元宝":"",this.Btn1.label=n?"购 买":"领取奖励",this.Btn1.visible=this.current_vip<=i,this.font_icon.source=e.show_pic;var u=UtilProxy.shield?e.show_image_shenke:e.show_image;if(u.length>1){var d=RoleProxy.ins().getProf();if(u[d-1])if(u[d-1][3]&&1==u[d-1][3])this.showImg.visible=!0,this.effG.visible=!1,this.showImg.source=u[d-1][0];else{this.showImg.visible=!1,this.effG.visible=!0;var g=UtilProxy.getShowImgPath()+u[d-1][0];void 0!=this.mc&&this.effG.removeChild(this.mc),this.mc=new egret.MovieClip,UtilProxy.GetMovieClip(g,this.mc,-1,void 0),this.effG.addChildAt(this.mc,1),this.mc.x=u[d-1][1],this.mc.y=u[d-1][2]}}else if(u[0])if(u[0][3]&&1==u[0][3])this.showImg.visible=!0,this.effG.visible=!1,this.showImg.source=u[0][0];else{this.showImg.visible=!1,this.effG.visible=!0;var g=UtilProxy.getShowImgPath()+u[0][0];void 0!=this.mc&&this.effG.removeChild(this.mc),this.mc=new egret.MovieClip,UtilProxy.GetMovieClip(g,this.mc,-1,void 0),this.effG.addChildAt(this.mc,1),this.mc.x=u[0][1],this.mc.y=u[0][2]}this.setRed()}},e.prototype.refreshData=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_EXP);RoleProxy.ins().getProf();t>18?(this.vipLvl.text=(t-18).toString(),this.vip.source="main_icon_vip_02"):(this.vipLvl.text=t.toString(),this.vip.source="main_icon_vip");var i=Number(t)+1,n=GlobalConfig.getVip_levelConfig(i);n?(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?this.needInfo.text="":t+1>18?this.needInfo.textFlow=UtilProxy.generateTextFlow("再充值|C:7&"+(n.need_yuanbao-e)+"元宝|升级|C:7&SVIP"+(t+1-18)):this.needInfo.textFlow=UtilProxy.generateTextFlow("再充值|C:7&"+(n.need_yuanbao-e)+"元宝|升级|C:7&VIP"+(t+1)):(n=GlobalConfig.getVip_levelConfig(Number(t)),this.needInfo.text=""),this.levelBar.maximum=n.need_yuanbao,this.levelBar.value=Number(e)},e.prototype.setRed=function(){this.leftRed.visible=VIPProxy.ins().isLastFreeGift(this.current_vip),this.rightRed.visible=VIPProxy.ins().isNextFreeGift(this.current_vip)},e}(BaseEuiView);__reflect(VIPView.prototype,"VIPView"),ViewManager.ins().reg(VIPView,LayerManager.UI_Main),window.VIPView=VIPView;var WeaponView=function(t){function e(){var e=t.call(this)||this;return e.first_id=1,e.id=0,e.dir_list=[UI_WEAPON_DIR,UI_XUANBING_DIR,UI_WING_DIR],e.title_list=["title_shenbing","title_xuanbing","title_shenyi"],e.book_name=["神兵谱","玄兵阁","神翼录"],e.bg_img=["resource/skins/weapon/tex/shenbing_bg.jpg","resource/skins/weapon/tex/xuanbing_bg.jpg","resource/skins/weapon/tex/shenyi_bg.jpg"],e.lvUpType=[LvUpType.emSB,LvUpType.emXB,LvUpType.emWing],e.end_time=0,e.skinName="WeaponSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.title_cur.textFlow=UtilProxy.StrFormart("C:10& 当前属性",[]),this.title_next.textFlow=UtilProxy.StrFormart("C:10& 下阶属性",[]),this.txt_path.textFlow=UtilProxy.StrFormart("C:7&<u>获得途径</u>",[]),this.list.itemRenderer=WpItem,this.menu_list.itemRenderer=WpBookMenuItem,this.red_sj=this.btn_lvup.getChildAt(2),this.red_sq=this.btn_sq.getChildAt(2),this.red_dan=this.btn_dan.getChildAt(0).getChildAt(5),this.red_book=this.btn_book.getChildAt(0).getChildAt(5)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),this.addTouchEvent(this.btn_dress,this.onClick),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.btn_book,this.onClick),this.addTouchEvent(this.btn_dan,this.onClick),this.addTouchEvent(this.txt_path,this.onClick),this.addTouchEvent(this.btn_sq,this.onClick),this.addItemTapEvent(this.menu_list,this.onListMenuTap),this.addItemTapEvent(this.list,this.onListItemTap),this.addTouchEvent(this.lvItem,this.onLvUpClick),EventProxy.AddListener(this,EventType.S2CRepWeaponSingleUpgrade,this.onStarLvup),EventProxy.AddListener(this,EventType.S2CRepWeaponChangeHuaxing,this.onDressUpdate),EventProxy.AddListener(this,EventType.S2CRepWeaponSwallow,this.onSwallowUpdate),EventProxy.AddListener(this,EventType.S2CRepWeaponBookUpgrade,this.onBookUpdate),EventProxy.AddListener(this,EventType.S2CRepWeaponSingleUpgradeExtend,this.onLvupUpdate),this.page=0,e&&e.length>0&&(this.page=e[0]+1),this.page=Math.floor(this.page),this.page=this.getClientId(this.page),this.bg.source=this.bg_img[this.page-1],this.dress_id=WeaponProxy.ins().getDressId(this.page),this.btn_book.label=this.book_name[this.page-1],this.btn_dress.visible=this.page!=WeaponType.XuanBing;var n=this.title_list[this.page-1];this.comview.SetName(n),this.red_book.visible=WeaponProxy.ins().getBookRedByType(this.page),this.updateItemList(),this.openMenu(this.page),this.list.selectedIndex=0,this.CheckGuide()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),TimerManager.ins().remove(this.onLimitTimer,this),this.removeTouchEvent(this.btn_dress,this.onClick),this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick),this.removeTouchEvent(this.btn_book,this.onClick),this.removeTouchEvent(this.btn_dan,this.onClick),this.removeTouchEvent(this.txt_path,this.onClick),this.removeTouchEvent(this.btn_sq,this.onClick),this.removeItemTapEvent(this.menu_list,this.onListMenuTap),this.removeItemTapEvent(this.list,this.onListItemTap),this.removeTouchEvent(this.lvItem,this.onLvUpClick),EventProxy.RemoveListener(this,EventType.S2CRepWeaponSingleUpgrade,this.onStarLvup),EventProxy.RemoveListener(this,EventType.S2CRepWeaponChangeHuaxing,this.onDressUpdate),EventProxy.RemoveListener(this,EventType.S2CRepWeaponSwallow,this.onSwallowUpdate),EventProxy.RemoveListener(this,EventType.S2CRepWeaponBookUpgrade,this.onBookUpdate),EventProxy.RemoveListener(this,EventType.S2CRepWeaponSingleUpgradeExtend,this.onLvupUpdate),this.cur_item=void 0,this.cur_menu=void 0,this.movie&&(this.movie.clear(),this.gp_main.removeChild(this.movie))},e.prototype.getClientId=function(t){return 1==t?3:2==t?1:2},e.prototype.onLvUpClick=function(t){ViewManager.ins().open(ItemTipsView,this.lvItem.data,!0,[this.lvUpType[this.page-1],this.id])},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_dress:WeaponProxy.ins().C2SReqWeaponChangeHuaxing(this.page,this.id);break;case this.btn_book:ViewManager.ins().open(WpBookView,[this.page,1]);break;case this.btn_dan:ViewManager.ins().open(WpSwallowView,this.page,this.id);break;case this.btn_lvup:if(this.next_data){var i=BagProxy.ins().getItemCountById(this.next_data.item[0]),n=this.next_data.item[1];if(n>i)return void TipsControl.ins().ShowPathTips(this.next_data.item[0])}WeaponProxy.ins().C2SReqWeaponSingleUpgradeExtend(this.page,this.id);break;case this.btn_sq:ViewManager.ins().open(WpLvupView,[this.page,this.id||1]);break;case this.txt_path:this.cur_data&&this.cur_data.item&&this.cur_data.item.length>0&&TipsControl.ins().ShowPathTips(this.cur_data.item[0])}},e.prototype.onListMenuTap=function(t){var e=t.itemRenderer;void 0!=e&&this.cur_menu!=e&&(this.cur_menu?this.menu_array.itemUpdated(this.cur_menu.data):this.menu_array.itemUpdated(this.menu_array.source[0]),this.cur_menu=e,this.menu_array.itemUpdated(this.cur_menu.data),this.menu_id=e.data.info.id,this.updateItemList())},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;void 0!=e&&this.cur_item!=e&&(this.cur_item?this.item_array.itemUpdated(this.cur_item.data):this.item_array.itemUpdated(this.item_array.source[0]),this.cur_item=e,this.item_array.itemUpdated(this.cur_item.data),this.openMenu(e.data.info.id))},e.prototype.updateItemList=function(){var t=WeaponProxy.ins().getResList(this.page),e=[];for(var i in t)if(0==t[i].is_limit){var n=t[i].id,o={};o.sort=4;var s=WeaponProxy.ins().getSjRedById(this.page,n),r=WeaponProxy.ins().getSqRedById(this.page,n),a=WeaponProxy.ins().getLv2(this.page,n),h=WeaponProxy.ins().getLv(this.page,n);r&&h>0&&(o.sort=3),n==WeaponProxy.ins().getDressId(this.page)&&(o.sort=2),s&&a>0&&(o.sort=1),s&&0==a&&(o.sort=0),o.id=t[i].id,o.info=t[i],o.type=this.page,o.ui_type=this.page,e.push(o)}for(var l=WeaponProxy.ins().getlimitlist(this.page),p=0;p<l.length;p++){var c=l[p],o={};o.sort=4,o.id=c.id,o.info=WeaponProxy.ins().getResById(this.page,c.id),o.type=this.page,o.ui_type=this.page,e.push(o)}e.sort(function(t,e){return t.sort!=e.sort?t.sort-e.sort:t.id-e.id}),this.item_array||(this.item_array=new eui.ArrayCollection,this.list.dataProvider=this.item_array),this.item_array.replaceAll(e)},e.prototype.onLimitTimer=function(){var t=this.end_time-GameLogic.ins().getServerTime();if(0>=t)TimerManager.ins().remove(this.onLimitTimer,this),this.updateItemList(),this.openMenu(1);else{var e=DateUtils.getFormatBySecond(t);this.txt_cdn.textFlow=UtilProxy.StrFormart("C:7&@0 后过期",[e])}},e.prototype.openMenu=function(t){this.id=t;var e=WeaponProxy.ins().getResById(this.page,t);if(e){var i=WeaponProxy.ins().getLv2(this.page,t);this.cur_lv=i;var n=WeaponProxy.ins().getGrowUpByIdAndLv(this.page,t,i);this.cur_data=n;var o=WeaponProxy.ins().getGrowUpByIdAndLv(this.page,t,i+1);this.next_data=o,this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[e.quality-1],e.name]),this.txt_lv.text=i+"阶";var s=WeaponProxy.ins().getMiscByTypeId(this.page);this.txt_di.textFlow=UtilProxy.StrFormart("C:7&@0 ",[s.remark]);var r=WeaponProxy.ins().getLv(this.page,t),a=WeaponProxy.ins().getBaseById(this.page,t,r);WeaponProxy.ins().getBaseById(this.page,t,r+1);if(this.title_cur.textFlow=i>0?UtilProxy.StrFormart("C:10&激活属性",[]):UtilProxy.StrFormart("C:10& 当前属性",[]),this.updateProInfo(t),this.txt_fight.text=(UtilProxy.GetAttrFight(n)+UtilProxy.GetAttrFight(a)).toString(),this.movie||(this.movie=new MovieClip,this.gp_main.addChildAt(this.movie,3)),this.page==WeaponType.Weapon?(this.movie.x=312,this.movie.y=380):this.page==WeaponType.XuanBing?(this.movie.x=240,this.movie.y=400):this.page==WeaponType.Wing&&(this.movie.x=240,this.movie.y=480),this.movie.setFrameRate(this.dir_list[this.page-1]+e.ui_model,6),this.movie.playFile(this.dir_list[this.page-1]+e.ui_model,-1),TimerManager.ins().remove(this.onLimitTimer,this),this.end_time=0,1==e.is_limit){this.btn_lvup.visible=!1,this.lvItem.visible=!1,this.btn_sq.visible=!1,this.btn_dan.visible=!1,this.txt_path.text="",this.txt_remark.text="";var h=WeaponProxy.ins().getlimitById(this.page,t);return h&&(this.end_time=h.end_time),TimerManager.ins().doTimerDelay(0,1e3,0,this.onLimitTimer,this),void(this.btn_dress.visible=WeaponProxy.ins().getDressId(this.page)!=this.id&&this.page!=WeaponType.XuanBing)}if(0>=i)this.btn_dan.label="0/0",this.btn_dress.visible=!1,BagProxy.ins().getItemCountById(o.item[0])>=o.item[1]?(this.txt_remark.text="",this.btn_lvup.visible=!0,this.btn_lvup.label="激活"):(this.txt_remark.textFlow=UtilProxy.StrFormart("C:7&来源：@0 ",[e.path]),this.btn_lvup.visible=!1),this.btn_sq.visible=!1,this.txt_cdn.text="",this.btn_dan.visible=!1,this.txt_path.visible=!1;else{this.btn_dan.visible=this.txt_path.visible=!0;var l=WeaponProxy.ins().getLv(this.page,t),p=WeaponProxy.ins().getSwallowById(this.page,this.id,l);if(p){var c=WeaponProxy.ins().getSwallowNum(this.page,this.id),u=p.max_swallow[1];if(this.btn_dan.label=UtilProxy.getStr("@0 /@1 ",[c,u]),this.btn_dress.visible=WeaponProxy.ins().getDressId(this.page)!=this.id&&this.page!=WeaponType.XuanBing,o){this.txt_remark.text="",this.btn_lvup.label="进阶",this.btn_lvup.visible=!0;var d=BagProxy.ins().getItemCountById(o.item[0]),g=o.item[1],y=d>=g?7:4,f=BagProxy.ins().getItemName(o.item[0]);this.txt_cdn.textFlow=UtilProxy.StrFormart("需要：|C:@0 &@1 x@2 ",[y,f,o.item[1]])}else this.txt_remark.textFlow=UtilProxy.StrFormart("C:7&已满级",[]),this.txt_cdn.text="",this.btn_lvup.visible=!1;this.btn_sq.visible=!0}}this.btn_lvup.visible&&(this.red_sj.visible=WeaponProxy.ins().getSjRedById(this.page,this.id)),this.btn_sq.visible&&(this.red_sq.visible=WeaponProxy.ins().getSqRedById(this.page,this.id)),this.btn_dan.visible&&(this.red_dan.visible=WeaponProxy.ins().getRedBySid(this.page,this.id));var _=BagProxy.ins().GetLVUpItem(this.lvUpType[this.page-1],i);this.lvItem.visible=void 0!=_,void 0!=_&&(this.lvItem.data=_)}},e.prototype.onStarLvup=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.updateItemList(),this.openMenu(this.id),this.btn_lvup.visible&&(this.red_sj.visible=WeaponProxy.ins().getSjRedById(this.page,this.id)),this.btn_sq.visible&&(this.red_sq.visible=WeaponProxy.ins().getSqRedById(this.page,this.id))},e.prototype.onLvupUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=UtilProxy.GetMovieClipById(20,this.eff);i.x=240,i.y=400,this.updateItemList(),this.openMenu(this.id),this.btn_lvup.visible&&(this.red_sj.visible=WeaponProxy.ins().getSjRedById(this.page,this.id)),this.btn_sq.visible&&(this.red_sq.visible=WeaponProxy.ins().getSqRedById(this.page,this.id))},e.prototype.onSwallowUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=WeaponProxy.ins().getLv2(this.page,this.id),n=WeaponProxy.ins().getSwallowById(this.page,this.id,i);if(!n)return void TipsControl.ins().showTips("找不到配置:"+this.page+" "+this.id+" "+i);var o=WeaponProxy.ins().getSwallowNum(this.page,this.id),s=n.max_swallow[1];this.btn_dan.label=UtilProxy.getStr("@0 /@1 ",[o,s]),this.btn_dan.visible&&(this.red_dan.visible=WeaponProxy.ins().getRedBySid(this.page,this.id))},e.prototype.onDressUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.btn_dress.visible=!1,this.updateItemList(),this.page!=WeaponType.XuanBing},e.prototype.onBookUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.red_book.visible=WeaponProxy.ins().getBookRedByType(this.page)},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e.prototype.updateProInfo=function(t){var e=WeaponProxy.ins().getLv2(this.page,t)||1,i=WeaponProxy.ins().getGrowUpByIdAndLv(this.page,t,e),n=WeaponProxy.ins().getGrowUpByIdAndLv(this.page,t,e+1),o=WeaponProxy.ins().getLv(this.page,t)||1,s=WeaponProxy.ins().getBaseById(this.page,t,o),r=(WeaponProxy.ins().getBaseById(this.page,t,o+1),RoleProxy.ins().getTableAdd(i,s)),a=RoleProxy.ins().getTableAdd(n,s);n||(a=void 0);for(var h=AttrProxy.getContAttrInfo(r,a),l="",p="",c=0;c<h.length;c++)c>0&&(l+="\r\n",p+="\r\n"),l+=h[c][0]+"："+h[c][1],p+="|C:7&"+h[c][0]+"："+(0==h[c][2]?"已满级":h[c][2]);this.txt_cur.text=l,this.txt_next.textFlow=UtilProxy.StrFormart(p,[])},e}(BaseEuiView);__reflect(WeaponView.prototype,"WeaponView");var WeaponUIType;!function(t){t[t.wp=1]="wp",t[t.xb=2]="xb",t[t.wing=3]="wing",t[t.lvup=4]="lvup",t[t.book=5]="book"}(WeaponUIType||(WeaponUIType={})),ViewManager.ins().reg(WeaponView,LayerManager.UI_Main),window.WeaponView=WeaponView;var WpBookMenuItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.info){this.select.visible=this.selected;var t=this.data.info,e=this.data.type,i=this.data.ui_type;this.txt_name.text=t.name,this.sp.source="common_qianzhui_01",i==WeaponUIType.book?this.red.visible=WeaponProxy.ins().getRedByBookId(e,t.id):this.red.visible=WeaponProxy.ins().getRedByMenuId(e,t.id)}},e.prototype.refresh=function(t){this.select.visible=t},e}(BaseItemRender);__reflect(WpBookMenuItem.prototype,"WpBookMenuItem"),window.WpBookMenuItem=WpBookMenuItem;var WpBookProItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){void 0!=this.data&&(this.txt.textFlow=UtilProxy.StrFormart("@0  +@1 ",[this.data.name,this.data.val]))},e}(BaseItemRender);__reflect(WpBookProItem.prototype,"WpBookProItem"),window.WpBookProItem=WpBookProItem;var WpBookView=function(t){function e(){var e=t.call(this)||this;return e.wp_pos3=[{x:123,y:0},{x:240,y:176},{x:11,y:176}],e.wp_pos4=[{x:6,y:32},{x:240,y:32},{x:240,y:184},{x:6,y:184}],e.skinName="WpBookSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.menu_list.itemRenderer=WpBookMenuItem,this.pro_list.itemRenderer=WpBookProItem,this.star_list=[];for(var e=0;e<this.star_go.numChildren;e++)this.star_list.push(this.star_go.getChildAt(e));this.wp_list=[];for(var e=0;e<this.wp_go.numChildren;e++)this.wp_list.push(this.wp_go.getChildAt(e));this.page_list=[],this.page_select_list=[],this.page_red=[];for(var e=0;e<this.page_go.numChildren;e++){this.page_list.push(this.page_go.getChildAt(e));var i=this.page_go.getChildAt(e).getChildAt(0).getChildAt(4);this.page_select_list.push(i);var n=this.page_go.getChildAt(e).getChildAt(0).getChildAt(4);this.page_red.push(n)}this.red_lvup=this.btn_lvup.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.page=e[0][0],this.id=e[0][1],this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick);for(var n=0;n<this.page_list.length;n++)this.addTouchEvent(this.page_list[n],this.onClick);this.menu_list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.AddListener(this,EventType.S2CRepWeaponBookUpgrade,this.onLvupUpdate);
for(var n=0;n<this.page_select_list.length;n++)this.page_select_list[n].visible=!1;this.page_select_list[this.page-1].visible=!0,this.updateList(),this.openMenu(this.id),this.menu_list.selectedIndex=this.id-1,this.txt_title.textFlow=UtilProxy.StrFormart("C:10&@0 ",[this.menu_array.source[0].info.name]);for(var n=0;n<this.page_red.length;n++)this.page_red[n].visible=WeaponProxy.ins().getBookRedByType(n+1);this.red_lvup.visible=WeaponProxy.ins().getRedByBookId(this.page,this.id)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick);for(var i=0;i<this.page_list.length;i++)this.removeTouchEvent(this.page_list[i],this.onClick);this.menu_list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),EventProxy.RemoveListener(this,EventType.S2CRepWeaponBookUpgrade,this.onLvupUpdate),this.cur_menu=null},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_lvup:if(!this.next_data)return void TipsControl.ins().showTips("C:4&已满级!");if(!this.equip_flag)return void TipsControl.ins().showTips("C:4&等级不足");if(!this.item_flag)return void TipsControl.ins().showTips("C:4&道具不足");WeaponProxy.ins().C2SReqWeaponBookUpgrade(this.page,this.id);break;default:this.cur_menu=null,this.page_select_list[this.page-1].visible=!1;var i=this.page_list.indexOf(t.currentTarget);this.page=i+1,this.page_select_list[this.page-1].visible=!0,this.updateList(),this.openMenu(1),this.menu_list.selectedIndex=0,this.menu_array.itemUpdated(this.menu_array.source[0]),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&@0 ",[this.menu_array.source[0].info.name])}},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;void 0!=e&&this.cur_menu!=e&&(this.cur_menu?this.menu_array.itemUpdated(this.cur_menu.data):this.menu_array.itemUpdated(this.menu_array.source[0]),this.cur_menu=e,this.menu_array.itemUpdated(this.cur_menu.data),this.openMenu(e.data.info.id),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&@0 ",[this.cur_menu.data.info.name]))},e.prototype.updateList=function(){var t=WeaponProxy.ins().getTypeList(this.page);this.menu_array||(this.menu_array=new eui.ArrayCollection,this.menu_list.dataProvider=this.menu_array),this.menu_array.removeAll();for(var e in t)if("0"!=e){var i={};i.info=t[e],i.type=this.page,i.ui_type=WeaponUIType.book,this.menu_array.addItem(i)}},e.prototype.openMenu=function(t){this.id=t;var e=WeaponProxy.ins().getBookLv(this.page,t),i=WeaponProxy.ins().getTypeConfigById(this.page,t),n=WeaponProxy.ins().getBookById(this.page,t,e),o=WeaponProxy.ins().getBookById(this.page,t,e+1),s=!1;o||(s=!0,o=n),this.is_top=s,this.next_data=o;for(var r=0;r<this.star_list.length;r++)this.star_list[r].source=e>r?"shengxing_icon_01_05":"shengxing_icon_01_01";var a=this.wp_pos3;o.book_list.length>3&&(a=this.wp_pos4);for(var r=0;r<this.wp_list.length;r++)this.wp_list[r].visible=r<a.length;for(var r=0;r<a.length;r++){this.wp_list[r].x=a[r].x,this.wp_list[r].y=a[r].y;var h=WeaponProxy.ins().getResById(this.page,t);this.wp_list[r].data=(m={},m.info=h,m.type=this.page,m.ui_type=WeaponUIType.book,m)}for(var l=AttrProxy.getAttrInfo(o),p=new eui.ArrayCollection,r=0;r<l.length;r++)p.addItem((C={},C.name=l[r][2],C.val=l[r][1],C));if(this.pro_list.dataProvider=p,this.lvup_go.visible=this.btn_lvup.visible=!s,s)this.txt_fight.text=UtilProxy.GetAttrFight(n).toString(),this.lvup_go.visible=!1,this.txt_process.text="已满级";else{var c=this.getProcessValue(this.page,o.book_list),u=o.book_list.length,d=c>=u?7:4;this.btn_lvup.label=e>0?"进阶":"激活";var g=BagProxy.ins().getItemData(o.item[0]),y=BagProxy.ins().getItemCountById(g.id),f=o.item[1],_=y>=f?7:4;if(this.equip_flag=c>=u,this.item_flag=y>=f,e>0){this.lvup_go.visible=!0,this.txt_process.text="",this.txt_fight.text=UtilProxy.GetAttrFight(n).toString();var v=o.book_list[0][1];this.txt_condition.textFlow=UtilProxy.StrFormart("进阶条件：|C:7&[@0 ]系统达到@1 阶|C:@2 &(@3 /@4 )",[i.name,v,d,c,u]),this.sp_cost.source=AssetMgr.getIconResource(g.displayid),this.sp_cost.width=this.sp_cost.height=20,this.txt_money.textFlow=UtilProxy.StrFormart("C:@0 &@1 /@2 ",[_,y,f])}else this.txt_fight.text=UtilProxy.GetAttrFight(o).toString(),this.lvup_go.visible=!1,this.txt_process.textFlow=UtilProxy.StrFormart("当前收集进度：|C:@0 &@1 /@2 |",[d,c,u])}var m,C},e.prototype.onLvupUpdate=function(){this.updateList(),this.openMenu(this.id),this.page_red[this.page].visible=WeaponProxy.ins().getBookRedByType(this.page),this.red_lvup.visible=WeaponProxy.ins().getRedByBookId(this.page,this.id)},e.prototype.getProcessValue=function(t,e){for(var i=0,n=0;n<e.length;n++)WeaponProxy.ins().getLv(t,e[n][0])>=e[n][1]&&(i+=1);return i},e}(BaseEuiView);__reflect(WpBookView.prototype,"WpBookView"),ViewManager.ins().reg(WpBookView,LayerManager.UI_Main),window.WpBookView=WpBookView;var WpItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.star_list=[this.star0,this.star1,this.star2,this.star3]},e.prototype.dataChanged=function(){if(this.data&&this.data.info){this.sp_select.visible=this.selected;var t=this.data.info,e=this.data.type,i=this.data.ui_type,n=WeaponProxy.ins().getLv2(e,t.id);this.icon.source=AssetMgr.getIconResource(t.icon.toString()),this.bg.source=AssetMgr.getIconQualityResource(t.quality),this.sp_black.visible=0==n;for(var o=0;o<this.star_list.length;o++)this.star_list[o].visible=o<t.star;this.lv_go.visible=n>0&&i==WeaponUIType.book,this.bg_title.visible=0==n,this.sp_dress.visible=this.isDress(e,t.id),this.txt_title.text=n>0?"":t.path,this.txt_name.visible=!0,this.bg_remark.visible=!1,this.txt_remark.text="",this.red.visible=WeaponProxy.ins().getRedById(e,t.id);var s=BagProxy.QUALITY_COLOR[t.quality-1];if(this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[s,t.name]),i==WeaponUIType.xb);else if(i==WeaponUIType.book){this.bg_remark.visible=!0,this.sp_dress.visible=!1,this.bg_title.visible=0==n,this.bg_remark.visible=!1,this.red.visible=!1,this.sp_black.visible=!1;var r=BagProxy.QUALITY_COLOR[t.quality-1];this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[r,t.name])}else i==WeaponUIType.lvup&&(this.sp_dress.visible=!1,this.bg_title.visible=!1,this.lv_go.visible=!1,this.red.visible=!1)}},e.prototype.reFresh=function(t){this.sp_select.visible=t},e.prototype.isDress=function(t,e){return e==WeaponProxy.ins().getDressId(t)&&e>0},e}(BaseItemRender);__reflect(WpItem.prototype,"WpItem"),window.WpItem=WpItem;var WpLvupView=function(t){function e(){var e=t.call(this)||this;return e.dir_list=[UI_WEAPON_DIR,UI_XUANBING_DIR,UI_WING_DIR],e.title_list=["神兵进阶","玄兵进阶","神翼进阶"],e.bg_img=["resource/skins/weapon/tex/shenbing_bg.jpg","resource/skins/weapon/tex/xuanbing_bg.jpg","resource/skins/weapon/tex/shenyi_bg.jpg"],e.skinName="WpLvupSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=WpProItem,this.red_lvup=this.btn_lvup.getChildAt(2),this.star_list=[this.star0,this.star1,this.star2,this.star3,this.star4,this.star5,this.star6,this.star7,this.star8,this.star9]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),EventProxy.AddListener(this,EventType.S2CRepWeaponSingleUpgrade,this.onLvupCallBack),this.page=e[0][0],this.id=e[0][1],this.bg.source=this.bg_img[this.page-1],this.txt_title.textFlow=UtilProxy.StrFormart("C:10&@0 ",[this.title_list[this.page-1]]),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepWeaponSingleUpgrade,this.onLvupCallBack)},e.prototype.updateInfo=function(){this.txt_fight.text="0";var t=WeaponProxy.ins().getLv(this.page,this.id),e=WeaponProxy.ins().getBaseById(this.page,this.id,t),i=WeaponProxy.ins().getBaseById(this.page,this.id,t+1),n=WeaponProxy.ins().getResById(this.page,this.id);this.next_lv_data=i;var o=Math.floor(t/10),s=t%10;if(s>0)for(var r=0;r<this.star_list.length;r++)s>r?this.star_list[r].source=e.star_icon:this.star_list[r].source="shengxing_icon_01_01";else if(o>0&&0==s)for(var r=0;r<this.star_list.length;r++)this.star_list[r].source=e.star_icon;if(e){this.txt_fight.text=UtilProxy.GetAttrFight(e).toString(),this.txt_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[n.quality-1],n.name]);for(var a=AttrProxy.getAttrInfo(e),h=new eui.ArrayCollection,r=0;r<a.length;r++)h.addItem((g={},g.name=a[r][2],g.val=a[r][1],g));this.list.dataProvider=h}if(i){var l=BagProxy.ins().getItemCountById(i.item[0]),p=i.item[1],c=BagProxy.ins().getItemName(i.item[0]);this.btn_lvup.visible=!0;var u=(new ItemCellData,WeaponProxy.ins().getRepleaceItemInfo(this.page,i.id,i.level));this.replace_data=u,u&&u.id>0&&u.num>=e.item[1]&&(l=u.num,c=BagProxy.ins().getItemName(u.id));var d=l>=p?7:4;this.txt_cdn.textFlow=UtilProxy.StrFormart("C:10&需要：|C:@0 & @1 x@2 ",[d,c,p]),this.txt_full.text=""}else this.btn_lvup.visible=!1,this.txt_full.textFlow=UtilProxy.StrFormart("C:7& 已满级",[]);this.movie||(this.movie=new MovieClip,this.gp_model.addChild(this.movie),this.movie.x=240,this.movie.y=400),this.movie.y=400,this.movie.x=1==this.page?340:240,this.movie.playFile(this.dir_list[this.page-1]+n.ui_model,-1),this.btn_lvup.visible&&(this.red_lvup.visible=WeaponProxy.ins().getRedById(this.page,this.id));var g},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_lvup:if(this.next_lv_data){if(this.replace_data&&this.replace_data.num>=this.next_lv_data.item[1])return void WeaponProxy.ins().C2SReqWeaponSingleUpgrade(this.page,this.id);if(BagProxy.ins().getItemCountById(this.next_lv_data.item[0])<this.next_lv_data.item[1])return TipsControl.ins().showTips("C:4&道具不足"),void TipsControl.ins().ShowPathTips(this.next_lv_data.item[0]);WeaponProxy.ins().C2SReqWeaponSingleUpgrade(this.page,this.id)}break;case this.btn_close:ViewManager.ins().close(e)}},e.prototype.onLvupCallBack=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=UtilProxy.GetMovieClipById(30,this.eff);i.x=240,i.y=400,this.updateInfo()},e}(BaseEuiView);__reflect(WpLvupView.prototype,"WpLvupView"),ViewManager.ins().reg(WpLvupView,LayerManager.UI_Main),window.WpLvupView=WpLvupView;var WpProItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){void 0!=this.data&&(this.txt.textFlow=UtilProxy.StrFormart("@0 ：+@1 ",[this.data.name,this.data.val]))},e}(BaseItemRender);__reflect(WpProItem.prototype,"WpProItem"),window.WpProItem=WpProItem;var WpSwallowView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZhulingTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onBtnClick),this.addTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.AddListener(this,EventType.S2CRepWeaponSwallow,this.ShowInfo),this.page=t[0],this.id=t[1],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onBtnClick),this.removeTouchEvent(this.onekeybtn,this.onBtnClick),EventProxy.RemoveListener(this,EventType.S2CRepWeaponSwallow,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onBtnClick=function(t){var e=t.currentTarget==this.btn?0:1;return 0==this.cur_lv?void TipsControl.ins().showTips("C:4&未激活"):BagProxy.ins().getItemCountById(this.item_id)<=0?void TipsControl.ins().showTips("C:4&道具不足"):this.use_num>=this.use_sum?void TipsControl.ins().showTips("C:4&已达使用上限"):void WeaponProxy.ins().C2SReqWeaponSwallow(this.page,this.id,e)},e.prototype.ShowInfo=function(){var t=WeaponProxy.ins().getLv(this.page,this.id);this.cur_lv=t;var e=WeaponProxy.ins().getSwallowById(this.page,this.id,t);if(0==t&&(e=WeaponProxy.ins().getSwallowById(this.page,this.id,1)),e){var i=e.max_swallow[0];this.item_id=i;var n=WeaponProxy.ins().getDanById(this.page,i),o=BagProxy.ins().getItemData(i),s=new ItemCellData;s.item_type_id=e.item_id,s.itemConfig=o,s.item_count=1,this.item.data=s,this.namelab.textFlow=UtilProxy.StrFormart("C:@0 &@1 |",[BagProxy.QUALITY_COLOR[o.quality-1],o.name]),this.desc.textFlow=UtilProxy.StrFormart("C:7&已永久增加主角属性：",[]);var r=0,a=0;t>0&&(r=WeaponProxy.ins().getSwallowNum(this.page,this.id),a=e.max_swallow[1]);var h="",l=AttrProxy.getAttrInfo(n);if(void 0!=l)for(var p=0;p<l.length;p++){var c=parseInt(l[p][1])*r;""==h?h=UtilProxy.getStr("@0 |C:7&+@1 |",[l[p][0],r>0?c:0]):h+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[l[p][0],r>0?c:0])}this.pro.textFlow=UtilProxy.generateTextFlow(h),this.hascount.textFlow=UtilProxy.StrFormart("已拥有：@0 ",[t>0?BagProxy.ins().getItemCountById(i):0]),this.use_num=r,this.use_sum=a,this.count.textFlow=UtilProxy.StrFormart("已吞噬：|C:@0 &@1 /@2 |",[a>r?7:4,r,a]);var u=WeaponProxy.ins().getSwallowById(this.page,this.id,t+1);this.tips.visible=this.tips.includeInLayout=void 0!=u,u&&(this.tips.textFlow=UtilProxy.StrFormart("|C:7&下阶可吞噬@0 颗",[u.max_swallow[1]]))}},e}(BaseEuiView);__reflect(WpSwallowView.prototype,"WpSwallowView"),ViewManager.ins().reg(WpSwallowView,LayerManager.UI_Main2),window.WpSwallowView=WpSwallowView;var WelcomeView=function(t){function e(){var e=t.call(this)||this;return e.closeTime=1e4,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="welcomePanelSkin",this.scroller.viewport=this.list,this.list.itemRenderer=ItemCell,this.list.dataProvider=new eui.ArrayCollection},e.prototype.timerFunc=function(){this.leftTime-=500;var t=Math.max(0,Math.floor(this.leftTime/1e3));this.time_lab.text=t+"秒后自动关闭",CommonUtils.log("计时")},e.prototype.timerComFunc=function(){ViewManager.ins().close(e)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];LoginProxy.ins().isCreateRole=!1,t.prototype.open.call(this,e),this.addTouchEvent(this.sureBtn,this.onClick),this.leftTime=this.closeTime,this.time_lab.text=this.leftTime+"秒后自动关闭",this.timer=new egret.Timer(500,2*this.closeTime/1e3);for(var n=GlobalConfig.getMisc_dataConfig(1),o=[],s=0;s<n.welcome_show_item.length;++s)o.push(UtilProxy.GetItemCellData(n.welcome_show_item[s],1));this.list.dataProvider=new eui.ArrayCollection(o),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start()},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this,e),this.removeTouchEvent(this.sureBtn,this.onClick),this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),UtilProxy.ins().isOpenWelcomeView=!0,GameMap.centerEntity&&(GameMap.centerEntity.AI.start(),GuideProxy.ins().isCanGuide=!0,GuideProxy.ins().startCheck())},e.prototype.onClick=function(t){ViewManager.ins().close(e)},e.prototype.test=function(){},e}(BaseEuiView);__reflect(WelcomeView.prototype,"WelcomeView"),ViewManager.ins().reg(WelcomeView,LayerManager.UI_Main2),window.WelcomeView=WelcomeView;var SigninItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SigninItemSkin",e.selectIcon.visible=!1,e.finish.visible=!1,e.rewardTip.visible=!1,e.red.visible=!1,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){var t=this.data;if(void 0!=t){var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.items[0][0],item_count:t.items[0][1]};e.setItemCellData(i),this.item.data=e,this.refreshData()}},e.prototype.refreshData=function(){var t=this.data;if(void 0!=t){this.rewardTip.visible=!1;var e=0;t.id==WelfareProxy.ins().signin_times+1?t.id<=WelfareProxy.ins().signinServerDay()&&(e=WelfareProxy.ins().signin_state?2:1):e=t.id>WelfareProxy.ins().signin_times+1?3:4,this.selectIcon.visible=1==e||2==e,this.finish.visible=4==e,this.rewardTip.visible=2==e,this.red.visible=1==e,this.item.SetShowTips(1!=e&&2!=e)}},e}(BaseItemRender);__reflect(SigninItem.prototype,"SigninItem"),window.SigninItem=SigninItem;var WelfareItem_LevelGift=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;i.itemId=0,i.times=0,i.lv=0,i.cost=[0,0],i.skinName="WelfareItemSkin",i.itemId=e,i.list.itemRenderer=ItemCell,i.jiao=i.rewardBtn.getChildAt(3),i.jiao_lab=i.jiao.getChildAt(1);var n=new eui.Image("common_icon_yuanvao");return i.rewardBtn.addChild(n),n.horizontalCenter=-20,i.rewardBtn.getChildAt(1).horizontalCenter=10,n.verticalCenter=0,i.rewardBtn.addEventListener(egret.TouchEvent.RENDER,function(){"down"==i.rewardBtn.currentState?(n.scaleX=n.scaleY=.9,n.horizontalCenter=-18):(n.scaleX=n.scaleY=1,n.horizontalCenter=-20)},i),i}return __extends(e,t),e.prototype.setData=function(){for(var t=void 0,e=0;e<BossActProxy.ins().getBossActDataByType(5).length;e++)if(BossActProxy.ins().getBossActDataByType(5)[e].id==this.itemId){t=BossActProxy.ins().getBossActDataByType(5)[e].config;break}this.finish.visible=!1,this.rewardBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.lv=t.params[0],0==t.limit_num?this.times=-1:this.times=BossActProxy.ins().getActTimes(5,this.itemId)>=t.limit_num?0:t.limit_num-BossActProxy.ins().getActTimes(5,this.itemId);var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>this.lv?7:4;if(this.info0.textFlow=UtilProxy.generateTextFlow("|C:5&"+this.lv+"级可领取,当前等级||C:"+i+"&("+RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)+"/"+this.lv+")|"),-1==this.times)this.info1.text="";else{var n=this.times>0?7:4;this.info1.textFlow=UtilProxy.generateTextFlow("剩余:|C:"+n+"&"+this.times+"|"),this.info1.x=this.rewardBtn.x+(this.rewardBtn.width>>1)-(this.info1.width>>1)}var o=new eui.ArrayCollection;this.list.dataProvider=o;for(var e=0;e<t.award.length;e++){var s=UtilProxy.GetItemCellData(t.award[e][0],t.award[e][1]);o.addItem(s)}return BossActProxy.ins().isGetReward(5,this.itemId)?(this.finish.visible=!0,void(this.rewardBtn.visible=!1)):(this.cost=t.consume,this.rewardBtn.label=t.consume[1],void this.rewardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this))},e.prototype.onClick=function(){return 0==this.times?void TipsControl.ins().showTips("奖励已领完"):RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)<this.lv?void TipsControl.ins().showTips("等级不足"):10==this.cost[0]&&RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<this.cost[1]?void TipsControl.ins().showTips("元宝不足"):void BossActProxy.ins().C2SReqLimitActTimeActGetAward(5,this.itemId)},e}(eui.Component);__reflect(WelfareItem_LevelGift.prototype,"WelfareItem_LevelGift"),window.WelfareItem_LevelGift=WelfareItem_LevelGift;var WelfareItem=function(t){function e(){var e=t.call(this)||this;return e.type=-1,e.time=-1,e.isEnough=!1,e.skinName="WelfareItemSkin",e.addTouchEvent(e.rewardBtn,e.onClick),e.list.itemRenderer=ItemCell,e.info1.text="",e.rewardBtn.visible=!1,e.finish.visible=!1,TimerManager.ins().doTimer(1e3,0,e.Update,e),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;void 0!=e&&(this.type=e.type,this.setData(),this.Refresh())},e.prototype.setData=function(){var t=this.data,e=new Array;if(1==t.type){var i=t.config;this.info0.textFlow=UtilProxy.generateTextFlow("在线"+UtilProxy.getChangeTimeHSStr(i.need_time)+"可领取"),this.time=i.need_time,this.info1.text="";for(var n=0;n<i.items.length;++n){var o=UtilProxy.GetItemCellData(i.items[n][0],i.items[n][1]);e.push(o)}this.Update()}else if(2==t.type){var s=t.config;this.info0.text=s.name,this.info1.textFlow=UtilProxy.generateTextFlow("第"+s.id+"日可领取");for(var n=0;n<s.items.length;++n){var r=UtilProxy.GetItemCellData(s.items[n][0],s.items[n][1]);e.push(r)}}this.list.dataProvider=new eui.ArrayCollection(e)},e.prototype.onClick=function(t){var e=this.data;if(void 0!=e)if(1==e.type)WelfareProxy.ins().C2SReqWelfareGetOnlineAward(e.id);else if(2==e.type){var i=WelfareProxy.ins().getWeekCarAwardData(e.id);(void 0==i||void 0==i.state)&&TipsControl.ins().showTips("未满足条件领取"),1==i.state?WelfareProxy.ins().C2SReqWelfareGetWeekCardAward(e.id):2==i.state&&TipsControl.ins().showTips("已领取")}},e.prototype.Refresh=function(){var t=this.data;if(void 0!=t)if(1==t.type){var e=WelfareProxy.ins().getOnlineTime();this.time-e<=0?(this.rewardBtn.visible=!WelfareProxy.ins().isOnlineAward(t.id),this.finish.visible=WelfareProxy.ins().isOnlineAward(t.id)):(this.rewardBtn.visible=!1,this.finish.visible=!1)}else if(2==t.type)if(WelfareProxy.ins().is_open_week_card){var i=WelfareProxy.ins().getWeekCarAwardData(t.id);void 0==i||void 0==i.state?(this.rewardBtn.visible=!1,this.finish.visible=!1):(this.rewardBtn.visible=1==i.state,this.finish.visible=2==i.state)}else this.rewardBtn.visible=!1,this.finish.visible=!1},e.prototype.Update=function(){if(1==this.type&&this.time>0){var t=WelfareProxy.ins().getOnlineTime();if(this.time>t){var e=DateUtils.getFormatBySecond(this.time-t,3);this.info1.text="倒计时:"+e}else this.isEnough||(this.Refresh(),this.info1.text="",this.isEnough=!0)}},e}(BaseItemRender);__reflect(WelfareItem.prototype,"WelfareItem"),window.WelfareItem=WelfareItem;var WelfareItemRecharge=function(t){function e(){var e=t.call(this)||this;return e.time=-1,e.isEnough=!1,e.skinName="WelfareItem1Skin",e.addTouchEvent(e.rewardBtn,e.onClick),e.info1.text="",e.rewardBtn.visible=!1,e.finish.visible=!1,TimerManager.ins().doTimer(1e3,0,e.Update,e),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData(),this.Refresh()},e.prototype.setData=function(){var t=this.data;this.info0.textFlow=UtilProxy.generateTextFlow("累计登陆|C:7&"+t.day+"|天\n在线|C:7&"+UtilProxy.getChangeTimeHSStr(t.need_time)+"|可领取"),this.time=WelfareProxy.ins().getLoginday()==t.day?t.need_time:0,this.info1.text="";var e=UtilProxy.GetItemCellData(t.items[0][0],t.items[0][1]);this.item.data=e,this.Update()},e.prototype.onClick=function(t){var e=this.data;void 0!=e&&WelfareProxy.ins().C2SReqWelfareLoginOnlineAward(e.day)},e.prototype.Refresh=function(){var t=this.data;if(void 0!=t){var e=WelfareProxy.ins().GetloginAwardState(t.day);this.rewardBtn.visible=2!=e,this.finish.visible=2==e,UtilProxy.SetAshColor(this.rewardBtn,1!=e),this.rewardBtn.label=1==e?"领取":"未完成"}},e.prototype.Update=function(){if(this.time>0){var t=WelfareProxy.ins().getOnlineTime();if(this.time>t){var e=DateUtils.getFormatBySecond(this.time-t,3);this.info1.textFlow=UtilProxy.generateTextFlow("|C:7&"+e+"|")}else this.isEnough||(this.Refresh(),this.info1.text="",this.isEnough=!0)}},e}(BaseItemRender);__reflect(WelfareItemRecharge.prototype,"WelfareItemRecharge"),window.WelfareItemRecharge=WelfareItemRecharge;var WelfareView_Code=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.enterBtn,this.onclick),EventProxy.AddListener(this,EventType.S2CRepWelfareCdkeyGiftBag,this.S2CRepWelfareCdkeyGiftBag)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.enterBtn,this.onclick),EventProxy.RemoveListener(this,EventType.S2CRepWelfareCdkeyGiftBag,this.S2CRepWelfareCdkeyGiftBag)},e.prototype.setVisible=function(t){this.visible=t},e.prototype.onclick=function(t){""!=this.input.text&&WelfareProxy.ins().C2SReqWelfareCdkeyGiftBag(this.input.text)},e.prototype.S2CRepWelfareCdkeyGiftBag=function(t){},e}(BaseEuiView);__reflect(WelfareView_Code.prototype,"WelfareView_Code"),window.WelfareView_Code=WelfareView_Code;var WelfareView_LevelGift=function(t){function e(){var e=t.call(this)||this;return e.itemList=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="Welfare5Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initItem(),this.refashItem(),EventProxy.AddListener(this,EventType.S2CRepLimitActTimeActGetAward,this.refashItem),this.refashTimer(),TimerManager.ins().doTimer(1e4,0,this.refashTimer,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepLimitActTimeActGetAward,this.refashItem),TimerManager.ins().remove(this.refashTimer,this)},e.prototype.initItem=function(){this.itemList=[];for(var t=BossActProxy.ins().getBossActDataByType(5),e=0;e<t.length;e++){var i=new WelfareItem_LevelGift(t[e].id);this.itemList.push(i)}},e.prototype.refashItem=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(void 0!=t&&t.length>0){for(var i=void 0,n=0;n<BossActProxy.ins().getBossActDataByType(5).length;n++)if(BossActProxy.ins().getBossActDataByType(5)[n].id==t[1]){i=BossActProxy.ins().getBossActDataByType(5)[n].config;break}for(var o=[],n=0;n<i.award.length;n++){var s=UtilProxy.GetItemCellData(i.award[n][0],i.award[n][1]);o.push(s)}TipsControl.ins().showReward(o)}this.g_item.scrollV=0,this.g_item.removeChildren();for(var n=0;n<this.itemList.length;n++)this.itemList[n].setData();this.itemList.sort(this.sort);for(var n=0;n<this.itemList.length;n++)this.g_item.addChild(this.itemList[n])},e.prototype.sort=function(t,e){var i=0,n=0;return t.finish.visible&&(i=1),e.finish.visible&&(n=1),i-n},e.prototype.refashTimer=function(){var t=BossActProxy.ins().getBossActDataByType(5)[0].end,e=BossActProxy.ins().getBossActLeftTime(t),i=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_2);this.lb_timer.textFlow=UtilProxy.generateTextFlow("剩余时间:|C:7&"+(i.split("分")[0]+"分")+"|")},e}(BaseEuiView);__reflect(WelfareView_LevelGift.prototype,"WelfareView_LevelGift"),window.WelfareView_LevelGift=WelfareView_LevelGift;var WelfareView_OnlineAward=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=WelfareItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.cardBtn.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.cardActive.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.cardImg.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.cardBtn,this.onClick),EventProxy.AddListener(this,EventType.S2CRspWelfareGetOnlineAward,this.S2CRspWelfareGetOnlineAward),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.cardBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetOnlineAward,this.S2CRspWelfareGetOnlineAward),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData)},e.prototype.S2CRspWelfareGetOnlineAward=function(t){for(var e=t,i=0;i<this.list.numChildren;++i){var n=this.list.getChildAt(i);void 0!=n&&void 0!=n.data&&n.data.id==e&&n.Refresh()}},e.prototype.S2CRepActivitySpecialRightsData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCardState()},e.prototype.setCardState=function(){if(!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck){var t=0==PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHOUKA);this.cardActive.visible=!t,this.cardBtn.visible=t}},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData()},e.prototype.setData=function(){var t=new Array;for(var e in GlobalConfig.ins().online_awardConfig){var i=new WelfareItemData;i.setData(1,GlobalConfig.ins().online_awardConfig[e].id),t.push(i)}this.list.dataProvider=new eui.ArrayCollection(t),this.setCardState()},e.prototype.onClick=function(t){ViewManager.ins().open(PrivilegeView)},e}(BaseEuiView);__reflect(WelfareView_OnlineAward.prototype,"WelfareView_OnlineAward"),window.WelfareView_OnlineAward=WelfareView_OnlineAward;var WelfareView_RechargeAward=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=WelfareItemRecharge,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.S2CRspWelfareLoginOnlineAward)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.S2CRspWelfareLoginOnlineAward)},e.prototype.S2CRspWelfareLoginOnlineAward=function(t){for(var e=t,i=0;i<this.list.numChildren;++i){var n=this.list.getChildAt(i);void 0!=n&&void 0!=n.data&&n.data.day==e&&n.Refresh()}},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData()},e.prototype.setData=function(){var t=new Array,e=GlobalConfig.getwelfare_login_online_awardConfigs();for(var i in e)t.push(e[i]);this.list.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(WelfareView_RechargeAward.prototype,"WelfareView_RechargeAward"),window.WelfareView_RechargeAward=WelfareView_RechargeAward;var WelfareView_SevenDay=function(t){function e(){var e=t.call(this)||this;return e.current_click=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.day_list=[this.day0,this.day1,this.day2,this.day3,this.day4,this.day5,this.day6],this.name_list=[this.name0,this.name1,this.name2,this.name3,this.name4,this.name5,this.name6],this.info_list=[this.info0,this.info1,this.info2,this.info3,this.info4,this.info5,this.info6],this.cell_list=[this.cell0,this.cell1,this.cell2,this.cell3,this.cell4,this.cell5,this.cell6],this.finish_list=[this.finish0,this.finish1,this.finish2,this.finish3,this.finish4,this.finish5,this.finish6],this.ufinish_list=[this.ufinish0,this.ufinish1,this.ufinish2,this.ufinish3,this.ufinish4,this.ufinish5,this.ufinish6],this.click_list=[this.click0,this.click1,this.click2,this.click3,this.click4,this.click5,this.click6],this.list.itemRenderer=ItemCell,this.list.dataProvider=new eui.ArrayCollection,this.setData(),this.icon6.source="fuli_wuwang",this.cardBtn.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.cardActive.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.cardImg.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.rewardBtn,this.onClick),this.addTouchEvent(this.cardBtn,this.onClick);for(var i=0;i<this.click_list.length;++i)this.addTouchEvent(this.click_list[i],this.onDayClick);this.setData(),EventProxy.AddListener(this,EventType.S2CRspWelfareGetLoginAward,this.S2CRspWelfareGetLoginAward),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];
this.removeTouchEvent(this.rewardBtn,this.onClick),this.removeTouchEvent(this.cardBtn,this.onClick);for(var i=0;i<this.click_list.length;++i)this.removeTouchEvent(this.click_list[i],this.onDayClick);EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetLoginAward,this.S2CRspWelfareGetLoginAward),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData),this.current_click=-1},e.prototype.setData=function(){GlobalConfig.getConfig("login_award","login_awardConfig");var t=0;for(var e in GlobalConfig.ins().login_awardConfig){var i=GlobalConfig.ins().login_awardConfig[e];if(this.name_list[t].textFlow=UtilProxy.generateTextFlow("第"+i.id+"天"),i.items.length>0){var n=new ItemCellData,o={item_slot_idx:0,item_type_id:i.items[0][0],item_count:i.items[0][1]};n.setItemCellData(o),this.cell_list[t].data=n,this.info_list[t].text=i.tips}t+=1}for(var s=0;s<this.day_list.length;++s)s>=t&&(this.day_list[s].visible=!1)},e.prototype.S2CRspWelfareGetLoginAward=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=WelfareProxy.ins().currentLoginAwardDay();0!=i?this.setCurrentData(i):this.setCurrentData(this.current_click)},e.prototype.S2CRepActivitySpecialRightsData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCardState()},e.prototype.setCurrentData=function(t){var e=GlobalConfig.getLogin_awardConfig(t);if(void 0==e)this.reward_info.text="",this.list.dataProvider=new eui.ArrayCollection;else{this.reward_info.textFlow=UtilProxy.generateTextFlow("第"+t+"天奖励");for(var i=new Array,n=0;n<e.items.length;++n){var o=new ItemCellData,s={item_slot_idx:0,item_type_id:e.items[n][0],item_count:e.items[n][1]};o.setItemCellData(s),i.push(o)}this.list.dataProvider=new eui.ArrayCollection(i)}for(var n=0;n<this.day_list.length;++n)this.finish_list[n].visible=WelfareProxy.ins().isLoginRewardDayById(n+1),this.ufinish_list[n].visible=!WelfareProxy.ins().isLoginRewardDayById(n+1);this.rewardBtn.visible=!WelfareProxy.ins().isLoginRewardDayById(t),this.btnFinish.visible=WelfareProxy.ins().isLoginRewardDayById(t),this.rewardBtn.setRed(!WelfareProxy.ins().isLoginRewardDayById(t)&&t<=WelfareProxy.ins().getCurrentLoginAwardDay()),this.current_click=t},e.prototype.setVisible=function(t){if(this.visible=t,t){var e=WelfareProxy.ins().currentLoginAwardDay();0==e&&(e=WelfareProxy.ins().currentLoginDay()+1),this.setCurrentData(e),this.setCardState()}else this.current_click=-1},e.prototype.setCardState=function(){if(!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck){var t=0==PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN);this.cardActive.visible=!t,this.cardBtn.visible=t}},e.prototype.onDayClick=function(t){var e=this.click_list.indexOf(t.currentTarget);this.current_click!=e+1&&this.setCurrentData(e+1)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rewardBtn:var e=GlobalConfig.getWelfare_configConfig(1),i=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL);if(i>=e.login_award_level){var n=WelfareProxy.ins().getCurrentLoginAwardDay();this.current_click>n?TipsControl.ins().showTips("未达到登录天数!"):WelfareProxy.ins().isLoginRewardDayById(this.current_click)?TipsControl.ins().showTips("已领取!"):WelfareProxy.ins().C2SReqWelfareGetLoginAward(this.current_click)}else TipsControl.ins().showTips("需达到"+e.login_award_level+"级才能领取!");break;case this.cardBtn:ViewManager.ins().open(PrivilegeView,2)}},e}(BaseEuiView);__reflect(WelfareView_SevenDay.prototype,"WelfareView_SevenDay"),window.WelfareView_SevenDay=WelfareView_SevenDay;var WelfareView_Signin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=SigninItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.cardBtn.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.cardActive.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.cardImg.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.cardBtn,this.onClick),EventProxy.AddListener(this,EventType.S2CRspWelfareSignin,this.S2CRspWelfareSignin),EventProxy.AddListener(this,EventType.S2CRspWelfareSigninRedeem,this.S2CRspWelfareSigninRedeem),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.cardBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareSignin,this.S2CRspWelfareSignin),EventProxy.RemoveListener(this,EventType.S2CRspWelfareSigninRedeem,this.S2CRspWelfareSigninRedeem),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.S2CRepActivitySpecialRightsData)},e.prototype.onClick=function(t){ViewManager.ins().open(PrivilegeView)},e.prototype.S2CRepActivitySpecialRightsData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCardState()},e.prototype.setVisible=function(t){this.visible=t,t&&(this.setData(),this.setCardState())},e.prototype.setCardState=function(){if(!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck){var t=0==PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHOUKA);this.cardActive.visible=!t,this.cardBtn.visible=t}},e.prototype.S2CRspWelfareSigninRedeem=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData()},e.prototype.S2CRspWelfareSignin=function(){this.setData()},e.prototype.setData=function(){var t=[];for(var e in GlobalConfig.ins().welfare_signin_dataConfig)t.push(GlobalConfig.ins().welfare_signin_dataConfig[e]);this.list.dataProvider=new eui.ArrayCollection(t),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSkinItemClick,this)},e.prototype.onSkinItemClick=function(t){var e=t.itemRenderer,i=e.data;if(i.id==WelfareProxy.ins().signin_times+1&&i.id<=WelfareProxy.ins().signinServerDay())if(WelfareProxy.ins().signin_state){var n=GlobalConfig.getWelfare_configConfig(1);BagProxy.ins().getItemCountById(n.redeem_item_id)>0?WelfareProxy.ins().C2SReqWelfareSigninRedeem():RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)>=n.redeem_yb?TipsControl.ins().ShowTips1("补签需花费"+n.redeem_yb+"元宝，是否补签？",void 0,function(){WelfareProxy.ins().C2SReqWelfareSigninRedeem()}):TipsControl.ins().showTips("元宝不足！")}else WelfareProxy.ins().C2SReqWelfareSignin()},e}(BaseEuiView);__reflect(WelfareView_Signin.prototype,"WelfareView_Signin"),window.WelfareView_Signin=WelfareView_Signin;var WelfareView_WeekAward=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=WelfareItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.cardActive.visible=!1,this.cardBtn.visible=!1,this.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.cardBtn,this.onClick),EventProxy.AddListener(this,EventType.S2CRspWelfareGetWeekCardAward,this.S2CRspWelfareGetWeekCardAward)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.cardBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetWeekCardAward,this.S2CRspWelfareGetWeekCardAward)},e.prototype.S2CRspWelfareGetWeekCardAward=function(t){for(var e=t,i=0;i<this.list.numChildren;++i){var n=this.list.getChildAt(i);void 0!=n&&void 0!=n.data&&n.data.id==e&&n.Refresh()}this.setData()},e.prototype.S2CRepActivitySpecialRightsData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCardState()},e.prototype.setCardState=function(){},e.prototype.setVisible=function(t){this.visible=t,t&&this.setData()},e.prototype.setData=function(){var t=new Array;for(var e in GlobalConfig.ins().week_card_awardConfig){var i=new WelfareItemData;i.setData(2,GlobalConfig.ins().week_card_awardConfig[e].id),t.push(i)}if(this.list.dataProvider=new eui.ArrayCollection(t),WelfareProxy.ins().is_open_week_card){var n=WelfareProxy.ins().LeftWeekCarAward();this.info.textFlow=UtilProxy.generateTextFlow("C:9&超值周卡剩余礼包个数：|C:7&"+n)}else{var o=GlobalConfig.getWelfare_configConfig(1).week_card_yb/LimitActProxy.ins().rechargeNun+"元";this.info.textFlow=UtilProxy.generateTextFlow("C:7&单笔充值满"+o+"，自动激活|C:9&“超值周卡”|C:7&尊享七日七重礼包")}this.setCardState()},e.prototype.onClick=function(t){NoticeProxy.ins().OpenRecharge()},e}(BaseEuiView);__reflect(WelfareView_WeekAward.prototype,"WelfareView_WeekAward"),window.WelfareView_WeekAward=WelfareView_WeekAward;var WelfareView=function(t){function e(){var e=t.call(this)||this;return e.current_index=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="WelfareSkin",this.sys_list=[this.sys0,this.sys1,this.sys2,this.sys3,this.sys5,this.sys4,this.sys6],this.sevenDayView.initUI(),this.SigninView.initUI(),this.OnlineView.initUI(),this.WeekCarView.initUI(),this.CodeView.initUI(),this.LevelGift.initUI(),this.RechargeAward.initUI(),this.sys3.visible=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)),this.sys3.includeInLayout=!((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck))},e.prototype.setLevelGift=function(){BossActProxy.ins().getActActiveByType(5)||(this.sys5.visible=!1,this.sys5.includeInLayout=!1,this.current_view==this.LevelGift&&this.setCurrentView(0))},e.prototype.setRechargeAward=function(){WelfareProxy.ins().IsShowRecharge()||(this.sys6.visible=!1,this.sys6.includeInLayout=!1,this.current_view==this.RechargeAward&&this.setCurrentView(0))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.sevenDayView.open(),this.SigninView.open(),this.OnlineView.open(),this.WeekCarView.open(),this.CodeView.open(),this.LevelGift.open(),this.RechargeAward.open(),this.setLevelGift(),this.setRechargeAward();for(var i=0;i<this.sys_list.length;++i)this.addTouchEvent(this.sys_list[i],this.onSysClick);this.addTouchEvent(this.closeBtn,this.onCloseClick),this.setRed(),t&&t[0]?this.setCurrentView(t[0]):this.setCurrentView(0),EventProxy.AddListener(this,EventType.S2CRspWelfareGetLoginAward,this.setRed),EventProxy.AddListener(this,EventType.S2CRspWelfareSignin,this.setRed),EventProxy.AddListener(this,EventType.S2CRspWelfareGetOnlineAward,this.setRed),EventProxy.AddListener(this,EventType.S2CRspWelfareGetWeekCardAward,this.setRed),EventProxy.AddListener(this,EventType.RefreshOnlineAward,this.setRed),EventProxy.AddListener(this,EventType.freshLimitActRed,this.setRed),EventProxy.AddListener(this,EventType.S2CRepMiscDailyChange,this.setLevelGift),EventProxy.AddListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.setRechargeAward),EventProxy.AddListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.setRed)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.sevenDayView.close(),this.SigninView.close(),this.OnlineView.close(),this.WeekCarView.close(),this.CodeView.close(),this.LevelGift.close(),this.RechargeAward.close();for(var i=0;i<this.sys_list.length;++i)this.removeTouchEvent(this.sys_list[i],this.onSysClick);this.removeTouchEvent(this.closeBtn,this.onCloseClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetLoginAward,this.setRed),EventProxy.RemoveListener(this,EventType.S2CRspWelfareSignin,this.setRed),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetOnlineAward,this.setRed),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetWeekCardAward,this.setRed),EventProxy.RemoveListener(this,EventType.RefreshOnlineAward,this.setRed),EventProxy.RemoveListener(this,EventType.freshLimitActRed,this.setRed),EventProxy.RemoveListener(this,EventType.S2CRepMiscDailyChange,this.setLevelGift),EventProxy.RemoveListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.setRechargeAward),EventProxy.RemoveListener(this,EventType.S2CRspWelfareLoginOnlineAward,this.setRed)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onSysClick=function(t){var e=this.sys_list.lastIndexOf(t.currentTarget);this.setCurrentView(e)},e.prototype.setCurrentView=function(t){if(this.current_index!=t){this.sys_list[this.current_index]&&this.sys_list[this.current_index].setSelect(!1),null!=this.current_view&&this.current_view.setVisible(!1);var e;switch(t){case 0:e=this.sevenDayView;break;case 1:e=this.SigninView;break;case 2:e=this.OnlineView;break;case 3:e=this.WeekCarView;break;case 4:e=this.LevelGift;break;case 5:e=this.CodeView;break;case 6:e=this.RechargeAward}this.sys_list[t].setSelect(!0),this.current_view=e,this.current_view.setVisible(!0),this.current_index=t}},e.prototype.setRed=function(){this.sys_list[0].setRed(WelfareProxy.ins().isGetLoginAward()),this.sys_list[1].setRed(!WelfareProxy.ins().signin_state),this.sys_list[2].setRed(WelfareProxy.ins().getOnlineAward()),this.sys_list[3].setRed(WelfareProxy.ins().isWeekCarAward()),this.sys_list[4].setRed(BossActProxy.ins().getRedByType(5)),this.sys_list[6].setRed(WelfareProxy.ins().IsShowRechargeRed())},e}(BaseEuiView);__reflect(WelfareView.prototype,"WelfareView"),ViewManager.ins().reg(WelfareView,LayerManager.UI_Main2),window.WelfareView=WelfareView;var WorldMapHookItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.skinName="WorldMapHookItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){},e}(BaseItemRender);__reflect(WorldMapHookItemRender.prototype,"WorldMapHookItemRender"),window.WorldMapHookItemRender=WorldMapHookItemRender;var WorldMapWin=function(t){function e(){var e=t.call(this)||this;return e.btns=[],e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldMapSkin",this.btns=[this.btn1,this.btn2,this.btn3,this.btn4,this.btn5,this.btn6,this.btn7,this.btn8,this.btn9,this.btn10,this.btn11,this.btn12]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btnClose,this.onClick),this.addTouchEvent(this.btnClose0,this.onClick),this.addTouchEvent(this,this.onClick)},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.apply(this,e)},e.prototype.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose0:ViewManager.ins().close(this)}var e=this.btns.indexOf(t.target);if(-1!=e){ViewManager.ins().close(this)}},e}(BaseEuiView);__reflect(WorldMapWin.prototype,"WorldMapWin"),ViewManager.ins().reg(WorldMapWin,LayerManager.UI_Main),window.WorldMapWin=WorldMapWin;var XianFuView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="XianFuViewSkin",this.btnlist=[this.btn0,this.btn1,this.btn2,this.btn3,this.btn4,this.btn5,this.btn6,this.btn7],this.nameItlist=[this.nameIt0,this.nameIt1,this.nameIt2,this.nameIt3,this.nameIt4,this.nameIt5,this.nameIt6,this.nameIt7],this.namelist=[this.name0,this.name1,this.name2,this.name3,this.name4,this.name5,this.name6,this.name7],this.redlist=[this.red0,this.red1,this.red2,this.red3,this.red4,this.red5,this.red6,this.red7]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.btnlist.length;++i)this.addTouchEvent(this.btnlist[i],this.onBtnClick);this.addTouchEvent(this.moneyImg1,this.onMoneyImgClick),this.addTouchEvent(this.btn_back,this.onBackClick),EventProxy.AddListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.AddListener(this,EventType.RefreshCopyRed,this.RefreshCopyRed),EventProxy.AddListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordGetScoreAward,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionswordUpdateInfo,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepFactionContribute,this.SetFacRed),EventProxy.AddListener(this,EventType.S2CRepArenaGetInfo,this.SetShenxianRed),EventProxy.AddListener(this,EventType.S2CRepArenaChallenge,this.SetShenxianRed),EventProxy.AddListener(this,EventType.S2CRepArenaSweep,this.SetShenxianRed),EventProxy.AddListener(this,EventType.S2CRepArenaBuyChallengeNum,this.SetShenxianRed),DeviceUtils.IsWx||DeviceUtils.IsQQ?this.topAnchor.anchorOffsetY=-35:this.topAnchor.anchorOffsetY=0,this.ShowMoney(),this.setRedByIndex(0,XiuXianProxy.ins().getLimitRed()),this.setRedByIndex(1,ShenXianProxy.ins().getRed()),this.setRedByIndex(2,CopyProxy.ins().getSwordRed()),this.setRedByIndex(3,CopyTeamProxy.ins().getRed()),this.setRedByIndex(4,FacProxy.ins().getRed()),this.setRedByIndex(5,CopyProxy.ins().GetMatericalCopyRed()),this.setRedByIndex(6,CopyProxy.ins().GetZYTowerCopyRed())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.moneyImg1,this.onMoneyImgClick),this.removeTouchEvent(this.btn_back,this.onBackClick),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.UpdataMoney),EventProxy.RemoveListener(this,EventType.RefreshCopyRed,this.RefreshCopyRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetLeaderBattleInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateChallengeInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordGetScoreAward,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionswordUpdateInfo,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepFactionContribute,this.SetFacRed),EventProxy.RemoveListener(this,EventType.S2CRepArenaGetInfo,this.SetShenxianRed),EventProxy.RemoveListener(this,EventType.S2CRepArenaChallenge,this.SetShenxianRed),EventProxy.RemoveListener(this,EventType.S2CRepArenaSweep,this.SetShenxianRed),EventProxy.RemoveListener(this,EventType.S2CRepArenaBuyChallengeNum,this.SetShenxianRed)},e.prototype.onMoneyImgClick=function(t){NoticeProxy.ins().OpenRecharge()},e.prototype.onBackClick=function(t){ViewManager.ins().close(this)},e.prototype.onBtnClick=function(t){var e=this.btnlist.indexOf(t.currentTarget);switch(e){case 0:ViewManager.ins().open(ActHallView);break;case 1:ViewManager.ins().open(ShenxianView);break;case 2:ViewManager.ins().open(FubenView,3);break;case 3:ViewManager.ins().open(FubenView,2);break;case 4:ViewManager.ins().open(FacView);break;case 5:ViewManager.ins().open(FubenView);break;case 6:ViewManager.ins().open(FubenView,1);break;case 7:ViewManager.ins().open(ShenxianView,1)}},e.prototype.UpdataMoney=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];(i==MoneyAttr.COIN||i==MoneyAttr.YUANBAO)&&this.ShowMoney()},e.prototype.ShowMoney=function(){this.money0.text=UtilProxy.getNumLab(RoleProxy.ins().getMoneyAttr(MoneyAttr.COIN)),this.money1.text=UtilProxy.getNumLab(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO))},e.prototype.RefreshCopyRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRedByIndex(0,XiuXianProxy.ins().getLimitRed()),this.setRedByIndex(2,CopyProxy.ins().getSwordRed()),this.setRedByIndex(3,CopyTeamProxy.ins().getRed()),this.setRedByIndex(5,CopyProxy.ins().GetMatericalCopyRed()),this.setRedByIndex(6,CopyProxy.ins().GetZYTowerCopyRed())},e.prototype.SetFacRed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setRedByIndex(4,FacProxy.ins().getRed())},e.prototype.setRedByIndex=function(t,e){this.redlist[t]&&(this.redlist[t].visible=e)},e.prototype.SetShenxianRed=function(){this.setRedByIndex(1,ShenXianProxy.ins().getRed())},e}(BaseEuiView);__reflect(XianFuView.prototype,"XianFuView"),ViewManager.ins().reg(XianFuView,LayerManager.UI_PreMain),window.XianFuView=XianFuView,window.XianFuView=XianFuView;var XianWeiAwardItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TopAwardItemSkin",e.g_No.removeChildren(),e.lab_name=new eui.Label(""),e.lab_name.size=16,e.g_No.addChild(e.lab_name),e.list.itemRenderer=ItemCell,e.itemArray=new eui.ArrayCollection,e.list.dataProvider=e.itemArray,e}return __extends(e,t),e.prototype.setData=function(t,e){this.lab_name.textFlow=UtilProxy.generateTextFlow("|C:5&"+t+"|"),this.itemArray.removeAll();for(var i=0,n=e;i<n.length;i++){var o=n[i];this.itemArray.addItem(o)}},e}(eui.Component);__reflect(XianWeiAwardItem.prototype,"XianWeiAwardItem"),window.XianWeiAwardItem=XianWeiAwardItem;var XianWeiAwardView=function(t){function e(){var e=t.call(this)||this;return e.itemList=[],e.btns=[],e.curIndex=0,e.skinName="XianWeiAwardViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){this.btns=[this.btn0,this.btn1]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_close,this.onClickClose),this.addTouchEvent(this.btn0,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.showInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClickClose),this.removeTouchEvent(this.btn0,this.onClick),this.removeTouchEvent(this.btn1,this.onClick)},e.prototype.onClickClose=function(){ViewManager.ins().close(this)},e.prototype.onClick=function(t){this.curIndex=this.btns.indexOf(t.currentTarget),this.showInfo()},e.prototype.showInfo=function(){var t=GlobalConfig.ins().xianwei_base_dataConfigs,e=[];for(var i in t)e.push(t[i]);e.reverse();var n=0;for(var o in e){if(void 0==this.itemList[n]){var s=new XianWeiAwardItem;this.itemList[n]=s,this.g_item.addChild(this.itemList[n])}var r=0==this.curIndex?e[o].upgrade_award:e[o].daily_award,a=[];for(var i in r)a.push(UtilProxy.GetItemCellData(r[i][0],r[i][1]));this.itemList[n].setData(e[o].name,a),n++}this.lab_awardTitle.text=0==this.curIndex?"达标奖励":"每日奖励";for(var h=0;h<this.btns.length;h++)this.curIndex==h?this.btns[h].icon="common_btn_big_yellow":this.btns[h].icon="common_btn_big_yellow_off"},e}(BaseEuiView);__reflect(XianWeiAwardView.prototype,"XianWeiAwardView"),ViewManager.ins().reg(XianWeiAwardView,LayerManager.UI_Main2),window.XianWeiAwardView=XianWeiAwardView;var XianWeiView=function(t){function e(){var e=t.call(this)||this;return e.curXianWei=0,e.nextXianWei=1,e.curFight=0,e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.AddListener(this,EventType.S2CRepTitleGetXianweiInfo,this.showInfo),EventProxy.AddListener(this,EventType.S2CRepTitleUpgradeXianwei,this.showInfo),this.addTouchEvent(this.btn_award,this.onClick),this.addTouchEvent(this.btn_up,this.onClick),this.addTouchEvent(this.btn_lab,this.onClick),this.showInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepTitleGetXianweiInfo,this.showInfo),EventProxy.RemoveListener(this,EventType.S2CRepTitleUpgradeXianwei,this.showInfo)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_award:ViewManager.ins().open(XianWeiAwardView);break;case this.btn_lab:TipsControl.ins().showTips("完成仙符目标获得");break;case this.btn_up:var e=GlobalConfig.getXianwei_base_dataConfig(this.nextXianWei),i=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING),n=XiuXianProxy.ins().alive_point;if(i<e.need_fight)return void TipsControl.ins().showTips("战力未满足晋升条件");if(n<e.active_point)return void TipsControl.ins().showTips("当前活跃度未满足晋升条件");XiuXianProxy.ins().C2SReqTitleUpgradeXianwei()}},e.prototype.showInfo=function(){this.btn_lab.textFlow=UtilProxy.generateTextFlow("|C:7&U&获取途径|"),this.curXianWei=XiuXianProxy.ins().getXianwei(),this.nextXianWei=this.curXianWei+1;var t=GlobalConfig.getXianwei_base_dataConfig(this.curXianWei),e=GlobalConfig.getXianwei_base_dataConfig(this.nextXianWei);this.curFight=0,void 0==t?this.lab_curAttr.text="":this.lab_curAttr.textFlow=UtilProxy.generateTextFlow("攻击力:"+t.attack);var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING),n=XiuXianProxy.ins().alive_point;void 0==e?(this.lab_nextAttr.text="",this.lab0.textFlow=UtilProxy.generateTextFlow("战力: |C:7&"+i+"}/--"),this.lab1.textFlow=UtilProxy.generateTextFlow("活跃度: |C:7&"+n+"}/--")):(this.lab_nextAttr.textFlow=UtilProxy.generateTextFlow("|C:7&攻击力:"+e.attack+"|"),this.lab0.textFlow=UtilProxy.generateTextFlow("战力:|C:"+(i<e.active_point?4:7)+"&"+i+"|/"+e.need_fight),this.lab1.textFlow=UtilProxy.generateTextFlow("活跃度:|C:"+(n<e.active_point?4:7)+"&"+n+"|/"+e.active_point)),this.curFight=UtilProxy.GetAttrFight(t),this.txt_fight.text=this.curFight.toString();var o=XiuXianProxy.ins().getXianweiName();this.lab_curName.textFlow=UtilProxy.generateTextFlow(RoleProxy.ins().getRoleName()+" "+o);var s=XiuXianProxy.ins().getXianweiNameById(this.nextXianWei);this.lab_nextName.textFlow=UtilProxy.generateTextFlow(RoleProxy.ins().getRoleName()+" "+s);var r=RoleProxy.ins().getRoleSex(),a=GrowupProxy.ins().fashion_wear,h=UtilProxy.GetRoleObjectById(a,void 0,void 0,void 0,r),l=UtilProxy.GetRoleObjectById(a,void 0,void 0,void 0,r);l.scaleX=l.scaleY=h.scaleX=h.scaleY=.8,this.curMod.removeChildren(),this.curMod.addChild(h),this.nextMod.removeChildren(),this.nextMod.addChild(l)},e}(BaseEuiView);__reflect(XianWeiView.prototype,"XianWeiView"),window.XianWeiView=XianWeiView;var XianYuanView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XianyuanSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_xianyuan"),this.item_list.itemRenderer=ItemCell,this.star_list=[];for(var e=0;10>e;e++){var i=this.star_go.getChildAt(e);this.star_list.push(i)}this.btn_list=[this.btn_close,this.btn_jiechu,this.btn_yuelao,this.btn_reward,this.btn_bang,this.btn_reward_get,this.btn_one,this.btn_mul,this.btn_xinwu,this.btn_task,this.btn_copy,this.btn_active,this.closebtn0],this.txt_title.textFlow=UtilProxy.StrFormart("C:9&仙缘属性",[]),this.red_one=this.btn_one.getChildAt(2),this.red_mul=this.btn_mul.getChildAt(2),this.red_reward=this.btn_reward.getChildAt(2),this.red_ring=this.btn_xinwu.getChildAt(2),this.red_task=this.btn_task.getChildAt(2),this.red_copy=this.btn_copy.getChildAt(2),this.red_active=this.btn_active.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),XyProxy.ins().getSkillItems(),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpgradeFlower,this.onLvupUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanGetInfo,this.onGetInfoUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpdateXianyuanAward,this.onAwardUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpgradeRing,this.onRingUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpgradeSkill,this.onSkillUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpdateTaskList,this.onTaskUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpdateCopyInfo,this.onCopyTimesUpdate);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.red_one.visible=XyProxy.ins().getFlowerRed(),this.red_mul.visible=XyProxy.ins().getFlowerRed(),this.red_reward.visible=XyProxy.ins().getRewardRed(),this.red_ring.visible=XyProxy.ins().getRingRed(),this.red_task.visible=XyProxy.ins().getTaskRed(),this.red_copy.visible=XyProxy.ins().getCopyRed(),this.red_active.visible=XyProxy.ins().getActiveRed(),this.updateInfo(),this.btn_reward.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpgradeFlower,this.onLvupUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanGetInfo,this.onGetInfoUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpdateXianyuanAward,this.onAwardUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpgradeRing,this.onRingUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpgradeSkill,this.onSkillUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpdateTaskList,this.onTaskUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpdateCopyInfo,this.onCopyTimesUpdate);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_jiechu:ViewManager.ins().open(XyLhView);break;case this.btn_yuelao:ViewManager.ins().open(XyylView);break;case this.btn_reward:this.gp_reward.visible=!0,this.updateTips();break;case this.btn_bang:break;case this.btn_one:case this.btn_mul:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&你好像没有结婚");if(this.next_data)if(XyProxy.ins().flower_Info.exp>=this.next_data.exp){var i=t.currentTarget==this.btn_one?1:2;XyProxy.ins().C2SReqXianyuanUpgradeFlower(i)}else TipsControl.ins().showTips("C:4&仙缘值不足");else TipsControl.ins().showTips("C:10&已满级");break;case this.btn_xinwu:ViewManager.ins().open(XyRingView);break;case this.btn_task:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&结婚方可打开");ViewManager.ins().open(XyTaskView);break;case this.btn_copy:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&结婚方可打开");ViewManager.ins().open(XyCopyView);break;case this.btn_active:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&结婚方可打开");ViewManager.ins().open(XyActiveView);break;case this.closebtn0:this.gp_reward.visible=!1;break;case this.btn_reward_get:var n=GlobalConfig.getXyMiscData().grade_need_flower,o=Math.floor(XyProxy.ins().flower_Info.level/n);o>XyProxy.ins().award_index?XyProxy.ins().C2SReqXianyuanGetXianyuanAward(XyProxy.ins().award_index+1):TipsControl.ins().showTips("C:4&仙缘不够等级")}},e.prototype.updateInfo=function(){if(!this.movie_left){this.movie_left=new MovieClip;var t=GrowupProxy.ins().fashion_wear,e=RoleProxy.ins().GetOtherUIModel(t,RoleProxy.ins().getProf());this.movie_left.playFile(UI_CLOTH_DIR+e,-1),this.movie_left.x=120,this.movie_left.y=420,this.movie_left.scaleX=this.movie_left.scaleY=.9,this.ui_model.addChild(this.movie_left),this.txt_left_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[RoleProxy.ins().getRoleName()])}if(!this.movie_right&&XyProxy.ins().is_marry&&XyProxy.ins().right_info){this.movie_right=new MovieClip;var t=XyProxy.ins().right_info.fashion_id,e=RoleProxy.ins().GetOtherUIModel(t,XyProxy.ins().right_info.prof);this.movie_right.playFile(UI_CLOTH_DIR+e,-1),this.movie_right.x=360,this.movie_right.y=420,this.movie_right.scaleX=this.movie_right.scaleY=.9,this.ui_model.addChild(this.movie_right),this.txt_right_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[XyProxy.ins().right_info.name])}var i=GlobalConfig.getXyMiscData().grade_need_flower,n=XyProxy.ins().flower_Info.level%i,o=Math.floor(XyProxy.ins().flower_Info.level/i);this.bar.labelDisplay.visible=!1;for(var s=0;s<this.star_list.length;s++)this.star_list[s].source=n>s?"xianyuan_xin_2":"xianyuan_xin_1";var r=GlobalConfig.getXyFlowerById(XyProxy.ins().flower_Info.level),a=GlobalConfig.getXyFlowerById(XyProxy.ins().flower_Info.level+1);if(this.next_data=a,XyProxy.ins().is_marry?this.txt_day.textFlow=UtilProxy.StrFormart("C:1&已结婚：@0 天",[XyProxy.ins().getMarryDay()]):this.txt_day.textFlow=UtilProxy.StrFormart("C:4&未结婚",[]),this.txt_fight.text=UtilProxy.GetAttrFight(r).toString(),r){this.active_go.visible=!0;for(var h=AttrProxy.getAttrInfo(r),l="",s=0;s<h.length;s++)s>0&&(l+="\r\n"),l+=UtilProxy.getStr("|C:1&@0 +@1 ",[h[s][2],h[s][1]]);this.txt_pro.textFlow=UtilProxy.StrFormart(l,[]),this.txt_lv.textFlow=UtilProxy.StrFormart("C:5&相遇心锁：@0 ",[o])}else this.active_go.visible=!1;a?(this.bar.maximum=a.exp,this.bar.value=parseInt(XyProxy.ins().flower_Info.exp),this.txt_bar_val.textFlow=UtilProxy.StrFormart("C:1&仙缘值：@0 /@1 ",[XyProxy.ins().flower_Info.exp,a.exp])):(this.bar.maximum=r.exp,this.bar.value=r.exp,this.txt_bar_val.textFlow=UtilProxy.StrFormart("C:7&已满级",[]))
},e.prototype.updateTips=function(){var t=XyProxy.ins().award_index,e=GlobalConfig.getXyMiscData().grade_need_flower,i=Math.floor(XyProxy.ins().flower_Info.level/e),n=GlobalConfig.getXyRewardById(t+1);if(this.tips_next_data=n,n)i>t?(this.btn_reward_get.visible=!0,this.title1.text=""):(this.btn_reward_get.visible=!1,this.title1.textFlow=UtilProxy.StrFormart("仙缘达到|C:4&@0 |级可领取奖励",[n.grade])),this.btn_reward_get.touchEnabled=!0,this.tips_array||this.showTipsList(n);else{this.btn_reward_get.visible=!1,this.title1.text="已满级";var o=GlobalConfig.getXyRewardById(t);this.showTipsList(o)}},e.prototype.showTipsList=function(t){this.tips_array=new eui.ArrayCollection;for(var e=0;e<t.award.length;e++){var i=new ItemCellData;i.setItemCellData({item_slot_idx:0,item_type_id:t.award[e][0],item_count:t.award[e][1]}),this.tips_array.addItem(i)}this.item_list.dataProvider=this.tips_array},e.prototype.onAwardUpdate=function(){this.gp_reward.visible&&this.updateTips(),this.red_reward.visible=XyProxy.ins().getRewardRed()},e.prototype.onLvupUpdate=function(){UtilProxy.GetMovieClipById(19,this.eff),this.updateInfo(),this.red_one.visible=this.red_mul.visible=XyProxy.ins().getFlowerRed()},e.prototype.onRingUpdate=function(){this.red_ring.visible=XyProxy.ins().getRingRed()},e.prototype.onSkillUpdate=function(){this.red_ring.visible=XyProxy.ins().getRingRed()},e.prototype.onTaskUpdate=function(){this.red_task.visible=XyProxy.ins().getTaskRed()},e.prototype.onCopyTimesUpdate=function(){this.red_copy.visible=XyProxy.ins().getCopyRed(),this.red_active.visible=XyProxy.ins().getActiveRed()},e.prototype.onGetInfoUpdate=function(){this.updateInfo(),this.red_one.visible=XyProxy.ins().getFlowerRed(),this.red_mul.visible=XyProxy.ins().getFlowerRed(),this.red_reward.visible=XyProxy.ins().getRewardRed(),this.red_ring.visible=XyProxy.ins().getRingRed(),this.red_task.visible=XyProxy.ins().getTaskRed(),this.red_copy.visible=XyProxy.ins().getCopyRed(),this.red_active.visible=XyProxy.ins().getActiveRed()},e.prototype.getFightNum=function(){var t=0;return t},e}(BaseEuiView);__reflect(XianYuanView.prototype,"XianYuanView"),ViewManager.ins().reg(XianYuanView,LayerManager.UI_Main),window.XianYuanView=XianYuanView;var XyActiveEndView=function(t){function e(){var e=t.call(this)||this;return e.num=6,e.skinName="XyActiveEndSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list_reward.itemRenderer=ItemCell,this.txt_remark.textFlow=UtilProxy.StrFormart("以上奖励可在|C:4&邮件|中领取",[])},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.black,this.close),this.updateInfo()},e.prototype.close=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.removeTouchEvent(this.black,this.close),ViewManager.ins().close(e)},e.prototype.onClick=function(t){t.currentTarget},e.prototype.doTimer=function(){this.num-=1,this.txt_time.text=UtilProxy.getStr("@0 秒后自动关闭",[this.num]),this.num<=0&&ViewManager.ins().close(e)},e.prototype.updateInfo=function(){if(this.doTimer(),this.txt_time.text=UtilProxy.getStr("@0 秒后自动关闭",[this.num]),TimerManager.ins().doTimer(1e3,5,this.doTimer,this),!this.array){var t=GlobalConfig.getXyMiscData().xunyou_award;this.array=new eui.ArrayCollection;for(var e=0;e<t.length;e++){var i=t[e],n=new ItemCellData;n.setItemCellData({item_slot_idx:0,item_type_id:i[0],item_count:i[1]}),this.array.addItem(n)}this.list_reward.dataProvider=this.array}},e}(BaseEuiView);__reflect(XyActiveEndView.prototype,"XyActiveEndView"),ViewManager.ins().reg(XyActiveEndView,LayerManager.UI_Main2),window.XyActiveEndView=XyActiveEndView;var XyActiveView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyActiveSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.btn_list=[this.btn_close,this.btn_add,this.btn_qq],this.list.itemRenderer=ItemCell,this.txt_title.textFlow=UtilProxy.StrFormart("C:10&婚车巡游",[]),this.txt_cost_title.textFlow=UtilProxy.StrFormart("C:10&巡游费用：",[]),this.red=this.btn_qq.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpdateCopyInfo,this.onCopyTimesUpdate);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.red.visible=XyProxy.ins().getActiveRed(),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpdateCopyInfo,this.onCopyTimesUpdate);for(var i=0;i<this.btn_list.length;i++)this.addTouchEvent(this.btn_list[i],this.onClick);0!=this.handle&&clearInterval(this.handle)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_qq:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&结婚了才可以巡游啊");if(this.sub_times<=0)return void TipsControl.ins().showTips("C:4&巡游次数不足");var i=GlobalConfig.getXyMiscData();if(i.xunyou_cost_money.length>0){var n=i.xunyou_cost_money[0],o=i.xunyou_cost_money[1];if(RoleProxy.ins().getMoneyAttr(n)<o)return void TipsControl.ins().showTips("C:4&货币不足")}if(!GameLogic.ins().isMainScene())return void TipsControl.ins().showTips("当前处于副本或活动中，不能进行巡游");this.go_match.visible=!0,LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),this.updateTips();break;case this.btn_add:var s=GlobalConfig.getXyMiscData();if(XyProxy.ins().getCopyBuyTimes(2)>=s.xunyou_buy_times)return void TipsControl.ins().showTips("C:4&今日次数已满");var r=s.xunyou_money,a=BagProxy.ins().getItemName(r[0]),h=RoleProxy.ins().getMoneyAttr(r[0])<r[1]?4:7,l=UtilProxy.getStr("确定花费|C:@0 &@1 |@2 购买一次巡游次数吗",[h,r[1],a]);TipsControl.ins().ShowTips1(l,function(){},function(){var t=RoleProxy.ins().getMoneyAttr(r[0]);return t<r[1]?void TipsControl.ins().showTips("C:4&货币不足"):void XyProxy.ins().C2SReqXianyuanBuyCopyTimes(2)})}},e.prototype.updateInfo=function(){if(!this.array){var t=GlobalConfig.getXyMiscData().xunyou_award;this.array=new eui.ArrayCollection;for(var e=0;e<t.length;e++){var i=t[e],n=new ItemCellData;n.setItemCellData({item_slot_idx:0,item_type_id:i[0],item_count:i[1]}),this.array.addItem(n)}this.list.dataProvider=this.array}this.txt_remark.textFlow=UtilProxy.StrFormart("@0 ",[GlobalConfig.getXyMiscData().xunyou_remark]);var o=GlobalConfig.getXyMiscData();if(o.xunyou_cost_money.length>0){this.gp_cost.visible=!0;var s=o.xunyou_cost_money[0],r=RoleProxy.ins().getMoneyAttr(s),a=o.xunyou_cost_money[1];this.cost_id=s,this.cost_sum=a,this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[a>r?4:7,a])}else this.gp_cost.visible=!1;var h=o.xunyou_times+XyProxy.ins().getCopyBuyTimes(2)-XyProxy.ins().getCopyUseTimes(2),l=o.xunyou_times;this.sub_times=h,this.txt_num.textFlow=UtilProxy.StrFormart("C:10&巡游次数：|C:@0 &@1 /@2 ",[0==h?4:7,h,l])},e.prototype.onCopyTimesUpdate=function(){this.updateInfo(),this.red.visible=XyProxy.ins().getActiveRed()},e.prototype.updateTips=function(){var t=this;this.cancelBtn.visible=!1;var i=MathUtils.getRandom(2,5);MathUtils.getRandom(2,5);this.matchNum.source="zudui_font_shuzi_0"+i.toString(),this.roleIcon0.source=1==RoleProxy.ins().getProf()?"common_morentouxaing_01":"common_morentouxaing_02",this.roleName0.textFlow=UtilProxy.StrFormart("C:10&@0 ",[RoleProxy.ins().getRoleName()]),this.roleFight0.textFlow=UtilProxy.StrFormart("C:1&战斗力：@0 ",[RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING)]),this.roleIcon1.visible=!1,this.roleName1.text=this.roleFight1.text="",this.txt_time_remark.text="等待仙侣加入";var n=XyProxy.ins().right_info;LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),this.handle=setInterval(function(){i>0&&(t.matchNum.source="zudui_font_shuzi_0"+i.toString(),i-=1,0>=i&&(t.roleIcon1.visible=!0,t.roleIcon1.source=1==n.prof?"common_morentouxaing_01":"common_morentouxaing_02",t.roleName1.textFlow=UtilProxy.StrFormart("C:10&@0 ",[n.name]),t.roleFight1.textFlow=UtilProxy.StrFormart("C:1&战斗力：@0 ",[XyProxy.ins().xy_fight]),clearInterval(t.handle),XyProxy.ins().C2SReqXianyuanEnterXianyuanCopy(2),ViewManager.ins().close(e),ViewManager.ins().close(XianYuanView)))},1e3)},e}(BaseEuiView);__reflect(XyActiveView.prototype,"XyActiveView"),ViewManager.ins().reg(XyActiveView,LayerManager.UI_Main2),window.XyActiveView=XyActiveView;var XyCopyView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyCopySkin",e.txt_title.textFlow=UtilProxy.StrFormart("C:10&仙缘副本",[]),e.btn_list=[e.btn_close,e.btn_add,e.btn_qq,e.cancelBtn],e.list.itemRenderer=ItemCell,e.red=e.btn_qq.getChildAt(2),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpdateCopyInfo,this.onCopyTimesUpdate);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.red.visible=XyProxy.ins().getCopyRed(),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpdateCopyInfo,this.onCopyTimesUpdate);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick);0!=this.handle&&clearInterval(this.handle)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_qq:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&事实上，有仙侣才可以进入该副本");var i=GlobalConfig.getXyMiscData(),n=i.xianyuan_times+XyProxy.ins().getCopyBuyTimes(1)-XyProxy.ins().getCopyUseTimes(1);if(0>=n)return void TipsControl.ins().showTips("C:4&副本次数不足!");if(!GameLogic.ins().isMainScene())return void TipsControl.ins().showTips("当前处于副本或活动中，不能进行挑战");this.go_match.visible=!0,LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),this.updateTips();break;case this.cancelBtn:this.go_match.visible=!1,clearInterval(this.handle);break;case this.btn_add:var o=GlobalConfig.getXyMiscData().xianyuan_money,s=BagProxy.ins().getItemName(o[0]),r=RoleProxy.ins().getMoneyAttr(o[0])<o[1]?4:7,a=UtilProxy.getStr("确定花费|C:@0 &@1 |@2 购买一次副本次数",[r,o[1],s]);TipsControl.ins().ShowTips1(a,function(){},function(){var t=RoleProxy.ins().getMoneyAttr(o[0]);return t<o[1]?void TipsControl.ins().showTips("C:4&货币不足"):void XyProxy.ins().C2SReqXianyuanBuyCopyTimes(1)})}},e.prototype.updateInfo=function(){if(!this.array){var t=GlobalConfig.getXyMiscData().xianyuan_award;this.array=new eui.ArrayCollection;for(var e=0;e<t.length;e++){var i=t[e],n=new ItemCellData;n.setItemCellData({item_slot_idx:0,item_type_id:i[0],item_count:i[1]}),this.array.addItem(n)}this.list.dataProvider=this.array}this.txt_remark.textFlow=UtilProxy.StrFormart("@0 ",[GlobalConfig.getXyMiscData().xianyuan_remark]);var o=GlobalConfig.getXyMiscData(),s=o.xianyuan_times+XyProxy.ins().getCopyBuyTimes(1)-XyProxy.ins().getCopyUseTimes(1);this.txt_num.textFlow=UtilProxy.StrFormart("C:10&剩余次数：|C:7&@0 |C:10&次",[s])},e.prototype.onCopyTimesUpdate=function(){this.updateInfo(),this.red.visible=XyProxy.ins().getCopyRed()},e.prototype.updateTips=function(){var t=this,i=MathUtils.getRandom(2,5),n=MathUtils.getRandom(2,5);this.matchNum.source="zudui_font_shuzi_0"+i.toString(),this.roleIcon0.source=1==RoleProxy.ins().getProf()?"common_morentouxaing_01":"common_morentouxaing_02",this.roleName0.textFlow=UtilProxy.StrFormart("C:10&@0 ",[RoleProxy.ins().getRoleName()]),this.roleFight0.textFlow=UtilProxy.StrFormart("C:1&战斗力：@0 ",[RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING)]),this.roleIcon1.visible=!1,this.roleName1.text=this.roleFight1.text="",this.txt_time_remark.text="等待仙侣加入";var o=XyProxy.ins().right_info;LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),this.handle=setInterval(function(){if(i>0?(t.matchNum.source="zudui_font_shuzi_0"+i.toString(),i-=1,0>=i&&(t.txt_time_remark.text="正在进入仙侣副本",t.roleIcon1.visible=!0,t.roleIcon1.source=1==o.prof?"common_morentouxaing_01":"common_morentouxaing_02",t.roleName1.textFlow=UtilProxy.StrFormart("C:10&@0 ",[o.name]),t.roleFight1.textFlow=UtilProxy.StrFormart("C:1&战斗力：@0 ",[XyProxy.ins().xy_fight]),t.matchNum.source="zudui_font_shuzi_0"+n.toString())):(t.matchNum.source="zudui_font_shuzi_0"+n.toString(),n-=1),0>=n){clearInterval(t.handle);var s=GlobalConfig.getXyCopyDataById(2);s&&(CopyProxy.ins().C2SReqCopyEnterCopy(s.copy_id),ViewManager.ins().close(e),ViewManager.ins().close(XianYuanView))}},1e3)},e}(BaseEuiView);__reflect(XyCopyView.prototype,"XyCopyView"),ViewManager.ins().reg(XyCopyView,LayerManager.UI_Main2),window.XyCopyView=XyCopyView;var XyLhView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="XyLhSkin",this.txt_title.textFlow=UtilProxy.StrFormart("C:10&离婚",[]),this.txt_title2.textFlow=UtilProxy.StrFormart("C:1&您需满足以下任意条件才可以离婚：",[]),this.btn_list=[this.btn_close,this.btn_qq]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_qq:TipsControl.ins().ShowTips1("|C:10&确定离婚否",function(){},this.onOk)}},e.prototype.onOk=function(){if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&仍没有结婚");var t=GlobalConfig.getXyMiscData(),i=RoleProxy.ins().getMoneyAttr(t.divorce_money[0]),n=t.divorce_money[1];if(n>i)return void TipsControl.ins().showTips("C:4&货币不足");var o=XyProxy.ins().getMarryDay(),s=t.min_marry_day;return s>o?void TipsControl.ins().showTips("C:4&结婚天数不足"):(XyProxy.ins().C2SReqXianyuanDivorce(),ViewManager.ins().close(e),void ViewManager.ins().close(XianYuanView))},e.prototype.updateInfo=function(){var t=GlobalConfig.getXyMiscData();if(t){var e=RoleProxy.ins().getMoneyAttr(t.divorce_money[0]),i=t.divorce_money[1],n=i>e?4:7,o=XyProxy.ins().getMarryDay(),s=t.min_marry_day,r=s>o?4:7;this.txt_coin.textFlow=UtilProxy.StrFormart("支付|C:@0 &@1 |元宝才可离婚",[n,i]),this.txt_day.textFlow=UtilProxy.StrFormart("结婚超过|C:@0 &@1 |天才可离婚",[r,s])}},e}(BaseEuiView);__reflect(XyLhView.prototype,"XyLhView"),ViewManager.ins().reg(XyLhView,LayerManager.UI_Main2),window.XyLhView=XyLhView;var XyPublishView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyPublishSkin",e.txt_title.textFlow=UtilProxy.StrFormart("C:10&发布招亲",[]),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.tips_title.textFlow=UtilProxy.StrFormart("C:10&发布招亲",[]),this.btn_list=[this.btn_close,this.btn_xq,this.btn_zq,this.tips_close,this.btn0,this.btn1];for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_xq:this.id=1,this.tips.visible=!0,this.btn0.label="删除文本",this.input_remark.enabled=!0,this.input_remark.text="请输入相亲宣言";break;case this.btn_zq:TipsControl.ins().showTips("功能暂未开放");break;case this.tips_close:this.tips.visible=!1;break;case this.btn0:1==this.id?this.input_remark.text="":this.tips.visible=!1;break;case this.btn1:1==this.id?XyProxy.ins().C2SReqXianyuanPostXiangqin(0,this.input_remark.text):XyProxy.ins().C2SReqXianyuanPostZhaoqin(),this.tips.visible=!1,ViewManager.ins().close(e)}},e.prototype.updateInfo=function(){var t=GlobalConfig.getXyMiscData();this.txt_xq.textFlow=UtilProxy.StrFormart(t.xiangqin_remark,[]),this.txt_zq.textFlow=UtilProxy.StrFormart(t.zhaoqin_remark,[])},e}(BaseEuiView);__reflect(XyPublishView.prototype,"XyPublishView"),ViewManager.ins().reg(XyPublishView,LayerManager.UI_Main2),window.XyPublishView=XyPublishView;var XyQhView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyQhSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.btn_list=[this.btn_close,this.btn_qq,this.btn_no,this.btn_confuse,this.btn_look,this.btn_ok]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.type=e[0],this.left_data=e[1],this.right_data=e[2],this.param=e,this.misc_data=GlobalConfig.getXyMiscData(),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick);XyProxy.ins().checkQh()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_qq:if(BagProxy.ins().getItemCountById(this.misc_data.better_marry_item[0])<this.misc_data.better_marry_item[1])return TipsControl.ins().showTips("C:4&道具不足"),void TipsControl.ins().ShowPathTips(this.misc_data.better_marry_item[0]);XyProxy.ins().C2SReqXianyuanReqMarry(this.right_data.id,this.right_data.role_id),TipsControl.ins().showTips("C:10&成功发送求婚请求"),ViewManager.ins().close(e);break;case this.btn_confuse:ViewManager.ins().close(e);break;case this.btn_look:ViewManager.ins().close(e),ViewManager.ins().open(XianYuanView);break;case this.btn_no:XyProxy.ins().C2SReqXianyuanReplyMarry(0,this.param[3]),ViewManager.ins().close(e);break;case this.btn_ok:XyProxy.ins().C2SReqXianyuanReplyMarry(1,this.param[3]),ViewManager.ins().close(e)}},e.prototype.updateInfo=function(){if(1==this.type){this.updateIcon(),this.gp_main.visible=!0,this.gp_confuse.visible=!1,this.txt_title.textFlow=UtilProxy.StrFormart("C:1&求婚信物",[]),this.txt_remark.text="";var t=new ItemCellData,e={is_tips:!0,item_slot_idx:0,item_type_id:this.misc_data.better_marry_item[0],item_count:this.misc_data.better_marry_item[1]};t.setItemCellData(e),this.item.data=t,this.btn_qq.visible=this.btn_close.visible=this.item.visible=!0,this.btn_no.visible=this.btn_ok.visible=this.btn_look.visible=!1}else if(2==this.type)this.updateIcon(),this.gp_main.visible=!0,this.gp_confuse.visible=!1,this.item.visible=!1,this.txt_title.text="",this.txt_remark.textFlow=UtilProxy.StrFormart("C:7&@0 |请求与你结为仙侣，是否同意",[this.left_data.name]),this.btn_qq.visible=this.btn_close.visible=this.btn_look.visible=this.item.visible=!1,this.btn_no.visible=this.btn_ok.visible=!0;else if(3==this.type){this.txt_title.text="";var i=this.param[3];if(3==i)this.gp_confuse.visible=!0,this.gp_main.visible=!1,this.txt_confuse.textFlow=UtilProxy.StrFormart("C:4&@0 |已心有所属，拒绝了您的求婚！\r\n道友请勿言弃，心诚必能再觅佳偶！",[]);else if(1==i||2==i){this.updateIcon(),this.gp_main.visible=!0,this.gp_confuse.visible=!1;for(var n=0;n<this.btn_list.length;n++)this.btn_list[n].visible=!1;this.btn_look.visible=!0,this.item.visible=!1;var o="";1==this.param[3]?o+="您答应了|C:10&@0 |的求婚！":2==this.param[3]&&(o+="|C:10&@0 |答应了您的求婚 "),o+="\r\n恭喜天造地设的你们订婚成功，现在就开始属于你们的一段仙缘，真是羡煞旁人！",this.txt_remark.textFlow=UtilProxy.StrFormart(o,[this.param[4]])}else if(4==i||5==i){this.updateIcon(),this.gp_main.visible=!0,this.gp_confuse.visible=!1;for(var n=0;n<this.btn_list.length;n++)this.btn_list[n].visible=!1;this.btn_look.visible=!0,this.item.visible=!1;var o="";this.txt_remark.textFlow=UtilProxy.StrFormart("比武招亲结束，恭喜您与|C:10&@0 |结为夫妻!",[this.param[4]])}}},e.prototype.updateIcon=function(){this.bg0.source=XyProxy.ins().getTitleBg(this.left_data.use_head_id),this.icon0.source=XyProxy.ins().getTitleIcon(this.left_data.use_head_id,this.left_data.prof),this.icon1.source=XyProxy.ins().getTitleIcon(this.right_data.use_head_id,this.right_data.prof),this.bg1.source=XyProxy.ins().getTitleBg(this.right_data.use_head_id),this.txt_name0.textFlow=UtilProxy.StrFormart("C:1&@0 ",[this.left_data.name]),this.txt_name1.textFlow=UtilProxy.StrFormart("C:1&@0 ",[this.right_data.name])},e}(BaseEuiView);__reflect(XyQhView.prototype,"XyQhView"),ViewManager.ins().reg(XyQhView,LayerManager.UI_Main2),window.XyQhView=XyQhView;var XyRingTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyRingTips",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.txt_title0.textFlow=UtilProxy.StrFormart("C:10&信物属性",[]),this.txt_title1.textFlow=UtilProxy.StrFormart("C:10&仙缘属性",[]),this.txt_title2.textFlow=UtilProxy.StrFormart("C:10&婚戒技能",[])},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick)},e.prototype.onClick=function(t){ViewManager.ins().close(e)},e.prototype.updateInfo=function(){var t=XyProxy.ins().ring_data,e=XyProxy.ins().getRingData(t.ring_type,t.level);if(e){this.icon.source=e.icon.toString(),this.txt_name.textFlow=UtilProxy.StrFormart("C:4&@0  Lv.@1 ",[e.name,t.level]),this.txt_fight.textFlow=UtilProxy.StrFormart("C:1&战斗力：@0 ",[UtilProxy.GetAttrFight(e).toString()]),this.name_left.textFlow=UtilProxy.StrFormart("C:7&@0 ",[RoleProxy.ins().getRoleName()]),XyProxy.ins().right_info?this.name_right.textFlow=UtilProxy.StrFormart("C:7&@0 ",[XyProxy.ins().right_info.name]):this.name_right.text="";for(var i=AttrProxy.getAttrInfo(e),n="",o=0;o<i.length;o++)o>0&&(n+="\r\n"),n+=UtilProxy.getStr("|C:1&    @0 ：+@1 ",[i[o][2],i[o][1]]);this.txt_remark0.textFlow=UtilProxy.StrFormart(n,[]);var s=XyProxy.ins().flower_Info.level;if(s>0){n="";var r=GlobalConfig.getXyFlowerById(s);i=AttrProxy.getAttrInfo(r);for(var o=0;o<i.length;o++)o>0&&(n+="\r\n"),n+=UtilProxy.getStr("|C:1&    @0 ：+@1 ",[i[o][2],i[o][1]]);this.txt_remark1.textFlow=UtilProxy.StrFormart(n,[])}else this.txt_remark1.text="";n="";for(var o=0;5>o;o++){var a=XyProxy.ins().getSkillLv(o+1),h=GlobalConfig.getXySkillById(o+1,a||1);o>0&&(n+="\r\n"),n+=a>0?UtilProxy.getStr("|    @0 |C:7& Lv@1 .|@2 ",[h.name,a,h.remark]):UtilProxy.getStr("|C:11&    @0  Lv@1 ",[h.name,a])}this.txt_remark2.textFlow=UtilProxy.StrFormart(n,[])}},e}(BaseEuiView);__reflect(XyRingTipsView.prototype,"XyRingTipsView"),ViewManager.ins().reg(XyRingTipsView,LayerManager.UI_Main2),window.XyRingTipsView=XyRingTipsView;var XyRingView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyRingSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_xinwu"),this.skill_list=[],this.skill_obj_list=[];for(var e=0;e<this.skill_go.numChildren;e++){var i={},n=this.skill_go.getChildAt(e);i.root=n,i.bg=n.getChildAt(0),i.icon=n.getChildAt(1),i.txt_lv=n.getChildAt(2),this.skill_list.push(i),this.skill_obj_list.push(n)}this.txt_name.textFlow=UtilProxy.StrFormart("C:5&@0 ",["仙缘婚戒"]),this.btn_list=[this.btn_close,this.btn_bang,this.btn_ring,this.btn_one,this.btn_mul,this.item,this.btn_menu0,this.btn_menu1,this.btn_menu2],this.red_one=this.btn_one.getChildAt(2),this.red_mul=this.btn_mul.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.close(),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpgradeRing,this.onLvUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpgradeSkill,this.onSkillUpdate);for(var n=0;n<this.skill_list.length;n++)this.addTouchEvent(this.skill_list[n].root,this.onClick);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.red_one.visible=this.red_mul.visible=XyProxy.ins().getRinglvupRed(),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpgradeRing,this.onLvUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpgradeSkill,this.onSkillUpdate);for(var i=0;i<this.skill_list.length;i++)this.removeTouchEvent(this.skill_list[i].root,this.onClick);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_bang:break;case this.btn_ring:break;case this.btn_one:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&你没有结婚,sorry");BagProxy.ins().getItemCountById(this.item_id)>0?XyProxy.ins().C2SReqXianyuanUpgradeRing(1):TipsControl.ins().showTips("C:4&道具不足");break;case this.btn_mul:if(!XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&你没有结婚,sorry");BagProxy.ins().getItemCountById(this.item_id)>0?XyProxy.ins().C2SReqXianyuanUpgradeRing(2):TipsControl.ins().showTips("C:4&道具不足");break;case this.btn_menu0:break;case this.btn_menu1:TipsControl.ins().showTips("C:10&功能暂未开发，敬请期待!");break;case this.btn_menu2:TipsControl.ins().showTips("C:10&功能暂未开发，敬请期待!");break;case this.item:ViewManager.ins().open(XyRingTipsView);break;default:var i=this.skill_obj_list.indexOf(t.currentTarget);i>=0&&ViewManager.ins().open(XySkillView,i+1)}},e.prototype.updateInfo=function(){var t=XyProxy.ins().ring_data;if(t){this.btn_ring.visible=!1;var e=XyProxy.ins().getRingData(t.ring_type,t.level),i=XyProxy.ins().getRingData(t.ring_type,t.level+1),n=GlobalConfig.getXyMiscData();if(this.misc_data=n,e){this.movie||(this.movie=new MovieClip,this.ui_model.addChild(this.movie),this.movie.x=240,this.movie.y=380),this.movie.playFile(UI_EFF_DIR+e.eff_id,-1),this.item_movie||(this.item_movie=new MovieClip,this.item.addChild(this.item_movie),this.item_movie.x=34,this.item_movie.y=34),this.item_movie.playFile(UI_EFF_DIR+e.icon_eff,-1),this.txt_fight.text=UtilProxy.GetAttrFight(e).toString(),this.txt_lv.textFlow=UtilProxy.StrFormart("C:1&Lv.@0 ",[t.level]),this.item_icon.source=e.icon.toString();var o=BagProxy.ins().getItemData(n.ring_exp_metrial[0]);if(this.item_id=o.id,this.txt_item_name.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[BagProxy.QUALITY_COLOR[o.quality-1],o.name]),this.txt_num.text=BagProxy.ins().getItemCountById(o.id).toString(),i){var s=GlobalConfig.getXyRingById(t.level+1);this.process.maximum=s.exp,this.process.value=t.exp}else{var s=GlobalConfig.getXyRingById(t.level);this.process.maximum=1,this.process.value=1,this.process.labelDisplay.textFlow=UtilProxy.StrFormart("C:10&已满级",[])}this.updateInfoSkill()}}},e.prototype.onLvUpdate=function(){this.updateInfo(),this.red_one.visible=this.red_mul.visible=XyProxy.ins().getRinglvupRed(),UtilProxy.GetMovieClipById(19,this.eff)},e.prototype.onSkillUpdate=function(){this.updateInfoSkill()},e.prototype.updateInfoSkill=function(){for(var t=0;t<this.skill_list.length;t++){var e=XyProxy.ins().getSkillLv(t+1),i=GlobalConfig.getXySkillById(t+1,e);i||(i=GlobalConfig.getXySkillById(t+1,1));var n=(this.skill_list[t].icon,this.skill_list[t].txt_lv,this.skill_list[t]);n.icon.source=i.icon.toString(),n.icon.alpha=e>0?1:.5,n.txt_lv.textFlow=e>0?UtilProxy.StrFormart("C:5&LV.@0 ",[e]):UtilProxy.StrFormart("",[])}},e}(BaseEuiView);__reflect(XyRingView.prototype,"XyRingView"),ViewManager.ins().reg(XyRingView,LayerManager.UI_Main2),window.XyRingView=XyRingView;var XySkillView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XySkillSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.txt_cur_title.textFlow=UtilProxy.StrFormart("C:10&当前效果",[]),this.txt_next_title.textFlow=UtilProxy.StrFormart("C:10&下级效果",[]),this.red=this.btn_qq.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpgradeSkill,this.onLvupCallBack),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_qq,this.onClick),this.id=e[0],this.red.visible=XyProxy.ins().getRedBySkillId(this.id),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpgradeSkill,this.onLvupCallBack),this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_qq,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_qq:if(this.next_data){var i=XyProxy.ins().ring_data.level;if(i<this.next_data.ring_level)return void TipsControl.ins().showTips("C:4&婚戒等级不足");for(var n=0;n<this.next_data.items.length;n++){var o=this.next_data.items[n][0],s=this.next_data.items[n][1];if(BagProxy.ins().getItemCountById(o)<s)return void TipsControl.ins().showTips("C:4&道具不足")}XyProxy.ins().C2SReqXianyuanUpgradeSkill(this.id)}else TipsControl.ins().showTips("C:4&已满级")}},e.prototype.updateInfo=function(){var t=XyProxy.ins().getSkillLv(this.id),e=GlobalConfig.getXySkillById(this.id,t),i=GlobalConfig.getXySkillById(this.id,t+1);if(this.next_data=i,this.btn_qq.visible=!0,e)this.txt_cur_remark.textFlow=UtilProxy.StrFormart(e.remark,[]),this.txt_name.textFlow=UtilProxy.StrFormart("C:10&@0   Lv.@1 ",[e.name,t]);else{this.cost_go.visible=this.btn_qq.visible=!1,this.txt_cur_remark.textFlow=UtilProxy.StrFormart("C:4&未激活",[]);var n=i.ring_level;this.txt_lvup.textFlow=UtilProxy.StrFormart("激活条件：仙缘婚戒|C:@0 & LV.@1 ",[n>t?4:7,n]),this.txt_name.textFlow=UtilProxy.StrFormart("C:10&@0   (未激活) ",[i.name])}if(i){var n=i.ring_level;if(this.txt_next_remark.textFlow=UtilProxy.StrFormart(i.remark,[]),t>0){this.cost_go.visible=this.btn_qq.visible=!0,this.txt_lvup.textFlow=UtilProxy.StrFormart("升级条件：仙缘婚戒|C:@0 & LV.@1 ",[XyProxy.ins().ring_data.level<n?4:7,n]);var o=i.items[0][0],s=i.items[0][1],r=BagProxy.ins().getItemCountById(o),a=r>=s?7:4;this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 /@2 ",[a,r,s])}this.icon.source=i.icon.toString()}else this.cost_go.visible=this.btn_qq.visible=!1,this.txt_lvup.textFlow=UtilProxy.StrFormart("C:7&已满级",[]),this.icon.source=e.icon.toString()},e.prototype.onLvupCallBack=function(){this.updateInfo(),this.red.visible=XyProxy.ins().getRedBySkillId(this.id),UtilProxy.GetMovieClipById(19,this.eff)},e}(BaseEuiView);__reflect(XySkillView.prototype,"XySkillView"),ViewManager.ins().reg(XySkillView,LayerManager.UI_Main2),window.XySkillView=XySkillView;var XyTaskItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn,this.onClick)},e.prototype.dataChanged=function(){if(this.data){var t=this.data.type,e=this.data.data;this.icon.source=e.icon.toString();var i=UtilProxy.getStr(e.desc,[e.count]);this.txt_title.textFlow=UtilProxy.StrFormart(i,[]),this.txt_re0.textFlow=UtilProxy.StrFormart("C:10&自己",[]),this.txt_re1.textFlow=UtilProxy.StrFormart("C:10&伴侣",[]),this.txt_finish.textFlow=UtilProxy.StrFormart("C:7&已领取",[]),this.bar0.maximum=this.bar1.maximum=e.count;var n=XyProxy.ins().getTaskData(t,e.id);n?(this.bar0.value=n.self_count,this.bar1.value=n.other_count,this.btn.icon=0==n.state?"common_btn_big_blue":"common_btn_big_yellow",this.btn.label=0==n.state?"前往":"领取",this.btn.visible=2!=n.state):(this.bar0.value=0,this.bar1.value=0,this.btn.icon="common_btn_big_blue",this.btn.label="前往",this.btn.visible=!0)}},e.prototype.onClick=function(t){var e=XyProxy.ins().getTaskData(this.data.type,this.data.data.id);e&&1==e.state?XyProxy.ins().C2SReqXianyuanGetTaskAward(this.data.type,this.data.data.id):UtilProxy.openView(this.data.data.openview[0],this.data.data.openview[1])
},e}(BaseItemRender);__reflect(XyTaskItem.prototype,"XyTaskItem"),window.XyTaskItem=XyTaskItem;var XyTaskView=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyTaskSkin",e.txt_remark.textFlow=UtilProxy.StrFormart("C:10&成就进度",[]),e.btn_list=[e.btn_close,e.btn0,e.btn1],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_xianyuanrenwu"),this.btn_list=[this.btn_close,this.btn0,this.btn1],this.list.itemRenderer=XyTaskItem,this.red0=this.btn0.getChildAt(2),this.red1=this.btn1.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),EventProxy.AddListener(this,EventType.S2CRepXianyuanUpdateTaskList,this.onTaskUpdate);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);this.array_task=new eui.ArrayCollection;var o=XyProxy.ins().getTaskList(1);this.length1=0;for(var n=0;n<o.length;n++){this.length1+=1;var s=o[n],r={};r.type=1,r.data=s,this.array_task.addItem(r)}this.array_day=new eui.ArrayCollection,o=XyProxy.ins().getTaskList(2),this.length2=0;for(var n=0;n<o.length;n++){this.length2+=1;var s=o[n],r={};r.type=2,r.data=s,this.array_day.addItem(r)}this.red0.visible=XyProxy.ins().getRedByTaskType(1),this.red1.visible=XyProxy.ins().getRedByTaskType(2),this.updateInfo(1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.S2CRepXianyuanUpdateTaskList,this.onTaskUpdate);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick)},e.prototype.onListMenuTap=function(t){var e=t.itemRenderer.data;this.cur_data=e;var i=XyProxy.ins().getTaskData(e.type,e.data.id);i&&1==i.state?XyProxy.ins().C2SReqXianyuanGetTaskAward(e.type,e.data.id):UtilProxy.openView(e.data.openview[0],e.data.openview[1])},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn0:this.updateInfo(1);break;case this.btn1:this.updateInfo(2)}},e.prototype.updateInfo=function(t){this.page=t,this.btn0.icon=1==this.page?"common_btn_big_yellow":"common_btn_big_yellow_off",this.btn1.icon=1!=this.page?"common_btn_big_yellow":"common_btn_big_yellow_off",this.list.dataProvider=1==t?this.array_task:this.array_day,this.bar.maximum=1==t?this.length1:this.length2,this.bar.value=this.getTaskListValue(t)},e.prototype.getTaskListValue=function(t){var e=XyProxy.ins().getTaskList(t),i=0;for(var n in e){var o=e[n],s=XyProxy.ins().getTaskData(t,o.id);s&&2==s.state&&(i+=1)}return i},e.prototype.onTaskUpdate=function(){if(this.updateInfo(this.page),this.red0.visible=XyProxy.ins().getRedByTaskType(1),this.red1.visible=XyProxy.ins().getRedByTaskType(2),1==this.page){this.array_task.removeAll();for(var t=XyProxy.ins().getTaskList(1),e=0;e<t.length;e++){var i=t[e],n={};n.type=1,n.data=i,this.array_task.addItem(n)}}else{this.array_day.removeAll();for(var t=XyProxy.ins().getTaskList(2),e=0;e<t.length;e++){var i=t[e],n={};n.type=2,n.data=i,this.array_day.addItem(n)}}},e}(BaseEuiView);__reflect(XyTaskView.prototype,"XyTaskView"),ViewManager.ins().reg(XyTaskView,LayerManager.UI_Main2),window.XyTaskView=XyTaskView;var XyylItem1=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyylItemSkin1",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(this.data&&this.visible){if(this.txt_name.textFlow=UtilProxy.StrFormart("C:1&@0  (@1 )",[this.data.name,1==this.data.prof?"男":"女"]),this.txt_title.textFlow=UtilProxy.StrFormart("C:5&征婚宣言",[]),this.data.cfg_id>0){var t=GlobalConfig.getXyRemarkById(this.data.cfg_id);t?this.txt_remark.text=t.desc:this.txt_remark.text=""}else this.txt_remark.textFlow=UtilProxy.StrFormart(this.data.content,[]);var e=GlobalConfig.getSetup_head_dataConfig(this.data.use_head_id);if(e||(e=GlobalConfig.getSetup_head_dataConfig(this.data.prof)),e){this.icon.source=e.icon;var i=GlobalConfig.getSetup_head_frame_dataConfig(this.data.use_head_frame_id);i||(i=GlobalConfig.getSetup_head_frame_dataConfig(1)),i&&(this.bg.source=i.icon,this.txt_vip.text=this.data.vip_level)}}},e}(BaseItemRender);__reflect(XyylItem1.prototype,"XyylItem1"),window.XyylItem1=XyylItem1;var XyylItem2=function(t){function e(){var e=t.call(this)||this;return e.skinName="XyylItemSkin2",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(this.data){if(this.data.fresh_time&&this.init)return void this.updateTime();this.init=!0,this.txt_name.textFlow=UtilProxy.StrFormart("C:1&@0  (@1 )",[this.data.name,1==this.data.prof?"男":"女"]),this.txt_num.textFlow=UtilProxy.StrFormart("C:1&抢亲人数：@0 ",[this.data.opp_count]);var t=GlobalConfig.getSetup_head_dataConfig(this.data.use_head_id);if(t||(t=GlobalConfig.getSetup_head_dataConfig(this.data.prof)),t){this.icon.source=t.icon;var e=GlobalConfig.getSetup_head_frame_dataConfig(this.data.use_head_frame_id);e||(e=GlobalConfig.getSetup_head_frame_dataConfig(1)),e&&(this.bg.source=e.icon,this.txt_vip.text=this.data.vip_level,this.updateTime(),this.btn_qq.visible=this.data.role_id!=RoleProxy.ins().getRoleId())}}},e.prototype.updateTime=function(){var t=this.data.time-GameLogic.ins().getServerTime();0>t&&(t=0,this.btn_qq.visible=!1);var e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_1);this.txt_time.text="剩余时间："+e},e}(BaseItemRender);__reflect(XyylItem2.prototype,"XyylItem2"),window.XyylItem2=XyylItem2;var XyylItem3=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(this.data&&!this.data.fresh_time){this.txt_name.textFlow=UtilProxy.StrFormart("C:1&@0  (@1 )",[this.data.name,1==this.data.prof?"男":"女"]),this.value.textFlow=UtilProxy.StrFormart("C:1&情缘值：@0 ",[this.data.score]);var t=GlobalConfig.getSetup_head_dataConfig(this.data.use_head_id);if(t||(t=GlobalConfig.getSetup_head_dataConfig(this.data.prof)),t){this.icon.source=t.icon;var e=GlobalConfig.getSetup_head_frame_dataConfig(this.data.use_head_frame_id);e||(e=GlobalConfig.getSetup_head_frame_dataConfig(1)),e&&(this.bg.source=e.icon,this.txt_vip.text=this.data.vip_level,this.sort.textFlow=UtilProxy.StrFormart("C:10&排名：@0 ",[this.data.sort]),this.btn_qq.visible=RoleProxy.ins().getRoleId()!=this.data.role_id)}}},e}(BaseItemRender);__reflect(XyylItem3.prototype,"XyylItem3"),window.XyylItem3=XyylItem3;var XyylView=function(t){function e(){var e=t.call(this)||this;return e.maxcount=999,e.buy_num=-1,e.skinName="XyylSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.comview.SetName("title_yuelaomiao"),this.list0.itemRenderer=XyylItem1,this.list2.itemRenderer=XyylItem3,this.btn_list=[this.btn_xq,this.btn_bwzq,this.btn_zq,this.btn_close,this.btn_close1],this.tipbtns=[this.i0,this.i1,this.i2,this.i3]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),EventProxy.AddListener(this,EventType.S2CRepXianyuanGetPostlist,this.onGetInfoUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanPostXiangqin,this.onPostUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanPostZhaoqin,this.onPostUpdate),EventProxy.AddListener(this,EventType.S2CRepXianyuanZhaoqinOppInfo,this.onZqListUpdate),this.list0.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListMenuTap,this),this.list2.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListMenuTap,this);for(var n=0;n<this.btn_list.length;n++)this.addTouchEvent(this.btn_list[n],this.onClick);TimerManager.ins().doTimer(1,0,this.updateTime,this),this.updateInfo(1),this.addTouchEvent(this.enterBtn,this.onBuyClick),this.addTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.addTouchEvent(this.tipsAdd,this.onTipsNumClick),this.addTouchEvent(this.tipsAddten,this.onTipsNumClick),this.addTouchEvent(this.tipsLess,this.onTipsNumClick),this.addTouchEvent(this.tipsLessten,this.onTipsNumClick),this.addTouchEvent(this.canclebuy,this.onCloseTipsClick);for(var n=0;n<this.tipbtns.length;n++)this.addTouchEvent(this.tipbtns[n],this.onItemClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerManager.ins().remove(this.updateTime,this),this.comview.close(),this.id=0,EventProxy.RemoveListener(this,EventType.S2CRepXianyuanGetPostlist,this.onGetInfoUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanPostXiangqin,this.onPostUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanPostZhaoqin,this.onPostUpdate),EventProxy.RemoveListener(this,EventType.S2CRepXianyuanZhaoqinOppInfo,this.onZqListUpdate),this.list0.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListMenuTap,this),this.list2.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListMenuTap,this);for(var i=0;i<this.btn_list.length;i++)this.removeTouchEvent(this.btn_list[i],this.onClick);this.removeTouchEvent(this.enterBtn,this.onBuyClick),this.removeTouchEvent(this.tipscloseBtn,this.onCloseTipsClick),this.removeTouchEvent(this.tipsAdd,this.onTipsNumClick),this.removeTouchEvent(this.tipsAddten,this.onTipsNumClick),this.removeTouchEvent(this.tipsLess,this.onTipsNumClick),this.removeTouchEvent(this.tipsLessten,this.onTipsNumClick),this.removeTouchEvent(this.canclebuy,this.onCloseTipsClick);for(var i=0;i<this.tipbtns.length;i++)this.removeTouchEvent(this.tipbtns[i],this.onItemClick)},e.prototype.onListMenuTap=function(t){var e=t.itemRenderer,i=e.data;if(e instanceof XyylItem1){if(XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&你已经结婚了，请不要三心二意!");var n={};n.role_id=RoleProxy.ins().getRoleId(),n.use_head_id=SetProxy.ins().useHead(),n.use_head_frame_id=SetProxy.ins().useHeadFrame(),n.name=RoleProxy.ins().getRoleName(),n.prof=RoleProxy.ins().getProf();var o=GlobalConfig.getXyMiscData();if(BagProxy.ins().getItemCountById(o.better_marry_item[0])<o.better_marry_item[1]){var s=GlobalConfig.getStore_cellConfigByItemID(o.better_marry_item[0]);return void this.ShowStoreBuyTips(s)}ViewManager.ins().open(XyQhView,1,n,e.data)}else if(e instanceof XyylItem2){if(XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&你已经结婚了，请不要三心二意!");this.gp_fight.visible=!0,this.post_id=i.id,XyProxy.ins().C2SReqXianyuanJoinBattleMarry(i.id,i.role_id)}else e instanceof XyylItem3&&XyProxy.ins().C2SReqXianyuanChooseBattle(this.post_id,i.role_id)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(e);break;case this.btn_xq:this.updateInfo(1);break;case this.btn_bwzq:TipsControl.ins().showTips("功能暂未开放");break;case this.btn_zq:if(XyProxy.ins().is_marry)return void TipsControl.ins().showTips("C:4&你已经结婚了，请不要三心二意!");ViewManager.ins().open(XyPublishView);break;case this.btn_close1:this.gp_fight.visible=!1}},e.prototype.updateTipsInfo=function(){for(var t=new eui.ArrayCollection,e=XyProxy.ins().getFightList(this.post_id),i=0;i<e.length;i++)e[i].role_index=e[i].role_id==RoleProxy.ins().getRoleId()?0:1;e.sort(function(t,e){return t.role_index!=e.role_index?t.role_index-e.role_index:t.score!=e.score?e.score-t.score:void 0});for(var i=0;i<e.length;i++){var n=e[i];n.sort=i+1,t.addItem(n)}this.list2.dataProvider=t},e.prototype.updateTime=function(){if(2==this.id)for(var t=0;t<this.array.length;t++){var e=this.array.source[t];e.fresh_time=!0,this.array.itemUpdated(e)}},e.prototype.updateInfo=function(t){this.id=t,1==this.id?this.list0.itemRenderer=XyylItem1:this.list0.itemRenderer=XyylItem2,this.btn_xq.icon=1==this.id?"common_btn_big_yellow":"common_btn_big_yellow_off",this.btn_bwzq.icon=1!=this.id?"common_btn_big_yellow":"common_btn_big_yellow_off";var e=XyProxy.ins().getPostList(t);this.array||(this.array=new eui.ArrayCollection,this.list0.dataProvider=this.array),this.array.removeAll();for(var i=0;i<e.length;i++){var n=e[i];this.array.addItem(n)}},e.prototype.onGetInfoUpdate=function(){this.updateInfo(this.id)},e.prototype.onPostUpdate=function(){this.updateInfo(this.id)},e.prototype.onZqListUpdate=function(){this.gp_fight.visible&&this.updateTipsInfo()},e.prototype.ShowStoreBuyTips=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.current_store_data=i,this.itemid=this.current_store_data.item_id,this.buy_num=1,this.tips.visible=!0,this.tipsNum.text=""+i.max_buy,this.tipsNum.text=this.buy_num.toString();var n=new ItemCellData,o={item_slot_idx:0,item_type_id:i.item_id,item_count:1};n.setItemCellData(o),this.cell.data=n,this.itemName.textFlow=UtilProxy.generateTextFlow("C:"+BagProxy.getQualityColor(n.itemConfig.quality)+"&"+n.itemConfig.name),this.SetMoneylab();for(var s=BagProxy.ins().getItemData(this.itemid),r=0;r<this.tipbtns.length;r++)if(s.path[r]){this.tipbtns[r].visible=!0,this.tipbtns[r].includeInLayout=!0;var a=GlobalConfig.getPath_dataConfig(s.path[r]);this.tipbtns[r].source=a.icon}else this.tipbtns[r].visible=!1,this.tipbtns[r].includeInLayout=!1},e.prototype.SetMoneylab=function(){this.moneylab.text=(this.current_store_data.price*this.buy_num).toString(),this.tipsNum.text=this.buy_num.toString(),this.countlab.text=UtilProxy.getStr("拥有：@0 ",[BagProxy.ins().getItemCountById(this.current_store_data.item_id)])},e.prototype.onBuyClick=function(t){if(void 0!=this.current_store_data){var e=RoleProxy.ins().getMoneyAttr(this.current_store_data.type);if(e<this.current_store_data.price*this.buy_num)return void TipsControl.ins().showTips("元宝不足！");var i=this.current_store_data.max_buy;if(i>0){var n=StoreProxy.ins().getLimitCount(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id);if(n>=i)return void TipsControl.ins().showTips("已达购买次数上限！")}StoreProxy.ins().C2SReqStoreBuy(Math.floor(this.current_store_data.id/1e3),this.current_store_data.id,this.buy_num),this.tips.visible=!1}},e.prototype.onCloseTipsClick=function(t){this.tips.visible=!1},e.prototype.onTipsNumClick=function(t){if(void 0!=this.current_store_data){var e=this.buy_num;switch(t.currentTarget){case this.tipsAdd:e=Math.min(e+1,this.maxcount);break;case this.tipsAddten:e=Math.min(e+10,this.maxcount);break;case this.tipsLess:e=Math.max(1,e-1);break;case this.tipsLessten:e=Math.max(1,e-10)}this.buy_num=e,this.SetMoneylab()}},e.prototype.onItemClick=function(t){var e=t.currentTarget,i=BagProxy.ins().getItemData(this.itemid),n=i.path[Number(e.name)],o=GlobalConfig.getPath_dataConfig(n);if(RoleProxy.ins().getRoleLv()<o.requiredlevel)return void TipsControl.ins().showTips("等级不足");var s=GlobalConfig.getTplViewConfig(o.view_id);s?ViewManager.ins().open(s.tsScript,o.page_id,o.other_page):TipsControl.ins().showTips("请关注游戏内活动")},e}(BaseEuiView);__reflect(XyylView.prototype,"XyylView"),ViewManager.ins().reg(XyylView,LayerManager.UI_Main),window.XyylView=XyylView;var XiuDianBtn=function(t){function e(){var e=t.call(this)||this;return e.skinName="XiuDianBtnSkin",e.init(),e}return __extends(e,t),Object.defineProperty(e.prototype,"icon",{set:function(t){this.iconDisplay.source=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uiScale",{set:function(t){this.g_ui.scaleX=this.g_ui.scaleY=t},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.g_ui.anchorOffsetX=this.g_ui.width/2,this.g_ui.anchorOffsetY=this.g_ui.height/2},e}(eui.Component);__reflect(XiuDianBtn.prototype,"XiuDianBtn");var XiuDianView=function(t){function e(){var e=t.call(this)||this;return e.groupArr=[],e.btnArr=[],e.lbArr=[],e.cfs=[],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="XiuDianSkin"},e.prototype.initBtn=function(){for(var t=0;t<this.cfs.length;t++){var e=new XiuDianBtn;if(this.groupArr[t].removeChildren(),this.groupArr[t].addChild(e),this.btnArr.push(e),this.addTouchEvent(e,this.onClick),e.icon=this.cfs[t].icon,1==this.cfs[t].word_type){var i=WelfareProxy.ins().getcurSevendayAward();void 0!=i&&(e.icon=i.icon),void 0==WelfareProxy.ins().isSevendayAward()&&this.removeTouchEvent(e,this.onClick)}else if(3==this.cfs[t].word_type){var n=LimitActProxy.ins().GetActivityCfgs(13);for(var o in n)e.icon=n[o].icon[0]}this.addEvent(egret.TouchEvent.TOUCH_BEGIN,e,this.btnEff)}},e.prototype.initLabel=function(){for(var t=0;t<this.cfs.length;t++)switch(this.cfs[t].word_type){case 1:this.lbArr[t].textColor=65310,WelfareProxy.ins().isSevendayAward()?this.lbArr[t].text="今日可领取":this.lbArr[t].text="今日已领取";break;case 2:this.lbArr[t].textColor=65310,BossProxy.ins().isBossLimitCanKill()?this.lbArr[t].text="可挑战":this.lbArr[t].text="已挑战";break;case 3:var e=[];for(var i in TaoZhuangProxy.ins().tz_list)3==TaoZhuangProxy.ins().tz_list[i].active_list.length&&e.push(TaoZhuangProxy.ins().tz_list[i]);var n=GlobalConfig.getTzList(),o=0;for(var i in n)o++;this.lbArr[t].text="进度("+e.length+"/"+o+")";break;case 4:var s=0;for(var i in ZbTaoZhuangProxy.ins().dataMsgInfo)s++;var r=0;for(var i in GlobalConfig.getZbTzList())r++;this.lbArr[t].text="进度("+s+"/"+r+")";break;default:this.lbArr[t].parent.visible=!1}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.groupArr=[this.g_0,this.g_1,this.g_2,this.g_3,this.g_4],this.lbArr=[this.lb_0,this.lb_1,this.lb_2,this.lb_3,this.lb_4];var i=GlobalConfig.getXiuDian_dataConfigs();this.cfs=[];for(var n in i)this.cfs.push(i[n]);this.initBtn(),this.initLabel(),this.btn_baiwan.setEff(!0,45),this.btn_baiwan.setTopInfo(""),LimitActProxy.ins().GetServerOpenDay()<=WelfareProxy.ins().getXiuxianActDay()&&(TimerManager.ins().doTimer(1e3,0,this.updateXiuxianAct,this),this.updateXiuxianAct()),this.addTouchEvent(this.btn_close,this.onClickClose),this.addTouchEvent(this.btn_willStrong,this.onClickBeStronger),this.addTouchEvent(this.btn_baiwan,this.onBaiWanClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.btnEff=function(t){function e(){n.btnArr[i].uiScale=1}var i=this.btnArr.indexOf(t.currentTarget);if(void 0!=i){this.btnArr[i].uiScale=.9,this.once(egret.TouchEvent.TOUCH_END,e,this);var n=this}},e.prototype.onClick=function(t){var i=this.btnArr.indexOf(t.currentTarget);void 0!=i&&(50!=this.cfs[i].openview[0]||SystemOpenProxy.ins().isOpen(1,50)&&void 0!=WelfareProxy.ins().getcurSevendayAward())&&(ViewManager.ins().OpenViewById(this.cfs[i].openview[0],this.cfs[i].openview[1]),ViewManager.ins().close(e))},e.prototype.onClickClose=function(){ViewManager.ins().close(e)},e.prototype.onClickBeStronger=function(){ViewManager.ins().close(e),ViewManager.ins().open(BeStrongerView)},e.prototype.onBaiWanClick=function(){ViewManager.ins().close(e),ViewManager.ins().OpenViewById(43)},e.prototype.updateXiuxianAct=function(){var t=WelfareProxy.ins().getXiuxianActLeftTime();t>=0?this.btn_baiwan.setTopInfo(UtilProxy.getStr("|C:7& @0 |",[UtilProxy.getTimeHSString_2(t)]),12):(this.btn_baiwan.setTopInfo(""),TimerManager.ins().remove(this.updateXiuxianAct,this))},e}(BaseEuiView);__reflect(XiuDianView.prototype,"XiuDianView"),ViewManager.ins().reg(XiuDianView,LayerManager.UI_Main2),window.XiuDianView=XiuDianView,window.XiuDianView=XiuDianView;var ActHallView=function(t){function e(){var e=t.call(this)||this;return e.title_list=["title_xianfu","title_huodongdating","title_richangrenwu","title_xianwei"],e.btn_list=[],e.cur_id=-1,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="XianPanel5Skin",this.comview.initUI(),this.btn_list=[this.menu0,this.menu1,this.menu2,this.menu3],this.list.itemRenderer=XianLimitItem,this.alive_red=this.menu0.getChildAt(2),this.limitact_red=this.menu1.getChildAt(2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),EventProxy.AddListener(this,EventType.S2CRepAlivepointGetReward,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointGet,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointUpdate,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuUpLevel,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CLeitaiGetInfo,this.onActRedVisible),this.alive_red.visible=XiuXianProxy.ins().getAliveRed(),this.limitact_red.visible=XiuXianProxy.ins().getLimitRed(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.menu0,this.onClick),this.addTouchEvent(this.menu1,this.onClick),this.addTouchEvent(this.menu2,this.onClick),this.addTouchEvent(this.menu3,this.onClick);var i=0;t&&t.length>0&&(i=t[0]),this.openPage(i),this.onActRedVisible(),this.setBtnOpen()},e.prototype.close=function(){this.cur_id=-1,this.comview.close(),this.panel_xf.close(),this.panel_dt.close(),this.panelXW.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.menu0,this.onClick),this.removeTouchEvent(this.menu1,this.onClick),this.removeTouchEvent(this.menu2,this.onClick),this.removeTouchEvent(this.menu3,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointGetReward,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointGet,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointUpdate,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuUpLevel,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CLeitaiGetInfo,this.onActRedVisible)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onClick=function(t){var e=this.btn_list.indexOf(t.currentTarget);this.openPage(e)},e.prototype.ShowInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=LimitActProxy.ins().GetServerOpenDay();this.arraylist.removeAll();var e=GlobalConfig.getXianLimitActList();for(var i in e)t>=e[i].open_day&&RoleProxy.ins().getRoleLv()>=e[i].open_lv&&this.arraylist.addItem(e[i])},e.prototype.openPage=function(t){if(this.cur_id!=t&&this.cur_id>=0){switch(this.cur_id){case 0:this.panel_xf.close(),this.panel_xf.visible=!1;break;case 1:this.sv.visible=!1;break;case 2:this.panel_dt.close(),this.panel_dt.visible=!1;break;case 3:this.panelXW.close(),this.panelXW.visible=!1}this.btn_list[this.cur_id].icon="common_btn_big_yellow_off"}switch(this.cur_id=t,t){case 0:this.panel_xf.visible=!0,this.panel_xf.open();break;case 1:this.sv.visible=!0,this.ShowInfo();break;case 2:this.panel_dt.visible=!0,this.panel_dt.open();break;case 3:this.panelXW.visible=!0,this.panelXW.open()}this.btn_list[t].icon="common_btn_big_yellow",this.comview.SetName(this.title_list[t])},e.prototype.onActRedVisible=function(){this.menu1.getChildAt(2).visible=LeitaiProxy.ins().getIsOpen()},e.prototype.onAliveUpdate=function(){this.alive_red.visible=XiuXianProxy.ins().getAliveRed()},e.prototype.setBtnOpen=function(){var t=SystemOpenProxy.ins().isOpen(2,6902,!0);this.menu2.visible=t,this.menu2.includeInLayout=t;var e=SystemOpenProxy.ins().isOpen(2,6903,!0);this.menu3.visible=e,this.menu3.includeInLayout=e},e}(BaseEuiView);__reflect(ActHallView.prototype,"ActHallView"),ViewManager.ins().reg(ActHallView,LayerManager.UI_Main),window.ActHallView=ActHallView;var FindExpItem=function(t){function e(){var e=t.call(this)||this;return e.sum=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn_find,this.onClick)},e.prototype.onClick=function(){if(this.data)if(XiuXianProxy.ins().auto_find){var t=GlobalConfig.getApById(this.data.id);if(!t)return;if(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<t.find_yb*this.data.times)return void TipsControl.ins().showTips("元宝不足");XiuXianProxy.ins().C2SReqAlivepointXianfuFindBack(this.data.id)}else ViewManager.ins().open(FindTipsView,this.data.id,this.data.times)},e.prototype.dataChanged=function(){if(void 0!=this.data){var t=this.data,e=GlobalConfig.getApById(t.id);if(e){var i=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)>0,n=e.vip_award_value[0][0],o=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),s=e.vip_award_value[o];s||(s=e.vip_award_value[e.vip_award_value.length-1]);var r=Math.floor((s[0]-n)/n*100);this.txt_vip.textFlow=UtilProxy.StrFormart("|C:7&(VIP+@0 %)",[r]),this.txt_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[e.title]),this.txt_alive.textFlow=UtilProxy.StrFormart("C:7&@0 仙符经验/次",[e.vip_award_value[0][1]]),this.txt_sum.textFlow=UtilProxy.StrFormart("C:1&可找回@0 仙符经验",[t.times*e.vip_award_value[0][1]]);var a=e.find_yb*t.times;if(i){var h=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.ZHIZUN);h&&(a=Math.ceil(a/100*h.xianfu_discount))}var l=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO),p=a>l?4:7;this.txt_cost.textFlow=UtilProxy.StrFormart("C:@0 &@1 ",[p,a]),this.sum=a}}},e}(BaseItemRender);__reflect(FindExpItem.prototype,"FindExpItem"),window.FindExpItem=FindExpItem;var FindExpView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FindExpSkin"},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.list.itemRenderer=FindExpItem,t.prototype.open.call(this),this.txt_title.textFlow=UtilProxy.StrFormart("C:10&经验找回",[]),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.updateInfo),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_one,this.onClick),this.addTouchEvent(this.sp_exp,this.onClick),this.updateInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_one,this.onClick),this.removeTouchEvent(this.sp_exp,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.updateInfo)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_one:this.array&&this.array.length>0&&ViewManager.ins().open(FindTipsView,[0]);break;case this.btn_close:ViewManager.ins().close(this);break;case this.sp_exp:UtilProxy.openView(52,2)}},e.prototype.updateInfo=function(){var t=XiuXianProxy.ins().getFindExpSortList();this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array),this.array.replaceAll(t),this.btn_one.visible=this.array.length>0,this.sp_exp.visible=0==PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)&&XiuXianProxy.ins().findback_list.length>0},e}(BaseEuiView);__reflect(FindExpView.prototype,"FindExpView"),ViewManager.ins().reg(FindExpView,LayerManager.UI_Main2),window.FindExpView=FindExpView;var FindTipsView=function(t){function e(){var e=t.call(this)||this;return e.need_yb=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FindTipsSkin"},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_quxiao,this.onClick),this.addTouchEvent(this.btn_go,this.onClick),this.addTouchEvent(this.img_select_bg,this.onClick),e&&0!=e.length){var n=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)>0,o=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);this.param=e;var s=e[0],r=0,a=0,h=1;if(0==s){this.gp_select.visible=!1;for(var l=XiuXianProxy.ins().findback_list,p=0;p<l.length;p++){var c=l[p];if(c){var u=GlobalConfig.getApById(c.id);r+=u.find_yb*c.times,a+=u.vip_award_value[o]?u.vip_award_value[o][1]*c.times:u.vip_award_value[u.vip_award_value.length-1][1]*c.times}}h=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<r?4:7}else{this.sp_select.visible=!0;var d=e[0],g=e[1],u=GlobalConfig.getApById(d);r=u.find_yb*g,a=u.vip_award_value[o]?u.vip_award_value[o][1]*g:u.vip_award_value[u.vip_award_value.length-1][1]*g,h=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<r?4:7,this.gp_select.visible=!0}if(n){var y=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.ZHIZUN);y&&(r=Math.ceil(r/100*y.xianfu_discount))}this.need_yb=r,this.txt_remark.textFlow=UtilProxy.StrFormart("确定花费|C:@0 &@1 |元宝找回|C:7&@2 |点经验",[h,r,Math.floor(a)])}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn_quxiao,this.onClick),this.removeTouchEvent(this.btn_go,this.onClick),this.removeTouchEvent(this.img_select_bg,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_quxiao:ViewManager.ins().close(e);break;case this.btn_go:if(RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)<this.need_yb)return void TipsControl.ins().showTips("元宝不足了");XiuXianProxy.ins().auto_find=this.sp_select.visible,XiuXianProxy.ins().C2SReqAlivepointXianfuFindBack(this.param[0]),ViewManager.ins().close(e);break;case this.img_select_bg:this.sp_select.visible=!this.sp_select.visible;break;case this.btn_close:ViewManager.ins().close(e)}},e}(BaseEuiView);__reflect(FindTipsView.prototype,"FindTipsView"),ViewManager.ins().reg(FindTipsView,LayerManager.UI_Main2),window.FindTipsView=FindTipsView;var XianAchieItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn_go,this.onClick)},e.prototype.onClick=function(){var t=this.data;if(2!=t.state)if(XiuXianProxy.ins().isAchieCanGet(t.data.id))XiuXianProxy.ins().C2SReqAchievementGet(t.data.id);else{var e=t.data.openview;UtilProxy.openView(e[0],e[1])}},e.prototype.dataChanged=function(){if(void 0!=this.data){var t=this.data.data,e=XiuXianProxy.ins().getAchieValue(t.type,t.condition),i=t.condition[0];9==t.type&&(i=10);this.txt_name.textFlow=UtilProxy.StrFormart("@0  ",[t.desc]),this.cost0.textFlow=UtilProxy.StrFormart("C:10&@0 ",[t.xiuxian_value]),this.cost1.textFlow=UtilProxy.StrFormart("C:7&x@0 ",[t.praise[0][1]]),this.icon_bg.source=t.top>0?"xianjie_jinsedi":"xianjie_lansedi";var n=e/i;n>1&&(n=1),this.thumb.width=154*n,this.txt_value.textFlow=UtilProxy.StrFormart("C:1&@0 /@1 ",[e,i]),XiuXianProxy.ins().isAchieGet(t.id)?(this.btn_go.visible=!1,this.sp_get.visible=!0,this.sp_red.visible=!1):(this.btn_go.visible=!0,this.btn_go.label=i>e?"前往":"领取",this.btn_go.icon=i>e?"common_btn_big_blue":"common_btn_big_yellow",this.sp_red.visible=e>=i,this.sp_get.visible=!1)}},e.prototype.getCoinValue=function(t){for(var e=0,i=0,n=0;n<t.length;n++){var o=t[n];o[0]==MoneyAttr.XIUWEI&&(e=o[1]),o[0]==MoneyAttr.YUANBAO&&(i=o[1])}return[e,i]},e}(BaseItemRender);__reflect(XianAchieItem.prototype,"XianAchieItem"),window.XianAchieItem=XianAchieItem;var XianAliveItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(void 0!=this.data){this.red||(this.red=this.btn_go.getChildAt(2));var t=this.data;this.txt_name.textFlow=UtilProxy.StrFormart("C:10&@0 ",[t.title]);var e=t.vip_award_value[0][0],i=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),n=t.vip_award_value[i];n||(n=t.vip_award_value[t.vip_award_value.length-1]);var o=Math.floor((n[0]-e)/e*100);this.txt_alive.textFlow=UtilProxy.StrFormart("C:1&@0 |C:7&(VIP+@1 %)",[e,o]);var s=t.total_times,r=XiuXianProxy.ins().getAliveTimes(t.id);if(this.btn_go.icon=s>r?"common_btn_big_blue":"common_btn_big_yellow",this.txt_times.textFlow=UtilProxy.StrFormart("C:7&@0 /@1 ",[UtilProxy.getfloorNum(r),UtilProxy.getfloorNum(s)]),2==XiuXianProxy.ins().getAliveState(t.id))return this.btn_go.visible=!1,void(this.finish.visible=!0);this.finish.visible=!1,this.btn_go.visible=!0,this.btn_go.label=s>r?"前往":"领取",this.red.visible=r>=s}},e}(BaseItemRender);__reflect(XianAliveItem.prototype,"XianAliveItem"),window.XianAliveItem=XianAliveItem;
var XianBoxItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(void 0!=this.data){var t=this.data;this.icon.source=XiuXianProxy.ins().alive_point>=t.alive_point?"xianjie_btn_1":"xianjie_btn_2",this.num.textFlow=UtilProxy.StrFormart("C:1&活跃度：@0 ",[t.alive_point]),this.has_get.visible=XiuXianProxy.ins().isAliveRewardGet(t.id),this.red.visible=XiuXianProxy.ins().getAliveRewardRedById(this.data.id)}},e}(BaseItemRender);__reflect(XianBoxItem.prototype,"XianBoxItem"),window.XianBoxItem=XianBoxItem;var XianDujieItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn_go,this.onClick)},e.prototype.onClick=function(){if(this.task){var t=XiuXianProxy.ins().isTaskFinish(this.task.id);t?XiuXianProxy.ins().C2SReqGrowupGetDujieTaskAward(this.task.id):(ViewManager.ins().back_to_dujie=!0,ViewManager.ins().dujie_open_view_id=this.task.openview[0],ViewManager.ins().dujie_open_view_page=this.task.openview[1]||0,UtilProxy.openView(this.task.openview[0],this.task.openview[1]||0),this.task.guide_id>0&&GuideProxy.ins().guideById(this.task.guide_id))}},e.prototype.dataChanged=function(){if(void 0!=this.data&&"null"!=this.data.qq){this.btn_red||(this.btn_red=this.btn_go.getChildAt(2));var t=this.data,e=GlobalConfig.getDujieTaskById(t);this.task=e,this.txt_title.textFlow=UtilProxy.StrFormart("C:10&@0 ",[e.desc]);var i=e.award[0],n={item_slot_idx:0,item_type_id:i[0],item_count:i[1]},o=new ItemCellData;o.setItemCellData(n),this.cur_item.data=o,this.cur_item.ShowName(!1),this.cur_item.ShowRed(!1),this.cur_item.SetShowTips(!0);var s=XiuXianProxy.ins().getTaskValue(t),r=s<e.param[0]?4:7;this.txt_process.textFlow=UtilProxy.StrFormart("C:@0 &@1 /@2 ",[r,s,e.param[0]]);var a=XiuXianProxy.ins().isTaskRewardGeted(t),h=XiuXianProxy.ins().isTaskFinish(t);a?(this.btn_go.visible=!1,this.txt_finish.visible=!0,this.txt_finish.textFlow=UtilProxy.StrFormart("C:7&已达成",[]),this.txt_process.text=""):(this.btn_go.visible=!0,this.txt_finish.visible=!1,h?this.btn_go.label="领取":this.btn_go.label="前往"),this.btn_red.visible=!a&&h}},e}(BaseItemRender);__reflect(XianDujieItem.prototype,"XianDujieItem"),window.XianDujieItem=XianDujieItem;var XianLimitItem=function(t){function e(){var e=t.call(this)||this;return e.lefttime=0,e.IsInWanxian=!1,e.IsInWanxianDay=!1,e.DayStrs=["日","一","二","三","四","五","六"],e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.setSkinName=function(){this.skinName="XianLimitTimeSkin"},e.prototype.init=function(){this.addTouchEvent(this,this.onClick),this.list.itemRenderer=ItemCell},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){TimerManager.ins().removeAll(this);var t=this.data;this.bg.source="resource/skins/XiuXianView/limittime/xianshiwanfa_bg_"+t.type+".png",this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var e=t.show_award;if(e.length>0)for(var i=0;i<e.length;i++){var n=UtilProxy.GetItemCellData(e[i][0],e[i][1]);this.arraylist.addItem(n)}if(this.IsInWanxianDay=PvpProxy.ins().IsInWanxianDay(),1==t.type&&this.IsInWanxianDay)this.bg.source="xianshiwanfa_bg_5",this.ShowColdTime();else switch(t.type){case 1:if(this.btn.getChildAt(2).visible=PvpProxy.ins().getTopRed(),PvpProxy.ins().IsInTopfightTime())this.ShowColdTime();else{var o=GlobalConfig.getPvp_base_dataConfig(1),s=[];s.push(o.ladder_start_time);var r=[];r.push(o.ladder_end_time);var a=this.GetShowStr(o.ladder_stage,s,r,0);this.timelab.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[a])}break;case 2:this.btn.getChildAt(2).visible=FacFightProxy.ins().getRed(),this.ShowColdTime();break;case 3:this.ShowColdTime();break;case 4:var h=ActivityProxy.ins().getActivityDataById(ActivityType.Yama);if(this.btn.getChildAt(2).visible=!1,void 0!=h)if(1!=h.act_status){var o=GlobalConfig.getActivity_open_dataConfigById(ActivityType.Yama),l=this.GetShowStr(o.wdays,o.open_times,[],o.span);this.timelab.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[l])}else this.btn.getChildAt(2).visible=!0,this.ShowColdTime();break;case 6:this.btn.getChildAt(2).visible=LeitaiProxy.ins().getIsOpen();var p=GlobalConfig.getLeitai_misc_dataConfigConfig(1),c=[];c.push(p.start_time);var u=[];u.push(p.end_time);var d=this.GetShowStr([],c,u,0);this.timelab.textFlow=UtilProxy.StrFormart("|C:7&@0 |",[d])}},e.prototype.GetShowStr=function(t,e,i,n){var o="";if(t.length>0){for(var s=0;s<t.length;s++)o+=s==t.length-1?UtilProxy.getStr("@0 ",[this.DayStrs[t[s]]]):UtilProxy.getStr("@0 、",[this.DayStrs[t[s]]]);o=UtilProxy.getStr("每周@0 的",[o])}else o="每日的";for(var s=0;s<e.length;s++){var r=[];if(void 0==i[s]){var a=60*e[s][0]+e[s][1]+Math.floor(n/60);r[0]=Math.floor(a/60),r[1]=Math.floor(a%60)}else r[0]=i[s][0],r[1]=i[s][1];o+=UtilProxy.getStr("@0 ：@1 -@2 ：@3   ",[this.gettimetsr(e[s][0]),this.gettimetsr(e[s][1]),this.gettimetsr(r[0]),this.gettimetsr(r[1])])}return o},e.prototype.gettimetsr=function(t){return 10>t?"0"+t:t},e.prototype.ShowColdTime=function(){var t=0,e=this.data;if(1==e.type&&this.IsInWanxianDay)t=PvpProxy.ins().getCurWanxianEndTime(),this.IsInWanxian=PvpProxy.ins().IsInWanxianTime();else if(1==e.type){var i=PvpProxy.ins().getCurTopFightEndTime();t=i[0]}else if(2==e.type)t=FacFightProxy.ins().next_time;else if(3==e.type)t=ZPZBProxy.ins().nexttime;else if(4==e.type){var n=ActivityProxy.ins().getActivityDataById(ActivityType.Yama);n&&(t=n.act_time)}else 6==e.type&&LeitaiProxy.ins().end_time;var o=GameLogic.ins().getServerTime();this.lefttime=t-o,this.lefttime>0?(this.SetTimeLab(),TimerManager.ins().doTimer(1e3,t-o,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.textFlow=UtilProxy.generateTextFlow("|C:4&活动已结束|")},e.prototype.SetTimeLab=function(){var t=this.data;switch(t.type){case 1:this.IsInWanxianDay?this.timelab.textFlow=UtilProxy.StrFormart("|C:7&活动将于@0 后@1 |",[UtilProxy.getTimeHMSString(this.lefttime),this.IsInWanxian?"结束":"开始"]):this.timelab.textFlow=UtilProxy.StrFormart("|C:7&活动将于@0 后结束|",[UtilProxy.getTimeHMSString(this.lefttime)]);break;case 2:var e=UtilProxy.getTimeStr(this.lefttime);this.timelab.textFlow=0==FacFightProxy.ins().is_open?UtilProxy.StrFormart("|C:7&下一次宗主争夺战@0 后开启|",[e]):UtilProxy.StrFormart("|C:7&宗主争夺战@0 后结束|",[e]);break;case 3:var i=UtilProxy.getTimeStr(this.lefttime);this.timelab.textFlow=0==ZPZBProxy.ins().state?UtilProxy.StrFormart("|C:7&宗派争霸@0 后开启|",[i]):UtilProxy.StrFormart("|C:7&宗派争霸@0 后结束|",[i]);break;case 4:this.timelab.textFlow=UtilProxy.StrFormart("|C:7&活动将于@0 后结束|",[UtilProxy.getTimeHMSString(this.lefttime)])}this.lefttime=this.lefttime-1},e.prototype.onClick=function(t){var e=this.data;1==e.type?PvpProxy.ins().OpenTopFight():2==e.type?FacProxy.ins().getFacId()>0?ViewManager.ins().open(FacFightView):ViewManager.ins().open(FacView):3==e.type&&FacProxy.ins().getFacId()<=0?ViewManager.ins().open(FacView):6==e.type?ViewManager.ins().open(LeitaiView):ViewManager.ins().OpenViewById(e.open_view[0],e.open_view[1]),t.stopImmediatePropagation()},e}(BaseItemRender);__reflect(XianLimitItem.prototype,"XianLimitItem"),window.XianLimitItem=XianLimitItem;var XianPanel0View=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.txt_xian_remark.textFlow=UtilProxy.StrFormart("C:10&下阶激活",[]),this.list_xian.itemRenderer=XianAchieItem,this.addTouchEvent(this.btn_qq,this.onClick),EventProxy.AddListener(this,EventType.S2CRepAchievementGet,this.onGetUpdate),EventProxy.AddListener(this,EventType.S2CRepAchievementUpgrade,this.onUpgradeUpdate),this.bar.slideDuration=0,this.updateInfo(),this.updatelvInfo(),this.CheckGuide()},e.prototype.close=function(){this.removeTouchEvent(this.btn_qq,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepAchievementGet,this.onGetUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAchievementUpgrade,this.onUpgradeUpdate)},e.prototype.onClick=function(){XiuXianProxy.ins().C2SReqAchievementUpgrade()},e.prototype.updateInfo=function(){var t=XiuXianProxy.ins().getUIAchieList();if(this.array)this.array.replaceAll(t);else{this.array=new eui.ArrayCollection,this.list_xian.dataProvider=this.array;for(var e=0;e<t.length;e++){var i=t[e];this.array.addItem(i)}}},e.prototype.updatelvInfo=function(){var t=XiuXianProxy.ins().achie_level,e=GlobalConfig.getAchieLevelById(t),i=GlobalConfig.getAchieLevelById(t+1);if(e){var n="",o=AttrProxy.getAttrInfo(e);if(void 0!=o)for(var s=0;s<o.length;s++)s>0&&(n+="\r\n"),"焚天仙决伤害提升"!=o[s][2]&&(n+=UtilProxy.getStr("|@0  |C:7&+@1 ",[o[s][2],o[s][1]]));this.txt_prolist.textFlow=UtilProxy.generateTextFlow(n),this.sp_qi.source=e.dan_icon,t>=10?this.txt_lv.text="a阶":this.txt_lv.text=t+"阶",this.txt_xian_fight.text=UtilProxy.GetAttrFight(e).toString()}else this.txt_lv.text="0阶",this.sp_qi.source="",this.txt_prolist.textFlow=UtilProxy.StrFormart("",[]),this.txt_xian_fight.text="0";if(i){this.sp_remark.source=i.next_description,this.txt_full.text="";var r=XiuXianProxy.ins().achie_value,a=i.need_value;this.bar.visible=!0,this.bar.maximum=a,this.bar.value=r,this.bar.labelDisplay.visible=!1,this.txt_bar.textFlow=UtilProxy.StrFormart("C:1&@0 /@1 ",[r,a]),r>=a?(this.gp_fight.visible=!1,this.btn_qq.visible=!0,this.bar.visible=!1,this.sp_remark.visible=!1):(this.gp_fight.visible=!0,this.btn_qq.visible=!1,this.gp_fight.visible=!0,this.bar.visible=!0,this.sp_remark.visible=!0)}else this.sp_remark.source=e.next_description,this.bar.visible=!1,this.txt_bar.text="",this.txt_full.textFlow=UtilProxy.StrFormart("C:10&已满级",[]),this.btn_qq.visible=!1,this.gp_fight.visible=!1,this.txt_lv.text=t+"阶"},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;if(void 0!=e&&e.data&&2!=e.data.state)if(XiuXianProxy.ins().isAchieCanGet(e.data.data.id))XiuXianProxy.ins().C2SReqAchievementGet(e.data.data.id);else{var i=e.data.data.openview;UtilProxy.openView(i[0],i[1])}},e.prototype.getNextPartnerData=function(){for(var t,e=XiuXianProxy.ins().achie_level,i=XiuXianProxy.ins().getAchieModelList(),n=0;n<i.length;n++){var o=i[n];if(o.id>e){t=o;break}}return t||(t=i[i.length-1]),t},e.prototype.onGetUpdate=function(){this.updateInfo(),this.updatelvInfo()},e.prototype.onUpgradeUpdate=function(){this.updatelvInfo();var t=UtilProxy.GetMovieClipById(20,this.gp_model);t.x=187,t.y=133},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(XianPanel0View.prototype,"XianPanel0View"),window.XianPanel0View=XianPanel0View;var XianPanel1View=function(t){function e(){var e=t.call(this)||this;return e.pro_list=[],e.codition_list=[],e.namesplist=["初期","中期","大圆满"],e.pro_table=[{name:"生命",key:"hp"},{name:"攻击",key:"attack"},{name:"防御",key:"defence"}],e.need_list=[{remark:"总声望达到|C:10&@0 ",key:"reputation",tip:"声望值不足"},{remark:"角色等级达到|C:10&@0 级",key:"need_level",tip:"角色等级不足"},{remark:"升星总等级达到|C:10&@0 级",key:"star_total_level",tip:"升星总等级不足呀"},{remark:"通关炼妖壶第|C:10&@0 层",key:"pass_lyh_id",tip:"炼妖壶通关层数不足"},{remark:"镇妖塔达到层数|C:10&@0 ",key:"syt_copy_id",tip:"镇妖塔等级不足呀"},{remark:"宝石总等级达到|C:10&@0 级",key:"gem_total_level",tip:"宝石总等级不足"},{remark:"装备强化总等级达到|C:10&@0 级",key:"intensify_total_level",tip:"装备强化等级不足"},{remark:"渡劫境界达到|C:10&@0 ",key:"dujie_level",tip:"渡劫境界未达到"},{remark:"仙符等阶达到|C:10&@0 阶",key:"xianfu_level",tip:"仙符等阶不足"}],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.openlist.itemRenderer=XianPathItem,this.pScroller.viewport=this.openlist,this.openlist.dataProvider=new eui.ArrayCollection,this.pScroller.horizontalScrollBar.autoVisibility=!1,this.pScroller.horizontalScrollBar.visible=!1,this.system_open_config=GlobalConfig.getZhuanOpen(),this.maxZhuan=GlobalConfig.getZhuanMaxStage()},e.prototype.open=function(){this.list.itemRenderer=ItemCell,this.addTouchEvent(this.btn_go,this.onClick),EventProxy.AddListener(this,EventType.UpdataMoney,this.updateInfo),EventProxy.AddListener(this,EventType.ZhuanUpdate,this.updateInfo),this.visible=!0,this.updateInfo(),this.CheckGuide()},e.prototype.updateInfo=function(t){if(void 0===t&&(t=0),t==MoneyAttr.ZHUAN){var e=UtilProxy.GetMovieClipById(89,this.gp_eff);e.x=187,e.y=134}this.btn_go.label=XiuXianProxy.ins().getZhuanRed()?"转生":"前往";var i=new eui.ArrayCollection,n=new eui.ArrayCollection;this.pro_list=[{txt_cur:this.zhuan_cur_pro0,txt_next:this.zhuan_next_pro0},{txt_cur:this.zhuan_cur_pro1,txt_next:this.zhuan_next_pro1},{txt_cur:this.zhuan_cur_pro2,txt_next:this.zhuan_next_pro2}],this.codition_list=[{txt:this.zhuan_c0,bar:this.zhuanbar0},{txt:this.zhuan_c1,bar:this.zhuanbar1},{txt:this.zhuan_c2,bar:this.zhuanbar2},{txt:this.zhuan_c3,bar:this.zhuanbar3}],this.cur_lv=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),this.cur_conf=GlobalConfig.getZhuanById(this.cur_lv),this.next_conf=GlobalConfig.getZhuanById(this.cur_lv+1),this.cur_conf.zhuan>0?this.txt_cur_lv.text=UtilProxy.getStr("@0 转@1 重",[this.cur_conf.zhuan,this.cur_conf.lv]):this.txt_cur_lv.text=UtilProxy.getStr("@0 转",[this.cur_conf.zhuan]),this.txt_zhuan_fight.text="0";var o=this.getNextPetZhuang(),s=null,r="";switch(o.pet[0]){case 1:s=GlobalConfig.getXuanBingResById(o.pet[1]),r="resource/image/xuanbing/"+s.ui_model;break;case 2:s=PetProxy.ins().getShowDataById(o.pet[1]),r="resource/image/"+s.ui_model;break;case 3:s=HorseProxy.ins().getShowDataById(o.pet[1]),r="resource/image/"+s.ui_model;break;case 4:s=WeaponProxy.ins().getResById(WeaponType.Wing,o.pet[1]),r="resource/image/wing/"+s.ui_model;break;case 5:s=WeaponProxy.ins().getResById(WeaponType.Weapon,o.pet[1]),r="resource/image/weapon/"+s.ui_model;break;case 6:s=HuobanProxy.ins().getShowDataById(o.pet[1]),r="resource/image/"+s.ui_model}if(this.txt_zhuan_fight.text=UtilProxy.GetAttrFight(this.cur_conf).toString(),s&&(this.model||(this.model=new MovieClip,this.gp_model.addChild(this.model)),5!=o.pet[0]?(this.model.x=this.gp_model.width/2,1==o.pet[0]&&(this.model.y=this.gp_model.height/2+120),2==o.pet[0]&&(20==o.pet[1]?this.model.y=this.gp_model.height/2+120:this.model.y=this.gp_model.height/2+60),3==o.pet[0]&&(this.model.y=this.gp_model.height/2+80),6==o.pet[0]?(this.model.scaleX=.7,this.model.scaleY=.7,this.model.y=this.gp_model.height/2+40):(this.model.scaleX=1,this.model.scaleY=1)):(this.model.scaleX=.7,this.model.scaleY=.7,this.model.x=this.gp_model.width/2+100,this.model.y=this.gp_model.height/2-10),this.model.playFile(r,-1),this.txt_pet_name.textFlow=UtilProxy.StrFormart("C:9&@0 ",[s.name]),this.cur_conf&&this.cur_conf.id>=o.id?this.txt_remark.text="已领取":this.txt_remark.textFlow=UtilProxy.StrFormart("C:1&@0 ",[o.next_description])),this.cur_conf)for(var a=0;a<this.pro_table.length;a++){var h=this.pro_table[a].name,l=this.cur_conf[this.pro_table[a].key]||0;this.pro_list[a].txt_cur.text=UtilProxy.getStr("@0   +@1 ",[h,l])}var p;if(this.next_conf){p=this.next_conf.zhuan>this.cur_conf.zhuan?this.next_conf.zhuan:this.next_conf.zhuan+1;for(var a=0;a<this.pro_table.length;a++){var c=this.pro_table[a].name,l=this.next_conf[this.pro_table[a].key];this.pro_list[a].txt_next.textFlow=UtilProxy.StrFormart("C:7&@0   +@1 ",[c,l])}for(var a=0;a<this.next_conf.award.length;a++){var u=this.next_conf.award[a][0],d=this.next_conf.award[a][1],g=new ItemCellData,y={item_slot_idx:0,item_type_id:u,item_count:d};g.setItemCellData(y),i.addItem(g)}this.updateConditionInfo(this.next_conf)}else{for(var a=0;a<this.pro_table.length;a++)this.pro_list[a].txt_next.textFlow=UtilProxy.StrFormart("C:7&  已满级",[]);this.unlock_title.textFlow=UtilProxy.StrFormart("C:7&  已满级",[]),p=this.cur_conf.zhuan}if(p>this.maxZhuan?p=this.maxZhuan:this.unlock_title.textFlow=UtilProxy.StrFormart("C:5&@0 转解锁",[p]),this.system_open_config[p])for(var a=0;a<this.system_open_config[p].length;a++)n.addItem(this.system_open_config[p][a]);this.list.dataProvider=i,this.openlist.dataProvider=n},e.prototype.updateConditionInfo=function(t){if(t){for(var e=0,i=0,n=0,o=0;o<this.need_list.length;o++)if(n=t[this.need_list[o].key],n>0&&e<this.codition_list.length){if("syt_copy_id"==this.need_list[o].key&&(n=n-CopyProxy.ins().simple_climb_enter_id+1),i=XiuXianProxy.ins().getZhuanConditionValue(o),"dujie_level"==this.need_list[o].key){var s=Math.ceil(n/3),r=n%3;0==r&&(r=3);var a=GlobalConfig.getDujieDescById(s);if(a){var h=a.name+this.namesplist[r-1];this.codition_list[e].txt.textFlow=UtilProxy.StrFormart(this.need_list[o].remark,[h])}}else this.codition_list[e].txt.textFlow=UtilProxy.StrFormart(this.need_list[o].remark,[n]);this.codition_list[e].txt.parent.visible=!0,this.codition_list[e].bar.maximum=n,this.codition_list[e].bar.value=i,e+=1}if(e<this.codition_list.length)for(var o=e;o<this.codition_list.length;o++)this.codition_list[o].txt.parent.visible=!1}},e.prototype.getNextPetZhuang=function(){for(var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),e=void 0,i=XiuXianProxy.ins().getZhuanModelList(),n=0;n<i.length;n++)if(e=i[n],e.id>t){e=e;break}return e||(e=i[i.length-1]),e},e.prototype.onClick=function(t){if(void 0==this.next_conf)return void TipsControl.ins().showTips("已满级");for(var e=0;e<this.need_list.length;e++){var i=this.need_list[e],n=this.next_conf[i.key];"syt_copy_id"==i.key&&(n=n-CopyProxy.ins().simple_climb_enter_id+1);var o=XiuXianProxy.ins().getZhuanConditionValue(e);if(n>0&&n>o){var s=GlobalConfig.getZhuanViewById(e);if(s)for(var r=0;r<s.openview.length;r++){var a=s.openview[r],h=2,l=100*a[0]+a[1];if(0==a[1]&&(h=1,l=a[0]),SystemOpenProxy.ins().isOpen(h,l,!0)){UtilProxy.openView(a[0],a[1]);break}}return}}XiuXianProxy.ins().C2SReqMiscZhuanUpLevel()},e.prototype.close=function(){this.removeTouchEvent(this.btn_go,this.onClick),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.updateInfo),EventProxy.RemoveListener(this,EventType.ZhuanUpdate,this.updateInfo),this.visible=!1},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(XianPanel1View.prototype,"XianPanel1View"),window.XianPanel1View=XianPanel1View;var XianPanel2View=function(t){function e(){var e=t.call(this)||this;return e.task_full=!1,e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.btn_shuxing.setRed(!1),this.btn_lvup_red=this.btn_lvup.getChildAt(2),this.btn_find_red=this.btn_find.getChildAt(1),this.txt_task.textFlow=UtilProxy.StrFormart("C:7&<u>所有任务</u>",[]),this.pro_cur_title.textFlow=UtilProxy.StrFormart("C:10&当前属性",[]),this.pro_next_title.textFlow=UtilProxy.StrFormart("C:10&下级属性",[]),this.list.itemRenderer=XianAliveItem,this.list_box.itemRenderer=XianBoxItem,this.list0.itemRenderer=ItemCell,this.addTouchEvent(this.txt_task,this.onClick),this.addTouchEvent(this.btn_pro_close,this.onClick),this.addTouchEvent(this.btn_shuxing,this.onClick),this.addTouchEvent(this.btn_find,this.onClick),this.addTouchEvent(this.btn_lvup,this.onClick),this.addTouchEvent(this.btn_close0,this.onClick),this.addTouchEvent(this.sp_exp,this.onClick),this.addItemTapEvent(this.list,this.onListItemTap),this.addItemTapEvent(this.list_box,this.onListBoxTap),EventProxy.AddListener(this,EventType.S2CRepAlivepointGetReward,this.onRewardUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointUpdate,this.onAlivePointUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointGet,this.onGetUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuUpLevel,this.onlvupUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.onfindback),EventProxy.AddListener(this,EventType.S2CRepActivitySpecialRightsData,this.onRightUpdate),this.task_full=!1,this.showTaskFull(this.task_full),this.updateInfo(),this.updateBoxInfo(),this.updatelvupInfo()},e.prototype.close=function(){EventProxy.RemoveListener(this,EventType.S2CRepAlivepointGetReward,this.onRewardUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointGet,this.onGetUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuUpLevel,this.onlvupUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.onfindback),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointUpdate,this.onAlivePointUpdate),EventProxy.RemoveListener(this,EventType.S2CRepActivitySpecialRightsData,this.onRightUpdate),this.removeTouchEvent(this.txt_task,this.onClick),this.removeTouchEvent(this.btn_pro_close,this.onClick),this.removeTouchEvent(this.btn_shuxing,this.onClick),this.removeTouchEvent(this.btn_find,this.onClick),this.removeTouchEvent(this.btn_lvup,this.onClick),this.removeTouchEvent(this.btn_close0,this.onClick),this.removeTouchEvent(this.sp_exp,this.onClick),this.removeItemTapEvent(this.list,this.onListItemTap),this.removeItemTapEvent(this.list_box,this.onListBoxTap),this.array&&(this.array.removeAll(),this.array=null)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_lvup:if(!this.lvup_next_data)return void TipsControl.ins().showTips("满级了");if(XiuXianProxy.ins().xianfu_value<this.lvup_next_data.xianfu)return void TipsControl.ins().showTips("经验不足");XiuXianProxy.ins().C2SReqAlivepointXianfuUpLevel();break;case this.btn_close0:this.gp_reward.visible=!1;break;case this.btn_shuxing:this.openProPanel(XiuXianProxy.ins().xianfu_level);break;case this.btn_find:ViewManager.ins().open(FindExpView);break;case this.btn_pro_close:this.gp_pro.visible=!1;break;case this.txt_task:this.task_full=!this.task_full,this.showTaskFull(this.task_full);break;case this.sp_exp:UtilProxy.openView(52,2)}},e.prototype.showTaskFull=function(t){t?(this.gp_top.visible=!1,this.sv.y=40,this.sv.height=454,this.gp_title.y=0,this.gp_model.visible=!1):(this.gp_top.visible=!0,this.sv.y=311,this.sv.height=183,this.gp_title.y=271,this.gp_model.visible=!0)},e.prototype.updatelvupInfo=function(){var t=XiuXianProxy.ins().xianfu_level,e=XiuXianProxy.ins().xianfu_value,i=Math.ceil(t/10),n=t%10,o=GlobalConfig.getAliveDescById(i);if(o){this.txt_lv2.text=UtilProxy.getStr("Lv.@0 ",[t]),this.sp_lv.source=o.xianfu,i>0&&0==n?this.txt_lv.text="a阶":this.txt_lv.text=n+"阶";var s=GlobalConfig.getAliveLvdataById(t),r=GlobalConfig.getAliveLvdataById(t+1);this.lvup_next_data=r,s?this.add_value.text="+"+((s.poji_rate||0)/100).toFixed(2)+"%":this.add_value.text="+0%",r?(this.bar_lvup.maximum=r.xianfu,this.bar_lvup.value=e,this.btn_lvup.setEff(e>=r.xianfu,60,.8,.8),this.txt_lvup_bar.text=UtilProxy.getStr("@0 /@1 ",[e,r.xianfu])):(this.btn_lvup.setEff(!1,60),this.bar_lvup.maximum=s.xianfu,this.bar_lvup.value=e,this.txt_lvup_bar.textFlow=UtilProxy.StrFormart("C:7&@ ",["已满级"])),this.txt_fight.text=UtilProxy.GetAttrFight(s).toString(),this.mv||(this.mv=new MovieClip,this.gp_model.addChildAt(this.mv,2),this.mv.x=240,this.mv.y=400),this.mv.playFile(UI_XIANFU_DIR+o.ui_model,-1),this.bar_lvup.labelDisplay.visible=!1,this.btn_lvup_red.visible=this.lvup_next_data&&XiuXianProxy.ins().xianfu_value>=this.lvup_next_data.xianfu,this.btn_find_red.visible=XiuXianProxy.ins().findback_list.length>0,this.sp_exp.visible=0==PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)&&XiuXianProxy.ins().findback_list.length>0}},e.prototype.onRightUpdate=function(){this.sp_exp.visible=0==PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)&&XiuXianProxy.ins().findback_list.length>0},e.prototype.updateInfo=function(){this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array);var t=[],e=XiuXianProxy.ins().getAliveList();for(var i in e){var n=e[i];n&&(n.state=XiuXianProxy.ins().getAliveState(parseInt(i)),t.push(n))}t.sort(function(t,e){return t.state!=e.state?t.state-e.state:t.paixu-e.paixu}),this.array.replaceAll(t),this.bar.labelDisplay.visible=!1},e.prototype.updateBoxInfo=function(){var t=GlobalConfig.getApRewardList();this.array_box||(this.array_box=new eui.ArrayCollection,this.list_box.dataProvider=this.array_box),this.array_box.removeAll();for(var e in t){var i=t[e];this.array_box.addItem(i)}var n=GlobalConfig.getApRewardList(),o=4,s=n[o].alive_point;this.bar.maximum=s;for(var r=XiuXianProxy.ins().alive_point,a=0,h=s/o,l=1;5>l;l++){var i=n[l];if(i&&r<=i.alive_point){a=l;break}}r>=n[4].alive_point&&(a=4),this.bar.value=(a-1)*h+r/n[a].alive_point*h,this.txt_bar.textFlow=UtilProxy.StrFormart("C:1&@0 ",[r])},e.prototype.onListItemTap=function(t){var e=t.itemRenderer;if(this.cur_alive=e,void 0!=e&&e.data&&e.data.openview.length>0){if(0==e.data.state)return void XiuXianProxy.ins().C2SReqAlivepointGet(e.data.id);if(2==e.data.state)return;var i=e.data.openview[0],n=e.data.openview[1];UtilProxy.openView(i,n)}},e.prototype.onListBoxTap=function(t){var e=t.itemRenderer;if(void 0!=e&&e.data){var i=XiuXianProxy.ins().isAliveRewardGet(e.data.id);i||(XiuXianProxy.ins().alive_point>=e.data.alive_point?XiuXianProxy.ins().C2SReqAlivepointGetReward(e.data.id):(this.gp_reward.visible=!0,this.showReward(e.data)))}},e.prototype.openProPanel=function(t){this.gp_pro.visible=!0;for(var e=GlobalConfig.getAliveLvdataById(t),i=GlobalConfig.getAliveLvdataById(t+1),n=AttrProxy.getContAttrInfo(e,i),o="",s="",r=0;r<n.length;r++)r>0&&(o+="\r\n",s+="\r\n"),o+=n[r][0]+"："+n[r][1],s+="|C:7&"+n[r][0]+"："+(0==n[r][2]?"已满级":n[r][2]);this.txt_pro_pro_cur.textFlow=UtilProxy.StrFormart(o,[]),this.txt_pro_pro_next.textFlow=UtilProxy.StrFormart(s,[])},e.prototype.showReward=function(t){for(var e=GlobalConfig.getDropConfig(t.drop_id),i=GlobalConfig.getDropItem(e.drop),n=new Array,o=0;o<i.length;o++){var s=i[o],r=new ItemCellData,a={item_slot_idx:0,item_type_id:s[0].id,item_count:s[0].num};r.setItemCellData(a),n.push(r)}this.list0.dataProvider=new eui.ArrayCollection(n)},e.prototype.onRewardUpdate=function(){this.updateBoxInfo()},e.prototype.onGetUpdate=function(){this.updateInfo(),this.updatelvupInfo(),this.updateBoxInfo()},e.prototype.onlvupUpdate=function(){var t=UtilProxy.GetMovieClipById(20,this.gp_lvup_eff),e=UtilProxy.GetMovieClipById(26,this.gp_lvup_eff);t.x=e.x=this.gp_lvup_eff.width/2,t.y=e.y=this.gp_lvup_eff.height/2,this.updatelvupInfo()},e.prototype.onAlivePointUpdate=function(){this.updateBoxInfo()},e.prototype.onfindback=function(){this.updatelvupInfo()},e}(BaseEuiView);__reflect(XianPanel2View.prototype,"XianPanel2View"),window.XianPanel2View=XianPanel2View;var XianPanel3View=function(t){function e(){var e=t.call(this)||this;return e.cur_lv=0,e.min_lv=0,e.namesplist=["初期","中期","大圆满"],e.nameimglist=["dujie_font_101","dujie_font_102","dujie_font_103"],e.chongzhi_type=0,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=XianDujieItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.btn_shuxing.setRed(!1),this.btn_red=this.btn_go.getChildAt(2),this.task_arr||(this.task_arr=new eui.ArrayCollection,this.list.dataProvider=this.task_arr,this.task_arr.removeAll()),this.mv||(this.mv=UtilProxy.GetMovieClipById(97,this.gp_eff),this.mv.x=this.gp_eff.width/2,this.mv.y=this.gp_eff.height/2),this.mv0||(this.mv0=UtilProxy.GetMovieClipById(98,this.eff0),this.mv0.x=this.eff0.width/2,this.mv0.y=this.eff0.height/2),this.mv1||(this.mv1=UtilProxy.GetMovieClipById(98,this.eff1),this.mv1.x=this.eff1.width/2,this.mv1.y=this.eff1.height/2),this.mv2||(this.mv2=UtilProxy.GetMovieClipById(98,this.eff2),this.mv2.x=this.eff2.width/2,this.mv2.y=this.eff2.height/2),this.mv_list=[this.mv0,this.mv1,this.mv2],this.gp_pro.visible=!1,this.gp_active.visible=!1,EventProxy.AddListener(this,EventType.S2CRepGrowupGetDujieInfo,this.lvupUpdate),EventProxy.AddListener(this,EventType.S2CRepGrowupGetDujieTaskAward,this.onTaskGet),EventProxy.AddListener(this,EventType.S2CRepGrowupUpdateDujieTaskInfo,this.taskUpdate),EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.activeUpdate),this.addTouchEvent(this.btn_go,this.onClick),this.addTouchEvent(this.btn_shuxing,this.onClick),this.addTouchEvent(this.active_bg,this.onClick),this.addTouchEvent(this.btn_pro_close,this.onClick),this.addTouchEvent(this.btn_close_cz,this.onClick),this.addTouchEvent(this.gp_congzhi,this.onClick),this.prolist=[this.active_pro0,this.active_pro1,this.active_pro2,this.active_pro3],this.txt_remark.textFlow=UtilProxy.StrFormart("C:7&每个境界分为：初期，中期，大圆满三个小境界",[]),this.txt_full.textFlow=UtilProxy.StrFormart("C:7&已满级",[]),this.pro_cur_title.textFlow=UtilProxy.StrFormart("C:10&当前属性",[]),this.pro_next_title.textFlow=UtilProxy.StrFormart("C:10&下级属性",[]),this.splist=[this.sp_0,this.sp_1,this.sp_2],this.cur_lv=XiuXianProxy.ins().dujie_lv,this.min_lv=XiuXianProxy.ins().dujie_min_lv,this.ShowInfo(),this.CheckGuide()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_go:var e=this.getNextTaskList(this.cur_lv,this.min_lv);if(e.length>0&&!this.isTaskFinish(e))return void TipsControl.ins().showTips("请先完成所有任务");if(XiuXianProxy.ins().dujie_copy_finish)XiuXianProxy.ins().C2SReqGrowupDujieUpgrade();else{if(!GameLogic.ins().isMainScene())return void TipsControl.ins().showTips("目前处于副本或活动场景，无法挑战心魔");XiuXianProxy.ins().C2SReqGrowupChallengeDujieCopy(),ViewManager.ins().close(XiuXianView)}break;case this.btn_shuxing:this.openProPanel(this.cur_lv,this.min_lv);break;case this.active_bg:this.gp_active.visible=!1;break;case this.btn_pro_close:this.gp_pro.visible=!1;break;case this.btn_close_cz:this.gp_congzhi.visible=!1;break;case this.gp_congzhi:2==this.chongzhi_type?UtilProxy.openView(52,1):UtilProxy.openView(51,0)}},e.prototype.close=function(){EventProxy.RemoveListener(this,EventType.S2CRepGrowupGetDujieInfo,this.lvupUpdate),EventProxy.RemoveListener(this,EventType.S2CRepGrowupGetDujieTaskAward,this.onTaskGet),EventProxy.RemoveListener(this,EventType.S2CRepGrowupUpdateDujieTaskInfo,this.taskUpdate),EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.activeUpdate),this.removeTouchEvent(this.btn_go,this.onClick),this.removeTouchEvent(this.btn_shuxing,this.onClick),this.removeTouchEvent(this.active_bg,this.onClick),this.removeTouchEvent(this.btn_pro_close,this.onClick),this.removeTouchEvent(this.btn_close_cz,this.onClick),this.removeTouchEvent(this.gp_congzhi,this.onClick),TimerManager.ins().removeAll(this),egret.Tween.removeTweens(this.gp_congzhi)},e.prototype.lvupUpdate=function(){if(this.cur_lv!=XiuXianProxy.ins().dujie_lv||this.min_lv!=XiuXianProxy.ins().dujie_min_lv){this.openActivePanel(this.cur_lv,this.min_lv),this.cur_lv=XiuXianProxy.ins().dujie_lv,this.min_lv=XiuXianProxy.ins().dujie_min_lv,this.ShowInfo();var t=UtilProxy.GetMovieClipById(62,this.gp_task_eff);t.x=this.gp_task_eff.width/2,t.y=this.gp_task_eff.height/2}},e.prototype.taskUpdate=function(){var t=this.getNextTaskList(this.cur_lv,this.min_lv);t.length>0&&this.task_arr.replaceAll(t)},e.prototype.activeUpdate=function(){this.ShowInfo()},e.prototype.ShowInfo=function(){if(this.cur_lv>0&&this.min_lv>0){this.sp_un.visible=!1,this.sp_lv.visible=this.sp_lv2.visible=!0;var t=GlobalConfig.getDujieBaseById(this.cur_lv,this.min_lv),e=GlobalConfig.getDujieDescById(this.cur_lv);this.txt_fight.text=this.getFightValue(t).toString(),this.sp_lv.source="dujie_font_"+e.pic,this.sp_lv2.source=this.nameimglist[this.min_lv-1];for(var i=0;3>i;i++)this.min_lv>=i+1?(this.splist[i].filters=void 0,this.mv_list[i].visible=!0):(this.SetPicColor(this.splist[i]),this.mv_list[i].visible=!1);this.add_value.text="+"+(t.ft_xiuxian_add_pre/100).toFixed(2)+"%"}else{this.sp_un.visible=!0,this.sp_lv.visible=this.sp_lv2.visible=!1,this.SetPicColor(this.sp_0),this.SetPicColor(this.sp_1),this.SetPicColor(this.sp_2),this.add_value.text="+0%";for(var i=0;i<this.mv_list.length;i++)this.mv_list[i].visible=!1}var n=this.getNextTaskList(this.cur_lv,this.min_lv);if(n.length>0){this.task_arr.replaceAll(n),this.btn_go.visible=!0,this.txt_full.visible=!1,this.btn_go.label=XiuXianProxy.ins().dujie_copy_finish?"突破境界":"挑战心魔",this.btn_go.setEff(this.isShowEff(n),60,1,1,17);
for(var o=!1,s="",i=0;i<n.length;i++){var r=GlobalConfig.getDujieTaskById(n[i]);if(r&&62==r.type&&0==XiuXianProxy.ins().getTaskState(r.id)&&LimitActProxy.ins().IsFristRechargeOpen()){o=!0,s="dujie_shouchong_tips",this.chongzhi_type=0;break}if(r&&63==r.type&&0==XiuXianProxy.ins().getTaskState(r.id)&&LimitActProxy.ins().IsFristRechargeOpen()){o=!0,s="dujie_shouchong_tips_02",this.chongzhi_type=1;break}if(r&&64==r.type&&0==XiuXianProxy.ins().getTaskState(r.id)&&PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN)){o=!0,s="dujie_shouchong_tips_03",this.chongzhi_type=2;break}}this.gp_congzhi.visible=o,o&&(this.sp_title.source=s,egret.Tween.removeTweens(this.gp_congzhi),this.gp_congzhi.x=75,this.gp_congzhi.y=302,egret.Tween.get(this.gp_congzhi,{loop:!0}).to({y:316},700).to({y:302},800))}else this.btn_go.setEff(!1,60),this.task_arr.removeAll(),this.btn_go.visible=!1,this.txt_full.visible=!0;this.btn_red.visible=XiuXianProxy.ins().dujie_copy_finish},e.prototype.onTaskGet=function(t){this.setGuide()},e.prototype.SetPicColor=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]},e.prototype.openProPanel=function(t,e){this.gp_pro.visible=!0;for(var i=GlobalConfig.getDujieBaseById(t,e),n=this.getNextBaseData(t,e),o=AttrProxy.getContAttrInfo(i,n),s="",r="",a=0;a<o.length;a++)a>0&&(s+="\r\n",r+="\r\n"),s+=o[a][0]+"："+o[a][1],r+="|C:7&"+o[a][0]+"："+(0==o[a][2]?"已满级":o[a][2]);this.txt_pro_pro_cur.textFlow=UtilProxy.StrFormart(s,[]),this.txt_pro_pro_next.textFlow=UtilProxy.StrFormart(r,[])},e.prototype.openActivePanel=function(t,e){this.gp_active.visible=!0;var i=GlobalConfig.getDujieBaseById(t,e),n=this.getNextBaseData(t,e);if(i){var o=GlobalConfig.getDujieDescById(t);this.txt_cur_remark.textFlow=UtilProxy.StrFormart("C:10&@0 •@1 ",[o.name,this.namesplist[i.mini_level-1]])}else this.txt_cur_remark.text="入世境";if(n){var o=GlobalConfig.getDujieDescById(n.level);this.txt_next_remark.textFlow=UtilProxy.StrFormart("C:10&@0 •@1 ",[o.name,this.namesplist[n.mini_level-1]])}else this.txt_next_remark.text="";var s=AttrProxy.getContAttrInfo(i,n);if(s.length>0)for(var r=0;r<this.prolist.length;r++)r<s.length?(this.prolist[r].visible=!0,this.setProInfo(this.prolist[r],s[r])):this.prolist[r].visible=!1},e.prototype.setProInfo=function(t,e){var i=t.getChildAt(0),n=t.getChildAt(1);i.textFlow=UtilProxy.StrFormart("C:10&@0 :@1 ",[e[0],e[1]]),n.textFlow=UtilProxy.StrFormart("C:7&@0 ",[e[2]])},e.prototype.getNextBaseData=function(t,e){var i=GlobalConfig.getDujieBaseById(t,e+1);return i||(i=GlobalConfig.getDujieBaseById(t+1,1)),i},e.prototype.getNextTaskList=function(t,e){var i=GlobalConfig.getDujieBaseById(t,e+1);return i||(i=GlobalConfig.getDujieBaseById(t+1,1)),i?i.task_list:[]},e.prototype.getFightValue=function(t){return t?UtilProxy.GetAttrFight(t):0},e.prototype.isShowEff=function(t){for(var e=0;e<t.length;e++)if(0==XiuXianProxy.ins().getTaskState(t[e]))return!1;return!0},e.prototype.isTaskFinish=function(t){for(var e=0;e<t.length;e++)if(!XiuXianProxy.ins().isTaskRewardGeted(t[e]))return!1;return!0},e.prototype.setGuide=function(){if(!GuideProxy.ins().isDuJieTask())return!0;if(this.list.numChildren>0){for(var t=0;t<this.list.numChildren;++t){var e=this.list.getChildAt(t);if(e.btn_red.visible)return GuideProxy.ins().showGuide(e.btn_go,null,e),!0}for(var t=0;t<this.list.numChildren;++t){var e=this.list.getChildAt(t);if(e.btn_go.visible)return GuideProxy.ins().showGuide(e.btn_go,null,e),!0}return GuideProxy.ins().showGuide(this.btn_go,null,this),!0}return!1},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){t.setGuide()||t.CheckGuide()},this)},e}(BaseEuiView);__reflect(XianPanel3View.prototype,"XianPanel3View"),window.XianPanel3View=XianPanel3View;var XianPanel4View=function(t){function e(){var e=t.call(this)||this;return e.curID=0,e}return __extends(e,t),e.prototype.initUI=function(){this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&挑战关卡 BOSS，获得珍宝部件解锁珍宝|"),this.g_list=[this.g1,this.g2,this.g3,this.g4,this.g5],this.effect.removeChildren(),UtilProxy.GetMovieClipById(83,this.effect),this.effect0.removeChildren(),UtilProxy.GetMovieClipById(84,this.effect0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.probtn,this.onClick),this.addTouchEvent(this.btn0,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.addTouchEvent(this.getbtn,this.onClick);for(var i=0;i<this.g_list.length;i++)this.addTouchEvent(this.g_list[i],this.onPartClick);EventProxy.AddListener(this,EventType.S2CRepFabaoGetTreasureInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFabaoUpdateTreasure,this.ShowInfo),this.curID=ZhenbaoProxy.ins().getShowZhenbaoId(),this.ShowInfo(),this.CheckGuide()},e.prototype.close=function(){this.removeTouchEvent(this.probtn,this.onClick),this.removeTouchEvent(this.btn0,this.onClick),this.removeTouchEvent(this.btn1,this.onClick),this.removeTouchEvent(this.btn,this.onClick),this.removeTouchEvent(this.getbtn,this.onClick);for(var t=0;t<this.g_list.length;t++)this.removeTouchEvent(this.g_list[t],this.onPartClick);EventProxy.RemoveListener(this,EventType.S2CRepFabaoGetTreasureInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepFabaoUpdateTreasure,this.ShowInfo)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.probtn:ViewManager.ins().open(ZhenbaoProTips);break;case this.btn0:var e=GlobalConfig.getTreasure_base_dataConfig(this.curID);if(0==e.last_id)return;this.curID=e.last_id,this.SetInfo();break;case this.btn1:if(this.curID>ZhenbaoProxy.ins().getShowZhenbaoId())return;var i=GlobalConfig.getTreasure_base_dataConfig(this.curID+1);i&&(this.curID=this.curID+1),this.SetInfo();break;case this.getbtn:ZhenbaoProxy.ins().IsZhenbaoAwardCanGet(this.curID)&&ZhenbaoProxy.ins().C2SReqFabaoGetTreasureAward(this.curID);break;case this.btn:1==ZhenbaoProxy.ins().GetZhenbaoActiveState(this.curID)&&ZhenbaoProxy.ins().C2SReqFabaoActiveTreasure(1,this.curID)}},e.prototype.onPartClick=function(t){var e=this.g_list.indexOf(t.currentTarget),i=GlobalConfig.getTreasure_base_dataConfig(this.curID);void 0!=i&&void 0!=i.part_list[e]&&ViewManager.ins().open(ZhenbaoPartTips,i.part_list[e])},e.prototype.ShowInfo=function(){this.zhanValue.text=ZhenbaoProxy.ins().getTotleFight().toString(),this.SetInfo()},e.prototype.SetInfo=function(){var t=GlobalConfig.getTreasure_base_dataConfig(this.curID);if(void 0!=t){this.red0.visible=ZhenbaoProxy.ins().getLastRed(this.curID),this.red1.visible=ZhenbaoProxy.ins().getNextRed(this.curID),this.namepic.source=t.name_pic,this.title.source=t.show_pic;ZhenbaoProxy.ins().GetZhenbaoActiveState(this.curID);this.btn.visible=!ZhenbaoProxy.ins().IsZhenbaoActive(this.curID)&&1==ZhenbaoProxy.ins().GetZhenbaoActiveState(this.curID),this.pic.source=ZhenbaoProxy.ins().IsZhenbaoActive(this.curID)?"zhenbao_icon_jihuo":"zhenbao_icon_weijihuo",this.getbtn.visible=ZhenbaoProxy.ins().IsZhenbaoAwardCanGet(this.curID),this.getbtn.setRed(ZhenbaoProxy.ins().IsZhenbaoAwardCanGet(this.curID));var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.award[0][0],item_count:t.award[0][1]};e.setItemCellData(i),this.itemcell.data=e;var n=AttrProxy.getAttrInfo(t);this.prolab.textFlow=UtilProxy.StrFormart("永久提升@0 |C:7&@1 |",[n[0][0],n[0][1]]);for(var o=0;o<this.g_list.length;o++)this.SetPartInfo(this.g_list[o],t.part_list[o]||0);this.model.removeChildren();var s=new egret.MovieClip;UtilProxy.GetMovieClip(UI_ZHENBAO_DIR+t.ui_model,s,-1,void 0,!1,6),this.model.addChild(s)}},e.prototype.SetPartInfo=function(t,e){var i=t.getChildAt(1);i.visible=e>0;var n=t.getChildAt(2);n.visible=e>0;var o=t.getChildAt(5);o.visible=e>0,t.getChildAt(3).visible=0==e,t.getChildAt(4).visible=ZhenbaoProxy.ins().IsZhenbaoPartCanActive(e);var s=GlobalConfig.getTreasure_part_dataConfig(e);void 0!=s&&(i.source=AssetMgr.getIconResource(s.pic1),n.source=AssetMgr.getIconResource(s.pic2),UtilProxy.SetAshColor(i,!ZhenbaoProxy.ins().IsZhenbaoPartActive(e)),UtilProxy.SetAshColor(n,!ZhenbaoProxy.ins().IsZhenbaoPartActive(e)),o.textFlow=ZhenbaoProxy.ins().IsZhenbaoPartCanActive(e)?UtilProxy.generateTextFlow("|C:7&点击激活|"):UtilProxy.StrFormart("第 @0  关",[s.copy_id]))},e.prototype.CheckGuide=function(){var t=this;TimerManager.ins().doTimer(100,1,function(){GuideProxy.ins().CheckGuideView(t)&&t.CheckGuide()},this)},e}(BaseEuiView);__reflect(XianPanel4View.prototype,"XianPanel4View"),window.XianPanel4View=XianPanel4View;var XianPanel5View=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=XianLimitItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.ShowInfo()},e.prototype.close=function(){},e.prototype.ShowInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var t=GlobalConfig.getXianLimitActList();for(var e in t)this.arraylist.addItem(t[e])},e}(BaseEuiView);__reflect(XianPanel5View.prototype,"XianPanel5View"),window.XianPanel5View=XianPanel5View;var XianPathItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XiuXianPathSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){this.data&&(this.pathicon.source=this.data.icon)},e}(BaseItemRender);__reflect(XianPathItem.prototype,"XianPathItem"),window.XianPathItem=XianPathItem;var XiuXianItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){void 0==this.data},e.prototype.onClick=function(t){},e}(BaseItemRender);__reflect(XiuXianItem.prototype,"XiuXianItem"),window.XiuXianItem=XiuXianItem;var XiuXianView=function(t){function e(){var e=t.call(this)||this;return e.cur_id=0,e.title_list=["title_dujie","title_xianjie","title_zhuansheng","title_xianfu","title_zhenbao"],e.skinName="XiuXianSkin",e.panel_list=[e.panel3,e.panel0,e.panel1,e.panel2,e.panel4],e.btn_list=[e.menu0,e.menu1,e.menu2,e.menu3,e.menu4],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.comview.initUI(),this.panel0.initUI(),this.panel1.initUI(),this.panel2.initUI(),this.panel3.initUI(),this.panel4.initUI(),this.achie_red=this.menu1.getChildAt(2),this.duijie_red=this.menu0.getChildAt(2),this.zhuan_red=this.menu2.getChildAt(2),this.alive_red=this.menu3.getChildAt(2),this.zhenbao_red=this.menu4.getChildAt(2)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.comview.open(),EventProxy.AddListener(this,EventType.S2CRepGrowupGetDujieInfo,this.onDujieUpdate),EventProxy.AddListener(this,EventType.S2CRepGrowupUpdateDujieTaskInfo,this.onDujieUpdate),EventProxy.AddListener(this,EventType.S2CRepAchievementGet,this.onAchieUpdate),EventProxy.AddListener(this,EventType.S2CRepAchievementUpgrade,this.onAchieUpdate),EventProxy.AddListener(this,EventType.UpdataMoney,this.onMoneyZhuanUpdate),EventProxy.AddListener(this,EventType.ZhuanUpdate,this.onZhuanUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointGetReward,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointGet,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointUpdate,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepAlivepointXianfuUpLevel,this.onAliveUpdate),EventProxy.AddListener(this,EventType.S2CRepFabaoGetTreasureInfo,this.onZhenbaoUpdate),EventProxy.AddListener(this,EventType.S2CRepFabaoUpdateTreasure,this.onZhenbaoUpdate);var n=0;e&&e.length>0&&(n=e[0]),this.addTouchEvent(this.btn_close,this.onCloseClick),this.addTouchEvent(this.menu0,this.onClick),this.addTouchEvent(this.menu1,this.onClick),this.addTouchEvent(this.menu2,this.onClick),this.addTouchEvent(this.menu3,this.onClick),this.addTouchEvent(this.menu4,this.onClick);for(var o=0;o<this.btn_list.length;o++)this.btn_list[o].icon="common_btn_big_yellow_off";for(var s=0,r=this.panel_list;s<r.length;s++){var a=r[s];a.visible=!1}this.openPage(n),this.achie_red.visible=XiuXianProxy.ins().getAchieRed(),this.zhuan_red.visible=XiuXianProxy.ins().getZhuanRed(),this.alive_red.visible=XiuXianProxy.ins().getAliveRed(),this.zhenbao_red.visible=ZhenbaoProxy.ins().getRed(),this.duijie_red.visible=XiuXianProxy.ins().getDujieRed()},e.prototype.openPage=function(t){this.cur_id!=t&&this.panel_list[this.cur_id]&&(this.panel_list[this.cur_id].close(),this.panel_list[this.cur_id].visible=!1,this.btn_list[this.cur_id].icon="common_btn_big_yellow_off"),this.panel_list[t]&&(this.cur_id=t,this.panel_list[t].visible=!0,this.btn_list[t].icon="common_btn_big_yellow",this.panel_list[t].open()),this.comview.SetName(this.title_list[t])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),EventProxy.RemoveListener(this,EventType.S2CRepGrowupGetDujieInfo,this.onDujieUpdate),EventProxy.RemoveListener(this,EventType.S2CRepGrowupUpdateDujieTaskInfo,this.onDujieUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAchievementGet,this.onAchieUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAchievementUpgrade,this.onAchieUpdate),EventProxy.RemoveListener(this,EventType.UpdataMoney,this.onMoneyZhuanUpdate),EventProxy.RemoveListener(this,EventType.ZhuanUpdate,this.onZhuanUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointGetReward,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointUpdate,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuFindBack,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointXianfuUpLevel,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepAlivepointGet,this.onAliveUpdate),EventProxy.RemoveListener(this,EventType.S2CRepFabaoGetTreasureInfo,this.onZhenbaoUpdate),EventProxy.RemoveListener(this,EventType.S2CRepFabaoUpdateTreasure,this.onZhenbaoUpdate),this.removeTouchEvent(this.btn_close,this.onCloseClick),this.removeTouchEvent(this.menu0,this.onClick),this.removeTouchEvent(this.menu1,this.onClick),this.removeTouchEvent(this.menu2,this.onClick),this.removeTouchEvent(this.menu3,this.onClick),this.removeTouchEvent(this.menu4,this.onClick),this.panel_list[0].close(),this.panel_list[1].close(),this.panel_list[2].close(),this.panel_list[3].close(),this.panel_list[4].close()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(e)},e.prototype.onClick=function(t){var e=this.btn_list.indexOf(t.currentTarget);if(e>0){var i=2,n=1900+e;SystemOpenProxy.ins().isOpen(i,n)&&this.openPage(e)}else this.openPage(e)},e.prototype.onAchieUpdate=function(){this.achie_red.visible=XiuXianProxy.ins().getAchieRed()},e.prototype.onMoneyZhuanUpdate=function(t){t==MoneyAttr.ZHUAN&&(this.zhuan_red.visible=XiuXianProxy.ins().getZhuanRed())},e.prototype.onZhuanUpdate=function(){this.zhuan_red.visible=XiuXianProxy.ins().getZhuanRed()},e.prototype.onAliveUpdate=function(){this.alive_red.visible=XiuXianProxy.ins().getAliveRed()},e.prototype.onZhenbaoUpdate=function(){this.zhenbao_red.visible=ZhenbaoProxy.ins().getRed()},e.prototype.onDujieUpdate=function(){this.duijie_red.visible=XiuXianProxy.ins().getDujieRed()},e}(BaseEuiView);__reflect(XiuXianView.prototype,"XiuXianView"),ViewManager.ins().reg(XiuXianView,LayerManager.UI_Main),window.XiuXianView=XiuXianView;var ZhenbaoPartTips=function(t){function e(){var e=t.call(this)||this;return e.curId=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TreasureTipsSkin",this.itemcell.SetShowTips(!1),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&常规属性|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.upbtn,this.onbtnClick),EventProxy.AddListener(this,EventType.S2CRepFabaoUpdateTreasure,this.ShowTipsInfo),this.curId=t[0],this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.upbtn,this.onbtnClick),EventProxy.RemoveListener(this,EventType.S2CRepFabaoUpdateTreasure,this.ShowTipsInfo)},e.prototype.onCloseClick=function(t){this.CloseView()},e.prototype.onbtnClick=function(t){ZhenbaoProxy.ins().IsZhenbaoPartCanActive(this.curId)?(ZhenbaoProxy.ins().C2SReqFabaoActiveTreasure(2,this.curId),this.CloseView()):TipsControl.ins().showTips("没有可激活的道具")},e.prototype.CloseView=function(){ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){var t=GlobalConfig.getTreasure_part_dataConfig(this.curId);if(void 0!=t){this.tipsname.textFlow=UtilProxy.StrFormart("C:10&@0 ",[t.name]);var e=new ItemCellData,i={item_slot_idx:0,item_type_id:t.item[0],item_count:t.item[1]};e.setItemCellData(i),this.itemcell.data=e,this.tips.textFlow=UtilProxy.StrFormart("炼妖壶 |C:7&@0 | 关激活",[t.copy_id]),this.upbtn.visible=!ZhenbaoProxy.ins().IsZhenbaoPartActive(this.curId),this.red.visible=ZhenbaoProxy.ins().IsZhenbaoPartCanActive(this.curId);var n="",o=AttrProxy.getAttrInfo(t);if(void 0!=o)for(var s=0;s<o.length;s++)""==n?n=UtilProxy.getStr("@0 |C:7&+@1 |",[o[s][0],o[s][1]]):n+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[o[s][0],o[s][1]]);this.prolab.textFlow=UtilProxy.generateTextFlow(n)}},e}(BaseEuiView);__reflect(ZhenbaoPartTips.prototype,"ZhenbaoPartTips"),ViewManager.ins().reg(ZhenbaoPartTips,LayerManager.UI_Main2),window.ZhenbaoPartTips=ZhenbaoPartTips;var ZhenbaoProTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TreasureTips1Skin",this.tipsname.textFlow=UtilProxy.generateTextFlow("|C:10&珍宝总属性|"),this.title.textFlow=UtilProxy.generateTextFlow("|C:10&常规属性|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowTipsInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){this.CloseView()},e.prototype.CloseView=function(){ViewManager.ins().close(this)},e.prototype.ShowTipsInfo=function(){this.zhanValue.text=ZhenbaoProxy.ins().getTotleFight().toString();var t="",e=AttrProxy.getAttrInfo(ZhenbaoProxy.ins().getTotleProInfo());if(void 0!=e)for(var i=0;i<e.length;i++)""==t?t=UtilProxy.getStr("@0 |C:7&+@1 |",[e[i][0],e[i][1]]):t+=UtilProxy.getStr("\n@0 |C:7&+@1 |",[e[i][0],e[i][1]]);this.prolab.textFlow=UtilProxy.generateTextFlow(t)},e}(BaseEuiView);__reflect(ZhenbaoProTips.prototype,"ZhenbaoProTips"),ViewManager.ins().reg(ZhenbaoProTips,LayerManager.UI_Main2),window.ZhenbaoProTips=ZhenbaoProTips;var XiuxianActItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="XiuxianActItemSkin",e.addTouchEvent(e.btn,e.onClick),e.list.itemRenderer=ItemCellEx,e.scroller.viewport=e.list,e.openInfo.text="",e.finish.visible=!1,e.list.dataProvider=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData(),this.refresh()},e.prototype.setData=function(){var t=this.data;if(t){var e,i=[],n=LimitActProxy.ins().GetServerOpenDay()<=WelfareProxy.ins().getXiuxianActDay();e=n?t.mul_items:t.items,t.icon_show.length>0&&i.push([UtilProxy.GetItemCellData(t.icon_show[0][0],1)]);for(var o=0;o<e.length;++o)i.push([UtilProxy.GetItemCellData(e[o][0],e[o][1]),n&&o==e.length-1?!0:!1]);this.list.dataProvider=new eui.ArrayCollection(i)}},e.prototype.refresh=function(){var t=this.data;if(t){this.finish.visible=WelfareProxy.ins().isGetMillionAward(t.id);var e=XiuXianProxy.ins().achie_level||0;e<t.xiuxian_level?(this.openInfo.textFlow=UtilProxy.StrFormart("|修仙@0 阶领取|",[t.xiuxian_level]),this.btn.visible=!1):(this.openInfo.text="",this.btn.visible=!WelfareProxy.ins().isGetMillionAward(t.id))}},e.prototype.onClick=function(t){var e=this.data;e&&WelfareProxy.ins().C2SReqWelfareGetMillionAward(e.id)},e}(BaseItemRender);__reflect(XiuxianActItem.prototype,"XiuxianActItem"),window.XiuxianActItem=XiuxianActItem;var XiuxianActView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="XiuxianActViewSkin",this.list.itemRenderer=XiuxianActItem,this.scroller.viewport=this.list,this.list.dataProvider=new eui.ArrayCollection,this.levelBar.value=0,this.des.text="活动期间，达成修仙目标即可获得大量元宝"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.viewBtn,this.onClick),EventProxy.AddListener(this,EventType.S2CRspWelfareGetMillionAward,this.S2CRspWelfareGetMillionAward),this.setData(),this.refresh()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closeBtn,this.onClick),this.removeTouchEvent(this.viewBtn,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRspWelfareGetMillionAward,this.S2CRspWelfareGetMillionAward)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:ViewManager.ins().close(this);break;case this.viewBtn:ViewManager.ins().open(XiuXianView,1)}},e.prototype.S2CRspWelfareGetMillionAward=function(t){this.setData(),this.refresh()},e.prototype.setData=function(){var t=[];for(var e in GlobalConfig.getMillion_award_dataConfigs())t.push(GlobalConfig.getMillion_award_dataConfigs()[e]);t.sort(this.sort),this.list.dataProvider=new eui.ArrayCollection(t),LimitActProxy.ins().GetServerOpenDay()>WelfareProxy.ins().getXiuxianActDay()?this.actG.visible=!1:(this.actG.visible=!0,TimerManager.ins().doTimer(1e3,0,this.update,this),this.update())},e.prototype.sort=function(t,e){var i=0,n=0;return WelfareProxy.ins().isGetMillionAward(t.id)&&(i=-1),WelfareProxy.ins().isGetMillionAward(e.id)&&(n=-1),n-i},e.prototype.update=function(){var t=WelfareProxy.ins().getXiuxianActLeftTime();t>=0?this.time.text="剩余时间："+UtilProxy.getTimeHMSString(t):(this.actG.visible=!1,TimerManager.ins().remove(this.update,this))},e.prototype.refresh=function(){if(LimitActProxy.ins().GetServerOpenDay()<=WelfareProxy.ins().getXiuxianActDay()){var t=WelfareProxy.ins().GetTotalYBMillionAward(),e=WelfareProxy.ins().GetRewardYBMillionAward();this.value.text=e+"/ "+t,this.levelBar.maximum=t,this.levelBar.value=e}else this.actG.visible=!1},e.getPerDay=function(t,e){if(t>e)return-1;var i=new Date(1e3*t),n=i.getHours()-8,o=i.getMinutes(),s=i.getSeconds(),r=n*DateUtils.SECOND_PER_HOUR+o*DateUtils.SECOND_PER_MIN+s+(e-t),a=Math.ceil(r/86400);return a},e}(BaseEuiView);__reflect(XiuxianActView.prototype,"XiuxianActView"),ViewManager.ins().reg(XiuxianActView,LayerManager.UI_Main),window.XiuxianActView=XiuxianActView;var yjfxView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="yjfxSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn_go,this.onClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_go:var i=GlobalConfig.getMisc_dataConfig(1);if(!i)return;UtilProxy.openView(53,i.yjfx_vip);break;case this.btn_close:ViewManager.ins().close(e)}},e}(BaseEuiView);__reflect(yjfxView.prototype,"yjfxView"),ViewManager.ins().reg(yjfxView,LayerManager.UI_Main2),window.yjfxView=yjfxView;var ZbTaoBtn=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/btn/BtnZbtao.exml",e.setRed(!1),e}return __extends(e,t),e.prototype.setRed=function(t){this.red.visible=t},e.prototype.setSjz=function(t){this.sjz.visible=t},e}(eui.Button);__reflect(ZbTaoBtn.prototype,"ZbTaoBtn");var ZbTaoItemCell=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZbTaoItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.red.visible=!1,this.getOK.visible=!1},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setData()},e.prototype.setData=function(){this.showEquipInfo()},e.prototype.showEquipInfo=function(){if(this.data){this.itemCell.data=this.data.item;var t="";t=this.data.item.itemConfig.reborn<1?this.data.item.itemConfig.requiredlevel+"级":GlobalFunc.getZhuanStr(this.data.item.itemConfig.reborn),this.get.textFlow=UtilProxy.StrFormart("C:7&@0 |",[t])}var e=new egret.Shape;e.graphics.beginFill(0,.6),e.graphics.drawRect(this.m.x-2,this.m.y-2,this.m.width+2,this.m.height+2),e.graphics.endFill(),this.addChild(e),e.visible=this.data.state<2,ZbTaoZhuangProxy.ins().isTure?this.red.visible=1==this.data.state:this.red.visible=!1,this.setChildIndex(this.red,this.numChildren)},e}(BaseItemRender);__reflect(ZbTaoItemCell.prototype,"ZbTaoItemCell"),window.ZbTaoItemCell=ZbTaoItemCell;var ZbTaoZhuang=function(t){function e(){var e=t.call(this)||this;return e.btnList=[],e.manyIndex=0,e.maxAtt=4,e.nowIndex=0,e.isNextWidth=!1,e.nowNum=0,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="ZbTaoSkin",this.hasget.visible=!1,this.showBtnInfo(),this.r_Scroller.viewport=this.btnG},e.prototype.nowBtn=function(){this.index=0,this.r_Scroller.viewport.scrollH=this.r_Scroller.viewport.contentWidth=0;var t=ZbTaoZhuangProxy.ins().dataMsgInfo;if(t){for(var e in t)1==t[e].finish&&(this.manyIndex=Number(e)+1);this.manyIndex<1&&(this.manyIndex=1)}else this.manyIndex=1;this.btnList&&this.btnList.length>0&&(this.btnLfit=this.btnList[this.manyIndex-1],this.btnLfit.icon="common_btn_big_yellow",this.btnLfit.setSjz(!0),this.nowIndex=this.manyIndex-1,ZbTaoZhuangProxy.ins().isTure=!0,this.manyIndex>=2&&(this.lastbtnLfit=this.btnList[this.manyIndex-2],this.lastbtnLfit.setSjz(!1),this.lastbtnLfit.icon="common_btn_smell_yellow_off"),this.isNextWidth?this.r_Scroller.viewport.scrollH=this.nowNum+this.lastbtnLfit.width:(this.nowNum=this.r_Scroller.viewport.contentWidth+this.btnLfit.width*(this.manyIndex-1),this.r_Scroller.viewport.scrollH=this.nowNum))},e.prototype.showBtnInfo=function(){if(this.dataSource=GlobalConfig.getZbTzList(),this.dataSource)for(var t in this.dataSource)this.btnLfit=new ZbTaoBtn,this.btnLfit.label=this.dataSource[t].name,this.btnLfit.icon="common_btn_smell_yellow_off",this.btnList.push(this.btnLfit),this.btnG.addChild(this.btnLfit)},e.prototype.showRoleModel=function(){var t=RoleProxy.ins().getRoleSex(),e=GrowupProxy.ins().fashion_wear,i=WeaponProxy.ins().getDressId(WeaponType.Weapon),n=WeaponProxy.ins().getDressId(WeaponType.Wing);this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(e,n,i,void 0,t))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.nowBtn(),this.elist.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemTap,this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.fanhui,this.onClick),this.addTouchEvent(this.onekey,this.onClick),this.addTouchEvent(this.getIEquip,this.onClick),this.addTouchEvent(this.getItem,this.onClick),EventProxy.AddListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.needUpdate);for(var i=0;i<this.btnList.length;i++)this.addTouchEvent(this.btnList[i],this.onClickListBtn);this.showNoUpdateInfo(),this.needUpdate()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.fanhui,this.onClick),this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.onekey,this.onClick),this.removeTouchEvent(this.getIEquip,this.onClick),this.removeTouchEvent(this.getItem,this.onClick),EventProxy.RemoveListener(this,EventType.S2CRepGrowupEquipSuitUpdate,this.needUpdate);for(var i=0;i<this.btnList.length;i++)this.removeTouchEvent(this.btnList[i],this.onClickListBtn)},e.prototype.showNoUpdateInfo=function(){this.showRoleModel()},e.prototype.showEffected=function(){UtilProxy.GetMovieClipById(88,this.effect),ZbTaoZhuangProxy.ins().clickOkBefor=!1},e.prototype.needUpdate=function(){this.showInfoNeedUpdate(),this.updateLbTitle(),this.showAttr(),this.showItem(),this.btnRed(),this.manyTao(),this.btnVisible(),ZbTaoZhuangProxy.ins().clickOkBefor&&this.showEffected()},e.prototype.manyTao=function(){},e.prototype.btnRed=function(){ZbTaoZhuangProxy.ins().isTure&&(this.onekey.getChildAt(2).visible=ZbTaoZhuangProxy.ins().getRed(this.manyIndex),this.btnLfit=this.btnList[this.manyIndex-1],this.btnLfit.setRed(ZbTaoZhuangProxy.ins().getRed(this.manyIndex)))},e.prototype.btnVisible=function(){this.onekey.visible=ZbTaoZhuangProxy.ins().isTure},e.prototype.showItem=function(){var t=new eui.ArrayCollection,e=ZbTaoZhuangProxy.ins().getItemById(this.manyIndex);if(e&&e.length>0)for(var i=0;i<e.length;i++){var n=new ItemCellData;n.setItemCellData({item_slot_idx:0,item_type_id:e[i][0],item_count:e[i][1]}),t.addItem(n)}this.ItemList.dataProvider=t,this.ItemList.itemRenderer=ItemCell;var o=ZbTaoZhuangProxy.ins().dataMsgInfo[this.manyIndex];o?(1==o.finish&&0==o.award?this.getItem.visible=!0:this.getItem.visible=!1,this.getIEquip.visible=1!=o.finish,this.hasget.visible=1==o.award,this.getItem.getChildAt(2).visible=1==o.finish):(this.getIEquip.visible=!0,this.hasget.visible=this.getItem.visible=!1)},e.prototype.onListItemTap=function(t){this.target=t.itemRenderer,void 0!=this.target},e.prototype.showInfoNeedUpdate=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection),this.arraylist.removeAll();var t=ZbTaoZhuangProxy.ins().getZbTaoById(this.manyIndex);if(t&&t.length>0)for(var e=0;e<t.length;e++){var i=new ItemCellData;i.setItemCellData({item_slot_idx:0,item_type_id:t[e].id[0],item_count:1}),this.arraylist.addItem({item:i,state:t[e].state})}this.elist.dataProvider=this.arraylist,this.elist.itemRenderer=ZbTaoItemCell,this.manyIndex<=9?this.img.source="resource/skins/ZbTaoZhuang/tzsj_font_00"+this.manyIndex+".png":this.img.source="resource/skins/ZbTaoZhuang/tzsj_font_010.png"},e.prototype.updateLbTitle=function(){this.boTitle.text=1==this.manyIndex?"50级装备属性":this.manyIndex-1+"转红装属性",this.txt_fight.text=ZbTaoZhuangProxy.ins().getFightNum().toString()},e.prototype.onClickListBtn=function(t){if(t.currentTarget!=this.btnLfit){var e=ZbTaoZhuangProxy.ins().dataMsgInfo[this.manyIndex];e?(this.index=this.btnList.indexOf(t.currentTarget),this.index+1>this.manyIndex&&e&&0==e.finish&&(ZbTaoZhuangProxy.ins().isTure=!1)):ZbTaoZhuangProxy.ins().isTure=!1,this.index=this.btnList.indexOf(t.currentTarget),void 0!=this.btnLfit&&(this.btnLfit.icon="common_btn_smell_yellow_off"),this.btnLfit=this.btnList[this.index],this.btnLfit.icon="common_btn_big_yellow",this.manyIndex=this.index+1,this.nowIndex==this.index&&(ZbTaoZhuangProxy.ins().isTure=!0),this.needUpdate()}},e.prototype.showAttr=function(){var t=0,e=GlobalConfig.getZbTzAttrList(this.manyIndex);for(var i in e){var n=AttrProxy.getAttrInfo(e[i]);this["lb"+t].textFlow=UtilProxy.StrFormart("点亮@0 件:|&@1 |+&@2 |",[i,n[0][0],n[0][1]]),t++}this.lbText.text="("+ZbTaoZhuangProxy.ins().manyTao(this.manyIndex)+"/10)";var o=ZbTaoZhuangProxy.ins().jihuoMany(this.manyIndex);if(o>0){for(var s=0;o>s;s++)this["lb"+s].textColor=ColorUtil.GREEN;if(o<this.maxAtt)for(var s=o;s<this.maxAtt;s++)this["lb"+s].textColor=ColorUtil.HUISE}else for(var s=0;s<this.maxAtt;s++)this["lb"+s].textColor=ColorUtil.HUISE},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn_close:ViewManager.ins().close(this);
break;case this.onekey:ZbTaoZhuangProxy.ins().getRed(this.manyIndex)?(ZbTaoZhuangProxy.ins().clickOkBefor=!0,ZbTaoZhuangProxy.ins().C2SReqGrowupEquipSuitLightUp(this.manyIndex)):TipsControl.ins().showTips("当前没有可以点亮的装备");break;case this.getIEquip:ViewManager.ins().OpenViewById(8,1);break;case this.getItem:this.isNextWidth=!0,ZbTaoZhuangProxy.ins().C2SReqGrowupEquipSuitGetAward(this.manyIndex),this.nowBtn();break;case this.fanhui:ViewManager.ins().close(this)}},e}(BaseEuiView);__reflect(ZbTaoZhuang.prototype,"ZbTaoZhuang"),ViewManager.ins().reg(ZbTaoZhuang,LayerManager.UI_Main2),window.ZbTaoZhuang=ZbTaoZhuang;var ZhigouGift_1=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZhigouGift_1Skin",this.list.itemRenderer=ZhigouItem,this.tips.textFlow=UtilProxy.generateTextFlow("C:7&(注：充值计算vip经验和充值活动)")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curSubType=t[0];var i=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);i.sort(this.sortCfs);var n=i[0];n&&(this.titlepic.source=n.icon[0]),this.InitBtn(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.ongetbtnClick);for(var o=0;o<this.btns.length;o++)this.addTouchEvent(this.btns[o],this.onbtnClick);EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.curindex=0,void 0==this.curbtn&&(this.curbtn=this.btns[this.curindex]),this.curbtn.icon="xianshichongzhi__btn_01",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.ongetbtnClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.model.removeChildren()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){this.curindex=this.btns.indexOf(t.currentTarget),void 0!=this.curbtn&&(this.curbtn.icon="xianshichongzhi__btn_02"),this.curbtn=this.btns[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",this.ShowInfo()},e.prototype.ongetbtnClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);e.sort(this.sortCfs);var i=e[this.curindex];if(void 0!=i){var n=LimitActProxy.ins().GetActivityData(i.id);if(n&&n.is_completed)LimitActProxy.ins().C2SReqLimitActGetReward(i.id);else{var o=i.recharge_list[0],s=GlobalConfig.getRechargeBagConfig(o);if(s){var r={app_subject:s.name,order_amt:100*s.amount,data:s};SdkManager.isUseSdk?SdkManager.ins().commitPay(r):TipsControl.ins().showTips("没有SDK")}}}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);t.sort(this.sortCfs);for(var e=0;e<this.btns.length;e++)if(this.btns[e].getChildAt(2).visible=!1,t[e]){var i=LimitActProxy.ins().GetActivityData(t[e].id);this.btns[e].getChildAt(2).visible=i&&!i.is_get&&i.is_completed}var n=t[this.curindex];if(void 0!=n){this.fontpic.source=n.icon[1],this.namelab.textFlow=UtilProxy.generateTextFlow("C:5&"+n.icon[2]),this.lab_1.text=n.icon[3],this.lab_2.textFlow=UtilProxy.generateTextFlow("C:10&"+n.icon[4]),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var o=n.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),e=0;e<r.length;e++){var a=UtilProxy.GetItemCellData(r[e][0].id,r[e][0].num);this.arraylist.addItem(a)}var h=LimitActProxy.ins().GetActivityData(n.id);h&&h.params[0]?h.params[0]:0;if(this.btn.visible=void 0==h||0==h.is_get,this.btn.visible&&(this.btn.label=h&&h.is_completed?"领取奖励":"购 买"),this.hasget.visible=h&&h.is_get,this.red.visible=h&&h.is_completed&&!h.is_get,this.endtime=LimitActProxy.ins().GetActEndTime(n),this.ShowColdTime(),this.model.removeChildren(),this.model.x=n.charRes_wuqi[2],this.model.y=n.charRes_wuqi[3],this.showpic.visible=1==n.charRes_wuqi[0],2==n.charRes_wuqi[0]){var l=new egret.MovieClip;UtilProxy.GetMovieClip(n.charRes_wuqi[1],l,-1,void 0),this.model.addChild(l)}else 3==n.charRes_wuqi[0]?UtilProxy.GetMovieClipById(Number(n.charRes_wuqi[1]),this.model):1==n.charRes_wuqi[0]&&(this.showpic.source=n.charRes_wuqi[1])}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间：@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.sortCfs=function(t,e){return t.act_params[0]<e.act_params[0]?-1:t.act_params[0]>e.act_params[0]?1:0},e.prototype.InitBtn=function(){var t=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);t.sort(this.sortCfs),this.btns=[],this.btn_g.removeChildren();for(var e=0;e<t.length;e++){var i=new eui.Button;i.skinName=Btn14Skin,i.width=98,i.height=35,i.icon="xianshichongzhi__btn_02",i.label=UtilProxy.getStr("充@0  元",[t[e].act_params[0]/LimitActProxy.ins().rechargeNun]),this.btns.push(i),this.btn_g.addChild(i)}},e}(BaseEuiView);__reflect(ZhigouGift_1.prototype,"ZhigouGift_1"),ViewManager.ins().reg(ZhigouGift_1,LayerManager.UI_Main2),window.ZhigouGift_1=ZhigouGift_1;var ZhigouGift_2=function(t){function e(){var e=t.call(this)||this;return e.endtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZhigouGift_2Skin",this.list.itemRenderer=ZhigouItem,this.tips.textFlow=UtilProxy.generateTextFlow("C:7&(注：充值计算vip经验和充值活动)")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curSubType=t[0];var i=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);i.sort(this.sortCfs);var n=i[0];n&&(this.titlepic.source=n.icon[0]),this.InitBtn(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.ongetbtnClick);for(var o=0;o<this.btns.length;o++)this.addTouchEvent(this.btns[o],this.onbtnClick);EventProxy.AddListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.curindex=0,void 0==this.curbtn&&(this.curbtn=this.btns[this.curindex]),this.curbtn.icon="xianshichongzhi__btn_01",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.ongetbtnClick);for(var i=0;i<this.btns.length;i++)this.removeTouchEvent(this.btns[i],this.onbtnClick);EventProxy.RemoveListener(this,EventType.S2CRepLimitActUpdate,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepLimitActGetReward,this.ShowInfo),this.model.removeChildren()},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnClick=function(t){this.curindex=this.btns.indexOf(t.currentTarget),void 0!=this.curbtn&&(this.curbtn.icon="xianshichongzhi__btn_02"),this.curbtn=this.btns[this.curindex],this.curbtn.icon="xianshichongzhi__btn_01",this.ShowInfo()},e.prototype.ongetbtnClick=function(t){var e=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);e.sort(this.sortCfs);var i=e[this.curindex];if(void 0!=i){var n=LimitActProxy.ins().GetActivityData(i.id);if(n&&n.is_completed)LimitActProxy.ins().C2SReqLimitActGetReward(i.id);else{var o=i.recharge_list[0],s=GlobalConfig.getRechargeBagConfig(o);if(s){var r={app_subject:s.name,order_amt:100*s.amount,data:s};SdkManager.isUseSdk?SdkManager.ins().commitPay(r):TipsControl.ins().showTips("没有SDK")}}}},e.prototype.ShowInfo=function(){var t=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);t.sort(this.sortCfs);for(var e=0;e<this.btns.length;e++)if(this.btns[e].getChildAt(2).visible=!1,t[e]){var i=LimitActProxy.ins().GetActivityData(t[e].id);this.btns[e].getChildAt(2).visible=i&&!i.is_get&&i.is_completed}var n=t[this.curindex];if(void 0!=n){this.namelab.textFlow=UtilProxy.generateTextFlow("C:5&"+n.icon[2]),this.lab_1.text=n.icon[3],this.lab_2.textFlow=UtilProxy.generateTextFlow("C:10&"+n.icon[4]),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist),this.arraylist.removeAll();var o=n.act_award[0];if(o>0)for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),e=0;e<r.length;e++){var a=UtilProxy.GetItemCellData(r[e][0].id,r[e][0].num);this.arraylist.addItem(a)}var h=LimitActProxy.ins().GetActivityData(n.id);h&&h.params[0]?h.params[0]:0;if(this.btn.visible=void 0==h||0==h.is_get,this.btn.visible&&(this.btn.label=h&&h.is_completed?"领取奖励":"购 买"),this.hasget.visible=h&&h.is_get,this.red.visible=h&&h.is_completed&&!h.is_get,this.endtime=LimitActProxy.ins().GetActEndTime(n),this.ShowColdTime(),this.model.removeChildren(),this.model.x=n.charRes_wuqi[2],this.model.y=n.charRes_wuqi[3],this.showpic.visible=1==n.charRes_wuqi[0],2==n.charRes_wuqi[0]){var l=new egret.MovieClip;UtilProxy.GetMovieClip(n.charRes_wuqi[1],l,-1,void 0),this.model.addChild(l)}else 3==n.charRes_wuqi[0]?UtilProxy.GetMovieClipById(Number(n.charRes_wuqi[1]),this.model):1==n.charRes_wuqi[0]&&(this.showpic.source=n.charRes_wuqi[1])}},e.prototype.ShowColdTime=function(){this.SetTimeLab(),this.endtime>GameLogic.ins().getServerTime()?(TimerManager.ins().remove(this.SetTimeLab,this),TimerManager.ins().doTimer(1e3,this.endtime-GameLogic.ins().getServerTime()+1,this.SetTimeLab,this,this.ShowColdTime,this)):this.timelab.text=""},e.prototype.SetTimeLab=function(){this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间：@0 |",[UtilProxy.getTimeHMSString(this.endtime-GameLogic.ins().getServerTime())])},e.prototype.sortCfs=function(t,e){return t.act_params[0]<e.act_params[0]?-1:t.act_params[0]>e.act_params[0]?1:0},e.prototype.InitBtn=function(){var t=LimitActProxy.ins().GetActivityCfgs(4,this.curSubType);t.sort(this.sortCfs),this.btns=[],this.btn_g.removeChildren();for(var e=0;e<t.length;e++){var i=new eui.Button;i.skinName=Btn14Skin,i.width=98,i.height=35,i.icon="xianshichongzhi__btn_02",i.label=UtilProxy.getStr("充@0  元",[t[e].act_params[0]/LimitActProxy.ins().rechargeNun]),this.btns.push(i),this.btn_g.addChild(i)}},e}(BaseEuiView);__reflect(ZhigouGift_2.prototype,"ZhigouGift_2"),ViewManager.ins().reg(ZhigouGift_2,LayerManager.UI_Main2),window.ZhigouGift_2=ZhigouGift_2;var ZhigouItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZhigouItemSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){var e=this.data;this.cell.data=e;var i=this.data,n=i.itemConfig;this.namelab.textFlow=UtilProxy.StrFormart("|C:@0 &@1 |",[BagProxy.QUALITY_COLOR[n.quality-1],n.name])}},e}(BaseItemRender);__reflect(ZhigouItem.prototype,"ZhigouItem"),window.ZhigouItem=ZhigouItem;var ZPFightReportItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="ZPFightReportItemSkin"},e.prototype.dataChanged=function(){var t=this.data;if(void 0!=t){var e=ZPZBProxy.ins().GetAwardRankInfoByRank(2,t.id);this.ranklab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.id]),this.namelab.textFlow=e?UtilProxy.StrFormart("|C:10&S@0 .@1 |",[e.server_id,e.name]):UtilProxy.generateTextFlow("|C:10&虚位以待|"),this.lab1.text=e?GlobalConfig.getFaction_dataConfig(e.faction_id).faction_name:"无",this.lab2.text=e?e.score:0}},e.prototype.onClick=function(t){var e=this.data;void 0!=e&&(ViewManager.ins().open(ZPShowAwardTips,e.id),t.stopImmediatePropagation())},e}(BaseItemRender);__reflect(ZPFightReportItem.prototype,"ZPFightReportItem"),window.ZPFightReportItem=ZPFightReportItem;var ZPFightReportView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPFightReportSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&战场统计|"),this.mytitle1.textFlow=UtilProxy.generateTextFlow("|C:10&进攻方|"),this.mytitle2.textFlow=UtilProxy.generateTextFlow("|C:10&防守方|"),this.mytitle3.textFlow=UtilProxy.generateTextFlow("|C:10&我的战绩|"),this.mytitle4.textFlow=UtilProxy.generateTextFlow("|C:10&累积奖励|"),this.mytitle5.textFlow=UtilProxy.generateTextFlow("|C:10&积分说明|"),this.gongs=[this.gong1,this.gong2],this.jifenlabs=[this.jifenlab1,this.jifenlab2],this.myawardlist.itemRenderer=ItemCell,this.list.itemRenderer=ZPFightReportItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn1,this.onbtnsClick),this.addTouchEvent(this.btn2,this.onbtnsClick),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateBattleInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionAddScoreNotice,this.ShowInfo),ZPZBProxy.ins().C2SReqFactionGetFactionAttackBattleInfo(),this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=this.btn1,this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn1,this.onbtnsClick),this.removeTouchEvent(this.btn2,this.onbtnsClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateBattleInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionAddScoreNotice,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnsClick=function(t){this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=t.currentTarget,this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.ongetClick=function(t){return 2==ZPZBProxy.ins().daily_award?void TipsControl.ins().showTips("今日已领取"):void ZPZBProxy.ins().C2SReqFactionGetAttackJoinAward()},e.prototype.ShowInfo=function(){this.g1.visible=this.curbtn==this.btn1,this.g2.visible=this.curbtn==this.btn2,this.ShowInfo1(),this.ShowInfo2()},e.prototype.ShowInfo1=function(){var t=GlobalConfig.getFaction_attack_base_dataConfig(1);this.mytips.textFlow=UtilProxy.generateTextFlow(t.jifen_tips),this.awardarray||(this.awardarray=new eui.ArrayCollection,this.myawardlist.dataProvider=this.awardarray),this.awardarray.removeAll();for(var e in ZPZBProxy.ins().item_list){var i=UtilProxy.GetItemCellData(ZPZBProxy.ins().item_list[e].item_id,ZPZBProxy.ins().item_list[e].count);this.awardarray.addItem(i)}this.mykill.text="击杀："+ZPZBProxy.ins().kill_num,this.myjifen.text="我的积分："+ZPZBProxy.ins().my_score,ZPZBProxy.ins().defend&&(this.shoulab.text=GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().defend.faction_id).faction_name,this.jifenlab3.text=ZPZBProxy.ins().defend.score);var n=0;for(var e in ZPZBProxy.ins().attack_list)this.gongs[n].text=GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().attack_list[e].faction_id).faction_name,this.jifenlabs[n].text=ZPZBProxy.ins().attack_list[e].score,n+=1},e.prototype.ShowInfo2=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=GlobalConfig.getFaction_attack_rank_awardList();this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e]);this.ranklab.text=UtilProxy.getStr("我的排名：@0 ",[ZPZBProxy.ins().my_rank>0&&ZPZBProxy.ins().my_rank<=10?ZPZBProxy.ins().my_rank:"10+"]),this.countlab.text=UtilProxy.getStr("我的积分：@0 ",[ZPZBProxy.ins().my_score])},e}(BaseEuiView);__reflect(ZPFightReportView.prototype,"ZPFightReportView"),ViewManager.ins().reg(ZPFightReportView,LayerManager.UI_Main2),window.ZPFightReportView=ZPFightReportView;var ZPShowAwardTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShowAwardTipsSkin",this.list.itemRenderer=ItemCell,this.tips.textFlow=UtilProxy.generateTextFlow("|C:7&奖励在活动结束时，通过邮件发送|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.curid=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=GlobalConfig.getFaction_attack_rank_awardConfig(this.curid).award_items;this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(UtilProxy.GetItemCellData(t[e][0],t[e][1]));this.lab.textFlow=UtilProxy.StrFormart("|C:10&宗派争霸第@0 名奖励|",[this.curid])},e}(BaseEuiView);__reflect(ZPShowAwardTips.prototype,"ZPShowAwardTips"),ViewManager.ins().reg(ZPShowAwardTips,LayerManager.UI_Main2),window.ShowAwardTipsView=ZPShowAwardTips;var ZPZBAwardItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onClick)},e.prototype.setSkinName=function(){this.skinName="ZPFightReportItemSkin"},e.prototype.dataChanged=function(){var t=this.data;if(void 0!=t){var e=ZPZBProxy.ins().GetAwardRankInfoByRank(1,t.id);this.ranklab.textFlow=UtilProxy.StrFormart("|C:10&@0 |",[t.id]),this.namelab.textFlow=e?UtilProxy.StrFormart("|C:10&S@0 .@1 |",[e.server_id,e.name]):UtilProxy.generateTextFlow("|C:10&虚位以待|"),this.lab1.text=e?GlobalConfig.getFaction_dataConfig(e.faction_id).faction_name:"无",this.lab2.text=e?e.score:0}},e.prototype.onClick=function(t){var e=this.data;void 0!=e&&(ViewManager.ins().open(ZPShowAwardTips,e.id),t.stopImmediatePropagation())},e}(BaseItemRender);__reflect(ZPZBAwardItem.prototype,"ZPZBAwardItem"),window.ZPZBAwardItem=ZPZBAwardItem;var ZPZBAwardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBAwardSkin",this.titlelab.textFlow=UtilProxy.generateTextFlow("|C:10&参与奖励|"),this.titlelab0.textFlow=UtilProxy.generateTextFlow("|C:10&胜利者每日奖励|"),this.titlelab1.textFlow=UtilProxy.generateTextFlow("|C:10&胜利奖励|"),this.titlelab2.textFlow=UtilProxy.generateTextFlow("|C:10&失败奖励|"),this.awardlist0.itemRenderer=ItemCell,this.awardlist1.itemRenderer=ItemCell,this.awardlist2.itemRenderer=ItemCell,this.list.itemRenderer=ZPZBAwardItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.daybtn,this.ongetClick),this.addTouchEvent(this.btn0,this.onbtnsClick),this.addTouchEvent(this.btn1,this.onbtnsClick),EventProxy.AddListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.ShowInfo),this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=this.btn0,this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.daybtn,this.ongetClick),this.removeTouchEvent(this.btn0,this.onbtnsClick),this.removeTouchEvent(this.btn1,this.onbtnsClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.ShowInfo)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnsClick=function(t){this.curbtn&&(this.curbtn.icon="common_btn_big_yellow_off"),this.curbtn=t.currentTarget,this.curbtn.icon="common_btn_big_yellow",this.ShowInfo()},e.prototype.ongetClick=function(t){return 2==ZPZBProxy.ins().daily_award?void TipsControl.ins().showTips("今日已领取"):void ZPZBProxy.ins().C2SReqFactionGetAttackJoinAward()},e.prototype.ShowInfo=function(){this.g0.visible=this.curbtn==this.btn0,this.g1.visible=this.curbtn==this.btn1,this.ShowInfo1(),this.ShowInfo2()},e.prototype.ShowInfo1=function(){var t=GlobalConfig.getFaction_attack_base_dataConfig(1);this.SetAwardList(this.awardarray0,this.awardlist0,t.daily_award),this.SetAwardList(this.awardarray1,this.awardlist1,t.win_award),this.SetAwardList(this.awardarray2,this.awardlist2,t.lose_award),this.daybtn.visible=1==ZPZBProxy.ins().daily_award,this.red.visible=1==ZPZBProxy.ins().daily_award,this.hasget.visible=2==ZPZBProxy.ins().daily_award},e.prototype.SetAwardList=function(t,e,i){t||(t=new eui.ArrayCollection,e.dataProvider=t),t.removeAll();for(var n in i){var o=UtilProxy.GetItemCellData(i[n][0],i[n][1]);t.addItem(o)}},e.prototype.ShowInfo2=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=GlobalConfig.getFaction_attack_rank_awardList();this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e]);this.ranklab.text=UtilProxy.getStr("我的排名：@0 ",[ZPZBProxy.ins().my_jion_rank>0&&ZPZBProxy.ins().my_jion_rank<=10?ZPZBProxy.ins().my_jion_rank:"10+"]),this.countlab.text=UtilProxy.getStr("我的积分：@0 ",[ZPZBProxy.ins().my_jion_score])},e}(BaseEuiView);__reflect(ZPZBAwardView.prototype,"ZPZBAwardView"),ViewManager.ins().reg(ZPZBAwardView,LayerManager.UI_Main2),window.ZPZBAwardView=ZPZBAwardView;var ZPZBEndView=function(t){function e(){var e=t.call(this)||this;return e.coldtime=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBEndSkin",this.title1.textFlow=UtilProxy.generateTextFlow("|C:10&胜 / 负|"),this.title2.textFlow=UtilProxy.generateTextFlow("|C:10&宗门|"),this.title3.textFlow=UtilProxy.generateTextFlow("|C:10&积分|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.btn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn,this.onCloseClick),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){this.finshtime()},e.prototype.ShowInfo=function(){this.win.visible=0==ZPZBProxy.ins().result,this.lost.visible=1==ZPZBProxy.ins().result;var t=GlobalConfig.getFaction_attack_base_dataConfig(1),e=GlobalConfig.getWeaponResById(t.award_shenbing);this.item2.data=UtilProxy.GetItemCellData(e.icon,1);var i=GlobalConfig.getTitleById(t.award_title);this.item1.data=UtilProxy.GetItemCellData(i.tips_id,1),ZPZBProxy.ins().role_info&&ZPZBProxy.ins().role_info.role_id?this.namelab.text=UtilProxy.getStr("S@0 .@1 ",[ZPZBProxy.ins().role_info.server_id,ZPZBProxy.ins().role_info.name]):this.namelab.text="虚位以待",this.namelab0.textFlow=UtilProxy.generateTextFlow(BagProxy.ins().getItemColorName(e.icon));var n="",o="",s="",r="";if(0==ZPZBProxy.ins().endstate){n=GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().defend.faction_id).faction_name,s=ZPZBProxy.ins().defend.score;for(var a in ZPZBProxy.ins().attack_list)o=o+GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().attack_list[a].faction_id).faction_name+"\n",r=r+ZPZBProxy.ins().attack_list[a].score+"\n"}else{o=GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().defend.faction_id).faction_name,r=ZPZBProxy.ins().defend.score;for(var a in ZPZBProxy.ins().attack_list)n=n+GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().attack_list[a].faction_id).faction_name+"\n",s=s+ZPZBProxy.ins().attack_list[a].score+"\n"}this.zmlab1.text=n,this.zmlab2.text=o,this.jifenlab1.text=s,this.jifenlab2.text=r,this.win_lab.textFlow=UtilProxy.StrFormart("|C:10&占领宗门：||C:7&@0 |",[GlobalConfig.getFaction_dataConfig(ZPZBProxy.ins().win_faction_id).faction_name]),this.coldtime=8,this.time.textFlow=UtilProxy.StrFormart("退出倒计时 |C:7&(@0 s)|",[this.coldtime]),TimerManager.ins().doTimer(1e3,8,this.SetTimelab,this,this.finshtime,this)},e.prototype.SetTimelab=function(){this.coldtime=this.coldtime-1,this.time.textFlow=UtilProxy.StrFormart("退出倒计时 |C:7&(@0 s)|",[this.coldtime])},e.prototype.finshtime=function(){ViewManager.ins().close(this);var t=GameLogic.ins().getLastScene(),e=GlobalConfig.getSceneConfigById(t);SceneControl.ins().C2STransferScene(GameLogic.ins().getLastScene(),e.x,e.y)},e}(BaseEuiView);__reflect(ZPZBEndView.prototype,"ZPZBEndView"),ViewManager.ins().reg(ZPZBEndView,LayerManager.UI_Main2),window.ZPZBEndView=ZPZBEndView;var ZPZBInAwardItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=ItemCell},e.prototype.setSkinName=function(){this.skinName="ZPZBInAwardItemSkin"},e.prototype.dataChanged=function(){var t=this.data;this.lab1.text=UtilProxy.getStr("积分达@0 可领取",[t.score]),this.lab2.textFlow=UtilProxy.StrFormart("积分：|C:@0 &@1 /@2 |",[ZPZBProxy.ins().my_score>=t.score?7:4,ZPZBProxy.ins().my_score,t.score]),this.tipslab.textFlow=ZPZBProxy.ins().my_score>=t.score?UtilProxy.generateTextFlow("|C:7&奖励已发放|"):UtilProxy.generateTextFlow("|C:4&积分不足|"),this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var e=t.award_items;this.arraylist.removeAll();for(var i in e)this.arraylist.addItem(UtilProxy.GetItemCellData(e[i][0],e[i][1]))},e}(BaseItemRender);__reflect(ZPZBInAwardItem.prototype,"ZPZBInAwardItem"),window.ZPZBInAwardItem=ZPZBInAwardItem;var ZPZBInAwardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBInAwardSkin",this.list.itemRenderer=ZPZBInAwardItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){this.arraylist||(this.arraylist=new eui.ArrayCollection,this.list.dataProvider=this.arraylist);var t=GlobalConfig.getFaction_attack_score_awardList();this.arraylist.removeAll();for(var e in t)this.arraylist.addItem(t[e])},e}(BaseEuiView);__reflect(ZPZBInAwardView.prototype,"ZPZBInAwardView"),ViewManager.ins().reg(ZPZBInAwardView,LayerManager.UI_Main2),window.ZPZBInAwardView=ZPZBInAwardView;var ZPZBKillTips=function(t){function e(){var e=t.call(this)||this;return e.curindex=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBKillTipsSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curindex=t[0],this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFaction_attack_base_dataConfig(1),e=t.kill_notice[this.curindex];e&&(this.killpic1.source=e[2],this.killpic2.source=e[3]),SetProxy.ins().useHead()<=0?this.icon.source="common_touxiang_0"+RoleProxy.ins().getRoleSex():this.icon.source=SetProxy.ins().getHeadIcon(SetProxy.ins().useHead()),SetProxy.ins().useHeadFrame()<=0?this.bg.source="shezhi_touxiangkuang_01":this.bg.source=SetProxy.ins().getHeadFrame(SetProxy.ins().useHeadFrame()),this.namelab.text=UtilProxy.getStr("S@0 .@1 ",[RoleProxy.ins().getRoleServerId(),RoleProxy.ins().getRoleName()]),TimerManager.ins().remove(this.CloseView,this),TimerManager.ins().doTimer(5e3,1,this.CloseView,this)},e.prototype.CloseView=function(){ViewManager.ins().close(this)},e}(BaseEuiView);__reflect(ZPZBKillTips.prototype,"ZPZBKillTips"),ViewManager.ins().reg(ZPZBKillTips,LayerManager.UI_Popup),window.ZPZBKillTips=ZPZBKillTips;var ZPZBLastInfoView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBLastInfoSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&上期战况|"),this.list.itemRenderer=ZPZBLastItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=ZPZBProxy.ins().last_data;if(void 0!=t){this.lab.textFlow=UtilProxy.StrFormart("|C:7&守城宗门：@0 |",[0==t.code?"无":GlobalConfig.getFaction_dataConfig(t.defend_faction_id).faction_name]),this.array||(this.array=new eui.ArrayCollection,this.list.dataProvider=this.array);var e=t.list;this.array.removeAll();for(var i in e)this.array.addItem(e[i])}},e}(BaseEuiView);__reflect(ZPZBLastInfoView.prototype,"ZPZBLastInfoView"),ViewManager.ins().reg(ZPZBLastInfoView,LayerManager.UI_Main2),window.ZPZBLastInfoView=ZPZBLastInfoView;var ZPZBLastItem=function(t){function e(){var e=t.call(this)||this;return e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setSkinName=function(){this.skinName="ZPZBLastItemSkin"},e.prototype.dataChanged=function(){void 0!=this.data&&(this.rankpic.source="top_icon_0"+this.data.rank,this.lab1.text=GlobalConfig.getFaction_dataConfig(this.data.faction_id).faction_name,this.lab2.text=this.data.leader_name,this.lab3.text=this.data.score,this.winpic.visible=this.data.is_win,this.winlab.visible=this.data.is_win)},e}(BaseItemRender);__reflect(ZPZBLastItem.prototype,"ZPZBLastItem"),window.ZPZBLastItem=ZPZBLastItem;var ZPZBMainView=function(t){function e(){var e=t.call(this)||this;return e.zppics=["zongpaizhengba_icon_yg","zongpaizhengba_icon_jl","zongpaizhengba_icon_kl"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBMainSkin",this.comview.initUI(),this.comview.SetName("title_zongpaizhengba"),this.facpics=[this.facpic2,this.facpic3],this.lab1.textFlow=UtilProxy.generateTextFlow("|C:10&主宰神兵|"),this.lab2.textFlow=UtilProxy.generateTextFlow("|C:10&主宰称号|"),this.lab3.textFlow=UtilProxy.generateTextFlow("|C:10&守方|"),this.lab4.textFlow=UtilProxy.generateTextFlow("|C:10&攻方|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.open(),this.addTouchEvent(this.closebtn,this.onCloseClick),this.addTouchEvent(this.btn,this.onbtnsClick),this.addTouchEvent(this.btn0,this.onbtnsClick),this.addTouchEvent(this.btn1,this.onbtnsClick),this.addTouchEvent(this.btn2,this.onbtnsClick),EventProxy.AddListener(this,EventType.S2CRepFactionGetFactionattackInfo,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.ShowInfo),EventProxy.AddListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.ShowInfo),ZPZBProxy.ins().C2SReqFactionGetFactionattackInfo(),this.ShowInfo(),ViewManager.ins().close(FacView)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.comview.close(),this.removeTouchEvent(this.closebtn,this.onCloseClick),this.removeTouchEvent(this.btn,this.onbtnsClick),this.removeTouchEvent(this.btn0,this.onbtnsClick),this.removeTouchEvent(this.btn1,this.onbtnsClick),this.removeTouchEvent(this.btn2,this.onbtnsClick),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetFactionattackInfo,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.ShowInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionGetAttackDailyAward,this.ShowInfo),TimerManager.ins().removeAll(this)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnsClick=function(t){switch(t.currentTarget){case this.btn:ZPZBProxy.ins().C2SReqFactionEnterFactionAttack();
break;case this.btn0:ViewManager.ins().open(ZPZBTipsView,1);break;case this.btn1:ViewManager.ins().open(ZPZBLastInfoView);break;case this.btn2:ViewManager.ins().open(ZPZBAwardView)}},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFaction_attack_base_dataConfig(1),e=GlobalConfig.getWeaponResById(t.award_shenbing);e&&(this.item1.data=UtilProxy.GetItemCellData(e.icon,1));var i=GlobalConfig.getTitleById(t.award_title);i&&(this.item2.data=UtilProxy.GetItemCellData(i.tips_id,1),this.chenghao.source=TitleProxy.title_icon_path+i.title_res+".png");var n=1,o=0;if(ZPZBProxy.ins().role_info&&ZPZBProxy.ins().role_info.role_id?(n=ZPZBProxy.ins().role_info.prof,o=ZPZBProxy.ins().role_info.faction_id,this.namelab.text=UtilProxy.getStr("【@0 】S@1 .@2 ",[GlobalConfig.getFaction_dataConfig(o).faction_name,ZPZBProxy.ins().role_info.server_id,ZPZBProxy.ins().role_info.name])):this.namelab.text="虚位以待",this.model.removeChildren(),this.model.addChild(UtilProxy.GetRoleObjectById(o,0,t.award_shenbing,void 0,n)),this.pvppic.visible=!ZPZBProxy.ins().IsInZPZBTime(),this.btn.visible=ZPZBProxy.ins().IsInZPZBTime(),this.red.visible=1==ZPZBProxy.ins().daily_award,ZPZBProxy.ins().defend_faction_id>0){this.facpic1.source=this.zppics[ZPZBProxy.ins().defend_faction_id-1];for(var s=0,r=0;r<this.zppics.length;r++)r!=ZPZBProxy.ins().defend_faction_id-1&&(this.facpics[s].source=this.zppics[r],s+=1)}this.ShowColdTime()},e.prototype.ShowColdTime=function(){TimerManager.ins().remove(this.SetTimeLab,this),this.SetTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)},e.prototype.SetTimeLab=function(){var t=ZPZBProxy.ins().nexttime,e=GameLogic.ins().getServerTime();if(t>e){var i=UtilProxy.getTimeStr(t-e);this.timelab.textFlow=0==ZPZBProxy.ins().state?UtilProxy.StrFormart("|C:7&宗派争霸@0 后开启|",[i]):UtilProxy.StrFormart("|C:4&宗派争霸@0 后结束|",[i])}else this.timelab.text="",ZPZBProxy.ins().C2SReqFactionGetFactionattackInfo(),TimerManager.ins().remove(this.SetTimeLab,this)},e}(BaseEuiView);__reflect(ZPZBMainView.prototype,"ZPZBMainView"),ViewManager.ins().reg(ZPZBMainView,LayerManager.UI_Main),window.ZPZBMainView=ZPZBMainView;var ZPZBSceneItem=function(t){function e(){var e=t.call(this)||this;return e.obj_id=-1,e.setSkinName(),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.pic.visible=!1},e.prototype.setSkinName=function(){this.skinName="ZPZBSceneItemSkin"},e.prototype.dataChanged=function(){if(1==this.data.type){var t=GameLogic.ins().getEnitityByBossId(this.data.bossid),e=GlobalConfig.getMonsterConfigById(this.data.bossid);e&&(this.icon.source=e.head_res,this.namelab.text=e.name),this.bar.maximum=t.getHPMax(),this.bar.value=t.getHP(),this.obj_id=t.handle}else{var t=this.data.roleinfo;this.icon.source="common_morentouxaing_0"+t.getJob(),this.namelab.text=UtilProxy.getStr("@0 ",[t.getName()]),this.bar.maximum=t.getHPMax(),this.bar.value=t.getHP(),this.obj_id=t.handle}this.pic.visible=this.obj_id==GameMap.centerEntity.AI.getTargetId()},e.prototype.SetInSelect=function(t){this.pic.visible=t},e.prototype.getObj_Id=function(){return this.obj_id},e}(BaseItemRender);__reflect(ZPZBSceneItem.prototype,"ZPZBSceneItem"),window.ZPZBSceneItem=ZPZBSceneItem;var ZPZBSceneView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBSceneSkin",this.titlelab.textFlow=UtilProxy.generateTextFlow("|C:10&可以攻击|"),this.roleitemlist=[this.roleitem1,this.roleitem2,this.roleitem3,this.roleitem4,this.roleitem5],this.lab1.textFlow=UtilProxy.generateTextFlow("|C:10&昵称|"),this.lab2.textFlow=UtilProxy.generateTextFlow("|C:10&杀人数|"),this.lab3.textFlow=UtilProxy.generateTextFlow("|C:10&积分|"),this.shoulist=[this.shou1,this.shou2,this.shou3]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.shoubtn,this.onbtnsClick),this.addTouchEvent(this.shoubtn0,this.onbtnsClick),this.addTouchEvent(this.wenbtn,this.onbtnsClick),this.addTouchEvent(this.awardbtn,this.onbtnsClick),this.addTouchEvent(this.tjbtn,this.onbtnsClick),this.addTouchEvent(this.btnkill,this.onbtnsClick),this.addTouchEvent(this.Bossitem,this.onSceneItemClick);for(var i=0;i<this.roleitemlist.length;i++)this.addTouchEvent(this.roleitemlist[i],this.onSceneItemClick);EventProxy.AddListener(this,EventType.S2CRepFactionUpdateObjInfo,this.ShowAttackInfo),EventProxy.AddListener(this,EventType.S2CRepFactionUpdateFirstRoleInfo,this.ShowTopInfo),EventProxy.AddListener(this,EventType.UpdateZPZBSceneItem,this.ShowLeftInfo),EventProxy.AddListener(this,EventType.S2CVisibleObjEnterRole,this.ShowLeftInfo),EventProxy.AddListener(this,EventType.UpdateAttackType,this.updateAttacktype),EventProxy.AddListener(this,EventType.ChangeMainAchorState,this.SetViewVsisible),this.kill_g.visible=!1,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.shoubtn,this.onbtnsClick),this.removeTouchEvent(this.shoubtn0,this.onbtnsClick),this.removeTouchEvent(this.wenbtn,this.onbtnsClick),this.removeTouchEvent(this.awardbtn,this.onbtnsClick),this.removeTouchEvent(this.tjbtn,this.onbtnsClick),this.removeTouchEvent(this.btnkill,this.onbtnsClick),this.removeTouchEvent(this.Bossitem,this.onSceneItemClick);for(var i=0;i<this.roleitemlist.length;i++)this.removeTouchEvent(this.roleitemlist[i],this.onSceneItemClick);EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateObjInfo,this.ShowAttackInfo),EventProxy.RemoveListener(this,EventType.S2CRepFactionUpdateFirstRoleInfo,this.ShowTopInfo),EventProxy.RemoveListener(this,EventType.UpdateZPZBSceneItem,this.ShowLeftInfo),EventProxy.RemoveListener(this,EventType.S2CVisibleObjEnterRole,this.ShowLeftInfo),EventProxy.RemoveListener(this,EventType.UpdateAttackType,this.updateAttacktype),EventProxy.RemoveListener(this,EventType.ChangeMainAchorState,this.SetViewVsisible)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.onbtnsClick=function(t){switch(t.currentTarget){case this.shoubtn:ZPZBProxy.ins().setGoBack(!1),GameMap.centerEntity&&GameMap.centerEntity.stopMove(),0==ZPZBProxy.ins().getAttackType()?ZPZBProxy.ins().setAttackType(1):1==ZPZBProxy.ins().getAttackType()?ZPZBProxy.ins().setAttackType(2):2==ZPZBProxy.ins().getAttackType()&&ZPZBProxy.ins().setAttackType(1),this.updateAttacktype();break;case this.wenbtn:ViewManager.ins().open(ZPZBTipsView,2);break;case this.awardbtn:ViewManager.ins().open(ZPZBInAwardView);break;case this.tjbtn:ViewManager.ins().open(ZPFightReportView);break;case this.btnkill:this.kill_g.visible=!this.kill_g.visible;break;case this.shoubtn0:ZPZBProxy.ins().setGoBack(!0),ZPZBProxy.ins().setAttackType(0),GameMap.centerEntity&&GameMap.centerEntity.AI.setTarget(-1)}},e.prototype.onSceneItemClick=function(t){this.CurItem&&this.CurItem.SetInSelect(!1),this.CurItem=t.currentTarget,this.CurItem.SetInSelect(!0);var e=0;if(1==this.CurItem.data.type){var i=GameLogic.ins().getEnitityByBossId(this.CurItem.data.bossid);i&&i.getHP()>0&&(e=i.handle)}else{var i=this.CurItem.data.roleinfo;i&&i.getHP()>0&&(e=i.handle)}0!=e&&GameMap.centerEntity&&GameMap.centerEntity.AI.setTarget(e)},e.prototype.ShowInfo=function(){this.updateAttacktype(),this.ShowTopInfo(),this.ShowLeftInfo(),this.ShowAttackInfo()},e.prototype.updateAttacktype=function(){this.shoubtn.label=1==ZPZBProxy.ins().getAttackType()?"驻守":"进攻"},e.prototype.ShowTopInfo=function(){this.topkillnum.text=ZPZBProxy.ins().topkill_kill_num.toString(),this.topjifen.text=ZPZBProxy.ins().topkill_score.toString(),ZPZBProxy.ins().topkill_name&&""!=ZPZBProxy.ins().topkill_name?this.topname.text=UtilProxy.getStr("[@0 ]\nS@1 .@2 ",[TitleProxy.ins().getShengWanglvlName(ZPZBProxy.ins().topkill_reputation,ZPZBProxy.ins().topfaction),ZPZBProxy.ins().topkill_server_id,ZPZBProxy.ins().topkill_name]):this.topname.text="",this.ShowColdTime()},e.prototype.ShowColdTime=function(){TimerManager.ins().remove(this.SetTimeLab,this),this.SetTimeLab(),TimerManager.ins().doTimer(1e3,0,this.SetTimeLab,this)},e.prototype.SetTimeLab=function(){var t=ZPZBProxy.ins().end_time,e=GameLogic.ins().getServerTime();if(t>e){var i=UtilProxy.getTimeHMSString(t-e);this.timelab.textFlow=UtilProxy.StrFormart("|C:7&剩余时间：\n@0 |",[i])}else this.timelab.text="",TimerManager.ins().remove(this.SetTimeLab,this)},e.prototype.ShowLeftInfo=function(){var t=ZPZBProxy.ins().getCurAttackBossId();this.Bossitem.visible=0!=t,0!=t&&(this.Bossitem.data={type:1,bossid:t});for(var e=ZPZBProxy.ins().getAttackRoleList(),i=0;i<this.roleitemlist.length;i++)this.roleitemlist[i].visible=void 0!=e[i],e[i]&&(this.roleitemlist[i].data={type:2,roleinfo:e[i]})},e.prototype.ShowAttackInfo=function(){this.SetObjInfo(this.gong1,ZPZBProxy.ins().GetObjInfoList(1)[0]),this.SetObjInfo(this.shou4,ZPZBProxy.ins().GetObjInfoList(3)[0]);for(var t=ZPZBProxy.ins().GetObjInfoList(2),e=0;e<this.shoulist.length;e++)this.SetObjInfo(this.shoulist[e],t[e])},e.prototype.SetObjInfo=function(t,e){if(void 0!=e){t.getChildAt(0).visible=e.cur_hp<=0;var i=t.getChildAt(1);i.maximum=e.max_hp,i.value=e.cur_hp}},e.prototype.SetViewVsisible=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.visible=t[0]},e}(BaseEuiView);__reflect(ZPZBSceneView.prototype,"ZPZBSceneView"),ViewManager.ins().reg(ZPZBSceneView,LayerManager.UI_Main),window.ZPZBSceneView=ZPZBSceneView;var ZPZBTipsView=function(t){function e(){var e=t.call(this)||this;return e.curtype=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ZPZBTipsSkin",this.title.textFlow=UtilProxy.generateTextFlow("|C:10&玩法说明|")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addTouchEvent(this.closebtn,this.onCloseClick),this.curtype=t[0]||1,this.ShowInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.closebtn,this.onCloseClick)},e.prototype.onCloseClick=function(t){ViewManager.ins().close(this)},e.prototype.ShowInfo=function(){var t=GlobalConfig.getFaction_attack_base_dataConfig(1);this.lab.textFlow=UtilProxy.generateTextFlow(1==this.curtype?t.tips_desc:t.scene_tips)},e}(BaseEuiView);__reflect(ZPZBTipsView.prototype,"ZPZBTipsView"),ViewManager.ins().reg(ZPZBTipsView,LayerManager.UI_Main2),window.ZPZBTipsView=ZPZBTipsView;var ActivityType;!function(t){t[t.Yama=1]="Yama",t[t.KuaFuBoss=2]="KuaFuBoss",t[t.ShenwenBoss=3]="ShenwenBoss"}(ActivityType||(ActivityType={}));var ActivityProxy=function(t){function e(){var e=t.call(this)||this;return e.act_infos=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(26450,this.S2CRepActivityInfos,this),MsgHandle.ins().regNetMsg(26451,this.S2CRepActivityFinish,this),MsgHandle.ins().regNetMsg(26452,this.S2CRepActivityStart,this)},e.prototype.C2SReqActivityInfos=function(){var t=new net_protocol.C2SReqActivityInfos;CommonUtils.log(" ---------------------------------------------^^***^^  C2SReqActivityInfos"),this.sendPbPack(Msg.C2SReqActivityInfos,t,net_protocol.C2SReqActivityInfos)},e.prototype.S2CRepActivityInfos=function(t){var e=net_protocol.S2CRepActivityInfos.decode(t.bytes);CommonUtils.log(" ---------------------------------------------^^***^^  S2CRepActivityInfos",e),this.act_infos=e.act_infos;for(var i=0;i<this.act_infos.length;++i)if(this.act_infos[i].act_id==ActivityType.KuaFuBoss||this.act_infos[i].act_id==ActivityType.ShenwenBoss){this.setActTips();break}TimerManager.ins().doTimer(1e3,0,this.TimeUp,this),EventProxy.Broast(EventType.S2CRepActivityInfos,[]),EventProxy.Broast(EventType.XiuXianUpdate,{})},e.prototype.S2CRepActivityFinish=function(t){for(var e=net_protocol.S2CRepActivityFinish.decode(t.bytes),i=0;i<this.act_infos.length;i++)this.act_infos[i].act_id==e.act_id&&(this.act_infos[i].act_status=0,this.act_infos[i].act_time=e.next_act_time);EventProxy.Broast(EventType.S2CRepActivityFinish,[]),EventProxy.Broast(EventType.XiuXianUpdate,{})},e.prototype.S2CRepActivityStart=function(t){for(var e=net_protocol.S2CRepActivityStart.decode(t.bytes),i=0;i<this.act_infos.length;++i)this.act_infos[i].act_id==e.act_id&&(this.act_infos[i].act_status=1,this.act_infos[i].act_time=e.free_time);(e.act_id==ActivityType.KuaFuBoss||e.act_id==ActivityType.ShenwenBoss)&&this.setActTips(),EventProxy.Broast(EventType.S2CRepActivityStart,[e.act_id]),EventProxy.Broast(EventType.XiuXianUpdate,{})},e.prototype.getActivityDataById=function(t){for(var e=0;e<this.act_infos.length;++e)if(this.act_infos[e].act_id==t)return this.act_infos[e]},e.prototype.GetActivityOpenData=function(t){return GlobalConfig.getActivity_open_dataConfigById(t)},e.prototype.isActivityOpenById=function(t){for(var e=0;e<this.act_infos.length;++e)if(this.act_infos[e].act_id==t)return 1==this.act_infos[e].act_status;return!1},e.prototype.TimeUp=function(){if(void 0!=this.act_infos&&this.act_infos.length>0)for(var t=0;t<this.act_infos.length;++t){var e=this.act_infos[t],i=e.act_time-GameLogic.ins().getServerTime(),n=this.GetActivityOpenData(e.act_id);void 0!=n&&n.open_level<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)&&0>i&&(e.act_time=GameLogic.ins().getServerTime()+n.span,0==e.act_status?(e.act_id!=ActivityType.KuaFuBoss&&e.act_id!=ActivityType.ShenwenBoss||ViewManager.ins().isShow(ShowActOpenView)||this.setActTips(),e.act_status=1):1==e.act_status&&(e.act_status=0),this.act_infos[t]=e,EventProxy.Broast(EventType.ActivityStateChange,[e.act_id]))}},e.prototype.setActTips=function(){if(GameLogic.ins().isMainScene()&&!CopyTeamProxy.ins().isStartmatching&&!GuideProxy.ins().getGuideState()&&!CopyProxy.ins().isSimgleCopy(CopyProxy.ins().copyId)){var t=e.ins().getActivityDataById(ActivityType.KuaFuBoss),i=BossProxy.ins().getCurrentKuaFuBoss();if((void 0==t||null==t||0==t.act_status)&&(t=e.ins().getActivityDataById(ActivityType.ShenwenBoss),i=BossProxy.ins().getCurrentShenwenBoss()),t&&i&&SystemOpenProxy.ins().isOpen(2,804,!0)&&1==t.act_status){var n=BossProxy.ins().GetBossNextFreeTime(i.id,i.type);0>=n&&(ViewManager.ins().isShow(ShowActOpenView)||ViewManager.ins().open(ShowActOpenView))}}},e}(BaseSystem);__reflect(ActivityProxy.prototype,"ActivityProxy");var AttrProxy=function(){function t(){}return t.getAttrInfo=function(t,e){void 0===e&&(e=1);var i=[];return void 0==t?i:(this.ParseAttributeHelp(i,t.hp,"生命：",1,"hp",e),this.ParseAttributeHelp(i,t.hp_pre,"生命百分比：",2,"hp_pre",e),this.ParseAttributeHelp(i,t.attack,"攻击：",1,"attack",e),this.ParseAttributeHelp(i,t.defence,"防御：",1,"defence",e),this.ParseAttributeHelp(i,t.speed,"移速：",1,"speed",e),this.ParseAttributeHelp(i,t.pojia,"破甲：",1,"pojia",e),this.ParseAttributeHelp(i,t.mingzhong,"命中：",1,"mingzhong",e),this.ParseAttributeHelp(i,t.shanbi,"闪避：",1,"shanbi",e),this.ParseAttributeHelp(i,t.baoji_rate,"暴击率：",2,"baoji_rate",e),this.ParseAttributeHelp(i,t.kang_baoji_rate,"抗暴率：",2,"kang_baoji_rate",e),this.ParseAttributeHelp(i,t.baoji_hurt,"暴伤：",1,"baoji_hurt",e),this.ParseAttributeHelp(i,t.kang_baoji_hurt,"暴抗：",1,"kang_baoji_hurt",e),this.ParseAttributeHelp(i,t.kang_baoji_pre,"暴免：",2,"kang_baoji_pre",e),this.ParseAttributeHelp(i,t.gedang_rate,"格挡率：",2,"gedang_rate",e),this.ParseAttributeHelp(i,t.gedang_hurt_pre,"格挡伤害：",2,"gedang_hurt_pre",e),this.ParseAttributeHelp(i,t.poji_rate,"破击率：",2,"poji_rate",e),this.ParseAttributeHelp(i,t.hurt_add_pre,"伤害加成：",2,"hurt_add_pre",e),this.ParseAttributeHelp(i,t.hurt_sub_pre,"伤害减免：",2,"hurt_sub_pre",e),this.ParseAttributeHelp(i,t.inner_hurt,"内功伤害：",1,"inner_hurt",e),this.ParseAttributeHelp(i,t.inner_sub_hurt,"内功减免：",1,"inner_sub_hurt",e),this.ParseAttributeHelp(i,t.output_hurt,"输出伤害：",1,"output_hurt",e),this.ParseAttributeHelp(i,t.output_sub_hurt,"输出减免：",1,"output_sub_hurt",e),this.ParseAttributeHelp(i,t.partner_hurt_pre,"伙伴伤害：",2,"partner_hurt_pre",e),this.ParseAttributeHelp(i,t.suck_hp,"攻击吸血：",1,"suck_hp",e),this.ParseAttributeHelp(i,t.extra_hurt,"额外伤害：",1,"extra_hurt",e),this.ParseAttributeHelp(i,t.mingzhong_pre,"命中率：",2,"mingzhong_pre",e),this.ParseAttributeHelp(i,t.shanbi_pre,"闪避率：",2,"shanbi_pre",e),this.ParseAttributeHelp(i,t.zhongji_rate,"重击率：",2,"zhongji_rate",e),this.ParseAttributeHelp(i,t.kang_zhongji_rate,"抗重击率：",2,"kang_zhongji_rate",e),this.ParseAttributeHelp(i,t.huixin_rate,"会心率：",2,"huixin_rate",e),this.ParseAttributeHelp(i,t.kang_huixin_rate,"抗会心率：",2,"kang_huixin_rate",e),this.ParseAttributeHelp(i,t.lianji_rate,"连击率：",2,"lianji_rate",e),this.ParseAttributeHelp(i,t.qiangji_rate,"强击率：",2,"qiangji_rate",e),this.ParseAttributeHelp(i,t.hurt_rebound_pre,"反伤：",2,"hurt_rebound_pre",e),this.ParseAttributeHelp(i,t.kang_control_rate,"控制抵抗：",2,"kang_control_rate",e),this.ParseAttributeHelp(i,t.coin_drop_pre,"金币掉率：",2,"coin_drop_pre",e),this.ParseAttributeHelp(i,t.item_drop_pre,"物品掉率：",2,"item_drop_pre",e),this.ParseAttributeHelp(i,t.real_hurt,"真实伤害：",1,"real_hurt",e),this.ParseAttributeHelp(i,t.exp_per,"经验加成：",2,"exp_per",e),this.ParseAttributeHelp(i,t.zb_hp_pre,"珍宝生命加成：",2,"zb_hp_pre",e),this.ParseAttributeHelp(i,t.zb_att_pre,"珍宝攻击加成：",2,"zb_att_pre",e),this.ParseAttributeHelp(i,t.zb_def_pre,"珍宝防御加成：",2,"zb_def_pre",e),this.ParseAttributeHelp(i,t.ft_xiuxian_add_pre,"境界压制伤害：",2,"ft_xiuxian_add_pre",e),this.ParseAttributeHelp(i,t.ft_wushi_define_pre,"无视防御：",2,"ft_wushi_define_pre",e),this.ParseAttributeHelp(i,t.ft_hurt_add_pre,"焚天仙决伤害提升：",2,"ft_hurt_add_pre",e),this.ParseAttributeHelp(i,t.attr_per,"装备灵石百分比：",2,"attr_per",e),i)},t.ParseAttributeHelp=function(t,e,i,n,o,s){if(e>0){var r=[];r[0]=i,1==n?r[1]=(e*s).toString():r[1]=e*s/100+"%",r[2]=RoleProxy.keyName[o],t.push(r)}},t.getContAttrInfo=function(t,e){for(var i=this.getAttrInfo(t),n=this.getAttrInfo(e),o=[],s=0;s<i.length;s++){var r=[];r[0]=i[s][2],r[1]=i[s][1],r[2]=0;for(var a=0;a<n.length;a++)n[a][2]==i[s][2]&&(r[2]=n[s][1]);o.push(r)}for(var s=0;s<n.length;s++){var r=[];r[0]=n[s][2],r[1]=0,r[2]=n[s][1];for(var h=!1,a=0;a<o.length;a++)o[a][0]==n[s][2]&&(h=!0);h||o.push(r)}return o},t.getAttrValueInfo=function(t,e,i){var n=[];return void 0==t?n:(this.ParseAttrValueHelp(n,t.hp,FightAttr.HP,e,i),this.ParseAttrValueHelp(n,t.hp_pre,FightAttr.HP_PRE,e,i),this.ParseAttrValueHelp(n,t.attack,FightAttr.ATTACK,e,i),this.ParseAttrValueHelp(n,t.defence,FightAttr.DEFENCE,e,i),this.ParseAttrValueHelp(n,t.speed,FightAttr.SPEED,e,i),this.ParseAttrValueHelp(n,t.pojia,FightAttr.POJIA,e,i),this.ParseAttrValueHelp(n,t.mingzhong,FightAttr.MINGZHONG,e,i),this.ParseAttrValueHelp(n,t.shanbi,FightAttr.SHANBI,e,i),this.ParseAttrValueHelp(n,t.baoji_rate,FightAttr.BAOJI_RATE,e,i),this.ParseAttrValueHelp(n,t.kang_baoji_rate,FightAttr.KANG_BAOJI_RATE,e,i),this.ParseAttrValueHelp(n,t.baoji_hurt,FightAttr.BAOJI_HURT,e,i),this.ParseAttrValueHelp(n,t.kang_baoji_hurt,FightAttr.KANG_BAOJI_HURT,e,i),this.ParseAttrValueHelp(n,t.kang_baoji_pre,FightAttr.BAOJI_SUB_PRE,e,i),this.ParseAttrValueHelp(n,t.gedang_rate,FightAttr.GEDAND_RATE,e,i),this.ParseAttrValueHelp(n,t.gedang_hurt_pre,FightAttr.GEDAND_HURT_PRE,e,i),this.ParseAttrValueHelp(n,t.poji_rate,FightAttr.POJI_RATE,e,i),this.ParseAttrValueHelp(n,t.hurt_add_pre,FightAttr.HURT_ADD_PRE,e,i),this.ParseAttrValueHelp(n,t.hurt_sub_pre,FightAttr.HURT_SUB_PRE,e,i),this.ParseAttrValueHelp(n,t.inner_hurt,FightAttr.INNER_HURT,e,i),this.ParseAttrValueHelp(n,t.inner_sub_hurt,FightAttr.INNER_SUB_HURT,e,i),this.ParseAttrValueHelp(n,t.output_hurt,FightAttr.OUTPUT_HURT,e,i),this.ParseAttrValueHelp(n,t.output_sub_hurt,FightAttr.OUTPUT_SUB_HURT,e,i),this.ParseAttrValueHelp(n,t.partner_hurt_pre,FightAttr.PARTNER_HURT_PRE,e,i),this.ParseAttrValueHelp(n,t.suck_hp,FightAttr.SUCK_HP,e,i),this.ParseAttrValueHelp(n,t.extra_hurt,FightAttr.EXTRA_HURT,e,i),this.ParseAttrValueHelp(n,t.mingzhong_pre,FightAttr.MINGZHONG_PRE,e,i),this.ParseAttrValueHelp(n,t.shanbi_pre,FightAttr.SHANBI_PRE,e,i),this.ParseAttrValueHelp(n,t.zhongji_rate,FightAttr.ZHONGJI_RATE,e,i),this.ParseAttrValueHelp(n,t.kang_zhongji_rate,FightAttr.KANG_ZHONGJI_RATE,e,i),this.ParseAttrValueHelp(n,t.huixin_rate,FightAttr.HUIXIN_RATE,e,i),this.ParseAttrValueHelp(n,t.kang_huixin_rate,FightAttr.KANG_HUIXIN_RATE,e,i),this.ParseAttrValueHelp(n,t.lianji_rate,FightAttr.LIANJI_RATE,e,i),this.ParseAttrValueHelp(n,t.qiangji_rate,FightAttr.QIANGJI_RATE,e,i),this.ParseAttrValueHelp(n,t.hurt_rebound_pre,FightAttr.HURT_REBOUND_PRE,e,i),this.ParseAttrValueHelp(n,t.kang_control_rate,FightAttr.KANG_CONTROL_RATE,e,i),this.ParseAttrValueHelp(n,t.coin_drop_pre,FightAttr.COIN_DROP_PRE,e,i),this.ParseAttrValueHelp(n,t.item_drop_pre,FightAttr.ITEM_DROP_PRE,e,i),this.ParseAttrValueHelp(n,t.real_hurt,FightAttr.REAL_HURT,e,i),this.ParseAttrValueHelp(n,t.exp_per,FightAttr.EXP_PER,e,i),n)},t.ParseAttrValueHelp=function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0),e&&e>0&&(t[i]=e,n>0&&(t[i]=parseInt(t[i]+.01*t[i]*n)),o>0&&(t[i]+=o))},t.getAttrAddInfo=function(t,e){void 0===e&&(e=1);var i=[];return void 0==t?i:(this.ParseAddAttributeHelp(i,t.hp,"hp",e),this.ParseAddAttributeHelp(i,t.hp_pre,"hp_pre",e),this.ParseAddAttributeHelp(i,t.attack,"attack",e),this.ParseAddAttributeHelp(i,t.defence,"defence",e),this.ParseAddAttributeHelp(i,t.speed,"speed",e),this.ParseAddAttributeHelp(i,t.pojia,"pojia",e),this.ParseAddAttributeHelp(i,t.mingzhong,"mingzhong",e),this.ParseAddAttributeHelp(i,t.shanbi,"shanbi",e),this.ParseAddAttributeHelp(i,t.baoji_rate,"baoji_rate",e),this.ParseAddAttributeHelp(i,t.kang_baoji_rate,"kang_baoji_rate",e),this.ParseAddAttributeHelp(i,t.baoji_hurt,"baoji_hurt",e),this.ParseAddAttributeHelp(i,t.kang_baoji_hurt,"kang_baoji_hurt",e),this.ParseAddAttributeHelp(i,t.kang_baoji_pre,"kang_baoji_pre",e),this.ParseAddAttributeHelp(i,t.gedang_rate,"gedang_rate",e),this.ParseAddAttributeHelp(i,t.gedang_hurt_pre,"gedang_hurt_pre",e),this.ParseAddAttributeHelp(i,t.poji_rate,"poji_rate",e),this.ParseAddAttributeHelp(i,t.hurt_add_pre,"hurt_add_pre",e),this.ParseAddAttributeHelp(i,t.hurt_sub_pre,"hurt_sub_pre",e),this.ParseAddAttributeHelp(i,t.inner_hurt,"inner_hurt",e),this.ParseAddAttributeHelp(i,t.inner_sub_hurt,"inner_sub_hurt",e),this.ParseAddAttributeHelp(i,t.output_hurt,"output_hurt",e),this.ParseAddAttributeHelp(i,t.output_sub_hurt,"output_sub_hurt",e),this.ParseAddAttributeHelp(i,t.partner_hurt_pre,"partner_hurt_pre",e),this.ParseAddAttributeHelp(i,t.suck_hp,"suck_hp",e),this.ParseAddAttributeHelp(i,t.extra_hurt,"extra_hurt",e),this.ParseAddAttributeHelp(i,t.mingzhong_pre,"mingzhong_pre",e),this.ParseAddAttributeHelp(i,t.shanbi_pre,"shanbi_pre",e),this.ParseAddAttributeHelp(i,t.zhongji_rate,"zhongji_rate",e),this.ParseAddAttributeHelp(i,t.kang_zhongji_rate,"kang_zhongji_rate",e),this.ParseAddAttributeHelp(i,t.huixin_rate,"huixin_rate",e),this.ParseAddAttributeHelp(i,t.kang_huixin_rate,"kang_huixin_rate",e),this.ParseAddAttributeHelp(i,t.lianji_rate,"lianji_rate",e),this.ParseAddAttributeHelp(i,t.qiangji_rate,"qiangji_rate",e),this.ParseAddAttributeHelp(i,t.hurt_rebound_pre,"hurt_rebound_pre",e),this.ParseAddAttributeHelp(i,t.kang_control_rate,"kang_control_rate",e),this.ParseAddAttributeHelp(i,t.coin_drop_pre,"coin_drop_pre",e),this.ParseAddAttributeHelp(i,t.item_drop_pre,"item_drop_pre",e),this.ParseAddAttributeHelp(i,t.real_hurt,"real_hurt",e),this.ParseAddAttributeHelp(i,t.exp_per,"exp_per",e),this.ParseAddAttributeHelp(i,t.zb_hp_pre,"zb_hp_pre",e),this.ParseAddAttributeHelp(i,t.zb_att_pre,"zb_att_pre",e),this.ParseAddAttributeHelp(i,t.zb_def_pre,"zb_def_pre",e),this.ParseAddAttributeHelp(i,t.ft_xiuxian_add_pre,"ft_xiuxian_add_pre",e),i)},t.ParseAddAttributeHelp=function(t,e,i,n){e>0&&(t[i]=e,0!=n&&(t[i]=parseInt(t[i]+.01*t[i]*n)))},t}();__reflect(AttrProxy.prototype,"AttrProxy");var BagType;!function(t){t[t.BODY_EQUIP=0]="BODY_EQUIP",t[t.EQUIP=1]="EQUIP",t[t.BAG=2]="BAG",t[t.MIJI_BAG=3]="MIJI_BAG",t[t.GEM_BAG=4]="GEM_BAG",t[t.HORSE_BODY_EQUIP=5]="HORSE_BODY_EQUIP",t[t.HORSE_EQUIP=6]="HORSE_EQUIP",t[t.BELLE_BODY_EQUIP=7]="BELLE_BODY_EQUIP",t[t.BELLE_EQUIP=8]="BELLE_EQUIP",t[t.PET_BODY_EQUIP=9]="PET_BODY_EQUIP",t[t.PET_EQUIP=10]="PET_EQUIP"}(BagType||(BagType={}));var SysType;!function(t){t[t.TUJIAN=1]="TUJIAN",t[t.DUANZAO=2]="DUANZAO"}(SysType||(SysType={}));var C2SReqKnapsackArm=function(){function t(){}return t}();__reflect(C2SReqKnapsackArm.prototype,"C2SReqKnapsackArm");var csuse_item=function(){function t(){}return t}();__reflect(csuse_item.prototype,"csuse_item");var BagProxy=function(t){function e(){var e=t.call(this)||this;return e.bagModel=[[],[],[],[],[],[],[],[],[],[],[]],e.bagcount=[0,0,0,0,0,0,0,0,0,0,0],e.online_time=0,e.recomonItemList=[],e.useCountData={},e.PutDressList=[],e.LVUpRank=0,e.huobanPART_Pic=[["zqzb_01","zqzb_02","zqzb_03","zqzb_04"],["xlzb_01","xlzb_02","xlzb_03","xlzb_04"],["cwzb_01","cwzb_02","cwzb_03","cwzb_04"]],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqKnapsackGetInfo=function(t){var e=new net_protocol.C2SReqKnapsackGetInfo;e.bag_type=t,this.sendPbPack(Msg.C2SReqKnapsackGetInfo,e,net_protocol.C2SReqKnapsackGetInfo)},e.prototype.C2SReqKnapsackUse=function(t){var e=new net_protocol.C2SReqKnapsackUse;e.use_items=[];for(var i=0;i<t.length;i++){var n=new csuse_item;n.item_slot_idx=t[i][0],n.count=t[i][1],e.use_items[i]=n}this.sendPbPack(Msg.C2SReqKnapsackUse,e,net_protocol.C2SReqKnapsackUse)},e.prototype.C2SReqKnapsackOpenSlot=function(t,e){var i=new net_protocol.C2SReqKnapsackOpenSlot;i.bag_id=t,i.slot_idx=e,this.sendPbPack(Msg.C2SReqKnapsackOpenSlot,i,net_protocol.C2SReqKnapsackOpenSlot)},e.prototype.C2SReqKnapsackArm=function(t,e){var i=new net_protocol.C2SReqKnapsackArm;i.slot_idx=t,i.target_id=e,this.sendPbPack(Msg.C2SReqKnapsackArm,i,net_protocol.C2SReqKnapsackArm)},e.prototype.C2SReqKnapsackArmList=function(t){var e=new net_protocol.C2SReqKnapsackArmList;e.list=t,this.sendPbPack(Msg.C2SReqKnapsackArmList,e,net_protocol.C2SReqKnapsackArmList)},e.prototype.C2SReqKnapsackDisArm=function(t){var e=new net_protocol.C2SReqKnapsackDisArm;e.slot_idx=t,this.sendPbPack(Msg.C2SReqKnapsackDisArm,e,net_protocol.C2SReqKnapsackDisArm)},e.prototype.S2CRepKnapsackGetInfo=function(t){var i=t.bag_type;this.bagcount[i]=t.bag_slot_count;var n=[];this.bagModel[i]=[];for(var o=0;o<t.item_list.length;o++){var s=new ItemCellData;if(s.setItemCellData(t.item_list[o]),this.bagModel[i][o]=s,i==BagType.BAG){var r=e.ins().getItemData(t.item_list[o].item_type_id);if(r){switch(r.sys_id){case SysType.TUJIAN:n[SysType.TUJIAN]=!0;break;case SysType.DUANZAO:n[SysType.DUANZAO]=!0}if(1==this.getbinary2list(r.bintags)[12]&&r.requiredlevel<=RoleProxy.ins().getRoleLv()&&r.reborn<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)&&void 0==this.recomonItemList[t.item_list[o].item_slot_idx]){var a=new ItemCellData;a.setItemCellData(t.item_list[o]),this.recomonItemList[t.item_list[o].item_slot_idx]=a}}}}n[SysType.TUJIAN]&&EventProxy.Broast(EventType.UpdateTujianRed,{}),n[SysType.DUANZAO]&&EventProxy.Broast(EventType.UpdataForgingRed,{}),t.bag_type==BagType.GEM_BAG&&EventProxy.Broast(EventType.UpdateBagStone,{}),t.bag_type==BagType.BODY_EQUIP&&EventProxy.Broast(EventType.UpdateBodyEquip,{}),(t.bag_type==BagType.EQUIP||t.bag_type==BagType.BODY_EQUIP)&&(this.CheckCanDressEquit(),EventProxy.Broast(EventType.UpdateRoleRed,{})),(t.bag_type==BagType.HORSE_BODY_EQUIP||t.bag_type==BagType.HORSE_EQUIP||t.bag_type==BagType.BELLE_BODY_EQUIP||t.bag_type==BagType.BELLE_EQUIP||t.bag_type==BagType.PET_BODY_EQUIP||t.bag_type==BagType.PET_EQUIP)&&(this.CheckCanDressEquit(),EventProxy.Broast(EventType.RefreshHuoBanRed,{})),t.bag_type==BagType.BAG&&(EventProxy.Broast(EventType.RecommendItem,[]),EventProxy.Broast(EventType.RefreshHuoBanRed,[]),EventProxy.Broast(EventType.RefreshTitleRed,[]),EventProxy.Broast(EventType.RefreshStoreRed,[]),EventProxy.Broast(EventType.RefreshMakeRed,[]),EventProxy.Broast(EventType.BaowuRedRefresh,[])),EventProxy.Broast(EventType.UpdateBagInfo,{})},e.prototype.S2CRepKnapsackUpdate=function(t){var i=[];void 0!=t.bag_type&&(i=this.bagModel[t.bag_type]);for(var n=[],o=0;o<t.item_list.length;o++){for(var s=0,r=0;r<i.length;r++)if(i[r].item_slot_idx==t.item_list[o].item_slot_idx){if(t.bag_type!=BagType.BODY_EQUIP&&0!=t.from&&t.item_list[o].item_count-i[r].item_count>0){var a=e.ins().getItemData(t.item_list[o].item_type_id);a&&TipsControl.ins().showTips(UtilProxy.getStr("|C:@0 &@1 | x@2 ",[e.QUALITY_COLOR[a.quality-1],a.name,t.item_list[o].item_count-i[r].item_count])),BossProxy.ins().isBossBGSceneItem(t.item_list[o].item_type_id)&&BossProxy.ins().AddPigNumberById(t.item_list[o].item_type_id,t.item_list[o].item_count-i[r].item_count)}var h=new ItemCellData;h.setItemCellData(t.item_list[o]),i[r]=h,s=1}if(0==s){if(BossProxy.ins().isBossBGSceneItem(t.item_list[o].item_type_id)&&BossProxy.ins().AddPigNumberById(t.item_list[o].item_type_id,t.item_list[o].item_count),t.bag_type!=BagType.BODY_EQUIP&&0!=t.from&&t.item_list[o].item_count>0){var a=e.ins().getItemData(t.item_list[o].item_type_id);a&&TipsControl.ins().showTips(UtilProxy.getStr("|C:@0 &@1 | x@2 ",[e.QUALITY_COLOR[a.quality-1],a.name,t.item_list[o].item_count]))}var h=new ItemCellData;h.setItemCellData(t.item_list[o]),i.push(h),t.bag_type==BagType.BAG&&TitleProxy.ins().isActiveMatrial(t.item_list[o].item_type_id)&&TitleProxy.ins().setTitleTipsView(t.item_list[o].item_type_id)}if(t.bag_type==BagType.BAG){var l=t.item_list[o].item_type_id,p=this.getItemData(l);if(p){switch(p.sys_id){case 3:WeaponProxy.ins().updatePageRed();break;case 4:FabaoProxy.ins().updateRedList();break;case 5:EventProxy.Broast(EventType.UpdateSkillRed,[])}2==p.type&&19==p.subtype&&EventProxy.Broast(EventType.RefreshBossItemJuan,[])}var c=FwProxy.ins().getUpgradeItems();c&&c[l]&&FwProxy.ins().updateUpgradeRed();var u=FwProxy.ins().getComposeItems();u&&u[l]&&FwProxy.ins().udpateComposeRed();var d=XyProxy.ins().getSkillItems();d&&d[l]&&XyProxy.ins().updateRingRed(),XyProxy.ins().getRingItem()==l&&XyProxy.ins().updateRingRed(),RelicProxy.ins().setBagUpdateById(l)&&EventProxy.Broast(EventType.RefreshRelicItem,[]),RelicProxy.ins().setBagUpdateByItemId(l)&&EventProxy.Broast(EventType.RefreshRelicItemByBag,[]),HuobanProxy.ins().isGradeMatrialId(l)&&EventProxy.Broast(EventType.RefreshHuoBanRed,[]),BossProxy.ins().getYamaLingId()==l&&EventProxy.Broast(EventType.RefreshYamaId,[]),TitleProxy.ins().isTitleMatrialId(l)&&EventProxy.Broast(EventType.RefreshTitleRed,[]),TreasureProxy.ins().isTreasureMaterial(l)&&EventProxy.Broast(EventType.RefreshFindtreasureRed,[]),MakeProxy.ins().isMakeMaterial(l)&&EventProxy.Broast(EventType.RefreshMakeRed,[]),MakeProxy.ins().isMakeMaterial(l)&&EventProxy.Broast(EventType.RefreshMakeRed,[]),BaoWuProxy.ins().isBaowuMaterial(l)&&EventProxy.Broast(EventType.BaowuRedRefresh,[]);var a=e.ins().getItemData(l);if(a){switch(a.sys_id){case SysType.TUJIAN:n[SysType.TUJIAN]=!0;break;case SysType.DUANZAO:n[SysType.DUANZAO]=!0}if(1==this.getbinary2list(a.bintags)[12]&&a.requiredlevel<=RoleProxy.ins().getRoleLv()&&a.reborn<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)&&void 0==this.recomonItemList[t.item_list[o].item_slot_idx]){var h=new ItemCellData;h.setItemCellData(t.item_list[o]),this.recomonItemList[t.item_list[o].item_slot_idx]=h}}}SystemOpenProxy.ins().isSystemOpenMaterial(t.item_list[o].item_type_id)&&SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.REWARDITEM)}n[SysType.TUJIAN]&&EventProxy.Broast(EventType.UpdateTujianRed,{}),n[SysType.DUANZAO]&&EventProxy.Broast(EventType.UpdataForgingRed,{}),t.bag_type==BagType.GEM_BAG&&EventProxy.Broast(EventType.UpdateBagStone,{}),t.bag_type==BagType.MIJI_BAG&&FabaoProxy.ins().updateRedList(),t.bag_type==BagType.BODY_EQUIP&&EventProxy.Broast(EventType.UpdateBodyEquip,{}),t.bag_type==BagType.BAG&&EventProxy.Broast(EventType.RecommendItem,{}),(t.bag_type==BagType.EQUIP||t.bag_type==BagType.BODY_EQUIP)&&(this.CheckCanDressEquit(),EventProxy.Broast(EventType.UpdateRoleRed,{})),(t.bag_type==BagType.HORSE_BODY_EQUIP||t.bag_type==BagType.HORSE_EQUIP||t.bag_type==BagType.BELLE_BODY_EQUIP||t.bag_type==BagType.BELLE_EQUIP||t.bag_type==BagType.PET_BODY_EQUIP||t.bag_type==BagType.PET_EQUIP)&&EventProxy.Broast(EventType.RefreshHuoBanRed,{}),t.bag_type==BagType.BODY_EQUIP&&XiuXianProxy.ins().updateAchieRed(AchieType.dress_equip),EventProxy.Broast(EventType.UpdateBagInfo,{})
},e.prototype.S2CRepKnapsackDelItem=function(t){var i=[];void 0!=t.bag_type&&(i=this.bagModel[t.bag_type]);for(var n=[],o=0;o<t.cell_items.length;o++){for(var s=-1,r=0,a=0;a<i.length;a++)i[a].item_slot_idx==t.cell_items[o].item_slot_idx&&(i[a].item_count=i[a].item_count-t.cell_items[o].count,r=i[a].item_type_id),0==i[a].item_count&&(s=a);if(-1!=s&&i.splice(s,1),t.bag_type==BagType.BAG&&r>0){var h=e.ins().getItemData(r);if(h){switch(h.sys_id){case SysType.TUJIAN:n[SysType.TUJIAN]=!0;break;case SysType.DUANZAO:n[SysType.DUANZAO]=!0}2==h.type&&19==h.subtype&&EventProxy.Broast(EventType.RefreshBossItemJuan,[])}HuobanProxy.ins().isGradeMatrialId(r)&&EventProxy.Broast(EventType.RefreshHuoBanRed,[]),BossProxy.ins().getYamaLingId()==r&&EventProxy.Broast(EventType.RefreshYamaId,[]),TitleProxy.ins().isTitleMatrialId(r)&&EventProxy.Broast(EventType.RefreshTitleRed,[]),TreasureProxy.ins().isTreasureMaterial(r)&&EventProxy.Broast(EventType.RefreshFindtreasureRed,[]),StoreProxy.ins().isStoreMaterialId(r)&&EventProxy.Broast(EventType.RefreshStoreRed,[]),RelicProxy.ins().setBagUpdateById(r)&&EventProxy.Broast(EventType.RefreshRelicItem,[]),RelicProxy.ins().setBagUpdateByItemId(r)&&EventProxy.Broast(EventType.RefreshRelicItemByBag,[]),MakeProxy.ins().isMakeMaterial(r)&&EventProxy.Broast(EventType.RefreshMakeRed,[]),BaoWuProxy.ins().isBaowuMaterial(r)&&EventProxy.Broast(EventType.BaowuRedRefresh,[])}}n[SysType.TUJIAN]&&EventProxy.Broast(EventType.UpdateTujianRed,{}),n[SysType.DUANZAO]&&EventProxy.Broast(EventType.UpdataForgingRed,{}),t.bag_type==BagType.GEM_BAG&&EventProxy.Broast(EventType.UpdateBagStone,{}),(t.bag_type==BagType.EQUIP||t.bag_type==BagType.BODY_EQUIP)&&EventProxy.Broast(EventType.UpdateRoleRed,{}),EventProxy.Broast(EventType.UpdateBagInfo,{})},e.prototype.S2CRepKnapsackUse=function(t){EventProxy.Broast(EventType.UpdateBagInfo,{})},e.prototype.S2CRepKnapsackOpenSlot=function(t){void 0!=this.bagcount[t.bag_id]&&(this.bagcount[t.bag_id]=t.slot_idx),EventProxy.Broast(EventType.UpdateBagInfo,{})},e.prototype.S2CRepKnapsackArm=function(t){0==t.err_code&&(TipsControl.ins().showTips("穿戴装备成功"),EventProxy.Broast(EventType.S2CRepKnapsackArm,{}),EventProxy.Broast(EventType.UpdateRoleRed,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,{}),this.CheckCanDressEquit())},e.prototype.S2CRepKnapsackDisArm=function(t){},e.prototype.getBagInfo=function(t){t!=BagType.BODY_EQUIP&&this.bagModel[t].sort(this.sort);for(var e=[],i=0;i<this.bagcount[t];i++)if(void 0!=this.bagModel[t][i]){var n=new ItemCellData;n=this.bagModel[t][i],e[i]=n}else{var n=new ItemCellData;e[i]=n}return e},e.prototype.sort=function(t,e){return t.itemConfig&&t.itemConfig.quality&&e.itemConfig&&e.itemConfig.quality&&t.itemConfig.quality<e.itemConfig.quality?1:t.itemConfig&&t.itemConfig.quality&&e.itemConfig&&e.itemConfig.quality&&t.itemConfig.quality>e.itemConfig.quality?-1:t.itemConfig&&t.itemConfig.itemlevel&&e.itemConfig&&e.itemConfig.itemlevel&&t.itemConfig.itemlevel<e.itemConfig.itemlevel?1:t.itemConfig&&t.itemConfig.itemlevel&&e.itemConfig&&e.itemConfig.itemlevel&&t.itemConfig.itemlevel>e.itemConfig.itemlevel?-1:t.item_type_id<e.item_type_id?-1:t.item_type_id>e.item_type_id?1:0},e.prototype.getBagInfoLenth=function(t){return void 0!=this.bagModel[t]?this.bagModel[t].length:0},e.prototype.GetBagLeftCount=function(t){return this.bagcount[t]-this.getBagInfoLenth(t)},e.prototype.getEquipInfo=function(){for(var t=[],e=0;10>e;e++){var i=this.getBodyEquipByPart(e+1);if(void 0!=i){var n=new ItemCellData;n=i,t[e]=n}else{var n=new ItemCellData;n.item_slot_idx=e+1,t[e]=n}}return t},e.prototype.getGodEquipInfo=function(t){for(var e=[],i=11+10*t,n=20+10*t,o=i;n>=o;o++)e[o-i]=this.getGodEquip(o);return e},e.prototype.getGodEquip=function(t){var e=this.getBodyEquipByPart(t);if(void 0!=e)return e;var i=new ItemCellData;return i.item_slot_idx=t,i},e.prototype.getItemData=function(t){return void 0!=GlobalConfig.getItemsConfig(t)?GlobalConfig.getItemsConfig(t):void 0!=GlobalConfig.getEquipmentConfig(t)?GlobalConfig.getEquipmentConfig(t):void 0!=GlobalConfig.getGiftConfig(t)?GlobalConfig.getGiftConfig(t):void 0},e.prototype.getItemName=function(t){var e="";return void 0!=GlobalConfig.getItemsConfig(t)?e=GlobalConfig.getItemsConfig(t).name:void 0!=GlobalConfig.getEquipmentConfig(t)?e=GlobalConfig.getEquipmentConfig(t).name:void 0!=GlobalConfig.getGiftConfig(t)&&(e=GlobalConfig.getGiftConfig(t).name),e},e.prototype.getItemColorName=function(t){var i=this.getItemData(t);return i.quality?UtilProxy.getStr("|C:@0 &@1 |",[e.QUALITY_COLOR[i.quality-1],i.name]):""},e.prototype.getEquipCountByQ=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=0,o=1;10>=o;o++){var s=this.getBodyEquipByPart(o);s&&s.itemConfig&&s.itemConfig.quality&&s.itemConfig.quality>=t&&(0==e&&0==i?n+=1:(e>0&&s.itemConfig.requiredlevel==e||i>0&&s.itemConfig.reborn==i)&&(n+=1))}return n},e.prototype.getBodyEquipByPart=function(t){if(void 0!=this.bagModel[BagType.BODY_EQUIP])for(var e=0;e<this.bagModel[BagType.BODY_EQUIP].length;e++){var i=this.bagModel[BagType.BODY_EQUIP][e].itemConfig;if(i&&i.part&&i.part==t)return this.bagModel[BagType.BODY_EQUIP][e]}},e.prototype.getHuobanBodyEquipByPart=function(t,e){if(void 0!=this.bagModel[t])for(var i=0;i<this.bagModel[t].length;i++){var n=this.bagModel[t][i].itemConfig;if(n&&n.part&&n.part==e)return this.bagModel[t][i]}},e.prototype.getHuobanBodyEquipTopLevel=function(t){var e=0;if(void 0!=this.bagModel[t])for(var i=0;i<this.bagModel[t].length;i++){var n=this.bagModel[t][i].itemConfig;n&&n.partner_grade>e&&(e=n.partner_grade)}return e},e.prototype.getHuobanBodyEquipPartGrade=function(t){var e=[0,0,0,0];if(void 0!=this.bagModel[t])for(var i=0;i<this.bagModel[t].length;i++){if(this.bagModel[t][i].itemConfig){var n=this.bagModel[t][i].itemConfig;n&&n.partner_grade&&(e[n.part-1]=n.partner_grade)}}return e},e.prototype.getItemCellData=function(t){for(var e=this.bagModel[BagType.BAG],i=0;i<e.length;i++)if(e[i].item_type_id==t)return e[i]},e.prototype.getDressIndexByPart=function(t){for(var i=this.bagModel[BagType.EQUIP],n=-1,o=this.getBodyEquipByPart(t),s=0;s<i.length;s++){var r=i[s].itemConfig;if(r&&r.part){var a=0,h=0;if(void 0!=o&&(a=o.itemConfig.itemlevel,h=o.itemConfig.quality),t==r.part&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=r.requiredlevel&&RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)>=r.reborn&&(a<r.itemlevel||a==r.itemlevel&&h<r.quality))if(-1==n)n=s;else{var l=e.ins().getItemData(i[n].item_type_id);(l.itemlevel<r.itemlevel||l.itemlevel==r.itemlevel&&l.quality<r.quality)&&(n=s)}}}return-1==n?-1:i[n].item_slot_idx},e.prototype.CheckCanDressEquit=function(){var t=this.bagModel[BagType.EQUIP],i=!1,n=this.PutDressList.length;this.PutDressList=[];for(var o=0;o<t.length;o++){var s=t[o].itemConfig;if(s&&s.part){var r=0,a=0,h=this.getBodyEquipByPart(s.part);if(void 0!=h&&(r=h.itemConfig.itemlevel,a=h.itemConfig.quality),1==this.getbinary2list(s.bintags)[12]&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=s.requiredlevel&&RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)>=s.reborn&&(r<s.itemlevel||r==s.itemlevel&&a<s.quality))if(void 0==this.PutDressList[s.part])this.PutDressList[s.part]=t[o],i=!0;else{var l=e.ins().getItemData(this.PutDressList[s.part].item_type_id);(l.itemlevel<s.itemlevel||l.itemlevel==s.itemlevel&&l.quality<s.quality)&&(this.PutDressList[s.part]=t[o],i=!0)}}}(i||n!=this.PutDressList.length)&&EventProxy.Broast(EventType.RecommendItem,{})},e.prototype.getHasEquipRed=function(){for(var t=0;10>t;t++){var i=e.ins().getDressIndexByPart(t+1);if(-1!=i)return!0}return!1},e.prototype.getSmeltList=function(){this.bagModel[BagType.EQUIP].sort(this.sort);for(var t=[],e=0;e<this.bagcount[BagType.EQUIP];e++)if(void 0!=this.bagModel[BagType.EQUIP][e]){var i=!0,n=this.bagModel[BagType.EQUIP][e].itemConfig;if(n&&n.bintags){var o=this.getbinary2list(n.bintags);if(1==o[14]){var s=this.getBodyEquipByPart(n.part);if(void 0!=s){var r=s.itemConfig;(n.itemlevel>r.itemlevel||n.itemlevel==r.itemlevel&&n.quality>r.quality)&&(i=!1)}if(i){var a=new ItemCellData;a=this.bagModel[BagType.EQUIP][e],t.push(a)}}}}return t},e.prototype.getItemCountByIDtype=function(t,e){for(var i=0,n=this.bagModel[e],o=0;o<n.length;o++)n[o].item_type_id==t&&(i+=n[o].item_count);return i},e.prototype.getItemCountByIdNoMoney=function(t){var e=this.getItemData(t);return void 0==e?0:this.getItemCountByIDtype(t,e.bag_type)},e.prototype.getItemCountById=function(t){var e=this.getItemData(t);return void 0==e?0:1e3>t&&3==e.type&&4==e.subtype?RoleProxy.ins().getMoneyAttr(t):this.getItemCountByIDtype(t,e.bag_type)},e.prototype.getBagStoneListByType=function(t){for(var e=[],i=0;i<this.bagcount[BagType.GEM_BAG];i++)if(void 0!=this.bagModel[BagType.GEM_BAG][i]){var n=GlobalConfig.getSoulstone_dataConfig(this.bagModel[BagType.GEM_BAG][i].item_type_id);if(n&&n.type==t){var o=new ItemCellData;o=this.bagModel[BagType.GEM_BAG][i],e.push(o)}}return e.sort(this.sort),e},e.getQualityColor=function(t){return this.QUALITY_COLOR[t-1]||0},e.prototype.getbinary2list=function(t){if(!t)return[];for(var e=[],i=0;0!=t&&(e[i]=t%2,t=Math.floor(t/2),0!=t);)i+=1;return e},e.prototype.OneKeySmelt=function(){if(!this.IsOneKeySmeltOpen())return void ViewManager.ins().open(SmeltView);var t=[];if(t=e.ins().getSmeltList(),!(t.length<=0)){for(var i=[],n=0;n<t.length;n++)i.push(t[n].item_slot_idx);SmeltProxy.ins().C2SReqMeltMelt(i)}},e.prototype.IsOneKeySmeltOpen=function(){var t=GlobalConfig.getLimitsConfig(1);if(t.vip_melt_limit<=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))return!0;for(var e in t.melt_newhang_limit)if(GuideProxy.ins().getCurGuideId()==t.melt_newhang_limit[e])return!0;return!1},e.prototype.GetDressListFight=function(){for(var t=0,e=0;e<this.bagModel[BagType.BODY_EQUIP].length;e++){var i=this.getItemData(this.bagModel[BagType.BODY_EQUIP][e].item_type_id);i.part<11&&(t+=UtilProxy.GetAttrFight(i))}return t},e.prototype.IsHasRedByItemId=function(t){if(0==t)return!1;var e=this.getItemData(t);if(e){if(e.reborn>RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)||e.requiredlevel>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL))return!1;if(2==e.type&&4==e.subtype)return e=e,e.vip_level>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)?!1:!0;if(2==e.type&&(1==e.subtype||2==e.subtype||3==e.subtype||4==e.subtype||5==e.subtype||6==e.subtype||7==e.subtype||13==e.subtype||14==e.subtype))return!0}return!1},e.prototype.GetRedByType=function(t){for(var e=this.bagModel[t],i=0;i<e.length;i++)if(e[i].item_type_id&&this.IsHasRedByItemId(e[i].item_type_id))return!0;return!1},e.prototype.GetRed=function(){return this.GetRedByType(BagType.BAG)?!0:!1},e.prototype.GetLVRankByType=function(t,e){var i=0;switch(t){case LvUpType.emZuoqi:if(e>0){var n=HorseProxy.ins().getHuaxingData(e);n&&n.level>0&&(i=Math.floor(n.level))}else i=HorseProxy.ins().grade;break;case LvUpType.emXL:if(e>0){var n=HuobanProxy.ins().getHuaxingData(e);n&&n.level>0&&(i=Math.floor(n.level))}else i=HuobanProxy.ins().grade;break;case LvUpType.emCW:if(e>0){var n=PetProxy.ins().getHuaxingData(e);n&&n.level>0&&(i=Math.floor(n.level))}else i=PetProxy.ins().grade;break;case LvUpType.emSB:i=WeaponProxy.ins().getLv2(1,e);break;case LvUpType.emXB:i=WeaponProxy.ins().getLv2(2,e);break;case LvUpType.emWing:i=WeaponProxy.ins().getLv2(3,e);break;case LvUpType.emSZ:var o=GrowupProxy.ins().getFashion(e);i=o?o.level:0}return i},e.prototype.GetHasLVUpItem=function(t,i){var n=e.ins().GetLVUpItem(t,i);if(n){var o=n.itemConfig;if(o.flags<=i)return!0}return!1},e.prototype.GetLVUpItem=function(t,e){var i=[],n=GameLogic.ins().getServerTime();if(this.LVUpRank=e,void 0!=this.bagModel[BagType.BAG])for(var o=0;o<this.bagModel[BagType.BAG].length;o++)if(this.bagModel[BagType.BAG][o]&&this.bagModel[BagType.BAG][o].itemConfig&&2==this.bagModel[BagType.BAG][o].itemConfig.type&&16==this.bagModel[BagType.BAG][o].itemConfig.subtype&&this.bagModel[BagType.BAG][o].expire_time>n){var s=this.bagModel[BagType.BAG][o].itemConfig;s.use_type==t&&i.push(this.bagModel[BagType.BAG][o])}return i.sort(this.SortLvUp),i[0]},e.prototype.SortLvUp=function(t,e){var i=t.itemConfig,n=t.itemConfig;if(i.flags==this.LVUpRank&&n.flags==this.LVUpRank){if(t.expire_time<e.expire_time)return-1;if(t.expire_time>e.expire_time)return 1}else{if(i.flags==this.LVUpRank)return-1;if(n.flags==this.LVUpRank)return 1;if(i.flags<this.LVUpRank&&n.flags<this.LVUpRank||i.flags>this.LVUpRank&&n.flags>this.LVUpRank){if(i.flags<n.flags)return-1;if(i.flags>n.flags)return 1;if(t.expire_time<e.expire_time)return-1;if(t.expire_time>e.expire_time)return 1}else{if(i.flags<this.LVUpRank)return-1;if(n.flags<this.LVUpRank)return 1}}return 0},e.prototype.GetFightUpState=function(t,e){for(var i=!1,n=0;n<e.length;n++)switch(t){case 1:i=WeaponProxy.ins().getLv2(3,e[n])>0;break;case 2:i=WeaponProxy.ins().getLv2(2,e[n])>0;break;case 3:i=HorseProxy.ins().isHuanxingActive(e[n]);break;case 4:i=-1!=GrowupProxy.ins().getTujianLevel(e[n]);break;case 5:i=HuobanProxy.ins().isHuanxingActive(e[n]);break;case 6:i=TitleProxy.ins().getTitleDataActiveById(e[n]);break;case 7:var o=this.getItemData(e[n]),s=this.getBodyEquipByPart(o.part);s&&s.item_type_id==e[n]&&(i=!0);break;case 8:i=FabaoProxy.ins().getFabaoLv(e[n])>0;break;case 9:i=WeaponProxy.ins().getLv2(1,e[n])>0;break;case 10:i=void 0!=GrowupProxy.ins().getFashion(e[n])}return i},e.prototype.GetIsAllGetById=function(t){var i=GlobalConfig.getFight_up_dataConfigsById(t);for(var n in i)if(!e.ins().GetFightUpState(i[n].type,i[n].nee_id))return!1;return!0},e.prototype.IsFightUpAllGet=function(){var t=GlobalConfig.getFight_up_dataConfigList();for(var e in t)if(t[e][1]&&!this.GetIsAllGetById(t[e][1].id))return!1;return!0},e.prototype.IsFightUpOpen=function(){return this.IsFightUpAllGet()?!1:this.getFightUpEndTime()>GameLogic.ins().getServerTime()?!0:!1},e.prototype.getFightUpEndTime=function(){var t=0,e=LimitActProxy.ins().GetServerOpenDay()-1,i=GlobalConfig.getMisc_dataConfig(1),n=i.fightup_open[1]+i.fightup_open[0]-e-1,o=LimitActProxy.ins().GetServerTimeDataByPassDay(n),s=UtilProxy.getStr("@0 /@1 /@2  23:59:59",[o.getFullYear(),o.getMonth()+1,o.getDate()]);return t=new Date(s).getTime()/1e3},e.prototype.C2SReqKnapsackGetUseCount=function(){var t=new net_protocol.C2SReqKnapsackGetUseCount;this.sendPbPack(Msg.C2SReqKnapsackGetUseCount,t,net_protocol.C2SReqKnapsackGetUseCount)},e.prototype.S2CRepKnapsackGetUseCount=function(t){for(var e=t.use_count,i=0;i<e.length;i++)this.useCountData[e[i].item_type_id]=e[i];EventProxy.Broast(EventType.S2CRepKnapsackGetUseCount,{})},e.prototype.getUseCountDataByID=function(t){var e=GlobalConfig.getuse_timesConfig(t);return void 0!=this.useCountData[e.group]?this.useCountData[e.group].use_count:0},e.prototype.getHuobanDressIndexByPart=function(t,i){var n,o,s=0,r=0;t==HuobanType.horse?(n=this.bagModel[BagType.HORSE_EQUIP],o=this.getHuobanBodyEquipByPart(BagType.HORSE_BODY_EQUIP,i),s=HorseProxy.ins().grade,r=HorseProxy.ins().star):t==HuobanType.mate?(n=this.bagModel[BagType.BELLE_EQUIP],o=this.getHuobanBodyEquipByPart(BagType.BELLE_BODY_EQUIP,i),s=HuobanProxy.ins().grade,r=HuobanProxy.ins().star):t==HuobanType.pet&&(n=this.bagModel[BagType.PET_EQUIP],o=this.getHuobanBodyEquipByPart(BagType.PET_BODY_EQUIP,i),s=PetProxy.ins().grade,r=PetProxy.ins().star);var a=-1,h=0,l=0,p=0,c=0;void 0!=o&&(h=o.itemConfig.itemlevel,l=o.itemConfig.quality,p=o.itemConfig.partner_grade,c=o.itemConfig.star);for(var u=0;u<n.length;u++){var d=n[u].itemConfig;if(d&&d.part&&d.reborn<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)&&d.requiredlevel<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)&&i==d.part&&(p<d.partner_grade||p==d.partner_grade&&c<d.star))if(-1==a)a=u;else{var g=e.ins().getItemData(n[a].item_type_id);g.partner_grade<d.partner_grade?a=u:g.star<d.star&&(a=u)}}return-1==a?-1:n[a].item_slot_idx},e.prototype.getHuobanSmeltList=function(t){var e=0,i=0,n=0,o=0;t==HuobanType.horse?(e=BagType.HORSE_EQUIP,i=BagType.HORSE_BODY_EQUIP,n=HorseProxy.ins().grade,o=HorseProxy.ins().star):t==HuobanType.mate?(e=BagType.BELLE_EQUIP,i=BagType.BELLE_BODY_EQUIP,n=HuobanProxy.ins().grade,o=HuobanProxy.ins().star):t==HuobanType.pet&&(e=BagType.PET_EQUIP,i=BagType.PET_BODY_EQUIP,n=PetProxy.ins().grade,o=PetProxy.ins().star),this.bagModel[e].sort(this.sort);for(var s=this.bagModel[e],r=[],a={},h={},l=0;l<s.length;l++)if(void 0!=s[l]){var p=!0,c=s[l].itemConfig;if(c&&(c.partner_grade==n?HuobanProxy.ins().getLeftCurState()&&(p=!1,void 0==h[c.part]||h[c.part].conf.star<c.star?(void 0!=h[c.part]&&r.push(h[c.part].model),h[c.part]={conf:c,model:s[l]}):r.push(s[l])):c.partner_grade>n&&HuobanProxy.ins().getLeftTopState()&&(p=!1,void 0==a[c.part]||a[c.part].conf.partner_grade<c.partner_grade||a[c.part].conf.partner_grade==c.partner_grade&&a[c.part].conf.star<c.star?(void 0!=a[c.part]&&r.push(a[c.part].model),a[c.part]={conf:c,model:s[l]}):r.push(s[l])),p)){var u=new ItemCellData;u=s[l],r.push(u)}}return r},e.prototype.getHuobanEquipRedByType=function(t){for(var i=0;4>i;i++){var n=e.ins().getHuobanDressIndexByPart(t,i+1);if(-1!=n)return!0}return!1},e.prototype.getHuobanEquipInfo=function(t){for(var e=[],i=0;4>i;i++){var n=this.getHuobanBodyEquipByPart(t,i+1);if(void 0!=n){var o=new ItemCellData;o=n,e[i]=o}else{var o=new ItemCellData;o.item_slot_idx=i+1,t==BagType.HORSE_BODY_EQUIP?o.item_sub_type=1:t==BagType.BELLE_BODY_EQUIP?o.item_sub_type=2:t==BagType.PET_BODY_EQUIP&&(o.item_sub_type=3),e[i]=o}}return e},e.prototype.C2SReqKnapsackPartnerArmList=function(t,e){var i=new net_protocol.C2SReqKnapsackPartnerArmList;i.type=t,i.list=e,this.sendPbPack(Msg.C2SReqKnapsackPartnerArmList,i,net_protocol.C2SReqKnapsackPartnerArmList)},e.prototype.C2SReqKnapsackPartnerMelt=function(t,e){var i=new net_protocol.C2SReqKnapsackPartnerMelt;i.type=t,i.slot_idx_list=e,this.sendPbPack(Msg.C2SReqKnapsackPartnerMelt,i,net_protocol.C2SReqKnapsackPartnerMelt)},e.prototype.S2CRepKnapsackPartnerMelt=function(t){EventProxy.Broast(EventType.S2CRepKnapsackPartnerMelt,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,{})},e.prototype.getHuobanEquipBgPic=function(t,e){return this.huobanPART_Pic[t-1]&&this.huobanPART_Pic[t-1][e-1]?this.huobanPART_Pic[t-1][e-1]:""},e.QUALITY_COLOR=[1,7,6,8,9,4],e.PART_NAME=["武器","项链","手镯","戒指","玉佩","玉袍","头盔","护腕","腰带","鞋子","武器","项链","手镯","戒指","玉佩","玉袍","头盔","护腕","腰带","鞋子","武器","项链","手镯","戒指","玉佩","玉袍","头盔","护腕","腰带","鞋子","武器","项链","手镯","戒指","玉佩","玉袍","头盔","护腕","腰带","鞋子","武器","项链","手镯","戒指","玉佩","玉袍","头盔","护腕","腰带","鞋子"],e.GODPART_Pic=["shenzhuang_EquipMask__wuqi","shenzhuang_EquipMask_xianlian","shenzhuang_EquipMask_shouzhuo","shenzhuang_EquipMask__jiezhi","shenzhuang_EquipMask_erhuan","shenzhuang_EquipMask_yifu","shenzhuang_EquipMask_toukui","shenzhuang_EquipMask_huwan","shenzhuang_EquipMask_yaodai","shenzhuang_EquipMask_xiezi"],e}(BaseSystem);__reflect(BagProxy.prototype,"BagProxy");var BaoWuType;!function(t){t[t.ImmortalPlatform=1]="ImmortalPlatform",t[t.PalmBottle=2]="PalmBottle",t[t.KillSword=3]="KillSword",t[t.EmperorTripod=4]="EmperorTripod"}(BaoWuType||(BaoWuType={}));var BaoWuProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25805,this.S2CRepFabaoGetBaowuInfo,this),MsgHandle.ins().regNetMsg(25806,this.S2CRepFabaoBaowuUpgrade,this),MsgHandle.ins().regNetMsg(25807,this.S2CRepFabaoBaowuSwallow,this)},e.prototype.C2SReqFabaoGetBaowuInfo=function(){var t=new net_protocol.C2SReqFabaoGetBaowuInfo;this.sendPbPack(Msg.C2SReqFabaoGetBaowuInfo,t,net_protocol.C2SReqFabaoGetBaowuInfo)},e.prototype.C2SReqFabaoBaowuUpgrade=function(t,e,i){var n=new net_protocol.C2SReqFabaoBaowuUpgrade;n.id=t,n.type=e,n.opt=i,this.sendPbPack(Msg.C2SReqFabaoBaowuUpgrade,n,net_protocol.C2SReqFabaoBaowuUpgrade)},e.prototype.C2SReqFabaoBaowuSwallow=function(t,e,i){var n=new net_protocol.C2SReqFabaoBaowuSwallow;n.id=t,n.type=e,n.opt=i,this.sendPbPack(Msg.C2SReqFabaoBaowuSwallow,n,net_protocol.C2SReqFabaoBaowuSwallow)},e.prototype.S2CRepFabaoGetBaowuInfo=function(t){var e=net_protocol.S2CRepFabaoGetBaowuInfo.decode(t.bytes);CommonUtils.log("--------BaoWuProxy----------------------------S2CRepFabaoGetBaowuInfo",e),this.list=e.list,EventProxy.Broast(EventType.S2CRepFabaoGetBaowuInfo,[])},e.prototype.S2CRepFabaoBaowuUpgrade=function(t){var e=net_protocol.S2CRepFabaoBaowuUpgrade.decode(t.bytes);CommonUtils.log("--------BaoWuProxy---------------------S2CRepFabaoBaowuUpgrade",e);var i=!1;1==e.is_cirt;var n=!1;if(this.list)for(var o=0;o<this.list.length;++o)if(this.list[o].id==e.id){n=!0,this.list[o].exp=e.exp;var s=Math.ceil(this.list[o].level/10),r=Math.ceil(e.level/10);i=s!=r,this.list[o].level=e.level}if(!n){var a=[];a.id=e.id,a.exp=e.exp,a.level=e.level,a.swallow1=0,a.swallow2=0,this.list||(this.list=[]),this.list.push(a)}EventProxy.Broast(EventType.S2CRepFabaoBaowuUpgrade,[e.id,i]),EventProxy.Broast(EventType.BaowuRedRefresh,[e.id])},e.prototype.S2CRepFabaoBaowuSwallow=function(t){var e=net_protocol.S2CRepFabaoBaowuSwallow.decode(t.bytes);CommonUtils.log("--------BaoWuProxy----------------------------S2CRepFabaoBaowuSwallow",e);var i=!1;if(this.list)for(var n=0;n<this.list.length;++n)this.list[n].id==e.id&&(i=!0,this.list[n].swallow1=e.swallow1,this.list[n].swallow2=e.swallow2);EventProxy.Broast(EventType.S2CRepFabaoBaowuSwallow,[e.id]),EventProxy.Broast(EventType.BaowuRedRefresh,[e.id])},e.prototype.getDataByType=function(t){if(this.list)for(var e=0;e<this.list.length;++e)if(this.list[e].id==t)return this.list[e]},e.prototype.getMaxSwallowByType=function(t,e){var i=this.getDataByType(t);if(i&&i.level>0){var n=GlobalConfig.getBaowu_base_dataConfigBylvl(t,i.level);return n?n.max_swallow_list[e-1][1]:0}return 0},e.prototype.getNextMaxSwallowByType=function(t,e){var i=this.getDataByType(t);if(i){var n=GlobalConfig.getBaowu_base_dataConfigsById(t);if(n[i.level+10]){var o=n[i.level+10];return o?o.max_swallow_list[e-1][1]:0}}return 0},e.prototype.getCurSwallowByType=function(t,e){var i=this.getDataByType(t);return i?1==e?i.swallow1:i.swallow2:0},e.prototype.getDanItemIdByType=function(t,e){var i=GlobalConfig.getBaowu_base_dataConfigBylvl(t,1);return i?i.max_swallow_list[e-1][0]:0},e.prototype.isMaxSwallowByType=function(t,e){var i=this.getDataByType(t);if(i&&i.level>0){var n=1==e?i.swallow1:i.swallow2,o=GlobalConfig.getBaowu_base_dataConfigBylvl(t,i.level);if(o&&o.max_swallow_list[e-1][1]>n)return!0}return!1},e.prototype.getNumberImg=function(t){var e="";switch(t){case 0:e="ling";break;case 1:e="yi";break;case 2:e="er";break;case 3:e="san";break;case 4:e="si";break;case 5:e="wu";break;case 6:e="liu";break;case 7:e="qi";break;case 8:e="ba";break;case 9:e="jiu";break;case 10:e="shi"}return e},e.prototype.getModelPath=function(t){var e=GlobalConfig.getBaowu_exp_item_dataConfigById(t);return e?e.path:""},e.prototype.getTotalAttr=function(t){var i=e.ins().getDataByType(t),n=GlobalConfig.getBaowu_base_dataConfigsById(i.id);if(n){var o=n[i.level];AttrProxy.getAttrInfo(o)}var s=GlobalConfig.getBaowu_exp_item_dataConfigById(t),r=s.exp_items;r[0][0],r[1][0],e.ins().getCurSwallowByType(t,1),e.ins().getCurSwallowByType(t,1)},e.prototype.getTotleFight=function(t){var e=this.getTotleProInfo(t),i=UtilProxy.GetAttrFight(e),n=this.getAddAllAttr(t);return n>0?Math.floor(i*(n/1e4+1)):i},e.prototype.getTotleProInfo=function(t){var i=this.getDataByType(t),n={};if(i&&i.level>0){var o=GlobalConfig.getBaowu_base_dataConfigBylvl(t,i.level);n=RoleProxy.ins().getTableAdd(n,o)}var s=e.ins().getCurSwallowByType(t,1),r=e.ins().getCurSwallowByType(t,2),a=this.getDanItemIdByType(t,1),h=this.getDanItemIdByType(t,2),l=GlobalConfig.getBaowu_swallow_item_attrConfigByid(a),p=GlobalConfig.getBaowu_swallow_item_attrConfigByid(h);if(s>0)for(var c=0;s>c;++c)n=RoleProxy.ins().getTableAdd(n,l);if(r>0)for(var c=0;r>c;++c)n=RoleProxy.ins().getTableAdd(n,p);return n},e.prototype.getPrePecents=function(t){var i=e.ins().getCurSwallowByType(t,2);if(0==i)return 0;var n=e.ins().getDanItemIdByType(t,2),o=GlobalConfig.getBaowu_swallow_item_attrConfigByid(n);return o.lianshen_pre*i},e.prototype.getAddAllAttr=function(t){var i=this.getDanItemIdByType(t,2),n=e.ins().getCurSwallowByType(t,2),o=GlobalConfig.getBaowu_swallow_item_attrConfigByid(i);return n*o.lianshen_pre},e.prototype.openStoreView=function(t,e){var i=StoreProxy.ins().getStoreType(t);if(1==i){for(var n=0,o=StoreProxy.ins().getStoreConfigByStoreType("1"),s=0;s<o.length;++s)o[s].id==t&&(n=s);ViewManager.ins().open(StoreView,n,e)}else if(3==i){for(var n=0,o=StoreProxy.ins().getStoreConfigByStoreType("3"),s=0;s<o.length;++s)o[s].id==t&&(n=s);ViewManager.ins().open(BaowuStoreView,n,e)}},e.prototype.getRedByType=function(t){var i=1==t?1:2,n=1==t?66:6600+t-1;if(!SystemOpenProxy.ins().isOpen(i,n,!0))return!1;var o=GlobalConfig.getBaowu_exp_item_dataConfigById(t);if(!o)return!1;var s=o.exp_items;if(!s)return!1;var r=s[0][0],a=s[1][0];if(BagProxy.ins().getItemCountById(r)>0)return!0;if(BagProxy.ins().getItemCountById(a)>0)return!0;for(var h=1;2>=h;++h){var l=e.ins().getCurSwallowByType(t,h),p=e.ins().getMaxSwallowByType(t,h);if(p>l){var c=e.ins().getDanItemIdByType(t,h);if(BagProxy.ins().getItemCountById(c)>0)return!0}}return!1},e.prototype.isDanRedByType=function(t,i){var n=e.ins().getCurSwallowByType(t,i),o=e.ins().getMaxSwallowByType(t,i);if(o>n){var s=e.ins().getDanItemIdByType(t,i);if(BagProxy.ins().getItemCountById(s)>0)return!0}return!1},e.prototype.getRed=function(){return this.getRedByType(1)||this.getRedByType(2)||this.getRedByType(3)||this.getRedByType(4)||this.getRedByType(5)},e.prototype.isBaowuMaterial=function(t){if(!this.item_list){this.item_list=[];for(var i=1;4>=i;++i){var n=GlobalConfig.getBaowu_exp_item_dataConfigById(i);n&&n.exp_items&&(this.item_list.push(n.exp_items[0][0]),this.item_list.push(n.exp_items[1][0])),this.item_list.push(e.ins().getDanItemIdByType(i,1)),this.item_list.push(e.ins().getDanItemIdByType(i,2))}}for(var i=0;i<this.item_list.length;++i)if(this.item_list[i]==t)return!0;return!1},e.prototype.getNextGrade=function(t,e){var i=GlobalConfig.getBaowu_base_dataConfigsById(t);if(i){var n=0==e?1:10*e+1;if(i[n])return i[n]}},e}(BaseSystem);__reflect(BaoWuProxy.prototype,"BaoWuProxy");var BeStrongerProxy=function(t){function e(){var e=t.call(this)||this;return e.list=(i={},i[1]={},i[2]={},i),e.initList(),e;var i}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initList=function(){this.list[1][10]=function(){return UpgradeProxy.ins().getAllFightValue()},this.list[2][1001]=function(){return SoulStoneProxy.ins().getAllFightValue()},this.list[2][1002]=function(){return UpStarProxy.ins().getAllFightValue()},this.list[2][1003]=function(){return ZhulingProxy.ins().getAllFightValue()},this.list[2][1004]=function(){return RefineProxy.ins().getAllFightValue()},this.list[1][190]=function(){return XiuXianProxy.ins().getdujieFight()},this.list[2][1902]=function(){return XiuXianProxy.ins().getzhuanFight()},this.list[2][1903]=function(){return XiuXianProxy.ins().getxianfuFight()},this.list[1][29]=function(){return SkillProxy.ins().getSkillFight()},this.list[1][20]=function(){return HuobanProxy.ins().getFight()},this.list[2][2001]=function(){return PetProxy.ins().getFight()},this.list[2][2002]=function(){return HorseProxy.ins().getFight()},this.list[1][30]=function(){return GrowupProxy.ins().GetTujianFight()},this.list[1][31]=function(){return GrowupProxy.ins().GetFuyinFight()},this.list[1][34]=function(){return FabaoProxy.ins().getFight()},this.list[1][36]=function(){return FwProxy.ins().getFightNum()},this.list[1][37]=function(){return VenationProxy.ins().getFightNum()},this.list[2][1904]=function(){return ZhenbaoProxy.ins().getTotleFight()},this.list[1][17]=function(){return GrowupProxy.ins().GetFashionFight()},this.list[1][66]=function(){return BaoWuProxy.ins().getTotleFight(BaoWuType.ImmortalPlatform)},this.list[1][18]=function(){return WeaponProxy.ins().getFight(WeaponType.Wing)},this.list[2][6601]=function(){return BaoWuProxy.ins().getTotleFight(BaoWuType.PalmBottle)},this.list[2][6602]=function(){return BaoWuProxy.ins().getTotleFight(BaoWuType.KillSword)},this.list[2][6603]=function(){return BaoWuProxy.ins().getTotleFight(BaoWuType.EmperorTripod)},this.list[2][1801]=function(){return WeaponProxy.ins().getFight(WeaponType.Weapon)},this.list[2][1802]=function(){return WeaponProxy.ins().getFight(WeaponType.XuanBing)}},e.prototype.getSysFight=function(t,e){var i=0;return this.list[t][e]&&void 0!=this.list[t][e]?i=this.list[t][e]():i},e}(BaseClass);__reflect(BeStrongerProxy.prototype,"BeStrongerProxy");var BossActType;!function(t){t[t.limit_time_guan=1]="limit_time_guan",t[t.boss_happy_time=2]="boss_happy_time",t[t.level_reward=3]="level_reward",t[t.sytower_rank=4]="sytower_rank"}(BossActType||(BossActType={}));var BossActProxy=function(t){function e(){var e=t.call(this)||this;return e.bossActList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(27286,this.S2CRepLimitActTimeActGetInfo,this),MsgHandle.ins().regNetMsg(27287,this.S2CRepLimitActTimeActUpdate,this),MsgHandle.ins().regNetMsg(27288,this.S2CRepLimitActTimeActGetAward,this)},e.prototype.C2SReqLimitActTimeActGetInfo=function(){var t=new net_protocol.C2SReqLimitActTimeActGetInfo;this.sendPbPack(Msg.C2SReqLimitActTimeActGetInfo,t,net_protocol.C2SReqLimitActTimeActGetInfo)},e.prototype.C2SReqLimitActTimeActGetAward=function(t,e){var i=new net_protocol.C2SReqLimitActTimeActGetAward;i.act_id=e,i.act_type=t,this.sendPbPack(Msg.C2SReqLimitActTimeActGetAward,i,net_protocol.C2SReqLimitActTimeActGetAward)},e.prototype.S2CRepLimitActTimeActGetInfo=function(t){var e=net_protocol.S2CRepLimitActTimeActGetInfo.decode(t.bytes);CommonUtils.log("----------------------------------------------S2CRepLimitActTimeActGetInfo------------>",e),this.list=e.list,this.times_list=e.times_list,this.initBossData();for(var i=0;i<this.list.length;++i){var n=this.bossActList[this.list[i].act_type];if(n&&this.list[i].get_ids)for(var o=0;o<this.list[i].get_ids.length;++o)for(var s=this.list[i].get_ids[o],r=0;r<n.length;++r)n[r].id==s&&(n[r].state=0),this.bossActList[this.list[i].act_type]=n;if(this.list[i].counts)for(var o=0;o<this.list[i].counts.length;++o){for(var n=this.bossActList[this.list[i].act_type],a=this.list[i].counts[o].act_id,h=this.list[i].counts[o].count,r=0;r<n.length;++r)n[r].id==a&&0!=n[r].state&&n[r].count<=h&&(n[r].state=2);this.bossActList[this.list[i].act_type]=n}}EventProxy.Broast(EventType.S2CRepLimitActTimeActGetInfo,[]),EventProxy.Broast(EventType.freshLimitActRed,[])},e.prototype.getCountByActId=function(t,e){for(var i=0;i<this.list.length;++i)if(this.list[i].act_type==t)for(var n=0;n<this.list[i].counts.length;++n)if(this.list[i].counts[n].act_id==e)return this.list[i].counts[n].count;return 0},e.prototype.S2CRepLimitActTimeActUpdate=function(t){var e=net_protocol.S2CRepLimitActTimeActUpdate.decode(t.bytes);if(CommonUtils.log("----------------------------------------------S2CRepLimitActTimeActUpdate------------>",e),this.list){for(var i=0;i<this.list.length;++i)if(this.list[i].act_type==e.act_type){for(var n=this.bossActList[this.list[i].act_type],o=0;o<e.counts.length;++o)for(var s=e.counts[o].act_id,r=e.counts[o].count,a=0;a<n.length;++a)n[a].id==s&&0!=n[a].state&&n[a].count<=r&&(n[a].state=2);this.list[i].counts=e.counts}EventProxy.Broast(EventType.S2CRepLimitActTimeActUpdate,[]),EventProxy.Broast(EventType.freshLimitActRed,[])}},e.prototype.S2CRepLimitActTimeActGetAward=function(t){var e=net_protocol.S2CRepLimitActTimeActGetAward.decode(t.bytes);CommonUtils.log("----------------------------------------------S2CRepLimitActTimeActGetAward------------>",e);for(var i=0;i<this.list.length;++i)this.list[i].act_type==e.act_type&&(void 0==this.list[i].get_ids&&(this.list[i].get_ids=[]),this.list[i].get_ids.push(e.act_id));for(var n=this.bossActList[e.act_type],o=0;o<n.length;++o)n[o].id==e.act_id&&(n[o].state=0);if(this.isLimitNumById(e.act_type,e.act_id)){var s=0;if(this.times_list){for(var i=0;i<this.times_list.length;++i)if(this.times_list[i].act_type==e.act_type){s=1;
for(var r=this.times_list[i].list,a=0;a<r.length;++a)r.act_id==e.act_id&&(r.times=r.times+1,s=2);if(2!=s){var h={act_id:e.act_id,times:1};r.push(h)}this.times_list[i].list=r}}else this.times_list=[];0==s&&this.times_list.push({act_type:e.act_type,list:[{act_id:e.act_id,times:1}]})}this.bossActList[e.act_type]=n,EventProxy.Broast(EventType.S2CRepLimitActTimeActGetAward,[e.act_type,e.act_id]),EventProxy.Broast(EventType.freshLimitActRed,[])},e.prototype.isGetReward=function(t,e){for(var i=0;i<this.list.length;++i)if(this.list[i].act_type==t&&this.list[i].get_ids)for(var n=0;n<this.list[i].get_ids.length;++n)if(this.list[i].get_ids[n]==e)return!0;return!1},e.prototype.initBossData=function(){if(0==this.bossActList.length){this.bossActList=[];var t=GlobalConfig.getConfig("limit_time_act_data","limit_time_act_dataConfig");for(var e in t){this.bossActList[Number(e)]||(this.bossActList[Number(e)]=[]);for(var i in t[e])this.bossActList[Number(e)].push({state:1,id:t[e][i].act_id,count:t[e][i].params[0],start:t[e][i].opensrv_limit[0],end:t[e][i].opensrv_limit[1],config:t[e][i]})}}},e.prototype.getBossActDataByType=function(t){return this.bossActList[t]||this.initBossData(),this.bossActList[t]},e.prototype.sort=function(t,e){return t.state>e.state?-1:t.state<e.state?1:t.id<e.id?-1:1},e.prototype.getRedByType=function(t){for(var e=this.getBossActDataByType(t),i=LimitActProxy.ins().GetServerOpenDay(),n=0;n<e.length;++n)if(e[n].start<=i&&e[n].end>=i&&2==e[n].state)return!0;return!1},e.prototype.getActActiveByType=function(t){var i=e.ins().getBossActDataByType(t),n=LimitActProxy.ins().GetServerOpenDay();if(i)for(var o=0;o<i.length;++o)if(i[o].start<=n&&i[o].end>=n)return!0;return!1},e.prototype.getBossActLeftTime=function(t){var e=LimitActProxy.ins().GetServerOpenDay();if(t>=e){var i=GameLogic.ins().getServerTime(),n=new Date(1e3*i),o=24*(t+1-e)*3600,s=o-3600*n.getHours()-60*n.getMinutes()-n.getSeconds();return s}return 0},e.prototype.getActTimes=function(t,e){if(this.times_list)for(var i=0;i<this.times_list.length;++i)if(this.times_list[i].act_type==t)for(var n=0;n<this.times_list[i].list.length;++n)if(this.times_list[i].list[n].act_id==e)return this.times_list[i].list[n].times;return 0},e.prototype.isLimitNumById=function(t,e){var i=GlobalConfig.getLimit_time_act_dataConfig(t,e);return i&&i.limit_num},e.prototype.getRed=function(){return CopyProxy.ins().getBossLimitRed()||this.getRedByType(BossActType.boss_happy_time)||this.getRedByType(BossActType.level_reward)||this.getRedByType(BossActType.limit_time_guan)||this.getRedByType(BossActType.sytower_rank)},e}(BaseSystem);__reflect(BossActProxy.prototype,"BossActProxy");var BOSSTYPE;!function(t){t[t.SINGLE=1]="SINGLE",t[t.WORLD=2]="WORLD",t[t.MIJING=3]="MIJING",t[t.SHENYUAN=4]="SHENYUAN",t[t.KUAFU=5]="KUAFU",t[t.YAMA=6]="YAMA",t[t.EXOTIC=7]="EXOTIC",t[t.BEAST=8]="BEAST",t[t.GHOST=9]="GHOST",t[t.XMJ=10]="XMJ",t[t.SHENWEN=11]="SHENWEN"}(BOSSTYPE||(BOSSTYPE={}));var BossRewardData=function(){function t(){}return t}();__reflect(BossRewardData.prototype,"BossRewardData");var BossKillRecord=function(){function t(){}return t}();__reflect(BossKillRecord.prototype,"BossKillRecord");var BossProxy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boss_net_map=[],e.single_boss_count=0,e.my_rank=0,e.my_hurt=0,e.boss_obj_id=-1,e.monster_id=-1,e.boss_name="",e.obj_id=-1,e.drop_ower_obj_id=-1,e.drop_ower_name="",e.strength=0,e.strength_per=0,e.strength_per_value=0,e.strength_max=0,e.boss_id=0,e.records=[],e.cross_challenge_num=0,e.last_recover_cross_num_time=0,e.buy_challenge_times=0,e.shenwen_challenge_num=0,e.last_recover_shenwen_num_time=0,e.buy_shenwen_times=0,e.boss_left_time=0,e.bossHurtAward=[],e.yama_Random_list=[],e.bossPartReward=[],e.isAutoChallenge=!1,e.index=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(26150,this.S2CRepBossData,this),MsgHandle.ins().regNetMsg(26151,this.S2CRepBossNextAppear,this),MsgHandle.ins().regNetMsg(26152,this.S2CRepBossSingleSend,this),MsgHandle.ins().regNetMsg(26153,this.S2CRepBossGetRoleNum,this),MsgHandle.ins().regNetMsg(26154,this.S2CRepBossSceneInfoChange,this),MsgHandle.ins().regNetMsg(26155,this.S2CRepBossKillRecord,this),MsgHandle.ins().regNetMsg(26156,this.S2CRepBossDropRecords,this),MsgHandle.ins().regNetMsg(26157,this.S2CRepBossSyData,this),MsgHandle.ins().regNetMsg(26158,this.S2CRepBossTqData,this),MsgHandle.ins().regNetMsg(26159,this.S2CReqBossTqStatus,this),MsgHandle.ins().regNetMsg(26160,this.S2CReqBossUpdateTired,this),MsgHandle.ins().regNetMsg(20114,this.S2CBossHurtRank,this),MsgHandle.ins().regNetMsg(20115,this.S2COnLeaveBoss,this),MsgHandle.ins().regNetMsg(20124,this.S2CRepMonsterDropOwerChange,this),MsgHandle.ins().regNetMsg(26161,this.S2CReqBossDataUpdate,this),MsgHandle.ins().regNetMsg(26162,this.S2CReqBossPartReward,this),MsgHandle.ins().regNetMsg(26163,this.S2CReqBossHurtAward,this),MsgHandle.ins().regNetMsg(26164,this.S2CReqBossBuyChallengeNum,this),MsgHandle.ins().regNetMsg(26165,this.S2CReqBossYlsdTeamBigAward,this),MsgHandle.ins().regNetMsg(26166,this.S2CReqBossYlsdRandom,this),MsgHandle.ins().regNetMsg(26167,this.S2CReqBossBuyTimes,this),MsgHandle.ins().regNetMsg(26168,this.S2CReqBossTouchBox,this),MsgHandle.ins().regNetMsg(26169,this.S2CReqBossGetBoxAward,this),MsgHandle.ins().regNetMsg(26170,this.S2CReqBossShenwenBuyChallengeNum,this)},e.prototype.C2SReqBossData=function(){var t=new net_protocol.C2SReqBossData;CommonUtils.log(" ^^***^^  C2SReqBossData",Msg.C2SReqBossData),this.sendPbPack(Msg.C2SReqBossData,t,net_protocol.C2SReqBossData)},e.prototype.C2SReqBossGetRoleNum=function(){var t=new net_protocol.C2SReqBossGetRoleNum;this.sendPbPack(Msg.C2SReqBossGetRoleNum,t,net_protocol.C2SReqBossGetRoleNum)},e.prototype.C2SReqBossKillRecord=function(t){var e=new net_protocol.C2SReqBossKillRecord;e.boss_id=t,this.sendPbPack(Msg.C2SReqBossKillRecord,e,net_protocol.C2SReqBossKillRecord)},e.prototype.C2SReqBossDropRecords=function(){var t=new net_protocol.C2SReqBossDropRecords;this.sendPbPack(Msg.C2SReqBossDropRecords,t,net_protocol.C2SReqBossDropRecords)},e.prototype.C2SReqBossSyData=function(){var t=new net_protocol.C2SReqBossSyData;this.sendPbPack(Msg.C2SReqBossSyData,t,net_protocol.C2SReqBossSyData)},e.prototype.C2SReqBossTqData=function(){var t=new net_protocol.C2SReqBossTqData;this.sendPbPack(Msg.C2SReqBossTqData,t,net_protocol.C2SReqBossTqData)},e.prototype.C2SReqBossBuyTimes=function(t,e){var i=new net_protocol.C2SReqBossBuyTimes;i.boss_type=t,i.num=e,this.sendPbPack(Msg.C2SReqBossBuyTimes,i,net_protocol.C2SReqBossBuyTimes)},e.prototype.S2CRepBossData=function(t){var e=net_protocol.S2CRepBossData.decode(t.bytes);CommonUtils.log(" ---------------------------------------------^^***^^  S2CRepBossData",e),this.tired_list=e.tired_list,GlobalConfig.getConfig("scene_condition","scene_conditionConfig"),this.BossSceneLimit=[];for(var i in GlobalConfig.ins().scene_conditionConfig){var n,o=GlobalConfig.ins().scene_conditionConfig[i];n=o.item_cond.length>=4?{free_times:0,total_times:0,next_free_time:0,total_free:o.item_cond[1],limit_times:o.item_cond[2],item_id:o.item_cond[3],item_count:o.item_cond[4]}:{free_times:0,total_times:0,next_free_time:0,total_free:0,limit_times:0,item_id:0,item_count:0},this.BossSceneLimit[o.id]=n}for(var s=0;s<e.scene_list.length;++s){var r=e.scene_list[s];if(void 0==this.BossSceneLimit[r.scene_id]){var n;n={free_times:r.free_times,total_times:r.total_times,next_free_time:r.next_free_time,total_free:0,limit_times:0,item_id:0,item_count:0},this.BossSceneLimit[r.scene_id]=n}else{var n=this.BossSceneLimit[r.scene_id];n.free_times=r.free_times,n.total_times=r.total_times,n.next_free_time=r.next_free_time,this.BossSceneLimit[r.scene_id]=n}}this.single_boss=[],this.single_boss_count=0,GlobalConfig.getConfig("copy_data","CopyDataConfig");new Array;for(var i in GlobalConfig.ins().CopyDataConfig){var a=GlobalConfig.ins().CopyDataConfig[i];if(11==a.speciallogic_type&&void 0==this.single_boss[a.id]){var h={copy_id:a.id,total_time:a.times,times:0,next_free_time:0};this.single_boss[a.id]=h,this.single_boss_count=this.single_boss_count+1}}for(var i in e.single_boss)if(this.single_boss[e.single_boss[i].copy_id]){var n=this.single_boss[e.single_boss[i].copy_id];n.times=e.single_boss[i].times,n.next_free_time=e.single_boss[i].next_free_time,this.single_boss[e.single_boss[i].copy_id]=n}this.boss_net_map={},this.boss_net_map[BOSSTYPE.WORLD]=this.yewai_boss_list,this.boss_net_map[BOSSTYPE.SHENYUAN]=this.shenyuan_boss_list,this.boss_net_map[BOSSTYPE.MIJING]=this.mijing_boss_list,this.boss_net_map[BOSSTYPE.KUAFU]=this.cross_boss_list,this.boss_net_map[BOSSTYPE.YAMA]=this.ylsd_boss_list,this.boss_net_map[BOSSTYPE.EXOTIC]=this.exotic_boss_list,this.SetBossNetData(BOSSTYPE.WORLD,e.yewai_boss_list),this.SetBossNetData(BOSSTYPE.SHENYUAN,e.shenyuan_boss_list),this.SetBossNetData(BOSSTYPE.MIJING,e.mijing_boss_list),this.SetBossNetData(BOSSTYPE.KUAFU,e.cross_boss_list),this.SetBossNetData(BOSSTYPE.YAMA,e.ylsd_boss_list),this.SetBossNetData(BOSSTYPE.EXOTIC,e.diyu_boss_list);for(var i in e.boss_appear_list)this.SetBossNetData(e.boss_appear_list[i].boss_type,e.boss_appear_list[i].list);this.strength=e.strength;var l=GlobalConfig.getMisc_dataConfig(1);this.strength_per=l.strength_recover_time,this.strength_per_value=l.strength_recover,this.strength_max=l.max_strength,this.cross_challenge_num=e.cross_challenge_num,this.last_recover_cross_num_time=e.last_recover_cross_num_time,this.buy_challenge_times=e.buy_challenge_times,this.ylsd_big_award=e.ylsd_big_award,this.bossHurtAward=e.cross_hurt_award_list,this.challenge_list=e.challenge_list,this.pig_list=e.pig_list,this.scene_time_list=e.scene_time_list,this.shenwen_challenge_num=e.cross_shenwen_challenge_num,this.last_recover_shenwen_num_time=e.cross_shenwen_last_recover_num_time,this.buy_shenwen_times=e.cross_shenwen_buy_challenge_times,TimerManager.ins().remove(this.upDateTime,this),TimerManager.ins().doTimer(500,0,this.upDateTime,this),this.initReviveList(),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.StrengthRecover=function(){this.strength<this.strength_max&&(this.strength=this.strength+this.strength_per_value,EventProxy.Broast(EventType.StrengthRefresh,{}))},e.prototype.S2CRepBossNextAppear=function(t){var i=net_protocol.S2CRepBossNextAppear.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CRepBossNextAppear",i);for(var n in i.boss_list){var o=i.boss_list[n],s=GlobalConfig.getBossConfig(o.boss_id);if(void 0!=s&&s.type!=BOSSTYPE.SINGLE){var r=!1,a=this.boss_net_map[s.type];if(void 0!=a)for(var h=0;h<a.length;++h)a[h].boss_id==o.boss_id&&(a[h].boss_id=o.boss_id,a[h].status=o.status,a[h].next_time=o.next_time,r=!0);else a=[];if(!r){var l={};l.boss_id=o.boss_id,l.status=o.status,l.next_time=o.next_time,a.push(l)}if(this.boss_net_map[s.type]=a,s.type==BOSSTYPE.WORLD||s.type==BOSSTYPE.MIJING||s.type==BOSSTYPE.SHENYUAN){var p=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());if(void 0==p)return;1==p.scene_type&&(1==o.status&&0==o.next_time&&this.isAutoChallenge&&this.isAutoChallengeBoss(s.type,o.boss_id)?(s.type!=BOSSTYPE.WORLD||s.type==BOSSTYPE.WORLD&&s.strength<=e.ins().strength)&&this.enterBossScene(s.scene):1==o.status&&0==o.next_time&&this.isBossShowTips(o.boss_id)&&this.isBossReviveTips(s.type,o.boss_id)&&EventProxy.Broast(EventType.UpdateBossRevive,[o.boss_id]))}}}EventProxy.Broast(EventType.S2CRepBossNextAppear,[]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.SetBossNetData=function(t,e){this.boss_net_map[t]=[];for(var i=0;i<e.length;++i){var n={};n.boss_id=e[i].boss_id,n.status=e[i].status,n.next_time=e[i].next_time,this.boss_net_map[t].push(n)}},e.prototype.S2CRepBossSingleSend=function(t){var e=net_protocol.S2CRepBossSingleSend.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CRepBossSingleSend",e);e.data.copy_id;void 0!=this.single_boss[e.data.copy_id]&&(this.single_boss[e.data.copy_id].times=e.data.times,this.single_boss[e.data.copy_id].next_free_time=e.data.next_free_time),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.S2CRepBossGetRoleNum=function(t){var e=net_protocol.S2CRepBossGetRoleNum.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CRepBossGetRoleNum",e)},e.prototype.S2CRepBossSceneInfoChange=function(t){var e=net_protocol.S2CRepBossSceneInfoChange.decode(t.bytes);if(CommonUtils.log(" ^^***^^  S2CRepBossSceneInfoChange",e),this.BossSceneLimit||(this.BossSceneLimit=[]),void 0==this.BossSceneLimit[e.scene.scene_id]){var i;i={free_times:e.scene.free_times,total_times:e.scene.total_times,next_free_time:e.scene.next_free_time,total_free:0,limit_times:0,item_id:0,item_count:0},this.BossSceneLimit[e.scene.scene_id]=i}else{var i=this.BossSceneLimit[e.scene.scene_id];i.free_times=e.scene.free_times,i.total_times=e.scene.total_times,i.next_free_time=e.scene.next_free_time,this.BossSceneLimit[e.scene.scene_id]=i}EventProxy.Broast(EventType.S2CRepBossSceneInfoChange,[]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.S2CRepBossKillRecord=function(t){var e=net_protocol.S2CRepBossKillRecord.decode(t.bytes);this.boss_id=e.boss_id,this.records=e.records,this.records.sort(this.sortKillTime),this.addBossRecordMap(e.boss_id,this.records),CommonUtils.log(" ^^***^^  S2CRepBossKillRecord",e);var i=GlobalConfig.getBossConfig(e.boss_id);(i.type==BOSSTYPE.WORLD||i.type==BOSSTYPE.MIJING||i.type==BOSSTYPE.SHENYUAN||i.type==BOSSTYPE.EXOTIC)&&ViewManager.ins().open(BossRecordView,this.records),EventProxy.Broast(EventType.S2CRepBossKillRecord,[e.boss_id])},e.prototype.addBossRecordMap=function(t,e){this.bossRecordMap||(this.bossRecordMap=[]);for(var i=!1,n=0;n<this.bossRecordMap.length;++n)this.bossRecordMap[n].boss_id==t&&(this.bossRecordMap[n].records=e,i=!0);i||this.bossRecordMap.push({boss_id:t,records:e})},e.prototype.getBossLastRecordName=function(t){if(this.bossRecordMap)for(var e=this.bossRecordMap,i=0;i<e.length;++i)if(e[i].boss_id==t)return e[i].records.length>0?e[i].records[e[i].records.length-1].role_name:"";return""},e.prototype.sortKillTime=function(t,e){return t.time>e.time?1:-1},e.prototype.S2CRepBossDropRecords=function(t){var e=net_protocol.S2CRepBossDropRecords.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CRepBossDropRecords",e)},e.prototype.S2CRepBossSyData=function(t){var e=net_protocol.S2CRepBossSyData.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CRepBossSyData",e)},e.prototype.S2CRepBossTqData=function(t){var e=net_protocol.S2CRepBossTqData.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CRepBossTqData",e)},e.prototype.S2CReqBossTqStatus=function(t){var e=net_protocol.S2CReqBossTqStatus.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CReqBossTqStatus",e)},e.prototype.S2CReqBossUpdateTired=function(t){var e=net_protocol.S2CReqBossUpdateTired.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CReqBossUpdateTired",e)},e.prototype.S2CReqBossDataUpdate=function(t){var e=net_protocol.S2CReqBossDataUpdate.decode(t.bytes);if(this.strength=e.strength,this.bossHurtAward=e.cross_hurt_award_list,this.cross_challenge_num=e.cross_challenge_num,this.shenwen_challenge_num=e.cross_shenwen_challenge_num,this.scene_time_list=e.scene_time_list,CommonUtils.log(" ^^***^^  S2CReqBossDataUpdate",e),this.challenge_list)for(var i=0;i<this.challenge_list.length;++i)for(var n=0,o=e.challenge_list;n<o.length;n++){var s=o[n];this.challenge_list[i].boss_type==s.boss_type&&(this.challenge_list[i]=s)}this.pig_list=e.pig_list,EventProxy.Broast(EventType.S2CReqBossDataUpdate,{}),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.S2CReqBossPartReward=function(t){var e=net_protocol.S2CReqBossPartReward.decode(t.bytes);CommonUtils.log(" ^^*------------------<<<<<>>>>>>-------------->**^^  S2CReqBossPartReward",e,this.monster_id);var i=new Array,n=new Array;if(e.items&&0!=e.items.length){for(var o=0;o<e.items.length;o++){var s=new ItemExData,r=new ItemCellData;r=UtilProxy.GetItemCellData(e.items[o].item_id,e.items[o].item_num),s.itemData=r,n.push(r),i.push(s)}var a=GlobalConfig.getBossConfig(this.monster_id);if(void 0!=a)if(a.type!=BOSSTYPE.YAMA&&a.type!=BOSSTYPE.BEAST&&a.type!=BOSSTYPE.GHOST&&a.type!=BOSSTYPE.XMJ)ViewManager.ins().open(FbendView,i,!0,EndType.BOSS_TYPE,a.type),EventProxy.Broast(EventType.S2CReqBossPartReward,{});else{for(var o=0;o<i.length;++o){for(var h=!1,l=0;l<this.bossPartReward.length;++l)this.bossPartReward[l].itemData.item_type_id==i[o].itemData.item_type_id&&(h=!0,this.bossPartReward[l].itemData.item_count=this.bossPartReward[l].itemData.item_count+i[o].itemData.item_count);h||this.bossPartReward.push(i[o])}a.type!=BOSSTYPE.YAMA&&TipsControl.ins().showReward(n)}}},e.prototype.C2SReqBossGetBoxAward=function(t){var e=new net_protocol.C2SReqBossGetBoxAward;e.boss_id=t,this.sendPbPack(Msg.C2SReqBossGetBoxAward,e,net_protocol.C2SReqBossGetBoxAward)},e.prototype.S2CReqBossTouchBox=function(t){var e=net_protocol.S2CReqBossTouchBox.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CReqBossTouchBox",e),this.get_box_boss_id||(this.get_box_boss_id=[]),this.get_box_boss_id.push(e.boss_id),this.DoBossBox(),EventProxy.Broast(EventType.S2CReqBossTouchBox,[])},e.prototype.S2CReqBossGetBoxAward=function(t){var e=net_protocol.S2CReqBossGetBoxAward.decode(t.bytes);CommonUtils.log(" ^^***^^  S2CReqBossGetBoxAward ---->",e);for(var i=new Array,n=0;n<e.items.length;n++){var o=new ItemCellData;o=UtilProxy.GetItemCellData(e.items[n].item_id,e.items[n].item_num),i.push(o)}TipsControl.ins().showReward(i),EventProxy.Broast(EventType.S2CReqBossGetBoxAward,[])},e.prototype.DoBossBox=function(){this.get_box_boss_id&&0!=this.get_box_boss_id.length&&(ViewManager.ins().isShow(BGBossBoxView)||(ViewManager.ins().open(BGBossBoxView,this.get_box_boss_id[0]),this.get_box_boss_id.splice(0,1)))},e.prototype.C2SSetAttackTarget=function(t){var e=new net_protocol.C2SSetAttackTarget;e.obj_id=t,this.sendPbPack(Msg.C2SSetAttackTarget,e,net_protocol.C2SSetAttackTarget)},e.prototype.S2CBossHurtRank=function(t){var e=net_protocol.S2CBossHurtRank.decode(t.bytes);UtilProxy.log(" ^^***^^  S2CBossHurtRank",e),this.my_rank=e.my_rank,this.my_hurt=e.my_hurt,this.boss_obj_id=e.boss_obj_id,this.hurt_list=e.hurt_list;var i=GameLogic.ins().getEntityByHandle(this.boss_obj_id);if(i instanceof EntityMonster){var n=i.getConfig();this.monster_id=n.id}this.hurt_list.sort(this.sorthurt),EventProxy.Broast(EventType.S2CBossHurtRank,[])},e.prototype.sorthurt=function(t,e){return t.hurt>e.hurt?-1:1},e.prototype.getHurtRoledataById=function(t){if(void 0!=this.hurt_list&&0!=this.hurt_list.length)for(var e=0;e<this.hurt_list.length;++e)if(this.hurt_list[e].obj_id==t)return this.hurt_list[e]},e.prototype.S2COnLeaveBoss=function(t){var e=net_protocol.S2COnLeaveBoss.decode(t.bytes);CommonUtils.log(" ^^***^^  S2COnLeaveBoss",e),2==e.status,EventProxy.Broast(EventType.S2COnLeaveBoss,[2==e.status])},e.prototype.ClearBossData=function(){this.my_rank=0,this.my_hurt=0,this.boss_obj_id=-1,this.monster_id=-1,this.hurt_list=null,this.boss_name="",this.obj_id=-1,this.drop_ower_obj_id=-1,this.drop_ower_name="",this.bossPartReward=[],this.clearAtkList()},e.prototype.S2CRepMonsterDropOwerChange=function(t){var e=net_protocol.S2CRepMonsterDropOwerChange.decode(t.bytes);CommonUtils.log("--S2CRepMonsterDropOwerChange-------------S2CRepMonsterDropOwerChange-------S2CRepMonsterDropOwerChange----",e),this.boss_obj_id=e.obj_id;var i=GameLogic.ins().getEntityByHandle(this.boss_obj_id);void 0!=i&&i instanceof EntityMonster&&(this.monster_id=i.getConfig().id),this.drop_ower_obj_id=e.drop_ower_obj_id,this.drop_ower_name=e.drop_ower_name,EventProxy.Broast(EventType.S2CRepMonsterDropOwerChange,[])},e.prototype.getOwnerName=function(){return this.drop_ower_name},e.prototype.getOwnerIconName=function(){if(e.ins().drop_ower_obj_id==GameMap.centerEntity.handle)return this.getRoleIconName(RoleProxy.ins().getProf());var t=GameLogic.ins().getEntityByHandle(this.drop_ower_obj_id);return void 0!=t&&t instanceof EntityRole?this.getRoleIconName(t.getJob()):""},e.prototype.getRoleIconName=function(t){return 1==t?"common_touxiang_01":"common_touxiang_02"},e.prototype.setBossObjId=function(t,e,i,n,o,s,r){this.isBossId(t)&&(this.boss_obj_id=e,this.obj_id=s,this.monster_id=t,this.boss_name=i,this.drop_ower_obj_id=n,this.drop_ower_name=o,this.boss_left_time=0==r?r:r+GameLogic.ins().getServerTime(),EventProxy.Broast(EventType.S2CRepMonsterDropOwerChange,[!0]))},e.prototype.isBossId=function(t){var e=GlobalConfig.getMonsterConfigById(t);return void 0!=e&&2==e.type?!0:!1},e.prototype.getMonsterName=function(t){var e=GlobalConfig.getMonsterConfigById(t);return e?e.name:""},e.prototype.isBossDead=function(t){return t==this.boss_obj_id?!0:void 0},e.prototype.setMyHurt=function(t,e,i){void 0!=t&&void 0!=e&&void 0!=GameMap.centerEntity&&t==this.boss_obj_id&&e==GameMap.centerEntity.handle&&(this.my_hurt+=i,EventProxy.Broast(EventType.BossMyHurt,[]))},e.prototype.BossDead=function(t){t!=this.boss_obj_id||GameLogic.ins().getCurSceneId()||ViewManager.ins().open(FbendView,[],!0,EndType.BOSS_YW)},e.prototype.SimpleBossNextFreeTime=function(t){var e=CopyProxy.ins().GetCopyDataByCopyId(t);return e?e.next_free_time-GameLogic.ins().getServerTime()<=0?0:Math.floor(e.next_free_time-GameLogic.ins().getServerTime()):0},e.prototype.GetBossNextFreeTime=function(t,e){if(void 0==this.boss_net_map[e])return 0;var i=this.boss_net_map[e];for(var n in i)if(i[n].boss_id==t)return Math.floor(i[n].next_time-GameLogic.ins().getServerTime());return 0},e.prototype.GetBossAppear=function(t,e){if(void 0!=this.boss_net_map[e]){var i=this.boss_net_map[e];for(var n in i)if(i[n].boss_id==t)return i[n]}},e.prototype.GetBossConfigByType=function(t){GlobalConfig.getConfig("boss","bossConfig");var e=new Array;for(var i in GlobalConfig.ins().bossConfig){var n=GlobalConfig.ins().bossConfig[i];n.type==t&&e.push(n)}return e},e.prototype.GetSingleBossSortConfig=function(t){function e(t,e){var i=GlobalConfig.getCopyConfigById(t.copy_id),n=GlobalConfig.getCopyConfigById(e.copy_id);if(i.open_level>n.open_level)return 1;if(i.open_level<n.open_level)return-1;if(i.open_level==n.open_level){if(i.open_zhuan>n.open_zhuan)return 1;if(i.open_zhuan<n.open_zhuan)return-1;if(i.open_zhuan==n.open_zhuan){if(i.vip_level>n.vip_level)return 1;if(i.vip_level<n.vip_level)return-1;if(i.vip_level<n.vip_level)return 0}}}GlobalConfig.getConfig("boss","bossConfig");var i=new Array;for(var n in GlobalConfig.ins().bossConfig){var o=GlobalConfig.ins().bossConfig[n];o.type==t&&i.push(o)}return i.sort(e),i},e.prototype.GetBossConfigByTypeAndFloor=function(t,e){GlobalConfig.getConfig("boss","bossConfig");var i=new Array;for(var n in GlobalConfig.ins().bossConfig){var o=GlobalConfig.ins().bossConfig[n];o.type==t&&e==o.boss_floor&&i.push(o)}return i},e.prototype.GetBossConfigBySceneId=function(t){GlobalConfig.getConfig("boss","bossConfig");var e=new Array;for(var i in GlobalConfig.ins().bossConfig){var n=GlobalConfig.ins().bossConfig[i];n.scene==t&&e.push(n)}return e},e.prototype.getInitBossByType=function(t){for(var i,n=this.GetBossConfigByType(t),o=0;o<n.length;++o)if(e.ins().IsConditionEnough(n[o].scene).isTrue)if(t!=BOSSTYPE.KUAFU&&t!=BOSSTYPE.SHENWEN){var s=e.ins().GetBossNextFreeTime(n[o].id,n[o].type);0>=s&&(i=n[o])}else i=n[o];return i||n[0]},e.prototype.getInitBossByTypeAndFloor=function(t,i){for(var n,o=this.GetBossConfigByTypeAndFloor(t,i),s=0;s<o.length;++s)if(e.ins().IsConditionEnough(o[s].scene).isTrue)if(t!=BOSSTYPE.KUAFU&&t!=BOSSTYPE.SHENWEN){var r=e.ins().GetBossNextFreeTime(o[s].id,o[s].type);0>=r&&(n=o[s])}else n=o[s];return n||o[0]},e.prototype.IsConditionEnough=function(t){var e=GlobalConfig.getSceneConditionConfig(t);if(void 0==e)return CommonUtils.log("-----not find -getSceneConditionConfig-------",t),{isTrue:!1,str:""};for(var i=!0,n="",o=0;o<e.enter_cond.length;++o){var s=RoleProxy.ins().getMoneyAttr(e.enter_cond[o][0]);s>=e.enter_cond[o][1]&&s<=e.enter_cond[o][2]||(i=!1,n=UtilProxy.ins().getMoneyAttrName(e.enter_cond[o][0]),n+=s<e.enter_cond[o][1]?"不足":"超过上限")}return{isTrue:i,str:n}},e.prototype.enterBossScene=function(t){var e=GlobalConfig.getSceneConfigById(t);if(e){var i=GlobalConfig.getSceneConditionConfig(t);if(i)if(0==i.vip_level)SceneControl.ins().C2STransferScene(e.id,e.x,e.y);else if(i.vip_level<=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))SceneControl.ins().C2STransferScene(e.id,e.x,e.y);else if(i.item_cond.length>0)if(BagProxy.ins().getItemCountById(i.item_cond[0])>=i.item_cond[1])SceneControl.ins().C2STransferScene(e.id,e.x,e.y);else if(i.replace_item_cond.length>0){var n=!1,o="";if(RoleProxy.ins().getMoneyAttr(i.replace_item_cond[0])>=i.replace_item_cond[1])n=!0,o=""==o?UtilProxy.ins().getMoneyAttrName(i.replace_item_cond[0])+" "+i.replace_item_cond[1]:o+" "+UtilProxy.ins().getMoneyAttrName(i.replace_item_cond[0])+" "+i.replace_item_cond[1];else{var s=UtilProxy.ins().getMoneyAttrName(i.replace_item_cond[0]);TipsControl.ins().showTips(s+"不足")}n&&TipsControl.ins().ShowTips1("是否花费"+o+" 进入?",function(){},function(){SceneControl.ins().C2STransferScene(e.id,e.x,e.y)})}else{var r=GlobalConfig.getItemsConfig(i.item_cond[0]),a=r?r.name:"";TipsControl.ins().showTips(a+"不足")}else TipsControl.ins().showTips("VIP不足!")}},e.prototype.getConditionDataById=function(t){var e=GlobalConfig.getSceneConditionConfig(t);if(void 0!=e){for(var i={},n=0;n<e.enter_cond.length;++n)i[e.enter_cond[n][0]]={limit:e.enter_cond[n][1],max:e.enter_cond[n][2],flag:1==e.enter_cond[n][3]};var o=e.vip_level,s=e.item_cond,r=e.replace_item_cond;return{enter_cond:i,vip_level:o,item_cond:s,replace_item_cond:r,enter_conf:e.enter_cond}}return{}},e.prototype.isBossCrossScene=function(t){var e=GlobalConfig.getboss_cross_scene_dataConfig(t);return void 0!=e},e.prototype.getBossTypeById=function(t){GlobalConfig.getConfig("boss","bossConfig");for(var e in GlobalConfig.ins().bossConfig)if(GlobalConfig.ins().bossConfig[e].scene==t)return GlobalConfig.ins().bossConfig[e].type;return-1},e.prototype.C2SReqBossOwnerLoot=function(t,e){var i=new net_protocol.C2SReqBossOwnerLoot;i.role_id=t,i.monster_obj_id=e,CommonUtils.log("^^^--(<_>)---^^^^C2SReqBossOwnerLoot",i),this.sendPbPack(Msg.C2SReqBossOwnerLoot,i,net_protocol.C2SReqBossOwnerLoot)},e.prototype.C2SReqBossHurtAward=function(t,e,i){var n=new net_protocol.C2SReqBossHurtAward;n.index=t,n.boss_obj_id=e,n.boss_id=i,CommonUtils.log("^^^--(<_>)---^^^^C2SReqBossHurtAward",n),this.sendPbPack(Msg.C2SReqBossHurtAward,n,net_protocol.C2SReqBossHurtAward)},e.prototype.C2SReqBossBuyChallengeNum=function(){var t=new net_protocol.C2SReqBossBuyChallengeNum;CommonUtils.log("^^^--(<_>)---^^^^C2SReqBossBuyChallengeNum",t),this.sendPbPack(Msg.C2SReqBossBuyChallengeNum,t,net_protocol.C2SReqBossBuyChallengeNum)},e.prototype.C2SReqBossShenwenBuyChallengeNum=function(){var t=new net_protocol.C2SReqBossShenwenBuyChallengeNum;CommonUtils.log("^^^--(<_>)---^^^^C2SReqBossShenwenBuyChallengeNum",t),this.sendPbPack(Msg.C2SReqBossShenwenBuyChallengeNum,t,net_protocol.C2SReqBossShenwenBuyChallengeNum)},e.prototype.C2SReqBossYlsdRandom=function(){var t=new net_protocol.C2SReqBossYlsdRandom;t.id=this.ylsd_big_id||0,CommonUtils.log("^^^--(<_>)---^^^^C2SReqBossYlsdRandom",t),this.sendPbPack(Msg.C2SReqBossYlsdRandom,t,net_protocol.C2SReqBossYlsdRandom)},e.prototype.S2CReqBossHurtAward=function(t){var e=net_protocol.S2CReqBossHurtAward.decode(t.bytes);this.bossHurtAward.push(e.index),CommonUtils.log("^^^--(<_>)---^^^^S2CReqBossHurtAward",e),EventProxy.Broast(EventType.S2CReqBossHurtAward,[e.index])},e.prototype.S2CReqBossBuyChallengeNum=function(t){var e=net_protocol.S2CReqBossBuyChallengeNum.decode(t.bytes);CommonUtils.log("^^^--(<_>)---^^^^S2CReqBossBuyChallengeNum",e),this.buy_challenge_times=this.buy_challenge_times+1,TipsControl.ins().showTips("购买成功！"),EventProxy.Broast(EventType.S2CReqBossBuyChallengeNum,[]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.S2CReqBossShenwenBuyChallengeNum=function(t){var e=net_protocol.S2CReqBossShenwenBuyChallengeNum.decode(t.bytes);CommonUtils.log("^^^--(<_>)---^^^^S2CReqBossShenwenBuyChallengeNum",e),this.buy_shenwen_times=this.buy_shenwen_times+1,TipsControl.ins().showTips("购买成功！"),EventProxy.Broast(EventType.S2CReqBossShenwenBuyChallengeNum,[]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.S2CReqBossYlsdTeamBigAward=function(t){var e=net_protocol.S2CReqBossYlsdTeamBigAward.decode(t.bytes);CommonUtils.log("^^^--(<_---------///////////////-\\\\\\\\----------_>)---^^^^S2CReqBossYlsdTeamBigAward",e),this.yama_Random_list=[],this.ylsd_big_id=e.id,ViewManager.ins().isShow(SystemOpenView)&&ViewManager.ins().close(BossYamaRol),ViewManager.ins().open(BossYamaRol),EventProxy.Broast(EventType.S2CReqBossYlsdTeamBigAward,[])},e.prototype.S2CReqBossYlsdRandom=function(t){var e=net_protocol.S2CReqBossYlsdRandom.decode(t.bytes);CommonUtils.log("^^^--(<_---------///////////////-\\\\\\\\----------_>)---^^^^S2CReqBossYlsdRandom",e),this.yama_Random_list=e.list,this.yama_Random_list.sort(this.sortNum),EventProxy.Broast(EventType.S2CReqBossYlsdRandom,[])},e.prototype.sortNum=function(t,e){return t.num>e.num?-1:1},e.prototype.S2CReqBossBuyTimes=function(t){var e=net_protocol.S2CReqBossBuyTimes.decode(t.bytes);if(CommonUtils.log("^^^--(<_---------///////////////-\\\\\\\\----------_>)---^^^^S2CReqBossBuyTimes",e),this.challenge_list)for(var i=0;i<this.challenge_list.length;++i)this.challenge_list[i].boss_type==e.boss_type&&(this.challenge_list[i].buy_times=this.challenge_list[i].buy_times+e.num,this.challenge_list[i].left_times=this.challenge_list[i].left_times+e.num);EventProxy.Broast(EventType.S2CReqBossBuyTimes,[]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.isBossHurtReward=function(t){for(var e=0;e<this.bossHurtAward.length;++e)if(t==this.bossHurtAward[e])return!0;return!1},e.prototype.getRedByType=function(t){var i=0,n=t-1,o=0,s=0;if(0==n?(o=1,s=M_View_Type.Boss):(o=2,s=100*M_View_Type.Boss+n),!SystemOpenProxy.ins().isOpen(o,s,!0))return!1;if(GlobalConfig.getConfig("boss","bossConfig"),t==BOSSTYPE.YAMA)return ActivityProxy.ins().isActivityOpenById(ActivityType.Yama);if(t==BOSSTYPE.KUAFU&&!ActivityProxy.ins().isActivityOpenById(ActivityType.KuaFuBoss))return!1;if(t==BOSSTYPE.SHENWEN&&!ActivityProxy.ins().isActivityOpenById(ActivityType.ShenwenBoss))return!1;for(var r in GlobalConfig.ins().bossConfig){var a=GlobalConfig.ins().bossConfig[r];if(a.type==t)if(1==t){var h=CopyProxy.ins().getCopyLeftTimeById(a.copy_id),l=GlobalConfig.getCopyConfigById(a.copy_id),p=(GlobalConfig.getSceneConfigById(a.scene),RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)),c=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),u=l.open_zhuan,d=l.open_level;h>0&&p>=u&&c>=d&&a.strength<=this.strength&&e.ins().SimpleBossNextFreeTime(a.copy_id)<=0&&i++}else{var g=a.scene;if(void 0!=a){var y=e.ins().GetBossNextFreeTime(a.id,a.type);0>=y&&e.ins().IsConditionEnough(g).isTrue&&i++}}}return i>0},e.prototype.getRed=function(){return this.getRedByType(BOSSTYPE.SINGLE)||this.getRedByType(BOSSTYPE.WORLD)||this.getRedByType(BOSSTYPE.MIJING)||this.getRedByType(BOSSTYPE.SHENYUAN)||this.getRedByType(BOSSTYPE.YAMA)||this.getRedByType(BOSSTYPE.KUAFU)||this.getRedByType(BOSSTYPE.SHENWEN)},e.prototype.getEnterCondStr=function(t){for(var e="",i=0;i<t.length;++i)if(1==t[i][0])e=t[i][1]+"-"+t[i][2]+"级";else if(5==t[i][0]){var n=GlobalConfig.getZhuanById(t[i][1]),o=GlobalConfig.getZhuanById(t[i][2]);n&&o&&(e=n.zhuan+"-"+o.zhuan+"转")}return e},e.prototype.getBossPosById=function(t,e){if(e==BOSSTYPE.YAMA){var i=this.getYamaSceneId(),n=GlobalConfig.getScene_monster_serverConfig(i);for(var o in n)if(n[o].monster_id==t)return{x:n[o].monster_x,y:n[o].monster_y}}},e.prototype.getYamaLingId=function(){var t=GlobalConfig.getBoss_miscConfigById(1);return t.ylsd_token_id},e.prototype.getYamaSceneId=function(){var t=GlobalConfig.getBoss_miscConfigById(1);return t.ylsd_scene_id},e.prototype.isBagLeftEnough=function(){return BagProxy.ins().GetBagLeftCount(BagType.EQUIP)<20?(TipsControl.ins().ShowTips1("背包已满，是否一键熔炼?",function(){CopyProxy.ins().is_smelt_lyh=!1
},function(){BagProxy.ins().OneKeySmelt()}),!1):!0},e.prototype.isSimpleEnoughVIP=function(){for(var t=e.ins().GetBossConfigByType(1),i=0;i<t.length;++i){var n=t[i].copy_id,o=GlobalConfig.getCopyConfigById(n);if(o){var s=o.sweep_vip_level;return s<=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)}}return!1},e.prototype.getSimpleSweepVIP=function(){for(var t=e.ins().GetBossConfigByType(1),i=0;i<t.length;++i){var n=t[i].copy_id,o=GlobalConfig.getCopyConfigById(n);if(o)return o.sweep_vip_level}return 0},e.prototype.isWordBossScene=function(t){for(var i=e.ins().GetBossConfigByType(BOSSTYPE.WORLD),n=0;n<i.length;++n)if(i[n].scene==t)return!0;return!1},e.prototype.getCurrentKuaFuBoss=function(){for(var t=this.GetBossConfigByType(BOSSTYPE.KUAFU),e=0;e<t.length;++e)if(this.IsConditionEnough(t[e].scene))return t[e]},e.prototype.getCurrentShenwenBoss=function(){for(var t=this.GetBossConfigByType(BOSSTYPE.SHENWEN),e=0;e<t.length;++e)if(this.IsConditionEnough(t[e].scene))return t[e]},e.prototype.upDateTime=function(){if(void 0!=this.boss_net_map[BOSSTYPE.WORLD])for(var t in this.boss_net_map){var e=Number(t);if(e==BOSSTYPE.WORLD||e==BOSSTYPE.SHENYUAN||e==BOSSTYPE.MIJING||e==BOSSTYPE.EXOTIC){var i=this.boss_net_map[t];for(var n in i)0!=i[n].next_time&&0==Math.floor(i[n].next_time-GameLogic.ins().getServerTime())&&this.isBossShowTips(i[n].boss_id)&&this.isBossReviveTips(i[n].type,i[n].boss_id)&&EventProxy.Broast(EventType.UpdateBossRevive,[i[n].boss_id])}}},e.prototype.upDateChallengeTime=function(){if(void 0!=e.ins().boss_net_map&&void 0!=e.ins().boss_net_map[BOSSTYPE.WORLD])for(var t in e.ins().boss_net_map){var i=Number(t);if(i==BOSSTYPE.WORLD||i==BOSSTYPE.SHENYUAN||i==BOSSTYPE.MIJING||i==BOSSTYPE.EXOTIC){var n=e.ins().boss_net_map[t];for(var o in n)if(0==n[o].next_time||0!=n[o].next_time&&Math.floor(n[o].next_time-GameLogic.ins().getServerTime())<=0){var s=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());if(e.ins().isAutoChallengeBoss(i,n[o].boss_id)&&!ViewManager.ins().isOpenNotConst()&&!ViewManager.ins().isShow(BossUIView)&&1==s.scene_type&&0==s.is_main){var r=GlobalConfig.getBossConfig(n[o].boss_id);if(i!=BOSSTYPE.WORLD||i==BOSSTYPE.WORLD&&r.strength<=e.ins().strength){e.ins().enterBossScene(r.scene);break}}}}}},e.prototype.isBossShowTips=function(t){var e=GlobalConfig.getBossConfig(t);if(e){var i=this.IsConditionEnough(e.scene);return i.isTrue}return!1},e.prototype.getChangeDataByType=function(t){if(this.challenge_list)for(var e=0;e<this.challenge_list.length;++e)if(this.challenge_list[e].boss_type==t)return this.challenge_list[e]},e.prototype.initReviveList=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);if(0!=t){var i=GlobalConfig.getBossConfigs(),n=[];for(var o in i){var s=i[o];(s.type==BOSSTYPE.EXOTIC||s.type==BOSSTYPE.WORLD||s.type==BOSSTYPE.SHENYUAN||s.type==BOSSTYPE.MIJING)&&(n[s.type]||(n[s.type]=[]),n[s.type].push(s))}for(var o in n){for(var r=n[o],a=0,h=[],l=0;l<r.length;++l){var s=r[l],p=e.ins().getConditionDataById(s.scene);if(p){var c=p.enter_cond,u=0,d=0;for(var g in c)Number(g)==MoneyAttr.ZHUAN&&(u=c[g].limit,d=c[g].max);t>=u&&d>=t&&u>=a&&(u>a&&(h=[],a=u),h.push([s.type,s.id]))}}for(var l=0;l<h.length;++l)this.addBossReviveTips(h[l][0],h[l][1])}}},e.prototype.addAutoChallenge=function(t,e){this.auto_challenge_list||(this.auto_challenge_list=[]),this.auto_challenge_list[t]||(this.auto_challenge_list[t]=[]),this.isAutoChallengeLimit(t)||this.auto_challenge_list[t].push(e)},e.prototype.removeAutoChallenge=function(t,e){if(this.auto_challenge_list&&this.auto_challenge_list[t])for(var i=this.auto_challenge_list[t],n=i.length,o=n-1;o>=0;o--)i[o]==e&&(i.splice(o,1),this.auto_challenge_list[t]=i)},e.prototype.isAutoChallengeLimit=function(t){if(!this.auto_challenge_list||!this.auto_challenge_list[t])return!1;var e=this.auto_challenge_list[t],i=e.length,n=GlobalConfig.getBoss_times_dataConfigById(t),o=n?n.limit:2;return i>=o},e.prototype.isChallengeLimit=function(t){if(!this.challenge_list||!this.challenge_list[t])return!1;var e=this.challenge_list[t],i=e.length,n=GlobalConfig.getBoss_times_dataConfigById(t),o=n?n.limit:2;return i>=o},e.prototype.isAutoChallengeBoss=function(t,e){if(!this.auto_challenge_list||!this.auto_challenge_list[t])return!1;for(var i=this.auto_challenge_list[t],n=0;n<i.length;++n)if(i[n]==e)return!0;return!1},e.prototype.addBossReviveTips=function(t,e){this.revive_boss_list||(this.revive_boss_list=[]),this.revive_boss_list[t]||(this.revive_boss_list[t]=[]),this.revive_boss_list[t].length<2&&this.revive_boss_list[t].push(e)},e.prototype.removeBossReviveTips=function(t,e){if(this.revive_boss_list&&this.revive_boss_list[t])for(var i=this.revive_boss_list[t],n=i.length,o=n-1;o>=0;o--)i[o]==e&&(i.splice(o,1),this.revive_boss_list[t]=i)},e.prototype.isBossReviveTipsLimit=function(t){if(!this.revive_boss_list||!this.revive_boss_list[t])return!1;var e=this.revive_boss_list[t],i=e.length,n=2;return i>=n},e.prototype.isBossReviveTips=function(t,e){if(!this.revive_boss_list||!this.revive_boss_list[t])return!1;for(var i=this.revive_boss_list[t],n=0;n<i.length;++n)if(i[n]==e)return!0;return!1},e.prototype.isBossHurtRed=function(){var t=e.ins().monster_id,i=GlobalConfig.getBossConfig(t);if(void 0==i)return!1;for(var n=0;n<i.hurt_award_drop.length;++n)if(i.hurt_award_drop[n][0]){var o=e.ins().isBossHurtReward(n+1),s=i.hurt_award_drop[n][0];if(!o&&s<=e.ins().my_hurt)return!0}return!1},e.prototype.isBossLimitCanKill=function(){if(!SystemOpenProxy.ins().isOpen(1,60,!0))return!1;if(0==CopyProxy.ins().getBossLimitLeftTime())return!1;var t=GlobalConfig.getLimit_bossConfigs(),e=this.getBossLimitCurrentFloor();for(var i in t){var n=t[i];if(n.id>e){var o=GlobalConfig.getCopyConfigById(n.id);return o.open_zhuan<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)}}return!1},e.prototype.getBossLimitCurrentFloor=function(){var t=CopyProxy.ins().GetCopyDataByCopyId(CopyProxy.ins().limit_boss_enter_id),e=0;return t&&t.climb_info&&t.climb_info.last_floor>0&&(e=t.climb_info.last_floor),e},e.prototype.getStrenthItemId=function(){var t=GlobalConfig.getBoss_miscConfigById(1);return t?t.tiliyaoshui_ID:0},e.prototype.getBossBGSceneItems=function(){var t=GlobalConfig.getBoss_miscConfigById(1);return t?t.pig_item_list:[]},e.prototype.isBossBGSceneItem=function(t){for(var e=this.getBossBGSceneItems(),i=0;i<e.length;++i)if(t==e[i])return!0;return!1},e.prototype.getPigNumById=function(t){if(this.pig_list)for(var e=0;e<this.pig_list.length;++e)if(this.pig_list[e].item_id==t)return this.pig_list[e].num;return 0},e.prototype.AddPigNumberById=function(t,e){this.pig_list||(this.pig_list=[]);for(var i=!1,n=0;n<this.pig_list.length;++n)this.pig_list[n].item_id==t&&(this.pig_list[n].num=this.pig_list[n].num+e,i=!0);i||this.pig_list.push({item_id:t,num:e}),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.getTargetEntity=function(){if(GameMap.centerEntity.AI instanceof AIMainRole||GameMap.centerEntity.AI instanceof AIRoleKuaFu){var t=GameMap.centerEntity.AI.getTargetHandle();return t?GameLogic.ins().getEntityByHandle(t):null}return null},e.prototype.setAtkData=function(t,e){if(void 0!=t&&void 0!=e&&void 0!=GameMap.centerEntity&&t==GameMap.centerEntity.handle&&e!=this.boss_id){var i=GameLogic.ins().getEntityByHandle(e);i&&i instanceof EntityRole&&!this.isAtkRole(i.role_id,i.server_id)&&this.addAtklist(i.role_id,i.server_id)}},e.prototype.addAtklist=function(t,e){if(t&&e){var i=!0;this.atk_list?i=!this.isAtkRole(t,e):this.atk_list=[],i&&this.atk_list.push({r_id:t,s_id:e})}},e.prototype.isAtkRole=function(t,e){if(!this.atk_list||0==this.atk_list.length)return!1;for(var i=0;i<this.atk_list.length;++i)if(this.atk_list[i].r_id==t&&this.atk_list[i].s_id==e)return!0;return!1},e.prototype.clearAtkList=function(){this.atk_list=[]},e.prototype.getRatioLevelName=function(t){var e=[4,4,10,7,7],i=["无","低","中","高","极高"];return i[t-1]?"|C:"+e[t-1]+"&"+i[t-1]:"|C:"+e[0]+"&"+i[0]},e.prototype.GetBossRatioTime=function(t){for(var e=0;e<this.scene_time_list.length;++e)if(this.scene_time_list[e].scene_type==t)return this.scene_time_list[e].time;return 0},e.prototype.isCanAtkScene=function(){var t=GlobalConfig.getBossConfigs(),e=GameLogic.ins().getCurSceneId();for(var i in t){var n=t[i];if(n.scene==e)return n.type==BOSSTYPE.GHOST||n.type==BOSSTYPE.XMJ}return!1},e.prototype.getBGIslandPefectFloor=function(t){var e=GlobalConfig.getBossConfigs(),i=0;for(var n in e){var o=e[n];if(o.type==t){var s=this.IsConditionEnough(o.scene);s.isTrue&&o.boss_floor>i&&(i=o.boss_floor)}}return Math.max(i,1)},e}(BaseSystem);__reflect(BossProxy.prototype,"BossProxy");var ChatData=function(){function t(){}return t}();__reflect(ChatData.prototype,"ChatData");var BlackData=function(){function t(){}return t}();__reflect(BlackData.prototype,"BlackData");var ChatProxy=function(t){function e(){var e=t.call(this)||this;return e.ChatAllList=[],e.chat_times=0,e.isPingbi=!1,e._typeImg=1,e.last_chat_time=[-1,-1],e.current_channel=1,e.$chatLimitLv=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.selectedShield=function(){var t=new Array;if(this.ChatCrossDataList&&this.ChatCrossDataList.length>0)for(var e=0;e<this.ChatCrossDataList.length;++e)(this.ChatCrossDataList[e].level>=200||RoleProxy.ins().getRoleId()==this.ChatCrossDataList[e].from_uid)&&t.push(this.ChatCrossDataList[e]);return t},e.prototype.getLastModel=function(){return this.ChatAllList&&this.ChatAllList.length>0?this.ChatAllList[this.ChatAllList.length-1]:void 0},e.prototype.getChatSysList=function(){return this.ChatSysList?this.ChatSysList.length>e.chatMsgMax?(this.ChatSysList.splice(0,this.ChatSysList.length-e.chatMsgMax),this.ChatSysList):this.ChatSysList:(this.ChatSysList=[],this.ChatSysList)},e.prototype.showChatDataList=function(t){var i=new Array;if(1==t){if(void 0!=this.ChatCrossDataList)for(var n=0;n<this.ChatCrossDataList.length;++n)this.GetBlackState(this.ChatCrossDataList[n].from_uid)||i.push(this.ChatCrossDataList[n])}else if(2==t){if(void 0!=this.ChatSimpleList)for(var n=0;n<this.ChatSimpleList.length;++n)this.GetBlackState(this.ChatSimpleList[n].from_uid)||i.push(this.ChatSimpleList[n])}else if(3==t&&void 0!=this.ChatCrossDataList)for(var n=0;n<this.ChatCrossDataList.length;++n)this.ChatCrossDataList[n].from_uid>0&&(this.GetBlackState(this.ChatCrossDataList[n].from_uid)||i.push(this.ChatCrossDataList[n]));return i.length>e.chatMsgMax&&i.splice(0,i.length-e.chatMsgMax),i},e.prototype.C2SChannelChat=function(t,e,i,n){void 0===i&&(i=""),void 0===n&&(n=0);var o=new net_protocol.C2SChannelChat;o.channel_id=t,o.msg_content=e,o.voice=i,o.voice_len=n,CommonUtils.log("---------C2SChannelChat----------",o),this.sendPbPack(Msg.C2SChannelChat,o,net_protocol.C2SChannelChat)},e.prototype.C2SSingleChat=function(t,e,i,n){var o=new net_protocol.C2SSingleChat;o.to_uid=t,o.msg_content=e,o.voice=i,o.voice_len=n,CommonUtils.log("---------C2SSingleChat----------",o),this.sendPbPack(Msg.C2SSingleChat,o,net_protocol.C2SSingleChat)},e.prototype.C2SChatGetVoice=function(t){var e=new net_protocol.C2SChatGetVoice;e.voice_id=t,this.sendPbPack(Msg.C2SChatGetVoice,e,net_protocol.C2SChatGetVoice)},e.prototype.CS2CChannelChat=function(t){var e=net_protocol.CS2CChannelChat.decode(t.bytes);CommonUtils.log("---------CS2CChannelChat----------",e);var i=new ChatData;i.from_uid=e.from_uid,i.vip_type=e.vip_type,i.prof=e.prof,i.sex=e.sex,i.level=e.level,i.zhuan=e.zhuan,i.channel_id=e.channel_id,i.username=e.username,i.msg_content=e.msg_content,i.voice=e.voice,i.rights_id=e.rights_id,i.voice_len=e.voice_len,0==e.channel_id?(void 0==this.ChatDataList&&(this.ChatDataList=new Array),this.ChatDataList.push(i)):1==e.channel_id&&(void 0==this.ChatSysList&&(this.ChatSysList=new Array),this.ChatSysList.push(i),void 0==this.ChatAllList&&(this.ChatAllList=new Array),this.ChatAllList.push(i)),EventProxy.Broast(EventType.CS2CChannelChat,[e.channel_id,i])},e.prototype.CS2CSingleChat=function(t){var e=net_protocol.CS2CSingleChat.decode(t.bytes),i=this.last_chat_time[1],n=egret.getTimer();if((n-i)/1e3<this.getChatCD())return void TipsControl.ins().showTips("CD时间未到！");this.last_chat_time[1]=n;var o=new ChatData;o.from_uid=e.from_uid,o.vip_type=e.vip_type,o.prof=e.prof,o.sex=e.sex,o.level=e.level,o.zhuan=e.zhuan,o.username=e.username,o.msg_content=e.msg_content,o.voice=e.voice,o.rights_id=e.rights_id,o.voice_len=e.voice_len,o.chat_id=e.chat_frame_id,o.head_id=e.head_id,o.headChat_id=e.head_frame_id,void 0==this.ChatSimpleList&&(this.ChatSimpleList=new Array),this.ChatSimpleList.push(o),CommonUtils.log("---------CS2CSingleChat----------",e),EventProxy.Broast(EventType.CS2CSingleChat,{})},e.prototype.CS2CChatGetVoice=function(t){var e=net_protocol.CS2CChatGetVoice.decode(t.bytes);CommonUtils.log("---------CS2CChatGetVoice----------",e)},e.prototype.C2SReqGlobalchatGetInfo=function(){var t=new net_protocol.C2SReqGlobalchatGetInfo;this.sendPbPack(Msg.C2SReqGlobalchatGetInfo,t,net_protocol.C2SReqGlobalchatGetInfo),CommonUtils.log("---------C2SReqGlobalchatGetInfo----------")},e.prototype.C2SReqGlobalchatSetBlacklist=function(t,e){var i=new net_protocol.C2SReqGlobalchatSetBlacklist;i.role_id=t,i.name=e,CommonUtils.log("---------C2SReqGlobalchatSetBlacklist----------"),this.sendPbPack(Msg.C2SReqGlobalchatSetBlacklist,i,net_protocol.C2SReqGlobalchatSetBlacklist)},e.prototype.C2SReqGlobalchatCancelBlacklist=function(t){var e=new net_protocol.C2SReqGlobalchatCancelBlacklist;e.role_id=t,CommonUtils.log("---------C2SReqGlobalchatCancelBlacklist----------"),this.sendPbPack(Msg.C2SReqGlobalchatCancelBlacklist,e,net_protocol.C2SReqGlobalchatCancelBlacklist)},e.prototype.C2SReqGlobalchatCross=function(t){var e=new net_protocol.C2SReqGlobalchatCross,i=this.last_chat_time[0],n=egret.getTimer();return(n-i)/1e3<this.getChatCD()?void TipsControl.ins().showTips("CD时间未到！"):(this.last_chat_time[0]=n,e.msg_content=t,CommonUtils.log("---------C2SReqGlobalchatCross----------"),this.sendPbPack(Msg.C2SReqGlobalchatCross,e,net_protocol.C2SReqGlobalchatCross),void this.showChatPicPanel())},e.prototype.showChatPicPanel=function(){var t=ViewManager.ins().getView(ChatUIView);t&&(t.BitPanel.visible=!1)},e.prototype.checkChatByLV=function(){return this.$chatLimitLv+"级可聊天"},e.prototype.checkChatPermission=function(){var t=this.current_channel,e=GlobalConfig.getLimitsConfig(1);return e&&e.chatlimit>0&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)<e.chatlimit&&2>t?(this.$chatLimitLv=e.chatlimit,!0):void 0},e.prototype.S2CRepGlobalchatGetInfo=function(t){var e=net_protocol.S2CRepGlobalchatGetInfo.decode(t.bytes);if(void 0==this.blackList&&(this.blackList=new Array),void 0!=e.list)for(var i=0;i<e.list.length;++i){var n=new BlackData;n.name=e.list[i].name,n.role_id=e.list[i].role_id,void 0==this.blackList&&(this.blackList=new Array),this.blackList.push(n)}this.chat_times=e.chat_times,CommonUtils.log("---------S2CRepGlobalchatGetInfo----------",e),EventProxy.Broast(EventType.S2CRepGlobalchatGetInfo,{})},e.prototype.S2CRepGlobalchatSetBlacklist=function(t){var e=net_protocol.S2CRepGlobalchatSetBlacklist.decode(t.bytes);CommonUtils.log("---------S2CRepGlobalchatSetBlacklist----------",e),void 0==this.blackList&&(this.blackList=new Array);var i=new BlackData;i.name=e.name,i.role_id=e.role_id;for(var n=!1,o=0;o<this.blackList.length;++o)this.blackList[o].role_id==e.role_id&&(CommonUtils.log("---------is blackList contain-----",e.role_id),n=!0);n||this.blackList.push(i),EventProxy.Broast(EventType.S2CRepGlobalchatSetBlacklist,{})},e.prototype.S2CRepGlobalchatCancelBlacklist=function(t){var e=net_protocol.S2CRepGlobalchatCancelBlacklist.decode(t.bytes);if(CommonUtils.log("---------S2CRepGlobalchatCancelBlacklist----------",e),void 0==this.blackList)this.blackList=new Array;else{var i=new BlackData;i.role_id=e.role_id;for(var n=0;n<this.blackList.length;++n)this.blackList[n].role_id==e.role_id&&this.blackList.splice(n,1)}EventProxy.Broast(EventType.S2CRepGlobalchatCancelBlacklist,{})},e.prototype.S2CRepGlobalchatCross=function(t){var e=net_protocol.S2CRepGlobalchatCross.decode(t.bytes);if(CommonUtils.log("---------S2CRepGlobalchatCross----------",e),""!=e.msg_content){var i=new ChatData;i.from_uid=e.from_uid,i.vip_type=e.vip_type,i.prof=e.prof,i.level=e.level,i.zhuan=e.zhuan,i.username=e.username,i.xianweiName=XiuXianProxy.ins().getXianweiNameById(e.xianwei),i.msg_content=e.msg_content,i.server_id=e.server_id,i.zongmen=e.zongmen,i.xiuxian=e.xiuxian,i.fighting=e.fighting,i.chat_id=e.rahmen,i.head_id=e.head_id,i.headChat_id=e.head_frame_id,i.title_id=e.reputation,i.rights_id=e.rights_id,i.is_bazhu=e.is_bazhu;var n=i.from_uid==RoleProxy.ins().getRoleId()&&i.username==RoleProxy.ins().getRoleName();n&&this.chat_times++,void 0==this.ChatCrossDataList&&(this.ChatCrossDataList=new Array),this.ChatCrossDataList.push(i),void 0==this.ChatAllList&&(this.ChatAllList=new Array),this.ChatAllList.push(i),EventProxy.Broast(EventType.S2CRepGlobalchatCross,[n])}},e.prototype.GetBlackState=function(t){if(void 0==this.blackList)return!1;for(var e=0;e<this.blackList.length;++e)if(this.blackList[e].role_id==t)return!0;return!1},e.prototype.getChatCD=function(){if(void 0==this._chat_cd){var t=GlobalConfig.getMisc_dataConfig(1);this._chat_cd=t.chat_cd}return this._chat_cd},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(21001,this.CS2CChannelChat,this),MsgHandle.ins().regNetMsg(21002,this.CS2CSingleChat,this),MsgHandle.ins().regNetMsg(21003,this.CS2CChatGetVoice,this),MsgHandle.ins().regNetMsg(25950,this.S2CRepGlobalchatGetInfo,this),MsgHandle.ins().regNetMsg(25951,this.S2CRepGlobalchatSetBlacklist,this),MsgHandle.ins().regNetMsg(25952,this.S2CRepGlobalchatCancelBlacklist,this),MsgHandle.ins().regNetMsg(25953,this.S2CRepGlobalchatCross,this)},e.prototype.C2CChannelChatEx=function(t){var e=new ChatData;e.from_uid=0,e.vip_type=0,e.prof=0,e.level=0,e.zhuan=0,e.username="",e.msg_content=t.msg_content,e.server_id=0,e.zongmen=0,e.rahmen=0,e.xiuxian=0,e.fighting=0,e.channel_id=t.channel_id,e.itemId=t.itemId,e.code_id=t.codeId,1==t.channel_id&&(void 0==this.ChatSysList&&(this.ChatSysList=new Array),this.ChatSysList.push(e),void 0==this.ChatAllList&&(this.ChatAllList=new Array),this.ChatAllList.push(e));var i=function(){EventProxy.Broast(EventType.CS2CChannelChat,[1])};TimerManager.ins().remove(i,this),!this.last_send_time||this.last_send_time-egret.getTimer()>2e3?(EventProxy.Broast(EventType.CS2CChannelChat,[1]),this.last_send_time=egret.getTimer()):TimerManager.ins().doTimer(1e3,1,i,this)},e.prototype.S2CRepGlobalchatCrossEx=function(t){var e=new ChatData;e.from_uid=RoleProxy.ins().getRoleId(),e.vip_type=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e.prof=RoleProxy.ins().getProf(),e.level=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),e.zhuan=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),e.username=RoleProxy.ins().getRoleName(),e.xianweiName=XiuXianProxy.ins().getXianweiName(),e.msg_content=t.msg_content,e.server_id=RoleProxy.ins().getRoleServerId(),e.zongmen=FacProxy.ins().getFacId(),e.xiuxian=XiuXianProxy.ins().achie_level,e.fighting=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING),e.chat_id=SetProxy.ins().useChatFrame(),e.head_id=SetProxy.ins().useHead(),e.headChat_id=SetProxy.ins().useHeadFrame(),e.title_id=TitleProxy.ins().GetCurrentLevel();var i=!0;void 0==this.ChatCrossDataList&&(this.ChatCrossDataList=new Array),this.ChatCrossDataList.push(e),void 0==this.ChatAllList&&(this.ChatAllList=new Array),this.ChatAllList.push(e);var n=function(){EventProxy.Broast(EventType.S2CRepGlobalchatCross,[i])};TimerManager.ins().remove(n,this),!this.last_send_time||this.last_send_time-egret.getTimer()>2e3?(EventProxy.Broast(EventType.S2CRepGlobalchatCross,[i]),this.last_send_time=egret.getTimer()):TimerManager.ins().doTimer(1e3,1,n,this)},e.prototype.getChatNum=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e=GlobalConfig.getVip_chat_dataConfig(t);return e?e.times:0},e.prototype.getMyChatCount=function(){return this.chat_times||0},e.prototype.getMyChatLeftCount=function(){return Math.max(this.getChatNum()-this.getMyChatCount())},e.blackLimitNum=40,e.chatMsgMax=30,e}(BaseSystem);__reflect(ChatProxy.prototype,"ChatProxy");var S2CCopyItem=function(){function t(){}return t}();__reflect(S2CCopyItem.prototype,"S2CCopyItem");var ItemExData=function(){function t(){}return t}();__reflect(ItemExData.prototype,"ItemExData");var CopyType;!function(t){t[t.zyt=1]="zyt",t[t.material=2]="material",t[t.exp=3]="exp",t[t.sword=4]="sword"}(CopyType||(CopyType={}));var CopySpeciallogicType;!function(t){t[t.single_copy=2]="single_copy",t[t.simple_boss=11]="simple_boss"}(CopySpeciallogicType||(CopySpeciallogicType={}));var CopyEndClickType;!function(t){t[t.type1=1]="type1",t[t.type2=2]="type2",t[t.type3=3]="type3",t[t.type4=4]="type4",t[t.fight=5]="fight"}(CopyEndClickType||(CopyEndClickType={}));var CopyProxy=function(t){function e(){var e=t.call(this)||this;return e.isFightWin=!1,e.isInit=!1,e.simple_climb_enter_id=25001,e.sword_enter_id=26001,e.limit_boss_enter_id=29011,e.trial_boss_enter_id=29026,e.team_exp_enter_id=27101,e.sht_climb_enter_id=45001,e.copyEndFailType=-1,e.isInitTower=!0,e.isInitSHTower=!0,e.isInitSword=!0,e.isInitBossLimit=!0,e.is_smelt_lyh=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.setCopyFailType=function(t){this.copyEndFailType=t},e.prototype.getCopyFailType=function(){return this.copyEndFailType},e.prototype.getFightState=function(){if(LimitActProxy.ins().IsFristRechargeOpen())return 0;var t=GlobalConfig.getMisc_dataConfig(1);if(!t)return 1;var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);return e<=t.yjfx_vip?1:2},e.prototype.DoFubenFailBtn=function(){var t=this.getCopyFailType();if(t>0){switch(t){case CopyEndClickType.fight:var e=this.getFightState();0==e?ViewManager.ins().open(FirstRechargeView):1==e?ViewManager.ins().open(yjfxView):2==e&&ViewManager.ins().open(DayFRView);break;default:var i=GlobalConfig.getCopy_miscConfig(1);if(i.fail_system_path[t-1]){var n=i.fail_system_path[t-1];ViewManager.ins().OpenViewById(n[1],n[2]||0)}}this.setCopyFailType(-1)}},e.prototype.InitCopyData=function(){this.materical_data_list=new Array,this.tower_zhenmo_data_list=new Array,this.tower_sword_data_list=new Array,this.tower_suohun_data_list=new Array,GlobalConfig.getConfig("copy_data","CopyDataConfig");var t=XiuXianProxy.ins().achie_level;for(var e in GlobalConfig.ins().CopyDataConfig){var i=GlobalConfig.ins().CopyDataConfig[e];if(i.fuben_type>0){for(var n=!1,o=0;o<this.materical_data_list.length;o++)this.materical_data_list[o].fuben_type==i.fuben_type&&(n=!0,this.materical_data_list[o].difficult_state[0]<i.difficult_state[0]&&t>=i.difficult_state[0]&&t<i.difficult_state[1]&&(this.materical_data_list[o]=i));n||t>=i.difficult_state[0]&&this.materical_data_list.push(i)}else this.simple_climb_enter_id==i.entry_copy_id?this.tower_zhenmo_data_list.push(i):this.sht_climb_enter_id==i.entry_copy_id?this.tower_suohun_data_list.push(i):this.sword_enter_id==i.entry_copy_id&&this.tower_sword_data_list.push(i);13!=i.speciallogic_type||this._baowu_type_enter_id_one||(this._baowu_type_enter_id_one=i.entry_copy_id),14!=i.speciallogic_type||this._baowu_type_enter_id_two||(this._baowu_type_enter_id_two=i.entry_copy_id),15!=i.speciallogic_type||this._baowu_type_enter_id_three||(this._baowu_type_enter_id_three=i.entry_copy_id),16!=i.speciallogic_type||this._baowu_type_enter_id_four||(this._baowu_type_enter_id_four=i.entry_copy_id),43!=i.speciallogic_type||this._baowu_type_enter_id_five||(this._baowu_type_enter_id_five=i.entry_copy_id)}this.materical_data_list.sort(this.sortType),this.tower_zhenmo_data_list.sort(this.sort),this.tower_suohun_data_list.sort(this.sort),this.tower_sword_data_list.sort(this.sort),this.isInit=!0},e.prototype.sortType=function(t,e){return t.fuben_type<e.fuben_type?-1:t.fuben_type>e.fuben_type?1:0},e.prototype.sort=function(t,e){return t.id<e.id?-1:t.id>e.id?1:0},e.prototype.GetMatericalData=function(){return this.InitCopyData(),this.materical_data_list},e.prototype.C2SReqCopyGetData=function(t){0==t&&(this.isInitTower=!0,this.isInitSHTower=!0,this.isInitSword=!0,this.isInitBossLimit=!0);var e=new net_protocol.C2SReqCopyGetData;e.copy_id=t,this.sendPbPack(Msg.C2SReqCopyGetData,e,net_protocol.C2SReqCopyGetData)},e.prototype.C2SReqCopyEnterCopy=function(t){var i=this;if(this.isLyh(t)&&!BossProxy.ins().isBagLeftEnough())return void(this.is_smelt_lyh=!0);if(YezhanProxy.ins().isRunning())return void TipsControl.ins().showTips("请等待野战结束!");var n=GameLogic.ins().getCurSceneData();if(1!=n.speciallogic_type&&GameLogic.ins().isInXunyou()||e.ins().isSimgleCopy(e.ins().copyId)||1!=n.scene_type&&7!=n.speciallogic_type&&!e.ins().isLyh(e.ins().copyId)&&!e.ins().isLimitBoss(e.ins().copyId))return void TipsControl.ins().showTips("C:4&当前处于副本或活动场景，无法传送");var o=GlobalConfig.getCopyConfigById(t),s=GlobalConfig.getCopyConfigById(e.ins().copyId);if(s&&o&&s.entry_copy_id!=o.entry_copy_id)return void TipsControl.ins().showTips("C:4&当前处于副本或活动场景，无法传送");var r=e.ins().GetCopyDataByCopyId(t);if(r&&r.climb_info&&r.climb_info.last_floor>0&&!this.isLimitServerDayCopyId(o.next_copy))return void TipsControl.ins().showTips("C:4&未能达到开启时间，无法传送");CommonUtils.log("---------C2SReqCopyEnterCopy----------",t);var a=!1;if(null==o)return void CommonUtils.log("---------copy 表没有找到配置，copy_id---------->>",t);if(8==o.speciallogic_type?FwProxy.ins().getSubBagCount()<=10?TipsControl.ins().ShowTips1("剑心背包格子数不足，进行挑战会无法获得奖励，是否进入?",function(){},function(){var e=o.scene_type_id[0],n=(GlobalConfig.getSceneConfigById(e),new net_protocol.C2SReqCopyEnterCopy);n.copy_id=t,n.scene_x=0,n.scene_y=0,i.sendPbPack(Msg.C2SReqCopyEnterCopy,n,net_protocol.C2SReqCopyEnterCopy)}):a=!0:BagProxy.ins().GetBagLeftCount(BagType.BAG)<=20?TipsControl.ins().ShowTips1("背包格子数不足，是否进入?",function(){},function(){var e=o.scene_type_id[0],n=(GlobalConfig.getSceneConfigById(e),new net_protocol.C2SReqCopyEnterCopy);n.copy_id=t,n.scene_x=0,n.scene_y=0,i.sendPbPack(Msg.C2SReqCopyEnterCopy,n,net_protocol.C2SReqCopyEnterCopy)}):a=!0,a){var h=o.scene_type_id[0],l=(GlobalConfig.getSceneConfigById(h),new net_protocol.C2SReqCopyEnterCopy);l.copy_id=t,l.scene_x=0,l.scene_y=0,this.sendPbPack(Msg.C2SReqCopyEnterCopy,l,net_protocol.C2SReqCopyEnterCopy)}},e.prototype.C2SReqCopyLeave=function(t){var e=new net_protocol.C2SReqCopyLeave;CommonUtils.log("---------C2SReqCopyLeave----------",t),e.is_finish=t,e.scene_x=0,e.scene_y=0,this.sendPbPack(Msg.C2SReqCopyLeave,e,net_protocol.C2SReqCopyLeave)},e.prototype.S2CRepCopyGetData=function(t){var e=net_protocol.S2CRepCopyGetData.decode(t.bytes);if(CommonUtils.log("---------S2CRepCopyGetData----------",e),this.CopyList)for(var i=0;i<e.copy_list.length;++i)for(var n in this.CopyList)this.CopyList[n].copy_id==e.copy_list[i].copy_id&&(this.CopyList[n]=e.copy_list[i]);else this.CopyList=e.copy_list;this.CopyList=e.copy_list,this.CopycLimb_list=e.climb_list,this.InitCopyData(),EventProxy.Broast(EventType.S2CRepCopyGetData,{})},e.prototype.S2CRepCopyEnterCopy=function(t){var e=net_protocol.S2CRepCopyEnterCopy.decode(t.bytes),i=e.copy_id;if(this.copyId=i,NoticeProxy.ins().ErrCode(e.err_code)){var n=GlobalConfig.getCopyConfigById(i);this.free_time=n.time_out,this.cur_server_time=GameLogic.ins().getServerTime(),this.isSimgleCopy(i)&&GameLogic.ins().onEnterCopy(i),ViewManager.ins().close(FubenView),EventProxy.Broast(EventType.S2CRepCopyEnterCopy,[this.isSimgleCopy(i)])}},e.prototype.ClearData=function(){this.copyId=0},e.prototype.isSimgleCopy=function(t){if(void 0==t)return!1;var e=GlobalConfig.getCopyConfigById(t);return void 0!=e&&2==e.speciallogic_type?!0:!1},e.prototype.isLyh=function(t){if(void 0==t)return!1;var e=GlobalConfig.getCopyConfigById(t);return void 0!=e&&6==e.speciallogic_type?!0:!1},e.prototype.isSYT=function(t){if(void 0==t)return!1;var e=GlobalConfig.getCopyConfigById(t);return void 0!=e&&e.entry_copy_id==this.simple_climb_enter_id?!0:!1},e.prototype.isSHT=function(t){if(void 0==t)return!1;var e=GlobalConfig.getCopyConfigById(t);return void 0!=e&&e.entry_copy_id==this.sht_climb_enter_id?!0:!1},e.prototype.isLimitBoss=function(t){if(void 0==t)return!1;var e=GlobalConfig.getCopyConfigById(t);return void 0!=e&&e.entry_copy_id==this.limit_boss_enter_id?!0:!1},e.prototype.getSYTFloor=function(){var t=this.simple_climb_enter_id,e=this.GetCopyDataByCopyId(t);return e&&e.climb_info&&e.climb_info.last_floor>0?e.climb_info.last_floor-t+1:0},e.prototype.getSYTFloorBySceneId=function(t){var e=GlobalConfig.getCopyConfigById(t);return e&&this.isSYT(e.id)?e.id-this.simple_climb_enter_id+1:0},e.prototype.getSHTFloor=function(){var t=this.sht_climb_enter_id,e=this.GetCopyDataByCopyId(t);return e&&e.climb_info&&e.climb_info.last_floor>0?e.climb_info.last_floor-t+1:0},e.prototype.getSHTFloorBySceneId=function(t){var e=GlobalConfig.getCopyConfigById(t);return e&&this.isSHT(e.id)?e.id-this.sht_climb_enter_id+1:0},e.prototype.isNextCopy=function(t){if(void 0==t)return!1;var e=GlobalConfig.getCopyConfigById(t);return void 0==e||6!=e.speciallogic_type&&7!=e.speciallogic_type&&8!=e.speciallogic_type&&13!=e.speciallogic_type&&14!=e.speciallogic_type&&15!=e.speciallogic_type&&16!=e.speciallogic_type&&43!=e.speciallogic_type&&42!=e.speciallogic_type?!1:!0},e.prototype.isShenxian=function(t){if(void 0==t)return!1;var e=GlobalConfig.getArena_base_dataConfig(1).scene_type_id;return void 0!=e&&e==t?!0:!1},e.prototype.isLunjian=function(t){if(void 0==t)return!1;var e=GlobalConfig.getFaction_sword_paramConfig(1).scene_type_id;return void 0!=e&&e==t?!0:!1},e.prototype.isZMZD=function(t){if(void 0==t)return!1;var e=GlobalConfig.getLeader_battle_base_dataConfig(1).scene_type_id;return void 0!=e&&e==t?!0:!1},e.prototype.isDujieCopy=function(t){var e=GlobalConfig.getSceneConfigById(t);return e&&39==e.speciallogic_type?!0:!1},e.prototype.isXYQQ=function(){return GameLogic.ins().getCurSceneData()&&37==GameLogic.ins().getCurSceneData().speciallogic_type?!0:!1},e.prototype.isTeamExp=function(t){if(void 0==t)return!1;var e=GlobalConfig.getTeamcopy_baseConfig(1).scene_type_id;return void 0!=e&&e==t?!0:!1},e.prototype.isLeiTai=function(t){if(void 0==t)return!1;var e=GlobalConfig.getLeitai_misc_dataConfigConfig(1).scene_type_id;return void 0!=e&&e==t?!0:!1},e.prototype.isSwordCopy=function(t){if(void 0==t)return!1;var e=GlobalConfig.getSceneConfigById(t);if(void 0!=e&&2==e.scene_type){var i=GlobalConfig.getCopyConfigById(e.copy_id);if(void 0!=i&&8==i.speciallogic_type)return!0}return!1},e.prototype.isNextBigBaowuCopyByScene=function(t){if(void 0!=t){var e=GlobalConfig.getSceneConfigById(t);if(void 0!=e&&2==e.scene_type){var i=GlobalConfig.getCopyConfigById(e.copy_id);if(void 0!=i&&(13==i.speciallogic_type||14==i.speciallogic_type||15==i.speciallogic_type||16==i.speciallogic_type||43==i.speciallogic_type)){var n=this.GetCopyDataByCopyId(i.id),o=void 0;return o=void 0!=n&&void 0!=n.climb_info&&n.climb_info.last_floor>0?this.getNextBigReward(n.climb_info.last_floor):this.getNextBigReward(i.entry_copy_id)}}}},e.prototype.getCurBaowuCopyFloor=function(t){if(void 0==t)return 0;var e=GlobalConfig.getSceneConfigById(t);if(void 0!=e&&2==e.scene_type){var i=GlobalConfig.getCopyConfigById(e.copy_id);if(void 0!=i&&(13==i.speciallogic_type||14==i.speciallogic_type||15==i.speciallogic_type||16==i.speciallogic_type||43==i.speciallogic_type)){var n=this.GetCopyDataByCopyId(i.id);return void 0==n?1:void 0!=n.climb_info&&n.climb_info.last_floor>0?n.climb_info.last_floor-i.entry_copy_id+1+1:1}}return 0},e.prototype.isTopFight=function(t){if(void 0==t)return!1;var e=GlobalConfig.getPvp_base_dataConfig(1).scene_type_id;return void 0!=e&&e==t?!0:!1},e.prototype.NextBigReward=function(t){for(var e=0,i=this.tower_zhenmo_data_list;e<i.length;e++){var n=i[e];if(n.id>t&&n.show_drop.length>0)return n}return null},e.prototype.SHTNextBigReward=function(t){for(var e=0,i=this.tower_suohun_data_list;e<i.length;e++){var n=i[e];if(n.id>t&&n.show_drop.length>0)return n}return null},e.prototype.LastBigReward=function(){for(var t,e=0,i=this.tower_zhenmo_data_list;e<i.length;e++){var n=i[e];
(!t||n.id>t.id)&&n.show_drop.length>0&&(t=n)}return t},e.prototype.SHTLastBigReward=function(){for(var t,e=0,i=this.tower_suohun_data_list;e<i.length;e++){var n=i[e];(!t||n.id>t.id)&&n.show_drop.length>0&&(t=n)}return t},e.prototype.getNextBigReward=function(t){var e=GlobalConfig.getCopyConfigById(t);for(var i in GlobalConfig.ins().CopyDataConfig){var n=GlobalConfig.ins().CopyDataConfig[i];if(e.entry_copy_id==n.entry_copy_id&&n.id>t&&n.show_drop.length>0)return n}},e.prototype.S2CRepCopyLeave=function(t){var e=net_protocol.S2CRepCopyLeave.decode(t.bytes);CopyHangManager.ins().clearData(),this.isSimgleCopy(e.copy_id)&&GameLogic.ins().onExitCopy(),EventProxy.Broast(EventType.S2CRepCopyLeave,[this.isSimgleCopy(e.copy_id)])},e.prototype.getCopyLeftTime=function(){return this.free_time-(GameLogic.ins().getServerTime()-this.cur_server_time)},e.prototype.S2CRepCopyEnd=function(t){var i=net_protocol.S2CRepCopyEnd.decode(t.bytes);CommonUtils.log("---------S2CRepCopyEnd----------",i),CommonUtils.log("---------S2CRepCopyEnd----------copy free_time---------",this.free_time,GameLogic.ins().getServerTime()-this.cur_server_time),this.repCopyEnd=i;for(var n=new Array,o=0;o<i.fuwen_list.length;++o){var s=new ItemExData;s.fuwenData=i.fuwen_list[o],s.fuwenData.type=FwUIType.preview,n.push(s)}for(var o=0;o<i.item_list.length;o++){var s=new ItemExData,r=new ItemCellData,a={item_slot_idx:0,item_type_id:i.item_list[o].item_id,item_count:i.item_list[o].item_num};r.setItemCellData(a),s.itemData=r,n.push(s)}var h=NoticeProxy.ins().ErrCode(i.err_code);h||EventProxy.Broast(EventType.copyFailUpdate,[]),!h&&e.ins().isLyh(e.ins().copyId)&&(LyhProxy.ins().setAutoState(!1),EventProxy.Broast(EventType.LyhAutoState,[!1]),LimitActProxy.ins().IsShowFRPush=!0),e.ins().isSYT(i.copy_id)&&(XiuXianProxy.ins().updateZhuanRed(),!h&&LimitActProxy.ins().IsFristRechargeOpen()&&(LimitActProxy.ins().IsShowFirstRechange=!0)),ViewManager.ins().open(FbendView,n,h);var l=!1,p=!1,c=GlobalConfig.getCopyConfigById(i.copy_id);null!=c&&2==c.speciallogic_type&&(p=!0);for(var u in this.CopyList)p?this.CopyList[u].copy_id==c.entry_copy_id&&(l=!0,this.CopyList[u].times++):this.CopyList[u].copy_id==i.copy_item.copy_id&&(l=!0,this.CopyList[u]=i.copy_item);if(!l)if(void 0==this.CopyList&&(this.CopyList=[]),p){var d=new S2CCopyItem;d.copy_id=c.entry_copy_id,d.times=1,d.buy_times=0,this.CopyList.push(d)}else this.CopyList.push(i.copy_item);EventProxy.Broast(EventType.S2CRepCopyEnd,{}),EventProxy.Broast(EventType.RefreshCopyRed,[]),EventProxy.Broast(EventType.freshLimitActRed,[]);var g=GlobalConfig.getTrial_bossConfig(i.copy_id);if(void 0!=g&&h){var y=this.GetCopycLimbListDataByCopyId(i.copy_id);void 0==y&&e.ins().C2SReqCopyGetData(0)}},e.prototype.GetCopyDataByCopyId=function(t){var e=GlobalConfig.getCopyConfigById(t);for(var i in this.CopyList)if(this.CopyList[i].copy_id==e.entry_copy_id)return this.CopyList[i];return null},e.prototype.GetCopycLimbListDataByCopyId=function(t){var e=GlobalConfig.getCopyConfigById(t);for(var i in this.CopycLimb_list)if(this.CopycLimb_list[i].copy_id==e.id)return this.CopycLimb_list[i];return null},e.prototype.isCopyEnter=function(t){var e=GlobalConfig.getCopyConfigById(t);for(var i in this.CopyList)if(this.CopyList[i].copy_id==e.entry_copy_id)return!0;return!1},e.prototype.getCopyLeftTimeById=function(t){var i=e.ins().GetCopyDataByCopyId(t),n=GlobalConfig.getCopyConfigById(t);return i?i.buy_times?Math.max(0,n.times-i.times+i.buy_times):Math.max(0,n.times-i.times):n.times},e.prototype.getCopyBuyTimeById=function(t){var i=e.ins().GetCopyDataByCopyId(t);return i?i.buy_times:0},e.prototype.isMatericalEnoughVIP=function(){this.materical_data_list||this.InitCopyData();for(var t=0;t<this.materical_data_list.length;++t)return this.materical_data_list[t].sweep_vip_level<=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);return!1},e.prototype.getMatericalSweepVIP=function(){this.materical_data_list||this.InitCopyData();for(var t=0;t<this.materical_data_list.length;++t)return this.materical_data_list[t].sweep_vip_level;return 0},e.prototype.C2SReqCopySweep=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=0);var n=new net_protocol.C2SReqCopySweep;n.copy_id=t,n.is_double=e,n.flag=i,CommonUtils.log("(((((((****************|||*********C2SReqCopySweep",n),this.sendPbPack(Msg.C2SReqCopySweep,n,net_protocol.C2SReqCopySweep)},e.prototype.S2CRepCopySweep=function(t){var e=net_protocol.S2CRepCopySweep.decode(t.bytes);if(CommonUtils.log("(((((((****************|||*********S2CRepCopySweep",e),NoticeProxy.ins().ErrCode(e.err_code)){for(var i in this.CopyList)this.CopyList[i].copy_id==e.copy_id&&(this.CopyList[i].sweep_times=this.CopyList[i].sweep_times+1,this.CopyList[i].times=this.CopyList[i].times+1);for(var n=new Array,o=0;o<e.item_list.length;++o){var s=UtilProxy.GetItemCellData(e.item_list[o].item_id,e.item_list[o].item_num);n.push(s)}n.length>0&&TipsControl.ins().showReward(n),EventProxy.Broast(EventType.S2CRepCopySweep,[e.copy_id])}},e.prototype.C2SReqCopyGetClimbReward=function(t,e,i){var n=new net_protocol.C2SReqCopyGetClimbReward;n.copy_id=t,n.index=i,n.flag=e,this.sendPbPack(Msg.C2SReqCopyGetClimbReward,n,net_protocol.C2SReqCopyGetClimbReward)},e.prototype.S2CCopyRepCopyGetClimbReward=function(t){var e=net_protocol.S2CCopyRepCopyGetClimbReward.decode(t.bytes);if(NoticeProxy.ins().ErrCode(e.err_code)){for(var i in this.CopyList)this.CopyList[i].copy_id==e.copy_id&&(this.CopyList[i].climb_info=e.climb_info);for(var n=new Array,o=0;o<e.item_list.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:e.item_list[o].item_id,item_count:e.item_list[o].item_num};s.setItemCellData(r),n.push(s)}TipsControl.ins().showReward(n),EventProxy.Broast(EventType.S2CCopyRepCopyGetClimbReward,{})}},e.prototype.GetNextRewardData=function(){var t=this.GetCopyDataByCopyId(this.simple_climb_enter_id),i=GlobalConfig.getTowerRewardById(this.simple_climb_enter_id);if(void 0!=t&&void 0!=t.climb_info){var n=t.climb_info.last_reward_floor,o=(t.climb_info.last_floor-e.ins().simple_climb_enter_id+1,0);for(var s in i)if(o=Math.max(Number(s),o),i[s].index>n)return i[s];return i[o]}for(var s in i)return i[s]},e.prototype.GetSHTNextRewardData=function(){var t=this.GetCopyDataByCopyId(this.sht_climb_enter_id),i=GlobalConfig.getTowerRewardById(this.sht_climb_enter_id);if(void 0!=t&&void 0!=t.climb_info){var n=t.climb_info.last_reward_floor,o=(t.climb_info.last_floor-e.ins().sht_climb_enter_id+1,0);for(var s in i)if(o=Math.max(Number(s),o),i[s].index>n)return i[s];return i[o]}for(var s in i)return i[s]},e.prototype.GetNextSwordRewardData=function(){var t=this.GetCopyDataByCopyId(this.sword_enter_id),i=GlobalConfig.getTowerRewardById(this.sword_enter_id);if(void 0!=t&&void 0!=t.climb_info){var n=t.climb_info.last_reward_floor,o=t.climb_info.last_floor-e.ins().sword_enter_id+1,s=0;for(var r in i)if(s=Math.max(Number(r),s),i[r].index>n&&o>=i[r].floor)return i[r];return i[s]}for(var r in i)return i[r]},e.prototype.C2SReqCopyBuyTimes=function(t){var e=new net_protocol.C2SReqCopyBuyTimes;return e.copy_id=t,void 0==this.GetCopyDataByCopyId(t)?void TipsControl.ins().showTips("尚未挑战不能购买！"):void this.sendPbPack(Msg.C2SReqCopyBuyTimes,e,net_protocol.C2SReqCopyBuyTimes)},e.prototype.S2CRepCopyBuyTimes=function(t){var e=net_protocol.S2CRepCopyBuyTimes.decode(t.bytes);CommonUtils.log("-----------()()()()()()()()()()()()()()()()-----------------------------C2SReqCopyBuyTimes",e);for(var i=0;i<this.CopyList.length;++i)this.CopyList[i].copy_id==e.copy_id&&(this.CopyList[i].buy_times=this.CopyList[i].buy_times+1);EventProxy.Broast(EventType.S2CRepCopyBuyTimes,[e.copy_id]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.C2SReqCopyOnekeySweep=function(t){var e=new net_protocol.C2SReqCopyOnekeySweep;e.copy_type=t,CommonUtils.log("-----------------<><><><<><>>><<<<>>>>>>>>----------------------------------C2SReqCopyOnekeySweep",e),this.sendPbPack(Msg.C2SReqCopyOnekeySweep,e,net_protocol.C2SReqCopyOnekeySweep)},e.prototype.S2CRepCopyOnekeySweep=function(t){var e=net_protocol.S2CRepCopyOnekeySweep.decode(t.bytes);CommonUtils.log("-----------------<><><><<><>>><<<<>>>>>>>>----------------------------------S2CRepCopyOnekeySweep",e);for(var i=0;i<e.info_list.length;++i)for(var n=0;n<this.CopyList.length;++n)this.CopyList[n].copy_id==e.info_list[i].copy_id&&(this.CopyList[n].times=this.CopyList[n].times+e.info_list[i].times,this.CopyList[n].next_free_time=e.info_list[i].next_free_time);EventProxy.Broast(EventType.S2CRepCopyOnekeySweep,[]),EventProxy.Broast(EventType.RefreshBossRed,[])},e.prototype.S2CRepCopyStart=function(t){var e=net_protocol.S2CRepCopyStart.decode(t.bytes);CommonUtils.log("-----------------<><><><<><>>><<<<>>>>>>>>----------------------------------S2CRepCopyStart",e),this.free_time=e.free_time,this.cur_server_time=GameLogic.ins().getServerTime(),EventProxy.Broast(EventType.S2CRepCopyStart,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25400,this.S2CRepCopyGetData,this),MsgHandle.ins().regNetMsg(25401,this.S2CRepCopyEnterCopy,this),MsgHandle.ins().regNetMsg(25402,this.S2CRepCopyLeave,this),MsgHandle.ins().regNetMsg(25403,this.S2CRepCopyEnd,this),MsgHandle.ins().regNetMsg(25404,this.S2CRepCopyStart,this),MsgHandle.ins().regNetMsg(25405,this.S2CRepCopyBuyTimes,this),MsgHandle.ins().regNetMsg(25419,this.S2CCopyRepCopyGetClimbReward,this),MsgHandle.ins().regNetMsg(25411,this.S2CRepCopySweep,this),MsgHandle.ins().regNetMsg(25428,this.S2CRepCopyOnekeySweep,this)},e.prototype.GetZYTowerCopyRed=function(){return SystemOpenProxy.ins().isOpen(1,M_View_Type.Copy,!0)&&SystemOpenProxy.ins().isOpen(2,100*M_View_Type.Copy+1,!0)?this.isZYTowerReward()||this.isInitTower:!1},e.prototype.getZYTowerFloor=function(){var t=e.ins().GetCopyDataByCopyId(e.ins().simple_climb_enter_id);return void 0!=t&&void 0!=t.climb_info?t.climb_info.last_floor-e.ins().simple_climb_enter_id+1:0},e.prototype.isZYTowerReward=function(){var t=e.ins().GetNextRewardData(),i=e.ins().GetCopyDataByCopyId(e.ins().simple_climb_enter_id);if(void 0!=i&&void 0!=i.climb_info&&null!=t){var n=i.climb_info.last_floor-e.ins().simple_climb_enter_id+1;if(n>=t.floor)return!0}return!1},e.prototype.GetSHTowerCopyRed=function(){return SystemOpenProxy.ins().isOpen(1,M_View_Type.Copy,!0)&&SystemOpenProxy.ins().isOpen(2,100*M_View_Type.Copy+6,!0)?this.isSHTowerReward()||this.isInitSHTower:!1},e.prototype.getSHTowerFloor=function(){var t=e.ins().GetCopyDataByCopyId(e.ins().sht_climb_enter_id);return void 0!=t&&void 0!=t.climb_info?t.climb_info.last_floor-e.ins().sht_climb_enter_id+1:0},e.prototype.isSHTowerReward=function(){var t=e.ins().GetSHTNextRewardData(),i=e.ins().GetCopyDataByCopyId(e.ins().sht_climb_enter_id);if(void 0!=i&&void 0!=i.climb_info&&null!=t){var n=i.climb_info.last_floor-e.ins().sht_climb_enter_id+1;if(n>=t.floor)return!0}return!1},e.prototype.GetMatericalCopyRed=function(){if(!SystemOpenProxy.ins().isOpen(1,M_View_Type.Copy,!0))return!1;var t=e.ins().GetMatericalData();new Array;for(var i in t){var n=t[i];if(this.getCopyLeftTimeById(n.id)>0)return!0}return!1},e.prototype.getSwordType=function(){var t=e.ins().sword_enter_id,i=(e.ins().GetCopyDataByCopyId(t),this.copyId,GlobalConfig.getfwLockList()),n=GlobalConfig.getfwPreList();for(var o in i){var s=i[o];if(s.id==this.copyId)return 1}for(var o in n){var r=n[o];for(var a in r)if(r[a].lv==this.copyId-t+1)return 2}return 0},e.prototype.getSwordRed=function(){if(!SystemOpenProxy.ins().isOpen(1,M_View_Type.Copy,!0))return!1;if(!SystemOpenProxy.ins().isOpen(2,100*M_View_Type.Copy+CopyType.sword-1,!0))return!1;if(this.isInitSword)return!0;var t=GlobalConfig.getCopyConfigById(this.sword_enter_id),e=this.GetCopyDataByCopyId(this.sword_enter_id);return void 0!=e?t.sweep_times>e.sweep_times:!0},e.prototype.getRed=function(){return this.GetZYTowerCopyRed()||this.GetSHTowerCopyRed()||this.GetMatericalCopyRed()||CopyTeamProxy.ins().getRed()||this.getSwordRed()||this.GetVIPCopyRed()},e.prototype.getBossLimitBigReward=function(){var t=GlobalConfig.getLimit_bossConfigs();for(var e in t)if(t[e].award.length>0)return[t[e].id,t[e].award]},e.prototype.getBossLimitTopFloor=function(){var t=GlobalConfig.getLimit_bossConfigs(),e=0;for(var i in t)t[i].id>e&&(e=t[i].id);return e},e.prototype.isBossLimitScene=function(t){var e=GlobalConfig.getSceneConfigById(t);if(e&&e.copy_id>0){var i=GlobalConfig.getCopyConfigById(e.copy_id);return i&&12==i.speciallogic_type}return!1},e.prototype.isBossSevenDayScene=function(t){var e=GlobalConfig.getSceneConfigById(t);if(e&&e.copy_id>0){var i=GlobalConfig.getCopyConfigById(e.copy_id);return i&&17==i.speciallogic_type}return!1},e.prototype.BossLimitSceneFloor=function(t){var e=GlobalConfig.getSceneConfigById(t);if(e&&e.copy_id>0){var i=GlobalConfig.getCopyConfigById(e.copy_id);if(i)return i.id-i.entry_copy_id+1}return 0},e.prototype.getBossLimitLeftTime=function(){var t=GlobalConfig.getCopyConfigById(this.limit_boss_enter_id),e=(t.serverday_limit[0],t.serverday_limit[1]),i=LimitActProxy.ins().GetServerOpenDay();if(e>=i){var n=GameLogic.ins().getServerTime(),o=new Date(1e3*n),s=24*(e+1-i)*3600,r=s-3600*o.getHours()-60*o.getMinutes()-o.getSeconds();return r}return 0},e.prototype.getBossLimitFloor=function(){var t=e.ins().GetCopyDataByCopyId(e.ins().limit_boss_enter_id);return void 0==t?0:void 0!=t.climb_info&&t.climb_info.last_floor>0?t.climb_info.last_floor:0},e.prototype.getBossLimitRed=function(){if(this.isInitBossLimit)return!0;var t=this.getBossLimitFloor(),e=this.getBossLimitTopFloor();return e>t},e.prototype.getBaowuEnterIdList=function(){return this._baowu_type_enter_id_one||this.InitCopyData(),[this._baowu_type_enter_id_one,this._baowu_type_enter_id_two,this._baowu_type_enter_id_three,this._baowu_type_enter_id_four,this._baowu_type_enter_id_five]},e.prototype.getBaowuEnterIndex=function(t){for(var e=this.getBaowuEnterIdList(),i=0;i<e.length;++i)if(t==e[i])return i;return 0},e.prototype.isCurrentFloorById=function(t){var i=e.ins().GetCopyDataByCopyId(t);return void 0==i?!1:void 0!=i.climb_info&&i.climb_info.last_floor>=t?!0:!1},e.prototype.getCurrentFloorById=function(t){var i=e.ins().GetCopyDataByCopyId(t);return void 0==i?0:void 0!=i.climb_info&&i.climb_info.last_floor>0?i.climb_info.last_floor-t+1:0},e.prototype.isBaowuCopy=function(t){for(var e=this.getBaowuEnterIdList(),i=0;i<e.length;++i)if(t==e[i])return!0;return!1},e.prototype.isCopyEnoughById=function(t){var e=GlobalConfig.getCopyConfigById(t);if(e){var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),n=e.open_zhuan;if(n>i)return!1;var o=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),s=e.open_level;if(s>o)return!1;var r=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),a=e.vip_level;if(a>r)return!1;var h=LyhProxy.ins().getCurId(),l=e.lock_tower_limit;if(l>h)return!1;var p=LimitActProxy.ins().GetServerOpenDay(),c=e.serverday_limit;if(c&&c[0]&&p<c[0])return!1;if(c&&c[1]&&p>c[1])return!1}return!0},e.prototype.isBossTrialScene=function(t){var e=GlobalConfig.getSceneConfigById(t);if(e&&e.copy_id>0){var i=GlobalConfig.getCopyConfigById(e.copy_id);return i&&11==i.speciallogic_type}return!1},e.prototype.isEndCopyById=function(t){var e=GlobalConfig.getCopyConfigById(t);return e?0==e.next_copy:!1},e.prototype.isLimitServerDayCopyId=function(t){var e=GlobalConfig.getCopyConfigById(t);if(e){var i=LimitActProxy.ins().GetServerOpenDay(),n=e.serverday_limit;if(n&&n[0]&&i<n[0])return!1;if(n&&n[1]&&i>n[1])return!1}return!0},e.prototype.getBossTrialFloor=function(){var t=e.ins().GetCopyDataByCopyId(e.ins().trial_boss_enter_id);return void 0==t?0:void 0!=t.climb_info&&t.climb_info.last_floor>0?t.climb_info.last_floor:0},e.prototype.getTrialBossBigReward=function(){var t=GlobalConfig.getTrial_bossConfigs();for(var e in t)if(t[e].award.length>0)return[t[e].id,t[e].award]},e.prototype.getCopyBuyInfoById=function(t){var i=e.ins().getCopyBuyTimeById(t),n=GlobalConfig.getCopyConfigById(t),o=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),s=n.buy_times_cost[0],r=n.buy_times_cost[1],a=s?s[o]||s[s.length-1]:0,h=Math.max(a-i,0),l=[0,0];l=h>0?r?r[i]||r[r.length-1]:[0,0]:r?r[i-1]||r[r.length-1]:[0,0];var p=l[0],c=l[1];return{max_time:a,buy_time:i,left_time:h,buy_type:p,buy_value:c}},e.prototype.GetVIPCopyRed=function(){if((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck))return!1;if(!SystemOpenProxy.ins().isOpen(SystemOpenType.ZHUAN,M_View_Type.VIPBoss))return!1;void 0==this.vipConfig&&(this.vipConfig=GlobalConfig.GetVIPCopyConfig());for(var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),i=0;i<this.vipConfig.length;i++)if(t>=this.vipConfig[i].vip_level){var n=e.ins().getCopyLeftTimeById(this.vipConfig[i].entry_copy_id);if(n>0)return!0}return!1},e}(BaseSystem);__reflect(CopyProxy.prototype,"CopyProxy");var CopyTeamProxy=function(t){function e(){var e=t.call(this)||this;return e.isGuWu=!1,e.isStartmatching=!1,e.teamChallengeScrollID=30871,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqTeamcopyGetInfo=function(){var t=new net_protocol.C2SReqTeamcopyGetInfo;CommonUtils.log("C2SReqTeamcopyGetInfo"),this.sendPbPack(Msg.C2SReqTeamcopyGetInfo,t,net_protocol.C2SReqTeamcopyGetInfo)},e.prototype.C2SReqTeamcopyStartMatching=function(){var t=GameLogic.ins().getCurSceneData();if(1!=t.scene_type)return void TipsControl.ins().showTips("C:4&当前处于副本或活动场景，无法匹配");LyhProxy.ins().setAutoState(!1);var e=new net_protocol.C2SReqTeamcopyStartMatching;CommonUtils.log("C2SReqTeamcopyStartMatching"),this.sendPbPack(Msg.C2SReqTeamcopyStartMatching,e,net_protocol.C2SReqTeamcopyStartMatching)},e.prototype.C2SReqTeamcopyCancelMatching=function(){var t=new net_protocol.C2SReqTeamcopyCancelMatching;CommonUtils.log("C2SReqTeamcopyCancelMatching"),this.sendPbPack(Msg.C2SReqTeamcopyCancelMatching,t,net_protocol.C2SReqTeamcopyCancelMatching)},e.prototype.C2SReqTeamcopyBuyChallengeCount=function(){var t=new net_protocol.C2SReqTeamcopyBuyChallengeCount;CommonUtils.log("C2SReqTeamcopyBuyChallengeCount"),this.sendPbPack(Msg.C2SReqTeamcopyBuyChallengeCount,t,net_protocol.C2SReqTeamcopyBuyChallengeCount)},e.prototype.S2CTeamcopyGetInfo=function(t){var e=net_protocol.S2CTeamcopyGetInfo.decode(t.bytes);CommonUtils.log("S2CTeamcopyGetInfo",e),this.challenge_count=e.challenge_count,this.recover_time=e.recover_time,this.buy_times=e.buy_times,this.top_kill_num=e.top_kill_num,this.record=e.record,EventProxy.Broast(EventType.S2CTeamcopyGetInfo,{})},e.prototype.S2CTeamcopyCancelMatching=function(t){var e=net_protocol.S2CTeamcopyCancelMatching.decode(t.bytes);CommonUtils.log("S2CTeamcopyCancelMatching",e),this.isStartmatching=!1,EventProxy.Broast(EventType.S2CTeamcopyCancelMatching,{})},e.prototype.S2CTeamcopyStartMatching=function(t){var e=net_protocol.S2CTeamcopyStartMatching.decode(t.bytes);this.isStartmatching=!0,CommonUtils.log("S2CTeamcopyStartMatching",e),EventProxy.Broast(EventType.S2CTeamcopyStartMatching,{})},e.prototype.S2CTeamcopyBuyChallengeCount=function(t){var e=net_protocol.S2CTeamcopyBuyChallengeCount.decode(t.bytes);CommonUtils.log("S2CTeamcopyBuyChallengeCount",e),this.challenge_count=this.challenge_count+1,this.buy_times=this.buy_times+1,EventProxy.Broast(EventType.S2CTeamcopyBuyChallengeCount,{})},e.prototype.S2CTeamcopyMemberChange=function(t){var e=net_protocol.S2CTeamcopyMemberChange.decode(t.bytes);CommonUtils.log("S2CTeamcopyMemberChange",e),this.list=e.list,EventProxy.Broast(EventType.S2CTeamcopyMemberChange,{})},e.prototype.S2CTeamcopyMatchingSuccess=function(t){var e=net_protocol.S2CTeamcopyMatchingSuccess.decode(t.bytes);CommonUtils.log("S2CTeamcopyMatchingSuccess",e),this.list=e.list,SceneControl.ins().initDamageData(),this.exp=0,this.add_exp=0,this.monster_num=0,this.isGuWu=!1,this.isStartmatching=!1,EventProxy.Broast(EventType.S2CTeamcopyMatchingSuccess,{})},e.prototype.getTeamRoleById=function(t){if(void 0!=this.list)for(var e=0;e<this.list.length;++e)if(this.list[e].role_id==t)return this.list[e]},e.prototype.S2CTeamcopyEnd=function(t){var e=net_protocol.S2CTeamcopyEnd.decode(t.bytes);CommonUtils.log("S2CTeamcopyEnd",e),this.monster_num=e.monster_num,ViewManager.ins().open(FbendView,[],!0),SceneControl.ins().endDamageData(),this.isGuWu=!1,EventProxy.Broast(EventType.S2CTeamcopyEnd,{})},e.prototype.C2SReqTeamcopyGuwu=function(){var t=new net_protocol.C2SReqTeamcopyGuwu;CommonUtils.log("C2SReqTeamcopyGuwu"),this.sendPbPack(Msg.C2SReqTeamcopyGuwu,t,net_protocol.C2SReqTeamcopyGuwu)},e.prototype.S2CTeamcopyGuwu=function(t){var e=net_protocol.S2CTeamcopyGuwu.decode(t.bytes);CommonUtils.log("S2CTeamcopyGuwu",e),this.isGuWu=!0,EventProxy.Broast(EventType.S2CTeamcopyGuwu,{})},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(26200,this.S2CTeamcopyGetInfo,this),MsgHandle.ins().regNetMsg(26201,this.S2CTeamcopyStartMatching,this),MsgHandle.ins().regNetMsg(26202,this.S2CTeamcopyCancelMatching,this),MsgHandle.ins().regNetMsg(26203,this.S2CTeamcopyBuyChallengeCount,this),MsgHandle.ins().regNetMsg(26204,this.S2CTeamcopyMemberChange,this),MsgHandle.ins().regNetMsg(26205,this.S2CTeamcopyMatchingSuccess,this),MsgHandle.ins().regNetMsg(26206,this.S2CTeamcopyEnd,this),MsgHandle.ins().regNetMsg(26207,this.S2CTeamcopyGuwu,this)},e.prototype.getConfig=function(){if(void 0==this.team_config){GlobalConfig.getConfig("copy_data","CopyDataConfig");for(var t in GlobalConfig.ins().CopyDataConfig)if(2==GlobalConfig.ins().CopyDataConfig[t].type){this.team_config=GlobalConfig.ins().CopyDataConfig[t];break}}return this.team_config},e.prototype.getKillAward=function(){var t=this.getKillCount();if(0!=t){var e,i=GlobalConfig.getTeamcopy_kill_monster_awards();for(var n in i)i[n].monster_num<=t&&(e=i[n]);return e?e.awards:void 0}},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,M_View_Type.Copy,!0)&&SystemOpenProxy.ins().isOpen(2,100*M_View_Type.Copy+CopyType.exp-1,!0)?this.challenge_count>0?!0:void 0:!1},e.prototype.setExp=function(t){this.exp=t},e.prototype.getExp=function(){return this.exp},e.prototype.addKillNum=function(){CopyProxy.ins().isTeamExp(GameLogic.ins().getCurSceneId())&&(this.monster_num=this.monster_num+1)},e.prototype.getKillCount=function(){return this.monster_num},e.prototype.AddExp=function(t){if(CopyProxy.ins().isTeamExp(GameLogic.ins().getCurSceneId())){var e=0;if(0!=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.ZHIZUN)){var i=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.ZHIZUN);e+=i.add_exp/100}if(0!=PrivilegeProxy.ins().getPrivilegeState(PrivilegeType.BOJIN)){var n=GlobalConfig.getSpecial_rightsConfig(PrivilegeType.BOJIN);e+=n.add_exp/100}if(this.isGuWu){var o=GlobalConfig.getTeamcopy_baseConfig(1);e+=o.guwu_add}var s=t*e/100;this.add_exp=this.add_exp+s,TipsControl.ins().showExpTips(Math.floor(t+s),Math.floor(e)),this.setExp(this.getExp()+t+s)}},e}(BaseSystem);__reflect(CopyTeamProxy.prototype,"CopyTeamProxy");var DailyTaskProxy=function(t){function e(){var e=t.call(this)||this;return e.step=0,e.left_num=1,e.recover_num=0,e.next_recover_time=0,e.loop_award=0,e.cur_star=1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"todayStep",{get:function(){return this.step},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftNum",{get:function(){return this.left_num},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recoverNum",{get:function(){return this.recover_num},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRecoverTime",{get:function(){return this.next_recover_time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGetLoopAward",{get:function(){return 1==this.loop_award?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curStar",{get:function(){return this.cur_star},enumerable:!0,configurable:!0}),e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25205,this.S2CRepTaskGetDailyTaskInfo,this),MsgHandle.ins().regNetMsg(25206,this.S2CRepTaskUpdateDailyTask,this),MsgHandle.ins().regNetMsg(25207,this.S2CRepTaskDailyTaskCopyResult,this)},e.prototype.C2SReqTaskGetDailyTaskInfo=function(){var t=new net_protocol.C2SReqTaskGetDailyTaskInfo;this.sendPbPack(Msg.C2SReqTaskGetDailyTaskInfo,t,net_protocol.C2SReqTaskGetDailyTaskInfo)},e.prototype.C2SReqTaskDailyTaskOper=function(t){var e=new net_protocol.C2SReqTaskDailyTaskOper;e.opt=t,this.sendPbPack(Msg.C2SReqTaskDailyTaskOper,e,net_protocol.C2SReqTaskDailyTaskOper)},e.prototype.S2CRepTaskGetDailyTaskInfo=function(t){CommonUtils.log("S2CRepTaskGetDailyTaskInfo");var e=net_protocol.S2CRepTaskGetDailyTaskInfo.decode(t.bytes);this.step=e.step,this.left_num=e.left_num,this.recover_num=e.recover_num,this.next_recover_time=e.next_recover_time,this.loop_award=e.loop_award,this.cur_star=e.cur_star,EventProxy.Broast(EventType.S2CRepTaskGetDailyTaskInfo,[])},e.prototype.S2CRepTaskUpdateDailyTask=function(t){CommonUtils.log("S2CRepTaskUpdateDailyTask");var e=net_protocol.S2CRepTaskUpdateDailyTask.decode(t.bytes);this.cur_star=e.cur_star,EventProxy.Broast(EventType.S2CRepTaskUpdateDailyTask,[])},e.prototype.S2CRepTaskDailyTaskCopyResult=function(t){CommonUtils.log("S2CRepTaskUpdateDailyTask");var e=net_protocol.S2CRepTaskDailyTaskCopyResult.decode(t.bytes);this.left_num--;var i=1==e.result?!0:!1;i&&this.step++,EventProxy.Broast(EventType.S2CRepTaskDailyTaskCopyResult,[i,e.star])},e}(BaseSystem);__reflect(DailyTaskProxy.prototype,"DailyTaskProxy");var EquipSwallowProxy=function(t){function e(){var e=t.call(this)||this;return e.list=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGrowupEquipSwallowGetInfo=function(){var t=new net_protocol.C2SReqGrowupEquipSwallowGetInfo;this.sendPbPack(Msg.C2SReqGrowupEquipSwallowGetInfo,t,net_protocol.C2SReqGrowupEquipSwallowGetInfo)},e.prototype.C2SReqGrowupEquipSwallowOper=function(t){var e=new net_protocol.C2SReqGrowupEquipSwallowOper;e.type=t,this.sendPbPack(Msg.C2SReqGrowupEquipSwallowOper,e,net_protocol.C2SReqGrowupEquipSwallowOper)},e.prototype.S2CRepGrowupEquipSwallowGetInfo=function(t){var e=net_protocol.S2CRepGrowupEquipSwallowGetInfo.decode(t.bytes);this.list=[];for(var i in e.list)this.list[e.list[i].type]=e.list[i].count;EventProxy.Broast(EventType.S2CRepGrowupEquipSwallowGetInfo,{})},e.prototype.GetCurSwallowCount=function(t){return this.list[t]||0},e.prototype.GetCurCanSwallowCount=function(t){var e=GlobalConfig.getEquip_swallow_dataConfig(t),i=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),n=0;for(var o in e)i>=e[o].zhuan&&(n=Math.max(e[o].count,n));return n},e.prototype.GetNextSwallowInfo=function(t){var e=GlobalConfig.getEquip_swallow_dataConfig(t),i=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),n=-1;for(var o in e)i<e[o].zhuan&&-1==n&&(n=e[o].zhuan);return-1==n&&(n=1),e[n]},e.prototype.getRedByType=function(t){if(!SystemOpenProxy.ins().isOpen(2,7600+t,!0))return!1;var e=GlobalConfig.getEquip_swallow_item_dataConfig(t);return e&&BagProxy.ins().getItemCountById(e.item_id)>0&&this.GetCurCanSwallowCount(t)>this.GetCurSwallowCount(t)?!0:!1},e.prototype.getRed=function(){for(var t=1;3>t;t++)if(this.getRedByType(t))return!0;return!1},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(27628,this.S2CRepGrowupEquipSwallowGetInfo,this)},e}(BaseSystem);__reflect(EquipSwallowProxy.prototype,"EquipSwallowProxy");var FabaoProxy=function(t){function e(){var e=t.call(this)||this;return e.lv_list=[],e.redlist=[],e.suit_list=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqFabaoGetInfo=function(){var t=new net_protocol.C2SReqFabaoGetInfo;this.sendPbPack(Msg.C2SReqFabaoGetInfo,t,net_protocol.C2SReqFabaoGetInfo)},e.prototype.C2SReqFabaoUpgrade=function(t){var e=new net_protocol.C2SReqFabaoUpgrade;e.id=t,this.sendPbPack(Msg.C2SReqFabaoUpgrade,e,net_protocol.C2SReqFabaoUpgrade)},e.prototype.C2SReqFabaoFabaoSuitUpgrade=function(t){var e=new net_protocol.C2SReqFabaoFabaoSuitUpgrade;e.id=t,this.sendPbPack(Msg.C2SReqFabaoFabaoSuitUpgrade,e,net_protocol.C2SReqFabaoFabaoSuitUpgrade)},e.prototype.S2CRepFabaoGetInfo=function(t){var e=net_protocol.S2CRepFabaoGetInfo.decode(t.bytes);this.lv_list=[],this.magic=e.jingjie.magic,this.level=e.jingjie.level;for(var i=0;i<e.list.length;i++)this.lv_list[e.list[i].id]=e.list[i].level;this.fight=0;for(var n in this.lv_list){var o=this.lv_list[n],s=GlobalConfig.getFabaoById(parseInt(n),o);s&&(this.fight+=UtilProxy.GetAttrFight(s))}for(var n in e.suit_list)this.suit_list[e.suit_list[n].id]=e.suit_list[n].level;this.updateRedList(),EventProxy.Broast(EventType.S2CRepFabaoGetInfo,[])},e.prototype.S2CRepFabaoUpdateFabao=function(t){var e=net_protocol.S2CRepFabaoUpdateFabao.decode(t.bytes);this.lv_list[e.info.id]=e.info.level,this.fight=0;for(var i in this.lv_list){var n=this.lv_list[i],o=GlobalConfig.getFabaoById(parseInt(i),n);o&&(this.fight+=UtilProxy.GetAttrFight(o))}this.updateRedList(),XiuXianProxy.ins().updateAchieRed(AchieType.fabao_num),EventProxy.Broast(EventType.S2CRepFabaoUpdateFabao,[e.info.id,e.info.level])},e.prototype.S2CRepFabaoUpdateJingjie=function(t){var e=net_protocol.S2CRepFabaoUpdateJingjie.decode(t.bytes);this.magic=e.jingjie.magic,this.level=e.jingjie.level,EventProxy.Broast(EventType.S2CRepFabaoUpdateJingjie,[])},e.prototype.S2CRepFabaoFabaoSuitUpgrade=function(t){var e=net_protocol.S2CRepFabaoFabaoSuitUpgrade.decode(t.bytes);this.suit_list[e.id]=e.level,EventProxy.Broast(EventType.S2CRepFabaoFabaoSuitUpgrade,[1==e.level]),EventProxy.Broast(EventType.FbUpdateRed,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25800,this.S2CRepFabaoGetInfo,this),MsgHandle.ins().regNetMsg(25801,this.S2CRepFabaoUpdateFabao,this),MsgHandle.ins().regNetMsg(25802,this.S2CRepFabaoUpdateJingjie,this),MsgHandle.ins().regNetMsg(25815,this.S2CRepFabaoFabaoSuitUpgrade,this)},e.prototype.getFabaoLv=function(t){return this.lv_list[t]||0},e.prototype.getMagicValue=function(){return this.magic||0},e.prototype.getJjLv=function(){return this.level||0},e.prototype.getFight=function(){return this.fight||0},e.prototype.getListById=function(t){if(void 0==this.fb_list||0==this.fb_list.length){this.fb_list=[];var e=GlobalConfig.getFabaoTypeList();for(var i in e){var n=e[i];this.fb_list[n.color]||(this.fb_list[n.color]=[]),this.fb_list[n.color].push(n.id)}}return this.fb_list[t]},e.prototype.getList=function(t,e){if(void 0==this.fb_list||0==this.fb_list.length){this.fb_list={};var i=GlobalConfig.getFabaoTypeList();for(var n in i){var o=i[n];this.fb_list[o.type]||(this.fb_list[o.type]={}),this.fb_list[o.type][o.page]||(this.fb_list[o.type][o.page]=[]),this.fb_list[o.type][o.page].push(o.id)}}return this.fb_list[t][e]},e.prototype.getActiveNumByColor=function(t){var e=0,i=GlobalConfig.getFabaoTypeList();for(var n in i){var o=i[n];this.getFabaoLv(o.id)>0&&o.color>=t&&(e+=1)}return e},e.prototype.updateRedList=function(){this.redlist=[];var t=GlobalConfig.getFabaoTypeList();for(var e in t){var i=t[e];this.redlist[i.id]=this.getRedByFabaoId(i.id)}EventProxy.Broast(EventType.FbUpdateRed,[])},e.prototype.getRedById=function(t){return this.redlist[t]},e.prototype.getRedByFabaoId=function(t){var e=this.getFabaoLv(t),i=GlobalConfig.getFabaoById(t,e+1);if(i){var n=i.item[1],o=BagProxy.ins().getItemCountById(i.item[0]),s=i.item_replace>0?BagProxy.ins().getItemCountById(i.item_replace):0;if(o+s>=n)return!0}return!1},e.prototype.getRedByMenuId=function(t,e){for(var i=this.fb_list[t][e],n=0;n<i.length;n++){var o=i[n];if(this.getRedById(o))return!0}return!1},e.prototype.getRedByType=function(t){var e=this.fb_list[t];for(var i in e)for(var n=e[i],o=0;o<n.length;o++){var s=n[o];if(this.getRedById(s))return!0}return!1},e.prototype.getRed=function(){if(void 0==this.redlist||0==this.redlist.length)return!1;if(!SystemOpenProxy.ins().isOpen(1,34,!0))return!1;for(var t in this.redlist)if(this.redlist[t])return!0;return this.getSuitRed()?!0:!1},e.prototype.GetSuitLevel=function(t){return this.suit_list[t]||0},e.prototype.GetSuitList=function(t){var e=GlobalConfig.getFabao_suit_dataList(),i=[];for(var n in e)e[n][1].type==t&&i.push(e[n][1]);
return i},e.prototype.GetSuitState=function(t){var e=this.GetSuitLevel(t)+1,i=GlobalConfig.getFabao_suit_dataConfigById(t,e);if(void 0==i)return 2;for(var n in i.fabao_list)if(this.getFabaoLv(i.fabao_list[n][0])<i.fabao_list[n][1])return 1;return 0},e.prototype.GetSuitRedByType=function(t){var e=this.GetSuitList(t);for(var i in e)if(0==this.GetSuitState(e[i].id))return!0;return!1},e.prototype.getSuitRed=function(){if(!SystemOpenProxy.ins().isOpen(1,70,!0))return!1;for(var t=1;4>=t;t++)if(this.GetSuitRedByType(t))return!0;return!1},e.prototype.GetSuitTotlePro=function(){var t={};for(var e in this.suit_list)if(this.suit_list[e]&&this.suit_list[e]>0){var i=GlobalConfig.getFabao_suit_dataConfigById(Number(e),this.suit_list[e]);t=RoleProxy.ins().getTableAdd(t,i)}return t},e.prototype.GetSuitTotleFight=function(){var t=0;for(var e in this.suit_list)if(this.suit_list[e]&&this.suit_list[e]>0){var i=GlobalConfig.getFabao_suit_dataConfigById(Number(e),this.suit_list[e]);t+=UtilProxy.GetAttrFight(i)}return t},e}(BaseSystem);__reflect(FabaoProxy.prototype,"FabaoProxy");var S2CBattleTopObj=function(){function t(){}return t}();__reflect(S2CBattleTopObj.prototype,"S2CBattleTopObj");var S2CBattleCommonObj=function(){function t(){}return t}();__reflect(S2CBattleCommonObj.prototype,"S2CBattleCommonObj");var S2CBattleRankObj=function(){function t(){}return t}();__reflect(S2CBattleRankObj.prototype,"S2CBattleRankObj");var FacFightProxy=function(t){function e(){var e=t.call(this)||this;return e.top_list=[],e.award_list=[],e.zhenchuan_list=[],e.list=[],e.remain_award=0,e.remain_zhenchuan=0,e.left_challenge_times=0,e.buy_challenge_times=0,e.mobai_count=0,e.is_open=0,e.next_time=0,e.win_count=0,e.rank=0,e.IsAotu=!1,e.prof=0,e.name="",e.next_recover_time=0,e.IsShowRed=!0,e.IsShowPush=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqFactionGetLeaderBattleInfo=function(){var t=new net_protocol.C2SReqFactionGetLeaderBattleInfo;this.sendPbPack(Msg.C2SReqFactionGetLeaderBattleInfo,t,net_protocol.C2SReqFactionGetLeaderBattleInfo)},e.prototype.C2SReqFactionGetBattleRanklist=function(){var t=new net_protocol.C2SReqFactionGetBattleRanklist;this.sendPbPack(Msg.C2SReqFactionGetBattleRanklist,t,net_protocol.C2SReqFactionGetBattleRanklist)},e.prototype.C2SReqFactionSetAutoMatch=function(t){var e=new net_protocol.C2SReqFactionSetAutoMatch;e.opt=t,this.sendPbPack(Msg.C2SReqFactionSetAutoMatch,e,net_protocol.C2SReqFactionSetAutoMatch)},e.prototype.C2SReqFactionBattleChallenge=function(){var t=new net_protocol.C2SReqFactionBattleChallenge;this.sendPbPack(Msg.C2SReqFactionBattleChallenge,t,net_protocol.C2SReqFactionBattleChallenge)},e.prototype.C2SReqFactionMoBai=function(t){var e=new net_protocol.C2SReqFactionMoBai;e.index=t,this.sendPbPack(Msg.C2SReqFactionMoBai,e,net_protocol.C2SReqFactionMoBai)},e.prototype.C2SReqFactionGiveBattleAward=function(t){var e=new net_protocol.C2SReqFactionGiveBattleAward;e.role_id=t,this.sendPbPack(Msg.C2SReqFactionGiveBattleAward,e,net_protocol.C2SReqFactionGiveBattleAward)},e.prototype.C2SReqFactionSetZhenChuan=function(t,e){var i=new net_protocol.C2SReqFactionSetZhenChuan;i.opt=t,i.role_id=e,this.sendPbPack(Msg.C2SReqFactionSetZhenChuan,i,net_protocol.C2SReqFactionSetZhenChuan)},e.prototype.C2SReqFactionBuyChallenge=function(t){var e=new net_protocol.C2SReqFactionBuyChallenge;e.num=t,this.sendPbPack(Msg.C2SReqFactionBuyChallenge,e,net_protocol.C2SReqFactionBuyChallenge)},e.prototype.S2CRepFactionGetLeaderBattleInfo=function(t){var e=net_protocol.S2CRepFactionGetLeaderBattleInfo.decode(t.bytes);this.remain_award=e.remain_award,this.remain_zhenchuan=e.remain_zhenchuan,this.left_challenge_times=e.left_challenge_times,this.buy_challenge_times=e.buy_challenge_times,this.mobai_count=e.mobai_count,this.is_open=e.is_open,this.next_time=e.next_time,this.win_count=e.win_count,this.top_list=[];for(var i=0;i<e.top_list.length;i++){var n=e.top_list[i];this.top_list[n.index]=n}this.award_list=[];for(var i=0;i<e.award_list.length;i++){var o=e.award_list[i];this.award_list.push(o)}this.zhenchuan_list=[];for(var i=0;i<e.zhenchuan_list.length;i++){var s=e.zhenchuan_list[i];this.zhenchuan_list.push(s)}this.next_recover_time=e.next_recover_time||0,EventProxy.Broast(EventType.S2CRepFactionGetLeaderBattleInfo,{}),EventProxy.Broast(EventType.XiuXianUpdate,{}),this.IsShowPush&&(TimerManager.ins().remove(this.ShowFFpushTips,this),TimerManager.ins().doTimer(6e4,1,this.ShowFFpushTips,this),this.IsShowPush=!1)},e.prototype.ShowFFpushTips=function(){EventProxy.Broast(EventType.FacFightPushTips,["宗主争夺正在进行中"])},e.prototype.S2CRepFactionGetBattleRanklist=function(t){var e=net_protocol.S2CRepFactionGetBattleRanklist.decode(t.bytes);this.list=[];for(var i=0;i<e.list.length;i++){var n=e.list[i];this.list.push(n)}this.list.sort(this.sort),this.rank=e.rank,EventProxy.Broast(EventType.S2CRepFactionGetBattleRanklist,{})},e.prototype.sort=function(t,e){return t.rank<e.rank?-1:t.rank>e.rank?1:0},e.prototype.S2CRepFactionSetAutoMatch=function(t){net_protocol.S2CRepFactionSetAutoMatch.decode(t.bytes);EventProxy.Broast(EventType.S2CRepFactionSetAutoMatch,{})},e.prototype.S2CRepFactionBattleChallenge=function(t){var e=net_protocol.S2CRepFactionBattleChallenge.decode(t.bytes);0==e.code?(this.left_challenge_times=this.left_challenge_times-1,this.prof=e.prof,this.name=e.name,this.left_challenge_times<=0&&(this.IsAotu=!1),EventProxy.Broast(EventType.S2CRepFactionBattleChallenge,{})):1==e.code?(this.IsAotu=!1,ViewManager.ins().close(PipeiView)):2==e.code&&(this.IsAotu=!1,ViewManager.ins().close(PipeiView))},e.prototype.S2CRepFactionBattleChallengeResult=function(t){var e=net_protocol.S2CRepFactionBattleChallengeResult.decode(t.bytes),i=[];i=0==e.result?GlobalConfig.getLeader_battle_base_dataConfig(1).win_award:GlobalConfig.getLeader_battle_base_dataConfig(1).win_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |\n当前净胜场数：@1 ",[this.name,e.win_count]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!\n当前净胜场数：@1 ",[this.name,e.win_count]),ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.ZMZD,a),this.win_count=e.win_count,EventProxy.Broast(EventType.S2CRepFactionBattleChallengeResult,{})},e.prototype.S2CRepFactionMoBai=function(t){var e=net_protocol.S2CRepFactionMoBai.decode(t.bytes);this.top_list[e.index]&&(this.top_list[e.index].mobai_count=e.mobai_count),EventProxy.Broast(EventType.S2CRepFactionMoBai,{})},e.prototype.S2CRepFactionUpdateTopobjInfo=function(t){var e=net_protocol.S2CRepFactionUpdateTopobjInfo.decode(t.bytes);this.top_list=[];for(var i=0;i<e.top_list.length;i++){var n=e.top_list[i];this.top_list[n.index]=n}EventProxy.Broast(EventType.S2CRepFactionUpdateTopobjInfo,{})},e.prototype.S2CRepFactionUpdateBattleAward=function(t){var e=net_protocol.S2CRepFactionUpdateBattleAward.decode(t.bytes);this.award_list=[];for(var i=0;i<e.award_list.length;i++){var n=e.award_list[i];this.award_list.push(n)}this.remain_award=e.remain_award,EventProxy.Broast(EventType.S2CRepFactionUpdateBattleAward,{})},e.prototype.S2CRepFactionUpdateZhenChuan=function(t){var e=net_protocol.S2CRepFactionUpdateZhenChuan.decode(t.bytes);this.zhenchuan_list=[];for(var i=0;i<e.zhenchuan_list.length;i++){var n=e.zhenchuan_list[i];this.zhenchuan_list.push(n)}this.remain_zhenchuan=e.remain_zhenchuan,EventProxy.Broast(EventType.S2CRepFactionUpdateZhenChuan,{})},e.prototype.S2CRepFactionUpdateChallengeInfo=function(t){var e=net_protocol.S2CRepFactionUpdateChallengeInfo.decode(t.bytes);this.left_challenge_times=e.left_challenge_times,this.buy_challenge_times=e.buy_challenge_times,this.mobai_count=e.mobai_count,this.is_open=e.is_open,this.next_time=e.next_time,this.next_recover_time=e.next_recover_time||0,EventProxy.Broast(EventType.S2CRepFactionUpdateChallengeInfo,{}),EventProxy.Broast(EventType.XiuXianUpdate,{})},e.prototype.S2CRepFactionNotifyTopRankChange=function(t){var e=net_protocol.S2CRepFactionNotifyTopRankChange.decode(t.bytes),i=["掌门","首座","护法"];EventProxy.Broast(EventType.FacFightPushTips,["您的"+i[e.index-1]+"被抢夺了"])},e.prototype.getTopDate=function(t){return this.top_list[t]?this.top_list[t]:void 0},e.prototype.HasGetAward=function(t,e){for(var i in this.award_list)if(this.award_list[i].role_id==t&&this.award_list[i].server_id==e)return!0;return!1},e.prototype.IsZhengchuang=function(t,e){for(var i in this.zhenchuan_list)if(this.zhenchuan_list[i].role_id==t&&this.zhenchuan_list[i].server_id==e)return!0;return!1},e.prototype.IsMonsignor=function(t){return this.top_list[1]&&this.top_list[1].role_id==t?!0:!1},e.prototype.getCurIndexByRoleId=function(t){for(var e in this.top_list)if(this.top_list[e].role_id==t)return this.top_list[e].index;return 0},e.prototype.getCurIndexName=function(t){var e=GlobalConfig.getLeader_battle_title_dataConfig(t);return e?""+FacProxy.ins().getFacName()+e.desc:""},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,15,!0)?this.IsShowRed?!0:1==e.ins().is_open&&e.ins().next_time>GameLogic.ins().getServerTime()&&this.left_challenge_times>0:!1},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25604,this.S2CRepFactionGetLeaderBattleInfo,this),MsgHandle.ins().regNetMsg(25605,this.S2CRepFactionGetBattleRanklist,this),MsgHandle.ins().regNetMsg(25606,this.S2CRepFactionSetAutoMatch,this),MsgHandle.ins().regNetMsg(25607,this.S2CRepFactionBattleChallenge,this),MsgHandle.ins().regNetMsg(25608,this.S2CRepFactionBattleChallengeResult,this),MsgHandle.ins().regNetMsg(25609,this.S2CRepFactionMoBai,this),MsgHandle.ins().regNetMsg(25610,this.S2CRepFactionUpdateTopobjInfo,this),MsgHandle.ins().regNetMsg(25611,this.S2CRepFactionUpdateBattleAward,this),MsgHandle.ins().regNetMsg(25612,this.S2CRepFactionUpdateZhenChuan,this),MsgHandle.ins().regNetMsg(25613,this.S2CRepFactionUpdateChallengeInfo,this),MsgHandle.ins().regNetMsg(25614,this.S2CRepFactionNotifyTopRankChange,this)},e}(BaseSystem);__reflect(FacFightProxy.prototype,"FacFightProxy");var FacProxy=function(t){function e(){var e=t.call(this)||this;return e.send_member_req_time=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqFactionGetInfo=function(){var t=new net_protocol.C2SReqFactionGetInfo;this.sendPbPack(Msg.C2SReqFactionGetInfo,t,net_protocol.C2SReqFactionGetInfo)},e.prototype.C2SReqFactionJoin=function(t){var e=new net_protocol.C2SReqFactionJoin;e.faction_id=t,this.sendPbPack(Msg.C2SReqFactionJoin,e,net_protocol.C2SReqFactionJoin)},e.prototype.C2SReqFactionContribute=function(t){var e=new net_protocol.C2SReqFactionContribute;e.op=t,this.sendPbPack(Msg.C2SReqFactionContribute,e,net_protocol.C2SReqFactionContribute)},e.prototype.C2SReqFactionGetMemberList=function(){var t=new net_protocol.C2SReqFactionGetMemberList;this.sendPbPack(Msg.C2SReqFactionGetMemberList,t,net_protocol.C2SReqFactionGetMemberList)},e.prototype.S2CRepFactionGetInfo=function(t){var e=net_protocol.S2CRepFactionGetInfo.decode(t.bytes);this.recommend_id=e.recommend_id,this.faction_id=e.faction_id,this.coin_times=e.coin_times,this.yuanbao_times=e.yuanbao_times,this.has_leader=e.has_leader,this.leader_info=e.leader_info,EventProxy.Broast(EventType.S2CRepFactionGetInfo,[])},e.prototype.S2CRepFactionJoin=function(t){var e=net_protocol.S2CRepFactionJoin.decode(t.bytes);this.faction_id=e.faction_id,this.checkSendReqMb(),EventProxy.Broast(EventType.S2CRepFactionJoin,[])},e.prototype.S2CRepFactionContribute=function(t){var e=net_protocol.S2CRepFactionContribute.decode(t.bytes);if(1==e.result)1==e.op?this.coin_times=e.count:this.yuanbao_times=e.count;else{var i=1==e.op?"货币不足":"捐献次数不足";TipsControl.ins().showTips(i)}EventProxy.Broast(EventType.S2CRepFactionContribute,[])},e.prototype.S2CRepFactionGetMemberList=function(t){var e=net_protocol.S2CRepFactionGetMemberList.decode(t.bytes),i=e.infos;this.member_list=i,EventProxy.Broast(EventType.S2CRepFactionGetMemberList,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25600,this.S2CRepFactionGetInfo,this),MsgHandle.ins().regNetMsg(25601,this.S2CRepFactionJoin,this),MsgHandle.ins().regNetMsg(25602,this.S2CRepFactionContribute,this),MsgHandle.ins().regNetMsg(25603,this.S2CRepFactionGetMemberList,this)},e.prototype.hasLeader=function(){return this.has_leader>0},e.prototype.getFacId=function(){return this.faction_id||0},e.prototype.getRecommonedId=function(){return this.recommend_id||1},e.prototype.getCoinTmes=function(){return this.coin_times||0},e.prototype.getYuanbaoTimes=function(){return this.yuanbao_times||0},e.prototype.getMemberList=function(){return this.member_list||[]},e.prototype.getMainRoleId=function(){return 0},e.prototype.getFacName=function(){return this.faction_id>0&&GlobalConfig.getFaction_dataConfig(this.faction_id)?GlobalConfig.getFaction_dataConfig(this.faction_id).faction_name:"无"},e.prototype.checkSendReqMb=function(){CommonUtils.log("打印一下时间:",this.send_member_req_time,TimerManager.ins().getCurrTime()),this.faction_id>0&&(0==this.send_member_req_time||TimerManager.ins().getCurrTime()-this.send_member_req_time>18e5)&&(this.send_member_req_time=TimerManager.ins().getCurrTime(),this.C2SReqFactionGetMemberList())},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,14,!0)?this.getJxRed():!1},e.prototype.getJxRed=function(){var t=GlobalConfig.getFacMisc(),i=e.ins().getCoinTmes(),n=e.ins().getYuanbaoTimes();return t.coin_contribute_num>i||t.yb_contribute_num>n},e}(BaseSystem);__reflect(FacProxy.prototype,"FacProxy");var FacMemberItem=function(){function t(){}return t}();__reflect(FacMemberItem.prototype,"FacMemberItem");var GameSystem;!function(t){t.facProxy=FacProxy.ins.bind(FacProxy)}(GameSystem||(GameSystem={}));var FwProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqFuwenGetInfo=function(){var t=new net_protocol.C2SReqFuwenGetInfo;this.sendPbPack(Msg.C2SReqFuwenGetInfo,t,net_protocol.C2SReqFuwenGetInfo)},e.prototype.C2SReqFuwenInlayFuwen=function(t,e){var i=new net_protocol.C2SReqFuwenInlayFuwen;i.item_index=t,i.grid_index=e,this.sendPbPack(Msg.C2SReqFuwenInlayFuwen,i,net_protocol.C2SReqFuwenInlayFuwen)},e.prototype.C2SReqFuwenUpgradeFuwen=function(t){var e=new net_protocol.C2SReqFuwenUpgradeFuwen;e.grid_index=t,this.sendPbPack(Msg.C2SReqFuwenUpgradeFuwen,e,net_protocol.C2SReqFuwenUpgradeFuwen)},e.prototype.C2SReqFuwenResolveFuwen=function(t){var e=new net_protocol.C2SReqFuwenResolveFuwen;e.index_list=t,this.sendPbPack(Msg.C2SReqFuwenResolveFuwen,e,net_protocol.C2SReqFuwenResolveFuwen)},e.prototype.C2SReqFuwenHoleStrengthen=function(t){var e=new net_protocol.C2SReqFuwenHoleStrengthen;e.grid_index=t,this.sendPbPack(Msg.C2SReqFuwenHoleStrengthen,e,net_protocol.C2SReqFuwenHoleStrengthen)},e.prototype.C2SReqFuwenCompose=function(t,e,i){var n=new net_protocol.C2SReqFuwenCompose;n.id=t,n.color=e,n.index_list=i,this.sendPbPack(Msg.C2SReqFuwenCompose,n,net_protocol.C2SReqFuwenCompose)},e.prototype.S2CRepFuwenGetInfo=function(t){var e=net_protocol.S2CRepFuwenGetInfo.decode(t.bytes);this.isInit=!0,this.inlay_list=[],this.hole_list=[],this.bag_list=[],this.bag_list2=[],this.cur_exp=e.cur_exp,this.unlock_size=e.grid_info.unlock_size;for(var i=0;i<e.grid_info.inlay_list.length;i++){var n=e.grid_info.inlay_list[i];this.inlay_list[n.index]=n}for(var i=0;i<e.grid_info.hole_list.length;i++){var n=e.grid_info.hole_list[i];this.hole_list[n.index]=n.level}this.max_size=e.bag_info.max_size;for(var i=0;i<e.bag_info.list.length;i++){var n=e.bag_info.list[i];this.bag_list.push(n),this.bag_list2[n.index]=n}this.updateInlayRed(),this.updateUpgradeRed(),this.updateResolveRed(),this.udpateComposeRed(),EventProxy.Broast(EventType.S2CRepFuwenGetInfo,[]),this.getUpgradeItems(),this.getComposeItems()},e.prototype.S2CRepFuwenUpdateUnlock=function(t){var e=net_protocol.S2CRepFuwenUpdateUnlock.decode(t.bytes);this.unlock_size=e.unlock_size,this.updateInlayRed(),EventProxy.Broast(EventType.S2CRepFuwenUpdateUnlock,[])},e.prototype.S2CRepFuwenUpdateGrid=function(t){var e=net_protocol.S2CRepFuwenUpdateGrid.decode(t.bytes);this.inlay_list[e.item.index]=e.item,this.updateInlayRed(),XiuXianProxy.ins().updateAchieRed(AchieType.fuwen_num),EventProxy.Broast(EventType.S2CRepFuwenUpdateGrid,[])},e.prototype.S2CRepFuwenUpdateBag=function(t){for(var e=net_protocol.S2CRepFuwenUpdateBag.decode(t.bytes),i=0;i<e.list.length;i++){var n=e.list[i];if(2==n.opt){for(var o=0;o<this.bag_list.length;o++)if(this.bag_list[o].index==n.item.index){this.bag_list.splice(o,1);break}this.bag_list2[n.item.index]=void 0}else this.bag_list.push(n.item),this.bag_list2[n.item.index]=n.item}this.updateInlayRed(),this.updateResolveRed(),this.udpateComposeRed(),EventProxy.Broast(EventType.S2CRepFuwenUpdateBag,[])},e.prototype.S2CRepFuwenUpdateEssence=function(t){var e=net_protocol.S2CRepFuwenUpdateEssence.decode(t.bytes);e.cur_exp>this.cur_exp&&TipsControl.ins().showTips("C:8&剑心精华|x"+(e.cur_exp-this.cur_exp)),this.cur_exp=e.cur_exp,this.updateInlayRed(),EventProxy.Broast(EventType.S2CRepFuwenUpdateEssence,[])},e.prototype.S2CRepFuwenUpdateHole=function(t){var e=net_protocol.S2CRepFuwenUpdateHole.decode(t.bytes);this.hole_list[e.info.index]=e.info.level,this.updateUpgradeRed(),EventProxy.Broast(EventType.S2CRepFuwenUpdateHole,[e.info.index])},e.prototype.S2CRepFuwenResolveFuwen=function(t){var e=net_protocol.S2CRepFuwenResolveFuwen.decode(t.bytes);0==e.code?EventProxy.Broast(EventType.S2CRepFuwenResolveFuwen,[]):TipsControl.ins().showTips("C:4&服务返回分解失败")},e.prototype.S2CRepFuwenCompose=function(t){var e=net_protocol.S2CRepFuwenCompose.decode(t.bytes);0==e.code?EventProxy.Broast(EventType.S2CRepFuwenCompose,[]):TipsControl.ins().showTips("C:4&服务返回融合失败")},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(28e3,this.S2CRepFuwenGetInfo,this),MsgHandle.ins().regNetMsg(28001,this.S2CRepFuwenUpdateUnlock,this),MsgHandle.ins().regNetMsg(28002,this.S2CRepFuwenUpdateGrid,this),MsgHandle.ins().regNetMsg(28003,this.S2CRepFuwenUpdateBag,this),MsgHandle.ins().regNetMsg(28004,this.S2CRepFuwenUpdateEssence,this),MsgHandle.ins().regNetMsg(28005,this.S2CRepFuwenUpdateHole,this),MsgHandle.ins().regNetMsg(28006,this.S2CRepFuwenResolveFuwen,this),MsgHandle.ins().regNetMsg(28007,this.S2CRepFuwenCompose,this)},e.prototype.getHoleById=function(t){return this.hole_list[t]||0},e.prototype.getUnlockCopyId=function(t){if(!this.copy_list){this.copy_list=[];var e=GlobalConfig.getfwLockList();for(var i in e)for(var n=e[i],o=0,s=n.pos_list;o<s.length;o++){var r=s[o];this.copy_list[r]=parseInt(i)}}return this.copy_list[t]||0},e.prototype.isPosActive=function(t){return t<=this.unlock_size},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,36,!0)?this.Inlay_red||this.upgrade_red||this.resolve_red||this.compose_red:!1},e.prototype.getInlayRed=function(){return this.compose_red},e.prototype.getResolveRed=function(){return this.resolve_red},e.prototype.getUpgradeRed=function(){return this.upgrade_red},e.prototype.getComposeRed=function(){return this.compose_red},e.prototype.getFightNum=function(){var t=0,i=e.ins().inlay_list;for(var n in i)if(n){var o=i[n],s=GlobalConfig.getfwBaseById(o.id,o.color,o.level),r=e.ins().getHoleById(parseInt(n)),a=GlobalConfig.getfwHoleById(parseInt(n),r);t+=s&&a?UtilProxy.GetAttrFight(s,a.attr_per,a.attr_value):UtilProxy.GetAttrFight(s)}return t},e.prototype.getRedByInlayId=function(t){if(this.unlock_size<t)return!1;var e=[];for(var i in this.inlay_list)e[this.inlay_list[i].id]=!0;var n=this.inlay_list[t];if(n){var o=GlobalConfig.getfwBaseById(n.id,n.color,n.level+1);if(o&&this.cur_exp>=o.cost_exp)return!0;for(var s=0;s<this.bag_list.length;s++){var r=this.bag_list[s],a=GlobalConfig.getfwBaseById(r.id,r.color,r.level);if(r&&a&&a.inlay>0&&n.id==r.id&&r.color>n.color)return!0}}else for(var s=0;s<this.bag_list.length;s++){var r=this.bag_list[s],a=GlobalConfig.getfwBaseById(r.id,r.color,r.level);if(r&&a&&a.inlay>0&&void 0==e[r.id])return!0}return!1},e.prototype.getRedByUpgradeId=function(t){var e=this.inlay_list[t];if(e){var i=this.getHoleById(t),n=GlobalConfig.getfwHoleById(t,i+1);if(n){for(var o=0;o<n.item.length;o++){var s=n.item[o];if(BagProxy.ins().getItemCountById(s[0])<s[1])return!1}return!0}}return!1},e.prototype.getRedByCpId=function(t,e){var i=GlobalConfig.getfwCompById(t,e);if(i){for(var n=0;n<i.cost_item.length;n++)if(BagProxy.ins().getItemCountById(i.cost_item[n][0])<i.cost_item[n][1])return!1;for(var o=0,s=0,n=0;n<this.bag_list.length;n++){var r=this.bag_list[n];if(r&&r.color==i.color&&(0==o&&r.id==i.cost_fuwen[0]&&(o=r.index),0==s&&r.id==i.cost_fuwen[1]&&r.index!=o&&(s=r.index)),o>0&&s>0)return!0}}return!1},e.prototype.updateInlayRed=function(){for(var t=0;t<this.unlock_size;t++)if(this.getRedByInlayId(t+1))return this.Inlay_red=!0,void EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()]);this.Inlay_red=!1,EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()])},e.prototype.updateUpgradeRed=function(){for(var t=0;t<this.unlock_size;t++)if(this.getRedByUpgradeId(t+1))return this.upgrade_red=!0,void EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()]);this.upgrade_red=!1,EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()])},e.prototype.updateResolveRed=function(){for(var t=[],e=0;e<this.bag_list.length;e++){var i=this.bag_list[e];t[i.id]?t[i.id].color<i.color&&(t[i.id]=i):t[i.id]=i}for(var e=0;e<this.bag_list.length;e++){var i=this.bag_list[e];if(i&&void 0==t[i.id])return this.resolve_red=!0,void EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()])}this.resolve_red=!1,EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()])},e.prototype.udpateComposeRed=function(){var t=GlobalConfig.getfwCompList();for(var e in t)for(var i in t[e])if(this.getRedByCpId(parseInt(e),parseInt(i)))return this.compose_red=!0,void EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()]);this.compose_red=!1,EventProxy.Broast(EventType.FwUpdateRed,[this.getRed()])},e.prototype.getUpgradeItems=function(){if(!this.upgrade_items){this.upgrade_items=[];var t=GlobalConfig.getfwHoleList();for(var e in t)for(var i in t[e])for(var n=t[e][i],o=0;o<n.item.length;o++)this.upgrade_items[n.item[o][0]]=!0}return this.upgrade_items},e.prototype.getComposeItems=function(){if(!this.compose_items){this.compose_items=[];var t=GlobalConfig.getfwCompList();for(var e in t)for(var i in t[e])for(var n=t[e][i],o=0;o<n.cost_item.length;o++)this.compose_items[n.cost_item[o][0]]=!0}return this.compose_items},e.prototype.getPreviewList=function(){if(!this.preview_list){this.preview_list=[];var t=[],e=GlobalConfig.getfwPreList();for(var i in e){var n=e[i];for(var o in n){var s=n[o];t[s.lv]||(t[s.lv]=[]),t[s.lv].push(s)}}for(var i in t){var s={};s.list=t[i],s.lv=i,this.preview_list.push(s)}this.preview_list.sort(function(t,e){return t.lv-e.lv})}return this.preview_list},e.prototype.getMenuList=function(){if(!this.menu_list){this.menu_list=[];var t=GlobalConfig.getfwCompList();for(var e in t)this.menu_list.push(parseInt(e))}return this.menu_list},e.prototype.getSubMenuList=function(t){if(!this.sub_menu_list){this.sub_menu_list=[];for(var e=GlobalConfig.getfwCompList(),i=this.getMenuList(),n=0;n<i.length;n++){var o=i[n],s=e[o];this.sub_menu_list[o]=[];for(var r in s)this.sub_menu_list[o].push(s[r])}}return this.sub_menu_list[t]},e.prototype.getFwIcon=function(t,e){var i=GlobalConfig.getfwResById(t,e);return void 0!=i?i.icon:"暂无数据"},e.prototype.getFwName=function(t){var e=GlobalConfig.getfwNameById(t);return void 0!=e?e.name:"暂无数据"},e.prototype.getJxNumByColor=function(t){var e=this.inlay_list||[],i=0;for(var n in e){var o=e[n];o.color>=t&&(i+=1)}return i},e.prototype.getSubBagCount=function(){return this.max_size-this.bag_list.length},e}(BaseSystem);__reflect(FwProxy.prototype,"FwProxy");var GameSystem;!function(t){t.fwProxy=FwProxy.ins.bind(FwProxy)}(GameSystem||(GameSystem={}));var GMProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGmCmd=function(t){var e=new net_protocol.C2SReqGmCmd;e.cmd=t,this.sendPbPack(Msg.C2SReqGmCmd,e,net_protocol.C2SReqGmCmd)},e}(BaseSystem);__reflect(GMProxy.prototype,"GMProxy");var GodEquipProxy=function(t){function e(){var e=t.call(this)||this;return e.suit_list=[],e.forge_suit_list=[],e.godforgeList=[],e.CurType=0,e.god_soul_list=[],e.IsShowReds=[!0,!0,!0],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGodequipGetInfo=function(){var t=new net_protocol.C2SReqGodequipGetInfo;this.sendPbPack(Msg.C2SReqGodequipGetInfo,t,net_protocol.C2SReqGodequipGetInfo)},e.prototype.C2SReqGodequipMake=function(t,e){var i=new net_protocol.C2SReqGodequipMake;i.part=t,i.equip_id=e,this.sendPbPack(Msg.C2SReqGodequipMake,i,net_protocol.C2SReqGodequipMake)},e.prototype.C2SReqGodequipSuit=function(t,e){var i=new net_protocol.C2SReqGodequipSuit;i.god_type=t,i.suit_id=e,this.sendPbPack(Msg.C2SReqGodequipSuit,i,net_protocol.C2SReqGodequipSuit)},e.prototype.C2SReqGodequipForge=function(t){var e=new net_protocol.C2SReqGodequipForge;e.part=t,this.sendPbPack(Msg.C2SReqGodequipForge,e,net_protocol.C2SReqGodequipForge)},e.prototype.C2SReqGodequipForgeSuit=function(t,e){var i=new net_protocol.C2SReqGodequipForgeSuit;i.god_type=t,i.suit_id=e,this.sendPbPack(Msg.C2SReqGodequipForgeSuit,i,net_protocol.C2SReqGodequipForgeSuit)},e.prototype.C2SReqGodequipSoulUpLevel=function(t){var e=new net_protocol.C2SReqGodequipSoulUpLevel;e.part=t,this.sendPbPack(Msg.C2SReqGodequipSoulUpLevel,e,net_protocol.C2SReqGodequipSoulUpLevel)},e.prototype.S2CRepGodequipGetInfo=function(t){var e=net_protocol.S2CRepGodequipGetInfo.decode(t.bytes);this.godforgeList=[];for(var i=0;i<e.list.length;i++)void 0!=e.list[i].part&&(this.godforgeList[e.list[i].part]=e.list[i].level);this.suit_list=[];for(var i=0;i<e.suit_list.length;i++)this.suit_list[e.suit_list[i].god_type]=e.suit_list[i].suit_id;this.forge_suit_list=[];for(var i=0;i<e.forge_suit_list.length;i++)this.forge_suit_list[e.forge_suit_list[i].god_type]=e.forge_suit_list[i].suit_id;this.god_soul_list=[];for(var i=0;i<e.god_soul_list.length;i++)void 0!=e.god_soul_list[i].part&&(this.god_soul_list[e.god_soul_list[i].part]=e.god_soul_list[i].level);EventProxy.Broast(EventType.S2CRepGodequipGetInfo,{}),EventProxy.Broast(EventType.UpdateGodEquipRed,{})},e.prototype.S2CRepGodequipMake=function(t){net_protocol.S2CRepGodequipMake.decode(t.bytes);EventProxy.Broast(EventType.S2CRepGodequipMake,{}),EventProxy.Broast(EventType.UpdateGodEquipRed,{})},e.prototype.S2CRepGodequipSuit=function(t){var e=net_protocol.S2CRepGodequipSuit.decode(t.bytes);this.suit_list[e.god_type]=e.suit_id,EventProxy.Broast(EventType.S2CRepGodequipSuit,{}),EventProxy.Broast(EventType.UpdateGodEquipRed,{})},e.prototype.S2CRepGodequipForge=function(t){var e=net_protocol.S2CRepGodequipForge.decode(t.bytes);this.godforgeList[e.part]=e.level,EventProxy.Broast(EventType.S2CRepGodequipForge,{}),EventProxy.Broast(EventType.UpdateGodEquipRed,{})},e.prototype.S2CRepGodequipForgeSuit=function(t){var e=net_protocol.S2CRepGodequipForgeSuit.decode(t.bytes);this.forge_suit_list[e.god_type]=e.suit_id,EventProxy.Broast(EventType.S2CRepGodequipForgeSuit,{}),EventProxy.Broast(EventType.UpdateGodEquipRed,{})},e.prototype.S2CRepGodequipSoulUpLevel=function(t){var e=net_protocol.S2CRepGodequipSoulUpLevel.decode(t.bytes);this.god_soul_list[e.part]=e.level,EventProxy.Broast(EventType.S2CRepGodequipSoulUpLevel,{}),EventProxy.Broast(EventType.UpdateGodEquipRed,{})},e.prototype.getNextGodEquipId=function(t,e){var i,n=GlobalConfig.getGodMakeConfig();for(var o in n)if(i=n[o],i.need_equip==t&&i.part==e)return i.id;return 0},e.prototype.getGodEquipLevelCount=function(t,e){for(var i=0,n=11+10*t,o=20+10*t,s=n;o>=s;s++){var r=BagProxy.ins().getBodyEquipByPart(s);if(r){var a=GlobalConfig.getEquipmentConfig(r.item_type_id);a&&a.god_order>=e&&(i+=1)}}return i},e.prototype.getGodForgeLevelByPart=function(t){return this.godforgeList[t]||0},e.prototype.getGodSoulLevelByPart=function(t){return this.god_soul_list[t]||0},e.prototype.getGodSuitId=function(t){return this.suit_list[t]||0},e.prototype.getGodForgeSuitId=function(t){return this.forge_suit_list[t]||0},e.prototype.getGodForgeLevelCount=function(t,e){for(var i=0,n=11+10*t,o=20+10*t,s=n;o>=s;s++)this.getGodForgeLevelByPart(s)>=e&&(i+=1);return i},e.prototype.getGodForgeSuitFight=function(t){var i=e.ins().getGodForgeSuitId(t),n=GlobalConfig.getGod_forge_suit_dataConfig(t,i);return UtilProxy.GetAttrFight(n)},e.prototype.getGodForgeFight=function(t){var i=e.ins().getGodForgeLevelByPart(t),n=GlobalConfig.getGod_forge_dataConfig(t)[i];return UtilProxy.GetAttrFight(n)},e.prototype.getGodSoulFight=function(t){var i=e.ins().getGodSoulLevelByPart(t),n=GlobalConfig.getGod_soul_dataConfig(t)[i],o=BagProxy.ins().getBodyEquipByPart(t),s=0;if(n&&o){var r=o.itemConfig;s=UtilProxy.GetAttrFight(r,n.attr_per)-UtilProxy.GetAttrFight(r)}return s},e.prototype.getGodSuitFight=function(t){var i=e.ins().getGodSuitId(t),n=GlobalConfig.getGod_item_suitConfig(t,i);return UtilProxy.GetAttrFight(n)},e.prototype.getCurCanUp=function(t){var i=BagProxy.ins().getBodyEquipByPart(t),n=i?i.item_type_id:0,o=e.ins().getNextGodEquipId(n,t),s=GlobalConfig.getGod_make_dataConfig(o);if(void 0==s)return!1;var r=BagProxy.ins().getItemCountById(s.items[0][0]);if(r<s.items[0][1])return!1;if(s.part>=41&&s.part<=50){var a=GlobalConfig.getEquipmentConfig(o);if(RoleProxy.ins().getRoleLv()<a.requiredlevel||RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)<a.reborn)return!1}return!0},e.prototype.getCurCanShenzhu=function(t){var i=e.ins().getGodForgeLevelByPart(t)+1,n=GlobalConfig.getGod_forge_dataConfig(t)[i];if(void 0==n)return!1;var o=Math.floor((t-1)/10);if(n.god_suit_id>e.ins().getGodSuitId(o))return!1;var s=BagProxy.ins().getItemCountById(n.items[0]);return s<n.items[1]?!1:!0},e.prototype.getCurCanShenwen=function(t){if(!SystemOpenProxy.ins().isOpen(1,101,!0))return!1;var i=BagProxy.ins().getBodyEquipByPart(t);if(void 0==i||null==i)return!1;var n=e.ins().getGodSoulLevelByPart(t)+1,o=GlobalConfig.getGod_soul_dataConfig(t)[n];if(void 0==o||null==o)return!1;for(var s=0;s<o.items.length;s++){var r=BagProxy.ins().getItemCountById(o.items[s][0]);if(r<o.items[s][1])return!1}return!0},e.prototype.getCurTypeRed=function(t){if(!SystemOpenProxy.ins().isOpen(2,3300+t,!0))return!1;if(this.IsShowReds[t])return!0;for(var e=11+10*t,i=20+10*t,n=e;i>=n;n++)if(this.getCurCanUp(n)||this.getCurCanShenzhu(n)||this.getCurCanShenwen(n))return!0;return this.getGodSuitRed(t)?!0:this.getGodForgeSuitRed(t)?!0:!1},e.prototype.getGodForgeSuitRed=function(t){var i=GlobalConfig.getGod_forge_suit_dataConfig(t+1,this.getGodForgeSuitId(t+1)+1);if(void 0!=i){var n=e.ins().getGodForgeLevelCount(t,i.need_level);if(n>=10)return!0}return!1},e.prototype.getGodSuitRed=function(t){var i=GlobalConfig.getGod_item_suitConfig(t+1,this.getGodSuitId(t+1)+1);if(void 0!=i){var n=e.ins().getGodEquipLevelCount(t,i.need_level);if(n>=10)return!0}return!1},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(1,33,!0))return!1;for(var t=0;4>t;t++)if(this.getCurTypeRed(t))return!0;return!1},e.prototype.getTotleFight=function(){for(var t=0,i=0;4>i;i++){for(var n=BagProxy.ins().getGodEquipInfo(i),o=0;o<n.length;o++){var s=BagProxy.ins().getItemData(n[o].item_type_id);t=t+UtilProxy.GetAttrFight(s)+e.ins().getGodForgeFight(n[o].item_slot_idx)+e.ins().getGodSoulFight(n[o].item_slot_idx)}t=t+e.ins().getGodSuitFight(i+1)+e.ins().getGodForgeSuitFight(i+1)}return t},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27850,this.S2CRepGodequipGetInfo,this),MsgHandle.ins().regNetMsg(27851,this.S2CRepGodequipMake,this),MsgHandle.ins().regNetMsg(27852,this.S2CRepGodequipSuit,this),MsgHandle.ins().regNetMsg(27853,this.S2CRepGodequipForge,this),MsgHandle.ins().regNetMsg(27854,this.S2CRepGodequipForgeSuit,this),MsgHandle.ins().regNetMsg(27855,this.S2CRepGodequipSoulUpLevel,this)
},e}(BaseSystem);__reflect(GodEquipProxy.prototype,"GodEquipProxy");var S2CFashionInfo=function(){function t(){this.id=0,this.grade=0,this.fight=0,this.swallow=0,this.level=0}return t}();__reflect(S2CFashionInfo.prototype,"S2CFashionInfo");var GrowupProxy=function(t){function e(){var e=t.call(this)||this;return e.venation_list=[],e.fashion_list=[],e.fashion_wear=0,e.fuyin_list=[],e.fuyin_suit_list=[],e.tujian_list=[],e.tujian_suit_list=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGrowupInfo=function(){var t=new net_protocol.C2SReqGrowupInfo;this.sendPbPack(Msg.C2SReqGrowupInfo,t,net_protocol.C2SReqGrowupInfo)},e.prototype.C2SReqGrowupVenationUpgrade=function(t){var e=new net_protocol.C2SReqGrowupVenationUpgrade;e.type=t,this.sendPbPack(Msg.C2SReqGrowupVenationUpgrade,e,net_protocol.C2SReqGrowupVenationUpgrade)},e.prototype.C2SReqGrowupFashionUpgrade=function(t,e,i){void 0===i&&(i=0);var n=new net_protocol.C2SReqGrowupFashionUpgrade;n.id=t,n.type=e,3==e&&(n.index=i),this.sendPbPack(Msg.C2SReqGrowupFashionUpgrade,n,net_protocol.C2SReqGrowupFashionUpgrade)},e.prototype.C2SReqGrowupFashionSwallow=function(t,e){var i=new net_protocol.C2SReqGrowupFashionSwallow;i.id=t,i.opt=e,this.sendPbPack(Msg.C2SReqGrowupFashionSwallow,i,net_protocol.C2SReqGrowupFashionSwallow)},e.prototype.C2SReqGrowupFashionWear=function(t,e){var i=new net_protocol.C2SReqGrowupFashionWear;i.id=t,i.opt=e,this.sendPbPack(Msg.C2SReqGrowupFashionWear,i,net_protocol.C2SReqGrowupFashionWear)},e.prototype.C2SReqGrowupFuyinUpgrade=function(t){var e=new net_protocol.C2SReqGrowupFuyinUpgrade;e.id=t,this.sendPbPack(Msg.C2SReqGrowupFuyinUpgrade,e,net_protocol.C2SReqGrowupFuyinUpgrade)},e.prototype.C2SReqGrowupFuyinSuitUpgrade=function(t){var e=new net_protocol.C2SReqGrowupFuyinSuitUpgrade;e.id=t,this.sendPbPack(Msg.C2SReqGrowupFuyinSuitUpgrade,e,net_protocol.C2SReqGrowupFuyinSuitUpgrade)},e.prototype.C2SReqGrowupTujianUpgrade=function(t){var e=new net_protocol.C2SReqGrowupTujianUpgrade;e.id=t,this.sendPbPack(Msg.C2SReqGrowupTujianUpgrade,e,net_protocol.C2SReqGrowupTujianUpgrade)},e.prototype.C2SReqGrowupTujianSuitActivate=function(t){var e=new net_protocol.C2SReqGrowupTujianSuitActivate;e.id=t,this.sendPbPack(Msg.C2SReqGrowupTujianSuitActivate,e,net_protocol.C2SReqGrowupTujianSuitActivate)},e.prototype.getMaxVenLv=function(){if(!this.venation_list)return 0;var t=0;for(var e in this.venation_list){var i=this.venation_list[e];i>t&&(t=i)}return t},e.prototype.S2CRepGrowupInfo=function(t){var e=net_protocol.S2CRepGrowupInfo.decode(t.bytes);this.venation_list=[];for(var i=0;i<e.venation_list.length;i++){var n=e.venation_list[i].type,o=e.venation_list[i].level;this.venation_list[n]=o}this.fashion_list=[];for(var i=0;i<e.fashion_list.length;i++){var s=new S2CFashionInfo;s.id=e.fashion_list[i].id,s.grade=e.fashion_list[i].grade,s.fight=e.fashion_list[i].fight,s.swallow=e.fashion_list[i].swallow,s.level=e.fashion_list[i].level,this.fashion_list[s.id]=s}this.fashion_wear=e.fashion_wear,this.fuyin_list=[];for(var i=0;i<e.fuyin_list.length;i++)this.fuyin_list[e.fuyin_list[i].id]=e.fuyin_list[i].level;this.fuyin_suit_list=[];for(var i=0;i<e.fuyin_suit_list.length;i++)this.fuyin_suit_list[e.fuyin_suit_list[i].id]=e.fuyin_suit_list[i].level;this.tujian_list=[];for(var i=0;i<e.tujian_list.length;i++)this.tujian_list[e.tujian_list[i].id]=e.tujian_list[i].level;this.tujian_suit_list=e.tujian_suit_list,VenationProxy.ins().updateRed(),RoleProxy.ins().setClothId(this.fashion_wear),GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,this.fashion_wear,AvatarType.FASHION),EventProxy.Broast(EventType.S2CRepGrowupInfo,{}),EventProxy.Broast(EventType.UpdateTaozhuangRed,[])},e.prototype.S2CRepGrowupVenationUpgrade=function(t){var e=net_protocol.S2CRepGrowupVenationUpgrade.decode(t.bytes);this.venation_list[e.type]=e.level,VenationProxy.ins().updateRed(),EventProxy.Broast(EventType.S2CRepGrowupVenationUpgrade,[e.level])},e.prototype.S2CRepGrowupFashionUpdate=function(t){var e=net_protocol.S2CRepGrowupFashionUpdate.decode(t.bytes),i=new S2CFashionInfo;i.id=e.info.id,i.grade=e.info.grade,i.fight=e.info.fight,i.swallow=e.info.swallow,i.level=e.info.level,void 0==this.fashion_list[e.info.id]&&(this.C2SReqGrowupFashionWear(e.info.id,0),ViewManager.ins().open(JihuoTipsView,JihuoType.Fashion,e.info.id)),this.fashion_list[e.info.id]=i;var n=BagProxy.ins().GetLVUpItem(LvUpType.emSZ,e.info.level);if(n){var o=n.itemConfig;o.flags<=e.info.level&&ViewManager.ins().open(ItemTipsView,n,!0,[LvUpType.emSZ,e.info.id])}EventProxy.Broast(EventType.S2CRepGrowupFashionUpdate,{}),EventProxy.Broast(EventType.UpdateFashionRed,{}),EventProxy.Broast(EventType.UpdateTaozhuangRed,{})},e.prototype.S2CRepGrowupFashionWear=function(t){var e=net_protocol.S2CRepGrowupFashionWear.decode(t.bytes);this.fashion_wear=e.fashion_wear,RoleProxy.ins().setClothId(this.fashion_wear),GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,this.fashion_wear,AvatarType.FASHION),EventProxy.Broast(EventType.S2CRepGrowupFashionWear,{})},e.prototype.S2CRepGrowupFuyinUpgrade=function(t){var e=net_protocol.S2CRepGrowupFuyinUpgrade.decode(t.bytes);this.fuyin_list[e.info.id]=e.info.level,EventProxy.Broast(EventType.S2CRepGrowupFuyinUpgrade,{}),EventProxy.Broast(EventType.UpdateFuyinRed,{})},e.prototype.S2CRepGrowupFuyinSuitUpgrade=function(t){var e=net_protocol.S2CRepGrowupFuyinSuitUpgrade.decode(t.bytes);this.fuyin_suit_list[e.info.id]=e.info.level,EventProxy.Broast(EventType.S2CRepGrowupFuyinSuitUpgrade,{}),EventProxy.Broast(EventType.UpdateFuyinRed,{})},e.prototype.S2CRepGrowupTujianUpgrade=function(t){var e=net_protocol.S2CRepGrowupTujianUpgrade.decode(t.bytes);-1==this.getTujianLevel(e.id)&&ViewManager.ins().open(JihuoTipsView,JihuoType.tujian,e.id),this.tujian_list[e.id]=e.level,XiuXianProxy.ins().updateAchieRed(AchieType.tujian_num),EventProxy.Broast(EventType.S2CRepGrowupTujianUpgrade,{})},e.prototype.S2CRepGrowupTujianSuitActivate=function(t){var e=net_protocol.S2CRepGrowupTujianSuitActivate.decode(t.bytes);this.tujian_suit_list.push(e.id),EventProxy.Broast(EventType.S2CRepGrowupTujianSuitActivate,{})},e.prototype.getFashion=function(t){return this.fashion_list[t]},e.prototype.getFashionSwallow=function(t){var e=GlobalConfig.getFashion_swallow_dataConfig(t)[1];return this.getFashion(t)&&(e=GlobalConfig.getFashion_swallow_dataConfig(t)[this.getFashion(t).grade]),e.swallow},e.prototype.getFashionSwallowState=function(t){var i=e.ins().getFashion(t);if(void 0==i)return 3;var n=this.getFashionSwallow(t),o=i.swallow;return o>=n[1]?2:BagProxy.ins().getItemCountById(n[0])<=0?1:0},e.prototype.getFashionCanUp=function(t){var i=e.ins().getFashion(t);if(void 0==i)return 3;var n=(GlobalConfig.getFashion_base_dataConfig(t)[i.grade],GlobalConfig.getFashion_base_dataConfig(t)[i.grade+1]);return void 0==n?2:BagProxy.ins().getItemCountById(n.item[0])>=n.item[1]?0:1},e.prototype.getFashionGrowCanUp=function(t){var e=GlobalConfig.getFashion_grow_dataConfig(t,0),i=GlobalConfig.getFashion_grow_dataConfig(t,1);return this.getFashion(t)&&(e=GlobalConfig.getFashion_grow_dataConfig(t,this.getFashion(t).level),i=GlobalConfig.getFashion_grow_dataConfig(t,this.getFashion(t).level+1)),void 0==i?2:BagProxy.ins().GetHasLVUpItem(LvUpType.emSZ,e.level)?3:BagProxy.ins().getItemCountById(e.item[0])>=e.item[1]?0:1},e.prototype.GetFashionFight=function(){var t=GlobalConfig.getFashionListConfig(),i=0;for(var n in t){var o=t[n][1].id,s=e.ins().getFashion(o);if(s){var r=GlobalConfig.getFashion_grow_dataConfig(o,s.level),a=GlobalConfig.getFashion_base_dataConfig(o)[s.grade],h=e.ins().getFashionSwallow(o)[0];i=i+UtilProxy.GetAttrFight(r)+UtilProxy.GetAttrFight(a)+UtilProxy.GetAttrFight(GlobalConfig.getFashion_swallow_itemConfig(h))*s.swallow}}return i},e.prototype.getFashionRed=function(){var t=GlobalConfig.getFashionListConfig();for(var i in t)if(t[i][1]){var n=t[i][1].id;if(0==e.ins().getFashionSwallowState(n)||0==e.ins().getFashionCanUp(n)||0==e.ins().getFashionGrowCanUp(n)||3==e.ins().getFashionGrowCanUp(n))return!0}return!1},e.prototype.getFuyinLevel=function(t){return this.fuyin_list[t]?this.fuyin_list[t]:0},e.prototype.getFuyinSuitLevel=function(t){return this.fuyin_suit_list[t]?this.fuyin_suit_list[t]:0},e.prototype.getFuyinCanUp=function(t){var i=e.ins().getFuyinLevel(t),n=GlobalConfig.getFuyin_base_dataConfig(t)[i+1];return void 0==n?2:BagProxy.ins().getItemCountById(n.item[0])>=n.item[1]?0:1},e.prototype.getFuyinSuitCanUp=function(t){var i=e.ins().getFuyinSuitLevel(t),n=GlobalConfig.getFuyin_suit_dataConfig(t,i+1);return void 0==n?2:n.need_level>this.getCurTypeLevel(t)?3:BagProxy.ins().getItemCountById(n.item[0])>=n.item[1]?0:1},e.prototype.getCurTypeLevel=function(t){t-=1;for(var i=-1,n=1+4*t,o=4+4*t,s=n;o>=s;s++)-1==i&&(i=e.ins().getFuyinLevel(s)),i=Math.min(i,e.ins().getFuyinLevel(s));return i},e.prototype.GetFuyinFight=function(){for(var t=0,i=1;8>=i;i++){var n=e.ins().getFuyinLevel(i),o=GlobalConfig.getFuyin_base_dataConfig(i)[n];t+=UtilProxy.GetAttrFight(o)}for(var i=1;2>=i;i++){var n=e.ins().getFuyinSuitLevel(i),o=GlobalConfig.getFuyin_suit_dataConfig(i,n);t+=UtilProxy.GetAttrFight(o)}return t},e.prototype.getFuyinRed=function(){for(var t=1;8>=t;t++)if(0==e.ins().getFuyinCanUp(t))return!0;for(var t=1;2>=t;t++)if(0==this.getFuyinSuitCanUp(t))return!0;return!1},e.prototype.getFuyinRedByType=function(t){t-=1;for(var i=1+4*t,n=4+4*t,o=i;n>=o;o++)if(0==e.ins().getFuyinCanUp(o))return!0;return 0==this.getFuyinSuitCanUp(t+1)?!0:!1},e.prototype.getVenationlv=function(t){return this.venation_list[t]||0},e.prototype.getTujianLevel=function(t){return void 0!=this.tujian_list[t]?this.tujian_list[t]:-1},e.prototype.getTujianList=function(t,e){var i=GlobalConfig.getTujianList(),n=[];for(var o in i)i[o].type==t&&i[o].sub_type==e&&n.push(i[o]);return n.sort(this.sort),n},e.prototype.getTujianState=function(t){if(0==t||void 0==t)return 1;var i=e.ins().getTujianLevel(t),n=GlobalConfig.getTujian_dataConfig(t);if(n.level<=i)return 2;if(-1==i){var o=n.items,s=o[0]?o[0][0]:0,r=o[0]?o[0][1]:0,a=BagProxy.ins().getItemCountById(s);if(r>a)return 1}else{var o=n.level_items,h=n.general_items,s=o[0]?o[0][0]:0,l=h[0]?h[0][0]:0,r=o[0]?o[0][1]:0,p=h[0]?h[0][1]:0,a=BagProxy.ins().getItemCountById(s),c=BagProxy.ins().getItemCountById(l);if(r>a&&(0==c||p>c))return 1}return 0},e.prototype.sort=function(t,e){return t.id<e.id?-1:t.id>e.id?1:0},e.prototype.GetTujianFight=function(){var t=GlobalConfig.getTujianList(),e=0;for(var i in t){var n=this.getTujianLevel(t[i].id);-1!=n&&(e+=UtilProxy.GetAttrFight(this.GetTujianAtt(t[i].id,n)))}return e+=UtilProxy.GetAttrFight(this.getTujianSuitTotlePro())},e.prototype.GetTujianAtt=function(t,e){var i=GlobalConfig.getTujian_dataConfig(t),n=0;return e>0&&(n=100*e),AttrProxy.getAttrAddInfo(i,n)},e.prototype.getTujianActiveCountByType=function(t){var e=GlobalConfig.getTujianList(),i=0;for(var n in e){var o=this.getTujianLevel(e[n].id);-1!=o&&e[n].sub_type>=t&&(i+=1)}return i},e.prototype.getTujianRedByTypeAndSubType=function(t,e){var i=this.getTujianList(t,e);for(var n in i)if(0==this.getTujianState(i[n].id))return!0;return!1},e.prototype.getTujianRedByType=function(t){for(var e=1;3>=e;e++)if(this.getTujianRedByTypeAndSubType(t,e))return!0;return!1},e.prototype.getTujianRed=function(){if(!SystemOpenProxy.ins().isOpen(1,30,!0))return!1;for(var t=1;5>=t;t++)if(this.getTujianRedByType(t))return!0;return this.getTujianSuitRed()?!0:!1},e.prototype.getTujianSuitActiveNum=function(){return this.tujian_suit_list.length},e.prototype.getTujianSuitTotlePro=function(){var t={};for(var e in this.tujian_suit_list){var i=GlobalConfig.getTujian_suit_dataConfig(this.tujian_suit_list[e]);t=RoleProxy.ins().getTableAdd(t,i)}return t},e.prototype.getTujianSuitList=function(t){var e=GlobalConfig.getTujian_suit_dataList(),i=[];for(var n in e)e[n].type==t&&i.push(e[n]);return i.sort(this.sort),i},e.prototype.getTujianSuitState=function(t){if(this.IsTujianSuitActive(t))return 2;for(var e=GlobalConfig.getTujian_suit_dataConfig(t),i=0;i<e.tujian_list.length;i++)if(-1==this.getTujianLevel(e.tujian_list[i]))return 1;return 0},e.prototype.IsTujianSuitActive=function(t){for(var e in this.tujian_suit_list)if(t==this.tujian_suit_list[e])return!0;return!1},e.prototype.getTujianSuitRedByType=function(t){var e=this.getTujianSuitList(t);for(var i in e)if(0==this.getTujianSuitState(e[i].id))return!0;return!1},e.prototype.getTujianSuitRed=function(){for(var t=1;5>=t;t++)if(this.getTujianSuitRedByType(t))return!0;return!1},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27600,this.S2CRepGrowupInfo,this),MsgHandle.ins().regNetMsg(27601,this.S2CRepGrowupVenationUpgrade,this),MsgHandle.ins().regNetMsg(27602,this.S2CRepGrowupFashionUpdate,this),MsgHandle.ins().regNetMsg(27603,this.S2CRepGrowupFashionWear,this),MsgHandle.ins().regNetMsg(27604,this.S2CRepGrowupFuyinUpgrade,this),MsgHandle.ins().regNetMsg(27629,this.S2CRepGrowupFuyinSuitUpgrade,this),MsgHandle.ins().regNetMsg(27605,this.S2CRepGrowupTujianUpgrade,this),MsgHandle.ins().regNetMsg(27619,this.S2CRepGrowupTujianSuitActivate,this)},e}(BaseSystem);__reflect(GrowupProxy.prototype,"GrowupProxy");var GuideProxy=function(t){function e(){var e=t.call(this)||this;return e.step=0,e.guide_item_step_id=0,e.is_cur_guide_first=!1,e.isInit=!1,e.id_list=[],e.isCanGuide=!1,e._isGuide=!1,e.isNeedGuide=!0,e.lastGuideId=0,e.guideidList=[],e.isChecked=!1,e.isSimpleGuide=!1,e._curView="",e.isTest=!0,e.ex_skill_newhand_id=51,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(27606,this.S2CRepGrowupGetGuideInfo,this)},e.prototype.C2SReqGrowupGetGuideInfo=function(){var t=new net_protocol.C2SReqGrowupGetGuideInfo;CommonUtils.log("(*^*)C2SReqGrowupGetGuideInfo"),this.sendPbPack(Msg.C2SReqGrowupGetGuideInfo,t,net_protocol.C2SReqGrowupGetGuideInfo)},e.prototype.C2SReqGrowupUpdateGuide=function(t){var e=new net_protocol.C2SReqGrowupUpdateGuide;CommonUtils.log("(*^*)C2SReqGrowupUpdateGuide",t),t!=this.ex_skill_newhand_id&&(e.id=t,this.sendPbPack(Msg.C2SReqGrowupUpdateGuide,e,net_protocol.C2SReqGrowupUpdateGuide))},e.prototype.S2CRepGrowupGetGuideInfo=function(t){var e=net_protocol.S2CRepGrowupGetGuideInfo.decode(t.bytes);CommonUtils.log("(*^*)S2CRepGrowupGetGuideInfo(*^*)------------------------------->",e),this.S2CRepGrowupId=e.id,this.id_list=e.id_list,this.checkAllGuide(),EventProxy.Broast(EventType.S2CRepGrowupGetGuideInfo,[])},e.prototype.isGrowupId=function(t){if(this.S2CRepGrowupId>t)return!0;if(this.id_list)for(var e=0;e<this.id_list.length;++e)if(t==this.id_list[e])return!0;return!1},e.prototype.C2SReqMiscNewhandUpdate=function(t){var e=new net_protocol.C2SReqMiscNewhandUpdate;CommonUtils.log("(*^*)C2SReqHorseGetInfo"),e.index=t,this.sendPbPack(Msg.C2SReqMiscNewhandUpdate,e,net_protocol.C2SReqMiscNewhandUpdate)},e.prototype.S2CRepMiscNewhandUpdate=function(t){var e=net_protocol.S2CRepMiscNewhandUpdate.decode(t.bytes);this.newhand_list=e.newhand_list},e.prototype.showGuide=function(t,e,i){this.ui_view||(this.ui_view=new GuideUIView,this.ui_view.addToParent(LayerManager.UI_Guide)),CommonUtils.log("当前引导步骤----------（）（）（）---------->",this.guide_item_step_id),this.ui_view.visible=!0,this.guide_item_step_data=e,e||(this.isSimpleGuide=!0),this.current_view=i,e&&e.event_obj?this.setCurTarget(e.event_obj):this.setCurTarget(t),this.ui_view.show(t,e,this.current_view),this._isGuide=!0},e.prototype.getCurGuideId=function(){return this.cur_guide_id||0},e.prototype.getGuideState=function(){return this._isGuide},e.prototype.setCurTarget=function(t){this.cur_target=t},e.prototype.getCurTarget=function(){return this.cur_target},e.prototype.isGuideView=function(t){return this._curView==t},e.prototype.setCurView=function(t){this._curView=t},e.prototype.startCheck=function(){var t=this;TimerManager.ins().doTimer(500,1,function(){t.checkAllGuide()},this)},e.prototype.checkAllGuide=function(){ViewManager.ins().isShow(MainUIView)&&(e.ins().CheckGuideCache(1,TaskProxy.ins().taskMain.task_id),LyhProxy.ins().getCurId()>0&&e.ins().CheckGuideCache(2,LyhProxy.ins().getCurId()),TaskProxy.ins().taskMain&&1==TaskProxy.ins().taskMain.is_completed&&e.ins().CheckGuideCache(3,TaskProxy.ins().taskMain.task_id))},e.prototype.CheckGuideCache=function(t,i){if(void 0!=this.S2CRepGrowupId&&this.isCanGuide&&!UtilProxy.isOpenWelcome()&&t&&i&&GameLogic.ins().isMainScene()&&!ViewManager.ins().isOpenNotConst()){var n,o=GlobalConfig.getNewhandConfigs();for(var s in o){var r=o[s];r.condition.length>1&&r.condition[0]==t&&i==r.condition[1]&&(n=r)}!n||this.isGuidedById(n.id)||this.isGrowupId(n.id)||(this.DoGuideItem(n.id),this.guide_item&&this.guide_item.condition[0]&&this.guide_item.condition[0]==t&&(e.ins().setCurTarget(void 0),e.ins().ui_view&&e.ins().ui_view.Hide(),this.guide_item=void 0,this.guide_item_step_id=0,this.cur_guide_id=0,this._isGuide=!1),this.guide_item||this.DoNextGuide())}},e.prototype.clearData=function(){this.removeData(),this.ui_view&&(this.ui_view.removeFromParent(),this.ui_view=void 0),this.guide_list=void 0,this.S2CRepGrowupId=void 0},e.prototype.removeData=function(){e.ins().setCurTarget(void 0),e.ins().ui_view&&e.ins().ui_view.Hide(),this.guide_item=void 0,this.guide_item_step_id=0,this.isSimpleGuide=!1,this.cur_guide_id=0,this._isGuide=!1},e.prototype.DoGuideCopy=function(){this.DoGuideItem(this.ex_skill_newhand_id),ViewManager.ins().isOpenNotConst()||this.DoNextGuide()},e.prototype.isOpenGuideTip=function(){return 51==this.getCurrentGuideId()?!0:!1},e.prototype.isGuidedById=function(t){for(var e=0;e<this.guideidList.length;++e)if(this.guideidList[e]==t)return!0;return!1},e.prototype.DoGuideItem=function(t){var e=GlobalConfig.getNewhandConfig(t);this.guide_list||(this.guide_list=[]),this.guide_list.push(e)},e.prototype.removeGuide=function(t){if(this.guide_list)for(var e=this.guide_list.length,i=e-1;i>=0;i--)this.guide_list[i].condition[0]&&this.guide_list[i].condition[0]==t&&this.guide_list.splice(i,1)},e.prototype.DoNextGuide=function(){if(this.guide_list&&this.guide_list.length>0){this.guide_item=this.guide_list[0];var t=this.guide_item.id;if(this.cur_guide_id=t,this.guide_list.splice(0,1),this.guideidList.push(t),CommonUtils.log("当前引导id-------------------->",t),this.is_cur_guide_first=!0,this.guide_item.step.length>0){this.guide_item_step_id=this.guide_item.step[0];var e=this.GetStepData(this.guide_item_step_id);e.obj&&this.showGuide(e.obj,e,e.viewClass)}}},e.prototype.getCurrentGuideId=function(){return this.guide_item?this.guide_item.id:0},e.prototype.getLastGuideConfig=function(){return GlobalConfig.getNewhandConfig(this.lastGuideId)},e.prototype.GetStepData=function(t){var e=[],i=GlobalConfig.getNewhand_stepConfig(t),n=ViewManager.ins().getViewClass(i.view);if(n){var o=n[i.path];0==i.is_contain.length&&(e.obj=o),e.viewClass=n}e.dir=i.dir,e.view=i.view,e.view_path=i.path,e.name=i.path,e.btn_function=i.btn_function,e.btn_text=i.btn_text,e.isContain=i.is_contain.length>0,e.event_obj=void 0,e.send_end=i.send_end;return e.is_contain=i.is_contain,e},e.prototype.getCurrentStepData=function(){return this.guide_item_step_id>0?this.GetStepData(this.guide_item_step_id):void this.guide_item},e.prototype.CheckGuideView=function(t){var i=!1,n=e.ins().getCurrentStepData();if(n&&(n.is_contain.length>0||0==n.is_contain.length&&!n.obj)){var o=egret.getQualifiedClassName(t);if(n.view==o&&t[n.view_path])if(this.curStepView=t,this.isChecked=!0,n.is_contain.length>0){var s;if(!(t[n.view_path].numChildren>0))return i=!0;if(-1==n.is_contain[1]){for(var r=0;r<t[n.view_path].numChildren;++r){var a=t[n.view_path].getChildAt(r);if(FabaoProxy.ins().getRedById(a.data)){s=a;break}}s||(s=t[n.view_path].getChildAt(0))}else s=0==n.is_contain[1]?t[n.view_path][n.is_contain[3]]:t[n.view_path].getChildAt(n.is_contain[1]-1);n.is_contain.length>2?s[n.is_contain[3]]&&(0==n.is_contain[1]?(n.obj=t[n.view_path],n.event_obj=s):n.obj=s[n.is_contain[3]],this.showGuide(n.obj,n,s[n.is_contain[3]])):(n.obj=s,n.event_obj=t[n.view_path],this.showGuide(s,n,t))}else n.obj=t[n.view_path],n.viewClass=t,this.showGuide(t[n.view_path],n,t)}return i},e.prototype.getTargetName=function(){if(this.getCurTarget()){var t=this.GetStepData(this.guide_item_step_id);return t.name}return!1},e.prototype.IsFinish=function(t){if(this.newhand_list)for(var e=0;e<this.newhand_list.length;++e)if(this.newhand_list[e]==t)return!0;return!1},e.prototype.ResetDirList=function(t){for(var e=0;e<t.length;++e){var i=this.GetStepData(t[e]);i.state=!1,this.ShowDir(i)}},e.prototype.ShowDir=function(t){},e.prototype.onChangeStage=function(t){var i=e.ins().getCurTarget();i&&(t.currentTarget==i?(e.ins().ui_view.Hide(),e.ins().DoNextStep()):e.ins().isSimpleGuide&&e.ins().JumpCurrentData())},e.prototype.DoCurStep=function(){if(this.guide_item&&this.guide_item_step_id>0){var t=this.guide_item_step_data;if(!t)return;var e=t.btn_function,i=t.viewClass||this.curStepView;if(i){var n;if(this.guide_item_step_data.is_contain.length>0)if(2202==this.guide_item_step_id)n=new egret.Event(egret.TouchEvent.TOUCH_TAP),n.$currentTarget=i[t.view_path],n.$currentTarget.selectedIndex=this.guide_item_step_data.is_contain[1]-1,i[e](n);else{n=new egret.Event(eui.ItemTapEvent.ITEM_TAP);var o;o=1==this.guide_item_step_data.is_contain[1]?i[t.view_path].getChildAt(0):this.guide_item_step_data.obj,this.guide_item_step_data.is_contain.length>2?(n=new egret.Event(egret.TouchEvent.TOUCH_TAP),0==this.guide_item_step_data.is_contain[1]?(o=i[t.view_path],n.$currentTarget=o[t.is_contain[3]]):n.$currentTarget=o[t.is_contain[3]],o[e](n)):(n.$currentTarget=i[t.view_path],n.item=o.data,n.itemRenderer=o,i[e](n))}else n=new egret.Event(egret.TouchEvent.TOUCH_TAP),n.$currentTarget=i[t.view_path],i[e](n)}}},e.prototype.getcurrentTarget=function(){if(this.current_view){var t,i=e.ins().getCurrentStepData();return t=i.is_contain.length>2?i.is_contain[3]:i.view_path,this.current_view[t]}},e.prototype.DoNextStep=function(){var t=this;if(this.guide_item&&this.guide_item_step_id>0){this.is_cur_guide_first&&(this.is_cur_guide_first=!1),this.isChecked=!1;var i=this.GetStepData(this.guide_item_step_id);1==i.send_end&&this.C2SReqGrowupUpdateGuide(this.guide_item.id);for(var n=this.guide_item_step_id,o=0;o<this.guide_item.step.length;++o)if(this.guide_item.step[o]>n){n=this.guide_item.step[o];break}n>this.guide_item_step_id?(this.guide_item_step_id=n,TimerManager.ins().doTimer(200,1,function(){if(!t.isChecked&&0!=t.guide_item_step_id){var i,n=t.GetStepData(t.guide_item_step_id);egret.getQualifiedClassName(t.curStepView);if((n.viewClass||t.curStepView&&egret.getQualifiedClassName(t.curStepView)==n.view)&&(n.viewClass?i=n.viewClass:t.curStepView&&(i=t.curStepView)),n.is_contain.length>0&&void 0!=n.is_contain[1]&&0!=n.is_contain[1])n.obj=void 0,e.ins().ui_view.Hide();else if(i)if(void 0!=n.is_contain[1]&&0==n.is_contain[1]?n.obj=i&&i[n.view_path]?i[n.view_path][n.is_contain[3]]:void 0:n.obj=i?i[n.view_path]:void 0,n.obj)t.showGuide(n.obj,n,i);else{var o=function(){i&&i[n.view_path]&&(!n.is_contain[3]||n.is_contain[3]&&i[n.view_path][n.is_contain[3]])&&(i=ViewManager.ins().getView(n.view),void 0!=n.is_contain[1]&&0==n.is_contain[1]?n.obj=i&&i[n.view_path]?i[n.view_path][n.is_contain[3]]:void 0:n.obj=i?i[n.view_path]:void 0,this.showGuide(n.obj,n),TimerManager.ins().remove(o,this))};TimerManager.ins().doTimer(100,0,o,t),o()}else e.ins().ui_view.Hide()}},this)):(this.guide_item&&this.guideidList.push(this.guide_item.id),this.removeData(),this.DoNextGuide())}},e.prototype.JumpCurrentData=function(){e.ins().guide_item&&e.ins().guide_item.condition.length>0&&(e.ins().guideidList.push(this.guide_item.id),e.ins().C2SReqGrowupUpdateGuide(this.guide_item.id)),this.removeData()},e.prototype.breakCurrentData=function(){this.removeData()},e.prototype.isFinishStep=function(t){var e=GlobalConfig.getNewhand_stepConfig(t);return e?1==e.send_end:!1},e.prototype.RemoveFacGuide=function(){var t=FacProxy.ins().getFacId()>0;t&&this.guide_item&&16==this.guide_item.id&&(e.ins().setCurTarget(void 0),e.ins().ui_view&&e.ins().ui_view.Hide(),this.guide_item=void 0,this.guide_item_step_id=0,this.isSimpleGuide=!1,this.cur_guide_id=0,this._isGuide=!1,this.DoNextGuide())},e.prototype.guideById=function(t){this.isDuJieTask()&&(this.DoGuideItem(t),this.guide_item||this.DoNextGuide())},e.prototype.isDuJieTask=function(){var t=GlobalConfig.getTaskConfig(TaskProxy.ins().taskMain.task_id);return t&&47==t.unit_type?1==TaskProxy.ins().taskMain.is_completed?!1:XiuXianProxy.ins().dujie_lv>1?!1:1==XiuXianProxy.ins().dujie_lv&&XiuXianProxy.ins().dujie_min_lv>3?!1:!0:!1},e}(BaseSystem);__reflect(GuideProxy.prototype,"GuideProxy");var HuanxingHorseData=function(){function t(){}return t.prototype.setHuanxingData=function(t,e){this.id=t,this.type=e,1==e?this.config=GlobalConfig.getHorseGradeShowConfig(t):2==e&&(this.config=GlobalConfig.getHorseSkinConfig(t)[1])},t}();__reflect(HuanxingHorseData.prototype,"HuanxingHorseData");var HorseProxy=function(t){function e(){var e=t.call(this)||this;return e.fight=0,e.horseLimitId=0,e.horseLimitTime=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.GetExp=function(){return this.exp},e.prototype.C2SReqHorseGetInfo=function(){var t=new net_protocol.C2SReqHorseGetInfo;CommonUtils.log("(*^*)C2SReqHorseGetInfo"),this.sendPbPack(Msg.C2SReqHorseGetInfo,t,net_protocol.C2SReqHorseGetInfo)},e.prototype.C2SReqHorseOnekeyUpgrade=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new net_protocol.C2SReqHorseOnekeyUpgrade;CommonUtils.log("(*^*)C2SReqHorseOnekeyUpgrade"),1==t&&(i.type=t,i.index=e),this.sendPbPack(Msg.C2SReqHorseOnekeyUpgrade,i,net_protocol.C2SReqHorseOnekeyUpgrade)},e.prototype.C2SReqHorseActiveHuaxing=function(t){var e=new net_protocol.C2SReqHorseActiveHuaxing;e.id=t,CommonUtils.log("(*^*)C2SReqHorseActiveHuaxing",t),this.sendPbPack(Msg.C2SReqHorseActiveHuaxing,e,net_protocol.C2SReqHorseActiveHuaxing)},e.prototype.C2SReqHorseShenLian=function(t,e){var i=new net_protocol.C2SReqHorseShenLian;i.opt=t,i.type=e,this.sendPbPack(Msg.C2SReqHorseShenLian,i,net_protocol.C2SReqHorseShenLian)},e.prototype.C2SReqHorseSkillUpgrade=function(t){var e=new net_protocol.C2SReqHorseSkillUpgrade;e.skill_index=t,this.sendPbPack(Msg.C2SReqHorseSkillUpgrade,e,net_protocol.C2SReqHorseSkillUpgrade)},e.prototype.C2SReqHorseChangeShow=function(t,e){var i=new net_protocol.C2SReqHorseChangeShow;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqHorseChangeShow,i,net_protocol.C2SReqHorseChangeShow)},e.prototype.C2SReqHorseSkinExtendUpgrade=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=new net_protocol.C2SReqHorseSkinExtendUpgrade;n.id=t,1==e&&(n.type=e,n.index=i),this.sendPbPack(Msg.C2SReqHorseSkinExtendUpgrade,n,net_protocol.C2SReqHorseSkinExtendUpgrade)},e.prototype.S2CRepHorseGetInfo=function(t){var e=net_protocol.S2CRepHorseGetInfo.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^S2CRepHorseGetInfo",e),this.exp=e.exp,this.grade=e.grade,this.star=e.star,this.skill_list=e.skill_list,this.huaxing_list=e.huaxing_list,this.show=e.show,this.swallow_list=e.swallow_list,this.fight=e.fight,this.limit_skin_list=e.limit_skin_list,RoleProxy.ins().setMountId(e.show.id),GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.show.id,AvatarType.ZUOQI),EventProxy.Broast(EventType.S2CRepHorseGetInfo,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,[]),EventProxy.Broast(EventType.UpdateTaozhuangRed,{})},e.prototype.UseSwallowCount=function(t){if(void 0==this.swallow_list)return 0;for(var e=0;e<this.swallow_list.length;++e)if(this.swallow_list[e].type==t)return this.swallow_list[e].count;return 0},e.prototype.GetMaxSwallowCount=function(t){if(1==t){if(this.grade<=0&&this.star<=0)return 0;var e=Math.max(this.grade,1),i=0;for(var n in GlobalConfig.ins().horseGradeShowConfig)if(GlobalConfig.ins().horseGradeShowConfig[n].grade<=e)for(var o=0;o<GlobalConfig.ins().horseGradeShowConfig[n].max_swallow_count.length;++o)t==GlobalConfig.ins().horseGradeShowConfig[n].max_swallow_count[o][0]&&(i+=GlobalConfig.ins().horseGradeShowConfig[n].max_swallow_count[o][1]);if(this.huaxing_list)for(var o=0;o<this.huaxing_list.length;++o)if(this.huaxing_list[o].num>0&&GlobalConfig.getHorseSkinConfig(this.huaxing_list[o].id))for(var s=GlobalConfig.getHorseSkinConfig(this.huaxing_list[o].id)[this.huaxing_list[o].num.toString()],r=0;r<s.max_swallow_count.length;++r)t==s.max_swallow_count[r][0]&&(i+=s.max_swallow_count[r][1]);return i}if(2==t){var a=0;if(!this.huaxing_list)return 0;for(var o=0;o<this.huaxing_list.length;++o)a+=this.huaxing_list[o].num;if(0==a)return 0;var h=GlobalConfig.getConfig("horse_swallow_extend","horseSwallowExtendConfig"),l=0;for(var n in h)h[n].total_grade<a&&l<h[n].total_grade&&(l=h[n].total_grade);if(0==l)return 0;var p=GlobalConfig.getHorseSwallowExtendConfig(l);if(t==p.max_swallow_count[0])return p.max_swallow_count[1]}return 0},e.prototype.GetMaxSwallowCountByGrade=function(t,e){if(1==t){var i=0;for(var n in GlobalConfig.ins().horseGradeShowConfig)if(GlobalConfig.ins().horseGradeShowConfig[n].grade<=e)for(var o=0;o<GlobalConfig.ins().horseGradeShowConfig[n].max_swallow_count.length;++o)t==GlobalConfig.ins().horseGradeShowConfig[n].max_swallow_count[o][0]&&(i+=GlobalConfig.ins().horseGradeShowConfig[n].max_swallow_count[o][1]);if(this.huaxing_list)for(var o=0;o<this.huaxing_list.length;++o)if(this.huaxing_list[o].num>0&&GlobalConfig.getHorseSkinConfig(this.huaxing_list[o].id))for(var s=GlobalConfig.getHorseSkinConfig(this.huaxing_list[o].id)[this.huaxing_list[o].num.toString()],r=0;r<s.max_swallow_count.length;++r)t==s.max_swallow_count[r][0]&&(i+=s.max_swallow_count[r][1]);return i}if(2==t){var a=0;if(!this.huaxing_list)return 0;for(var o=0;o<this.huaxing_list.length;++o)a+=this.huaxing_list[o].num;var h=GlobalConfig.getConfig("horse_swallow_extend","horseSwallowExtendConfig"),l=0;for(var n in h)if(h[n].total_grade>a&&l<h[n].total_grade){l=h[n].total_grade;break}if(0==l)return 0;var p=GlobalConfig.getHorseSwallowExtendConfig(l);if(t==p.max_swallow_count[0])return p.max_swallow_count[1]}return 0},e.prototype.GetMaxSwallowCountById=function(t){GlobalConfig.ins().horseSwallowItemConfig||GlobalConfig.getConfig("horse_swallow_item","horseSwallowItemConfig");for(var e in GlobalConfig.ins().horseSwallowItemConfig)if(GlobalConfig.ins().horseSwallowItemConfig[e].item_id==t)return this.GetMaxSwallowCount(GlobalConfig.ins().horseSwallowItemConfig[e].type);return 0},e.prototype.GetUseCountById=function(t){GlobalConfig.ins().horseSwallowItemConfig||GlobalConfig.getConfig("horse_swallow_item","horseSwallowItemConfig");for(var e in GlobalConfig.ins().horseSwallowItemConfig)if(GlobalConfig.ins().horseSwallowItemConfig[e].item_id==t)return this.UseSwallowCount(GlobalConfig.ins().horseSwallowItemConfig[e].type);return 0},e.prototype.S2CRepHorseOnekeyUpgrade=function(t){var e=net_protocol.S2CRepHorseOnekeyUpgrade.decode(t.bytes);this.grade=e.grade,this.star=e.star,this.exp=e.exp;var i=(e.add_exp,1==e.is_crit);1==e.is_crit,XiuXianProxy.ins().updateAchieRed(AchieType.mount_level),XiuXianProxy.ins().updateAchieRed(AchieType.mount_star);var n=BagProxy.ins().GetLVUpItem(LvUpType.emZuoqi,e.grade);if(n){var o=n.itemConfig;o.flags<=e.grade&&ViewManager.ins().open(ItemTipsView,n,!0,[LvUpType.emZuoqi,0])}EventProxy.Broast(EventType.S2CRepHorseOnekeyUpgrade,[i]),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.S2CRepHorseActiveHuaxing=function(t){var e=net_protocol.S2CRepHorseActiveHuaxing.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^S2CRepHorseActiveHuaxing",e);var i=!1;if(void 0!=this.huaxing_list)for(var n=0;n<this.huaxing_list.length;++n)this.huaxing_list[n].id==e.huaxing.id&&(i=!0,this.huaxing_list[n]=e.huaxing);else this.huaxing_list=[];i||this.huaxing_list.push(e.huaxing),XiuXianProxy.ins().updateAchieRed(AchieType.mount_star),EventProxy.Broast(EventType.S2CRepHorseActiveHuaxing,[e.huaxing.id]),EventProxy.Broast(EventType.RefreshHuoBanRed,[]),EventProxy.Broast(EventType.UpdateTaozhuangRed,[])
},e.prototype.getHuaxingNum=function(t){if(void 0==this.huaxing_list)return 0;for(var e=0;e<this.huaxing_list.length;++e)if(this.huaxing_list[e].id==t)return this.huaxing_list[e].num;return 0},e.prototype.getHuaxingData=function(t){if(this.huaxing_list)for(var e=0;e<this.huaxing_list.length;++e)if(this.huaxing_list[e].id==t)return this.huaxing_list[e]},e.prototype.S2CRepHorseShenLian=function(t){var e=net_protocol.S2CRepHorseShenLian.decode(t.bytes),i=!1;if(void 0!=this.swallow_list)for(var n=0;n<this.swallow_list.length;++n)this.swallow_list[n].type==e.info.type&&(i=!0,this.swallow_list[n]=e.info);i||this.swallow_list.push(e.info),EventProxy.Broast(EventType.S2CRepHorseShenLian,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.S2CRepHorseSkillUpgrade=function(t){var e=net_protocol.S2CRepHorseSkillUpgrade.decode(t.bytes);CommonUtils.log("------------------------------------------------>>S2CRepHorseSkillUpgrade-->>",e);var i=!1;if(void 0!=this.skill_list)for(var n=0;n<this.skill_list.length;++n)this.skill_list[n].skill_index==e.skill.skill_index&&(i=!0,this.skill_list[n]=e.skill);i||this.skill_list.push(e.skill),EventProxy.Broast(EventType.S2CRepHorseSkillUpgrade,[e.skill.skill_index])},e.prototype.getSkillLevelById=function(t){if(void 0!=this.skill_list)for(var e=0;e<this.skill_list.length;++e)if(this.skill_list[e].skill_index==t)return this.skill_list[e].level;return 0},e.prototype.S2CRepHorseUpdateShow=function(t){var e=net_protocol.S2CRepHorseUpdateShow.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^S2CRepHorseUpdateShow",e),this.show=e.show,RoleProxy.ins().setMountId(e.show.id),GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.show.id,AvatarType.ZUOQI),EventProxy.Broast(EventType.S2CRepHorseUpdateShow,[e.show.id])},e.prototype.isHuanxingById=function(t){return void 0==this.show?!1:this.show.id==t?!0:!1},e.prototype.isHuanxingActive=function(t){var e=GlobalConfig.getHorseGradeShowConfig(t);if(void 0!=e)return e.grade<=this.grade?!0:!1;if(void 0==this.huaxing_list)return!1;for(var i=0;i<this.huaxing_list.length;++i)if(this.huaxing_list[i].id==t)return this.huaxing_list[i].level>0;return!1},e.prototype.S2CRepHorseFight=function(t){var e=net_protocol.S2CRepHorseFight.decode(t.bytes);this.fight=e.fight,EventProxy.Broast(EventType.S2CRepHorseFight,{})},e.prototype.getFight=function(){return this.fight||0},e.prototype.S2CRepHorseActiveLimitSkin=function(t){var e=net_protocol.S2CRepHorseActiveLimitSkin.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^S2CRepHorseActiveLimitSkin",e),this.limit_skin_list||(this.limit_skin_list=[]);for(var i=!1,n=0;n<this.limit_skin_list.length;++n)this.limit_skin_list[n].id==e.id&&(this.limit_skin_list[n].end_time=e.end_time,i=!0);i||this.limit_skin_list.push({id:e.id,end_time:e.end_time}),EventProxy.Broast(EventType.S2CRepHorseActiveLimitSkin,{})},e.prototype.S2CRepHorseRemoveLimitSkin=function(t){var e=net_protocol.S2CRepHorseRemoveLimitSkin.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^S2CRepHorseRemoveLimitSkin",e);var i=0;if(this.limit_skin_list){for(var n=0;n<this.limit_skin_list.length;++n)this.limit_skin_list[n].id==e.id&&(i=n);this.limit_skin_list.splice(i,1)}EventProxy.Broast(EventType.S2CRepHorseRemoveLimitSkin,{})},e.prototype.getHorseLimitLeftTime=function(t){if(this.limit_skin_list)for(var e=0;e<this.limit_skin_list.length;++e)if(this.limit_skin_list[e].id==t)return this.limit_skin_list[e].end_time-GameLogic.ins().getServerTime();return 0},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25650,this.S2CRepHorseGetInfo,this),MsgHandle.ins().regNetMsg(25651,this.S2CRepHorseOnekeyUpgrade,this),MsgHandle.ins().regNetMsg(25652,this.S2CRepHorseActiveHuaxing,this),MsgHandle.ins().regNetMsg(25653,this.S2CRepHorseShenLian,this),MsgHandle.ins().regNetMsg(25654,this.S2CRepHorseSkillUpgrade,this),MsgHandle.ins().regNetMsg(25655,this.S2CRepHorseUpdateShow,this),MsgHandle.ins().regNetMsg(25658,this.S2CRepHorseFight,this),MsgHandle.ins().regNetMsg(25659,this.S2CRepHorseActiveLimitSkin,this),MsgHandle.ins().regNetMsg(25660,this.S2CRepHorseRemoveLimitSkin,this)},e.prototype.isSkillDataOpen=function(t){return void 0==t?!1:t.grade<=this.grade?!0:!1},e.prototype.isSkillActive=function(t){if(this.skill_list)for(var e=0;e<this.skill_list.length;++e)if(this.skill_list[e].skill_index==t)return!0;return!1},e.prototype.getShowData=function(){var t=this.show;if(void 0==t||0==t.id)return{name:"",model_id:0,ui_model_path:"",icon:"",pos:[]};var e=t.id,i=GlobalConfig.getHorseGradeShowConfig(e);if(void 0!=i)return{name:i.name,model_id:i.model_id,ui_model_path:i.source,icon:i.icon,pos:i.pos};var n=0;if(void 0==this.huaxing_list)return{name:"",model_id:0,ui_model_path:"",icon:"",pos:[]};for(var o=0;o<this.huaxing_list.length;++o)this.huaxing_list[o].id==e&&(n=this.huaxing_list[o].num);var s=GlobalConfig.getHorse_skin_ex_dataConfig(e);return{name:s.name,model_id:s.model_id,ui_model_path:s.source,icon:s.icon,pos:s.pos}},e.prototype.getShowDataById=function(t){var e=GlobalConfig.getHorseGradeShowConfig(t);if(void 0!=e){var i=GlobalConfig.getHorseSkinConfigByNum(t,1),n=i.item[0]&&i.item[0][0]?i.item[0][0]:0;return{name:e.name,model_id:e.model_id,ui_model:e.source,icon:e.icon,item_id:n}}var o=GlobalConfig.getHorse_skin_ex_dataConfig(t),s=GlobalConfig.getHorse_skin_extend_dataConfig(t),i=s[1],n=i.item[0]&&i.item[0][0]?i.item[0][0]:0;return void 0!=o?{name:o.name,model_id:o.model_id,ui_model:o.source,icon:o.icon,item_id:n}:{name:"",model_id:0,ui_model:"",icon:"",item_id:0}},e.prototype.getGrade=function(){return this.grade||0},e.prototype.getStarNumber=function(t){var e=0,i=GlobalConfig.getHorseBaseDataConfigByNum(this.grade,this.star);if(void 0!=i){var n=i.show_id;GlobalConfig.getConfig("horse_grade_show","horseGradeShowConfig");for(var o in GlobalConfig.ins().horseGradeShowConfig)GlobalConfig.ins().horseGradeShowConfig[o].show_id<=n&&GlobalConfig.ins().horseGradeShowConfig[o].star>=t&&e++}if(void 0!=this.huaxing_list&&this.huaxing_list.length>0)for(var s=0;s<this.huaxing_list.length;++s)if(this.huaxing_list[s].num>0&&GlobalConfig.getHorseSkinConfig(this.huaxing_list[s].id)){var r=GlobalConfig.getHorseSkinConfigByNum(this.huaxing_list[s].id,this.huaxing_list[s].num);void 0!=r&&r.star>=t&&e++}return e},e.prototype.getActiveNumber=function(){var t=0,e=GlobalConfig.getHorseBaseDataConfigByNum(this.grade,this.star);if(void 0!=e&&(t=e.show_id),void 0!=this.huaxing_list&&this.huaxing_list.length>0)for(var i=0;i<this.huaxing_list.length;++i)this.huaxing_list[i].num>0&&t++;return t},e.prototype.getTotalFight=function(){return this.fight||0},e.prototype.getHorseRed=function(){return SystemOpenProxy.ins().isOpen(1,M_View_Type.Huoban,!0)?SystemOpenProxy.ins().isCurOpenItem(1,M_View_Type.Huoban)?!0:this.getMatericalRed()?!0:this.getHuaxingRed()?!0:this.getDanRedByType(1)?!0:this.getDanRedByType(2)?!0:this.isCanUpSkill()?!0:BagProxy.ins().getHuobanEquipRedByType(HuobanType.horse)?!0:BagProxy.ins().GetHasLVUpItem(LvUpType.emZuoqi,this.grade):!1},e.prototype.isCanUpSkill=function(){GlobalConfig.ins().horseSkillConfig||GlobalConfig.getConfig("horse_skill_data","horseSkillConfig");for(var t in GlobalConfig.ins().horseSkillConfig){var e=GlobalConfig.ins().horseSkillConfig[t],i=this.isSkillDataOpen(e);if(i){var n=this.getSkillLevelById(e.id),o=GlobalConfig.getHorseSkillUpgradeConfig(e.id),s=o[(n+1).toString()];if(s&&BagProxy.ins().getItemCountById(s.items[0][0])>=s.items[0][1])return!0}}return!1},e.prototype.getDanRedByType=function(t){var e=GlobalConfig.getHorseSwallowItemConfig(t);if(e){var i=e.item_id,n=BagProxy.ins().getItemCountById(i);if(n>0){var o=this.UseSwallowCount(t),s=this.GetMaxSwallowCount(t);return s>o}}return!1},e.prototype.isMaxGrade=function(){GlobalConfig.ins().horseBaseDataConfig||GlobalConfig.getConfig("horse_base_data","horseBaseDataConfig");for(var t in GlobalConfig.ins().horseBaseDataConfig){if(Number(t)>this.grade)return!1;if(Number(t)==this.grade){var e=GlobalConfig.ins().horseBaseDataConfig[t];for(var i in e)if(Number(i)>this.star)return!1}}return!0},e.prototype.getMatericalRed=function(){if(this.isMaxGrade())return!1;GlobalConfig.ins().horseGradeMatrialConfig||GlobalConfig.getConfig("horse_grade_matrial","horseGradeMatrialConfig");for(var t in GlobalConfig.ins().horseGradeMatrialConfig){var e=GlobalConfig.ins().horseGradeMatrialConfig[t].id,i=BagProxy.ins().getItemCountById(e);if(i>0)return!0}return!1},e.prototype.getHuaxingRed=function(){GlobalConfig.ins().horseSkinConfig||GlobalConfig.getConfig("horse_skin_data","horseSkinConfig");for(var t in GlobalConfig.ins().horseSkinConfig){var e=Number(t);if(this.getHuaxingEnoughById(e)||this.getHuaxingExtendEnoughById(e))return!0}return!1},e.prototype.getHuaxingEnoughById=function(t){if(GlobalConfig.ins().horseSkinConfig||GlobalConfig.getConfig("horse_skin_data","horseSkinConfig"),GlobalConfig.ins().horseSkinConfig[t.toString()]){var e=this.getHuaxingNum(t),i=GlobalConfig.ins().horseSkinConfig[t.toString()];if(i[(e+1).toString()]){for(var n=i[(e+1).toString()],o=!0,s=0;s<n.item.length;++s){var r=n.item[s][0],a=n.item[s][1];BagProxy.ins().getItemCountById(r)<a&&(o=!1)}if(o)return!0}}return!1},e.prototype.getHuaxingExtendEnoughById=function(t){if(GlobalConfig.ins().horse_skin_extend_dataConfig||GlobalConfig.getConfig("horse_skin_extend_data","horse_skin_extend_dataConfig"),GlobalConfig.ins().horse_skin_extend_dataConfig[t.toString()]){var e=this.getHuaxingData(t),i=GlobalConfig.ins().horse_skin_extend_dataConfig[t.toString()],n=e?e.level+1:1;if(i[n.toString()]){for(var o=i[n.toString()],s=!0,r=0;r<o.item.length;++r)if(o.item[r].length>=2){var a=o.item[r][0],h=o.item[r][1];BagProxy.ins().getItemCountById(a)<h&&(s=!1)}if(s)return this.getMatericalRed()}}return!1},e.prototype.getBaseDataConfig=function(t){if(!(t>this.grade)){if(t<this.grade){var e,i=GlobalConfig.getHorseBaseDataConfig(t),t=Number.MIN_VALUE;for(var n in i)i[n].star>t&&(t=i[n].star,e=n);return i[e]}return GlobalConfig.getHorseBaseDataConfigByNum(this.grade,this.star)}},e}(BaseSystem);__reflect(HorseProxy.prototype,"HorseProxy");var HuobanType;!function(t){t[t.horse=1]="horse",t[t.mate=2]="mate",t[t.pet=3]="pet"}(HuobanType||(HuobanType={}));var HuanxingData=function(){function t(){}return t.prototype.setHuanxingData=function(t,e,i){this.id=e,this.type=i,this.HuobanType=t,1==i?t==HuobanType.horse?this.config=GlobalConfig.getHorseGradeShowConfig(e):t==HuobanType.mate?this.config=GlobalConfig.getMateGradeShowConfig(e):t==HuobanType.pet&&(this.config=GlobalConfig.getPetGradeShowConfig(e)):2==i&&(t==HuobanType.horse?(this.config=GlobalConfig.getHorseSkinConfig(e)[1],this.configEx=GlobalConfig.getHorse_skin_ex_dataConfig(e)):t==HuobanType.mate?(this.config=GlobalConfig.getMateSkinConfig(e)[1],this.configEx=GlobalConfig.getMate_skin_ex_dataConfig(e)):t==HuobanType.pet&&(this.config=GlobalConfig.getPetSkinConfig(e)[1],this.configEx=GlobalConfig.getPet_skin_ex_dataConfig(e)))},t}();__reflect(HuanxingData.prototype,"HuanxingData");var HuobanProxy=function(t){function e(){var e=t.call(this)||this;return e.isInitView=!0,e.fight=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getCurrentPage=function(){return this._current_page||0},e.prototype.setCurrentPage=function(t){this._current_page=t},e.prototype.getLeftTopState=function(){return void 0!=this.isLeftTop?this.isLeftTop:!0},e.prototype.setLeftTopState=function(t){this.isLeftTop=t},e.prototype.getLeftCurState=function(){return void 0!=this.isLeftCur?this.isLeftCur:!0},e.prototype.setLeftCurState=function(t){this.isLeftCur=t},e.prototype.GetExp=function(){return this.exp},e.prototype.C2SReqBelleGetInfo=function(){var t=new net_protocol.C2SReqBelleGetInfo;this.isInitView=!0,this.sendPbPack(Msg.C2SReqBelleGetInfo,t,net_protocol.C2SReqBelleGetInfo)},e.prototype.C2SReqBelleOnekeyUpgrade=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new net_protocol.C2SReqBelleOnekeyUpgrade;1==t&&(i.type=t,i.index=e),this.sendPbPack(Msg.C2SReqBelleOnekeyUpgrade,i,net_protocol.C2SReqBelleOnekeyUpgrade)},e.prototype.C2SReqBelleActiveHuaxing=function(t){var e=new net_protocol.C2SReqBelleActiveHuaxing;e.id=t,this.sendPbPack(Msg.C2SReqBelleActiveHuaxing,e,net_protocol.C2SReqBelleActiveHuaxing)},e.prototype.C2SReqBelleShenLian=function(t,e){var i=new net_protocol.C2SReqBelleShenLian;i.opt=t,i.type=e,this.sendPbPack(Msg.C2SReqBelleShenLian,i,net_protocol.C2SReqBelleShenLian)},e.prototype.C2SReqBelleSkillUpgrade=function(t){var e=new net_protocol.C2SReqBelleSkillUpgrade;e.skill_index=t,this.sendPbPack(Msg.C2SReqBelleSkillUpgrade,e,net_protocol.C2SReqBelleSkillUpgrade)},e.prototype.C2SReqBelleChangeShow=function(t,e){var i=new net_protocol.C2SReqBelleChangeShow;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqBelleChangeShow,i,net_protocol.C2SReqBelleChangeShow)},e.prototype.C2SReqBelleSkinExtendUpgrade=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=new net_protocol.C2SReqBelleSkinExtendUpgrade;n.id=t,1==e&&(n.type=e,n.index=i),this.sendPbPack(Msg.C2SReqBelleSkinExtendUpgrade,n,net_protocol.C2SReqBelleSkinExtendUpgrade)},e.prototype.S2CRepBelleGetInfo=function(t){var e=net_protocol.S2CRepBelleGetInfo.decode(t.bytes);CommonUtils.log("-----------------------------S2CRepBelleGetInfo----------",e),this.exp=e.exp,this.grade=e.grade,this.star=e.star,this.skill_list=e.skill_list,this.huaxing_list=e.huaxing_list,this.show=e.show,this.swallow_list=e.swallow_list,this.fight=e.fight,this.InitShow(),GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.partner_fight=this.fight),EventProxy.Broast(EventType.S2CRepBelleGetInfo,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.InitShow=function(){this.show&&0==this.show.type&&0==this.show.id&&SystemOpenProxy.ins().isOpen(2,2001,!0)&&this.C2SReqBelleChangeShow(1,1)},e.prototype.getFight=function(){return this.fight||0},e.prototype.UseSwallowCount=function(t){if(void 0==this.swallow_list)return 0;for(var e=0;e<this.swallow_list.length;++e)if(this.swallow_list[e].type==t)return this.swallow_list[e].count;return 0},e.prototype.GetMaxSwallowCount=function(t){if(1==t){if(this.grade<=0&&this.star<=0)return 0;var e=Math.max(this.grade,1),i=0;for(var n in GlobalConfig.ins().mateGradeShowConfig)if(GlobalConfig.ins().mateGradeShowConfig[n].grade<=e)for(var o=0;o<GlobalConfig.ins().mateGradeShowConfig[n].max_swallow_count.length;++o)t==GlobalConfig.ins().mateGradeShowConfig[n].max_swallow_count[o][0]&&(i+=GlobalConfig.ins().mateGradeShowConfig[n].max_swallow_count[o][1]);if(this.huaxing_list)for(var o=0;o<this.huaxing_list.length;++o)if(this.huaxing_list[o].num>0&&GlobalConfig.getMateSkinConfig(this.huaxing_list[o].id))for(var s=GlobalConfig.getMateSkinConfig(this.huaxing_list[o].id)[this.huaxing_list[o].num.toString()],r=0;r<s.max_swallow_count.length;++r)t==s.max_swallow_count[r][0]&&(i+=s.max_swallow_count[r][1]);return i}if(2==t){var a=0;if(!this.huaxing_list)return 0;for(var o=0;o<this.huaxing_list.length;++o)a+=this.huaxing_list[o].num;if(0==a)return 0;var h=GlobalConfig.getConfig("mate_swallow_extend","mateSwallowExtendConfig"),l=0;for(var n in h)h[n].total_grade<a&&l<h[n].total_grade&&(l=h[n].total_grade);if(0==l)return 0;var p=GlobalConfig.getMateSwallowExtendConfig(l);if(t==p.max_swallow_count[0])return p.max_swallow_count[1]}return 0},e.prototype.GetMaxSwallowCountByGrade=function(t,e){if(1==t){var i=0;for(var n in GlobalConfig.ins().mateGradeShowConfig)if(GlobalConfig.ins().mateGradeShowConfig[n].grade<=e)for(var o=0;o<GlobalConfig.ins().mateGradeShowConfig[n].max_swallow_count.length;++o)t==GlobalConfig.ins().mateGradeShowConfig[n].max_swallow_count[o][0]&&(i+=GlobalConfig.ins().mateGradeShowConfig[n].max_swallow_count[o][1]);if(this.huaxing_list)for(var o=0;o<this.huaxing_list.length;++o)if(this.huaxing_list[o].num>0&&GlobalConfig.getMateSkinConfig(this.huaxing_list[o].id))for(var s=GlobalConfig.getMateSkinConfig(this.huaxing_list[o].id)[this.huaxing_list[o].num.toString()],r=0;r<s.max_swallow_count.length;++r)t==s.max_swallow_count[r][0]&&(i+=s.max_swallow_count[r][1]);return i}if(2==t){var a=0;if(!this.huaxing_list)return 0;for(var o=0;o<this.huaxing_list.length;++o)a+=this.huaxing_list[o].num;var h=GlobalConfig.getConfig("mate_swallow_extend","mateSwallowExtendConfig"),l=0;for(var n in h)if(h[n].total_grade>a&&l<h[n].total_grade){l=h[n].total_grade;break}if(0==l)return 0;var p=GlobalConfig.getMateSwallowExtendConfig(l);if(t==p.max_swallow_count[0])return p.max_swallow_count[1]}return 0},e.prototype.GetMaxSwallowCountById=function(t){GlobalConfig.ins().mateSwallowItemConfig||GlobalConfig.getConfig("mate_swallow_item","mateSwallowItemConfig");for(var e in GlobalConfig.ins().mateSwallowItemConfig)if(GlobalConfig.ins().mateSwallowItemConfig[e].item_id==t)return this.GetMaxSwallowCount(GlobalConfig.ins().mateSwallowItemConfig[e].type);return 0},e.prototype.GetUseCountById=function(t){GlobalConfig.ins().mateSwallowItemConfig||GlobalConfig.getConfig("mate_swallow_item","mateSwallowItemConfig");for(var e in GlobalConfig.ins().mateSwallowItemConfig)if(GlobalConfig.ins().mateSwallowItemConfig[e].item_id==t)return this.UseSwallowCount(GlobalConfig.ins().mateSwallowItemConfig[e].type);return 0},e.prototype.S2CRepBelleOnekeyUpgrade=function(t){var e=net_protocol.S2CRepBelleOnekeyUpgrade.decode(t.bytes);this.grade=e.grade,this.star=e.star,this.exp=e.exp;var i=(e.add_exp,1==e.is_crit);1==e.is_crit,XiuXianProxy.ins().updateAchieRed(AchieType.belle_level),XiuXianProxy.ins().updateAchieRed(AchieType.belle_star);var n=BagProxy.ins().GetLVUpItem(LvUpType.emXL,e.grade);if(n){var o=n.itemConfig;o.flags<=e.grade&&ViewManager.ins().open(ItemTipsView,n,!0,[LvUpType.emXL,0])}EventProxy.Broast(EventType.S2CRepBelleOnekeyUpgrade,[i]),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.S2CRepBelleActiveHuaxing=function(t){var e=net_protocol.S2CRepBelleActiveHuaxing.decode(t.bytes),i=!1;if(void 0!=this.huaxing_list)for(var n=0;n<this.huaxing_list.length;++n)this.huaxing_list[n].id==e.huaxing.id&&(i=!0,this.huaxing_list[n]=e.huaxing);i||this.huaxing_list.push(e.huaxing),XiuXianProxy.ins().updateAchieRed(AchieType.belle_num),XiuXianProxy.ins().updateAchieRed(AchieType.belle_star),EventProxy.Broast(EventType.S2CRepBelleActiveHuaxing,[e.huaxing.id]),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.getHuaxingNum=function(t){if(void 0==this.huaxing_list)return 0;for(var e=0;e<this.huaxing_list.length;++e)if(this.huaxing_list[e].id==t)return this.huaxing_list[e].num;return 0},e.prototype.getHuaxingData=function(t){if(this.huaxing_list)for(var e=0;e<this.huaxing_list.length;++e)if(this.huaxing_list[e].id==t)return this.huaxing_list[e]},e.prototype.S2CRepBelleShenLian=function(t){var e=net_protocol.S2CRepBelleShenLian.decode(t.bytes);CommonUtils.log("S2CRepBelleShenLian",e);var i=!1;if(void 0!=this.swallow_list)for(var n=0;n<this.swallow_list.length;++n)this.swallow_list[n].type==e.info.type&&(i=!0,this.swallow_list[n]=e.info);i||this.swallow_list.push(e.info),EventProxy.Broast(EventType.S2CRepBelleShenLian,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.S2CRepBelleSkillUpgrade=function(t){var e=net_protocol.S2CRepBelleSkillUpgrade.decode(t.bytes),i=!1;if(void 0!=this.skill_list)for(var n=0;n<this.skill_list.length;++n)this.skill_list[n].skill_index==e.skill.skill_index&&(i=!0,this.skill_list[n]=e.skill);else this.skill_list=[];i||this.skill_list.push(e.skill),EventProxy.Broast(EventType.S2CRepBelleSkillUpgrade,[e.skill.skill_index])},e.prototype.getSkillLevelById=function(t){if(void 0!=this.skill_list)for(var e=0;e<this.skill_list.length;++e)if(this.skill_list[e].skill_index==t)return this.skill_list[e].level;return 0},e.prototype.S2CRepBelleUpdateShow=function(t){var e=net_protocol.S2CRepBelleUpdateShow.decode(t.bytes);this.show=e.show,EventProxy.Broast(EventType.S2CRepBelleUpdateShow,[e.show.id])},e.prototype.isHuanxingById=function(t){return void 0==this.show?!1:this.show.id==t?!0:!1},e.prototype.isHuanxingActive=function(t){var e=GlobalConfig.getMateGradeShowConfig(t);if(void 0!=e)return e.grade<=this.grade?!0:!1;if(void 0==this.huaxing_list)return!1;for(var i=0;i<this.huaxing_list.length;++i)if(this.huaxing_list[i].id==t)return this.huaxing_list[i].level>0;return!1},e.prototype.S2CRepBelleFight=function(t){var e=net_protocol.S2CRepBelleFight.decode(t.bytes);this.fight=e.fight,GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.partner_fight=this.fight),EventProxy.Broast(EventType.S2CRepBelleFight,{})},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(26950,this.S2CRepBelleGetInfo,this),MsgHandle.ins().regNetMsg(26951,this.S2CRepBelleOnekeyUpgrade,this),MsgHandle.ins().regNetMsg(26952,this.S2CRepBelleActiveHuaxing,this),MsgHandle.ins().regNetMsg(26953,this.S2CRepBelleShenLian,this),MsgHandle.ins().regNetMsg(26954,this.S2CRepBelleSkillUpgrade,this),MsgHandle.ins().regNetMsg(26955,this.S2CRepBelleUpdateShow,this),MsgHandle.ins().regNetMsg(26957,this.S2CRepBelleFight,this)},e.prototype.isSkillDataOpen=function(t){return void 0==t?!1:t.grade<=this.grade?!0:!1},e.prototype.getShowData=function(){var t=this.show;if(void 0==t||0==t.id)return{name:"",model_id:0,ui_model_path:"",pos:[]};var e=t.id,i=GlobalConfig.getMateGradeShowConfig(e);if(void 0!=i)return{name:i.name,model_id:i.model_id,ui_model_path:i.source,pos:i.pos};var n=0;if(void 0==this.huaxing_list)return{name:"",model_id:0,ui_model_path:"",pos:[]};for(var o=0;o<this.huaxing_list.length;++o)this.huaxing_list[o].id==e&&(n=this.huaxing_list[o].num);var s=GlobalConfig.getMate_skin_ex_dataConfig(e);return{name:s.name,model_id:s.model_id,ui_model_path:s.source,pos:s.pos}},e.prototype.getShowDataById=function(t){var e=GlobalConfig.getMateGradeShowConfig(t);if(void 0!=e)return{name:e.name,model_id:e.model_id,data:e,ui_model:e.source};var i=GlobalConfig.getMate_skin_ex_dataConfig(t);return void 0!=i?{name:i.name,model_id:i.model_id,data:i,ui_model:i.source}:{name:"",model_id:0,data:null,ui_model:""}},e.prototype.getGrade=function(){return this.grade||0},e.prototype.getStarNumber=function(t){var e=0,i=GlobalConfig.getMateBaseDataConfigByNum(this.grade,this.star);if(void 0!=i){var n=i.show_id;GlobalConfig.getConfig("mate_grade_show","mateGradeShowConfig");for(var o in GlobalConfig.ins().mateGradeShowConfig)GlobalConfig.ins().mateGradeShowConfig[o].show_id<=n&&GlobalConfig.ins().mateGradeShowConfig[o].star>=t&&e++}if(void 0!=this.huaxing_list&&this.huaxing_list.length>0)for(var s=0;s<this.huaxing_list.length;++s)if(this.huaxing_list[s].num>0&&GlobalConfig.getMateSkinConfig(this.huaxing_list[s].id)){var r=GlobalConfig.getMateSkinConfigByNum(this.huaxing_list[s].id,this.huaxing_list[s].num);void 0!=r&&r.star>=t&&e++}return e},e.prototype.getActiveNumber=function(){var t=0,e=GlobalConfig.getMateBaseDataConfigByNum(this.grade,this.star);if(void 0!=e&&(t=e.show_id),void 0!=this.huaxing_list&&this.huaxing_list.length>0)for(var i=0;i<this.huaxing_list.length;++i)this.huaxing_list[i].num>0&&t++;return t},e.prototype.getTotalFight=function(){return this.fight||0},e.prototype.getMateRed=function(){return SystemOpenProxy.ins().isOpen(2,100*M_View_Type.Huoban+1,!0)?SystemOpenProxy.ins().isCurOpenItem(2,100*M_View_Type.Huoban+1)?!0:this.isInitView?!0:this.getMatericalRed()?!0:this.getHuaxingRed()?!0:this.getDanRedByType(1)?!0:this.getDanRedByType(2)?!0:this.isCanUpSkill()?!0:BagProxy.ins().getHuobanEquipRedByType(HuobanType.mate)?!0:BagProxy.ins().GetHasLVUpItem(LvUpType.emXL,this.grade):!1},e.prototype.isCanUpSkill=function(){GlobalConfig.ins().mateSkillConfig||GlobalConfig.getConfig("mate_skill_data","mateSkillConfig");for(var t in GlobalConfig.ins().mateSkillConfig){var e=GlobalConfig.ins().mateSkillConfig[t],i=this.isSkillDataOpen(e);if(i){var n=this.getSkillLevelById(e.id),o=GlobalConfig.getMateSkillUpgradeConfig(e.id),s=o[(n+1).toString()];if(s&&BagProxy.ins().getItemCountById(s.items[0][0])>=s.items[0][1])return!0}}return!1},e.prototype.getDanRedByType=function(t){var e=GlobalConfig.getMateSwallowItemConfig(t);if(e){var i=e.item_id,n=BagProxy.ins().getItemCountById(i);if(n>0){var o=this.UseSwallowCount(t),s=this.GetMaxSwallowCount(t);return s>o}}return!1},e.prototype.isMaxGrade=function(){GlobalConfig.ins().mateBaseDataConfig||GlobalConfig.getConfig("mate_base_data","mateBaseDataConfig");for(var t in GlobalConfig.ins().mateBaseDataConfig){if(Number(t)>this.grade)return!1;if(Number(t)==this.grade){var e=GlobalConfig.ins().mateBaseDataConfig[t];for(var i in e)if(Number(i)>this.star)return!1}}return!0},e.prototype.getMatericalRed=function(){if(this.isMaxGrade())return!1;GlobalConfig.ins().mateGradeMatrialConfig||GlobalConfig.getConfig("mate_grade_matrial","mateGradeMatrialConfig");for(var t in GlobalConfig.ins().mateGradeMatrialConfig){var e=GlobalConfig.ins().mateGradeMatrialConfig[t].id,i=BagProxy.ins().getItemCountById(e);if(i>0)return!0}return!1},e.prototype.getHuaxingRed=function(){GlobalConfig.ins().mateSkinConfig||GlobalConfig.getConfig("mate_skin_data","mateSkinConfig");for(var t in GlobalConfig.ins().mateSkinConfig){var e=Number(t);if(this.getHuaxingEnoughById(e)||this.getHuaxingExtendEnoughById(e))return!0}return!1},e.prototype.getHuaxingEnoughById=function(t){if(GlobalConfig.ins().mateSkinConfig||GlobalConfig.getConfig("mate_skin_data","mateSkinConfig"),GlobalConfig.ins().mateSkinConfig[t.toString()]){var e=this.getHuaxingNum(t),i=GlobalConfig.ins().mateSkinConfig[t.toString()];if(i[(e+1).toString()]){for(var n=i[(e+1).toString()],o=!0,s=0;s<n.item.length;++s){var r=n.item[s][0],a=n.item[s][1];BagProxy.ins().getItemCountById(r)<a&&(o=!1)}if(o)return!0}}return!1},e.prototype.getHuaxingExtendEnoughById=function(t){if(GlobalConfig.ins().mate_skin_extend_dataConfig||GlobalConfig.getConfig("mate_skin_extend_data","mate_skin_extend_dataConfig"),GlobalConfig.ins().mate_skin_extend_dataConfig[t.toString()]){var e=this.getHuaxingData(t),i=GlobalConfig.ins().mate_skin_extend_dataConfig[t.toString()],n=e?e.level+1:1;if(i[n.toString()]){for(var o=i[n.toString()],s=!0,r=0;r<o.item.length;++r)if(o.item[r].length>=2){var a=o.item[r][0],h=o.item[r][1];BagProxy.ins().getItemCountById(a)<h&&(s=!1)}if(s)return this.getMatericalRed()}}return!1},e.prototype.isGradeMatrialId=function(t){if(!this.gradeMatrialIdList){this.gradeMatrialIdList=[];for(var e in GlobalConfig.ins().mateGradeMatrialConfig){var i=GlobalConfig.ins().mateGradeMatrialConfig[e].id;this.gradeMatrialIdList.push(i)}for(var e in GlobalConfig.ins().mateGradeMatrialConfig){var i=GlobalConfig.ins().mateGradeMatrialConfig[e].id;this.gradeMatrialIdList.push(i)}for(var e in GlobalConfig.ins().horseGradeMatrialConfig){var i=GlobalConfig.ins().horseGradeMatrialConfig[e].id;this.gradeMatrialIdList.push(i)}GlobalConfig.ins().petSwallowItemConfig||GlobalConfig.getConfig("pet_swallow_item","petSwallowItemConfig");for(var e in GlobalConfig.ins().petSwallowItemConfig)this.gradeMatrialIdList.push(GlobalConfig.ins().petSwallowItemConfig[e].item_id);GlobalConfig.ins().horseSwallowItemConfig||GlobalConfig.getConfig("horse_swallow_item","horseSwallowItemConfig");for(var e in GlobalConfig.ins().horseSwallowItemConfig)this.gradeMatrialIdList.push(GlobalConfig.ins().horseSwallowItemConfig[e].item_id);GlobalConfig.ins().mateSwallowItemConfig||GlobalConfig.getConfig("mate_swallow_item","mateSwallowItemConfig");for(var e in GlobalConfig.ins().mateSwallowItemConfig)this.gradeMatrialIdList.push(GlobalConfig.ins().mateSwallowItemConfig[e].item_id);GlobalConfig.ins().petSkinConfig||GlobalConfig.getConfig("pet_skin_data","petSkinConfig");for(var e in GlobalConfig.ins().petSkinConfig)for(var n=GlobalConfig.ins().petSkinConfig[e][1],o=0;o<n.item.length;++o)this.gradeMatrialIdList.push(n.item[o][0]);GlobalConfig.ins().horseSkinConfig||GlobalConfig.getConfig("horse_skin_data","horseSkinConfig");for(var e in GlobalConfig.ins().horseSkinConfig)for(var s=GlobalConfig.ins().horseSkinConfig[e][1],o=0;o<s.item.length;++o)this.gradeMatrialIdList.push(s.item[o][0]);GlobalConfig.ins().mateSkinConfig||GlobalConfig.getConfig("mate_skin_data","mateSkinConfig");for(var e in GlobalConfig.ins().mateSkinConfig)for(var r=GlobalConfig.ins().mateSkinConfig[e][1],o=0;o<r.item.length;++o)this.gradeMatrialIdList.push(r.item[o][0]);GlobalConfig.ins().mateSkillUpgradeConfig||GlobalConfig.getConfig("mate_skill_upgrade","mateSkillUpgradeConfig");for(var e in GlobalConfig.ins().mateSkillUpgradeConfig)for(var a=GlobalConfig.ins().mateSkillUpgradeConfig[e][1],o=0;o<a.items.length;++o)this.gradeMatrialIdList.push(a.items[o][0]);GlobalConfig.ins().horseSkillUpgradeConfig||GlobalConfig.getConfig("horse_skill_upgrade","horseSkillUpgradeConfig");for(var e in GlobalConfig.ins().horseSkillUpgradeConfig)for(var a=GlobalConfig.ins().horseSkillUpgradeConfig[e][1],o=0;o<a.items.length;++o)this.gradeMatrialIdList.push(a.items[o][0]);GlobalConfig.ins().petSkillUpgradeConfig||GlobalConfig.getConfig("pet_skill_upgrade","petSkillUpgradeConfig");for(var e in GlobalConfig.ins().petSkillUpgradeConfig)for(var a=GlobalConfig.ins().petSkillUpgradeConfig[e][1],o=0;o<a.items.length;++o)this.gradeMatrialIdList.push(a.items[o][0])}for(var o=0;o<this.gradeMatrialIdList.length;++o)if(t==this.gradeMatrialIdList[o])return!0;return!1},e.prototype.enterSkillUseTip=function(t,e){ViewManager.ins().open(HuoBanSkillUseTips,void 0,e,t)},e.prototype.getRed=function(){return PetProxy.ins().getPetRed()||this.getMateRed()||HorseProxy.ins().getHorseRed()},e.prototype.getBaseDataConfig=function(t){if(!(t>this.grade)){if(t<this.grade){var e,i=GlobalConfig.getMateBaseDataConfig(t),t=Number.MIN_VALUE;for(var n in i)i[n].star>t&&(t=i[n].star,e=n);return i[e]}return GlobalConfig.getMateBaseDataConfigByNum(this.grade,this.star)}},e.prototype.getBagEquipType=function(t){return t==HuobanType.horse?BagType.HORSE_EQUIP:t==HuobanType.mate?BagType.BELLE_EQUIP:t==HuobanType.pet?BagType.PET_EQUIP:BagType.HORSE_EQUIP},e.prototype.getBagBodyEquipType=function(t){return t==HuobanType.horse?BagType.HORSE_BODY_EQUIP:t==HuobanType.mate?BagType.BELLE_BODY_EQUIP:t==HuobanType.pet?BagType.PET_BODY_EQUIP:BagType.HORSE_BODY_EQUIP},e.prototype.getHuobanEquipConfis=function(t){var e;if(t==HuobanType.horse?e=GlobalConfig.getHorse_equip_suit_dataConfigs():t==HuobanType.pet?e=GlobalConfig.getMate_equip_suit_dataConfigs():t==HuobanType.mate&&(e=GlobalConfig.getPet_equip_suit_dataConfigs()),!e)return[];var i=[];for(var n in e)i.push(e[n]);return i.sort(UtilProxy.sortUpByLevel),i},e.prototype.getHuobanEquipMaxGrade=function(t){for(var i=BagProxy.ins().getHuobanBodyEquipPartGrade(e.ins().getBagBodyEquipType(t)),n=0,o=0;o<i.length;++o)n<i[o]&&(n=i[o]);return n},e.prototype.getHuobanEquipMinGrade=function(t){for(var i=BagProxy.ins().getHuobanBodyEquipPartGrade(e.ins().getBagBodyEquipType(t)),n=Number.MAX_VALUE,o=0;o<i.length;++o)n>i[o]&&(n=i[o]);return n},e.prototype.getHuobanEquipMinGradePre=function(t){var e=0,i=this.getHuobanEquipMinGrade(t);if(!i)return 0;for(var n=this.getHuobanEquipConfis(t),o=0;o<n.length;++o)n[o].level<=i&&e<n[o].attr_per&&(e=n[o].attr_per);return e/100},e.prototype.getHuobanEquipMaxGradePre=function(t){for(var e=0,i=this.getHuobanEquipMaxGrade(t),n=this.getHuobanEquipConfis(t),o=0;o<n.length;++o)0==o&&(e=n[o].attr_per),n[o].level<=i&&e<n[o].attr_per&&(e=n[o].attr_per);return e/100},e.prototype.getHuobanEquipMaxLevel=function(t){for(var e=0,i=this.getHuobanEquipMaxGrade(t),n=this.getHuobanEquipConfis(t),o=0;o<n.length;++o)0==o&&(e=n[o].level),n[o].level<=i&&e<n[o].level&&(e=n[o].level);return e},e.HuobanType_Mate=1,e.HuobanType_Pet=2,e.HuobanType_Horse=0,e}(BaseSystem);__reflect(HuobanProxy.prototype,"HuobanProxy");var LeiTaiEmm;!function(t){t[t.MAXMIANFEI=1]="MAXMIANFEI",t[t.EVERYLIBAO=2]="EVERYLIBAO",t[t.MAX_COUNT=3]="MAX_COUNT",t[t.MAX_BUY=4]="MAX_BUY"}(LeiTaiEmm||(LeiTaiEmm={}));var LeitaiProxy=function(t){function e(){var e=t.call(this)||this;
return e.remain_times=0,e.buy_times=0,e.mobai_count=0,e.daily_award=0,e.end_time=0,e.is_rest=!1,e.is_guard=!1,e.guard_time=0,e.battle_num=0,e.cur_guard_info={},e.last_guard_info={},e.head_id=0,e.isTure=!1,e.rankList_cur=[],e.name="",e.time=0,e.heapCount=0,e.nowTime=0,e.result=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getDataConfig=function(){var t=GlobalConfig.getLeitai_misc_dataConfigConfig(1);return t?t:null},e.prototype.getOpenDay=function(){var t=GlobalConfig.getLeitai_misc_dataConfigConfig(1);return t?t.open_server_day:null},e.prototype.everyLibaoGetTj=function(){var t=!1;return 1==this.daily_award&&(t=!0),t},e.prototype.getDateConfigCount=function(t){var e=this.getDataConfig();if(e)switch(t){case LeiTaiEmm.MAXMIANFEI:return e.challenge_num;case LeiTaiEmm.EVERYLIBAO:return e.daily_need_challenge;case LeiTaiEmm.MAX_BUY:return e.buy_max;case LeiTaiEmm.MAX_COUNT:var i=e.challenge_num+e.buy_max;return i}},e.prototype.getNowMianfeiAllCount=function(){var t=this.buy_times+this.remain_times;return t},e.prototype.getIsCanBuyDareCount=function(){var t=!1;return 0==this.remain_times&&this.buy_times<this.getDateConfigCount(LeiTaiEmm.MAX_BUY)&&(t=!0),t},e.prototype.getModelType=function(t){return t==MoneyAttr.COIN?"金币":MoneyAttr.YUANBAO==t?"元宝":void 0},e.prototype.getMaxDareCountState=function(){var t=!1;return this.buy_times>=this.getDateConfigCount(LeiTaiEmm.MAX_BUY)&&0==this.remain_times&&(t=!0),t},e.prototype.getIsCanBuyCount=function(){var t=!1;return this.buy_times<this.getDateConfigCount(LeiTaiEmm.MAX_BUY)&&this.remain_times<this.getDateConfigCount(LeiTaiEmm.MAXMIANFEI)&&(t=!0),t},e.prototype.getBuyCountMax=function(){var t=!1;return this.buy_times>=this.getDateConfigCount(LeiTaiEmm.MAX_BUY)&&(t=!0),t},e.prototype.getIsSelf=function(){var t=!1;return this.cur_guard_info&&(t=this.cur_guard_info.role_id==RoleProxy.ins().getRoleId()),t},e.prototype.visibleLv=function(){var t=GlobalConfig.getLeitai_misc_dataConfigConfig(1);return t&&t.limit_level>0&&RoleProxy.ins().getRoleLv()>=t.limit_level?!0:!1},e.prototype.getOpenTime=function(){var t="",e="",i=GlobalConfig.getLeitai_misc_dataConfigConfig(1);return i&&i.start_time.length>0?(e=0==i.start_time[1]?"00":i.start_time[1],t="每日"+i.start_time[0]+":"+e+"开启"):t},e.prototype.getXiuSaiTime=function(){var t="",e="",i="",n="",o=GlobalConfig.getLeitai_misc_dataConfigConfig(1);return o&&o.start_time.length>0&&(e=0==o.start_time[1]?"00":o.start_time[1],t=o.start_time[0]+":"+e+")"),o&&o.end_time.length>0&&(i=0==o.end_time[1]?"00":o.end_time[1],n="("+o.end_time[0]+":"+i),n+"-次日"+t},e.prototype.getIsOpen=function(){return this.end_time-GameLogic.ins().getServerTime()>0?!0:!1},e.prototype.leizhuNowTime=function(){if(this.rankList_cur&&this.rankList_cur.length>0&&this.cur_guard_info)for(var t=0;t<this.rankList_cur.length;t++)if(this.rankList_cur[t].role_id==this.cur_guard_info.role_id)return this.rankList_cur[t].time;return 0},e.prototype.C2SReqLeitaiGetInfo=function(){var t=new net_protocol.C2SReqLeitaiGetInfo;this.sendPbPack(Msg.C2SReqLeitaiGetInfo,t,net_protocol.C2SReqLeitaiGetInfo)},e.prototype.S2CLeitaiGetInfo=function(t){var e=net_protocol.S2CLeitaiGetInfo.decode(t.bytes);this.remain_times=e.remain_times,this.buy_times=e.buy_times,this.mobai_count=e.mobai_count,this.is_guard=e.is_guard,this.daily_award=e.daily_award,this.end_time=e.end_time,this.is_rest=e.is_rest,this.guard_time=e.guard_time,this.battle_num=e.battle_num,this.cur_guard_info=e.cur_guard_info,this.last_guard_info=e.last_guard_info,EventProxy.Broast(EventType.S2CLeitaiGetInfo,{})},e.prototype.C2SReqLeitaiGetRankList=function(){var t=new net_protocol.C2SReqLeitaiGetRankList;this.sendPbPack(Msg.C2SReqLeitaiGetRankList,t,net_protocol.C2SReqLeitaiGetRankList)},e.prototype.C2SReqLeitaiBuyTimes=function(t){var e=new net_protocol.C2SReqLeitaiBuyTimes;e.count=t,this.sendPbPack(Msg.C2SReqLeitaiBuyTimes,e,net_protocol.C2SReqLeitaiBuyTimes)},e.prototype.S2CLeitaiGetLastRankList=function(t){net_protocol.S2CLeitaiGetLastRankList.decode(t.bytes)},e.prototype.S2CLeitaiGetRankList=function(t){var e=net_protocol.S2CLeitaiGetRankList.decode(t.bytes);this.name=e.name,this.time=e.time,this.rankList_cur=e.list,EventProxy.Broast(EventType.S2CLeitaiGetRankList,{})},e.prototype.C2SReqLeitaiStartChallenge=function(){var t=new net_protocol.C2SReqLeitaiStartChallenge;this.sendPbPack(Msg.C2SReqLeitaiStartChallenge,t,net_protocol.C2SReqLeitaiStartChallenge)},e.prototype.S2CLeitaiBuyTimes=function(t){var e=net_protocol.S2CLeitaiBuyTimes.decode(t.bytes);this.buy_times=e.buy_times,this.remain_times=e.remain_times,EventProxy.Broast(EventType.S2CLeitaiBuyTimes,{})},e.prototype.S2CLeitaiMobai=function(t){var e=net_protocol.S2CLeitaiMobai.decode(t.bytes);this.mobai_count=e.mobai_count,EventProxy.Broast(EventType.S2CLeitaiMobai,{})},e.prototype.S2CLeitaiFightResult=function(t){var e=net_protocol.S2CLeitaiFightResult.decode(t.bytes);this.result=e.result;var i=[];i=0==e.result?GlobalConfig.getLeitai_misc_dataConfigConfig(1).win_award:GlobalConfig.getLeitai_misc_dataConfigConfig(1).lose_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?"恭喜你挑战胜利!":"很遗憾,挑战对手失败了",ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.LEITAI,a),EventProxy.Broast(EventType.S2CLeitaiFightResult,{})},e.prototype.S2CLeitaiGetDailyAward=function(t){var e=net_protocol.S2CLeitaiGetDailyAward.decode(t.bytes);this.daily_award=e.daily_award,EventProxy.Broast(EventType.S2CLeitaiGetDailyAward,{})},e.prototype.C2SReqLeitaiGetDailyAward=function(){var t=new net_protocol.C2SReqLeitaiGetDailyAward;this.sendPbPack(Msg.C2SReqLeitaiGetDailyAward,t,net_protocol.C2SReqLeitaiGetDailyAward)},e.prototype.C2SReqLeitaiMobai=function(){var t=new net_protocol.C2SReqLeitaiMobai;this.sendPbPack(Msg.C2SReqLeitaiMobai,t,net_protocol.C2SReqLeitaiMobai)},e.prototype.S2CLeitaiStartChallenge=function(t){net_protocol.S2CLeitaiStartChallenge.decode(t.bytes);ViewManager.ins().close(LeitaiView),ViewManager.ins().close(XianFuView),ViewManager.ins().close(ActHallView)},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(28200,this.S2CLeitaiGetInfo,this),MsgHandle.ins().regNetMsg(28201,this.S2CLeitaiGetRankList,this),MsgHandle.ins().regNetMsg(28203,this.S2CLeitaiStartChallenge,this),MsgHandle.ins().regNetMsg(28204,this.S2CLeitaiBuyTimes,this),MsgHandle.ins().regNetMsg(28205,this.S2CLeitaiGetDailyAward,this),MsgHandle.ins().regNetMsg(28206,this.S2CLeitaiMobai,this),MsgHandle.ins().regNetMsg(28207,this.S2CLeitaiFightResult,this),MsgHandle.ins().regNetMsg(28202,this.S2CLeitaiGetLastRankList,this)},e}(BaseSystem);__reflect(LeitaiProxy.prototype,"LeitaiProxy");var S2CActRankInfo=function(){function t(){this.index=0,this.role_id=0,this.name="",this.prof=1,this.zhuan=0,this.level=0,this.fight=0,this.score=0,this.server_id=0,this.zone_id=0}return t}();__reflect(S2CActRankInfo.prototype,"S2CActRankInfo");var ActRankType;!function(t){t[t.emZuoqi=1]="emZuoqi",t[t.emXL=2]="emXL",t[t.emCW=3]="emCW",t[t.emSB=4]="emSB",t[t.emWing=5]="emWing",t[t.emXB=6]="emXB",t[t.emSYT=7]="emSYT",t[t.emLB=8]="emLB",t[t.emLQ=9]="emLQ",t[t.emLBG=10]="emLBG",t[t.emTujian=11]="emTujian"}(ActRankType||(ActRankType={}));var LvUpType;!function(t){t[t.emZuoqi=1]="emZuoqi",t[t.emXL=2]="emXL",t[t.emCW=3]="emCW",t[t.emSB=4]="emSB",t[t.emXB=5]="emXB",t[t.emWing=6]="emWing",t[t.emSZ=7]="emSZ",t[t.emLB=8]="emLB"}(LvUpType||(LvUpType={}));var LimitActProxy=function(t){function e(){var e=t.call(this)||this;return e.ActDatas=[],e.RedData=[],e.ActTimesList=[],e.Activites_Type_Tab=[],e.OpenActList=[],e.limit_gift_list=[],e.extra_act_list=[],e.offline_time=0,e.offline_equip_num=0,e.rank_first_list=[],e.ActRankList=[],e.myActRank=0,e.consume_score=0,e.curGetRankTime=0,e.OpenRankActId=0,e.vip_awards=[],e.smGift_list=[],e.recharge_num=0,e.recharge_treasure=0,e.consume_num=0,e.consume_treasure=0,e.recharge_list=[],e.consume_list=[],e.my_records=[],e.jackpot_list=[],e.cross_score_list=[],e.lotteryRank_list=[],e.myLotteryRank=0,e.trun_ids=[],e.CurSelectType=0,e.IsShowFirstRechange=!1,e.IsShowOnline=!1,e.IsShowRankAct=!1,e.isTrue=!0,e.IsShowActEffect=!0,e.IsShowGiftRed=!0,e.IsShow34ActRed=!0,e.manyDaybySevnen=[],e.IsShowFRPush=!1,e.RichRankList=[],e.myRichRank=0,e.rechargeNun=500,e.curShowRankType=0,e.ZZZDType=1,e.DFDFType=2,e.ZPZBType=3,e.xian_limitlist=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.GetServerOpenDay=function(){return this.server_open_days||0},e.prototype.GetServerCombinDay=function(){return this.srv_combine_day||0},e.prototype.C2SReqMiscGetSaveInfo=function(){var t=new net_protocol.C2SReqMiscGetSaveInfo;this.sendPbPack(Msg.C2SReqMiscGetSaveInfo,t,net_protocol.C2SReqMiscGetSaveInfo)},e.prototype.S2CRepMiscGetSaveInfo=function(t){var e=net_protocol.S2CRepMiscGetSaveInfo.decode(t.bytes);this.server_open_days=e.server_open_days,this.srv_combine_day=e.srv_combine_day;var i=GlobalConfig.getLyhMisc();0==this.offline_time&&e.offline_time>i.time_interval&&LyhProxy.ins().getCurId()>0&&(this.IsShowOnline=!0,TimerManager.ins().doTimer(1e3,1,function(){ViewManager.ins().open(LyhOffline)},this)),this.offline_time=e.offline_time,this.offline_equip_num=e.offline_items,this.IsShowActEffect=!0,this.IsShowGiftRed=!0,SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.ALL),EventProxy.Broast(EventType.S2CRepMiscGetSaveInfo,{})},e.prototype.C2SReqLimitActGetInfo=function(){var t=new net_protocol.C2SReqLimitActGetInfo;this.sendPbPack(Msg.C2SReqLimitActGetInfo,t,net_protocol.C2SReqLimitActGetInfo)},e.prototype.S2CRepLimitActGetInfo=function(t){var i=net_protocol.S2CRepLimitActGetInfo.decode(t.bytes);LocationProperty.consoleWrite("最后一条协议返回");for(var n in i.acts){this.RefreshData(i.acts[n]);var o=GlobalConfig.getActivity_dataConfig(i.acts[n].act_id);if(o&&o.skill_id>0&&i.acts[n].is_get&&!SkillProxy.ins().isActive(o.skill_id)){var s=[{skill_id:o.skill_id,count:1}];SkillProxy.ins().C2SReqSkillUpgrade(s)}}this.limit_gift_list=[];for(var n in i.limit_gift_list)this.limit_gift_list[i.limit_gift_list[n].gift_id]=i.limit_gift_list[n].num;this.extra_act_list=i.extra_act_list;var r=e.ins().GetKaifuTabCf()||e.ins().GetKuafuTabCf();this.IsFristRechargeOpen()&&!UtilProxy.isOpenWelcome()?(this.IsShowFirstRechange=!0,TimerManager.ins().doTimer(1500,1,function(){ViewManager.ins().isShow(LyhOffline)||ViewManager.ins().open(FirstRechargeView)},this)):void 0!=r&&r.tips_pics.length>0?(this.IsShowRankAct=!0,TimerManager.ins().doTimer(1500,1,function(){ViewManager.ins().isShow(LyhOffline)||ViewManager.ins().open(ChongbangTips)},this)):this.IsShowOnline||UtilProxy.isOpenWelcome()||(GuideProxy.ins().isCanGuide=!0,GuideProxy.ins().startCheck()),this.consume_score=i.consume_score,this.vip_awards=[];for(var n in i.vip_awards)this.vip_awards[i.vip_awards[n].act_id]=i.vip_awards[n];this.rank_first_list=i.rank_first_list,this.smGift_list=[];for(var n in i.shenmi_gift_list)i.shenmi_gift_list[n].buy_times>=GlobalConfig.getSmGiftListConfig(i.shenmi_gift_list[n].gift_id).buy_times||i.shenmi_gift_list[n].end_time<=GameLogic.ins().getServerTime()||this.smGift_list.push(i.shenmi_gift_list[n]);this.smGift_list.sort(function(t,e){return t.gift_id-e.gift_id}),EventProxy.Broast(EventType.UpdataForgingRed,{}),EventProxy.Broast(EventType.S2CRepLimitActGetInfo,{})},e.prototype.S2CRepLimitActOpen=function(t){var e=net_protocol.S2CRepLimitActOpen.decode(t.bytes);this.OpenActList[e.act_id]=!0;var i={act_id:e.act_id,is_get:!1,last_get:0,is_completed:!1,params:[]};this.RefreshData(i),EventProxy.Broast(EventType.S2CRepLimitActOpen,{})},e.prototype.S2CRepLimitActClose=function(t){var e=net_protocol.S2CRepLimitActClose.decode(t.bytes);this.OpenActList[e.act_id]=!1,EventProxy.Broast(EventType.S2CRepLimitActClose,{})},e.prototype.S2CRepLimitActDel=function(t){for(var e=net_protocol.S2CRepLimitActDel.decode(t.bytes),i=0;i<e.act_ids.length;i++)this.OpenActList[e.act_ids[i]]=!1;EventProxy.Broast(EventType.S2CRepLimitActDel,{})},e.prototype.S2CRepLimitActRemove=function(t){for(var e=net_protocol.S2CRepLimitActRemove.decode(t.bytes),i=0;i<e.list.length;i++)this.OpenActList[e.list[i]]=!1;EventProxy.Broast(EventType.S2CRepLimitActRemove,{})},e.prototype.C2SReqLimitActGetReward=function(t){var e=new net_protocol.C2SReqLimitActGetReward;e.act_id=t,this.sendPbPack(Msg.C2SReqLimitActGetReward,e,net_protocol.C2SReqLimitActGetReward)},e.prototype.S2CRepLimitActGetReward=function(t){var e=net_protocol.S2CRepLimitActGetReward.decode(t.bytes);if(NoticeProxy.ins().ErrCode(e.err_code)){this.ActDatas[e.act_id].is_get=!0,this.ActDatas[e.act_id].last_get=2;var i=GlobalConfig.getActivity_dataConfig(e.act_id);i&&34==i.act_type&&(this.ActDatas[e.act_id].params[1]=this.ActDatas[e.act_id].params[1]+1),this.RefreshData(this.ActDatas[e.act_id]),this.ActTimesList[e.act_id]&&(this.ActTimesList[e.act_id]=this.ActTimesList[e.act_id]+1),this.GetExtraItem(e.act_id)&&this.extra_act_list.push(e.act_id);for(var n=new Array,o=0;o<e.items.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:e.items[o].item_id,item_count:e.items[o].item_num};s.setItemCellData(r),n.push(s)}if(TipsControl.ins().showReward(n),i.skill_id>0){var a=[{skill_id:i.skill_id,count:1}];SkillProxy.ins().C2SReqSkillUpgrade(a)}EventProxy.Broast(EventType.S2CRepLimitActGetReward,{})}},e.prototype.S2CRepLimitActUpdate=function(t){for(var e=net_protocol.S2CRepLimitActUpdate.decode(t.bytes),i=0;i<e.info_list.length;i++)this.RefreshData(e.info_list[i]);e.consume_score&&(this.consume_score=e.consume_score),EventProxy.Broast(EventType.S2CRepLimitActUpdate,{})},e.prototype.C2SReqLimitActGetList=function(){var t=new net_protocol.C2SReqLimitActGetList;this.sendPbPack(Msg.C2SReqLimitActGetList,t,net_protocol.C2SReqLimitActGetList)},e.prototype.S2CRepLimitActGetList=function(t){for(var e=net_protocol.S2CRepLimitActGetList.decode(t.bytes),i=0;i<e.act_ids.length;i++)if(this.OpenActList[e.act_ids[i]]=!0,void 0==this.ActDatas[e.act_ids[i]]){var n={act_id:e.act_ids[i],is_get:!1,last_get:0,is_completed:!1,params:[]};this.RefreshData(n)}EventProxy.Broast(EventType.S2CRepLimitActGetList,{})},e.prototype.C2SReqLimitActGetGiftPack=function(t){var e=new net_protocol.C2SReqLimitActGetGiftPack;e.gift_type=t,this.sendPbPack(Msg.C2SReqLimitActGetGiftPack,e,net_protocol.C2SReqLimitActGetGiftPack)},e.prototype.S2CRepLimitActGetGiftPack=function(t){net_protocol.S2CRepLimitActGetGiftPack.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActGetGiftPack,{})},e.prototype.C2SReqLimitActGetTimes=function(t){var e=new net_protocol.C2SReqLimitActGetTimes;e.act_ids=t,this.sendPbPack(Msg.C2SReqLimitActGetTimes,e,net_protocol.C2SReqLimitActGetTimes)},e.prototype.S2CRepLimitActGetTimes=function(t){for(var e=net_protocol.S2CRepLimitActGetTimes.decode(t.bytes),i=0;i<e.act_times_list.length;i++){this.ActTimesList[e.act_times_list[i].act_id]=e.act_times_list[i].times;var n=GlobalConfig.getActivity_dataConfig(e.act_times_list[i].act_id).total_num;0!=n&&e.act_times_list[i].times>=n&&(this.RedData[e.act_times_list[i].act_id]=!1)}EventProxy.Broast(EventType.S2CRepLimitActGetTimes,{})},e.prototype.C2SReqLimitActRechargeRecord=function(t){var e=new net_protocol.C2SReqLimitActRechargeRecord;e.act_id=t,this.sendPbPack(Msg.C2SReqLimitActRechargeRecord,e,net_protocol.C2SReqLimitActRechargeRecord)},e.prototype.S2CRepLimitActRechargeRecord=function(t){net_protocol.S2CRepLimitActRechargeRecord.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActRechargeRecord,{})},e.prototype.S2CRepLimitActChargeNum=function(t){net_protocol.S2CRepLimitActChargeNum.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActChargeNum,{})},e.prototype.C2SReqLimitActGetRankData=function(t){var e=new net_protocol.C2SReqLimitActGetRankData;e.act_id=t,this.sendPbPack(Msg.C2SReqLimitActGetRankData,e,net_protocol.C2SReqLimitActGetRankData)},e.prototype.S2CRepLimitActGetRankData=function(t){net_protocol.S2CRepLimitActGetRankData.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActGetRankData,{})},e.prototype.C2SReqLimitActItemExchange=function(t){var e=new net_protocol.C2SReqLimitActItemExchange;e.act_id=t,this.sendPbPack(Msg.C2SReqLimitActItemExchange,e,net_protocol.C2SReqLimitActItemExchange)},e.prototype.S2CRepLimitActItemExchange=function(t){net_protocol.S2CRepLimitActItemExchange.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActItemExchange,{})},e.prototype.C2SReqLimitActGetExchangeData=function(t){var e=new net_protocol.C2SReqLimitActGetExchangeData;e.act_id=t,this.sendPbPack(Msg.C2SReqLimitActGetExchangeData,e,net_protocol.C2SReqLimitActGetExchangeData)},e.prototype.S2CRepLimitActGetExchangeData=function(t){net_protocol.S2CRepLimitActGetExchangeData.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActGetExchangeData,{})},e.prototype.C2SReqLimitActExchangeItem=function(t,e){var i=new net_protocol.C2SReqLimitActExchangeItem;i.act_id=t,i.index=e,this.sendPbPack(Msg.C2SReqLimitActExchangeItem,i,net_protocol.C2SReqLimitActExchangeItem)},e.prototype.S2CRepLimitActExchangeItem=function(t){net_protocol.S2CRepLimitActExchangeItem.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLimitActExchangeItem,{})},e.prototype.C2SReqLimitActBuyGift=function(t,e){var i=new net_protocol.C2SReqLimitActBuyGift;i.act_id=e,i.gift_id=t,this.sendPbPack(Msg.C2SReqLimitActBuyGift,i,net_protocol.C2SReqLimitActBuyGift)},e.prototype.S2CRepLimitActBuyGift=function(t){var e=net_protocol.S2CRepLimitActBuyGift.decode(t.bytes);this.limit_gift_list[e.gift_id]?this.limit_gift_list[e.gift_id]=this.limit_gift_list[e.gift_id]+1:this.limit_gift_list[e.gift_id]=1;var i=GlobalConfig.getLimit_act_gift_dataConfig(e.gift_id);if(i){var n=i.reward_id,o=new Array;if(n>0)for(var s=GlobalConfig.getDropConfig(n),r=GlobalConfig.getDropItem(s.drop),a=0;a<r.length;a++){var h=new ItemCellData,l={item_slot_idx:0,item_type_id:r[a][0].id,item_count:r[a][0].num};h.setItemCellData(l),o.push(h)}TipsControl.ins().showReward(o)}EventProxy.Broast(EventType.S2CRepLimitActBuyGift,{})},e.prototype.C2SReqLimitActBuySmGift=function(t){var e=new net_protocol.C2SReqLimitActBuySmGift;e.gift_id=t,this.sendPbPack(Msg.C2SReqLimitActBuySmGift,e,net_protocol.C2SReqLimitActBuySmGift)},e.prototype.S2CRepLimitActBuySmGift=function(t){for(var e=net_protocol.S2CRepLimitActBuySmGift.decode(t.bytes),i=GlobalConfig.getSmGiftListConfig(e.gift_id),n=this.smGift_list.length-1;n>=0;n--)this.smGift_list[n].gift_id==e.gift_id&&(this.smGift_list[n].buy_times++,this.smGift_list[n].buy_times>=i.buy_times&&this.smGift_list.splice(n,1));EventProxy.Broast(EventType.S2CRepLimitActBuySmGift,{})},e.prototype.S2CRepLimitActSmGiftAppear=function(t){for(var e=net_protocol.S2CRepLimitActSmGiftAppear.decode(t.bytes),i=0;i<e.list.length;i++)-1==this.smGift_list.indexOf(e.list[i])&&this.smGift_list.unshift(e.list[i]);EventProxy.Broast(EventType.S2CRepLimitActSmGiftAppear,{}),(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)||TimerManager.ins().doTimer(6e4,1,function(){ViewManager.ins().isShow(LimitGiftView)||ViewManager.ins().open(LimitGiftView)},this)},e.prototype.C2SReqLimitActConsumeRank=function(t){var e=new net_protocol.C2SReqLimitActConsumeRank;e.type=t,this.sendPbPack(Msg.C2SReqLimitActConsumeRank,e,net_protocol.C2SReqLimitActConsumeRank)},e.prototype.S2CRepLimitActConsumeRank=function(t){var e=net_protocol.S2CRepLimitActConsumeRank.decode(t.bytes);switch(e.list.sort(this.sort),e.act_type){case 1:this.ActRankList=[],this.myActRank=0;break;case 2:this.RichRankList=[],this.myRichRank=0;break;case 3:this.lotteryRank_list=[],this.myLotteryRank=0}for(var i=0;i<e.list.length;i++){var n=new S2CActRankInfo;switch(n.index=i+1,n.role_id=e.list[i].role_id,n.name=e.list[i].name,n.prof=e.list[i].prof,n.zhuan=e.list[i].zhuan,n.level=e.list[i].level,n.fight=e.list[i].fight,n.score=e.list[i].score,n.zone_id=e.list[i].zone_id,n.server_id=e.list[i].server_id,e.act_type){case 1:n.role_id==RoleProxy.ins().getRoleId()&&(this.myActRank=n.index),this.ActRankList.push(n);break;case 2:n.role_id==RoleProxy.ins().getRoleId()&&(this.myRichRank=n.index),this.RichRankList.push(n);break;case 3:n.role_id==RoleProxy.ins().getRoleId()&&(this.myLotteryRank=n.index),this.lotteryRank_list.push(n)}}this.curGetRankTime=GameLogic.ins().getServerTime(),EventProxy.Broast(EventType.S2CRepLimitActConsumeRank,{})},e.prototype.sort=function(t,e){return t.score<e.score?1:t.score>e.score?-1:0},e.prototype.C2SReqLimitActGetVipAward=function(t,e){var i=new net_protocol.C2SReqLimitActGetVipAward;i.act_id=t,i.vip_level=e,this.sendPbPack(Msg.C2SReqLimitActGetVipAward,i,net_protocol.C2SReqLimitActGetVipAward)},e.prototype.S2CRepLimitActGetVipAward=function(t){var e=net_protocol.S2CRepLimitActGetVipAward.decode(t.bytes);this.vip_awards[e.act_id]&&this.vip_awards[e.act_id].get_awards.push(e.vip_level);var i=new Array,n=GlobalConfig.getActivity_dataConfig(e.act_id),o=n.vip_award[e.vip_level-1][1];if(o>0){for(var s=GlobalConfig.getDropConfig(o),r=GlobalConfig.getDropItem(s.drop),a=0;a<r.length;a++){var h=new ItemCellData,l={item_slot_idx:0,item_type_id:r[a][0].id,item_count:r[a][0].num};h.setItemCellData(l),i.push(h)}TipsControl.ins().showReward(i)}EventProxy.Broast(EventType.S2CRepLimitActGetVipAward,[])},e.prototype.C2SReqLimitActLotteryInfo=function(){var t=new net_protocol.C2SReqLimitActLotteryInfo;this.sendPbPack(Msg.C2SReqLimitActLotteryInfo,t,net_protocol.C2SReqLimitActLotteryInfo)},e.prototype.S2CRepLimitActLotteryInfo=function(t){var e=net_protocol.S2CRepLimitActLotteryInfo.decode(t.bytes);this.recharge_num=e.recharge_num,this.recharge_treasure=e.recharge_treasure,this.consume_num=e.consume_num,this.consume_treasure=e.consume_treasure,this.recharge_list=e.recharge_list,this.consume_list=e.consume_list,this.my_records=[];for(var i in e.records)this.my_records[e.records[i].act_type]=e.records[i].ids;this.jackpot_list=e.jackpot_list,this.cross_score_list=e.cross_score_list,void 0!=this.GetRechargeTrunCf()&&void 0!=this.GetRechargeTrunCf().charRes_wuqi[0]&&this.isTrue&&(this.isTrue=!1,TimerManager.ins().doTimer(6e4,1,function(){ViewManager.ins().isShow(TrunPushView)||ViewManager.ins().open(TrunPushView)},this)),EventProxy.Broast(EventType.S2CRepLimitActLotteryInfo,[])},e.prototype.C2SReqLimitActLotteryTake=function(t,e,i){var n=new net_protocol.C2SReqLimitActLotteryTake;n.type=t,n.num=e,n.act_id=i,this.sendPbPack(Msg.C2SReqLimitActLotteryTake,n,net_protocol.C2SReqLimitActLotteryTake)},e.prototype.S2CRepLimitActLotteryTake=function(t){var i=net_protocol.S2CRepLimitActLotteryTake.decode(t.bytes),n=GlobalConfig.getLottery_base_dataConfig(1),o=e.ins().GetActivityCfgs(1==i.type?30:33),s=o[0];if(void 0!=s){var r=e.ins().GetTrunActBoxAward(i.type,s.id);if(1==i.type){r?this.recharge_num=this.recharge_num-i.num*r.take_need:this.recharge_num=this.recharge_num-i.num*n.recharge_need,this.recharge_treasure=this.recharge_treasure+i.num;for(var a=0;a<i.ids.length;a++){var h=e.ins().GetTrunActItemList(i.type,s.id);if(h[i.ids[a]]&&1==h[i.ids[a]].is_notice){var l={name:RoleProxy.ins().getRoleName(),id:i.ids[a]};this.recharge_list.push(l)}}var p=[],c=0;this.recharge_list.length>n.recharge_recored&&(c=this.recharge_list.length-n.recharge_recored);for(var a=c;a<this.recharge_list.length;a++)p.push(this.recharge_list[a]);this.recharge_list=p}else if(2==i.type){r?this.consume_num=this.consume_num-i.num*r.take_need:this.consume_num=this.consume_num-i.num*n.consume_need,this.consume_treasure=this.consume_treasure+i.num;for(var a=0;a<i.ids.length;a++){var h=e.ins().GetTrunActItemList(i.type,s.id);if(h[i.ids[a]]&&1==h[i.ids[a]].is_notice){var l={name:RoleProxy.ins().getRoleName(),id:i.ids[a]};this.consume_list.push(l)}}var u=[],c=0;this.consume_list.length>n.consume_recored&&(c=this.consume_list.length-n.consume_recored);for(var a=c;a<this.consume_list.length;a++)u.push(this.consume_list[a]);this.consume_list=u}this.trun_ids=i.ids,this.CurSelectType=i.type,EventProxy.Broast(EventType.S2CRepLimitActLotteryTake,[])}},e.prototype.C2SReqLimitActGetJackpot=function(t){var e=new net_protocol.C2SReqLimitActGetJackpot;e.act_type=t,this.sendPbPack(Msg.C2SReqLimitActGetJackpot,e,net_protocol.C2SReqLimitActGetJackpot)},e.prototype.S2CRepLimitActGetJackpot=function(t){var e=net_protocol.S2CRepLimitActGetJackpot.decode(t.bytes),i=void 0;for(var n in this.jackpot_list)this.jackpot_list[n].act_type==e.act_type&&(i=this.jackpot_list[n]);void 0==i&&(i=new net_protocol.CrossScoreInfo,i.act_type=e.act_type,this.jackpot_list.push(i)),i.score=e.score,EventProxy.Broast(EventType.S2CRepLimitActGetJackpot,[])},e.prototype.getJackpotScore=function(t){var e=0;for(var i in this.jackpot_list)this.jackpot_list[i].act_type==t&&(e=this.jackpot_list[i].score);return e},e.prototype.getMyCrossScore=function(t){for(var e=0,i=0,n=this.cross_score_list;i<n.length;i++){var o=n[i];o.act_type==t&&(e=o.score)}return e},e.prototype.C2SReqLimitActLotteryOpenBox=function(t,e){var i=new net_protocol.C2SReqLimitActLotteryOpenBox;i.type=t,i.num=e,this.sendPbPack(Msg.C2SReqLimitActLotteryOpenBox,i,net_protocol.C2SReqLimitActLotteryOpenBox)},e.prototype.S2CRepLimitActLotteryOpenBox=function(t){var i=net_protocol.S2CRepLimitActLotteryOpenBox.decode(t.bytes),n=GlobalConfig.getLottery_base_dataConfig(1),o=e.ins().GetActivityCfgs(1==i.type?30:33),s=o[0];if(void 0!=s){var r=e.ins().GetTrunActBoxAward(i.type,s.id),a=void 0;1==i.type?r?(a=r.box_award,this.recharge_treasure=this.recharge_treasure-i.num*r.treasure_need):(a=n.recharge_box,this.recharge_treasure=this.recharge_treasure-i.num*n.recharge_treasure_need):2==i.type&&(r?(a=r.box_award,this.consume_treasure=this.consume_treasure-i.num*r.treasure_need):(a=n.consume_box,this.consume_treasure=this.consume_treasure-i.num*n.consume_treasure_need));var h=[],l=new ItemExData;l.itemData=UtilProxy.GetItemCellData(a[0],a[1]),h.push(l),ViewManager.ins().open(TreasureView_reward,[!1,h]),EventProxy.Broast(EventType.S2CRepLimitActLotteryOpenBox,[])}},e.prototype.GetTrunActItemList=function(t,e){var i=GlobalConfig.getLottery_item_dataList(t,e);return i||[]},e.prototype.GetTrunActBoxAward=function(t,e){var i=GlobalConfig.getLottery_box_dataConfig(t,e);return i},e.prototype.GetTrunActItem=function(t,e,i){var n=GlobalConfig.getLottery_item_dataList(t,e);return n[i]},e.prototype.C2SReqLimitActGetStateInfo=function(){var t=new net_protocol.C2SReqLimitActGetStateInfo;this.sendPbPack(Msg.C2SReqLimitActGetStateInfo,t,net_protocol.C2SReqLimitActGetStateInfo)},e.prototype.S2CRepLimitActGetStateInfo=function(t){var e=net_protocol.S2CRepLimitActGetStateInfo.decode(t.bytes);this.xian_limitlist=[];for(var i=0;i<e.list.length;i++)this.xian_limitlist[e.list[i].type]=e.list[i];EventProxy.Broast(EventType.S2CRepLimitActGetStateInfo,{})},e.prototype.S2CRepLimitActUpdateStateInfo=function(t){var e=net_protocol.S2CRepLimitActUpdateStateInfo.decode(t.bytes);this.xian_limitlist[e.info.type]=e.info,EventProxy.Broast(EventType.S2CRepLimitActUpdateStateInfo,{}),EventProxy.Broast(EventType.XiuXianUpdate,{})},e.prototype.GetXianLimitActData=function(t){return this.xian_limitlist[t]},e.prototype.IsWXOpen=function(){if(!SystemOpenProxy.ins().isOpen(1,38,!0))return!1;if(PvpProxy.ins().IsInWanxianDay()){var t=this.xian_limitlist[this.DFDFType];if(t&&1==t.state)return!0}return!1},e.prototype.IsDFDFOpen=function(){if(!SystemOpenProxy.ins().isOpen(1,38,!0))return!1;if(!PvpProxy.ins().IsInWanxianDay()){var t=this.xian_limitlist[this.DFDFType];if(t&&1==t.state)return!0}return!1},e.prototype.IsZZZDOpen=function(){if(!SystemOpenProxy.ins().isOpen(1,15,!0))return!1;var t=this.xian_limitlist[this.ZZZDType];return t&&1==t.state?!0:!1},e.prototype.IsZPZBOpen=function(){if(!SystemOpenProxy.ins().isOpen(1,88,!0))return!1;var t=this.xian_limitlist[this.ZPZBType];return t&&1==t.state?!0:!1},e.prototype.IsYLSDOpen=function(){return SystemOpenProxy.ins().isOpen(2,806,!0)?ActivityProxy.ins().isActivityOpenById(ActivityType.Yama):!1},e.prototype.RefreshData=function(t){this.ActDatas[t.act_id]=t;var e=GlobalConfig.getActivity_dataConfig(t.act_id);if(void 0==e)return void(this.RedData[t.act_id]=!1);var i=e.reward_get_type,n=e.total_num;this.IsActiveOpenById(t.act_id)&&(t.is_completed&&(1==i||5==i)&&!t.is_get&&(0==n||n>this.GetActivityTimes(t.act_id))||2==i&&1==t.last_get||3==i&&1==t.last_get)?this.RedData[t.act_id]=!0:this.RedData[t.act_id]=!1},e.prototype.GetActivityTimes=function(t){return this.ActTimesList[t]||0},e.prototype.getLimitGiftBuyNum=function(t){return this.limit_gift_list[t]||0},e.prototype.getSmGiftList=function(){for(var t=this.smGift_list.length-1;t>=0;t--)this.smGift_list[t].end_time<=GameLogic.ins().getServerTime()&&this.smGift_list.splice(t,1);return this.smGift_list},e.prototype.getSmGift=function(t){for(var e=this.smGift_list.length-1;e>=0;e--)if(this.smGift_list[e].gift_id==t)return this.smGift_list[e]},e.prototype.IsActiveOpenById=function(t){var e=GlobalConfig.getActivity_dataConfig(t);return void 0==e?!1:this.OpenActList[t]?!0:!1},e.prototype.IsInServerList=function(t){if(void 0==t||0==t.length)return!0;for(var e=0;e<t.length;e++)if(t[e]==RoleProxy.ins().getRoleServerId())return!0;return!1},e.prototype.DayChange=function(){ViewManager.ins().isShow(KaifuView)&&ViewManager.ins().close(KaifuView),this.ActDatas=[],this.Activites_Type_Tab=[],this.C2SReqLimitActGetList(),this.C2SReqLimitActGetInfo(),this.C2SReqLimitActLotteryInfo()},e.prototype.GetActivityData=function(t){return this.ActDatas[t]},e.prototype.GetActivityCfgs=function(t,e,i){void 0===e&&(e=void 0),void 0===i&&(i=void 0),e=e>0?e:void 0;var n=t;if(e&&(n=100*t+e),i&&(n=200*t+i),(void 0==this.Activites_Type_Tab[n]||0==this.Activites_Type_Tab[n].length)&&this.server_open_days>0){this.Activites_Type_Tab[n]=[];var o=GlobalConfig.getActivitydataList();for(var s in o)o[s].act_type!=t||1!=o[s].is_open||1!=o[s].is_show||void 0!=e&&e!=o[s].act_params[0]&&e!=o[s].sub_type||void 0!=i&&i!=o[s].open_type||!this.IsActiveOpenById(o[s].id)||this.Activites_Type_Tab[n].push(o[s])}return this.Activites_Type_Tab[n]||[]},e.prototype.GetRedByType=function(t,i,n){if(void 0===i&&(i=void 0),void 0===n&&(n=void 0),34==t){var o=e.ins().GetActivityCfgs(34);for(var s in o){var r=e.ins().GetActivityData(o[s].id);if(r){var a=r.params[0]||0,h=r.params[1]||0;if(a-h>0)return!0}}return this.IsShow34ActRed?!0:!1}if(30==t){var o=e.ins().GetActivityCfgs(t,i),l=o[0],p=void 0;return l&&(p=e.ins().GetTrunActBoxAward(1,l.id)),l&&p?e.ins().recharge_num>=p.take_need||e.ins().recharge_treasure>=p.treasure_need:e.ins().recharge_num>=GlobalConfig.getLottery_base_dataConfig(1).recharge_need||e.ins().recharge_treasure>=GlobalConfig.getLottery_base_dataConfig(1).recharge_treasure_need}if(33==t){var o=e.ins().GetActivityCfgs(t,i),l=o[0],p=void 0;return l&&(p=e.ins().GetTrunActBoxAward(2,l.id)),l&&p?e.ins().consume_num>=p.take_need||e.ins().consume_treasure>=p.treasure_need:e.ins().consume_num>=GlobalConfig.getLottery_base_dataConfig(1).consume_need||e.ins().consume_treasure>=GlobalConfig.getLottery_base_dataConfig(1).consume_treasure_need}if(35==t){var c=e.ins().GetActivityCfgs(t,i),l=c[0];if(void 0==l)return!1;var u=e.ins().getGiftDataListById(l.id),d=e.ins().getMyCrossScore(t);for(var g in u){var y=RoleProxy.ins().getMoneyAttr(u[g].consume[0]),f=e.ins().getLimitGiftBuyNum(u[g].id);if(y>u[g].consume[1]&&f<u[g].limit_num&&d>=u[g].wealth)return!0}return!1}if(22==t){if(99==i){var c=e.ins().GetActivityCfgs(t,i),l=c[0];if(void 0==l)return!1;var u=e.ins().getGiftDataListById(l.id)[0],f=e.ins().getLimitGiftBuyNum(u.id),_=u.vip_buy_times,v=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),y=RoleProxy.ins().getMoneyAttr(u.consume[0]),m=u.consume[1],C=0;return C=void 0!=m[f]?m[f]:m[m.length-1],f<_[v]&&y>=C?!0:!1}if(98==i){var c=e.ins().GetActivityCfgs(t,i),l=c[0];if(void 0==l)return!1;var u=e.ins().getGiftDataListById(l.id)[0],C=u.consume[1],f=e.ins().getLimitGiftBuyNum(u.id),S=u.limit_num,y=RoleProxy.ins().getMoneyAttr(u.consume[0]),w=c[0].total_num-e.ins().GetActivityTimes(c[0].id);if(S>f&&y>=C&&w>0)return!0
}return!1}for(var s in this.RedData){var p=GlobalConfig.getActivity_dataConfig(Number(s));if(this.RedData[s]&&p.act_type==t&&(void 0==i||i==p.act_params[1]||i==p.sub_type)&&(void 0==n||n==p.open_type)&&this.getVipAwardRed(Number(s)))return!0}if(22==t){var o=e.ins().GetActivityCfgs(22,i);for(var s in o){var u=e.ins().getGiftDataListById(o[s].id);for(var x in u)if(this.getGiftCanBuyById(u[x].id))return!0}}return!1},e.prototype.getLianChong=function(t){var e=GlobalConfig.getContinuousAct_idConfigList();for(var i in e)if(e[i].min<=t&&t<=e[i].max){var n=GlobalConfig.getContinuousAct_idConfig(Number(i));return n.is_money}},e.prototype.GetActEndTime=function(t){var e=0;if(1==t.open_type){var i=new Date(t.end_time);e=Math.floor(i.getTime()/1e3)}else if(4==t.open_type&&98!=t.sub_type){var n=this.server_open_days-1,o=t.server_open_time[1]+t.server_open_time[0]-n+t.disappear_time-1;t.cyclic_num>0&&(o=t.server_open_time[1]+t.disappear_time-1);var s=this.GetServerTimeDataByPassDay(o),r=UtilProxy.getStr("@0 /@1 /@2  23:59:59",[s.getFullYear(),s.getMonth()+1,s.getDate()]);e=new Date(r).getTime()/1e3}else if(6==t.open_type){var n=this.srv_combine_day-1,o=t.server_open_time[1]+t.server_open_time[0]-n+t.disappear_time-1;t.cyclic_num>0&&(o=t.server_open_time[1]+t.disappear_time-1);var s=this.GetServerTimeDataByPassDay(o),r=UtilProxy.getStr("@0 /@1 /@2  23:59:59",[s.getFullYear(),s.getMonth()+1,s.getDate()]);e=new Date(r).getTime()/1e3}else if(2==t.open_type||4==t.open_type&&98==t.sub_type)for(var a=GameLogic.ins().getServerTime(),h=new Date(1e3*a),l=0;l<t.open_time.length;l++){var r=UtilProxy.getStr("@0 /@1 /@2  @3 :@4 :@5 ",[h.getFullYear(),h.getMonth()+1,h.getDate(),t.open_time[l][0],t.open_time[l][1],t.open_time[l][2]]),p=new Date(r).getTime()/1e3,c=p+t.dur_s[l];a>=p&&c>=a&&(e=c)}else if(5==t.open_type){var u=RoleProxy.ins().getCreateTime();e=u+t.dur_s[0]}else if(t.dur_s[0]>0){var s=this.GetServerTimeDataByPassDay(0),r=UtilProxy.getStr("@0 /@1 /@2  23:59:59",[s.getFullYear(),s.getMonth()+1,s.getDate()]);e=new Date(r).getTime()/1e3}return e},e.prototype.GetServerTimeDataByPassDay=function(t){var e=GameLogic.ins().getServerTime(),i=e+24*t*60*60;return this.GetDataByTime(i)},e.prototype.GetDataByTime=function(t){return new Date(1e3*t)},e.prototype.GetRankDataByAct_id=function(t,e){void 0===e&&(e=!1);var i=GlobalConfig.getActivity_dataConfig(t);if(void 0==i)return[];var n=[],o=0,s=0;if(13==i.act_type){var r=i.act_params[0];if(n=RankProxy.ins().getTotleRanklistByType(r),o=i.act_params[1],8==i.reward_type){var a=RankProxy.ins().getRankTopByType(i.act_params[0]),h=this.getRankRacAwardInfo(1,i);s=a&&a.value>=h[2][0][0]&&!e?1:0}}else o=i.act_params[0],n=this.ActRankList;for(var l=[],p=i.act_award.length,c=13!=i.act_type||e?0:1,u=c;p>u;u++){var d=void 0,g=0,y=0;if(13==i.act_type?(d=new ranks_role,n[u]&&(g=n[u].value),n[s]&&(y=n[s].value)):(d=new S2CActRankInfo,n[u]&&(g=n[u].score),n[s]&&(y=n[s].score)),8==i.reward_type){var h=this.getRankRacAwardInfo(u+1,i),f=0;h&&(f=h[2][0][0]),n[s]&&y>=f?(d.role_id=n[s].role_id,d.name=n[s].name,d.prof=n[s].prof,d.zhuan=n[s].zhuan,d.level=n[s].level,d.fight=n[s].fight,d.faction=n[s].faction,d.time=n[s].time,d.value=n[s].value,d.use_head_id=n[s].use_head_id,d.use_head_frame_id=n[s].use_head_frame_id,d.vip=n[s].vip,d.fashion=n[s].fashion,d.shenbing=n[s].shenbing,d.wing=n[s].wing,d.belle=n[s].belle,d.horse=n[s].horse,d.pet=n[s].pet,d.reputation=n[s].reputation,d.title=n[s].title,d.marry_name=n[s].marry_name,s+=1):d.value=f,d.index=u+1}else n[u]&&g>=o?d=n[u]:n[u]?d.index=n[u].index:d.index=u+1;l.push(d)}return l},e.prototype.GetMyRankIndex=function(t){for(var e=0,i=this.GetRankDataByAct_id(t,!0),n=0;n<i.length;n++)i[n].role_id&&i[n].role_id==RoleProxy.ins().getRoleId()&&(e=i[n].index);return e},e.prototype.getRankRacAwardInfo=function(t,e){for(var i=0;i<e.act_award.length;i++)if(t>=e.act_award[i][0]&&t<=e.act_award[i][1])return e.act_award[i]},e.prototype.getCfgByTabList=function(t,e,i){for(var n=0;n<t.length;n++)if(t[n].act_type==e&&t[n].sub_type==i)return t[n]},e.prototype.getGiftDataListById=function(t){var e=GlobalConfig.getLimitActGiftList(),i=[];for(var n in e)e[n].act_id==t&&i.push(e[n]);return i},e.prototype.getGiftCanBuyById=function(t){var i=GlobalConfig.getLimit_act_gift_dataConfig(t);return void 0==i?!1:i.vip_level>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)?!1:i.limit_num<=e.ins().getLimitGiftBuyNum(i.id)?!1:i.consume[1]>BagProxy.ins().getItemCountById(i.consume[0])?!1:!0},e.prototype.GetExtraItem=function(t){var e=GlobalConfig.getActivity_dataConfig(t);if(void 0!=e&&0!=e.extra_reward){if(e.extra_reward&&0!=e.extra_reward)for(var i in this.extra_act_list)if(this.extra_act_list[i]==t)return;return e.extra_reward}},e.prototype.GetKaifuTabCf=function(){if(SystemOpenProxy.ins().isOpen(1,46,!0)){var t=GlobalConfig.getOpenserver_viewtabConfig(1);if(t)return this.GetActivityCfgs(t.act_type,t.sub_type)[0]}},e.prototype.GetKaifuRed=function(){var t=GlobalConfig.getOpenServerViewTab();for(var i in t){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n)&&22!=t[i].act_type)return!0}return!1},e.prototype.GetKuafuTabCf=function(){if(SystemOpenProxy.ins().isOpen(1,46,!0)){var t=GlobalConfig.getKuafu_viewtabConfig(1);if(t)return this.GetActivityCfgs(t.act_type,t.sub_type)[0]}},e.prototype.GetKuafuRed=function(){var t=GlobalConfig.getKuafuViewTab();for(var i in t){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n)&&22!=t[i].act_type)return!0}return!1},e.prototype.GetJCTabCf=function(){if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&SystemOpenProxy.ins().isOpen(1,61,!0)){var t=GlobalConfig.getJCViewTab();for(var e in t){var i=this.GetActivityCfgs(t[e].act_type,t[e].sub_type)[0];if(i)return i}}},e.prototype.GetJieRiTabCf=function(){if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&SystemOpenProxy.ins().isOpen(1,102,!0)){var t=GlobalConfig.getJieRiViewTab();for(var e in t){var i=this.GetActivityCfgs(t[e].act_type,t[e].sub_type)[0];if(i)return i}}},e.prototype.GetLimitedGifsTabCf=function(){if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&SystemOpenProxy.ins().isOpen(1,92,!0)){var t=GlobalConfig.getLimitedGifsViewTab();for(var e in t){var i=this.GetActivityCfgs(t[e].act_type,t[e].sub_type)[0];if(i)return i}}},e.prototype.GetRechargeTrunCf=function(){if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&SystemOpenProxy.ins().isOpen(1,61,!0)){var t=GlobalConfig.getJCViewTab();for(var e in t)if(30==t[e].act_type){var i=this.GetActivityCfgs(t[e].act_type,t[e].sub_type)[0];if(i)return i}}},e.prototype.GetLianChongRed=function(){var t=GlobalConfig.getJCViewTab();for(var i in t)if(17==t[i].act_type){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n)&&22!=t[i].act_type)return!0}return!1},e.prototype.GetJCRed=function(){var t=GlobalConfig.getJCViewTab();for(var i in t){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n)&&22!=t[i].act_type)return!0}return!1},e.prototype.GetJieRiRed=function(){var t=GlobalConfig.getJieRiViewTab();for(var i in t){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n)&&22!=t[i].act_type)return!0}return!1},e.prototype.GetLimitedGifsRed=function(){var t=GlobalConfig.getLimitedGifsViewTab();for(var i in t){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n))return!0}return!1},e.prototype.isGifsTabOpen=function(){var t=GlobalConfig.getLimitedGifsViewTab();for(var i in t){var n=e.ins().GetActivityCfgs(t[i].act_type,t[i].sub_type);if(n.length>0)return!0}return!1},e.prototype.GetRechargeTrunRed=function(){var t=GlobalConfig.getJCViewTab();for(var i in t)if(30==t[i].act_type){var n=0!=t[i].sub_type?t[i].sub_type:void 0;if(e.ins().GetRedByType(t[i].act_type,n)&&22!=t[i].act_type)return!0}return!1},e.prototype.GetDayRechargeCf=function(){if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&SystemOpenProxy.ins().isOpen(1,67,!0)){var t=this.GetActivityCfgs(4,1);if(t&&t.length>0)for(var i=0;i<t.length;i++){var n=e.ins().GetActivityData(t[i].id);if(void 0==n||1!=n.is_get){if(0==t[i].prev_act)return t[i];var o=this.GetActivityData(t[i].prev_act);if(void 0==o||1!=n.is_get)return t[i]}}}},e.prototype.GetZhigouGiftCf=function(t){if(!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck){var i=6==t?98:97;if(97==i&&SystemOpenProxy.ins().isOpen(2,100*i+t,!0)||98==i&&SystemOpenProxy.ins().isOpen(1,i,!0)){var n=this.GetActivityCfgs(4,t);if(n&&n.length>0)for(var o=0;o<n.length;o++){var s=e.ins().GetActivityData(n[o].id);if(void 0==s||1!=s.is_get){if(0==n[o].prev_act)return n[o];var r=this.GetActivityData(n[o].prev_act);if(void 0==r||1!=s.is_get)return n[o]}}}}},e.prototype.IsFristRechargeOpen=function(){if((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)||!SystemOpenProxy.ins().isOpen(1,62,!0))return!1;var t=this.GetActivityCfgs(1)[0];if(void 0==t)return!1;var e=this.GetActivityData(t.id);return e&&e.is_get?!1:!0},e.prototype.IsLimitRechargeOpen=function(){if((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)||!SystemOpenProxy.ins().isOpen(1,83,!0))return!1;var t=this.GetActivityCfgs(2,4),e=t[0];if(void 0==e)return!1;for(var i=0;i<t.length;i++){var n=this.GetActivityData(t[i].id);if(void 0==n||!n.is_get)return!0}return!1},e.prototype.getLuxuryFRCf=function(){if((!DeviceUtils.IsIos||!DeviceUtils.IsQQ&&!SdkManager.ins().IsInCheck)&&SystemOpenProxy.ins().isOpen(1,54,!0)){var t=this.GetActivityCfgs(2,1);if(t.sort(this.sortCfs),!(t.length<=0)){var e=t[0].prev_act,i=this.GetActivityData(e);if(!(e>0)||void 0!=i&&i.is_get)for(var n=0;n<t.length;n++){var o=this.GetActivityData(t[n].id);if(void 0==o||!o.is_get)return t[n]}}}},e.prototype.sortCfs=function(t,e){return t.act_params[0]<e.act_params[0]?-1:t.act_params[0]>e.act_params[0]?1:0},e.prototype.IsDayFROpen=function(){if((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)||this.IsFristRechargeOpen()||!SystemOpenProxy.ins().isOpen(1,51,!0))return!1;var t=this.GetActivityCfgs(3,1);if(t.length<=0)return!1;var e=t[0].prev_act,i=this.GetActivityData(e);if(e>0&&(void 0==i||!i.is_get))return!1;for(var n=0;n<t.length;n++){var o=this.GetActivityData(t[n].id);if(void 0==o||!o.is_get)return!0}for(var s=this.GetActivityCfgs(17),n=0;n<s.length;n++){var o=this.GetActivityData(s[n].id);if(void 0==o||!o.is_get)return!0}return!1},e.prototype.IsOnActRankSys=function(t){var i=e.ins().GetKaifuTabCf()||e.ins().GetKuafuTabCf();return void 0==i?!1:i.system_id==t},e.prototype.GetLandingActList=function(t){var i=e.ins().GetActivityCfgs(18,t),n=[];for(var o in i){if(i[o].act_award[0]&&i[o].act_award[0]>0){var s={act_id:i[o].id,index:0,drop_id:i[o].act_award[0]};n.push(s)}if(i[o].vip_award.length>0){for(var r=-1,a=0;a<i[o].vip_award.length;a++){var h=a+1;if(this.IsVIPAwardCanShow(i[o].id,h)){r=a;var s={act_id:i[o].id,index:h,drop_id:i[o].vip_award[a][1]};n.push(s)}}if(i[o].vip_award[r+1]){var s={act_id:i[o].id,index:r+2,drop_id:i[o].vip_award[r+1][1]};n.push(s)}}}return n},e.prototype.getVipAwardRed=function(t){var e=GlobalConfig.getActivity_dataConfig(t);if(e.vip_award.length<=0)return!0;for(var i=0;i<e.vip_award.length;i++)if(this.IsVIPAwardCanShow(e.id,i+1)&&!this.IsVIPAwardHasGet(e.id,i+1))return!0;return!1},e.prototype.IsVIPAwardCanShow=function(t,e){if(this.vip_awards[t]){var i=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),n=GlobalConfig.getActivity_dataConfig(t);if(i<n.vip_award[e-1][0])return!1;if(void 0==n.vip_award[e]||n.vip_award[e][0]>i)return!0;if(this.vip_awards[t].finish_vip_level>n.vip_award[e-1][0]&&n.vip_award[e])return!1;if(i>this.vip_awards[t].finish_vip_level)return!this.IsVIPAwardHasGet(t,e)}return!1},e.prototype.IsVIPAwardHasGet=function(t,e){if(void 0==this.vip_awards[t])return!1;for(var i in this.vip_awards[t].get_awards)if(this.vip_awards[t].get_awards[i]==e)return!0;return!1},e.prototype.GetSevenDayFirstName=function(t){for(var e in this.rank_first_list)if(this.rank_first_list[e].act_id==t)return this.rank_first_list[e].name;return"虚位以待"},e.prototype.GetOpenSerPassTimeDataStr=function(t){var e=GameLogic.ins().getServerTime(),i=e-24*(this.server_open_days-1-t)*60*60,n=new Date(1e3*i);return UtilProxy.getStr("@0 月@1 日",[n.getMonth()+1,n.getDate()])},e.prototype.IsSevenDayRankAct=function(t){var e=GlobalConfig.getFirst_rank_index_dataList();for(var i in e)if(e[i].id==t)return!0;return!1},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25154,this.S2CRepMiscGetSaveInfo,this),MsgHandle.ins().regNetMsg(27250,this.S2CRepLimitActOpen,this),MsgHandle.ins().regNetMsg(27251,this.S2CRepLimitActClose,this),MsgHandle.ins().regNetMsg(27252,this.S2CRepLimitActGetInfo,this),MsgHandle.ins().regNetMsg(27253,this.S2CRepLimitActDel,this),MsgHandle.ins().regNetMsg(27254,this.S2CRepLimitActUpdate,this),MsgHandle.ins().regNetMsg(27255,this.S2CRepLimitActGetReward,this),MsgHandle.ins().regNetMsg(27256,this.S2CRepLimitActGetList,this),MsgHandle.ins().regNetMsg(27257,this.S2CRepLimitActGetGiftPack,this),MsgHandle.ins().regNetMsg(27259,this.S2CRepLimitActGetTimes,this),MsgHandle.ins().regNetMsg(27261,this.S2CRepLimitActRechargeRecord,this),MsgHandle.ins().regNetMsg(27262,this.S2CRepLimitActGetRankData,this),MsgHandle.ins().regNetMsg(27267,this.S2CRepLimitActItemExchange,this),MsgHandle.ins().regNetMsg(27268,this.S2CRepLimitActChargeNum,this),MsgHandle.ins().regNetMsg(27274,this.S2CRepLimitActGetExchangeData,this),MsgHandle.ins().regNetMsg(27275,this.S2CRepLimitActExchangeItem,this),MsgHandle.ins().regNetMsg(27277,this.S2CRepLimitActBuyGift,this),MsgHandle.ins().regNetMsg(27278,this.S2CRepLimitActRemove,this),MsgHandle.ins().regNetMsg(27279,this.S2CRepLimitActConsumeRank,this),MsgHandle.ins().regNetMsg(27280,this.S2CRepLimitActLotteryInfo,this),MsgHandle.ins().regNetMsg(27281,this.S2CRepLimitActLotteryTake,this),MsgHandle.ins().regNetMsg(27282,this.S2CRepLimitActLotteryOpenBox,this),MsgHandle.ins().regNetMsg(27283,this.S2CRepLimitActGetStateInfo,this),MsgHandle.ins().regNetMsg(27284,this.S2CRepLimitActUpdateStateInfo,this),MsgHandle.ins().regNetMsg(27285,this.S2CRepLimitActGetVipAward,this),MsgHandle.ins().regNetMsg(27264,this.S2CRepLimitActBuySmGift,this),MsgHandle.ins().regNetMsg(27265,this.S2CRepLimitActSmGiftAppear,this)},e}(BaseSystem);__reflect(LimitActProxy.prototype,"LimitActProxy");var LocalStorageProxy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.SetItem=function(t,e){egret.localStorage.setItem(t,e)},e.prototype.getItem=function(t){var e=egret.localStorage.getItem(t);return e},e.prototype.RomoveItem=function(t){egret.localStorage.removeItem(t)},e}(BaseClass);__reflect(LocalStorageProxy.prototype,"LocalStorageProxy");var serverItemData=function(){function t(){}return t}();__reflect(serverItemData.prototype,"serverItemData");var LoginProxy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.role_index=0,e.role_id=0,e.isCreateRole=!1,e.rsid=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.GetServerList=function(){var t=this.getLocalStorage("user_name"),e=new Array;if(null!=t&&t.length>0){var i="";i=DeviceUtils.IsWx?t+"serverWx":t+"server";var n=LocalStorageProxy.ins().getItem(i);if(null!=n&&n.length>0)for(var o=n.split(";"),s=0;s<o.length;s++){var r=o[s].split(","),a=new serverItemData;a.server_id=Number(r[0]),a.level=Number(r[1]),e[s]=a}}return e},e.prototype.isHistoryServer=function(t){if(!this.history_server){this.history_server={};var e=this.getLocalStorage("user_name");if(null!=e&&e.length>0){var i="";i=DeviceUtils.IsWx?e+"serverWx":e+"server";var n=LocalStorageProxy.ins().getItem(i);if(null!=n&&n.length>0)for(var o=n.split(";"),s=0;s<o.length;s++){var r=o[s].split(",");this.history_server[Number(r[0])]=!0}}}return this.history_server[t]},e.prototype.isHaveMyServer=function(){var t=this.GetServerList();if(t.length>0)for(var e=0;e<t.length;++e){var i=t[e].server_id,n=this.GetServerConfig(i);if(null!=n)return!0}return!1},e.prototype.GetServerConfig=function(t){var e=SdkManager.ins().getServerList();if(e.length>0){for(var i=0;i<e.length;++i)if(e[i].server_id==t)return e[i]}else if(!SdkManager.isUseSdk)for(var n in GlobalConfig.ins().ServerConfig){var o=GlobalConfig.ins().ServerConfig[n];if(o.server_id==t)return o}},e.prototype.getServerList=function(){if(0==SdkManager.ins().getServerList().length){if(SdkManager.isUseSdk)return[];var t=[];for(var e in GlobalConfig.ins().ServerConfig)t.push(GlobalConfig.ins().ServerConfig[e]);return t}var i=SdkManager.ins().getServerList();return i.sort(this.sortById),i},e.prototype.sortById=function(t,e){return t.server_id>e.server_id?-1:1},e.prototype.SetServerList=function(t){var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),i="",n=new Array;n=this.GetServerList();for(var o=n.length,s=!1,r=0;o>r;r++)n[r].server_id!=t&&(s=!0,i=""==i?n[r].server_id+","+n[r].level:i+";"+n[r].server_id+","+n[r].level);i=s?i+";"+t+","+e:t+","+e,this.setLocalStorage(this.getLocalStorage("user_name")+"server",i)},e.prototype.setLocalStorage=function(t,e){DeviceUtils.IsWx&&(t+="Wx"),LocalStorageProxy.ins().SetItem(t,e)},e.prototype.getLocalStorage=function(t){return DeviceUtils.IsWx&&(t+="Wx"),LocalStorageProxy.ins().getItem(t)},e}(BaseClass);__reflect(LoginProxy.prototype,"LoginProxy");var SwordOppInfo=function(){function t(){}return t}();__reflect(SwordOppInfo.prototype,"SwordOppInfo");var SwordRankObjInfo=function(){function t(){}return t}();__reflect(SwordRankObjInfo.prototype,"SwordRankObjInfo");var FactionswordReport=function(){function t(){}return t}();__reflect(FactionswordReport.prototype,"FactionswordReport");var LunjianProxy=function(t){function e(){var e=t.call(this)||this;return e.score_awards=[],e.ranklists=[],e.CurRankType=1,e.oppname="",e}return __extends(e,t),e.prototype.getrank=function(){return this.rank||0},e.prototype.getfaction_rank=function(){return this.faction_rank||0},e.prototype.getscore=function(){return this.score||0},e.prototype.getbuy_challenge_times=function(){return this.buy_challenge_times||0},e.prototype.getleft_challenge_times=function(){return this.left_challenge_times||0},e.prototype.getnext_recover_time=function(){return this.next_recover_time||0},e.prototype.getranklists=function(t){return this.ranklists?this.ranklists[t]||[]:[]},e.prototype.getreports=function(){return this.reports||[]},e.prototype.getopps=function(){return this.opps||[]},e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqFactionswordGetInfo=function(){var t=new net_protocol.C2SReqFactionswordGetInfo;this.sendPbPack(Msg.C2SReqFactionswordGetInfo,t,net_protocol.C2SReqFactionswordGetInfo)},e.prototype.C2SReqFactionswordRefreshOpp=function(){var t=new net_protocol.C2SReqFactionswordRefreshOpp;this.sendPbPack(Msg.C2SReqFactionswordRefreshOpp,t,net_protocol.C2SReqFactionswordRefreshOpp)},e.prototype.C2SReqFactionswordChallenge=function(t,e){var i=new net_protocol.C2SReqFactionswordChallenge;i.id=t,i.role_id=e,this.sendPbPack(Msg.C2SReqFactionswordChallenge,i,net_protocol.C2SReqFactionswordChallenge)},e.prototype.C2SReqFactionswordSweep=function(t,e){var i=new net_protocol.C2SReqFactionswordSweep;i.id=t,i.role_id=e,this.sendPbPack(Msg.C2SReqFactionswordSweep,i,net_protocol.C2SReqFactionswordSweep)},e.prototype.C2SReqFactionswordBuyChallenge=function(t){var e=new net_protocol.C2SReqFactionswordBuyChallenge;e.num=t,this.sendPbPack(Msg.C2SReqFactionswordBuyChallenge,e,net_protocol.C2SReqFactionswordBuyChallenge)},e.prototype.C2SReqFactionswordGetRankList=function(t){var e=new net_protocol.C2SReqFactionswordGetRankList;e.rank_type=t,this.sendPbPack(Msg.C2SReqFactionswordGetRankList,e,net_protocol.C2SReqFactionswordGetRankList)},e.prototype.C2SReqFactionswordGetScoreAward=function(t){var e=new net_protocol.C2SReqFactionswordGetScoreAward;e.index=t,this.sendPbPack(Msg.C2SReqFactionswordGetScoreAward,e,net_protocol.C2SReqFactionswordGetScoreAward)},e.prototype.C2SReqFactionswordLoadingFinish=function(){var t=new net_protocol.C2SReqFactionswordLoadingFinish;this.sendPbPack(Msg.C2SReqFactionswordLoadingFinish,t,net_protocol.C2SReqFactionswordLoadingFinish)},e.prototype.S2CRepFactionswordGetInfo=function(t){var e=net_protocol.S2CRepFactionswordGetInfo.decode(t.bytes);this.rank=e.rank,this.faction_rank=e.faction_rank,this.score=e.score,this.buy_challenge_times=e.buy_challenge_times,this.left_challenge_times=e.left_challenge_times,this.next_recover_time=e.next_recover_time,this.score_awards=[],this.score_awards=e.score_awards,this.opps=[];for(var i=0;i<e.opps.length;i++){var n=e.opps[i];this.opps.push(n)}this.reports=[];for(var i=0;i<e.reports.length;i++){var o=new FactionswordReport;o.id=e.reports[i].id,o.name=e.reports[i].name,o.other_name=e.reports[i].other_name,o.time=e.reports[i].time,o.reportid=UtilProxy.GetRandomNum(1,this.GetMaxByData(GlobalConfig.getFactionReprotList())),this.reports[o.id]=o}EventProxy.Broast(EventType.S2CRepFactionswordGetInfo,{})},e.prototype.GetMaxByData=function(t){var e=0;for(var i in t)t[i]&&(e+=1);return e},e.prototype.S2CRepFactionswordRefreshOpp=function(t){var e=net_protocol.S2CRepFactionswordRefreshOpp.decode(t.bytes);this.opps=[];for(var i=0;i<e.opps.length;i++){var n=e.opps[i];this.opps.push(n)}EventProxy.Broast(EventType.S2CRepFactionswordRefreshOpp,{})},e.prototype.S2CRepFactionswordChallenge=function(t){var e=net_protocol.S2CRepFactionswordChallenge.decode(t.bytes);0==e.result?(this.left_challenge_times=this.left_challenge_times-1,this.next_recover_time=GameLogic.ins().getServerTime()+GlobalConfig.getFaction_sword_paramConfig(1).recover_time,ViewManager.ins().close(LunjianView)):1==e.result&&(TipsControl.ins().showTips("该玩家正在进行战斗"),this.C2SReqFactionswordRefreshOpp()),EventProxy.Broast(EventType.S2CRepFactionswordChallenge,{})},e.prototype.S2CRepFactionswordSweep=function(t){var e=net_protocol.S2CRepFactionswordSweep.decode(t.bytes);this.C2SReqFactionswordRefreshOpp();var i=[];i=0==e.result?GlobalConfig.getFaction_sword_opp_dataConfig(e.opp_cfg_id).win_award:GlobalConfig.getFaction_sword_opp_dataConfig(e.opp_cfg_id).lose_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |\n获得@1 积分",[this.oppname,e.score]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!\n获得@1 积分",[this.oppname,e.score]),ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.LUNJIAN,a),EventProxy.Broast(EventType.S2CRepFactionswordSweep,{})},e.prototype.S2CRepFactionswordUpdateInfo=function(t){var e=net_protocol.S2CRepFactionswordUpdateInfo.decode(t.bytes);this.rank=e.rank,this.faction_rank=e.faction_rank,this.score=e.score,this.buy_challenge_times=e.buy_challenge_times,this.left_challenge_times=e.left_challenge_times,this.next_recover_time=e.next_recover_time,EventProxy.Broast(EventType.S2CRepFactionswordUpdateInfo,{})},e.prototype.S2CRepFactionswordGetRankList=function(t){var e=net_protocol.S2CRepFactionswordGetRankList.decode(t.bytes);this.ranklists[e.rank_type]=[];for(var i=0;i<e.list.length;i++){var n=e.list[i];this.ranklists[e.rank_type].push(n)}this.ranklists[e.rank_type].sort(this.sort),EventProxy.Broast(EventType.S2CRepFactionswordGetRankList,{})},e.prototype.sort=function(t,e){return t.rank<e.rank?-1:t.rank>e.rank?1:0},e.prototype.S2CRepFactionswordGetScoreAward=function(t){var e=net_protocol.S2CRepFactionswordGetScoreAward.decode(t.bytes);this.score_awards.push(e.index),EventProxy.Broast(EventType.S2CRepFactionswordGetScoreAward,{})},e.prototype.S2CRepFactionswordChallengeResult=function(t){var e=net_protocol.S2CRepFactionswordChallengeResult.decode(t.bytes),i=[];i=0==e.result?GlobalConfig.getFaction_sword_opp_dataConfig(e.opp_cfg_id).win_award:GlobalConfig.getFaction_sword_opp_dataConfig(e.opp_cfg_id).lose_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |\n获得@1 积分",[this.oppname,e.score]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!\n获得@1 积分",[this.oppname,e.score]),ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.LUNJIAN,a),EventProxy.Broast(EventType.S2CRepFactionswordChallengeResult,{})},e.prototype.S2CRepFactionswordUpdateReport=function(t){var e=net_protocol.S2CRepFactionswordUpdateReport.decode(t.bytes),i=new FactionswordReport;i.id=e.report.id,i.name=e.report.name,i.other_name=e.report.other_name,i.time=e.report.time,i.reportid=UtilProxy.GetRandomNum(1,this.GetMaxByData(GlobalConfig.getFactionReprotList())),this.reports[i.id]=i,EventProxy.Broast(EventType.S2CRepFactionswordUpdateReport,{})},e.prototype.GetCurMaxScore=function(){var t=0,e=GlobalConfig.getFactionScoreList(),i=0;for(var n in e)this.score<=e[n].score&&(t=0==t?e[n].score:Math.min(t,e[n].score)),i=Math.max(i,e[n].score);return 0==t&&(t=i),t},e.prototype.getScoreAwardState=function(t){for(var e=0;e<this.score_awards.length;e++)if(t==this.score_awards[e])return 2;var i=GlobalConfig.getFaction_sword_score_award_dataConfig(t);return this.score>=i.score?0:1},e.prototype.getAwardRed=function(){var t=GlobalConfig.getFactionScoreList();for(var i in t){var n=e.ins().getScoreAwardState(t[i].id);if(0==n)return!0}return!1},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,13,!0)?e.ins().getleft_challenge_times()>0||this.getAwardRed():!1},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(28100,this.S2CRepFactionswordGetInfo,this),MsgHandle.ins().regNetMsg(28101,this.S2CRepFactionswordRefreshOpp,this),MsgHandle.ins().regNetMsg(28102,this.S2CRepFactionswordChallenge,this),MsgHandle.ins().regNetMsg(28103,this.S2CRepFactionswordSweep,this),MsgHandle.ins().regNetMsg(28104,this.S2CRepFactionswordUpdateInfo,this),MsgHandle.ins().regNetMsg(28105,this.S2CRepFactionswordGetRankList,this),MsgHandle.ins().regNetMsg(28106,this.S2CRepFactionswordGetScoreAward,this),MsgHandle.ins().regNetMsg(28107,this.S2CRepFactionswordChallengeResult,this),MsgHandle.ins().regNetMsg(28108,this.S2CRepFactionswordUpdateReport,this)},e}(BaseSystem);__reflect(LunjianProxy.prototype,"LunjianProxy");var LyhProxy=function(t){function e(){var e=t.call(this)||this;return e.auto_enter_copy=!1,e.id=0,e.kill_num=0,e.lianyao=0,e.get_id=0,e.isinit=!1,e.show_reward_id=0,e.first_name="",e.layer_list=[],e.sweep_max=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27450,this.S2CRepLyhGetInfo,this),MsgHandle.ins().regNetMsg(27451,this.S2CRepLyhGetReward,this),MsgHandle.ins().regNetMsg(27452,this.S2CRepLyhSweep,this),MsgHandle.ins().regNetMsg(27453,this.S2CRepLyhUpdateAwardZhenbao,this),MsgHandle.ins().regNetMsg(27454,this.S2CRepLyhUpdateLayerInfo,this)},e.prototype.C2SReqLyhGetInfo=function(){var t=new net_protocol.C2SReqLyhGetInfo;this.sendPbPack(Msg.C2SReqLyhGetInfo,t,net_protocol.C2SReqLyhGetInfo)},e.prototype.C2SReqLyhGetReward=function(t){var e=new net_protocol.C2SReqLyhGetReward;e.index=t,this.sendPbPack(Msg.C2SReqLyhGetReward,e,net_protocol.C2SReqLyhGetReward)},e.prototype.C2SReqLyhSweep=function(){var t=new net_protocol.C2SReqLyhSweep;this.sendPbPack(Msg.C2SReqLyhSweep,t,net_protocol.C2SReqLyhSweep)},e.prototype.C2SReqLyhGetLayerAward=function(t){var e=new net_protocol.C2SReqLyhGetLayerAward;e.pass_id=t,this.sendPbPack(Msg.C2SReqLyhGetLayerAward,e,net_protocol.C2SReqLyhGetLayerAward)},e.prototype.S2CRepLyhGetInfo=function(t){var e=net_protocol.S2CRepLyhGetInfo.decode(t.bytes);if(this.id=e.id,this.kill_num=e.kill_num,this.lianyao=e.lianyao,this.get_id=e.get_id,this.sweep_times=e.sweep_times,this.first_name=e.name,this.layer_list=e.layer_info,this.isinit&&(this.show_reward_id=e.id),this.isinit=!0,this.id>0){var i=GlobalConfig.getLyhConfigById(this.id);i&&i.next_id>this.id?this.cur_data=GlobalConfig.getLyhConfigById(i.next_id):this.cur_data=void 0}else this.cur_data=GlobalConfig.getLyhConfigById(1);XiuXianProxy.ins().updateZhuanRed();var n=this.getExtraId(this.id);if(n>0){var o=GlobalConfig.getLyhConfigById(n);if(o&&this.id>=o.id&&1==o.extra_reward[0]){var s=o.extra_reward[1];if(!SkillProxy.ins().isActive(s)){var r=[{skill_id:s,count:1}];SkillProxy.ins().C2SReqSkillUpgrade(r)}}}SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.LYH),XiuXianProxy.ins().updateAchieRed(AchieType.lyh),EventProxy.Broast(EventType.S2CRepLyhGetInfo,[])},e.prototype.S2CRepLyhGetReward=function(t){var e=net_protocol.S2CRepLyhGetReward.decode(t.bytes);this.get_id=e.index,EventProxy.Broast(EventType.S2CRepLyhGetReward,[this.get_id])},e.prototype.S2CRepLyhSweep=function(t){net_protocol.S2CRepLyhSweep.decode(t.bytes);this.sweep_times=this.sweep_times+1;var e=this.id,i=GlobalConfig.getLyhConfigById(e);i||(i=GlobalConfig.getLyhConfigById(1));for(var n=0,o=0,s=0,r=(i.show_item,0);r<i.award_data.length;r++){var a=i.award_data[r];a[0]==MoneyAttr.EXP?n=96*a[1]:a[0]==MoneyAttr.COIN?o=96*a[1]:a[0]==MoneyAttr.ZHENQI&&(s=96*a[1])}for(var h=[{id:MoneyAttr.EXP,val:n},{id:MoneyAttr.COIN,val:o},{id:MoneyAttr.ZHENQI,val:s}],l=new Array,r=0;r<h.length;r++){var p=new ItemCellData,c={item_slot_idx:0,item_type_id:h[r].id,item_count:h[r].val};p.setItemCellData(c),l.push(p)}TipsControl.ins().showReward(l),EventProxy.Broast(EventType.S2CRepLyhSweep,[])},e.prototype.S2CRepLyhUpdateLayerInfo=function(t){var e=net_protocol.S2CRepLyhUpdateLayerInfo.decode(t.bytes);this.first_name=e.name,this.layer_list=e.layer_info,EventProxy.Broast(EventType.S2CRepLyhUpdateLayerInfo,[])},e.prototype.S2CRepLyhUpdateAwardZhenbao=function(t){net_protocol.S2CRepLyhUpdateAwardZhenbao.decode(t.bytes);EventProxy.Broast(EventType.S2CRepLyhUpdateAwardZhenbao,[])},e.prototype.getCurData=function(){return this.cur_data},e.prototype.getCurValue=function(){return this.kill_num},e.prototype.setCurValue=function(t,e){this.kill_num=this.kill_num+t,this.lianyao=this.lianyao+e,this.auto_enter_copy&&GameLogic.ins().isMainScene()&&void 0!=this.cur_data&&this.kill_num>=this.cur_data.kill_num&&(BagProxy.ins().GetBagLeftCount(BagType.EQUIP)<20&&BagProxy.ins().OneKeySmelt(),CopyProxy.ins().C2SReqCopyEnterCopy(this.cur_data.copy_id))},e.prototype.getMaxValue=function(){return this.cur_data?this.cur_data.kill_num:0},e.prototype.getKillNum=function(){return this.kill_num},e.prototype.getLianyaoValue=function(){return this.lianyao},e.prototype.getRewardId=function(){return this.get_id},e.prototype.isTop=function(){return void 0==this.cur_data},e.prototype.getAutoState=function(){return this.auto_enter_copy},e.prototype.setAutoState=function(t){this.auto_enter_copy=t},e.prototype.checkGoScene=function(){},e.prototype.updateNum=function(t,e){this.setCurValue(t,e)},e.prototype.getCurId=function(){return this.id},e.prototype.getOfflineData=function(t){var e=GlobalConfig.getLyhConfigById(t),i=0,n=0;if(e)for(var o=0;o<e.award_data.length;o++){var s=e.award_data[o];s[0]==MoneyAttr.EXP&&(i=12*s[1]),s[0]==MoneyAttr.COIN&&(n=12*s[1])}return[i,n]},e.prototype.getExtraId=function(t){var e,i=t,n=GlobalConfig.getLyhConfig();for(var o in n)if(e=n[o],e.id>=i&&e.extra_reward.length>0)return e.id;return 0},e.prototype.getSweepMax=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),e=GlobalConfig.getLyhVipById(t);return e?e.sweep_times:1},e.prototype.goToCurScene=function(){var t=e.ins().getCurData();t&&SceneControl.ins().C2STransferScene(t.scene_id,0,0)},e.prototype.getRed=function(){return this.getLyRed()||this.getLyhLayerRed()},e.prototype.getLyRed=function(){if(!SystemOpenProxy.ins().isOpen(2,4001,!0))return!1;var t=this.getRewardId(),i=GlobalConfig.getLyhRewardById(t+1);return i?this.getCurId()>=i.pass_id&&e.ins().getLianyaoValue()>=i.lianyao:!1},e.prototype.getLyhSdRed=function(){if(!SystemOpenProxy.ins().isOpen(2,4002,!0))return!1;var t=e.ins().sweep_times,i=e.ins().getSweepMax();
return i>t},e.prototype.getLyhLayerRed=function(){for(var t=0;t<this.layer_list.length;t++){var e=this.layer_list[t];if(this.getCurId()>=e.pass_id&&0==e.state)return!0}return!1},e}(BaseSystem);__reflect(LyhProxy.prototype,"LyhProxy");var MailData=function(){function t(){}return t}();__reflect(MailData.prototype,"MailData");var MailProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqMailGetMailListInfo=function(){var t=new net_protocol.C2SReqMailGetMailListInfo;this.sendPbPack(Msg.C2SReqMailGetMailListInfo,t,net_protocol.C2SReqMailGetMailListInfo)},e.prototype.C2SReqMailSendMail=function(t,e,i,n){var o=new net_protocol.C2SReqMailSendMail;o.role_id=t,o.role_name=e,o.title=i,o.content=n,this.sendPbPack(Msg.C2SReqMailSendMail,o,net_protocol.C2SReqMailSendMail)},e.prototype.C2SReqMailReadMailInfo=function(t){var e=new net_protocol.C2SReqMailReadMailInfo;e.mail_index=t,this.sendPbPack(Msg.C2SReqMailReadMailInfo,e,net_protocol.C2SReqMailReadMailInfo)},e.prototype.C2SReqMailRetrieveAttachment=function(t){var e=new net_protocol.C2SReqMailRetrieveAttachment;e.mail_idx_list=t,this.sendPbPack(Msg.C2SReqMailRetrieveAttachment,e,net_protocol.C2SReqMailRetrieveAttachment)},e.prototype.C2SReqMailDeleteMail=function(t){var e=new net_protocol.C2SReqMailDeleteMail;e.mail_idx_list=t,this.sendPbPack(Msg.C2SReqMailDeleteMail,e,net_protocol.C2SReqMailDeleteMail)},e.prototype.S2CRepMailListInfo=function(t){var e=net_protocol.S2CRepMailListInfo.decode(t.bytes);this.mail_list=e.mail_list,EventProxy.Broast(EventType.S2CRepMailListInfo,[]),EventProxy.Broast(EventType.RefreshMailRed,[])},e.prototype.S2CRepMailInfo=function(t){net_protocol.S2CRepMailListInfo.decode(t.bytes);EventProxy.Broast(EventType.S2CRepMailInfo,[])},e.prototype.S2CRepMailReadMail=function(t){for(var e=net_protocol.S2CRepMailReadMail.decode(t.bytes),i=0;i<this.mail_list.length;++i)this.mail_list[i].index==e.mail_index&&(this.mail_list[i].state=1);EventProxy.Broast(EventType.S2CRepMailReadMail,[e.mail_index])},e.prototype.S2CRepMailNotifyNewMail=function(t){var e=net_protocol.S2CRepMailNotifyNewMail.decode(t.bytes);void 0==this.mail_list&&(this.mail_list=[]),this.mail_list.push(e.mail_info),EventProxy.Broast(EventType.S2CRepMailNotifyNewMail,[]),EventProxy.Broast(EventType.RefreshMailRed,[])},e.prototype.S2CRepMailNotifyDelMail=function(t){var e=net_protocol.S2CRepMailNotifyDelMail.decode(t.bytes);if(this.mail_list)for(var i=0;i<e.mail_idx_list.length;++i)for(var n=0;n<this.mail_list.length;++n)e.mail_idx_list[i]==this.mail_list[n].index&&this.mail_list.splice(n,1);EventProxy.Broast(EventType.S2CRepMailNotifyDelMail,[]),EventProxy.Broast(EventType.RefreshMailRed,[])},e.prototype.S2CRepMailNotifyRetrieveAttachment=function(t){for(var e=net_protocol.S2CRepMailNotifyRetrieveAttachment.decode(t.bytes),i=0;i<e.mail_idx_list.length;++i)for(var n=0;n<this.mail_list.length;++n)e.mail_idx_list[i]==this.mail_list[n].index&&(this.mail_list[n].state=2);for(var o=new Array,i=0;i<e.list.length;i++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:e.list[i].item_id,item_count:e.list[i].item_num};s.setItemCellData(r),o.push(s)}TipsControl.ins().showReward(o),EventProxy.Broast(EventType.S2CRepMailNotifyRetrieveAttachment,e.mail_idx_list),EventProxy.Broast(EventType.RefreshMailRed,[])},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25300,this.S2CRepMailListInfo,this),MsgHandle.ins().regNetMsg(25301,this.S2CRepMailInfo,this),MsgHandle.ins().regNetMsg(25302,this.S2CRepMailReadMail,this),MsgHandle.ins().regNetMsg(25303,this.S2CRepMailNotifyNewMail,this),MsgHandle.ins().regNetMsg(25304,this.S2CRepMailNotifyDelMail,this),MsgHandle.ins().regNetMsg(25305,this.S2CRepMailNotifyRetrieveAttachment,this)},e.prototype.getMailStateByIndex=function(t){if(void 0==this.mail_list)return-1;for(var e=0;e<this.mail_list.length;++e)if(this.mail_list[e].index==t)return this.mail_list[e].state;return-1},e.prototype.sortMailItem=function(t,e){return t.state<e.state?-1:t.state==e.state&&t.send_time>e.send_time?-1:1},e.prototype.getMailIndexList=function(){if(void 0==this.mail_list)return[];for(var t=[],e=0;e<this.mail_list.length;++e)t.push(this.mail_list[e].index);return t},e.prototype.getMailRewardState=function(){if(void 0==this.mail_list)return!1;for(var t=0;t<this.mail_list.length;++t)if(2!=this.mail_list[t].state&&(this.mail_list[t].item_list.length>0||this.mail_list[t].cerrencys.length>0))return!0;return!1},e.prototype.getMailRewardIndexList=function(){if(void 0==this.mail_list)return[];for(var t=[],e=0;e<this.mail_list.length;++e)2!=this.mail_list[e].state&&t.push(this.mail_list[e].index);return t},e.prototype.getRed=function(){if(void 0==this.mail_list)return!1;for(var t=0;t<this.mail_list.length;++t)if(2!=this.mail_list[t].state)return!0;return!1},e}(BaseSystem);__reflect(MailProxy.prototype,"MailProxy");var MainProxy=function(t){function e(){var e=t.call(this)||this;e.isShowSkill=!0,e.isMusic=!0;var i=LocalStorageProxy.ins().getItem("mtlbgOn"),n=i?"1"==i:!0;return e.isMusic=n,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.MainSceneId=function(){GlobalConfig.ins().SceneConfig||GlobalConfig.getConfig("scene_data","SceneConfig");for(var t in GlobalConfig.ins().SceneConfig)if(GlobalConfig.ins().SceneConfig[t].is_main)return GlobalConfig.ins().SceneConfig[t].id},e.prototype.isContainOpen=function(t){for(var e=GlobalConfig.getMain_systemConfigs(),i=0;i<e.length;++i)if(e[i].contain_id==t){var n=0==e[i].page?1:2,o=0==e[i].page?Number(e[i].view_id):100*Number(e[i].view_id)+e[i].page,s=SystemOpenProxy.ins().isOpen(n,o,!0);if(s)return!0}return!1},e.prototype.getSystemRedByName=function(t){var e=!1;switch(t){case"Treasure":e=TreasureProxy.ins().getRed();break;case"Privilege":e=PrivilegeProxy.ins().getRed();break;case"Welfare":e=WelfareProxy.ins().getRed();break;case"DayFR":e=LimitActProxy.ins().GetRedByType(3);break;case"DayRechargeAct":e=LimitActProxy.ins().GetRedByType(4,1);break;case"ZhigouGift1":e=LimitActProxy.ins().GetRedByType(4,2);break;case"ZhigouGift2":e=LimitActProxy.ins().GetRedByType(4,3);break;case"ZhigouGift3":e=LimitActProxy.ins().GetRedByType(4,4);break;case"ZhigouGift4":e=LimitActProxy.ins().GetRedByType(4,5);break;case"XLQY":e=LimitActProxy.ins().GetRedByType(4,6);break;case"LuxuryFR":e=LimitActProxy.ins().GetRedByType(2,1);break;case"lianchong":e=LimitActProxy.ins().GetJCRed();case"JcAct":e=LimitActProxy.ins().GetJCRed();break;case"JieRiAct":e=LimitActProxy.ins().GetJieRiRed();break;case"ReTrunAct":e=LimitActProxy.ins().GetRechargeTrunRed();break;case"SuperInvest":e=WelfareProxy.ins().getInvenstRed();break;case"Sevenday":e=WelfareProxy.ins().getSevendayRed();break;case"Fac":e=LunjianProxy.ins().getRed()||FacFightProxy.ins().getRed();break;case"Fabao":e=FabaoProxy.ins().getRed();break;case"Fuwen":e=FwProxy.ins().getRed();break;case"Book":e=GrowupProxy.ins().getTujianRed();break;case"XianYuan":e=XyProxy.ins().getRed();break;case"BaoKu":e=StoreProxy.ins().getBaokuRed();break;case"StoreEnter":e=StoreProxy.ins().getRed();break;case"Store":e=StoreProxy.ins().getNormalStoreRed();break;case"BossStore":e=StoreProxy.ins().getBossStoreRed();break;case"btn_r1":e=!1;break;case"btn_r3":e=WelfareProxy.ins().getRed();break;case"btn_r2":e=WelfareProxy.ins().getRed();break;case"Sevenday":e=WelfareProxy.ins().getSevendayRed();break;case"SCZD":e=!0;break;case"SHARE":e=WelfareProxy.ins().IsShowShareRed()}return e},e}(BaseClass);__reflect(MainProxy.prototype,"MainProxy");var MakeProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqMiscMake=function(t,e){var i=new net_protocol.C2SReqMiscMake;i.make_id=t,i.num=e,CommonUtils.log("C2SReqMiscMake",i),this.sendPbPack(Msg.C2SReqMiscMake,i,net_protocol.C2SReqMiscMake)},e.prototype.C2SReqMiscItemSplit=function(t,e){var i=new net_protocol.C2SReqMiscItemSplit;i.item_id=t,i.num=e,CommonUtils.log("C2SReqMiscItemSplit",i),this.sendPbPack(Msg.C2SReqMiscItemSplit,i,net_protocol.C2SReqMiscItemSplit)},e.prototype.S2CRepMiscMake=function(t){var e=net_protocol.S2CRepMiscMake.decode(t.bytes);if(CommonUtils.log("S2CRepMiscMake",e),e.is_success){var i=GlobalConfig.getMake_dataConfig(e.make_id),n=[UtilProxy.GetItemCellData(i.tar[0],i.tar[1])];TipsControl.ins().showReward(n)}else TipsControl.ins().showTips("合成失败！");EventProxy.Broast(EventType.S2CRepMiscMake,[e.is_success]),EventProxy.Broast(EventType.RefreshMakeRed,[])},e.prototype.S2CRepMiscItemSplit=function(t){var e=net_protocol.S2CRepMiscItemSplit.decode(t.bytes);CommonUtils.log("S2CRepMiscItemSplit",e),EventProxy.Broast(EventType.S2CRepMiscItemSplit,[]),EventProxy.Broast(EventType.RefreshMakeRed,[])},e.prototype.getMakeItemRed=function(t){var e=GlobalConfig.getMake_dataConfig(t);if(e){if(2!=e.type){if(e.need_money.length>0&&RoleProxy.ins().getMoneyAttr(e.need_money[0])<e.need_money[1])return!1;for(var i=0;i<e.src.length;++i){var n=e.src[i][1]||1;if(BagProxy.ins().getItemCountById(e.src[i][0])<n)return!1}return!0}if(e.need_money.length>0&&RoleProxy.ins().getMoneyAttr(e.need_money[0])<e.need_money[1])return!1;if(BagProxy.ins().getItemCountById(e.src[0])*e.rate>=60)return!0}return!1},e.prototype.getMakeRedByType=function(t){var e=GlobalConfig.getMakeConfig();for(var i in e)if(e[i].page==t&&this.getMakeItemRed(e[i].id))return!0;return!1},e.prototype.getMakeRedBySubType=function(t,e){var i=GlobalConfig.getMakeConfig();for(var n in i)if(i[n].page==t&&i[n].sub_page==e&&this.getMakeItemRed(i[n].id))return!0;return!1},e.prototype.getSplitItemRed=function(t){var e=GlobalConfig.getSplit_dataConfig(t);return e?e.need_money.length>0&&RoleProxy.ins().getMoneyAttr(e.need_money[0])<e.need_money[1]?!1:BagProxy.ins().getItemCountById(e.id)>0:!1},e.prototype.isMakeMaterial=function(t){if(!this.make_material_list){this.make_material_list=[];var e={},i=GlobalConfig.getMakeConfig();for(var n in i)for(var o=i[n],s=0;s<o.src.length;++s){var r=o.src[s][0];e[r]||(this.make_material_list.push(r),e[r]=r)}var a=GlobalConfig.getSplitConfig();for(var n in a){var o=a[n];e[o.id]||(this.make_material_list.push(o.id),e[o.id]=o.id)}}for(var s=0;s<this.make_material_list.length;++s)if(t==this.make_material_list[s])return!0;return!1},e.prototype.getMakeRed=function(){var t=GlobalConfig.getMakeConfig();for(var e in t){var i=t[e];if(this.getMakeItemRed(i.id))return!0}return!1},e.prototype.getSplitRed=function(){var t=GlobalConfig.getSplitConfig();for(var e in t){var i=t[e];if(this.getSplitItemRed(i.id))return!0}return!1},e.prototype.getSmeltRed=function(){return BagProxy.ins().GetBagLeftCount(BagType.EQUIP)<20},e.prototype.selectMakeConf=function(){var t=GlobalConfig.getMakeConfig();for(var e in t){var i=t[e];if(this.getMakeItemRed(i.id))return i}},e.prototype.getRed=function(){return this.getMakeRed()||this.getSplitRed()||this.getSmeltRed()},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25157,this.S2CRepMiscMake,this),MsgHandle.ins().regNetMsg(25169,this.S2CRepMiscItemSplit,this)},e}(BaseSystem);__reflect(MakeProxy.prototype,"MakeProxy");var NoticeProxy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.OpenRecharge=function(){return (DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)?void 0:LimitActProxy.ins().IsFristRechargeOpen()?void ViewManager.ins().open(FirstRechargeView):void ViewManager.ins().open(RechargeView)},e.prototype.ErrCode=function(t){if(0==t)return!0;var e=GlobalConfig.getCodeConfigById(t);return void 0!=e&&"0"==e.index_ttpe&&3!=t&&TipsControl.ins().showTips(e.explain),!1},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25150,this.S2CRepMiscCodeNotice,this),MsgHandle.ins().regNetMsg(25159,this.S2CRepMiscDailyChange,this)},e.prototype.S2CRepMiscCodeNotice=function(t){var e,i=net_protocol.S2CRepMiscCodeNotice.decode(t.bytes),n=1==i.code_type,o=0,s="";if(0==i.code_type?e=GlobalConfig.getCodeConfigById(i.code_id):1==i.code_type?e=GlobalConfig.getNotice_defConfig(i.code_id):3==i.code_type&&(e=GlobalConfig.getSys_notice_defConfig(i.code_id)),void 0!=e){var r=this.transContent(e.explain,e.index_ttpe,i.list);if(s=r.content,o=r.itemId,e.show_type.length>0)for(var a=0;a<e.show_type.length;++a)if(2==e.show_type[a]){var h=e.id,l=1,p={channel_id:l,msg_content:s,itemId:o,codeId:h};ChatProxy.ins().C2CChannelChatEx(p)}else if(1==e.show_type[a]){var p={msg_content:s};ChatProxy.ins().S2CRepGlobalchatCrossEx(p)}n?TipsControl.ins().ShowFlyMsg(s,e.read_time):0==e.show_type.length&&TipsControl.ins().showTips(s)}else CommonUtils.log("not find notice_def ,code_id-------------->",i.code_id)},e.prototype.transContent=function(t,e,i){var n=[],o=0;if(i&&i.length>0)for(var s=e.split(","),r=0;r<i.length;++r){var a=i[r];if("1"==s[r])n.push(a.param);else if("2"==s[r]){var h=Number(a.param);1e3>h?n.push(UtilProxy.ins().getMoneyAttrName(h)):(n.push(BagProxy.ins().getItemName(h)),o=h)}else"3"==s[r]&&n.push(a[r].param)}var l={content:UtilProxy.StrFormartStr(t,n),itemId:o};return l},e.prototype.DoSystemNoticeDef=function(t,e){var i=GlobalConfig.getSys_notice_defConfig(t);if(i)for(var n=this.transContent(i.explain,i.index_ttpe,e),o=n.content,s=n.itemId,r=0;r<i.show_type.length;++r){var a=i.show_type[r];if(0==a)TipsControl.ins().ShowFlyMsg(o,1);else if(1==a){var h={msg_content:o};ChatProxy.ins().S2CRepGlobalchatCrossEx(h)}else if(2==a){var l=i.id,p=a-1,h={channel_id:p,msg_content:o,itemId:s,codeId:l};ChatProxy.ins().C2CChannelChatEx(h)}}},e.prototype.S2CRepMiscDailyChange=function(t){net_protocol.S2CRepMiscDailyChange.decode(t.bytes);LimitActProxy.ins().C2SReqMiscGetSaveInfo(),PrivilegeProxy.ins().C2SReqActivitySpecialRightsData(),StoreProxy.ins().C2SReqStoreGetBaokuInfo(),StoreProxy.ins().C2SReqStoreGetInfo(0),CopyProxy.ins().C2SReqCopyGetData(0),BossProxy.ins().C2SReqBossData(),CopyTeamProxy.ins().C2SReqTeamcopyGetInfo(),ActivityProxy.ins().C2SReqActivityInfos(),YezhanProxy.ins().C2SReqYezhanGetInfo(),XiuXianProxy.ins().C2SReqAlivepointGetInfo(),XiuXianProxy.ins().C2SReqAchievementGetInfo(),FwProxy.ins().C2SReqFuwenGetInfo(),LyhProxy.ins().C2SReqLyhGetInfo(),XyProxy.ins().C2SReqXianyuanGetInfo(),XyProxy.ins().C2SReqXianyuanGetTasklist(1),XyProxy.ins().C2SReqXianyuanGetTasklist(2),WelfareProxy.ins().C2SReqWelfareInvenstGetInfo(),WelfareProxy.ins().C2SReqWelfareGetInfo(),DailyTaskProxy.ins().C2SReqTaskGetDailyTaskInfo(),LimitActProxy.ins().DayChange(),SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.ALL),EventProxy.Broast(EventType.S2CRepMiscDailyChange,[])},e}(BaseSystem);__reflect(NoticeProxy.prototype,"NoticeProxy");var HuanxingPetData=function(){function t(){}return t.prototype.setHuanxingData=function(t,e){this.id=t,this.type=e,1==e?this.config=GlobalConfig.getPetGradeShowConfig(t):2==e&&(this.config=GlobalConfig.getPetSkinConfig(t)[1])},t}();__reflect(HuanxingPetData.prototype,"HuanxingPetData");var PetProxy=function(t){function e(){var e=t.call(this)||this;return e.fight=0,e.isInitView=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.GetExp=function(){return this.exp},e.prototype.C2SReqPetGetInfo=function(){var t=new net_protocol.C2SReqPetGetInfo;CommonUtils.log("(*^*)C2SReqPetGetInfo"),this.isInitView=!0,this.sendPbPack(Msg.C2SReqPetGetInfo,t,net_protocol.C2SReqPetGetInfo)},e.prototype.C2SReqPetOnekeyUpgrade=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new net_protocol.C2SReqPetOnekeyUpgrade;1==t&&(i.type=t,i.index=e),this.sendPbPack(Msg.C2SReqPetOnekeyUpgrade,i,net_protocol.C2SReqPetOnekeyUpgrade)},e.prototype.C2SReqPetActiveHuaxing=function(t){var e=new net_protocol.C2SReqPetActiveHuaxing;e.id=t,this.sendPbPack(Msg.C2SReqPetActiveHuaxing,e,net_protocol.C2SReqPetActiveHuaxing)},e.prototype.C2SReqPetShenLian=function(t,e){var i=new net_protocol.C2SReqPetShenLian;i.opt=t,i.type=e,this.sendPbPack(Msg.C2SReqPetShenLian,i,net_protocol.C2SReqPetShenLian)},e.prototype.C2SReqPetSkillUpgrade=function(t){var e=new net_protocol.C2SReqPetSkillUpgrade;e.skill_index=t,this.sendPbPack(Msg.C2SReqPetSkillUpgrade,e,net_protocol.C2SReqPetSkillUpgrade)},e.prototype.C2SReqPetChangeShow=function(t,e){var i=new net_protocol.C2SReqPetChangeShow;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqPetChangeShow,i,net_protocol.C2SReqPetChangeShow)},e.prototype.C2SReqPetSkinExtendUpgrade=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=new net_protocol.C2SReqPetSkinExtendUpgrade;n.id=t,1==e&&(n.type=e,n.index=i),this.sendPbPack(Msg.C2SReqPetSkinExtendUpgrade,n,net_protocol.C2SReqPetSkinExtendUpgrade)},e.prototype.S2CRepPetGetInfo=function(t){var e=net_protocol.S2CRepPetGetInfo.decode(t.bytes);CommonUtils.log("S2CRepPetGetInfo",e),this.exp=e.exp,this.grade=e.grade,this.star=e.star,this.skill_list=e.skill_list,this.huaxing_list=e.huaxing_list,this.show=e.show,this.swallow_list=e.swallow_list,this.fight=e.fight,this.InitShow(),GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.pet_fight=this.fight),EventProxy.Broast(EventType.S2CRepPetGetInfo,{})},e.prototype.InitShow=function(){this.show&&0==this.show.type&&0==this.show.id&&SystemOpenProxy.ins().isOpen(2,2002,!0)&&this.C2SReqPetChangeShow(1,1)},e.prototype.UseSwallowCount=function(t){if(void 0==this.swallow_list)return 0;for(var e=0;e<this.swallow_list.length;++e)if(this.swallow_list[e].type==t)return this.swallow_list[e].count;return 0},e.prototype.GetMaxSwallowCount=function(t){if(1==t){if(this.grade<=0&&this.star<=0)return 0;var e=Math.max(this.grade,1),i=0;for(var n in GlobalConfig.ins().petGradeShowConfig)if(GlobalConfig.ins().petGradeShowConfig[n].grade<=e)for(var o=0;o<GlobalConfig.ins().petGradeShowConfig[n].max_swallow_count.length;++o)t==GlobalConfig.ins().petGradeShowConfig[n].max_swallow_count[o][0]&&(i+=GlobalConfig.ins().petGradeShowConfig[n].max_swallow_count[o][1]);if(this.huaxing_list)for(var o=0;o<this.huaxing_list.length;++o)if(this.huaxing_list[o].num>0&&GlobalConfig.getPetSkinConfig(this.huaxing_list[o].id))for(var s=GlobalConfig.getPetSkinConfig(this.huaxing_list[o].id)[this.huaxing_list[o].num.toString()],r=0;r<s.max_swallow_count.length;++r)t==s.max_swallow_count[r][0]&&(i+=s.max_swallow_count[r][1]);return i}if(2==t){var a=0;if(!this.huaxing_list)return 0;for(var o=0;o<this.huaxing_list.length;++o)a+=this.huaxing_list[o].num;var h=GlobalConfig.getConfig("pet_swallow_extend","petSwallowExtendConfig"),l=0;for(var n in h)if(h[n].total_grade<a&&l<h[n].total_grade){l=h[n].total_grade;break}if(0==l)return 0;var p=GlobalConfig.getPetSwallowExtendConfig(l);if(t==p.max_swallow_count[0])return p.max_swallow_count[1]}return 0},e.prototype.GetMaxSwallowCountByGrade=function(t,e){if(1==t){var i=0;for(var n in GlobalConfig.ins().petGradeShowConfig)if(GlobalConfig.ins().petGradeShowConfig[n].grade<=e)for(var o=0;o<GlobalConfig.ins().petGradeShowConfig[n].max_swallow_count.length;++o)t==GlobalConfig.ins().petGradeShowConfig[n].max_swallow_count[o][0]&&(i+=GlobalConfig.ins().petGradeShowConfig[n].max_swallow_count[o][1]);if(this.huaxing_list)for(var o=0;o<this.huaxing_list.length;++o)if(this.huaxing_list[o].num>0&&GlobalConfig.getPetSkinConfig(this.huaxing_list[o].id))for(var s=GlobalConfig.getPetSkinConfig(this.huaxing_list[o].id)[this.huaxing_list[o].num.toString()],r=0;r<s.max_swallow_count.length;++r)t==s.max_swallow_count[r][0]&&(i+=s.max_swallow_count[r][1]);return i}if(2==t){var a=0;if(!this.huaxing_list)return 0;for(var o=0;o<this.huaxing_list.length;++o)a+=this.huaxing_list[o].num;var h=GlobalConfig.getConfig("pet_swallow_extend","petSwallowExtendConfig"),l=0;for(var n in h)if(h[n].total_grade>a&&l<h[n].total_grade){l=h[n].total_grade;break}if(0==l)return 0;var p=GlobalConfig.getPetSwallowExtendConfig(l);if(t==p.max_swallow_count[0])return p.max_swallow_count[1]}return 0},e.prototype.GetMaxSwallowCountById=function(t){GlobalConfig.ins().petSwallowItemConfig||GlobalConfig.getConfig("pet_swallow_item","petSwallowItemConfig");for(var e in GlobalConfig.ins().petSwallowItemConfig)if(GlobalConfig.ins().petSwallowItemConfig[e].item_id==t)return this.GetMaxSwallowCount(GlobalConfig.ins().petSwallowItemConfig[e].type);return 0},e.prototype.GetUseCountById=function(t){GlobalConfig.ins().petSwallowItemConfig||GlobalConfig.getConfig("pet_swallow_item","petSwallowItemConfig");for(var e in GlobalConfig.ins().petSwallowItemConfig)if(GlobalConfig.ins().petSwallowItemConfig[e].item_id==t)return this.UseSwallowCount(GlobalConfig.ins().petSwallowItemConfig[e].type);return 0},e.prototype.S2CRepPetOnekeyUpgrade=function(t){var e=net_protocol.S2CRepPetOnekeyUpgrade.decode(t.bytes);this.grade=e.grade,this.star=e.star,this.exp=e.exp;var i=(e.add_exp,1==e.is_crit);1==e.is_crit,XiuXianProxy.ins().updateAchieRed(AchieType.pet_level),XiuXianProxy.ins().updateAchieRed(AchieType.pet_star);var n=BagProxy.ins().GetLVUpItem(LvUpType.emCW,e.grade);if(n){var o=n.itemConfig;o.flags<=e.grade&&ViewManager.ins().open(ItemTipsView,n,!0,[LvUpType.emCW,0])}EventProxy.Broast(EventType.S2CRepPetOnekeyUpgrade,[i]),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.S2CRepPetActiveHuaxing=function(t){var e=net_protocol.S2CRepPetActiveHuaxing.decode(t.bytes),i=!1;if(void 0!=this.huaxing_list)for(var n=0;n<this.huaxing_list.length;++n)this.huaxing_list[n].id==e.huaxing.id&&(i=!0,this.huaxing_list[n]=e.huaxing);else this.huaxing_list=[];i||this.huaxing_list.push(e.huaxing),XiuXianProxy.ins().updateAchieRed(AchieType.pet_star),EventProxy.Broast(EventType.S2CRepPetActiveHuaxing,[e.huaxing.id]),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.getHuaxingNum=function(t){if(void 0==this.huaxing_list)return 0;for(var e=0;e<this.huaxing_list.length;++e)if(this.huaxing_list[e].id==t)return this.huaxing_list[e].num;return 0},e.prototype.getHuaxingData=function(t){if(this.huaxing_list)for(var e=0;e<this.huaxing_list.length;++e)if(this.huaxing_list[e].id==t)return this.huaxing_list[e]},e.prototype.S2CRepPetShenLian=function(t){var e=net_protocol.S2CRepPetShenLian.decode(t.bytes),i=!1;if(void 0!=this.swallow_list)for(var n=0;n<this.swallow_list.length;++n)this.swallow_list[n].type==e.info.type&&(i=!0,this.swallow_list[n]=e.info);i||this.swallow_list.push(e.info),EventProxy.Broast(EventType.S2CRepPetShenLian,{}),EventProxy.Broast(EventType.RefreshHuoBanRed,[])},e.prototype.S2CRepPetSkillUpgrade=function(t){var e=net_protocol.S2CRepPetSkillUpgrade.decode(t.bytes),i=!1;if(void 0!=this.skill_list)for(var n=0;n<this.skill_list.length;++n)this.skill_list[n].skill_index==e.skill.skill_index&&(i=!0,this.skill_list[n]=e.skill);i||this.skill_list.push(e.skill),EventProxy.Broast(EventType.S2CRepPetSkillUpgrade,[e.skill.skill_index])},e.prototype.getSkillLevelById=function(t){if(void 0!=this.skill_list)for(var e=0;e<this.skill_list.length;++e)if(this.skill_list[e].skill_index==t)return this.skill_list[e].level;return 0},e.prototype.S2CRepPetUpdateShow=function(t){var e=net_protocol.S2CRepPetUpdateShow.decode(t.bytes);this.show=e.show,EventProxy.Broast(EventType.S2CRepPetUpdateShow,[e.show.id])},e.prototype.S2CRepPetInfoUpdate=function(t){net_protocol.S2CRepPetInfoUpdate.decode(t.bytes);EventProxy.Broast(EventType.S2CRepPetInfoUpdate,{})},e.prototype.isHuanxingById=function(t){return void 0==this.show?!1:this.show.id==t?!0:!1},e.prototype.isHuanxingActive=function(t){var e=GlobalConfig.getPetGradeShowConfig(t);if(void 0!=e)return e.grade<=this.grade?!0:!1;if(void 0==this.huaxing_list)return!1;for(var i=0;i<this.huaxing_list.length;++i)if(this.huaxing_list[i].id==t)return this.huaxing_list[i].level>0;return!1},e.prototype.S2CRepPetFight=function(t){var e=net_protocol.S2CRepPetFight.decode(t.bytes);this.fight=e.fight,GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.pet_fight=this.fight),EventProxy.Broast(EventType.S2CRepPetFight,{})},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27950,this.S2CRepPetGetInfo,this),MsgHandle.ins().regNetMsg(27951,this.S2CRepPetOnekeyUpgrade,this),MsgHandle.ins().regNetMsg(27952,this.S2CRepPetActiveHuaxing,this),MsgHandle.ins().regNetMsg(27953,this.S2CRepPetShenLian,this),MsgHandle.ins().regNetMsg(27954,this.S2CRepPetSkillUpgrade,this),MsgHandle.ins().regNetMsg(27955,this.S2CRepPetUpdateShow,this),MsgHandle.ins().regNetMsg(27956,this.S2CRepPetInfoUpdate,this),MsgHandle.ins().regNetMsg(27957,this.S2CRepPetFight,this)},e.prototype.isSkillDataOpen=function(t){return void 0==t?!1:t.grade<=this.grade?!0:!1},e.prototype.getShowData=function(){var t=this.show;if(void 0==t||0==t.id)return{name:"",model_id:0,ui_model_path:"",pos:[]};var e=t.id,i=GlobalConfig.getPetGradeShowConfig(e);if(void 0!=i)return{name:i.name,model_id:i.model_id,ui_model_path:i.source,pos:i.pos};var n=0;if(void 0==this.huaxing_list)return{name:"",model_id:0,ui_model_path:"",pos:[]};for(var o=0;o<this.huaxing_list.length;++o)this.huaxing_list[o].id==e&&(n=this.huaxing_list[o].num);var s=GlobalConfig.getPet_skin_ex_dataConfig(e);return{name:s.name,model_id:s.model_id,ui_model_path:s.source,pos:s.pos}},e.prototype.getShowDataById=function(t){var e=GlobalConfig.getPetGradeShowConfig(t);if(void 0!=e)return{name:e.name,model_id:e.model_id,ui_model:e.source,cfg:e};var i=GlobalConfig.getPet_skin_ex_dataConfig(t);return void 0!=i?{name:i.name,model_id:i.model_id,ui_model:i.source,cfg:i}:{name:"",model_id:0,ui_model:"",cfg:[]}},e.prototype.getGrade=function(){return this.grade||0},e.prototype.getStarNumber=function(t){var e=0,i=GlobalConfig.getPetBaseDataConfigByNum(this.grade,this.star);if(void 0!=i){var n=i.show_id;GlobalConfig.getConfig("pet_grade_show","petGradeShowConfig");for(var o in GlobalConfig.ins().petGradeShowConfig)GlobalConfig.ins().petGradeShowConfig[o].show_id<=n&&GlobalConfig.ins().petGradeShowConfig[o].star>=t&&e++}if(void 0!=this.huaxing_list&&this.huaxing_list.length>0)for(var s=0;s<this.huaxing_list.length;++s)if(this.huaxing_list[s].num>0&&GlobalConfig.getPetSkinConfig(this.huaxing_list[s].id)){var r=GlobalConfig.getPetSkinConfigByNum(this.huaxing_list[s].id,this.huaxing_list[s].num);void 0!=r&&r.star>=t&&e++}return e},e.prototype.getActiveNumber=function(){var t=0,e=GlobalConfig.getPetBaseDataConfigByNum(this.grade,this.star);if(void 0!=e&&(t=e.show_id),void 0!=this.huaxing_list&&this.huaxing_list.length>0)for(var i=0;i<this.huaxing_list.length;++i)this.huaxing_list[i].num>0&&t++;return t},e.prototype.getTotalFight=function(){return this.fight||0},e.prototype.getPetRed=function(){return SystemOpenProxy.ins().isOpen(2,100*M_View_Type.Huoban+2,!0)?SystemOpenProxy.ins().isCurOpenItem(2,100*M_View_Type.Huoban+2)?!0:this.isInitView?!0:this.getMatericalRed()?!0:this.getHuaxingRed()?!0:this.getDanRedByType(1)?!0:this.getDanRedByType(2)?!0:this.isCanUpSkill()?!0:BagProxy.ins().getHuobanEquipRedByType(HuobanType.pet)?!0:BagProxy.ins().GetHasLVUpItem(LvUpType.emCW,this.grade):!1},e.prototype.isCanUpSkill=function(){GlobalConfig.ins().petSkillConfig||GlobalConfig.getConfig("pet_skill_data","petSkillConfig");for(var t in GlobalConfig.ins().petSkillConfig){var e=GlobalConfig.ins().petSkillConfig[t],i=this.isSkillDataOpen(e);if(i){var n=this.getSkillLevelById(e.id),o=GlobalConfig.getPetSkillUpgradeConfig(e.id),s=o[(n+1).toString()];if(s&&BagProxy.ins().getItemCountById(s.items[0][0])>=s.items[0][1])return!0}}return!1},e.prototype.getDanRedByType=function(t){var e=GlobalConfig.getPetSwallowItemConfig(t);if(e){var i=e.item_id,n=BagProxy.ins().getItemCountById(i);if(n>0){var o=this.UseSwallowCount(t),s=this.GetMaxSwallowCount(t);return s>o}}return!1},e.prototype.isMaxGrade=function(){GlobalConfig.ins().petBaseDataConfig||GlobalConfig.getConfig("pet_base_data","petBaseDataConfig");for(var t in GlobalConfig.ins().petBaseDataConfig){if(Number(t)>this.grade)return!1;if(Number(t)==this.grade){var e=GlobalConfig.ins().petBaseDataConfig[t];for(var i in e)if(Number(i)>this.star)return!1}}return!0},e.prototype.getMatericalRed=function(){if(this.isMaxGrade())return!1;GlobalConfig.ins().petGradeMatrialConfig||GlobalConfig.getConfig("pet_grade_matrial","petGradeMatrialConfig");for(var t in GlobalConfig.ins().petGradeMatrialConfig){var e=GlobalConfig.ins().petGradeMatrialConfig[t].id,i=BagProxy.ins().getItemCountById(e);if(i>0)return!0}return!1},e.prototype.getHuaxingRed=function(){GlobalConfig.ins().petSkinConfig||GlobalConfig.getConfig("pet_skin_data","petSkinConfig");for(var t in GlobalConfig.ins().petSkinConfig){var e=Number(t);if(this.getHuaxingEnoughById(e)||this.getHuaxingExtendEnoughById(e))return!0}return!1},e.prototype.getHuaxingEnoughById=function(t){if(GlobalConfig.ins().petSkinConfig||GlobalConfig.getConfig("pet_skin_data","petSkinConfig"),GlobalConfig.ins().petSkinConfig[t.toString()]){var e=this.getHuaxingNum(t),i=GlobalConfig.ins().petSkinConfig[t.toString()];if(i[(e+1).toString()]){for(var n=i[(e+1).toString()],o=!0,s=0;s<n.item.length;++s){var r=n.item[s][0],a=n.item[s][1];BagProxy.ins().getItemCountById(r)<a&&(o=!1)}if(o)return!0}}return!1},e.prototype.getHuaxingExtendEnoughById=function(t){if(GlobalConfig.ins().pet_skin_extend_dataConfig||GlobalConfig.getConfig("pet_skin_extend_data","pet_skin_extend_dataConfig"),GlobalConfig.ins().pet_skin_extend_dataConfig[t.toString()]){var e=this.getHuaxingData(t),i=GlobalConfig.ins().pet_skin_extend_dataConfig[t.toString()],n=e?e.level+1:1;if(i[n.toString()]){for(var o=i[n.toString()],s=!0,r=0;r<o.item.length;++r)if(o.item[r].length>=2){var a=o.item[r][0],h=o.item[r][1];BagProxy.ins().getItemCountById(a)<h&&(s=!1)}if(s)return this.getMatericalRed()}}return!1},e.prototype.getFight=function(){return this.fight||0},e.prototype.getBaseDataConfig=function(t){if(!(t>this.grade)){if(t<this.grade){var e,i=GlobalConfig.getPetBaseDataConfig(t),t=Number.MIN_VALUE;for(var n in i)i[n].star>t&&(t=i[n].star,e=n);return i[e]}return GlobalConfig.getPetBaseDataConfigByNum(this.grade,this.star)}},e}(BaseSystem);__reflect(PetProxy.prototype,"PetProxy");var PrivilegeType;!function(t){t[t.BOJIN=1]="BOJIN",t[t.ZHIZUN=2]="ZHIZUN",t[t.ZHOUKA=3]="ZHOUKA"}(PrivilegeType||(PrivilegeType={}));var PrivilegeProxy=function(t){function e(){var e=t.call(this)||this;return e.data_list=[],e.extra_list=[],e.special_big_award=0,e.exp_bead=0,e.exp_bead_times=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(26453,this.S2CRepActivitySpecialRightsData,this),MsgHandle.ins().regNetMsg(26454,this.S2CRepActivitySpecialReward,this),MsgHandle.ins().regNetMsg(26459,this.S2CRepActivityGetExtraAward,this),MsgHandle.ins().regNetMsg(26460,this.S2CRepActivityGetBigAward,this),MsgHandle.ins().regNetMsg(26461,this.S2CRepActivityGetExpBead,this)},e.prototype.C2SReqActivitySpecialRightsData=function(){var t=new net_protocol.C2SReqActivitySpecialRightsData;this.sendPbPack(Msg.C2SReqActivitySpecialRightsData,t,net_protocol.C2SReqActivitySpecialRightsData)},e.prototype.C2SReqActivitySpecialReward=function(t){var e=new net_protocol.C2SReqActivitySpecialReward;e.id=t,this.sendPbPack(Msg.C2SReqActivitySpecialReward,e,net_protocol.C2SReqActivitySpecialReward)},e.prototype.C2SReqActivityGetExtraAward=function(t){var e=new net_protocol.C2SReqActivityGetExtraAward;e.special_id=t,this.sendPbPack(Msg.C2SReqActivityGetExtraAward,e,net_protocol.C2SReqActivityGetExtraAward)},e.prototype.C2SReqActivityGetBigAward=function(){var t=new net_protocol.C2SReqActivityGetBigAward;this.sendPbPack(Msg.C2SReqActivityGetBigAward,t,net_protocol.C2SReqActivityGetBigAward)},e.prototype.C2SReqActivityGetExpBead=function(t){var e=new net_protocol.C2SReqActivityGetExpBead;e.use_yb=t,this.sendPbPack(Msg.C2SReqActivityGetExpBead,e,net_protocol.C2SReqActivityGetExpBead)},e.prototype.S2CRepActivitySpecialRightsData=function(t){var e=net_protocol.S2CRepActivitySpecialRightsData.decode(t.bytes);this.data_list=[];for(var i=0;i<e.data_list.length;i++)this.data_list[e.data_list[i].id]=e.data_list[i];this.extra_list=[];for(var i=0;i<e.extra_list.length;i++)this.extra_list[e.extra_list[i].special_id]=e.extra_list[i].state;
this.special_big_award=e.special_big_award,this.exp_bead=e.exp_bead,this.exp_bead_times=e.exp_bead_times,EventProxy.Broast(EventType.S2CRepActivitySpecialRightsData,[])},e.prototype.S2CRepActivitySpecialReward=function(t){var e=net_protocol.S2CRepActivitySpecialReward.decode(t.bytes);this.data_list[e.id]&&(this.data_list[e.id].has_get=!0),EventProxy.Broast(EventType.S2CRepActivitySpecialReward,[])},e.prototype.S2CRepActivityGetExtraAward=function(t){var e=net_protocol.S2CRepActivityGetExtraAward.decode(t.bytes);this.extra_list[e.special_id]=1;var i=new Array,n=GlobalConfig.getSpecial_rightsConfig(e.special_id);if(n.extra_award.length>0){for(var o=0;o<n.extra_award.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:n.extra_award[o][0],item_count:n.extra_award[o][1]};s.setItemCellData(r),i.push(s)}TipsControl.ins().showReward(i)}EventProxy.Broast(EventType.S2CRepActivityGetExtraAward,[])},e.prototype.S2CRepActivityGetBigAward=function(t){net_protocol.S2CRepActivityGetBigAward.decode(t.bytes);this.special_big_award=2;var e=new Array,i=GlobalConfig.getSpecial_rights_base_dataConfig(1);if(i.extra_award.length>0){for(var n=0;n<i.extra_award.length;n++){var o=new ItemCellData,s={item_slot_idx:0,item_type_id:i.extra_award[n][0],item_count:i.extra_award[n][1]};o.setItemCellData(s),e.push(o)}TipsControl.ins().showReward(e)}EventProxy.Broast(EventType.S2CRepActivityGetBigAward,[])},e.prototype.S2CRepActivityGetExpBead=function(t){net_protocol.S2CRepActivityGetExpBead.decode(t.bytes);this.exp_bead=0,this.exp_bead_times=this.exp_bead_times+1,EventProxy.Broast(EventType.S2CRepActivityGetExpBead,[])},e.prototype.getPrivilegeData=function(t){return this.data_list[t]},e.prototype.getPrivilegeState=function(t){return!this.data_list||void 0==this.data_list[t]||0==this.data_list[t].rights_due_time||1!=this.data_list[t].rights_due_time&&this.data_list[t].rights_due_time<=GameLogic.ins().getServerTime()?0:1==this.data_list[t].has_get?2:1},e.prototype.IsExtraAwardGet=function(){return 2==this.special_big_award?!0:!1},e.prototype.IsExtraAwardOpen=function(){if((DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)||!SystemOpenProxy.ins().isOpen(1,65,!0))return!1;var t=GlobalConfig.getSpecial_rights_base_dataConfig(1);return LimitActProxy.ins().GetServerOpenDay()<t.extra_time[0]||LimitActProxy.ins().GetServerOpenDay()>t.extra_time[1]?!1:this.IsExtraAwardGet()?!1:!0},e.prototype.GetExtraAwardEndTime=function(){var t=GlobalConfig.getSpecial_rights_base_dataConfig(1),e=t.extra_time[1]-LimitActProxy.ins().GetServerOpenDay(),i=LimitActProxy.ins().GetServerTimeDataByPassDay(e),n=UtilProxy.getStr("@0 /@1 /@2  23:59:59",[i.getFullYear(),i.getMonth()+1,i.getDate()]);return new Date(n).getTime()/1e3},e.prototype.getRed=function(){for(var t=1;3>=t;t++)if(this.getTypeRed(t))return!0;return!1},e.prototype.getTypeRed=function(t){return 1==e.ins().getPrivilegeState(t)?!0:!1},e}(BaseSystem);__reflect(PrivilegeProxy.prototype,"PrivilegeProxy");var PvpProxy=function(t){function e(){var e=t.call(this)||this;return e.score=0,e.step_level=1,e.win_num=0,e.lose_num=0,e.rank=0,e.total_fight_num=0,e.today_buy_num=0,e.today_win_num=0,e.daily_award_list=[],e.othername="",e.otherprof=1,e.list=[],e.stage=1,e.self_list=[],e.multi_list=[],e.guesslist=[],e.selfTopReports=[],e.cross_rank=0,e.IsAotu=!1,e.CurEndTime=0,e.IsShowTopRed=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(26050,this.S2CPvpGetInfo,this),MsgHandle.ins().regNetMsg(26051,this.S2CPvpStartMatching,this),MsgHandle.ins().regNetMsg(26052,this.S2CPvpCancelMatching,this),MsgHandle.ins().regNetMsg(26053,this.S2CPvpMatchingResult,this),MsgHandle.ins().regNetMsg(26054,this.S2CPvpFightResult,this),MsgHandle.ins().regNetMsg(26055,this.S2CPvpGetDailyAward,this),MsgHandle.ins().regNetMsg(26056,this.S2CPvpBuyTimes,this),MsgHandle.ins().regNetMsg(26057,this.S2CPvpGetRankList,this),MsgHandle.ins().regNetMsg(26058,this.S2CPvpGetReport,this),MsgHandle.ins().regNetMsg(26059,this.S2CPvpGuessVote,this),MsgHandle.ins().regNetMsg(26060,this.S2CPvpGetGuessInfo,this),MsgHandle.ins().regNetMsg(26061,this.S2CPvpUpdateReport,this),MsgHandle.ins().regNetMsg(26062,this.S2CPvpGetSelfTopReport,this)},e.prototype.C2SReqPvpGetInfo=function(){var t=new net_protocol.C2SReqPvpGetInfo;this.sendPbPack(Msg.C2SReqPvpGetInfo,t,net_protocol.C2SReqPvpGetInfo)},e.prototype.C2SReqPvpStartMatching=function(){var t=new net_protocol.C2SReqPvpStartMatching;this.sendPbPack(Msg.C2SReqPvpStartMatching,t,net_protocol.C2SReqPvpStartMatching)},e.prototype.C2SReqPvpCancelMatching=function(){var t=new net_protocol.C2SReqPvpCancelMatching;this.sendPbPack(Msg.C2SReqPvpCancelMatching,t,net_protocol.C2SReqPvpCancelMatching)},e.prototype.C2SReqPvpGetDailyAward=function(t){var e=new net_protocol.C2SReqPvpGetDailyAward;e.index=t,this.sendPbPack(Msg.C2SReqPvpGetDailyAward,e,net_protocol.C2SReqPvpGetDailyAward)},e.prototype.C2SReqPvpBuyTimes=function(t){var e=new net_protocol.C2SReqPvpBuyTimes;e.count=t,this.sendPbPack(Msg.C2SReqPvpBuyTimes,e,net_protocol.C2SReqPvpBuyTimes)},e.prototype.C2SReqPvpGetRankList=function(t){var e=new net_protocol.C2SReqPvpGetRankList;e.type=t,this.sendPbPack(Msg.C2SReqPvpGetRankList,e,net_protocol.C2SReqPvpGetRankList)},e.prototype.C2SReqPvpGetReport=function(t,e,i){void 0===i&&(i=0);var n=new net_protocol.C2SReqPvpGetReport;n.type=t,n.role_id=e,n.other_role_id=i,this.sendPbPack(Msg.C2SReqPvpGetReport,n,net_protocol.C2SReqPvpGetReport)},e.prototype.C2SReqPvpGuessVote=function(t,e,i){var n=new net_protocol.C2SReqPvpGuessVote;n.type=t,n.role_id=e,n.index=i,this.sendPbPack(Msg.C2SReqPvpGuessVote,n,net_protocol.C2SReqPvpGuessVote)},e.prototype.C2SReqPvpGetGuessInfo=function(t){var e=new net_protocol.C2SReqPvpGetGuessInfo;e.type=t,this.sendPbPack(Msg.C2SReqPvpGetGuessInfo,e,net_protocol.C2SReqPvpGetGuessInfo)},e.prototype.C2SReqPvpGetSelfTopReport=function(){var t=new net_protocol.C2SReqPvpGetSelfTopReport;this.sendPbPack(Msg.C2SReqPvpGetSelfTopReport,t,net_protocol.C2SReqPvpGetSelfTopReport)},e.prototype.S2CPvpGetInfo=function(t){var e=net_protocol.S2CPvpGetInfo.decode(t.bytes);this.score=e.score,this.step_level=e.step_level,this.win_num=e.win_num,this.lose_num=e.lose_num,this.rank=e.rank,this.total_fight_num=e.total_fight_num,this.today_buy_num=e.today_buy_num,this.today_win_num=e.today_win_num,this.daily_award_list=e.daily_award_list,EventProxy.Broast(EventType.S2CPvpGetInfo,[])},e.prototype.S2CPvpStartMatching=function(t){net_protocol.S2CPvpStartMatching.decode(t.bytes);EventProxy.Broast(EventType.S2CPvpStartMatching,[])},e.prototype.S2CPvpCancelMatching=function(t){net_protocol.S2CPvpCancelMatching.decode(t.bytes);this.IsAotu=!1,ViewManager.ins().close(PipeiView),EventProxy.Broast(EventType.S2CPvpCancelMatching,[])},e.prototype.S2CPvpMatchingResult=function(t){var e=net_protocol.S2CPvpMatchingResult.decode(t.bytes);this.othername=e.name,this.otherprof=e.prof,this.total_fight_num=this.total_fight_num-1,EventProxy.Broast(EventType.S2CPvpMatchingResult,[])},e.prototype.S2CPvpFightResult=function(t){var e=net_protocol.S2CPvpFightResult.decode(t.bytes);this.score=this.score+e.score,this.step_level=e.step;var i=[];i=0==e.result?GlobalConfig.getPvp_base_dataConfig(1).win_award:GlobalConfig.getPvp_base_dataConfig(1).lose_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |\n获得@1 积分",[this.othername,e.score]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!\n获得@1 积分",[this.othername,e.score]),ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.TOPFIGHT,a),EventProxy.Broast(EventType.S2CPvpFightResult,[])},e.prototype.S2CPvpGetDailyAward=function(t){var e=net_protocol.S2CPvpGetDailyAward.decode(t.bytes);NoticeProxy.ins().ErrCode(e.code)&&(this.daily_award_list.push(e.index),EventProxy.Broast(EventType.S2CPvpGetDailyAward,[]))},e.prototype.S2CPvpBuyTimes=function(t){var e=net_protocol.S2CPvpBuyTimes.decode(t.bytes);this.total_fight_num=e.total_fight_num,this.today_buy_num=this.today_buy_num+1,EventProxy.Broast(EventType.S2CPvpBuyTimes,[])},e.prototype.S2CPvpGetRankList=function(t){var e=net_protocol.S2CPvpGetRankList.decode(t.bytes);this.top_role=e.top_role,this.list[e.type]=[];for(var i=0;i<e.list.length;i++)this.list[e.type][i]=e.list[i];this.list[e.type].sort(this.sort),this.stage=e.stage,e.type>2&&(this.cross_rank=e.rank),this.CurEndTime=e.end_time,EventProxy.Broast(EventType.S2CPvpGetRankList,[])},e.prototype.getRankList=function(t){return this.list[t]||[]},e.prototype.sort=function(t,e){return t.rank>e.rank?1:t.rank<e.rank?-1:0},e.prototype.S2CPvpGetReport=function(t){var e=net_protocol.S2CPvpGetReport.decode(t.bytes);if(1==e.type){this.self_list=[];for(var i=0;i<e.self_list.length;i++)this.self_list[i]=e.self_list[i]}if(2==e.type){this.multi_list=[];for(var i=0;i<e.multi_list.length;i++)this.multi_list[i]=e.multi_list[i]}this.top_info=e.top_info,EventProxy.Broast(EventType.S2CPvpGetReport,[])},e.prototype.S2CPvpGuessVote=function(t){net_protocol.S2CPvpGuessVote.decode(t.bytes);EventProxy.Broast(EventType.S2CPvpGuessVote,[])},e.prototype.S2CPvpGetGuessInfo=function(t){var e=net_protocol.S2CPvpGetGuessInfo.decode(t.bytes);this.guesslist=[];for(var i=0;i<e.list.length;i++)this.guesslist[i]=e.list[i];EventProxy.Broast(EventType.S2CPvpGetGuessInfo,[])},e.prototype.S2CPvpUpdateReport=function(t){net_protocol.S2CPvpUpdateReport.decode(t.bytes);EventProxy.Broast(EventType.S2CPvpUpdateReport,[])},e.prototype.S2CPvpGetSelfTopReport=function(t){var e=net_protocol.S2CPvpGetSelfTopReport.decode(t.bytes);this.selfTopReports=[];for(var i=0;i<e.list.length;i++)this.selfTopReports[i]=e.list[i];EventProxy.Broast(EventType.S2CPvpGetSelfTopReport,[])},e.prototype.getDailyAwardState=function(t){for(var e=0;e<this.daily_award_list.length;e++)if(this.daily_award_list[e]==t)return 2;var i=GlobalConfig.getPvp_daily_award_dataConfig(t);return this.today_win_num>=i.win_num?0:1},e.prototype.OpenTopFight=function(){SystemOpenProxy.ins().isOpen(1,38)&&ViewManager.ins().open(TopBattlefieldView)},e.prototype.getTopRed=function(){return SystemOpenProxy.ins().isOpen(1,38,!0)?e.ins().IsInTopfightTime()?!0:this.IsShowTopRed?!0:!1:!1},e.prototype.IsInWanxianDay=function(){var t=new Date(1e3*GameLogic.ins().getServerTime());return GlobalConfig.getPvp_base_dataConfig(1).season_week_day==t.getDay()},e.prototype.IsInWanxianTime=function(){var t=new Date(1e3*GameLogic.ins().getServerTime()),e=GlobalConfig.getPvp_base_dataConfig(1),i=UtilProxy.getStr("@0 /@1 /@2 ",[t.getFullYear(),t.getMonth()+1,t.getDate()]),n=new Date(i).getTime()/1e3+3600*e.last_start_time[0]+60*e.last_start_time[1],o=new Date(i).getTime()/1e3+3600*e.last_end_time[0]+60*e.last_end_time[1];return GameLogic.ins().getServerTime()>=n&&GameLogic.ins().getServerTime()<=o},e.prototype.getCurWanxianEndTime=function(){var t=new Date(1e3*GameLogic.ins().getServerTime()),e=GlobalConfig.getPvp_base_dataConfig(1),i=UtilProxy.getStr("@0 /@1 /@2 ",[t.getFullYear(),t.getMonth()+1,t.getDate()]),n=new Date(i).getTime()/1e3+3600*e.last_start_time[0]+60*e.last_start_time[1];if(this.IsInWanxianTime()){var o=new Date(i).getTime()/1e3+3600*e.last_end_time[0]+60*e.last_end_time[1];return o}return n},e.prototype.IsInTopfightTime=function(){var t=new Date(1e3*GameLogic.ins().getServerTime()),e=GlobalConfig.getPvp_base_dataConfig(1),i=UtilProxy.getStr("@0 /@1 /@2 ",[t.getFullYear(),t.getMonth()+1,t.getDate()]),n=new Date(i).getTime()/1e3+3600*e.ladder_start_time[0]+60*e.ladder_start_time[1],o=new Date(i).getTime()/1e3+3600*e.ladder_end_time[0]+60*e.ladder_end_time[1];return GameLogic.ins().getServerTime()>=n&&GameLogic.ins().getServerTime()<=o},e.prototype.getCurTopFightEndTime=function(){var t=new Date(1e3*GameLogic.ins().getServerTime()),e=GlobalConfig.getPvp_base_dataConfig(1),i=UtilProxy.getStr("@0 /@1 /@2 ",[t.getFullYear(),t.getMonth()+1,t.getDate()]),n=new Date(i).getTime()/1e3+3600*e.ladder_start_time[0]+60*e.ladder_start_time[1],o=!0,s=[];if(this.IsInTopfightTime()){var r=new Date(i).getTime()/1e3+3600*e.ladder_end_time[0]+60*e.ladder_end_time[1];return s[0]=r,s[1]=o,s}GameLogic.ins().getServerTime()>n&&(n+=86400);var a=new Date(1e3*n),h=a.getDay();return h==e.season_week_day&&(o=!1),s[0]=n,s[1]=o,s},e.prototype.getCurEndTime=function(){return this.CurEndTime||0},e.prototype.getCurBuyData=function(){var t=GlobalConfig.getPvp_vip_dataConfig(RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL));if(void 0==t){var e=0,i=GlobalConfig.getPvp_vip_dataList();for(var n in i)e=Math.max(e,i[n].id);return GlobalConfig.getPvp_vip_dataConfig(e)}return t},e}(BaseSystem);__reflect(PvpProxy.prototype,"PvpProxy");var MiscOtherInfo=function(){function t(){}return t}();__reflect(MiscOtherInfo.prototype,"MiscOtherInfo");var ranks_role=function(){function t(){this.index=0,this.role_id=0,this.name="",this.prof=1,this.zhuan=0,this.level=0,this.fight=0,this.faction=0,this.time=0,this.value=0,this.use_head_id=0,this.use_head_frame_id=0,this.vip=0,this.fashion=0,this.shenbing=0,this.wing=0,this.belle=0,this.horse=0,this.pet=0,this.reputation=0,this.title=0,this.marry_name=""}return t}();__reflect(ranks_role.prototype,"ranks_role");var RankProxy=function(t){function e(){var e=t.call(this)||this;return e.ranklist=[],e.otherRoleList=[],e.m_ranklist=[],e.m_rankFight=[],e.CurType=0,e.getranktime=0,e.curcount=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqMiscOtherInfo=function(t){var e=new net_protocol.C2SReqMiscOtherInfo;e.role_id=t,this.sendPbPack(Msg.C2SReqMiscOtherInfo,e,net_protocol.C2SReqMiscOtherInfo)},e.prototype.C2SReqRankGetRanksRole=function(t){var e=new net_protocol.C2SReqRankGetRanksRole;e.type=t,this.sendPbPack(Msg.C2SReqRankGetRanksRole,e,net_protocol.C2SReqRankGetRanksRole)},e.prototype.S2CRepMiscOtherInfo=function(t){var e=net_protocol.S2CRepMiscOtherInfo.decode(t.bytes),i=new MiscOtherInfo;i.role_id=e.role_id,i.is_online=e.is_online,i.vip=e.vip,i.name=e.name,i.fight=e.fight,i.prof=e.prof,i.level=e.level,i.zhuan=e.zhuan,i.prop=e.prop,i.equip_list=e.equip_list,i.use_head_id=e.use_head_id,i.use_head_frame_id=e.use_head_frame_id,i.touxian_level=e.touxian_level,i.faction=e.faction,i.shenbing=e.shenbing,i.fashion=e.fashion,this.otherRoleList[i.role_id.toString()]=i,EventProxy.Broast(EventType.S2CRepMiscOtherInfo,{})},e.prototype.S2CRepRankGetRanksRole=function(t){var e=net_protocol.S2CRepRankGetRanksRole.decode(t.bytes);1==e.type?e.item.sort(this.sortLevel):e.item.sort(this.sortValue),this.ranklist[e.type]=[],this.m_ranklist[e.type]=0;for(var i=0;i<e.item.length;i++){var n=new ranks_role;n.index=i+1,n.role_id=e.item[i].role_id,n.name=e.item[i].name,n.prof=e.item[i].prof,n.zhuan=e.item[i].zhuan,n.level=e.item[i].level,n.fight=e.item[i].fight,n.faction=e.item[i].faction,n.time=e.item[i].time,n.value=e.item[i].value,n.use_head_id=e.item[i].use_head_id,n.use_head_frame_id=e.item[i].use_head_frame_id,n.vip=e.item[i].vip,n.fashion=e.item[i].fashion,n.shenbing=e.item[i].shenbing,n.wing=e.item[i].wing,n.belle=e.item[i].belle,n.horse=e.item[i].horse,n.pet=e.item[i].pet,n.reputation=e.item[i].reputation,n.title=e.item[i].title,n.marry_name=e.item[i].marry_name,n.role_id==RoleProxy.ins().getRoleId()&&(this.m_ranklist[e.type]=n.index,this.m_rankFight[e.type]=n.value),this.ranklist[e.type].push(n)}EventProxy.Broast(EventType.S2CRepRankGetRanksRole,{})},e.prototype.sortValue=function(t,e){return t.value<e.value?1:t.value>e.value?-1:t.time<e.time?1:t.time>e.time?-1:0},e.prototype.sortLevel=function(t,e){return t.level<e.level?1:t.level>e.level?-1:t.time<e.time?1:t.time>e.time?-1:0},e.prototype.getRanklistByType=function(t){if(void 0==this.ranklist[t])return[];for(var e=[],i=5==this.CurType?3:20,n=0;i>n;n++){var o=new ranks_role;this.ranklist[t][n]?o=this.ranklist[t][n]:o.index=n+1,1!=o.index&&e.push(o)}return e},e.prototype.getTotleRanklistByType=function(t){return this.ranklist[t]||[]},e.prototype.getMyFightByType=function(t){var e=0;if(this.m_rankFight[t]&&this.m_rankFight[t]>0)return this.m_rankFight[t];switch(t){case 1:e=RoleProxy.ins().getRoleLv();break;case 2:e=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING);break;case 3:e=FabaoProxy.ins().getFight();break;case 4:e=HorseProxy.ins().getTotalFight();break;case 7:e=BagProxy.ins().GetDressListFight()+UpgradeProxy.ins().getAllFightValue()+UpStarProxy.ins().getAllFightValue()+SoulStoneProxy.ins().getAllFightValue()+ZhulingProxy.ins().getAllFightValue()+RefineProxy.ins().getAllFightValue()+GodEquipProxy.ins().getTotleFight()+ZhuhunProxy.ins().getAllFightValue();break;case 8:e=XiuXianProxy.ins().achie_level;break;case 9:e=WeaponProxy.ins().getFight(3);break;case 10:e=PetProxy.ins().getTotalFight();break;case 11:e=HuobanProxy.ins().getTotalFight();break;case 12:e=WeaponProxy.ins().getFight(1);break;case 13:e=CopyProxy.ins().getSYTFloor();break;case 14:e=YezhanProxy.ins().score;break;case 15:e=LyhProxy.ins().getCurId();break;case 16:e=GrowupProxy.ins().GetTujianFight()}return e},e.prototype.getMyRankByType=function(t){return this.m_ranklist[t]||0},e.prototype.getRankTopByType=function(t){if(this.ranklist[t])for(var e in this.ranklist[t])if(1==this.ranklist[t][e].index)return this.ranklist[t][e]},e.prototype.getOtherRoleInfo=function(t){return this.otherRoleList[t.toString()]},e.prototype.getAllRankInfo=function(){var t=GameLogic.ins().getServerTime();if(!(t-this.getranktime<60)){this.getranktime=t;var e=this.getRankTypeList(),i=Math.ceil(e.length/5);this.curcount=0,TimerManager.ins().doTimer(1500,i,this.getRank,this)}},e.prototype.getRank=function(){for(var t=this.getRankTypeList(),e=0;e<t.length;e++)e>=5*this.curcount&&e<5*(this.curcount+1)&&this.C2SReqRankGetRanksRole(t[e].type);this.curcount=this.curcount+1},e.prototype.getRankTypeList=function(){var t=GlobalConfig.getRankTypeList(),e=[];for(var i in t)e.push(t[i]);return e},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25153,this.S2CRepMiscOtherInfo,this),MsgHandle.ins().regNetMsg(26303,this.S2CRepRankGetRanksRole,this)},e}(BaseSystem);__reflect(RankProxy.prototype,"RankProxy");var RefineProxy=function(t){function e(){var e=t.call(this)||this;return e.list=[],e.suit_level=0,e.star=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqIntensifyGetRefineInfo=function(){var t=new net_protocol.C2SReqIntensifyGetRefineInfo;this.sendPbPack(Msg.C2SReqIntensifyGetRefineInfo,t,net_protocol.C2SReqIntensifyGetRefineInfo)},e.prototype.C2SReqIntensifyUpgradeRefine=function(t,e){var i=new net_protocol.C2SReqIntensifyUpgradeRefine;i.part=t,i.use_crit=e,this.sendPbPack(Msg.C2SReqIntensifyUpgradeRefine,i,net_protocol.C2SReqIntensifyUpgradeRefine)},e.prototype.C2SReqIntensifySuitRefine=function(){var t=new net_protocol.C2SReqIntensifySuitRefine;this.sendPbPack(Msg.C2SReqIntensifySuitRefine,t,net_protocol.C2SReqIntensifySuitRefine)},e.prototype.S2CRepIntensifyGetRefineInfo=function(t){for(var e=net_protocol.S2CRepIntensifyGetRefineInfo.decode(t.bytes),i=0;i<e.list.length;i++)void 0!=e.list[i].part&&(this.list[e.list[i].part]=e.list[i]);this.suit_level=e.suit_level,this.star=e.star,EventProxy.Broast(EventType.S2CRepIntensifyGetRefineInfo,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepIntensifyUpgradeRefine=function(t){var e=net_protocol.S2CRepIntensifyUpgradeRefine.decode(t.bytes);this.list[e.info.part]=e.info,this.star=e.star,EventProxy.Broast(EventType.S2CRepIntensifyUpgradeRefine,[e.crit]),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepIntensifySuitRefine=function(t){var e=net_protocol.S2CRepIntensifySuitRefine.decode(t.bytes);this.suit_level=e.suit_level,EventProxy.Broast(EventType.S2CRepIntensifySuitRefine,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.getPartRefineLevel=function(t){return this.list[t]?this.list[t].level:0},e.prototype.getPartRefineStar=function(t){return this.star},e.prototype.getCurUpState=function(t){var e=this.getPartRefineLevel(t),i=GlobalConfig.getRefine_part_attr_dataConfig(t);return e>=i.max_level?2:i.item_id>0&&BagProxy.ins().getItemCountByIDtype(i.item_id,BagType.BAG)<this.getRefineCostNum(t,e+1)?1:0},e.prototype.getMinRefineLevel=function(){for(var t=-1,e=1;10>=e;e++)t=-1==t?this.getPartRefineLevel(e):Math.min(t,this.getPartRefineLevel(e));return t},e.prototype.getMasterRed=function(){var t=GlobalConfig.getRefine_suit_dataConfig(this.suit_level+1);return void 0!=t&&this.getMinRefineLevel()>=t.level?!0:!1},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(2,1004,!0))return!1;for(var t=1;10>=t;t++)if(0==this.getCurUpState(t))return!0;return this.getMasterRed()?!0:!1},e.prototype.getMasterFight=function(){var t=this.suit_level,e=GlobalConfig.getRefine_suit_dataConfig(t);return UtilProxy.GetAttrFight(e)},e.prototype.getAllFightValue=function(){for(var t=0,e=1;10>=e;e++){var i=this.getPartRefineLevel(e),n=this.getRefineAttr(e,i);n&&(t+=UtilProxy.GetAttrFight(n))}return t+this.getMasterFight()},e.prototype.getRefineAttr=function(t,e){var i=[],n=GlobalConfig.getRefine_part_attr_dataConfig(t),o=GlobalConfig.getRefine_attr_dataConfig(1);if(n)for(var s=0;s<n.attr_list.length;s++){var r=n.attr_list[s].toString(),a=o[r]||0;a>0&&(a/=100),i[r]=Math.floor(4e4*Math.pow(e,1.5)/Math.pow(1e3,1.5)*a)}return i},e.prototype.getRefineCostNum=function(t,e){var i=Math.ceil(4e4*Math.pow(e,1.5)/Math.pow(1e3,1.5)-4e4*Math.pow(e-1,1.5)/Math.pow(1e3,1.5)),n=GlobalConfig.getRefine_part_attr_dataConfig(t);return e>n.max_level&&(i=0),i},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25903,this.S2CRepIntensifyGetRefineInfo,this),MsgHandle.ins().regNetMsg(25904,this.S2CRepIntensifyUpgradeRefine,this),MsgHandle.ins().regNetMsg(25905,this.S2CRepIntensifySuitRefine,this)},e}(BaseSystem);__reflect(RefineProxy.prototype,"RefineProxy");var RelicSoulModel=function(){function t(){this.SoulState=0,this.stateZt=0,this.exp=0,this.star=0,this.id=0}return t.prototype.setSoulRelic=function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0),this.stateZt=i,this.id=e,this.SoulState=t,this.exp=o,this.star=n,this.soulConfig=GlobalConfig.getShengwu_soul_dataById(e),this.soulConfigAttr=GlobalConfig.getShengwu_soul_attr_dataByIdAndnum(e,n),null==this.soulConfigAttr&&(this.soulConfigAttr=GlobalConfig.getShengwu_soul_attr_dataByIdAndnum(e,n))},t}();__reflect(RelicSoulModel.prototype,"RelicSoulModel");var RelicModel=function(){function t(){this.state=0,this.id=0}return t.prototype.setRelic=function(t,e){this.id=e,this.state=t,this.config=GlobalConfig.getShengwu_items_dataById(e)},t}();__reflect(RelicModel.prototype,"RelicModel");var RelicSkillModel=function(){function t(){this.stateSkill=0,this.id=0}return t.prototype.setRelicSkill=function(t,e){this.id=e,this.stateSkill=t,this.config=GlobalConfig.getShengwu_skill_dataById(e)},t}();__reflect(RelicSkillModel.prototype,"RelicSkillModel");var RelicProxy=function(t){function e(){var e=t.call(this)||this;return e.step=0,e.okList=[],e.open_time=0,e.dataList=[],e.imgList=[],e.nameList=[],e.soul_list=[],e.soulDataList=[],e.next=0,e.info={},e.maxSoul=4,e.fightNum=0,e.skill_list=[],e.skill_data=[],e.isTuue=!1,e.isTuueItem=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.setBagUpdateById=function(t){var e=GlobalConfig.getShengwu_soul_dataById(1);return e&&e.items[0]==t?!0:!1},e.prototype.setBagUpdateByItemId=function(t){var e=GlobalConfig.getShengwu_misc_dataById(1);return e&&e.exp_item[0]==t?!0:!1},e.prototype.getSoulListLength=function(){return this.soul_list.length>0?this.soul_list.length<=this.maxSoul:!1},e.prototype.getNeedMoney=function(){var t=0,e=GlobalConfig.getShengwu_misc_dataById(1);return e&&(t=e.combine_money[1]),t},e.prototype.getPath=function(t){var e="",i=GlobalConfig.getShengwu_items_dataById(t);return i&&(e=UtilProxy.getShowImgPath()+"/shengqi/"+i.effect_id),e},e.prototype.getNeedMoneyOfSoul=function(t){var e=0,i=GlobalConfig.getShengwu_soul_dataById(t);return i&&(e=i.money[1]),e},e.prototype.getCanJh=function(t){return RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)>=this.getNeedMoneyOfSoul(t)?!0:!1},e.prototype.CanCombine=function(){return RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO)>=this.getNeedMoney()?!0:!1},e.prototype.getRelicImg=function(){if(this.imgList&&this.imgList.length>0)return this.imgList;var t=GlobalConfig.getShengwu_items_dataAll();if(t){for(var e in t)this.imgList.push(t[e].zy_sk);return this.imgList}},e.prototype.getRelicName=function(){if(this.nameList&&this.nameList.length>0)return this.nameList;var t=GlobalConfig.getShengwu_items_dataAll();if(t){for(var e in t)this.nameList.push(t[e].sw_name);return this.nameList}},e.prototype.isFour=function(){for(var t=0;t<this.soulDataList.length;t++)if(this.soulDataList[t].SoulState<2)return!1;return!0},e.prototype.isNoOne=function(){return this.soulDataList&&this.soulDataList.length>0&&this.soulDataList[0].SoulState<2?!0:void 0},e.prototype.maxLv=function(){for(var t=0,e=GlobalConfig.getShengwu_misc_dataById(1),i=0;i<this.soul_list.length;i++)this.soul_list[i].star>=e.max_star&&t++;return this.soul_list.length>=this.maxSoul&&t==this.soul_list.length?!0:!1},e.prototype.getCountByBagById=function(t){return BagProxy.ins().getItemCountByIdNoMoney(t)},e.prototype.getTaskText=function(t){var e="",i=0,n=0,o=GlobalConfig.getShengwu_soul_dataById(t);return o&&(i=this.getCountByBagById(o.items[0]),n=Number(o.items[1]),e="材料："+i+"/"+n),e},e.prototype.mmTime=function(t){return 60*t},e.prototype.getOPenOne=function(){for(var t=0;t<this.soulDataList.length;t++)if(this.soulDataList[t].SoulState>=2)return!0;return!1},e.prototype.getNumberOpenMany=function(){for(var t=0,e=0;e<this.soulDataList.length;e++)this.soulDataList[e].SoulState>=2&&t++;return t},e.prototype.isJhAllSoul=function(){var t=0;if(this.soulDataList.length==this.maxSoul){for(var e=0;e<this.soulDataList.length;e++)this.soulDataList[e].SoulState>=2&&(t=e);if(this.maxSoul-t==1)return!0}return!1},e.prototype.getFightNum=function(){for(var t=0,e=0;e<this.dataList.length;e++)2==this.dataList[e].state&&(t+=UtilProxy.GetAttrFight(this.dataList[e].config));return t},e.prototype.getFightSkillNum=function(){for(var t=0,e=0;e<this.skill_data.length;e++)2==this.skill_data[e].stateSkill&&(t+=UtilProxy.GetAttrFight(this.skill_data[e].config));return t},e.prototype.getThreeFight=function(){var t=0,e=this.getNowRelicAttr();return t+=UtilProxy.GetAttrFight(e)},e.prototype.getMinStar=function(){for(var t=[],e=0;e<this.soulDataList.length;e++)t.push(this.soulDataList[e].star);return t.sort(this.sortList),t[0]},e.prototype.sortList=function(t,e){return t.star>e.star?1:t.star<e.star?-1:t.star-e.star},e.prototype.getGongmingFight=function(){var t=0;return this.isJhAllSoul()?t=UtilProxy.GetAttrFight(this.getAllAttr()):t},e.prototype.getThreeAllFight=function(){return this.getFightSkillNum()+this.getThreeFight()+this.getFightNum()+this.getGongmingFight()},e.prototype.getMaxStar=function(){var t=GlobalConfig.getShengwu_misc_dataById(1);return t?t.max_star:void 0},e.prototype.getAllShengwu=function(){for(var t=0,e=0,i=0,n=0;n<this.setState().length;n++){var o=GlobalConfig.getShengwu_items_dataById(this.setState()[n].id);o&&(t+=o.attack),e+=o.defence,i+=o.hp}return{attack:t,defence:e,hp:i}},e.prototype.getAllAttr=function(){var t=0,e=0,i=0,n=0,o=GlobalConfig.getShengwu_misc_dataById(1),s=GlobalConfig.getShengwu_suit_dataById(this.getMinStar());s||(s=GlobalConfig.getShengwu_suit_dataById(o.max_gong));var r=this.getNowRelicAttr(),a=this.getAllShengwu();return n=s.attr_per/1e4,o&&(t=(r.attack+a.attack)*n+(r.attack+a.attack),e=(r.defence+a.defence)*n+(r.defence+a.defence),i=(r.hp+a.hp)*n+(r.hp+a.hp)),{attack:(r.attack+a.attack)*n,defence:(r.defence+a.defence)*n,hp:(r.hp+a.hp)*n}},e.prototype.getStarJie=function(t){var e=t/5;return Math.floor(e)},e.prototype.sKillStateByConfigState=function(t){for(var e=0,i=0;i<this.soulDataList.length;i++)t<=this.soulDataList[i].star&&e++;return e==this.soulDataList.length?!0:!1},e.prototype.getNowRelicAttr=function(){for(var t=0,e=0,i=0,n=0;n<this.soulDataList.length;n++){var o=GlobalConfig.getShengwu_soul_attr_dataByIdAndnum(this.soulDataList[n].id,this.soulDataList[n].star);o||(o=GlobalConfig.getShengwu_soul_attr_dataByIdAndnum(this.soulDataList[n].id,this.getMaxStar()));var s=GlobalConfig.getShengwu_soul_dataById(this.soulDataList[n].id);2==this.soulDataList[n].SoulState&&(t+=s.attack,e+=s.defence,i+=s.hp,this.soulDataList[n].star>0&&(t+=o.attack,e+=o.defence,i+=o.hp))}return{attack:t,defence:e,hp:i}},e.prototype.initSkillList=function(){if(this.skill_data.length>0)return this.skill_data;var t=GlobalConfig.getShengwu_skill_dataAll();if(t){for(var e in t){var i=new RelicSkillModel,n=0,o=t[e].id-1;n=this.skill_list[o]?2:this.sKillStateByConfigState(t[e].star)?1:0,i.setRelicSkill(n,t[e].id),this.skill_data.push(i)}}return this.skill_data},e.prototype.soulInit=function(){if(this.soulDataList.length>0)return this.soulDataList;var t=GlobalConfig.getShengwu_soul_dataAll();if(t){var e=0;for(var i in t){var n=new RelicSoulModel;if(this.soul_list[Number(t[i].pre_id)]){var o=this.soul_list[Number(t[i].pre_id)];2==o.state?this.next=1:this.next=0,n.setSoulRelic(o.state,t[i].id,1,o.star,o.exp)}else 1==Number(i)?n.setSoulRelic(e,t[i].id,1):(n.setSoulRelic(e,t[i].id,this.next),this.next=0);this.soulDataList.push(n)}return this.soulDataList}},e.prototype.setState=function(){if(this.dataList.length>0)return this.dataList;var t=LimitActProxy.ins().GetServerOpenDay(),e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),i=GlobalConfig.getShengwu_items_dataAll();if(i){var n=0;for(var o in i){var s=new RelicModel;this.okList.indexOf(Number(i[o].id))>-1?n=2:(t>i[o].open_day||e>i[o].vip_level||this.mmTime(i[o].online_time)>this.open_time)&&(n=1),s.setRelic(n,Number(i[o].id)),this.dataList.push(s)}return this.dataList}},e.prototype.C2SReqShengwuUnlock=function(t){var e=new net_protocol.C2SReqShengwuUnlock;e.id=t,this.sendPbPack(Msg.C2SReqShengwuUnlock,e,net_protocol.C2SReqShengwuUnlock)},e.prototype.C2SReqShengwuCombine=function(){var t=new net_protocol.C2SReqShengwuCombine;this.sendPbPack(Msg.C2SReqShengwuCombine,t,net_protocol.C2SReqShengwuCombine)},e.prototype.C2SReqShengwuGetInfo=function(){var t=new net_protocol.C2SReqShengwuGetInfo;this.sendPbPack(Msg.C2SReqShengwuGetInfo,t,net_protocol.C2SReqShengwuGetInfo)},e.prototype.C2SReqShengwuGetSoulTask=function(t){var e=new net_protocol.C2SReqShengwuGetSoulTask;e.id=t,this.sendPbPack(Msg.C2SReqShengwuGetSoulTask,e,net_protocol.C2SReqShengwuGetSoulTask)},e.prototype.C2SReqShengwuActiveSkill=function(t){var e=new net_protocol.C2SReqShengwuActiveSkill;e.id=t,this.sendPbPack(Msg.C2SReqShengwuActiveSkill,e,net_protocol.C2SReqShengwuActiveSkill)},e.prototype.C2SReqShengwuActiveSoul=function(t,e){var i=new net_protocol.C2SReqShengwuActiveSoul;i.opt=t,i.id=e,this.sendPbPack(Msg.C2SReqShengwuActiveSoul,i,net_protocol.C2SReqShengwuActiveSoul)},e.prototype.C2SReqShengwuUpgradeSoul=function(t){var e=new net_protocol.C2SReqShengwuUpgradeSoul;e.count=t,this.sendPbPack(Msg.C2SReqShengwuUpgradeSoul,e,net_protocol.C2SReqShengwuUpgradeSoul)},e.prototype.S2CShengwuGetInfo=function(t){var e=net_protocol.S2CShengwuGetInfo.decode(t.bytes);this.open_time=e.open_time,this.okList=e.list,this.soul_list=e.soul_list,this.skill_list=e.skill_list,this.step=e.step},e.prototype.S2CShengwuUnlock=function(t){for(var e=net_protocol.S2CShengwuUnlock.decode(t.bytes),i=0;i<this.dataList.length;i++)e.id==this.dataList[i].id&&(this.dataList[i].state=2);ViewManager.ins().open(JihuoTipsView,8,0,this.getPath(e.id)),TipsControl.ins().showTips("圣物解锁成功!"),this.fightNum=this.getFightNum(),this.step=e.step},e.prototype.S2CShengwuCombine=function(t){net_protocol.S2CShengwuCombine.decode(t.bytes);TipsControl.ins().showTips("圣物融合成功!"),this.step=2},e.prototype.S2CShengwuGetSoulTask=function(t){for(var e=net_protocol.S2CShengwuGetSoulTask.decode(t.bytes),i=0;i<this.soulDataList.length;i++)e.id==this.soulDataList[i].id&&(this.soulDataList[i].SoulState=1);
TipsControl.ins().showTips("成功接取任务!")},e.prototype.S2CShengwuActiveSoul=function(t){var e=net_protocol.S2CShengwuActiveSoul.decode(t.bytes);this.info=e.info;for(var i=!1,n=0;n<this.soulDataList.length;n++)e.info.id==this.soulDataList[n].id&&(this.soulDataList[n].SoulState=e.info.state,i=!0);if(i){var o=GlobalConfig.getShengwu_soul_dataById(e.info.id).pre_id,s=o+1;if(s==this.soulDataList.length)EventProxy.Broast(EventType.nextModelData,[]);else for(var r=0;r<this.soulDataList.length;r++)s==this.soulDataList[r].soulConfig.pre_id&&(this.soulDataList[r].stateZt=1,this.nextModel=this.soulDataList[r],EventProxy.Broast(EventType.nextModelData,[this.soulDataList[r].soulConfig.pre_id,this.nextModel]))}TipsControl.ins().showTips("激活器灵成功!"),EventProxy.Broast(EventType.updateList,[])},e.prototype.S2CShengwuUpgradeSoul=function(t){var e=net_protocol.S2CShengwuUpgradeSoul.decode(t.bytes),i=GlobalConfig.getShengwu_misc_dataById(1);this.soul_list=e.soul_list;for(var n=0;n<e.soul_list.length;n++)e.soul_list[n].id==this.soulDataList[n].id&&(e.soul_list[n].star<=i.max_star?(this.soulDataList[n].exp=e.soul_list[n].exp,this.soulDataList[n].star=e.soul_list[n].star):(this.soulDataList[n].exp=e.soul_list[n].exp,this.soulDataList[n].star=i.max_star));if(e.soul_list.length==this.maxSoul){var o=GlobalConfig.getShengwu_skill_dataAll();if(o)for(var s in o){var r=o[s].id-1;this.sKillStateByConfigState(o[s].star)&&this.skill_data[r].stateSkill<2&&(this.skill_data[r].stateSkill=1)}}EventProxy.Broast(EventType.updateList,[])},e.prototype.S2CShengwuActiveSkill=function(t){for(var e=net_protocol.S2CShengwuActiveSkill.decode(t.bytes),i=0;i<this.skill_data.length;i++)this.skill_data[i].id==e.id&&(this.skill_data[i].stateSkill=2);this.getFightSkillNum(),TipsControl.ins().showTips("激活技能成功!"),EventProxy.Broast(EventType.updateFight,[])},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(28251,this.S2CShengwuUnlock,this),MsgHandle.ins().regNetMsg(28250,this.S2CShengwuGetInfo,this),MsgHandle.ins().regNetMsg(28252,this.S2CShengwuCombine,this),MsgHandle.ins().regNetMsg(28253,this.S2CShengwuGetSoulTask,this),MsgHandle.ins().regNetMsg(28254,this.S2CShengwuActiveSoul,this),MsgHandle.ins().regNetMsg(28255,this.S2CShengwuUpgradeSoul,this),MsgHandle.ins().regNetMsg(28256,this.S2CShengwuActiveSkill,this)},e}(BaseSystem);__reflect(RelicProxy.prototype,"RelicProxy");var FightAttr;!function(t){t[t.HP=0]="HP",t[t.HP_MAX=1]="HP_MAX",t[t.HP_PRE=2]="HP_PRE",t[t.ATTACK=3]="ATTACK",t[t.DEFENCE=4]="DEFENCE",t[t.SPEED=5]="SPEED",t[t.POJIA=6]="POJIA",t[t.MINGZHONG=7]="MINGZHONG",t[t.SHANBI=8]="SHANBI",t[t.BAOJI_RATE=9]="BAOJI_RATE",t[t.KANG_BAOJI_RATE=10]="KANG_BAOJI_RATE",t[t.BAOJI_HURT=11]="BAOJI_HURT",t[t.KANG_BAOJI_HURT=12]="KANG_BAOJI_HURT",t[t.BAOJI_SUB_PRE=13]="BAOJI_SUB_PRE",t[t.GEDAND_RATE=14]="GEDAND_RATE",t[t.GEDAND_HURT_PRE=15]="GEDAND_HURT_PRE",t[t.POJI_RATE=16]="POJI_RATE",t[t.HURT_ADD_PRE=17]="HURT_ADD_PRE",t[t.HURT_SUB_PRE=18]="HURT_SUB_PRE",t[t.INNER_HURT=19]="INNER_HURT",t[t.INNER_SUB_HURT=20]="INNER_SUB_HURT",t[t.OUTPUT_HURT=21]="OUTPUT_HURT",t[t.OUTPUT_SUB_HURT=22]="OUTPUT_SUB_HURT",t[t.PARTNER_HURT_PRE=23]="PARTNER_HURT_PRE",t[t.SUCK_HP=24]="SUCK_HP",t[t.EXTRA_HURT=25]="EXTRA_HURT",t[t.MINGZHONG_PRE=26]="MINGZHONG_PRE",t[t.SHANBI_PRE=27]="SHANBI_PRE",t[t.ZHONGJI_RATE=28]="ZHONGJI_RATE",t[t.KANG_ZHONGJI_RATE=29]="KANG_ZHONGJI_RATE",t[t.HUIXIN_RATE=30]="HUIXIN_RATE",t[t.KANG_HUIXIN_RATE=31]="KANG_HUIXIN_RATE",t[t.LIANJI_RATE=32]="LIANJI_RATE",t[t.QIANGJI_RATE=33]="QIANGJI_RATE",t[t.HURT_REBOUND_PRE=34]="HURT_REBOUND_PRE",t[t.KANG_CONTROL_RATE=35]="KANG_CONTROL_RATE",t[t.COIN_DROP_PRE=36]="COIN_DROP_PRE",t[t.ITEM_DROP_PRE=37]="ITEM_DROP_PRE",t[t.REAL_HURT=38]="REAL_HURT",t[t.FT_WUSHI_DEFINE_PRE=39]="FT_WUSHI_DEFINE_PRE",t[t.FT_HURT_ADD_PRE=40]="FT_HURT_ADD_PRE",t[t.FT_XIUXIAN_ADD_PRE=41]="FT_XIUXIAN_ADD_PRE",t[t.FT_BAOJI_RATE=42]="FT_BAOJI_RATE",t[t.FT_BAOJI_HURT_PRE=43]="FT_BAOJI_HURT_PRE",t[t.EXP_PER=44]="EXP_PER",t[t.EQUIP_HP_PER=45]="EQUIP_HP_PER",t[t.EQUIP_ATTACK_PER=46]="EQUIP_ATTACK_PER",t[t.EQUIP_DEFENCE_PER=47]="EQUIP_DEFENCE_PER",t[t.EQUIP_POJIA_PER=48]="EQUIP_POJIA_PER",t[t.EQUIP_BAOJI_HURT_PER=49]="EQUIP_BAOJI_HURT_PER",t[t.EQUIP_KANG_BAOJI_HURT_PER=50]="EQUIP_KANG_BAOJI_HURT_PER",t[t.BAOJI_HURT_ADD_PER=51]="BAOJI_HURT_ADD_PER",t[t.KANG_BAOJI_HURT_ADD_PER=52]="KANG_BAOJI_HURT_ADD_PER",t[t.ATTACK_ADD_PER=53]="ATTACK_ADD_PER",t[t.DEFENCE_ADD_PER=54]="DEFENCE_ADD_PER"}(FightAttr||(FightAttr={}));var MoneyAttr;!function(t){t[t.LEVEL=1]="LEVEL",t[t.EXP_MAX=2]="EXP_MAX",t[t.VIP_LEVEL=3]="VIP_LEVEL",t[t.VIP_EXP=4]="VIP_EXP",t[t.ZHUAN=5]="ZHUAN",t[t.RECHARGE_YB=6]="RECHARGE_YB",t[t.FIGHTING=7]="FIGHTING",t[t.EXP=8]="EXP",t[t.COIN=9]="COIN",t[t.YUANBAO=10]="YUANBAO",t[t.ZHENQI=11]="ZHENQI",t[t.ZMXZ=12]="ZMXZ",t[t.XIUWEI=13]="XIUWEI",t[t.SHENGWANG=14]="SHENGWANG",t[t.BOSS_JH=20]="BOSS_JH"}(MoneyAttr||(MoneyAttr={}));var AvatarType;!function(t){t[t.INVALID=0]="INVALID",t[t.WING=1]="WING",t[t.ZUOQI=2]="ZUOQI",t[t.REPUTATION=3]="REPUTATION",t[t.TITLE=4]="TITLE",t[t.VIP=5]="VIP",t[t.PET=6]="PET",t[t.BELLE=7]="BELLE",t[t.BELLE_FIGHT=8]="BELLE_FIGHT",t[t.PET_FIGHT=9]="PET_FIGHT",t[t.FASHION=10]="FASHION",t[t.SHENBING=11]="SHENBING",t[t.XUNYOU=12]="XUNYOU",t[t.FIGHT=13]="FIGHT",t[t.XIANWEI=15]="XIANWEI",t[t.PROF=100]="PROF"}(AvatarType||(AvatarType={}));var RoleProxy=function(t){function e(){var i=t.call(this)||this;return i.islogin=!1,i.has_get_info=!1,i.pre_fightAttrList=[],i.pre_moneyAttrList=[],i.fightAttrList=[],i.moneyAttrList=[],i.buffList=[],i.moneyType=[8,9,10,11,12,13,14],i.isInitFight=!1,e.keyName=[],e.keyName.hp="生命",e.keyName.hp_max="生命上限",e.keyName.hp_pre="生命百分比",e.keyName.attack="攻击",e.keyName.defence="防御",e.keyName.speed="移速",e.keyName.pojia="破甲",e.keyName.mingzhong="命中",e.keyName.shanbi="闪避",e.keyName.baoji_rate="暴击率",e.keyName.kang_baoji_rate="抗暴率",e.keyName.baoji_hurt="暴伤",e.keyName.kang_baoji_hurt="暴抗",e.keyName.kang_baoji_pre="暴免",e.keyName.gedang_rate="格挡率",e.keyName.gedang_hurt_pre="格挡伤害",e.keyName.poji_rate="破击率",e.keyName.hurt_add_pre="伤害加成",e.keyName.hurt_sub_pre="伤害减免",e.keyName.inner_hurt="内功伤害",e.keyName.inner_sub_hurt="内功减免",e.keyName.output_hurt="输出伤害",e.keyName.output_sub_hurt="输出减免",e.keyName.partner_hurt_pre="伙伴伤害",e.keyName.suck_hp="攻击吸血",e.keyName.extra_hurt="额外伤害",e.keyName.mingzhong_pre="命中率",e.keyName.shanbi_pre="闪避率",e.keyName.zhongji_rate="重击率",e.keyName.kang_zhongji_rate="抗重击率",e.keyName.huixin_rate="会心率",e.keyName.kang_huixin_rate="抗会心率",e.keyName.lianji_rate="连击率",e.keyName.qiangji_rate="强击率",e.keyName.hurt_rebound_pre="反伤",e.keyName.kang_control_rate="控制抵抗",e.keyName.coin_drop_pre="金币掉率",e.keyName.item_drop_pre="物品掉率",e.keyName.real_hurt="真实伤害",e.keyName.ft_wushi_define_pre="无视防御",e.keyName.ft_hurt_add_pre="焚天仙决伤害提升",e.keyName.ft_xiuxian_add_pre="境界压制",e.keyName.ft_baoji_rate="暴击率-焚天",e.keyName.ft_baoji_hurt_pre="暴击伤害-焚天",e.keyName.exp_per="经验加成%",e.keyName.equip_hp_per="装备生命加成%",e.keyName.equip_attack_per="装备攻击加成%",e.keyName.equip_defence_per="装备防御加成%",e.keyName.equip_pojia_per="装备破甲加成%",e.keyName.equip_baoji_hurt_per="装备暴伤加成%",e.keyName.equip_kang_baoji_hurt_per="装备抗暴加成%",e.keyName.baoji_hurt_add_per="暴击伤害加成%",e.keyName.kang_baoji_hurt_add_per="抗暴击伤害加成%",e.keyName.attack_add_per="攻击加成%",e.keyName.defence_add_per="防御加成%",e.keyName.role_rate="伤害倍率",e.keyName.skill_hurt="额外伤害",e.keyName.zb_hp_pre="珍宝生命加成",e.keyName.zb_att_pre="珍宝攻击加成",e.keyName.zb_def_pre="珍宝防御加成",e.keyName.attr_per="装备灵石百分比",i}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initroledata=function(t){this.role_id=t.role_id,this.name=t.role_name,this.sex=t.sex,this.rename_count=t.rename_count,this.avatar=t.avatar,this.prof=t.prof,this.scene_id=t.scene_id,this.scene_x=t.scene_x,this.scene_y=t.scene_y,this.server_time=t.server_time,this.create_time=t.create_time,this.chat_forbid_time=t.chat_forbid_time,this.tmp_vip_time=t.tmp_vip_time,this.anchor=t.anchor,this.server_id=t.server_id,this.xunyou_state=t.xunyou_state,this.pre_fightAttrList=[],this.pre_moneyAttrList=[],this.fightAttrList=[],this.moneyAttrList=[],this.buffList=[];for(var e=0;e<t.fighting_attr.length;e++)this.fightAttrList[t.fighting_attr[e].type]=t.fighting_attr[e].value;this.pre_fightAttrList=this.fightAttrList;for(var e=0;e<t.attr_list.length;e++)this.moneyAttrList[t.attr_list[e].type]=t.attr_list[e].value,t.attr_list[e].type==MoneyAttr.LEVEL?TaskProxy.ins().CheckAcceptTask():t.attr_list[e].type==MoneyAttr.ZHUAN;this.pre_moneyAttrList=this.moneyAttrList;for(var e=0;e<t.buffs.length;e++)this.buffList[t.buffs[e].buff_id]=t.buffs[e].time;LoginProxy.ins().SetServerList(LoginProxy.cur_server_data.server_id)},e.prototype.UpdataRoleAttr=function(t){for(var e=!1,i=!1,n=0,o=0,s=0,r=0,a=0;a<t.props.length;a++){var h=t.props[a].value,l=this.moneyAttrList[t.props[a].type];t.props[a].type==MoneyAttr.LEVEL&&(e=!0,n=l,o=h),t.props[a].type==MoneyAttr.EXP&&(i=!0,s=l,r=h)}for(var a=0;a<t.props.length;a++){var p=t.props[a].value-this.moneyAttrList[t.props[a].type],h=t.props[a].value;switch(this.moneyAttrList[t.props[a].type]=t.props[a].value,t.props[a].type){case MoneyAttr.LEVEL:e=!0,TaskProxy.ins().CheckAcceptTask(),SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.LEVEL),SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.LEVLEORSERVERDAY),XiuXianProxy.ins().updateAchieRed(AchieType.role_level),XiuXianProxy.ins().updateZhuanRed(),VenationProxy.ins().updateRed(),EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.LEVEL]),EventProxy.Broast(EventType.UpdateSetUp,[]),EventProxy.Broast(EventType.RefreshBossRed,[]),EventProxy.Broast(EventType.updateLv,[]);var c=GameMap.centerEntity;if(c){var u=new MovieClip;c.addChild(u),u.playFile(AssetMgr.getLevelUpResource(),1)}SdkManager.ins().SubmitRoleData(3);break;case MoneyAttr.ZHUAN:SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.ZHUAN),SystemOpenProxy.ins().checkSystemOpen(SystemOpenType.ZHUANORSERVERDAY),XiuXianProxy.ins().updateAchieRed(AchieType.zhuan),XiuXianProxy.ins().updateZhuanRed(),VenationProxy.ins().updateRed(),EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.ZHUAN]),EventProxy.Broast(EventType.RefreshBossRed,[]),EventProxy.Broast(EventType.UpdateSetUp,[]);break;case MoneyAttr.COIN:VenationProxy.ins().updateRed(),EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.COIN]);break;case MoneyAttr.YUANBAO:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.YUANBAO]);break;case MoneyAttr.ZHENQI:EventProxy.Broast(EventType.UpdateSkillRed,[]),EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.ZHENQI]);break;case MoneyAttr.XIUWEI:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.XIUWEI]);break;case MoneyAttr.FIGHTING:this.isInitFight&&p>0&&TipsControl.ins().showAddFight(h,p),this.isInitFight=!0,EventProxy.Broast(EventType.UpdateFight,{});break;case MoneyAttr.SHENGWANG:XiuXianProxy.ins().updateAchieRed(AchieType.shengwang),XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.SHENGWANG]),EventProxy.Broast(EventType.RefreshTitleRed,[]);break;case MoneyAttr.ZMXZ:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.ZMXZ]);break;case MoneyAttr.EXP:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.EXP]);break;case MoneyAttr.EXP_MAX:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.EXP]);break;case MoneyAttr.VIP_LEVEL:case MoneyAttr.VIP_EXP:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.VIP_EXP]),EventProxy.Broast(EventType.UpdateSetUp,[]);break;case MoneyAttr.BOSS_JH:EventProxy.Broast(EventType.UpdataMoney,[MoneyAttr.BOSS_JH]),EventProxy.Broast(EventType.RefreshStoreRed,[])}if(this.IsMoneyType(t.props[a].type)){var d=BagProxy.ins().getItemData(t.props[a].type);d&&p>0&&TipsControl.ins().showTips(UtilProxy.getStr("|C:@0 &@1 | x@2 ",[BagProxy.QUALITY_COLOR[d.quality-1],d.name,p]))}}(e||i)&&EventProxy.Broast(EventType.UpdataExpOrLevel,[e,n,o,s,r]),this.pre_moneyAttrList=this.moneyAttrList},e.prototype.IsMoneyType=function(t){for(var e=0;e<this.moneyType.length;e++)if(t==this.moneyType[e])return!0;return!1},e.prototype.UpdataRoleFightAttr=function(t){for(var e=0;e<t.props.length;e++)this.fightAttrList[t.props[e].type]=Math.floor(t.props[e].value),GameMap.centerEntity&&GameMap.centerEntity.setProp(t.props[e].type,Math.floor(t.props[e].value));this.pre_fightAttrList=this.fightAttrList},e.prototype.getFightAttr=function(t){return this.fightAttrList[t]||0},e.prototype.getMoneyAttr=function(t){return this.moneyAttrList[t]||0},e.prototype.getFightAttrs=function(){return this.fightAttrList},e.prototype.getRoleBaseInfo=function(t){return e.ins()[t]},e.prototype.getRoleName=function(){return this.name||""},e.prototype.setRoleName=function(t){return this.name=t},e.prototype.getRoleSex=function(){return this.prof||1},e.prototype.setRoleSex=function(t){this.prof=t},e.prototype.getRoleServerId=function(){return this.server_id||0},e.prototype.getRoleLv=function(){return this.getMoneyAttr(MoneyAttr.LEVEL)},e.prototype.getSceneId=function(){return this.scene_id||0},e.prototype.setSceneId=function(t){this.scene_id=t},e.prototype.GetOtherUIModel=function(t,e){if(2==e&&ResVersionManager.ins().isInCheck())return"ui_body204";if(t>0&&GlobalConfig.getFashion_id_dataConfig(t)){var i=GlobalConfig.getFashion_id_dataConfig(t).ui_model.split("|");return i[e-1]}var n=GlobalConfig.getMisc_dataConfig(1).role_uimodel[e-1];return n?n:"ui_body"+e+"01"},e.prototype.GetOtherUIWeapon=function(t){return GlobalConfig.getWeaponResById(t)&&""!=GlobalConfig.getWeaponResById(t).ui_model?GlobalConfig.getWeaponResById(t).ui_model:"ui_weapon001"},e.prototype.GetOtherUIWing=function(t){return GlobalConfig.getWingResById(t)&&""!=GlobalConfig.getWingResById(t).ui_model?GlobalConfig.getWingResById(t).ui_model:""},e.prototype.setClothId=function(t){this.cloth_id=t},e.prototype.getClothId=function(){return this.cloth_id||0},e.prototype.setWingId=function(t){this.wing_id=t},e.prototype.getWingId=function(){return this.wing_id||0},e.prototype.setWeaponId=function(t){this.weapon_id=t},e.prototype.getWeaponId=function(){return this.weapon_id||0},e.prototype.setMountId=function(t){this.mount_id=t||0},e.prototype.getMountId=function(){return this.mount_id||0},e.prototype.getRoleId=function(){return this.role_id||0},e.prototype.getProf=function(){return this.prof||1},e.prototype.isInXunyou=function(){return this.xunyou_state>0},e.prototype.setXuyou=function(t){this.xunyou_state=t},e.prototype.getCreateTime=function(){return this.create_time||0},e.prototype.getTableAdd=function(t,i){var n={};if(t)for(var o in t)e.keyName[o]&&(n[o]=t[o]);if(i)for(var o in i)e.keyName[o]&&(n[o]?n[o]+=i[o]:n[o]=i[o]);return n},e.keyName=[],e}(BaseClass);__reflect(RoleProxy.prototype,"RoleProxy");var HeadItemData=function(){function t(){}return t.prototype.setHeadData=function(t,e,i){this.id=t,this.type=e,this.state=i,1==e?this.config=GlobalConfig.getSetup_head_dataConfig(t):2==e&&(this.config=GlobalConfig.getSetup_head_frame_dataConfig(t))},t}();__reflect(HeadItemData.prototype,"HeadItemData");var ChatItemData=function(){function t(){}return t.prototype.setChatData=function(t,e){this.id=t,this.state=e,this.config=GlobalConfig.getSetup_chat_frame_dataConfig(t)},t}();__reflect(ChatItemData.prototype,"ChatItemData");var SetProxy=function(t){function e(){var e=t.call(this)||this;return e.head_list=[],e.head_frame_list=[],e.chat_fram_list=[],e.clickByBox=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqMiscGetSetupInfo=function(){var t=new net_protocol.C2SReqMiscGetSetupInfo;CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscGetSetupInfo"),this.sendPbPack(Msg.C2SReqMiscGetSetupInfo,t,net_protocol.C2SReqMiscGetSetupInfo)},e.prototype.S2CRepMiscGetSetupInfo=function(t){var e=net_protocol.S2CRepMiscGetSetupInfo.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscGetSetupInfo",e),this.head_list=e.head_list,this.head_frame_list=e.head_frame_list,this.chat_fram_list=e.chat_fram_list,this.use_head_id=e.use_head_id,this.use_head_frame_id=e.use_head_frame_id,this.use_chat_frame_id=e.use_chat_frame_id,this.hidden_faction=e.hidden_faction,EventProxy.Broast(EventType.S2CRepMiscGetSetupInfo,[])},e.prototype.aloneRedByIndex=function(t){switch(t){case 0:GlobalConfig.getConfig("setup_head_data","setup_head_dataConfig");for(var i in GlobalConfig.ins().setup_head_dataConfig){var n=GlobalConfig.ins().setup_head_dataConfig[i];if(RoleProxy.ins().getRoleSex()==n.sex&&e.ins().isCanUse(n))return!0}break;case 1:GlobalConfig.getConfig("setup_head_frame_data","setup_head_frame_dataConfig");for(var i in GlobalConfig.ins().setup_head_frame_dataConfig){var o=GlobalConfig.ins().setup_head_frame_dataConfig[i];if(e.ins().isCanUse(o))return!0}break;case 2:GlobalConfig.getConfig("setup_chat_frame_data","setup_chat_frame_dataConfig");for(var i in GlobalConfig.ins().setup_chat_frame_dataConfig){var s=GlobalConfig.ins().setup_chat_frame_dataConfig[i];if(e.ins().isCanUse(s))return!0}}},e.prototype.isCanUse=function(t){var e=!1;return void 0!=t&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=t.level&&RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)>=t.zhuan&&RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)>=t.vip&&this.bagHaveItem(t)&&1!=t.open&&-1==this.head_list.indexOf(t.id)&&-1==this.head_frame_list.indexOf(t.id)&&-1==this.chat_fram_list.indexOf(t.id)&&(e=!0),e},e.prototype.isRedByMain=function(){GlobalConfig.getConfig("setup_head_frame_data","setup_head_frame_dataConfig");for(var t in GlobalConfig.ins().setup_head_frame_dataConfig){var i=GlobalConfig.ins().setup_head_frame_dataConfig[t];if(e.ins().isCanUse(i))return!0}GlobalConfig.getConfig("setup_chat_frame_data","setup_chat_frame_dataConfig");for(var t in GlobalConfig.ins().setup_chat_frame_dataConfig){var n=GlobalConfig.ins().setup_chat_frame_dataConfig[t];if(e.ins().isCanUse(n))return!0}GlobalConfig.getConfig("setup_head_data","setup_head_dataConfig");for(var t in GlobalConfig.ins().setup_head_dataConfig){var o=GlobalConfig.ins().setup_head_dataConfig[t];if(RoleProxy.ins().getRoleSex()==o.sex&&e.ins().isCanUse(o))return!0}return!1},e.prototype.bagHaveItem=function(t){var e=!1;if(void 0!=t&&t.items.length>0){var i=BagProxy.ins().getItemCountById(t.items[0]);i>=t.items[1]&&(e=!0)}else void 0!=t&&0==t.items.length&&(e=!0);return e},e.prototype.useChatFrame=function(){return this.use_chat_frame_id||0},e.prototype.useHead=function(){return this.use_head_id||0},e.prototype.useHeadFrame=function(){return this.use_head_frame_id||0},e.prototype.getHeadDefaultOpenId=function(){GlobalConfig.getConfig("setup_head_data","setup_head_dataConfig");for(var t in GlobalConfig.ins().setup_head_dataConfig)if(GlobalConfig.ins().setup_head_dataConfig[t].sex==RoleProxy.ins().getProf()&&1==GlobalConfig.ins().setup_head_dataConfig[t].open)return GlobalConfig.ins().setup_head_dataConfig[t].id},e.prototype.getHeadFrameDefaultOpenId=function(){GlobalConfig.getConfig("setup_head_frame_data","setup_head_frame_dataConfig");for(var t in GlobalConfig.ins().setup_head_frame_dataConfig)if(1==GlobalConfig.ins().setup_head_frame_dataConfig[t].open)return GlobalConfig.ins().setup_head_frame_dataConfig[t].id},e.prototype.getCharFrameDefaultOpenId=function(){GlobalConfig.getConfig("setup_chat_frame_data","setup_chat_frame_dataConfig");for(var t in GlobalConfig.ins().setup_chat_frame_dataConfig)if(1==GlobalConfig.ins().setup_chat_frame_dataConfig[t].open)return GlobalConfig.ins().setup_chat_frame_dataConfig[t].id},e.prototype.C2SReqMiscRename=function(t,e,i){var n=new net_protocol.C2SReqMiscRename;n.type=t,n.role_name=e,n.prof=i,CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscRename",n),this.sendPbPack(Msg.C2SReqMiscRename,n,net_protocol.C2SReqMiscRename)},e.prototype.S2CRepMiscRename=function(t){var e=net_protocol.S2CRepMiscRename.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscRename",e),0==e.result?(TipsControl.ins().showTips("改名成功！"),RoleProxy.ins().setRoleSex(e.prof),RoleProxy.ins().setRoleName(e.role_name),GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.prof,AvatarType.PROF),SdkManager.ins().SubmitRoleData(5),EventProxy.Broast(EventType.S2CRepMiscRename,[])):1==e.result?TipsControl.ins().showTips("名字重复!"):2==e.result?TipsControl.ins().showTips("物品货币不足!"):3==e.result&&TipsControl.ins().showTips("非法名字!")},e.prototype.getLabelName=function(t){var e="";switch(t){case 1:e="头像";break;case 2:e="头像框";break;case 3:e="聊天框"}return e},e.prototype.C2SReqMiscActiveHead=function(t){var e=new net_protocol.C2SReqMiscActiveHead;e.id=t,CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscActiveHead",e),this.sendPbPack(Msg.C2SReqMiscActiveHead,e,net_protocol.C2SReqMiscActiveHead)},e.prototype.S2CRepMiscActiveHead=function(t){var e=net_protocol.S2CRepMiscActiveHead.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscActiveHead",e),void 0==this.head_list&&(this.head_list=[]),this.head_list.push(e.id),TipsControl.ins().showTips("激活成功！"),EventProxy.Broast(EventType.S2CRepMiscActiveHead,[e.id])},e.prototype.C2SReqMiscActiveHeadFrame=function(t){var e=new net_protocol.C2SReqMiscActiveHeadFrame;e.id=t,CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscActiveHeadFrame",e),this.sendPbPack(Msg.C2SReqMiscActiveHeadFrame,e,net_protocol.C2SReqMiscActiveHeadFrame)},e.prototype.S2CRepMiscActiveHeadFrame=function(t){var e=net_protocol.S2CRepMiscActiveHeadFrame.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscActiveHeadFrame",e),void 0==this.head_frame_list&&(this.head_frame_list=[]),this.head_frame_list.push(e.id),TipsControl.ins().showTips("激活成功！"),EventProxy.Broast(EventType.S2CRepMiscActiveHeadFrame,[e.id])},e.prototype.C2SReqMiscSetHead=function(t,e){var i=new net_protocol.C2SReqMiscSetHead;i.id=t,i.type=e,CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscSetHead",i),this.sendPbPack(Msg.C2SReqMiscSetHead,i,net_protocol.C2SReqMiscSetHead)},e.prototype.S2CRepMiscSetHead=function(t){var e=net_protocol.S2CRepMiscSetHead.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscSetHead",e),this.use_head_id=e.id,this.use_head_frame_id=e.head_frame,this.hidden_faction=e.hidden_faction,TipsControl.ins().showTips("使用成功!"),EventProxy.Broast(EventType.S2CRepMiscSetHead,[])},e.prototype.C2SReqMiscActiveChatFrame=function(t){var e=new net_protocol.C2SReqMiscActiveChatFrame;e.id=t,CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscActiveChatFrame",e),this.sendPbPack(Msg.C2SReqMiscActiveChatFrame,e,net_protocol.C2SReqMiscActiveChatFrame)},e.prototype.S2CRepMiscActiveChatFrame=function(t){var e=net_protocol.S2CRepMiscActiveChatFrame.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscActiveChatFrame",e),void 0==this.chat_fram_list&&(this.chat_fram_list=[]),this.chat_fram_list.push(e.id),TipsControl.ins().showTips("使用成功！"),EventProxy.Broast(EventType.S2CRepMiscActiveChatFrame,[e.id])},e.prototype.C2SReqMiscSetChatFrame=function(t){var e=new net_protocol.C2SReqMiscSetChatFrame;e.id=t,CommonUtils.log("@^^--^^@??@^^==^^@ C2SReqMiscSetChatFrame",e),this.sendPbPack(Msg.C2SReqMiscSetChatFrame,e,net_protocol.C2SReqMiscSetChatFrame)},e.prototype.S2CRepMiscSetChatFrame=function(t){var e=net_protocol.S2CRepMiscSetChatFrame.decode(t.bytes);CommonUtils.log("@^^--^^@??@^^==^^@ S2CRepMiscSetChatFrame",e),this.use_chat_frame_id=e.id,TipsControl.ins().showTips("使用成功！"),EventProxy.Broast(EventType.S2CRepMiscSetChatFrame,[])},e.prototype.S2CRepMiscCommonErrorCode=function(t){var e=net_protocol.S2CRepMiscCommonErrorCode.decode(t.bytes),i=GlobalConfig.getErrCode(e.code);i?TipsControl.ins().showTips(i.notice):TipsControl.ins().showTips("C:4&错误码不存在:"+e.code)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25152,this.S2CRepMiscRename,this),MsgHandle.ins().regNetMsg(25163,this.S2CRepMiscGetSetupInfo,this),MsgHandle.ins().regNetMsg(25164,this.S2CRepMiscActiveHead,this),MsgHandle.ins().regNetMsg(25165,this.S2CRepMiscActiveHeadFrame,this),MsgHandle.ins().regNetMsg(25166,this.S2CRepMiscSetHead,this),MsgHandle.ins().regNetMsg(25167,this.S2CRepMiscActiveChatFrame,this),MsgHandle.ins().regNetMsg(25168,this.S2CRepMiscSetChatFrame,this),MsgHandle.ins().regNetMsg(25170,this.S2CRepMiscCommonErrorCode,this)},e.prototype.dataConfig=function(){GlobalConfig.getConfig("setup_chat_frame_data","setup_chat_frame_dataConfig");var t=GlobalConfig.ins().setup_chat_frame_dataConfig;return t},e.prototype.isHeadActive=function(t){if(void 0==this.head_list)return!1;for(var e=0;e<this.head_list.length;++e)if(this.head_list[e]==t)return!0;return!1},e.prototype.isHeadFrameActive=function(t){if(void 0==this.head_frame_list)return!1;for(var e=0;e<this.head_frame_list.length;++e)if(this.head_frame_list[e]==t)return!0;return!1},e.prototype.isCharFrameActive=function(t){if(void 0==this.chat_fram_list)return!1;for(var e=0;e<this.chat_fram_list.length;++e)if(this.chat_fram_list[e]==t)return!0;return!1},e.prototype.getHeadIcon=function(t){var e=GlobalConfig.getSetup_head_dataConfig(t);return void 0!=e?e.icon:""},e.prototype.getHeadFrame=function(t){var e=GlobalConfig.getSetup_head_frame_dataConfig(t);return void 0!=e?e.icon:""},e.prototype.getChatFrame=function(t){var e=GlobalConfig.getSetup_chat_frame_dataConfig(t);return void 0!=e?e.icon:""},e}(BaseSystem);__reflect(SetProxy.prototype,"SetProxy");var OppInfo=function(){function t(){}return t}();__reflect(OppInfo.prototype,"OppInfo");var ArenaReport=function(){function t(){}return t}();__reflect(ArenaReport.prototype,"ArenaReport");var ShenXianProxy=function(t){function e(){var e=t.call(this)||this;return e.buy_challenge_times=0,e.last_recover_time=0,e.left_challenge_times=0,e.opps=[],e.rank_index=0,e.lastrank_index=0,e.Awards=[],e.challengerank_index=0,e.top_rank_index=0,e.challengename="",e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqArenaGetInfo=function(){var t=new net_protocol.C2SReqArenaGetInfo;this.sendPbPack(Msg.C2SReqArenaGetInfo,t,net_protocol.C2SReqArenaGetInfo)},e.prototype.C2SReqArenaChallenge=function(t,e,i){var n=new net_protocol.C2SReqArenaChallenge;n.id=t,n.role_id=e,n.rank_index=i,this.challengerank_index=i,this.sendPbPack(Msg.C2SReqArenaChallenge,n,net_protocol.C2SReqArenaChallenge)},e.prototype.C2SReqArenaRefreshOpp=function(){var t=new net_protocol.C2SReqArenaRefreshOpp;this.sendPbPack(Msg.C2SReqArenaRefreshOpp,t,net_protocol.C2SReqArenaRefreshOpp)},e.prototype.C2SReqArenaSweep=function(t,e,i){var n=new net_protocol.C2SReqArenaSweep;n.id=t,n.role_id=e,n.rank_index=i,this.sendPbPack(Msg.C2SReqArenaSweep,n,net_protocol.C2SReqArenaSweep)},e.prototype.C2SReqArenaBuyChallengeNum=function(t){var e=new net_protocol.C2SReqArenaBuyChallengeNum;e.num=t,this.sendPbPack(Msg.C2SReqArenaBuyChallengeNum,e,net_protocol.C2SReqArenaBuyChallengeNum)},e.prototype.C2SReqArenaGetRankAward=function(){var t=new net_protocol.C2SReqArenaGetRankAward;this.sendPbPack(Msg.C2SReqArenaGetRankAward,t,net_protocol.C2SReqArenaGetRankAward)},e.prototype.C2SReqArenaGetRankList=function(t){var e=new net_protocol.C2SReqArenaGetRankList;e.rank_start=t,this.sendPbPack(Msg.C2SReqArenaGetRankList,e,net_protocol.C2SReqArenaGetRankList)},e.prototype.C2SReqArenaLoadingFinish=function(){var t=new net_protocol.C2SReqArenaLoadingFinish;this.sendPbPack(Msg.C2SReqArenaLoadingFinish,t,net_protocol.C2SReqArenaLoadingFinish)},e.prototype.C2SReqArenaGetFirstRankAward=function(t){var e=new net_protocol.C2SReqArenaGetFirstRankAward;e.index=t,this.sendPbPack(Msg.C2SReqArenaGetFirstRankAward,e,net_protocol.C2SReqArenaGetFirstRankAward)},e.prototype.S2CRepArenaGetInfo=function(t){var e=net_protocol.S2CRepArenaGetInfo.decode(t.bytes);this.buy_challenge_times=e.buy_challenge_times,this.last_recover_time=e.last_recover_time,this.left_challenge_times=e.left_challenge_times,this.rank_index=e.rank_index,this.top_rank_index=e.top_rank_index,this.opps=[];for(var i=0;i<e.opps.length;i++){var n=e.opps[i];this.opps.push(n)}EventProxy.Broast(EventType.S2CRepArenaGetInfo,{}),EventProxy.Broast(EventType.UpdataTask,{})},e.prototype.sort=function(t,e){return t.rank_index<e.rank_index?1:t.rank_index>e.rank_index?-1:0},e.prototype.S2CRepArenaChallenge=function(t){var e=net_protocol.S2CRepArenaChallenge.decode(t.bytes);0==e.result?(this.left_challenge_times=this.left_challenge_times-1,ViewManager.ins().close(ShenxianView)):1==e.result?(TipsControl.ins().showTips("该玩家正在进行战斗"),this.C2SReqArenaRefreshOpp()):2==e.result&&(TipsControl.ins().showTips("该玩家的排名已改变"),this.C2SReqArenaRefreshOpp()),EventProxy.Broast(EventType.S2CRepArenaChallenge,{})},e.prototype.S2CRepArenaRefreshOpp=function(t){var e=net_protocol.S2CRepArenaRefreshOpp.decode(t.bytes);this.opps=[];for(var i=0;i<e.opps.length;i++){var n=e.opps[i];this.opps.push(n)}EventProxy.Broast(EventType.S2CRepArenaRefreshOpp,{})},e.prototype.S2CRepArenaSweep=function(t){var e=net_protocol.S2CRepArenaSweep.decode(t.bytes);this.left_challenge_times=this.left_challenge_times-1;var i=[];i=0==e.result?GlobalConfig.getArena_base_dataConfig(1).win_award:GlobalConfig.getArena_base_dataConfig(1).lose_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |",[this.challengename]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!\n当前排名|C:7&@1 |名\n@2 ",[this.challengename,this.rank_index,0==this.top_rank_index?"":UtilProxy.getStr("历史最高排名|C:7&@0 |名",[this.top_rank_index])]),ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.SHENXIAN,a),EventProxy.Broast(EventType.S2CRepArenaSweep,{})},e.prototype.S2CRepArenaBuyChallengeNum=function(t){net_protocol.S2CRepArenaBuyChallengeNum.decode(t.bytes);this.left_challenge_times=this.left_challenge_times+1,this.buy_challenge_times=this.buy_challenge_times+1,TipsControl.ins().showTips("挑战次数购买成功"),EventProxy.Broast(EventType.S2CRepArenaBuyChallengeNum,{})},e.prototype.S2CRepArenaGetRankAward=function(t){net_protocol.S2CRepArenaGetRankAward.decode(t.bytes);EventProxy.Broast(EventType.S2CRepArenaGetRankAward,{})},e.prototype.S2CRepArenaGetRankList=function(t){net_protocol.S2CRepArenaGetRankList.decode(t.bytes);EventProxy.Broast(EventType.S2CRepArenaGetRankList,{})},e.prototype.S2CRepArenaChallengeResult=function(t){var e=net_protocol.S2CRepArenaChallengeResult.decode(t.bytes),i=[];0==e.result?(i=GlobalConfig.getArena_base_dataConfig(1).win_award,this.challengerank_index>0&&(this.lastrank_index=this.rank_index,this.rank_index>0?this.rank_index=Math.min(this.challengerank_index,this.rank_index):this.rank_index=this.challengerank_index)):i=GlobalConfig.getArena_base_dataConfig(1).lose_award;for(var n=[],o=0;o<i.length;o++){var s=new ItemCellData,r={item_slot_idx:0,item_type_id:i[o][0],item_count:i[o][1]};s.setItemCellData(r),n.push(s)}var a="";a=0==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |\n排名提升至|C:10&@1 |名",[this.challengename,this.rank_index]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!\n当前排名|C:7&@1 |名\n@2 ",[this.challengename,this.rank_index,0==this.top_rank_index?"":UtilProxy.getStr("历史最高排名|C:7&@0 |名",[this.top_rank_index])]),ViewManager.ins().open(PvpEndView,n,0==e.result,EndType.SHENXIAN,a),this.clearAward(),this.Awards=e.awards,EventProxy.Broast(EventType.S2CRepArenaChallengeResult,{})},e.prototype.S2CRepArenaGetFirstRankAward=function(t){net_protocol.S2CRepArenaGetFirstRankAward.decode(t.bytes);EventProxy.Broast(EventType.S2CRepArenaGetFirstRankAward,{})},e.prototype.getYBAward=function(){var t=0;for(var e in this.Awards)this.Awards[e].id==MoneyAttr.YUANBAO&&(t+=this.Awards[e].count);return t},e.prototype.clearAward=function(){this.Awards=[]},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,12,!0)?e.ins().left_challenge_times>0:!1},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27150,this.S2CRepArenaGetInfo,this),MsgHandle.ins().regNetMsg(27151,this.S2CRepArenaChallenge,this),MsgHandle.ins().regNetMsg(27152,this.S2CRepArenaRefreshOpp,this),MsgHandle.ins().regNetMsg(27153,this.S2CRepArenaSweep,this),MsgHandle.ins().regNetMsg(27154,this.S2CRepArenaBuyChallengeNum,this),MsgHandle.ins().regNetMsg(27155,this.S2CRepArenaGetRankAward,this),MsgHandle.ins().regNetMsg(27156,this.S2CRepArenaGetRankList,this),MsgHandle.ins().regNetMsg(27157,this.S2CRepArenaChallengeResult,this),MsgHandle.ins().regNetMsg(27158,this.S2CRepArenaGetFirstRankAward,this)
},e}(BaseSystem);__reflect(ShenXianProxy.prototype,"ShenXianProxy");var SkillProxy=function(t){function e(){var e=t.call(this)||this;return e.useList=[],e.idlist=[],e.runeList=[],e.playList=[],e.releaseSkills=!1,e.show_id={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqSkillGetInfo=function(){var t=new net_protocol.C2SReqSkillGetInfo;this.sendPbPack(Msg.C2SReqSkillGetInfo,t,net_protocol.C2SReqSkillGetInfo)},e.prototype.C2SReqSkillUpgrade=function(t){var e=new net_protocol.C2SReqSkillUpgrade;e.list=t,this.sendPbPack(Msg.C2SReqSkillUpgrade,e,net_protocol.C2SReqSkillUpgrade)},e.prototype.C2SReqSkillUse=function(t){var e=new net_protocol.C2SReqSkillUse;e.list=t,this.sendPbPack(Msg.C2SReqSkillUse,e,net_protocol.C2SReqSkillUse)},e.prototype.C2SReqSkillUpgradeRune=function(t){var e=new net_protocol.C2SReqSkillUpgradeRune;e.rune_id=t,this.sendPbPack(Msg.C2SReqSkillUpgradeRune,e,net_protocol.C2SReqSkillUpgradeRune),CommonUtils.log("请求升级符文:",t)},e.prototype.checkActiveOpen=function(){for(var t in this.show_id)if(this.show_id[t]&&GameLogic.ins().isMainScene()){this.show_id[t]=!1,ViewManager.ins().open(SkillGetView,Number(t));break}},e.prototype.S2CRepSkillUpdate=function(t){var e=net_protocol.S2CRepSkillUpdate.decode(t.bytes);if(void 0!=this.idlist&&this.idlist.length>0){for(var i={},n=0;n<this.idlist.length;n++)i[Math.floor(this.idlist[n]/1e4)]=!0;for(var n=0;n<e.skill_list.length;n++){var o=e.skill_list[n];o==SkillCC.ins().normal_skill_id||o==SkillCC.ins().best_skill_id||i[Math.floor(o/1e4)]||(this.show_id[o]=!0,this.checkActiveOpen())}}this.idlist=[],this.useList=[],this.runeList=[],this.playList=[];for(var n=0;n<e.skill_list.length;n++)this.idlist.push(e.skill_list[n]);for(var n=0;n<e.use_list.length;n++){var s=e.use_list[n];this.useList.push(s)}this.useList.sort(function(t,e){return t.slot!=e.slot?t.slot-e.slot:t.skill_id-e.skill_id});for(var n=0;n<this.useList.length;n++){var o=this.useList[n].skill_id;1e6!=o&&2e6!=o&&this.playList.push(this.useList[n].skill_id)}for(var n=0;n<e.runes.length;n++){var r=e.runes[n];this.runeList[r.rune_id]=r.level}if(this.fabao_jingjie_level=e.fabao_jingjie_level,0==this.idlist.length&&0==this.useList.length){var a=[];a.push({skill_id:1e6,count:1}),a.push({skill_id:2e6,count:1}),this.C2SReqSkillUpgrade(a);var h=[];h.push({skill_id:1e6,slot:0}),h.push({skill_id:2e6,slot:10}),this.C2SReqSkillUse(h)}else for(var n=0;n<this.useList.length;n++){var o=this.useList[n].skill_id%1e6%1e4;SkillCC.ins().setSkillsByIndex(1,this.useList[n].slot,o,this.useList[n].skill_id)}XiuXianProxy.ins().updateAchieRed(AchieType.skill_level),EventProxy.Broast(EventType.UpdateSkillRed,[]),EventProxy.Broast(EventType.S2CRepSkillUpdate,[])},e.prototype.getPlayList=function(){return this.playList},e.prototype.getBestSkillIndex=function(){if(void 0==this.useList)return-1;for(var t=0;t<this.useList.length;t++)if(this.useList[t].skill_id==SkillCC.ins().best_skill_id)return t;return 0},e.prototype.S2CRepSkillUpgradeRune=function(t){var e=net_protocol.S2CRepSkillUpgradeRune.decode(t.bytes);void 0==this.runeList&&(this.runeList=[]),this.runeList[e.rune_id]=e.level,EventProxy.Broast(EventType.UpdateSkillRed,[]),EventProxy.Broast(EventType.S2CRepSkillUpgradeRune,[])},e.prototype.S2CRepSkillUpdateExtendParam=function(t){var e=net_protocol.S2CRepSkillUpdateExtendParam.decode(t.bytes);this.fabao_jingjie_level=e.fabao_jingjie_level,EventProxy.Broast(EventType.S2CRepSkillUpdateExtendParam,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25250,this.S2CRepSkillUpdate,this),MsgHandle.ins().regNetMsg(25251,this.S2CRepSkillUpgradeRune,this),MsgHandle.ins().regNetMsg(25252,this.S2CRepSkillUpdateExtendParam,this)},e.prototype.getSkillIndexById=function(t){for(var e=0;e<this.useList.length;e++)if(this.useList[e]&&this.useList[e].skill_id==t)return this.useList[e].slot;return 0},e.prototype.getSkillIdByIndex=function(t){for(var e=0;e<this.useList.length;e++)if(this.useList[e].slot==t)return this.useList[e].skill_id;return 0},e.prototype.getIdList=function(){return this.idlist||[]},e.prototype.getUseList=function(){return this.useList},e.prototype.getlvupUseList=function(){for(var t=[],e=0;e<this.useList.length;e++)this.useList[e].skill_id!=SkillCC.ins().normal_skill_id&&this.useList[e].skill_id!=SkillCC.ins().best_skill_id&&t.push(this.useList[e]);return t},e.prototype.isSkillUse=function(t){for(var e=0;e<this.useList.length;e++)if(this.useList[e].skill_id==t)return!0;return!1},e.prototype.isActive=function(t){for(var e=Math.floor(t/1e4),i=0,n=this.idlist;i<n.length;i++){var o=n[i];if(Math.floor(o/1e4)==e)return!0}return!1},e.prototype.getSkillIdByStartId=function(t){for(var e=0,i=this.idlist;e<i.length;e++){var n=i[e];if(Math.floor(n/1e4)==Math.floor(t/1e4))return n}return t},e.prototype.getSkillLvById=function(t){var e=t%1e4;return e},e.prototype.getSkillFight=function(){for(var t=0,i=e.ins().getIdList(),n=0,o=i;n<o.length;n++){var s=o[n],r=GlobalConfig.getLearnSkillConfigById(s);r&&(t+=UtilProxy.GetAttrFight(r))}return t},e.prototype.getMaxLv=function(t){if(void 0==this.maxLvList){this.maxLvList=[];var e=GlobalConfig.getConfig("learn_skill","LearnSkill");for(var i in e){var n=e[i],o=Math.floor(n.id/1e4),s=n.id%1e4;void 0!=this.maxLvList[o]?this.maxLvList[o]<s&&(this.maxLvList[o]=s):this.maxLvList[o]=s}}var r=Math.floor(t/1e4);return this.maxLvList[r]||0},e.prototype.getInitSkillList=function(){if(void 0!=this.skillInitList)return this.skillInitList;this.skillInitList=[];var t=0,e=[],i=GlobalConfig.getConfig("learn_skill","LearnSkill");for(var n in i)t=Math.floor(parseInt(n)/1e4),void 0==e[t]&&"1000000"!=n&&"2000000"!=n&&(e[t]=t);for(var o=0,s=e;o<s.length;o++){var r=s[o];void 0!=r&&this.skillInitList.push(1e4*r+1)}return this.skillInitList},e.prototype.isPuGong=function(t){return 1e6==t},e.prototype.getRunelv=function(t){return void 0==this.runeList||void 0==this.runeList[t]?0:this.runeList[t]},e.prototype.getFabaoJjLv=function(){return this.fabao_jingjie_level||0},e.prototype.getSkillLvSum=function(){for(var t=this.getIdList(),e=0,i=0;i<t.length;i++){var n=t[i]%1e4;e+=n}return e},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,29,!0)?this.getSkRed()||this.getFsRed():!1},e.prototype.getSkRed=function(){for(var t in this.idlist){var e=this.idlist[t];if(e!=SkillCC.ins().normal_skill_id&&e!=SkillCC.ins().best_skill_id&&this.getRedById(this.idlist[t]))return!0}return this.getOneDressRed()},e.prototype.getFsRed=function(){return this.getFsRedById(2)?!0:!1},e.prototype.getFsRedById=function(t){var i=e.ins().getRunelv(t),n=GlobalConfig.getFsSkillById(t)[i+1];if(n){var o=BagProxy.ins().getItemCountByIDtype(n.items[0][0],BagType.BAG),s=n.items[0][1];if(o>=s)return!0}return!1},e.prototype.getOneLvupRed=function(){if(!this.useList)return!1;for(var t=0;t<this.useList.length;t++){var e=this.useList[t].skill_id;if(e!=SkillCC.ins().normal_skill_id&&e!=SkillCC.ins().best_skill_id&&this.getRedById(this.useList[t].skill_id))return!0}return!1},e.prototype.getOneDressRed=function(){for(var t=e.ins().getIdList(),i=[],n=0;n<t.length;n++){var o=GlobalConfig.getLearnSkillConfigById(t[n]),s=GlobalConfig.getSkillDescById(Math.floor(t[n]/1e4));o&&s&&s.dress_sort>0&&i.push({id:t[n],sort:s.dress_sort})}i.sort(function(t,e){return t.sort-e.sort});for(var r={},n=0;n<i.length;n++)if(6>n){var a=i[n];r[a.id]=!0}for(var h in r)if(h&&!this.isSkillUse(parseInt(h)))return!0;return!1},e.prototype.getRedById=function(t){if(!e.ins().isActive(t))return!1;var i=GlobalConfig.getLearnSkillConfigById(t+1);return i&&RoleProxy.ins().getMoneyAttr(i.need_exp[0][0])>=i.need_exp[0][1]?!0:!1},e.prototype.getTenRedById=function(t){if(!e.ins().isActive(t))return!1;var i=GlobalConfig.getLearnSkillConfigById(t+1);return i?i.need_exp[0][1]>=this.getTenCostValue(t):!1},e.prototype.getTenCostValue=function(t){var i=t;e.ins().isActive(t)&&(i=t+1);for(var n=0,o=1e4*Math.floor(t/1e4)+this.getMaxLv(t),s=i;i+10>s;s++)if(o>s){var r=GlobalConfig.getLearnSkillConfigById(s);n+=r.need_exp[0][1]}return n},e}(BaseSystem);__reflect(SkillProxy.prototype,"SkillProxy");var GameSystem;!function(t){t.skillProxy=SkillProxy.ins.bind(SkillProxy)}(GameSystem||(GameSystem={}));var SmeltProxy=function(t){function e(){var e=t.call(this)||this;return e.melt_count=0,e.melt_level=0,e.melt_exp=0,e.IsShowEff=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqMeltGetInfo=function(){var t=new net_protocol.C2SReqMeltGetInfo;this.sendPbPack(Msg.C2SReqMeltGetInfo,t,net_protocol.C2SReqMeltGetInfo)},e.prototype.C2SReqMeltMelt=function(t){var e=new net_protocol.C2SReqMeltMelt;e.slot_idx_list=[],e.slot_idx_list=t,this.sendPbPack(Msg.C2SReqMeltMelt,e,net_protocol.C2SReqMeltMelt)},e.prototype.S2CRepMeltGetInfo=function(t){var e=net_protocol.S2CRepMeltGetInfo.decode(t.bytes);this.melt_exp=e.melt_exp,this.melt_level=e.melt_level,this.melt_count=e.melt_count,EventProxy.Broast(EventType.S2CRepMeltGetInfo,{})},e.prototype.S2CRepMeltMelt=function(t){var e=net_protocol.S2CRepMeltMelt.decode(t.bytes);NoticeProxy.ins().ErrCode(e.err_code)&&(this.melt_exp=e.melt_exp,CopyProxy.ins().is_smelt_lyh&&(CopyProxy.ins().is_smelt_lyh=!1,CopyProxy.ins().C2SReqCopyEnterCopy(LyhProxy.ins().getCurData().copy_id)),EventProxy.Broast(EventType.S2CRepMeltMelt,{}))},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25450,this.S2CRepMeltGetInfo,this),MsgHandle.ins().regNetMsg(25451,this.S2CRepMeltMelt,this)},e}(BaseSystem);__reflect(SmeltProxy.prototype,"SmeltProxy");var SoulStoneProxy=function(t){function e(){var e=t.call(this)||this;return e.stoneinfoList=[],e.master_level=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqSoulstoneGetInfo=function(){var t=new net_protocol.C2SReqSoulstoneGetInfo;this.sendPbPack(Msg.C2SReqSoulstoneGetInfo,t,net_protocol.C2SReqSoulstoneGetInfo)},e.prototype.C2SReqSoulstoneOnekeyInlay=function(t){var e=new net_protocol.C2SReqSoulstoneOnekeyInlay;e.part=t,this.sendPbPack(Msg.C2SReqSoulstoneOnekeyInlay,e,net_protocol.C2SReqSoulstoneOnekeyInlay)},e.prototype.C2SReqSoulstoneUnInlay=function(t,e){var i=new net_protocol.C2SReqSoulstoneUnInlay;i.part=t,i.type=e,this.sendPbPack(Msg.C2SReqSoulstoneUnInlay,i,net_protocol.C2SReqSoulstoneUnInlay)},e.prototype.C2SReqSoulstoneCompose=function(t,e,i,n){var o=new net_protocol.C2SReqSoulstoneCompose;o.type=t,o.only_bag=e,o.part=i,o.item_id=n,this.sendPbPack(Msg.C2SReqSoulstoneCompose,o,net_protocol.C2SReqSoulstoneCompose)},e.prototype.C2SReqSoulstoneUpgradeMaster=function(){var t=new net_protocol.C2SReqSoulstoneUpgradeMaster;this.sendPbPack(Msg.C2SReqSoulstoneUpgradeMaster,t,net_protocol.C2SReqSoulstoneUpgradeMaster)},e.prototype.C2SReqSoulstoneInlay=function(t,e){var i=new net_protocol.C2SReqSoulstoneInlay;i.part=t,i.item_id=e,this.sendPbPack(Msg.C2SReqSoulstoneInlay,i,net_protocol.C2SReqSoulstoneInlay)},e.prototype.S2CRepSoulstoneGetInfo=function(t){for(var e=net_protocol.S2CRepSoulstoneGetInfo.decode(t.bytes),i=0;i<e.part_list.length;i++)if(void 0!=e.part_list[i].part){this.stoneinfoList[e.part_list[i].part]=[];for(var n=0;n<e.part_list[i].items.length;n++)void 0!=e.part_list[i].items[n].type&&(this.stoneinfoList[e.part_list[i].part][e.part_list[i].items[n].type]=e.part_list[i].items[n].item_id)}this.master_level=e.master_level,XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.S2CRepSoulstoneGetInfo,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepSoulstoneUpgradeMaster=function(t){var e=net_protocol.S2CRepSoulstoneUpgradeMaster.decode(t.bytes);this.master_level=e.master_level,EventProxy.Broast(EventType.S2CRepSoulstoneUpgradeMaster,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepSoulstoneInlay=function(t){var e=net_protocol.S2CRepSoulstoneInlay.decode(t.bytes);if(void 0!=e.info.part){this.stoneinfoList[e.info.part]=[];for(var i=0;i<e.info.items.length;i++)void 0!=e.info.items[i].type&&(this.stoneinfoList[e.info.part][e.info.items[i].type]=e.info.items[i].item_id)}XiuXianProxy.ins().updateAchieRed(AchieType.stone_level),XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.S2CRepSoulstoneInlay,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.getStoneByPartAndType=function(t,e){return void 0!=this.stoneinfoList[t]&&void 0!=this.stoneinfoList[t][e]?this.stoneinfoList[t][e]:0},e.prototype.getStoneLevelByPartAndType=function(t,e){var i=this.getStoneByPartAndType(t,e);return i>0&&void 0!=GlobalConfig.getSoulstone_dataConfig(i)?GlobalConfig.getSoulstone_dataConfig(i).stone_lv:0},e.prototype.getStoneLevelByPart=function(t){for(var e=0,i=GlobalConfig.getSoulstone_partConfig(t).stone_type,n=0;n<i.length;n++)e+=this.getStoneLevelByPartAndType(t,i[n]);return e},e.prototype.getTotalStoneLevel=function(){for(var t=0,e=1;10>=e;e++)t+=this.getStoneLevelByPart(e);return t},e.prototype.getCurPartTypeCanIn=function(t,e){if(5==e&&GlobalConfig.getSoulstone_misc_dataConfig(1).need_vip>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))return!1;var i=this.getStoneByPartAndType(t,e);return i>0?this.getBagStoneMaxLevelByType(e)>this.getStoneLevelByPartAndType(t,e):BagProxy.ins().getBagStoneListByType(e).length>0},e.prototype.getCurPartCanIn=function(t){for(var e=GlobalConfig.getSoulstone_partConfig(t).stone_type,i=0;i<e.length;i++)if(this.getCurPartTypeCanIn(t,e[i]))return!0;return!1},e.prototype.getCurInStoneCanUp=function(t,e){if(5==e&&GlobalConfig.getSoulstone_misc_dataConfig(1).need_vip>RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL))return!1;var i=this.getStoneByPartAndType(t,e);if(i>0){var n=GlobalConfig.getSoulstone_dataConfig(i);if(n&&n.upgrade_id>0&&BagProxy.ins().getItemCountById(i)>=n.need_value-1)return!0}return!1},e.prototype.getCurPartInStoneCanUp=function(t){for(var e=GlobalConfig.getSoulstone_partConfig(t).stone_type,i=0;i<e.length;i++)if(this.getCurInStoneCanUp(t,e[i]))return!0;return!1},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(2,1001,!0))return!1;for(var t=1;10>=t;t++){if(this.getCurPartCanIn(t))return!0;if(this.getCurPartInStoneCanUp(t))return!0}return this.getMasterRed()?!0:!1},e.prototype.getBagStoneMaxLevelByType=function(t){for(var e=BagProxy.ins().getBagStoneListByType(t),i=0,n=0;n<e.length;n++)e[n].item_type_id>0&&void 0!=GlobalConfig.getSoulstone_dataConfig(e[n].item_type_id)&&(i=Math.max(i,GlobalConfig.getSoulstone_dataConfig(e[n].item_type_id).stone_lv));return i},e.prototype.getMasterRed=function(){var t=GlobalConfig.getSoulstone_master_dataConfig(e.ins().master_level+1);if(void 0!=t){var i=e.ins().getTotalStoneLevel();if(i>=t.total_level)return!0}return!1},e.prototype.getMasterFight=function(){var t=e.ins().master_level,i=GlobalConfig.getSoulstone_master_dataConfig(t);return UtilProxy.GetAttrFight(i)},e.prototype.getCurPartSoulStoneFight=function(t){for(var e=GlobalConfig.getSoulstone_partConfig(t).stone_type,i=0,n=0;n<e.length;n++){var o=this.getStoneByPartAndType(t,e[n]);o>0&&(i+=UtilProxy.GetAttrFight(5==e[n]?this.getAddPerStoneItemPro(t,o):GlobalConfig.getSoulstone_dataConfig(o)))}return i},e.prototype.getAllFightValue=function(){for(var t=0,e=1;10>=e;e++)t+=this.getCurPartSoulStoneFight(e);return t+this.getMasterFight()},e.prototype.getAddPerStoneItemPro=function(t,e){var i=GlobalConfig.getSoulstone_partConfig(t).stone_type,n={};if(e>0){for(var o=0;o<i.length;o++)if(5!=i[o]){var s=this.getStoneByPartAndType(t,i[o]);s>0&&(n=RoleProxy.ins().getTableAdd(n,GlobalConfig.getSoulstone_dataConfig(s)))}var r=GlobalConfig.getSoulstone_dataConfig(e),a=r.attr_per/1e4-1;n=AttrProxy.getAttrAddInfo(n,100*a)}return n},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27700,this.S2CRepSoulstoneGetInfo,this),MsgHandle.ins().regNetMsg(27701,this.S2CRepSoulstoneUpgradeMaster,this),MsgHandle.ins().regNetMsg(27702,this.S2CRepSoulstoneInlay,this)},e.STONE_NAME=["30002","30022","30042","30062"],e}(BaseSystem);__reflect(SoulStoneProxy.prototype,"SoulStoneProxy");var StoreType;!function(t){t[t.coin=1]="coin",t[t.vip=2]="vip",t[t.mystery=3]="mystery",t[t.week=11]="week"}(StoreType||(StoreType={}));var StoreProxy=function(t){function e(){var e=t.call(this)||this;return e.recordsList=[],e.baokuCountList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqStoreGetInfo=function(t){var e=new net_protocol.C2SReqStoreGetInfo;e.store_id=t,CommonUtils.log("^^--^^!!^^..^^ C2SReqStoreGetInfo",t),this.sendPbPack(Msg.C2SReqStoreGetInfo,e,net_protocol.C2SReqStoreGetInfo)},e.prototype.C2SReqStoreRefresh=function(t){var e=new net_protocol.C2SReqStoreRefresh;e.store_id=t,this.sendPbPack(Msg.C2SReqStoreRefresh,e,net_protocol.C2SReqStoreRefresh)},e.prototype.C2SReqStoreBuy=function(t,e,i){var n=new net_protocol.C2SReqStoreBuy;n.store_id=t;var o=GlobalConfig.getStoreConfig(t),s=0;if(1!=o.time_type){if(s=this.getStoreId(t,e),0>s)return}else s=e;n.id=s,n.count=i,CommonUtils.log("-------------------------------C2SReqStoreBuy----------------->",n),this.sendPbPack(Msg.C2SReqStoreBuy,n,net_protocol.C2SReqStoreBuy)},e.prototype.getStoreId=function(t,e){for(var i=0;i<this.item_list.length;++i)if(this.item_list[i].store_id==t)for(var n=0;n<this.item_list[i].items.length;++n)if(this.item_list[i].items[n].item_id==e)return this.item_list[i].items[n].idx;return-1},e.prototype.getLimitCount=function(t,e){var i=GlobalConfig.getStoreConfig(t);if(i&&1==i.time_type){if(this.forever_buy_list)for(var n=0;n<this.forever_buy_list.length;++n)if(this.forever_buy_list[n].item_id==e)return this.forever_buy_list[n].times}else if(this.item_list)for(var n=0;n<this.item_list.length;++n)if(this.item_list[n].store_id==t)for(var o=0;o<this.item_list[n].items.length;++o)if(this.item_list[n].items[o].item_id==e)return this.item_list[n].items[o].buy_times;return 0},e.prototype.C2SReqStoreBuyRecord=function(t){var e=new net_protocol.C2SReqStoreBuyRecord;e.store_id=t,this.sendPbPack(Msg.C2SReqStoreBuyRecord,e,net_protocol.C2SReqStoreBuyRecord)},e.prototype.S2CRepStoreGetInfo=function(t){var e=net_protocol.S2CRepStoreGetInfo.decode(t.bytes);if(CommonUtils.log("^^--^^!!^^..^^ S2CRepStoreGetInfo",e),void 0==this.item_list)this.item_list=e.item_list;else for(var i=0;i<e.item_list.length;++i)for(var n=0;n<this.item_list.length;++n)e.item_list[i].store_id==this.item_list[n].store_id&&(this.item_list[n]=e.item_list[i]);for(var i=0;i<this.item_list.length;++i)this.isDayRefresh(this.item_list[i].store_id)&&(this.item_list[i].left_time=UtilProxy.leftTimeNextDay()),this.item_list[i].time=GameLogic.ins().getServerTime();if(void 0==this.limit_list)this.limit_list=e.limit_list;else for(var i=0;i<e.limit_list.length;++i)for(var n=0;n<this.limit_list.length;++n)this.limit_list[n]=e.limit_list[i];if(void 0==this.forever_buy_list)this.forever_buy_list=e.forever_buy_list;else for(var i=0;i<e.forever_buy_list.length;++i)for(var n=0;n<this.forever_buy_list.length;++n)this.forever_buy_list[n]=e.forever_buy_list[i];EventProxy.Broast(EventType.S2CRepStoreGetInfo,{}),EventProxy.Broast(EventType.RefreshStoreRed,[])},e.prototype.isDayRefresh=function(t){var e=GlobalConfig.getStoreConfig(t);return void 0==e?!1:3==e.time_type},e.prototype.S2CRepStoreRefresh=function(t){var e=net_protocol.S2CRepStoreRefresh.decode(t.bytes);if(CommonUtils.log("^^--^^!!^^..^^ S2CRepStoreRefresh",e),void 0!=this.item_list)for(var i=0;i<this.item_list.length;++i)this.item_list[i].store_id==e.store_id&&(this.item_list[i].refreshs=e.refreshs,this.item_list[i].items=e.items,this.isDayRefresh(e.store_id)?this.item_list[i].left_time=UtilProxy.leftTimeNextDay():this.item_list[i].left_time=e.left_time,this.item_list[i].time=GameLogic.ins().getServerTime());EventProxy.Broast(EventType.S2CRepStoreRefresh,{}),EventProxy.Broast(EventType.RefreshStoreRed,[])},e.prototype.getRefreshTimeById=function(t){var e=(GlobalConfig.getStoreConfig(t),0);if(void 0!=this.item_list)for(var i=0;i<this.item_list.length;++i)this.item_list[i].store_id==t&&(e=this.item_list[i].left_time+this.item_list[i].time-GameLogic.ins().getServerTime());return e},e.prototype.getRefreshTimesById=function(t){var e=GlobalConfig.getStoreConfig(t),i=0;if(void 0!=this.item_list)for(var n=0;n<this.item_list.length;++n)this.item_list[n].store_id==t&&(i=e.reset-this.item_list[n].refreshs);return i},e.prototype.isForeverStore=function(t){var e=GlobalConfig.getStoreConfig(t);return e?1==e.time_type:!1},e.prototype.S2CRepStoreBuy=function(t){var e=net_protocol.S2CRepStoreBuy.decode(t.bytes);if(CommonUtils.log("^^--^^!!^^..^^ S2CRepStoreBuy",e),this.isForeverStore(e.store_id)){void 0==this.forever_buy_list&&(this.forever_buy_list=[]);var i=!1;if(this.forever_buy_list)for(var n=0;n<this.forever_buy_list.length;++n)this.forever_buy_list[n].item_id==e.id&&(i=!0,this.forever_buy_list[n].times=e.buy_count);i||this.forever_buy_list.push({item_id:e.id,times:e.buy_count})}else if(void 0!=this.item_list)for(var n=0;n<this.item_list.length;++n)if(this.item_list[n].store_id==e.store_id)for(var o=0;o<this.item_list[n].items.length;++o)this.item_list[n].items[o].idx==e.id&&(this.item_list[n].items[o].buy_times=e.buy_count);TipsControl.ins().showTips("购买成功！"),EventProxy.Broast(EventType.S2CRepStoreBuy,[e.store_id,e.id])},e.prototype.S2CRepStoreLimitUpdate=function(t){var e=net_protocol.S2CRepStoreLimitUpdate.decode(t.bytes);CommonUtils.log("^^--^^!!^^..^^ S2CRepStoreLimitUpdate",e);for(var i=0;i<this.limit_list.length;++i)this.limit_list[i].item_id==e.item_id&&(this.limit_list[i].times=e.times);EventProxy.Broast(EventType.S2CRepStoreLimitUpdate,[e.item_id])},e.prototype.S2CRepStoreBuyRecord=function(t){var e=net_protocol.S2CRepStoreBuyRecord.decode(t.bytes);void 0==this.recordsList[e.store_id]&&(this.recordsList[e.store_id]=[]),this.recordsList[e.store_id]=e.records,EventProxy.Broast(EventType.S2CRepStoreBuyRecord,[])},e.prototype.S2CRepStoreOpen=function(t){net_protocol.S2CRepStoreOpen.decode(t.bytes)},e.prototype.C2SReqMiscAutoBuyItem=function(t,e){var i=new net_protocol.C2SReqMiscAutoBuyItem;i.item_id=t,i.item_count=e,this.sendPbPack(Msg.C2SReqMiscAutoBuyItem,i,net_protocol.C2SReqMiscAutoBuyItem)},e.prototype.C2SReqStoreGetBaokuInfo=function(){var t=new net_protocol.C2SReqStoreGetBaokuInfo;this.sendPbPack(Msg.C2SReqStoreGetBaokuInfo,t,net_protocol.C2SReqStoreGetBaokuInfo)},e.prototype.C2SReqStoreBaokuExchange=function(t,e){var i=new net_protocol.C2SReqStoreBaokuExchange;i.baoku_type=t,i.id=e,this.sendPbPack(Msg.C2SReqStoreBaokuExchange,i,net_protocol.C2SReqStoreBaokuExchange)},e.prototype.S2CRepStoreGetBaokuInfo=function(t){var e=net_protocol.S2CRepStoreGetBaokuInfo.decode(t.bytes);this.baokuCountList=[];for(var i=0;i<e.baoku_list.length;i++){this.baokuCountList[e.baoku_list[i].baoku_type]=[];for(var n=0;n<e.baoku_list[i].count_list.length;n++){var o=e.baoku_list[i].count_list[n].item_id;this.baokuCountList[e.baoku_list[i].baoku_type]["id"+o.toString()]=e.baoku_list[i].count_list[n].times}}EventProxy.Broast(EventType.S2CRepStoreGetBaokuInfo,[])},e.prototype.S2CRepStoreBaokuExchange=function(t){var e=net_protocol.S2CRepStoreBaokuExchange.decode(t.bytes);void 0==this.baokuCountList[e.baoku_type]&&(this.baokuCountList[e.baoku_type]=[]),this.baokuCountList[e.baoku_type]["id"+e.id.toString()]?this.baokuCountList[e.baoku_type]["id"+e.id.toString()]=this.baokuCountList[e.baoku_type]["id"+e.id.toString()]+1:this.baokuCountList[e.baoku_type]["id"+e.id.toString()]=1;var i=GlobalConfig.getBaoku_cell_dataConfig(e.id),n=[],o=new ItemCellData;o.setItemCellData({item_slot_idx:0,item_type_id:i.item_id,item_count:i.item_count}),n.push(o),n.length>0&&TipsControl.ins().showReward(n),EventProxy.Broast(EventType.S2CRepStoreBaokuExchange,[])},e.prototype.getBaokuUseTimes=function(t,e){return this.baokuCountList[t]?this.baokuCountList[t]["id"+e.toString()]||0:0},e.prototype.getbaokuEndTime=function(t){var e=GlobalConfig.getBaoku_dataConfig(t);if(!e)return 0;var i=new Date(1e3*GameLogic.ins().getServerTime()),n=UtilProxy.getStr("@0 /@1 /@2 ",[i.getFullYear(),i.getMonth()+1,i.getDate()]);if(e.open_srv_day>0&&LimitActProxy.ins().GetServerOpenDay()<=e.open_srv_day)return new Date(n).getTime()/1e3+24*(e.open_srv_day-LimitActProxy.ins().GetServerOpenDay()+1)*60*60;if(1==e.reset_type){var o=i.getDay(),s=0==o?7:o,r=0==e.reset_time?7:e.reset_time,a=0;return o==e.reset_time?a=7:s>r?a=r+7-s:r>s&&(a=r-s),new Date(n).getTime()/1e3+24*a*60*60}return 2==e.reset_type?new Date(n).getTime()/1e3+86400:0},e.prototype.getStoreRedByType=function(t){if(3>=t&&!SystemOpenProxy.ins().isOpen(1,24,!0))return!1;if(t>3&&!SystemOpenProxy.ins().isOpen(1,63,!0))return!1;if(t==StoreType.vip){if(!this.item_list)return!1;for(var i=0;i<this.item_list.length;++i)if(this.item_list[i].store_id==t)for(var n=0;n<this.item_list[i].items.length;++n){var o=this.item_list[i].items[n],s=GlobalConfig.getStore_cellConfig(o.item_id),r=o.buy_times;if(r<s.max_buy)return!0}}else if(this.isForeverStore(t)){var a=GlobalConfig.getConfig("store_cell","store_cellConfig");for(var h in a)if(a[h].shopType==t){var l=!0;if(a[h].max_buy>0){var r=e.ins().getLimitCount(Math.floor(a[h].id/1e3),a[h].id);r>=a[h].max_buy&&(l=!1)}if(l&&RoleProxy.ins().getMoneyAttr(a[h].type)>=a[h].price){var p=!0;if(a[h].need_items.length>0)for(var i=0;i<a[h].need_items.length;++i)BagProxy.ins().getItemData(a[h].need_items[i][0])<a[h].need_items[0][1]&&(p=!1);if(p)return!0}}}else if(this.item_list)for(var i=0;i<this.item_list.length;++i)if(this.item_list[i].store_id==t)for(var n=0;n<this.item_list[i].items.length;++n){var o=this.item_list[i].items[n],s=GlobalConfig.getStore_cellConfig(o.item_id),r=o.buy_times;if(r<s.max_buy&&RoleProxy.ins().getMoneyAttr(s.type)>=s.price){var p=!0;if(s.need_items.length>0)for(var c=0;c<s.need_items.length;++c)BagProxy.ins().getItemData(s.need_items[c][0])<s.need_items[c][1]&&(p=!1);if(p)return!0}}return!1},e.prototype.isEnoughStoreItem=function(t){var e=GlobalConfig.getStore_cellConfig(t);if(RoleProxy.ins().getMoneyAttr(e.type)>=e.price){var i=!0;if(e.need_items.length>0)for(var n=0;n<e.need_items.length;++n)BagProxy.ins().getItemData(e.need_items[n][0])<e.need_items[0][1]&&(i=!1);if(i)return!0}return!1},e.prototype.getBossPayIdList=function(){if(void 0==this._bossPayIdList){var t=GlobalConfig.getConfig("store_cell","store_cellConfig");this._bossPayIdList=[];var e={};for(var i in t)if(t[i].shopType>3&&(e[t[i].type]||(e[t[i].type]=t[i].type,this._bossPayIdList.push(t[i].type)),t[i].need_items.length>0))for(var n=0;n<t[i].need_items.length;++n)e[t[i].need_items[n][0]]||(e[t[i].need_items[n][0]]=t[i].need_items[n][0],this._bossPayIdList.push(t[i].need_items[n][0]))}return this._bossPayIdList},e.prototype.isStoreMaterialId=function(t){if(!this.payIdList){this.payIdList=[];var e=GlobalConfig.getConfig("store_cell","store_cellConfig"),i={};for(var n in e)if(i[e[n].type]||(i[e[n].type]=e[n].type,this.payIdList.push(e[n].type)),e[n].need_items.length>0)for(var o=0;o<e[n].need_items.length;++o)i[e[n].need_items[o][0]]||(i[e[n].need_items[o][0]]=e[n].need_items[o][0],this.payIdList.push(e[n].need_items[o][0]))}for(var o=0;o<this.payIdList.length;++o)if(t==this.payIdList[o])return!0;return!1},e.prototype.getBossStoreRed=function(){var t=GlobalConfig.getConfig("store","storeConfig");for(var e in t)if(2==t[e].pagetype&&this.getStoreRedByType(t[e].id))return!0;return!1},e.prototype.getNormalStoreRed=function(){var t=GlobalConfig.getConfig("store","storeConfig");for(var e in t)if(1==t[e].pagetype&&this.getStoreRedByType(t[e].id))return!0;return!1},e.prototype.getRed=function(){var t=GlobalConfig.getConfig("store","storeConfig");for(var e in t)if(this.getStoreRedByType(t[e].rate_type))return!0;return!1},e.prototype.getBaokuRed=function(){for(var t=1;4>=t;t++)if(this.getBaokuTypeRed(t))return!0;return!1},e.prototype.getBaokuTypeRed=function(t){var i=GlobalConfig.getBaoku_dataConfig(t);if(i&&i.open_srv_day>0&&LimitActProxy.ins().GetServerOpenDay()<=i.open_srv_day)for(var n=0;n<i.srv_list.length;n++){var o=GlobalConfig.getBaoku_cell_dataConfig(i.srv_list[n]),s=e.ins().getBaokuUseTimes(t,i.srv_list[n]);if(0==o.max_buy||s<o.max_buy){var r=BagProxy.ins().getItemCountById(o.need_items[0]);if(r>=o.need_items[1])return!0}}else if(i)for(var n=0;n<i.cell_list.length;n++){var o=GlobalConfig.getBaoku_cell_dataConfig(i.cell_list[n]),s=e.ins().getBaokuUseTimes(t,i.cell_list[n]);if(0==o.max_buy||s<o.max_buy){var r=BagProxy.ins().getItemCountById(o.need_items[0]);if(r>=o.need_items[1])return!0}}return!1},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25500,this.S2CRepStoreGetInfo,this),MsgHandle.ins().regNetMsg(25501,this.S2CRepStoreRefresh,this),MsgHandle.ins().regNetMsg(25502,this.S2CRepStoreBuy,this),MsgHandle.ins().regNetMsg(25503,this.S2CRepStoreLimitUpdate,this),MsgHandle.ins().regNetMsg(25504,this.S2CRepStoreBuyRecord,this),MsgHandle.ins().regNetMsg(25505,this.S2CRepStoreOpen,this),MsgHandle.ins().regNetMsg(25506,this.S2CRepStoreGetBaokuInfo,this),MsgHandle.ins().regNetMsg(25507,this.S2CRepStoreBaokuExchange,this)},e.prototype.getStoreCellByItemId=function(t,e){GlobalConfig.getConfig("store_cell","store_cellConfig");for(var i in GlobalConfig.ins().store_cellConfig){var n=GlobalConfig.ins().store_cellConfig[i];if(n.shopType==t&&n.item_id==e)return n}},e.prototype.getStoreConfigByStoreType=function(t){GlobalConfig.getConfig("store","storeConfig");var e=[];for(var i in GlobalConfig.ins().storeConfig)GlobalConfig.ins().storeConfig[i].pagetype==t&&e.push(GlobalConfig.ins().storeConfig[i]);return e},e.prototype.getStoreType=function(t){var e=GlobalConfig.getStoreConfig(t);return e?e.pagetype:0},e}(BaseSystem);__reflect(StoreProxy.prototype,"StoreProxy");var SystemOpenType;!function(t){t[t.ALL=0]="ALL",t[t.LEVEL=1]="LEVEL",t[t.ZHUAN=2]="ZHUAN",t[t.LYH=3]="LYH",t[t.LONGTIME=4]="LONGTIME",t[t.LEVLEORSERVERDAY=5]="LEVLEORSERVERDAY",t[t.ZHUANORSERVERDAY=6]="ZHUANORSERVERDAY",t[t.REWARDITEM=7]="REWARDITEM"}(SystemOpenType||(SystemOpenType={}));var M_View_Type;!function(t){t[t.Copy=6]="Copy",t[t.Boss=8]="Boss",t[t.Huoban=20]="Huoban",t[t.Treasure=41]="Treasure",t[t.VIPBoss=605]="VIPBoss"}(M_View_Type||(M_View_Type={}));var SystemOpenProxy=function(t){function e(){var e=t.call(this)||this;return e.opening_list=[],e.open_push=[],e.cur_open_item_list=[],e.isInit=!1,e.isGetInfo=!1,e._isTimer=!1,e}return __extends(e,t),e.prototype.getTimerState=function(){return this._isTimer},e.prototype.setTimerState=function(t){this._isTimer!=t&&(this._isTimer=t)},e.prototype.isSystemOpenMaterial=function(t){if(!this.material_list){this.material_list=[];var e=GlobalConfig.getSystemopenConfig();for(var i in e)for(var n in e){var o=e[n];for(var s in o){var r=o[s];if(r.open_type==SystemOpenType.REWARDITEM)for(var a=0;a<r.open_params[0].length;++a)this.material_list.push(r.open_params[0][a])}}}for(var a=0;a<this.material_list.length;++a)if(this.material_list[a]==t)return!0;return!1},e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25550,this.S2CRepSystemopenGetInfo,this),MsgHandle.ins().regNetMsg(25551,this.S2CRepSystemopenOpen,this)},e.prototype.C2SReqSystemopenGetInfo=function(){var t=new net_protocol.C2SReqSystemopenGetInfo;CommonUtils.log("------------------------------------^^--^^!!^^..^^ C2SReqSystemopenGetInfo"),this.sendPbPack(Msg.C2SReqSystemopenGetInfo,t,net_protocol.C2SReqSystemopenGetInfo)},e.prototype.C2SReqSystemopenOpen=function(t,e){var i=new net_protocol.C2SReqSystemopenOpen,n=GlobalConfig.getSystemopenConfigById(t,e);if(n&&n.open_type==SystemOpenType.LEVEL){var o={id:t,sub_id:e};return void this.S2CRepSystemopenOpenEx(o)}i.id=t,i.sub_id=e,CommonUtils.log("----------------------------------------^^--^^!!^^..^^ C2SReqSystemopenOpen",i),this.sendPbPack(Msg.C2SReqSystemopenOpen,i,net_protocol.C2SReqSystemopenOpen)},e.prototype.S2CRepSystemopenGetInfo=function(t){var e=net_protocol.S2CRepSystemopenGetInfo.decode(t.bytes);CommonUtils.log("-------------------------------------------------^^--^^!!^^..^^ S2CRepSystemopenGetInfo",e),this.open_item_list=e.open_item;for(var i=0;i<e.open_item.length;++i)2==e.open_item[i].id&&2001==e.open_item[i].sub_id?HuobanProxy.ins().InitShow():2==e.open_item[i].id&&2002==e.open_item[i].sub_id&&PetProxy.ins().InitShow();
this.initCheckSystemOpen(),this.isGetInfo=!0,EventProxy.Broast(EventType.S2CRepSystemopenGetInfo,[]),this.isInit||TimerManager.ins().doTimer(1e4,0,this.timeUp,this),this.isInit=!0,this.checkSystemOpen(SystemOpenType.ALL)},e.prototype.initCheckSystemOpen=function(){var t=GlobalConfig.getSystemopenConfig();for(var e in t){var i=t[e];for(var n in i){var o=i[n];if(o.open_type==SystemOpenType.LEVEL&&o.open_params[0]<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)&&o.srv_open_day<=LimitActProxy.ins().GetServerOpenDay()){var s={id:o.id,sub_id:o.sub_id};this.open_item_list||(this.open_item_list=[]),this.open_item_list.push(s)}}}},e.prototype.S2CRepSystemopenOpen=function(t){var e=net_protocol.S2CRepSystemopenOpen.decode(t.bytes);CommonUtils.log("---------------------------------------------------^^--^^!!^^..^^ S2CRepSystemopenOpen",e),this.S2CRepSystemopenOpenEx(e)},e.prototype.S2CRepSystemopenOpenEx=function(t){var e={};e.id=t.id,e.sub_id=t.sub_id,void 0==this.open_item_list&&(this.open_item_list=[]),this.open_item_list.push(e),this.cur_open_item_list.push(e);var i=GlobalConfig.getSystemopenConfigById(e.id,e.sub_id);if(void 0!=i&&1==i.is_show){var n=GameLogic.ins().getCurSceneData();n&&2!=n.scene_type&&3!=n.scene_type&&4!=n.scene_type?ViewManager.ins().isShow(SystemOpenView)?(this.opening_list.push(e),this.getTimerState()||(TimerManager.ins().doTimer(200,0,this.checkOpening,this),this.setTimerState(!0))):ViewManager.ins().open(SystemOpenView,void 0,[e.id,e.sub_id]):this.opening_list.push(e)}2==t.id&&2001==t.sub_id?(HuobanProxy.ins().InitShow(),EventProxy.Broast(EventType.RefreshHuoBanRed,[])):2==t.id&&2002==t.sub_id&&(PetProxy.ins().InitShow(),EventProxy.Broast(EventType.RefreshHuoBanRed,[])),EventProxy.Broast(EventType.S2CRepSystemopenOpen,[t.id,t.sub_id])},e.prototype.DoOpening=function(){this.opening_list.length>0&&(this.getTimerState()||(TimerManager.ins().doTimer(200,0,this.checkOpening,this),this.setTimerState(!0)))},e.prototype.checkOpening=function(){if(this.opening_list.length>0){if(!ViewManager.ins().isShow(SystemOpenView)){var t=this.opening_list[0];ViewManager.ins().open(SystemOpenView,void 0,[t.id,t.sub_id]),this.opening_list.splice(0,1)}}else this.setTimerState(!1),TimerManager.ins().remove(this.checkOpening,this)},e.prototype.checkSystemOpen=function(t){if(this.isInit){var e=GlobalConfig.getSystemopenConfig(),i=[];for(var n in e){var o=e[n];for(var s in o){var r=o[s];if((0==t||r.open_type==t)&&!this.isOpenItem(r.id,r.sub_id)&&0==r.default_open)if(1==r.open_type)(0==t||1==t)&&r.open_params[0]<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)&&r.srv_open_day<=LimitActProxy.ins().GetServerOpenDay()&&i.push(r);else if(2==r.open_type)(0==t||2==t)&&r.open_params[0]<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)&&r.srv_open_day<=LimitActProxy.ins().GetServerOpenDay()&&i.push(r);else if(3==r.open_type)(0==t||3==t)&&r.open_params[0]<=LyhProxy.ins().getCurId()&&r.srv_open_day<=LimitActProxy.ins().GetServerOpenDay()&&i.push(r);else if(4==r.open_type){if(0==t||4==t){var a=RoleProxy.ins().getCreateTime();r.open_params[0]<=GameLogic.ins().getServerTime()-a&&i.push(r)}}else if(5==r.open_type){if(0==t||5==t){var h=r.open_params[1];(r.open_params[0]<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)||h&&h<=LimitActProxy.ins().GetServerOpenDay())&&i.push(r)}}else if(6==r.open_type){if(0==t||6==t){var h=r.open_params[1];(r.open_params[0]<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)||h&&h<=LimitActProxy.ins().GetServerOpenDay())&&i.push(r)}}else if(7==r.open_type&&(0==t||7==t)&&r.srv_open_day<=LimitActProxy.ins().GetServerOpenDay()){var l=r.open_params[0],h=r.open_params[1];if(h<=LimitActProxy.ins().GetServerOpenDay())i.push(r);else for(var p=0;p<l.length;++p)if(BagProxy.ins().getItemCountById(l[p])>0){i.push(r);break}}}}if(i.length>0){TimerManager.ins().remove(this.updateOpenPush,this);for(var p=0;p<i.length;++p)this.open_push.push(i[p]);TimerManager.ins().doTimer(300,0,this.updateOpenPush,this)}}},e.prototype.updateOpenPush=function(){if(this.open_push.length>0){var t=this.open_push.splice(0,1)[0];this.C2SReqSystemopenOpen(t.id,t.sub_id)}else TimerManager.ins().remove(this.updateOpenPush,this)},e.prototype.timeUp=function(){this.checkSystemOpen(SystemOpenType.LONGTIME)},e.prototype.isOpenItem=function(t,e){if(void 0==this.open_item_list)return!1;for(var i=0;i<this.open_item_list.length;++i)if(t==this.open_item_list[i].id&&e==this.open_item_list[i].sub_id)return!0;return!1},e.prototype.isCurOpenItem=function(t,e){if(void 0==this.cur_open_item_list)return!1;for(var i=0;i<this.cur_open_item_list.length;++i)if(t==this.cur_open_item_list[i].id&&e==this.cur_open_item_list[i].sub_id)return!0;return!1},e.prototype.removeCurOpenItem=function(t,e){if(void 0!=this.cur_open_item_list)for(var i=0;i<this.cur_open_item_list.length;++i)t==this.cur_open_item_list[i].id&&e==this.cur_open_item_list[i].sub_id&&this.cur_open_item_list.splice(i,1)},e.prototype.isOpen=function(t,e,i){if(void 0===i&&(i=!1),!this.isOpenItem(t,e)){var n=GlobalConfig.getSystemopenConfigById(t,e);if(void 0==n)return!0;if(1==n.default_open)return!0;if(!i){var o=n.open_type,s=n.open_params,r=n.srv_open_day,a=n.name,h=LimitActProxy.ins().GetServerOpenDay();if(r>h)TipsControl.ins().showTips("还需"+(r-h)+"天开启"+a+"！");else switch(o){case 1:case 5:s[0]>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)?TipsControl.ins().showTips("不足"+s[0]+"级,未能开启"+a+"！"):s[1]&&h<s[1]&&TipsControl.ins().showTips("还需"+(s[1]-h)+"天开启"+a+"！");break;case 2:case 6:if(s[0]>RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN)){var l=GlobalConfig.getZhuanById(s[0]),p="";p=l.zhuan>0?l.zhuan+"转"+l.lv+"重":l.zhuan+"转",TipsControl.ins().showTips("不足"+p+",未能开启"+a+"！")}else s[1]&&h<s[1]&&TipsControl.ins().showTips("还需"+(s[1]-h)+"天开启"+a+"！");break;case 3:s[0]>LyhProxy.ins().getCurId()&&TipsControl.ins().showTips("尚未通关炼妖壶"+s[0]+"层,未能开启"+a+"！");break;case 4:var c=RoleProxy.ins().getCreateTime();s[0]>GameLogic.ins().getServerTime()-c&&TipsControl.ins().showTips("在线时间不足,未能开启"+a+"！");break;case 7:var u=(s[0],s[1]);u>h&&TipsControl.ins().showTips("还需"+(u-h)+"天开启"+a+"！")}}}return this.isOpenItem(t,e)},e}(BaseSystem);__reflect(SystemOpenProxy.prototype,"SystemOpenProxy");var TaoZhuangProxy=function(t){function e(){var e=t.call(this)||this;return e.tz_list=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGrowupGetTaozhuangInfo=function(){var t=new net_protocol.C2SReqGrowupGetTaozhuangInfo;this.sendPbPack(Msg.C2SReqGrowupGetTaozhuangInfo,t,net_protocol.C2SReqGrowupGetTaozhuangInfo)},e.prototype.C2SReqGrowupActiveTaozhuang=function(t,e){var i=new net_protocol.C2SReqGrowupActiveTaozhuang;i.id=t,i.num=e,this.sendPbPack(Msg.C2SReqGrowupActiveTaozhuang,i,net_protocol.C2SReqGrowupActiveTaozhuang)},e.prototype.S2CRepGrowupGetTaozhuangInfo=function(t){var e=net_protocol.S2CRepGrowupGetTaozhuangInfo.decode(t.bytes);this.tz_list=[];for(var i=0;i<e.list.length;i++){var n=e.list[i];this.tz_list[n.id]=n}EventProxy.Broast(EventType.S2CRepGrowupGetTaozhuangInfo,{}),EventProxy.Broast(EventType.UpdateTaozhuangRed,{})},e.prototype.S2CRepGrowupUpdateTaozhuang=function(t){var e=net_protocol.S2CRepGrowupUpdateTaozhuang.decode(t.bytes);this.tz_list[e.info.id]=e.info,EventProxy.Broast(EventType.S2CRepGrowupUpdateTaozhuang,{})},e.prototype.getActiveNum=function(t){var e=GlobalConfig.getTzById(t);if(!e)return 0;for(var i=0,n=0;n<e.show_list.length;n++){var o=e.show_list[n];this.isEquipActive(o[0],o[1])&&(i+=1)}return i},e.prototype.isEquipActive=function(t,e){var i=!1;switch(t){case 1:i=HorseProxy.ins().isHuanxingActive(e);break;case 2:i=void 0!=GrowupProxy.ins().getFashion(e);break;case 3:i=WeaponProxy.ins().getLv2(WeaponType.Weapon,e)>0;break;case 4:i=WeaponProxy.ins().getLv2(WeaponType.Wing,e)>0}return i},e.prototype.isTzActive=function(t,e){var i=this.tz_list[t];if(i&&i.active_list.length>0)for(var n=0;n<i.active_list.length;n++)if(i.active_list[n]==e)return!0;return!1},e.prototype.getFightNum=function(){var t=0;for(var e in this.tz_list)for(var i=this.tz_list[e],n=0;n<i.active_list.length;n++){var o=GlobalConfig.getTzAttrById(i.id,i.active_list[n]);t+=UtilProxy.GetAttrFight(o)}return t},e.prototype.getRedByIdAnNum=function(t,e){var i=GlobalConfig.getTzAttrById(t,e);return i&&this.getActiveNum(t)>=e&&!this.isTzActive(t,e)?!0:!1},e.prototype.getRedById=function(t){var e=GlobalConfig.getTzAttrList(t);for(var i in e){var n=e[i];if(this.getRedByIdAnNum(n.id,n.num))return!0}return!1},e.prototype.getRed=function(){var t=GlobalConfig.getTzList();for(var e in t){var i=t[e];if(this.getRedById(i.id))return!0}return!1},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27609,this.S2CRepGrowupGetTaozhuangInfo,this),MsgHandle.ins().regNetMsg(27610,this.S2CRepGrowupUpdateTaozhuang,this)},e}(BaseSystem);__reflect(TaoZhuangProxy.prototype,"TaoZhuangProxy");var DoTaskType;!function(t){t[t.emXLLV=1]="emXLLV",t[t.emXLUP=2]="emXLUP",t[t.emCopy=3]="emCopy",t[t.emScene=4]="emScene",t[t.emDress=5]="emDress",t[t.emUpStar=6]="emUpStar",t[t.emUpStarCount=7]="emUpStarCount",t[t.emLBCount=8]="emLBCount",t[t.emFacFightCount=9]="emFacFightCount",t[t.emFacFightScore=10]="emFacFightScore",t[t.emXunbao=11]="emXunbao",t[t.emSBActive=12]="emSBActive",t[t.emZuoqi=13]="emZuoqi",t[t.emZuoqiUp=14]="emZuoqiUp",t[t.emUpgrade=15]="emUpgrade",t[t.emUpgradeCount=16]="emUpgradeCount",t[t.emInJianxin=17]="emInJianxin",t[t.emJoinFac=18]="emJoinFac",t[t.emJuqing=19]="emJuqing",t[t.emKillBoss=20]="emKillBoss",t[t.emKillMonster=21]="emKillMonster",t[t.emSwLv=22]="emSwLv",t[t.emLV=23]="emLV",t[t.emZhuan=24]="emZhuan",t[t.emSkillLV=25]="emSkillLV",t[t.emSkillCount=26]="emSkillCount",t[t.emStoneCount=27]="emStoneCount",t[t.emStoneLv=28]="emStoneLv",t[t.emBook=29]="emBook",t[t.emJmLv=30]="emJmLv",t[t.emWingLv=31]="emWingLv",t[t.emWingCount=32]="emWingCount",t[t.emXiuwei=33]="emXiuwei",t[t.emXiuxianLv=34]="emXiuxianLv",t[t.emZhuanCount=35]="emZhuanCount",t[t.emLYH=36]="emLYH",t[t.emFB=37]="emFB",t[t.emPTFB=38]="emPTFB",t[t.emYeiZhan=39]="emYeiZhan",t[t.emLSLv=40]="emLSLv",t[t.emLSUp=41]="emLSUp",t[t.emSDH=42]="emSDH",t[t.emTZSJ=49]="emTZSJ"}(DoTaskType||(DoTaskType={}));var TaskItem=function(){function t(){this.idx=0,this.is_completed=-1,this.param_list=[]}return t}();__reflect(TaskItem.prototype,"TaskItem");var AwardItem=function(){function t(){}return t}();__reflect(AwardItem.prototype,"AwardItem");var TaskProxy=function(t){function e(){var e=t.call(this)||this;return e.taskMain=new TaskItem,e.curTaskType=0,e.task_recorder_list=[],e.curtime=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.KillChange=function(t){if(void 0!=t&&0!=t&&this.curTaskType==DoTaskType.emKillMonster){var e=GlobalConfig.getTaskConfig(this.taskMain.task_id);void 0!=e&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=e.level&&((void 0==this.taskMain.param_list||void 0==this.taskMain.param_list[0])&&(this.taskMain.param_list[0]=0),this.taskMain.param_list[0]=this.taskMain.param_list[0]+1,this.taskMain.param_list[0]=Math.min(this.taskMain.param_list[0],e._params[0]),this.taskMain.param_list[0]==e._params[0]&&(1!=this.taskMain.is_completed&&EventProxy.Broast(EventType.TaskIsCompleted,{}),this.taskMain.is_completed=1),GuideProxy.ins().CheckGuideCache(3,this.taskMain.task_id),EventProxy.Broast(EventType.UpdataTask,{}))}},e.prototype.DoTask=function(){if(void 0!=this.taskMain&&void 0!=this.taskMain.task_id){var t=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());this.curTaskType==DoTaskType.emKillMonster&&1==t.scene_type&&1==t.is_main?LyhProxy.ins().goToCurScene():this.curTaskType==DoTaskType.emKillMonster&&TipsControl.ins().showTips("打怪数量不足");var e=GlobalConfig.getTaskConfig(this.taskMain.task_id);e&&e.openview[0]&&UtilProxy.openView(e.openview[0],e.openview[1])}},e.prototype.S2CRepTaskListInfo=function(t){if(this.taskMain=new TaskItem,CommonUtils.log("---------------S2CRepTaskListInfo--------------",t),t.task_list.length>0)for(var e=0;e<t.task_list.length;e++)this.taskMain.task_id=t.task_list[e].task_id,this.taskMain.idx=t.task_list[e].idx,this.taskMain.is_completed=t.task_list[e].is_completed,this.taskMain.param_list=t.task_list[e].param_list;(void 0==this.taskMain||void 0==this.taskMain.task_id)&&(this.taskMain.task_id=1,this.AcceptTask(this.taskMain.task_id)),GuideProxy.ins().CheckGuideCache(1,this.taskMain.task_id),this.taskMain&&1==this.taskMain.is_completed&&GuideProxy.ins().CheckGuideCache(3,this.taskMain.task_id),this.curTaskType=GlobalConfig.getTaskConfig(this.taskMain.task_id).unit_type,EventProxy.Broast(EventType.UpdataTask,{})},e.prototype.S2CRepTaskInfo=function(t){this.taskMain&&1!=this.taskMain.is_completed&&1==t.is_completed&&EventProxy.Broast(EventType.TaskIsCompleted,{}),this.taskMain=new TaskItem,this.taskMain.task_id=t.task_id,this.taskMain.idx=t.idx,this.taskMain.is_completed=t.is_completed,this.taskMain.param_list=t.param_list,this.curTaskType=GlobalConfig.getTaskConfig(this.taskMain.task_id).unit_type,EventProxy.Broast(EventType.UpdataTask,{})},e.prototype.S2CRepTaskRecorderListInfo=function(t){for(var e=0,i=0;i<t.task_recorder_list.length;i++)this.task_recorder_list[t.task_recorder_list[i]]=t.task_recorder_list[i],e=Math.max(e,t.task_recorder_list[i]);if(void 0==this.taskMain||void 0==this.taskMain.task_id||-1==this.taskMain.is_completed||e==this.taskMain.task_id){if(this.taskMain=new TaskItem,0==e)this.taskMain.task_id=1;else{var n=GlobalConfig.getTaskConfig(e).after_id;void 0!=n&&n>0&&(this.taskMain.task_id=n),void 0!=this.taskMain.task_id&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=GlobalConfig.getTaskConfig(this.taskMain.task_id).level&&this.AcceptTask(this.taskMain.task_id)}void 0!=this.taskMain.task_id&&(this.curTaskType=GlobalConfig.getTaskConfig(this.taskMain.task_id).unit_type)}EventProxy.Broast(EventType.UpdataTask,{})},e.prototype.S2CRepTaskRecorderInfo=function(t){this.task_recorder_list[t.task_id]=t.task_id,this.taskMain=new TaskItem;var e=GlobalConfig.getTaskConfig(t.task_id).after_id;void 0!=e&&e>0&&(this.taskMain.task_id=e),void 0!=this.taskMain.task_id&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=GlobalConfig.getTaskConfig(this.taskMain.task_id).level&&this.AcceptTask(this.taskMain.task_id),void 0!=this.taskMain.task_id&&(this.curTaskType=GlobalConfig.getTaskConfig(this.taskMain.task_id).unit_type),CommonUtils.log("------------------S2CRepTaskRecorderInfo---------S2CRepTaskRecorderInfoS2CRepTaskRecorderInfo---------",t),GuideProxy.ins().CheckGuideCache(1,this.taskMain.task_id),EventProxy.Broast(EventType.S2CRepTaskRecorderInfo,{}),EventProxy.Broast(EventType.UpdataTask,{})},e.prototype.CommitTask=function(t){if(!(0!=this.curtime&&GameLogic.ins().getServerTime()-this.curtime<GlobalConfig.getTaskConfig(t).task_coldtime)){var e=new net_protocol.C2SReqTaskCommitTask;e.task_id=t,this.sendPbPack(Msg.C2S_COMMITTASK,e,net_protocol.C2SReqTaskCommitTask),this.curtime=GameLogic.ins().getServerTime()}},e.prototype.C2SReqTaskStartKillMonster=function(t,e){var i=new net_protocol.C2SReqTaskStartKillMonster;i.scene_id=t,i.index=e,this.sendPbPack(Msg.C2SReqTaskStartKillMonster,i,net_protocol.C2SReqTaskStartKillMonster)},e.prototype.C2SReqTaskEndKillMonster=function(t,e){var i=new net_protocol.C2SReqTaskEndKillMonster;i.scene_id=t,i.index=e,this.sendPbPack(Msg.C2SReqTaskEndKillMonster,i,net_protocol.C2SReqTaskEndKillMonster)},e.prototype.S2CRepTaskStartKillMonster=function(t){var e=[];e[0]=t,EventProxy.Broast(EventType.UpdateMonsterReward,e)},e.prototype.AcceptTask=function(t){var e=new net_protocol.C2SReqTaskAcceptTask;e.task_id=t,this.sendPbPack(Msg.C2S_ACCEPTTASK,e,net_protocol.C2SReqTaskAcceptTask)},e.prototype.CheckAcceptTask=function(){-1==this.taskMain.is_completed&&void 0!=this.taskMain.task_id&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=GlobalConfig.getTaskConfig(this.taskMain.task_id).level&&this.AcceptTask(this.taskMain.task_id)},e.prototype.GetTaskList=function(){var t=new net_protocol.C2SReqTaskList;this.sendPbPack(Msg.C2S_REQTASKLIST,t,net_protocol.C2SReqTaskList)},e.prototype.onTaskMain=function(){return void 0!=this.taskMain&&void 0!=this.taskMain.task_id?-1==this.taskMain.is_completed&&RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)>=GlobalConfig.getTaskConfig(this.taskMain.task_id).level?void this.AcceptTask(this.taskMain.task_id):1==this.taskMain.is_completed?void this.CommitTask(this.taskMain.task_id):void this.DoTask():void 0},e.prototype.GetTaskDesc=function(){if(void 0==this.taskMain||void 0==this.taskMain.task_id)return"";var t="",e=GlobalConfig.getTaskConfig(this.taskMain.task_id),i=0,n=1;switch(void 0!=this.taskMain.param_list&&void 0!=this.taskMain.param_list[0]&&(i=this.taskMain.param_list[0]),e._params[0]&&(n=e._params[0]),(e.unit_type==DoTaskType.emFB||e.unit_type==DoTaskType.emScene||e.unit_type==DoTaskType.emJoinFac||e.unit_type==DoTaskType.emJuqing||e.unit_type==DoTaskType.emFB||e.unit_type==DoTaskType.emPTFB)&&(n=1),e.unit_type){case DoTaskType.emXLLV:i=HuobanProxy.ins().getGrade();break;case DoTaskType.emDress:i=BagProxy.ins().getEquipCountByQ(e._params[1],e._params[2]||0,e._params[3]||0);break;case DoTaskType.emUpStar:i=UpStarProxy.ins().getUpStarLevelCount(e._params[0]),n=10;break;case DoTaskType.emFacFightScore:i=LunjianProxy.ins().getscore();break;case DoTaskType.emZuoqi:i=HorseProxy.ins().getGrade();break;case DoTaskType.emUpgrade:i=UpgradeProxy.ins().getMinUpgradeLevel();break;case DoTaskType.emSwLv:i=TitleProxy.ins().GetCurrentLevel();break;case DoTaskType.emLV:i=RoleProxy.ins().getRoleLv();break;case DoTaskType.emZhuan:i=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);break;case DoTaskType.emSkillLV:i=SkillProxy.ins().getSkillLvSum();break;case DoTaskType.emStoneLv:i=SoulStoneProxy.ins().getTotalStoneLevel();break;case DoTaskType.emBook:i=GrowupProxy.ins().getTujianActiveCountByType(e._params[1]),n=e._params[0];break;case DoTaskType.emJmLv:i=GrowupProxy.ins().getMaxVenLv();break;case DoTaskType.emWingLv:i=WeaponProxy.ins().getWingMaxLv();break;case DoTaskType.emXiuwei:i=XiuXianProxy.ins().achie_value;break;case DoTaskType.emXiuxianLv:i=XiuXianProxy.ins().achie_level;break;case DoTaskType.emLYH:i=LyhProxy.ins().getCurId();break;case DoTaskType.emLSLv:i=PetProxy.ins().getGrade();break;case DoTaskType.emLBCount:i=FabaoProxy.ins().getActiveNumByColor(e._params[1]);break;case DoTaskType.emSDH:i=ShenXianProxy.ins().rank_index;break;case DoTaskType.emTZSJ:ZbTaoZhuangProxy.ins().getHaveBeforeById(e._params[0]),n=e._params[1]}return i=e.unit_type==DoTaskType.emSDH?i:Math.min(i,n),1==this.taskMain.is_completed&&e.unit_type!=DoTaskType.emSDH&&(i=n),t=UtilProxy.getStr("@0 |C:@1 &(@2 /@3 )|",[e.desc,e.unit_type==DoTaskType.emSDH?0!=i&&n>=i?7:4:i>=n?7:4,i,n])},e.prototype.IsTaskInRecorder=function(t){return 0==t?!0:void 0!=this.task_recorder_list[t]?!0:!1},e}(BaseSystem);__reflect(TaskProxy.prototype,"TaskProxy");var MemberItemData=function(){function t(){}return t}();__reflect(MemberItemData.prototype,"MemberItemData");var TeamViewType;!function(t){t[t.info=0]="info",t[t.my=1]="my",t[t.team=2]="team",t[t.invite=3]="invite"}(TeamViewType||(TeamViewType={}));var TeamProxy=function(t){function e(){var e=t.call(this)||this;return e.applyList=[],e.inviteList=[],e.auto_accept=!0,e.auto_reply=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqTeamGetInfo=function(){var t=new net_protocol.C2SReqTeamGetInfo;CommonUtils.log("^^***^^  C2SReqTeamGetInfo",t),this.sendPbPack(Msg.C2SReqTeamGetInfo,t,net_protocol.C2SReqTeamGetInfo)},e.prototype.C2SReqTeamCreate=function(t,e){void 0===t&&(t=1e4),void 0===e&&(e=2);var i=new net_protocol.C2SReqTeamCreate;i.target_id=t,i.type=e,CommonUtils.log("^^***^^  C2SReqTeamCreate",i),this.sendPbPack(Msg.C2SReqTeamCreate,i,net_protocol.C2SReqTeamCreate)},e.prototype.C2SReqTeamLeave=function(t){void 0===t&&(t=1);var e=new net_protocol.C2SReqTeamLeave;e.type=t,CommonUtils.log("^^***^^  C2SReqTeamLeave",e),this.sendPbPack(Msg.C2SReqTeamLeave,e,net_protocol.C2SReqTeamLeave)},e.prototype.C2SReqTeamPromote=function(t){var e=new net_protocol.C2SReqTeamPromote;e.role_id=t,CommonUtils.log("^^***^^  C2SReqTeamPromote",e),this.sendPbPack(Msg.C2SReqTeamPromote,e,net_protocol.C2SReqTeamPromote)},e.prototype.C2SReqTeamRemove=function(t){var e=new net_protocol.C2SReqTeamRemove;e.role_id=t,CommonUtils.log("^^***^^  C2SReqTeamRemove",e),this.sendPbPack(Msg.C2SReqTeamRemove,e,net_protocol.C2SReqTeamRemove)},e.prototype.C2SReqTeamAutoAccept=function(t){var e=new net_protocol.C2SReqTeamAutoAccept;e.accept_state=t,CommonUtils.log("^^***^^  C2SReqTeamAutoAccept",e),this.sendPbPack(Msg.C2SReqTeamAutoAccept,e,net_protocol.C2SReqTeamAutoAccept)},e.prototype.C2SReqTeamReplyApply=function(t,e){var i=new net_protocol.C2SReqTeamReplyApply;i.role_id=t,i.reply_state=e;for(var n=0;n<this.applyList.length;++n)this.applyList[n].role_id==t&&this.applyList.splice(n,1);this.CheckApplyInviteList(),CommonUtils.log("^^***^^  C2SReqTeamReplyApply",i),this.sendPbPack(Msg.C2SReqTeamReplyApply,i,net_protocol.C2SReqTeamReplyApply)},e.prototype.C2SReqTeamInvite=function(t,e){void 0===e&&(e=0);var i=new net_protocol.C2SReqTeamInvite;i.role_id=t,i.type=e,CommonUtils.log("^^***^^  C2SReqTeamInvite",i),this.sendPbPack(Msg.C2SReqTeamInvite,i,net_protocol.C2SReqTeamInvite)},e.prototype.C2SReqTeamApply=function(t){var e=new net_protocol.C2SReqTeamApply;e.role_id=t,CommonUtils.log("^^***^^  C2SReqTeamApply",e),this.sendPbPack(Msg.C2SReqTeamApply,e,net_protocol.C2SReqTeamApply)},e.prototype.C2SReqTeamReplyInvite=function(t,e,i){void 0===i&&(i=1);var n=new net_protocol.C2SReqTeamReplyInvite;n.role_id=t,n.type=i,n.invite_state=e;for(var o=0;o<this.inviteList.length;++o)this.inviteList[o].captain_id==t&&this.inviteList.splice(o,1);this.CheckApplyInviteList(),CommonUtils.log("^^***^^  C2SReqTeamReplyInvite",n),this.sendPbPack(Msg.C2SReqTeamReplyInvite,n,net_protocol.C2SReqTeamReplyInvite)},e.prototype.C2SReqTeamGetSceneTeam=function(){var t=new net_protocol.C2SReqTeamGetSceneTeam;CommonUtils.log("^^***^^  C2SReqTeamGetSceneTeam",t),this.sendPbPack(Msg.C2SReqTeamGetSceneTeam,t,net_protocol.C2SReqTeamGetSceneTeam)},e.prototype.S2CRepTeamGetInfo=function(t){var e=net_protocol.S2CRepTeamGetInfo.decode(t.bytes);CommonUtils.log("-->>>>>>>>>>>-----S2CRepTeamGetInfo------",e),this.team_info=e.team_info,void 0==e.team_info||void 0==e.team_info.team_id||0==e.team_info.team_id?this.applyList=[]:(this.auto_accept=1==this.team_info.auto_accept,this.inviteList=[],ViewManager.ins().isShow(TeamListView)&&ViewManager.ins().close(TeamListView),ViewManager.ins().isShow(TeamInfoView)&&(ViewManager.ins().close(TeamInfoView),ViewManager.ins().open(MyTeamView))),EventProxy.Broast(EventType.S2CRepTeamGetInfo,[])},e.prototype.S2CRepTeamCreate=function(t){var e=net_protocol.S2CRepTeamCreate.decode(t.bytes);CommonUtils.log("^^***^^  S2CRepTeamCreate",e),this.auto_invite_role_id>0&&(this.C2SReqTeamInvite(this.auto_invite_role_id),this.auto_invite_role_id=0),ViewManager.ins().open(MyTeamView),EventProxy.Broast(EventType.S2CRepTeamCreate,[])},e.prototype.S2CRepTeamGetSceneTeam=function(t){var e=net_protocol.S2CRepTeamGetSceneTeam.decode(t.bytes);CommonUtils.log("^^***^^  S2CRepTeamGetSceneTeam",e),this.NearTeam=e.team_info,ViewManager.ins().open(TeamListView,void 0,TeamViewType.team),EventProxy.Broast(EventType.S2CRepTeamGetSceneTeam,[])},e.prototype.S2CRepTeamLeave=function(t){var e=net_protocol.S2CRepTeamLeave.decode(t.bytes);if(CommonUtils.log("^^***^^  S2CRepTeamLeave",e),e.role_id==RoleProxy.ins().getRoleId())this.team_info.team_id=0,this.team_info.captain_id=0,this.team_info.member_list=void 0,this.team_info=null,TipsControl.ins().showTips("离开队伍!");else for(var i=0;i<this.team_info.member_list.length;++i)e.role_id==this.team_info.member_list[i].role_id&&(TipsControl.ins().showTips(this.team_info.member_list[i].name+"离开队伍!"),this.team_info.member_list.splice(i,1));EventProxy.Broast(EventType.S2CRepTeamLeave,[])},e.prototype.S2CRepTeamPromote=function(t){var e=net_protocol.S2CRepTeamPromote.decode(t.bytes);if(CommonUtils.log("^^***^^  S2CRepTeamPromote",e),NoticeProxy.ins().ErrCode(e.err_code))if(this.team_info.captain_id=e.role_id,e.role_id==RoleProxy.ins().getRoleId())TipsControl.ins().showTips("你被提升为队长");else for(var i=0;i<this.team_info.member_list.length;++i)this.team_info.member_list[i].role_id==e.role_id&&TipsControl.ins().showTips(this.team_info.member_list[i].name+"被提升为队长");EventProxy.Broast(EventType.S2CRepTeamPromote,[])},e.prototype.S2CRepTeamRemove=function(t){var e=net_protocol.S2CRepTeamRemove.decode(t.bytes);if(CommonUtils.log("^^***^^  S2CRepTeamRemove",e),NoticeProxy.ins().ErrCode(e.err_code))if(e.role_id==RoleProxy.ins().getRoleId())this.team_info.team_id=0,this.team_info.captain_id=0,this.team_info=null;else for(var i=0;i<this.team_info.member_list.length;++i)e.role_id==this.team_info.member_list[i].role_id&&this.team_info.member_list.splice(i,1);EventProxy.Broast(EventType.S2CRepTeamRemove,[])},e.prototype.S2CRepTeamInvite=function(t){var e=net_protocol.S2CRepTeamInvite.decode(t.bytes);if(CommonUtils.log("^^***^^  S2CRepTeamInvite",e),NoticeProxy.ins().ErrCode(e.err_code))if(void 0==e.team_info)TipsControl.ins().showTips("申请入队成功");else if(this.auto_accept&&this.IsCanEnter())this.C2SReqTeamReplyInvite(e.team_info.captain_id,1);else{for(var i=!1,n=0;n<this.inviteList.length;++n)this.inviteList[n].captain_id==e.team_info.captain_id&&(i=!0);i||(this.inviteList.push(e.team_info),EventProxy.Broast(EventType.S2CRepTeamInvite,[]),this.CheckApplyInviteList())}},e.prototype.S2CRepTeamApply=function(t){var e=net_protocol.S2CRepTeamApply.decode(t.bytes);if(CommonUtils.log("^^***^^  S2CRepTeamApply",e),NoticeProxy.ins().ErrCode(e.err_code))if(void 0==e.role_info)TipsControl.ins().showTips("申请入队成功");else if(this.auto_reply&&this.IsCanEnter())this.C2SReqTeamReplyApply(e.role_info.role_id,1);else{for(var i=!1,n=0;n<this.applyList.length;++n)this.applyList[n].role_id==e.role_info.role_id&&(i=!0);i||(this.applyList.push(e.role_info),EventProxy.Broast(EventType.S2CRepTeamApply,[]),this.CheckApplyInviteList())}},e.prototype.CheckApplyInviteList=function(){var t=this;if(this.IsInTeam()){if(this.applyList.length>0&&this.IsCaptain()){var e=this.applyList[0];TipsControl.ins().ShowTips1("是否同意"+e.name+"加入队伍",function(){t.C2SReqTeamReplyInvite(e.role_id,0)},function(){t.C2SReqTeamReplyInvite(e.role_id,1)},!0)}}else if(this.inviteList.length>0){for(var e=this.inviteList[0],i="",n=0;n<e.member_list.length;++n)e.member_list[n].role_id==e.captain_id&&(i=e.member_list[n].name);TipsControl.ins().ShowTips1("是否同意加入"+i+"的队伍",function(){t.C2SReqTeamReplyInvite(e.captain_id,0)},function(){t.C2SReqTeamReplyInvite(e.captain_id,1)},!0)}},e.prototype.S2CRepTeamReplyInvite=function(t){var e=net_protocol.S2CRepTeamReplyInvite.decode(t.bytes);CommonUtils.log("^^***^^  S2CRepTeamReplyInvite",e),NoticeProxy.ins().ErrCode(e.err_code)&&(1==e.invite_state?TipsControl.ins().showTips(e.role_info.name+"同意了你的队伍邀请"):0==e.invite_state&&TipsControl.ins().showTips(e.role_info.name+"拒绝了你的队伍邀请"))},e.prototype.S2CRepTeamReplyApply=function(t){var e=net_protocol.S2CRepTeamReplyApply.decode(t.bytes);CommonUtils.log("^^***^^  S2CRepTeamReplyApply",e),NoticeProxy.ins().ErrCode(e.err_code)&&(1==e.reply_state?TipsControl.ins().showTips(e.role_info.name+"同意了你的队伍邀请"):0==e.reply_state&&TipsControl.ins().showTips(e.role_info.name+"拒绝了你的队伍邀请"))},e.prototype.S2CRepTeamAutoAccept=function(t){var e=net_protocol.S2CRepTeamAutoAccept.decode(t.bytes);CommonUtils.log("^^***^^  S2CRepTeamAutoAccept",e),this.auto_accept=1==e.accept_state,EventProxy.Broast(EventType.S2CRepTeamAutoAccept,[])},e.prototype.getMemberItemData=function(){return tt.proto.msgnew("net_protocol.member_item")},e.prototype.getTeamInfoData=function(t){if(void 0!=t){for(var e=t.captain_id,i=t.member_list.length,n=0,o="",s=1,r=0;r<t.member_list.length;++r)n+=t.member_list[r].fight,t.member_list[r].role_id==e&&(o=t.member_list[r].name,s=t.member_list[r].prof);return{name:o,fight:n,count:i,prof:s}}},e.prototype.IsInTeam=function(){return void 0!=this.team_info&&void 0!=this.team_info.team_id&&0!=this.team_info.team_id},e.prototype.IsCanEnter=function(){if(this.IsInTeam()){var t=this.team_info.member_list.length;return 3>t}return!0},e.prototype.IsCaptain=function(){return 0==this.team_info.team_id||this.team_info.captain_id!=RoleProxy.ins().getRoleId()?!1:!0},e.prototype.isNotMyTeam=function(t){return this.IsInTeam()?t!=this.team_info.captain_id?!0:!1:!0},e.prototype.GetTeamId=function(){if(void 0!=this.team_info.target_id){var t=Math.floor(this.team_info.target_id/1e5),e=Math.floor((this.team_info.target_id-1e5*t)/1e4),i=this.team_info.target_id%1e4;return[t,i,e]}return[0,0,0]},e.prototype.S2CTeamInfoChange=function(t){var e=net_protocol.S2CTeamInfoChange.decode(t.bytes);CommonUtils.log("^^***^^  S2CTeamInfoChange",e),e.is_leader,e.team_id,e.obj_id;var i=GameLogic.ins().getEntityByHandle(e.obj_id);i&&(i.team_id=e.team_id,i.is_leader=e.is_leader),EventProxy.Broast(EventType.S2CTeamInfoChange,[])},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25350,this.S2CRepTeamGetInfo,this),MsgHandle.ins().regNetMsg(25351,this.S2CRepTeamCreate,this),MsgHandle.ins().regNetMsg(25369,this.S2CRepTeamGetSceneTeam,this),MsgHandle.ins().regNetMsg(25354,this.S2CRepTeamLeave,this),MsgHandle.ins().regNetMsg(25355,this.S2CRepTeamPromote,this),MsgHandle.ins().regNetMsg(25356,this.S2CRepTeamRemove,this),MsgHandle.ins().regNetMsg(25357,this.S2CRepTeamInvite,this),MsgHandle.ins().regNetMsg(25358,this.S2CRepTeamApply,this),MsgHandle.ins().regNetMsg(25359,this.S2CRepTeamReplyInvite,this),MsgHandle.ins().regNetMsg(25360,this.S2CRepTeamReplyApply,this),MsgHandle.ins().regNetMsg(25365,this.S2CRepTeamAutoAccept,this),MsgHandle.ins().regNetMsg(20067,this.S2CTeamInfoChange,this)},e.prototype.GetCaptainInfo=function(t){for(var e=0;t.member_list.length;++e)if(t.captain_id==t.member_list[e].role_id)return t.member_list[e]},e.prototype.getOpenInitView=function(){EventProxy.Broast(EventType.getOpenInitView,[])},e.prototype.getRoleName=function(t){if(void 0==this.team_info||void 0==this.team_info.member_list)return"";if(RoleProxy.ins().getRoleId()==t)return RoleProxy.ins().getRoleName();for(var e=0;this.team_info.member_list.length;++e)if(t==this.team_info.member_list[e].role_id)return this.team_info.member_list[e].name},e.prototype.openTeamView=function(){void 0!=e.ins().team_info&&void 0!=e.ins().team_info.member_list&&e.ins().team_info.member_list.length>0?ViewManager.ins().open(MyTeamView):ViewManager.ins().open(TeamInfoView)},e}(BaseSystem);__reflect(TeamProxy.prototype,"TeamProxy");var title_data=function(){function t(){}return t}();__reflect(title_data.prototype,"title_data");var TitleType;!function(t){t[t.rank=1]="rank",t[t.achievement=2]="achievement",t[t.special=3]="special",t[t.tong=4]="tong"}(TitleType||(TitleType={}));var TitleUIType;!function(t){t[t.reputation=1]="reputation",t[t.title=2]="title"}(TitleUIType||(TitleUIType={}));var TitleProxy=function(t){function e(){var e=t.call(this)||this;return e.last_online_time=0,e.title_list=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqTitleGetInfo=function(){var t=new net_protocol.C2SReqTitleGetInfo;CommonUtils.log("---------C2SReqTitleGetInfo----------",t),this.sendPbPack(Msg.C2SReqTitleGetInfo,t,net_protocol.C2SReqTitleGetInfo)},e.prototype.C2SReqTitleUpgradeReputation=function(t){var e=new net_protocol.C2SReqTitleUpgradeReputation;e.id=t,CommonUtils.log("---------C2SReqTitleUpgradeReputation----------",e),this.sendPbPack(Msg.C2SReqTitleUpgradeReputation,e,net_protocol.C2SReqTitleUpgradeReputation)},e.prototype.C2SReqTitleActive=function(t){var e=new net_protocol.C2SReqTitleActive;e.id=t,CommonUtils.log("---------C2SReqTitleActive----------",e),this.sendPbPack(Msg.C2SReqTitleActive,e,net_protocol.C2SReqTitleActive)},e.prototype.C2SReqTitleUpgrade=function(t){var e=new net_protocol.C2SReqTitleUpgrade;e.id=t,CommonUtils.log("---------C2SReqTitleUpgrade----------",e),this.sendPbPack(Msg.C2SReqTitleUpgrade,e,net_protocol.C2SReqTitleUpgrade)
},e.prototype.C2SReqTitleUse=function(t){var e=new net_protocol.C2SReqTitleUse;e.id=t,CommonUtils.log("---------C2SReqTitleUse----------",e),this.sendPbPack(Msg.C2SReqTitleUse,e,net_protocol.C2SReqTitleUse)},e.prototype.S2CRepTitleGetInfo=function(t){var e=net_protocol.S2CRepTitleGetInfo.decode(t.bytes);GlobalConfig.getConfig("reputation_data","reputationConfig"),CommonUtils.log("---------S2CRepTitleGetInfo----------",e),this.reputation_id=e.reputation_id,this.use_title_id=e.use_title_id,this.list=e.list,this.SetShenWang(this.reputation_id),this.InitTitleMap(),this.SetTitle(this.use_title_id),this.last_online_time=e.last_online_time||0;for(var i=0;i<e.title_list.length;i++)this.title_list[e.title_list[i].type]=e.title_list[i];this.CheckRankTitleTips(),EventProxy.Broast(EventType.S2CRepTitleGetInfo,{}),EventProxy.Broast(EventType.RefreshTitleRed,[])},e.prototype.getTitleInfo=function(t){if(void 0!=this.list&&0!=this.list.length)for(var e=0;e<this.list.length;++e)if(t==this.list[e].id)return this.list[e]},e.prototype.SetShenWang=function(t){if(!(0>=t)&&GameMap.centerEntity){var e=this.reputation_id.toString();this.SetChinaNumber(this.reputation_id,e);var i=GlobalConfig.getReputation_dataConfig(t),n=FacProxy.ins().getFacId(),o=i.name[n-1]||i.name[0],s=this.getShengWanglvlName(this.reputation_id,n);GameMap.centerEntity.setShengwang("C:6&["+s+"]"+o)}},e.prototype.SetTitle=function(t){if(!(0>t)&&GameMap.centerEntity)if(0==t)GameMap.centerEntity.setTitle("");else{var e=GlobalConfig.getTitleById(t);GameMap.centerEntity.setTitle(e.title_res)}},e.prototype.ResetTitle=function(){this.SetTitle(this.use_title_id)},e.prototype.getShengwangName=function(t,e){var i=GlobalConfig.getReputation_dataConfig(t);return void 0==i?"":i.name[e-1]||i.name[0]||""},e.prototype.getShengWanglvlName=function(t,e){var i=GlobalConfig.getFaction_dataConfig(e);return void 0==i?t+"阶":""+i.faction_name+t+"阶"},e.prototype.SetChinaNumber=function(t,e){var i=t%10;switch(i){case 0:e+="零";break;case 0:e+="一";break;case 0:e+="二";break;case 0:e+="三";break;case 0:e+="四";break;case 0:e+="五";break;case 0:e+="六";break;case 0:e+="七";break;case 0:e+="八";break;case 0:e+="九"}t/10>1&&this.SetChinaNumber(Math.floor(t/10),e)},e.prototype.S2CRepTitleActive=function(t){var e=net_protocol.S2CRepTitleActive.decode(t.bytes);CommonUtils.log("S2CRepTitleActive",e);GlobalConfig.getTitleById(e.id);for(var i in this.titleMap)for(var n=this.titleMap[i],o=0;o<n.length;++o)if(n[o].id==e.id){n[o].active=1;var s={};n[o].isForever?(s.id=e.id,s.time=1):(s.id=e.id,s.time=n[o].cd),n[o].titleInfo=s;break}this.C2SReqTitleUse(e.id),CommonUtils.log("---------S2CRepTitleActive----------",e),EventProxy.Broast(EventType.S2CRepTitleActive,[e.id]),EventProxy.Broast(EventType.RefreshTitleRed,[])},e.prototype.S2CRepTitleUpgrade=function(t){var e=net_protocol.S2CRepTitleUpgrade.decode(t.bytes);CommonUtils.log("S2CRepTitleUpgrade",e);for(var i in this.titleMap)for(var n=this.titleMap[i],o=0;o<n.length;++o)if(n[o].id==e.id){n[o].titleInfo.time=e.level;break}CommonUtils.log("---------S2CRepTitleUpgrade----------",e),EventProxy.Broast(EventType.S2CRepTitleUpgrade,[e.id]),EventProxy.Broast(EventType.RefreshTitleRed,[])},e.prototype.S2CRepTitleUse=function(t){var e=net_protocol.S2CRepTitleUse.decode(t.bytes);CommonUtils.log("---------S2CRepTitleUse----------",e);for(var i in this.titleMap)for(var n=this.titleMap[i],o=0;o<n.length;++o)if(1==n[o].isUse&&(n[o].isUse=0),n[o].id==e.id){n[o].isUse=1;break}var s=this.use_title_id;this.use_title_id=e.id,this.SetTitle(this.use_title_id),EventProxy.Broast(EventType.S2CRepTitleUse,[this.use_title_id,s])},e.prototype.S2CRepTitleUpgradeReputation=function(t){var e=net_protocol.S2CRepTitleUpgradeReputation.decode(t.bytes);CommonUtils.log("---------S2CRepTitleUpgradeReputation----------",e),this.reputation_id=e.id,this.SetShenWang(this.reputation_id),TipsControl.ins().showTips("升阶成功!"),EventProxy.Broast(EventType.S2CRepTitleUpgradeReputation,{}),EventProxy.Broast(EventType.RefreshTitleRed,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25750,this.S2CRepTitleGetInfo,this),MsgHandle.ins().regNetMsg(25751,this.S2CRepTitleActive,this),MsgHandle.ins().regNetMsg(25752,this.S2CRepTitleUpgrade,this),MsgHandle.ins().regNetMsg(25753,this.S2CRepTitleUse,this),MsgHandle.ins().regNetMsg(25754,this.S2CRepTitleUpgradeReputation,this)},e.prototype.GetCurrentData=function(){void 0==GlobalConfig.ins().reputationConfig&&GlobalConfig.getConfig("reputation_data","reputationConfig");for(var t=0;t<GlobalConfig.ins().reputationConfig.length;++t)if(this.reputation_id==GlobalConfig.ins().reputationConfig[t].id)return GlobalConfig.ins().reputationConfig[t];return GlobalConfig.ins().reputationConfig[GlobalConfig.ins().reputationConfig.length-1]},e.prototype.GetCurrentLevel=function(){return this.reputation_id||0},e.prototype.getTitleName=function(){var t="";if(FacProxy.ins().getFacId()>0){var e=this.GetCurrentLevel(),i=GlobalConfig.getReputation_dataConfig(e);i&&i.id>0&&(t="["+i.name[FacProxy.ins().getFacId()-1]+"]")}return t},e.prototype.getTitleNameById=function(t,e){var i="";if(e>0){var n=GlobalConfig.getReputation_dataConfig(t);n&&n.id>0&&(i="["+n.name[e-1]+"]")}return i},e.prototype.InitTitleMap=function(){var t=GlobalConfig.getConfig("title_data","TitleConfig");this.titleMap={};for(var e in t){var i=t[e],n=new title_data;n.id=i.id,n.res=i.title_res,n.path=i.path;var o=this.getTitleInfo(i.id);void 0==o?n.active=0:(n.active=1,n.titleInfo=o),n.isForever=1==i.type,n.isItemOpen=i.need_items.length>0,n.cd=i.time,n.isUse=this.use_title_id==n.id?1:0;var s=GlobalConfig.getTitle_upgrade_dataListById(i.id);n.titleList=s,s&&s[2]?n.isUp=!0:n.isUp=!1,void 0==this.titleMap[i.title_type]&&(this.titleMap[i.title_type]=[]),this.titleMap[i.title_type].push(n)}},e.prototype.getTitleDataByType=function(t){return this.titleMap[t]||[]},e.prototype.getTitleDataById=function(t){for(var i in e.ins().titleMap)for(var n=e.ins().titleMap[i],o=0;o<n.length;++o)if(n[o].id==t)return n[o]},e.prototype.getTitleDataActiveById=function(t){for(var i in e.ins().titleMap)for(var n=e.ins().titleMap[i],o=0;o<n.length;++o)if(n[o].id==t)return 0!=n[o].active;return!1},e.prototype.getTitleCountByType=function(t){return this.titleMap[t]?this.titleMap[t].length:0},e.prototype.getTitleTotalFight=function(){var t=0;for(var e in this.titleMap){var i=this.titleMap[e];if(void 0!=i)for(var n=0;n<i.length;++n)if(i[n].active&&void 0!=i[n].titleInfo){var o=UtilProxy.isTimeSpan(i[n].titleInfo.time);t+=o?UtilProxy.GetAttrFight(i[n].titleList[1]):UtilProxy.GetAttrFight(i[n].titleList[i[n].titleInfo.time])}}return t},e.prototype.getTitleActiveByType=function(t){for(var e=this.titleMap[t],i=0,n=0;n<e.length;++n)1==e[n].active&&(e[n].isForever?i++:e[n].titleInfo.time>GameLogic.ins().getServerTime()&&i++);return i},e.prototype.sortTitle=function(t,i){if(t.isUp&&i.isUp){var n=e.ins().isEnoughTitleById(t.id),o=e.ins().isEnoughTitleById(i.id);return n&&o?t.active<i.active?-1:t.active==i.active?t.isUse>i.isUse?-1:t.id<i.id?-1:1:1:n?-1:o?1:t.isUse>i.isUse?-1:t.active>i.active?-1:t.active==i.active&&t.id<i.id?-1:1}return t.isUse>i.isUse?-1:t.active>i.active?-1:t.active==i.active&&t.id<i.id?-1:1},e.prototype.getCurData=function(t){return 1==t.active&&void 0!=t.titleInfo?t.isUp?t.titleList[t.titleInfo.time]:t.titleList[1]:void 0},e.prototype.getNextData=function(t){return 1!=t.active?t.titleList[1]:void 0!=t.titleInfo&&t.isUp&&void 0!=t.titleList[t.titleInfo.time+1]?t.titleList[t.titleInfo.time+1]:void 0},e.prototype.getcurLevel=function(t){if(1!=t.active)return 0;if(void 0!=t.titleInfo){var e=UtilProxy.isTimeSpan(t.titleInfo.time);if(!e)return t.titleInfo.time}return 0},e.prototype.isUseTitle=function(t){return void 0==this.use_title_id?!1:this.use_title_id==t},e.prototype.isEnoughItem=function(t,e){var i=GlobalConfig.getTitle_upgrade_dataById(t,e);if(i){for(var n=0;n<i.items.length;++n)if(i.items[n][1]>BagProxy.ins().getItemCountById(i.items[n][0]))return!1;return!0}return!1},e.prototype.isEnoughTitleById=function(t){var i=e.ins().getTitleDataById(t);if(!i)return!1;var n=1;if(1==i.active&&i.titleInfo){var o=UtilProxy.isTimeSpan(i.titleInfo.time);o||(n=i.titleInfo.time+1)}return e.ins().isEnoughItem(t,n)},e.prototype.initTitleMatrial=function(){this.titleMatrialIdList=[],this.titleMap||this.InitTitleMap();for(var t in this.titleMap)for(var e=this.titleMap[t],i=0;i<e.length;++i)if(e[i].titleList)for(var n=e[i].titleList[1],o=0;o<n.items.length;++o)this.titleMatrialIdList.push([n.items[o][0],n.id])},e.prototype.isActiveMatrial=function(t){var e=GlobalConfig.getTitleConfigs();for(var i in e)for(var n=e[i],o=0;o<n.need_items.length;++o)if(n.need_items[o][0]==t)return!0;return!1},e.prototype.isTitleMatrialId=function(t){if(this.titleMatrialIdList||this.initTitleMatrial(),!this.titleMatrialIdList)return!1;for(var e=0;e<this.titleMatrialIdList.length;++e)if(t==this.titleMatrialIdList[e][0])return!0;return!1},e.prototype.getTitleDataActiveByItemId=function(t){var e=this.getTitleIdByItemId(t);return e>0?this.getTitleDataActiveById(e):!1},e.prototype.getTitleIdByItemId=function(t){if(this.titleMatrialIdList||this.initTitleMatrial(),!this.titleMatrialIdList)return!1;for(var e=0;e<this.titleMatrialIdList.length;++e)if(t==this.titleMatrialIdList[e][0])return this.titleMatrialIdList[e][1];return 0},e.prototype.setTitleTipsView=function(t){if(!this.getTitleDataActiveByItemId(t)){var e=this.getTitleIdByItemId(t);ViewManager.ins().open(TitleActiveView,e)}},e.prototype.getTitleNumByType=function(t){var i=0;if(!this.titleMap)return i;var n=this.titleMap[t];if(n)for(var o=0;o<n.length;++o)if(n[o].isUp){var s=1;1==n[o].active&&void 0!=n[o].titleInfo&&(s=n[o].titleInfo.time+1),e.ins().isEnoughItem(n[o].id,s)&&i++}return i},e.prototype.getRedByType=function(t){if(2==t)return SystemOpenProxy.ins().isOpen(1,44,!0)?this.getTitleNumByType(TitleType.rank)>0?!0:this.getTitleNumByType(TitleType.achievement)>0?!0:this.getTitleNumByType(TitleType.special)>0?!0:this.getTitleNumByType(TitleType.tong)>0?!0:!1:!1;if(!SystemOpenProxy.ins().isOpen(1,27,!0))return!1;var e=this.GetCurrentLevel()+1,i=GlobalConfig.getReputation_dataConfig(e),n=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);return void 0!=i&&n>=i.need_value?!0:!1},e.prototype.CheckRankTitleTips=function(){if(0!=this.last_online_time){var t=new Date(1e3*GameLogic.ins().getServerTime()),e=new Date(1e3*this.last_online_time);if(t.getFullYear()!=e.getFullYear()||t.getMonth()!=e.getMonth()||t.getDate()!=e.getDate()){var i=[],n=GlobalConfig.getRankTypeList();for(var o in n)i.push(n[o]);i.sort(function(t,e){return t.tips_index<e.tips_index?-1:t.tips_index>e.tips_index?1:0});for(var o in i)if(this.title_list[i[o].type]){var s=this.title_list[i[o].type].rank_title,r=this.title_list[i[o].type].last_rank_title;if(s>0){if(0>=r){var a="",h=GlobalConfig.getTitleById(s);return a=s==i[o].title?UtilProxy.getStr("恭喜您成为@0 第一，获得称号“@1 ”，威慑古今",[i[o].name,h.name]):UtilProxy.getStr("恭喜您进入@0 前10，获得称号“@1 ”，威名传遍三界",[i[o].name,h.name]),void ViewManager.ins().open(RankTipsView,a)}if(s!=r){var a="";if(s==i[o].title){var h=GlobalConfig.getTitleById(s);a=UtilProxy.getStr("恭喜您成为@0 第一，获得称号“@1 ”，威慑古今",[i[o].name,h.name])}else{var h=GlobalConfig.getTitleById(r);a=UtilProxy.getStr("您的@0 排名下降了，失去了全服唯一称号“@1 ”，威望平平如凡仙，望努力夺回属于您的荣耀",[i[o].name,h.name])}return void ViewManager.ins().open(RankTipsView,a)}}else if(r>0){var a="",h=GlobalConfig.getTitleById(r);return a=r==i[o].title?UtilProxy.getStr("您的@0 排名下降了，失去了全服唯一称号“@1 ”，威望平平如凡仙，望努力夺回属于您的荣耀",[i[o].name,h.name]):UtilProxy.getStr("很遗憾您的@0 排行下降，失去了称号“@1 ”，威望跌落如同喽啰，望努力夺回属于您的荣耀",[i[o].name,h.name]),void ViewManager.ins().open(RankTipsView,a)}}}}},e.title_icon_path="resource/skins/TitleIcon/",e}(BaseSystem);__reflect(TitleProxy.prototype,"TitleProxy");var TreasureType;!function(t){t[t.LingBao=1]="LingBao",t[t.sword=2]="sword",t[t.equip=3]="equip",t[t.ZhenBao=4]="ZhenBao"}(TreasureType||(TreasureType={}));var TreasureIndex;!function(t){t[t.LingBao=1]="LingBao",t[t.equip=2]="equip",t[t.sword=3]="sword",t[t.ZhenBao=4]="ZhenBao"}(TreasureIndex||(TreasureIndex={}));var TreasureProxy=function(t){function e(){var e=t.call(this)||this;return e.myrumors=[],e.mySwordrumors=[],e.myLingbaorumors=[],e.rumors_list=[],e.isInitSwordView=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25850,this.S2CRepFindtreasureGetInfo,this),MsgHandle.ins().regNetMsg(25851,this.S2CRepFindtreasureFind,this),MsgHandle.ins().regNetMsg(25852,this.S2CRepFindtreasureExchange,this),MsgHandle.ins().regNetMsg(25853,this.S2CRepFindtreasureGetExpItem,this),MsgHandle.ins().regNetMsg(25854,this.S2CRepFindtreasureMsgInfo,this),MsgHandle.ins().regNetMsg(25855,this.S2CRepFindtreasureStoreInfo,this)},e.prototype.S2CRepFindtreasureGetInfo=function(t){var e=net_protocol.S2CRepFindtreasureGetInfo.decode(t.bytes);CommonUtils.log("-------------------------------------^&&&&****^-------S2CRepFindtreasureGetInfo",e),this.score=e.score,this.rumors=e.rumors,this.items=e.items,this.rumors_list=e.rumors_list,this.treasure_list=[];for(var i=0;i<e.treasure_list.length;++i)this.treasure_list.push({type:e.treasure_list[i].type,find_cnt:e.treasure_list[i].find_cnt,free_time:e.treasure_list[i].free_time,server_time:GameLogic.ins().getServerTime()});this.times_list=e.times_list,EventProxy.Broast(EventType.S2CRepFindtreasureGetInfo,[])},e.prototype.isFirstReward=function(t){var e=GlobalConfig.getTreasure_dataConfigById(t);return e.first_times_award.length>0},e.prototype.S2CRepFindtreasureFind=function(t){var e=net_protocol.S2CRepFindtreasureFind.decode(t.bytes);if(CommonUtils.log("-------------------------------------^&&&&****^-------S2CRepFindtreasureFind",e),NoticeProxy.ins().ErrCode(e.err_code)){for(var i=e.type>4?e.type-4:e.type,n=e.find_ids.length,o=new Array,s=new Array,r=!1,a=0;a<this.treasure_list.length;++a)if(this.treasure_list[a].type==i){0==this.treasure_list[a].find_cnt&&(r=!0);var h=r&&this.isFirstReward(i)?n+1:n;this.treasure_list[a].find_cnt=this.treasure_list[a].find_cnt+h,this.treasure_list[a].free_time=e.free_time,this.treasure_list[a].currentRealTime=GameLogic.ins().getServerTime()}if(r&&this.isFirstReward(i)){var l=GlobalConfig.getTreasure_dataConfigById(i);if(l.first_times_award.length>0){var p=new ItemExData;p.itemData=UtilProxy.GetItemCellData(l.first_times_award[0],l.first_times_award[1]),o.push(p)}}var c=!1;if(this.times_list)for(var a=0;a<this.times_list.length;++a)this.times_list[a].times_type==e.type&&this.times_list[a].times_key==n&&n>0&&(this.times_list[a].times_val=this.times_list[a].times_val+1,c=!0);else this.times_list=[];c||this.times_list.push({times_type:e.type,times_key:n,times_val:1});for(var a=0;a<e.extra_list.length;++a){var p=new ItemExData,u=e.extra_list[a].item_id,d=e.extra_list[a].item_num;if(i==TreasureType.sword){var g=GlobalConfig.getItemsConfig(u);if(!(g&&g.extra_params[0]&&g.extra_params[0][2]))continue;p.fuwenData={id:g.extra_params[0][0],color:g.extra_params[0][1],num:g.extra_params[0][2]*d,type:FwUIType.preview}}else{var y=UtilProxy.GetItemCellData(u,d);p.itemData=y}s.push(p)}for(var a=0;n>a;++a){var f=e.find_ids[a],_=Math.floor(f/1e5);f%=1e5;var v=GlobalConfig.getFind_treasureConfigById(_,f);if(v){var p=new ItemExData,u=v.item_id[0],d=v.item_id[1];if(i==TreasureType.sword){var g=GlobalConfig.getItemsConfig(u);if(!(g&&g.extra_params[0]&&g.extra_params[0][2]))continue;p.fuwenData={id:g.extra_params[0][0],color:g.extra_params[0][1],num:g.extra_params[0][2]*d,type:FwUIType.preview}}else{var y=UtilProxy.GetItemCellData(u,d);p.itemData=y}o.push(p),i==TreasureType.equip?(v.display&&this.myrumors.push({item_id:u}),v.is_show&&(this.rumors||(this.rumors=[]),this.rumors.push({name:RoleProxy.ins().getRoleName(),item_id:u,count:d,role_id:RoleProxy.ins().getRoleId()}))):i==TreasureType.LingBao?v.display&&this.myLingbaorumors.push({item_id:u}):i==TreasureType.sword&&v.display&&this.mySwordrumors.push({item_id:u})}else CommonUtils.log("not find in Res.find_treasure data---->",_,f)}ViewManager.ins().open(TreasureView_reward,[!0,i,o,s]),EventProxy.Broast(EventType.S2CRepFindtreasureFind,[i,o,s])}},e.prototype.S2CRepFindtreasureExchange=function(t){net_protocol.S2CRepFindtreasureExchange.decode(t.bytes);EventProxy.Broast(EventType.S2CRepFindtreasureExchange,[])},e.prototype.S2CRepFindtreasureGetExpItem=function(t){net_protocol.S2CRepFindtreasureGetExpItem.decode(t.bytes);EventProxy.Broast(EventType.S2CRepFindtreasureGetExpItem,[])},e.prototype.S2CRepFindtreasureMsgInfo=function(t){var e=net_protocol.S2CRepFindtreasureMsgInfo.decode(t.bytes);CommonUtils.log("-------------------------------------^&&&&****^-------S2CRepFindtreasureMsgInfo",e);for(var i=!1,n=0;n<this.rumors_list.length;++n)this.rumors_list[n].type==e.type&&(this.rumors_list[n].list=e.rumors,i=!0);i||this.rumors_list.push({type:e.type,list:e.rumors}),EventProxy.Broast(EventType.S2CRepFindtreasureMsgInfo,[])},e.prototype.getRumorsByType=function(t){for(var e=0;e<this.rumors_list.length;++e)if(this.rumors_list[e].type==t)return this.rumors_list[e].list;return[]},e.prototype.C2SReqFindtreasureGetInfo=function(){this.isInitSwordView=!0;var t=new net_protocol.C2SReqFindtreasureGetInfo;CommonUtils.log("^^***^^  C2SReqFindtreasureGetInfo",t),this.sendPbPack(Msg.C2SReqFindtreasureGetInfo,t,net_protocol.C2SReqFindtreasureGetInfo)},e.prototype.C2SReqFindtreasureFind=function(t,e){var i=new net_protocol.C2SReqFindtreasureFind;i.type=t,i.find_times=e,CommonUtils.log("^^***^^  C2SReqFindtreasureFind",i),this.sendPbPack(Msg.C2SReqFindtreasureFind,i,net_protocol.C2SReqFindtreasureFind)},e.prototype.C2SReqFindtreasureExchange=function(t){var e=new net_protocol.C2SReqFindtreasureExchange;e.target_item_id=t,CommonUtils.log("^^***^^  C2SReqFindtreasureGetInfo",e),this.sendPbPack(Msg.C2SReqFindtreasureExchange,e,net_protocol.C2SReqFindtreasureExchange)},e.prototype.C2SReqFindtreasureGetExpItem=function(){var t=new net_protocol.C2SReqFindtreasureGetExpItem;CommonUtils.log("^^***^^  C2SReqFindtreasureGetExpItem",t),this.sendPbPack(Msg.C2SReqFindtreasureGetExpItem,t,net_protocol.C2SReqFindtreasureGetExpItem)},e.prototype.C2SReqFindtreasurePickOutItem=function(t,e){void 0===e&&(e=-1);var i=new net_protocol.C2SReqFindtreasurePickOutItem;i.opt=t,e>0&&(i.item_id=e),CommonUtils.log("^^***^^  C2SReqFindtreasureGetExpItem",i),this.sendPbPack(Msg.C2SReqFindtreasurePickOutItem,i,net_protocol.C2SReqFindtreasurePickOutItem)},e.prototype.S2CRepFindtreasureStoreInfo=function(t){var e=net_protocol.S2CRepFindtreasureStoreInfo.decode(t.bytes);CommonUtils.log("-------------------------------------^&&&&****^-------S2CRepFindtreasureStoreInfo",e),this.max_count=e.max_count,this.store_list=e.list,EventProxy.Broast(EventType.S2CRepFindtreasureStoreInfo,[])},e.prototype.getTreasureUseItemByType=function(t){var e=GlobalConfig.getTreasure_dataConfigById(t);return e?e.item_id:0},e.prototype.getTreasurePayByType=function(t,e){var i=GlobalConfig.getTreasure_dataConfigById(t);if(i){if(1==e)return{type:i.money[0],pay:i.money[1]};for(var n=0;n<i.ten_money.length;++n)if(i.ten_money[n][0]==e)return{type:i.ten_money[n][1],pay:i.ten_money[n][2]}}},e.prototype.getFindCountByType=function(t){if(this.treasure_list)for(var e=0;e<this.treasure_list.length;++e)if(this.treasure_list[e].type==t)return this.treasure_list[e].find_cnt;return 0},e.prototype.IsFirstTweenty=function(){var t=!0;if(this.times_list)for(var e=0;e<this.times_list.length;++e)if(this.times_list[e].times_type==TreasureType.equip&&50==this.times_list[e].times_key)return this.times_list[e].times_val<1;return t},e.prototype.isTreasureMaterial=function(t){var e=GlobalConfig.getTreasure_dataConfig();for(var i in e)if(e[i].item_id==t)return!0;return!1},e.prototype.getRedByType=function(t){var e=1==t?1:2,i=1==t?M_View_Type.Treasure:100*M_View_Type.Treasure+t-1;if(!SystemOpenProxy.ins().isOpen(e,i,!0))return!1;var n=this.getTreasureType(t);if(2==n&&this.isInitSwordView)return!0;if(n==TreasureType.equip&&this.isTreasureBagRed())return!0;var o=GlobalConfig.getTreasure_dataConfigById(n);return o&&BagProxy.ins().getItemCountById(o.item_id)>0},e.prototype.getTreasureType=function(t){var e=GlobalConfig.getTreasure_dataConfig();for(var i in e)if(e[i].index==t)return e[i].id;return 0},e.prototype.getTreasureBagList=function(){if(this.store_list){for(var t=[],e=0;e<this.store_list.length;++e)t.push(UtilProxy.GetItemCellData(this.store_list[e].item_id,this.store_list[e].count));return t}return[]},e.prototype.isTreasureBagRed=function(){return this.store_list?this.store_list.length>0:!1},e.prototype.getRed=function(){return this.getRedByType(TreasureIndex.LingBao)||this.getRedByType(TreasureIndex.sword)||this.getRedByType(TreasureIndex.equip)||this.getRedByType(TreasureIndex.ZhenBao)},e}(BaseSystem);__reflect(TreasureProxy.prototype,"TreasureProxy");var UpgradeProxy=function(t){function e(){var e=t.call(this)||this;return e.upgradeList=[],e.suit_id=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqIntensifyGetInfo=function(){var t=new net_protocol.C2SReqIntensifyGetInfo;this.sendPbPack(Msg.C2SReqIntensifyGetInfo,t,net_protocol.C2SReqIntensifyGetInfo)},e.prototype.C2SReqIntensifyUpgrade=function(t){var e=new net_protocol.C2SReqIntensifyUpgrade;e.part_list=[],e.part_list=t,this.sendPbPack(Msg.C2SReqIntensifyUpgrade,e,net_protocol.C2SReqIntensifyUpgrade)},e.prototype.C2SReqIntensifySuit=function(t){var e=new net_protocol.C2SReqIntensifySuit;e.suit_id=t,this.sendPbPack(Msg.C2SReqIntensifySuit,e,net_protocol.C2SReqIntensifySuit)},e.prototype.S2CRepIntensifyGetInfo=function(t){for(var e=net_protocol.S2CRepIntensifyGetInfo.decode(t.bytes),i=0;i<e.list.length;i++)void 0!=e.list[i].part&&(this.upgradeList[e.list[i].part]=e.list[i].level);this.suit_id=e.suit_id,XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.S2CRepIntensifyGetInfo,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepIntensifyUpgrade=function(t){for(var e=net_protocol.S2CRepIntensifyUpgrade.decode(t.bytes),i=0;i<e.part_list.length;i++)void 0==this.upgradeList[e.part_list[i]]?this.upgradeList[e.part_list[i]]=1:this.upgradeList[e.part_list[i]]=this.upgradeList[e.part_list[i]]+1;XiuXianProxy.ins().updateAchieRed(AchieType.upgrade),XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.S2CRepIntensifyUpgrade,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepIntensifySuit=function(t){var e=net_protocol.S2CRepIntensifySuit.decode(t.bytes);this.suit_id=e.suit_id,EventProxy.Broast(EventType.S2CRepIntensifySuit,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.getCurUpState=function(t){var i=e.ins().upgradeList[t];void 0==i&&(i=0);var n=[];n[0]=0;var o=GlobalConfig.getIntensify_part_dataConfig(i+1);return void 0==o?(n[0]=2,n):void 0!=o&&o.level>RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL)?(n[0]=3,n):o.currencys[0]&&RoleProxy.ins().getMoneyAttr(o.currencys[0])<o.currencys[1]?(n[0]=1,n[1]=o.currencys[0],n):o.items[0]&&BagProxy.ins().getItemCountByIDtype(o.items[0],BagType.BAG)<o.items[1]?(n[0]=1,n[1]=o.items[0],n):n},e.prototype.getListCanUpRed=function(){for(var t=1;10>=t;t++)if(0==this.getCurUpState(t)[0])return!0;return!1},e.prototype.getRed=function(){return this.getListCanUpRed()?!0:this.getMasterRed()?!0:!1},e.prototype.getUpgradeLevelCount=function(t){for(var e=0,i=1;10>=i;i++)void 0!=this.upgradeList[i]&&this.upgradeList[i]>=t&&(e+=1);return e},e.prototype.getUpgradeLevelByPart=function(t){return void 0!=this.upgradeList[t]?this.upgradeList[t]:0},e.prototype.getAllUpgradeLevel=function(){for(var t=0,e=1;10>=e;e++)t+=this.getUpgradeLevelByPart(e);return t},e.prototype.getMinUpgradeLevel=function(){for(var t=-1,e=1;10>=e;e++)t=-1==t?this.getUpgradeLevelByPart(e):Math.min(t,this.getUpgradeLevelByPart(e));return t},e.prototype.getMaxUpLevel=function(){for(var t=!1,e=-1,i=1;10>=i;i++)-1!=e&&e!=this.getUpgradeLevelByPart(i)&&(t=!0),e=Math.max(e,this.getUpgradeLevelByPart(i));return t?e:-1},e.prototype.getMasterRed=function(){var t=GlobalConfig.getIntensify_suit_dataConfig(e.ins().suit_id+1);return void 0!=t&&this.getAllUpgradeLevel()>=t.level?!0:!1},e.prototype.getMasterFight=function(){var t=e.ins().suit_id,i=GlobalConfig.getIntensify_suit_dataConfig(t);return UtilProxy.GetAttrFight(i)},e.prototype.getAllFightValue=function(){for(var t=0,e=1;10>=e;e++){var i=this.getUpgradeLevelByPart(e),n=GlobalConfig.getIntensify_part_attrConfig(i);n&&(t+=UtilProxy.GetAttrFight(n[e]))}return t+this.getMasterFight()},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25900,this.S2CRepIntensifyGetInfo,this),MsgHandle.ins().regNetMsg(25901,this.S2CRepIntensifyUpgrade,this),MsgHandle.ins().regNetMsg(25902,this.S2CRepIntensifySuit,this)},e}(BaseSystem);__reflect(UpgradeProxy.prototype,"UpgradeProxy");var UpStarProxy=function(t){function e(){var e=t.call(this)||this;return e.upstarList=[],e.master_level=0,e.IsShowRed=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqUpstarGetInfo=function(){var t=new net_protocol.C2SReqUpstarGetInfo;this.sendPbPack(Msg.C2SReqUpstarGetInfo,t,net_protocol.C2SReqUpstarGetInfo)},e.prototype.C2SReqUpstarUpgrade=function(t,e){var i=new net_protocol.C2SReqUpstarUpgrade;i.part=t,i.type=e,this.sendPbPack(Msg.C2SReqUpstarUpgrade,i,net_protocol.C2SReqUpstarUpgrade)},e.prototype.C2SReqUpstarUpgradeMaster=function(){var t=new net_protocol.C2SReqUpstarUpgradeMaster;this.sendPbPack(Msg.C2SReqUpstarUpgradeMaster,t,net_protocol.C2SReqUpstarUpgradeMaster)},e.prototype.S2CRepUpstarGetInfo=function(t){for(var e=net_protocol.S2CRepUpstarGetInfo.decode(t.bytes),i=0;i<e.list.length;i++)void 0!=e.list[i].part&&(this.upstarList[e.list[i].part]=e.list[i].star);this.master_level=e.master_level,XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.S2CRepUpstarGetInfo,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepUpstarUpgrade=function(t){var e=net_protocol.S2CRepUpstarUpgrade.decode(t.bytes);return 1==e.code?(TipsControl.ins().showTips("升星失败"),EventProxy.Broast(EventType.S2CRepUpstarUpgrade,[!1]),void EventProxy.Broast(EventType.UpdataForgingRed,{})):(this.upstarList[e.part]=e.star,XiuXianProxy.ins().updateAchieRed(AchieType.star_level),XiuXianProxy.ins().updateZhuanRed(),EventProxy.Broast(EventType.S2CRepUpstarUpgrade,[!0]),void EventProxy.Broast(EventType.UpdataForgingRed,{}))},e.prototype.S2CRepUpstarUpgradeMaster=function(t){var e=net_protocol.S2CRepUpstarUpgradeMaster.decode(t.bytes);this.master_level=e.master_level,EventProxy.Broast(EventType.S2CRepUpstarUpgradeMaster,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.getUpStarByPart=function(t){return void 0!=this.upstarList[t]?this.upstarList[t]:0},e.prototype.getCurUpStarState=function(t,e){var i=this.getUpStarByPart(t),n=GlobalConfig.getUpstar_part_dataConfig(i+1);if(void 0==n)return 2;var o=1==e?n.items:n.perfect_items;return o[0]&&BagProxy.ins().getItemCountByIDtype(o[0][0],BagType.BAG)<o[0][1]?1:0},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(2,1002,!0))return!1;if(this.IsShowRed)return!0;for(var t=1;10>=t;t++)if(0==this.getCurUpStarState(t,1))return!0;return this.getMasterRed()?!0:!1},e.prototype.getUpStarLevelCount=function(t){for(var e=0,i=1;10>=i;i++)void 0!=this.upstarList[i]&&this.upstarList[i]>=t&&(e+=1);return e},e.prototype.getMinUpStarLevel=function(){for(var t=-1,e=1;10>=e;e++)t=-1==t?this.getUpStarByPart(e):Math.min(t,this.getUpStarByPart(e));return-1==t?0:t},e.prototype.getTotleUpStarLevel=function(){for(var t=0,e=1;10>=e;e++)void 0!=this.upstarList[e]&&(t+=this.upstarList[e]);return t},e.prototype.getCurStarPreAdd=function(t){var e=this.getUpStarByPart(t);return e>0?GlobalConfig.getUpstar_part_dataConfig(e).attr_per/100:0},e.prototype.getMasterRed=function(){var t=GlobalConfig.getUpstar_master_dataConfig(e.ins().master_level+1);if(void 0!=t){var i=e.ins().getUpStarLevelCount(t.star);if(i>=10)return!0}return!1},e.prototype.getMasterFight=function(){var t=e.ins().master_level,i=GlobalConfig.getUpstar_master_dataConfig(t);return UtilProxy.GetAttrFight(i)},e.prototype.getAllFightValue=function(){for(var t=0,e=1;10>=e;e++){var i=this.getUpStarByPart(e),n=GlobalConfig.getUpstar_part_dataConfig(i),o=BagProxy.ins().getBodyEquipByPart(e);if(n&&o){var s=o.itemConfig;t=t+UtilProxy.GetAttrFight(s,n.attr_per)-UtilProxy.GetAttrFight(s)}}return t+this.getMasterFight()},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27800,this.S2CRepUpstarGetInfo,this),MsgHandle.ins().regNetMsg(27801,this.S2CRepUpstarUpgrade,this),MsgHandle.ins().regNetMsg(27802,this.S2CRepUpstarUpgradeMaster,this)},e}(BaseSystem);__reflect(UpStarProxy.prototype,"UpStarProxy");var UtilProxy=function(t){function e(){var e=t.call(this)||this;return e.isOpenWelcomeView=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e,"shield",{get:function(){return (DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)},enumerable:!0,configurable:!0}),e.GetMovieClipById=function(t,e,i,n){void 0===i&&(i=!0),void 0==e&&(e=new eui.Group);var o=new egret.MovieClip,s=GlobalConfig.getTpl_effectConfigById(t);if(void 0!=s){var r="resource/assets/movie/ui_eff/"+s.path,a=s.loop;return this.GetMovieClip(r,o,a,function(t){o&&e.removeChild(o),n&&n()},i),e.addChild(o),o}},e.GetMovieClip=function(t,e,i,n,o,s,r){var a=this;if(void 0===o&&(o=!0),void 0===s&&(s=0),void 0===r&&(r=1),e){var h,l,p,c=t.split("/"),u=c.pop(),d=function(){if(h&&l){p=new egret.MovieClipDataFactory(h,l),e.movieClipData=p.generateMovieClipData(u),s>0&&(e.frameRate=s),e.gotoAndPlay(1,i),!o&&e.parent&&(e.parent.touchEnabled=!1,e.parent.touchChildren=!1);for(var t in h.res){h.res[t];break}e.scaleX=e.scaleY=r,e.addEventListener(egret.Event.COMPLETE,function(t){void 0!=n&&n()},a)}};RES.getResByUrl(t+".json",function(t){h=t,d()},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(t+".png",function(t){l=t,d()},this,RES.ResourceItem.TYPE_IMAGE)}},e.GetRoleObjectById=function(t,e,i,n,o){void 0===o&&(o=1);var s=RoleProxy.ins().GetOtherUIModel(t,o),r=RoleProxy.ins().GetOtherUIWing(e),a=RoleProxy.ins().GetOtherUIWeapon(i);return this.GetRoleObject(s,r,a,n,o)},e.GetRoleObject=function(t,e,i,n,o){if(void 0===o&&(o=1),void 0==n&&(n=new eui.Group),n.touchEnabled=!1,void 0!=e&&""!=e){var s=new egret.MovieClip;s.touchEnabled=!1,MovieClip.setUrl("resource/image/wing/"+e),this.GetMovieClip("resource/image/wing/"+e,s,-1,void 0),n.addChild(s)}if(void 0!=i&&""!=i){var r=new egret.MovieClip;r.touchEnabled=!1,MovieClip.setUrl("resource/image/weapon/"+i),this.GetMovieClip("resource/image/weapon/"+i,r,-1,void 0),n.addChild(r),2==o&&(r.x=r.x-8,r.y=r.y+8)}if(void 0!=t&&""!=t){var a=new egret.MovieClip;a.touchEnabled=!1,MovieClip.setUrl("resource/image/role/"+t),this.GetMovieClip("resource/image/role/"+t,a,-1,void 0),n.addChild(a)}return n},e.prototype.CheckCloseView=function(){ViewManager.ins().isShow(FubenView)&&ViewManager.ins().close(FubenView),ViewManager.ins().isShow(BossUIView)&&ViewManager.ins().close(BossUIView),ViewManager.ins().isShow(BossActView)&&ViewManager.ins().close(BossActView),ViewManager.ins().isShow(XiuXianView)&&ViewManager.ins().close(XiuXianView)},e.generateTextFlow=function(t){return TextFlowMaker.generateTextFlow(t)},e.StrFormart=function(t,e){for(var i=t,n=0;n<e.length;n++){var o=new RegExp("@"+n+" ","g");i=i.replace(o,e[n])}return TextFlowMaker.generateTextFlow(i)},e.StrFormartStr=function(t,e){for(var i=t,n=0;n<e.length;n++){var o=new RegExp("@"+n+" ","g");i=i.replace(o,e[n])}return i},e.getStr=function(t,e){for(var i=t,n=0;n<e.length;n++)i=i.replace("@"+n+" ",e[n]);return i},e.GetRandomNum=function(t,e){var i=e-t,n=Math.random();return t+Math.round(n*i)},e.changeNumToStr=function(t){return 10>t?"0"+String(t):String(t)},e.getHourStrByTime=function(t){var e="";return e+=this.changeNumToStr(Math.floor(t/3600)),e+="时",e+=this.changeNumToStr(Math.floor(t%3600/60)),e+="分",e+=this.changeNumToStr(Math.floor(t%60)),e+="秒"
},e.getTimeHMSString=function(t){if(0>=t)return"00：00：00";var e=Math.floor(t/3600)<10?"0"+Math.floor(t/3600).toString():Math.floor(t/3600).toString(),i=Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60).toString():Math.floor(t/60%60).toString(),n=Math.floor(t%60)<10?"0"+Math.floor(t%60).toString():Math.floor(t%60).toString();return e+"："+i+"："+n},e.getComponentState=function(t,e){t&&t.visible!=e&&(t.visible=e)},e.getTimeHMSString_1=function(t){if(0>=t)return"00：00";var e=Math.floor(t/60)<10?"0"+Math.floor(t/60).toString():Math.floor(t/60).toString(),i=Math.floor(t%60)<10?"0"+Math.floor(t%60).toString():Math.floor(t%60).toString();return e+"："+i},e.getTimeHSString_2=function(t){if(0>=t)return"00分00秒";var e=t/86400,i=(t-86400*Math.floor(e))/3600,n=(t-86400*Math.floor(e)-3600*Math.floor(i))/60,o=t%60,s=Math.floor(e)<10?"0"+Math.floor(e).toString():Math.floor(e).toString(),r=Math.floor(i)<10?"0"+Math.floor(i).toString():Math.floor(i).toString(),a=Math.floor(n)<10?"0"+Math.floor(n).toString():Math.floor(n).toString(),h=Math.floor(o)<10?"0"+Math.floor(o).toString():Math.floor(o).toString();return e>=1?s+"天"+r+"时":i>=1?r+"时"+a+"分":a+"分"+h+"秒"},e.getTimeStr=function(t){return 0>=t?"0秒":t>86400?Math.floor(t/86400)+"天"+Math.floor(t/3600%24)+"小时":t>3600?Math.floor(t/3600)+"小时"+Math.floor(t/60%60)+"分":Math.floor(t/60)+"分"+Math.floor(t%60)+"秒"},e.GetAttrFight=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=AttrProxy.getAttrValueInfo(t,e,i);return this.MathAttrFight(n)},e.MathAttrFight=function(t){var e=0;if(void 0==t)return 0;for(var i=42,n=0;i>n;++n)void 0==t[n]&&(t[n]=0);e+=t[FightAttr.HP]/25*5,e+=5*t[FightAttr.ATTACK],e+=5*t[FightAttr.DEFENCE],e+=5*t[FightAttr.POJIA],e+=5*t[FightAttr.MINGZHONG],e+=5*t[FightAttr.SHANBI],e+=t[FightAttr.HP]/25*5*(t[FightAttr.HP_PRE]/1e4),e+=t[FightAttr.BAOJI_HURT]*t[FightAttr.BAOJI_RATE]/1e4*5,e+=t[FightAttr.BAOJI_HURT]*t[FightAttr.KANG_BAOJI_RATE]/1e4*5,e+=5*t[FightAttr.BAOJI_HURT],e+=5*t[FightAttr.KANG_BAOJI_HURT],e+=t[FightAttr.BAOJI_HURT]*t[FightAttr.BAOJI_SUB_PRE]/1e4;var o=t[FightAttr.ATTACK]-(t[FightAttr.DEFENCE]-t[FightAttr.POJIA]);return e+=.5*o*t[FightAttr.GEDAND_RATE]/1e4*5,e+=.5*o*t[FightAttr.GEDAND_HURT_PRE]/1e4*5,e+=.5*o*t[FightAttr.POJI_RATE]/1e4*5,e+=o*t[FightAttr.HURT_ADD_PRE]/1e4*5,e+=o*t[FightAttr.HURT_SUB_PRE]/1e4*5,e+=5*t[FightAttr.INNER_HURT],e+=5*t[FightAttr.INNER_SUB_HURT],e+=5*t[FightAttr.OUTPUT_HURT],e+=5*t[FightAttr.OUTPUT_SUB_HURT],e+=o*t[FightAttr.PARTNER_HURT_PRE]/1e4,e+=5*t[FightAttr.SUCK_HP],e+=5*t[FightAttr.EXTRA_HURT],e+=t[FightAttr.ATTACK]*t[FightAttr.MINGZHONG_PRE]/1e4*5,e+=t[FightAttr.ATTACK]*t[FightAttr.SHANBI_PRE]/1e4*5*2,e+=t[FightAttr.ATTACK]*t[FightAttr.ZHONGJI_RATE]*5/1e4,e+=t[FightAttr.ATTACK]*t[FightAttr.KANG_ZHONGJI_RATE]*5/1e4,e+=2*o*t[FightAttr.HUIXIN_RATE]/1e4*5,e+=2*o*t[FightAttr.KANG_HUIXIN_RATE]/1e4*5,e+=2*o*t[FightAttr.LIANJI_RATE]/1e4*5,e+=5*o*t[FightAttr.QIANGJI_RATE]/1e4*5,e+=.5*o*t[FightAttr.HURT_REBOUND_PRE]/1e4*5*2,e+=t[FightAttr.ATTACK]*t[FightAttr.KANG_CONTROL_RATE]/1e4,Math.floor(e)},e.prototype.getMoneyAttrName=function(t){var e={1:"等级",2:"最大经验",3:"VIP等级",4:"VIP经验",5:"转",6:"元宝",7:"战斗力",8:"经验",9:"金币",10:"元宝",11:"真气值",12:"宗派勋章",13:"修为值",14:"声望",20:"boss精华"};return e[t]||""},e.getMoneyIcon=function(t){var e={8:"common_icon_EXP",9:"common_icon_jinbi",10:"common_icon_yuanvao",13:"common_icon_xiuwei"};return e[t]||""},e.leftTimeNextDay=function(){var t=new Date,e=86400,i=t.getHours(),n=t.getMinutes(),o=t.getSeconds();return e-60*i*60-60*n-o},e.getServerWeek=function(){var t=new Date(1e3*GameLogic.ins().getServerTime());return t.getUTCDay()},e.isTimeSpan=function(t){return t/1e9>1},e.getChangeTimeHSStr=function(t){return t/3600>1?t/3600+"小时":t/60+"分钟"},e.getShowImgPath=function(){return"resource/image/"},e.getShowMoviePath=function(){return"resource/assets/movie/"},e.GetItemCellData=function(t,e,i){void 0===i&&(i=!0);var n=new ItemCellData,o={item_slot_idx:0,item_type_id:t,item_count:e,is_tips:i};return n.setItemCellData(o),n},e.getPerDay=function(t,e){if(t>e)return-1;var i=new Date(1e3*t),n=i.getHours()-8,o=i.getMinutes(),s=i.getSeconds(),r=n*DateUtils.SECOND_PER_HOUR+o*DateUtils.SECOND_PER_MIN+s+(e-t),a=Math.ceil(r/86400);return a},e.openView=function(t,e){var i=GlobalConfig.getTplViewConfig(t);i?ViewManager.ins().open(i.name,e):TipsControl.ins().showTips("C:4&找不到界面id"+t)},e.getSimpleNum=function(t){var e=0;return t/1e8>=1?(e=Math.floor(t/1e7),e/10+"亿"):t/1e4>=1?(e=Math.floor(t/1e3),e/10+"万"):t.toString()},e.getfloorNum=function(t){var e=0;return t/1e8>=1?(e=Math.floor(t/1e8),e+"亿"):t/1e4>=1?(e=Math.floor(t/1e4),e+"万"):t.toString()},e.getNumLab=function(t,e){if(void 0===e&&(e=0),t>1e9){var i=Math.floor(t/1e8),n=Math.floor(t%1e8/1e4);return n>0?i+"亿"+n+"万":i+"亿"}if(t>1e5){var i=Math.floor(t/1e4*10)/10;return i+"万"}return e&&e>0?t.toFixed(e).toString():t.toString()},e.getFightNumLab=function(t){return t.toString()},e.getLevelAndZhuanStr=function(t,e){var i="",n=0,o=0;if(e>0){var s=GlobalConfig.getZhuanById(e);n=s.zhuan,o=s.lv}return i=0==e?t+"级":n+"转"},e.getZhuanStr=function(t){var e=GlobalConfig.getZhuanById(t);return e.zhuan+"转"+e.lv+"重"},e.getZhuanByLevel=function(t){var e=GlobalConfig.getZhuanById(t);return e?e.zhuan:0},e.prototype.getNumberLength=function(t){for(var e=1;t/10>=1;)e++,t/=10;return e},e.isOpenWelcome=function(){return LoginProxy.ins().isCreateRole&&!e.ins().isOpenWelcomeView?!0:!1},e.IsCanTranScene=function(){var t=GlobalConfig.getSceneConfigById(GameLogic.ins().getCurSceneId());return 1==t.scene_type?!0:!1},e.getTitleName=function(t){var e={"坐骑":"title_zuoqi","仙侣":"title_xianlv","灵宠":"title_lingchong","锁妖塔":"title_suoyaota","材料副本":"title_cailiaofuben","经验副本":"title_zuduifuben","剑心塔":"title_maijianzhong","称号":"title_chenghao","声望":"title_touxian","藏剑谷":"title_cangjiangu","邮件":"title_youjian","野外BOSS":"title_duorenBOSS","分解":"title_fenjie","跨服BOSS":"title_kuafuBOSS","合成":"title_hecheng","个人BOSS":"title_gerenBOSS","聊天":"title_liaotian","灵宝阁":"title_lingbaoge","秘境BOSS":"title_mijingBOSS","深渊BOSS":"title_shenyuanBOSS","天灵地宝":"title_tianlingdibao","阎罗神殿":"title_yanluoshendian","元宝商店":"title_yuanbaoshangdian","vip商店":"title_VIPshangdian","神秘商店":"title_shenmishangdian","限时BOSS":"title_xianshiBOSS","BOSS宝库":"title_BOSSbaoku","限时闯关":"title_xianshichuangguan","BOSS狂欢":"title_BOSSkuanghuan","全民冲级":"title_quanmingchongji","弑神宝库":"title_shishenBK","混沌宝库":"title_hundunBK","神农宝库":"title_shennongBK","玲珑宝库":"title_linglongBK","限购商店":"title_meizhoushangdian","宝物":"title_baowu","预告":"title_xitongyugao","异域BOSS":"title_yiyuboss","锁妖天榜":"title_suoyaotianbang","BOSS试炼":"title_qiriBOSS","擂台":"resource/skins/Leitai/title_luanwuleitai.png","VIP副本":"title_vipfuben","神魔禁地":"title_shenmojindi"};return e[t]||""},e.NumberDoubleLength=function(t){return 1==t.toString().length?"0"+t:t},e.CheckScreenchar=function(t,e){0==GlobalConfig.ins().screenchar.length&&GlobalConfig.getTpl_ScreencharConfigs();for(var i=0;i<GlobalConfig.ins().screenchar.length;++i){var n=GlobalConfig.ins().screenchar[i];if(t.indexOf(n)>=0)return void(e&&e(!1))}if(DeviceUtils.IsWx){var o={};o.content=t,o.success=function(){e&&e(!0)},o.fail=function(){e&&e(!1)},platform.checkScreenchar(o)}else e(!0)},e.CheckWeixingScreenchar=function(t,e){var i="https://api.weixin.qq.com/wxa/msg_sec_check",n=new egret.HttpRequest,o="access_token=87e5xc20vVAlkKmazagNU97AY-rde5A4Pq_bFygENWonPfZoBRdWemYtlaraPOts8omseAY-ISoawT7uXRbOXPiIJKWBo2NNNvGljlqKKG1DbeyP5boNxP4yze9o5l3vJsqYDDhL723EGV6Ub2F0NMIPJCWBCZ2llEqy6vPV9FzAoG0t8XIO2Ube6fLgS7lqzof1VDP6wSLtTFtbNs44baK8Nft9OPpCbCCv4k2jy6YzkXjzxNa4SDdXuAdDSZ2Fv-w_hR5R-3J20VEXf6PmXULtp6yX8fBloh9s&content="+t;n.responseType=egret.HttpResponseType.TEXT;var s=function(t){var i=!1;switch(t.type){case egret.Event.COMPLETE:var n=t.currentTarget,o=n.response,s=JSON.parse(o);s&&void 0!=s.errcode&&0==s.errcode&&(i=!0);break;case egret.IOErrorEvent.IO_ERROR:CommonUtils.log("字库返回错误")}e&&e(i)};n.open(i,egret.HttpMethod.POST),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(o),n.addEventListener(egret.Event.COMPLETE,s,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,s,this)},e.isEmojiCharacter=function(t){for(var e=0;e<t.length;e++){var i=t.charCodeAt(e);if(i>=55296&&56319>=i){if(t.length>1){var n=t.charCodeAt(e+1),o=1024*(i-55296)+(n-56320)+65536;if(o>=118784&&128895>=o)return!0}}else if(t.length>1){var n=t.charCodeAt(e+1);if(8419==n)return!0}else{if(i>=8448&&10239>=i)return!0;if(i>=11013&&11015>=i)return!0;if(i>=10548&&10549>=i)return!0;if(i>=12951&&12953>=i)return!0;if(169==i||174==i||12349==i||12336==i||11093==i||11036==i||11035==i||11088==i)return!0}}},e.CheckStrIsOk=function(t){var e=/^[a-zA-Z0-9\u4e00-\u9fa5]+$/;return e.test(t)?!0:!1},e.prototype.UseKnapsackByItemID=function(t){var e=BagProxy.ins().getItemData(t);if(void 0==e)return 0;for(var i=BagProxy.ins().bagModel[e.bag_type],n=0;n<i.length;n++)if(i[n].item_type_id==t){var o=[],s=[];s[0]=i[n].item_slot_idx,s[1]=i[n].item_count,o[0]=s,BagProxy.ins().C2SReqKnapsackUse(o);break}},e.SetAshColor=function(t,e){if(e){var i=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(i);t.filters=[n],t.touchEnabled=!1}else t.filters=void 0,t.touchEnabled=!0},e.log=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.showlog&&console.log.apply(console,[t].concat(e))},e.sortUpByLevel=function(t,e){return t.level>e.level?1:t.level<e.level?-1:0},e.getRealUrl=function(t){return SdkManager.ins().sdktype==SdkType.WJSDK&&(t=window.fsSdkObj.cdnUrl+t),SdkManager.ins().sdktype==SdkType.Quick||SdkManager.ins().sdktype==SdkType.CSJSDK?SdkManager.ins().cdnUrl+t:(CommonUtils.log("getRealUrl url = "+t),t)},e.isCurrentHide=!0,e.chatBitMark="② ",e.chatVipBitMark="①",e.isCloseXianFuView=!1,e.showlog=!1,e}(BaseClass);__reflect(UtilProxy.prototype,"UtilProxy");var VenationProxy=function(t){function e(){var e=t.call(this)||this;return e.red_list=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.updateRed=function(){for(var t=0;8>t;t++){var e=t+1;this.red_list[e]=this.getIdRed(e)}},e.prototype.getIdRed=function(t){var e=GrowupProxy.ins().getVenationlv(t),i=GlobalConfig.getVenation(t)[e+1];if(i){var n=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);if(n<i.need_zhuan)return!1;var o=RoleProxy.ins().getRoleLv();if(o<i.need_level)return!1;for(var s=0;s<i.currencys.length;s++){var r=i.currencys[s][0],a=i.currencys[s][1];if(RoleProxy.ins().getMoneyAttr(r)<a)return!1}return!0}return!1},e.prototype.getRedByID=function(t){return this.red_list[t]||!1},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(1,37,!0))return!1;for(var t=0;8>t;t++)if(this.getRedByID(t+1))return!0;return!1},e.prototype.getFightNum=function(){for(var t,e=0,i=0,n=0;8>n;n++)i=GrowupProxy.ins().getVenationlv(n+1),i>0&&(t=GlobalConfig.getVenation(n+1)[i],t&&(e+=UtilProxy.GetAttrFight(t)));return e},e}(BaseSystem);__reflect(VenationProxy.prototype,"VenationProxy");var GameSystem;!function(t){t.venationProxy=VenationProxy.ins.bind(VenationProxy)}(GameSystem||(GameSystem={}));var VIPProxy=function(t){function e(){var e=t.call(this)||this;return e.online_awards=[],e.online_time=0,e.egret_time=0,e.isOpenedView=!1,e._maxLevel=-1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(26001,this.S2CRepVipGiftData,this),MsgHandle.ins().regNetMsg(26003,this.S2CRepVipGetFreeGift,this),MsgHandle.ins().regNetMsg(26004,this.S2CRepVipGetDiscountGift,this),MsgHandle.ins().regNetMsg(26e3,this.S2CVipGetTimes,this),MsgHandle.ins().regNetMsg(26008,this.S2CRepVipGetOnlineAward,this),MsgHandle.ins().regNetMsg(26009,this.S2CRepVipGetChargeParam,this)},e.prototype.C2SReqVipGiftData=function(){var t=new net_protocol.C2SReqVipGiftData;this.sendPbPack(Msg.C2SReqVipGiftData,t,net_protocol.C2SReqVipGiftData)},e.prototype.C2SReqVipGetFreeGift=function(t){var e=new net_protocol.C2SReqVipGetFreeGift;e.level=t,this.sendPbPack(Msg.C2SReqVipGetFreeGift,e,net_protocol.C2SReqVipGetFreeGift)},e.prototype.C2SReqVipGetTimesList=function(){var t=new net_protocol.C2SReqVipGetTimesList;this.sendPbPack(Msg.C2SReqVipGetTimesList,t,net_protocol.C2SReqVipGetTimesList)},e.prototype.C2SReqVipGetOnlineAward=function(t){var e=new net_protocol.C2SReqVipGetOnlineAward;e.index=t,this.sendPbPack(Msg.C2SReqVipGetOnlineAward,e,net_protocol.C2SReqVipGetOnlineAward)},e.prototype.C2SReqVipGetDiscountGift=function(t){var e=new net_protocol.C2SReqVipGetDiscountGift;e.level=t,this.sendPbPack(Msg.C2SReqVipGetDiscountGift,e,net_protocol.C2SReqVipGetDiscountGift)},e.prototype.C2SReqVipGetChargeParam=function(t,e,i,n,o,s,r){var a=new net_protocol.C2SReqVipGetChargeParam;a.goods_id=t,a.fs_app_id=e,a.pay_money=i,a.sdk_name=n,a.extra_params=o,a.cp_ext=s,a.server_name=r,this.sendPbPack(Msg.C2SReqVipGetChargeParam,a,net_protocol.C2SReqVipGetChargeParam)},e.prototype.S2CRepVipGiftData=function(t){var e=net_protocol.S2CRepVipGiftData.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^S2CRepVipGiftData---------->",e),this.gift_list=e.gift_list,EventProxy.Broast(EventType.S2CRepVipGiftData,[])},e.prototype.S2CRepVipGetFreeGift=function(t){var e=net_protocol.S2CRepVipGetFreeGift.decode(t.bytes);if(CommonUtils.log("^^^^^^^^^^^^^S2CRepVipGetFreeGift---------->",e),NoticeProxy.ins().ErrCode(e.err_code)){var i=!1;if(this.gift_list)for(var n=0;n<this.gift_list.length;++n)this.gift_list[n].level==e.level&&(this.gift_list[n].has_free=!0,i=!0);else this.gift_list=[];i||this.gift_list.push({level:e.level,has_free:!0,has_discount:!1}),EventProxy.Broast(EventType.S2CRepVipGetFreeGift,[e.level])}},e.prototype.S2CRepVipGetDiscountGift=function(t){var e=net_protocol.S2CRepVipGetDiscountGift.decode(t.bytes);if(CommonUtils.log("^^^^^^^^^^^^^S2CRepVipGetDiscountGift---------->",e),NoticeProxy.ins().ErrCode(e.err_code)){var i=!1;if(this.gift_list)for(var n=0;n<this.gift_list.length;++n)this.gift_list[n].level==e.level&&(this.gift_list[n].has_discount=!0,i=!0);else this.gift_list=[];i||this.gift_list.push({level:e.level,has_free:!1,has_discount:!0}),EventProxy.Broast(EventType.S2CRepVipGetDiscountGift,[e.level])}},e.prototype.S2CVipGetTimes=function(t){var e=net_protocol.S2CVipGetTimes.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^S2CVipGetTimes---------->",e),this.online_awards=e.online_awards,this.setOnlineTime(e.online_time),EventProxy.Broast(EventType.S2CVipGetTimes,[])},e.prototype.S2CRepVipGetOnlineAward=function(t){var e=net_protocol.S2CRepVipGetOnlineAward.decode(t.bytes);CommonUtils.log("^^^^^^^^^^^^^S2CRepVipGetOnlineAward---------->",e),this.online_awards.push(e.index);var i=GlobalConfig.getVip_online_awardConfig(e.index);i&&i.open_view[0]&&i.open_view[0]>0&&UtilProxy.openView(i.open_view[0],i.open_view[1]),EventProxy.Broast(EventType.S2CRepVipGetOnlineAward,[])},e.prototype.S2CRepVipGetChargeParam=function(t){var e=net_protocol.S2CRepVipGetChargeParam.decode(t.bytes),i=JSON.parse(e.param);SdkManager.ins().sdktype==SdkType.QQ?platform.qqPay(i.prepay_id,i.pay_gold):SdkManager.ins().sdktype==SdkType.WJSDK&&window.fsSdkObj.JyFsSdk.pay(i)},e.prototype.getOnlineTime=function(){return this.online_time+Math.floor((egret.getTimer()-this.egret_time)/1e3)},e.prototype.setOnlineTime=function(t){this.online_time=t,this.egret_time=egret.getTimer()},e.prototype.IsOnlineAwardGet=function(t){for(var e=0;e<this.online_awards.length;e++)if(this.online_awards[e]==t)return!0;return!1},e.prototype.getCurOnlineAwardData=function(){if(!UtilProxy.shield){var t=GlobalConfig.getOnlineAwardConfigs();for(var e in t)if(!this.IsOnlineAwardGet(t[e].id))return t[e]}},e.prototype.isGetFreeGift=function(t){if(this.gift_list)for(var e=0;e<this.gift_list.length;++e)if(this.gift_list[e].level==t)return this.gift_list[e].has_free;return!1},e.prototype.isGetDiscountGift=function(t){if(this.gift_list)for(var e=0;e<this.gift_list.length;++e)if(this.gift_list[e].level==t)return this.gift_list[e].has_discount;return!1},e.prototype.isLastFreeGift=function(t){GlobalConfig.ins().vip_levelConfig||GlobalConfig.getConfig("vip_level","vip_levelConfig");var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);for(var i in GlobalConfig.ins().vip_levelConfig){var n=GlobalConfig.ins().vip_levelConfig[i];if(n.level>0&&e>=n.level&&t>n.level&&!this.isGetFreeGift(n.level))return!0}return!1},e.prototype.isHaveFreeGift=function(){GlobalConfig.ins().vip_levelConfig||GlobalConfig.getConfig("vip_level","vip_levelConfig");var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);for(var e in GlobalConfig.ins().vip_levelConfig){var i=GlobalConfig.ins().vip_levelConfig[e];if(i.level>0&&t>=i.level&&!this.isGetFreeGift(i.level))return!0}return!1},e.prototype.isHaveDiscountGift=function(){GlobalConfig.ins().vip_levelConfig||GlobalConfig.getConfig("vip_level","vip_levelConfig");var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);for(var e in GlobalConfig.ins().vip_levelConfig){var i=GlobalConfig.ins().vip_levelConfig[e];if(i.level>0&&t>=i.level&&!this.isGetDiscountGift(i.level))return!0}return!1},e.prototype.isNextFreeGift=function(t){GlobalConfig.ins().vip_levelConfig||GlobalConfig.getConfig("vip_level","vip_levelConfig");var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);for(var i in GlobalConfig.ins().vip_levelConfig){var n=GlobalConfig.ins().vip_levelConfig[i];if(n.level>0&&e>=n.level&&t<n.level&&!this.isGetFreeGift(n.level))return!0}return!1},e.prototype.getVipRed=function(){return this.isOpenedView?this.isHaveFreeGift():this.isHaveFreeGift()||this.isHaveDiscountGift()},e.prototype.GetNextFreeGift=function(t){GlobalConfig.ins().vip_levelConfig||GlobalConfig.getConfig("vip_level","vip_levelConfig");var e=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);for(var i in GlobalConfig.ins().vip_levelConfig){var n=GlobalConfig.ins().vip_levelConfig[i];if(n.level>0&&e>=n.level&&t<n.level&&!this.isGetFreeGift(n.level))return n.level}return 0},e.prototype.GetFirstFreeGift=function(){GlobalConfig.ins().vip_levelConfig||GlobalConfig.getConfig("vip_level","vip_levelConfig");var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL);for(var e in GlobalConfig.ins().vip_levelConfig){var i=GlobalConfig.ins().vip_levelConfig[e];if(i.level>0&&t>=i.level&&!this.isGetFreeGift(i.level))return i.level}return 0},e.prototype.getMaxLevel=function(){if(this._maxLevel<0){var t=GlobalConfig.getConfig("vip_level","vip_levelConfig");for(var e in t)this._maxLevel<t[e].level&&(this._maxLevel=t[e].level)}return this._maxLevel},e.prototype.getVipImg=function(t){return t?t>0&&4>=t?"common_icon_VIP_01":t>4&&8>=t?"common_icon_VIP_02":t>8&&12>=t?"common_icon_VIP_03":t>12&&15>=t?"common_icon_VIP_04":t>15?"common_icon_VIP_05":void 0:""},e}(BaseSystem);__reflect(VIPProxy.prototype,"VIPProxy");var WeaponType;!function(t){t[t.Weapon=1]="Weapon",t[t.XuanBing=2]="XuanBing",t[t.Wing=3]="Wing"}(WeaponType||(WeaponType={}));var WeaponProxy=function(t){function e(){var e=t.call(this)||this;return e.info_list=[],e.book_list=[],e.id_list=[],e.fight_list=[],e.limit_list=[],e.red_list=[],e.dir_list=[UI_WEAPON_DIR,UI_XUANBING_DIR,UI_WING_DIR],e.lvUpType=[LvUpType.emSB,LvUpType.emXB,LvUpType.emWing],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqWeaponGetInfo=function(){var t=new net_protocol.C2SReqWeaponGetInfo;this.sendPbPack(Msg.C2SReqWeaponGetInfo,t,net_protocol.C2SReqWeaponGetInfo)},e.prototype.C2SReqWeaponSingleUpgrade=function(t,e){var i=new net_protocol.C2SReqWeaponSingleUpgrade;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqWeaponSingleUpgrade,i,net_protocol.C2SReqWeaponSingleUpgrade)},e.prototype.C2SReqWeaponBookUpgrade=function(t,e){var i=new net_protocol.C2SReqWeaponBookUpgrade;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqWeaponBookUpgrade,i,net_protocol.C2SReqWeaponBookUpgrade)},e.prototype.C2SReqWeaponSwallow=function(t,e,i){var n=new net_protocol.C2SReqWeaponSwallow;n.type=t,n.id=e,n.opt=i,this.sendPbPack(Msg.C2SReqWeaponSwallow,n,net_protocol.C2SReqWeaponSwallow)},e.prototype.C2SReqWeaponChangeHuaxing=function(t,e){var i=new net_protocol.C2SReqWeaponChangeHuaxing;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqWeaponChangeHuaxing,i,net_protocol.C2SReqWeaponChangeHuaxing)},e.prototype.C2SReqWeaponSingleUpgradeExtend=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=new net_protocol.C2SReqWeaponSingleUpgradeExtend;o.type=t,o.id=e,1==i&&(o.opt=i,o.index=n),this.sendPbPack(Msg.C2SReqWeaponSingleUpgradeExtend,o,net_protocol.C2SReqWeaponSingleUpgradeExtend)},e.prototype.S2CRepWeaponGetInfo=function(t){var e=net_protocol.S2CRepWeaponGetInfo.decode(t.bytes);this.info_list=[],this.book_list=[],this.id_list=[],this.limit_list=[],e.shenbing.huaxing>0&&(RoleProxy.ins().setWeaponId(e.shenbing.huaxing),GameMap.centerEntity&&GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.shenbing.huaxing,AvatarType.SHENBING)),e.wing.huaxing>0&&(RoleProxy.ins().setWingId(e.wing.huaxing),GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.wing.huaxing,AvatarType.WING));var i=[e.shenbing,e.xuanbing,e.wing];this.fight_list=[];for(var n=0;n<i.length;n++){if(this.info_list[n+1]=[],this.book_list[n+1]=[],this.limit_list[n+1]=[],i[n]){this.id_list[n+1]=i[n].huaxing,this.fight_list[n]=0;for(var o=0;o<i[n].list.length;o++){var s=i[n].list[o];if(this.info_list[n+1][s.id]=s,s.level>0){var r=this.getBaseById(n+1,s.id,s.level);r&&(this.fight_list[n]+=UtilProxy.GetAttrFight(r))}}for(var o=0;o<i[n].book_list.length;o++){var s=i[n].book_list[o];this.book_list[n+1][s.id]=s}for(var o=0;o<i[n].limit_list.length;o++){var s=i[n].limit_list[o];this.limit_list[n+1].push({type:n+1,id:s.id,end_time:s.end_time})}}this.red_list[n+1]=this.getPrivateRedByPage(n+1)}EventProxy.Broast(EventType.updateWeaponRed,[]),EventProxy.Broast(EventType.S2CRepWeaponGetInfo,[]),EventProxy.Broast(EventType.UpdateTaozhuangRed,[])},e.prototype.S2CRepWeaponSingleUpgrade=function(t){var e=net_protocol.S2CRepWeaponSingleUpgrade.decode(t.bytes);this.info_list[e.type]||(this.info_list[e.type]=[]),this.info_list[e.type][e.id]||(this.info_list[e.type][e.id]={}),this.info_list[e.type][e.id].id=e.id,this.info_list[e.type][e.id].level=e.level,this.fight_list||(this.fight_list=[]),this.fight_list[e.type]=0;for(var i in this.info_list[e.type]){var n=this.info_list[e.type][i];if(n){var o=this.getBaseById(e.type,n.id,n.level);o&&(this.fight_list[e.type]+=UtilProxy.GetAttrFight(o))}}XiuXianProxy.ins().updateAchieRed(AchieType.wing_star),XiuXianProxy.ins().updateAchieRed(AchieType.xubing_star),XiuXianProxy.ins().updateAchieRed(AchieType.weapon_star),this.red_list[e.type]=this.getPrivateRedByPage(e.type),EventProxy.Broast(EventType.updateWeaponRed,[]),EventProxy.Broast(EventType.S2CRepWeaponSingleUpgrade,[e.type]),EventProxy.Broast(EventType.UpdateTaozhuangRed,[])},e.prototype.S2CRepWeaponBookUpgrade=function(t){var e=net_protocol.S2CRepWeaponBookUpgrade.decode(t.bytes);this.book_list[e.type]||(this.book_list[e.type]=[]),this.book_list[e.type][e.id]||(this.book_list[e.type][e.id]={}),this.book_list[e.type][e.id].id=e.id,this.book_list[e.type][e.id].level=e.level,this.red_list[e.type]=this.getPrivateRedByPage(e.type),XiuXianProxy.ins().updateAchieRed(AchieType.weapon_list),EventProxy.Broast(EventType.updateWeaponRed,[]),EventProxy.Broast(EventType.S2CRepWeaponBookUpgrade,[e.type])},e.prototype.S2CRepWeaponSwallow=function(t){var e=net_protocol.S2CRepWeaponSwallow.decode(t.bytes);this.info_list[e.type]||(this.info_list[e.type]=[]),this.info_list[e.type][e.id]||(this.info_list[e.type][e.id]={}),this.info_list[e.type][e.id].id=e.id,this.info_list[e.type][e.id].swallow=e.swallow,this.red_list[e.type]=this.getPrivateRedByPage(e.type),EventProxy.Broast(EventType.updateWeaponRed,[]),EventProxy.Broast(EventType.S2CRepWeaponSwallow,[e.type])},e.prototype.S2CRepWeaponChangeHuaxing=function(t){var e=net_protocol.S2CRepWeaponChangeHuaxing.decode(t.bytes);this.id_list[e.type]=e.id,e.id>0&&(1==e.type?e.id&&(RoleProxy.ins().setWeaponId(e.id),GameMap.centerEntity&&GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.id,AvatarType.SHENBING)):3==e.type&&e.id>0&&(RoleProxy.ins().setWingId(e.id),GameMap.centerEntity&&GameLogic.ins().changeAvatar(GameMap.centerEntity.handle,e.id,AvatarType.WING))),EventProxy.Broast(EventType.updateWeaponRed,[]),EventProxy.Broast(EventType.S2CRepWeaponChangeHuaxing,[e.type])},e.prototype.S2CRepWeaponSingleUpgradeExtend=function(t){var i=net_protocol.S2CRepWeaponSingleUpgradeExtend.decode(t.bytes);if(this.info_list[i.type]||(this.info_list=[]),0==this.getLv2(i.type,i.id)&&1==i.level2){var n=e.ins().getResById(i.type,i.id),o=this.dir_list[i.type-1]+n.ui_model;ViewManager.ins().open(JihuoTipsView,i.type+1,0,o)}this.info_list[i.type][i.id]?(this.info_list[i.type][i.id].level=i.level,this.info_list[i.type][i.id].level2=i.level2):this.info_list[i.type][i.id]={type:i.type,id:i.id,level:i.level,level2:i.level2};var s=BagProxy.ins().GetLVUpItem(this.lvUpType[i.type-1],i.level2);if(s){var r=s.itemConfig;r.flags<=i.level2&&ViewManager.ins().open(ItemTipsView,s,!0,[this.lvUpType[i.type-1],i.id])}this.red_list[i.type]=this.getPrivateRedByPage(i.type),EventProxy.Broast(EventType.updateWeaponRed,[]),EventProxy.Broast(EventType.S2CRepWeaponSingleUpgradeExtend,[i.type]),EventProxy.Broast(EventType.UpdateTaozhuangRed,[])},e.prototype.S2CRepWeaponAddTimeLimitItem=function(t){var e=net_protocol.S2CRepWeaponAddTimeLimitItem.decode(t.bytes);this.limit_list[e.type]||(this.limit_list[e.type]=[]),this.limit_list[e.type].push({type:e.type,id:e.id,end_time:e.end_time}),EventProxy.Broast(EventType.S2CRepWeaponAddTimeLimitItem,[e.type])},e.prototype.S2CRepWeaponDelTimeLimitItem=function(t){var e=net_protocol.S2CRepWeaponDelTimeLimitItem.decode(t.bytes);if(this.limit_list[e.type])for(var i=0;i<this.limit_list[e.type].length;i++){var n=this.limit_list[e.type][i];if(n.type==e.type&&n.id==e.id){this.limit_list[e.type].splice(i,1);break}}EventProxy.Broast(EventType.S2CRepWeaponDelTimeLimitItem,[e.type])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(28050,this.S2CRepWeaponGetInfo,this),MsgHandle.ins().regNetMsg(28051,this.S2CRepWeaponSingleUpgrade,this),MsgHandle.ins().regNetMsg(28052,this.S2CRepWeaponBookUpgrade,this),MsgHandle.ins().regNetMsg(28053,this.S2CRepWeaponSwallow,this),MsgHandle.ins().regNetMsg(28054,this.S2CRepWeaponChangeHuaxing,this),MsgHandle.ins().regNetMsg(28055,this.S2CRepWeaponSingleUpgradeExtend,this),MsgHandle.ins().regNetMsg(28056,this.S2CRepWeaponAddTimeLimitItem,this),MsgHandle.ins().regNetMsg(28057,this.S2CRepWeaponDelTimeLimitItem,this)},e.prototype.getlimitlist=function(t){return this.limit_list[t]||[]},e.prototype.getlimitById=function(t,e){var i=this.limit_list[t];if(i)for(var n=0;n<i.length;n++){var o=i[n];if(o.type==t&&o.id==e)return o}return null},e.prototype.getLv=function(t,e){var i=this.getResById(t,e);return i&&1==i.is_limit?1:this.info_list&&this.info_list[t]&&this.info_list[t][e]?this.info_list[t][e].level||0:0},e.prototype.getLv2=function(t,e){return this.info_list&&this.info_list[t]&&this.info_list[t][e]?this.info_list[t][e].level2||0:0},e.prototype.getSwallowNum=function(t,e){return this.info_list[t]&&this.info_list[t][e]?this.info_list[t][e].swallow||0:0},e.prototype.getBookLv=function(t,e){return this.book_list[t]&&this.book_list[t][e]?this.book_list[t][e].level:0},e.prototype.getSwallow=function(t,e){return this.info_list[t]&&this.info_list[t][e]?this.info_list[t][e].swallow:0},e.prototype.getDressId=function(t){return this.id_list?this.id_list[t]||0:0},e.prototype.getRed=function(){for(var t=1;4>t;t++)if(this.getRedByPage(t))return!0;return!1},e.prototype.getRedByPage=function(t){return this.red_list[t]||!1},e.prototype.getPrivateRedByPage=function(t){var e=this.getResList(t);for(var i in e)if(this.getRedById(t,parseInt(i)))return!0;return!1},e.prototype.getBookRedByType=function(t){var e=this.getTypeList(t);for(var i in e)if(parseInt(i)>0&&this.getRedByBookId(t,parseInt(i)))return!0;return!1},e.prototype.getRedByMenuId=function(t,e){var i=this.getResListByMenuId(t,e);for(var n in i)if(this.getRedById(t,i[parseInt(n)].id))return!0;return!1},e.prototype.getRedByBookId=function(t,e){var i=this.getBookLv(t,e),n=this.getBookById(t,e,i+1);if(n){for(var o=0;o<n.book_list.length;o++){var s=n.book_list[o];if(this.getLv(t,s[0])<s[1]||BagProxy.ins().getItemCountById(n.item[0])<n.item[1])return!1}return!0}return!1},e.prototype.getRedBySid=function(t,e){var i=this.getLv(t,e),n=this.getSwallowById(t,e,i);if(n){var o=n.max_swallow[0],s=n.max_swallow[1],r=this.getSwallowNum(t,e);return s>r&&BagProxy.ins().getItemCountById(o)>0}return!1},e.prototype.getRedById=function(t,e){return this.getSjRedById(t,e)||this.getSqRedById(t,e)||this.getRedBySid(t,e)},e.prototype.getSqRedById=function(t,e){var i=this.getLv(t,e),n=this.getBaseById(t,e,i+1);if(n){var o=n.item[0],s=n.item[1],r=BagProxy.ins().getItemCountById(o);if(i>0){var a=this.getRepleaceItemInfo(t,e,i+1);if(a&&a.id>0&&a.num>=s)return!0}return r>=s}return!1},e.prototype.getSjRedById=function(t,e){var i=this.getLv2(t,e),n=this.getGrowUpByIdAndLv(t,e,i+1);if(n){var o=n.item[0],s=n.item[1],r=BagProxy.ins().getItemCountById(o);return r>=s}return!1},e.prototype.updatePageRed=function(){this.red_list||(this.red_list=[]);for(var t=0;3>t;t++)this.red_list[t+1]=this.getPrivateRedByPage(t+1);EventProxy.Broast(EventType.updateWeaponRed,[])},e.prototype.getXuanBingTzNum=function(){var t=0,e=2,i=this.getTypeList(e);for(var n in i){var o=parseInt(n);this.getBookLv(e,o)>0&&(t+=1)}return t},e.prototype.getActiveByStarAndType=function(t,e){var i=0,n=this.info_list[t];if(n)for(var o in n){var s=n[o];if(s){var r=this.getBaseById(t,s.id,1);if(r){var a=BagProxy.ins().getItemData(r.item[0]);a&&a.star>=e&&(i+=1)}}}return i},e.prototype.getRepleaceItemInfo=function(t,e,i){var n=this.getMiscByTypeId(t),o=this.getBaseById(t,e,i),s=0;if(o){var r=o.item,a=0;if(r.length>0){var h=BagProxy.ins().getItemData(r[0]);h&&(a=h.star)}for(var l in n.star_list)if(n.star_list[l]==a){s=n.item_id;break}}return s>0?{id:s,num:BagProxy.ins().getItemCountById(s)}:{id:0,num:0}},e.prototype.getResListByMenuId=function(t,e){if(this.wpList||(this.wpList=[]),!this.wpList[t]){this.wpList[t]=[];var i=this.getResList(t);for(var n in i){var o=i[n];this.wpList[t][o.type]||(this.wpList[t][o.type]=[]),this.wpList[t][o.type].push(o)}}return this.wpList[t][e]},e.prototype.getResList=function(t){var e=GlobalConfig.getWeaponResList();return t==WeaponType.XuanBing?e=GlobalConfig.getXuanBingResList():t==WeaponType.Wing&&(e=GlobalConfig.getWingResList()),e},e.prototype.getTypeList=function(t){var e=GlobalConfig.getWeaponTypeList();return t==WeaponType.XuanBing?e=GlobalConfig.getXuanBingTypeList():t==WeaponType.Wing&&(e=GlobalConfig.getWingTypeList()),e},e.prototype.getBaseById=function(t,e,i){var n=GlobalConfig.getWeaponBaseById(e,i);return t==WeaponType.XuanBing?n=GlobalConfig.getXuanBingBaseById(e,i):t==WeaponType.Wing&&(n=GlobalConfig.getWingBaseById(e,i)),n},e.prototype.getSwallowById=function(t,e,i){var n=GlobalConfig.getWeaponSwallowById(e,i);return t==WeaponType.XuanBing?n=GlobalConfig.getXuanBingSwallowById(e,i):t==WeaponType.Wing&&(n=GlobalConfig.getWingSwallowById(e,i)),n},e.prototype.getDanById=function(t,e){var i=GlobalConfig.getWeaponDanById(e);return t==WeaponType.XuanBing?i=GlobalConfig.getXuanBingDanById(e):t==WeaponType.Wing&&(i=GlobalConfig.getWingDanById(e)),i},e.prototype.getBookById=function(t,e,i){var n;return t==WeaponType.Weapon?n=GlobalConfig.getWeaponBookById(e,i):t==WeaponType.XuanBing?n=GlobalConfig.getXuanBingBookById(e,i):t==WeaponType.Wing&&(n=GlobalConfig.getWingBookById(e,i)),n},e.prototype.getResById=function(t,e){var i;return t==WeaponType.Weapon?i=GlobalConfig.getWeaponResById(e):t==WeaponType.XuanBing?i=GlobalConfig.getXuanBingResById(e):t==WeaponType.Wing&&(i=GlobalConfig.getWingResById(e)),i},e.prototype.getTypeConfigById=function(t,e){var i=GlobalConfig.getWeaponTypeById(e);return t==WeaponType.XuanBing?i=GlobalConfig.getXuanBingTypeById(e):t==WeaponType.Wing&&(i=GlobalConfig.getWingTypeById(e)),i},e.prototype.getMiscByTypeId=function(t){var e=GlobalConfig.getWeaponMisc();
return t==WeaponType.XuanBing?e=GlobalConfig.getXuanBingMisc():t==WeaponType.Wing&&(e=GlobalConfig.getWingMisc()),e},e.prototype.getWingMaxLv=function(){var t=0,e=0,i=3,n=this.getResList(i);for(var o in n)e=this.getLv(i,parseInt(o)),e>t&&(t=e);return t},e.prototype.getItemRedList=function(){return this.item_red_list||(this.item_red_list={}),this.item_red_list},e.prototype.getFight=function(t){return this.fight_list?this.fight_list[t-1]||0:0},e.prototype.getGrowUpList=function(t){var e=GlobalConfig.getWeaponGrowList();return t==WeaponType.XuanBing?e=GlobalConfig.getXuanBingGrowList():t==WeaponType.Wing&&(e=GlobalConfig.getWingGrowList()),e},e.prototype.getGrowUpByIdAndLv=function(t,e,i){var n=GlobalConfig.getWeaponGrowById(e,i);return t==WeaponType.XuanBing?n=GlobalConfig.getXuanBingGrowById(e,i):t==WeaponType.Wing&&(n=GlobalConfig.getWingGrowById(e,i)),n},e}(BaseSystem);__reflect(WeaponProxy.prototype,"WeaponProxy");var WelfareItemData=function(){function t(){}return t.prototype.setData=function(t,e){this.id=e,this.type=t,1==t?this.config=GlobalConfig.getOnline_awardConfig(e):2==t&&(this.config=GlobalConfig.getWeek_card_awardConfig(e))},t}();__reflect(WelfareItemData.prototype,"WelfareItemData");var WelfareProxy=function(t){function e(){var e=t.call(this)||this;return e.login_award_count=7,e.signin_count=20,e.week_car_award_count=7,e.online_award_count=0,e.is_online_award=!1,e.free_gift=[],e.invenst_list=[],e.award_list=[],e.record_list=[],e.isInit=!1,e.IsShowSuperTips=!1,e.login_online_awards=[],e.OpenTopTime=0,e.IsShare=!1,e.share_days=0,e.today_share=!1,e.share_acc_awards=[],e.is_top=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(26550,this.S2CRspWelfareGetInfo,this),MsgHandle.ins().regNetMsg(26551,this.S2CRspWelfareGetLoginAward,this),MsgHandle.ins().regNetMsg(26552,this.S2CRspWelfareSignin,this),MsgHandle.ins().regNetMsg(26553,this.S2CRspWelfareSigninRedeem,this),MsgHandle.ins().regNetMsg(26554,this.S2CRspWelfareGetOnlineAward,this),MsgHandle.ins().regNetMsg(26555,this.S2CRspWelfareGetWeekCardAward,this),MsgHandle.ins().regNetMsg(26556,this.S2CRepWelfareCdkeyGiftBag,this),MsgHandle.ins().regNetMsg(26557,this.S2CRspWelfareGetSystemAward,this),MsgHandle.ins().regNetMsg(26558,this.S2CRspWelfareGetMillionAward,this),MsgHandle.ins().regNetMsg(26559,this.S2CRspWelfareGetSevenDayAward,this),MsgHandle.ins().regNetMsg(26563,this.S2CRspWelfareFreegiftBuy,this),MsgHandle.ins().regNetMsg(26564,this.S2CRspWelfareFreegiftGetAward,this),MsgHandle.ins().regNetMsg(26560,this.S2CRspWelfareInvenstGetInfo,this),MsgHandle.ins().regNetMsg(26561,this.S2CRspWelfareInvenstBuy,this),MsgHandle.ins().regNetMsg(26562,this.S2CRspWelfareInvenstGetAward,this),MsgHandle.ins().regNetMsg(26565,this.S2CRspWelfareLoginOnlineAward,this),MsgHandle.ins().regNetMsg(26566,this.S2CRspWelfareTopShareAward,this)},e.prototype.C2SReqWelfareGetInfo=function(){var t=new net_protocol.C2SReqWelfareGetInfo;CommonUtils.log("^^--++--^^---C2SReqWelfareGetInfo"),this.sendPbPack(Msg.C2SReqWelfareGetInfo,t,net_protocol.C2SReqWelfareGetInfo)},e.prototype.C2SReqWelfareGetLoginAward=function(t){var e=new net_protocol.C2SReqWelfareGetLoginAward;e.index=t,CommonUtils.log("^^--++--^^---C2SReqWelfareGetLoginAward",t),this.sendPbPack(Msg.C2SReqWelfareGetLoginAward,e,net_protocol.C2SReqWelfareGetLoginAward)},e.prototype.C2SReqWelfareSignin=function(){var t=new net_protocol.C2SReqWelfareSignin;CommonUtils.log("^^--++--^^---C2SReqWelfareSignin"),this.sendPbPack(Msg.C2SReqWelfareSignin,t,net_protocol.C2SReqWelfareSignin)},e.prototype.C2SReqWelfareSigninRedeem=function(){var t=new net_protocol.C2SReqWelfareSigninRedeem;CommonUtils.log("^^--++--^^---C2SReqWelfareSigninRedeem"),this.sendPbPack(Msg.C2SReqWelfareSigninRedeem,t,net_protocol.C2SReqWelfareSigninRedeem)},e.prototype.C2SReqWelfareGetOnlineAward=function(t){var e=new net_protocol.C2SReqWelfareGetOnlineAward;e.index=t,CommonUtils.log("^^--++--^^---C2SReqWelfareGetOnlineAward",e),this.sendPbPack(Msg.C2SReqWelfareGetOnlineAward,e,net_protocol.C2SReqWelfareGetOnlineAward)},e.prototype.C2SReqWelfareGetWeekCardAward=function(t){var e=new net_protocol.C2SReqWelfareGetWeekCardAward;e.index=t,CommonUtils.log("^^--++--^^---C2SReqWelfareGetWeekCardAward",e),this.sendPbPack(Msg.C2SReqWelfareGetWeekCardAward,e,net_protocol.C2SReqWelfareGetWeekCardAward)},e.prototype.C2SReqWelfareCdkeyGiftBag=function(t){var e=new net_protocol.C2SReqWelfareCdkeyGiftBag;e.cdkey=t,CommonUtils.log("^^--++--^^---C2SReqWelfareCdkeyGiftBag",e),this.sendPbPack(Msg.C2SReqWelfareCdkeyGiftBag,e,net_protocol.C2SReqWelfareCdkeyGiftBag)},e.prototype.C2SReqWelfareGetSystemAward=function(t){var e=new net_protocol.C2SReqWelfareGetSystemAward;e.id=t,CommonUtils.log("^^--++--^^---C2SReqWelfareGetSystemAward",e),this.sendPbPack(Msg.C2SReqWelfareGetSystemAward,e,net_protocol.C2SReqWelfareGetSystemAward)},e.prototype.C2SReqWelfareGetMillionAward=function(t){var e=new net_protocol.C2SReqWelfareGetMillionAward;e.id=t,CommonUtils.log("^^--++--^^---C2SReqWelfareGetMillionAward",e),this.sendPbPack(Msg.C2SReqWelfareGetMillionAward,e,net_protocol.C2SReqWelfareGetMillionAward)},e.prototype.C2SReqWelfareGetSevenDayAward=function(t){var e=new net_protocol.C2SReqWelfareGetSevenDayAward;e.id=t,CommonUtils.log("^^--++--^^---C2SReqWelfareGetMillionAward",e),this.sendPbPack(Msg.C2SReqWelfareGetSevenDayAward,e,net_protocol.C2SReqWelfareGetSevenDayAward)},e.prototype.C2SReqWelfareFreegiftBuy=function(t){var e=new net_protocol.C2SReqWelfareFreegiftBuy;e.type=t,CommonUtils.log("--------C2SReqWelfareFreegiftBuy",e),this.sendPbPack(Msg.C2SReqWelfareFreegiftBuy,e,net_protocol.C2SReqWelfareFreegiftBuy)},e.prototype.C2SReqWelfareFreegiftGetAward=function(t){var e=new net_protocol.C2SReqWelfareFreegiftGetAward;e.type=t,CommonUtils.log("--------C2SReqWelfareFreegiftGetAward",e),this.sendPbPack(Msg.C2SReqWelfareFreegiftGetAward,e,net_protocol.C2SReqWelfareFreegiftGetAward)},e.prototype.C2SReqWelfareInvenstGetInfo=function(){var t=new net_protocol.C2SReqWelfareInvenstGetInfo;this.sendPbPack(Msg.C2SReqWelfareInvenstGetInfo,t,net_protocol.C2SReqWelfareInvenstGetInfo)},e.prototype.C2SReqWelfareInvenstBuy=function(t){var e=new net_protocol.C2SReqWelfareInvenstBuy;e.type=t,this.sendPbPack(Msg.C2SReqWelfareInvenstBuy,e,net_protocol.C2SReqWelfareInvenstBuy)},e.prototype.C2SReqWelfareInvenstGetAward=function(t,e){var i=new net_protocol.C2SReqWelfareInvenstGetAward;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqWelfareInvenstGetAward,i,net_protocol.C2SReqWelfareInvenstGetAward)},e.prototype.C2SReqWelfareLoginOnlineAward=function(t){var e=new net_protocol.C2SReqWelfareLoginOnlineAward;e.day=t,this.sendPbPack(Msg.C2SReqWelfareLoginOnlineAward,e,net_protocol.C2SReqWelfareLoginOnlineAward)},e.prototype.C2SReqWelfareTopShareAward=function(t,e){var i=new net_protocol.C2SReqWelfareTopShareAward;i.type=t,i.index=e,this.sendPbPack(Msg.C2SReqWelfareTopShareAward,i,net_protocol.C2SReqWelfareTopShareAward)},e.prototype.S2CRspWelfareGetInfo=function(t){var e=net_protocol.S2CRspWelfareGetInfo.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareGetInfo",e),this.initConfig(),this.isInit=!0,this.signin_state=e.signin_state,this.is_open_week_card=e.is_open_week_card,this.signin_times=e.signin_times,this.start_signin_time=e.start_signin_time,this.login_days=e.login_days,this.online_awards=e.online_awards,this.login_awards=e.login_awards,this.week_card_awards=e.week_card_awards,this.gift_list=e.gift_list,this.system_awards=e.system_awards,this.online=e.online,this.million_awards=e.million_awards,this.seven_day_awards=e.seven_day_awards,this.free_gift=e.free_gift,this.is_top=e.is_top,this.share_days=e.share_days,this.today_share=e.today_share,this.share_acc_awards=e.share_acc_awards,this.IsShare=!1,this.setOnlineAwardCount(),this.server_time=GameLogic.ins().getServerTime(),this.login_online_awards=e.login_online_awards,TimerManager.ins().doTimer(1e3,0,this.UpDateOnline,this),EventProxy.Broast(EventType.S2CRspWelfareGetInfo,[]),EventProxy.Broast(EventType.RefreshWelfareRed,[])},e.prototype.S2CRspWelfareGetLoginAward=function(t){var e=net_protocol.S2CRspWelfareGetLoginAward.decode(t.bytes);if(CommonUtils.log("^^--++--^^---S2CRspWelfareGetLoginAward",e),void 0==this.login_awards)this.login_awards=[],this.login_awards.push({index:e.index,state:2});else for(var i=0;i<this.login_awards.length;++i)this.login_awards[i].index==e.index&&(this.login_awards[i].state=2);EventProxy.Broast(EventType.S2CRspWelfareGetLoginAward,[]),EventProxy.Broast(EventType.RefreshWelfareRed,[])},e.prototype.S2CRspWelfareSignin=function(t){var e=net_protocol.S2CRspWelfareSignin.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareSignin",e),this.signin_state=!0,this.signin_times=this.signin_times+1,EventProxy.Broast(EventType.S2CRspWelfareSignin,[]),EventProxy.Broast(EventType.RefreshWelfareRed,[])},e.prototype.S2CRspWelfareSigninRedeem=function(t){var e=net_protocol.S2CRspWelfareSigninRedeem.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareSigninRedeem",e),this.signin_times=this.signin_times+1,EventProxy.Broast(EventType.S2CRspWelfareSigninRedeem,[]),EventProxy.Broast(EventType.RefreshWelfareRed,[])},e.prototype.S2CRspWelfareGetOnlineAward=function(t){var e=net_protocol.S2CRspWelfareGetOnlineAward.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareGetOnlineAward",e),void 0==this.online_awards&&(this.online_awards=[]),this.online_awards.push(e.index),this.SetOnlineState(),EventProxy.Broast(EventType.S2CRspWelfareGetOnlineAward,[e.index]),EventProxy.Broast(EventType.RefreshWelfareRed,[])},e.prototype.S2CRspWelfareGetWeekCardAward=function(t){var e=net_protocol.S2CRspWelfareGetWeekCardAward.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareGetWeekCardAward",e),void 0==this.week_card_awards&&(this.week_card_awards=[]);for(var i=0;i<this.week_card_awards.length;++i)this.week_card_awards[i].index==e.index&&(this.week_card_awards[i].state=2);EventProxy.Broast(EventType.S2CRspWelfareGetWeekCardAward,[e.index]),EventProxy.Broast(EventType.RefreshWelfareRed,[])},e.prototype.S2CRepWelfareCdkeyGiftBag=function(t){var e=net_protocol.S2CRepWelfareCdkeyGiftBag.decode(t.bytes);if(CommonUtils.log("^^--++--^^---S2CRepWelfareCdkeyGiftBag",e),0==e.result){TipsControl.ins().showTips("兑换成功");e.items;EventProxy.Broast(EventType.S2CRepWelfareCdkeyGiftBag,[])}else 1==e.result?TipsControl.ins().showTips("已使用"):2==e.result?TipsControl.ins().showTips("错误兑换码"):3==e.result?TipsControl.ins().showTips("平台错误"):4==e.result?TipsControl.ins().showTips("服务器错误"):5==e.result?TipsControl.ins().showTips("兑换码已过期"):6==e.result&&TipsControl.ins().showTips("该批次已经使用")},e.prototype.S2CRspWelfareGetSystemAward=function(t){var e=net_protocol.S2CRspWelfareGetSystemAward.decode(t.bytes);CommonUtils.log("S2CRspWelfareGetSystemAward",e),void 0==this.system_awards&&(this.system_awards=[]),this.system_awards.push(e.id),EventProxy.Broast(EventType.S2CRspWelfareGetSystemAward,[])},e.prototype.S2CRspWelfareGetMillionAward=function(t){var e=net_protocol.S2CRspWelfareGetMillionAward.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareGetMillionAward",e),void 0==this.million_awards&&(this.million_awards=[]),this.million_awards.push(e.id),EventProxy.Broast(EventType.S2CRspWelfareGetMillionAward,[e.id])},e.prototype.S2CRspWelfareGetSevenDayAward=function(t){var e=net_protocol.S2CRspWelfareGetSevenDayAward.decode(t.bytes);CommonUtils.log("^^--++--^^---S2CRspWelfareGetSevenDayAward",e),void 0==this.seven_day_awards&&(this.seven_day_awards=[]),this.seven_day_awards.push(e.id),this.SetOnlineState(),EventProxy.Broast(EventType.S2CRspWelfareGetSevenDayAward,[e.id])},e.prototype.S2CRspWelfareInvenstGetInfo=function(t){var e=net_protocol.S2CRspWelfareInvenstGetInfo.decode(t.bytes);this.invenst_list=e.invenst_list,this.award_list=[];for(var i in e.award_list)this.award_list[e.award_list[i].type]=e.award_list[i].ids;this.record_list=[];for(var i in e.record_list)this.record_list[e.record_list[i].type]=e.record_list[i].value;this.IsInvenstTotayOpen()&&(this.IsShowSuperTips=!0),EventProxy.Broast(EventType.S2CRspWelfareInvenstGetInfo,[])},e.prototype.S2CRspWelfareInvenstBuy=function(t){var e=net_protocol.S2CRspWelfareInvenstBuy.decode(t.bytes);CommonUtils.log("yjc---S2CRspWelfareInvenstBuy",e),this.invenst_list.push(e.type),EventProxy.Broast(EventType.S2CRspWelfareInvenstBuy,[])},e.prototype.S2CRspWelfareInvenstGetAward=function(t){var e=net_protocol.S2CRspWelfareInvenstGetAward.decode(t.bytes);CommonUtils.log("yjc---S2CRspWelfareInvenstGetAward",e),void 0==this.award_list[e.type]&&(this.award_list[e.type]=[]),this.award_list[e.type].push(e.id),EventProxy.Broast(EventType.S2CRspWelfareInvenstGetAward,[])},e.prototype.S2CRspWelfareFreegiftBuy=function(t){var e=net_protocol.S2CRspWelfareFreegiftBuy.decode(t.bytes);CommonUtils.log("---S2CRspWelfareFreegiftBuy",e);for(var i=void 0,n=0;n<this.free_gift.length;n++)this.free_gift[n].type==e.type&&(i=this.free_gift[n]);void 0==i&&(i=new net_protocol.S2CWelfareFreegiftInfo,i.type=e.type,i.is_get=!1,this.free_gift.push(i)),i.buy_time=GameLogic.ins().getServerTime(),EventProxy.Broast(EventType.S2CRspWelfareFreegiftBuy,[])},e.prototype.S2CRspWelfareFreegiftGetAward=function(t){var e=net_protocol.S2CRspWelfareFreegiftGetAward.decode(t.bytes);CommonUtils.log("---S2CRspWelfareFreegiftGetAward",e);for(var i=void 0,n=0;n<this.free_gift.length;n++)this.free_gift[n].type==e.type&&(i=this.free_gift[n]);void 0==i&&(CommonUtils.log("-----has not free_gift",e.type),i=new net_protocol.S2CWelfareFreegiftInfo,i.type=e.type,i.is_get=!1,this.free_gift.push(i)),i.is_get=!0,EventProxy.Broast(EventType.S2CRspWelfareFreegiftGetAward,[])},e.prototype.S2CRspWelfareLoginOnlineAward=function(t){var e=net_protocol.S2CRspWelfareLoginOnlineAward.decode(t.bytes),i=new net_protocol.S2CWelfareLoginInfo;i.index=e.day,i.state=1,this.login_online_awards.push(i),EventProxy.Broast(EventType.S2CRspWelfareLoginOnlineAward,[e.day])},e.prototype.S2CRspWelfareTopShareAward=function(t){var e=net_protocol.S2CRspWelfareTopShareAward.decode(t.bytes);CommonUtils.log("yjc---S2CRspWelfareTopShareAward",e);var i=[];1==e.type&&(this.is_top=!0,i=GlobalConfig.getWelfare_configConfig(1).top_award),2==e.type&&(this.today_share=!0,this.share_days=this.share_days+1,i=GlobalConfig.getWelfare_configConfig(1).share_award),3==e.type&&(this.share_acc_awards.push(e.index),i=GlobalConfig.getWelfare_share_acc_awardConfig(e.index).award);for(var n=[],o=0;o<i.length;o++){var s=UtilProxy.GetItemCellData(i[o][0],i[o][1]);n.push(s)}TipsControl.ins().showReward(n),EventProxy.Broast(EventType.S2CRspWelfareTopShareAward,[])},e.prototype.initConfig=function(){GlobalConfig.getConfig("login_award","login_awardConfig"),GlobalConfig.getConfig("welfare_signin_data","welfare_signin_dataConfig"),GlobalConfig.getConfig("online_award","online_awardConfig"),GlobalConfig.getConfig("week_card_award","week_card_awardConfig"),GlobalConfig.getConfig("welfare_config","welfare_configConfig"),GlobalConfig.getConfig("welfare_login_online_award","Welfare_login_online_awardConfigs")},e.prototype.currentLoginAwardDay=function(){if(void 0==this.login_awards)return 0;for(var t=0;t<this.login_awards.length;++t)if(void 0!=this.login_awards[t].state&&1==this.login_awards[t].state)return this.login_awards[t].index;return 0},e.prototype.getCurrentLoginAwardDay=function(){return void 0==this.login_awards?1:this.login_awards.length},e.prototype.currentLoginDay=function(){if(void 0==this.login_awards)return 0;for(var t=0,e=0;e<this.login_awards.length;++e)void 0!=this.login_awards[e].state&&2==this.login_awards[e].state&&(t=this.login_awards[e].index);return t},e.prototype.isLoginRewardDayById=function(t){if(void 0==this.login_awards)return!1;for(var e=0;e<this.login_awards.length;++e)if(void 0!=this.login_awards[e].state&&this.login_awards[e].index==t)return 2==this.login_awards[e].state;return!1},e.prototype.isGetLoginAward=function(){var t=this.currentLoginAwardDay();return 0==t?!1:t<=this.login_award_count?!0:!1},e.prototype.isFinishLoginAward=function(){if(!this.login_awards)return!1;for(var t=0;t<this.login_awards.length;++t)if(2==this.login_awards[t].state&&this.login_awards[t].index==this.login_award_count)return!0;return!1},e.prototype.signinServerDay=function(){return void 0==this.start_signin_time||this.start_signin_time<0?void 0:UtilProxy.getPerDay(3600*this.start_signin_time*24,GameLogic.ins().getServerTime())},e.prototype.isCanSignin=function(){return this.signin_times<this.signinServerDay()?!0:!1},e.prototype.isOnlineAward=function(t){if(void 0==this.online_awards)return!1;for(var e=0;e<this.online_awards.length;++e)if(this.online_awards[e]==t)return!0;return!1},e.prototype.setOnlineAwardCount=function(){for(var t=0,e=0;e<this.week_card_awards.length;++e)t+=1;this.online_award_count=t},e.prototype.getWeekCarAwardData=function(t){if(void 0!=this.week_card_awards)for(var e=0;e<this.week_card_awards.length;++e)if(this.week_card_awards[e].index==t)return this.week_card_awards[e]},e.prototype.LeftWeekCarAward=function(){var t=this.week_car_award_count;if(void 0==this.week_card_awards)return t;for(var e=0;e<this.week_card_awards.length;++e)void 0!=this.week_card_awards[e].state&&2==this.week_card_awards[e].state&&(t-=1);return t},e.prototype.isWeekCarAward=function(){if(!this.is_open_week_card)return!1;if(void 0==this.week_card_awards)return!1;for(var t=0;t<this.week_card_awards.length;++t)if(void 0!=this.week_card_awards[t].state&&2!=this.week_card_awards[t].state)return!0;return!1},e.prototype.getOnlineTime=function(){return GameLogic.ins().getServerTime()-this.server_time+this.online},e.prototype.SetOnlineState=function(){for(var t in GlobalConfig.ins().online_awardConfig){var e=GlobalConfig.ins().online_awardConfig[t];if(!this.isOnlineAward(e.id)&&this.getOnlineTime()>e.need_time)return void this.setOnlineAward(!0)}this.setOnlineAward(!1)},e.prototype.getOnlineAward=function(){return this.is_online_award},e.prototype.setOnlineAward=function(t){this.is_online_award!=t&&(this.is_online_award=t,EventProxy.Broast(EventType.RefreshOnlineAward,[this.is_online_award]))},e.prototype.GetMaxOnlineTime=function(){var t=0;for(var e in GlobalConfig.ins().online_awardConfig){var i=GlobalConfig.ins().online_awardConfig[e];t=Math.max(i.need_time,t)}return t},e.prototype.UpDateOnline=function(){this.GetMaxOnlineTime()<this.getOnlineTime()&&(void 0==this.online_awards?this.is_online_award=!0:this.online_awards.length<this.online_award_count?this.is_online_award=!0:this.is_online_award=!1,TimerManager.ins().remove(this.UpDateOnline,this)),this.SetOnlineState()},e.prototype.getXiuxianActDay=function(){return 7},e.prototype.getXiuxianActLeftTime=function(){var t=GameLogic.ins().getServerTime(),e=LimitActProxy.ins().GetServerOpenDay(),i=new Date(1e3*t),n=i.getHours(),o=i.getMinutes(),s=i.getSeconds(),r=this.getXiuxianActDay()+1-e;return 3600*r*24-(3600*n+60*o+s)},e.prototype.isGetMillionAward=function(t){if(!this.million_awards)return!1;for(var e=0;e<this.million_awards.length;++e)if(this.million_awards[e]==t)return!0;return!1},e.prototype.GetTotalYBMillionAward=function(){var t=0;for(var e in GlobalConfig.getMillion_award_dataConfigs())for(var i=GlobalConfig.getMillion_award_dataConfigs()[e],n=0;n<i.mul_items.length;++n)i.mul_items[n][0]==MoneyAttr.YUANBAO&&(t+=i.mul_items[n][1]);return t},e.prototype.GetRewardYBMillionAward=function(){if(!this.million_awards)return 0;for(var t=0,e=0;e<this.million_awards.length;++e){var i=GlobalConfig.getMillion_award_dataConfig(this.million_awards[e]);if(i)for(var n=0;n<i.mul_items.length;++n)i.mul_items[n][0]==MoneyAttr.YUANBAO&&(t+=i.mul_items[n][1])}return t},e.prototype.isYBMillionAwardRed=function(){var t=XiuXianProxy.ins().achie_level||0;for(var e in GlobalConfig.getMillion_award_dataConfigs()){var i=GlobalConfig.getMillion_award_dataConfigs()[e];if(t>=i.xiuxian_level&&!this.isGetMillionAward(i.id))return!0}return!1},e.prototype.isGetSevendayAward=function(t){if(!this.seven_day_awards)return!1;for(var e=0;e<this.seven_day_awards.length;++e)if(this.seven_day_awards[e]==t)return!0;return!1},e.prototype.isSevendayAward=function(){if(!this.seven_day_awards)return!0;var t=this.getCreateDay(),e=GlobalConfig.getSeven_day_award_dataConfigs();for(var i in e)if(e[i].id<=t&&!this.isGetSevendayAward(e[i].id))return!0;return!1},e.prototype.isSevendayCanAward=function(t){var e=this.getCreateDay(),i=GlobalConfig.getSeven_day_award_dataConfig(t);return i.id<=e},e.prototype.getSevendayRed=function(){var t=this.getcurSevendayAward();return t?e.ins().isSevendayCanAward(t.id):!1},e.prototype.getcurSevendayAward=function(){if(this.isInit){var t=(LimitActProxy.ins().GetServerOpenDay(),GlobalConfig.getSeven_day_award_dataConfigs());for(var e in t)if(!this.isGetSevendayAward(t[e].id))return t[e]}},e.prototype.getfreeGiftInfoList=function(){return this.free_gift},e.prototype.getHasFreeGift=function(){var t=this.free_gift,i=RoleProxy.ins().getRoleLv(),n=LyhProxy.ins().getCurId(),o=LimitActProxy.ins().GetServerOpenDay(),s=e.ins().getCreateDay(),r=GlobalConfig.getFreeGift_dataConfigs(),a=[],h=[];for(var l in r)a.push(l);for(var l=0;l<a.length;l++){for(var p=!1,c=0;c<t.length;c++)if(t[c].type==r[a[l]].id&&1!=t[c].is_get){p=!0;break}if(p)h.push(r[a[l]]);else if(s>=r[a[l]].create_day&&o>=r[a[l]].open_srv_day&&i>=r[a[l]].need_level&&n>=r[a[l]].lyh_id){for(var u=!1,c=0;c<t.length;c++)if(t[c].type==r[a[l]].id&&1==t[c].is_get){u=!0;break}u||h.push(r[a[l]])}}return h},e.prototype.isFreeGiftCanGet=function(){for(var t=this.getHasFreeGift(),e=this.free_gift,i=!1,n=0,o=0;o<e.length;o++)for(var s=0;s<t.length;s++)if(n=t[s].time-GameLogic.ins().getServerTime()+e[o].buy_time,0>=n&&0==e[o].is_get){i=!0;break}return i},e.prototype.isOpenFreeGiftView=function(){var t=this.getHasFreeGift();return t.length<=0?!1:!0},e.prototype.getLoginday=function(){return this.login_days||0},e.prototype.getCreateDay=function(){var t=RoleProxy.ins().getCreateTime(),e=GameLogic.ins().getServerTime();return Math.floor((e+28800)/86400)-Math.floor((t+28800)/86400)+1},e.prototype.getRed=function(){return!this.signin_state||this.isGetLoginAward()||this.isWeekCarAward()||this.getOnlineAward()||this.IsShowRechargeRed()},e.prototype.getCurrentConfig=function(){if(void 0!=this.system_awards&&0!=this.system_awards.length){for(var t=0,e=0;e<this.system_awards.length;++e)t<this.system_awards[e]&&(t=this.system_awards[e]);return GlobalConfig.getSystem_open_awardConfig(t)}},e.prototype.isGetSystemAward=function(t){if(void 0==this.system_awards||0==this.system_awards.length)return!1;for(var e=0;e<this.system_awards.length;++e)if(t==this.system_awards[e])return!0;return!1},e.prototype.isEnoughGetSystemAward=function(t){return this.isCanGetSystemAward(t)&&!this.isGetSystemAward(t)},e.prototype.GetSystemAwardStateById=function(t){return this.isCanGetSystemAward(t)&&!this.isGetSystemAward(t)?!0:!1},e.prototype.isCanGetSystemAward=function(t){var e=GlobalConfig.getSystem_open_awardConfig(t);if(e){var i=e.system_params[0],n=e.system_params[1];switch(i){case 1:return n<=RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL);case 2:return n<=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);case 3:return n<=LyhProxy.ins().getCurId();case 4:return n<=LimitActProxy.ins().GetServerOpenDay()}}return!1},e.prototype.getSystemAwardCount=function(){return void 0==this.system_awards?0:this.system_awards.length},e.prototype.isHaveSystemAward=function(){GlobalConfig.ins().system_open_awardConfig||GlobalConfig.getConfig("system_open_award","system_open_awardConfig");for(var t in GlobalConfig.ins().system_open_awardConfig){var e=GlobalConfig.ins().system_open_awardConfig[t];if(this.isCanGetSystemAward(e.id)&&!this.isGetSystemAward(e.id))return!0}return!1},e.prototype.getNextNotCanGetSysAward=function(){GlobalConfig.ins().system_open_awardConfig||GlobalConfig.getConfig("system_open_award","system_open_awardConfig");var t=void 0,e=0;for(var i in GlobalConfig.ins().system_open_awardConfig){var n=GlobalConfig.ins().system_open_awardConfig[i];if(4!=n.system_params[0]&&(e<n.id&&(e=n.id,t=n),!this.isGetSystemAward(n.id)&&!this.isCanGetSystemAward(n.id)))return n}return t},e.prototype.getNextSysOpenConfig=function(t){void 0===t&&(t=!1),GlobalConfig.ins().system_open_awardConfig||GlobalConfig.getConfig("system_open_award","system_open_awardConfig");for(var e in GlobalConfig.ins().system_open_awardConfig){var i=GlobalConfig.ins().system_open_awardConfig[e];if(4!=i.system_params[0]&&!this.isGetSystemAward(i.id)&&this.isCanGetSystemAward(i.id))return i}if(t)for(var e in GlobalConfig.ins().system_open_awardConfig){var i=GlobalConfig.ins().system_open_awardConfig[e];if(4==i.system_params[0]&&!this.isGetSystemAward(i.id)&&this.isCanGetSystemAward(i.id))return i}var n=!1;for(var e in GlobalConfig.ins().system_open_awardConfig){var i=GlobalConfig.ins().system_open_awardConfig[e];if(!this.isGetSystemAward(i.id)){if(4!=i.system_params[0])return i;n=!0}}return n?this.getCurrentConfig():void 0},e.prototype.getNextCanAwardSysOpenConfig=function(t){void 0===t&&(t=!1),GlobalConfig.ins().system_open_awardConfig||GlobalConfig.getConfig("system_open_award","system_open_awardConfig");for(var e in GlobalConfig.ins().system_open_awardConfig){var i=GlobalConfig.ins().system_open_awardConfig[e];if(4!=i.system_params[0]&&!this.isGetSystemAward(i.id)&&this.isCanGetSystemAward(i.id))return i}if(t)for(var e in GlobalConfig.ins().system_open_awardConfig){var i=GlobalConfig.ins().system_open_awardConfig[e];if(4==i.system_params[0]&&!this.isGetSystemAward(i.id)&&this.isCanGetSystemAward(i.id))return i}},e.prototype.getNextSysOpenReward=function(t){GlobalConfig.ins().system_open_awardConfig||GlobalConfig.getConfig("system_open_award","system_open_awardConfig");for(var e in GlobalConfig.ins().system_open_awardConfig){var i=GlobalConfig.ins().system_open_awardConfig[e];if(t<i.id)return i}},e.prototype.getInvenstHasBuy=function(t){for(var e in this.invenst_list)if(this.invenst_list[e]==t)return!0;return!1},e.prototype.getInvenstCurValue=function(t){var e=GlobalConfig.getInvenstAwardDataConfigs(t);return e&&3==e[1].param_type?RoleProxy.ins().getRoleLv():this.record_list[t]||0},e.prototype.getInvenstAwardHasGet=function(t,e){if(void 0==this.award_list[t])return!1;for(var i=0;i<this.award_list[t].length;i++)if(this.award_list[t][i]==e)return!0;return!1},e.prototype.getInvenstTypeRed=function(t){if(this.getInvenstOpenByType(t)){var e=GlobalConfig.getInvenst_dataConfig(t);if(e.vip_level<=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL)&&BagProxy.ins().getItemCountById(e.money[0])>=e.money[1]&&!this.getInvenstHasBuy(t))return!0}if(!this.getInvenstHasBuy(t))return!1;var i=GlobalConfig.getInvenstAwardDataConfigs(t),n=this.getInvenstCurValue(i[1].id);for(var o in i)if(n>=i[o].params&&!this.getInvenstAwardHasGet(i[o].id,i[o].index))return!0;return!1},e.prototype.getInvenstRed=function(){for(var t=1;4>=t;t++)if(this.getInvenstTypeRed(t))return!0;return!1},e.prototype.getInvenstOpenByType=function(t){var e=GlobalConfig.getInvenst_dataConfig(t);return 0==e.server_open_day||0==e.keep_day?!0:e.server_open_day+e.keep_day-1>=LimitActProxy.ins().GetServerOpenDay()&&e.server_open_day<=LimitActProxy.ins().GetServerOpenDay()?!0:!1},e.prototype.getInvenstOpen=function(){if(!SystemOpenProxy.ins().isOpen(1,48,!0)||UtilProxy.shield)return!1;for(var t=1;4>=t;t++){var e=GlobalConfig.getInvenst_dataConfig(t);if(0==e.server_open_day||0==e.keep_day)return!0;if(e.server_open_day+e.keep_day-1>=LimitActProxy.ins().GetServerOpenDay())return!0;if(this.getInvenstHasBuy(t)){var i=GlobalConfig.getInvenstAwardDataConfigs(t);for(var n in i)if(!this.getInvenstAwardHasGet(i[n].id,i[n].index))return!0}}return!1},e.prototype.IsInvenstTotayOpen=function(){for(var t=1;4>=t;t++){var e=GlobalConfig.getInvenst_dataConfig(t);if(e.server_open_day==LimitActProxy.ins().GetServerOpenDay()&&!this.getInvenstHasBuy(t))return!0}return!1},e.prototype.getInvenstEndTimeByType=function(t){var e=GlobalConfig.getInvenst_dataConfig(t),i=-1;if(0!=e.server_open_day&&0!=e.keep_day){var n=e.keep_day+e.server_open_day-LimitActProxy.ins().GetServerOpenDay()-1,o=LimitActProxy.ins().GetServerTimeDataByPassDay(n),s=UtilProxy.getStr("@0 /@1 /@2  23:59:59",[o.getFullYear(),o.getMonth()+1,o.getDate()]);i=new Date(s).getTime()/1e3}return i},e.prototype.IsShowRecharge=function(){if(!SystemOpenProxy.ins().isOpen(2,2806,!0))return!1;var t=GlobalConfig.getwelfare_login_online_awardConfigs();for(var e in t)if(2!=this.GetloginAwardState(t[e].day))return!0;return!1},e.prototype.IsShowRechargeRed=function(){var t=GlobalConfig.getwelfare_login_online_awardConfigs();for(var e in t)if(1==this.GetloginAwardState(t[e].day))return!0;return!1},e.prototype.GetloginAwardState=function(t){for(var e=0;e<this.login_online_awards.length;e++)if(this.login_online_awards[e].index==t){if(1==this.login_online_awards[e].state)return 2;if(0==this.login_online_awards[e].state)return 1}if(this.getLoginday()==t){var i=GlobalConfig.getWelfare_login_online_awardConfig(t);if(i&&i.need_time<=this.getOnlineTime())return 1}return 0},e.prototype.GetShareState=function(t){for(var e=0;e<this.share_acc_awards.length;e++)if(this.share_acc_awards[e]==t)return 2;var i=GlobalConfig.getWelfare_share_acc_awardConfig(t);return i&&i.days<=this.share_days?1:0},e.prototype.IsShowShareRed=function(){if(0==this.today_share)return!0;var t=GlobalConfig.getWelfare_share_acc_awardConfigs();for(var e in t)if(t[e]&&t[e].id>0){var i=this.GetShareState(t[e].id);if(1==i)return!0}return!1},e.prototype.IsShowSCZD=function(){return SystemOpenProxy.ins().isOpen(1,99,!0)&&0==this.is_top?!0:!1},e}(BaseSystem);__reflect(WelfareProxy.prototype,"WelfareProxy");var XianFuProxy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.setRed=function(){return XiuXianProxy.ins().getLimitRed()||CopyProxy.ins().getSwordRed()||CopyTeamProxy.ins().getRed()||CopyProxy.ins().GetMatericalCopyRed()||CopyProxy.ins().GetZYTowerCopyRed()||FacProxy.ins().getRed()},e}(BaseSystem);__reflect(XianFuProxy.prototype,"XianFuProxy");var AchieType;!function(t){t[t.role_level=1]="role_level",t[t.belle_level=2]="belle_level",t[t.skill_level=3]="skill_level",t[t.dress_equip=4]="dress_equip",t[t.pet_level=5]="pet_level",t[t.shengwang=6]="shengwang",t[t.upgrade=25]="upgrade",t[t.stone_level=8]="stone_level",t[t.star_level=9]="star_level",t[t.tujian_num=10]="tujian_num",t[t.mount_level=11]="mount_level",t[t.lyh=12]="lyh",t[t.zhuan=13]="zhuan",t[t.weapon_list=14]="weapon_list",t[t.fabao_num=15]="fabao_num",t[t.belle_num=16]="belle_num",t[t.alive_num=17]="alive_num",t[t.fuwen_num=18]="fuwen_num",t[t.wing_star=19]="wing_star",t[t.belle_star=20]="belle_star",t[t.weapon_star=21]="weapon_star",t[t.xubing_star=22]="xubing_star",t[t.pet_star=23]="pet_star",t[t.mount_star=24]="mount_star",t[t.Zhuang_list=26]="Zhuang_list"}(AchieType||(AchieType={}));var XiuXianProxy=function(t){function e(){var e=t.call(this)||this;return e.alive_point=0,e.alive_list=[],e.alive_reward_list=[],e.alive_get=[],e.achie_list=[],e.achie_value=0,e.achie_level=0,e.dujie_lv=0,e.dujie_min_lv=0,e.dujie_task_list=[],e.dujie_copy_finish=!1,e.xianfu_value=0,e.xianfu_level=0,e.findback_list=[],e.auto_find=!1,e.xianwei=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGrowupGetDujieInfo=function(){var t=new net_protocol.C2SReqGrowupGetDujieInfo;this.sendPbPack(Msg.C2SReqGrowupGetDujieInfo,t,net_protocol.C2SReqGrowupGetDujieInfo)},e.prototype.C2SReqGrowupGetDujieTaskAward=function(t){var e=new net_protocol.C2SReqGrowupGetDujieTaskAward;e.task_id=t,this.sendPbPack(Msg.C2SReqGrowupGetDujieTaskAward,e,net_protocol.C2SReqGrowupGetDujieTaskAward)},e.prototype.C2SReqGrowupChallengeDujieCopy=function(){var t=new net_protocol.C2SReqGrowupChallengeDujieCopy;this.sendPbPack(Msg.C2SReqGrowupChallengeDujieCopy,t,net_protocol.C2SReqGrowupChallengeDujieCopy)},e.prototype.C2SReqGrowupDujieUpgrade=function(){var t=new net_protocol.C2SReqGrowupDujieUpgrade;
this.sendPbPack(Msg.C2SReqGrowupDujieUpgrade,t,net_protocol.C2SReqGrowupDujieUpgrade)},e.prototype.S2CRepGrowupGetDujieInfo=function(t){var e=net_protocol.S2CRepGrowupGetDujieInfo.decode(t.bytes);this.dujie_task_list=[],this.dujie_lv=e.level,this.dujie_min_lv=e.mini_level,this.dujie_copy_finish=1==e.copy_finish;for(var i=0;i<e.task_list.length;i++){var n=e.task_list[i];this.dujie_task_list[n.task_id]=n}this.updateZhuanRed(),EventProxy.Broast(EventType.S2CRepGrowupGetDujieInfo,[]),EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.S2CRepGrowupUpdateDujieTaskInfo=function(t){var e=net_protocol.S2CRepGrowupUpdateDujieTaskInfo.decode(t.bytes);if(0==e.opt){this.dujie_task_list=[];for(var i=0;i<e.task_list.length;i++){var n=e.task_list[i];this.dujie_task_list[n.task_id]=n}}else for(var i=0;i<e.task_list.length;i++){var n=e.task_list[i];this.dujie_task_list[n.task_id]=n}EventProxy.Broast(EventType.S2CRepGrowupUpdateDujieTaskInfo,[])},e.prototype.S2CRepGrowupDujieCopyResult=function(t){var e=net_protocol.S2CRepGrowupDujieCopyResult.decode(t.bytes);this.dujie_copy_finish=1==e.copy_finish;var i=this.getNextCopyData(this.dujie_lv,this.dujie_min_lv);if(i){for(var n=i.items,o=[],s=0;s<n.length;s++){var r=new ItemCellData,a={item_slot_idx:0,item_type_id:n[s][0],item_count:n[s][1]};r.setItemCellData(a),o.push(r)}var h="";h=0==e.result?UtilProxy.getStr("C:10&恭喜你成功击败心魔!",[]):UtilProxy.getStr("C:10&十分遗憾，您没有击败您的心魔，无法突破到下一境界!",[]),ViewManager.ins().open(PvpEndView,o,0==e.result,EndType.DUJIE,h),EventProxy.Broast(EventType.S2CRepGrowupDujieCopyResult,[])}},e.prototype.S2CRepGrowupGetDujieTaskAward=function(t){var e=net_protocol.S2CRepGrowupGetDujieTaskAward.decode(t.bytes);EventProxy.Broast(EventType.S2CRepGrowupGetDujieTaskAward,[e.task_id])},e.prototype.getNextCopyData=function(t,e){var i=GlobalConfig.getDujieCopyById(t,e+1);return i||(i=GlobalConfig.getDujieCopyById(t+1,1)),i},e.prototype.getTaskState=function(t){var e=this.dujie_task_list[t];return e?e.is_completed:0},e.prototype.isTaskFinish=function(t){var e=this.dujie_task_list[t];return e&&1==e.is_completed},e.prototype.isTaskRewardGeted=function(t){var e=this.dujie_task_list[t];return e&&2==e.is_completed},e.prototype.getTaskValue=function(t){var e=this.dujie_task_list[t];return e?e.achieve_count:0},e.prototype.getdujieFight=function(){var t=GlobalConfig.getDujieBaseById(this.dujie_lv,this.dujie_min_lv);return t?UtilProxy.GetAttrFight(t):0},e.prototype.C2SReqMiscZhuanUpLevel=function(){var t=new net_protocol.C2SReqMiscZhuanUpLevel;this.sendPbPack(Msg.C2SReqMiscZhuanUpLevel,t,net_protocol.C2SReqMiscZhuanUpLevel)},e.prototype.C2SReqAlivepointGetInfo=function(){var t=new net_protocol.C2SReqAlivepointGetInfo;this.sendPbPack(Msg.C2SReqAlivepointGetInfo,t,net_protocol.C2SReqAlivepointGetInfo)},e.prototype.C2SReqAlivepointGetReward=function(t){var e=new net_protocol.C2SReqAlivepointGetReward;e.award_idx=t,this.sendPbPack(Msg.C2SReqAlivepointGetReward,e,net_protocol.C2SReqAlivepointGetReward)},e.prototype.C2SReqAlivepointGet=function(t){var e=new net_protocol.C2SReqAlivepointGet;e.id=t,this.sendPbPack(Msg.C2SReqAlivepointGet,e,net_protocol.C2SReqAlivepointGet)},e.prototype.C2SReqAchievementGetInfo=function(){var t=new net_protocol.C2SReqAchievementGetInfo;this.sendPbPack(Msg.C2SReqAchievementGetInfo,t,net_protocol.C2SReqAchievementGetInfo)},e.prototype.C2SReqAchievementUpgrade=function(){var t=new net_protocol.C2SReqAchievementUpgrade;this.sendPbPack(Msg.C2SReqAchievementUpgrade,t,net_protocol.C2SReqAchievementUpgrade)},e.prototype.C2SReqAchievementGet=function(t){var e=new net_protocol.C2SReqAchievementGet;e.id=t,this.sendPbPack(Msg.C2SReqAchievementGet,e,net_protocol.C2SReqAchievementGet)},e.prototype.C2SReqAlivepointXianfuUpLevel=function(){var t=new net_protocol.C2SReqAlivepointXianfuUpLevel;this.sendPbPack(Msg.C2SReqAlivepointXianfuUpLevel,t,net_protocol.C2SReqAlivepointXianfuUpLevel)},e.prototype.C2SReqAlivepointXianfuFindBack=function(t){var e=new net_protocol.C2SReqAlivepointXianfuFindBack;e.id=t,this.sendPbPack(Msg.C2SReqAlivepointXianfuFindBack,e,net_protocol.C2SReqAlivepointXianfuFindBack)},e.prototype.S2CRepMiscZhuanUpLevel=function(t){net_protocol.S2CRepMiscZhuanUpLevel.decode(t.bytes);EventProxy.Broast(EventType.S2CRepMiscZhuanUpLevel,[])},e.prototype.S2CRepAlivepointGetInfo=function(t){var e=net_protocol.S2CRepAlivepointGetInfo.decode(t.bytes);this.alive_point=e.alive_point,this.alive_list=[],this.alive_get=[],this.xianfu_value=e.xianfu_value,this.xianfu_level=e.xianfu_level,this.findback_list=e.findback_list,this.alive_reward_list=[];for(var i=0;i<e.item.length;i++){var n=e.item[i];this.alive_list[n.id]=n.times}for(var i=0;i<e.has_get_reward.length;i++){var o=e.has_get_reward[i];this.alive_reward_list[o]=1}for(var i=0;i<e.get_list.length;i++){var o=e.get_list[i];this.alive_get[o]=1}this.updateAliveRed(),this.updateZhuanRed(),EventProxy.Broast(EventType.S2CRepAlivepointGetInfo,[]),EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.S2CRepAlivepointUpdate=function(t){var i=net_protocol.S2CRepAlivepointUpdate.decode(t.bytes);this.alive_point=i.alive_point,this.alive_list||(this.alive_list=[]);for(var n=0;n<i.item.length;n++)this.alive_list[i.item[n].id]=i.item[n].times;this.updateAliveRed(),e.ins().updateAchieRed(AchieType.alive_num),EventProxy.Broast(EventType.S2CRepAlivepointUpdate,[])},e.prototype.S2CRepAlivepointGet=function(t){var e=net_protocol.S2CRepAlivepointGet.decode(t.bytes);this.alive_get||(this.alive_get=[]),this.alive_point=e.alive_point,this.xianfu_value=e.xianfu_value,this.alive_get[e.id]=1,this.updateAliveRed(),EventProxy.Broast(EventType.S2CRepAlivepointGet,[])},e.prototype.S2CRepAlivepointGetReward=function(t){var e=net_protocol.S2CRepAlivepointGetReward.decode(t.bytes);this.alive_reward_list||(this.alive_reward_list=[]);for(var i=0;i<e.has_get_reward.length;i++){var n=e.has_get_reward[i];this.alive_reward_list[n]=1}this.updateAliveRed(),EventProxy.Broast(EventType.S2CRepAlivepointGetReward,[])},e.prototype.S2CRepAlivepointXianfuUpLevel=function(t){var e=net_protocol.S2CRepAlivepointXianfuUpLevel.decode(t.bytes),i=Math.ceil(this.xianfu_level/10),n=Math.ceil(e.level/10);if(n>i){var o=GlobalConfig.getAliveDescById(n),s=UI_XIANFU_DIR+o.ui_model;ViewManager.ins().open(JihuoTipsView,JihuoType.xianfu,0,s)}this.xianfu_level=e.level,this.updateAliveRed(),this.updateZhuanRed(),EventProxy.Broast(EventType.S2CRepAlivepointXianfuUpLevel,[])},e.prototype.S2CRepAlivepointXianfuFindBack=function(t){var e=net_protocol.S2CRepAlivepointXianfuFindBack.decode(t.bytes);if(this.xianfu_value=e.xianfu_value,0!=e.id)for(var i=0;i<this.findback_list.length;i++){var n=this.findback_list[i];if(n&&n.id==e.id){this.findback_list.splice(i,1);break}}else this.findback_list=[];this.updateAliveRed(),EventProxy.Broast(EventType.S2CRepAlivepointXianfuFindBack,[])},e.prototype.S2CRepAchievementGetInfo=function(t){var e=net_protocol.S2CRepAchievementGetInfo.decode(t.bytes);this.achie_list=[],this.achie_get_list={},this.achieGetlvList=[],this.achie_value=e.xiuxian_value,GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.xiuwei=this.achie_value),this.achie_level=e.xiuxian_level;for(var i=0;i<e.get_list.length;i++){this.achie_get_list[e.get_list[i]]=!0;var n=GlobalConfig.getAchieById(e.get_list[i]);n&&(this.achieGetlvList[n.group_id]||(this.achieGetlvList[n.group_id]=0),this.achieGetlvList[n.group_id]+=1)}for(var i=0;i<e.cnt_list.length;i++){var n=e.cnt_list[i];this.achie_list[n.type]||(this.achie_list[n.type]=[]),this.achie_list[n.type][n.id]=n.count}GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.xiuxian_level=this.achie_level),this.achie_red_list=[];for(var o=1;26>o;o++)7!=o&&this.updateAchieRed(o);EventProxy.Broast(EventType.S2CRepAchievementGetInfo,[]),EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.S2CRepAchievementGet=function(t){var e=net_protocol.S2CRepAchievementGet.decode(t.bytes);this.achie_get_list||(this.achie_get_list=[]),this.achie_get_list[e.id]=!0;var i=GlobalConfig.getAchieById(e.id);this.achieGetlvList[i.group_id]||(this.achieGetlvList[i.group_id]=0),this.achieGetlvList[i.group_id]+=1,this.achie_value=e.xiuxian_value,GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.xiuwei=this.achie_value);var n=GlobalConfig.getAchieById(e.id);this.updateAchieRed(n.type),EventProxy.Broast(EventType.S2CRepAchievementGet,[])},e.prototype.S2CRepAchievementUpdateCollectInfo=function(t){var e=net_protocol.S2CRepAchievementUpdateCollectInfo.decode(t.bytes);this.achie_list||(this.achie_list=[]),this.achie_list[e.type]||(this.achie_list[e.type]=[]),this.achie_list[e.type][e.id]=e.count,EventProxy.Broast(EventType.S2CRepAchievementUpdateCollectInfo,[])},e.prototype.S2CRepAchievementUpgrade=function(t){var e=net_protocol.S2CRepAchievementUpgrade.decode(t.bytes);this.achie_level=e.level,GameMap.centerEntity&&GameMap.centerEntity.vo&&(GameMap.centerEntity.vo.xiuxian_level=this.achie_level),EventProxy.Broast(EventType.S2CRepAchievementUpgrade,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(25155,this.S2CRepMiscZhuanUpLevel,this),MsgHandle.ins().regNetMsg(26350,this.S2CRepAlivepointGetInfo,this),MsgHandle.ins().regNetMsg(26353,this.S2CRepAlivepointGet,this),MsgHandle.ins().regNetMsg(26351,this.S2CRepAlivepointUpdate,this),MsgHandle.ins().regNetMsg(26352,this.S2CRepAlivepointGetReward,this),MsgHandle.ins().regNetMsg(26800,this.S2CRepAchievementGetInfo,this),MsgHandle.ins().regNetMsg(26801,this.S2CRepAchievementGet,this),MsgHandle.ins().regNetMsg(26802,this.S2CRepAchievementUpdateCollectInfo,this),MsgHandle.ins().regNetMsg(26803,this.S2CRepAchievementUpgrade,this),MsgHandle.ins().regNetMsg(27616,this.S2CRepGrowupGetDujieInfo,this),MsgHandle.ins().regNetMsg(27617,this.S2CRepGrowupUpdateDujieTaskInfo,this),MsgHandle.ins().regNetMsg(27618,this.S2CRepGrowupDujieCopyResult,this),MsgHandle.ins().regNetMsg(26354,this.S2CRepAlivepointXianfuUpLevel,this),MsgHandle.ins().regNetMsg(26355,this.S2CRepAlivepointXianfuFindBack,this),MsgHandle.ins().regNetMsg(27620,this.S2CRepGrowupGetDujieTaskAward,this),MsgHandle.ins().regNetMsg(25755,this.S2CRepTitleGetXianweiInfo,this),MsgHandle.ins().regNetMsg(25756,this.S2CRepTitleUpgradeXianwei,this)},e.prototype.getZhuanModelList=function(){if(!this.zhuan_model_list){this.zhuan_model_list=[];var t=GlobalConfig.getZhuanList();for(var e in t){var i=t[e];i.pet[0]>0&&this.zhuan_model_list.push(i)}}return this.zhuan_model_list},e.prototype.getAchieModelList=function(){if(!this.achie_model_list){this.achie_model_list=[];var t=GlobalConfig.getAchieLevelList();for(var e in t){var i=t[e];i.belle_id>0&&this.achie_model_list.push(i)}}return this.achie_model_list},e.prototype.getZhuanConditionValue=function(t){var i=0;switch(t){case 0:i=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);break;case 1:i=RoleProxy.ins().getRoleLv();break;case 2:i=UpStarProxy.ins().getTotleUpStarLevel();break;case 3:i=LyhProxy.ins().getCurId();break;case 4:i=CopyProxy.ins().getZYTowerFloor();break;case 5:i=SoulStoneProxy.ins().getTotalStoneLevel();break;case 6:i=UpgradeProxy.ins().getAllUpgradeLevel();break;case 7:i=3*(this.dujie_lv-1)+this.dujie_min_lv;break;case 8:i=e.ins().xianfu_level}return i},e.prototype.getAliveTimes=function(t){return this.alive_list[t]||0},e.prototype.isAliveGet=function(t){return this.getAliveState(t)>0},e.prototype.isAliveRewardGet=function(t){return this.alive_reward_list[t]&&this.alive_reward_list[t]>0},e.prototype.getAliveState=function(t){if(this.alive_get||(this.alive_get=[]),this.alive_get[t])return 2;var e=this.alive_list[t]||0,i=GlobalConfig.getApById(t);return i&&e>=i.total_times?0:1},e.prototype.getFindExpSortList=function(){return 0==this.findback_list.length?this.findback_list:(this.findback_list.sort(function(t,e){return GlobalConfig.getApById(t.id).paixu-GlobalConfig.getApById(e.id).paixu}),this.findback_list)},e.prototype.getAchieTypeList=function(t){if(!this.achie_type_list){this.achie_type_list=[];var e=GlobalConfig.getAchieList();for(var i in e){var n=e[i];this.achie_type_list[n.type]||(this.achie_type_list[n.type]=[]),this.achie_type_list[n.type].push(n)}}return this.achie_type_list[t]},e.prototype.getAchieValue=function(t,e){var i=0;switch(t){case AchieType.role_level:i=RoleProxy.ins().getRoleLv();break;case AchieType.belle_level:i=HuobanProxy.ins().getGrade();break;case AchieType.skill_level:i=SkillProxy.ins().getSkillLvSum();break;case AchieType.dress_equip:i=BagProxy.ins().getEquipCountByQ(e[1]);break;case AchieType.pet_level:i=PetProxy.ins().getGrade();break;case AchieType.shengwang:i=RoleProxy.ins().getMoneyAttr(MoneyAttr.SHENGWANG);break;case AchieType.upgrade:i=UpgradeProxy.ins().getAllUpgradeLevel();break;case AchieType.stone_level:i=SoulStoneProxy.ins().getTotalStoneLevel();break;case AchieType.star_level:i=UpStarProxy.ins().getUpStarLevelCount(e[0]);break;case AchieType.tujian_num:i=GrowupProxy.ins().getTujianActiveCountByType(e[1]);break;case AchieType.mount_level:i=HorseProxy.ins().getGrade();break;case AchieType.lyh:i=LyhProxy.ins().getCurId();break;case AchieType.zhuan:i=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN);break;case AchieType.weapon_list:i=WeaponProxy.ins().getXuanBingTzNum();break;case AchieType.fabao_num:i=FabaoProxy.ins().getActiveNumByColor(e[1]);break;case AchieType.belle_num:i=HuobanProxy.ins().getActiveNumber();break;case AchieType.alive_num:i=this.getFinishAliveNum();break;case AchieType.fuwen_num:i=FwProxy.ins().getJxNumByColor(e[1]);break;case AchieType.wing_star:i=WeaponProxy.ins().getActiveByStarAndType(3,e[1]);break;case AchieType.weapon_star:i=WeaponProxy.ins().getActiveByStarAndType(1,e[1]);break;case AchieType.belle_star:i=HuobanProxy.ins().getStarNumber(e[1]);break;case AchieType.xubing_star:i=WeaponProxy.ins().getActiveByStarAndType(2,e[1]);break;case AchieType.pet_star:i=PetProxy.ins().getStarNumber(e[1]);break;case AchieType.mount_star:i=HorseProxy.ins().getStarNumber(e[1]);break;case AchieType.Zhuang_list:i=GodEquipProxy.ins().getGodEquipLevelCount(e[1]-1,1)}return i},e.prototype.getFinishAliveNum=function(){var t=GlobalConfig.getApList(),e=0;for(var i in t){var n=t[i];this.getAliveTimes(n.id)>=n.total_times&&this.getAliveState(n.id)>0&&(e+=1)}return e},e.prototype.isAchieGet=function(t){return this.achie_get_list?this.achie_get_list[t]:!1},e.prototype.isAchieCanGet=function(t){if(this.isAchieGet(t))return!1;var e=GlobalConfig.getAchieById(t),i=this.getAchieValue(e.type,e.condition),n=e.condition[0];return 9==e.type&&(n=10),i>=n},e.prototype.getUIAchieList=function(){var t=[],e=GlobalConfig.getAchieGroupList();for(var i in e){var n=this.getAchieGetLvBygpId(parseInt(i)),o=e[i],s=this.getAchieListBygpId(o.id);if(s&&s[n]){var r=s[n];if(0==r.system_id.length||0==r.system_id[0]||SystemOpenProxy.ins().isOpen(r.system_id[0],r.system_id[1],!0)){var a={};a.data=r,this.isAchieGet(r.id)||(a.state=1),this.isAchieCanGet(r.id)&&(a.state=0),a.sort=r.rank,a.top=r.top,t.push(a)}}}return t.sort(function(t,e){return t.state!=e.state?t.state-e.state:t.top!=e.top?e.top-t.top:void 0}),t},e.prototype.getAchieGetLvBygpId=function(t){return this.achieGetlvList||(this.achieGetlvList=[]),this.achieGetlvList[t]||0},e.prototype.getAchieListBygpId=function(t){if(!this.achieGroupList){this.achieGroupList=[];var e=GlobalConfig.getAchieList();for(var i in e){var n=e[i];this.achieGroupList[n.group_id]||(this.achieGroupList[n.group_id]=[]),this.achieGroupList[n.group_id].push(n)}}return this.achieGroupList[t]},e.prototype.getAchieList=function(){var t=GlobalConfig.getAchieList(),e=[];for(var i in t){var n=t[i];if(0==n.system_id.length||0==n.system_id[0]||SystemOpenProxy.ins().isOpen(n.system_id[0],n.system_id[1],!0)){var o={};o.data=n,o.state=this.isAchieGet(n.id)?2:1,this.isAchieCanGet(n.id)&&(o.state=0),o.sort=n.rank,e.push(o)}}return e.sort(function(t,e){return t.state!=e.state?t.state-e.state:t.sort-e.sort}),e},e.prototype.updateAchieRed=function(t){this.achie_red_list||(this.achie_red_list=[]);var e=!1,i=this.getAchieTypeList(t);if(i)for(var n=0;n<i.length;n++){var o=i[n];if(e=0==o.system_id.length||0==o.system_id[0]||SystemOpenProxy.ins().isOpen(o.system_id[0],o.system_id[1],!0),e&&!this.isAchieGet(o.id)&&this.isAchieCanGet(o.id))return this.achie_red_list[t]=!0,void EventProxy.Broast(EventType.XiuXianUpdate,[])}this.achie_red_list[t]=!1,EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.updateZhuanRed=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),e=GlobalConfig.getZhuanById(t+1);if(e){for(var i=["reputation","need_level","star_total_level","pass_lyh_id","syt_copy_id","gem_total_level","intensify_total_level","dujie_level","xianfu_level"],n=0;n<i.length;n++){var o=e[i[n]];if("syt_copy_id"==i[n]&&(o=o-CopyProxy.ins().simple_climb_enter_id+1),e[i[n]]>0&&o>this.getZhuanConditionValue(n))return this.zhuan_red=!1,EventProxy.Broast(EventType.ZhuanUpdate,[]),void EventProxy.Broast(EventType.XiuXianUpdate,[])}return this.zhuan_red=!0,EventProxy.Broast(EventType.ZhuanUpdate,[]),void EventProxy.Broast(EventType.XiuXianUpdate,[])}this.zhuan_red=!1,EventProxy.Broast(EventType.ZhuanUpdate,[]),EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.updateAliveRed=function(){if(SystemOpenProxy.ins().isOpen(2,1903,!0)||(this.alive_red=!1,EventProxy.Broast(EventType.XiuXianUpdate,[])),this.findback_list.length>0)return void(this.alive_red=!0);var t=GlobalConfig.getAliveLvdataById(this.xianfu_level+1);if(t&&this.xianfu_value>=t.xianfu)return void(this.alive_red=!0);var e=GlobalConfig.getApRewardList();for(var i in e)if(this.getAliveRewardRedById(parseInt(i)))return this.alive_red=!0,void EventProxy.Broast(EventType.XiuXianUpdate,[]);var n=GlobalConfig.getApList();for(var i in n){var o=n[i],s=this.alive_list[i]||0;if(s>=o.total_times&&!this.alive_get[i])return this.alive_red=!0,void EventProxy.Broast(EventType.XiuXianUpdate,[])}this.alive_red=!1,EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.getAliveRewardRedById=function(t){var e=GlobalConfig.getApRewardById(t);return!this.isAliveRewardGet(e.id)&&this.alive_point>=e.alive_point},e.prototype.getAliveRed=function(){return SystemOpenProxy.ins().isOpen(1,69,!0)?this.alive_red:!1},e.prototype.getAchieRed=function(){if(SystemOpenProxy.ins().isOpen(2,1901,!0)){for(var t in this.achie_red_list)if(this.achie_red_list[t])return!0;return!1}return!1},e.prototype.getAliveList=function(){var t=GlobalConfig.getApList(),e=[];for(var i in t)e.push(t[i]);e.sort(function(t,e){return t.tab!=e.tab?t.tab-e.tab:t.type_order-e.type_order});var n=[],o=[],s=[];for(var i in e){var r=e[i];(0==r.tab||this.getAliveState(r.id)<2&&!n[r.tab])&&(n[r.tab]=!0,o[r.id]=r),0!=r.tab&&(s[r.tab]=r)}for(var i in s){var r=s[i];n[r.tab]||(o[r.id]=r)}return o},e.prototype.getzhuanFight=function(){var t=RoleProxy.ins().getMoneyAttr(MoneyAttr.ZHUAN),e=GlobalConfig.getZhuanById(t);return e?UtilProxy.GetAttrFight(e):0},e.prototype.getxianfuFight=function(){var t=this.xianfu_level,e=GlobalConfig.getAliveLvdataById(t);return e?UtilProxy.GetAttrFight(e):0},e.prototype.getZhuanRed=function(){return SystemOpenProxy.ins().isOpen(2,1902,!0)?this.zhuan_red:!1},e.prototype.getLimitRed=function(){if(SystemOpenProxy.ins().isOpen(2,1903,!0)){var t=GlobalConfig.getXianLimitActList();for(var e in t){var i=!1;switch(t[e].type){case 1:i=PvpProxy.ins().getTopRed();break;case 2:i=FacFightProxy.ins().getRed();break;case 3:break;case 4:var n=ActivityProxy.ins().getActivityDataById(ActivityType.Yama);void 0!=n&&1==n.act_status&&(i=!0);case 6:i=LeitaiProxy.ins().getIsOpen()}if(i)return!0}}return!1},e.prototype.getDujieRed=function(){if(!SystemOpenProxy.ins().isOpen(1,19,!0))return!1;for(var t in this.dujie_task_list){var e=this.dujie_task_list[t];if(1==e.is_completed)return!0}return this.dujie_copy_finish},e.prototype.getRed=function(){return SystemOpenProxy.ins().isOpen(1,19,!0)?this.getAchieRed()||this.getZhuanRed()||ZhenbaoProxy.ins().getRed()||this.getDujieRed():!1},e.prototype.C2SReqTitleGetXianweiInfo=function(){var t=new net_protocol.C2SReqTitleGetXianweiInfo;this.sendPbPack(Msg.C2SReqTitleGetXianweiInfo,t,net_protocol.C2SReqTitleGetXianweiInfo)},e.prototype.C2SReqTitleUpgradeXianwei=function(){var t=new net_protocol.C2SReqTitleUpgradeXianwei;this.sendPbPack(Msg.C2SReqTitleUpgradeXianwei,t,net_protocol.C2SReqTitleUpgradeXianwei)},e.prototype.S2CRepTitleGetXianweiInfo=function(t){var e=net_protocol.S2CRepTitleGetXianweiInfo.decode(t.bytes);if(this.xianwei=e.id,GameMap.centerEntity){var i=this.getXianweiNameById(e.id)||"";GameMap.centerEntity.setXianWei(i)}EventProxy.Broast(EventType.S2CRepTitleGetXianweiInfo,[])},e.prototype.S2CRepTitleUpgradeXianwei=function(t){var e=net_protocol.S2CRepTitleUpgradeXianwei.decode(t.bytes);if(this.xianwei=e.id,GameMap.centerEntity){var i=this.getXianweiNameById(e.id)||"";GameMap.centerEntity.setXianWei(i)}EventProxy.Broast(EventType.S2CRepTitleUpgradeXianwei,[])},e.prototype.getXianwei=function(){return this.xianwei},e.prototype.getXianweiName=function(){return void 0==GlobalConfig.getXianwei_base_dataConfig(this.xianwei)?"":" "+GlobalConfig.getXianwei_base_dataConfig(this.xianwei).name},e.prototype.getXianweiNameById=function(t){return void 0==GlobalConfig.getXianwei_base_dataConfig(t)?"":" "+GlobalConfig.getXianwei_base_dataConfig(t).name},e}(BaseSystem);__reflect(XiuXianProxy.prototype,"XiuXianProxy");var GameSystem;!function(t){t.xiuXianProxy=XiuXianProxy.ins.bind(XiuXianProxy)}(GameSystem||(GameSystem={}));var XyProxy=function(t){function e(){var e=t.call(this)||this;return e.req_pos_list_time=0,e}return __extends(e,t),e.prototype.getRed=function(){return this.flower_red||this.reward_red||this.ring_red||this.task_red||this.copy_red||this.active_red},e.prototype.getFlowerRed=function(){return this.flower_red},e.prototype.getRewardRed=function(){return this.reward_red},e.prototype.getRingRed=function(){return this.ring_red},e.prototype.getTaskRed=function(){return this.task_red},e.prototype.getCopyRed=function(){return this.copy_red},e.prototype.getActiveRed=function(){return this.active_red},e.prototype.updateFlowerRed=function(){if(!this.is_marry)return this.flower_red=!1,void EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()]);var t=GlobalConfig.getXyFlowerById(this.flower_Info.level+1);t&&this.flower_Info.exp>=t.exp?this.flower_red=!0:this.flower_red=!1,EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()])},e.prototype.updateRewardRed=function(){var t=GlobalConfig.getXyMiscData().grade_need_flower,e=Math.floor(this.flower_Info.level/t);this.reward_red=e>this.award_index,EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()])},e.prototype.updateRingRed=function(){if(!this.is_marry)return this.flower_red=!1,void EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()]);if(this.getRinglvupRed())return this.ring_red=!0,void EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()]);for(var t=1;6>t;t++)if(this.getRedBySkillId(t))return this.ring_red=!0,void EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()]);this.ring_red=!1,EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()])},e.prototype.getRinglvupRed=function(){if(!this.is_marry)return!1;var t=this.getRingData(this.ring_data.ring_type,this.ring_data.level+1),e=GlobalConfig.getXyMiscData().ring_exp_metrial[0];return t&&BagProxy.ins().getItemCountById(e)>0?!0:!1},e.prototype.getRedBySkillId=function(t){if(!this.is_marry)return!1;var e=this.getSkillLv(t);if(0==e)return!1;var i=GlobalConfig.getXySkillById(t,e+1);if(i){if(i.ring_level<this.ring_data.level)return!1;for(var n=0;n<i.items.length;n++){var o=i.items[n];if(BagProxy.ins().getItemCountById(o[0])<o[1])return!1}return!0}return!1},e.prototype.updateTaskRed=function(){this.getRedByTaskType(1)||this.getRedByTaskType(2)?this.task_red=!0:this.task_red=!1,EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()])},e.prototype.getRedByTaskType=function(t){var e=this.getTaskList(t);for(var i in e){var n=this.getTaskData(t,parseInt(i));if(n&&1==n.state)return!0}return!1},e.prototype.updateCopyRed=function(){if(!this.is_marry)return this.copy_red=!1,void EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()]);var t=(GlobalConfig.getXyCopyDataById(2),GlobalConfig.getXyMiscData()),i=t.xianyuan_times+e.ins().getCopyBuyTimes(1)-e.ins().getCopyUseTimes(1);this.copy_red=i>0,EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()])},e.prototype.updateActiveRed=function(){if(!this.is_marry)return this.active_red=!1,void EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()]);var t=(GlobalConfig.getXyCopyDataById(3),GlobalConfig.getXyMiscData()),i=t.xianyuan_times+e.ins().getCopyBuyTimes(2)-e.ins().getCopyUseTimes(2);this.active_red=i>0,EventProxy.Broast(EventType.XyUpdateRed,[this.getRed()])},e.prototype.getSkillItems=function(){if(!this.skill_items){this.skill_items=[];for(var t=1;6>t;t++)for(var e=GlobalConfig.getXySkillById(t,1),i=0;i<e.items.length;i++){var n=e.items[i];this.skill_items[n[0]]=!0}}return this.skill_items},e.prototype.getRingItem=function(){return GlobalConfig.getXyMiscData().ring_exp_metrial[0]},e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqXianyuanGetInfo=function(){var t=new net_protocol.C2SReqXianyuanGetInfo;this.sendPbPack(Msg.C2SReqXianyuanGetInfo,t,net_protocol.C2SReqXianyuanGetInfo)},e.prototype.C2SReqXianyuanGetPostlist=function(t){var e=new net_protocol.C2SReqXianyuanGetPostlist;e.type=t,this.sendPbPack(Msg.C2SReqXianyuanGetPostlist,e,net_protocol.C2SReqXianyuanGetPostlist)},e.prototype.C2SReqXianyuanPostXiangqin=function(t,e){var i=new net_protocol.C2SReqXianyuanPostXiangqin;i.cfg_id=t,i.content=e,this.sendPbPack(Msg.C2SReqXianyuanPostXiangqin,i,net_protocol.C2SReqXianyuanPostXiangqin)},e.prototype.C2SReqXianyuanPostZhaoqin=function(){var t=new net_protocol.C2SReqXianyuanPostZhaoqin;this.sendPbPack(Msg.C2SReqXianyuanPostZhaoqin,t,net_protocol.C2SReqXianyuanPostZhaoqin)},e.prototype.C2SReqXianyuanReqMarry=function(t,e){var i=new net_protocol.C2SReqXianyuanReqMarry;i.id=t,i.role_id=e,this.sendPbPack(Msg.C2SReqXianyuanReqMarry,i,net_protocol.C2SReqXianyuanReqMarry)},e.prototype.C2SReqXianyuanJoinBattleMarry=function(t,e){var i=new net_protocol.C2SReqXianyuanJoinBattleMarry;i.id=t,i.role_id=e,this.sendPbPack(Msg.C2SReqXianyuanJoinBattleMarry,i,net_protocol.C2SReqXianyuanJoinBattleMarry)},e.prototype.C2SReqXianyuanReplyMarry=function(t,e){var i=new net_protocol.C2SReqXianyuanReplyMarry;i.opt=t,i.role_id=e,this.sendPbPack(Msg.C2SReqXianyuanReplyMarry,i,net_protocol.C2SReqXianyuanReplyMarry)},e.prototype.C2SReqXianyuanUpgradeFlower=function(t){var e=new net_protocol.C2SReqXianyuanUpgradeFlower;e.opt=t,this.sendPbPack(Msg.C2SReqXianyuanUpgradeFlower,e,net_protocol.C2SReqXianyuanUpgradeFlower)},e.prototype.C2SReqXianyuanGetXianyuanAward=function(t){var e=new net_protocol.C2SReqXianyuanGetXianyuanAward;e.index=t,this.sendPbPack(Msg.C2SReqXianyuanGetXianyuanAward,e,net_protocol.C2SReqXianyuanGetXianyuanAward)},e.prototype.C2SReqXianyuanUpgradeRing=function(t){var e=new net_protocol.C2SReqXianyuanUpgradeRing;e.opt=t,this.sendPbPack(Msg.C2SReqXianyuanUpgradeRing,e,net_protocol.C2SReqXianyuanUpgradeRing)},e.prototype.C2SReqXianyuanUpgradeSkill=function(t){var e=new net_protocol.C2SReqXianyuanUpgradeSkill;e.index=t,this.sendPbPack(Msg.C2SReqXianyuanUpgradeSkill,e,net_protocol.C2SReqXianyuanUpgradeSkill)},e.prototype.C2SReqXianyuanGetRanklist=function(t){var e=new net_protocol.C2SReqXianyuanGetRanklist;e.type=t,this.sendPbPack(Msg.C2SReqXianyuanGetRanklist,e,net_protocol.C2SReqXianyuanGetRanklist)},e.prototype.C2SReqXianyuanGetTasklist=function(t){var e=new net_protocol.C2SReqXianyuanGetTasklist;e.type=t,this.sendPbPack(Msg.C2SReqXianyuanGetTasklist,e,net_protocol.C2SReqXianyuanGetTasklist)},e.prototype.C2SReqXianyuanGetTaskAward=function(t,e){var i=new net_protocol.C2SReqXianyuanGetTaskAward;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqXianyuanGetTaskAward,i,net_protocol.C2SReqXianyuanGetTaskAward)},e.prototype.C2SReqXianyuanEnterXianyuanCopy=function(t){var e=new net_protocol.C2SReqXianyuanEnterXianyuanCopy;e.copy_type=t,this.sendPbPack(Msg.C2SReqXianyuanEnterXianyuanCopy,e,net_protocol.C2SReqXianyuanEnterXianyuanCopy)},e.prototype.C2SReqXianyuanDivorce=function(){var t=new net_protocol.C2SReqXianyuanDivorce;this.sendPbPack(Msg.C2SReqXianyuanDivorce,t,net_protocol.C2SReqXianyuanDivorce)},e.prototype.C2SReqXianyuanChooseBattle=function(t,e){var i=new net_protocol.C2SReqXianyuanChooseBattle;i.id=t,i.role_id=e,this.sendPbPack(Msg.C2SReqXianyuanChooseBattle,i,net_protocol.C2SReqXianyuanChooseBattle)},e.prototype.C2SReqXianyuanBuyCopyTimes=function(t){var e=new net_protocol.C2SReqXianyuanBuyCopyTimes;e.copy_type=t,this.sendPbPack(Msg.C2SReqXianyuanBuyCopyTimes,e,net_protocol.C2SReqXianyuanBuyCopyTimes)},e.prototype.C2SReqXianyuanXunyouEnd=function(){var t=new net_protocol.C2SReqXianyuanXunyouEnd;this.sendPbPack(Msg.C2SReqXianyuanXunyouEnd,t,net_protocol.C2SReqXianyuanXunyouEnd)},e.prototype.S2CRepXianyuanGetInfo=function(t){var e=this,i=net_protocol.S2CRepXianyuanGetInfo.decode(t.bytes);this.qh_list=[],this.skill_list=[],this.copy_time_list=[],this.is_marry=i.is_marry,this.marry_time=i.marry_time,this.flower_Info=i.flower,this.ring_data=i.ring,this.rank_end_time=i.rank_end_time,this.award_index=i.award_index,this.xy_fight=i.companion_fight;for(var n=0;n<i.skill_list.length;n++){var o=i.skill_list[n];this.skill_list[o.index]=o.level}for(var n=0;n<i.list.length;n++){var o=i.list[n];o.role_id==RoleProxy.ins().getRoleId()?this.left_info=o:this.right_info=o}for(var n=0;n<i.copy_list.length;n++){var o=i.copy_list[n];this.copy_time_list[o.copy_type]=o}if(i.zhaoqin_notice>0&&TimerManager.ins().doTimer(2,1,function(){ViewManager.ins().open(XyQhView,3,e.left_info,e.right_info,i.zhaoqin_notice+3,e.right_info.name)},this),GameMap.centerEntity){var s="";this.is_marry&&(s=UtilProxy.getStr("|C:8&@0 的伴侣|",[this.right_info.name])),GameMap.centerEntity.setBanglv(s)}this.updateFlowerRed(),this.updateRewardRed(),this.updateRingRed(),this.updateCopyRed(),this.updateActiveRed(),EventProxy.Broast(EventType.S2CRepXianyuanGetInfo,[])},e.prototype.S2CRepXianyuanGetPostlist=function(t){var e=net_protocol.S2CRepXianyuanGetPostlist.decode(t.bytes);0==e.type?(this.xiang_list=e.xiang_list,this.zhao_list=e.zhao_list):1==e.type?this.xiang_list=e.xiang_list:2==e.type&&(this.zhao_list=e.zhao_list),this.xiang_list&&this.xiang_list.length&&this.xiang_list.sort(function(t,e){return e.time-t.time}),EventProxy.Broast(EventType.S2CRepXianyuanGetPostlist,[])},e.prototype.S2CRepXianyuanPostXiangqin=function(t){var e=net_protocol.S2CRepXianyuanPostXiangqin.decode(t.bytes);if(this.xiang_list){if(1==e.flag)this.xiang_list.push(e.info);else if(2==e.flag){for(var i=0;i<this.xiang_list.length;i++)if(this.xiang_list[i].id==e.id){this.xiang_list[i]=e.info;break}}else if(3==e.flag)for(var i=0;i<this.xiang_list.length;i++)if(this.xiang_list[i].id==e.id){this.xiang_list.splice(i,1);break}this.xiang_list&&this.xiang_list.length&&this.xiang_list.sort(function(t,e){return e.time-t.time}),EventProxy.Broast(EventType.S2CRepXianyuanPostXiangqin,[])}},e.prototype.S2CRepXianyuanPostZhaoqin=function(t){var e=net_protocol.S2CRepXianyuanPostZhaoqin.decode(t.bytes);if(this.zhao_list){if(1==e.flag)this.zhao_list.push(e.info);else if(2==e.flag){for(var i=0;i<this.zhao_list.length;i++)if(this.zhao_list[i].id==e.id){this.zhao_list[i]=e.info;break}}else if(3==e.flag)for(var i=0;i<this.zhao_list.length;i++)if(this.zhao_list[i].id==e.id){this.zhao_list.splice(i,1);break}EventProxy.Broast(EventType.S2CRepXianyuanPostZhaoqin,[])}},e.prototype.checkQh=function(){if(!this.is_marry&&this.qh_list.length>0&&!ViewManager.ins().isShow(XyQhView)){var t=this.qh_list.shift();ViewManager.ins().open(XyQhView,2,t.left,t.right,t.role_id)}},e.prototype.S2CRepXianyuanReqMarry=function(t){var e=net_protocol.S2CRepXianyuanReqMarry.decode(t.bytes);this.qh_list.push(e),this.checkQh(),EventProxy.Broast(EventType.S2CRepXianyuanReqMarry,[])},e.prototype.S2CRepXianyuanReplyMarry=function(t){var e=net_protocol.S2CRepXianyuanReplyMarry.decode(t.bytes);
ViewManager.ins().open(XyQhView,3,e.left,e.right,e.opt,e.name),EventProxy.Broast(EventType.S2CRepXianyuanReplyMarry,[])},e.prototype.S2CRepXianyuanUpgradeFlower=function(t){var e=net_protocol.S2CRepXianyuanUpgradeFlower.decode(t.bytes);this.flower_Info&&(this.flower_Info.exp=e.info.exp,this.flower_Info.level=e.info.level,EventProxy.Broast(EventType.S2CRepXianyuanUpgradeFlower,[]))},e.prototype.S2CRepXianyuanUpdateXianyuanAward=function(t){var e=net_protocol.S2CRepXianyuanUpdateXianyuanAward.decode(t.bytes);this.award_index=e.award_index,this.updateRewardRed(),EventProxy.Broast(EventType.S2CRepXianyuanUpdateXianyuanAward,[])},e.prototype.S2CRepXianyuanUpgradeRing=function(t){var e=net_protocol.S2CRepXianyuanUpgradeRing.decode(t.bytes);this.ring_data=e.info,this.updateRingRed(),EventProxy.Broast(EventType.S2CRepXianyuanUpgradeRing,[])},e.prototype.S2CRepXianyuanUpgradeSkill=function(t){for(var e=net_protocol.S2CRepXianyuanUpgradeSkill.decode(t.bytes),i=0;i<e.list.length;i++){var n=e.list[i];this.skill_list[n.index]=n.level}this.updateRingRed(),EventProxy.Broast(EventType.S2CRepXianyuanUpgradeSkill,[])},e.prototype.S2CRepXianyuanGetRanklist=function(t){net_protocol.S2CRepXianyuanGetRanklist.decode(t.bytes);EventProxy.Broast(EventType.S2CRepXianyuanGetRanklist,[])},e.prototype.S2CRepXianyuanGetTasklist=function(t){var e=net_protocol.S2CRepXianyuanGetTasklist.decode(t.bytes);if(this.task_list||(this.task_list=[]),this.task_day_list||(this.task_day_list=[]),1==e.type)for(var i=0;i<e.list.length;i++){var n=e.list[i];this.task_list[n.id]=n}else for(var i=0;i<e.list.length;i++){var n=e.list[i];this.task_day_list[n.id]=n}this.updateTaskRed(),EventProxy.Broast(EventType.S2CRepXianyuanGetTasklist,[])},e.prototype.S2CRepXianyuanUpdateTaskList=function(t){var e=net_protocol.S2CRepXianyuanUpdateTasklist.decode(t.bytes);if(this.task_list||(this.task_list=[]),this.task_day_list||(this.task_day_list=[]),1==e.type?this.task_list[e.info.id]=e.info:this.task_day_list[e.info.id]=e.info,2==e.info.state){var i=this.getTaskList(e.type)[e.info.id];if(i){for(var n=i.items,o=[],s=0;s<n.length;s++){var r=new ItemCellData;r.setItemCellData({item_slot_idx:0,item_type_id:n[s][0],item_count:n[s][1]}),o.push(r)}o.length>0&&TipsControl.ins().showReward(o)}}this.updateTaskRed(),EventProxy.Broast(EventType.S2CRepXianyuanUpdateTaskList,[])},e.prototype.S2CRepXianyuanPostState=function(t){var e=net_protocol.S2CRepXianyuanPostState.decode(t.bytes),i=1==e.type?"相亲":"招亲";0==e.code?TipsControl.ins().showTips("C:10恭喜，发布"+i+"成功"):1==e.code?TipsControl.ins().showTips("C:4&你已经结婚了"):2==e.code?TipsControl.ins().showTips("C:4&你已经发布了招新了，不可重复，慎之"):3==e.code&&TipsControl.ins().showTips("C:4&招亲进行中"),EventProxy.Broast(EventType.S2CRepXianyuanPostState,[])},e.prototype.S2CRepXianyuanZhaoqinOppInfo=function(t){var e=net_protocol.S2CRepXianyuanZhaoqinOppInfo.decode(t.bytes);this.fight_list||(this.fight_list=[]),this.fight_list[e.id]=e.opp_list,EventProxy.Broast(EventType.S2CRepXianyuanZhaoqinOppInfo,[])},e.prototype.S2CRepXianyuanUpdateCopyInfo=function(t){var e=net_protocol.S2CRepXianyuanUpdateCopyInfo.decode(t.bytes);this.copy_time_list||(this.copy_time_list=[]),this.copy_time_list[e.info.copy_type]=e.info,1==e.info.copy_type?this.updateCopyRed():this.updateActiveRed(),EventProxy.Broast(EventType.S2CRepXianyuanUpdateCopyInfo,[])},e.prototype.S2CRepXianyuanMarryBattleResult=function(t){var e=net_protocol.S2CRepXianyuanMarryBattleResult.decode(t.bytes);ViewManager.ins().open(FbendView,e.result,e.score,EndType.XYQQ),EventProxy.Broast(EventType.S2CRepXianyuanMarryBattleResult,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(28150,this.S2CRepXianyuanGetInfo,this),MsgHandle.ins().regNetMsg(28151,this.S2CRepXianyuanGetPostlist,this),MsgHandle.ins().regNetMsg(28152,this.S2CRepXianyuanPostXiangqin,this),MsgHandle.ins().regNetMsg(28153,this.S2CRepXianyuanPostZhaoqin,this),MsgHandle.ins().regNetMsg(28154,this.S2CRepXianyuanReqMarry,this),MsgHandle.ins().regNetMsg(28155,this.S2CRepXianyuanReplyMarry,this),MsgHandle.ins().regNetMsg(28156,this.S2CRepXianyuanUpgradeFlower,this),MsgHandle.ins().regNetMsg(28157,this.S2CRepXianyuanUpdateXianyuanAward,this),MsgHandle.ins().regNetMsg(28158,this.S2CRepXianyuanUpgradeRing,this),MsgHandle.ins().regNetMsg(28159,this.S2CRepXianyuanUpgradeSkill,this),MsgHandle.ins().regNetMsg(28160,this.S2CRepXianyuanGetRanklist,this),MsgHandle.ins().regNetMsg(28161,this.S2CRepXianyuanGetTasklist,this),MsgHandle.ins().regNetMsg(28162,this.S2CRepXianyuanUpdateTaskList,this),MsgHandle.ins().regNetMsg(28163,this.S2CRepXianyuanPostState,this),MsgHandle.ins().regNetMsg(28164,this.S2CRepXianyuanZhaoqinOppInfo,this),MsgHandle.ins().regNetMsg(28165,this.S2CRepXianyuanUpdateCopyInfo,this),MsgHandle.ins().regNetMsg(28166,this.S2CRepXianyuanMarryBattleResult,this)},e.prototype.getPostList=function(t){return 0==this.req_pos_list_time||TimerManager.ins().getCurrTime()-this.req_pos_list_time>6e4?(this.req_pos_list_time=TimerManager.ins().getCurrTime(),this.C2SReqXianyuanGetPostlist(0),[]):1==t?this.xiang_list||[]:this.zhao_list||[]},e.prototype.getTitleIcon=function(t,e){var i=GlobalConfig.getSetup_head_dataConfig(t);return i||(i=GlobalConfig.getSetup_head_dataConfig(e)),i?i.icon:""},e.prototype.getTitleBg=function(t){var e=GlobalConfig.getSetup_head_frame_dataConfig(t);return e||(e=GlobalConfig.getSetup_head_frame_dataConfig(1)),e?e.icon:""},e.prototype.getMarryDay=function(){if(this.marry_time>0){var t=Math.floor((GameLogic.ins().getServerTime()-this.marry_time)/86400)+1;return t}return 1},e.prototype.getSkillLv=function(t){return this.skill_list[t]||0},e.prototype.getCopyUseTimes=function(t){return this.copy_time_list&&this.copy_time_list[t]?this.copy_time_list[t].use_times:0},e.prototype.getCopyBuyTimes=function(t){return this.copy_time_list&&this.copy_time_list[t]?this.copy_time_list[t].buy_times:0},e.prototype.getTaskData=function(t,e){return 1==t?this.task_list[e]:this.task_day_list[e]},e.prototype.getFightList=function(t){return this.fight_list[t]||[]},e.prototype.getRingData=function(t,e){return 0==t?GlobalConfig.getXyRingById(e):GlobalConfig.getXyHeightRingById(e)},e.prototype.getTaskList=function(t){if(1==t){var e,i=GlobalConfig.getXyTaskList(),n=[],o=[];for(var s in i){var r=i[s];e=this.getTaskData(t,r.id),o[r.type]||e&&2==e.state||(o[r.type]=!0,n.push(r))}return n}var a,h=GlobalConfig.getXyDayTaskList(),l=[],p=[];for(var s in h){var r=h[s];a=this.getTaskData(t,r.id),p[r.type]||a&&2==a.state||(p[r.type]=!0,l.push(r))}return l},e.prototype.getTaskByID=function(t,e){return 1==t?GlobalConfig.getXyTaskById(e):GlobalConfig.getXyDayTaskById(e)},e}(BaseSystem);__reflect(XyProxy.prototype,"XyProxy");var YezhanProxy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.score=0,e.challenge_count=0,e.recover_time=0,e.refresh_count=0,e.buy_times=0,e.guwu_count=0,e.running=!1,e.pos={x:0,y:0},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqYezhanGetInfo=function(){var t=net_protocol.C2SReqYezhanGetInfo;this.sendPbPack(Msg.C2SReqYezhanGetInfo,t,net_protocol.C2SReqYezhanGetInfo)},e.prototype.C2SReqYezhanBuyTimes=function(){var t=net_protocol.C2SReqYezhanBuyTimes;this.sendPbPack(Msg.C2SReqYezhanBuyTimes,t,net_protocol.C2SReqYezhanBuyTimes)},e.prototype.C2SReqYezhanRefreshOpp=function(){var t=net_protocol.C2SReqYezhanRefreshOpp;this.sendPbPack(Msg.C2SReqYezhanRefreshOpp,t,net_protocol.C2SReqYezhanRefreshOpp)},e.prototype.C2SReqYezhanGuwu=function(){var t=net_protocol.C2SReqYezhanGuwu;this.sendPbPack(Msg.C2SReqYezhanGuwu,t,net_protocol.C2SReqYezhanGuwu)},e.prototype.C2SReqYezhanChallenge=function(t){var e=new net_protocol.C2SReqYezhanChallenge;e.id=t,this.sendPbPack(Msg.C2SReqYezhanChallenge,e,net_protocol.C2SReqYezhanChallenge)},e.prototype.C2SReqYezhanChallengeResult=function(t){var e=new net_protocol.C2SReqYezhanChallengeResult;e.result=t,this.sendPbPack(Msg.C2SReqYezhanChallengeResult,e,net_protocol.C2SReqYezhanChallengeResult),TimerManager.ins().remove(this.checkResult2,this)},e.prototype.S2CRepYezhanGetInfo=function(t){var e=net_protocol.S2CRepYezhanGetInfo.decode(t.bytes);this.challenge_count=e.challenge_count,this.score=e.score,this.recover_time=e.recover_time,this.refresh_count=e.refresh_count,this.buy_times=e.buy_times,this.guwu_count=e.guwu_count,this.opp_list=e.opp_list,EventProxy.Broast(EventType.S2CRepYezhanGetInfo,[])},e.prototype.S2CRepYezhanBuyTimes=function(t){net_protocol.S2CRepYezhanBuyTimes.decode(t.bytes);this.buy_times+=1,this.challenge_count+=1,EventProxy.Broast(EventType.S2CRepYezhanBuyTimes,[])},e.prototype.S2CRepYezhanRefreshOpp=function(t){var e=net_protocol.S2CRepYezhanRefreshOpp.decode(t.bytes);this.opp_list=e.opp_list,this.refresh_count+=1,EventProxy.Broast(EventType.S2CRepYezhanRefreshOpp,[])},e.prototype.S2CRepYezhanGuwu=function(t){var e=net_protocol.S2CRepYezhanGuwu.decode(t.bytes);this.guwu_count=e.guwu_count,EventProxy.Broast(EventType.S2CRepYezhanGuwu,[])},e.prototype.S2CRepYezhanChallenge=function(t){var e=net_protocol.S2CRepYezhanChallenge.decode(t.bytes);if(this.challenge_list||(this.challenge_list=[]),this.challenge_list[e.id]=e,this.isCanYezhan()&&GameMap.centerEntity){this.running=!0,ViewManager.ins().close(ShenxianView),ViewManager.ins().close(XianFuView),this.self_handle=GameMap.centerEntity.handle,GameMap.centerEntity.AI.stop(),HangManager.ins().setPause(!0),this.pos=HangManager.ins().getNextPosCfg(),GameMap.centerEntity.isMoveing()||HangManager.ins().setCurWave(1),this.checkMonsterClient();var i=GameLogic.ins().doCreateYezhanRole(e);this.enemy_handle=i,this.enemy_name=e.name,GameMap.centerEntity.AI.continueAI(),TimerManager.ins().doTimer(2e4,1,this.checkResult2,this)}EventProxy.Broast(EventType.S2CRepYezhanChallenge,[])},e.prototype.S2CRepYezhanChallengeResult=function(t){for(var e=net_protocol.S2CRepYezhanChallengeResult.decode(t.bytes),i=GlobalConfig.getYezhanMisc(),n=1==e.result?i.win_award:i.lose_award,o=[],s=0;s<n.length;s++){var r=new ItemCellData,a={item_slot_idx:0,item_type_id:n[s][0],item_count:n[s][1]};r.setItemCellData(a),o.push(r)}var h="";h=1==e.result?UtilProxy.getStr("恭喜你挑战胜利!\n击败对手|C:10&@0 |",[this.enemy_name]):UtilProxy.getStr("很遗憾,挑战对手|C:10&@0 |失败了!",[this.enemy_name]),ViewManager.ins().open(PvpEndView,o,1==e.result,EndType.YEZHAN,h),1==e.result?this.score+=i.win_score:this.score+=i.lose_score,HangManager.ins().setPause(!1),EventProxy.Broast(EventType.S2CRepYezhanChallengeResult,[])},e.prototype.S2CRepYezhanUpdate=function(t){var e=net_protocol.S2CRepYezhanUpdate.decode(t.bytes);this.challenge_count=e.challenge_count,this.recover_time=e.recover_time,EventProxy.Broast(EventType.S2CRepYezhanUpdate,[])},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(26250,this.S2CRepYezhanGetInfo,this),MsgHandle.ins().regNetMsg(26251,this.S2CRepYezhanBuyTimes,this),MsgHandle.ins().regNetMsg(26252,this.S2CRepYezhanRefreshOpp,this),MsgHandle.ins().regNetMsg(26253,this.S2CRepYezhanGuwu,this),MsgHandle.ins().regNetMsg(26254,this.S2CRepYezhanChallenge,this),MsgHandle.ins().regNetMsg(26255,this.S2CRepYezhanChallengeResult,this),MsgHandle.ins().regNetMsg(26256,this.S2CRepYezhanUpdate,this)},e.prototype.getOppList=function(){return this.opp_list||[]},e.prototype.getChallengeById=function(t){},e.prototype.getRewardByRankId=function(t){var e=t,i=GlobalConfig.getRankdailyList(14);for(var n in i){var o=i[n];if(e>=o.up_rank&&e<=o.down_rank)return o.award}return[]},e.prototype.isCanYezhan=function(){var t=GameLogic.ins().getCurSceneData();return t&&1==t.scene_type&&1==t.client_create_monster},e.prototype.isRunning=function(){return this.running},e.prototype.getEnemyhandle=function(){return this.enemy_handle},e.prototype.checkResult=function(t){if(this.running&&this.isCanYezhan()){t==this.self_handle?(this.running=!1,this.C2SReqYezhanChallengeResult(2)):(this.running=!1,this.C2SReqYezhanChallengeResult(1));var e=GameLogic.ins().getEntityByHandle(this.self_handle),i=GameLogic.ins().getEntityByHandle(this.enemy_handle);e&&i&&i.getHP()>0&&GameLogic.ins().doEntityDie1(i,e),this.enemy_handle=0}},e.prototype.checkResult2=function(){if(this.enemy_handle>0){var t=GameLogic.ins().getEntityByHandle(this.self_handle),e=GameLogic.ins().getEntityByHandle(this.enemy_handle);if(t&&e){var i=t.getHP()/t.getHPMax(),n=e.getHP()/e.getHPMax();i>n?(this.running=!1,this.C2SReqYezhanChallengeResult(1)):(this.running=!1,this.C2SReqYezhanChallengeResult(2)),t&&e&&e.getHP()>0&&GameLogic.ins().doEntityDie1(e,t),this.enemy_handle=0}}},e.prototype.checkDamage=function(t,e,i){if(t&&e){if(t.is_main&&this.running&&e.handle==this.enemy_handle){var n=GlobalConfig.getYezhanMisc();if(n&&this.guwu_count>0)return i*(1+this.guwu_count*n.guwu_per*.01)}return i}},e.prototype.checkMonsterClient=function(){for(var t=GameLogic.ins().getEntityList(),e=0;e<t.length;e++){var i=t[e];if(i instanceof EntityMonsterClient){EventProxy.Broast(EventType.HangMonsterDie,[i.handle,i.x,i.y]),GameLogic.ins().doEntityDie1(i,GameMap.centerEntity)}}},e.prototype.checkAI=function(){if(this.running&&!(this.enemy_handle<=0)){var t=GameLogic.ins().getEntityByHandle(this.enemy_handle);t&&!t.AI.runing&&t.AI.start()}},e}(BaseSystem);__reflect(YezhanProxy.prototype,"YezhanProxy");var ZbTaoZhuangProxy=function(t){function e(){var e=t.call(this)||this;return e.isTure=!1,e.clickOkBefor=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqGrowupEquipSuitGetInfo=function(){var t=new net_protocol.C2SReqGrowupEquipSuitGetInfo;this.sendPbPack(Msg.C2SReqGrowupEquipSuitGetInfo,t,net_protocol.C2SReqGrowupEquipSuitGetInfo)},e.prototype.C2SReqGrowupEquipSuitGetAward=function(t){var e=new net_protocol.C2SReqGrowupEquipSuitGetAward;e.id=t,this.sendPbPack(Msg.C2SReqGrowupEquipSuitGetAward,e,net_protocol.C2SReqGrowupEquipSuitGetAward)},e.prototype.C2SReqGrowupEquipSuitLightUp=function(t){var e=new net_protocol.C2SReqGrowupEquipSuitLightUp;e.id=t,this.sendPbPack(Msg.C2SReqGrowupEquipSuitLightUp,e,net_protocol.C2SReqGrowupEquipSuitLightUp)},e.prototype.S2CRepGrowupEquipSuitGetInfo=function(t){var e=net_protocol.S2CRepGrowupEquipSuitGetInfo.decode(t.bytes);void 0==this.dataMsgInfo&&(this.dataMsgInfo={});for(var i=0;i<e.list.length;i++)this.dataMsgInfo[e.list[i].id]=e.list[i]},e.prototype.S2CRepGrowupEquipSuitUpdate=function(t){var e=net_protocol.S2CRepGrowupEquipSuitUpdate.decode(t.bytes);void 0==this.dataMsgInfo&&(this.dataMsgInfo={}),this.dataMsgInfo[e.info.id]=e.info,EventProxy.Broast(EventType.S2CRepGrowupEquipSuitUpdate,{})},e.prototype.getRed=function(t){var e=!1,i=this.getZbTaoById(t);if(i&&i.length>0)for(var n=0;n<i.length;n++)1===i[n].state&&(e=!0);return e},e.prototype.getRedByAll=function(){var t=1;for(var e in this.dataMsgInfo){if(Number(e)!=t)return!1;var i=this.dataMsgInfo[e];if(1!=this.dataMsgInfo[e].finish){for(var n=0;n<i.parts.length;n++)if(1==i.parts[n].state)return!0;return!1}t++}return!1},e.prototype.jihuoMany=function(t){var e=[],i=this.dataMsgInfo[t];if(i){var n=this.manyTao(t),o=GlobalConfig.getZbTzAttrList(t);for(var s in o)n>=Number(s)&&e.push(null);return e.length}return 0},e.prototype.manyTao=function(t){var e=0,i=this.dataMsgInfo[t];if(i){for(var n=0;n<i.parts.length;n++)2==i.parts[n].state&&e++;return e}return 0},e.prototype.getHaveBeforeById=function(t){if(this.dataMsgInfo){var e=this.dataMsgInfo[t];if(e)return e.parts.length}return 0},e.prototype.getZbTaoById=function(t){var e=[],i=[],n=GlobalConfig.getzbTzById(t);if(n){var o=this.dataMsgInfo[t];if(o){for(var s=0;s<o.parts.length;s++)i.push(o.parts[s].equip_id);for(var r=0;r<n.equip_list.length;r++){var a=i.indexOf(n.equip_list[r][0]);a>-1?e.push({id:n.equip_list[r],state:o.parts[a].state}):e.push({id:n.equip_list[r],state:0})}return e}for(var r=0;r<n.equip_list.length;r++)e.push({id:n.equip_list[r],state:0});return e}return null},e.prototype.getFightNum=function(){var t=[2,4,6,10],e=0;for(var i in this.dataMsgInfo){for(var n=[],o=this.dataMsgInfo[i],s=0;s<o.parts.length;s++)2==o.parts[s].state&&n.push(o.parts[s]);for(var r=1;r<=n.length;r++){var a=t.indexOf(r);if(a>-1){var h=GlobalConfig.getZbTzAttrById(o.id,t[a]);e+=UtilProxy.GetAttrFight(h)}}}return e},e.prototype.getItemById=function(t){var e=GlobalConfig.getzbTzById(t);return e?e.award:null},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27626,this.S2CRepGrowupEquipSuitGetInfo,this),MsgHandle.ins().regNetMsg(27627,this.S2CRepGrowupEquipSuitUpdate,this)},e}(BaseSystem);__reflect(ZbTaoZhuangProxy.prototype,"ZbTaoZhuangProxy");var ZhenbaoProxy=function(t){function e(){var e=t.call(this)||this;return e.treasure_list=[],e.part_list=[],e.zb_hp_pre=0,e.zb_att_pre=0,e.zb_def_pre=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqFabaoGetTreasureInfo=function(){var t=new net_protocol.C2SReqFabaoGetTreasureInfo;this.sendPbPack(Msg.C2SReqFabaoGetTreasureInfo,t,net_protocol.C2SReqFabaoGetTreasureInfo)},e.prototype.C2SReqFabaoActiveTreasure=function(t,e){var i=new net_protocol.C2SReqFabaoActiveTreasure;i.type=t,i.id=e,this.sendPbPack(Msg.C2SReqFabaoActiveTreasure,i,net_protocol.C2SReqFabaoActiveTreasure)},e.prototype.C2SReqFabaoGetTreasureAward=function(t){var e=new net_protocol.C2SReqFabaoGetTreasureAward;e.id=t,this.sendPbPack(Msg.C2SReqFabaoGetTreasureAward,e,net_protocol.C2SReqFabaoGetTreasureAward)},e.prototype.S2CRepFabaoGetTreasureInfo=function(t){var e=net_protocol.S2CRepFabaoGetTreasureInfo.decode(t.bytes);this.zb_hp_pre=0,this.zb_att_pre=0,this.zb_def_pre=0,this.treasure_list=[];for(var i in e.treasure_list){this.treasure_list[e.treasure_list[i].id]=e.treasure_list[i].award;var n=GlobalConfig.getTreasure_base_dataConfig(e.treasure_list[i].id);n&&(this.zb_hp_pre=this.zb_hp_pre+n.zb_hp_pre,this.zb_att_pre=this.zb_att_pre+n.zb_att_pre,this.zb_def_pre=this.zb_def_pre+n.zb_def_pre)}this.part_list=e.part_list,EventProxy.Broast(EventType.S2CRepFabaoGetTreasureInfo,{}),EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.S2CRepFabaoUpdateTreasure=function(t){var e=net_protocol.S2CRepFabaoUpdateTreasure.decode(t.bytes);if(1==e.type){this.treasure_list[e.id]=0;var i=GlobalConfig.getTreasure_base_dataConfig(e.id),n=UI_ZHENBAO_DIR+i.ui_model;ViewManager.ins().open(JihuoTipsView,JihuoType.zhenbao,0,n)}else 2==e.type?this.part_list.push(e.id):3==e.type&&(this.treasure_list[e.id]=1);EventProxy.Broast(EventType.S2CRepFabaoUpdateTreasure,{}),EventProxy.Broast(EventType.XiuXianUpdate,[])},e.prototype.IsZhenbaoActive=function(t){return void 0!=this.treasure_list[t]},e.prototype.IsZhenbaoPartActive=function(t){for(var e in this.part_list)if(this.part_list[e]==t)return!0;return!1},e.prototype.IsZhenbaoAwardCanGet=function(t){return 0==this.treasure_list[t]},e.prototype.GetZhenbaoActiveState=function(t){var e=GlobalConfig.getTreasure_base_dataConfig(t);if(void 0==e)return 2;if(e.last_id>0&&void 0==this.treasure_list[e.last_id])return 0;for(var i in e.part_list)if(!this.IsZhenbaoPartActive(e.part_list[i]))return 2;return 1},e.prototype.IsZhenbaoPartCanActive=function(t){if(this.IsZhenbaoPartActive(t))return!1;var e=GlobalConfig.getTreasure_part_dataConfig(t);return void 0==e||e.item.length<2?!1:BagProxy.ins().getItemCountById(e.item[0])>=e.item[1]},e.prototype.getShowZhenbaoId=function(){var t=GlobalConfig.getTreasure_base_dataList(),e=0,i=0;for(var n in t)i=Math.max(i,t[n].id),this.IsZhenbaoActive(t[n].id)&&(e=Math.max(e,t[n].id));return e==i?i:e+1},e.prototype.getTotleProInfo=function(){var t=GlobalConfig.getTreasure_base_dataList(),e={};for(var i in t){for(var n=0;n<t[i].part_list.length;n++)if(this.IsZhenbaoPartActive(t[i].part_list[n])){var o=GlobalConfig.getTreasure_part_dataConfig(t[i].part_list[n]);e=RoleProxy.ins().getTableAdd(e,o)}this.IsZhenbaoActive(t[i].id)&&(e=RoleProxy.ins().getTableAdd(e,t[i]))}return e},e.prototype.getTotleFight=function(){var t=this.getTotleProInfo();for(var e in t)"hp"==e?t[e]=t[e]*(1+this.zb_hp_pre/1e4):"attack"==e?t[e]=t[e]*(1+this.zb_att_pre/1e4):"defence"==e&&(t[e]=t[e]*(1+this.zb_def_pre/1e4));return UtilProxy.GetAttrFight(t)},e.prototype.getRed=function(){if(SystemOpenProxy.ins().isOpen(2,1904,!0)){var t=GlobalConfig.getTreasure_base_dataList();for(var e in t){if(this.IsZhenbaoAwardCanGet(t[e].id))return!0;for(var i=0;i<t[e].part_list.length;i++)if(this.IsZhenbaoPartCanActive(t[e].part_list[i]))return!0;if(!this.IsZhenbaoActive(t[e].id)&&1==this.GetZhenbaoActiveState(t[e].id))return!0}return!1}},e.prototype.getLastRed=function(t){for(var e=GlobalConfig.getTreasure_base_dataList(),i=0;t>i;i++)if(e[i]){if(this.IsZhenbaoAwardCanGet(e[i].id))return!0;for(var n=0;n<e[i].part_list.length;n++)if(this.IsZhenbaoPartCanActive(e[i].part_list[n]))return!0;if(!this.IsZhenbaoActive(e[i].id)&&1==this.GetZhenbaoActiveState(e[i].id))return!0}return!1},e.prototype.getNextRed=function(t){var e=GlobalConfig.getTreasure_base_dataList();for(var i in e)if(e[i].id>t){if(this.IsZhenbaoAwardCanGet(e[i].id))return!0;for(var n=0;n<e[i].part_list.length;n++)if(this.IsZhenbaoPartCanActive(e[i].part_list[n]))return!0;if(!this.IsZhenbaoActive(e[i].id)&&1==this.GetZhenbaoActiveState(e[i].id))return!0}return!1},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25803,this.S2CRepFabaoGetTreasureInfo,this),MsgHandle.ins().regNetMsg(25804,this.S2CRepFabaoUpdateTreasure,this)},e}(BaseSystem);__reflect(ZhenbaoProxy.prototype,"ZhenbaoProxy");var ZhuhunProxy=function(t){function e(){var e=t.call(this)||this;return e.total_level=0,e.swallow_list=[],e.part_list=[],e.IsShowRed=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqInjectsoulSoulforgeAction=function(t,e,i){var n=new net_protocol.C2SReqInjectsoulSoulforgeAction;n.part=t,n.opt_type=e,n.item_id=i,this.sendPbPack(Msg.C2SReqInjectsoulSoulforgeAction,n,net_protocol.C2SReqInjectsoulSoulforgeAction)},e.prototype.C2SReqInjectsoulSoulforgeSwallow=function(t,e){var i=new net_protocol.C2SReqInjectsoulSoulforgeSwallow;i.opt_type=t,i.item_id=e,this.sendPbPack(Msg.C2SReqInjectsoulSoulforgeSwallow,i,net_protocol.C2SReqInjectsoulSoulforgeSwallow)},e.prototype.S2CRepInjectsoulSoulforgeAction=function(t){var e=net_protocol.S2CRepInjectsoulSoulforgeAction.decode(t.bytes);if(void 0!=e.info.part){var i=[];i[0]=e.info.level,i[1]=e.info.exp,this.part_list[e.info.part]=i}this.total_level=e.total_level,EventProxy.Broast(EventType.S2CRepInjectsoulSoulforgeAction,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepInjectsoulSoulforgeSwallow=function(t){var e=net_protocol.S2CRepInjectsoulSoulforgeSwallow.decode(t.bytes);void 0!=e.info.type&&(this.swallow_list[e.info.type]=e.info.count),EventProxy.Broast(EventType.S2CRepInjectsoulSoulforgeSwallow,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.getZhuhunLevelByPart=function(t){var e=0;return this.part_list[t]&&this.part_list[t][0]&&(e=this.part_list[t][0]),e},e.prototype.getZhuhunLevel=function(){for(var t=0,e=1;10>=e;e++)t+=this.getZhuhunLevelByPart(e);return t},e.prototype.getZhuhunExpByPart=function(t){var e=0;return this.part_list[t]&&this.part_list[t][1]&&(e=this.part_list[t][1]),e},e.prototype.getTSCountByType=function(t){var e=0;return this.swallow_list[t]&&(e=this.swallow_list[t]),e},e.prototype.getZhuhunStateByType=function(t){var e=GlobalConfig.getSoulforge_swallowConfig(t),i=(this.getTSCountByType(t),0),n=0,o=this.getZhuhunLevel();for(var s in e)o>=e[s].total_level&&(i=1),n=0==n?e[s].total_level:Math.min(e[s].total_level,n);return[i,n]},e.prototype.getCurMaxTSCountByType=function(t){var e=0,i=GlobalConfig.getSoulforge_swallowConfig(t),n=this.getZhuhunLevel();for(var o in i)n>=i[o].total_level&&(e=Math.max(i[o].count,e));return e},e.prototype.getNextMaxTSLevelByType=function(t){var e=0,i=GlobalConfig.getSoulforge_swallowConfig(t),n=this.getZhuhunLevel();for(var o in i)n<i[o].total_level&&(e=0==e?i[o].total_level:Math.min(i[o].total_level,e));return e},e.prototype.getCanZhuhunUpLevelByPart=function(t){var e=this.getZhuhunLevelByPart(t),i=GlobalConfig.getSoulforge_part_dataConfig(e);if(void 0==i||0==i.exp)return!1;for(var n=GlobalConfig.getSoulforge_itemsConfig(1).items,o=this.getZhuhunExpByPart(t),s=i.exp-o,r=0;r<n.length;r++){var a=BagProxy.ins().getItemData(n[r]);if(s-=BagProxy.ins().getItemCountById(n[r])*a.flags,0>=s)return!0}return!1},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(2,1005,!0))return!1;if(this.IsShowRed)return!0;for(var t=1;10>=t;t++)if(this.getCanZhuhunUpLevelByPart(t))return!0;for(var t=1;3>=t;t++)if(this.getCurTSstate(t))return!0;return!1},e.prototype.getCurTSstate=function(t){var e=this.getZhuhunStateByType(t);if(1==e[0]){var i=GlobalConfig.getSoulforge_swallow_itemsConfig(t);if(void 0==i)return!1;var n=this.getTSCountByType(t),o=this.getCurMaxTSCountByType(t);if(o>n&&BagProxy.ins().getItemCountById(i.item_id)>0)return!0}return!1},e.prototype.getTsFight=function(){for(var t=0,e=1;3>=e;e++){var i=GlobalConfig.getSoulforge_swallow_itemsConfig(e);t+=UtilProxy.GetAttrFight(i)*this.getTSCountByType(e)}return t},e.prototype.getAllFightValue=function(){for(var t=0,e=1;10>=e;e++){var i=this.getZhuhunLevelByPart(e),n=GlobalConfig.getSoulforge_attr_dataConfig(i,e);t+=UtilProxy.GetAttrFight(n)}return t+this.getTsFight()},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27903,this.S2CRepInjectsoulSoulforgeAction,this),MsgHandle.ins().regNetMsg(27904,this.S2CRepInjectsoulSoulforgeSwallow,this)},e}(BaseSystem);__reflect(ZhuhunProxy.prototype,"ZhuhunProxy");var ZhulingProxy=function(t){function e(){var e=t.call(this)||this;return e.total_level=0,e.swallow_list=[],e.part_list=[],e.IsShowRed=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.C2SReqInjectsoulGetInfo=function(){var t=new net_protocol.C2SReqInjectsoulGetInfo;this.sendPbPack(Msg.C2SReqInjectsoulGetInfo,t,net_protocol.C2SReqInjectsoulGetInfo)},e.prototype.C2SReqInjectsoulAction=function(t,e,i){var n=new net_protocol.C2SReqInjectsoulAction;n.part=t,n.opt_type=e,n.item_id=i,this.sendPbPack(Msg.C2SReqInjectsoulAction,n,net_protocol.C2SReqInjectsoulAction)},e.prototype.C2SReqInjectsoulSwallow=function(t,e){var i=new net_protocol.C2SReqInjectsoulSwallow;i.opt_type=t,i.item_id=e,this.sendPbPack(Msg.C2SReqInjectsoulSwallow,i,net_protocol.C2SReqInjectsoulSwallow)},e.prototype.S2CRepInjectsoulGetInfo=function(t){for(var e=net_protocol.S2CRepInjectsoulGetInfo.decode(t.bytes),i=0;i<e.part_list.length;i++)if(void 0!=e.part_list[i].part){var n=[];n[0]=e.part_list[i].level,n[1]=e.part_list[i].exp,this.part_list[e.part_list[i].part]=n}for(var i=0;i<e.swallow_list.length;i++)void 0!=e.swallow_list[i].type&&(this.swallow_list[e.swallow_list[i].type]=e.swallow_list[i].count);this.total_level=e.total_level;for(var i=0;i<e.soulforge_part_list.length;i++)if(void 0!=e.soulforge_part_list[i].part){var n=[];n[0]=e.soulforge_part_list[i].level,n[1]=e.soulforge_part_list[i].exp,ZhuhunProxy.ins().part_list[e.soulforge_part_list[i].part]=n}for(var i=0;i<e.soulforge_swallow_list.length;i++)void 0!=e.soulforge_swallow_list[i].type&&(ZhuhunProxy.ins().swallow_list[e.soulforge_swallow_list[i].type]=e.soulforge_swallow_list[i].count);EventProxy.Broast(EventType.S2CRepInjectsoulGetInfo,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepInjectsoulAction=function(t){var e=net_protocol.S2CRepInjectsoulAction.decode(t.bytes);if(void 0!=e.info.part){var i=[];i[0]=e.info.level,i[1]=e.info.exp,this.part_list[e.info.part]=i}this.total_level=e.total_level,EventProxy.Broast(EventType.S2CRepInjectsoulAction,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.S2CRepInjectsoulSwallow=function(t){var e=net_protocol.S2CRepInjectsoulSwallow.decode(t.bytes);void 0!=e.info.type&&(this.swallow_list[e.info.type]=e.info.count),EventProxy.Broast(EventType.S2CRepInjectsoulSwallow,{}),EventProxy.Broast(EventType.UpdataForgingRed,{})},e.prototype.getZhulingLevelByPart=function(t){var e=0;return this.part_list[t]&&this.part_list[t][0]&&(e=this.part_list[t][0]),e},e.prototype.getZhulingLevel=function(){for(var t=0,e=1;10>=e;e++)t+=this.getZhulingLevelByPart(e);return t},e.prototype.getZhulingExpByPart=function(t){var e=0;return this.part_list[t]&&this.part_list[t][1]&&(e=this.part_list[t][1]),e},e.prototype.getTSCountByType=function(t){var e=0;return this.swallow_list[t]&&(e=this.swallow_list[t]),e},e.prototype.getZhulingStateByType=function(t){var e=GlobalConfig.getInjectsoul_swallowConfig(t),i=(this.getTSCountByType(t),0),n=0,o=this.getZhulingLevel();for(var s in e)o>=e[s].total_level&&(i=1),n=0==n?e[s].total_level:Math.min(e[s].total_level,n);return[i,n]},e.prototype.getCurMaxTSCountByType=function(t){var e=0,i=GlobalConfig.getInjectsoul_swallowConfig(t),n=this.getZhulingLevel();for(var o in i)n>=i[o].total_level&&(e=Math.max(i[o].count,e));return e},e.prototype.getNextMaxTSLevelByType=function(t){var e=0,i=GlobalConfig.getInjectsoul_swallowConfig(t),n=this.getZhulingLevel();for(var o in i)n<i[o].total_level&&(e=0==e?i[o].total_level:Math.min(i[o].total_level,e));return e},e.prototype.getCanZhulingUpLevelByPart=function(t){var i=e.ins().getZhulingLevelByPart(t),n=GlobalConfig.getInjectsoul_part_dataConfig(i);if(void 0==n||0==n.exp)return!1;for(var o=GlobalConfig.getInjectsoul_itemsConfig(1).items,s=e.ins().getZhulingExpByPart(t),r=n.exp-s,a=0;a<o.length;a++){var h=BagProxy.ins().getItemData(o[a]);if(r-=BagProxy.ins().getItemCountById(o[a])*h.flags,0>=r)return!0}return!1},e.prototype.getRed=function(){if(!SystemOpenProxy.ins().isOpen(2,1003,!0))return!1;if(this.IsShowRed)return!0;for(var t=1;10>=t;t++)if(this.getCanZhulingUpLevelByPart(t))return!0;for(var t=1;3>=t;t++)if(this.getCurTSstate(t))return!0;return!1},e.prototype.getCurTSstate=function(t){var i=e.ins().getZhulingStateByType(t);if(1==i[0]){var n=GlobalConfig.getInjectsoul_swallow_itemsConfig(t);if(void 0==n)return!1;var o=e.ins().getTSCountByType(t),s=e.ins().getCurMaxTSCountByType(t);if(s>o&&BagProxy.ins().getItemCountById(n.item_id)>0)return!0}return!1},e.prototype.getTsFight=function(){for(var t=0,e=1;3>=e;e++){var i=GlobalConfig.getInjectsoul_swallow_itemsConfig(e);t+=UtilProxy.GetAttrFight(i)*this.getTSCountByType(e)}return t},e.prototype.getAllFightValue=function(){for(var t=0,i=1;10>=i;i++){var n=e.ins().getZhulingLevelByPart(i),o=GlobalConfig.getInjectsoul_attr_dataConfig(n,i);t+=UtilProxy.GetAttrFight(o)}return t+this.getTsFight()},e.prototype.regLoginHandler=function(){MsgHandle.ins().regNetMsg(27900,this.S2CRepInjectsoulGetInfo,this),MsgHandle.ins().regNetMsg(27901,this.S2CRepInjectsoulAction,this),MsgHandle.ins().regNetMsg(27902,this.S2CRepInjectsoulSwallow,this)},e}(BaseSystem);__reflect(ZhulingProxy.prototype,"ZhulingProxy");var ZPZBProxy=function(t){function e(){var e=t.call(this)||this;return e.state=0,e.nexttime=0,e.defend_faction_id=0,e.daily_award=0,e.join_rank_list=[],e.my_jion_rank=0,e.my_jion_score=0,e.incoldtime=0,e.topkill_role_id=0,e.topkill_server_id=0,e.topkill_reputation=0,e.topkill_score=0,e.topkill_kill_num=0,e.topkill_name="",e.topfaction=0,e.end_time=0,e.attack_list=[],e.kill_num=0,e.my_score=0,e.my_rank=0,e.die_count=0,e.item_list=[],e.rank_list=[],e.ObjList=[],e.win_faction_id=0,e.result=0,e.endstate=0,e.attacktype=0,e.IsNeedGoback=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.setAttackType=function(t){this.attacktype=t,EventProxy.Broast(EventType.UpdateAttackType,[])},e.prototype.getAttackType=function(){return this.attacktype},e.prototype.setGoBack=function(t){this.IsNeedGoback=t},e.prototype.getGoBack=function(){return this.IsNeedGoback},e.prototype.C2SReqFactionGetFactionattackInfo=function(){var t=new net_protocol.C2SReqFactionGetFactionattackInfo;this.sendPbPack(Msg.C2SReqFactionGetFactionattackInfo,t,net_protocol.C2SReqFactionGetFactionattackInfo)},e.prototype.C2SReqFactionGetAttackJoinAward=function(){var t=new net_protocol.C2SReqFactionGetAttackJoinAward;this.sendPbPack(Msg.C2SReqFactionGetAttackJoinAward,t,net_protocol.C2SReqFactionGetAttackJoinAward)},e.prototype.C2SReqFactionEnterFactionAttack=function(){var t=new net_protocol.C2SReqFactionEnterFactionAttack;
this.sendPbPack(Msg.C2SReqFactionEnterFactionAttack,t,net_protocol.C2SReqFactionEnterFactionAttack)},e.prototype.C2SReqFactionGetFactionAttackBattleInfo=function(){var t=new net_protocol.C2SReqFactionGetFactionAttackBattleInfo;this.sendPbPack(Msg.C2SReqFactionGetFactionAttackBattleInfo,t,net_protocol.C2SReqFactionGetFactionAttackBattleInfo)},e.prototype.S2CRepFactionGetFactionattackInfo=function(t){var e=net_protocol.S2CRepFactionGetFactionattackInfo.decode(t.bytes);this.state=e.state,this.nexttime=e.time,this.defend_faction_id=e.defend_faction_id,this.role_info=e.role_info,this.last_data=e.last_data,this.daily_award=e.daily_award,this.join_rank_list=[];for(var i in e.join_rank_list)this.join_rank_list.push(e.join_rank_list[i]),e.join_rank_list[i].role_id==RoleProxy.ins().getRoleId()&&(this.my_jion_rank=e.join_rank_list[i].rank);this.join_rank_list.sort(this.sortrank),this.my_jion_score=e.score,EventProxy.Broast(EventType.S2CRepFactionGetFactionattackInfo,{})},e.prototype.sortrank=function(t,e){return t.rank<e.rank?-1:t.rank>e.rank?1:0},e.prototype.S2CRepFactionGetAttackDailyAward=function(t){var e=net_protocol.S2CRepFactionGetAttackDailyAward.decode(t.bytes);this.daily_award=e.daily_award,EventProxy.Broast(EventType.S2CRepFactionGetAttackDailyAward,{})},e.prototype.S2CRepFactionEnterFactionAttack=function(t){var e=net_protocol.S2CRepFactionEnterFactionAttack.decode(t.bytes);this.incoldtime=e.time,2==e.code?TipsControl.ins().showTips("未到活动时间"):1==e.code&&TipsControl.ins().showTips(UtilProxy.getStr("还需@0 秒才能再次进入",[this.incoldtime])),EventProxy.Broast(EventType.S2CRepFactionEnterFactionAttack,{})},e.prototype.S2CRepFactionUpdateFirstRoleInfo=function(t){var e=net_protocol.S2CRepFactionUpdateFirstRoleInfo.decode(t.bytes);this.topkill_role_id=e.role_id,this.topkill_server_id=e.server_id,this.topkill_reputation=e.reputation,this.topkill_score=e.score,this.topkill_kill_num=e.kill_num,this.topkill_name=e.name,this.end_time=e.end_time,this.topfaction=e.faction,EventProxy.Broast(EventType.S2CRepFactionUpdateFirstRoleInfo,{})},e.prototype.S2CRepFactionUpdateBattleInfo=function(t){var e=net_protocol.S2CRepFactionUpdateBattleInfo.decode(t.bytes);this.defend=e.defend,this.attack_list=e.attack_list,this.kill_num=e.kill_num,this.my_score=e.my_score,this.item_list=e.item_list,this.rank_list=[];for(var i in e.rank_list)this.rank_list.push(e.rank_list[i]),e.rank_list[i].role_id==RoleProxy.ins().getRoleId()&&(this.my_rank=e.rank_list[i].rank);this.rank_list.sort(this.sortrank),EventProxy.Broast(EventType.S2CRepFactionUpdateBattleInfo,{})},e.prototype.S2CRepFactionUpdateScoreAward=function(t){var e=net_protocol.S2CRepFactionUpdateScoreAward.decode(t.bytes);this.my_score=e.score,this.die_count=e.die_count,EventProxy.Broast(EventType.S2CRepFactionUpdateScoreAward,{})},e.prototype.S2CRepFactionUpdateObjInfo=function(t){var e=net_protocol.S2CRepFactionUpdateObjInfo.decode(t.bytes);this.ObjList=e.list,EventProxy.Broast(EventType.S2CRepFactionUpdateObjInfo,{})},e.prototype.S2CRepFactionUpdateBattleResult=function(t){var e=net_protocol.S2CRepFactionUpdateBattleResult.decode(t.bytes);this.win_faction_id=e.win_faction_id,this.result=e.result,this.endstate=e.state,this.role_info=e.role_info,this.defend=e.defend,this.attack_list=e.attack_list,ViewManager.ins().open(ZPZBEndView),EventProxy.Broast(EventType.S2CRepFactionUpdateBattleResult,{})},e.prototype.S2CRepFactionMultiKillNotice=function(t){for(var e=net_protocol.S2CRepFactionMultiKillNotice.decode(t.bytes),i=GlobalConfig.getFaction_attack_base_dataConfig(1),n=0;n<i.kill_notice.length;n++)if(i.kill_notice[n][0]==e.count&&i.kill_notice[n][2])return void ViewManager.ins().open(ZPZBKillTips,n);EventProxy.Broast(EventType.S2CRepFactionMultiKillNotice,[])},e.prototype.S2CRepFactionAddScoreNotice=function(t){var e=net_protocol.S2CRepFactionAddScoreNotice.decode(t.bytes);TipsControl.ins().showTips("获得"+e.add_score+"积分"),this.my_score=e.score,EventProxy.Broast(EventType.S2CRepFactionAddScoreNotice,[])},e.prototype.IsInZPZBTime=function(){return 1==this.state?this.nexttime>GameLogic.ins().getServerTime():!1},e.prototype.GetAwardRankInfoByRank=function(t,e){var i=[];1==t?i=this.join_rank_list:2==t&&(i=this.rank_list);for(var n in i)if(i[n]&&i[n].rank==e)return i[n]},e.prototype.GetObjInfoList=function(t){var e=[];for(var i in this.ObjList)this.ObjList[i].obj_type==t&&e.push(this.ObjList[i]);return e.sort(this.sortobj),e},e.prototype.sortobj=function(t,e){return t.obj_id<e.obj_id?-1:t.obj_id>e.obj_id?1:0},e.prototype.IsZPZB=function(t){var e=GlobalConfig.getFaction_attack_base_dataConfig(1);return e&&e.scene_type_id==t?!0:!1},e.prototype.getReliveTime=function(){var t=GlobalConfig.getFaction_attack_relive_dataList(),e=0;for(var i in t)e=Math.max(t[i].id,e);if(0==this.die_count)return GlobalConfig.getFaction_attack_relive_dataConfig(1).wait_time;var n=GlobalConfig.getFaction_attack_relive_dataConfig(this.die_count);return n?n.wait_time:GlobalConfig.getFaction_attack_relive_dataConfig(e).wait_time},e.prototype.IsBossId=function(t){var e=GlobalConfig.getFaction_attack_monster_dataList();for(var i in e)if(e[i].monster_id==t&&3!=e[i].monster_type)return!0;return!1},e.prototype.getAttackRoleList=function(){var t=GameLogic.ins().getEnitityRoleList(),e=[];for(var i in t)t[i].handle!=GameMap.centerEntity.handle&&(FacProxy.ins().getFacId()==this.defend_faction_id?t[i].faction!=this.defend_faction_id&&e.push(t[i]):t[i].faction==this.defend_faction_id&&e.push(t[i]));return e},e.prototype.getCurAttackBossId=function(){if(FacProxy.ins().getFacId()==this.defend_faction_id)return 0;var t=GlobalConfig.getFaction_attack_monster_dataList();for(var e in t){var i=GameLogic.ins().getEnitityByBossId(t[e].monster_id);if(1==t[e].monster_type&&i)return t[e].monster_id}return 0},e.prototype.IsCanAttackHandle=function(t){var e=this.getAttackRoleList();for(var i in e)if(e[i].handle==t)return!0;var n=this.getCurAttackBossId();if(0!=n&&GameLogic.ins().getEnitityByBossId(n).handle==t)return!0;if(FacProxy.ins().getFacId()==this.defend_faction_id){if(this.GetObjInfoList(1)[0].obj_id==t)return!0}else for(var i in this.ObjList)if(1!=this.ObjList[i].obj_type&&this.ObjList[i].obj_id==t)return!0;return!1},e.prototype.GetCurNeedAttackTarget=function(t){var e=void 0;if(FacProxy.ins().getFacId()==this.defend_faction_id){var i=this.GetObjInfoList(1)[0];i&&i.cur_hp>0&&(e=GameLogic.ins().getEntityByHandle(i.obj_id))}else{var n=GlobalConfig.getFaction_attack_path_dataList();for(var o in n){var s=GameLogic.ins().getEnitityByBossId(n[o].monster_id);if(s&&s.getHP()>0)return s}}return e},e.prototype.getNeedToPointXY=function(t){var e=0,i=0;if(FacProxy.ins().getFacId()==this.defend_faction_id){var n=GlobalConfig.getFaction_defend_path_dataConfig(t);n&&(e=n.pos_x,i=n.pos_y)}else{var n=GlobalConfig.getFaction_attack_path_dataConfig(t);n&&(e=n.pos_x,i=n.pos_y)}return{pos_x:e,pos_y:i}},e.prototype.getBaseCampXY=function(){var t=0,e=0,i=GlobalConfig.getFaction_attack_monster_dataList();for(var n in i)if(FacProxy.ins().getFacId()==this.defend_faction_id){if(2==i[n].camp&&3==i[n].monster_type)return t=i[n].pos_x,e=i[n].pos_y,{pos_x:t,pos_y:e}}else if(1==i[n].camp&&3==i[n].monster_type)return t=i[n].pos_x,e=i[n].pos_y,{pos_x:t,pos_y:e};return{pos_x:t,pos_y:e}},e.prototype.getTitleRes=function(t){return 0==t?"":t==this.defend_faction_id?"zongpaizhengba_font_shoufang":"zongpaizhengba_font_gongfang"},e.prototype.regHandler=function(){MsgHandle.ins().regNetMsg(25620,this.S2CRepFactionGetFactionattackInfo,this),MsgHandle.ins().regNetMsg(25621,this.S2CRepFactionGetAttackDailyAward,this),MsgHandle.ins().regNetMsg(25622,this.S2CRepFactionEnterFactionAttack,this),MsgHandle.ins().regNetMsg(25623,this.S2CRepFactionUpdateFirstRoleInfo,this),MsgHandle.ins().regNetMsg(25624,this.S2CRepFactionUpdateBattleInfo,this),MsgHandle.ins().regNetMsg(25625,this.S2CRepFactionUpdateScoreAward,this),MsgHandle.ins().regNetMsg(25626,this.S2CRepFactionUpdateObjInfo,this),MsgHandle.ins().regNetMsg(25627,this.S2CRepFactionUpdateBattleResult,this),MsgHandle.ins().regNetMsg(25628,this.S2CRepFactionMultiKillNotice,this),MsgHandle.ins().regNetMsg(25629,this.S2CRepFactionAddScoreNotice,this)},e}(BaseSystem);__reflect(ZPZBProxy.prototype,"ZPZBProxy");var CreateCharView=function(t){function e(){var e=t.call(this)||this;return e._selectJob=0,e.flower=new eui.Group,e.boy_count=0,e.girl_count=0,e.char_count=0,e.name_count=0,e.souquan_success=!1,e.souquan_tap=!1,e.isCanCountiue=!1,e.initNameConfig(),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="CreateRoleSkin",this.jobImage=[this.j1,this.j2],this.userLab.textFlow=UtilProxy.generateTextFlow("C:10&U&T:同意用户注册服务协议")},e.prototype.drawBtn=function(){var t=window.devicePixelRatio,e=window.canvas.width/t,i=window.canvas.height/t;if(i/e>800/480){var n=e/480*this.createBtn.width,o=e/480*this.createBtn.height,s=e/2-n/2,r=e/480*this.createBtn.y+(i-e/480*800)/2;SdkManager.ins().sdk.authUserInfo(s,r,n,o)}else{var n=i/800*this.createBtn.width,o=i/800*this.createBtn.height,s=e/2-n/2,r=i/800*this.createBtn.y;SdkManager.ins().sdk.authUserInfo(s,r,n,o)}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DeviceUtils.IsWx;var i=StageUtils.ins().getWidth(),n=StageUtils.ins().getHeight();this.bg2.width=i,this.lb1.y=n-80,this.lb2.y=n-60,i/n>.6?(this.bg.height=i/480*800,this.bg.width=i):(this.bg.height=n,this.bg.width=n/800*480),i>=n&&(this.bg.height=n,this.bg.width=n/800*480),this._selectJob=1,EventProxy.AddListener(this,EventType.ShouQuanResult,this.onShouQuan);for(var o=0;o<this.jobImage.length;o++)this.addTouchEvent(this.jobImage[o],this.onClick);this.addTouchEvent(this.createBtn,this.onClick),this.addTouchEvent(this.diceBtn,this.onClick);decodeURI(LocationProperty.nickName);this.addChild(this.flower),this.flower.x=480,this.flower.y=800,this._selectJob=1,0==this._selectJob?(this.j1.icon="denglu_btn_on",this.j2.icon="chuangjue_btn_off",this.girl.source="chuangjue_font_nv_off",this.man.source="chuangjue_font_nan_on"):1==this._selectJob&&(this.j1.icon="chuangjue_btn_off",this.j2.icon="denglu_btn_on",this.girl.source="chuangjue_font_nv_on",this.man.source="chuangjue_font_nan_off"),this.nameInput.text=this.GetName(this._selectJob+1),this.PlayRole(this._selectJob+1),this.checkagree.selected=!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventProxy.RemoveListener(this,EventType.ShouQuanResult,this.onShouQuan);for(var i=0;i<this.jobImage.length;i++)this.removeTouchEvent(this.jobImage[i],this.onClick);this.removeTouchEvent(this.createBtn,this.onClick),this.removeTouchEvent(this.diceBtn,this.onClick),this.closeTween()},e.prototype.onShouQuan=function(t){CommonUtils.log("来之授权的广播:"+t)},e.prototype.flowerTween=function(){for(var t=this,e=MathUtils.limit(10,15)>>0,i=0;e>i;i++)setTimeout(function(){t.randomFlower()},4e3*Math.random()+500);setTimeout(function(){t.flowerTween()},4500)},e.prototype.PlayRole=function(t){var e="";e=1==t?"resource/image/chuangjue/chuangjue_body101_s1":"resource/image/chuangjue/chuangjue_body201_s1",this.sp_role.visible=!1,void 0!=this.mc1&&this.root.removeChild(this.mc1),this.mc1=new egret.MovieClip,UtilProxy.GetMovieClip(e,this.mc1,-1,void 0),this.root.addChildAt(this.mc1,1),this.mc1.x=240,this.mc1.y=420},e.prototype.randomFlower=function(){var t=new eui.Image;t.blendMode=egret.BlendMode.ADD,t.x=-300*Math.random(),t.rotation=180*Math.random(),t.touchEnabled=!1,this.flower.addChild(t);var e=MathUtils.limit(.3,1);t.scaleX=t.scaleY=e,t.x=this.width,t.y=MathUtils.limit(-600,150)+50;var i=egret.Tween.get(t);MathUtils.limit(0,30);i.to({x:-520,y:-450*Math.random()-400,alpha:MathUtils.limit(.5,1)},7e3).call(function(){t.parent.removeChild(t),egret.Tween.removeTweens(t)})},e.prototype.closeTween=function(){for(var t=this.flower.numChildren,e=0;t>e;e++)egret.Tween.removeTweens(this.flower.getChildAt(e))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.createBtn:this.onCreateClick();break;case this.diceBtn:var e=this.GetName(this._selectJob+1);this.nameInput.text=e;break;default:var i=this.jobImage.indexOf(t.currentTarget);if(i>=0){if(this._selectJob!=i){this._selectJob=i,0==i?(this.j1.icon="denglu_btn_on",this.j2.icon="chuangjue_btn_off",this.girl.source="chuangjue_font_nv_off",this.man.source="chuangjue_font_nan_on"):1==i&&(this.j1.icon="chuangjue_btn_off",this.j2.icon="denglu_btn_on",this.girl.source="chuangjue_font_nv_on",this.man.source="chuangjue_font_nan_off");var n=this.GetName(this._selectJob+1);this.nameInput.text=n}this.PlayRole(i+1)}}},e.prototype.onCreateClick=function(){if(""!=this.nameInput.text){if(this.nameInput.text.length>6)return void TipsControl.ins().showTips("使用字符过长！");var t=this.nameInput.text;if(UtilProxy.isEmojiCharacter(t))return void TipsControl.ins().showTips("字符不合法");if(!UtilProxy.CheckStrIsOk(t))return void TipsControl.ins().showTips("字符不合法");var e=this._selectJob,i=this.checkagree.selected;if(i){var n=function(i){i?LoginControl.ins().sendCreaterole(t,1,e+1,0,0,""):TipsControl.ins().showTips("包涵非法字符！"),this.isCanCountiue=!0};this.isCanCountiue=!1,UtilProxy.CheckScreenchar(t,n)}else TipsControl.ins().showTips("请勾选同意！")}else TipsControl.ins().showTips("请输入名字！")},e.prototype.initNameConfig=function(){GlobalConfig.getConfig("datatpl_name","CreateNameConfig"),this._createNameConfig=GlobalConfig.ins().CreateNameConfig;for(var t in this._createNameConfig){var e=this._createNameConfig[t];""!=e.boy_name&&" "!=e.char_name&&(this.boy_count=e.id),""!=e.girl_name&&" "!=e.char_name&&(this.girl_count=e.id),""!=e.char_name&&" "!=e.char_name&&(this.char_count=e.id),this.name_count=e.id}},e.prototype.GetName=function(t){var e=this._createNameConfig[Math.max(1,Math.floor(Math.random()*this.name_count))].first_name,i="";i=1==t?this._createNameConfig[Math.max(1,Math.floor(Math.random()*this.boy_count))].boy_name:this._createNameConfig[Math.max(1,Math.floor(Math.random()*this.girl_count))].girl_name;var n="";return e+n+i},Object.defineProperty(e.prototype,"selectJob",{set:function(t){this._selectJob=t;var e=Math.floor(t/2),i=20,n=i+t,o=(10>n?"0"+n:n.toString(),17);(o+e).toString()},enumerable:!0,configurable:!0}),e.prototype.setName=function(t){},e}(BaseEuiView);__reflect(CreateCharView.prototype,"CreateCharView"),ViewManager.ins().reg(CreateCharView,LayerManager.UI_Main);var CreateRoleScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Tips),ViewManager.ins().open(CreateCharView)},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(CreateRoleScene.prototype,"CreateRoleScene");var NoticeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){this.skinName="NoticeSkin"},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this),this.addTouchEvent(this.btn_close,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.addTouchEvent(this.bg,this.onClick),this.updateInfo(),EventProxy.AddListener(this,EventType.NoticeUpdate,this.updateInfo)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeTouchEvent(this.btn_close,this.onClick),this.removeTouchEvent(this.btn1,this.onClick),this.removeTouchEvent(this.bg,this.onClick),EventProxy.RemoveListener(this,EventType.NoticeUpdate,this.updateInfo)},e.prototype.onClick=function(){ViewManager.ins().close(e)},e.prototype.updateInfo=function(){this.txt_title.textFlow=UtilProxy.StrFormart("C:2&游戏公告",[]);var t=SdkManager.ins().notice;void 0!=t&&200==t.code&&void 0!=t.message?this.txt_info.textFlow=UtilProxy.StrFormart(t.message,[]):this.txt_info.textFlow=UtilProxy.StrFormart("C:2&暂未获取公告",[]),this.gp_remark.height=this.txt_info.height+10},e}(BaseEuiView);__reflect(NoticeView.prototype,"NoticeView"),ViewManager.ins().reg(NoticeView,LayerManager.UI_Main2);var SelectServerView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SelectServerSkin"},e}(BaseEuiView);__reflect(SelectServerView.prototype,"SelectServerView"),ViewManager.ins().reg(SelectServerView,LayerManager.UI_Main);var StartGameScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){RoleCC.ins();t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Main2),this.addLayer(LayerManager.UI_Popup),this.addLayer(LayerManager.UI_Tips),ViewManager.ins().open(StartGameView),SoundManager.ins().playBg("scene07_mp3"),UtilProxy.isCurrentHide=(DeviceUtils.IsQQ||SdkManager.ins().IsInCheck)},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(StartGameScene.prototype,"StartGameScene");var StartGameView=function(t){function e(){var e=t.call(this)||this;return e.frameTick=new FrameTick,e.isInitServerData=!1,e.current_group=-1,e.icon_list=["denglu_icon_cahng","denglu_icon_huo","denglu_icon_xin","denglu_icon_wei","denglu_icon_dai"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="StartGameSkin",this.start.setCD(5e3)},e.prototype.InitServerData=function(){var t=0;this.isInitServerData||(this.groupItemList=new Array,this.ItemList=new Array);var e=LoginProxy.ins().getLocalStorage("user_name");null!=e&&""!=e&&(this.account.text=e);var i=LoginProxy.ins().getLocalStorage("last_server"),n=!1;if(null!=i&&""!=i){var o=Number(i),s=LoginProxy.ins().GetServerConfig(o);s&&(this.curServer.text=s.name,this.cur_ser_data=s,n=!0)}if(!n&&SdkManager.ins().getServerList().length>0){var r=LoginProxy.ins().getServerList(),a=r[0];a&&(this.curServer.text=a.name,this.cur_ser_data=a)}LocationProperty.srvdata=this.cur_ser_data,this.cur_ser_data&&(LocationProperty.serverIP=this.cur_ser_data.ip,LocationProperty.serverPort=this.cur_ser_data.port,LoginProxy.cur_server_data=this.cur_ser_data,0==this.cur_ser_data.is_read_server_id?LocationProperty.srvid=1:LocationProperty.srvid=this.cur_ser_data.server_id);var h=LoginProxy.ins().GetServerList(),l=!1;if(h.length>0)for(var p=0;p<h.length;++p){var c=h[p].server_id,u=LoginProxy.ins().GetServerConfig(c);null!=u&&(l=!0)}if(l){if(null!=this.groupItemList&&this.groupItemList.length>0)this.groupItemList[0].label="历史服务器";else{var d=new eui.Button;d.skinName="Btn3Skin",d.label="历史服务器",this.groupItemList[0]=d,this.gParent.addChild(d),this.addTouchEvent(d,this.onGroupClick)}t++}var g=LoginProxy.ins().getServerList(),y=Math.ceil(g.length/10);if(y>0)for(var p=y-1;p>=0;--p){if(this.groupItemList[t])this.groupItemList[t].label=10*p+1+"-"+10*(p+1)+"区";else{var d=new eui.Button;d.skinName="Btn3Skin",d.label=10*p+1+"-"+10*(p+1)+"区",this.groupItemList[t]=d,this.gParent.addChild(d),this.addTouchEvent(d,this.onGroupClick)}t++}if(this.groupItemList.length>0){for(var p=0;p<this.groupItemList.length;++p)t>p?(this.groupItemList[p].visible=!0,this.groupItemList[p].icon="denglu_btn_01"):this.groupItemList[p].visible=!1;this.groupItemList[0].icon="denglu_btn_02",this.SetGroupDataByIndex(0)}this.isInitServerData=!0},e.prototype.onGroupClick=function(t){var e=this.groupItemList.indexOf(t.currentTarget);if(this.current_group!=e){this.current_group=e;for(var i=0;i<this.groupItemList.length;++i)t.currentTarget==this.groupItemList[i]?this.groupItemList[i].icon="denglu_btn_02":this.groupItemList[i].icon="denglu_btn_01";this.SetGroupDataByIndex(e)}},e.prototype.SetGroupDataByIndex=function(t){var e=0;if(this.group_data_list=new Array,this.current_group=t,t>=0){var i=LoginProxy.ins().GetServerList();if(0==t&&LoginProxy.ins().isHaveMyServer())for(var n=0;n<i.length;++n){var o=i[n].server_id,s=LoginProxy.ins().GetServerConfig(o);if(null!=s){if(this.group_data_list[e]=s.server_id,this.ItemList[e]){this.ItemList[e].label=s.name,this.ItemList[e].icon=this.icon_list[(s.state||1)-1];var r=this.ItemList[e].getChildAt(1);r&&(r.visible=LoginProxy.ins().isHistoryServer(s.server_id))}else{var a=new eui.Button;a.skinName="Btn31Skin",a.label=s.name,a.icon=this.icon_list[(s.state||1)-1];var r=a.getChildAt(1);r&&(r.visible=LoginProxy.ins().isHistoryServer(s.server_id)),this.ItemList[e]=a,this.iParent.addChild(a),this.addTouchEvent(a,this.OnItemClick)}e++}}else{var h=LoginProxy.ins().isHaveMyServer()?t:t+1,l=LoginProxy.ins().getServerList(),p=Math.ceil(l.length/10),c=[];if(l.length>0)for(var t=0,n=l.length-1;n>=0;--n)t/10>=p-h&&p-h+1>t/10&&c.push(l[n]),t++;else if(!SdkManager.isUseSdk){var u=GlobalConfig.getArrayConfigByIndex(h,GlobalConfig.ins().ServergroupConfig),d=u.includesev;c=d.split(",")}for(var n=0;n<c.length;++n){var g;if(l.length>0?(c.sort(LoginProxy.ins().sortById),g=c[n]):g=this.GetServerConfigById(Number(c[n])),null!=g){if(this.group_data_list[e]=g.server_id,this.ItemList[e]){this.ItemList[e].label=g.name,this.ItemList[e].icon=this.icon_list[(g.state||1)-1];var r=this.ItemList[e].getChildAt(1);r&&(r.visible=LoginProxy.ins().isHistoryServer(g.server_id))}else{var a=new eui.Button;a.skinName="Btn31Skin",a.label=g.name,a.icon=this.icon_list[(g.state||1)-1];var r=a.getChildAt(1);r&&(r.visible=LoginProxy.ins().isHistoryServer(g.server_id)),this.ItemList[e]=a,this.iParent.addChild(a),this.addTouchEvent(a,this.OnItemClick)}e++}}}}for(var n=0;n<this.ItemList.length;n++)null!=this.ItemList[n]&&(this.ItemList[n].visible=e>n)},e.prototype.OnItemClick=function(t){this.severPanel.visible=!1;var e=this.ItemList.indexOf(t.currentTarget),i=this.group_data_list[e],n=LoginProxy.ins().GetServerConfig(i);if(n&&n.state&&(4==n.state||5==n.state)){if(4==n.state)return void TipsControl.ins().showTips("服务器维护中");if(5==n.state&&n.CD>0){var o=Number(n.CD)-Math.floor((egret.getTimer()-SdkManager.ins().getServerTime)/1e3);if(o>0){var s=Number(SdkManager.ins().server_list.body.server_time)+Number(n.CD),r=new Date;return r.setTime(1e3*s),void TipsControl.ins().showTips("服务器开启时间："+r.toLocaleString())}SdkManager.ins().SetServrtState(n.server_id,3)}}this.cur_ser_data=LoginProxy.ins().GetServerConfig(i),this.curServer.text=this.cur_ser_data.name,LocationProperty.srvdata=this.cur_ser_data,null!=this.cur_ser_data&&(LocationProperty.serverIP=this.cur_ser_data.ip,LocationProperty.serverPort=this.cur_ser_data.port,LoginProxy.cur_server_data=this.cur_ser_data,0==this.cur_ser_data.is_read_server_id?LocationProperty.srvid=1:LocationProperty.srvid=this.cur_ser_data.server_id)},e.prototype.GetServerConfigById=function(t){var e=SdkManager.ins().getServerList();return e.sort(LoginProxy.ins().sortById),e.length>0?e[t]:GlobalConfig.ins().ServerConfig[t]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];(SdkManager.ins().sdktype==SdkType.QQ||SdkManager.ins().sdktype==SdkType.HUOSDK)&&platform.QQcheckNewUpdate();var n=StageUtils.ins().getWidth(),o=StageUtils.ins().getHeight();if(this.bg2.width=n,this.bg2.horizontalCenter=0,this.ver.y=o-26,this.lb1.y=o-80,this.lb2.y=o-60,SdkManager.ins().sdktype==SdkType.WJSDK){SdkManager.ins().channel_id}n/o>.6?(this.bg.height=n/540*900,this.bg.width=n):(this.bg.height=o,this.bg.width=o/900*540),n>=o&&(this.bg.height=o,this.bg.width=o/900*540,this.bg2.width=o/900*540),this.tipslab.visible=!1,(SdkManager.ins().sdktype==SdkType.WJSDK||DeviceUtils.IsWx||DeviceUtils.IsQQ)&&DeviceUtils.IsMobile&&(this.tipslab.visible=!0,this.bg.height=o,this.bg.width=n),SdkManager.ins().sdktype!=SdkType.Quick&&SdkManager.ins().sdktype!=SdkType.CSJSDK||!DeviceUtils.IsMobile||(this.bg.height=o,this.bg.width=n),SdkManager.ins().initSeverList(),ViewManager.ins().open(NoticeView,[]),t.prototype.open.call(this,e),this.addTouchEvent(this.start,this.onClick),this.addTouchEvent(this.btn_test,this.onTest),EventProxy.AddListener(this,EventType.UpdateServerList,this.InitServerData),EventProxy.AddListener(this,EventType.IsLoginSdk,this.LoginSdk),this.account.visible=!SdkManager.isUseSdk,this.btn_getServer.visible=!SdkManager.isUseSdk,this.InputChannelID.visible=!SdkManager.isUseSdk,GlobalConfig.getConfig("servergroup","ServergroupConfig"),GlobalConfig.getConfig("server","ServerConfig");var s=LoginProxy.ins().getLocalStorage("user_name");null!=s&&""!=s&&(this.account.text=s);var r=LoginProxy.ins().getLocalStorage("last_server"),a=!1;if(null!=r&&""!=r){var h=Number(r),l=LoginProxy.ins().GetServerConfig(h);l&&(this.curServer.text=l.name,this.cur_ser_data=l,a=!0)}if(!a){var p=LoginProxy.ins().getServerList();if(p.length>0){var c=p[0];c&&(this.curServer.text=c.name,this.cur_ser_data=c)}else{var u=LoginProxy.ins().GetServerConfig(1);u&&(this.curServer.text=u.name,this.cur_ser_data=u)}}LocationProperty.srvdata=this.cur_ser_data,null!=this.cur_ser_data&&(LocationProperty.serverIP=this.cur_ser_data.ip,LocationProperty.serverPort=this.cur_ser_data.port,LoginProxy.cur_server_data=this.cur_ser_data,0==this.cur_ser_data.is_read_server_id?LocationProperty.srvid=1:LocationProperty.srvid=this.cur_ser_data.server_id),DeviceUtils.IsWx||DeviceUtils.IsQQ?this.ver.text="v "+SdkManager.ins().wx_ver:this.ver.text="v 1.0",this.addTouchEvent(this.selectServer,this.onClick),this.addTouchEvent(this.closebtn,this.onClick),this.addTouchEvent(this.btn_getServer,this.onClick),SdkManager.isUseSdk&&!SdkManager.ins().has_get_serverlist&&(this.curServer.text="")},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this,e),this.removeTouchEvent(this.start,this.onClick),this.removeTouchEvent(this.selectServer,this.onClick),this.removeTouchEvent(this.closebtn,this.onClick),this.removeTouchEvent(this.btn_test,this.onTest),this.removeTouchEvent(this.btn_getServer,this.onClick),EventProxy.RemoveListener(this,EventType.UpdateServerList,this.InitServerData),EventProxy.RemoveListener(this,EventType.IsLoginSdk,this.LoginSdk),this.removeObserve(),this.effect.removeChildren()},e.prototype.LoginSdk=function(){},e.prototype.onTest=function(){ViewManager.ins().open(NoticeView)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.start:if(LocationProperty.consoleWrite("点击开始按钮"),SdkManager.isUseSdk)return SdkManager.ins().sdk.openid&&""!=SdkManager.ins().sdk.openid?void this.StartConectSrv(SdkManager.ins().sdk.openid):(SdkManager.ins().sdktype==SdkType.Quick&&(TimerManager.ins().remove(SdkManager.ins().sdk.LoginSdk,SdkManager.ins().sdk),SdkManager.ins().sdk.InLogin=!1,TimerManager.ins().doTimerDelay(0,1e3,0,SdkManager.ins().sdk.LoginSdk,SdkManager.ins().sdk)),void(SdkManager.ins().sdktype==SdkType.CSJSDK&&csjRequestLogin()));var e="";if(!(this.account.text.length>0))return void TipsControl.ins().showTips("请输入名字！");e=this.account.text,this.StartConectSrv(e);break;case this.selectServer:this.severPanel.visible||(this.severPanel.visible=!0),0!=this.account.text.length&&LoginProxy.ins().setLocalStorage("user_name",SdkManager.isUseSdk?SdkManager.ins().sdk.openid:this.account.text),this.InitServerData();break;case this.closebtn:this.severPanel.visible=!1;break;case this.btn_getServer:""!=this.InputChannelID.text&&(SdkManager.ins().ChannelID=Number(this.InputChannelID.text),SdkManager.ins().IsGmSer=!0,SdkManager.ins().initSeverList())}},e.prototype.StartConectSrv=function(t){if(this.cur_ser_data){if(LoginProxy.ins().rsid=0,CommonUtils.log("this.cur_ser_data.ip:"+this.cur_ser_data.ip+", this.cur_ser_data.port:"+this.cur_ser_data.port),LocationProperty.serverIP=this.cur_ser_data.ip,LocationProperty.serverPort=this.cur_ser_data.port,LoginProxy.cur_server_data=this.cur_ser_data,0==this.cur_ser_data.is_read_server_id?LocationProperty.srvid=1:LocationProperty.srvid=this.cur_ser_data.server_id,LocationProperty.srvdata=this.cur_ser_data,this.cur_ser_data.rsid&&this.cur_ser_data.rsid>0){var e=LoginProxy.ins().GetServerConfig(this.cur_ser_data.rsid);LocationProperty.serverIP=e.ip,LocationProperty.serverPort=e.port,LoginProxy.ins().rsid=this.cur_ser_data.rsid}RoleCC.ins().connectServer(t)}else TipsControl.ins().showTips("请选择服务器")},e}(BaseEuiView);__reflect(StartGameView.prototype,"StartGameView"),ViewManager.ins().reg(StartGameView,LayerManager.UI_Main2);var SelectRoleData=function(){function t(){}return t.prototype.parser=function(t){this.id=t.readInt(),this.name=t.readString(),this.roleClass=t.readInt(),this.zsLevel=t.readInt(),this.level=t.readInt(),this.power=t.readDouble(),this.vipLevel=t.readInt(),this.sex=t.readInt()},t}();__reflect(SelectRoleData.prototype,"SelectRoleData");var EquipsData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.strengthen=0,e.epicAttr=[],e}return __extends(e,t),e.prototype.parserEquip=function(e){this.strengthen=e.readInt(),this.addlv=e.readInt(),this.gem=e.readInt(),t.prototype.parser.call(this,e);for(var i=0;i<GlobalConfig.getEpicCount();i++)this.epicAttr[i]=new AttributeData,this.epicAttr[i].type=e.readShort();for(var i=0;i<GlobalConfig.getEpicCount();i++)this.epicAttr[i].value=e.readInt();this.count>0},e.prototype.getEpicAttrValue=function(t){for(var e=0;e<GlobalConfig.getEpicCount();e++)if(this.epicAttr[e].type==t)return this.epicAttr[e].value;return 0},e.prototype.hasEquipOn=function(){return this.itemId>0},e.prototype.clone=function(){var t=new e;return t},e}(ItemData);__reflect(EquipsData.prototype,"EquipsData");var Lang={common:{jobName:["通用","职业1","职业2","职业3","职业4"]},tips:{level:"等级:",job:"职业:"},dinghaiFubenName:{1:"经验副本"},itemComAttrName:["未定义属性","","","","","","恐吓","反恐吓","组队","防御","防御","血量","血量","魔法","魔法","移速","移速","生命","生命","魔法","魔法","物攻","物攻","物防","物防","抗暴","抗暴","攻击","攻击","无视防御","无视防御","法攻","法攻","法防","法防","暴击","暴击","闪避","闪避","命中","命中","伤害追加","伤害追加","血量恢复","血量恢复","魔法恢复","魔法恢复","攻速","攻速","法术免伤","法术免伤","物理免伤","物理免伤","","","雷抗","雷抗","毒攻","毒攻","PK值","毒抗","冰攻","冰攻","冰抗","冰抗","火攻","火攻","魅力","","伤害加深","会心","眩晕","眩晕免疫","灵气","","会心","","","","","","","会心","","","","","","","","","",""],itemComAttrName1:["未定义属性","","","","","","恐    吓","反  恐  吓","组    队","防    御","防    御","血    量","血    量","魔    法","魔    法","移    速","移    速","生    命","生    命","魔    法","魔    法","物    攻","物    攻","物    防","物    防","抗    暴","抗    暴","攻    击","攻    击","无视防御","无视防御","法    攻","法    攻","法    防","法    防","暴    击","暴    击","闪    避","闪    避","命    中","命    中","伤害追加","伤害追加","血量恢复","血量恢复","魔法恢复","魔法恢复","攻    速","攻    速","法术免伤","法术免伤","物理免伤","物理免伤","","","雷    抗","雷    抗","毒    攻","毒    攻","PK    值","毒    抗","冰    攻","冰    攻","冰    抗","冰    抗","火    攻","火    攻","魅    力","","伤害加深","会    心","眩    晕","眩晕免疫","灵    气","","会    心","","","","","","","会    心","","","","","","","","","",""]},MapPoint=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"mapX",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapY",{get:function(){return this.y},set:function(t){this.x=t},enumerable:!0,configurable:!0}),e}(egret.Point);__reflect(MapPoint.prototype,"MapPoint");var CsjSdk=function(){function t(){this.productCode="",this.productKey="",this.uid="",this.username="",this.urlParam={},this.lastPayTime=0}return t.prototype.init=function(t){var e=location.search;if(console.log(" init search = ",e),""==e)return console.log("请求SDK: csjRequestInit"),csjRequestInit(),console.log("请求SDK: csjRequestLogin"),void csjRequestLogin();e=e.slice(1);for(var i=e.split("&"),n=i.length,o=0;n>o;o++){var s=i[o],r=s.split("=");this.urlParam[r[0]]=r[1],"userID"==r[0]&&(SdkManager.ins().sdk.openid=r[1])}if(SdkManager.ins().sdk.openid&&""!=SdkManager.ins().sdk.openid){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT;var h=function(t){switch(t.type){case egret.Event.COMPLETE:var e=t.currentTarget,i=e.response;console.log("request：remark ",i);break;case egret.IOErrorEvent.IO_ERROR:}};a.once(egret.Event.COMPLETE,h,this),a.once(egret.IOErrorEvent.IO_ERROR,h,this);var l="",p=SdkManager.ins().sdk.openid;l="userId="+p;var c=this.urlParam.token;l+="&token="+c;var u="http://139.9.94.47:8090/verify-csj?"+l;
a.open(u,egret.HttpMethod.POST),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(),console.log("请求验证:",u)}else console.log("请求SDK: csjRequestInit"),csjRequestInit(),console.log("请求SDK: csjRequestLogin"),csjRequestLogin()},t.prototype.commitPay=function(t){if(!(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=2)){this.lastPayTime=GameLogic.ins().getServerTime();var e=new Date,i=RoleProxy.ins().getRoleId(),n=RoleProxy.ins().getRoleServerId().toString()+RoleProxy.ins().getRoleId().toString()+GameLogic.ins().getServerTime().toString()+e.getMilliseconds().toString(),o=RoleProxy.ins().getRoleServerId(),s=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[i,t.data.id,1,o,SdkManager.ins().ChannelID,2]),r=new Object;r.productId=t.data.id,r.productName=t.data.name,r.productDesc=t.data.name,r.price=t.data.amount,r.buyNum=1,r.coinNum=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO),r.serverID=o,r.serverName=LocationProperty.srvdata.name,r.roleID=i,r.roleName=RoleProxy.ins().getRoleName(),r.roleLevel=RoleProxy.ins().getRoleLv(),r.vip=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),r.payNotifyUrl="http://139.9.94.47:8090/csj",r.extension=s,r.gameOrderID=n,csjRequestPay(r),console.log("csjRequestPay orderInfo = ",r)}},t.prototype.collectRole=function(t,e){csjRequestSubmitRoleInfo(t),console.log("数据上报",t)},t.prototype.sendEnterGameCom=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],vipLevel:t[5],roleFightValue:t[6],roleProfession:t[7],rolePayTotal:t[8],roleCoin1:t[9],roleCoin2:t[10]};this.sdkTrans.RaStarEnterGameCom(e),console.log("jssdk通用数据上传",e)},t.prototype.sendFinishTask=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],taskId:t[5],taskName:t[6],taskStatus:t[7],taskDetail:t[8],vipLevel:t[9]};this.sdkTrans.RaStarFinishTask(e),console.log("jssdk任务数据上传",e)},t.prototype.sendGetHonor=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],honorId:t[5],honorName:t[6],honorDetail:t[7],vipLevel:t[8]};this.sdkTrans.RaStarGetHonor(e),console.log("jssdk荣誉上传",e)},t.prototype.share=function(t){this.sdkTrans.RaStarShare(t),console.log("jssdk分享")},t.prototype.follow=function(t){this.sdkTrans.RaStarFollow(function(e){t(e)}),console.log("jssdk关注")},t.prototype.collect=function(t){this.sdkTrans.RaStarCollect(function(e){t(e)}),console.log("jssdk关注")},t.prototype.addShortcut=function(t){this.sdkTrans.RaStarAddShortcut(function(e){t(e)}),console.log("jssdk创建桌面快捷方式")},t.prototype.realNameVerify=function(t){this.sdkTrans.RaStarRealNameVerify(function(e){t(e)}),console.log("jssdk实名认证")},t.prototype.chatMonitoring=function(t,e){var i={cmd:t[0],type:t[1],gameid:t[2],serverid:t[3],uid:t[4],nick:t[5],fromch:t[6],touid:t[7],tonick:t[8],toch:t[9],msg:t[10],ip:t[11],sign:t[12]};this.sdkTrans.RaStarChatMonitoring(i,function(t){e(t)}),console.log("jssdk聊天上报")},t.prototype.bindPhone=function(t){this.sdkTrans.RaStarBindPhone(function(e){t(e)}),console.log("jssdk绑定手机")},t}();__reflect(CsjSdk.prototype,"CsjSdk");var H5Sdk=function(){function t(){this.cch_id=0,this.app_id=0,this.app_key="AzYSEUi1KMWd2GH",this.lastPayTime=0}return t.prototype.init=function(t){this.sdkTrans=window.XH_SDK,window.XH_SDK.getLoginData();var e=function(){if(window.XH_SDK&&window.XH_SDK.loginData){TimerManager.ins().remove(e,this);var t=window.XH_SDK.loginData;SdkManager.ins().sdk.loginData=t,SdkManager.ins().sdk.cch_id=t.cch_id,SdkManager.ins().sdk.app_id=t.app_id,SdkManager.ins().sdk.md_id=t.md_id,SdkManager.ins().sdk.access_token=t.access_token,SdkManager.ins().sdk.rand=t.rand,console.log("jssdk初始化成功:",t),SdkManager.ins().reqOpenIdLoop(t.access_token,t.cch_id,t.app_id,t.rand),SdkManager.ins().reqNotice(t.cch_id)}};TimerManager.ins().doTimerDelay(0,300,0,e,this)},t.prototype.getSignKey=function(t,e){var i={};for(var n in t)"sign"!=n&&"sign_type"!=n&&null!=t[n]&&""!=t[n]&&(i[n]=t[n]);for(var o=Object.keys(i).sort(),s="",r=0;r<o.length;r++)s+=o[r]+"="+i[o[r]]+"&";return s=s.replace(/[\'\"\\\/\b\f\n\r\t]/g,""),md5.hex_md5(s+e)},t.prototype.getOrderInfo=function(t,e){var i="";for(var n in t)i+=n+"="+t[n]+"&";return i+="sign="+e},t.prototype.commitPay=function(t){if(!(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=2)&&(this.lastPayTime=GameLogic.ins().getServerTime(),null!=this.sdkTrans&&void 0!=this.sdkTrans)){var e=new Date,i=RoleProxy.ins().getRoleId(),n=RoleProxy.ins().getRoleServerId().toString()+RoleProxy.ins().getRoleId().toString()+GameLogic.ins().getServerTime().toString()+e.getMilliseconds().toString(),o=RoleProxy.ins().getRoleServerId(),s=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[i,t.data.id,1,o,SdkManager.ins().lyid,2]),r={tm:GameLogic.ins().getServerTime(),cch_id:this.cch_id,app_id:this.app_id,md_id:this.md_id,access_token:this.access_token,role_id:i,role_name:RoleProxy.ins().getRoleName(),role_level:RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),server_id:RoleProxy.ins().getRoleServerId(),server_name:LocationProperty.srvdata.name,amt:t.data.amount,app_subject_id:t.data.id,app_subject:t.app_subject,app_order_no:n,app_ext:s},a=this.getSignKey(r,this.app_key);r.sign=a,console.log("jssdk签名:",a);var h={orderInfo:r,amt:t.data.amount,roleName:RoleProxy.ins().getRoleName(),roleLevel:RoleProxy.ins().getRoleLv(),roleId:i,channel:RoleProxy.ins().getRoleServerId(),channelName:LocationProperty.srvdata.name,subject:t.app_subject,orderNo:n,extra:s};console.log("jssdk发起支付:",h),this.sdkTrans.RaStarPay(h)}},t.prototype.collectRole=function(t,e){switch(e){case 1:this.sdkTrans.RaStarUploadEnter(t);break;case 2:this.sdkTrans.RaStarUploadCreate(t);break;case 3:this.sdkTrans.RaStarUploadLevelUp(t);break;case 4:this.sdkTrans.RaStarUploadChangeName(t)}console.log("数据上报",t)},t.prototype.sendEnterGameCom=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],vipLevel:t[5],roleFightValue:t[6],roleProfession:t[7],rolePayTotal:t[8],roleCoin1:t[9],roleCoin2:t[10]};this.sdkTrans.RaStarEnterGameCom(e),console.log("jssdk通用数据上传",e)},t.prototype.sendFinishTask=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],taskId:t[5],taskName:t[6],taskStatus:t[7],taskDetail:t[8],vipLevel:t[9]};this.sdkTrans.RaStarFinishTask(e),console.log("jssdk任务数据上传",e)},t.prototype.sendGetHonor=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],honorId:t[5],honorName:t[6],honorDetail:t[7],vipLevel:t[8]};this.sdkTrans.RaStarGetHonor(e),console.log("jssdk荣誉上传",e)},t.prototype.share=function(t){this.sdkTrans.RaStarShare(t),console.log("jssdk分享")},t.prototype.follow=function(t){this.sdkTrans.RaStarFollow(function(e){t(e)}),console.log("jssdk关注")},t.prototype.collect=function(t){this.sdkTrans.RaStarCollect(function(e){t(e)}),console.log("jssdk关注")},t.prototype.addShortcut=function(t){this.sdkTrans.RaStarAddShortcut(function(e){t(e)}),console.log("jssdk创建桌面快捷方式")},t.prototype.realNameVerify=function(t){this.sdkTrans.RaStarRealNameVerify(function(e){t(e)}),console.log("jssdk实名认证")},t.prototype.chatMonitoring=function(t,e){var i={cmd:t[0],type:t[1],gameid:t[2],serverid:t[3],uid:t[4],nick:t[5],fromch:t[6],touid:t[7],tonick:t[8],toch:t[9],msg:t[10],ip:t[11],sign:t[12]};this.sdkTrans.RaStarChatMonitoring(i,function(t){e(t)}),console.log("jssdk聊天上报")},t.prototype.bindPhone=function(t){this.sdkTrans.RaStarBindPhone(function(e){t(e)}),console.log("jssdk绑定手机")},t}();__reflect(H5Sdk.prototype,"H5Sdk");var HuoSdk=function(){function t(){this.lastPayTime=0}return t.prototype.init=function(t){SdkManager.ins().reqNotice(0);var e=function(){var t=platform.getWxSdkData();t&&""!=t.open_id&&(console.log("wx___sdk初使化完成"),SdkManager.ins().sdk.systemInfo=t.init_data,SdkManager.ins().sdk.openid=t.open_id,SdkManager.ins().sdk.launchOption=t.launchOption,SdkManager.ins().is_login=!0,EventProxy.Broast(EventType.IsLoginSdk,[]),console.log("登陆帐号：",SdkManager.ins().sdk.openid),TimerManager.ins().remove(e,this))};TimerManager.ins().doTimerDelay(0,300,0,e,this)},t.prototype.commitPay=function(t){if(!(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=2)){this.lastPayTime=GameLogic.ins().getServerTime();var e=RoleProxy.ins().getRoleId(),i=RoleProxy.ins().getRoleName(),n=RoleProxy.ins().getRoleServerId(),o=RoleProxy.ins().getRoleLv(),s=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),r=t.data.amount,a=t.data.id,h=t.data.name,l=e+"_"+t.data.id+"_1_"+n+"_"+SdkManager.ins().ChannelID+"_2",p=LocationProperty.srvdata.name,c=n.toString()+e.toString()+GameLogic.ins().getServerTime().toString(),u={};u={"order-currency":"CNY","order-cp_order_id":c,"order-product_price":r,"order-product_id":a,"order-product_cnt":1,"order-product_name":h,"order-product_desc":h,"order-ext":l,"role-event":"","role-server_id":n,"role-server_name":p,"role-role_id":e,"role-role_name":i,"role-role_level":o,"role-role_vip":s},console.log("yjc SwitchWxPay roledata = ",u),platform.SwitchWxPay(u)}},t}();__reflect(HuoSdk.prototype,"HuoSdk");var QQSdk=function(){function t(){this.app_ver="1.0.1",this.cch_id=0,this.papp_id=0,this.app_id=0,this.app_key="",this.pay_key="",this.openid="",this.lastPayTime=0}return t.prototype.init=function(t){SdkManager.ins().reqNotice(0);var e=function(){var t=platform.getWxSdkData();t&&""!=t.open_id&&(console.log("qq___sdk初使化完成"),SdkManager.ins().sdk.systemInfo=t.init_data,SdkManager.ins().sdk.access_token=t.access_token,SdkManager.ins().sdk.openid=t.open_id,SdkManager.ins().sdk.launchOption=t.launchOption,SdkManager.ins().is_login=!0,EventProxy.Broast(EventType.IsLoginSdk,[]),console.log("登陆帐号：",SdkManager.ins().sdk.openid),TimerManager.ins().remove(e,this))};TimerManager.ins().doTimerDelay(0,300,0,e,this)},t.prototype.commitPay=function(t){},t}();__reflect(QQSdk.prototype,"QQSdk");var QuickSdk=function(){function t(){this.productCode="12480517274472786133998019136727",this.productKey="07602875",this.uid="",this.username="",this.InInit=!1,this.InLogin=!1,this.lastPayTime=0}return t.prototype.init=function(t){this.sdkTrans=window.QuickSDK,window.QuickSDK&&(this.sdkTrans.setSwitchAccountNotification(function(t){parent.document.location.reload()}),this.sdkTrans.setLogoutNotification(function(t){console.log("Game:玩家点击注销帐号"),parent.document.location.reload()})),this.InInit=!0,TimerManager.ins().doTimerDelay(0,5e3,0,this.InitSdk,this)},t.prototype.InitSdk=function(){this.sdkTrans.init(this.productCode,this.productKey,!0,function(){console.log("init success"),SdkManager.ins().sdk.InInit=!1,TimerManager.ins().remove(SdkManager.ins().sdk.InitSdk,SdkManager.ins().sdk),TimerManager.ins().doTimerDelay(0,1e3,0,SdkManager.ins().sdk.LoginSdk,SdkManager.ins().sdk)})},t.prototype.LoginSdk=function(){console.log("LoginSdk"),this.InLogin||this.sdkTrans.login(function(t){t.status?(console.log("GameDemo:QuickSDK登录成功: callbackData.data =>"+t.data),TimerManager.ins().remove(SdkManager.ins().sdk.LoginSdk,SdkManager.ins().sdk),SdkManager.ins().sdk.uid=t.data.uid,SdkManager.ins().sdk.username=t.data.username,SdkManager.ins().sdk.openid=t.data.channelId+"_"+t.data.uid,SdkManager.ins().sdk.access_token=t.data.token,SdkManager.ins().reqNotice(0)):(console.log("GameDemo:QuickSDK登录失败 status:"+t.status),console.log("GameDemo:QuickSDK登录失败 message:"+t.message),console.log("GameDemo:QuickSDK登录失败 channelId:"+t.data.channelId),console.log("GameDemo:QuickSDK登录失败 isLogin:"+t.data.isLogin),console.log("GameDemo:QuickSDK登录失败 uid:"+t.data.uid),SdkManager.ins().sdk.InLogin=!1)}),this.InLogin=!0},t.prototype.commitPay=function(t){if(!(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=2)&&(this.lastPayTime=GameLogic.ins().getServerTime(),null!=this.sdkTrans&&void 0!=this.sdkTrans)){var e=new Date,i=RoleProxy.ins().getRoleId(),n=RoleProxy.ins().getRoleServerId().toString()+RoleProxy.ins().getRoleId().toString()+GameLogic.ins().getServerTime().toString()+e.getMilliseconds().toString(),o=RoleProxy.ins().getRoleServerId(),s=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[i,t.data.id,1,o,SdkManager.ins().ChannelID,2]),r=new Object;r.productCode=this.productCode,r.uid=this.uid,r.username=this.username,r.userRoleId=i,r.userRoleName=RoleProxy.ins().getRoleName(),r.serverId=o,r.userServer=LocationProperty.srvdata.name,r.userLevel=RoleProxy.ins().getRoleLv(),r.cpOrderNo=n,r.amount=t.data.amount,r.subject=t.app_subject,r.desc="充值",r.callbackUrl="http://139.9.94.47:8090/f6",r.extrasParams=s,r.goodsId=t.data.id,r.count=1,r.quantifier="个";var a=JSON.stringify(r);this.sdkTrans.pay(a,function(t){})}},t.prototype.collectRole=function(t,e){var i=JSON.stringify(t);this.sdkTrans.uploadGameRoleInfo(i,function(t){}),console.log("数据上报",t)},t.prototype.sendEnterGameCom=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],vipLevel:t[5],roleFightValue:t[6],roleProfession:t[7],rolePayTotal:t[8],roleCoin1:t[9],roleCoin2:t[10]};this.sdkTrans.RaStarEnterGameCom(e),console.log("jssdk通用数据上传",e)},t.prototype.sendFinishTask=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],taskId:t[5],taskName:t[6],taskStatus:t[7],taskDetail:t[8],vipLevel:t[9]};this.sdkTrans.RaStarFinishTask(e),console.log("jssdk任务数据上传",e)},t.prototype.sendGetHonor=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],honorId:t[5],honorName:t[6],honorDetail:t[7],vipLevel:t[8]};this.sdkTrans.RaStarGetHonor(e),console.log("jssdk荣誉上传",e)},t.prototype.share=function(t){this.sdkTrans.RaStarShare(t),console.log("jssdk分享")},t.prototype.follow=function(t){this.sdkTrans.RaStarFollow(function(e){t(e)}),console.log("jssdk关注")},t.prototype.collect=function(t){this.sdkTrans.RaStarCollect(function(e){t(e)}),console.log("jssdk关注")},t.prototype.addShortcut=function(t){this.sdkTrans.RaStarAddShortcut(function(e){t(e)}),console.log("jssdk创建桌面快捷方式")},t.prototype.realNameVerify=function(t){this.sdkTrans.RaStarRealNameVerify(function(e){t(e)}),console.log("jssdk实名认证")},t.prototype.chatMonitoring=function(t,e){var i={cmd:t[0],type:t[1],gameid:t[2],serverid:t[3],uid:t[4],nick:t[5],fromch:t[6],touid:t[7],tonick:t[8],toch:t[9],msg:t[10],ip:t[11],sign:t[12]};this.sdkTrans.RaStarChatMonitoring(i,function(t){e(t)}),console.log("jssdk聊天上报")},t.prototype.bindPhone=function(t){this.sdkTrans.RaStarBindPhone(function(e){t(e)}),console.log("jssdk绑定手机")},t}();__reflect(QuickSdk.prototype,"QuickSdk");var SdkBase=function(){function t(){}return t}();__reflect(SdkBase.prototype,"SdkBase");var SdkType;!function(t){t[t.None=0]="None",t[t.WeiXin=1]="WeiXin",t[t.JSSDK=2]="JSSDK",t[t.WJSDK=4]="WJSDK",t[t.QQ=5]="QQ",t[t.Quick=6]="Quick",t[t.CSJSDK=7]="CSJSDK",t[t.HUOSDK=8]="HUOSDK"}(SdkType||(SdkType={}));var ChannelType;!function(t){t[t.None=0]="None",t[t.Weixin=1]="Weixin",t[t.JSSDK_HJY=2]="JSSDK_HJY",t[t.JSSDK_XYXX=3]="JSSDK_XYXX",t[t.JSSDK_WLFS=4]="JSSDK_WLFS",t[t.WJSDK_SHJ=5]="WJSDK_SHJ",t[t.WJSDK_MHJ=6]="WJSDK_MHJ"}(ChannelType||(ChannelType={}));var SdkManager=function(t){function e(){var e=t.call(this)||this;return e.wx_ver="1.0.1",e.sdktype=SdkType.None,e.channel_id=ChannelType.None,e.platform_id=0,e.zhifu_back=!1,e.is_souquan=!1,e.is_ontap_shouquan=!1,e.lyid=0,e.is_login=!1,e.has_get_serverlist=!1,e.curver="1.1",e.getServerTime=0,e.ChannelID=8021,e.IsGmSer=!1,e.IsInCheck=!1,e.cdnUrl="//yxl.ichuanshanjia.com/h5game/newyxl/",e.lastPayTime=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.init=function(t){this.sdktype=t,this.sdktype==SdkType.WeiXin?(this.sdk=new WeixinSdk,this.sdk.init()):this.sdktype==SdkType.JSSDK?(this.sdk=new H5Sdk,this.sdk.init()):this.sdktype==SdkType.WJSDK?(this.sdk=new WJH5Sdk,this.sdk.init(),e.ins().sdk.openid=window.fsSdkObj.userInfo.userdata.uid):this.sdktype==SdkType.QQ?(this.sdk=new QQSdk,this.sdk.init()):this.sdktype==SdkType.Quick?(this.sdk=new QuickSdk,this.sdk.init()):this.sdktype==SdkType.CSJSDK?(this.sdk=new CsjSdk,this.sdk.init()):this.sdktype==SdkType.HUOSDK&&(this.sdk=new HuoSdk,this.sdk.init())},Object.defineProperty(e,"isUseSdk",{get:function(){return e.ins().sdktype>0},enumerable:!0,configurable:!0}),e.prototype.isServerListGet=function(){return void 0!=this.server_list},e.prototype.SetServrtState=function(t,e){if(this.server_list)for(var i=0;i<this.server_list.body.list.length;i++)this.server_list.body.list[i].server_id==t&&(this.server_list.body.list[i].state=e,5!=e&&(this.server_list.body.list[i].CD=0))},e.prototype.getServerList=function(){if(this.server_list&&void 0!=this.server_list.code&&200==this.server_list.code&&this.server_list.body.list){for(var t=[],i=0;i<this.server_list.body.list.length;i++){var n=this.server_list.body.list[i];if(373740101==e.ins().lyid)n.server_id=n.zoneid-1e3;else if(373740102==e.ins().lyid)n.server_id=n.zoneid-2e3;else if(373740103==e.ins().lyid)n.server_id=n.zoneid-3e3;else{n.server_id=Number(n.no),n.state=Number(n.recommendedRating),n.CD=Number(n.operationStarted);var o=n.address.split(":");n.ip=o[0],n.port=o[1]}if(5==n.state){var s=Number(n.CD)-Math.floor((egret.getTimer()-e.ins().getServerTime)/1e3);0>=s&&(n.state=3,n.CD=0)}("1"==n.no||5!=Number(n.recommendedRating)||Number(n.operationStarted)-Math.floor((egret.getTimer()-e.ins().getServerTime)/1e3)<1800)&&t.push(n)}return t}return[]},e.prototype.reqNotice=function(t){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT;var n=function(t){switch(t.type){case egret.Event.COMPLETE:var i=t.currentTarget,n=i.response,o=JSON.parse(n);console.log("收到公告信息",o),e.ins().notice=o,EventProxy.Broast(EventType.NoticeUpdate,[]);break;case egret.IOErrorEvent.IO_ERROR:console.log("respHandler io error")}};i.once(egret.Event.COMPLETE,n,this),i.once(egret.IOErrorEvent.IO_ERROR,n,this);var o=UtilProxy.getStr("https://mtlapi.wulongju.com/notice/login?productSlug=@0 &platformId=@1 ",[e.ins().IsInCheck?1:e.ins().ChannelID,2]);console.log("发送公告请求：",o),i.open(o,egret.HttpMethod.GET),i.send()},e.prototype.initSeverList=function(){(e.isUseSdk||this.IsGmSer)&&(console.log("initSeverList"),e.ins().reqServerListLoop())},e.prototype.reqOpenIdLoop=function(t,i,n,o){if(e.isUseSdk){var s=function(){return e.ins().sdk.openid&&""!=e.ins().sdk.openid?void TimerManager.ins().remove(s,this):void e.ins().reqOpenId(t,i,n,o)};TimerManager.ins().doTimerDelay(0,1e3,0,s,this)}},e.prototype.reqOpenId=function(t,i,n,o){var s="ftxj47=7%9uE4eYP_mh1w@aW(^Hp~Ay50!M",r=Math.floor(1e5*Math.random()),a=101008,h="logininfo",l="loginauth",p=a+s+t+r,c=md5.hex_md5(p),u="https://ftxj-wxgame.rastargame.com:8003/openapi.php?key="+c+"&randnum="+r+"&cmd="+a+"&mod="+h+"&op="+l+"&token="+t+"&cchid="+i+"&appid="+n;e.ins().sdktype==SdkType.JSSDK&&(u+="&sdkrand="+o);var d=new egret.HttpRequest;d.responseType=egret.HttpResponseType.TEXT;var g=function(t){switch(t.type){case egret.Event.COMPLETE:var i=t.currentTarget,n=i.response,o=JSON.parse(n);console.log("获取open_id成功:",o),o&&void 0!=o.ret&&0==o.ret&&(e.ins().sdk.openid=o.type);break;case egret.IOErrorEvent.IO_ERROR:console.log("获取openid，失败")}};d.once(egret.Event.COMPLETE,g,this),d.once(egret.IOErrorEvent.IO_ERROR,g,this),d.open(u,egret.HttpMethod.GET),d.send(),console.log("请求open_id",u)},e.prototype.reqUnionIdLoop=function(t,i){if(e.isUseSdk){var n=function(){return 0!=e.ins().lyid?void TimerManager.ins().remove(n,this):void(void 0!==e.ins().sdk.openid&&""!=e.ins().sdk.openid&&e.ins().reqUnionId(t,i))};TimerManager.ins().doTimerDelay(0,300,0,n,this)}},e.prototype.reqUnionId=function(t,i){var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT;var o=function(t){switch(t.type){case egret.Event.COMPLETE:var i=t.currentTarget,n=i.response,o=JSON.parse(n);200==o.code&&(e.ins().lyid=o.data.ly_id,e.isUseSdk&&console.log("这是联运id:",o.data.ly_id,e.ins().sdk.openid));break;case egret.IOErrorEvent.IO_ERROR:console.log("respHandler io error")}};n.once(egret.Event.COMPLETE,o,this),n.once(egret.IOErrorEvent.IO_ERROR,o,this);var s=UtilProxy.getStr("https://channel.rastargame.com/common/GetLyId/index?tm=@0 &cch_id=@1 &app_id=@2 ",[GameLogic.ins().getServerTime(),t,i]);n.open(s,egret.HttpMethod.GET),n.send(),console.log("开始请求联运id",s)},e.prototype.reqServerListLoop=function(){if(e.isUseSdk||this.IsGmSer){this.IsInCheck=!1;var t=function(){return void 0!=this.server_list&&void 0!=this.server_list.body&&this.curver==this.server_list.body.ver?(this.IsInCheck=!0,void e.ins().reqServerList(!0)):void 0!=e.ins().getServerList()&&e.ins().getServerList().length>0?void TimerManager.ins().remove(t,this):void e.ins().reqServerList(!1)};TimerManager.ins().doTimerDelay(0,300,0,t,this)}},e.prototype.reqServerList=function(t){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT;var n=function(t){switch(t.type){case egret.Event.COMPLETE:var i=t.currentTarget,n=i.response,o=JSON.parse(n);e.ins().server_list=o,EventProxy.Broast(EventType.UpdateServerList,[]),e.ins().has_get_serverlist=!0,e.ins().getServerTime=egret.getTimer();break;case egret.IOErrorEvent.IO_ERROR:console.log("respHandler io error")}};i.once(egret.Event.COMPLETE,n,this),i.once(egret.IOErrorEvent.IO_ERROR,n,this);var o=UtilProxy.getStr("https://mtlapi.wulongju.com/server/getServerList?productSlug=@0 &platformId=@1 ",[e.ins().ChannelID,2]);t&&(o="https://mtlapi.wulongju.com/server/getServerList?productSlug=1&platformId=2"),i.open(o,egret.HttpMethod.GET),i.send(),console.log("请求服务器列表:",o)},e.prototype.reqReport=function(){},e.prototype.SubmitRoleData=function(t){var i=RoleProxy.ins().getRoleServerId(),n=LocationProperty.srvdata.name,o=RoleProxy.ins().getRoleId(),s=RoleProxy.ins().getRoleName(),r=RoleProxy.ins().getRoleLv(),a=FacProxy.ins().getFacName(),h=RoleProxy.ins().getMoneyAttr(MoneyAttr.VIP_LEVEL),l=RoleProxy.ins().getMoneyAttr(MoneyAttr.YUANBAO),p=RoleProxy.ins().getCreateTime(),c=RoleProxy.ins().getMoneyAttr(MoneyAttr.FIGHTING),u=FacProxy.ins().getFacId(),d={};switch(e.ins().sdktype){case SdkType.WeiXin:var g=1==t?"enter":2==t?"create":"up_level";d={action:g,sid:i,s_name:n,role_id:o,role_name:s,role_level:r,party_name:a,vip_level:h},e.ins().sdk.collectRole(d);break;case SdkType.JSSDK:d={roleId:o.toString(),roleName:s.toString(),roleLevel:r.toString(),serverId:i.toString(),serverName:n,balance:l.toString(),vipLevel:h.toString(),partyName:a,extra:"0",timeRoleCreate:p,timeRoleUpgrade:"-1",roleFightValue:c},e.ins().sdk.collectRole(d,t);break;case SdkType.WJSDK:if(5!=t){var y=1==t?3:2==t?1:2;d={account_name:e.ins().sdk.openid.toString(),coin_num:l,role_create_time:p,family_id:u,family_name:a,power:c,role_id:o,role_level:r,vip_level:h,role_name:s,server_id:i,server_name:n,type:y},console.log("submitRoleInfo roledata = "+d),window.fsSdkObj.JyFsSdk.submitRoleInfo(d)}break;case SdkType.Quick:d={isCreateRole:2==t,roleCreateTime:p,uid:e.ins().sdk.uid,username:e.ins().sdk.username,serverId:i,serverName:n,userRoleName:s,userRoleId:o,userRoleBalance:l,vipLevel:h,userRoleLevel:r,partyId:u,partyName:a,gameRoleGender:1==RoleProxy.ins().getRoleSex()?"男":"女",gameRolePower:c,partyRoleId:1,partyRoleName:"",professionId:RoleProxy.ins().getRoleSex(),profession:"",friendlist:""},e.ins().sdk.collectRole(d,t);break;case SdkType.CSJSDK:var f=new Object;f.dataType=1==t?3:2==t?2:4,f.serverID=i,f.serverName=n,f.roleID=o,f.roleName=s,f.roleLevel=r,f.moneyNum=l,f.roleCreateTime=p,f.roleLevelUpTime=GameLogic.ins().getServerTime(),f.vip=h,e.ins().sdk.collectRole(f,t);break;case SdkType.HUOSDK:if(5!=t){var _=["online","create","levelup","offline","other"];d={"role-event":_[t-1],"role-server_id":i,"role-server_name":n,"role-role_id":o,"role-role_name":s,"role-role_level":r,"role-role_vip":h,"role-combat_num":c},console.log("submitRoleInfo roledata = "+d),platform.updateRole(d)}}},e.prototype.commitPay=function(t){switch(e.ins().sdktype){case SdkType.WeiXin:e.ins().sdk.commitPay(t);break;case SdkType.JSSDK:case SdkType.CSJSDK:case SdkType.Quick:case SdkType.HUOSDK:e.ins().sdk.commitPay(t);break;case SdkType.WJSDK:if(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=5)return;this.lastPayTime=GameLogic.ins().getServerTime();var i=t.data.id,n=window.fsSdkObj.fsAppID,o=window.fsSdkObj.sdkName,s=window.fsSdkObj.extInfo,r=t.data.amount.toString(),a=new Date,h=RoleProxy.ins().getRoleId(),l=(RoleProxy.ins().getRoleServerId().toString()+RoleProxy.ins().getRoleId().toString()+GameLogic.ins().getServerTime().toString()+a.getMilliseconds().toString(),RoleProxy.ins().getRoleServerId()),p=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[h,t.data.id,1,l,e.ins().ChannelID,2]),c=LocationProperty.srvdata.name;VIPProxy.ins().C2SReqVipGetChargeParam(i,n,r,o,s,p,c);break;case SdkType.QQ:if(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=5)return;this.lastPayTime=GameLogic.ins().getServerTime();var u=t.data.pay_gold,d=t.data.goods_id,g=RoleProxy.ins().getRoleId(),y=RoleProxy.ins().getRoleServerId(),f=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[g,t.data.id,1,y,e.ins().ChannelID,2]),_=new egret.HttpRequest;_.responseType=egret.HttpResponseType.TEXT;var v=function(t){switch(t.type){case egret.Event.COMPLETE:var e=t.currentTarget,i=e.response;console.log("QQ预下单：",i);var n=JSON.parse(i);0==n.code&&platform.qqPay(n.prepayId,u);break;case egret.IOErrorEvent.IO_ERROR:console.log("respHandler io error")}};_.once(egret.Event.COMPLETE,v,this),_.once(egret.IOErrorEvent.IO_ERROR,v,this);var m=UtilProxy.getStr("https://mtls.wulongju.com/qq-order?openid=@0 &zone_id=@1 &pf=@2 &amt=@3 &goodid=@4 &good_num=@5 &app_remark=@6 &session_key=@7 ",[e.ins().sdk.openid,y,e.ins().sdk.systemInfo.platform,u,d,1,f,e.ins().sdk.access_token]);_.open(m,egret.HttpMethod.GET),_.send(),console.log("请求QQ预下单:",m)}},e}(BaseSystem);__reflect(SdkManager.prototype,"SdkManager");var WeixinSdk=function(){function t(){this.app_ver="1.0.1",this.cch_id=392,this.papp_id=184,this.app_id=101105,this.app_key="AzYSEUi1KMWd2GH",this.pay_key="PeYWflQq8pVZAu7vExFyzNwK9",this.openid="",this.lastPayTime=0}return t.prototype.getSystemInfo=function(){return this.systemInfo},t.prototype.getAccesstoken=function(){return this.access_token},t.prototype.init=function(t){SdkManager.ins().reqNotice(this.cch_id),this.sdkTrans=platform.getWxSdk({});var e=function(){var t=platform.getWxSdkData();t&&""!=t.open_id&&(console.log("weixin___sdk初使化完成"),SdkManager.ins().sdk.systemInfo=t.init_data,SdkManager.ins().sdk.access_token=t.access_token,SdkManager.ins().sdk.openid=t.open_id,SdkManager.ins().is_login=!0,EventProxy.Broast(EventType.IsLoginSdk,[]),console.log("登陆帐号：",SdkManager.ins().sdk.openid),TimerManager.ins().remove(e,this))};TimerManager.ins().doTimer(200,1e3,e,this)},t.prototype.getUserInfo=function(t){null==this.sdkTrans||void 0==this.sdkTrans},t.prototype.authUserInfo=function(t,e,i,n){if(null!=this.sdkTrans&&void 0!=this.sdkTrans){var o=function(t){LocationProperty.consoleWrite("授权onTap:"+t),EventProxy.Broast(EventType.ShouQuanResult,[t])},s=function(t){platform.doPoint("shouquan_success"),LocationProperty.consoleWrite("授权成功!"),SdkManager.ins().is_souquan=!0,SdkManager.ins().is_ontap_shouquan&&RoleCC.ins().connectServer(SdkManager.ins().sdk.openid)},r=function(t){LocationProperty.consoleWrite("授权失败")},a={};a.button={type:"text",text:"",style:{left:t,top:e,width:i,height:n,backgroundColor:"",borderColor:"#FF0000",borderRadius:1,borderWidth:0,textAlign:"center",fontSize:14,lineHeight:40}},a.keepShow=!1,a.onTap=o,a.success=s,a.fail=r,this.sdkTrans.authUserInfo(a),LocationProperty.consoleWrite("发起授权请求 ")}},t.prototype.userShare=function(t){null!=this.sdkTrans&&void 0!=this.sdkTrans&&this.sdkTrans.userShare(t)},t.prototype.appShare=function(t){null!=this.sdkTrans&&void 0!=this.sdkTrans&&this.sdkTrans.appShare(t)},t.prototype.commitPay=function(t){if(!(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=2)&&(this.lastPayTime=GameLogic.ins().getServerTime(),null!=this.sdkTrans&&void 0!=this.sdkTrans)){if(DeviceUtils.IsIos)return void TipsControl.ins().showTips("IOS暂不支持支付功能");var e=function(t){SdkManager.ins().zhifu_back=!0,console.log("支付成功",t);var e=(t.code,t.msg,t.data.r_order_no);console.log("支付成功，订单：",e)},i=function(t){SdkManager.ins().zhifu_back=!0,console.log("支付失败",t);t.msg},n=new Date,o=RoleProxy.ins().getRoleId(),s=RoleProxy.ins().getRoleName(),r=RoleProxy.ins().getRoleLv(),a=RoleProxy.ins().getRoleServerId().toString()+RoleProxy.ins().getRoleId().toString()+GameLogic.ins().getServerTime().toString()+n.getMilliseconds().toString(),h=RoleProxy.ins().getRoleServerId(),l=(GlobalConfig.getServerDataBySrvip(LocationProperty.serverIP),LocationProperty.srvdata.name),p=1,c=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[o,t.data.id,1,h,SdkManager.ins().lyid,2]),u={app_order_no:a,app_subject:t.app_subject,order_amt:t.order_amt,sid:h,sname:l,role_id:o,role_name:s,role_level:r,app_ext:c,env:0,zoneId:p,success:e,fail:i};console.log("发送请求充值：",u),this.sdkTrans.commitPay(u)}},t.prototype.collectRole=function(t){var e=function(t){console.log("SDK角色上报成功",t)},i=function(t){console.log("SDK角色上报失败",t)},n={action:t.action,sid:t.sid,s_name:t.s_name,role_id:t.role_id,role_name:t.role_name,role_level:t.role_level,party_name:t.fac_name||"",vip_level:t.vip_lv||0,extra:"",success:e,fail:i};console.log("角色上报",n),this.sdkTrans.collectRole(n)},t.prototype.collectRanking=function(t){var e=function(t){console.log("排行榜上报成功",t)},i=function(t){console.log("排行榜上报失败",t)};this.sdkTrans.collectRanking({score:t.score,costTime:t.costTime,success:e,fail:i})},t.prototype.checkWord=function(t){this.sdkTrans.checkWord({content:t.content,success:t.success,fail:t.fail})},t}();__reflect(WeixinSdk.prototype,"WeixinSdk");var WJH5Sdk=function(){function t(){this.cch_id=0,this.app_id=0,this.app_key="AzYSEUi1KMWd2GH",this.lastPayTime=0}return t.prototype.init=function(t){var e=function(){TimerManager.ins().remove(e,this),SdkManager.ins().reqNotice(0)};TimerManager.ins().doTimerDelay(0,300,0,e,this)},t.prototype.getSignKey=function(t,e){var i={};for(var n in t)"sign"!=n&&"sign_type"!=n&&null!=t[n]&&""!=t[n]&&(i[n]=t[n]);for(var o=Object.keys(i).sort(),s="",r=0;r<o.length;r++)s+=o[r]+"="+i[o[r]]+"&";return s=s.replace(/[\'\"\\\/\b\f\n\r\t]/g,""),md5.hex_md5(s+e)},t.prototype.getOrderInfo=function(t,e){var i="";for(var n in t)i+=n+"="+t[n]+"&";return i+="sign="+e},t.prototype.commitPay=function(t){if(!(0!=this.lastPayTime&&GameLogic.ins().getServerTime()-this.lastPayTime<=2)&&(this.lastPayTime=GameLogic.ins().getServerTime(),null!=this.sdkTrans&&void 0!=this.sdkTrans)){var e=new Date,i=RoleProxy.ins().getRoleId(),n=RoleProxy.ins().getRoleServerId().toString()+RoleProxy.ins().getRoleId().toString()+GameLogic.ins().getServerTime().toString()+e.getMilliseconds().toString(),o=RoleProxy.ins().getRoleServerId(),s=UtilProxy.getStr("@0 _@1 _@2 _@3 _@4 _@5 ",[i,t.data.id,1,o,SdkManager.ins().lyid,2]),r={tm:GameLogic.ins().getServerTime(),cch_id:this.cch_id,app_id:this.app_id,md_id:this.md_id,access_token:this.access_token,role_id:i,role_name:RoleProxy.ins().getRoleName(),role_level:RoleProxy.ins().getMoneyAttr(MoneyAttr.LEVEL),server_id:RoleProxy.ins().getRoleServerId(),server_name:LocationProperty.srvdata.name,amt:t.data.amount,app_subject_id:t.data.id,app_subject:t.app_subject,app_order_no:n,app_ext:s},a=this.getSignKey(r,this.app_key);r.sign=a,console.log("jssdk签名:",a);var h={orderInfo:r,amt:t.data.amount,roleName:RoleProxy.ins().getRoleName(),roleLevel:RoleProxy.ins().getRoleLv(),roleId:i,channel:RoleProxy.ins().getRoleServerId(),channelName:LocationProperty.srvdata.name,subject:t.app_subject,orderNo:n,extra:s};console.log("jssdk发起支付:",h),this.sdkTrans.RaStarPay(h)}},t.prototype.collectRole=function(t,e){switch(e){case 1:this.sdkTrans.RaStarUploadEnter(t);break;case 2:this.sdkTrans.RaStarUploadCreate(t);break;case 3:this.sdkTrans.RaStarUploadLevelUp(t);break;case 4:this.sdkTrans.RaStarUploadChangeName(t)}console.log("数据上报",t)},t.prototype.sendEnterGameCom=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],vipLevel:t[5],roleFightValue:t[6],roleProfession:t[7],rolePayTotal:t[8],roleCoin1:t[9],roleCoin2:t[10]};
this.sdkTrans.RaStarEnterGameCom(e),console.log("jssdk通用数据上传",e)},t.prototype.sendFinishTask=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],taskId:t[5],taskName:t[6],taskStatus:t[7],taskDetail:t[8],vipLevel:t[9]};this.sdkTrans.RaStarFinishTask(e),console.log("jssdk任务数据上传",e)},t.prototype.sendGetHonor=function(t){var e={roleId:t[0],roleName:t[1],roleLevel:t[2],serverId:t[3],serverName:t[4],honorId:t[5],honorName:t[6],honorDetail:t[7],vipLevel:t[8]};this.sdkTrans.RaStarGetHonor(e),console.log("jssdk荣誉上传",e)},t.prototype.share=function(t){this.sdkTrans.RaStarShare(t),console.log("jssdk分享")},t.prototype.follow=function(t){this.sdkTrans.RaStarFollow(function(e){t(e)}),console.log("jssdk关注")},t.prototype.collect=function(t){this.sdkTrans.RaStarCollect(function(e){t(e)}),console.log("jssdk关注")},t.prototype.addShortcut=function(t){this.sdkTrans.RaStarAddShortcut(function(e){t(e)}),console.log("jssdk创建桌面快捷方式")},t.prototype.realNameVerify=function(t){this.sdkTrans.RaStarRealNameVerify(function(e){t(e)}),console.log("jssdk实名认证")},t.prototype.chatMonitoring=function(t,e){var i={cmd:t[0],type:t[1],gameid:t[2],serverid:t[3],uid:t[4],nick:t[5],fromch:t[6],touid:t[7],tonick:t[8],toch:t[9],msg:t[10],ip:t[11],sign:t[12]};this.sdkTrans.RaStarChatMonitoring(i,function(t){e(t)}),console.log("jssdk聊天上报")},t.prototype.bindPhone=function(t){this.sdkTrans.RaStarBindPhone(function(e){t(e)}),console.log("jssdk绑定手机")},t}();__reflect(WJH5Sdk.prototype,"WJH5Sdk"),window.Main=Main,window.TimerHandler=TimerHandler,window.GameByteArray=GameByteArray,window.MessageVo=MessageVo,window.SkillDamageData=SkillDamageData,window.SkillHurtInfo=SkillHurtInfo,window.SkillDamageRange=SkillDamageRange,window.FlyNumber=FlyNumber,window.TipsItem=TipsItem,window.EntityArena=EntityArena,window.EntityDropItem=EntityDropItem,window.EntityMonster=EntityMonster,window.EntityMonsterClient=EntityMonsterClient,window.EntityMU=EntityMU,window.EntityNPC=EntityNPC,window.EntityOther=EntityOther,window.EntityPartner=EntityPartner,window.EntityPet=EntityPet,window.EntityPlayer=EntityPlayer,window.EntityRobot=EntityRobot,window.EntityRole=EntityRole,window.EntityVo=EntityVo,window.EntityYezhan=EntityYezhan;